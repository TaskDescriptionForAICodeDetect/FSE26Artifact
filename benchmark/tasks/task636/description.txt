There is a board with N rows and M columns represented by N strings. The symbols on the board can be: '.' for empty squares, '#' for obstacles, and 'o' for pieces. You can move a piece to either its right adjacent square or its down adjacent square, but cannot move to squares with another piece or an obstacle, nor move out of the board. Your task is to find the maximum number of operations that can be performed with the pieces on the board.