[
  {
    "language": "Scala",
    "code": "object Main extends App {\n  override def main(args: Array[String]): Unit = {\n    import scala.io.{StdIn => in}\n    Iterator\n      .continually(in.readInt())\n      .takeWhile(_ != 0)\n      .map(n =>\n        for (x <- 1 to n) yield in.readLine()\n      ).map(solve).foreach(println)\n  }\n\n  def solve(input: Seq[String]): Int = {\n    def toMinutes(input: String): Int = input.substring(6, 8).toInt * 60 + input.substring(9, 11).toInt\n    def getDistance(currentNext: (String, String)): Int = toMinutes(currentNext._2) - toMinutes(currentNext._1)\n\n    val sorted = input.sorted\n    val range = sorted.zip(sorted.drop(1)).map(getDistance(_))\n    val scanned = sorted.scanLeft(Set[String]()){(set,string) => if (string(12) == 'I') set + string.substring(14) else set - string.substring(14)}\n    val result = range.zip(scanned.drop(1)).filter(_._2.contains(\"000\")).foldLeft(Map[String, Int]()) {\n      (z, data) => data._2.filter(_ != \"000\").foldLeft(z)((zz, nn) => zz + (nn -> (zz.getOrElse(nn, 0) + data._1)))\n    }\n    if (result.isEmpty) 0 else result.maxBy(z => z._2)._2\n  }\n}"
  },
  {
    "language": "Scala",
    "code": "object Main extends App {\n  override def main(args: Array[String]): Unit = {\n    import scala.io.{StdIn => in}\n    Iterator\n      .continually(in.readInt())\n      .takeWhile(_ != 0)\n      .map(n =>\n        for (x <- 1 to n) yield in.readLine()\n      ).map(solve).foreach(println)\n  }\n\n  def solve(input: Seq[String]): Int = {\n    def toMinutes(input: String): Int = input.substring(6, 8).toInt * 60 + input.substring(9, 11).toInt\n    def getDistance(currentNext: (String, String)): Int = toMinutes(currentNext._2) - toMinutes(currentNext._1)\n\n    val sorted = input.sorted\n    val range = sorted.zip(sorted.drop(1)).map(getDistance(_))\n    val scanned = sorted.scanLeft(Set[String]()){(set,string) => if (string(12) == 'I') set + string.substring(14) else set - string.substring(14)}\n    val result = range.zip(scanned.drop(1)).filter(_._2.contains(\"000\")).foldLeft(Map[String, Int]()) {\n      (z, data) => data._2.filter(_ != \"000\").foldLeft(z)((zz, nn) => zz + (nn -> (zz.getOrElse(nn, 0) + data._1)))\n    }\n    result.maxBy(z => z._2)._2\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\n\n#define REP(i,n) for (int i=0; i<n; i++)\n\nint imos[1003][1500], staytime[1003];\n\nint main(){\n    while(1) {\n        int n, mon, d, h, min, p, prevdate = 0;\n        char e;\n        cin >> n;\n\n        if (n==0){\n            break;\n        }\n\n        REP(i,1000){\n            REP(j,1500){\n                imos[i][j] = 0;\n            }\n            staytime[i] = 0;\n        }\n\n        REP(i, n) {\n            scanf(\"%d/%d %d:%d %c %d\\n\", &mon, &d, &h, &min, &e, &p);\n//            printf(\"%d/%d %d:%d %c %d\\n\", mon, d, h, min, e, p);\n            if (mon * 12 + d != prevdate) {\n//                printf(\"prevdate: %d\\n\", prevdate);\n                REP(j, 1000) {\n                    REP(k, 1499){\n                        imos[j][k+1] += imos[j][k];\n                    }\n                }\n                REP(k, 1500){\n                    if (imos[0][k]>0){\n                        REP(j,1000){\n                            if (imos[j][k]>0){\n                                staytime[j] += 1;\n                            }\n                        }\n                    }\n                }\n                REP(j,1000){\n                    REP(k,1500){\n                        imos[j][k] = 0;\n                    }\n                }\n                prevdate = mon * 12 + d;\n            }\n            if (e == 'I') {\n                imos[p][60 * h + min] += 1;\n            } else {\n                imos[p][60 * h + min] -= 1;\n            }\n        }\n\n        REP(j, 1000) {\n            REP(k, 1499){\n                imos[j][k+1] += imos[j][k];\n            }\n        }\n        REP(k, 1500){\n            if (imos[0][k]>0){\n                REP(j,1000){\n                    if (imos[j][k]>0){\n                        staytime[j] += 1;\n                    }\n                }\n            }\n        }\n\n        int ans=0;\n        for (int i=1; i<1000; i++){          // 直す\n            ans = max(ans, staytime[i]);\n//            printf(\"staytime[%d] = %d\\n\", i, staytime[i]);\n        }\n\n        cout << ans << endl;\n\n    }\n\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define all(a) a.begin(),a.end()\nusing namespace std;\n\nint main(void){\n    int n;\n    while(cin>>n,n!=0){\n        map<int, valarray<int>> lg;\n        map<int,int> ans;\n        int mm,dd,h,m,id,yesterday=0;\n        rep(ln,n+1){\n            char c;\n            if(ln!=n)scanf(\"%d/%d %d:%d %c %d\",&mm,&dd,&h,&m,&c,&id);\n            if((yesterday!=0 && yesterday!=mm*100+dd) || ln==n){\n                if(lg.find(0)!=lg.end()){\n                    for(auto p:lg){\n                        if(p.first==0) continue;\n                        valarray<int> q=p.second+lg[0];\n                        partial_sum(begin(q),end(q),begin(q));\n                        ans[p.first]+=q.apply([](int x){return x==2?1:0;}).sum();\n                    }\n                }\n                lg.clear();\n                yesterday=0;\n            }\n            yesterday=mm*100+dd;\n            if(lg.find(id)==lg.end()){\n                lg[id]=valarray<int>(0,1441);\n            }\n            lg[id][h*60+m]+=(c=='I'?1:-1);\n        }\n        int avl=0;\n        for(auto i:ans){\n            avl=max(avl,i.second);\n        }\n        cout<<avl<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <ctime>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <numeric>\n\nusing namespace std;\n\n#ifdef _MSC_VER\n#define __typeof__ decltype\n\ntemplate <class T>\nint __builtin_popcount(T n) { return n ? 1 + __builtin_popcount(n & (n - 1)) : 0; }\n#endif\n\n#define foreach(it, c) for (__typeof__((c).begin()) it=(c).begin(); it != (c).end(); ++it)\n#define all(c) (c).begin(), (c).end()\n#define rall(c) (c).rbegin(), (c).rend()\n#define popcount __builtin_popcount\n\nconst double EPS = 1e-10;\ntypedef long long ll;\ntypedef pair<int, int> pint;\n\n\nint main()\n{\n\tint n;\n\twhile (scanf(\"%d\", &n), n)\n\t{\n\t\tmap<int, int> sum, in;\n\t\tint day = -1, god = -1;\n\t\twhile (n--)\n\t\t{\n\t\t\tint m, d, hour, minute, prog;\n\t\t\tchar io;\n\t\t\tscanf(\"%d/%d %d:%d %c %d\", &m, &d, &hour, &minute, &io, &prog);\n\t\t\td += m*100;\n\t\t\tminute += hour*60;\n\t\t\tif (d != day)\n\t\t\t{\n\t\t\t\tif (god != -1)\n\t\t\t\t{\n\t\t\t\t\tforeach (it, in)\n\t\t\t\t\t\tsum[it->first] += 24*60 - it->second;\n\t\t\t\t}\n\n\t\t\t\tin.clear();\n\t\t\t\tday = d;\n\t\t\t\tgod = -1;\n\t\t\t}\n\n\t\t\tif (prog == 0)\n\t\t\t{\n\t\t\t\tif (io == 'I')\n\t\t\t\t{\n\t\t\t\t\tgod = minute;\n\t\t\t\t\tforeach (it, in)\n\t\t\t\t\t\tit->second = minute;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tforeach (it, in)\n\t\t\t\t\t\tsum[it->first] += minute - it->second;\n\t\t\t\t\tgod = -1;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (io == 'I')\n\t\t\t\t\tin[prog] = minute;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (god != -1)\n\t\t\t\t\t\tsum[prog] += minute - in[prog];\n\t\t\t\t\tin.erase(prog);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tint res = 0;\n\t\tforeach (it, sum)\n\t\t\tres = max(res, it->second);\n\t\tprintf(\"%d\\n\", res);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <string>\n#include <string.h>\n#include <map>\n#include <sstream>\nusing namespace std;\ntypedef long long ll;\n\nint now[1111];\nint n;\nchar Ic[11];\nint Im,Id,Ih,Imi,Ii;\n\nstruct node{\n    int l,r,id;\n    node(){}\n    node(int _l,int _r,int _id):l(_l),r(_r),id(_id){\n//        cout << l <<' ' << r << ' ' << id << endl;\n    }\n}a[1111],b[1111];\nint m;\nint day[13] = {0,31,28,31,30,31,30,31,31,30,31,30,31};\n\nint main(){\n    for (int i=1;i<13;++i) day[i] = day[i-1] + day[i];\n    while (scanf(\"%d\",&n)==1 && n){\n        memset(now,-1,sizeof(now));\n        int m1 = 0, m2 = 0;\n        for (int i=0;i<n;++i){\n            scanf(\"%d/%d %d:%d %s %d\",&Im,&Id,&Ih,&Imi,Ic,&Ii);\n            int ret = (day[Im-1] + Id - 1) * 24 * 60 + Ih * 60 + Imi;\n            if (Ic[0] == 'I') now[Ii] = ret;\n            else{\n                if (Ii==0)\n                    a[m1++] = node(now[Ii], ret, Ii);\n                else\n                    b[m2++] = node(now[Ii], ret, Ii);\n            }\n        }\n//        for (int i=0;i<m1;++i) printf\n//    cout << min(a[0].r,b[0].r) - max(a[0].l, b[0].l) << endl;\n        memset(now,0,sizeof(now));\n        for (int i=0;i<m1;++i)\n            for (int j=0;j<m2;++j)\n                now[b[j].id] += max(0, min(a[i].r,b[j].r) - max(a[i].l, b[j].l));\n        int ans = 0;\n        for (int i=1;i<=999;++i) ans=max(ans, now[i]);\n        printf(\"%d\\n\", ans);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <fstream>\n#include <list>\nusing namespace std;\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toStr(T x) { ostringstream sout; sout << x; return sout.str(); }\ntypedef vector<int> vi;\ntypedef vector<vi>  vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define FOR(i,a,b) for(int i=(a);i<=(b);++i)\n#define REP(i,n) FOR(i,0,(n)-1)\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\nconst int INF = INT_MAX / 10;\n\nint main() {\n\tint n;\n\twhile (cin >> n, n) {\n\t\tint a, b;\n\t\tchar c;\n\t\tvi d(n), t(n), p(n);\n\t\tvector<char> e(n);\n\t\tint maxp = -1;\n\t\tREP(i, n) {\n\t\t\tcin >> a >> c >> b;\n\t\t\td[i] = a * 100 + b;\n\t\t\tcin >> a >> c >> b;\n\t\t\tt[i] = a * 60 + b;\n\t\t\tcin >> e[i] >> p[i];\n\t\t\tmaxp = max(maxp, p[i]);\n\t\t}\n\n\t\tvi isIn(maxp+1), inTime(maxp+1), sum(maxp+1);\n\t\tREP(i, n) {\n\t\t\tif (e[i] == 'I') {\n\t\t\t\tisIn[p[i]] = 1;\n\t\t\t\tinTime[p[i]] = t[i];\n\t\t\t\tif (p[i] == 0) {\n\t\t\t\t\tFOR(j, 1, maxp) {\n\t\t\t\t\t\tinTime[j] = t[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tisIn[p[i]] = 0;\n\t\t\t\tif (p[i] == 0) {\n\t\t\t\t\tFOR(j, 1, maxp) {\n\t\t\t\t\t\tif (isIn[j]) {\n\t\t\t\t\t\t\tsum[j] += t[i] - inTime[p[i]];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (isIn[0]) {\n\t\t\t\t\tsum[p[i]] += t[i] - inTime[p[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tint ans = 0;\n\t\tFOR(i, 1, maxp) {\n\t\t\tans = max(ans, sum[i]);\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdlib>\n#include <set>\n#include <cstdio>\n#include <algorithm>\n#define REP(i,n) for(int i=0; i<(int)(n); i++)\n\nusing namespace std;\n\nint a[100];\nint b[100];\n\nint main(){\n  int n;\n  while(scanf(\"%d\", &n), n){\n    char message[110];\n    scanf(\"%s\", message);\n\n    REP(i, n){\n      scanf(\"%d%d\", &a[i], &b[i]); a[i]--; b[i]--;\n    }\n\n    for(int i = n - 1; i >= 0; i--){\n      swap(message[a[i]], message[b[i]]);\n      int diff = b[i] - a[i];\n      int all = 'z' - 'a' + 1;\n\n      message[a[i]] = (message[a[i]] - 'a' + diff) % all + 'a';\n      message[b[i]] = (message[b[i]] - 'a' + diff) % all + 'a';\n    }\n    puts(message);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define all(a) a.begin(),a.end()\nusing namespace std;\n\nint main(void){\n    int n;\n    while(cin>>n,n!=0){\n        map<int, valarray<int>> lg;\n        map<int,int> ans;\n        int mm,dd,h,m,id,yesterday=0;\n        rep(ln,n+1){\n            char c;\n            if(ln!=n)scanf(\"%d/%d %d:%d %c %d\",&mm,&dd,&h,&m,&c,&id);\n            if((yesterday!=0 && yesterday!=mm*100+dd) || ln==n){\n                if(lg.find(0)!=lg.end()){\n                    for(auto p:lg){\n                        if(p.first==0) continue;\n                        valarray<int> q=p.second+lg[0];\n                        partial_sum(all(q),begin(q));\n                        ans[p.first]+=q.apply([](int x){return x==2?1:0;}).sum();\n                    }\n                }\n                lg.clear();\n                yesterday=0;\n            }\n            yesterday=mm*100+dd;\n            if(lg.find(id)==lg.end()){\n                lg[id]=valarray<int>(0,1441);\n            }\n            lg[id][h*60+m]+=(c=='I'?1:-1);\n        }\n        int avl=0;\n        for(auto i:ans){\n            avl=max(avl,i.second);\n        }\n        cout<<avl<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing pii = pair<int, int>;\n#define rep(i, n) for (int i = 0; i < n; ++i)\n#define rep3(i, j, n) for (int i = j; i < n; ++i)\n#define eb emplace_back\n#define sz(s) (int)s.size()\n#define F first\n#define S second\n\nint main() {\n    int n;\n    while (cin >> n && n) {\n        vector<vector<pair<pii, pii> > > in(1000);\n        vector<vector<pair<pii, pii> > > out(1000);\n        rep(i, n) {\n            int a, b; char ch;\n            cin >> a >> ch >> b;\n            int c, d;\n            cin >> c >> ch >> d;\n            cin >> ch;\n            int e;\n            cin >> e;\n            \n            \n            if (ch == 'I') in[e].eb(make_pair(pii(a, b), pii(c, d)));\n            else out[e].eb(make_pair(pii(a, b), pii(c, d)));\n            \n        }\n        /*\n        rep(i, 5) {\n            cout << i << endl;\n            cout << \"in\" << endl;\n            rep(j, sz(in[i])) cout << in[i][j].F.F << \" \" << in[i][j].F.S << \" \" << in[i][j].S.F << \" \" << in[i][j].S.S << endl;\n            cout << \"out\" << endl;\n            rep(j, sz(out[i])) cout << out[i][j].F.F << \" \" << out[i][j].F.S << \" \" << out[i][j].S.F << \" \" << out[i][j].S.S << endl;\n        }\n        */\n        \n        int ans = 0;\n        rep3(i, 1, 100) {\n            // cout << i << endl;\n            int sum = 0;\n            rep(j, sz(in[i])) {\n                rep(k, sz(in[0])) {\n                    if (in[i][j].F.F != in[0][k].F.F || in[i][j].F.S != in[0][k].F.S) continue;\n                    // start time\n                    // not coverd at all\n                    if (out[i][j].S.F < in[0][k].S.F) continue;\n                    if (out[i][j].S.F == in[0][k].S.F && out[i][j].S.S < in[0][k].S.S) continue;\n                    \n                    if (in[i][j].S.F > out[0][k].S.F) continue;\n                    if (in[i][j].S.F == out[0][k].S.F && in[i][j].S.S > out[0][k].S.S) continue;\n                    \n                    int a = in[i][j].S.F, b = in[i][j].S.S, c = out[i][j].S.F, d = out[i][j].S.S;\n                    if (a < in[0][k].S.F) {\n                        a = in[0][k].S.F;\n                        b = in[0][k].S.S;\n                    } else if (a == in[0][k].S.F && b < in[0][k].S.S) {\n                        b = in[0][k].S.S;\n                    }\n                    // cout << a << \" \" << b << \" \";\n                    a = a * 60 + b;\n                    if (c > out[0][k].S.F) {\n                        c = out[0][k].S.F;\n                        d = out[0][k].S.S;\n                    } else if (c == out[0][k].S.F && d > out[0][k].S.S) {\n                        d = out[0][k].S.S;\n                    }\n                    // cout << c << \" \" << d << endl;\n                    c = c * 60 + d;\n                    sum += c - a;\n                }\n            }\n            ans = max(ans, sum);\n            // if (sum != 0) cout << i << \" \" << sum << endl;\n        }\n        cout << ans << endl;\n    }\n}\n\n/*\n 10\n 06/01 10:00 I 000\n 06/01 11:15 O 000\n 06/01 09:30 I 001\n 06/01 09:45 O 001\n 06/01 10:15 I 002\n 06/01 10:30 O 002\n 06/01 09:45 I 003\n 06/01 10:30 O 003\n 06/01 11:30 I 004\n 06/01 11:45 O 004\n \n 30\n */\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#define INF (1e9)\nusing namespace std;\n\nint main(){\n  while(1){\n    int n;\n    cin>>n;\n    if(!n)break;\n    int sum[1001]={},in[1001]={INF},out[1001],maxsum=0,maxid=0;\n    for(int i=0;i<1000;i++) out[i]=INF;\n\n    for(int i=0;i<n;i++){\n      int month,day,h,m,id;\n      char ch;\n      scanf(\"%d/%d %d:%d\",&month,&day,&h,&m);\n      cin>>ch>>id;\n      \n      maxid=max(maxid,id);\n      int time=(month*100000)+(day*10000)+(h*60)+m;\n      \n      if(ch=='I')in[id]=time;\n      if(ch=='O'){\n\tout[id]=time;\n\tfor(int j=1;!id&&j<=maxid;j++){\n\t  if(out[0]<=in[j]||out[j]<=in[0]) continue;\n\t  sum[j]+=min(out[0],out[j])-max(in[0],in[j]);\n\t  maxsum=max(maxsum,sum[j]);\n\t}\n      }\n    }\n    cout <<maxsum<<endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <cstdio>\n\nusing namespace std;\n\nclass prog{\npublic:\n  int i, o;\n  string str;\n};\n\nvector<prog> p[1000];\nint size[1000];\n\nmain(){\n  int n;\n  while(cin >> n && n){\n    for(int i=0;i<1000;i++){\n      p[i].clear();\n    }\n    fill(size, size+1000, 0);\n    for(int i=0;i<n;i++){\n      prog in;\n      string input;\n      cin >> in.str;\n      cin >> input;\n      int a, b;\n      string tmp = \"\";\n      tmp += input[0];\n      tmp += input[1];\n      a = atoi(tmp.c_str());\n      tmp = \"\";\n      tmp += input[3];\n      tmp += input[4];\n      b = atoi(tmp.c_str());\n      char c;\n      cin >> c;\n      if(c == 'I'){\n\tin.i = a*60 + b;\n\tin.o = -1;\n      }else{\n\tin.o = a*60 + b;\n      }\n      cin >> input;\n      int id = atoi(input.c_str());\n      if(c == 'I'){\n\tp[id].push_back(in);\n      }else{\n\tp[id][(int)p[id].size()-1].o = in.o;\n      }\n    }\n    int ans = 0;\n    for(int i=0;i<1000;i++){\n      for(int k=0;k<1000;k++){\n\tif(i == k) continue;\n\tint sum = 0;\n\tfor(int j=0;j<p[i].size();j++){\n\t  if(p[i][j].o == -1) continue;\n\t  for(int l=0;l<p[k].size();l++){\n\t    if(p[k][l].o == -1) continue;\n\t    if(p[i][j].str != p[k][l].str) continue;\n\t    int ai = p[i][j].i;\n\t    int ao = p[i][j].o;\n\t    int bi = p[k][l].i;\n\t    int bo = p[k][l].o;\n\t    if(ai == bi && bo == ao) sum += bo - bi;\n\t    else if(ai == bi) sum += min(ao, bo) - ai;\n\t    else if(ao == bo) sum += max(ai, bi) - ao;\n\t    else if(ai < bi && bo < ao) sum += bo - bi;\n\t    else if(bi < ai && ao < bo) sum += ao - ai;\n\t    else if(ai < bi && bi < ao) sum += ao - bi;\n\t    else if(ai < bo && bo < ao) sum += bo - ai;\n\t  }\n\t}\n\tans = max(ans, sum);\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n\nusing namespace std;\n\nint main(){\n\tfor(int n;scanf(\"%d\",&n),n;){\n\t\tstatic bool t[1000][1440];\n\t\tint bless[1000]={},enter[1000]={},last[1000]={};\n\n\t\tint pre=-1;\n\t\trep(k,n+1){\n\t\t\tint date,id;\n\t\t\tif(k<n){\n\t\t\t\tint mon,day,hh,mm;\n\t\t\t\tscanf(\"%d%*c%d %d%*c%d %*c %d\",&mon,&day,&hh,&mm,&id);\n\t\t\t\tdate=31*mon+day;\n\n\t\t\t\tif(enter[id]==0){\n\t\t\t\t\tenter[id]=60*hh+mm;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tfill(t[id]+enter[id],t[id]+60*hh+mm,true);\n\t\t\t\t\tenter[id]=0;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tdate=7777777;\n\t\t\t}\n\n\t\t\tif(pre!=date){\n\t\t\t\trep(i,1000) if(last[i]==pre) rep(j,1440) if(t[i][j] && t[0][j]) bless[i]++;\n\t\t\t\trep(i,1000) if(last[i]==pre) fill(t[i],t[i]+1440,false);\n\t\t\t}\n\t\t\tlast[id]=pre=date;\n\t\t}\n\n\t\tprintf(\"%d\\n\",*max_element(bless+1,bless+1000));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <stdbool.h>\n#include <string.h>\n\nint max(int a[], int n) {\n  int i, m = 0;\n  for(i = 1; i < n; i ++) {\n    if(a[m] < a[i]) { m = i; }\n  }\n\n  return m;\n}\n\nint main() {\n  int n;\n  int mon[1000], day[1000], hou[1000], min[1000];\n  char IO[1000][2];\n  int id[1000];\n  int time[2][500];\n  int total[500];\n\n  while(true) {\n    scanf(\"%d\", &n);\n    if(n == 0) break;\n\n    int i, j;\n    for(i = 0; i < n; i ++) {\n      scanf(\"%d/%d %d:%d %c %d\", &mon[i], &day[i], &hou[i], &min[i], IO[i], &id[i]);\n      time[0][i] = 0;\n      time[1][i] = 0;\n      total[i] = 0;\n    }\n\n    bool god_flg = false;\n    int in_flg[500] = {0};\n    for(i = 0; i < n; i ++) {\n      if(id[i] == 0 && IO[i][0] == 'I') {\n\tgod_flg = true;\n\tfor(j = 0; j < 500; j ++) {\n\t  time[0][j] = hou[i]*60 + min[i];\n\t}\n      }\n      else if(id[i] == 0 && IO[i][0] == 'O') {\n\tgod_flg = false;\n\tfor(j = 0; j < 5; j ++) {\n\t  total[j] += in_flg[j]*(hou[i]*60 + min[i] - time[0][i]);\n\t}\n      }\n      else if(god_flg && IO[i][0] == 'I') {\n\ttime[0][id[i]] = hou[i]*60 + min[i];\n\tin_flg[id[i]] = 1;\n      }\n      else if(god_flg && IO[i][0] == 'O') {\n\ttime[1][id[i]] = hou[i]*60 + min[i];\n\ttotal[id[i]] += time[1][id[i]] - time[0][id[i]];\n\n\tin_flg[id[i]] = 0;\n      }\n      else if(!god_flg && IO[i][0] == 'I') {\n\tin_flg[id[i]] = 1;\n      }\n      else if(!god_flg && IO[i][0] == 'O') {\n\tin_flg[id[i]] = 0;\n      }\n    }\n    printf(\"%d\\n\", total[max(total, n)]);\n  }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint add(int m1,int d1,int m2,int d2){\n  int M1 = m1*60+d1, M2 = m2*60+d2;\n  return M2-M1;\n}\n\nint main(){\n  int N;\n  while(cin >> N, N > 0){\n    int M[N],D[N],h[N],m[N],e[N],p[N];\n    char ch;\n    for(int i = 0 ; i < N ; i++){\n      scanf(\"%d/%d %d:%d %c %d\",\n\t    &M[i],&D[i],&h[i],&m[i],&ch,&p[i]);\n      e[i] = (ch == 'I' ? 1 : 0);\n    }\n    map<int,int> point;\n    bool used[1001] = {false}, god = false;\n    for(int i = 0 ; i < N ; i++){\n      if(e[i] == 1 && p[i] == 0) god = true;\n      if(e[i] == 0 && p[i] == 0) god = false;\n      if(p[i] == 0) continue;\n      if(god && !used[i]){\n\tused[i] = true;\n\tif(e[i] == 0){\n\t  for(int j = i-1 ; j >= 0 ; j--){\n\t    if(p[i] == p[j]){\n\t      used[j] = true;\n\t      point[p[i]] += add(h[j],m[j],h[i],m[i]);\n\t      break;\n\t    }\n\t  }\n\t}else{\n\t  for(int j = i+1 ; j < N ; j++){\n\t    if(p[i] == p[j]){\n\t      used[j] = true;\n\t      point[p[i]] += add(h[i],m[i],h[j],m[j]);\n\t      break;\n\t    }\n\t  }\n\t}\n      }\n    }\n    int ans = 0;\n    map<int,int>::iterator it;\n    for(it = point.begin() ; it != point.end() ; ++it){\n      ans = max(ans,it->second);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "/*\n * GCA : \"Computer is artificial subject absolutely,Math is God\"\n */\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <vector>\n#include <set>\n#include <map>\n#include <queue>\n#include <cctype>\n#include <utility>\n\nusing namespace std;\n#ifdef DEBUG\n#define VAR(a,b) __typeof(b) a=(b)\n#define debug(...) printf(\"DEBUG: \"),printf(__VA_ARGS__)\n#else\n#define VAR(a,b) __typeof(b) a=(b)\n#define debug(...)\n#endif\ntypedef unsigned int uint;\ntypedef long long int Int;\ntypedef unsigned long long int UInt;\n#define Set(a,s) memset(a,s,sizeof(a))\n#define Pln() printf(\"\\n\")\n#define For(i,x)for(int i=0;i<x;i++)\n#define CON(x,y) x##y\n#define M 1005\n#define PB push_back\n#define oo INT_MAX\n#define FOR(a,b) for(VAR(a,(b).begin());a!=(b).end();++a)\n#define eps 1e-9\n#define X first\n#define Y second\ninline bool xdy(double x,double y){return x>y+eps;}\ninline bool xddy(double x,double y){return x>y-eps;}\ninline bool xcy(double x,double y){return x<y-eps;}\ninline bool xcdy(double x,double y){return x<y+eps;}\nconst Int mod=1000000007;\nint n;\nint god[M];\nint godlog;\nint ti[M];\nint inti[M];\nint sid[M];\nchar ppl[M];\nint main() {\n\tios_base::sync_with_stdio(0);\n\twhile(~scanf(\"%d\",&n)&&n){\n\t\tSet(inti,-1);\n\t\tSet(god,0);\n\t\tint godti=-1;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tint mon,d,h,m,id;\n\t\t\tchar p;\n\t\t\tscanf(\"%d/%d %d:%d \",&mon,&d,&h,&m);\n\t\t\tti[i]=mon*100*24*60+d*24*60+h*60+m;\n\t\t\tscanf(\"%c %d\",&ppl[i],&sid[i]);\n\t\t\tp=ppl[i];id=sid[i];\n\t\t\tif(!id){\n\t\t\t\tif(p=='I'){\n\t\t\t\t\tgodti=ti[i];\n\t\t\t\t\tgodlog=i;\n\t\t\t\t}\n\t\t\t\telse if(p=='O'){\n\t\t\t\t\tbool outside[M]={};\n\t\t\t\t\tfor(int j=i-1;j>=0;j--){\n\t\t\t\t\t\tif(ppl[j]=='O')outside[sid[j]]=1;\n\t\t\t\t\t\tif(ppl[j]=='I'&&inti[sid[j]]!=-1&&!outside[sid[j]]){\n\t\t\t\t\t\t\tgod[sid[j]]+=ti[i]-max(godti,inti[sid[j]]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tgodti=-1;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(p=='I')inti[id]=ti[i];\n\t\t\t\telse if(p=='O'){\n\t\t\t\t\tif(godti!=-1){\n\t\t\t\t\t\tgod[id]+=ti[i]-inti[id];\n\t\t\t\t\t\tinti[id]=-1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t}\n\t\tint ans=0;\n\t\tfor(int i=1;i<1000;i++){\n\t\t\tans=max(ans,god[i]);\n\t\t}\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nint main(){\n\tios_base::sync_with_stdio(false);\n\twhile(true){\n\t\tint n;\n\t\tcin >> n;\n\t\tif(n == 0){ break; }\n\t\tint pmonth = -1, pday = -1;\n\t\tvector< vector<int> > io(1000);\n\t\tvector<int> counters(1000);\n\t\tvector<int> integral(24 * 60 + 1);\n\t\tfor(int t = 0; t <= n; ++t){\n\t\t\tint month, day, hour, minute, id;\n\t\t\tstring type;\n\t\t\tif(t < n){\n\t\t\t\tcin >> month; cin.ignore();\n\t\t\t\tcin >> day >> hour; cin.ignore();\n\t\t\t\tcin >> minute >> type >> id;\n\t\t\t}else{\n\t\t\t\tmonth = -2;\n\t\t\t\tday = -2;\n\t\t\t\thour = minute = id = 0;\n\t\t\t}\n\t\t\tif(pmonth != month || pday != day){\n\t\t\t\tfor(int i = 0; i < io.size(); ++i){\n\t\t\t\t\tif(io[i].size() % 2 == 1){ io[i].push_back(24 * 60); }\n\t\t\t\t}\n\t\t\t\tfill(integral.begin(), integral.end(), 0);\n\t\t\t\tfor(int i = 0; i < io[0].size(); ++i){\n\t\t\t\t\tintegral[io[0][i]] += (i % 2 == 0 ? 1 : -1);\n\t\t\t\t}\n\t\t\t\tfor(int i = 0, s = 0; i < integral.size(); ++i){\n\t\t\t\t\ts += integral[i];\n\t\t\t\t\tintegral[i] = s;\n\t\t\t\t}\n\t\t\t\tfor(int i = 0, s = 0; i < integral.size(); ++i){\n\t\t\t\t\tconst int tmp = s + integral[i];\n\t\t\t\t\tintegral[i] = s;\n\t\t\t\t\ts = tmp;\n\t\t\t\t}\n\t\t\t\tfor(int i = 1; i < io.size(); ++i){\n\t\t\t\t\tfor(int j = 0; j < io[i].size(); j += 2){\n\t\t\t\t\t\tcounters[i] +=\n\t\t\t\t\t\t\tintegral[io[i][j + 1]] - integral[io[i][j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int i = 0; i < io.size(); ++i){ io[i].clear(); }\n\t\t\t}\n\t\t\tio[id].push_back(hour * 60 + minute);\n\t\t\tpmonth = month;\n\t\t\tpday = day;\n\t\t}\n\t\tcout << *max_element(counters.begin(), counters.end()) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <cstdio>\n\nusing namespace std;\n\nclass prog{\npublic:\n  int i, o;\n  string str;\n};\n\nvector<prog> p[1000];\nint size[1000];\n\nmain(){\n  int n;\n  while(cin >> n && n){\n    for(int i=0;i<1000;i++){\n      p[i].clear();\n    }\n    fill(size, size+1000, 0);\n    for(int i=0;i<n;i++){\n      prog in;\n      string input;\n      cin >> in.str;\n      cin >> input;\n      int a, b;\n      string tmp = \"\";\n      tmp += input[0];\n      tmp += input[1];\n      a = atoi(tmp.c_str());\n      tmp = \"\";\n      tmp += input[3];\n      tmp += input[4];\n      b = atoi(tmp.c_str());\n      char c;\n      cin >> c;\n      if(c == 'I'){\n\tin.i = a*60 + b;\n\tin.o = -1;\n      }else{\n\tin.o = a*60 + b;\n      }\n      cin >> input;\n      int id = atoi(input.c_str());\n      if(c == 'I'){\n\tp[id].push_back(in);\n      }else{\n\tp[id][(int)p[id].size()-1].o = in.o;\n      }\n    }\n    int ans = 0;\n    for(int i=0;i<1000;i++){\n      if(p[i].size() == 0) continue;\n      for(int k=0;k<1000;k++){\n\tif(p[k].size() == 0) continue;\n\tif(i == k) continue;\n\tint sum = 0;\n\tfor(int j=0;j<p[i].size();j++){\n\t  if(p[i][j].o == -1) continue;\n\t  for(int l=0;l<p[k].size();l++){\n\t    if(p[k][l].o == -1) continue;\n\t    if(p[i][j].str != p[k][l].str) continue;\n\t    int ai = p[i][j].i;\n\t    int ao = p[i][j].o;\n\t    int bi = p[k][l].i;\n\t    int bo = p[k][l].o;\n\t    if(ai == bi && bo == ao) sum += bo - bi;\n\t    else if(ai == bi) sum += min(ao, bo) - ai;\n\t    else if(ao == bo) sum += max(ai, bi) - ao;\n\t    else if(ai < bi && bo < ao) sum += bo - bi;\n\t    else if(bi < ai && ao < bo) sum += ao - ai;\n\t    else if(ai < bi && bi < ao) sum += ao - bi;\n\t    else if(ai < bo && bo < ao) sum += bo - ai;\n\t  }\n\t}\n\tans = max(ans, sum);\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <set>\n#include <queue>\n#include <stack>\n#include <string>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n\n#define rep(i, n) for(int i = 0; i < n; i ++)\n#define COUNT(i, n) for(int i = 1; i <= n; i ++)\n#define ALL(T) T.begin(), T.end()\n#define mp make_pair\n#define pb push_back\n#define ITER(c) __typeof((c).begin())\n#define each(c, it) for(ITER(c) it = (c).begin(); it != (c).end(); it++)\n#define I first\n#define O second\n\nusing namespace std;\n\ntypedef pair<int, int> pii;\ntypedef unsigned long long ull;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\n\nconst int INF = 1 << 24;\nconst int N = 1000;\n\nint calc(int, int);\n\nint main(void){\n    for(int n, res; cin >> n, n; cout << res << endl){\n        pii god = mp(INF, 0);\n        vi ent(N), ttl(N);\n        string cur_d;\n\n        while(n--){\n            int h = 0, m = 0, p;\n            char e;\n            string MD, in;\n            cin >> MD >> in >> e >> p;\n\n            rep(i, 2) h += (in.at(i) - '0') * (int)pow(10., 1. - i);\n            rep(i, 2) m += (in.at(i + 3) - '0') * (int)pow(10., 1. - i);\n\n            if(MD != cur_d){\n                cur_d = MD;\n                god = mp(INF, 0);\n            }\n            int cur = calc(h, m);\n            if(e == 'I'){\n                if(p) ent[p] = cur;\n                else{\n                    COUNT(i, N - 1){\n                        if(ent[i] && god.O != INF){\n                            int del = god.O - max(god.I, ent[i]);\n                            if(del > 0) ttl[i] += del;\n                            ent[i] = cur;\n                        }\n                    }\n                    \n                    god.I = cur;\n                    god.O = INF;\n                }\n            }\n            else{\n                if(p){\n                    int del = min(god.O, cur) - max(god.I, ent[p]);\n                    if(del > 0) ttl[p] += del;\n                    ent[p] = 0;\n                }\n                else god.O = cur;\n            }\n        }\n        res = *max_element(ALL(ttl));\n    }\n\n    return 0;\n}\n\nint calc(int h, int m){\n    return 60 * h + m;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <complex>\n#include <algorithm>\n#include <set>\n#include <map>\n#include <queue>\n#include <string>\n#include <cstring>\n#include <stack>\n#include <cmath>\n#include <iomanip>\n#include <sstream>\n#include <cassert>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef ll li;\ntypedef pair<int,int> PI;\n#define EPS (1e-10L)\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define F first\n#define S second\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define SZ(a) (int)((a).size())\n#define ALL(a) a.begin(),a.end()\n#define CLR(a) memset((a),0,sizeof(a))\n#define FOR(it,a) for(__typeof(a.begin())it=a.begin();it!=a.end();++it)\nvoid pkuassert(bool t){t=1/t;};\nint dx[]={0,1,0,-1,1,1,-1,-1};\nint dy[]={1,0,-1,0,-1,1,1,-1};\n\nint n;\n\nvoid solve(){\n  set<string> in;\n  map<string,int> sum;\n  ll ans=0;\n  int bet;\n  rep(i,n){\n    string t;\n    cin >> t;\n    int h,m;\n    scanf(\" %d:%d\",&h,&m);\n    char c;\n    cin >> c >> t;\n    if(c=='I' && in.count(\"000\"))\n      FOR(it,in) sum[*it] += h*60+m-bet;\n    \n    if(c=='I') in.insert(t);\n\n    if(c=='O' && in.count(\"000\"))\n      FOR(it,in) sum[*it] += h*60+m-bet;\n    \n    if(c=='O') in.erase(t);\n    bet=h*60+m;\n  }\n  ans=0;\n  FOR(it,sum)\n    if(it->F!=\"000\")\n      ans=max(ans,(ll)it->S);\n  cout << ans << endl;\n}\n\n\nint main(int argc, char *argv[])\n{\n  while(cin >> n && n) solve();\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <queue>\n\nusing namespace std;\n\nint time2min (string s) {\n    char buf[] = {s[0],s[1],'\\0'};\n    char buf2[] = {s[3],s[4],'\\0'};\n    return atoi(buf)*60 + atoi(buf2);\n}\n\nint main()\n{\n    int n;\n    while (cin >> n, n) {\n        string predate =  \"00/00\";\n        queue<int> que;\n        int praytime[1000];\n        int lastin[1000];\n        fill_n((int *)praytime, 1000, 0);\n        for (int i = 0; i < n; i++) {\n            // input\n            string date, stime;\n            char io;\n            int id;\n            cin >> date >> stime >> io >> id;\n            int min = time2min(stime);\n\n            // if change date\n            if (predate != date) {\n                fill_n((int *)lastin, 1000, -1);\n                while (!que.empty()) {\n                    que.pop();\n                }\n            }\n\n            if (io == 'I') {\n                if (id != 0) {\n                    que.push(id);\n                } else { // goddess\n                    que.push(id);\n                    while (!que.empty()) {\n                        int d = que.front(); que.pop();\n                        if (d == 0) break;\n                        lastin[d] = min;\n                        que.push(d);\n                    }\n                }\n                lastin[id] = min;\n            }\n\n            if (io == 'O') {\n                if (id != 0) {\n                    if (lastin[0] != -1)\n                        praytime[id] += min - lastin[id];\n                    while (!que.empty()) {\n                        int d = que.front(); que.pop();\n                        if (d == id) break;\n                        que.push(d);\n                    }\n                } else { // goddess\n                    que.push(id);\n                    while (!que.empty()) {\n                        int d = que.front(); que.pop();\n                        if (d == 0) break;\n                        praytime[d] += min - lastin[id];\n                        que.push(d);\n                    }\n                }\n                lastin[id] = -1;\n            }\n            predate = date;\n        }\n        int ma = 0;\n        for (int i = 1; i < 1000; i++) {\n            ma = max(praytime[i], ma);\n        }\n        cout << ma << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<vector>\n\nusing namespace std;\n\ntypedef long long ll;\nconst int MAX = 1001;\nstruct data{int month,day,hour,min;};\n\nint mon[] = {0,31,28,31,30,31,30,31,31,30,31,30,31};\nll N,T[MAX];\ndata D[MAX];\nbool isInside[MAX];\n\nvoid init(){\n  fill(T,T+MAX,0);\n  fill(isInside,isInside+MAX,false);\n}\n\nll getTime(data d){\n  ll tmp = 0;\n\n  for(int i = 1; i < d.month; i++)\n    tmp += mon[i]*24*60;\n  \n  tmp += d.day*24*60;\n  tmp += d.hour*60;\n  tmp += d.min;\n  return tmp;\n}\n\nvoid solve(){\n\n  bool isIN = false;\n\n  vector<int> V;\n  for(int i = 0; i < N; i++){\n    data d;\n    char c;\n    int id;\n    scanf(\"%d/%d %d:%d %c %d\",&d.month,&d.day,&d.hour,&d.min,&c,&id);\n\n     if(id == 0){\n       isIN = (c == 'I');\n       \n       if(c == 'O'){\n\t for(int j = 1; j < MAX; j++)\n\t   if(isInside[j]) T[j] += getTime(d)-max(getTime(D[j]),getTime(D[0]));\n       }else D[0] = d;\n       continue;\n     }\n     \n    if(c == 'I'){\n      D[id] = d;\n      isInside[id] = true;\n    }else{\n      if(isIN && isInside[id]) T[id] += getTime(d)-getTime(D[id]);\n      isInside[id] = false;\n    }\n   }\n\n  ll ans = 0;\n  for(int i = 0; i < MAX; i++)\n    ans = max(ans,T[i]);\n  cout << ans << endl;\n}\n\nint main(){\n  while(cin >> N && N){\n    init();\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);++(i))\n#define each(itr,c) for(__typeof(c.begin()) itr=c.begin(); itr!=c.end(); ++itr)\n#define all(x) (x).begin(),(x).end()\n#define pb push_back\n#define fi first\n#define se second\n\ntypedef pair<int,int> pi;\n\nint convert(string date, string time)\n{\n    int d[12]={31,28,31,30,31,30,31,31,30,31,30,31};\n\n    int month=atoi(date.substr(0,2).c_str());\n    int day=atoi(date.substr(3,2).c_str());\n    int hour=atoi(time.substr(0,2).c_str());\n    int minute=atoi(time.substr(3,2).c_str());\n\n    int ret=0;\n    rep(i,month) ret+=60*24*d[i];\n    ret+=60*24*(day-1);\n    ret+=60*hour+minute;\n\n    return ret;\n}\n\nvector<pi> LOG[1000];\nint idx[1000];\n\nint main()\n{\n    int n;\n    while(cin >>n,n)\n    {\n        rep(i,1000)\n        {\n            LOG[i].clear();\n            idx[i]=0;\n        }\n\n        rep(i,n)\n        {\n            string date,time,inout,id;\n            cin >>date >>time >>inout >>id;\n\n            int m=convert(date,time);\n            int ID=atoi(id.c_str());\n\n            if(inout==\"I\") LOG[ID].pb(pi(m,-1));\n            else LOG[ID][idx[ID]++].se=m;\n        }\n\n        int ans=0;\n        for(int i=1; i<1000; ++i)\n        {\n            if(LOG[i].size()==0) continue;\n\n            int tmp=0;\n            int god=0,pro=0;\n            while(god<idx[0] && pro<idx[i])\n            {\n                int gl=LOG[0][god].fi, gr=LOG[0][god].se;\n                int pl=LOG[i][pro].fi, pr=LOG[i][pro].se;\n                if((pl<=gl && gl<pr) || (gl<=pl && pl<gr))\n                {\n                    int l=max(gl,pl), r=min(gr,pr);\n                    tmp+=r-l;\n                }\n\n                if(LOG[0][god].se<LOG[i][pro].se) ++god;\n                else ++pro;\n            }\n\n            ans=max(ans,tmp);\n        }\n        printf(\"%d\\n\", ans);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n\nusing namespace std;\n\ntypedef long long ll;\nconst int MAX = 1000;\nstruct data{int month,day,hour,min;};\n\nint mon[] = {0,31,28,31,30,31,30,31,31,30,31,30,31};\nll N,T[MAX];\ndata D[MAX];\nbool isInside[MAX];\n\nvoid init(){\n  fill(T,T+MAX,0);\n  fill(isInside,isInside+MAX,false);\n}\n\nll getTime(data d){\n  ll tmp = 0;\n\n  for(int i = 1; i < d.month; i++)\n    tmp += mon[i]*24*60;\n  \n  tmp += d.day*24*60;\n  tmp += d.hour*60;\n  tmp += d.min;\n  return tmp;\n}\n\nvoid solve(){\n\n  bool isIN = false;\n\n  for(int i = 0; i < N; i++){\n    data d;\n    char c;\n    int id;\n\n    scanf(\"%d/%d %d:%d %c %d\",&d.month,&d.day,&d.hour,&d.min,&c,&id);\n\n     if(id == 0){\n       isIN = (c == 'I');\n       \n       if(c == 'O'){\n\t for(int j = 1; j < MAX; j++)\n\t   if(isInside[j]) T[j] += getTime(d)-max(getTime(D[j]),getTime(D[0]));\n       }else D[0] = d;\n       continue;\n     }\n     \n    if(c == 'I'){\n      D[id] = d;\n      isInside[id] = true;\n    }else{\n      if(isIN && isInside[id]) T[id] += getTime(d)-getTime(D[id]);\n      isInside[id] = false;\n    }\n   }\n\n  ll ans = 0;\n  for(int i = 1; i < MAX; i++)\n    ans = max(ans,T[i]);\n  cerr << ans << endl;\n  cout << ans << endl;\n}\n\nint main(){\n  while(cin >> N && N){\n    init();\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n\nusing namespace std;\n\nconst int maxn = 1000;\n\nint n, godtime;\nint month[maxn], day[maxn], type[maxn], t[maxn], iid[maxn], cnt[maxn], intime[maxn], leave[20][40][maxn], enter[20][40][maxn];\nbool isenter[20][40];\n\nint main()\n{\n#ifdef LOCAL\n\tfreopen(\"A.in\", \"r\", stdin);\n#endif\n\twhile(scanf(\"%d\", &n)) {\n\t\tif(n == 0)\tbreak;\n\t\tmemset(cnt, 0, sizeof(cnt));\n\t\tgodtime = 0;\n\t\tfor(int i = 0; i < n; i++) {\n\t\t\tint m, d, h, s, id;\n\t\t\tchar c;\n\t\t\tscanf(\"%d/%d %d:%d %c %d\", &m, &d, &h, &s, &c, &id);\n\t\t\tmonth[i] = m;\tday[i] = d;\ttype[i] = c=='I'?1:0;\n\t\t\tiid[i] = id;\tt[i] = 60*h+s;\t\n\t\t\tif(id == 0)\t{\n\t\t\t\tisenter[m][d] = 1;\n\t\t\t\tif(c == 'I') {\n\t\t\t\t\tenter[m][d][godtime] = 60*h+s;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tleave[m][d][godtime] = 60*h+s;\n\t\t\t\t\tgodtime++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tmemset(intime, -1, sizeof(intime));\n\t\tfor(int i = 0; i < n; i++) {\n\t\t\tif(iid[i] == 0 || !isenter[month[i]][day[i]])\tcontinue;\n\t\t\tif(type[i] == 1)\tintime[iid[i]] = t[i];\n\t\t\telse {\n\t\t\t\tfor(int k = 0; k < godtime; k++) {\n\t\t\t\t\tint a = intime[iid[i]], b = t[i], c = enter[month[i]][day[i]][k], d = leave[month[i]][day[i]][k], id = iid[i];\n\t\t\t\t\tif(b <= c || a >= d)\tcontinue;\n\t\t\t\t\tif(a >= c && b <= d)\tcnt[id] += b-a;\n\t\t\t\t\telse if(a <= c && b >= d)\tcnt[id] += d-c;\n\t\t\t\t\telse if(b > d)\tcnt[id] += d-a;\n\t\t\t\t\telse\tcnt[id] += b-c;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans = 0;\n\t\tfor(int i = 1; i < 1000; i++)\n\t\t\tans = max(ans, cnt[i]);\n//\t\tfor(int i = 1; i <= 999; i++)\n//\t\t\tcout << cnt[i] << endl;\n//\t\tcout << \"d\\t\" << cnt[1] << endl;\n//\t\tif(n == 20)\t\n//\t\t\tfor(int i = 1; i <= 3; i++)\n//\t\t\t\tcout << cnt[i] << endl;\n\t\tprintf(\"%d\\n\", ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <string>\n#include <sstream>\n#include <stack>\n#include <algorithm>\n#include <cmath>\n#include <queue>\n#include <map>\n#include <set>\n#include <cstdlib>\n#include <bitset>\n#include <tuple>\n#include <assert.h>\n#include <deque>\n#include <bitset>\n#include <iomanip>\n#include <limits>\n#include <chrono>\n#include <random>\n#include <array>\n#include <unordered_map>\n#include <functional>\n#include <complex>\n#include <numeric>\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\n//constexpr long long MAX = 5100000;\nconstexpr long long INF = 1LL << 60;\nconstexpr int inf = 1000000007;\nconstexpr long long mod = 1000000007LL;\n//constexpr long long mod = 998244353LL;\nconst long double PI = acos((long double)(-1));\n\nusing namespace std;\ntypedef unsigned long long ull;\ntypedef long long ll;\ntypedef long double ld;\n\n\nvoid solve() {\n    int n; scanf(\"%d\", &n); if (n == 0) exit(0);\n    ll mo, d, h, mn, id;\n    char c;\n\n    ll res = 0;\n    bool in = false;\n    ll cur = -1;\n    map<ll, vector<ll>> mimos;\n    vector<ll> god(1600);\n    map<ll, ll> mp;\n    for (int i = 0; i < n; i++) {\n        scanf(\"%lld/%lld %lld:%lld %c %lld\", &mo, &d, &h, &mn, &c, &id);\n        ll t = h * 60 + mn;\n        ll p = mo * 32 + d;\n        if (cur != p) {\n            for (int i = 0; i + 1 < 1600; i++) god[i + 1] += god[i];\n            for (auto& p : mimos) {\n                vector<ll>& imos = p.second;\n                ll t = 0;\n                for (int i = 0; i < 1600; i++) {\n                    if (i) imos[i] += imos[i - 1];\n                    if (imos[i] and god[i]) {\n                        //cout << id<<\" \"<<i / 60 << \" \" << i % 60 << \" \" << imos[i] << endl;\n                        t++;\n                    }\n                }\n                mp[p.first] += t;\n            }\n            mimos.clear();\n            god.clear(); god.resize(1600);\n        }\n        cur = p;\n        if (id > 0) {\n            if (mimos.count(id)) {\n                if (c == 'I') mimos[id][t]++;\n                else mimos[id][t]--;\n            }\n            else {\n                mimos[id].resize(1600);\n                if (c == 'I') mimos[id][t]++;\n                else mimos[id][t]--;\n            }\n        }\n        else {\n            if (c == 'I') god[t]++;\n            else god[t]--;\n        }\n    }\n    for (int i = 0; i + 1 < 1600; i++) god[i + 1] += god[i];\n    for (auto& p : mimos) {\n        vector<ll>& imos = p.second;\n        ll t = 0;\n        for (int i = 0; i < 1600; i++) {\n            if (i) imos[i] += imos[i - 1];\n            if (imos[i] and god[i]) {\n                //cout << id << \" \" << i / 60 << \" \" << i % 60 << \" \" << imos[i] << endl;\n                t++;\n            }\n        }\n        mp[p.first] += t;\n    }\n    mimos.clear();\n    god.clear(); god.resize(1600);\n    for (auto p : mp) chmax(res, p.second);;\n    printf(\"%lld\\n\", res);\n}\nint main()\n{\n    /*\n    cin.tie(nullptr);\n    ios::sync_with_stdio(false);\n    */\n    int kkt = 89;\n    while (kkt) {\n        solve();\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <sstream>\n#include <vector>\n#include <map>\n#include <vector>\nusing namespace std;\n\nvector<pair<string, int> > V[1000];\n\nint hmToM(string s) {\n  replace(s.begin(), s.end(), ':', ' ');\n  stringstream ss;\n  ss << s;\n  int h, m;\n  ss >> h >> m;\n  return h*60 + m;\n}\n\nint solve() {\n  int ans = 0;\n  for(int i = 0; i < 1000; ++i) {\n    for(int j = 0; j < 1000; ++j) {\n      if(i == j) continue;\n      map<string, int> m;\n      for(int k = 0; k < V[i].size(); k+=2) {\n\tfor(int l = 0; l < V[j].size(); l+=2) {\n\t  int c;\n\t  if(V[i][k].first != V[j][l].first) continue;\n\t  if(V[i][k+1].second <= V[j][l].second) continue;\n\t  if(V[i][k].second >= V[j][l+1].second) continue;\n\t  if(V[i][k].second <= V[j][l].second && V[i][k+1].second >= V[j][l+1].second)\n\t    c = V[j][l+1].second - V[j][l].second;\n\t  else if(V[j][l].second <= V[i][k].second && V[j][l+1].second >= V[i][k+1].second)\n\t    c = V[i][k+1].second - V[i][k].second;\n\t  else \n\t    c = min(V[i][k+1].second - V[j][l].second, V[j][l+1].second - V[i][k].second);\n\t  m[V[i][k].first] += c;\n\t}\n      }\n      for(map<string,int>::iterator it = m.begin();\n\t  it != m.end(); ++it) {\n\tans = max(ans, it->second);\n      }\n    }\n  }\n  return ans;\n}\n\nint main() {\n  int N;\n  while(cin >> N && N) {\n    for(int i = 0; i < 1000; ++i) V[i].clear();\n    for(int i = 0; i < N; ++i) {\n      string in[3];\n      for(int j = 0; j < 3; ++j) cin >> in[j];\n      int id;\n      cin >> id;\n      V[id].push_back(make_pair(in[0], hmToM(in[1])));\n    }\n    cout << solve() << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  int n;\n  while(cin >> n && n) {\n    int t[1000],z[1000];\n    memset(t,-1,sizeof(t));\n    memset(z,0,sizeof(z));\n    while(n--) {\n      int h,m;\n      string _,a,b;\n      cin >> _;\n      scanf(\"%d%*c%d\",&h,&m);\n      cin >> a >> b;\n      int x,y=h*60+m;\n      stringstream ss;\n      ss << b;\n      ss >> x;\n      if(a==\"I\") t[x]=y;\n      else {\n\tif(x==0) {\n\t  for(int i=1; i<1000; i++) {\n\t    if(t[i]!=-1) z[i]+=y-max(t[0],t[i]);\n\t  }\n\t} else {\n\t  if(t[0]!=-1) z[x]+=y-max(t[0],t[x]);\n\t}\n\tt[x]=-1;\n      }\n    }\n    int ans=0;\n    for(int i=1; i<1000; i++) ans=max(ans,z[i]);\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\nconst int year1=372;\nconst int day1=1440;\nclass logdata\n{\n\tpublic:\n\tint day;\n\tint date;\n\tint visitor;\n\tlogdata()\n\t{}\n\tlogdata(string m,string t,string v)\n\t{\n\t\tvisitor=stoi(v);\n\t\tint big=(m[0]-'0')*10+(m[1]-'0');\n\t\tint little=(m[3]-'0')*10+(m[4]-'0');\n\t\tday=(big-1)*31+little;\n\t\tbig=(t[0]-'0')*10+(t[1]-'0');\n\t\tlittle=(t[3]-'0')*10+(t[4]-'0');\n\t\tdate=big*60+little;\n\t}\n};\nlogdata IO[1000];\nbool inroom[1000];//誰が部屋にいるか\nint during[1000];//goddessと一緒にいた時間\nstring indata[4];\n\n//IO[index-1]からIO[index]までの経過時間を求める\nint keika(int index)\n{\n\tint diffday=IO[index].day-IO[index-1].day;\n\tint difftime=IO[index].date-IO[index-1].date;\n\treturn diffday*day1+difftime;\n}\n\nint main()\n{\n\tint n;\n\twhile(1)\n\t{\n\t\tcin>>n;\n\t\tif(n==0)\n\t\t\tbreak;\n\t\tfor(int i=0;i<n;i++)\n\t\t{\n\t\t\tfor(int j=0;j<4;j++)\n\t\t\t\tcin>>indata[j];\n\t\t\tIO[i]=logdata(indata[0],indata[1],indata[3]);\n\t\t\tif(i>0)\n\t\t\t{\n\t\t\t\tif(IO[i].day<IO[i-1].day)\n\t\t\t\t\tIO[i].day+=((IO[i-1].day-IO[i].day)/year1+1)*year1;\n\t\t\t}\n\t\t}\n\t\t//input end\n\t\tfill(during,during+1000,0);\n\t\tfill(inroom,inroom+1000,false);\n\t\tfor(int i=0;i<n;i++)\n\t\t{\n\t\t\t//goddessがいるなら部屋にいる人の時間を加算する\n\t\t\tif(inroom[0])\n\t\t\t{\n\t\t\t\tint k=keika(i);\n\t\t\t\tfor(int j=1;j<1000;j++)\n\t\t\t\t{\n\t\t\t\t\tif(inroom[j])\n\t\t\t\t\t\tduring[j]+=k;\n\t\t\t\t}\n\t\t\t}\n\t\t\t//部屋にいる人\n\t\t\tinroom[IO[i].visitor]^=true;//反転\n\t\t}\n\t\tsort(during,during+1000);\n\t\treverse(during,during+1000);\n\t\tcout<<during[0]<<endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <deque>\n#include <list>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <utility>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <complex>\n#include <cmath>\n#include <limits>\n#include <climits>\n#include <ctime>\n#include <cassert>\n#include <numeric>\n#include <functional>\n#include <bitset>\n\nusing namespace std;\nusing lint = long long int;\nlong long int INF = 1001001001001001LL;\nint inf = 1000000007;\nlong long int MOD = 1000000007LL;\ndouble PI = 3.1415926535897932;\n\ntemplate<typename T1,typename T2>inline void chmin(T1 &a,const T2 &b){if(a>b) a=b;}\ntemplate<typename T1,typename T2>inline void chmax(T1 &a,const T2 &b){if(a<b) a=b;}\n\n#define ALL(a) a.begin(),a.end()\n#define RALL(a) a.rbegin(),a.rend()\n\n/* do your best */\n\n\n// quoted from beet-aizu\ntemplate <typename T, typename E, typename F, typename G>\nstruct SegmentTree{\n    // using F = function<T(T, T)>\n    // using G = function<T(T, E)>\n    int n;\n    F f;\n    G g;\n    T ti;\n    vector<T> dat;\n    SegmentTree(){};\n    SegmentTree(F f,G g,T ti):f(f),g(g),ti(ti){}\n    void init(int n_){    \n        n=1;\n        while(n<n_) n<<=1;\n        dat.assign(n<<1,ti);\n    }\n    void build(const vector<T> &v){\n        int n_=v.size();\n        init(n_);\n        for(int i=0;i<n_;i++) dat[n+i]=v[i];\n        for(int i=n-1;i;i--)\n            dat[i]=f(dat[(i<<1)|0],dat[(i<<1)|1]);\n    }\n    void update(int k,const E &x){\n        k += n;\n        dat[k] = g(dat[k], x);\n        while(k>>=1)\n            dat[k]=f(dat[(k<<1)|0],dat[(k<<1)|1]);    \n    }\n    T operator [](int k) const { return dat[k+n]; }\n    T query(int a,int b) const {\n        T vl=ti,vr=ti;\n        for(int l=a+n,r=b+n;l<r;l>>=1,r>>=1) {\n            if(l&1) vl=f(vl,dat[l++]);\n            if(r&1) vr=f(dat[--r],vr);\n        }\n        return f(vl,vr);\n    }\n\n    /* TODO わからない 聞く \n    template<typename C>\n    int find(int a,int b,C &check,int k,int l,int r){\n        if(!check(dat[k])||r<=a||b<=l) return -1;\n        if(k>=n) return k-n;\n        int m=(l+r)>>1;\n        int vl=find(a,b,check,(k<<1)|0,l,m);\n        if(~vl) return vl;\n        return find(a,b,check,(k<<1)|1,m,r);\n    }\n    template<typename C>\n    int find(int a,int b,C &check){\n        return find(a,b,check,1,0,n);\n    }*/\n    \n};\n\n\n/**  テンプレ\nint main(){\n**/\n\nbool solve() {\n  int n; cin >> n;\n  if(n == 0) return false;\n  vector<int> id(n);\n  vector<int> t(n);\n  vector<char> mode(n);\n  \n  for(int i = 0; i < n; i++) {\n    string a, b, c, ID; cin >> a >> b >> c >> ID;\n    // cerr << a.substr(3, 2) << \" \" << b.substr(0, 2) << \" \" << b.substr(3, 2) << endl;\n    int M = stoi(a.substr(0, 2));\n    int d = stoi(a.substr(3, 2));\n    int h = stoi(b.substr(0, 2));\n    int m = stoi(b.substr(3, 2));\n    assert(M <= 12);\n    assert(d <= 31);\n    assert(h <= 24);\n    assert(m <= 60);\n\n    t[i] = M * 32 * 24 * 60 + d * 24 * 60 + h * 60 + m;\n    id[i] = stoi(ID);\n    mode[i] = c[0];\n  }\n\n  vector<vector<int>> l(1000);\n  vector<vector<int>> r(1000);\n\n  for(int i = 0; i < n; i++) {\n    if(mode[i] == 'I') {\n      l[id[i]].push_back(t[i]);\n    } else {\n      r[id[i]].push_back(t[i]);\n    }\n  }\n  \n  vector<int> dat(13 * 32 * 25 * 61, 0);\n  \n  assert(l[0].size() == r[0].size());\n  for(int j = 0; j < l[0].size(); j++) {\n    int left = l[0][j];\n    int right = r[0][j];\n    for(int i = left; i < right; i++) dat[i] = 1;\n  }\n\n  using T = int;  // type T\n  using E = int;  // type E\n  auto f = [](T a, T b){ // return type T value\n    return a + b;\n  };\n  auto g = [](T a, E b){ // return type T value\n    return b;  // return b;\n  };\n  T ti = 0;  // identify element\n  SegmentTree<T, E, decltype(f), decltype(g)> sg(f, g, ti);  // don't change\n  sg.build(dat);   // 初期配列を代入\n  \n  vector<int> cnt(1000, 0);\n  for(int i = 1; i < 1000; i++) {\n    assert(l[i].size() == r[i].size());\n    for(int j = 0; j < l[i].size(); j++) {\n      int left = l[i][j];\n      int right = r[i][j];\n      cnt[i] += sg.query(left, right);\n    }\n  }\n\n  int ma = 0;\n  for(int i = 0; i < 1000; i++) ma = max(ma, cnt[i]);\n  cout << ma << endl;\n  \n  return true;\n}\n\nsigned main() {\n  \n  while(solve()) {}\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef vector<int> vec;\n\nint main() {\n    int N;\n    while(cin >> N, N) {\n        vector<string> md(N), person(N);\n        vec in(N), out(N);\n        map<string,int> res;\n        for(int i = 0; i < N; i++) {\n            int h, m;\n            char e, tmp;\n            string q, MD;\n            cin >> MD >> h >> tmp >> m >> e >> q;\n            if(e == 'I')\n                md[i] = MD, person[i] = q, in[i] = 60 * h + m;\n            else\n                md[i] = MD, person[i] = q, out[i] = 60 * h + m;\n            res[q] = 0;\n        }\n\n        for(int i = 0; i < N; i++) {\n            if(person[i] == \"000\" && in[i] > 0) {\n                int out0 = i + 1;\n                while(person[out0] != \"000\") out0++;\n                for(int j = 0; j < N; j++) {\n                    if(person[j] != \"000\" && md[i] == md[j] && in[j] > 0) {\n                        int outX = j + 1;\n                        while(person[outX] != person[j]) outX++;\n                        if(in[j] <= out[out0] || out[outX] >= in[i]) {\n                            res[person[j]] += min(out[out0], out[outX]) - max(in[j], in[i]);\n                        }\n                    }\n                }\n            }\n        }\n        int MAX = 0;\n        for(auto i : res)\n            MAX = max(MAX, i.second);\n\n        cout << MAX << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#include<cctype>\n#include<math.h>\n#include<string>\n#include<string.h>\n#include<stack>\n#include<queue>\n#include<vector>\n#include<utility>\n#include<set>\n#include<map>\n#include<stdlib.h>\n#include<iomanip>\n\nusing namespace std;\n\n#define ll long long\n#define ld long double\n#define EPS 0.0000000001\n#define INF 1e9\n#define MOD 1000000007\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define loop(i,a,n) for(i=a;i<(n);i++)\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\ntypedef vector<pii> vp;\n\nint gcd(int a, int b){\n    if(b==0) return a;\n    return gcd(b,a%b);\n}\nint lcm(int a, int b){\n    return a*b/gcd(a,b);\n}\n\nint toi(string s){\n    int ret = 0;\n    rep(i,s.size()){\n        ret *= 10;\n        ret += s[i]-'0';\n    }\n    return ret;\n}\n\n#define M 60*24+3\n\nint main(void) {\n    int i,j;\n    int n;\n    int days[13] = {0,31,28,31,30,31,30,31,31,30,31,30,31};\n    rep(i,12)days[i+1] += days[i];\n    while(cin >> n, n){\n        vector<vector<vp> > v(365,vector<vp>(1000));\n        rep(i,n){\n            string a,b,io,id;\n            cin >> a >> b >> io >> id;\n            int day = days[toi(a.substr(0,2))-1] + toi(a.substr(3,2));\n            int t = toi(b.substr(0,2))*60 + toi(b.substr(3,2));\n            v[day][toi(id)].push_back(pii(t,int(io==\"O\")));\n        }\n        vi sum(1000,0);\n        rep(i,365){\n            int god[M] = {};\n            rep(k,v[i][0].size()){\n                if(v[i][0][k].second) god[v[i][0][k].first]--;\n                else god[v[i][0][k].first]++;\n            }\n            rep(k,M-1)god[k+1] += god[k];\n            loop(j,1,1000)if(v[i][j].size()){\n                int t[M] = {};\n                rep(k,v[i][j].size()){\n                    if(v[i][j][k].second) t[v[i][j][k].first]--;\n                    else t[v[i][j][k].first]++;\n                }\n                rep(k,M-1)t[k+1] += t[k];\n                rep(k,M)if(god[k]&&t[k])sum[j]++;\n            }\n        }\n        sort(all(sum));\n        cout << sum[999] << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <sstream>\n#include <vector>\n#include <map>\n#include <vector>\nusing namespace std;\n\nvector<pair<string, int> > V[1000];\n\nint hmToM(string s) {\n  replace(s.begin(), s.end(), ':', ' ');\n  stringstream ss;\n  ss << s;\n  int h, m;\n  ss >> h >> m;\n  return h*60 + m;\n}\n\nint solve() {\n  int ans = 0;\n  for(int i = 0; i < 1000; ++i) {\n    for(int j = 0; j < 1000; ++j) {\n      if(i == j) continue;\n      map<string, int> m;\n      for(int k = 0; k < V[i].size(); k+=2) {\n\tfor(int l = 0; l < V[j].size(); l+=2) {\n\t  int c;\n\t  if(V[i][k].first != V[j][l].first) continue;\n\t  if(V[i][k+1].second <= V[j][l].second) continue;\n\t  if(V[i][k].second >= V[j][l+1].second) continue;\n\t  if(V[i][k].second <= V[j][l].second && V[i][k+1].second >= V[j][l+1].second)\n\t    c = V[j][l+1].second - V[j][l].second;\n\t  else if(V[j][l].second <= V[i][k].second && V[j][l+1].second >= V[i][k+1].second)\n\t    c = V[i][k+1].second - V[i][k].second;\n\t  else \n\t    c = min(abs(V[i][k+1].second - V[j][l].second), abs(V[j][l+1].second - V[i][k].second));\n\t  m[V[i][k].first] += c;\n\t}\n      }\n      for(map<string,int>::iterator it = m.begin();\n\t  it != m.end(); ++it) {\n\tans = max(ans, it->second);\n      }\n    }\n  }\n  return ans;\n}\n\nint main() {\n  int N;\n  while(cin >> N && N) {\n    for(int i = 0; i < 1000; ++i) V[i].clear();\n    for(int i = 0; i < N; ++i) {\n      string in[3];\n      for(int j = 0; j < 3; ++j) cin >> in[j];\n      int id;\n      cin >> id;\n      V[id].push_back(make_pair(in[0], hmToM(in[1])));\n    }\n    cout << solve() << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\nusing namespace std;\n\nint n;\nint prv[1000];\nint sum[1000];\nint m,d,h,mt;\nint t[1000];\nchar c[1000];\nint id[1000];\nbool f;\n\nint main(){\n  while(cin >> n,n){\n    for(int i=0;i<n;i++){\n      scanf(\"%d/%d %d:%d\",&m,&d,&h,&mt);\n      t[i] = m*40*24*60 + d*24*60 + h*60 + mt;\n      cin >> c[i];\n      cin >> id[i];\n    }\n    for(int i=0;i<1000;i++){\n      sum[i] = 0;\n      prv[i] = -1;\n    }\n\n    f = false;\n    for(int i=0;i<n;i++){\n      if(c[i] == 'I'){\n\tif(id[i] == 0){\n\t  f = true;\n\t  for(int j=1;j<n;j++){\n\t    if(prv[j]>=0)prv[j] = t[i];\n\t  }\n\t}else{\n\t  prv[id[i]] = t[i];\n\t}\n      }else{\n\tif(id[i] == 0){\n\t  f = false;\n\t  for(int j=1;j<n;j++){\n\t    if(prv[j]>=0){\n\t      sum[j] += t[i]-prv[j];\n\t      prv[j] = t[i];\n\t    }\n\t  }\n\t}else{\n\t  if(prv[id[i]]>=0 && f)sum[id[i]] += t[i]-prv[id[i]];\n\t  prv[id[i]] = -1;\n\t}\n      }\n    }\n\n    int ans = 0;\n    for(int i=1;i<1000;i++){\n      if(ans<sum[i])ans = sum[i];\n    }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cassert>\n#include <cmath>\n#include <complex>\n#include <cstdint>\n#include <cstdio>\n#include <deque>\n#include <functional>\n#include <iomanip>\n#include <iostream>\n#include <limits>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <tuple>\n#include <utility>\n#include <vector>\nusing namespace std;\n\nusing ll = long long;\n\nstruct entry {\n    int m, d, ts, id;\n    string a;\n\n    entry() {}\n};\n\nchar exist[1000][1440];\n\nint main() {\n    char ch;\n    string t, id;\n    while (true) {\n        int N;\n        cin >> N; if (N == 0) break;\n        vector<entry> v(N);\n        for (int j = 0; j < N; ++j) {\n            int h, s;\n            cin >> v[j].m >> ch >> v[j].d >> h >> ch\n                >> s >> v[j].a >> v[j].id;\n            v[j].ts = h * 60 + s;\n        }\n\n        const int END = 24*60;\n\n        int count[1000], since[1000], until[1000];\n        fill(count, count+1000, 0);\n        for (int j = 0; j < 1000; ++j) fill(exist[j], exist[j]+END, 0);\n\n        for (int j = 0; j < N; ++j) {\n            if (j > 0 && (v[j-1].m != v[j].m || v[j-1].d != v[j].d)) {\n                for (int t = 0; t < 24*60; ++t) {\n                    for (int j = 1; j < 1000; ++j) {\n                        count[j] += exist[0][t] * exist[j][t];\n                    }\n                }\n                for (int j = 0; j < 1000; ++j) fill(exist[j], exist[j]+END, 0);\n            }\n\n            const entry e = v[j];\n\n            if (e.a == \"I\") {\n                since[e.id] = e.ts;\n            } else {\n                until[e.id] = e.ts;\n                fill(exist[e.id]+since[e.id], exist[e.id]+until[e.id], 1);\n            }\n        }\n        for (int t = 0; t < 24*60; ++t) {\n            for (int j = 1; j < 1000; ++j) {\n                count[j] += exist[0][t] * exist[j][t];\n            }\n        }\n\n        int a = 0;\n        for (int j = 1; j < 1000; ++j) {\n            a = max(a, count[j]);\n        }\n        cout << a << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <algorithm>\n#include <cstdio>\n#include <functional>\n#include <iostream>\n#include <cfloat>\n#include <climits>\n#include <cstring>\n#include <cmath>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <time.h>\n#include <vector>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> i_i;\ntypedef pair<ll, int> ll_i;\ntypedef pair<double, int> d_i;\ntypedef pair<ll, ll> ll_ll;\ntypedef pair<double, double> d_d;\nstruct edge { int u, v; double w; };\n\nll MOD = 10000007;\nll _MOD = 1000000009;\ndouble EPS = 1e-10;\n\nint calc(int a, int b, int c, int d) {\n\treturn max(0, min(b, d) - max(a, c));\n}\n\nint main() {\n\tfor (;;) {\n\t\tint n; cin >> n;\n\t\tif (n == 0) break;\n\t\tvector< vector<int> > ti(1000), to(1000);\n\t\twhile (n--) {\n\t\t\tint M, D, h, m, p; char e;\n\t\t\tscanf(\"%d/%d %d:%d %c %d\", &M, &D, &h, &m, &e, &p);\n\t\t\tint t = ((M * 31 + D) * 24 + h) * 60 + m;\n\t\t\tif (e == 'I') ti[p].push_back(t);\n\t\t\telse if (e == 'O') to[p].push_back(t);\n\t\t\tcout << t << endl;\n\t\t}\n\t\tvector<int> sum(1000);\n\t\tfor (int p = 1; p < 1000; p++)\n\t\t\tfor (int i = 0; i < ti[p].size(); i++)\n\t\t\t\tfor (int j = 0; j < ti[0].size(); j++)\n\t\t\t\t\tsum[p] += calc(ti[p][i], to[p][i], ti[0][j], to[0][j]);\n\t\tint ans = 0;\n\t\tfor (int p = 1; p < 1000; p++)\n\t\t\tans = max(ans, sum[p]);\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n\nusing namespace std;\n\nint main()\n{\n\tint in[1000]; //inµÄ¢é©Ç¤©\n\tint stay[1000]; //ØÝJnÔ\n\tint sum[1000];\t//vØÝÔ\n\tint out;\n\tint n;\n\tint nowday, nowmon;\n\t\n\twhile( cin >> n, n)\n\t{\n\t\tmemset( in, 0, sizeof(in));\n\t\tmemset( stay, 0, sizeof(stay));\n\t\tmemset( sum, 0, sizeof(sum));\n\t\tout = 0;\n\t\t\n\t\tfor(int i = 0 ; i < n ; i++ )\n\t\t{\n\t\t\tint mt, dy, hr, mn, id, stime;\n\t\t\tchar c, io;\n\t\t\t\n\t\t\tcin >> mt >> c >> dy;\n\t\t\tcin >> hr >> c >> mn;\n\t\t\tcin >> io;\n\t\t\tcin >> id;\n\t\t\t\n\t\t\tstime = hr*60 + mn;\n\t\t\t\n\t\t\tif( io == 'I' )\n\t\t\t{\n\t\t\t\tin[id] = 1;\n\t\t\t\tstay[id] = mn + 60*hr;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif( id == 0 )\n\t\t\t\t{\n\t\t\t\t\tfor(int j = 0; j < 1000; j++ )\n\t\t\t\t\t{\n\t\t\t\t\t\tif( in[j] == 1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsum[j] += min( stime - stay[j], stime - stay[0] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif(in[0] == 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tsum[id] += min( stime - stay[id], stime - stay[0] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tin[id] = 0;\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\t\n\t\tfor( int i = 1; i < 1000 ; i++ )\n\t\t{\n\t\t\tif( sum[i] > out )\n\t\t\tout = sum[i];\n\t\t}\n\t\t\n\t\tcout << out << endl;\n\t}\n\t\n\treturn 0;\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <vector>\n#include <map>\nusing namespace std;\n\n#define INPOS -1\n\nint main(){\n  int n;\n  while(cin >> n, n){\n    int M, D, h, m, p;\n    char e;\n    int sum[1010];\n    int today[1010];\n    for(int i = 0 ; i < 1010 ; i++) sum[i] = 0, today[i] = INPOS;\n    \n    for(int i = 0 ; i < n ; i++){\n      scanf(\"%d/%d %d:%d %c %d\", &M, &D, &h, &m, &e, &p);\n      int T = h*60 + m;\n      \n      if(p == 0 && e == 'I') today[0] = T;      \n      else if(p == 0 && e == 'O'){\n\tfor(int i = 1 ; i <= 999 ; i++){\n\t  if(today[i] != INPOS) sum[i] += (T - max(today[0], today[i]));\n\t}\n\ttoday[0] = INPOS;\n      }\n      else if(p != 0 && e == 'I') today[p] = T;\n      else if(p != 0 && e == 'O'){\n\tif(today[0] != INPOS){\n\t  sum[p] += T - max(today[p], today[0]);\n\t}\n\ttoday[p] = INPOS;\t\n      }\n    }\n    \n    int ans = 0;\n    for(int i = 1 ; i <= 999 ; i++){\n      ans = max(ans, sum[i]);\n    }\n    cout << ans << endl;\n\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll ,ll > P;\n\nint N;\nll sec[1003];\nchar type[1003];\nstring id[1003];\n\nll cross(P p1,P p2) {\n    if(p1.fr<=p2.fr&&p2.sc<=p1.sc) {\n        return p2.sc-p2.fr;\n    }\n    else if(p2.fr<=p1.fr&&p1.sc<=p2.sc) {\n        return p1.sc-p1.fr;\n    }\n    else if(p1.fr<p1.fr&&p1.fr<=p2.sc) {\n        return p2.sc-p1.fr;\n    }\n    else if(p1.sc<p2.sc&&p2.fr<=p1.sc) {\n        return p1.sc-p2.fr;\n    }\n    else return 0;\n    return INF;\n}\n\nvoid solve() {\n    map<string,vector<P>> seg;\n    set<string> visitors;\n    rep(i,N) {\n        if(id[i]!=\"000\") visitors.insert(id[i]);\n        if(type[i]=='I') {\n            seg[id[i]].pb(P(sec[i],1e18));\n        }\n        else {\n            auto it=seg[id[i]].end();\n            it--;\n            it->second=sec[i];\n        }\n    }\n\n    map<string,ll> times;\n    for(auto visitor : visitors) {\n        for(const auto &e1 : seg[\"000\"]) for(const auto &e2 : seg[visitor]) {\n            //printf(\"[%s] %lld %lld -> %lld %lld : %lld\\n\",visitor.c_str(), e1.fr,e1.sc,e2.fr,e2.sc,cross(e1,e2));\n            times[visitor]+=cross(e1,e2);\n        }\n    }\n\n    ll ans=0;\n    for(auto visitor : visitors) ans=max(ans,times[visitor]);\n    cout<<ans/60<<endl;\n\n\n}\n\nint main() {\n    while(cin>>N) {\n        if(N==0) break;\n        rep(i,N) {\n            int M,D,h,m;\n            scanf(\"%d/%d %d:%d\",&M,&D,&h,&m);\n            sec[i]=2678400*M+86400*D+3600*h+60*m;\n            cin>>type[i];\n            cin>>id[i];\n        }\n        solve();\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <sstream>\n#include <vector>\n#include <map>\nusing namespace std;\n\nvector<int> V[1000];\n\nint hmToM(int d, int h, int m) {\n  return (d*24+h)*60 + m;\n}\n\npair<int,int> sToHM(string s) {\n  if(s == \"24:00\") cout << \"!\" << endl;\n  replace(s.begin(), s.end(), ':', ' ');\n  stringstream ss;\n  ss << s;\n  pair<int,int> p;\n  ss >> p.first >> p.second;\n  return p;\n}\n\nint getM(int day,string s) {\n  pair<int,int> p = sToHM(s);\n  return hmToM(day, p.first, p.second);\n}\n\nint solve() {\n  int ans = 0;\n  for(int i = 0; i == 0; ++i) {\n    for(int j = i+1; j < 1000; ++j) {\n      int sum = 0;\n      for(int k = 0; k < V[i].size(); k += 2) {\n\tfor(int l = 0; l < V[j].size(); l += 2) {\n\t  if(V[i][k+1] <= V[j][l]) continue;\n\t  if(V[j][l+1] <= V[i][k]) continue;\n\t  if(V[i][k] <= V[j][l] && V[j][l+1] <= V[i][k+1])\n\t    sum += V[j][l+1] - V[j][l];\n\t  else if(V[j][l] <= V[i][k] && V[i][k+1] <= V[j][l+1])\n\t    sum += V[i][k+1] - V[i][k];\n\t  else\n\t    sum += min(V[i][k+1] - V[j][l], V[j][l+1] - V[i][k]);\n\t}\n      }\n      ans = max(sum, ans);\n    }\n  }\n  return ans;\n}\n\nint main() {\n  int n;\n  while(cin >> n && n) {\n    string pre = \"\";\n    int day = 1;\n    for(int i = 0; i < 1000; ++i) V[i].clear();\n    for(int i = 0; i < n; ++i) {\n      string in[3];\n      int id;\n      cin >> in[0] >> in[1] >> in[2] >> id;\n      if(pre != in[0]) {\n\tpre = in[0];\n\tfor(int j = 0; j < 1000; ++j) {\n\t  if(V[j].size() % 2 != 0)\n\t    V[j].push_back(hmToM(day,24,0));\n\t}\n\t++day;\n      }\n      V[id].push_back(getM(day, in[1]));\n    }\n    for(int j = 0; j < 1000; ++j) {\n      if(V[j].size() % 2 != 0)\n\tV[j].push_back(hmToM(day, 24,0));\n    }\n    cout << solve() << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <fstream>\n#include <list>\nusing namespace std;\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toStr(T x) { ostringstream sout; sout << x; return sout.str(); }\ntypedef vector<int> vi;\ntypedef vector<vi>  vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define FOR(i,a,b) for(int i=(a);i<=(b);++i)\n#define REP(i,n) FOR(i,0,(n)-1)\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\nconst int INF = INT_MAX / 10;\n\nint main() {\n\tint n;\n\twhile (cin >> n, n) {\n\t\tint a, b;\n\t\tchar c;\n\t\tvi d(n), t(n), p(n);\n\t\tvector<char> e(n);\n\t\tint maxp = -1;\n\t\tREP(i, n) {\n\t\t\tcin >> a >> c >> b;\n\t\t\td[i] = a * 100 + b;\n\t\t\tcin >> a >> c >> b;\n\t\t\tt[i] = a * 60 + b;\n\t\t\tcin >> e[i] >> p[i];\n\t\t\tmaxp = max(maxp, p[i]);\n\t\t}\n\n\t\tvi isIn(maxp+1), inTime(maxp+1), sum(maxp+1);\n\t\tREP(i, n) {\n\t\t\tif (e[i] == 'I') {\n\t\t\t\tisIn[p[i]] = 1;\n\t\t\t\tinTime[p[i]] = t[i];\n\t\t\t\tif (p[i] == 0) {\n\t\t\t\t\tFOR(j, 1, maxp) {\n\t\t\t\t\t\tinTime[j] = t[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tisIn[p[i]] = 0;\n\t\t\t\tif (p[i] == 0) {\n\t\t\t\t\tFOR(j, 1, maxp) {\n\t\t\t\t\t\tif (isIn[j]) {\n\t\t\t\t\t\t\tsum[j] += t[i] - inTime[j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (isIn[0]) {\n\t\t\t\t\tsum[p[i]] += t[i] - inTime[p[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tint ans = 0;\n\t\tFOR(i, 1, maxp) {\n\t\t\tans = max(ans, sum[i]);\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef pair<int,int> pii;\n#define all(c) (c).begin(), (c).end()\n#define loop(i,a,b) for(ll i=a; i<ll(b); i++)\n#define rep(i,b) loop(i,0,b)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define lb lower_bound\n#define ub upper_bound\n#ifdef DEBUG\n#define dump(...) (cerr<<#__VA_ARGS__<<\" = \"<<(DUMP(),__VA_ARGS__).str()<<\" [\"<<__LINE__<<\"]\"<<endl)\nstruct DUMP:ostringstream{template<class T>DUMP &operator,(const T&t){if(this->tellp())*this<<\", \";*this<<t;return *this;}};\n#else\n#define dump(...)\n#endif\ntemplate<class T> ostream& operator<<(ostream& os, vector<T> const& v){\n    rep(i,v.size()) os << v[i] << (i+1==v.size()?\"\":\" \");\n    return os;\n}\n\nint n;\nint sum[1000], in[1000];\n\nint main(){\n    while(~scanf(\"%d\\n\", &n) && n){\n        memset(sum,0,sizeof(sum));\n        memset(in,-1,sizeof(in));\n        rep(i,n){\n            int M,D,h,m;\n            char s[2];\n            int id;\n            scanf(\"%02d/%02d %02d:%02d %s %03d \", &M, &D, &h, &m, s, &id);\n            // dump(M,D,h,m,s,id);\n            if(s[0] == 'I') in[id] = h*60+m;\n            else{\n                int t = h*60+m;\n                if(id==0){\n                    rep(j,1000)if(j){\n                        if(in[j]!=-1) sum[j] += t-max(in[j],in[0]);\n                    }\n                }else{\n                    if(in[0]!=-1) sum[id] += t-max(in[id],in[0]);\n                }\n                in[id] = -1;\n            }\n        }\n        printf(\"%d\\n\", *max_element(sum+1,sum+1000));\n    }\n}"
  },
  {
    "language": "C++",
    "code": "//include\n//------------------------------------------\n#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <deque>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <queue>\n\nusing namespace std;\n\n//typedef\n//------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef long long LL;\n\n//container util\n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define EACH(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n\n//repetition\n//------------------------------------------\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\n//constant\n//--------------------------------------------\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\n\nint main(){\n  int N;\n  while(cin>>N,N){\n\tint sum[1024], st[1024];\n\tfill(sum, sum+1024, 0);\n\tfill(st, st+1024, -1);\n\n\tREP(i,N){\n\t  int M,D,h,m,id; char ch;\n\t  scanf(\"%d/%d %d:%d %c %d\", &M, &D, &h, &m, &ch, &id);\n\t  int t = h * 60 + m;\n\t  if(ch == 'I')\n\t\tst[id] = t;\n\t  else{\n\t\tif(id == 0){\n\t\t  FOR(j,1,1024){\n\t\t\tif(st[j] > 0){\n\t\t\t  sum[j] += t - max(st[0], st[j]);\n\t\t\t}\n\t\t  }\n\t\t  st[id] = -1;\n\t\t}\n\t\telse{\n\t\t  if(st[0] > 0)\n\t\t\tsum[id] += t - max(st[0], st[id]);\n\t\t  st[id] = -1;\n\t\t}\n\t  }\n\t}\n\tint ans = 0;\n\tREP(i,1024) ans = max(ans, sum[i]);\n\tcout << ans << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#include<string.h>\n#include<time.h>\n\ntypedef struct U\n{\n\ttm L;\n\tint F,t;\n}U;\n\ntm set(int M,int D,int h,int m)\n{\n\ttm t={0,m,h,D,M,100,0};\n\treturn t;\n}\n\nint N,i,j,G,M,D,h,m,u,R;\nU X[1000];\n\nint main()\n{\n\tchar f;\n\tfor(;scanf(\"%d\\n\",&N),N;)\n\t{\n\t\tG=0;\n\t\tmemset(X,0,sizeof(X));\n\t\tfor(i=0;i<N;i++)\n\t\t{\n\t\t\tscanf(\"%2d/%2d%2d:%2d%*c%[IO]%d\",&M,&D,&h,&m,&f,&u);\n\t\t\ttm tmp1=set(M,D,h,m);\n\t\t\ttime_t tmp=mktime(&tmp1);\n\t\t\tif(f=='I')\n\t\t\t{\n\t\t\t\tif(u==0)\n\t\t\t\t\tG=1;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tX[u].F=1;\n\t\t\t\t}\n\t\t\t\tX[u].L=tmp1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(u==0)\n\t\t\t\t{\n\t\t\t\t\t\n\t\t\t\t\tfor(j=1;j<1000;j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(X[j].F==1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlong long aaa=mktime(&X[0].L);\n\t\t\t\t\t\t\tlong long  bbb=mktime(&X[j].L);\n\t\t\t\t\t\t\tdouble eee=difftime(tmp,aaa)/60;\n\t\t\t\t\t\t\tdouble fff=difftime(tmp,bbb)/60;\n\t\t\t\t\t\t\tX[j].t+=fff<eee?fff:eee;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tG=0;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif(G==1)\n\t\t\t\t\t{\n\t\t\t\t\t\tlong long aaa=mktime(&X[0].L);\n\t\t\t\t\t\tlong long  bbb=mktime(&X[u].L);\n\t\t\t\t\t\tdouble eee=difftime(tmp,aaa)/60;\n\t\t\t\t\t\tdouble fff=difftime(tmp,bbb)/60;\n\t\t\t\t\t\tX[u].t+=fff<eee?fff:eee;\n\t\t\t\t\t}\n\t\t\t\t\tX[u].F=0;\n\t\t\t\t\tX[u].L=tmp1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(i=1,R=0;i<1000;i++)\n\t\t\tR=R<X[i].t?X[i].t:R;\n\t\tprintf(\"%d\\n\",R);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstruct prog{\n  int month, day, h, m;\n  bool in;\n};\n\nint calc(prog state, prog tmp){\n  int res = (tmp.h*60 + tmp.m) - (state.h*60 + state.m) ;\n  return res >= 0 ? res : 0;\n}\n  \nint main(){\n  int n;\n  while(cin >> n, n){\n    vector<prog> state(n);\n    for(int i = 0; i < n; i++){\n      state[i].in = false;\n    }\n    prog tmp, prev;\n    int  id;\n    vector<int> sum(n, 0);\n    for(int i = 0; i < n; i++){\n      char in;\n      scanf(\"%d/%d %d:%d %c %d\\n\", &tmp.month, &tmp.day, &tmp.h, &tmp.m, &in, &id);\n      if(in == 'I')tmp.in = true;\n      else tmp.in = false;\n    \n      if(state[id].in == true && tmp.in == false){\n\tif(id == 0){\n\t  for(int i = 1; i < n; i++){\n\t    if(state[i].in)sum[i] += min(calc(state[0], tmp), calc(state[i], tmp));\n\t  }\n\t}\n      }\n      if(id == 0)prev = state[0];\n      state[id] = tmp; \n    }\n    int ans = 0;\n    for(int i = 0; i < n; i++){\n      ans = max(ans, sum[i]);\n    }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\n#define TIMES(i,n) for(int i = 0; i < (n); ++i)\n\nbool solve() {\n    int N;\n    scanf(\"%d\", &N);\n    if(N == 0) return false;\n    vector<int> bless(1000, 0);\n    vector<bool> present(1000, false);\n    int prev_time = 0;\n    int prev_date = 0;\n    TIMES(_, N) {\n        int month, day, h, m, id;\n        char event;\n        scanf(\"%d/%d %d:%d %c %d\", &month, &day, &h, &m, &event, &id);\n        const int date = month * 100 + day;\n        const int t = h*60 + m;\n        if(date != prev_date) {\n            if(present[0]) {\n                const int rem = 24*60 - prev_time;\n                TIMES(i, 1000) {\n                    if(present[i]) bless[i] += rem;\n                }\n            }\n            fill(present.begin(), present.end(), false);\n            prev_time = 0;\n        }\n        if(present[0]) {\n            TIMES(i, 1000) {\n                if(present[i]) bless[i] += t - prev_time;\n            }\n        }\n        present[id] = (event == 'I');\n        prev_time = t;\n        prev_date = date;\n    }\n    bless[0] = 0;\n    printf(\"%d\\n\", *max_element(bless.begin(), bless.end()));\n    return true;\n}\n\nint main() {\n    while(solve()) ;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i, a, b) for (int i = a; i < (b); ++i)\n#define trav(a, x) for (auto& a : x)\n#define all(x) begin(x), end(x)\n#define sz(x) (int)(x).size()\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef vector<int> vi;\n\nint enter[1005], mask[1005][1440], dirty[1005];\nint score[1005];\n\nvoid flush() {\n\t//fprintf(stderr, \"Flush\\n\");\n\n\trep(i, 0, 1005) {\n\t\tif (enter[i]) {\n\t\t\trep(j, enter[i], 1440) mask[i][j] = 1;\n\t\t\tenter[i] = 0;\n\t\t}\n\t}\n\n\t/*rep(i, 0, 1005) {\n\t\tif (dirty[i]) {\n\t\t\tfprintf(stderr, \"Info %d: \", i);\n\t\t\tbool ison = false;\n\t\t\tint starttime = 0;\n\t\t\tint diff = 0;\n\t\t\trep(j, 0, 1440) {\n\t\t\t\tif (mask[i][j] && (j == 0 || !mask[i][j - 1])) fprintf(stderr, \"%02d:%02d-\", j / 60, j % 60), ison = true, starttime = j;\n\t\t\t\tif (j != 0 && (!mask[i][j] && mask[i][j - 1])) {\n\t\t\t\t\tint thistime = 0;\n\t\t\t\t\tfor (int t = starttime; t < j; t++) if (mask[0][t]) thistime++;\n\t\t\t\t\tdiff = max(diff, thistime);\n\t\t\t\t\tfprintf(stderr, \"%02d:%02d(%d) \", j / 60, j % 60, thistime), ison = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (ison) {\n\t\t\t\tint thistime = 0;\n\t\t\t\tfor (int t = starttime; t < 2400; t++) if (mask[0][t]) thistime++;\n\t\t\t\tdiff = max(diff, thistime);\n\t\t\t\tfprintf(stderr, \"%02d:%02d(%d) \", 24, 0, thistime), ison = false;\n\t\t\t}\n\t\t\tscore[i] += diff;\n\t\t\tfprintf(stderr, \"\\n\");\n\t\t}\n\t}*/\n\n\trep(i, 1, 1005) {\n\t\tif (dirty[i]) {\n\t\t\tint diff = 0;\n\t\t\trep(j, 0, 1440) if (mask[0][j] && mask[i][j])\n\t\t\t\tdiff++;\n\t\t\tscore[i] += diff;\n\t\t\t//fprintf(stderr, \"Guy %d: +=%d\\n\", i, diff);\n\t\t}\n\t}\n\n\t// clean\n\trep(i, 0, 1005) {\n\t\tif (dirty[i]) {\n\t\t\tdirty[i] = 0;\n\t\t\tfill(mask[i], mask[i] + 1440, 0);\n\t\t\tenter[i] = 0;\n\t\t}\n\t}\n}\n\nint main() {\n\tcin.sync_with_stdio(false); cin.tie(0);\n\tcin.exceptions(cin.failbit);\n\n\tfor (;;) {\n\t\tint n; scanf(\"%d\", &n); if (!n) break;\n\n\t\tint month, day, hour, minute, id, prevmonth, prevday; char action;\n\t\trep(i, 0, n) {\n\t\t\tscanf(\"%d/%d %d:%d %c %d\\n\", &month, &day, &hour, &minute, &action, &id);\n\n\t\t\tif (i > 0 && (month != prevmonth || day != prevday)) {\n\t\t\t\tflush();\n\t\t\t}\n\n\t\t\t//fprintf(stderr, \"%d/%d %02d:%02d %c %d\\n\", month, day, hour, minute, action, id);\n\n\t\t\tif (action == 'I') {\n\t\t\t\tenter[id] = hour * 60 + minute;\n\t\t\t\tdirty[id] = 1;\n\t\t\t} else if (action == 'O') {\n\t\t\t\tfor (int j = enter[id]; j < hour * 60 + minute; j++)\n\t\t\t\t\tmask[id][j] = 1;\n\t\t\t\tenter[id] = 0;\n\t\t\t\tdirty[id] = 1;\n\t\t\t}\n\n\t\t\tprevmonth = month, prevday = day;\n\t\t}\n\t\tflush();\n\n\t\tint mxs = 0;\n\t\tfor (int i = 1; i < 1005; i++) mxs = max(mxs, score[i]);\n\t\tprintf(\"%d\\n\", mxs);\n\n\t\tfill(score, score + 1005, 0);\n\t\t//fprintf(stderr, \"----------------------------------------------------------\\n\");\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#define\tREP(i,x,n) for(int i=x;i<(int)n;i++)\n#define rep(i,n) REP(i,0,n)\nusing namespace std;\nbool goddess_in;\nint goddess_t;\nint n,hr,mi,p,ans;\nstring date;\nchar move;\nint total[1111];\nint man_t[1111];\nbool man_in[1111];\nvoid solve();\nint main(){\n\twhile(cin>>n&&n){\n\t\tans=0;\n\t\tmemset(man_t,0,sizeof(man_t));\n\t\tmemset(man_in,0,sizeof(man_in));\n\t\tmemset(total,0,sizeof(total));\n\t\tgoddess_in=false;\n\t\twhile(n--){\n\t\t\tcin>>date>>hr>>move>>mi>>move>>p;\n\t\t\tsolve();\n\t\t}\n\t\trep(i,1111){if(total[i])ans=max(ans,total[i]);}\n\t\tcout<<ans<<endl;\n\t}\n}\nvoid solve(){\n\tint t=hr*60+mi;\n\tif(move=='I'){\n\t\tif(p==0){\n\t\t\tgoddess_in=true;\n\t\t\tgoddess_t=t;\n\t\t}else{\n\t\t\tman_in[p]=true;\n\t\t\tman_t[p]=t;\n\t\t}\n\t}else{\n\t\tif(p==0){\n\t\t\tgoddess_in=false;\n\t\t\trep(i,1111){if(man_in[i])total[i]+=(t-max(goddess_t,man_t[i]));}\n\t\t}else{\n\t\t\tman_in[p]=false;\n\t\t\tif(goddess_in)total[p]+=(t-max(goddess_t,man_t[p])); \n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\nusing namespace std;\nint main(){\n  int n;\n  while(scanf(\"%d\",&n) , n){\n    bool login[1001] = {};\n    int cost[1001] = {}, prev[1001];\n    while(n--){\n      int time, U, h, m, id;\n      char buff;\n      scanf(\"%d/%d %d:%d %c %d\",&U,&U,&h,&m,&buff,&id);\n      time = h * 60 + m;\n      if(login[id]){\n        if(!id) for(int i = 1 ; i < 1001 ; i++ ){\n          if(login[i]) cost[i] += time - max(prev[0],prev[i]);\n        }else if(login[0]) cost[id] += time - max(prev[0],prev[id]);\n      }else prev[id] = time;\n      login[id] = !login[id];\n    }\n    printf(\"%d\\n\",*max_element(cost+1,cost+1000));\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n;\nint a[1000][1000];\nint t[1000];\n\nint main()\n{\n\twhile (scanf(\"%d\", &n), n){\n\t\tmemset(a, 0, sizeof(a));\n\t\t\n\t\tfor (int i = 0; i < n; i++){\n\t\t\tint hh, mm, id;\n\t\t\tchar str[2];\n\t\t\tscanf(\"%*s %d:%d %s %d\", &hh, &mm, str, &id);\n\t\t\tt[i] = hh * 60 + mm;\n\t\t\t\n\t\t\tif (str[0] == 'I') a[id][i]++;\n\t\t\telse a[id][i]--;\n\t\t}\n\t\t\n\t\tfor (int i = 0; i < 1000; i++){\n\t\t\tfor (int j = 0; j + 1 < n; j++){\n\t\t\t\ta[i][j + 1] += a[i][j];\n\t\t\t}\n\t\t}\n\t\t\n\t\tint res = 0;\n\t\tfor (int i = 1; i < 1000; i++){\n\t\t\tint sum = 0;\n\t\t\tfor (int j = 0; j + 1 < n; j++){\n\t\t\t\tif (a[0][j] && a[i][j]){\n\t\t\t\t\tsum += t[j + 1] - t[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tres = max(res, sum);\n\t\t}\n\t\t\n\t\tprintf(\"%d\\n\", res);\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nint main()\n{\n    for(;;){\n        int n;\n        cin >> n;\n        if(n == 0)\n        return 0;\n\n        vector<vector<string> > d(1000);\n        vector<vector<int> > t(1000);\n        for(int i=0; i<n; ++i){\n            string s;\n            int t1, t2;\n            char c;\n            int id;\n            cin >> s >> t1 >> c >> t2 >> c >> id;\n            d[id].push_back(s);\n            t[id].push_back(t1*60 + t2);\n        }\n\n        vector<int> sum(1000, 0);\n        for(unsigned i=0; i<t[0].size(); i+=2){\n            int t1 = t[0][i];\n            int t2 = t[0][i+1];\n            for(int j=1; j<1000; ++j){\n            for(unsigned k=0; k<t[j].size(); k+=2){\n                if(d[0][i] != d[j][k])\n                    continue;\n                int t3 = t[j][k];\n                int t4 = t[j][k+1];\n                sum[j] += max(0, min(t2, t4) - max(t1, t3));\n                }\n            }\n        }\n\n        cout << *(max_element(sum.begin(), sum.end())) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n\nusing namespace std;\n\nint main(){\n\tfor(int n;scanf(\"%d\",&n),n;){\n\t\tstatic bool t[1000][1440];\n\t\tint bless[1000]={},enter[1000]={},last[1000]={};\n\n\t\tint pre=-1;\n\t\trep(k,n+1){\n\t\t\tint date,id;\n\t\t\tif(k<n){\n\t\t\t\tint mon,day,hh,mm;\n\t\t\t\tscanf(\"%d%*c%d %d%*c%d %*c %d\",&mon,&day,&hh,&mm,&id);\n\t\t\t\tdate=31*mon+day;\n\n\t\t\t\tif(enter[id]==0){\n\t\t\t\t\tenter[id]=60*hh+mm;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tfor(int j=enter[id];j<60*hh+mm;j++) t[id][j]=true;\n\t\t\t\t\tenter[id]=0;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse date=7777777;\n\n\t\t\tif(pre!=date){\n\t\t\t\trep(i,1000) if(last[i]==pre) rep(j,1440) if(t[i][j] && t[0][j]) bless[i]++;\n\t\t\t\trep(i,1000) if(last[i]==pre) rep(j,1440) t[i][j]=false;\n\t\t\t}\n\t\t\tlast[id]=pre=date;\n\t\t}\n\n\t\tprintf(\"%d\\n\",*max_element(bless+1,bless+1000));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <algorithm>\n#include <iomanip>\n#include <cmath>\n#include <cassert>\n#include <map>\nusing namespace std;\n\nint toM(string t) {\n\tint h = atoi(t.substr(0, 2).c_str());\n\tint m = atoi(t.substr(3, 2).c_str());\n\treturn h * 60 + m;\n}\n\nstruct Data {\n\tstring day;\n\tint m;\n\tchar c;\n\tstring name;\n};\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tint n;\n\twhile(cin >> n, n) {\n\t\tmap<string, vector<Data> > D;\n\t\tfor(int i = 0; i < n; i++) {\n\t\t\tstring d, m, name;\n\t\t\tchar c;\n\t\t\tcin >> d >> m >> c >> name;\n\t\t\tData data = Data{ d, toM(m), c, name };\n\t\t\tD[d].push_back(data);\n\t\t}\n\n\t\tmap<string, int> sum;\n\t\tfor(auto& p : D) {\n\t\t\tmap<string, vector<int> > in, out;\n\t\t\tfor(Data& data : p.second) {\n\t\t\t\tif(data.c == 'I') {\n\t\t\t\t\tin[data.name].push_back(data.m);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tout[data.name].push_back(data.m);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvector<int> gin = in[\"000\"], gout = out[\"000\"];\n\t\t\tfor(auto& a : in) {\n\t\t\t\tstring name = a.first;\n\t\t\t\tif(name == \"000\") continue;\n\t\t\t\tfor(int i = 0; i < a.second.size(); i++) {\n\t\t\t\t\tfor(int j = 0; j < gin.size(); j++) {\n\t\t\t\t\t\tint l = max(in[name][i], gin[j]);\n\t\t\t\t\t\tint r = min(out[name][i], gout[j]);\n\t\t\t\t\t\tsum[name] += max(0, r - l);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tint ans = 0;\n\t\tfor(auto& p : sum) {\n\t\t\tans = max(ans, p.second);\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <stdbool.h>\n#include <string.h>\n\nint max(int a[], int n) {\n  int i, m = 0;\n  for(i = 1; i < n; i ++) {\n    if(a[m] < a[i]) { m = i; }\n  }\n\n  return m;\n}\n\nint main() {\n  int n;\n  int mon[1000], day[1000], hou[1000], min[1000];\n  char IO[1000][2];\n  int id[1000];\n  int time[2][1000];\n  int total[1000];\n\n  while(true) {\n    scanf(\"%d\", &n);\n    if(n == 0) break;\n\n    int i, j;\n    for(i = 0; i < n; i ++) {\n      scanf(\"%d/%d %d:%d %c %d\", &mon[i], &day[i], &hou[i], &min[i], IO[i], &id[i]);\n      time[0][i] = 0;\n      time[1][i] = 0;\n      total[i] = 0;\n    }\n\n    bool god_flg = false;\n    int in_flg[1000] = {0};\n    for(i = 0; i < n; i ++) {\n      if(id[i] == 0 && IO[i][0] == 'I') {\n\tgod_flg = true;\n\tfor(j = 0; j < 1000; j ++) {\n\t  time[0][j] = hou[i]*60 + min[i];\n\t}\n      }\n      else if(id[i] == 0 && IO[i][0] == 'O') {\n\tgod_flg = false;\n\tfor(j = 0; j < 1000; j ++) {\n\t  total[j] += in_flg[j]*(hou[i]*60 + min[i] - time[0][i]);\n\t}\n      }\n      else if(god_flg && IO[i][0] == 'I') {\n\ttime[0][id[i]] = hou[i]*60 + min[i];\n\tin_flg[id[i]] = 1;\n      }\n      else if(god_flg && IO[i][0] == 'O') {\n\ttime[1][id[i]] = hou[i]*60 + min[i];\n\ttotal[id[i]] += time[1][id[i]] - time[0][id[i]];\n\n\tin_flg[id[i]] = 0;\n      }\n      else if(!god_flg && IO[i][0] == 'I') {\n\tin_flg[id[i]] = 1;\n      }\n      else if(!god_flg && IO[i][0] == 'O') {\n\tin_flg[id[i]] = 0;\n      }\n    }\n    printf(\"%d\\n\", total[max(total, n)]);\n  }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef vector<int> vec;\n\nint main() {\n    int N;\n    while(cin >> N, N) {\n        vector<string> md(N), person(N);\n        vec in(N, -1), out(N, -1);\n        map<string,int> res;\n        for(int i = 0; i < N; i++) {\n            int h, m;\n            char e, tmp;\n            string q, MD;\n            cin >> MD >> h >> tmp >> m >> e >> q;\n            if(e == 'I')\n                md[i] = MD, person[i] = q, in[i] = 60 * h + m;\n            else\n                md[i] = MD, person[i] = q, out[i] = 60 * h + m;\n            res[q] = 0;\n        }\n\n        for(int i = 0; i < N; i++) {\n            if(person[i] == \"000\" && in[i] >= 0) {\n                int out0 = i + 1;\n                while(person[out0] != \"000\") out0++;\n                for(int j = 0; j < N; j++) {\n                    if(person[j] != \"000\" && md[i] == md[j] && in[j] >= 0) {\n                        int outX = j + 1;\n                        while(person[outX] != person[j]) outX++;\n                        if(in[j] <= out[out0] || out[outX] >= in[i]) {\n                            res[person[j]] += min(out[out0], out[outX]) - max(in[j], in[i]);\n                        }\n                    }\n                }\n            }\n        }\n        int MAX = 0;\n        for(auto i : res)\n            MAX = max(MAX, i.second);\n\n        cout << MAX << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint timetom(string s){\n    int h=stoi(s.substr(0,2));\n    int m=stoi(s.substr(3,2));\n    return h*60+m;\n}\n\nbool solve(){\n    int n;\n    cin>>n;\n    if(n==0)return false;\n    //vector<pair<pair<int,bool>,int>> d(n);//<time,io>,id\n    vector<vector<int>> d;\n    vector<int> tm(n);\n    map<string,int> mp;\n    int godind=-1;\n    for (int i = 0; i < n; ++i) {\n        string s,t;\n        cin>>s>>t;\n        tm[i]=timetom(t);\n        char c;\n        cin>>c;\n        string id;\n        cin>>id;\n        if(mp.find(id)==mp.end()){\n            mp[id]=d.size();\n            if(id==\"000\")godind=d.size();\n            d.emplace_back(vector<int>(n+1,0));\n        }\n        if(c=='I')++d[mp[id]][i];\n        else --d[mp[id]][i];\n    }\n    for(auto &i:d){\n        for (int j = 0; j < n; ++j) {\n            i[j+1]+=i[j];\n        }\n    }\n    if(godind==-1){\n        cout<<0<<endl;\n        return true;\n    }\n    int ans=0;\n    for (int i = 0; i < d.size(); ++i) {\n        if(i==godind)continue;\n        int tans=0;\n        for (int j = 0; j < n-1; ++j) {\n            if(d[i][j]==1&&d[godind][j]==1){\n                tans+=tm[j+1]-tm[j];\n            }\n        }\n        ans=max(ans,tans);\n    }\n    cout<<ans<<endl;\n    return true;\n}\n\nint main(){\n    while(solve());\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef pair<int,int> pii;\n#define all(c) (c).begin(), (c).end()\n#define loop(i,a,b) for(ll i=a; i<ll(b); i++)\n#define rep(i,b) loop(i,0,b)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define lb lower_bound\n#define ub upper_bound\n#ifdef DEBUG\n#define dump(...) (cerr<<#__VA_ARGS__<<\" = \"<<(DUMP(),__VA_ARGS__).str()<<\" [\"<<__LINE__<<\"]\"<<endl)\nstruct DUMP:ostringstream{template<class T>DUMP &operator,(const T&t){if(this->tellp())*this<<\", \";*this<<t;return *this;}};\n#else\n#define dump(...)\n#endif\ntemplate<class T> ostream& operator<<(ostream& os, vector<T> const& v){\n    rep(i,v.size()) os << v[i] << (i+1==v.size()?\"\":\" \");\n    return os;\n}\n\nint N;\nint sum[1000];\nvector<pair<int,int>> logs[1000];\n\nint exist[300000];\n\nint f(int m, int d, int h, int M){\n    return m*60*24*30 + d*60*24 + h*60 + M;\n}\n\nint main(){\n// #ifdef DEBUG\n//     freopen(\"in\",\"r\",stdin);\n// #endif\n    while(~scanf(\"%d\\n\",&N) && N){\n        rep(i,1000) logs[i].clear();\n        memset(exist,0,sizeof(exist));\n        memset(sum,0,sizeof(sum));\n        rep(i,N){\n            int t, id;\n            char io;\n            int m,d,h,M;\n            scanf(\"%d/%d %d:%d \", &m,&d,&h,&M);\n            t = f(m,d,h,M);\n            cin >> io >> id;\n            if(io=='I'){\n                logs[id].eb(t,f(m,d,24,0));\n                if(id==0) exist[t]++;\n            } else {\n                logs[id].back().second = t;\n                if(id==0) exist[t]--;\n            }\n        }\n        rep(i,300000-1) exist[i+1] += exist[i];\n        rep(i,300000-1) exist[i+1] += exist[i];\n        int ans = 0;\n        rep(i,1000)if(i){\n            for(auto & p : logs[i]){\n                int l,r;\n                tie(l,r) = p;\n                sum[i] += exist[r]-exist[l];\n            }\n            ans = max(ans, sum[i]);\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n\tlong long int N;\n\twhile(cin >> N , N)\n\t{\n\t\tmap<string , map<string , pair<long long int , long long int>>>data;\n\t\tfor(size_t i = 0; i < N; i++)\n\t\t{\n\t\t\tstring MD , who;\n\t\t\tcin >> MD;\n\t\t\tint h , m;\n\t\t\tchar c;\n\t\t\tcin >> h >> c >> m;\n\t\t\tcin >> c;\n\t\t\tcin >> who;\n\t\t\tif(c == 'I')\n\t\t\t{\n\t\t\t\tdata[MD][who].first = h * 60 + m;\n\t\t\t} else\n\t\t\t{\n\t\t\t\tdata[MD][who].second += h * 60 + m - data[MD][who].first;\n\t\t\t}\n\t\t}\n\t\tmap<long long int , long long int>ansmemo;\n\t\tlong long int ans1 , ans2;\n\t\tfor(auto x : data)\n\t\t{\n\t\t\t//cout<<x.first<<endl;\n\t\t\tfor(auto y : x.second)\n\t\t\t{\n\t\t\t\t//cout<<y.first<<endl;\n\t\t\t\t//cout<<y.second.second<<endl;\n\t\t\t\tansmemo[y.second.second]++;\n\t\t\t\tif(ans2 < ansmemo[y.second.second])\n\t\t\t\t{\n\t\t\t\t\tans2 = ansmemo[y.second.second];\n\t\t\t\t\tans1 = y.second.second;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans1 << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <algorithm>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <map>\n#include <vector>\n#include <stack>\n#include <queue>\n\nusing namespace std;\nint n;\nstruct Point\n{\n    int when;\n    Point() {\n    }\n    Point(int _when) {\n        when = _when;\n    }\n};\nvector<Point>time_stamp[100010];\nmap<string, int>dict;\nvector<string>ID;\nvoid Init() {\n    dict.clear();\n    ID.clear();\n    for(int i = 1; i <= n; i++) {\n        time_stamp[i].clear();\n    }\n}\nint tranTime(int hh, int mm) {\n    return hh * 60 + mm;\n}\nint godness;\n\nint Cut(int l, int r, int a, int b) {\n    int ret = 0;\n    if(r <= a || l >= b) {\n        return 0;\n    }\n    return min(b, r) - max(l, a);\n}\nint sum[100010];\nint tot;\nint ans = 0;\nvoid Solve() {\n    if(godness == -1) {\n        return ;\n    }\n    for(int i = 1; i <= tot; i++) {\n        if(i == godness) {\n            continue;\n        }\n        int st = 0, ed;\n        for(int j = 0; j < (int)time_stamp[i].size(); j += 2) {\n            int l, r;\n            l = time_stamp[i][j].when;\n            r = time_stamp[i][j + 1].when;\n            while(st < (int)time_stamp[godness].size() && time_stamp[godness][st + 1].when <= l) {\n                st += 2;\n            }\n            for(int k = st; k < (int)time_stamp[godness].size(); k += 2) {\n                sum[i] += Cut(l, r, time_stamp[godness][k].when, time_stamp[godness][k + 1].when);\n                if(time_stamp[godness][k].when >= r) {\n                    break;\n                }\n            }\n        }\n        ans = max(ans, sum[i]);\n    }\n\n}\nvoid Input() {\n    memset(sum, 0, sizeof(sum));\n    int month, day, hh, mm;\n    char IO[10];\n    string id;\n    Init();\n    int lastMonth;\n    int lastDay;\n    lastMonth = -1;\n    lastDay = -1;\n    godness = -1;\n    for(int i = 1; i <= n; i++) {\n        scanf(\"%d/%d %d:%d %s\", &month, &day, &hh, &mm, IO);\n        cin>>id;\n        if(!dict[id]) {\n            dict[id] = (int)dict.size();\n            tot = (int)dict.size();\n            if(id == \"000\") {\n                godness = dict[id];\n            }\n        }\n        if(lastMonth == month && lastDay == day) {\n            time_stamp[dict[id]].push_back(  Point(tranTime(hh, mm))  );\n        } else {\n            Solve();\n            for(int i = 1; i <= tot; i++) {\n                time_stamp[i].clear();\n            }\n            time_stamp[dict[id]].push_back(  Point(tranTime(hh, mm))  );\n        }\n        lastDay = day;\n        lastMonth = month;    \n    }\n    Solve();\n}\nint main() {\n    //freopen(\"input.txt\",\"r\",stdin);\n    while(scanf(\"%d\", &n) != EOF) {\n        if(n == 0) {\n            break;\n        }\n        ans = 0;\n        Input();\n        printf(\"%d\\n\", ans);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <stdio.h>\n#include <iostream>\n#include <map>\n\nusing namespace std;\n\ntypedef long long int ll;\n\nll max( ll p, ll q ) {\n\tif( p > q ) return p;\n\treturn q;\n}\nll solve(ll N);\n\nint main(void) {\n\n\tll N = 1;\n\twhile(true) {\n\t\tcin >> N;\n\t\tif( N == 0 ) { break; }\n\t\tcout << solve(N) << endl;\n\t}\n\n\treturn 0;\n}\n\nll solve( ll N ) {\n\n\tll ans = 0;\n\tmap<int,ll> mp;\t//mp[ID]=??\\??£?????????\n\tmap<int,ll> sum;\n\t\tmp[0] = -1;\n\t\tsum[0] = 0;\n\n\tfor( int i = 0; i < N; i++ ) {\n\n\t\tint M, D, h, m, p;\n\t\tchar e;\n\n\t\tscanf(\"%d/%d %d:%d %c %d\", &M,&D,&h,&m,&e,&p);\n\n\t\tif( e == 'I' ) {\n\t\t\tmp[p] = m+60*h;\n\t\t\tif( mp.find(p) == mp.end() ) {\n\t\t\t\t//?????????ID\n\t\t\t\tsum[p] = 0;\n\t\t\t}\n\t\t} else {\n\t\t\t//??????\n\t\t\t//??°????????????????????§??´?????????\n\t\t\tif( p == 0 ) {\n\t\t\t\t//?\\??\\??????????\n\t\t\t\tfor(auto it = mp.begin();it!=mp.end();++it){\n\t\t\t\t\tif( (*it).first == 0 || mp[(*it).first] < 0 ) { continue; }\n\t\t\t\t\tsum[(*it).first] += m+60*h - max( mp[p], mp[(*it).first] );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t//????????°???????????????\n\t\t\t\tif( mp[0] >= 0 ) {\n\t\t\t\t\tsum[p] += m+60*h - max( mp[p], mp[0] );\n\t\t\t\t}\n\t\t\t}\n\t\t\tmp[p] = -1;\n\t\t}\n\n\t}\n\n\tsum[0] = 0;\n\tfor( auto it = sum.begin(); it != sum.end(); ++it ) {\n\t\tans = max( (*it).second, ans );\n\t}\n\n\treturn ans;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nusing ll = long long;\n\nint main() {\n    int n;\n    while(cin >> n, n) {\n        vector<ll> v(1000);\n        vector<bool> entered(1000, false);\n        ll prev = 0;\n        for(int i=0; i<n; ++i) {\n            int mon, d, h, m, id;\n            char f;\n            scanf(\"%d/%d %d:%d %c %d\", &mon, &d, &h, &m, &f, &id);\n            int time = h * 60 + m;\n            if(entered[0]) {\n                for(int j=1; j<1000; ++j) {\n                    if(entered[j]) {\n                        v[j] += time - prev;\n                    }\n                }\n            }\n            entered[id] = 'I' == f;\n            prev = time;\n        }\n        cout << *max_element(v.begin(), v.end()) << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <sstream>\n#include <vector>\nusing namespace std;\n\nvector<int> V[1000];\n\nint hmToM(int h, int m) {\n  return h*60 + m;\n}\n\nint hmToM(string s) {\n  if(s == \"24:00\") cout << \"!\" << endl;\n  replace(s.begin(), s.end(), ':', ' ');\n  stringstream ss;\n  ss << s;\n  int h,m;\n  ss >> h >> m;\n  return hmToM(h,m);\n}\n\nint solve() {\n  int ans = 0;\n  for(int i = 0; i < 1000; ++i) {\n    for(int j = i+1; j < 1000; ++j) {\n      int sum = 0;\n      for(int k = 0; k < V[i].size(); k += 2) {\n\tfor(int l = 0; l < V[j].size(); l += 2) {\n\t  if(V[i][k+1] <= V[j][l]) continue;\n\t  if(V[j][l+1] <= V[i][k]) continue;\n\t  if(V[i][k] <= V[j][l] && V[j][l+1] <= V[i][k+1])\n\t    sum += V[j][l+1] - V[j][l];\n\t  else if(V[j][l] <= V[i][k] && V[i][k+1] <= V[j][l+1])\n\t    sum += V[i][k+1] - V[i][k];\n\t  else\n\t    sum += min(V[i][k+1] - V[j][l], V[j][l+1] - V[i][k]);\n\t}\n      }\n      ans = max(sum, ans);\n    }\n  }\n  return ans;\n}\n\nint main() {\n  int n;\n  while(cin >> n && n) {\n    string pre = \"\";\n    int day = 0;\n    for(int i = 0; i < 1000; ++i) V[i].clear();\n\n    for(int i = 0; i < n; ++i) {\n      string in[3];\n      int id;\n      cin >> in[0] >> in[1] >> in[2] >> id;\n      if(pre != in[0]) {\n\tpre = in[0];\n\t++day;\n\tfor(int j = 0; j < 1000; ++j) {\n\t  if(V[j].size() % 2 != 0)\n\t    V[j].push_back(hmToM(24*day,0));\n\t}\n      }\n      V[id].push_back(hmToM(in[1])+24*day*60);\n    }\n    ++day;\n    for(int j = 0; j < 1000; ++j) {\n      if(V[j].size() % 2 != 0)\n\tV[j].push_back(hmToM(24*day,0));\n    }\n    cout << solve() << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll ,ll > P;\n\nint N;\nll sec[1003];\nchar type[1003];\nstring id[1003];\n\nll cross(P p1,P p2) {\n    int m1=max(p1.fr,p2.fr);\n    int m2=min(p1.sc,p2.sc);\n\n    return max(0,m2-m1);\n}\n\nvoid solve() {\n    map<string,vector<P>> seg;\n    set<string> visitors;\n    rep(i,N) {\n        if(id[i]!=\"000\") visitors.insert(id[i]);\n        if(type[i]=='I') {\n            seg[id[i]].pb(P(sec[i],1e18));\n        }\n        else {\n            auto it=seg[id[i]].end();\n            it--;\n            it->second=sec[i];\n        }\n    }\n\n    map<string,ll> times;\n    for(auto visitor : visitors) {\n        for(const auto &e1 : seg[\"000\"]) for(const auto &e2 : seg[visitor]) {\n            //printf(\"[%s] %lld %lld -> %lld %lld : %lld\\n\",visitor.c_str(), e1.fr,e1.sc,e2.fr,e2.sc,cross(e1,e2));\n            times[visitor]+=cross(e1,e2);\n        }\n    }\n\n    ll ans=0;\n    for(auto visitor : visitors) ans=max(ans,times[visitor]);\n    cout<<ans/60<<endl;\n\n\n}\n\nint main() {\n    while(cin>>N) {\n        if(N==0) break;\n        rep(i,N) {\n            int M,D,h,m;\n            scanf(\"%d/%d %d:%d\",&M,&D,&h,&m);\n            sec[i]=2678400*M+86400*D+3600*h+60*m;\n            cin>>type[i];\n            cin>>id[i];\n        }\n        solve();\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<queue>\n#include<cstring>\nusing namespace std;\nconst int INF = 0x3ffffff;\nstruct Side{\n\tint to,next,t,m;\n}side[500];\nint node[101],top;\nvoid add_side(int u,int v,int t,int c){\n\tside[top]=(Side){v,node[u],t,c};node[u]=top++;\n}\nstruct E{\n\tint t,u,k,b;\n\tfriend bool operator < (const E &a,const E &b){\n\t\treturn a.t<b.t;\n\t}\n};\nint dis[101][5][5][201];\nint price[101][5];\nqueue<E>q[201];\nbool inqueue[101][5][5][201];\nint n,m,b,kk,st,r;\nint get_(E &a){\n\treturn dis[a.u][a.b][a.k][a.t];\n}\nvoid set_(E &a,int m){\n\tdis[a.u][a.b][a.k][a.t]=m;\n}\nbool in_(E &a){\n\treturn inqueue[a.u][a.b][a.k][a.t];\n}\nvoid set_in(E &a,bool m){\n\tinqueue[a.u][a.b][a.k][a.t]=m;\n}\nint get_ans(){\n\t/*\n\t   for(int i=1;i<=n;i++)\n\t   for(int b1=0;b1<=b;b1++)\n\t   for(int k1=0;k1<kk;k++)\n\t   for(int t1=0;t1<=t;t1++)dis[i][b1][k1][t1]=INF;\n\t   */\n\tmemset(dis,-1,sizeof(dis));\n\tmemset(inqueue,false,sizeof(inqueue));\n\tdis[1][0][0][0]=r;\n\tq[0].push((E){0,1,0,0});\n\tfor(int i=0;i<st;i++){\n\t\twhile(!q[i].empty()){\n\t\t\tE tmp,tm;\n\t\t\ttmp=q[i].front();q[i].pop();\n\t\t\tset_in(tmp,false);\n\t\t\tif(tmp.u==n)continue;\n\t\t\tfor(int i=node[tmp.u];i!=-1;i=side[i].next){\n\t\t\t\tint v=side[i].to;\n\t\t\t\tint t=tmp.t+side[i].t;\n\t\t\t\tint m=get_(tmp)-side[i].m;\n\t\t\t\tif(t>st||m<0)continue;\n\t\t\t\ttm.b=tmp.b;\n\t\t\t\ttm.u=v;\n\t\t\t\ttm.t=t;\n\t\t\t\ttm.k=tmp.k;\n\t\t\t\tif(m>get_(tm)){\n\t\t\t\t\tset_(tm,m);\n\t\t\t\t\tif(!in_(tm)){\n\t\t\t\t\t\tset_in(tm,true);\n\t\t\t\t\t\tq[t].push(tm);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(v==1||v==n)continue;\n\t\t\t\tif(tmp.b<b){\n\t\t\t\t\ttm.b=tmp.b+1;\n\t\t\t\t\tint mm=m-price[tm.u][tm.k];\n\t\t\t\t\tif(mm>get_(tm)){\n\t\t\t\t\t\tset_(tm,mm);\n\t\t\t\t\t\tif(!in_(tm)){\n\t\t\t\t\t\t\tset_in(tm,true);\n\t\t\t\t\t\t\tq[t].push(tm);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(tmp.b>0){\n\t\t\t\t\ttm.b=tmp.b-1;\n\t\t\t\t\tint mm=m+price[tm.u][tm.k];\n\t\t\t\t\tif(mm>get_(tm)){\n\t\t\t\t\t\tset_(tm,mm);\n\t\t\t\t\t\tif(!in_(tm)){\n\t\t\t\t\t\t\tset_in(tm,true);\n\t\t\t\t\t\t\tq[t].push(tm);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(tmp.u!=1&&tmp.u!=n){\n\t\t\t\tint t=tmp.t+1;\n\t\t\t\tint k=(tmp.k+1)%kk;\n\t\t\t\tint m=get_(tmp);\n\t\t\t\tif(t>st||m<0)continue;\n\t\t\t\ttm.b=tmp.b;\n\t\t\t\ttm.u=tmp.u;\n\t\t\t\ttm.t=t;\n\t\t\t\ttm.k=k;\n\t\t\t\tif(m>get_(tm)){\n\t\t\t\t\tset_(tm,m);\n\t\t\t\t\tif(!in_(tm)){\n\t\t\t\t\t\tset_in(tm,true);\n\t\t\t\t\t\tq[t].push(tm);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(tmp.b<b){\n\t\t\t\t\ttm.b=tmp.b+1;\n\t\t\t\t\tint mm=m-price[tm.u][tm.k];\n\t\t\t\t\tif(mm>get_(tm)){\n\t\t\t\t\t\tset_(tm,mm);\n\t\t\t\t\t\tif(!in_(tm)){\n\t\t\t\t\t\t\tset_in(tm,true);\n\t\t\t\t\t\t\tq[t].push(tm);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(tmp.b>0){\n\t\t\t\t\ttm.b=tmp.b-1;\n\t\t\t\t\tint mm=m+price[tm.u][tm.k];\n\t\t\t\t\tif(mm>get_(tm)){\n\t\t\t\t\t\tset_(tm,mm);\n\t\t\t\t\t\tif(!in_(tm)){\n\t\t\t\t\t\t\tset_in(tm,true);\n\t\t\t\t\t\t\tq[t].push(tm);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint ans=-1;\n\tfor(int i=0;i<=st;i++){\n\t\tfor(int bb=0;bb<=b;bb++){\n\t\t\tans=max(ans,dis[n][bb][0][i]);\n\t\t}\n\t}\n\treturn ans;\n}\n\nint main(){\n\tint T,ca=1;\n\tscanf(\"%d\",&T);\n\twhile(T--){\n\t\tprintf(\"Case #%d: \",ca++);\n\t\tscanf(\"%d%d%d%d%d%d\",&n,&m,&b,&kk,&r,&st);\n\t\tmemset(node,-1,sizeof(node));\n\t\ttop=0;\n\t\tfor(int k=0;k<kk;k++){\n\t\t\tfor(int s=1;s<=n;s++){\n\t\t\t\tscanf(\"%d\",&price[s][k]);\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<m;i++){\n\t\t\tint u,v,t,m;\n\t\t\tscanf(\"%d%d%d%d\",&u,&v,&t,&m);\n\t\t\tadd_side(u,v,t,m);\n\t\t}\n\t\tint ans=get_ans();\n\t\tif(ans==-1)printf(\"Forever Alone\\n\");\n\t\telse printf(\"%d\\n\",ans);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#define  _CRT_SECURE_NO_WARNINGS\n#pragma comment (linker, \"/STACK:526000000\")\n\n#include \"bits/stdc++.h\"\n\nusing namespace std;\ntypedef string::const_iterator State;\n#define eps 1e-11L\n#define MAX_MOD 1000000007LL\n#define GYAKU 500000004LL\n\n#define MOD 998244353LL\n#define seg_size 262144*2LL\n#define pb push_back\n#define mp make_pair\ntypedef long long ll;\n#define REP(a,b) for(long long (a) = 0;(a) < (b);++(a))\n#define ALL(x) (x).begin(),(x).end()\n\nunsigned long xor128() {\n\tstatic unsigned long x = 123456789, y = 362436069, z = 521288629, w = time(NULL);\n\tunsigned long t = (x ^ (x << 11));\n\tx = y; y = z; z = w;\n\treturn (w = (w ^ (w >> 19)) ^ (t ^ (t >> 8)));\n}\n\nvoid init() {\n\tiostream::sync_with_stdio(false);\n\tcout << fixed << setprecision(20);\n}\n#define int ll\n\nmap<pair<int,int>, int> cnter;\nvoid starter() {\n\tint cnt[13] = { 0,31,28,31,30,31,30,31,31,30,31,30,31 };\n\tint day = 1;\n\tint month = 1;\n\tint now = 60 * 24;\n\twhile (month != 13) {\n\t\tcnter[mp(month, day)] = now;\n\t\tnow += 60 * 24;\n\t\tday++;\n\t\tif (cnt[month] == day - 1) {\n\t\t\tday = 1;\n\t\t\tmonth++;\n\t\t}\n\t}\n\treturn;\n}\n\npair<int, int> goi(string s) {\n\tint a = (s[0] - '0') * 10 + s[1] - '0';\n\tint b = (s[3] - '0') * 10 + s[4] - '0';\n\treturn mp(a, b);\n}\n\nvoid solve(){\n\tstarter();\n\twhile (true) {\n\t\tint n;\n\t\tcin >> n;\n\t\tif (n == 0) return;\n\t\tvector<tuple<int, string, int>> gogo;\n\t\tREP(i, n) {\n\t\t\tstring a, b, c, d;\n\t\t\tcin >> a >> b >> c >> d;\n\t\t\tpair<int, int> e = goi(a);\n\t\t\tpair<int, int> f = goi(b);\n\t\t\tgogo.push_back(make_tuple(cnter[e] + f.first * 60 + f.second, c, stoll(d)));\n\t\t}\n\t\tsort(ALL(gogo));\n\t\tset<int> now_here;\n\t\tmap<int, int> winning;\n\t\tREP(i, gogo.size()) {\n\t\t\tif (now_here.find(0) != now_here.end()) {\n\t\t\t\tfor (auto x : now_here) {\n\t\t\t\t\tif (x == 0) continue;\n\t\t\t\t\twinning[x] += get<0>(gogo[i]) - get<0>(gogo[i - 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (get<1>(gogo[i]) == \"I\") {\n\t\t\t\tnow_here.insert(get<2>(gogo[i]));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnow_here.erase(get<2>(gogo[i]));\n\t\t\t}\n\t\t}\n\t\tint now_max = 0;\n\t\tfor (auto x : winning) {\n\t\t\tnow_max = max(now_max, x.second);\n\t\t}\n\t\tcout << now_max << endl;\n\t}\n}\n\n#undef int\nint main() {\n\tinit();\n\tsolve();\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint N;\nint bless[1000];\nint state[1000];\n\nint tominute(string& time){\n\treturn stoi(time.substr(0, 2)) * 60 + stoi(time.substr(3, 2));\n}\n\nint main(){\n\twhile(cin >> N, N){\n\t\tfor(int i = 0; i < 1000; i++){\n\t\t\tbless[i] = 0;\n\t\t\tstate[i] = 0;\n\t\t}\n\t\tstring prev = \"\";\n\t\tint prevm = 0;\n\t\tfor(int i = 0; i < N; i++){\n\t\t\tstring day, time;\n\t\t\tchar c;\n\t\t\tint id;\n\t\t\tcin >> day >> time >> c >> id;\n\t\t\tint m = tominute(time);\n\t\t\tint dm;\n\t\t\tif(day == prev){\n\t\t\t\tdm = m - prevm;\t\n\t\t\t}else{\n\t\t\t\tdm = m;\n\t\t\t}\n\t\t\tif(state[0]){\n\t\t\t\tfor(int i = 1; i < 1000; i++){\n\t\t\t\t\tif(state[i]){\n\t\t\t\t\t\tbless[i] += dm;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(c == 'I'){\n\t\t\t\tstate[id] = 1;\n\t\t\t}else{\n\t\t\t\tstate[id] = 0;\n\t\t\t}\n\t\t\t\n\t\t\tprev = day;\n\t\t\tprevm = m;\n\t\t}\n\t\tint mv = 0;\n\t\tfor(int i = 1; i < 1000; i++){\n\t\t\tmv = max(mv, bless[i]);\n\t\t}\n\t\tcout << mv << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include\"bits/stdc++.h\"\n\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\nusing pii = pair<int, int>;\nusing pll = pair<ll, ll>;\n\n#define FOR(k,m,n) for(ll (k)=(m);(k)<(n);(k)++)\n#define REP(i,n) FOR((i),0,(n))\n#define WAITING(str) int str;std::cin>>str;\n#define DEBUGING(str) cout<< #str << \" \" str<<endl\n\nconstexpr int INF = (1 << 30);\nconstexpr ll INFL = (1ll << 60);\nconstexpr ll MOD = 1000000007;// 10^9+7\n\nstruct Time {\n\tTime() :h(0), m(0), idx(\"\") {}\n\tTime(string time, string _idx) :idx(_idx) {\n\t\th = (time[0] - '0') * 10 + (time[1] - '0');\n\t\tm = (time[3] - '0') * 10 + (time[4] - '0');\n\t}\n\tint h, m;\n\tstring idx;\n\tint diff(const Time& opp)const {\n\t\treturn (h - opp.h) * 60 + (m - opp.m);\n\t}\n};\n\nint main()\n{\n\twhile (true) {\n\t\tint n;\n\t\tcin >> n;\n\t\tif (!n)break;\n\n\t\tTime goddess;\n\t\tmap<string, Time> mp;\n\t\tmap<string, int> res;\n\t\tREP(i, n) {\n\t\t\tstring date, time, kind, id;\n\t\t\tcin >> date >> time >> kind >> id;\n\t\t\tTime tgt(time, id);\n\n\t\t\tif (kind == \"I\") {\n\t\t\t\t(tgt.idx == \"000\" ? goddess : mp[tgt.idx]) = tgt;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (tgt.idx == \"000\") {\n\t\t\t\t\tfor (auto itr = mp.begin(); itr != mp.end(); ++itr) {\n\t\t\t\t\t\tstring name = itr->first;\n\t\t\t\t\t\tTime opp = itr->second;\n\t\t\t\t\t\tres[name] += opp.diff(goddess) > 0\n\t\t\t\t\t\t\t? tgt.diff(opp)\n\t\t\t\t\t\t\t: tgt.diff(goddess);\n\t\t\t\t\t}\n\t\t\t\t\tgoddess = Time();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (goddess.h != 0) {\n\t\t\t\t\t\tTime in = mp[tgt.idx];\n\t\t\t\t\t\tres[tgt.idx] += in.diff(goddess) > 0\n\t\t\t\t\t\t\t? tgt.diff(in)\n\t\t\t\t\t\t\t: tgt.diff(goddess);\n\t\t\t\t\t}\n\t\t\t\t\tmp.erase(tgt.idx);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tint mm = 0;\n\t\tfor (auto itr = res.begin(); itr != res.end(); ++itr)\n\t\t\tmm = max(mm, itr->second);\n\t\tcout << mm << endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr, __VA_ARGS__)\n//#define LOG(...)\n#define FOR(i, a, b) for(int i=(int)(a); i<(int)(b); ++i)\n#define REP(i, n) for(int i=0; i<(int)(n); ++i)\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EXIST(s, e) ((s).find(e)!=(s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n#define SQ(n) (n) * (n)\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nint main() {\n  int n, month, day, hour, minite, id;\n  char io;\n  while(cin >> n, n) {\n    vi visiters(1000, -1);\n    vi times(1000);\n    REP(i, n){\n      scanf(\"%d/%d %d:%d %c %d\", &month, &day, &hour, &minite, &io, &id);\n      int t = hour * 60 + minite;\n      if (io == 'I') {\n        visiters[id] = t;\n      }else{\n        if(id == 0) {\n          FOR(i, 1, 1000){\n            if(visiters[i] != -1) {\n              times[i] += t - max(visiters[i], visiters[0]);\n            }\n          }\n        }else{\n          if(visiters[0] != -1) {\n            times[id] += t - max(visiters[id], visiters[0]);\n          }\n        }\n        visiters[id] = -1;\n      }\n    }\n    RSORT(times);\n    cout << times[0] << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll ,ll > P;\n\nint N;\nll sec[1003];\nchar type[1003];\nstring id[1003];\n\nll cross(P p1,P p2) {\n    if(p1.fr<=p2.fr&&p2.sc<=p1.sc) {\n        return p2.sc-p2.fr;\n    }\n    else if(p2.fr<=p1.fr&&p1.sc<=p2.sc) {\n        return p1.sc-p1.fr;\n    }\n    else if(p1.fr<p1.fr&&p1.fr<=p2.sc) {\n        return p2.sc-p1.fr;\n    }\n    else if(p1.sc<p2.sc&&p2.fr<=p1.sc) {\n        return p1.sc-p2.fr;\n    }\n    else return 0;\n    return INF;\n}\n\nvoid solve() {\n    map<string,vector<P>> seg;\n    set<string> visitors;\n    rep(i,N) {\n        if(id[i]!=\"000\") visitors.insert(id[i]);\n        if(type[i]=='I') {\n            seg[id[i]].pb(P(sec[i],0));\n        }\n        else {\n            auto it=seg[id[i]].end();\n            it--;\n            it->second=sec[i];\n        }\n    }\n\n    map<string,ll> times;\n    for(auto visitor : visitors) {\n        for(const auto &e1 : seg[\"000\"]) for(const auto &e2 : seg[visitor]) {\n            //printf(\"[%s] %lld %lld -> %lld %lld : %lld\\n\",visitor.c_str(), e1.fr,e1.sc,e2.fr,e2.sc,cross(e1,e2));\n            times[visitor]+=cross(e1,e2);\n        }\n    }\n\n    ll ans=0;\n    for(auto visitor : visitors) ans=max(ans,times[visitor]);\n    cout<<ans/60<<endl;\n\n\n}\n\nint main() {\n    while(cin>>N) {\n        if(N==0) break;\n        rep(i,N) {\n            int M,D,h,m;\n            scanf(\"%d/%d %d:%d\",&M,&D,&h,&m);\n            sec[i]=2678400*M+86400*D+3600*h+60*m;\n            cin>>type[i];\n            cin>>id[i];\n        }\n        solve();\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,a,b) for(int i=a;i<b;i++)\n#define MAX_NUM 1005\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\n\nint main()\n{\n\twhile (1)\n\t{\n\t\tint n; cin >> n;\n\t\tif (n == 0) return 0;\n\n\t\tvvi imos(MAX_NUM, vi(31 * 60 * 60 + 5, 0));\n\t\trep(i, 0, n)\n\t\t{\n\t\t\tstring md; cin >> md;\n\t\t\tint d = (md[3] - '0') * 10 + (md[4] - '0');\n\t\t\tstring hm; cin >> hm;\n\t\t\tint h = (hm[0] - '0') * 10 + (hm[1] - '0');\n\t\t\tint m = (hm[3] - '0') * 10 + (hm[4] - '0');\n\n\t\t\tchar e; cin >> e;\n\t\t\tint p; cin >> p;\n\t\t\tif (e == 'I')\n\t\t\t\timos[p][d * 60 * 60 + h * 60 + m]++;\n\t\t\telse\n\t\t\t\timos[p][d * 60 * 60 + h * 60 + m+1]--;\n\t\t}\n\n\t\trep(i, 0, MAX_NUM) rep(j, 1, 31 * 60 * 60 + 5) imos[i][j] += imos[i][j - 1];\n\t\trep(i, 1, MAX_NUM) rep(j, 0, 31 * 60 * 60 + 5) imos[i][j] *= imos[0][j];\n\n\t\tint ans = 0;\n\t\trep(i, 1, MAX_NUM)\n\t\t{\n\t\t\tint left = -1;\n\t\t\tif (imos[i][0] > 0) left = 0;\n\t\t\tint sum = 0;\n\t\t\trep(j, 1, 31*60*60+5)\n\t\t\t{\n\t\t\t\tif (imos[i][j] > 0)\n\t\t\t\t{\n\t\t\t\t\tif (left < 0) left = j;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (left >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tsum += j - left - 1;\n\t\t\t\t\t\tleft = -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tans = max(ans, sum);\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-9;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\nint main() {\n  /*int N, M; cin >> N >> M;\n  for (int i = 0; i < N; ++i) {\n    int x, y; cin >> x >> y;\n  }\n  for (int i = 0; i < M; ++i) {\n    int p, q; cin >> p >> q;\n  }*/\n  \n  while (1) {\n    int N; cin >> N;\n    if (!N)break;\n\n    vector<long long int>times(1000);\n    int preminute = 0;\n    vector<bool>isin(1000);\n    for (int i = 0; i < N; ++i) {\n      string day, time, inout, num; cin >> day >> time >> inout >> num;\n      const int minute = stoi(time.substr(0, 2)) * 60 + stoi(time.substr(3, 2));\n      const int prayer = stoi(num);\n      bool in = inout == \"I\";\n      if (isin[0]) {\n        for (int i = 1; i < 1000; ++i) {\n          if (isin[i])times[i] += minute - preminute;\n        }\n      }\n      isin[prayer] = in;\n      preminute = minute;\n    }\n    long long int ans = *max_element(times.begin(), times.end());\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nchar str[10];\nint tot[1010];\nint in[1010];\nint main(){\n\tint a;\n\twhile(scanf(\"%d\",&a),a){\n\t\tfor(int i=0;i<1000;i++)tot[i]=0;\n\t\tfor(int i=0;i<1000;i++)in[i]=-1;\n\t\tfor(int i=0;i<a;i++){\n\t\t\tint p,q,r;\n\t\t\tscanf(\"%s%d:%d%s%d\",str,&p,&q,str,&r);\n\t\t\tp=p*60+q;\n\t\t\tif(str[0]=='I')in[r]=p;\n\t\t\telse{\n\t\t\t\tif(r){\n\t\t\t\t\tif(~in[0])tot[r]+=p-max(in[0],in[r]);\n\t\t\t\t}else{\n\t\t\t\t\tfor(int i=1;i<1000;i++)if(~in[i])tot[i]+=p-max(in[i],in[0]);\n\t\t\t\t}\n\t\t\t\tin[r]=-1;\n\t\t\t}\n\t\t}\n\t\tint ret=0;\n\t\tfor(int i=1;i<1000;i++)ret=max(ret,tot[i]);\n\t\tprintf(\"%d\\n\",ret);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cassert>// c\n#include <ctime>\n#include <iostream>// io\n#include <iomanip>\n#include <fstream>\n#include <sstream>\n#include <vector>// container\n#include <map>\n#include <set>\n#include <queue>\n#include <bitset>\n#include <stack>\n#include <algorithm>// other\n#include <complex>\n#include <numeric>\n#include <functional>\n#include <random>\n#include <regex>\n#include <tuple>\n\nusing namespace std;\ntypedef long long ll;\n\n#define ALL(c) (c).begin(),(c).end()\n#define FOR(i,l,r) for(int i=(int)l;i<(int)r;++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORr(i,l,r) for(int i=(int)r-1;i>=(int)l;--i)\n#define REPr(i,n) FORr(i,0,n)\n#define EACH(i,c) for(__typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define IN(l,v,r) ((l)<=(v) && (v)<(r))\n#define UNIQUE(v) v.erase(unique(ALL(v)),v.end())\n//debug\n#define DUMP(x)  cerr << #x << \" = \" << (x)\n#define LINE()    cerr<< \" (L\" << __LINE__ << \")\"\n\ntemplate<typename T,typename U> T pmod(T x,U M){return (x%M+M)%M;}\n\ntypedef long long ll;\n\n//output\ntemplate<typename T> ostream& operator << (ostream& os, const vector<T>& as){REP(i,as.size()){if(i!=0)os<<\" \"; os<<as[i];}return os;}\ntemplate<typename T> ostream& operator << (ostream& os, const vector<vector<T>>& as){REP(i,as.size()){if(i!=0)os<<endl; os<<as[i];}return os;}\ntemplate<typename T> ostream& operator << (ostream& os, const set<T>& ss){for(auto a:ss){if(a!=ss.begin())os<<\" \"; os<<a;}return os;}\ntemplate<typename T1,typename T2> ostream& operator << (ostream& os, const pair<T1,T2>& p){os<<p.first<<\" \"<<p.second;return os;}\ntemplate<typename K,typename V> ostream& operator << (ostream& os, const map<K,V>& m){bool isF=true;for(auto& p:m){if(!isF)os<<endl;os<<p;isF=false;}return os;}\ntemplate<typename T1> ostream& operator << (ostream& os, const tuple<T1>& t){os << get<0>(t);return os;}\ntemplate<typename T1,typename T2> ostream& operator << (ostream& os, const tuple<T1,T2>& t){os << get<0>(t)<<\" \"<<get<1>(t);return os;}\ntemplate<typename T1,typename T2,typename T3> ostream& operator << (ostream& os, const tuple<T1,T2,T3>& t){os << get<0>(t)<<\" \"<<get<1>(t)<<\" \"<<get<2>(t);return os;}\ntemplate<typename T1,typename T2,typename T3,typename T4> ostream& operator << (ostream& os, const tuple<T1,T2,T3,T4>& t){os << get<0>(t)<<\" \"<<get<1>(t)<<\" \"<<get<2>(t)<<\" \"<<get<3>(t);return os;}\ntemplate<typename T1,typename T2,typename T3,typename T4,typename T5> ostream& operator << (ostream& os, const tuple<T1,T2,T3,T4,T5>& t){os << get<0>(t)<<\" \"<<get<1>(t)<<\" \"<<get<2>(t)<<\" \"<<get<3>(t)<<\" \"<<get<4>(t);return os;}\ntemplate<typename T1,typename T2,typename T3,typename T4,typename T5,typename T6> ostream& operator << (ostream& os, const tuple<T1,T2,T3,T4,T5,T6>& t){os << get<0>(t)<<\" \"<<get<1>(t)<<\" \"<<get<2>(t)<<\" \"<<get<3>(t)<<\" \"<<get<4>(t)<<\" \"<<get<5>(t);return os;}\ntemplate<typename T1,typename T2,typename T3,typename T4,typename T5,typename T6,typename T7> ostream& operator << (ostream& os, const tuple<T1,T2,T3,T4,T5,T6,T7>& t){os << get<0>(t)<<\" \"<<get<1>(t)<<\" \"<<get<2>(t)<<\" \"<<get<3>(t)<<\" \"<<get<4>(t)<<\" \"<<get<5>(t)<<\" \"<<get<6>(t);return os;}\n\n\nchar tmp[100];\n\nint enc(int M,int d,int h,int m){\n\treturn M*30*60*60+d*60*60+h*60+m;\n}\n\nint main() {\n\tcout <<fixed<<setprecision(15);\t\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\twhile(true){\n\t\tint N;scanf(\"%d\",&N);if(N==0)break;\n\t\t\n\n\t\tmap<string,int> ma;\n\t\tbool ex_megami=false;\n\t\tmap<string,int> vals;\n\t\tREP(i,N){\n\t\t\tint M,d,h,m;string type;string user;\n\t\t\tscanf(\"%d/%d\",&M,&d);scanf(\"%d:%d\",&h,&m);\n\t\t\tscanf(\"%s\",tmp);type=tmp;scanf(\"%s\",tmp);user=tmp;\n\t\t\tint T=enc(M,d,h,m);\n\t\t\tif(type==\"I\"){\n\t\t\t\tif(user==\"000\"){\n\t\t\t\t\tex_megami=true;\n\t\t\t\t}\n\t\t\t\tma[user] = T;\n\t\t\t}else{\n\t\t\t\tif(user==\"000\"){\n\t\t\t\t\tex_megami=false;\n\t\t\t\t\tEACH(it,ma)if(it->first!=\"000\"){\n\t\t\t\t\t\tvals[it->first] += T-max(ma[it->first],ma[\"000\"]);\n\t\t\t\t\t\tma[it->first] = T;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tif(ex_megami) vals[user] += T-max(ma[user],ma[\"000\"]);\n\t\t\t\t}\n\t\t\t\tma.erase(user);\n\t\t\t}\n\t\t}\n\t\tint res=0;EACH(it,vals)if(it->first!=\"000\")res=max(res,it->second);\n\t\tcout << res <<endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#include <cstdio>\n\nusing namespace std;\n\nconst int MAX_N = 1000 + 10;\nstruct S\n{\n    int id, time;\n    char str[3];\n};\nint n;\nS s[MAX_N];\nint in_time;\n\nint main()\n{\n    while(scanf(\"%d\", &n), n)\n    {\n\n        int y, m, h, mm, id, max_id = 0;\n        char str[3];\n        for(int i = 0; i < n; i++)\n        {\n            scanf(\"%d/%d %d:%d %s %d\", &y, &m, &h, &mm, str, &id);\n            s[i].id = id, s[i].time = h * 60 + mm, strcpy(s[i].str, str);\n            max_id = max(max_id, id);\n        }\n        bool is_at1, is_at2;\n        is_at1 = is_at2 = false;\n        int in_time, out_time, during_time, _beg_time, temp_time, max_time;\n        max_time = temp_time = 0;\n        in_time = out_time = during_time = _beg_time =  -1;\n        for(int j = 1; j <= max_id; j++)\n        {\n            for(int i = 0; i < n; i++)\n            {\n                if(s[i].id == 0)\n                {\n                    if(s[i].str[0] == 'I')\n                    {\n                        is_at1 = true;\n                        if(is_at2 == true)\n                        {\n                            _beg_time = s[i].time;\n                            //in_time = s[i].time;\n                        }\n                        /*else\n                            in_time = s[i].time;*/\n                    }\n                    else\n                    {\n                        is_at1 = false;\n                        if(is_at2 == true)\n                        {\n                            if(_beg_time != -1)\n                            {\n                                temp_time += s[i].time - _beg_time;\n                                _beg_time = -1;\n                            }\n                        }\n                    }\n                }\n                else\n                {\n                    if(s[i].id == j)\n                    {\n                        if(s[i].str[0] == 'I')\n                        {\n                             is_at2 = true;\n                            if(is_at1 == true)\n                            {\n                                _beg_time = s[i].time;\n                            }\n                        }\n                        else\n                        {\n                            is_at2 = false;\n                            if(_beg_time != -1)\n                            {\n                                temp_time += s[i].time - _beg_time;\n                                 _beg_time = -1;\n                            }\n                        }\n                    }\n                }\n           }\n           max_time = max(max_time, temp_time);\n           _beg_time = -1;\n           temp_time = 0;\n        }\n    printf(\"%d\\n\", max_time);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n\tlong long int N;\n\twhile(cin >> N , N)\n\t{\n\t\tmap<string , pair<long long int , long long int>>data;\n\t\tset<string>IO;\n\t\tbool f = false;\n\t\tstring today;\n\t\tfor(size_t i = 0; i < N; i++)\n\t\t{\n\t\t\tstring MD , who;\n\t\t\tcin >> MD;\n\t\t\tint h , m;\n\t\t\tchar c;\n\t\t\tcin >> h >> c >> m;\n\t\t\tcin >> c;\n\t\t\tcin >> who;\n\t\t\tif(c == 'I')\n\t\t\t{\n\t\t\t\tif(who == \"000\")\n\t\t\t\t{\n\t\t\t\t\tf = true;\n\t\t\t\t\tfor(auto x : IO)\n\t\t\t\t\t{\n\t\t\t\t\t\tdata[x].first = h * 60 + m;\n\t\t\t\t\t}\n\t\t\t\t} else\n\t\t\t\t{\n\t\t\t\t\tIO.insert(who);\n\t\t\t\t\tif(f)\n\t\t\t\t\t{\n\t\t\t\t\t\tdata[who].first = h * 60 + m;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else\n\t\t\t{\n\t\t\t\tif(who == \"000\")\n\t\t\t\t{\n\t\t\t\t\tf = false;\n\t\t\t\t\tfor(auto x : IO)\n\t\t\t\t\t{\n\t\t\t\t\t\tdata[x].second += h * 60 + m - data[x].first;\n\t\t\t\t\t}\n\t\t\t\t} else\n\t\t\t\t{\n\t\t\t\t\tIO.erase(who);\n\t\t\t\t\tif(f)\n\t\t\t\t\t{\n\t\t\t\t\t\tdata[who].second += h * 60 + m - data[who].first;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tlong long int ans = 0;\n\t\tfor(auto x : data)\n\t\t{\n\t\t\tif(x.second.second > ans)\n\t\t\t{\n\t\t\t\tans = x.second.second;\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <cstdio>\n\nusing namespace std;\n\nclass prog{\npublic:\n  int i, o;\n  string str;\n};\n\nvector<prog> p[1000];\nint size[1000];\n\n\nmain(){\n  int n;\n  while(cin >> n && n){\n    for(int i=0;i<1000;i++){\n      p[i].clear();\n    }\n    fill(size, size+1000, 0);\n    for(int i=0;i<n;i++){\n      prog in;\n      string input;\n      cin >> in.str;\n      cin >> input;\n      char c;\n      cin >> c;\n      int a, b;\n      string tmp = \"\";\n      tmp += input[0];\n      tmp += input[1];\n      a = atoi(tmp.c_str());\n      tmp = \"\";\n      tmp += input[3];\n      tmp += input[4];\n      b = atoi(tmp.c_str());\n      if(c == 'I'){\n\tin.i = a*60 + b;\n\tin.o = -1;\n      }else{\n\tin.o = a*60 + b;\n      }\n      cin >> input;\n      int id = atoi(input.c_str());\n      if(c == 'I'){\n\tp[id].push_back(in);\n      }else{\n\tp[id][(int)p[id].size()-1].o = in.o;\n      }\n    }\n    int ans = 0;\n    for(int i=0;i<1000;i++){\n      if(p[i].size() == 0) continue;\n      for(int k=0;k<1000;k++){\n\tif(p[k].size() == 0) continue;\n\tif(i == k) continue;\n\tint sum = 0;\n\tfor(int l=0;l<p[k].size();l++){\n\t  if(p[k][l].o == -1) continue;\n\t  for(int j=0;j<p[i].size();j++){\n\t    if(p[i][j].o == -1) continue;\n\t    if(p[i][j].str != p[k][l].str) continue;\n\t    int ai = p[i][j].i;\n\t    int ao = p[i][j].o;\n\t    int bi = p[k][l].i;\n\t    int bo = p[k][l].o;\n\t    if(ao < bi) continue;\n\t    else if(bo < ai) continue;\n\t    if(ai == bi && bo == ao) sum += bo - bi;\n\t    else if(ai == bi) sum += min(ao, bo) - ai;\n\t    else if(ao == bo) sum += max(ai, bi) - ao;\n\t    else if(ai == bo) sum += 0;\n\t    else if(ao == bi) sum += 0;\n\t    else if(ai < bi && bo < ao) sum += bo - bi;\n\t    else if(bi < ai && ao < bo) sum += ao - ai;\n\t    else sum += min(abs(ai - bo), abs(ao - bi));\n\t  }\n\t}\n\tans = max(ans, sum);\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#pragma warning(disable:4996)\n\n#define MAX_N 10000\n#define MAX_M 501\n\nint Q;\nint M[MAX_N], D[MAX_N], h[MAX_N], m[MAX_N], t[MAX_N], n[MAX_N];\nint K[MAX_N], L[MAX_N];\nchar c;\n\nint main() {\n\twhile (true) {\n\t\tfor (int i = 0; i < MAX_N; i++) { \n\t\t\tM[i] = 0; D[i] = 0; h[i] = 0; m[i] = 0; t[i] = 0; n[i] = 0; K[i] = 0; L[i] = 0;\n\t\t}\n\n\t\tbool megami = false; int zenkai = 0; cin >> Q; if (Q == 0) { break; }\n\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tscanf(\"%02d/%02d %02d:%02d %c %03d\", &M[i], &D[i], &h[i], &m[i], &c, &n[i]);\n\t\t\tif (c == 'I') { L[n[i]] = 1; }\n\t\t\tif (c == 'O') { L[n[i]] = 0; }\n\t\t\tif (megami == true) { \n\t\t\t\tfor (int j = 0; j < MAX_M; j++) { \n\t\t\t\t\tif (L[j] == 1) { \n\t\t\t\t\t\tK[j] += (h[i] * 60 + m[i]) - (h[i - 1] * 60 + m[i - 1]);\n\t\t\t\t\t} \n\t\t\t\t} \n\t\t\t}\n\t\t}\n\t\tint maxn = 0; \n\t\tfor (int i = 1; i < MAX_M; i++) { \n\t\t\tmaxn = max(maxn, K[i]); \n\t\t}\n\t\tcout << maxn << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <set>\nusing namespace std;\n\nconst int N = 1010;\n\nint n;\nint stay[N];\nset<int> st;\n\nvoid work() {\n    memset(stay, 0, sizeof(stay));\n    char day[100] = \"\";\n    int now = 0;\n    int T = 60 * 24;\n    for (int i = 0; i < n; i++) {\n        char td[100];\n        scanf(\"%s\", td);\n        int hour, minu;\n        scanf(\"%d:%d\", &hour, &minu);\n        int next = hour * 60 + minu;\n        int ed = next;\n        if (strcmp(td, day) != 0) ed = T;\n        if (st.count(0)) {\n            for (set<int>::iterator it = st.begin(); it != st.end(); it++)\n                stay[*it] += ed - now;\n        }\n        if (strcmp(td, day) != 0) {\n            st.clear();\n            strcpy(day, td);\n        }\n        now = next;\n        char op[2];\n        int p;\n        scanf(\"%s%d\", op, &p);\n        if (*op == 'I') st.insert(p);\n        else st.erase(p);\n    }\n    int ans = 0;\n    for (int i = 1; i < 1000; i++)\n        ans = max(ans, stay[i]);\n    printf(\"%d\\n\", ans);\n}\nint main() {\n//freopen(\"data.in\", \"r\", stdin);\n    while (scanf(\"%d\", &n), n) {\n        work();\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <vector>\n#include <string>\n#include <algorithm>\n#include <utility>\n#include <set>\n#include <map>\n#include <deque>\n#include <queue>\n#include <cmath>\n#include <cstdlib>\n#include <ctime>\n#include <cstdio>\n#include <stdio.h>\n\nusing namespace std;\n\n#define fo(i,n) for(int i=0; i<(int)n; i++)\n#define rep(it,s) for(__typeof((s).begin()) it=(s).begin();it!=(s).end();it++)\n#define mp(a,b) make_pair(a,b)\n#define pb(x) push_back(x)\n#define pii pair<int,int>\n\nint n;\nvector<pair<int,int> > v;\nint sx, sy;\nmap<string,int> id;\nint c;\nbool vis[1010];\n\nint parse(string s) {\n\tint h = (s[0]-'0')*10 + (s[1]-'0');\n\th *= 60;\n\th += (s[3]-'0')*10 + (s[4]-'0');\n\treturn h;\n}\n\nint solve() {\n\tint t = 0;\n\tfor (int i=0; i<v.size(); i++) vis[i] = 0;\n\n\tsx = 0; sy = 0;\n\tfor (int i=0; i<v.size(); i++) if (!vis[i]) {\n\t\tif (v[i].second==-1) {\n\t\t\tsx = v[i].first;\n\t\t\tsy = 24*3600;\n\t\t}\n\t\tif (v[i].second==-2) sy = v[i].first;\n\t\tif (v[i].second<0) continue;\n\t\tint tmp = 0;\n\t\tint sxx = sx;\n\t\tint syy = sy;\n\t\tfor (int j=i+1; j<v.size(); j++) if (!vis[j]) {\n\t\t\tif (v[j].second==-1) {\n\t\t\t\ttmp += max(syy - max(v[i].first,sxx),0);\n\t\t\t\tsxx = v[j].first;\n\t\t\t\tsyy = 24*3600;\n\t\t\t}\n\t\t\tif (v[j].second==-2) syy = v[j].first;\n\t\t\tif (v[i].second==v[j].second) {\n\t\t\t\tvis[i] = 1;\n\t\t\t\tvis[j] = 1;\n\t\t\t\ttmp += max(min(v[j].first,syy) - max(v[i].first,sxx),0);\n\t\t\t\tt = max(tmp,t);\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn t;\n}\n\t\t\n\nint main() {\n\n    //freopen(\"input.txt\",\"r\",stdin); \n    //freopen(\"output.txt\",\"w\",stdout); \n\n\twhile (scanf(\"%d\",&n) && n!=0) {\n\t\tint best = 0;\n\t\tstring last = \"\";\n\t\tc = 1;\n\t\tid.clear();\n\t\tv.clear();\n\t\tsx = 0;\n\t\tsy = 0;\n\t\tfor (int i=0; i<n; i++) {\n\t\t\tstring str;\n\t\t\tcin>>str;\n\t\t\tstring hour;\n\t\t\tcin>>hour;\n\t\t\tint t = parse(hour);\n\t\t\tstring s;\n\t\t\tcin>>s;\n\t\t\tstring sid;\n\t\t\tcin>>sid;\n\t\t\tif (str!=last) {\n\t\t\t\tbest = max(best,solve());\n\t\t\t\tid.clear();\n\t\t\t\tv.clear();\n\t\t\t\tc = 1;\n\t\t\t\tsx = 0;\n\t\t\t\tsy = 0;\n\t\t\t}\n\t\t\tif (sid==\"000\") {\n\t\t\t\tif (s==\"I\") v.push_back(make_pair(t,-1));\n\t\t\t\tif (s==\"O\") v.push_back(make_pair(t,-2));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (s==\"I\") id[sid] = c++;\n\t\t\t\tv.push_back(make_pair(t,id[sid]));\n\t\t\t}\n\t\t\tlast = str;\n\t\t}\n\t\tbest = max(best,solve());\n\t\t\n\t\tcout<<best<<endl;\n\t}\n\t\n    return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define ALL(v) (v).begin(), (v).end()\n#define LENGTHOF(x) (sizeof(x) / sizeof(*(x)))\n#define AFILL(a, b) fill((int*)a, (int*)(a + LENGTHOF(a)), b)\n#define SQ(x) ((x)*(x))\n#define Mod(x, mod) (((x)+(mod)%(mod))\n#define MP make_pair\n#define PB push_back\n#define Fi first\n#define Se second\n#define INF (1<<29)\n#define EPS 1e-10\n#define MOD 1000000007\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nint N;\nint t[1024];\nint res[1024];\nint M,D,h,m,p;char e[2];\n\nint main(){\n  while(scanf(\"%d\", &N) && N){\n    fill(t,t+1024, INF);\n    memset(res, 0,sizeof(res));\n    int  godless = INF;\n    rep(i,N){\n      scanf(\"%d/%d %d:%d %s %d\", &M,&D,&h,&m,e,&p);\n      if(p==0){\n\tif(e[0]=='I') godless = h*60+m;\n\telse{\n\t  rep(i, 1024) res[i] += max(0, min(h*60+m-t[i], h*60+m-godless));\n\t  godless = INF;\n\t}\n      }else{\n\tif(e[0]=='I') t[p] = h*60+m;\n\telse{\n\t  res[p] +=  max(0, min(h*60+m-t[p], h*60+m-godless));\n\t  t[p] = INF;\n\t}\n      }\n    }\n    int ans=0;\n    rep(i,1024)  ans = max(ans, res[i]);\n    printf(\"%d\\n\",ans);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"iostream\"\n#include \"climits\"\n#include \"list\"\n#include \"queue\"\n#include \"stack\"\n#include \"set\"\n#include \"functional\"\n#include \"algorithm\"\n#include \"string\"\n#include \"map\"\n#include \"unordered_map\"\n#include \"unordered_set\"\n#include \"iomanip\"\n#include \"cmath\"\n#include \"random\"\n#include \"bitset\"\n#include \"cstdio\"\n#include \"numeric\"\n#include \"cassert\"\n#include \"ctime\"\n\nusing namespace std;\n\nconstexpr long long int MOD = 1000000007;\n//constexpr int MOD = 1000000007;\n//constexpr int MOD = 998244353;\n//constexpr long long int MOD = 998244353;\nconstexpr double EPS = 1e-12;\n\n//int N, M, K, T, H, W, L, R;\nlong long int N, M, K, T, H, W, L, R;\n\nint second(string s) {\n\tfor (auto &i : s)i -= '0';\n\tint ret = s[0];\n\tret *= 10;\n\tret += s[1];\n\tret *= 6;\n\tret += s[3];\n\tret *= 10;\n\tret += s[4];\n\treturn ret;\n}\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\n\twhile (cin >> N, N) {\n\t\tmap<string, vector<int>>mp;\n\t\tvector<string>a(N);\n\t\tvector<string>b(N);\n\t\tvector<char>c(N);\n\t\tvector<string>d(N);\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tcin >> a[i] >> b[i] >> c[i] >> d[i];\n\t\t\tmp[a[i]].push_back(i);\n\t\t}\n\t\tmap<string, int>score;\n\t\tfor (auto i : mp) {\n\t\t\tvector<int>v(1441);\n\t\t\tfor (auto j : i.second) {\n\t\t\t\tif (d[j] == \"000\") {\n\t\t\t\t\tif (c[j] == 'I') {\n\t\t\t\t\t\tv[second(b[j])]++;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tv[second(b[j])]--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int j = 1; j <= 1440; j++) {\n\t\t\t\tv[j] += v[j - 1];\n\t\t\t}\n\t\t\tfor (auto j : i.second) {\n\t\t\t\tif (d[j] != \"000\") {\n\t\t\t\t\tif (c[j] == 'I') {\n\t\t\t\t\t\tfor (int k = second(b[j]); k <= 1440; k++) {\n\t\t\t\t\t\t\tscore[d[j]] += v[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tfor (int k = second(b[j]); k <= 1440; k++) {\n\t\t\t\t\t\t\tscore[d[j]] -= v[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans = 0;\n\t\tfor (auto i : score) {\n\t\t\tans = max(ans, i.second);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "/*\n * GCA : \"Computer is artificial subject absolutely,Math is God\"\n */\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <vector>\n#include <set>\n#include <map>\n#include <queue>\n#include <cctype>\n#include <utility>\n\nusing namespace std;\n#ifdef DEBUG\n#define VAR(a,b) __typeof(b) a=(b)\n#define debug(...) printf(\"DEBUG: \"),printf(__VA_ARGS__)\n#else\n#define VAR(a,b) __typeof(b) a=(b)\n#define debug(...)\n#endif\ntypedef unsigned int uint;\ntypedef long long int Int;\ntypedef unsigned long long int UInt;\n#define Set(a,s) memset(a,s,sizeof(a))\n#define Pln() printf(\"\\n\")\n#define For(i,x)for(int i=0;i<x;i++)\n#define CON(x,y) x##y\n#define M 1005\n#define PB push_back\n#define oo INT_MAX\n#define FOR(a,b) for(VAR(a,(b).begin());a!=(b).end();++a)\n#define eps 1e-9\n#define X first\n#define Y second\ninline bool xdy(double x,double y){return x>y+eps;}\ninline bool xddy(double x,double y){return x>y-eps;}\ninline bool xcy(double x,double y){return x<y-eps;}\ninline bool xcdy(double x,double y){return x<y+eps;}\nconst Int mod=1000000007;\nint n;\nint god[M];\nint godlog;\nint time[M];\nint intime[M];\nint sid[M];\nchar ppl[M];\nint main() {\n\tios_base::sync_with_stdio(0);\n\twhile(~scanf(\"%d\",&n)&&n){\n\t\tSet(intime,-1);\n\t\tSet(god,0);\n\t\tint godtime=-1;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tint mon,d,h,m,id;\n\t\t\tchar p;\n\t\t\tscanf(\"%d/%d %d:%d \",&mon,&d,&h,&m);\n\t\t\ttime[i]=mon*100*24*60+d*24*60+h*60+m;\n\t\t\tscanf(\"%c %d\",&ppl[i],&sid[i]);\n\t\t\tp=ppl[i];id=sid[i];\n\t\t\tif(!id){\n\t\t\t\tif(p=='I'){\n\t\t\t\t\tgodtime=time[i];\n\t\t\t\t\tgodlog=i;\n\t\t\t\t}\n\t\t\t\telse if(p=='O'){\n\t\t\t\t\tbool outside[M]={};\n\t\t\t\t\tfor(int j=i-1;j>=0;j--){\n\t\t\t\t\t\tif(ppl[j]=='O')outside[sid[j]]=1;\n\t\t\t\t\t\tif(ppl[j]=='I'&&intime[sid[j]]!=-1&&!outside[sid[j]]){\n\t\t\t\t\t\t\tgod[sid[j]]+=time[i]-max(godtime,intime[sid[j]]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tgodtime=-1;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(p=='I')intime[id]=time[i];\n\t\t\t\telse if(p=='O'){\n\t\t\t\t\tif(godtime!=-1){\n\t\t\t\t\t\tgod[id]+=time[i]-intime[id];\n\t\t\t\t\t\tintime[id]=-1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t}\n\t\tint ans=0;\n\t\tfor(int i=1;i<1000;i++){\n\t\t\tans=max(ans,god[i]);\n\t\t}\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,x,y) for(int i=(x);i<(y);++i)\n#define debug(x) #x << \"=\" << (x)\n\n#ifdef DEBUG\n#define _GLIBCXX_DEBUG\n#define print(x) std::cerr << debug(x) << \" (L:\" << __LINE__ << \")\" << std::endl\n#else\n#define print(x)\n#endif\n\nconst int inf=1e9;\nconst int64_t inf64=1e18;\nconst double eps=1e-9;\n\ntemplate <typename T> ostream &operator<<(ostream &os, const vector<T> &vec){\n    os << \"[\";\n    for (const auto &v : vec) {\n    \tos << v << \",\";\n    }\n    os << \"]\";\n    return os;\n}\n\nstruct S{\n    string date;\n    int begin,end;\n    \n    S(){}\n    \n    S(string s,int b,int e)\n    {\n        date=s;\n        begin=b;\n        end=e;\n    }\n};\n\nvoid solve(int n){\n    vector<S> data[600];\n    vector<int> ans(600,0);\n    \n    rep(i,0,n){\n        string d;\n        cin>>d;\n        \n        string temp;\n        cin>>temp;\n        \n        int time=(temp[0]-'0')*600+(temp[1]-'0')*60+(temp[3]-'0')*10+(temp[4]-'0');\n        \n        string io;\n        cin>>io;\n        \n        string sid;\n        cin>>sid;\n        \n        int id=(sid[0]-'0')*100+(sid[1]-'0')*10+(sid[2]-'0');\n        \n        if(io==\"I\"){\n            data[id].push_back(S(d,time,0));\n        }else{\n            data[id][data[id].size()-1].end=time;\n        }\n    }\n    \n    rep(i,1,500){\n        rep(j,0,data[0].size()){\n            rep(k,0,data[i].size()){\n                if(data[0][j].date!=data[i][k].date){\n                    continue;\n                }\n                \n                int t_begin=max(data[0][j].begin,data[i][k].begin);\n                int t_end=min(data[0][j].end,data[i][k].end);\n                int t_ans=max(0,t_end-t_begin);\n                \n                ans[i]+=t_ans;\n            }\n        }\n    }\n    \n    int answer=0;\n    \n    rep(i,0,500){\n        answer=max(answer,ans[i]);\n    }\n    \n    cout<<answer<<endl;\n}\n\nint main(){\n    std::cin.tie(0);\n    std::ios::sync_with_stdio(false);\n    cout.setf(ios::fixed);\n    cout.precision(10);\n    \n    while(true){\n        int n;\n        cin>>n;\n        \n        if(n==0) break;\n        \n        solve(n);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <climits>\n#include <cassert>\n\nusing namespace std;\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\ntypedef long long ll;\n\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n) FOR(i,0,n)\n\nstruct pg {\n\ttime_t in_time;\n\tbool is_in;\n\tint bless;\n\tpg(): in_time(0), is_in(false), bless(0) {};\n};\n\ntime_t to_time(int h, int m)\n{\n\treturn h * 60 + m;\n}\n\nint main()\n{\n\tint N;\n\twhile(cin >> N, N) {\n\t\tpg goddess;\n\t\tvector<pg> pgs(1000);\n\t\tvi visiting_pgs;\n\n\t\tREP(_, N) {\n\t\t\tint M, D, h, m, id;\n\t\t\tchar e;\n\t\t\tscanf(\"%d/%d %d:%d %c %d\", &M, &D, &h, &m, &e, &id);\n\t\t\ttime_t now = to_time(h, m);\n\t\t\tswitch(id) {\n\t\t\t\tcase 0: // Goddess\n\t\t\t\t\tif (e == 'I') {\n\t\t\t\t\t\tgoddess.is_in = true;\n\t\t\t\t\t\tgoddess.in_time = now;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgoddess.is_in = false;\n\t\t\t\t\t\tfor(vi::iterator it = visiting_pgs.begin(); it != visiting_pgs.end(); it++) {\n\t\t\t\t\t\t\tpgs[*it].bless += now - max(goddess.in_time, pgs[*it].in_time);\n\t\t\t\t\t\t\tpgs[*it].in_time = now;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif (e == 'I') {\n\t\t\t\t\t\tpgs[id].is_in = true;\n\t\t\t\t\t\tpgs[id].in_time = now;\n\t\t\t\t\t\tvisiting_pgs.push_back(id);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (goddess.is_in) {\n\t\t\t\t\t\t\tpgs[id].bless += now - max(goddess.in_time, pgs[id].in_time);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvisiting_pgs.erase(find(ALL(visiting_pgs),id));\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tint ans = 0;\n\t\tREP(i, pgs.size()) {\n\t\t\tans = max(ans, pgs[i].bless);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<map>\nusing namespace std;\nint main(){\n  int n;\n  int i,j,k;\n  while(cin>>n,n){\n    map<string,int> m;\n    map<string,int> l;\n    int t,g;\n    map<string,bool> h;\n    string date,time,io,name,ye;\n    for(i=0;i<n;i++){\n      cin >> date >> time >> io >> name;\n      t=(time[0]-'0')*600+(time[1]-'0')*60+(time[3]-'0')*10+(time[4]-'0');\n      if(io==\"I\"){\n\th[name]=true;\n\tl[name]=t;\n\tif(name==\"000\"){\n\t  //cout << \"I\" << t << endl;\n\t  for(map<string,bool>::iterator itr=h.begin();itr!=h.end();++itr) {\n\t    if(itr->second){\n\t      //cout << \"key = \" << itr->first << endl;\n\t      l[itr->first]=t;\n\t    }\n\t  }\n\t}\n      }else{\n\th[name]=false;\n\tif(name==\"000\"){\n\t  //cout << \"O\" << t << endl;\n\t  for(map<string,bool>::iterator itr=h.begin();itr!=h.end();++itr) {\n\t    if(itr->second){\n\t      //cout << \"key = \" << itr->first << endl;\n\t      m[itr->first]+=t-l[itr->first];\n\t    }\n\t  }\n\t}else{\n\t  if(h[\"000\"]) m[name]+=t-l[name];\n\t}\n      }\n    }\n    int o=0;\n    for(map<string,bool>::iterator itr=h.begin();itr!=h.end();++itr) {\n      //cout << \"key = \" << itr->first <<\"time=\" << m[itr->first] << endl;\n      o=max(o, m[itr->first]);\n    }\n    cout << o << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include\"bits/stdc++.h\"\n\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\nusing pii = pair<int, int>;\nusing pll = pair<ll, ll>;\n\n#define FOR(k,m,n) for(ll (k)=(m);(k)<(n);(k)++)\n#define REP(i,n) FOR((i),0,(n))\n#define WAITING(str) int str;std::cin>>str;\n#define DEBUGING(str) cout<< #str << \" \" str<<endl\n\nconstexpr int INF = (1 << 30);\nconstexpr ll INFL = (1ll << 60);\nconstexpr ll MOD = 1000000007;// 10^9+7\n\nstruct Time {\n\tTime() :h(0), m(0), idx(\"\") {}\n\tTime(string time, string _idx) :idx(_idx) {\n\t\th = (time[0] - '0') * 10 + (time[1] - '0');\n\t\tm = (time[3] - '0') * 10 + (time[4] - '0');\n\t}\n\tint h, m;\n\tstring idx;\n\tint diff(const Time& opp)const {\n\t\treturn trans() - opp.trans();\n\t}\n\tint trans() const {\n\t\treturn h * 60 + m;\n\t}\n};\n\nint main()\n{\n\twhile (true) {\n\t\tint n;\n\t\tcin >> n;\n\t\tif (!n)break;\n\n\t\tTime goddess;\n\t\tmap<string, Time> mp;\n\t\tmap<string, int> res;\n\t\tREP(i, n) {\n\t\t\tstring date, time, kind, id;\n\t\t\tcin >> date >> time >> kind >> id;\n\t\t\tTime tgt(time, id);\n\n\t\t\tif (kind == \"I\") {\n\t\t\t\t(tgt.idx == \"000\" ? goddess : mp[tgt.idx]) = tgt;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (tgt.idx == \"000\") {\n\t\t\t\t\tfor (auto itr = mp.begin(); itr != mp.end(); ++itr) {\n\t\t\t\t\t\tstring name = itr->first;\n\t\t\t\t\t\tTime opp = itr->second;\n\t\t\t\t\t\tres[name] += opp.diff(goddess) > 0\n\t\t\t\t\t\t\t? tgt.diff(opp)\n\t\t\t\t\t\t\t: tgt.diff(goddess);\n\t\t\t\t\t}\n\t\t\t\t\tgoddess = Time();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (goddess.h != 0 && goddess.m != 0) {\n\t\t\t\t\t\tTime in = mp[tgt.idx];\n\t\t\t\t\t\tres[tgt.idx] += in.diff(goddess) > 0\n\t\t\t\t\t\t\t? tgt.diff(in)\n\t\t\t\t\t\t\t: tgt.diff(goddess);\n\t\t\t\t\t}\n\t\t\t\t\tmp.erase(tgt.idx);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tint mm = 0;\n\t\tfor (auto itr = res.begin(); itr != res.end(); ++itr)\n\t\t\tmm = max(mm, itr->second);\n\t\tcout << mm << endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <map>\n#include <queue>\n#include <cstdio>\n#include <ctime>\n#include <assert.h>\n#include <chrono>\n#include <random>\n#include <numeric>\n#include <set>\n#include <deque>\n#include <stack>\n#include <bitset>\nusing namespace std;\ntypedef long long int ll;\ntypedef unsigned long long ull;\n\nmt19937_64 rng(chrono::steady_clock::now().time_since_epoch().count());\nll myRand(ll B) {\n    return (ull)rng() % B;\n}\n\nint d[100][101];\nbool b[100];\nvector<pair<int,int>> g[100];\n\nint main(){\n\tcin.tie(nullptr);\n\tios::sync_with_stdio(false);\n\tint n;\n\twhile(1){\n\t\tscanf(\"%d\",&n);\n\t\tif(n==0)break;\n\t\tint res=0;\n\t\tint mo,day,h,m; char c; int id; int tm=0; bool flag=0;\n\t\tvector<int> t(1000,0);\n\t\tvector<int> sum(1000,0);\n\t\twhile(n--){\n\t\t\tscanf(\"%d/%d %d:%d %c %d\",&mo,&day,&h,&m,&c,&id);\n\t\t\ttm=h*60+m;\n\t\t\tif(c=='I'){\n\t\t\t\tif(id){\n\t\t\t\t\tt[id]=tm;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tfor(int i=1;i<1000;i++){\n\t\t\t\t\t\tif(t[i])t[i]=tm;\n\t\t\t\t\t}\n\t\t\t\t\tflag=1;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(id){\n\t\t\t\t\tif(flag){\n\t\t\t\t\t\tsum[id]+=tm-t[id];\n\t\t\t\t\t\tres=max(res,sum[id]);\n\t\t\t\t\t}\n\t\t\t\t\tt[id]=0;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tfor(int i=1;i<1000;i++){\n\t\t\t\t\t\tif(t[i]){\n\t\t\t\t\t\t\tsum[i]+=tm-t[i];\n\t\t\t\t\t\t\tres=max(res,sum[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tflag=0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",res);\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "\n#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <iostream>\n#include <queue>\n#include <map>\n#include <set>\n#include <vector>\n#include <math.h>\n#include <string>\nusing namespace std;\nint n;\nstruct mmtime\n{\n   int day,mon;\n   int h,m;\n   mmtime(){};\n   void mset(int _day,int _mon,int _h,int _m)\n   {\n\t   day=_day;\n\t   mon=_mon;\n\t   h=_h;m=_m;\n   }\n   void read()\n   {\n\t   scanf(\"%d/%d %d:%d\",&mon,&day,&h,&m);\n   }   \n   int  operator-(const mmtime & t)\n   {\n\t   int nh=h-t.h;\n\t   int nm=m-t.m;\n\t   if (nm<0) {--nh;nm+=60;}\n\t   return nh*60+nm;\n   }\n};\nstruct md\n{\n   mmtime mytime;\n   char type;\n   int id;\n   void read()\n   {\n\t   char d[10];\n\t   mytime.read();\n\t   scanf(\"%s\",d);\n\t   type=d[0];\n\t   scanf(\"%d\",&id);\n   }   \n   bool operator<(const md& t) const\n   {\n\t   return id<t.id;\n   }\n   int getv()\n   {\n\t   return mytime.h*60+mytime.m;\n   }\n};\nmd data[1003];\nint sum[1003];\nint main()\n{\n\t//freopen(\"in.txt\",\"r\",stdin);\n\t//froepen(\"out.txt\",\"w\",stdout);\n    while (~scanf(\"%d\",&n) && n)\n\t{\t\n\t\tmemset(sum,0,sizeof sum);\n\t    for (int i=0;i<n;++i)\n\t\t  data[i].read();\n\t\t\n\t    stable_sort(data,data+n);\n         \n//\tfor (int i=0;i<n;++i)\n  //   \t{\n\t//\t\tprintf(\"%d\\n\",data[i].id);\n\t//\t}\n\t//\tprintf(\"--------------\\n\");\n\t\tint gn=0;\n\t\twhile (data[gn].id==0) ++gn;\n//\tprintf(\"-=-=-=-  %d\\n\",gn);\n\t\tint sn=0;\n        for (int i=gn+1;i<n;i=i+2)\n\t\t{\n\t\t\tint a=data[i-1].getv();\n\t\t\tint b=data[i].getv();\n\t\t\tfor (int k=1;k<gn;k=k+2)\n\t\t\t{\n\t\t\t\tint aa=data[k-1].getv();\n\t\t\t\tint bb=data[k].getv();\n\t\t\t\tif (data[i].mytime.day!=data[k].mytime.day || data[i].mytime.mon !=data[k].mytime.mon)\n\t\t\t\t\tcontinue;\n                if (b<=aa|| bb<=a) continue;\n\t\t\t\tint jj[4];\n\t\t\t\tjj[0]=a;jj[1]=b;jj[2]=aa;jj[3]=bb;\n\t\t\t\tsort(jj,jj+4);\n\t\t\t\t//printf(\"%d %d %d %d \\n\",a,b,aa,bb);\n\t\t\t\t//printf(\"====%d \\n\",jj[2]-jj[1]);\n\t\t\t\tsum[sn]+=jj[2]-jj[1];\n\t\t\t}\n\t\t\t if (i+1>=n || data[i].id!=data[i+1].id) \n\t\t\t  ++sn;\t\n\t\t\n\t\t}\n\t    int ans=0;\t\n\t\t//for (int i=0;i<7;++i) printf(\"%d\\n\",sum[i]);\n\t\tfor (int i=0;i<105;++i)\n\t\t\tans=max(ans,sum[i]);\n\t\tprintf(\"%d\\n\",ans);\n\t}\n    \n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <algorithm>\n#include <string>\n#include <map>\n\n#define all(x) (x).begin(), (x).end()\n#define mkp make_pair\n#define fr first\n#define sc second\nusing namespace std;\n\nint N;\n\nvoid solve();\n\nint main() {\n\twhile (cin >> N, N)\n\t\tsolve();\n\t\n\treturn 0;\n}\n\nvoid solve() {\n\tistringstream iss;\n\tstring sdt, stm, stp, sid;\n\tint hr, mn, tm, id;\n\tmap< int, int > tx, sum;\n\t\n\tfor (int i = 0; i < N; ++i) {\n\t\tcin >> sdt >> stm >> stp >> sid;\n\t\t\n\t\tstm[2] = ' ', iss.clear(), iss.str(stm);\n\t\tiss >> hr >> mn, tm = 60 * hr + mn;\n\t\tiss.clear(), iss.str(sid);\n\t\tiss >> id;\n\t\t\n\t\tif (stp == \"I\")\n\t\t\ttx[id] = tm;\n\t\telse {\n\t\t\tif (id == 0) {\n\t\t\t\tfor (auto itr = tx.begin(); itr != tx.end(); ++itr)\n\t\t\t\t\tif (itr->fr != 0 && itr->sc != 0)\n\t\t\t\t\t\tsum[itr->fr] += tm - max(tx[0], itr->sc);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (tx[0] != 0)\n\t\t\t\t\tsum[id] += tm - max(tx[0], tx[id]);\n\t\t\t}\n\t\t\t\n\t\t\ttx[id] = 0;\n\t\t}\n\t}\n\t\n\tint res = 0;\n\tfor (auto itr = sum.begin(); itr != sum.end(); ++itr)\n\t\tres = max(res, itr->sc);\n\tcout << res << \"\\n\";\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define all(c) (c).begin(), (c).end()\n\nconst int N = 1000;\n\nusing Timestamp = tuple<int, int, int, int>;\n\nTimestamp conv(const Timestamp& I, const Timestamp& O) {\n    int M, D, hin, min, hout, mout;\n    tie(M, D, hin, min) = I;\n    tie(M, D, hout, mout) = O;\n    return make_tuple(M, D, hin * 60 + min, hout * 60 + mout);\n}\n\nint solve(const vector<vector<Timestamp>>& ts) {\n    vector<int> total(ts.size());\n    for (int i = 0; i < ts[0].size(); i += 2) {\n        int M, D, gin, gout; tie(M, D, gin, gout) = conv(ts[0][i], ts[0][i + 1]);\n        for (int j = 1; j < int(ts.size()); ++j) {\n            for (int k = 0; k < int(ts[j].size()); k += 2) {\n                int m, d, pin, pout; tie(m, d, pin, pout) = conv(ts[j][k], ts[j][k + 1]);\n                if (M != m or D != d) continue;\n                total[j] += max(0, min(gout, pout) - max(gin, pin));\n            }\n        }\n    }\n    return *max_element(all(total));\n}\n\nint main() {\n    for (int n; cin >> n, n;) {\n        int k = 0;\n        vector<int> id(N, -1); id[0] = k++;\n        vector<vector<Timestamp>> ts(N);\n        while (n--) {\n            int M, D, h, m, p; char e;\n            scanf(\"%d/%d %d:%d %c %d\", &M, &D, &h, &m, &e, &p);\n            if (id[p] == -1) id[p] = k++;\n            ts[id[p]].emplace_back(M, D, h, m);\n        }\n        ts.resize(k);\n        printf(\"%d\\n\", solve(ts));\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<cstdlib>\n#include<map>\n#define F first\n#define S second\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\ntypedef pair<int,int> P;\ntypedef pair<P,P> PP; //PP(P(SM,SD),P(S_time,E_time)\ntypedef pair<P,int> hP;\n\nint main(){\n  int n;\n  string s,ss,sss,ssss;\n  multimap<string,PP> info;\n  map<string,hP> index;\n  map<string,int> Final;\n  while(cin >> n && n){\n    info.clear();\n    rep(i,n){\n      cin >> s >> ss >> sss >> ssss;\n      int Mo,Da,st,ed;\n      st = ed = 0;\n      rep(j,s.length()){ // string to int (Month/Day)\n\tif(s[j] == '0' && st == 0){\n\t  st = j+1;\n\t  continue;\n\t}     \n\tif(s[j] == '/'){\n\t  Mo = (atoi)(s.substr(st,j-st).c_str() );\n\t  st = j+1;\n\t}\n\telse if(j == s.length()-1){\n\t  Da = (atoi)(s.substr(st,j-st+1).c_str() );\n\t}\n      }// string to int (Month/Day)\n \n      st = ed = 0;\n      int time_h,time_m;\n      rep(j,ss.length() ){ // string to int (time:time)\n\tif(st == 0 && ss[0] == '0'){\n\t  st = j+1;\n\t  continue;\n\t}\n\tif(ss[j] == ':'){\n\t  time_h = (atoi)(ss.substr(st,j-st).c_str() );\n\t  st = j+1;\n\t}\n\telse if(j == ss.length()-1 ){\n\t  time_m = (atoi)(ss.substr(st,j-st+1).c_str() );\n\t}\n      }// string to int (time:time)\n      if(sss == \"I\"){\n\tindex[ssss] = hP(P(Mo,Da),time_h*60+time_m);\n\t//cout << index[ssss].F.F << endl;\n      }\n      else if(sss == \"O\"){\n\tinfo.insert(multimap<string,PP>::value_type(ssss,PP(P(index[ssss].F),P(index[ssss].S,time_h*60+time_m ) )) );\n\t//map<string,PP>::iterator it = index[ssss];\n\tindex.erase(ssss);\n      }\n    }\n    multimap<string,PP>::iterator it = info.begin();\n\n    Final.clear();\n\n    while((*it).F == \"000\"){   \n      \n      multimap<string,PP>::iterator it2 = info.begin();\n      while(it2 != info.end() ){\n\tif((*it2).F == \"000\"){\n\t  it2++;\n\t  continue;\n\t}\n\n\tif( (*it).S.F.F == (*it2).S.F.F && (*it).S.F.S == (*it2).S.F.S && ( ( ((*it).S.S.F <= (*it2).S.S.F && (*it2).S.S.F <= (*it).S.S.S  )   ||        ( (*it).S.S.F <= (*it2).S.S.S && (*it2).S.S.S <= (*it).S.S.S  )   )  || ( ((*it2).S.S.F <= (*it).S.S.F  ) && ((*it).S.S.S <= (*it2).S.S.S )  )   )  ){ //女神がいる時間帯に君はいたか？\n\n\t  if( ( ((*it2).S.S.F <= (*it).S.S.F  ) && ((*it).S.S.S <= (*it2).S.S.S )  ) ){//女神がでてくる前から待機しててかつ女神が消えた後もそのにいた場合\n\t    Final[(*it2).F] += (*it).S.S.S - (*it).S.S.F;\n\t  }\n\t  else if( ( ((*it).S.S.F <= (*it2).S.S.F && (*it2).S.S.F <= (*it).S.S.S  )     &&    ( (*it).S.S.F <= (*it2).S.S.S && (*it2).S.S.S <= (*it).S.S.S  )   )  ){//女神が存在する間にきて、その間で帰った場合\n\t    Final[(*it2).F] += (*it2).S.S.S - (*it2).S.S.F;\n\t  } \n\t  else if( ((*it).S.S.F <= (*it2).S.S.F && (*it2).S.S.F <= (*it).S.S.S  )  ){//女神がきたあとに入ってきて、女神が消えたあともそこにいた場合\n\t    Final[(*it2).F] += (*it).S.S.S - (*it2).S.S.F;\n\t  }\n\t  else if( ( (*it).S.S.F <= (*it2).S.S.S && (*it2).S.S.S <= (*it).S.S.S  ) ){//女神がくるまえから待っていて、女神が消える前に帰った場合\n\t    Final[(*it2).F] += (*it2).S.S.S - (*it).S.S.F; \n\t  }\n\t}\n\tit2++;\n      }\n      it++;\n    }\n\n    int ans = 0;\n    map<string,int>::iterator IT = Final.begin();\n    while(IT != Final.end() ){\n      ans = max(ans,(*IT).S);\n      IT++;\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <sstream>\n#include <cstring>\nusing namespace std;\n\nint N;\nbool endow[1000];\nint tm[1000], tt[1000];\n\npair<int, int> separete(string s)\n{\n    stringstream ss(s);\n    int a,b;\n    char c;\n\n    ss >> a >> c >> b;\n\n    return make_pair(a,b);\n}\n\nint transMin(string s)\n{\n    pair<int, int> ms = separete(s);\n    int m = ms.first;\n    int d = ms.second;\n\n    return m*60+d;\n}\n\nint solve()\n{\n    memset(endow, 0, sizeof(endow));\n    memset(tt, 0, sizeof(tt));\n    \n    while(N--){\n\tstring a,b,c;\n\tint mn, id;\n\n\tcin >> a >> b >> c >> id;\n\tmn = transMin(b);\n\n\tif(c == \"I\") {\n\t    endow[id] = true;\n\t    tm[id] = mn;\n\t}\n\n\tif(c == \"O\") {\n\t    endow[id] = false;\n\t    if(id != 000) {\n\t\tif(endow[0]) tt[id] += mn - tm[0];\n\t    }\n\t    else {\n\t\tfor(int i=0; i<1000; i++)\n\t\t    if(endow[i]) tt[i] += mn - tm[0];\n\t    }\n\t}\n    }\n\n    int res = 0;\n    for(int i=1; i<1000; i++)\n\tres = max(res, tt[i]);\n\n    return res;\n}\n\n    \n    \n\nint main()\n{\n    while(cin >> N, N)\n\tcout << solve() << endl;\n    \n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\n#define REP(i,n) for(ll i=0;i<n;++i)\n#define RREP(i,n) for(ll i=n-1;i>=0;--i)\n#define FOR(i,m,n) for(ll i=m;i<n;++i)\n#define RFOR(i,m,n) for(ll i=n-1;i>=m;--i)\n#define ALL(v) (v).begin(),(v).end()\n#define PB(a) push_back(a)\n#define UNIQUE(v) v.erase(unique(ALL(v)),v.end());\n#define DUMP(v) REP(aa, (v).size()) { cout << v[aa]; if (aa != v.size() - 1)cout << \" \"; else cout << endl; }\n#define INF 1000000001ll\n#define MOD 1000000007ll\n#define EPS 1e-9\n\nconst int dx[8] = { 1,1,0,-1,-1,-1,0,1 };\nconst int dy[8] = { 0,1,1,1,0,-1,-1,-1 };\n\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector<vi> vvi;\ntypedef vector<vl> vvl;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nll max(ll a, int b) { return max(a, ll(b)); }\nll max(int a, ll b) { return max(ll(a), b); }\nll min(ll a, int b) { return min(a, ll(b)); }\nll min(int a, ll b) { return min(ll(a), b); }\n///(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)///\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tint n;\n\twhile (cin >> n, n) {\n\t\tint flag = 0;\n\t\tvi v(1000, INF), ans(1000, 0);\n\t\tint t = 0;\n\t\tREP(i, n) {\n\t\t\tint M, D, h, m, p;\n\t\t\tchar c;\n\t\t\tcin >> M >> c >> D >> h >> c >> m >> c >> p;\n\t\t\tif (c == 'I') {\n\t\t\t\tv[p] = h * 60 + m;\n\t\t\t\tif (p == 0) flag = 1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (flag) {\n\t\t\t\t\tif (p == 0) {\n\t\t\t\t\t\tFOR(i, 1, 1000) {\n\t\t\t\t\t\t\tans[i] += max(0, h * 60 + m - max(v[i], v[0]));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tflag = 0;\n\t\t\t\t\t}\n\t\t\t\t\telse ans[p] += max(0, h * 60 + m - max(v[p], v[0]));\n\t\t\t\t}\n\t\t\t\tv[p] = INF;\n\n\t\t\t}\n\t\t}\n\t\tint p, cmax = -1;\n\t\tFOR(i, 1, 1000) {\n\t\t\tif (ans[i] > cmax) {\n\t\t\t\tp = i;\n\t\t\t\tcmax = ans[i];\n\t\t\t}\n\t\t}\n\t\tcout << cmax << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cassert>\n#include<algorithm>\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n\nusing namespace std;\n\nint main(){\n\tfor(int n;scanf(\"%d\",&n),n;){\n\t\tstatic bool t[1000][1440];\n\t\trep(i,1000) rep(j,1440) assert(!t[i][j]);\n\t\tint bless[1000]={},enter[1000]={},last[1000]={};\n\n\t\tint pre=-1;\n\t\trep(k,n+1){\n\t\t\tint date;\n\t\t\tif(k<n){\n\t\t\t\tint mon,day,hh,mm,id;\n\t\t\t\tscanf(\"%d%*c%d %d%*c%d %*c %d\",&mon,&day,&hh,&mm,&id);\n\t\t\t\tdate=31*mon+day;\n\n\t\t\t\tif(enter[id]==0){\n\t\t\t\t\tenter[id]=60*hh+mm;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tfor(int j=enter[id];j<60*hh+mm;j++) t[id][j]=true;\n\t\t\t\t\tenter[id]=0;\n\t\t\t\t}\n\n\t\t\t\tlast[id]=date;\n\t\t\t}\n\t\t\telse date=7777777;\n\n\t\t\tif(pre!=date){\n\t\t\t\trep(i,1000) if(last[i]==pre) rep(j,1440) if(t[i][j] && t[0][j]) bless[i]++;\n\t\t\t\trep(i,1000) if(last[i]==pre) rep(j,1440) t[i][j]=false;\n\t\t\t}\n\t\t\tpre=date;\n\t\t}\n\n\t\tprintf(\"%d\\n\",*max_element(bless+1,bless+1000));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <map>\nusing namespace std;\n\nint parse(const string& t)\n{\n  return ((t[0]-'0')*10 + t[1]-'0')*60 + ((t[3]-'0')*10 + t[4]-'0');\n}\n\nint inter(int gb, int ge, int vb, int ve)\n{\n  if (ge < vb || ve < gb) {\n    return 0;\n  } else {\n    return min(ge, ve) - max(gb, vb);\n  }\n}\n\nvoid countup(map<string, int>& total, const map<string, vector<int> >& m)\n{\n  if (!m.count(\"000\")) {\n    return;\n  }\n  const vector<int>& god = m.find(\"000\")->second;\n  const int N = god.size();\n  if (N % 2 != 0) {\n    throw \"N is not even\";\n  }\n  for (map<string, vector<int> >::const_iterator it = m.begin(); it != m.end(); ++it) {\n    if (it->first == \"000\") {\n      continue;\n    }\n    const string& id = it->first;\n    const vector<int>& v = it->second;\n    const int M = v.size();\n    if (M % 2 != 0) {\n      throw \"M is not even\";\n    }\n    for (int i = 0; i < N; i += 2) {\n      for (int j = 0; j < M; j += 2) {\n        total[id] += inter(god[i], god[i+1], v[j], v[j+1]);\n      }\n    }\n  }\n}\n\nint main()\n{\n  int N;\n  while (cin >> N && N != 0) {\n    string prev_date = \"\";\n    map<string, vector<int> > m;\n    map<string, int> total;\n    for (int i = 0; i < N; i++) {\n      string date, time, act, id;\n      cin >> date >> time >> act >> id;\n      if (date != prev_date) {\n        countup(total, m);\n        m.clear();\n      }\n      m[id].push_back(parse(time));\n      prev_date = date;\n    }\n    countup(total, m);\n    int ans = 0;\n    for (map<string, int>::const_iterator it = total.begin(); it != total.end(); ++it) {\n      ans = max(ans, it->second);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint convert(char x,char y){\n    return (x-'0')*10+y-'0';\n}\nint solve(int n){\n    vector<string> date(n);\n    vector<int> t(n);\n    vector<char> op(n);\n    vector<string> id(n);\n    for(int i=0;i<n;i++){\n        string buf;\n        cin>>date[i]>>buf>>op[i]>>id[i];\n        t[i]=convert(buf[0],buf[1])*60+convert(buf[3],buf[4]);\n    }\n\n    map<string,int> res;\n    map<string,vector<int>> events;\n    for(int i=0;i<n;i++) events[date[i]].push_back(i);\n\n    for(auto &kvp:events){\n        auto event=kvp.second;\n        stack<tuple<string,int,int>> outer;\n        map<string,int> inner;\n        int gin=0;\n        for(int idx:event){\n            if(id[idx]==\"000\"){\n                if(op[idx]=='I'){\n                    gin=t[idx];\n                }\n                else{\n                    for(auto &e:inner){\n                        res[e.first]+=t[idx]-max(gin,e.second);\n                    }\n                    while(!outer.empty()){\n                        auto tmp=outer.top(); outer.pop();\n                        res[get<0>(tmp)]+=max(get<2>(tmp)-max(get<1>(tmp),gin),0);\n                    }\n                }\n            }\n            else{\n                if(op[idx]=='I'){\n                    inner[id[idx]]=t[idx];\n                }\n                else{\n                    outer.push(make_tuple(id[idx],inner[id[idx]],t[idx]));\n                    inner.erase(id[idx]);\n                }\n            }\n        }        \n    }\n    int ret=0;\n    for(auto &e:res) if(e.first!=\"000\") ret=max(ret,e.second);\n    return ret;\n}\n    \nint main(){\n    int n;\n    while(cin>>n,n){\n        cout<<solve(n)<<endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <sstream>\n#include <tuple>\n#include <queue>\n#include <set>\n#include <cstdio>\n#include <climits>\n#include <cmath>\n#include <array>\n#include <functional>\n#include <list>\n#include <iomanip>\n#include <set>\n#include <cctype>\nusing namespace std;\ntypedef string::const_iterator State;\nconst int MOD=1000000007;\nconst int INF=1000000000;\ntypedef long long ll;\ntypedef vector<int> vi;\nconst double eps=1e-9;\nconst int inf=1e9;\ntypedef pair<int,int> P;\n\nll godlogin=INF;\nll godlogout=0;\nll lin[1005];\nll lou[1005];\nll pray[1005];\nbool stay[1005];\nint main(int argc,char const* argv[])\n{\n  int n;\n  while(cin >> n && n)\n    {\n      string monday;\n      string times;\n      char io;\n      string id;\n      int num;\n      ll ans=-1;\n      memset(lin,0,sizeof(lin));\n      memset(lou,0,sizeof(lou));\n      memset(pray,0,sizeof(pray));\n      memset(stay,false,sizeof(stay));\n      bool godstay=false;\n      for(int i=0;i<n;i++)\n\t{\n\t  cin >> monday >> times >> io >> id;\n\t  num=int(id[0]-'0')*100+int(id[1]-'0')*10+int(id[2]-'0');\n\t  if(io=='I')\n\t    {\n\t      lin[num]=(int(monday[0]-'0')*10+int(monday[1]-'0'))*30*3600+(int(monday[3]-'0')*10+int(monday[4]-'0'))*3600+(int(times[0]-'0')*10+int(times[1]-'0'))*60+(int(times[3]-'0')*10+int(times[4]-'0'));\n\t      if(num==0) godstay=true;\n\t      else stay[num]=true;\n\t    }\n\t  if(io=='O')\n\t    {\n\t      lou[num]=(int(monday[0]-'0')*10+int(monday[1]-'0'))*30*3600+(int(monday[3]-'0')*10+int(monday[4]-'0'))*3600+(int(times[0]-'0')*10+int(times[1]-'0'))*60+(int(times[3]-'0')*10+int(times[4]-'0'));\n\t      if(num==0)\n\t\t{\n\t\t  godstay=false;\n\t\t  for(int i=1;i<1000;i++)\n\t\t    {\n\t\t      if(stay[i])\n\t\t\t{\n\t\t\t  pray[i]+=(lou[0]-max(lin[i],lin[0]));\n\t\t\t  pray[i]=max(pray[i],(ll)0);\n\t\t\t}\n\t\t    }\n\t\t}\n\t      else\n\t\t{\n\t\t  stay[num]=false;\n\t\t  if(godstay)\n\t\t    {\n\t\t      pray[num]+=(lou[num]-max(lin[num],lin[0]));\n\t\t      pray[num]=max(pray[num],(ll)0);\n\t\t    }\n\t\t}\n\t    }\n\t}\n      for(int i=1;i<1000;i++)\n\t{\n\t  ans=max(ans,pray[i]);\n\t}\n      cout << ans << endl;\n    }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <stdbool.h>\n#include <string.h>\n\nint max(int a[], int n) {\n  int i, m = 1;\n  for(i = 2; i < n; i ++) {\n    if(a[m] < a[i]) { m = i; }\n  }\n\n  return m;\n}\n\nint main() {\n  int n;\n  int mon[1000], day[1000], hou[1000], min[1000];\n  char IO[1000][2];\n  int id[1000];\n  int time[2][1000];\n  int total[1000];\n\n  while(true) {\n    scanf(\"%d\", &n);\n    if(n == 0) break;\n\n    int i, j;\n    for(i = 0; i < n; i ++) {\n      scanf(\"%d/%d %d:%d %c %d\", &mon[i], &day[i], &hou[i], &min[i], IO[i], &id[i]);\n    }\n    for(i = 0; i < 1000; i ++) {\n      time[0][i] = 0;\n      time[1][i] = 0;\n      total[i] = 0;\n    }\n\n    bool god_flg = false;\n    int in_flg[1000] = {0};\n    for(i = 0; i < n; i ++) {\n      if(id[i] == 0 && IO[i][0] == 'I') {\n\tgod_flg = true;\n\tfor(j = 0; j < 1000; j ++) {\n\t  time[0][j] = hou[i]*60 + min[i];\n\t}\n      }\n      else if(id[i] == 0 && IO[i][0] == 'O') {\n\tgod_flg = false;\n\tfor(j = 0; j < 1000; j ++) {\n\t  total[j] += in_flg[j]*(hou[i]*60 + min[i] - time[0][j]);\n\t}\n      }\n      else if(god_flg && IO[i][0] == 'I') {\n\ttime[0][id[i]] = hou[i]*60 + min[i];\n\tin_flg[id[i]] = 1;\n      }\n      else if(god_flg && IO[i][0] == 'O') {\n\ttime[1][id[i]] = hou[i]*60 + min[i];\n\ttotal[id[i]] += time[1][id[i]] - time[0][id[i]];\n\n\tin_flg[id[i]] = 0;\n      }\n      else if(!god_flg && IO[i][0] == 'I') {\n\tin_flg[id[i]] = 1;\n      }\n      else if(!god_flg && IO[i][0] == 'O') {\n\tin_flg[id[i]] = 0;\n      }\n    }\n    printf(\"%d\\n\", total[max(total, 1000)]);\n  }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long   // <-----!!!!!!!!!!!!!!!!!!!\n\n#define rep(i,n) for (int i=0;i<(n);i++)\n#define rep2(i,a,b) for (int i=(a);i<(b);i++)\n#define rrep(i,n) for (int i=(n)-1;i>=0;i--)\n#define rrep2(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n\ntypedef long long ll;\ntypedef pair<int, int> Pii;\ntypedef tuple<int, int, int> TUPLE;\ntypedef vector<int> V;\ntypedef vector<V> VV;\ntypedef vector<VV> VVV;\n\nstruct Range {\n    string d;\n    int l, r;\n    int id;\n    void print() {\n        cout << d << \" \" << l << \" \" << r << \" \" << id << endl;\n    }\n};\n\nint strToInt(string s) {\n    int ret = 0;\n    int sign = 1;\n\n    int i = 0;\n    if (s[0] == '-') {\n        i++;\n        sign = -1;\n    }\n\n    while (i < s.size()) {\n        ret *= 10;\n        ret += s[i] - '0';\n        i++;\n    }\n\n    return ret * sign;\n}\n\nint convTime(string s) {\n    int ret = 0;\n    stringstream ss(s);\n    string t;\n    while (getline(ss, t, ':')) {\n        ret *= 60;\n        // ret += stoi(t);\n        ret += strToInt(t);\n    }\n    return ret;\n}\n\nint common(const Range &a, const Range &b) {\n    if (a.d != b.d) return 0;\n    if (b.id == 0) return 0;\n    int l = max(a.l, b.l);\n    int r = min(a.r, b.r);\n    return max(0LL, r - l);\n}\n\nsigned main() {\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(0);\n\n    int n;\n    while (cin >> n, n) {\n        vector<stack<int>> v(1000);\n        vector<Range> u;\n        rep(i, n) {\n            string d, hhmm, e;\n            int id;\n            cin >> d >> hhmm >> e >> id;\n            int m = convTime(hhmm);\n            if (v[id].empty()) {\n                assert(e == \"I\");\n                v[id].push(m);\n            } else {\n                assert(e == \"O\");\n                int s = v[id].top(); v[id].pop();\n                u.emplace_back((Range){d, s, m, id});\n            }\n        }\n\n        // for (auto r : u) {\n        //     cout << r.d << \" \" << r.l << \" \" << r.r << \" \" << r.id << endl;\n        // }\n\n        V len(1000, 0);\n        for (auto a : u) {\n            if (a.id == 0) {\n                for (auto b : u) {\n                    len[b.id] += common(a, b);\n                    // a.print();\n                    // b.print();\n                    // cout << common(a, b) << endl;\n                }\n            }\n        }\n\n        cout << *max_element(all(len)) << endl;\n\n        // rep(i, 5) {\n        //     cout << len[i] << \" \";\n        // }\n        // cout << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <map>\n#include <algorithm>\n#include <vector>\n#include <memory.h>\nusing namespace std;\n\n#define Mon 35\n#define DAY 1440\n#define rep(i, n) for(int i = 0; i < n; i++)\n\nmap<string, int> id;\nint cnt[1000];\nvector<int> log[1000];\nbool present[12*Mon*DAY];\n\nint get_m(string day, string t){\n  int d = (day[0]-'0')*10+(day[1]-'0')*Mon+(day[3]-'0')*10+(day[4]-'0');\n  int m = ((t[0]-'0')*10+(t[1]-'0'))*60+(t[3]-'0')*10+(t[4]-'0');\n  return d * DAY + m;\n}\n\nint main(){\n  string day, tim, in, ID;\n  int n, num;\n  while(cin >> n && n){\n    num = 1;\n    int res = 0;\n    \n    id.clear();\n    memset(cnt, 0, sizeof(cnt));\n    memset(present, false, sizeof(present));\n    rep(i, 1000) log[i].clear();\n\n    rep(i, n){\n      cin >> day >> tim >> in >> ID;\n      if(id[ID] == 0) id[ID] = num++;\n      log[id[ID]].push_back(get_m(day, tim));\n    }\n    int gd = id[\"000\"];\n    int sz = log[gd].size()/2;\n    rep(i, sz){\n      int s = log[gd][2*i];\n      int t = log[gd][2*i+1];\n      while(s<t){\n\tpresent[s] = true;\n\ts++;\n      }\n    }\n    for(int i = 1; i < num; i++){\n      if(i == gd) continue;\n      int sz = log[i].size()/2;\n      int c = 0;\n      rep(j, sz){\n\tint s = log[i][j*2];\n\tint t = log[i][j*2+1];\n\twhile(s < t) {\n\t  if(present[s++]) c++;\n\t}\n      }\n      res = max(res, c);\n    }\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n\nstruct segtree{\n  vector<int> datasum;\n  vector<int> delay;\n \n  int n;\n \n  //テ・ツ按敕ヲツ慊淌・ツ個?\n  void init(int _n){\n    n = 1;\n    while( n < _n ) n*=2;\n    datasum.resize( 2 * n );\n    delay.resize( 2 * n );\n  }\n \n  //テ」ツつッテ」ツδェテ」ツつ「(テ、ツスツ陛・ツコツヲテ」ツつづ、ツスツソテ」ツ??・ツ?エテ・ツ青暗ッツシツ?\n  void clear(){\n    datasum.clear();\n    delay.clear();\n  }\n  \n  void delaycalc(int k,int l,int r){\n    datasum[k] = datasum[k] + delay[k]*(r-l);\n    if( k+1 < n ){\n      for(int i=1;i<=2;i++){\n\tdelay[2*k+i] = delay[2*k+i]+delay[k];\n      }\n    }\n    delay[k] = 0;\n  }   \n \n  //テ・ツ個コテゥツ鳴禿」ツ??a,b)テ」ツ??」ツ?ォテ、ツクツ?ヲツァツ佚」ツ?ォテ」ツ??テ」ツ??」ツつ津ィツカツウテ」ツ??\n  void add(int a,int b,int x,int k,int l,int r){\n    delaycalc(k,l,r);\n    if( r<=a || b<=l ) return;\n    else if( a<=l && r<=b ){\n      delay[k] = x;\n      delaycalc(k,l,r);\n    } else {\n      add( a, b, x, 2*k + 1, l, (l+r)/2 );\n      add( a, b, x, 2*k + 2, (l+r)/2, r );\n      datasum[k] = datasum[2*k+1]+datasum[2*k+2];\n    }\n  }\n \n  int querysum(int a,int b,int k,int l,int r){\n    delaycalc(k,l,r);\n    if( r<=a || b<=l ) return 0;\n    if( a<=l && r<=b ){\n      return datasum[k]+delay[k]*(r-l);\n    } else {\n      int vl = querysum( a, b, 2*k+1, l,(l+r)/2 );\n      int vr = querysum( a, b, 2*k+2, (l+r)/2,r );\n      return vl+vr;\n    }\n  }\n \n  void add( int a,int b,int x){ add( a, b, x, 0,0,n); }\n  int querysum(int a,int b){ return querysum(a,b,0,0,n); }\n};\ntypedef pair<int,int> P;\nsegtree S[420];\nvector<P> st[1001];\nbool used[420];\nint main(){\n  int N;\n  while(cin >> N && N ){\n    for(int i=0;i<N;i++){\n      int m,d,h,mi,no;\n      char ex;\n      scanf(\"%d/%d %d:%d %c %d\",&m,&d,&h,&mi,&ex,&no);\n      int dt = m*31+d;\n      int mini = h * 60 + mi;\n      st[no].push_back(P(dt,mini));\n    }\n    memset(used,0,sizeof(used));\n    sort(st[0].begin(),st[0].end());\n    assert( st[0].size() % 2 == 0 );\n    for(int i=0;i<(int)st[0].size();i+=2){\n      int dat = st[0][i].first;\n      int sta = st[0][i].second;\n      int ed = st[0][i+1].second;\n      if( !used[dat] ){\n\tS[dat].init(60*24+1);\n      }\n      used[dat] = true;\n      S[dat].add(sta,ed,1);\n    }\n    int res = 0;\n    for(int i=1;i<1000;i++){\n      assert( st[i].size() % 2 == 0 );\n      sort(st[i].begin(),st[i].end());\n      int r=0;\n      for(int j=0;j<(int)st[i].size();j+=2){\n\tint dat = st[i][j].first;\n\tint sta = st[i][j].second;\n\tint ed = st[i][j+1].second;\n\tif( !used[dat] ) continue;\n\tr+=S[dat].querysum( sta, ed );\n      }\n      res = max( res, r );\n    }\n    cout << res << endl;\n    for(int i=0;i<420;i++)\n      S[i].clear();\n    for(int i=0;i<1000;i++) st[i].clear();\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define GET_MACRO(_1,_2,_3,_4,_5,_6,_7,_8,NAME,...) NAME\n#define pr(...) cerr<< GET_MACRO(__VA_ARGS__,pr8,pr7,pr6,pr5,pr4,pr3,pr2,pr1)(__VA_ARGS__) <<endl\n#define pr1(a) (#a)<<\"=\"<<(a)<<\" \"\n#define pr2(a,b) pr1(a)<<pr1(b)\n#define pr3(a,b,c) pr1(a)<<pr2(b,c)\n#define pr4(a,b,c,d) pr1(a)<<pr3(b,c,d)\n#define pr5(a,b,c,d,e) pr1(a)<<pr4(b,c,d,e)\n#define pr6(a,b,c,d,e,f) pr1(a)<<pr5(b,c,d,e,f)\n#define pr7(a,b,c,d,e,f,g) pr1(a)<<pr6(b,c,d,e,f,g)\n#define pr8(a,b,c,d,e,f,g,h) pr1(a)<<pr7(b,c,d,e,f,g,h)\n#define prArr(a) {cerr<<(#a)<<\"={\";int i=0;for(auto t:(a))cerr<<(i++?\", \":\"\")<<t;cerr<<\"}\"<<endl;}\nusing namespace std;\nusing Int = long long;\nusing _int = int;\nusing ll = long long;\nusing Double = long double;\nconst Int INF = (1LL<<60)+1e9; // ~ 1.15 * 1e18\nconst Int mod = (1e9)+7;\nconst Double EPS = 1e-8;\nconst Double PI = 6.0 * asin((Double)0.5);\nusing P = pair<Int,Int>;\ntemplate<class T> T Max(T &a,T b){return a=max(a,b);}\ntemplate<class T> T Min(T &a,T b){return a=min(a,b);}\ntemplate<class T1, class T2> ostream& operator<<(ostream& o,pair<T1,T2> p){return o<<\"(\"<<p.first<<\",\"<<p.second<<\")\";}\ntemplate<class T1, class T2, class T3> ostream& operator<<(ostream& o,tuple<T1,T2,T3> t){\n  return o<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\")\";}\ntemplate<class T1, class T2> istream& operator>>(istream& i,pair<T1,T2> &p){return i>>p.first>>p.second;}\ntemplate<class T> ostream& operator<<(ostream& o,vector<T> a){Int i=0;for(T t:a)o<<(i++?\" \":\"\")<<t;return o;}\ntemplate<class T> istream& operator>>(istream& i,vector<T> &a){for(T &t:a)i>>t;return i;}\n//INSERT ABOVE HERE\n\nint solve(){\n  int N;\n  cin>>N;\n  if(N == 0) return 0;\n\n  map<int, int> room;\n  map<int, int> cnt;\n\n  for(int i=0;i<N;i++){\n    _int month, day, hour, minute;\n    char ch;\n    _int id;\n    scanf(\"%d/%d %d:%d %c %d\", &month, &day, &hour, &minute, &ch, &id);\n    minute = hour * 60 + minute;\n    if(ch == 'I') assert(room.count(id) == 0), room[id] = minute;\n    if(ch == 'O'){\n      assert(room.count(id) != 0);\n      if(id == 0){\n        for(auto &p:room){\n          int t = room[id];\n          int id2, t2; tie(id2, t2) = p;\n          cnt[id2] += minute - max(t, t2);\n        }\n      }\n      if(id != 0){\n        if(room.count(0)) cnt[id] += minute - max(room[id], room[0]);\n      }\n      room.erase(id);\n    }\n  }\n\n  int ans = 0;\n  for(auto p:cnt) if(p.first != 0 )Max(ans, p.second);\n  cout<<ans<<endl;\n  return 1;\n}\n\nsigned main(){\n  //srand((unsigned)time(NULL));\n  //cin.tie(0);\n  //ios_base::sync_with_stdio(0);\n  //cout << fixed << setprecision(12);\n\n  while(solve());\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n\tlong long int N;\n\twhile(cin >> N , N)\n\t{\n\t\tmap<string , pair<long long int , long long int>>data;\n\t\tset<string>IO;\n\t\tbool f = false;\n\t\tfor(size_t i = 0; i < N; i++)\n\t\t{\n\t\t\tstring MD , who;\n\t\t\tcin >> MD;\n\t\t\tint h , m;\n\t\t\tchar c;\n\t\t\tcin >> h >> c >> m;\n\t\t\tcin >> c;\n\t\t\tcin >> who;\n\t\t\tif(c == 'I')\n\t\t\t{\n\t\t\t\tif(who == \"000\")\n\t\t\t\t{\n\t\t\t\t\tf = true;\n\t\t\t\t\tfor(auto x : IO)\n\t\t\t\t\t{\n\t\t\t\t\t\tdata[x].first = h * 60 + m;\n\t\t\t\t\t}\n\t\t\t\t} else\n\t\t\t\t{\n\t\t\t\t\tIO.insert(who);\n\t\t\t\t\tif(f)\n\t\t\t\t\t{\n\t\t\t\t\t\tdata[who].first = h * 60 + m;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else\n\t\t\t{\n\t\t\t\tif(who == \"000\")\n\t\t\t\t{\n\t\t\t\t\tf = false;\n\t\t\t\t\tfor(auto x : IO)\n\t\t\t\t\t{\n\t\t\t\t\t\tdata[x].second += h * 60 + m - data[x].first;\n\t\t\t\t\t}\n\t\t\t\t} else\n\t\t\t\t{\n\t\t\t\t\tIO.erase(who);\n\t\t\t\t\tif(f)\n\t\t\t\t\t{\n\t\t\t\t\t\tdata[who].second += h * 60 + m - data[who].first;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tlong long int ans1 , ans2;\n\t\tfor(auto x : data)\n\t\t{\n\t\t\tif(x.second.second > ans1)\n\t\t\t{\n\t\t\t\tans1 = x.second.second;\n\t\t\t}\n\t\t}\n\t\tcout << ans1 << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<vector>\n\nusing namespace std;\n\ntypedef long long ll;\nconst int MAX = 1001;\nstruct data{ll month,day,hour,min;};\n\nint mon[] = {0,31,28,31,30,31,30,31,31,30,31,30,31};\nll N,T[MAX];\ndata D[MAX];\nbool isInside[MAX];\n\nvoid init(){\n  fill(T,T+MAX,0);\n  fill(isInside,isInside+MAX,false);\n}\n\nll getTime(data d){\n  ll tmp = 0;\n\n  for(int i = 1; i < d.month; i++)\n    tmp += mon[i]*24*60;\n  \n  tmp += d.day*24*60;\n  tmp += d.hour*60;\n  tmp += d.min;\n  return tmp;\n}\n\nvoid solve(){\n\n  bool isIN = false;\n\n  vector<int> V;\n  for(int i = 0; i < N; i++){\n    data d;\n    char c;\n    int id;\n    scanf(\"%d/%d %d:%d %c %d\",&d.month,&d.day,&d.hour,&d.min,&c,&id);\n\n     if(id == 0){\n       isIN = (c == 'I');\n       \n       if(c == 'O'){\n\t for(int j = 1; j < MAX; j++)\n\t   if(isInside[j]) T[j] += getTime(d)-max(getTime(D[j]),getTime(D[0]));\n       }else D[0] = d;\n       continue;\n     }\n     \n    if(c == 'I'){\n      D[id] = d;\n      isInside[id] = true;\n    }else{\n      if(isIN && isInside[id]) T[id] += getTime(d)-getTime(D[id]);\n      isInside[id] = false;\n    }\n   }\n\n  ll ans = 0;\n  for(int i = 1; i < MAX; i++)\n    ans = max(ans,T[i]);\n  cout << ans << endl;\n}\n\nint main(){\n  while(cin >> N && N){\n    init();\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\n\nstruct D { int t; bool ex; int p; };\n\nint main()\n{\n\tint n;\n\twhile (cin >> n, n)\n\t{\n\t\tvector<D> v;\n\t\tREP(i, n)\n\t\t{\n\t\t\tint mon, day, h, m; char io; int p;\n\t\t\tscanf(\"%d/%d %d:%d\", &mon, &day, &h, &m);\n\t\t\tcin >> io >> p;\n\t\t\tint t = m + h * 60 + day * 1440 + mon * 1440 * 31;\n\t\t\tv.emplace_back(D{ t,(io=='I'),p });\n\t\t}\n\t\tvector<bool> f(1000);\n\t\tvi ans(1000);\n\t\tint t = v[0].t;\n\t\tf[v[0].p] = v[0].ex;\n\t\tFOR(i, 1, n)\n\t\t{\n\t\t\tint res = v[i].t - t;\n\t\t\tFOR(j, 1, 1000)\n\t\t\t{\n\t\t\t\tif (f[0]&&f[j]) ans[j] += res;\n\t\t\t}\n\t\t\tt = v[i].t;\n\t\t\tf[v[i].p] = v[i].ex;\n\t\t}\n\t\tcout << *max_element(ALL(ans)) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef pair<int,int> pii;\n#define all(c) (c).begin(), (c).end()\n#define loop(i,a,b) for(ll i=a; i<ll(b); i++)\n#define rep(i,b) loop(i,0,b)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define lb lower_bound\n#define ub upper_bound\n#ifdef DEBUG\n#define dump(...) (cerr<<#__VA_ARGS__<<\" = \"<<(DUMP(),__VA_ARGS__).str()<<\" [\"<<__LINE__<<\"]\"<<endl)\nstruct DUMP:ostringstream{template<class T>DUMP &operator,(const T&t){if(this->tellp())*this<<\", \";*this<<t;return *this;}};\n#else\n#define dump(...)\n#endif\ntemplate<class T> ostream& operator<<(ostream& os, vector<T> const& v){\n    rep(i,v.size()) os << v[i] << (i+1==v.size()?\"\":\" \");\n    return os;\n}\n\nint N;\nint sum[1000];\nvector<pair<int,int>> logs[1000];\n\nint exist[564480+1000];\n\nint f(int m, int d, int h, int M){\n    return m*60*24*30 + d*60*24 + h*60 + M;\n}\n\nint main(){\n#ifdef DEBUG\n    freopen(\"in\",\"r\",stdin);\n    cout << f(12,31,24,00) << endl;\n#endif\n    while(~scanf(\"%d\\n\",&N) && N){\n        rep(i,1000) logs[i].clear();\n        memset(exist,0,sizeof(exist));\n        memset(sum,0,sizeof(sum));\n        rep(i,N){\n            int id;\n            char io;\n            int m,d,h,M;\n            scanf(\"%d/%d %d:%d \", &m,&d,&h,&M);\n            int t = f(m,d,h,M);\n            cin >> io >> id;\n            if(io=='I'){\n                logs[id].eb(t,f(m,d,24,0));\n                if(id==0) exist[t]++;\n            } else {\n                logs[id].back().second = t;\n                if(id==0) exist[t]--;\n            }\n        }\n        rep(i,300000-1) exist[i+1] += exist[i];\n        dump(vi(exist,exist+60));\n        rep(i,300000-1) exist[i+1] += exist[i];\n        dump(vi(exist,exist+60));\n        int ans = 0;\n        rep(i,1000)if(i){\n            for(auto & p : logs[i]){\n                int l,r;\n                tie(l,r) = p;\n                sum[i] += exist[r]-exist[l-1];\n            }\n            ans = max(ans, sum[i]);\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <vector>\nusing namespace std;\n\nint M[1000][1440],C[1000],T[1000],X[1000];\nvector<pair<int,int> >v;\n\nvoid newday(){\n\tif(T[0]>=0)v.push_back(make_pair(T[0],1440));\n\tint i,p,t,u;\n\tfor(p=1;p<1000;p++){\n\t\tif(C[p])for(t=T[p];t<1440;t++)M[p][t]=1;\n\t}\n\tfor(i=0;i<v.size();i++){\n\t\tfor(p=1;p<1000;p++){\n\t\t\tt=v[i].first,u=v[i].second;\n\t\t\tfor(;t<u;t++)\n\t\t\t\tif(M[p][t])X[p]++;\n\t\t}\n\t}\n\tmemset(M,0,sizeof(M));\n\tmemset(C,0,sizeof(C));\n\tmemset(T,0xff,sizeof(T));\n\tv.clear();\n}\n\nint main(){\n\tint n,M1,D1,M2,D2,h,m,s,p,q;char e;\n\tfor(;scanf(\"%d\",&n),n;){\n\t\tmemset(M,0,sizeof(M));\n\t\tmemset(C,0,sizeof(C));\n\t\tmemset(T,0xff,sizeof(T));\n\t\tmemset(X,0,sizeof(X));\n\t\tv.clear();\n\t\tfor(M1=0;n;n--){\n\t\t\tscanf(\"%02d/%02d %02d:%02d %c %03d\",&M2,&D2,&h,&m,&e,&p);\n\t\t\tif(M1!=M2||D1!=D2)newday(),M1=M2,D1=D2;\n\t\t\ts=e=='I'?1:0;\n\t\t\th=h*60+m;\n\t\t\tif(T[p]==-1)T[p]=h;\n\t\t\tif(s)C[p]++;\n\t\t\telse{\n\t\t\t\tC[p]--;\n\t\t\t\tif(!C[p]){\n\t\t\t\t\tif(p==0)v.push_back(make_pair(T[0],h));\n\t\t\t\t\telse{\n\t\t\t\t\t\t//printf(\"---%d %d %d\\n\",p,T[p],h);\n\t\t\t\t\t\tfor(q=T[p];q<h;q++)M[p][q]=1;\n\t\t\t\t\t}\n\t\t\t\t\tT[p]=-1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tnewday();\n\t\tfor(m=0,p=1;p<1000;p++){\n\t\t\tif(m<X[p])m=X[p];\n\t\t}\n\t\tprintf(\"%d\\n\",m);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n\nusing namespace std;\n\nconst int maxn = 1000;\n\nint n, month, day, h, m, id, last, god;\nint presum[maxn][2*maxn], st[maxn], et[maxn], cnt[maxn];\nchar c;\n\nint main()\n{\n#ifdef LOCAL\n\tfreopen(\"A.in\", \"r\", stdin);\n#endif\n\twhile(scanf(\"%d\", &n)) {\n\t\tif(n == 0)\tbreak;\n\t\tlast = -1;\n\t\tmemset(cnt, 0, sizeof(cnt));\n\t\tfor(int i = 0; i < n; i++) {\n\t\t\tscanf(\"%d/%d %d:%d %c %d\", &month, &day, &h, &m, &c, &id);\n\t\t\tif(month*100+day != last || i == n-1) {\n\t\t\t//update\t\n\t\t\t\tfor(int j = 1; j < 1000; j++)\n\t\t\t\t\tfor(int k = 0; k < god; k++) {\n\t\t\t\t\t\tcnt[j] += presum[j][et[k]?et[k]:1440] - presum[j][st[k]];\n\t\t\t\t\t}\n//\t\t\t\tcout <<\"Go\" << endl;\n//\t\t\t\tcout << presum[3][9*60+10] << endl;\n//\t\t\t\tfor(int j = 1; j <= 3; j++)\n//\t\t\t\t\tfor(int k = 0; k < god; k++)\n//\t\t\t\t\tcout << presum[j][et[k]?et[k]:1440] - presum[j][st[k]] << endl;\n//\t\t\t\tfor(int i = 1; i <=3 ; i++)\n//\t\t\t\t\tcout << cnt[i] << endl;\n\t\t\t\tlast = 100*month+day;\n\t\t\t\tgod = 0;\n\t\t\t\tmemset(presum, 0, sizeof(presum));\n\t\t\t\tmemset(et, 0, sizeof(et));\n\t\t\t}\n\t\t\tif(id == 0)\t{\n\t\t\t\tif(c == 'I')\tst[god] = h*60+m;\n\t\t\t\telse\tet[god++] = h*60+m;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(c == 'I') \n\t\t\t\tfor(int j = h*60+m; j <= 1440; j++)\n\t\t\t\t\tpresum[id][j] = j-60*h-m;\n\t\t\telse\n\t\t\t\tfor(int j = h*60+m+1; j <= 1440; j++)\n\t\t\t\t\tpresum[id][j] = presum[id][h*60+m];\n\t\t}\n\t\tint ans = 0;\n\t\tfor(int i = 1; i < 1000; i++)\n\t\t\tans = max(ans, cnt[i]);\n\t\tprintf(\"%d\\n\", ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n\nusing namespace std;\n\nconst int N = 1000;\n\nmain(){\n  int n, it[N], st[N];\n  while(cin >> n && n){\n    fill(it, it+N, -2);\n    fill(st, st+N, 0);\n    for(int i=0;i<n;i++){\n      string a, b, c;\n      cin >> a >> a >> b >> c;\n      int t = atoi(a.substr(0, 2).c_str()) * 60 + atoi(a.substr(3).c_str());\n      int id = atoi(c.c_str());\n      if(b == \"I\"){\n        if(id == 0){\n          for(int j=0;j<N;j++) if(it[j] == -1) it[j] = t;\n        }\n        if(it[0] == -2) it[id] = -1;\n        else it[id] = t;\n      }else{\n        if(id == 0){\n          for(int j=0;j<N;j++){\n            if(it[j] >= 0){\n              st[j] += t - it[j];\n              it[j] = -1;\n            }\n          }\n        }\n        if(it[0] != -2) st[id] += t - it[id];\n        it[id] = -2;\n      }\n    }\n    int ans = 0;\n    for(int i=1;i<N;i++) ans = max(ans, st[i]);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <cassert>\n#include <memory>\n#include <time.h>\nusing namespace std;\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n) FOR(i,0,n)\nconst double EPS = 1e-9;\nconst double PI  = acos(-1.0);\n\n\nstruct programmer{\n\tint score,presence;\n\tprogrammer():score(0),presence(0){}\n};\nstruct evnt{\n\tint month,date;\n\tint hour,min;\n\tchar inout;\n\tint id;\n};\nint main(){\n\tint n;\n\twhile(cin>>n,n){\n\t\tvector<programmer> programmers(1000);\n\t\tint pl=programmers.size();\n\t\tvector<evnt> evnts(n);\n\t\tREP(i,n){\n\t\t\tchar sep;\n\t\t\tcin>>evnts[i].month>>sep>>evnts[i].date>>evnts[i].hour>>sep>>evnts[i].min>>evnts[i].inout>>evnts[i].id;\n\t\t}\n\t\tFOR(i,1,evnts.size()){\n\t\t\tif(evnts[i].date!=evnts[i-1].date){\n\t\t\t\tevnt e;\n\t\t\t\te.month=evnts[i-1].month;\n\t\t\t\te.date=evnts[i-1].date;\n\t\t\t\te.hour=24;\n\t\t\t\te.min=0;\n\t\t\t\te.inout='C';\n\t\t\t\tevnts.insert(evnts.begin()+i,e);\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t\t\t\tevnt e;\n\t\t\t\te.month=evnts[evnts.size()-1].month;\n\t\t\t\te.date=evnts[evnts.size()-1].date;\n\t\t\t\te.hour=24;\n\t\t\t\te.min=0;\n\t\t\t\te.inout='C';\n\t\t\t\tevnts.push_back(e);\n\n\t\tint prevtime=0;\n\t\tint goddess_presence=0;\n\t\tREP(i,n){\n\t\t\tint curtime=evnts[i].hour*60+evnts[i].min;\n\t\t\tif(evnts[i].inout=='C'){\n\t\t\t\tREP(j,pl){\n\t\t\t\t\tif(programmers[j].presence&&goddess_presence){\n\t\t\t\t\t\tprogrammers[j].score+=curtime-prevtime;\n\t\t\t\t\t}\n\t\t\t\t\tprogrammers[j].presence=0;\n\t\t\t\t}\n\t\t\t\tgoddess_presence=0;\n\t\t\t\tprevtime=0;\n\t\t\t}else if(evnts[i].id==0){\n\t\t\t\tif(evnts[i].inout=='O'){\n\t\t\t\t\tREP(j,pl){\n\t\t\t\t\t\tif(programmers[j].presence){\n\t\t\t\t\t\t\tprogrammers[j].score+=curtime-prevtime;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tgoddess_presence=evnts[i].inout=='I';\n\t\t\t\tprevtime=curtime;\n\t\t\t}else{\n\t\t\t\tif(goddess_presence){\n\t\t\t\t\tREP(j,pl){\n\t\t\t\t\t\tif(programmers[j].presence){\n\t\t\t\t\t\t\tprogrammers[j].score+=curtime-prevtime;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tprogrammers[evnts[i].id].presence=evnts[i].inout=='I';\n\t\t\t\tprevtime=curtime;\n\t\t\t}\n\t\t\t//cerr<<curtime<<\"*\"<<evnts[i].month<<evnts[i].date<<\"-\"<<evnts[i].hour<<\":\"<<evnts[i].min<<\"= \";\n\t\t\t//FOR(j,1,5){\n\t\t\t//\tcerr<<programmers[j].score<<\",\";\n\t\t\t//}\n\t\t\t//cerr<<endl;\n\t\t}\n\t\tint ans=0;\n\t\tREP(i,pl){\n\t\t\tans=max(ans,programmers[i].score);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<map>\n#include<string>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n\nconst int INF = 1000000000;\n\nclass Data{\npublic:\n  int s,e,sum;\n  bool f;\n  Data();\n};\nData::Data(){\n  sum = 0;\n};\n\nint main(){\n\n  int n;\n  while(1){\n    cin >> n;\n    if(n == 0)break;\n    map<string,Data > md;\n    \n    //  cout << \" n = \" << n << endl;//\n\n    for(int i = 0 ; i < n ; i++){\n      string date,id;\n      int h,m;\n      char c;\n\n      cin >> date;\n      //cout << \"date = \" << date << endl;//\n      scanf(\"%0d:%0d\",&h,&m);\n      //cout << \"h = \" << h << \" m = \" <<m << endl; //\n      cin >> c >> id;\n      // cout << \"c = \" << c << \" id = \" << id << endl; \n\n      // cout << \"i = \" << i << endl;\n      // cout << \"id = \" << 002 << \" sum = \" << md[\"002\"].sum << endl;\n      \n      \n\n\n      if(c == 'I'){\n\tmd[id].s = h * 60 + m;\n\tmd[id].f = true;\n\tmd[id].e = INF;\n\n\n\t/*\n\tif(id == \"002\"){////\n\t  \n\t  cout << \"002 : sum = \"<<  md[id].sum  << \" f = \" << md[id].f << endl;\n\t  cout << \" c = \" << c << \" 000 : f = \" << md[\"000\"].f << endl;\n\t}\n\t*/\n\n\n      }\n      else { // c == O\n\tmd[id].e =  h * 60 + m;\n\n\n\tif(id == \"000\"){\n\t  //  cout << \"!\" << endl;//\n\n\t  map<string,Data>::iterator it;\n\t  for(it = md.begin() ; it != md.end(); it++){\n\t    if(it->first == \"000\")continue;\n\t    \n\t    Data & V = it->second;\n\t    Data & G = md[\"000\"];\n\n\t    if(!V.f)continue;\n\t    \n\t    \n\t    \n\t    if(V.s <= G.s && G.e <= V.e)V.sum += G.e - G.s;\n\t    else if(V.s <= G.s && V.e <= G.e)V.sum += V.e - G.s;\n\t    else if(G.s <= V.s && V.e <= G.e)V.sum += V.e - V.s;\n\t    else if(G.s <= V.s && G.e <= V.e)V.sum += G.e - V.s;\n\t  }\n\t}\n\telse{\n\t  Data & V = md[id];\n\t  Data & G = md[\"000\"];\n\t  if(!G.f){\n\t    md[id].s = 0;\n\t    md[id].e = 0;\n\t    md[id].f = false;\n\t    continue;\n\t  }\n\n\t  if(V.s <= G.s && G.e <= V.e)V.sum += G.e - G.s;\n\t  else if(V.s <= G.s && V.e <= G.e)V.sum += V.e - G.s;\n\t  else if(G.s <= V.s && V.e <= G.e)V.sum += V.e - V.s;\n\t  else if(G.s <= V.s && G.e <= V.e)V.sum += G.e - V.s;\n\t}\n\tmd[id].s = 0;\n\tmd[id].e = 0;\n\tmd[id].f = false;\n      }\n    }\n     int maxi = 0;\n     map<string,Data>::iterator it;\n     for(it = md.begin() ; it != md.end(); it++){\n       //cout << it->first << ' ' << it->second.sum << endl;//\n       maxi = max(it->second.sum,maxi);\n     }\n     cout << maxi << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <vector>\n#include <cmath>\n#define pi 3.14159265358979323\n#define ll long long\nusing namespace std;\nint a[1005];\nint inpeople[505];\nbool ppp[505];\nstruct node\n{\n    int t1,t2;\n    char ch[5];\n    int num;\n};\nstruct edge\n{\n    int t1,t2;\n    int num;\n    bool p;\n}e[505];\nint main()\n{\n    int n,maxn,num;\n    int m1,d1,m2,d2,godt1,godt2;\n    node no;\n    while(scanf(\"%d\",&n) && n)\n    {\n        memset(a,0,sizeof(a));\n        memset(e,0,sizeof(e));\n        maxn=0;\n        num=0;\n        m2=d2=0;\n        for(int i=0;i<n;i++)\n        {\n            scanf(\"%d/%d %d:%d %s %d\",&m1,&d1,&no.t1,&no.t2,no.ch,&no.num);\n            if(m1!=m2 || d1!=d2)\n            {\n                num=0;\n                m2=m1,d2=d1;\n            }\n            if(no.ch[0]=='I' && no.num==0)\n            {\n                for(int k=0;k<num;k++)\n                {\n                    e[k].t1=no.t1;\n                    e[k].t2=no.t2;\n                }\n                godt1=no.t1,godt2=no.t2;\n                i++;\n                for(;i<n;i++)\n                {\n                    scanf(\"%d/%d %d:%d %s %d\",&m1,&d1,&no.t1,&no.t2,no.ch,&no.num);\n                    if(no.ch[0]=='O' && no.num==0)\n                    {\n                        for(int j=0;j<num;j++)\n                        {\n                            if(e[j].p==false) continue;\n                            a[e[j].num ]+=((no.t1-e[j].t1)*60+no.t2-e[j].t2);\n                        }\n\n                        break;\n                    }\n                    if(no.ch[0]=='I')\n                    {\n                        e[num].t1=no.t1;\n                        e[num].t2=no.t2;\n                        e[num].num=no.num;\n                        e[num].p=true;\n                        num++;\n                    }\n                    else{\n                        for(int j=0;j<num;j++)\n                        {\n                            if(e[j].num == no.num)\n                            {\n\n                                a[no.num]+=((no.t1-e[j].t1)*60+no.t2-e[j].t2);\n                                e[j].p=false;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n            else if(no.ch[0]=='I')\n            {\n                e[num].t1=no.t1;\n                e[num].t2=no.t2;\n                e[num].num=no.num;\n                e[num].p=true;\n                num++;\n            }\n            else\n            {\n                for(int j=0;j<num;j++)\n                {\n                    if(no.num==e[j].num)\n                    {\n                        e[j].p=false;\n                    }\n                }\n            }\n        }\n        for(int i=0;i<1000;i++)\n            if(maxn < a[i]) maxn=a[i];\n        cout<<maxn<<endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\nusing namespace std;\nint lastin[1111];\nint blessed[1111];\nbool manin[1111];\nbool valkyria_in;\nint valkyria_time;\nint n;\nstring s;\nint ans;\nint hr,mi;\nchar move;\nint index;\nvoid solve(){\n\tint t=hr*60+mi;\n\tif(move=='I'){\n\t\tif(index==0){\n\t\t\tvalkyria_in=true;\n\t\t\tvalkyria_time=t;\n\t\t}\n\t\telse{\n\t\t\tmanin[index]=true;\n\t\t\tlastin[index]=t;\n\t\t}\n\t}\n\telse{\n\t\tif(index==0){\n\t\t\tvalkyria_in=false;\n\t\t\tfor(int i=1;i<1111;i++){\n\t\t\t\tif(manin[i])blessed[i]+=t-max(lastin[i],valkyria_time);\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tmanin[index]=false;\n\t\t\tif(valkyria_in)blessed[index]+=t-max(lastin[index],valkyria_time);\n\t\t}\n\t}\n}\nint main(){\n\twhile(cin>>n&&n>0){\n\t\tans=0;\n\t\tmemset(manin,0,sizeof(manin));\n\t\tmemset(blessed,0,sizeof(blessed));\n\t\tvalkyria_in=false;\n\t\twhile(n--){\n\t\t\tcin>>s>>hr>>move>>mi>>move>>index;\n\t\t\tsolve();\n\t\t}\n\t\tfor(int i=1;i<1111;i++)ans=max(ans,blessed[i]);\n\t\tcout<<ans<<\"\\n\";\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\nusing namespace std;\n\nint days[12] = {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};\nint days_sum[12];\n\nint f(int l, int r, int L, int R){\n\tint res = 0;\n\tif(l > L){swap(L, l); swap(R, r);}\n\treturn max(0, min(R - L, r - L));\n}\n\nint main(){\n\tint n;\n\trep(i, 1, 12) days_sum[i] = days_sum[i - 1] + days[i - 1];\n\twhile(cin >> n, n){\n\t\tint M[1010], D[1010], h[1010], m[1010], p[1010];\n\t\tchar e[1010];\n\t\tvector<int> data[1010];\n\t\trep(i, 0, n){\n\t\t\tscanf(\"%d/%d %d:%d %c %d\", &M[i], &D[i], &h[i], &m[i], &e[i], &p[i]);\n\t\t\tM[i]--; D[i]--;\n\t\t\tint tmp = (days_sum[M[i]] + D[i]) * 3600 + h[i] * 60 + m[i];\n\t\t\tdata[p[i]].push_back(tmp);\n\t\t\t//cout << p[i] << \" \" << tmp << endl;\n\t\t\t//cout << M[i] << \" \" << D[i] << \" \" << h[i] << \" \" << m[i] << \" \" << e[i] << \" \" << p[i] << endl;\n\t\t}\n\t\tint MAX = 0;\n\t\trep(i, 1, 1000){\n\t\t\tif(data[i].size() == 0) continue;\n\t\t\t/*cout << i << endl;\n\t\t\trep(j, 0, data[i].size()){\n\t\t\t\tcout << data[i][j] << \" \";\n\t\t\t}\n\t\t\tcout << endl;\t*/\n\t\t\tint tmp = 0;\n\t\t\trep(j, 0, data[i].size() / 2){\n\t\t\t\trep(k, 0, data[0].size() / 2){\n\t\t\t\t\ttmp += f(data[i][2 * j], data[i][j * 2 + 1], data[0][2 * k], data[0][2 * k + 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tMAX = max(MAX, tmp);\n\t\t}\n\t\tcout << MAX << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i, n) for(int i = 0; i < (n); i++)\n#define repp(i, l, r) for(int i = (l); i < (r); i++)\n#define per(i, n) for(int i = ((n)-1); i >= 0; i--)\n#define perr(i, l, r) for(int i = ((r)-1); i >= (l); i--)\n#define all(x) (x).begin(),(x).end()\n#define MOD 1000000007\n#define IINF 1000000000\n#define LINF 1000000000000000000\n#define SP <<\" \"<<\n#define CYES cout<<\"Yes\"<<endl\n#define CNO cout<<\"No\"<<endl\n#define CFS cin.tie(0);ios::sync_with_stdio(false)\n\ntypedef long long LL;\ntypedef long double LD;\n\nint main(){\n  while(1){\n    int n;\n    cin >> n;\n    if(n==0) return 0;\n    vector<int> time(1000,0),in(1000,-1);\n    vector<bool> login(1000,false);\n    string d,t,io,ids;\n    rep(i,n){\n      cin >> d >> t >> io >> ids;\n      int tm=stoi(t.substr(0,2))*60+stoi(t.substr(3,2));\n      int id = stoi(ids);\n      if(id){\n        if(io==\"I\"){\n          if(login[0]){\n            in[id]=tm;\n            login[id]=true;\n          }else{\n            login[id]=true;\n          }\n        }else{\n          if(in[id]!=-1){\n            time[id]+=tm-in[id];\n            in[id]=-1;\n          }\n          login[id]=false;\n        }\n      }else{\n        if(io==\"I\"){\n          login[0]=true;\n          repp(j,1,1000){\n            if(login[j]) in[j]=tm;\n          }\n        }else{\n          login[0]=false;\n          repp(j,1,1000){\n            if(in[j]!=-1){\n              time[j]+=tm-in[j];\n              in[j]=-1;\n            }\n          }\n        }\n      }\n    }\n    int ans=0;\n    repp(i,1,n){\n      ans=max(ans,time[i]);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <cctype>\n#include <climits>\n#include <iostream>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <list>\n#include <deque>\n#include <set>\n#include <map>\n#include <algorithm>\nusing namespace std;\n\n#define FOR(i,j,k) for(int i=j;i<=(k);i++)\n#define REP(i,n) for(int i=0;i<(n);i++)\n#define ll long long\n\nconst int maxn = 1005;\nint n, ans;\nint sum[maxn], in[maxn];\nint tot, go;\n\ninline int calmin(int h, int m)\n{\n    return h*60+m;\n}\n\ninline int caldate(int mm ,int dd)\n{\n    return mm*31+dd;\n}\n\nint main()\n{\n    int mm, dd, h, m, id;\n    int curdate, lasttime;\n    char io[3];\n    while (scanf(\"%d\", &n) == 1 && n)\n    {\n        memset(sum, 0, sizeof(sum));\n        curdate = 0; tot = 0;\n        for (int i=0;i<n;i++)\n        {\n            scanf(\"%d/%d %d:%d %s %d\", &mm, &dd, &h, &m, io, &id);\n            int t = calmin(h, m);\n            if (curdate == caldate(mm, dd))\n            {\n                lasttime = 0;\n                memset(in, 0, sizeof(in));\n            }\n            if (io[0] == 'I')\n            {\n                if (go)\n                {\n                    for (int i=1;i<=tot;i++)\n                        if (in[i]) sum[i] += t - lasttime;\n                }\n                if (id == 0) go = 1;\n                in[id] = 1;\n                tot = max(tot, id);\n            }\n            else\n            {\n                if (go)\n                {\n                    for (int i=1;i<=tot;i++)\n                        if (in[i]) sum[i] += t - lasttime;\n                }\n                if (id == 0) go = 0;\n                in[id] = 0;\n            }\n            lasttime = t;\n        }\n        ans = 0;\n        for (int i=1;i<=tot;i++)\n            ans = max(ans, sum[i]);\n        printf(\"%d\\n\", ans);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#pragma warning(disable:4996)\n\n#define MAX_N 10000\n#define MAX_M 600\n\nint Q;\nint M[MAX_N], D[MAX_N], h[MAX_N], m[MAX_N], n[MAX_N], t;\nint K[MAX_N], L[MAX_N];\nchar c;\n\nint main() {\n\twhile (true) {\n\t\tfor (int i = 0; i < MAX_N; i++) {\n\t\t\tM[i] = 0; D[i] = 0; h[i] = 0; m[i] = 0; n[i] = 0; K[i] = 0; L[i] = -1;\n\t\t}\n\n\t\tbool megami = false; \n\t\tint zenkai = 0; \n\t\tcin >> Q; \n\t\tif (Q == 0) { break; }\n\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tscanf(\"%02d/%02d %02d:%02d %c %03d\", &M[i], &D[i], &h[i], &m[i], &c, &n[i]);\n\t\t\tt = h[i] * 60 + m[i];\n\t\t\tif (c == 'I') {\n\t\t\t\tL[n[i]] = t;\n\t\t\t}\n\t\t\tif (c == 'O') {\n\t\t\t\tif (n[i] >= 1) {\n\t\t\t\t\tif (L[0] >= 0) {\n\t\t\t\t\t\tK[n[i]] += t - max(L[0], L[n[i]]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfor (int j = 1; j < MAX_M; j++) {\n\t\t\t\t\t\tif (L[j] >= 0) {\n\t\t\t\t\t\t\tK[j] += t - max(L[0], L[j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tL[n[i]] = -1;\n\t\t\t}\n\t\t}\n\t\tint maxn = 0;\n\t\tfor (int i = 1; i < MAX_M; i++) {\n\t\t\tmaxn = max(maxn, K[i]);\n\t\t}\n\t\tcout << maxn << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <queue>\n#define REP(i,n) for(int i=0; i<(int)(n); i++)\n\ninline int getInt(){ int s; scanf(\"%d\", &s); return s; }\n\nusing namespace std;\n\ninline int timeOf(int h, int m){\n  return h * 60 + m;\n}\n\nint main(){\n  while(int n = getInt()){\n    vector<int> ans(1000, 0);\n    vector<int> in(1000, -1);\n\n    REP(i, n){\n      int M, D;\n      int h, m;\n      char s[2];\n      int id;\n\n      scanf(\"%02d/%02d %02d:%02d %s %03d\",\n            &M, &D, &h, &m, s, &id);\n\n      if(s[0] == 'I'){\n        in[id] = timeOf(h, m);\n      }else{\n        int t = timeOf(h, m);\n        if(id == 0){\n          for(int j = 1; j < 1000; j++){\n            if(in[j] != -1){\n              ans[j] += t - max(in[j], in[0]);\n            }\n          }\n        }else{\n          if(in[0] != -1){\n            ans[id] += t - max(in[id], in[0]);\n          }\n        }\n        in[id] = -1;\n      }\n    }\n\n    printf(\"%d\\n\", *max_element(ans.begin() + 1, ans.end()));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <sstream>\n#include <map>\n#include <set>\n\n#define REP(i,k,n) for(int i=k;i<n;i++)\n#define rep(i,n) for(int i=0;i<n;i++)\n#define INF 1<<30\n#define pb push_back\n#define mp make_pair\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nvector<string> split(const string &str, char delim) {\n\tvector<string> res;\n\tsize_t current = 0, found;\n\twhile((found = str.find_first_of(delim, current)) != string::npos) {\n\t\tres.push_back(string(str, current, found - current));\n\t\tcurrent = found + 1;\n\t}\n\tres.push_back(string(str, current, str.size() - current));\n\treturn res;\n}\n\n\n// s1 - s2\nint f(string s1, string s2) {\n\tint a = (s1[0] - '0') * 10 + (s1[1] - '0');\n\tint b = (s1[3] - '0') * 10 + (s1[4] - '0');\n\tint c = (s2[0] - '0') * 10 + (s2[1] - '0');\n\tint d = (s2[3] - '0') * 10 + (s2[4] - '0');\n\n\tif(a == c) {\n\t\treturn b - d;\n\t} else {\n\t\treturn (a - (c + 1)) * 60 + (60 - d) + b;\n\t}\n}\n\nint main() {\n\tint n;\n\twhile(cin >> n && n) {\n\n\t\tmap<string, vector<pair<string, string> > > IN, OUT;\n\n\t\trep(i, n) {\n\t\t\tstring a, b, c, d;\n\t\t\tcin >> a >> b >> c >> d;\n\n\t\t\tif(c == \"I\") {\n\t\t\t\tIN[d].push_back(mp(a, b));\n\t\t\t} else {\n\t\t\t\tOUT[d].push_back(mp(a, b));\n\t\t\t}\n\t\t}\n\n\t\tint ans = 0;\n\t\tvector<pair<string, string> > gin = IN[\"000\"];\n\t\tvector<pair<string, string> > gout = OUT[\"000\"];\n\n\n\t\tmap<string, vector<pair<string, string> > >::iterator in, out;\n\t\tfor(in = IN.begin(), out = OUT.begin(); in != IN.end() && out != OUT.end(); in++, out++) {\n\t\t\tif(in->first == \"000\") continue;\n\n\t\t\tvector<pair<string, string > > v = in->second;\n\t\t\tvector<pair<string, string > > v2 = out->second;\n\n\t\t\tint res = 0;\n\t\t\trep(i, v.size()) {\n\t\t\t\trep(j, gin.size()) {\n\t\t\t\t\tif(v[i].first != gin[j].first) continue;\n\t\t\t\n\t\t\t\t\tstring a = v[i].second, b = v2[i].second, c = gin[j].second, d = gout[j].second;\n\t\t\t\t\tif(c <= a && b <= d) {\n\t\t\t\t\t\tres += f(b, a);\n\t\t\t\t\t} else if(a <= c && d <= b) {\n\t\t\t\t\t\tres += f(d, c);\n\t\t\t\t\t} else if(c <= a && a <= d && d <= b) {\n\t\t\t\t\t\tres += f(d, a);\n\t\t\t\t\t} else if(a <= c && c <= b && b <= d) {\n\t\t\t\t\t\tres += f(b, c);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tans = max(ans, res);\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<map>\n#include<vector>\nusing namespace std;\n\nconst int maxn = 6e5;\nvector<int> g[maxn];\nint etr[1100], res[1100];\nvector<int> god;\nint d[13] = {0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};\n\nint trans(int M, int D, int h, int m){\n    int ans = 0;\n    for(int i = 1; i < M; i++)\n        ans += d[i] * 24 * 60;\n    ans += (D - 1) * 24 * 60 + h * 60 + m;\n    return ans;\n}\nint main(){\n    int n;\n    int M, D, h, m, p;\n    char op[5];\n    while(~scanf(\"%d\", &n), n){\n        for(int i = 0; i < 1000; i++) g[i].clear();\n        god.clear();\n        memset(res, 0, sizeof(res));\n        while(n--){\n            scanf(\"%d/%d %d:%d %s %d\", &M, &D, &h, &m, op, &p);\n            if(op[0] == 'O'){\n                int l = trans(M, D, h, m);\n                if(p){\n                    for(int i = etr[p]; i < l; i++)\n                        g[i].push_back(p);\n                }else{\n                    for(int i = etr[p]; i < l; i++)\n                        god.push_back(i);\n                }\n            }else{\n                etr[p] = trans(M, D, h, m);\n            }\n        }\n\n        int sz = god.size();\n        for(int i = 0; i < sz; i++){\n            int t = god[i];\n            int l = g[t].size();\n            for(int j = 0; j < l; j++)\n                res[g[t][j]]++;\n        }\n        int _max = 0;\n        for(int i = 1; i < 1000; i++)\n            if(_max < res[i]) _max = res[i];\n\n        printf(\"%d\\n\", _max);\n\n    }\n}\n\n/*\n14\n04/21 09:00 I 000\n04/21 09:00 I 001\n04/21 09:15 I 002\n04/21 09:30 O 001\n04/21 09:45 O 000\n04/21 10:00 O 002\n04/28 09:00 I 003\n04/28 09:15 I 000\n04/28 09:30 I 004\n04/28 09:45 O 004\n04/28 10:00 O 000\n04/28 10:15 O 003\n04/29 20:00 I 002\n04/29 21:30 O 002\n20\n06/01 09:00 I 001\n06/01 09:15 I 002\n06/01 09:15 I 003\n06/01 09:30 O 002\n06/01 10:00 I 000\n06/01 10:15 O 001\n06/01 10:30 I 002\n06/01 10:45 O 002\n06/01 11:00 I 001\n06/01 11:15 O 000\n06/01 11:30 I 002\n06/01 11:45 O 001\n06/01 12:00 O 002\n06/01 12:15 I 000\n06/01 12:30 I 002\n06/01 12:45 O 000\n06/01 13:00 I 000\n06/01 13:15 O 000\n06/01 13:30 O 002\n06/01 13:45 O 003\n0\n*/"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n\n\nint trie[17200][26];\nint w[17200];\nchar s[1000];\nint cnt;\nvoid add()\n{\n    int rt=0;\n    for(int i=0;s[i];i++)\n    {\n        if(trie[rt][s[i]-'A']==0)\n        {\n            cnt++;\n            memset(trie[cnt],0,sizeof(trie[cnt]));\n            trie[rt][s[i]-'A']=cnt;\n        }\n        rt=trie[rt][s[i]-'A'];\n        w[rt]++;\n    }\n}\nchar maz[11][21];\nint ans,p,l;\nvoid dfs(int s,int dep)\n{\n    if(w[s]>=2)\n    {\n        if(ans<dep)\n        {\n            ans=dep;\n            p=s;\n        }\n    }\n    for(int i=0;i<26;i++)\n        if(trie[s][i])\n        {\n            dfs(trie[s][i],dep+1);\n        }\n}\nbool pri(int ss)\n{\n    if(ss==p)return 1;\n    for(int i=0;i<26;i++)\n        if(trie[ss][i])\n        {\n            if(pri(trie[ss][i]))\n            {\n                s[l++]=i+'A';\n                return 1;\n            }\n        }\n    return 0;\n}\nint dx[]={0,0,1,-1,1,-1,1,-1};\nint dy[]={1,-1,0,0,1,-1,-1,1};\nint main()\n{\n    freopen(\"1.txt\",\"r\",stdin);\n    int n,m;\n    while(~scanf(\"%d%d\",&n,&m))\n    {\n        if(n+m==0)break;\n        memset(w,0,sizeof(w));cnt=0;\n        //memset(trie,0,sizeof(trie));\n        for(int i=0;i<n;i++)\n            scanf(\"%s\",maz[i]);\n        for(int i=0;i<n;i++)\n            for(int j=0;j<m;j++)\n            {\n                for(int k=0;k<8;k++)\n                {\n                    int x=i,y=j,f=0;\n                    do\n                    {\n                        s[f++]=maz[x][y];\n                        x+=dx[k];\n                        y+=dy[k];\n                        if(x<0)x=n-1;\n                        if(y<0)y=m-1;\n                        if(x>=n)x=0;\n                        if(y>=m)y=0;\n                    }while(x!=i||y!=j);\n                    s[f]=0;\n                    add();\n                }\n            }\n        ans=0;l=0;\n        dfs(0,0);\n        if(ans<2)puts(\"0\");\n        else\n        {\n            pri(0);\n            s[l]=0;\n            for(int i=0;i<l/2;i++)\n                swap(s[i],s[l-i-1]);\n            printf(\"%s\\n\",s);\n        }\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef long double ld;\nconst ld eps=1e-8;\nint daytable[1440];\nvoid init() {\n\trep(i, 1440) {\n\t\tdaytable[i] = 0;\n\t}\n}\nstruct day { int time; char io; int num; };\nint trans(string x) {\n\tstring s1 = x.substr(0, 2);\n\tstring s2 = x.substr(3, 2);\n\tint res; res = stoi(s1) * 60 + stoi(s2);\n\treturn res;\n}\nbool comp(day x, day y) {\n\tif (x.num != y.num) {\n\t\treturn x.num < y.num;\n\t}\n\treturn x.time < y.time;\n}\nint main() {\n\tint n;\n\twhile (cin >> n, n) {\n\t\tstring s, t, u; char v;\n\t\tvector<day> a[365]; int cnt = 0; string memo;\n\t\tcin >> s >> t >> v >> u;\n\t\tmemo = s;\n\t\ta[0].push_back({ trans(t),v,stoi(u) });\n\t\trep(i, n-1) {\n\t\t\tcin >> s >> t >> v >> u;\n\t\t\tif (s != memo) {\n\t\t\t\tcnt++; memo = s;\n\t\t\t}\n\t\t\ta[cnt].push_back({ trans(t),v,stoi(u) });\n\t\t}\n\t\tint out[1000] = {};\n\t\trep(i, cnt + 1) {\n\t\t\tinit();\n\t\t\tsort(a[i].begin(), a[i].end(), comp);\n\t\t\tint len = a[i].size();\n\t\t\tfor (int j = 0; j < len; j += 2) {\n\t\t\t\tif (a[i][j].num == 0) {\n\t\t\t\t\tRep(k, a[i][j].time, a[i][j + 1].time) {\n\t\t\t\t\t\tdaytable[k] = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tRep(k, a[i][j].time, a[i][j + 1].time) {\n\t\t\t\t\t\tif (daytable[k]) {\n\t\t\t\t\t\t\tout[a[i][j].num]++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ma = 0;\n\t\trep(i, 1000) {\n\t\t\tma = max(ma, out[i]);\n\t\t}\n\t\tcout << ma << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n\nusing namespace std;\n\ntypedef long long ll;\nconst int MAX = 1000;\nstruct data{int month,day,hour,min;};\n\nint mon[] = {0,31,28,31,30,31,30,31,31,30,31,30,31};\nll N,T[MAX];\ndata D[MAX];\nbool isInside[MAX];\n\nvoid init(){\n  fill(T,T+MAX,0);\n  fill(isInside,isInside+MAX,false);\n}\n\nll getTime(data d){\n  ll tmp = 0;\n  tmp += d.hour*60;\n  tmp += d.min;\n  return tmp;\n}\n\nvoid solve(){\n\n  bool isIN = false;\n\n  for(int i = 0; i < N; i++){\n    data d;\n    char c;\n    int id;\n\n    scanf(\"%d/%d %d:%d %c %d\",&d.month,&d.day,&d.hour,&d.min,&c,&id);\n\n     if(id == 0){\n       isIN = (c == 'I');\n       \n       if(c == 'O'){\n\t for(int j = 1; j < MAX; j++)\n\t   if(isInside[j]) T[j] += getTime(d)-max(getTime(D[j]),getTime(D[0]));\n       }else D[0] = d;\n       continue;\n     }\n     \n    if(c == 'I'){\n      D[id] = d;\n      isInside[id] = true;\n    }else{\n      if(isIN && isInside[id]) T[id] += getTime(d)-getTime(D[id]);\n      isInside[id] = false;\n    }\n   }\n\n  ll ans = 0;\n  for(int i = 1; i < MAX; i++)\n    ans = max(ans,T[i]);\n  cout << ans << endl;\n}\n\nint main(){\n  while(cin >> N && N){\n    init();\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <cstdio>\n\nusing namespace std;\n\nclass prog{\npublic:\n  int i, o;\n  string str;\n};\n\nvector<prog> p[1000];\nint size[1000];\n\nmain(){\n  int n;\n  while(cin >> n && n){\n    for(int i=0;i<1000;i++){\n      p[i].clear();\n    }\n    fill(size, size+1000, 0);\n    for(int i=0;i<n;i++){\n      prog in;\n      string input;\n      cin >> in.str;\n      cin >> input;\n      int a, b;\n      string tmp = \"\";\n      tmp += input[0];\n      tmp += input[1];\n      a = atoi(tmp.c_str());\n      tmp = \"\";\n      tmp += input[3];\n      tmp += input[4];\n      b = atoi(tmp.c_str());\n      char c;\n      cin >> c;\n      if(c == 'I'){\n\tin.i = a*60 + b;\n\tin.o = -1;\n      }else{\n\tin.o = a*60 + b;\n      }\n      cin >> input;\n      int id = atoi(input.c_str());\n      if(c == 'I'){\n\tp[id].push_back(in);\n      }else{\n\tp[id][(int)p[id].size()-1].o = in.o;\n      }\n    }\n    /*for(int i=0;i<5;i++){\n      cout << \"00\" << i << endl;\n      for(int j=0;j<p[i].size();j++){\n\tcout << p[i][j].str << ' ' << p[i][j].i << ' ' << p[i][j].o << endl;\n      }\n      cout << endl;\n      }*/\n    int ans = 0;\n    for(int i=0;i<1000;i++){\n      if(p[i].size() == 0) continue;\n      for(int k=0;k<1000;k++){\n\tif(p[k].size() == 0) continue;\n\tif(i == k) continue;\n\tint sum = 0;\n\tfor(int l=0;l<p[k].size();l++){\n\t  if(p[k][l].o == -1) continue;\n\t  for(int j=0;j<p[i].size();j++){\n\t    if(p[i][j].o == -1) continue;\n\t    if(p[i][j].str != p[k][l].str) continue;\n\t    int ai = p[i][j].i;\n\t    int ao = p[i][j].o;\n\t    int bi = p[k][l].i;\n\t    int bo = p[k][l].o;\n\t    if(ai == bi && bo == ao) sum += bo - bi;\n\t    else if(ai == bi) sum += min(ao, bo) - ai;\n\t    else if(ao == bo) sum += max(ai, bi) - ao;\n\t    else if(ai == bo) sum += 0;\n\t    else if(ao == bi) sum += 0;\n\t    else if(ai < bi && bo < ao) sum += bo - bi;\n\t    else if(bi < ai && ao < bo) sum += ao - ai;\n\t    else if(ai < bi && bi < ao) sum += ao - bi;\n\t    else if(ai < bo && bo < ao) sum += bo - ai;\n\t  }\n\t}\n\tans = max(ans, sum);\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<map>\n#include<vector>\nusing namespace std;\n\nint month[12] = {31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};\n\nint mdtod(int m, int d){\n    int accum = 0;\n    for(int i = 0; i < m-1; i++)    accum += month[i];\n    accum += d;\n    return accum;\n}\n\nint main(){\n    int n;\n    while(scanf(\"%d\\n\", &n), n){\n        map<int, vector<int>> record;\n\n        int M, D, h, m, p;\n        char e;\n\n        for(int i = 0; i < n; i++){\n            scanf(\"%d/%d %d:%d %c %d\\n\", &M, &D, &h, &m, &e, &p);\n            record[p].push_back(mdtod(M, D)*1440 + 60*h + m);\n        }\n\n        int ans = 0;\n        for(auto x : record){\n            if(x.first == 0)    continue;\n            int tmp = 0;\n            for(int i = 0; i < x.second.size(); i+=2){\n                for(int j = 0; j < record[0].size(); j+=2){\n                    tmp += max(0, min(x.second[i+1],record[0][j+1])-max(x.second[i],record[0][j]));\n                }\n            }\n            ans = max(ans, tmp);\n        }\n\n        cout << ans << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstruct prog{\n  int month, day, h, m;\n  bool in;\n};\n\nint calc(prog state, prog tmp){\n  int res = (tmp.h*60 + tmp.m) - (state.h*60 + state.m) ;\n  return res >= 0 ? res : 0;\n}\n  \nint main(){\n  int n;\n  while(cin >> n, n){\n    vector<prog> state(n);\n    for(int i = 0; i < n; i++){\n      state[i].in = false;\n    }\n    prog tmp, prev;\n    int  id;\n    vector<int> sum(n, 0);\n    for(int i = 0; i < n; i++){\n      char in;\n      scanf(\"%d/%d %d:%d %c %d\\n\", &tmp.month, &tmp.day, &tmp.h, &tmp.m, &in, &id);\n      if(in == 'I')tmp.in = true;\n      else tmp.in = false;\n      if(state[id].in == true && tmp.in == false){\n\tif(id == 0){\n\t  for(int i = 1; i < n; i++){\n\t    if(state[i].in)sum[i] += min(calc(state[0], tmp), calc(state[i], tmp));\n\t  }\n\t}\n      }else if(state[0].in){\n\tsum[id] += min(calc(state[0], tmp), calc(state[id], tmp));\n      }\n      if(id == 0)prev = state[0];\n      state[id] = tmp; \n    }\n    int ans = 0;\n    for(int i = 0; i < n; i++){\n      ans = max(ans, sum[i]);\n    }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef pair<int,int> pii;\n\nint main(){\n  int N;\n  while(cin >> N, N > 0){\n    int M[N],D[N],h[N],m[N],e[N],p[N],nm,nd;\n    char ch;\n    bool tim[3000] = {false};\n    map<int,int> point;\n    for(int i = 0 ; i < N ; i++){\n      scanf(\"%d/%d %d:%d %c %d\",\n\t    &M[i],&D[i],&h[i],&m[i],&ch,&p[i]);\n      if(i == 0) nm = M[i], nd = D[i];\n      if(nm != M[i] || nd != D[i]){\n\tmemset(tim,false,sizeof(tim));\n\tnm = M[i]; nd = D[i];\n      }\n      e[i] = (ch == 'I' ? 1 : 0);\n      if(p[i] == 0 && e[i] == 0){\n\tint j;\n\tfor(j = i-1 ; j >= 0 ; j--){\n\t  if(p[j] == 0) break;  \n\t}\n\tfor(int k = h[j]*60+m[j] ; k < h[i]*60+m[i] ; k++){\n\t  tim[k] = true;\n\t}\n      }\n      if(p[i] != 0 && e[i] == 0){\n\tint j;\n\tfor(j = i-1 ; j >= 0 ; j--){\n\t  if(p[i] == p[j]) break;  \n\t}\n\tfor(int k = h[j]*60+m[j] ; k < h[i]*60+m[i] ; k++){\n\t  point[p[i]] += tim[k];\n\t}\n      }\n    }\n    \n    int ans = 0;\n    map<int,int>::iterator it;\n    for(it = point.begin() ; it != point.end() ; ++it){\n      ans = max(ans,it->second);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n\nint get(string s){\n\ts[2] = ' ';\n\tstringstream ss(s);\n\tint h,m;\n\tss >> h >> m;\n\treturn h * 60 + m;\n}\n\nint main(){\n\tint n;\n\twhile(cin >> n && n){\n\t\tmap<string,int> in;\n\t\tmap<string,int> tot;\n\t\tfor(int i = 0 ; i < n ; i++){\n\t\t\tstring d,s,t,id;\n\t\t\tcin >> d >> s >> t >> id;\n\t\t\tif( t == \"I\" ){\n\t\t\t\tin[id] = get(s);\n\t\t\t}else{\n\t\t\t\tif( id == \"000\" ){\n\t\t\t\t\tfor( auto e : in ){\n\t\t\t\t\t\t//cout << get(s) - max(tot[\"000\"],tot[e.first]) << \"<\" << endl;\n\t\t\t\t\t\ttot[e.first] += get(s) - max(in[\"000\"],in[e.first]);\n\t\t\t\t\t}\n\t\t\t\t}else if( in.count(\"000\") ){\n\t\t\t\t\ttot[id] += get(s) - max(in[\"000\"],in[id]);\n\t\t\t\t}\n\t\t\t\tin.erase(id);\n\t\t\t}\n\t\t}\n\t\tint ans = 0;\n\t\tfor( auto e : tot ){\n\t\t\tif( e.first != \"000\" ){\n\t\t\t\tans = max(ans,e.second);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <queue>\n#include <map>\n#include <set>\n#include <algorithm>\n\n#define FOR(i,k,n) for (int i=(k); i<(int)(n); ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define sz size()\n#define pb push_back\n#define mp make_pair\n#define ALL(X) (X).begin(),(X).end()\n\nusing namespace std;\n\nconst int INF = 1000000000;\nconst double eps = 1e-8;\n\nint dayid(string str) {\n  int m = atoi(str.substr(0,2).c_str());\n  int d = atoi(str.substr(3,2).c_str());\n  return m * 40 + d;\n}\n\nint main(void) {\n  while(1) {\n    int n;\n    cin>>n;\n    if(!n)break;\n    vector<int> times(1);\n    map<int,int> pger;\n    int gdsin = -1;\n    REP(i,n){\n      string day,time,io;\n      int id;\n      cin>>day>>time>>io>>id;\n      int timet = atoi(time.substr(0,2).c_str()) * 60 + atoi(time.substr(3,2).c_str());\n      if(id == 0) {\n        if(io == \"I\") {\n          gdsin = timet;\n        }else{\n          for(map<int,int>::iterator p = pger.begin(); p != pger.end(); ++p) {\n            int in = max(p->second,gdsin);\n            times[p->first] += timet - in;\n          }\n          gdsin = -1;\n        }\n      }else{\n        if(io == \"I\") {\n          if(id >= times.size()) {\n            times.resize(id+1);\n            //times[id] = 0;\n          }\n          pger.insert(make_pair(id,timet));\n        }else{\n          map<int,int>::iterator itr = pger.find(id);\n          if(gdsin >= 0) {\n            int in = max(itr->second,gdsin);\n            times[id] += timet - in;\n          }\n          pger.erase(itr);\n        }\n      }\n    }\n    int m = 0;\n    REP(i,times.size()) {\n      m = max(m,times[i]);\n    }\n    cout << m <<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <set>\n#include <map>\n#include <queue>\n#include <cmath>\n#include <algorithm>\nusing namespace std;\n\n#define REP(i, n) for(int i=0; i<(int)n; ++i)\n#define FOR(i,c) for(__typeof((c).begin())i = (c).begin(); i != (c).end(); ++i)\n#define ALL(c) (c).begin() , (c).end()\n\nint month[] = {31,28,31,30,31,30,31,31,30,31,30,31};\nint func(int m, int d, int h, int min)   {\n  int res = 0;\n  REP(i, m-1) {\n    res += month[i];\n  }\n  res += d;\n  res *= 60*24;\n  res += h*60;\n  res += min;\n  return res;\n}\n\nint main() {\n  int n;\n  while(cin>>n, n) {\n    bool table[31*12*24*60];\n    int m[n], d[n], h[n], min[n], p[n];\n    char c[n];\n\n    int start[1000];\n    int point[1000];\n    memset(table,0,sizeof(table));\n    memset(point,0,sizeof(point));\n\n    int godstart;\n    REP(i, n) {\n      scanf(\"%d/%d %d:%d %c %d\",  m+i, d+i, h+i, min+i, c+i, p+i);\n      //cout << m[i] << \" \" << d[i] << \" \" << p[i] << endl;\n      if (p[i] == 0) {\n        if (c[i] == 'I') {\n          godstart = func(m[i], d[i], h[i], min[i]);\n        } else {\n          for (int j=godstart; j<func(m[i], d[i], h[i], min[i]); ++j) {\n            table[j] = 1;\n          }\n        }\n      }\n    }\n    REP(i, n) {\n      if (p[i] == 0) continue;\n      if (c[i] == 'I') {\n        start[p[i]] = func(m[i], d[i], h[i], min[i]);\n      } else {\n        for (int j=start[p[i]]; j<func(m[i], d[i], h[i], min[i]); ++j) {\n          if (table[j]) {\n            //printf(\"%d:%d\\n\", i, j);\n            point[p[i]]++;\n          }\n        }\n      }\n    }\n    cout << *max_element(point, point+1000) << endl;;\n    \n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long int\nint main(){\n  int n,a,ans,user;\n  int u[10000],ut[10000];\n  string day,time,on;\n  string nowd,nowt;\n  while(1){\n    cin>>n;\n    ans=0;\n    if(n==0) break;\n    for(int i=0;i<1000;i++){\n      u[i]=ut[i]=0;\n    }\n    for(int i=0;i<n;i++){\n      cin>>day>>time>>on>>user;\n      if(i==0){\n\tnowd=day;\n\tnowt=time;\n      }\n      if(nowd!=day){\n\tnowd=day;\n\tnowt=time;\n      }\n      if(nowt!=time){\n\ta=(((time[0]-'0')-(nowt[0]-'0'))*10+((time[1]-'0')-(nowt[1]-'0')))*60+(((time[3]-'0')-(nowt[3]-'0'))*10+((time[4]-'0')-(nowt[4]-'0')));\n\t//\tcout<<a<<endl;\n\tnowt=time;\n\tif(u[0]==1){\n\t  for(int j=1;j<1000;j++){\n\t    if(u[j]==1){\n\t      ut[j]+=a;\n\t      ans=max(ans,ut[j]);\n\t    }\n\t  }\n\t}\n      }\n      if(on==\"O\") u[user]=0;\n      if(on==\"I\") u[user]=1;\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstruct prog{\n  int month, day, h, m;\n  bool in;\n};\n\nint calc(prog state, prog tmp){\n  int res = (tmp.h*60 + tmp.m) - (state.h*60 + state.m);\n  return res >= 0 ? res : 0;\n}\n  \nint main(){\n  int n;\n  while(cin >> n, n){\n    vector<prog> state(n);\n    for(int i = 0; i < n; i++){\n      state[i].in = false;\n    }\n    prog tmp;\n    int  id;\n    vector<int> sum(n, 0);\n    for(int i = 0; i < n; i++){\n      char in;\n      scanf(\"%d/%d %d:%d %c %d\\n\", &tmp.month, &tmp.day, &tmp.h, &tmp.m, &in, &id);\n      if(in == 'I')tmp.in = true;\n      else tmp.in = false;\n      if(state[id].in == true && tmp.in == false){\n\tif(id == 0){\n\t  for(int i = 1; i < n; i++){\n\t    if(state[i].in)sum[i] += min(calc(state[0], tmp), calc(state[i], tmp));\n\t  }\n\t}else if(state[0].in){\n\t  sum[id] += min(calc(state[0], tmp), calc(state[id], tmp));\n\t}\n      }\n      state[id] = tmp;\n    }\n    int ans = 0;\n    for(int i = 0; i < n; i++){\n      ans = max(ans, sum[i]);\n    }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<n;i++)\n#define Rep(i,n) for(int i=1;i<n;i++)\nusing namespace std;\n\nint u[1001][1001],n,h,m,I,a,t[1001],c[1001],S=1000;\nchar g;\n\nint main(){\n\twhile(cin>>n,n){\n\t\ta=0;\n\t\tmemset(u,0,sizeof(u));memset(c,0,sizeof(c));\n\t\trep(i,n){\n\t\t\tcin>>h>>g>>h>>h>>g>>m>>g>>I;\n\t\t\tm+=h*60;\n\t\t\tt[i]=m;\n\t\t\tu[I][i]+=g=='I'?1:-1;\n\t\t}\n\t\trep(i,S)Rep(j,S)u[i][j]+=u[i][j-1];\n\t\tRep(i,S)rep(j,S)if(u[i][j]&&u[0][j])c[i]+=t[j+1]-t[j];\n\t\tRep(i,S)a=max(a,c[i]);\n\t\tcout<<a<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#pragma warning(disable:4996)\n\n#define MAX_N 10000\n#define MAX_M 600\n\nint Q;\nint M[MAX_N], D[MAX_N], h[MAX_N], m[MAX_N], n[MAX_N], t;\nint K[MAX_N], L[MAX_N];\nchar c;\n\nint main() {\n\twhile (true) {\n\t\tfor (int i = 0; i < MAX_N; i++) {\n\t\t\tM[i] = 0; D[i] = 0; h[i] = 0; m[i] = 0; n[i] = 0; K[i] = 0; L[i] = -1;\n\t\t}\n\n\t\tbool megami = false; \n\t\tint zenkai = 0; \n\t\tcin >> Q; \n\t\tif (Q == 0) { break; }\n\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tscanf(\"%02d/%02d %02d:%02d %c %03d\", &M[i], &D[i], &h[i], &m[i], &c, &n[i]);\n\t\t\tt = h[i] * 60 + m[i];\n\t\t\tif (c == 'I') {\n\t\t\t\tL[n[i]] = t;\n\t\t\t}\n\t\t\tif (c == 'O') {\n\t\t\t\tif (n[i] >= 1) {\n\t\t\t\t\tif (L[0] >= 0) {\n\t\t\t\t\t\tK[n[i]] += t - max(L[0], L[n[i]]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfor (int j = 1; j < MAX_M; j++) {\n\t\t\t\t\t\tif (L[j] >= 0) {\n\t\t\t\t\t\t\tK[j] += t - L[j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tL[n[i]] = -1;\n\t\t\t}\n\t\t}\n\t\tint maxn = 0;\n\t\tfor (int i = 1; i < MAX_M; i++) {\n\t\t\tmaxn = max(maxn, K[i]);\n\t\t}\n\t\tcout << maxn << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef vector<int> vec;\n\nint main() {\n    int N;\n    while(cin >> N, N) {\n        vector<string> md(N), person(N);\n        vec in(N, -1), out(N, -1);\n        map<string,int> res;\n        for(int i = 0; i < N; i++) {\n            int h, m;\n            char e, tmp;\n            string q, MD;\n            cin >> MD >> h >> tmp >> m >> e >> q;\n            if(e == 'I')\n                md[i] = MD, person[i] = q, in[i] = 60 * h + m;\n            else\n                md[i] = MD, person[i] = q, out[i] = 60 * h + m;\n            res[q] = 0;\n        }\n\n        for(int i = 0; i < N; i++) {\n            if(person[i] == \"000\" && in[i] >= 0) {\n                int out0 = i + 1;\n                while(person[out0] != \"000\") out0++;\n                for(int j = 0; j < N; j++) {\n                    if(person[j] != \"000\" && md[i] == md[j] && in[j] >= 0) {\n                        int outX = j + 1;\n                        while(person[outX] != person[j]) outX++;\n                        if(!(out[outX] < in[i] || out[out0] < in[j])) {\n                            res[person[j]] += min(out[out0], out[outX]) - max(in[j], in[i]);\n                        }\n                    }\n                }\n            }\n        }\n        int MAX = 0;\n        for(auto i : res)\n            MAX = max(MAX, i.second);\n\n        cout << MAX << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nstruct UnionFind {\n\tvector<int> v;\n\tUnionFind(int n) : v(n)  { for (int i = 0; i < n; i++) v[i] = i; }\n\tint  find(int x)         { return v[x] == x ? x : v[x] = find(v[x]); }\n\tvoid unite(int x, int y) { v[find(x)] = find(y); }\n};\nstruct note{\n\tstring date;\n\tint time;\n\tchar e;\n\tint id;\n};\nint main() {\n\tint n;\n\twhile (cin>>n,n) {\n\t\tvector<note> notes;\n\t\tvi bless(1000, 0);\n\t\tvi blessed(1000, -1);\n\t\tREP(i, n) {\n\t\t\tstring s1, s2;\n\t\t\tchar e;\n\t\t\tint id;\n\t\t\tcin >> s1 >> s2 >> e >> id;\n\t\t\tint time=atoi(s2.substr(0, 2).c_str()) * 60 + atoi(s2.substr(3, 2).c_str());\n\t\t\tif (id == 0) {\n\t\t\t\tif (e == 'I') {\n\t\t\t\t\tFOR(j,1, 1000)\n\t\t\t\t\t\tif (blessed[j] != -1)\n\t\t\t\t\t\t\tblessed[j] = time;\n\t\t\t\t\tblessed[0] = time;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tFOR(j,1, 1000)\n\t\t\t\t\t\tif (blessed[j] != -1)\n\t\t\t\t\t\t\tbless[j] += time- blessed[j];\n\t\t\t\t\tblessed[0] = -1;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (e == 'I') {\n\t\t\t\t\tblessed[id] = time;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif(blessed[0]!=-1)\n\t\t\t\t\t\tbless[id] += time - blessed[id];\n\t\t\t\t\tblessed[id] = -1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans = 0;\n\t\tFOR(i,1, bless.size())\n\t\t\tans = max(ans, bless[i]);\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<vector>\n\nusing namespace std;\n\ntypedef long long ll;\nconst int MAX = 1000;\nstruct data{int month,day,hour,min;};\n\nint mon[] = {0,31,28,31,30,31,30,31,31,30,31,30,31};\nint N,T[MAX];\ndata D[MAX];\nbool isInside[MAX];\n\nvoid init(){\n  fill(T,T+MAX,0);\n  fill(isInside,isInside+MAX,false);\n}\n\nint getTime(data d){\n  int tmp = 0;\n\n  for(int i = 1; i < d.month; i++)\n    tmp += mon[i]*24*60;\n  \n  tmp += d.day*24*60;\n  tmp += d.hour*60;\n  tmp += d.min;\n  return tmp;\n}\n\nvoid solve(){\n\n  bool isIN = false;\n\n  for(int i = 0; i < N; i++){\n    data d;\n    char c;\n    int id;\n\n    scanf(\"%d/%d %d:%d %c %d\",&d.month,&d.day,&d.hour,&d.min,&c,&id);\n\n     if(id == 0){\n       isIN = (c == 'I');\n       \n       if(c == 'O'){\n\t for(int j = 1; j < MAX; j++)\n\t   if(isInside[j]) T[j] += getTime(d)-max(getTime(D[j]),getTime(D[0]));\n       }else D[0] = d;\n       continue;\n     }\n     \n    if(c == 'I'){\n      D[id] = d;\n      isInside[id] = true;\n    }else{\n      if(isIN && isInside[id]) T[id] += getTime(d)-getTime(D[id]);\n      isInside[id] = false;\n    }\n   }\n\n  int ans = 0;\n  for(int i = 1; i < MAX; i++)\n    ans = max(ans,T[i]);\n  cout << ans << endl;\n}\n\nint main(){\n  while(cin >> N && N){\n    init();\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long int\nint main(){\n  int n,a,ans,user;\n  int u[10000],ut[10000];\n  string day,time,on;\n  string nowd,nowt;\n  while(1){\n    cin>>n;\n    ans=0;\n    if(n==0) break;\n    for(int i=0;i<1000;i++){\n      u[i]=ut[i]=0;\n    }\n    for(int i=0;i<n;i++){\n      cin>>day>>time>>on>>user;\n      if(i==0){\n\tnowd=day;\n\tnowt=time;\n      }\n      if(nowd!=day){\n\tnowd=day;\n\tnowt=time;\n      }\n      if(nowt!=time){\n\ta=(((time[0]-'0')-(nowt[0]-'0'))*10+((time[1]-'0')-(nowt[1]-'0')))*60+(((time[3]-'0')-(nowt[3]-'0'))*10+((time[4]-'0')-(nowt[4]-'0')));\n\t//\tcout<<a<<endl;\n\tnowt=time;\n\tif(u[0]==1){\n\t  for(int j=1;j<1000;j++){\n\t    if(u[j]==1){\n\t      ut[j]+=a;\n\t      ans=max(ans,ut[j]);\n\t    }\n\t  }\n\t}\n      }\n      if(on==\"O\") u[user]=0;\n      if(on==\"I\") u[user]=1;\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <map>\nusing namespace std;\n#define MAXN 1010\n#define INF 1000000007\nmap<int,int> ma;\nint pre[MAXN],sum[MAXN];\nint mon[13]={0,31,28,31,30,31,30,31,31,30,31,30,31};\nint gettime()\n{\n    int m,d,h,t;\n    scanf(\"%d/%d %d:%d\",&m,&d,&h,&t);\n    return ((mon[m-1]+d)*24+h)*60+t;\n}\nint main()\n{\n    //freopen(\"/home/moor/Code/input\",\"r\",stdin);\n    int n,now,ans;\n    while(scanf(\"%d\",&n)&&n)\n    {\n        now=1;\n        ma.clear();\n        ma[0]=0;\n        memset(pre,0x3f,sizeof(pre));\n        memset(sum,0,sizeof(sum));\n        for(int i=0;i<n;++i)\n        {\n            char s[2];\n            int t,p;\n            t=gettime(),scanf(\"%s%d\",s,&p);\n            if(ma.find(p)==ma.end())    ma[p]=now++;\n            p=ma[p];\n            if(s[0]=='I')   pre[p]=t;\n            else\n            {\n                if(p==0)\n                    for(int j=1;j<now;++j)  sum[j]+=max(0,t-max(pre[0],pre[j]));\n                else    sum[p]+=max(0,t-max(pre[0],pre[p]));\n                pre[p]=INF;\n            }\n        }\n        ans=0;\n        for(int i=1;i<now;++i)  ans=max(ans,sum[i]);\n        printf(\"%d\\n\",ans);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nint n,t[1005],ent[1005],ans;\nbool isin[1500];\nchar md[10],hm[10],io[10],id[10];\nchar mdd[10];\nint gettime()\n{\n    int hh=(hm[0]-'0')*10+(hm[1]-'0');\n    int mi=(hm[3]-'0')*10+(hm[4]-'0');\n    return hh*60+mi;\n}\nint main()\n{\n    ///freopen(\"in.txt\",\"r\",stdin);\n    while(scanf(\"%d\",&n)&&n!=0)\n    {\n        memset(t,0,sizeof t);\n        mdd[0]='s';\n        ans=0;\n        while(n--)\n        {\n            scanf(\"%s%s%s%s\",md,hm,io,id);\n            if(strcmp(md,mdd)!=0)\n            {\n                memset(isin,false,sizeof isin);\n                memcpy(mdd,md,sizeof md);\n            }\n            int ID=(id[0]-'0')*100+(id[1]-'0')*10+(id[2]-'0');\n            if(io[0]=='I')\n            ent[ID]=gettime();\n            else\n            {\n                int endtime=gettime();\n                if(ID==0)\n                {\n                    for(int i=ent[ID];i<endtime;i++)\n                    isin[i]=true;\n                }\n                else\n                {\n                    for(int i=ent[ID];i<endtime;i++)\n                    {\n                        if(isin[i])\n                        t[ID]++;\n                    }\n                }\n                ans=max(t[ID],ans);\n            }\n        }\n        printf(\"%d\\n\",ans);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<queue>\n#include<complex>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cassert>\n\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define mp make_pair\n#define pb push_back\n#define each(i,c) for(__typeof((c).begin()) i=(c).begin();i!=(c).end();i++)\n#define dbg(x) cerr<<__LINE__<<\": \"<<#x<<\" = \"<<(x)<<endl\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef pair<int,int> pi;\nconst int inf = (int)1e9;\nconst double INF = 1e12, EPS = 1e-9;\n\nint main(){\n\tint n;\n\twhile(scanf(\"%d\", &n), n){\n\t\tmap<int, vector<pi> > v;\n\t\tmap<int, int> sum;\n\t\trep(i, n){\n\t\t\tint mo, d, h, m, id;\n\t\t\tchar c;\n\t\t\tscanf(\"%d/%d %d:%d %c %d\", &mo, &d, &h, &m, &c, &id);\n\t\t\tint t = mo * 31 * 24 * 60 + d * 24 * 60 + h * 60 + m;\n\t\t\tv[id].pb(mp(t, c == 'I' ? -1 : 1));\n\t\t}\n\t\tint mx = 0;\n\t\teach(i, v){\n\t\t\tif(i->first == 0) continue;\n\t\t\t\n\t\t\tvector<pi> vv = i->second;\n\t\t\teach(j, v[0]) vv.pb(mp(j->first, j->second));\n\t\t\t\n\t\t\tsort(all(vv));\n\t\t\tint sum = 0, s = 0, prev = -1;\n\t\t\teach(j, vv){\n\t\t\t\tif(s < -1) sum += j->first - prev;\n\t\t\t\tprev = j->first;\n\t\t\t\ts += j->second;\n\t\t\t}\n\t\t\tmx = max(mx, sum);\n\t\t}\n\t\tcout << mx << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <stdio.h>\n#include <iostream>\n#include <map>\n\nusing namespace std;\n\ntypedef long long int ll;\n\nll max( ll p, ll q ) {\n\tif( p > q ) return p;\n\treturn q;\n}\nll solve(ll N);\n\nint main(void) {\n\n\tll N = 1;\n\twhile(true) {\n\t\tcin >> N;\n\t\tif( N == 0 ) { break; }\n\t\tcout << solve(N) << endl;\n\t}\n\n\treturn 0;\n}\n\nll solve( ll N ) {\n\n\tll ans = 0;\n\tmap<int,ll> mp;\t//mp[ID]=??\\??£?????????\n\tmap<int,ll> sum;\n\t\tmp[0] = -1;\n\t\tsum[0] = 0;\n\n\tfor( int i = 0; i < N; i++ ) {\n\n\t\tint M, D, h, m, p;\n\t\tchar e;\n\n\t\tscanf(\"%d/%d %d:%d %c %d\", &M,&D,&h,&m,&e,&p);\n\n\t\tif( e == 'I' ) {\n\t\t\tmp[p] = m+60*h;\n\t\t\tif( mp.find(p) == mp.end() ) {\n\t\t\t\t//?????????ID\n\t\t\t\tsum[p] = 0;\n\t\t\t}\n\t\t} else {\n\t\t\t//??????\n\t\t\t//??°????????????????????§??´?????????\n\t\t\tif( p == 0 ) {\n\t\t\t\t//?\\??\\??????????\n\t\t\t\tfor(auto it = mp.begin();it!=mp.end();++it){\n\t\t\t\t\tif( (*it).first == 0 || mp[(*it).first] < 0 ) { continue; }\n\t\t\t\t\tsum[(*it).first] += m+60*h - max( mp[p], mp[(*it).first] );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t//????????°???????????????\n\t\t\t\tif( mp[0] >= 0 ) {\n\t\t\t\t\tsum[p] += m+60*h - max( mp[p], mp[0] );\n\t\t\t\t}\n\t\t\t}\n\t\t\tmp[p] = -1;\n\t\t}\n\n\t}\n\n\tsum[0] = 0;\n\tfor( auto it = sum.begin(); it != sum.end(); ++it ) {\n\t\tans = max( (*it).second, ans );\n\t}\n\n\treturn ans;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <sstream>\n#include <cstring>\nusing namespace std;\n\nint N;\nbool endow[1000];\nint tm[1000], tt[1000];\n\npair<int, int> separete(string s)\n{\n    stringstream ss(s);\n    int a,b;\n    char c;\n\n    ss >> a >> c >> b;\n\n    return make_pair(a,b);\n}\n\nint transMin(string s)\n{\n    pair<int, int> ms = separete(s);\n    int m = ms.first;\n    int d = ms.second;\n\n    return m*60+d;\n}\n\nint solve()\n{\n    memset(endow, 0, sizeof(endow));\n    memset(tt, 0, sizeof(tt));\n    \n    while(N--){\n\tstring a,b,c;\n\tint mn, id;\n\n\tcin >> a >> b >> c >> id;\n\tmn = transMin(b);\n\n\tif(c == \"I\") {\n\t    endow[id] = true;\n\t    tm[id] = mn;\n\t}\n\n\tif(c == \"O\") {\n\t    endow[id] = false;\n\t    if(id != 0) {\n\t\tif(endow[0]) tt[id] += mn - max(tm[id], tm[0]);\n\t    }\n\t    else {\n\t\tfor(int i=1; i<1000; i++)\n\t\t    if(endow[i]) tt[i] += mn - max(tm[i], tm[0]);\n\t    }\n\t}\n    }\n\n    int res = 0;\n    for(int i=1; i<1000; i++)\n\tres = max(res, tt[i]);\n\n    return res;\n}\n\n    \n    \n\nint main()\n{\n    while(cin >> N, N)\n\tcout << solve() << endl;\n    \n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\nusing namespace std;\nint n;\nint f()\n{\n\tint a,b;scanf(\"%d:%d\",&a,&b);return a*60+b;\n}\nmain()\n{\n\twhile(cin>>n,n)\n\t{\n\t\tint a[1000]={};\n\t\tint t[1000]={};\n\t\tint ans=0;\n\t\tbool flag=false;\n\t\tfor(;n--;)\n\t\t{\n\t\t\tstring s;cin>>s;\n\t\t\tint X=f();\n\t\t\tstring io;int id;cin>>io>>id;\n\t\t\tif(io==\"I\")\n\t\t\t{\n\t\t\t\tif(id)t[id]=X;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfor(int j=1;j<1000;j++)if(t[j])t[j]=X;\n\t\t\t\t\tflag=true;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(id)\n\t\t\t\t{\n\t\t\t\t\tif(flag)\n\t\t\t\t\t{\n\t\t\t\t\t\ta[id]+=X-t[id];\n\t\t\t\t\t\tans=max(ans,a[id]);\n\t\t\t\t\t}\n\t\t\t\t\tt[id]=0;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfor(int j=1;j<1000;j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(t[j])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ta[j]+=X-t[j];\n\t\t\t\t\t\t\tans=max(ans,a[j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tflag=false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\ntypedef pair<int,int>pint;\ntypedef vector<int>vint;\ntypedef vector<pint>vpint;\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define se second\n#define all(v) (v).begin(),(v).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define reps(i,f,n) for(int i=(f);i<(n);i++)\n#define each(it,v) for(__typeof((v).begin()) it=(v).begin();it!=(v).end();it++)\ntemplate<class T,class U>void chmin(T &t,U f){if(t>f)t=f;}\ntemplate<class T,class U>void chmax(T &t,U f){if(t<f)t=f;}\n\nint N;\n\nint cnt[1000];\n\nvoid solve(){\n    map<string,vector<pint>>M;\n    rep(i,N){\n        string s;cin>>s;\n        int a,b;\n        scanf(\"%lld:%lld\",&a,&b);\n        char c;int d;\n        cin>>c>>d;\n        M[s].pb(pint(a*60+b,d-1));\n    }\n    memset(cnt,0,sizeof(cnt));\n    for(auto &v:M){\n        map<int,vint>MM;\n        for(auto &p:v.se)MM[p.se].pb(p.fi);\n        bool ex[60*24]={0};\n        for(auto &vv:MM){\n            if(vv.fi==-1){\n                rep(i,vv.se.size()/2){\n                    reps(j,vv.se[i*2],vv.se[i*2+1])ex[j]=true;\n                }\n            }\n            else{\n                rep(i,vv.se.size()/2){\n                    reps(j,vv.se[i*2],vv.se[i*2+1])cnt[vv.fi]+=ex[j];\n                }\n            }\n        }\n    }\n    cout<<*max_element(cnt,cnt+1000)<<endl;\n}\n\nsigned main(){\n    while(cin>>N,N)solve();\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nconst int MAX_N = 1000;\n\nint main(){\n\tint n;\n\t// p[id] := プログラマ id がログインした時刻\n\tint p[MAX_N+1];\n\t// time[id] := プログラマ id が女神と一緒にいた時間の和.\n\tint time[MAX_N+1];\n\t\n\twhile( scanf(\"%d\", &n) , n ){\n\t\t\n\t\t// 初期化\n\t\tfor(int i=0 ; i <= n ; i++ ){\n\t\t\tp[i] = -1;\n\t\t\ttime[i] = 0;\n\t\t}\n\t\t\n\t\tfor(int i=0 ; i < n ; i++ ){\n\t\t\tint month, day, h, m, id;\n\t\t\tchar log;\n\t\t\tscanf(\"%d/%d %d:%d %c %d\", &month, &day, &h, &m, &log, &id);\n\t\t\t\n\t\t\tint t = h * 60 + m;\n\t\t\tif( id > 0 && log == 'I' ){\n\t\t\t\tp[id] = t;\n\t\t\t}else if( id > 0 && log == 'O' ){\n\t\t\t\tif( p[0] != -1 ){\n\t\t\t\t\ttime[id] += t - p[id];\n\t\t\t\t}\n\t\t\t\tp[id] = -1;\n\t\t\t}else if( id == 0 && log == 'I' ){\n\t\t\t\tp[0] = t;\n\t\t\t\tfor(int i=1 ; i <= n ; i++ ){\n\t\t\t\t\tif( p[i] != -1 ){\n\t\t\t\t\t\tp[i] = t;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else if( id == 0 && log == 'O' ){\n\t\t\t\tfor(int i=1 ; i <= n ; i++ ){\n\t\t\t\t\tif( p[i] != -1 ){\n\t\t\t\t\t\ttime[i] += t - p[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tp[0] = -1;\n\t\t\t}\n\t\t}\n\t\t\n\t\tint ans = time[1];\n\t\tfor(int i=1 ; i <= n ; i++ ){\n\t\t\tans = max( ans , time[i] );\n\t\t}\n\t\tprintf(\"%d\\n\", ans);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <iostream>\n#include <math.h>\n#include <assert.h>\n#include <vector>\n#include <queue>\n#include <string>\n#include <map>\n#include <set>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\nstatic const double EPS = 1e-9;\nstatic const double PI = acos(-1.0);\n\n#define REP(i, n) for (int i = 0; i < (int)(n); i++)\n#define FOR(i, s, n) for (int i = (s); i < (int)(n); i++)\n#define FOREQ(i, s, n) for (int i = (s); i <= (int)(n); i++)\n#define FORIT(it, c) for (__typeof((c).begin())it = (c).begin(); it != (c).end(); it++)\n#define MEMSET(v, h) memset((v), h, sizeof(v))\n\nint n;\nint in[1000];\nint prev[1000];\nint total[1000];\n\nint main() {\n  while (scanf(\"%d\", &n), n) {\n    MEMSET(in, 0);\n    MEMSET(prev, 0);\n    MEMSET(total, 0);\n    int prevDay = 0;\n    REP(iter, n) {\n      int mon, day, h, m, id;\n      char io;\n      scanf(\"%d/%d %d:%d %c %d\", &mon, &day, &h, &m, &io, &id);\n      day = mon * 40 + day;\n      if (prevDay != day) { MEMSET(in, 0); }\n      prevDay = day;\n      m += 60 * h;\n      if (io == 'I') {\n        in[id] = 1;\n        prev[id] = m;\n      } else {\n        in[id] = 0;\n        if (id == 0) {\n          FOR(i, 1, 1000) {\n            if (in[i] == 0) { continue; }\n            total[i] += m - max(prev[i], prev[0]);\n          }\n        } else {\n          if (in[0] == 0) { continue; }\n          total[id] += m - max(prev[id], prev[0]);\n        }\n      }\n    }\n    int mans = 0;\n    REP(i, 1000) { mans = max(mans, total[i]); }\n    int ans = 0;\n    REP(i, 1000) { if (mans == total[i]) { ans += total[i]; } }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MAX 1005\nint n;\nbool t[MAX];\nint u[MAX];\n\nvoid init(){\n  for(int i=0;i<MAX;i++){\n    t[i]=false;\n    u[i]=0;\n  }\n}\n\nint main(){\n  while(1){\n    cin>>n;\n    if(n==0)break;\n    init();\n    int now=0,prev;\n    for(int i=0;i<n;i++){\n      prev=now;\n      string str;\n      char ch;\n      int a,b,id;\n      cin>>str>>a>>ch>>b>>ch>>id;\n      now=a*60+b;\n      \n      //cout<<a<<' '<<b<<' '<<ch<<' '<<id<<endl;\n      if(t[0])\n\tfor(int j=0;j<MAX;j++)\n\t  if(t[j])u[j]+=(now-prev);\n      \n      t[id]^=true;\n    }\n    int ans=0;\n    for(int i=1;i<n;i++){\n      ans=max(ans,u[i]);\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nint n,t[1005],ent[1005],ans;\nbool isin[1500];\nchar md[10],hm[10],io[10],id[10];\nchar mdd[10];\nint gettime()\n{\n    int hh=(hm[0]-'0')*10+(hm[1]-'0');\n    int mi=(hm[3]-'0')*10+(hm[4]-'0');\n    return hh*60+mi;\n}\nint main()\n{\n    ///freopen(\"in.txt\",\"r\",stdin);\n    while(scanf(\"%d\",&n)&&n!=0)\n    {\n        memset(t,0,sizeof t);\n        mdd[0]='s';\n        ans=0;\n        while(n--)\n        {\n            scanf(\"%s%s%s%s\",md,hm,io,id);\n            if(strcmp(md,mdd)!=0)\n            {\n                memset(isin,false,sizeof isin);\n                memcpy(mdd,md,sizeof md);\n            }\n            int ID=(id[0]-'0')*100+(id[1]-'0')*10+(id[2]-'0');\n            if(io[0]=='I')\n            ent[ID]=gettime();\n            else\n            {\n                int endtime=gettime();\n                if(ID==0)\n                {\n                    for(int i=ent[ID];i<endtime;i++)\n                    isin[i]=true;\n                    ent[ID]=0;///陦ィ遉コ蟾イ扈丞源驟?                }\n                else\n                {\n                    ///蜈域峩譁ー螂ウ逾樒噪迥カ諤?                    if(ent[0]!=0)\n                    {\n                        for(int i=ent[0];i<endtime;i++)\n                        {\n                            isin[i]=true;\n                        }\n                    }\n                    for(int i=ent[ID];i<endtime;i++)\n                    {\n                        if(isin[i])\n                        t[ID]++;\n                    }\n                }\n                ans=max(t[ID],ans);\n            }\n        }\n        printf(\"%d\\n\",ans);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <map>\nusing namespace std;\nconst int INF = (1e9);\n\nint main(){\n  int N;\n  const string g = \"000\";\n  while(cin >> N, N){\n    string d, t, e, id, D;\n    map<string, int> T, I, O;\n    for(int i = 0; i < N; ++i){\n      cin >> d >> t >> e >> id;\n      if(D != d){\n        D = d;\n        for(auto itr = I.begin(); itr != I.end(); ++itr) itr->second = INF;\n        for(auto itr = O.begin(); itr != O.end(); ++itr) itr->second = -1;\n      }\n      int m = stoi(t.substr(0,2))*60 + stoi(t.substr(3,2));\n      if(e == \"I\"){\n        I[id] = m;\n        O[id] = INF;\n      }else{\n        O[id] = m;\n        if(id != g && O[g] > m){\n          T[id] += max(0, m - max(I[g],I[id]));\n        }else if(id == g){\n          for(auto itr = O.begin(); itr != O.end(); ++itr){\n            id = itr->first;\n            int o = itr->second;\n            if(o > m){\n              T[id] += max(0,m - max(I[id],I[g]));\n            }\n          }\n        }\n      }\n    }\n    int ans = 0;\n    for(auto itr = T.begin(); itr != T.end(); ++itr){\n      if(itr->first == g) continue;\n      //cout << itr->first << \" \" << itr->second << endl;\n      ans = max(ans, itr->second);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <sstream>\n#include <vector>\nusing namespace std;\n\nvector<int> V[1000];\n\nint hmToM(int d, int h, int m) {\n  return (d*24+h)*60 + m;\n}\n\npair<int,int> sToHM(string s) {\n  if(s == \"24:00\") cout << \"!\" << endl;\n  replace(s.begin(), s.end(), ':', ' ');\n  stringstream ss;\n  ss << s;\n  pair<int,int> p;\n  ss >> p.first >> p.second;\n  return p;\n}\n\nint getM(int day,string s) {\n  pair<int,int> p = sToHM(s);\n  return hmToM(day, p.first, p.second);\n}\n\nint solve() {\n  int ans = 0;\n  for(int i = 0; i < 1000; ++i) {\n    for(int j = i+1; j < 1000; ++j) {\n      int sum = 0;\n      for(int k = 0; k < V[i].size(); k += 2) {\n\tfor(int l = 0; l < V[j].size(); l += 2) {\n\t  if(V[i][k+1] <= V[j][l]) continue;\n\t  if(V[j][l+1] <= V[i][k]) continue;\n\t  if(V[i][k] <= V[j][l] && V[j][l+1] <= V[i][k+1])\n\t    sum += V[j][l+1] - V[j][l];\n\t  else if(V[j][l] <= V[i][k] && V[i][k+1] <= V[j][l+1])\n\t    sum += V[i][k+1] - V[i][k];\n\t  else\n\t    sum += min(V[i][k+1] - V[j][l], V[j][l+1] - V[i][k]);\n\t}\n      }\n      ans = max(sum, ans);\n    }\n  }\n  return ans;\n}\n\nint main() {\n  int n;\n  while(cin >> n && n) {\n    string pre = \"\";\n    int day = 1;\n    for(int i = 0; i < 1000; ++i) V[i].clear();\n    for(int i = 0; i < n; ++i) {\n      string in[3];\n      int id;\n      cin >> in[0] >> in[1] >> in[2] >> id;\n      if(pre != in[0]) {\n\tpre = in[0];\n\tfor(int j = 0; j < 1000; ++j) {\n\t  if(V[j].size() % 2 != 0)\n\t    V[j].push_back(hmToM(day,24,0));\n\t}\n\t++day;\n      }\n      V[id].push_back(getM(day, in[1]));\n    }\n    for(int j = 0; j < 1000; ++j) {\n      if(V[j].size() % 2 != 0)\n\tV[j].push_back(hmToM(day, 24,0));\n    }\n    cout << solve() << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#pragma warning(disable:4996)\n\n#define MAX_N 10000\n#define MAX_M 501\n\nint Q;\nint M[MAX_N], D[MAX_N], h[MAX_N], m[MAX_N], t[MAX_N], n[MAX_N];\nint K[MAX_N], L[MAX_N];\nchar c;\n\nint main() {\n\twhile (true) {\n\t\tfor (int i = 0; i < MAX_N; i++) { M[i] = 0; D[i] = 0; h[i] = 0; m[i] = 0; t[i] = 0; n[i] = 0; K[i] = 0; L[i] = 0; }\n\t\tbool megami = false; int zenkai = 0; cin >> Q; if (Q == 0) { break; }\n\t\tfor (int i = 0; i < Q; i++) {scanf(\"%02d/%02d %02d:%02d %c %03d\", &M[i], &D[i], &h[i], &m[i], &c, &n[i]); if (c == 'I') { t[i] = 0; } else { t[i] = 1; }}\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tif (t[i] == 0) { L[n[i]] = 1; }if (t[i] == 1) { L[n[i]] = 0; }\n\t\t\tif (megami == true) { for (int j = 0; j < MAX_M; j++) { if (L[j] == 1) { K[j] += (h[i] * 60 + m[i]) - zenkai; } } }\n\t\t\tzenkai = h[i] * 60 + m[i]; if (n[i] == 0 && t[i] == 0) { megami = true; } else if (n[i] == 0) { megami = false; }\n\t\t}\n\t\tint maxn = 0; for (int i = 0; i < MAX_M; i++) { maxn = max(maxn, K[i]); }cout << maxn << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <iostream>\n#include <algorithm>\n#define pii pair<int, int>\n#pragma warning(disable : 4996)\nusing namespace std;\nint N, a, b, c, d, f, g[1009], x[1009]; char e; vector<pii> D[1009];\nint main() {\n\twhile (scanf(\"%d\", &N), N) {\n\t\tfill(g, g + 1000, -1);\n\t\tfill(D, D + 1000, vector<pii>());\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tscanf(\"%02d/%02d %02d:%02d %c %03d\", &a, &b, &c, &d, &e, &f);\n\t\t\tint z = a * 1000000 + b * 10000 + c * 60 + d;\n\t\t\tif (e == 'I') {\n\t\t\t\tg[f] = z;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tD[f].push_back(make_pair(g[f], z));\n\t\t\t\tg[f] = -1;\n\t\t\t}\n\t\t}\n\t\tfill(x, x + 1000, 0);\n\t\tfor (int i = 1; i < 1000; i++) {\n\t\t\tfor (pii d1 : D[i]) {\n\t\t\t\tfor (pii d2 : D[0]) {\n\t\t\t\t\tpii d3 = d1, d4 = d2;\n\t\t\t\t\tif (d3.first > d4.first) swap(d3, d4);\n\t\t\t\t\tif (d3.second < d4.first) continue;\n\t\t\t\t\tif (d3.second < d4.second) x[i] += d3.second - d4.first;\n\t\t\t\t\telse x[i] += d4.second - d4.first;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ret = *max_element(x, x + 1000);\n\t\tprintf(\"%d\\n\", ret);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n \nint main() {\n  int n;\n  while(cin >> n && n) {\n    int t[1000],z[1000];\n    memset(t,-1,sizeof(t));\n    memset(z,0,sizeof(z));\n    while(n--) {\n      int h,m;\n      string _,a,b;\n      cin >> _;\n      scanf(\"%d%*c%d\",&h,&m);\n      cin >> a >> b;\n      int x,y=h*60+m;\n      stringstream ss;\n      ss << b;\n      ss >> x;\n      if(a==\"I\") t[x]=y;\n      else {\n    if(x==0) {\n      for(int i=1; i<1000; i++) {\n        if(t[i]!=-1) z[i]+=y-max(t[0],t[i]);\n      }\n    } else {\n      if(t[0]!=-1) z[x]+=y-max(t[0],t[x]);\n    }\n    t[x]=-1;\n      }\n    }\n    int ans=0;\n    for(int i=1; i<1000; i++) ans=max(ans,z[i]);\n    cout << ans << endl;\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <cstdio>\n#include <vector>\n#define N 1000\nusing namespace std;\nint n,M[N],D[N],h[N],m[N],p[N],f,f2,s,sum,ans;\nchar e[N];\nvector<int> v[N];\n\nint Getminute(int a,int b){\n  return (h[b]*60+m[b])-(h[a]*60+m[a]);\n}\n\nint main(){\n  while(1){\n    cin>>n;\n    if(!n) break;\n    for(int i=0;i<n;i++){\n      scanf(\"%d/%d %d:%d %c %d\",&M[i],&D[i],&h[i],&m[i],&e[i],&p[i]);\n      if(!p[i])\n\tfor(int j=0;j<N;j++) v[j].push_back(i);\n      else v[p[i]].push_back(i);\n    }\n    ans=0;\n    for(int i=0;i<N;i++){\n      s=f=f2=sum=0;\n      for(int j=0;j<v[i].size();j++){\n\tint x=v[i][j];\n\tif(!p[x]&&e[x]=='I') f=1,s=x;\n\tif(!p[x]&&e[x]=='O'){\n\t  if(f2) sum+=Getminute(s,x);\n\t  f=0;\n\t}\n\tif(p[x]&&e[x]=='I') f2=1,s=x;\n\tif(p[x]&&e[x]=='O'){\n\t  if(f) sum+=Getminute(s,x);\n\t  f2=0;\n\t}\n      }\n      ans=max(ans,sum);\n    }\n    cout<<ans<<endl;\n    for(int i=0;i<N;i++) v[i].clear();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\nstruct log{\n  int month, day, hour, minute;\n  char e;\n  int p;\n};\n\nint myabs(int n){ return n >= 0 ? n : -n; }\n\nint i_to_sit(string::iterator s, string::iterator e){\n  int ans = 0;\n  for(string::iterator t = s; t != e; t++){\n    ans *= 10;\n    ans += (*t - '0');\n  }\n  return ans;\n}\n\nint difftime(log a, log b){\n  return myabs((a.hour * 60 + a.minute) - (b.hour * 60 + b.minute));\n}\n\nint main(void){\n  while(true){\n    int n;\n    cin >> n;\n    if(n == 0){ break; }\n\n    string input;\n    vector<log> logbook;\n    vector<log> goddess;\n    int lastp = 0;    \n    for(int i = 0; i < n; i++){\n      log in;\n      \n      cin >> input;\n      in.month = i_to_sit(input.begin(), input.begin() + 2);\n      in.day = i_to_sit(input.begin() + 3, input.end());\n\n      cin >> input;\n      in.hour = i_to_sit(input.begin(), input.begin() + 2);\n      in.minute = i_to_sit(input.begin() + 3, input.end());\n\n      cin >> input;\n      in.e = input[0];\n      \n      cin >> input;\n      in.p = i_to_sit(input.begin(), input.end());\n      \n      logbook.push_back(in);\n      lastp = lastp > in.p ? lastp : in.p;\n    }\n    ++lastp;\n    \n    vector<vector<int> > imos(lastp, vector<int>(n + 1, 0));\n    for(int i = 0; i < n; i++)\n      imos[logbook[i].p][i] = (logbook[i].e == 'I') ? 1 : -1;\n    for(size_t i = 0; i < imos.size(); i++)\n      for(size_t j = 1; j < imos[i].size(); j++)\n        imos[i][j] += imos[i][j - 1];\n\n    vector<int> blessed(lastp, 0);    \n    for(int i = 1; i < lastp; i++)\n      for(size_t j = 0; j < imos[i].size() - 1; j++)\n        if(imos[i][j] == 1 && imos[0][j] == 1)\n          blessed[i] += difftime(logbook[j], logbook[j + 1]);\n\n    int maxp = 0, maxtime = 0;\n    for(int i = 0; i < lastp; i++){\n      if(blessed[i] > maxtime){\n        maxtime = blessed[i];\n        maxp = i;\n      }\n    }\n\n    cout << blessed[maxp] << endl;    \n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <map>\n#include <cstdlib>\n \nusing namespace std;\n \nint getTime(string s){\n  int a=atoi(s.substr(0,2).c_str());\n  int b=atoi(s.substr(3,2).c_str());\n  return a*60+b;\n}\nint main(){\n  int n;\n  while(cin>>n&&n){\n    map<string,int> ans;\n    map<string,int> info;\n    for(int i=0;i<n;i++){\n      string s1,s2,s3,s4;\n      cin>>s1>>s2>>s3>>s4;\n      int time=getTime(s2);\n      if(s3==\"I\")info[s4]=time;\n      else{\n    int diff=time-info[s4];\n    if(s4==\"000\"){\n      for(map<string,int>::iterator it=info.begin();\n          it!=info.end();it++){\n        if(it->first==\"000\")continue;\n        int a=time-max(info[\"000\"],(it->second));\n        ans[it->first]+=a;\n      }\n    }\n    else if(info.count(\"000\")>0)\n      ans[s4]+=(time-max(info[\"000\"],info[s4]));\n    info.erase(s4);\n      }\n    }\n    int res=0;\n    for(map<string,int>::iterator it=ans.begin();\n    it!=ans.end();it++)\n      res=max(res,it->second);\n    cout<<res<<endl;\n  }\n   \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <cstdlib>\n#include <vector>\nusing namespace std;\n\nint main() {\n\tfor(int n; scanf(\"%d\", &n), n;) {\n\t\tvector<bool> login(1000, false);\n\t\tvector<int> time(1000, 0), cnt(1000, 0);\n\t\t\n\t\twhile(n--) {\n\t\t\tint M, D, h, m, p;\n\t\t\tchar e;\n\n\t\t\tscanf(\"%d/%d %d:%d %c %d\", &M, &D, &h, &m, &e, &p);\n\t\t\tm += h * 60;\n\n\t\t\tif(e == 'I') {\n\t\t\t\tlogin[p] = true;\n\t\t\t\ttime[p] = m;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif(p) {\n\t\t\t\t\tlogin[p] = false;\n\t\t\t\t\tif(login[0])\n\t\t\t\t\t\tcnt[p] += m - max(time[0], time[p]);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tlogin[0] = false;\n\t\t\t\t\tfor(int i = 1; i < 1000; ++i) {\n\t\t\t\t\t\tif(login[i]) {\n\t\t\t\t\t\t\tcnt[i] += m - max(time[0], time[i]);\n\t\t\t\t\t\t\ttime[i] = m;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%d\\n\", *max_element(cnt.begin(), cnt.end()));\n\t}\n\n\treturn EXIT_SUCCESS;\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <cassert>\n#include <memory>\n#include <time.h>\nusing namespace std;\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n) FOR(i,0,n)\nconst double EPS = 1e-9;\nconst double PI  = acos(-1.0);\n \n \nstruct programmer{\n    int score,presence;\n    programmer():score(0),presence(0){}\n};\nstruct evnt{\n    int month,date;\n    int hour,min;\n    char inout;\n    int id;\n};\nint main(){\n    int n;\n    while(cin>>n,n){\n        vector<programmer> programmers(1000);\n        int pl=programmers.size();\n        vector<evnt> evnts(n);\n        REP(i,n){\n            char sep;\n            cin>>evnts[i].month>>sep>>evnts[i].date>>evnts[i].hour>>sep>>evnts[i].min>>evnts[i].inout>>evnts[i].id;\n        }\n        FOR(i,1,evnts.size()){\n          if(evnts[i].date!=evnts[i-1].date){\n              evnt e;\n              e.month=evnts[i-1].month;\n              e.date=evnts[i-1].date;\n              e.hour=24;\n              e.min=0;\n              e.inout='C';\n              evnts.insert(evnts.begin()+i,e);\n              i++;\n          }\n        }\n              evnt e;\n              e.month=evnts[evnts.size()-1].month;\n              e.date=evnts[evnts.size()-1].date;\n              e.hour=24;\n              e.min=0;\n              e.inout='C';\n              evnts.push_back(e);\n \n        int prevtime=0;\n        int goddess_presence=0;\n        REP(i,n){\n            int curtime=evnts[i].hour*60+evnts[i].min;\n            if(evnts[i].inout=='C'){\n                //REP(j,pl){\n                //    if(programmers[j].presence&&goddess_presence){\n                //        programmers[j].score+=curtime-prevtime;\n                //    }\n                //    programmers[j].presence=0;\n                //}\n                //goddess_presence=0;\n                prevtime=0;\n            }else if(evnts[i].id==0){\n                if(evnts[i].inout=='O'){\n                    REP(j,pl){\n                        if(programmers[j].presence){\n                            programmers[j].score+=curtime-prevtime;\n                        }\n                    }\n                }\n                goddess_presence=evnts[i].inout=='I';\n                prevtime=curtime;\n            }else{\n                if(goddess_presence){\n                    REP(j,pl){\n                        if(programmers[j].presence){\n                            programmers[j].score+=curtime-prevtime;\n                        }\n                    }\n                }\n                programmers[evnts[i].id].presence=evnts[i].inout=='I';\n                prevtime=curtime;\n            }\n            //cerr<<curtime<<\"*\"<<evnts[i].month<<evnts[i].date<<\"-\"<<evnts[i].hour<<\":\"<<evnts[i].min<<\"= \";\n            //FOR(j,1,5){\n            //  cerr<<programmers[j].score<<\",\";\n            //}\n            //cerr<<endl;\n        }\n        int ans=0;\n        REP(i,pl){\n            ans=max(ans,programmers[i].score);\n        }\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<cstdlib>\n#include<map>\n#define F first\n#define S second\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\ntypedef pair<int,int> P;\ntypedef pair<P,P> PP; //PP(P(SM,SD),PP(P(S_h,S_m),P(E_h,E_m))\ntypedef pair<P,int> hP;\n\nint main(){\n  int n;\n  string s,ss,sss,ssss;\n  multimap<string,PP> info;\n  map<string,hP> index;\n  map<string,int> Final;\n  while(cin >> n && n){\n    info.clear();\n    rep(i,n){\n      cin >> s >> ss >> sss >> ssss;\n      int Mo,Da,st,ed;\n      st = ed = 0;\n      rep(j,s.length()){ // string to int (Month/Day)\n\tif(s[j] == '0' && st == 0){\n\t  st = j+1;\n\t  continue;\n\t}     \n\tif(s[j] == '/'){\n\t  Mo = (atoi)(s.substr(st,j-st).c_str() );\n\t  st = j+1;\n\t}\n\telse if(j == s.length()-1){\n\t  Da = (atoi)(s.substr(st,j-st+1).c_str() );\n\t}\n      }// string to int (Month/Day)\n \n      st = ed = 0;\n      int time_h,time_m;\n      rep(j,ss.length() ){ // string to int (time:time)\n\tif(st == 0 && ss[0] == '0'){\n\t  st = j+1;\n\t  continue;\n\t}\n\tif(ss[j] == ':'){\n\t  time_h = (atoi)(ss.substr(st,j-st).c_str() );\n\t  st = j+1;\n\t}\n\telse if(j == ss.length()-1 ){\n\t  time_m = (atoi)(ss.substr(st,j-st+1).c_str() );\n\t}\n      }// string to int (time:time)\n      if(sss == \"I\"){\n\tindex[ssss] = hP(P(Mo,Da),time_h*60+time_m);\n\t//cout << index[ssss].F.F << endl;\n      }\n      else if(sss == \"O\"){\n\tinfo.insert(multimap<string,PP>::value_type(ssss,PP(P(index[ssss].F),P(index[ssss].S,time_h*60+time_m ) )) );\n\t//map<string,PP>::iterator it = index[ssss];\n\tindex.erase(ssss);\n      }\n    \n    }\n    multimap<string,PP>::iterator it = info.begin();\n   \n    /*    \n    while(it != info.end() ){\n      cout << \"index = \" << (*it).F << \", start Month & Day = (\" << (*it).S.F.F.F << \",\" << (*it).S.F.F.S << \") , end Month & Day = (\" <<  (*it).S.F.S.F << \",\" << (*it).S.F.S.S << \") , start time = (\" << (*it).S.S.F.F << \",\" << (*it).S.S.F.S << \"), endtime = (\" << (*it).S.S.S.F << \",\" << (*it).S.S.S.S << \")\" << endl;  \n      it++;\n    }\n    */\n\n    Final.clear();\n\n    while((*it).F == \"000\"){   \n      //cout << (*it).F << \"  \"  << (*it).S.F.F << \"/\" << (*it).S.F.S << \", \" << (*it).S.S.F << \" 〜 \" << (*it).S.S.S << endl;\n      multimap<string,PP>::iterator it2 = info.begin();\n      while(it2 != info.end() ){\n\tif((*it2).F == \"000\"){\n\t  it2++;\n\t  continue;\n\t}\n\t//cout << (*it2).F << \"   \"  << (*it2).S.F.F << \"//\" << (*it2).S.F.S << \", \" << (*it2).S.S.F << \" 〜 \" << (*it2).S.S.S << endl;\n\tif( (*it).S.F.F == (*it2).S.F.F && (*it).S.F.S == (*it2).S.F.S && ( ( ((*it).S.S.F <= (*it2).S.S.F && (*it2).S.S.F <= (*it).S.S.S  )   ||        ( (*it).S.S.F <= (*it2).S.S.S && (*it2).S.S.S <= (*it).S.S.S  )   )  || ( ((*it2).S.S.F <= (*it).S.S.F  ) && ((*it).S.S.S <= (*it2).S.S.S )  )   )  ){\n\n\t  if( ( ((*it2).S.S.F <= (*it).S.S.F  ) && ((*it).S.S.S <= (*it2).S.S.S )  ) ){\n\t    Final[(*it2).F] += (*it).S.S.S - (*it).S.S.F;\n\t    //cout << \"P_0 Index is \" << (*it2).F  << \"!! this value is \" << Final[(*it2).F] << endl;\n\t  }\n\t else if( ( ((*it).S.S.F <= (*it2).S.S.F && (*it2).S.S.F <= (*it).S.S.S  )     &&    ( (*it).S.S.F <= (*it2).S.S.S && (*it2).S.S.S <= (*it).S.S.S  )   )  ){\n\t    Final[(*it2).F] += (*it2).S.S.S - (*it2).S.S.F;\n\t    //cout << \"P_1 Index is \" << (*it2).F  << \"!! this value is \" << Final[(*it2).F] << endl;\n\t  } \n\t  else if( ((*it).S.S.F <= (*it2).S.S.F && (*it2).S.S.F <= (*it).S.S.S  )  ){\n\t    Final[(*it2).F] += (*it).S.S.S - (*it2).S.S.F;\n\t    //cout << \"P_2 Index is \" << (*it2).F  << \"!! this value is \" << Final[(*it2).F] << endl;\n\t  }\n\t  else if( ( (*it).S.S.F <= (*it2).S.S.S && (*it2).S.S.S <= (*it).S.S.S  ) ){\n\t    Final[(*it2).F] += (*it2).S.S.S - (*it).S.S.F; \n\t    //cout << \"P_3 Index is \" << (*it2).F  << \"!! this value is \" << Final[(*it2).F] << endl;\n\t  }\n\n\n\n\t}\n\n\tit2++;\n      }\n\n\n      it++;\n    }\n\n\n\n    int ans = 0;\n    map<string,int>::iterator IT = Final.begin();\n    while(IT != Final.end() ){\n      ans = max(ans,(*IT).S);\n      IT++;\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <sstream>\n#include <vector>\nusing namespace std;\n\nvector<int> V[1000];\n\nint hmToM(int d, int h, int m) {\n  return (d*24+h)*60 + m;\n}\n\npair<int,int> sToHM(string s) {\n  if(s == \"24:00\") cout << \"!\" << endl;\n  replace(s.begin(), s.end(), ':', ' ');\n  stringstream ss;\n  ss << s;\n  pair<int,int> p;\n  ss >> p.first >> p.second;\n  return p;\n}\n\nint getM(int day,string s) {\n  pair<int,int> p = sToHM(s);\n  return hmToM(day, p.first, p.second);\n}\n\nint solve() {\n  int ans = 0;\n  for(int i = 0; i < 1000; ++i) {\n    for(int j = i+1; j < 1000; ++j) {\n      int sum = 0;\n      for(int k = 0; k < V[i].size(); k += 2) {\n\tfor(int l = 0; l < V[j].size(); l += 2) {\n\t  if(V[i][k+1] <= V[j][l]) continue;\n\t  if(V[j][l+1] <= V[i][k]) continue;\n\t  if(V[i][k] <= V[j][l] && V[j][l+1] <= V[i][k+1])\n\t    sum += V[j][l+1] - V[j][l];\n\t  else if(V[j][l] <= V[i][k] && V[i][k+1] <= V[j][l+1])\n\t    sum += V[i][k+1] - V[i][k];\n\t  else\n\t    sum += min(V[i][k+1] - V[j][l], V[j][l+1] - V[i][k]);\n\t}\n      }\n      ans = max(sum, ans);\n    }\n  }\n  return ans;\n}\n\nint main() {\n  int n;\n  while(cin >> n && n) {\n    string pre = \"\";\n    int day = 1;\n    for(int i = 0; i < 1000; ++i) V[i].clear();\n    for(int i = 0; i < n; ++i) {\n      string in[3];\n      int id;\n      cin >> in[0] >> in[1] >> in[2] >> id;\n      if(pre != in[0]) {\n\tpre = in[0];\n\tfor(int j = 0; j < 1000; ++j) {\n\t  if(V[j].size() % 2 != 0)\n\t    V[j].push_back(hmToM(day,23,59));\n\t}\n\t++day;\n      }\n      V[id].push_back(getM(day, in[1]));\n    }\n    for(int j = 0; j < 1000; ++j) {\n      if(V[j].size() % 2 != 0)\n\tV[j].push_back(hmToM(day, 23,59));\n    }\n    cout << solve() << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <sstream>\n#include <vector>\n#include <map>\n#include <vector>\nusing namespace std;\n\n\nvector<pair<string, int> > V[1000];\n\nint hmToM(string s) {\n  replace(s.begin(), s.end(), ':', ' ');\n  stringstream ss;\n  ss << s;\n  int h, m;\n  ss >> h >> m;\n  return h*60 + m;\n}\n\nint solve() {\n  int ans = 0;\n  for(int i = 0; i < 1000; ++i) {\n    for(int j = 0; j < 1000; ++j) {\n      if(i == j) continue;\n      int sum = 0;\n      for(int k = 0; k < V[i].size(); k+=2) {\n\tfor(int l = 0; l < V[j].size(); l+=2) {\n\t  int c;\n\t  if(V[i][k].first != V[j][l].first) continue;\n\t  if(V[i][k+1].second <= V[j][l].second) continue;\n\t  if(V[i][k].second >= V[j][l+1].second) continue;\n\t  if(V[i][k].second <= V[j][l].second && V[i][k+1].second >= V[j][l+1].second)\n\t    c = V[j][l+1].second - V[j][l].second;\n\t  else if(V[j][l].second <= V[i][k].second && V[j][l+1].second >= V[i][k+1].second)\n\t    c = V[i][k+1].second - V[i][k].second;\n\t  else \n\t    c = min(V[i][k+1].second - V[j][l].second, V[j][l+1].second - V[i][k].second);\n\t  sum += c;\n\t}\n      }\n      ans = max(ans, sum);\n    }\n  }\n  return ans;\n}\n\nint main() {\n  int N;\n  while(cin >> N && N) {\n    for(int i = 0; i < 1000; ++i) V[i].clear();\n    for(int i = 0; i < N; ++i) {\n      string in[3];\n      for(int j = 0; j < 3; ++j) cin >> in[j];\n      int id;\n      cin >> id;\n      V[id].push_back(make_pair(in[0], hmToM(in[1])));\n    }\n    cout << solve() << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint main(){\n  while (1){\n    int n;\n    cin >> n;\n    if (n == 0){\n      break;\n    }\n    vector<int> M(n), D(n), h(n), m(n);\n    vector<char> e(n);\n    vector<int> p(n);\n    for (int i = 0; i < n; i++){\n      char c1, c2;\n      cin >> M[i] >> c1 >> D[i] >> h[i] >> c2 >> m[i] >> e[i] >> p[i];\n    }\n    vector<int> time(n);\n    for (int i = 0; i < n; i++){\n      time[i] = ((M[i] * 40 + D[i]) * 24 + h[i]) * 60 + m[i];\n    }\n    vector<int> t(1000, 0);\n    vector<bool> c(1000, false);\n    for (int i = 0; i < n; i++){\n      if (e[i] == 'I'){\n        c[p[i]] = true;\n      }\n      if (e[i] == 'O'){\n        c[p[i]] = false;\n      }\n      if (i < n - 1 && c[0]){\n        int dt = time[i + 1] - time[i];\n        for (int j = 1; j < 1000; j++){\n          if (c[j]){\n            t[j] += dt;\n          }\n        }\n      }\n    }\n    int ans = 0;\n    for (int j = 1; j < 1000; j++){\n      ans = max(ans, t[j]);\n    }\n    cout << ans << endl;\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define mk make_pair\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long ll;\nstruct B{\n  int size;\n  vector<ll> dat;\n  void init(int n){\n    size=n;\n    dat.clear();\n    dat.resize(n+1);\n  }\n  void Add(int i,ll x){\n    while(0<i&&i<=size)\n      dat[i]+=x,i+=(i&-i);\n  }\n  ll Sum(int i){\n    ll res=0;\n    while(0<i)\n      res+=dat[i],i-=(i&-i);\n    return res;\n  }\n};\nint main(){\n  int n;\n  while(cin>>n,n){\n    int ans=0;\n    vector<int>v[1001];\n    for(int i=0;i<n;i++){\n      int pp=0,m,d,h,ss,t;\n      scanf(\"%d/%d %d:%d\",&m,&d,&h,&ss);\n      pp=m*40*24*60+d*24*60+h*60+ss;\n      string s1,s2;\n      cin>>s1>>t;\n      v[t].push_back(pp);\n    }\n    for(int o=1;o<1001;o++)if(v[o].size()){\n      B A,B;\n      A.init(700000);\n      B.init(700000);\n      for(int i=0;i<v[o].size();i+=2){\n\tint ss=v[o][i],tt=v[o][i+1];\n\tA.Add(ss,1);\n        A.Add(tt,-1);\n        B.Add(ss,-1*(ss-1));\n        B.Add(tt,1*(ss-1) + 1*(tt-ss+1) );\n      }\n      int sum=0;\n      for(int i=0;i<v[0].size();i+=2){\n\tint ss=v[0][i],tt=v[0][i+1];\n\tss;\n\tsum+=A.Sum(tt)*tt+B.Sum(tt) - A.Sum(ss)*ss-B.Sum(ss);\n      }\n      ans=max(sum,ans);\n    }\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nmap<string, int> dict; \nmap<string, int> enter;\n\nint main()\n{\n    //freopen(\"input.txt\", \"r\" ,stdin);\n    int n;\n    while (scanf(\"%d\", &n)==1)\n    {\n        if (n==0)\n            break;\n        dict.clear();\n        enter.clear();\n        int m, d, hours, minutes;\n        char str[100];\n        char flag[100];\n        for (int i=1; i<=n; i++)\n        {\n            scanf(\"%d/%d\", &m, &d);\n            scanf(\"%d:%d\", &hours, &minutes);\n            scanf(\"%s%s\", flag, str);\n\n            //printf(\"%d %d %d %d %s %s\\n\", m, d, hours, minutes, flag, str);\n            if (flag[0] == 'I')\n            {\n                if (string(str) == \"000\")\n                {\n                    enter[\"000\"] = hours*60+minutes;\n                    for (map<string, int>::iterator ite = enter.begin(); ite!=enter.end(); ite++)\n                        if (ite->second!=0)\n                            ite->second = hours*60+minutes;\n                }\n                else\n                    enter[string(str)] = hours*60+minutes;\n            }\n            else\n            {\n                if (string(str) != \"000\")\n                {\n                    if (enter[\"000\"])\n                        dict[string(str)] += hours*60+minutes - enter[string(str)];\n                    enter[string(str)] = 0;\n                }\n                else\n                {\n                    for (map<string, int>::iterator ite = enter.begin(); ite!=enter.end(); ite++)\n                    {\n                        if (ite->first!=\"000\"&& ite->second!=0)\n                        {\n                            dict[ite->first] += hours*60+minutes - ite->second;\n                            ite->second = hours*60+minutes;\n                        }\n                    }\n                    enter[\"000\"] = 0;\n                }\n            }\n        }\n        int ans = 0;\n        for (map<string, int>::iterator ite = dict.begin(); ite!=dict.end(); ite++)\n        {\n            //printf(\"%s %d\\n\", ite->first.c_str(), ite->second);\n            ans = max(ans, ite->second);\n        }\n        printf(\"%d\\n\", ans);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing PII = pair<ll, ll>;\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\ntemplate<typename T> void chmin(T &a, const T &b) { a = min(a, b); }\ntemplate<typename T> void chmax(T &a, const T &b) { a = max(a, b); }\nstruct FastIO {FastIO() { cin.tie(0); ios::sync_with_stdio(0); }}fastiofastio;\n#ifdef DEBUG_ \n#include \"../program_contest_library/memo/dump.hpp\"\n#else\n#define dump(...)\n#endif\nconst ll INF = 1LL<<60;\n\nvoid solve() {\n    ll n;\n    cin >> n;\n    if(n == 0) exit(0);\n    vector<ll> time(n), id(n);\n    vector<bool> in(n);\n    REP(i, n) {\n        ll month, day, hour, minute;\n        char c; \n        cin >> month >> c >> day >> hour >> c >> minute;\n        time[i] = (month-1) * 31 * 24 * 60 + (day-1) * 24 * 60 + hour * 60 + minute;\n\n        cin >> c;\n        in[i] = c == 'I';\n\n        cin >> id[i];\n    }\n    dump(time);\n    dump(in);\n    dump(id);\n\n    vector<ll> in_time(1000, -1), ans(1000);\n    REP(i, n) {\n        if(in[i]) {\n            in_time[id[i]] = time[i];\n        }\n        else {\n            assert(in_time[id[i]] != -1);\n            if(id[i] == 0) {\n                REP(j, 1000) if(in_time[j] != -1) {\n                    ans[j] += time[i] - max(in_time[0], in_time[j]);\n                }\n            } else {\n                if(in_time[0] != -1) {\n                    ans[id[i]] += time[i] - max(in_time[0], in_time[id[i]]);\n                }\n            }\n            in_time[id[i]] = -1;\n        }\n    }\n\n    ll ret = 0;\n    FOR(i, 1, 1000) chmax(ret, ans[i]);\n    cout << ret << endl;\n}\n\nint main(void) {\n    while(1) solve();\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <map>\n#include <algorithm>\n#include <cstdlib>\nusing namespace std;\n\nint main()\n{\n\tint n;\n\twhile (cin >> n) {\n\t\tif (n == 0)\n\t\t\tbreak;\n\n\t\tint god_in = -1;\n\t\tstring now_date = \"\";\n\n\t\tmap<int, int> log;\n\t\tvector<int> ans(1000, 0); \n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tstring date, time, e, pp;\n\t\t\tcin >> date >> time >> e >> pp;\n\n\t\t\tint p = atoi(pp.c_str());\n\t\t\tint min = atoi(time.substr(0, 2).c_str()) * 60 + atoi(time.substr(3).c_str());\n\n\t\t\tif (now_date != date) {\n\t\t\t\tlog.clear();\n\t\t\t\tgod_in = -1;\n\t\t\t\tnow_date = date;\n\t\t\t}\n\n\t\t\t// god\n\t\t\tif (p == 0) {\n\t\t\t\tif (e == \"I\") {\n\t\t\t\t\tgod_in = min;\n\t\t\t\t} else {\n\t\t\t\t\t// add\n\t\t\t\t\tfor (map<int, int>::iterator it = log.begin(); it != log.end(); ++it)\n\t\t\t\t\t\tans[it->first] += min - max(god_in, it->second);\n\t\t\t\t\tgod_in = -1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// other\n\t\t\t\tif (e == \"I\") {\n\t\t\t\t\tlog[p] = min;\n\t\t\t\t} else {\n\t\t\t\t\tif (god_in != -1)\n\t\t\t\t\t\tans[p] += min - max(log[p], god_in);\n\t\t\t\t\tlog.erase(p);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << *max_element(ans.begin(), ans.end()) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <algorithm>\n\nint n;\nint M,D,h,m,id;\nint cnt[1001];\nint t[1001];\nchar io;\nbool flag[1001];\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d\",&n);\n\t\tif(n==0)break;\n\t\tmemset(cnt,0,sizeof(cnt));\n\t\tmemset(t,0,sizeof(t));\n\t\tmemset(flag,0,sizeof(flag));\n\t\tfor(int i=0;i<n;i++){\n\t\t\tscanf(\"%2d/%2d %2d:%2d %c %3d\",&M,&D,&h,&m,&io,&id);\n\t\t\tif(io=='I'){\n\t\t\t\tt[id]=h*60+m;\n\t\t\t\tflag[id]=true;\n\t\t\t}else{\n\t\t\t\tif(id==0){\n\t\t\t\t\tfor(int i=1;i<=999;i++){\n\t\t\t\t\t\tif(flag[i])cnt[i]+=h*60+m-std::max(t[i],t[0]);\n\t\t\t\t\t}\n\t\t\t\t\tflag[0]=false;\n\t\t\t\t}else{\n\t\t\t\t\tif(flag[0]){\n\t\t\t\t\t\tcnt[id]+=h*60+m-t[id];\n\t\t\t\t\t}\n\t\t\t\t\tt[id]=h*60+m;\n\t\t\t\t\tflag[id]=false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint res=0;\n\t\tfor(int i=1;i<=999;i++){\n\t\t\tres=std::max(res,cnt[i]);\n\t\t}\n\t\tprintf(\"%d\\n\",res);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//include\n//------------------------------------------\n#include <vector>\n#include <list>\n#include <map>\n#include <climits>\n#include <set>\n#include <deque>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <queue>\n#include <random>\n#include <cctype>\n#include <complex>\n#include <regex>\n\nusing namespace std;\n\n#define C_MAX(a, b) ((a)>(b)?(a):(b))\n#define SHOW_VECTOR(v) {std::cerr << #v << \"\\t:\";for(const auto& xxx : v){std::cerr << xxx << \" \";}std::cerr << \"\\n\";}\n#define SHOW_MAP(v){std::cerr << #v << endl; for(const auto& xxx: v){std::cerr << xxx.first << \" \" << xxx.second << \"\\n\";}}\n\nstruct Data {\n    int time;\n    string which;\n    string id;\n};\n\nstruct Per {\n    int start;\n    int end;\n    string id;\n};\n\nint getTime(string s) {\n    int hour = stoi(s.substr(0, 2));\n    int minute = stoi(s.substr(3, 2));\n    int time = hour * 60 + minute;\n    return time;\n}\n\nint main() {\n\n    while (true) {\n\n        int N;\n        cin >> N;\n\n        if (N == 0) break;\n\n        string pre = \"\";\n        vector<vector<Data>> datas;\n        for (int i = 0; i < N; i++) {\n            string date, ti, which, id;\n            cin >> date >> ti >> which >> id;\n            int time = getTime(ti);\n            if (i == 0) {\n                datas.push_back(vector<Data>());\n                datas.back().push_back((Data) {time, which, id});\n                pre = date;\n                continue;\n            }\n            if (pre == date) datas.back().push_back((Data) {time, which, id});\n            else {\n                datas.push_back(vector<Data>());\n                datas.back().push_back((Data) {time, which, id});\n                pre = date;\n            }\n        }\n\n        map<string, int> M;\n        for (int i = 0; i < datas.size(); i++) {\n            vector<Per> god;\n            vector<Per> other;\n            int have = -1;\n            for (int j = 0; j < datas[i].size(); j++) {\n                auto data = datas[i][j];\n                if (data.id == \"000\") {\n                    if (have == -1) have = data.time;\n                    else {\n                        god.push_back((Per) {have, data.time, \"000\"});\n                        have = -1;\n                    }\n                }\n            }\n            map<string, int> has;\n            for (int j = 0; j < datas[i].size(); j++) has[datas[i][j].id] = -1;\n            for (int j = 0; j < datas[i].size(); j++) {\n                auto data = datas[i][j];\n                if (data.id != \"000\") {\n                    if (has[data.id] == -1) has[data.id] = data.time;\n                    else {\n                        other.push_back((Per) {has[data.id], data.time, data.id});\n                        has[data.id] = -1;\n                    }\n                }\n            }\n            for (auto go: god) {\n                for (auto ot: other) {\n                    int minV = max(go.start, ot.start);\n                    int maxV = min(go.end, ot.end);\n                    int d = maxV - minV;\n                    M[ot.id] += max(0, d);\n                }\n            }\n        }\n\n        int ansV = 0;\n        for (auto x: M) ansV = max(ansV, x.second);\n\n        cout << ansV << endl;\n\n    }\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \n#define MAX 1010\n \nint main(){\n    int N;\n    while(cin >> N, N > 0){\n\tint M[MAX],D[MAX],h[MAX],m[MAX],e[MAX],p[MAX];\n\tint Point[MAX] = {0},t[MAX];\n\tchar ch;\n\tfor(int i = 0 ; i < N ; i++){\n\t    scanf(\"%d/%d %d:%d %c %d\",\n\t\t  &M[i],&D[i],&h[i],&m[i],&ch,&p[i]);\n\t    e[i] = (ch == 'I');\n\t}\n\tmemset(t,-1,sizeof(t));\n\tfor(int i = 0 ; i < N ; i++){\n\t    int totalm = 60*h[i]+m[i];\n\t    if(e[i] == 1){\n\t\tt[p[i]] = totalm;\n\t    }else{\n\t\tif(p[i] == 0){\n\t\t    for(int j = 1 ; j < MAX ; j++){\n\t\t\tif(t[j] == -1) continue;\n\t\t\tPoint[j] += totalm-max(t[j],t[0]);\n\t\t    }\n\t\t}else{\n\t\t    if(t[0] != -1){\n\t\t\tPoint[p[i]] += totalm-max(t[p[i]],t[0]);\n\t\t    }\n\t\t}\n\t\tt[p[i]] = -1;\n\t    }\n\t}\n\tcout << *max_element(Point+1,Point+MAX) << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\n#include<stdio.h>\n#include<string.h>\n#include<map>\n#define MAX 1020\n#define INF 99999999\n\nmap<int, int> ma;\nint pre[MAX],sum[MAX];\n\nint month[13]={0,31,28,31,30,31,30,31,31,30,31,30,31};\n\nint Input()\n{\n    int m, d, h, t;\n    scanf(\"%d/%d %d:%d\", &m, &d, &h, &t);\n    return ((month[m-1]+d)*24+h)*60+t;\n}\n\nint main()\n{\n    int n, cur, ans;\n    while(scanf(\"%d\",&n), n)\n    {\n        cur=1;\n        ma.clear(); \n        ma[0]=0;\n        memset(pre, INF, sizeof(pre));\n        memset(sum, 0, sizeof(sum));\n        for(int i=0;i<n;++i)\n        {\n            char s[2];\n            int t, p;\n            t=Input();\n            scanf(\"%s%d\",s,&p);\n            if(ma.find(p)==ma.end())\n                ma[p]=cur++;\n            p=ma[p];\n            if(s[0]=='I')\n                pre[p]=t;\n            else\n            {\n                if(p==0)\n                    for(int j=1;j<cur;++j)\n                        sum[j]+=max(0,t-max(pre[0],pre[j]));\n                else\n                    sum[p]+=max(0,t-max(pre[0],pre[p]));\n                pre[p]=INF;\n            }\n        }\n        ans=0;\n        for(int i=1;i<cur;++i)\n            ans=max(ans,sum[i]);\n        printf(\"%d\\n\",ans);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstruct Info {\n  int M, D, t, e, p;  \n};\n\nsigned main() {\n  int n;\n  while ( cin >> n, n ) {\n    vector<int> sum(1000, 0);\n    int cnt = 0;\n    vector<Info> dat;    \n    while ( n-- ) {      \n      int M, D, h, m, p;\n      char e;\n      scanf(\"%d/%d %d:%d %c %d\", &M, &D, &h, &m, &e, &p);\n      if ( e == 'I' ) {\n\tdat.emplace_back(Info{M, D, h*60+m, 0, p});\n\tcnt++;\n      } else {\n\tdat.emplace_back(Info{M, D, h*60+m, 1, p});\n\tcnt--;\n      }\n\n      if ( cnt ) continue;\n      vector<int> zero(1500, 0);\n      vector<int> I(1000, 0);      \n      for ( Info i : dat ) {\n\tif ( i.p != 0 ) continue;\n\tif ( i.e == 0 ) {\n\t  I[i.p] = i.t;\t  \n\t} else {\n\t  for ( int j = I[i.p]; j < i.t; j++ ) {\n\t    zero[j]++;\t    \n\t  }\n\t}\n      }\n\n      for ( Info i : dat ) {\n\tif ( i.p == 0 ) continue;\n\tif ( i.e == 0 ) {\n\t  I[i.p] = i.t;\t  \n\t} else {\n\t  for ( int j = I[i.p]; j < i.t; j++ ) {\n\t    if ( zero[j] ) sum[i.p]++;\t    \n\t  }\n\t}\n      }\n\n      dat.clear();      \n    }\n\n    int ma = 0;\n    for ( int i = 0; i < 1000; i++ ) {\n      ma = max(ma, sum[i]);\n    }\n\n    cout << ma << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define all(x) (x).begin(),(x).end()\nconst int mod=1000000007,MAX=100005,INF=1<<30;\n\nint main(){\n    \n    std::ifstream in(\"text.txt\");\n    std::cin.rdbuf(in.rdbuf());\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    \n    while(1){\n        int N;cin>>N;\n        if(N==0) break;\n        vector<int> sum(1000),time(1000,-1);\n        \n        while(N--){\n            string md,hm,type,d;cin>>md>>hm>>type>>d;\n            int a=(hm[0]-'0')*600+(hm[1]-'0')*60+(hm[3]-'0')*10+(hm[4]-'0');\n            int id=stoi(d);\n            \n            if(type[0]=='I'){\n                time[id]=a;\n                if(id==0){\n                    for(int i=1;i<1000;i++){\n                        if(time[i]!=-1) time[i]=a;\n                    }\n                }\n            }else{\n                if(id==0){\n                    time[id]=-1;\n                    for(int i=1;i<1000;i++){\n                        if(time[i]!=-1){\n                            sum[i]+=a-time[i];\n                            time[i]=a;\n                        }\n                    }\n                }else{\n                    if(time[0]!=-1){\n                        sum[id]+=a-time[id];\n                    }\n                    time[id]=-1;\n                }\n            }\n            \n            //cout<<a<<\" \"<<id<<\" \"<<type[0]<<endl;\n        }\n        \n        int ans=0;\n        \n        for(int i=1;i<1000;i++) ans=max(ans,sum[i]);\n        \n        cout<<ans<<endl;\n    }\n}\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nconst int INF = 1e9;\nconst ll LINF = 1e18;\n\n\nint timesum[1001];\nint entry[1001];\nint main(void) {\n    // cin.tie(0); ios::sync_with_stdio(false);\n    int n;\n    while(cin >> n,n){\n        vector<int> M(n),D(n),h(n),m(n);\n        vector<string> e(n);\n        vector<int> p(n);\n        char c;\n        for(int i = 0; i < n;i++){\n            cin >> M[i] >> c >> D[i] >> h[i] >> c >> m[i] >> e[i] >> p[i];\n        }\n        fill(timesum,timesum+1001,0);\n        fill(entry,entry+1001,-1);\n        \n        for(int i = 0; i < n;i++){\n            \n            if(e[i] == \"I\"){\n                entry[p[i]] = h[i] * 60 + m[i];\n            }else{\n                int time = h[i] * 60 + m[i];\n                \n                if(p[i] == 0){\n                    for(int j = 1; j <= 1000; j++){\n                        if(entry[j] == -1) continue;\n                        timesum[j] += time-max(entry[0],entry[j]);\n                    }\n                    \n                }else{\n                    if(entry[0] != -1 && entry[p[i]] != -1){\n                        timesum[p[i]] += time - max(entry[0],entry[p[i]]);\n                    }\n                }\n                entry[p[i]] = -1;\n            }\n        }\n        cout << *max_element(timesum, timesum+101) << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <cassert>\n#include <memory>\n#include <time.h>\nusing namespace std;\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n) FOR(i,0,n)\nconst double EPS = 1e-9;\nconst double PI  = acos(-1.0);\n\n\nstruct programmer{\n\tint score,presence;\n\tprogrammer():score(0),presence(0){}\n};\nstruct evnt{\n\tint month,date;\n\tint hour,min;\n\tchar inout;\n\tint id;\n};\nint main(){\n\tint n;\n\twhile(cin>>n,n){\n\t\tvector<programmer> programmers(1000);\n\t\tint pl=programmers.size();\n\t\tvector<evnt> evnts(n);\n\t\tREP(i,n){\n\t\t\tchar sep;\n\t\t\tcin>>evnts[i].month>>sep>>evnts[i].date>>evnts[i].hour>>sep>>evnts[i].min>>evnts[i].inout>>evnts[i].id;\n\t\t}\n\t\t//FOR(i,1,evnts.size()){\n\t\t//\tif(evnts[i].date!=evnts[i-1].date){\n\t\t//\t\tevnt e;\n\t\t//\t\te.month=evnts[i-1].month;\n\t\t//\t\te.date=evnts[i-1].date;\n\t\t//\t\te.hour=24;\n\t\t//\t\te.min=0;\n\t\t//\t\te.inout='C';\n\t\t//\t\tevnts.insert(evnts.begin()+i,e);\n\t\t//\t\ti++;\n\t\t//\t}\n\t\t//}\n\t\t//\t\tevnt e;\n\t\t//\t\te.month=evnts[evnts.size()-1].month;\n\t\t//\t\te.date=evnts[evnts.size()-1].date;\n\t\t//\t\te.hour=24;\n\t\t//\t\te.min=0;\n\t\t//\t\te.inout='C';\n\t\t//\t\tevnts.push_back(e);\n\n\t\tint prevtime=0;\n\t\tint goddess_presence=0;\n\t\tREP(i,n){\n\t\t\tint curtime=evnts[i].hour*60+evnts[i].min;\n\t\t\t/*if(evnts[i].inout=='C'){\n\t\t\t\tREP(j,pl){\n\t\t\t\t\tif(programmers[j].presence&&goddess_presence){\n\t\t\t\t\t\tprogrammers[j].score+=curtime-prevtime;\n\t\t\t\t\t}\n\t\t\t\t\tprogrammers[j].presence=0;\n\t\t\t\t}\n\t\t\t\tgoddess_presence=0;\n\t\t\t\tprevtime=0;\n\t\t\t}else */if(evnts[i].id==0){\n\t\t\t\tif(evnts[i].inout=='O'){\n\t\t\t\t\tREP(j,pl){\n\t\t\t\t\t\tif(programmers[j].presence){\n\t\t\t\t\t\t\tprogrammers[j].score+=curtime-prevtime;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tgoddess_presence=evnts[i].inout=='I';\n\t\t\t\tprevtime=curtime;\n\t\t\t}else{\n\t\t\t\tif(goddess_presence){\n\t\t\t\t\tREP(j,pl){\n\t\t\t\t\t\tif(programmers[j].presence){\n\t\t\t\t\t\t\tprogrammers[j].score+=curtime-prevtime;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tprogrammers[evnts[i].id].presence=evnts[i].inout=='I';\n\t\t\t\tprevtime=curtime;\n\t\t\t}\n\t\t\t//cerr<<curtime<<\"*\"<<evnts[i].month<<evnts[i].date<<\"-\"<<evnts[i].hour<<\":\"<<evnts[i].min<<\"= \";\n\t\t\t//FOR(j,1,5){\n\t\t\t//\tcerr<<programmers[j].score<<\",\";\n\t\t\t//}\n\t\t\t//cerr<<endl;\n\t\t}\n\t\tint ans=0;\n\t\tREP(i,pl){\n\t\t\tans=max(ans,programmers[i].score);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<ll, ll> P;\ntypedef vector<ll> V;\ntypedef complex<double> Point;\n \n#define PI acos(-1.0)\n#define EPS 1e-10\nconst ll INF = 1e16;\nconst ll MOD = 1e9 + 7;\n \n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define rep(i,N) for(int i=0;i<(N);i++)\n#define ALL(s) (s).begin(),(s).end()\n#define EQ(a,b) (abs((a)-(b))<EPS)\n#define EQV(a,b) ( EQ((a).real(), (b).real()) && EQ((a).imag(), (b).imag()) )\n#define fi first\n#define se second\n#define N_SIZE (1LL << 20)\n#define NIL -1\n \nll n;\nll sum[600][60*30];\nll ans[600];\n \nvoid solve(){\n    // ll res = 0;\n    rep(i,600)rep(j,60*30-1)sum[i][j+1] += sum[i][j];\n    FOR(i,1,600){\n        ll cnt = 0;\n        rep(j,60*30){\n            if((sum[i][j] > 0) && (sum[0][j] > 0))cnt++;\n            // else cnt = 0;\n            // res = max(cnt,res);\n        }\n\t\tans[i] += cnt;\n    }\n    // return res;\n}\n \nvoid init(){\n    rep(i,600)rep(j,60*30)sum[i][j] = 0;\n}\n \nll calc(string s){\n    return ((s[0] - '0')*10+(s[1] - '0'))*60 + (s[3] - '0')*10+(s[4] - '0');\n}\n \nint main(){\n    while(cin >> n && n){\n\t\tfill(ans,ans+600,0);\n        string pre = \"\";\n        ll aans = 0;\n        rep(i,n){\n            string s,hm,e;\n            ll p;\n            cin >> s >> hm >> e >> p;\n            if(pre != s){\n                pre = s;\n\t\t\t\tsolve();\n                // ans = max(ans,solve());\n\t\t\t\t// cout << \"!!\" << pre << \" \" << ans << endl;\n                init();\n            }\n            ll num = calc(hm);\n            // cout << p << endl;\n            if(e == \"I\")sum[p][num] = 1;\n            else sum[p][num] = -1;\n        }\n        // ans = max(ans,solve());\n\t\tsolve();\n\t\tinit();\n\t\tFOR(i,1,600)aans = max(aans,ans[i]);\n\t\t// cout << \"!!\" << pre << \" \" << ans << endl;\n        cout << aans << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\nusing namespace std;\n\nstruct Data{\n    int m;\n    char io;\n    int id;\n};\n\n//??????A[a,b]??¨??????B[c,d]?????¢???\nint intervalState(int a, int b, int c, int d){\n    if(a < c && b < c) return 0;            //A < B\n    else if(a > d && b > d) return 1;       //A > B\n    else if(a <= c && d <= b) return 2;     //A -> B\n    else if(c < a && b < d) return 3;       //B -> A\n    else if(a <= c && b < d) return 4;      //A <= B\n    else if(c < a && d <= b) return 5;      //A >= B\n    return -1;\n}\n\nvoid requireTime(map<int,int> &time, map<int, vector<pair<int, int>>> s){\n    vector<pair<int, int>> god = s[000];\n    auto it = s.begin();\n    it++;\n    for(; it != s.end(); it++){\n        rep(i,god.size()){\n            vector<pair<int, int>> tmp = it->second;\n            rep(j,tmp.size()){\n                int left = max(god[i].first, tmp[j].first);\n                int right = min(god[i].second, tmp[j].second);\n                time[ it->first ] += right - left;\n            }\n        }\n    }\n}\n\nint main(){\n    int n;\n    while(cin >> n,n){\n        map<pair<int, int>, vector<Data>> v; //??\\????????¨????¨????\n        rep(i,n){\n            char g;\n            int m,d;\n            cin >> m >> g >> d;\n\n            int th,tm,id;\n            char io;\n            cin >> th >> g >> tm >> io >> id;\n            v[make_pair(m,d)].emplace_back(Data{th * 60 + tm, io, id});\n        }\n\n        map<int,int> time;//id->?????????????????????\n        for(auto it_v : v){\n            map<int, vector<pair<int, int>>> seg; //id?????¨?????????\n            map<int,int> tmp;\n            for(auto it_d : it_v.second){\n                if(it_d.io == 'I'){\n                    tmp[it_d.id] = it_d.m;\n                }else{\n                    seg[it_d.id].emplace_back(make_pair(tmp[it_d.id], it_d.m));\n                }\n            }\n            requireTime(time,seg);\n        }\n        int maxi = 0;\n        for(auto it : time){\n            maxi = max(maxi,it.second);\n        }\n        cout << maxi << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P > PP;\n\nint time2min(int month,int day,int hour,int min){\n  const int total_day_of_month[]\n    = {31,28,31,30,31,30,31,31,30,31,30,31};\n  int total = 0;\n  for(int i=1;i<month;i++){\n    total += total_day_of_month[i]*24*60;\n  }\n  for(int i=1;i<day;i++){\n    total += 24*60;\n  }\n  total += hour * 60 + min;\n\n  return total;\n}\n\nint main(){\n  int N;\n  while(~scanf(\"%d\",&N)){\n    if(N==0) break;\n\n    map<int,vector<int> > log;\n    for(int i=0;i<N;i++){\n      int month,day,hour,min,id;\n      char action[2];\n      scanf(\"%d/%d %d:%d %s %d\",\n\t    &month,&day,&hour,&min,action,\n\t    &id);\n      \n      int t = time2min(month,day,hour,min);\n      log[id].push_back(t);\n    }\n\n    int total[1000];\n    memset(total,0,sizeof(total));\n    \n    for(int i=0;i+1<log[0].size();i+=2){\n      int god_start = log[0][i];\n      int god_end = log[0][i+1];\n\n      for(map<int,vector<int> >::iterator it = log.begin();\n\t  it != log.end();\n\t  it++){\n\tint id = it->first;\n\tif(id == 0) continue;\n\tvector<int>& schedule = it->second;\n\tfor(int j=0;j<schedule.size();j+=2){\n\t  int ppl_start = schedule[j];\n\t  int ppl_end = schedule[j+1];\n\t  int start = max(god_start,ppl_start);\n\t  int end = min(god_end,ppl_end);\n\t  total[id] += max(0,end-start);\n\t}\n      }\n    }\n\n    int max_v = 0;\n    for(int id=0;id<1000;id++){\n      max_v = max(total[id],max_v);\n    }\n    printf(\"%d\\n\",max_v);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<vector>\n#include<map>\n#include<queue>\n#include<algorithm>\n#include<string.h>\n#include<math.h>\n#define mod 1000000007\n#define eps 1e-10\nusing namespace std;\nstruct node\n{\n    int m,d,h,min,st,v;\n};\nnode re[1002];\nint vis[1002];\nint ans[1002];\nint cal(int h1,int min1,int h2,int min2)\n{\n    return h2*60+min2-(h1*60+min1);\n}\nmain()\n{\n    int n;\n    while(scanf(\"%d\",&n),n)\n    {\n        int m,d,h,min,v;\n        char st;int ma=0;\n        memset(vis,0,sizeof(vis));\n        memset(ans,0,sizeof(ans));\n        for(int i=1;i<=n;i++)\n        {\n            scanf(\"%d%*c%d%d%*c%d%*c%c%d\",&m,&d,&h,&min,&st,&v);\n            ma=max(ma,v);\n            re[i].m=m;re[i].d=d;re[i].h=h;re[i].min=min;re[i].v=v;\n            if(st=='I') re[i].st=1;else re[i].st=0;\n        }\n        int cm=re[1].m,cd=re[1].d,f=0;\n        for(int i=1;i<=n;i++)\n        {\n            if(cm==re[i].m&&cd==re[i].d)\n            {\n                if(re[i].v!=0&&re[i].st==1) vis[re[i].v]=i;\n                if(re[i].v!=0&&re[i].st==0) if(vis[re[i].v]!=0&&f!=0)\n                {\n                    int u=vis[re[i].v];//cout<<i<<\" \"<<u<<endl;\n                    ans[re[i].v]+=cal(re[u].h,re[u].min,re[i].h,re[i].min);\n                    vis[re[i].v]=0;\n                }\n                if(re[i].v!=0&&re[i].st==0)  vis[re[i].v]=0;\n                if(re[i].v==0&&re[i].st==1)\n                {\n                    f=i;\n                    for(int j=1;j<=ma;j++) if(vis[j]!=0)\n                    {\n                        re[vis[j]].h=re[i].h;re[vis[j]].min=re[i].min;\n                    }\n                }\n                if(re[i].v==0&&re[i].st==0)\n                {\n                    f=0;\n                    for(int j=1;j<=ma;j++) if(vis[j]!=0)\n                    {\n                        ans[j]+=cal(re[vis[j]].h,re[vis[j]].min,re[i].h,re[i].min);\n                    }\n                }\n\n\n            }\n            else\n            {\n                memset(vis,0,sizeof(vis));\n                cm=re[i].m;cd=re[i].d;i--;\n            }\n        }\n        int an=0;\n        for(int i=1;i<=ma;i++)\n        an=max(an,ans[i]);\n        printf(\"%d\\n\",an);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string.h>\n#include <cstdio>\n#include <string>\n#define MAX 1001\n\nusing namespace std;\n\nint times[MAX];\nint exist[MAX];\nint last[MAX];\n\nint main()\n{\n\tint month, day, hour, minute, id, t;\n\tchar op;\n\twhile (cin >> t, t)\n\t{\n\t\tmemset(times, 0, sizeof(times));\n\t\tmemset(last, 0, sizeof(last));\n\t\tmemset(exist, 0, sizeof(exist));\n\t\tint maxtime = 0;\n\t\twhile (t--)\n\t\t{\n\t\t\tscanf(\"%d/%d %d:%d %c %d\", &month, &day, &hour, &minute, &op, &id);\n\t\t\tint nowtime = hour * 60 + minute;\n\t\t\t//cout << month << day << hour << minute << op << id << endl;\n\t\t\tif (op == 'I')\n\t\t\t{\n\t\t\t\texist[id] = 1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (id == 0)\n\t\t\t\t{\n\t\t\t\t\tfor (int i = 1; i <= 1000; i++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (exist[i])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttimes[i] += nowtime - ((last[0] > last[i]) ? last[0] : last[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (exist[0])\n\t\t\t\t\t{\n\t\t\t\t\t\ttimes[id] += nowtime - ((last[0] > last[id]) ? last[0] : last[id]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\texist[id] = 0;\n\t\t\t}\n\t\t\tlast[id] = nowtime;\n\t\t}\n\t\tfor (int i = 1; i <= 1000; i++)\n\t\t{\n\t\t\tif (times[i] >= maxtime)\n\t\t\t{\n\t\t\t\tmaxtime = times[i];\n\t\t\t}\n\t\t}\n\t\tcout << maxtime << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<map>\n#include<vector>\nusing namespace std;\n\nconst int maxn = 5e5;\nvector<int> g[maxn];\nint etr[1100], res[1100];\nvector<int> god;\nint d[13] = {0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};\n\nint trans(int M, int D, int h, int m){\n    int ans = 0;\n    for(int i = 1; i < M; i++)\n        ans += d[i] * 24 * 60;\n    ans += (D - 1) * 24 * 60 + h * 60 + m;\n    return ans;\n}\nint main(){\n    int n;\n    int M, D, h, m, p;\n    char op[5];\n    while(~scanf(\"%d\", &n), n){\n        for(int i = 0; i < 1000; i++) g[i].clear();\n        god.clear();\n        memset(res, 0, sizeof(res));\n        while(n--){\n            scanf(\"%d/%d %d:%d %s %d\", &M, &D, &h, &m, op, &p);\n            if(op[0] == 'O'){\n                int l = trans(M, D, h, m);\n                if(p){\n                    for(int i = etr[p]; i < l; i++)\n                        g[i].push_back(p);\n                }else{\n                    for(int i = etr[p]; i < l; i++)\n                        god.push_back(i);\n                }\n            }else{\n                etr[p] = trans(M, D, h, m);\n            }\n        }\n\n        int sz = god.size();\n        for(int i = 0; i < sz; i++){\n            int t = god[i];\n            int l = g[t].size();\n            for(int j = 0; j < l; j++)\n                res[g[t][j]]++;\n        }\n        int _max = 0;\n        for(int i = 1; i < 1000; i++)\n            if(_max < res[i]) _max = res[i];\n\n        printf(\"%d\\n\", _max);\n\n    }\n}\n\n/*\n14\n04/21 09:00 I 000\n04/21 09:00 I 001\n04/21 09:15 I 002\n04/21 09:30 O 001\n04/21 09:45 O 000\n04/21 10:00 O 002\n04/28 09:00 I 003\n04/28 09:15 I 000\n04/28 09:30 I 004\n04/28 09:45 O 004\n04/28 10:00 O 000\n04/28 10:15 O 003\n04/29 20:00 I 002\n04/29 21:30 O 002\n20\n06/01 09:00 I 001\n06/01 09:15 I 002\n06/01 09:15 I 003\n06/01 09:30 O 002\n06/01 10:00 I 000\n06/01 10:15 O 001\n06/01 10:30 I 002\n06/01 10:45 O 002\n06/01 11:00 I 001\n06/01 11:15 O 000\n06/01 11:30 I 002\n06/01 11:45 O 001\n06/01 12:00 O 002\n06/01 12:15 I 000\n06/01 12:30 I 002\n06/01 12:45 O 000\n06/01 13:00 I 000\n06/01 13:15 O 000\n06/01 13:30 O 002\n06/01 13:45 O 003\n0\n*/"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <vector>\n#include <cmath>\n#define pi 3.14159265358979323\n#define ll long long\nusing namespace std;\nint a[1005];\nint inpeople[505];\nbool ppp[505];\nstruct node\n{\n    int t1,t2;\n    char ch[5];\n    int num;\n};\nstruct edge\n{\n    int t1,t2;\n    int num;\n    bool p;\n}e[505];\nint main()\n{\n    int n,maxn,num;\n    int m1,d1,m2,d2;\n    node no;\n    while(scanf(\"%d\",&n) && n)\n    {\n        memset(a,0,sizeof(a));\n        memset(e,0,sizeof(e));\n        maxn=0;\n        num=0;\n        m2=d2=0;\n        for(int i=0;i<n;i++)\n        {\n            scanf(\"%d/%d %d:%d %s %d\",&m1,&d1,&no.t1,&no.t2,no.ch,&no.num);\n            if(m1!=m2 || d1!=d2)\n            {\n                num=0;\n                m2=m1,d2=d1;\n            }\n            if(no.ch[0]=='I' && no.num==0)\n            {\n                for(int k=0;k<num;k++)\n                {\n                    e[k].t1=no.t1;\n                    e[k].t2=no.t2;\n                }\n                i++;\n                for(;i<n;i++)\n                {\n                    scanf(\"%d/%d %d:%d %s %d\",&m1,&d1,&no.t1,&no.t2,no.ch,&no.num);\n                    if(m2!=m1 || d1!=d2)\n                    {\n                        m2=m1,d2=d1;\n                        for(int j=0;j<num;j++)\n                        {\n                            if(e[j].p==false) continue;\n                            a[e[j].num ]+=((24-e[j].t1)*60-e[j].t2);\n                        }\n                        num=0;\n                        e[num].t1=no.t1;\n                        e[num].t2=no.t2;\n                        e[num].num=no.num;\n                        e[num].p=true;\n                        num++;\n                        break;\n                    }\n                    if(i==n-1)\n                    {\n                        for(int j=0;j<num;j++)\n                        {\n                            if(e[j].p==false) continue;\n                            a[e[j].num ]+=((24-e[j].t1)*60-e[j].t2);\n                        }\n                        break;\n                    }\n                    if(no.ch[0]=='O' && no.num==0)\n                    {\n                        for(int j=0;j<num;j++)\n                        {\n                            if(e[j].p==false) continue;\n                            a[e[j].num ]+=((no.t1-e[j].t1)*60+no.t2-e[j].t2);\n                        }\n\n                        break;\n                    }\n                    if(no.ch[0]=='I')\n                    {\n                        e[num].t1=no.t1;\n                        e[num].t2=no.t2;\n                        e[num].num=no.num;\n                        e[num].p=true;\n                        num++;\n                    }\n                    else{\n                        for(int j=0;j<num;j++)\n                        {\n                            if(e[j].num == no.num)\n                            {\n\n                                a[no.num]+=((no.t1-e[j].t1)*60+no.t2-e[j].t2);\n                                e[j].p=false;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n            else if(no.ch[0]=='I')\n            {\n                e[num].t1=no.t1;\n                e[num].t2=no.t2;\n                e[num].num=no.num;\n                e[num].p=true;\n                num++;\n            }\n            else\n            {\n                for(int j=0;j<num;j++)\n                {\n                    if(no.num==e[j].num)\n                    {\n                        e[j].p=false;\n                    }\n                }\n            }\n        }\n        for(int i=0;i<1000;i++)\n            if(maxn < a[i]) maxn=a[i];\n        cout<<maxn<<endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef int Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n//#define mt make_tuple\n//typedef tuple<double,int,double> tp;\n//typedef vector<tp> vt;\ntemplate<typename A,typename B>bool cmin(A &a,const B &b){return a>b?(a=b,true):false;}\ntemplate<typename A,typename B>bool cmax(A &a,const B &b){return a<b?(a=b,true):false;}\nconst double PI=acos(-1);\nconst double EPS=1e-7;\nDef inf=sizeof(Def)==sizeof(long long)?2e18:1e9;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\nint main(){\n\tint n;\n\twhile(cin>>n,n){\n\t\tmap<string,pii>ma;\n\t\tbool h=false;int t0=0;\n\t\trep(i,n){\n\t\t\tstring a,b,c;\n\t\t\tcin>>a>>a>>b>>c;\n\t\t\tint t=60*stoi(a.substr(0,2))+stoi(a.substr(3,2));\n\t\t\tif(c==\"000\"){\n\t\t\t\th^=1;\n\t\t\t\tif(h==false)\n\t\t\t\t\tfor(auto j=ma.begin();j!=ma.end();j++)if(j->second.second){\n\t\t\t\t\t\tj->second.first+=t-max(t0,j->second.second);\n\t\t\t\t\t}\n\t\t\t\tt0=t;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(b==\"I\") ma[c].second=t;\n\t\t\telse{\n\t\t\t\tif(h)ma[c].first+=t-max(t0,ma[c].second);\n\t\t\t\tma[c].second=0;\n\t\t\t}\n\t\t}\n\t\tint out=0;\n\t\tfor(auto i=ma.begin();i!=ma.end();i++)out=max(out,i->second.first);\n\t\tcout<<out<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "////////////////////////////////////////\n///  tu3 pro-con template            ///\n////////////////////////////////////////\n#include \"bits/stdc++.h\"\nusing namespace std;\n\n// -- loop macros -- //\n#define REP(i,n) for (int i = 0; i < (n); i++)\n#define RREP(i,n) for (int i = (n)-1; i >= 0; i--)\n#define FOR(i,s,n) for (int i = (int)(s); i < (n); i++)\n#define RFOR(i,s,n) for (int i = (n)-1; i >= (s); i--)\n#define FOREACH(i,container) for (auto &&i : container)\n#define allof(c) c.begin(), c.end()\n#define partof(c,i,n) c.begin() + (i), c.begin() + (i) + (n)\n\n// -- functors -- //\n#define PREDICATE(t,a,exp) [&](const t & a) -> bool { return exp; }\n#define COMPARISON(t,a,b,exp) [&](const t & a, const t & b) -> bool { return exp; }\n\n#define PRED(a,exp) [&](const auto & a) -> bool { return exp; }\n#define COMP(a,b,exp) [&](const auto & a, const auto & b) -> bool { return exp; }\n#define CONV1(a,exp) [&](const auto & a) -> auto { return exp; }\n#define CONV2(a,b,exp) [&](const auto & a, const auto & b) -> auto { return exp; }\n#define CONV3(a,b,c,exp) [&](const auto & a, const auto & b, const auto & c) -> auto { return exp; }\n\n// -- typedefs -- //\n#define EPS 1e-9\n\ntypedef unsigned int uint;\ntypedef long long llong;\ntypedef unsigned long long ullong;\n\n// -- I/O Helper -- //\nstruct _Reader { _Reader(istream &cin) :cin(cin) {} istream &cin; template <class T> _Reader operator ,(T &rhs) { cin >> rhs; return *this; } };\nstruct _Writer { _Writer(ostream &cout) :cout(cout) {} ostream &cout; bool f{ false }; template <class T> _Writer operator ,(const T &rhs) { cout << (f ? \" \" : \"\") << rhs; f = true; return *this; } };\n#define READ(t,...) t __VA_ARGS__; (_Reader{cin}), __VA_ARGS__\n#define WRITE(...) (_Writer{cout}), __VA_ARGS__; cout << '\\n'\n#define DEBUG(...) (_Writer{cerr}), __VA_ARGS__; cerr << '\\n'\n\n// -- vevector -- //\ntemplate <class T> struct vevector : public vector<vector<T>> { vevector(size_t n = 0, size_t m = 0, const T &initial = T()) : vector<vector<T>>(n, vector<T>(m, initial)) { } };\ntemplate <class T> struct vevevector : public vector<vevector<T>> { vevevector(size_t n = 0, size_t m = 0, size_t l = 0, const T &initial = T()) : vector<vevector<T>>(n, vevector<T>(m, l, initial)) { } };\ntemplate <class T> struct vevevevector : public vector<vevevector<T>> { vevevevector(size_t n = 0, size_t m = 0, size_t l = 0, size_t k = 0, const T &initial = T()) : vector<vevevector<T>>(n, vevevector<T>(m, l, k, initial)) { } };\n\nnamespace std {\n\ttemplate <class T1, class T2> inline istream & operator >> (istream & in, pair<T1, T2> &p) { in >> p.first >> p.second; return in; }\n\ttemplate <class T1, class T2> inline ostream & operator << (ostream &out, const pair<T1, T2> &p) { out << p.first << \" \" << p.second; return out; }\n}\n\ntemplate <class T> T read() { T t; cin >> t; return t; }\ntemplate <class T> vector<T> read(int n) { vector<T> v; REP(i, n) { v.push_back(read<T>()); } return v; }\ntemplate <class T> vevector<T> read(int n, int m) { vevector<T> v; REP(i, n) v.push_back(read<T>(m)); return v; }\ntemplate <class T> vector<T> readjag() { return read<T>(read<int>()); }\ntemplate <class T> vevector<T> readjag(int n) { vevector<T> v; REP(i, n) v.push_back(readjag<T>()); return v; }\n\ntemplate <class T> struct iter_pair_t { T beg, end; };\ntemplate <class T> iter_pair_t<T> iter_pair(T beg, T end) { return iter_pair_t<T>{beg, end}; }\ntemplate <class T> ostream & operator << (ostream &out, iter_pair_t<T> v) { if (v.beg != v.end) { out << *v.beg++; while (v.beg != v.end) { out << \" \" << *v.beg++; } } return out; }\ntemplate <class T1> ostream & operator << (ostream &out, const vector<T1> &v) { return out << iter_pair(begin(v), end(v)); }\n\n// -- etc -- //\ntemplate <class T> T infinity_value();\n#define DEFINE_INFINITY_VALUE(T, val) template <> constexpr T infinity_value<T>() { return (val); }\nDEFINE_INFINITY_VALUE(int, 1 << 28);\nDEFINE_INFINITY_VALUE(uint, 1u << 28);\nDEFINE_INFINITY_VALUE(llong, 1ll << 60);\nDEFINE_INFINITY_VALUE(ullong, 1ull << 60);\nDEFINE_INFINITY_VALUE(double, HUGE_VAL);\nDEFINE_INFINITY_VALUE(float, HUGE_VAL);\n#define INF(T) infinity_value<T>()\n\ninline int sign_of(double x) { return (abs(x) < EPS ? 0 : x > 0 ? 1 : -1); }\ntemplate <class TInt> bool in_range(TInt val, TInt min, TInt max) { return val >= min && val < max; }\ntemplate <> bool in_range<double>(double val, double min, double max) { return val - min > -EPS && val - max < EPS; }\ntemplate <> bool in_range<float>(float val, float min, float max) { return val - min > -EPS && val - max < EPS; }\ntemplate <class TInt> bool in_range2d(TInt x, TInt y, TInt w, TInt h) { return x >= 0 && x < w && y >= 0 && y < h; }\nvector<int> iotavn(int start, int count) { vector<int> r(count); iota(allof(r), start);\treturn r; }\n\n//// start up ////\nvoid solve();\nint main()\n{\n\t//// for local debugging\n\t//freopen(\"input.txt\", \"r\", stdin);\n\t//freopen(\"output.txt\", \"w\", stdout);\n\n\tauto classic_table = ctype<char>::classic_table();\n\tvector<ctype<char>::mask> ctable(classic_table, classic_table + ctype<char>::table_size);\n\tctable[':'] |= ctype_base::space; // as delimitor\n\tctable['/'] |= ctype_base::space; // as delimitor\n\tcin.imbue(locale(cin.getloc(), new ctype<char>(ctable.data())));\n\n\tcin.tie(nullptr);\n\tios_base::sync_with_stdio(false);\n\tcout << fixed;\n\tcout << setprecision(std::numeric_limits<double>::max_digits10);\n\tsolve();\n\n\treturn 0;\n}\n\n////////////////////\n/// template end ///\n////////////////////\n\nvoid solve()\n{\n\twhile (true)\n\t{\n\t\tREAD(int, N);\n\t\tif (!N) { break; }\n\n\t\tmap<int, int> blessedTime;\n\t\tmap<int, int> inTime;\n\n\t\tREP(_, N)\n\t\t{\n\t\t\tREAD(int, MM, DD, h, m);\n\t\t\tREAD(char, e);\n\t\t\tREAD(int, p);\n\t\t\tint now = h * 60 + m;\n\t\t\tif (e == 'I')\n\t\t\t{\n\t\t\t\tinTime[p] = now;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (p == 0)\n\t\t\t\t{\n\t\t\t\t\tFOREACH(pg, inTime)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (pg.first != 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tblessedTime[pg.first] += now - max(inTime[pg.first], inTime[0]);\n\t\t\t\t\t\t\t//DEBUG(pg.first, \"blessed\", now - max(inTime[pg.first], inTime[0]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif  (inTime.count(0))\n\t\t\t\t\t{\n\t\t\t\t\t\tblessedTime[p] += now - max(inTime[p], inTime[0]);\n\t\t\t\t\t\t//DEBUG(p, \"blessed\", now - max(inTime[p], inTime[0]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tinTime.erase(p);\n\t\t\t}\n\t\t}\n\n\t\tint maxBlessed = 0;\n\t\tFOREACH(p, blessedTime)\n\t\t{\n\t\t\tif (maxBlessed < p.second)\n\t\t\t{\n\t\t\t\tmaxBlessed = p.second;\n\t\t\t}\n\t\t}\n\t\tWRITE(maxBlessed);\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long   // <-----!!!!!!!!!!!!!!!!!!!\n\n#define rep(i,n) for (int i=0;i<(n);i++)\n#define rep2(i,a,b) for (int i=(a);i<(b);i++)\n#define rrep(i,n) for (int i=(n)-1;i>=0;i--)\n#define rrep2(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n\ntypedef long long ll;\ntypedef pair<int, int> Pii;\ntypedef tuple<int, int, int> TUPLE;\ntypedef vector<int> V;\ntypedef vector<V> VV;\ntypedef vector<VV> VVV;\n\nstruct Range {\n    string d;\n    int l, r;\n    int id;\n};\n\nint convTime(string s) {\n    int ret = 0;\n    stringstream ss(s);\n    string t;\n    while (getline(ss, t, ':')) {\n        ret *= 60;\n        ret += stoi(t);\n    }\n    return ret;\n}\n\nint common(const Range &a, const Range &b) {\n    if (a.d != b.d) return 0;\n    if (b.id == 0) return 0;\n    int l = max(a.l, b.l);\n    int r = min(a.r, b.r);\n    return max(0LL, r - l);\n}\n\nsigned main() {\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(0);\n\n    int n;\n    while (cin >> n, n) {\n        vector<stack<int>> v(1000);\n        vector<Range> u;\n        rep(i, n) {\n            string d, hhmm, e;\n            int id;\n            cin >> d >> hhmm >> e >> id;\n            int m = convTime(hhmm);\n            if (v[id].empty()) {\n                assert(e == \"I\");\n                v[id].push(m);\n            } else {\n                assert(e == \"O\");\n                int s = v[id].top(); v[id].pop();\n                u.emplace_back((Range){d, s, m, id});\n            }\n        }\n\n        V len(1000, 0);\n        for (auto a : u) {\n            if (a.id == 0) {\n                for (auto b : u) {\n                    len[b.id] += common(a, b);\n                }\n            }\n        }\n\n        cout << *max_element(all(len)) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cassert>\n#include <algorithm>\n#include <iostream>\n#include <vector>\n#include <map>\nusing namespace std;\n\n#define LET(name, value) __typeof(value) name = value\n#define REP(i, n) for (int i = 0; i < (int)(n); ++i)\n#define FOR(i, a, b) for (int i = (a); i < (int)(b); ++i)\n#define FOREQ(i, a, b) for (int i = (a); i <= (int)(b); ++i)\n#define ALL(c) (c).begin(), (c).end()\n#define FOREACH(i, c) for (LET(i, (c).begin()); i != (c).end(); ++i)\n\nint main() {\n  int n;\n  while (scanf(\"%d\", &n), n) {\n    map<int, int> id2time, id2power;\n    REP(i, n) {\n      int M, D, h, m, id; char e;\n      scanf(\"%d/%d %d:%d %c %d\", &M, &D, &h, &m, &e, &id);\n      int time = m + 60 * h;\n      if (e == 'I') {\n        id2time.insert(make_pair(id, time));\n      } else if (e == 'O') {\n        int i_time = id2time[id], o_time = time;\n        if (id == 0) {\n          FOREACH(it, id2time) {\n            if (it->first != 0) {\n              id2power[it->first] += o_time - max(i_time, it->second);\n            }\n          }\n        } else {\n          LET(goddess, id2time.find(0));\n          if (goddess != id2time.end()) {\n            id2power[id] += o_time - max(i_time, goddess->second);\n          }\n        }\n        id2time.erase(id);\n      } else {\n        assert(false);\n      }\n    }\n    int ans = 0;\n    FOREACH(it, id2power) { ans = max(ans, it->second); }\n    printf(\"%d\\n\", ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define each(itr,v) for(auto itr:v)\n#define pb(s) push_back(s)\n#define mp(a,b) make_pair(a,b)\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define maxch(x,y) x=max(x,y)\n#define minch(x,y) x=min(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt(x) bitset<32>(x).count()\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> P;\ntypedef pair<P, int> PPI;\ntypedef pair<ll, ll> PL;\ntypedef pair<P, ll> PPL;\n\n#define INF INT_MAX/3\n\n#define MAX_N 1000\n\nstruct data{\n\tstring date;\n\tint tin,tout;\n};\n\nint n;\nvector<data> vis[1111];\nint sum[1111];\n\nint gettime(string t){\n\treturn stoi(t.substr(0,2))*60+stoi(t.substr(3,2));\n}\n\nint main(){\n\tcin.sync_with_stdio(false);\n\twhile(1){\n\t\tcin>>n;\n\t\tif(n==0)break;\n\t\trep(i,1111)vis[i].clear();\n\t\tmemset(sum,0,sizeof(sum));\n\t\trep(i,n){\n\t\t\tstring date,time;\n\t\t\tchar e; int id;\n\t\t\tcin>>date>>time>>e>>id;\n\t\t\tif(e=='I'){\n\t\t\t\tvis[id].push_back((data){date,gettime(time),INF});\n\t\t\t}else if(e=='O'){\n\t\t\t\tvis[id][vis[id].size()-1].tout=gettime(time);\n\t\t\t}\n\t\t}\n\t\trepl(i,1,1000){\n\t\t\trep(j,vis[0].size())rep(k,vis[i].size()){\n\t\t\t\tdata d1=vis[0][j],d2=vis[i][k];\n\t\t\t\tif(d1.date!=d2.date)continue;\n\t\t\t\tsum[i]+=max(0,min(d1.tout,d2.tout)-max(d1.tin,d2.tin));\n\t\t\t}\n\t\t}\n\t\tcout<<*max_element(sum,sum+1000)<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <sstream>\n#include <cstring>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n#include <numeric>\n#include <cctype>\n#include <cassert>\n\n// BEGIN CUT HERE\n#ifdef _MSC_VER\n#include <agents.h>\n#endif\n// END CUT HERE \n\n#define FOR(i, a, b) for(int i = (a); i < (int)(b); ++i)\n#define rep(i, n) FOR(i, 0, n)\n#define ALL(v) v.begin(), v.end()\n#define REV(v) v.rbegin(), v.rend()\n#define MEMSET(v, s) memset(v, s, sizeof(v))\n#define MP make_pair\n#define MT make_tuple\n#define X first\n#define Y second\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> P;\n\n\n\nint main(){\n\tint n;\n\twhile (cin >> n, n){\n\t\tmap<string, map<int, vector<int>>> in, out;\n\t\tset<string> st;\n\t\trep(i, n){\n\t\t\tstring s;\n\t\t\tchar c;\n\t\t\tint h, m, id;\n\t\t\tcin >> s >> h >> c >> m >> c >> id;\n\t\t\tif (c == 'I') in[s][id].push_back(h * 60 + m);\n\t\t\tif (c == 'O') out[s][id].push_back(h * 60 + m);\n\t\t\tst.insert(s);\n\t\t}\n\t\tmap<int, int> m;\n\t\tfor (auto date : st){\n\t\t\tauto mpin = in[date];\n\t\t\tauto mpout = out[date];\n\t\t\tif (!mpin.count(0)) continue;\n\t\t\tvector<int> &gin = mpin[0], &gout = mpout[0];\n\t\t\trep(i, gin.size()){\n\t\t\t\tfor (auto x : mpin){\n\t\t\t\t\tint sum = 0;\n\t\t\t\t\tif (x.first == 0) continue;\n\t\t\t\t\tvector<int> &vin = mpin[x.first], &vout = mpout[x.first];\n\t\t\t\t\trep(j, vin.size()){\n\t\t\t\t\t\tint t = max(min(gout[i], vout[j]) - max(gin[i], vin[j]), 0);\n\t\t\t\t\t\tsum += t;\n\t\t\t\t\t}\n\t\t\t\t\tm[x.first] += sum;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans = 0;\n\t\tfor (auto p : m) ans = max(ans, p.second);\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n#include <queue>\n#include <vector>\ntypedef long long int ll;\n#define BIG_NUM 2000000000\n#define MOD NUM000007\n#define EPS 0.0000001\n#define NUM 1440\nusing namespace std;\n\nstruct Info{\n\tvoid init(){\n\t\tlatest_in = 0;\n\t\tsum = 0;\n\t\texist = false;\n\t}\n\n\tint latest_in,sum;\n\tbool exist;\n};\n\nInfo info[1000];\nchar buf[20];\nint pg_num,pg_id[1000];\n\n\nint getDate(){\n\treturn 1000*(buf[0]-'0')+100*(buf[1]-'0')+10*(buf[3]-'0')+(buf[4]-0);\n}\n\nint getTime(){\n\treturn 60*(10*(buf[6]-'0')+(buf[7]-'0'))+10*(buf[9]-'0')+(buf[10]-'0');\n}\n\nint getID(){\n\treturn 100*(buf[14]-'0')+10*(buf[15]-'0')+(buf[16]-'0');\n}\n\nbool isFirst(int id){\n\n\tfor(int i = 0; i < pg_num; i++){\n\t\tif(pg_id[i] == id)return false;\n\t}\n\treturn true;\n}\n\nint main(){\n\n\tint N,maximum,pre_date,tmp_date,tmp_time,id;\n\n\twhile(true){\n\t\tscanf(\"%d\",&N);\n\t\tif(N == 0)break;\n\n\t\tinfo[0].init();\n\t\tfor(int i = 0; i < pg_num; i++)info[pg_id[i]].init();\n\t\tpg_num = 0;\n\n\t\tgetchar();\n\t\tfgets(buf,20,stdin);\n\n\t\tpre_date = getDate();\n\t\ttmp_time = getTime();\n\t\tid = getID();\n\n\t\tinfo[id].exist = true;\n\t\tinfo[id].latest_in = tmp_time;\n\t\tif(id != 0){\n\t\t\tpg_id[pg_num++] = id;\n\t\t}\n\n\t\tfor(int loop = 1; loop <= N-1; loop++){\n\t\t\tfgets(buf,20,stdin);\n\t\t\ttmp_date = getDate();\n\t\t\ttmp_time = getTime();\n\t\t\tid = getID();\n\n\t\t\tif(tmp_date != pre_date){\n\n\t\t\t\tif(info[0].exist){\n\n\t\t\t\t\tfor(int i = 0; i < pg_num; i++){\n\t\t\t\t\t\tif(info[pg_id[i]].exist){\n\n\t\t\t\t\t\t\tinfo[pg_id[i]].sum += NUM - max(info[pg_id[i]].latest_in,info[0].latest_in);\n\t\t\t\t\t\t\tinfo[pg_id[i]].exist = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tinfo[0].exist = false;\n\t\t\t\t}else{\n\n\t\t\t\t\tfor(int i = 0; i < pg_num; i++){\n\t\t\t\t\t\tinfo[pg_id[i]].exist = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tinfo[id].exist = true;\n\t\t\t\tinfo[id].latest_in = tmp_time;\n\t\t\t\tif(id != 0){\n\t\t\t\t\tif(isFirst(id)){\n\t\t\t\t\t\tpg_id[pg_num++] = id;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}else{\n\n\t\t\t\tif(buf[12] == 'I'){\n\n\t\t\t\t\tinfo[id].exist = true;\n\t\t\t\t\tinfo[id].latest_in = tmp_time;\n\t\t\t\t\tif(id != 0){\n\t\t\t\t\t\tif(isFirst(id)){\n\t\t\t\t\t\t\tpg_id[pg_num++] = id;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}else{\n\n\t\t\t\t\tif(id == 0){\n\t\t\t\t\t\tinfo[0].exist = false;\n\n\t\t\t\t\t\tfor(int i = 0; i < pg_num; i++){\n\t\t\t\t\t\t\tif(info[pg_id[i]].exist){\n\t\t\t\t\t\t\t\tinfo[pg_id[i]].sum += tmp_time - max(info[0].latest_in,info[pg_id[i]].latest_in);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}else{\n\t\t\t\t\t\tinfo[id].exist = false;\n\n\t\t\t\t\t\tif(info[0].exist){\n\t\t\t\t\t\t\tinfo[id].sum += tmp_time - max(info[0].latest_in,info[id].latest_in);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t//Do nothing\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tpre_date = tmp_date;\n\t\t}\n\n\t\tmaximum = 0;\n\t\tfor(int i = 0; i < pg_num; i++){\n\t\t\tmaximum = max(maximum,info[pg_id[i]].sum);\n\t\t}\n\n\t\tprintf(\"%d\\n\",maximum);\n\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,x,y) for(int i=(x);i<(y);++i)\n#define debug(x) #x << \"=\" << (x)\n\n#ifdef DEBUG\n#define _GLIBCXX_DEBUG\n#define print(x) std::cerr << debug(x) << \" (L:\" << __LINE__ << \")\" << std::endl\n#else\n#define print(x)\n#endif\n\nconst int inf=1e9;\nconst int64_t inf64=1e18;\nconst double eps=1e-9;\n\ntemplate <typename T> ostream &operator<<(ostream &os, const vector<T> &vec){\n    os << \"[\";\n    for (const auto &v : vec) {\n    \tos << v << \",\";\n    }\n    os << \"]\";\n    return os;\n}\n\nstruct S{\n    string date;\n    int begin,end;\n    \n    S(){}\n    \n    S(string s,int b,int e)\n    {\n        date=s;\n        begin=b;\n        end=e;\n    }\n};\n\nvoid solve(int n){\n    vector<S> data[500];\n    vector<int> ans(500,0);\n    \n    rep(i,0,n){\n        string d;\n        cin>>d;\n        \n        string temp;\n        cin>>temp;\n        \n        int time=(temp[0]-'0')*600+(temp[1]-'0')*60+(temp[3]-'0')*10+(temp[4]-'0');\n        \n        string io;\n        cin>>io;\n        \n        string sid;\n        cin>>sid;\n        \n        int id=(sid[0]-'0')*100+(sid[1]-'0')*10+(sid[2]-'0');\n        \n        if(io==\"I\"){\n            data[id].push_back(S(d,time,0));\n        }else{\n            data[id][data[id].size()-1].end=time;\n        }\n    }\n    \n    rep(i,1,500){\n        rep(j,0,data[0].size()){\n            rep(k,0,data[i].size()){\n                if(data[0][j].date!=data[i][k].date){\n                    continue;\n                }\n                \n                int t_begin=max(data[0][j].begin,data[i][k].begin);\n                int t_end=min(data[0][j].end,data[i][k].end);\n                int t_ans=max(0,t_end-t_begin);\n                \n                ans[i]+=t_ans;\n            }\n        }\n    }\n    \n    int answer=0;\n    \n    rep(i,0,500){\n        answer=max(answer,ans[i]);\n    }\n    \n    cout<<answer<<endl;\n}\n\nint main(){\n    std::cin.tie(0);\n    std::ios::sync_with_stdio(false);\n    cout.setf(ios::fixed);\n    cout.precision(10);\n    \n    while(true){\n        int n;\n        cin>>n;\n        \n        if(n==0) break;\n        \n        solve(n);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<vector>\n#include<map>\nusing namespace std;\n\ntypedef pair<int,int> P;\n\nint time[1000];\nint mon,day,h,m,p,tm,td;\nchar e;\nvector<P> en[1000],ex[1000];\n\nint cal(P a){return a.first*60+a.second;}\n\nint common(int x){\n  int res = 0;\n  for(int i=0;i<(int)en[0].size();i++){\n    for(int j=0;j<(int)en[x].size();j++){\n      if(ex[x][j]<en[0][i] || ex[0][i]<en[x][j])continue;\n      if(en[x][j]<=en[0][i])\n\tif(ex[x][j]<=ex[0][i])res += cal(ex[x][j]) - cal(en[0][i]);\n\telse res += cal(ex[0][i]) - cal(en[0][i]);\n      else\n\tif(ex[x][j]<=ex[0][i])res += cal(ex[x][j]) - cal(en[x][j]);\n\telse res += cal(ex[0][i]) - cal(en[x][j]);\n    }\n  }\n  return res;\n}\n\nint main(){\n  int n;\n  while(scanf(\"%d\",&n) && n){\n    for(int i=0;i<1000;i++)time[i] = 0;\n    tm = 0;\n    td = 0;\n\n    for(int i=0;i<n;i++){\n      scanf(\"%d/%d %d:%d %c %d\",&mon,&day,&h,&m,&e,&p);\n      if(tm!=mon || td!=day){\n\tif(en[0].size()){\n\t  for(int i=1;i<n;i++)\n\t    if(en[i].size())time[i] += common(i);\n\t}\n\tfor(int i=0;i<n;i++){\n\t  en[i].clear();\n\t  ex[i].clear();\n\t}\n\ttm = mon;td = day;\n      }\n      if(e=='I')en[p].push_back(P(h,m));\n      else ex[p].push_back(P(h,m));\n    }\n    if(en[0].size()){\n      for(int i=1;i<n;i++)\n\tif(en[i].size())time[i] += common(i);\n    }\n    int ans = 0;\n    for(int i=1;i<n;i++)ans = max(ans,time[i]);\n    printf(\"%d\\n\",ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <vector>\n#include <map>\n\nint testcase_ends() {\n  int n;\n  scanf(\"%d\", &n);\n\n  if (n == 0)\n    return 1;\n\n  std::vector<int> total(1000);\n  std::vector<int> prog(1000, -1);\n  int lastday=0;\n  bool blessed=false;\n\n  for (int i=0; i<n; ++i) {\n    int M, D, h, m, p;\n    char e;\n    scanf(\"%d/%d %d:%d %c %d\", &M, &D, &h, &m, &e, &p);\n    \n    int today=100*M+D;\n    if (lastday != today) {\n      prog.assign(1000, -1);\n      lastday = today;\n    }\n\n    int time=60*h+m;\n\n    //fprintf(stderr, \"%02d/%02d %02d:%02d\\n\", M, D, h, m);\n    if (p == 0) {\n      if (e == 'I') {\n\tblessed = true;\n\tfor (int j=1; j<1000; ++j) {\n\t  if (prog[j] >= 0) {\n\t    prog[j] = time;\n\t  }\n\t}\n      } else if (e == 'O') {\n\tblessed = false;\n\tfor (int j=1; j<1000; ++j) {\n\t  if (prog[j] >= 0) {\n\t    total[j] += time - prog[j];\n\t    //fprintf(stderr, \"0 %d: +%02d\\n\", j, time-prog[j]);\n\t    prog[j] = time;\n\t  }\n\t}\n      }\n\n      continue;\n    }\n\n\n    if (e == 'I') {\n      prog[p] = time;\n    } else if (e == 'O') {\n      if (blessed) {\n\ttotal[p] += time - prog[p];\n\t//fprintf(stderr, \"1 %d: +%02d\\n\", p, time-prog[p]);\n      }\n      prog[p] = -1;\n    }\n  }\n\n  printf(\"%d\\n\", *std::max_element(total.begin()+1, total.end()));\n  return 0;\n}\n\nint main() {\n  while (!testcase_ends()) {}\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <vector>\n#include <string.h>\n#include <algorithm>\n#include <utility>\n#include <set>\n#include <map>\n#include <deque>\n#include <queue>\n#include <cmath>\n#include <cstdlib>\n#include <ctime>\n#include <cstdio>\n#include <stdio.h>\n\nusing namespace std;\n\n#define fo(i,n) for(int i=0; i<(int)n; i++)\n#define rep(it,s) for(__typeof((s).begin()) it=(s).begin();it!=(s).end();it++)\n#define mp(a,b) make_pair(a,b)\n#define pb(x) push_back(x)\n#define pii pair<int,int>\n\nint n;\nvector<int> t[1010];\nvector<int> vis;\nint sum[1010];\nint v[1445];\nvoid update(int x) {\n    for(;x<=1441; x+=x&-x) v[x]++;\n}\nint get(int x) {\n    int s = 0;\n    for (;x>=1; x-=x&-x) s+=v[x];\n    return s;\n}\n\nint parse(string s) {\n    string h = s.substr(0,2);\n    string m = s.substr(3,2);\n    return atoi(h.c_str())*60 + atoi(m.c_str());\n}\n\nint main() {\n\n    //freopen(\"input.txt\",\"r\",stdin);\n    //freopen(\"output.txt\",\"w\",stdout);\n\n    while (cin>>n && n!=0) {\n        string s, last;\n        cin>>last;\n        s = last;\n        for (int i=0; i<1000; i++) sum[i] = 0;\n        for (int i=0; i<=n; i++) {\n            if (i!=0 && i!=n) cin>>s;\n            if (last!=s || i==0 || i==n) {\n\n                if (i!=0) {\n                    for (int j=0; j<t[0].size(); j+=2) {\n                        for (int k=t[0][j]; k<t[0][j+1]; k++) update(k);\n                    }\n                    for (int j=1; j<1000; j++) {\n                        for (int k=0; k<t[j].size(); k+=2) sum[j] += get(t[j][k+1]-1) - get(t[j][k]-1);\n                    }\n                }\n\n                for (int j=0; j<1445; j++) v[j] = 0;\n                for (int j=0; j<vis.size(); j++) t[vis[j]].clear();\n                vis.clear();\n\n                if (i==n) break;\n\n                last = s;\n\n            }\n            string hour;\n            cin>>hour;\n            int tmp = parse(hour);\n            cin>>hour;\n            string id;\n            cin>>id;\n            vis.push_back(atoi(id.c_str()));\n            t[atoi(id.c_str())].push_back(tmp);\n        }\n\n        int m = 0;\n        for (int i=1; i<1000; i++) m = max(m, sum[i]);\n        printf(\"%d\\n\",m);\n    }\n\n    return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <cassert>\n#include <memory>\n#include <time.h>\nusing namespace std;\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n) FOR(i,0,n)\nconst double EPS = 1e-9;\nconst double PI  = acos(-1.0);\n \n \nstruct programmer{\n    int score,presence;\n    programmer():score(0),presence(0){}\n};\nstruct evnt{\n    int month,date;\n    int hour,min;\n    char inout;\n    int id;\n};\nint main(){\n    int n;\n    while(cin>>n,n){\n        vector<programmer> programmers(1000);\n        int pl=programmers.size();\n        vector<evnt> evnts(n);\n        REP(i,n){\n            char sep;\n            cin>>evnts[i].month>>sep>>evnts[i].date>>evnts[i].hour>>sep>>evnts[i].min>>evnts[i].inout>>evnts[i].id;\n        }\n        FOR(i,1,evnts.size()){\n          if(evnts[i].date!=evnts[i-1].date){\n              evnt e;\n              e.month=evnts[i-1].month;\n              e.date=evnts[i-1].date;\n              e.hour=24;\n              e.min=0;\n              e.inout='C';\n              evnts.insert(evnts.begin()+i,e);\n              i++;\n          }\n        }\n              evnt e;\n              e.month=evnts[evnts.size()-1].month;\n              e.date=evnts[evnts.size()-1].date;\n              e.hour=24;\n              e.min=0;\n              e.inout='C';\n              evnts.push_back(e);\n \n        int prevtime=0;\n        int goddess_presence=0;\n        REP(i,n){\n            int curtime=evnts[i].hour*60+evnts[i].min;\n            if(evnts[i].inout=='C'){\n                REP(j,pl){\n                    if(programmers[j].presence&&goddess_presence){\n                        programmers[j].score+=curtime-prevtime;\n                    }\n                    programmers[j].presence=0;\n                }\n                goddess_presence=0;\n                prevtime=0;\n            }else if(evnts[i].id==0){\n                if(evnts[i].inout=='O'){\n                    REP(j,pl){\n                        if(programmers[j].presence){\n                            programmers[j].score+=curtime-prevtime;\n                        }\n                    }\n                }\n                goddess_presence=evnts[i].inout=='I';\n                prevtime=curtime;\n            }else{\n                if(goddess_presence){\n                    REP(j,pl){\n                        if(programmers[j].presence){\n                            programmers[j].score+=curtime-prevtime;\n                        }\n                    }\n                }\n                programmers[evnts[i].id].presence=evnts[i].inout=='I';\n                prevtime=curtime;\n            }\n            //cerr<<curtime<<\"*\"<<evnts[i].month<<evnts[i].date<<\"-\"<<evnts[i].hour<<\":\"<<evnts[i].min<<\"= \";\n            //FOR(j,1,5){\n            //  cerr<<programmers[j].score<<\",\";\n            //}\n            //cerr<<endl;\n        }\n        int ans=0;\n        REP(i,pl){\n            ans=max(ans,programmers[i].score);\n        }\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <map>\n#include <algorithm>\n#include <vector>\n#include <memory.h>\nusing namespace std;\n\n#define Mon 35\n#define DAY 1440\n#define rep(i, n) for(int i = 0; i < n; i++)\n\nmap<string, int> id;\nint cnt[1000];\nvector<int> log[1000];\nbool present[12*Mon*DAY];\n\nint get_m(string day, string t){\n  int d = (day[0]-'0')*10+(day[1]-'0')*Mon+(day[3]-'0')*10+(day[4]-'0');\n  int m = ((t[0]-'0')*10+(t[1]-'0'))*60+(t[3]-'0')*10+(t[4]-'0');\n  return d * DAY + m;\n}\n\nint main(){\n  string day, tim, in, ID;\n  int n, num;\n  while(cin >> n && n){\n    num = 1;\n    int res = 0;\n    \n    memset(cnt, 0, sizeof(cnt));\n    memset(present, false, sizeof(present));\n\n    rep(i, n){\n      cin >> day >> tim >> in >> ID;\n      if(id[ID] == 0) id[ID] = num++;\n      log[id[ID]].push_back(get_m(day, tim));\n    }\n    int gd = id[\"000\"];\n    int sz = log[gd].size()/2;\n    rep(i, sz){\n      int s = log[gd][2*i];\n      int t = log[gd][2*i+1];\n      while(s<t){\n\tpresent[s] = true;\n\ts++;\n      }\n    }\n    for(int i = 1; i < num; i++){\n      if(i == gd) continue;\n      int sz = log[i].size()/2;\n      int c = 0;\n      rep(j, sz){\n\tint s = log[i][j*2];\n\tint t = log[i][j*2+1];\n\twhile(s < t) {\n\t  if(present[s++]) c++;\n\t}\n      }\n      res = max(res, c);\n    }\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//#pragma comment(linker, \"/STACK:1024000000,1024000000\")\n#include <functional>\n#include <algorithm>\n#include <iostream>\n#include <fstream>\n#include <sstream>\n#include <iomanip>\n#include <numeric>\n#include <cstring>\n#include <cassert>\n#include <cstdio>\n#include <string>\n#include <vector>\n#include <bitset>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <ctime>\n#include <list>\n#include <set>\n#include <map>\n\nusing namespace std;\nint tim[1111];\nstruct Date\n{\n  int m,in,id;\n  Date(int mm,int inin,int idid) :\n    m(mm),in(inin),id(idid) {}\n};\nvector<Date> date[13][33];\nvoid clear()\n{\n  for(int i=1;i<=12;i++) {\n    for(int j=1;j<=31;j++) {\n      date[i][j].clear();\n    }\n  }\n  memset(tim,0,sizeof(tim));\n}\nint Time(int i0,int o0,int i1,int o1)\n{\n  int i = max(i0,i1);\n  int o = min(o0,o1);\n  return o-i>0?o-i:0;\n}\nvoid solveDate(vector<Date> & dt)\n{\n  vector<int> in[1111];\n  vector<int> out[1111];\n  for(int i=0;i<dt.size();i++) {\n    if(dt[i].in) in[dt[i].id].push_back(dt[i].m);\n    else out[dt[i].id].push_back(dt[i].m);\n  }\n  for(int i=1;i<1000;i++) {\n    for(int j=0;j<in[i].size();j++) {\n      for(int k=0;k<in[0].size();k++) {\n        tim[i]+=Time(in[0][k],out[0][k],in[i][j],out[i][j]);\n      }\n    }\n  }\n}\nint main() { ///Problem:A\n#ifdef LOCAL\nfreopen(\"./../in\",\"r\",stdin);\n//freopen(\"./../out\",\"w\",stdout);\n#endif\n  int n;\n  while(scanf(\"%d\",&n)==1&&n) {\n    int mm,dd,h,m,id;\n    char in;\n    clear();\n    for(int i=0;i<n;i++) {\n      scanf(\"%d/%d %d:%d %c %d\",&mm,&dd,&h,&m,&in,&id);\n      date[mm][dd].push_back(Date(h*60+m,in=='I',id));\n    }\n    for(int i=1;i<=12;i++) {\n      for(int j=1;j<=31;j++) {\n        if(!date[i][j].empty()) {\n          solveDate(date[i][j]);\n        }\n      }\n    }\n    printf(\"%d\\n\",*max_element(tim,tim+1000));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define scf scanf\n#define ptf printf\n#define forp(i,j,k) for(int i=j;i<k;i++)\n#define form(i,j,k) for(int i=j;i>k;i--)\n#define sz(x) (int)x.size()\n#define pb push_back\n#define fst first\n#define scd second\nusing namespace std;\n\ntypedef long long LL;\ntypedef unsigned long long ULL;\ntypedef long double LD;\n\nchar str[100];\nint hh[2000],mn[2000],sum[2000],num_a,a[10],in[2000];\n\nstruct node\n{\n    int a,b,x,y;\n    node(){}\n    node(int _a,int _b,int _x,int _y)\n    {\n        a=_a;\n        b=_b;\n        x=_x;\n        y=_y;\n    }\n};\n\nvector<node>lis[1010];\n\nchar strtonum(char*s)\n{\n    char res;\n    num_a=0;\n    int t0;\n    for(int i=0;s[i];)\n    {\n        if(s[i]<'0'||s[i]>'9')\n        {\n            if(s[i]=='I'||s[i]=='O')res=s[i];\n            i++;\n            continue;\n        }\n        t0=0;\n        for(;s[i]>='0'&&s[i]<='9';i++)\n            t0=t0*10+(s[i]-'0');\n        a[num_a++]=t0;\n    }\n    return res;\n}\n\nint main()\n{\n    int n;\n    for(scf(\"%d\",&n);n;scf(\"%d\",&n))\n    {\n        memset(sum,0,sizeof(sum));\n        gets(str);\n        forp(i,0,1001)lis[i].clear();\n        forp(i,0,n)\n        {\n            gets(str);\n            if(strtonum(str)=='I')\n                in[a[4]]=a[2]*60+a[3];\n            else\n                lis[a[4]].pb(node(a[0],a[1],in[a[4]],a[2]*60+a[3]));\n        }\n        forp(i,0,sz(lis[0]))\n        {\n            forp(j,1,1001)\n                forp(k,0,sz(lis[j]))\n                    if(lis[j][k].a==lis[0][i].a&&lis[j][k].b==lis[0][i].b&&lis[j][k].x<=lis[0][i].y&&lis[j][k].y>=lis[0][i].x)\n                        sum[j]+=min(lis[0][i].y,lis[j][k].y)-max(lis[0][i].x,lis[j][k].x);\n        }\n        int ans=-1;\n        forp(i,1,1001)\n            ans=max(ans,sum[i]);\n        ptf(\"%d\\n\",ans);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#define\tREP(i,x,n) for(int i=x;i<(int)n;i++)\n#define rep(i,n) REP(i,0,n)\nusing namespace std;\nbool goddess_in;\nint goddess_t;\nint n,hr,mi,p,ans;\nstring date;\nchar move;\nint total[1111];\nint man_t[1111];\nbool man_in[1111];\nvoid solve();\nint main(){\n\twhile(cin>>n&&n){\n\t\tmemset(man_t,0,sizeof(man_t));\n\t\tmemset(man_in,0,sizeof(man_in));\n\t\tmemset(total,0,sizeof(total));\n\t\tgoddess_in=false;\n\t\twhile(n--){\n\t\t\tcin>>date>>hr>>move>>mi>>move>>p;\n\t\t\tsolve();\n\t\t}\n\t\trep(i,1111){if(total[i])ans=max(ans,total[i]);}\n\t\tcout<<ans<<endl;\n\t}\n}\nvoid solve(){\n\tint t=hr*60+mi;\n\tif(move=='I'){\n\t\tif(p==0){\n\t\t\tgoddess_in=true;\n\t\t\tgoddess_t=t;\n\t\t}else{\n\t\t\tman_in[p]=true;\n\t\t\tman_t[p]=t;\n\t\t}\n\t}else{\n\t\tif(p==0){\n\t\t\tgoddess_in=false;\n\t\t\trep(i,1111){if(man_in[i])total[i]+=(t-max(goddess_t,man_t[i]));}\n\t\t}else{\n\t\t\tman_in[p]=false;\n\t\t\tif(goddess_in)total[p]+=(t-max(goddess_t,man_t[p])); \n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cassert>\nusing namespace std;\nint dp[51][51][51][51][2][3], A[51], B[51], C[51], D[51];\nint N, M, INF = (1e9);\nbool done[51][51][51][51][2][3];\n\nint dfs(int a, int b, int c, int d, int p, int t){\n  if(done[a][b][c][d][p][t]) return dp[a][b][c][d][p][t];\n  done[a][b][c][d][p][t] = true;\n\n  if(a == N && b == M && c == N && d == M) return dp[a][b][c][d][p][t];\n  \n  if(t > 1) dp[a][b][c][d][p][t] = 0;\n  else if(p) dp[a][b][c][d][p][t] = INF;\n  else dp[a][b][c][d][p][t] = -INF;\n  \n  if(p){\n    if(b < M){\n      if(B[b] >= 0) dp[a][b][c][d][p][t] = min(dp[a][b][c][d][p][t],dfs(a,b+1,c,d,1-p,0));\n      else dp[a][b][c][d][p][t] = min(dp[a][b][c][d][p][t],dfs(a,b+1,a,d,1-p,0));\n    }\n    if(t < 2) dp[a][b][c][d][p][t] = min(dp[a][b][c][d][p][t], C[a] - C[c] - D[b] + D[d] + dfs(a,b,a,b,1-p,t+1));//pass\n  }else{\n    if(a < N){\n      if(A[a] >= 0) dp[a][b][c][d][p][t] = max(dp[a][b][c][d][p][t],dfs(a+1,b,c,d,1-p,0));\n      else dp[a][b][c][d][p][t] = max(dp[a][b][c][d][p][t],dfs(a+1,b,c,b,1-p,0));\n    }\n    if(t < 2) dp[a][b][c][d][p][t] = max(dp[a][b][c][d][p][t], C[a] - C[c] - D[b] + D[d] + dfs(a,b,a,b,1-p,t+1));//pass\n  }\n  //cerr << a << \" \" << b << \" \" << c << \" \" << d << \" \" << p << \" \" << dp[a][b][c][d][p] << endl;\n  return dp[a][b][c][d][p][t];\n}\n\nint main(){\n  cin >> N >> M;\n  for(int i = 0; i < N; ++i) cin >> A[i];\n  for(int i = 0; i < M; ++i) cin >> B[i];\n  for(int i = 0; i < N; ++i) C[i+1] = C[i] + max(0,A[i]);\n  for(int i = 0; i < M; ++i) D[i+1] = D[i] + max(0,B[i]);\n  cout << dfs(0,0,0,0,0,0) << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\nusing namespace std;\n\nstruct Data{\n    int m;\n    char io;\n    string id;\n};\n\nvoid requireTime(map<string,int> &time, map<string, vector<pair<int, int>>> s){\n    auto it = s.begin();\n    vector<pair<int, int>> god = it->second;\n    it++;\n    for(; it != s.end(); it++){\n        rep(i,god.size()){\n            vector<pair<int, int>> tmp = it->second;\n            rep(j,tmp.size()){\n                int left = max(god[i].first, tmp[j].first);\n                int right = min(god[i].second, tmp[j].second);\n                time[ it->first ] += right - left;\n            }\n        }\n    }\n}\n\nint main(){\n    int n;\n    while(cin >> n,n){\n        map<string, vector<Data>> v; //??\\????????¨????¨????\n        rep(i,n){\n            string day, id;\n            int th,tm;\n            char io,g;\n\n            cin >> day >> th >> g >> tm >> io >> id;\n            v[day].emplace_back(Data{th * 60 + tm, io, id});\n        }\n\n        map<string,int> time;//id->?????????????????????\n        for(auto it_v : v){\n            map<string, vector<pair<int, int>>> seg; //id?????¨?????????\n            map<string,int> tmp;\n            for(auto it_d : it_v.second){\n                if(it_d.io == 'I'){\n                    tmp[it_d.id] = it_d.m;\n                }else{\n                    assert(tmp[it_d.id] != 0);\n                    seg[it_d.id].emplace_back(make_pair(tmp[it_d.id], it_d.m));\n                }\n            }\n            requireTime(time,seg);\n        }\n        int maxi = 0;\n        for(auto it : time){\n            maxi = max(maxi,it.second);\n        }\n        cout << maxi << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\nint idconv(string s) {\n\tint res = 0;\n\tfor (int i = 0; i < 3; i++) {\n\t\tres += (s[i] - '0');\n\t}\n\treturn res;\n}\n\nint timeconv(string s) {\n\tint res = 0;\n\tres += ((s[0] - '0') * 10 + (s[1] - '0'));\n\tres *= 60;\n\tres += ((s[3] - '0') * 10 + (s[4] - '0'));\n\treturn res;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tint n;\n\twhile (true) {\n\t\tcin >> n;\n\t\tif (n == 0) break;\n\t\tvector<int> sum(1000, 0);\n\t\tbool exist = false;\n\t\tvector<int> intime(1000, -1);\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tstring md, hm, e, p;\n\t\t\tcin >> md >> hm >> e >> p;\n\t\t\tint time = timeconv(hm), id = idconv(p);\n\t\t\tif (id == 0) {\n\t\t\t\tif (e == \"I\") {\n\t\t\t\t\texist = true;\n\t\t\t\t\tfor (int j = 1; j < 1000; j++) {\n\t\t\t\t\t\tif (intime[j] > 0) intime[j] = time;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\texist = false;\n\t\t\t\t\tfor (int j = 1; j < 1000; j++) {\n\t\t\t\t\t\tif (intime[j] > 0) {\n\t\t\t\t\t\t\tsum[j] += (time - intime[j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (e == \"I\") {\n\t\t\t\t\tif (exist) {\n\t\t\t\t\t\tintime[id] = time;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tintime[id] = time;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (exist) {\n\t\t\t\t\t\tsum[id] += time - intime[id];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\n\t\t\t\t\t}\n                    intime[id]=-1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ma = -1;\n\t\tfor (int i = 1; i < 1000; i++) {\n\t\t\tif (sum[i] > ma) {\n\t\t\t\tma = sum[i];\n\t\t\t}\n\t\t}\n\t\tcout << ma << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#pragma warning(disable:4996)\n\n#define MAX_N 10000\n#define MAX_M 501\n\nint Q;\nint M[MAX_N], D[MAX_N], h[MAX_N], m[MAX_N], t[MAX_N], n[MAX_N];\nint K[MAX_N], L[MAX_N];\nchar c;\n\nint main() {\n\twhile (true) {\n\t\tfor (int i = 0; i < MAX_N; i++) { M[i] = 0; D[i] = 0; h[i] = 0; m[i] = 0; t[i] = 0; n[i] = 0; K[i] = 0; L[i] = 0; }\n\t\tbool megami = false; int zenkai = 0; cin >> Q; if (Q == 0) { break; }\n\t\tfor (int i = 0; i < Q; i++) {scanf(\"%02d/%02d %02d:%02d %c %03d\", &M[i], &D[i], &h[i], &m[i], &c, &n[i]); if (c == 'I') { t[i] = 0; } else { t[i] = 1; }}\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tif (t[i] == 0) { L[n[i]] = 1; }if (t[i] == 1) { L[n[i]] = 0; }\n\t\t\tif (megami == true) { for (int j = 0; j < MAX_M; j++) { if (L[j] == 1) { K[j] += (h[i] * 60 + m[i]) - zenkai; } } }\n\t\t\tzenkai = h[i] * 60 + m[i]; if (L[0] == 1) { megami = true; } else { megami = false; }\n\t\t}\n\t\tint maxn = 0; for (int i = 1; i < MAX_M; i++) { maxn = max(maxn, K[i]); }cout << maxn << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n\nint get(string s){\n\ts[2] = ' ';\n\tstringstream ss(s);\n\tint h,m;\n\tss >> h >> m;\n\treturn h * 60 + m;\n}\n\nint main(){\n\tint n;\n\twhile(cin >> n && n){\n\t\tmap<string,int> in;\n\t\tmap<string,int> tot;\n\t\tfor(int i = 0 ; i < n ; i++){\n\t\t\tstring d,s,t,id;\n\t\t\tcin >> d >> s >> t >> id;\n\t\t\tif( t == \"I\" ){\n\t\t\t\tin[id] = get(s);\n\t\t\t}else{\n\t\t\t\tif( id == \"000\" ){\n\t\t\t\t\tfor( auto e : in ){\n\t\t\t\t\t\t//cout << get(s) - max(tot[\"000\"],tot[e.first]) << \"<\" << endl;\n\t\t\t\t\t\ttot[e.first] += get(s) - max(in[\"000\"],in[e.first]);\n\t\t\t\t\t}\n\t\t\t\t}else if( in.count(\"000\") ){\n\t\t\t\t\ttot[id] += get(s) - in[id];\n\t\t\t\t}\n\t\t\t\tin.erase(id);\n\t\t\t}\n\t\t}\n\t\tint ans = 0;\n\t\tfor( auto e : tot ){\n\t\t\tif( e.first != \"000\" ){\n\t\t\t\tans = max(ans,e.second);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <algorithm>\n\nint n;\nint M,D,h,m,id;\nint cnt[1001];\nint t[1001];\nchar io;\nbool flag[1001];\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d\",&n);\n\t\tif(n==0)break;\n\t\tmemset(cnt,0,sizeof(cnt));\n\t\tmemset(t,0,sizeof(t));\n\t\tmemset(flag,0,sizeof(flag));\n\t\tfor(int i=0;i<n;i++){\n\t\t\tscanf(\"%2d/%2d %2d:%2d %c %3d\",&M,&D,&h,&m,&io,&id);\n\t\t\tif(io=='I'){\n\t\t\t\tt[id]=h*60+m;\n\t\t\t\tflag[id]=true;\n\t\t\t}else{\n\t\t\t\tif(id==0){\n\t\t\t\t\tfor(int i=1;i<=999;i++){\n\t\t\t\t\t\tif(flag[i])cnt[i]+=h*60+m-std::max(t[i],t[0]);\n\t\t\t\t\t}\n\t\t\t\t\tflag[0]=false;\n\t\t\t\t}else{\n\t\t\t\t\tif(flag[0]){\n\t\t\t\t\t\tcnt[id]+=h*60+m-std::max(t[id],t[0]);\n\t\t\t\t\t}\n\t\t\t\t\tt[id]=h*60+m;\n\t\t\t\t\tflag[id]=false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint res=0;\n\t\tfor(int i=1;i<=999;i++){\n\t\t\tres=std::max(res,cnt[i]);\n\t\t}\n\t\tprintf(\"%d\\n\",res);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n\nusing namespace std;\n\nint main(){\n\tint n;\n\tint in[1000], out[1000], sum[1000];\n\twhile(cin >> n, n){\n\t\tstring day, time; char e; int p;\n\t\tmemset(in,  0, sizeof(in));\n\t\tmemset(out, 0, sizeof(out));\n\t\tmemset(sum, 0, sizeof(sum));\n\t\tstring prevDay = \"\";\n\t\tfor(int i=0;i<n;i++){\n\t\t\tcin >> day >> time >> e >> p;\n\t\t\tif(day != prevDay){\n\t\t\t\tmemset(in,  0, sizeof(in));\n\t\t\t\tmemset(out, 0, sizeof(out));\n\t\t\t\tprevDay = day;\n\t\t\t}\n\t\t\tint h, m;\n\t\t\tsscanf(time.c_str(), \"%02d:%02d\", &h, &m);\n\t\t\tint t = h*60+m;\n\t\t\tif(e == 'I'){\n\t\t\t\tin[p] = t;\n\t\t\t\tout[p] = 1000000;\n\t\t\t} else {\n\t\t\t\tif(p==0){\n\t\t\t\t\tout[0] = t;\n\t\t\t\t\tfor(int i=1;i<1000;i++){\n\t\t\t\t\t\tif(out[i]==1000000){\n\t\t\t\t\t\t\tsum[i] += max(0, out[0] - max(in[i], in[0]));\n\t\t\t\t\t\t\tin[i] = t;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tout[p] = t;\n\t\t\t\t\tsum[p] += max(0, min(out[p], out[0]) - max(in[p], in[0]));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint res = 0;\n\t\tfor(int i=1;i<1000;i++) res = max(res, sum[i]);\n\t\tcout << res << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <cstdlib>\nusing namespace std;\n\nint main(){\n\twhile(1){\n\t\tint n;\n\t\tcin >> n;\n\t\tif(n==0) break;\n\t\t\n\t\tvector<vector<int> > in(1000), out(1000);\n\t\tint idmax=0;\n\t\tfor(int i=0; i<n; i++){\n\t\t\tstring date,time,io,id;\n\t\t\tcin >> date >> time >> io >> id;\n\t\t\tint min = stoi(date.substr(0,2))*50000 +stoi(date.substr(3,2))*1440\n\t\t\t\t\t\t+stoi(time.substr(0,2))*60 +stoi(time.substr(3,2));\n\t\t\tif(io==\"I\"){\n\t\t\t\tin[stoi(id)].push_back(min);\n\t\t\t}else{\n\t\t\t\tout[stoi(id)].push_back(min);\n\t\t\t}\n\t\t\tidmax = max(idmax, stoi(id));\n\t\t}\n\t\t\n\t\tint ans=0;\n\t\tfor(int i=1; i<=idmax; i++){\n\t\t\tint sum=0;\n\t\t\tfor(int j=0; j<(int)in[0].size(); j++){\n\t\t\t\tfor(int k=0; k<(int)in[i].size(); k++){\n\t\t\t\t\tif((in[0][j]<=in[i][k] && in[i][k]<=out[0][j]) || (in[i][k]<=in[0][j] && in[0][j]<=out[i][k])){\n\t\t\t\t\t\tsum += abs(max(in[0][j], in[i][k]) -min(out[0][j], out[i][k]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tans = max(ans, sum);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<map>\n#include<vector>\nusing namespace std;\n\nconst int maxn = 6e5;\nvector<int> g[maxn];\nint etr[1100], res[1100];\nvector<int> god;\nint d[13] = {0, 31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};\n\nint trans(int M, int D, int h, int m){\n    int ans = 0;\n    for(int i = 1; i < M; i++)\n        ans += d[i] * 24 * 60;\n    ans += (D - 1) * 24 * 60 + h * 60 + m;\n    return ans;\n}\nint main(){\n    int n;\n    int M, D, h, m, p;\n    char op[5];\n    while(~scanf(\"%d\", &n), n){\n        for(int i = 0; i < 1000; i++) g[i].clear();\n        god.clear();\n        memset(res, 0, sizeof(res));\n        while(n--){\n            scanf(\"%d/%d %d:%d %s %d\", &M, &D, &h, &m, op, &p);\n            if(op[0] == 'O'){\n                int l = trans(M, D, h, m);\n                if(p){\n                    for(int i = etr[p]; i < l; i++)\n                        g[i].push_back(p);\n                }else{\n                    for(int i = etr[p]; i < l; i++)\n                        god.push_back(i);\n                }\n            }else{\n                etr[p] = trans(M, D, h, m);\n            }\n        }\n\n        int sz = god.size();\n        for(int i = 0; i < sz; i++){\n            int t = god[i];\n            int l = g[t].size();\n            for(int j = 0; j < l; j++)\n                res[g[t][j]]++;\n        }\n        int _max = 0;\n        for(int i = 1; i < 1000; i++)\n            if(_max < res[i]) _max = res[i];\n\n        printf(\"%d\\n\", _max);\n\n    }\n}\n\n/*\n14\n04/21 09:00 I 000\n04/21 09:00 I 001\n04/21 09:15 I 002\n04/21 09:30 O 001\n04/21 09:45 O 000\n04/21 10:00 O 002\n04/28 09:00 I 003\n04/28 09:15 I 000\n04/28 09:30 I 004\n04/28 09:45 O 004\n04/28 10:00 O 000\n04/28 10:15 O 003\n04/29 20:00 I 002\n04/29 21:30 O 002\n20\n06/01 09:00 I 001\n06/01 09:15 I 002\n06/01 09:15 I 003\n06/01 09:30 O 002\n06/01 10:00 I 000\n06/01 10:15 O 001\n06/01 10:30 I 002\n06/01 10:45 O 002\n06/01 11:00 I 001\n06/01 11:15 O 000\n06/01 11:30 I 002\n06/01 11:45 O 001\n06/01 12:00 O 002\n06/01 12:15 I 000\n06/01 12:30 I 002\n06/01 12:45 O 000\n06/01 13:00 I 000\n06/01 13:15 O 000\n06/01 13:30 O 002\n06/01 13:45 O 003\n0\n*/"
  },
  {
    "language": "C++",
    "code": "#if __has_include(\"../library/Basic/Debug.hpp\")\n\n#include \"../library/Basic/Debug.hpp\"\n\n#else\n\n/* ----- Header Files ----- */\n// IO\n#include <cstdio>\n#include <iomanip>\n#include <ios>\n#include <iostream>\n\n// algorithm\n#include <algorithm>\n#include <cmath>\n#include <numeric>\n\n// container\n#include <vector>\n#include <string>\n#include <tuple>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <deque>\n\n// others\n#include <random>\n#include <limits>\n#include <functional>\n#include <ctime>\n#include <cassert>\n#include <cstdint>\n\n\n/* ----- Type Alias ----- */\nusing Int = long long int;\nusing Real = long double;\nusing String = std::string;\ntemplate <class... Ts>\nusing Tuple = std::tuple<Ts...>;\n\ntemplate <class T>\nusing Vector = std::vector<T>;\ntemplate <class T>\nusing Queue = std::queue<T>;\ntemplate <class T>\nusing Stack = std::stack<T>;\ntemplate <class T>\nusing Deque = std::deque<T>;\n\ntemplate <class T>\nusing MaxHeap = std::priority_queue<T>;\ntemplate <class T>\nusing MinHeap = std::priority_queue<T, std::vector<T>, std::greater<T>>;\ntemplate <class T>\nusing Set = std::set<T>;\ntemplate <class T, class U>\nusing Map = std::map<T, U>;\n\ntemplate <class T, class... Us>\nusing Func = std::function<T(Us...)>;\n\ntemplate <class T>\nT genv(T v) { return v; }\n\ntemplate <class T, class... Ts>\nauto genv(size_t l, Ts... ts) {\n    return Vector<decltype(genv<T>(ts...))>(l, Vector<T>(ts...));\n}\n\ntemplate <class Cost = Int>\nstruct Edge {\n    Int src, dst;\n    Cost cost;\n    Edge(Int src = -1, Int dst = -1, Cost cost = 1)\n        : src(src), dst(dst), cost(cost){};\n\n    bool operator<(const Edge<Cost>& e) const { return this->cost < e.cost; }\n    bool operator>(const Edge<Cost>& e) const { return this->cost > e.cost; }\n};\n\ntemplate <class Cost = Int>\nusing Edges = Vector<Edge<Cost>>;\ntemplate <class Cost = Int>\nusing Graph = Vector<Vector<Edge<Cost>>>;\n\n#endif\n\n/* ----- Misc ----- */\nvoid fastio() {\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr);\n}\n\nstruct Fout {\n    Int precision;\n    Fout(Int precision) : precision(precision) {}\n};\nstd::ostream& operator<<(std::ostream& os, const Fout& fio) {\n    os << std::fixed << std::setprecision(fio.precision);\n    return os;\n}\n\n\n/* ----- Constants ----- */\n// constexpr Int INF = std::numeric_limits<Int>::max() / 3;\n// constexpr Int MOD = 1000000007;\n// constexpr Real PI = acos(-1);\n// constexpr Real EPS = 1e-10;\n// std::mt19937 mt(int(std::time(nullptr)));\n\nbool solve() {\n    Int n;\n    std::cin >> n;\n    if (n == 0) return false;\n\n    Vector<Vector<Int>> records(1000);\n    for (Int i = 0; i < n; ++i) {\n        Int t, id;\n        {\n            Int m, d, h, mi;\n            char c;\n            std::cin >> m >> c >> d >> h >> c >> mi >> c >> id;\n            t = ((m * 40 + d) * 24 + h) * 60 + mi;\n        }\n        records[id].push_back(t);\n    }\n\n    Vector<Vector<Tuple<Int, Int>>> segs(1000);\n    for (Int i = 0; i < 1000; ++i) {\n        for (Int j = 0; j < records[i].size(); j += 2) {\n            segs[i].emplace_back(records[i][j], records[i][j + 1]);\n        }\n    }\n\n    Int ans = -1;\n    for (Int i = 1; i < 1000; ++i) {\n        Int t = 0;\n        for (auto p : segs[i]) {\n            for (auto g : segs[0]) {\n                Int lp, rp, lg, rg;\n                std::tie(lp, rp) = p, std::tie(lg, rg) = g;\n                Int l = std::max(lp, lg), r = std::min(rp, rg);\n                t += std::max(0LL, r - l);\n            }\n        }\n        ans = std::max(ans, t);\n    }\n\n    std::cout << ans << std::endl;\n    return true;\n}\n\nint main() {\n    while (solve()) {}\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#pragma warning(disable:4996)\n\n#define MAX_N 10000\n#define MAX_M 501\n\nint Q;\nint M[MAX_N], D[MAX_N], h[MAX_N], m[MAX_N], t[MAX_N], n[MAX_N];\nint K[MAX_N], L[MAX_N];\nchar c;\n\nint main() {\n\twhile (true) {\n\t\tfor (int i = 0; i < MAX_N; i++) { M[i] = 0; D[i] = 0; h[i] = 0; m[i] = 0; t[i] = 0; n[i] = 0; K[i] = 0; L[i] = 0; }\n\t\tbool megami = false; int zenkai = 0; cin >> Q; if (Q == 0) { break; }\n\t\tfor (int i = 0; i < Q; i++) {scanf(\"%02d/%02d %02d:%02d %c %03d\", &M[i], &D[i], &h[i], &m[i], &c, &n[i]); if (c == 'I') { t[i] = 0; } else { t[i] = 1; }}\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tif (t[i] == 0) { L[n[i]] = 1; }if (t[i] == 1) { L[n[i]] = 0; }\n\t\t\tif (megami == true) { for (int j = 0; j < MAX_M; j++) { if (L[j] == 1) { K[j] += (h[i] * 60 + m[i]) - zenkai; } } }\n\t\t\tzenkai = h[i] * 60 + m[i]; if (n[i] == 0 && t[i] == 0) { megami = true; } else { megami = false; }\n\t\t}\n\t\tint maxn = 0; for (int i = 0; i < MAX_M; i++) { maxn = max(maxn, K[i]); }cout << maxn << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\ntypedef long long LL;\n#define SORT(c) sort((c).begin(),(c).end())\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\nusing namespace std;\nint si(string s)\n{\n  return (stoi(string(s.begin(),s.begin()+2))*60+stoi(string(s.begin()+3,s.begin()+5)));\n}\nint calt(string s,string t)\n{\n  return si(t)-si(s);\n}\nint main(void)\n{\n  for(;;){\n    int n;\n    cin >> n;\n    if(!n) return 0;\n    bool g=false;\n    map<string,string> from;\n    map<string,int> t;\n    string d,m,io,id;\n    REP(i,n){\n      cin >> d >> m >> io >> id;\n      if(id==\"000\"){\n\tif(g)\n\t  for(auto x:from)\n\t    t[x.first]+=calt(x.second,m);\n\telse\n\t  for(auto &x:from)\n\t    x.second=m;\n\tg=!g;\n      }else{\n\tif(from.count(id)){\n\t  if(g) t[id]+=calt(from[id],m);\n\t  from.erase(id);\n\t}\n\telse from[id]=m;\n      }\n    }\n    int answer=0;\n    for(auto x:t) answer=max(answer,x.second);\n    cout << answer << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define mk make_pair\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long ll;\nstruct BIT{\n  int size;\n  vector<ll> dat;\n  void init(int n){\n    size=n;\n    dat.clear();\n    dat.resize(n+1);\n  }\n  void Add(int i,ll x){\n    while(0<i&&i<=size){\n      dat[i]+=x;\n      i+=(i&-i);\n    }\n  }\n  ll Sum(int i){\n    ll res=0;\n    while(0<i){\n      res+=dat[i];\n      i-=(i&-i);\n    }\n    return res;\n  }\n};\nint main(){\n  int n;\n  while(cin>>n,n){\n    int ans=0;\n    vector<int>v[1001];\n    for(int i=0;i<n;i++){\n      int pp=0,m,d,h,ss,t;\n      scanf(\"%d/%d %d:%d\",&m,&d,&h,&ss);\n      pp=m*40*24*60+d*24*60+h*60+ss;\n      string s1,s2;\n      cin>>s1>>t;\n      v[t].push_back(pp);\n    }\n    for(int o=1;o<1001;o++)if(v[o].size()){\n      BIT A,B;\n      A.init(600000);\n      B.init(600000);\n      for(int i=0;i<v[o].size();i+=2){\n\tint ss=v[o][i],tt=v[o][i+1];\n\tA.Add(ss,1);\n        A.Add(tt,-1);\n        B.Add(ss,-1*(ss-1));\n        B.Add(tt,1*(ss-1) + 1*(tt-ss+1) );\n      }\n      int sum=0;\n      for(int i=0;i<v[0].size();i+=2){\n\tint ss=v[0][i],tt=v[0][i+1];\n\tss;\n\tsum+=A.Sum(tt)*tt+B.Sum(tt) - A.Sum(ss)*ss-B.Sum(ss);\n      }\n      ans=max(sum,ans);\n    }\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <set>\n#include <cmath>\n#include <stack>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <numeric>\n#include <vector>\n#include <ctime>\n#include <queue>\n#include <list>\n#include <map>\n#define pi acos(-1.0)\n#define INF 0x3f3f3f3f\n#define clr(x)  memset(x,0,sizeof(x));\n#define clrto(x,siz,y)  for(int xx=0;xx<=siz;xx++)  x[xx]=y;\n#define clrset(x,siz)  for(int xx=0;xx<=siz;xx++)  x[xx]=xx;\n#define clr_1(x) memset(x,-1,sizeof(x));\n#define clrmax(x) memset(x,0x3f,sizeof(x));\n#define clrvec(x,siz) for(int xx=0;xx<=siz;xx++)  x[xx].clear();\n#define fop2   freopen(\".in\",\"r\",stdin); //freopen(\".out\",\"w\",stdout);\n#define fop   freopen(\"in.txt\",\"r\",stdin);//freopen(\"out.txt\",\"w\",stdout);\n#define myprogram By_135678942570\n#define clrcpy(x,siz,y)  for(int xx=0;xx<siz;xx++)  x[xx]=y[xx];\n#define pb push_back\nusing namespace std;\nint main()\n{\n\tint n;\n\tint ent[1011]={0};\n\twhile(1)\n\t{\n\t\tchar s[5];\n\t\tint m,d,h,mi,id;\n\t\tscanf(\"%d\",&n);\n\t\tif(n==0)\n\t\t\tbreak;\n\t\tint lastm=-1,lastd=-1;\n\t\tint all[1011]={0};\n\t\tfor(int i=0;i<n;i++)\n\t\t{\n\t\t\tscanf(\"%d/%d%d:%d%s%d\",&m,&d,&h,&mi,s,&id);\n\t\t\tint nowtime=h*60+mi;\n\t\t\tif(lastm!=m||lastd!=d)\n\t\t\t{\n\t\t\t\tif(ent[0])\n\t\t\t\t{\n\t\t\t\t\tfor(int j=0;j<1000;j++)\n\t\t\t\t\t\tif(ent[j]!=0)\n\t\t\t\t\t\t\tall[j]+=24*60-ent[j];\n\t\t\t\t}\n\t\t\t\tclr(ent);\n\t\t\t}\n\t\t\tif(s[0]=='I')\n\t\t\t{\n\t\t\t\tent[id]=nowtime;\n\t\t\t\tif(id==0)\n\t\t\t\t\tfor(int j=0;j<1000;j++)\n\t\t\t\t\t\tif(ent[j]!=0)\n\t\t\t\t\t\t\tent[j]=nowtime;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(id==0)\n\t\t\t\t{\n\t\t\t\t\tfor(int j=0;j<1000;j++)\n\t\t\t\t\t\tif(ent[j]!=0)\n\t\t\t\t\t\t\tall[j]+=nowtime-ent[j];\n\t\t\t\t\tent[0]=0;\n\t\t\t\t}\n\t\t\t\telse if(ent[0])\n\t\t\t\t{\n\t\t\t\t\tall[id]+=(nowtime-ent[id]);\n\t\t\t\t\tent[id]=0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlastm=m,lastd=d;\n\t\t}\n\t\tprintf(\"%d\\n\",*max_element(all+1,all+1000));\n\t}\n}\n/*\n4\n1/1 02:30 I 001\n1/1 09:00 I 000\n1/1 09:53 O 001\n1/1 09:55 O 000\n*/"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint convert(char x,char y){\n    return (x-'0')*10+y-'0';\n}\nint solve(int n){\n    vector<string> date(n);\n    vector<int> t(n);\n    vector<char> op(n);\n    vector<string> id(n);\n    for(int i=0;i<n;i++){\n        string buf;\n        cin>>date[i]>>buf>>op[i]>>id[i];\n        t[i]=convert(buf[0],buf[1])*60+convert(buf[3],buf[4]);\n    }\n\n    map<string,int> res;\n    map<string,vector<int>> events;\n    for(int i=0;i<n;i++) events[date[i]].push_back(i);\n\n    for(auto &kvp:events){\n        auto event=kvp.second;\n        stack<tuple<string,int,int>> outer;\n        map<string,int> inner;\n        int gin=0;\n        for(int idx:event){\n            if(id[idx]==\"000\"){\n                if(op[idx]=='I'){\n                    gin=t[idx];\n                }\n                else{\n                    for(auto &e:inner){\n                        res[e.first]+=t[idx]-max(gin,e.second);\n                    }\n                    while(!outer.empty()){\n                        auto tmp=outer.top(); outer.pop();\n                        res[get<0>(tmp)]+=max(get<2>(tmp)-max(get<1>(tmp),gin),0);\n                    }\n                }\n            }\n            else{\n                if(op[idx]=='I'){\n                    inner[id[idx]]=t[idx];\n                }\n                else{\n                    outer.push({id[idx],inner[id[idx]],t[idx]});\n                    inner.erase(id[idx]);\n                }\n            }\n        }        \n    }\n    int ret=0;\n    for(auto &e:res) if(e.first!=\"000\") ret=max(ret,e.second);\n    return ret;\n}\n    \nint main(){\n    int n;\n    while(cin>>n,n){\n        cout<<solve(n)<<endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<sstream>\n#include<iomanip>\n#include<cstring>\n#include<string>\n#include<cmath>\n#include<cstdlib>\n#include<algorithm>\n#include<functional>\n#include<cctype>\n#include<ctime>\n#include<stack>\n#include<queue>\n#include<deque>\n#include<vector>\n#include<set>\n#include<map>\n#include<limits>\nusing namespace std;\n#define INT (0x3f3f3f3f)*2\n#define LL (0x3f3f3f3f3f3f3f3f)*2\n#define clr(a) memset(a,0,sizeof(a))\n#define clr_minus1(a) memset(a,-1,sizeof(a))\n#define clr_NULL(a) memset(a,NULL,sizeof(a))\n#define clr_1(a,n) for(int i=0;i<=n;i++) a[i]=1\n#define clr_INT(a) memset(a,INT,sizeof(a))\n#define clr_true(a) memset(a,true,sizeof(a))\n#define clr_false(a) memset(a,false,sizeof(a))\n#define clr_queue(q) while(!q.empty()) q.pop()\n#define clr_stack(s) while(!s.empty()) s.pop()\n#define clr_vector(v,n) for(int i=0;i<=n;i++) v[i].clear()\n#define rep(i, a, b) for (int i = a; i < b; i++)\n#define dep(i, a, b) for (int i = a; i > b; i--)\n#define repin(i, a, b) for (int i = a; i <= b; i++)\n#define depin(i, a, b) for (int i = a; i >= b; i--)\n#define Max(a,b) ((a)>(b) ? (a):(b))\n#define Min(a,b) ((a)<(b) ? (a):(b))\nint month[]= {0,31,28,31,30,31,30,31,31,30,31,30,31};\nint month_sum[12];\nstruct Per\n{\n    int month;\n    int day;\n    int h;\n    int m;\n    char flag;\n    int num;\n    int time;\n    int days;\n    int times;\n};\nPer per[1010];\nstruct Tem\n{\n    int days;\n    int times;\n    int num;\n};\nTem temp[1010];\nTem fina[1010];\nint fina_sum[1010];\nvoid check(int mx,int pos)\n{\n    for(int i=1; i<=mx; i++)\n    {\n        if(temp[i].days!=-1)\n        {\n            if(temp[i].days*3600+temp[i].times<=temp[0].days*3600+temp[0].times)\n            {\n                fina_sum[i]+=(per[pos].days-temp[0].days)*3600-(per[pos].days-temp[0].days)*2+per[pos].times-temp[0].times;\n\n            }\n            else\n            {\n                fina_sum[i]+=(per[pos].days-temp[i].days)*3600-(per[pos].days-temp[i].days)*2+per[pos].times-temp[i].times;\n            }\n        }\n    }\n}\nint main()\n{\n    int n;\n    while(scanf(\"%d\",&n)==1&&n)\n    {\n        char a,b,c,d,e;\n        int num_maxs=-1;\n        for(int i=0; i<n; i++)\n        {\n            scanf(\"%d%c%d%c%d%c%d%c%c%c%d\",&per[i].month,&a,&per[i].day,&b,&per[i].h,&c,&per[i].m,&d,&per[i].flag,&e,&per[i].num);\n            if(num_maxs<per[i].num) num_maxs=per[i].num;\n        }\n        int sum=0;\n        for(int i=1; i<=12; i++)\n        {\n            sum+=month[i-1];\n            month_sum[i]=sum;\n        }\n//    for(int i=1;i<=12;i++) printf(\"%d \",month_sum[i]);\n//    printf(\"\\n\");\n        for(int i=0; i<n; i++)\n        {\n            per[i].days=month_sum[per[i].month]+per[i].day;\n            per[i].times=per[i].h*60+per[i].m;\n            //printf(\"%d %d %d %d %c %d\\n\",per[i].month,per[i].day,per[i].h,per[i].m,per[i].flag,per[i].num);\n        }\n        for(int i=0; i<=num_maxs; i++)\n        {\n            temp[i].days=-1;\n            temp[i].times=-1;\n        }\n        memset(fina,0,sizeof(fina));\n        int tot=0;\n        memset(fina_sum,0,sizeof(fina_sum));\n        for(int i=0; i<n; i++)\n        {\n            if(per[i].num==0)\n            {\n                if(per[i].flag=='I')\n                {\n                    temp[0].days=per[i].days;\n                    temp[0].times=per[i].times;\n                }\n                else\n                {\n                    check(num_maxs,i);\n                    temp[0].days=-1;\n                    temp[0].times=-1;\n                }\n            }\n            else\n            {\n                if(per[i].flag=='I')\n                {\n                    temp[per[i].num].days=per[i].days;\n                    temp[per[i].num].times=per[i].times;\n                }\n                else\n                {\n                    if(temp[0].days==-1) ;\n                    else\n                    {\n                        if(temp[0].days*3600+temp[0].times<=temp[per[i].num].days*3600+temp[per[i].num].times)\n                        {\n                            fina_sum[per[i].num]+=(per[i].days-temp[per[i].num].days)*3600+per[i].times-temp[per[i].num].times;\n\n                        }\n                        else\n                        {\n                            fina_sum[per[i].num]+=(per[i].days-temp[0].days)*3600+per[i].times-temp[0].times;\n                        }\n                    }\n                     temp[per[i].num].days=-1;\n                    temp[per[i].num].times=-1;\n                }\n            }\n        }\n        int maxs=-1;\n        for(int i=1; i<=num_maxs; i++)\n        {\n            //printf(\"%d \",fina_sum[i]);\n            if(maxs<fina_sum[i]) maxs=fina_sum[i];\n        }\n        //printf(\"\\n\");\n        printf(\"%d\\n\",maxs);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <sstream>\n#include <cstring>\nusing namespace std;\n\nint N;\nbool endow[1000];\nint tm[1000], tt[1000];\n\npair<int, int> separete(string s)\n{\n    stringstream ss(s);\n    int a,b;\n    char c;\n\n    ss >> a >> c >> b;\n\n    return make_pair(a,b);\n}\n\nint transMin(string s)\n{\n    pair<int, int> ms = separete(s);\n    int m = ms.first;\n    int d = ms.second;\n\n    return m*60+d;\n}\n\nint solve()\n{\n    memset(endow, 0, sizeof(endow));\n    memset(tt, 0, sizeof(tt));\n    \n    while(N--){\n\tstring a,b,c;\n\tint mn, id;\n\n\tcin >> a >> b >> c >> id;\n\tmn = transMin(b);\n\n\tif(c == \"I\") {\n\t    endow[id] = true;\n\t    tm[id] = mn;\n\t}\n\n\tif(c == \"O\") {\n\t    endow[id] = false;\n\t    if(id != 0) {\n\t\tif(endow[0]) tt[id] += mn - max(tm[id], tm[0]);\n\t    }\n\t    else {\n\t\tfor(int i=1; i<1000; i++)\n\t\t    if(endow[i]) tt[i] += mn - max(tm[id], tm[0]);\n\t    }\n\t}\n    }\n\n    int res = 0;\n    for(int i=1; i<1000; i++)\n\tres = max(res, tt[i]);\n\n    return res;\n}\n\n    \n    \n\nint main()\n{\n    while(cin >> N, N)\n\tcout << solve() << endl;\n    \n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <cstring>\nconst int MOD = 1e9 + 7;\nconst int dx[] = {1, -1, 0, 0};\nconst int dy[] = {0, 0, 1, -1};\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> P;\nstruct human\n{\n\tvector<int> inout;\n\tvector<int> date;\n};\nstruct god\n{\n\tint in, out, date;\n};\nint main()\n{\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tint N;\n\twhile(cin >> N, N)\n\t{\n\t\thuman info_h[N + 1];\n\t\tgod info_g[N + 1];\n\t\tint last;\n\t\tstring day, time, inout, num;\n\t\tint pos1 = 0, pos2 = 0;\n\t\tvector<int> programer(1000, 0);\n\t\tfor(int i = 0; i < N; i++)\n\t\t{\n\t\t\tcin >> day >> time >> inout >> num;\n\t\t\tstring tmp_s = day.substr(0, 2);\n\t\t\ttmp_s += day.substr(3);\n\t\t\tint tmp_time = stoi(time.substr(0, 2)) * 60 + stoi(time.substr(3));\n\t\t\tint tmp_num = stoi(num);\n\t\t\tint tmp_day = stoi(tmp_s);\n\t\t\tif(tmp_num == 0)\n\t\t\t{\n\t\t\t\tif(inout == \"I\")\n\t\t\t\t{\n\t\t\t\t\tinfo_g[pos1].in = tmp_time;\n\t\t\t\t\tinfo_g[pos1].date = tmp_day;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tinfo_g[pos1].out = tmp_time;\n\t\t\t\t\tinfo_g[pos1].date = tmp_day;\n\t\t\t\t\tpos1++;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(inout == \"I\")\n\t\t\t\t{\n\t\t\t\t\tinfo_h[tmp_num].inout.push_back(tmp_time);\n\t\t\t\t\tinfo_h[tmp_num].date.push_back(tmp_day);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tinfo_h[tmp_num].inout.push_back(tmp_time);\n\t\t\t\t\tinfo_h[tmp_num].date.push_back(tmp_day);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t/*\n\t\tfor(int i = 0; i < N; i++)\n\t\t{\n\t\t\tfor(int j = 0; j < info_h[i].date.size(); j++)\n\t\t\t{\n\t\t\t\t//if(j % 2)\n\t\t\t\t//\tcout << info_h[i].inout[j] << endl;\n\t\t\t\t//else\n\t\t\t\t//\tcout << info_h[i].inout[j] << \" \";\n\t\t\t\t//cout << info_h[i].date[j] << endl;\n\t\t\t}\n\t\t}*/\n\t\tfor(int i = 0; i < pos1; i++)\n\t\t{\n\t\t\tfor(int j = 0; j < N; j++)\n\t\t\t{\n\t\t\t\tfor(int k = 0; k < info_h[j].inout.size(); k += 2)\n\t\t\t\t{\n\t\t\t\t\t//cout << info_h[j].inout[k + 1] << \" \" << info_g[i].out << \" # \" << info_h[j].inout[k] << \" \" << info_g[i].in << endl;\n\t\t\t\t\t//cout << info_g[i].date << \" \" << info_h[j].date[k] << \" \" <<  endl;\n\t\t\t\t\tif(info_h[j].inout[k] > info_g[i].out || info_h[j].inout[k + 1] < info_g[i].in)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tif(info_g[i].date != info_h[j].date[k])\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tprogramer[j] += min(info_h[j].inout[k + 1], info_g[i].out) - max(info_h[j].inout[k], info_g[i].in);\n\t\t\t\t\t//cout << programer[j] << \" \" << j << endl;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans = 0;\n\t\tfor(int i = 0; i < N; i++)\n\t\t{\n\t\t\tif(programer[i] > ans)\n\t\t\t\tans = programer[i];\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\nstruct log{\n  int month, day, hour, minute;\n  char e;\n  int p;\n};\n\nvoid printlog(log l){ printf(\"%d/%d %d:%d %c %d\\n\", l.month, l.day, l.hour, l.minute, l.e, l.p); }\n\nint myabs(int n){ return n >= 0 ? n : -n; }\n\nint i_to_sit(string::iterator s, string::iterator e){\n  int ans = 0;\n  for(string::iterator t = s; t != e; t++){\n    ans *= 10;\n    ans += (*t - '0');\n  }\n  return ans;\n}\n\nint difftime(log a, log b){\n  return myabs((a.hour * 60 + a.minute) - (b.hour * 60 + b.minute));\n}\n\nint main(void){\n  while(true){\n    int n;\n    cin >> n;\n    if(n == 0){ break; }\n\n    string input;\n    vector<log> logbook;\n    vector<log> goddess;\n    int lastp = 0;    \n    for(int i = 0; i < n; i++){\n      log in;\n      \n      cin >> input;\n      in.month = i_to_sit(input.begin(), input.begin() + 2);\n      in.day = i_to_sit(input.begin() + 3, input.end());\n\n      cin >> input;\n      in.hour = i_to_sit(input.begin(), input.begin() + 2);\n      in.minute = i_to_sit(input.begin() + 3, input.end());\n\n      cin >> input;\n      in.e = input[0];\n      \n      cin >> input;\n      in.p = i_to_sit(input.begin(), input.end());\n      \n      logbook.push_back(in);\n      lastp = lastp > in.p ? lastp : in.p;\n    }\n    ++lastp;\n    \n    vector<vector<int> > imos(lastp, vector<int>(n + 1, 0));\n    for(int i = 0; i < n; i++)\n      imos[logbook[i].p][i] = (logbook[i].e == 'I') ? 1 : -1;\n    for(size_t i = 0; i < imos.size(); i++)\n      for(size_t j = 1; j < imos[i].size(); j++)\n        imos[i][j] += imos[i][j - 1];\n\n    vector<int> blessed(lastp, 0);    \n    for(int i = 1; i < lastp; i++)\n      for(size_t j = 0; j < imos[i].size() - 1; j++)\n        if(imos[i][j] == 1 && imos[0][j] == 1)\n          blessed[i] += difftime(logbook[j], logbook[j + 1]);\n\n    int maxp = 0, maxtime = 0;\n    for(int i = 0; i < lastp; i++){\n      if(blessed[i] > maxtime){\n        maxtime = blessed[i];\n        maxp = i;\n      }\n    }\n\n    cout << blessed[maxp] << endl;    \n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#pragma warning(disable:4996)\n\n#define MAX_N 10000\n#define MAX_M 600\n\nint Q;\nint M[MAX_N], D[MAX_N], h[MAX_N], m[MAX_N], n[MAX_N], t;\nint K[MAX_N], L[MAX_N];\nchar c;\n\nint main() {\n\twhile (true) {\n\t\tfor (int i = 0; i < MAX_N; i++) {\n\t\t\tM[i] = 0; D[i] = 0; h[i] = 0; m[i] = 0; n[i] = 0; K[i] = 0; L[i] = -1;\n\t\t}\n\n\t\tbool megami = false; \n\t\tint zenkai = 0; \n\t\tcin >> Q; \n\t\tif (Q == 0) { break; }\n\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tscanf(\"%02d/%02d %02d:%02d %c %03d\", &M[i], &D[i], &h[i], &m[i], &c, &n[i]);\n\t\t\tt = h[i] * 60 + m[i];\n\t\t\tif (c == 'I') {\n\t\t\t\tL[n[i]] = t;\n\t\t\t}\n\t\t\tif (c == 'O') {\n\t\t\t\tif (n[i] >= 1) {\n\t\t\t\t\tif (L[0] >= 0) {\n\t\t\t\t\t\tK[n[i]] += t - max(L[0], L[n[i]]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfor (int j = 1; j < MAX_M; j++) {\n\t\t\t\t\t\tif (L[i] >= 0) {\n\t\t\t\t\t\t\tK[i] += t - L[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tL[n[i]] = -1;\n\t\t\t}\n\t\t}\n\t\tint maxn = 0;\n\t\tfor (int i = 1; i < MAX_M; i++) {\n\t\t\tmaxn = max(maxn, K[i]);\n\t\t}\n\t\tcout << maxn << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n)for(int i=0;i<(n);i++)\nusing namespace std;\n\nchar s[2];\nint cnt[1000];\nint main() {\n\tint n;\n\twhile (scanf(\"%d\", &n), n) {\n\t\tset<int>se;\n\t\tmemset(cnt, 0, sizeof(cnt));\n\t\tint t = 0;\n\t\trep(i, n) {\n\t\t\tint h, m, p; scanf(\"%*d/%*d%d:%d%s%d\", &h, &m, &s, &p);\n\t\t\th = h * 60 + m;\n\t\t\tif (se.count(0)) {\n\t\t\t\tfor (int j : se)cnt[j] += h - t;\n\t\t\t}\n\t\t\tt = h;\n\t\t\tif (s[0] == 'I')se.insert(p);\n\t\t\telse se.erase(p);\n\t\t}\n\t\tprintf(\"%d\\n\", *max_element(cnt + 1, cnt + n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define SZ(x) (int)(x.size())\n#define REP(i, n) for(int i=0;i<(n);++i)\n#define FOR(i, a, b) for(int i=(a);i<(b);++i)\n#define RREP(i, n) for(int i=(int)(n)-1;i>=0;--i)\n#define RFOR(i, a, b) for(int i=(int)(b)-1;i>=(a);--i)\n#define ALL(a) a.begin(),a.end()\n#define DUMP(x) cerr<<#x<<\" = \"<<(x)<<endl\n#define DEBUG(x) cerr<<#x<<\" = \"<<(x)<<\" (L\"<<__LINE__<<\")\"<< endl;\nusing ll = long long;\nusing vi = vector<int>;\nusing vvi = vector<vi>;\nusing vll = vector<ll>;\nusing vvll = vector<vll>;\nusing P = pair<int, int>;\nconst double eps = 1e-8;\nconst ll MOD = 1000000007;\nconst int INF = INT_MAX / 2;\nconst ll LINF = LLONG_MAX / 2;\ntemplate <typename T1, typename T2>\nbool chmax(T1 &a, const T2 &b) {\n    if (a < b) { a = b; return true; }\n    return false;\n}\ntemplate <typename T1, typename T2>\nbool chmin(T1 &a, const T2 &b) {\n    if (a > b) { a = b; return true; }\n    return false;\n}\ntemplate<typename T>\nostream &operator<<(ostream &os, const vector<T> &v) {\n    os << \"[\";\n    REP(i, SZ(v)) {\n        if (i) os << \", \";\n        os << v[i];\n    }\n    return os << \"]\";\n}\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const map<T1, T2> &mp) {\n    os << \"{\";\n    int a = 0;\n    for (auto &tp : mp) {\n        if (a) os << \", \"; a = 1;\n        os << tp;\n    }\n    return os << \"}\";\n}\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const pair<T1, T2> &p) {\n    os << p.first << \":\" << p.second;\n    return os;\n}\n\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(10);\n\n    for (;;) {\n        int n; cin >> n;\n        if (n == 0) break;\n        map<string,int> total, prev;\n        vi god;\n        string date;\n        REP(i, n) {\n            string d, h, e, p;\n            cin >> d >> h >> e >> p;\n            if (d != date) {\n                date = d; prev.clear(); god.clear();\n            }\n            int m = stoi(h.substr(0,2)) * 60 +\n                    stoi(h.substr(3,2));\n            if (p == \"000\") {\n                god.push_back(m);\n                continue;\n            }\n            if (e == \"I\") {\n                prev[p] = m;\n            } else {\n                for (int j = 0; j < SZ(god); j += 2) {\n                    total[p] += max(min((j+1<SZ(god)?god[j+1]:INF),m) - max(god[j],prev[p]), 0);\n                }\n            }\n        }\n        int ma = 0;\n        for (auto &tp : total) {\n            chmax(ma, tp.second);\n        }\n        cout << ma << endl;\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <cassert>\n#include <memory>\n#include <time.h>\nusing namespace std;\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n) FOR(i,0,n)\nconst double EPS = 1e-9;\nconst double PI  = acos(-1.0);\n \n \nstruct programmer{\n    int score,presence;\n    programmer():score(0),presence(0){}\n};\nstruct evnt{\n    int month,date;\n    int hour,min;\n    char inout;\n    int id;\n};\nint main(){\n    int n;\n    while(cin>>n,n){\n        vector<programmer> programmers(1000);\n        int pl=programmers.size();\n        vector<evnt> evnts(n);\n        REP(i,n){\n            char sep;\n            cin>>evnts[i].month>>sep>>evnts[i].date>>evnts[i].hour>>sep>>evnts[i].min>>evnts[i].inout>>evnts[i].id;\n        }\n        FOR(i,1,evnts.size()){\n          if(evnts[i].date!=evnts[i-1].date){\n              evnt e;\n              e.month=evnts[i-1].month;\n              e.date=evnts[i-1].date;\n              e.hour=24;\n              e.min=0;\n              e.inout='C';\n              evnts.insert(evnts.begin()+i,e);\n              i++;\n          }\n        }\n              evnt e;\n              e.month=evnts[evnts.size()-1].month;\n              e.date=evnts[evnts.size()-1].date;\n              e.hour=24;\n              e.min=0;\n              e.inout='C';\n              evnts.push_back(e);\n \n        int prevtime=0;\n        int goddess_presence=0;\n        REP(i,n){\n            int curtime=evnts[i].hour*60+evnts[i].min;\n            if(evnts[i].inout=='C'){\n                //REP(j,pl){\n                //    if(programmers[j].presence&&goddess_presence){\n                //        programmers[j].score+=curtime-prevtime;\n                //    }\n                //    programmers[j].presence=0;\n                //}\n                //goddess_presence=0;\n                //prevtime=0;\n            }else if(evnts[i].id==0){\n                if(evnts[i].inout=='O'){\n                    REP(j,pl){\n                        if(programmers[j].presence){\n                            programmers[j].score+=curtime-prevtime;\n                        }\n                    }\n                }\n                goddess_presence=evnts[i].inout=='I';\n                prevtime=curtime;\n            }else{\n                if(goddess_presence){\n                    REP(j,pl){\n                        if(programmers[j].presence){\n                            programmers[j].score+=curtime-prevtime;\n                        }\n                    }\n                }\n                programmers[evnts[i].id].presence=evnts[i].inout=='I';\n                prevtime=curtime;\n            }\n            //cerr<<curtime<<\"*\"<<evnts[i].month<<evnts[i].date<<\"-\"<<evnts[i].hour<<\":\"<<evnts[i].min<<\"= \";\n            //FOR(j,1,5){\n            //  cerr<<programmers[j].score<<\",\";\n            //}\n            //cerr<<endl;\n        }\n        int ans=0;\n        REP(i,pl){\n            ans=max(ans,programmers[i].score);\n        }\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#define INF (1e9)\nusing namespace std;\n\nint main(){\n  while(1){\n    int n;\n    cin>>n;\n    if(!n)break;\n    int sum[1001]={},in[1001];\n    for(int i=0;i<1000;i++)in[i]=INF;\n    \n    while(n--){\n      int month,day,h,m,id;\n      char IO;\n      scanf(\"%d/%d %d:%d %c %d\",&month,&day,&h,&m,&IO,&id);\n      int t=(h*60)+m;\n      if(IO=='I')in[id]=t;\n      if(IO=='O'){\n\tif(id&&t>in[0])sum[id]+=t-max(in[0],in[id]);\n\tfor(int j=1;!id&&j<1000;j++) sum[j] += (t>in[j])? t-max(in[0],in[j]):0;\n\tin[id]=INF;\n      }\n    }\n    int ans=0;\n    for(int i=1;i<1000;i++)ans=max(ans,sum[i]);\n    cout <<ans<<endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define MAX 1010\n\nint main(){\n  int N;\n  while(cin >> N, N > 0){\n    int M[MAX],D[MAX],h[MAX],m[MAX],e[MAX],p[MAX];\n    int Point[MAX] = {0},t[MAX];\n    char ch;\n    for(int i = 0 ; i < N ; i++){\n      scanf(\"%d/%d %d:%d %c %d\",\n            &M[i],&D[i],&h[i],&m[i],&ch,&p[i]);\n      e[i] = (ch == 'I');\n    }\n    memset(t,-1,sizeof(t));\n    for(int i = 0 ; i < N ; i++){\n      int totalm = 60*h[i]+m[i];\n      if(e[i] == 1){\n        t[p[i]] = totalm;\n      }else{\n        if(p[i] == 0){\n          for(int j = 1 ; j < MAX ; j++){\n            if(t[j] == -1) continue;\n            Point[j] += totalm-max(t[j],t[0]);\n          }\n        }else{\n          if(t[0] != -1){\n            Point[p[i]] += totalm-max(t[p[i]],t[0]);\n          }\n        }\n        t[p[i]] = -1;\n      }\n    }\n    cout << *max_element(Point+1,Point+MAX) << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <map>\n#include <cstdio>\n#include <utility>\nusing namespace std;\n\nint main(){\n\tint n;\t\n\tfor(;cin >> n, n;){\n\t\tint mn, d, h, m, id;\n\t\tchar io;\n\t\tint pmn, pd, ph, pm, pio, pid;\n\t\tbool p[1000];\n\t\tint tt[1000];\n\t\tfor(int x = 0; x < 1000; x++){\n\t\t\tp[x] = false;\n\t\t\ttt[x] = 0;\n\t\t}\n\t\tscanf(\" %d/%d %d:%d %c %d\",\n\t\t\t&pmn, &pd, &ph, &pm, &pio, &pid);\n\t\tp[pid] = true;\n\t\tfor(int x = 1; x < n; x++){\n\t\t\tscanf(\" %d/%d %d:%d %c %d\",\n\t\t\t\t&mn, &d, &h, &m, &io, &id);\n\t\t\tif( p[0] ){\n\t\t\t\tfor(int y = 1; y < 1000; y++){\n\t\t\t\t\tif( p[y] ){\n\t\t\t\t\t\ttt[y] += (h-ph)*60+(m-pm);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(io == 'I'){\n\t\t\t\tp[id] = true;\n\t\t\t}\n\t\t\tif(io == 'O'){\n\t\t\t\tp[id] = false;\n\t\t\t}\n\t\t\tpmn = mn; pd = d; ph = h; pm = m; pio = io; pid = id;\n\t\t}\n\t\tint m_t = 0;\n\t\tfor(int x = 1; x < 1000; x++){\n\t\t\tif( tt[x] > m_t ){\n\t\t\t\tm_t = tt[x];\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\", m_t);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#define INF (1e9)\nusing namespace std;\n\nint main(){\n  while(1){\n    int n;\n    cin>>n;\n    if(!n)break;\n    int sum[1001]={},in[1001],out[1001],maxsum=0,maxid=0;\n    for(int i=0;i<1000;i++) out[i]=in[i]=INF;\n    \n    for(int i=0;i<n;i++){\n      int month,day,h,m,id;\n      char ch;\n      scanf(\"%d/%d %d:%d\",&month,&day,&h,&m);\n      cin>>ch>>id;\n      \n      maxid=max(maxid,id);\n      int time=(month*100000)+(day*10000)+(h*60)+m;\n      \n      if(ch=='I')in[id]=time;\n      if(ch=='O'){\n\tout[id]=time;\n\t\n\tif(id&& out[0]>in[id]&&out[id]>in[0]){\n\t  sum[id]+=min(out[0],out[id])-max(in[0],in[id]);\n\t  maxsum=max(maxsum,sum[id]);\n\t}\n\t\n\tfor(int j=1;!id&&j<=maxid;j++)\n\t  if(out[0]>in[j]&&out[j]>in[0]) {\n\t    sum[j]+=min(out[0],out[j])-max(in[0],in[j]);\n\t    maxsum=max(maxsum,sum[j]);\n\t  }\n\tin[id]=out[id]=INF;\n      }\n\n    }\n    cout <<maxsum<<endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<iomanip>\n#include<cmath>\n#include<vector>\n#include<algorithm>\n\nusing namespace std;\n\n#define int long long\n#define endl \"\\n\"\n\nconstexpr long long INF = (long long)1e18;\nconstexpr long long MOD = 1'000'000'007; \n\nstring yn(bool f){return f?\"Yes\":\"No\";}\nstring YN(bool f){return f?\"YES\":\"NO\";}\n\n\n#define T first\n#define M first.first\n#define D first.second\n#define h second.first\n#define m second.second\n#define e second.second\n#define p second.first\n\n\nint cal(pair<int,pair<int,int>> a, pair<int,pair<int,int>>  b){\n\treturn b.T - a.T;\n}\n\nint change(pair<pair<int,int>,pair<int,int>> in){\n\tint res = 0, con = 0;\n\tint days[12] = {31,28,31,30,31,30,  31,31,30,31,30,31};\n\t\n\tfor(int i = 0; i < in.M; i++){\n\t\tcon += days[i];\n\t}\n\t\n\tres = (con + in.D - 1) * 24 * 60 + in.h * 60 + in.m;\n\t\n\treturn res;\n}\n\nsigned main(){\n\tcin.tie(nullptr);\n\tios::sync_with_stdio(false);\n\tcout<<fixed<<setprecision(10);\n\tconst int MAX = 1000;\n\t\n\twhile(true){\n\t\tint n;\n\t\tint ans = 0;\n\t\tvector<vector<pair<int,pair<int,int>>>> in(MAX);\n\t\t\n\t\tcin>>n;\n\t\t\n\t\tif(!n) break;\n\t\t\n\t\t\n\t\tfor(int i = 0; i < n; i++){\n\t\t\tstring a, b, c, d;\n\t\t\t\n\t\t\tcin>>a>>b>>c>>d;\n\t\t\t\n\t\t\tin[stoi(d)].push_back({change({{stoi(a.substr(0,2)), stoi(a.substr(3,2))},{stoi(b.substr(0,2)), stoi(b.substr(3,2))}}), {stoi(d) == 0, c == \"I\"}});\n\t\t}\n\n\t\t\n\t\tfor(int i = 1; i < MAX && i <= 10; i++){\n\t\t\tbool flag = false;\n\t\t\tint temp = 0;\n\t\t\t\n\t\t\tfor(int j = 0, k = 0; j < in[0].size() && k < in[i].size(); j += 2){\n\t\t\t\tfor(; k < in[i].size(); k++){\n\t\t\t\t\tif(in[i][k].T <= in[0][j].T) {\n\t\t\t\t\t\tflag = in[i][k].e;\n\t\t\t\t\t} else break;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor(; k < in[i].size(); k++){\n\t\t\t\t\tif(in[i][k].T <= in[0][j+1].T) {\n\t\t\t\t\t\tflag = in[i][k].e;\n\t\t\t\t\t\tif(flag == false) {\n\t\t\t\t\t\t\ttemp += cal(max(in[0][j], in[i][k-1]), in[i][k]);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else break;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(flag){\n\t\t\t\t\ttemp += cal(max(in[0][j], in[i][k-1]), in[0][j+1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tans = max(ans, temp);\n\t\t}\n\t\t\n\t\t\n\t\tcout<<ans<<endl;\n\t}\n\t\n\t\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef int Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n//#define mt make_tuple\n//typedef tuple<double,int,double> tp;\n//typedef vector<tp> vt;\ntemplate<typename A,typename B>bool cmin(A &a,const B &b){return a>b?(a=b,true):false;}\ntemplate<typename A,typename B>bool cmax(A &a,const B &b){return a<b?(a=b,true):false;}\nconst double PI=acos(-1);\nconst double EPS=1e-7;\nDef inf=sizeof(Def)==sizeof(long long)?2e18:1e9;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\nint main(){\n\tint n;\n\twhile(cin>>n,n){\n\t\tmap<string,pii>ma;\n\t\tbool h=false;int t0=0;\n\t\trep(i,n){\n\t\t\tstring a,b,c;\n\t\t\tcin>>a>>a>>b>>c;\n\t\t\tint t=60*stoi(a.substr(0,2))+stoi(a.substr(3,2));\n\t\t\tif(c==\"000\"){\n\t\t\t\th^=1;\n\t\t\t\tif(h==false)\n\t\t\t\t\tfor(auto j=ma.begin();j!=ma.end();j++)if(j->second.second){\n\t\t\t\t\t\tj->second.first+=t-max(t0,j->second.second);\n\t\t\t\t\t}\n\t\t\t\tt0=t;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(b==\"I\") ma[c].second=t;\n\t\t\telse{\n\t\t\t\tif(h)ma[c].first+=t-max(t0,ma[c].second);\n\t\t\t\tma[c].second=0;\n\t\t\t}\n\t\t}\n\t\tint out=0;\n\t\tfor(auto i=ma.begin();i!=ma.end();i++)out=max(out,i->second.first);\n\t\tcout<<out<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n\nstruct data {\n  int m1,d1,h,m;\n  int time() const { return h*60+m; }\n  bool operator < (data const& d) const {\n    if(m1!=d.m1) return m1<d.m1;\n    if(d1!=d.d1) return d1<d.d1;\n    return h != d.h ? h < d.h : m < d.m;\n  }\n  \n};\n\nint main() {\n  int N;\n  while(cin >> N && N)\n  {\n    vector<data> v[1000];\n    int m1, d1, h, m, u;\n    char ch;\n    rep(i, N) {\n      scanf(\"%d/%d %d:%d %c %d\",\n            &m1, &d1, &h, &m, &ch, &u);\n      v[u].push_back((data){m1,d1,h,m});\n    }\n    rep(i, 1000) {\n      if(v[i].empty()) continue;\n      sort(v[i].begin(), v[i].end());\n    }\n    \n    int ans[1000] = {};\n    REP(i, 1, 1000) {\n      if(v[i].empty()) continue;\n      rep(j, v[i].size()/2) {\n        data const& vi0 = v[i][2*j], vi1 = v[i][2*j+1];\n        rep(k, v[0].size()/2) {\n          if(v[0][2*k].m1 != v[i][2*j].m1 || v[0][2*k].d1 != v[i][2*j].d1) continue;\n          data const& v00 = v[0][2*k], v01 = v[0][2*k+1];\n          ans[i] += max(0, min(v01.time(), vi1.time())\n                        - max(v00.time(), vi0.time()));\n        }\n      }\n    }\n    int a = 0;\n    rep(i, 1000) {\n      a = max(a, ans[i]);\n    }\n    cout << a << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <string>\n#include <cmath>\n#define inf 1e9\nusing namespace std;\n\nstruct data{\n    string day;\n    int time;\n    bool in;\n    int id;\n};\n\nint main(void){\n    int n;\n    while (cin >> n && n) {\n        vector<data> d(n);\n        for (int i = 0; i < n; i++) {\n            string a, b, c;\n            cin >> d[i].day >> a >> b >> c;\n            int t = stoi(a.substr(0,2))*60 + stoi(a.substr(3,2));\n            d[i].time = t;\n            if (b == \"I\") d[i].in = true;\n            else d[i].in = false;\n            d[i].id = stoi(c);\n        }\n    \n        int idx = 0;\n        vector<int> total(1000, 0);\n        while (1) {\n            string today = d[idx].day;\n            vector<int> gio;\n            vector<vector<int> > pio(1000);\n        \n            while (d[idx].day == today) {\n                if (d[idx].id == 0) gio.push_back(d[idx].time);\n                else pio[d[idx].id].push_back(d[idx].time);\n                if (++idx == n) break;\n            }\n        \n            for (int i = 0; i < 1000; i++) {\n                if (pio[i].size() == 0) continue;\n                for (int j = 0; j < pio[i].size(); j+=2) {\n                    for (int k = 0; k < gio.size(); k+=2) {\n                        if (pio[i][j] <= gio[k]) {\n                            if (pio[i][j+1] <= gio[k]) continue;\n                            else if (pio[i][j+1] <= gio[k+1]) total[i] += pio[i][j+1]-gio[k];\n                            else total[i] += gio[k+1]-gio[k];\n                        }\n                        else if (pio[i][j] <= gio[k+1]) {\n                            if (pio[i][j+1] <= gio[k+1]) total[i] += pio[i][j+1]-pio[i][j];\n                            else total[i] += gio[k+1]-pio[i][j];\n                        }\n                    }\n                }\n            }\n            if (idx == n) break;\n        }\n        int ans = 0;\n        for (int i = 0; i < 1000; i++) ans = max(ans, total[i]);\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef pair<int,int> pii;\n#define all(c) (c).begin(), (c).end()\n#define loop(i,a,b) for(ll i=a; i<ll(b); i++)\n#define rep(i,b) loop(i,0,b)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define lb lower_bound\n#define ub upper_bound\n#ifdef DEBUG\n#define dump(...) (cerr<<#__VA_ARGS__<<\" = \"<<(DUMP(),__VA_ARGS__).str()<<\" [\"<<__LINE__<<\"]\"<<endl)\nstruct DUMP:ostringstream{template<class T>DUMP &operator,(const T&t){if(this->tellp())*this<<\", \";*this<<t;return *this;}};\n#else\n#define dump(...)\n#endif\ntemplate<class T> ostream& operator<<(ostream& os, vector<T> const& v){\n    rep(i,v.size()) os << v[i] << (i+1==v.size()?\"\":\" \");\n    return os;\n}\n\nint N;\nint sum[1000];\nvector<pair<int,int>> logs[1000];\n\nint exist[3000000];\n\nint f(int m, int d, int h, int M){\n    return m*60*24*30 + d*60*24 + h*60 + M;\n}\n\nint main(){\n#ifdef DEBUG\n    freopen(\"in\",\"r\",stdin);\n#endif\n    while(~scanf(\"%d\\n\",&N) && N){\n        rep(i,1000) logs[i].clear();\n        memset(exist,0,sizeof(exist));\n        memset(sum,0,sizeof(sum));\n        rep(i,N){\n            int t, id;\n            char io;\n            int m,d,h,M;\n            scanf(\"%d/%d %d:%d \", &m,&d,&h,&M);\n            t = f(m,d,h,M);\n            cin >> io >> id;\n            if(io=='I'){\n                logs[id].eb(t,f(m,d,24,0));\n                if(id==0) exist[t]++;\n            } else {\n                logs[id].back().second = t;\n                if(id==0) exist[t]--;\n            }\n        }\n        rep(i,300000-1) exist[i+1] += exist[i];\n        rep(i,300000-1) exist[i+1] += exist[i];\n        int ans = 0;\n        rep(i,1000)if(i){\n            for(auto & p : logs[i]){\n                int l,r;\n                tie(l,r) = p;\n                sum[i] += exist[r]-exist[l];\n            }\n            ans = max(ans, sum[i]);\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef pair<int,int> pii;\n#define all(c) (c).begin(), (c).end()\n#define loop(i,a,b) for(ll i=a; i<ll(b); i++)\n#define rep(i,b) loop(i,0,b)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define lb lower_bound\n#define ub upper_bound\n#ifdef DEBUG\n#define dump(...) (cerr<<#__VA_ARGS__<<\" = \"<<(DUMP(),__VA_ARGS__).str()<<\" [\"<<__LINE__<<\"]\"<<endl)\nstruct DUMP:ostringstream{template<class T>DUMP &operator,(const T&t){if(this->tellp())*this<<\", \";*this<<t;return *this;}};\n#else\n#define dump(...)\n#endif\ntemplate<class T> ostream& operator<<(ostream& os, vector<T> const& v){\n    rep(i,v.size()) os << v[i] << (i+1==v.size()?\"\":\" \");\n    return os;\n}\n\nint N;\nint sum[1000];\nvector<pair<int,int>> logs[1000];\n\nint exist[564480+1000];\n\nint f(int m, int d, int h, int M){\n    return m*60*24*30 + d*60*24 + h*60 + M;\n}\n\nint main(){\n#ifdef DEBUG\n    freopen(\"in\",\"r\",stdin);\n    cout << f(12,31,24,00) << endl;\n#endif\n    while(~scanf(\"%d\\n\",&N) && N){\n        rep(i,1000) logs[i].clear();\n        memset(exist,0,sizeof(exist));\n        memset(sum,0,sizeof(sum));\n        rep(i,N){\n            int id;\n            char io;\n            int m,d,h,M;\n            scanf(\"%d/%d %d:%d \", &m,&d,&h,&M);\n            int t = f(m,d,h,M);\n            cin >> io >> id;\n            if(io=='I'){\n                logs[id].eb(t,f(m,d,24,0));\n                if(id==0) exist[t]++;\n            } else {\n                logs[id].back().second = t;\n                if(id==0) exist[t]--;\n            }\n        }\n        rep(i,300000-1) exist[i+1] += exist[i];\n        dump(vi(exist,exist+60));\n        rep(i,300000-1) exist[i+1] += exist[i];\n        dump(vi(exist,exist+60));\n        int ans = 0;\n        rep(i,1000)if(i){\n            for(auto & p : logs[i]){\n                int l,r;\n                tie(l,r) = p;\n                sum[i] += exist[r]-exist[l];\n            }\n            ans = max(ans, sum[i]);\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint convert(char x,char y){\n    return (x-'0')*10+y-'0';\n}\nint solve(int n){\n    vector<string> date(n);\n    vector<int> t(n);\n    vector<char> op(n);\n    vector<string> id(n);\n    for(int i=0;i<n;i++){\n        string buf;\n        cin>>date[i]>>buf>>op[i]>>id[i];\n        t[i]=convert(buf[0],buf[1])*60+convert(buf[3],buf[4]);\n    }\n\n    map<string,int> res;\n    map<string,vector<int>> events;\n    for(int i=0;i<n;i++) events[date[i]].push_back(i);\n\n    for(auto &kvp:events){\n        auto event=kvp.second;\n        stack<tuple<string,int,int>> outer;\n        map<string,int> inner;\n        int gin=0;\n        for(int idx:event){\n            if(id[idx]==\"000\"){\n                if(op[idx]=='I'){\n                    gin=t[idx];\n                }\n                else{\n                    for(auto &e:inner){\n                        res[e.first]+=t[idx]-max(gin,e.second);\n                    }\n                    while(!outer.empty()){\n                        auto tmp=outer.top(); outer.pop();\n                        res[get<0>(tmp)]+=max(get<2>(tmp)-max(get<1>(tmp),gin),0);\n                    }\n                }\n            }\n            else{\n                if(op[idx]=='I'){\n                    inner[id[idx]]=t[idx];\n                }\n                else{\n                    outer.push({id[idx],inner[id[idx]],t[idx]});\n                    inner.erase(id[idx]);\n                }\n            }\n        }        \n    }\n    int ret=0;\n    for(auto &e:res) if(e.first!=\"000\") ret=max(ret,e.second);\n    return ret;\n}\n    \nint main(){\n    int n;\n    while(cin>>n,n){\n        cout<<solve(n)<<endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,a,b) for(int i=a;i<b;i++)\n#define MAX_NUM 1005\n\ntypedef vector<int> vi;\n\nint main()\n{\n\twhile (1)\n\t{\n\t\tint n; cin >> n;\n\t\tif (n == 0) return 0;\n\n\t\tvi rec(MAX_NUM, -1);\n\t\tvi sum(MAX_NUM, 0);\n\n\t\trep(i, 0, n)\n\t\t{\n\t\t\tstring s;\n\n\t\t\tcin >> s;\n\t\t\tint d = (s[3] - '0') * 10 + (s[4] - '0');\n\n\t\t\tcin >> s;\n\t\t\tint h = (s[0] - '0') * 10 + (s[1] - '0');\n\t\t\tint m = (s[3] - '0') * 10 + (s[4] - '0');\n\n\t\t\tint time = d * 60 * 60 + h * 60 + m;\n\n\t\t\tchar e; cin >> e;\n\t\t\tint p; cin >> p;\n\n\t\t\tif (e == 'I')\n\t\t\t{\n\t\t\t\trec[p] = time;\n\t\t\t}\n\t\t\telse if (e == 'O')\n\t\t\t{\n\t\t\t\tif (p == 0)\n\t\t\t\t{\n\t\t\t\t\trep(j, 1, MAX_NUM)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (rec[j] >= 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsum[j] += time - max(rec[j], rec[0]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\trec[0] = -1;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (rec[0] >= 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tsum[p] += time - max(rec[0], rec[p]);\n\t\t\t\t\t}\n\n\t\t\t\t\trec[p] = -1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tint ans = 0;\n\t\trep(i, 0, MAX_NUM) ans = max(ans, sum[i]);\n\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<map>\n#include<cstdlib>\n#include<queue>\n#include<stack>\n#include<vector>\n#include<ctype.h>\n#include<algorithm>\n#include<string>\n#define PI acos(-1.0)\n#define maxn 10005\n#define INF 0x7fffffff\ntypedef long long ll;\nusing namespace std;\nint vis[1000][2][10];\nint visitor[105],length[1000];\nint main()\n{\n    int  n,month,day,time[2],mi,id,res=0,t1,t2;\n    char ch;\n    while(scanf(\"%d\",&n),n)\n    {\n        res = 0;\n        memset(vis,0,sizeof(vis));\n        memset(length,0,sizeof(length));\n        int flag=0,k=0;\n        month = day = t1 = t2 = 0;\n        while(n--)\n        {\n            scanf(\"%d/%d\",&month,&day);\n            if(month!=t1||day!=t2)\n            {\n                k = 0;\n                t1 = month;\n                t2 = day;\n            }\n            scanf(\"%d:%d\",&time[0],&time[1]);\n            mi = time[0]*60+time[1];\n            getchar();\n            scanf(\"%c\",&ch);\n            scanf(\"%d\",&id);\n            if(ch=='I'&&id!=0)\n                visitor[++k] = id;\n            if(ch=='I')\n            {\n                vis[id][0][3] = mi;\n                vis[id][0][4] = flag;\n                vis[id][1][4] = 0;\n                if(id==0)flag = 1;\n            }\n            else\n            {\n                vis[id][1][3] = mi;\n                vis[id][1][4] = 1;\n                if(flag==1)\n                {\n                    if(id!=0)\n                    {\n                        if(vis[id][0][4]==0)\n                            length[id]+= vis[id][1][3]-vis[0][0][3];\n                        else\n                        {\n                            length[id]+=vis[id][1][3]-vis[id][0][3];\n                            vis[id][0][4]=0;\n                        }\n                    }\n                    else\n                    {\n                        flag = 0;\n                        int rec=0;\n                        for(int cc=1; cc<=k; cc++)\n                        {\n                            if(vis[visitor[cc]][1][4]==0)\n                            {\n                                if(vis[visitor[cc]][0][4]==0)\n                                {\n                                    length[visitor[cc]]+= vis[0][1][3]-vis[0][0][3];\n                                    visitor[++rec] = visitor[cc];\n                                }\n                                else\n                                {\n                                    length[visitor[cc]]+= vis[0][1][3]-vis[visitor[cc]][0][3];\n                                    vis[visitor[cc]][0][4]=0;\n                                }\n                            }\n                        }\n                        k = rec;\n                    }\n                }\n            }\n        }\n        for(int i=1; i<=999; i++)\n            if(length[i]>res)\n                res = length[i];\n        printf(\"%d\\n\",res);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <map>\n#include <algorithm>\n#include <cstring>\n#include <vector>\nusing namespace std;\n\nconst int MAX_N = 1000;\n\nstruct data{\n\tint time, id;\n\tbool in;\n};\n\n\nmap<pair<int,int>, vector<data> > dict;\n\nbool is_in[MAX_N];\nint total[MAX_N];\n\n\nbool operator<(const data& lhs, const data& rhs){\n\treturn lhs.time != rhs.time ? lhs.time < rhs.time : lhs.id < rhs.id;\n}\n\nbool init(){\n\tint N;\n\tdict.clear();\n\tmemset(total, 0, sizeof(total));\n\tscanf(\"%d\", &N);\n\tif(!N){\n\t\treturn false;\n\t}\n\tfor(int i=0; i<N; i++){\n\t\tint month, day, hour, minute, id;\n\t\tchar in;\n\t\tscanf(\"%d/%d %d:%d %c %d \", &month, &day, &hour, &minute, &in, &id);\n\t\tdict[ make_pair(month, day) ].push_back( (data){ hour*60 + minute, id, in == 'I' } );\n\t}\n\treturn true;\n}\n\nvoid proc(const vector<data>& ds){\n\tmemset(is_in, false, sizeof(is_in));\n\tfor(int t=0; t<60*24; t++){\n\t\tfor(int i=0; i<(int)ds.size(); i++){\n\t\t\tconst data& d = ds[i];\n\t\t\tif(d.time == t){\n\t\t\t\tis_in[d.id] = d.in;\n\t\t\t}\n\t\t}\n\t\tif( is_in[0] ){\n\t\t\tfor(int i=1; i<MAX_N; i++){\n\t\t\t\tif(is_in[i]){\n\t\t\t\t\ttotal[i]++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nint solve(){\n\tfor(map<pair<int,int>, vector<data> >::iterator itr=dict.begin(); itr!=dict.end(); itr++){\n\t\tproc(itr->second);\n\t}\n\t\n\treturn *max_element(total+1, total+MAX_N);\n}\n\nint main(){\n\twhile(init()){\n\t\tprintf(\"%d\\n\", solve());\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\nusing namespace std;\nint lastin[1111];\nint blessed[1111];\nbool manin[1111];\nbool valkyria_in;\nint valkyria_time;\nint n;\nstring s;\nint ans;\nint hr,mi;\nchar mmmmm;\nint inde;\nvoid solve(){\n\tint t=hr*60+mi;\n\tif(mmmmm=='I'){\n\t\tif(inde==0){\n\t\t\tvalkyria_in=true;\n\t\t\tvalkyria_time=t;\n\t\t}\n\t\telse{\n\t\t\tmanin[inde]=true;\n\t\t\tlastin[inde]=t;\n\t\t}\n\t}\n\telse{\n\t\tif(inde==0){\n\t\t\tvalkyria_in=false;\n\t\t\tfor(int i=1;i<1111;i++){\n\t\t\t\tif(manin[i])blessed[i]+=t-max(lastin[i],valkyria_time);\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tmanin[inde]=false;\n\t\t\tif(valkyria_in)blessed[inde]+=t-max(lastin[inde],valkyria_time);\n\t\t}\n\t}\n}\nint main(){\n\twhile(cin>>n&&n>0){\n\t\tans=0;\n\t\tmemset(manin,0,sizeof(manin));\n\t\tmemset(blessed,0,sizeof(blessed));\n\t\tvalkyria_in=false;\n\t\twhile(n--){\n\t\t\tcin>>s>>hr>>mmmmm>>mi>>mmmmm>>inde;\n\t\t\tsolve();\n\t\t}\n\t\tfor(int i=1;i<1111;i++)ans=max(ans,blessed[i]);\n\t\tcout<<ans<<\"\\n\";\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include\"bits/stdc++.h\"\n\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\nusing pii = pair<int, int>;\nusing pll = pair<ll, ll>;\n\n#define FOR(k,m,n) for(ll (k)=(m);(k)<(n);(k)++)\n#define REP(i,n) FOR((i),0,(n))\n#define WAITING(str) int str;std::cin>>str;\n#define DEBUGING(str) cout<< #str << \" \" str<<endl\n\nconstexpr int INF = (1 << 30);\nconstexpr ll INFL = (1ll << 60);\nconstexpr ll MOD = 1000000007;// 10^9+7\n\nstruct Time {\n\tTime() :h(0), m(0), idx(\"\") {}\n\tTime(string time, string _idx) :idx(_idx) {\n\t\th = (time[0] - '0') * 10 + (time[1] - '0');\n\t\tm = (time[3] - '0') * 10 + (time[4] - '0');\n\t}\n\tint h, m;\n\tstring idx;\n\tint diff(const Time& opp)const {\n\t\treturn trans() - opp.trans();\n\t}\n\tint trans() const {\n\t\treturn h * 60 + m;\n\t}\n};\n\nint main()\n{\n\twhile (true) {\n\t\tint n;\n\t\tcin >> n;\n\t\tif (!n)break;\n\n\t\tTime goddess;\n\t\tmap<string, Time> mp;\n\t\tmap<string, int> res;\n\t\tREP(i, n) {\n\t\t\tstring date, time, kind, id;\n\t\t\tcin >> date >> time >> kind >> id;\n\t\t\tTime tgt(time, id);\n\n\t\t\tif (kind == \"I\") {\n\t\t\t\t(tgt.idx == \"000\" ? goddess : mp[tgt.idx]) = tgt;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (tgt.idx == \"000\") {\n\t\t\t\t\tfor (auto itr = mp.begin(); itr != mp.end(); ++itr) {\n\t\t\t\t\t\tstring name = itr->first;\n\t\t\t\t\t\tTime opp = itr->second;\n\t\t\t\t\t\tres[name] += opp.diff(goddess) > 0\n\t\t\t\t\t\t\t? tgt.diff(opp)\n\t\t\t\t\t\t\t: tgt.diff(goddess);\n\t\t\t\t\t}\n\t\t\t\t\tgoddess = Time();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (goddess.h != 0) {\n\t\t\t\t\t\tTime in = mp[tgt.idx];\n\t\t\t\t\t\tres[tgt.idx] += in.diff(goddess) > 0\n\t\t\t\t\t\t\t? tgt.diff(in)\n\t\t\t\t\t\t\t: tgt.diff(goddess);\n\t\t\t\t\t}\n\t\t\t\t\tmp.erase(tgt.idx);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tint mm = 0;\n\t\tfor (auto itr = res.begin(); itr != res.end(); ++itr)\n\t\t\tmm = max(mm, itr->second);\n\t\tcout << mm << endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nint sum[1000];\nint gods,gode;\nint list[1000]; //0 is logout \n\nint main(void){\n\tint n;\n\twhile(cin >> n,n){\n\t\tfor(int i=0;i<1000;i++)\n\t\t\tsum[i]=0;\n\t\tint cm=0,cd=0;\n\n\t\tfor(int i=0;i<n;i++){\n\t\t\tstring s;\n\t\t\tint m,d;\n\t\t\tcin >> s;\n\t\t\tm=(s[0]-'0')*10+(s[1]-'0');\n\t\t\td=(s[3]-'0')*10+(s[4]-'0');\n\t\t\tif(m!=cm||d!=cd)\n\t\t\t\tfor(int i=0;i<1000;i++)\n\t\t\t\t\tlist[i]=0;\n\t\t\tcm=m,cd=d;\n\t\t\tcin >> s;\n\t\t\tint min=((s[0]-'0')*10+(s[1]-'0'))*60+((s[3]-'0')*10+(s[4]-'0'));\n\t\t\tchar state;int num;\n\t\t\tcin >> state >> num;\n\t\t\t\n\t\t\tif(state=='I')\n\t\t\t\tlist[num]=min;\n\t\t\telse{\n\t\t\t\tif(num){\n\t\t\t\t\tif(list[0]){\n\t\t\t\t\t\tint start=max(list[0],list[num]);\n\t\t\t\t\t\tsum[num]+=min-start;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tfor(int j=1;j<1000;j++){\n\t\t\t\t\t\tif(list[j]){\n\t\t\t\t\t\t\tint start=max(list[0],list[j]);\n\t\t\t\t\t\t\tsum[j]+=min-start;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlist[num]=0;\n\t\t\t}\n\t\t}\n\n\t\tint ans=0;\n\t\tfor(int i=1;i<1000;i++)\n\t\t\tans=max(ans,sum[i]);\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <map>\n#include <cstdlib>\n\nusing namespace std;\n\nint getTime(string s){\n  int a=atoi(s.substr(0,2).c_str());\n  int b=atoi(s.substr(3,2).c_str());\n  return a*60+b;\n}\nint main(){\n  int n;\n  while(cin>>n&&n){\n    map<string,int> ans;\n    map<string,int> info;\n    for(int i=0;i<n;i++){\n      string s1,s2,s3,s4;\n      cin>>s1>>s2>>s3>>s4;\n      int time=getTime(s2);\n      if(s3==\"I\")info[s4]=time;\n      else{\n\tint diff=time-info[s4];\n\tif(s4==\"000\"){\n\t  for(map<string,int>::iterator it=info.begin();\n\t      it!=info.end();it++){\n\t    if(it->first==\"000\")continue;\n\t    int a=time-max(info[\"000\"],(it->second));\n\t    ans[it->first]+=a;\n\t  }\n\t}\n\telse if(info.count(\"000\")>0)\n\t  ans[s4]+=(time-max(info[\"000\"],info[s4]));\n\tinfo.erase(s4);\n      }\n    }\n    int res=0;\n    for(map<string,int>::iterator it=ans.begin();\n\tit!=ans.end();it++)\n      res=max(res,it->second);\n    cout<<res<<endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <queue>\n#include <map>\n#include <set>\n#include <algorithm>\n\n#define FOR(i,k,n) for (int i=(k); i<(int)(n); ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define sz size()\n#define pb push_back\n#define mp make_pair\n#define ALL(X) (X).begin(),(X).end()\n\nusing namespace std;\n\nconst int INF = 1000000000;\nconst double eps = 1e-8;\n\nint dayid(string str) {\n  int m = atoi(str.substr(0,2).c_str());\n  int d = atoi(str.substr(3,2).c_str());\n  return m * 40 + d;\n}\n\nint main(void) {\n  while(1) {\n    int n;\n    cin>>n;\n    if(!n)break;\n    vector<int> times(1);\n    map<int,int> pger;\n    int gdsin = -1;\n    REP(i,n){\n      string day,time,io;\n      int id;\n      cin>>day>>time>>io>>id;\n      int timet = atoi(time.substr(0,2).c_str()) * 60 + atoi(time.substr(3,2).c_str());\n      if(id == 0) {\n        if(io == \"I\") {\n          gdsin = timet;\n        }else{\n          for(map<int,int>::iterator p = pger.begin(); p != pger.end(); ++p) {\n            int in = max(p->second,gdsin);\n            times[p->first] += timet - in;\n          }\n          gdsin = -1;\n        }\n      }else{\n        if(io == \"I\") {\n          if(id >= times.size()) {\n            times.resize(id+1);\n            //times[id] = 0;\n          }\n          pger.insert(make_pair(id,timet));\n        }else{\n          map<int,int>::iterator itr = pger.find(id);\n          if(gdsin >= 0) {\n            int in = max(itr->second,gdsin);\n            times[id] += timet - in;\n          }\n          pger.erase(itr);\n        }\n      }\n    }\n    int m = 0;\n    REP(i,times.size()) {\n      m = max(m,times[i]);\n    }\n    cout << m <<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n\nstruct segtree{\n  vector<int> datasum;\n  vector<int> delay;\n \n  int n;\n \n  //テ・ツ按敕ヲツ慊淌・ツ個?\n  void init(int _n){\n    n = 1;\n    while( n < _n ) n*=2;\n    datasum.resize( 2 * n );\n    delay.resize( 2 * n );\n  }\n \n  //テ」ツつッテ」ツδェテ」ツつ「(テ、ツスツ陛・ツコツヲテ」ツつづ、ツスツソテ」ツ??・ツ?エテ・ツ青暗ッツシツ?\n  void clear(){\n    datasum.clear();\n    delay.clear();\n  }\n  \n  void delaycalc(int k,int l,int r){\n    datasum[k] = datasum[k] + delay[k]*(r-l);\n    if( k+1 < n ){\n      for(int i=1;i<=2;i++){\n\tdelay[2*k+i] = delay[2*k+i]+delay[k];\n      }\n    }\n    delay[k] = 0;\n  }   \n \n  //テ・ツ個コテゥツ鳴禿」ツ??a,b)テ」ツ??」ツ?ォテ、ツクツ?ヲツァツ佚」ツ?ォテ」ツ??テ」ツ??」ツつ津ィツカツウテ」ツ??\n  void add(int a,int b,int x,int k,int l,int r){\n    delaycalc(k,l,r);\n    if( r<=a || b<=l ) return;\n    else if( a<=l && r<=b ){\n      delay[k] = x;\n      delaycalc(k,l,r);\n    } else {\n      add( a, b, x, 2*k + 1, l, (l+r)/2 );\n      add( a, b, x, 2*k + 2, (l+r)/2, r );\n      datasum[k] = datasum[2*k+1]+datasum[2*k+2];\n    }\n  }\n \n  int querysum(int a,int b,int k,int l,int r){\n    delaycalc(k,l,r);\n    if( r<=a || b<=l ) return 0;\n    if( a<=l && r<=b ){\n      return datasum[k]+delay[k]*(r-l);\n    } else {\n      int vl = querysum( a, b, 2*k+1, l,(l+r)/2 );\n      int vr = querysum( a, b, 2*k+2, (l+r)/2,r );\n      return vl+vr;\n    }\n  }\n \n  void add( int a,int b,int x){ add( a, b, x, 0,0,n); }\n  int querysum(int a,int b){ return querysum(a,b,0,0,n); }\n};\ntypedef pair<int,int> P;\nsegtree S[420];\nvector<P> st[1001];\nbool used[420];\nint main(){\n  int N;\n  while(cin >> N && N ){\n    for(int i=0;i<N;i++){\n      int m,d,h,mi,no;\n      char ex;\n      scanf(\"%d/%d %d:%d %c %d\",&m,&d,&h,&mi,&ex,&no);\n      int dt = m*31+d;\n      int mini = h * 60 + mi;\n      st[no].push_back(P(dt,mini));\n    }\n    memset(used,0,sizeof(used));\n    sort(st[0].begin(),st[0].end());\n    for(int i=0;i<(int)st[0].size();i+=2){\n      int dat = st[0][i].first;\n      int sta = st[0][i].second;\n      int ed = st[0][i+1].second;\n      if( !used[dat] ){\n\tS[dat].init(60*24+1);\n      }\n      used[dat] = true;\n      S[dat].add(sta,ed,1);\n    }\n    int res = 0;\n    for(int i=1;i<1000;i++){\n      sort(st[i].begin(),st[i].end());\n      int r=0;\n      for(int j=0;j<(int)st[i].size();j+=2){\n\tint dat = st[i][j].first;\n\tint sta = st[i][j].second;\n\tint ed = st[i][j+1].second;\n\tif( !used[dat] ) continue;\n\tr+=S[dat].querysum( sta, ed );\n      }\n      res = max( res, r );\n    }\n    for(int i=0;i<420;i++){\n      st[i].clear();\n      S[i].clear();\n    }\n    cout << res << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n\tlong long int N;\n\twhile(cin >> N , N)\n\t{\n\t\tmap<string , pair<long long int , long long int>>data;\n\t\tset<string>IO;\n\t\tbool f = false;\n\t\tstring today;\n\t\tfor(size_t i = 0; i < N; i++)\n\t\t{\n\t\t\tstring MD , who;\n\t\t\tcin >> MD;\n\t\t\tif(today != MD)\n\t\t\t{\n\t\t\t\tIO.clear();\n\t\t\t\ttoday=MD;\n\t\t\t}\n\t\t\tint h , m;\n\t\t\tchar c;\n\t\t\tcin >> h >> c >> m;\n\t\t\tcin >> c;\n\t\t\tcin >> who;\n\t\t\tif(c == 'I')\n\t\t\t{\n\t\t\t\tif(who == \"000\")\n\t\t\t\t{\n\t\t\t\t\tf = true;\n\t\t\t\t\tfor(auto x : IO)\n\t\t\t\t\t{\n\t\t\t\t\t\tdata[x].first = h * 60 + m;\n\t\t\t\t\t}\n\t\t\t\t} else\n\t\t\t\t{\n\t\t\t\t\tIO.insert(who);\n\t\t\t\t\tif(f)\n\t\t\t\t\t{\n\t\t\t\t\t\tdata[who].first = h * 60 + m;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else\n\t\t\t{\n\t\t\t\tif(who == \"000\")\n\t\t\t\t{\n\t\t\t\t\tf = false;\n\t\t\t\t\tfor(auto x : IO)\n\t\t\t\t\t{\n\t\t\t\t\t\tdata[x].second += h * 60 + m - data[x].first;\n\t\t\t\t\t}\n\t\t\t\t} else\n\t\t\t\t{\n\t\t\t\t\tIO.erase(who);\n\t\t\t\t\tif(f)\n\t\t\t\t\t{\n\t\t\t\t\t\tdata[who].second += h * 60 + m - data[who].first;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tlong long int ans1 , ans2;\n\t\tfor(auto x : data)\n\t\t{\n\t\t\tif(x.second.second > ans1)\n\t\t\t{\n\t\t\t\tans1 = x.second.second;\n\t\t\t}\n\t\t}\n\t\tcout << ans1 << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "/*\n * GCA : \"Computer is artificial subject absolutely,Math is God\"\n */\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <vector>\n#include <set>\n#include <map>\n#include <queue>\n#include <cctype>\n#include <utility>\n\nusing namespace std;\n#ifdef DEBUG\n#define VAR(a,b) __typeof(b) a=(b)\n#define debug(...) printf(\"DEBUG: \"),printf(__VA_ARGS__)\n#else\n#define VAR(a,b) __typeof(b) a=(b)\n#define debug(...)\n#endif\ntypedef unsigned int uint;\ntypedef long long int Int;\ntypedef unsigned long long int UInt;\n#define Set(a,s) memset(a,s,sizeof(a))\n#define Pln() printf(\"\\n\")\n#define For(i,x)for(int i=0;i<x;i++)\n#define CON(x,y) x##y\n#define M 1005\n#define PB push_back\n#define oo INT_MAX\n#define FOR(a,b) for(VAR(a,(b).begin());a!=(b).end();++a)\n#define eps 1e-9\n#define X first\n#define Y second\ninline bool xdy(double x,double y){return x>y+eps;}\ninline bool xddy(double x,double y){return x>y-eps;}\ninline bool xcy(double x,double y){return x<y-eps;}\ninline bool xcdy(double x,double y){return x<y+eps;}\nconst Int mod=1000000007;\nint n;\nint god[M];\nint ti[M];\nint inti[M];\nint sid[M];\nchar ppl[M];\nint main() {\n\tios_base::sync_with_stdio(0);\n\twhile(~scanf(\"%d\",&n)&&n){\n\t\tSet(inti,-1);\n\t\tSet(god,0);\n\t\tfor(int i=0;i<n;i++){\n\t\t\tint mon,d,h,m;\n\t\t\tscanf(\"%d/%d %d:%d \",&mon,&d,&h,&m);\n\t\t\tti[i]=mon*100*24*60+d*24*60+h*60+m;\n\t\t\tscanf(\"%c %d\",&ppl[i],&sid[i]);\n\t\t}\n\t\tbool godtime=false;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tif(ppl[i]=='I'){\n\t\t\t\tif(sid[i]==0){\n\t\t\t\t\tgodtime=true;\n\t\t\t\t\tfor(int j=1;j<n;j++){\n\t\t\t\t\t\tif(inti[j]!=-1){\n\t\t\t\t\t\t\tinti[j]=ti[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tinti[sid[i]]=ti[i];\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(sid[i]==0){\n\t\t\t\t\tfor(int j=1;j<n;j++){\n\t\t\t\t\t\tif(inti[j]!=-1)god[j]+=ti[i]-inti[j];\n\t\t\t\t\t}\n\t\t\t\t\tgodtime=false;\n\t\t\t\t}else{\n\t\t\t\t\tif(godtime&&inti[sid[i]]!=-1){\n\t\t\t\t\t\tgod[sid[i]]+=ti[i]-inti[sid[i]];\n\t\t\t\t\t}\n\t\t\t\t\tinti[sid[i]]=-1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans=0;\n\t\tfor(int i=1;i<1000;i++){\n\t\t\tans=max(ans,god[i]);\n\t\t}\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n\nusing namespace std;\n\nint main()\n{\n\tfor(int n;scanf(\"%d\",&n),n;){\n\t\tvector<int> sums(1000);\n\t\tvector<int> begins(1000,-1);\n\t\twhile(n--){\n\t\t\tint h,m,id; char t;\n\t\t\tscanf(\"%*d/%*d %d:%d %c %d\",&h,&m,&t,&id);\n\t\t\tif(t=='I'){\n\t\t\t\tbegins[id]=h*60+m;\n\t\t\t\tif(id==0){\n\t\t\t\t\tfor(int i=1;i<1000;i++)\n\t\t\t\t\t\tif(begins[i]!=-1)\n\t\t\t\t\t\t\tbegins[i]=h*60+m;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(t=='O'){\n\t\t\t\tif(id==0){\n\t\t\t\t\tfor(int i=1;i<1000;i++)\n\t\t\t\t\t\tif(begins[i]!=-1)\n\t\t\t\t\t\t\tsums[i]+=h*60+m-begins[i];\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tif(begins[0]!=-1)\n\t\t\t\t\t\tsums[id]+=h*60+m-begins[id];\n\t\t\t\t}\n\t\t\t\tbegins[id]=-1;\n\t\t\t}\n\t\t}\n\t\tint res=0;\n\t\tfor(int i=0;i<1000;i++)\n\t\t\tres=res<sums[i]?sums[i]:res;\n\t\tprintf(\"%d\\n\",res);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#pragma warning(disable:4996)\n\n#define MAX_N 10000\n#define MAX_M 501\n\nint Q;\nint M[MAX_N], D[MAX_N], h[MAX_N], m[MAX_N], t[MAX_N], n[MAX_N];\nint K[MAX_N], L[MAX_N];\nchar c;\n\nint main() {\n\twhile (true) {\n\t\tfor (int i = 0; i < MAX_N; i++) { M[i] = 0; D[i] = 0; h[i] = 0; m[i] = 0; t[i] = 0; n[i] = 0; K[i] = 0; L[i] = 0; }\n\t\tbool megami = false; int zenkai = 0; cin >> Q; if (Q == 0) { break; }\n\t\tfor (int i = 0; i < Q; i++) {scanf(\"%02d/%02d %02d:%02d %c %03d\", &M[i], &D[i], &h[i], &m[i], &c, &n[i]); if (c == 'I') { t[i] = 0; } else { t[i] = 1; }}\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tif (t[i] == 0) { L[n[i]] = 1; }if (t[i] == 1) { L[n[i]] = 0; }\n\t\t\tif (megami == true) { for (int j = 0; j < MAX_M; j++) { if (L[j] == 1) { K[j] += (h[i] * 60 + m[i]) - zenkai; } } }\n\t\t\tzenkai = h[i] * 60 + m[i]; if (L[0] == 0) { megami = true; } else { megami = false; }\n\t\t}\n\t\tint maxn = 0; for (int i = 1; i < MAX_M; i++) { maxn = max(maxn, K[i]); }cout << maxn << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n\nusing namespace std;\n\nint main(){\n\tfor(int n;scanf(\"%d\",&n),n;){\n\t\tint bless[1000]={};\n\t\tstatic bool t[1000][1440]={};\n\n\t\tint enter[1000],last[1000];\n\t\trep(i,1000) enter[i]=last[i]=-1;\n\n\t\tint pre=-1,date;\n\t\trep(k,n+1){\n\t\t\tif(k<n){\n\t\t\t\tint mon,day,hh,mm,id;\n\t\t\t\tscanf(\"%d%*c%d %d%*c%d %*c %d\",&mon,&day,&hh,&mm,&id);\n\t\t\t\tdate=31*mon+day;\n\t\t\t\tlast[id]=date;\n\n\t\t\t\tif(enter[id]==-1){\n\t\t\t\t\tenter[id]=60*hh+mm;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tfor(int j=enter[id];j<60*hh+mm;j++) t[id][j]=true;\n\t\t\t\t\tenter[id]=-1;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tdate=7777777;\n\t\t\t}\n\n\t\t\tif(pre!=date){\n\t\t\t\trep(i,1000) if(last[i]==pre) rep(j,1440) if(t[i][j] && t[0][j]) bless[i]++;\n\t\t\t\trep(i,1000) if(last[i]==pre) rep(j,1440) t[i][j]=false;\n\t\t\t}\n\t\t\tpre=date;\n\t\t}\n\n\t\tprintf(\"%d\\n\",*max_element(bless+1,bless+1000));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n//C++11\n#if __cplusplus == 201103L\n#include <tuple>\n#endif\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)n; ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cout<<*i<<\" \"; cout<<endl; }\n\ntypedef long long ll;\nconst int INF = 100000000;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\nint tominute(int h, int d){\n  return h * 60 + d;\n}\n\nint main(){\n  int N;\n  while(cin>>N && N){\n    int sum[1000] = {};\n    bool in[1000] = {};\n    int time[1000];\n    REP(i, N){\n      int m, d, hh, mm, id;\n      char c;\n      scanf(\"%d/%d %d:%d %c %d\", &m, &d, &hh, &mm, &c, &id);\n      if(c == 'I'){\n        in[id] = true;\n        if(id == 0){\n          REP(i, 1000)if(in[i]) time[i] = tominute(hh, mm);\n        }else if(in[0]){\n          time[id] = tominute(hh, mm);\n        }\n      }else{\n        in[id] = false;\n        if(id == 0){\n          REP(i, 1000)if(in[i]) sum[i] += tominute(hh, mm) - time[i];\n        }else if(in[0]){\n          sum[id] += tominute(hh, mm) - time[id];\n        }\n      }\n    }\n    cout<< *max_element(sum + 1, sum + 1000) << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "////////////////////////////////////////\n///  tu3 pro-con template            ///\n////////////////////////////////////////\n#include \"bits/stdc++.h\"\nusing namespace std;\n\n// -- loop macros -- //\n#define REP(i,n) for (int i = 0; i < (n); i++)\n#define RREP(i,n) for (int i = (n)-1; i >= 0; i--)\n#define FOR(i,s,n) for (int i = (int)(s); i < (n); i++)\n#define RFOR(i,s,n) for (int i = (n)-1; i >= (s); i--)\n#define FOREACH(i,container) for (auto &&i : container)\n#define allof(c) c.begin(), c.end()\n#define partof(c,i,n) c.begin() + (i), c.begin() + (i) + (n)\n\n// -- functors -- //\n#define PREDICATE(t,a,exp) [&](const t & a) -> bool { return exp; }\n#define COMPARISON(t,a,b,exp) [&](const t & a, const t & b) -> bool { return exp; }\n\n#define PRED(a,exp) [&](const auto & a) -> bool { return exp; }\n#define COMP(a,b,exp) [&](const auto & a, const auto & b) -> bool { return exp; }\n#define CONV1(a,exp) [&](const auto & a) -> auto { return exp; }\n#define CONV2(a,b,exp) [&](const auto & a, const auto & b) -> auto { return exp; }\n#define CONV3(a,b,c,exp) [&](const auto & a, const auto & b, const auto & c) -> auto { return exp; }\n\n// -- typedefs -- //\n#define EPS 1e-9\n\ntypedef unsigned int uint;\ntypedef long long llong;\ntypedef unsigned long long ullong;\n\n// -- I/O Helper -- //\nstruct _Reader { _Reader(istream &cin) :cin(cin) {} istream &cin; template <class T> _Reader operator ,(T &rhs) { cin >> rhs; return *this; } };\nstruct _Writer { _Writer(ostream &cout) :cout(cout) {} ostream &cout; bool f{ false }; template <class T> _Writer operator ,(const T &rhs) { cout << (f ? \" \" : \"\") << rhs; f = true; return *this; } };\n#define READ(t,...) t __VA_ARGS__; (_Reader{cin}), __VA_ARGS__\n#define WRITE(...) (_Writer{cout}), __VA_ARGS__; cout << '\\n'\n#define DEBUG(...) (_Writer{cerr}), __VA_ARGS__; cerr << '\\n'\n\n// -- vevector -- //\ntemplate <class T> struct vevector : public vector<vector<T>> { vevector(size_t n = 0, size_t m = 0, const T &initial = T()) : vector<vector<T>>(n, vector<T>(m, initial)) { } };\ntemplate <class T> struct vevevector : public vector<vevector<T>> { vevevector(size_t n = 0, size_t m = 0, size_t l = 0, const T &initial = T()) : vector<vevector<T>>(n, vevector<T>(m, l, initial)) { } };\ntemplate <class T> struct vevevevector : public vector<vevevector<T>> { vevevevector(size_t n = 0, size_t m = 0, size_t l = 0, size_t k = 0, const T &initial = T()) : vector<vevevector<T>>(n, vevevector<T>(m, l, k, initial)) { } };\n\nnamespace std {\n\ttemplate <class T1, class T2> inline istream & operator >> (istream & in, pair<T1, T2> &p) { in >> p.first >> p.second; return in; }\n\ttemplate <class T1, class T2> inline ostream & operator << (ostream &out, const pair<T1, T2> &p) { out << p.first << \" \" << p.second; return out; }\n}\n\ntemplate <class T> T read() { T t; cin >> t; return t; }\ntemplate <class T> vector<T> read(int n) { vector<T> v; REP(i, n) { v.push_back(read<T>()); } return v; }\ntemplate <class T> vevector<T> read(int n, int m) { vevector<T> v; REP(i, n) v.push_back(read<T>(m)); return v; }\ntemplate <class T> vector<T> readjag() { return read<T>(read<int>()); }\ntemplate <class T> vevector<T> readjag(int n) { vevector<T> v; REP(i, n) v.push_back(readjag<T>()); return v; }\n\ntemplate <class T> struct iter_pair_t { T beg, end; };\ntemplate <class T> iter_pair_t<T> iter_pair(T beg, T end) { return iter_pair_t<T>{beg, end}; }\ntemplate <class T> ostream & operator << (ostream &out, iter_pair_t<T> v) { if (v.beg != v.end) { out << *v.beg++; while (v.beg != v.end) { out << \" \" << *v.beg++; } } return out; }\ntemplate <class T1> ostream & operator << (ostream &out, const vector<T1> &v) { return out << iter_pair(begin(v), end(v)); }\n\n// -- etc -- //\ntemplate <class T> T infinity_value();\n#define DEFINE_INFINITY_VALUE(T, val) template <> constexpr T infinity_value<T>() { return (val); }\nDEFINE_INFINITY_VALUE(int, 1 << 28);\nDEFINE_INFINITY_VALUE(uint, 1u << 28);\nDEFINE_INFINITY_VALUE(llong, 1ll << 60);\nDEFINE_INFINITY_VALUE(ullong, 1ull << 60);\nDEFINE_INFINITY_VALUE(double, HUGE_VAL);\nDEFINE_INFINITY_VALUE(float, HUGE_VAL);\n#define INF(T) infinity_value<T>()\n\ninline int sign_of(double x) { return (abs(x) < EPS ? 0 : x > 0 ? 1 : -1); }\ntemplate <class TInt> bool in_range(TInt val, TInt min, TInt max) { return val >= min && val < max; }\ntemplate <> bool in_range<double>(double val, double min, double max) { return val - min > -EPS && val - max < EPS; }\ntemplate <> bool in_range<float>(float val, float min, float max) { return val - min > -EPS && val - max < EPS; }\ntemplate <class TInt> bool in_range2d(TInt x, TInt y, TInt w, TInt h) { return x >= 0 && x < w && y >= 0 && y < h; }\nvector<int> iotavn(int start, int count) { vector<int> r(count); iota(allof(r), start);\treturn r; }\n\n// 文字列の分割\nvector<string> split(const string &str, const string &s, bool removeEmpty = false)\n{\n\tvector<string> ret;\n\tsize_t p = 0, sl = s.size();\n\twhile (true)\n\t{\n\t\tsize_t q = str.find(s, p);\n\t\tif (q == str.npos) break;\n\t\tret.push_back(str.substr(p, q - p));\n\t\tp = q + sl;\n\t}\n\tret.push_back(str.substr(p));\n\tif (removeEmpty) ret.erase(remove(allof(ret), string()), ret.end());\n\treturn ret;\n}\n\n//// start up ////\nvoid solve();\nint main()\n{\n\t//// for local debugging\n\t//freopen(\"input.txt\", \"r\", stdin);\n\t//freopen(\"output.txt\", \"w\", stdout);\n\n\tauto classic_table = ctype<char>::classic_table();\n\tvector<ctype<char>::mask> ctable(classic_table, classic_table + ctype<char>::table_size);\n\tctable[':'] |= ctype_base::space; // as delimitor\n\tctable['/'] |= ctype_base::space; // as delimitor\n\tcin.imbue(locale(cin.getloc(), new ctype<char>(ctable.data())));\n\n\tcin.tie(nullptr);\n\tios_base::sync_with_stdio(false);\n\tcout << fixed;\n\tcout << setprecision(std::numeric_limits<double>::max_digits10);\n\tsolve();\n\n\treturn 0;\n}\n\n////////////////////\n/// template end ///\n////////////////////\n\nvoid solve()\n{\n\twhile (true)\n\t{\n\t\tREAD(int, N);\n\t\tif (!N) { break; }\n\n\t\tmap<int, int> blessedTime;\n\t\tmap<int, int> inTime;\n\n\t\tREP(_, N)\n\t\t{\n\t\t\tREAD(int, MM, DD, h, m);\n\t\t\tREAD(char, e);\n\t\t\tREAD(int, p);\n\t\t\tint now = h * 60 + m;\n\t\t\tif (e == 'I')\n\t\t\t{\n\t\t\t\tinTime[p] = now;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (p == 0)\n\t\t\t\t{\n\t\t\t\t\tFOREACH(pg, inTime)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (pg.first != 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tblessedTime[pg.first] += now - max(inTime[pg.first], inTime[0]);\n\t\t\t\t\t\t\tDEBUG(pg.first, \"blessed\", now - max(inTime[pg.first], inTime[0]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif  (inTime.count(0))\n\t\t\t\t\t{\n\t\t\t\t\t\tblessedTime[p] += now - max(inTime[p], inTime[0]);\n\t\t\t\t\t\tDEBUG(p, \"blessed\", now - max(inTime[p], inTime[0]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tinTime.erase(p);\n\t\t\t}\n\t\t}\n\n\t\tint maxBlessed = 0;\n\t\tFOREACH(p, blessedTime)\n\t\t{\n\t\t\tif (maxBlessed < p.second)\n\t\t\t{\n\t\t\t\tmaxBlessed = p.second;\n\t\t\t}\n\t\t}\n\t\tWRITE(maxBlessed);\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#define INF (1e9)\nusing namespace std;\n\nint main(){\n  while(1){\n    int n;\n    cin>>n;\n    if(!n)break;\n    int sum[1001]={},in[1001]={};\n  \n    while(n--){\n      int month,day,h,m,id;\n      char IO;\n      scanf(\"%d/%d %d:%d %c %d\",&month,&day,&h,&m,&IO,&id);\n      int t=(h*60)+m;\n      if(IO=='I')in[id]=t;\n      if(IO=='O'){\n\tif(in[0])sum[id]+=t-max(in[0],in[id]);\n\tfor(int j=1;!id&&j<1000;j++) sum[j] += in[j]? t-max(in[0],in[j]):0;\n\tin[id]=0;\n      }\n    }\n    int ans=0;\n    for(int i=1;i<1000;i++)ans=max(ans,sum[i]);\n    cout <<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <string>\n#include <map>\nusing namespace std;\n\nint strToInt(string str)\n{\n\tint num;\n\tsscanf(str.c_str(),\"%d\",&num);\n\treturn num;\n}\nint hashKey(int mon,int day,int Gnum)\n{\n\treturn (mon*12*35+day)*1000 + Gnum;\n}\nint hashVal(int hr,int min){\n\treturn hr*60+min;\n}\nint main()\n{\n\n\t// freopen(\"5851.in\",\"r\",stdin);\n\tint n;\n\twhile(scanf(\"%d\",&n)&&n){\n\t\tstring s;\n\t\tmap<int,int> TimeCnt;\n\t\tmap<int,int> TimeMap;\n\t\tint LastGodIn  = 0;\n\t\t\n\t\tfor(int i=0;i<n;i++){\n\t\t\tint key,value,month,day;\n\t\t\tbool isGodOn = false;\n\t\t\t\n\t\t\tbool InOut =false; //In :false Out: true\n\t\t\tint Gnum;\n\t\t\tfor(int j=0;j<4;j++)\n\t\t\t{\n\t\t\t\tcin >> s;\n\t\t\t\tswitch(j)\n\t\t\t\t{\n\t\t\t\t\tcase 0: // MM/DD\n\t\t\t\t\tmonth = strToInt(s.substr(0,2));\n\t\t\t\t\tday   = strToInt(s.substr(3,5));\n\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1: //hh:mm\n\t\t\t\t\tvalue = hashVal(\n\t\t\t\t\t\t\tstrToInt(s.substr(0,2)),\n\t\t\t\t\t\t \tstrToInt(s.substr(3,5)));\n\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2: //I O\n\t\t\t\t\t\t(s==\"I\")? InOut = false : InOut = true;\n\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3://000 ~ 999\n\t\t\t\t\t\tGnum = strToInt(s);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tkey = hashKey(month,day,Gnum);\n\t\t\t//printf(\"%d %d\\n\", key,value);\n\n\t\t\t//for(map<int,int>::iterator it=TimeCnt.begin();it!=TimeCnt.end();it++)\n\t\t\t//\tprintf(\"%d %d\\n\",it -> first ,it->second); // Refresh All Prayer's time\n\t\t\tif(Gnum == 0)\n\t\t\t{\n\t\t\t\tif(!InOut) // In\n\t\t\t\t{\n\t\t\t\t\tfor(map<int,int>::iterator it=TimeMap.begin();it!=TimeMap.end();it++)\n\t\t\t\t\t\tTimeMap[(it -> first)] = value; // Refresh All Prayer's time\n\t\t\t\t\tLastGodIn =value;\n\t\t\t\t\tisGodOn =true;\n\t\t\t\t}\n\t\t\t\telse  // Out\n\t\t\t\t{\n\t\t\t\t\tfor(map<int,int>::iterator it=TimeMap.begin();it!=TimeMap.end();it++)\t\t\t\t\t\n\t\t\t\t\t\tTimeCnt[(it->first) %1000]+= (value - LastGodIn ); // Add All Prayer's time\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\tisGodOn = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse // Prayer\n\t\t\t{\n\t\t\t\tif(!InOut)\n\t\t\t\t{\n\t\t\t\t\tTimeMap[key] = value;\n\t\t\t\t\tif(TimeCnt.find(Gnum)==TimeCnt.end())\n\t\t\t\t\t\tTimeCnt[Gnum] = 0;\n\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif(isGodOn)\n\t\t\t\t\t\tTimeCnt[Gnum] +=(value - TimeMap[key]);\n\t\t\t\t\tTimeMap.erase(key);\n\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\n\t\t\t}\n\t\t}\n\t\tint MaxCnt=0;\n\t\tfor(map<int,int>::iterator it=TimeCnt.begin();it!=TimeCnt.end();it++)\n\t\t\tif(it->second > MaxCnt)\n\t\t\t\tMaxCnt = (it->second);\n\t\tprintf(\"%d\\n\", MaxCnt); \n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <deque>\n#include <stack>\n#include <map>\n#include <set>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <cctype>\nusing namespace std;\n\ntypedef long long ll;\n\n#define REP(i,n,m) for(int i=n;i<m;i++)\n#define rep(i,n) REP(i,0,n)\n\nint n;\nvector<int> v[1002];\n\nint trans(int month,int day,int hour,int min){\n  return min + hour * 60 + day * 1440 + month * 44640;\n}\n\nint main(){\n  while(scanf(\"%d\",&n),n){\n    rep(i,1002) v[i].clear();\n\n    rep(i,n){\n      int month,day,hour,min;\n      scanf(\"%d/%d %d:%d\",&month,&day,&hour,&min);\n      int res = trans(month,day,hour,min);\n\n      char ch[2];\n      int p;\n      scanf(\"%s%d\",ch,&p);\n      v[p].push_back(res);\n    }\n\n    int ans[1002];\n    memset(ans,0,sizeof(ans));\n\n    for(int i=0;i<v[0].size();i+=2){\n      for(int j=1;j<1000;j++){\n        int sum = 0;\n        for(int k=0;k<v[j].size();k+=2){\n          int tmp = min(v[0][i+1],v[j][k+1]) - max(v[0][i],v[j][k]);\n          //cout<<j<<\",\"<<tmp<<endl;\n          if(tmp > 0){\n            sum += tmp;\n          }\n        }\n        ans[j] += sum;\n      }\n    }\n    int res = 0;\n    rep(i,1002){\n      res = max(res , ans[i]);\n    }\n\n    cout<<res<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <vector>\n#include <cassert>\n#include <utility>\n#include <algorithm>\nusing namespace std;\n\nint N;\nconst int S = 1000;\n\nstruct Elem {\n    bool in_room;\n    int month, day, t;\n    Elem() : in_room(false) {};\n    Elem(int mo, int da, int h, int m) : month(mo), day(da), t(60*h+m) {\n        in_room = true;\n    }\n};\n\nint seg_val(int xl, int xr, int yl, int yr) {\n    // x := user, y := goddess\n    if(xr <= yl || yr <= xl) return 0;\n    if(xl <= yl && yr <= xr) return yr - yl;\n    if(yl <= xl && xr <= yr) return xr - xl;\n    if(xl <= yl && yl <= xr) return xr - yl;\n    return yr - xl;\n}\n\nint main() {\n    while(cin >> N, N) {\n        vector< pair<int, int> > seg[S][12][31];\n        vector<Elem> es(S);\n        for(int i=0; i<N; i++) {\n            int month, day, h, m, id;\n            char io;\n            scanf(\"%02d/%02d %02d:%02d %c %03d\", &month, &day, &h, &m, &io, &id);\n            month--; day--;\n            if(io == 'I') {\n                es[id] = Elem(month, day, h, m);\n            }\n            else {\n                assert(es[id].month == month && es[id].day == day);\n                int cur_time = 60*h + m;\n                // ?????????\n                seg[id][month][day].push_back(make_pair(es[id].t, cur_time));\n            }\n        }\n\n        vector<int> sum_time(S);\n        for(int id=1; id<1000; id++) {\n            for(int mo=0; mo<12; mo++) {\n                for(int da=0; da<31; da++) {\n                    for(auto x : seg[id][mo][da]) {\n                        for(auto y : seg[0][mo][da]) {\n                            int xl = x.first, xr = x.second;\n                            int yl = y.first, yr = y.second;\n                            sum_time[id] += seg_val(xl, xr, yl, yr);\n                        }\n                    }\n                }\n            }\n        }\n        cout << *max_element(sum_time.begin(), sum_time.end()) << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <map>\n#include <string>\n#include <sstream>\n#include <utility>\n#include <cstring>\nusing namespace std;\n\nint toInt(const string &s) {\n  istringstream iss(s);\n  int ret; iss >> ret;\n  return ret;\n}\n\nstruct Node {\n  pair<int, int> date, time;\n  string action;\n  int id;\n};\n\npair<int, int> toDate(const string &s) {\n  int month, day;\n  month = toInt(s.substr(0, 2));\n  day   = toInt(s.substr(3, 2));\n  return make_pair(month, day);\n}\n\npair<int, int> toTime(const string &s) {\n  int hour, minute;\n  hour = toInt(s.substr(0, 2));\n  minute   = toInt(s.substr(3, 2));\n  return make_pair(hour, minute);\n}\n\nint main() {\n  while(true) {\n    int N; cin >> N;\n    if(N == 0) break;\n    vector<vector<Node>> input;\n    map<int,int> spent;\n    for(int i = 0; i < N; ++i) {\n      string date_s, time_s, action_s, id_s;\n      cin >> date_s >> time_s >> action_s >> id_s;\n      if(input.empty() || input.rbegin()->begin()->date != toDate(date_s)) {\n        input.push_back(vector<Node>());\n      }\n      input.rbegin()->push_back((Node){ toDate(date_s), toTime(time_s), action_s, toInt(id_s) });\n      spent[toInt(id_s)] = 0;\n    }\n#if 0\n    for(int i = 0; i < (int)input.size(); ++i) {\n      cerr << input[i].begin()->date.first << \"/\" << input[i].begin()->date.second << endl;\n      for(int j = 0; j < (int)input[i].size(); ++j) {\n        cerr << input[i][j].time.first << \":\" << input[i][j].time.second << \" \" << input[i][j].action << \" \" << input[i][j].id << endl;\n      }\n    }\n#endif\n    for(int i = 0; i < (int)input.size(); ++i) {\n      static bool isOpen[60*24];\n      memset(isOpen, 0x00, sizeof(isOpen));\n      map<int, int> enter;\n      for(int j = 0; j < (int)input[i].size(); ++j) {\n        Node &node = input[i][j];\n        if(node.id == 0) {\n          if(node.action == \"I\") {\n            enter[0] = node.time.first*60 + node.time.second;\n          }\n          else {\n            // cerr << \"open:\" << enter[0] << \" close:\" << node.time.first*60 + node.time.second << endl;\n            for(int k = enter[0]; k < node.time.first*60 + node.time.second; ++k) {\n              isOpen[k] = true;\n            }\n          }\n        }\n      }\n      for(int j = 0; j < (int)input[i].size(); ++j) {\n        Node &node = input[i][j];\n        if(node.id != 0) {\n          if(node.action == \"I\") {\n            enter[node.id] = node.time.first*60 + node.time.second;\n          }\n          else {\n            for(int k = enter[node.id]; k < node.time.first*60 + node.time.second; ++k) {\n              if(isOpen[k]) spent[node.id]++;\n            }\n          }\n        }\n      }\n#if 0\n      for(auto item : spent) {\n        cerr << \"id: \" << item.first << \" spent: \" << item.second << endl;\n      }\n#endif\n    }\n    int ans = 0;\n    for(auto item : spent) {\n      ans = max(ans, item.second);\n    }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <cstdio>\n\nusing namespace std;\n\nclass prog{\npublic:\n  int i, o;\n  int m, d;\n};\n\nvector<prog> p[1000];\nint size[1000];\n\nmain(){\n  int n;\n  while(cin >> n && n){\n    for(int i=0;i<1000;i++){\n      p[i].clear();\n    }\n    fill(size, size+1000, 0);\n    for(int i=0;i<n;i++){\n      prog in;\n      string input;\n      cin >> input;\n      string tmp = \"\";\n      tmp += input[0];\n      tmp += input[1];\n      in.m = atoi(tmp.c_str());\n      tmp = \"\";\n      tmp += input[3];\n      tmp += input[4];\n      in.d = atoi(tmp.c_str());\n      cin >> input;\n      int a, b;\n      tmp = \"\";\n      tmp += input[0];\n      tmp += input[1];\n      a = atoi(tmp.c_str());\n      tmp = \"\";\n      tmp += input[3];\n      tmp += input[4];\n      b = atoi(tmp.c_str());\n      int inorout;\n      cin >> input;\n      if(input == \"I\"){\n\tin.i = a*60 + b;\n\tin.o = -1;\n\tinorout = 1;\n      }else{\n\tin.o = a*60 + b;\n\tinorout = 0;\n      }\n      cin >> input;\n      int id = atoi(input.c_str());\n      if(inorout){\n\tp[id].push_back(in);\n\tsize[id]++;\n      }else{\n\tp[id][size[id]-1].o = in.o;\n      }\n    }\n    int ans = 0;\n    for(int i=0;i<1000;i++){\n      for(int j=0;j<p[i].size();j++){\n\tif(p[i][j].o == -1) continue;\n\tfor(int k=0;k<1000;k++){\n\t  if(i == k) continue;\n\t  int sum = 0;\n\t  for(int l=0;l<p[k].size();l++){\n\t    if(p[k][l].o == -1) continue;\n\t    if(p[i][j].m != p[k][l].m) continue;\n\t    if(p[i][j].d != p[k][l].d) continue;\n\t    if(p[i][j].i <= p[k][l].i && p[i][j].o >= p[k][l].o){\n\t      sum += p[k][l].o - p[k][l].i;\n\t    }\n\t  }\n\t  ans = max(ans, sum);\n\t}\n\t\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\nusing namespace std;\nint lastin[1111];\nint blessed[1111];\nbool manin[1111];\nbool valkyria_in;\nint valkyria_time;\nint n;\nstring s;\nint ans;\nint hr,mi;\nchar move;\nint inde;\nvoid solve(){\n\tint t=hr*60+mi;\n\tif(move=='I'){\n\t\tif(inde==0){\n\t\t\tvalkyria_in=true;\n\t\t\tvalkyria_time=t;\n\t\t}\n\t\telse{\n\t\t\tmanin[inde]=true;\n\t\t\tlastin[inde]=t;\n\t\t}\n\t}\n\telse{\n\t\tif(inde==0){\n\t\t\tvalkyria_in=false;\n\t\t\tfor(int i=1;i<1111;i++){\n\t\t\t\tif(manin[i])blessed[i]+=t-max(lastin[i],valkyria_time);\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tmanin[inde]=false;\n\t\t\tif(valkyria_in)blessed[inde]+=t-max(lastin[inde],valkyria_time);\n\t\t}\n\t}\n}\nint main(){\n\twhile(cin>>n&&n>0){\n\t\tans=0;\n\t\tmemset(manin,0,sizeof(manin));\n\t\tmemset(blessed,0,sizeof(blessed));\n\t\tvalkyria_in=false;\n\t\twhile(n--){\n\t\t\tcin>>s>>hr>>move>>mi>>move>>inde;\n\t\t\tsolve();\n\t\t}\n\t\tfor(int i=1;i<1111;i++)ans=max(ans,blessed[i]);\n\t\tcout<<ans<<\"\\n\";\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#pragma warning(disable:4996)\n\n#define MAX_N 10000\n#define MAX_M 501\n\nint Q;\nint M[MAX_N], D[MAX_N], h[MAX_N], m[MAX_N], t[MAX_N], n[MAX_N];\nint K[MAX_N], L[MAX_N];\nchar c;\n\nint main() {\n\twhile (true) {\n\t\tfor (int i = 0; i < MAX_N; i++) { \n\t\t\tM[i] = 0; D[i] = 0; h[i] = 0; m[i] = 0; t[i] = 0; n[i] = 0; K[i] = 0; L[i] = 0;\n\t\t}\n\n\t\tbool megami = false; int zenkai = 0; cin >> Q; if (Q == 0) { break; }\n\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tscanf(\"%02d/%02d %02d:%02d %c %03d\", &M[i], &D[i], &h[i], &m[i], &c, &n[i]); \n\t\t\tif (c == 'I') { t[i] = 0; } \n\t\t\telse { t[i] = 1; }\n\t\t}\n\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tscanf(\"%02d/%02d %02d:%02d %c %03d\", &M[i], &D[i], &h[i], &m[i], &c, &n[i]);\n\t\t\tif (c == 'I') { L[n[i]] = 1; }\n\t\t\tif (c == 'O') { L[n[i]] = 0; }\n\t\t\tif (megami == true) { \n\t\t\t\tfor (int j = 0; j < MAX_M; j++) { \n\t\t\t\t\tif (L[j] == 1) { \n\t\t\t\t\t\tK[j] += (h[i] * 60 + m[i]) - (h[i - 1] * 60 + m[i - 1]);\n\t\t\t\t\t} \n\t\t\t\t} \n\t\t\t}\n\t\t}\n\t\tint maxn = 0; \n\t\tfor (int i = 1; i < MAX_M; i++) { \n\t\t\tmaxn = max(maxn, K[i]); \n\t\t}\n\t\tcout << maxn << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <cstdio>\n\nusing namespace std;\n\nclass prog{\npublic:\n  int i, o;\n  string str;\n};\n\nvector<prog> p[1000];\nint size[1000];\n\nmain(){\n  int n;\n  while(cin >> n && n){\n    for(int i=0;i<1000;i++){\n      p[i].clear();\n    }\n    fill(size, size+1000, 0);\n    for(int i=0;i<n;i++){\n      prog in;\n      string input;\n      cin >> in.str;\n      cin >> input;\n      int a, b;\n      string tmp = \"\";\n      tmp += input[0];\n      tmp += input[1];\n      a = atoi(tmp.c_str());\n      tmp = \"\";\n      tmp += input[3];\n      tmp += input[4];\n      b = atoi(tmp.c_str());\n      int inorout;\n      cin >> input;\n      if(input == \"I\"){\n\tin.i = a*60 + b;\n\tin.o = -1;\n\tinorout = 1;\n      }else{\n\tin.o = a*60 + b;\n\tinorout = 0;\n      }\n      cin >> input;\n      int id = atoi(input.c_str());\n      if(inorout){\n\tp[id].push_back(in);\n\tsize[id]++;\n      }else{\n\tp[id][size[id]-1].o = in.o;\n      }\n    }\n    int ans = 0;\n    for(int i=0;i<1000;i++){\n      for(int k=0;k<1000;k++){\n\tif(i == k) continue;\n\tint sum = 0;\n\tfor(int j=0;j<p[i].size();j++){\n\t  if(p[i][j].o == -1) continue;\n\t  for(int l=0;l<p[k].size();l++){\n\t    if(p[k][l].o == -1) continue;\n\t    if(p[i][j].str != p[k][l].str) continue;\n\t    int ai = p[i][j].i;\n\t    int ao = p[i][j].o;\n\t    int bi = p[k][l].i;\n\t    int bo = p[k][l].o;\n\t    if(ai <= bi && bo <= ao) sum += bo - bi;\n\t    else if(bi <= ai && ao <= bo) sum += ao - ai;\n\t    else if(ai <= bi && bi <= ao) sum += ao - bi;\n\t    else if(ai <= bo && bo <= ao) sum += bo - ai;\n\t  }\n\t}\n\tans = max(ans, sum);\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\nusing P = pair<int, int>;\nusing vi = vector<int>;\nusing vvi = vector<vector<int>>;\nusing vll = vector<ll>;\nusing vvll = vector<vector<ll>>;\nconst double eps = 1e-10;\nconst ll MOD = 1000000007;\nconst int INF = 1000000000;\nconst ll LINF = 1ll<<50;\ntemplate<typename T>\nvoid printv(const vector<T>& s) {\n  for(int i=0;i<(int)(s.size());++i) {\n    cout << s[i];\n    if(i == (int)(s.size())-1) cout << endl;\n    else cout << \" \";\n  }\n}\ntemplate<typename T1, typename T2>\nostream& operator<<(ostream &os, const pair<T1, T2> p) {\n  os << p.first << \":\" << p.second;\n  return os;\n}\nchar dummy;\nstruct Elm {\n  int month, day, hour, minute;\n};\nll operator- (Elm e1, Elm e2) {\n  return e1.month * 30 * 24 * 60 + e1.day * 24 * 60 + e1.hour * 60 + e1.minute\n      - e2.month * 30 * 24 * 60 - e2.day * 24 * 60 - e2.hour * 60 - e2.minute;\n}\nvoid solve(int n) {\n  map<string, vector<Elm>> mp;\n  for(int i=0;i<n;++i) {\n    char m1, m2, d1, d2, h1, h2, m3, m4;\n    scanf(\"%c%c\", &m1, &m2);\n    scanf(\"%c\", &dummy);\n    scanf(\"%c%c\", &d1, &d2);\n    scanf(\"%c\", &dummy);\n    scanf(\"%c%c\", &h1, &h2);\n    scanf(\"%c\", &dummy);\n    scanf(\"%c%c\", &m3, &m4);\n    scanf(\"%c\", &dummy);\n    m1 -= '0';\n    m2 -= '0';\n    d1 -= '0';\n    d2 -= '0';\n    h1 -= '0';\n    h2 -= '0';\n    m3 -= '0';\n    m4 -= '0';\n    Elm e = {m1 * 10 + m2, d1 * 10 + d2, h1 * 10 + h2, m3 * 10 + m4};\n    char tmp, id[3];\n    scanf(\"%c\", &tmp);\n    scanf(\"%c\", &dummy);\n    scanf(\"%s\", id, 3);\n    scanf(\"%c\", &dummy);\n    mp[id].push_back(e);\n  }\n  ll ma = 0;\n  for(auto &e1: mp) {\n    if(e1.first == \"000\") continue;\n    ll now = 0;\n    int pos1 = 0, posg = 0;\n    while(pos1 < (int)(e1.second.size()) && posg < (int)(mp[\"000\"].size())) {\n      if(e1.second[pos1] - mp[\"000\"][posg+1] >= 0) {\n        posg += 2;\n        continue;\n      }\n      if(mp[\"000\"][posg] - e1.second[pos1+1] >= 0) {\n        pos1 += 2;\n        continue;\n      }\n      now += min({e1.second[pos1+1] - e1.second[pos1],\n                  e1.second[pos1+1] - mp[\"000\"][posg],\n                  mp[\"000\"][posg+1] - e1.second[pos1],\n                  mp[\"000\"][posg+1] - mp[\"000\"][posg]});\n      if(mp[\"000\"][posg+1] - e1.second[pos1+1] >= 0) pos1 += 2;\n      else posg += 2;\n    }\n    ma = max(ma, now);\n  }\n  cout << ma << endl;\n}\nint main() {\n  cout << fixed << setprecision(10);\n  while(1) {\n    int n; scanf(\"%d\", &n);\n    scanf(\"%c\", &dummy);\n    if(n == 0) break;\n    solve(n);\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef pair<int,int> pii;\n\nint main(){\n  int N;\n  while(cin >> N, N > 0){\n    int M[N],D[N],h[N],m[N],e[N],p[N],back=0,now=0;\n    char ch;\n    bool flg[1001]={};\n\n    map<int,int> point;\n    for(int i = 0 ; i < N ; i++){\n      scanf(\"%d/%d %d:%d %c %d\",\n\t    &M[i],&D[i],&h[i],&m[i],&ch,&p[i]);\n      back=now;\n      now=h[i]*60+m[i];\n      //cout<<now<<\" \"<<back<<endl;\n      \n      if(flg[0]){\n\tfor(int j=1;j<1001;j++){\n\t  if(!flg[j])continue;\n\t  point[j]+=(now-back);\n\t}\n      }\n      e[p[i]]=(ch=='I');\n      flg[p[i]]=e[p[i]];\n    }\n    \n    int ans = 0;\n    map<int,int>::iterator it;\n    for(it = point.begin() ; it != point.end() ; ++it){\n      ans = max(ans,it->second);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <algorithm>\n#include <cstdio>\n#include <functional>\n#include <iostream>\n#include <cfloat>\n#include <climits>\n#include <cstring>\n#include <cmath>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <time.h>\n#include <vector>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> i_i;\ntypedef pair<ll, int> ll_i;\ntypedef pair<double, int> d_i;\ntypedef pair<ll, ll> ll_ll;\ntypedef pair<double, double> d_d;\nstruct edge { int u, v; double w; };\n\nll MOD = 10000007;\nll _MOD = 1000000009;\ndouble EPS = 1e-10;\n\nint calc(int a, int b, int c, int d) {\n\treturn max(0, min(b, d) - max(a, c));\n}\n\nint main() {\n\tfor (;;) {\n\t\tint n; cin >> n;\n\t\tif (n == 0) break;\n\t\tvector< vector<int> > ti(1000), to(1000);\n\t\twhile (n--) {\n\t\t\tint M, D, h, m, p; char e;\n\t\t\tscanf(\"%d/%d %d:%d %c %d\", &M, &D, &h, &m, &e, &p);\n\t\t\tint t = ((M * 31 + D) * 24 + h) * 60 + m;\n\t\t\tif (e == 'I') ti[p].push_back(t);\n\t\t\telse if (e == 'O') to[p].push_back(t);\n\t\t}\n\t\tvector<int> sum(1000);\n\t\tfor (int p = 1; p < 1000; p++)\n\t\t\tfor (int i = 0; i < ti[p].size(); i++)\n\t\t\t\tfor (int j = 0; j < ti[0].size(); j++)\n\t\t\t\t\tsum[p] += calc(ti[p][i], to[p][i], ti[0][j], to[0][j]);\n\t\tint ans = 0;\n\t\tfor (int p = 1; p < 1000; p++)\n\t\t\tans = max(ans, sum[p]);\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define For(i, a, b) for(int (i)=(int)(a); (i)<(int)(b); ++(i))\n#define rFor(i, a, b) for(int (i)=(int)(a)-1; (i)>=(int)(b); --(i))\n#define rep(i, n) For((i), 0, (n))\n#define rrep(i, n) rFor((i), (n), 0)\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long lint;\ntypedef unsigned long long ulint;\ntypedef pair<int, int> pii;\ntemplate<class T> bool chmax(T &a, const T &b){if(a<b){a=b; return true;} return false;}\ntemplate<class T> bool chmin(T &a, const T &b){if(a>b){a=b; return true;} return false;}\ntemplate<class T> T div_floor(T a, T b){\n    if(b < 0) a *= -1, b *= -1;\n    return a>=0 ? a/b : (a+1)/b-1;\n}\ntemplate<class T> T div_ceil(T a, T b){\n    if(b < 0) a *= -1, b *= -1;\n    return a>0 ? (a-1)/b+1 : a/b;\n}\n\nconstexpr lint mod = 1e9+7;\nconstexpr lint INF = mod * mod;\nconstexpr int MAX = 200010;\n\nint main(){\n    int n;\n    while(scanf(\"%d\", &n) && n){\n        int in[1010], ans[1010];\n        memset(in, 0, sizeof(in));\n        memset(ans, 0, sizeof(ans));\n        rep(_, n){\n            int month, day, hour, minute, id;\n            char enter;\n            scanf(\"%d/%d %d:%d %c %d\", &month, &day, &hour, &minute, &enter, &id);\n            int time = hour * 60 + minute;\n            if(id == 0){\n                if(enter == 'I'){\n                    rep(i, 1010)if(in[i]) in[i] = time;\n                    in[0] = time;\n                }\n                else{\n                    rep(i, 1010)if(in[i]) ans[i] += time - in[i];\n                    in[0] = 0;\n                }\n            }\n            else{\n                if(enter == 'I') in[id] = time;\n                else{\n                    if(in[0]) ans[id] += time - max(in[0], in[id]);\n                    in[id] = 0;\n                }\n            }\n        }\n        printf(\"%d\\n\", *max_element(ans+1, ans+1010));\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef pair<int,int> pii;\n#define all(c) (c).begin(), (c).end()\n#define loop(i,a,b) for(ll i=a; i<ll(b); i++)\n#define rep(i,b) loop(i,0,b)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define lb lower_bound\n#define ub upper_bound\n#ifdef DEBUG\n#define dump(...) (cerr<<#__VA_ARGS__<<\" = \"<<(DUMP(),__VA_ARGS__).str()<<\" [\"<<__LINE__<<\"]\"<<endl)\nstruct DUMP:ostringstream{template<class T>DUMP &operator,(const T&t){if(this->tellp())*this<<\", \";*this<<t;return *this;}};\n#else\n#define dump(...)\n#endif\ntemplate<class T> ostream& operator<<(ostream& os, vector<T> const& v){\n    rep(i,v.size()) os << v[i] << (i+1==v.size()?\"\":\" \");\n    return os;\n}\n\nint N;\nint sum[1000];\nvector<pair<int,int>> logs[1000];\n\nint exist[300000];\n\nint f(int m, int d, int h, int M){\n    return m*60*24*30 + d*60*24 + h*60 + M;\n}\n\nint main(){\n#ifdef DEBUG\n    freopen(\"in\",\"r\",stdin);\n#endif\n    while(~scanf(\"%d\\n\",&N) && N){\n        rep(i,1000) logs[i].clear();\n        memset(exist,0,sizeof(exist));\n        memset(sum,0,sizeof(sum));\n        rep(i,N){\n            int t, id;\n            char io;\n            int m,d,h,M;\n            scanf(\"%d/%d %d:%d \", &m,&d,&h,&M);\n            t = f(m,d,h,M);\n            cin >> io >> id;\n            if(io=='I'){\n                logs[id].eb(t,f(m,d,24,0));\n                if(id==0) exist[t]++;\n            } else {\n                logs[id].back().second = t;\n                if(id==0) exist[t]--;\n            }\n        }\n        rep(i,300000-1) exist[i+1] += exist[i];\n        rep(i,300000-1) exist[i+1] += exist[i];\n        int ans = 0;\n        rep(i,1000)if(i){\n            for(auto & p : logs[i]){\n                int l,r;\n                tie(l,r) = p;\n                sum[i] += exist[r]-exist[l];\n            }\n            ans = max(ans, sum[i]);\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\n\nconst int N = 310;\nconst int dx[] = {0, 1, 0, -1, 1, 1, -1, -1};\nconst int dy[] = {1, 0, -1, 0, 1, -1, 1, -1};\n\nint ch[100000][26];\nint sz;\nchar mz[22][22];\nchar str[N], ans[N];\nint la;\nint n, m;\n\nvoid getstr(int sx, int sy, int d, char *s) {\n    int len = 0;\n    int x = sx, y = sy;\n    do {\n        s[len++] = mz[x][y];\n        x += dx[d]; x = (x + n) % n;\n        y += dy[d]; y = (y + m) % m;\n    } while (x != sx || y != sy);\n    s[len] = 0;\n}\n\nvoid insert(char *s) {\nputs(s);\n    int u = 0;\n    int lt = 0;\n    char t[N];\n    bool ok = true;\n    for (int i = 0; s[i]; i++) {\n        t[lt++] = s[i]; t[lt] = 0;\n        int d = s[i] - 'A';\n        if (ch[u][d] == 0) {\n            memset(ch[sz], 0, sizeof(ch[sz]));\n            ch[u][d] = sz++;\n            ok = false;\n        }\n        u = ch[u][d];\n        if (ok) {\n            if (lt > la) {\n                la = lt;\n                strcpy(ans, t);\n            } else if (lt == la && strcmp(t, ans) < 0) {\n                strcpy(ans, t);\n            }\n        }\n    }\n}\n\nvoid work() {\n    memset(ch[0], 0, sizeof(ch[0]));\n    sz = 1;\n    for (int i = 0; i < n; i++) scanf(\"%s\", mz[i]);\n    ans[la = 0] = 0;\n    for (int i = 0; i < n; i++)\n        for (int j = 0; j < m; j++) {\n            for (int d = 0; d < 8; d++) {\n                getstr(i, j, d, str);\n                insert(str);\n            }\n        }\n    if (la <= 1) puts(\"0\");\n    else puts(ans);\n}\n\nint main() {\nfreopen(\"data.in\", \"r\", stdin);\nfreopen(\"data.out\", \"w\", stdout);\n    while (scanf(\"%d%d\", &n, &m), n || m) {\n        work();\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// Header {{{\n// includes {{{\n#include <algorithm>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <iostream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <sys/time.h>\n#include <unistd.h>\n#include <vector>\n// }}}\nusing namespace std;\n// consts {{{\nstatic const int INF = 1e9;\nstatic const double PI = acos(-1.0);\nstatic const double EPS = 1e-10;\n// }}}\n// typedefs {{{\ntypedef long long int LL;\ntypedef unsigned long long int ULL;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\ntypedef vector<ULL> VULL;\ntypedef vector<VULL> VVULL;\ntypedef vector<double> VD;\ntypedef vector<VD> VVD;\ntypedef vector<bool> VB;\ntypedef vector<VB> VVB;\ntypedef vector<char> VC;\ntypedef vector<VC> VVC;\ntypedef vector<string> VS;\ntypedef vector<VS> VVS;\ntypedef pair<int, int> PII;\ntypedef complex<int> P;\n#define PQ(type) priority_queue<type>\n// priority queue reverse\n#define PQR(type) priority_queue< type, vector<type>, greater<type> >\n// }}}\n// macros & inline functions {{{\n// syntax sugars {{{\n#define FOR(i, b, e) for (typeof(e) i = (b); i < (e); ++i)\n#define FORI(i, b, e) for (typeof(e) i = (b); i <= (e); ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define REPI(i, n) FORI(i, 0, n)\n#define OPOVER(_op, _type) inline bool operator _op (const _type &t) const\n#define ASSIGN_MAX(var, val) ((var) = max((var), (val)))\n#define ASSIGN_MIN(var, val) ((var) = min((var), (val)))\n// }}}\n// conversion {{{\ninline int toInt(string s) { int v; istringstream sin(s); sin>>v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout<<x; return sout.str(); }\n// }}}\n// array and STL {{{\n#define ARRSIZE(a) ( sizeof(a) / sizeof(a[0]) )\n#define ZERO(a, v) ( assert(v == 0 || v == -1), memset(a, v, sizeof(a)) )\n#define F first\n#define S second\n#define MP(a, b) make_pair(a, b)\n#define SIZE(a) ((LL)a.size())\n#define PB(e) push_back(e)\n#define SORT(v) sort((v).begin(), (v).end())\n#define RSORT(v) sort((v).rbegin(), (v).rend())\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EACH(c, it) for(typeof((c).begin()) it=(c).begin(); it!=(c).end(); ++it)\n#define REACH(c, it) for(typeof((c).rbegin()) it=(c).rbegin(); it!=(c).rend(); ++it)\n#define EXIST(s, e) ((s).find(e) != (s).end())\n// }}}\n// bit manipulation {{{\n// singed integers are not for bitwise operations, specifically arithmetic shifts ('>>', and maybe not good for '<<' too)\n#define IS_UNSIGNED(n) (!numeric_limits<typeof(n)>::is_signed)\n#define BIT(n) (assert(IS_UNSIGNED(n)), assert(n < 64), (1ULL << (n)))\n#define BITOF(n, m) (assert(IS_UNSIGNED(n)), assert(m < 64), ((ULL)(n) >> (m) & 1))\ninline int BITS_COUNT(ULL b) { int c = 0; while(b != 0) { c += (b & 1); b >>= 1; } return c; }\ninline int MSB(ULL b) { int c = 0; while(b != 0) { ++c; b >>= 1; } return c-1; }\ninline int MAKE_MASK(ULL upper, ULL lower) { assert(lower < 64 && upper < 64 && lower <= upper); return (BIT(upper) - 1) ^ (BIT(lower) - 1); }\n// }}}\n// for readable code {{{\n#define EVEN(n) (n % 2 == 0)\n#define ODD(n) (!EVEN(n))\n// }}}\n// debug {{{\n#define arrsz(a) ( sizeof(a) / sizeof(a[0]) )\n#define dprt(fmt, ...) if (opt_debug) { fprintf(stderr, fmt, ##__VA_ARGS__); }\n#define darr(a) if (opt_debug) { copy( (a), (a) + arrsz(a), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define darr_range(a, f, t) if (opt_debug) { copy( (a) + (f), (a) + (t), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define dvec(v) if (opt_debug) { copy( ALL(v), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define darr2(a) if (opt_debug) { FOR(__i, 0, (arrsz(a))){ darr( (a)[__i] ); } }\n#define WAIT() if (opt_debug) { string _wait_; cerr << \"(hit return to continue)\" << endl; getline(cin, _wait_); }\n#define dump(x) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #x << \" = \" << (x) << endl; }\n// dump vector elements in [s, e)\n#define dumpv(v, s, e) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #v << \" = \"; FOR(__i, s, e) { cerr << v[__i] << \"\\t\"; } cerr << endl; }\n#define dumpl(x) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #x << endl << (x) << endl; }\n#define dumpf() if (opt_debug) { cerr << __PRETTY_FUNCTION__ << endl; }\n#define where() if (opt_debug) { cerr << __FILE__ << \": \" << __PRETTY_FUNCTION__ << \" [L: \" << __LINE__ << \"]\" << endl; }\n#define show_bits(b, s) if(opt_debug) { REP(i, s) { cerr << BITOF(b, s-1-i); if(i%4 == 3) cerr << ' '; } cerr << endl; }\n\n// ostreams {{{\n// complex\ntemplate<typename T> ostream& operator<<(ostream& s, const complex<T>& d) {return s << \"(\" << d.real() << \", \" << d.imag() << \")\";}\n\n// pair\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& s, const pair<T1, T2>& d) {return s << \"(\" << d.first << \", \" << d.second << \")\";}\n\n// vector\ntemplate<typename T> ostream& operator<<(ostream& s, const vector<T>& d) {\n\tint len = d.size();\n\tREP (i, len) {\n\t\ts << d[i]; if (i < len - 1) s << \"\\t\";\n\t}\n\treturn s;\n}\n\n// 2 dimentional vector\ntemplate<typename T> ostream& operator<<(ostream& s, const vector< vector<T> >& d) {\n\tint len = d.size();\n\tREP (i, len) {\n\t\ts << d[i] << endl;\n\t}\n\treturn s;\n}\n\n// map\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& s, const map<T1, T2>& m) {\n\ts << \"{\" << endl;\n\tfor (typeof(m.begin()) itr = m.begin(); itr != m.end(); ++itr) {\n\t\ts << \"\\t\" << (*itr).first << \" : \" << (*itr).second << endl;\n\t}\n\ts << \"}\" << endl;\n\treturn s;\n}\n// }}}\n// }}}\n// }}}\n// time {{{\ninline double now(){ struct timeval tv; gettimeofday(&tv, NULL); return (static_cast<double>(tv.tv_sec) + static_cast<double>(tv.tv_usec) * 1e-6); }\n// }}}\n// string manipulation {{{\ninline VS split(string s, char delimiter) { VS v; string t; REP(i, s.length()) { if(s[i] == delimiter) v.PB(t), t = \"\"; else t += s[i]; } v.PB(t); return v; }\ninline string join(VS s, string j) { string t; REP(i, s.size()) { t += s[i] + j; } return t; }\n// }}}\n// geometry {{{\n#define Y real()\n#define X imag()\n// }}}\n// 2 dimentional array {{{\nenum { UP, RIGHT, DOWN, LEFT, UP_RIGHT, DOWN_RIGHT, DOWN_LEFT, UP_LEFT };\nP dydx4[4] = { P(-1, 0), P(0, 1), P(1, 0), P(0, -1) };\nP dydx8[8] = { P(-1, 0), P(0, 1), P(1, 0), P(0, -1), P(-1, 1), P(1, 1), P(1, -1), P(-1, -1) };\nbool in_field(int H, int W, P p) {\n\treturn (0 <= p.Y && p.Y < H) && (0 <= p.X && p.X < W);\n}\n// }}}\n// input and output {{{\ninline void input(string filename) {\n\tfreopen(filename.c_str(), \"r\", stdin);\n}\ninline void output(string filename) {\n\tfreopen(filename.c_str(), \"w\", stdout);\n}\n// }}}\n// }}}\n\n// Header under development {{{\n\nint LCM(int a, int b) {\n\t// FIXME\n\treturn a * b;\n}\n\n// Fraction class {{{\n// ref: http://martin-thoma.com/fractions-in-cpp/\nclass Fraction {\n\tpublic:\n\t\tULL numerator;\n\t\tULL denominator;\n\t\tFraction(ULL _numerator, ULL _denominator) {\n\t\t\tassert(_denominator > 0);\n\t\t\tnumerator = _numerator;\n\t\t\tdenominator = _denominator;\n\t\t};\n\n\t\tFraction operator*(const ULL rhs) {\n\t\t\treturn Fraction(this->numerator * rhs, this->denominator);\n\t\t};\n\n\t\tFraction operator*(const Fraction& rhs) {\n\t\t\treturn Fraction(this->numerator * rhs.numerator, this->denominator * rhs.denominator);\n\t\t}\n\n\t\tFraction operator+(const Fraction& rhs) {\n\t\t\tULL lcm = LCM(this->denominator, rhs.denominator);\n\t\t\tULL numer_lhs = this->numerator * (this->denominator / lcm);\n\t\t\tULL numer_rhs = rhs.numerator * (rhs.numerator / lcm);\n\t\t\treturn Fraction(numer_lhs + numer_rhs, lcm);\n\t\t}\n\n\t\tFraction& operator+=(const Fraction& rhs) {\n\t\t\tFraction result = (*this) + rhs;\n\t\t\tthis->numerator = result.numerator;\n\t\t\tthis->denominator = result.denominator;\n\t\t\treturn *this;\n\t\t}\n};\n\nstd::ostream& operator<<(std::ostream &s, const Fraction &a) {\n\tif (a.denominator == 1) {\n\t\ts << a.numerator;\n\t} else {\n\t\ts << a.numerator << \"/\" << a.denominator;\n\t}\n\treturn s;\n}\n\n// }}}\n\n// }}}\n\nbool opt_debug = false;\n\n// a - b in time format HH:MM\nint time_subtract(string a, string b) {\n\tint ah = a[0] * 10 + a[1];\n\tint bh = b[0] * 10 + b[1];\n\tint am = a[3] * 10 + a[4];\n\tint bm = b[3] * 10 + b[4];\n\treturn (ah - bh) * 60 + (am - bm);\n}\n\nint main(int argc, char** argv) {\n\tstd::ios_base::sync_with_stdio(false);\n\t// set options {{{\n\tint __c;\n\twhile ( (__c = getopt(argc, argv, \"d\")) != -1 ) {\n\t\tswitch (__c) {\n\t\t\tcase 'd':\n\t\t\t\topt_debug = true;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tabort();\n\t\t}\n\t}\n\t// }}}\n\n\t// opt_debug = true;\n\t// input(\"./inputs/0.txt\");\n\t// output(\"./outputs/0.txt\");\n\n\tint n;\n\twhile (cin >> n, n) {\n\t\tmap<string, int> score;\n\t\tmap<string, string> entrance;\n\t\tstring cday = \"\"; // current day\n\t\tREP (i, n) {\n\t\t\tstring day, time, e, id; cin >> day >> time >> e >> id;\n\t\t\tif (day != cday) {\n\t\t\t\tentrance.clear();\n\t\t\t\tcday = day;\n\t\t\t}\n\t\t\tif (e == \"I\") {\n\t\t\t\tdprt(\"%s is in at %s\\n\", id.c_str(), time.c_str());\n\t\t\t\tentrance[id] = time;\n\t\t\t\tif (id == \"000\") {\n\t\t\t\t\t// it's the same thing if I regard all programmers enters with the goddess\n\t\t\t\t\tEACH (entrance, itr) {\n\t\t\t\t\t\t(*itr).S = time;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdprt(\"%s is out at %s\\n\", id.c_str(), time.c_str());\n\t\t\t\tif (id == \"000\") {\n\t\t\t\t\tEACH (entrance, itr) {\n\t\t\t\t\t\tstring tid = (*itr).F;\n\t\t\t\t\t\tif (!EXIST(score, tid)) {\n\t\t\t\t\t\t\tscore[tid] = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tscore[tid] += time_subtract(time, (*itr).S);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (!EXIST(score, id)) {\n\t\t\t\t\t\tscore[id] = 0;\n\t\t\t\t\t}\n\t\t\t\t\tif (EXIST(entrance, \"000\")) {\n\t\t\t\t\t\tscore[id] += time_subtract(time, entrance[id]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tentrance.erase(id);\n\t\t\t}\n\t\t\tdumpl(entrance);\n\t\t\tdumpl(score);\n\t\t}\n\n\t\tint ans = 0;\n\t\tEACH (score, itr) {\n\t\t\tif ((*itr).F == \"000\") { continue; }\n\t\t\tans = max(ans, (*itr).S);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}\n\n// vim: foldmethod=marker"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\nstruct time{\n\tint month,day,hour,minute;\n\ttime() {};\n}f;\n#define max(a,b) ((a>b)?a:b)\nint ID[1005][2];\nint main() {\n\tint n,i,j,k;char T[5];while (scanf(\"%d\",&n)!=EOF && n) {\n\t\tfor (i=0;i<1005;ID[i][0]=-1,ID[i][1]=0,i++);j=k=0;\n\t\twhile (n--) {\n\t\t\tscanf(\"%d/%d %d:%d\",&f.month,&f.day,&f.hour,&f.minute);\n\t\t\tscanf(\"%s %d\",&T,&i);\n\t\t\tif (j==f.day && k==f.month) {\n\t\t\t\tif (i) {\n\t\t\t\t\tif (T[0]=='I') ID[i][0]=f.hour*60+f.minute;\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (ID[0][0]!=-1) ID[i][1]+=f.hour*60+f.minute-max(ID[0][0],ID[i][0]);\n\t\t\t\t\t\tID[i][0]=-1;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (T[0]=='I') ID[0][0]=f.hour*60+f.minute;\n\t\t\t\t\telse {\n\t\t\t\t\t\tj=f.hour*60+f.minute;\n\t\t\t\t\t\tfor (i=1;i<1005;i++) if (ID[i][0]!=-1) ID[i][1]+=j-max(ID[i][0],ID[0][0]);\n\t\t\t\t\t\tID[0][0]=-1;j=f.day;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (j=0;j<1005;ID[j++][0]=-1);\n\t\t\t\tj=f.day,k=f.month;\n\t\t\t\tID[i][0]=f.hour*60+f.minute;\n\t\t\t}\n\t\t}\n\t\tfor (i=2,j=1;i<1005;i++) if (ID[i][1]>ID[j][1]) j=i;\n\t\tprintf(\"%d\\n\",ID[j][1]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<stdlib.h>\n#include<string>\n#define f first\n#define s second\nusing namespace std;\n\nint T(string s){\n  int time=0;\n  string s1=s.substr(0,2);\n  string s2=s.substr(3,2);\n  time+=(60)*atoi(s1.c_str());\n  time+=atoi(s2.c_str());\n  return time;\n}\n\nint main()\n{\n  int N,n;\n  string s1,s2;\n  char c;\n\n  while(1){\n    cin>>N;\n    if(N==0)break;\n    int S[1000]={};\n    vector<vector<pair<string,pair<int,int> > > > V(1000);\n    for(int i=0;i<N;i++){\n      cin>>s1>>s2>>c>>n;\n      if(c=='I')S[n]=T(s2);\n      else {\n\tV[n].push_back(make_pair(s1,make_pair(S[n],T(s2))));\n\tS[n]=0;\n      }\n    }\n    for(int i=0;i<1000;i++)S[i]=0;\n    for(int k=1;k<1000;k++){\n      if(V[k].empty())continue;\n      for(int i=0;i<V[0].size();i++){\n\tfor(int j=0;j<V[k].size();j++){\n\t  if(V[0][i].f!=V[k][j].f)continue;\n\t  //0 1 1 0\n\t  if(V[0][i].s.f<=V[k][j].s.f && V[k][j].s.s<=V[0][i].s.s){\n\t    S[k]+=(V[k][j].s.s-V[k][j].s.f);\n\t  }\n\t  //1 0 0 1\n\t  else if(V[k][j].s.f<=V[0][i].s.f && V[0][i].s.s<=V[k][j].s.s){\n\t    S[k]+=(V[0][i].s.s-V[0][i].s.f);\n\t  }\n\t  //0 1 0 1\n\t  else if(V[0][i].s.f<=V[k][j].s.f && V[k][j].s.f <=V[0][i].s.s){\n\t    S[k]+=(V[0][i].s.s-V[k][j].s.f);\n\t  }\n\t  //1 0 1 0\n\t  else if(V[0][i].s.f<=V[k][j].s.s && V[k][j].s.s <=V[0][i].s.s){\n\t    S[k]+=(V[k][j].s.s-V[0][i].s.f);\n\t  }\n\t}\n      }\n    }\n    int ans=0;\n    for(int i=1;i<1000;i++)ans=max(ans,S[i]);\n    cout<<ans<<endl;\n/*\n    for(int k=0;k<5;k++){\n      for(int i=0;i<V[k].size();i++)cout<<V[k][i].f<<\" \"<<V[k][i].s.f<<\" \"<<V[k][i].s.s<<\" \"<<k<<endl;\n      }*/\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define mk make_pair\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long ll;\nstruct B{\n  int size;\n  vector<ll> dat;\n  void init(int n){\n    size=n;\n    dat.clear();\n    dat.resize(n+1);\n  }\n  void Add(int i,ll x){\n    while(0<i&&i<=size)\n      dat[i]+=x,i+=(i&-i);\n  }\n  ll Sum(int i){\n    ll res=0;\n    while(0<i)\n      res+=dat[i],i-=(i&-i);\n    return res;\n  }\n};\nint main(){\n  int n;\n  while(cin>>n,n){\n    int ans=0;\n    vector<int>v[1001];\n    for(int i=0;i<n;i++){\n      int pp=0,m,d,h,ss,t;\n      scanf(\"%d/%d %d:%d\",&m,&d,&h,&ss);\n      pp=m*40*24*60+d*24*60+h*60+ss;\n      string s1,s2;\n      cin>>s1>>t;\n      v[t].push_back(pp);\n    }\n    for(int o=1;o<1001;o++)if(v[o].size()){\n      B A,B;\n      A.init(900000);\n      B.init(900000);\n      for(int i=0;i<v[o].size();i+=2){\n\tint ss=v[o][i],tt=v[o][i+1];\n\tA.Add(ss,1);\n        A.Add(tt,-1);\n        B.Add(ss,-1*(ss-1));\n        B.Add(tt,1*(ss-1) + 1*(tt-ss+1) );\n      }\n      int sum=0;\n      for(int i=0;i<v[0].size();i+=2){\n\tint ss=v[0][i],tt=v[0][i+1];\n\tss;\n\tsum+=A.Sum(tt)*tt+B.Sum(tt) - A.Sum(ss)*ss-B.Sum(ss);\n      }\n      ans=max(sum,ans);\n    }\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<vector>\n\nusing namespace std;\n\ntypedef long long ll;\nconst int MAX = 1000;\nstruct data{int month,day,hour,min;};\n\nint mon[] = {0,31,28,31,30,31,30,31,31,30,31,30,31};\nll N,T[MAX];\ndata D[MAX];\nbool isInside[MAX];\n\nvoid init(){\n  fill(T,T+MAX,0);\n  fill(isInside,isInside+MAX,false);\n}\n\nll getTime(data d){\n  ll tmp = 0;\n\n  for(int i = 1; i < d.month; i++)\n    tmp += mon[i]*24*60;\n  \n  tmp += d.day*24*60;\n  tmp += d.hour*60;\n  tmp += d.min;\n  return tmp;\n}\n\nvoid solve(){\n\n  bool isIN = false;\n\n  vector<int> V;\n  for(int i = 0; i < N; i++){\n    data d;\n    char c;\n    int id;\n    scanf(\"%d/%d %d:%d %c %d\",&d.month,&d.day,&d.hour,&d.min,&c,&id);\n\n     if(id == 0){\n       isIN = (c == 'I');\n       \n       if(c == 'O'){\n\t for(int j = 1; j < MAX; j++)\n\t   if(isInside[j]){\n\t     T[j] += getTime(d)-max(getTime(D[j]),getTime(D[0]));\n\t   }\n       }else D[0] = d;\n       continue;\n     }\n     \n    if(c == 'I'){\n      D[id] = d;\n      isInside[id] = true;\n    }else{\n      if(isIN && isInside[id]) T[id] += getTime(d)-getTime(D[id]);\n      isInside[id] = false;\n    }\n   }\n\n  ll ans = 0;\n  for(int i = 1; i < MAX; i++)\n    ans = max(ans,T[i]);\n  cout << ans << endl;\n}\n\nint main(){\n  while(cin >> N && N){\n    init();\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <cstdio>\n\nusing namespace std;\n\nclass prog{\npublic:\n  int i, o;\n  int m, d;\n};\n\nvector<prog> p[1000];\nint size[1000];\n\nmain(){\n  int n;\n  while(cin >> n && n){\n    for(int i=0;i<1000;i++){\n      p[i].clear();\n    }\n    fill(size, size+1000, 0);\n    for(int i=0;i<n;i++){\n      prog in;\n      string input;\n      cin >> input;\n      string tmp = \"\";\n      tmp += input[0];\n      tmp += input[1];\n      in.m = atoi(tmp.c_str());\n      tmp = \"\";\n      tmp += input[3];\n      tmp += input[4];\n      in.d = atoi(tmp.c_str());\n      cin >> input;\n      int a, b;\n      tmp = \"\";\n      tmp += input[0];\n      tmp += input[1];\n      a = atoi(tmp.c_str());\n      tmp = \"\";\n      tmp += input[3];\n      tmp += input[4];\n      b = atoi(tmp.c_str());\n      int inorout;\n      cin >> input;\n      if(input == \"I\"){\n\tin.i = a*60 + b;\n\tin.o = -1;\n\tinorout = 1;\n      }else{\n\tin.o = a*60 + b;\n\tinorout = 0;\n      }\n      cin >> input;\n      int id = atoi(input.c_str());\n      if(inorout){\n\tp[id].push_back(in);\n\tsize[id]++;\n      }else{\n\tp[id][size[id]-1].o = in.o;\n      }\n    }\n    int ans = 0;\n    for(int i=0;i<1000;i++){\n      for(int j=0;j<p[i].size();j++){\n\tfor(int k=0;k<1000;k++){\n\t  if(i == k) continue;\n\t  int sum = 0;\n\t  for(int l=0;l<p[k].size();l++){\n\t    if(p[i][j].m != p[k][l].m) continue;\n\t    if(p[i][j].d != p[k][l].d) continue;\n\t    if(p[i][j].i <= p[k][l].i && p[i][j].o >= p[k][l].o){\n\t      sum += p[k][l].o - p[k][l].i;\n\t    }\n\t  }\n\t  ans = max(ans, sum);\n\t}\n\t\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\nusing namespace std;\n \n#define REP(i,n) for(int i=0; i<n; ++i)\n#define FOR(i,a,b) for(int i=a; i<=b; ++i)\n#define FORR(i,a,b) for (int i=a; i>=b; --i)\n#define pi acos(-1.0)\n \ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef vector<VI> VVI;\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> PL;\n\nint intersect(int l1, int r1, int l2, int r2){\n\treturn max(0, min(r1,r2) - max(l1,l2));\n}\n\nint main(){\n\tint n;\n\twhile (cin >> n && n){\n\t\tVVI in(1000), out(1000);\n\t\twhile (n--){\n\t\t\tint M, D, h, m, p;\n\t\t\tchar c;\n\t\t\tscanf(\"%d/%d %d:%d %c %d\", &M, &D, &h, &m, &c, &p);\n\t\t\tint t = m + 60*h + 24*60*D + 31*24*60*M;\n\t\t\tif (c == 'I'){\n\t\t\t\tin[p].push_back(t);\n\t\t\t}else{\n\t\t\t\tout[p].push_back(t);\n\t\t\t}\n\t\t}\n\t\tVI s(1000);\n\t\tFOR(x,1,999){\n\t\t\tREP(i,in[x].size()){\n\t\t\t\tREP(j,in[0].size()){\n\t\t\t\t\ts[x] += intersect(in[x][i], out[x][i], in[0][j], out[0][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsort(s.begin(), s.end());\n\t\tcout << s[999] << endl;\n\t}\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <sstream>\n#include <algorithm>\n#include <cmath>\n#include <map>\n#include <queue>\n#include <vector>\n#include <cstdlib>\n#include <string>\n#include <set>\n#include <ctime>\nusing namespace std;\n\nint pre[1010],num[1010],vis[1010];\n\nchar str[10];\n\nint main()\n{\n    int n;\n    while(scanf(\"%d\",&n)==1)\n    {\n        if(!n)\n            break;\n        int i,d,m,s,id,j;\n        memset(vis,0,sizeof(vis));\n        memset(num,0,sizeof(num));\n        for(i=1;i<=n;i++)\n        {\n            scanf(\"%d/%d%d:%d%s%d\",&d,&d,&m,&s,str,&id);\n            if(id==0)\n            {\n                if(str[0]=='I')\n                {\n                    pre[id]=m*60+s;\n                    for(j=1;j<1000;j++)\n                    {\n                        if(vis[j])\n                            pre[j]=pre[id];\n                    }\n                    vis[id]=1;\n                }\n                else\n                {\n                    for(j=1;j<1000;j++)\n                    {\n                        if(vis[j])\n                            num[j]+=(m*60+s-pre[j]);\n                    }\n                    vis[id]=0;\n                }\n            }\n            else\n            {\n                if(str[0]=='I')\n                {\n                    pre[id]=m*60+s;\n                    vis[id]=1;\n                }\n                else\n                {\n                    if(vis[0])\n                        num[id]+=m*60-s-pre[0];\n                    vis[id]=0;\n                }\n            }\n        }\n        int ans=0;\n        for(i=1;i<1000;i++)\n        {\n            if(num[i]>ans)\n                ans=num[i];\n        }\n        printf(\"%d\\n\",ans);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <set>\n#include <cmath>\n#include <stack>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <numeric>\n#include <vector>\n#include <ctime>\n#include <queue>\n#include <list>\n#include <map>\n#define pi acos(-1.0)\n#define INF 0x3f3f3f3f\n#define clr(x)  memset(x,0,sizeof(x));\n#define clrto(x,siz,y)  for(int xx=0;xx<=siz;xx++)  x[xx]=y;\n#define clrset(x,siz)  for(int xx=0;xx<=siz;xx++)  x[xx]=xx;\n#define clr_1(x) memset(x,-1,sizeof(x));\n#define clrmax(x) memset(x,0x3f,sizeof(x));\n#define clrvec(x,siz) for(int xx=0;xx<=siz;xx++)  x[xx].clear();\n#define fop2   freopen(\".in\",\"r\",stdin); //freopen(\".out\",\"w\",stdout);\n#define fop   freopen(\"in.txt\",\"r\",stdin);//freopen(\"out.txt\",\"w\",stdout);\n#define myprogram By_135678942570\n#define clrcpy(x,siz,y)  for(int xx=0;xx<siz;xx++)  x[xx]=y[xx];\n#define pb push_back\nusing namespace std;\nint main()\n{\n\tint n;\n\tint ent[1011]={0};\n\twhile(1)\n\t{\n\t\tchar s[5];\n\t\tint m,d,h,mi,id;\n\t\tscanf(\"%d\",&n);\n\t\tif(n==0)\n\t\t\tbreak;\n\t\tint lastm=-1,lastd=-1;\n\t\tint all[1011]={0};\n\t\tfor(int i=0;i<n;i++)\n\t\t{\n\t\t\tscanf(\"%d/%d%d:%d%s%d\",&m,&d,&h,&mi,s,&id);\n\t\t\tint nowtime=h*60+mi;\n\t\t\tif(lastm!=m||lastd!=d)\n\t\t\t{\n\t\t\t\tif(ent[0])\n\t\t\t\t{\n\t\t\t\t\tfor(int j=0;j<1000;j++)\n\t\t\t\t\t\tif(ent[j]!=0)\n\t\t\t\t\t\t\tall[j]+=24*60-ent[j];\n\t\t\t\t}\n\t\t\t\tclr(ent);\n\t\t\t}\n\t\t\tif(s[0]=='I')\n\t\t\t{\n\t\t\t\tent[id]=nowtime;\n\t\t\t\tif(id==0)\n\t\t\t\t\tfor(int j=0;j<1000;j++)\n\t\t\t\t\t\tif(ent[j]!=0)\n\t\t\t\t\t\t\tent[j]=nowtime;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(id==0)\n\t\t\t\t{\n\t\t\t\t\tfor(int j=0;j<1000;j++)\n\t\t\t\t\t\tif(ent[j]!=0)\n\t\t\t\t\t\t\tall[j]+=nowtime-ent[j];\n\t\t\t\t\tent[0]=0;\n\t\t\t\t}\n\t\t\t\telse if(ent[0])\n\t\t\t\t{\n\t\t\t\t\tall[id]+=(nowtime-ent[id]);\n\t\t\t\t\tent[id]=0;\n\t\t\t\t}\n\t\t\t\tent[id]=0;\n\t\t\t}\n\t\t\tlastm=m,lastd=d;\n\t\t}\n\t\tprintf(\"%d\\n\",*max_element(all+1,all+1000));\n\t}\n}\n/*\n4\n1/1 02:30 I 001\n1/1 09:00 I 000\n1/1 09:53 O 001\n1/1 09:55 O 000\n*/"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr,__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\n\nint main() {\n    int n;\n    while (cin >> n, n) {\n        int god = -1;\n        vi time(1000);\n        vector<pii> prog;\n        REP(i, n) {\n            int month, day, hour, minute, id;\n            char inout;\n            scanf(\"%02d/%02d %02d:%02d %c %03d\", &month, &day, &hour, &minute, &inout, &id);\n            int t = hour * 60 + minute;\n            if (inout == 'I') {\n                if (id == 0) {\n                    god = t;\n                } else {\n                    prog.push_back({t, id});\n                }\n            } else {\n                if (id == 0) {\n                    for (pii p : prog) {\n                        time[p.second] += t - max(p.first, god);\n                    }\n                    god = -1;\n                } else {\n                    for (auto it = prog.begin(); it != prog.end(); it++) {\n                        if (it->second == id) {\n                            if (god != -1) {\n                                time[it->second] += t - max(it->first, god);\n                            }\n                            it = prog.erase(it, it+1);\n                            it--;\n                        }\n                    }\n                }\n            }\n        }\n\n        int ma = 0;\n        for (int t : time) {\n            ma = max(ma, t);\n        }\n        cout << ma << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main()\n{\n\tint n;\n\twhile (cin >> n, n) {\n\t\tstring MD, hm, e, p;\n\t\tint flag = 0, tmp;\n\t\tvector<int> time(1000), start(1000);\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tcin >> MD >> hm >> e >> p;\n\t\t\tif (p == \"000\") {\n\t\t\t\tif (flag) {\n\t\t\t\t\tfor (int i = 0; i < 1000; i++) {\n\t\t\t\t\t\tif (start[i]) {\n\t\t\t\t\t\t\ttime[i] += stoi(hm.substr(0, 2)) * 60 + stoi(hm.substr(3, 2)) - max(tmp, start[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ttmp = 0;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttmp = stoi(hm.substr(0, 2)) * 60 + stoi(hm.substr(3, 2));\n\t\t\t\t}\n\t\t\t\tflag = 1 - flag;\n\t\t\t}\n\t\t\telse if (e == \"I\") {\n\t\t\t\tstart[stoi(p)] = stoi(hm.substr(0, 2)) * 60 + stoi(hm.substr(3, 2));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tint id = stoi(p);\n\t\t\t\tif (flag && start[id]) {\n\t\t\t\t\ttime[id] += stoi(hm.substr(0, 2)) * 60 + stoi(hm.substr(3, 2)) - max(tmp, start[id]);\n\t\t\t\t}\n\t\t\t\tstart[id] = 0;\n\t\t\t}\n\t\t}\n\t\tint res = 0;\n\t\tfor (int i = 0; i < 1000; i++) {\n\t\t\tres = max(res, time[i]);\n\t\t}\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<stdlib.h>\n#include<string>\n#define f first\n#define s second\nusing namespace std;\n \nint T(string s){\n  int time=0;\n  string s1=s.substr(0,2);\n  string s2=s.substr(3,2);\n  time+=(60)*atoi(s1.c_str());\n  time+=atoi(s2.c_str());\n  return time;\n}\n \nint main()\n{\n  int N,n;\n  string s1,s2;\n  char c;\n \n  while(1){\n    cin>>N;\n    if(N==0)break;\n    int S[1000]={};\n    vector<vector<pair<string,pair<int,int> > > > V(1000);\n    for(int i=0;i<N;i++){\n      cin>>s1>>s2>>c>>n;\n      if(c=='I')S[n]=T(s2);\n      else {\n    V[n].push_back(make_pair(s1,make_pair(S[n],T(s2))));\n    S[n]=0;\n      }\n    }\n    for(int i=0;i<1000;i++)S[i]=0;\n    for(int k=1;k<1000;k++){\n      if(V[k].empty())continue;\n      for(int i=0;i<V[0].size();i++){\n    for(int j=0;j<V[k].size();j++){\n      if(V[0][i].f!=V[k][j].f)continue;\n      //0 1 1 0\n      if(V[0][i].s.f<=V[k][j].s.f && V[k][j].s.s<=V[0][i].s.s){\n        S[k]+=(V[k][j].s.s-V[k][j].s.f);\n      }\n      //1 0 0 1\n      else if(V[k][j].s.f<=V[0][i].s.f && V[0][i].s.s<=V[k][j].s.s){\n        S[k]+=(V[0][i].s.s-V[0][i].s.f);\n      }\n      //0 1 0 1\n      else if(V[0][i].s.f<=V[k][j].s.f && V[k][j].s.f <=V[0][i].s.s){\n        S[k]+=(V[0][i].s.s-V[k][j].s.f);\n      }\n      //1 0 1 0\n      else if(V[0][i].s.f<=V[k][j].s.s && V[k][j].s.s <=V[0][i].s.s){\n        S[k]+=(V[k][j].s.s-V[0][i].s.f);\n      }\n    }\n      }\n    }\n    int ans=0;\n    for(int i=1;i<1000;i++)ans=max(ans,S[i]);\n    cout<<ans<<endl;\n/*\n    for(int k=0;k<5;k++){\n      for(int i=0;i<V[k].size();i++)cout<<V[k][i].f<<\" \"<<V[k][i].s.f<<\" \"<<V[k][i].s.s<<\" \"<<k<<endl;\n      }*/\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr,__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\n\nint main() {\n    int n;\n    while (cin >> n, n) {\n        int god;\n        vi time(1000);\n        vector<pii> prog;\n        REP(i, n) {\n            int month, day, hour, minute, id;\n            char inout;\n            scanf(\"%02d/%02d %02d:%02d %c %03d\", &month, &day, &hour, &minute, &inout, &id);\n            int t = hour * 60 + minute;\n            if (inout == 'I') {\n                if (id == 0) {\n                    god = t;\n                } else {\n                    prog.push_back({t, id});\n                }\n            } else {\n                if (id == 0) {\n                    for (pii p : prog) {\n                        int mi = max(p.first, god);\n                        time[p.second] += t - mi;\n                    }\n                } else {\n                    for (auto it = prog.begin(); it != prog.end(); it++) {\n                        if (it->second == id) {\n                            it = prog.erase(it, it+1);\n                            it--;\n                        }\n                    }\n                }\n            }\n        }\n\n        int ma = 0;\n        for (int t : time) {\n            ma = max(ma, t);\n        }\n        cout << ma << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#pragma warning(disable:4996)\n\n#define MAX_N 10000\n#define MAX_M 501\n\nint Q;\nint M[MAX_N], D[MAX_N], h[MAX_N], m[MAX_N], t[MAX_N], n[MAX_N];\nint K[MAX_N], L[MAX_N];\nchar c;\n\nint main() {\n\twhile (true) {\n\t\tfor (int i = 0; i < MAX_N; i++) { M[i] = 0; D[i] = 0; h[i] = 0; m[i] = 0; t[i] = 0; n[i] = 0; K[i] = 0; L[i] = 0; }\n\t\tbool megami = false; int zenkai = 0; cin >> Q; if (Q == 0) { break; }\n\t\tfor (int i = 0; i < Q; i++) {scanf(\"%02d/%02d %02d:%02d %c %03d\", &M[i], &D[i], &h[i], &m[i], &c, &n[i]); if (c == 'I') { t[i] = 0; } else { t[i] = 1; }}\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tif (t[i] == 0) { L[n[i]] = 1; }if (t[i] == 1) { L[n[i]] = 0; }\n\t\t\tif (megami == true) { for (int j = 0; j < MAX_M; j++) { if (L[j] == 1) { K[j] += (h[i] * 60 + m[i]) - zenkai; } } }\n\t\t\tzenkai = h[i] * 60 + m[i]; if (n == 0 && t[i] == 0) { megami = true; } else { megami = false; }\n\t\t}\n\t\tint maxn = 0; for (int i = 0; i < MAX_M; i++) { maxn = max(maxn, K[i]); }cout << maxn << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int inf = 1 << 30;\n\nint main()\n{\n  int n;\n  while(cin >> n, n){\n    int stay[1000] = {0}, ent[1000] = {0};\n    for(int i = 0; i < n; i++){\n      int M, D, h, m, p; char e;\n      scanf(\"%d/%d %d:%d %c %d\", &M, &D, &h, &m, &e, &p);\n      int now = h * 60 + m;\n      if(ent[p]){\n\tif(p == 0){\n\t  for(int i = 1; i < 1000; i++){\n\t    if(ent[i]) stay[i] += now - max(ent[0], ent[i]), ent[i] = now;\n\t  }\n\t  ent[p] = 0;\n\t} else if(ent[0]){\n\t  stay[p] += now - max(ent[0], ent[p]), ent[p] = 0;\n\t} else {\n\t  ent[p] = 0;\n\t}\n      } else {\n\tent[p] = now;\n      }\n    }\n    cout << *max_element(stay + 1, stay + 1000) << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <cstdio>\n\nusing namespace std;\n\nclass prog{\npublic:\n  int i, o;\n  int m, d;\n};\n\nvector<prog> p[1000];\nint size[1000];\n\nmain(){\n  int n;\n  while(cin >> n && n){\n    for(int i=0;i<1000;i++){\n      p[i].clear();\n    }\n    fill(size, size+1000, 0);\n    for(int i=0;i<n;i++){\n      prog in;\n      string input;\n      cin >> input;\n      string tmp = \"\";\n      tmp += input[0];\n      tmp += input[1];\n      in.m = atoi(tmp.c_str());\n      tmp = \"\";\n      tmp += input[3];\n      tmp += input[4];\n      in.d = atoi(tmp.c_str());\n      cin >> input;\n      int a, b;\n      tmp = \"\";\n      tmp += input[0];\n      tmp += input[1];\n      a = atoi(tmp.c_str());\n      tmp = \"\";\n      tmp += input[3];\n      tmp += input[4];\n      b = atoi(tmp.c_str());\n      int inorout;\n      cin >> input;\n      if(input == \"I\"){\n\tin.i = a*60 + b;\n\tin.o = -1;\n\tinorout = 1;\n      }else{\n\tin.o = a*60 + b;\n\tinorout = 0;\n      }\n      cin >> input;\n      int id = atoi(input.c_str());\n      if(inorout){\n\tp[id].push_back(in);\n\tsize[id]++;\n      }else{\n\tp[id][size[id]-1].o = in.o;\n      }\n    }\n    int ans = 0;\n    for(int i=0;i<1000;i++){\n      for(int j=0;j<p[i].size();j++){\n\tif(p[i][j].o == -1) continue;\n\tfor(int k=0;k<1000;k++){\n\t  if(i == k) continue;\n\t  int sum = 0;\n\t  for(int l=0;l<p[k].size();l++){\n\t    if(p[k][l].o == -1) continue;\n\t    if(p[i][j].m != p[k][l].m) continue;\n\t    if(p[i][j].d != p[k][l].d) continue;\n\t    int ai = p[i][j].i;\n\t    int ao = p[i][j].o;\n\t    int bi = p[k][l].i;\n\t    int bo = p[k][l].o;\n\t    if(ai <= bi && bo <= ao) sum += bo - bi;\n\t    else if(ai <= bi && bi <= ao && ao <= bo) sum += ao - bi;\n\t    else if(ai <= bo && bo <= ao && bi <= ai) sum += bo - ai;\n\t    else if(bi <= ai && ao <= bo) sum += ao - ai;\n\t  }\n\t  ans = max(ans, sum);\n\t}\n\t\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\nusing pii = pair<int, int>;\n\nint sum[1000][24 * 60 + 10];\nbool in[1000];\n\nint main() {\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n  cout << fixed << setprecision(10);\n  \n  int n;\n  while (cin >> n, n) {\n    memset(sum, 0, sizeof(sum));\n    memset(in, 0, sizeof(in));\n    for (int i = 0; i < n; i++) {\n      int M, D, h, m, p;\n      char ch, e;\n      cin >> M >> ch >> D >> h >> ch >> m >> e >> p;\n      if (p == 0) {\n        if (e == 'I') {\n          in[p] = true;\n          for (int j = 1; j < 1000; j++) {\n            if (in[j]) sum[j][h * 60 + m]++;\n          }\n        } else {\n          in[p] = false;\n          for (int j = 1; j < 1000; j++) {\n            if (in[j]) sum[j][h * 60 + m]--;\n          }\n        }\n      } else {\n        if (e == 'I') {\n          in[p] = true;\n          if (in[0]) sum[p][h * 60 + m]++;\n        } else {\n          in[p] = false;\n          if (in[0]) sum[p][h * 60 + m]--;\n        }\n      }\n    }\n\n    int ans = 0;\n    for (int i = 0; i < 1000; i++) {\n      int sub = 0;\n      for (int j = 0; j < 24 * 60; j++) {\n        sum[i][j + 1] += sum[i][j];\n        sub += sum[i][j + 1];\n      }\n      ans = max(ans, sub);\n    }\n    cout << ans << endl;\n  }\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <map>\n#include <cstdlib>\n\nusing namespace std;\n\nint getTime(string s){\n  int a=atoi(s.substr(0,2).c_str());\n  int b=atoi(s.substr(3,2).c_str());\n  return a*60+b;\n}\nint main(){\n  int n;\n  while(cin>>n&&n){\n    map<string,int> ans;\n    map<string,int> info;\n    int sum=0;\n    int b=0;\n    for(int i=0;i<n;i++){\n      string s1,s2,s3,s4;\n      cin>>s1>>s2>>s3>>s4;\n      int time=getTime(s2);\n      if(s3==\"I\"){\n\t//cout<<s4<<\" \"<<time<<endl;\n\tinfo[s4]=time;\n      }\n      else{\n\tint diff=time-info[s4];\n\tif(s4==\"000\"){\n\t  for(map<string,int>::iterator it=info.begin();it!=info.end();it++){\n\t    if(it->first==\"000\")continue;\n\t    int a=time-max(info[\"000\"],(it->second));\n\t    //b=max(b,a);\n\t    //ans[it->first]=max(ans[it->first],a);\n\t    ans[it->first]+=a;\n\t    //sum=max(sum,a);\n\t  }\n\t  //sum+=b;\n\t  //b=0;\n\t}\n\telse if(info.count(\"000\")>0)ans[s4]+=diff;\n\t//ans[s4]=max(ans[s4],diff);\n\tinfo.erase(s4);\n      }\n    }\n    int res=0;\n    for(map<string,int>::iterator it=ans.begin();it!=ans.end();it++){\n      res=max(res,it->second);\n    }\n    cout<<res<<endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\nusing namespace std;\n\nstruct Data{\n    int m;\n    char io;\n    string id;\n};\n\nvoid requireTime(map<string,int> &time, map<string, vector<pair<int, int>>> s){\n    auto it = s.begin();\n    vector<pair<int, int>> god = s[\"000\"];\n    it++;\n\n    for(; it != s.end(); it++){\n        rep(i,god.size()){\n            vector<pair<int, int>> tmp = it->second;\n            rep(j,tmp.size()){\n                int left = max(god[i].first, tmp[j].first);\n                int right = min(god[i].second, tmp[j].second);\n                time[ it->first ] += max(0, right - left);\n            }\n        }\n    }\n}\n\nint main(){\n    int n;\n    while(cin >> n,n){\n        int maxi = 0;\n        map<string,int> time;//id->?????????????????????\n        map<string, vector<pair<int, int>>> seg; //id?????¨?????????\n        rep(i,n){\n            string id;\n            int th,tm,m,d;\n            char io,g;\n\n            cin >> m >> g >> d >> th >> g >> tm >> io >> id;\n            int time = m * 30 * 24 * 60 + d * 24 * 60 + th * 60 + tm;\n            if(io == 'I'){\n                seg[id].emplace_back(make_pair(time,-1));\n            }else{\n                seg[id].back().second = time;\n            }\n        }\n        requireTime(time,seg);\n        //show(maxi)\n        for(auto it : time){\n            maxi = max(maxi,it.second);\n        }\n        cout << maxi << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n\nusing namespace std;\n\nint main()\n{\n\tint in[1000]; //inµÄ¢é©Ç¤©\n\tint stay[1000]; //ØÝJnÔ\n\tint sum[1000];\t//vØÝÔ\n\tint out;\n\tint n;\n\tint nowday, nowmon;\n\t\n\twhile( cin >> n, n)\n\t{\n\t\tmemset( in, 0, sizeof(in));\n\t\tmemset( stay, 0, sizeof(stay));\n\t\tmemset( sum, 0, sizeof(sum));\n\t\tout = 0;\n\t\t\n\t\tnowday = 0; nowmon = 0;\n\t\t\n\t\tfor(int i = 0 ; i < n ; i++ )\n\t\t{\n\t\t\tint mt, dy, hr, mn, id, stime;\n\t\t\tchar c, io;\n\t\t\t\n\t\t\tcin >> mt >> c >> dy;\n\t\t\tcin >> hr >> c >> mn;\n\t\t\tcin >> io;\n\t\t\tcin >> id;\n\t\t\t\n\t\t\tif( dy != nowday || nowmon != mn )\n\t\t\t{\n\t\t\t\tnowday = dy;\n\t\t\t\tnowmon = mn;\n\t\t\t\tfor( i = 0; i < 1000; i++ )\n\t\t\t\t{\n\t\t\t\t\tin[i] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\t\n\t\t\t\n\t\t\tstime = hr*60 + mn;\n\t\t\t\n\t\t\tif( io == 'I' )\n\t\t\t{\n\t\t\t\tin[id] = 1;\n\t\t\t\tstay[id] = mn + 60*hr;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif( id == 0 )\n\t\t\t\t{\n\t\t\t\t\tfor(int i = 0; i < 1000; i++ )\n\t\t\t\t\t{\n\t\t\t\t\t\tif( in[i] == 1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsum[i] += min( stime - stay[i], stime - stay[0] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif(in[0] == 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tsum[id] += min( stime - stay[id], stime - stay[0] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tin[id] = 0;\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\t\n\t\tfor( int i = 1; i < 1000 ; i++ )\n\t\t{\n\t\t\tif( sum[i] > out )\n\t\t\tout = sum[i];\n\t\t}\n\t\t\n\t\tcout << out << endl;\n\t}\n\t\n\treturn 0;\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  for(int n; cin >> n && n; ) {\n    vector<int> in(1000, 0), sum(1000, 0);\n    while(n--) {\n      int h, m, id; char c;\n      cin >> h >> c >> h >> h >> c >> m >> c >> id;\n      m += h * 60;\n      if(c == 'I') {\n        in[id] = m;\n      } else {\n        if(id && in[0]) sum[id] += m - in[id];\n        in[id] = 0;\n      }\n      if(id == 0) {\n        if(c == 'I') {\n          for(int i = 1; i < 1000; ++i) {\n            if(in[i]) in[i] = m;\n          }\n        } else {\n          for(int i = 1; i < 1000; ++i) {\n            if(in[i]) sum[i] += m - in[i];\n          }\n        }\n      }\n    }\n    cout << *max_element(sum.begin(), sum.end()) << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef pair<int,int> pii;\n#define all(c) (c).begin(), (c).end()\n#define loop(i,a,b) for(ll i=a; i<ll(b); i++)\n#define rep(i,b) loop(i,0,b)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define lb lower_bound\n#define ub upper_bound\n#ifdef DEBUG\n#define dump(...) (cerr<<#__VA_ARGS__<<\" = \"<<(DUMP(),__VA_ARGS__).str()<<\" [\"<<__LINE__<<\"]\"<<endl)\nstruct DUMP:ostringstream{template<class T>DUMP &operator,(const T&t){if(this->tellp())*this<<\", \";*this<<t;return *this;}};\n#else\n#define dump(...)\n#endif\ntemplate<class T> ostream& operator<<(ostream& os, vector<T> const& v){\n    rep(i,v.size()) os << v[i] << (i+1==v.size()?\"\":\" \");\n    return os;\n}\n\nint N;\nint sum[1111];\nvector<pair<int,int>> logs[1111];\n\nint exist[300000];\n\nint f(int m, int d, int h, int M){\n    return m*60*24*30 + d*60*24 + h*60 + M;\n}\n\nint main(){\n#ifdef DEBUG\n    freopen(\"in\",\"r\",stdin);\n#endif\n    while(~scanf(\"%d\\n\",&N) && N){\n        rep(i,1000) logs[i].clear();\n        memset(exist,0,sizeof(exist));\n        memset(sum,0,sizeof(sum));\n        rep(i,N){\n            int t, id;\n            char io;\n            int m,d,h,M;\n            scanf(\"%d/%d %d:%d \", &m,&d,&h,&M);\n            t = f(m,d,h,M);\n            cin >> io >> id;\n            if(io=='I'){\n                logs[id].eb(t,f(m,d,24,0));\n                if(id==0) exist[t]++;\n            } else {\n                logs[id].back().second = t;\n                if(id==0) exist[t]--;\n            }\n        }\n        rep(i,300000-1) exist[i+1] += exist[i];\n        rep(i,300000-1) exist[i+1] += exist[i];\n        // dump(vi(exist+f(4,21,8,30),exist+f(4,21,9,10)));\n        int ans = 0;\n        rep(i,1000)if(i){\n            for(auto & p : logs[i]){\n                int l,r;\n                tie(l,r) = p;\n                sum[i] += exist[r]-exist[l];\n            }\n            ans = max(ans, sum[i]);\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "//40\n#include<iostream>\n#include<algorithm>\n\nusing namespace std;\n\nint main(){\n  for(int n;cin>>n,n;){\n    int bt[1000]={};\n    bool in[1000]={};\n    int lt=0;\n    while(n--){\n      cin.ignore(6);\n      int h,m,d;\n      char c;\n      (cin>>h).ignore()>>m>>c>>d;\n      int t=h*60+m;\n      if(in[0]){\n\tfor(int i=1;i<1000;i++){\n\t  if(in[i]){\n\t    bt[i]+=t-lt;\n\t  }\n\t}\n      }\n      lt=t;\n      in[d]=c=='I';\n    }\n    cout<<*max_element(bt+1,bt+1000)<<endl;\n  }\n  return 0;\n}\n\t"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\nconst int INF = 1<<29;\n\nbool god[12][31][24*60];\nint man[1000];\n\nint main() {\n  int n;\n  while(cin>>n,n) {\n    int month[n], day[n], h[n],m[n],p[n];\n    char e[n];\n    int godstart;\n    memset(god,0,sizeof(god));\n    REP(i,n) {\n      scanf(\"%d/%d %d:%d %c %d\\n\",month+i,day+i,h+i,m+i,e+i,p+i);\n      if (p[i]==0) {\n        if (e[i]=='I') godstart = h[i]*60+m[i];\n        else {\n          for (int j=godstart; j<h[i]*60+m[i]; ++j)\n            god[month[i]][day[i]][j] = 1;\n        }\n      }\n    }\n    vector<int> table(1000);\n    \n    REP(i, n) {\n      if (p[i] == 0) continue;\n      if (e[i]=='I') man[p[i]] = h[i]*60+m[i];\n      else {\n        for (int j=man[p[i]]; j<h[i]*60+m[i]; ++j)\n          if (god[month[i]][day[i]][j])\n            table[p[i]]++;\n      }\n    }\n    cout << *max_element(ALL(table)) << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<vector>\n#include<map>\nusing namespace std;\n\ntypedef pair<int,int> P;\n\nint time[1000];\nint mon,day,h,m,p,tm,td;\nchar e;\nvector<P> en[1000],ex[1000];\n\nint cal(P a){return a.first*60+a.second;}\n\nint common(int x){\n  int res = 0;\n  for(int i=0;i<(int)en[0].size();i++){\n    for(int j=0;j<(int)en[x].size();j++){\n      if(ex[x][j]<en[0][i] || ex[0][i]<en[x][j])continue;\n      if(en[x][j]<=en[0][i])\n\tif(ex[x][j]<=ex[0][i])res += cal(ex[x][j]) - cal(en[0][i]);\n\telse res += cal(ex[0][i]) - cal(en[0][i]);\n      else\n\tif(ex[x][j]<=ex[0][i])res += cal(ex[x][j]) - cal(en[x][j]);\n\telse res += cal(ex[0][i]) - cal(en[x][j]);\n    }\n  }\n  return res;\n}\n\nint main(){\n  int n;\n  while(scanf(\"%d\",&n) && n){\n    for(int i=0;i<1000;i++)time[i] = 0;\n    tm = 0;\n    td = 0;\n\n    for(int i=0;i<n;i++){\n      scanf(\"%d/%d %d:%d %c %d\",&mon,&day,&h,&m,&e,&p);\n      if(tm!=mon || td!=day){\n\tif(en[0].size()){\n\t  for(int i=1;i<n;i++)\n\t    if(en[i].size())time[i] += common(i);\n\t}\n\tfor(int i=0;i<n;i++){\n\t  en[i].clear();\n\t  ex[i].clear();\n\t}\n\ttm = mon;td = day;\n      }\n      if(e=='I')en[p].push_back(P(h,m));\n      else ex[p].push_back(P(h,m));\n    }\n    if(en[0].size()){\n      for(int i=1;i<n;i++)\n\tif(en[i].size())time[i] += common(i);\n      for(int i=0;i<n;i++){\n\ten[i].clear();\n\tex[i].clear();\n      }\n    }\n    int ans = 0;\n    for(int i=1;i<n;i++)ans = max(ans,time[i]);\n    printf(\"%d\\n\",ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "//Hello. I'm Peter.\n#include<cstdio>\n#include<iostream>\n#include<sstream>\n#include<iomanip>\n#include<cstring>\n#include<string>\n#include<cmath>\n#include<cstdlib>\n#include<algorithm>\n#include<functional>\n#include<cctype>\n#include<ctime>\n#include<stack>\n#include<queue>\n#include<deque>\n#include<vector>\n#include<set>\n#include<map>\n#include<limits>\nusing namespace std;\n#define input freopen(\"data.txt\",\"r\",stdin)\n#define output freopen(\"output.txt\",\"w\",stdout)\n#define INT (0x3f3f3f3f)*2\n#define LL (0x3f3f3f3f3f3f3f3f)*2\n#define clr(a) memset(a,0,sizeof(a))\n#define clr_minus1(a) memset(a,-1,sizeof(a))\n#define clr_NULL(a) memset(a,NULL,sizeof(a))\n#define clr_INT(a) memset(a,INT,sizeof(a))\n#define clr_true(a) memset(a,true,sizeof(a))\n#define clr_false(a) memset(a,false,sizeof(a))\n#define clr_queue(q) while(!q.empty()) q.pop()\n#define clr_stack(s) while(!s.empty()) s.pop()\n#define rep(i, a, b) for (int i = a; i < b; i++)\n#define dep(i, a, b) for (int i = a; i > b; i--)\n#define repin(i, a, b) for (int i = a; i <= b; i++)\n#define depin(i, a, b) for (int i = a; i >= b; i--)\n#define ll long long\n#define eps\n#define MOD\n#define MAXN\n#define N 1010\n#define M 100\nchar row[M];\nstruct Personality\n{\n    ll month;\n    ll day;\n    ll hour;\n    ll minute;\n    bool open;\n    ll ans;\n}god,nor[N],now;\nint n;\nll month,day,hour,minute;\nchar open,c;\nll sixty=60;\nll twentyfour=24;\nll monthlimit[15];\nll tellmethetime(int w,int id1)\n{\n    ll res=0,t;\n    if(!w)//隶。邂怜ス灘燕?紅od in 逧?慮髣エ蟾ョ\n    {\n        if(month==god.month && day==god.day)\n        {\n            if(hour==god.hour) res+=minute-god.minute;\n            else\n            {\n                res+=sixty-god.minute;\n                res+=minute;\n                t=hour-god.hour-1;\n                res+=t*sixty;\n            }\n        }\n        else\n        {\n            //蜈育ョ嶺ケ句燕驍」螟ゥ蛻ー荳倶ク?ク?、ゥ闃ア莠?、壼ー大?髓?            res+=sixty-god.minute;\n            t=twentyfour-god.hour-1;\n            res+=t*sixty;\n            //蜀咲ョ怜ス灘、ゥ蛻ー蠖灘、ゥ蠑?ァ玖干莠?、壼ー第慮髣エ\n            res+=hour*sixty;\n            res+=minute;\n            //蜀咲ョ怜ス灘、ゥ蛻ー荵句燕驍」荳?、ゥ闃ア莠?、壼ー大、ゥ?御ク崎ソ?ヲ∝?1蝟?.0\n            if(month==god.month)\n            {\n                t=0;\n                t+=day-god.day;\n            }\n            else\n            {\n                t=0;\n                //蜈育ョ怜ス捺怦闃ア莠?、壼ー大、ゥ\n                t+=day;\n                //蜀咲ョ鈴ぅ譛郁干莠?、壼ー大、ゥ\n                t+=monthlimit[god.month]-god.day;\n                //蜀咲ョ鈴ぅ譛亥芦蠖捺怦闃ア莠?、壼ー大、ゥ\n                for(ll i=god.month+1;i<month;i++)\n                {\n                    t+=monthlimit[i];\n                }\n            }\n            t-=1;\n            //蟆?、ゥ蜿俶?蛻?帖\n            res+=t*twentyfour*sixty;\n        }\n    }\n    else//隶。邂怜ス灘燕-person in 逧?慮髣エ蟾ョ\n    {\n        res=0;\n        now=nor[id1];\n        if(now.month==month && now.day==day)\n        {\n            if(hour==now.hour) res+=minute-now.minute;\n            else\n            {\n                res+=sixty-now.minute;\n                res+=minute;\n                t=hour-now.hour-1;\n                res+=t*sixty;\n            }\n        }\n        else\n        {\n            //蜈育ョ嶺ケ句燕驍」螟ゥ蛻ー荳倶ク?ク?、ゥ闃ア莠?、壼ー大?髓?            res+=sixty-now.minute;\n            t=twentyfour-now.hour-1;\n            res+=t*sixty;\n            //蜀咲ョ怜ス灘、ゥ蛻ー蠖灘、ゥ蠑?ァ玖干莠?、壼ー第慮髣エ\n            res+=minute;\n            res+=hour*sixty;\n            //蜀咲ョ怜ス灘、ゥ蛻ー荵句燕驍」荳?、ゥ闃ア莠?、壼ー大、ゥ?御ク崎ソ?ヲ∝?1蝟?.0\n            if(now.month==month)\n            {\n                t=day-now.day;\n            }\n            else\n            {\n                t=0;\n                t+=monthlimit[now.month]-now.day;\n                t+=day;\n                for(ll i=now.month+1;i<month;i++)\n                {\n                    t+=monthlimit[i];\n                }\n            }\n            t-=1;\n            res+=t*twentyfour*sixty;\n        }\n    }\n    return res;\n}\nint main()\n{\n//    input;\n    monthlimit[1]=31;\n    monthlimit[2]=28;\n    monthlimit[3]=31;\n    monthlimit[4]=30;\n    monthlimit[5]=31;\n    monthlimit[6]=30;\n    monthlimit[7]=31;\n    monthlimit[8]=31;\n    monthlimit[9]=30;\n    monthlimit[10]=31;\n    monthlimit[11]=30;\n    monthlimit[12]=31;\n    ll t1,t2,ans;\n    int id;\n    while(~scanf(\"%d\",&n) && n)\n    {\n        clr(nor);\n        repin(i,1,n)\n        {\n            scanf(\" %lld %c %lld %lld %c %lld %c %d\",&month,&c,&day,&hour,&c,&minute,&open,&id);\n            if(!id)//godness\n            {\n                if(open=='O')\n                {\n                    god.open=false;\n                    repin(i,1,999)\n                    {\n                        if(!nor[i].open) continue;\n                        t1=tellmethetime(0,i);//蠖灘燕螟ゥ-god in\n                        t2=tellmethetime(1,i);//蠖灘燕螟ゥ-person in\n                        nor[i].ans+=min(t1,t2);\n                    }\n                }\n                else if(open=='I')\n                {\n                    god.open=true;\n                    god.month=month;\n                    god.day=day;\n                    god.hour=hour;\n                    god.minute=minute;\n                }\n                continue;\n            }\n            if(open=='I' && id!=0)\n            {\n                nor[id].month=month;\n                nor[id].day=day;\n                nor[id].hour=hour;\n                nor[id].minute=minute;\n                nor[id].open=true;\n                continue;\n            }\n            else if(open=='O' && id!=0)\n            {\n                nor[id].open=false;\n                if(!god.open) continue;\n                t1=tellmethetime(0,id);//蠖灘燕螟ゥ-god in\n                t2=tellmethetime(1,id);//蠖灘燕螟ゥ-person in\n                nor[id].ans+=min(t1,t2);\n            }\n        }\n        ans=0;\n        repin(i,1,999)\n        {\n            ans=max(ans,nor[i].ans);\n//            printf(\"nor[%d].ans=%lld\\n\",i,nor[i].ans);\n        }\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<map>\nusing namespace std;\nconst int inf = 0x3f3f3f3f;\n\nint Mday[14] = {31,28,31,30,31,30,31,31,30,31,30,31};\nint gettime(int m,int d,int h,int f){\n    int sum = 0;\n    for(int i = 1; i < m; i++){\n        sum += Mday[i];\n    }\n    for(int j = 1; j < d; j++)\n        sum += 1;\n    sum *= 24 * 60;\n    sum += 60 * h;\n    sum += f;\n    return sum;\n}\nbool vis[1010];\nint tot[1010];\nint now[1010];\nint main(){\n    int N;\n    while(cin>>N){\n        int ans = 0;\n        bool flag = false;\n        memset(vis,0,sizeof(vis));\n        memset(tot,0,sizeof(tot));\n        for(int i = 1; i <= N; i++){\n            int m,d,h,f,id;\n            char op[10];\n            scanf(\"%d/%d %d:%d %s %d\",&m,&d,&h,&f,op,&id);\n            int g = gettime(m,d,h,f);\n            if (op[0] == 'I'){\n\t\t\t\tvis[id] = 1;\n\t\t\t\tnow[id] = g;\n                continue;\n            }\n                if (id == 0){\n\t\t\t\t\tfor (int j = 1; j <= 1000; j++){\n\t\t\t\t\t\tif (vis[j]){\n\t\t\t\t\t\t\ttot[j] += g - max(now[0],now[id]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tif (vis[0]){\n\t\t\t\t\t\ttot[id] += g - max(now[0],now[id]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvis[id] = 0;\n\t\t\t\tnow[id] = g;\n         }\n\n           // cout<<g<<endl;\n\n\n\n        for(int i = 1; i <= 1000; i++){\n            if(tot[i]) //cout<<tot[i]<<endl;\n            ans = max(ans,tot[i]);\n        }\n        cout<<ans<<endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "////////////////////////////////////////\n///  tu3 pro-con template            ///\n////////////////////////////////////////\n#include \"bits/stdc++.h\"\nusing namespace std;\n\n// -- loop macros -- //\n#define REP(i,n) for (int i = 0; i < (n); i++)\n#define RREP(i,n) for (int i = (n)-1; i >= 0; i--)\n#define FOR(i,s,n) for (int i = (int)(s); i < (n); i++)\n#define RFOR(i,s,n) for (int i = (n)-1; i >= (s); i--)\n#define FOREACH(i,container) for (auto &&i : container)\n#define allof(c) c.begin(), c.end()\n#define partof(c,i,n) c.begin() + (i), c.begin() + (i) + (n)\n\n// -- functors -- //\n#define PREDICATE(t,a,exp) [&](const t & a) -> bool { return exp; }\n#define COMPARISON(t,a,b,exp) [&](const t & a, const t & b) -> bool { return exp; }\n\n#define PRED(a,exp) [&](const auto & a) -> bool { return exp; }\n#define COMP(a,b,exp) [&](const auto & a, const auto & b) -> bool { return exp; }\n#define CONV1(a,exp) [&](const auto & a) -> auto { return exp; }\n#define CONV2(a,b,exp) [&](const auto & a, const auto & b) -> auto { return exp; }\n#define CONV3(a,b,c,exp) [&](const auto & a, const auto & b, const auto & c) -> auto { return exp; }\n\n// -- typedefs -- //\n#define EPS 1e-9\n\ntypedef unsigned int uint;\ntypedef long long llong;\ntypedef unsigned long long ullong;\n\n// -- I/O Helper -- //\nstruct _Reader { _Reader(istream &cin) :cin(cin) {} istream &cin; template <class T> _Reader operator ,(T &rhs) { cin >> rhs; return *this; } };\nstruct _Writer { _Writer(ostream &cout) :cout(cout) {} ostream &cout; bool f{ false }; template <class T> _Writer operator ,(const T &rhs) { cout << (f ? \" \" : \"\") << rhs; f = true; return *this; } };\n#define READ(t,...) t __VA_ARGS__; (_Reader{cin}), __VA_ARGS__\n#define WRITE(...) (_Writer{cout}), __VA_ARGS__; cout << '\\n'\n#define DEBUG(...) (_Writer{cerr}), __VA_ARGS__; cerr << '\\n'\n\n// -- vevector -- //\ntemplate <class T> struct vevector : public vector<vector<T>> { vevector(size_t n = 0, size_t m = 0, const T &initial = T()) : vector<vector<T>>(n, vector<T>(m, initial)) { } };\ntemplate <class T> struct vevevector : public vector<vevector<T>> { vevevector(size_t n = 0, size_t m = 0, size_t l = 0, const T &initial = T()) : vector<vevector<T>>(n, vevector<T>(m, l, initial)) { } };\ntemplate <class T> struct vevevevector : public vector<vevevector<T>> { vevevevector(size_t n = 0, size_t m = 0, size_t l = 0, size_t k = 0, const T &initial = T()) : vector<vevevector<T>>(n, vevevector<T>(m, l, k, initial)) { } };\n\nnamespace std {\n\ttemplate <class T1, class T2> inline istream & operator >> (istream & in, pair<T1, T2> &p) { in >> p.first >> p.second; return in; }\n\ttemplate <class T1, class T2> inline ostream & operator << (ostream &out, const pair<T1, T2> &p) { out << p.first << \" \" << p.second; return out; }\n}\n\ntemplate <class T> T read() { T t; cin >> t; return t; }\ntemplate <class T> vector<T> read(int n) { vector<T> v; REP(i, n) { v.push_back(read<T>()); } return v; }\ntemplate <class T> vevector<T> read(int n, int m) { vevector<T> v; REP(i, n) v.push_back(read<T>(m)); return v; }\ntemplate <class T> vector<T> readjag() { return read<T>(read<int>()); }\ntemplate <class T> vevector<T> readjag(int n) { vevector<T> v; REP(i, n) v.push_back(readjag<T>()); return v; }\n\ntemplate <class T> struct iter_pair_t { T beg, end; };\ntemplate <class T> iter_pair_t<T> iter_pair(T beg, T end) { return iter_pair_t<T>{beg, end}; }\ntemplate <class T> ostream & operator << (ostream &out, iter_pair_t<T> v) { if (v.beg != v.end) { out << *v.beg++; while (v.beg != v.end) { out << \" \" << *v.beg++; } } return out; }\ntemplate <class T1> ostream & operator << (ostream &out, const vector<T1> &v) { return out << iter_pair(begin(v), end(v)); }\n\n// -- etc -- //\ntemplate <class T> T infinity_value();\n#define DEFINE_INFINITY_VALUE(T, val) template <> constexpr T infinity_value<T>() { return (val); }\nDEFINE_INFINITY_VALUE(int, 1 << 28);\nDEFINE_INFINITY_VALUE(uint, 1u << 28);\nDEFINE_INFINITY_VALUE(llong, 1ll << 60);\nDEFINE_INFINITY_VALUE(ullong, 1ull << 60);\nDEFINE_INFINITY_VALUE(double, HUGE_VAL);\nDEFINE_INFINITY_VALUE(float, HUGE_VAL);\n#define INF(T) infinity_value<T>()\n\ninline int sign_of(double x) { return (abs(x) < EPS ? 0 : x > 0 ? 1 : -1); }\ntemplate <class TInt> bool in_range(TInt val, TInt min, TInt max) { return val >= min && val < max; }\ntemplate <> bool in_range<double>(double val, double min, double max) { return val - min > -EPS && val - max < EPS; }\ntemplate <> bool in_range<float>(float val, float min, float max) { return val - min > -EPS && val - max < EPS; }\ntemplate <class TInt> bool in_range2d(TInt x, TInt y, TInt w, TInt h) { return x >= 0 && x < w && y >= 0 && y < h; }\nvector<int> iotavn(int start, int count) { vector<int> r(count); iota(allof(r), start);\treturn r; }\n\n// 文字列の分割\nvector<string> split(const string &str, const string &s, bool removeEmpty = false)\n{\n\tvector<string> ret;\n\tsize_t p = 0, sl = s.size();\n\twhile (true)\n\t{\n\t\tsize_t q = str.find(s, p);\n\t\tif (q == str.npos) break;\n\t\tret.push_back(str.substr(p, q - p));\n\t\tp = q + sl;\n\t}\n\tret.push_back(str.substr(p));\n\tif (removeEmpty) ret.erase(remove(allof(ret), string()), ret.end());\n\treturn ret;\n}\n\n//// start up ////\nvoid solve();\nint main()\n{\n\t//// for local debugging\n\tfreopen(\"input.txt\", \"r\", stdin);\n\t//freopen(\"output.txt\", \"w\", stdout);\n\n\tauto classic_table = ctype<char>::classic_table();\n\tvector<ctype<char>::mask> ctable(classic_table, classic_table + ctype<char>::table_size);\n\tctable[':'] |= ctype_base::space; // as delimitor\n\tctable['/'] |= ctype_base::space; // as delimitor\n\tcin.imbue(locale(cin.getloc(), new ctype<char>(ctable.data())));\n\n\tcin.tie(nullptr);\n\tios_base::sync_with_stdio(false);\n\tcout << fixed;\n\tcout << setprecision(std::numeric_limits<double>::max_digits10);\n\tsolve();\n\n\treturn 0;\n}\n\n////////////////////\n/// template end ///\n////////////////////\n\nvoid solve()\n{\n\twhile (true)\n\t{\n\t\tREAD(int, N);\n\t\tif (!N) { break; }\n\n\t\tmap<int, int> blessedTime;\n\t\tmap<int, int> inTime;\n\n\t\tREP(_, N)\n\t\t{\n\t\t\tREAD(int, MM, DD, h, m);\n\t\t\tREAD(char, e);\n\t\t\tREAD(int, p);\n\t\t\tint now = h * 60 + m;\n\t\t\tif (e == 'I')\n\t\t\t{\n\t\t\t\tinTime[p] = now;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (p == 0)\n\t\t\t\t{\n\t\t\t\t\tFOREACH(pg, inTime)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (pg.first != 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tblessedTime[pg.first] += now - max(inTime[pg.first], inTime[0]);\n\t\t\t\t\t\t\t//DEBUG(pg.first, \"blessed\", now - max(inTime[pg.first], inTime[0]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif  (inTime.count(0))\n\t\t\t\t\t{\n\t\t\t\t\t\tblessedTime[p] += now - max(inTime[p], inTime[0]);\n\t\t\t\t\t\t//DEBUG(p, \"blessed\", now - max(inTime[p], inTime[0]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tinTime.erase(p);\n\t\t\t}\n\t\t}\n\n\t\tint maxBlessed = 0;\n\t\tFOREACH(p, blessedTime)\n\t\t{\n\t\t\tif (maxBlessed < p.second)\n\t\t\t{\n\t\t\t\tmaxBlessed = p.second;\n\t\t\t}\n\t\t}\n\t\tWRITE(maxBlessed);\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cassert>\n#include<complex>\n#include<cstdio>\n#include<cstdlib>\n#include<iostream>\n#include<map>\n#include<queue>\n#include<set>\n#include<stack>\n#include<valarray>\n\nusing namespace std;\n\n#define rep(i, n) for (int i = 0; i < int(n); ++i)\n\nint calc(string s) {\n  return s[0] * 600 + s[1] * 60 + s[3] * 10 + s[4];\n}\n\nint calc(string a, string b) {\n  return calc(b) - calc(a);\n}\n\nbool solve() {\n  int n;\n  cin >> n;\n  if (n == 0) return false;\n  int sum[1000];\n  string in[1000];\n  rep (i, 1000) sum[i] = 0;\n  bool exist = false;\n  set<int> now;\n  rep (i, n) {\n    string a, b, c;\n    int d;\n    cin >> a >> b >> c >> d;\n    if (d == 0) {\n      exist = !exist;\n      if (c == \"I\") {\n\trep (i, 1000) in[i] = b;\n      } else {\n\tfor (set<int>::iterator itr = now.begin(); itr != now.end(); ++itr) {\n\t  sum[*itr] += calc(in[*itr], b);\n\t}\n      }\n    } else {\n      if (exist) {\n\tif (c == \"I\") {\n\t  now.insert(d);\n\t  in[d] = b;\n\t} else {\n\t  now.erase(d);\n\t  sum[d] += calc(in[d], b);\n\t}\n      } else {\n\tif (c == \"I\") {\n\t  now.insert(d);\n\t} else {\n\t  now.erase(d);\n\t}\n      }\n    }\n  }\n  int res = 0;\n  rep (i, 1000) res = max(res, sum[i]);\n  cout << res << endl;\n  return true;\n}\n\nint main() {\n  while (solve());\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll ,ll > P;\n\nint N;\nll sec[1003];\nchar type[1003];\nstring id[1003];\n\nll cross(P p1,P p2) {\n    int m1=max(p1.fr,p2.fr);\n    int m2=min(p1.sc,p2.sc);\n\n    return max(0,m2-m1);\n}\n\nvoid solve() {\n    map<string,vector<P>> seg;\n    set<string> visitors;\n    rep(i,N) {\n        if(id[i]!=\"000\") visitors.insert(id[i]);\n        if(type[i]=='I') {\n            seg[id[i]].pb(P(sec[i],1e18));\n        }\n        else {\n            auto it=seg[id[i]].end();\n            it--;\n            it->second=sec[i];\n        }\n    }\n\n    map<string,ll> times;\n    for(auto visitor : visitors) {\n        for(const auto &e1 : seg[\"000\"]) for(const auto &e2 : seg[visitor]) {\n            //printf(\"[%s] %lld %lld -> %lld %lld : %lld\\n\",visitor.c_str(), e1.fr,e1.sc,e2.fr,e2.sc,cross(e1,e2));\n            times[visitor]+=cross(e1,e2);\n        }\n    }\n\n    ll ans=0;\n    for(auto visitor : visitors) ans=max(ans,times[visitor]);\n    cout<<ans/60<<endl;\n\n\n}\n\nint main() {\n    while(cin>>N) {\n        if(N==0) break;\n        rep(i,N) {\n            int M,D,h,m;\n            scanf(\"%d/%d %d:%d\",&M,&D,&h,&m);\n            sec[i]=2678400*M+86400*D+3600*h+60*m;\n            cin>>type[i];\n            cin>>id[i];\n        }\n        solve();\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#pragma warning(disable:4996)\n\n#define MAX_N 10000\n#define MAX_M 600\n\nint Q;\nint M[MAX_N], D[MAX_N], h[MAX_N], m[MAX_N], n[MAX_N], t;\nint K[MAX_N], L[MAX_N];\nchar c;\n\nint main() {\n\twhile (true) {\n\t\tfor (int i = 0; i < MAX_N; i++) {\n\t\t\tM[i] = 0; D[i] = 0; h[i] = 0; m[i] = 0; n[i] = 0; K[i] = 0; L[i] = -1;\n\t\t}\n\n\t\tbool megami = false; int zenkai = 0; cin >> Q; if (Q == 0) { break; }\n\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tscanf(\"%02d/%02d %02d:%02d %c %03d\", &M[i], &D[i], &h[i], &m[i], &c, &n[i]);\n\t\t\tt = h[i] * 60 + m[i];\n\t\t\tif (c == 'I') {\n\t\t\t\tL[n[i]] = t;\n\t\t\t}\n\t\t\tif (c == 'O') {\n\t\t\t\tif (n[i] >= 1) {\n\t\t\t\t\tif (L[0] >= 0) {\n\t\t\t\t\t\tK[n[i]] += t - max(L[0], L[n[i]]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfor (int i = 1; i < MAX_M; i++) {\n\t\t\t\t\t\tif (L[i] >= 0) {\n\t\t\t\t\t\t\tK[i] += t - L[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tL[n[i]] = -1;\n\t\t\t}\n\t\t}\n\t\tint maxn = 0;\n\t\tfor (int i = 1; i < MAX_M; i++) {\n\t\t\tmaxn = max(maxn, K[i]);\n\t\t}\n\t\tcout << maxn << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <fstream>\n#include <list>\nusing namespace std;\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toStr(T x) { ostringstream sout; sout << x; return sout.str(); }\ntypedef vector<int> vi;\ntypedef vector<vi>  vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define FOR(i,a,b) for(int i=(a);i<=(b);++i)\n#define REP(i,n) FOR(i,0,(n)-1)\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\nconst int INF = INT_MAX / 10;\n\nint main() {\n\tint n;\n\twhile (cin >> n, n) {\n\t\tint a, b;\n\t\tchar c;\n\t\tvi d(n), t(n), p(n);\n\t\tvector<char> e(n);\n\t\tint maxp = -1;\n\t\tREP(i, n) {\n\t\t\tcin >> a >> c >> b;\n\t\t\td[i] = a * 100 + b;\n\t\t\tcin >> a >> c >> b;\n\t\t\tt[i] = a * 60 + b;\n\t\t\tcin >> e[i] >> p[i];\n\t\t\tmaxp = max(maxp, p[i]);\n\t\t}\n\n\t\tvi isIn(maxp+1), inTime(maxp+1), sum(maxp+1);\n\t\tREP(i, n) {\n\t\t\tif (e[i] == 'I') {\n\t\t\t\tisIn[p[i]] = 1;\n\t\t\t\tinTime[p[i]] = t[i];\n\t\t\t\tif (p[i] == 0) {\n\t\t\t\t\tFOR(j, 1, maxp) {\n\t\t\t\t\t\tif (isIn[j]) {\n\t\t\t\t\t\t\tinTime[j] = t[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tisIn[p[i]] = 0;\n\t\t\t\tif (p[i] != 0 && isIn[0]) {\n\t\t\t\t\tsum[p[i]] += t[i] - inTime[p[i]];\n\t\t\t\t}\n\t\t\t\tif (p[i] == 0) {\n\t\t\t\t\tFOR(j, 1, maxp) {\n\t\t\t\t\t\tif (isIn[j]) {\n\t\t\t\t\t\t\tsum[j] += t[i] - inTime[p[i]];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tint ans = 0;\n\t\tFOR(i, 1, maxp) {\n\t\t\tans = max(ans, sum[i]);\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<stdlib.h>\n#include<string>\n#define f first\n#define s second\nusing namespace std;\n\nint T(string s){\n  int time=0;\n  string s1=s.substr(0,2);\n  string s2=s.substr(3,2);\n  time+=(60)*atoi(s1.c_str());\n  time+=atoi(s2.c_str());\n  return time;\n}\n\nint main()\n{\n  int N,n;\n  string s1,s2;\n  char c;\n\n  while(1){\n    cin>>N;\n    if(N==0)break;\n    int S[1000]={};\n    vector<vector<pair<string,pair<int,int> > > > V(1000);\n    for(int i=0;i<N;i++){\n      cin>>s1>>s2>>c>>n;\n      if(c=='I')S[n]=T(s2);\n      else {\n\tV[n].push_back(make_pair(s1,make_pair(S[n],T(s2))));\n\tS[n]=0;\n      }\n    }\n    for(int k=1;k<1000;k++){\n      if(V[k].empty())continue;\n      for(int i=0;i<V[0].size();i++){\n\tfor(int j=0;j<V[k].size();j++){\n\t  if(V[0][i].f!=V[k][j].f)continue;\n\t  if(V[0][i].s.f<=V[k][j].s.f && V[k][i].s.s<=V[0][j].s.s){\n\t    S[k]+=(V[k][j].s.s-V[k][j].s.f);\n\t  }\n\t  else if(V[k][j].s.f<=V[0][i].s.f && V[0][j].s.s<=V[k][j].s.s){\n\t    S[k]+=(V[0][i].s.s-V[0][i].s.f);\n\t  }\n\t  else if(V[0][i].s.f<=V[k][j].s.f){\n\t    S[k]+=(V[0][i].s.s-V[k][j].s.f);\n\t  }\n\t  else if(V[k][j].s.s<=V[0][i].s.s){\n\t    S[k]+=(V[k][j].s.s-V[0][i].s.f);\n\t  }\n\t}\n      }\n    }\n    int ans=0;\n    for(int i=1;i<1000;i++)ans=max(ans,S[i]);\n    cout<<ans<<endl;\n/*\n    for(int k=0;k<5;k++){\n      for(int i=0;i<V[k].size();i++)cout<<V[k][i].f<<\" \"<<V[k][i].s.f<<\" \"<<V[k][i].s.s<<\" \"<<k<<endl;\n      }*/\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstruct Info {\n  int M, D, t, e, p;  \n};\n\nsigned main() {\n  int n;\n  while ( cin >> n, n ) {\n    vector<int> sum(1000, 0);\n    int cnt = 0;\n    vector<Info> dat;    \n    while ( n-- ) {      \n      int M, D, h, m, p;\n      char e;\n      scanf(\"%d/%d %d:%d %c %d\", &M, &D, &h, &m, &e, &p);\n      if ( e == 'I' ) {\n\tdat.emplace_back(Info{M, D, h*60+m, 0, p});\n\tcnt++;\n      } else {\n\tdat.emplace_back(Info{M, D, h*60+m, 1, p});\n\tcnt--;\n      }\n\n      if ( cnt ) continue;\n      vector<int> zero(1500, 0);\n      vector<int> I(1000, 0);      \n      for ( Info i : dat ) {\n\tif ( i.p != 0 ) continue;\n\tif ( i.e == 0 ) {\n\t  I[i.p] = i.t;\t  \n\t} else {\n\t  for ( int j = I[i.p]; j < i.t; j++ ) {\n\t    zero[j]++;\t    \n\t  }\n\t}\n      }\n\n      for ( Info i : dat ) {\n\tif ( i.p == 0 ) continue;\n\tif ( i.e == 0 ) {\n\t  I[i.p] = i.t;\t  \n\t} else {\n\t  for ( int j = I[i.p]; j < i.t; j++ ) {\n\t    if ( zero[j] ) sum[i.p]++;\t    \n\t  }\n\t}\n      }\n\n      dat.clear();      \n    }\n\n    int ma = 0;\n    for ( int i = 0; i < 1000; i++ ) {\n      ma = max(ma, sum[i]);\n    }\n\n    cout << ma << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  for(int n; cin >> n && n; ) {\n    vector<int> in(1000, 0), sum(1000, 0);\n    int prev = 0;\n    while(n--) {\n      int h, m, id; char c;\n      cin >> h >> c >> h >> h >> c >> m >> c >> id;\n      m += h * 60;\n      for(int i = 1; in[0] && i < 1000; ++i) {\n        if(in[i]) sum[i] += m - prev;\n      }\n      in[id] = c == 'I';\n      prev = m;\n    }\n    cout << *max_element(sum.begin(), sum.end()) << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <numeric>\n#include <bitset>\n#include <cmath>\n\nstatic const int MOD = 1000000007;\nusing ll = long long;\nusing u32 = uint32_t;\nusing namespace std;\n\ntemplate<class T> constexpr T INF = ::numeric_limits<T>::max()/32*15+208;\n\nint main() {\n    int n;\n    while(cin >> n, n){\n        map<int, int> m, ans;\n        for (int wwww = 0; wwww < n; ++wwww) {\n            int a, b, c, d, f; char e;\n            scanf(\"%d/%d %d:%d %c %d \", &a, &b, &c, &d, &e, &f);\n            int time = a*1000000+b*10000+c*60+d;\n\n            if(e == 'I'){\n                m[f] = time;\n                if(!f){\n                    for (auto &&i : m) {\n                        i.second = time;\n                    }\n                }\n            }else {\n                if(f){\n                    if(m.count(0)) ans[f] += time-m[f];\n                    m.erase(f);\n                }else {\n                    for (auto &&i : m) {\n                        ans[i.first] += time-i.second;\n                        i.second = time;\n                    }\n                    m.erase(0);\n                }\n            }\n        }\n        int p = 0;\n        for (auto &&j : ans) {\n            if(j.first) p = max(p, j.second);\n        }\n        cout << p << \"\\n\";\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nstruct Fast {\n    Fast() {\n        std::cin.tie(0);\n        ios::sync_with_stdio(false);\n        cout.precision(20);\n    }\n} fast;\n\n/* define */\n#define FOR(I, X, Y) for(long long(I) = (X); (I) < (Y); (I)++)\n#define REP(I, X, Y) for(long long(I) = (Y)-1; (I) >= (X); (I)--)\n#define ALL(X) (X).begin(), (X).end()\n#define pb push_back\n#define COUNT(V, X)                                                            \\\n    (upper_bound((V).begin(), (V).end(), X) -                                  \\\n     lower_bound((V).begin(), (V).end(), X))\n#define debug(x) cerr << #x << ':' << x << endl;\n#define DEBUG(v)                                                               \\\n    {                                                                          \\\n        cerr << #v << ':';                                                     \\\n        for(auto xv : v) cerr << xv << ' ';                                    \\\n        cerr << endl;                                                          \\\n    }\n#define Yes(X) cout << (X ? \"Yes\" : \"No\") << endl;\n#define YES(X) cout << (X ? \"YES\" : \"NO\") << endl;\n#define ctoi(C) (C - '0')\n#define pow2(x) ((long long)((long long)1 << x))\n\n/* alias */\nusing ll = long long;\nusing ld = long double;\nusing vi = vector<int>;\nusing vii = vector<vector<int>>;\nusing vl = vector<long long>;\nusing vll = vector<vector<long long>>;\nusing pi = pair<int, int>;\nusing pl = pair<long long, long long>;\ntemplate <typename T> using PQ = priority_queue<T>;\ntemplate <typename T> using minPQ = priority_queue<T, vector<T>, greater<T>>;\n\n/* const */\nconst long long dx[] = {1, 0, -1, 0};\nconst long long dy[] = {0, 1, 0, -1};\nconst long long dx8[] = {1, 1, 0, -1, -1, -1, 0, 1};\nconst long long dy8[] = {0, 1, 1, 1, 0, -1, -1, -1};\nconst long long dx9[] = {1, 1, 0, -1, -1, -1, 0, 1, 0};\nconst long long dy9[] = {0, 1, 1, 1, 0, -1, -1, -1, 0};\nconst int INF = 1000000007;\nconst long long LINF = 1000000000000000007;\n\n/* func */\ntemplate <typename T1, typename T2> inline bool chmin(T1 &a, const T2 &b) {\n    if(a > b) a = b;\n    return a > b;\n}\ntemplate <typename T1, typename T2> inline bool chmax(T1 &a, const T2 &b) {\n    if(a < b) a = b;\n    return a < b;\n}\nlong long max(long long x, int y) {\n    return max(x, (long long)y);\n}\nlong long max(int x, long long y) {\n    return max((long long)x, y);\n}\nlong long min(long long x, int y) {\n    return min(x, (long long)y);\n}\nlong long min(int x, long long y) {\n    return min((long long)x, y);\n}\n\n/* liblary */\n\n/* main */\n\nsigned main() {\n    ll n;\n    while(true) {\n        cin >> n;\n        if(n == 0) break;\n        set<string> s;\n        map<string, vector<pair<string, pl>>> v;\n        map<string, ll> tmp;\n        FOR(i, 0, n) {\n            string md, hm, e, p;\n            cin >> md >> hm >> e >> p;\n            ll h = stoi(hm.substr(0, 2));\n            ll m = stoi(hm.substr(3, 2));\n            ll t = m + h * 60;\n            s.insert(md);\n            if(e == \"I\") tmp[p] = t;\n            if(e == \"O\") v[md].push_back(make_pair(p, make_pair(tmp[p], t)));\n        }\n        map<string, ll> sum;\n        set<string> people;\n        for(auto md : s) {\n            vector<pl> gods;\n            for(auto x : v[md]) {\n                if(x.first == \"000\") {\n                    gods.pb(x.second);\n                }\n            }\n            for(auto god : gods) {\n                for(auto x : v[md]) {\n                    auto time = x.second;\n                    ll t;\n                    if(time.second <= god.first || god.second <= time.first)\n                        continue;\n                    if(god.first <= time.first) {\n                        t = min(god.second, time.second) - time.first;\n                    } else {\n                        t = min(god.second, time.second) - god.first;\n                    }\n                    if(x.first != \"000\") {\n                        people.insert(x.first);\n                        sum[x.first] += t;\n                    }\n                }\n            }\n        }\n        ll ans = 0;\n        for(auto p : people) {\n            ans = max(ans, sum[p]);\n        }\n        cout << ans << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nmap<string, int> dict; \nmap<string, int> enter;\n\nint dates[13] = {0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};\nint main()\n{\n    //freopen(\"input.txt\", \"r\" ,stdin);\n    for (int i=1; i<=12; i++)\n        dates[i] = dates[i-1] + dates[i]*1440;\n    int n;\n    while (scanf(\"%d\", &n)==1)\n    {\n        if (n==0)\n            break;\n        dict.clear();\n        enter.clear();\n        int m, d, hours, minutes;\n        char str[100];\n        char flag[100];\n        for (int i=1; i<=n; i++)\n        {\n            scanf(\"%d/%d\", &m, &d);\n            scanf(\"%d:%d\", &hours, &minutes);\n            scanf(\"%s%s\", flag, str);\n            int time = dates[m-1] + d*1440 + hours*60 + minutes;\n\n            if (string(str) == \"000\")\n            {\n                if (flag[0] == 'I')\n                {\n                    for(map<string, int>::iterator ite = enter.begin(); ite!=enter.end(); ite++)\n                        ite->second = time;\n                    enter[\"000\"] = time;\n                }\n                else\n                {\n                    for(map<string, int>::iterator ite = enter.begin(); ite!=enter.end(); ite++)\n                    {\n                        if (ite->first == \"000\")\n                            continue;\n                        dict[ite->first] += time - ite->second;\n                        ite->second = time;\n                    }\n                    enter.erase(\"000\");\n                }\n            }\n            else\n            {\n                if (flag[0] == 'I')\n                {\n                    enter[string(str)] = time;\n                }\n                else\n                {\n                    if (enter[\"000\"])\n                    {\n                        dict[string(str)] += time - enter[string(str)];\n                    }\n                    enter.erase(string(str));\n                }\n            }\n            //printf(\"%d %d %d %d %s %s\\n\", m, d, hours, minutes, flag, str);\n        }\n        int ans = 0;\n        for (map<string, int>::iterator ite = dict.begin(); ite!=dict.end(); ite++)\n        {\n            //printf(\"%s %d\\n\", ite->first.c_str(), ite->second);\n            ans = max(ans, ite->second);\n        }\n        printf(\"%d\\n\", ans);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define rep1(i,n) for(int i=1;i<=(int)(n);i++)\n#define all(c) c.begin(),c.end()\n#define pb push_back\n#define fs first\n#define sc second\n#define show(x) cout << #x << \" = \" << x << endl\n#define chmin(x,y) x=min(x,y)\n#define chmax(x,y) x=max(x,y)\nusing namespace std;\ntypedef long long ll;\nll mon[13]={0,31,28,31,30,31,30,31,31,30,31,30,31};\ntypedef pair<ll,ll> P;\nvector<ll> vl[1000];\nvector<P> vp[1000];\nvoid readtime(){\n\tll a,b,c,d;\n\tchar e;\n\tint f;\n\tscanf(\"%lld/%lld %lld:%lld %c %d\\n\",&a,&b,&c,&d,&e,&f);\n\tvl[f].pb((mon[a-1]+b)*24*60+c*60+d);\n}\nint main(){\n\trep(i,12) mon[i+1]+=mon[i];\n\twhile(true){\n\t\tint N;\n\t\tcin>>N;\n\t\tif(N==0) break;\n\t\trep(i,1000) vl[i].clear(),vp[i].clear();\n\t\trep(i,N) readtime();\n\t\trep(i,1000){\n\t\t\trep(j,vl[i].size()/2) vp[i].pb(P(vl[i][j*2],vl[i][j*2+1]));\n\t\t}\n\t\tll ans=0;\n\t\trep1(i,999){\n\t\t\tll tmp=0;\n\t\t\tfor(P p:vp[i]) for(P q:vp[0]) tmp+=max(0LL,min(p.sc,q.sc)-max(p.fs,q.fs));\n\t\t\tchmax(ans,tmp);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <map>\n#include <algorithm>\nusing namespace std;\n\nint tts[1000];\n\nint main() {\n    int n;\n    while (cin >> n, n) {\n        bool god_p = false;\n        int p_max = -1;\n        map<int, int> ts;\n        fill_n(tts, sizeof(tts) / sizeof(tts[0]), 0);\n        for (int i = 0; i < n; i++) {\n            string d;\n            int hh, mm, p;\n            char e;\n            cin >> d >> hh >> e >> mm >> e >> p;\n            p_max = max(p_max, p);\n            int t1 = hh * 60 + mm;\n            if (e == 'I') {\n                ts[p] = t1;\n                if (p == 0) {\n                    god_p = true;\n                }\n                continue;\n            }\n            int t0 = ts[p];\n            ts.erase(p);\n            if (p == 0) {\n                for (map<int, int>::iterator it = ts.begin(); it != ts.end(); it++) {\n                    tts[it->first] += t1 - max(t0, it->second);\n                }\n                god_p = false;\n                continue;\n            }\n            if (god_p) {\n                tts[p] += t1 - max(t0, ts[0]);\n            }\n        }\n        int tt_max = 0;\n        for (int i = 1; i <= p_max; i++) {\n            tt_max = max(tt_max, tts[i]);\n        }\n        cout << tt_max << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define for_(i,a,b) for(int i=a;i<b;++i)\n#define for_rev(i,a,b) for(int i=a;i>=b;--i)\n#define allof(a) a.begin(),a.end()\n#define minit(a,b) memset(a,b,sizeof(a));\n#define size_of(a) (int)a.size()\n\ntypedef long long lint;\ntypedef double Double;\ntypedef pair<int, int> pii;\n\nconst int iINF = 1L << 30;\nconst lint lINF = 1LL << 60;\nconst Double EPS = 1e-9;\n\nint n;\nint M[1010], D[1010], hh[1010], mm[1010], id[1010];\nbool enter[1010];\n\nint prev[1010];\nint sum_time[1010];\n\nvoid solve() {\n\tminit(sum_time, 0);\n\tint month = -1, day = -1;\n\tint god_in = -1;\n\t\n\tfor_(i,0,n) {\n\t\tint cur_time = 60 * hh[i] + mm[i];\n\t\t\n\t\tif (month != M[i] || day != D[i]) {\n\t\t\tminit(prev, -1);\n\t\t\tgod_in = -1;\n\t\t\t\n\t\t\tmonth = M[i];\n\t\t\tday = D[i];\n\t\t\t\n\t\t\tif (id[i] == 0) god_in = cur_time;\n\t\t\telse prev[ id[i] ] = cur_time;\n\t\t} else {\n\t\t\tif (id[i] == 0) {\n\t\t\t\tif (enter[i]) {\n\t\t\t\t\tgod_in = cur_time;\n\t\t\t\t} else {\n\t\t\t\t\tfor_(j,0,1010) {\n\t\t\t\t\t\tif (prev[j] == -1) continue;\n\t\t\t\t\t\t//cout << \"time : \" << i << \" add to \" << j << \" \" << cur_time - max(god_in, prev[j]) << endl;\n\t\t\t\t\t\tsum_time[j] += cur_time - max(god_in, prev[j]);\n\t\t\t\t\t}\n\t\t\t\t\tgod_in = -1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (enter[i]) {\n\t\t\t\t\tprev[ id[i] ] = cur_time;\n\t\t\t\t} else {\n\t\t\t\t\tif (god_in != -1) {\n\t\t\t\t\t\t//cout << \"time : \" << i << \" add to \" << id[i] << \" \" << cur_time - max(god_in, prev[id[i]]) << endl;\n\t\t\t\t\t\tsum_time[ id[i] ] += cur_time - max(god_in, prev[ id[i] ]);\n\t\t\t\t\t}\n\t\t\t\t\tprev[ id[i] ] = -1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tint ans = 0;\n\tfor_(j,0,1010) ans = max(ans, sum_time[j]);\n\tcout << ans << endl;\n}\n\nint main() {\n\twhile (cin >> n, n) {\n\t\t//cout << n << endl;\n\t\tchar c;\n\t\tfor_(i,0,n) {\n\t\t\tscanf(\"%d/%d %d:%d %c %d\", &M[i], &D[i], &hh[i], &mm[i], &c, &id[i]);\n\t\t\tif (c == 'I') enter[i] = true;\n\t\t\telse enter[i] = false;\n\t\t\t//cout << M[i] << \" \" << D[i] << \" \" << hh[i] << \" \" << mm[i] << (enter[i] ? \" I \" : \" O \") << id[i] << endl;\n\t\t}\n\t\tsolve();\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\nint idconv(string s)\n{\n\tint res = 0;\n\tfor (int i = 0; i < 3; i++)\n\t{\n\t\tres += (s[i] - '0');\n\t}\n\treturn res;\n}\n\nint timeconv(string s)\n{\n\tint res = 0;\n\tres += ((s[0] - '0') * 10 + (s[1] - '0'));\n\tres *= 60;\n\tres += ((s[3] - '0') * 10 + (s[4] - '0'));\n\treturn res;\n}\n\nint main()\n{\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tint n;\n\twhile (true)\n\t{\n\t\tcin >> n;\n\t\tif (n == 0)\n\t\t\tbreak;\n\t\tvector<int> sum(1000, 0);\n\t\tbool exist = false;\n\t\tvector<int> intime(1000, -1);\n\t\tfor (int i = 0; i < n; i++)\n\t\t{\n\t\t\tstring md, hm, e, p;\n\t\t\tcin >> md >> hm >> e >> p;\n\t\t\tint time = timeconv(hm), id = idconv(p);\n\t\t\tif (id == 0)\n\t\t\t{\n\t\t\t\tif (e == \"I\")\n\t\t\t\t{\n\t\t\t\t\texist = true;\n\t\t\t\t\tfor (int j = 1; j < 1000; j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (intime[j] > 0)\n\t\t\t\t\t\t\tintime[j] = time;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\texist = false;\n\t\t\t\t\tfor (int j = 1; j < 1000; j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (intime[j] > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsum[j] += (time - intime[j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (e == \"I\")\n\t\t\t\t{\n\t\t\t\t\tif (exist)\n\t\t\t\t\t{\n\t\t\t\t\t\tintime[id] = time;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tintime[id] = time;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (exist)\n\t\t\t\t\t{\n\t\t\t\t\t\tsum[id] += time - intime[id];\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t}\n\t\t\t\t\tintime[id] = -1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ma = -1;\n\t\tfor (int i = 1; i < 1000; i++)\n\t\t{\n\t\t\tif (sum[i] > ma)\n\t\t\t{\n\t\t\t\tma = sum[i];\n\t\t\t}\n\t\t}\n\t\tcout << ma << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "// #define _GLIBCXX_DEBUG // for STL debug (optional)\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <deque>\n#include <list>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <utility>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <complex>\n#include <cmath>\n#include <limits>\n#include <cfloat>\n#include <climits>\n#include <ctime>\n#include <cassert>\n#include <numeric>\n#include <fstream>\n#include <functional>\n#include <bitset>\nusing namespace std;\nusing ll = long long int;\nusing int64 = long long int;\n \ntemplate<typename T> void chmax(T &a, T b) {a = max(a, b);}\ntemplate<typename T> void chmin(T &a, T b) {a = min(a, b);}\ntemplate<typename T> void chadd(T &a, T b) {a = a + b;}\n \nint dx[] = {0, 0, 1, -1};\nint dy[] = {1, -1, 0, 0};\nconst int INF = 1LL << 29;\nconst ll LONGINF = 1LL << 60;\nconst ll MOD = 1000000007LL;\n\nint solve_testcase() {\n    int N; cin >> N;\n    if(N == 0) return 1;\n\n    vector< vector< tuple<int, int, int> > > info(31 * 12);\n    for(int i=0; i<N; i++) {\n        int day = 0, time = 0, inout = 0, id = -1;\n        {\n            int m, d; scanf(\"%d/%d\", &m, &d); m--, d--;\n            day = 31 * m + d;\n        }\n        {\n            int h, m; scanf(\"%d:%d\", &h, &m);\n            time = h * 60 + m;\n        }\n        {\n            char c; scanf(\" %c\", &c);\n            inout = (c == 'I' ? 1 : 0);\n        }\n        {\n            scanf(\" %d\", &id);\n        }\n        info[day].emplace_back(time, inout, id);\n    }\n\n    // id, 時間\n    map<int, int> rec;\n    const int MAX_TIME = 3600;\n    for(int d=0; d<31 * 12; d++) {\n        vector<bool> god(MAX_TIME);\n\n        // 誰がいまいるかの集合\n        set<int> S;\n        \n        int ptr = 0;\n        for(int t=0; t<MAX_TIME; t++) {\n            while(ptr < info[d].size() and get<0>(info[d][ptr]) == t) {\n                int inout, id; tie(std::ignore, inout, id) = info[d][ptr];\n                if(inout == 1) S.emplace(id);\n                if(inout == 0) S.erase(id);\n                ptr++;\n            }\n\n            god[t] = S.count(0);\n            for(auto p : S) {\n                if(p == 0) continue;\n                if(god[t]) rec[p]++;\n            }\n        }\n    }\n\n    int ans = 0;\n    for(auto e : rec) ans = max(ans, e.second);\n    printf(\"%d\\n\", ans);\n    return 0;\n}\n\nint main() {\n    while(!solve_testcase());\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <cstring>\nconst int MOD = 1e9 + 7;\nconst int dx[] = {1, -1, 0, 0};\nconst int dy[] = {0, 0, 1, -1};\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> P;\nstruct human\n{\n    vector<int> inout;\n    vector<int> date;\n};\nstruct god\n{\n    int in, out, date;\n};\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    int N;\n    while(cin >> N, N)\n    {\n        human info_h[N + 1];\n        god info_g[N + 1];\n        int last;\n        string day, time, inout, num;\n        int pos1 = 0, pos2 = 0;\n        vector<int> programer(1000, 0);\n        for(int i = 0; i < N; i++)\n        {\n            cin >> day >> time >> inout >> num;\n            string tmp_s = day.substr(0, 2);\n            tmp_s += day.substr(3);\n            int tmp_time = stoi(time.substr(0, 2)) * 60 + stoi(time.substr(3));\n            int tmp_num = stoi(num);\n            int tmp_day = stoi(tmp_s);\n            if(tmp_num == 0)\n            {\n                if(inout == \"I\")\n                {\n                    info_g[pos1].in = tmp_time;\n                    info_g[pos1].date = tmp_day;\n                }\n                else\n                {\n                    info_g[pos1].out = tmp_time;\n                    info_g[pos1].date = tmp_day;\n                    pos1++;\n                }\n            }\n            else\n            {\n                if(inout == \"I\")\n                {\n                    info_h[tmp_num].inout.push_back(tmp_time);\n                    info_h[tmp_num].date.push_back(tmp_day);\n                }\n                else\n                {\n                    info_h[tmp_num].inout.push_back(tmp_time);\n                    info_h[tmp_num].date.push_back(tmp_day);\n                }\n            }\n        }\n        for(int i = 0; i < pos1; i++)\n        {\n            for(int j = 0; j < N; j++)\n            {\n                for(int k = 0; k < info_h[j].inout.size(); k += 2)\n                {\n                    if(info_h[j].inout[k] > info_g[i].out || info_h[j].inout[k + 1] < info_g[i].in)\n                        continue;\n                    if(info_g[i].date != info_h[j].date[k])\n                        continue;\n                    programer[j] += min(info_h[j].inout[k + 1], info_g[i].out) - max(info_h[j].inout[k], info_g[i].in);\n                }\n            }\n        }\n        int ans = 0;\n        for(int i = 0; i < N; i++)\n        {\n            if(programer[i] > ans)\n                ans = programer[i];\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include\"bits/stdc++.h\"\n\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\nusing pii = pair<int, int>;\nusing pll = pair<ll, ll>;\n\n#define FOR(k,m,n) for(ll (k)=(m);(k)<(n);(k)++)\n#define REP(i,n) FOR((i),0,(n))\n#define WAITING(str) int str;std::cin>>str;\n#define DEBUGING(str) cout<< #str << \" \" str<<endl\n\nconstexpr int INF = (1 << 30);\nconstexpr ll INFL = (1ll << 60);\nconstexpr ll MOD = 1000000007;// 10^9+7\n\nstruct Time {\n\tTime() :h(0), m(0), idx(\"\") {}\n\tTime(string time, string _idx) :idx(_idx) {\n\t\th = (time[0] - '0') * 10 + (time[1] - '0');\n\t\tm = (time[3] - '0') * 10 + (time[4] - '0');\n\t}\n\tint h, m;\n\tstring idx;\n\tint diff(const Time& opp)const {\n\t\treturn trans() - opp.trans();\n\t}\n\tint trans() const {\n\t\treturn h * 60 + m;\n\t}\n};\n\nint main()\n{\n\twhile (true) {\n\t\tint n;\n\t\tcin >> n;\n\t\tif (!n)break;\n\n\t\tTime goddess;\n\t\tmap<string, Time> mp;\n\t\tmap<string, int> res;\n\t\tREP(i, n) {\n\t\t\tstring date, time, kind, id;\n\t\t\tcin >> date >> time >> kind >> id;\n\t\t\tTime tgt(time, id);\n\n\t\t\tif (kind == \"I\") {\n\t\t\t\t(tgt.idx == \"000\" ? goddess : mp[tgt.idx]) = tgt;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (tgt.idx == \"000\") {\n\t\t\t\t\tfor (auto itr = mp.begin(); itr != mp.end(); ++itr) {\n\t\t\t\t\t\tstring name = itr->first;\n\t\t\t\t\t\tTime opp = itr->second;\n\t\t\t\t\t\tres[name] += opp.diff(goddess) > 0\n\t\t\t\t\t\t\t? tgt.diff(opp)\n\t\t\t\t\t\t\t: tgt.diff(goddess);\n\t\t\t\t\t}\n\t\t\t\t\tgoddess = Time();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (goddess.h != 0 || goddess.m != 0) {\n\t\t\t\t\t\tTime in = mp[tgt.idx];\n\t\t\t\t\t\tres[tgt.idx] += in.diff(goddess) > 0\n\t\t\t\t\t\t\t? tgt.diff(in)\n\t\t\t\t\t\t\t: tgt.diff(goddess);\n\t\t\t\t\t}\n\t\t\t\t\tmp.erase(tgt.idx);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tint mm = 0;\n\t\tfor (auto itr = res.begin(); itr != res.end(); ++itr)\n\t\t\tmm = max(mm, itr->second);\n\t\tcout << mm << endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<vector>\n#include<cstdio>\n#include<cmath>\n#include<queue>\n#include<stack>\n#include<map>\n#include<set>\n#define ll long long\n#define clr(a, b) memset(a, b, sizeof(a))\n\nusing namespace std;\n\nstruct in{\n    char data[10],s[10];\n    int minu,num;\n    void input(){\n        int h,m;\n        scanf(\"%s%d:%d%s%d\",data,&h,&m,s,&num);\n        minu=h*60+m;\n//        printf(\"%d\\n\",minu);\n    }\n}p[10001];\n\nint n;\nbool vis[20000];\nint ans[10020];\nint str[20000];\n\nint main(){\n    while(scanf(\"%d\",&n)&&n){\n        for(int i=0;i<n;i++){\n            p[i].input();\n        }\n        memset(ans,0,sizeof(ans));\n        char s1[10];\n        strcpy(s1,p[0].data);\n        memset(vis,0,sizeof(vis));\n        bool now =false;\n\n        for(int i=0;i<n;i++){\n            if(strcmp(s1,p[i].data)==0){\n                if(p[i].s[0]=='I'){\n                    if(p[i].num==0){\n                        now =true;\n                        str[p[i].num]=p[i].minu;\n                    }else{\n                        vis[p[i].num]=true;\n                        str[p[i].num]=p[i].minu;\n                    }\n                }else{\n                    if(p[i].num==0){\n                        now =false;\n                        for(int j=1;j<=1000;j++){\n                            if(vis[j]==false)continue;\n                            ans[j]+=p[i].minu-max(str[0],str[j]);\n                        }\n                    }else{\n                        vis[p[i].num]=false;\n                        if(now == false)continue;\n                        ans[p[i].num]+=p[i].minu-max(str[0],str[p[i].num]);\n                    }\n                }\n            }else{\n                if(now ==1){\n                    for(int j=1;j<=1000;j++){\n                        if(vis[j]==false)continue;\n                        ans[j]+=24*60-max(str[0],str[j]);\n                    }\n                }\n                now =false;\n                memset(s1,0,sizeof s1);\n                memset(vis,0,sizeof vis);\n                strcpy(s1,p[i].data);\n                if(p[i].num==0){\n                    now =true;\n                    str[p[i].num]=p[i].minu;\n                }else{\n                    vis[p[i].num]=true;\n                    str[p[i].num]=p[i].minu;\n                }\n            }\n        }\n        if(now ==1){\n            for(int j=1;j<=1000;j++){\n                if(vis[j]==false)continue;\n                ans[j]+=24*60-max(str[0],str[j]);\n            }\n        }\n        int ans1 = 0;\n        for(int i=1;i<1000;i++){\n            ans1 =max(ans1,ans[i]);\n        }\n        printf(\"%d\\n\",ans1);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n\nstruct segtree{\n  vector<int> datasum;\n  vector<int> delay;\n \n  int n;\n \n  //テ・ツ按敕ヲツ慊淌・ツ個?\n  void init(int _n){\n    n = 1;\n    while( n < _n ) n*=2;\n    datasum.resize( 2 * n );\n    delay.resize( 2 * n );\n  }\n \n  //テ」ツつッテ」ツδェテ」ツつ「(テ、ツスツ陛・ツコツヲテ」ツつづ、ツスツソテ」ツ??・ツ?エテ・ツ青暗ッツシツ?\n  void clear(){\n    datasum.clear();\n    delay.clear();\n  }\n  \n  void delaycalc(int k,int l,int r){\n    datasum[k] = datasum[k] + delay[k]*(r-l);\n    if( k+1 < n ){\n      for(int i=1;i<=2;i++){\n\tdelay[2*k+i] = delay[2*k+i]+delay[k];\n      }\n    }\n    delay[k] = 0;\n  }   \n \n  //テ・ツ個コテゥツ鳴禿」ツ??a,b)テ」ツ??」ツ?ォテ、ツクツ?ヲツァツ佚」ツ?ォテ」ツ??テ」ツ??」ツつ津ィツカツウテ」ツ??\n  void add(int a,int b,int x,int k,int l,int r){\n    delaycalc(k,l,r);\n    if( r<=a || b<=l ) return;\n    else if( a<=l && r<=b ){\n      delay[k] = x;\n      delaycalc(k,l,r);\n    } else {\n      add( a, b, x, 2*k + 1, l, (l+r)/2 );\n      add( a, b, x, 2*k + 2, (l+r)/2, r );\n      datasum[k] = datasum[2*k+1]+datasum[2*k+2];\n    }\n  }\n \n  int querysum(int a,int b,int k,int l,int r){\n    delaycalc(k,l,r);\n    if( r<=a || b<=l ) return 0;\n    if( a<=l && r<=b ){\n      return datasum[k]+delay[k]*(r-l);\n    } else {\n      int vl = querysum( a, b, 2*k+1, l,(l+r)/2 );\n      int vr = querysum( a, b, 2*k+2, (l+r)/2,r );\n      return vl+vr;\n    }\n  }\n \n  void add( int a,int b,int x){ add( a, b, x, 0,0,n); }\n  int querysum(int a,int b){ return querysum(a,b,0,0,n); }\n};\ntypedef pair<int,int> P;\nsegtree S[400];\nvector<P> st[1001];\nbool used[400];\nint main(){\n  int N;\n  while(cin >> N && N ){\n    for(int i=0;i<N;i++){\n      int m,d,h,mi,no;\n      char ex;\n      scanf(\"%d/%d %d:%d %c %d\",&m,&d,&h,&mi,&ex,&no);\n      int dt = m*31+d;\n      int mini = h * 60 + mi;\n      st[no].push_back(P(dt,mini));\n    }\n    memset(used,0,sizeof(used));\n    for(int i=0;i<(int)st[0].size();i+=2){\n      int dat = st[0][i].first;\n      int sta = st[0][i].second;\n      int ed = st[0][i+1].second;\n      if( !used[dat] ){\n\tS[dat].init(60*24+1);\n      }\n      used[dat] = true;\n      S[dat].add(sta,ed,1);\n    }\n    int res = 0;\n    for(int i=1;i<1000;i++){\n      int r=0;\n      for(int j=0;j<(int)st[i].size();j+=2){\n\tint dat = st[i][j].first;\n\tint sta = st[i][j].second;\n\tint ed = st[i][j+1].second;\n\tif( !used[dat] ) continue;\n\tr+=S[dat].querysum( sta, ed );\n      }\n      res = max( res, r );\n    }\n    for(int i=0;i<400;i++){\n      st[i].clear();\n      S[i].clear();\n    }\n    cout << res << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "////////////////////////////////////////\n///  tu3 pro-con template            ///\n////////////////////////////////////////\n#include <cassert>\n#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <iostream>\n#include <sstream>\n#include <algorithm>\n#include <numeric>\n#include <functional>\n#include <vector>\n#include <queue>\n#include <string>\n#include <complex>\n#include <stack>\n#include <set>\n#include <map>\n#include <list>\n#include <unordered_map>\n#include <unordered_set>\n#include <bitset>\n#include <regex>\nusing namespace std;\n\n//// MACRO ////\n#define countof(a) (sizeof(a)/sizeof(a[0]))\n\n#define REP(i,n) for (int i = 0; i < (n); i++)\n#define RREP(i,n) for (int i = (n)-1; i >= 0; i--)\n#define FOR(i,s,n) for (int i = (s); i < (n); i++)\n#define RFOR(i,s,n) for (int i = (n)-1; i >= (s); i--)\n#define pos(c,i) c.being() + (i)\n#define allof(c) c.begin(), c.end()\n#define aallof(a) a, countof(a)\n#define partof(c,i,n) c.begin() + (i), c.begin() + (i) + (n)\n#define apartof(a,i,n) a + (i), a + (i) + (n)\n#define long long long\n\n#define EPS 1e-9\n#define INF (1L << 30)\n#define LINF (1LL << 60)\n\n#define PREDICATE(t,a,exp) [&](const t & a) -> bool { return exp; }\n#define COMPARISON_T(t) bool(*)(const t &, const t &)\n#define COMPARISON(t,a,b,exp) [&](const t & a, const t & b) -> bool { return exp; }\n#define CONVERTER(TSrc,t,TDest,exp) [&](const TSrc &t)->TDest { return exp; }\n\ninline int sign(double x) { return (abs(x) < EPS ? 0 : x > 0 ? 1 : -1); }\ninline bool inRange(int val, int min, int max) { return val >= min && val < max; }\ninline bool inRange(double val, double min, double max) { return val - min > -EPS && val - max < EPS; }\ntemplate <class T> struct vevector : public vector<vector<T>> { vevector(int n = 0, int m = 0, const T &initial = T()) : vector<vector<T>>(n, vector<T>(m, initial)) { } };\ntemplate <class T> struct vevevector : public vector<vevector<T>> { vevevector(int n = 0, int m = 0, int l = 0, const T &initial = T()) : vector<vevector<T>>(n, vevector<T>(m, l, initial)) { } };\ntemplate <class T> struct vevevevector : public vector<vevevector<T>> { vevevevector(int n = 0, int m = 0, int l = 0, int k = 0, const T &initial = T()) : vector<vevevector<T>>(n, vevevector<T>(m, l, k, initial)) { } };\ninline bool contains(int x, int y, int W, int H) { return x >= 0 && x < W && y >= 0 && y < H; } // W,H含まない\n\n//// i/o helper ////\n\n#ifdef _DEBUG\n#define DEBUG WRITE\ninline void readfrom(string filename) { freopen(filename.c_str(), \"r\", stdin); }\ninline void writeto(string filename) { freopen(filename.c_str(), \"w\", stdout); }\n#else\n#define DEBUG(...)\ninline void readfrom(...) { }\ninline void writeto(...) { }\n#endif\n#ifdef ccout\n#  define cout ccout\n#  define endl cendl\n#endif\n\nstruct _Reader { template <class T> _Reader operator ,(T &rhs) { cin >> rhs; return *this; } };\nstruct _Writer { bool f; _Writer() : f(false) { } template <class T> _Writer operator ,(const T &rhs) { cout << (f ? \" \" : \"\") << rhs; f = true; return *this; } };\n#define READ(t,...) t __VA_ARGS__; _Reader(), __VA_ARGS__\n#define WRITE(...) _Writer(), __VA_ARGS__; cout << endl\n\ntemplate <class T> T read() { T t; cin >> t; return t; }\ntemplate <class T> vector<T> read(int n) { vector<T> v; REP(i, n) { v.push_back(read<T>()); } return v; }\ntemplate <class T> vevector<T> read(int n, int m) { vevector<T> v; REP(i, n) v.push_back(read<T>(m)); return v; }\ntemplate <class T> vevector<T> readjag() { return read<T>(read<int>()); }\ntemplate <class T> vevector<T> readjag(int n) { vevector<T> v; REP(i, n) v.push_back(readjag<T>()); return v; }\n\ntemplate <class T1, class T2> inline istream & operator >> (istream & in, pair<T1, T2> &p) { in >> p.first >> p.second; return in; }\ntemplate <class T1, class T2> inline ostream & operator << (ostream &out, pair<T1, T2> &p) { out << p.first << p.second; return out; }\ntemplate <class T> inline ostream & operator << (ostream &out, const vector<T> &v)\n{\n\tostringstream ss;\n\tfor (auto x : v) ss << x << ' ';\n\tauto s = ss.str();\n\tout << s.substr(0, s.length() - 1) << endl;\n\treturn out;\n}\n\n//// start up ////\nvoid solve();\n\n\nint main()\n{\n\tsolve();\n\treturn 0;\n}\n\n////////////////////\n/// template end ///\n////////////////////\n\nvoid solve()\n{\n\tint testcases = INF;\n\tREP(testcase, testcases)\n\t{\n\t\tREAD(int, n);\n\t\tif (!(n)) break;\n\t\t\n\t\tvector<int> checkin(1000);\n\t\tvector<int> endowed(1000);\n\n\t\tREP(i, n)\n\t\t{\n\t\t\tint h, m, id;\n\t\t\tscanf(\"%*s%d:%d %*c %d\", &h, &m, &id);\n\t\t\t\n\t\t\tint cur = h * 60 + m;\n\t\t\tif (!checkin[id]) { checkin[id] = cur; }\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (checkin[0])\n\t\t\t\t{\n\t\t\t\t\tif (id == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tFOR(i, 1, 1000) if (checkin[i])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tendowed[i] += cur - max(checkin[i], checkin[0]);\n\t\t\t\t\t\t\tDEBUG(\"endowed[\", id, \"] = \", endowed[id]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif (checkin[id])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tendowed[id] += cur - max(checkin[id], checkin[0]);\n\t\t\t\t\t\t\tDEBUG(\"endowed[\", id, \"] = \", endowed[id]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcheckin[id] = 0;\n\t\t\t}\n\t\t}\n\t\tWRITE(*max_element(allof(endowed)));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <cassert>\n#include <memory>\n#include <time.h>\nusing namespace std;\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n) FOR(i,0,n)\nconst double EPS = 1e-9;\nconst double PI  = acos(-1.0);\n\n\nstruct programmer{\n\tint score,presence;\n\tprogrammer():score(0),presence(0){}\n};\nstruct evnt{\n\tint month,date;\n\tint hour,min;\n\tchar inout;\n\tint id;\n};\nint main(){\n\tint n;\n\twhile(cin>>n,n){\n\t\tvector<programmer> programmers(1000);\n\t\tint pl=programmers.size();\n\t\tvector<evnt> evnts(n);\n\t\tREP(i,n){\n\t\t\tchar sep;\n\t\t\tcin>>evnts[i].month>>sep>>evnts[i].date>>evnts[i].hour>>sep>>evnts[i].min>>evnts[i].inout>>evnts[i].id;\n\t\t}\n\t\tFOR(i,1,evnts.size()){\n\t\t\tif(evnts[i].date!=evnts[i-1].date){\n\t\t\t\tevnt e;\n\t\t\t\te.month=evnts[i-1].month;\n\t\t\t\te.date=evnts[i-1].date;\n\t\t\t\te.hour=24;\n\t\t\t\te.min=0;\n\t\t\t\te.inout='C';\n\t\t\t\tevnts.insert(evnts.begin()+i,e);\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t\t\t\tevnt e;\n\t\t\t\te.month=evnts[evnts.size()-1].month;\n\t\t\t\te.date=evnts[evnts.size()-1].date;\n\t\t\t\te.hour=24;\n\t\t\t\te.min=0;\n\t\t\t\te.inout='C';\n\t\t\t\tevnts.push_back(e);\n\n\t\tint prevtime=0;\n\t\tint goddess_presence=0;\n\t\tREP(i,n){\n\t\t\tint curtime=evnts[i].hour*60+evnts[i].min;\n\t\t\tif(evnts[i].inout=='C'){\n\t\t\t\tREP(j,pl){\n\t\t\t\t\tif(programmers[j].presence){\n\t\t\t\t\t\tprogrammers[j].score+=curtime-prevtime;\n\t\t\t\t\t}\n\t\t\t\t\tprogrammers[j].presence=0;\n\t\t\t\t}\n\t\t\t\tgoddess_presence=0;\n\t\t\t\tprevtime=0;\n\t\t\t}else if(evnts[i].id==0){\n\t\t\t\tif(evnts[i].inout=='O'){\n\t\t\t\t\tREP(j,pl){\n\t\t\t\t\t\tif(programmers[j].presence){\n\t\t\t\t\t\t\tprogrammers[j].score+=curtime-prevtime;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tgoddess_presence=evnts[i].inout=='I';\n\t\t\t}else{\n\t\t\t\tif(goddess_presence){\n\t\t\t\t\tREP(j,pl){\n\t\t\t\t\t\tif(programmers[j].presence){\n\t\t\t\t\t\t\tprogrammers[j].score+=curtime-prevtime;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tprogrammers[evnts[i].id].presence=evnts[i].inout=='I';\n\t\t\t}\n\t\t\tprevtime=curtime;\n\t\t\t//cerr<<curtime<<\"*\"<<evnts[i].month<<evnts[i].date<<\"-\"<<evnts[i].hour<<\":\"<<evnts[i].min<<\"= \";\n\t\t\t//FOR(j,1,5){\n\t\t\t//\tcerr<<programmers[j].score<<\",\";\n\t\t\t//}\n\t\t\t//cerr<<endl;\n\t\t}\n\t\tint ans=0;\n\t\tREP(i,pl){\n\t\t\tans=max(ans,programmers[i].score);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#pragma warning(disable:4996)\n\n#define MAX_N 10000\n#define MAX_M 501\n\nint Q;\nint M[MAX_N], D[MAX_N], h[MAX_N], m[MAX_N], t[MAX_N], n[MAX_N];\nint K[MAX_N], L[MAX_N];\nchar c;\n\nint main() {\n\twhile (true) {\n\t\tfor (int i = 0; i < MAX_N; i++) { M[i] = 0; D[i] = 0; h[i] = 0; m[i] = 0; t[i] = 0; n[i] = 0; K[i] = 0; L[i] = 0; }\n\t\tbool megami = false; int zenkai = 0; cin >> Q; if (Q == 0) { break; }\n\t\tfor (int i = 0; i < Q; i++) {scanf(\"%02d/%02d %02d:%02d %c %03d\", &M[i], &D[i], &h[i], &m[i], &c, &n[i]); if (c == 'I') { t[i] = 0; } else { t[i] = 1; }}\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tif (t[i] == 0) { L[n[i]] = 1; }if (t[i] == 1) { L[n[i]] = 0; }\n\t\t\tif (megami == true) { for (int j = 0; j < MAX_M; j++) { if (L[j] == 1) { K[j] += (h[i] * 60 + m[i]) - zenkai; } } }\n\t\t\tzenkai = h[i] * 60 + m[i]; if (L[0] == 0) { megami = true; } else { megami = false; }\n\t\t}\n\t\tint maxn = 0; for (int i = 0; i < MAX_M; i++) { maxn = max(maxn, K[i]); }cout << maxn << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <queue>\n\nusing namespace std;\n\nint time2min (string s) {\n    char buf[] = {s[0],s[1],'\\0'};\n    char buf2[] = {s[3],s[4],'\\0'};\n    return atoi(buf)*60 + atoi(buf2);\n}\n\nint main()\n{\n    int n;\n    while (cin >> n, n) {\n        string predate =  \"00/00\";\n        queue<int> que;\n        int praytime[1000];\n        int lastin[1000];\n        fill_n((int *)praytime, 1000, 0);\n        for (int i = 0; i < n; i++) {\n            // input\n             string date, stime;\n            char io;\n            int id;\n            cin >> date >> stime >> io >> id;\n            int min = time2min(stime);\n\n            // if change date\n            if (predate != date) {\n                fill_n((int *)lastin, 1000, -1);\n            }\n\n            if (io == 'I') {\n                if (id != 0) {\n                    que.push(id);\n                } else { // goddess\n                    que.push(id);\n                    while (!que.empty()) {\n                        int d = que.front(); que.pop();\n                        if (d == 0) break;\n                        lastin[d] = min;\n                        que.push(d);\n                    }\n                }\n                lastin[id] = min;\n            }\n\n            if (io == 'O') {\n                if (id != 0) {\n                    if (lastin[0] != -1)\n                        praytime[id] += min - lastin[id];\n                    while (!que.empty()) {\n                        int d = que.front(); que.pop();\n                        if (d == id) break;\n                        que.push(d);\n                    }\n                } else { // goddess\n                    que.push(id);\n                    while (!que.empty()) {\n                        int d = que.front(); que.pop();\n                        if (d == 0) break;\n                        praytime[d] += min - lastin[id];\n                        que.push(d);\n                    }\n                }\n                lastin[id] = -1;\n            }\n            predate = date;\n        }\n        int ma = 0;\n        for (int i = 1; i < 1000; i++) {\n            ma = max(praytime[i], ma);\n        }\n        cout << ma << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define mk make_pair\n#define fi first\n#define se second\nusing namespace std;\nstruct B{\n  int size;\n  vector<int> dat;\n  void init(int n){\n    size=n;\n    dat.clear();\n    dat.resize(n+1);\n  }\n  void Add(int i,int x){\n    while(0<i&&i<=size)\n      dat[i]+=x,i+=(i&-i);\n  }\n  int Sum(int i){\n    int res=0;\n    while(0<i)\n      res+=dat[i],i-=(i&-i);\n    return res;\n  }\n};\nint main(){\n  int n;\n  while(cin>>n,n){\n    int ans=0;\n    vector<int>v[1001];\n    for(int i=0;i<n;i++){\n      int pp=0,m,d,h,ss,t;\n      scanf(\"%d/%d %d:%d\",&m,&d,&h,&ss);\n      pp=m*40*24*60+d*24*60+h*60+ss;\n      string s1,s2;\n      cin>>s1>>t;\n      v[t].push_back(pp);\n    }\n    for(int o=1;o<1001;o++)if(v[o].size()){\n      B A,B;\n      A.init(900000);\n      B.init(900000);\n      for(int i=0;i<v[o].size();i+=2){\n\tint ss=v[o][i],tt=v[o][i+1];ss+=11,tt+=10;\n\tA.Add(ss,1);\n        A.Add(tt,-1);\n        B.Add(ss,(-1)*(ss-1));\n        B.Add(tt,(ss-1) + (tt-ss+1) );\n      }\n      int sum=0;\n      for(int i=0;i<v[0].size();i+=2){\n\tint ss=v[0][i],tt=v[0][i+1];ss+=10;tt+=10;\n\tsum+=A.Sum(tt)*tt+B.Sum(tt) - A.Sum(ss)*ss-B.Sum(ss);\n      }\n      ans=max(sum,ans);\n    }\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <limits.h>\n#define init(A,B) { int i; for(i=0; i<B; i++) A[i]=0; }\n\n#define P_MAX 1000\n#define N_MAX 1000\n\nstruct data{ int time; char type; int ID; };\n\nint main(void){\n\tint N;\n\t\n\twhile(scanf(\"%d\\n\",&N), N!=0){\n\t\tint i, j=0, k, t[4], max=0, presence[P_MAX], time[P_MAX]; struct data dat[N_MAX];\n\t\tinit(presence,P_MAX); init(time,P_MAX);\n\t\t\n\t\tfor(i=0; i<N; i++){\n\t\t\tscanf(\"%2d/%2d %2d:%2d %c %3d\\n\",&t[0],&t[1],&t[2],&t[3],&dat[i].type,&dat[i].ID);\n\t\t\tdat[i].time=t[3]+60*(t[2]+24*(t[1]+31*t[0]));\n\t\t}\n\t\t\n\t\tfor(i=dat[0].time; i<=dat[N-1].time; i++){\n\t\t\tif(dat[j].time==i && j<N){\n\t\t\t\twhile(dat[j].time==i){\n\t\t\t\t\tif(dat[j].type=='I') presence[dat[j].ID]=1;\n\t\t\t\t\telse presence[dat[j].ID]=0;\n\t\t\t\t\tj++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(presence[0]==1) for(k=1; k<P_MAX; k++) time[k]+=presence[k];\n\t\t}\n\t\t\n\t\tfor(i=1; i<P_MAX; i++) if(max<time[i]) max=time[i];\n\t\t\n\t\tprintf(\"%d\\n\",max);\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "/*\n  AOJ 1315\n  Title:Gift from the Goddess of Programming\n  @kankichi573\n*/\n#include <stdio.h>\n#include <string.h>\n#define max(x,y) (((x)>(y))?(x):(y))\n\nstruct time_st {\n  int hour;\n  int min;\n  int in_flag;} \nlast_in[1000];\nint acc[1000];\n\nvoid dump()\n{\n  int i;\n  for(i=0;i<1000;i++)\n    if(acc[i])\n      printf(\"acc[%d]=%d|\",i,acc[i]);\n  printf(\"\\n\");\n}\nmain()\n{\n  int mm,d,h,m,p,i,j,n,max_;\n  char e;\n\n  while(scanf(\"%d\",&n) && n)\n    {\n      memset(last_in,0,sizeof(last_in));\n      memset(acc,0,sizeof(acc));\n      for(i=0;i<n;i++)\n\t{\n\t  scanf(\"%d/%d %d:%d %c %d\",&mm,&d,&h,&m,&e,&p);\n#ifdef DEBUG\n\t  printf(\"%02d %02d %c %03d:\",h,m,e,p);\n#endif\n\t  if(e=='I')\n\t    {\n\t      if(p==0)\n\t\t{\n\t\t  last_in[0].in_flag=1;\n\t\t  for(j=1;j<1000;j++)\n\t\t    if(last_in[j].in_flag)\n\t\t      {\n\t\t\tlast_in[j].hour=h;\n\t\t\tlast_in[j].min =m;\n\t\t      }\n\t\t}\n\t      else\n\t\t{\n\t\t  if(last_in[0].in_flag)\n\t\t    {\n\t\t      last_in[p].hour=h;\n\t\t      last_in[p].min =m;\n\t\t    }\n\t\t  last_in[p].in_flag=1;\n\t\t}\n\t    }\n\t  if(e=='O')\n\t    {\n\t      if(p==0)\n\t\t{\n\t\t  last_in[0].in_flag=0;\n\t\t  for(j=1;j<1000;j++)\n\t\t    if(last_in[j].in_flag)\n\t\t      {\n\t\t\tacc[j] += 60*(h - last_in[j].hour)+(m-last_in[j].min);\n\t\t      }\n\t\t}\n\t      else\n\t\t{\n\t\t  if(last_in[0].in_flag)\n\t\t    {\n\t\t      acc[p] += 60*(h-last_in[p].hour)+(m-last_in[p].min);\n\t\t    }\n\t\t  last_in[p].in_flag=0;\n\t\t}\n\t    }\n#ifdef DEBUG\n\t  dump();\n#endif\n\t}\n      max_=0;\n      for(i=1;i<1000;i++)\n\tmax_=max(max_,acc[i]);\n      printf(\"%d\\n\",max_);\n    }\n  return(0);\n}"
  },
  {
    "language": "C",
    "code": "#define ma(a,b)(a>b?a:b)\nT[999],X[999],q,n,A,a,B,b,h,m,p;N(){if(~T[0])for(q=1;q<999;q++)if(~T[q])X[q]+=1440-ma(T[q],T[0]),T[q]=-1;T[0]=-1;}main(){for(;scanf(\"%d\",&n),n;printf(\"%d\\n\",m)){for(memset(T,0xff,3996),memset(X,0,3996),A=0;n--;){if(scanf(\"%d/%d%d:%d%s%d\",&a,&b,&h,&m,&p,&p),A-a||B-b)N(),A=a,B=b;if(h=h*60+m,~T[p]){if(p==0){for(q=1;q<999;q++)if(~T[q])X[q]+=h-ma(T[q],T[0]);}else if(~T[0])X[p]+=h-ma(T[p],T[0]);T[p]=-1;}else T[p]=h;}for(N(),m=0,p=1;p<999;p++)if(m<X[p])m=X[p];}exit(0);}"
  },
  {
    "language": "C",
    "code": "int T[1000],X[1000],q;\n#define ma(a,b)(a>b?a:b)\nnewday(){if(~T[0])for(q=1;q<1000;q++)if(~T[q])X[q]+=1440-ma(T[q],T[0]),T[q]=-1;T[0]=-1;}\nmain(){\n\tint n,A,a,B,b,h,m,p;\n\tfor(;scanf(\"%d\",&n),n;){\n\t\tmemset(T,0xff,sizeof(T));\n\t\tmemset(X,0,sizeof(X));\n\t\tfor(A=0;n;n--){\n\t\t\tscanf(\"%d/%d %d:%d %c %d\",&a,&b,&h,&m,&p,&p);\n\t\t\tif(A-a||B-b)newday(),A=a,B=b;\n\t\t\th=h*60+m;\n\t\t\tif(T[p]==-1)T[p]=h;\n\t\t\telse{\n\t\t\t\tif(p==0){\n\t\t\t\t\tfor(q=1;q<1000;q++){\n\t\t\t\t\t\tif(~T[q]){\n\t\t\t\t\t\t\tX[q]+=h-ma(T[q],T[0]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tif(~T[0])X[p]+=h-ma(T[p],T[0]);\n\t\t\t\t}\n\t\t\t\tT[p]=-1;\n\t\t\t}\n\t\t}\n\t\tnewday();\n\t\tfor(m=0,p=1;p<1000;p++){\n\t\t\tif(m<X[p])m=X[p];\n\t\t}\n\t\tprintf(\"%d\\n\",m);\n\t}\n\texit(0);\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#define max(A,B) ((A) > (B) ? (A) : (B))\n\nint M0, D0, h0, m0; /* int型の時刻の基準 */\n\nvoid setOriginTime(int M, int D, int h, int m) {\n\tM0 = M; D0 = D; h0 = h; m0 = m;\n}\n\n/* 時刻を計算用の整数値に変換する */\nint timeToInt(int M, int D, int h, int m) {\n\tint t;\n\tt = M - M0;\n\tt = t * 30 + D - D0;\n\tt = t * 24 + h - h0;\n\tt = t * 60 + m - m0;\n\treturn t;\n}\n\nint main(void) {\n\tint n; /* 日誌の行数 */\n\n\t/* データセット毎の処理 */\n\twhile (scanf(\"%d\", &n) == 1 && n > 0 && n <= 1000) {\n\t\tint io[1000] = {}; /* 現在祭壇にいるか */\n\t\tint ti[1000] = {}; /* 最後に祭壇に入った時刻 */\n\t\tint total[1000] = {}; /* 女神のいる間に祭壇にいた合計時間 */\n\t\tint M, D, h, m, p, i, t;\n\t\tchar e;\n\n\t\t/* 行毎の処理 */\n\t\tfor (i = 0; i < n; i++) {\n\t\t\tscanf(\"%d/%d %d:%d %c %d\", &M, &D, &h, &m, &e, &p); /* 一行入力 */\n\t\t\tif (i == 0) setOriginTime(M, D, h, m); /* 最初のログを時刻の基準とする */\n\n\t\t\tt = timeToInt(M, D, h, m); /* 整数値に変換する */\n\n\t\t\tif (e == 'I') {\n\t\t\t\t/* 入室 */\n\t\t\t\tio[p] = 1;\n\t\t\t\tti[p] = t;\n\t\t\t} else if (e == 'O') {\n\t\t\t\t/* 退室 */\n\t\t\t\tio[p] = 0;\n\t\t\t\tif (p == 0) {\n\t\t\t\t\t/* 女神 */\n\t\t\t\t\tint j;\n\t\t\t\t\t/* 女神退室時点での全てのプログラマーの滞在時間を計算する */\n\t\t\t\t\tfor (j = 1; j < 1000; j++) {\n\t\t\t\t\t\tif (io[j]) total[j] += t - max(ti[j], ti[0]);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t/* プログラマー */\n\t\t\t\t\tif (io[0]) total[p] += t - max(ti[p], ti[0]); /* 両者が祭壇にいた時間を加える */\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/* 合計時間の最大値を探す */\n\t\tint tmax = total[1];\n\t\tfor (i = 2; i < 1000; i++) {\n\t\t\tif (total[i] > tmax) tmax = total[i];\n\t\t}\n\n\t\tprintf(\"%d\\n\", tmax);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <iostream>\n#include <algorithm>\n#include <sstream>\n#include <stdlib.h>\n#include <string.h>\n#include <limits.h>\n#include <string>\n#include <time.h>\n#include <math.h>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\nusing namespace std;\n#define inf 0x3f3f3f3f\n#define eps 1e-8\n#define pi acos(-1.0)\ntypedef long long ll;\n\nint n,m,cap;\nstring ssrc,sdest;\nint src,dest;\nset<string>s;\nstring ss;\nmap<string,int> mp;\nint des[3005];\nstring a[3000];\nstring b[3000];\n\nstruct node{\n\tint dis;\n\tint to;\n\tnode(int dis,int to):dis(dis),to(to){\n\t}\n};\nset<string>::iterator it;\n\n\n\n\n\nstruct node1{\n\tint go;\n\tint node;\n};\nqueue<node1>q;\n\n\n\n\n\nbool flag[3333];\nint dist[3333][2000];\nvector<node>p[3333];\nbool inq[3333];\nint main()\n{\n\twhile(1)\n\t{\n\t\tscanf(\"%d %d %d\",&n,&m,&cap);\n\t\tcap*=10;\n\t\tcin>>ssrc>>sdest;\n\t\ts.insert(ssrc);\n\t\ts.insert(sdest);\n\t\tfor(int i=0;i<n;i++)\n\t\t{\n\t\t\tcin>>a[i]>>b[i]>>des[i];\n\t\t\ts.insert(a[i]);\n\t\t\ts.insert(b[i]);\n\t\t}\n\t\tint num=0;\n\t\tfor(it=s.begin();it!=s.end();it++)\n\t\t{\n\t\t\tmp[*it]=num;\n\t\t\tnum++;\n\t\t}\n\t\tfor(int i=0;i<n;i++)\n\t\t{\n\t\t\tp[mp[a[i]]].push_back(node(mp[b[i]],des[i]));\n\t\t\tp[mp[b[i]]].push_back(node(mp[a[i]],des[i]));\n\t\t}\n\t\tfor(int i=0;i<m;i++)\n\t\t{\n\t\t\tcin>>ss;\n\t\t\tflag[mp[ss]]=1;\n\t\t}\n\t//\tfor(int i=0;i<num;i++)printf(\"%d\\n\",flag[i]);\n     \tsrc=mp[ssrc];\n    \tdest=mp[sdest];\n    \t\n    \t\n    \t\n    \tfor(int i=0;i<num;i++)\n    \t{\n    \t\tfor(int j=0;j<=cap;j++)\n    \t\tdist[i][j]=inf;\n    \t}\n    \tdist[src]=0;\n    \tnode1 now,then;\n    \tnow.go=cap;\n    \tnow.node=src;\n    \tq.push(now);\n    \twhile(!q.empty())\n    \t{\n    \t\tnow=q.front();\n    \t\tq.pop();\n    \t\tinq[now.node]=0;\n    \t\tthen.go=now.go;\n    \t\tif(flag[now.node]==1)\n    \t\t{\n    \t\t\tthen.go=cap;\n    \t\t}\n    \t\tfor(int i=0;i<p[now.node].size();i++)\n    \t\t{\n    \t\t\tint d=p[now][i].dis;\n    \t\t\tint t=p[now][j].t;\n    \t\t\tif(then.go>d&&dis[t][then.go-d]>dis[now.node][now.go]+d)\n    \t\t\t{\n    \t\t\t\t\n    \t\t\t}\n    \t\t}\n    \t}\n    \t\n    \t\n    \t\n    \t\n    \t\n    \t\n    \t\n    \t\n    \t\n    \t\n    \t\n\t}\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\nint main(void){\n\tint n,mon,day,hour,min,x,num;\n\tint bm,bd,time,ot[1000][1500],it[1000][1500],sw[1000],tl[1000],ans,i,j,k,io,gio; \n\twhile(1){\n\t\tscanf(\"%d\",&n);\n\t\tif(n==0){\n\t\t\tbreak;\n\t\t}\n\t\tfor(i=0;i<1000;i++){\n\t\t\tsw[i]=tl[i]=0;\n\t\t\tfor(j=0;j<1500;j++){\n\t\t\t\tot[i][j]=it[i][j]=0;\n\t\t\t}\n\t\t}\n\t\ti=bm=bd=ans=0;\n\t\twhile(1){\n\t\t\tscanf(\"%d/%d %d:%d %c %d\",&mon,&day,&hour,&min,&x,&num);\n\t\t\tif(i==0){\n\t\t\t\tbm=mon;\n\t\t\t\tbd=day;\n\t\t\t}\n\t\t\ti++;\n\t\t\tif(bm!=mon||bd!=day||i==n){\n\t\t\t\tfor(j=1;j<1000;j++){\n\t\t\t\t\tif(sw[j]==0){\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tsw[j]=io=gio=0;\n\t\t\t\t\tfor(time=0;time<1500;time++){\n\t\t\t\t\t\tif(it[j][time]==1){\n\t\t\t\t\t\t\tio=1;\n\t\t\t\t\t\t\tit[j][time]=0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ot[j][time]==1){\n\t\t\t\t\t\t\tio=0;\n\t\t\t\t\t\t\tot[j][time]=0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(it[0][time]==1){\n\t\t\t\t\t\t\tgio=1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ot[0][time]==1){\n\t\t\t\t\t\t\tgio=0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(io==1&&gio==1){\n\t\t\t\t\t\t\ttl[j]++;\n\t\t\t\t\t\t\tif(tl[j]>ans){\n\t\t\t\t\t\t\t\tans=tl[j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(time=0;time<1500;time++){\n\t\t\t\t\tit[0][time]=ot[0][time]=0;\n\t\t\t\t}\n\t\t\t\tbm=mon;\n\t\t\t\tbd=day;\n\t\t\t}\n\t\t\tif(i==n){\n\t\t\t    break;\n\t\t\t}\n\t\t\tif(x=='I'){\n\t\t\t\tit[num][hour*60+min]=1;\n\t\t\t\tsw[num]=1;\n\t\t\t}\n\t\t\telse if(x=='O'){\n\t\t\t\tot[num][hour*60+min]=1;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#define ma(a,b)(a>b?a:b)\nT[1000],X[1000],q,n,A,a,B,b,h,m,p;N(){if(~T[0])for(q=1;q<1000;q++)if(~T[q])X[q]+=1440-ma(T[q],T[0]),T[q]=-1;T[0]=-1;}\nmain(){for(;scanf(\"%d\",&n),n;printf(\"%d\\n\",m)){\n\tfor(memset(T,0xff,4000),memset(X,0,4000),A=0;n--;){\n\t\tif(scanf(\"%d/%d%d:%d%s%d\",&a,&b,&h,&m,&p,&p),A-a||B-b)N(),A=a,B=b;\n\t\tif(h=h*60+m,~T[p]){\n\t\t\tif(p==0){for(q=1;q<1000;q++)if(~T[q])X[q]+=h-ma(T[q],T[0]);}\n\t\t\telse if(~T[0])X[p]+=h-ma(T[p],T[0]);\n\t\tT[p]=-1;}else T[p]=h;\n\t}for(N(),m=0,p=1;p<1000;p++)if(m<X[p])m=X[p];\n}exit(0);}"
  },
  {
    "language": "C",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nmap<string, int> dict; \nmap<string, int> enter;\n\nint main()\n{\n    //freopen(\"input.txt\", \"r\" ,stdin);\n    int n;\n    while (scanf(\"%d\", &n)==1)\n    {\n        dict.clear();\n        enter.clear();\n        int m, d, hours, minutes;\n        char str[100];\n        char flag[100];\n        for (int i=1; i<=n; i++)\n        {\n            scanf(\"%d/%d\", &m, &d);\n            scanf(\"%d:%d\", &hours, &minutes);\n            scanf(\"%s%s\", flag, str);\n\n            //printf(\"%d %d %d %d %s %s\\n\", m, d, hours, minutes, flag, str);\n            if (flag[0] == 'I')\n            {\n                if (string(str) == \"000\")\n                {\n                    enter[\"000\"] = hours*60+minutes;\n                    for (map<string, int>::iterator ite = enter.begin(); ite!=enter.end(); ite++)\n                        if (ite->second!=0)\n                            ite->second = hours*60+minutes;\n                }\n                else\n                    enter[string(str)] = hours*60+minutes;\n            }\n            else\n            {\n                if (string(str) != \"000\")\n                {\n                    if (enter[\"000\"])\n                        dict[string(str)] += hours*60+minutes - enter[string(str)];\n                    enter[string(str)] = 0;\n                }\n                else\n                {\n                    for (map<string, int>::iterator ite = enter.begin(); ite!=enter.end(); ite++)\n                    {\n                        if (ite->first!=\"000\"&& ite->second!=0)\n                        {\n                            dict[ite->first] += hours*60+minutes - ite->second;\n                            ite->second = hours*60+minutes;\n                        }\n                    }\n                    enter[\"000\"] = 0;\n                }\n            }\n        }\n        int ans = 0;\n        for (map<string, int>::iterator ite = dict.begin(); ite!=dict.end(); ite++)\n        {\n            //printf(\"%s %d\\n\", ite->first.c_str(), ite->second);\n            ans = max(ans, ite->second);\n        }\n        printf(\"%d\\n\", ans);\n    }\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <iostream>\n#include <algorithm>\n#include <string.h>\n#include <map>\n#include <vector>\n#include <cmath>\n#include <queue>\nusing namespace std;\nint get(int hour,int mi)\n{\n\treturn hour*60+mi;\n}\nint main()\n{\n    int n;\n    while(scanf(\"%d\",&n),n)\n    {\n    \tint mon,day,hour,mi,ans=0,per,maxn=0;\n    \tint now;\n    \tint visit[10000];\n    \tint getin[10000];\n    \tint getou[10000];\n    \tint fin[10000];\n    \tchar s[10];\n \t\tmemset(visit,0,sizeof(visit));\n \t\tmemset(fin,0,sizeof(fin));\n        for(int i=1;i<=n;i++)\n        {\n          scanf(\"%d/%d %d:%d%s%d\",&mon,&day,&hour,&mi,s,&per);\n \t\t  now=get(hour,mi);\n \t\t  maxn=max(maxn,per);\n \t\t  if(s[0]=='I'&&per!=0)\n \t\t  {\n             getin[per]=now;\n             visit[per]=1;\n \t\t  }\n \t\t  else if(s[0]=='O'&&per!=0)\n \t\t  {\n \t\t  \tvisit[per]=0;\n \t\t  \tif(visit[0])\n \t\t  \t\tfin[per]+=now-max(getin[0],getin[per]);\n \t\t  }\n \t\t  else if(s[0]=='I'&&per==0)\n \t\t  {\n               visit[0]=1;\n               getin[0]=now;\n \t\t  }\n \t\t  else\n \t\t  {\n              visit[0]=0;\n              for(int i=1;i<=maxn;i++)\n              \tif(visit[i])\n              \t\tfin[i]+=now-max(getin[0],getin[i]);\n \t\t  }\n        }\n        ans=0;\n        for(int i=1;i<=maxn;i++)\n        \tans=max(ans,fin[i]);\n        printf(\"%d\\n\",ans);\n    }\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\nint main(void){\n\tint n,mon,day,hour,min,x,num;\n\tint bm,bd,time,ot[1000][1500],it[1000][1500],sw[1000],tl[1000],ans,i,j,k,io,gio; \n\twhile(1){\n\t\tscanf(\"%d\",&n);\n\t\tif(n==0){\n\t\t\tbreak;\n\t\t}\n\t\tfor(i=0;i<1000;i++){\n\t\t\tsw[i]=tl[i]=0;\n\t\t\tfor(j=0;j<1500;j++){\n\t\t\t\tot[i][j]=it[i][j]=0;\n\t\t\t}\n\t\t}\n\t\ti=bm=bd=ans=0;\n\t\twhile(1){\n\t\t\tscanf(\"%d/%d %d:%d %c %d\",&mon,&day,&hour,&min,&x,&num);\n\t\t\tif(i==0){\n\t\t\t\tbm=mon;\n\t\t\t\tbd=day;\n\t\t\t}\n\t\t\ti++;\n\t\t\tif(bm!=mon||bd!=day||i==n){\n\t\t\t\tfor(j=1;j<1000;j++){\n\t\t\t\t\tif(sw[j]==0){\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tsw[j]=io=gio=0;\n\t\t\t\t\tfor(time=0;time<1500;time++){\n\t\t\t\t\t\tif(it[j][time]==1){\n\t\t\t\t\t\t\tio=1;\n\t\t\t\t\t\t\tit[j][time]=0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ot[j][time]==1){\n\t\t\t\t\t\t\tio=0;\n\t\t\t\t\t\t\tot[j][time]=0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(it[0][time]==1){\n\t\t\t\t\t\t\tgio=1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ot[0][time]==1){\n\t\t\t\t\t\t\tgio=0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(io==1&&gio==1){\n\t\t\t\t\t\t\ttl[j]++;\n\t\t\t\t\t\t\tif(tl[j]>ans){\n\t\t\t\t\t\t\t\tans=tl[j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(time=0;time<1500;time++){\n\t\t\t\t\tit[0][time]=ot[0][time]=0;\n\t\t\t\t}\n\t\t\t\tbm=mon;\n\t\t\t\tbd=day;\n\t\t\t}\n\t\t\tif(i==n){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(x=='I'){\n\t\t\t\tit[num][hour*60+min]=1;\n\t\t\t\tsw[num]=1;\n\t\t\t}\n\t\t\telse if(x=='O'){\n\t\t\t\tot[num][hour*60+min]=1;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "// AOJ 1315: Gift from the Goddess of Programming\n// 2017.10.4 bal4u@uu\n\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n\n#define MAX(a,b) ((a)>=(b)?(a):(b))\n\nint tm[1002], s[1002];\nchar in[1002];\n\nint main()\n{\n\tint n, i, hh, mm, t, p, max, ans;\n\tchar date[10], time[10], e[5];\n\n\twhile (scanf(\"%d\", &n) && n > 0) {\n\t\tmax = 0; memset(in, 0, sizeof(in)), memset(s, 0, sizeof(s));\n\t\twhile (n-- > 0) {\n\t\t\tscanf(\"%s%s%s%d\", date, time, e, &p);\n\t\t\thh = atoi(time), mm = atoi(time+3);\n\t\t\tt = hh*60 + mm;\n\t\t\tif (*e == 'I') tm[p] = t, in[p] = 1;\n\t\t\telse {\n\t\t\t\tin[p] = 0;\n\t\t\t\tif (p == 0) {\n\t\t\t\t\tfor (i = 1; i <= max; i++) {\n\t\t\t\t\t\tif (in[i]) s[i] += t - MAX(tm[0], tm[i]);\n\t\t\t\t\t}\n\t\t\t\t} else if (in[0]) s[p] += t - MAX(tm[0], tm[p]);\n\t\t\t}\n\t\t\tif (p > max) max = p;\n\t\t}\n\t\tfor (ans = 0, i = 1; i <= max; i++) if (s[i] > ans) ans = s[i];\n\t\tprintf(\"%d\\n\", ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <limits.h>\n#define init(A,B) { int i; for(i=0; i<B; i++) A[i]=0; }\n\nstruct data{ int time; char type; int ID; };\n\nint main(void){\n\tint N;\n\t\n\twhile(scanf(\"%d\\n\",&N), N!=0){\n\t\tint i, j=0, k, t[4], max=0, presence[1000], time[1000]; struct data dat[N];\n\t\tinit(presence,1000); init(time,1000);\n\t\t\n\t\tfor(i=0; i<N; i++){\n\t\t\tscanf(\"%2d/%2d %2d:%2d %c %3d\\n\",&t[0],&t[1],&t[2],&t[3],&dat[i].type,&dat[i].ID);\n\t\t\tdat[i].time=t[3]+60*(t[2]+24*(t[1]+31*t[0]));\n\t\t}\n\t\t\n\t\tfor(i=dat[0].time; i<=dat[N-1].time; i++){\n\t\t\tif(dat[j].time==i && j<N){\n\t\t\t\twhile(dat[j].time==i){\n\t\t\t\t\tif(dat[j].type=='I') presence[dat[j].ID]=1;\n\t\t\t\t\telse presence[dat[j].ID]=0;\n\t\t\t\t\tj++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(presence[0]==1) for(k=1; k<100; k++) time[k]+=presence[k];\n\t\t}\n\t\t\n\t\tfor(i=1; i<100; i++) if(max<time[i]) max=time[i];\n\t\t\n\t\tprintf(\"%d\\n\",max);\n\t}\n}"
  },
  {
    "language": "C",
    "code": "#define M(a,b)(a>b?a:b)\nT[999],X[999],q,n,A,a,B,b,h,m,p;N(){if(~T[0])for(q=1;q<999;q++)if(~T[q])X[q]+=1440-M(T[q],T[0]),T[q]=-1;T[0]=-1;}main(){for(;scanf(\"%d\",&n),n;printf(\"%d\\n\",m)){for(memset(T,0xff,3996),memset(X,0,3996),A=0;n--;){if(scanf(\"%d/%d%d:%d%s%d\",&a,&b,&h,&m,&p,&p),A-a||B-b)N(),A=a,B=b;if(h=h*60+m,~T[p]){if(p==0){for(q=1;q<999;q++)if(~T[q])X[q]+=h-M(T[q],T[0]);}else if(~T[0])X[p]+=h-M(T[p],T[0]);T[p]=-1;}else T[p]=h;}for(N(),m=0,p=1;p<999;p++)m=M(m,X[p]);}exit(0);}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#include<string.h>\n#include<time.h>\n\ntypedef struct U\n{\n\ttm L;\n\tint F,t;\n}U;\n\ntm set(int M,int D,int h,int m)\n{\n\ttm t={0,m,h,D,M,100,0};\n\treturn t;\n}\n\nint N,i,j,G,M,D,h,m,u,R;\nU X[1000];\n\nint main()\n{\n\tchar f;\n\tfor(;scanf(\"%d\\n\",&N),N;)\n\t{\n\t\tG=0;\n\t\tmemset(X,0,sizeof(X));\n\t\tfor(i=0;i<N;i++)\n\t\t{\n\t\t\tscanf(\"%2d/%2d%2d:%2d%*c%[IO]%d\",&M,&D,&h,&m,&f,&u);\n\t\t\ttm tmp1=set(M,D,h,m);\n\t\t\ttime_t tmp=mktime(&tmp1);\n\t\t\tif(f=='I')\n\t\t\t{\n\t\t\t\tif(u==0)\n\t\t\t\t\tG=1;\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tX[u].F=1;\n\t\t\t\t}\n\t\t\t\tX[u].L=tmp1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(u==0)\n\t\t\t\t{\n\t\t\t\t\t\n\t\t\t\t\tfor(j=1;j<1000;j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(X[j].F==1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlong long aaa=mktime(&X[0].L);\n\t\t\t\t\t\t\tlong long  bbb=mktime(&X[j].L);\n\t\t\t\t\t\t\tdouble eee=difftime(tmp,aaa)/60;\n\t\t\t\t\t\t\tdouble fff=difftime(tmp,bbb)/60;\n\t\t\t\t\t\t\tX[j].t+=fff<eee?fff:eee;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tG=0;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif(G==1)\n\t\t\t\t\t{\n\t\t\t\t\t\tlong long aaa=mktime(&X[0].L);\n\t\t\t\t\t\tlong long  bbb=mktime(&X[u].L);\n\t\t\t\t\t\tdouble eee=difftime(tmp,aaa)/60;\n\t\t\t\t\t\tdouble fff=difftime(tmp,bbb)/60;\n\t\t\t\t\t\tX[u].t+=fff<eee?fff:eee;\n\t\t\t\t\t}\n\t\t\t\t\tX[u].F=0;\n\t\t\t\t\tX[u].L=tmp1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(i=1,R=0;i<1000;i++)\n\t\t\tR=R<X[i].t?X[i].t:R;\n\t\tprintf(\"%d\\n\",R);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n\nint main(void) {\n\tint n;\n\tint i,j;\n\tint times[1000];\n\tint last[1000];\n\tint now[1000];\n\tint month,day,hour,minute;\n\tchar io[4];\n\tint id;\n\tint now_time;\n\tint max;\n\twhile(1) {\n\t\tscanf(\"%d\",&n);\n\t\tif(n==0)break;\n\t\tmemset(times,0,sizeof(times));\n\t\tmemset(last,0,sizeof(last));\n\t\tmemset(now,0,sizeof(now));\n\t\tfor(i=0;i<n;i++) {\n\t\t\tscanf(\"%d/%d %d:%d %s %d\",\n\t\t\t\t&month,&day,&hour,&minute,io,&id);\n\t\t\tnow_time=hour*60+minute;\n\t\t\tif(io[0]=='I') {\n\t\t\t\tnow[id]=1;\n\t\t\t} else {\n\t\t\t\tif(id==0) {\n\t\t\t\t\tfor(j=1;j<1000;j++) {\n\t\t\t\t\t\tif(now[j]) {\n\t\t\t\t\t\t\ttimes[j]+=now_time-\n\t\t\t\t\t\t\t\t(last[0]>last[j]?last[0]:last[j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif(now[0]) {\n\t\t\t\t\t\ttimes[id]+=now_time-\n\t\t\t\t\t\t\t(last[0]>last[id]?last[0]:last[id]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnow[id]=0;\n\t\t\t}\n\t\t\tlast[id]=now_time;\n\t\t}\n\t\tmax=0;\n\t\tfor(i=1;i<1000;i++) {\n\t\t\tif(times[i]>max)max=times[i];\n\t\t}\n\t\tprintf(\"%d\\n\",max);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.*;\nimport java.util.Calendar.Builder;\n\n\n\npublic class Main {\n\tstatic int INF = 2 << 27;\n\tpublic static void main(String[] args) {\t\n\t\t//FastScanner sc = new FastScanner();\n\t\tScanner sc = new Scanner(System.in);\n\t\tPrintWriter out = new PrintWriter(System.out);\n\t\twhile(true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n == 0) break;\n\t\t\tArrayList<ArrayList<Calendar>> list = new ArrayList<ArrayList<Calendar>>();\n\t\t\tfor(int i = 0; i < 1000; i++) list.add(new ArrayList<Calendar>());\n\t\t\tfor(int i = 0; i < n; i++) {\n\t\t\t\tString MMDD = sc.next();\n\t\t\t\tint M = Integer.parseInt(MMDD.substring(0, 2));\n\t\t\t\tint D = Integer.parseInt(MMDD.substring(3, 5));\n\t\t\t\n\t\t\t\tString HHMM = sc.next();\n\t\t\t\tint H = Integer.parseInt(HHMM.substring(0, 2));\n\t\t\t\tint Min = Integer.parseInt(HHMM.substring(3, 5));\n\t\t\t\n\t\t\t\tsc.next();\n\t\t\t\n\t\t\t\tint ID = Integer.parseInt(sc.next());\n\t\t\t\t\n\t\t\t\tBuilder c = new Calendar.Builder();\n\t\t\t\tCalendar cc = c.build();\n\t\t\t\tcc.set(1980, M, D, H, Min, 0);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tlist.get(ID).add(cc);\n\t\t\t}\n\t\t\tint[] sum = new int[1000];\n\t\t\tArrayList<Calendar> lg = list.get(0);\n\t\t\tfor(int i = 1; i < list.size(); i++) {\n\t\t\t\tArrayList<Calendar> lng = list.get(i);\n\t\t\t\tfor(int j = 0; j < lg.size(); j += 2) {\n\t\t\t\t\tfor(int k = 0; k < lng.size(); k += 2) {\n\t\t\t\t\t\t long gA = lg.get(j).getTimeInMillis();\n\t\t\t\t\t\t long gB = lg.get(j+1).getTimeInMillis();\n\t\t\t\t\t\t\n\t\t\t\t\t\t long ngA = lng.get(k).getTimeInMillis();\n\t\t\t\t\t\t long ngB = lng.get(k+1).getTimeInMillis();\n\t\t\t\t\t\t \n\t\t\t\t\t\t long gb = Math.max(gA, ngA);\n\t\t\t\t\t\t long ngb = Math.min(gB,ngB);\n\t\t\t\t\t\t \n\t\t\t\t\t\t sum[i] += Math.max(0, ngb - gb);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\tint MAX = 0;\n\t\t\tfor(int i = 1; i < 1000; i++) {\n\t\t\t\tMAX = Math.max(MAX, sum[i]);\n\t\t\t}\n\t\t\tSystem.out.println(MAX / 60000);\n\t\t}\n\t}\n\tstatic class Data implements Comparable<Data> {\n\t\tint ID;\n\t\tlong In;\n\t\tlong Out;\n\t\tData(int id, long a, long b) {\n\t\t\tID = id;\n\t\t\tIn = a;\n\t\t\tOut = b;\n\t\t}\n\t\t@Override\n\t\tpublic int compareTo(Data o) {\n\t\t\tif(this.In == o.In) {\n\t\t\t\tif(this.Out == o.Out) return this.ID - o.ID;\n\t\t\t\treturn (int)(this.Out - o.Out);\n\t\t\t}\n\t\t\treturn (int)(this.In - o.In);\n\t\t\t\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.HashMap;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.LinkedList;\nimport java.util.PriorityQueue;\nimport java.util.Scanner;\n\npublic class Main {\n\t\n\tpublic static final int ID_MAX = 1000;\n\t\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\n\t\twhile(true){\n\t\t\tfinal int n = sc.nextInt();\n\t\t\t\n\t\t\tif(n == 0){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tString prev_day = \"\";\n\t\t\tboolean[] is_in = new boolean[ID_MAX];\n\t\t\tint[] in_time = new int[ID_MAX];\n\t\t\tint[] bless_time = new int[ID_MAX];\n\t\t\t\n\t\t\tfor(int q = 0; q < n; q++){\n\t\t\t\tfinal String day = sc.next();\n\t\t\t\t\n\t\t\t\tif(!prev_day.equals(day)){\n\t\t\t\t\tprev_day = day;\n\t\t\t\t\t\n\t\t\t\t\tArrays.fill(is_in, false);\n\t\t\t\t\tArrays.fill(in_time, Integer.MAX_VALUE);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tString time_str[] = sc.next().split(\":\");\n\t\t\t\tfinal int time = Integer.parseInt(time_str[0]) * 60 + Integer.parseInt(time_str[1]);\n\t\t\t\t\n\t\t\t\tboolean in = sc.next().equals(\"I\");\n\t\t\t\t\n\t\t\t\tfinal int id = sc.nextInt();\n\t\t\t\t\n\t\t\t\tif(id == 0){\n\t\t\t\t\tif(in){\n\t\t\t\t\t\tis_in[id] = true;\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor(int i = 0; i < ID_MAX; i++){\n\t\t\t\t\t\t\tif(is_in[i]){\n\t\t\t\t\t\t\t\tin_time[i] = time;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tis_in[id] = false;\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor(int i = 0; i < ID_MAX; i++){\n\t\t\t\t\t\t\tif(is_in[i]){\n\t\t\t\t\t\t\t\t bless_time[i] += time - in_time[i];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tif(in){\n\t\t\t\t\t\tis_in[id] = true;\n\t\t\t\t\t\tin_time[id] = time; \n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(is_in[0]){\n\t\t\t\t\t\t\tbless_time[id] += time - in_time[id];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tis_in[id] = false;\n\t\t\t\t\t\tin_time[id] = Integer.MAX_VALUE;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint max_time = 0;\n\t\t\tfor(int i = 0; i < ID_MAX; i++){\n\t\t\t\tmax_time = Math.max(max_time, bless_time[i]);\n\t\t\t}\n\t\t\tSystem.out.println(max_time);\n\t\t\t\n\t\t}\n\t\t\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.HashMap;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.LinkedList;\nimport java.util.PriorityQueue;\nimport java.util.Scanner;\n\npublic class Main {\n\t\n\tpublic static final int ID_MAX = 1000;\n\t\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\n\t\twhile(true){\n\t\t\tfinal int n = sc.nextInt();\n\t\t\t\n\t\t\tif(n == 0){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tString prev_day = \"\";\n\t\t\tboolean[] is_in = new boolean[ID_MAX];\n\t\t\tint[] in_time = new int[ID_MAX];\n\t\t\tint[] bless_time = new int[ID_MAX];\n\t\t\t\n\t\t\tfor(int q = 0; q < n; q++){\n\t\t\t\tfinal String day = sc.next();\n\t\t\t\t\n\t\t\t\tif(!prev_day.equals(day)){\n\t\t\t\t\tprev_day = day;\n\t\t\t\t\tArrays.fill(is_in, false);\n\t\t\t\t\tArrays.fill(in_time, Integer.MAX_VALUE);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tString time_str[] = sc.next().split(\":\");\n\t\t\t\tfinal int time = Integer.parseInt(time_str[0]) * 60 + Integer.parseInt(time_str[1]);\n\t\t\t\t\n\t\t\t\tboolean in = sc.next().equals(\"I\");\n\t\t\t\t\n\t\t\t\tfinal int id = sc.nextInt();\n\t\t\t\t\n\t\t\t\tif(id == 0){\n\t\t\t\t\tif(in){\n\t\t\t\t\t\tis_in[id] = true;\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor(int i = 0; i < ID_MAX; i++){\n\t\t\t\t\t\t\tif(is_in[i]){\n\t\t\t\t\t\t\t\tin_time[i] = time;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tis_in[id] = false;\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor(int i = 0; i < ID_MAX; i++){\n\t\t\t\t\t\t\tif(is_in[i]){\n\t\t\t\t\t\t\t\t bless_time[i] += time - in_time[i];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tif(in){\n\t\t\t\t\t\tis_in[id] = true;\n\t\t\t\t\t\tin_time[id] = time; \n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(is_in[0]){\n\t\t\t\t\t\t\tbless_time[id] = time - in_time[id];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tis_in[id] = false;\n\t\t\t\t\t\tin_time[id] = Integer.MAX_VALUE;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint max_time = 0;\n\t\t\tfor(int i = 0; i < ID_MAX; i++){\n\t\t\t\tmax_time = Math.max(max_time, bless_time[i]);\n\t\t\t}\n\t\t\tSystem.out.println(max_time);\n\t\t\t\n\t\t}\n\t\t\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\n//Gift from the Goddess of Programming\npublic class Main{\n\n\tvoid run(){\n\t\tScanner sc = new Scanner(System.in);\n\t\tfor(;;){\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n==0)break;\n\t\t\tint[] s = new int[1000], in = new int[1000];\n\t\t\tboolean[] f = new boolean[1000];\n\t\t\twhile(n--!=0){\n\t\t\t\tsc.next();\n\t\t\t\tString[] t = sc.next().split(\":\");\n\t\t\t\tint time = Integer.parseInt(t[0])*60+Integer.parseInt(t[1]);\n\t\t\t\tboolean I = \"I\".equals(sc.next());\n\t\t\t\tint id = sc.nextInt();\n\t\t\t\tif(I){\n\t\t\t\t\tf[id] = true; in[id] = time;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tf[id] = false;\n\t\t\t\t\tif(id==0){\n\t\t\t\t\t\tfor(int i=1;i<1000;i++)if(f[i])s[i]+=time-Math.max(in[0], in[i]);\n\t\t\t\t\t}\n\t\t\t\t\telse if(f[0])s[id]+=time-Math.max(in[0], in[id]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tfor(int i=1;i<1000;i++)res=Math.max(res, s[i]);\n\t\t\tSystem.out.println(res);\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.*;\nimport java.util.Calendar.Builder;\n\n\n\npublic class Main {\n\tstatic int INF = 2 << 27;\n\tpublic static void main(String[] args) {\t\n\t\t//FastScanner sc = new FastScanner();\n\t\tScanner sc = new Scanner(System.in);\n\t\tPrintWriter out = new PrintWriter(System.out);\n\t\twhile(true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n == 0) break;\n\t\t\tArrayList<ArrayList<Calendar>> list = new ArrayList<ArrayList<Calendar>>();\n\t\t\tfor(int i = 0; i < 1000; i++) list.add(new ArrayList<Calendar>());\n\t\t\tfor(int i = 0; i < n; i++) {\n\t\t\t\tString MMDD = sc.next();\n\t\t\t\tint M = Integer.parseInt(MMDD.substring(0, 2));\n\t\t\t\tint D = Integer.parseInt(MMDD.substring(3, 5));\n\t\t\t\n\t\t\t\tString HHMM = sc.next();\n\t\t\t\tint H = Integer.parseInt(HHMM.substring(0, 2));\n\t\t\t\tint Min = Integer.parseInt(HHMM.substring(3, 5));\n\t\t\t\n\t\t\t\tsc.next();\n\t\t\t\n\t\t\t\tint ID = Integer.parseInt(sc.next());\n\t\t\t\t\n\t\t\t\tBuilder c = new Calendar.Builder();\n\t\t\t\tCalendar cc = c.build();\n\t\t\t\tcc.set(2000, M, D, H, Min, 0);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tlist.get(ID).add(cc);\n\t\t\t}\n\t\t\tPriorityQueue<Data> q = new PriorityQueue<Data>();\n\t\t\tint[] sum = new int[1000];\n\t\t\tData[] state = new Data[1000];\n\t\t\tfor(int i = 0; i < list.size(); i++) {\n\t\t\t\tArrayList<Calendar> l = list.get(i);\n\t\t\t\tfor(int j = 0; j < l.size(); j += 2) {\n\t\t\t\t\tCalendar a = l.get(j);\n\t\t\t\t\tCalendar b = l.get(j+1);\n\t\t\t\t\tDate aa = a.getTime();\n\t\t\t\t\tDate bb = b.getTime();\n\t\t\t\t\tq.add(new Data(i,aa.getTime(),bb.getTime()));\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile(!q.isEmpty()) {\n\t\t\t\tData tmp = q.poll();\n\t\t\t\tfor(int i = 0; i < state.length; i++) {\n\t\t\t\t\tif(state[i] != null) {\n\t\t\t\t\t\tif(state[i].Out <= tmp.In) state[i] = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstate[tmp.ID] = tmp;\n\t\t\t\tif(tmp.ID == 0) {\n\t\t\t\t\tfor(int i = 0; i < state.length; i++) {\n\t\t\t\t\t\tif(state[i] == null) continue;\n\t\t\t\t\t\tint stA = (int)state[i].In;\n\t\t\t\t\t\tint enA = (int)state[i].Out;\n\t\t\t\t\t\tint stB = (int)state[0].In;\n\t\t\t\t\t\tint enB = (int)state[0].Out;\n\t\t\t\t\t\tstA = Math.max(stA, stB);\n\t\t\t\t\t\tenA = Math.min(enA, enB);\n\t\t\t\t\t\tif(stA < enA) {\n\t\t\t\t\t\t\tsum[i] += (enA - stA) / 60000;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tint MAX = 0;\n\t\t\tfor(int i = 1; i < 1000; i++) {\n\t\t\t\tMAX = Math.max(MAX, sum[i]);\n\t\t\t}\n\t\t\tSystem.out.println(MAX);\n\t\t\t\n\t\t\t\n\t\t}\n\t}\n\tstatic class Data implements Comparable<Data> {\n\t\tint ID;\n\t\tlong In;\n\t\tlong Out;\n\t\tData(int id, long a, long b) {\n\t\t\tID = id;\n\t\t\tIn = a;\n\t\t\tOut = b;\n\t\t}\n\t\t@Override\n\t\tpublic int compareTo(Data o) {\n\t\t\tif(this.In == o.In) {\n\t\t\t\tif(this.Out == o.Out) return this.ID - o.ID;\n\t\t\t\treturn (int)(this.Out - o.Out);\n\t\t\t}\n\t\t\treturn (int)(this.In - o.In);\n\t\t\t\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.*;\nimport java.util.Calendar.Builder;\n\n\n\npublic class Main {\n\tstatic int INF = 2 << 27;\n\tpublic static void main(String[] args) {\t\n\t\t//FastScanner sc = new FastScanner();\n\t\tScanner sc = new Scanner(System.in);\n\t\tPrintWriter out = new PrintWriter(System.out);\n\t\twhile(true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n == 0) break;\n\t\t\tArrayList<ArrayList<Calendar>> list = new ArrayList<ArrayList<Calendar>>();\n\t\t\tfor(int i = 0; i < 1000; i++) list.add(new ArrayList<Calendar>());\n\t\t\tfor(int i = 0; i < n; i++) {\n\t\t\t\tString MMDD = sc.next();\n\t\t\t\tint M = Integer.parseInt(MMDD.substring(0, 2));\n\t\t\t\tint D = Integer.parseInt(MMDD.substring(3, 5));\n\t\t\t\n\t\t\t\tString HHMM = sc.next();\n\t\t\t\tint H = Integer.parseInt(HHMM.substring(0, 2));\n\t\t\t\tint Min = Integer.parseInt(HHMM.substring(3, 5));\n\t\t\t\n\t\t\t\tsc.next();\n\t\t\t\n\t\t\t\tint ID = Integer.parseInt(sc.next());\n\t\t\t\t\n\t\t\t\tBuilder c = new Calendar.Builder();\n\t\t\t\tCalendar cc = c.build();\n\t\t\t\tcc.set(2000, M, D, H, Min, 0);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tlist.get(ID).add(cc);\n\t\t\t}\n\t\t\tPriorityQueue<Data> q = new PriorityQueue<Data>();\n\t\t\tint[] sum = new int[1000];\n\t\t\tData[] state = new Data[1000];\n\t\t\tfor(int i = 0; i < list.size(); i++) {\n\t\t\t\tArrayList<Calendar> l = list.get(i);\n\t\t\t\tfor(int j = 0; j < l.size(); j += 2) {\n\t\t\t\t\tCalendar a = l.get(j);\n\t\t\t\t\tCalendar b = l.get(j+1);\n\t\t\t\t\tDate aa = a.getTime();\n\t\t\t\t\tDate bb = b.getTime();\n\t\t\t\t\tq.add(new Data(i,aa.getTime(),bb.getTime()));\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile(!q.isEmpty()) {\n\t\t\t\tData tmp = q.poll();\n\t\t\t\t//System.out.println(tmp.ID + \" \" + (tmp.In)/60000 + \" \" + tmp.Out/60000);\n\t\t\t\tfor(int i = 0; i < state.length; i++) {\n\t\t\t\t\tif(state[i] != null) {\n\t\t\t\t\t\tif(state[i].Out <= tmp.In) state[i] = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstate[tmp.ID] = tmp;\n\t\t\t\tif(tmp.ID == 0) {\n\t\t\t\t\tfor(int i = 0; i < state.length; i++) {\n\t\t\t\t\t\tif(state[i] == null) continue;\n\t\t\t\t\t\tint stA = (int)state[i].In;\n\t\t\t\t\t\tint enA = (int)state[i].Out;\n\t\t\t\t\t\tint stB = (int)state[0].In;\n\t\t\t\t\t\tint enB = (int)state[0].Out;\n\t\t\t\t\t\tstA = Math.max(stA, stB);\n\t\t\t\t\t\tenA = Math.min(enA, enB);\n\t\t\t\t\t\tif(stA < enA) {\n\t\t\t\t\t\t\tsum[i] += (enA - stA) / 60000;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(state[0] != null){\n\t\t\t\t\tint stA = (int)state[tmp.ID].In;\n\t\t\t\t\tint enA = (int)state[tmp.ID].Out;\n\t\t\t\t\tint stB = (int)state[0].In;\n\t\t\t\t\tint enB = (int)state[0].Out;\n\t\t\t\t\tstA = Math.max(stA, stB);\n\t\t\t\t\tenA = Math.min(enA, enB);\n\t\t\t\t\tif(stA < enA) {\n\t\t\t\t\t\tsum[tmp.ID] += (enA - stA) / 60000;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tint MAX = 0;\n\t\t\tfor(int i = 1; i < 1000; i++) {\n\t\t\t\tMAX = Math.max(MAX, sum[i]);\n\t\t\t}\n\t\t\tSystem.out.println(MAX);\n\t\t\t\n\t\t\t\n\t\t}\n\t}\n\tstatic class Data implements Comparable<Data> {\n\t\tint ID;\n\t\tlong In;\n\t\tlong Out;\n\t\tData(int id, long a, long b) {\n\t\t\tID = id;\n\t\t\tIn = a;\n\t\t\tOut = b;\n\t\t}\n\t\t@Override\n\t\tpublic int compareTo(Data o) {\n\t\t\tif(this.In == o.In) {\n\t\t\t\tif(this.Out == o.Out) return this.ID - o.ID;\n\t\t\t\treturn (int)(o.Out - this.Out);\n\t\t\t}\n\t\t\treturn (int)(this.In - o.In);\n\t\t\t\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.awt.geom.*;\npublic class Main {\n\n\tprivate void doit(){\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tint n = Integer.parseInt(sc.nextLine());\n\t\t\tif(n == 0) break;\n\t\t\tHashMap<String, Integer> log = new HashMap<String, Integer>();\n\t\t\tHashMap<String, Integer> record = new HashMap<String, Integer>();\n\t\t\tfor(int i = 0 ; i < n; i++){\n\t\t\t\tString s = sc.nextLine();\n\t\t\t\tString [] ss = s.split(\" \");\n\t\t\t\tString [] time = ss[1].split(\":\");\n\t\t\t\tint h = Integer.parseInt(time[0]);\n\t\t\t\tint m = Integer.parseInt(time[1]);\n\t\t\t\tint value = h * 60 + m;\n\t\t\t\tif(ss[2].equals(\"I\")){\n\t\t\t\t\trecord.put(ss[3], value);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tif(ss[3].equals(\"000\")){\n\t\t\t\t\t\tfor(String key: record.keySet()){\n\t\t\t\t\t\t\tif(key.equals(\"000\")) continue;\n\t\t\t\t\t\t\tint diff = value - Math.max(record.get(key), record.get(\"000\"));\n\t\t\t\t\t\t\t//System.out.println(\"diff = \" + diff);\n\t\t\t\t\t\t\tif(log.containsKey(key)){\n\t\t\t\t\t\t\t\tlog.put(key, log.get(key) + diff);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tlog.put(key, diff);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trecord.remove(ss[3]);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tif(record.containsKey(\"000\")){\n\t\t\t\t\t\t\tint diff = value - Math.max(record.get(ss[3]), record.get(\"000\"));\n\t\t\t\t\t\t\trecord.remove(ss[3]);\n\t\t\t\t\t\t\tif(log.containsKey(ss[3])){\n\t\t\t\t\t\t\t\tlog.put(ss[3], log.get(ss[3]) + diff);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tlog.put(ss[3], diff);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\trecord.remove(ss[3]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n//\t\t\t\tSystem.out.println(\"i = \" + i);\n//\t\t\t\tfor(String key: record.keySet()){\n//\t\t\t\t\tSystem.out.println(\"key = \" + key + \" value = \" + record.get(key));\n//\t\t\t\t}\n//\t\t\t\tSystem.out.println();\n//\t\t\t\tfor(String key : log.keySet()){\n//\t\t\t\t\tSystem.out.println(\"ley = \" + key + \"value = \" + log.get(key));\n//\t\t\t\t}\n//\t\t\t\tSystem.out.println(\"---\");\n\t\t\t}\n\t\t\tint max = 0;\n\t\t\tfor(String key: log.keySet()){\n\t\t\t\t//System.out.println(\"key = \" + key + \" value = \" + log.get(key));\n\t\t\t\tif(key.equals(\"000\")) continue;\n\t\t\t\tmax = Math.max(max, log.get(key));\n\t\t\t}\n\t\t\tSystem.out.println(max);\n\t\t}\n\t}\n\n\tpublic static void main(String [] args){\n\t\tnew Main().doit();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tif (n == 0)\n\t\t\t\tbreak;\n\t\t\tint[] etimes = new int[1000];\n\t\t\tint[] times = new int[1000];\n\t\t\tString currentDay = \"\";\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tString day = sc.next();\n\t\t\t\tString time = sc.next();\n\t\t\t\tchar io = sc.next().charAt(0);\n\t\t\t\tint id = sc.nextInt();\n\t\t\t\tif (!day.equals(currentDay)) {\n\t\t\t\t\tcurrentDay = day;\n\t\t\t\t\tfor (int j = 1; j < 1000; j++)\n\t\t\t\t\t\tif (etimes[i] != 0) {\n\t\t\t\t\t\t\tetimes[i] = 0;\n\t\t\t\t\t\t\tif (etimes[0] != 0)\n\t\t\t\t\t\t\t\tetimes[i] += 24 * 60 - 1 - etimes[i];\n\t\t\t\t\t\t}\n\t\t\t\t\tetimes[0] = 0;\n\t\t\t\t}\n\t\t\t\tif (io == 'I') {\n\t\t\t\t\tString[] s = time.split(\":\");\n\t\t\t\t\tint t = Integer.parseInt(s[0]) * 60\n\t\t\t\t\t\t\t+ Integer.parseInt(s[1]);\n\t\t\t\t\tetimes[id] = t;\n\t\t\t\t} else {\n\t\t\t\t\tString[] s = time.split(\":\");\n\t\t\t\t\tint otimes = Integer.parseInt(s[0]) * 60\n\t\t\t\t\t\t\t+ Integer.parseInt(s[1]);\n\t\t\t\t\tif (id == 0) {\n\t\t\t\t\t\tfor (int j = 1; j < 1000; j++)\n\t\t\t\t\t\t\tif (etimes[j] != 0)\n\t\t\t\t\t\t\t\ttimes[j] += otimes\n\t\t\t\t\t\t\t\t\t\t- Math.max(etimes[0], etimes[j]);\n\t\t\t\t\t} else if (etimes[0] != 0)\n\t\t\t\t\t\ttimes[id] += otimes - Math.max(etimes[0], etimes[id]);\n\t\t\t\t\tetimes[id] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tint result = 0;\n\t\t\tfor (int i = 1; i < 1000; i++) {\n\t\t\t\tresult = Math.max(result, times[i]);\n\t\t\t}\n\t\t\tSystem.out.println(result);\n\t\t}\n\t\tsc.close();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.*;\nimport java.io.*;\nimport static java.util.Arrays.*;\nimport static java.util.Collections.*;\nimport static java.lang.Math.*;\n\npublic class Main {\n\n\tint INF = 1 << 28;\n\t//long INF = 1L << 62;\n\tdouble EPS = 1e-10;\n\tint MAX = 1000;\n\t\n\tint[] month = {0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334};\n\t\n\tvoid run() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tfor(;;) {\n\t\t\tint n = sc.nextInt();sc.nextLine();\n\t\t\tif(n == 0) break;\n\t\t\tHashMap<Integer, Integer> map = new HashMap<Integer, Integer>();\n\t\t\tint[] ans = new int[MAX];\n\t\t\tfor(int i=0;i<n;i++) {\n\t\t\t\tString[] sp = sc.nextLine().split(\"[/ :]\");\n//\t\t\t\tdebug(sp);\n\t\t\t\t\n\t\t\t\tif(sp[4].equals(\"I\")) {\n\t\t\t\t\tint id = Integer.parseInt(sp[5]);\n\t\t\t\t\tint t = ( month[Integer.parseInt(sp[0])-1] + Integer.parseInt(sp[1]) ) * 24 * 60 + Integer.parseInt(sp[2]) * 60 + Integer.parseInt(sp[3]);\n\t\t\t\t\tmap.put(id, t );\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse {\n\t\t\t\t\tint id = Integer.parseInt(sp[5]);\n\t\t\t\t\tint t = ( month[Integer.parseInt(sp[0])-1] + Integer.parseInt(sp[1]) ) * 24 * 60 + Integer.parseInt(sp[2]) * 60 + Integer.parseInt(sp[3]);\n\t\t\t\t\tif(id == 0) {\n\t\t\t\t\t\tfor(Map.Entry<Integer, Integer> entry: map.entrySet()) if(entry.getKey() != 0){\n\t\t\t\t\t\t\tans[entry.getKey()] += t - max(map.get(id), map.get(entry.getKey()));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif(map.containsKey(0)) {\n\t\t\t\t\t\t\tans[id] = t - max(map.get(id), map.get(0));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tmap.remove(id);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint ret = 0;\n\t\t\tfor(int i=0;i<MAX;i++) ret = max(ans[i], ret);\n\t\t\tSystem.out.println(ret);\n\t\t}\n\t}\n\t\n\tclass V {\n\t\tint t, id;\n\t\tV(int t, int id) {\n\t\t\tthis.t = t;\n\t\t\tthis.id = id;\n\t\t}\n\t\t\n\t\tpublic int hashCode() {\n\t\t\treturn t * id;\n\t\t}\n\t\t\n\t\tpublic boolean equals(Object o) {\n\t\t\tif(o instanceof V) {\n\t\t\t\tV v = (V) o;\n\t\t\t\treturn t == v.t && id == v.t;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\t\n\n\tvoid debug(Object... os) {\n\t\tSystem.err.println(Arrays.deepToString(os));\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\tstatic Scanner sc = new Scanner(System.in);\n\n\tpublic static void main(String[] args) {\n\t\twhile (true) {\n\t\t\tint N = sc.nextInt();\n\t\t\tif (N == 0) break;\n\t\t\tsc.nextLine();\n\t\t\tint[] enter = new int[1000];\n\t\t\tint[] sum = new int[1000];\n\t\t\tfor (int i = 0; i < N; ++i) {\n\t\t\t\tchar[] line = sc.nextLine().toCharArray();\n\t\t\t\tint h = (line[6] - '0') * 10 + line[7] - '0';\n\t\t\t\tint m = (line[9] - '0') * 10 + line[10] - '0';\n\t\t\t\tint time = h * 60 + m;\n\t\t\t\tboolean in = line[12] == 'I';\n\t\t\t\tint id = (line[14] - '0') * 100 + (line[15] - '0') * 10 + line[16] - '0';\n\t\t\t\tif (in) {\n\t\t\t\t\tenter[id] = time;\n\t\t\t\t} else {\n\t\t\t\t\tif (id == 0) {\n\t\t\t\t\t\tfor (int j = 1; j < 1000; ++j) {\n\t\t\t\t\t\t\tif (enter[j] != 0) {\n\t\t\t\t\t\t\t\tsum[j] += time - Math.max(enter[j], enter[0]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (enter[id] != 0 && enter[0] != 0) {\n\t\t\t\t\t\t\tsum[id] += time - Math.max(enter[id], enter[0]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tenter[id] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tint ans = 0;\n\t\t\tfor (int i = 0; i < 1000; ++i) {\n\t\t\t\tans = Math.max(ans, sum[i]);\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nclass Main{\n\n    void solve(){\n        Scanner sc = new Scanner(System.in);\n\n        while(true){\n            int n = sc.nextInt();\n            if(n==0) break;\n            sc.nextLine();\n\n            //time, IO(0,1), id\n            PriorityQueue<int[]> q = new PriorityQueue<int[]>(10, new Comparator<int[]>(){\n                    public int compare(int[] a, int[] b){\n                        return a[0] - b[0];\n                    }\n                });\n\n            ArrayList<Integer> idlist = new ArrayList<Integer>();\n\n            for(int i=0; i<n; i++){\n                String line = sc.nextLine();\n                String s = \"1\" + line.substring(0,2) + line.substring(3,5)\n                    + line.substring(6,8) + line.substring(9, 11);\n                int io = 0;\n                if(line.charAt(12)=='O') io = 1;\n                int id = Integer.parseInt(line.substring(14,17));\n                q.add(new int[]{Integer.parseInt(s), io, id});\n                if(!idlist.contains(id) && id!=0) idlist.add(id);\n            }\n\n            int[] times = new int[idlist.size()];\n\n\n            int[] start = new int[idlist.size()];\n            while(q.size()>0){\n                int[] qq = q.poll();\n                int time = qq[0], in = qq[1], id = qq[2];\n                if(in==0 && id!=0) start[idlist.indexOf(id)] = time;\n                if(in==1 && id!=0) start[idlist.indexOf(id)] = 0;\n\n                if(qq[2]!=0 || in!=0) continue;\n\n            \n                \n                int out = 0;\n\n                while(true){\n                    int[] qqq = q.poll();\n                    int time2 = qqq[0], in2 = qqq[1], id2 = qqq[2];\n                    \n                    if(id2==0){\n                        out = time2;\n                        break;\n                    }\n                    \n                    int idx = idlist.indexOf(id2);\n                    if(in2==0){\n                        start[idx] = time2;\n                    }else{\n                        if(start[idx]==0){\n                            times[idx] += getTime(time, time2);\n                        }else{\n                            times[idx] += getTime(Math.max(time, start[idx]), time2);\n                            start[idx] = 0;\n                        }\n                    }\n                }\n                \n                for(int i=0; i<idlist.size(); i++){\n                    if(start[i]==0) continue;\n                    times[i] += getTime(Math.max(time, start[i]), out);\n                }\n                \n            }\n\n            int max = 0;\n            for(int i=0; i<idlist.size(); i++) max = Math.max(max, times[i]);\n\n            System.out.println(max);\n        }\n    }\n\n    int getTime(int t1, int t2){\n        t1 %= 100000000;\n        t2 %= 100000000;\n\n        int m1 = t1 / 1000000, m2 = t2 / 1000000;\n        int d1 = t1 / 10000 % 100, d2 = t2 / 10000 % 100;\n        int h1 = t1 / 100 % 100, h2 = t2 / 100 % 100;\n        int p1 = t1 % 100, p2 = t2 % 100;\n\n        int day = 0;\n        if(m1==m2) day = d2 - d1;\n        else{\n            if(m1==4 || m1==6 || m1==9 || m1==11) day = 30-d1;\n            else if(m1!=2) day = 31 - d1;\n            else day = 28 - d1;\n            \n            for(int i=m1+1; i<m2; i++){\n                if(m1==4 || m1==6 || m1==9 || m1==11) day += 30;\n                else if(m1!=2) day += 31;\n                else day += 28;\n            }\n            day += d2-1;\n        }\n\n        int minutes = day * 24 * 60;\n        if(m1==m2 && d1==d2) minutes = (h2*60+p2) - (h1*60+p1);\n        else minutes += (24*60 - (h1*60+p1)) + (h2*60+p2);\n\n        //System.out.println(t1+\" \"+t2+\" \"+day+\" \"+minutes);\n        return minutes;\n    }\n\n    public static void main(String[] args){\n        new Main().solve();\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport static java.lang.System.*;\nimport static java.lang.Math.*;\n\npublic class Main {\n\n\tScanner sc = new Scanner(in);\n\t\n\tvoid run() {\n\t\tint[] time = new int[1000];\n\t\tint[] sum = new int[1000];\n\t\twhile (true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tif (n == 0) break;\n\t\t\tArrays.fill(time, -1);\n\t\t\tArrays.fill(sum, 0);\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tsc.next();\n\t\t\t\tString t = sc.next();\n\t\t\t\tint min = 60*Integer.parseInt(t.substring(0, 2)) + Integer.parseInt(t.substring(3));\n\t\t\t\tchar c = sc.next().charAt(0);\n\t\t\t\tint num = sc.nextInt();\n\t\t\t\tif (c == 'I') {\n\t\t\t\t\ttime[num] = min;\n\t\t\t\t} else {\n\t\t\t\t\tif (num == 0) {\n\t\t\t\t\t\tfor (int j = 1; j < 1000; j++) {\n\t\t\t\t\t\t\tif (time[j] >= 0) {\n\t\t\t\t\t\t\t\tsum[j] += min - max(time[0], time[j]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttime[0] = -1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (time[0] >= 0) {\n\t\t\t\t\t\t\tsum[num] += min - max(time[0], time[num]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttime[num] = -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tint res = -1;\n\t\t\tfor (int i = 1; i < 1000; i++)\n\t\t\t\tres = max(res, sum[i]);\n\t\t\tout.println(res);\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tif (n == 0) {\n\t\t\t\tsc.close();\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tint[] total = new int[n];\n\t\t\tint[] start = new int[n];\n\t\t\tboolean[] inside = new boolean[n];\n\t\t\tfor (int l = 0; l < n; l++) {\n\t\t\t\tString d = sc.next();\n\t\t\t\tString[] t = sc.next().split(\":\");\n\t\t\t\tint h = Integer.parseInt(t[0]);\n\t\t\t\tint m = Integer.parseInt(t[1]);\n\t\t\t\tint now = h * 60 + m;\n\t\t\t\tString io = sc.next();\n\t\t\t\tint id = Integer.parseInt(sc.next());\n\n\t\t\t\tif (io.equals(\"I\") && id == 0) {\n\t\t\t\t\t// 神がログインした時\n\t\t\t\t\tinside[id] = true;\n\t\t\t\t\tfor (int i = 1; i < inside.length; i++) {\n\t\t\t\t\t\tif (inside[i]) {\n\t\t\t\t\t\t\tstart[i] = now;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (io.equals(\"O\") && id == 0) {\n\t\t\t\t\t// 神がログアウトした時\n\t\t\t\t\tinside[id] = false;\n\t\t\t\t\tfor (int i = 1; i < inside.length; i++) {\n\t\t\t\t\t\tif (inside[i]) {\n\t\t\t\t\t\t\ttotal[i] += now - start[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (io.equals(\"I\") && id != 0) {\n\t\t\t\t\t// 人がログインした時\n\t\t\t\t\tinside[id] = true;\n\t\t\t\t\tif (inside[0]) {\n\t\t\t\t\t\tstart[id] = now;\n\t\t\t\t\t}\n\t\t\t\t} else if (io.equals(\"O\") && id != 0) {\n\t\t\t\t\t// 人がログアウトした時\n\t\t\t\t\tinside[id] = false;\n\t\t\t\t\tif (inside[0]) {\n\t\t\t\t\t\ttotal[id] += now - start[id];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tint max = 0;\n\t\t\tfor (int i = 1; i < total.length; i++) {\n\t\t\t\tmax = Math.max(max, total[i]);\n\t\t\t}\n\t\t\tSystem.out.println(max);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\n\tlong convert(String date, String time) {\n\t\tlong res = 0;\n\t\tString[] w1 = date.split(\"/\"), w2 = time.split(\":\");\n\n\t\tres += Integer.valueOf(w1[0]) * 60 * 24 * 30;\n\t\tres += Integer.valueOf(w1[1]) * 60 * 24;\n\t\tres += Integer.valueOf(w2[0]) * 60;\n\t\tres += Integer.valueOf(w2[1]);\n\t\t\n\t\treturn res;\n\t}\n\t\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tint n = in.nextInt();\n\t\t\tif (n == 0) break;\n\t\t\t\n\t\t\tString[] dat = new String[n];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tdat[i] = in.nextLine();\n\t\t\t}\n\t\t\t\n\t\t\tArrayList<Long> entrance = new ArrayList<Long>();\n\t\t\tArrayList<Long> exit = new ArrayList<Long>();\n\t\t\t\n\t\t\tfor (String s : dat) {\n\t\t\t\tString[] words = s.split(\" \");\n\t\t\t\tif (Integer.valueOf(words[3]) != 0) continue;\n\t\t\t\t\n\t\t\t\tlong time = convert(words[0], words[1]);\n\t\t\t\tif (words[2].charAt(0) == 'I') {\n\t\t\t\t\tentrance.add(time);\n\t\t\t\t} else {\n\t\t\t\t\texit.add(time);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint MAX = 1001;\n\t\t\tlong[] sum = new long[MAX];\n\t\t\tlong[] come = new long[MAX];\n\t\t\t\n\t\t\tfor (String s : dat) {\n\t\t\t\tString[] words = s.split(\" \");\n\t\t\t\tint id = Integer.valueOf(words[3]);\n\t\t\t\tif (id == 0) continue;\n\t\t\t\t\n\t\t\t\tlong time = convert(words[0], words[1]);\n\t\t\t\tif (words[2].charAt(0) == 'I') {\n\t\t\t\t\tcome[id] = time;\n\t\t\t\t} else {\n\t\t\t\t\tfor (int i = 0; i < exit.size(); i++) {\n\t\t\t\t\t\tlong en = entrance.get(i), ex = exit.get(i);\n\t\t\t\t\t\tlong meet = Math.min(time, ex) - Math.max(en, come[id]);\n\t\t\t\t\t\tif (meet > 0) sum[id] += meet;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tlong res = 0;\n\t\t\tfor (int i = 0; i < MAX; i++) {\n\t\t\t\tres = Math.max(res, sum[i]);\n\t\t\t}\n\t\t\tSystem.out.println(res);\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.*;\n\nimport static java.lang.Integer.parseInt;\n\n/**\n * Gift from the Goddess of Programming\n */\npublic class Main {\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line;\n\t\tString[] words;\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\n\t\t\tint n = parseInt(line);\n\t\t\tif (n == 0) break;\n\n\t\t\tMap<String, Map<String, Deque<int[]>>> logbook = new HashMap<>();\n\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tStringTokenizer st = new StringTokenizer(br.readLine());\n\n\t\t\t\tString day = st.nextToken();\n\t\t\t\tString time = st.nextToken();\n\t\t\t\tchar e = st.nextToken().charAt(0);\n\t\t\t\tString p = st.nextToken();\n\n\t\t\t\tlogbook.putIfAbsent(day, new HashMap<>());\n\t\t\t\tlogbook.get(day).putIfAbsent(p, new ArrayDeque<>());\n\t\t\t\tif (e == 'I') {\n\t\t\t\t\tlogbook.get(day).get(p).add(new int[]{timeValue(time), 0});\n\t\t\t\t} else {\n\t\t\t\t\tlogbook.get(day).get(p).peekLast()[1] = timeValue(time);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//\n\t\t\tint max = 0;\n\t\t\tMap<String, Integer> blessed = new HashMap<>();\n\n\t\t\tfor (String day : logbook.keySet()) {\n\t\t\t\tMap<String, Deque<int[]>> logs = logbook.get(day);\n\n\t\t\t\tif (logs.get(\"000\") == null) continue;\n\n\t\t\t\tfor (String p : logs.keySet()) {\n\t\t\t\t\tif (!p.equals(\"000\")) {\n\t\t\t\t\t\tblessed.putIfAbsent(p, 0);\n\t\t\t\t\t\tfor (int[] r1 : logs.get(p)) {\n\t\t\t\t\t\t\tfor (int[] r0 : logs.get(\"000\")) {\n\t\t\t\t\t\t\t\tint i = blessed.get(p);\n\t\t\t\t\t\t\t\ti += intersect(r0, r1);\n\t\t\t\t\t\t\t\tblessed.put(p, i);\n\t\t\t\t\t\t\t\tmax = Math.max(max, i);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(max);\n\t\t} //end while\n\t} //end main\n\n\tstatic int timeValue(String time) {\n\t\tint c = time.indexOf(':');\n\t\treturn parseInt(time.substring(0, c)) * 60 +\n\t\t\t\tparseInt(time.substring(c + 1));\n\t}\n\n\tstatic int intersect(int[] r1, int[] r2) {\n\t\tint ret = 0;\n\t\tif (r1[1] <= r2[0]) {\n\t\t\tret = 0;\n\t\t} else if (r1[0] >= r2[1]) {\n\t\t\tret = 0;\n\t\t} else if (r1[0] <= r2[0] && r2[1] <= r1[1]) {\n\t\t\tret = r2[1] - r2[0];\n\t\t} else if (r2[0] <= r1[0] && r1[1] <= r2[1]) {\n\t\t\tret = r1[1] - r1[0];\n\t\t} else if (r1[0] <= r2[0] && r1[1] <= r2[1]) {\n\t\t\tret = r1[1] - r2[0];\n\t\t} else {\n\t\t\tret = r2[1] - r1[0];\n\t\t}\n\t\treturn ret;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.*;\nimport java.io.*;\nimport static java.util.Arrays.*;\nimport static java.util.Collections.*;\nimport static java.lang.Math.*;\n\npublic class Main {\n\n\tint INF = 1 << 28;\n\t//long INF = 1L << 62;\n\tdouble EPS = 1e-10;\n\tint MAX = 1000;\n\t\n\tint[] month = {0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334};\n\t\n\tvoid run() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tfor(;;) {\n\t\t\tint n = sc.nextInt();sc.nextLine();\n\t\t\tif(n == 0) break;\n\t\t\tHashMap<Integer, Integer> map = new HashMap<Integer, Integer>();\n\t\t\tint[] ans = new int[MAX];\n\t\t\tfor(int i=0;i<n;i++) {\n\t\t\t\tString[] sp = sc.nextLine().split(\"[/ :]\");\n//\t\t\t\tdebug(sp);\n\t\t\t\t\n\t\t\t\tif(sp[4].equals(\"I\")) {\n\t\t\t\t\tint id = Integer.parseInt(sp[5]);\n\t\t\t\t\tint t = ( month[Integer.parseInt(sp[0])-1] + Integer.parseInt(sp[1]) ) * 24 * 60 + Integer.parseInt(sp[2]) * 60 + Integer.parseInt(sp[3]);\n\t\t\t\t\tmap.put(id, t );\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\telse {\n\t\t\t\t\tint id = Integer.parseInt(sp[5]);\n\t\t\t\t\tint t = ( month[Integer.parseInt(sp[0])-1] + Integer.parseInt(sp[1]) ) * 24 * 60 + Integer.parseInt(sp[2]) * 60 + Integer.parseInt(sp[3]);\n\t\t\t\t\tif(id == 0) {\n\t\t\t\t\t\tfor(Map.Entry<Integer, Integer> entry: map.entrySet()) if(entry.getKey() != 0){\n\t\t\t\t\t\t\tans[entry.getKey()] += t - max(map.get(id), map.get(entry.getKey()));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif(map.containsKey(0)) {\n\t\t\t\t\t\t\tans[id] += t - max(map.get(id), map.get(0));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tmap.remove(id);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint ret = 0;\n\t\t\tfor(int i=0;i<MAX;i++) ret = max(ans[i], ret);\n\t\t\tSystem.out.println(ret);\n\t\t}\n\t}\n\t\n\tclass V {\n\t\tint t, id;\n\t\tV(int t, int id) {\n\t\t\tthis.t = t;\n\t\t\tthis.id = id;\n\t\t}\n\t\t\n\t\tpublic int hashCode() {\n\t\t\treturn t * id;\n\t\t}\n\t\t\n\t\tpublic boolean equals(Object o) {\n\t\t\tif(o instanceof V) {\n\t\t\t\tV v = (V) o;\n\t\t\t\treturn t == v.t && id == v.t;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\t\n\n\tvoid debug(Object... os) {\n\t\tSystem.err.println(Arrays.deepToString(os));\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n    public static void main(String[] args) throws Exception {\n        Scanner in = new Scanner(System.in);\n        \n        while (true) {\n            int N = in.nextInt();\n            if (N == 0) break;\n            \n            Vector<Person> persons = new Vector<Person>();\n            \n            while (N-- > 0) {\n                String str = in.next();\n                int M = Integer.parseInt(str.substring(0, 2), 10);\n                int D = Integer.parseInt(str.substring(3, 5), 10);\n                \n                str = in.next();\n                int h = Integer.parseInt(str.substring(0, 2), 10);\n                int m = Integer.parseInt(str.substring(3, 5), 10);\n                \n                char c = in.next().charAt(0);\n                int n = Integer.parseInt(in.next(), 10);\n                \n                while (persons.size() < n + 1) {\n                    persons.add(new Person());\n                }\n                \n                Person p = persons.get(n);\n                if (c == 'I') {\n                    p.records.add(new Record(M, D, h, m));    \n                } else {\n                    p.exit(M, D, h, m);\n                }\n            }\n            \n            int maximum = -999;\n            Vector<Record> basis = persons.get(0).records;\n            for (int i = 1; i < persons.size(); i++) {\n                maximum = Math.max(maximum, persons.get(i).getScore(basis));\n            }\n            \n            System.out.println(maximum);\n            \n            // for (int i = 0; i < persons.size(); i++) {\n            //     System.out.println(i + \":\");\n            //     System.out.println(persons.get(i));\n            // }\n        }\n    }\n    \n    public static class Person {\n        Vector<Record> records;\n        \n        public Person() {\n            records = new Vector<Record>();\n        }\n        \n        public void exit(int M, int D, int h, int m) {\n            for (Record rec : records) {\n                rec.exit(M, D, h, m);\n            }\n        }\n        \n        public int getScore(Vector<Record> basis) {\n            int score = 0;\n            for (Record rec : records) {\n                for (Record other : basis) {\n                    score += rec.overlap(other);\n                }\n            }\n            return score;\n        }\n        \n        public String toString() {\n            String str = \"\";\n            for (Record rec : records) {\n                str += rec.toString() + \"\\n\";\n            }\n            return str;\n        }\n    }\n    \n    public static class Record {\n        int M;\n        int D;\n        int start;\n        int end;\n        boolean isDone;\n        \n        public Record(int M, int D, int h, int m) {\n            this.M = M;\n            this.D = D;\n            this.start = h * 60 + m;\n            this.end = 24 * 60;\n            this.isDone = false;\n        }\n        \n        public void exit(int M, int D, int h, int m) {\n            if (this.isDone) return;\n            this.isDone = true;\n            if (this.M == M && this.D == D) {\n                this.end = h * 60 + m;\n            }\n        }\n        \n        public int overlap(Record other) {\n            if (M != other.M || D != other.D) return 0;\n            int adjStart = Math.max(start, other.start);\n            int adjEnd = Math.min(end, other.end);\n            if (adjEnd < adjStart) return 0;\n            return adjEnd - adjStart;\n        }\n        \n        public String toString() {\n            return String.format(\"  [%02d/%02d] %02d:%02d - %02d:%02d\", M, D, \n                start / 60, start % 60, end / 60, end % 60);\n        }\n    }\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\nimport java.util.ArrayList;\n\npublic class Main {\n\tScanner sc;\n\tpublic void run(){\n\t\tsc = new Scanner(System.in);\n\t\twhile(sc.hasNextInt()){\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n != 0){\n\t\t\t\tcalc(n);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tpublic void calc(int n){\n\t\tint[] ans = new int[1000];\n\t\tint[] ent = new int[1000];\n\t\tString today = \"\";\n\t\t\n\t\tfor(int i = 0; i < n; i++){\n\t\t\tString day = sc.next();\n\t\t\tif(!day.equals(today)){\n\t\t\t\ttoday = day;\n\t\t\t\tent = new int[1000];\n\t\t\t}\n\t\t\tString time = sc.next();\n\t\t\tint t = calcTime(time);\n\t\t\tString inout = sc.next();\n\t\t\tint p = sc.nextInt();\n\t\t\t\n\t\t\tif(inout.equals(\"I\")) ent[p] = t;\n\t\t\telse if(p == 0){\n\t\t\t\tfor(int k = 1; k < n; k++){\n\t\t\t\t\tif(ent[k] != 0){\n\t\t\t\t\t\tans[k] += Math.min(t - ent[k], t - ent[0]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tent[p] = 0;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(ent[0] != 0){\n\t\t\t\t\tans[p] += Math.min(t - ent[p], t - ent[0]);\n\t\t\t\t}\n\t\t\t\tent[p] = 0;\n\t\t\t}\n\t\t}\n\t\t\n\t\tint max = 0;\n\t\tfor(int i = 1; i < 1000; i++){\n\t\t\tif(max < ans[i]) max = ans[i];\n\t\t}\n\t\t\n\t\tSystem.out.println(max);\n\t}\n\t\n\tpublic int calcTime(String time){\n\t\tint hour = Integer.valueOf(time.substring(0,2));\n\t\tint minute = Integer.valueOf(time.substring(3));\n\t\t\n\t\treturn hour * 60 + minute;\n\t}\n\tpublic static void main(String[] args){\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\n\tlong convert(String date, String time) {\n\t\tlong res = 0;\n\t\tString[] w1 = date.split(\"/\"), w2 = time.split(\":\");\n\n\t\tres += Integer.valueOf(w1[0]) * 60 * 24 * 30;\n\t\tres += Integer.valueOf(w1[1]) * 60 * 24;\n\t\tres += Integer.valueOf(w2[0]) * 60;\n\t\tres += Integer.valueOf(w2[1]);\n\t\t\n\t\treturn res;\n\t}\n\t\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tint n = in.nextInt();\n\t\t\tif (n == 0) break;\n\t\t\t\n\t\t\tString[] dat = new String[n];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tdat[i] = in.nextLine();\n\t\t\t}\n\t\t\t\n\t\t\tArrayList<Long> entrance = new ArrayList<Long>();\n\t\t\tArrayList<Long> exit = new ArrayList<Long>();\n\t\t\t\n\t\t\tfor (String s : dat) {\n\t\t\t\tString[] words = s.split(\" \");\n\t\t\t\tif (Integer.valueOf(words[3]) != 0) continue;\n\t\t\t\t\n\t\t\t\tlong time = convert(words[0], words[1]);\n\t\t\t\tif (words[2].charAt(0) == 'I') {\n\t\t\t\t\tentrance.add(time);\n\t\t\t\t} else {\n\t\t\t\t\texit.add(time);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint MAX = 101;\n\t\t\tlong[] sum = new long[MAX];\n\t\t\tlong[] come = new long[MAX];\n\t\t\t\n\t\t\tfor (String s : dat) {\n\t\t\t\tString[] words = s.split(\" \");\n\t\t\t\tint id = Integer.valueOf(words[3]);\n\t\t\t\tif (id == 0) continue;\n\t\t\t\t\n\t\t\t\tlong time = convert(words[0], words[1]);\n\t\t\t\tif (words[2].charAt(0) == 'I') {\n\t\t\t\t\tcome[id] = time;\n\t\t\t\t} else {\n\t\t\t\t\tfor (int i = 0; i < exit.size(); i++) {\n\t\t\t\t\t\tlong en = entrance.get(i), ex = exit.get(i);\n\t\t\t\t\t\tlong meet = Math.min(time, ex) - Math.max(en, come[id]);\n\t\t\t\t\t\tif (meet > 0) sum[id] += meet;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tlong res = 0;\n\t\t\tfor (int i = 0; i < MAX; i++) {\n\t\t\t\tres = Math.max(res, sum[i]);\n\t\t\t}\n\t\t\tSystem.out.println(res);\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.*;\nimport java.lang.ArrayIndexOutOfBoundsException;\nimport java.math.BigInteger;\n\n/**\n * @author yoshikyoto\n */\nclass Main {\n\tstatic Scanner sc = new Scanner(new InputStreamReader(System.in));\n\tpublic static void main(String[] args) throws Exception {\n\t\twhile(true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n == 0) break;\n\t\t\tSystem.out.println(solve(n));\n\t\t}\n\t}\n\t\n\tstatic int solve(int n) {\n\t\tHashMap<String, ArrayList<Integer>> timeMap = new HashMap<String, ArrayList<Integer>>();\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tint m = toMinutes(sc.next(), sc.next());\n\t\t\tString io = sc.next();\n\t\t\tString id = sc.next();\n\t\t\tif(!timeMap.containsKey(id)) {\n\t\t\t\ttimeMap.put(id, new ArrayList<Integer>());\n\t\t\t}\n\t\t\ttimeMap.get(id).add(m);\n\t\t}\n\t\tif(!timeMap.containsKey(\"000\")) {\n\t\t\treturn 0;\n\t\t}\n\t\tArrayList<Integer> goddessList = timeMap.get(\"000\");\n\t\t\n\t\tint ans = 0;\n\t\tfor(String id : timeMap.keySet()) {\n\t\t\tif(id.equals(\"000\")) continue;\n\t\t\tArrayList<Integer> list = timeMap.get(id);\n\t\t\t\n\t\t\tint sum = 0;\n\t\t\tfor (int i = 0; i < list.size(); i+=2) {\n\t\t\t\tfor (int j = 0; j < goddessList.size(); j+=2) {\n\t\t\t\t\tint start = Math.max(goddessList.get(j), list.get(i));\n\t\t\t\t\tint end = Math.min(goddessList.get(j+1), list.get(i+1));\n\t\t\t\t\tint time = end - start;\n\t\t\t\t\tif(time > 0) {\n\t\t\t\t\t\tsum += time;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tans = Math.max(ans, sum);\n\t\t}\n\t\treturn ans;\n\t}\n\t\n\tstatic int toMinutes(String str1, String str2) {\n\t\tString[] month_date = str1.split(\"/\");\n\t\tString[] hour_minute = str2.split(\":\");\n\t\tint month = Integer.valueOf(month_date[0]);\n\t\tint date = Integer.valueOf(month_date[1]);\n\t\tint hour = Integer.valueOf(hour_minute[0]);\n\t\tint minute = Integer.valueOf(hour_minute[1]);\n\t\tint ans = minute + hour * 60 + date * 24 * 60 + month * 31 * 24 * 60;\n\t\treturn ans;\n\t}\n}"
  },
  {
    "language": "C#",
    "code": "using System.Collections.Generic;\nusing System;\n\npublic class P\n{\n    public string mmdd { get; set; }\n    public string id { get; set; }\n    public int a { get; set; }\n    public int b { get; set; }\n}\n\npublic class P2\n{\n    public string mmdd { get; set; }\n    public int s { get; set; }\n    public int t { get; set; }\n}\n\npublic class hello\n{\n    public static void Main()\n    {\n        while (true)\n        {\n            var n = int.Parse(Console.ReadLine().Trim());\n            if (n == 0) break;\n            var d = new Dictionary<string, int>();\n            var pg = new List<P>();\n            var god = new List<P2>();\n            for (int i = 0; i < n; i++)\n            {\n                string[] line = Console.ReadLine().Trim().Split(' ', ':');\n                var mmdd = line[0];\n                var hh = int.Parse(line[1]);\n                var mm = int.Parse(line[2]);\n                var io = line[3];\n                var id = line[4];\n                var hm = 60 * hh + mm;\n                if (io == \"I\") d[id] = hm;\n                else\n                    if (id == \"000\") god.Add(new P2 { mmdd = mmdd, s = d[id], t = hm });\n                    else\n                    {\n                        pg.Add(new P { mmdd = mmdd, id = id, a = d[id], b = hm });\n                        d[id] = 0;\n                    }\n            }\n            Console.WriteLine(getAns(d,pg,god));\n        }\n    }\n    public static int getAns (Dictionary<string,int> d , List<P> pg, List<P2 > god)\n    {\n        var ans = 0;\n        foreach (var x in pg)\n            foreach (var y in god)\n                if (x.mmdd == y.mmdd)\n                {\n                    if (x.a > y.t | x.b < y.s) continue;\n                    var sd = x.a >= y.s ? x.a : y.s;\n                    var td = x.b <= y.t ? x.b : y.t;\n                    d[x.id] += td - sd;\n                    ans = Math.Max(ans, d[x.id]);\n                }\n        return ans;\n    }\n}\n\n\n"
  },
  {
    "language": "JavaScript",
    "code": "var input = require('fs').readFileSync('/dev/stdin', 'utf8');\ninput=input.replace(/\\/|\\:/g,\" \").replace(/I/g,\"1\").replace(/O/g,\"0\");\nvar arr=input.trim().split(\"\\n\");\nwhile(true){\n   var n=arr.shift()-0;\n   if(n==0)break;\n   var obj={};\n   var flag=false;\n   while(n--){\n      var MDhmep=arr.shift().split(\" \").map(Number);\n      (function(M,D,h,m,e,p){\n         var time=M*30*24*60+D*24*60+h*60+m;\n         if(p==0){\n            if(e==1){\n               flag=true;\n               for(var k in obj){\n                  if(obj[k][0]!=0)obj[k][0]=time;\n               }\n            }\n            if(e==0){\n               flag=false;\n               for(var k in obj){\n                  if(obj[k][0]!=0)obj[k][1]+=time-obj[k][0];\n               }\n            }\n         }\n         if(p!=0){\n            if(!obj.hasOwnProperty(p))obj[p]=[0,0];\n            if(e==1)obj[p][0]=time;\n            if(e==0 && flag){\n               obj[p][1]+=time-obj[p][0];\n               obj[p][0]=0;\n            }\n            if(e==0 && !flag)obj[p][0]=0;\n         }\n      }).apply(null,MDhmep);\n   }\n   var max=0;\n   for(var k in obj){\n      if(obj[k][1]>max)max=obj[k][1];\n   }\n   console.log(max);\n}"
  },
  {
    "language": "JavaScript",
    "code": "var n;\nvar t = [];\nvar x = [];\nvar s = [];\n\nfunction time(s){\n\ts = s.split(':');\n\treturn (+s[0]) * 60 + (+s[1]);\n}\n\nfunction same(a, b){\n\treturn a[0] === b[0] && a[1] === b[1];\n}\n\nfunction main(){\n\twhile(n = scan()){\n\t\trep(1000, function(i){\n\t\t\tx[i] = [];\n\t\t});\n\n\t\trep(n, function(){\n\t\t\tvar v = [scan_string(), time(scan_string())];\n\t\t\tif(t.length === 0 || !same(t[t.length - 1], v)){\n\t\t\t\tt.push(v);\n\t\t\t}\n\t\t\tscan_string();\n\t\t\tx[scan()].push(t.length - 1);\n\t\t});\n\n\t\trep(t.length, function(i){\n\t\t\ts[i] = 0;\n\t\t});\n\t\trep(x[0].length, function(i){\n\t\t\tif(i % 2){\n\t\t\t\trep(x[0][i - 1], x[0][i], function(j){\n\t\t\t\t\ts[j + 1] = t[j + 1][1] - t[j][1];\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\trep(t.length - 1, function(i){\n\t\t\ts[i + 1] += s[i];\n\t\t});\n\n\t\tvar ans = 0;\n\t\trep(1, 1000, function(i){\n\t\t\tvar a = 0;\n\t\t\trep(x[i].length, function(j){\n\t\t\t\tif(j % 2){\n\t\t\t\t\ta += s[x[i][j]] - s[x[i][j - 1]];\n\t\t\t\t}\n\t\t\t});\n\t\t\tans = Math.max(a, ans);\n\t\t});\n\t\tprint(ans);\n\n\t\tt = [];\n\t}\n}\n\nfunction rep(a, b, c, u){\n\tif(c === u){\n\t\tc = b;\n\t\tb = a;\n\t\ta = 0;\n\t}\n\tfor(var i = a; i < b; ++i){\n\t\tif(c(i) === false){\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nvar input = '';\n\nfunction scan(){\n\treturn +input.pop();\n}\nfunction scan_string(){\n\treturn input.pop();\n} \nfunction print(val){\n\tconsole.log(val);\n}\n \nprocess.stdin.resume();\nprocess.stdin.setEncoding('utf8');\nprocess.stdin.on('data', function(chunk){\n\tinput += chunk;\n});\nprocess.stdin.on('end', function(){\n\tinput = input.trim().split(/\\s+/).reverse();\n\tmain();\n});"
  },
  {
    "language": "Ruby",
    "code": "loop do\n    n = gets.to_i\n    break if n == 0\n    data = Hash.new(Array.new)\n    n.times do\n        s = gets.chomp.split\n        time = s[1].split(/:/)\n        data[s[0]] += [[time[0].to_i * 60 + time[1].to_i, s[2],s[3]]]\n    end\n    ret = Hash.new(0)\n    data.each do |k,v|\n        gd_presence = Array.new\n        v.select{|vs| vs[2] == \"000\"}.each_slice(2) do |gd|\n            gd_presence.push([gd[0][0],gd[1][0]])\n        end\n        io = Hash.new(Array.new)\n        v.select{|vs| vs[2] != \"000\"}.each do |pg|\n            io[pg[2]] += [pg[0]]\n        end\n        io.each do |pg|\n            total = 0\n            pg[1].each_slice(2) do |time|\n                gd_presence.each do |gdp|\n                    ret[pg[0]] += [0,[time[1],gdp[1]].min-[time[0],gdp[0]].max].max\n                end\n            end\n        end\n    end\n    p ret.map{|a| a[1]}.max\nend"
  },
  {
    "language": "Ruby",
    "code": "require 'zlib'\nrequire 'base64'\n$stderr.puts Base64.encode64(Zlib.deflate($<.read))"
  },
  {
    "language": "Ruby",
    "code": "loop do\n    n = gets.to_i\n    break if n == 0\n    data = Hash.new(Array.new)\n    n.times do\n        s = gets.chomp.split\n        time = s[1].split(/:/)\n        data[s[0]] += [[time[0].to_i * 60 + time[1].to_i, s[2],s[3]]]\n    end\n    ret = Hash.new(0)\n    data.each do |k,v|\n        gd_presence = Array.new\n        v.select{|vs| vs[2] == \"000\"}.each_slice(2) do |gd|\n            gd_presence.push([gd[0][0],gd[1][0]])\n        end\n        io = Hash.new(Array.new)\n        v.select{|vs| vs[2] != \"000\"}.each do |pg|\n            io[pg[2]] += [pg[0]]\n        end\n        io.each do |pg|\n            total = 0\n            pg[1].each_slice(2) do |time|\n                gd_presence.each do |gdp|\n                    ret[pg[0]] += [0,[time[1],gdp[1]].min-[time[0],gdp[0]].max].max\n                end\n            end\n        end\n    end\n    output = ret.map{|a| a[1]}.max\n    p output ? output : 0\nend"
  },
  {
    "language": "Ruby",
    "code": "### subroutines\n\ndef hm2min(hm)\n  hh, mm = hm.split(':').map(&:to_i)\n  hh * 60 + mm\nend\n\n### main\n\nloop do\n  n = gets.to_i\n  break if n == 0\n\n  users = []\n  maxid = 0\n  \n  n.times do\n    md, hm, io, id = gets.strip.split\n    min = hm2min(hm)\n    id = id.to_i\n    maxid = id if maxid < id\n    #p [md, hm, io, id]\n    \n    users[id] = {} if users[id].nil?\n    users[id][md] = [] if users[id][md].nil?\n    #p users[id][md]\n    \n    if io == 'I'\n      users[id][md] << [min]\n    else\n      users[id][md].last << min\n    end\n  end\n  #p users\n\n  sums = (maxid + 1).times.map{0}\n  if users[0]\n    for md in users[0].keys\n      users[0][md].each do |gm0, gm1|\n        for id in (1..maxid)\n          next if users[id].nil? || users[id][md].nil?\n          users[id][md].each do |im0, im1|\n            if gm1 >= im0 && im1 >= gm0\n              sums[id] += [gm1, im1].min - [gm0, im0].max\n            end\n          end\n        end\n      end\n    end\n  end\n  #p sums\n\n  puts sums.max\nend"
  },
  {
    "language": "Ruby",
    "code": "loop do\n  n = gets.to_i\n  break if n == 0\n  start = {}\n  bless = Hash.new(0)\n  n.times do\n    gets =~ /^(\\d\\d)\\/(\\d\\d) (\\d\\d):(\\d\\d) (.) (\\d\\d\\d)/\n    # p [$1.to_i, $2.to_i, $3.to_i, $4.to_i, $5, $6.to_i]\n    t = $3.to_i * 60 + $4.to_i\n    io = $5\n    p = $6.to_i\n    if io == ?I\n      start[p] = t\n    elsif p == 0\n      start_g = start[0]\n      start.delete(0)\n      start.each do |q, start_q|\n        bless[q] += t - [start_g, start_q].max\n      end\n    else\n      start_p = start[p]\n      start.delete(p)\n      start_g = start[0]\n      bless[p] += t - [start_g, start_p].max if start_g\n    end\n  end\n  p bless.values.max || 0\nend\n\n"
  },
  {
    "language": "Ruby",
    "code": "### subroutines\n\ndef hm2min(hm)\n  hh, mm = hm.split(':').map(&:to_i)\n  hh * 60 + mm\nend\n\n### main\n\nloop do\n  n = gets.to_i\n  break if n == 0\n\n  users = []\n  maxid = 0\n  \n  n.times do\n    md, hm, io, id = gets.strip.split\n    min = hm2min(hm)\n    id = id.to_i\n    maxid = id if maxid < id\n    #p [md, hm, io, id]\n    \n    users[id] = {} if users[id].nil?\n    users[id][md] = [] if users[id][md].nil?\n    #p users[id][md]\n    \n    if io == 'I'\n      users[id][md] << [min]\n    else\n      users[id][md].last << min\n    end\n  end\n  #p users\n\n  sums = (maxid + 1).times.map{0}\n  for md in users[0].keys\n    users[0][md].each do |gm0, gm1|\n      for id in (1..maxid)\n        next if users[id][md].nil?\n        users[id][md].each do |im0, im1|\n          if gm1 >= im0 && im1 >= gm0\n            sums[id] += [gm1, im1].min - [gm0, im0].max\n          end\n        end\n      end\n    end\n  end\n  #p sums\n\n  puts sums.max\nend"
  },
  {
    "language": "Ruby",
    "code": "def convert_time str\n    h, m = str.split(\":\").map(&:to_i)\n    h * 60 + m\nend\n\nwhile true\n    n = gets.to_i\n    break if n == 0\n\n    hsh = Hash.new{|h, k| h[k] = [0, nil]}\n    arr, mode = [], false\n    n.times{\n        date, time, io, id = gets.chomp.split(\" \")\n        if id == \"000\"\n            if io == \"I\"\n                arr.each{|pg| hsh[pg][1] = convert_time(time)}\n            else\n                arr.each{|pg| hsh[pg][0] += (convert_time(time) - hsh[pg][1])}\n            end\n            mode = !mode\n        else\n            if io == \"I\"\n                hsh[id][1] = convert_time(time) if mode\n                arr << id\n            else\n                hsh[id][0] += (convert_time(time) - hsh[id][1]) if mode\n                arr.delete id\n            end\n        end\n    }\n    arr = hsh.to_a.sort_by{|k, v| -v[0]}\n    puts (arr.empty? ? 0 : arr[0][1][0])  \nend\n"
  },
  {
    "language": "PHP",
    "code": "<?php\n/*\nA1315\nGift from the Goddess of Programming\n*/\n\nclass my_member {\n      public $id1;\n      public $date;\t\n      public $from_t;\n      public $to_t;\n}\n\nfunction dump($n)\n{\n  global $member_table;\n\n  for($i=0;$i<$n;$i++)\n    {    fprintf(STDOUT,\"%s %s;%s~ %s\\n\",$member_table[$i]->id1\n\t    ,$member_table[$i]->date\n\t    ,$member_table[$i]->from_t\n\t    ,$member_table[$i]->to_t);\n    }\n}\nfunction find_blessed($id_1,$id_2)\n{\n  global $member_table;\n\n  if($member_table[$id_1]->date != $member_table[$id_2]->date)\n    return(0);\n  $start=max(strtotime($member_table[$id_1]->from_t),\n\t     strtotime($member_table[$id_2]->from_t));\n  $end  =min(strtotime($member_table[$id_1]->to_t)  ,\n\t     strtotime($member_table[$id_2]->to_t));\n\n  $ret=($end-$start)/60;\n\n  //fprintf(STDOUT,\"f_b %d %d %d\\n\",$id_1,$id_2,$ret);\n\n  if($end <= $start)\n    return(0);\n  else\n    return($ret);\n}\nfunction search($member_table,$memid,$dat,$cnt)\n{\n  global $member_table;\n\n  for($i=$cnt-1;$i>=0;$i--)\n    {\n      if($member_table[$i]->id1 == $memid && $member_table[$i]->date == $dat)\n\treturn($i);\n    }\n  return(-1);\n}\nfunction solve($member_table,$cnt,$goddess,$goddess_cnt)\n{\n  global $goddess_time;\n\n  //fprintf(STDOUT,\"cnt=%d goddes cnt=%d\\n\",$cnt,$goddess_cnt);\n  for($i=0;$i<$goddess_cnt;$i++)\n    {\n      $index=$goddess[$i];\n      for($j=0;$j<$cnt;$j++)\n\t{\n\t  //fprintf(STDOUT,\"i,j=%d,%d\\n\",$i,$j);\n\t  \n\t  if($j==$index)\n\t    continue;\n\t  \n\t  $blessed=find_blessed($index,$j);\n\t  \n\t  if($blessed>0)\n\t    {\n\t      $myid=$member_table[$j]->id1;\n\t      //fprintf(STDOUT,\"id=%d %d\\n\",$myid,$blessed);\n\t      \n\t      if(!isset($goddess_time[$myid]))\n\t\t$goddess_time[$myid] = $blessed;\n\t      else\n\t\t$goddess_time[$myid] += $blessed;\n\t      \n\t    }\n\t  \n\t}\n    }\n  return(max($goddess_time));\n}\n// MAIN\nwhile(fscanf(STDIN,\"%d\",$n) && $n)\n{\n  $member_table=array();\n  $godess=array();\n  $goddess_time=array();\n\n  for($i=0;$i<$n;$i++)\n    $member_table[$i]=new my_member;\n\n\n  $cnt=0;$goddess_cnt=0;\n  for($i=0;$i<$n;$i++)\n    {\n      $buf=fgets(STDIN);\n      //fprintf(STDOUT,\"[%d]buf= %s\\n\",$i,$buf);\n      \n      $dat = strtok($buf,\" \\t\\n\");\n      $tim = strtok(\" \\t\\n\");\n      $io  = strtok(\" \\t\\n\");\n      $memid= strtok(\" \\t\\n\");\n      //fprintf(STDOUT,\"reg %s %s[%s] memid=%s\\n\",$dat,$tim,$io,$memid);\n     \n      \n      if($io==\"I\")\n\t{\n\t  $member_table[$cnt]->id1=$memid; \n\t  $member_table[$cnt]->date =$dat; \n\t  $member_table[$cnt]->from_t =$tim;\n\t  if($memid==0)\n\t    {\n\t      //fprintf(STDOUT,\"goddess in %s\\n\",$tim);\n\t      $goddess[$goddess_cnt]=$cnt;\n\t      $goddess_cnt++;\n\t    }\n\n\t  $cnt++;\n\t}\n      else // \"O\"\n\t{\n\t  $mycnt=search($member_table,$memid,$dat,$cnt);\n\t  $member_table[$mycnt]->to_t   =$tim;\n\t}\n    }\n  //dump($cnt);\n  \n  $ret=solve($member_table,$cnt,$goddess,$goddess_cnt);\n  fprintf(STDOUT,\"%d\\n\",$ret);\n}\nreturn(0);\n?>"
  },
  {
    "language": "PHP",
    "code": "<?php\n/*\nA1315\nGift from the Goddess of Programming\n14/07/13 RE\n*/\n\nclass my_member {\n      public $id1;\n      public $date;\t\n      public $from_t;\n      public $to_t;\n}\n\nfunction dump($n)\n{\n  global $member_table;\n\n  for($i=0;$i<$n;$i++)\n    {    fprintf(STDOUT,\"%s %s;%s~ %s\\n\",$member_table[$i]->id1\n\t    ,$member_table[$i]->date\n\t    ,$member_table[$i]->from_t\n\t    ,$member_table[$i]->to_t);\n    }\n}\nfunction find_blessed($id_1,$id_2)\n{\n  global $member_table;\n\n  if($member_table[$id_1]->date != $member_table[$id_2]->date)\n    return(0);\n  $start=max(strtotime($member_table[$id_1]->from_t),\n\t     strtotime($member_table[$id_2]->from_t));\n  $end  =min(strtotime($member_table[$id_1]->to_t)  ,\n\t     strtotime($member_table[$id_2]->to_t));\n\n  $ret=($end-$start)/60;\n\n  //fprintf(STDOUT,\"f_b %d %d %d\\n\",$id_1,$id_2,$ret);\n\n  if($end <= $start)\n    return(0);\n  else\n    return($ret);\n}\nfunction search($member_table,$memid,$dat,$cnt)\n{\n  global $member_table;\n\n  for($i=$cnt-1;$i>=0;$i--)\n    {\n      if($member_table[$i]->id1 == $memid && $member_table[$i]->date == $dat)\n\treturn($i);\n    }\n  return(-1);\n}\nfunction solve($member_table,$cnt,$goddess,$goddess_cnt)\n{\n  global $goddess_time;\n\n  //fprintf(STDOUT,\"cnt=%d goddes cnt=%d\\n\",$cnt,$goddess_cnt);\n  for($i=0;$i<$goddess_cnt;$i++)\n    {\n      $index=$goddess[$i];\n      for($j=0;$j<$cnt;$j++)\n\t{\n\t  if($j==$index)\n\t    continue;\n\t  \n\t  $blessed=find_blessed($index,$j);\n\t  \n\t  if($blessed>0)\n\t    {\n\t      $myid=$member_table[$j]->id1;\n\t      //fprintf(STDOUT,\"id=%d %d\\n\",$myid,$blessed);\n\t      \n\t      if(!isset($goddess_time[$myid]))\n\t\t$goddess_time[$myid] = $blessed;\n\t      else\n\t\t$goddess_time[$myid] += $blessed;\n\t      \n\t    }\n\t  \n\t}\n    }\n  if(empty($goddess_time))\n    return(0);\n  return(max($goddess_time));\n}\n// MAIN\nwhile(fscanf(STDIN,\"%d\",$n) && $n)\n{\n  $member_table=array();\n  $godess=array();\n  $goddess_time=array();\n\n  for($i=0;$i<$n;$i++)\n    $member_table[$i]=new my_member;\n\n\n  $cnt=0;$goddess_cnt=0;\n  for($i=0;$i<$n;$i++)\n    {\n      $buf=fgets(STDIN);\n      //fprintf(STDOUT,\"[%d]buf= %s\\n\",$i,$buf);\n      \n      $dat = strtok($buf,\" \\t\\n\");\n      $tim = strtok(\" \\t\\n\");\n      $io  = strtok(\" \\t\\n\");\n      $memid= strtok(\" \\t\\n\");\n      //fprintf(STDOUT,\"reg %s %s[%s] memid=%s\\n\",$dat,$tim,$io,$memid);\n     \n      \n      if($io==\"I\")\n\t{\n\t  $member_table[$cnt]->id1=$memid; \n\t  $member_table[$cnt]->date =$dat; \n\t  $member_table[$cnt]->from_t =$tim;\n\t  if($memid==0)\n\t    {\n\t      //fprintf(STDOUT,\"goddess in %s\\n\",$tim);\n\t      $goddess[$goddess_cnt]=$cnt;\n\t      $goddess_cnt++;\n\t    }\n\n\t  $cnt++;\n\t}\n      else // \"O\"\n\t{\n\t  $mycnt=search($member_table,$memid,$dat,$cnt);\n\t  $member_table[$mycnt]->to_t   =$tim;\n\t}\n    }\n  //dump($cnt);\n  if($goddess_cnt==0)\n    fprintf(STDOUT,\"%d\\n\",0);\n  else\n    {\n      $ret=solve($member_table,$cnt,$goddess,$goddess_cnt);\n      fprintf(STDOUT,\"%d\\n\",$ret);\n    }\n}\nreturn(0);\n?>"
  },
  {
    "language": "PHP",
    "code": "<?php\n/*\nA1315\nGift from the Goddess of Programming\n14/07/13 RE\n*/\n\nclass my_member {\n      public $id1;\n      public $date;\t\n      public $from_t;\n      public $to_t;\n}\n\nfunction dump($n)\n{\n  global $member_table;\n\n  for($i=0;$i<$n;$i++)\n    {    fprintf(STDOUT,\"%s %s;%s~ %s\\n\",$member_table[$i]->id1\n\t    ,$member_table[$i]->date\n\t    ,$member_table[$i]->from_t\n\t    ,$member_table[$i]->to_t);\n    }\n}\nfunction find_blessed($id_1,$id_2)\n{\n  global $member_table;\n\n  if($member_table[$id_1]->date != $member_table[$id_2]->date)\n    return(0);\n  $start=max(strtotime($member_table[$id_1]->from_t),\n\t     strtotime($member_table[$id_2]->from_t));\n  $end  =min(strtotime($member_table[$id_1]->to_t)  ,\n\t     strtotime($member_table[$id_2]->to_t));\n\n  $ret=($end-$start)/60;\n\n  //fprintf(STDOUT,\"f_b %d %d %d\\n\",$id_1,$id_2,$ret);\n\n  if($end <= $start)\n    return(0);\n  else\n    return($ret);\n}\nfunction search($member_table,$memid,$dat,$cnt)\n{\n  global $member_table;\n\n  for($i=$cnt-1;$i>=0;$i--)\n    {\n      if($member_table[$i]->id1 == $memid && $member_table[$i]->date == $dat)\n\treturn($i);\n    }\n  return(-1);\n}\nfunction solve($member_table,$cnt,$goddess,$goddess_cnt)\n{\n  global $goddess_time;\n\n  //fprintf(STDOUT,\"cnt=%d goddes cnt=%d\\n\",$cnt,$goddess_cnt);\n  for($i=0;$i<$goddess_cnt;$i++)\n    {\n      $index=$goddess[$i];\n      for($j=0;$j<$cnt;$j++)\n\t{\n\t  if($j==$index)\n\t    continue;\n\t  \n\t  $blessed=find_blessed($index,$j);\n\t  \n\t  if($blessed>0)\n\t    {\n\t      $myid=$member_table[$j]->id1;\n\t      //fprintf(STDOUT,\"id=%d %d\\n\",$myid,$blessed);\n\t      \n\t      if(!isset($goddess_time[$myid]))\n\t\t$goddess_time[$myid] = $blessed;\n\t      else\n\t\t$goddess_time[$myid] += $blessed;\n\t      \n\t    }\n\t  \n\t}\n    }\n  if(empty($goddess_time))\n    return(0);\n  return(max($goddess_time));\n}\n// MAIN\nwhile(fscanf(STDIN,\"%d\",$n) && $n)\n{\n  $member_table=array();\n  $godess=array();\n  $goddess_time=array();\n\n  for($i=0;$i<$n;$i++)\n    $member_table[$i]=new my_member;\n\n\n  $cnt=0;$goddess_cnt=0;\n  for($i=0;$i<$n;$i++)\n    {\n      $buf=fgets(STDIN);\n      //fprintf(STDOUT,\"[%d]buf= %s\\n\",$i,$buf);\n      \n      $dat = strtok($buf,\" \\t\\n\");\n      $tim = strtok(\" \\t\\n\");\n      $io  = strtok(\" \\t\\n\");\n      $memid= strtok(\" \\t\\n\");\n      //fprintf(STDOUT,\"reg %s %s[%s] memid=%s\\n\",$dat,$tim,$io,$memid);\n     \n      \n      if($io==\"I\")\n\t{\n\t  $member_table[$cnt]->id1=$memid; \n\t  $member_table[$cnt]->date =$dat; \n\t  $member_table[$cnt]->from_t =$tim;\n\t  if($memid==0)\n\t    {\n\t      //fprintf(STDOUT,\"goddess in %s\\n\",$tim);\n\t      $goddess[$goddess_cnt]=$cnt;\n\t      $goddess_cnt++;\n\t    }\n\n\t  $cnt++;\n\t}\n      else // \"O\"\n\t{\n\t  $mycnt=search($member_table,$memid,$dat,$cnt);\n\t  $member_table[$mycnt]->to_t   =$tim;\n\t}\n    }\n  //dump($cnt);\n  \n  $ret=solve($member_table,$cnt,$goddess,$goddess_cnt);\n  fprintf(STDOUT,\"%d\\n\",$ret);\n}\nreturn(0);\n?>"
  },
  {
    "language": "D",
    "code": "import std.stdio;\nimport std.algorithm;\n\nvoid main(){\n\twhile(true){\n\t\tint n;\n\t\treadf(\"%d\\n\", &n);\n\t\tif(n == 0) break;\n\t\tint[999] itime;\n\t\tbool[999] islogin;\n\t\titime[] = 0;\n\t\tislogin[] = false;\n\t\tint month=-1, date=-1;\n\t\tbool logined = false;\n\t\tint start;\n\t\twhile(n--){\n\t\t\tint m, d, hour, minute, p;\n\t\t\tint time;\n\t\t\tchar e;\n\t\t\treadf(\"%d/%d %d:%d %s %d\\n\", &m, &d, &hour, &minute, &e, &p);\n\t\t\ttime = 60*hour+minute;\n\t\t\tif(d != date || m != month){\n\t\t\t\tif(logined){\n\t\t\t\t\tforeach(i, b; islogin)\n\t\t\t\t\t\tif(b) itime[i] += 24*60-start;\n\t\t\t\t}\n\t\t\t\tlogined = false;\n\t\t\t\tdate = d; month = m;\n\t\t\t\tislogin[] = false;\n\t\t\t}\n\t\t\tif(e == 'I'){\n\t\t\t\tif(p == 0){\n\t\t\t\t\tlogined = true;\n\t\t\t\t\tstart = time;\n\t\t\t\t\tforeach(i, b; islogin)\n\t\t\t\t\t\tif(b) itime[i] -= time-start;\n\t\t\t\t}else{\n\t\t\t\t\tislogin[p-1] = true;\n\t\t\t\t\tif(logined)\titime[p-1] -= time-start;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(p == 0){\n\t\t\t\t\tlogined = false;\n\t\t\t\t\tforeach(i, b; islogin)\n\t\t\t\t\t\tif(b) itime[i] += time - start;\n\t\t\t\t}else{\n\t\t\t\t\tislogin[p-1] =  false;\n\t\t\t\t\tif(logined)\titime[p-1] += time-start;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint m = 0;\n\t\tforeach(i; itime) m = max(m, i);\n\t\twriteln(m);\n\t}\n}"
  },
  {
    "language": "D",
    "code": "import std.stdio;\nimport std.container;\nimport std.algorithm;\n\nvoid main(){\n\twhile(true){\n\t\tint n;\n\t\treadf(\"%d\\n\", &n);\n\t\tif(n == 0) break;\n\t\tint[1000] itime = 0;\n\t\tauto islogin = redBlackTree!(false,int)();\n\t\tint month=-1, date=-1;\n\t\tbool logined = false;\n\t\twhile(n--){\n\t\t\tint m, d, hour, minute, p;\n\t\t\tint time;\n\t\t\tchar e;\n\t\t\treadf(\"%d/%d %d:%d %s %d\\n\", &m, &d, &hour, &minute, &e, &p);\n\t\t\ttime = 60*hour+minute;\n\t\t\tif(d != date || m != month){\n\t\t\t\tif(logined)\n\t\t\t\t\tforeach(i; islogin)\n\t\t\t\t\t\titime[i] += 24*60;\n\t\t\t\tlogined = false;\n\t\t\t\tdate = d; month = m;\n\t\t\t\tislogin.clear();\n\t\t\t}\n\t\t\tif(e == 'I'){\n\t\t\t\tif(p == 0){\n\t\t\t\t\tlogined = true;\n\t\t\t\t\tforeach(i; islogin)\n\t\t\t\t\t\titime[i] -= time;\n\t\t\t\t}else{\n\t\t\t\t\tislogin.insert(p-1);\n\t\t\t\t\tif(logined)\titime[p-1] -= time;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(p == 0){\n\t\t\t\t\tlogined = false;\n\t\t\t\t\tforeach(i; islogin)\n\t\t\t\t\t\titime[i] += time;\n\t\t\t\t}else{\n\t\t\t\t\tislogin.removeKey(p-1);\n\t\t\t\t\tif(logined)\titime[p-1] += time;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\twriteln(reduce!max(0, itime));\n\t}\n}"
  },
  {
    "language": "D",
    "code": "import std.stdio;\nimport std.ascii;\nimport std.range;\nimport std.array;\nimport std.functional;\nimport std.algorithm;\nimport std.conv;\nimport std.container;\nimport std.math;\nimport std.numeric;\nimport std.string;\nimport std.c.string;\nimport std.random;\nimport std.regex;\nimport std.typecons;\n\nstruct Event {\n    string date;\n    int time;\n    string type;\n    string id;\n}\n\nvoid main() {\n    int N;\n    Event[] events;\n    bool input() {\n        scanf(\"%d\\n\", &N);\n        if (N == 0) return false;\n        events.destroy;\n        foreach (i; 0 .. N) {\n            int h, m;\n            string date;\n            string e, id;\n            auto x = readln.chomp.split;\n            date = x[0];\n            sscanf(x[1].ptr, \"%d:%d\", &h, &m);\n            e = x[2];\n            id = x[3];\n            int time = h * 60 + m;\n            events ~= Event(date, time, e, id);\n        }\n        return true;\n    }\n    void solve() {\n        struct S {\n            int time;\n            string id;\n        }\n        S[] Q1, Q2;\n        bool G;\n        string prev;\n        int[string] T;\n        foreach (e; events) {\n            static if (false) {\n                writeln(e);\n                writeln(\"\\t\", Q1);\n                writeln(\"\\t\", Q2);\n            }\n            if (e.date != prev) {\n                if (G) {\n                    foreach (q; Q1) {\n                        T[q.id] += e.time - q.time;\n                    }\n                }\n                G = false;\n                Q1.destroy;\n                Q2.destroy;\n                prev = e.date;\n            }\n            if (e.id == \"000\") {\n                if (e.type == \"I\") {\n                    foreach (q; Q2) {\n                        Q1 ~= S(e.time, q.id);\n                    }\n                    Q2.destroy;\n                    G = true;\n                } else {\n                    assert(e.type == \"O\");\n                    foreach (q; Q1) {\n                        T[q.id] += e.time - q.time;\n                        Q2 ~= S(e.time, q.id);\n                    }\n                    Q1.destroy;\n                    G = false;\n                }\n            } else {\n                if (e.type == \"I\") {\n                    (G ? Q1 : Q2) ~= S(e.time, e.id);\n                } else {\n                    S[] nQ;\n                    foreach (q; (G ? Q1 : Q2)) {\n                        if (q.id == e.id) {\n                            //writeln(e.id, \" out\");\n                            if (G) {\n                                T[q.id] += e.time - q.time;\n                            }\n                        } else {\n                            nQ ~= q;\n                        }\n                    }\n                    (G ? Q1 : Q2) = nQ.dup;\n                }\n            }\n        }\n        int Ans = 0;\n        foreach (k, v; T) {\n            Ans = max(Ans, v);\n        }\n        writeln(Ans);\n    }\n    while (input) solve;\n}"
  },
  {
    "language": "D",
    "code": "import std.stdio;\nimport std.ascii;\nimport std.range;\nimport std.array;\nimport std.functional;\nimport std.algorithm;\nimport std.conv;\nimport std.container;\nimport std.math;\nimport std.numeric;\nimport std.string;\nimport std.c.string;\nimport std.random;\nimport std.regex;\nimport std.typecons;\n\nstruct Event {\n    string date;\n    int time;\n    string type;\n    string id;\n}\n\nvoid main() {\n    int N;\n    Event[] events;\n    bool input() {\n        scanf(\"%d\\n\", &N);\n        if (N == 0) return false;\n        events.destroy;\n        foreach (i; 0 .. N) {\n            int h, m;\n            string date;\n            string e, id;\n            auto x = readln.chomp.split;\n            date = x[0];\n            sscanf(x[1].ptr, \"%d:%d\".ptr, &h, &m);\n            e = x[2];\n            id = x[3];\n            int time = h * 60 + m;\n            events ~= Event(date, time, e, id);\n        }\n        return true;\n    }\n    void solve() {\n        struct S {\n            int time;\n            string id;\n        }\n        S[] Q1, Q2;\n        bool G;\n        string prev;\n        int[string] T;\n        foreach (e; events) {\n            static if (false) {\n                writeln(e);\n                writeln(\"\\t\", Q1);\n                writeln(\"\\t\", Q2);\n            }\n            if (e.date != prev) {\n                if (G) {\n                    foreach (q; Q1) {\n                        T[q.id] += e.time - q.time;\n                    }\n                }\n                G = false;\n                Q1.destroy;\n                Q2.destroy;\n                prev = e.date;\n            }\n            if (e.id == \"000\") {\n                if (e.type == \"I\") {\n                    foreach (q; Q2) {\n                        Q1 ~= S(e.time, q.id);\n                    }\n                    Q2.destroy;\n                    G = true;\n                } else {\n                    assert(e.type == \"O\");\n                    foreach (q; Q1) {\n                        T[q.id] += e.time - q.time;\n                        Q2 ~= S(e.time, q.id);\n                    }\n                    Q1.destroy;\n                    G = false;\n                }\n            } else {\n                if (e.type == \"I\") {\n                    (G ? Q1 : Q2) ~= S(e.time, e.id);\n                } else {\n                    S[] nQ;\n                    foreach (q; (G ? Q1 : Q2)) {\n                        if (q.id == e.id) {\n                            //writeln(e.id, \" out\");\n                            if (G) {\n                                T[q.id] += e.time - q.time;\n                            }\n                        } else {\n                            nQ ~= q;\n                        }\n                    }\n                    (G ? Q1 : Q2) = nQ.dup;\n                }\n            }\n        }\n        writeln(T.reduce!max);\n    }\n    while (input) solve;\n}"
  },
  {
    "language": "Python",
    "code": "while 1:\n    n = int(raw_input())\n    if n == 0: break\n    exist = set([])\n    time = [0]*1000\n    bless = [0]*1000\n    for loop in xrange(n):\n        md,hm,io,p = raw_input().split()\n        h,m = map(int,hm.split(\":\"))\n        t = 60*h+m\n        p = int(p)\n        if io == \"I\":\n            time[p] = t\n            exist.add(p)\n        else:\n            exist.remove(p)\n            if p == 0:\n                for i in exist: bless[i] += t-max(time[p],time[i])\n            elif 0 in exist:\n                bless[p] += t-max(time[0],time[p])\n    print max(bless)\n    "
  },
  {
    "language": "Python",
    "code": "while 1:\n    n = input()\n    if n == 0:\n        break\n    status = {}\n    god_st = -1\n    res = {}\n    for i in xrange(n):\n        s = raw_input().split()\n        #M, D = map(int, s[0].split(\"/\"))\n        h, m = map(int, s[1].split(\":\"))\n        mi = 60*h + m\n        st = s[2] == 'I'\n        ID = s[3]\n\n        if ID == '000':\n            # goddness\n            if st == 1:\n                god_st = mi\n            else:\n                for k in status:\n                    if k != ID and status[k] != -1:\n                        res[k] = res.get(k, 0) + (mi - max(god_st, status[k]))\n                god_st = -1\n        else:\n            if st == 1:\n                status[ID] = mi\n            else:\n                if god_st != -1:\n                    res[ID] = res.get(ID, 0) + (mi - max(god_st, status[ID]))\n                status[ID] = -1\n    print max(res.values()) if res else 0"
  },
  {
    "language": "Python",
    "code": "while 1:\n    n = int(raw_input())\n    if n == 0: break\n    exist = set([])\n    enter = [0]*1000\n    bless = [0]*1000\n    for loop in xrange(n):\n        md,hm,io,p = raw_input().split()\n        h,m = map(int,hm.split(\":\"))\n        t = 60*h+m\n        p = int(p)\n        if io == \"I\":\n            enter[p] = t\n            exist.add(p)\n        else:\n            exist.remove(p)\n            if p == 0:\n                for i in exist: bless[i] += t-max(enter[p],enter[i])\n            elif 0 in exist:\n                bless[p] += t-max(enter[0],enter[p])\n    print max(bless)\n    "
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,random,time,copy,functools\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 10**9+7\ndd = [(0,-1),(1,0),(0,1),(-1,0)]\nddn = [(0,-1),(1,-1),(1,0),(1,1),(0,1),(-1,-1),(-1,0),(-1,1)]\n\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\n\n\ndef main():\n    rr = []\n\n    while True:\n        n = I()\n        if n == 0:\n            break\n        a = [LS() for _ in range(n)]\n        d = {}\n        e = collections.defaultdict(int)\n        b = []\n        for day,ts,f,i in a:\n            i = int(i)\n            ta = ts.split(':')\n            t = int(ta[0]) * 60 + int(ta[1])\n            if i == 0:\n                if f == 'I':\n                    for k in list(d.keys()):\n                        e[k] -= t - d[k]\n                    d[i] = t\n                else:\n                    del d[i]\n                    for k in list(d.keys()):\n                        e[k] += t - d[k]\n            else:\n                if f == 'I':\n                    d[i] = t\n                else:\n                    if 0 in d:\n                        e[i] += t - d[i]\n                    del d[i]\n        if len(e) == 0:\n            rr.append(0)\n        else:\n            rr.append(max(e.values()))\n\n    return '\\n'.join(map(str,rr))\n\n\nprint(main())\n\n\n"
  },
  {
    "language": "Python",
    "code": "while 1:\n    n = input()\n    if n == 0:\n        break\n    status = {}\n    god_st = 0\n    res = {}\n    for i in xrange(n):\n        s = raw_input().split()\n        #M, D = map(int, s[0].split(\"/\"))\n        h, m = map(int, s[1].split(\":\"))\n        mi = 60*h + m\n        st = s[2] == 'I'\n        ID = s[3]\n\n        if ID == '000':\n            # goddness\n            if st == 1:\n                god_st = mi\n            else:\n                for k in status:\n                    if k != ID and status[k] != -1:\n                        res[k] = res.get(k, 0) + (mi - max(god_st, status[k]))\n        else:\n            if st == 1:\n                status[ID] = mi\n            else:\n                status[ID] = -1\n    print max(res.values())"
  },
  {
    "language": "Python",
    "code": "while 1:\n    n = int(raw_input())\n    if n == 0: break\n    exist = set([])\n    enter = [0]*1000\n    bless = [0]*1000\n    for loop in xrange(n):\n        md,hm,io,p = raw_input().split()\n        h,m = map(int,hm.split(\":\"))\n        t = 60*h+m\n        p = int(p)\n        if io == \"I\":\n            time[p] = t\n            exist.add(p)\n        else:\n            exist.remove(p)\n            if p == 0:\n                for i in exist: bless[i] += t-max(enter[p],enter[i])\n            elif 0 in exist:\n                bless[p] += t-max(enter[0],enter[p])\n    print max(bless)\n    "
  },
  {
    "language": "Rust",
    "code": "extern crate core;\n\nuse std::str::FromStr;\nuse std::cmp::Ordering;\n\nstruct Istream {\n    line: Vec<String>,\n    position: usize\n}\ntype Parse<T: FromStr> = Result<T, T::Err>;\nimpl Istream {\n    fn new() -> Istream {\n        Istream {line:vec![], position: 0}\n    }\n    fn read_word(&mut self) -> &String {\n        if self.position == self.line.len() {\n            let mut line= String::new();\n            std::io::stdin().read_line(&mut line).ok();\n            self.line = line.split_whitespace().map(|x|x.to_string()).collect();\n            self.position = 0\n        }\n        let result = &self.line[self.position];\n        self.position += 1;\n        result\n    }\n    fn read(&mut self) -> String {\n        self.read_word().to_string()\n    }\n    fn get<T: FromStr>(&mut self) -> T {self.read_word().parse().ok().unwrap()}\n    fn read_usize(&mut self) -> usize {self.get()}\n    fn read_int(&mut self) -> i32 {self.get()}\n    fn read_long(&mut self) -> i64 {self.get()}\n    fn read_double(&mut self) -> f64 {self.get()}\n}\nfn tabulate<T, F>(count: usize, elements: &mut F) -> Vec<T> where F: FnMut(usize) -> T {\n    let mut result:Vec<T> = Vec::with_capacity(count);\n    for i in 0 .. count {\n        result.push(elements(i))\n    }\n    result\n}\nfn fill<T, F>(count: usize, generator: F) -> Vec<T> where F: Fn() -> T {\n    let mut result: Vec<T> = Vec::with_capacity(count);\n    for _i in 0 .. count {\n        result.push(generator())\n    }\n    result\n}\n#[derive(Eq, PartialEq, Copy, Clone)]\nstruct Time{\n    hour: i32,\n    minute: i32\n}\nimpl FromStr for Time {\n    type Err = ();\n    fn from_str(s: &str) -> Result<Self, Self::Err> {\n        let split:Vec<_> = s.split(\":\").map(|st|st.parse::<i32>()).collect();\n        if let (&Ok(h), &Ok(m)) = (&split[0], &split[1]) {\n            Ok(Time{hour: h, minute: m})\n        }else {\n            Err(())\n        }\n    }\n}\nimpl Time {\n    fn new() -> Time {\n        Time{hour: 0, minute: 0}\n    }\n    fn minute_from(&self, base: &Time) -> i32 {\n        self.hour * 60 + self.minute - base.hour * 60 - base.minute\n    }\n}\nimpl Ord for Time {\n    fn cmp(&self, other: &Self) -> Ordering {\n        if self.hour == other.hour {\n            self.minute.cmp(&other.minute)\n        }else {\n            self.hour.cmp(&other.minute)\n        }\n    }\n}\nimpl PartialOrd for Time {\n    fn partial_cmp(&self, other: &Time) -> Option<Ordering> {\n        Some(self.cmp(&other))\n    }\n\n    fn lt(&self, other: &Time) -> bool {\n        self.cmp(&other) == Ordering::Less\n    }\n\n    fn le(&self, other: &Time) -> bool {\n        self.cmp(&other) != Ordering::Greater\n    }\n\n    fn gt(&self, other: &Time) -> bool {\n        self.cmp(&other) == Ordering::Greater\n    }\n\n    fn ge(&self, other: &Time) -> bool {\n        self.cmp(&other) != Ordering::Less\n    }\n}\nenum State {\n    In, Out,\n}\nimpl FromStr for State {\n    type Err = ();\n\n    fn from_str(s: &str) -> Result<Self, Self::Err> {\n        match s {\n            \"I\" => Ok(State::In),\n            \"O\" => Ok(State::Out),\n            _ => Err(())\n        }\n    }\n}\nfn main() {\n    let mut input = Istream::new();\n    loop {\n        let n = input.read_usize();\n        if n == 0 {\n            break\n        }\n        let mut account = vec![0; 1000];\n        let mut is_appear = vec![false; 1000];\n        let mut is_presence = vec![false; 1000];\n        let mut last_time = vec![Time::new(); 1000];\n        let mut suspects = Vec::<usize>::new();\n        let mut goddess = false;\n        let mut stack: Vec<usize> = Vec::new();\n        for _ in 0 .. n {\n            let day = input.read();\n            let time = input.get::<Time>();\n            let state = input.get::<State>();\n            let id = input.read_usize();\n            match state {\n                State::In if id == 0 => {\n                    for i in suspects.iter().filter(|&x|is_presence[*x]) {\n                        last_time[*i] = time;\n                    }\n                    goddess = true;\n                }\n                State::In if goddess => {\n                    last_time[id] = time;\n                    is_presence[id] = true;\n                    if !is_appear[id] {\n                        is_appear[id] = true;\n                        suspects.push(id);\n                    }\n                }\n                State::In => {\n                    is_presence[id] = true;\n                    if !is_appear[id] {\n                        is_appear[id] = true;\n                        suspects.push(id);\n                    }\n                }\n                State::Out if id == 0 => {\n                    for i in suspects.iter().filter(|&x| is_presence[*x]) {\n                        account[*i] += time.minute_from(&last_time[*i]);\n                    }\n                    goddess = false;\n                }\n                State::Out if goddess => {\n                    account[id] += time.minute_from(&last_time[id]);\n                    is_presence[id] = false;\n                }\n                State::Out => {\n                    is_presence[id] = false;\n                }\n\n            }\n        }\n        println!(\"{}\", account.iter().max().unwrap());\n    }\n}\n"
  }
]