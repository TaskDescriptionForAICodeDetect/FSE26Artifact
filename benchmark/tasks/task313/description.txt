You need to write a program that computes the cost of the bridge construction plan with the lowest budget, while ensuring that exactly k proposals come from company A and exactly n - 1 - k proposals come from company B. The input consists of multiple datasets, where each dataset contains the number of islands, the total number of proposals, and the number of proposals reserved for company A. Each proposal is specified with the islands it connects, the cost of the bridge, and the company providing the proposal. Your task is to find the minimum cost of connecting all islands or indicate that it is impossible to do so considering the constraints.