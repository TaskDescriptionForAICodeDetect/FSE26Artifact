[
  {
    "language": "Scala",
    "code": "import scala.annotation.tailrec\nobject Main extends App {\n  import scala.io.StdIn._\n  val map = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\".zipWithIndex.map{case (c, i) ⇒ (1L << i, c)}.toMap\n  loop()\n  @tailrec def loop(): Unit = {\n    val Array(n, m, q) = readLine.trim.split(' ').map(_.toInt)\n    if (n == 0 && m == 0 && q == 0) return\n    val bulbs = Array.fill(m){(1L << n) - 1}\n    var switch = 0L\n    for (_ ← 0 until q){\n      val Array(s, b) = readLine.trim.split(' ')\n      switch ^= java.lang.Long.parseLong(s.reverse, 2)\n      for (i ← b.indices) {\n        bulbs(i) &= (if (b(i) == '1') switch else ~switch)\n      }\n    }\n    println(bulbs.map(map.getOrElse(_, '?')).mkString(\"\"))\n    loop()\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<cstring>\n#include<vector>\n#include<set>\n#include<list>\n#include<queue>\n#include<cmath>\n#include<functional>\n#include<algorithm>\n#define INF (1<<29)\n#define rep(i,n) for(int i=0;i<(n);i++)\nusing namespace std;\n\n\n\nint bits_ctz(unsigned long long b){\n\tb&=-b;\n\tint res=0;\n\tfor(int i=5;i>=0;i--){\n\t\tint shift=1<<i;\n\t\tif(b>>shift){\n\t\t\tb>>=shift;\n\t\t\tres|=shift;\n\t\t}\n\t}\n\treturn res;\n}\n\n\nint main(){\n\tint n,m,q;\n\tlong long maybe[1000];\n\twhile(cin>>n>>m>>q,n|m|q){\n\t\tfill_n(maybe,m,(1LL<<n)-1);\n\t\tlong long switches=0;\n\t\trep(i,q){\n\t\t\tlong long s=0,b=0;\n\t\t\tstring str;\n\t\t\tcin>>str;\n\t\t\trep(i,n)s|=(long long)(str[i]-'0')<<(i);\n\t\t\tcin>>str;\n\t\t\trep(i,m)b|=(long long)(str[i]-'0')<<(i);\n\t\t\tswitches^=s;\n\t\t\trep(i,m){\n\t\t\t\tif(b>>i&1){\n\t\t\t\t\tmaybe[i]&=switches;\n\t\t\t\t}else{\n\t\t\t\t\tmaybe[i]&=~switches;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\trep(i,m){\n\t\t\tif(maybe[i]==0 || (maybe[i]&maybe[i]-1)){\n\t\t\t\tcout<<'?';\n\t\t\t}else{\n\t\t\t\tint ctz=bits_ctz(maybe[i]);\n\t\t\t\tif(ctz<10)cout<<ctz;\n\t\t\t\telse cout<<char('A'+ctz-10);\n\t\t\t}\n\t\t}\n\t\tcout<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <utility>\n#include <cmath>\n#include <algorithm>\n#include <iostream>\n#include <sstream>\n#include <iomanip>\n#include <vector>\n#include <string>\n#define REP(i,n) for(int i=0;i<n;i++)\ntypedef long long ll;\nusing namespace std;\ntypedef vector<ll> vl;\ntypedef pair<ll,ll> pll;\ntypedef vector<pll> vpll;\ntypedef vector<string> vs;\n\nint main() \n{\n\tint n,m,q;\n\twhile(cin>>n>>m>>q&&!(n==0&&m==0&&q==0))\n\t{\n\t\tint a[1001][37]={};//スイッチの述べ回数\n\t\tint b[1001][1001]={};//ランプの延べ回数\n\t\t\n\t\tchar s[1001][37]={};\n\t\tchar t[1001][1001]={};\n\t\t\n\t\tfor(int i=0;i<q;i++)\n\t\t{\n\t\t\tcin>>s[i]>>t[i];\n\t\t\tfor(int j=0;j<n;j++)\n\t\t\t{\n\t\t\t\tif(i==0&&s[i][j]=='0'){a[i][j]=0;}\n\t\t\t\telse if(i==0&&s[i][j]=='1'){a[i][j]=1;}\n\t\t\t\telse if(i!=0&&s[i][j]=='0'){a[i][j]=a[i-1][j];}\n\t\t\t\telse if(i!=0&&s[i][j]=='1'){a[i][j]=a[i-1][j]+1;}\n\t\t\t}\n\t\t\t\n\t\t\tfor(int j=0;j<m;j++)\n\t\t\t{\n\t\t\t\tif(i==0&&t[i][j]=='0'){b[i][j]=0;}\n\t\t\t\telse if(i==0&&t[i][j]=='1'){b[i][j]=1;}\n\t\t\t\telse if(i!=0&&t[i][j]==t[i-1][j]){b[i][j]=b[i-1][j];}\n\t\t\t\telse if(i!=0&&t[i][j]!=t[i-1][j]){b[i][j]=b[i-1][j]+1;}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor(int j=0;j<m;j++)\n\t\t{\n\t\t\tint count(0),ans;\n\t\t\tfor(int k=0;k<n;k++)\n\t\t\t{\n\t\t\t\tif(b[q-1][j]==a[q-1][k])\n\t\t\t\t{\n\t\t\t\t\tbool flag=false;\n\t\t\t\t\tREP(l,q){if(b[l][j]!=a[l][k]){flag=true;break;}}\n\t\t\t\t\tif(!flag)\n\t\t\t\t\t{\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t\tans=k;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(count>1){break;}\n\t\t\t}\n\t\t\tchar x='A'+ans-10;\n\t\t\tif(count>1){cout<<'?';}\n\t\t\telse if(ans<10){cout<<ans;}\n\t\t\telse{cout<<x;}\n\t\t}\n\t\tcout<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i, n) for(int i = 0; i < (n); i++)\n#define repp(i, l, r) for(int i = (l); i < (r); i++)\n#define per(i, n) for(int i = ((n)-1); i >= 0; i--)\n#define perr(i, l, r) for(int i = ((r)-1); i >= (l); i--)\n#define all(x) (x).begin(),(x).end()\n#define MOD 1000000007\n#define IINF 1000000000\n#define LINF 1000000000000000000\n#define SP <<\" \"<<\n#define CYES cout<<\"Yes\"<<endl\n#define CNO cout<<\"No\"<<endl\n#define CFS cin.tie(0);ios::sync_with_stdio(false)\n\ntypedef long long LL;\ntypedef long double LD;\n\nint main(){\n  while(1){\n    LL n,m,q;\n    cin >> n >> m >> q;\n    if(n==0) return 0;\n    vector<LL> v(m,(1LL<<n)-1);\n    vector<int> swi(n,0);\n    rep(tt,q){\n      string s,t;\n      cin >> s >> t;\n      rep(i,n){\n        if(s[i]=='1') swi[i]=1-swi[i];\n      }\n      rep(i,m){\n        LL x=(1LL<<n)-1;\n        if(t[i]=='1'){\n          rep(j,n){\n            if(swi[j]==0) x^=(1LL<<j);\n          }\n        }else{\n          rep(j,n){\n            if(swi[j]==1) x^=(1LL<<j);\n          }\n        }\n        v[i]&=x;\n      }\n    }\n    rep(i,m){\n      int ans=-1;\n      rep(j,n){\n        if(v[i]&(1LL<<j)){\n          if(ans==-1) ans=j;\n          else ans=-2;\n        }\n      }\n      if(ans==-2) cout << '?';\n      else if(ans<10) cout << ans;\n      else cout << (char)(ans-10+'A');\n    }\n    cout << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define _GLIBCXX_DEBUG\n#include <iostream>\n#include <vector>\n#include <stdio.h>\n#include <bits/stdc++.h>\n\n\nusing namespace std;\n#define ll long long\n#define ld long double\n#define  P pair<ll,ll>\n#define FOR(i,n,m) for(ll i=n; i<(ll)m;i++)\n#define FORa(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define FORr(i,m,n) for(ll i=n; i>=(ll)m; i--)\n#define FORm(i,m) for(auto i=m.begin();i!=m.end();i++)\n#define FORs(i,st) for(auto i : st)\n#define REP(i,n) for(int i=0;i<(int)n;++i)\n#define ALL(c) (c).begin(), (c).end()\n#define VEC2(x,a,b) vector<vector<ll>> x = vector<vector<ll>>(a,vector<ll>(b,0))\n#define sortAl(v) sort(v.begin(),v.end())\n#define sortAlr(v) sort(v.begin(),v.end()); reverse(v.begin(),v.end())\n#define cinv(v,n,m) FOR(i,n,m) cin>>v.at(i)\n#define coutv(v,n,m) FOR(i,n,m) cout<<v.at(i) <<\" \"; cout<<endl\n#define cout(n) cout<<fixed<<setprecision(n)\n\nchar int_to_char(ll x){\n  if(x == -1) return '?';\n  else if(x<=9)return '0' + x;\n  else return 'A' + x - 10;\n}\n\n\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    ll n,m,q;\n    cin>>n>>m>>q;\n    while(n != 0){\n\n      vector<string> sw(q+1);\n      vector<string> light(q+1);\n      vector<ll> ans(m, -1);\n\n      FOR(i,0,n){\n        sw[0].push_back('0');\n      }\n      FOR(i,0,m){\n        light[0].push_back('0');\n      }\n\n      FOR(i,1,q+1){\n        cin>>sw[i]>>light[i];\n      }\n      q++;\n\n      FOR(i,1,q){\n        FOR(j,0,n){\n          if(sw[i-1][j] == '1' && sw[i][j] == '1') sw[i][j] = '0';\n          else if(sw[i-1][j] == '0' && sw[i][j] == '1') sw[i][j] = '1';\n          else if(sw[i-1][j] == '1' && sw[i][j] == '0') sw[i][j] = '1';\n        }\n      }\n\n      FOR(i,0,q){\n        FOR(j,i+1,q){\n          ll xor_1 = 0;\n          ll x1_po = 0;\n          ll xor_0 = 0;\n          ll x0_po = 0;\n          ll and_ = 0;\n          ll a_po = 0;\n          FOR(k,0,n){\n            if(sw[i][k] == '1' && sw[j][k] == '1'){\n              and_++;\n              a_po = k;\n            }\n            if((sw[i][k] == '0' && sw[j][k] == '1')){\n              xor_1++;\n              x1_po = k;\n            }\n            if((sw[i][k] == '1' && sw[j][k] == '0')){\n              xor_0++;\n              x0_po = k;\n            }\n\n          }\n\n          FOR(k,0,m){\n            if(and_ == 1){\n              if(light[i][k] == '1' && light[j][k] == '1') ans[k] = a_po;\n            }\n            if(xor_1 == 1){\n              if(light[i][k] == '0' && light[j][k] == '1') ans[k] = x1_po;\n            }\n            if(xor_0 == 1){\n              if(light[i][k] == '1' && light[j][k] == '0') ans[k] = x0_po;\n            }\n\n          }\n\n        }\n      }\n\n      vector<ll> used(n);\n      ll f=0;\n      FOR(i,0,m){\n        if(ans[i] != -1){\n          cout<<ans[i]<<endl;\n          if(used[ans[i]] == 0) f++;\n          used[ans[i]] = 1;\n        }\n      }\n\n      if(f == n-1){\n        FOR(i,0,m){\n          if(used[i] == 0){\n            FOR(j,0,m){\n              if(ans[j] == -1){\n                ans[j] = i;\n              }\n            }\n            break;\n          }\n        }\n      }\n\n      FOR(i,0,m){\n        cout<<int_to_char(ans[i]);\n      }\n      cout<<endl;\n\n      cin>>n>>m>>q;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n//ios::sync_with_stdio(false);cin.tie(0);cout.tie(0);\n//clock_t start=clock();clock_t end=clock();cout<<(double)(end-start)/CLOCKS_PER_SEC<<endl;\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef unsigned int ui;\ntypedef pair<int,int> pii;\ntypedef pair<pii,int> ppii;\ntypedef pair<int,pii> pipi;\ntypedef pair<ll,ll> pll;\ntypedef pair<pll,ll> ppll;\ntypedef pair<ll,pll> plpl;\ntypedef tuple<ll,ll,ll> tl;\ntypedef pair<double,double> pdd;\nll mod=1000000007;\nll mod2=998244353;\nll mod3=1000003;\nll mod4=998244853;\nll mod5=1000000009;\nll inf=1LL<<60;\ndouble pi=3.141592653589793238462643383279L;\ndouble eps=1e-9;\n#define rep(i,m,n) for(ll i=m;i<n;i++)\n#define rrep(i,n,m) for(ll i=n;i>=m;i--)\n#define srep(itr,st) for(auto itr=st.begin();itr!=st.end();itr++)\n#define mrep(itr,mp) for(auto itr=mp.begin();itr!=mp.end();itr++)\n#define Max(a,b) a=max(a,b)\n#define Min(a,b) a=min(a,b)\nint dh[4]={1,-1,0,0};\nint dw[4]={0,0,1,-1};\nint ddh[8]={-1,-1,-1,0,0,1,1,1};\nint ddw[8]={-1,0,1,-1,1,-1,0,1};\nll gcd(ll a,ll b){\n    if(a<b)swap(a,b);\n    if(b==0)return a;\n    if(a%b==0)return b;\n    return gcd(b,a%b);\n}\nll Pow(ll n,ll k){\n    ll ret=1;\n    ll now=n;\n    while(k>0){\n        if(k&1)ret*=now;\n        now*=now;\n        k/=2;\n    }\n    return ret;\n}\nll beki(ll n,ll k,ll md){\n  ll ret=1;\n  ll now=n;\n  while(k>0){\n    if(k%2==1){\n      ret*=now;\n      ret%=md;\n    }\n    now*=now;\n    now%=md;\n    k/=2;\n  }\n  return ret;\n}\nll gyaku(ll n,ll md){\n  return beki(n,md-2,md);\n}\nll popcount(ll n){\n    ll ret=0;\n    ll u=n;\n    while(u>0){\n        ret+=u%2;\n        u/=2;\n        \n    }\n    return ret;\n}\n\nint main(){\n    ios::sync_with_stdio(false);cin.tie(0);cout.tie(0);\n    for(;;){\n        int n,m,q;cin>>n>>m>>q;\n        if(n==0&&m==0&&q==0)return 0;\n        string s[q+1],t[q+1];\n        rep(i,1,q+1)cin>>s[i]>>t[i];\n        rep(i,0,n){\n            s[0]+=\"0\";\n        }\n        rep(i,0,m)t[0]+=\"0\";\n        rep(i,0,m){\n            bool ok[n];\n            fill(ok,ok+n,true);\n            rep(j,1,q+1){\n                int mae=t[j-1][i]-'0';\n                int now=t[j][i]-'0';\n                if(mae!=now){\n                    rep(k,0,n){\n                        if(s[j][k]=='0')ok[k]=false;\n                    }\n                }\n                else{\n                    rep(k,0,n){\n                        if(s[j][k]=='1')ok[k]=false;\n                    }\n                }\n                //rep(k,0,n)cout<<ok[k]<<\" \";\n                //cout<<endl;\n            }\n            int cnt=0;\n            int num;\n            rep(j,0,n){\n                if(ok[j]){\n                    cnt++;\n                    num=j;\n                    if(cnt>=2)break;\n                }\n            }\n            if(cnt!=1)cout<<\"?\";\n            else{\n                if(num<=9)cout<<num;\n                else{\n                    char ans='A';\n                    ans+=num-10;\n                    cout<<ans;\n                }\n            }\n        }\n        cout<<endl;\n    }\n}\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\nusing namespace std;\n\nint main() {\n\n  while( true ) {\n\n    long long int n, m, q;\n    cin >> n >> m >> q;\n    if ( n == 0 ) break;\n\n    string k = \"0\";\n    for ( long long int i = 0; i < q; i++ ) {\n      k += \"0\";\n    }\n\n    vector< string > s;\n    for ( long long int i = 0; i < n; i++ ) {\n      s.push_back( k );\n    }\n\n    vector< string > b;\n    for ( long long int i = 0; i < m; i++ ) {\n      b.push_back( k );\n    }\n\n    for ( long long int i = 0; i < q; i++ ) {\n\n      string in_s, in_b;\n      cin >> in_s >> in_b;\n\n      for ( long long int j = 0; j < n; j++ ) {\n\ts[j][i+1] = '0' + ( s[j][i] - '0' ) ^ ( in_s[j] - '0' );\n      }\n\n      for ( long long int j = 0; j < m; j++ ) {\n\tb[j][i+1] = in_b[j];\n      }\n\n    }\n\n    for ( long long int i = 0; i < m; i++ ) {\n\n      long long int ans = -1;\n\n      for ( long long int j = 0; j < n; j++ ) {\n\n\tif ( s[j] == b[i] ) {\n\t  if ( ans == -1 ) {\n\t    ans = j;\n\t  }else {\n\t    ans = -1;\n\t    break;\n\t  }\n\t}\n\n      }\n\n      char c;\n      if ( ans == -1 ) {\n\tc = '?';\n      }else {\n\tif ( ans <= 9 ) {\n\t  c = ans + '0';\n\t}else {\n\t  c = ( ans - 10 ) + 'A';\n\t}\n      }\n      cout << c;\n\n    }\n\n    cout << endl;\n\n  }\n\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<cstdio>\n#include<map>\n#include<algorithm>\n#include<string>\n#include<cmath>\n\nusing namespace std;\nint main(){\n\tint N,M,Q;\n\tstring S,B;\n\tstring C;\n\tint offF =0,onF=0;\n\tint *offi,*oni;\n\tstring sigma =\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\n\n\twhile(1){\n\t\tcin >> N >> M >> Q;\n\t\tif(N==0 && M==0 && Q==0)break;\n\t\tC=\"\";\n\t\toffi = new int[M];\n\t\toni = new int[M];\n\t\tfor(int i=0;i<M;i++){\n\t\t\tC+=\"?\";\n\t\t\toffi[i]=-1;\n\t\t\toni[i]=-1;\n\t\t}\n\t\t//0会の時\n\t\tif(Q==0){\n\t\t\tif(M==1){\n\t\t\t\tcout << 0 <<endl;\n\t\t\t\tcontinue;\n\t\t\t}else{\n\t\t\t\tcout << C << endl;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\toffF =0,onF=0;\n\t\tcin>>S>>B;\n\t\t//最初の一回\n\t\tchar off='?',on='?';\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(S[i]=='0') {\n\t\t\t\toffF++;\n\t\t\t\tif(offF==1) off=sigma[i];\n\t\t\t}if(S[i]=='1'){\n\t\t\t\tonF++;\n\t\t\t\tif(onF==1) on=sigma[i];\n\t\t\t}  \n\t\t}\n\t\tif(offF==1){\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='0'){\n\t\t\t\t\tC[i]=off;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tif(onF==1){\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='1'){\n\t\t\t\t\tC[i]=on;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\t//2~n-1まで\n\t\tstring prevB = \"\";\n\t\tfor(int k=0;k<M;k++){ prevB += B[k];}\n\t\tstring B2 = \"\";\n\t\tfor(int q=1;q<Q;q++){\n\t\t\toffF =0,onF=0;\n\t\t\tB2 = \"\";\n\t\t\tcin>>S>>B;\n\t\t\t//cout<< S <<endl;\n\t\t\t//cout<< \"B:\" <<B <<endl;\n\t\t\t//cout<< \"prevB:\" << prevB <<endl;\n\t\t\t//cout<< \"C:\" << C <<endl;\n\n\t\t\tfor(int j=0;j<M;j++){\n\t\t\t\tB2 += sigma[abs(prevB[j] - B[j])];\n\t\t\t}\n\t\t\t//cout << \"B2:\" << B2 << endl;\n\t\t\tchar off,on;\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='0' && C[i]=='?') {\n\t\t\t\t\toffF++;\n\t\t\t\t\tif(offF==1) off=sigma[i];\n\t\t\t\t}\n\t\t\t\tif(S[i]=='1' && C[i]=='?'){\n\t\t\t\t\tonF++;\n\t\t\t\t\tif(onF==1) on=sigma[i];\n\t\t\t\t}  \n\t\t\t}\n\t\t\t//cout << \"flag : \" << offF << onF << endl;\n\n\t\t\tif(offF==1){\n\t\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\t\tif(S[i]=='0'){\n\t\t\t\t\t\tfor(int j=0; j<M; j++){\n\t\t\t\t\t\t\tif(B2[j] == '0' && C[j]=='?'){ \n\t\t\t\t\t\t\t\tC[j] = off;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t}\n\t\t\tif(onF==1){\n\t\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\t\tif(S[i]=='1'){\n\t\t\t\t\t\tfor(int j=0; j<M; j++){\n\t\t\t\t\t\t\tif(B2[j] == '1' && C[j]=='?'){ \n\t\t\t\t\t\t\t\tC[j] = on;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\t\n\t\t\t}\n\t\t\tprevB = B;\n\n\t\t}\n\t\t\n\t\tint *check = new int[N];\n\t\tint a=0,flg=0;\n\t\tfor(int i=0;i<N;i++) check[i] = 0;\n\n\t\tfor(int i=0; i<M; i++){\n\t\t\tcheck[(int)(C[i]-'0')] = 1;\n\t\t}\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(check[i]==0){\n\t\t\t\t// a = i;\n\t\t\t\tflg++;\n\t\t\t}\n\t\t}\n\t\tif(flg==1){\n\t\t\tfor(int i=0; i<M; i++){\n\t\t\t\tif(C[i]=='?') C[i] = sigma[a];\n\t\t\t}\n\t\t}\n\n\t\tcout << C << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#define Q 1000\n#define N 36\nusing namespace std;\n\nint main(){\n  int n,m,q;\n  bool sw[N],swcp[N],licp[Q],s_[N];\n  string s[Q],b[Q];\n  vector<int> on,off,r;\n  char ans[Q];\n  while(1){\n    cin>>n>>m>>q;\n    if(!n&&!m&&!q) break;\n    for(int i=0;i<q;i++) cin>>s[i]>>b[i];\n    for(int i=0;i<n;i++) sw[i]=s_[i]=false;\n    for(int i=0;i<m;i++) licp[i]=false,ans[i]='?';\n    for(int i=0;i<q;i++){\n      for(int j=0;j<n;j++){\n\tswcp[j]=sw[j];\n\tif(s[i][j]=='1') sw[j]?sw[j]=false:sw[j]=true;\n      }\n      for(int j=0;j<n;j++){\n\tif(swcp[j]&&sw[j]) r.push_back(j);\n\tif(swcp[j]&&!sw[j]) off.push_back(j);\n\tif(!swcp[j]&&sw[j]) on.push_back(j);\n      }\n      if(r.size()==1){\n\tfor(int j=0;j<m;j++)\n\t  if(licp[j]&&(b[i][j]-'0')){\n\t    if(r[0]+'0'<='9') ans[j]=r[0]+'0';\n\t    else ans[j]=r[0]-10+'A';\n\t  }\n\ts_[r[0]]=true;\n      }\n      if(off.size()==1){\n\tfor(int j=0;j<m;j++)\n\t  if(licp[j]&&!(b[i][j]-'0')){\n\t    if(off[0]+'0'<='9') ans[j]=off[0]+'0';\n\t    else ans[j]=r[0]-10+'A';\n\t  }\n\ts_[off[0]]=true;\n      }\n      if(on.size()==1){\n\tfor(int j=0;j<m;j++)\n\t  if(!licp[j]&&(b[i][j]-'0')){\n\t    if(on[0]+'0'<='9') ans[j]=on[0]+'0';\n\t    else ans[j]=r[0]-10+'A';\n\t  }\n\ts_[on[0]]=true;\n      }\n      for(int j=0;j<m;j++) licp[j]=b[i][j]-'0';\n      r.clear();\n      on.clear();\n      off.clear();\n    }\n    int cnt=0;\n    char a;\n    for(int i=0;i<n;i++)\n      if(!s_[i]){\n\tcnt++;\n\tif(i+'0'<='9') a=i+'0';\n\telse a=i-10+'A';\n      }\n    if(cnt==1)\n      for(int j=0;j<m;j++)\n\tif(ans[j]=='?') ans[j]=a;\n    for(int i=0;i<m;i++)\n      cout<<ans[i];\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n \n#define N 36\n#define M 1000\n \nusing  namespace std;\n \nvoid detect_wrong(bool is_candidate[N][M], bool switch_is_on[N], bool bulb_is_on[M], int n, int m) {\n  for (int i=0; i<m; i++) {\n    if (bulb_is_on[i]) {\n      continue;\n    }\n    for (int j=0; j<n; j++) {\n      if (switch_is_on[j]) {\n        is_candidate[j][i] = false;\n      }\n    }\n  }\n  for (int i=0; i<n; i++) {\n    if (switch_is_on[i]) {\n      continue;\n    }\n    for (int j=0; j<m; j++) {\n      if (bulb_is_on[j]) {\n        is_candidate[i][j] = false;\n      }\n    }\n  }\n}\n \nvoid print_result(bool is_candidate[N][M], int n, int m) {\n  for (int i=0; i<m; i++) {\n    bool is_multiple = false;\n    int switch_num = -1;\n    for (int j=0; j<n; j++) {\n      if (is_candidate[j][i]) {\n        if (switch_num < 0) {\n          switch_num = j;\n        }\n        else {\n          is_multiple = true;\n        }\n      }\n    }\n    if (is_multiple) {\n      cout << '?';\n    }\n    else if (switch_num < 0) {\n      cout << '?';\n    }\n    else if (switch_num < 10) {\n      cout << (char)(switch_num+'0');\n    }\n    else {\n      cout << (char)(switch_num+'A'-10);\n    }\n  }\n  cout << endl;\n}\n \nint main() {\n  int n, m, q;\n  string s, b;\n  bool switch_is_on[N], bulb_is_on[M];\n  bool is_candidate[N][M];\n  while (true) {\n    cin >> n >> m >> q;\n    if (n == 0) {\n      return 0;\n    }\n    for (int i=0; i<n; i++) {\n      switch_is_on[i] = false;\n      for (int j=0; j<m; j++) {\n        is_candidate[i][j] = true;\n      }\n    }\n    for (int i=0; i<m; i++) {\n      bulb_is_on[i] = false;\n    }\n    for (int i=0; i<q; i++) {\n      cin >> s >> b;\n      for (int j=0; j<n; j++) {\n        if (s[j] == '1') {\n          switch_is_on[j] = !switch_is_on[j];\n        }\n      }\n      for (int j=0; j<m; j++) {\n        if (b[j] == '1') {\n          bulb_is_on[j] = true;\n        }\n        else {\n          bulb_is_on[j] = false;\n        }\n      }\n      detect_wrong(is_candidate, switch_is_on, bulb_is_on, n, m);\n    }\n    print_result(is_candidate, n, m);\n  }\n}\n "
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<cstdio>\n#include<map>\n#include<algorithm>\n#include<string>\n#include<cmath>\n\nusing namespace std;\nint main(){\n\tint N,M,Q;\n\tstring S,B;\n\tstring C;\n\tint offF =0,onF=0;\n\tint *offi,*oni;\n\tstring sigma =\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\n\n\twhile(1){\n\t\tcin >> N >> M >> Q;\n\t\tif(N==0 && M==0 && Q==0)break;\n\t\tC=\"\";\n\t\toffi = new int[M];\n\t\toni = new int[M];\n\t\tfor(int i=0;i<M;i++){\n\t\t\tC+=\"?\";\n\t\t\toffi[i]=-1;\n\t\t\toni[i]=-1;\n\t\t}\n\t\t//0会の時\n\t\tif(Q==0){\n\t\t\tif(M==1){\n\t\t\t\tcout << 0 <<endl;\n\t\t\t\tcontinue;\n\t\t\t}else{\n\t\t\t\tcout << C << endl;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\toffF =0,onF=0;\n\t\tcin>>S>>B;\n\t\t//最初の一回\n\t\tchar off='?',on='?';\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(S[i]=='0') {\n\t\t\t\toffF++;\n\t\t\t\tif(offF==1) off=sigma[i];\n\t\t\t}if(S[i]=='1'){\n\t\t\t\tonF++;\n\t\t\t\tif(onF==1) on=sigma[i];\n\t\t\t}  \n\t\t}\n\t\tif(offF==1){\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='0'){\n\t\t\t\t\tC[i]=off;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tif(onF==1){\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='1'){\n\t\t\t\t\tC[i]=on;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\t//2~n-1まで\n\t\tstring prevB = \"\";\n\t\tfor(int k=0;k<M;k++){ prevB += B[k];}\n\t\tstring B2 = \"\";\n\t\tfor(int q=1;q<Q;q++){\n\t\t\toffF =0,onF=0;\n\t\t\tB2 = \"\";\n\t\t\tcin>>S>>B;\n\t\t\t//cout<< S <<endl;\n\t\t\t//cout<< \"B:\" <<B <<endl;\n\t\t\t//cout<< \"prevB:\" << prevB <<endl;\n\t\t\t//cout<< \"C:\" << C <<endl;\n\n\t\t\tfor(int j=0;j<M;j++){\n\t\t\t\tB2 += sigma[abs(prevB[j] - B[j])];\n\t\t\t}\n\t\t\t//cout << \"B2:\" << B2 << endl;\n\t\t\tchar off,on;\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='0' && C[i]=='?') {\n\t\t\t\t\toffF++;\n\t\t\t\t\tif(offF==1) off=sigma[i];\n\t\t\t\t}\n\t\t\t\tif(S[i]=='1' && C[i]=='?'){\n\t\t\t\t\tonF++;\n\t\t\t\t\tif(onF==1) on=sigma[i];\n\t\t\t\t}  \n\t\t\t}\n\t\t\t//cout << \"flag : \" << offF << onF << endl;\n\n\t\t\tif(offF==1){\n\t\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\t\tif(S[i]=='0'){\n\t\t\t\t\t\tfor(int j=0; j<M; j++){\n\t\t\t\t\t\t\tif(B2[j] == '0' && C[j]=='?'){ \n\t\t\t\t\t\t\t\tC[j] = off;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t}\n\t\t\tif(onF==1){\n\t\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\t\tif(S[i]=='1'){\n\t\t\t\t\t\tfor(int j=0; j<M; j++){\n\t\t\t\t\t\t\tif(B2[j] == '1' && C[j]=='?'){ \n\t\t\t\t\t\t\t\tC[j] = on;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\t\n\t\t\t}\n\t\t\tprevB = B;\n\n\t\t}\n\t\t\n\t\tint *check = new int[M];\n\t\tint a,flg=0;\n\t\tfor(int i=0;i<M;i++) check[i] = 0;\n\n\t\tfor(int i=0; i<M; i++){\n\t\t\tcheck[(int)(C[i]-'0')] = 1;\n\t\t}\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(check[i]==0){\n\t\t\t\ta = i;\n\t\t\t\tflg++;\n\t\t\t}\n\t\t}\n\t\tif(flg==1){\n\t\t\tfor(int i=0; i<M; i++){\n\t\t\t\tif(C[i]=='?') C[i] = sigma[a];\n\t\t\t}\n\t\t}\n\n\t\tcout << C << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n\n#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stdio.h>\n#include <string.h>\n#define rep(i,n) for(int i =0;i<n;i++)\nusing namespace std;\ntypedef long long int ll;\n\nchar dto36(int n){\n    if (0 <= n and n <= 9 ) {\n        return (char)(n + (int)'0');\n    }\n    if(10 <= n and n <= 36){\n        return (char)(n-10 + (int)'A');\n    }\n    return '?';\n}\n\nint main(){\n    int N,M,Q;\n    while (cin >> N >> M >>Q && N) {\n        if(N==1 and M==1){\n            cout << 0 << endl;\n            continue;\n        }\n        int g[N][M];\n        for (int i=0;i<N;i++) {\n            for (int j=0; j<M; j++) {\n                g[i][j]=2;\n            }\n        }\n        string bs=\"\",bb=\"\";\n        for (int i=0; i<M; i++) {\n            bs += \"0\";\n            bb += \"0\";\n        }\n        for (int q=0;q<Q; q++) {\n            string s,b;\n            cin >> s >> b;\n            for (int i=0; i<N; i++) {\n                for (int j=0; j<M; j++) {\n                    if (s[i]=='1' and b[j]!=bb[j] and g[i][j]!=0) {\n                        g[i][j] = 1;\n                    }\n                    if (s[i]=='0' and b[j]!=bb[j]) {\n                        g[i][j] = 0;\n                    }\n                    if (s[i]=='1' and b[j]==bb[j]) {\n                        g[i][j] = 0;\n                    }\n                    if (s[i]=='0' and b[j]==bb[j] and g[i][j]!=0) {\n                        g[i][j] = 1;\n                    }\n                    \n                }\n            }\n            bs = s;\n            bb = b;\n        }\n        \n        for (int i=0; i<M; i++) {\n            int ch = 0, rep=-1;\n            for (int j=0; j<N; j++) {\n                if(g[j][i]==1){\n                    rep = j;\n                    ch++;\n                }\n            }\n            if (ch == 1) {\n                cout << dto36(rep);\n            }else{\n                cout << '?';\n            }\n        }\n        cout << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\nusing namespace std;\n \n#define REP(i,n) for(int i=0; i<n; ++i)\n#define FOR(i,a,b) for(int i=a; i<=b; ++i)\n#define FORR(i,a,b) for (int i=a; i>=b; --i)\n#define pi M_PI\n \ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef vector<VI> VVI;\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> PL;\n\n\nint main() {\n    int n, m, q;\n    string poyo = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\n    while (cin >> n >> m >> q && n) {\n        VVI a(n, VI(m,1));\n        VI l(m);\n        while (q--){\n            string s, t;\n            cin >> s >> t;\n            REP(j,m){\n                int x = t[j] - '0';\n                x ^= l[j];\n                l[j] = (t[j] - '0');\n                REP(i,n){\n                    int y = s[i] - '0';\n                    y ^= (x ^ 1);\n                    a[i][j] &= y;\n                }\n            }\n        }\n        REP(j,m){\n            char c;\n            int p = 0;\n            REP(i,n){\n                if (a[i][j]){\n                    c = poyo[i];\n                    p++;\n                }\n            }\n            if (p == 1) cout << c;\n            else cout << '?';\n        }\n        cout << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint N,M,Q;\nunsigned long ans[1003];\nvoid plot() {\n    rep(i,M) {\n        int count=0;\n        int val;\n        rep(j,N) {\n            if(((ans[i])>>j)&1) {\n                count++;\n                val=j;\n            }\n        }\n        if(count==1) {\n            if(val<10) printf(\"%d\",val);\n            else printf(\"%c\",'A'+val-10);\n        }\n        else cout<<\"?\";\n    }\n    cout<<endl;\n}\n\nvoid update(unsigned long& mask, string S, string B) {\n    unsigned long bit=0;\n    rep(i,N) if(S[i]=='1') bit|=1L<<i;\n    mask^=bit;\n    // printf(\"%s->%s : %lx\\n\", stateS.c_str(),S.c_str(),bit);\n    rep(i,M) {\n        if(B[i] == '1') {\n            ans[i] &= mask;\n        }\n        else {\n            ans[i] &= ~mask;\n        }\n    }\n}\n\n\nvoid solve() {\n    \n    rep(i,1003) ans[i]=(1<<N)-1;\n    unsigned long mask=0;\n    string S,B;\n    rep(i,Q) {\n        cin>>S>>B;\n        update(mask, S,B);\n\n        // rep(i,M) cout<<ans[i]<<\",\";\n        // cout<<endl;\n    }\n\n\n    plot();\n\n}\n\nint main() {\n    while(cin>>N>>M>>Q) {\n        if(N+M+Q==0) break;\n        solve();\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <bits/stdc++.h>\nusing namespace std;\nint n, m, q;\nvoid solve() {\n  string cur;\n  for (int j = 0; j < m; j++) cur += '0';\n  vector<vector<int>> c(m, vector<int>(n, 1));\n  while (q--) {\n    string s, t;\n    cin >> s >> t;\n    for (int i = 0; i < n; i++) {\n      for (int j = 0; j < m; j++) {\n        if (t[j] != cur[j]) {\n          if (s[i] == '0') c[j][i] = 0;\n        } else {\n          if (s[i] == '1') c[j][i] = 0;\n        }\n      }\n    }\n    cur = t;\n  }\n  string ans;\n  for (int j = 0; j < m; j++) {\n    int cnt = 0;\n    char r;\n    for (int i = 0; i < n; i++) {\n      cnt += c[j][i];\n      if (c[j][i]) {\n        if (i < 10) r = i + '0';\n        else r = 'A' + i - 10;\n      }\n    }\n    if (cnt > 1) ans += '?';\n    else ans += r;\n  }\n  cout << ans << '\\n';\n}\nsigned main() { \n  ios::sync_with_stdio(false); cin.tie(0);\n  while (cin >> n) {\n    cin >> m >> q;\n    if (n == 0) {\n      return 0;\n    } else {\n      solve();\n    }\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\nusing ll = long long;\nusing ld = long double;\nusing P = pair<int, int>;\nconstexpr ld EPS = 1e-12;\nconstexpr int INF = numeric_limits<int>::max() / 2;\nconstexpr int MOD = 1e9 + 7;\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    int n, m, q;\n    while (cin >> n >> m >> q, n || m || q)\n    {\n        string s, b;\n        vector<char> state(n, '0');\n        // check[i][j] := i 番目の switch と j 番目の buld が接続されているかも\n        vector<vector<int>> check(n, vector<int>(m, 1));\n        for (int k = 1; k <= q; k++)\n        {\n            cin >> s >> b;\n            for (int i = 0; i < n; i++)\n            {\n                if (s[i] == '1')\n                {\n                    if (state[i] == '0')\n                        state[i] = '1';\n                    else\n                        state[i] = '0';\n                }\n                for (int j = 0; j < m; j++)\n                {\n                    if (state[i] != b[j])\n                        check[i][j] = 0;\n                }\n            }\n        }\n        for (int j = 0; j < m; j++)\n        {\n            int res = -1;\n            bool hatena = false;\n            for (int i = 0; i < n; i++)\n            {\n                if (check[i][j] == 0)\n                    continue;\n                if (res != -1)\n                    hatena = true;\n                else\n                    res = i;\n            }\n            if (hatena)\n                cout << \"?\";\n            else if (res <= 9)\n                cout << res;\n            else\n            {\n                cout << char('A' + (res - 10));\n            }\n        }\n        cout << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\nusing namespace std;\n\nint main(){\n    int n, m, q;\n    while(cin >> n >> m >> q, n||m||q){\n        int a[37][1005];\n        memset(a, -1, sizeof(a)); //1:テ・ツ渉ッティツδステヲツ?ァテ」ツ?づ」ツつ?0:テ・ツ渉ッティツδステヲツ?ァテ」ツ?ェテ」ツ??-1:テ」ツつ湘」ツ?凝」ツつ嘉」ツ?ェテ」ツ??\n\n        if(q == 0 && n == 1 && m == 1){\n            cout << 0 << endl;\n            continue;\n        }\n        string sb, bb;\n        rep(i,n) sb+='0';\n        rep(j,m) bb+='0';\n        rep(i,q){\n            string s, b;\n            cin >> s >> b;\n            rep(j,n){\n                if(s[j] == '1'){\n                    rep(k,m){\n                        if(b[k] != bb[k]){\n                            //cout << j << ' ' << k << endl;\n                            if(a[j][k] != 0) a[j][k] = 1;\n                        }else{\n                            if(a[j][k] != 0) a[j][k] = 0;\n                        }\n                    }\n                }else{\n                    rep(k,m){\n                        if(b[k] != bb[k]){\n                            //cout << j << ' ' << k << endl;\n                            if(a[j][k] != 0) a[j][k] = 0;\n                        }else{\n                            if(a[j][k] != 0) a[j][k] = 1;\n                        }\n                    }\n                }\n            }\n            sb = s;\n            bb = b;\n        //rep(i,3){ rep(j,10){ cout << a[i][j]; } cout << endl; } cout << endl;\n        }\n\n        string ans = \"\";\n        rep(j,m){\n            char c = '?';\n            rep(i,n){\n                if(a[i][j] == 1){\n                    if(c == '?'){\n                        if(i >= 0 && i <= 9) c = i + '0';\n                        else c = (i - 10) + 'A';\n                    }\n                }else if(a[i][j] == -1){\n                    c = '?';\n                    break;\n                }\n            }\n            ans += c;\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define INF_LL (int64)1e18\n#define INF (int32)1e9\n#define REP(i, n) for(int64 i = 0;i < (n);i++)\n#define FOR(i, a, b) for(int64 i = (a);i < (b);i++)\n#define all(x) x.begin(),x.end()\n#define fs first\n#define sc second\n\nusing int32 = int_fast32_t;\nusing uint32 = uint_fast32_t;\nusing int64 = int_fast64_t;\nusing uint64 = uint_fast64_t;\nusing PII = pair<int32, int32>;\nusing PLL = pair<int64, int64>;\n\nconst double eps = 1e-10;\n\ntemplate<typename A, typename B>inline void chmin(A &a, B b){if(a > b) a = b;}\ntemplate<typename A, typename B>inline void chmax(A &a, B b){if(a < b) a = b;}\n\ntemplate<typename T>\nvector<T> make_v(size_t a){return vector<T>(a);}\n\ntemplate<typename T,typename... Ts>\nauto make_v(size_t a,Ts... ts){\n    return vector<decltype(make_v<T>(ts...))>(a,make_v<T>(ts...));\n}\n\ntemplate<typename T,typename U,typename... V>\ntypename enable_if<is_same<T, U>::value!=0>::type\nfill_v(U &u,const V... v){u=U(v...);}\n\ntemplate<typename T,typename U,typename... V>\ntypename enable_if<is_same<T, U>::value==0>::type\nfill_v(U &u,const V... v){\n    for(auto &e:u) fill_v<T>(e,v...);\n}\n\nint main(void){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    int64 N, M, Q;\n    while (cin >> N >> M >> Q && N+M+Q) {\n        vector<string> S(Q), B(Q+1);\n        vector<vector<char>> res(M);\n\n        B[0] = string(M, '0');\n        REP(i, Q) cin >> S[i] >> B[i+1];\n        REP(i, N) {\n            vector<int> nxt(M);\n            iota(all(nxt), 0);\n            REP(j, Q) {\n                vector<int> nxt2;\n                for (auto &k : nxt) {\n                    if ((B[j + 1][k] != B[j][k]) == (S[j][i] == '1'))\n                        nxt2.push_back(k);\n                }\n                swap(nxt, nxt2);\n            }\n            for (auto &k : nxt) {\n                if (i < 10)\n                    res[k].push_back(i+'0');\n                else\n                    res[k].push_back(i-10+'A');\n            }\n        }\n        REP(i, M) {\n            if (res[i].size() != 1) cout << '?';\n            else cout << res[i][0];\n        }\n        cout << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long lli;\n\nconst lli MAXQ = 1001;\nlli N, M, Q;\nlli S[MAXQ];\nstring B[MAXQ];\n\nlli builtin_popcount(lli x) {\n  lli res = 0;\n  while(x) {\n    res += x & 1;\n    x >>= 1;\n  }\n  return res;\n}\n\nint main() {\n  while(cin >> N >> M >> Q && (N|M|Q)) {\n    for(lli i = 0; i < Q; ++i) {\n      string s;\n      cin >> s >> B[i];\n      S[i] = 0;\n      for(lli j = 0; j < s.size(); ++j) {\n        S[i] |= (lli)(s[j]-'0') << (lli)j;\n      }\n      if(i) S[i] ^= S[i-1];\n    }\n    for(lli k = 0; k < M; ++k) {\n      lli sum = (1LL<<N) - 1;\n      for(lli i = 0; i < Q; ++i) {\n        if(B[i][k] == '1') sum &= S[i];\n        else sum &= ~S[i];\n      }\n      if(builtin_popcount(sum) == 1) {\n        lli num = -1;\n        while(sum) sum >>= 1LL, ++num;\n        if(num < 10) cout << num;\n        else cout << (char)('A' + num - 10);\n      } else {\n        cout << \"?\";\n      }\n    }\n    cout << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\n#include <math.h>\n#include <set>\n#include <map>\n#include <string>\n#include <stack>\n#include <queue>\n#include <iomanip>\n#include <numeric>\n#include <tuple>\n#include <bitset>\n#include <complex>\n#include <unistd.h>\n#include <cassert>\n#include <cctype>\n#include <random>\n#define _USE_MATH_DEFINES\n#define _GLIBCXX_DEBUG\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> plglg;\ntypedef tuple<int, int, int> tiii;\ntypedef tuple<ll, ll, ll> tlglglg;\ntypedef complex<double> xy_t;\nint dx[4] = {1, 0, -1, 0};\nint dy[4] = {0, 1, 0, -1};\ndouble pi = 3.141592653589793;\nll mod = 1000000007;\nint intmax = 2147483647;\nint intmin = -2147483648;\nll llmax = 9223372036854775807;\nll llmin = -9223372036854775807;\nint iinf = intmax / 8;\nll inf = llmax / 8;\ndouble eps = 1e-11;\n\nchar moji(int i) {\n    if (i <= 9) {\n        return i + '0';\n    } else {\n        return (i - 10) + 'A';\n    }\n}\n\nint main() {\n    while (1) {\n        int N, M, Q;\n        cin >> N >> M >> Q;\n        if (N == 0) {\n            break;\n        }\n        bool bo[N][M];\n        for (int i = 0; i < N; i++) {\n            fill(bo[i], bo[i] + M, true);\n        }\n        bool swi[N];\n        fill(swi, swi + N, false);\n        for (int i = 0; i < Q; i++) {\n            string s, b;\n            cin >> s >> b;\n            for (int j = 0; j < N; j++) {\n                if (s[j] == '1') {\n                    swi[j] = !swi[j];\n                }\n                char c = (swi[j]) ? '1' : '0';\n                for (int k = 0; k < M; k++) {\n                    if (b[k] != c) {\n                        bo[j][k] = false;\n                    }\n                }\n            }\n        }\n        string ans = \"\";\n        for (int i = 0; i < M; i++) {\n            int ok = 0;\n            int num = 0;\n            for (int j = 0; j < N; j++) {\n                if (bo[j][i]) {\n                    ok++;\n                    num = j;\n                }\n            }\n            if (ok == 1) {\n                ans += moji(num);\n            } else {\n                ans += '?';\n            }\n        }\n        cout << ans << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\nusing lint = long long;\n\ninline char decode(int i) {\n    return i + (i < 10 ? '0' : 'A' - 10);\n}\n\nbool solve() {\n    int N, M, Q;\n    cin >> N >> M >> Q;\n    if (N == 0) return false;\n\n    vector<lint> pos(M, (1 << N) - 1);\n    lint light = 0;\n\n    for (int q = 0; q < Q; ++q) {\n        string S;\n        cin >> S;\n        for (int i = 0; i < N; ++i) {\n            if (S[i] == '1') light ^= (1 << i);\n        }\n\n        string B;\n        cin >> B;\n        for (int i = 0; i < M; ++i) {\n            if (B[i] == '0') {\n                pos[i] &= (~light & ((1 << N) - 1));\n            } else {\n                pos[i] &= light;\n            }\n        }\n    }\n\n    for (auto pat : pos) {\n        vector<int> ans;\n        for (int i = 0; i < N; ++i) {\n            if ((pat >> i) & 1) ans.push_back(i);\n        }\n        if (ans.size() > 1) {\n            cout << '?';\n        } else {\n            cout << decode(ans[0]);\n        }\n    }\n    cout << endl;\n    return true;\n}\n\nint main() {\n    while (solve()) {}\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \n#define INF 1001000100010001000\n#define MOD 1000000007\n#define EPS 1e-10\n#define int long long\n#define rep(i, N) for (int i = 0; i < N; i++)\n#define Rep(i, N) for (int i = 1; i < N; i++)\n#define For(i, a, b) for (int i = (a); i < (b); i++)\n#define pb push_back\n#define mp make_pair\n#define i_i pair<int, int>\n#define vi vector<int>\n#define vvi vector<vi >\n#define vb vector<bool>\n#define vvb vector<vb >\n#define vp vector< i_i >\n#define all(a) (a).begin(), (a).end()\n#define Int(x) int x; scanf(\"%lld\", &x);\n#define int2(x, y) int x, y; scanf(\"%lld %lld\", &x, &y);\n \n//int dxy[5] = {0, 1, 0, -1, 0};\n// assign\n\nint n, m, q;\nint table[1000][40];\n\nvoid print_table(int a, int b);\n\nsigned main()\n{\n    while ( cin >> n >> m >> q, n ) {\n        string sw1, sw2, state1, state2;\n        rep(i, n) { sw1.pb('0'); }\n        rep(i, m) { state1.pb('0'); }\n        memset(table, 0, sizeof(table));\n\n        rep(loop, q) {\n            cin >> sw2 >> state2;\n            vi sws, swn;\n            rep(i, sw2.length()) {\n                if (sw2[i] == '1') {\n                    sws.pb(i);\n                } else {\n                    swn.pb(i);\n                }\n            }\n            rep(i, state2.length()) {\n                if (state1[i] != state2[i]) {\n                    for (int pos : sws) {\n                        if (table[i][pos] != -1) {\n                            table[i][pos] = 1;\n                        }\n                    }\n                    for (int pos : swn) {\n                        table[i][pos] = -1;\n                    }\n                } else {\n                    for (int pos : sws) {\n                        table[i][pos] = -1;\n                    }\n                }\n            }\n            sw1 = sw2;\n            state1 = state2;\n            //print_table(n, m);\n        }\n        rep(i, m) {\n            int ans = -1;\n            rep(j, n) {\n                if (table[i][j] != -1 && ans == -1) {\n                    ans = j;\n                } else if (table[i][j] != -1) {\n                    ans = -2;\n                }\n            }\n            if (0 <= ans && ans <= 9) {\n                cout << ans;\n            } else if (10 <= ans) {\n                printf(\"%c\", 'A' + (ans - 10));\n            } else {\n                cout << '?';\n            }\n        }\n        cout << endl;\n    }\n\n    return 0;\n}\n\nvoid print_table(int a, int b)\n{\n    rep(i, a) {\n        rep(j, b) {\n            printf(\"%5lld\", table[j][i]);\n        }\n        cout << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iostream>\n#include <list>\n#include <map>\n#include <memory>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\nusing namespace std;\n\n#define EPS 1e-10\n#define INF 1000000000\n#define mp make_pair\n#define pb push_back\n\ntypedef vector<bool> vb;\ntypedef vector<vb> vbb;\ntypedef pair<int,int> pii;\ntypedef long long ll;\n\nint main() {\n  string digits = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ?\";\n  while (1) {\n    int N, M, Q;\n    cin >> N >> M >> Q;\n    if (N == 0 && M == 0 && Q == 0) {\n      break;\n    }\n    vbb relationships(M, vb(N, true));\n    string switches = \"\";\n    for (int s = 0; s < N; s++) {\n      switches += \"0\";\n    }\n\n    for (int i = 0; i < Q; i++) {\n      string S, B;\n      cin >> S >> B;\n      for (int s = 0; s < N; s++) {\n        int bit = ((switches[s] - '0') + (S[s] - '0')) % 2;\n        switches[s] = bit + '0';\n      }\n\n      for (int s = 0; s < N; s++) {\n        for (int b = 0; b < M; b++) {\n          if (switches[s] == '0' && B[b] == '0') {\n            continue;\n          }\n          relationships[b][s] = relationships[b][s] && switches[s] == '1' && B[b] == '1';\n        }\n      }\n    }\n\n    for (int i = 0; i < M; i++) {\n      int sw = 36;\n      for (int j = 0; j < N; j++) {\n        if (relationships[i][j]) {\n          if (sw != 36) {\n            sw = 36;\n            break;\n          }\n          sw = j;\n        }\n      }\n      cout << digits[sw];\n    }\n    cout << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\nint check(int N,long long mask){\n\tint c=-1;\n\tlong long k=1;\n\tfor(int i=0;i<N;i++,k<<=1){\n\t\tif(mask&k){\n\t\t\tif(c>=0)c=-2;\n\t\t\tif(c==-1)c=i;\n\t\t}\n\t}\n\treturn c;\n}\nint main(){\n\tfor(int N,M,Q;cin>>N>>M>>Q,N;){\n\t\tvector<long long>v0(M);\n\t\tvector<long long>v1(M);\n\t\tstring prev(M,'0');\n\t\t{\n\t\t\tlong long mask=0,k=1;\n\t\t\tfor(int i=0;i<N;i++,k<<=1){\n\t\t\t\tmask|=k;\n\t\t\t}\n\t\t\tfor(int i=0;i<M;i++){\n\t\t\t\tv0[i]=v1[i]=mask;\n\t\t\t}\n\t\t}\n\t\tfor(;Q--;){\n\t\t\tstring s,t;\n\t\t\tcin>>s>>t;\n\t\t\tlong long mask0=0,mask1=0,k=1;\n\t\t\tfor(int i=0;i<s.size();i++,k<<=1){\n\t\t\t\tif(s[i]=='0')mask0|=k;\n\t\t\t\tif(s[i]=='1')mask1|=k;\n\t\t\t}\n\t\t\tfor(int i=0;i<t.size();i++){\n\t\t\t\tif((prev[i]^t[i])==0)\n\t\t\t\t\tv0[i]&=mask0;\n\t\t\t\telse\n\t\t\t\t\tv1[i]&=mask1;\n\t\t\t}\n\t\t\tprev=t;\n\t\t}\n\t\tfor(int j=0;j<M;j++){\n\t\t\tlong long k=1;\n\t\t\tint c0=check(N,v0[j]),c1=check(N,v1[j]),c2=check(N,v1[j]&v0[j]);\n\t\t\tif(c0>=0)putchar(c0<10?c0+'0':c0-10+'A');\n\t\t\telse if(c1>=0)putchar(c1<10?c1+'0':c1-10+'A');\n\t\t\telse if(c2>=0)putchar(c2<10?c2+'0':c2-10+'A');\n\t\t\telse putchar('?');\n\t\t}\n\t\tputs(\"\");\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define se second\n#define FOR(i, a, b) for(int i=(a);i<(b);i++)\n#define REP(i, n) FOR(i, 0, n)\n#define RFOR(i, a, b) for(int i=(a);i>=(b);i--)\n#define RREP(i, n) RFOR(i, n, 0)\n#define MFOR(i, m) for(auto i=(m).begin();i!=(m).end();i++)\n#define ALL(a) (a).begin(), (a).end()\n#define SZ(x) ((int)(x).size())\n\ntypedef long long int ll;\ntypedef pair<int, int> P;\ntypedef pair<ll, ll> Pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vll;\ntypedef vector<vll> vvll;\n\nconst double eps = 1e-10;\nconst int MOD = 1000000007;\nconst int INF = 1000000000;\nconst ll LINF = 1ll<<50;\n\ntemplate<typename T>\nvoid printv(vector<T> const& s) {\n  REP(i, SZ(s)) {\n    cout << s[i];\n    if(i == SZ(s)-1) {\n      cout << endl;\n    } else {\n      cout << \" \";\n    }\n  }\n}\n\nint main () {\n  cin.tie(0);\n  cout << fixed << setprecision(10);\n\n  while(1) {\n    int n, m, q;\n    cin>>n>>m>>q;\n    if(n == 0) break;\n    vector<bitset<36>> s(q+1);\n    vector<bitset<1000>> b(q+1);\n    s[0] = bitset<36>(0);\n    b[0] = bitset<1000>(0);\n    for(int i=1;i<=q;++i) {\n      string tmps, tmpq;\n      cin >> tmps >> tmpq;\n      reverse(ALL(tmps));\n      reverse(ALL(tmpq));\n      s[i] = bitset<36>(tmps);\n      b[i] = bitset<1000>(tmpq);\n    }\n\n    vector<pair<bitset<36>, bitset<1000>>> a(q+2);\n    for(int i=0;i<q;++i) {\n      a[i] = make_pair(s[i+1], b[i] ^ b[i+1]);\n    }\n    a[q] = make_pair(bitset<36>(0), bitset<1000>(0));\n    string tmps = \"\", tmpq = \"\";\n    for(int i=0;i<n;++i) {\n      tmps += '1';\n    }\n    for(int i=0;i<m;++i) {\n      tmpq += '1';\n    }\n    a[q+1] = make_pair(bitset<36>(tmps), bitset<1000>(tmpq));\n\n\n    vector<bitset<1000>> cor(n, ~bitset<1000>(0));\n    for(int i=0;i<n;++i) {\n      for(int j=0;j<q+2;++j) {\n        if(a[j].first[i]) {\n          cor[i] &= a[j].second;\n        } else {\n          cor[i] &= ~a[j].second;\n        }\n      }\n    }\n\n    vector<char> pos(m, '*');\n\n    for(int i=0;i<m;++i) {\n      for(int j=0;j<n;++j) {\n        if(cor[j][i] == 1 && pos[i] == '*') {\n          pos[i] = (0 <= j && j <= 9) ? j + '0' : j - 10 + 'A';\n        } else if(cor[j][i] == 1) {\n          pos[i] = '?';\n        }\n      }\n    }\n\n    for(int i=0;i<m;++i) {\n      cout << pos[i];\n    }\n    cout << endl;\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\nint main(){\n  int n,m,q;\n  cin >> n >> m >> q;\n  int i,j,k;\n  string s,b;\n  while((n+m+q)!=0){\n    int table[40][40]={{}};\n    int onoff[40]={};\n    \n    for(i=0;i<q;i++){\n      cin >> s >> b;\n      int change[40]={};\n      for(j=0;j<n;j++){\n\tif(s[j]=='1') {\n\t  if(onoff[j]==0) onoff[j]=1;\n\t  else onoff[j]=0;\n\t}\n      }\n      int c=0,x;\n      for(j=0;j<n;j++){\n\tc+=onoff[j];\n\tif(onoff[j]==1) x=j;\n      }\n      if(c==1){\n\tfor(j=0;j<m;j++){\n\t  if(b[j]=='1'){\n\t    for(k=0;k<n;k++){\n\t      if(k!=x) table[j][k]=1;\n\t    }\n\t  }\n\t}\n      }\n      for(j=0;j<m;j++){\n\tif(b[j]=='0'){\n\t  for(k=0;k<n;k++){\n\t    if(table[j][k]==0){\n\t      if(onoff[k]==1)\n\t\ttable[j][k]=1;\n\t    }\n\t  }\n\t}\n      }\n      \n      int ch[40]={},id[40]={};\n      for(j=0;j<m;j++){\n\tfor(k=0;k<n;k++){\n\t  if(table[j][k]==1) ch[j]++;\n\t  if(table[j][k]==0) id[j]=k;\n\t}\n      }\n      for(j=0;j<m;j++){\n\tif(ch[j]+1==n){\n\t  //cout <<\"a\"<< endl;\n\t  for(k=0;k<m;k++){\n\t    if(ch[k]+1!=n){\n\t      table[k][id[j]]=1;\n\t    }\n\t  }\n\t}\n      }\n      \n      \n    }\n\n    for(j=0;j<m;j++){\n\tint c=0,id;\n\tfor(k=0;k<n;k++){\n\t  if(table[j][k]==1) c++;\n\t  if(table[j][k]==0) id=k;\n\t}\n\tchar buf;\n\tif(c+1==n){\n\t  if(id<10) buf=id+'0';\n\t  else buf='A'+id-10;\n\t}else{\n\t  buf='?';\n\t}\n\tcout << buf;\n      }\n    cout << endl;\n    cin >> n >> m >> q;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\nusing namespace std;\n \n#define REP(i,n) for(int i=0; i<n; ++i)\n#define FOR(i,a,b) for(int i=a; i<=b; ++i)\n#define FORR(i,a,b) for (int i=a; i>=b; --i)\n#define pi M_PI\n \ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef vector<VI> VVI;\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> PL;\n\n\nint main() {\n    int n, m, q;\n    string poyo = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\n    while (cin >> n >> m >> q && n) {\n        VVI a(n, VI(m,1));\n        VI l(m);\n        while (q--){\n            string s, t;\n            cin >> s >> t;\n            REP(j,m){\n                int x = t[j] - '0';\n                x ^= l[j];\n                l[j] = (t[j] - '0');\n                REP(i,n){\n                    int y = s[i] - '0';\n                    y ^= (x ^ 1);\n                    a[i][j] &= y;\n                }\n            }\n        }\n        string ans;\n        REP(j,m){\n            REP(i,n){\n                if (a[i][j]) ans += poyo[i];\n            }\n        }\n        if (ans.length() == m) cout << ans << endl;\n        else cout << \"??\" << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<iomanip>\n#include<cmath>\n#include<vector>\n#include<algorithm>\n\nusing namespace std;\n\n#define int long long\n#define endl \"\\n\"\n\nconst long long INF = (long long)1e18;\nconst long long MOD = 1'000'000'007; \n\nstring yn(bool f){return f?\"Yes\":\"No\";}\nstring YN(bool f){return f?\"YES\":\"NO\";}\n\n\n\nsigned main(){\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout<<fixed<<setprecision(10);\n\t\n\t\n\t\n\twhile(true){\n\t\tint N, M, Q;\n\t\tstring ans;\n\t\tvector<string> S, B;\n\t\tvector<int> unknown;\n\t\tvector<vector<int>> light_bulbs;\n\t\t\n\t\tcin>>N>>M>>Q;\n\t\t\n\t\tif(!N&&!M&&!Q) break;\n\t\t\n\t\tS.resize(Q);\n\t\tB.resize(Q);\n\t\tunknown.resize(N);\n\t\tlight_bulbs.resize(N, vector<int>(Q+1));\n\t\t\n\t\tfor(int i = 0; i < Q; i++){\n\t\t\tcin>>S[i]>>B[i];\n\t\t\tfor(int j = 0; j < N; j++){\n\t\t\t\tif(S[i][j] == '1'){\n\t\t\t\t\tlight_bulbs[j][i+1] = !light_bulbs[j][i];\n\t\t\t\t} else light_bulbs[j][i+1] = light_bulbs[j][i];\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor(int i = 0; i < N; i++){\n\t\t\tif(unknown[i]) continue;\n\t\t\tfor(int j = i + 1; j < N; j++){\n\t\t\t\tif(light_bulbs[i] == light_bulbs[j]){\n\t\t\t\t\tunknown[i] = true;\n\t\t\t\t\tunknown[j] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// for(int i = 0; i < N; i++) cout<<\"NUKNOWN \"<<\" i = \"<<i<<\" \"<<unknown[i]<<endl;\n\t\t// for(int i = 0; i < N; i++) {for(int j = 0; j <= Q; j++) cout<<light_bulbs[i][j]; cout<<endl;}\n\t\tfor(int i = 0; i < M; i++){\n\t\t\tchar ch = '?';\n\t\t\tfor(int j = 0; j < N; j++){\n\t\t\t\tbool same = true;\n\t\t\t\tfor(int k = 0; k < Q; k++){\n\t\t\t\t\tif(light_bulbs[j][k+1] && B[k][i] == '0' || !light_bulbs[j][k+1] && B[k][i] == '1'){\n\t\t\t\t\t\tsame = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(same){\n\t\t\t\t\tif(!unknown[j]){\n\t\t\t\t\t\tif(j <= 9) ch = '0' + j;\n\t\t\t\t\t\telse ch = 'A' + j - 10;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tans += ch;\n\t\t}\n\t\t\n\t\tcout<<ans<<endl;\n\t\t\n\t}\n\t\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "\n#include <stdio.h>\n#include <iostream>\n#include <vector>\n#include <string>\n#include <bitset>\n\nusing namespace std;\n#define bitmax 1000\n/*\n\t不明なスイッチ\n\tICPC(国際ソケット・コネクタ会社)本社ビルの中には、M個の電球があり、\n\tそれらはN個のスイッチによって制御されている。各電球はただ一つのスイッチによって\n\t点灯させたり消滅させたりできる。各スイッチは複数の電球を操作できることもある。\n\tあるスイッチを操作するとき、そのスイッチによって制御されている全ての電球の状態が変化する。\n\tあなたはスイッチと電球の対応を記録してある表をなくしてしまい、それを復元したいと思っていた。\n\n\t以下の手順によって電球とスイッチの対応関係を復元することに決めた。\n\n\t・最初に全てのスイッチがオフになっており、全ての電球が消灯している\n\t・S1によってあらわされるいくつかのスイッチを操作する\n\t・B1によってあらわされる電球の状態を確認する\n\t・S2によってあらわされるいくつかのスイッチを操作する\n\t・B2によってあらわされる電球の状態を確認する\n\t・...\n\t・SQによってあらわされるいくつかのスイッチを操作する\n\t・BQによってあらわされる電球の状態を確認する\n\n\tいくつかのスイッチを操作して電球の状態を確認したあとは、\n\tスイッチと電球の状態は次の操作までそのままにしておく。\n\n\t操作を行ったスイッチと確認を行った電球に関する情報を用いて、\n\tスイッチと電球の対応関係を復元することができるだろうか？\n\n\t入力\n\t入力は複数のデータセットからなる。データセットの個数は50以下であり、\n\tファイルサイズは10MB以下である。各データセットは以下の形式に従う。\n\n\t各データセットの一行目には3個の整数N,M,Qが含まれ\n\t( 1 <= N <= 36 ), ( 1 <= M <= 1000 ), ( 0 <= Q <= 1000 )\n\t、それぞれスイッチの個数、\n\t電球の個数、操作の回数を表す。それ以降のQ行は操作を行ったスイッチと\n\t状態の確認を行った電球に関する情報をあらわす。そのi番目には\n\t二つのデータS_iとB_iが含まれ、長さはそれぞれNとMである。\n\t各S_iは操作を行ったスイッチの集まりを表す。S_ijは0または1のいずれかであり、\n\tそれぞれj番目のスイッチが操作されなかったこと、操作されたことを示す。\n\t各B_iは電球の状態を示す。B_ijは0または1のいずれかであり、それぞれj番目の電球が\n\t消灯しているか点灯しているかを表す。\n\n\t与えられる情報には、スイッチと電球の対応関係に矛盾が無いことを仮定してよい。\n\n\t入力の終わりは3つの0によってあらわされる。\n\n\t出力\n\t各データセットについて、スイッチと電球の対応関係を、\n\tM個の数字からなるbase-36形式で出力せよ。この問題におけるbase-36形式において、\n\t0-9と10-35の値はそれぞれ'0'-'9','A'-'Z'の文字によって表現される。\n\t対応関係におけるi番目の文字は、i番目の電球を制御しているスイッチの番号を示す。\n\ti番目の電球を制御しているスイッチを決定できない場合には、スイッチの番号の代わりに\n\t'?'をi番目の文字として出力せよ。\n\n*/\n\n/*\n\t方針\n\tビット演算を用いる\n\t各電球について、つながっている可能性のあるスイッチに対応するビットを立てる\n\tスイッチの状態を変えても電球の状態に変化がない場合に可能性が消える\n\t→　ある状態とその次の状態の排他的論理和を取る\n\n*/\nstring revstr( string s ) {\n\tstring ret;\n\tfor(int i = s.length() - 1; i >= 0; i--) {\n\t\tret += s[i];\n\t}\n\treturn ret;\n}\n\nint main(void){\n\t//FILE* fp_in = freopen(\"data.txt\", \"r\", stdin);\n\n\tvector< char > ans;\n\tfor(int i = 0; i < 10; i++)\n\t\tans.push_back( '0' + i );\n\tfor(int i = 0; i < 26; i++)\n\t\tans.push_back( 'A' + i );\n\n\twhile(1) {\n\t\tint N, M, Q;\n\t\tvector< bitset< bitmax > > S;\n\t\tvector< bitset< bitmax > > B;\n\t\tvector< bitset< bitmax > > P;\n\n\t\tcin >> N >> M >> Q;\n\t\tif( N == 0 && M == 0 && Q == 0 ) break;\n\n\t\tfor(int i = 0; i < M; i++) {\n\t\t\tbitset< bitmax > P_i;\n\t\t\tP_i.reset();\n\t\t\tfor(int j = 0; j < M; j++)\n\t\t\t\tP_i.set(j);\n\t\t\tP.push_back( P_i );\n\t\t}\n\n\t\t//データ取得\n\t\tfor(int i = 0; i <= Q; i++) {\n\t\t\tif( i == 0 ) {\n\t\t\t\tbitset< bitmax > Si( 0 );\n\t\t\t\tbitset< bitmax > Bi( 0 );\n\t\t\t\tS.push_back( Si );\n\t\t\t\tB.push_back( Bi );\n\t\t\t} else {\n\t\t\t\tstring S_i, B_i;\n\t\t\t\tcin >> S_i >> B_i;\n\t\t\t\tbitset< bitmax > Si( S_i );\n\t\t\t\tbitset< bitmax > Bi( B_i );\n\t\t\t\tbitset< bitmax > b;\n\t\t\t\tS.push_back( Si );\n\t\t\t\tB.push_back( Bi );\n\t\t\t\tS[i] ^= S[i-1]; \t//現在点灯しているスイッチ\n\t\t\t\tfor(int j = 0; j < M; j++) {\n\t\t\t\t\tif( B[i][j] ) {\t//電球が点灯した場合\n\t\t\t\t\t\tP[j] &= S[i];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tP[j] &= ~S[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tstring str;\n\t\tfor(int i = 0; i < P.size(); i++) {\n\t\t\tif( P[i].count() == 1 ) {\n\t\t\t\tfor(int j = 0; j < bitmax; j++) {\n\t\t\t\t\tif( P[i][j] ) str += ans[N - 1 - j];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstr += '?';\n\t\t\t}\n\t\t}\n\t\tcout << revstr(str) << endl;\n\t\t\n\t}\n\n\t//while(1){}\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <stdio.h>\n#include <iostream>\n#include <vector>\n#include <string>\n#include <bitset>\n\nusing namespace std;\n#define bitmax 1000\n\nstring revstr( string s ) {\n\tstring ret;\n\tfor(int i = s.length() - 1; i >= 0; i--) {\n\t\tret += s[i];\n\t}\n\treturn ret;\n}\n\nint main(void){\n\n\tvector< char > ans;\n\tfor(int i = 0; i < 10; i++)\n\t\tans.push_back( '0' + i );\n\tfor(int i = 0; i < 26; i++)\n\t\tans.push_back( 'A' + i );\n\n\twhile(1) {\n\t\tint N, M, Q;\n\t\tvector< bitset< bitmax > > S;\n\t\tvector< bitset< bitmax > > B;\n\t\tvector< bitset< bitmax > > P;\n\n\t\tcin >> N >> M >> Q;\n\t\tif( N == 0 && M == 0 && Q == 0 ) break;\n\n\t\tfor(int i = 0; i < M; i++) {\n\t\t\tbitset< bitmax > P_i;\n\t\t\tP_i.reset();\n\t\t\tfor(int j = 0; j < N; j++)\n\t\t\t\tP_i.set(j);\n\t\t\tP.push_back( P_i );\n\t\t}\n\n\t\t//データ取得\n\t\tfor(int i = 0; i < Q; i++) {\n\t\t\tstring S_i, B_i;\n\t\t\tcin >> S_i >> B_i;\n\t\t\tbitset< bitmax > Si( S_i );\n\t\t\tbitset< bitmax > Bi( B_i );\n\t\t\tS.push_back( Si );\n\t\t\tB.push_back( Bi );\n\t\t\tif( i > 0 ) S[i] ^= S[i-1]; \t//現在点灯しているスイッチ\n\t\t\tfor(int j = 0; j < M; j++) {\n\t\t\t\tif( B[i][j] )//電球が点灯した場合\n\t\t\t\t\tP[j] &= S[i];\n\t\t\t\telse\n\t\t\t\t\tP[j] &= ~S[i];\n\t\t\t}\n\t\t}\n\n\t\tstring str;\n\t\tfor(int i = 0; i < P.size(); i++) {\n\t\t\tif( P[i].count() == 1 ) {\n\t\t\t\tfor(int j = 0; j < N; j++)\n\t\t\t\t\tif( P[i][j] ) str += ans[N - 1 - j];\n\t\t\t} else\n\t\t\t\tstr += '?';\n\t\t}\n\t\tcout << revstr(str) << endl;\n\t\t\n\t}\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n, m, q;\nstring s[1000], b[1000];\n\nint get(unsigned long long x){\n\tint res = 0;\n\twhile (x > 1){\n\t\tres++;\n\t\tx >>= 1;\n\t}\n\treturn res;\n}\n\nvoid solve()\n{\n\tfor (int i = 1; i < q; i++){\n\t\tfor (int j = 0; j < n; j++){\n\t\t\ts[i][j] = s[i][j] == '1' ? s[i - 1][j] ^ '0' ^ '1' : s[i - 1][j];\n\t\t}\n\t}\n\t\n\tstatic unsigned long long f[1000];\n\tfor (int i = 0; i < m; i++) f[i] = (1ull << n) - 1;\n\t\n\tfor (int i = 0; i < q; i++){\n\t\tfor (int j = 0; j < n; j++){\n\t\t\tfor (int k = 0; k < m; k++){\n\t\t\t\tif ((b[i][k] == '0') ^ (s[i][j] == '0'))\n\t\t\t\tf[k] &= ~(1ull << j);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfor (int i = 0; i < m; i++){\n\t\tif (f[i] != (f[i] & -f[i])) printf(\"?\");\n\t\tif (f[i] == 0) printf(\"?\");\n\t\telse {\n\t\t\tint t = get(f[i]);\n\t\t\tif (t <= 9) printf(\"%d\", t);\n\t\t\telse printf(\"%c\", 'A' + (t - 10));\n\t\t}\n\t}\n\tputs(\"\");\n}\n\nint main()\n{\n\twhile (scanf(\"%d %d %d\", &n, &m, &q), n){\n\t\tfor (int i = 0; i < q; i++){\n\t\t\tcin >> s[i] >> b[i];\n\t\t}\n\t\tsolve();\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n\nint main()\n{\n\tll N, M, Q;\n\tstring S, B;\n\twhile (cin >> N >> M >> Q, N | M | Q) {\n\t\tvector<ll> able(M, (1ll << N) - 1);\n\t\tll s = 0;\n\t\tfor (ll i = 0; i < Q; i++) {\n\t\t\tcin >> S >> B;\n\t\t\tfor (ll j = 0; j < N; j++) {\n\t\t\t\tif (S[j] == '1') {\n\t\t\t\t\ts ^= 1ll << j;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (ll j = 0; j < M; j++) {\n\t\t\t\tif (B[j] == '1') {\n\t\t\t\t\table[j] &= s;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\table[j] &= ~s;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (ll i = 0; i < M; i++) {\n\t\t\tll res = -1;\n\t\t\tfor (ll j = 0; j < N; j++) {\n\t\t\t\tif (able[i] == (1ll << j)) {\n\t\t\t\t\tres = j;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (res == -1) {\n\t\t\t\tcout << '?';\n\t\t\t}\n\t\t\telse if (res < 10) {\n\t\t\t\tcout << res;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcout << (char)(res - 10 + 'A');\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "///\n// File:  2590.cpp\n// Author: ymiyamoto\n//\n// Created on Thu Dec 28 11:40:56 2017\n//\n\n#include <cstdint>\n#include <iostream>\n#include <string>\n#include <vector>\n\nusing namespace std;\n\nint32_t main()\n{\n  while (true) {\n    uint32_t N, M, Q;\n    cin >> N >> M >> Q;\n    if (N == 0 && M == 0 && Q == 0) break;\n\n    vector<bool> sw(N, false);\n    vector<vector<bool>> switches(M, vector<bool>(N, true));\n    for (uint32_t i = 0; i < Q; i++) {\n      string ops, state;\n      cin >> ops >> state;\n\n      for (auto &op : ops) {\n        if (op == '1') {\n          sw[(&op - &ops[0])] = !sw[(&op - &ops[0])];\n        }\n      }\n\n      for (uint32_t j = 0; j < state.size(); j++) {\n        for (uint32_t k = 0; k < ops.size(); k++) {\n          if (state[j] == '1') {\n            if (!sw[k]) {\n              switches[j][k] = false;\n            }\n          } else {\n            if (sw[k]) {\n              switches[j][k] = false;\n            }\n          }\n        }\n      }\n    }\n\n    string nums = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n    string numbers;\n    for (uint32_t i = 0; i < M; i++) {\n      bool not_determine = false;\n      int32_t num = -1;\n      for (uint32_t j = 0; j < N; j++) {\n        if (switches[i][j]) {\n          if (num != -1) {\n            not_determine = true;\n          }\n          num = j;\n        }\n      }\n      if (not_determine) {\n        numbers += '?';\n      } else {\n        numbers += nums[num];\n      }\n    }\n    cout << numbers << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\ntypedef long long ll;\nint N,M,Q;\nll s[4000],t[4000];\n\nll func(string str){\n  ll res=0;\n  reverse(str.begin(),str.end());\n  for(int i=0;i<(int)str.size();i++){\n    res*=2LL;\n    res+=(str[i]-'0');\n  }\n  return res;\n}\n\nint main(){\n  char change[36];\n  change[0]='0';\n  for(int i=1;i<10;i++)change[i]=change[i-1]+1;\n  change[10]='A';\n  for(int i=11;i<36;i++)change[i]=change[i-1]+1;\n\n  while(1){\n    cin>>N>>M>>Q;\n    if(N==0&&M==0&&Q==0)break;\n    for(int i=0;i<Q;i++){\n      string str,str2;\n      cin>>str>>str2;\n      s[i]=func(str);\n      t[i]=func(str2);\n      if(i){\n\ts[i]=s[i]^s[i-1];\n      }\n      //cout<<s[i]<<' '<<t[i]<<endl;\n    }\n    for(int i=0;i<M;i++){\n      ll f=(1LL<<N)-1;\n      for(int j=0;j<Q;j++){\n       \n\tif((t[j]>>i)&1){\n\t  f=f&s[j];\n\t  \n\t}else {\n\t  \t  f=f&((1LL<<N)-1-s[j]);\n\t  \n\t}\n\n      }\n\n      // cout<<f<<endl;\n      if(__builtin_popcountll(f)==1){\n\tint ans=__builtin_ctzll(f);\n\tcout<<change[ans];\n      }else{\n\tcout<<'?';\n      }\n    }\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <algorithm>\n#include <cstdio>\n#include <functional>\n#include <iostream>\n#include <cfloat>\n#include <climits>\n#include <cstring>\n#include <cmath>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <time.h>\n#include <vector>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> i_i;\ntypedef pair<ll, int> ll_i;\ntypedef pair<double, int> d_i;\ntypedef pair<ll, ll> ll_ll;\ntypedef pair<double, double> d_d;\nstruct edge { int u, v; ll w; };\n\nll MOD = 1000000007;\nll _MOD = 1000000009;\ndouble EPS = 1e-10;\n\nint main() {\n\tfor (;;) {\n\t\tint N, M, Q; cin >> N >> M >> Q;\n\t\tif (N == 0) break;\n\t\tvector< vector<bool> > a(M, vector<bool>(N, true));\n\t\tstring b(M, '0');\n\t\twhile (Q--) {\n\t\t\tstring S, B; cin >> S >> B;\n\t\t\tfor (int j = 0; j < M; j++)\n\t\t\t\tfor (int i = 0; i < N; i++)\n\t\t\t\t\tif ((B[j] == b[j] && S[i] == '1') || (B[j] != b[j] && S[i] == '0'))\n\t\t\t\t\t\ta[j][i] = false;\n\t\t\tb = B;\n\t\t}\n\t\tfor (int j = 0; j < M; j++) {\n\t\t\tint cnt = 0;\n\t\t\tfor (int i = 0; i < N; i++)\n\t\t\t\tcnt += a[j][i];\n\t\t\tif (cnt > 1) {\n\t\t\t\tcout << '?';\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfor (int i = 0; i < N; i++)\n\t\t\t\tif (a[j][i])\n\t\t\t\t\tcout << (i < 10 ? (char)('0' + i) : (char)('A' + i - 10));\n\t\t}\n\t\tcout << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <map>\n#include <queue>\n#include <cstdio>\n#include <ctime>\n#include <assert.h>\n#include <chrono>\n#include <random>\n#include <numeric>\n#include <set>\n#include <deque>\n#include <stack>\n#include <bitset>\nusing namespace std;\ntypedef long long int ll;\ntypedef unsigned long long ull;\n\nmt19937_64 rng(chrono::steady_clock::now().time_since_epoch().count());\nll myRand(ll B) {\n    return (ull)rng() % B;\n}\n\nchar f(int n){\n    if(n<10)return '0'+n;\n    else return 'A'+n-10;\n}\n\nint main(){\n    cin.tie(nullptr);\n    ios::sync_with_stdio(false);\n    while(1){\n        int n,m,q; cin >> n >> m >> q;\n        if(n==0&&m==0&&q==0)break;\n        ll sta=0;\n        vector<ll> l(m,(1LL<<n)-1);\n        while(q--){\n            string s,t; cin >> s >> t;\n            ll ss=0;\n            for(int i=0;i<n;i++){\n                ss|=(ll)(s[i]=='1')<<i;\n            }\n            sta^=ss;\n            for(int i=0;i<m;i++){\n                if(t[i]=='1'){\n                    l[i]&=sta;\n                }\n                else{\n                    l[i]&=(~sta);\n                }\n            }\n        }\n        for(int i=0;i<m;i++){\n            if(__builtin_popcountll(l[i])==1){\n                int res=0;\n                while((1LL<<res)<l[i])res++;\n                printf(\"%c\",f(res));\n            }\n            else{\n                printf(\"?\");\n            }\n        }\n        printf(\"\\n\");\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing vi = vector<int>;\nusing vvi = vector<vi>;\nusing vl = vector<ll>;\nusing vvl = vector<vl>;\nusing vb = vector<bool>;\nusing vs = vector<string>;\nusing msi = map<string, int>;\nusing mii = map<int, int>;\nusing psi = pair<string, int>;\nusing pii = pair<int, int>;\nusing tii = tuple<int, int>;\nusing vlai = valarray<int>;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define range(i,s,n) for(int i=s;i<n;i++)\n#define all(a) a.begin(),a.end()\n#define rall(a) a.rbegin(),a.rend()\n#define fs first\n#define sc second\n#define INF 1E9\n#define LINF 1E18*5\n#define EPS 1E-9\n#define MOD 1000000007\n#define PI 3.1415926535897932384\n\ntemplate<class S, class T>ostream& operator<<(ostream&os, pair<S, T>p) { os << \"[\" << p.first << \", \" << p.second << \"]\"; return os; };\ntemplate<class S>auto&operator<<(ostream&os, vector<S>t) { bool a = 1; for (auto s : t) { os << (a ? \"\" : \" \") << s; a = 0; } return os; }\n\n//int dx[]={1,1,1,0,-1,-1,-1,0},dy[8]={1,0,-1,-1,-1,0,1,1,1};\n//\nconstexpr ll gcd(ll a, ll b) { return b ? gcd(b, a%b) : a; }\n\nclass compare {\npublic:\n\tbool operator()(tuple<int, int> a, tuple<int, int> b) {\n\t\treturn (get<1>(a) < get<1>(b));\n\t}\n};\n\nll n, m, q;\n\nvoid solve() {\n\tstring ou = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\tvs s,b;\n\tvl ans(m,((ll)1<<n)-1);\n\tstring in1, in2;\n\trep(i, q) {\n\t\tcin >> in1 >> in2;\n\t\ts.push_back(in1);\n\t\tb.push_back(in2);\n\t}\n\t//cout << ans[0];\n\t//cout << bitset<64>(ans[0]) << endl;\n\trep(i, q) {\n\t\tll tr=0;\n\t\tll fa=0;\n\t\trep(j, n) {\n\t\t\tif (s[i][n - j - 1] == '1')tr += 1;\n\t\t\tif(j!=n-1)tr *= 2;\n\t\t}\n\t\tfa = ((ll)1 << n) - 1 - tr;\n\t\trep(j, m) {\n\t\t\tbool bo;\n\t\t\tif (i != 0)bo = (b[i][j]-'0')^(b[i-1][j] - '0');\n\t\t\telse bo = (b[i][j] != '0');\n\t\t\tif (bo) {\n\t\t\t\tans[j]=ans[j]&tr;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tans[j] = ans[j] & fa;\n\t\t\t}\n\t\t}\n\n\t\t//cout << bitset<64>(tr) << endl;\n\t\t//cout << bitset<64>(fa) << endl;\n\t\t//cout << bitset<64>(ans[8]) << endl;\n\t}\n\trep(i, m) {\n\t\t//cout << bitset<64>(ans[i]) << endl;\n\t\tll che = 1;\n\t\trep(j,n) {\n\t\t\tif (che == ans[i]) {\n\t\t\t\tcout << ou[j];\n\t\t\t\tj += n;\n\t\t\t}\n\t\t\tif (j != n - 1) che *= 2;\n\t\t\telse cout << \"?\";\n\t\t}\n\t}\n\tcout << endl;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\twhile (cin >> n >> m >> q,n) {\n\t\tsolve();\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\nusing namespace std;\nint n,m,t;\nmain()\n{\n\twhile(cin>>n>>m>>t,n)\n\t{\n\t\tstring s[1001],b[1001];\n\t\ts[0]=string(n,'0');\n\t\tb[0]=string(m,'0');\n\t\tfor(int i=0;i++<t;)cin>>s[i]>>b[i];\n\t\tbool check[1000]={};\n\t\tstring ans(m,'?');\n\t\tfor(int i=0;i<m;i++)\n\t\t{\n\t\t\tbool ok[36]={};\n\t\t\tfor(int j=0;j<n;j++)ok[j]=1;\n\t\t\tfor(int j=0;j++<t;)\n\t\t\t{\n\t\t\t\tif(b[j-1][i]!=b[j][i])\n\t\t\t\t{\n\t\t\t\t\tfor(int k=0;k<n;k++)ok[k]&=s[j][k]=='1';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfor(int k=0;k<n;k++)ok[k]&=s[j][k]=='0';\n\t\t\t\t}\n\t\t\t}\n\t\t\tint cnt=0,mi;\n\t\t\tfor(int j=0;j<n;j++)if(ok[j])cnt++,mi=j;\n\t\t\tif(cnt==1)\n\t\t\t{\n\t\t\t\tans[i]=(char)(mi<10?mi+'0':mi-10+'A');\n\t\t\t\tcheck[i]=1;\n\t\t\t}\n\t\t}\n\t\tint cnt=0,mi;\n\t\tfor(int i=0;i<n;i++)if(ans[i]=='?')cnt++,mi=i;\n\t\tif(cnt==1)\n\t\t{\n\t\t\tfor(int i=0;i<m;i++)if(!check[i])ans[i]=(char)(mi<10?mi+'0':mi-10+'A');\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) begin(a),end(a)\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10  fixed<<setprecision(5)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<short, short> P;\ntypedef complex<double> Point;\ntypedef long long ll;\nconst int INF = 1145141919;\nconst int MOD = 100000007;\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\nstruct edge\n{\n\tint from, to, cost;\n\tbool operator < (const edge& e) const { return cost < e.cost; }\n\tbool operator > (const edge& e) const { return cost > e.cost; }\n};\n///*************************************************************************************///\n///*************************************************************************************///\n///*************************************************************************************///\n\n\nint main()\n{\n\tint n, m, q;\n\twhile (cin >> n >> m >> q, n)\n\t{\n\t\tvector<vi> v(m);\n\t\tREP(i, m)REP(j, n) v[i].push_back(j);\n\t\tstring b, s, preb(m,'0'), pres(n,'0');\n\t\tREP(r, q)\n\t\t{\n\t\t\tcin >> s >> b;\n\t\t\tvi op,rem;\n\t\t\tREP(i, n)\n\t\t\t{\n\t\t\t\tif (pres[i] != s[i]) op.push_back(i);\n\t\t\t\telse rem.push_back(i);\n\t\t\t}\n\t\t\t\n\t\t\tREP(i, m)\n\t\t\t{\n\t\t\t\tif (v[i].size()>1 && preb[i] == b[i])\n\t\t\t\t{\n\t\t\t\t\tREP(j, v[i].size())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (find(ALL(op), v[i][j]) != op.end())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tv[i].erase(v[i].begin() + j);\n\t\t\t\t\t\t\tj--;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (v[i].size()>1 && preb[i] != b[i])\n\t\t\t\t{\n\t\t\t\t\tREP(j, v[i].size())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (find(ALL(rem), v[i][j]) != rem.end())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tv[i].erase(v[i].begin() + j);\n\t\t\t\t\t\t\tj--;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tpres = s; preb = b;\n\t\t}\n\t\tREP(i, m)\n\t\t{\n\t\t\tif (v[i].size() > 1) cout << '?';\n\t\t\telse if (v[i][0] < 10) cout << v[i][0];\n\t\t\telse\n\t\t\t{\n\t\t\t\tcout << char('A' + v[i][0] - 10);\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n \t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint main(){\n  while (1){\n    int N, M, Q;\n    cin >> N >> M >> Q;\n    if (N == 0 && M == 0 && Q == 0){\n      break;\n    }\n    vector<string> S(Q + 1), B(Q + 1);\n    for (int i = 1; i <= Q; i++){\n      cin >> S[i] >> B[i];\n    }\n    for (int i = 0; i < N; i++){\n      S[0] += '0';\n    }\n    for (int i = 0; i < M; i++){\n      B[0] += '0';\n    }\n    vector<vector<bool>> tmp(M, vector<bool>(36, true));\n    for (int i = 0; i < M; i++){\n      for (int j = 0; j < N; j++){\n        for (int k = 0; k < Q; k++){\n          if (S[k + 1][j] == '0' && B[k][i] != B[k + 1][i]){\n            tmp[i][j] = false;\n          }\n          if (S[k + 1][j] == '1' && B[k][i] == B[k + 1][i]){\n            tmp[i][j] = false;\n          }\n        }\n      }\n    }\n    vector<int> ans(M, -2);\n    for (int i = 0; i < M; i++){\n      for (int j = 0; j < N; j++){\n        if (tmp[i][j]){\n          if (ans[i] == -2){\n            ans[i] = j;\n          } else {\n            ans[i] = -1;\n          }\n        }\n      }\n    }\n    for (int i = 0; i < M; i++){\n      if (ans[i] == -1){\n        cout << '?';\n      } else if (ans[i] < 10){\n        cout << (char) ('0' + ans[i]);\n      } else {\n        cout << (char) ('A' + ans[i] - 10);\n      }\n    }\n    cout << endl;\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<n;i++)\n\nint main()\n{\n\twhile (true) {\n\t\tint N, M, Q;\n\n\t\tcin >> N >> M >> Q;\n\n\t\tif (N == 0 && M == 0 && Q == 0) {\n\t\t\tbreak;\n\t\t}\n\n\t\tvector<vector<bool>> swi(Q, vector<bool>(N));\n\t\tvector<vector<bool>> bulb(Q, vector<bool>(M));\n\t\tvector<int> state(N, 0);\n\t\tvector<vector<bool>> graph(N, vector<bool>(M, true));\n\n\t\trep(i, Q) {\n\t\t\trep(j, N) {\n\t\t\t\tchar temp;\n\n\t\t\t\tcin >> temp;\n\n\t\t\t\tif (temp == '0') {\n\t\t\t\t\tswi[i][j] = false;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tswi[i][j] = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trep(j, M) {\n\t\t\t\tchar temp;\n\t\t\t\t\n\t\t\t\tcin >> temp;\n\n\t\t\t\tif (temp == '0') {\n\t\t\t\t\tbulb[i][j] = false;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tbulb[i][j] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\trep(i, Q) {\n\t\t\trep(j, N) {\n\t\t\t\tif (swi[i][j] == true) {\n\t\t\t\t\tstate[j] = (state[j] + 1) % 2;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trep(j, N) {\n\t\t\t\trep(k, M) {\n\t\t\t\t\tif (state[j] != bulb[i][k]) {\n\t\t\t\t\t\tgraph[j][k] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\trep(i, M) {\n\t\t\tint count = 0;\n\t\t\tint s;\n\n\t\t\trep(j, N) {\n\t\t\t\tif (graph[j][i] == true) {\n\t\t\t\t\tcount++;\n\t\t\t\t\ts = j;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (count >= 2) {\n\t\t\t\tcout << '?';\n\t\t\t}\n\t\t\telse if (count == 1) {\n\t\t\t\tif (s <= 9) {\n\t\t\t\t\tcout << s;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tchar c = 'A';\n\n\t\t\t\t\tc += s - 10;\n\n\t\t\t\t\tcout << c;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <numeric>\n#include <bitset>\n#include <cmath>\n\nstatic const int MOD = 1000000007;\nusing ll = long long;\nusing u32 = uint32_t;\nusing namespace std;\n\ntemplate<class T> constexpr T INF = ::numeric_limits<T>::max()/32*15+208;\n\n\n\nint main() {\n    int n, m, q;\n    while(cin >> n >> m >> q, n){\n        vector<bitset<50>> v(m);\n        for (int i = 0; i < n; ++i) {\n            for (int j = 0; j < m; ++j) {\n                v[j].set(i);\n            }\n        }\n        bitset<50> b;\n        for (int i = 0; i < q; ++i) {\n            string s, t;\n            cin >> s >> t;\n            for (int j = 0; j < n; ++j) {\n                if(s[j] == '1') b[j].flip();\n            }\n\n            for (int j = 0; j < n; ++j) {\n                for (int k = 0; k < m; ++k) {\n                    if(b[j] && t[k] == '0') v[k][j] = false;\n                    if(!b[j] && t[k] == '1') v[k][j] = false;\n                }\n            }\n        }\n        for (int i = 0; i < m; ++i) {\n            if(v[i].count() == 1){\n                for (int j = 0; j < n; ++j) {\n                    if(v[i][j]) {\n                        if(j >= 10) printf(\"%c\", j-10+'A');\n                        else printf(\"%d\", j);\n                        break;\n                    }\n                }\n            }else printf(\"?\");\n        }\n        puts(\"\");\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "\n#include <stdio.h>\n#include <iostream>\n#include <vector>\n#include <string>\n#include <bitset>\n\nusing namespace std;\n#define bitmax 1000\n/*\n\t不明なスイッチ\n\tICPC(国際ソケット・コネクタ会社)本社ビルの中には、M個の電球があり、\n\tそれらはN個のスイッチによって制御されている。各電球はただ一つのスイッチによって\n\t点灯させたり消滅させたりできる。各スイッチは複数の電球を操作できることもある。\n\tあるスイッチを操作するとき、そのスイッチによって制御されている全ての電球の状態が変化する。\n\tあなたはスイッチと電球の対応を記録してある表をなくしてしまい、それを復元したいと思っていた。\n\n\t以下の手順によって電球とスイッチの対応関係を復元することに決めた。\n\n\t・最初に全てのスイッチがオフになっており、全ての電球が消灯している\n\t・S1によってあらわされるいくつかのスイッチを操作する\n\t・B1によってあらわされる電球の状態を確認する\n\t・S2によってあらわされるいくつかのスイッチを操作する\n\t・B2によってあらわされる電球の状態を確認する\n\t・...\n\t・SQによってあらわされるいくつかのスイッチを操作する\n\t・BQによってあらわされる電球の状態を確認する\n\n\tいくつかのスイッチを操作して電球の状態を確認したあとは、\n\tスイッチと電球の状態は次の操作までそのままにしておく。\n\n\t操作を行ったスイッチと確認を行った電球に関する情報を用いて、\n\tスイッチと電球の対応関係を復元することができるだろうか？\n\n\t入力\n\t入力は複数のデータセットからなる。データセットの個数は50以下であり、\n\tファイルサイズは10MB以下である。各データセットは以下の形式に従う。\n\n\t各データセットの一行目には3個の整数N,M,Qが含まれ\n\t( 1 <= N <= 36 ), ( 1 <= M <= 1000 ), ( 0 <= Q <= 1000 )\n\t、それぞれスイッチの個数、\n\t電球の個数、操作の回数を表す。それ以降のQ行は操作を行ったスイッチと\n\t状態の確認を行った電球に関する情報をあらわす。そのi番目には\n\t二つのデータS_iとB_iが含まれ、長さはそれぞれNとMである。\n\t各S_iは操作を行ったスイッチの集まりを表す。S_ijは0または1のいずれかであり、\n\tそれぞれj番目のスイッチが操作されなかったこと、操作されたことを示す。\n\t各B_iは電球の状態を示す。B_ijは0または1のいずれかであり、それぞれj番目の電球が\n\t消灯しているか点灯しているかを表す。\n\n\t与えられる情報には、スイッチと電球の対応関係に矛盾が無いことを仮定してよい。\n\n\t入力の終わりは3つの0によってあらわされる。\n\n\t出力\n\t各データセットについて、スイッチと電球の対応関係を、\n\tM個の数字からなるbase-36形式で出力せよ。この問題におけるbase-36形式において、\n\t0-9と10-35の値はそれぞれ'0'-'9','A'-'Z'の文字によって表現される。\n\t対応関係におけるi番目の文字は、i番目の電球を制御しているスイッチの番号を示す。\n\ti番目の電球を制御しているスイッチを決定できない場合には、スイッチの番号の代わりに\n\t'?'をi番目の文字として出力せよ。\n\n*/\n\n/*\n\t方針\n\tビット演算を用いる\n\t各電球について、つながっている可能性のあるスイッチに対応するビットを立てる\n\tスイッチの状態を変えても電球の状態に変化がない場合に可能性が消える\n\t→　ある状態とその次の状態の排他的論理和を取る\n\n*/\nstring revstr( string s ) {\n\tstring ret;\n\tfor(int i = s.length() - 1; i >= 0; i--) {\n\t\tret += s[i];\n\t}\n\treturn ret;\n}\n\nint main(void){\n\t//FILE* fp_in = freopen(\"data.txt\", \"r\", stdin);\n\n\tvector< char > ans;\n\tfor(int i = 0; i < 10; i++)\n\t\tans.push_back( '0' + i );\n\tfor(int i = 0; i < 26; i++)\n\t\tans.push_back( 'A' + i );\n\n\twhile(1) {\n\t\tint N, M, Q;\n\t\tvector< bitset< bitmax > > S;\n\t\tvector< bitset< bitmax > > B;\n\t\tvector< bitset< bitmax > > P;\n\n\t\tcin >> N >> M >> Q;\n\t\tif( N == 0 && M == 0 && Q == 0 ) break;\n\n\t\tfor(int i = 0; i < M; i++) {\n\t\t\tbitset< bitmax > P_i;\n\t\t\tP_i.reset();\n\t\t\tfor(int j = 0; j < N; j++)\n\t\t\t\tP_i.set(j);\n\t\t\tP.push_back( P_i );\n\t\t}\n\n\t\t//データ取得\n\t\tfor(int i = 0; i < Q; i++) {\n\t\t\tstring S_i, B_i;\n\t\t\tcin >> S_i >> B_i;\n\t\t\tbitset< bitmax > Si( S_i );\n\t\t\tbitset< bitmax > Bi( B_i );\n\t\t\tS.push_back( Si );\n\t\t\tB.push_back( Bi );\n\t\t\tif( i > 0 ) S[i] ^= S[i-1]; \t//現在点灯しているスイッチ\n\t\t\tfor(int j = 0; j < M; j++) {\n\t\t\t\tif( B[i][j] ) {\t//電球が点灯した場合\n\t\t\t\t\tP[j] &= S[i];\n\t\t\t\t} else {\n\t\t\t\t\tP[j] &= ~S[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring str;\n\t\tfor(int i = 0; i < P.size(); i++) {\n\t\t\tif( P[i].count() == 1 ) {\n\t\t\t\tfor(int j = 0; j < N; j++) {\n\t\t\t\t\tif( P[i][j] ) str += ans[N - 1 - j];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstr += '?';\n\t\t\t}\n\t\t}\n\t\tcout << revstr(str) << endl;\n\t\t\n\t}\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint N,M,Q;\nunsigned long ans[1003];\nvoid plot() {\n    rep(i,M) {\n        int count=0;\n        int val=0;\n        rep(j,N) {\n            if(((ans[i])>>j)&1) {\n                count++;\n                val=j;\n            }\n        }\n        if(count==1) {\n            if(val<10) printf(\"%d\",val);\n            else printf(\"%c\",'A'+val-10);\n        }\n        else cout<<\"?\";\n    }\n    cout<<endl;\n}\n\nvoid update(unsigned long& mask, string S, string B) {\n    unsigned long bit=0;\n    rep(i,N) if(S[i]=='1') bit|=1L<<i;\n    mask^=bit;\n    // printf(\"%s->%s : %lx\\n\", stateS.c_str(),S.c_str(),bit);\n    rep(i,M) {\n        if(B[i] == '1') {\n            ans[i] &= mask;\n        }\n        else {\n            ans[i] &= ~mask;\n        }\n    }\n}\n\n\nvoid solve() {\n    \n    rep(i,1003) ans[i]=(1<<N)-1;\n    unsigned long mask=0;\n    string S,B;\n    rep(i,Q) {\n        cin>>S>>B;\n        update(mask, S,B);\n\n        // rep(i,M) cout<<ans[i]<<\",\";\n        // cout<<endl;\n    }\n    plot();\n}\n\nint main() {\n    while(cin>>N>>M>>Q) {\n        if(N+M+Q==0) break;\n        solve();\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\nusing pii = pair<int, int>;\n\nint main() {\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n  \n  int n, m, q;\n  while (cin >> n >> m >> q, n) {\n    vector<string> s(q), b(q);\n    for (int i = 0; i < q; i++) {\n      cin >> s[i] >> b[i];\n    }\n\n    vector<int> on(n, 0);\n    vector<vector<int>> cor(n, vector<int>(m, 1));\n    for (int i = 0; i < q; i++) {\n      for (int j = 0; j < n; j++) {\n        on[j] ^= (s[i][j] == '1');\n        for (int k = 0; k < m; k++) {\n          if (!cor[j][k]) continue;\n          if (s[i][j] == '1') {\n            if (on[j]) cor[j][k] = (b[i][k] == '1' && (i == 0 || b[i - 1][k] == '0'));\n            else cor[j][k] = (b[i][k] == '0' && (i != 0 && b[i - 1][k] == '1'));\n          } else {\n            if (on[j]) cor[j][k] = (b[i][k] == '1' && (i != 0 && b[i - 1][k] == '1'));\n            else cor[j][k] = (b[i][k] == '0' && (i == 0 || b[i - 1][k] == '0'));\n          }\n        }\n      }\n    }\n\n    for (int j = 0; j < m; j++) {\n      int ans = -1;\n      for (int i = 0; i < n; i++) {\n        if (cor[i][j] && ans != -2) ans = ans < 0 ? i : -2;\n      }\n      cout << (char)(ans == -2 ? '?' : ans < 10 ? ans + '0' : ans - 10 + 'A');\n    }\n    cout << endl;\n  }\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define for_(i,a,b) for(int i=a;i<b;++i)\n\nchar trans(int x) {\n\tif (0 <= x && x <= 9) return char('0' + x);\n\tx -= 10;\n\treturn char('A' + x);\n}\n\nint main() {\n\tint N, M, Q;\n\t\n\twhile (cin >> N >> M >> Q, N) {\n\t\tvector< set< char > > cnd(M);\n\t\tvector< bool > on(N, false);\n\t\t\n\t\tfor_(i,0,M) for_(x,0,N) cnd[i].insert(trans(x));\n\t\t\n\t\tfor_(i,0,Q) {\n\t\t\tstring S, B; cin >> S >> B;\n\t\t\t\n\t\t\tfor_(j,0,N) if (S[j] == '1') on[j] = !on[j];\n\t\t\t\n\t\t\tfor_(j,0,M) {\n\t\t\t\tif (B[j] == '1') {\n\t\t\t\t\tfor_(k,0,N) if (!on[k]) cnd[j].erase(trans(k));\n\t\t\t\t} else {\n\t\t\t\t\tfor_(k,0,N) if (on[k]) cnd[j].erase(trans(k));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor_(i,0,M) {\n\t\t\tif (cnd[i].size() == 1) cout << *cnd[i].begin();\n\t\t\telse cout << \"?\";\n\t\t}\n\t\tcout << endl;\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing vi=vector<int>;\nusing vvi=vector<vi>;\nusing vd=vector<double>;\nusing vvd=vector<vd>;\nusing vl=vector<ll>;\nusing vvl=vector<vl>;\nusing pii=pair<int,int>;\nusing vs=vector<string>;\n#define rep(i,n) range(i,0,n)\n#define range(i,a,n) for(int i=a;i<n;i++)\n#define all(a) a.begin(),a.end()\n#define LINF    \t((ll)1ll<<60)\n#define INF     \t((int)1<<30)\n#define EPS     \t(1e-9)\n#define MOD     \t(1000000007)\n#define fcout(a)\tcout<<setprecision(a)<<fixed\n#define fs \t\t\tfirst\n#define sc\t\t\tsecond\n#define PI\t\t\t3.141592653589793\n\ntemplate<class S,class T>ostream& operator<<(ostream&os,pair<S,T>p){os<<\"[\"<<p.first<<\", \"<<p.second<<\"]\";return os;};\ntemplate<class S>auto&operator<<(ostream&os,vector<S>t){bool a=1; for(auto s:t){os<<(a?\"\":\" \")<<s; a=0;} return os;}\n\nint main(){\n\tcin.tie(0);\n   \tios::sync_with_stdio(false);\n\tusing bulbs=bitset<1000>;\n\tint n,m,q;\n\twhile(cin>>n>>m>>q,n){\n\t    vl s(q);\n\t    vector<bulbs> b(q);\n\t    bulbs tmp;\n\t    rep(i,q){\n      \t    string S,B;\n      \t    cin>>S>>B;\n      \t    s[i]=stoll(S,nullptr,2);\n      \t    b[i]=bulbs(B);\n      \t    if(i>0){\n      \t        //s[i]^=s[i-1];\n      \t        auto tmp2=b[i];\n      \t        b[i]^=tmp;\n      \t        tmp=tmp2;\n      \t    }else{\n      \t        tmp=b[i];\n      \t    }\n      \t    //cout<<bitset<11>(s[i]).to_string()<<\":\"<<b[i].to_string()<<endl;\n\t    }\n\t    string ans(m,'?');\n\t\tstring d=\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\t\trep(i,m){\n\t\t\tbulbs mask;\n\t\t\tmask[m-i-1]=true;\n\t\t\tll S=(1ll<<36)-1; auto B=~bulbs();\n\t\t\trep(j,q){\n\t\t\t\tif((b[j]&mask).any()){\n\t\t\t\t\tS&=s[j];\n\t\t\t\t\tB&=b[j];\n\t\t\t\t}else{\n\t\t\t\t\tS&=~s[j];\n\t\t\t\t\tB&=~b[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\t//cout<<pii(p,i)<<bulbs(S).to_string()<<\",\"<<B<<endl;\n\t\t\tif(__builtin_popcountll(S)==1){\n\t\t\t\tint index=n-1-__builtin_ctzll(S);\n\t\t\t\td[index]='_';\n\t\t\t\trep(j,m){\n\t\t\t\t\tbulbs mask2; mask2[m-j-1]=true;\n\t\t\t\t\tif((B&mask2).any())ans[j]=\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"s[index];\n\t\t\t\t}\n\t\t\t\trep(j,q){\n\t\t\t\t\ts[j]&=~S;\n\t\t\t\t\tb[j]&=~B;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n        if(count(all(d),'_')==n-1){\n\t\t\trep(i,n){\n\t\t\t\tif(d[i]!='_'){\n\t\t\t\t\trep(j,m){\n\t\t\t\t\t\tif(ans[j]=='?') ans[j]=d[i];\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n        }\n\t    cout<<ans<<endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cassert>\nusing namespace std;\ntypedef long long ll;\nint N,M,Q;\nll s[4000];\nstring t[4000];\n\nll func(string str){\n  ll res=0;\n  for(int i=0;i<(int)str.size();i++)\n    if(str[i]=='1')res+=(1LL<<i);\n  return res;\n}\n\nint main(){\n  char change[36];\n  change[0]='0';\n  for(int i=1;i<10;i++)change[i]=change[i-1]+1;\n  change[10]='A';\n  for(int i=11;i<36;i++)change[i]=change[i-1]+1;\n\n  while(1){\n    cin>>N>>M>>Q;\n    if(N==0&&M==0&&Q==0)break;\n    for(int i=0;i<Q;i++){\n      string str;\n      cin>>str>>t[i];\n      s[i]=func(str);\n      if(i)s[i]=s[i]^s[i-1];\n    }\n\n    for(int i=0;i<M;i++){\n      ll f=(1LL<<N)-1;\n      for(int j=0;j<Q;j++){\n\tif(t[j][i]=='1'){\n\t  f=f&s[j];\n\t}else {\n\t  f=f&(~s[j]);\n\t}\n      }\n      assert(__builtin_popcountll(f)!=0);\n      if(__builtin_popcountll(f)==1){\n\tint ans=0;\n\tfor(ans=0;ans<N;ans++){\n\t  if(f==(1LL<<ans))break;\n\t}\n\tcout<<change[ans];\n      }else{\n\tcout<<'?';\n      }\n    }\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nchar ans_c(int c){\n\tif (c < 10)\n\t\treturn '0'+c;\n\treturn 'A' + c - 10;\n}\n\nint main() {\n\tint N, M, Q;\n\twhile (cin >> N >> M >> Q, N){\n\t\tstring switch_s;\n\t\tstring bswitch_s;\n\t\tstring light_s;\n\t\tstring blight_s;\n\t\tvector<vector<bool>> vvb(M,vector<bool>(N,true));\n\t\tREP(i, N)\n\t\t\tbswitch_s.append(i,'0');\n\t\tREP(i, M)\n\t\t\tblight_s.append(i,'0');\n\n\t\tREP(i, Q){\n\t\t\tcin >> switch_s;\n\t\t\tcin >> light_s;\n\t\t\t//-----------//\n\t\t\tREP(j, N){\n\t\t\t\tREP(k, M){\n\t\t\t\t\tif ((switch_s[j]=='0') != (light_s[k] == blight_s[k])){\n\t\t\t\t\t\tvvb[k][j]=false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//-----------//\n\t\t\tbswitch_s= switch_s;\n\t\t\tblight_s = light_s;\n\t\t}\n\n\n\t\tREP(i,M){\n\t\t\tint count = 0;\n\t\t\tint ans = 0;\n\t\t\tREP(j, N){\n\t\t\t\tif (vvb[i][j]){\n\t\t\t\t\tcount++;\n\t\t\t\t\tans = j;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (count == 1)cout << ans_c(ans);\n\t\t\telse cout << '?';\n\t\t}\n\t\tcout << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\nint main() {\n\tint n, m, q;\n\twhile (cin >> n >> m >> q, n) {\n\t\tif (q == 0) {\n\t\t\tif (n != 1) {\n\t\t\t\trep(i, m) {\n\t\t\t\t\tcout << \"?\";\n\t\t\t\t}\n\t\t\t\tcout << endl;\n\t\t\t}\n\t\t\telse {\n\t\t\t\trep(i, m) {\n\t\t\t\t\tcout << \"0\";\n\t\t\t\t}\n\t\t\t\tcout << endl;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tchar signal[1000][36];\n\t\tchar light[1000][1000];\n\t\trep(i, q) {\n\t\t\tstring s, t;\n\t\t\tcin >> s >> t;\n\t\t\trep(k, n) {\n\t\t\t\tsignal[i][k] = s[k];\n\t\t\t}\n\t\t\trep(k, m) {\n\t\t\t\tlight[i][k] = t[k];\n\t\t\t}\n\t\t}\n\t\tint con[36][1000] = {};\n\t\trep(i, q) {\n\t\t\tif (i >= 1) {\n\t\t\t\trep(j, n) {\n\t\t\t\t\tint x = signal[i][j] - '0';\n\t\t\t\t\tint y = signal[i - 1][j] - '0';\n\t\t\t\t\tsignal[i][j] = '0'+((x + y) % 2);\n\t\t\t\t}\n\t\t\t}\n\t\t\trep(j, n) {\n\t\t\t\trep(k, m) {\n\t\t\t\t\tif (signal[i][j] == light[i][k]) {\n\t\t\t\t\t\tcon[j][k]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint out[1000];\n\t\tfill(out, out + 1000, -1);\n\t\trep(j, m) {\n\t\t\tint chk = -1;\n\t\t\trep(i, n) {\n\t\t\t\tif (con[i][j] == q) {\n\t\t\t\t\tif (chk >= 0)chk = 100;\n\t\t\t\t\tchk = max(chk, i);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (chk < 100) {\n\t\t\t\tout[j] = chk;\n\t\t\t}\n\t\t}\n\t\trep(i, m) {\n\t\t\tif (out[i] == -1) {\n\t\t\t\tcout << \"?\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (out[i] < 10) {\n\t\t\t\t\tcout << out[i];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tcout << char('A' + out[i] - 10);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\n#include <ctype.h>\n#include <string> \n#include <sstream>\n#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <map>\n#include <queue>\n#include <utility>\n#include <vector>\n#include <set>\n#include <iomanip>\n#include <stack>\n  \nusing namespace std;\n\n#define pi 3.141592653589793\n\nvoid solve(int n, int m, int q, string s[], string b[], int ans[])\n{\n\tint cnt[1001][36] = {};\n\tfor(int i = 1; i < q + 1; i++){\n\t\tfor(int j = 0; j < m; j++){\n\t\t\tif(b[i - 1][j] != b[i][j]){\n\t\t\t\tfor(int k = 0; k < n; k++){\n\t\t\t\t\tcnt[j][k] += s[i][k] - '0';\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tfor(int k = 0; k < n; k++){\n\t\t\t\t\tcnt[j][k] -= s[i][k] - '0';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i = 0; i < m; i++){\n\t\tint maxi = -1, ansi = -1;\n\t\tfor(int j = 0; j < n; j++){\n\t\t\tif(cnt[i][j] > maxi){\n\t\t\t\tmaxi = cnt[i][j];\n\t\t\t\tansi = j;\n\t\t\t}else if(cnt[i][j] == maxi){\n\t\t\t\tansi = -1;\n\t\t\t}\n\t\t}\n\t\tans[i] = ansi;\n\t}\n\treturn;\n\t// 一つ前のbと比べて変化しているところを探す。\n\t// i - 1番目のbとiばんめのbを比べる。それぞれのbのj番目が異なる場合、その時(iのとき)その電気のスイッチが押されている\n\t// cntにs[i][j]を加える。\n\t// 最終的に最大値を取るものが答えになる…はず？\n}\n\nint main()\n{\n\tint n, m, q;\n\twhile(1){\n\t\tcin >> n >> m >> q;\n\t\tif(n == 0 && m == 0 && q == 0) break;\n\t\tstring s[1001] = {}, b[1001] = {};\n\t\tfor(int i = 0; i < m; i++){\n\t\t\tb[0] += '0';\n\t\t}\n\t\tfor(int i = 1; i < q + 1; i++){\n\t\t\tcin >> s[i] >> b[i];\n\t\t}\n\t\tint ans[1001];\n\t\tsolve(n, m, q, s, b, ans);\n\t\tchar answer;\n\t\tfor(int i = 0; i < m; i++){\n\t\t\tif(ans[i] == -1) answer = '?';\n\t\t\telse if(ans[i] < 10) answer = ans[i] + '0';\n\t\t\telse answer = 'A' + ans[i] - 10;\n\t\t\tcout << answer;\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n\nint main()\n{\n\tll N, M, Q;\n\tstring S, B;\n\twhile (cin >> N >> M >> Q, N | M | Q) {\n\t\tvector<ll> able(M, (1ll << N) - 1);\n\t\tll s = 0;\n\t\tfor (ll i = 0; i < Q; i++) {\n\t\t\tcin >> S >> B;\n\t\t\tfor (ll j = 0; j < N; j++) {\n\t\t\t\tif (S[j] == '1') {\n\t\t\t\t\ts ^= 1ll << j;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (ll j = 0; j < M; j++) {\n\t\t\t\tif (B[j] == '1') {\n\t\t\t\t\table[j] &= s;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\table[j] &= ~s;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (ll i = 0; i < M; i++) {\n\t\t\tll res = -1;\n\t\t\tfor (ll j = 0; j < N; j++) {\n\t\t\t\tif (able[i] == (1ll << j)) {\n\t\t\t\t\tres = j;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (res == -1) {\n\t\t\t\tcout << '?';\n\t\t\t}\n\t\t\telse if (res < 10) {\n\t\t\t\tcout << res;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcout << (char)(res - 10 + 'A');\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n, m, q;\nstring s[1000], b[1000];\n\nint get(unsigned long long x){\n\tint res = 0;\n\twhile (x > 1){\n\t\tres++;\n\t\tx >>= 1;\n\t}\n\treturn res;\n}\n\nvoid solve()\n{\n\tfor (int i = 1; i < q; i++){\n\t\tfor (int j = 0; j < n; j++){\n\t\t\ts[i][j] = '0' + (s[i - 1][j] != s[i][j]);\n\t\t}\n\t\t/*for (int j = 0; j < m; j++){\n\t\t\tb[i][j] = '0' + (b[i - 1][j] != b[i][j]);\n\t\t}*/\n\t}\n\t\n\tstatic unsigned long long f[1000];\n\tfor (int i = 0; i < m; i++) f[i] = (1ull << n) - 1;\n\t\n\tfor (int i = 0; i < q; i++){\n\t\tfor (int j = 0; j < n; j++){\n\t\t\tfor (int k = 0; k < m; k++){\n\t\t\t\tif (s[i][j] != b[i][k]) f[k] &= ~(1ull << j);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfor (int i = 0; i < m; i++){\n\t\tif (f[i] != (f[i] & -f[i])) printf(\"?\");\n\t\telse if (f[i] == 0) printf(\"?\");\n\t\telse {\n\t\t\tint t = get(f[i]);\n\t\t\tif (t <= 9) printf(\"%d\", t);\n\t\t\telse printf(\"%c\", 'A' + (t - 10));\n\t\t}\n\t}\n\tputs(\"\");\n}\n\nint main()\n{\n\twhile (scanf(\"%d %d %d\", &n, &m, &q), n){\n\t\tfor (int i = 0; i < q; i++){\n\t\t\tcin >> s[i] >> b[i];\n\t\t}\n\t\tsolve();\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\nint main(){\n  int n,m,q;\n  cin >> n >> m >> q;\n  int i,j,k;\n  string s,b;\n  while((n+m+q)!=0){\n    int table[1001][40]={{}};\n    int onoff[40]={};\n    \n    for(i=0;i<q;i++){\n      cin >> s >> b;\n      for(j=0;j<n;j++){\n\tif(s[j]=='1') {\n\t  if(onoff[j]==0) onoff[j]=1;\n\t  else onoff[j]=0;\n\t}\n      }\n      int c=0,x;\n      for(j=0;j<n;j++){\n\tc+=onoff[j];\n\tif(onoff[j]==1) x=j;\n      }\n      if(c==1){\n\tfor(j=0;j<m;j++){\n\t  if(b[j]=='1'){\n\t    for(k=0;k<n;k++){\n\t      if(k!=x) table[j][k]=1;\n\t    }\n\t  }\n\t}\n      }\n      for(j=0;j<m;j++){\n\tif(b[j]=='0'){\n\t  for(k=0;k<n;k++){\n\t    if(table[j][k]==0){\n\t      if(onoff[k]==1)\n\t\ttable[j][k]=1;\n\t    }\n\t  }\n\t}\n      }\n      \n      int ch[1001]={},id[40]={};\n      for(j=0;j<m;j++){\n\tfor(k=0;k<n;k++){\n\t  if(table[j][k]==1) ch[j]++;\n\t  if(table[j][k]==0) id[j]=k;\n\t}\n      }\n      for(j=0;j<m;j++){\n\tif(ch[j]+1==n){\n\t  //cout <<\"a\"<< endl;\n\t  for(k=0;k<m;k++){\n\t    if(ch[k]+1!=n){\n\t      table[k][id[j]]=1;\n\t    }\n\t  }\n\t}\n      }\n      \n      \n    }\n\n    for(j=0;j<m;j++){\n\tint c=0,id;\n\tfor(k=0;k<n;k++){\n\t  if(table[j][k]==1) c++;\n\t  if(table[j][k]==0) id=k;\n\t}\n\tchar buf;\n\tif(c+1==n){\n\t  if(id<10) buf=id+'0';\n\t  else buf='A'+id-10;\n\t}else{\n\t  buf='?';\n\t}\n\tcout << buf;\n      }\n    cout << endl;\n    cin >> n >> m >> q;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<cstring>\n#include<vector>\n#include<set>\n#include<list>\n#include<queue>\n#include<cmath>\n#include<functional>\n#include<algorithm>\n#define INF (1<<29)\n#define rep(i,n) for(int i=0;i<(n);i++)\nusing namespace std;\n\n\n\nint bits_ctzll(unsigned long long b){\n\tb&=-b;\n\tint res=0;\n\tfor(int i=5;i>=0;i--){\n\t\tint shift=1<<i;\n\t\tif(b>>shift){\n\t\t\tb>>=shift;\n\t\t\tres|=shift;\n\t\t}\n\t}\n\treturn res;\n}\n\n\nint main(){\n\tint n,m,q;\n\tlong long maybe[1000];\n\n\twhile(cin>>n>>m>>q,n|m|q){\n\t\tfill_n(maybe,m,(1LL<<n)-1);\n\t\tlong long switches=0;\n\t\trep(i,q){\n\t\t\tlong long s=0;\n\t\t\tstring str,b;\n\t\t\tcin>>str;\n\t\t\trep(i,n)s|=(long long)(str[i]-'0')<<i;\n\t\t\tcin>>b;\n\t\t\tswitches^=s;\n\t\t\trep(i,m){\n\t\t\t\tif(b[i]=='1'){\n\t\t\t\t\tmaybe[i]&=switches;\n\t\t\t\t}else{\n\t\t\t\t\tmaybe[i]&=~switches;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\trep(i,m){\n\t\t\tif(maybe[i]&maybe[i]-1){\n\t\t\t\tcout<<'?';\n\t\t\t}else{\n\t\t\t\tint ctz=bits_ctzll(maybe[i]);\n\t\t\t\tif(ctz<10)cout<<ctz;\n\t\t\t\telse cout<<char('A'+ctz-10);\n\t\t\t}\n\t\t}\n\t\tcout<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n\nint main() {\n  \n  int N, M, Q;\n  while(cin>>N>>M>>Q&&(N|M|Q)) {\n    int S[36][1000];\n    string prev; rep(i, M) prev += '0';\n    rep(i, 36) {\n      rep(j, 1000) S[i][j] = 1;\n    }\n    \n    rep(I, Q) {\n      string s, t; cin >> s >> t;\n      rep(i, N) rep(j, M) {\n        if(bool(s[i]-'0') == (t[j]-'0'==prev[j]-'0')) {\n          S[i][j] = 0;\n        }\n      }\n      prev = t;\n    }\n    \n    rep(j, M) {\n      int id = -1;\n      rep(i, N) {\n        if(id != -1 && S[i][j]) { id = -1; break; }\n        if(id == -1 && S[i][j]) { id = i; }\n      }\n      if(id == -1) { cout << '?'; }\n      else { cout << ( id < 10 ? char('0'+id) : char('A'+(id-10))); }\n    }\n    cout << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\nint main(){\n  int n,m,q;\n  cin >> n >> m >> q;\n  int i,j,k;\n  string s,b;\n  while((n+m+q)!=0){\n    int table[1001][40]={{}};\n    fill(table[0],table[1001],1);\n    int onoff[40]={};\n    \n    for(i=0;i<q;i++){\n      cin >> s >> b;\n      for(j=0;j<n;j++){\n\tif(s[j]=='1') {\n\t  if(onoff[j]==0) onoff[j]=1;\n\t  else onoff[j]=0;\n\t}\n      }\n      int c=0,x;\n      /*\n      for(j=0;j<n;j++){\n\tc+=onoff[j];\n\tif(onoff[j]==1) x=j;\n      }\n      if(c==1){\n\tfor(j=0;j<m;j++){\n\t  if(b[j]=='1'){\n\t    for(k=0;k<n;k++){\n\t      if(k!=x) table[j][k]=1;\n\t    }\n\t  }\n\t}\n      }\n      */\n      for(j=0;j<m;j++){\n\tif(b[j]=='1'){\n\t  for(k=0;k<n;k++){\n\t    /*\n\t    if(table[j][k]==0){\n\t      if(onoff[k]==1)\n\t\ttable[j][k]=1;\n\t    }\n\t    */\n\t    table[j][k]*=onoff[k];\n\t  }\n\t}else{\n\t  for(k=0;k<n;k++){\n\t    //cout << j << \" \" << k << endl;\n\t    if(onoff[k]==1)\n\t    table[j][k]=0;\n\t  }\n\t}\n      }\n      /*\n      int ch[1001]={},id[40]={};\n      for(j=0;j<m;j++){\n\tfor(k=0;k<n;k++){\n\t  if(table[j][k]==1) ch[j]++;\n\t  if(table[j][k]==0) id[j]=k;\n\t}\n      }\n      for(j=0;j<m;j++){\n\tif(ch[j]+1==n){\n\t  //cout <<\"a\"<< endl;\n\t  for(k=0;k<m;k++){\n\t    if(ch[k]+1!=n){\n\t      table[k][id[j]]=1;\n\t    }\n\t  }\n\t}\n      }\n      */\n      \n    }\n\n    for(j=0;j<m;j++){\n      /*\n\tint c=0,id;\n\tfor(k=0;k<n;k++){\n\t  if(table[j][k]==1) c++;\n\t  if(table[j][k]==0) id=k;\n\t}\n\tchar buf;\n\tif(c+1==n){\n\t  if(id<10) buf=id+'0';\n\t  else buf='A'+id-10;\n\t}else{\n\t  buf='?';\n\t}\n\tcout << buf;\n      */\n      int c=0,id;\n      for(k=0;k<n;k++){\n\tc+=table[j][k];\n\tif(table[j][k]==1) id=k;\n      }\n      char buf;\n      if(c==1){\n\tif(id<10) buf=id+'0';\n\telse buf='A'+id-10;\n      }else{\n\tbuf='?';\n      }\n      cout << buf;\n    }\n    cout << endl;\n    cin >> n >> m >> q;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<ll, ll> P;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(ll i=(ll)(a);i<(ll)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define each(itr,v) for(auto itr:v)\n#define pb push_back\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define mmax(x,y) (x>y?x:y)\n#define mmin(x,y) (x<y?x:y)\n#define maxch(x,y) x=mmax(x,y)\n#define minch(x,y) x=mmin(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt __builtin_popcount\n\n#define INF INT_MAX/3\n\nint n,m,q;\nbool sw[1111];\nbool light[1111][50];\n\nint main(){\n\tcin.sync_with_stdio(false);\n  while(1){\n    cin>>n>>m>>q;\n    if(n==0)break;\n    memset(sw,0,sizeof(sw));\n    rep(i,1111)rep(j,50)light[i][j]=true;\n    rep(hoge,q){\n      string s1,s2;\n      cin>>s1>>s2;\n      rep(i,n){\n        if(s1[i]=='1')sw[i]=1-sw[i];\n      }\n      rep(i,m){\n        rep(j,n){\n          if((!sw[j]&&s2[i]=='1')||(sw[j]&&s2[i]=='0'))light[i][j]=false;\n        }\n      }\n    }\n    rep(i,m){\n      int cnt=0,idx;\n      rep(j,n)if(light[i][j]){\n        cnt++; idx=j;\n      }\n      //dbg(cnt);\n      if(cnt!=1)cout<<\"?\";\n      else cout<<(char)(idx>9?'A'+idx-10:'0'+idx);\n    }\n    cout<<endl;\n  }\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\nusing namespace std;\nint main(){\n\n  int N,M,Q;\n    \n  while(1){\n    cin >>N>>M>>Q;\n    if(N+M+Q == 0)break;\n    char s[1000][36],l[1000][1000];\n    int data[N][M];\n    \n    for(int i=0 ; i < Q ; i++)scanf(\"%s%s\",s[i],l[i]);;\n    \n    for(int i=0 ; i < N ; i++)\n      for(int j=0 ; j < M ; j++)\n\tdata[i][j]=1;\n\n    for(int i=0 ; i < Q-1 ; i++){\n      for(int j=0 ; j < N ; j++){\n\tif(s[i][j] == '1'){\n\t  if(s[i+1][j] == '1'){\n\t    s[i+1][j]='0';\n\t  }else{\n\t    s[i+1][j]='1';\n\t  }\n\t}\n      }\n    }\n\n    //for(int i=0 ; i < Q ; i++)cout <<s[i]<<endl;\n    \n    for(int i=0 ; i < Q ; i++){\n      for(int j=0 ; j < N ; j++){\n\tfor(int k=0 ; k < M ; k++){\n\t  if(s[i][j] != l[i][k])data[j][k] = 0;\n\t}\n      }\n    }\n\n    /*\n    for(int i=0 ; i < N ; i++){\n      for(int j=0 ; j < M ; j++){\n\tcout <<data[i][j]<<\" \";\n      }\n      cout <<endl;\n    }\n    */\n\n    for(int i=0 ; i < M ; i++){\n      int cnt=0;\n      int num;\n      for(int j=0 ; j < N ; j++){\n\tcnt+=data[j][i];\n\tif(data[j][i])num=j;\n      }\n      if(cnt == 1){\n\tif(num <= 9){\n\t  cout <<num;\n\t}else{\n\t  cout <<(char)('A'+num-10);\n\t}\n      }else{\n\tcout <<'?';\n      }\n    }\n    cout <<endl;\n    \n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <cstring>\n\n#include <iostream>\n#include <complex>\n#include <string>\n#include <algorithm>\n#include <numeric>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n#include <unordered_map>\n#include <unordered_set>\n\n#include <functional>\n#include <cassert>\n\ntypedef long long ll;\nusing namespace std;\n\n#ifndef LOCAL\n#define debug(x) ;\n#else\n#define debug(x) cerr << __LINE__ << \" : \" << #x << \" = \" << (x) << endl;\n\ntemplate <typename T1, typename T2>\nostream &operator<<(ostream &out, const pair<T1, T2> &p) {\n  out << \"{\" << p.first << \", \" << p.second << \"}\";\n  return out;\n}\n\ntemplate <typename T>\nostream &operator<<(ostream &out, const vector<T> &v) {\n  out << '{';\n  for (const T &item : v) out << item << \", \";\n  out << \"\\b\\b}\";\n  return out;\n}\n#endif\n\n#define mod 1000000007 //1e9+7(prime number)\n#define INF 1000000000 //1e9\n#define LLINF 2000000000000000000LL //2e18\n#define SIZE 200010\n\nbool solve() {\n  int N, M, Q;\n  ll ans[SIZE];\n\n  scanf(\"%d%d%d\", &N, &M, &Q);\n\n  if (N == 0) return false;\n\n  for (int i=0; i<M; i++) {\n    ans[i] = (1LL << N) - 1;\n  }\n\n  ll prev = 0;\n\n  for (int i=0; i<Q; i++) {\n    ll x = 0;\n    for (int j=0; j<N; j++) {\n      ll b;\n      scanf(\"%1lld\", &b);\n      x += b << j;\n    }\n\n    x ^= prev;\n    prev = x;\n\n    for (int j=0; j<M; j++) {\n      int b;\n      scanf(\"%1d\", &b);\n      if (b) ans[j] &= x;\n      else ans[j] &= ~x;\n    }\n  }\n\n  string name;\n  for (int i=0; i<10; i++) name += '0' + i;\n  for (int i=0; i<26; i++) name += 'A' + i;\n\n  for (int i=0; i<M; i++) {\n    if (__builtin_popcountll(ans[i]) != 1)\n      printf(\"?\");\n    else\n      printf(\"%c\", name[__builtin_ctzll(ans[i])]);\n  }\n\n  puts(\"\");\n\n  return true;\n}\n\nint main(){\n  while(solve());\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n  string base36 = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ?\";\n  int N, M, Q;\n  while(cin >> N >> M >> Q, N || M || Q){\n    long long bulb[1000]; memset(bulb, -1LL, sizeof(bulb));\n    long long swch = 0LL;\n    for(int i = 0; i < Q; i++){\n      string S, B;\n      cin >> S >> B;\n      long long s = 0LL, b = 0LL;\n      for(int j = 0; j < N; j++) if(S[j] == '1') s |= (1LL << j);\n      for(int j = 0; j < M; j++) if(B[j] == '1') b |= (1LL << j);\n      swch ^= s;\n      for(int j = 0; j < M; j++){\n\tif((b >> j) & 1LL){\n\t  bulb[j] &= swch;\n\t} else {\n\t  bulb[j] &= ~swch;\n\t}\n      }\n    }\n    for(int i = 0; i < M; i++){\n      int ctrl = -1;\n      int cnt = 0;\n      for(int j = 0; j < N; j++){\n\tif((bulb[i] >> j) & 1LL) cnt++, ctrl = j;\n      }\n      if(cnt == 1) cout << base36[ctrl];\n      else cout << \"?\";\n    }\n    cout << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\nusing namespace std;\n\n// ???\nint main(){\n    auto f = [](int val)->char{\n        if(val <= 9)    return (char)('0'+val);\n        return (char)('A'+val-10);\n    };\n\n    int n, m, q;\n    while(cin >> n >> m >> q, n+m+q){\n        vector<string> s(q+1), b(q+1);\n        s[0] = b[0] = \"\";\n        for(int i = 0; i < n; i++)  s[0] += \"0\";\n        for(int i = 0; i < m; i++)  b[0] += \"0\";\n        for(int i = 1; i <= q; i++)  cin >> s[i] >> b[i];\n        vector<int> cnt(m, 0);\n        vector<bool> push(n, 0);\n        vector<vector<int>> tmp(n, vector<int>(m, 0));\n        vector<vector<bool>> flag(n, vector<bool>(m,0));\n        for(int i = 1; i <= q; i++){\n            for(int j = 0; j < m; j++){\n                if(b[i-1][j] != b[i][j])    cnt[j]++;\n                for(int k = 0; k < n; k++){\n                    if(s[i][k] == '1'){\n                        push[k] = true;\n                        tmp[k][j] += b[i-1][j] != b[i][j];\n                        if(b[i-1][j]==b[i][j])  flag[k][j] = true;\n                    }\n                }\n            }\n        }\n        int notpushed = 0, ind = -1;\n        for(int i = 0; i < n; i++)  if(!push[i]) notpushed++, ind = i;\n        for(int i = 0; i < m; i++){\n            if(cnt[i] == 0){\n                cout << (notpushed==1 ? f(ind) : '?');\n            }else{\n                int tmpcnt = 0, ind = -1;\n                for(int j = 0; j < n; j++){\n                    if(!flag[j][i] && cnt[i] == tmp[j][i]){\n                        tmpcnt++, ind = j;\n                    }\n                }\n                cout << (tmpcnt==1 ? f(ind) : '?');\n            }\n        }\n        cout << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long int ll;\nconst ll INF = 1LL << 28;\n\nll N;\nvector<ll> num;\nmap<ll,ll> memo;\nqueue<ll> q;\nfunction<ll(ll)> seki;\n\nint main() {\n    cin >> N;\n    q.push(2LL); q.push(8LL);\n    while (q.size()) {\n        ll n = q.front(); q.pop();\n        num.push_back(n);\n        if (n <= 1e18) {\n            q.push(n * 10LL + 8LL);\n            q.push(n * 10LL + 2LL);\n        }\n    }\n\n\n    sort(num.begin(), num.end());\n\n    seki = [&](ll n) -> ll {\n        if (memo.find(n) != memo.end()) return memo[n];\n\n        int i = (int)(lower_bound(num.begin(), num.end(), n) - num.begin());\n        memo[n] = -INF;\n        if (num[i] == n) memo[n] = 1;\n        for (; i > -1; i--) {\n            if (n % num[i] == 0 ) {\n                memo[n] = max(memo[n], seki(n / num[i]) + seki(num[i]));\n            }\n        }\n\n\n        return memo[n];\n    };\n\n    int ans = seki(N);\n    if (ans > 0) cout << ans << endl;\n    else cout << -1 << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long h[1100];\nchar s[1100];\nchar t[1100];\nint main(){\n\tint a,b,c;\n\twhile(scanf(\"%d%d%d\",&a,&b,&c),a){\n\t\tfor(int i=0;i<b;i++)h[i]=(1LL<<a)-1;\n\t\tlong long val=0;\n\t\tfor(int i=0;i<c;i++){\n\t\t\tscanf(\"%s%s\",s,t);\n\t\t\tlong long key=0;\n\t\t\tfor(int j=0;j<a;j++){\n\t\t\t\tif(s[j]=='1')key+=(1LL<<j);\n\t\t\t}\n\t\t\tval^=key;\n\t\t\tfor(int j=0;j<b;j++){\n\t\t\t\tif(t[j]=='1'){\n\t\t\t\t\th[j]&=val;\n\t\t\t\t}else {\n\t\t\t\t\th[j]&=~val;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<b;i++){\n\t\t\tif(__builtin_popcountll(h[i])>1)printf(\"?\");\n\t\t\telse{\n\t\t\t\tint at=0;\n\t\t\t\tfor(int j=0;j<a;j++)if(h[i]==(1LL<<j))at=j;\n\t\t\t\tif(at<10)printf(\"%d\",at);\n\t\t\t\telse printf(\"%c\",'A'+at-10);\n\t\t\t}\n\t\t}\n\t\tprintf(\"\\n\");\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nconst char Switch[40] = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\nint n, m, q;\n\nstd::bitset<36> a[2005];\nstd::bitset<1000> tmp[1005], bs[2005];\n\nchar ans[1005];\nint bit[36];\nbool fr[36];\n\nvoid Gauss() {\n\tmemset(fr, 0, sizeof fr);\n\t\n\tint now = 0;\n\tfor (int i = 0; i < n; ++i) {\n\t\tint r = -1;\n\t\tfor (int j = now; j <= q; ++j) if (a[j][i]) {\n\t\t\tr = j; break;\n\t\t}\n\t\tif (r == -1) {\n\t\t\tfr[i] = 1;\n\t\t\tcontinue;\n\t\t}\n\t\tstd::swap(a[now], a[r]);\n\t\tstd::swap(bs[now], bs[r]);\n\t\tfor (int j = 0; j <= q; ++j) if (j != now && a[j][i]) {\n\t\t\ta[j] ^= a[now];\n\t\t\tbs[j] ^= bs[now];\n\t\t}\n\t\tbit[now] = i;\n\t\t++now;\n\t}\n\t/*\n\tstd::cerr << now << std::endl;\n\tfor (int i = 0; i <= q; ++i) {\n\t\tfor (int j = 0; j < n; ++j)\n\t\t\tstd::cerr << a[i][j];\n\t\tstd::cerr << \" \";\n\t\tfor (int j = 0; j < m; ++j)\n\t\t\tstd::cerr << bs[i][j];\n\t\tstd::cerr << std::endl;\n\t}\n\t*/\n\tfor (int i = now - 1; i >= 0; --i) {\n\t\tfor (int j = bit[i] + 1; j < n; ++j) if (a[i][j] && fr[j]) {\n\t\t\tfr[i] = 1; break;\n\t\t}\n\t\tif (fr[i]) continue;\n\t\tfor (int j = 0; j < m; ++j) if (bs[i][j])\n\t\t\tans[j] = Switch[bit[i]];\n\t}\n}\n\nint main() {\n\twhile (~scanf(\"%d%d%d\", &n, &m, &q) && (n || m || q)) {\n\t\tfor (int i = 0; i < q; ++i) {\n\t\t\tstatic char s[1005];\n\t\t\t\n\t\t\t/*a[i].reset();\n\t\t\tbs[i].reset();\n\t\t\ttmp[i].reset();*/\n\t\t\tscanf(\"%s\", s);\n\t\t\tfor (int j = 0; j < n; ++j)\n\t\t\t\ta[i][j] = s[j] - '0';\n\t\t\t\n\t\t\tscanf(\"%s\", s);\n\t\t\tfor (int j = 0; j < m; ++j)\n\t\t\t\ttmp[i][j] = s[j] - '0';\n\t\t\t\n\t\t\tbs[i] = tmp[i];\n\t\t\tif (i) bs[i] ^= tmp[i - 1];\n\t\t}\n\t\tfor (int i = 0; i < q; ++i) {\n\t\t\ta[q + i] = ~a[i];\n\t\t\tbs[q + i] = ~bs[i];\n\t\t}\n\t\tq <<= 1;\n\t\tfor (int i = 0; i < n; ++i)\n\t\t\ta[q][i] = 1;\n\t\tfor (int i = 0; i < m; ++i)\n\t\t\tbs[q][i] = 1;\n\t\t\n\t\tfor (int i = 0; i < m; ++i)\n\t\t\tans[i] = '?';\n\t\tans[m] = '\\0';\n\t\t\n\t\tGauss();\n\t\t\n\t\tputs(ans);\n\t\t//std::cerr << std::endl;\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "// >>> TEMPLATES\n#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\nusing i32 = int32_t;\nusing i64 = int64_t;\nusing u32 = uint32_t;\nusing u64 = uint64_t;\n#define int ll\n#define double ld\n#define rep(i,n) for (int i = 0; i < (int)(n); i++)\n#define rep1(i,n) for (int i = 1; i <= (int)(n); i++)\n#define repR(i,n) for (int i = (int)(n)-1; i >= 0; i--)\n#define rep1R(i,n) for (int i = (int)(n); i >= 1; i--)\n#define loop(i,a,B) for (int i = a; i B; i++)\n#define loopR(i,a,B) for (int i = a; i B; i--)\n#define all(x) (x).begin(), (x).end()\n#define allR(x) (x).rbegin(), (x).rend()\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define fst first\n#define snd second\ntemplate <class Int> auto constexpr inf = numeric_limits<Int>::max()/2-1;\nauto constexpr INF32 = inf<int32_t>;\nauto constexpr INF64 = inf<int64_t>;\nauto constexpr INF   = inf<int>;\n#ifdef LOCAL\n#include \"debug.hpp\"\n#else\n#define dump(...) (void)(0)\n#define say(x) (void)(0)\n#define debug if (0)\n#endif\ntemplate <class T> using pque_max = priority_queue<T>;\ntemplate <class T> using pque_min = priority_queue<T, vector<T>, greater<T> >;\ntemplate <class T, class = typename T::iterator, class = typename enable_if<!is_same<T, string>::value>::type>\nostream& operator<<(ostream& os, T const& v) { bool f = true; for (auto const& x : v) os << (f ? \"\" : \" \") << x, f = false; return os; }\ntemplate <class T, class = typename T::iterator, class = typename enable_if<!is_same<T, string>::value>::type>\nistream& operator>>(istream& is, T &v) { for (auto& x : v) is >> x; return is; }\ntemplate <class T, class S> ostream& operator<<(ostream& os, pair<T,S> const& p) { return os << \"(\" << p.first << \", \" << p.second << \")\"; }\ntemplate <class T, class S> istream& operator>>(istream& is, pair<T,S>& p) { return is >> p.first >> p.second; }\nstruct IOSetup { IOSetup() { cin.tie(nullptr); ios::sync_with_stdio(false); cout << fixed << setprecision(15); } } iosetup;\ntemplate <class F> struct FixPoint : private F {\n    constexpr FixPoint(F&& f) : F(forward<F>(f)) {}\n    template <class... T> constexpr auto operator()(T&&... x) const { return F::operator()(*this, forward<T>(x)...); }\n};\nstruct MakeFixPoint {\n    template <class F> constexpr auto operator|(F&& f) const { return FixPoint<F>(forward<F>(f)); }\n};\n#define MFP MakeFixPoint()|\n#define def(name, ...) auto name = MFP [&](auto &&name, __VA_ARGS__)\ntemplate <class T, size_t d> struct vec_impl {\n    using type = vector<typename vec_impl<T,d-1>::type>;\n    template <class... U> static type make_v(size_t n, U&&... x) { return type(n, vec_impl<T,d-1>::make_v(forward<U>(x)...)); }\n};\ntemplate <class T> struct vec_impl<T,0> { using type = T; static type make_v(T const& x = {}) { return x; } };\ntemplate <class T, size_t d = 1> using vec = typename vec_impl<T,d>::type;\ntemplate <class T, size_t d = 1, class... Args> auto make_v(Args&&... args) { return vec_impl<T,d>::make_v(forward<Args>(args)...); }\ntemplate <class T> void quit(T const& x) { cout << x << endl; exit(0); }\ntemplate <class T, class U> constexpr bool chmin(T& x, U const& y) { if (x > y) { x = y; return true; } return false; }\ntemplate <class T, class U> constexpr bool chmax(T& x, U const& y) { if (x < y) { x = y; return true; } return false; }\ntemplate <class It> constexpr auto sumof(It b, It e) { return accumulate(b,e,typename iterator_traits<It>::value_type{}); }\ntemplate <class T> int sz(T const& x) { return x.size(); }\ntemplate <class C, class T> int lbd(C const& v, T const& x) {\n    return lower_bound(v.begin(), v.end(), x)-v.begin();\n}\ntemplate <class C, class T> int ubd(C const& v, T const& x) {\n    return upper_bound(v.begin(), v.end(), x)-v.begin();\n}\nconst int dx[] = { 1,0,-1,0 };\nconst int dy[] = { 0,1,0,-1 };\nconstexpr int popcnt(ll x) { return __builtin_popcountll(x); }\ntemplate <class Int> struct Random {\n    mt19937_64 mt{random_device{}()};\n    //mt19937_64 mt{(unsigned)time(0)};\n    Int a,b; // [a,b]\n    Random(Int a, Int b) : a(a), b(b) {}\n    Int operator()() { return uniform_int_distribution<Int>(a,b)(mt); }\n};\ntemplate <class Int> Int rand(Int a, Int b) { // [a,b]\n    static mt19937_64 mt{random_device{}()};\n    return uniform_int_distribution<Int>(a,b)(mt);\n}\n// <<<\n\nint32_t main() {\n    while (true) {\n        int n,m,q; cin >> n >> m >> q;\n        if (n == 0 && m == 0 && q == 0) break;\n        vector<string> t(n, string(m,'1'));\n        string sw(n,'0');\n        rep (_,q) {\n            string s,b; cin >> s >> b;\n            rep (i,n) if (s[i] == '1') sw[i] ^= '0'^'1';\n            rep (i,n) rep (j,m) {\n                if (sw[i] == '1' && b[j] == '0') t[i][j] = '0';\n                if (sw[i] == '0' && b[j] == '1') t[i][j] = '0';\n            }\n        }\n        string ans(m,'-');\n        rep (j,m) {\n            rep (i,n) if (t[i][j] == '1') {\n                if (ans[j] != '-') {\n                    ans[j] = '?';\n                    break;\n                }\n                ans[j] = (i < 10 ? '0'+i : 'A'+i-10);\n            }\n        }\n        cout << ans << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "\n#include <stdio.h>\n#include <iostream>\n#include <vector>\n#include <string>\n#include <bitset>\n\nusing namespace std;\n#define bitmax 1000\n/*\n\t不明なスイッチ\n\tICPC(国際ソケット・コネクタ会社)本社ビルの中には、M個の電球があり、\n\tそれらはN個のスイッチによって制御されている。各電球はただ一つのスイッチによって\n\t点灯させたり消滅させたりできる。各スイッチは複数の電球を操作できることもある。\n\tあるスイッチを操作するとき、そのスイッチによって制御されている全ての電球の状態が変化する。\n\tあなたはスイッチと電球の対応を記録してある表をなくしてしまい、それを復元したいと思っていた。\n\n\t以下の手順によって電球とスイッチの対応関係を復元することに決めた。\n\n\t・最初に全てのスイッチがオフになっており、全ての電球が消灯している\n\t・S1によってあらわされるいくつかのスイッチを操作する\n\t・B1によってあらわされる電球の状態を確認する\n\t・S2によってあらわされるいくつかのスイッチを操作する\n\t・B2によってあらわされる電球の状態を確認する\n\t・...\n\t・SQによってあらわされるいくつかのスイッチを操作する\n\t・BQによってあらわされる電球の状態を確認する\n\n\tいくつかのスイッチを操作して電球の状態を確認したあとは、\n\tスイッチと電球の状態は次の操作までそのままにしておく。\n\n\t操作を行ったスイッチと確認を行った電球に関する情報を用いて、\n\tスイッチと電球の対応関係を復元することができるだろうか？\n\n\t入力\n\t入力は複数のデータセットからなる。データセットの個数は50以下であり、\n\tファイルサイズは10MB以下である。各データセットは以下の形式に従う。\n\n\t各データセットの一行目には3個の整数N,M,Qが含まれ\n\t( 1 <= N <= 36 ), ( 1 <= M <= 1000 ), ( 0 <= Q <= 1000 )\n\t、それぞれスイッチの個数、\n\t電球の個数、操作の回数を表す。それ以降のQ行は操作を行ったスイッチと\n\t状態の確認を行った電球に関する情報をあらわす。そのi番目には\n\t二つのデータS_iとB_iが含まれ、長さはそれぞれNとMである。\n\t各S_iは操作を行ったスイッチの集まりを表す。S_ijは0または1のいずれかであり、\n\tそれぞれj番目のスイッチが操作されなかったこと、操作されたことを示す。\n\t各B_iは電球の状態を示す。B_ijは0または1のいずれかであり、それぞれj番目の電球が\n\t消灯しているか点灯しているかを表す。\n\n\t与えられる情報には、スイッチと電球の対応関係に矛盾が無いことを仮定してよい。\n\n\t入力の終わりは3つの0によってあらわされる。\n\n\t出力\n\t各データセットについて、スイッチと電球の対応関係を、\n\tM個の数字からなるbase-36形式で出力せよ。この問題におけるbase-36形式において、\n\t0-9と10-35の値はそれぞれ'0'-'9','A'-'Z'の文字によって表現される。\n\t対応関係におけるi番目の文字は、i番目の電球を制御しているスイッチの番号を示す。\n\ti番目の電球を制御しているスイッチを決定できない場合には、スイッチの番号の代わりに\n\t'?'をi番目の文字として出力せよ。\n\n*/\n\n/*\n\t方針\n\tビット演算を用いる\n\t各電球について、つながっている可能性のあるスイッチに対応するビットを立てる\n\tスイッチの状態を変えても電球の状態に変化がない場合に可能性が消える\n\t→　ある状態とその次の状態の排他的論理和を取る\n\n*/\nstring revstr( string s ) {\n\tstring ret;\n\tfor(int i = s.length() - 1; i >= 0; i--) {\n\t\tret += s[i];\n\t}\n\treturn ret;\n}\n\nint main(void){\n\t//FILE* fp_in = freopen(\"data.txt\", \"r\", stdin);\n\n\tvector< char > ans;\n\tfor(int i = 0; i < 10; i++)\n\t\tans.push_back( '0' + i );\n\tfor(int i = 0; i < 26; i++)\n\t\tans.push_back( 'A' + i );\n\n\twhile(1) {\n\t\tint N, M, Q;\n\t\tvector< bitset< bitmax > > S;\n\t\tvector< bitset< bitmax > > B;\n\t\tvector< bitset< bitmax > > P;\n\n\t\tcin >> N >> M >> Q;\n\t\tif( N == 0 && M == 0 && Q == 0 ) break;\n\n\t\tfor(int i = 0; i < M; i++) {\n\t\t\tbitset< bitmax > P_i;\n\t\t\tP_i.reset();\n\t\t\tfor(int j = 0; j < N; j++)\n\t\t\t\tP_i.set(j);\n\t\t\tP.push_back( P_i );\n\t\t}\n\n\t\t//データ取得\n\t\tfor(int i = 0; i < Q; i++) {\n\t\t\tstring S_i, B_i;\n\t\t\tcin >> S_i >> B_i;\n\t\t\tbitset< bitmax > Si( S_i );\n\t\t\tbitset< bitmax > Bi( B_i );\n\t\t\tS.push_back( Si );\n\t\t\tB.push_back( Bi );\n\t\t\tif( i > 0 ) S[i] ^= S[i-1]; \t//現在点灯しているスイッチ\n\t\t\tfor(int j = 0; j < M; j++) {\n\t\t\t\tif( B[i][j] ) {\t//電球が点灯した場合\n\t\t\t\t\tP[j] &= S[i];\n\t\t\t\t} else {\n\t\t\t\t\tP[j] &= ~S[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring str;\n\t\tfor(int i = 0; i < P.size(); i++) {\n\t\t\tif( P[i].count() == 1 ) {\n\t\t\t\tfor(int j = 0; j < N; j++) {\n\t\t\t\t\tif( P[i][j] ) str += ans[N - 1 - j];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstr += '?';\n\t\t\t}\n\t\t}\n\t\tcout << revstr(str) << endl;\n\t\t\n\t}\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <deque>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define ALL(v) (v).begin(), (v).end()\n#define LENGTHOF(x) (sizeof(x) / sizeof(*(x)))\n#define AFILL(a, b) fill((int*)a, (int*)(a + LENGTHOF(a)), b)\n#define SQ(x) ((x)*(x))\n#define Mod(x, mod) (((x)+(mod)%(mod))\n#define MP make_pair\n#define PB push_back\n#define Fi first\n#define Se second\n#define INF (1<<29)\n#define EPS 1e-10\n#define MOD 1000000007\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nint main()\n{\n  int N, M, Q;\n  while(1){\n    cin >> N >> M >> Q;\n    if(N == 0 && M == 0 && Q == 0) break;\n\n    set<int>s; rep(i, N) s.insert(i);\n    vector<set<int>>can(M, s);\n    s.clear();\n    string bS, bB; bS = bB = \"\";\n    //    rep(i, N) bS += \"0\";\n    rep(i, M) bB += \"0\";\n    rep(j, Q){\n      string S, B;\n      cin >> S >> B;\n      set<int>s;\n      rep(i, S.size()/* N */) if(S[i] == '1') s.insert(i);\n      //      for(auto x: s) cout << x << endl;\n      rep(i, B.size()/* M */){\n\tset<int>tmp;\n\tif(B[i] != bB[i])set_intersection(can[i].begin(),can[i].end(), s.begin(),s.end(),inserter(tmp,tmp.begin()));\n\telse set_difference(can[i].begin(),can[i].end(), s.begin(),s.end(), inserter(tmp,tmp.begin()));\n\t//\tfor(auto x:tmp) cout << x << endl;\n\tcan[i] = tmp;\n      }\n      bB = B;\n    }\n    \n    rep(i, can.size()/* M */){\n      if(can[i].size() == 1){\n\tint x = *can[i].begin();\n\tif(x <= 9) cout << x;\n\telse cout << (char)('A'+x-10);\n      }else{\n\tcout << \"?\";\n      }\n    }\n    cout << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\n\nvoid string_init(string &s, int n)\n{\n  s = \"\";\n  for(int i = 0; i < n; i++)\n    s += \"0\";\n}\n\nbool isNatural(int x)\n{\n  if(x >= 0) return true;\n  else return false;\n}\n\nint main()\n{\n  while(1){\n    int N, M, Q;\n    cin >> N >> M >> Q;\n    if(N == 0 && M == 0 && Q == 0) break;\n    string S0, B0, S1, B1;\n    string_init(S0,N);\n    string_init(B0,M);\n    int a[M][N];\n    for(int i = 0; i < M; i++)\n      for(int j = 0; j < N; j++)\n        a[i][j] = j;\n    for(int i = 0; i < Q; i++){\n      cin >> S1 >> B1;\n      for(int j = 0; j < N; j++){\n        if(S1[j] == '0'){\n          for(int k = 0; k < M; k++)\n            if(B0[k] != B1[k])\n              a[k][j] = -1;\n        }else{\n          for(int k = 0; k < M; k++)\n            if(B0[k] == B1[k])\n              a[k][j] = -1;\n        }\n      }\n      S0 = S1;\n      B0 = B1;\n    }\n    for(int i = 0; i < M; i++){\n      if(count_if(&a[i][0], &a[i][N], isNatural) == 1){\n        int x = *find_if(&a[i][0], &a[i][N], isNatural);\n        if(x < 10){\n          cout << x;\n        }else{\n          cout << (char)(x+55);\n        }\n      }else{\n        cout << '?';\n      }\n    }\n    cout << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "/*\n * 2590.cc: Unknown Switches\n */\n\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<iostream>\n#include<string>\n#include<vector>\n#include<map>\n#include<set>\n#include<stack>\n#include<list>\n#include<queue>\n#include<deque>\n#include<algorithm>\n#include<numeric>\n#include<utility>\n#include<complex>\n#include<functional>\n \nusing namespace std;\n\n/* constant */\n\nconst int MAX_N = 36;\nconst int MAX_M = 1000;\n\n/* typedef */\n\ntypedef long long ll;\n\n/* global variables */\n\nll bs[MAX_M];\n\n/* subroutines */\n\n/* main */\n\nint main() {\n  for (;;) {\n    int n, m, q;\n    cin >> n >> m >> q;\n    if (n == 0) break;\n\n    ll nbits = (1LL << n) - 1;\n    for (int i = 0; i < m; i++) bs[i] = nbits;\n\n    ll sb(0);\n\n    while (q--) {\n      string sw, bl;\n      cin >> sw >> bl;\n\n      for (int i = 0; i < n; i++)\n\tif (sw[i] == '1') sb ^= (1LL << i);\n\n      for (int i = 0; i < m; i++) {\n\tif (bl[i] == '0') bs[i] &= ~sb;\n\telse bs[i] &= sb;\n      }\n    }\n\n    for (int i = 0; i < m; i++) {\n      int k = -1, bn = 0;\n      for (int j = 0; j < n; j++)\n\tif (bs[i] & (1LL << j)) k = j, bn++;\n\n      if (bn > 1) putchar('?');\n      else if (k < 10) putchar('0' + k);\n      else putchar('A' + k - 10);\n    }\n    putchar('\\n');\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <bitset>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <tuple>\n#include <queue>\n#include <set>\n#include <cstdio>\n#include <climits>\n#include <cmath>\n#include <array>\n#include <functional>\n#include <sstream>\n#include <list>\n#include <iomanip>\n#include <set>\nconst int MOD=1000000007;\nconst int INF=1000000000;\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\nconst double eps=1e-9;\nconst int inf=1e9;\ntypedef pair<int,int> P;\nstruct Point\n{\n  double x,y;\n  Point(){x=0;y=0;}\n  Point(double d_x,double d_y){x=d_x,y=d_y;}\n  double operator*(Point obj){return obj.x*x+obj.y*y;}\n  double operator%(Point obj){return obj.y*x-obj.x*y;}\n  Point operator*(double b){Point tmp;tmp.x=x*b;tmp.y=y*b;return tmp;}\n  Point operator/(double b){Point tmp;tmp.x=x/b;tmp.y=y/b;return tmp;}\n  Point operator+(Point obj){Point tmp;tmp.x=x+obj.x;tmp.y=y+obj.y;return tmp;}\n  Point operator-(){Point tmp;tmp.x=-x;tmp.y=-y;return tmp;}\n  Point operator-(Point obj){Point tmp;tmp.x=x-obj.x;tmp.y=y-obj.y;return tmp;}\n  Point operator-=(Point obj){x-=obj.x;y-=obj.y;return *this;}\n  Point operator+=(Point obj){x+=obj.x;y+=obj.y;return *this;}\n  Point operator/=(double b){x=x/b;y=y/b;return *this;}\n  Point operator*=(double b){x=x*b;y=y*b;return *this;}\n  double size(){return hypot(x,y);}\n  Point unit(){return Point(x/size(),y/size());}\n  Point normal(){return Point(y,-x);}\n  double atan(){return atan2(y,x);}\n};\n\nbool operator<(Point a,Point b){return a.x!=b.x?a.x<b.x:a.y<b.y;}\nbool operator>(Point a,Point b){return b<a;}\nbool operator<=(Point a,Point b){return !(b<a);}\nbool operator>=(Point a,Point b){return !(a<b);}\nbool operator==(Point a,Point b){return (a-b).size()<eps;}\nbool operator!=(Point a,Point b){return !(a==b);}\n\nbool equal(double a,double b){return abs(a-b)<eps;}\ndouble cross(Point a,Point b){return a%b;}\ndouble dot(Point a,Point b){return a*b;}\n\nint ccw(Point a,Point b,Point c)\n{\n  b=b-a;\n  c=c-a;\n  if(b%c>0) return +1;\n  else if(b%c<0)return -1;\n  else if(b*c<0) return +2;\n  else if(b.size()<c.size()) return -2;\n  else return 0;\n}\n\nchar tochar(int i)\n{\n  if(i<10) return (char)('0' + i);\n  else return (char) ('A'+(i-10));\n}\n\nint n,m,q,cnt;\n\nint main(int argc,char const* argv[])\n{\n  while(1)\n    {\n      cin >> n >> m >> q;\n      if(n==0 && m==0 && q==0) break;\n      char c,ans[1005];\n      int f[37][1005],s[37]={},b[1005];\n      for(int i=0;i<n;i++)\n\t{\n\t  for(int j=0;j<m;j++)\n\t    {\n\t      f[i][j]=1;\n\t    }\n\t}\n      for(int i=0;i<q;i++)\n\t{\n\t  for(int i=0;i<n;i++) cin>>c,s[i]=(s[i]+(c-'0'))%2;\n\t  for(int i=0;i<m;i++) cin>>c,b[i]=c-'0';\n\n\t  for(int i=0;i<n;i++)\n\t      for(int j=0;j<m;j++)\n\t\t{\n\t\t  if(f[i][j]==2) continue;\n\t\t  else if(s[i]==b[j]) f[i][j]=1;\n\t\t  else f[i][j]=2;\n\t\t}\n\t}\n      for(int j=0;j<m;j++)\n\t{\n\t  int flag=0;\n\t  for(int i=0;i<n;i++)\n\t    {\n\t      if(f[i][j]==1 && flag==0)\n\t\t{\n\t\t  flag=1;\n\t\t  ans[j]=tochar(i);\n\t\t}\n\t      else if(f[i][j]==1 && flag==1) ans[j]='?';\n\t    }\n\t}\n      for(int i=0;i<m;i++)\n\t{\n\t  cout << ans[i];\n\t}\n      cout << endl;\n    }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <string>\n#include <sstream>\n#include <stack>\n#include <algorithm>\n#include <cmath>\n#include <queue>\n#include <map>\n#include <set>\n#include <cstdlib>\n#include <bitset>\n#include <tuple>\n#include <assert.h>\n#include <deque>\n#include <bitset>\n#include <iomanip>\n#include <limits>\n#include <chrono>\n#include <random>\n#include <array>\n#include <unordered_map>\n#include <functional>\n#include <complex>\n#include <numeric>\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\n//constexpr long long MAX = 5100000;\nconstexpr long long INF = 1LL << 60;\nconstexpr int inf = 1000000007;\nconstexpr long long mod = 1000000007LL;\n//constexpr long long mod = 998244353LL;\nconst long double PI = acos((long double)(-1));\n\nusing namespace std;\ntypedef unsigned long long ull;\ntypedef long long ll;\ntypedef long double ld;\n\nvoid solve() {\n    int n, m, q; cin >> n >> m >> q; if (n == 0) exit(0);\n    vector<vector<bool>> vb(m, vector<bool>(n, true));\n    string s(n, '0');\n    for (int kkt = 0; kkt < q; kkt++) {\n        string ts, b; cin >> ts >> b;\n        for (int i = 0; i < ts.size(); i++) if (ts[i] == '1') {\n            if (s[i] == '0') s[i] = '1';\n            else s[i] = '0';\n        }\n        for (int i = 0; i < s.size(); i++) {\n            for (int j = 0; j < b.size(); j++) {\n                if (s[i] == '0' and b[j] == '1') {\n                    vb[j][i] = false;\n                }\n                if (s[i] == '1' and b[j] == '0') {\n                    vb[j][i] = false;\n                }\n            }\n        }\n    }\n    string res;\n    for (int i = 0; i < m; i++) {\n        vector<int> v;\n        for (int j = 0; j < n; j++) if (vb[i][j]) v.emplace_back(j);\n        if (v.size() != 1) res += '?';\n        else {\n            if (v[0] <= 9) res += (char)('0' + v[0]);\n            else {\n                v[0] -= 10;\n                res += (char)('A' + v[0]);\n            }\n        }\n    }\n    cout << res << \"\\n\";\n}\n\nint main()\n{\n    cin.tie(nullptr);\n    ios::sync_with_stdio(false);\n\n    int kkt = 89;\n\twhile (kkt) {\n\t\tsolve();\n\t}\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cmath>\n#include <string>\n#include <iostream>\n#define to36(x) (x < 10 ? (char)(x + 48) : (char)(x + 55))\n#ifdef _MSC_VER\n#define __builtin_popcount __popcnt\n#endif\nusing namespace std;\nint N, M, Q; long long a[1009], b[1009]; string s[1009], t;\nint main() {\n\twhile (cin >> N >> M >> Q, N) {\n\t\tfill(a, a + Q, 0);\n\t\tfill(b, b + M, (1LL << N) - 1);\n\t\ts[0] = string(M, '0');\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tcin >> t >> s[i + 1];\n\t\t\tfor (int j = N - 1; j >= 0; j--) a[i] = a[i] * 2 + t[j] - 48;\n\t\t}\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tfor (int j = 0; j < M; j++) b[j] &= (s[i][j] == s[i + 1][j]) ? ~a[i] : a[i];\n\t\t}\n\t\tfor (int i = 0; i < M; i++) {\n\t\t\tif (__builtin_popcount(b[i]) == 1) cout << to36((int)(log2(b[i])));\n\t\t\telse cout << '?';\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n    int N, M, Q;\n    while (cin >> N >> M >> Q, N || M || Q) {\n\n        vector<string> S(2*Q+1), B(2*Q+1);\n        vector<vector<int>> D(2*Q+1, vector<int>(M));\n\n        B[0] = \"000000000000000000000000000000000000\";\n        for (int i = 1; i <= Q; i++) {\n            cin >> S[i-1] >> B[i];\n\n            for (int j = 0; j < N; j++) {\n                S[i+Q-1] += (S[i-1][j] == '0' ? '1' : '0');\n            }\n\n            for (int j = 0; j < M; j++) {\n                if (B[i-1][j] != B[i][j]) {\n                    D[i-1][j] = 1;\n                } else {\n                    D[i+Q-1][j] = 1;\n                }\n            }\n        }\n        vector<int> ans(M, -1);\n        if (Q == 0) {\n            if (N == 1) {\n                for (auto &i : ans) i = 0;\n            }\n        } else {\n            for (int i = 0; i < N; i++) {\n                string tmp = \"111111111111111111111111111111111111\";\n                for (int j = 0; j < 2*Q; j++) {\n                    if (S[j][i] == '0') continue;\n                    for (int k = 0; k < M; k++) {\n                        if (D[j][k] == 0) tmp[k] = '0';\n                    }\n                }\n                for (int j = 0; j < M; j++) {\n                    if (tmp[j] == '1') ans[j] = i;\n                }\n            }\n        }\n\n        for (int i = 0; i < M; i++) {\n            if (ans[i] < 0) cout << '?';\n            else if (ans[i] < 10) cout << ans[i];\n            else cout << 'A';\n        }\n        cout << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n\ndouble r(string s){\n\tif( s == \"north\" ) return 0;\n\tif( s == \"west\" ) return 90;\n\tint n = count(s.begin(),s.end(),'w') + count(s.begin(),s.end(),'n') - 1;\n\tif( s[0] == 'n' ){\n\t\treturn r(s.substr(5)) - 90. / (1<<n);\n\t}else{\n\t\treturn r(s.substr(4)) + 90. / (1<<n);\n\t}\n}\n\nchar to(int x){\n\tif( x < 10 ) return x + '0';\n\telse return x + 'A' - 10;\n}\nint prob[1000][36];\nint main(){\n\tint n,m,q;\n\twhile(cin >> n >> m >> q && n){\n\n\t\tfor(int i = 0 ; i < m ; i++)\n\t\t\tfor(int j = 0 ; j < n ; j++)\n\t\t\t\tprob[i][j] = true;\n\t\tstring prev = string(m,'0');\n\t\tfor(int _ = 0 ; _ < q ; _++){\n\t\t\tstring a,b;\n\t\t\tcin >> a >> b;\n\t\t\tstring tmp = b;\n\t\t\tfor(int i = 0 ; i < m ; i++){\n\t\t\t\tb[i] = (b[i]!=prev[i]?'1':'0');\n\t\t\t}\n\t\t\tfor(int i = 0 ; i < a.size() ; i++){\n\t\t\t\tfor(int j = 0 ; j < b.size() ; j++){\n\t\t\t\t\tif( a[i] != b[j] ){\n\t\t\t\t\t\tprob[j][i] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tprev = tmp;\n\t\t}\n\t\tfor(int i = 0 ; i < m ; i++){\n\t\t\tint c = count(prob[i],prob[i]+n,1);\n\t\t\t\n\t\t\tif( c == 1 ) cout << to(find(prob[i],prob[i]+n,1) - prob[i]);\n\t\t\telse cout << '?';\n\t\t\t\n\t\t}\n\t\tcout << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <set>\n#include <map>\n#include <queue>\n#include <deque>\n#include <stack>\n#include <algorithm>\n#include <cstring>\n#include <functional>\n#include <cmath>\n#include <complex>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<(n);++i)\n#define rep1(i,n) for(int i=1;i<=(n);++i)\n#define all(c) (c).begin(),(c).end()\n#define fs first\n#define sc second\n#define pb push_back\n#define show(x) cout << #x << \" \" << x << endl\nint main(){\n\twhile(true){\n\t\tint N,M,Q;\n\t\tcin>>N>>M>>Q;\n\t\tif(N==0) break;\n\t\tbool a[36]={},no[1000][36]={};\n\t\trep(i,Q){\n\t\t\tstring s,b;\n\t\t\tcin>>s>>b;\n\t\t\trep(j,N) if(s[j]=='1') a[j]=!a[j];\n\t\t\trep(j,M) rep(k,N) if(b[j]=='1'^a[k]) no[j][k]=1;\n\t\t}\n\t\trep(i,M){\n\t\t\tint x=-1;\n\t\t\trep(j,N) if(!no[i][j]){\n\t\t\t\tif(x==-1) x=j;\n\t\t\t\telse x=-2;\n\t\t\t}\n\t\t\tif(x>=0){\n\t\t\t\tif(x<10) printf(\"%c\",'0'+x);\n\t\t\t\telse printf(\"%c\",'A'+x-10);\n\t\t\t}else{\n\t\t\t\tcout<<'?';\n\t\t\t}\n\t\t}\n\t\tcout<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "// template {\n\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define loop(i, a, b) for (int i = (int)(a); i < (int)(b); i++)\n#define rep(i, n) loop(i, 0, n)\n#define rloop(i, a, b) for (int i = (int)(b) - 1; i >= (int)(a); i--)\n#define rrep(i, n) rloop(i, 0, n)\n#define eb emplace_back\n#define ef emplace_front\n#define pb pop_back\n#define pf pop_front\n#define all(c) std::begin(c), std::end(c)\n#define mp std::make_pair\n#define mt std::make_tuple\n#define fi first\n#define se second\n#define popcnt __builtin_popcountll\n\nusing uint = unsigned;\nusing ll = long long;\nusing ull = unsigned long long;\nusing ld = long double;\n\ntemplate<typename T>\nusing max_pq = priority_queue<T, vector<T>, less<T>>;\n\ntemplate<typename T>\nusing min_pq = priority_queue<T, vector<T>, greater<T>>;\n\nconst int MOD = 1e9 + 7;\nconst int INF = 1e9 + 10;\nconst ll LLINF = 1e18 + 10;\n\nconst int dx[] = {-1, 0, 1, 0};\nconst int dy[] = {0, -1, 0, 1};\nconst int dx8[] = {-1, -1, 0, 1, 1, 1, 0, -1};\nconst int dy8[] = {0, -1, -1, -1, 0, 1, 1, 1};\n\ntemplate<typename T>\ninline T sq(T x){ return x * x; }\n\ntemplate<typename T, typename U>\ninline bool chmax(T &x, U y){ if (x >= y) return false; x = y; return true; }\n\ntemplate<typename T, typename U>\ninline bool chmin(T &x, U y){ if (x <= y) return false; x = y; return true; }\n\ntemplate<typename T>\ninline void sort(T &c){ std::sort(std::begin(c), std::end(c)); }\n\ntemplate<typename T>\ninline void reverse(T &c){ std::reverse(std::begin(c), std::end(c)); }\n\ntemplate<typename T>\ninline void unique(T &c){ std::sort(std::begin(c), std::end(c)); c.erase(std::unique(all(c)), std::end(c)); }\n\n// }}}\n\nconst int tb[][8] = {\n\t{3, 0, 1, 2, 7, 4, 5, 6},\n\t{4, 0, 3, 7, 5, 1, 2, 6}\n};\n\nmap<string, int> cv;\nset<int> dn;\nint a[8];\n\nint main()\n{\n\twhile (true){\n\t\tcv.clear();\n\t\tdn.clear();\n\n\t\tstring s;\n\t\trep(i, 8){\n\t\t\tif (!(cin >> s)) return 0;\n\t\t\tint t = cv.size();\n\t\t\tif (cv.count(s)) a[i] = cv[s];\n\t\t\telse cv[s] = a[i] = t;\n\t\t}\n\n\t\tint res = 0;\n\t\tint perm[8];\n\t\tiota(perm, perm + 8, 0);\n\t\tdo {\n\t\t\tarray<int, 8> b;\n\t\t\tint c[16] = {};\n\t\t\trep(i, 8) b[i] = a[perm[i]];\n\t\t\tbool f = true;\n\t\t\trep(i, 128){\n\t\t\t\trep(j, 8) c[i] = c[i] * 8 + b[j];\n\t\t\t\tif (dn.count(c[i])) f = false;\n\t\t\t\tarray<int, 8> dst;\n\t\t\t\trep(j, 8){\n\t\t\t\t\tdst[j] = b[tb[0][j]];\n\t\t\t\t}\n\t\t\t\tif (i % 4 == 3){\n\t\t\t\t\trep(j, 8){\n\t\t\t\t\t\tdst[j] = b[tb[1][j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tb = dst;\n\t\t\t}\n\t\t\tif (f) res++;\n\t\t\trep(i, 16) dn.insert(c[i]);\n\t\t} while (next_permutation(perm, perm + 8));\n\t\t\n\t\tcout << res << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(){\n  int n,rm,lm;\n  while(cin>>lm>>rm>>n,n+lm+rm){\n    int a[100][100000]={};\n    string pl=\"00000000000000000000000\",pr=\"0000000000000000000\",cl,cr;\n    for(int o=0;o<n;o++){\n      cin>>cl>>cr;\n      for(int i=0;i<lm;i++){\n        if(cl[i]=='1')\n          for(int j=0;j<rm;j++){\n            if(pr[j]==cr[j])a[i][j]=1;\n          }\n        else\n          for(int j=0;j<rm;j++){\n            if(pr[j]!=cr[j])a[i][j]=1;\n          }\n      }\n      pr=cr;\n    }\n    for(int i=0;i<rm;i++){\n      int p=-1,c=0;\n      for(int j=0;j<lm;j++){\n        if(!a[j][i]){\n          if(c&&p!=j)c++;\n          p=j;\n          if(!c)c++;\n        }}\n      if(c==1){\n        if(p<10)cout<<p;\n        else cout<<(char)('A'+p-10);\n      }\n      else cout<<'?';\n    }\n    cout<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "//#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<ll> VL;\ntypedef vector<VL> VVL;\ntypedef pair<int, int> PII;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define MP make_pair\n#define PB push_back\n#define MOD 1000000007\n#define INF (1LL<<30)\n#define LLINF (1LL<<60)\n#define PI 3.14159265359\n#define EPS 1e-12\n//#define int ll\n\nstring s[1010], b[1010];\nbool a[40];\nll c[40], cc[40], d[1010];\n//???????´??????? x???e???\nll binpow(ll x, ll e)\n{\n  ll a = 1, p = x;\n\n  while(e > 0) {\n    if(e%2 == 0) {p = (p*p); e /= 2;}\n    else {a = (a*p); e--;}\n  }\n\n  return a;\n}\n\nsigned main(void)\n{\n\twhile(true) {\n\t\tint n, m, q;\n\t\tcin >> n >> m >> q;\n\t\tif(!n && !m && !q) break;\n\n\t\tREP(i, m) d[i] = (1<<n)-1;\n\t\tREP(i, n) {\n\t\t\ta[i] = false;\n\t\t\tc[i] = cc[i] = 0;\n\t\t}\n\t\tREP(i, q) {\n\t\t\tcin >> s[i] >> b[i];\n\t\t\tREP(j, n) {\n\t\t\t\tif(s[i][j] == '1') a[j] = !a[j];\n\t\t\t}\n\t\t\tfor(int j=n-1; j>=0; --j) {\n\t\t\t\tif(a[j]) c[i] += (binpow(2, n-1-j));\n\t\t\t\telse cc[i] += (binpow(2, n-1-j));\n\t\t\t}\n\t\t}\n\t\t//REP(i, q) cout << c[i] << \" \"; cout << endl;\n\n\t\tREP(i, q) {\n\t\t\tREP(j, m) {\n\t\t\t\tif(b[i][j] == '1') d[j] &= c[i];\n\t\t\t\telse d[j] &= cc[i];\n\t\t\t}\n\t\t}\n\n\t\t//REP(i, m) cout << d[i] << \" \"; cout << endl;\n\n\t\tREP(i, m) {\n\t\t\tint cnt = 0;\n\t\t\tVI e;\n\t\t\tREP(j, n) {\n\t\t\t\tif(d[i]>>j&1) {\n\t\t\t\t\tcnt++;\n\t\t\t\t\te.PB(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(cnt == 1) {\n\t\t\t\te[0] = n-1-e[0];\n\t\t\t\t//cout << \"e\" << e[0] << endl;\n\t\t\t\tif(e[0] < 10)\tcout << e[0];\n\t\t\t\telse cout << (char)(e[0]-10 + 'A');\n\t\t\t} else {\n\t\t\t\tcout << \"?\";\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <cstring>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <unordered_set>\n#include <unordered_map>\n#include <array>\n#include <cassert>\n#include <bitset>\nusing namespace std;\nusing LL = long long;\nusing ULL = unsigned long long;\n\ninline char b36(int i)\n{\n\treturn (i < 10) ? ('0' + i) : ('A' + (i - 10));\n}\n\nint main(void)\n{\n\tfor (;;)\n\t{\n\t\tint n, m, q;\n\t\tcin >> n >> m >> q;\n\t\tif (!n)break;\n\t\tvector<ULL>hash1(n), hash2(m);\n\t\tvector<bool>flag(n);\n\t\tfor (int k = 0; k < q; ++k)\n\t\t{\n\t\t\tstring s, t;\n\t\t\tcin >> s >> t;\n\t\t\tfor (int i = 0; i < n; ++i)\n\t\t\t{\n\t\t\t\tflag[i] = flag[i] ^ (s[i] == '1');\n\t\t\t\thash1[i] *= 2;\n\t\t\t\thash1[i] += flag[i];\n\t\t\t}\n\t\t\tfor (int j = 0; j < m; ++j)\n\t\t\t{\n\t\t\t\thash2[j] *= 2;\n\t\t\t\thash2[j] += (t[j] == '1');\n\t\t\t}\n\t\t}\n\t\tmap<ULL, int>dic;\n\t\tfor (int i = 0; i < n; ++i)\n\t\t{\n\t\t\tif (dic.count(hash1[i]))\n\t\t\t{\n\t\t\t\tdic[hash1[i]] = -1;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdic[hash1[i]] = i;\n\t\t\t}\n\t\t}\n\t\tfor (int j = 0; j < m; ++j)\n\t\t{\n\t\t\tint val = dic[hash2[j]];\n\t\t\tif (val < 0)\n\t\t\t{\n\t\t\t\tcout << '?';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcout << b36(val);\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nsigned main() {\n  cin.tie(0);\n  ios_base::sync_with_stdio(0);\n  cout << fixed << setprecision(12);\n\n  int N, M, Q;\n  while ( cin >> N >> M >> Q, N ) {    \n    vector<int> s(N, 0);\n    vector<vector<int> > b(M, vector<int>(36, 1));    \n    while ( Q-- ) {\n      string S, B;\n      cin >> S >> B;\n      for ( int i = 0; i < N; i++ ) {\n\tif ( S[i] == '1' ) s[i] ^= 1;\t\n      }\n      for ( int i = 0; i < N; i++ ) {\n\tif ( s[i] ) {\n\t  for ( int j = 0; j < M; j++ ) {\t  \n\t    if ( B[j] == '0' ) b[j][i] = 0;\t  \n\t  }\n\t} else {\n\t  for ( int j = 0; j < M; j++ ) {\t  \n\t    if ( B[j] == '1' ) b[j][i] = 0;\t  \n\t  }\n\t}\n      }\n    }\n\n    for ( int i = 0; i < M; i++ ) {\n      int cor = -1;\n      for ( int j = 0; j < N; j++ ) {\n\tif ( !b[i][j] ) continue;\n\tif ( cor >= 0 ) {\n\t  cor = -1;\n\t  break;\n\t} else {\n\t  cor = j;\t  \n\t}\n      }\n\n      if ( cor < 0 ) cout << '?';\n      else {\n\tif ( cor >= 10 ) cout << (char)('A'+cor-10);\n\telse cout << cor;\n      }\n    }\n    cout << endl;\n  }\n  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long lli;\n\nconst lli MAXQ = 1001;\nlli N, M, Q;\nlli S[MAXQ];\nstring B[MAXQ];\n\nint main() {\n  while(cin >> N >> M >> Q && (N|M|Q)) {\n    for(lli i = 0; i < Q; ++i) {\n      string s;\n      cin >> s >> B[i];\n      S[i] = 0;\n      for(lli j = 0; j < s.size(); ++j) {\n        S[i] |= (lli)(s[j]-'0') << (lli)j;\n      }\n      if(i) S[i] ^= S[i-1];\n    }\n    for(lli k = 0; k < M; ++k) {\n      lli sum = (1LL<<N) - 1;\n      for(lli i = 0; i < Q; ++i) {\n        if(B[i][k] == '1') sum &= S[i];\n        else sum &= ~S[i];\n      }\n      if(__builtin_popcount(sum) == 1) {\n        lli num = -1;\n        while(sum) sum >>= 1LL, ++num;\n        if(num < 10) cout << num;\n        else cout << (char)('A' + num - 10);\n      } else {\n        cout << \"?\";\n      }\n    }\n    cout << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(){\n  int n,rm,lm;\n  while(cin>>lm>>rm>>n,n+lm+rm){\n    int a[50][1002]={};\n    string pr=\"00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",cl,cr;\n    for(int o=0;o<n;o++){\n      cin>>cl>>cr;\n      for(int i=0;i<lm;i++){\n        if(cl[i]=='1')\n          for(int j=0;j<rm;j++){\n            if(pr[j]==cr[j])a[i][j]=1;\n          }\n        else\n          for(int j=0;j<rm;j++){\n            if(pr[j]!=cr[j])a[i][j]=1;\n          }\n      }\n      pr=cr;\n    }\n    //for(int i=0;i<lm;i++)cout<<a[i][2];cout<<endl;\n    for(int i=0;i<rm;i++){\n      int p=-1,c=0;\n      for(int j=0;j<lm;j++){\n        if(!a[j][i]){\n          if(c&&p!=j)c++;\n          p=j;\n          if(!c)c++;\n        }}\n      if(c==1){\n        if(p<10)cout<<p;\n        else cout<<(char)('A'+p-10);\n      }\n      else cout<<'?';\n    }\n    cout<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint main() {\n  while(1) {\n    int n,m,q;\n    cin >> n >> m>> q;\n    if(n==0 && m==0 && q==0) break;\n    int flg[37][1001]  = {};\n    bool a[10001]={};\n    \n    while(q--) {\n      char t;\n      for(int i=0;i<n;i++) {\n\tcin >> t;\n\tif(t =='1') a[i] = (a[i]+1)%2;\n      }\n      int b[1001];\n      for(int i=0;i<m;i++) cin>>t ,b[i] = t-'0';\n     \n      for(int i=0;i<n;i++)\n\tfor(int j=0;j<m;j++){\n\t  if(flg[i][j] == -1) continue;\n\t  if(a[i] == 1 && b[j] == 1) flg[i][j] = 1;\n\t  else if(a[i]==1 && b[j] == 0) flg[i][j] = -1;\n\t  else if(a[i] == 0 && b[j] == 1) flg[i][j] = -1;\n\t}\n\n     }\n   \n      int ans[1001] = {};\n      for(int i=0;i<m;i++) ans[i] = -1;  \n      for(int i=0;i<n;i++)\n\tfor(int j=0;j<m;j++){\n\t  if(flg[i][j] == -1) continue;\n\t  if(ans[j] != -1) ans[j] = -2;\n\t  else ans[j] = i;\n\t}\n      \n      for(int i=0;i<m;i++){\n\tchar ch = 'A'+(10-ans[i]);\n\tif(ans[i]==-2) cout <<\"?\";\n\telse if(ans[i] > 9) cout << ch ;\n\telse cout << ans[i];\n      }\n      cout << endl;\n  }\n  return 0;\n}  "
  },
  {
    "language": "C++",
    "code": "// template {\n\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define loop(i, a, b) for (int i = (int)(a); i < (int)(b); i++)\n#define rep(i, n) loop(i, 0, n)\n#define rloop(i, a, b) for (int i = (int)(b) - 1; i >= (int)(a); i--)\n#define rrep(i, n) rloop(i, 0, n)\n#define eb emplace_back\n#define ef emplace_front\n#define pb pop_back\n#define pf pop_front\n#define all(c) std::begin(c), std::end(c)\n#define mp std::make_pair\n#define mt std::make_tuple\n#define fi first\n#define se second\n#define popcnt __builtin_popcountll\n\nusing uint = unsigned;\nusing ll = long long;\nusing ull = unsigned long long;\nusing ld = long double;\n\ntemplate<typename T>\nusing max_pq = priority_queue<T, vector<T>, less<T>>;\n\ntemplate<typename T>\nusing min_pq = priority_queue<T, vector<T>, greater<T>>;\n\nconst int MOD = 1e9 + 7;\nconst int INF = 1e9 + 10;\nconst ll LLINF = 1e18 + 10;\n\nconst int dx[] = {-1, 0, 1, 0};\nconst int dy[] = {0, -1, 0, 1};\nconst int dx8[] = {-1, -1, 0, 1, 1, 1, 0, -1};\nconst int dy8[] = {0, -1, -1, -1, 0, 1, 1, 1};\n\ntemplate<typename T>\ninline T sq(T x){ return x * x; }\n\ntemplate<typename T, typename U>\ninline bool chmax(T &x, U y){ if (x >= y) return false; x = y; return true; }\n\ntemplate<typename T, typename U>\ninline bool chmin(T &x, U y){ if (x <= y) return false; x = y; return true; }\n\ntemplate<typename T>\ninline void sort(T &c){ std::sort(std::begin(c), std::end(c)); }\n\ntemplate<typename T>\ninline void reverse(T &c){ std::reverse(std::begin(c), std::end(c)); }\n\ntemplate<typename T>\ninline void unique(T &c){ std::sort(std::begin(c), std::end(c)); c.erase(std::unique(all(c)), std::end(c)); }\n\n// }}}\n\nconst int tb[][8] = {\n\t{3, 0, 1, 2, 7, 4, 5, 6},\n\t{4, 0, 3, 7, 5, 1, 2, 6}\n};\n\nmap<string, int> cv;\nset<int> dn;\nint a[8];\n\nint main()\n{\n\twhile (true){\n\t\tcv.clear();\n\t\tdn.clear();\n\n\t\tstring s;\n\t\trep(i, 8){\n\t\t\tif (!(cin >> s)) return 0;\n\t\t\tint t = cv.size();\n\t\t\tif (cv.count(s)) a[i] = cv[s];\n\t\t\telse cv[s] = a[i] = t;\n\t\t}\n\n\t\tint res = 0;\n\t\tint perm[8];\n\t\tint c[32];\n\t\tiota(perm, perm + 8, 0);\n\t\tdo {\n\t\t\tarray<int, 8> b;\n\t\t\trep(i, 8) b[i] = a[perm[i]];\n\t\t\tbool f = true;\n\t\t\trep(i, 32){\n\t\t\t\tc[i] = 0;\n\t\t\t\trep(j, 8) c[i] = c[i] * 8 + b[j];\n\t\t\t\tif (dn.count(c[i])) f = false;\n\t\t\t\tarray<int, 8> dst;\n\t\t\t\trep(j, 8){\n\t\t\t\t\tdst[j] = b[tb[0][j]];\n\t\t\t\t}\n\t\t\t\tif (i % 4 == 3){\n\t\t\t\t\trep(j, 8){\n\t\t\t\t\t\tdst[j] = b[tb[1][j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tb = dst;\n\t\t\t}\n\t\t\tif (f) res++;\n\t\t\trep(i, 32) dn.insert(c[i]);\n\t\t} while (next_permutation(perm, perm + 8));\n\t\t\n\t\tcout << res << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define FOR(i,a,b) for (int i=(a);i<(b);i++)\n#define RFOR(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define REP(i,n) for (int i=0;i<(n);i++)\n#define RREP(i,n) for (int i=(n)-1;i>=0;i--)\n#define ALL(a) (a).begin(),(a).end()\n#define DEBUG(a) \"(\" << #a << \": \" << (a) << \")\"\n\ntemplate<typename T>\nvoid chmin(T &x, T y) { x = min(x, y); }\n\ntemplate<typename T>\nvoid chmax(T &x, T y) { x = max(x, y); }\n\ntypedef long long int lli;\ntypedef long double ld;\ntypedef tuple<int,int> P;\ntypedef bitset<64> switches;\ntypedef bitset<1024> bulbs;\n\nconst int INF = INT_MAX/2 - 1;\nconst double EPS = 1e-14;\nconst int dx[4] = {0, 1, 0, -1}; // {-1,  0,  1, -1, 1, -1, 0, 1};\nconst int dy[4] = {1, 0, -1, 0}; // {-1, -1, -1,  0, 0,  1, 1, 1};\nconst string base36 = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\nstring solve(int n, int m, const vector<tuple<switches,bulbs>> &crs) {\n  string ans(m, '?');\n  REP (i, m) {\n    switches accs;\n    REP(j, n) accs.set(j);\n    for (auto cr : crs) {\n      switches ss; bulbs bs; tie(ss, bs) = cr;\n      accs &= bs[i] ? ss:~ss;\n    }\n    if (accs.count() != 1) { continue; }\n    REP (j, n) {\n      if (accs[j]) { ans[i] = base36[j]; }\n    }\n  }\n  return ans;\n}\n\nint main() {\n  cout << fixed << setprecision(10);\n  int N, M, Q;\n  while (cin >> N >> M >> Q and N) {\n    vector<tuple<switches,bulbs>> correspondence;\n    switches current(0);\n    REP (q, Q) {\n      string S, B;\n      cin >> S >> B;\n      switches ss(0);\n      REP (i, N) { ss[i] = S[i] == '1'; }\n      bulbs bs(0);\n      REP (i, M) { bs[i] = B[i] == '1'; }\n      current ^= ss;\n      correspondence.emplace_back(current, bs);\n    }\n    cout << solve(N, M, correspondence) << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);++(i))\n#define each(itr,c) for(__typeof(c.begin()) itr=c.begin(); itr!=c.end(); ++itr)\n#define all(x) (x).begin(),(x).end()\n#define mp make_pair\n#define pb push_back\n#define fi first\n#define se second\n\ntypedef pair<string,string> ps;\n\nint main()\n{\n    while(1)\n    {\n        int n,m,q;\n        cin >>n >>m >>q;\n        if(n==0) break;\n\n        //now active switch\n        int act[36]={0};\n        //i-th bulb may be controled by j-th switch\n        bool sw[1000][36];\n\n        fill(sw[0],sw[1000],true);\n\n        rep(Q,q)\n        {\n            string s,b;\n            cin >>s >>b;\n\n            //update active state\n            rep(i,n)\n            {\n                if(s[i]=='1') act[i] = !act[i];\n            }\n\n            rep(i,m)\n            {\n                if(b[i]=='0')\n                {\n                    //not active\n                    //now active switches have nothing to do with\n                    rep(j,n)\n                    {\n                        if(act[j]) sw[i][j]=false;\n                    }\n                }\n                else\n                {\n                    //active\n                    //now inactive switches have nothing to do with\n                    rep(j,n)\n                    {\n                        if(!act[j]) sw[i][j]=false;\n                    }\n                }\n            }\n        }\n\n        //answer\n        rep(i,m)\n        {\n            int ans=-1;\n            int ct=0;\n\n            rep(j,n)\n            {\n                if(sw[i][j])\n                {\n                    ans=j;\n                    ++ct;\n                }\n            }\n\n            if(ct==1)\n            {\n                if(ans<10) printf(\"%d\",ans);\n                else printf(\"%c\",ans-10+'A');\n            }\n            else printf(\"?\");\n        }\n        printf(\"\\n\");\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define debug(x) cout << \"debug \" << x << endl;\nconst int INF = 100000000;\nusing namespace std;\n\nint main(){\n    int n, m, q;\n    while(cin >> n >> m >> q, n||m||q){\n        int d[40][1001];\n        rep(i,40) rep(j,1001) d[i][j] = -1;\n        string before;\n        rep(i,m) before+='0';\n\n        rep(i,q){\n            bool swi[40] = {0};\n            bool bul[1001] = {0};\n            string s, b;\n\n            cin >> s >> b;\n            rep(j,s.size()) if(s[j] == '1') swi[j] = 1;\n            rep(j,b.size()) if(b[j] != before[j]) bul[j] = 1;\n\n            bool x, y;\n            rep(j,n){\n                if(swi[j] == 1) x = true;\n                else x = false;\n                rep(k,m){\n                    if(bul[k] == 1) y = true;\n                    else y = false;\n\n                    if(x && y){\n                        if(d[j][k] == -1) d[j][k] = 1;\n                    }else if( (x && !y) || (!x && y) ){\n                        d[j][k] = 0;\n                    }\n                }\n            }\n            before = b;\n        }\n        //rep(j,n){ rep(k,m){ cout << d[j][k] << ' '; } cout << endl; }\n        if(n == 1){\n            cout << 0 << endl;\n            continue;\n        }\n\n        bool swi[40] = {0};\n        rep(j,m){\n            int cnt = -1;\n            int num = 0;\n            rep(i,n){\n                if(swi[i]) num++;\n                if(d[i][j] == 1 && cnt > 0){\n                    cnt = -1;\n                }else if(d[i][j] == 1){\n                    cnt = i;\n                }\n            }\n            if(cnt != -1){\n                if(cnt < 10) cout << cnt;\n                else cout << static_cast<char>('A' + (cnt - 10));\n                swi[cnt] = 1;\n            }else if(num == n - 1){\n                rep(k,n){\n                    if(not swi[k]){\n                        if(k < 10) cout << k;\n                        else cout << static_cast<char>('A' + (k - 10));\n                        break;\n                    }\n                }\n            }else cout << '?';\n        }\n        cout << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\ntypedef long long ll;\nint N,M,Q;\nll s[4000],t[4000];\n\nll func(string str){\n  ll res=0;\n  reverse(str.begin(),str.end());\n  for(int i=0;i<(int)str.size();i++){\n    res*=2LL;\n    if(str[i]-'0')res++;\n  }\n  return res;\n}\n\nint main(){\n  char change[36];\n  change[0]='0';\n  for(int i=1;i<10;i++)change[i]=change[i-1]+1;\n  change[10]='A';\n  for(int i=11;i<36;i++)change[i]=change[i-1]+1;\n\n  while(1){\n    cin>>N>>M>>Q;\n    if(N==0&&M==0&&Q==0)break;\n    for(int i=0;i<Q;i++){\n      string str,str2;\n      cin>>str>>str2;\n      s[i]=func(str);\n      t[i]=func(str2);\n      if(i){\n\ts[i]=s[i]^s[i-1];\n      }\n    }\n    for(int i=0;i<M;i++){\n      ll f=(1LL<<N)-1,F=f;\n      for(int j=0;j<Q;j++){\n\tif((t[j]>>i)&1){\n\t  f=f&s[j];\n\t}else {\n\t  f=f&(F-s[j]);\n\t}\n      }\n\n      if(__builtin_popcountll(f)==1){\n\tint ans=0;\n\twhile(f>1){\n\t  f/=2LL;\n\t  ans++;\n\t}\n\tcout<<change[ans];\n      }else{\n\tcout<<'?';\n      }\n    }\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define MAX_N 36\n#define MAX 1000\n\nchar getChar(int x){\n  return (x < 10 ? x+'0' : x+'A'-10);\n}\n\nint main(){\n  int N,M,Q;\n  while(cin >> N >> M >> Q, N){\n    string S,B[MAX+1];\n    bool sw[MAX+1][MAX_N];\n    sw[0][0] = false;\n    for(int i = 1 ; i <= Q ; i++){\n      cin >> S >> B[i];\n      for(int j = 0 ; j < N ; j++){\n        sw[i][j] = (S[j] == '1' ? !sw[i-1][j] : sw[i-1][j]);\n      }\n    }\n    string ans;\n    for(int i = 0 ; i < M ; i++){\n      bool use[MAX_N];\n      fill(use,use+N,true);\n      for(int j = 1 ; j <= Q ; j++){\n        for(int k = 0 ; k < N ; k++){\n          if(!sw[j][k] && B[j][i] == '1' ||\n              sw[j][k] && B[j][i] == '0'){\n            use[k] = false;\n          }\n        }\n      }\n      bool ok = true;\n      int x = -1;\n      for(int j = 0 ; j < N ; j++){\n        if(use[j]){\n          if(x != -1){ ok = false; }\n          x = j;\n        }\n      }\n      ans += (ok ? getChar(x) : '?');\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <deque>\n#include <list>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <utility>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <complex>\n#include <cmath>\n#include <limits>\n#include <cfloat>\n#include <climits>\n#include <ctime>\n#include <cassert>\n#include <numeric>\n#include <functional>\nusing namespace std;\n\n#define rep(i,a,n) for(int (i)=(a); (i)<(n); (i)++)\n#define repq(i,a,n) for(int (i)=(a); (i)<=(n); (i)++)\n#define repr(i,a,n) for(int (i)=(a); (i)>=(n); (i)--)\n#define int long long int\n\ntemplate<typename T> void chmax(T &a, T b) {a = max(a, b);}\ntemplate<typename T> void chmin(T &a, T b) {a = min(a, b);}\ntemplate<typename T> void chadd(T &a, T b) {a = a + b;}\n\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\nint dx[] = {0, 0, 1, -1};\nint dy[] = {1, -1, 0, 0};\nconstexpr ll INF = 1001001001001001LL;\nconstexpr ll MOD = 1000000007LL;\n\nint N, M, Q;\nbool table[1010][40];\nint ans[1010];\n\nsigned main() {\n    while(cin >> N >> M >> Q, N) {\n        memset(table, true, sizeof(table));\n        memset(ans, -1, sizeof(ans));\n        string prev(M, '0');\n        rep(i,0,Q) {\n            string S, B; cin >> S >> B;\n            bool switches[40] = {};\n            rep(k,0,N) if(S[k] == '1') switches[k] = true;\n            rep(k,0,M) {\n                if(prev[k] != B[k]) {\n                    rep(x,0,N) {\n                        if(!table[k][x]) continue;\n                        table[k][x] = switches[x];\n                    }\n                }\n            }\n            prev = B;\n        }\n\n        bool used[40] = {};\n        bool ok = true;\n        while(ok) {\n            ok = false;\n            vector<int> temp;\n            rep(i,0,M) {\n                if(ans[i] != -1) continue;\n                int cnt = 0, rec = 0;\n                rep(k,0,N) {\n                    if(table[i][k] && !used[k]) {\n                        // printf(\"bulb: %lld, switch: %lld\\n\", i, k);\n                        cnt++;\n                        rec = k;\n                    }\n                }\n                if(cnt == 1) {\n                    ok = true;\n                    ans[i] = rec;\n                    temp.push_back(rec);\n                }\n            }\n            rep(i,0,temp.size()) used[ temp[i] ] = true;\n        }\n        rep(i,0,M) {\n            if(ans[i] == -1) cout << \"?\";\n            else {\n                if(ans[i] < 10) cout << ans[i];\n                else cout << (char)('A' + ans[i] - 10);\n            }\n        }\n        cout << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n  string base36 = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ?\";\n  int N, M, Q;\n  while(cin >> N >> M >> Q, N || M || Q){\n    long long bulb[1001];\n    for(int i = 0; i < M; i++) bulb[i] = (1LL<<N)-1;\n    long long swch = 0LL;\n    for(int i = 0; i < Q; i++){\n      string S, B;\n      cin >> S >> B;\n      long long s = 0LL, b = 0LL;\n      for(int j = 0; j < N; j++) if(S[j] == '1') s |= (1LL << j);\n      for(int j = 0; j < M; j++) if(B[j] == '1') b |= (1LL << j);\n      swch ^= s;\n      for(int j = 0; j < M; j++){\n\tif((b >> j) & 1LL) bulb[j] &= swch;\n\telse bulb[j] &= ~swch;\n      }\n    }\n    for(int i = 0; i < M; i++){\n      if(__builtin_popcountll(bulb[i]) > 1){\n\tcout << \"?\";\n      } else {\n\tint ctrl = -1;\n\tfor(int j = 0; j < N; j++) if((bulb[i] >> j) & 1LL) ctrl = j;\n\tif(ctrl < 10) cout << ctrl;\n\telse cout << (ctrl-10+'A');\n      }\n    }\n    cout << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\nusing namespace std;\n\nint main(){\n\n    while(1){\n        int n, m, q; cin >> n >> m >> q;\n        if(!n) break;\n\n        vector<vector<bool> > a(n, vector<bool> (m, true));\n\n        vector<string> s(q + 1);\n        vector<string> t(q + 1);        \n\n        for(int i = 0; i < n; i++) s[0] += '0';\n        for(int i = 0; i < m; i++) t[0] += '0';\n\n\n        for(int i = 1; i <= q; i++){\n            cin >> s[i] >> t[i];\n\n            //押して、変化なし　|| 押さずに変化ありをfalseに\n            for(int j = 0; j < n; j++){\n\n                for(int k = 0; k < m; k++){                    \n                    if((s[i][j] == '1' && (t[i][k] == t[i-1][k])) || s[i][j] == '0' && (t[i][k] != t[i-1][k])) a[j][k] = false; \n                }\n                \n            }\n        \n        }\n\n\n        /*for(int i = 0; i < n; i++){\n            for(int j = 0; j < m; j++){\n                cout << a[i][j] << \" \";            \n            }\n            cout << endl;\n        }*/\n\n        string M = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\n        string ans;\n        for(int i = 0; i < m; i++) ans += '?';\n        for(int i = 0; i < m; i++){\n            for(int j = 0; j < n; j++){\n                if(a[j][i] == true && ans[i] == '?') ans[i] = M[j];\n                else if(a[j][i] == true && ans[i] != '?'){\n                    ans[i] = '?';\n                    continue;\n                }\n            }\n        }\n\n        cout << ans << endl;\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef int Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n//#define mt make_tuple\n//typedef tuple<int,int,int> tp;\n//typedef vector<tp> vt;\nconst double PI=acos(-1);\nconst double EPS=1e-7;\nconst int inf=1e9;\nconst ll INF=2e18;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\nint main(){\n\tint n,m,q;\n\twhile(cin>>n>>m>>q,n){\n\t\tif(n==1){\n\t\t\tcout<<string(m,'0')<<endl;\n\t\t}else{\n\t\t\tvs in1(q),in2(q);\n\t\t\trep(i,q)cin>>in1[i]>>in2[i];\n\t\t\trep(i,n){\n\t\t\t\tint c=0;\n\t\t\t\trep(j,q){\n\t\t\t\t\tif(in1[j][i]=='1')c++;\n\t\t\t\t\tif(c%2)in1[j][i]='1';\n\t\t\t\t\telse in1[j][i]='0';\n\t\t\t\t}\n\t\t\t}\n\t\t\tstring out=\"\";\n\t\t\trep(i,m){\n\t\t\t\tvi ko;\n\t\t\t\trep(j,n){\n\t\t\t\t\tbool h=true;\n\t\t\t\t\trep(k,q)if(in1[k][j]!=in2[k][i])h=false;\n\t\t\t\t\tif(h)ko.pb(j);\n\t\t\t\t}\n\t\t\t\tif(ko.size()==1){\n\t\t\t\t\tif(ko[0]<10)out+=(char)(ko[0]+'0');\n\t\t\t\t\telse out+=(char)(ko[0]-10+'A');\n\t\t\t\t}else out+=\"!\";\n\t\t\t}\n\t\t\tcout<<out<<endl;\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <iostream>\n#define to36(x) (x < 10 ? (char)(x + 48) : (char)(x + 55))\n#ifdef _MSC_VER\n#define __builtin_popcount __popcnt\n#endif\nusing namespace std;\nint N, M, Q; long long a[1009], b[1009]; string s[1009], t;\nint main() {\n\twhile (cin >> N >> M >> Q, N) {\n\t\tfill(a, a + Q, 0);\n\t\tfill(b, b + M, (1LL << N) - 1);\n\t\ts[0] = string(M, '0');\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tcin >> t >> s[i + 1];\n\t\t\tfor (int j = N - 1; j >= 0; j--) a[i] = a[i] * 2 + t[j] - 48;\n\t\t}\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tfor (int j = 0; j < M; j++) b[j] &= (s[i][j] == s[i + 1][j]) ? ~a[i] : a[i];\n\t\t}\n\t\tfor (int i = 0; i < M; i++) {\n\t\t\tif (__builtin_popcount(b[i]) == 1) cout << to36((int)(log2(b[i])));\n\t\t\telse cout << '?';\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<ll> VL;\ntypedef vector<VL> VVL;\ntypedef pair<int, int> PII;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define MP make_pair\n#define PB push_back\n#define MOD 1000000007\n#define INF (1LL<<30)\n#define LLINF (1LL<<60)\n#define PI 3.14159265359\n#define EPS 1e-12\n//#define int ll\n\nstring s[1010], b[1010];\nbool a[40];\nll c[40], cc[40], d[1010];\nsigned main(void)\n{\n\twhile(true) {\n\t\tint n, m, q;\n\t\tcin >> n >> m >> q;\n\t\tif(!n && !m && !q) break;\n\n\t\tREP(i, m) d[i] = (1<<n)-1;\n\t\tREP(i, n) {\n\t\t\ta[i] = false;\n\t\t\tc[i] = cc[i] = 0;\n\t\t}\n\t\tREP(i, q) {\n\t\t\tcin >> s[i] >> b[i];\n\t\t\tREP(j, n) {\n\t\t\t\tif(s[i][j] == '1') a[j] = !a[j];\n\t\t\t}\n\t\t\tfor(int j=n-1; j>=0; --j) {\n\t\t\t\tif(a[j]) c[i] += (pow(2, n-1-j));\n\t\t\t\telse cc[i] += (pow(2, n-1-j));\n\t\t\t}\n\t\t}\n\t\t//REP(i, q) cout << c[i] << \" \"; cout << endl;\n\n\t\tREP(i, q) {\n\t\t\tREP(j, m) {\n\t\t\t\tif(b[i][j] == '1') d[j] &= c[i];\n\t\t\t\telse d[j] &= cc[i];\n\t\t\t}\n\t\t}\n\n\t\t//REP(i, m) cout << d[i] << \" \"; cout << endl;\n\n\t\tREP(i, m) {\n\t\t\tint cnt = 0;\n\t\t\tVI e;\n\t\t\tREP(j, n) {\n\t\t\t\tif(d[i]>>j&1) {\n\t\t\t\t\tcnt++;\n\t\t\t\t\te.PB(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(cnt == 1) {\n\t\t\t\te[0] = n-1-e[0];\n\t\t\t\t//cout << \"e\" << e[0] << endl;\n\t\t\t\tif(e[0] < 10)\tcout << e[0];\n\t\t\t\telse cout << (char)(e[0]-10 + 'A');\n\t\t\t} else {\n\t\t\t\tcout << \"?\";\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nint main()\n{\n  while(1){\n    int N, M, Q;\n    cin >> N >> M >> Q;\n    if(N == 0 && M == 0 && Q == 0) break;\n    string S_pre, S_pos, B_pre, B_pos;\n    S_pre = B_pre = \"\";\n    for(int i = 0; i < N; i++)\n      S_pre += \"0\";\n    for(int i = 0; i < M; i++)\n      B_pre += \"0\";\n    int ans[M];\n    vector<bool> s(N);\n    fill(ans,ans+M,-1);\n    fill(s.begin(),s.end(),false);\n    for(int i = 0; i < Q; i++){\n      cin >> S_pos >> B_pos;\n      int b[M];\n      fill(b,b+M,-1);\n      for(int j = 0; j < N; j++){\n        if(!s[j]){\n          if(S_pos[j] == '1'){            \n            for(int k = 0; k < M; k++){\n              if(ans[k] == -1 && b[k] != -2){\n                if(B_pre[k] != B_pos[k]){\n                  if(b[k] == -1){\n                    b[k] = j;\n                  }else{\n                    b[k] = -2;\n                  }     \n                }\n              }\n            }  \n          }else{\n            for(int k = 0; k < M; k++){\n              if(ans[k] == -1 && b[k] != -2){\n                if(B_pre[k] == B_pos[k]){\n                  if(b[k] == -1){\n                    b[k] = j;\n                  }else{\n                    b[k] = -2;\n                  }     \n                }\n              }\n            }\n          }\n        }\n      }\n      for(int j = 0; j < M; j++){\n        if(b[j] >= 0){\n          ans[j] = b[j];\n          s[b[j]] = true;\n        }\n      }\n      S_pre = S_pos;\n      B_pre = B_pos;\n    }\n    if(count(s.begin(),s.end(),false) == 1){\n      int x = find(s.begin(),s.end(),false) - s.begin();\n      for(int i = 0; i < M; i++){\n        if(ans[i] == -1){\n          ans[i] = x;\n        }\n      }\n    }\n    for(int i = 0; i < M; i++){\n      if(ans[i] == -1){\n        cout << '?';\n      }else{\n        if(ans[i] < 10){\n          cout << ans[i];\n        }else{\n          cout << (char)(ans[i]+55);\n        }\n      }\n    }\n    cout << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<cstdio>\n#include<map>\n#include<algorithm>\n#include<string>\n#include<cmath>\n\nusing namespace std;\nint main(){\n\tint N,M,Q;\n\tstring S,B;\n\tstring C;\n\tint offF =0,onF=0;\n\tint *offi,*oni;\n\tstring sigma =\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\n\n\twhile(1){\n\t\tcin >> N >> M >> Q;\n\t\tif(N==0 && M==0 && Q==0)break;\n\t\tC=\"\";\n\t\toffi = new int[M];\n\t\toni = new int[M];\n\t\tfor(int i=0;i<M;i++){\n\t\t\tC+=\"?\";\n\t\t\toffi[i]=-1;\n\t\t\toni[i]=-1;\n\t\t}\n\t\t//0会の時\n\t\tif(Q==0){\n\t\t\tif(M==1){\n\t\t\t\tcout << 0 <<endl;\n\t\t\t\tcontinue;\n\t\t\t}else{\n\t\t\t\tcout << C << endl;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\toffF =0,onF=0;\n\t\tcin>>S>>B;\n\t\t//最初の一回\n\t\tchar off='?',on='?';\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(S[i]=='0') {\n\t\t\t\toffF++;\n\t\t\t\tif(offF==1) off=sigma[i];\n\t\t\t}if(S[i]=='1'){\n\t\t\t\tonF++;\n\t\t\t\tif(onF==1) on=sigma[i];\n\t\t\t}  \n\t\t}\n\t\tif(offF==1){\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='0'){\n\t\t\t\t\tC[i]=off;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tif(onF==1){\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='1'){\n\t\t\t\t\tC[i]=on;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\t//2~n-1まで\n\t\tstring prevB = \"\";\n\t\tfor(int k=0;k<M;k++){ prevB += B[k];}\n\t\tstring B2 = \"\";\n\t\tfor(int q=1;q<Q;q++){\n\t\t\toffF =0,onF=0;\n\t\t\tB2 = \"\";\n\t\t\tcin>>S>>B;\n\t\t\t//cout<< S <<endl;\n\t\t\t//cout<< \"B:\" <<B <<endl;\n\t\t\t//cout<< \"prevB:\" << prevB <<endl;\n\t\t\t//cout<< \"C:\" << C <<endl;\n\n\t\t\tfor(int j=0;j<M;j++){\n\t\t\t\tB2 += sigma[abs(prevB[j] - B[j])];\n\t\t\t}\n\t\t\t//cout << \"B2:\" << B2 << endl;\n\t\t\tchar off,on;\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='0' && C[i]=='?') {\n\t\t\t\t\toffF++;\n\t\t\t\t\tif(offF==1) off=sigma[i];\n\t\t\t\t}\n\t\t\t\tif(S[i]=='1' && C[i]=='?'){\n\t\t\t\t\tonF++;\n\t\t\t\t\tif(onF==1) on=sigma[i];\n\t\t\t\t}  \n\t\t\t}\n\t\t\t//cout << \"flag : \" << offF << onF << endl;\n\n\t\t\tif(offF==1){\n\t\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\t\tif(S[i]=='0'){\n\t\t\t\t\t\tfor(int j=0; j<M; j++){\n\t\t\t\t\t\t\tif(B2[j] == '0' && C[j]=='?'){ \n\t\t\t\t\t\t\t\tC[j] = off;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t}\n\t\t\tif(onF==1){\n\t\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\t\tif(S[i]=='1'){\n\t\t\t\t\t\tfor(int j=0; j<M; j++){\n\t\t\t\t\t\t\tif(B2[j] == '1' && C[j]=='?'){ \n\t\t\t\t\t\t\t\tC[j] = on;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\t\n\t\t\t}\n\t\t\tprevB = B;\n\n\t\t}\n\t\t\n\t\tint *check = new int[N];\n\t\tint a=0,flg=0;\n\t\tfor(int i=0;i<N;i++) check[i] = 0;\n\n\t\tfor(int i=0; i<M; i++){\n\t\t\tif(C[i]!='?'){\n\t\t\t\tif('0'<=C[i] && '9'>=C[i]){\n\t\t\t\t\tcheck[(int)(C[i]-'0')] = 1;\n\t\t\t\t}else{\n\t\t\t\t\tcheck[(int)(C[i]-'A'+10)] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(check[i]==0){\n\t\t\t\ta = i;\n\t\t\t\tflg++;\n\t\t\t}\n\t\t}\n\t\tif(flg==1){\n\t\t\tfor(int i=0; i<M; i++){\n\t\t\t\tif(C[i]=='?') C[i] = sigma[a];\n\t\t\t}\n\t\t}\n\n\t\tcout << C << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n)for(int i=0;i<n;i++)\nusing namespace std;\ntypedef long long ll;\n\nll a[1000];\nchar s[40], b[2000];\nint main() {\n\tint n, m, q;\n\twhile (scanf(\"%d%d%d\", &n, &m, &q), n) {\n\t\trep(i, m)a[i] = (1LL << n) - 1;\n\t\tll k = 0;\n\t\trep(i, q) {\n\t\t\tscanf(\"%s%s\", s, b);\n\t\t\tll t = 0;\n\t\t\trep(j, n)t = ((t << 1) | (s[j] - '0'));\n\t\t\tk ^= t;\n\t\t\trep(j, m) {\n\t\t\t\tif (b[j] == '1')a[j] &= k;\n\t\t\t\telse a[j] &= ~k;\n\t\t\t}\n\t\t}\n\t\trep(i, m) {\n\t\t\tint t = -1;\n\t\t\trep(j, n) {\n\t\t\t\tif (a[i] >> j & 1) {\n\t\t\t\t\tif (~t) { t = -1; break; }\n\t\t\t\t\tt = n - j - 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (t == -1)printf(\"?\");\n\t\t\telse printf(\"%c\", t < 10 ? '0' + t : 'A' - 10 + t);\n\t\t}\n\t\tputs(\"\");\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#define Q 1010\n#define N 40\nusing namespace std;\n\nint main(){\n  int n,m,q;\n  char ans[Q];\n  bool sw[N],swb[N],li[Q],fl[Q],fln[N],fle[Q];\n  string s[Q],b[Q];\n  vector<int> on,off,r;\n  while(1){\n    cin>>n>>m>>q;\n    if(!n&&!m&&!q) break;\n    for(int i=0;i<q;i++) cin>>s[i]>>b[i];\n    for(int i=0;i<n;i++) sw[i]=swb[i]=fln[i]=false;\n    for(int i=0;i<m;i++) ans[i]='?',li[i]=fl[i]=fle[i]=false;\n    for(int i=0;i<q;i++){\n      for(int j=0;j<n;j++) swb[j]=sw[j];\n      for(int j=0;j<n;j++)\n\tif(s[i][j]=='1') sw[j]?sw[j]=false:sw[j]=true;\n      for(int j=0;j<n;j++){\n\tif(swb[j]&&sw[j]) r.push_back(j);\n\telse if(swb[j]&&!sw[j]) off.push_back(j);\n\telse if(sw[j]) on.push_back(j);\n      }\n      for(int j=0;j<n;j++)\n\tif(fln[j]){\n\t  for(int k=0;k<on.size();k++)\n\t    if(j==on[k]) on.erase(on.begin()+k);\n\t  for(int k=0;k<off.size();k++)\n\t    if(j==off[k]) off.erase(off.begin()+k);\n\t  for(int k=0;k<r.size();k++)\n\t    if(j==r[k]) r.erase(r.begin()+k);\n\t}\n      if(on.size()==1)\n\tfor(int j=0;j<m;j++)\n\t  if(!li[j]&&b[i][j]=='1'){\n\t    if(!fl[j]){\n\t      if(on[0]<=9) ans[j]=on[0]+'0';\n\t      else ans[j]=on[0]+'A'-10;\n\t      fl[j]=fln[j]=true;\n\t    }\n\t    else ans[j]='?',fle[j]=true;\n\t  }\n      if(off.size()==1)\n\tfor(int j=0;j<m;j++)\n\t  if(li[j]&&b[i][j]=='0'){\n\t    if(!fl[j]){\n\t      if(off[0]<=9) ans[j]=off[0]+'0';\n\t      else ans[j]=off[0]+'A'-10;\n\t      fl[j]=fln[j]=true;\n\t    }\n\t    else ans[j]='?',fle[j]=true;\n\t  }\n      if(r.size()==1)\n\tfor(int j=0;j<m;j++)\n\t  if(li[j]&&b[i][j]=='1'){\n\t    if(!fl[j]){\n\t      if(r[0]<=9) ans[j]=r[0]+'0';\n\t      else ans[j]=r[0]+'A'-10;\n\t      fl[j]=fln[j]=true;\n\t    }\n\t    else ans[j]='?',fle[j]=true;\n\t  }\n      for(int j=0;j<m;j++)\n\tb[i][j]=='1'?li[j]=true:li[j]=false;\n      on.clear();\n      off.clear();\n      r.clear();\n    }\n    int cnt=0,a;\n    for(int i=0;i<n;i++)\n      if(!fln[i]) cnt++,a=i;\n    if(cnt==1)\n      for(int i=0;i<m;i++)\n\tif(ans[i]=='?'&&!fle[i]){\n\t  if(a<=9) ans[i]=a+'0';\n\t  else ans[i]=a+'A'-10;\n\t}\n    for(int i=0;i<m;i++) cout<<ans[i];\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i, n) for (int i = 0; i < int(n); ++i)\n\nint main() {\n    for (int N, M, Q; cin >> N >> M >> Q, N | M | Q;) {\n        if (N == 1) {\n            cout << string(M, '0') << endl;\n            for (string s; Q--; cin >> s >> s);\n            continue;\n        }\n        vector<long long> zero(M), one(M);\n        for (string pS(N, '0'), pB(M, '0'), S, B; Q--; pS = S, pB = B) {\n            cin >> S >> B;\n            rep(i, M) {\n                if (__builtin_popcountll(one[i]) == 1) continue;\n                rep(j, N) {\n                    if (S[j] == '0') {\n                        (B[i] != pB[i] ? zero[i] : one[i]) |= 1ll << j;\n                    }\n                    else {\n                        (B[i] == pB[i] ? zero[i] : one[i]) |= 1ll << j;\n                    }\n                }\n            }\n        }\n        string table(M, '?');\n        rep(i, M) {\n            long long b = ~zero[i] & one[i];\n            if (__builtin_popcountll(b) != 1) continue;\n            table[i] = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"[__builtin_ctzll(b)];\n        }\n        cout << table << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n  string base36 = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ?\";\n  int N, M, Q;\n  while(cin >> N >> M >> Q, N || M || Q){\n    long long bulb[1000]; memset(bulb, -1LL, sizeof(bulb));\n    long long swch = 0LL;\n    for(int i = 0; i < Q; i++){\n      string S, B;\n      cin >> S >> B;\n      long long s = 0LL, b = 0LL;\n      for(int j = 0; j < N; j++) if(S[j] == '1') s |= (1LL << j);\n      for(int j = 0; j < M; j++) if(B[j] == '1') b |= (1LL << j);\n      swch ^= s;\n      for(int j = 0; j < M; j++){\n\tif((b >> j) & 1LL) bulb[j] &= swch;\n\telse bulb[j] &= ~swch;\n      }\n    }\n    for(int i = 0; i < M; i++){\n      int ctrl = -1;\n      int cnt = 0;\n      for(int j = 0; j < N; j++){\n\tif((bulb[i] >> j) & 1LL) cnt++, ctrl = j;\n      }\n      if(cnt == 1) cout << base36[ctrl];\n      else cout << \"?\";\n    }\n    cout << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\nusing namespace std;\n\nint main(){\n\n    while(1){\n        int n, m, q; cin >> n >> m >> q;\n        if(!n) break;\n\n        vector<vector<bool> > a(n, vector<bool> (m, true));\n\n        vector<string> s(q + 1);\n        vector<string> t(q + 1);        \n\n        for(int i = 0; i < n; i++) s[0] += '0';\n        for(int i = 0; i < m; i++) t[0] += '0';\n\n\n        for(int i = 1; i <= q; i++){\n            cin >> s[i] >> t[i];\n\n            //押して、変化なし　|| 押さずに変化ありをfalseに\n            for(int j = 0; j < n; j++){\n\n                for(int k = 0; k < m; k++){                    \n                    if((s[i][j] == '1' && (t[i][k] == t[i-1][k])) || s[i][j] == '0' && (t[i][k] != t[i-1][k])) a[j][k] = false; \n                }\n                \n            }\n        \n        }\n\n\n        /*for(int i = 0; i < n; i++){\n            for(int j = 0; j < m; j++){\n                cout << a[i][j] << \" \";            \n            }\n            cout << endl;\n        }*/\n\n        string M = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\n        string ans;\n        for(int i = 0; i < m; i++) ans += '?';\n        for(int i = 0; i < m; i++){\n            for(int j = 0; j < n; j++){\n                if(a[j][i] == true && ans[i] == '?') ans[i] = M[j];\n                else if(a[j][i] == true && ans[i] != '?'){\n                    ans[i] = '?';\n                    //cout << i << \" con\" << endl;\n                    break;\n                }\n            }\n        }\n\n        cout << ans << endl;\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "// template {{{\n\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define loop(i, a, b) for (int i = (int)(a); i < (int)(b); i++)\n#define rep(i, n) loop(i, 0, n)\n#define rloop(i, a, b) for (int i = (int)(b) - 1; i >= (int)(a); i--)\n#define rrep(i, n) rloop(i, 0, n)\n#define eb emplace_back\n#define ef emplace_front\n#define pb pop_back\n#define pf pop_front\n#define all(c) std::begin(c), std::end(c)\n#define mp std::make_pair\n#define mt std::make_tuple\n#define fi first\n#define se second\n#define popcnt __builtin_popcountll\n\nusing uint = unsigned;\nusing ll = long long;\nusing ull = unsigned long long;\nusing ld = long double;\n\ntemplate<typename T>\nusing max_pq = priority_queue<T, vector<T>, less<T>>;\n\ntemplate<typename T>\nusing min_pq = priority_queue<T, vector<T>, greater<T>>;\n\nconst int MOD = 1e9 + 7;\nconst int INF = 1e9 + 10;\nconst ll LLINF = 1e18 + 10;\n\nconst int dx[] = {-1, 0, 1, 0};\nconst int dy[] = {0, -1, 0, 1};\nconst int dx8[] = {-1, -1, 0, 1, 1, 1, 0, -1};\nconst int dy8[] = {0, -1, -1, -1, 0, 1, 1, 1};\n\ntemplate<typename T>\ninline T sq(T x){ return x * x; }\n\ntemplate<typename T, typename U>\ninline bool chmax(T &x, U y){ if (x >= y) return false; x = y; return true; }\n\ntemplate<typename T, typename U>\ninline bool chmin(T &x, U y){ if (x <= y) return false; x = y; return true; }\n\ntemplate<typename T>\ninline void sort(T &c){ std::sort(std::begin(c), std::end(c)); }\n\ntemplate<typename T>\ninline void reverse(T &c){ std::reverse(std::begin(c), std::end(c)); }\n\ntemplate<typename T>\ninline void unique(T &c){ std::sort(std::begin(c), std::end(c)); c.erase(std::unique(all(c)), std::end(c)); }\n\n// }}}\n\nconst int tb[][8] = {\n\t{3, 0, 1, 2, 7, 4, 5, 6},\n\t{4, 0, 3, 7, 5, 1, 2, 6}\n};\n\nmap<string, int> cv;\nset<int> dn;\nint a[8];\n\nint main()\n{\n\twhile (true){\n\t\tcv.clear();\n\t\tdn.clear();\n\n\t\tstring s;\n\t\trep(i, 8){\n\t\t\tif (!(cin >> s)) return 0;\n\t\t\tint t = cv.size();\n\t\t\tif (cv.count(s)) a[i] = cv[s];\n\t\t\telse cv[s] = a[i] = t;\n\t\t}\n\n\t\tint res = 0;\n\t\tint perm[8];\n\t\tiota(perm, perm + 8, 0);\n\t\tdo {\n\t\t\tarray<int, 8> b;\n\t\t\tint c[16] = {};\n\t\t\trep(i, 8) b[i] = a[perm[i]];\n\t\t\tbool f = true;\n\t\t\trep(i, 128){\n\t\t\t\trep(j, 8) c[i] = c[i] * 8 + b[j];\n\t\t\t\tif (dn.count(c[i])) f = false;\n\t\t\t\tarray<int, 8> dst;\n\t\t\t\trep(j, 8){\n\t\t\t\t\tdst[j] = b[tb[0][j]];\n\t\t\t\t}\n\t\t\t\tif (i % 4 == 3){\n\t\t\t\t\trep(j, 8){\n\t\t\t\t\t\tdst[j] = b[tb[1][j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tb = dst;\n\t\t\t}\n\t\t\tif (f) res++;\n\t\t\trep(i, 16) dn.insert(c[i]);\n\t\t} while (next_permutation(perm, perm + 8));\n\t\t\n\t\tcout << res << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\n\n/*\nhttp://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=2590\n\n ???ICPC(International Company of Plugs & Connectors)?????¬?????????????????????\n  N??????????????????????????£???????????????????????§??????M?????????????????????????????????????????¨???\n  ???????????????????????£?????£?¢???????????????????????????????????????§????????????????????????????????°???\n  ?????????????????????????????§???????????????????????????????????????????????????????????????????????????\n  ????????????????????¨??£??????????????????????????????????????¶?????????????????????\n  ??????????????????????????¨?????????????????????????¨????????????¨???????????????????????????????????¨???\n  ??????????????????\n\n  ??????????????\\???????????????????????????????????????????¢???????????????¨????±??????????\n\n  ???????????????????????????????????????????????????????????????????????????????????????????????????\n  ???????????????S1??????????????????????????????????????????????????????\n  ???????????????B1????????????????????¶???????¢??????????\n  ???????????????S2?????????????????????????????????????????????????????????\n  ???????????????B2???????????????????????¶???????¢??????????\n  ??????\n  ???SQ???BQ?????§??°?????????\n\n  ???????????????????????????????????????????????¶???????¢???????????????????????????????????????????????????????\n  ?????????????????????????????¶???????????????????????±????????¨????????????????????????????????¨????????????\n  ??????????????¨?????§????????????\n\n\n*/\n\nint main() {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\tint N, M, Q;\n\twhile (cin >> N >> M >> Q) {\n\t\tif (N == 0 && M == 0 && Q == 0) break;\n\t\tstring S, B;\n\t\tvector<int> light(N, 0); // on or off\n\t\tvector<vector<int>> Switch(M, vector<int>(N, 0)); // switch j := may connect light i\n\t\tfor (int q = 0; q < Q;q++) {\n\t\t\tcin >> S >> B;\n\t\t\tfor (int i = 0; i < N;i++) {\n\t\t\t\tif (S[i] == '1') {\n\t\t\t\t\tlight[i] = (light[i] == 0) ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tfor (int j = 0; j < M;j++) {\n\t\t\t\t\tif (light[i] == (B[j] - '0')) {\n\t\t\t\t\t\tSwitch[j][i]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (int j = 0; j < M;j++) {\n\t\t\tint Max = -1;\n\t\t\tfor (int i = 0; i < N;i++) {\n\t\t\t\tMax = max(Switch[j][i], Max);\n\t\t\t}\n\t\t\tbool f = false;\n\t\t\tint ans = -1;\n\t\t\tfor (int i = 0; i < N;i++) {\n\t\t\t\tif (Switch[j][i] == Max) {\n\t\t\t\t\tif (ans == -1) {\n\t\t\t\t\t\tans = i;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tf = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (f) { cout << '?'; continue; }\n\t\t\tif (ans < 10) {\n\t\t\t\tcout << ans;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcout << (char)('A' + (ans - 10));\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#include<cctype>\n#include<math.h>\n#include<string>\n#include<string.h>\n#include<stack>\n#include<queue>\n#include<vector>\n#include<utility>\n#include<set>\n#include<map>\n#include<stdlib.h>\n#include<iomanip>\n\nusing namespace std;\n\n#define ll long long\n#define ld long double\n#define EPS 0.0000000001\n#define INF 1e9\n#define MOD 1000000007\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define loop(i,a,n) for(i=a;i<(n);i++)\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\n\nint gcd(int a, int b){\n    if(b==0) return a;\n    return gcd(b,a%b);\n}\nint lcm(int a, int b){\n    return a*b/gcd(a,b);\n}\n\n\nint main(void) {\n    int i,j;\n    int n,m,q;\n    while(cin >> n >> m >> q, n){\n        vs s(q),b(q);\n        rep(i,q)cin >> s[i] >> b[i];\n\n        rep(i,m){//iに対応するswitchをさがす\n            int t = -1;\n            rep(j,n){//s[?][j]とb[?][i]が一致しているか？\n                bool c = true;\n                int l = 0;\n                rep(k,q){\n                    l += s[k][j]-'0';\n                    l %= 2;\n                    if(b[k][i] - l != '0')c = false;\n                }\n                if(c){\n                    if(t == -1)t = j;\n                    else{\n                        t = -1;\n                        break;\n                    }\n                }\n            }\n            if(t == -1){\n                cout << \"?\";\n            }else{\n                if(t<10)cout << t;\n                else cout << char('A' + t - 10);\n            }\n        }\n        cout << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\nusing namespace std;\nint main(){\n\n  int N,M,Q;\n    \n  while(1){\n    cin >>N>>M>>Q;\n    if(N+M+Q == 0)break;\n    char s[1000][36],l[1000][1000];\n    int data[N][M];\n    \n    for(int i=0 ; i < Q ; i++)scanf(\"%s%s\",s[i],l[i]);;\n    \n    for(int i=0 ; i < N ; i++)\n      for(int j=0 ; j < M ; j++)\n\tdata[i][j]=1;\n\n    for(int i=0 ; i < Q-1 ; i++){\n      for(int j=0 ; j < N ; j++){\n\tif(s[i][j] == '1'){\n\t  if(s[i+1][j] == '1'){\n\t    s[i+1][j]='0';\n\t  }else{\n\t    s[i+1][j]='1';\n\t  }\n\t}\n      }\n    }\n\n    //for(int i=0 ; i < Q ; i++)cout <<s[i]<<endl;\n    \n    for(int i=0 ; i < Q ; i++){\n      for(int j=0 ; j < N ; j++){\n\tfor(int k=0 ; k < M ; k++){\n\t  if(s[i][j] != l[i][k])data[j][k] = 0;\n\t}\n      }\n    }\n\n    /*\n    for(int i=0 ; i < N ; i++){\n      for(int j=0 ; j < M ; j++){\n\tcout <<data[i][j]<<\" \";\n      }\n      cout <<endl;\n    }\n    */\n\n    for(int i=0 ; i < M ; i++){\n      int cnt=0;\n      int num;\n      for(int j=0 ; j < N ; j++){\n\tcnt+=data[j][i];\n\tif(data[j][i])num=j;\n      }\n      if(cnt == 1){\n\tif(num <= 9){\n\t  cout <<num;\n\t}else{\n\t  cout <<(char)('A'+num-10);\n\t}\n      }else{\n\tcout <<'?';\n      }\n    }\n    cout <<endl;\n    \n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int MAXN = 40, MAXM = 1005;\nchar s1[MAXN], s2[MAXM];\nlong long state[MAXM];\nbool bulb[MAXM];\nchar ans[MAXM];\nint main() {\n    int n, m, q;\n    while(cin >> n >> m >> q && (n || m || q)) {\n        long long mask = (1LL << n) - 1;\n        for(int i = 0; i < m; i ++) {\n            state[i] = mask;\n            bulb[i] = 0;\n        }\n        for(int i = 0; i < q; i ++) {\n            scanf(\"%s %s\", s1, s2);\n            long long changed = 0, notchanged = 0;\n            for(int j = 0; j < n; j ++) {\n                changed = changed * 2 + (s1[j] == '1');\n            }\n            notchanged = mask ^ changed;\n            for(int j = 0; j < m; j ++) {\n                if(s2[j] - '0' == bulb[j]) {\n                    state[j] &= notchanged;\n                } else {\n                    state[j] &= changed;\n                }\n                bulb[j] = s2[j] - '0';\n            }\n        }\n//        for(int i = 0; i < m; i ++) {\n//            cout << state[i] << endl;\n//        }\n        for(int i = 0; i < m; i ++) {\n            int cnt = 0, res = -1;\n            for(int j = 0; j < n; j ++) {\n                if(state[i] >> (n - j - 1) & 1) {\n                    res = j;\n                    cnt ++;\n                }\n            }\n            assert(cnt > 0);\n            if(cnt == 1) {\n                if(res < 10) {\n                    ans[i] = res + '0';\n                } else {\n                    ans[i] = res - 10 + 'A';\n                }\n            } else {\n                ans[i] = '?';\n            }\n        }\n        ans[m] = 0;\n        printf(\"%s\\n\", ans);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "/*\n * 2590.cc: Unknown Switches\n */\n\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<iostream>\n#include<string>\n#include<vector>\n#include<map>\n#include<set>\n#include<stack>\n#include<list>\n#include<queue>\n#include<deque>\n#include<algorithm>\n#include<numeric>\n#include<utility>\n#include<complex>\n#include<functional>\n \nusing namespace std;\n\n/* constant */\n\nconst int MAX_N = 36;\nconst int MAX_M = 1000;\n\n/* typedef */\n\ntypedef long long ll;\n\n/* global variables */\n\nll bs[MAX_M];\n\n/* subroutines */\n\n/* main */\n\nint main() {\n  for (;;) {\n    int n, m, q;\n    cin >> n >> m >> q;\n    if (n == 0) break;\n\n    ll nbits = (1 << n) - 1;\n    for (int i = 0; i < m; i++) bs[i] = nbits;\n\n    ll psb(0);\n\n    while (q--) {\n      string sw, bl;\n      cin >> sw >> bl;\n\n      ll sb(0);\n      for (int i = 0; i < n; i++)\n\tif (sw[i] == '1') sb |= (1LL << i);\n      psb ^= sb;\n\n      for (int i = 0; i < m; i++) {\n\tif (bl[i] == '0') bs[i] &= ~psb;\n\telse bs[i] &= psb;\n      }\n    }\n\n    for (int i = 0; i < m; i++) {\n      int k = 0, bn = 0;\n      for (int j = 0; j < n; j++)\n\tif (bs[i] & (1LL << j)) k = j, bn++;\n\n      if (bn > 1) putchar('?');\n      else if (k < 10) putchar('0' + k);\n      else putchar('A' + k - 10);\n    }\n    putchar('\\n');\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef int Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n//#define mt make_tuple\n//typedef tuple<int,int,int> tp;\n//typedef vector<tp> vt;\nconst double PI=acos(-1);\nconst double EPS=1e-7;\nconst int inf=1e9;\nconst ll INF=2e18;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\nint main(){\n\tint n,m,q;\n\twhile(cin>>n>>m>>q,n){\n\t\tif(n==1){\n\t\t\tcout<<string(m,'0')<<endl;\n\t\t}else{\n\t\t\tvs in1(q),in2(q);\n\t\t\trep(i,q)cin>>in1[i]>>in2[i];\n\t\t\trep(i,n){\n\t\t\t\tint c=0;\n\t\t\t\trep(j,q){\n\t\t\t\t\tif(in1[j][i]=='1')c++;\n\t\t\t\t\tif(c%2)in1[j][i]='1';\n\t\t\t\t\telse in1[j][i]='0';\n\t\t\t\t}\n\t\t\t}\n\t\t\tstring out=\"\";\n\t\t\trep(i,m){\n\t\t\t\tvi ko;\n\t\t\t\trep(j,n){\n\t\t\t\t\tbool h=true;\n\t\t\t\t\trep(k,q)if(in1[k][j]!=in2[k][i])h=false;\n\t\t\t\t\tif(h)ko.pb(j);\n\t\t\t\t}\n\t\t\t\tif(ko.size()==1){\n\t\t\t\t\tif(ko[0]<10)out+=(char)(ko[0]+'0');\n\t\t\t\t\telse out+=(char)(ko[0]-10+'A');\n\t\t\t\t}else out+=\"?\";\n\t\t\t}\n\t\t\tcout<<out<<endl;\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\nint main(){\n  int n, m, q;\n  while(cin >> n >> m >> q, n){\n    vector<string> S(q+1), B(q+1);\n    S[0] = string(n,'0');\n    B[0] = string(m,'0');\n    for(int i = 0; i < q; ++i) cin >> S[i+1] >> B[i+1];\n    vector< vector<bool> > A(m,vector<bool>(n,true));\n    for(int i = 1; i <= q; ++i){\n      for(int j = 0; j < n; ++j){\n        if(S[i][j] == '1'){\n          for(int k = 0; k < m; ++k){\n            if(B[i][k] == B[i-1][k] && A[k][j]) A[k][j] = false;\n          }\n        }else{\n          for(int k = 0; k < m; ++k){\n            if(B[i][k] != B[i-1][k] && A[k][j]) A[k][j] = false;\n          }\n        }\n      }\n    }\n    for(int i = 0; i < m; ++i){\n      int c = 0;\n      char ans;\n      for(int j = 0; j < n; ++j){\n        if(A[i][j]){\n          if(c == 0){\n            if(j < 10) ans = '0' + j;\n            else ans = 'A' + j - 10;\n            ++c;\n          }else{\n            ans = '?';\n            break;\n          }\n        }\n      }\n      cout << ans;\n    }\n    cout << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef unsigned long long LL;\ntypedef pair<int, int> PII;\nconst int MAXN = 2000 + 10, SIZE = 1024;\nLL A[MAXN];\nint N, M, Q;\n\nchar s[MAXN], t[MAXN];\n\nchar change(int x) {\n  if (x < 10) return x + '0';\n  else return 'A' + x - 10;\n}\n\nint main() {\n  while (scanf(\"%d%d%d\", &N, &M, &Q) == 3 && N) {\n    for (int i = 0; i < M; ++ i) A[i] = LL(1ll << N) - 1;\n    LL sw = 0;\n    for (int _ = 0; _ < Q; ++ _) {\n      scanf(\"%s%s\", s, t);\n      for (int i = 0; i < N; ++ i) sw ^= LL(s[i] - '0') << i;\n      for (int i = 0; i < M; ++ i) {\n        A[i] &= t[i] == '1' ? sw : ~sw;\n      }\n    }\n    for (int i = 0; i < M; ++ i) s[i] = '?'; s[M] = 0;\n    for (int i = 0; i < M; ++ i) {\n      if (__builtin_popcountll(A[i]) != 1) continue;\n      int x = __builtin_ctzll(A[i]);\n      s[i] = change(x);\n    }\n    puts(s);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n  string base36 = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ?\";\n  int N, M, Q;\n  while(cin >> N >> M >> Q, N || M || Q){\n    long long bulb[1024]; //memset(bulb, -1LL, sizeof(bulb));\n    for(int i = 0; i < M; i++) bulb[i] = (1LL << N) - 1LL;\n    long long swch = 0LL;\n    for(int i = 0; i < Q; i++){\n      string S, B;\n      cin >> S >> B;\n      long long s = 0LL, b = 0LL;\n      for(int j = 0; j < N; j++) if(S[j] == '1') s |= (1LL << j);\n      for(int j = 0; j < M; j++) if(B[j] == '1') b |= (1LL << j);\n      swch ^= s;\n      for(int j = 0; j < M; j++){\n\t//if((b >> j) & 1LL) bulb[j] &= swch;\n\tif(B[j] == '1') bulb[j] &= swch;\n\telse bulb[j] &= ~swch;\n      }\n    }\n    for(int i = 0; i < M; i++){\n      int ctrl = -1;\n      int cnt = 0;\n      for(int j = 0; j < N; j++){\n\t//if((bulb[i] >> j) & 1LL) cnt++, ctrl = j;\n\tif(bulb[i] == (1LL << j)) cnt++, ctrl = j;\n      }\n      if(cnt == 1) cout << base36[ctrl];\n      else cout << \"?\";\n    }\n    cout << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P> PP;\n  \nstatic const double EPS = 1e-8;\n\nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nint main(){\n  int num_of_switches;\n  int num_of_light_bulbs;\n  int num_of_operations;\n  while(~scanf(\"%d %d %d\",\n               &num_of_switches,\n               &num_of_light_bulbs,\n               &num_of_operations)){\n    if(num_of_switches == 0\n       && num_of_light_bulbs == 0\n       && num_of_operations == 0) break;\n\n    bool flags[50] = {};\n    bool states[50][1001] = {};\n    vector<string> light_bulbs_log;\n    for(int operation_i = 0; operation_i < num_of_operations; operation_i++){\n      string switches;\n      string light_bulbs;\n      cin >> switches >> light_bulbs;\n      for(int switch_i = 0; switch_i < switches.size(); switch_i++){\n        if(switches[switch_i] == '1'){\n          flags[switch_i] = !flags[switch_i];\n        }\n        states[switch_i][operation_i] = flags[switch_i];\n      }\n      light_bulbs_log.push_back(light_bulbs);\n    }\n    \n    for(int light_i = 0; light_i < num_of_light_bulbs; light_i++){\n\n      vector<int> candidates;\n      for(int switch_i = 0; switch_i < num_of_switches; switch_i++){\n        bool isok = true;\n        for(int operation_i = 0; operation_i < light_bulbs_log.size(); operation_i++){\n          bool state = (light_bulbs_log[operation_i][light_i] == '1' ? true : false);\n          if(states[switch_i][operation_i] != state){\n            isok = false;\n            break;\n          }\n        }\n\n        if(isok){\n          candidates.push_back(switch_i);\n        }\n      }\n\n      if(candidates.size() != 1){\n        printf(\"?\");\n      }\n      else{\n        if(candidates[0] >= 10){\n          printf(\"%c\",candidates[0] - 10 + 'A');\n        }\n        else{\n          printf(\"%c\",candidates[0] + '0');\n        }\n      }\n    }\n    cout << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nint main(){\n    int N,M,Q;\n    while(cin>>N>>M>>Q,N){\n        int memo[M][N];\n        fill(memo[0],memo[M],0);\n        for(int q=0;q<Q;q++){\n            string S,B;\n            cin>>S>>B;\n            for(int s=0;s<N;s++){\n                for(int b=0;b<M;b++){\n                    if(S[s]=='1'){\n                        if(B[b]=='0'){\n                            memo[b][s]=-1;\n                        }else{\n                            if(memo[b][s]!=-1)memo[b][s]=1;\n                        }\n                    }else{\n                        if(B[b]=='1') memo[b][s]=-1;\n                    }\n                }\n            }\n        }\n        for(int b=0;b<M;b++){\n            int sw = -1;\n            for(int s=0;s<N;s++){\n                if(memo[b][s]==1){\n                    if(sw==-1) sw=s;\n                    else if(sw>-1) sw=-2;\n                }\n            }\n            if(sw==-1){\n                for(int s=0;s<N;s++){\n                    if(memo[b][s]==0){\n                        if(sw==-1) sw=s;\n                        else if(sw>-1) sw=-2;\n                    }\n                }\n            }\n            if(sw<0)cout<<'?';\n            else{\n                if(sw<10){\n                    cout<<sw;\n                }else{\n                    cout<<char('A'+sw-10);\n                }\n            }\n        }\n        cout<<endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntemplate<class T>\nbool chmax(T& a, const T& b) {\n    if (a < b) { a = b; return true; }\n    return false;\n}\ntemplate<class T>\nbool chmin(T& a, const T& b) {\n    if (b < a) { a = b; return true; }\n    return false;\n}\n\n// std::vector Declaration\ntemplate<typename T>\nvector<T> make_v(size_t a) { return vector<T>(a); }\ntemplate<typename T, typename... Ts>\nauto make_v(size_t a, Ts... ts) {\n    return vector<decltype(make_v<T>(ts...))>(a, make_v<T>(ts...));\n}\n\n// std::vector Declaration and Initialization\ntemplate<typename T>\nvector<T> make_vector(size_t a, T x) { return vector<T>(a, x); }\ntemplate<typename T, typename U, typename... Ts>\nauto make_vector(size_t a, U b, Ts... ts) {\n    return vector<decltype(make_vector<T>(b,ts...))>(a, make_vector<T>(b, ts...));\n}\n\n// std::vector Input\ntemplate<typename T>\nistream& operator>>(istream& is, vector<T>& v) {\n    for (auto &e : v) is >> e;\n    return is;\n}\n\n// std::vector Debug\ntemplate<typename T>\nostream& operator<<(ostream& os, const vector<T>& v) {\n    os << \"[\";\n    bool a = 1;\n    for (auto e : v) {\n        os << (a ? \"\" : \" \");\n        os << e;\n        a = 0;\n    }\n    os << \"]\";\n    return os;\n}\n\n// std::array Debug\ntemplate<typename T, size_t n>\nostream& operator<<(ostream& os, const array<T, n>& v) {\n    os << \"[\";\n    bool a = 1;\n    for (auto e : v) {\n        os << (a ? \"\" : \" \");\n        os << e;\n        a = 0;\n    }\n    os << \"]\";\n    return os;\n}\n\n// std::deque Debug\ntemplate<typename T>\nostream& operator<<(ostream& os, const deque<T>& d) {\n    os << \"[\";\n    bool a = 1;\n    for (auto e : d) {\n        os << (a ? \"\" : \" \");\n        os << e;\n        a = 0;\n    }\n    os << \"]\";\n    return os;\n}\n\n// std::pair Debug\ntemplate<typename T, typename U>\nostream& operator<<(ostream& os, const pair<T, U>& p) {\n    os << \"(\" << p.first << \" \" << p.second << \")\";\n    return os;\n}\n\n// std::set Debug\ntemplate<typename T>\nostream& operator<<(ostream& os, const set<T>& st) {\n    os << \"{\";\n    bool a = 1;\n    for (auto e : st) {\n        os << (a ? \"\" : \" \");\n        os << e;\n        a = 0;\n    }\n    os << \"}\";\n    return os;\n}\n\n// std::multiset Debug\ntemplate<typename T>\nostream& operator<<(ostream& os, const multiset<T>& st) {\n    os << \"{\";\n    bool a = 1;\n    for (auto e : st) {\n        os << (a ? \"\" : \" \");\n        os << e;\n        a = 0;\n    }\n    os << \"}\";\n    return os;\n}\n\n// std::map Debug\ntemplate<typename T, typename U>\nostream& operator<<(ostream& os, const map<T, U>& mp) {\n    os << \"{\";\n    bool a = 1;\n    for (auto e : mp) {\n        os << (a ? \"\" : \" \");\n        os << e.first << \":\" << e.second;\n        a = 0;\n    }\n    os << \"}\";\n    return os;\n}\n\n// std::tuple Debug\ntemplate<int N, class Tuple>\nvoid out(ostream& os, const Tuple& t){}\ntemplate<int N, class Tuple, class H, class ...Ts>\nvoid out(ostream& os, const Tuple& t) {\n    if (N) os << \" \";\n    os << get<N>(t);\n    out<N+1,Tuple,Ts...>(os, t);\n}\ntemplate<class ...Ts>\nostream& operator<<(ostream& os, const tuple<Ts...>& t) {\n    os << \"(\";\n    out<0,tuple<Ts...>,Ts...>(os, t);\n    os << \")\";\n    return os;\n}\n\n// Debug\n#define DUMP(x) cerr<<#x<<\" = \"<<(x)<<endl\n\n// Weighted edge\ntemplate<typename T>\nstruct edge {\n    int src, to;\n    T cost;\n\n    edge() {}\n    edge(int to, T cost) : src(-1), to(to), cost(cost) {}\n    edge(int src, int to, T cost) : src(src), to(to), cost(cost) {}\n\n    friend ostream& operator<<(ostream& os, const edge& e) {\n        return os << \"(\" << e.src << \"->\" << e.to << \":\" << e.cost << \")\";\n    }\n};\n\nusing LL = long long;\n\n#define fs first\n#define sc second\n\nconst LL MOD = 1e9+7;\n\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(10);\n\n    const int LAMPS = 1000,\n              SWCHS = 36;\n\n    while (true) {\n        int N, M, Q; cin >> N >> M >> Q;\n        if (N == 0) {\n            break;\n        }\n\n        bitset<LAMPS> cur;\n        vector<bitset<SWCHS>> cands(M, ~bitset<SWCHS>());\n\n        for (int t = 0; t < Q; ++t) {\n            bitset<SWCHS> swch;\n            bitset<LAMPS> lamp;\n            cin >> swch >> lamp;\n\n            for (int i = 0; i < M; ++i) {\n                cands[i] &= (cur[i] == lamp[i] ? ~swch : swch);\n            }\n            cur = lamp;\n        }\n\n        for (int i = M-1; i >= 0; --i) {\n            int s = 0;\n            for (int j = 0; j < N; ++j) {\n                if (cands[i][j]) ++s;\n            }\n            if (s != 1) {\n                cout << \"?\";\n                continue;\n            }\n\n            for (int j = 0; j < N; ++j) {\n                if (cands[i][N-1-j]) {\n                    cout << (char)(j < 10 ? j+'0' : j-10+'A');\n                }\n            }\n        }\n        cout << endl;\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "//#define _GLIBCXX_DEBUG\n#include <iostream>\n#include <vector>\n#include <stdio.h>\n#include <bits/stdc++.h>\n\n\nusing namespace std;\n#define ll long long\n#define ld long double\n#define  P pair<ll,ll>\n#define FOR(i,n,m) for(ll i=n; i<(ll)m;i++)\n#define FORa(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define FORr(i,m,n) for(ll i=n; i>=(ll)m; i--)\n#define FORm(i,m) for(auto i=m.begin();i!=m.end();i++)\n#define FORs(i,st) for(auto i : st)\n#define REP(i,n) for(int i=0;i<(int)n;++i)\n#define ALL(c) (c).begin(), (c).end()\n#define VEC2(x,a,b) vector<vector<ll>> x = vector<vector<ll>>(a,vector<ll>(b,0))\n#define sortAl(v) sort(v.begin(),v.end())\n#define sortAlr(v) sort(v.begin(),v.end()); reverse(v.begin(),v.end())\n#define cinv(v,n,m) FOR(i,n,m) cin>>v.at(i)\n#define coutv(v,n,m) FOR(i,n,m) cout<<v.at(i) <<\" \"; cout<<endl\n#define cout(n) cout<<fixed<<setprecision(n)\n\nchar int_to_char(ll x){\n  if(x == -1) return '?';\n  else if(x<=9)return '0' + x;\n  else return 'A' + x - 10;\n}\n\n\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    ll n,m,q;\n    cin>>n>>m>>q;\n    while(n != 0){\n\n      vector<string> sw(q+1);\n      vector<string> light(q+1);\n      vector<ll> ans(m, -1);\n\n      FOR(i,0,n){\n        sw[0].push_back('0');\n      }\n      FOR(i,0,m){\n        light[0].push_back('0');\n      }\n\n      FOR(i,1,q+1){\n        cin>>sw[i]>>light[i];\n      }\n      q++;\n\n      FOR(i,1,q){\n        FOR(j,0,n){\n          if(sw[i-1][j] == '1' && sw[i][j] == '1') sw[i][j] = '0';\n          else if(sw[i-1][j] == '0' && sw[i][j] == '1') sw[i][j] = '1';\n          else if(sw[i-1][j] == '1' && sw[i][j] == '0') sw[i][j] = '1';\n        }\n      }\n\n      FOR(i,0,q){\n        FOR(j,i+1,q){\n          ll xor_1 = 0;\n          ll x1_po = 0;\n          ll xor_0 = 0;\n          ll x0_po = 0;\n          ll and_ = 0;\n          ll a_po = 0;\n          FOR(k,0,n){\n            if(sw[i][k] == '1' && sw[j][k] == '1'){\n              and_++;\n              a_po = k;\n            }\n            if((sw[i][k] == '0' && sw[j][k] == '1')){\n              xor_1++;\n              x1_po = k;\n            }\n            if((sw[i][k] == '1' && sw[j][k] == '0')){\n              xor_0++;\n              x0_po = k;\n            }\n\n          }\n\n          FOR(k,0,m){\n            if(and_ == 1){\n              if(light[i][k] == '1' && light[j][k] == '1') ans[k] = a_po;\n            }\n            if(xor_1 == 1){\n              if(light[i][k] == '0' && light[j][k] == '1') ans[k] = x1_po;\n            }\n            if(xor_0 == 1){\n              if(light[i][k] == '1' && light[j][k] == '0') ans[k] = x0_po;\n            }\n\n          }\n\n        }\n      }\n      vector<ll> used(m);\n      ll f=0;\n      FOR(i,0,m){\n        if(ans[i] != -1){\n          if(used[ans[i]] == 0) f++;\n          used[ans[i]] = 1;\n        }\n      }\n\n      if(f == n-1){\n        FOR(i,0,m){\n          if(used[i] == 0){\n            FOR(j,0,m){\n              if(ans[j] == -1){\n                ans[j] = i;\n              }\n            }\n            break;\n          }\n        }\n      }\n\n      FOR(i,0,m){\n        cout<<int_to_char(ans[i]);\n      }\n      cout<<endl;\n\n      cin>>n>>m>>q;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"iostream\"\n#include \"climits\"\n#include \"list\"\n#include \"queue\"\n#include \"stack\"\n#include \"set\"\n#include \"functional\"\n#include \"algorithm\"\n#include \"string\"\n#include \"map\"\n#include \"unordered_map\"\n#include \"unordered_set\"\n#include \"iomanip\"\n#include \"cmath\"\n#include \"random\"\n#include \"bitset\"\n#include \"cstdio\"\n#include \"numeric\"\n#include \"cassert\"\n#include \"ctime\"\n\nusing namespace std;\n\nconstexpr long long int MOD = 1000000007;\n//constexpr int MOD = 1000000007;\n//constexpr int MOD = 998244353;\n//constexpr long long int MOD = 998244353;\nconstexpr double EPS = 1e-12;\n\n//int N, M, K, T, H, W, L, R;\nlong long int N, M, K, T, H, W, L, R;\n\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\n\twhile (cin >> N >> M >> K, N) {\n\t\tvector<vector<bool>>v(N, vector<bool>(M, true));\n\t\tvector<string>s(K);\n\t\tvector<string>t(K);\n\t\tfor (int i = 0; i < K; i++) {\n\t\t\tcin >> s[i] >> t[i];\n\t\t}\n\t\tfor (int i = 1; i < K; i++) {\n\t\t\tfor (int j = 0; j < N; j++) {\n\t\t\t\ts[i][j] = (s[i][j] != s[i - 1][j]) + '0';\n\t\t\t}\n\t\t}\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tfor (int j = 0; j < K; j++) {\n\t\t\t\tfor (int k = 0; k < M; k++) {\n\t\t\t\t\tv[i][k] = v[i][k] && (s[j][i] == t[j][k]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvector<int>ans(M, -1);\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tfor (int j = 0; j < M; j++) {\n\t\t\t\tif (v[i][j]) {\n\t\t\t\t\tif (ans[j] == -1)ans[j] = i;\n\t\t\t\t\telse ans[j] = -2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (int i = 0; i < M; i++) {\n\t\t\tif (ans[i] < 0)cout << \"?\";\n\t\t\telse if (ans[i] < 10)cout << ans[i];\n\t\t\telse cout << char('A' + ans[i] - 10);\n\t\t}\n\t\tcout << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define For(i, a, b) for(int (i)=(int)(a); (i)<(int)(b); ++(i))\n#define rFor(i, a, b) for(int (i)=(int)(a)-1; (i)>=(int)(b); --(i))\n#define rep(i, n) For((i), 0, (n))\n#define rrep(i, n) rFor((i), (n), 0)\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long lint;\ntypedef unsigned long long ulint;\ntypedef pair<int, int> pii;\ntypedef pair<lint, lint> pll;\ntemplate<class T> bool chmax(T &a, const T &b){if(a<b){a=b; return true;} return false;}\ntemplate<class T> bool chmin(T &a, const T &b){if(a>b){a=b; return true;} return false;}\ntemplate<class T> T div_floor(T a, T b){\n    if(b < 0) a *= -1, b *= -1;\n    return a>=0 ? a/b : (a+1)/b-1;\n}\ntemplate<class T> T div_ceil(T a, T b){\n    if(b < 0) a *= -1, b *= -1;\n    return a>0 ? (a-1)/b+1 : a/b;\n}\n\nconstexpr lint mod = 1e9+7;\nconstexpr lint INF = mod * mod;\nconstexpr int MAX = 100010;\n\nint n, m, q;\nlint table[1010];\n\nint main(){\n    string s[1010], a[1010], b[1010];\n    while(scanf(\"%d%d%d\", &n, &m, &q) && n){\n        rep(i, q) cin >> s[i] >> a[i];\n        b[0] = a[0];\n        rep(i, q)if(i >= 1){\n            b[i] = a[i];\n            rep(j, m) b[i][j] = '0' + (a[i][j] != a[i-1][j]);\n        }\n\n        rep(i, m) table[i] = (1LL<<n) - 1;\n        rep(i, q){\n            rep(j, m){\n                lint tmp = (1LL<<n) - 1;\n                rep(k, n)if(s[i][k] != b[i][j]) tmp ^= 1LL<<k;\n                table[j] &= tmp;\n            }\n        }\n        string ans;\n        rep(i, m){\n            if(__builtin_popcountll(table[i]) > 1) ans += '?';\n            else {\n                rep(j, n){\n                    if(table[i]>>j & 1){\n                        ans += (j<=9 ? '0'+j : 'A'+(j-10));\n                    }\n                }\n            }\n        }\n        cout << ans << \"\\n\";\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nint main(){\n    int N,M,Q;\n    while(cin>>N>>M>>Q,N){\n        int memo[M][N];\n        fill(memo[0],memo[M],0);\n        string SW=string(N,'0');\n        for(int q=0;q<Q;q++){\n            string S,B;\n            cin>>S>>B;\n            for(int s=0;s<N;s++){\n                if(S[s]=='1'){\n                    if(SW[s]=='0') SW[s]='1';\n                    else SW[s]='0';\n                }\n            }\n            for(int s=0;s<N;s++){\n                for(int b=0;b<M;b++){\n                    if(SW[s]=='1'){\n                        if(B[b]=='0'){\n                            memo[b][s]=-1;\n                        }else{\n                            if(memo[b][s]!=-1)memo[b][s]=1;\n                        }\n                    }else{\n                        if(B[b]=='1') memo[b][s]=-1;\n                    }\n                }\n            }\n        }\n        for(int b=0;b<M;b++){\n            int sw = -1;\n            for(int s=0;s<N;s++){\n                if(memo[b][s]==1){\n                    if(sw==-1) sw=s;\n                    else if(sw>-1) sw=-2;\n                }\n            }\n            if(sw==-1){\n                for(int s=0;s<N;s++){\n                    if(memo[b][s]==0){\n                        if(sw==-1) sw=s;\n                        else if(sw>-1) sw=-2;\n                    }\n                }\n            }\n            if(sw<0)cout<<'?';\n            else{\n                if(sw<10){\n                    cout<<sw;\n                }else{\n                    cout<<char('A'+sw-10);\n                }\n            }\n        }\n        cout<<endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<cstring>\ntypedef long long int lli;\nusing namespace std;\n\nint main(){\n  lli n,m,q;\n  while(cin>>n>>m>>q,n){\n    lli ans[m];\n    lli h[2]={0};\n    string s,b;\n    for(int i=0;i<m;i++)ans[i]=(1LL<<n)-1;\n    for(int i=0;i<q;i++){\n      h[0]=0;\n      cin>>s>>b;\n      for(int j=0;j<n;j++)\n\tif(s[j]=='1')h[0]+=1LL<<j;\n      //cout << \"h:\" << h << endl;\n      h[1]^=h[0];\n      for(int j=0;j<m;j++){\n\tif(b[j]=='1'){\n\t  ans[j]&=h[1];\n\t}else{\n\t  ans[j]&=~h[1];\n\t}\n\t//cout << \"h[1]:\"<<h[1] << endl;\n\t//cout << ans[j] << endl;\n      }\n    }\n    for(int i=0;i<m;i++){\n      if(__builtin_popcountll(ans[i])>1){\n\tcout << \"?\";\n      }else{\n\tfor(int j=0;j<n;j++){\n\t  if(ans[i]==1){\n\t    if(j<10){\n\t      cout << j;\n\t      break;\n\t    }else{\n\t      cout << (char)('A'-10+j);\n\t      break;\n\t    }\n\t  }\n\t  ans[i]/=2;\n\t}\n      }\n    }\n    cout << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cstdio>\nusing namespace std;\nint check(int N,long long mask){\n\tint c=-1;\n\tlong long k=1;\n\tfor(int i=0;i<N;i++,k<<=1){\n\t\tif(mask&k){\n\t\t\tif(c>=0)c=-2;\n\t\t\tif(c==-1)c=i;\n\t\t}\n\t}\n\treturn c;\n}\nint main(){\n\tfor(int N,M,Q;cin>>N>>M>>Q,N;){\n\t\tvector<long long>v0(M);\n\t\tvector<long long>v1(M);\n\t\tstring prev(M,'0');\n\t\t{\n\t\t\tlong long mask=0,k=1;\n\t\t\tfor(int i=0;i<N;i++,k<<=1){\n\t\t\t\tmask|=k;\n\t\t\t}\n\t\t\tfor(int i=0;i<M;i++){\n\t\t\t\tv0[i]=v1[i]=mask;\n\t\t\t}\n\t\t}\n\t\tfor(;Q--;){\n\t\t\tstring s,t;\n\t\t\tcin>>s>>t;\n\t\t\tlong long mask0=0,mask1=0,k=1;\n\t\t\tfor(int i=0;i<s.size();i++,k<<=1){\n\t\t\t\tif(s[i]=='0')mask0|=k;\n\t\t\t\tif(s[i]=='1')mask1|=k;\n\t\t\t}\n\t\t\tfor(int i=0;i<t.size();i++){\n\t\t\t\tif((prev[i]^t[i])==0)\n\t\t\t\t\tv0[i]&=mask0;\n\t\t\t\telse\n\t\t\t\t\tv1[i]&=mask1;\n\t\t\t}\n\t\t\tprev=t;\n\t\t}\n\t\tfor(int j=0;j<M;j++){\n\t\t\tlong long k=1;\n\t\t\tint c0=check(N,v0[j]),c1=check(N,v1[j]),c2=check(N,v1[j]&v0[j]);\n\t\t\tif(c0>=0)putchar(c0<10?c0+'0':c0-10+'A');\n\t\t\telse if(c1>=0)putchar(c1<10?c1+'0':c1-10+'A');\n\t\t\telse if(c2>=0)putchar(c2<10?c2+'0':c2-10+'A');\n\t\t\telse putchar('?');\n\t\t}\n\t\tputs(\"\");\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\nchar conv[40] = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\nstring solve(int n, int m, int q,\n             vector<string>& vs,\n             vector<string>& vb) {\n    string s = \"\";\n\n    for (int i = 0; i < m; ++i) {\n        vector<int> cand;\n        for (int j = 0; j < n; ++j) {\n            bool flg = (vs[0][j] == vb[0][i]);\n            for (int k = 1; flg && k < q; ++k) {\n                if(vs[k][j] == '1' && (vb[k][i] == vb[k - 1][i])) {\n                    flg = false;\n                }\n                if(vs[k][j] == '0' && (vb[k][i] != vb[k - 1][i])) {\n                    flg = false;\n                }\n            }\n\n            if (flg) {\n                cand.push_back(j);\n            }\n        }\n\n        s += (cand.size() == 1 ? conv[cand[0]] : '?');\n    }\n    \n    return s;\n}\n\nint main() {\n    int n, m, q;\n    vector<string> vs;\n    vector<string> vb;\n    while (true) {\n        cin >> n >> m >> q;\n        if(n == 0 && m == 0 && q == 0) {\n            break;\n        }\n        vs.resize(q);\n        vb.resize(q);\n        for (int j = 0; j < q; ++j) {\n            cin >> vs[j] >> vb[j];\n        }\n        cout << solve(n, m, q, vs, vb) << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define reep(i,a,b) for(int i=(a);i<(b);i++)\n#define rep(i,n) reep((i),0,(n))\n\nint main(){\n    int n,m,q;\n    vector<char> w(36);\n    rep(i,10) w[i]='0'+i;\n    reep(j,10,36){\n        w[j]='A'+j-10;\n    }\n    while(cin>>n>>m>>q,n||m||q){\n        vector<vector<int>> v(m,vector<int>(n,1));\n        string pre(m,'0');\n        rep(i,q){\n            string a,b;\n            cin>>a>>b;\n            rep(i,n){\n                if(a[i]=='0'){\n                    rep(j,m){\n                        if(pre[j]!=b[j]){\n                            v[j][i]=0;\n                        }\n                    }\n                }\n                else rep(j,m){\n                    if(pre[j]==b[j]){\n                        v[j][i]=0;\n                    }\n                }\n            }\n            pre=b;\n        }\n        rep(i,m){\n            int cnt=0;\n            int ans=-1;\n            rep(j,n){\n                if(v[i][j]) cnt++,ans=j;\n            }\n            if(cnt>=2){\n                cout<<\"?\";\n            }\n            else if(cnt==1){\n                cout<<w[ans];\n            }\n        }\n        cout<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdint>\n#include <vector>\n#include <algorithm>\n#include <string>\n\nint base36(int c) {\n  if (c <= 9) return '0' + c;\n  return 'A' + (c - 10);\n}\n\nint testcase_ends() {\n  size_t n, m, q;\n  scanf(\"%zu %zu %zu\", &n, &m, &q);\n  if (n == 0 && m == 0 && q == 0) return 1;\n\n  std::vector<std::string> ss(q), bs(q);\n  for (size_t i = 0; i < q; ++i) {\n    char buf[1024];\n    scanf(\"%s\", buf);\n    ss[i] = buf;\n    scanf(\"%s\", buf);\n    bs[i] = buf;\n    if (i > 0) {\n      for (size_t j = 0; j < n; ++j) {\n        ss[i][j] ^= ss[i-1][j] ^ '0';\n      }\n    }\n  }\n\n  // for (size_t i = 0; i < q; ++i)\n  //   fprintf(stderr, \"%s\\n\", ss[i].c_str());\n\n  std::string res(m, '?');\n  for (size_t i = 0; i < m; ++i) {\n    long long cand = (1LL << n) - 1;\n    for (size_t j = 0; j < q; ++j) {\n      for (size_t k = 0; k < n; ++k) {\n        if (bs[j][i] != ss[j][k])\n          cand &= ~(1LL << k);\n      }\n    }\n    // fprintf(stderr, \"i: %zu, pop: %d\\n\", i, __builtin_popcount(cand));\n    if (__builtin_popcountll(cand) != 1) continue;\n    res[i] = base36(__builtin_ctzll(cand));\n  }\n  printf(\"%s\\n\", res.c_str());\n  return 0;\n}\n\nint main() {\n  while (!testcase_ends()) {}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n  string base36 = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ?\";\n  int N, M, Q;\n  while(cin >> N >> M >> Q, N || M || Q){\n    long long bulb[1000]; memset(bulb, -1L, sizeof(bulb));\n    long long swch = 0;\n    for(int i = 0; i < Q; i++){\n      string S, B;\n      cin >> S >> B;\n      long long s = 0L, b = 0L;\n      for(int j = 0; j < S.size(); j++) s |= (((S[j]=='1')&1L) << j);\n      for(int j = 0; j < B.size(); j++) b |= (((B[j]=='1')&1L) << j);\n      swch ^= s;\n      for(int j = 0; j < M; j++){\n\tif((b >> j) & 1L){\n\t  bulb[j] &= swch;\n\t} else {\n\t  bulb[j] &= ~swch;\n\t}\n      }\n    }\n    for(int i = 0; i < M; i++){\n      int ctrl = -1;\n      int cnt = 0;\n      for(int j = 0; j < N; j++){\n\tif((bulb[i] >> j) & 1L) cnt++, ctrl = j;\n      }\n      if(cnt == 1) cout << base36[ctrl];\n      else cout << \"?\";\n    }\n    cout << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vec;\ntypedef vector<vec> mat;\n\nint main() {\n    int N, M, Q;\n    while (cin >> N >> M >> Q, N + M + Q) {\n        vector<string> S(Q + 1), B(Q + 1);\n        for (int i = 0; i < M; i++) B[0] += '0';\n        for (int i = 1; i <= Q; i++) {\n            cin >> S[i-1] >> B[i];\n        }\n\n        mat b(Q, vec(M, 0));\n        for (int i = 1; i <= Q; i++) {\n            for (int j = 0; j < M; j++) {\n                if (B[i][j] != B[i-1][j]) b[i - 1][j] = 1;\n            }\n        }\n\n        mat dp2(N, vec(M, 1));\n        for (int i = 0; i < N; i++) {\n            for (int j = 0; j < Q; j++) {\n                if (S[j][i] == '1') {\n                    for (int k = 0; k < M; k++) {\n                        dp2[i][k] *= b[j][k];\n                    }\n                }\n            }\n        }\n\n        mat dp(M, vec(N, 1));\n        for (int i = 0; i < M; i++) {\n            for (int j = 0; j < Q; j++) {\n                if (b[j][i]) {\n                    for (int k = 0; k < N; k++) {\n                        dp[i][k] *= (S[j][k] == '1' ? 1 : 0);\n                    }\n                }\n            }\n        }\n\n        vector<set<int>> count2(M);\n        for (int i = 0; i < N; i++) {\n            for (int j = 0; j < M; j++) {\n                if (dp2[i][j]) count2[j].insert(i);\n            }\n        }\n\n        vector<set<int>> count(M);\n        for (int i = 0; i < M; i++) {\n            for (int j = 0; j < N; j++) {\n                if (dp[i][j]) count[i].insert(j);\n            }\n        }\n\n        vector<char> dis(M);\n        vec dd(M);\n        for (int i = 0; i < M; i++) {\n            int num = -1;\n            if (count[i].size() == 1) {\n                num = *(count[i].begin());\n            } else if (count2[i].size() == 1) {\n                num = *(count2[i].begin());\n            }\n            if (num < 0) dis[i] = '?';\n            else if (num < 10) dis[i] = '0' + num;\n            else dis[i] = 'A' + num - 10;\n            dd[i] = num;\n        }\n        vec ls;\n        for (int i = 0; i < N; i++) {\n            if (find(dd.begin(), dd.end(), i) == dd.end()) ls.push_back(i);\n        }\n        if (ls.size() == 1) {\n            for (int i = 0; i < M; i++) if (dd[i] < 0) {\n                if (ls[0] < 10) dis[i] = '0' + ls[0];\n                else dis[i] = 'A' + ls[0] - 10;\n            }\n        }\n        for (auto i : dis) cout << i;\n        cout << endl;\n    }\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef ostringstream OSS; typedef istringstream ISS;\ntypedef long long LL;\ntypedef pair<int, int> PII;  typedef pair<LL, LL> PLL;\ntypedef vector<int>    VI;   typedef vector<VI>   VVI;   typedef vector<VVI>   VVVI;\ntypedef vector<LL>     VLL;  typedef vector<VLL>  VVLL;  typedef vector<VVLL>  VVVLL;\ntypedef vector<double> VD;   typedef vector<VD>   VVD;   typedef vector<VVD>   VVVD;\ntypedef vector<string> VS;   typedef vector<VS>   VVS;   typedef vector<VVS>   VVVS;\ntypedef vector<bool>   VB;   typedef vector<VB>   VVB;   typedef vector<VVB>   VVVB;\ntypedef vector<PII>    VPII; typedef vector<VPII> VVPII; typedef vector<VVPII> VVVPII;\ntypedef vector<PLL>    VPLL; typedef vector<VPLL> VVPLL; typedef vector<VVPLL> VVVPLL;\n\ntypedef unsigned int  UI;\ntypedef vector<UI>    VUI;\ntypedef vector<VUI>   VVUI;\n\n#define fst first\n#define snd second\n// #define Y first\n// #define X second\n#define MP make_pair\n#define PB push_back\n#define EB emplace_back \n#define ALL(x)  (x).begin(),(x).end()\n#define RALL(x) (x).rbegin(),(x).rend()\n#define RANGEBOX(x,y,maxX,maxY) (0 <= (x) && 0 <= (y) && (x) < (maxX) && (y) < (maxY))\n#define RANGE(x, l, r) ((l) <= (x) && (x) <= (r))\n#define rep(i, N)  for (int i = 0; i < (int)(N); i++)\n#define rrep(i, N) for (int i = N - 1; i >= 0; i--)\n#define REP(i, init, N)  for (int i = (init); i < (int)(N); i++)\n#define RREP(i, N, last) for (int i = (init - 1); i >= last; i--)\n#define MAXUD(orig, target) orig = max(orig, target)\n#define MINUD(orig, target) orig = min(orig, target)\n#define DUMP( x ) cerr << #x << \" = \" << ( x ) << endl\n\ntemplate < typename T > inline T fromString(const string &s) { T res; ISS iss(s); iss >> res; return res; };\ntemplate < typename T > inline string toString(const T &a)   { OSS oss; oss << a; return oss.str(); };\n\ntemplate<typename T=int> inline void dump(vector<T> vs, bool ent=false) { rep(i, vs.size()) cout << vs[i] << (i+1==vs.size() ? '\\n' : ' '); if (ent) cout << endl; }\ntemplate<typename T = int> inline void dump(vector<vector<T>> vs, bool ent = false) { rep(i, vs.size()) dump<T>(vs[i]); if (ent) cout << endl; }\n\nconst int    INF  = 0x3f3f3f3f;\nconst LL     INFL = 0x3f3f3f3f3f3f3f3fLL;\nconst double DINF = 0x3f3f3f3f;\nconst int    DX[] = {1,  0, -1, 0};\nconst int    DY[] = {0, -1,  0, 1};\nconst double EPS  = 1e-12;\n// const double PI   = acos(-1.0);\n// lambda: [](T1 x)->T2{return y;}\n// simple lambda: [](T x){return x;}\n\nint N, M, Q;\nVS S, B;\n\nchar check(int target) {\n    VB bs0(M, false);\n    VB ks(N, true);\n\n    rep(q, Q) { // 1000\n        char before = q ? B[q-1][target] : '0';\n        char current = B[q][target];\n\n        rep(si, N) { // 36\n            if (before == current) {\n                ks[si] = ks[si] & (S[q][si] == '0');\n            } else {\n                ks[si] = ks[si] & (S[q][si] == '1');\n            }\n        }\n    }\n\n    if (count(ALL(ks), true) != 1) return '?';\n    int pos = find(ALL(ks), true) - ks.begin();\n    if (pos < 10) return '0' + pos;\n    return 'A' + pos - 10;\n}\n\nstring solve() {\n    S = VS(Q);\n    B = VS(Q);\n    rep(i, Q) cin >> S[i] >> B[i];\n\n    string ans;\n    rep(bi, M) { // 1000\n        ans += check(bi);\n    }\n\n    return ans;\n}\n\nint main(void) { // reading: 8.5m 25\n    while (cin >> N >> M >> Q, N) cout << solve() << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <fstream>\nusing namespace std;\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toStr(T x) { ostringstream sout; sout << x; return sout.str(); }\ntypedef vector<int> vi;\ntypedef vector<vi>  vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define FOR(i,a,b) for(int i=(a);i<=(b);++i)\n#define REP(i,n) FOR(i,0,(n)-1)\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\nconst int INF = INT_MAX / 10;\n\nchar conv(int n) {\n\tif (n < 0) {\n\t\treturn '?';\n\t}\n\telse if (n < 10) {\n\t\treturn '0' + n;\n\t}\n\telse {\n\t\treturn 'A' + n - 10;\n\t}\n}\n\nint main() {\n\tint N, M, Q;\n\twhile (cin >> N >> M >> Q, N) {\n\t\tvvi table(N, vi(M, 1));\n\n\t\tstring S, B;\n\t\tvector<bool> isOn(N, false);\n\t\tREP(i, Q) {\n\t\t\tcin >> S >> B;\n\t\t\tREP(j, N) {\n\t\t\t\tif (S[j] == '1') {\n\t\t\t\t\tisOn[j] = !isOn[j];\n\t\t\t\t}\n\t\t\t\tREP(k, M) {\n\t\t\t\t\tif (isOn[j] && (B[k] == '0')) {\n\t\t\t\t\t\ttable[j][k] = 0;\n\t\t\t\t\t}\n\t\t\t\t\telse if (!isOn[j] && (B[k] == '1')) {\n\t\t\t\t\t\ttable[j][k] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvi ans(M);\n\t\tREP(i, M) {\n\t\t\tint num = -1;\n\t\t\tREP(j, N) {\n\t\t\t\tif (table[j][i] == 1) {\n\t\t\t\t\tif (num == -1) {\n\t\t\t\t\t\tnum = j;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tnum = -1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tans[i] = num;\n\t\t}\n\n\t\tREP(i, M) {\n\t\t\tcout << conv(ans[i]);\n\t\t}\n\t\tcout << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cassert>\nusing namespace std;\ntypedef long long ll;\nint N,M,Q;\nll s[4000],t[4000];\n\nll func(string str){\n  ll res=0;\n  reverse(str.begin(),str.end());\n  for(int i=0;i<(int)str.size();i++){\n    res*=2LL;\n    if(str[i]-'0')res++;\n  }\n  return res;\n}\n\nint main(){\n  char change[36];\n  change[0]='0';\n  for(int i=1;i<10;i++)change[i]=change[i-1]+1;\n  change[10]='A';\n  for(int i=11;i<36;i++)change[i]=change[i-1]+1;\n\n  while(1){\n    cin>>N>>M>>Q;\n    if(N==0&&M==0&&Q==0)break;\n    for(int i=0;i<Q;i++){\n      string str,str2;\n      cin>>str>>str2;\n      s[i]=func(str);\n      t[i]=func(str2);\n      if(i){\n\ts[i]=s[i]^s[i-1];\n      }\n    }\n    for(int i=0;i<M;i++){\n      ll f=(1LL<<N)-1,F=f;\n      for(int j=0;j<Q;j++){\n\tif((t[j]>>i)&1){\n\t  f=f&s[j];\n\t}else {\n\t  f=f&(F-s[j]);\n\t}\n      }\n\n      if(__builtin_popcountll(f)==1){\n\tint ans=0;\n\twhile(f>1){\n\t  f/=2LL;\n\t  ans++;\n\t}\n\tassert(ans<36);\n\tcout<<change[ans];\n      }else{\n\tcout<<'?';\n      }\n    }\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define FOR(i,a,b) for (int i=(a);i<(b);i++)\n#define RFOR(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define REP(i,n) for (int i=0;i<(n);i++)\n#define RREP(i,n) for (int i=(n)-1;i>=0;i--)\n#define ALL(a) (a).begin(),(a).end()\n#define DEBUG(a) \"(\" << #a << \": \" << (a) << \")\"\n\ntemplate<typename T>\nvoid chmin(T &x, T y) { x = min(x, y); }\n\ntemplate<typename T>\nvoid chmax(T &x, T y) { x = max(x, y); }\n\ntypedef long long int lli;\ntypedef long double ld;\ntypedef tuple<int,int> P;\ntypedef bitset<36> switches;\ntypedef bitset<1000> bulbs;\n\nconst int INF = INT_MAX/2 - 1;\nconst double EPS = 1e-14;\nconst int dx[4] = {0, 1, 0, -1}; // {-1,  0,  1, -1, 1, -1, 0, 1};\nconst int dy[4] = {1, 0, -1, 0}; // {-1, -1, -1,  0, 0,  1, 1, 1};\n\nstring solve(int n, int m, const vector<tuple<switches,bulbs>> &crs) {\n  string ans(m, '?');\n  const string base36 = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n  REP (i, m) {\n    switches accs((1<<n) - 1);\n    for (auto cr : crs) {\n      switches ss; bulbs bs; tie(ss, bs) = cr;\n      accs &= bs[i] ? ss:~ss;\n    }\n    if (accs.count() != 1) { continue; }\n    REP (j, n) {\n      if (accs[j]) { ans[i] = base36[j]; }\n    }\n  }\n  return ans;\n}\n\nint main() {\n  cout << fixed << setprecision(10);\n  int N, M, Q;\n  while (cin >> N >> M >> Q and N) {\n    vector<tuple<switches,bulbs>> correspondence;\n    switches current(0);\n    REP (q, Q) {\n      string S, B;\n      cin >> S >> B;\n      switches ss(0);\n      REP (i, N) { ss[i] = S[i] == '1'; }\n      bulbs bs(0);\n      REP (i, M) { bs[i] = B[i] == '1'; }\n      current ^= ss;\n      correspondence.emplace_back(current, bs);\n    }\n    cout << solve(N, M, correspondence) << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "///\n// File:  2590.cpp\n// Author: ymiyamoto\n//\n// Created on Thu Dec 28 11:40:56 2017\n//\n\n#include <cstdint>\n#include <iostream>\n#include <string>\n#include <vector>\n\nusing namespace std;\n\nint32_t main()\n{\n  while (true) {\n    uint32_t N, M, Q;\n    cin >> N >> M >> Q;\n    if (N == 0 && M == 0 && Q == 0) break;\n\n    uint64_t sw = 0;\n    vector<vector<bool>> switches(M, vector<bool>(N, true));\n    for (uint32_t i = 0; i < Q; i++) {\n      string op, state;\n      cin >> op >> state;\n\n      for (uint32_t j = 0; j < op.size(); j++) {\n        if (op[j] == '1') {\n          sw ^= 1 << j;\n        }\n      }\n\n      for (uint32_t j = 0; j < state.size(); j++) {\n        for (uint32_t k = 0; k < op.size(); k++) {\n          if (state[j] == '1') {\n            if ((sw & (1 << k)) == 0) {\n              switches[j][k] = false;\n            }\n          } else {\n            if ((sw & 1 << k) != 0) {\n              switches[j][k] = false;\n            }\n          }\n        }\n      }\n    }\n\n    string nums = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n    string numbers;\n    for (uint32_t i = 0; i < M; i++) {\n      bool not_determine = false;\n      int32_t num = -1;\n      for (uint32_t j = 0; j < N; j++) {\n        if (switches[i][j]) {\n          if (num != -1) {\n            not_determine = true;\n          }\n          num = j;\n        }\n      }\n      if (not_determine) {\n        numbers += '?';\n      } else {\n        numbers += nums[num];\n      }\n    }\n    cout << numbers << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\nint main() {\n\tint n, m, q;\n\twhile (cin >> n >> m >> q, n) {\n\t\tif (q == 0) {\n\t\t\tif (n != 1) {\n\t\t\t\trep(i, m) {\n\t\t\t\t\tcout << \"?\";\n\t\t\t\t}\n\t\t\t\tcout << endl;\n\t\t\t}\n\t\t\telse {\n\t\t\t\trep(i, m) {\n\t\t\t\t\tcout << \"0\";\n\t\t\t\t}\n\t\t\t\tcout << endl;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tchar signal[1000][36];\n\t\tchar light[1000][1000];\n\t\trep(i, q) {\n\t\t\tstring s, t;\n\t\t\tcin >> s >> t;\n\t\t\trep(k, n) {\n\t\t\t\tsignal[i][k] = s[k];\n\t\t\t}\n\t\t\trep(k, m) {\n\t\t\t\tlight[i][k] = t[k];\n\t\t\t}\n\t\t}\n\t\trep(i, m) {\n\t\t\tint chk = -1; bool g = true;\n\t\t\trep(j, n) {\n\t\t\t\tbool f = true;\n\t\t\t\tint sum = 0;\n\t\t\t\trep(k, q) {\n\t\t\t\t\tsum += signal[k][j]-'0'; sum %= 2;\n\t\t\t\t\tif (sum != light[k][i]-'0') {\n\t\t\t\t\t\tf = false; break;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (f) {\n\t\t\t\t\tif (chk == -1)chk = j;\n\t\t\t\t\telse {\n\t\t\t\t\t\tbool g = false;\n\t\t\t\t\t\tcout << \"?\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!g)break;\n\t\t\t}\n\t\t\tif (g) {\n\t\t\t\tif (chk < 10) {\n\t\t\t\t\tcout << chk;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tcout << (char)('A' + chk - 10);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<cstring>\n#include<queue>\n\nusing namespace std;\n\n#define INF 999999999\n#define REP(i,n) for(int i=0; i<(int)(n); i++)\n\nint main(){\n\tint n, m, q;\n\tstring s;\n\tvector <string> b(2);\n\tbool ans[36][1000];\n\twhile(1){\n\t\tcin >> n >> m >> q;\n\t\tif(!n) break;\n\t\tb[1]= \"\";\n\t\tREP(i,m)b[1] = b[1] + \"0\";\n\t\tREP(i,n){\n\t\t\tREP(j,m){\n\t\t\t\tans[i][j]=1;\n\t\t\t}\n\t\t}\n\t\t//cout << b[1] <<endl;\n\t\tREP(i,q){\n\t\t\tcin >> s >> b[0];\n\t\t\tREP(j,n){\n\t\t\t\tif(s[j]=='1'){\n\t\t\t\t\tREP(k,m){\n\t\t\t\t\t\tif(b[0][k]==b[1][k]) ans[j][k]=0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(s[j]=='0'){\n\t\t\t\t\tREP(k,m){\n\t\t\t\t\t\tif(b[0][k]!=b[1][k]) ans[j][k]=0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t/*\n\t\t\tREP(j,n){\n\t\t\t\tREP(k,m) cout << ans[j][k];\n\t\t\t\tcout << endl;\n\t\t\t}\n\t\t\t*/\n\t\t\tb[1] = b[0];\n\t\t}\n\t\tREP(i,m){\n\t\t\tint flag=0;\n\t\t\tREP(j,n){\n\t\t\t\tif(ans[j][i]){\n\t\t\t\t\tif(!flag)flag = j+1;\n\t\t\t\t\telse{\n\t\t\t\t\t\tflag = -1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(flag>=1&&flag<=10) cout << flag-1;\n\t\t\telse if(flag==-1) cout << \"?\";\n\t\t\telse printf(\"%c\",'A'+flag-11);\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing ll = long long int;\nusing ull = unsigned long long int;\n\n\nint solve(){\n    int n, m, q;\n    cin >> n >> m >> q;\n    if(n==0) return 1;\n    vector<pair<ll, bitset<1000> > > vec(n, make_pair((1LL<<n)-1,bitset<1000>().set()));\n    for(ll i=0,px=0;i<q;i++){\n        string s, b;\n        cin >> s >> b;\n        ll x = 0;\n        bitset<1000> bit;\n        for(int j=0;j<n;j++){\n            x |= ll(s[j]-'0')<<j;\n        }\n        x ^= px;\n        for(int j=0;j<m;j++){\n            if(b[j]=='1') bit.set(j);\n        }\n        for(int j=0;j<n;j++){\n            if((x>>j)&1){\n                vec[j].first &= x;\n                vec[j].second &= bit;\n            }else{\n                vec[j].first &= ~x;\n                vec[j].second &= ~bit;\n            }\n        }\n        px = x;\n    }\n    vector<int> ans(m, -1);\n    for(auto e : vec){\n        ll x = e.first;\n        // cout << \"x=\" << x << endl;\n        int cnt = 0, idx = -1;\n        for(int i=0;i<n;i++){\n            if((x>>i)&1){\n                cnt++;\n                idx = i;\n            }\n        }\n        if(cnt != 1) continue;\n        auto bit = e.second;\n        for(int i=0;i<m;i++){\n            if(bit.test(i)) ans[i] = idx;\n        }\n    }\n    for(int i=0;i<m;i++){\n        if(ans[i]>=0){\n            if(ans[i]<=9){\n                cout << ans[i];\n            }else{\n                cout << char('A'+ans[i]-10);\n            }\n        }else{\n            cout << '?';\n        }\n    }\n    cout << endl;\n    return 0;\n}\n\n\nint main(){\n    while(solve()==0);\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cctype>\n#include <complex>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iomanip>\n#include <iostream>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 29;\n\nstring o = \"0123456789ABCD\";\nint main(void){\n    int n, m, q; \n\n    while(cin >> n >> m >> q, n){\n        vs _s(q), b(q), s(q);\n        rep(i, q){\n            cin >> _s[i] >> b[i];\n            s[i] = _s[i];\n        }\n        rep(i, q){\n            if(i == 0) continue;\n            rep(j, n){\n                if(_s[i][j] == '1'){\n                    s[i][j] = s[i - 1][j] == '1' ? '0':'1';\n                }\n                else s[i][j] = s[i - 1][j];\n            }\n        }\n\n        vector< vector<bool> > tbl = vector< vector<bool> >(m, vector<bool>(n, true));\n\n        rep(i, q){\n            rep(j, m){\n                rep(k, n){\n                    if((s[i][k] == '1' && b[i][j] == '0') || (s[i][k] == '0' && b[i][j] == '1'))\n                        tbl[j][k] = false;\n                }\n            }\n        }\n\n        rep(i, m){\n            char res;\n            int cnt = 0;\n            rep(j, n) if(tbl[i][j]) res = j < 10 ? '0' + j:'A' + j - 10, cnt++;\n\n            if(cnt == 1) cout << res;\n            else cout << '?';\n        }\n        cout << endl;\n    }\n\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cstdio>\nusing namespace std;\nint ck(int N,long long mask){\n\tint c=-1;\n\tlong long k=1;\n\tfor(int i=0;i<N;i++,k<<=1)\n\t\tif(mask&k){\n\t\t\tif(c>=0)c=-2;\n\t\t\tif(c==-1)c=i;\n\t\t}\n\treturn c;\n}\nint main(){\n\tfor(int N,M,Q;cin>>N>>M>>Q,N;){\n\t\tvector<long long>v0(M);\n\t\tvector<long long>v1(M);\n\t\tstring prev(M,'0');\n\t\t{\n\t\t\tlong long mask=0,k=1;\n\t\t\tfor(int i=0;i<N;i++,k<<=1)mask|=k;\n\t\t\tfor(int i=0;i<M;i++)v0[i]=v1[i]=mask;\n\t\t}\n\t\tfor(;Q--;){\n\t\t\tstring s,t;\n\t\t\tcin>>s>>t;\n\t\t\tlong long mask0=0,mask1=0,k=1;\n\t\t\tfor(int i=0;i<N;i++,k<<=1)(s[i]=='0'?mask0:mask1)|=k;\n\t\t\tfor(int i=0;i<M;i++)\n\t\t\t\tif(!(prev[i]^t[i]))\n\t\t\t\t\tv0[i]&=mask0;\n\t\t\t\telse\n\t\t\t\t\tv1[i]&=mask1;\n\t\t\tprev=t;\n\t\t}\n\t\tfor(int j=0;j<M;j++){\n\t\t\tint i=0,c[3]={ck(N,v0[j]),ck(N,v1[j]),ck(N,v1[j]&v0[j])};\n\t\t\tfor(;i<3;i++)if(c[i]>=0){putchar(c[i]<10?c[i]+'0':c[i]-10+'A');break;}\n\t\t\tif(i==3)putchar('?');\n\t\t}\n\t\tputs(\"\");\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cassert>\nusing namespace std;\ntypedef long long ll;\nint N,M,Q;\nll s[4000],t[4000];\n\nll func(string str){\n  ll res=0;\n  for(int i=0;i<(int)str.size();i++)\n    if(str[i]-'0')res+=(1LL<<i);\n  return res;\n}\n\nint main(){\n  char change[36];\n  change[0]='0';\n  for(int i=1;i<10;i++)change[i]=change[i-1]+1;\n  change[10]='A';\n  for(int i=11;i<36;i++)change[i]=change[i-1]+1;\n\n  while(1){\n    cin>>N>>M>>Q;\n    if(N==0&&M==0&&Q==0)break;\n    for(int i=0;i<Q;i++){\n      string str,str2;\n      cin>>str>>str2;\n      s[i]=func(str);\n      t[i]=func(str2);\n      if(i)s[i]=s[i]^s[i-1];\n    }\n\n    for(int i=0;i<M;i++){\n      ll f=(1LL<<N)-1;\n      for(int j=0;j<Q;j++){\n\tif((t[j]>>i)&1){\n\t  f=f&s[j];\n\t}else {\n\t  f=f&(~s[j]);\n\t}\n      }\n      assert(__builtin_popcountll(f)!=0);\n      if(__builtin_popcountll(f)==1){\n\tint ans=0;\n\tfor(ans=0;ans<36&&(1LL<<ans)!=f;ans++);\n\tcout<<change[ans];\n      }else{\n\tcout<<'?';\n      }\n    }\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\ntypedef long long ll;\nint N,M,Q;\nll s[4000],t[4000];\n\nll func(string str){\n  ll res=0;\n  reverse(str.begin(),str.end());\n  for(int i=0;i<(int)str.size();i++){\n    res*=2LL;\n    res+=(str[i]-'0');\n  }\n  return res;\n}\n\nint main(){\n  char change[36];\n  change[0]='0';\n  for(int i=1;i<10;i++)change[i]=change[i-1]+1;\n  change[10]='A';\n  for(int i=11;i<36;i++)change[i]=change[i-1]+1;\n\n  while(1){\n    cin>>N>>M>>Q;\n    if(N==0&&M==0&&Q==0)break;\n    for(int i=0;i<Q;i++){\n      string str,str2;\n      cin>>str>>str2;\n      s[i]=func(str);\n      t[i]=func(str2);\n      if(i){\n\ts[i]=s[i]^s[i-1];\n      }\n    }\n    for(int i=0;i<M;i++){\n      ll f=(1LL<<N)-1,F=f;\n      for(int j=0;j<Q;j++){\n\tif((t[j]>>i)&1){\n\t  f=f&s[j];\n\t}else {\n\t  f=f&(F-s[j]);\n\t}\n      }\n\n      if(__builtin_popcountll(f)==1){\n\tint ans=0;\n\twhile(f>1){\n\t  f/=2;\n\t  ans++;\n\t}\n\tcout<<change[ans];\n      }else{\n\tcout<<'?';\n      }\n    }\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\ntypedef long long ll;\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(long long i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nusing namespace std;\n\nll N,M,Q;\nll ans[1003];\nvoid plot() {\n    rep(i,M) {\n        ll count=0;\n        ll val=0;\n        rep(j,N) {\n            if(((ans[i])>>j)&1LL) {\n                count++;\n                val=j;\n            }\n        }\n        if(count==1) {\n            if(val<10) printf(\"%d\",val);\n            else printf(\"%c\",'A'+val-10);\n        }\n        else cout<<\"?\";\n    }\n    cout<<endl;\n}\n\nvoid update(ll& mask, string S, string B) {\n    ll bit=0LL;\n    rep(i,N) if(S[i]=='1') bit|=(1LL<<i);\n    mask^=bit;\n    // printf(\"%s : %X\\n\", S.c_str(),bit);\n    rep(i,M) {\n        if(B[i] == '1') {\n            ans[i] &= mask;\n        }\n        else {\n            ans[i] &= ~mask;\n        }\n    }\n}\n\n\nvoid solve() {\n    \n    rep(i,1003) ans[i]=(1LL<<N)-1LL;\n    ll mask=0LL;\n    string S,B;\n    rep(i,Q) {\n        cin>>S>>B;\n        update(mask, S,B);\n\n        // rep(i,M) cout<<ans[i]<<\",\";\n        // cout<<endl;\n    }\n    plot();\n}\n\nint main() {\n    while(cin>>N>>M>>Q) {\n        if(N+M+Q==0) break;\n        solve();\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n    int N, M, Q;\n    while (cin >> N >> M >> Q, N || M || Q) {\n\n        vector<string> S(2*Q+1), B(2*Q+1);\n        vector<vector<int>> D(2*Q+1, vector<int>(M));\n\n        string str;\n\n        for (int i = 0; i < M; i++) {\n            B[0] += '0';\n            str += '1';\n        }\n\n        for (int i = 1; i <= Q; i++) {\n            cin >> S[i-1] >> B[i];\n\n            for (int j = 0; j < N; j++) {\n                S[i+Q-1] += (S[i-1][j] == '0' ? '1' : '0');\n            }\n\n            for (int j = 0; j < M; j++) {\n                if (B[i-1][j] != B[i][j]) {\n                    D[i-1][j] = 1;\n                } else {\n                    D[i+Q-1][j] = 1;\n                }\n            }\n        }\n\n        vector<set<int>> ans(M);\n        if (Q == 0) {\n            if (N == 1) {\n                for (auto &i : ans) i.insert(0);\n            }\n        } else {\n            for (int i = 0; i < N; i++) {\n                auto tmp = str;\n\n                for (int j = 0; j < 2*Q; j++) {\n                    if (S[j][i] == '0') continue;\n                    for (int k = 0; k < M; k++) {\n                        if (D[j][k] == 0) tmp[k] = '0';\n                    }\n                }\n\n                for (int j = 0; j < M; j++) {\n                    if (tmp[j] == '1') ans[j].insert(i);\n                }\n            }\n        }\n\n        for (int i = 0; i < M; i++) {\n            if (ans[i].size() != 1) cout << '?';\n            else if (*(ans[i].begin()) < 10) cout << *(ans[i].begin());\n            else cout << (char)('A' + *(ans[i].begin()) - 10);\n        }\n        cout << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\nusing namespace std;\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n\nint main(){\n\n  while(true){\n    int n, m, q; cin>> n>> m>> q;\n    if(n==0 && m==0 && q==0) break;\n\n    bool a[m][n];\n    rep(i, m)rep(j, n) a[i][j]=true;\n    string ps=string(n, '0'),\n           pb=string(m, '0');\n    rep(_, q){\n      string s, b; cin>> s>> b;\n      vector<int> changed_switches, unchanged_switches;\n      rep(i, n){\n        if(s[i]=='1') changed_switches.push_back(i);\n        else unchanged_switches.push_back(i);\n      }\n      vector<int> changed_bulbs, unchanged_bulbs;\n      rep(i, m){\n        if(pb[i]!=b[i]) changed_bulbs.push_back(i);\n        else unchanged_bulbs.push_back(i);\n      }\n      for(int i: changed_bulbs){\n        for(int j: unchanged_switches){\n          a[i][j]=false;\n        }\n      }\n      for(int i: unchanged_bulbs){\n        for(int j: changed_switches){\n          a[i][j]=false;\n        }\n      }\n      ps=s; pb=b;\n    }\n\n    rep(i, m){\n      int k=-1, cnt=0;\n      rep(j, n){\n        if(a[i][j]){\n          cnt++;\n          k=j;\n        }\n      }\n      if(cnt>1){\n        cout<< \"?\";\n      }else{\n        if(0<=k && k<10) cout<< k;\n        else cout<< (char)('A'+(k-10));\n      }\n    }cout<< endl;\n  }\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i,n) for(int i=0; i<(int)(n); ++i)\n\nusing namespace std;\n\nconst int C = 36;\n\nint main(){\n    int N, M, Q;\n    while(cin >> N >> M >> Q && N > 0) {\n        bitset<C> sw;\n        vector<bitset<C>> state(M);\n        REP(i, M) REP(j, N) state[i][j] = true; // all true\n        REP(_, Q) {\n            bitset<C> ope;\n            string s;\n            cin >> s;\n            REP(i, N) ope[i] = (s[i] == '1');\n            sw ^= ope;\n\n            string t;\n            cin >> t;\n            REP(i, M) {\n                if(t[i] == '1') {\n                    state[i] &= sw;\n                } else {\n                    state[i] &= ~sw;\n                }\n            }\n        }\n\n        REP(i, M) {\n            if(state[i].count() == 1) {\n                REP(j, N) if(state[i][j]) {\n                    cout << (char)(j < 10 ? '0' + j : 'A' + (j - 10));\n                }\n            } else {\n                cout << '?';\n            }\n        }\n        cout << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint N,M,Q;\nlong long ans[1003];\nvoid plot() {\n    rep(i,M) {\n        int count=0;\n        int val=0;\n        rep(j,N) {\n            if(((ans[i])>>j)&1) {\n                count++;\n                val=j;\n            }\n        }\n        if(count==1) {\n            if(val<10) printf(\"%d\",val);\n            else printf(\"%c\",'A'+val-10);\n        }\n        else cout<<\"?\";\n    }\n    cout<<endl;\n}\n\nvoid update(long long& mask, string S, string B) {\n    long long bit=0;\n    rep(i,N) if(S[i]=='1') bit|=1L<<i;\n    mask^=bit;\n    // printf(\"%s->%s : %lx\\n\", stateS.c_str(),S.c_str(),bit);\n    rep(i,M) {\n        if(B[i] == '1') {\n            ans[i] &= mask;\n        }\n        else {\n            ans[i] &= ~mask;\n        }\n    }\n}\n\n\nvoid solve() {\n    \n    rep(i,1003) ans[i]=(1<<N)-1;\n    long long mask=0;\n    string S,B;\n    rep(i,Q) {\n        cin>>S>>B;\n        update(mask, S,B);\n\n        // rep(i,M) cout<<ans[i]<<\",\";\n        // cout<<endl;\n    }\n    plot();\n}\n\nint main() {\n    while(cin>>N>>M>>Q) {\n        if(N+M+Q==0) break;\n        solve();\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\nint main(){\n  int n,m,q;\n  cin >> n >> m >> q;\n  int i,j,k;\n  string s,b;\n  while((n+m+q)!=0){\n    int table[1001][40]={{}};\n    int onoff[40]={};\n    \n    for(i=0;i<q;i++){\n      cin >> s >> b;\n      for(j=0;j<n;j++){\n\tif(s[j]=='1') {\n\t  if(onoff[j]==0) onoff[j]=1;\n\t  else onoff[j]=0;\n\t}\n      }\n      int c=0,x;\n      for(j=0;j<n;j++){\n\tc+=onoff[j];\n\tif(onoff[j]==1) x=j;\n      }\n      if(c==1){\n\tfor(j=0;j<m;j++){\n\t  if(b[j]=='1'){\n\t    for(k=0;k<n;k++){\n\t      if(k!=x) table[j][k]=1;\n\t    }\n\t  }\n\t}\n      }\n      for(j=0;j<m;j++){\n\tif(b[j]=='0'){\n\t  for(k=0;k<n;k++){\n\t    if(table[j][k]==0){\n\t      if(onoff[k]==1)\n\t\ttable[j][k]=1;\n\t    }\n\t  }\n\t}\n      }\n      \n      int ch[1001]={},id[40]={};\n      for(j=0;j<m;j++){\n\tfor(k=0;k<n;k++){\n\t  if(table[j][k]==1) ch[j]++;\n\t  if(table[j][k]==0) id[j]=k;\n\t}\n      }\n      for(j=0;j<m;j++){\n\tif(ch[j]+1==n){\n\t  //cout <<\"a\"<< endl;\n\t  for(k=0;k<m;k++){\n\t    if(ch[k]+1!=n){\n\t      table[k][id[j]]=1;\n\t    }\n\t  }\n\t}\n      }\n      \n      \n    }\n\n    for(j=0;j<m;j++){\n\tint c=0,id;\n\tfor(k=0;k<n;k++){\n\t  if(table[j][k]==1) c++;\n\t  if(table[j][k]==0) id=k;\n\t}\n\tchar buf;\n\tif(c+1==n){\n\t  if(id<10) buf=id+'0';\n\t  else buf='A'+id-10;\n\t}else{\n\t  buf='?';\n\t}\n\tcout << buf;\n      }\n    cout << endl;\n    cin >> n >> m >> q;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string.h>\n\nusing namespace std;\n\nint main()\n{\n\tint n, m, q;\n\twhile (cin >> n >> m >> q && n != 0 || m != 0 || q != 0)\n\t{\n\t\tvector<string> S, B;\n\t\tfor (int i = 0; i < q; i++)\n\t\t{\n\t\t\tchar chars[40];\n\t\t\tchar charb[1100];\n\t\t\tcin >> chars >> charb;\n\t\t\tS.push_back(chars);\n\t\t\tB.push_back(charb);\n\t\t}\n\n\t\tint SL[1100];\n\t\tmemset(SL, -1, sizeof SL);\n\t\tfor (int i = 0; i < m; i++)//light\n\t\t{\n\t\t\tfor (int j = 0; j < n; j++)//switch\n\t\t\t{\n\t\t\t\tbool status = false;\n\t\t\t\tbool flag = true;\n\t\t\t\tfor (int k = 0; k < q; k++)//query\n\t\t\t\t{\n\t\t\t\t\tif (S[k][j] == '1')\n\t\t\t\t\t{\n\t\t\t\t\t\tstatus = !status;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (status && B[k][i] == '1' || !status && B[k][i] == '0')continue;\n\t\t\t\t\tflag = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (flag)\n\t\t\t\t{\n\t\t\t\t\tif (SL[i] == -1)SL[i] = j;\n\t\t\t\t\telse SL[i] = -2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (int i = 0; i < m; i++)\n\t\t{\n\t\t\tif (SL[i] < 0)\n\t\t\t{\n\t\t\t\tcout << \"?\";\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (SL[i] < 10)\n\t\t\t\t{\n\t\t\t\t\tcout << SL[i];\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tcout << (char)((SL[i] - 10) + 'A');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\nint main() {\n\tint n, m, q;\n\twhile (cin >> n >> m >> q, n) {\n\t\tif (q == 0) {\n\t\t\tif (n != 1) {\n\t\t\t\trep(i, m) {\n\t\t\t\t\tcout << \"?\";\n\t\t\t\t}\n\t\t\t\tcout << endl;\n\t\t\t}\n\t\t\telse {\n\t\t\t\trep(i, m) {\n\t\t\t\t\tcout << \"0\";\n\t\t\t\t}\n\t\t\t\tcout << endl;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tchar signal[1000][36];\n\t\tchar light[1000][1000];\n\t\trep(i, q) {\n\t\t\tstring s, t;\n\t\t\tcin >> s >> t;\n\t\t\trep(k, n) {\n\t\t\t\tsignal[i][k] = s[k];\n\t\t\t}\n\t\t\trep(k, m) {\n\t\t\t\tlight[i][k] = t[k];\n\t\t\t}\n\t\t}\n\t\trep(i, m) {\n\t\t\tint chk = -1; bool g = true;\n\t\t\trep(j, n) {\n\t\t\t\tbool f = true;\n\t\t\t\tint sum = 0;\n\t\t\t\trep(k, q) {\n\t\t\t\t\tsum += signal[k][j]-'0'; sum %= 2;\n\t\t\t\t\tif (sum != light[k][i]-'0') {\n\t\t\t\t\t\tf = false; break;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (f) {\n\t\t\t\t\tif (chk == -1)chk = j;\n\t\t\t\t\telse {\n\t\t\t\t\t\tbool g = false;\n\t\t\t\t\t\tcout << \"?\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!g)break;\n\t\t\t}\n\t\t\tif (g) {\n\t\t\t\tif (chk == -1) {\n\t\t\t\t\tcout << \"?\";\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (chk < 10) {\n\t\t\t\t\t\tcout << chk;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tcout << (char)('A' + chk - 10);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 29;\n\nint n,m,q;\nll b[1010];\n\ninline void output(int arg){\n\tif(__builtin_popcountll(b[arg])!=1)\n\t\tcout << '?';\n\telse{\n\t\tint bit;\n\t\tfor(bit=0;bit<n;bit++)\n\t\t\tif(b[arg]&(1LL<<bit))\n\t\t\t\tbreak;\n\t\tif(bit>=10)\n\t\t\tcout << (char)(bit-10+'A');\n\t\telse\n\t\t\tcout << bit;\n\t}\n}\n\nint main(void){\n\twhile(cin >> n >> m >> q){\n\t\tif(n==0)\n\t\t\tbreak;\n\t\tll sw=0LL;\n\t\trep(i,m) b[i]=((1LL<<n)-1LL);\n\t\trep(i,q){\n\t\t\tll nsw=0;\n\t\t\tstring tmp;\n\t\t\tcin >> tmp;\n\t\t\trep(j,n){\n\t\t\t\tif(tmp[j]=='1')\n\t\t\t\t\tnsw|=(1LL<<j);\n\t\t\t}\n\t\t\tsw^=nsw;\n\t\t\tcin >> tmp;\n\t\t\trep(j,m){\n\t\t\t\tif(tmp[j]=='1')\n\t\t\t\t\tb[j]&=sw;\n\t\t\t\telse\n\t\t\t\t\tb[j]&=(~sw);\n\t\t\t}\n\t\t}\n\t\trep(i,m) output(i);\n\t\tcout << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<ll> VL;\ntypedef vector<VL> VVL;\ntypedef pair<int, int> PII;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define MP make_pair\n#define PB push_back\n#define MOD 1000000007\n#define INF (1LL<<30)\n#define LLINF (1LL<<60)\n#define PI 3.14159265359\n#define EPS 1e-12\n//#define int ll\n\n//string s[1010], b[1010];\nbool a[40];\nll c[40], cc[40], d[1010];\n//???????´??????? x???e???\nll binpow(ll x, ll e)\n{\n  ll a = 1, p = x;\n\n  while(e > 0) {\n    if(e%2 == 0) {p = (p*p); e /= 2;}\n    else {a = (a*p); e--;}\n  }\n\n  return a;\n}\n\nsigned main(void)\n{\n\twhile(true) {\n\t\tint n, m, q;\n\t\tcin >> n >> m >> q;\n\t\tif(!n && !m && !q) break;\n\t\t//REP(i, q) cin >> s[i] >> b[i];\n\n\t\tREP(i, n) {\n\t\t\ta[i] = false;\n\t\t\tc[i] = cc[i] = 0;\n\t\t}\n\t\tREP(i, m) d[i] = binpow(2, n)-1;\n\t\t//cout << \"a\" << endl;\n\t\tll k = 0;\n\t\tREP(i, q) {\n\t\t\tstring s, b;\n\t\t\tcin >> s >> b;\n\t\t\tll t = 0;\n\t\t\tREP(j, n) {\n\t\t\t\tt = ((t << 1) | (s[j] - '0'));\n\t\t\t}\n\t\t\tk ^= t;\n\t\t\t//cout << \"i:\" << i << endl;\n\t\t\tREP(j, m) {\n\t\t\t\t//cout << \"j:\" << j << \" \" << d[j] << \" \" << b[j]<< endl;\n\t\t\t\tif(b[j] == '1') d[j] &= k;\n\t\t\t\telse d[j] &= ~k;\n\t\t\t}\n\n\t\t}\n\t\tREP(i, m) {\n\t\t\tint cnt = 0;\n\t\t\tVI e;\n\t\t\tREP(j, n) {\n\t\t\t\tif(d[i]>>j&1) {\n\t\t\t\t\tcnt++;\n\t\t\t\t\te.PB(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(cnt == 1) {\n\t\t\t\te[0] = n-1-e[0];\n\t\t\t\t//cout << \"e\" << e[0] << endl;\n\t\t\t\tif(e[0] < 10)\tcout << e[0];\n\t\t\t\telse cout << (char)(e[0]-10 + 'A');\n\t\t\t} else {\n\t\t\t\tcout << \"?\";\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<n;i++)\nusing namespace std;\n\nint n,m,q,c,t;\nbool x[1000][36];\nchar o;\nstring a,b[1000];\n\nmain(){\n\twhile(cin>>n>>m>>q,n||m||q){\n\t\trep(i,m)rep(j,n)x[i][j]=1;\n\t\trep(i,q){\n\t\t\tcin>>a>>b[i];\n\t\t\trep(j,a.size()) rep(k,b[i].size()){\n\t\t\t\tif(a[j]=='0'&&((i==0&&b[i][k]=='1')||(i!=0&&b[i][k]!=b[i-1][k])))x[k][j]=0;\n\t\t\t\tif(a[j]=='1'&&((i==0&&b[i][k]=='0')||(i!=0&&b[i][k]==b[i-1][k])))x[k][j]=0;\n\t\t\t}\n\t\t}\n\t\trep(i,m){\n\t\t\tc=0;\n\t\t\trep(j,n)if(x[i][j])c++,t=j;\n\t\t\tif(c>=2)o='?';\n\t\t\telse o=(t<=9?'0':'A'-10)+t;\n\t\t\tcout<<o;\n\t\t}\n\t\tcout<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <algorithm>\n#include <iostream>\nusing namespace std;\nusing ll = long long int;\n\nint solve_testcase() {\n    int N, M, Q; cin >> N >> M >> Q;\n    if(N == 0 and M == 0 and Q == 0) return 1;\n\n    ll fullbit = (1LL << N) - 1;\n    vector<ll> bits(M, fullbit);\n\n    string pre(M, '0');\n    for(int i=0; i<Q; i++) {\n        string S, B; cin >> S >> B;\n        ll bit = 0;\n        for(int i=0; i<N; i++) {\n            if(S[i] == '1') bit |= (1LL << i);\n        }\n\n        for(int i=0; i<M; i++) {\n            if(pre[i] != B[i]) {\n                bits[i] &= bit;\n            }\n            else bits[i] &= (fullbit - bit);\n        }\n        pre = B;\n    }\n\n    \n    for(int i=0; i<M; i++) {\n        int c = __builtin_popcountll(bits[i]);\n        if(c != 1) cout << \"?\";\n        else {\n            int x = 0;\n            for(x=0; x<N; x++) if(bits[i] >> x & 1) break;\n            if(x < 10) cout << x;\n            else cout << (char)('A' + (x - 10));\n        }\n    }\n    cout << endl;\n\n    return 0;\n}\n\nint main() {\n    while(!solve_testcase());\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\ntypedef long long LL;\n#define SORT(c) sort((c).begin(),(c).end())\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\nusing namespace std;\nint main(void)\n{\n  for(;;){\n    int n,m,q;\n    cin >> n >> m >> q;\n    if(!n&&!m&&!q) return 0;\n    string preb=\"\";\n    REP(i,m) preb.push_back('0');\n    int prob[1024][64];\n    REP(i,m) REP(j,n) prob[i][j]=1;\n    REP(i,q){\n      string s,b;\n      cin >> s >> b;\n      REP(j,m){\n\tif(preb[j]!=b[j]){\n\t  REP(k,n) if(s[k]=='0') prob[j][k]=0;\n\t}else{\n\t  REP(k,n) if(s[k]=='1') prob[j][k]=0;\n\t}\n      }\n      preb=b;\n    }\n    REP(i,m){\n      int p=0,ans=0;\n      REP(j,n){\n\tif(prob[i][j]){\n\t  ++p;\n\t  ans=j;\n\t}\n      }\n      if(p!=1) cout << '?';\n      else{\n\tif(ans>9) cout << (char)('A'+ans-10);\n\telse cout << (char)('0'+ans);\n      }\n    }\n    cout << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <cmath>\n#include <math.h>\nusing namespace std;\nint main(){\n\tstring a(\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\");\n\tint n,m,q;\n\twhile(cin>>n>>m>>q){\n\t\tif(n==0&&m==0&&q==0) break;\n\t\telse if(q==0){\n\t\t\tif(n==1&&m==1) cout<<0<<endl;\n\t\t\telse{\n\t\t\t\tfor(int i=0;i<m;i++){\n\t\t\t\t\tcout<<\"?\";\n\t\t\t\t}\n\t\t\t\tcout<<endl;\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tstring s[q],b[q];\n\t\t\tint ss[q][n],bb[q][m];\n\t\t\tcin>>s[0]>>b[0];\n\t\t\tfor(int j=0;j<n;j++){\n\t\t\t\tif(s[0][j]=='0'){\n\t\t\t\t\tss[0][j]=0;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tss[0][j]=1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int j=0;j<m;j++){\n\t\t\t\tif(b[0][j]=='0'){\n\t\t\t\t\tbb[0][j]=0;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tbb[0][j]=1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=1;i<q;i++){\n\t\t\t\tcin>>s[i]>>b[i];\n\t\t\t\tfor(int j=0;j<n;j++){\n\t\t\t\t\tif(s[i][j]=='0'){\n\t\t\t\t\t\tss[i][j]=ss[i-1][j];\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tss[i][j]=(ss[i-1][j]+1)%2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j=0;j<m;j++){\n\t\t\t\t\tif(b[i][j]=='0'){\n\t\t\t\t\t\tbb[i][j]=0;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tbb[i][j]=1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tint hyou[m][n];\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tfor(int j=0;j<m;j++){\n\t\t\t\t\thyou[j][i]=0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=0;i<q;i++){\n\t\t\t\tfor(int j=0;j<m;j++){\n\t\t\t\t\tif(bb[i][j]==1){\n\t\t\t\t\t\tfor(int k=0;k<n;k++){\n\t\t\t\t\t\t\tif(ss[i][k]==0){\n\t\t\t\t\t\t\t\thyou[j][k]=-1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if(hyou[j][k]==0){\n\t\t\t\t\t\t\t\thyou[j][k]=1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tfor(int k=0;k<n;k++){\n\t\t\t\t\t\t\tif(ss[i][k]==1){\n\t\t\t\t\t\t\t\thyou[j][k]=-1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if(hyou[j][k]==0){\n\t\t\t\t\t\t\t\thyou[j][k]=1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=0;i<m;i++){\n\t\t\t\tint ct=0,out;\n\t\t\t\tfor(int j=0;j<n;j++){\n\t\t\t\t\tif(hyou[i][j]>=0){\n\t\t\t\t\t\tct++;\n\t\t\t\t\t\tif(hyou[i][j]==1) out=j;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(ct==1) cout<<a[out];\n\t\t\t\telse cout<<\"?\";\n\t\t\t}\n\t\t\tcout<<endl;\n\t\t}\n\t}\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<cstdio>\n#include<map>\n#include<algorithm>\n#include<string>\n#include<math.h>\n\nusing namespace std;\n\nint main(){\n\tint N,M,Q;\n\tstring S,B;\n\tstring C;\n\tint offF =0,onF=0;\n\tint *offi,*oni;\n\tstring sigma =\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\n\n\twhile(1){\n\t\tcin >> N >> M >> Q;\n\t\tif(N==0 && M==0 and Q==0)break;\n\t\tC=\"\";\n\t\toffi = new int[M];\n\t\toni = new int[M];\n\t\tfor(int i=0;i<M;i++){\n\t\t\tC+=\"?\";\n\t\t\toffi[i]=-1;\n\t\t\toni[i]=-1;\n\t\t}\n\t\t//0会の時\n\t\tif(Q==0){\n\t\t\tif(M==1){\n\t\t\t\tcout << 0 <<endl;\n\t\t\t\tbreak;\n\t\t\t}else{\n\t\t\t\tcout << C << endl;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\toffF =0,onF=0;\n\t\tcin>>S>>B;\n\t\t//最初の一回\n\t\tchar off,on;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(S[i]=='0') {\n\t\t\t\toffF++;\n\t\t\t\tif(offF==1) off=sigma[i];\n\t\t\t}if(S[i]=='1'){\n\t\t\t\tonF++;\n\t\t\t\tif(onF==1) on=sigma[i];\n\t\t\t}  \n\t\t}\n\t\tif(offF==1){\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='0'){\n\t\t\t\t\tC[i]=off;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tif(onF==1){\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='1'){\n\t\t\t\t\tC[i]=on;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\t//2~n-1まで\n\t\tstring prevB = \"\";\n\t\tfor(int k=0;k<M;k++){ prevB += B[k];}\n\t\tstring B2 = \"\";\n\t\tfor(int q=1;q<Q;q++){\n\t\t\toffF =0,onF=0;\n\t\t\tB2 = \"\";\n\t\t\tcin>>S>>B;\n\t\t\t//cout<< S <<endl;\n\t\t\t//cout<< \"B:\" <<B <<endl;\n\t\t\t//cout<< \"prevB:\" << prevB <<endl;\n\t\t\t//cout<< \"C:\" << C <<endl;\n\n\t\t\tfor(int j=0;j<M;j++){\n\t\t\t\tB2 += sigma[abs(prevB[j] - B[j])];\n\t\t\t}\n\t\t\t//cout << \"B2:\" << B2 << endl;\n\t\t\tchar off,on;\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='0' && C[i]=='?') {\n\t\t\t\t\toffF++;\n\t\t\t\t\tif(offF==1) off=sigma[i];\n\t\t\t\t}\n\t\t\t\tif(S[i]=='1' && C[i]=='?'){\n\t\t\t\t\tonF++;\n\t\t\t\t\tif(onF==1) on=sigma[i];\n\t\t\t\t}  \n\t\t\t}\n\t\t\t//cout << \"flag : \" << offF << onF << endl;\n\n\t\t\tif(offF==1){\n\t\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\t\tif(S[i]=='0'){\n\t\t\t\t\t\tfor(int j=0; j<M; j++){\n\t\t\t\t\t\t\tif(B2[j] == '0' && C[j]=='?'){ \n\t\t\t\t\t\t\t\tC[j] = off;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t}\n\t\t\tif(onF==1){\n\t\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\t\tif(S[i]=='1'){\n\t\t\t\t\t\tfor(int j=0; j<M; j++){\n\t\t\t\t\t\t\tif(B2[j] == '1' && C[j]=='?'){ \n\t\t\t\t\t\t\t\tC[j] = on;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\t\n\t\t\t}\n\t\t\tprevB = B;\n\n\t\t}\n\t\t\n\t\tint *check = new int[N];\n\t\tint a,flg=0;\n\t\tfor(int i=0;i<M;i++) check[i] = 0;\n\n\t\tfor(int i=0; i<M; i++){\n\t\t\tcheck[(int)(C[i]-'0')] = 1;\n\t\t}\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(check[i]==0){\n\t\t\t\ta = i;\n\t\t\t\tflg++;\n\t\t\t}\n\t\t}\n\t\tif(flg==1){\n\t\t\tfor(int i=0; i<M; i++){\n\t\t\t\tif(C[i]=='?') C[i] = sigma[a];\n\t\t\t}\n\t\t}\n\n\t\tcout << C << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  while(1){\n  char c,ans[1001];\n  int n,m,q,cnt=0,f[37][1001],s[37]={},b[37]={};\n  cin>>n>>m>>q;\n  if(n+m+q==0) break;\n     for(int i=0;i<n;i++)\n       for(int j=0;j<n;j++)f[i][j]=1;\n   \n  while(cnt<q){\n    cnt++;\n    for(int i=0;i<n;i++)cin>>c,s[i]=(s[i]+(c-'0'))%2;\n    for(int i=0;i<m;i++)cin>>c,b[i]=c-'0';\n    \n    for(int i=0;i<n;i++)\n      for(int j=0;j<m;j++){\n\tif(f[i][j]==2) continue;\n\telse if(s[i]==b[j])f[i][j]=1;\n\telse f[i][j]=2;\n      }\n    }\n  \n  for(int j=0;j<m;j++){\n    int flag=0;\n    for(int i=0;i<n;i++){\n      if(f[i][j]==1 && flag==0){\n\tflag=1;\n\tif(i>=0 && i<=9)ans[j]=i+'0';\n\telse ans[j]=i-10+'A';\n      }else if(flag==1 && f[i][j]==1)ans[j]='?';\n    }\n   }\n  \n  for(int i=0;i<m;i++)cout<<ans[i];\n  cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n    int N, M, Q;\n    while (cin >> N >> M >> Q, N || M || Q) {\n\n        vector<string> S(2*Q+1), B(2*Q+1);\n        vector<vector<int>> D(2*Q+1, vector<int>(M));\n\n        string str;\n\n        for (int i = 0; i < M; i++) {\n            B[0] += '0';\n            str += '1';\n        }\n\n        for (int i = 1; i <= Q; i++) {\n            cin >> S[i-1] >> B[i];\n\n            for (int j = 0; j < N; j++) {\n                S[i+Q-1] += (S[i-1][j] == '0' ? '1' : '0');\n            }\n\n            for (int j = 0; j < M; j++) {\n                if (B[i-1][j] != B[i][j]) {\n                    D[i-1][j] = 1;\n                } else {\n                    D[i+Q-1][j] = 1;\n                }\n            }\n        }\n        vector<int> ans(M, -1);\n        if (Q == 0) {\n            if (N == 1) {\n                for (auto &i : ans) i = 0;\n            }\n        } else {\n            for (int i = 0; i < N; i++) {\n                auto tmp = str;\n\n                for (int j = 0; j < 2*Q; j++) {\n                    if (S[j][i] == '0') continue;\n                    for (int k = 0; k < M; k++) {\n                        if (D[j][k] == 0) tmp[k] = '0';\n                    }\n                }\n                for (int j = 0; j < M; j++) {\n                    if (tmp[j] == '1') ans[j] = i;\n                }\n            }\n        }\n\n        for (int i = 0; i < M; i++) {\n            if (ans[i] < 0) cout << '?';\n            else if (ans[i] < 10) cout << ans[i];\n            else cout << 'A';\n        }\n        cout << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cmath>\n#include <string>\n#include <iostream>\n#define to36(x) (x < 10 ? (char)(x + 48) : (char)(x + 55))\n#ifdef _MSC_VER\n#define __builtin_popcount(x) (__popcnt(x))\n#define __builtin_popcountll(x) (__popcnt(x) + __popcnt(x >> 32))\n#endif\nusing namespace std;\nint N, M, Q; long long a[1009], b[1009]; string s[1009], t;\nint main() {\n\twhile (cin >> N >> M >> Q, N) {\n\t\tfill(a, a + Q, 0);\n\t\tfill(b, b + M, (1LL << N) - 1);\n\t\ts[0] = string(M, '0');\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tcin >> t >> s[i + 1];\n\t\t\tfor (int j = N - 1; j >= 0; j--) a[i] = a[i] * 2 + t[j] - 48;\n\t\t}\n\t\tfor (int i = 0; i < Q; i++) {\n\t\t\tfor (int j = 0; j < M; j++) b[j] &= (s[i][j] == s[i + 1][j]) ? ~a[i] : a[i];\n\t\t}\n\t\tfor (int i = 0; i < M; i++) {\n\t\t\tif (__builtin_popcountll(b[i]) == 1) cout << to36((int)(log2(b[i])));\n\t\t\telse cout << '?';\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <algorithm>\n\nusing namespace std;\n\nint main(){\n\t\n\tint N, M, Q;\n\t\n\twhile(true){\n\t\t\n\t\tcin >> N >> M >> Q;\n\t\t\n\t\tif(N == 0){\n\t\t\tbreak;\n\t\t}\n\t\t\n\t\tlong long int BIT[2000];\n\t\tlong long int init = 0;\n\t\tfor(int i = 0; i < N; i++){\n\t\t\tinit *= 2;\n\t\t\tinit += 1;\n\t\t}\n\t\tfor(int i = 0; i < M; i++){\n\t\t\tBIT[i] = init;\n\t\t}\n\t\tlong long int BIT_on = 0;\n\t\tfor(int loop = 0; loop < Q; loop++){\n\t\t\tstring str1, str2;\n\t\t\tcin >> str1 >> str2;\n\t\t\tinit = 0;\n\t\t\tfor(int i = N - 1; i >= 0; i--){\n\t\t\t\tinit *= 2;\n\t\t\t\tinit += str1[i] - '0';\n\t\t\t}\n\t\t\tBIT_on = BIT_on ^ init;\n\t\t\t\n\t\t\tfor(int i = 0; i < M; i++){\n\t\t\t\tif(str2[i] == '1'){\n\t\t\t\t\tBIT[i] = BIT[i] & BIT_on;\n\t\t\t\t}else{\n\t\t\t\t\tBIT[i] = BIT[i] & (~BIT_on);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0; i < M; i++){\n\t\t\tlong long int hoge = 1;\n\t\t\tint ans = -1;\n\t\t\tfor(int j = 0; j < N; j++){\n\t\t\t\tif(hoge == BIT[i]){\n\t\t\t\t\tans = j;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\thoge *= 2;\n\t\t\t}\n\t\t\tif(ans == -1){\n\t\t\t\tcout << \"?\";\n\t\t\t}else if(ans < 10){\n\t\t\t\tcout << ans;\n\t\t\t}else{\n\t\t\t\tstring str = \"A\";\n\t\t\t\tstr[0] += ans - 10;\n\t\t\t\tcout << str;\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t\t\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cmath>\n#include <iomanip>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <regex>\n#include <set>\n#include <stack>\n#include <string>\n#include <vector>\n\nusing namespace std;\n\n//using\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing VS = vector<string>;\nusing PII = pair<int, int>;\nusing LL = long long;\n\n//repetition\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define REP(i,n)  for(int i=0;i<(n);i++)\n\n//constant\nconst int INF = 1 << 29;\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\n\n//debug\n#define dump(x)  cout << #x << \" = \" << (x) << endl;\n\nint main() {\n  int N, M, Q;\n  cin >> N >> M >> Q;\n  while(!(N == 0 && M == 0 && Q == 0)){\n    string ans(M, '?');\n    vector<set<char>> ans_Vset(M);\n    REP(i, M) {\n      REP(j, N) {\n        if(j < 10) ans_Vset[i].insert('0'+j);\n        else ans_Vset[i].insert('A'-10+j);\n      }\n    }\n    string S_str, B_str;\n    bitset<36> S_tmp;\n    REP(i, Q) {\n      cin >> S_str >> B_str;\n      bitset<36> S(S_str);\n      S = S ^ S_tmp;\n      bitset<36> B(B_str);\n      REP(j, N) {\n        if(S[j]) {\n          REP(k, M) {\n            if(!B[k]) {\n              char tmp = j < 10 ? '0'+j : 'A'-10+j;\n              auto it = ans_Vset[k].find(tmp);\n              if(it != ans_Vset[k].end()) {\n                ans_Vset[k].erase(it);\n              }\n            }\n          }\n        }else{\n          REP(k, M) {\n            if(B[k]) {\n              char tmp = j < 10 ? '0'+j : 'A'-10+j;\n              auto it = ans_Vset[k].find(tmp);\n              if(it != ans_Vset[k].end()) {\n                ans_Vset[k].erase(it);\n              }\n            }\n          }\n        }\n      }\n      S_tmp = S;\n    }\n    REP(i, M) {\n      if(ans_Vset[i].size()==1) ans[M-1-i] = '0'+N-1+'0'-(*ans_Vset[i].begin());\n      if(ans[M-1-i]-'0'>9) ans[M-1-i] = ans[M-1-i]-'0'-10+'A';\n      if(ans[M-1-i] == ')') ans[M-1-i] = '0';\n    }\n    cout << ans << endl;\n    cin >> N >> M >> Q;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#define Q 1001\n#define N 37\nusing namespace std;\n\nint main(){\n  int n,m,q;\n  char ans[Q];\n  bool sw[N],swb[N],li[Q],fl[Q],fln[N],fle[Q];\n  string s[Q],b[Q];\n  vector<int> on,off,r;\n  while(1){\n    cin>>n>>m>>q;\n    if(!n&&!m&&!q) break;\n    for(int i=0;i<q;i++) cin>>s[i]>>b[i];\n    for(int i=0;i<n;i++) sw[i]=swb[i]=fln[i]=false;\n    for(int i=0;i<m;i++) ans[i]='?',li[i]=fl[i]=fle[i]=false;\n    for(int i=0;i<q;i++){\n      for(int j=0;j<n;j++) swb[j]=sw[j];\n      for(int j=0;j<n;j++)\n\tif(s[i][j]=='1') sw[j]?sw[j]=false:sw[j]=true;\n      for(int j=0;j<n;j++){\n\tif(swb[j]&&sw[j]) r.push_back(j);\n\telse if(swb[j]&&!sw[j]) off.push_back(j);\n\telse if(sw[j]) on.push_back(j);\n      }\n      for(int j=0;j<n;j++)\n\tif(fln[j]){\n\t  for(int k=0;k<on.size();k++)\n\t    if(j==on[k]) on.erase(on.begin()+k);\n\t  for(int k=0;k<off.size();k++)\n\t    if(j==off[k]) off.erase(off.begin()+k);\n\t  for(int k=0;k<r.size();k++)\n\t    if(j==r[k]) r.erase(r.begin()+k);\n\t}\n      if(on.size()==1)\n\tfor(int j=0;j<m;j++)\n\t  if(!li[j]&&b[i][j]=='1'){\n\t    if(!fl[j]){\n\t      if(on[0]<=9) ans[j]=on[0]+'0';\n\t      else ans[j]=on[0]+'A'-10;\n\t      fl[j]=fln[j]=true;\n\t    }\n\t    else ans[j]='?',fle[j]=true;\n\t  }\n      if(off.size()==1)\n\tfor(int j=0;j<m;j++)\n\t  if(li[j]&&b[i][j]=='0'){\n\t    if(!fl[j]){\n\t      if(off[0]<=9) ans[j]=off[0]+'0';\n\t      else ans[j]=off[0]+'A'-10;\n\t      fl[j]=fln[j]=true;\n\t    }\n\t    else ans[j]='?',fle[j]=true;\n\t  }\n      if(r.size()==1)\n\tfor(int j=0;j<m;j++)\n\t  if(li[j]&&b[i][j]=='1'){\n\t    if(!fl[j]){\n\t      if(r[0]<=9) ans[j]=r[0]+'0';\n\t      else ans[j]=r[0]+'A'-10;\n\t      fl[j]=fln[j]=true;\n\t    }\n\t    else ans[j]='?',fle[j]=true;\n\t  }\n      for(int j=0;j<m;j++)\n\tb[i][j]=='1'?li[j]=true:li[j]=false;\n      on.clear();\n      off.clear();\n      r.clear();\n    }\n    int cnt=0,a;\n    for(int i=0;i<n;i++)\n      if(!fln[i]) cnt++,a=i;\n    if(cnt==1)\n      for(int i=0;i<m;i++)\n\tif(ans[i]=='?'&&!fle[i]){\n\t  if(a<=9) ans[i]=a+'0';\n\t  else ans[i]=a+'A'-10;\n\t}\n    for(int i=0;i<m;i++) cout<<ans[i];\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) begin(a),end(a)\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10  fixed<<setprecision(5)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<short, short> P;\ntypedef complex<double> Point;\ntypedef long long ll;\nconst int INF = 1145141919;\nconst int MOD = 100000007;\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\nstruct edge\n{\n\tint from, to, cost;\n\tbool operator < (const edge& e) const { return cost < e.cost; }\n\tbool operator > (const edge& e) const { return cost > e.cost; }\n};\n///*************************************************************************************///\n///*************************************************************************************///\n///*************************************************************************************///\n\n\nint main()\n{\n\tint n, m, q;\n\twhile (cin >> n >> m >> q, n)\n\t{\n\t\tvector<vi> v(m);\n\t\tREP(i, m)REP(j, n) v[i].push_back(j);\n\t\tstring b, s, preb(m,'0'), pres(n,'0');\n\t\tREP(r, q)\n\t\t{\n\t\t\tcin >> s >> b;\n\t\t\tvi op,rem;\n\t\t\tREP(i, n)\n\t\t\t{\n\t\t\t\tif (s[i]=='1') op.push_back(i);\n\t\t\t\telse rem.push_back(i);\n\t\t\t}\n\t\t\t\n\t\t\tREP(i, m)\n\t\t\t{\n\t\t\t\tif (v[i].size()>1 && preb[i] == b[i])\n\t\t\t\t{\n\t\t\t\t\tREP(j, v[i].size())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (find(ALL(op), v[i][j]) != op.end())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tv[i].erase(v[i].begin() + j);\n\t\t\t\t\t\t\tj--;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (v[i].size()>1 && preb[i] != b[i])\n\t\t\t\t{\n\t\t\t\t\tREP(j, v[i].size())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (find(ALL(rem), v[i][j]) != rem.end())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tv[i].erase(v[i].begin() + j);\n\t\t\t\t\t\t\tj--;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tpres = s; preb = b;\n\t\t}\n\t\tREP(i, m)\n\t\t{\n\t\t\tif (v[i].size() > 1||v[i].size()==0) cout << '?';\n\t\t\telse if (v[i][0] < 10) cout << v[i][0];\n\t\t\telse\n\t\t\t{\n\t\t\t\tcout << char('A' + v[i][0] - 10);\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n \t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n  string base36 = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ?\";\n  int N, M, Q;\n  while(cin >> N >> M >> Q, N || M || Q){\n    long long bulb[1000]; memset(bulb, -1L, sizeof(bulb));\n    long long swch = 0;\n    for(int i = 0; i < Q; i++){\n      string S, B;\n      cin >> S >> B;\n      long long s = 0L, b = 0L;\n      for(int j = 0; j < S.size(); j++) s |= ((S[j]=='1') << j);\n      for(int j = 0; j < B.size(); j++) b |= ((B[j]=='1') << j);\n      swch ^= s;\n      for(int j = 0; j < M; j++){\n\tif((b >> j) & 1){\n\t  bulb[j] &= swch;\n\t} else {\n\t  bulb[j] &= ~swch;\n\t}\n      }\n    }\n    for(int i = 0; i < M; i++){\n      int ctrl = -1;\n      int cnt = 0;\n      for(int j = 0; j < N; j++){\n\tif((bulb[i] >> j) & 1) cnt++, ctrl = j;\n      }\n      if(cnt == 1) cout << base36[ctrl];\n      else cout << \"?\";\n    }\n    cout << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\nchar ret(int i) {\n    if (i < 10) return '0' + i;\n    else return 'A' + (i-10);\n}\n\nint main(void){\n    int n, m, q;\n    char c;\n    while (cin>>n>>m>>q && n) {\n        vector<vector<int> > s(q, vector<int>(n));\n        vector<vector<int> > b(q, vector<int>(m));\n        \n        for (int i = 0; i < q; i++) {\n            for (int j = 0; j < n; j++) {\n                cin >> c;\n                if (i == 0) s[i][j] = c-'0';\n                else {\n                    if (c == '0' && s[i-1][j] == 1) s[i][j] = 1;\n                    else if (c == '1' && s[i-1][j] == 1) s[i][j] = 0;\n                    else s[i][j] = c-'0';\n                }\n            }\n            for (int j = 0; j < m; j++) {\n                cin >> c;\n                b[i][j] = c-'0';\n            }\n        }\n        \n        vector<vector<bool> > x(n, vector<bool>(m, true));\n        for (int i = 0; i < q; i++) {\n            for (int j = 0; j < n; j++) {\n                bool f;\n                s[i][j] == 1 ? f = true : f = false;\n                for (int k = 0; k < m; k++) {\n                    if (f) {\n                        if (b[i][k] == 0) x[j][k] = false;\n                    }\n                    else {\n                        if (b[i][k] == 1) x[j][k] = false;\n                    }\n                }\n            }\n        }\n        \n        vector<char> ans(m, 'x');\n        for (int i = 0; i < m; i++) {\n            c = '.';\n            for (int j = 0; j < n; j++) {\n                if (x[j][i] == 1) {\n                    if (c == '.') c = ret(j);\n                    else c = '?';\n                }\n            }\n            if (c == '.') c = '?';\n            ans[i] = c;\n        }\n        for (int i = 0; i < m; i++) cout << ans[i];\n        cout << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\nusing namespace std;\n\nbool eval(int prev_b, int prev_s, int next_b, int next_s) {\n    if (prev_b == next_b) return prev_s == next_s;\n    else return prev_s != next_s;\n}\n\nchar int2char(int num) {\n    if (num < 10) return num + '0';\n    return num - 10 + 'A';\n}\n\nvoid solve(int n, int m, int q) {\n    vector<string> S(q), B(q);\n    for (int i = 0; i < q; ++i) {\n        cin >> S[i] >> B[i];\n    }\n    vector<vector<int> > corr(m);\n    for (int i = 0; i < m; ++i) {\n        // i番目の電球を切り替えられるスイッチを見つける\n        for (int j = 0; j < n; ++j) {\n            bool is_ok = true;\n            int prev_bulb = 0;\n            int prev_switch = 0;\n            for (int k = 0; k < q; ++k) {\n                int next_bulb = B[k][i] - '0';\n                int next_switch = prev_switch ^ (S[k][j] - '0');\n                if (!eval(prev_bulb, prev_switch, next_bulb, next_switch)) {\n                    is_ok = false;\n                    break;\n                }\n                prev_bulb = next_bulb;\n                prev_switch = next_switch;\n            }\n            if (is_ok) corr[i].push_back(j);\n        }\n    }\n    for (int i = 0; i < m; ++i) {\n        if (corr[i].size() == 1) {\n            cout << int2char(corr[i][0]);\n        }\n        else cout << '?';\n    }\n    cout << endl;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    int N, M, Q;\n    while (true) {\n        cin >> N >> M >> Q;\n        if (N == 0 && M == 0 && Q == 0) break;\n        solve(N, M, Q);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  while(1){\n  char c,ans[1001];\n  int n,m,q,cnt=0,f[37][1001],s[37]={},b[1001];\n  cin>>n>>m>>q;\n  if(n+m+q==0) break;\n  \n     for(int i=0;i<n;i++)\n       for(int j=0;j<m;j++)f[i][j]=1;\n   \n  while(cnt<q){\n    cnt++;\n    for(int i=0;i<n;i++)cin>>c,s[i]=(s[i]+(c-'0'))%2;\n    for(int i=0;i<m;i++)cin>>c,b[i]=c-'0';\n    \n    for(int i=0;i<n;i++)\n      for(int j=0;j<m;j++){\n\tif(f[i][j]==2) continue;\n\telse if(s[i]==b[j])f[i][j]=1;\n\telse f[i][j]=2;\n      }\n    }\n\n  for(int j=0;j<m;j++){\n    int flag=0;\n    for(int i=0;i<n;i++){\n      if(f[i][j]==1 && flag==0){\n\tflag=1;\n\tif(i>=0 && i<=9) ans[j]=i+'0';\n\telse ans[j]=i-10+'A';\n      }else if(flag==1 && f[i][j]==1)ans[j]='?';\n    }\n   }\n  \n  for(int i=0;i<m;i++)cout<<ans[i];\n  cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cassert>\nusing namespace std;\ntypedef long long ll;\nint N,M,Q;\nll s[4000],t[4000];\n\nll func(string str){\n  ll res=0;\n  for(int i=0;i<(int)str.size();i++)\n    if(str[i]=='1')res+=(1LL<<i);\n  return res;\n}\n\nint main(){\n  char change[36];\n  change[0]='0';\n  for(int i=1;i<10;i++)change[i]=change[i-1]+1;\n  change[10]='A';\n  for(int i=11;i<36;i++)change[i]=change[i-1]+1;\n\n  while(1){\n    cin>>N>>M>>Q;\n    if(N==0&&M==0&&Q==0)break;\n    for(int i=0;i<Q;i++){\n      string str,str2;\n      cin>>str>>str2;\n      s[i]=func(str);\n      t[i]=func(str2);\n      if(i)s[i]=s[i]^s[i-1];\n    }\n\n    for(int i=0;i<M;i++){\n      ll f=(1LL<<N)-1;\n      for(int j=0;j<Q;j++){\n\tif((t[j]>>i)&1){\n\t  f=f&s[j];\n\t}else {\n\t  f=f&(~s[j]);\n\t}\n      }\n      //assert(__builtin_popcountll(f)!=0);\n      if(__builtin_popcountll(f)==1){\n\tint ans=0;\n\tfor(ans=0;ans<N;ans++){\n\t  if(f==(1LL<<ans))break;\n\t}\n\tcout<<change[ans];\n      }else{\n\tcout<<'?';\n      }\n    }\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _GLIBCXX_DEBUG\n#include <iostream>\n#include <vector>\n#include <stdio.h>\n#include <bits/stdc++.h>\n\n\nusing namespace std;\n#define ll long long\n#define ld long double\n#define  P pair<ll,ll>\n#define FOR(i,n,m) for(ll i=n; i<(ll)m;i++)\n#define FORa(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define FORr(i,m,n) for(ll i=n; i>=(ll)m; i--)\n#define FORm(i,m) for(auto i=m.begin();i!=m.end();i++)\n#define FORs(i,st) for(auto i : st)\n#define REP(i,n) for(int i=0;i<(int)n;++i)\n#define ALL(c) (c).begin(), (c).end()\n#define VEC2(x,a,b) vector<vector<ll>> x = vector<vector<ll>>(a,vector<ll>(b,0))\n#define sortAl(v) sort(v.begin(),v.end())\n#define sortAlr(v) sort(v.begin(),v.end()); reverse(v.begin(),v.end())\n#define cinv(v,n,m) FOR(i,n,m) cin>>v.at(i)\n#define coutv(v,n,m) FOR(i,n,m) cout<<v.at(i) <<\" \"; cout<<endl\n#define cout(n) cout<<fixed<<setprecision(n)\n\nchar int_to_char(ll x){\n  if(x == -1) return '?';\n  else if(x<=9)return '0' + x;\n  else return 'A' + x - 10;\n}\n\n\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    ll n,m,q;\n    cin>>n>>m>>q;\n    while(n != 0){\n\n      vector<string> sw(q+1);\n      vector<string> light(q+1);\n\n      FOR(i,0,n){\n        sw[0].push_back('0');\n      }\n      FOR(i,0,m){\n        light[0].push_back('0');\n      }\n\n      FOR(i,1,q+1){\n        cin>>sw[i]>>light[i];\n      }\n      q++;\n\n      FOR(i,1,q){\n        FOR(j,0,n){\n          if(sw[i-1][j] == '1' && sw[i][j] == '1') sw[i][j] = '0';\n          else if(sw[i-1][j] == '0' && sw[i][j] == '1') sw[i][j] = '1';\n          else if(sw[i-1][j] == '1' && sw[i][j] == '0') sw[i][j] = '1';\n        }\n      }\n\n      vector<vector<ll>> v(m,vector<ll>(n,1));\n\n      FOR(i,0,q){//クエリごと\n        FOR(j,0,m){//あかりごと\n          FOR(k,0,n){\n            if(sw[i][k]=='0' && light[i][j] =='1')v[j][k]=0;\n            if(sw[i][k]=='1' && light[i][j] =='0')v[j][k]=0;\n          }\n        }\n      }\n\n      vector<ll> ans;\n      FOR(i,0,m){\n        ll tmp=0;\n        ll po=0;\n        FOR(j,0,n){\n          tmp+=v[i][j];\n          if(v[i][j]==1)po=j;\n        }\n        if(tmp==1)ans.push_back(po);\n        else ans.push_back(-1);\n      }\n\n      FOR(i,0,m){\n        cout<<int_to_char(ans[i]);\n      }\n      cout<<endl;\n\n\n      cin>>n>>m>>q;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <deque>\n#include <list>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <utility>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <complex>\n#include <cmath>\n#include <limits>\n#include <cfloat>\n#include <climits>\n#include <ctime>\n#include <cassert>\n#include <numeric>\n#include <functional>\nusing namespace std;\n\n#define rep(i,a,n) for(int (i)=(a); (i)<(n); (i)++)\n#define repq(i,a,n) for(int (i)=(a); (i)<=(n); (i)++)\n#define repr(i,a,n) for(int (i)=(a); (i)>=(n); (i)--)\n#define int long long int\n\ntemplate<typename T> void chmax(T &a, T b) {a = max(a, b);}\ntemplate<typename T> void chmin(T &a, T b) {a = min(a, b);}\ntemplate<typename T> void chadd(T &a, T b) {a = a + b;}\n\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\nint dx[] = {0, 0, 1, -1};\nint dy[] = {1, -1, 0, 0};\nconstexpr ll INF = 1001001001001001LL;\nconstexpr ll MOD = 1000000007LL;\n\nint N, M, Q;\nbool table[1010][40];\nint ans[1010];\n\nsigned main() {\n    while(cin >> N >> M >> Q, N) {\n        memset(table, true, sizeof(table));\n        memset(ans, -1, sizeof(ans));\n        string prev(M, '0');\n        rep(i,0,Q) {\n            string S, B; cin >> S >> B;\n            bool switches[40] = {};\n            rep(k,0,N) if(S[k] == '1') switches[k] = true;\n            rep(k,0,M) {\n                rep(x,0,N) {\n                    if(!table[k][x]) continue;\n                    table[k][x] = switches[x] ^ (prev[k] == B[k]);\n                }\n            }\n            prev = B;\n        }\n\n        bool used[40] = {};\n        bool ok = true;\n        while(ok) {\n            ok = false;\n            vector<int> temp;\n            rep(i,0,M) {\n                if(ans[i] != -1) continue;\n                int cnt = 0, rec = 0;\n                rep(k,0,N) {\n                    if(table[i][k] && !used[k]) {\n                        // printf(\"bulb: %lld, switch: %lld\\n\", i, k);\n                        cnt++;\n                        rec = k;\n                    }\n                }\n                if(cnt == 1) {\n                    ok = true;\n                    ans[i] = rec;\n                    temp.push_back(rec);\n                }\n            }\n            rep(i,0,temp.size()) used[ temp[i] ] = true;\n        }\n        rep(i,0,M) {\n            if(ans[i] == -1) cout << \"?\";\n            else {\n                if(ans[i] < 10) cout << ans[i];\n                else cout << (char)('A' + ans[i] - 10);\n            }\n        }\n        cout << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint N,M,Q;\nunsigned long long ans[1003];\nvoid plot() {\n    rep(i,M) {\n        int count=0;\n        int val=0;\n        rep(j,N) {\n            if(((ans[i])>>j)&1) {\n                count++;\n                val=j;\n            }\n        }\n        if(count==1) {\n            if(val<10) printf(\"%d\",val);\n            else printf(\"%c\",'A'+val-10);\n        }\n        else cout<<\"?\";\n    }\n    cout<<endl;\n}\n\nvoid update(unsigned long long& mask, string S, string B) {\n    unsigned long long bit=0;\n    rep(i,N) if(S[i]=='1') bit|=1L<<i;\n    mask^=bit;\n    // printf(\"%s->%s : %lx\\n\", stateS.c_str(),S.c_str(),bit);\n    rep(i,M) {\n        if(B[i] == '1') {\n            ans[i] &= mask;\n        }\n        else {\n            ans[i] &= ~mask;\n        }\n    }\n}\n\n\nvoid solve() {\n    \n    rep(i,1003) ans[i]=(1<<N)-1;\n    unsigned long long mask=0;\n    string S,B;\n    rep(i,Q) {\n        cin>>S>>B;\n        update(mask, S,B);\n\n        // rep(i,M) cout<<ans[i]<<\",\";\n        // cout<<endl;\n    }\n    plot();\n}\n\nint main() {\n    while(cin>>N>>M>>Q) {\n        if(N+M+Q==0) break;\n        solve();\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<cstring>\n#include<vector>\n#include<set>\n#include<list>\n#include<queue>\n#include<cmath>\n#include<functional>\n#include<algorithm>\n#define INF (1<<29)\n#define rep(i,n) for(int i=0;i<(n);i++)\nusing namespace std;\n\n\n\nint bits_ctz(unsigned long long b){\n\tb&=-b;\n\tint res=0;\n\tfor(int i=5;i>=0;i--){\n\t\tint shift=1<<i;\n\t\tif(b>>shift){\n\t\t\tb>>=shift;\n\t\t\tres|=shift;\n\t\t}\n\t}\n\treturn res;\n}\n\n\nint main(){\n\tint n,m,q;\n\tlong long maybe[1000];\n\twhile(cin>>n>>m>>q,n|m|q){\n\t\tfill_n(maybe,m,(1LL<<n)-1);\n\t\tlong long state=0;\n\t\trep(i,q){\n\t\t\tlong long s=0,b=0;\n\t\t\tstring str;\n\t\t\tcin>>str;\n\t\t\trep(i,n)s|=(long long)(str[i]-'0')<<(i);\n\t\t\tcin>>str;\n\t\t\trep(i,m)b|=(long long)(str[i]-'0')<<(i);\n\t\t\tlong long changed=state^b;\n\t\t\trep(i,m){\n\t\t\t\tif(changed>>i&1){\n\t\t\t\t\tmaybe[i]&=s;\n\t\t\t\t}else{\n\t\t\t\t\tmaybe[i]&=~s;\n\t\t\t\t}\n\t\t\t}\n\t\t\tstate=b;\n\t\t}\n\t\trep(i,m){\n\t\t\tif(maybe[i]&maybe[i]-1){\n\t\t\t\tcout<<'?';\n\t\t\t}else{\n\t\t\t\tint ctz=bits_ctz(maybe[i]);\n\t\t\t\tif(ctz<10)cout<<ctz;\n\t\t\t\telse cout<<char('A'+ctz-10);\n\t\t\t}\n\t\t}\n\t\tcout<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <set>\n#include <algorithm>\nusing namespace std;\n\nint main() {\n    int N, M, Q;\n    while(cin >> N >> M >> Q, N) {\n        \n        string prev_b = string(M, '0');\n        set<int> all_sw;\n        for(int i=0; i<N; ++i) {\n            all_sw.insert(i);\n        }\n        vector<set<int>> ret(M, all_sw);\n\n        for(int i=0; i<Q; ++i) {\n            string s, b;\n            cin >> s >> b;\n            set<int> can_sw;\n            for(int j=0; j<N; ++j) {\n                if(s[j] == '1') {\n                    can_sw.insert(j);\n                }\n            }\n            for(int j=0; j<M; ++j) {\n                if(prev_b[j] != b[j]) {\n                    set<int> inter;\n                    set_intersection(ret[j].begin(), ret[j].end(), can_sw.begin(), can_sw.end(), inserter(inter, inter.end()));\n                    ret[j] = inter;\n                } else {\n                    set<int> dif;\n                    set_difference(ret[j].begin(), ret[j].end(), can_sw.begin(), can_sw.end(), inserter(dif, dif.end()));\n                    ret[j] = dif;\n                }\n            }\n            prev_b = b;\n        }\n\n        for(int i=0; i<ret.size(); ++i) {\n            if(ret[i].size() == 1) {\n                int r = *ret[i].begin();\n                if(0 <= r && r <= 9) {\n                    cout << r;\n                } else {\n                    cout << static_cast<char>('A' + r-10);\n                }       \n            } else {\n                cout << '?';\n            }\n        }\n        cout << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-9;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\nint main() {\n\twhile (1) {\n\t\tint N, M, Q; cin >> N >> M >> Q;\n\t\tif (!N)break;\n\t\tvector<set<int>>kouhos(M);\n\t\tfor (int i = 0; i < M; ++i) {\n\t\t\tfor (int j = 0; j < N; ++j) {\n\t\t\t\tkouhos[i].emplace(j);\n\t\t\t}\n\t\t}\n\t\tstring pre;\n\t\tfor (int i = 0; i < M; ++i) {\n\t\t\tpre.push_back('0');\n\t\t}\n\t\tfor (int i = 0; i < Q; ++i) {\n\t\t\tstring s, b; cin >> s >> b;\n\t\t\tvector<int>pushed(N);\n\t\t\tfor (int j = 0; j < N; ++j) {\n\t\t\t\tpushed[j] = s[j] == '1';\n\t\t\t}\n\n\t\t\tfor (int j = 0; j < M; ++j) {\n\t\t\t\tif (pre[j] == b[j]) {\n\t\t\t\t\tfor (int k = 0; k < N; ++k) {\n\t\t\t\t\t\tif (pushed[k]) {\n\t\t\t\t\t\t\tkouhos[j].erase(k);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfor (int k = 0; k < N; ++k) {\n\t\t\t\t\t\tif (!pushed[k]) {\n\t\t\t\t\t\t\tkouhos[j].erase(k);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tpre = b;\n\t\t}\n\t\tfor (int i = 0; i < M; ++i) {\n\t\t\tif (kouhos[i].size() == 1) {\n\t\t\t\tint ans = *kouhos[i].begin();\n\t\t\t\tchar out = ans < 10 ? ans + '0' : ans + 'A' - 10;\n\t\t\t\tcout << out;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcout << \"?\";\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cassert>\nusing namespace std;\ntypedef long long ll;\nint N,M,Q;\nll s[4000],t[4000];\n\nll func(string str){\n  ll res=0;\n  for(int i=0;i<(int)str.size();i++)\n    if(str[i]-'0')res+=(1LL<<i);\n  return res;\n}\n\nint main(){\n  char change[36];\n  change[0]='0';\n  for(int i=1;i<10;i++)change[i]=change[i-1]+1;\n  change[10]='A';\n  for(int i=11;i<36;i++)change[i]=change[i-1]+1;\n\n  while(1){\n    cin>>N>>M>>Q;\n    if(N==0&&M==0&&Q==0)break;\n    for(int i=0;i<Q;i++){\n      string str,str2;\n      cin>>str>>str2;\n      s[i]=func(str);\n      t[i]=func(str2);\n      if(i)s[i]=s[i]^s[i-1];\n    }\n\n    for(int i=0;i<M;i++){\n      ll f=(1LL<<N)-1;\n      for(int j=0;j<Q;j++){\n\tif((t[j]>>i)&1){\n\t  f=f&s[j];\n\t}else {\n\t  f=f&(~s[j]);\n\t}\n      }\n\n      if(__builtin_popcountll(f)<=1){\n\tint ans=0;\n\tfor(ans=0;ans<36&&(1LL<<ans)!=f;ans++);\n\tcout<<change[ans];\n      }else{\n\tcout<<'?';\n      }\n    }\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n#include <queue>\n#include <vector>\ntypedef long long int ll;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000001\nusing namespace std;\n\nint main(){\n\n\tchar number[36];\n\tchar ans[1000],pre_switch[36],current_switch[36],current_bulb[1000];\n\n\tbool** check = new bool*[1000];\n\tfor(int i = 0; i < 1000; i++){\n\t\tcheck[i] = new bool[36];\n\t}\n\n\tfor(int i = 0; i <= 9; i++)number[i] = i + '0';\n\tfor(int i = 0; i <= 25; i++)number[10+i] = i + 'A';\n\n\tint N,M,Q,count,tmp;\n\twhile(true){\n\t\tscanf(\"%d %d %d\",&N,&M,&Q);\n\t\tif(N == 0 && M == 0 && Q == 0)break;\n\n\t\tif(Q == 0 && N == 1){\n\t\t\tfor(int i = 0; i < M; i++)printf(\"0\");\n\t\t\tprintf(\"\\n\");\n\t\t\tcontinue;\n\t\t}\n\n\t\tfor(int i = 0; i < M; i++){\n\t\t\tans[i] = '?';\n\t\t\tfor(int k = 0; k < N; k++){\n\t\t\t\tcheck[i][k] = true;\n\t\t\t}\n\t\t}\n\n\t\tfor(int i = 0; i < N; i++)pre_switch[i] = '0';\n\n\t\tfor(int i = 0; i < Q; i++){\n\t\t\tscanf(\"%s %s\",current_switch,current_bulb);\n\n\t\t\tfor(int k = 0; k < N; k++){\n\t\t\t\tif(current_switch[k] == '1'){\n\t\t\t\t\tif(pre_switch[k] == '0'){\n\t\t\t\t\t\tcurrent_switch[k] = '1';\n\t\t\t\t\t}else{\n\t\t\t\t\t\tcurrent_switch[k] = '0';\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tcurrent_switch[k] = pre_switch[k];\n\t\t\t\t}\n\t\t\t\tpre_switch[k] = current_switch[k];\n\t\t\t}\n\n\t\t\tfor(int a = 0; a < M; a++){\n\t\t\t\tfor(int b = 0; b < N; b++){\n\t\t\t\t\tif(current_bulb[a] != current_switch[b]){\n\t\t\t\t\t\tcheck[a][b] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor(int i = 0; i < M; i++){\n\t\t\tcount = 0;\n\t\t\tfor(int k = 0; k < N; k++){\n\t\t\t\tif(check[i][k]){\n\t\t\t\t\ttmp = k;\n\t\t\t\t\tcount++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(count == 1)ans[i] = number[tmp];\n\t\t}\n\n\t\tfor(int i = 0; i < M; i++)printf(\"%c\",ans[i]);\n\t\tprintf(\"\\n\");\n\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\nusing namespace std;\n\nint main(){\n    int n, m, q;\n    while(cin >> n >> m >> q, n||m||q){\n        int a[37][1005];\n        memset(a, -1, sizeof(a)); //1:テ・ツ渉ッティツδステヲツ?ァテ」ツ?づ」ツつ?0:テ・ツ渉ッティツδステヲツ?ァテ」ツ?ェテ」ツ??-1:テ」ツつ湘」ツ?凝」ツつ嘉」ツ?ェテ」ツ??\n\n        if(q == 0 && n == 1){\n            rep(i,m) cout << 0;\n            cout << endl;\n            continue;\n        }\n        string sb, bb;\n        rep(i,n) sb+='0';\n        rep(j,m) bb+='0';\n        rep(i,q){\n            string s, b;\n            cin >> s >> b;\n            rep(j,n){\n                if(s[j] == '1'){\n                    rep(k,m){\n                        if(b[k] != bb[k]){\n                            //cout << j << ' ' << k << endl;\n                            if(a[j][k] != 0) a[j][k] = 1;\n                        }else{\n                            if(a[j][k] != 0) a[j][k] = 0;\n                        }\n                    }\n                }else{\n                    rep(k,m){\n                        if(b[k] != bb[k]){\n                            //cout << j << ' ' << k << endl;\n                            if(a[j][k] != 0) a[j][k] = 0;\n                        }else{\n                            if(a[j][k] != 0) a[j][k] = 1;\n                        }\n                    }\n                }\n            }\n            sb = s;\n            bb = b;\n        //rep(i,3){ rep(j,10){ cout << a[i][j]; } cout << endl; } cout << endl;\n        }\n\n        string ans = \"\";\n        rep(j,m){\n            char c = '?';\n            rep(i,n){\n                if(a[i][j] == 1){\n                    if(c == '?'){\n                        if(i >= 0 && i <= 9) c = i + '0';\n                        else c = (i - 10) + 'A';\n                    }\n                }else if(a[i][j] == -1){\n                    c = '?';\n                    break;\n                }\n            }\n            ans += c;\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nstring press[1010];\nstring state[1010];\n\nchar conv(int n){\n\tif(0 <= n && n <= 9) return '0' + n;\n\tn -= 10;\n\treturn 'A' + n;\n}\n\nint main(){\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n#ifdef LOCAL\n\tstd::ifstream in(\"in\");\n\tstd::cin.rdbuf(in.rdbuf());\n#endif\n\n\tint N, M, Q;\n\twhile(cin >> N >> M >> Q, N){\n\t\tstate[0] = string(M, '0');\n\t\tfor(int i = 1; i <= Q; i++){\n\t\t\tcin >> press[i] >> state[i];\n\t\t}\n\n\t\tstring ans;\n\t\tfor(int i = 0; i < M; i++){\n\t\t\tset<int> cand;\n\t\t\tfor(int n = 0; n < N; n++){\n\t\t\t\tint cnt[2][2] = { 0 };\n\t\t\t\tfor(int j = 1; j <= Q; j++){\n\t\t\t\t\tconst string& pre = state[j - 1];\n\t\t\t\t\tint change = state[j][i] != state[j - 1][i];\n\t\t\t\t\tint p = press[j][n] == '1';\n\t\t\t\t\tcnt[change][p]++;\n\t\t\t\t}\n\t\t\t\tif(cnt[0][0] + cnt[1][1] == Q){\n\t\t\t\t\tcand.insert(n);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(cand.size() == 1){\n\t\t\t\tans += conv(*cand.begin());\n\t\t\t}\n\t\t\telse{\n\t\t\t\tans += '?';\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\nll light[1000];//i番目のライトがどのスイッチで変わるか\nll no[1000];\n//bitを探索する\nchar hen(int i)\n{\n\tif(i==-1)\n\t\treturn '?';\n\tif(i<10)\n\t\treturn (char)('0'+i);\n\telse{\n\t\ti-=10;\n\t\treturn (char)('A'+i);\n\t}\n}\nchar chin(int ind,int n)\n{\n\tint cnt=0;\n\tint ret=-1;\n\tfor(ll i=0;i<n;i++)\n\t{\n\t\tif(light[ind]&(1LL<<i))\n\t\t{\n\t\t\tcnt++;\n\t\t\tret=i;\n\t\t}\n\t}\n\tif(cnt!=1)\n\t\tret=-1;\n\treturn hen(ret);\n}\nll s[100001];\nstring b[100001];\nint main()\n{\n\tint n,m,q;\n\twhile(1)\n\t{\n\t\tcin>>n>>m>>q;\n\t\tstring tmp=\"\";\n\t\tfor(int i=0;i<m;i++)\n\t\t\ttmp+='0';\n\t\tb[0]=tmp;\n\t\ts[0]=0;\n\t\tfor(int i=1;i<q+1;i++)\n\t\t{\n\t\t\tcin>>tmp>>b[i];\n\t\t\treverse(tmp.begin(),tmp.end());\n\t\t\ts[i]=stoll(tmp,nullptr,2);\n\t\t}\n\t\tif(n==0)\n\t\t\tbreak;\n\t\tif(q==0)\n\t\t{\n\t\t\tif(n==1)\n\t\t\t{\n\t\t\t\tfor(int i=0;i<m;i++)\n\t\t\t\t\tcout<<0;\n\t\t\t\tcout<<endl;\n\t\t\t}else{\n\t\t\t\tfor(int i=0;i<m;i++)\n\t\t\t\t\tcout<<'?';\n\t\t\t\tcout<<endl;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tfill(light,light+1000,(1LL<<(ll)n)-1LL);\n\t\tfill(no,no+1000,0);\n\t\tfor(int i=1;i<q+1;i++)\n\t\t{\n\t\t\tfor(int j=0;j<m;j++)\n\t\t\t{\n\t\t\t\tif(b[i-1][j]!=b[i][j])\n\t\t\t\t\tlight[j]&=s[i];\n\t\t\t\telse\n\t\t\t\t\tno[j]|=s[i];\n\t\t\t}\n\t\t}\n\t\tstring ans;\n\t\tfor(int i=0;i<m;i++)\n\t\t{\n\t\t\t//cerr<<bitset<36>(light[i])<<\" \"<<bitset<36>(no[i])<<endl;\n\t\t\tlight[i]&=(~no[i]);\n\t\t\t//cerr<<i<<\" \"<<bitset<36>(light[i])<<endl;\n\t\t\tans+=chin(i,n);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nnamespace {\n\n    template<class T> ostream& operator<<(ostream& os, const vector<T>& vs) {\n        if (vs.empty()) return os << \"[]\";\n        os << \"[\" << vs[0];\n        for (int i = 1; i < vs.size(); i++) os << \" \" << vs[i];\n        return os << \"]\";\n    }\n\n    typedef long long ll;\n\n    int N, M, Q;\n    vector<string> S, B;\n    bool input() {\n        scanf(\"%d %d %d\\n\", &N, &M, &Q);\n        if (N == 0 && M == 0 && Q == 0) return false;\n        B.clear(); B.resize(Q + 1);\n        S.clear(); S.resize(Q);\n        B[0] = \"\";\n        for (int i = 0; i < M; i++) B[0].push_back('0');\n        for (int q = 0; q < Q; q++) {\n            cin >> S[q] >> B[q + 1];\n        }\n        return true;\n    }\n\n    void solve() {\n        for (int i = 0; i < M; i++) {\n            vector<bool> f(N, true);\n            for (int j = 0; j < Q; j++) {\n                bool x = (B[j + 1][i] == B[j][i]);\n                for (int k = 0; k < N; k++) {\n                    bool y = (S[j][k] == '0');\n                    if (x != y) {\n                        f[k] = false;\n                    }\n                }\n            }\n            if (count(f.begin(), f.end(), true) == 1) {\n                for (int j = 0; j < N; j++) {\n                    if (f[j]) {\n                        cout << char(j + (j < 10 ? '0' : 'A' - 10));\n                    }\n                }\n            } else {\n                cout << '?';\n            }\n        }\n        cout << endl;\n    }\n}\n\nint main() {\n    while (input()) solve();\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// template {\n\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define loop(i, a, b) for (int i = (int)(a); i < (int)(b); i++)\n#define rep(i, n) loop(i, 0, n)\n#define rloop(i, a, b) for (int i = (int)(b) - 1; i >= (int)(a); i--)\n#define rrep(i, n) rloop(i, 0, n)\n#define eb emplace_back\n#define ef emplace_front\n#define pb pop_back\n#define pf pop_front\n#define all(c) std::begin(c), std::end(c)\n#define mp std::make_pair\n#define mt std::make_tuple\n#define fi first\n#define se second\n#define popcnt __builtin_popcountll\n\nusing uint = unsigned;\nusing ll = long long;\nusing ull = unsigned long long;\nusing ld = long double;\n\ntemplate<typename T>\nusing max_pq = priority_queue<T, vector<T>, less<T>>;\n\ntemplate<typename T>\nusing min_pq = priority_queue<T, vector<T>, greater<T>>;\n\nconst int MOD = 1e9 + 7;\nconst int INF = 1e9 + 10;\nconst ll LLINF = 1e18 + 10;\n\nconst int dx[] = {-1, 0, 1, 0};\nconst int dy[] = {0, -1, 0, 1};\nconst int dx8[] = {-1, -1, 0, 1, 1, 1, 0, -1};\nconst int dy8[] = {0, -1, -1, -1, 0, 1, 1, 1};\n\ntemplate<typename T>\ninline T sq(T x){ return x * x; }\n\ntemplate<typename T, typename U>\ninline bool chmax(T &x, U y){ if (x >= y) return false; x = y; return true; }\n\ntemplate<typename T, typename U>\ninline bool chmin(T &x, U y){ if (x <= y) return false; x = y; return true; }\n\ntemplate<typename T>\ninline void sort(T &c){ std::sort(std::begin(c), std::end(c)); }\n\ntemplate<typename T>\ninline void reverse(T &c){ std::reverse(std::begin(c), std::end(c)); }\n\ntemplate<typename T>\ninline void unique(T &c){ std::sort(std::begin(c), std::end(c)); c.erase(std::unique(all(c)), std::end(c)); }\n\n// }}}\n\nconst int tb[][8] = {\n\t{3, 0, 1, 2, 7, 4, 5, 6},\n\t{4, 0, 3, 7, 5, 1, 2, 6}\n};\n\nmap<string, int> cv;\nset<int> dn;\nint a[8];\n\nint main()\n{\n\twhile (true){\n\t\tcv.clear();\n\t\tdn.clear();\n\n\t\tstring s;\n\t\trep(i, 8){\n\t\t\tif (!(cin >> s)) return 0;\n\t\t\tint t = cv.size();\n\t\t\tif (cv.count(s)) a[i] = cv[s];\n\t\t\telse cv[s] = a[i] = t;\n\t\t}\n\n\t\tint res = 0;\n\t\tint perm[8];\n\t\tint c[128];\n\t\tiota(perm, perm + 8, 0);\n\t\tdo {\n\t\t\tarray<int, 8> b;\n\t\t\trep(i, 8) b[i] = a[perm[i]];\n\t\t\tbool f = true;\n\t\t\trep(i, 128){\n\t\t\t\tc[i] = 0;\n\t\t\t\trep(j, 8) c[i] = c[i] * 8 + b[j];\n\t\t\t\tif (dn.count(c[i])) f = false;\n\t\t\t\tarray<int, 8> dst;\n\t\t\t\trep(j, 8){\n\t\t\t\t\tdst[j] = b[tb[0][j]];\n\t\t\t\t}\n\t\t\t\tif (i % 4 == 3){\n\t\t\t\t\trep(j, 8){\n\t\t\t\t\t\tdst[j] = b[tb[1][j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tb = dst;\n\t\t\t}\n\t\t\tif (f) res++;\n\t\t\trep(i, 128) dn.insert(c[i]);\n\t\t} while (next_permutation(perm, perm + 8));\n\t\t\n\t\tcout << res << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "// template {\n\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define loop(i, a, b) for (int i = (int)(a); i < (int)(b); i++)\n#define rep(i, n) loop(i, 0, n)\n#define rloop(i, a, b) for (int i = (int)(b) - 1; i >= (int)(a); i--)\n#define rrep(i, n) rloop(i, 0, n)\n#define eb emplace_back\n#define ef emplace_front\n#define pb pop_back\n#define pf pop_front\n#define all(c) std::begin(c), std::end(c)\n#define mp std::make_pair\n#define mt std::make_tuple\n#define fi first\n#define se second\n#define popcnt __builtin_popcountll\n\nusing uint = unsigned;\nusing ll = long long;\nusing ull = unsigned long long;\nusing ld = long double;\n\ntemplate<typename T>\nusing max_pq = priority_queue<T, vector<T>, less<T>>;\n\ntemplate<typename T>\nusing min_pq = priority_queue<T, vector<T>, greater<T>>;\n\nconst int MOD = 1e9 + 7;\nconst int INF = 1e9 + 10;\nconst ll LLINF = 1e18 + 10;\n\nconst int dx[] = {-1, 0, 1, 0};\nconst int dy[] = {0, -1, 0, 1};\nconst int dx8[] = {-1, -1, 0, 1, 1, 1, 0, -1};\nconst int dy8[] = {0, -1, -1, -1, 0, 1, 1, 1};\n\ntemplate<typename T>\ninline T sq(T x){ return x * x; }\n\ntemplate<typename T, typename U>\ninline bool chmax(T &x, U y){ if (x >= y) return false; x = y; return true; }\n\ntemplate<typename T, typename U>\ninline bool chmin(T &x, U y){ if (x <= y) return false; x = y; return true; }\n\ntemplate<typename T>\ninline void sort(T &c){ std::sort(std::begin(c), std::end(c)); }\n\ntemplate<typename T>\ninline void reverse(T &c){ std::reverse(std::begin(c), std::end(c)); }\n\ntemplate<typename T>\ninline void unique(T &c){ std::sort(std::begin(c), std::end(c)); c.erase(std::unique(all(c)), std::end(c)); }\n\n// }}}\n\nconst int tb[][8] = {\n\t{3, 0, 1, 2, 7, 4, 5, 6},\n\t{4, 0, 3, 7, 5, 1, 2, 6}\n};\n\nmap<string, int> cv;\nset<int> dn;\nint a[8];\n\nint main()\n{\n\twhile (true){\n\t\tcv.clear();\n\t\tdn.clear();\n\n\t\tstring s;\n\t\trep(i, 8){\n\t\t\tif (!(cin >> s)) return 0;\n\t\t\tint t = cv.size();\n\t\t\tif (cv.count(s)) a[i] = cv[s];\n\t\t\telse cv[s] = a[i] = t;\n\t\t}\n\n\t\tint res = 0;\n\t\tint perm[8];\n\t\tint c[32];\n\t\tiota(perm, perm + 8, 0);\n\t\tdo {\n\t\t\tarray<int, 8> b;\n\t\t\trep(i, 8) b[i] = a[perm[i]];\n\t\t\tbool f = true;\n\t\t\trep(i, 32){\n\t\t\t\tc[i] = 0;\n\t\t\t\trep(j, 8) c[i] = c[i] * 8 + b[j];\n\t\t\t\tif (dn.count(c[i])) f = false;\n\t\t\t\tarray<int, 8> dst;\n\t\t\t\trep(j, 8){\n\t\t\t\t\tdst[j] = b[tb[0][j]];\n\t\t\t\t}\n\t\t\t\tif (i % 4 == 3){\n\t\t\t\t\trep(j, 8){\n\t\t\t\t\t\tdst[j] = b[tb[1][j]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tb = dst;\n\t\t\t}\n\t\t\tif (f) res++;\n\t\t\trep(i, 128) dn.insert(c[i]);\n\t\t} while (next_permutation(perm, perm + 8));\n\t\t\n\t\tcout << res << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint N,M,Q;\nlong long ans[1003];\nvoid plot() {\n    rep(i,M) {\n        int count=0;\n        int val=0;\n        rep(j,N) {\n            if(((ans[i])>>j)&1) {\n                count++;\n                val=j;\n            }\n        }\n        if(count==1) {\n            if(val<10) printf(\"%d\",val);\n            else printf(\"%c\",'A'+val-10);\n        }\n        else cout<<\"?\";\n    }\n    cout<<endl;\n}\n\nvoid update(long long& mask, string S, string B) {\n    long long bit=0;\n    rep(i,N) if(S[i]=='1') bit|=1LL<<i;\n    mask^=bit;\n    // printf(\"%s->%s : %lx\\n\", stateS.c_str(),S.c_str(),bit);\n    rep(i,M) {\n        if(B[i] == '1') {\n            ans[i] &= mask;\n        }\n        else {\n            ans[i] &= ~mask;\n        }\n    }\n}\n\n\nvoid solve() {\n    \n    rep(i,1003) ans[i]=(1<<N)-1;\n    long long mask=0;\n    string S,B;\n    rep(i,Q) {\n        cin>>S>>B;\n        update(mask, S,B);\n\n        // rep(i,M) cout<<ans[i]<<\",\";\n        // cout<<endl;\n    }\n    plot();\n}\n\nint main() {\n    while(cin>>N>>M>>Q) {\n        if(N+M+Q==0) break;\n        solve();\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#define N 36\n#define M 1000\nusing namespace std;\n\nint main(){\n  int n,m,q,ans[N][M],a;\n  string s[M],b[M],sw,li;\n  vector<int> on,off,k,koff;\n  while(1){\n    cin>>n>>m>>q;\n    if(!n&&!m&&!q) break;\n    for(int i=0;i<q;i++) cin>>s[i]>>b[i];\n    for(int i=0;i<N;i++)\n      for(int j=0;j<M;j++) ans[i][j]=1;\n    for(int i=0;i<n;i++) sw+='0';\n    for(int i=0;i<m;i++) li+='0';\n    for(int i=0;i<q;i++){\n      for(int j=0;j<n;j++){\n\tif(sw[j]=='1'&&s[i][j]=='0') k.push_back(j);\n\tif(sw[j]=='0'&&s[i][j]=='1') on.push_back(j);\n\tif(sw[j]=='1'&&s[i][j]=='1') off.push_back(j);\n\tif(sw[j]=='0'&&s[i][j]=='0') koff.push_back(j);\n      }\n      for(int j=0;j<m;j++){\n\tif(li[j]=='1'&&b[i][j]=='1'){\n\t  for(int l=0;l<on.size();l++) ans[on[l]][j]=0;\n\t  for(int l=0;l<off.size();l++) ans[off[l]][j]=0;\n\t  for(int l=0;l<koff.size();l++) ans[koff[l]][j]=0;\n\t}\n\tif(li[j]=='1'&&b[i][j]=='0'){\n\t  for(int l=0;l<on.size();l++) ans[on[l]][j]=0;\n\t  for(int l=0;l<k.size();l++) ans[k[l]][j]=0;\n\t  for(int l=0;l<koff.size();l++) ans[koff[l]][j]=0;\n\t}\n\tif(li[j]=='0'&&b[i][j]=='1'){\n\t  for(int l=0;l<k.size();l++) ans[k[l]][j]=0;\n\t  for(int l=0;l<koff.size();l++) ans[koff[l]][j]=0;\n\t  for(int l=0;l<off.size();l++) ans[off[l]][j]=0;\n\t}\n\tif(li[j]=='0'&&b[i][j]=='0'){\n\t  for(int l=0;l<on.size();l++) ans[on[l]][j]=0;\n\t  for(int l=0;l<k.size();l++) ans[k[l]][j]=0;\n\t  for(int l=0;l<off.size();l++) ans[off[l]][j]=0;\n\t}\n      }\n      k.clear();\n      koff.clear();\n      on.clear();\n      off.clear();\n      for(int j=0;j<n;j++)\n\tif(s[i][j]=='1') sw[j]=='0'?sw[j]='1':sw[j]='0';\n      for(int j=0;j<m;j++) li[j]=b[i][j];\n    }\n    for(int i=0;i<m;i++){\n      a=-1;\n      for(int j=0;j<n;j++)\n\tif(ans[j][i]==1){\n\t  if(a==-1) a=j;\n\t  else{\n\t    a=-1;\n\t    break;\n\t  }\n\t}\n      if(a==-1) cout<<'?';\n      else{\n\tif(a<=9) cout<<a;\n\telse cout<<(char)('A'+a-10);\n      }\n    }\n    cout<<endl;\n    sw=\"\";\n    li=\"\";\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long Int;\n\nchar conv(int x)\n{\n\tif (x <= 9) return (x + '0');\n\treturn (x - 10 + 'A');\n}\n\nint main()\n{\n\tint N, M, Q;\n\tInt bits[1024], all;\n\n\twhile (scanf(\"%d %d %d\", &N, &M, &Q) && N){\n\t\tfor (int i = 0; i < M; i++){\n\t\t\tbits[i] = (1ll << N) - 1;\n\t\t}\n\t\tall = (1ll << N) - 1;\n\t\tInt mask = 0;\n\n\t\tfor (int i = 0; i < Q; i++){\n\t\t\tchar S[1024], B[1024];\n\t\t\tscanf(\"%s %s\", S, B);\n\n\t\t\tInt nxt = 0;\n\t\t\tfor (int j = N - 1; j >= 0; j--){\n\t\t\t\tnxt = (nxt << 1) | (S[j] - '0');\n\t\t\t}\n\t\t\t\n\t\t\tmask ^= nxt;\n\n\t\t\tfor (int j = 0; B[j]; j++){\n\t\t\t\tif (B[j] - '0') bits[j] &= mask;\n\t\t\t\telse bits[j] &= (~mask & all);\n\t\t\t}\n\t\t}\n\n\t\tfor (int i = 0; i < M; i++){\n\t\t\tif (__builtin_popcountll(bits[i]) == 1){\n\t\t\t\tprintf(\"%c\", conv(__builtin_ctzll(bits[i])));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tprintf(\"?\");\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"\\n\");\n\t}\n\n\treturn (0);\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\ntypedef long long ll;\nint N,M,Q;\nll s[4000],t[4000];\n\nll func(string str){\n  ll res=0;\n  reverse(str.begin(),str.end());\n  for(int i=0;i<(int)str.size();i++){\n    res*=2LL;\n    res+=(str[i]-'0');\n  }\n  return res;\n}\n\nint main(){\n  char change[36];\n  change[0]='0';\n  for(int i=1;i<10;i++)change[i]=change[i-1]+1;\n  change[10]='A';\n  for(int i=11;i<36;i++)change[i]=change[i-1]+1;\n\n  while(1){\n    cin>>N>>M>>Q;\n    if(N==0&&M==0&&Q==0)break;\n    for(int i=0;i<Q;i++){\n      string str,str2;\n      cin>>str>>str2;\n      s[i]=func(str);\n      t[i]=func(str2);\n      if(i){\n\ts[i]=s[i]^s[i-1];\n      }\n      //cout<<s[i]<<' '<<t[i]<<endl;\n    }\n    for(int i=0;i<M;i++){\n      ll f=(1LL<<N)-1;\n      for(int j=0;j<Q;j++){\n       \n\tif((t[j]>>i)&1){\n\t  f=f&s[j];\n\t}else {\n\t  f=f&((1LL<<N)-1LL-s[j]);\n\t}\n\n      }\n\n      // cout<<f<<endl;\n      if(__builtin_popcountll(f)==1){\n\tint ans=__builtin_ctzll(f);\n\tcout<<change[ans];\n      }else{\n\tcout<<'?';\n      }\n    }\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\nint n,m,q;\nbool d[1100][40],y[1100][1100],x[1100][1100];int p[1100];\nint main(){\n\twhile(true){\n\t\tcin>>n>>m>>q;\n\t\tif(n==0 && m==0 && q==0)break;\n\t\tfor(int i=0;i<1100;i++){\n\t\t\tp[i]=0;\n\t\t\tfor(int j=0;j<40;j++)d[i][j]=false;\n\t\t\tfor(int j=0;j<1100;j++){\n\t\t\t\tx[i][j]=false;y[i][j]=false;\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<q;i++){\n\t\t\tstring S=\"\",T=\"\";\n\t\t\tcin>>S>>T;\n\t\t\tfor(int j=0;j<n;j++){\n\t\t\t\tif(S[j]=='0')d[i][j]=false;\n\t\t\t\tif(S[j]=='1')d[i][j]=true;\n\t\t\t}\n\t\t\tfor(int j=0;j<m;j++){\n\t\t\t\tif(T[j]=='0')y[i][j]=false;\n\t\t\t\tif(T[j]=='1')y[i][j]=true;\n\t\t\t}\n\t\t\tif(i>=1){\n\t\t\t\tfor(int j=0;j<m;j++){\n\t\t\t\t\tx[i][j]=y[i-1][j]^y[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfor(int j=0;j<m;j++)x[i][j]=y[i][j];\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<m;i++){\n\t\t\tint siz=0,h=0;\n\t\t\tfor(int j=0;j<n;j++){\n\t\t\t\tint G=0;\n\t\t\t\tfor(int k=0;k<q;k++){\n\t\t\t\t\tif(d[k][j]!=x[k][i])G=1;\n\t\t\t\t}\n\t\t\t\tif(G==0){siz++;h=j;}\n\t\t\t}\n\t\t\tif(siz==1)p[i]=h;\n\t\t\telse{p[i]=-1;}\n\t\t}\n\t\tfor(int i=0;i<m;i++){\n\t\t\tif(p[i]==-1)cout<<'?';\n\t\t\telse if(p[i]<10)cout<<(char)('0'+p[i]);\n\t\t\telse{cout<<(char)('A'+p[i]-10);}\n\t\t}\n\t\tcout<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define debug(x) cout << \"debug \" << x << endl;\nconst int INF = 100000000;\nusing namespace std;\n\nchar output(int a){\n    if(a < 10){\n        return '0' + a;\n    }else{\n        return 'A' + (a - 10);\n    }\n}\n\nint main(){\n    int n, m, q;\n    while(cin >> n >> m >> q, n||m||q){\n        int d[40][1001];\n        rep(i,40) rep(j,1001) d[i][j] = -1;\n        string before;\n        rep(i,m) before+='0';\n\n        rep(i,q){\n            bool swi[40] = {0};\n            bool bul[1001] = {0};\n            string s, b;\n\n            cin >> s >> b;\n            rep(j,n) if(s[j] == '1') swi[j] = 1;\n            rep(j,m) if(b[j] != before[j]) bul[j] = 1;\n\n            bool x, y;\n            rep(j,n){\n                if(swi[j] == 1) x = true;\n                else x = false;\n                rep(k,m){\n                    if(bul[k] == 1) y = true;\n                    else y = false;\n\n                    if(x && y){\n                        if(d[j][k] == -1) d[j][k] = 1;\n                    }else if( (x && !y) || (!x && y) ){\n                        d[j][k] = 0;\n                    }\n                }\n            }\n            before = b;\n        }\n        //rep(j,n){ rep(k,m){ cout << d[j][k] << ' '; } cout << endl; }\n        if(n == 1){\n            rep(j,m) cout << 0 << endl;\n            continue;\n        }\n\n        rep(j,m){\n            int isNotZero = 0;\n            int out;\n            rep(i,n){\n                if(d[i][j] != 0){\n                    isNotZero++;\n                    out = i;\n                }\n            }\n            if(isNotZero == 1){\n                cout << output(out);\n            }else{\n                cout << '?';\n            }\n        }\n        cout << endl;\n        /*\n        bool swi[40] = {0};\n        rep(j,m){\n            int cnt = -1;\n            int num = 0;\n            rep(i,n){\n                if(swi[i]) num++;\n                if(d[i][j] == 1 && cnt > 0){\n                    cnt = -1;\n                }else if(d[i][j] == 1){\n                    cnt = i;\n                }\n            }\n            if(cnt != -1){\n                if(cnt < 10) cout << cnt;\n                else cout << static_cast<char>('A' + (cnt - 10));\n                swi[cnt] = 1;\n            }else if(num == n - 1){\n                rep(k,n){\n                    if(not swi[k]){\n                        if(k < 10) cout << k;\n                        else cout << static_cast<char>('A' + (k - 10));\n                        break;\n                    }\n                }\n            }else cout << '?';\n        }\n        cout << endl;\n        */\n    }\n}"
  },
  {
    "language": "C++",
    "code": "//#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<ll> VL;\ntypedef vector<VL> VVL;\ntypedef pair<int, int> PII;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define MP make_pair\n#define PB push_back\n#define MOD 1000000007\n#define INF (1LL<<30)\n#define LLINF (1LL<<60)\n#define PI 3.14159265359\n#define EPS 1e-12\n//#define int ll\n\n//string s[1010], b[1010];\nbool a[40];\nll c[40], cc[40], d[1010];\n//???????´??????? x???e???\nll binpow(ll x, ll e)\n{\n  ll a = 1, p = x;\n\n  while(e > 0) {\n    if(e%2 == 0) {p = (p*p); e /= 2;}\n    else {a = (a*p); e--;}\n  }\n\n  return a;\n}\n\nsigned main(void)\n{\n\twhile(true) {\n\t\tint n, m, q;\n\t\tcin >> n >> m >> q;\n\t\tif(!n && !m && !q) break;\n\t\t//REP(i, q) cin >> s[i] >> b[i];\n\n\t\tREP(i, n) {\n\t\t\ta[i] = false;\n\t\t\tc[i] = cc[i] = 0;\n\t\t}\n\t\tREP(i, m) d[i] = binpow(2, n)-1;\n\t\t//cout << \"a\" << endl;\n\t\tREP(i, q) {\n\t\t\tstring s, b;\n\t\t\tcin >> s >> b;\n\t\t\tREP(j, n) {\n\t\t\t\tif(s[j] == '1') a[j] = !a[j];\n\t\t\t}\n\t\t\tfor(int j=n-1; j>=0; --j) {\n\t\t\t\tif(a[j]) c[i] += (binpow(2, n-1-j));\n\t\t\t}\n\t\t\tREP(j, m) {\n\t\t\t\t//cout << \"j:\" << j << \" \" << d[j] << \" \" << b[j]<< endl;\n\t\t\t\tif(b[j] == '1') d[j] &= c[i];\n\t\t\t\telse d[j] &= ~c[i];\n\t\t\t}\n\n\t\t}\n\t\t//cout << \"b\" << endl;\n\t\t//REP(i, q) cout << c[i] << \" \"; cout << endl;\n\n\n\t\t//cout << \"c\" << endl;\n\t\t//REP(i, m) cout << d[i] << \" \"; cout << endl;\n\n\t\tREP(i, m) {\n\t\t\tint cnt = 0;\n\t\t\tVI e;\n\t\t\tREP(j, n) {\n\t\t\t\tif(d[i]>>j&1) {\n\t\t\t\t\tcnt++;\n\t\t\t\t\te.PB(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(cnt == 1) {\n\t\t\t\te[0] = n-1-e[0];\n\t\t\t\t//cout << \"e\" << e[0] << endl;\n\t\t\t\tif(e[0] < 10)\tcout << e[0];\n\t\t\t\telse cout << (char)(e[0]-10 + 'A');\n\t\t\t} else {\n\t\t\t\tcout << \"?\";\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n\nusing namespace std;\n\nint main() {\n  while(1){\n    int n,m,q;\n    cin>>n>>m>>q;\n    if (!n)break;\n    vector<bitset<1000>> ab(n);\n    REP(i,n) ab[i].set();\n    string state(m,'0');\n    REP(i,q){\n      string swt,ns;\n      cin>>swt>>ns;\n      REP(j,m)REP(k,n) {\n        if((ns[j] != state[j]) != (swt[k] == '1'))\n          ab[k][j] = false;\n      }\n      state = ns;\n    }\n    REP(i,m){\n      int cnt = 0;\n      int v = 0;\n      REP(j,n){\n        if(ab[j][i]) {\n          ++cnt;\n          v = j;\n        }\n      }\n      if (cnt != 1) cout << '?';\n      else if (v < 10) cout << (char)(v + '0');\n      else cout << (char)(v - 10 + 'A');\n    }\n    cout << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\n#define int long long\nusing namespace std;\ntypedef pair<int, int> P;\n\nsigned main(){\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    int n, m, q;    \n    while(1){\n        cin >> n >> m >> q;\n        if(n + m + q == 0) break;\n        vector<int> s(q + 1), d(m, (1LL << n) - 1);\n        vector<string> b(q + 1), ss(q + 1);\n        string tmp = \"\";\n        s[0] = 0;\n        rep(i, 0, m) tmp += \"0\";\n        b[0] = tmp;\n        rep(i, 1, q + 1){\n            cin >> ss[i] >> b[i];\n            s[i] = 0;\n            rep(j, 0, ss[i].size()){\n                s[i] *= 2;\n                if(ss[i][j] == '1') s[i]++;\n            }\n        } \n        rep(i, 0, q){\n            rep(j, 0, m){\n                if(b[i][j] != b[i + 1][j]){\n                    d[j] &= s[i + 1];\n                    // cout << i << ' ' << j << ' ' << d[j] << endl;                    \n                }else{\n                    d[j] &= (1LL << n) - 1LL - s[i + 1];\n                    int tmp = (1LL << n) - 1LL - s[i + 1];\n                    // cout << \" \" << i << ' ' << j << ' ' << d[j] << \" \" << tmp << \" \" << s[i + 1] << endl;\n                }\n            }\n        }\n        string ans = \"\";\n        rep(i, 0, m){\n            int cnt = 0;\n            char c;\n            for(int j = n - 1; j >= 0; j--){\n                if(d[i] & (1LL << j)){\n                    cnt++;\n                    int now = n - 1 - j;\n                    // cout << i << ' ' << now << endl;                    \n                    if(now < 10) c = '0' + now;\n                    else c = 'A' + now - 10;\n                }\n            }\n            if(cnt != 1) c = '?';\n            ans += c;\n        }\n        cout << ans << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\nusing namespace std;\n\nint main(){\n    int n, m, q;\n    while(cin >> n >> m >> q, n||m||q){\n        int a[37][1005];\n        memset(a, -1, sizeof(a)); //1:テ・ツ渉ッティツδステヲツ?ァテ」ツ?づ」ツつ?0:テ・ツ渉ッティツδステヲツ?ァテ」ツ?ェテ」ツ??-1:テ」ツつ湘」ツ?凝」ツつ嘉」ツ?ェテ」ツ??\n\n        if(q == 0 && n == 1){\n            rep(i,m) cout << 0;\n            cout << endl;\n            continue;\n        }\n        string sb, bb;\n        rep(i,n) sb+='0';\n        rep(j,m) bb+='0';\n        rep(i,q){\n            string s, b;\n            cin >> s >> b;\n            rep(j,n){\n                if(s[j] == '1'){\n                    rep(k,m){\n                        if(b[k] != bb[k]){\n                            //cout << j << ' ' << k << endl;\n                            if(a[j][k] != 0) a[j][k] = 1;\n                        }else{\n                            if(a[j][k] != 0) a[j][k] = 0;\n                        }\n                    }\n                }else{\n                    rep(k,m){\n                        if(b[k] != bb[k]){\n                            //cout << j << ' ' << k << endl;\n                            if(a[j][k] != 0) a[j][k] = 0;\n                        }else{\n                            if(a[j][k] != 0) a[j][k] = 1;\n                        }\n                    }\n                }\n            }\n            sb = s;\n            bb = b;\n        //rep(i,3){ rep(j,10){ cout << a[i][j]; } cout << endl; } cout << endl;\n        }\n\n        rep(j,m){\n            int is_not_zero = 0;\n            char c = '?';\n            rep(i,n){\n                if(a[i][j] != 0) {\n                    is_not_zero++;\n                    if(c == '?'){\n                        if(i >= 0 && i <= 9) c = i + '0';\n                        else c = (i - 10) + 'A';\n                    }\n                }\n            }\n            if(is_not_zero == 1) cout << c;\n            else cout << '?';\n        }\n        cout << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nchar ans_c(int c){\n\tif (c < 10)\n\t\treturn '0'+c;\n\treturn 'A' + c - 10;\n}\n\nint main() {\n\tint N, M, Q;\n\twhile (cin >> N >> M >> Q, N){\n\t\tstring switch_s;\n\t\tstring light_s;\n\t\tstring blight_s;\n\t\tvector<vector<bool>> vvb(M,vector<bool>(N,true));\n\t\tREP(i, M)\n\t\t\tblight_s.append(i,'0');\n\n\t\tREP(i, Q){\n\t\t\tcin >> switch_s;\n\t\t\tcin >> light_s;\n\t\t\t//-----------//\n\t\t\tREP(j, N){\n\t\t\t\tREP(k, M){\n\t\t\t\t\tif ((switch_s[j]=='0') != (light_s[k] == blight_s[k])){\n\t\t\t\t\t\tvvb[k][j]=false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//-----------//\n\t\t\tblight_s = light_s;\n\t\t}\n\n\t\tREP(i,M){\n\t\t\tint count = 0;\n\t\t\tint ans = 0;\n\t\t\tREP(j, N){\n\t\t\t\tif (vvb[i][j]){\n\t\t\t\t\tcount++;\n\t\t\t\t\tans = j;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (count == 1)cout << ans_c(ans);\n\t\t\telse cout << '?';\n\t\t}\n\t\tcout << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<cstring>\n#include<vector>\n#include<set>\n#include<list>\n#include<queue>\n#include<cmath>\n#include<functional>\n#include<algorithm>\n#define INF (1<<29)\n#define rep(i,n) for(int i=0;i<(n);i++)\nusing namespace std;\n\n\n\nint bits_ctz(unsigned long long b){\n\tb&=-b;\n\tint res=0;\n\tfor(int i=5;i>=0;i--){\n\t\tint shift=1<<i;\n\t\tif(b>>shift){\n\t\t\tb>>=shift;\n\t\t\tres|=shift;\n\t\t}\n\t}\n\treturn res;\n}\n\n\nint main(){\n\tint n,m,q;\n\tlong long maybe[1000];\n\twhile(cin>>n>>m>>q,n|m|q){\n\t\tfill_n(maybe,m,(1LL<<n)-1);\n\t\tlong long switches=0;\n\t\trep(i,q){\n\t\t\tlong long s=0,b=0;\n\t\t\tstring str;\n\t\t\tcin>>str;\n\t\t\trep(i,n)s|=(long long)(str[i]-'0')<<(i);\n\t\t\tcin>>str;\n\t\t\trep(i,m)b|=(long long)(str[i]-'0')<<(i);\n\t\t\tswitches^=s;\n\t\t\trep(i,m){\n\t\t\t\tif(b>>i&1){\n\t\t\t\t\tmaybe[i]&=switches;\n\t\t\t\t}else{\n\t\t\t\t\tmaybe[i]&=~switches;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\trep(i,m){\n\t\t\tif(maybe[i]&maybe[i]-1){\n\t\t\t\tcout<<'?';\n\t\t\t}else{\n\t\t\t\tint ctz=bits_ctz(maybe[i]);\n\t\t\t\tif(ctz<10)cout<<ctz;\n\t\t\t\telse cout<<char('A'+ctz-10);\n\t\t\t}\n\t\t}\n\t\tcout<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\ntypedef pair<int,int>pint;\ntypedef vector<int>vint;\ntypedef vector<pint>vpint;\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define se second\n#define all(v) (v).begin(),(v).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define reps(i,f,n) for(int i=(f);i<(n);i++)\n#define each(it,v) for(__typeof((v).begin()) it=(v).begin();it!=(v).end();it++)\ntemplate<class T,class U>inline void chmin(T &t,U f){if(t>f)t=f;}\ntemplate<class T,class U>inline void chmax(T &t,U f){if(t<f)t=f;}\n\nint N,M,Q;\n\nbool ok[36][1000];\nbool state[1000],nxstate[1000];\n\nvoid solve(){\n    rep(i,N)rep(j,M)ok[i][j]=true;\n    rep(i,M)state[i]=false;\n    bool isput[36];\n    rep(i,Q){\n        rep(j,N){\n            char c;scanf(\" %c\",&c);\n            isput[j]=c=='1';\n        }\n        rep(j,M){\n            char c;scanf(\" %c\",&c);\n            nxstate[j]=c=='1';\n        }\n\n        rep(j,M){\n            rep(k,N){\n                if(state[j]==nxstate[j]&&isput[k])ok[k][j]=false;\n                else if(state[j]!=nxstate[j]&&!isput[k])ok[k][j]=false;\n            }\n        }\n        rep(j,M)state[j]=nxstate[j];\n    }\n\n    rep(i,M){\n        int cnt=0;\n        rep(j,N)cnt+=ok[j][i];\n        if(cnt!=1)printf(\"?\");\n        else{\n            int s;\n            rep(j,N)if(ok[j][i])s=j;\n            if(s<10)printf(\"%d\",s);\n            else printf(\"%c\",'A'+s-10);\n        }\n    }\n    puts(\"\");\n}\n\nsigned main(){\n    while(scanf(\"%d%d%d\",&N,&M,&Q),N||M||Q)solve();\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(){\n\n  int N,M,Q;\n    \n  while(1){\n    cin >>N>>M>>Q;\n    if(N+M+Q == 0)break;\n    char s[1100][50],l[1100][1100];\n    int data[N][M];\n    \n    for(int i=0 ; i < Q ; i++)scanf(\"%s%s\",s[i],l[i]);;\n    \n    for(int i=0 ; i < N ; i++)\n      for(int j=0 ; j < M ; j++)\n\tdata[i][j]=1;\n\n    for(int i=0 ; i < Q-1 ; i++){\n      for(int j=0 ; j < N ; j++){\n\tif(s[i][j] == '1'){\n\t  if(s[i+1][j] == '1'){\n\t    s[i+1][j]='0';\n\t  }else{\n\t    s[i+1][j]='1';\n\t  }\n\t}\n      }\n    }\n    \n    for(int i=0 ; i < Q ; i++){\n      for(int j=0 ; j < N ; j++){\n\tfor(int k=0 ; k < M ; k++){\n\t  if(s[i][j] != l[i][k])data[j][k] = 0;\n\t}\n      }\n    }\n\n    for(int i=0 ; i < M ; i++){\n      int cnt=0;\n      int num;\n      for(int j=0 ; j < N ; j++){\n\tcnt+=data[j][i];\n\tif(data[j][i])num=j;\n      }\n      if(cnt == 1){\n\tif(num <= 9){\n\t  cout <<num;\n\t}else{\n\t  cout <<(char)('A'+num-10);\n\t}\n      }else{\n\tcout <<'?';\n      }\n    }\n    cout <<endl;\n    \n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  while(1){\n  char c,ans[1001];\n  int n,m,q,cnt=0,f[37][1001],s[37]={},b[1001]={};\n  cin>>n>>m>>q;\n  if(n+m+q==0) break;\n     for(int i=0;i<n;i++)\n       for(int j=0;j<n;j++)f[i][j]=1;\n   \n  while(cnt<q){\n    cnt++;\n    for(int i=0;i<n;i++)cin>>c,s[i]=(s[i]+(c-'0'))%2;\n    for(int i=0;i<m;i++)cin>>c,b[i]=c-'0';\n    \n    for(int i=0;i<n;i++)\n      for(int j=0;j<m;j++){\n\tif(f[i][j]==2) continue;\n\telse if(s[i]==b[j])f[i][j]=1;\n\telse f[i][j]=2;\n      }\n    }\n  \n  for(int j=0;j<m;j++){\n    int flag=0;\n    for(int i=0;i<n;i++){\n      if(f[i][j]==1 && flag==0){\n\tflag=1;\n\tif(i>=0 && i<=9)ans[j]=i+'0';\n\telse ans[j]=i-10+'A';\n      }else if(flag==1 && f[i][j]==1)ans[j]='?';\n    }\n   }\n  \n  for(int i=0;i<m;i++)cout<<ans[i];\n  cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#define Q 1000\n#define N 36\nusing namespace std;\n\nint main(){\n  int n,m,q;\n  char ans[Q];\n  bool sw[N],swb[N],li[Q],fl[Q],fln[N],fle[Q];\n  string s[Q],b[Q];\n  vector<int> on,off,r;\n  while(1){\n    cin>>n>>m>>q;\n    if(!n&&!m&&!q) break;\n    for(int i=0;i<q;i++) cin>>s[i]>>b[i];\n    for(int i=0;i<n;i++) sw[i]=swb[i]=fln[i]=false;\n    for(int i=0;i<m;i++) ans[i]='?',li[i]=fl[i]=fle[i]=false;\n    for(int i=0;i<q;i++){\n      for(int j=0;j<n;j++) swb[j]=sw[j];\n      for(int j=0;j<n;j++)\n\tif(s[i][j]=='1') sw[j]?sw[j]=false:sw[j]=true;\n      for(int j=0;j<n;j++){\n\tif(swb[j]&&sw[j]) r.push_back(j);\n\telse if(swb[j]&&!sw[j]) off.push_back(j);\n\telse if(sw[j]) on.push_back(j);\n      }\n      for(int j=0;j<n;j++)\n\tif(fln[j]){\n\t  for(int k=0;k<on.size();k++)\n\t    if(j==on[k]) on.erase(on.begin()+k);\n\t  for(int k=0;k<off.size();k++)\n\t    if(j==off[k]) off.erase(off.begin()+k);\n\t  for(int k=0;k<r.size();k++)\n\t    if(j==r[k]) r.erase(r.begin()+k);\n\t}\n      if(on.size()==1)\n\tfor(int j=0;j<m;j++)\n\t  if(!li[j]&&b[i][j]=='1'){\n\t    if(!fl[j]){\n\t      if(on[0]<=9) ans[j]=on[0]+'0';\n\t      else ans[j]=on[0]+'A'-10;\n\t      fl[j]=fln[j]=true;\n\t    }\n\t    else ans[j]='?',fle[j]=true;\n\t  }\n      if(off.size()==1)\n\tfor(int j=0;j<m;j++)\n\t  if(li[j]&&b[i][j]=='0'){\n\t    if(!fl[j]){\n\t      if(off[0]<=9) ans[j]=off[0]+'0';\n\t      else ans[j]=off[0]+'A'-10;\n\t      fl[j]=fln[j]=true;\n\t    }\n\t    else ans[j]='?',fle[j]=true;\n\t  }\n      if(r.size()==1)\n\tfor(int j=0;j<m;j++)\n\t  if(li[j]&&b[i][j]=='1'){\n\t    if(!fl[j]){\n\t      if(r[0]<=9) ans[j]=r[0]+'0';\n\t      else ans[j]=r[0]+'A'-10;\n\t      fl[j]=fln[j]=true;\n\t    }\n\t    else ans[j]='?',fle[j]=true;\n\t  }\n      for(int j=0;j<m;j++)\n\tb[i][j]=='1'?li[j]=true:li[j]=false;\n      on.clear();\n      off.clear();\n      r.clear();\n    }\n    int cnt=0,a;\n    for(int i=0;i<n;i++)\n      if(!fln[i]) cnt++,a=i;\n    if(cnt==1)\n      for(int i=0;i<m;i++)\n\tif(ans[i]=='?'&&!fle[i]){\n\t  if(a<=9) ans[i]=a+'0';\n\t  else ans[i]=a+'A'-10;\n\t}\n    for(int i=0;i<m;i++) cout<<ans[i];\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <bitset>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <tuple>\n#include <queue>\n#include <set>\n#include <cstdio>\n#include <climits>\n#include <cmath>\n#include <array>\n#include <functional>\n#include <sstream>\n#include <list>\n#include <iomanip>\n#include <set>\nconst int MOD=1000000007;\nconst int INF=1000000000;\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\nconst double eps=1e-9;\nconst int inf=1e9;\ntypedef pair<int,int> P;\nstruct Point\n{\n  double x,y;\n  Point(){x=0;y=0;}\n  Point(double d_x,double d_y){x=d_x,y=d_y;}\n  double operator*(Point obj){return obj.x*x+obj.y*y;}\n  double operator%(Point obj){return obj.y*x-obj.x*y;}\n  Point operator*(double b){Point tmp;tmp.x=x*b;tmp.y=y*b;return tmp;}\n  Point operator/(double b){Point tmp;tmp.x=x/b;tmp.y=y/b;return tmp;}\n  Point operator+(Point obj){Point tmp;tmp.x=x+obj.x;tmp.y=y+obj.y;return tmp;}\n  Point operator-(){Point tmp;tmp.x=-x;tmp.y=-y;return tmp;}\n  Point operator-(Point obj){Point tmp;tmp.x=x-obj.x;tmp.y=y-obj.y;return tmp;}\n  Point operator-=(Point obj){x-=obj.x;y-=obj.y;return *this;}\n  Point operator+=(Point obj){x+=obj.x;y+=obj.y;return *this;}\n  Point operator/=(double b){x=x/b;y=y/b;return *this;}\n  Point operator*=(double b){x=x*b;y=y*b;return *this;}\n  double size(){return hypot(x,y);}\n  Point unit(){return Point(x/size(),y/size());}\n  Point normal(){return Point(y,-x);}\n  double atan(){return atan2(y,x);}\n};\n\nbool operator<(Point a,Point b){return a.x!=b.x?a.x<b.x:a.y<b.y;}\nbool operator>(Point a,Point b){return b<a;}\nbool operator<=(Point a,Point b){return !(b<a);}\nbool operator>=(Point a,Point b){return !(a<b);}\nbool operator==(Point a,Point b){return (a-b).size()<eps;}\nbool operator!=(Point a,Point b){return !(a==b);}\n\nbool equal(double a,double b){return abs(a-b)<eps;}\ndouble cross(Point a,Point b){return a%b;}\ndouble dot(Point a,Point b){return a*b;}\n\nint ccw(Point a,Point b,Point c)\n{\n  b=b-a;\n  c=c-a;\n  if(b%c>0) return +1;\n  else if(b%c<0)return -1;\n  else if(b*c<0) return +2;\n  else if(b.size()<c.size()) return -2;\n  else return 0;\n}\n\nchar tochar(int i)\n{\n  if(i<10) return (char)('0' + i);\n  else return (char) ('A'+(i-10));\n}\n\nint n,m,q,cnt;\n\nint main(int argc,char const* argv[])\n{\n  while(1)\n    {\n      cin >> n >> m >> q;\n      if(n==0 && m==0 && q==0) break;\n      char c,ans[1005];\n      int f[37][1005],s[37]={},b[1005];\n      for(int i=0;i<n;i++)\n\t{\n\t  for(int j=0;j<m;j++)\n\t    {\n\t      f[i][j]=1;\n\t    }\n\t}\n      for(int i=0;i<q;i++)\n\t{\n\t  for(int i=0;i<n;i++) cin>>c,s[i]=(s[i]+(c-'0'))%2;\n\t  for(int i=0;i<m;i++) cin>>c,b[i]=c-'0';\n\n\t  for(int i=0;i<n;i++)\n\t      for(int j=0;j<m;j++)\n\t\t{\n\t\t  if(f[i][j]==2) continue;\n\t\t  else if(s[i]==b[j]) f[i][j]=1;\n\t\t  else f[i][j]=2;\n\t\t}\n\t}\n      for(int j=0;j<m;j++)\n\t{\n\t  int flag=0;\n\t  for(int i=0;i<n;i++)\n\t    {\n\t      if(f[i][j]==1 && flag==0)\n\t\t{\n\t\t  flag=1;\n\t\t  ans[j]=tochar(i);\n\t\t}\n\t      else if(f[i][j]==1 && flag==1) ans[j]='?';\n\t    }\n\t}\n      for(int i=0;i<m;i++)\n\t{\n\t  cout << ans[i];\n\t}\n      cout << endl;\n    }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n  string base36 = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ?\";\n  int N, M, Q;\n  while(cin >> N >> M >> Q, N || M || Q){\n    long long bulb[1000]; memset(bulb, -1LL, sizeof(bulb));\n    long long swch = 0LL;\n    for(int i = 0; i < Q; i++){\n      string S, B;\n      cin >> S >> B;\n      long long s = 0LL, b = 0LL;\n      for(int j = 0; j < S.size(); j++) s |= (((S[j]=='1')&1LL) << j);\n      for(int j = 0; j < B.size(); j++) b |= (((B[j]=='1')&1LL) << j);\n      swch ^= s;\n      for(int j = 0; j < M; j++){\n\tif((b >> j) & 1LL){\n\t  bulb[j] &= swch;\n\t} else {\n\t  bulb[j] &= ~swch;\n\t}\n      }\n    }\n    for(int i = 0; i < M; i++){\n      int ctrl = -1;\n      int cnt = 0;\n      for(int j = 0; j < N; j++){\n\tif((bulb[i] >> j) & 1LL) cnt++, ctrl = j;\n      }\n      if(cnt == 1) cout << base36[ctrl];\n      else cout << \"?\";\n    }\n    cout << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// Header {{{\n// includes {{{\n#include <algorithm>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <iostream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <sys/time.h>\n#include <unistd.h>\n#include <vector>\n// }}}\nusing namespace std;\n// consts {{{\nstatic const int INF = 1e9;\nstatic const double PI = acos(-1.0);\nstatic const double EPS = 1e-10;\n// }}}\n// typedefs {{{\ntypedef long long int LL;\ntypedef unsigned long long int ULL;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\ntypedef vector<ULL> VULL;\ntypedef vector<VULL> VVULL;\ntypedef vector<double> VD;\ntypedef vector<VD> VVD;\ntypedef vector<bool> VB;\ntypedef vector<VB> VVB;\ntypedef vector<char> VC;\ntypedef vector<VC> VVC;\ntypedef vector<string> VS;\ntypedef vector<VS> VVS;\ntypedef pair<int, int> PII;\ntypedef complex<int> P;\n// }}}\n// macros & inline functions {{{\n// syntax sugars {{{\n#define FOR(i, b, e) for (typeof(e) i = (b); i < (e); ++i)\n#define FORI(i, b, e) for (typeof(e) i = (b); i <= (e); ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define REPI(i, n) FORI(i, 0, n)\n#define OPOVER(_op, _type) inline bool operator _op (const _type &t) const\n// }}}\n// conversion {{{\ninline int toInt(string s) { int v; istringstream sin(s); sin>>v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout<<x; return sout.str(); }\n// }}}\n// array and STL {{{\n#define ARRSIZE(a) ( sizeof(a) / sizeof(a[0]) )\n#define ZERO(a, v) ( assert(v == 0 || v == -1), memset(a, v, sizeof(a)) )\n#define F first\n#define S second\n#define MP(a, b) make_pair(a, b)\n#define SIZE(a) ((LL)a.size())\n#define PB(e) push_back(e)\n#define SORT(v) sort((v).begin(), (v).end())\n#define RSORT(v) sort((v).rbegin(), (v).rend())\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EACH(c, it) for(typeof((c).begin()) it=(c).begin(); it!=(c).end(); ++it)\n#define REACH(c, it) for(typeof((c).rbegin()) it=(c).rbegin(); it!=(c).rend(); ++it)\n#define EXIST(s, e) ((s).find(e) != (s).end())\n// }}}\n// bit manipulation {{{\n// singed integers are not for bitwise operations, specifically arithmetic shifts ('>>', and maybe not good for '<<' too)\n#define IS_UNSIGNED(n) (!numeric_limits<typeof(n)>::is_signed)\n#define BIT(n) (assert(IS_UNSIGNED(n)), assert(n < 64), (1ULL << (n)))\n#define BITOF(n, m) (assert(IS_UNSIGNED(n)), assert(m < 64), ((ULL)(n) >> (m) & 1))\ninline int BITS_COUNT(ULL b) { int c = 0; while(b != 0) { c += (b & 1); b >>= 1; } return c; }\ninline int MSB(ULL b) { int c = 0; while(b != 0) { ++c; b >>= 1; } return c-1; }\ninline int MAKE_MASK(ULL upper, ULL lower) { assert(lower < 64 && upper < 64 && lower <= upper); return (BIT(upper) - 1) ^ (BIT(lower) - 1); }\n// }}}\n// for readable code {{{\n#define EVEN(n) (n % 2 == 0)\n#define ODD(n) (!EVEN(n))\n// }}}\n// debug {{{\n#define arrsz(a) ( sizeof(a) / sizeof(a[0]) )\n#define dprt(fmt, ...) if (opt_debug) { fprintf(stderr, fmt, ##__VA_ARGS__); }\n#define darr(a) if (opt_debug) { copy( (a), (a) + arrsz(a), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define darr_range(a, f, t) if (opt_debug) { copy( (a) + (f), (a) + (t), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define dvec(v) if (opt_debug) { copy( ALL(v), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define darr2(a) if (opt_debug) { FOR(__i, 0, (arrsz(a))){ darr( (a)[__i] ); } }\n#define dvec2(v) if (opt_debug) { FOR(__i, 0, v.size()){ dvec( (v)[__i] ); } }\n#define WAIT() if (opt_debug) { string _wait_; cerr << \"(hit return to continue)\" << endl; getline(cin, _wait_); }\n#define dump(x) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #x << \" = \" << (x) << endl; }\n#define dumpf() if (opt_debug) { cerr << __PRETTY_FUNCTION__ << endl; }\n#define dumpv(x) if (opt_debug) { cerr << \" [L:\" << __LINE__ << \"] \" << #x << \" = \"; REP(q, (x).size()) cerr << (x)[q] << \" \"; cerr << endl; }\n#define where() if (opt_debug) { cerr << __FILE__ << \": \" << __PRETTY_FUNCTION__ << \" [L: \" << __LINE__ << \"]\" << endl; }\n#define show_bits(b, s) if(opt_debug) { REP(i, s) { cerr << BITOF(b, s-1-i); if(i%4 == 3) cerr << ' '; } cerr << endl; }\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& s, const pair<T1, T2>& d) {return s << \"(\" << d.first << \", \" << d.second << \")\";}\ntemplate<typename T> ostream& operator<<(ostream& s, const complex<T>& d) {return s << \"(\" << d.real() << \", \" << d.imag() << \")\";}\n// }}}\n// }}}\n// time {{{\ninline double now(){ struct timeval tv; gettimeofday(&tv, NULL); return (static_cast<double>(tv.tv_sec) + static_cast<double>(tv.tv_usec) * 1e-6); }\n// }}}\n// string manipulation {{{\ninline VS split(string s, char delimiter) { VS v; string t; REP(i, s.length()) { if(s[i] == delimiter) v.PB(t), t = \"\"; else t += s[i]; } v.PB(t); return v; }\ninline string join(VS s, string j) { string t; REP(i, s.size()) { t += s[i] + j; } return t; }\n// }}}\n// geometry {{{\n#define Y real()\n#define X imag()\n// }}}\n// 2 dimentional array {{{\nP dydx4[4] = { P(-1, 0), P(0, 1), P(1, 0), P(0, -1) };\nP dydx8[8] = { P(-1, 0), P(0, 1), P(1, 0), P(0, -1), P(-1, 1), P(1, 1), P(1, -1), P(-1, -1) };\nint g_height, g_width;\nbool in_field(P p) {\n\treturn (0 <= p.Y && p.Y < g_height) && (0 <= p.X && p.X < g_width);\n}\n// }}}\n// }}}\nbool opt_debug = false;\n\nstring str_xor(string a, string b) {\n\tassert(a.length() == b.length());\n\tstring res = \"\";\n\tREP (i, a.length()) {\n\t\tif (a[i] != b[i]) {\n\t\t\tres += '1';\n\t\t} else {\n\t\t\tres += '0';\n\t\t}\n\t}\n\treturn res;\n}\n\nchar int_to_base36(int n) {\n\tif (0 <= n && n <= 9) {\n\t\treturn n + '0';\n\t} else {\n\t\treturn 'A' + n - 10;\n\t}\n}\n\nint main(int argc, char** argv) {\n\tstd::ios_base::sync_with_stdio(false);\n\t// set options {{{\n\tint __c;\n\twhile ( (__c = getopt(argc, argv, \"d\")) != -1 ) {\n\t\tswitch (__c) {\n\t\t\tcase 'd':\n\t\t\t\topt_debug = true;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tabort();\n\t\t}\n\t}\n\t// }}}\n\n\tint N, M, Q;\n\twhile (cin >> N >> M >> Q, N || M || Q) {\n\t\tVVB sw(M, VB(N, true));\n\t\tstring pS(N, '0'), pB(M, '0');\n\t\tREP (k, Q) {\n\t\t\tstring S, B;\n\t\t\tcin >> S >> B;\n\t\t\tstring cB = str_xor(B, pB);\n\t\t\tdump(cB);\n\t\t\tREP (i, cB.length()) {\n\t\t\t\tif (cB[i] == '0') {\n\t\t\t\t\t// no change\n\t\t\t\t\tREP (j, S.length()) {\n\t\t\t\t\t\tif (S[j] == '1') {\n\t\t\t\t\t\t\tsw[i][j] = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// changed\n\t\t\t\t\tREP (j, S.length()) {\n\t\t\t\t\t\tif (S[j] == '0') {\n\t\t\t\t\t\t\tsw[i][j] = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tdprt(\"==========\\n\");\n\t\t\tdvec2(sw);\n\t\t\tpB = B;\n\t\t}\n\n\t\tREP (i, M) {\n\t\t\tchar t = '@';\n\t\t\tREP (j, N) {\n\t\t\t\tif (sw[i][j]) {\n\t\t\t\t\tif (t != '@') {\n\t\t\t\t\t\tt = '?';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tt = int_to_base36(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcout << t;\n\t\t}\n\t\tcout << endl;\n\t}\n\n\treturn 0;\n}\n\n// vim: foldmethod=marker"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\n\nint N,M,Q;\nbool valid[1010][40],switchState[40];\nstring S,B;\n\nvoid update(){\n  rep(i,N) {\n    if( S[i] == '1' ) switchState[i] = !switchState[i];\n    rep(j,M) if( ( B[j] - '0' ) != switchState[i] ) valid[j][i] = false;\n  }\n}\n\nint main(){\n  vector<char> alnum;\n  rep(i,10) alnum.push_back((char)('0'+i));\n  rep(i,26) alnum.push_back((char)('A'+i));\n  while( cin >> N >> M >> Q, N|M|Q ){\n    memset(valid,true,sizeof(valid));\n    memset(switchState,false,sizeof(switchState));\n    rep(_,Q){\n      cin >> S >> B;\n      update();\n    }\n    rep(i,M) {\n      int pos = -1;\n      int cnt = 0;\n      rep(j,N) if( valid[i][j] ) { ++cnt, pos = j; if( cnt >= 2 ) break; }\n      if( cnt == 1 ) printf(\"%c\",alnum[pos]);\n      else           printf(\"?\");\n    } puts(\"\");\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\nusing namespace std;\nint n,m,t;\nmain()\n{\n\twhile(cin>>n>>m>>t,n)\n\t{\n\t\tstring s[1001],b[1001];\n\t\ts[0]=string(n,'0');\n\t\tb[0]=string(m,'0');\n\t\tfor(int i=0;i++<t;)cin>>s[i]>>b[i];\n\t\tstring ans(m,'?');\n\t\tfor(int i=0;i<m;i++)\n\t\t{\n\t\t\tbool ok[36]={};\n\t\t\tfor(int j=0;j<n;j++)ok[j]=1;\n\t\t\tfor(int j=0;j++<t;)\n\t\t\t{\n\t\t\t\tif(b[j-1][i]!=b[j][i])\n\t\t\t\t{\n\t\t\t\t\tfor(int k=0;k<n;k++)ok[k]&=s[j][k]=='1';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfor(int k=0;k<n;k++)ok[k]&=s[j][k]=='0';\n\t\t\t\t}\n\t\t\t}\n\t\t\tint cnt=0,mi;\n\t\t\tfor(int j=0;j<n;j++)if(ok[j])cnt++,mi=j;\n\t\t\tif(cnt==1)\n\t\t\t{\n\t\t\t\tans[i]=(char)(mi<10?mi+'0':mi-10+'A');\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<cstdio>\n#include<map>\n#include<algorithm>\n#include<string>\n#include<cmath>\n\nusing namespace std;\nint main(){\n\tint N,M,Q;\n\tstring S,B;\n\tstring C;\n\tint offF =0,onF=0;\n\tint *offi,*oni;\n\tstring sigma =\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\n\n\twhile(1){\n\t\tcin >> N >> M >> Q;\n\t\tif(N==0 && M==0 && Q==0)break;\n\t\tC=\"\";\n\t\toffi = new int[M];\n\t\toni = new int[M];\n\t\tfor(int i=0;i<M;i++){\n\t\t\tC+=\"?\";\n\t\t\toffi[i]=-1;\n\t\t\toni[i]=-1;\n\t\t}\n\t\t//0会の時\n\t\tif(Q==0){\n\t\t\tif(M==1){\n\t\t\t\tcout << 0 <<endl;\n\t\t\t\tcontinue;\n\t\t\t}else{\n\t\t\t\tcout << C << endl;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\toffF =0,onF=0;\n\t\tcin>>S>>B;\n\t\t//最初の一回\n\t\tchar off='?',on='?';\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(S[i]=='0') {\n\t\t\t\toffF++;\n\t\t\t\tif(offF==1) off=sigma[i];\n\t\t\t}if(S[i]=='1'){\n\t\t\t\tonF++;\n\t\t\t\tif(onF==1) on=sigma[i];\n\t\t\t}  \n\t\t}\n\t\tif(offF==1){\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='0'){\n\t\t\t\t\tC[i]=off;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tif(onF==1){\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='1'){\n\t\t\t\t\tC[i]=on;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\t//2~n-1まで\n\t\tstring prevB = \"\";\n\t\tfor(int k=0;k<M;k++){ prevB += B[k];}\n\t\tstring B2 = \"\";\n\t\tfor(int q=1;q<Q;q++){\n\t\t\toffF =0,onF=0;\n\t\t\tB2 = \"\";\n\t\t\tcin>>S>>B;\n\t\t\t//cout<< S <<endl;\n\t\t\t//cout<< \"B:\" <<B <<endl;\n\t\t\t//cout<< \"prevB:\" << prevB <<endl;\n\t\t\t//cout<< \"C:\" << C <<endl;\n\n\t\t\tfor(int j=0;j<M;j++){\n\t\t\t\tB2 += sigma[abs(prevB[j] - B[j])];\n\t\t\t}\n\t\t\t//cout << \"B2:\" << B2 << endl;\n\t\t\tchar off,on;\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='0' && C[i]=='?') {\n\t\t\t\t\toffF++;\n\t\t\t\t\tif(offF==1) off=sigma[i];\n\t\t\t\t}\n\t\t\t\tif(S[i]=='1' && C[i]=='?'){\n\t\t\t\t\tonF++;\n\t\t\t\t\tif(onF==1) on=sigma[i];\n\t\t\t\t}  \n\t\t\t}\n\t\t\t//cout << \"flag : \" << offF << onF << endl;\n\n\t\t\tif(offF==1){\n\t\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\t\tif(S[i]=='0'){\n\t\t\t\t\t\tfor(int j=0; j<M; j++){\n\t\t\t\t\t\t\tif(B2[j] == '0' && C[j]=='?'){ \n\t\t\t\t\t\t\t\tC[j] = off;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t}\n\t\t\tif(onF==1){\n\t\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\t\tif(S[i]=='1'){\n\t\t\t\t\t\tfor(int j=0; j<M; j++){\n\t\t\t\t\t\t\tif(B2[j] == '1' && C[j]=='?'){ \n\t\t\t\t\t\t\t\tC[j] = on;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\t\n\t\t\t}\n\t\t\tprevB = B;\n\n\t\t}\n\t\t\n\t\tint *check = new int[N];\n\t\tint a,flg=0;\n\t\tfor(int i=0;i<N;i++) check[i] = 0;\n\n\t\tfor(int i=0; i<M; i++){\n\t\t\tcheck[(int)(C[i]-'0')] = 1;\n\t\t}\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(check[i]==0){\n\t\t\t\ta = i;\n\t\t\t\tflg++;\n\t\t\t}\n\t\t}\n\t\tif(flg==1){\n\t\t\tfor(int i=0; i<M; i++){\n\t\t\t\tif(C[i]=='?') C[i] = sigma[a];\n\t\t\t}\n\t\t}\n\n\t\tcout << C << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr, __VA_ARGS__)\n//#define LOG(...)\n#define FOR(i, a, b) for(int i = (int)(a); i < (int)(b); ++i)\n#define REP(i, n) for(int i = 0; i < (int)(n); ++i)\n#define RREP(i, n) for(int i = (int)(n - 1); i >= 0; --i)\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EXIST(s, e) ((s).find(e) != (s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n#define SQ(n) (n) * (n)\n#define BIT(x, i) (((x) >> (i)) & 1)\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<char> vc;\ntypedef vector<pii> vpi;\ntypedef vector<pll> vpl;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vc> vvc;\ntypedef vector<vll> vvll;\n\ntypedef bitset<64> SW;\ntypedef bitset<1024> BL;\n\nint main() {\n  unordered_map<SW, int> num;\n  REP(i, 64){\n    num[1ULL << i] = i;\n  }\n\n  ull N, M, Q;\n  while(cin >> N >> M >> Q, N | M | Q) {\n    SW sw;\n    BL bl, sbl;\n    vector<SW> unknown(M, (1 << N) - 1);\n\n    REP(i, Q){\n      cin >> sw >> sbl;\n      BL change_bl = bl ^ sbl;\n      REP(i, M){\n        if(change_bl[i]) {\n          unknown[i] &= sw;\n        }else{\n          unknown[i] &= ~sw;\n        }\n      }\n\n      bl = sbl;\n    }\n\n    RREP(i, M){\n      if (unknown[i].count() != 1)\n        cout << '?';\n      else{\n        int n = N - 1 - num[unknown[i]];\n        if (n < 10)\n          cout << n;\n        else\n          cout << (char)('A' + n - 10);\n\n      }\n    }\n    cout << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <string>\n#include <iostream>\nusing namespace std;\n\nint n,m,q;\nint sd[37][1001];\nint bd[1001][1001];\nbool state[1001][37];\n\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d %d %d\",&n,&m,&q);\n\t\tif(n+m+q==0)break;\n\t\tfor(int i=1;i<=q;i++){\n\t\t\tstring s;\n\t\t\tstring b;\n\t\t\tcin >> s >> b;\n\t\t\tfor(int j=0;j<n;j++){\n\t\t\t\tsd[j][i]=s[j]-'0';\n\t\t\t}\n\t\t\tfor(int j=0;j<m;j++){\n\t\t\t\tbd[j][i]=b[j]-'0';\n\t\t\t}\n\t\t}\n\t\tmemset(state,true,sizeof(state));\n\t\tfor(int i=1;i<=q;i++){\n\t\t\tfor(int j=0;j<n;j++){\n\t\t\t\tfor(int k=0;k<m;k++){\n\t\t\t\t\tif(bd[k][i]!=bd[k][i-1] && sd[j][i]==0){\n\t\t\t\t\t\tstate[k][j]=false;\n\t\t\t\t\t}\n\t\t\t\t\tif(bd[k][i]==bd[k][i-1] && sd[j][i]==1){\n\t\t\t\t\t\tstate[k][j]=false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int j=0;j<m;j++){\n\t\t\tint res=-1;\n\t\t\tfor(int k=0;k<n;k++){\n\t\t\t\tif(state[j][k]){\n\t\t\t\t\tif(res==-1){\n\t\t\t\t\t\tres=k;\n\t\t\t\t\t}else res=-2;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(res<=9)printf(\"%c\",res>=0?'0'+res:'?');\n\t\t\telse printf(\"%c\",res-10+'A');\n\t\t}\n\t\tprintf(\"\\n\");\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long   // <-----!!!!!!!!!!!!!!!!!!!\n\n#define rep(i,n) for (int i=0;i<(n);i++)\n#define rep2(i,a,b) for (int i=(a);i<(b);i++)\n#define rrep(i,n) for (int i=(n)-1;i>=0;i--)\n#define rrep2(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n\ntypedef long long ll;\ntypedef pair<int, int> P;\ntypedef tuple<int, int, int> TUPLE;\ntypedef vector<int> V;\ntypedef vector<V> VV;\ntypedef vector<VV> VVV;\n\nstring base = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\nsigned main() {\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(0);\n\n    int N, M, Q;\n    while (cin >> N >> M >> Q, N) {\n        vector<string> S(Q + 1), B(Q + 1);\n        S[0] = string(N, '0');\n        B[0] = string(M, '0');\n        rep(i, Q) {\n            cin >> S[i + 1] >> B[i + 1];\n        }\n\n        vector<vector<bool>> a(N, vector<bool>(M, true));\n        rep2(q, 1, Q + 1) {\n            rep(i, N) {\n                rep(j, M) {\n                    if ((S[q][i] == '0') ^ (B[q][j] == B[q - 1][j])) {\n                        a[i][j] = false;\n                    }\n                }\n            }\n        }\n\n        rep(j, M) {\n            int cnt = 0;\n            int ans = -1;\n            rep(i, N) {\n                if (a[i][j]) {\n                    cnt++;\n                    ans = i;\n                }\n            }\n            cout << (cnt == 1 ? base[ans] : '?');\n        }\n        cout << endl;\n\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cassert>\nusing namespace std;\ntypedef long long ll;\nint N,M,Q;\nll s[4000],t[4000];\n\nll func(string str){\n  ll res=0;\n  for(int i=0;i<(int)str.size();i++)\n    if(str[i]=='1')res+=(1LL<<i);\n  return res;\n}\n\nint main(){\n  char change[36];\n  change[0]='0';\n  for(int i=1;i<10;i++)change[i]=change[i-1]+1;\n  change[10]='A';\n  for(int i=11;i<36;i++)change[i]=change[i-1]+1;\n\n  while(1){\n    cin>>N>>M>>Q;\n    if(N==0&&M==0&&Q==0)break;\n    for(int i=0;i<Q;i++){\n      string str,str2;\n      cin>>str>>str2;\n      s[i]=func(str);\n      t[i]=func(str2);\n      if(i)s[i]=s[i]^s[i-1];\n    }\n\n    for(int i=0;i<M;i++){\n      ll f=(1LL<<N)-1;\n      for(int j=0;j<Q;j++){\n\tif((t[j]>>i)&1){\n\t  f=f&s[j];\n\t}else {\n\t  f=f&(~s[j]);\n\t}\n      }\n      //assert(__builtin_popcountll(f)!=0);\n      if(__builtin_popcountll(f)==1){\n\tint ans=0;\n\tfor(ans=0;ans<36&&(1LL<<ans)!=f;ans++);\n\tcout<<change[ans];\n      }else{\n\tcout<<'?';\n      }\n    }\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\nusing lint = long long;\n\ninline char decode(int i) {\n    return i + (i < 10 ? '0' : 'A' - 10);\n}\n\nbool solve() {\n    int N, M, Q;\n    cin >> N >> M >> Q;\n    if (N == 0) return false;\n\n    vector<lint> pos(M, (1 << N) - 1);\n    lint light = 0;\n\n    for (int q = 0; q < Q; ++q) {\n        string S;\n        cin >> S;\n        for (int i = 0; i < N; ++i) {\n            if (S[i] == '1') light ^= (1 << i);\n        }\n\n        string B;\n        cin >> B;\n        for (int i = 0; i < M; ++i) {\n            if (B[i] == '0') {\n                pos[i] &= (~light & ((1 << N) - 1));\n            } else {\n                pos[i] &= light;\n            }\n        }\n    }\n\n    for (auto pat : pos) {\n        vector<int> ans;\n        for (int i = 0; i < N; ++i) {\n            if ((pat >> i) & 1) ans.push_back(i);\n        }\n        if (ans.size() > 1) {\n            cout << '?';\n        } else {\n            cout << decode(ans[0]);\n        }\n    }\n    cout << endl;\n    return true;\n}\n\nint main() {\n    while (solve()) {}\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define FOR(i,a,b) for (int i=(a);i<(b);i++)\n#define RFOR(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define REP(i,n) for (int i=0;i<(n);i++)\n#define RREP(i,n) for (int i=(n)-1;i>=0;i--)\n#define ALL(a) (a).begin(),(a).end()\n#define DEBUG(a) \"(\" << #a << \": \" << (a) << \")\"\n\ntemplate<typename T>\nvoid chmin(T &x, T y) { x = min(x, y); }\n\ntemplate<typename T>\nvoid chmax(T &x, T y) { x = max(x, y); }\n\ntypedef long long int lli;\ntypedef long double ld;\ntypedef tuple<int,int> P;\ntypedef bitset<64> switches;\ntypedef bitset<1024> bulbs;\n\nconst int INF = INT_MAX/2 - 1;\nconst double EPS = 1e-14;\nconst int dx[4] = {0, 1, 0, -1}; // {-1,  0,  1, -1, 1, -1, 0, 1};\nconst int dy[4] = {1, 0, -1, 0}; // {-1, -1, -1,  0, 0,  1, 1, 1};\n\nstring solve(int n, int m, const vector<tuple<switches,bulbs>> &crs) {\n  string ans(m, '?');\n  const string base36 = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n  REP (i, m) {\n    switches accs((1<<n) - 1);\n    for (auto cr : crs) {\n      switches ss; bulbs bs; tie(ss, bs) = cr;\n      accs &= bs[i] ? ss:~ss;\n    }\n    if (accs.count() != 1) { continue; }\n    REP (j, n) {\n      if (accs[j]) { ans[i] = base36[j]; }\n    }\n  }\n  return ans;\n}\n\nint main() {\n  cout << fixed << setprecision(10);\n  int N, M, Q;\n  while (cin >> N >> M >> Q and N) {\n    vector<tuple<switches,bulbs>> correspondence;\n    switches current(0);\n    REP (q, Q) {\n      string S, B;\n      cin >> S >> B;\n      switches ss(0);\n      REP (i, N) { ss[i] = S[i] == '1'; }\n      bulbs bs(0);\n      REP (i, M) { bs[i] = B[i] == '1'; }\n      current ^= ss;\n      correspondence.emplace_back(current, bs);\n    }\n    cout << solve(N, M, correspondence) << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define  _CRT_SECURE_NO_WARNINGS\n#pragma comment (linker, \"/STACK:526000000\")\n\n#include \"bits/stdc++.h\"\n\nusing namespace std;\ntypedef string::const_iterator State;\n#define eps 1e-11L\n#define MAX_MOD 1000000007LL\n#define GYAKU 500000004LL\n\n#define MOD 998244353LL\n#define seg_size 262144*2LL\n#define pb push_back\n#define mp make_pair\ntypedef long long ll;\n#define REP(a,b) for(long long (a) = 0;(a) < (b);++(a))\n#define ALL(x) (x).begin(),(x).end()\n\nunsigned long xor128() {\n\tstatic unsigned long x = 123456789, y = 362436069, z = 521288629, w = time(NULL);\n\tunsigned long t = (x ^ (x << 11));\n\tx = y; y = z; z = w;\n\treturn (w = (w ^ (w >> 19)) ^ (t ^ (t >> 8)));\n}\n\nvoid init() {\n\tiostream::sync_with_stdio(false);\n\tcout << fixed << setprecision(20);\n}\n\n#define int ll\nvoid solve() {\n\twhile (true) {\n\t\tint n, m, query;\n\t\tcin >> n >> m >> query;\n\t\tif (n == 0) return;\n\t\tll dp[1000];\n\t\tREP(i, m) {\n\t\t\tdp[i] = (1LL << (n + 1LL)) - 1LL;\n\t\t}\n\t\tint back = 0;\n\t\tREP(i, query) {\n\t\t\tstring a, b;\n\t\t\tcin >> a >> b;\n\t\t\tint geko = 0;\n\t\t\tfor (int q = 0; q < a.length(); ++q) {\n\t\t\t\tgeko += (1LL << q) * (long long)(a[q] - '0');\n\t\t\t}\n\t\t\tgeko ^= back;\n\t\t\tback = geko;\n\t\t\tREP(i, b.length()) {\n\t\t\t\tif (b[i] == '0') {\n\t\t\t\t\tll nya = (geko & dp[i]);\n\t\t\t\t\tdp[i] -= nya;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tdp[i] &= geko;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tREP(i, m) {\n\t\t\tvector<int> cnter;\n\t\t\tREP(q, n) {\n\t\t\t\tif ((1LL << q) & dp[i]) {\n\t\t\t\t\tcnter.push_back(q);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (cnter.size() == 1) {\n\t\t\t\tif (cnter[0] <= 9) {\n\t\t\t\t\tcout << cnter[0];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tcout << (char)(cnter[0] - 10 + 'A');\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcout << \"?\";\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n}\n\n#undef int\nint main() {\n\tinit();\n\tsolve();\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll, ll> P;\n#define rep(i, n) for(ll (i) = 0; (i) < (n); (i)++)\n#define rep1(i, n) for(ll (i) = 1; (i) <= (n); (i)++)\n#define rrep(i, n) for(ll (i) = (n) - 1; (i) >= 0; (i)--)\n#define rrep1(i, n) for(ll (i) = (n); (i) >= 1; (i)--)\nconst ll INF = 1145141919;\nconst ll MOD = 1000000007;\ntemplate<class T> void chmax(T &a, const T &b){if(a < b){a = b;}}\ntemplate<class T> void chmin(T &a, const T &b){if(a > b){a = b;}}\n\nchar S[1010][40];\nchar B[1010][1010];\nchar hoge[1010];\n\n\nint main(){\n\n    for(ll N, M, Q; cin >> N >> M >> Q, N;){\n\t\trep(i, Q){\n\t\t\trep(j, N)cin >> S[i][j];\n\t\t\trep(j, M)cin >> B[i][j];\n\t\t}\n\t\trep(i, M){\n\t\t\trep(j, Q){\n\t\t\t\tif(j == 0)hoge[j] = B[j][i];\n\t\t\t\telse if(B[j][i] != B[j - 1][i])hoge[j] = '1';\n\t\t\t\telse hoge[j] = '0';\n\t\t\t}\n\t\t\tll cnt = 0;\n\t\t\tll tmp = 0;\n\t\t\trep(j, N){\n\t\t\t\tll f = 1;\n\t\t\t\trep(k, Q)if(S[k][j] != hoge[k])f = 0;\n\t\t\t\tif(f){\n\t\t\t\t\tcnt++;\n\t\t\t\t\ttmp = j;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(cnt == 1){\n\t\t\t\tif(tmp < 10)cout << tmp;\n\t\t\t\telse cout << (char)('A' + tmp - 10);\n\t\t\t}\n\t\t\telse cout << \"?\";\n\t\t}\n\t\tcout << endl;\n\t}\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <ctime>\n#include <string>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <algorithm>\n#include <cmath>\n#include <sstream>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\n#define all(c) (c).begin(), (c).end()\n#define loop(i,a,b) for(ll i=a; i<ll(b); i++)\n#define rep(i,b) loop(i,0,b)\n#ifdef DEBUG\n#define dump(...) (cerr<<#__VA_ARGS__<<\" = \"<<(DUMP(),__VA_ARGS__).str()<<\" [\"<<__LINE__<<\"]\"<<endl)\nstruct DUMP:ostringstream{template<class T>DUMP &operator,(const T&t){if(this->tellp())*this<<\", \";*this<<t;return *this;}};\n#else\n#define dump(...)\n#endif\n\nint N,M,Q;\nint cand[1000];\n\nchar itoc(int x){\n    if(x<10) return '0'+x;\n    else return 'A'+x-10;\n}\n\nint main(){\n    while(cin>>N>>M>>Q && N|M|Q){\n        ll sw = 0;\n        memset(cand,-1,sizeof(cand));\n        rep(_,Q){\n            string op,sta;\n            cin>>op>>sta;\n            rep(i,N)if(op[i]=='1') sw ^= 1LL<<i;\n            rep(j,M){\n                cand[j] &= sta[j]=='0' ? ~sw : sw;\n            }\n        }\n\n        rep(i,M){\n            int x = -1;\n            bool ok = true;\n            rep(j,N){\n                if(cand[i]>>j & 1){\n                    if(x!=-1) ok = true;\n                    x = j;\n                }\n            }\n            if(ok) cout << itoc(x);\n            else cout << '?';\n        }\n        cout << \"\\n\";\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <iostream>\n#include <fstream>\n#include <sstream>\n#include <string>\n#include <cstring>\n#include <vector>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <queue>\n#include <deque>\n#include <stack>\n#include <algorithm>\n#include <bitset>\n#include <cmath>\n#include <cstdlib>\n#include <ctime>\n#include <numeric>\n#include <functional>\n#include <cctype>\n#include <list>\n#include <limits>\n#include <cassert>\n#include <random>\n#include <time.h>\n#include <unordered_set>\n//#include <boost/multiprecision/cpp_int.hpp>\n\n\n\nusing namespace std;\nusing Int = long long;\n//using namespace boost::multiprecision;\n\nconst double EPS = 1e-10;\nlong long const MOD = 998244353;\n\nlong long mod_pow(long long x, long long n) {\n    long long res = 1;\n    for (int i = 0;i < 60; i++) {\n        if (n >> i & 1) res = res * x % MOD;\n        x = x * x % MOD;\n    }\n    return res;\n}\n\ntemplate<typename T>\nT gcd(T a, T b) {\n    return b != 0 ? gcd(b, a % b) : a;\n}\n\ntemplate<typename T>\nT lcm(T a, T b) {\n    return a * b / gcd(a, b);\n}\n\nvoid fastInput() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n}\n\nstring solve(int N, int M, int Q) {\n    vector<vector<int>> bulb_to_switch(M, vector<int>(N, 1));\n    vector<int> ans(M);\n    string ret;\n    string S;\n    for (int i = 0; i < N; i++) {\n        S += '0';\n    }\n    for (int q = 0; q < Q; q++) {\n        string s, B; cin >> s >> B;\n        for (int i = 0; i < N; i++) {\n            if (s[i] == '1') {\n                if (S[i] == '1') S[i] = '0';\n                else S[i] = '1';\n            }\n        }\n        for (int i = 0; i < M; i++) {\n            for (int j = 0; j < N; j++) {\n                if (B[i] == '0' && S[j] == '1') {\n                    bulb_to_switch[i][j] = 0;\n                }\n                if (B[i] == '1' && S[j] == '0') {\n                    bulb_to_switch[i][j] = 0;\n                }\n            }\n        }\n    }\n    for (int i = 0; i < M; i++) {\n        int sw = 100;\n        for (int j = 0; j < N; j++) {\n            if (bulb_to_switch[i][j] == 1) {\n                if (sw == 100) sw = j;\n                else {\n                    sw = 100;\n                    break;\n                }\n            }\n        }\n        ans[i] = sw;\n    }\n    for (int i = 0; i < M; i++) {\n        if (ans[i] == 100) ret += '?';\n        else if (ans[i] <= 9) ret += '0' + ans[i];\n        else ret += 'A' + ans[i] - 10;\n    }\n    // for (int i = 0; i < M; i++) {\n    //     for (int j = 0; j < N; j++) {\n    //         cout << bulb_to_switch[i][j] << \" \";\n    //     }\n    //     cout << endl;\n    // }\n    return ret;\n}\n\nint main(void) {\n    int N, M, Q;\n    vector<string> ans;\n    while (1) {\n        cin >> N >> M >> Q;\n        if (N == 0) break;\n        ans.push_back(solve(N, M, Q));        \n    }\n    for (auto i : ans){\n        cout << i << endl;\n    }\n}\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr, __VA_ARGS__)\n//#define LOG(...)\n#define FOR(i, a, b) for(int i = (int)(a); i < (int)(b); ++i)\n#define REP(i, n) for(int i = 0; i < (int)(n); ++i)\n#define RREP(i, n) for(int i = (int)(n - 1); i >= 0; --i)\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EXIST(s, e) ((s).find(e) != (s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n#define SQ(n) (n) * (n)\n#define BIT(x, i) (((x) >> (i)) & 1)\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<char> vc;\ntypedef vector<pii> vpi;\ntypedef vector<pll> vpl;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vc> vvc;\ntypedef vector<vll> vvll;\n\ntypedef bitset<64> SW;\ntypedef bitset<1024> BL;\n\nint main() {\n  unordered_map<SW, int> num;\n  REP(i, 64){\n    num[1ULL << i] = i;\n  }\n\n  ull N, M, Q;\n  while(cin >> N >> M >> Q, N | M | Q) {\n    SW sw;\n    BL bl, sbl;\n    vector<SW> unknown(M, (1L << N) - 1);\n\n    bl = sbl;\n    // REP(i, M){\n    //   cout << unknown[i].to_string().substr(64 - N) << endl;\n    // }\n    // cout << \"------------\" << endl;\n    REP(i, Q){\n      cin >> sw >> sbl;\n      BL change_bl = bl ^ sbl;\n      // cout << \"===\" << endl;\n      // cout << sw.to_string().substr(64 - N) << endl;\n      // cout << change_bl.to_string().substr(1024 - M) << endl;\n      // cout << \"===\" << endl;\n      REP(i, M){\n        if(change_bl[i]) {\n          unknown[i] &= sw;\n        }else{\n          unknown[i] &= ~sw;\n        }\n      }\n\n      bl = sbl;\n      // REP(i, M){\n      //   cout << unknown[i].to_string().substr(64 - N) << endl;\n      // }\n      // cout << \"------------\" << endl;\n    }\n\n    RREP(i, M){\n      if (unknown[i].count() != 1)\n        cout << '?';\n      else{\n        int n = N - 1 - num[unknown[i]];\n        if (n < 10)\n          cout << n;\n        else\n          cout << (char)('A' + n - 10);\n\n      }\n    }\n    cout << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define _overload3(_1, _2, _3, name, ...) name\n#define _rep(i, n) repi(i, 0, n)\n#define repi(i, a, b) for (int i = (a); i < (b); ++i)\n#define rep(...) _overload3(__VA_ARGS__, repi, _rep, )(__VA_ARGS__)\n#define ALL(x) x.begin(), x.end()\n#define chmax(x, y) x = max(x, y)\n#define chmin(x, y) x = min(x, y)\nusing namespace std;\nusing ll = long long;\nusing lld = long double;\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing VL = vector<ll>;\nusing VVL = vector<VL>;\nusing PII = pair<int, int>;\nrandom_device rnd;\nmt19937 mt(rnd());\n\nconst int IINF = 1 << 30;\nconst ll INF = 1ll << 60;\nconst ll MOD = 1e9 + 7;\n\nvoid solve(int n, int m, int q)\n{\n    string to36 = \"0123456789\";\n    for (auto c = 'A'; c <= 'Z'; c++)\n    {\n        to36 += c;\n    }\n    map<int, vector<int>> candid; //候補\n    rep(i, m)\n    {\n        rep(j, n)\n        {\n            candid[i].push_back(j);\n        }\n    }\n    string button = \"\";\n    rep(i, n) button += \"0\";\n    string light = \"\";\n    rep(i, m) light += \"0\";\n    rep(tmp, q)\n    {\n\n        string op, res;\n        cin >> op >> res;\n        vector<int> on_button;\n        map<int, bool> on_light;\n        rep(i, n)\n        {\n            if ((button[i] == '0') ^ (op[i] == '0')) //ボタンが前押されていなくて、今操作された　or ボタンが前押されていて、今操作されていないなら（ほんまか？）\n            {\n                on_button.push_back(i);\n            }\n        }\n        rep(i, m)\n        {\n            if (res[i] == '1')\n            {\n                on_light[i] = true;\n            }\n        }\n        rep(i, m)\n        {\n            if (on_light[i])\n            {\n                vector<int> update;\n                set_intersection(ALL(on_button), ALL(candid[i]), inserter(update, end(update)));\n                candid[i] = update;\n            }\n            else\n            {\n                vector<int> update;\n                set_difference(ALL(candid[i]), ALL(on_button), inserter(update, end(update)));\n                candid[i] = update;\n            }\n        }\n        for (auto &&l : on_light)\n        {\n        }\n        rep(i, n)\n        {\n            if (op[i] == '1')\n            {\n                if (button[i] == '1')\n                {\n                    button[i] = '0';\n                }\n                else\n                {\n                    button[i] = '1';\n                }\n            }\n        }\n        //  cerr << button << endl;\n        light = res;\n    }\n    rep(i, m)\n    {\n        if (candid[i].size() == 1)\n        {\n\n            cout << to36[candid[i][0]];\n        }\n        else\n        {\n            cout << '?';\n        }\n    }\n    cout << endl;\n}\n\nint main()\n{\n    int n, m, q;\n    while (cin >> n >> m >> q, n)\n    {\n        solve(n, m, q);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <utility>\n#include <cmath>\n#include <algorithm>\n#include <iostream>\n#include <sstream>\n#include <iomanip>\n#include <vector>\n#include <string>\n#define REP(i,n) for(int i=0;i<n;i++)\ntypedef long long ll;\nusing namespace std;\ntypedef vector<ll> vl;\ntypedef pair<ll,ll> pll;\ntypedef vector<pll> vpll;\ntypedef vector<string> vs;\n\nint main() \n{\n\tint n,m,q;\n\twhile(cin>>n>>m>>q&&!(n==0&&m==0&&q==0))\n\t{\n\t\tint a[1000][36]={};//スイッチの述べ回数\n\t\tint b[1000][1000]={};//ランプの延べ回数\n\t\t\n\t\tchar s[1000][36]={};\n\t\tchar t[1000][1000]={};\n\t\t\n\t\tfor(int i=0;i<q;i++)\n\t\t{\n\t\t\tcin>>s[i]>>t[i];\n\t\t\tfor(int j=0;j<n;j++)\n\t\t\t{\n\t\t\t\tif(i==0&&s[i][j]=='0'){a[i][j]=0;}\n\t\t\t\telse if(i==0&&s[i][j]=='1'){a[i][j]=1;}\n\t\t\t\telse if(i!=0&&s[i][j]=='0'){a[i][j]=a[i-1][j];}\n\t\t\t\telse if(i!=0&&s[i][j]=='1'){a[i][j]=a[i-1][j]+1;}\n\t\t\t}\n\t\t\t\n\t\t\tfor(int j=0;j<m;j++)\n\t\t\t{\n\t\t\t\tif(i==0&&t[i][j]=='0'){b[i][j]=0;}\n\t\t\t\telse if(i==0&&t[i][j]=='1'){b[i][j]=1;}\n\t\t\t\telse if(i!=0&&t[i][j]==t[i-1][j]){b[i][j]=b[i-1][j];}\n\t\t\t\telse if(i!=0&&t[i][j]!=t[i-1][j]){b[i][j]=b[i-1][j]+1;}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor(int j=0;j<m;j++)\n\t\t{\n\t\t\tint count(0),ans;\n\t\t\tfor(int k=0;k<n;k++)\n\t\t\t{\n\t\t\t\tif(b[q-1][j]==a[q-1][k])\n\t\t\t\t{\n\t\t\t\t\tbool flag=false;\n\t\t\t\t\tREP(l,q){if(b[l][j]!=a[l][k]){flag=true;break;}}\n\t\t\t\t\tif(!flag)\n\t\t\t\t\t{\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t\tans=k;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(count>1){break;}\n\t\t\t}\n\t\t\tchar x='A'+ans;\n\t\t\tif(count>1){cout<<'?';}\n\t\t\telse if(ans<10){cout<<ans;}\n\t\t\telse{cout<<x;}\n\t\t}\n\t\tcout<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n\n#define REP(i, a, b) for (int i = int(a); i < int(b); i++)\n#define dump(val) cerr << __LINE__ << \":\\t\" << #val << \" = \" << (val) << endl\n\nusing namespace std;\n\ntypedef long long int lli;\n\nint main() {\n    int N, M, Q;\n    while (cin >> N >> M >> Q, N + M + Q) {\n        vector<vector<bool>> v(M, vector<bool>(N, true));\n        vector<int> lsts(N, 0);\n        REP (i, 0, Q) {\n            string s, b;\n            cin >> s >> b;\n            vector<int> ss(N, 0);\n            REP (j, 0, N) {\n                ss[j] = (s[j] - '0') ^ lsts[j];\n            }\n            REP (j, 0, N) {\n                REP (k, 0, M) {\n                    if (ss[j] + '0' != b[k]) {\n                        v[k][j] = false;\n                    }\n                }\n            }\n            lsts = ss;\n        }\n        REP (i, 0, M) {\n            int cnt = 0;\n            int index = -1;\n            REP (j, 0 ,N) {\n                if (v[i][j]) {\n                    cnt++;\n                    index = j;\n                }\n            }\n            if (cnt == 1) {\n                char out = index;\n                if (out <= 9) out += '0';\n                else out += 'A' - 10;\n                cout << out;\n            } else {\n                cout << '?';\n            }\n        }\n        cout << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#define Q 1010\n#define N 38\nusing namespace std;\n\nint main(){\n  int n,m,q;\n  char ans[Q];\n  bool sw[N],swb[N],li[Q],fl[Q],fln[N],fle[Q];\n  string s[Q],b[Q];\n  vector<int> on,off,r;\n  while(1){\n    cin>>n>>m>>q;\n    if(!n&&!m&&!q) break;\n    for(int i=0;i<q;i++) cin>>s[i]>>b[i];\n    for(int i=0;i<n;i++) sw[i]=swb[i]=fln[i]=false;\n    for(int i=0;i<m;i++) ans[i]='?',li[i]=fl[i]=fle[i]=false;\n    for(int i=0;i<q;i++){\n      for(int j=0;j<n;j++) swb[j]=sw[j];\n      for(int j=0;j<n;j++)\n\tif(s[i][j]=='1') sw[j]?sw[j]=false:sw[j]=true;\n      for(int j=0;j<n;j++){\n\tif(swb[j]&&sw[j]) r.push_back(j);\n\telse if(swb[j]&&!sw[j]) off.push_back(j);\n\telse if(sw[j]) on.push_back(j);\n      }\n      for(int j=0;j<n;j++)\n\tif(fln[j]){\n\t  for(int k=0;k<on.size();k++)\n\t    if(j==on[k]) on.erase(on.begin()+k);\n\t  for(int k=0;k<off.size();k++)\n\t    if(j==off[k]) off.erase(off.begin()+k);\n\t  for(int k=0;k<r.size();k++)\n\t    if(j==r[k]) r.erase(r.begin()+k);\n\t}\n      if(on.size()==1)\n\tfor(int j=0;j<m;j++)\n\t  if(!li[j]&&b[i][j]=='1'){\n\t    if(!fl[j]){\n\t      if(on[0]<=9) ans[j]=on[0]+'0';\n\t      else ans[j]=on[0]+'A'-10;\n\t      fl[j]=fln[j]=true;\n\t    }\n\t    else ans[j]='?',fle[j]=true;\n\t  }\n      if(off.size()==1)\n\tfor(int j=0;j<m;j++)\n\t  if(li[j]&&b[i][j]=='0'){\n\t    if(!fl[j]){\n\t      if(off[0]<=9) ans[j]=off[0]+'0';\n\t      else ans[j]=off[0]+'A'-10;\n\t      fl[j]=fln[j]=true;\n\t    }\n\t    else ans[j]='?',fle[j]=true;\n\t  }\n      if(r.size()==1)\n\tfor(int j=0;j<m;j++)\n\t  if(li[j]&&b[i][j]=='1'){\n\t    if(!fl[j]){\n\t      if(r[0]<=9) ans[j]=r[0]+'0';\n\t      else ans[j]=r[0]+'A'-10;\n\t      fl[j]=fln[j]=true;\n\t    }\n\t    else ans[j]='?',fle[j]=true;\n\t  }\n      for(int j=0;j<m;j++)\n\tb[i][j]=='1'?li[j]=true:li[j]=false;\n      on.clear();\n      off.clear();\n      r.clear();\n    }\n    int cnt=0,a;\n    for(int i=0;i<n;i++)\n      if(!fln[i]) cnt++,a=i;\n    if(cnt==1)\n      for(int i=0;i<m;i++)\n\tif(ans[i]=='?'&&!fle[i]){\n\t  if(a<=9) ans[i]=a+'0';\n\t  else ans[i]=a+'A'-10;\n\t}\n    for(int i=0;i<m;i++) cout<<ans[i];\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 29;\n\nint n,m,q;\nll b[1010];\n\ninline void output(int arg){\n\tif(__builtin_popcount(b[arg])!=1)\n\t\tcout << '?';\n\telse{\n\t\tint bit;\n\t\tfor(bit=0;bit<n;bit++)\n\t\t\tif(b[arg]&(1LL<<bit))\n\t\t\t\tbreak;\n\t\tif(bit>=10)\n\t\t\tcout << (char)(bit-10+'A');\n\t\telse\n\t\t\tcout << bit;\n\t}\n}\n\nint main(void){\n\twhile(cin >> n >> m >> q){\n\t\tif(n==0)\n\t\t\tbreak;\n\t\tll sw=0LL;\n\t\trep(i,m) b[i]=((1LL<<n)-1LL);\n\t\trep(i,q){\n\t\t\tll nsw=0;\n\t\t\tstring tmp;\n\t\t\tcin >> tmp;\n\t\t\trep(j,n){\n\t\t\t\tif(tmp[j]=='1')\n\t\t\t\t\tnsw|=(1LL<<j);\n\t\t\t}\n\t\t\tsw^=nsw;\n\t\t\tcin >> tmp;\n\t\t\trep(j,m){\n\t\t\t\tif(tmp[j]=='1')\n\t\t\t\t\tb[j]&=sw;\n\t\t\t\telse\n\t\t\t\t\tb[j]&=(~sw);\n\t\t\t}\n\t\t}\n\t\trep(i,m) output(i);\n\t\tcout << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <sstream>\n#include <set>\n\n#define REP(i,k,n) for(int i=k;i<n;i++)\n#define rep(i,n) for(int i=0;i<n;i++)\n\nusing namespace std;\ntypedef long long ll;\n\nstring same(string s,string t) {\n    string ret = s;\n    rep(i,s.size()) {\n        if(s[i] == t[i]) continue;\n        else ret[i] = 'X';\n    }\n\n    return ret;\n}\n\nstring Xor(string s,string t) {\n    string ret = s;\n    rep(i,s.size()) {\n        if(s[i] == t[i]) ret[i] = '0';\n        else ret[i] = '1';\n    }\n    \n    return ret;\n}\n\nint main() {\n\n    int n,m,q;\n    while(cin >> n >> m >> q) {\n        if(n == 0 && m == 0 && q == 0) break;\n\n        vector<string> s(q),b(q);\n        rep(i,q) {\n            cin >> s[i] >> b[i];\n        }\n\n        string ori = \"\";\n        rep(i,n) ori += \"0\";\n\n        vector<string> ins;\n        string pre = ori;\n        rep(i,q) {\n            pre = Xor(pre,s[i]);\n            ins.push_back(pre);\n        }\n\n        vector<int> v(n);\n        rep(i,n) v[i] = i;\n\n        stringstream ans;\n\n        rep(i,m) {\n            vector<string> a0,b1;\n\n            rep(j,q) {\n                if(b[j][i] == '0') {\n                    a0.push_back(ins[j]);\n                }\n                else {\n                    b1.push_back(ins[j]);\n                }\n            }\n\n            string res;\n            if(a0.size() == 0)  res = ori;\n            else res = a0[0];\n\n            rep(j,a0.size()) {\n                res = same(res,a0[j]);\n            }\n\n            string res2;\n            if(b1.size() == 0) res2 = ori;\n            else res2 = b1[0];\n\n            rep(j,b1.size()) {\n                res2 = same(res2,b1[j]);\n            }\n\n            set<int> st;\n            rep(j,n) {\n                if(res[j] == 'X' || res2[j] == 'X') continue;\n                if(res[j] == '0' && res2[j] == '1') {\n                    st.insert(j);\n                }\n            }\n\n            if(st.size() == 1) {\n                set<int>::iterator ite = st.begin();\n                if(0 <= *ite && *ite <= 9) {\n                    ans << *ite;\n                }\n                else {\n                    int id = *ite - 10;\n                    ans << char('A' + id);\n                }\n    \n                v.erase(remove(v.begin(),v.end(),*ite),v.end());\n            }\n            else ans << \"?\";\n\n        }\n        \n        string res = ans.str();\n        if(v.size() == 1) {\n            rep(i,res.size()) {\n                if(res[i] == '?') {\n                    if(0 <= v[0] && v[0] <= 9) {\n                        cout << v[0];\n                    }\n                    else {\n                        int id = v[0] - 10;\n                        cout << char('A' + id);\n                    }\n                }\n                else cout << res[i];\n            }\n            cout << endl;\n        }\n        else cout << res << endl;\n\n\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bitset>\n#include <cstdlib>\n#include <iostream>\n#include <vector>\nusing namespace std;\n\nconstexpr int MAX_N = 36;\nconstexpr int MAX_M = 1000;\n\ntypedef bitset<MAX_N> Switch;\ntypedef bitset<MAX_M> Bulb;\n \nint main(){\n\tcin.tie(NULL);\n\tios::sync_with_stdio(false);\n \n\tfor(int n, m, q; cin >> n >> m >> q && n;) {\n\t\tvector<Bulb> b(q);\n\t\tvector<Switch> s(q);\n\n\t\tfor(int i = 0; i < q; ++i) {\n\t\t\tcin >> s[i] >> b[i];\n\t\t}\n \n\t\tfor(int i = q - 1; i > 0; --i) {\n\t\t\tb[i] ^= b[i - 1];\n\t\t}\n \n\t\tfor(int i = m - 1; i >= 0; --i) {\n\t\t\tSwitch candidate;\n\t\t\tcandidate.set();\n\t\t\tcandidate &= (candidate >> (36 - n));\n\n\t\t\tfor(int j = 0; j < q; ++j) {\n\t\t\t\tcandidate &= (b[j][i] ? s[j] : ~s[j]);\n\t\t\t}\n \n\t\t\tif(candidate.count() > 1) {\n\t\t\t\tcout << '?';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconst int ans = n - __builtin_ctzll(candidate.to_ullong()) - 1;\n\t\t\t\tcout << (char)(ans >= 10 ? 'A' + ans - 10 : '0' + ans);\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr,__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<ll> vull;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\n\nint N, M, Q;\n\nstring base36 = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\nvoid print_light(vull &p) {\n    REP(i, M) {\n        int light = 0;\n        int idx = 0;\n        REP(j, N) {\n            if (p[i] & (1L<<j)) {\n                light++;\n                idx = j;\n            }\n        }\n        cout << (light == 1 ? base36[idx] : '?');\n    }\n    cout << endl;\n}\n\nint main() {\n    while (cin >> N >> M >> Q, N|M|Q) {\n        vull p(M, (1L<<N)-1);\n        string prev_state(M, '0');\n        REP(i, Q) {\n            string sw, state;\n            cin >> sw >> state;\n\n            REP(i, M) {\n                REP(j, N) {\n                    if ((sw[j] == '1' && state[i] == prev_state[i]) ||\n                        (sw[j] == '0' && state[i] != prev_state[i])) {\n                        p[i] &= ~(1L<<j);\n                    }\n                }\n            }\n            prev_state = state;\n        }\n        print_light(p);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \n#define MAX_N 36\n#define MAX 1000\n \nchar getChar(int x){\n    return (x < 10 ? x+'0' : x+'A'-10);\n}\n \nint main(){\n    int N,M,Q;\n    while(cin >> N >> M >> Q, N){\n\tstring S,B[MAX+1];\n\tbool sw[MAX+1][MAX_N];\n\tsw[0][0] = false;\n\tfor(int i = 1 ; i <= Q ; i++){\n\t    cin >> S >> B[i];\n\t    for(int j = 0 ; j < N ; j++){\n\t\tsw[i][j] = (S[j] == '1' ? !sw[i-1][j] : sw[i-1][j]);\n\t    }\n\t}\n\tstring ans;\n\tfor(int i = 0 ; i < M ; i++){\n\t    bool use[MAX_N];\n\t    fill(use,use+N,true);\n\t    for(int j = 1 ; j <= Q ; j++){\n\t\tfor(int k = 0 ; k < N ; k++){\n\t\t    if(!sw[j][k] && B[j][i] == '1' ||\n\t\t       sw[j][k] && B[j][i] == '0'){\n\t\t\tuse[k] = false;\n\t\t    }\n\t\t}\n\t    }\n\t    bool ok = true;\n\t    int x = -1;\n\t    for(int j = 0 ; j < N ; j++){\n\t\tif(use[j]){\n\t\t    if(x != -1) ok = false;\n\t\t    x = j;\n\t\t}\n\t    }\n\t    ans += (ok ? getChar(x) : '?');\n\t}\n\tcout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\ninline char to_char(int i) {\n    if (0 <= i && i <= 9) return '0'+i;\n    if (10 <= i && i <= 36) return 'A'+i-10;\n    return '?';\n}\n\nint main() {\n    int N, M, Q;\n    while (cin >> N >> M >> Q) {\n        if ( ! N) break;\n\n        vector<vector<int>> ST(N, vector<int>(Q+1, 0)), BT(M, vector<int>(Q+1, 0));\n        for (int i=0; i<Q; ++i) {\n            string S, B;\n            cin >> S >> B;\n            for (int j=0; j<(int)S.size(); ++j) {\n                ST[j][i+1] = ST[j][i] ^ (S[j]-'0');\n            }\n            for (int j=0; j<(int)B.size(); ++j) {\n                BT[j][i+1] = B[j]-'0';\n            }\n        }\n\n        map<vector<int>,int> sw;\n        for (int i=0; i<N; ++i) {\n            if (sw.count(ST[i])) sw[ST[i]] = -1;\n            else sw[ST[i]] = i;\n        }\n\n        for (int i=0; i<M; ++i) {\n            cout << to_char(sw[BT[i]]);\n        }\n        cout << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <ctime>\n#include <string>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <algorithm>\n#include <cmath>\n#include <sstream>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\n#define all(c) (c).begin(), (c).end()\n#define loop(i,a,b) for(ll i=a; i<ll(b); i++)\n#define rep(i,b) loop(i,0,b)\n#ifdef DEBUG\n#define dump(...) (cerr<<#__VA_ARGS__<<\" = \"<<(DUMP(),__VA_ARGS__).str()<<\" [\"<<__LINE__<<\"]\"<<endl)\nstruct DUMP:ostringstream{template<class T>DUMP &operator,(const T&t){if(this->tellp())*this<<\", \";*this<<t;return *this;}};\n#else\n#define dump(...)\n#endif\n\nint N,M,Q;\nll cand[1111];\n\nchar itoc(int x){\n    if(x<10) return '0'+x;\n    else return 'A'+x-10;\n}\n\nint main(){\n    ios_base::sync_with_stdio(0);\n    while(cin>>N>>M>>Q && N|M|Q){\n        ll sw = 0;\n        memset(cand,-1,sizeof(cand));\n        rep(_,Q){\n            string op,sta;\n            cin>>op>>sta;\n            rep(i,N)if(op[i]=='1') sw ^= 1LL<<i;\n            rep(j,M){\n                cand[j] &= sta[j]=='0' ? ~sw : sw;\n            }\n        }\n\n        rep(i,M){\n            int x = -1;\n            bool ok = true;\n            rep(j,N){\n                if(cand[i]>>j & 1){\n                    if(x!=-1) ok = false;\n                    x = j;\n                }\n            }\n            if(x!=-1 && ok) cout << itoc(x);\n            else cout << '?';\n        }\n        cout << \"\\n\";\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\ntypedef unsigned long long ull;\n\nint main(){\n\tios_base::sync_with_stdio(false);\n\twhile(true){\n\t\tint n, m, q;\n\t\tcin >> n >> m >> q;\n\t\tif(n == 0 && m == 0 && q == 0){ break; }\n\t\tvector<ull> masks(m, (1ull << n) - 1);\n\t\tstring state(m, '0');\n\t\tfor(int i = 0; i < q; ++i){\n\t\t\tstring s, t;\n\t\t\tcin >> s >> t;\n\t\t\tull mask = 0ull;\n\t\t\tfor(int j = 0; j < n; ++j){\n\t\t\t\tif(s[j] == '1'){ mask |= (1ull << j); }\n\t\t\t}\n\t\t\tfor(int j = 0; j < m; ++j){\n\t\t\t\tif(state[j] == t[j]){\n\t\t\t\t\tmasks[j] &= ~mask;\n\t\t\t\t}else{\n\t\t\t\t\tmasks[j] &= mask;\n\t\t\t\t}\n\t\t\t\tstate[j] = t[j];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0; i < m; ++i){\n\t\t\tif(__builtin_popcountll(masks[i]) >= 2){\n\t\t\t\tcout << \"?\";\n\t\t\t}else{\n\t\t\t\tconst int p = __builtin_ctzll(masks[i]);\n\t\t\t\tif(p < 10){\n\t\t\t\t\tcout << static_cast<char>(p + '0');\n\t\t\t\t}else{\n\t\t\t\t\tcout << static_cast<char>(p - 10 + 'A');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i, n) for (int i = 0; i < (int)(n); i++)\nusing namespace std;\n\nconst string base36 = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"; \n\nint main() {\n  for (int n, m, q; cin >> n >> m >> q, n;) {\n    vector<vector<int>> s(q, vector<int>(n, 0));\n    vector<vector<int>> b(q, vector<int>(m, 0));\n    {\n      vector<string> st(q), bt(q);\n      REP(i, q) {\n        cin >> st[i] >> bt[i];\n      }\n      REP(i, q) {\n        REP(j, n) s[i][j] = (st[i][j] == '1');\n        REP(j, m) b[i][j] = (bt[i][j] == '1');\n      }\n    }\n    vector<string> cs(q);\n    vector<string> cb(q);\n    REP(i, q) {\n      REP(j, n) {\n        if (i > 0) s[i][j] ^= s[i - 1][j];\n        cs[i] += '0' + s[i][j];\n      }\n      REP(j, m) {\n        cb[i] += '0' + b[i][j];\n      }\n    }\n    map<string, int> mp;\n    REP(i, n) {\n      string t;\n      REP(j, q) t += cs[j][i];\n      if (mp.find(t) == mp.end()) {\n        mp[t] = i;\n      } else {\n        mp[t] = -i;\n      }\n    }\n    string ans;\n    REP(i, m) {\n      string t;\n      REP(j, q) t += cb[j][i]; \n      if (mp[t] >= 0) {\n        ans += base36[mp[t]];\n      } else {\n        ans += '?';\n      }\n    }\n    cout << ans << endl;\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "//#define _GLIBCXX_DEBUG\n#include <iostream>\n#include <vector>\n#include <stdio.h>\n#include <bits/stdc++.h>\n\n\nusing namespace std;\n#define ll long long\n#define ld long double\n#define  P pair<ll,ll>\n#define FOR(i,n,m) for(ll i=n; i<(ll)m;i++)\n#define FORa(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define FORr(i,m,n) for(ll i=n; i>=(ll)m; i--)\n#define FORm(i,m) for(auto i=m.begin();i!=m.end();i++)\n#define FORs(i,st) for(auto i : st)\n#define REP(i,n) for(int i=0;i<(int)n;++i)\n#define ALL(c) (c).begin(), (c).end()\n#define VEC2(x,a,b) vector<vector<ll>> x = vector<vector<ll>>(a,vector<ll>(b,0))\n#define sortAl(v) sort(v.begin(),v.end())\n#define sortAlr(v) sort(v.begin(),v.end()); reverse(v.begin(),v.end())\n#define cinv(v,n,m) FOR(i,n,m) cin>>v.at(i)\n#define coutv(v,n,m) FOR(i,n,m) cout<<v.at(i) <<\" \"; cout<<endl\n#define cout(n) cout<<fixed<<setprecision(n)\n\nchar int_to_char(ll x){\n  if(x == -1) return '?';\n  else if(x<=9)return '0' + x;\n  else return 'A' + x - 10;\n}\n\n\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    ll n,m,q;\n    cin>>n>>m>>q;\n    while(n != 0){\n\n      vector<string> sw(q+1);\n      vector<string> light(q+1);\n      vector<ll> ans(m, -1);\n\n      FOR(i,0,n){\n        sw[0].push_back('0');\n      }\n      FOR(i,0,m){\n        light[0].push_back('0');\n      }\n\n      FOR(i,1,q+1){\n        cin>>sw[i]>>light[i];\n      }\n      q++;\n\n      FOR(i,1,q){\n        FOR(j,0,n){\n          if(sw[i-1][j] == '1' && sw[i][j] == '1') sw[i][j] = '0';\n          else if(sw[i-1][j] == '0' && sw[i][j] == '1') sw[i][j] = '1';\n          else if(sw[i-1][j] == '1' && sw[i][j] == '0') sw[i][j] = '1';\n        }\n      }\n\n      FOR(i,0,q){\n        FOR(j,i+1,q){\n          ll xor_1 = 0;\n          ll x1_po = 0;\n          ll xor_0 = 0;\n          ll x0_po = 0;\n          ll and_ = 0;\n          ll a_po = 0;\n          FOR(k,0,n){\n            if(sw[i][k] == '1' && sw[j][k] == '1'){\n              and_++;\n              a_po = k;\n            }\n            if((sw[i][k] == '0' && sw[j][k] == '1')){\n              xor_1++;\n              x1_po = k;\n            }\n            if((sw[i][k] == '1' && sw[j][k] == '0')){\n              xor_0++;\n              x0_po = k;\n            }\n\n          }\n\n          FOR(k,0,m){\n            if(and_ == 1){\n              if(light[i][k] == '1' && light[j][k] == '1') ans[k] = a_po;\n            }\n            if(xor_1 == 1){\n              if(light[i][k] == '0' && light[j][k] == '1') ans[k] = x1_po;\n            }\n            if(xor_0 == 1){\n              if(light[i][k] == '1' && light[j][k] == '0') ans[k] = x0_po;\n            }\n\n          }\n\n        }\n      }\n      vector<ll> used(m);\n      ll f=0;\n      FOR(i,0,m){\n        if(ans[i] != -1){\n          if(used[ans[i]] == 0) f++;\n          used[ans[i]] = 1;\n        }\n      }\n\n      if(f == n-1){\n        FOR(i,0,m){\n          if(used[i] == 0){\n            FOR(j,0,m){\n              if(ans[j] == -1){\n                ans[j] = i;\n              }\n            }\n            break;\n          }\n        }\n      }\n\n      FOR(i,0,m){\n        cout<<int_to_char(ans[i]);\n      }\n      cout<<endl;\n\n      cin>>n>>m>>q;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\nusing namespace std;\n\nint main(){\n    int n, m, q;\n    while(cin >> n >> m >> q, n||m||q){\n        int a[37][1005];\n        memset(a, -1, sizeof(a)); //1:テ・ツ渉ッティツδステヲツ?ァテ」ツ?づ」ツつ?0:テ・ツ渉ッティツδステヲツ?ァテ」ツ?ェテ」ツ??-1:テ」ツつ湘」ツ?凝」ツつ嘉」ツ?ェテ」ツ??\n\n        if(q == 0 && n == 1 && m == 1){\n            cout << 0 << endl;\n            continue;\n        }\n        string sb, bb;\n        rep(i,n) sb+='0';\n        rep(j,m) bb+='0';\n        rep(i,q){\n            string s, b;\n            cin >> s >> b;\n            rep(j,n){\n                if(s[j] == '1'){\n                    rep(k,m){\n                        if(b[k] != bb[k]){\n                            //cout << j << ' ' << k << endl;\n                            if(a[j][k] != 0) a[j][k] = 1;\n                        }else{\n                            if(a[j][k] != 0) a[j][k] = 0;\n                        }\n                    }\n                }else{\n                    rep(k,m){\n                        if(b[k] != bb[k]){\n                            //cout << j << ' ' << k << endl;\n                            if(a[j][k] != 0) a[j][k] = 0;\n                        }else{\n                            if(a[j][k] != 0) a[j][k] = 1;\n                        }\n                    }\n                }\n            }\n            sb = s;\n            bb = b;\n        //rep(i,3){ rep(j,10){ cout << a[i][j]; } cout << endl; } cout << endl;\n        }\n\n        string ans = \"\";\n        rep(j,m){\n            char c = '?';\n            rep(i,n){\n                if(a[i][j] == 1){\n                    if(c == '?'){\n                        if(i >= 0 && i <= 9) c = i + '0';\n                        else c = (i - 10) + 'A';\n                    }\n                }\n            }\n            ans += c;\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cctype>\n#include <limits.h>\n#include <math.h>\n#include <complex>\n#include <bitset>\n#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <iomanip>\n#include <iostream>\n\n#define VARIABLE(x) cerr << #x << \"=\" << x << endl\n#define BINARY(x) static_cast<bitset<16> >(x)\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define REP(i,m,n) for (int i=m;i<(int)(n);i++)\n#define if_range(x, y, w, h) if (0<=(int)(x) && (int)(x)<(int)(w) && 0<=(int)(y) && (int)(y)<(int)(h))\n#define ALL(a) (a).begin(),(a).end()\nint dx[4]={0, -1, 1, 0}, dy[4]={-1, 0, 0, 1};\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll, int> P;\ntypedef vector<vector<int> > VVI;\nconst int INF = 1e9;\nconst double EPS = 1e-6;\n\nchar base36(int n)\n{\n\tif (n >= 10) return 'A'+(n-10);\n\treturn '0'+n;\n}\n\nint main()\n{\n\tint N, M, Q;\n\twhile (cin>>N>>M>>Q, N) {\n\t\tbool no[50][1000] = {};\n\t\tbool swc[50] = {};\n\t\t\n\t\trep(i, Q) {\n\t\t\tstring S, B;\n\t\t\tcin>>S>>B;\n\t\t\t\n\t\t\tfor (int i=0; i<N; i++) {\n\t\t\t\tswc[i] ^= (S[i]-'0');\n\t\t\t}\n\t\t\t\n\t\t\tfor (int i=0; i<N; i++) {\n\t\t\t\tfor (int j=0; j<M; j++) {\n\t\t\t\t\tif (swc[i] != B[j]-'0') {\n\t\t\t\t\t\tno[i][j] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (int b=0; b<M; b++) {\n\t\t\tint can = -1;\n\t\t\tfor (int s=0; s<N; s++) {\n\t\t\t\tif (!no[s][b]) {\n\t\t\t\t\tif (can >= 0) {\n\t\t\t\t\t\tcan = -2;\n\t\t\t\t\t} else if (can == -1) {\n\t\t\t\t\t\tcan = s;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (can >= 0) {\n\t\t\t\tcout << base36(can);\n\t\t\t} else {\n\t\t\t\tcout << '?';\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int MAX_Q=1010,MAX_M=1010,MAX_N=37;\n\nint N,M,Q;\nstring S[MAX_Q],B[MAX_Q];\nstring base,ans;\nint check[MAX_M][MAX_N];\n\nvoid solve(){\n    for (int i=0;i<M;++i)\n        for (int j=0;j<N;++j)\n            check[i][j]=1;\n    string now=\"\";\n    for (int i=0;i<N;++i) now+='0';\n    for (int i=0;i<Q;++i){\n        for (int j=0;j<N;++j)\n            if (S[i][j]=='1')\n                now[j]=(now[j]=='0'?'1':'0');\n        for (int j=0;j<M;++j)\n            for (int k=0;k<N;++k)\n                if (B[i][j]!=now[k])\n                    check[j][k]=0;\n    }\n    ans=\"\";\n    for (int i=0;i<M;++i){\n        int button=-1;\n        for (int j=0;j<N;++j) if (check[i][j]){\n            if (button==-1) button=j;\n            else button=-2;\n        }\n        ans+=(0<=button?base[button]:'?');\n    }\n    cout << ans << '\\n';\n}\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    for (int i=0;i<10;++i) base+='0'+i;\n    for (int i=0;i<26;++i) base+='A'+i;\n    while(cin >> N >> M >> Q,N){\n        for (int i=0;i<Q;++i) cin >> S[i] >> B[i];\n        solve();\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\nusing lint = long long;\n\ninline char decode(int i) {\n    return i + (i < 10 ? '0' : 'A' - 10);\n}\n\nbool solve() {\n    int N, M, Q;\n    cin >> N >> M >> Q;\n    if (N == 0) return false;\n\n    vector<lint> pos(M, (1LL << N) - 1);\n    lint light = 0;\n\n    for (int q = 0; q < Q; ++q) {\n        string S;\n        cin >> S;\n        for (int i = 0; i < N; ++i) {\n            if (S[i] == '1') light ^= (1LL << i);\n        }\n\n        string B;\n        cin >> B;\n        for (int i = 0; i < M; ++i) {\n            if (B[i] == '0') {\n                pos[i] &= (~light & ((1LL << N) - 1));\n            } else {\n                pos[i] &= light;\n            }\n        }\n    }\n\n    for (auto pat : pos) {\n        vector<int> ans;\n        for (int i = 0; i < N; ++i) {\n            if ((pat >> i) & 1) ans.push_back(i);\n        }\n        if (ans.size() > 1) {\n            cout << '?';\n        } else {\n            cout << decode(ans[0]);\n        }\n    }\n    cout << endl;\n    return true;\n}\n\nint main() {\n    while (solve()) {}\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i, n) for(int i = 0; i < (int) (n); i++)\n#define ALL(v) (v).begin(), (v).end()\n#define INF (1e9+7)\n\nusing namespace std;\n\nint main(){\n  int n, m, q;\n  while(cin >> n >> m >> q and n + m + q){\n    vector<bitset<36> > bulbs(m);\n    bitset<36> tmp;\n    bitset<36> orgn;\n    REP(i, n) REP(j, m) bulbs[j][i] = 1;\n    REP(count, q){\n      orgn = tmp;\n      string s, b;\n      cin >> s >> b;\n      REP(i, s.size()){\n        int t = s[i] - '0';\n        if(t) tmp[i] = ~tmp[i];\n      }\n      REP(i, b.size()){\n        int t = b[i] - '0';\n        if(t) bulbs[i] &= tmp;\n        else bulbs[i] &= ~tmp;\n      }\n    }\n    REP(i, m) {\n      if(bulbs[i].count() != 1) cout << \"?\";\n      else REP(j, n) if(bulbs[i][j] == 1) cout << (char)((j < 10) ? ('0' + j) : ('A' + j - 10));\n    }\n    cout << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//include\n//------------------------------------------\n#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <deque>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <queue>\n\nusing namespace std;\n\n//typedef\n//------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef long long LL;\n\n//container util\n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define EACH(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n\n//repetition\n//------------------------------------------\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\n//constant\n//--------------------------------------------\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\n\nchar toch(int x){\n  if(x < 0) return '?';\n  if(x < 10) return x + '0';\n  return (x-10) + 'A';\n}\n\nint main(){\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n\n  int N, M, Q;\n  while(cin>>N>>M>>Q,N){\n\tbool tab[36][1000];\n\tfill((bool*)tab, (bool*)tab+36*1000, true);\n\tstring prv(M, '0');\n\tREP(q,Q){\n\t  string sw, bulb;\n\t  cin >> sw >> bulb;\n\t  VI same, diff;\n\t  REP(j,M)\n\t\tif(prv[j] == bulb[j]) same.PB(j);\n\t\telse diff.PB(j);\n\t  REP(i,N){\n\t\tif(sw[i] == '1'){\n\t\t  for(int idx:same)\n\t\t\ttab[i][idx] = false;\n\t\t}\n\t\telse{\n\t\t  for(int idx:diff)\n\t\t\ttab[i][idx] = false;\n\t\t}\n\t  }\n\t  prv = bulb;\n\t}\n\tREP(i,M){\n\t  int fl = -1;\n\t  REP(j,N){\n\t\tif(tab[j][i]){\n\t\t  if(fl != -1){\n\t\t\tfl = -1;\n\t\t\tbreak;\n\t\t  }\n\t\t  fl = j;\n\t\t}\n\t  }\n\t  cout << toch(fl);\n\t}\n\tcout << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\nint main() {\n\tint n, m, q;\n\twhile (cin >> n >> m >> q, n) {\n\t\tif (q == 0) {\n\t\t\tif (n != 1) {\n\t\t\t\trep(i, m) {\n\t\t\t\t\tcout << \"?\";\n\t\t\t\t}\n\t\t\t\tcout << endl;\n\t\t\t}\n\t\t\telse {\n\t\t\t\trep(i, m) {\n\t\t\t\t\tcout << \"0\";\n\t\t\t\t}\n\t\t\t\tcout << endl;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tchar signal[1000][36];\n\t\tchar light[1000][1000];\n\t\trep(i, q) {\n\t\t\tstring s, t;\n\t\t\tcin >> s >> t;\n\t\t\trep(k, n) {\n\t\t\t\tsignal[i][k] = s[k];\n\t\t\t}\n\t\t\trep(k, m) {\n\t\t\t\tlight[i][k] = t[k];\n\t\t\t}\n\t\t}\n\t\trep(i, m) {\n\t\t\tint chk = -1; bool g = true;\n\t\t\trep(j, n) {\n\t\t\t\tbool f = true;\n\t\t\t\tint sum = 0;\n\t\t\t\trep(k, q) {\n\t\t\t\t\tsum += signal[k][j]-'0'; sum %= 2;\n\t\t\t\t\tif (sum != (light[k][i]-'0')) {\n\t\t\t\t\t\tf = false; break;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (f) {\n\t\t\t\t\tif (chk == -1)chk = j;\n\t\t\t\t\telse {\n\t\t\t\t\t\tbool g = false;\n\t\t\t\t\t\tcout << \"?\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!g)break;\n\t\t\t}\n\t\t\tif (g) {\n\t\t\t\tif (chk < 10) {\n\t\t\t\t\tcout << chk;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tcout << (char)('A' + chk - 10);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(){\n  int n,rm,lm;\n  while(cin>>lm>>rm>>n,n+lm+rm){\n    int a[100][1002]={};\n    string pl=\"00000000000000000000000\",pr=\"0000000000000000000\",cl,cr;\n    for(int o=0;o<n;o++){\n      cin>>cl>>cr;\n      for(int i=0;i<lm;i++){\n        if(cl[i]=='1')\n          for(int j=0;j<rm;j++){\n            if(pr[j]==cr[j])a[i][j]=1;\n          }\n        else\n          for(int j=0;j<rm;j++){\n            if(pr[j]!=cr[j])a[i][j]=1;\n          }\n      }\n      pr=cr;\n    }\n    for(int i=0;i<rm;i++){\n      int p=-1,c=0;\n      for(int j=0;j<lm;j++){\n        if(!a[j][i]){\n          if(c&&p!=j)c++;\n          p=j;\n          if(!c)c++;\n        }}\n      if(c==1){\n        if(p<10)cout<<p;\n        else cout<<(char)('A'+p-10);\n      }\n      else cout<<'?';\n    }\n    cout<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\nint main(){\n\n  int N,M,Q;\n    \n  while(1){\n    cin >>N>>M>>Q;\n    if(N+M+Q == 0)break;\n    string s[1000],l[1000];\n    int data[N][M];\n    \n    for(int i=0 ; i < Q ; i++)cin >>s[i]>>l[i];\n    \n    for(int i=0 ; i < N ; i++)\n      for(int j=0 ; j < M ; j++)\n\tdata[i][j]=1;\n\n    for(int i=0 ; i < Q-1 ; i++){\n      for(int j=0 ; j < N ; j++){\n\tif(s[i][j] == '1'){\n\t  if(s[i+1][j] == '1'){\n\t    s[i+1][j]='0';\n\t  }else{\n\t    s[i+1][j]='1';\n\t  }\n\t}\n      }\n    }\n\n    //for(int i=0 ; i < Q ; i++)cout <<s[i]<<endl;\n    \n    for(int i=0 ; i < Q ; i++){\n      for(int j=0 ; j < N ; j++){\n\tfor(int k=0 ; k < M ; k++){\n\t  if(s[i][j] != l[i][k])data[j][k] = 0;\n\t}\n      }\n    }\n\n    /*\n    for(int i=0 ; i < N ; i++){\n      for(int j=0 ; j < M ; j++){\n\tcout <<data[i][j]<<\" \";\n      }\n      cout <<endl;\n    }\n    */\n\n    for(int i=0 ; i < M ; i++){\n      int cnt=0;\n      int num;\n      for(int j=0 ; j < N ; j++){\n\tcnt+=data[j][i];\n\tif(data[j][i])num=j;\n      }\n      if(cnt == 1){\n\tif(num <= 9){\n\t  cout <<num;\n\t}else{\n\t  cout <<(char)('A'+10-num);\n\t}\n      }else{\n\tcout <<'?';\n      }\n    }\n    cout <<endl;\n    \n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n, m, q;\nstring s[1000], b[1000];\n\nint get(unsigned long long x){\n\tint res = 0;\n\twhile (x > 1){\n\t\tres++;\n\t\tx >>= 1;\n\t}\n\treturn res;\n}\n\nvoid solve()\n{\n\tfor (int i = 1; i < q; i++){\n\t\tfor (int j = 0; j < n; j++){\n\t\t\ts[i][j] = '0' + (s[i - 1][j] != s[i][j]);\n\t\t}\n\t\t/*for (int j = 0; j < m; j++){\n\t\t\tb[i][j] = '0' + (b[i - 1][j] != b[i][j]);\n\t\t}*/\n\t}\n\t\n\tstatic unsigned long long f[1000];\n\tfor (int i = 0; i < m; i++) f[i] = (1ull << n) - 1;\n\t\n\tfor (int i = 0; i < q; i++){\n\t\tfor (int j = 0; j < n; j++){\n\t\t\tfor (int k = 0; k < m; k++){\n\t\t\t\tif (s[i][j] != b[i][k]) f[k] &= ~(1ull << j);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfor (int i = 0; i < m; i++){\n\t\tif (f[i] != (f[i] & -f[i])) printf(\"?\");\n\t\tif (f[i] == 0) printf(\"?\");\n\t\telse {\n\t\t\tint t = get(f[i]);\n\t\t\tif (t <= 9) printf(\"%d\", t);\n\t\t\telse printf(\"%c\", 'A' + (t - 10));\n\t\t}\n\t}\n\tputs(\"\");\n}\n\nint main()\n{\n\twhile (scanf(\"%d %d %d\", &n, &m, &q), n){\n\t\tfor (int i = 0; i < q; i++){\n\t\t\tcin >> s[i] >> b[i];\n\t\t}\n\t\tsolve();\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <ctime>\n#include <string>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <algorithm>\n#include <cmath>\n#include <sstream>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\n#define all(c) (c).begin(), (c).end()\n#define loop(i,a,b) for(ll i=a; i<ll(b); i++)\n#define rep(i,b) loop(i,0,b)\n#ifdef DEBUG\n#define dump(...) (cerr<<#__VA_ARGS__<<\" = \"<<(DUMP(),__VA_ARGS__).str()<<\" [\"<<__LINE__<<\"]\"<<endl)\nstruct DUMP:ostringstream{template<class T>DUMP &operator,(const T&t){if(this->tellp())*this<<\", \";*this<<t;return *this;}};\n#else\n#define dump(...)\n#endif\n\nint N,M,Q;\nint cand[1000];\n\nchar itoc(int x){\n    if(x<10) return '0'+x;\n    else return 'A'+x-10;\n}\n\nint main(){\n    ios_base::sync_with_stdio(0);\n    while(cin>>N>>M>>Q && N|M|Q){\n        ll sw = 0;\n        memset(cand,-1,sizeof(cand));\n        rep(_,Q){\n            string op,sta;\n            cin>>op>>sta;\n            rep(i,N)if(op[i]=='1') sw ^= 1LL<<i;\n            rep(j,M){\n                cand[j] &= sta[j]=='0' ? ~sw : sw;\n            }\n        }\n\n        rep(i,M){\n            int x = -1;\n            bool ok = true;\n            rep(j,N){\n                if(cand[i]>>j & 1){\n                    if(x!=-1) ok = false;\n                    x = j;\n                }\n            }\n            if(x!=-1 && ok) cout << itoc(x);\n            else cout << '?';\n        }\n        cout << \"\\n\";\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <utility>\n#include <cmath>\n#include <algorithm>\n#include <iostream>\n#include <sstream>\n#include <iomanip>\n#include <vector>\n#include <string>\n#define REP(i,n) for(int i=0;i<n;i++)\ntypedef long long ll;\nusing namespace std;\ntypedef vector<ll> vl;\ntypedef pair<ll,ll> pll;\ntypedef vector<pll> vpll;\ntypedef vector<string> vs;\n\nint main() \n{\n\tint n,m,q;\n\twhile(cin>>n>>m>>q&&!(n==0&&m==0&&q==0))\n\t{\n\t\tint a[1000][36]={};//スイッチの述べ回数\n\t\tint b[1000][1000]={};//ランプの延べ回数\n\t\t\n\t\tchar s[1000][36]={};\n\t\tchar t[1000][1000]={};\n\t\t\n\t\tfor(int i=0;i<q;i++)\n\t\t{\n\t\t\tcin>>s[i]>>t[i];\n\t\t\tfor(int j=0;j<n;j++)\n\t\t\t{\n\t\t\t\tif(i==0&&s[i][j]=='0'){a[i][j]=0;}\n\t\t\t\telse if(i==0&&s[i][j]=='1'){a[i][j]=1;}\n\t\t\t\telse if(i!=0&&s[i][j]=='0'){a[i][j]=a[i-1][j];}\n\t\t\t\telse if(i!=0&&s[i][j]=='1'){a[i][j]=a[i-1][j]+1;}\n\t\t\t}\n\t\t\t\n\t\t\tfor(int j=0;j<m;j++)\n\t\t\t{\n\t\t\t\tif(i==0&&t[i][j]=='0'){b[i][j]=0;}\n\t\t\t\telse if(i==0&&t[i][j]=='1'){b[i][j]=1;}\n\t\t\t\telse if(i!=0&&t[i][j]==t[i-1][j]){b[i][j]=b[i-1][j];}\n\t\t\t\telse if(i!=0&&t[i][j]!=t[i-1][j]){b[i][j]=b[i-1][j]+1;}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor(int j=0;j<m;j++)\n\t\t{\n\t\t\tint count(0),ans;\n\t\t\tfor(int k=0;k<n;k++)\n\t\t\t{\n\t\t\t\tif(b[q-1][j]==a[q-1][k])\n\t\t\t\t{\n\t\t\t\t\tbool flag=false;\n\t\t\t\t\tREP(l,q){if(b[l][j]!=a[l][k]){flag=true;break;}}\n\t\t\t\t\tif(!flag)\n\t\t\t\t\t{\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t\tans=k;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(count>1){break;}\n\t\t\t}\n\t\t\tchar x='A'+ans-10;\n\t\t\tif(count>1){cout<<'?';}\n\t\t\telse if(ans<10){cout<<ans;}\n\t\t\telse{cout<<x;}\n\t\t}\n\t\tcout<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n \nint main() {\n  int n,m,q;\n  while(cin >> n >> m >> q) {\n    if(n==0 && m==0 && q==0) break;\n    bool d[m][n];\n    for(int i=0; i<m; i++) {\n      for(int j=0; j<n; j++) d[i][j]=true;\n    }\n    vector<bool> v(m);\n    fill(v.begin(),v.end(),0);\n    while(q--) {\n      string s1,s2;\n      cin >> s1 >> s2;\n      vector<bool> s(n),t(m);\n      for(int i=0; i<n; i++) {\n        if(s1[i]=='1') s[i]=true;\n        else s[i]=false;\n      }\n      for(int i=0; i<m; i++) {\n        if(s2[i]=='1') t[i]=true;\n        else t[i]=false;\n      }\n      for(int i=0; i<n; i++) {\n        for(int j=0; j<m; j++) {\n          bool ck=(t[j]!=v[j]);\n          if(s[i]&&!ck || !s[i]&&ck) d[j][i]=false;\n        }\n      }\n      v=t;\n    }\n      \n    for(int i=0; i<m; i++) {\n      int ans=-1;\n      for(int j=0; j<n; j++) {\n        if(d[i][j]) {\n          if(ans==-1) ans=j;\n          else ans=-2;\n        }\n      }\n      if(ans<0) cout << \"?\";\n      else {\n        char c;\n        if(ans<10) c=(char)(ans+'0');\n        else {\n          ans-=10;\n          c=(char)(ans+'A');\n        }\n        cout << c;\n      }\n    }\n    cout << endl;\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(){\n  int n,rm,lm;\n  while(cin>>lm>>rm>>n,n+lm+rm){\n    int a[50][1002]={};\n    string pr=\"00000000000000000000000000000000000000000000000000000000\",cl,cr;\n    for(int o=0;o<n;o++){\n      cin>>cl>>cr;\n      for(int i=0;i<lm;i++){\n        if(cl[i]=='1')\n          for(int j=0;j<rm;j++){\n            if(pr[j]==cr[j])a[i][j]=1;\n          }\n        else\n          for(int j=0;j<rm;j++){\n            if(pr[j]!=cr[j])a[i][j]=1;\n          }\n      }\n      pr=cr;\n    }\n    //for(int i=0;i<lm;i++)cout<<a[i][2];cout<<endl;\n    for(int i=0;i<rm;i++){\n      int p=-1,c=0;\n      for(int j=0;j<lm;j++){\n        if(!a[j][i]){\n          if(c&&p!=j)c++;\n          p=j;\n          if(!c)c++;\n        }}\n      if(c==1){\n        if(p<10)cout<<p;\n        else cout<<(char)('A'+p-10);\n      }\n      else cout<<'?';\n    }\n    cout<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n\nusing namespace std;\n\nint main()\n{\n\tint n, m, q;\n\twhile (cin >> n >> m >> q && n != 0 || m != 0 || q != 0)\n\t{\n\t\tvector<string> S, B;\n\t\tfor (int i = 0; i < q; i++)\n\t\t{\n\t\t\tchar chars[40];\n\t\t\tchar charb[1100];\n\t\t\tcin >> chars >> charb;\n\t\t\tS.push_back(chars);\n\t\t\tB.push_back(charb);\n\t\t}\n\n\t\tint SL[1100];\n\t\tmemset(SL, -1, sizeof SL);\n\t\tfor (int i = 0; i < m; i++)//light\n\t\t{\n\t\t\tfor (int j = 0; j < n; j++)//switch\n\t\t\t{\n\t\t\t\tbool status = false;\n\t\t\t\tbool flag = true;\n\t\t\t\tfor (int k = 0; k < q; k++)//query\n\t\t\t\t{\n\t\t\t\t\tif (S[k][j] == '1')\n\t\t\t\t\t{\n\t\t\t\t\t\tstatus = !status;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (status && B[k][i] == '1' || !status && B[k][i] == '0')continue;\n\t\t\t\t\tflag = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (flag)\n\t\t\t\t{\n\t\t\t\t\tif (SL[i] == -1)SL[i] = j;\n\t\t\t\t\telse SL[i] = -2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (int i = 0; i < m; i++)\n\t\t{\n\t\t\tif (SL[i] < 0)\n\t\t\t{\n\t\t\t\tcout << \"?\";\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (SL[i] < 10)\n\t\t\t\t{\n\t\t\t\t\tcout << SL[i];\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tcout << (char)((SL[i] - 10) + 'A');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<cstdio>\n#include<map>\n#include<algorithm>\n#include<string>\n#include<cmath>\n\nusing namespace std;\nint main(){\n\tint N,M,Q;\n\tstring S,B;\n\tstring C;\n\tint offF =0,onF=0;\n\tint *offi,*oni;\n\tstring sigma =\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\n\n\twhile(1){\n\t\tcin >> N >> M >> Q;\n\t\tif(N==0 && M==0 && Q==0)break;\n\t\tC=\"\";\n\t\toffi = new int[M];\n\t\toni = new int[M];\n\t\tfor(int i=0;i<M;i++){\n\t\t\tC+=\"?\";\n\t\t\toffi[i]=-1;\n\t\t\toni[i]=-1;\n\t\t}\n\t\t//0会の時\n\t\tif(Q==0){\n\t\t\tif(M==1){\n\t\t\t\tcout << 0 <<endl;\n\t\t\t\tcontinue;\n\t\t\t}else{\n\t\t\t\tcout << C << endl;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\toffF =0,onF=0;\n\t\tcin>>S>>B;\n\t\t//最初の一回\n\t\tchar off='?',on='?';\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(S[i]=='0') {\n\t\t\t\toffF++;\n\t\t\t\tif(offF==1) off=sigma[i];\n\t\t\t}if(S[i]=='1'){\n\t\t\t\tonF++;\n\t\t\t\tif(onF==1) on=sigma[i];\n\t\t\t}  \n\t\t}\n\t\tif(offF==1){\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='0'){\n\t\t\t\t\tC[i]=off;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tif(onF==1){\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='1'){\n\t\t\t\t\tC[i]=on;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\n\t\t//2~n-1まで\n\t\tstring prevB = \"\";\n\t\tfor(int k=0;k<M;k++){ prevB += B[k];}\n\t\tstring B2 = \"\";\n\t\tfor(int q=1;q<Q;q++){\n\t\t\toffF =0,onF=0;\n\t\t\tB2 = \"\";\n\t\t\tcin>>S>>B;\n\t\t\t//cout<< S <<endl;\n\t\t\t//cout<< \"B:\" <<B <<endl;\n\t\t\t//cout<< \"prevB:\" << prevB <<endl;\n\t\t\t//cout<< \"C:\" << C <<endl;\n\n\t\t\tfor(int j=0;j<M;j++){\n\t\t\t\tB2 += sigma[abs(prevB[j] - B[j])];\n\t\t\t}\n\t\t\t//cout << \"B2:\" << B2 << endl;\n\t\t\tchar off,on;\n\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\tif(S[i]=='0' && C[i]=='?') {\n\t\t\t\t\toffF++;\n\t\t\t\t\tif(offF==1) off=sigma[i];\n\t\t\t\t}\n\t\t\t\tif(S[i]=='1' && C[i]=='?'){\n\t\t\t\t\tonF++;\n\t\t\t\t\tif(onF==1) on=sigma[i];\n\t\t\t\t}  \n\t\t\t}\n\t\t\t//cout << \"flag : \" << offF << onF << endl;\n\n\t\t\tif(offF==1){\n\t\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\t\tif(S[i]=='0'){\n\t\t\t\t\t\tfor(int j=0; j<M; j++){\n\t\t\t\t\t\t\tif(B2[j] == '0' && C[j]=='?'){ \n\t\t\t\t\t\t\t\tC[j] = off;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t}\n\t\t\tif(onF==1){\n\t\t\t\tfor(int i=0;i<N;i++){\n\t\t\t\t\tif(S[i]=='1'){\n\t\t\t\t\t\tfor(int j=0; j<M; j++){\n\t\t\t\t\t\t\tif(B2[j] == '1' && C[j]=='?'){ \n\t\t\t\t\t\t\t\tC[j] = on;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\t\n\t\t\t}\n\t\t\tprevB = B;\n\n\t\t}\n\t\t\n\t\tint *check = new int[N];\n\t\tint a,flg=0;\n\t\tfor(int i=0;i<M;i++) check[i] = 0;\n\n\t\tfor(int i=0; i<M; i++){\n\t\t\tcheck[(int)(C[i]-'0')] = 1;\n\t\t}\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(check[i]==0){\n\t\t\t\ta = i;\n\t\t\t\tflg++;\n\t\t\t}\n\t\t}\n\t\tif(flg==1){\n\t\t\tfor(int i=0; i<M; i++){\n\t\t\t\tif(C[i]=='?') C[i] = sigma[a];\n\t\t\t}\n\t\t}\n\n\t\tcout << C << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint main() {\n  while(1) {\n    int n,m,q;\n    cin >> n >> m>> q;\n    if(n==0 && m==0 && q==0) break;\n    int flg[37][1001]  = {};\n    bool a[1001]={};\n    int b[1001];\n    while(q--) {\n      char t;\n      for(int i=0;i<n;i++) {\n\tcin >> t;\n\tif(t =='1') a[i] = (a[i]+1)%2;\n      }\n      for(int i=0;i<m;i++) cin>>t ,b[i] = t-'0';\n     \n      for(int i=0;i<n;i++)\n\tfor(int j=0;j<m;j++){\n\t  if(flg[i][j] == -1) continue;\n\t  if(a[i] == 1 && b[j] == 1) flg[i][j] = 1;\n\t  else if(a[i]==1 && b[j] == 0) flg[i][j] = -1;\n\t  else if(a[i] == 0 && b[j] == 1) flg[i][j] = -1;\n\t}\n\n     }\n   \n      int ans[1001] = {};\n      for(int i=0;i<m;i++) ans[i] = -1;  \n      for(int i=0;i<n;i++)\n\tfor(int j=0;j<m;j++){\n\t  if(flg[i][j] == -1) continue;\n\t  if(ans[j] != -1) ans[j] = -2;\n\t  else ans[j] = i;\n\t}\n      \n      for(int i=0;i<m;i++){\n\tchar ch = 'A'+(ans[i]-10);\n\tif(ans[i]==-2) cout <<\"?\";\n\telse if(ans[i] > 9) cout << ch ;\n\telse cout << ans[i];\n      }\n      cout << endl;\n  }\n  return 0;\n}  "
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(){\n  int n,rm,lm;\n  while(cin>>lm>>rm>>n,n+lm+rm){\n    int a[50][1002]={};\n    string pr,cl,cr;\n    for(int i=0;i<1001;i++)pr+='0';\n    for(int o=0;o<n;o++){\n      cin>>cl>>cr;\n      for(int i=0;i<lm;i++){\n        if(cl[i]=='1')\n          for(int j=0;j<rm;j++){\n            if(pr[j]==cr[j])a[i][j]=1;\n          }\n        else\n          for(int j=0;j<rm;j++){\n            if(pr[j]!=cr[j])a[i][j]=1;\n          }\n      }\n      pr=cr;\n    }\n    for(int i=0;i<rm;i++){\n      int p=-1,c=0;\n      for(int j=0;j<lm;j++)\n        if(!a[j][i]){\n          if(c&&p!=j)c++;\n          p=j;\n          if(!c)c++;\n        }\n      if(c){\n        if(p<10)cout<<p;\n        else cout<<(char)('A'+p-10);\n      }\n      else cout<<'?';\n    }\n    cout<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define pp pair<int,int>\n#define rep(i,n) for(int (i)=0;(i)<(n);(i)++)\n#define ll long long\n#define ld long double\n#define all(a) (a).begin(),(a).end()\n#define mk make_pair\nll mod=1000000007;\nll MOD=998244353;\nint inf=1000001000;\nll INF=100000000000000000;\n\n\nint main() {\n    while(true){\n    int n,m,q;\n    cin >> n >> m >> q;\n    if (n==0) break;\n    vector<string> s(n),ss(m);\n    vector<char> h(m,'0');\n    rep(i,q){\n        string t,tt;\n        cin >> t >> tt;\n        rep(j,n){\n            if (t[j]=='1') s[j].push_back('1');\n            else s[j].push_back('0');\n        }\n        rep(j,m){\n            if (tt[j]!=h[j]) {\n                ss[j].push_back('1');\n                if (h[j]=='1') h[j]='0';\n                else h[j]='1';\n            }\n            else ss[j].push_back('0');\n\n        }\n    }\n    // rep(i,n) cout << s[i] << endl;\n    // rep(j,m) cout << ss[j] << endl;\n    vector<int> ans(m,-1);\n    rep(i,n){\n        rep(j,m){\n            if (s[i]==ss[j]){\n                if (ans[j]==-1) ans[j]=i;\n                else ans[j]=inf; \n            }\n        }\n    }\n    string e;\n    rep(i,10){\n        e+=to_string(i);\n    }\n    rep(i,26){\n        e.push_back('A'+i);\n    }\n    rep(i,m){\n        if (ans[i]==-1 || ans[i]==inf) cout << \"?\";\n        else cout << e[ans[i]];\n    }\n    cout << endl;\n}}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr,__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\n\nint N, M, Q;\n\nstring base36 = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\nvoid print_light(vll &p) {\n    REP(i, M) {\n        int light = 0;\n        int idx = 0;\n        REP(j, N) {\n            if (p[i] & (1<<j)) {\n                light++;\n                idx = j;\n            }\n        }\n        cout << (light == 1 ? base36[idx] : '?');\n    }\n    cout << endl;\n}\n\nint main() {\n    while (cin >> N >> M >> Q, N|M|Q) {\n        vll p(M, (1<<N)-1);\n        string prev_state(M, '0');\n        REP(i, Q) {\n            string sw, state;\n            cin >> sw >> state;\n\n            REP(i, M) {\n                REP(j, N) {\n                    if ((sw[j] == '1' && state[i] == prev_state[i]) ||\n                        (sw[j] == '0' && state[i] != prev_state[i])) {\n                        p[i] &= ~(1<<j);\n                    }\n                }\n            }\n            prev_state = state;\n        }\n        print_light(p);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(){\n  int n,rm,lm;\n  while(cin>>lm>>rm>>n,n+lm+rm){\n    int a[100][100]={};\n    string pl=\"00000000000000000000000\",pr=\"0000000000000000000\",cl,cr;\n    for(int o=0;o<n;o++){\n      cin>>cl>>cr;\n      for(int i=0;i<lm;i++){\n        if(cl[i]=='1')\n          for(int j=0;j<rm;j++){\n            if(pr[j]==cr[j])a[i][j]=1;\n          }\n        else\n          for(int j=0;j<rm;j++){\n            if(pr[j]!=cr[j])a[i][j]=1;\n          }\n      }\n      pr=cr;\n    }\n    for(int i=0;i<rm;i++){\n      int p=-1,c=0;\n      for(int j=0;j<lm;j++){\n        if(!a[j][i]){\n          if(c&&p!=j)c++;\n          p=j;\n          if(!c)c++;\n        }}\n      if(c==1){\n        if(p<10)cout<<p;\n        else cout<<(char)('A'+p-10);\n      }\n      else cout<<'?';\n    }\n    cout<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main()\n{\n  int N, M, Q;\n  while(cin >> N >> M >> Q, N) {\n    bool light[1000][36]; memset(light, true, sizeof(light));\n    string prevS = string(N, '0'), prevB = string(M, '0');\n\n\n    while(Q--) {\n      string s, B;\n      cin >> s >> B;\n\n      string S = \"\";\n      for(int i = 0; i < N; i++) {\n        if(s[i] == '1') S += (prevS[i] == '0' ? '1' : '0');\n        else S += prevS[i];\n      }\n\n      for(int i = 0; i < M; i++) {\n        for(int j = 0; j < N; j++) {\n          if(prevB[i] != prevS[j] || B[i] != S[j]) light[i][j] = false;\n        }\n      }\n\n      prevB = B;\n      prevS = S;\n    }\n    stringstream T;\n    for(int i = 0; i < M; i++) {\n      if(count(&light[i][0], &light[i][N], true) == 1) {\n        int pos = find(&light[i][0], &light[i][N], true) - light[i];\n        if(pos < 10) T << pos;\n        else T << (char)(pos - 10 + 'A');\n      } else {\n        T << '?';\n      }\n    }\n    cout << T.str() << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<map>\nusing namespace std;\ntypedef long long ll;\n\nint main(){\n  int n,m,q;\n  while(cin >> n >> m >> q){\n    if(n==0 && m==0 && q==0)return 0;\n\n    vector<ll> cor(m, (1LL<<n) - 1);\n\n    ll bit = 0;\n    for(int x=0;x<q;x++){\n      string b,s;\n      cin >> b >> s;\n\n      ll change = 0;\n      for(int i=0;i<n;i++){\n\tif(b[i] == '1')change |= 1LL<<i;\n      }\n\n      bit ^= change;\n\n      for(int i=0;i<m;i++){\n\tif(s[i] == '1')cor[i] &= bit;\n      }\n\n      ll revbit = (1LL<<n)-1 - bit; \n      for(int i=0;i<m;i++){\n\tif(s[i] == '0')cor[i] &= revbit;\n      }\n    }\n\n    map<ll,int> log2;\n    for(int i=0;i<n;i++)log2[1LL<<i] = i;\n\n    vector<int> det, use(n,0);\n    unsigned int p = 0;\n    while(true){\n      for(int i=0;i<m;i++){\n\tif(log2.find(cor[i]) != log2.end()){\n\t  int id = log2[cor[i]];\n\t  if(!use[id]){\n\t    det.push_back(id); use[id]=true;\n\t  }\n\t}\n      }\n\n      if(p==det.size())break;\n\n      while(p<det.size()){\n\tll exp2 = 1LL<<det[p];\n\tfor(int i=0;i<m;i++){\n\t  if( cor[i]!=exp2 && cor[i]&exp2 )cor[i] -= exp2;\n\t}\n\tp++;\n      }\n      //for(int i=0;i<m;i++)cout << cor[i] << \" \"; cout << endl;\n    }\n\n    for(int i=0;i<m;i++){\n      if(log2.find(cor[i]) != log2.end()){\n\tint id = log2[cor[i]];\n\tif(id<10)cout << id;\n\telse cout << (char)('A'+id-10);\n      }else{\n\tcout << \"?\";\n      }\n    }\n    cout << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <functional>\n#include <numeric>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <utility>\n#include <sstream>\n#include <complex>\n#include <fstream>\n#include <bitset>\n#include <time.h>\n#include <tuple>\n#include <iomanip>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<ll, ll> P;\ntypedef vector<ll> V;\ntypedef complex<double> Point;\n\n#define PI acos(-1.0)\n#define EPS 1e-10\nconst ll INF = 1e12;\nconst ll MOD = 1e9 + 7;\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define rep(i,N) for(int i=0;i<(N);i++)\n#define ALL(s) (s).begin(),(s).end()\n#define EQ(a,b) (abs((a)-(b))<EPS)\n#define EQV(a,b) ( EQ((a).real(), (b).real()) && EQ((a).imag(), (b).imag()) )\n#define fi first\n#define se second\n#define N_SIZE (1LL << 20)\n#define NIL -1\n\nll sq(ll num) { return num*num; }\nll mod_pow(ll x, ll n) {\n\tif (n == 0)return 1;\n\tif (n == 1)return x%MOD;\n\tll res = sq(mod_pow(x, n / 2));\n\tres %= MOD;\n\tif (n % 2 == 1) {\n\t\tres *= x;\n\t\tres %= MOD;\n\t}\n\treturn res;\n}\nll mod_add(ll a, ll b) { return (a + b) % MOD; }\nll mod_sub(ll a, ll b) { return (a - b + MOD) % MOD; }\nll mod_mul(ll a, ll b) { return a*b % MOD; }\n\nll n, m, q;\n\nint main() {\n\twhile (cin >> n >> m >> q&&n + m + q) {\n\t\tbool st[1010] = {};\n\t\tbool f[1010][40];\n\t\trep(i, m)rep(j, n)f[i][j] = 1;\n\t\trep(i, q) {\n\t\t\tstring s, b;\n\t\t\tcin >> s >> b;\n\t\t\trep(j, m) {\n\t\t\t\trep(k, n) {\n\t\t\t\t\tif (b[j] - '0' == st[j]) {\n\t\t\t\t\t\tif (s[k] == '1')f[j][k] = 0;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (s[k] == '0')f[j][k] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tst[j] = b[j] - '0';\n\t\t\t}\n\t\t}\n\t\trep(i, m) {\n\t\t\tint num = -1;\n\t\t\trep(j, n) {\n\t\t\t\tif (f[i][j]) {\n\t\t\t\t\tif (num == -1)num = j;\n\t\t\t\t\telse num = -2;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (num == -2)cout << \"?\";\n\t\t\telse if (num <= 9)cout << num;\n\t\t\telse cout << (char)('A' + num - 10);\n\t\t}\n\t\tcout << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i,n) for(int i=0; i<(int)(n); ++i)\n\nusing namespace std;\n\nconst int C = 36;\n\nint main(){\n    int N, M, Q;\n    while(cin >> N >> M >> Q && N > 0) {\n        bitset<C> sw;\n        vector<bitset<C>> state(M);\n        REP(i, M) REP(j, N) state[i][j] = true; // all true\n        REP(_, Q) {\n            bitset<C> ope;\n            string s;\n            cin >> s;\n            REP(i, N) ope[i] = (s[i] == '1');\n            sw ^= ope;\n\n            string t;\n            cin >> t;\n            REP(i, M) {\n                if(t[i] == '1') {\n                    state[i] &= sw;\n                } else {\n                    state[i] &= ~sw;\n                }\n            }\n        }\n\n        REP(i, M) {\n            if(state[i].count() == 1) {\n                REP(j, N) if(state[i][j]) {\n                    cout << (char)(j < 10 ? '0' + j : 'A' + (j - 10));\n                }\n            } else {\n                cout << '?';\n            }\n        }\n        cout << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nint main()\n{\n  while(1){\n    int N, M, Q;\n    cin >> N >> M >> Q;\n    if(N == 0 && M == 0 && Q == 0) break;\n    string S_pre, S_pos, B_pre, B_pos;\n    S_pre = B_pre = \"\";\n    for(int i = 0; i < N; i++)\n      S_pre += \"0\";\n    for(int i = 0; i < M; i++)\n      B_pre += \"0\";\n    int ans[M];\n    vector<bool> s(N);\n    fill(ans,ans+M,-1);\n    fill(s.begin(),s.end(),false);\n    for(int i = 0; i < Q; i++){\n      cin >> S_pos >> B_pos;\n      int b[M];\n      fill(b,b+M,-1);\n      for(int j = 0; j < N; j++){\n        if(!s[j]){\n          if(S_pre[j] == '0' && S_pos[j] == '1'){            \n            for(int k = 0; k < M; k++){\n              if(ans[k] == -1 && b[k] != -2){\n                if(B_pre[k] == '0' && B_pos[k] == '1'){\n                  if(b[k] == -1){\n                    b[k] = j;\n                  }else{\n                    b[k] = -2;\n                  }     \n                }\n              }\n            }  \n          }else if(S_pre[j] == '1' && S_pos[j] == '0'){\n            for(int k = 0; k < M; k++){\n              if(ans[k] == -1 && b[k] != -2){\n                if(B_pre[k] == '1' && B_pos[k] == '1'){\n                  if(b[k] == -1){\n                    b[k] = j;\n                  }else{\n                    b[k] = -2;\n                  }     \n                }\n              }\n            }\n          }else if(S_pre[j] == '1' && S_pos[j] == '1')\n            for(int k = 0; k < M; k++){\n              if(ans[k] == -1 && b[k] != -2){\n                if(B_pre[k] == '1' && B_pos[k] == '0'){\n                  if(b[k] == -1){\n                    b[k] = j;\n                  }else{\n                    b[k] = -2;\n                  }     \n                }\n              }\n            }  \n        }\n      }\n      for(int j = 0; j < M; j++){\n        if(b[j] >= 0){\n          ans[j] = b[j];\n          s[b[j]] = true;\n        }\n      }\n      S_pre = S_pos;\n      B_pre = B_pos;\n    }\n    if(count(s.begin(),s.end(),false) == 1){\n      int x = find(s.begin(),s.end(),false) - s.begin();\n      for(int i = 0; i < M; i++){\n        if(ans[i] == -1){\n          ans[i] = x;\n        }\n      }\n    }\n    for(int i = 0; i < M; i++){\n      if(ans[i] == -1){\n        cout << '?';\n      }else{\n        if(ans[i] < 10){\n          cout << ans[i];\n        }else{\n          cout << (char)(ans[i]+55);\n        }\n      }\n    }\n    cout << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nchar name[] = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n\nchar solve(const int N, const vector<string>& S, const string& b) {\n\tset<int> r;\n\tfor (int i = 0; i < N; ++i) {\n\t\tbool f = true;\n\t\tbool state = false;\n\t\tfor (int j = 0; j < b.size(); ++j) {\n\t\t\tbool s = b[j] == '1';\n\t\t\tif (S[j][i] == '1') {\n\t\t\t\tstate = !state;\n\t\t\t}\n\t\t\tif (state != s) {\n\t\t\t\tf = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (f) {\n\t\t\tr.insert(i);\n\t\t}\n\t}\n//\tcout << \"[\" << N << \",\" << r.size() << \"]\";\n\treturn r.size() == 1 ? name[*r.begin()] : '?';\n}\n\nint main() {\n\tint N, M, Q;\n\twhile (cin >> N >> M >> Q, N || M || Q) {\n\t\tvector<string> S(Q), B(Q);\n\t\tfor (int i = 0; i < Q; ++i) {\n\t\t\tcin >> S[i] >> B[i];\n\t\t}\n\t\tfor (int i = 0; i < M; ++i) {\n\t\t\tstring b = \"\";\n\t\t\tfor (int j = 0; j < Q; ++j) {\n\t\t\t\tb += B[j][i];\n\t\t\t}\n\t\t\tcout << solve(N, S, b);\n\t\t}\n\t\tcout << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <utility>\n#include <algorithm>\nusing namespace std;\ntypedef long long int lli;\n\nint main(){\n\twhile(1){\n\t\tint n,m,q;\n\t\tcin >> n >> m >> q;\n\t\tif(n==0) break;\n\t\t\n\t\tvector<lli> s(q, 0LL);\n\t\tvector<string> b(q);\n\t\tfor(int i=0; i<q; i++){\n\t\t\tstring str;\n\t\t\tcin >> str >> b[i];\n\t\t\tfor(int j=0; j<n; j++){\n\t\t\t\ts[i] |= (long long int)(str[j]-'0') << j;\n\t\t\t}\n\t\t}\n\t\tfor(int i=1; i<q; i++){\n\t\t\ts[i] ^= s[i-1];\n\t\t}\n\t\t\n\t\tvector<lli> cand(m, (1LL<<n)-1);\n\t\tfor(int i=0; i<q; i++){\n\t\t\tfor(int j=0; j<m; j++){\n\t\t\t\tif(b[i][j]=='1'){\n\t\t\t\t\tcand[j] &= s[i];\n\t\t\t\t}else{\n\t\t\t\t\tcand[j] &= ~s[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor(int i=0; i<m; i++){\n\t\t\tbool unique=false;\n\t\t\tfor(int j=0; j<n; j++){\n\t\t\t\tif(cand[i] == (1LL<<j)){\n\t\t\t\t\tif(j>9){\n\t\t\t\t\t\tcout << (char)('A'+j-10);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tcout << j;\n\t\t\t\t\t}\n\t\t\t\t\tunique = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!unique){\n\t\t\t\tcout << '?';\n\t\t\t}\n\t\t\tif(cand[i]==0) cout << \"error\";\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\ntypedef long long ll;\nint N,M,Q;\nll s[40],t[40];\n\nll func(string str){\n  ll res=0;\n  reverse(str.begin(),str.end());\n  for(int i=0;i<(int)str.size();i++){\n    res*=2LL;\n    res+=(str[i]-'0');\n  }\n  return res;\n}\n\nint main(){\n  char change[36];\n  change[0]='0';\n  for(int i=1;i<10;i++)change[i]=change[i-1]+1;\n  change[10]='A';\n  for(int i=11;i<36;i++)change[i]=change[i-1]+1;\n\n  while(1){\n    cin>>N>>M>>Q;\n    if(N==0&&M==0&&Q==0)break;\n    for(int i=0;i<Q;i++){\n      string str,str2;\n      cin>>str>>str2;\n      s[i]=func(str);\n      t[i]=func(str2);\n      if(i){\n\ts[i]=s[i]^s[i-1];\n      }\n      //cout<<s[i]<<' '<<t[i]<<endl;\n    }\n    for(int i=0;i<M;i++){\n      ll f=(1LL<<N)-1;\n      for(int j=0;j<Q;j++){\n       \n\tif((t[j]>>i)&1){\n\t  f=f&s[j];\n\t  \n\t}else {\n\t  \t  f=f&((1LL<<N)-1-s[j]);\n\t  \n\t}\n\n      }\n\n      // cout<<f<<endl;\n      if(__builtin_popcountll(f)==1){\n\tint ans=__builtin_ctzll(f);\n\tcout<<change[ans];\n      }else{\n\tcout<<'?';\n      }\n    }\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) begin(a),end(a)\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10  fixed<<setprecision(5)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<short, short> P;\ntypedef complex<double> Point;\ntypedef long long ll;\nconst int INF = 1145141919;\nconst int MOD = 100000007;\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\nstruct edge\n{\n\tint from, to, cost;\n\tbool operator < (const edge& e) const { return cost < e.cost; }\n\tbool operator > (const edge& e) const { return cost > e.cost; }\n};\n///*************************************************************************************///\n///*************************************************************************************///\n///*************************************************************************************///\n\n\nint main()\n{\n\tint n, m, q;\n\twhile (cin >> n >> m >> q, n)\n\t{\n\t\tvector<vi> v(m);\n\t\tREP(i, m)REP(j, n) v[i].push_back(j);\n\t\tstring b, s, preb(m,'0'), pres(n,'0');\n\t\tREP(r, q)\n\t\t{\n\t\t\tcin >> s >> b;\n\t\t\tvi op,rem;\n\t\t\tREP(i, n)\n\t\t\t{\n\t\t\t\tif (pres[i] != s[i]) op.push_back(i);\n\t\t\t\telse rem.push_back(i);\n\t\t\t}\n\t\t\t\n\t\t\tREP(i, m)\n\t\t\t{\n\t\t\t\tif (v[i].size()>1 && preb[i] == b[i])\n\t\t\t\t{\n\t\t\t\t\tREP(j, v[i].size())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (find(ALL(op), v[i][j]) != op.end())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tv[i].erase(v[i].begin() + j);\n\t\t\t\t\t\t\tj--;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (v[i].size()>1 && preb[i] != b[i])\n\t\t\t\t{\n\t\t\t\t\tREP(j, v[i].size())\n\t\t\t\t\t{\n\t\t\t\t\t\tif (find(ALL(rem), v[i][j]) != rem.end())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tv[i].erase(v[i].begin() + j);\n\t\t\t\t\t\t\tj--;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tpres = s; preb = b;\n\t\t}\n\t\tREP(i, m)\n\t\t{\n\t\t\tif (v[i].size() > 1||v[i].size()==0) cout << '?';\n\t\t\telse if (v[i][0] < 10) cout << v[i][0];\n\t\t\telse\n\t\t\t{\n\t\t\t\tcout << char('A' + v[i][0] - 10);\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n \t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define all(x) (x).begin(),(x).end()\nconst int mod=1000000007,MAX=1<<16,INF=1<<30;\n\nint main(){\n    \n    std::ifstream in(\"text.txt\");\n    std::cin.rdbuf(in.rdbuf());\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    \n    while(1){\n        int N,M,Q;cin>>N>>M>>Q;\n        if(N+M+Q==0) break;\n        vector<vector<int>> A(M,vector<int>(N));\n        vector<int> state(N,0);\n        \n        for(int k=0;k<Q;k++){\n            string S,T;cin>>S>>T;\n            for(int i=0;i<N;i++){\n                state[i]^=int(S[i]-'0');\n            }\n            \n            for(int i=0;i<N;i++){\n                for(int j=0;j<M;j++){\n                    if(state[i]^int(T[j]-'0')) A[j][i]=0;\n                    else A[j][i]++;\n                }\n            }\n        }\n        \n        for(int i=0;i<M;i++){\n            vector<int> can;\n            for(int j=0;j<N;j++){\n                if(A[i][j]==Q) can.push_back(j);\n            }\n            \n            if(can.size()==1){\n                if(can[0]<=9) cout<<can[0];\n                else cout<<char('A'+can[0]-10);\n            }else cout<<'?';\n            //cout<<can.size()<<\" \";\n        }\n        \n        cout<<endl;\n    }\n}\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\nusing namespace std;\nint main(){\n\n  int N,M,Q;\n    \n  while(1){\n    cin >>N>>M>>Q;\n    if(N+M+Q == 0)break;\n    char s[1000][36],l[1000][1000];\n    int data[N][M];\n    \n    for(int i=0 ; i < Q ; i++)scanf(\"%s%s\",s[i],l[i]);;\n    \n    for(int i=0 ; i < N ; i++)\n      for(int j=0 ; j < M ; j++)\n\tdata[i][j]=1;\n\n    for(int i=0 ; i < Q-1 ; i++){\n      for(int j=0 ; j < N ; j++){\n\tif(s[i][j] == '1'){\n\t  if(s[i+1][j] == '1'){\n\t    s[i+1][j]='0';\n\t  }else{\n\t    s[i+1][j]='1';\n\t  }\n\t}\n      }\n    }\n\n    //for(int i=0 ; i < Q ; i++)cout <<s[i]<<endl;\n    \n    for(int i=0 ; i < Q ; i++){\n      for(int j=0 ; j < N ; j++){\n\tfor(int k=0 ; k < M ; k++){\n\t  if(s[i][j] != l[i][k])data[j][k] = 0;\n\t}\n      }\n    }\n\n    /*\n    for(int i=0 ; i < N ; i++){\n      for(int j=0 ; j < M ; j++){\n\tcout <<data[i][j]<<\" \";\n      }\n      cout <<endl;\n    }\n    */\n\n    for(int i=0 ; i < M ; i++){\n      int cnt=0;\n      int num;\n      for(int j=0 ; j < N ; j++){\n\tcnt+=data[j][i];\n\tif(data[j][i])num=j;\n      }\n      if(cnt == 1){\n\tif(num <= 9){\n\t  cout <<num;\n\t}else{\n\t  cout <<(char)('A'+10-num);\n\t}\n      }else{\n\tcout <<'?';\n      }\n    }\n    cout <<endl;\n    \n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#define llint long long\n\nusing namespace std;\n\nllint n, m, Q;\nllint s[1005];\nstring b[1005];\nllint mask[1005];\n\nllint enc(string s)\n{\n\tllint ret = 0;\n\tfor(int i = 0; i < n; i++){\n\t\tif(s[i] == '1') ret += 1LL<<i;\n\t}\n\treturn ret;\n}\n\nchar get(llint x)\n{\n\tif(x < 10) return x + '0';\n\telse return (x-10) + 'A';\n}\n\nint main(void)\n{\n\twhile(1){\n\t\tcin >> n >> m >> Q;\n\t\tif(n == 0 && m == 0 && Q == 0) break;\n\t\t\n\t\tstring S;\n\t\tfor(int i = 1; i <= Q; i++){\n\t\t\tcin >> S >> b[i];\n\t\t\ts[i] = enc(S);\n\t\t}\n\t\tfor(int i = 0; i < m; i++) b[0] += '0';\n\t\t\n\t\tfor(int i = 0; i < m; i++) mask[i] = (1LL<<n) - 1;\n\t\tfor(int i = 1; i <= Q; i++){\n\t\t\tfor(int j = 0; j < m; j++){\n\t\t\t\tif(b[i-1][j] != b[i][j]) mask[j] &= s[i];\n\t\t\t\telse mask[j] &= ~s[i];\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor(int i = 0; i < m; i++){\n\t\t\tllint pos = -1;\n\t\t\tfor(int j = 0; j < n; j++){\n\t\t\t\tif(mask[i] & (1LL<<j)){\n\t\t\t\t\tif(pos != -1) pos = -2;\n\t\t\t\t\telse pos = j;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(pos == -2) cout << \"?\";\n\t\t\telse cout << get(pos);\n\t\t}\n\t\tcout << endl;\n\t}\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cassert>\nusing namespace std;\ntypedef long long ll;\nint N,M,Q;\nll s[4000],t[4000];\n\nll func(string str){\n  ll res=0;\n  for(int i=0;i<(int)str.size();i++)\n    if(str[i]=='1')res+=(1LL<<i);\n  return res;\n}\n\nint main(){\n  char change[36];\n  change[0]='0';\n  for(int i=1;i<10;i++)change[i]=change[i-1]+1;\n  change[10]='A';\n  for(int i=11;i<36;i++)change[i]=change[i-1]+1;\n\n  while(1){\n    cin>>N>>M>>Q;\n    if(N==0&&M==0&&Q==0)break;\n    for(int i=0;i<Q;i++){\n      string str,str2;\n      cin>>str>>str2;\n      s[i]=func(str);\n      t[i]=func(str2);\n      if(i)s[i]=s[i]^s[i-1];\n    }\n\n    for(int i=0;i<M;i++){\n      ll f=(1LL<<N)-1;\n      for(int j=0;j<Q;j++){\n\tif((t[j]>>i)&1){\n\t  f=f&s[j];\n\t}else {\n\t  f=f&(~s[j]);\n\t}\n      }\n      assert(__builtin_popcountll(f)!=0);\n      if(__builtin_popcountll(f)==1){\n\tint ans=0;\n\tfor(ans=0;ans<N;ans++){\n\t  if(f==(1LL<<ans))break;\n\t}\n\tcout<<change[ans];\n      }else{\n\tcout<<'?';\n      }\n    }\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\nint main() {\n\tint n, m, q;\n\twhile (cin >> n >> m >> q, n) {\n\t\tif (q == 0) {\n\t\t\tif (n != 1) {\n\t\t\t\trep(i, m) {\n\t\t\t\t\tcout << \"?\";\n\t\t\t\t}\n\t\t\t\tcout << endl;\n\t\t\t}\n\t\t\telse {\n\t\t\t\trep(i, m) {\n\t\t\t\t\tcout << \"0\";\n\t\t\t\t}\n\t\t\t\tcout << endl;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tchar signal[1000][36];\n\t\tchar light[1000][1000];\n\t\trep(i, q) {\n\t\t\tstring s, t;\n\t\t\tcin >> s >> t;\n\t\t\trep(k, n) {\n\t\t\t\tsignal[i][k] = s[k];\n\t\t\t}\n\t\t\trep(k, m) {\n\t\t\t\tlight[i][k] = t[k];\n\t\t\t}\n\t\t}\n\t\trep(i, m) {\n\t\t\tint chk = -1; bool g = true;\n\t\t\trep(j, n) {\n\t\t\t\tbool f = true;\n\t\t\t\tint sum = 0;\n\t\t\t\trep(k, q) {\n\t\t\t\t\tsum += signal[k][j]-'0'; sum %= 2;\n\t\t\t\t\tif (sum != light[k][i]-'0') {\n\t\t\t\t\t\tf = false; break;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (f) {\n\t\t\t\t\tif (chk == -1)chk = j;\n\t\t\t\t\telse {\n\t\t\t\t\t\tbool g = false;\n\t\t\t\t\t\tcout << \"?\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!g)break;\n\t\t\t}\n\t\t\tif (g) {\n\t\t\t\tif (chk < 10) {\n\t\t\t\t\tcout << chk;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tcout << (char)('A' + chk - 10);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\n#define REP(i,n) for(ll i=0;i<n;++i)\n#define RREP(i,n) for(ll i=n-1;i>=0;--i)\n#define FOR(i,m,n) for(ll i=m;i<n;++i)\n#define RFOR(i,m,n) for(ll i=n-1;i>=m;--i)\n#define ALL(v) (v).begin(),(v).end()\n#define PB(a) push_back(a)\n#define UNIQUE(v) v.erase(unique(ALL(v)),v.end());\n#define DUMP(v) REP(aa, (v).size()) { cout << v[a]; if (a != v.size() - 1)cout << \" \"; else cout << endl; }\n#define INF 1000000001ll\n#define MOD 1000000007ll\n#define EPS 1e-9\n\nconst int dx[8] = { 1,1,0,-1,-1,-1,0,1 };\nconst int dy[8] = { 0,1,1,1,0,-1,-1,-1 };\n\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector<vi> vvi;\ntypedef vector<vl> vvl;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nll max(ll a, int b) { return max(a, ll(b)); }\nll max(int a, ll b) { return max(ll(a), b); }\nll min(ll a, int b) { return min(a, ll(b)); }\nll min(int a, ll b) { return min(ll(a), b); }\n///(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)///\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\twhile (1) {\n\t\tint n, m, q;\n\t\tcin >> n >> m >> q;\n\t\tif (!n)break;\n\t\tvvi v(m, vi(n, 1));\n\t\tstring prev;\n\t\tREP(i, m)prev += '0';\n\t\tREP(i, q) {\n\t\t\tstring a, b;\n\t\t\tcin >> a >> b;\n\t\t\tREP(j, m) {\n\t\t\t\tif (prev[j] != b[j]) {\n\t\t\t\t\tREP(k, n) {\n\t\t\t\t\t\tv[j][k] &= (a[k]-'0');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tREP(k, n) {\n\t\t\t\t\t\tv[j][k] &= (1-int(a[k] - '0'));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tprev = b;\n\t\t}\n\t\tREP(i, m) {\n\t\t\tint ans = -1, cnt = 0;\n\t\t\tREP(j, n) {\n\t\t\t\tif (v[i][j]) {\n\t\t\t\t\tcnt++;\n\t\t\t\t\tans = j;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (cnt == 1) {\n\t\t\t\tif (ans <= 9)cout << char(ans + '0');\n\t\t\t\telse cout << char(ans - 10 + 'A');\n\t\t\t}\n\t\t\telse cout << '?';\n\t\t}\n\t\tcout << endl;\n\t}\n\t\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "def inv(bit,m)\n    bs = bit.to_s(2)\n    if bs.length < m\n        bs = \"0\" * (m - bs.length) + bs\n    end\n    ret = \"\"\n    bs.each_char do |c|\n        ret << (c == \"0\" ? \"1\" : \"0\")\n    end\n    ret.to_i(2)\nend\nconv = ('0'..'9').to_a + ('A'..'Z').to_a\nloop do\n    n, m, q = gets.split.map(&:to_i)\n    break if n == 0 && m == 0 && q == 0\n    cor = Array.new(m,2**n-1)\n    prev = 0\n    q.times do\n        input = gets.chomp.split\n        s = input[0].to_i(2)\n        b = prev ^ input[1].to_i(2)\n        bs = b.to_s(2)\n        if bs.length < m\n            bs = \"0\" * (m - bs.length) + bs\n        end\n        inv = inv(s,m)\n        bs.each_char.with_index do |bit,i|\n            if bit == \"1\"\n                cor[i] &= s\n            else\n                cor[i] &= inv\n            end\n        end\n        prev = input[1].to_i(2)\n    end\n    ret = \"\"\n    cor.each do |c|\n        if c & (c-1) != 0\n            ret << \"?\"\n        else\n            t = n - 1 - Math.log2(c).to_i\n            ret << conv[t]\n        end\n    end\n    puts ret\nend"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  int n,m,q;\n  bool switches[1000][36],bulbes[1000][1000],cand[36][1000];\n  while(cin>>n>>m>>q,n){\n    for(int i=0;i<q;i++){\n      string s;\n      cin>>s;\n      for(int j=0;j<n;j++){\n\tswitches[i][j]=s[j]-'0';\n\tif(i!=0) switches[i][j]^=switches[i-1][j];\n      }\n      string b;\n      cin>>b;\n      for(int j=0;j<m;j++)\n\tbulbes[i][j]=b[j]-'0';\n    }\n    for(int i=0;i<n;i++)\n      for(int j=0;j<m;j++)\n\tcand[i][j]=1;\n    for(int i=0;i<q;i++)\n      for(int j=0;j<n;j++)\n\tfor(int k=0;k<m;k++)\n\t  cand[j][k]&=switches[i][j]==bulbes[i][k];\n    for(int i=0;i<m;i++){\n      int index=-1,cnt=0;\n      for(int j=0;j<n;j++)\n\tif(cand[j][i]){\n\t  index=j; cnt++;\n\t}\n      if(cnt>1) cout<<\"?\";\n      else if(index<10) cout<<index;\n      else cout<<(char)(index-10+'A');\n    }\n    cout<<endl;\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#define Q 1000\n#define N 36\nusing namespace std;\n\nint main(){\n  int n,m,q;\n  bool sw[N],swcp[N],licp[Q],s_[N];\n  string s[Q],b[Q];\n  vector<int> on,off,r;\n  char ans[Q];\n  while(1){\n    cin>>n>>m>>q;\n    if(!n&&!m&&!q) break;\n    for(int i=0;i<q;i++) cin>>s[i]>>b[i];\n    for(int i=0;i<n;i++) sw[i]=s_[i]=false;\n    for(int i=0;i<m;i++) licp[i]=false,ans[i]='?';\n    for(int i=0;i<q;i++){\n      for(int j=0;j<n;j++){\n\tswcp[j]=sw[j];\n\tif(s[i][j]=='1') sw[j]?sw[j]=false:sw[j]=true;\n      }\n      for(int j=0;j<n;j++){\n\tif(swcp[j]&&sw[j]) r.push_back(j);\n\tif(swcp[j]&&!sw[j]) off.push_back(j);\n\tif(!swcp[j]&&sw[j]) on.push_back(j);\n      }\n      if(r.size()==1){\n\tfor(int j=0;j<m;j++)\n\t  if(licp[j]&&(b[i][j]-'0')){\n\t    if(r[0]<=9) ans[j]=r[0]+'0';\n\t    else ans[j]=r[0]-10+'A';\n\t  }\n\ts_[r[0]]=true;\n      }\n      if(off.size()==1){\n\tfor(int j=0;j<m;j++)\n\t  if(licp[j]&&!(b[i][j]-'0')){\n\t    if(off[0]<=9) ans[j]=off[0]+'0';\n\t    else ans[j]=off[0]-10+'A';\n\t  }\n\ts_[off[0]]=true;\n      }\n      if(on.size()==1){\n\tfor(int j=0;j<m;j++)\n\t  if(!licp[j]&&(b[i][j]-'0')){\n\t    if(on[0]<=9) ans[j]=on[0]+'0';\n\t    else ans[j]=on[0]-10+'A';\n\t  }\n\ts_[on[0]]=true;\n      }\n      for(int j=0;j<m;j++) licp[j]=b[i][j]-'0';\n      r.clear();\n      on.clear();\n      off.clear();\n    }\n    int cnt=0;\n    char a;\n    for(int i=0;i<n;i++)\n      if(!s_[i]){\n\tcnt++;\n\tif(i<=9) a=i+'0';\n\telse a=i-10+'A';\n      }\n    if(cnt==1)\n      for(int j=0;j<m;j++)\n\tif(ans[j]=='?') ans[j]=a;\n    for(int i=0;i<m;i++)\n      cout<<ans[i];\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\n\nint main(){\n    while(true){\n        int n, m, q;\n        int data_s[1000][36];\n        int data_l[1000][1000];\n        //string data_s[1000];\n        //string data_l[1000];\n\n        cin >> n >> m >> q;\n        if(n == 0 && m == 0 && q == 0) break;\n        for(int i = 0; i < q; ++i){\n            string s1;\n            cin >> s1;\n            for(int j = 0; j < n; ++j){\n                data_s[i][j] = (int)(s1[j] - '0');\n           }\n           cin >> s1;\n            for(int j = 0; j < m; ++j){\n                data_l[i][j] = (int)(s1[j] - '0');\n           }\n        }\n        \n        for(int i = 1; i < q; i++) {\n            for(int j = 0; j < n; j++) {\n                if(data_s[i][j] == 1) {\n                    data_s[i][j] = data_s[i - 1][j] == 0 ? 1 : 0;\n                } else {\n                    data_s[i][j] = data_s[i - 1][j];\n                }\n            }\n        }\n\n        int ans[1000];\n        bool flag = false;\n\n        for(int i = 0; i < m; i++) {\n            ans[i] = -1;\n        }\n        for(int i = 0; i < n; i++) {\n            for(int j = 0; j < m; j++) {\n                int k;\n                for(k = 0; k < q; k++) {\n                    if(data_s[k][i] != data_l[k][j]) {\n                        break;\n                    }\n                }\n                if(k == q) {\n                    if(ans[j] == -1) {\n                        ans[j] = i;\n                    } else {\n                        cout << \"??\" << endl;\n                        flag = true;\n                    }\n                }\n            }\n            if(flag == true) break;\n        }\n\n        for(int i = 0; i < m; i++) {\n            if(ans[i] < 10) {\n                cout << ans[i];\n            } else {\n\n                cout << (char)('A' + (ans[i] - 10));\n            }\n        }\n        cout << endl;\n        /*for(int i = 0; i < q; ++i){\n            for(int j = 0; j < n; ++j){\n                cout << data_s[i][j] << \" \";\n            }\n            cout << endl;\n        }*/\n   }\n   return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <stdio.h>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <numeric>\n#include <string>\n#include <string.h>\n#include <map>\n#include <set>\n#include <functional>\n#include <complex>\n#include <stack>\n#include <tuple>\n#include <array>\n#include <ctype.h> // isdigit\n#include <cassert>\nusing namespace std;\n\n#define LE(n,m) ((n) < (m) + EPS * (abs(n) + abs(m)))\n#define GE(n,m) ((n) + EPS * (abs(n) + abs(m)) > (m))\n#define LT(n,m) ((n) + EPS * (abs(n) + abs(m)) < (m))\n#define GT(n,m) ((n) > (m) + EPS * (abs(n) + abs(m)))\n#define EQ(n,m) (abs((n)-(m)) < EPS * (abs(n) + abs(m)))\n\ntypedef long long int ll;\nconst int INF = (1<<30) - 1;\nconst double EPS = 1e-9;\nconst int MOD = 1000000007;\n\nint N, M, Q;\n\nset<int> merge(set<int> a, set<int> b){\n    set<int> ret;\n    for(auto p: a) if(b.find(p) != b.end()){\n        ret.insert(p);\n    }\n    return ret;\n}\n\n//g++ -std=c++0x -msse4.2 -O3\n//#include <bits/stdc++.h>\nint main(){\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    //cout.precision(16);\n    //cout.setf(ios::fixed);\n    \n    while(cin >> N >> M >> Q, N|M|Q){\n        string s, b;\n        ll t = 0;\n        vector<set<int>> conds(N);\n        for(int j=0; j<N; j++){\n            for(int k=0; k<M; k++)\n                conds[j].insert(k);\n        }\n        \n        for(int i=0; i<Q; i++){\n            cin >> s >> b;\n            \n            set<int> cond;\n            set<int> excond;\n            \n            for(int j=0; j<M; j++){\n                if(b[j] == '1'){\n                    cond.insert(j);\n                }else{\n                    excond.insert(j);\n                }\n            }\n            \n            for(int j=0; j<N; j++){\n                if(s[j] == '1')\n                    t ^= (1L<<j);\n                if((t>>j) & 1L){\n                    conds[j] = merge(conds[j], cond);\n                }else{\n                    conds[j] = merge(conds[j], excond);\n                }\n            }\n        }\n        \n        vector<vector<int>> ans(M);\n        \n        for(int i=0; i<N; i++){\n            for(auto p: conds[i])\n                ans[p].push_back(i);\n        }\n        for(int i=0; i<M; i++){\n            if(ans[i].size() != 1){\n                cout << '?';\n            }else{\n                if(ans[i][0] < 10){\n                    cout << ans[i][0];\n                }else{\n                    cout << (char('A'+(ans[i][0]-10)));\n                }\n            }\n        }\n        cout << endl;\n    }\n    \n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "// AOJ 2590: Unknown Switches\n// 2017.11.30 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\nlong long b[1002];\nint n;\nchar buf[1100], *p;\n\nint getint()\n{\n\tint n = 0;\n\twhile (*p >= '0') n = (n<<3) + (n<<1) + (*p++ & 0xf);\n\treturn n;\n}\n\nint check(long long x)\n{\n\tint k, f = 1;\n\n\tif (x == 0) return -1;\n\twhile (!(x & 1)) f++, x >>= 1;\n\tx >>= 1; if (x) return -1;\n\tk = n - f;\n\tif (k < 10) return k + '0';\n\treturn k - 10 + 'A';\n}\n\nint main()\n{\n\tint m, q, i, j, c;\n\tlong long s, t, mask;\n\n\twhile (fgets(p=buf, 30, stdin) && *p != '0') {\n\t\tn = getint(), p++, m = getint(), p++, q = getint();\n\n\t\tmemset(b, 0xff, sizeof(b));\n\t\tmask = (1LL << n) - 1;\n\n\t\tfor (s = 0, i = 0; i < q; i++) {\n\t\t\tfgets(p=buf, 1100, stdin);\n\t\t\tt = 0; while (*p >= '0') t = (t<<1) | (*p++ & 1);\n\t\t\ts = s ^ t;\n\n\t\t\tfor (p++, j = 0; j < m; j++) {\n\t\t\t\tif (*p++ & 1) b[j] &=  s;\n\t\t\t\telse          b[j] &= ~s;\n\t\t\t}\n\t    }\n\n\t\tfor (i = 0; i < m; i++) {\n\t\t\tif ((c = check(b[i] & mask)) > 0) putchar(c);\n\t\t\telse putchar('?');\n\t\t}\n\t\tputchar('\\n');\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\nchar a[2][1010], b[1010][40];\nconst char* str=\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\nint main(void)\n{\n    int n, m, q;\n    while (scanf(\"%d%d%d\", &n, &m, &q), n) {\n        int i, j, k=0;\n        memset(a, '0', sizeof(a));\n        memset(b, 1, sizeof(b));\n        while (q--) {\n            char s[60];\n            scanf(\"%s%s\", s, a[k]);\n            for(i=0;i<n;++i) for(j=0;j<m;++j)\n                if ((a[k][j]==a[1-k][j])==(s[i]=='1')) b[j][i]=0;\n            k=1-k;\n        }\n        for(i=0;i<m;++i) {\n            int p=0, res;\n            for(j=0;j<n;++j) if (b[i][j]==1) { ++p; res=j; }\n            putchar(p==1?str[res]:'?');\n        }\n        puts(\"\");\n    }\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "// AOJ 2590: Unknown Switches\n// 2017.11.30 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\nchar sw[1002][38];\nchar bul[1002][1002];\nchar can[38][1002];\n\nint main()\n{\n\tint n, m, q, i, j, k, c, cnt;\n\tchar b1[40], b2[1010], *p;\n\n\twhile (scanf(\"%d%d%d\", &n, &m, &q) && n > 0) {\n\t\tmemset(sw, 0, sizeof(sw));\n\t\tmemset(bul, 0, sizeof(bul));\n\t    memset(can, 1, sizeof(can));\n\t\tfor (i = 0; i < q; i++) {\n\t\t\tscanf(\"%s%s\", b1, b2);\n\t\t\tfor (p = b1, j = 0; j < n; j++) {\n\t\t\t\tsw[i][j] = *p++ & 1;\n\t\t\t\tif (i > 0) sw[i][j] ^= sw[i-1][j];\n\t\t\t}\n\t\t\tfor (p = b2, j = 0; j < m; j++) bul[i][j] = *p++ & 1;\n\t    }\n\n\t    for (i = 0; i < q; i++) for (j = 0; j < n; j++) for (k = 0; k < m; k++)\n\t\t\tcan[j][k] &= (sw[i][j] == bul[i][k]);\n\n\t\tfor (i = 0; i < m; i++) {\n\t\t\tfor (cnt = 0, j = 0; j < n; j++) if (can[j][i]) cnt++, k = j;\n\t\t\tif (cnt > 1) c = '?';\n\t\t\telse if (k < 10) c = k + '0';\n\t\t\telse             c = k -10 + 'A';\n\t\t\tputchar(c);\n\t\t}\n\t\tputchar('\\n');\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nint main(void) {\n\tint N,M,Q;\n\twhile(scanf(\"%d%d%d\",&N,&M,&Q)==3 && (N|M|Q)!=0) {\n\t\tchar sw[64];\n\t\tchar op[64];\n\t\tchar stat[1024];\n\t\tchar cannot_taiou[1000][36]={{0}};\n\t\tint i,j,k;\n\t\tfor(i=0;i<N;i++)sw[i]=0;\n\t\tfor(i=0;i<Q;i++) {\n\t\t\tif(scanf(\"%s%s\",op,stat)!=2)return 1;\n\t\t\tfor(j=0;j<N;j++) {\n\t\t\t\tif(op[j]=='1')sw[j]=1-sw[j];\n\t\t\t}\n\t\t\tfor(j=0;j<M;j++) {\n\t\t\t\tfor(k=0;k<N;k++) {\n\t\t\t\t\tif(stat[j]-'0'!=sw[k])cannot_taiou[j][k]=1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(i=0;i<M;i++) {\n\t\t\tint candidate=-1;\n\t\t\tint candidate_count=0;\n\t\t\tfor(j=0;j<N;j++) {\n\t\t\t\tif(!cannot_taiou[i][j]) {\n\t\t\t\t\tcandidate=j;\n\t\t\t\t\tcandidate_count++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(candidate_count!=1)putchar('?');\n\t\t\telse if(candidate<10)putchar(candidate+'0');\n\t\t\telse if(candidate<36)putchar(candidate-10+'A');\n\t\t\telse putchar('!');\n\t\t}\n\t\tputchar('\\n');\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\nchar a[2][1010], b[1010][40];\nconst char* str=\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\nint main(void)\n{\n    int n, m, q;\n    while (scanf(\"%d%d%d\", &n, &m, &q), n) {\n        int i, j, k=0;\n        memset(a, '0', sizeof(a));\n        memset(b, 1, sizeof(b));\n        while (q--) {\n            char s[60];\n            scanf(\"%s%s\", s, a[k]);\n            for(i=0;i<n;++i) for(j=0;j<m;++j) {\n                if (s[i]=='1')\n                    b[j][i]=(b[j][i] && a[k][j]==a[1-k][j])?0:b[j][i];\n                else if (a[k][j]!=a[1-k][j])\n                    b[j][i]=0;\n            }\n            k=1-k;\n        }\n        for(i=0;i<m;++i) {\n            int p=0, res;\n            for(j=0;j<n;++j) if (b[i][j]==1) { ++p; res=j; }\n            putchar(p==1?str[res]:'?');\n        }\n        puts(\"\");\n    }\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "// AOJ 2590: Unknown Switches\n// 2017.11.30 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\nlong long b[1002];\nint n;\n\nint bitcount64(long long x)\n{\n\tx = ((x & 0xAAAAAAAAAAAAAALL) >>  1) + (x & 0x55555555555555LL);\n\tx = ((x & 0xCCCCCCCCCCCCCCLL) >>  2) + (x & 0x33333333333333LL);\n\tx = ((x & 0xF0F0F0F0F0F0F0LL) >>  4) + (x & 0x0F0F0F0F0F0F0FLL);\n\tx = ((x & 0x00FF00FF00FF00LL) >>  8) + (x & 0xFF00FF00FF00FFLL);\n\tx = ((x & 0xFF0000FFFF0000LL) >> 16) + (x & 0x00FFFF0000FFFFLL);\n\tx = ((x & 0xFFFFFF00000000LL) >> 32) + (x & 0x000000FFFFFFFFLL);\n\treturn (int)x;\n}\n\nint tr(long long x)\n{\n\tint k, f = 1;\n\n\twhile (!(x & 1)) f++, x >>= 1;\n\tk = n - f;\n\tif (k < 10) return k + '0';\n\treturn k -10 + 'A';\n}\n\nint main()\n{\n\tint m, q, i, j;\n\tchar b1[40], b2[1010], *p;\n\tlong long s, t, mask;\n\n\twhile (scanf(\"%d%d%d\", &n, &m, &q) && n > 0) {\n\t\tmemset(b, 0xff, sizeof(b));\n\t\tmask = (1 << n) - 1;\n\n\t\tfor (s = 0, i = 0; i < q; i++) {\n\t\t\tscanf(\"%s%s\", b1, b2);\n\t\t\tt = 0, p = b1; while (*p >= '0') t = (t<<1) | (*p++ & 1);\n\t\t\ts ^= t;\n\n\t\t\tfor (p = b2, j = 0; j < m; j++) {\n\t\t\t\tif (*p++ & 1) b[j] &=  s;\n\t\t\t\telse          b[j] &= ~s;\n\t\t\t}\n\t    }\n\n\t\tfor (i = 0; i < m; i++) {\n\t\t\tif (bitcount64(b[i] & mask) == 1) putchar(tr(b[i]));\n\t\t\telse putchar('?');\n\t\t}\n\t\tputchar('\\n');\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\nint N,M,Q,i,j,k;\nchar S[1000],B[1005],*s=\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\",res[1005];\nint flg[1005][37],f,f2;\n\nint main()\n{\n\tfor(;scanf(\"%d%d%d\\n\",&N,&M,&Q),N;)\n\t{\n\t\tint swt[37]={0};\n\t\tmemset(res,0,sizeof(res));\n\t\tfor(i=0;i<M;i++)for(j=0;j<N;j++)flg[i][j]=1;\n\t\tfor(i=0;i<Q;i++)\n\t\t{\n\t\t\tscanf(\"%s %s\\n\",S,B);\n\t\t\tfor(j=0;j<N;j++)\n\t\t\t{\n\t\t\t\tswt[j]^=(S[j]=='1'?1:0);\n\t\t\t\tfor(k=0;k<M;k++)\n\t\t\t\t{\n\t\t\t\t\tif(flg[k][j]!=0&&swt[j]&&B[k]=='1')flg[k][j]=1;\n\t\t\t\t\telse if(flg[k][j]!=0&&swt[j]&&B[k]=='0')flg[k][j]=0;\n\t\t\t\t\telse if(flg[k][j]!=0&&(!swt[j])&&B[k]=='1')flg[k][j]=0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tf2=0;\n\t\tfor(i=0;i<M;i++)\n\t\t{\n\t\t\tf=-1;\n\t\t\tfor(j=0;j<N;j++)\n\t\t\t{\n\t\t\t\tif(f!=-2&&flg[i][j]==1)\n\t\t\t\t{\n\t\t\t\t\tif(f!=-1)f=-2;\n\t\t\t\t\telse f=j;\n\t\t\t\t}\n\t\t\t}\n\t\t\tres[i]=(f==-2?'?':s[f]);\n\t\t}\n\t\t//for(i=0;i<M;i++)\n\t\tputs(res);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.*;\nimport java.io.*;\n\npublic class Main{\n    static final Reader sc = new Reader();\n    static final PrintWriter out = new PrintWriter(System.out,false);\n\n    public static void main(String[] args) throws Exception {\n    \tString ans = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n    \twhile(true){\n    \t\tint n = sc.nextInt();\n    \t\tint m = sc.nextInt();\n    \t\tint q = sc.nextInt();\n    \t\tif(n==0 && m==0 && q==0){\n    \t\t\tbreak;\n    \t\t}\n    \t\tboolean[][] judge = new boolean[n][m];\n            for(int i=0;i<n;i++){\n                Arrays.fill(judge[i],true);\n            }\n            String[] s = new String[q];\n            String[] b = new String[q];\n            for(int i=0;i<q;i++){\n                s[i] = sc.next();\n                b[i] = sc.next();\n            }\n            boolean[] nows = new boolean[n];\n            for(int i=0;i<q;i++){\n                for(int j=0;j<n;j++){\n                    if(s[i].charAt(j)=='1'){\n                        nows[j] = !nows[j];\n                    }\n                    for(int k=0;k<m;k++){\n                        if(nows[j] && b[i].charAt(k)=='0'){\n                            judge[j][k] = false;\n                        }\n                        else if(!nows[j] && b[i].charAt(k)=='1'){\n                            judge[j][k] = false;\n                        }\n                    }\n                }\n            }\n            for(int i=0;i<m;i++){\n                int flag = 0;\n                int now = -1;\n                for(int j=0;j<n;j++){\n                    if(judge[j][i]){\n                        flag++;\n                        now = j;\n                    }\n                }\n                if(flag==1){\n                    out.print(ans.charAt(now));\n                }\n                else{\n                    out.print(\"?\");\n                }\n                out.flush();\n            }\n    \t}\n\n        sc.close();\n        out.close();\n    }\n\n    static void trace(Object... o) { System.out.println(Arrays.deepToString(o));}\n}\n\nclass Reader {\n\n    private final InputStream in;\n    private final byte[] buf = new byte[1024];\n    private int ptr = 0;\n    private int buflen = 0;\n\n    public Reader() { this(System.in);}\n    public Reader(InputStream source) { this.in = source;}\n\n    private boolean hasNextByte() {\n        if (ptr < buflen) return true;\n        ptr = 0;\n        try{\n            buflen = in.read(buf);\n        }catch (IOException e) {e.printStackTrace();}\n        if (buflen <= 0) return false;\n        return true;\n    }\n\n    private int readByte() { if (hasNextByte()) return buf[ptr++]; else return -1;}\n\n    private boolean isPrintableChar(int c) { return 33 <= c && c <= 126;}\n\n    private void skip() { while(hasNextByte() && !isPrintableChar(buf[ptr])) ptr++;}\n\n    public boolean hasNext() {skip(); return hasNextByte();}\n\n    public String next() {\n        if (!hasNext()) throw new NoSuchElementException();\n        StringBuilder sb = new StringBuilder();\n        int b = readByte();\n        while (isPrintableChar(b)) {\n            sb.appendCodePoint(b);\n            b = readByte();\n        }\n        return sb.toString();\n    }\n\n    public long nextLong() {\n        if (!hasNext()) throw new NoSuchElementException();\n        boolean minus = false;\n        long num = readByte();\n\n        if(num == '-'){\n            num = 0;\n            minus = true;\n        }else if (num < '0' || '9' < num){\n            throw new NumberFormatException();\n        }else{\n            num -= '0';\n        }\n\n        while(true){\n            int b = readByte();\n            if('0' <= b && b <= '9')\n                num = num * 10 + (b - '0');\n            else if(b == -1 || !isPrintableChar(b))\n                return minus ? -num : num;\n            else\n                throw new NoSuchElementException();\n        }\n    }\n\n    public int nextInt() {\n        long num = nextLong();\n        if (num < Integer.MIN_VALUE || Integer.MAX_VALUE < num)\n            throw new NumberFormatException();\n        return (int)num;\n    }\n\n    public double nextDouble() {\n        return Double.parseDouble(next());\n    }\n\n    public char nextChar() {\n        if (!hasNext()) throw new NoSuchElementException();\n        return (char)readByte();\n    }\n\n    public String nextLine() {\n        while (hasNextByte() && (buf[ptr] == '\\n' || buf[ptr] == '\\r')) ptr++;\n        if (!hasNextByte()) throw new NoSuchElementException();\n\n        StringBuilder sb = new StringBuilder();\n        int b = readByte();\n        while (b != '\\n' && b != '\\r') {\n            sb.appendCodePoint(b);\n            b = readByte();\n        }\n\n        return sb.toString();\n    }\n\n    public int[] nextIntArray(int n) {\n        int[] res = new int[n];\n        for (int i=0; i<n; i++) res[i] = nextInt();\n        return res;\n    }\n\n    public char[] nextCharArray(int n) {\n        char[] res = new char[n];\n        for (int i=0; i<n; i++) res[i] = nextChar();\n        return res;\n    }\n\n    public void close() {try{ in.close();}catch(IOException e){ e.printStackTrace();}};\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.HashSet;\nimport java.util.Arrays;\nimport java.util.AbstractCollection;\nimport java.util.Scanner;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n */\npublic class Main {\n    public static void main(String[] args) {\n        InputStream inputStream = System.in;\n        OutputStream outputStream = System.out;\n        Scanner in = new Scanner(inputStream);\n        PrintWriter out = new PrintWriter(outputStream);\n        UnknownSwitches solver = new UnknownSwitches();\n        try {\n            int testNumber = 1;\n            while (true)\n                solver.solve(testNumber++, in, out);\n        } catch (UnknownError e) {\n            out.close();\n        }\n    }\n\n    static class UnknownSwitches {\n        public void solve(int testNumber, Scanner in, PrintWriter out) {\n            final int N = in.nextInt();\n            final int M = in.nextInt();\n            final int Q = in.nextInt();\n            if (N == 0 && M == 0 && Q == 0) throw new UnknownError();\n            String[] S = new String[Q + 1];\n            String[] B = new String[Q + 1];\n            S[0] = new String();\n            for (int i = 0; i < N; i++) {\n                S[0] += \"0\";\n            }\n            B[0] = new String();\n            for (int i = 0; i < M; i++) {\n                B[0] += \"0\";\n            }\n            for (int i = 0; i < Q; i++) {\n                S[i + 1] = in.next();\n                B[i + 1] = in.next();\n            }\n            StringBuilder buildAns = new StringBuilder();\n            for (int i = 0; i < M; i++) {\n                buildAns.append(\"?\");\n            }\n            boolean[] isHatena = new boolean[M];\n            boolean[] visited = new boolean[N];\n            Arrays.fill(isHatena, false);\n            Arrays.fill(visited, false);\n\n            HashSet<Integer>[] sets = new HashSet[Q];\n            for (int i = 0; i < Q; i++) {\n                sets[i] = new HashSet<Integer>();\n                for (int j = 0; j < M; j++) {\n                    if (B[i].charAt(j) != B[i + 1].charAt(j)) {\n                        sets[i].add(j);\n                    }\n                }\n            }\n\n            for (int i = 0; i < N; i++) {\n                HashSet<Integer> masterSet = new HashSet<>();\n                HashSet<Integer> masterNgSet = new HashSet<>();\n                for (int j = 1; j <= Q; j++) {\n                    if (S[j].charAt(i) == '1') {\n                        visited[i] = true;\n                        if (masterSet.size() == 0) {\n                            masterSet.addAll(sets[j - 1]);\n                        } else {\n                            masterSet.retainAll(sets[j - 1]);\n                        }\n                    } else {\n                        masterNgSet.addAll(sets[j - 1]);\n                    }\n                }\n                for (int e : masterSet) {\n                    if (!isHatena[e]) {\n                        if (buildAns.charAt(e) != '?' && buildAns.charAt(e) != cc(i) && !masterNgSet.contains(e)) {\n                            //System.err.println(buildAns.charAt(e) + \" \" + cc(i));\n                            isHatena[e] = true;\n                        } else if (!masterNgSet.contains(e)) {\n                            buildAns.setCharAt(e, cc(i));\n                        }\n                    }\n                }\n            }\n            int cnt = 0;\n            int notVisit = -1;\n            for (int i = 0; i < N; i++) {\n                if (!visited[i]) {\n                    cnt++;\n                    notVisit = i;\n                }\n            }\n            if (cnt == 1) {\n                for (int i = 0; i < M; i++) {\n                    if (buildAns.charAt(i) == '?' && !isHatena[i]) {\n                        buildAns.setCharAt(i, cc(notVisit));\n                    }\n                }\n            }\n            for (int i = 0; i < M; i++) {\n                if (isHatena[i]) {\n                    buildAns.setCharAt(i, '?');\n                }\n            }\n            out.println(buildAns);\n        }\n\n        char cc(int n) {\n            if (0 <= n && n <= 9) return (char) (n + '0');\n            else return (char) (n - 10 + 'A');\n        }\n\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.HashSet;\nimport java.io.PrintStream;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n */\npublic class Main {\n    public static void main(String[] args) {\n        InputStream inputStream = System.in;\n        OutputStream outputStream = System.out;\n        Scanner in = new Scanner(inputStream);\n        PrintWriter out = new PrintWriter(outputStream);\n        UnknownSwitches solver = new UnknownSwitches();\n        try {\n            int testNumber = 1;\n            while (true)\n                solver.solve(testNumber++, in, out);\n        } catch (UnknownError e) {\n            out.close();\n        }\n    }\n\n    static class UnknownSwitches {\n        public void solve(int testNumber, Scanner in, PrintWriter out) {\n            final int N = in.nextInt();\n            final int M = in.nextInt();\n            final int Q = in.nextInt();\n            if (N == 0 && M == 0 && Q == 0) throw new UnknownError();\n            String[] S = new String[Q + 1];\n            String[] B = new String[Q + 1];\n            S[0] = new String();\n            for (int i = 0; i < N; i++) {\n                S[0] += \"0\";\n            }\n            B[0] = new String();\n            for (int i = 0; i < M; i++) {\n                B[0] += \"0\";\n            }\n            for (int i = 0; i < Q; i++) {\n                S[i + 1] = in.next();\n                B[i + 1] = in.next();\n            }\n            StringBuilder buildAns = new StringBuilder();\n            for (int i = 0; i < M; i++) {\n                buildAns.append(\"?\");\n            }\n            boolean[] isHatena = new boolean[M];\n            boolean[] visited = new boolean[N];\n            Arrays.fill(isHatena, false);\n            Arrays.fill(visited, false);\n\n            for (int i = 0; i < N; i++) {\n                HashSet<Integer> masterSet = new HashSet<>();\n                HashSet<Integer> masterNgSet = new HashSet<>();\n                for (int j = 1; j <= Q; j++) {\n                    HashSet<Integer> set = new HashSet<>();\n                    for (int k = 0; k < M; k++) {\n                        if (B[j].charAt(k) != B[j - 1].charAt(k)) {\n                            set.add(k);\n                        }\n                    }\n                    if (S[j].charAt(i) == '1') {\n                        visited[i] = true;\n                        if (masterSet.size() == 0) {\n                            masterSet = set;\n                        } else {\n                            HashSet<Integer> ngset = new HashSet<>();\n                            for (int e : masterSet) {\n                                if (!set.contains(e)) {\n                                    ngset.add(e);\n                                }\n                            }\n                            for (int e : ngset) {\n                                masterSet.remove(e);\n                            }\n                        }\n                    } else {\n                        for (int e : set) {\n                            masterNgSet.add(e);\n                        }\n                    }\n                }\n                for (int e : masterSet) {\n                    if (!isHatena[e]) {\n                        if (buildAns.charAt(e) != '?' && buildAns.charAt(e) != cc(i) && !masterNgSet.contains(e)) {\n                            System.err.println(buildAns.charAt(e) + \" \" + cc(i));\n                            isHatena[e] = true;\n                        } else if (!masterNgSet.contains(e)) {\n                            buildAns.setCharAt(e, cc(i));\n                        }\n                    }\n                }\n            }\n            int cnt = 0;\n            int notVisit = -1;\n            for (int i = 0; i < N; i++) {\n                if (!visited[i]) {\n                    cnt++;\n                    notVisit = i;\n                }\n            }\n            if (cnt == 1) {\n                for (int i = 0; i < M; i++) {\n                    if (buildAns.charAt(i) == '?' && !isHatena[i]) {\n                        buildAns.setCharAt(i, cc(notVisit));\n                    }\n                }\n            }\n            for (int i = 0; i < M; i++) {\n                if (isHatena[i]) {\n                    buildAns.setCharAt(i, '?');\n                }\n            }\n            out.println(buildAns);\n        }\n\n        char cc(int n) {\n            if (0 <= n && n <= 9) return (char) (n + '0');\n            else return (char) (n - 10 + 'A');\n        }\n\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.HashSet;\nimport java.util.Arrays;\nimport java.util.AbstractCollection;\nimport java.util.Scanner;\nimport java.util.ArrayList;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n */\npublic class Main {\n    public static void main(String[] args) {\n        InputStream inputStream = System.in;\n        OutputStream outputStream = System.out;\n        Scanner in = new Scanner(inputStream);\n        PrintWriter out = new PrintWriter(outputStream);\n        UnknownSwitches solver = new UnknownSwitches();\n        try {\n            int testNumber = 1;\n            while (true)\n                solver.solve(testNumber++, in, out);\n        } catch (UnknownError e) {\n            out.close();\n        }\n    }\n\n    static class UnknownSwitches {\n        public void solve(int testNumber, Scanner in, PrintWriter out) {\n            final int N = in.nextInt();\n            final int M = in.nextInt();\n            final int Q = in.nextInt();\n            if (N == 0 && M == 0 && Q == 0) throw new UnknownError();\n            String[] S = new String[Q + 1];\n            String[] B = new String[Q + 1];\n            S[0] = new String();\n            for (int i = 0; i < N; i++) {\n                S[0] += \"0\";\n            }\n            B[0] = new String();\n            for (int i = 0; i < M; i++) {\n                B[0] += \"0\";\n            }\n            for (int i = 0; i < Q; i++) {\n                S[i + 1] = in.next();\n                B[i + 1] = in.next();\n            }\n            StringBuilder buildAns = new StringBuilder();\n            for (int i = 0; i < M; i++) {\n                buildAns.append(\"?\");\n            }\n            boolean[] isHatena = new boolean[M];\n            boolean[] visited = new boolean[N];\n            Arrays.fill(isHatena, false);\n            Arrays.fill(visited, false);\n\n            ArrayList<HashSet<Integer>> sets = new ArrayList<>();\n            for (int i = 0; i < Q; i++) {\n                HashSet<Integer> set = new HashSet<>();\n                for (int j = 0; j < M; j++) {\n                    if (B[i].charAt(j) != B[i + 1].charAt(j)) {\n                        set.add(j);\n                    }\n                }\n                sets.add(set);\n            }\n\n            for (int i = 0; i < N; i++) {\n                HashSet<Integer> masterSet = new HashSet<>();\n                HashSet<Integer> masterNgSet = new HashSet<>();\n                for (int j = 1; j <= Q; j++) {\n                    if (S[j].charAt(i) == '1') {\n                        visited[i] = true;\n                        if (masterSet.size() == 0) {\n                            masterSet.addAll(sets.get(j - 1));\n                        } else {\n                            masterSet.retainAll(sets.get(j - 1));\n                        }\n                    } else {\n                        masterNgSet.addAll(sets.get(j - 1));\n                    }\n                }\n                for (int e : masterSet) {\n                    if (!isHatena[e]) {\n                        if (buildAns.charAt(e) != '?' && buildAns.charAt(e) != cc(i) && !masterNgSet.contains(e)) {\n                            //System.err.println(buildAns.charAt(e) + \" \" + cc(i));\n                            isHatena[e] = true;\n                        } else if (!masterNgSet.contains(e)) {\n                            buildAns.setCharAt(e, cc(i));\n                        }\n                    }\n                }\n            }\n            int cnt = 0;\n            int notVisit = -1;\n            for (int i = 0; i < N; i++) {\n                if (!visited[i]) {\n                    cnt++;\n                    notVisit = i;\n                }\n            }\n            if (cnt == 1) {\n                for (int i = 0; i < M; i++) {\n                    if (buildAns.charAt(i) == '?' && !isHatena[i]) {\n                        buildAns.setCharAt(i, cc(notVisit));\n                    }\n                }\n            }\n            for (int i = 0; i < M; i++) {\n                if (isHatena[i]) {\n                    buildAns.setCharAt(i, '?');\n                }\n            }\n            out.println(buildAns);\n        }\n\n        char cc(int n) {\n            if (0 <= n && n <= 9) return (char) (n + '0');\n            else return (char) (n - 10 + 'A');\n        }\n\n    }\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.*;\nimport java.io.*;\n\npublic class Main{\n    static final Reader sc = new Reader();\n    static final PrintWriter out = new PrintWriter(System.out,false);\n\n    public static void main(String[] args) throws Exception {\n    \tString ans = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n    \twhile(true){\n    \t\tint n = sc.nextInt();\n    \t\tint m = sc.nextInt();\n    \t\tint q = sc.nextInt();\n    \t\tif(n==0 && m==0 && q==0){\n    \t\t\tbreak;\n    \t\t}\n    \t\tboolean[][] judge = new boolean[n][m];\n            for(int i=0;i<n;i++){\n                Arrays.fill(judge[i],true);\n            }\n            String[] s = new String[q];\n            String[] b = new String[q];\n            for(int i=0;i<q;i++){\n                s[i] = sc.next();\n                b[i] = sc.next();\n            }\n            boolean[] nows = new boolean[n];\n            for(int i=0;i<q;i++){\n                for(int j=0;j<n;j++){\n                    if(s[i].charAt(j)=='1'){\n                        nows[j] = !nows[j];\n                    }\n                    for(int k=0;k<m;k++){\n                        if(nows[j] && b[i].charAt(k)=='0'){\n                            judge[j][k] = false;\n                        }\n                        else if(!nows[j] && b[i].charAt(k)=='1'){\n                            judge[j][k] = false;\n                        }\n                    }\n                }\n            }\n            for(int i=0;i<m;i++){\n                int flag = 0;\n                int now = -1;\n                for(int j=0;j<n;j++){\n                    if(judge[j][i]){\n                        flag++;\n                        now = j;\n                    }\n                }\n                if(flag==1){\n                    out.print(ans.charAt(now));\n                }\n                else{\n                    out.print(\"?\");\n                }\n                out.println();\n                out.flush();\n            }\n    \t}\n\n        sc.close();\n        out.close();\n    }\n\n    static void trace(Object... o) { System.out.println(Arrays.deepToString(o));}\n}\n\nclass Reader {\n\n    private final InputStream in;\n    private final byte[] buf = new byte[1024];\n    private int ptr = 0;\n    private int buflen = 0;\n\n    public Reader() { this(System.in);}\n    public Reader(InputStream source) { this.in = source;}\n\n    private boolean hasNextByte() {\n        if (ptr < buflen) return true;\n        ptr = 0;\n        try{\n            buflen = in.read(buf);\n        }catch (IOException e) {e.printStackTrace();}\n        if (buflen <= 0) return false;\n        return true;\n    }\n\n    private int readByte() { if (hasNextByte()) return buf[ptr++]; else return -1;}\n\n    private boolean isPrintableChar(int c) { return 33 <= c && c <= 126;}\n\n    private void skip() { while(hasNextByte() && !isPrintableChar(buf[ptr])) ptr++;}\n\n    public boolean hasNext() {skip(); return hasNextByte();}\n\n    public String next() {\n        if (!hasNext()) throw new NoSuchElementException();\n        StringBuilder sb = new StringBuilder();\n        int b = readByte();\n        while (isPrintableChar(b)) {\n            sb.appendCodePoint(b);\n            b = readByte();\n        }\n        return sb.toString();\n    }\n\n    public long nextLong() {\n        if (!hasNext()) throw new NoSuchElementException();\n        boolean minus = false;\n        long num = readByte();\n\n        if(num == '-'){\n            num = 0;\n            minus = true;\n        }else if (num < '0' || '9' < num){\n            throw new NumberFormatException();\n        }else{\n            num -= '0';\n        }\n\n        while(true){\n            int b = readByte();\n            if('0' <= b && b <= '9')\n                num = num * 10 + (b - '0');\n            else if(b == -1 || !isPrintableChar(b))\n                return minus ? -num : num;\n            else\n                throw new NoSuchElementException();\n        }\n    }\n\n    public int nextInt() {\n        long num = nextLong();\n        if (num < Integer.MIN_VALUE || Integer.MAX_VALUE < num)\n            throw new NumberFormatException();\n        return (int)num;\n    }\n\n    public double nextDouble() {\n        return Double.parseDouble(next());\n    }\n\n    public char nextChar() {\n        if (!hasNext()) throw new NoSuchElementException();\n        return (char)readByte();\n    }\n\n    public String nextLine() {\n        while (hasNextByte() && (buf[ptr] == '\\n' || buf[ptr] == '\\r')) ptr++;\n        if (!hasNextByte()) throw new NoSuchElementException();\n\n        StringBuilder sb = new StringBuilder();\n        int b = readByte();\n        while (b != '\\n' && b != '\\r') {\n            sb.appendCodePoint(b);\n            b = readByte();\n        }\n\n        return sb.toString();\n    }\n\n    public int[] nextIntArray(int n) {\n        int[] res = new int[n];\n        for (int i=0; i<n; i++) res[i] = nextInt();\n        return res;\n    }\n\n    public char[] nextCharArray(int n) {\n        char[] res = new char[n];\n        for (int i=0; i<n; i++) res[i] = nextChar();\n        return res;\n    }\n\n    public void close() {try{ in.close();}catch(IOException e){ e.printStackTrace();}};\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\npublic class Main { \n\tpublic static void main(String[] args) {\n\t\tScanner stdIn = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tint n = stdIn.nextInt();\n\t\t\tint m = stdIn.nextInt();\n\t\t\tint q = stdIn.nextInt();\n\t\t\tif(n == 0 && m == 0 && q == 0) break;\n\t\t\tString[] S = new String[q];\n\t\t\tString[] B = new String[q];\n\t\t\tfor(int i = 0; i < q; i++) {\n\t\t\t\tS[i] = stdIn.next();\n\t\t\t\tB[i] = stdIn.next();\n\t\t\t}\n\t\t\tboolean[][] SX = new boolean[q][n];\n\t\t\tboolean[][] BX = new boolean[q][m];\n\t\t\tfor(int i = 0; i < q; i++) {\n\t\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\t\tSX[i][j] = (S[i].charAt(j) == '1')?true:false;\n\t\t\t\t}\n\t\t\t\tfor(int j = 0; j < m; j++) {\n\t\t\t\t\tBX[i][j] = (B[i].charAt(j) == '1')?true:false;\n\t\t\t\t}\n\t\t\t\tif(i != 0) {\n\t\t\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\t\t\tSX[i][j] = (S[i].charAt(j) == '1')?!SX[i-1][j]:SX[i-1][j];\n\t\t\t\t\t}\n\t\t\t\t\tfor(int j = 0; j < m; j++) {\n\t\t\t\t\t\tBX[i][j] = (B[i].charAt(j) == '1')?true:false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tint[] ans = new int[m];\n\t\t\tfor(int i = 0; i < m; i++) {\n\t\t\t\tans[i] = -1;\n\t\t\t}\n\t\t\tboolean[] already = new boolean[n];\n\t\t\tfor(int i = 0; i < 2; i++) {\n\t\t\t\tfor(int j = 0; j < q; j++) {\n\t\t\t\t\tint Tid = 0;\n\t\t\t\t\tint Fid = 0;\n\t\t\t\t\tint Tcount = 0;\n\t\t\t\t\tint Fcount = 0;\n\t\t\t\t\tfor(int k = 0; k < n; k++) {\n\t\t\t\t\t\tif(SX[j][k] && !already[k]) {\n\t\t\t\t\t\t\tTcount++;\n\t\t\t\t\t\t\tTid = k;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(!SX[j][k] && !already[k]) {\n\t\t\t\t\t\t\tFcount++;\n\t\t\t\t\t\t\tFid = k;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(Tcount == 1) {\n\t\t\t\t\t\tfor(int k = 0; k < m; k++) {\n\t\t\t\t\t\t\talready[Tid] = true;\n\t\t\t\t\t\t\tif(BX[j][k] && ans[k] == -1) {\n\t\t\t\t\t\t\t\tans[k] = Tid+1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(Fcount == 1) {\n\t\t\t\t\t\tfor(int k = 0; k < m; k++) {\n\t\t\t\t\t\t\talready[Fid] = true;\n\t\t\t\t\t\t\tif(!BX[j][k] && ans[k] == -1) {\n\t\t\t\t\t\t\t\tans[k] = Fid+1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(n == 1 && m == 1) {\n\t\t\t\tSystem.out.println(0);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfor(int i = 0; i < ans.length; i++) {\n\t\t\t\tif(ans[i] == -1) {\n\t\t\t\t\tSystem.out.print(\"?\");\n\t\t\t\t}\n\t\t\t\telse if(ans[i] <= 10) {\n\t\t\t\t\tchar a = '0';\n\t\t\t\t\ta += ans[i]-1;\n\t\t\t\t\tSystem.out.print(a);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tchar a = 'A';\n\t\t\t\t\ta += (ans[i] - 11);\n\t\t\t\t\tSystem.out.print(a);\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\npublic class Main { \n\tpublic static void main(String[] args) {\n\t\tScanner stdIn = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tint n = stdIn.nextInt();\n\t\t\tint m = stdIn.nextInt();\n\t\t\tint q = stdIn.nextInt();\n\t\t\tif(n == 0 && m == 0 && q == 0) break;\n\t\t\tString[] S = new String[q];\n\t\t\tString[] B = new String[q];\n\t\t\tfor(int i = 0; i < q; i++) {\n\t\t\t\tS[i] = stdIn.next();\n\t\t\t\tB[i] = stdIn.next();\n\t\t\t}\n\t\t\tboolean[][] SX = new boolean[q][n];\n\t\t\tboolean[][] BX = new boolean[q][m];\n\t\t\tfor(int i = 0; i < q; i++) {\n\t\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\t\tSX[i][j] = (S[i].charAt(j) == '1')?true:false;\n\t\t\t\t}\n\t\t\t\tfor(int j = 0; j < m; j++) {\n\t\t\t\t\tBX[i][j] = (B[i].charAt(j) == '1')?true:false;\n\t\t\t\t}\n\t\t\t\tif(i != 0) {\n\t\t\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\t\t\tSX[i][j] = (S[i].charAt(j) == '1')?!SX[i-1][j]:SX[i-1][j];\n\t\t\t\t\t}\n\t\t\t\t\tfor(int j = 0; j < m; j++) {\n\t\t\t\t\t\tBX[i][j] = (B[i].charAt(j) == '1')?true:false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tint[] ans = new int[m];\n\t\t\tfor(int i = 0; i < m; i++) {\n\t\t\t\tans[i] = -1;\n\t\t\t}\n\t\t\tboolean[] already = new boolean[n];\n\t\t\tfor(int i = 0; i < 50; i++) {\n\t\t\t\tfor(int j = 0; j < q; j++) {\n\t\t\t\t\tint Tid = 0;\n\t\t\t\t\tint Fid = 0;\n\t\t\t\t\tint Tcount = 0;\n\t\t\t\t\tint Fcount = 0;\n\t\t\t\t\tfor(int k = 0; k < n; k++) {\n\t\t\t\t\t\tif(SX[j][k] && !already[k]) {\n\t\t\t\t\t\t\tTcount++;\n\t\t\t\t\t\t\tTid = k;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(!SX[j][k] && !already[k]) {\n\t\t\t\t\t\t\tFcount++;\n\t\t\t\t\t\t\tFid = k;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(Tcount == 1) {\n\t\t\t\t\t\tfor(int k = 0; k < m; k++) {\n\t\t\t\t\t\t\talready[Tid] = true;\n\t\t\t\t\t\t\tif(BX[j][k] && ans[k] == -1) {\n\t\t\t\t\t\t\t\tans[k] = Tid+1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(Fcount == 1) {\n\t\t\t\t\t\tfor(int k = 0; k < m; k++) {\n\t\t\t\t\t\t\talready[Fid] = true;\n\t\t\t\t\t\t\tif(!BX[j][k] && ans[k] == -1) {\n\t\t\t\t\t\t\t\tans[k] = Fid+1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(n == 1) {\n\t\t\t\tfor(int i = 0; i < m; i++) {\n\t\t\t\t\tSystem.out.print(0);\n\t\t\t\t}\n\t\t\t\tSystem.out.println();\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfor(int i = 0; i < ans.length; i++) {\n\t\t\t\tif(ans[i] == -1) {\n\t\t\t\t\tSystem.out.print(\"?\");\n\t\t\t\t}\n\t\t\t\telse if(ans[i] <= 10) {\n\t\t\t\t\tchar a = '0';\n\t\t\t\t\ta += ans[i]-1;\n\t\t\t\t\tSystem.out.print(a);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tchar a = 'A';\n\t\t\t\t\ta += (ans[i] - 11);\n\t\t\t\t\tSystem.out.print(a);\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.HashSet;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n */\npublic class Main {\n    public static void main(String[] args) {\n        InputStream inputStream = System.in;\n        OutputStream outputStream = System.out;\n        Scanner in = new Scanner(inputStream);\n        PrintWriter out = new PrintWriter(outputStream);\n        UnknownSwitches solver = new UnknownSwitches();\n        try {\n            int testNumber = 1;\n            while (true)\n                solver.solve(testNumber++, in, out);\n        } catch (UnknownError e) {\n            out.close();\n        }\n    }\n\n    static class UnknownSwitches {\n        public void solve(int testNumber, Scanner in, PrintWriter out) {\n            final int N = in.nextInt();\n            final int M = in.nextInt();\n            final int Q = in.nextInt();\n            if (N == 0 && M == 0 && Q == 0) throw new UnknownError();\n            String[] S = new String[Q + 1];\n            String[] B = new String[Q + 1];\n            S[0] = new String();\n            for (int i = 0; i < N; i++) {\n                S[0] += \"0\";\n            }\n            B[0] = new String();\n            for (int i = 0; i < M; i++) {\n                B[0] += \"0\";\n            }\n            for (int i = 0; i < Q; i++) {\n                S[i + 1] = in.next();\n                B[i + 1] = in.next();\n            }\n            String ans = \"\";\n            for (int i = 0; i < M; i++) {\n                ans += \"?\";\n            }\n            StringBuilder buildAns = new StringBuilder(ans);\n            boolean[] isHatena = new boolean[M];\n            boolean[] visited = new boolean[N];\n            Arrays.fill(isHatena, false);\n            Arrays.fill(visited, false);\n            for (int i = 0; i < N; i++) {\n                HashSet<Integer> set = new HashSet<>();\n                boolean first = true;\n                for (int j = 1; j <= Q; j++) {\n                    if (S[j].charAt(i) == '1') {\n                        visited[i] = true;\n                        HashSet<Integer> bufset = new HashSet<>();\n                        for (int k = 0; k < M; k++) {\n                            if (B[j - 1].charAt(k) != B[j].charAt(k)) {\n                                if (first) {\n                                    set.add(k);\n                                } else {\n                                    bufset.add(k);\n                                }\n                            }\n                        }\n                        if (!first) {\n                            HashSet<Integer> remset = new HashSet<>();\n                            for (int e : set) {\n                                if (!bufset.contains(e)) {\n                                    remset.add(e);\n                                }\n                            }\n                            for (int e : remset) {\n                                set.remove(e);\n                            }\n                        } else {\n                            first = false;\n                        }\n                    }\n                }\n                for (int e : set) {\n                    if (!isHatena[e] && buildAns.charAt(e) == '?') {\n                        buildAns.setCharAt(e, cc(i));\n                    } else {\n                        isHatena[e] = true;\n                    }\n                }\n            }\n            int notVisit = -1;\n            for (int i = 0; i < N; i++) {\n                if (!visited[i]) {\n                    if (notVisit == -1) {\n                        notVisit = i;\n                    } else {\n                        notVisit = -2;\n                    }\n                }\n            }\n            if (notVisit >= 0) {\n                for (int i = 0; i < M; i++) {\n                    if (!isHatena[i] && buildAns.charAt(i) == '?') {\n                        buildAns.setCharAt(i, cc(notVisit));\n                    }\n                }\n            }\n            out.println(buildAns);\n        }\n\n        char cc(int n) {\n            if (0 <= n && n <= 9) return (char) (n + '0');\n            else return (char) (n - 10 + 'A');\n        }\n\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.*;\nimport java.util.regex.Matcher;\nimport java.util.regex.Pattern;\nimport java.lang.ArrayIndexOutOfBoundsException;\nimport java.math.BigInteger;\n\nimport javax.script.AbstractScriptEngine;\n\n\n/**\n * @author yoshikyoto\n */\nclass Main extends MyUtil{\n\t// public static Graph g;\n\t\n\tpublic static void main(String[] args) throws Exception{\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\twhile(true){\n\t\t\tString[] in = br.readLine().split(\" \");\n\t\t\tint n = Integer.parseInt(in[0]);\n\t\t\tint m = Integer.parseInt(in[1]);\n\t\t\tint q = Integer.parseInt(in[2]);\n\t\t\tif(n == 0 && m == 0 && q == 0) break;\n\t\t\t\n\n\t\t\tLong bit_fill0 = 0L;\n\t\t\tLong bit_fill1 = 0L;\n\t\t\tfor(int i = 0; i< n; i++)\n\t\t\t\tbit_fill1 = (bit_fill1<<1) | 1L;\n\t\t\t\n\t\t\t// フラグの初期化\n\t\t\tlong[] bit = new long[m];\n\t\t\tfor(int i = 0; i < m; i++) \n\t\t\t\tbit[i] = bit_fill1;\n\t\t\t\n\t\t\tlong state = bit_fill0;\n\t\t\tfor(int i = 0; i < q; i++){\n\t\t\t\tin = br.readLine().split(\" \");\n\t\t\t\tString s = in[0];\n\t\t\t\tString b = in[1];\n\t\t\t\tlong sb = Long.parseLong(s, 2);\n\t\t\t\t// 状態の更新\n\t\t\t\tstate = state ^ sb;\n\t\t\t\t// System.out.println(Long.toBinaryString(state));\n\t\t\t\t\n\t\t\t\tfor(int j = 0; j < m; j++){\n\t\t\t\t\tint flag = b.charAt(j) - '0';\n\t\t\t\t\tif(flag == 1){\n\t\t\t\t\t\t// 電気がついた場合は、今1になったスイッチのどれかとつながっている\n\t\t\t\t\t\tbit[j] = bit[j] & state;\n\t\t\t\t\t}else{\n\t\t\t\t\t\t// 電気がついてない場合は、今0のスイッチのどれかとと長っている\n\t\t\t\t\t\tbit[j] = bit[j] & ~state;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tStringBuffer ans = new StringBuffer(\"\");\n\t\t\tfor(int i = 0; i < m; i++){\n\t\t\t\tif(Long.bitCount(bit[i]) == 1){\n\t\t\t\t\t// 立っているbitが1つの場合\n\t\t\t\t\t// それが答えなので36進数に変換してやる\n\t\t\t\t\tint snum = n - 1 - Long.numberOfTrailingZeros(bit[i]);\n\t\t\t\t\tans.append(toChar(snum));\n\t\t\t\t}else{\n\t\t\t\t\t// そうでない場合はわからない\n\t\t\t\t\tans.append('?');\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans.toString());\n\t\t}\n\t}\n\n\tstatic char toChar(int i){\n\t\tif(i < 10){\n\t\t\treturn (char)('0' + i);\n\t\t}else{\n\t\t\treturn (char)('A' + (i - 10));\n\t\t}\n\t}\n}\n\n\n// --- ここから下はライブラリ ----------\n \nclass ArrayComp implements Comparator<int[]>{\n\tpublic int compare(int[] a, int[] b){\n\t\tint l = Math.min(a.length, b.length);\n\t\tfor(int i = 0; i < l; i++){\n\t\t\tif(a[i] == b[i]) continue;\n\t\t\treturn a[i] - b[i];\n\t\t}\n\t\treturn 0;\n\t}\n}\n \nclass Node extends ArrayList<Edge>{\n\tint index, depth = -1, dist = -1;\n\tNode(int index){this.index = index;}\n\tNode parent;\n\tboolean visited = false;\n}\nclass Edge{\n\tint from, to, cost;\n\tEdge(int from, int to, int cost){\n\t\tthis.from = from;\n\t\tthis.to = to;\n\t\tthis.cost = cost;\n\t}\n}\nclass NodeComparator implements Comparator<Node>{\n\tpublic int compare(Node a, Node b){\n\t\treturn a.dist - b.dist;\n\t}\n}\n \nclass Graph{\n\tNode n[];\n\tGraph(int node_count){\n\t\tn = new Node[node_count];\n\t\tfor(int i = 0; i < node_count; i++) n[i] = new Node(i);\n\t}\n\tpublic void add(Edge e){\n\t\tn[e.from].add(e);\n\t}\n\tpublic Node get(int i){return n[i];}\n\tpublic Node lca(int a, int b){\n\t\t// 浅い方をaとする\n\t\tNode nodeA, nodeB;\n\t\tif(n[a].depth < n[b].depth){\n\t\t\tnodeA = n[a];\n\t\t\tnodeB = n[b];\n\t\t}else{\n\t\t\tnodeA = n[b];\n\t\t\tnodeB = n[a];\n\t\t}\n\t\t// 同じ深さまで親をたどる\n\t\tint diff = nodeB.depth - nodeA.depth;\n\t\tfor(int k = 0; k < diff; k++){\n\t\t\tnodeB = nodeB.parent;\n\t\t}\n\t\t// 共通祖先を見つける\n\t\twhile(nodeA != nodeB){\n\t\t\tnodeA = nodeA.parent;\n\t\t\tnodeB = nodeB.parent;\n\t\t}\n\t\treturn nodeA;\n\t}\n\tpublic void calcDepth(int root){\n\t\tArrayDeque<Integer> que = new ArrayDeque<Integer>();\n\t\tque.push(root);\n\t\tn[root].depth = 0;\n \n\t\twhile(que.size() > 0){\n\t\t\tint curr = que.pop();\n\t\t\tNode curr_node = n[curr];\n\t\t\tfor(Edge e : curr_node){\n\t\t\t\tint next = e.to;\n\t\t\t\tNode next_node = n[next];\n\t\t\t\tif(next_node.depth == -1){\n\t\t\t\t\tnext_node.depth = curr_node.depth + 1;\n\t\t\t\t\tnext_node.parent = curr_node;\n\t\t\t\t\tque.push(next);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n \n\tpublic int[] dijkstra(int s){\n\t\tPriorityQueue<Node> q = new PriorityQueue<Node>(n.length, new NodeComparator());\n\t\tNode start_node = new Node(s);\n\t\tstart_node.dist = 0;\n\t\tq.add(start_node);\n\t\tint[] dist = new int[n.length];\n\t\tfor (int i = 0; i < dist.length; i++)  dist[i] = -1;\n\t\tdist[s] = 0;\n \n\t\twhile(q.size() > 0){\n\t\t\tNode currNode = q.poll();\n\t\t\tif(dist[currNode.index] < currNode.dist) continue;\n\t\t\tfor(Edge e : n[currNode.index]){\n\t\t\t\tNode nextNode = new Node(e.to);\n\t\t\t\tnextNode.dist = currNode.dist + e.cost;\n\t\t\t\tif(dist[e.to] == -1 || dist[e.to] > nextNode.dist){\n\t\t\t\t\tdist[e.to] = nextNode.dist;\n\t\t\t\t\tq.add(nextNode);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn dist;\n\t}\n}\n \n \n \nclass Regex{\n\tPattern p; Matcher m; String str;\n\tRegex(String regex_str){p = Pattern.compile(regex_str);}\n\tvoid setStr(String str){m = p.matcher(str);}\n\tboolean find(){return m.find();}\n\tString group(int i){return m.group(i);}\n\tString group(){return m.group();}\n}\n \n/**\n * UnionFindTree \n * @author yoshikyoto\n */\nclass UnionFindTree{\n\tpublic int[] parent, rank;\n\tpublic int n;\n\tpublic int count;\n\t// 初期化\n\tUnionFindTree(int n){\n\t\tthis.n = n;\n\t\tcount = n;\n\t\tparent = new int[n];\n\t\trank = new int[n];\n\t\tfor(int i = 0; i < n; i++){\n\t\t\tparent[i] = i;\n\t\t\trank[i] = 0;\n\t\t}\n\t}\n\t// 根を求める\n\tint find(int x){\n\t\tif(parent[x] == x){\n\t\t\treturn x;\n\t\t}else{\n\t\t\treturn parent[x] = find(parent[x]);\n\t\t}\n\t}\n\t// xとyの集合を結合\n\tvoid unite(int x, int y){\n\t\tx = find(x);\n\t\ty = find(y);\n\t\tif(x == y){\n\t\t\treturn;\n\t\t}\n\t\tif(rank[x] < rank[y]){\n\t\t\tparent[x] = y;\n\t\t\tcount--;\n\t\t}else{\n\t\t\tparent[y] = x;\n\t\t\tif(rank[x] == rank[y]) rank[x]++;\n\t\t\tcount--;\n\t\t}\n\t}\n\t// xとyが同じ集合か\n\tboolean same(int x, int y){\n\t\treturn find(x) == find(y);\n\t}\n};\n \n \n\n \nclass CountHashMap<E> extends HashMap<E, Integer>{\n\tArrayList<E> keyArray = new ArrayList<E>();\n\tpublic void add(E key){add(key, 1);}\n\tpublic void add(E key, Integer value){\n\t\tif(containsKey(key)){value += get(key);\n\t\t}else{keyArray.add(key);}\n\t\tput(key, value);\n\t}\n}\n \n/**\n * MyUtil\n * @author yoshikyoto\n */\nclass MyUtil extends MyIO{\n\tpublic static Random rand = new Random();\n\tpublic static int digit(int n){return String.valueOf(n).length();}\n\tpublic static String reverse(String s){return (new StringBuffer(s)).reverse().toString();}\n\tpublic static void dsort(int[] a){\n\t\tArrays.sort(a);\n\t\tint l = a.length;\n\t\tfor(int i = 0; i < l/2; i++){\n\t\t\tint tmp = a[i]; a[i] = a[l-1-i]; a[l-1-i] = tmp;\n\t\t}\n\t}\n\tpublic static void sleep(int t){try{Thread.sleep(t);}catch(Exception e){}}\n\tpublic static int sum(int[] a){int s = 0; for(int i = 0; i < a.length; i++)s+=a[i]; return s;}\n\tpublic static int[] cp(int[] a){\n\t\tint[] b = new int[a.length];\n\t\tfor(int i = 0; i < a.length; i++) b[i] = a[i];\n\t\treturn b;\n\t}\n\tpublic static int randomInt(int min, int max){return min + rand.nextInt(max - min + 1);}\n\tstatic boolean inside(int y, int x, int h, int w){return 0 <= y && y <= (h-1) && 0 <= x && x <= (w-1);};\n\tpublic static boolean isUpper(char c){return 'A'<=c&&c<='Z';}\n\tpublic static boolean isLower(char c){return 'a'<=c&&c<='z';}\n\tpublic static char toUpper(char c){\n\t\tif(isLower(c)) return (char)(c - 'a' + 'A');\n\t\treturn c;\n\t}\n\tpublic static char toLower(char c){\n\t\tif(isUpper(c)) return (char)(c - 'A' + 'a');\n\t\treturn c;\n\t}\n\tpublic static int[] swap(int[] arr, int i, int j){\n\t\tint[] ret = cp(arr);\n\t\tint tmp = ret[i];\n\t\tret[i] = ret[j];\n\t\tret[j] = tmp;\n\t\treturn ret;\n\t}\n\tpublic static int toInt(boolean[] a){\n\t\tint pow = 1, ret = 0, l = a.length;\n\t\tfor(int i = 0; i < l; i++){\n\t\t\tif(a[i]) ret += pow;\n\t\t\tpow *= 2;\n\t\t}\n\t\treturn ret;\n\t}\n}\n \n/**\n * MyIO\n * @author yoshikyoto\n */\nclass MyIO extends MyMath{\n\tstatic Scanner sc = new Scanner(new InputStreamReader(System.in));\n\tpublic static char scNextChar(){return sc.next().charAt(0);}\n\tstatic BufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\tpublic static String line;\n \n\tpublic static int ins[];\n\tpublic static int[] readIntMap() throws IOException{return parseInt(readLine().split(\" \"));}\n\tpublic static int readIntMap(int i) throws Exception{\n\t\tif(i == 0) ins = readIntMap();\n\t\treturn ins[i];\n\t}\n\tpublic static int[][] readIntMap(int n, int m) throws IOException{\n\t\tint[][] ret = new int[n][];\n\t\tfor(int i = 0; i < n; i++) ret[i] = readIntMap();\n\t\treturn ret;\n\t}\n\tpublic static int[] readIntToMap(int n) throws IOException{\n\t\tint[] ret = new int[n];\n\t\tfor(int i = 0; i < n; i++) ret[i] = readInt();\n\t\treturn ret;\n\t}\n\tpublic static int[] readNoDistIntMap() throws IOException{\n\t\tString[] strs = readLine().split(\"\");\n\t\tint l = strs.length;\n\t\tint[] ret = new int[l-1];\n\t\tfor(int i = 1; i < l; i++)\n\t\t\tret[i-1] = parseInt(strs[i]);\n\t\treturn ret;\n\t}\n\tpublic static boolean readToLine() throws IOException{return (line = br.readLine()) != null;}\n\tpublic static String readLine() throws IOException{return br.readLine();}\n\tpublic static int readInt() throws IOException{return Integer.parseInt(br.readLine());}\n\tpublic static int[] parseInt(String[] arr){\n\t\tint[] res = new int[arr.length];\n\t\tfor(int i = 0; i < arr.length; i++)res[i] = Integer.parseInt(arr[i]);\n\t\treturn res;\n\t}\n\tpublic static double[] parseDouble(String[] arr){\n\t\tdouble[] res = new double[arr.length];\n\t\tfor(int i = 0; i < arr.length; i++)res[i] = Double.parseDouble(arr[i]);\n\t\treturn res;\n\t}\n\tpublic static boolean[] parseBool(String[] arr){\n\t\tint[] t = parseInt(arr);\n\t\tboolean[] res = new boolean[t.length];\n\t\tfor(int i = 0; i < t.length; i++){\n\t\t\tif(t[i] == 1){res[i] = true;\n\t\t\t}else{res[i] = false;}\n\t\t}\n\t\treturn res;\n\t}\n\tpublic static int parseInt(Object o){return Integer.parseInt(o.toString());}\n}\n \nclass MyMath{\n\tpublic static int max(int[] arr){return max(arr, 0, arr.length-1);}\n\tpublic static int max(int[] arr, int l, int r){\n\t\tint max = arr[l];\n\t\tfor(int i = l+1; i <= r; i++)\n\t\t\tmax = Math.max(max, arr[i]);\n\t\treturn max;\n\t}\n\tpublic static int min(int[] arr){return min(arr, 0, arr.length-1);}\n\tpublic static int min(int[] arr, int l, int r){\n\t\tint min = arr[l];\n\t\tfor(int i = l+1; i <= r; i++)\n\t\t\tmin = Math.min(min, arr[i]);\n\t\treturn min;\n\t}\n\tpublic static boolean isCross(int x1, int y1, int x2, int y2, int x3, int y3, int x4, int y4){\n\t\t// 並行な場合\n\t\tint m = (x2-x1)*(y4-y3)-(y2-y1)*(x4-x3);\n\t\tif(m == 0) return false;\n\t\t// 媒介変数の値が0より大きく1以下なら交差する、これは問題の状況によって変わるかも。\n\t\tdouble r =(double)((y4-y3)*(x3-x1)-(x4-x3)*(y3-y1))/m;\n\t\tdouble s =(double)((y2-y1)*(x3-x1)-(x2-x1)*(y3-y1))/m;\n\t\treturn (0 < r && r <= 1 && 0 < s && s <= 1);\n\t}\n\tpublic static boolean isParallel(int x1, int y1, int x2, int y2, int x3, int y3, int x4, int y4){\n\t\tif((x2-x1)*(y4-y3) == (y2-y1)*(x4-x3)) return true;\n\t\telse return false;\n\t}\n\tpublic static double sq(double d){return d*d;}\n\tpublic static int sq(int i){return i*i;}\n\tpublic static int sqdist(int x1, int y1, int x2, int y2){return (x1-x2) + sq(y1-y2);}\n\tpublic static double sqdist(double x1, double y1, double x2, double y2){return sq(x1-x2) + sq(y1-y2);}\n\tpublic static double dist(int x1, int y1, int x2, int y2){return Math.sqrt(sqdist(x1, y1, x2, y2));}\n\tpublic static double dist(double x1, double y1, double x2, double y2){return Math.sqrt(sqdist(x1, y1, x2, y2));}\n\tstatic long comb(long n, long m){\n\t\tif(n < m) return 0;\n\t\tlong c = 1; m = (n - m < m ? n - m : m);\n\t\tfor(long ns = n - m + 1, ms = 1; ms <= m; ns ++, ms ++){c *= ns; c /= ms;}\n\t\treturn c;\n\t}\n\tstatic int gcd(int a, int b){if(a%b==0){return(b);}else{return(gcd(b,a%b));}};\n\t/**\n\t * aの中から、合計がborderを超えるペア（重複除く）の数を数える\n\t */\n\tstatic int countPair(int[] a, int border){\n\t\tint count = 0, l = a.length, i = 0, j = l-1;\n\t\tfor (; i < l; i++) {\n\t\t\tfor (; j >= 0; j--) if(a[i] + a[j] <= border) break;\n\t\t\tcount += l - (j + 1);\n\t\t\tif(j < i) count--;\n\t\t}\n\t\treturn count/2;\n\t}\n\t// modに対応したDPのCombination\n\tstatic int mcomb(int n, int m, int mod){\n\t\tn = n - m;\n\t\tint[][] dp = new int[n+1][m+1];\n\t\tfor(int i = 0; i <= n; i++) dp[i][0] = 1;\n\t\tfor(int i = 0; i <= m; i++) dp[0][i] = 1;\n\t\t// mod = 0 の時は余りを取らない\n\t\tif(mod != 0){\n\t\t\tfor(int i = 1; i <= n; i++){\n\t\t\t\tfor(int j = 1; j <= m; j++){\n\t\t\t\t\tdp[i][j] = (dp[i-1][j] + dp[i][j-1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn dp[n][m];\n\t\t// それ以外の時は mod をとっていく\n\t\t}else{\n\t\t\tfor(int i = 1; i <= n; i++){\n\t\t\t\tfor(int j = 1; j <= m; j++){\n\t\t\t\t\tdp[i][j] = (dp[i-1][j] + dp[i][j-1]) % mod;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn dp[n][m] % mod;\n\t\t}\n\t}\n\t\n\n\tstatic long mcomb(int n, int m, long mod){\n\t\tn = n - m;\n\t\tlong[][] dp = new long[n+1][m+1];\n\t\tfor(int i = 0; i <= n; i++) dp[i][0] = 1;\n\t\tfor(int i = 0; i <= m; i++) dp[0][i] = 1;\n\t\t// mod = 0 の時は余りを取らない\n\t\tif(mod != 0){\n\t\t\tfor(int i = 1; i <= n; i++){\n\t\t\t\tfor(int j = 1; j <= m; j++){\n\t\t\t\t\tdp[i][j] = (dp[i-1][j] + dp[i][j-1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn dp[n][m];\n\t\t// それ以外の時は mod をとっていく\n\t\t}else{\n\t\t\tfor(int i = 1; i <= n; i++){\n\t\t\t\tfor(int j = 1; j <= m; j++){\n\t\t\t\t\tdp[i][j] = (dp[i-1][j] + dp[i][j-1]) % mod;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn dp[n][m] % mod;\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\npublic class Main { \n\tpublic static void main(String[] args) {\n\t\tScanner stdIn = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tint n = stdIn.nextInt();\n\t\t\tint m = stdIn.nextInt();\n\t\t\tint q = stdIn.nextInt();\n\t\t\tif(n == 0 && m == 0 && q == 0) break;\n\t\t\tString[] S = new String[q];\n\t\t\tString[] B = new String[q];\n\t\t\tfor(int i = 0; i < q; i++) {\n\t\t\t\tS[i] = stdIn.next();\n\t\t\t\tB[i] = stdIn.next();\n\t\t\t}\n\t\t\tboolean[][] SX = new boolean[q][n];\n\t\t\tboolean[][] BX = new boolean[q][m];\n\t\t\tfor(int i = 0; i < q; i++) {\n\t\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\t\tSX[i][j] = (S[i].charAt(j) == '1')?true:false;\n\t\t\t\t}\n\t\t\t\tfor(int j = 0; j < m; j++) {\n\t\t\t\t\tBX[i][j] = (B[i].charAt(j) == '1')?true:false;\n\t\t\t\t}\n\t\t\t\tif(i != 0) {\n\t\t\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\t\t\tSX[i][j] = (S[i].charAt(j) == '1')?!SX[i-1][j]:SX[i-1][j];\n\t\t\t\t\t}\n\t\t\t\t\tfor(int j = 0; j < m; j++) {\n\t\t\t\t\t\tBX[i][j] = (B[i].charAt(j) == '1')?true:false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tboolean[][] list = new boolean[n][m];\n\t\t\tfor(int i = 0; i < q; i++) {\n\t\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\t\tif (SX[i][j]) {\n\t\t\t\t\t\tfor (int k = 0; k < m; k++) {\n\t\t\t\t\t\t\tif (!BX[i][k]) {\n\t\t\t\t\t\t\t\tlist[j][k] = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!SX[i][j]) {\n\t\t\t\t\t\tfor (int k = 0; k < m; k++) {\n\t\t\t\t\t\t\tif (BX[i][k]) {\n\t\t\t\t\t\t\t\tlist[j][k] = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\tif(n == 1) {\n\t\t\t\tfor(int i = 0; i < m; i++) {\n\t\t\t\t\tSystem.out.print(0);\n\t\t\t\t}\n\t\t\t\tSystem.out.println();\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tint[] ans = new int[m];\n\t\t\tfor(int i = 0; i < m; i++) {\n\t\t\t\tans[i] = -1;\n\t\t\t\tint count = 0;\n\t\t\t\tint id = 0;\n\t\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\t\tif(!list[j][i]) {\n\t\t\t\t\t\tid = j;\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t}\n\t\t\t\t\tif(count >= 2) break;\n\t\t\t\t}\n\t\t\t\tif(count == 1) {\n\t\t\t\t\tans[i] = id+1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0; i < ans.length; i++) {\n\t\t\t\tif(ans[i] == -1) {\n\t\t\t\t\tSystem.out.print(\"?\");\n\t\t\t\t}\n\t\t\t\telse if(ans[i] <= 10) {\n\t\t\t\t\tchar a = '0';\n\t\t\t\t\ta += ans[i]-1;\n\t\t\t\t\tSystem.out.print(a);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tchar a = 'A';\n\t\t\t\t\ta += (ans[i] - 11);\n\t\t\t\t\tSystem.out.print(a);\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.HashSet;\nimport java.util.Arrays;\nimport java.util.AbstractCollection;\nimport java.util.Scanner;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n */\npublic class Main {\n    public static void main(String[] args) {\n        InputStream inputStream = System.in;\n        OutputStream outputStream = System.out;\n        Scanner in = new Scanner(inputStream);\n        PrintWriter out = new PrintWriter(outputStream);\n        UnknownSwitches solver = new UnknownSwitches();\n        try {\n            int testNumber = 1;\n            while (true)\n                solver.solve(testNumber++, in, out);\n        } catch (UnknownError e) {\n            out.close();\n        }\n    }\n\n    static class UnknownSwitches {\n        public void solve(int testNumber, Scanner in, PrintWriter out) {\n            final int N = in.nextInt();\n            final int M = in.nextInt();\n            final int Q = in.nextInt();\n            if (N == 0 && M == 0 && Q == 0) throw new UnknownError();\n            String[] S = new String[Q + 1];\n            String[] B = new String[Q + 1];\n            S[0] = new String();\n            for (int i = 0; i < N; i++) {\n                S[0] += \"0\";\n            }\n            B[0] = new String();\n            for (int i = 0; i < M; i++) {\n                B[0] += \"0\";\n            }\n            for (int i = 0; i < Q; i++) {\n                S[i + 1] = in.next();\n                B[i + 1] = in.next();\n            }\n            StringBuilder buildAns = new StringBuilder();\n            for (int i = 0; i < M; i++) {\n                buildAns.append(\"?\");\n            }\n            boolean[] isHatena = new boolean[M];\n            boolean[] visited = new boolean[N];\n            Arrays.fill(isHatena, false);\n            Arrays.fill(visited, false);\n\n            HashSet<Integer>[] sets = new HashSet[Q];\n            for (int i = 0; i < Q; i++) {\n                sets[i] = new HashSet<>();\n                for (int j = 0; j < M; j++) {\n                    if (B[i].charAt(j) != B[i + 1].charAt(j)) {\n                        sets[i].add(j);\n                    }\n                }\n            }\n\n            for (int i = 0; i < N; i++) {\n                HashSet<Integer> masterSet = new HashSet<>();\n                HashSet<Integer> masterNgSet = new HashSet<>();\n                for (int j = 1; j <= Q; j++) {\n                    if (S[j].charAt(i) == '1') {\n                        visited[i] = true;\n                        if (masterSet.size() == 0) {\n                            masterSet.addAll(sets[j - 1]);\n                        } else {\n                            masterSet.retainAll(sets[j - 1]);\n                        }\n                    } else {\n                        masterNgSet.addAll(sets[j - 1]);\n                    }\n                }\n                for (int e : masterSet) {\n                    if (!isHatena[e]) {\n                        if (buildAns.charAt(e) != '?' && buildAns.charAt(e) != cc(i) && !masterNgSet.contains(e)) {\n                            //System.err.println(buildAns.charAt(e) + \" \" + cc(i));\n                            isHatena[e] = true;\n                        } else if (!masterNgSet.contains(e)) {\n                            buildAns.setCharAt(e, cc(i));\n                        }\n                    }\n                }\n            }\n            int cnt = 0;\n            int notVisit = -1;\n            for (int i = 0; i < N; i++) {\n                if (!visited[i]) {\n                    cnt++;\n                    notVisit = i;\n                }\n            }\n            if (cnt == 1) {\n                for (int i = 0; i < M; i++) {\n                    if (buildAns.charAt(i) == '?' && !isHatena[i]) {\n                        buildAns.setCharAt(i, cc(notVisit));\n                    }\n                }\n            }\n            for (int i = 0; i < M; i++) {\n                if (isHatena[i]) {\n                    buildAns.setCharAt(i, '?');\n                }\n            }\n            out.println(buildAns);\n        }\n\n        char cc(int n) {\n            if (0 <= n && n <= 9) return (char) (n + '0');\n            else return (char) (n - 10 + 'A');\n        }\n\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.HashSet;\nimport java.util.Arrays;\nimport java.util.AbstractCollection;\nimport java.util.Scanner;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n */\npublic class Main {\n    public static void main(String[] args) {\n        InputStream inputStream = System.in;\n        OutputStream outputStream = System.out;\n        Scanner in = new Scanner(inputStream);\n        PrintWriter out = new PrintWriter(outputStream);\n        UnknownSwitches solver = new UnknownSwitches();\n        try {\n            int testNumber = 1;\n            while (true)\n                solver.solve(testNumber++, in, out);\n        } catch (UnknownError e) {\n            out.close();\n        }\n    }\n\n    static class UnknownSwitches {\n        public void solve(int testNumber, Scanner in, PrintWriter out) {\n            final int N = in.nextInt();\n            final int M = in.nextInt();\n            final int Q = in.nextInt();\n            if (N == 0 && M == 0 && Q == 0) throw new UnknownError();\n            String[] S = new String[Q + 1];\n            String[] B = new String[Q + 1];\n            S[0] = new String();\n            for (int i = 0; i < N; i++) {\n                S[0] += \"0\";\n            }\n            B[0] = new String();\n            for (int i = 0; i < M; i++) {\n                B[0] += \"0\";\n            }\n            for (int i = 0; i < Q; i++) {\n                S[i + 1] = in.next();\n                B[i + 1] = in.next();\n            }\n            StringBuilder buildAns = new StringBuilder();\n            for (int i = 0; i < M; i++) {\n                buildAns.append(\"?\");\n            }\n            boolean[] isHatena = new boolean[M];\n            boolean[] visited = new boolean[N];\n            Arrays.fill(isHatena, false);\n            Arrays.fill(visited, false);\n\n            HashSet<Integer>[] sets = new HashSet[Q];\n            for (int i = 0; i < Q; i++) {\n                sets[i] = new HashSet<>();\n                for (int j = 0; j < M; j++) {\n                    if (B[i].charAt(j) != B[i + 1].charAt(j)) {\n                        sets[i].add(j);\n                    }\n                }\n            }\n\n            for (int i = 0; i < N; i++) {\n                HashSet<Integer> masterSet = new HashSet<>();\n                HashSet<Integer> masterNgSet = new HashSet<>();\n                for (int j = 1; j <= Q; j++) {\n                    if (S[j].charAt(i) == '1') {\n                        visited[i] = true;\n                        if (masterSet.size() == 0) {\n                            masterSet.addAll(sets[j - 1]);\n                        } else {\n                            masterSet.retainAll(sets[j - 1]);\n                        }\n                    } else {\n                        masterNgSet.addAll(sets[j - 1]);\n                    }\n                }\n                for (int e : masterSet) {\n                    if (!isHatena[e]) {\n                        if (buildAns.charAt(e) != '?' && buildAns.charAt(e) != cc(i) && !masterNgSet.contains(e)) {\n                            //System.err.println(buildAns.charAt(e) + \" \" + cc(i));\n                            isHatena[e] = true;\n                        } else if (!masterNgSet.contains(e)) {\n                            buildAns.setCharAt(e, cc(i));\n                        }\n                    }\n                }\n            }\n            int cnt = 0;\n            int notVisit = -1;\n            for (int i = 0; i < N; i++) {\n                if (!visited[i]) {\n                    cnt++;\n                    notVisit = i;\n                }\n            }\n            if (cnt == 1) {\n                for (int i = 0; i < M; i++) {\n                    if (buildAns.charAt(i) == '?' && !isHatena[i]) {\n                        buildAns.setCharAt(i, cc(notVisit));\n                    }\n                }\n            }\n            for (int i = 0; i < M; i++) {\n                if (isHatena[i]) {\n                    buildAns.setCharAt(i, '?');\n                }\n            }\n            out.println(buildAns);\n        }\n\n        char cc(int n) {\n            if (0 <= n && n <= 9) return (char) (n + '0');\n            else return (char) (n - 10 + 'A');\n        }\n\n    }\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.*;\nimport java.io.*;\n\npublic class Main{\n    static final Reader sc = new Reader();\n    static final PrintWriter out = new PrintWriter(System.out,false);\n\n    public static void main(String[] args) throws Exception {\n    \tString ans = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n    \twhile(true){\n    \t\tint n = sc.nextInt();\n    \t\tint m = sc.nextInt();\n    \t\tint q = sc.nextInt();\n    \t\tif(n==0 && m==0 && q==0){\n    \t\t\tbreak;\n    \t\t}\n    \t\tboolean[][] judge = new boolean[n][m];\n            for(int i=0;i<n;i++){\n                Arrays.fill(judge[i],true);\n            }\n            for(int i=0;i<q;i++){\n                String s = sc.next();\n                String b = sc.next();\n                for(int j=0;j<n;j++){\n                    for(int k=0;k<m;k++){\n                        if(s.charAt(j)!=b.charAt(k)){\n                            judge[j][k] = false;\n                        }\n                    }\n                }\n            }\n            for(int i=0;i<m;i++){\n                int flag = 0;\n                int now = -1;\n                for(int j=0;j<n;j++){\n                    if(judge[j][i]){\n                        flag++;\n                        now = j;\n                    }\n                }\n                if(flag==1){\n                    out.print(ans.charAt(now));\n                }\n                else{\n                    out.print(\"?\");\n                }\n                out.flush();\n            }\n    \t}\n\n        sc.close();\n        out.close();\n    }\n\n    static void trace(Object... o) { System.out.println(Arrays.deepToString(o));}\n}\n\nclass Reader {\n\n    private final InputStream in;\n    private final byte[] buf = new byte[1024];\n    private int ptr = 0;\n    private int buflen = 0;\n\n    public Reader() { this(System.in);}\n    public Reader(InputStream source) { this.in = source;}\n\n    private boolean hasNextByte() {\n        if (ptr < buflen) return true;\n        ptr = 0;\n        try{\n            buflen = in.read(buf);\n        }catch (IOException e) {e.printStackTrace();}\n        if (buflen <= 0) return false;\n        return true;\n    }\n\n    private int readByte() { if (hasNextByte()) return buf[ptr++]; else return -1;}\n\n    private boolean isPrintableChar(int c) { return 33 <= c && c <= 126;}\n\n    private void skip() { while(hasNextByte() && !isPrintableChar(buf[ptr])) ptr++;}\n\n    public boolean hasNext() {skip(); return hasNextByte();}\n\n    public String next() {\n        if (!hasNext()) throw new NoSuchElementException();\n        StringBuilder sb = new StringBuilder();\n        int b = readByte();\n        while (isPrintableChar(b)) {\n            sb.appendCodePoint(b);\n            b = readByte();\n        }\n        return sb.toString();\n    }\n\n    public long nextLong() {\n        if (!hasNext()) throw new NoSuchElementException();\n        boolean minus = false;\n        long num = readByte();\n\n        if(num == '-'){\n            num = 0;\n            minus = true;\n        }else if (num < '0' || '9' < num){\n            throw new NumberFormatException();\n        }else{\n            num -= '0';\n        }\n\n        while(true){\n            int b = readByte();\n            if('0' <= b && b <= '9')\n                num = num * 10 + (b - '0');\n            else if(b == -1 || !isPrintableChar(b))\n                return minus ? -num : num;\n            else\n                throw new NoSuchElementException();\n        }\n    }\n\n    public int nextInt() {\n        long num = nextLong();\n        if (num < Integer.MIN_VALUE || Integer.MAX_VALUE < num)\n            throw new NumberFormatException();\n        return (int)num;\n    }\n\n    public double nextDouble() {\n        return Double.parseDouble(next());\n    }\n\n    public char nextChar() {\n        if (!hasNext()) throw new NoSuchElementException();\n        return (char)readByte();\n    }\n\n    public String nextLine() {\n        while (hasNextByte() && (buf[ptr] == '\\n' || buf[ptr] == '\\r')) ptr++;\n        if (!hasNextByte()) throw new NoSuchElementException();\n\n        StringBuilder sb = new StringBuilder();\n        int b = readByte();\n        while (b != '\\n' && b != '\\r') {\n            sb.appendCodePoint(b);\n            b = readByte();\n        }\n\n        return sb.toString();\n    }\n\n    public int[] nextIntArray(int n) {\n        int[] res = new int[n];\n        for (int i=0; i<n; i++) res[i] = nextInt();\n        return res;\n    }\n\n    public char[] nextCharArray(int n) {\n        char[] res = new char[n];\n        for (int i=0; i<n; i++) res[i] = nextChar();\n        return res;\n    }\n\n    public void close() {try{ in.close();}catch(IOException e){ e.printStackTrace();}};\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.HashSet;\nimport java.util.Arrays;\nimport java.util.AbstractCollection;\nimport java.util.Scanner;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n */\npublic class Main {\n    public static void main(String[] args) {\n        InputStream inputStream = System.in;\n        OutputStream outputStream = System.out;\n        Scanner in = new Scanner(inputStream);\n        PrintWriter out = new PrintWriter(outputStream);\n        UnknownSwitches solver = new UnknownSwitches();\n        try {\n            int testNumber = 1;\n            while (true)\n                solver.solve(testNumber++, in, out);\n        } catch (UnknownError e) {\n            out.close();\n        }\n    }\n\n    static class UnknownSwitches {\n        public void solve(int testNumber, Scanner in, PrintWriter out) {\n            final int N = in.nextInt();\n            final int M = in.nextInt();\n            final int Q = in.nextInt();\n            if (N == 0 && M == 0 && Q == 0) throw new UnknownError();\n            String[] S = new String[Q + 1];\n            String[] B = new String[Q + 1];\n            S[0] = new String();\n            for (int i = 0; i < N; i++) {\n                S[0] += \"0\";\n            }\n            B[0] = new String();\n            for (int i = 0; i < M; i++) {\n                B[0] += \"0\";\n            }\n            for (int i = 0; i < Q; i++) {\n                S[i + 1] = in.next();\n                B[i + 1] = in.next();\n            }\n            StringBuilder buildAns = new StringBuilder();\n            for (int i = 0; i < M; i++) {\n                buildAns.append(\"?\");\n            }\n            boolean[] isHatena = new boolean[M];\n            boolean[] visited = new boolean[N];\n            Arrays.fill(isHatena, false);\n            Arrays.fill(visited, false);\n\n            HashSet<Integer>[] sets = new HashSet[Q];\n            for (int i = 0; i < Q; i++) {\n                sets[i] = new HashSet<>();\n                for (int j = 0; j < M; j++) {\n                    if (B[i].charAt(j) != B[i + 1].charAt(j)) {\n                        sets[i].add(j);\n                    }\n                }\n            }\n\n            for (int i = 0; i < N; i++) {\n                HashSet<Integer> masterSet = new HashSet<>();\n                HashSet<Integer> masterNgSet = new HashSet<>();\n                for (int j = 1; j <= Q; j++) {\n                    if (S[j].charAt(i) == '1') {\n                        visited[i] = true;\n                        if (masterSet.size() == 0) {\n                            masterSet.addAll(sets[j - 1]);\n                        } else {\n                            masterSet.retainAll(sets[j - 1]);\n                            HashSet<Integer> ngset = new HashSet<>();\n                            for (int e : masterSet) {\n                                if (!sets[j - 1].contains(e) || masterNgSet.contains(e)) {\n                                    ngset.add(e);\n                                }\n                            }\n                            for (int e : ngset) {\n                                masterSet.remove(e);\n                            }\n                        }\n                    } else {\n                        masterNgSet.addAll(sets[j - 1]);\n                    }\n                }\n                for (int e : masterSet) {\n                    if (!isHatena[e]) {\n                        if (buildAns.charAt(e) != '?' && buildAns.charAt(e) != cc(i) && !masterNgSet.contains(e)) {\n                            //System.err.println(buildAns.charAt(e) + \" \" + cc(i));\n                            isHatena[e] = true;\n                        } else if (!masterNgSet.contains(e)) {\n                            buildAns.setCharAt(e, cc(i));\n                        }\n                    }\n                }\n            }\n            int cnt = 0;\n            int notVisit = -1;\n            for (int i = 0; i < N; i++) {\n                if (!visited[i]) {\n                    cnt++;\n                    notVisit = i;\n                }\n            }\n            if (cnt == 1) {\n                for (int i = 0; i < M; i++) {\n                    if (buildAns.charAt(i) == '?' && !isHatena[i]) {\n                        buildAns.setCharAt(i, cc(notVisit));\n                    }\n                }\n            }\n            for (int i = 0; i < M; i++) {\n                if (isHatena[i]) {\n                    buildAns.setCharAt(i, '?');\n                }\n            }\n            out.println(buildAns);\n        }\n\n        char cc(int n) {\n            if (0 <= n && n <= 9) return (char) (n + '0');\n            else return (char) (n - 10 + 'A');\n        }\n\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\npublic class Main { \n\tpublic static void main(String[] args) {\n\t\tScanner stdIn = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tint n = stdIn.nextInt();\n\t\t\tint m = stdIn.nextInt();\n\t\t\tint q = stdIn.nextInt();\n\t\t\tif(n == 0 && m == 0 && q == 0) break;\n\t\t\tString[] S = new String[q];\n\t\t\tString[] B = new String[q];\n\t\t\tfor(int i = 0; i < q; i++) {\n\t\t\t\tS[i] = stdIn.next();\n\t\t\t\tB[i] = stdIn.next();\n\t\t\t}\n\t\t\tboolean[][] SX = new boolean[q][n];\n\t\t\tboolean[][] BX = new boolean[q][m];\n\t\t\tfor(int i = 0; i < q; i++) {\n\t\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\t\tSX[i][j] = (S[i].charAt(j) == '1')?true:false;\n\t\t\t\t}\n\t\t\t\tfor(int j = 0; j < m; j++) {\n\t\t\t\t\tBX[i][j] = (B[i].charAt(j) == '1')?true:false;\n\t\t\t\t}\n\t\t\t\tif(i != 0) {\n\t\t\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\t\t\tSX[i][j] = (S[i].charAt(j) == '1')?!SX[i-1][j]:SX[i-1][j];\n\t\t\t\t\t}\n\t\t\t\t\tfor(int j = 0; j < m; j++) {\n\t\t\t\t\t\tBX[i][j] = (B[i].charAt(j) == '1')?true:false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tboolean[][] list = new boolean[n][m];\n\t\t\tfor(int i = 0; i < q; i++) {\n\t\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\t\tif (SX[i][j]) {\n\t\t\t\t\t\tfor (int k = 0; k < m; k++) {\n\t\t\t\t\t\t\tif (!BX[i][k]) {\n\t\t\t\t\t\t\t\tlist[j][k] = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!SX[i][j]) {\n\t\t\t\t\t\tfor (int k = 0; k < m; k++) {\n\t\t\t\t\t\t\tif (BX[i][k]) {\n\t\t\t\t\t\t\t\tlist[j][k] = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\tif(n == 1) {\n\t\t\t\tfor(int i = 0; i < m; i++) {\n\t\t\t\t\tSystem.out.print(0);\n\t\t\t\t}\n\t\t\t\tSystem.out.println();\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tint[] ans = new int[m];\n\t\t\tfor(int i = 0; i < m; i++) {\n\t\t\t\tans[i] = -1;\n\t\t\t\tint count = 0;\n\t\t\t\tint id = 0;\n\t\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\t\tif(!list[j][i]) {\n\t\t\t\t\t\tid = j;\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(count == 1) {\n\t\t\t\t\tans[i] = id+1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0; i < ans.length; i++) {\n\t\t\t\tif(ans[i] == -1) {\n\t\t\t\t\tSystem.out.print(\"?\");\n\t\t\t\t}\n\t\t\t\telse if(ans[i] <= 10) {\n\t\t\t\t\tchar a = '0';\n\t\t\t\t\ta += ans[i]-1;\n\t\t\t\t\tSystem.out.print(a);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tchar a = 'A';\n\t\t\t\t\ta += (ans[i] - 11);\n\t\t\t\t\tSystem.out.print(a);\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\tstatic Scanner sc = new Scanner(System.in);\n\n\tpublic static void main(String[] args) {\n\t\twhile (true) {\n\t\t\tint N = sc.nextInt();\n\t\t\tint M = sc.nextInt();\n\t\t\tint Q = sc.nextInt();\n\t\t\tif (N == 0) break;\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tboolean[][] sw = new boolean[Q][N];\n\t\t\tboolean[][] on = new boolean[Q][M];\n\t\t\tfor (int i = 0; i < Q; ++i) {\n\t\t\t\tchar[] S = sc.next().toCharArray();\n\t\t\t\tchar[] B = sc.next().toCharArray();\n\t\t\t\tfor (int j = 0; j < N; ++j) {\n\t\t\t\t\tsw[i][j] = S[j] == '1';\n\t\t\t\t}\n\t\t\t\tfor (int j = 0; j < M; ++j) {\n\t\t\t\t\ton[i][j] = B[j] == '1';\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int i = 1; i < Q; ++i) {\n\t\t\t\tfor (int j = 0; j < N; ++j) {\n\t\t\t\t\tsw[i][j] ^= sw[i-1][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int i = 0; i < M; ++i) {\n\t\t\t\tboolean[] ng = new boolean[N];\n\t\t\t\tfor (int j = 0; j < Q; ++j) {\n\t\t\t\t\tif (on[j][i]) {\n\t\t\t\t\t\tfor (int k = 0; k < N; ++k) {\n\t\t\t\t\t\t\tif (!sw[j][k]) ng[k] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (int k = 0; k < N; ++k) {\n\t\t\t\t\t\t\tif (sw[j][k]) ng[k] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tint res = -1;\n\t\t\t\tfor (int j = 0; j < N; ++j) {\n\t\t\t\t\tif (ng[j]) continue;\n\t\t\t\t\tres = res == -1 ? j : -2;\n\t\t\t\t}\n\t\t\t\tsb.append((char) (res == -2 ? '?' : (res < 10 ? res + '0' : res - 10 + 'A')));\n\t\t\t}\n\t\t\tSystem.out.println(sb);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\npublic class Main { \n\tpublic static void main(String[] args) {\n\t\tScanner stdIn = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tint n = stdIn.nextInt();\n\t\t\tint m = stdIn.nextInt();\n\t\t\tint q = stdIn.nextInt();\n\t\t\tif(n == 0 && m == 0 && q == 0) break;\n\t\t\tString[] S = new String[q];\n\t\t\tString[] B = new String[q];\n\t\t\tfor(int i = 0; i < q; i++) {\n\t\t\t\tS[i] = stdIn.next();\n\t\t\t\tB[i] = stdIn.next();\n\t\t\t}\n\t\t\tboolean[][] SX = new boolean[q][n];\n\t\t\tboolean[][] BX = new boolean[q][m];\n\t\t\tfor(int i = 0; i < q; i++) {\n\t\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\t\tSX[i][j] = (S[i].charAt(j) == '1')?true:false;\n\t\t\t\t}\n\t\t\t\tfor(int j = 0; j < m; j++) {\n\t\t\t\t\tBX[i][j] = (B[i].charAt(j) == '1')?true:false;\n\t\t\t\t}\n\t\t\t\tif(i != 0) {\n\t\t\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\t\t\tSX[i][j] = (S[i].charAt(j) == '1')?!SX[i-1][j]:SX[i-1][j];\n\t\t\t\t\t}\n\t\t\t\t\tfor(int j = 0; j < m; j++) {\n\t\t\t\t\t\tBX[i][j] = (B[i].charAt(j) == '1')?true:false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tint[] ans = new int[m];\n\t\t\tfor(int i = 0; i < m; i++) {\n\t\t\t\tans[i] = -1;\n\t\t\t}\n\t\t\tboolean[] already = new boolean[n];\n\t\t\tfor(int i = 0; i < 50; i++) {\n\t\t\t\tfor(int j = 0; j < q; j++) {\n\t\t\t\t\tint Tid = 0;\n\t\t\t\t\tint Fid = 0;\n\t\t\t\t\tint Tcount = 0;\n\t\t\t\t\tint Fcount = 0;\n\t\t\t\t\tfor(int k = 0; k < n; k++) {\n\t\t\t\t\t\tif(SX[j][k] && !already[k]) {\n\t\t\t\t\t\t\tTcount++;\n\t\t\t\t\t\t\tTid = k;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(!SX[j][k] && !already[k]) {\n\t\t\t\t\t\t\tFcount++;\n\t\t\t\t\t\t\tFid = k;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(Tcount == 1) {\n\t\t\t\t\t\tfor(int k = 0; k < m; k++) {\n\t\t\t\t\t\t\talready[Tid] = true;\n\t\t\t\t\t\t\tif(BX[j][k] && ans[k] == -1) {\n\t\t\t\t\t\t\t\tans[k] = Tid+1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(Fcount == 1) {\n\t\t\t\t\t\tfor(int k = 0; k < m; k++) {\n\t\t\t\t\t\t\talready[Fid] = true;\n\t\t\t\t\t\t\tif(!BX[j][k] && ans[k] == -1) {\n\t\t\t\t\t\t\t\tans[k] = Fid+1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(n == 1 && m == 1) {\n\t\t\t\tSystem.out.println(0);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfor(int i = 0; i < ans.length; i++) {\n\t\t\t\tif(ans[i] == -1) {\n\t\t\t\t\tSystem.out.print(\"?\");\n\t\t\t\t}\n\t\t\t\telse if(ans[i] <= 10) {\n\t\t\t\t\tchar a = '0';\n\t\t\t\t\ta += ans[i]-1;\n\t\t\t\t\tSystem.out.print(a);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tchar a = 'A';\n\t\t\t\t\ta += (ans[i] - 11);\n\t\t\t\t\tSystem.out.print(a);\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.*;\nimport java.io.*;\n\npublic class Main{\n    static final Reader sc = new Reader();\n    static final PrintWriter out = new PrintWriter(System.out,false);\n\n    public static void main(String[] args) throws Exception {\n    \tString ans = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\n    \twhile(true){\n    \t\tint n = sc.nextInt();\n    \t\tint m = sc.nextInt();\n    \t\tint q = sc.nextInt();\n    \t\tif(n==0 && m==0 && q==0){\n    \t\t\tbreak;\n    \t\t}\n    \t\tboolean[][] judge = new boolean[n][m];\n            for(int i=0;i<n;i++){\n                Arrays.fill(judge[i],true);\n            }\n            String[] s = new String[q];\n            String[] b = new String[q];\n            for(int i=0;i<q;i++){\n                s[i] = sc.next();\n                b[i] = sc.next();\n            }\n            boolean[] nows = new boolean[n];\n            for(int i=0;i<q;i++){\n                for(int j=0;j<n;j++){\n                    if(s[i].charAt(j)=='1'){\n                        nows[j] = !nows[j];\n                    }\n                    for(int k=0;k<m;k++){\n                        if(nows[j] && b[i].charAt(k)=='0'){\n                            judge[j][k] = false;\n                        }\n                        else if(!nows[j] && b[i].charAt(k)=='1'){\n                            judge[j][k] = false;\n                        }\n                    }\n                }\n            }\n            for(int i=0;i<m;i++){\n                int flag = 0;\n                int now = -1;\n                for(int j=0;j<n;j++){\n                    if(judge[j][i]){\n                        flag++;\n                        now = j;\n                    }\n                }\n                if(flag==1){\n                    out.print(ans.charAt(now));\n                }\n                else{\n                    out.print(\"?\");\n                }\n                out.flush();\n            }\n            out.println();\n            out.flush();\n    \t}\n\n        sc.close();\n        out.close();\n    }\n\n    static void trace(Object... o) { System.out.println(Arrays.deepToString(o));}\n}\n\nclass Reader {\n\n    private final InputStream in;\n    private final byte[] buf = new byte[1024];\n    private int ptr = 0;\n    private int buflen = 0;\n\n    public Reader() { this(System.in);}\n    public Reader(InputStream source) { this.in = source;}\n\n    private boolean hasNextByte() {\n        if (ptr < buflen) return true;\n        ptr = 0;\n        try{\n            buflen = in.read(buf);\n        }catch (IOException e) {e.printStackTrace();}\n        if (buflen <= 0) return false;\n        return true;\n    }\n\n    private int readByte() { if (hasNextByte()) return buf[ptr++]; else return -1;}\n\n    private boolean isPrintableChar(int c) { return 33 <= c && c <= 126;}\n\n    private void skip() { while(hasNextByte() && !isPrintableChar(buf[ptr])) ptr++;}\n\n    public boolean hasNext() {skip(); return hasNextByte();}\n\n    public String next() {\n        if (!hasNext()) throw new NoSuchElementException();\n        StringBuilder sb = new StringBuilder();\n        int b = readByte();\n        while (isPrintableChar(b)) {\n            sb.appendCodePoint(b);\n            b = readByte();\n        }\n        return sb.toString();\n    }\n\n    public long nextLong() {\n        if (!hasNext()) throw new NoSuchElementException();\n        boolean minus = false;\n        long num = readByte();\n\n        if(num == '-'){\n            num = 0;\n            minus = true;\n        }else if (num < '0' || '9' < num){\n            throw new NumberFormatException();\n        }else{\n            num -= '0';\n        }\n\n        while(true){\n            int b = readByte();\n            if('0' <= b && b <= '9')\n                num = num * 10 + (b - '0');\n            else if(b == -1 || !isPrintableChar(b))\n                return minus ? -num : num;\n            else\n                throw new NoSuchElementException();\n        }\n    }\n\n    public int nextInt() {\n        long num = nextLong();\n        if (num < Integer.MIN_VALUE || Integer.MAX_VALUE < num)\n            throw new NumberFormatException();\n        return (int)num;\n    }\n\n    public double nextDouble() {\n        return Double.parseDouble(next());\n    }\n\n    public char nextChar() {\n        if (!hasNext()) throw new NoSuchElementException();\n        return (char)readByte();\n    }\n\n    public String nextLine() {\n        while (hasNextByte() && (buf[ptr] == '\\n' || buf[ptr] == '\\r')) ptr++;\n        if (!hasNextByte()) throw new NoSuchElementException();\n\n        StringBuilder sb = new StringBuilder();\n        int b = readByte();\n        while (b != '\\n' && b != '\\r') {\n            sb.appendCodePoint(b);\n            b = readByte();\n        }\n\n        return sb.toString();\n    }\n\n    public int[] nextIntArray(int n) {\n        int[] res = new int[n];\n        for (int i=0; i<n; i++) res[i] = nextInt();\n        return res;\n    }\n\n    public char[] nextCharArray(int n) {\n        char[] res = new char[n];\n        for (int i=0; i<n; i++) res[i] = nextChar();\n        return res;\n    }\n\n    public void close() {try{ in.close();}catch(IOException e){ e.printStackTrace();}};\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.HashSet;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n */\npublic class Main {\n    public static void main(String[] args) {\n        InputStream inputStream = System.in;\n        OutputStream outputStream = System.out;\n        Scanner in = new Scanner(inputStream);\n        PrintWriter out = new PrintWriter(outputStream);\n        UnknownSwitches solver = new UnknownSwitches();\n        try {\n            int testNumber = 1;\n            while (true)\n                solver.solve(testNumber++, in, out);\n        } catch (UnknownError e) {\n            out.close();\n        }\n    }\n\n    static class UnknownSwitches {\n        public void solve(int testNumber, Scanner in, PrintWriter out) {\n            final int N = in.nextInt();\n            final int M = in.nextInt();\n            final int Q = in.nextInt();\n            if (N == 0 && M == 0 && Q == 0) throw new UnknownError();\n            String[] S = new String[Q + 1];\n            String[] B = new String[Q + 1];\n            S[0] = new String();\n            for (int i = 0; i < N; i++) {\n                S[0] += \"0\";\n            }\n            B[0] = new String();\n            for (int i = 0; i < M; i++) {\n                B[0] += \"0\";\n            }\n            for (int i = 0; i < Q; i++) {\n                S[i + 1] = in.next();\n                B[i + 1] = in.next();\n            }\n            StringBuilder buildAns = new StringBuilder();\n            for (int i = 0; i < M; i++) {\n                buildAns.append(\"?\");\n            }\n            boolean[] isHatena = new boolean[M];\n            boolean[] visited = new boolean[N];\n            Arrays.fill(isHatena, false);\n            Arrays.fill(visited, false);\n\n            HashSet<Integer>[] sets = new HashSet[Q];\n            for (int i = 0; i < Q; i++) {\n                sets[i] = new HashSet<>();\n                for (int j = 0; j < M; j++) {\n                    if (B[i].charAt(j) != B[i + 1].charAt(j)) {\n                        sets[i].add(j);\n                    }\n                }\n            }\n\n            for (int i = 0; i < N; i++) {\n                HashSet<Integer> masterSet = new HashSet<>();\n                HashSet<Integer> masterNgSet = new HashSet<>();\n                for (int j = 1; j <= Q; j++) {\n                    if (S[j].charAt(i) == '1') {\n                        visited[i] = true;\n                        if (masterSet.size() == 0) {\n                            for (int e : sets[j - 1]) {\n                                masterSet.add(e);\n                            }\n                        } else {\n                            HashSet<Integer> ngset = new HashSet<>();\n                            for (int e : masterSet) {\n                                if (!sets[j - 1].contains(e) || masterNgSet.contains(e)) {\n                                    ngset.add(e);\n                                }\n                            }\n                            for (int e : ngset) {\n                                masterSet.remove(e);\n                            }\n                        }\n                    } else {\n                        for (int e : sets[j - 1]) {\n                            masterNgSet.add(e);\n                        }\n                    }\n                }\n                for (int e : masterSet) {\n                    if (!isHatena[e]) {\n                        if (buildAns.charAt(e) != '?' && buildAns.charAt(e) != cc(i) && !masterNgSet.contains(e)) {\n                            //System.err.println(buildAns.charAt(e) + \" \" + cc(i));\n                            isHatena[e] = true;\n                        } else if (!masterNgSet.contains(e)) {\n                            buildAns.setCharAt(e, cc(i));\n                        }\n                    }\n                }\n            }\n            int cnt = 0;\n            int notVisit = -1;\n            for (int i = 0; i < N; i++) {\n                if (!visited[i]) {\n                    cnt++;\n                    notVisit = i;\n                }\n            }\n            if (cnt == 1) {\n                for (int i = 0; i < M; i++) {\n                    if (buildAns.charAt(i) == '?' && !isHatena[i]) {\n                        buildAns.setCharAt(i, cc(notVisit));\n                    }\n                }\n            }\n            for (int i = 0; i < M; i++) {\n                if (isHatena[i]) {\n                    buildAns.setCharAt(i, '?');\n                }\n            }\n            out.println(buildAns);\n        }\n\n        char cc(int n) {\n            if (0 <= n && n <= 9) return (char) (n + '0');\n            else return (char) (n - 10 + 'A');\n        }\n\n    }\n}"
  },
  {
    "language": "Ruby",
    "code": "def inv(bit,m)\n    bs = bit.to_s(2)\n    if bs.length < m\n        bs = \"0\" * (m - bs.length) + bs\n    end\n    ret = \"\"\n    bs.each_char do |c|\n        ret << (c == \"0\" ? \"1\" : \"0\")\n    end\n    ret.to_i(2)\nend\nconv = ('0'..'9').to_a + ('A'..'Z').to_a\nloop do\n    n, m, q = gets.split.map(&:to_i)\n    break if n == 0 && m == 0 && q == 0\n    cor = Array.new(m,2**n-1)\n    prev = 0\n    q.times do\n        input = gets.chomp.split\n        s = input[0].to_i(2)\n        b = prev ^ input[1].to_i(2)\n        bs = b.to_s(2)\n        if bs.length < m\n            bs = \"0\" * (m - bs.length) + bs\n        end\n        inv = inv(s,m)\n        bs.each_char.with_index do |bit,i|\n            if bit == \"1\"\n                cor[i] &= s\n            else\n                cor[i] &= inv\n            end\n        end\n        prev = input[1].to_i(2)\n    end\n    ret = \"\"\n    cor.each do |c|\n        if c & (c-1) != 0\n            ret << \"?\"\n        else\n            t = n - 1 - Math.log2(c).to_i\n            ret << conv[t]\n        end\n    end\n    puts ret\nend"
  },
  {
    "language": "Ruby",
    "code": "loop do\n    switch_num, light_num, ope_num = gets.split.map(&:to_i)\n    break if switch_num == 0\n    alph = (?0..?9).to_a + (?A..?Z).to_a\n    alph = alph[0..switch_num-1]\n\n    candidates = (1..light_num).map { (1 << switch_num) - 1 }\n    switch_state = 0\n    ope_num.times do\n        ope, light_state = gets.split.map{|s| s.to_i(2)}\n        switch_state ^= ope\n        (0..light_num-1).each do |i|\n            if light_state[i] == 1\n                candidates[i] &= switch_state\n            else\n                candidates[i] -= candidates[i] & switch_state\n            end\n        end\n    end\n\n    a = (0..light_num-1).map do |i|\n        x = candidates[i]\n        if x & (x - 1) == 0\n            alph[- Math.log2(x).to_i - 1]\n        else\n            ??\n        end\n    end\n    puts a.reverse.join\nend"
  },
  {
    "language": "Ruby",
    "code": "def inv(bit,m)\n    bs = bit.to_s(2)\n    if bs.length < m\n        bs = \"0\" * (m - bs.length) + bs\n    end\n    ret = \"\"\n    bs.each_char do |c|\n        ret << (c == \"0\" ? \"1\" : \"0\")\n    end\n    ret.to_i(2)\nend\nconv = ('0'..'9').to_a + ('A'..'Z').to_a\nloop do\n    n, m, q = gets.split.map(&:to_i)\n    break if n == 0 && m == 0 && q == 0\n    cor = Array.new(m,2**n-1)\n    prev = 0\n    q.times do\n        input = gets.chomp.split\n        s = input[0].to_i(2)\n        b = prev ^ input[1].to_i(2)\n        bs = b.to_s(2)\n        if bs.length < m\n            bs = \"0\" * (m - bs.length) + bs\n        end\n        inv = inv(s,n)\n        bs.each_char.with_index do |bit,i|\n            if bit == \"1\"\n                cor[i] &= s\n            else\n                cor[i] &= inv\n            end\n        end\n        prev = input[1].to_i(2)\n    end\n    ret = \"\"\n    cor.each do |c|\n        if c & (c-1) != 0\n            ret << \"?\"\n        else\n            t = n - 1 - Math.log2(c).to_i\n            ret << conv[t]\n        end\n    end\n    puts ret\nend"
  },
  {
    "language": "Python",
    "code": "ref = \"0123456789ACDEFGHIJKLMNOPQRSTUVWXYZ\"\nwhile 1:\n    N,M,Q = map(int,raw_input().split())\n    if N == 0: break\n    sn = set(range(N))\n    corr = [set(range(N)) for _ in range(M)]\n    s = [0]*N\n    for loop in xrange(Q):\n        S,B = raw_input().split()\n        s = [1-s[i] if S[i] == \"1\" else s[i] for i in range(N)]\n        on  = set([i for i in range(N) if s[i]])\n        off = sn-on\n        for i in range(M):\n            corr[i] &= on if B[i] == \"1\" else off\n    ans = [ref[list(i)[0]] if len(i) == 1 else \"?\" for i in corr]\n    print \"\".join(ans)"
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,random,time,copy,functools\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 998244353\ndd = [(0,-1),(1,0),(0,1),(-1,0)]\nddn = [(0,-1),(1,-1),(1,0),(1,1),(0,1),(-1,-1),(-1,0),(-1,1)]\n\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\n\n\ndef main():\n    rr = []\n\n    st = string.digits + string.ascii_uppercase\n\n    while True:\n        n,m,q = LI()\n        if n == 0:\n            break\n\n        a = [LS() for _ in range(q)]\n        if n == 1:\n            rr.append('0'*m)\n            continue\n        u = [0] * m\n        v = [0] * m\n        ms = 0\n        mk = 2**n - 1\n        for t,s in a:\n            mt = int(t[::-1],2)\n            tu = ms ^ mt\n            tv = mk ^ tu\n            for i in range(m):\n                if s[i] == '1':\n                    u[i] |= tu\n                    v[i] |= tv\n                else:\n                    v[i] |= tu\n                    u[i] |= tv\n            ms = tu\n\n        r = ''\n        for i in range(m):\n            t = None\n            for ti in range(n):\n                if (u[i] & 2**ti) > 0 and (v[i] & 2**ti) == 0:\n                    if t is None:\n                        t = '{:X}'.format(ti)\n                    else:\n                        '?'\n                        break\n            if not t:\n                t = '?'\n            r += str(t)\n\n        rr.append(r)\n\n    return '\\n'.join(map(str, rr))\n\n\nprint(main())\n\n\n"
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,random,time,copy,functools\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 998244353\ndd = [(0,-1),(1,0),(0,1),(-1,0)]\nddn = [(0,-1),(1,-1),(1,0),(1,1),(0,1),(-1,-1),(-1,0),(-1,1)]\n\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\n\n\ndef main():\n    rr = []\n\n    st = string.digits + string.ascii_uppercase\n\n    while True:\n        n,m,q = LI()\n        if n == 0:\n            break\n\n        a = [LS() for _ in range(q)]\n        if n == 1:\n            rr.append('0'*m)\n            continue\n        u = [0] * m\n        v = [0] * m\n        ms = 0\n        mk = 2**n - 1\n        for t,s in a:\n            mt = int(t[::-1],2)\n            tu = ms ^ mt\n            tv = mk ^ tu\n            for i in range(m):\n                if s[i] == '1':\n                    u[i] |= tu\n                    v[i] |= tv\n                else:\n                    v[i] |= tu\n                    u[i] |= tv\n            ms = tu\n\n        r = ''\n        for i in range(m):\n            t = None\n            for ti in range(n):\n                if (u[i] & 2**ti) > 0 and (v[i] & 2**ti) == 0:\n                    if t is None:\n                        t = st[ti]\n                    else:\n                        t = '?'\n                        break\n            if not t:\n                t = '?'\n            r += str(t)\n\n        rr.append(r)\n\n    return '\\n'.join(map(str, rr))\n\n\nprint(main())\n\n\n"
  },
  {
    "language": "Python",
    "code": "#!usr/bin/env python3\nfrom collections import defaultdict,deque\nfrom heapq import heappush, heappop\nimport sys\nimport math\nimport bisect\nimport random\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef I(): return int(sys.stdin.readline())\ndef LS():return [list(x) for x in sys.stdin.readline().split()]\ndef S(): return list(sys.stdin.readline())[:-1]\ndef IR(n):\n    return [I() for i in range(n)]\ndef LIR(n):\n    return [LI() for i in range(n)]\ndef SR(n):\n    return [S() for i in range(n)]\ndef LSR(n):\n    return [LS() for i in range(n)]\n\nsys.setrecursionlimit(1000000)\nmod = 1000000007\n\ndef solve(n,m,q):\n    if q == 0:\n        if n == 1:\n            print(\"0\"*m)\n        else:\n            print(\"?\"*m)\n        return\n    ans = [\"?\"]*m\n    f = defaultdict(lambda : \"?\")\n    for i in range(10):\n        f[i] = str(i)\n    alp = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n    for i in range(len(alp)):\n        f[i+10] = alp[i]\n    s = [[int(x,2) for x in input().split()] for i in range(q)]\n    for i in range(q-1):\n        s[i+1][0] ^= s[i][0]\n    M = (1<<m)-1\n    for i in range(n):\n        bi = 1<<(n-i-1)\n        k = M\n        for a,b in s:\n            if not a&bi:\n                k &= (M-b)\n            else:\n                k &= b\n        for j in range(m):\n            if k&(1<<j):\n                if ans[-1-j] != \"?\":\n                    ans[-1-j] = 37\n                else:\n                    ans[-1-j] = i\n    ans = [f[i] for i in ans]\n    print(*ans,sep = \"\")\n    return\n\n#Solve\nif __name__ == \"__main__\":\n    while 1:\n        n,m,q = LI()\n        if n == 0:\n            break\n        solve(n,m,q)\n\n"
  },
  {
    "language": "Python",
    "code": "ref = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\nwhile 1:\n    N,M,Q = map(int,raw_input().split())\n    if N == 0: break\n\n    corr = [set(range(N)) for _ in range(M)]\n    s = [\"0\"]*N\n    for loop in xrange(Q):\n        S,B = raw_input().split()\n        for i in range(N):\n            if S[i] == \"1\": s[i] = {\"0\":\"1\",\"1\":\"0\"}[s[i]]\n        on  = set([i for i in range(N) if s[i] == \"1\"])\n        off = set(range(N))-on\n        for i in range(M):\n            if B[i] == \"1\": corr[i] &= on\n            else:           corr[i] &= off\n    ans = [ref[list(i)[0]] if len(i) == 1 else \"?\" for i in corr]\n    print \"\".join(ans)"
  },
  {
    "language": "Python",
    "code": "while True:\n    N, M, Q = map(int, input().split())  # N個のスイッチ, M個のライト, Q個のクエリ\n    if N == 0 and M == 0 and Q ==0:\n        exit()\n    # 全ての配列を繋がっていることを仮定する\n    correspondence = [set(list(range(M))) for _ in range(N)]\n    # print(correspondence) 全てのスイッチと繋がっていることが確認できた\n    switch_status = [0]*N  # スイッチの初期状態\n    light_status = [0]*M  # ライトの初期状態\n    for _ in range(Q):  # Q個のクエリが飛んでくる\n        s, b = map(str, input().split())  # 操作したスイッチの情報と, 現在のライトの状態\n        # 1つずつxorを取りたい\n        # 操作したスイッチのインデックス (リスト)と、変化したライトのインデックス (set)が欲しい\n        switch_index = list(map(int, s))  # 今回操作したスイッチの情報, これで数字に変換できる\n        light_index = list(map(int, b))  # 現在のライトの情報, これで数字に変換できる\n\n        changed_switch = []\n        for i in range(len(switch_index)):\n            if switch_index[i] == 1:\n                changed_switch.append(i)\n                switch_status[i] = switch_status[i] ^ 1  # 今まで0なら次の状態は1へ, 今まで1なら次の状態は0へ\n        # changed_switchを使って色々やる\n        # その前にまず、状態が変わったの一覧を手に入れる\n        changed_light = []\n        for i in range(len(light_index)):\n            if light_status[i] ^ light_index[i]:  # 状態が変わったなら\n                changed_light.append(i)  # 状態が変わったライト\n        light_status = light_index  # ライトの状態を更新する\n        set_changed_light = set(changed_light)\n        # print(correspondence)\n        for i in range(N):\n            if i in changed_switch:\n                correspondence[i] &= set_changed_light\n            else:\n                correspondence[i] -= set_changed_light\n        # for c in changed_switch:  # 状態が変わったスイッチ, その他のスイッチからはライトを削除する必要ありそう\n        #     correspondence[c] &= set_changed_light\n    # print(correspondence)\n    ans = [[] for _ in range(M)]  # M個のライトの状態\n    for i, lights in enumerate(correspondence):\n        for l in lights:\n            ans[l].append(i)\n    true_ans = \"\"\n    co_dict = {0: \"0\", 1: \"1\", 2: \"2\", 3: \"3\", 4: \"4\", 5: \"5\", 6: \"6\", 7: \"7\", 8: \"8\", 9: \"9\", 10: \"A\", 11: \"B\", \\\n    12: \"C\", 13: \"D\", 14: \"E\", 15: \"F\", 16: \"G\", 17: \"H\", 18: \"I\", 19: \"J\", 20: \"K\", 21: \"L\", 22: \"M\", 23: \"N\", 24: \"O\", \\\n    25: \"P\", 26: \"Q\", 27: \"R\", 28: \"S\", 29: \"T\", 30: \"U\", 31: \"V\", 32: \"W\", 33: \"X\", 34: \"Y\", 35: \"Z\"}\n    for i in range(M):\n        if len(ans[i]) > 1:\n            true_ans += \"?\"\n        else:\n            true_ans += co_dict[ans[i][0]]\n\n    print(true_ans)\n\n# [{8, 9}, {6, 7}, {0, 1, 2, 3, 4, 5}]\n# 2222221100\n\n"
  },
  {
    "language": "Python",
    "code": "while 1:\n  n,m,q=map(int,input().split())\n  if (n|m|q)==0: break\n  \n  p=[]\n  res=[[_ for _ in range(n)] for _ in range(m)]\n  for i in range(q):\n    s,b=[[int(c) for c in s] for s in input().split()]\n    if i>0:\n      for j in range(n):\n        s[j]^=p[j]\n    for j in range(n):\n      for k in range(m):\n        if s[j]!=b[k] and j in res[k]:\n          res[k].remove(j)\n    p=s\n  \n  table=\"\".join([str(i) for i in range(10)]+[chr(ord(\"A\")+i) for i in range(26)])\n  for i in range(m):\n    if len(res[i])==1:\n      print(table[res[i][0]],sep=\"\",end=\"\")\n    else:\n      print(\"?\",sep=\"\",end=\"\")\n  print()"
  },
  {
    "language": "Python",
    "code": "ref = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"\nwhile 1:\n    N,M,Q = map(int,raw_input().split())\n    if N == 0: break\n    sn = set(range(N))\n    corr = [set(range(N)) for _ in range(M)]\n    s = [0]*N\n    for loop in xrange(Q):\n        S,B = raw_input().split()\n        s = [1-s[i] if S[i] == \"1\" else s[i] for i in range(N)]\n        on  = set([i for i in range(N) if s[i]])\n        off = sn-on\n        for i in range(M):\n            corr[i] &= on if B[i] == \"1\" else off\n    ans = [ref[list(i)[0]] if len(i) == 1 else \"?\" for i in corr]\n    print \"\".join(ans)\n    "
  },
  {
    "language": "Python",
    "code": "ref = \"0123456789ACDEFGHIJKLMNOPQRSTUVWXYZ\"\nwhile 1:\n    N,M,Q = map(int,raw_input().split())\n    if N == 0: break\n\n    corr = [set(range(N)) for _ in range(M)]\n    s = [\"0\"]*N\n    for loop in xrange(Q):\n        S,B = raw_input().split()\n        for i in range(N):\n            if S[i] == \"1\": s[i] = {\"0\":\"1\",\"1\":\"0\"}[s[i]]           \n        on  = set([i for i in range(N) if s[i] == \"1\"])\n        off = set(range(N))-on\n        for i in range(M):\n            if B[i] == \"1\": corr[i] &= on\n            else:           corr[i] &= off\n    ans = [ref[list(i)[0]] if len(i) == 1 else \"?\" for i in corr]\n    print \"\".join(ans)"
  },
  {
    "language": "Python",
    "code": "while 1:\n  n,m,q=map(int,input().split())\n  if (n|m|q)==0: break\n  \n  p=[]\n  res=[{_ for _ in range(n)} for _ in range(m)]\n  for i in range(q):\n    s,b=[[int(c) for c in s] for s in input().split()]\n    if i>0:\n      for j in range(n):\n        s[j]^=p[j]\n    zero={i for i in range(n) if s[i]==0}\n    one={i for i in range(n) if s[i]==1}\n    for j in range(m):\n      if(b[j]==0): res[j]-=one\n      if(b[j]==1): res[j]-=zero\n    p=s\n  \n  table=\"\".join([str(i) for i in range(10)]+[chr(ord(\"A\")+i) for i in range(26)])\n  for i in range(m):\n    if len(res[i])==1:\n      print(table[res[i].pop()],sep=\"\",end=\"\")\n    else:\n      print(\"?\",sep=\"\",end=\"\")\n  print()"
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,random,time,copy,functools\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 998244353\ndd = [(0,-1),(1,0),(0,1),(-1,0)]\nddn = [(0,-1),(1,-1),(1,0),(1,1),(0,1),(-1,-1),(-1,0),(-1,1)]\n\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\n\n\ndef main():\n    rr = []\n\n    st = string.digits + string.ascii_uppercase\n\n    while True:\n        n,m,q = LI()\n        if n == 0:\n            break\n\n\n        a = [LS() for _ in range(q)]\n        if n == 1:\n            rr.append('0'*m)\n            continue\n        u = [set() for _ in range(m)]\n        v = [set() for _ in range(m)]\n        ms = '0' * m\n        for t,s in a:\n            ts = []\n            ns = []\n            for i in range(n):\n                if t[i] == '1':\n                    ts.append(i)\n                else:\n                    ns.append(i)\n            us = set()\n            vs = set()\n            for i in range(m):\n                for ti in ts:\n                    if s[i] != ms[i]:\n                        u[i].add(ti)\n                    else:\n                        v[i].add(ti)\n                for ni in ns:\n                    if s[i] != ms[i]:\n                        v[i].add(ni)\n                    else:\n                        u[i].add(ni)\n            ms = s\n\n        r = ''\n        for i in range(m):\n            t = u[i] - v[i]\n            if len(t) == 1:\n                r += st[list(t)[0]]\n            else:\n                r += '?'\n        rr.append(r)\n\n    return '\\n'.join(map(str, rr))\n\n\nprint(main())\n\n\n"
  }
]