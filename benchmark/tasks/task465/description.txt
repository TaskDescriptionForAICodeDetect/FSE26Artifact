In the headquarters building of ICPC (International Company of Plugs & Connectors), there are M light bulbs and N switches. Each light bulb can be turned on or off by exactly one switch. Each switch may control multiple light bulbs. When a switch is operated, all light bulbs controlled by that switch change their state. You have lost the table that recorded the correspondence between the switches and the light bulbs, and you want to restore it based on the information about which switches you have operated and the states of the light bulbs you have checked after the operations. Your input will consist of multiple datasets, with constraints on the number of switches, light bulbs, and operations. For each dataset, you are required to output the correspondence between the switches and the light bulbs in base-36 format. If a correspondence cannot be definitively determined, you will use '?' to indicate uncertainty.