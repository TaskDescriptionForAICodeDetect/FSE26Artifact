[
  {
    "language": "Scala",
    "code": "import scala.annotation.tailrec\nimport scala.io.StdIn._\nobject Main extends App {\n\n  val input = readLine.trim.toList\n  val bob = readLine.trim.toInt\n  val multiplicationFirst = input match {\n    case m MultiplicationFirst Nil ⇒ m\n    case _ ⇒ None\n  }\n  val left = input match {\n    case l Left Nil ⇒ l\n    case _ ⇒ ???\n  }\n  println(\n    if (bob == multiplicationFirst && bob != left) 'M'\n    else if (bob != multiplicationFirst && bob == left) 'L'\n    else if (bob == multiplicationFirst && bob == left) 'U'\n    else 'I'\n  )\n\n  object MultiplicationFirst {\n    def unapply(str: List[Char]): Option[(Long, List[Char])] = {\n      str match {\n        case l Factor t ⇒\n          t match {\n            case '+':: (r MultiplicationFirst rest) ⇒ Some(l + r, rest)\n            case Nil ⇒ Some(l, t)\n            case _ ⇒ ???\n          }\n        case _ ⇒ ???\n      }\n    }\n    private object Factor {\n      def unapply(str: List[Char]): Option[(Long, List[Char])] = {\n        str match {\n          case l Number t ⇒ Some(takeAll(t, l))\n          case _ ⇒ None\n        }\n      }\n    }\n    @tailrec private[this] def takeAll(str: List[Char], left: Long): (Long, List[Char]) = {\n      str match {\n        case '*'::(r Number rest) ⇒ takeAll(rest, left * r)\n        case _ ⇒ (left, str)\n      }\n    }\n  }\n  object Left {\n    def unapply(str: List[Char]): Option[(Long, List[Char])] = {\n      str match {\n        case l Number t ⇒ Some(takeAll(t, l), Nil)\n        case _ ⇒ ???\n      }\n    }\n    @tailrec private[this] def takeAll(str: List[Char], left: Long): Long = {\n      str match {\n        case '+'::(r Number rest) ⇒ takeAll(rest, left + r)\n        case '*'::(r Number rest) ⇒ takeAll(rest, left * r)\n        case Nil ⇒ left\n        case _ ⇒ ???\n      }\n    }\n  }\n  object Number {\n    def unapply(str: List[Char]): Option[(Long, List[Char])] = {\n      str.span(_.isDigit) match {\n        case (Nil, _) ⇒ None\n        case (n, t) ⇒ Some(n.foldLeft(0L){(a, b) ⇒ a * 10 + b.asDigit }, t)\n      }\n    }\n  }\n  implicit class Extension[T](val value: T) extends AnyVal {\n    @inline def let[A](@inline func: T ⇒ A): A = func(value)\n    @inline def also(@inline func: T ⇒ Unit): T = {func(value); value}\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n\nusing namespace std;\n\nint main(){\n\tstring s;\n\tcin >> s;\n\tint n;\n\tcin >> n;\n\t\n\tint ncal = s[0] -'0';\n\tfor(int i = 2;i < s.size();i+=2){\n\t\tif(s[i-1] == '+'){\n\t\t\tncal += s[i] - '0';\n\t\t}else{\n\t\t\tncal *= s[i] - '0';\n\t\t}\n\t}\n\t\n\tint rcal = 0;\n\tint tmulti = 1;\n\tfor(int i = 0;i < s.size()-1;i+=2){\n\t\tif(s[i+1] == '+'){\n\t\t\trcal += tmulti * (s[i] - '0');\n\t\t\ttmulti = 1;\n\t\t}else{\n\t\t\ttmulti *= s[i] - '0';\n\t\t}\n\t}\n\trcal += tmulti * (s[s.size()-1] - '0');\n\t\n\tif(n == rcal && n != ncal){\n\t\tcout << \"M\" << endl;\n\t}else if(n != rcal && n == ncal){\n\t\tcout << \"L\" << endl;\n\t}else if(n == rcal && n == ncal){\n\t\tcout << \"U\" << endl;\n\t}else{\n\t\tcout << \"I\" << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nconst int INF = 1e9;\nconst ll LINF = 1e18;\n\n\nll getv(string& S,int& i){\n    ll ret = 0;\n    while(S[i]>='0'&&S[i]<='9'){\n        ret = ret * 10 + (S[i]-'0');\n        i++;\n    }\n    return ret;\n}\nll rule1(string S){\n    ll ret = 0;\n    vector<ll> type;\n    vector<ll> vals;\n    int i = 0;\n    while(i < S.length()){\n        ll val = getv(S,i);\n        vals.push_back(val);\n        if(i == S.length()) break;\n        if(S[i] == '+') type.push_back(0);\n        else type.push_back(1);\n        \n        i++;\n    }\n    \n//    for(auto v:type) cout << v << \" \"; cout << endl;\n//    for(auto v:vals) cout << v << \" \"; cout << endl;\n    \n    while(true){\n        bool update = false;\n        for(int i = 0; i < type.size();i++){\n            if(type[i] == 1){\n                update = true;\n                vals[i] *= vals[i+1];\n                type.erase(type.begin()+i);\n                vals.erase(vals.begin()+i+1);\n                break;\n            }\n        }\n        if(update) continue;\n        break;\n    }\n    \n    ret = accumulate(vals.begin(), vals.end(), 0LL);\n    return ret;\n}\nll rule2(string S){\n    ll ret = 0;\n    vector<ll> type;\n    vector<ll> vals;\n    int i = 0;\n    while(i < S.length()){\n        ll val = getv(S,i);\n        vals.push_back(val);\n        if(i == S.length()) break;\n        if(S[i] == '+') type.push_back(0);\n        else type.push_back(1);\n        \n        i++;\n    }\n    \n    ret = vals.front();\n    for(int i = 0; i < type.size();i++){\n        if(type[i]==1){\n            ret *= vals[i+1];\n        }else{\n            ret += vals[i+1];\n        }\n    }\n    \n    return ret;\n}\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n    string S; cin >> S;\n    ll A; cin >> A;\n    \n    ll r1 = rule1(S);\n    ll r2 = rule2(S);\n    \n    bool f1 = r1 == A, f2 = r2 == A;\n    \n    if(f1&&!f2) cout << \"M\" << endl;\n    else if(!f1&&f2) cout << \"L\" << endl;\n    else if(f1&&f2) cout << \"U\" << endl;\n    else cout << \"I\" << endl;\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <utility>\n\nusing namespace std;\ntypedef pair<int, int> pii;\n\npii lex_expr(const char *s, int p);\npii lex_term(const char *s, int p);\n\npii lex_expr(const char *s, int p){\n\tpii r(s[p] - '0', p + 1);\n\t++p;\n\twhile(s[p] == '+'){\n\t\tconst pii q = lex_term(s, p + 1);\n\t\tr.first += q.first;\n\t\tr.second = p = q.second;\n\t}\n\treturn r;\n}\npii lex_term(const char *s, int p){\n\tpii r(s[p] - '0', p + 1);\n\t++p;\n\twhile(s[p] == '*'){\n\t\tr.first *= s[p + 1] - '0';\n\t\tr.second = p = p + 2;\n\t}\n\treturn r;\n}\n\nint solve(const char *s){\n\tint p = 1, result = s[0] - '0';\n\twhile(s[p] != '\\0'){\n\t\tif(s[p] == '+'){\n\t\t\tresult += s[p + 1] - '0';\n\t\t}else{\n\t\t\tresult *= s[p + 1] - '0';\n\t\t}\n\t\tp += 2;\n\t}\n\treturn result;\n}\n\nint main(){\n\tios_base::sync_with_stdio(false);\n\tstring s;\n\tint n;\n\tcin >> s >> n;\n\tconst char table[] = \"IMLU\";\n\tint answer = 0;\n\tif(lex_expr(s.c_str(), 0).first == n){ answer |= 1; }\n\tif(solve(s.c_str()) == n){ answer |= 2; }\n\tcout << table[answer] << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\n#include <ctype.h>\n#include <string> \n#include <sstream>\n#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <map>\n#include <queue>\n#include <utility>\n#include <vector>\n#include <set>\n#include <iomanip>\n#include <stack>\n  \nusing namespace std;\n\n#define pi 3.141592653589793\n\n\n//  + を -1　* を -11\nint multiplication_first(string s)\n{\n\tstack<int> calculation;\n\tint cnt = 0;\n\twhile(cnt < s.length()){\n\t\tif(isdigit(s[cnt])){\n\t\t\tcalculation.push(s[cnt] - '0');\n\t\t} else if(s[cnt] == '*'){\n\t\t\tint result = calculation.top() * (s[cnt + 1] - '0');\n\t\t\tcalculation.pop();\n\t\t\tcalculation.push(result);\n\t\t\tcnt++;\n\t\t}\n\t\tcnt++;\n\t}\n\twhile(calculation.size() != 1){\n\t\tint top = calculation.top();\n\t\tcalculation.pop();\n\t\tint second = calculation.top();\n\t\tcalculation.pop();\n\t\tcalculation.push(top + second);\n\t}\n\treturn calculation.top();\n}\n\nint left_to_right(string s)\n{\n\tint ans = s[0] - '0';\n\tint cnt = 1;\n\twhile(cnt < s.length()){\n\t\tif(s[cnt] == '+'){\n\t\t\tans += s[cnt + 1] - '0';\n\t\t\tcnt++;\n\t\t} else if(s[cnt] == '*'){\n\t\t\tans = ans * (s[cnt + 1] - '0');\n\t\t\tcnt++;\n\t\t}\n\t\tcnt++;\n\t}\n\treturn ans;\t\n}\n\nint main()\n{\n\tstring s;\n\tint bobans;\n\tcin >> s >> bobans;\n\tint ans[2] ={};\n\t// ans[0]:multiplication_firstとあっているか　ans[1]:left_to_rightとあっているか　あってたら1\n\tif(bobans == multiplication_first(s)) ans[0]++;\n\tif(bobans == left_to_right(s)) ans[1]++;\n\tif(ans[0] && ans[1]) cout << 'U' << endl;\n\telse if(ans[0]) cout << 'M' << endl;\n\telse if(ans[1]) cout << 'L' << endl;\n\telse cout << 'I' << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//include\n//------------------------------------------\n#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <deque>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <queue>\n\nusing namespace std;\n\n//typedef\n//------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef long long LL;\n\n//container util\n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define EACH(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n\n//repetition\n//------------------------------------------\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\n//constant\n//--------------------------------------------\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\n\nint main(){\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n\n  string str; getline(cin, str);\n  int ans; cin >> ans;\n  \n  VI num;\n  for(int i=0;i<SZ(str);i+=2)\n\tnum.PB(str[i] - '0');\n\n  int calcM = 0;\n  VI tmp = num;\n  for(int i=1;i<SZ(str);i+=2)\n\tif(str[i] == '*'){\n\t  tmp[i/2+1] = tmp[i/2] * tmp[i/2+1];\n\t  tmp[i/2] = 0;\n\t}\n  calcM = accumulate(ALL(tmp), 0);\n\n  int calcL = num[0];\n  for(int i=1;i<SZ(str);i+=2)\n\tif(str[i] == '+') calcL += num[i/2+1];\n\telse calcL *= num[i/2+1];\n\n  if(calcM == calcL)\n\tcout << (ans == calcM? \"U\": \"I\") << endl;\n  else\n\tcout << (ans == calcM? \"M\": (ans == calcL? \"L\": \"I\")) << endl;\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n \nint result;\nchar s[100];\n \nint calc_ltor(char s[]){\n    int res = s[0] - '0';\n    for(int i=1;s[i]!='\\0';i+=2){\n        if(s[i] == '+'){\n            res += s[i+1]-'0';\n        }\n        else if(s[i] == '*'){\n            res *= s[i+1]-'0';\n        }\n    }\n    return res;\n}\nint calc_mfirst(char s[]){\n    int res = 0;\n    int tmp = s[0] - '0';\n    for(int i=1;s[i]!='\\0';i+=2){\n        if(s[i]=='+'){\n            res += tmp;\n            tmp = s[i+1] - '0';\n        }else{\n            tmp *= s[i+1] - '0';\n        }\n    }\n    return res + tmp;\n}\n \nint main(){\n    scanf(\"%s\", s);\n    scanf(\"%d\", &result);\n    int ltor = calc_ltor(s);\n    int mfirst = calc_mfirst(s);\n    //printf(\"%d %d\\n\", ltor, mfirst);\n    if(ltor == result && mfirst == result){\n        puts(\"U\");\n    }else if(ltor == result){\n        puts(\"L\");\n    }else if(mfirst == result){\n        puts(\"M\");\n    }else{\n        puts(\"I\");\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iomanip>\n#include<limits>\n#include<thread>\n#include<utility>\n#include<iostream>\n#include<string>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<vector>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<numeric>\n#include<cassert>\n#include<random>\n#include<chrono>\n#include<unordered_set>\n#include<unordered_map>\n#include<fstream>\n#include<list>\n#include<functional>\n#include<bitset>\n#include<complex>\n#include<tuple>\nusing namespace std;\ntypedef unsigned long long int ull;\ntypedef long long int ll;\ntypedef pair<ll,ll> pll;\ntypedef pair<int,int> pi;\ntypedef pair<double,double> pd;\ntypedef pair<double,ll> pdl;\n#define F first\n#define S second\nconst ll E=1e18+7;\nconst ll MOD=1000000007;\n\n\n\n\nint main(){\n    string s;\n    cin>>s;\n    ll a;\n    cin>>a;\n    stack<ll> S;\n    S.push(s[0]-'0');\n    for(int i=1;i<s.size();i+=2){\n        if(s[i]=='+'){\n            S.push(s[i+1]-'0');\n        }\n        else{\n            ll k=S.top(); S.pop();\n            S.push(k*(s[i+1]-'0'));\n        }\n    }\n    ll cul1=0;\n    while(!S.empty()){cul1+=S.top(); S.pop();}\n    ll cul2=s[0]-'0';\n    for(int i=1;i<s.size();i+=2){\n        if(s[i]=='+'){cul2+=s[i+1]-'0';}\n        else{cul2*=s[i+1]-'0';}\n    }\n    if(cul1==cul2){\n        cout<<(a==cul1?\"U\":\"I\")<<endl;\n    }\n    else{\n        cout<<(a==cul1?\"M\":(a==cul2?\"L\":\"I\"))<<endl;\n    }\n    \n    \n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n// #include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr, __VA_ARGS__)\n//#define LOG(...)\n#define FOR(i, a, b) for(int i=(int)(a); i<(int)(b); ++i)\n#define REP(i, n) for(int i=0; i<(int)(n); ++i)\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EXIST(s, e) ((s).find(e)!=(s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n#define SQ(n) (n) * (n)\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nint main() {\n  string input;\n  int R;\n  cin >> input >> R;\n  vi num;\n  REP(i, input.length()){\n    switch(input[i]) {\n    case '+':\n      num.push_back(-1);\n      break;\n    case '*':\n      num.push_back(-2);\n      break;\n    default:\n      num.push_back(input[i] - '0');\n      break;\n    }\n  }\n\n  int M = num[0];\n  for(int i = 1; i < num.size(); i+=2) {\n    if(num[i] == -1) {\n      M += num[i + 1];\n    }else {\n      M *= num[i + 1];\n    }\n  }\n\n  for(int i = 1; i < num.size(); i+=2) {\n    if(num[i] == -2) {\n      num[i + 1] = num[i - 1] * num[i + 1];\n      num[i - 1] = 0;\n      num[i] = -1;\n    }\n  }\n\n  int L = num[0];\n  for(int i = 1; i < num.size(); i+=2) {\n    if(num[i] == -1) {\n      L += num[i + 1];\n    }else {\n      L *= num[i + 1];\n    }\n  }\n\n  if(M == R && L == R) {\n    cout << 'U' << endl;\n  }else if(M==R) {\n    cout << 'L' << endl;\n  }else if(L==R) {\n    cout << 'M' << endl;\n  }else{\n    cout << 'I' << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <numeric>\n#include <string>\n#include <utility>\n#include <vector>\n\nusing namespace std;\n\nint main()\n{\n    string s;\n    cin >> s;\n    int n;\n    cin >> n;\n\n    auto multiplicationFirst = [](const string& s) {\n        // value or operator\n        enum class T { V, O };\n        vector<pair<T, int>> v;\n        for (char i : s) {\n            if (i == '*' || i == '+') {\n                v.emplace_back(T::O, i);\n            }\n            else {\n                v.emplace_back(T::V, i - '0');\n            }\n        }\n        while (true) {\n            if (find(begin(v), end(v),\n                     make_pair(T::O, static_cast<int>('*'))) == end(v)) {\n                break;\n            }\n            vector<pair<T, int>> t;\n            for (size_t i = 0; i < v.size(); ++i) {\n                if (v[i] != make_pair(T::O, static_cast<int>('*'))) {\n                    t.push_back(v[i]);\n                }\n                else {\n                    t.pop_back();\n                    t.emplace_back(T ::V, v[i - 1].second * v[i + 1].second);\n                    copy(begin(v) + i + 2, end(v), back_inserter(t));\n                    break;\n                }\n            }\n            v = t;\n        }\n        return accumulate(begin(v), end(v), 0,\n                          [](int a, const pair<T, int>& b) {\n                              if (b.first == T::O) {\n                                  return a;\n                              }\n                              else {\n                                  return a + b.second;\n                              }\n                          });\n    };\n    auto leftToRight = [](const string& s) {\n        int accumulator = s[0] - '0';\n        for (size_t i = 1; i < s.size() - 1; i += 2) {\n            if (s[i] == '+') {\n                accumulator += s[i + 1] - '0';\n            }\n            else {\n                accumulator *= s[i + 1] - '0';\n            }\n        }\n        return accumulator;\n    };\n    auto mf = multiplicationFirst(s);\n    auto lr = leftToRight(s);\n    if (mf == n && lr == n) {\n        cout << 'U' << endl;\n    }\n    else if (mf == n) {\n        cout << 'M' << endl;\n    }\n    else if (lr == n) {\n        cout << 'L' << endl;\n    }\n    else {\n        cout << 'I' << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <cstring>\n#include <vector>\n#include <algorithm>\n#include <tuple>\n#include <queue>\n#include <set>\n#include <cstdio>\n#include <climits>\n#include <cmath>\n#include <array>\n#include <functional>\n#include <sstream>\n#include <list>\n#include <set>\nconst int MOD=1000000007;\nconst int INF=1000000000;\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\nconst double eps=1e-9;\nconst int inf=1e9;\ntypedef pair<int,int> P;\nint buckets[256];\ntypedef string::const_iterator State;\nint number(State &begin)\n{\n  int ret=*begin-'0';\n  begin++;\n  return ret;\n}\n\nint term(State &begin)\n{\n  int ret=number(begin);\n  while(true)\n    {\n      if(*begin == '*')\n\t{\n\t  begin++;\n\t  ret*=number(begin);\n\t}\n      else\n\t{\n\t  break;\n\t}\n    }\n  return ret;\n}\n\nint expression(State &begin)\n{\n  int ret=term(begin);\n  while(true)\n    {\n      if(*begin =='+')\n\t{\n\t  begin++;\n\t  ret+=term(begin);\n\t}\n      else\n\t{\n\t  break;\n\t}\n    }\n  return ret;\n}\n\nint rule2(string s)\n{\n  State begin=s.begin();\n  int ret=*begin-'0';\n  begin++;\n  while(begin!=s.end())\n    {\n      if(*begin=='+')\n\t{\n\t  begin++;\n\t  ret+=*begin-'0';\n\t}\n      else\n\t{\n\t  begin++;\n\t  ret*=*begin-'0';\n\t}\n      begin++;\n    }\n  return ret;\n}\nint main(int argc,char const* argv[])\n{\n  string s;\n  int n;\n  int ans1,ans2;\n  cin >> s;\n  cin >> n;\n  State begin=s.begin();\n  ans1=expression(begin);\n  ans2=rule2(s);\n  if(ans1==ans2 && ans1==n)\n    {\n      cout << 'U' << endl;\n    }\n  else if(ans1==n)\n    {\n      cout << 'M' << endl;\n    }\n  else if(ans2==n)\n    {\n      cout << 'L' << endl;\n    }\n  else\n    {\n      cout << 'I' << endl;\n    }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main(){\n\tstring str;\n\tint n;\n\tcin >> str >> n;\n\tchar x = 'x';\n\tint f = 0, s = 0;\n\tint num[20];\n\tbool used[20];\n\tfor(int i = 0; i < 20; i++) used[i] = false;\n\tchar ope[20];\n\tfor(int i = 0; i < str.size(); i++){\n\t\tif(i%2 == 0){\n\t\t\tnum[i/2] = str[i]-'0';\n\t\t} else{\n\t\t\tope[i/2] = str[i];\n\t\t}\n\t}\n\tint t = -1;\n\tfor(int i = 0; i < str.size()/2; i++){\n\t\tif(ope[i] == '*'){\n\t\t\tif(t == -1){\n\t\t\t\tt = num[i]*num[i+1];\n\t\t\t\tused[i] = true;\n\t\t\t\tused[i+1] = true;\n\t\t\t} else{\n\t\t\t\tt *= num[i+1];\n\t\t\t\tused[i+1] = true;\n\t\t\t}\n\t\t} else{\n\t\t\tif(t != -1) f += t;\n\t\t\tt = -1;\n\t\t}\n\t}\n\tif(t > 0) f += t;\n\tfor(int i = 0; i < (str.size()+1)/2; i++){\n\t\tif(!used[i]) f += num[i];\n\t}\n\tfor(int i = 0; i < str.size(); i++){\n\t\tif(i%2 == 0){\n\t\t\tif(x == 'x') s = str[i]-'0';\n\t\t\tif(x == '+') s += str[i]-'0';\n\t\t\tif(x == '*') s *= str[i]-'0';\n\t\t} else{\n\t\t\tx = str[i];\n\t\t}\n\t}\n\tif(s == n){\n\t\tif(f == n) cout << \"U\" << endl;\n\t\telse cout << \"L\" << endl;\n\t} else{\n\t\tif(f == n) cout << \"M\" << endl;\n\t\telse cout << \"I\" << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stack>\n#include<string>\nusing namespace std;\n\nchar dealing(string str,int test)\n{\n\tint len = str.length();\n\tstack<int> num;\n\tstack<char> yun;\n\tfor(int i=len-1;i>=0;--i)\n\t{\n\t\tif(str[i]>='0'&&str[i]<='9')\n\t\t{\n\t\t\tint j = i;\n\t\t\tint sum = 0;\n\t\t\tint by = 1;\n\t\t\twhile(j>=0)\n\t\t\t{\n\t\t\t\tif(str[j]>='0'&&str[j]<='9')\n\t\t\t\t{\n\t\t\t\t\tsum+=by*(str[j]-'0');\n\t\t\t\t\tby*=10;\n\t\t\t\t\tj--;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\ti =j+1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tnum.push(sum);\n\t\t\tif(j<0)\n\t\t\tbreak;\n\t\t}\n\t\telse\n\t\t\tyun.push(str[i]);\n\t\t\n\t}\n\t\n\tint result_left_to_right =0;\n\tint result_normal = 0;\n\t\n\t\tstack<int> num_copy(num);\n\tstack<char> yun_copy(yun);\n\t\n\tint num_len = num.size();\n\tresult_left_to_right  = num.top();\n\tnum.pop();\n\t\n\n\t\n\t\n\tfor(int i=1;i<num_len;++i)\n\t{\n\t\tchar cc = yun.top();\n\t\tyun.pop();\n\t\tint num1 = num.top();\n\t\tnum.pop();\n\t\tif(cc=='+')\n\t\tresult_left_to_right +=num1;\n\t\telse\n\t\tresult_left_to_right *=num1;\n\t}\n\t\n\t//cout<<result_left_to_right <<endl;\n\t\n\tstack<int> result_nor;\n\t\n\tint q= num_copy.top();\n\tnum_copy.pop();\n\t\n\tfor(int i=1;i<num_len;++i)\n\t{\n\t\tchar cc;\n\t\tcc = yun_copy.top();\n\t\tyun_copy.pop();\n\t\t\n\t\tint num1 = num_copy.top();\n\t\tnum_copy.pop();\n\t\t\n\t\t\n\t\tif(cc=='*')\n\t\tq = q*num1;\n\t\telse\n\t\t{\n\t\t\tresult_nor.push(q);\n\t\t\tq = num1;\n\t\t}\n\t\t\n\t}\n\tresult_nor.push(q);\n\tint sizes = result_nor.size();\n\tfor(int i=0;i<sizes;++i){\n\t\tresult_normal+=result_nor.top();\n\t\tresult_nor.pop();\n\t}\n\t\n//cout<<\"test\"<<result_normal<<endl;\n\t\n\t\n\tif(test==result_left_to_right&&test!=result_normal)\n\t\treturn 'L';\n\tif(test!=result_left_to_right&&test==result_normal)\n\treturn 'M';\n\tif(test==result_left_to_right&&test==result_normal)\n\treturn 'U';\n\tif(test!=result_left_to_right&&test!=result_normal)\n\treturn 'I';\n\treturn 'I';\n}\n\nint main()\n{\n\tstring str;\n\tint num;\n\tcin>>str;\n\tcin>>num;\n\tcout<<dealing(str,num)<<endl;\n\t\n\treturn 0;\n\t\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <algorithm>\n#include <stdio.h>\n#include <stdlib.h>\n#include <math.h>\n\nusing namespace std;\n\n/*\n\t計算ミス\n\n\tボブは小学校の児童で、算数があまり得意でない。彼は父親の電卓を見つけ、\n\tそれを使って宿題でズルをしようとした。彼の宿題は掛け算と足し算を含む\n\t数式を計算することである。もちろん、掛け算は足し算の前に行わなければならないが、\n\t計算機は式を左から右に計算し、演算子の優先順位を無視する。\n\tそのため彼の答えは次の二つの計算規則のいずれかの結果となりうる。\n\n\t\t足し算の前に掛け算を行う\n\t\t演算子の優先順位を無視して左から右に計算を行う\n\n\t彼の答えと数式から、どちらの規則が適用されたを出力するプログラムを書け。\n\n\t数式は整数と演算子からなる。全ての整数は一桁、すなわち0から9である。\n\t演算子は+と*の二種類であり、それぞれ足し算と掛け算を示す。\n\t以下は数式の例である。\n\t\t\n\t\t1+2*3+4\n\t\n\tこの数式を、掛け算を最初に計算する規則によって計算すると、入力例１のように、答えは11になる。\n\tしかし、左から右に計算する規則によると、答えは入力例２で示されるように、答えは13になるだろう。\n\n\tどちらの規則で計算しても同じ結果になる場合もありえ、その場合には\n\tどちらの規則が適用されたか判別できない。加えて、ボブはたまに計算ミスをする。\n\tいずれの規則でもボブの答えにならない場合、彼が本当に宿題をしたのは明らかである。\n\n\t入力\n\t入力は二行のテストケースからなる。最初の一行には計算する数式が含まれる。\n\t数式の文字数は常に奇数であり、17以下である。数式中の奇数番目の文字は0から9までの数字である。\n\t偶数番目の文字は+か*の演算子である。二行目には0から999999999までの整数が含まれる。\n\tこの整数は最初の行で与えられた数式に対するボブの答えである。\n\n\t出力\n\t以下の４つの文字のうち１つを出力せよ。\n\tM　掛け算を先に行う規則のみの計算結果がボブの答えになる場合\n\tL　左から右に行う規則のみの計算結果がボブの答えになる場合\n\tU　両方の規則の計算結果がボブの答えになる場合\n\tI　いずれの規則の計算結果もボブの答えにならない場合\n\n*/\n\n\nint main(void){\n\t//FILE* fp_in = freopen(\"data.txt\", \"r\", stdin);\n\t\n\tvector< int > num;\n\tstring str;\n\tint ans;\n\tgetline(cin, str);\n\tcin >> ans;\n\tint r[2] = {0, 0};\n\n\t// multiplication-first rule\n\tint tmp = -1;\n\tfor(int i = 0; str.length() > 1 && i < str.length() - 2; i += 2) {\n\t\tif( str[i + 1] == '+' ) {\n\t\t\tif( tmp == -1 ) tmp = str[i] - '0';\n\t\t\telse tmp *= ( str[i] - '0' );\n\t\t\tnum.push_back( tmp );\n\t\t\ttmp = -1;\n\t\t} else {\n\t\t\tif( tmp == -1 ) tmp = str[i] - '0';\n\t\t\telse tmp *= ( str[i] - '0' );\n\t\t}\n\t}\n\n\tif( tmp == -1 ) {\n\t\tnum.push_back( str[ str.length() - 1 ] - '0' );\n\t} else {\n\t\tnum.push_back( ( str[ str.length() - 1 ] - '0' ) * tmp );\n\t}\n\n\t//left-to-right rule\n\tr[1] = str[0] - '0';\n\tfor(int i = 2; i < str.length(); i += 2) {\n\t\tif( str[i-1] == '+' ) {\n\t\t\tr[1] += str[i] - '0';\n\t\t} else {\n\t\t\tr[1] *= str[i] - '0';\n\t\t}\n\t}\n\n\tfor(int i = 0; i < num.size(); i++)\n\t\tr[0] += num[i];\n\n\tif( ans == r[0] && ans == r[1] ) {\n\t\tcout << \"U\" << endl;\n\t} else if( ans == r[0] && ans != r[1] ) {\n\t\tcout << \"M\" << endl;\n\t} else if( ans != r[0] && ans == r[1] ) {\n\t\tcout << \"L\" << endl;\n\t} else if( ans != r[0] && ans != r[1] ) {\n\t\tcout << \"I\" << endl;\n\t}\n\n\t//while(1){}\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<vector>\n#include<iostream>\n#include<algorithm>\n#include<string>\n\nusing namespace std;\n\n#define reps(i,f,n) for(int i=f;i<int(n);i++)\n#define rep(i,n) reps(i,0,n)\n\n\nclass C{\n\tpublic:\n\tvector<int> num;\n\tvector<char> calc;\n\t\n\tbool emp(){\n\t\tbool nu = false;\n\t\trep(i,calc.size())if(calc[i]=='*')nu=true;\n\t\treturn !nu;\n\t}\n\t\n\tvoid docalc(int i)\n\t{\n\t\tif(calc[i]=='+'){\n\t\t\tnum [i] = num[i]+num[i+1];\n\t\t}else{\n\t\t\tnum[i] = num[i]*num[i+1];\t\t\t\n\t\t}\n\t\t\n\t\tnum.erase(num.begin()+i+1);\n\t\tcalc.erase(calc.begin()+i);\n\t}\n};\n\n\nint calc2(C c){\n\twhile(c.calc.size()!=0){\n\t\t\n\t\tc.docalc(0);\n\t}\n\treturn c.num[0];\n}\nint calc1(C c){\n\twhile(!c.emp()){\n\t\t\n\t\trep(i,c.calc.size()){\n\t\t\tif(c.calc[i]=='*'){\n\t\t\t\tc.docalc(i);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn calc2(c);\n}\n\nint main(){\n\tstring s;\n\tint n;\n\t\n\tcin>>s>>n;\n\t\n\tC c;\n\trep(i,s.size()){\n\t\tif(i%2==0){\n\t\t\tc.num.push_back(s[i]-'0');\n\t\t}else{\n\t\t\tc.calc.push_back(s[i]);\n\t\t}\n\t}\n\t\n\t\n\tint n1 = calc1(c);\n\tint n2 = calc2(c);\n\t\n\tchar ans = '*';\n\tif(n1==n && n2==n) ans = 'U';\n\tif(!(n1==n) && !(n2==n)) ans = 'I';\n\tif(n1==n && !(n2==n)) ans = 'M';\n\tif(!(n1==n) && n2==n) ans = 'L';\n\t\n\tprintf(\"%c\\n\",ans);\n}"
  },
  {
    "language": "C++",
    "code": "//include\n//------------------------------------------\n#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <fstream>\n#include <complex>\n#include <math.h>\n\nusing namespace std;\n\n//conversion\n//------------------------------------------\ninline long toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ninline long toLong(string s) {long v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\n\n//math\n//-------------------------------------------\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\n//typedef\n//------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef pair<long, long> PLL;\ntypedef long long LL;\n//container util\n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define EACH(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n\n//repetition\n//------------------------------------------\n#define FOR(i,a,b) for(long i=(a);i<(b);++i)\n#define REP(i,n) FOR(i,0,n)\n\n//constant\n//--------------------------------------------\n\n//clear memory\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\nconst long double EPS = 1e-8;\nconst long INF = 1e10;\n\nint main(){\n\tlong N;string str;\n\tcin>>str>>N;\n\tint bpos=0;\n\tvector<int>num;\n\tvector<char>kigo;\n\tREP(i,SZ(str)){\n\t\tif(str[i]=='+'||str[i]=='*'){\n\t\t\tkigo.PB(str[i]);\n\t\t\tnum.PB(toInt(str.substr(bpos,i-bpos+1)));\n\t\t\tbpos=i+1;\n\t\t}else if(i==SZ(str)-1){\n\t\t\tnum.PB(toInt(str.substr(bpos)));\n\t\t}\n\t}\n\tlong L=num[0];\n\tFOR(i,1,SZ(num)){\n\t\tif(kigo[i-1]=='+')L+=num[i];\n\t\telse L*=num[i];\n\t}\n\tstack<long>st;\n\tst.push(num[0]);\n\tFOR(i,1,SZ(num)){\n\t\tif(kigo[i-1]=='+')st.push(num[i]);\n\t\telse{\n\t\t\tlong t=st.top();st.pop();\n\t\t\tst.push(t*num[i]);\n\t\t}\n\t}\n\tlong M=0;\n\twhile(!st.empty()){\n\t\tM+=st.top();st.pop();\n\t}\n\t//cout<<L<<\" \"<<M<<endl;\n\tif(N==L&&N==M){\n\t\tcout<<\"U\"<<endl;\n\t}else if(N==L){\n\t\tcout<<\"L\"<<endl;\n\t}else if(N==M){\n\t\tcout<<\"M\"<<endl;\n\t}else{\n\t\tcout<<\"I\"<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "/* attention to typo and overflow */\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <queue>\n#include <iostream>\n#include <cmath>\n#include <cstdio>\n\nusing namespace std;\nconst int INF=1<<25;\nvoid io(){ cin.tie(0);ios::sync_with_stdio(false);} //attention to use of endl\n/*printf(\"%.9Lf\\n\",cf);*/\nchar output(bool i,bool j){\n\tif(i==1 && j==0){\n\t\treturn 'M';\n\t}\n\tif(i==0 && j==1){\n\t\treturn 'L';\n\t}\n\tif(i==0 && j==0){\n\t\treturn 'I';\n\t}\n\tif(i==1 && j==1){\n\t\treturn 'U';\n\t}\n\treturn 'N';\n}\n\nint main(){\n\tio();\n\tstring s;\n\tgetline(cin,s);\n\t//cin.ignore();\n\tint ans;\n\tcin>>ans;\n\n\tvector <int> plus;\n\tfor(int i=0;i<s.size();i++){\n\t\tif(i%2==0){\n\t\t\tif(i!=0 && s[i-1]=='*'){\n\t\t\t\tplus[plus.size()-1]*=s[i]-'0';\n\t\t\t}else{\n\t\t\t\tplus.push_back(s[i]-'0');\n\t\t\t}\n\t\t}\n\t}\n\n\tint one=0;\n\tfor(int i=0;i<plus.size();i++){\n\t\t//cerr<<plus[i]<<endl;\n\t\tone+=plus[i];\n\t}\n\n\tint two=s[0]-'0';\n\tfor(int i=1;i<s.size();i++){\n\t\tif(i%2==0){\n\t\t\tif(s[i-1]=='+'){\n\t\t\t\ttwo+=s[i]-'0';\n\t\t\t}else{\n\t\t\t\ttwo*=s[i]-'0';\n\t\t\t}\n\t\t}\n\t}\n\n\tcerr<<ans<<' '<<one<<' '<<two<<endl;\n\n\tcout<<output(ans==one,ans==two)<<endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n#define MAX 25\n\nchar ch[MAX], op1[MAX], op2[MAX];\nint len, cnt, ont;\nint n1[MAX], n2[MAX];\n\nint go1(void){\n\tint i, j;\n\tint c=cnt, o=ont;\n\tfor (i=1;i<=o;i++){\n\t\tif (op1[i]=='*'){\n\t\t\tn1[i]*=n1[i+1];\n\t\t\tfor (j=i+1;j<=c;j++){\n\t\t\t\tn1[j]=n1[j+1];\n\t\t\t}\n\t\t\tc--;\n\t\t\tfor (j=i;j<=o;j++){\n\t\t\t\top1[j]=op1[j+1];\n\t\t\t}\n\t\t\to--;\n\t\t\ti--;\n\t\t}\n\t}\n\tfor (i=1;i<=o;i++){\n\t\tif (op1[i]=='+'){\n\t\t\tn1[i]+=n1[i+1];\n\t\t\tfor (j=i+1;j<=c;j++){\n\t\t\t\tn1[j]=n1[j+1];\n\t\t\t}\n\t\t\tc--;\n\t\t\tfor (j=i;j<=o;j++){\n\t\t\t\top1[j]=op1[j+1];\n\t\t\t}\n\t\t\to--;\n\t\t\ti--;\n\t\t}\n\t}\n\treturn n1[1];\n}\n\nint go2(void){\n\tint i, j;\n\tint o=ont, c=cnt;\n\tfor (i=1;i<=o;i++){\n\t\tif (op2[i]=='+'){\n\t\t\tn2[i]+=n2[i+1];\n\t\t}else if (op2[i]=='*'){\n\t\t\tn2[i]*=n2[i+1];\n\t\t}\n\t\tfor (j=i+1;j<=c;j++){\n\t\t\tn2[j]=n2[j+1];\n\t\t}\n\t\tc--;\n\t\tfor (j=i;j<=o;j++){\n\t\t\top2[j]=op2[j+1];\n\t\t}\n\t\to--;\n\t\ti--;\n\t}\n\treturn n2[1];\n}\n\nint main(void){\n\tint i;\n\tscanf(\"%s\", &ch[1]);\n\tlen=strlen(&ch[1]);\n\tfor (i=1;i<=len;i+=2){\n\t\tn1[++cnt]=ch[i]-'0';\n\t\tn2[cnt]=n1[cnt];\n\t}\n\tfor (i=2;i<=len;i+=2){\n\t\top1[++ont]=ch[i];\n\t\top2[ont]=op1[ont];\n\t}\n\tint r1, r2;\n\tr1=go1();\n\tr2=go2();\n\n\tint n;\n\tscanf(\"%d\", &n);\n\tif (r1==n && r2==n) printf(\"U\\n\");\n\telse if (r1==n) printf(\"M\\n\");\n\telse if (r2==n) printf(\"L\\n\");\n\telse printf(\"I\\n\");\n\treturn false;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <functional>\n#include <numeric>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <utility>\n#include <sstream>\n#include <complex>\n#include <fstream>\n#include <bitset>\n#include <time.h>\n#include <tuple>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<ll, ll> P;\ntypedef vector<ll> V;\ntypedef complex<double> Point;\n\n#define PI acos(-1.0)\n#define EPS 1e-10\nconst ll INF = 1e12;\nconst ll MOD = 1e9 + 7;\n\n#define FOR(i,a,b) for(ll i=(a);i<(b);i++)\n#define rep(i,N) for(ll i=0;i<(N);i++)\n#define ALL(s) (s).begin(),(s).end()\n#define EQ(a,b) (abs((a)-(b))<EPS)\n#define EQV(a,b) ( EQ((a).real(), (b).real()) && EQ((a).imag(), (b).imag()) )\n#define fi first\n#define se second\n#define N_SIZE (1LL << 20)\n#define NIL -1\n#define MAX_N 100100\n\nll sq(ll num) { return num*num; }\nll mod_pow(ll x, ll n) {\n\tif (n == 0)return 1;\n\tif (n == 1)return x%MOD;\n\tll res = sq(mod_pow(x, n / 2));\n\tres %= MOD;\n\tif (n % 2 == 1) {\n\t\tres *= x;\n\t\tres %= MOD;\n\t}\n\treturn res;\n}\nll mod_add(ll a, ll b) { return (a + b) % MOD; }\nll mod_sub(ll a, ll b) { return (a - b + MOD) % MOD; }\nll mod_mul(ll a, ll b) { return a*b % MOD; }\n\nstring s;\nint num;\n\nll number(string& s, ll& i);\nll term(string& s, ll& i);\nll factor(string& s, ll& i);\nll expr(string& s, ll& i);\n\nll number(string& s, ll& i) {\n\tll n = s[i++] - '0';\n\twhile (isdigit(s[i])) n = n * 10 + s[i++] - '0';\n\treturn n;\n}\n\nll factor(string& s, ll& i) {\n\tif (isdigit(s[i])) return number(s, i);\n\ti++;\n\tll ret = expr(s, i);\n\ti++;\n\treturn ret;\n}\n\nll term(string& s, ll& i) {\n\tll val = factor(s, i);\n\twhile (s[i] == '*' || s[i] == '/') {\n\t\tchar op = s[i];\n\t\ti++;\n\t\tint val2 = factor(s, i);\n\t\tif (op == '*') val *= val2;\n\t\telse val /= val2;\n\t}\n\treturn val;\n}\n\nll expr(string& s, ll& i) {\n\tll val = term(s, i);\n\twhile (s[i] == '+' || s[i] == '-') {\n\t\tchar op = s[i];\n\t\ti++;\n\t\tint val2 = term(s, i);\n\t\tif (op == '+') val += val2;\n\t\telse val -= val2;\n\t}\n\treturn val;\n}\n\nint main() {\n\tcin >> s >> num;\n\tll pos = 0;\n\tll m = expr(s, pos);\n\tll l = s[0] - '0';\n\tfor (int i = 1; i < s.size(); i += 2) {\n\t\tif (s[i] == '+')l += s[i + 1] - '0';\n\t\telse l *= s[i + 1] - '0';\n\t}\n\tif (m == num) {\n\t\tif (l == num)cout << \"U\" << endl;\n\t\telse cout << \"M\" << endl;\n\t}\n\telse if (l == num)cout << \"L\" << endl;\n\telse cout << \"I\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <stack>\nusing namespace std;\n\nint main(void) {\n\n  string exp; cin >> exp;\n  int ans; cin >> ans;\n\n  stack<int> nums;\n  for (unsigned int i = 0; i < exp.size(); i++) {\n    if (exp[i] == '*') {\n      int v1 = nums.top(); nums.pop();\n      int v2 = exp[++i] - '0';\n      nums.push(v1*v2);\n    } else if (exp[i] == '+') {\n      continue;\n    } else {\n      nums.push(exp[i] - '0');\n    }\n  }\n  int a1 = 0;\n  while (!nums.empty()) {\n    a1 += nums.top(); nums.pop();\n  }\n\n  int a2 = exp[0] - '0';\n  for (unsigned int i = 1; i < exp.size(); i++) {\n    if (exp[i] == '+') {\n      a2 += exp[i+1] - '0';\n    } else if (exp[i] == '*') {\n      a2 *= exp[i+1] - '0';\n    }\n  }\n\n  if (a1 == ans) {\n    if (a2 == ans) {\n      cout << \"U\" << endl;\n    } else {\n      cout << \"M\";\n    }\n  } else if (a2 == ans) {\n    cout << \"L\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint f(string s) {\n\tvector<int> a;\n\ta.push_back(s[0] - '0');\n\tfor (int i = 2; i < s.length(); i += 2) {\n\t\tif (s[i-1] == '+') {\n\t\t\ta.push_back(s[i] - '0');\n\t\t} else {\n\t\t\ta.back() *= s[i] - '0';\n\t\t}\n\t}\n\tint r = 0;\n\tfor (int i = 0; i < a.size(); ++ i) r += a[i];\n\treturn r;\n}\nint g(string s) {\n\tint r = s[0] - '0';\n\tfor (int i = 2; i < s.length(); i += 2) {\n\t\tif (s[i-1] == '+') {\n\t\t\tr += s[i] - '0';\n\t\t} else {\n\t\t\tr *= s[i] - '0';\n\t\t}\n\t}\n\treturn r;\n}\nint main() {\n\tstring s;\n\tint n;\n\tcin >> s >> n;\n\tint r = 0;\n\tif (f(s) == n) r += 1;\n\tif (g(s) == n) r += 2;\n\tcout << \"IMLU\"[r] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stack>\n#include<cstdlib>\nusing namespace std;\n\nint main()\n{\n  string cal;\n  int n,M=0,L=0;\n  long long l=0,m=0,top;\n  stack<int> S;\n  cin>>cal>>n;\n  S.push((cal[0]-'0'));\n  for(int i=1;i<cal.length()-1;i+=2){\n    if(cal[i]=='+'){\n      S.push((cal[i+1]-'0'));\n    }\n    if(cal[i]=='*'){\n      top=S.top();S.pop();\n      S.push(top*(cal[i+1]-'0'));\n    }\n  }\n  while(!S.empty()){\n    m+=S.top();\n    S.pop();\n  }\n  if(m==n)M=1;\n  l=(cal[0]-'0');\n  for(int i=1;i<cal.length();i+=2){\n    if(cal[i]=='+'){\n      l+=(cal[i+1]-'0');\n    }\n    if(cal[i]=='*'){\n      l*=(cal[i+1]-'0');\n    }\n  }\n  if(l==n)L=1;\n  if(L==1 && M==1)cout<<\"U\"<<endl;\n  else if(L==0 && M==1)cout<<\"M\"<<endl;\n  else if(L==1 && M==0)cout<<\"L\"<<endl;\n  else cout<<\"I\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <iostream>\n#include <math.h>\n#include <assert.h>\n#include <vector>\n#include <queue>\n#include <string>\n#include <map>\n#include <set>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\nstatic const double EPS = 1e-9;\nstatic const double PI = acos(-1.0);\n\n#define REP(i, n) for (int i = 0; i < (int)(n); i++)\n#define FOR(i, s, n) for (int i = (s); i < (int)(n); i++)\n#define FOREQ(i, s, n) for (int i = (s); i <= (int)(n); i++)\n#define FORIT(it, c) for (__typeof((c).begin())it = (c).begin(); it != (c).end(); it++)\n#define MEMSET(v, h) memset((v), h, sizeof(v))\n\nchar str[100];\n\nint calc(int lhs, char c, int rhs) {\n  if (c == '+') { return lhs + rhs; }\n  return lhs * rhs;\n}\nchar *skip(char *p) {\n  while (isdigit(*p)) { p++; }\n  return p;\n}\n\nint calc1() {\n  char *p = str;\n  int lhs = atoi(p);\n  p = skip(p);\n  while (*p != 0) {\n    char c = *p;\n    p++;\n    assert(p - str < 20);\n    int rhs = atoi(p);\n    lhs = calc(lhs, c, rhs);\n    p = skip(p);\n  }\n  return lhs;\n}\n\nint calc2() {\n  char *p = str;\n  vector<int> vs;\n  int lhs = atoi(p);\n  p = skip(p);\n  while (*p != 0) {\n    char c = *p;\n    p++;\n    if (c == '+') { \n      vs.push_back(lhs);\n      lhs = atoi(p);\n      assert(lhs != 0);\n    } else {\n      assert(lhs != 0);\n      int rhs = atoi(p);\n      lhs *= rhs;\n    }\n    p = skip(p);\n  }\n  FORIT(it, vs) { lhs += *it; }\n  return lhs;\n}\n\nint main() {\n  int ans;\n  while (scanf(\"%s %d\", str, &ans) > 0) {\n    int v1 = calc1();\n    int v2 = calc2();\n    if (ans == v1 && ans == v2) {\n      puts(\"U\");\n    } else if (ans == v1) {\n      puts(\"L\");\n    } else if (ans == v2) {\n      puts(\"M\");\n    } else {\n      puts(\"I\");\n    }\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <stack>\n#include <algorithm>\nusing namespace std;\n\nint char_to_int(char c) {\n    return static_cast<int>(c -'0');\n}\n\nint m_rule(string expr) {\n    stack<int> s;\n    for(int i=0; i<expr.size(); ++i) {\n        if(expr[i] == '*') {\n            int l = s.top();\n            s.pop();\n            s.push(l * char_to_int(expr[i+1]));\n            i++;\n        } else if('0' <= expr[i] && expr[i] <= '9') {\n            s.push(char_to_int(expr[i]));\n        }\n    }\n    int ret = 0;\n    while(!s.empty()) {\n        ret += s.top();\n        s.pop();\n    }\n    return ret;\n}\n\nint l_rule(string expr) {\n    int ret = 0;\n    for(int i=0; i<expr.size(); ++i) {\n        if(expr[i] == '*') {\n            ret *= char_to_int(expr[i+1]);\n            i++;\n        } else if(expr[i] == '+') {\n            ret += char_to_int(expr[i+1]);\n            i++;\n        } else {\n            ret = char_to_int(expr[i]);\n        }\n    }\n    return ret;\n}\n\nint main() {\n    string expr;\n    int ans;\n    cin >> expr >> ans;\n\n    int m = m_rule(expr);\n    int l = l_rule(expr);\n    if(m == ans && l == ans) {\n        cout << \"U\" << endl;\n    } else if(m == ans) {\n        cout << \"M\" << endl;\n    } else if(l == ans) {\n        cout << \"L\" << endl;\n    } else {\n        cout << \"I\" << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing vi=vector<int>;\n#define all(a) a.begin(),a.end()\n\nint main(){\n\tint l=0,n=0,p;\n\tvector<int> a(1);\n\tstring s;\n\tcin>>s>>p;\n\t\n\tl=a[0]= s[0]-'0';\n\tfor(int i=2; i<s.size()/2 ;i+=2){\n\t\tint t=s[i]-'0';\n\t\tif(s[i-1]='*'){\n\t\t\tl*=t;\n\t\t\ta.back()*=t;\n\t\t}else{\n\t\t\tl+=t;\n\t\t\ta.push_back(t);\n\t\t}\n\t}\n\tn=accumulate(all(a),0);\n\tcout<<\"ILMU\"[l==p?1:0 + n==p?2:0]<<endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <iostream>\n#include <map>\n#include <cmath>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <stdlib.h>\n#include <stdio.h>\n#include <bitset>\n#include <cstring>\nusing namespace std;\n#define FOR(I,A,B) for(int I = (A); I < (B); ++I)\n#define CLR(mat) memset(mat, 0, sizeof(mat))\ntypedef long long ll;\nint main()\n{\n  string s; cin >> s;\n  bool used[s.length()]; CLR(used);\n  ll ans1 = 0;\n  ll cal = s[0] - '0';\n  // method 1\n  bool plus = false;\n  for(int i = 1; i < s.length(); i += 2) {\n    if(s[i] == '*') {\n      cal *= s[i+1] - '0';\n      used[i-1] = used[i+1] = true;\n      if(i == s.length() - 1) {\n        ans1 += cal;\n      }\n      plus = true;\n    } else if(plus){\n      ans1 += cal;\n      plus = false;\n    } else {\n      cal = s[i+1] - '0';\n    }\n  }\n  for(int i = 0; i < s.length(); i += 2) {\n    if(!used[i]) ans1 += s[i] - '0';\n  }\n  // method 2\n  ll ans2 = s[0] - '0';\n  for(int i = 1; i < s.length(); i += 2) {\n    if(s[i] == '*') {\n      ans2 *= s[i+1] - '0';\n    } else {\n      ans2 += s[i+1] - '0';\n    }\n  }\n  ll x; cin >> x;\n  if(ans1 == x && ans2 == x) {\n    puts(\"U\");\n  } else if(ans1 == x) {\n    puts(\"M\");\n  } else if(ans2 == x) {\n    puts(\"L\");\n  } else {\n    puts(\"I\");\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 29;\n\n\nstring S;\nsize_t cur;\n\nint digit(){\n\tint res=S[cur++]-'0';\n\treturn res;\n}\n\nint  number(){\n\tint res=digit();\n\twhile(isdigit(S[cur]))\n\t\tres=res*10+digit();\n\treturn res;\n}\n\nint left(){\n\tint res=number();\n\twhile(cur<S.size()){\n\t\tif(S[cur]=='+'){\n\t\t\tcur++;\n\t\t\tint next=number();\n\t\t\tres+=next;\n\t\t}else if(S[cur]=='*'){\n\t\t\tcur++;\n\t\t\tint next=number();\n\t\t\tres*=next;\n\t\t}\n\t}\n\treturn res;\n}\n\nint term(){\n\tint res=number();\n\twhile(cur<S.size()&&S[cur]=='*'){\n\t\tif(S[cur]=='*'){\n\t\t\tcur++;\n\t\t\tint next=number();\n\t\t\tres*=next;\n\t\t}\t\n\t}\n\treturn res;\n}\n\nint exp(){\n\tint res=term();\n\twhile(cur<S.size()&&S[cur]=='+'){\n\t\tif(S[cur]=='+'){\n\t\t\tcur++;\n\t\t\tint next=term();\n\t\t\tres+=next;\n\t\t}\t\n\t}\n\treturn res;\n}\n\nint main(void){\n\tcin >> S;\n\tint  n;\n\tcin >> n;\n\tcur=0;\n\tbool l=(n==left());\n\tcur=0;\n\tbool m=(n==exp());\n\tif(m&l)\n\t\tputs(\"U\");\n\telse if(m)\n\t\tputs(\"M\");\n\telse if(l)\n\t\tputs(\"L\");\n\telse\n\t\tputs(\"I\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <map>\n#include <vector>\n \nusing namespace std;\n \nstring s;\nint p;\nint T;\n \nint number()\n{\n    int res = s[p] - '0';\n    p++;\n    return res;\n}\n \nint formula()\n{\n    int res = number();\n    for (;;) {\n        if (s[p] == '*') {\n            p++;\n            res *= number();\n        } else {\n            break;\n        }\n    }\n    return res;\n}\n \nint expr()\n{\n    int res = formula();\n    for (;;) {\n        if (s[p] == '+') {\n            p++;\n            res += formula();\n        } else {\n            break;\n        }\n    }\n    return res;\n}\n \nint expr2()\n{\n    int res = number();\n    for (;;) {\n        if (s[p] == '+') {\n            p++;\n            res += number();\n        }\n        else if (s[p] == '*') {\n            p++;\n            res *= number();\n        }\n        else {\n            break;\n        }\n    }\n    return res;\n}\n \nint main()\n{\n    cin >> s >> T;\n \n    bool l1, l2;\n    p = 0;\n    l1 = expr() == T;\n    p = 0;\n    l2 = expr2() == T;\n \n    if (l1 && l2) cout << \"U\" << endl;\n    if (l1 && !l2) cout << \"M\" << endl;\n    if (!l1 && l2) cout << \"L\" << endl;\n    if (!l1 && !l2) cout << \"I\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cctype>\nusing namespace std;\n\ntypedef string::const_iterator State;\nclass ParseError{};\n\nint expr(State &begin);\nint term(State &begin);\nint number(State &begin);\n\nint expr(State &begin){\n    int ret = term(begin);\n\n    while(*begin == '+'){\n        begin++;\n        ret += term(begin);\n    }\n\n    return ret;\n}\n\nint term(State &begin){\n    int ret = number(begin);\n\n    while(*begin == '*'){\n        begin++;\n        ret *= number(begin);\n    }\n\n    return ret;\n}\n\nint number(State &begin){\n    int ret = *begin - '0';\n    begin++;\n    return ret;\n}\n\nint main(){\n    string s;\n    int n;\n\n    cin >> s >> n;\n    \n    State it = s.begin();\n    int evala = expr(it);\n\n    int evalb = s[0]-'0';\n    for(int i = 1; i < s.length(); i+=2){\n        int bin = s[i+1]-'0';\n        if(s[i] == '+') evalb += bin;\n        if(s[i] == '*') evalb *= bin;\n    }\n\n    bool x = (evala == n);\n    bool y = (evalb == n);\n\n    if(x&&y)    cout << \"U\" << endl;\n    else if(x)  cout << \"M\" << endl;\n    else if(y)  cout << \"L\" << endl;\n    else        cout << \"I\" << endl;\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <stack>\nusing namespace std;\n\nint multi_first(string s){\n  int l = (int)s.size(), ret = 0;\n  stack<int> st;\n  for(int i = 0; i < l; ++i){\n    if(s[i] == '+') continue;\n    else if(s[i] == '*'){\n      int t = st.top();\n      st.pop();\n      st.push(t*(s[i+1]-'0'));\n      ++i;\n    }else{\n      st.push(s[i]-'0');\n    }\n  }\n  while(!st.empty()){\n    ret += st.top();\n    st.pop();\n  }\n  //cout << \"multi_first = \" << ret << endl;\n  return ret;\n}\n\nint left_to_right(string s){\n  int l = (int)s.size(), ret = s[0]-'0';\n  for(int i = 1; i < l; ++i){\n    if(s[i] == '+'){\n      ret += s[i+1] - '0';\n      ++i;\n    }else if(s[i] == '*'){\n      ret *= s[i+1] - '0';\n      ++i;\n    } \n  }\n  //cout << \"left_to_right = \" << ret << endl;\n  return ret;\n}\n\nint main(){\n  string S;\n  int N;\n  cin >> S >> N;\n  if(multi_first(S) == N){\n    if(left_to_right(S) == N) cout << 'U' << endl;\n    else cout << 'M' << endl;\n  }else{\n    if(left_to_right(S) == N) cout << 'L' << endl;\n    else cout << 'I' << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define  _CRT_SECURE_NO_WARNINGS\n#pragma comment (linker, \"/STACK:526000000\")\n\n#include \"bits/stdc++.h\"\n\nusing namespace std;\ntypedef string::const_iterator State;\n#define eps 1e-11L\n#define MAX_MOD 1000000007LL\n#define GYAKU 500000004LL\n\n#define MOD 998244353LL\n#define seg_size 262144*2LL\n#define pb push_back\n#define mp make_pair\ntypedef long long ll;\n#define REP(a,b) for(long long (a) = 0;(a) < (b);++(a))\n#define ALL(x) (x).begin(),(x).end()\n\nunsigned long xor128() {\n\tstatic unsigned long x = 123456789, y = 362436069, z = 521288629, w = time(NULL);\n\tunsigned long t = (x ^ (x << 11));\n\tx = y; y = z; z = w;\n\treturn (w = (w ^ (w >> 19)) ^ (t ^ (t >> 8)));\n}\n\nvoid init() {\n}\n\nvoid solve() {\n\tstring s;\n\tcin >> s;\n\tint a = 0;\n\tcin >> a;\n\tint ans = 0;\n\t{\n\t\tint now = s[0] - '0';\n\t\tfor (int i = 1; i < s.length();i += 2) {\n\t\t\tif (s[i] == '+') {\n\t\t\t\tnow += s[i + 1] - '0';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnow *= s[i + 1] - '0';\n\t\t\t}\n\t\t}\n\t\tif (now == a) {\n\t\t\tans |= 2;\n\t\t}\n\t}\n\t{\n\t\tstack<int> geko;\n\t\tint now = s[0] - '0';\n\t\tfor (int q = 1; q < s.length(); q += 2) {\n\t\t\tif (s[q] == '+') {\n\t\t\t\tgeko.push(now);\n\t\t\t\tnow = s[q + 1] - '0';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnow *= s[q + 1] - '0';\n\t\t\t}\n\t\t}\n\t\twhile (geko.empty() == false) {\n\t\t\tnow += geko.top();\n\t\t\tgeko.pop();\n\t\t}\n\t\tif (now == a) {\n\t\t\tans |= 1;\n\t\t}\n\t}\n\tstring answer = \"IMLU\";\n\tcout << answer[ans] << endl;\n}\nint main() {\n\tinit();\n\tsolve();\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n\nint main()\n{\n\tchar str[50];\n\tint arr[50];\n\tint top;\n\tint len;\n\tint num;\n\tint ans1,ans2;\n\tscanf(\"%s\",str);\n\tscanf(\"%d\",&num);\n\tlen=strlen(str);\n\tarr[0]=str[0]-'0';\n\ttop=0;\n\tfor(int i=1; i<len; i+=2){\n\t\tif(str[i]=='*'){\n\t\t\tarr[top]*=str[i+1]-'0';\n\t\t}else{\n\t\t\tarr[++top]=str[i+1]-'0';\n\t\t}\n\t}\n\tans1=0;\n\tfor(int i=0; i<=top; i++)\n\t\tans1+=arr[i];\n\tans2=str[0]-'0';\n\tfor(int i=1; i<len; i+=2){\n\t\tif(str[i]=='*')\n\t\t\tans2*=str[i+1]-'0';\n\t\telse\n\t\t\tans2+=str[i+1]-'0';\n\t}\n\tif(ans1==num && ans2==num)\n\t\tprintf(\"U\\n\");\n\telse if(ans1==num && ans2!=num)\n\t\tprintf(\"M\\n\");\n\telse if(ans1!=num && ans2==num)\n\t\tprintf(\"L\\n\");\n\telse if(ans1!=num && ans2!=num)\n\t\tprintf(\"I\\n\");\n\t\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\nstring s;\nlong long x;\n\nint main(){\n\tcin >> s;\n\tcin >> x;\n\tlong long t1 = 0, t2 = 0;\n\tint last_sign = 0;\n\tfor (int i=0;i<s.length();i+=2){\n\t\tif (last_sign){\n\t\t\tt1 = t1*(s[i]-'0');\n\t\t}else t1 += s[i]-'0';\n\t\tif (t1>x) break;\n\t\tif (i+1 != s.length() and s[i+1] == '+') last_sign = 0;\n\t\telse last_sign = 1;\n\t}\n\tlong long current_multiple = 1;\n\tfor (int i=0;i<s.length();i++){\n\t\tif (s[i] == '+'){\n\t\t\tt2 += current_multiple;\n\t\t\tcurrent_multiple = 1;\n\t\t} else if (s[i] != '*'){\n\t\t\tif (s[i]=='0' or current_multiple < x)\n\t\t\t\tcurrent_multiple *= s[i]-'0';\n\t\t}\n\t}\n\tt2+=current_multiple;\n\tif (t1 == x and t2!=x){\n\t\tcout << \"L\";\n\t}\n\telse if (t1!=x and t2==x){\n\t\tcout << \"M\";\n\t}\n\telse if (t1 == x and t2 == x){\n\t\tcout << \"U\";\n\t}\n\telse cout << \"I\";\n\tcout << \"\\n\";\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\nusing namespace std;\n\nchar result[8] = \"IMLU\";\n\nint main() {\n    string expr;\n    int ans, a, b, c, res1, res2;\n    char op;\n    stringstream ss, tt;\n    cin >> expr >> ans;\n// left-to-right\n    ss << expr;\n    ss >> a;\n    while (!ss.eof()) {\n        ss >> op;\n        ss >> b;\n        if (op == '+') {\n            a += b;\n        } else if (op == '*') {\n            a *= b;\n        }\n    }\n    res1 = a;\n\n    ss.clear();\n    // multiplication-first\n    ss << expr;\n    ss >> a;\n    while (!ss.eof()) {\n        ss >> op;\n        ss >> b;\n\n        if(op == '+') {\n            tt << a;\n            tt << '+';\n            a = b;\n        } else if (op == '*') {\n            a *= b;\n        }\n    }\n    tt << a;\n\n    ss.clear();\n    ss << tt.str();\n    ss >> a;\n    while (!ss.eof()) {\n        ss >> op;\n        ss >> b;\n        if (op == '+') {\n            a += b;\n        } else if (op == '*') {\n            a *= b;\n        }\n    }\n    res2 = a;\n\n    int status = 0;\n    if (res1 == ans) {\n        status += 2;\n    }\n    if (res2 == ans) {\n        status += 1;\n    }\n\n    cout << result[status] << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\nusing namespace std;\n\nint main() {\n\n  string in;\n  cin >> in;\n\n  long long int a;\n  cin >> a;\n\n  long long int k = 0;\n  char c = '+';\n  long long int n = 1;\n  long long int ans_0 = 0;\n  long long int ans_1 = 0;\n\n  for ( long long int i = 0; i < in.size(); i++ ) {\n\n    if ( in[i] == '+' ) {\n\n      if ( c == '+' ) {\n\tans_0 += k;\n      }else {\n\tans_0 *= k;\n      }\n      c = '+';\n      n *= k;\n      ans_1 += n;\n      k = 0;\n      n = 1;\n\n    }else if ( in[i] == '*' ) {\n\n      if ( c == '+' ) {\n\tans_0 += k;\n      }else {\n\tans_0 *= k;\n      }\n      c = '*';\n      n *= k;\n      k = 0;\n\n    }else {\n\n      k = k * 10 + in[i] - '0';\n\n    }\n\n  }\n\n  if ( c == '+' ) {\n    ans_0 += k;\n  }else {\n    ans_0 *= k;\n  }\n  n *= k;\n  ans_1 += n;\n\n  string s = \"ILMU\";\n\n  k = 0;\n\n  if ( a == ans_0 ) k++;\n  if ( a == ans_1 ) k += 2;\n\n  cout << s[k] << endl;\n\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n\nusing namespace std;\nbool isM(int n,string s)\n{\n\tvector<bool> used(s.length());\n\tfor (int i = 0; i < s.length(); i++)\n\t{\n\t\tused[i] = false;\n\t}\n\tbool flag = false;\n\tint sum = 0;\n\tfor (int i = 1; i < s.length(); i+= 2)\n\t{\n\t\tif (s[i] == '*')\n\t\t{\n\t\t\tif (used[i - 1])\n\t\t\t{\n\t\t\t\tsum *= (s[i + 1] - '0');\n\t\t\t\tused[i + 1] = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (!flag)\n\t\t\t\t{\n\t\t\t\t\tsum = (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t\t\tflag = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tsum += (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t\t}\n\t\t\t\tused[i - 1] = true;\n\t\t\t\tused[i + 1] = true;\n\t\t\t}\n\t\t\t//cout << sum << endl;\n\t\t}\n\t}\n\tfor (int i = 0; i < s.length(); i += 2)\n\t{\n\t\tif (used[i])continue;\n\t\tsum += (s[i] - '0');\n\t}\n\t//cout << sum << endl;\n\tif (n == sum)return true;\n\telse return false;\n}\n\nbool isL(int n,string s)\n{\n\tif (s.length() == 1 && s[0] - '0' == n)return true;\n\tint sum = 0;\n\tfor (int i = 1; i < s.length(); i += 2)\n\t{\n\t\tif (i == 1)\n\t\t{\n\t\t\tif (s[i] == '+')\n\t\t\t{\n\t\t\t\tsum = s[i - 1] - '0' + (s[i + 1] - '0');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsum = (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (s[i] == '+')\n\t\t\t{\n\t\t\t\tsum += (s[i + 1] - '0');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsum *= (s[i + 1] - '0');\n\t\t\t}\n\t\t}\n\t}\n\n\tif (sum == n)return true;\n\telse return false;\n}\n\nint main()\n{\n\tstring exp;\n\tint n;\n\tcin >> exp;\n\tcin >> n;\n\tif (isM(n, exp) && isL(n, exp))\n\t{\n\t\tcout << \"U\" << endl;\n\t}\n\telse if (isM(n,exp))\n\t{\n\t\tcout << \"M\" << endl;\n\t}\n\telse if (isL(n, exp))\n\t{\n\t\tcout << \"L\" << endl;\n\t}\n\telse\n\t{\n\t\tcout << \"I\" << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint mba(string s){\n  vector<int> t;\n  t.push_back(s[0] - '0');\n  for(int i = 1; i < s.size() ; i+=2){\n    if(s[i]=='+'){\n      t.push_back(s[i+1] - '0');\n    } else {\n      t.back() *= s[i+1] - '0';\n    }\n  }\n  int res = 0;\n  for(int i : t)res += i;\n  return res;\n}\nint ltr(string s){\n  int res = s[0] - '0';\n  for(int i = 1; i < s.size() ; i+=2){\n    if(s[i]=='+'){\n      res += s[i+1] - '0';\n    } else {\n      res *= s[i+1] - '0';\n    }\n  }\n  return res;\n}\nint main(){\n  string out = \"IMLU\";\n  string s; cin >> s;\n  int e; cin >> e;\n  cout << out[(mba(s)==e) + 2*(ltr(s)==e)] << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint eval1(string S){\n  int N = S.size();\n  int ans = 0;\n  int p = 1;\n  for (int i = 0; i < N; i++){\n    if (S[i] == '+'){\n      ans += p;\n      p = 1;\n    } else if (S[i] != '*'){\n      p *= S[i] - '0';\n    }\n  }\n  ans += p;\n  return ans;\n}\nint eval2(string S){\n  int ans = 0;\n  int N = S.size();\n  ans = S[0] - '0';\n  for (int i = 1; i < N; i += 2){\n    if (S[i] == '+'){\n      ans += S[i + 1] - '0';\n    } else {\n      ans *= S[i + 1] - '0';\n    }\n  }\n  return ans;\n}\nint main(){\n  string S;\n  cin >> S;\n  int N;\n  cin >> N;\n  int M = eval1(S);\n  int L = eval2(S);\n  if (M == N){\n    if (L == N){\n      cout << 'U' << endl;\n    } else {\n      cout << 'M' << endl;\n    }\n  } else {\n    if (L == N){\n      cout << 'L' << endl;\n    } else {\n      cout << 'I' << endl;\n    }\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cctype>\n#include <string>\n#include <vector>\n#include <iostream>\n\nusing namespace std;\n\nlong long expression1(vector<string>);\nlong long expression2(vector<string>);\n\nstring to_string(char c)\n{\n\tstring S; S = c;\n\n\treturn S;\n}\n\nvector<string> to_expression(string S)\n{\n\tvector<string> v; int sum = 0;\n\n\tfor (int i = 0; i < S.size(); i++)\n\t{\n\t\tif (isdigit(S[i]))\n\t\t{\n\t\t\tsum *= 10; sum += (S[i] - 48);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tv.push_back(to_string(sum)); sum = 0; v.push_back(to_string(S[i]));\n\t\t}\n\t}\n\n\tv.push_back(to_string(sum));\n\n\treturn v;\n}\n\nlong long expression1(vector<string> v)\n{\n\tvector<string> v2;\n\n\tlong long sum = stoi(v[0]);\n\n\tfor (int i = 1; i < v.size(); i += 2)\n\t{\n\t\tif (v[i] == \"+\")\n\t\t{\n\t\t\tv2.push_back(to_string(sum)); v2.push_back(\"+\"); sum = stoll(v[i + 1]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsum *= stoll(v[i + 1]);\n\t\t}\n\t}\n\n\tv2.push_back(to_string(sum));\n\n\treturn expression2(v2);\n}\n\nlong long expression2(vector<string> v)\n{\n\tlong long sum = stoi(v[0]);\n\n\tfor (int i = 1; i < v.size(); i += 2)\n\t{\n\t\tif (v[i] == \"+\")\n\t\t{\n\t\t\tsum += stoll(v[i + 1]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsum *= stoll(v[i + 1]);\n\t\t}\n\t}\n\n\treturn sum;\n}\n\nint main()\n{\n\tstring S; int N;\n\n\tcin >> S >> N;\n\n\tlong long res1 = expression1(to_expression(S));\n\tlong long res2 = expression2(to_expression(S));\n\n\tint ret = (res1 == N ? 2 : 0) + (res2 == N ? 1 : 0);\n\n\tswitch (ret)\n\t{\n\t\tcase 3: cout << \"U\" << endl; break;\n\t\tcase 2: cout << \"M\" << endl; break;\n\t\tcase 1: cout << \"L\" << endl; break;\n\t\tcase 0: cout << \"I\" << endl; break;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#include <cctype>\nusing namespace std;\ntypedef long long ll;\nstring s;\nint n;\nll x;\nll term(int &it){\n\tll now=s[it]-'0';\n\tit++;\n\twhile(s[it]=='*'){\n\t\tit++;\n\t\tnow*=(s[it]-'0');\n\t\tit++;\n\t}\n\treturn now;\n}\nbool ism(int &it){\n\tll now=term(it);\n\twhile(s[it]=='+'){\n\t\tit++;\n\t\tll l=term(it);\n\t\tnow+=l;\n\t}\n\treturn now==x;\n}\nbool isl(int it){\n\tll now=s[it]-'0';\n\tit++;\n\twhile(s[it]=='*'||s[it]=='+'){\n\t\tif(s[it]=='+'){\n\t\t\tit++;\n\t\t\tnow+=(s[it]-'0');\n\t\t\tit++;\n\t\t}\n\t\tif(s[it]=='*'){\n\t\t\tit++;\n\t\t\tnow*=(s[it]-'0');\n\t\t\tit++;\n\t\t}\n\t}\n\treturn now==x;\n}\nint main(){\n\tcin>>s>>x;\n\ts+='$';\n\tn=s.size();\n\tint it=0;\n\tbool m=ism(it);\n\tit=0;\n\tbool l=isl(it);\n\tif(m&l) cout<<\"U\\n\";\n\tif(m&!l) cout<<\"M\\n\";\n\tif(!m&&l) cout<<\"L\\n\";\n\tif(!m&&!l) cout<<\"I\\n\";\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <list>\n#include <vector>\n#include <complex>\n#include <utility>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <bitset>\n#include <ctime>\n#include <map>\n#include <unordered_map>\n#include <set>\n#include <unordered_set>\n#include <cassert>\n#include <cstddef>\n#include <iomanip>\n#include <numeric>\n#include <tuple>\n#include <sstream>\n#include <fstream>\n\nusing namespace std;\n#define REP(i, n) for (int (i) = 0; (i) < (n); (i)++)\n#define FOR(i, a, b) for (int (i) = (a); (i) < (b); (i)++)\n#define RREP(i, a) for(int (i) = (a) - 1; (i) >= 0; (i)--)\n#define FORR(i, a, b) for(int (i) = (a) - 1; (i) >= (b); (i)--)\n#define DEBUG(C) cerr << #C << \" = \" << C << endl;\nusing LL = long long;\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing VL = vector<LL>;\nusing VVL = vector<VL>;\nusing VD = vector<double>;\nusing VVD = vector<VD>;\nusing PII = pair<int, int>;\nusing PDD = pair<double, double>;\nusing PLL = pair<LL, LL>;\nusing VPII = vector<PII>;\ntemplate<typename T> using VT = vector<T>;\n#define ALL(a) begin((a)), end((a))\n#define RALL(a) rbegin((a)), rend((a))\n#define SORT(a) sort(ALL((a)))\n#define RSORT(a) sort(RALL((a)))\n#define REVERSE(a) reverse(ALL((a)))\n#define MP make_pair\n#define FORE(a, b) for (auto &&a : (b))\n#define FIND(s, e) ((s).find(e) != (s).end())\n#define EB emplace_back\ntemplate<typename T>inline bool chmax(T &a,T b){if(a<b){a=b;return true;}return false;}\ntemplate<typename T>inline bool chmin(T &a,T b){if(a>b){a=b;return true;}return false;}\n\nconst int INF = 1e9;\nconst int MOD = INF + 7;\nconst LL LLINF = 1e18;\n\nvector<string> split(const string &originalStr, char sep) {\n    vector<string> res;\n    string element = \"\";\n    for (const char c : originalStr) {\n        if (c == sep) {\n            res.emplace_back(element);\n            element.clear();\n        } else {\n            element += c;\n        }\n    }\n    if (!element.empty()) {\n        res.emplace_back(element);\n    }\n    return res;\n}\n\nchar strbuf[1000];\nstring S;\nint ans;\n\nint leftToRightCalc(string s) {\n    const int L = s.length();\n    if (L == 0) return 0;\n    int res = s[0] - '0';\n    bool premul = false;\n    FOR(i, 1, L) {\n        if (isdigit(s[i])) {\n            if (premul) {\n                res *= s[i] - '0';\n            } else {\n                res += s[i] - '0';\n            }\n        } else {\n            premul = s[i] == '*';\n        }\n    }\n    return res;\n}\nint mul(string s) {\n    if (s.length() == 0) return 0;\n    int res = s[0] - '0';\n    FOR(i, 1, s.length()) {\n        if (isdigit(s[i])) {\n            res *= s[i] - '0';\n        }\n    }\n    //DEBUG(res)\n    return res;\n}\nint mulFirstCalc(string s) {\n    VT<string> S = split(s, '+');\n    int res = 0;\n    FORE(e, S) {\n        //DEBUG(e)\n        if (e.length() == 1) res += e[0] - '0';\n        else res += mul(e);\n    }\n    return res;\n}\n\nint main(void) {\n    scanf(\"%s\", strbuf);\n    S = strbuf;\n    scanf(\"%d\", &ans);\n    int ltr = leftToRightCalc(S);\n    int mf = mulFirstCalc(S);\n    //DEBUG(ltr)DEBUG(mf)\n    if (ans == mf && ans != ltr) {\n        puts(\"M\");\n    } else if (ans != mf && ans == ltr) {\n        puts(\"L\");\n    } else if (ans == mf && ans == ltr) {\n        puts(\"U\");\n    } else {\n        puts(\"I\");\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <string>\n#include <iostream>\n#include <cctype>\nusing namespace std;\ntypedef string::const_iterator State;\n\nint expression(State &begin);\nint expression2(State &begin);\nint term(State &begin);\nint number(State &begin);\n\nint number(State &begin){\n\tint ret=0;\n\twhile(isdigit(*begin)){\n\t\tret*=10;\n\t\tret+=*begin-'0';\n\t\tbegin++;\n\t}\n\treturn ret;\n}\n\nint term(State &begin){\n\tint ret=number(begin);\n\twhile(1){\n\t\tif(*begin=='*'){\n\t\t\tbegin++;\n\t\t\tret*=number(begin);\n\t\t}else{\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn ret;\n}\n\nint expression(State &begin){\n\tint ret=term(begin);\n\twhile(1){\n\t\tif(*begin=='+'){\n\t\t\tbegin++;\n\t\t\tret+=term(begin);\n\t\t}else{\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn ret;\n}\n\nint expression2(State &begin){\n\tint ret=number(begin);\n\twhile(1){\n\t\tif(*begin=='+'){\n\t\t\tbegin++;\n\t\t\tret+=number(begin);\n\t\t}else if(*begin=='*'){\n\t\t\tbegin++;\n\t\t\tret*=number(begin);\n\t\t}else{\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn ret;\n}\n\n\n\nint main(void){\n\tstring str;\n\tcin >> str;\n\tState begin=str.begin();\n\tint ans=expression(begin);\n\tbegin=str.begin();\n\tint ans2=expression2(begin);\n\tint n;\n\tscanf(\"%d\",&n);\n\tif(n==ans && n==ans2)printf(\"U\\n\");\n\tif(n==ans && n!=ans2)printf(\"M\\n\");\n\tif(n!=ans && n==ans2)printf(\"L\\n\");\n\tif(n!=ans && n!=ans2)printf(\"I\\n\");\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cstdlib>\n\nusing std::cin;\nusing std::cout;\nusing std::endl;\n\nint cal_ltor(std::string str) {\n\tint num_l = 0;\n\tbool plus = true;\n\tfor (int i = 0; i < str.length(); i++) {\n\t\tif ( i%2 == 0 ) {\n\t\t\tif ( plus ) {\n\t\t\t\tnum_l += (int)(str[i] - '0');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnum_l *= (int)(str[i] - '0');\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif ( str[i] == '+' ) {\n\t\t\t\tplus = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tplus = false;\n\t\t\t}\n\t\t}\n\t}\n\treturn num_l;\n}\n\nint cal_multi(std::string str) {\n\tint num_p = 0;\n\tint pro;\n\tint l = str.length();\n\tstd::vector<bool> cal(l, true);\n\tfor (int i = 0; i < l; i++) {\n\t\tif (str[i] == '*') {\n\t\t\tnum_p += ( (int)(str[i-1] - '0') ) * ( (int)(str[i+1] - '0') );\n\t\t\tcal[i] = false;\n\t\t\tcal[i+1] = false;\n\t\t\tcal[i-1] = false;\n\t\t}\n\t}\n\tfor (int i = 0; i < l; i++) {\n\t\tif ( cal[i] && i%2 == 0 ) {\n\t\t\tnum_p += (int)(str[i] - '0');\n\t\t}\n\t}\n\treturn num_p;\n}\n\nint main(void) {\n\tstd::string str;\n\tcin >> str;\n\tint num_l = cal_ltor(str);\n\tint num_p = cal_multi(str);\n\n\tint ans;\n\tcin >> ans;\n\tif ( ans == num_l && ans == num_p ) {\n\t\tcout << \"U\" << endl;\n\t}\n\telse if ( ans == num_l ) {\n\t\tcout << \"L\" << endl;\n\t}\n\telse if ( ans == num_p ) {\n\t\tcout << \"M\" << endl;\n\t}\n\telse {\n\t\tcout << \"I\" << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstring s;\nint n, l;\nlong long a, b;\n\nint main(){\n//\tcin.tie(0);\n//\tios::sync_with_stdio(false);\n\tcin >> s >> n;\n\tl = s.size();\n\tif(l == 1){\n\t\tif(s[0] - '0' == n) cout << \"U\\n\";\n\t\telse cout << \"I\\n\";\n\t\treturn 0;\n\t}\n\ta = s[0] - '0';\n\tfor(int i=2; i<l; i+=2){\n\t\tif(s[i-1] == '+') a += s[i] - '0';\n\t\telse a *= s[i] - '0';\n\t}\n\tfor(int i=0; i<l; i+=2){\n\t\tlong long t = s[i] - '0';\n\t\twhile(i+2 < l && s[i+1] == '*'){\n\t\t\tt *= s[i+2] - '0';\n\t\t\ti += 2;\n\t\t}\n\t\tb += t;\n\t}\n\tif(n == a){\n\t\tif(n == b) cout << \"U\\n\";\n\t\telse cout << \"L\\n\";\n\t}else{\n\t\tif(n == b) cout << \"M\\n\";\n\t\telse cout << \"I\\n\";\n\t}\n//\tcout << a << \" \" << b << \"\\n\";\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <stdio.h>\nusing namespace std;\nstring s;\nlong long ans;\nint cur;\nlong long suu(){\n  string num = \"\";\n  while(cur < s.size() && '0' <= s[cur] && s[cur] <= '9' ){\n\tfflush(stdout);\n\tnum += s[cur];\n\tcur++;\n  }\n\n  return stoll(num);\n}\nlong long kou(){\n  long long res = suu();\n  if(cur < s.size() && s[cur] == '*'){\n\tcur++;\n\tres *= kou();\n  }\n  return res;\n}\nlong long siki(){\n  long long res = kou();\t\n  if(cur < s.size() && s[cur] == '+'){\n\tcur++;\n\tres += siki();\n\n  }\n  return res;\n}\nlong long left_siki(){\n  long long res = suu();\n  char op;\n  while( cur < s.size() && ((op = s[cur]) == '+' || (op == '*') ) ){\n\tcur++;\n\tif(op == '+'){\n\t  res += suu();\n\t}else if(op == '*'){\n\t  res *=  suu();\n\t}\n  }\n  return res;\n}\nint main(){\n  cur = 0;\n  cin >> s >> ans;\n  long long res1 = siki();\n\n  cur = 0;\n  long long res2 = left_siki();\n  \n  int flag = 0;\n  if(res1 == ans){\n\tflag = 1;\n  }\n  if(res2 == ans){\n\tflag |= 2;\n  }\n\n  if(flag == 0)cout << \"I\" << endl;\n  else if(flag == 3)cout << \"U\" << endl;\n  else if(flag == 1) cout << \"M\" << endl;\n  else if(flag == 2) cout << \"L\" << endl;\n  \n  return 0;\n  \n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <iostream>\n#include <math.h>\n#include <assert.h>\n#include <vector>\n#include <queue>\n#include <string>\n#include <map>\n#include <set>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\nstatic const double EPS = 1e-9;\nstatic const double PI = acos(-1.0);\n\n#define REP(i, n) for (int i = 0; i < (int)(n); i++)\n#define FOR(i, s, n) for (int i = (s); i < (int)(n); i++)\n#define FOREQ(i, s, n) for (int i = (s); i <= (int)(n); i++)\n#define FORIT(it, c) for (__typeof((c).begin())it = (c).begin(); it != (c).end(); it++)\n#define MEMSET(v, h) memset((v), h, sizeof(v))\n\nchar str[100];\n\nll calc(ll lhs, char c, ll rhs) {\n  if (c == '+') { return lhs + rhs; }\n  return lhs * rhs;\n}\nchar *skip(char *p) {\n  while (isdigit(*p)) { p++; }\n  return p;\n}\n\nll calc1() {\n  char *p = str;\n  ll lhs = atoi(p);\n  p = skip(p);\n  while (*p != 0) {\n    char c = *p;\n    p++;\n    ll rhs = atoi(p);\n    lhs = calc(lhs, c, rhs);\n    p = skip(p);\n  }\n  return lhs;\n}\n\nll calc2() {\n  char *p = str;\n  vector<ll> vs;\n  ll lhs = atoi(p);\n  p = skip(p);\n  while (*p != 0) {\n    char c = *p;\n    p++;\n    if (c == '+') { \n      vs.push_back(lhs);\n      lhs = atoi(p);\n    } else {\n      ll rhs = atoi(p);\n      lhs *= rhs;\n    }\n    p = skip(p);\n  }\n  FORIT(it, vs) { lhs += *it; }\n  return lhs;\n}\n\nint main() {\n  ll ans;\n  while (scanf(\"%s %lld\", str, &ans) > 0) {\n    ll v1 = calc1();\n    ll v2 = calc2();\n    if (ans == v1 && ans == v2) {\n      puts(\"U\");\n    } else if (ans == v1) {\n      puts(\"L\");\n    } else if (ans == v2) {\n      puts(\"M\");\n    } else {\n      puts(\"I\");\n    }\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\n\nstring strerase(string instr,int num){\n\tstring rst = \"\";\n\tfor(int i=num;i<instr.size();i++){\n\t\trst += instr[i];\n\t}\n\treturn rst;\n}\nll int calc1(string str){//multiplication-first\n\tstack<ll int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push((ll int)stoi(rststr));\n\tif(rststr!=\"\") str = strerase(str,log10((double)stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr = strerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\tstr = strerase(str,(int)log10((double)tmp)+1);\n\t\t\tll int tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr = strerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr = strerase(str,(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\tll int rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nll int calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tll int rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str = strerase(str,(int)log10((double)rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr = strerase(str,1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr = strerase(str,1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nll int calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str = strerase(str,(int)log10((double)stoi(rststr))+1);\n\tll int rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr = strerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr = strerase(str,(int)log10((double)tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr = strerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr = strerase(str,(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\tcin >> str;\n\tll int ans;\n\tcin >> ans;\n\tll int rst1 = calc1(str);//calc2　is bug\n\tll int rst2 = calc3(str);\n\t//cout << rst1 << \" \" << rst2 << endl;\n\tif(rst1==ans){\n\t\tif(rst2==ans) cout << 'U' << endl;\n\t\telse cout << 'M' << endl;\n\t}else{\n\t\tif(rst2==ans) cout << 'L' << endl;\n\t\telse cout << 'I' << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nsigned main() {\n  cin.tie(0);\n  ios_base::sync_with_stdio(0);\n  cout << fixed << setprecision(12);\n  \n  string s;\n  int l;\n  cin >> s;\n  l = s.size();\n\n  int n;\n  cin >> n;\n\n  int res1 = 0, res2 = 0;\n\n  for ( int i = 0; i < l; i++ ) {\n    if ( s[i+1] == '+' || i == l-1 ) {\n      res1 += s[i]-'0';\n      i++;      \n    } else {\n      int m = s[i]-'0';\n      i += 2;      \n      while ( s[i-1] == '*' ) {\n\tm *= s[i]-'0';\n\ti += 2;\t\n      }\n      res1 += m;\n      i--;      \n    }    \n  }\n\n  res2 = s[0]-'0';  \n  for ( int i = 2; i < l; i++ ) {\n    if ( s[i-1] == '*' ) {\n      res2 *= s[i]-'0';      \n      i++;      \n    } else {\n      res2 += s[i]-'0';\n      i++;      \n    }\n  }\n\n  if ( res1 == n && res2 == n ) {\n    puts(\"U\");    \n  } else if ( res1 == n ) {\n    puts(\"M\");    \n  } else if ( res2 == n ) {\n    puts(\"L\");    \n  } else {\n    puts(\"I\");    \n  }  \n  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\n#define int ll\ntypedef pair<int,int> pii;\n#define rep(i,n) for(ll i=0;i<(ll)(n);i++)\n#define all(a) (a).begin(),(a).end()\n#define pb emplace_back\n\nvector<string> split(string s,char ch){\n    vector<string> ret;\n    string tmp =\"\";\n    rep(i,s.size()){\n        if(s[i]==ch){\n            ret.pb(tmp);\n            tmp = \"\";\n        }else tmp+=s[i];\n    }\n    if(tmp.size())ret.pb(tmp);\n    return ret;\n}\n\nint solveL(string s){\n    int res = s[0]-'0';\n    for(int i=1;i<s.size();i+=2){\n        if(s[i]=='+')res+=s[i+1]-'0';\n        if(s[i]=='*')res*=s[i+1]-'0';\n    }\n    return res;\n}\n\nint solveM(string s){\n    vector<string> res = split(s,'+');\n    \n    rep(i,res.size()){\n        int r = solveL(res[i]);\n        stringstream ss;\n        ss<<r;\n        res[i] = ss.str();\n    }\n    int sum = 0;\n    rep(i,res.size()){\n        sum+=stoi(res[i]);\n    }\n    return sum;\n}\n\nsigned main(){\n    string s;\n    cin>>s;\n    int ans;\n    cin>>ans;\n    \n    int m = solveM(s);\n    int l = solveL(s);\n    \n    if(m==ans&&l==ans)cout<<'U'<<endl;\n    else if(m==ans)cout<<'M'<<endl;\n    else if(l==ans)cout<<'L'<<endl;\n    else cout<<'I'<<endl;\n    \n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n//typedef\n//-------------------------#include <bits/stdc++.h>\n \nconst double pi = 3.141592653589793238462643383279;\n \n \nusing namespace std;\n \n//conversion\n//------------------------------------------\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout << x; return sout.str(); }\ninline int readInt() { int x; scanf(\"%d\", &x); return x; }\n \n//typedef\n//------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef pair<long long, long long> PLL;\ntypedef pair<int, PII> TIII;\ntypedef long long LL;\ntypedef unsigned long long ULL;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\n \n \n//container util\n \n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define SQ(a) ((a)*(a))\n#define EACH(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n \n \n//repetition\n//------------------------------------------\n#define FOR(i,s,n) for(int i=s;i<(int)n;++i)\n#define REP(i,n) FOR(i,0,n)\n#define MOD 998244353\n \n#define rep(i, a, b) for(int i = a; i < (b); ++i)\n#define trav(a, x) for(auto& a : x)\n#define all(x) x.begin(), x.end()\n#define sz(x) (int)(x).size()\n \ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef vector<int> vi;\nconst double EPS = 1E-8;\n \n#define chmin(x,y) x=min(x,y)\n#define chmax(x,y) x=max(x,y)\n \nclass UnionFind {\npublic:\n    vector <int> par; \n    vector <int> siz; \n\n    UnionFind(int sz_): par(sz_), siz(sz_, 1) {\n        for (ll i = 0; i < sz_; ++i) par[i] = i;\n    }\n    void init(int sz_) {\n        par.resize(sz_);\n        siz.assign(sz_, 1LL);\n        for (ll i = 0; i < sz_; ++i) par[i] = i;\n    }\n \n    int root(int x) { \n        while (par[x] != x) {\n            x = par[x] = par[par[x]];\n        }\n        return x;\n    }\n \n    bool merge(int x, int y) {\n        x = root(x);\n        y = root(y);\n        if (x == y) return false;\n        if (siz[x] < siz[y]) swap(x, y);\n        siz[x] += siz[y];\n        par[y] = x;\n        return true;\n    }\n \n    bool issame(int x, int y) { \n        return root(x) == root(y);\n    }\n \n    int size(int x) { \n        return siz[root(x)];\n    }\n};\n \n \nll modPow(ll x, ll n, ll mod = MOD){\n    ll res = 1;\n    while(n){\n        if(n&1) res = (res * x)%mod;\n \n        res %= mod;\n        x = x * x %mod;\n        n >>= 1;\n    }\n    return res;\n}\n \n#define SIEVE_SIZE 5000000+10\nbool sieve[SIEVE_SIZE];\nvoid makeSieve(){\n    for(int i=0; i<SIEVE_SIZE; ++i) sieve[i] = true;\n    sieve[0] = sieve[1] = false;\n    for(int i=2; i*i<SIEVE_SIZE; ++i) if(sieve[i]) for(int j=2; i*j<SIEVE_SIZE; ++j) sieve[i*j] = false;\n}\n \nbool isprime(ll n){\n    if(n == 0 || n == 1) return false;\n    for(ll i=2; i*i<=n; ++i) if(n%i==0) return false;\n    return true;\n}\n \nconst int MAX = 2000010;\nlong long fac[MAX], finv[MAX], inv[MAX];\n \n// テーブルを作る前処理\nvoid COMinit() {\n    fac[0] = fac[1] = 1;\n    finv[0] = finv[1] = 1;\n    inv[1] = 1;\n    for (int i = 2; i < MAX; i++){\n        fac[i] = fac[i - 1] * i % MOD;\n        inv[i] = MOD - inv[MOD%i] * (MOD / i) % MOD;\n        finv[i] = finv[i - 1] * inv[i] % MOD;\n    }\n}\n \n// 二項係数計算\nlong long COM(int n, int k){\n    if (n < k) return 0;\n    if (n < 0 || k < 0) return 0;\n    return fac[n] * (finv[k] * finv[n - k] % MOD) % MOD;\n}\n \nlong long extGCD(long long a, long long b, long long &x, long long &y) {\n    if (b == 0) {\n        x = 1;\n        y = 0;\n        return a;\n    }\n    long long d = extGCD(b, a%b, y, x);\n    y -= a/b * x;\n    return d;\n}\n// 負の数にも対応した mod (a = -11 とかでも OK) \ninline long long mod(long long a, long long m) {\n    return (a % m + m) % m;\n}\n \n// 逆元計算 (ここでは a と m が互いに素であることが必要)\nlong long modinv(long long a, long long m) {\n    long long x, y;\n    extGCD(a, m, x, y);\n    return mod(x, m); // 気持ち的には x % m だが、x が負かもしれないので\n}\nll GCD(ll a, ll b){\n    \n    if(b == 0) return a;\n    return GCD(b, a%b);\n}\n\ntypedef vector<ll> vec;\ntypedef vector<vec> mat;\n\nmat mul(mat &A, mat &B) {\n    mat C(A.size(), vec((int)B[0].size()));\n    for(int i=0; i<A.size(); ++i){\n        for(int k=0; k<B.size(); ++k){\n            for(int j=0; j<B[0].size(); ++j){\n                C[i][j] = (C[i][j] + A[i][k] * B[k][j] %MOD) % MOD;\n            }\n        }\n    }\n    return C;\n}\nmat matPow(mat A, ll n) {\n    mat B(A.size(), vec((int)A.size()));\n \n    for(int i=0; i<A.size(); ++i){\n        B[i][i] = 1;\n    }\n \n    while(n > 0) {\n        if(n & 1) B = mul(B, A);\n        A = mul(A, A);\n        n >>= 1;\n    }\n    return B;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(15);\n\n    string s; cin >> s;\n\n    ll res; cin >> res;\n\n    ll p1 = s[0] - '0';\n    for(int i=1; i<s.size(); i+=2){\n        if(s[i] == '+'){\n            p1 += (s[i+1]-'0');\n        }else if(s[i] == '*'){\n            p1 *= (s[i+1]-'0');\n        }\n    }\n    stack<ll> st;\n    stack<ll> tmp;\n    ll p2 = 0;\n    bool checked[20] = {false};\n    for(int i=1; i<s.size(); i+=2){\n        if(s[i] == '*'){\n            if(!checked[i-1]){\n                st.push(s[i-1]-'0');\n                checked[i-1] = true;\n            }\n\n            if(!checked[i+1]) {\n                st.push(s[i+1]-'0');\n                checked[i+1] = true;\n            }\n        }else{\n            ll t = 1;\n            int ct = 0;\n            while(st.size()){\n                t *= st.top();\n                st.pop();\n                ct++;\n            }\n            if(ct)tmp.push(t);\n        }\n    }\n    ll t = 1;\n    int ct = 0;\n    while(!st.empty()){\n        \n        t *= st.top();\n        st.pop();\n\n        ct++;\n    }\n    if(ct)tmp.push(t);\n\n    for(int i=0; i<s.size(); i+=2){\n        if(!checked[i]){\n            tmp.push(s[i]-'0');\n        }\n    }\n    while(tmp.size()){\n        p2 += tmp.top();\n        tmp.pop();\n    }\n\n    //cout <<p1 << \" \" << p2 << endl;\n\n    if(p1 == res && p2 == res){\n        cout << \"U\" << endl;\n    }else if(p1 == res){\n        cout << \"L\" << endl;\n    }else if(p2 == res){\n        cout << \"M\" << endl;\n    }else{\n        cout << \"I\" << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<fstream>\n#include<stdio.h>\n#include<string>\n#include<vector>\n#include<map>\n#include<math.h>\n#include<algorithm>\n#include<iomanip>\n#include<set>\n#include<utility>\n\nusing namespace std;\n\nint main() {\n  string s;\n  cin >> s;\n  long long ans;\n  cin >> ans;\n  long long mfans = 0, flans = 0;\n  int num = 0;\n  bool b = true;\n  char ls = '+';\n  for(int i = 0; i < s.size(); i++) {\n    if(b) {\n      num = s[i] - '0';\n      b = false;\n    } else {\n      if(s[i] == '+' || s[i] == '*') {\n        if(ls == '+') flans += num;\n        else flans *= num;\n        ls = s[i];\n        b = true;\n      } else {\n        num = num * 10 + s[i] - '0';\n      }\n    }\n  }\n  if(ls == '+') flans += num;\n  else flans *= num;\n  \n  string ss = \"0+\" + s + \"+0\";\n  while(true) {\n    bool bb = false;\n    for(int i = 0; i < ss.size(); i++) {\n      if(ss[i] == '*') {\n        int k = i - 1;\n        for(; k > 0; k--) if(ss[k] == '+' || ss[k] == '*') {\n          k++;\n          break;\n        }\n        int l = i + 1;\n        for(; l < ss.size(); l++) if(ss[l] == '+' || ss[l] == '*') {\n          l--;\n          break;\n        }\n        int lhs = stoi(ss.substr(k, i - k));\n        int rhs = stoi(ss.substr(i + 1, l - i));\n        ss = ss.substr(0, k) + to_string(lhs * rhs) + ss.substr(l + 1, ss.size());\n        bb = true;\n        break;\n      }\n    }\n    if(!bb) break;\n  }\n  num = 0;\n  b = true;\n  for(int i = 0; i < ss.size(); i++) {\n    if(b) {\n      num = ss[i] - '0';\n      b = false;\n    } else {\n      if(ss[i] == '+') {\n        mfans += num;\n        b = true;\n      } else {\n        num = num * 10 + ss[i] - '0';\n      }\n    }\n  }\n  mfans += num;\n  \n  \n  if(flans == ans && mfans == ans) cout << \"U\" << endl;\n  else if(mfans == ans) cout << \"M\" << endl;\n  else if(flans == ans) cout << \"L\" << endl;\n  else cout << \"I\" << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 29;\n\nstring s;\nsize_t cur=0;\n\nint digit(){\n\tint d=(s[cur++]-'0');\n\treturn d;\n}\n\nint number(){\n\tint res=digit();\n\tint n=s.size();\n\twhile(cur<n&&isdigit(s[cur])){\n\t\tres=10*res+digit();\n\t}\n\treturn res;\n}\n\nint lr(){\n\tint res=number();\n\tint n=s.size();\n\twhile(cur<n){\n\t\tchar op=s[cur++];\n\t\tint arg=number();\n\t\tif(op=='+')\n\t\t\tres+=arg;\n\t\telse\n\t\t\tres*=arg;\n\t}\n\treturn res;\n}\n\nint add(){\n\tint res=number();\n\tint n=s.size();\n\twhile(cur<n&&s[cur]=='*'){\n\t\tcur++;\n\t\tint arg=number();\n\t\tres*=arg;\n\t}\n\treturn res;\n}\n\nint mul(){\n\tint res=add();\n\tint n=s.size();\n\twhile(cur<n&&s[cur]=='+'){\n\t\tcur++;\n\t\tint arg=add();\n\t\tres+=arg;\n\t}\n\treturn res;\n}\nint main(void){\n\tcin >> s;\n\tint in;\n\tcin >> in;\n\n\tcur=0;\n\tbool res=(lr()==in);\n\tcur=0;\n\tbool res2=(mul()==in);\n\n\tif(res&res2)\n\t\tputs(\"U\");\n\telse if(res)\n\t\tputs(\"L\");\n\telse if(res2)\n\t\tputs(\"M\");\n\telse\n\t\tputs(\"I\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main(){\n\tstring str;\n\tint n;\n\tcin >> str >> n;\n\tchar x = 'x';\n\tint f = 0, s = 0;\n\tint num[10];\n\tbool used[10];\n\trep(i,10) used[i] = false;\n\tchar ope[10];\n\tfor(int i = 0; i < str.size(); i++){\n\t\tif(i%2 == 0){\n\t\t\tnum[i/2] = str[i]-'0';\n\t\t} else{\n\t\t\tope[i/2] = str[i];\n\t\t}\n\t}\n\tint t = -1;\n\tfor(int i = 0; i < str.size()/2; i++){\n\t\tif(ope[i] == '*'){\n\t\t\tif(t == -1){\n\t\t\t\tt = num[i]*num[i+1];\n\t\t\t\tused[i] = true;\n\t\t\t\tused[i+1] = true;\n\t\t\t} else{\n\t\t\t\tt *= num[i+1];\n\t\t\t\tused[i+1] = true;\n\t\t\t}\n\t\t} else{\n\t\t\tif(t != -1) f += t;\n\t\t\tt = -1;\n\t\t}\n\t}\n\tfor(int i = 0; i < (str.size()+1)/2; i++){\n\t\tif(!used[i]) f += num[i];\n\t}\n\tfor(int i = 0; i < str.size(); i++){\n\t\tif(i%2 == 0){\n\t\t\tif(x == 'x') s = str[i]-'0';\n\t\t\tif(x == '+') s += str[i]-'0';\n\t\t\tif(x == '*') s *= str[i]-'0';\n\t\t} else{\n\t\t\tx = str[i];\n\t\t}\n\t}\n\tif(s == n){\n\t\tif(f == n) cout << \"U\" << endl;\n\t\telse cout << \"L\" << endl;\n\t} else{\n\t\tif(f == n) cout << \"M\" << endl;\n\t\telse cout << \"I\" << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "/*?????????????????¨??????????????????????????§?????????????????????????¨?????????????*/\n/*\n????§£??????\n????????????????????????????¨??????????????????????????????????\n?????????????????????????????????????????????????????????????????§??????????????¨??£????????????????????£??????????¨?????¶?????????????\n*/\n#include <bits/stdc++.h>\nusing namespace std;\n\nint main(void)\n{\n    int n;\n    int product,sum1,sum2=0,ans; //?????????????????????????????????????????????(??\\???)\n    char c;\n\n    cin>>product;\n    sum1=product;\n    while(1){\n        c=getchar();\n\n        //?????????????????§?????????????????????????¶????\n        if(c=='\\n'){\n            sum2+=product;\n            break;\n        }\n\n        cin>>n;\n\n        switch(c){\n        case '+':\n            sum1+=n;\n            sum2+=product;\n            product=n;\n            break;\n        case '*':\n            sum1*=n;\n            product*=n;\n            break;\n        }\n    }\n    cin>>ans;\n\n    /*??\\????????°????????????????????¨???????????????U?????????????????????????????????L????????????????????????????????????M???????????????????????????I?????????*/\n    if(sum1==ans) c=(sum1==sum2 ? 'U' : 'L');\n    else if(sum2==ans) c='M';\n    else c='I';\n    cout<<c<<endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \nstruct M{\n    string s;\n    string::iterator it;\n \n    void init(const string &str){\n\ts = str;\n\tit = s.begin();\n    }\n \n    int fact(){\n\tint res = 0;\n\twhile(isdigit(*it)){\n\t    res *= 10;\n\t    res += *it-'0';\n\t    ++it;\n\t}\n\treturn res;\n    }  \n \n    int exp(){\n\tint res = term();\n\twhile(*it == '+'){\n\t    ++it;\n\t    res += term();\n \n\t}\n\treturn res;\n    }\n \n    int term(){\n\tint res = fact();\n\twhile(*it == '*'){\n\t    ++it;\n\t    res *= fact();\n\t}\n\treturn res;\n    }\n};\n \nstruct L{\n    string s;\n    string::iterator it;\n \n    void init(const string &str){\n\ts = str;\n\tit = s.begin();\n    }\n \n    int fact(){\n\tint res = 0;\n\twhile(isdigit(*it)){\n\t    res *= 10;\n\t    res += *it-'0';\n\t    ++it;\n\t}\n\treturn res;\n    }  \n \n    int calc(){\n\tint res = fact();\n\twhile(*it == '+' || *it == '*'){\n\t    if(*it == '+'){\n\t\t++it;\n\t\tres += exp();\n\t    }else{\n\t\t++it;\n\t\tres *= term();\n\t    }\n\t}\n\treturn res;\n    }\n \n    int exp(){\n\tint res = fact();\n\twhile(*it == '+'){\n\t    ++it;\n\t    res += fact();\n\t}\n\treturn res;\n    }\n \n    int term(){\n\tint res = fact();\n\twhile(*it == '*'){\n\t    ++it;\n\t    res *= fact();\n\t}\n\treturn res;\n    }\n};\n \nint main(){\n    int ans;\n    string s;\n    cin >> s >> ans; \n    M m; m.init(s); \n    L l; l.init(s);\n    int Mres = m.exp(), Lres = l.calc();\n \n    if(Mres == ans && Lres != ans){\n\tcout << 'M' << endl;\n    }else if(Mres != ans && Lres == ans){\n\tcout << 'L' << endl;\n    }else if(Mres == ans && Lres == ans){\n\tcout << 'U' << endl;\n    }else{\n\tcout << 'I' << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing vi=vector<int>;\n#define all(a) a.begin(),a.end()\n\nint main(){\n\tint l=0,n=0,p;\n\tvector<int> a(1);\n\tstring s;\n\tcin>>s>>p;\n\t\n\tl=a[0]= s[0]-'0';\n\tfor(int i=2; i<s.size() ;i+=2){\n\t\tint t=s[i]-'0';\n\t\tif(s[i-1]=='*'){\n\t\t\tl*=t;\n\t\t\ta.back()*=t;\n\t\t}else{\n\t\t\tl+=t;\n\t\t\ta.push_back(t);\n\t\t}\n\t}\n\tn=accumulate(all(a),0);\n\tcout<<\"ILMU\"[(l==p?1:0) + (n==p?2:0)]<<endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\nusing namespace std;\n\nint main() {\n\n  string in;\n  cin >> in;\n\n  long long int a;\n  cin >> a;\n\n  long long int k = 0;\n  char c = '+';\n  long long int n = 1;\n  long long int ans_0 = 0;\n  long long int ans_1 = 0;\n\n  for ( long long int i = 0; i < in.size(); i++ ) {\n\n    if ( in[i] == '+' ) {\n\n      if ( c == '+' ) {\n\tans_0 += k;\n      }else {\n\tans_0 *= k;\n      }\n      c = '+';\n      n *= k;\n      ans_1 += n;\n      k = 0;\n      n = 1;\n\n    }else if ( in[i] == '*' ) {\n\n      if ( c == '+' ) {\n\tans_0 += k;\n      }else {\n\tans_0 *= k;\n      }\n      c = '*';\n      n *= k;\n      k = 0;\n\n    }else {\n\n      k = k * 10 + in[i] - '0';\n\n    }\n\n  }\n\n  ans_0 += k;\n  n *= k;\n  ans_1 += n;\n\n  string s = \"ILMU\";\n\n  k = 0;\n\n  if ( a == ans_0 ) k++;\n  if ( a == ans_1 ) k +=2 ;\n\n  cout << s[k] << endl;\n\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n\nusing namespace std;\n\nint mf(string s){\n\n    while(1){\n        bool ok=true;\n        for(int i=0; i<s.size(); i++) ok&=(s[i]!='*');\n        if(ok) break;\n        for(int i=0; i<s.size(); i++){\n            if(s[i]=='*'){\n                int v=(s[i-1]-'0')*(s[i+1]-'0');\n                s=s.substr(0, i-1)+(char)(v+'0')+s.substr(i+2);\n            }\n        }\n    }\n    int ret=(s[0]-'0');\n    for(int i=1; i+1<s.size(); i+=2){\n        ret+=(s[i+1]-'0');\n    }\n    return ret;\n}\n\nint ltr(string s){\n\n    int ret=(s[0]-'0');\n    for(int i=1; i+1<s.size(); i+=2){\n        if(s[i]=='+') ret+=(s[i+1]-'0');\n        else ret*=(s[i+1]-'0');\n    }\n\n    return ret;\n}\n\nint main(){\n\n    string s;\n    int r;\n    cin>> s>> r;\n\n    int x=mf(s);\n    int y=ltr(s);\n\n    if(x==r&&y==r){\n        cout<< \"U\"<< endl;\n    }else if(x==r){\n        cout<< \"M\"<< endl;\n    }else if(y==r){\n        cout<< \"L\"<< endl;\n    }else{\n        cout<< \"I\"<< endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n\tstring S;\n\tcin>>S;\n\tlong long int N;\n\tcin>>N;\n\tbool f0=0,f1=0;\n\tstringstream SS;\n\tSS<<S;\n\tlong long int ans,num;\n\tchar x;\n\tSS>>ans;\n\tvector<long long int>data;\n\tvector<char>p;\n\tdata.push_back(ans);\n\twhile(SS >> x >> num)\n\t{\n\t\tp.push_back(x);\n\t\tdata.push_back(num);\n\t\tif(x=='*')\n\t\t{\n\t\t\tans*=num;\n\t\t} else\n\t\t{\n\t\t\tans+=num;\n\t\t}\n\t}\n\tif(ans==N)\n\t{\n\t\tf0=1;\n\t}\n\tans=0;\n\tfor(size_t i = 0; i < p.size(); i++)\n\t{\n\t\tif(p[i]=='*')\n\t\t{\n\t\t\tdata[i+1]*=data[i];\n\t\t\tdata[i]=0;\n\t\t}\n\t}\n\tfor(auto z : data)\n\t{\n\t\tans+=z;\n\t}\n\tif(ans == N)\n\t{\n\t\tf1 = 1;\n\t}\n\tif(f0&&f1)\n\t{\n\t\tcout<<'U'<<endl;\n\t} else if(f0)\n\t{\n\t\tcout<<'L'<<endl;\n\t} else if(f1)\n\t{\n\t\tcout<<'M'<<endl;\n\t} else\n\t{\n\t\tcout<<'I'<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double ld;\ntypedef pair<ll, ll> P;\n\n#define EACH(i,a) for (auto& i : a)\n#define FOR(i,a,b) for (ll i=(a);i<(b);i++)\n#define RFOR(i,a,b) for (ll i=(b)-1;i>=(a);i--)\n#define REP(i,n) for (ll i=0;i<(n);i++)\n#define RREP(i,n) for (ll i=(n)-1;i>=0;i--)\n#define debug(x) cout<<#x<<\": \"<<x<<endl\n#define pb push_back\n#define ALL(a) (a).begin(),(a).end()\n\nconst ll linf = 1e18;\nconst int inf = 1e9;\nconst double eps = 1e-12;\nconst double pi = acos(-1);\n\ntemplate<typename T>\nistream& operator>>(istream& is, vector<T>& vec) {\n\tEACH(x,vec) is >> x;\n\treturn is;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, vector<T>& vec) {\n\tREP(i,vec.size()) {\n\t\tif (i) os << \" \";\n\t\tos << vec[i];\n\t}\n\treturn os;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, vector< vector<T> >& vec) {\n\tREP(i,vec.size()) {\n\t\tif (i) os << endl;\n\t\tos << vec[i];\n\t}\n\treturn os;\n}\n\nll L(string s) {\n\tint N = s.size();\n\tll res = s[0]-'0';\n\tfor (int i = 2; i < N; i += 2) {\n\t\tint v = s[i]-'0';\n\t\tif (s[i-1] == '+') {\n\t\t\tres += v;\n\t\t}\n\t\telse {\n\t\t\tres *= v;\n\t\t}\n\t\tres = min(res, (ll)inf);\n\t}\n\treturn res;\n}\nll M(string s) {\n\tint N = s.size();\n\tll res = 0, p = s[0]-'0';\n\tfor (int i = 2; i < N; i += 2) {\n\t\tint v = s[i]-'0';\n\t\tif (s[i-1] == '+') {\n\t\t\tres += p;\n\t\t\tp = v;\n\t\t}\n\t\telse {\n\t\t\tp *= v;\n\t\t}\n\t\tp = min(p, (ll)p);\n\t\tres = min(res, (ll)inf);\n\t}\n\tres += p;\n\tres = min(res, (ll)inf);\n\treturn res;\n}\n\nint main() {\n\tstd::ios::sync_with_stdio(false);\n\tstd::cin.tie(0);\n\tstring s; cin >> s;\n\tll a; cin >> a;\n//\tcout << M(s) << \" \" << L(s) << endl;\n\tif ( M(s) == a && L(s) == a ) {\n\t\tcout << \"U\" << endl;\n\t}\n\telse if ( M(s) == a ) {\n\t\tcout << \"M\" << endl;\n\t}\n\telse if ( L(s) == a ) {\n\t\tcout << \"L\" << endl;\n\t}\n\telse {\n\t\tcout << \"I\" << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\n#define rep(i,n) for(int i=0;i<n;i++)\n#define Rep(i,a,b) for(int i=a;i<b;i++)\n#define REP(i,a,b) for(int i=a;i<=b;i++)\n#define itrep(it,v) for(auto it=(v).begin();it!=(v).end();it++)\n#define rev(i,n) for(int i=n-1;i>=0;i--)\n#define vi vector<int>\n#define pb push_back\n#define pi pair<int,int>\n#define vp vector<pair<int,int> >\n#define mp make_pair\n#define all(v) (v).begin(),(v).end()\nusing namespace std;\n\n            \nsigned main(){\n    string s;\n    int a;\n    cin>>s>>a;\n    int b=s[0]-'0';\n    for(int i=1;i<s.length();i+=2){\n        if(s[i]=='+')b=b+(s[i+1]-'0');\n        else b=b*(s[i+1]-'0');\n    }\n    stack<int> st;\n    st.push(s[0]-'0');\n    for(int i=1;i<s.length();i+=2){\n        if(s[i]=='+')st.push(s[i+1]-'0');\n        else{\n            int t=st.top();\n            st.pop();\n            st.push(t*(s[i+1]-'0'));\n        }\n    }\n    int c=0;\n    while(!st.empty()){\n        c+=st.top();\n        st.pop();\n    }\n    if(b==a&&c==a)cout<<\"U\"<<endl;\n    else if(b==a)cout<<\"L\"<<endl;\n    else if(c==a)cout<<\"M\"<<endl;\n    else cout<<\"I\"<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing i64 = int64_t;\n\nint calc_left_to_right(string s){\n    int res = s[0] - '0';\n    for(int i=1;i<s.size();i+=2){\n        if(s[i] == '+'){\n            res += s[i+1] - '0';\n        }else{\n            res *= s[i+1] - '0';\n        }\n    }\n    return res;\n}\n\nint calc_mul_first(string s){\n    stack<int> stk;\n    stk.push(s[0]-'0');\n    for(int i=1;i<s.size();i+=2){\n        if(s[i] == '+'){\n            stk.push(s[i+1]-'0');\n        }else{\n            int n = stk.top(); stk.pop();\n            stk.push((s[i+1]-'0')*n);\n        }\n    }\n    int res = 0;\n    while(!stk.empty()){\n        res += stk.top();\n        stk.pop();\n    }\n    return res;\n}\n\nint main(){\n    string expr;\n    int ans;\n    cin >> expr >> ans;\n    int a = calc_left_to_right(expr), b = calc_mul_first(expr);\n    char c;\n    if(a == ans && b == ans)c = 'U';\n    else if(a == ans)c = 'L';\n    else if(b == ans)c = 'M';\n    else c = 'I';\n    cout << c << endl;\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<ll> VL;\ntypedef vector<VL> VVL;\ntypedef pair<int, int> PII;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define MP make_pair\n#define PB push_back\n#define MOD 1000000007\n#define INF (1LL<<30)\n#define LLINF (1LL<<60)\n#define PI 3.14159265359\n#define EPS 1e-12\n//#define int ll\n\nVI a, b;\nbool d[100010];\nsigned main(void)\n{\n\tstring s, t = \"\";\n\tint m;\n\tcin >> s >> m;\n\tREP(i, s.size()) {\n\t\tif(s[i] == '+') {\n\t\t\ta.PB(stoi(t));\n\t\t\tb.PB(1);\n\t\t\tt = \"\";\n\t\t} else if(s[i] == '*') {\n\t\t\ta.PB(stoi(t));\n\t\t\tb.PB(0);\n\t\t\tt = \"\";\n\t\t} else {\n\t\t\tt += s[i];\n\t\t}\n\t}\n\ta.PB(stoi(t));\n\t//for(int i: a) cout << i << \" \"; cout << endl;\n\t//for(int i: b) cout << i << \" \"; cout << endl;\n\n\tbool f1 = false, f2 = false;\n\tint c = a[0];\n\tREP(i, b.size()) {\n\t\tif(b[i]) {\n\t\t\tc += a[i+1];\n\t\t} else {\n\t\t\tc *= a[i+1];\n\t\t}\n\t}\n\t//cout << c << \" \";\n\tif(c == m) f1 = true;\n\n\tVI e;\n\tbool con = false;\n\tc = 0;\n\tREP(i, b.size()) {\n\t\tif(!b[i]) {\n\t\t\tif(!con) c = a[i]*a[i+1];\n\t\t\telse c *= a[i+1];\n\t\t\td[i] = d[i+1] = true;\n\t\t\tcon = true;\n\t\t} else {\n\t\t\te.PB(c);\n\t\t\tc = 0;\n\t\t\tcon = false;\n\t\t}\n\t}\n\te.PB(c);\n\tREP(i, a.size()) {\n\t\tif(!d[i]) e.PB(a[i]);\n\t}\n\tint ret = 0;\n\tfor(int i: e) ret += i;\n\t//cout << ret << endl;\n\t//for(int i: e) cout << i << \" \"; cout << endl;\n\tif(ret == m) f2 = true;\n\n\tif(f1 && f2) cout << \"U\" << endl;\n\telse if(!f1 && !f2) cout << \"I\" << endl;\n\telse if(f1 && !f2) cout << \"L\" << endl;\n\telse if(!f1 && f2) cout << \"M\" << endl;\n\telse assert(false);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <stdio.h>\nusing namespace std;\nstring s;\nlong long ans;\nint cur;\nlong long suu(){\n  string num = \"\";\n  while(cur < s.size() && '0' <= s[cur] && s[cur] <= '9' ){\n\tfflush(stdout);\n\tnum += s[cur];\n\tcur++;\n  }\n\n  return stoll(num);\n}\nlong long kou(){\n  long long res = suu();\n  if(cur < s.size() && s[cur] == '*'){\n\tcur++;\n\tres *= kou();\n  }\n  return res;\n}\nlong long siki(){\n  long long res = kou();\t\n  if(cur < s.size() && s[cur] == '+'){\n\tcur++;\n\tres += siki();\n\n  }\n  return res;\n}\nlong long left_siki(){\n  long long res = suu();\n  char op;\n  while( cur < s.size() && ((op = s[cur]) == '+' || (op == '*') ) ){\n\tcur++;\n\tif(op == '+'){\n\t  res += suu();\n\t}else if(op == '*'){\n\t  res *=  suu();\n\t}\n  }\n  return res;\n}\nint main(){\n  cur = 0;\n  cin >> s >> ans;\n  long long res1 = siki();\n\n  cur = 0;\n  long long res2 = left_siki();\n  \n  int flag = 0;\n  if(res1 == ans){\n\tflag = 1;\n  }\n  if(res2 == ans){\n\tflag |= 2;\n  }\n\n  if(flag == 0)cout << \"I\" << endl;\n  else if(flag == 3)cout << \"U\" << endl;\n  else if(flag == 1) cout << \"M\" << endl;\n  else if(flag == 2) cout << \"L\" << endl;\n  \n  return 0;\n  \n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <complex>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <deque>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <vector>\n#include <set>\n#include <limits>\n#include <cstdio>\n#include <cctype>\n#include <cmath>\n#include <cstring>\n#include <cstdlib>\n#include <ctime>\nusing namespace std;\n#define REP(i, j) for(int i = 0; i < (int)(j); ++i)\n#define FOR(i, j, k) for(int i = (int)(j); i < (int)(k); ++i)\n#define SORT(v) sort((v).begin(), (v).end())\n#define REVERSE(v) reverse((v).begin(), (v).end())\ntypedef pair<int, char *> P;\n\nP fact(char *p);\nP term(char *p);\nP expr(char *p);\n\nP fact(char *p){\n  if(isdigit(*p)){\n    int t = *(p++) - '0';\n    while(isdigit(*p)) t = t * 10 + *(p++) - '0';\n    return P(t, p);\n  } else if(*p == '('){\n    P r = expr(p + 1);\n    if(*r.second != ')') exit(0); //閉じ括弧が無いエラー\n    return P(r.first, r.second + 1);\n  } else{\n    exit(0); //括弧でも数字でもないエラー\n  }\n}\n\nP term(char *p){\n  P r = fact(p);\n  while(*r.second == '*' || *r.second == '/'){\n    char op = *r.second;\n    int tmp = r.first;\n    r = fact(r.second + 1);\n    if(op == '*') r.first *= tmp;\n    else r.first /= tmp;\n  }\n  return r;\n}\n\nP expr(char *p){\n  P r = term(p);\n  while(*r.second == '+' || *r.second == '-'){\n    char op = *r.second;\n    int tmp = r.first;\n    r = term(r.second + 1);\n    if(op == '+') r.first = tmp + r.first;\n    else r.first = tmp - r.first;\n  }\n  return r;\n}\n\nint num(string s, int &p){\n  int res = 0;\n  while(p < (int)(s.length()) && isdigit(s[p])){\n    res *= 10;\n    res += s[p++] - '0';\n  }\n  return res;\n}\n\nint calc(string s){\n  int p = 0, res = num(s, p);\n  while(p < s.length()){\n    char c = s[p++];\n    int n = num(s, p);\n    if(c == '+') res += n;\n    else res *= n;\n  }\n  return res;\n}\n\nint main() {\n  string s; cin >>s;\n  int res; cin >>res;\n  char *cs = new char[(int)(s.length()) + 1];\n  strcpy(cs, s.c_str());\n  P tmp = expr(cs);\n  int n = calc(s);\n  if(tmp.first == res && n != res) cout <<\"M\" <<endl;\n  else if(tmp.first != res && n == res) cout <<\"L\" <<endl;\n  else if(tmp.first == res && n == res) cout <<\"U\" <<endl;\n  else cout <<\"I\" <<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\nint calc1(string str){//multiplication-first\n\tstack<int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push((int)stoi(rststr));\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t\tint tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\tint rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nint calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tint rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nint calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\tint rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\twhile(cin >> str){\n\t\tcin >> str;\n\t\tint ans;\n\t\tcin >> ans;\n\t\tint rst1 = calc2(str);\n\t\tint rst2 = calc3(str);\n\t\t//cout << rst1 << \" \" << rst2 << endl;\n\t\tif(rst1==ans){\n\t\t\tif(rst2==ans) cout << 'U' << endl;\n\t\t\telse cout << 'M' << endl;\n\t\t}else{\n\t\t\tif(rst2==ans) cout << 'L' << endl;\n\t\t\telse cout << 'I' << endl;\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstring str;\nint n;\n\nint calcM(int pos)\n{\n    stack <int> st;\n    st.push(str[pos] - '0');\n    for (int i = pos + 1; i < str.length(); i++){\n        if (str[i] == '+'){\n            continue;\n        }\n        else if (str[i] == '*'){\n            int a = st.top(); st.pop();\n            i++;\n            a *= (str[i] - '0');\n            st.push(a);\n        }\n        else {\n            st.push(str[i] - '0');\n        }\n    }\n    \n    int ret = 0;\n    for (int i = 0; !st.empty(); i++){\n        ret += st.top();\n        st.pop();\n    }\n    return ret;\n}\n\nint calcL(int pos)\n{\n    stack <int> st;\n    st.push(str[pos] - '0');\n    for (int i = pos + 1; i < str.length(); i++){\n        if (str[i] == '+'){\n            int a = st.top(); st.pop();\n            i++;\n            a += (str[i] - '0');\n            st.push(a);\n        }\n        else if (str[i] == '*'){\n            int a = st.top(); st.pop();\n            i++;\n            a *= (str[i] - '0');\n            st.push(a);\n        }\n    }\n    \n    return st.top();\n}\n\nint main(void)\n{\n    cin >> str >> n;\n    \n    int retM = calcM(0);\n    int retL = calcL(0);\n    \n    if (retM == n && retL != n){\n        cout << \"M\" << endl;\n    }\n    else if (retM != n && retL == n){\n        cout << \"L\" << endl;\n    }\n    else if (retM == n && retL == n){\n        cout << \"U\" << endl;\n    }\n    else {\n        cout << \"I\" << endl;\n    }\n    \n    \n    return 0;\n    \n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n \n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n \nstring gettopnum(string str){\n    string rst = \"\";\n    REP(i,str.size()){\n        if(str[i]=='*'||str[i]=='+') break;\n        else rst += str[i];\n    }\n    return rst;\n}\nll int calc1(string str){//multiplication-first\n    stack<ll int> st;\n    string rststr = gettopnum(str);\n    if(rststr!=\"\") st.push((ll int)stoi(rststr));\n    if(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n    while(str.size()!=0){\n        //cout << str << endl;\n        if(str[0]=='*'){\n            str.erase(str.begin(),str.begin()+1);\n            ll int tmp = stoi(gettopnum(str));\n            str.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n            ll int tmp2 = st.top();\n            st.pop();\n            st.push(tmp*tmp2);\n        }else if(str[0]=='+'){\n            str.erase(str.begin(),str.begin()+1);\n            ll int tmp = stoi(gettopnum(str));\n            st.push(tmp);\n            str.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n        }\n    }\n    ll int rst = 0;\n    while(!st.empty()){\n        rst += st.top();\n        st.pop();\n    }\n    return rst;\n}\n \nll int calc2(string str){////multiplication-first2\n    //cout << str << endl;\n    string rststr = gettopnum(str);\n    ll int rst;\n    if(rststr!=\"\") rst = stoi(rststr);\n    if(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)rst)+1);\n    if(str.size()==0) return rst;\n    else if(str[0]=='*') {\n        str.erase(str.begin(),str.begin()+1);\n        return rst*calc2(str);\n    }else if(str[0]=='+'){\n        str.erase(str.begin(),str.begin()+1);\n        return rst+calc2(str);\n    }\n    //dummy\n    return -1;\n}\n \nll int calc3(string str){//leftto-right\n    string rststr = gettopnum(str);\n    if(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n    ll int rst = stoi(rststr);\n    while(str.size()!=0){\n        //cout << str << endl;\n        if(str[0]=='*'){\n            str.erase(str.begin(),str.begin()+1);\n            ll int tmp = stoi(gettopnum(str));\n            rst *= tmp;\n            str.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n        }else if(str[0]=='+'){\n            str.erase(str.begin(),str.begin()+1);\n            ll int tmp = stoi(gettopnum(str));\n            rst += tmp;\n            str.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n        }\n    }\n    return rst;\n}\n \nint main(){\n    string str;\n    cin >> str;\n    ll int ans;\n    cin >> ans;\n    ll int rst1 = calc1(str);\n    ll int rst2 = calc3(str);\n    //cout << rst1 << \" \" << rst2 << endl;\n    if(rst1==ans){\n        if(rst2==ans) cout << 'U' << endl;\n        else cout << 'M' << endl;\n    }else{\n        if(rst2==ans) cout << 'L' << endl;\n        else cout << 'I' << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n\nusing namespace std;\n\npair<int,int> factor(string s, int i) {\n  int num = s[i] - '0';\n  while(++i < s.size() && s[i] == '*') {\n    num *= s[++i] - '0';\n  }\n  return make_pair(num, i);\n}\n\nint expr(string s) {\n  int num, i;\n  tie(num, i) = factor(s, 0);\n  while(i < s.size()) {\n    int p, j;\n    tie(p, j) = factor(s, i+1);\n    num += p;\n    i = j;\n  }\n  return num;\n}\n\nint expr2(string s) {\n  int i = 0;\n  int num = s[i] - '0';\n  while(++i < s.size()) {\n    if (s[i] == '*')\n      num *= s[++i] - '0';\n    else\n      num += s[++i] - '0';\n  }\n  return num;\n}\n\nint main() {\n  string s;\n  cin>>s;\n  int ans;\n  cin>>ans;\n  int bob = expr2(s);\n  int calc = expr(s);\n  if (ans == bob) {\n    if (ans == calc) {\n      cout << 'U' << endl;\n    } else {\n      cout << 'L' << endl;\n    }\n  } else {\n    if (ans == calc) {\n      cout << 'M' << endl;\n    } else {\n      cout << 'I' << endl;\n    }\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "/* attention to typo and overflow */\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <queue>\n#include <iostream>\n#include <cmath>\n#include <cstdio>\n\nusing namespace std;\nconst int INF=1<<25;\nvoid io(){ cin.tie(0);ios::sync_with_stdio(false);} //attention to use of endl\n/*printf(\"%.9Lf\\n\",cf);*/\nchar output(bool i,bool j){\n\tif(i==1 && j==0){\n\t\treturn 'M';\n\t}\n\tif(i==0 && j==1){\n\t\treturn 'L';\n\t}\n\tif(i==0 && j==0){\n\t\treturn 'I';\n\t}\n\tif(i==1 && j==1){\n\t\treturn 'U';\n\t}\n\treturn 'N';\n}\n\nint main(){\n\tio();\n\tstring s;\n\tgetline(cin,s);\n\t//cin.ignore();\n\tint ans;\n\tcin>>ans;\n\n\tvector <int> plus;\n\tfor(int i=0;i<s.size();i++){\n\t\tif(i%2==0){\n\t\t\tif(i!=0 && s[i-1]=='*'){\n\t\t\t\tplus[plus.size()-1]*=s[i]-'0';\n\t\t\t}else{\n\t\t\t\tplus.push_back(s[i]-'0');\n\t\t\t}\n\t\t}\n\t}\n\n\tint one=0;\n\tfor(int i=0;i<plus.size();i++){\n\t\t//cerr<<plus[i]<<endl;\n\t\tone+=plus[i];\n\t}\n\n\tint two=s[0]-'0';\n\tfor(int i=1;i<s.size();i++){\n\t\tif(i%2==0){\n\t\t\tif(s[i-1]=='+'){\n\t\t\t\ttwo+=s[i]-'0';\n\t\t\t}else{\n\t\t\t\ttwo*=s[i]-'0';\n\t\t\t}\n\t\t}\n\t}\n\n\tcerr<<ans<<' '<<one<<' '<<two<<endl;\n\n\tcout<<output(ans==one,ans==two)<<endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-9;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\nint a = 0;\nstring st;\nlong long int getnum() {\n\tlong long int num = 0;\n\twhile (isdigit(st[a])) {\n\t\tnum = num * 10 + st[a] - '0';\n\t\ta++;\n\t}\n\treturn num;\n}\n\nlong long int getexpr0() {\n\tlong long int num(getnum());\n\twhile (a != st.size()) {\n\t\tif (st[a] == '+') {\n\t\t\ta++;\n\t\t\tlong long int bnum = getnum();\n\t\t\tnum += bnum;\n\t\t}\n\t\telse {\n\t\t\ta++;\n\t\t\tlong long int bnum = getnum();\n\t\t\tnum *= bnum;\n\t\t}\n\t}\n\treturn num;\n\n}\nlong long int getkake() {\n\tlong long int num(getnum());\n\twhile (a != st.size()) {\n\t\tif (st[a] == '*') {\n\t\t\ta++;\n\t\t\tlong long int bnum = getnum();\n\t\t\tnum *= bnum;\n\t\t}\n\t\telse {\n\t\t\treturn num;\n\t\t}\n\t}\n\treturn num;\n\n}\nlong long int getplus() {\n\tlong long int num(getkake());\n\twhile (a != st.size()) {\n\t\tif (st[a] == '+') {\n\t\t\ta++;\n\t\t\tlong long int bnum = getkake();\n\t\t\tnum += bnum;\n\t\t}\n\t\telse {\n\t\t\tassert(false);\n\t\t}\n\t}\n\treturn num;\n\n}\nint main() {cin >> st;\na = 0;\nint n; cin >> n;\n   long long  int aa=getexpr0();\n   a = 0;\n\tlong long int bb = getplus();\n\tif (aa == n&&bb == n) {\n\t\tcout << \"U\" << endl;\n\t}\n\telse if (aa == n) {\n\t\tcout << \"L\" << endl;\n\t}\n\telse if (bb == n) {\n\t\tcout << \"M\" << endl;\n\t}\n\telse {\n\t\tcout << 'I' << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <utility>\n#include <cmath>\n#include <algorithm>\n#include <iostream>\n#include <sstream>\n#include <iomanip>\n#include <vector>\n#include <string>\n#define REP(i,n) for(int i=0;i<n;i++)\ntypedef long long ll;\nusing namespace std;\ntypedef vector<ll> vl;\ntypedef pair<ll,ll> pll;\ntypedef vector<pll> vpll;\ntypedef vector<string> vs;\n\nint main() \n{\n\t//入力\n\tstring s;cin>>s;\n\tll ans;cin>>ans;\n\t\n\t//まずはかけ算\n\tll ans1(0);\n\tint tmp(1);\n\t\n\tif(s.length()==1)\n\t{\n\t\tans1=s[0]-'0';\n\t}\n\telse\n\t{\n\t\tfor(int i=0;i<(s.length())/2;i++)\n\t\t{\n\t\t\tif(i==0)\n\t\t\t{\n\t\t\t\tif(s[i*2+1]=='+')\n\t\t\t\t{\n\t\t\t\t\tans1+=s[i*2]-'0';\n\t\t\t\t\tif(i==(-3+s.length())/2)\n\t\t\t\t{\n\t\t\t\t\tans1+=s[i*2+2]-'0';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttmp*=s[i*2]-'0';\n\t\t\t\tif(i==(-3+s.length())/2)\n\t\t\t\t{\n\t\t\t\t\ttmp*=s[i*2+2]-'0';\n\t\t\t\t\tans1+=tmp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(s[i*2+1]=='+')\n\t\t\t{\n\t\t\t\tif(s[i*2-1]=='*')\n\t\t\t\t{\n\t\t\t\t\ttmp*=s[i*2]-'0';\n\t\t\t\t\tans1+=tmp;tmp=1;\n\t\t\t\t\tif(i==(-3+s.length())/2)\n\t\t\t\t\t{\n\t\t\t\t\t\tans1+=s[i*2+2]-'0';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tans1+=s[i*2]-'0';\n\t\t\t\t\tif(i==(-3+s.length())/2)\n\t\t\t\t\t{\n\t\t\t\t\t\tans1+=s[i*2+2]-'0';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttmp*=s[i*2]-'0';\n\t\t\t\tif(i==(-3+s.length())/2)\n\t\t\t\t{\n\t\t\t\t\ttmp*=s[i*2+2]-'0';\n\t\t\t\t\tans1+=tmp;\n\t\t\t\t}\n\t\t\t}\n\t\t}}\n\t}\n\t\t//足し算\n\tll ans2(0);\n\tif(s.length()==1)\n\t{\n\t\tans2+=s[0]-'0';\n\t}\n\telse\n\t{\n\t\tfor(int i=0;i<(s.length())/2;i++)\n\t\t{\n\t\t\tif(i==0)\n\t\t\t{\n\t\t\t\tif(s[i*2+1]=='+')\n\t\t\t\t{\n\t\t\t\t\tans2+=s[i*2]-'0'+s[i*2+2]-'0';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tans2+=s[i*2]-'0'+s[i*2+2]-'0';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(s[i*2+1]=='+')\n\t\t\t\t{\n\t\t\t\t\tans2+=s[i*2+2]-'0';\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tans2*=s[i*2+2]-'0';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tbool m =(ans==ans1);\n\tbool l =(ans==ans2);\n\t\t\n\tif(m&&!l){cout<<'M'<<endl;}\n\tif(!m&&l){cout<<'L'<<endl;}\n\tif(m&&l){cout<<'U'<<endl;}\n\tif(!m&&!l){cout<<'I'<<endl;}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define SZ(x) (int)(x.size())\n#define REP(i, n) for(int i=0;i<(n);++i)\n#define FOR(i, a, b) for(int i=(a);i<(b);++i)\n#define RREP(i, n) for(int i=(int)(n)-1;i>=0;--i)\n#define RFOR(i, a, b) for(int i=(int)(b)-1;i>=(a);--i)\n#define ALL(a) a.begin(),a.end()\n#define DUMP(x) cerr<<#x<<\" = \"<<(x)<<endl\n#define DEBUG(x) cerr<<#x<<\" = \"<<(x)<<\" (L\"<<__LINE__<<\")\"<< endl;\nusing ll = long long;\nusing vi = vector<int>;\nusing vvi = vector<vi>;\nusing vll = vector<ll>;\nusing vvll = vector<vll>;\nusing P = pair<int, int>;\nconst double eps = 1e-8;\nconst ll MOD = 1000000007;\nconst int INF = INT_MAX / 2;\nconst ll LINF = LLONG_MAX / 2;\ntemplate <typename T1, typename T2>\nbool chmax(T1 &a, const T2 &b) {\n    if (a < b) { a = b; return true; }\n    return false;\n}\ntemplate <typename T1, typename T2>\nbool chmin(T1 &a, const T2 &b) {\n    if (a > b) { a = b; return true; }\n    return false;\n}\ntemplate<typename T>\nostream &operator<<(ostream &os, const vector<T> &v) {\n    os << \"[\";\n    REP(i, SZ(v)) {\n        if (i) os << \", \";\n        os << v[i];\n    }\n    return os << \"]\";\n}\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const map<T1, T2> &mp) {\n    os << \"{\";\n    int a = 0;\n    for (auto &tp : mp) {\n        if (a) os << \", \"; a = 1;\n        os << tp;\n    }\n    return os << \"}\";\n}\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const pair<T1, T2> &p) {\n    os << p.first << \":\" << p.second;\n    return os;\n}\n\nll term(int& i, const string& s) {\n    ll ret = s[i] - '0';\n    ++i;\n    while (i < s.size() and s[i] == '*') {\n        ++i;\n        ret *= s[i] - '0';\n        ++i;\n    }\n    return ret;\n}\n\nll exp(int& i, const string& s) {\n    ll ret = term(i, s);\n    while (i < s.size() and s[i] == '+') {\n        ++i;\n        ret += term(i, s);\n    }\n    return ret;\n}\n\nint expleft(int& i, const string& s) {\n    ll ret = s[i] - '0';\n    ++i;\n    while (i < s.size()) {\n        if (s[i] == '+') {\n            ++i;\n            ret += s[i] - '0';\n        }\n        else if (s[i] == '*') {\n            ++i;\n            ret *= s[i] - '0';\n        }\n        ++i;\n    }\n    return ret;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(10);\n\n    string s; cin >> s;\n\n    int i = 0;\n    ll mul = exp(i, s);\n    i = 0;\n    ll left = expleft(i, s);\n\n    ll bob; cin >> bob;\n\n    char ans;\n    if (mul == bob and left == bob) ans = 'U';\n    if (mul == bob and left != bob) ans = 'M';\n    if (mul != bob and left == bob) ans = 'L';\n    if (mul != bob and left != bob) ans = 'I';\n    cout << ans << endl;\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\n#define REP(i,n) for(ll i=0;i<n;++i)\n#define RREP(i,n) for(ll i=n-1;i>=0;--i)\n#define FOR(i,m,n) for(ll i=m;i<n;++i)\n#define RFOR(i,m,n) for(ll i=n-1;i>=m;--i)\n#define ALL(v) (v).begin(),(v).end()\n#define PB(a) push_back(a)\n#define UNIQUE(v) v.erase(unique(ALL(v)),v.end());\n#define DUMP(v) REP(i, (v).size()) { cout << v[i]; if (i != v.size() - 1)cout << \" \"; else cout << endl; }\n#define INF 1000000001ll\n#define MOD 1000000007ll\n#define EPS 1e-9\n\nconst int dx[8] = { 1,1,0,-1,-1,-1,0,1 };\nconst int dy[8] = { 0,1,1,1,0,-1,-1,-1 };\n\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector<vi> vvi;\ntypedef vector<vl> vvl;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nll max(ll a, int b) { return max(a, ll(b)); }\nll max(int a, ll b) { return max(ll(a), b); }\n///(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)///\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tstring s;\n\tint n;\n\tcin >> s >> n;\n\tint ans1 = s[0] - '0';\n\tFOR(i, 1, s.size()) {\n\t\tif (i % 2 == 1) {\n\t\t\tif (s[i] == '+') {\n\t\t\t\tans1 += s[i + 1] - '0';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tans1 *= s[i + 1] - '0';\n\t\t\t}\n\t\t}\n\t\telse continue;\n\t}\n\tint ans2 = 0, tmp = s[0] - '0';\n\tint i = 1;\n\twhile (i < s.size()) {\n\t\tif (i % 2 == 1) {\n\t\t\tif (s[i] == '+') {\n\t\t\t\tans2 += tmp;\n\t\t\t\ttmp = s[i+1]-'0';\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttmp *= s[i+1] - '0';\n\t\t\t}\n\t\t}\n\t\ti += 2;\n\t}\n\tans2 += tmp;\n\n\n\tif (ans1 == n) {\n\t\tif (ans2 == n)cout << 'U' << endl;\n\t\telse cout << 'L' << endl;\n\t}\n\telse {\n\t\tif (ans2 == n)cout << 'M' << endl;\n\t\telse cout << 'I' << endl;\n\t}\n\n\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<list>\n#include<string>\n#include<algorithm>\n#include <utility>\n#include<stdio.h>\n#include<climits>\n\nusing namespace std;\n\nint main(void){\n    string str;\n    int i,j;\n    int ia,oa0,oa1;\n    cin >> str;\n    cin >> ia;\n    oa1 = str[0]-'0';\n    for(i = 1;i < str.length();i+=2){\n        if(str[i] == '+'){\n            oa0 = str[i+1]-'0';\n            for(i += 2;i < str.length();i+=2){\n                if(str[i] == '*')\n                    oa0 *= str[i+1]-'0';\n                else\n                    break;\n            }\n            i -= 2;\n            oa1 += oa0;\n        }\n        else\n            oa1 *= str[i+1]-'0';\n    }\n    oa0 = str[0]-'0';\n    for(i = 1;i < str.length();i+=2){\n        if(str[i] == '+')\n            oa0 += str[i+1]-'0';\n        else\n            oa0 *= str[i+1]-'0';\n    }\n    if(oa0 == ia && oa1 == ia){\n        cout << \"U\" << endl;\n    }\n    else if(oa0 == ia){\n        cout << \"L\" << endl;\n    }\n    else if(oa1 == ia){\n        cout << \"M\" << endl;\n    }\n    else\n        cout << \"I\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint main(){\n\tstring str;\n\tcin>>str;\n\tint num;\n\tcin>>num;\n\n\tint L=str[0]-'0';\n\tfor(int i=1;i<str.length();i+=2){\n\t\tif(str[i]=='+') L+=str[i+1]-'0';\n\t\telse if(str[i]='*') L*=str[i+1]-'0';\n\t}\n\n\tstr+='+';\n\tvector< int > vc;\n\tbool f=0;\n\tfor(int i=1;i<str.length();i+=2){\n\t\tif(str[i]=='+'){\n\t\t\tif(!f) vc.push_back(str[i-1]-'0');\n\t\t\tf=0;\n\t\t} else if(str[i]=='*'){\n\t\t\tif(!f){\n\t\t\t\tvc.push_back((str[i-1]-'0')*(str[i+1]-'0'));\n\t\t\t\tf=1;\n\t\t\t} else if(f){\n\t\t\t\tint tmp=vc.back();\n\t\t\t\tvc.pop_back();\n\t\t\t\tvc.push_back(tmp*(str[i+1]-'0'));\n\t\t\t}\t\t\t\n\t\t}\n\t}\n\n\tint M=0;\n\tfor(int i=0;i<vc.size();i++) M+=vc[i];\n\n\tif(num==M && num==L) cout<<\"U\\n\";\n\telse if(num==L) cout<<\"L\\n\";\n\telse if(num==M) cout<<\"M\\n\";\n\telse cout<<\"I\\n\";\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\n\n\ntemplate <class X> class Solve{\npublic:\n\tstring s;\n\tint p;\n\tSolve(string s_){\n\t\ts = s_;\n\t\ts += \"~\";\n\t\tp = 0;\n\t}\n\tX one(){\n\t\tX r = num();\n\t\twhile( s[p] == '+' || s[p] == '*' ){\n\t\t\tchar c = s[p];\n\t\t\tp++;\n\t\t\tX l = num();\n\t\t\tif( c == '*' ){\n\t\t\t\tr *= l;\n\t\t\t}else{\n\t\t\t\tr += l;\n\t\t\t}\n\t\t}\n\t\treturn r;\n\t}\n\tX num(){\n\t\tX ans = 0;\n\t\twhile( s[p] >= '0' && s[p] <= '9'){\n\t\t\tans = ans * 10 + s[p] - '0';\n\t\t\tp++;\n\t\t}\n\t\treturn ans;\n\t}\n\n\tX two(){\n\t\tX r = num();\n\t\twhile( s[p] == '+' ){\n\t\t\tchar c = s[p];\n\t\t\tp++;\n\t\t\tX l = three();\n\t\t\tr += l;\n\t\t}\n\t\treturn r;\n\t}\n\n\tX three(){\n\t\tX r = num();\n\t\twhile( s[p] == '*' ){\n\t\t\tchar c = s[p];\n\t\t\tp++;\n\t\t\tX l = num();\n\t\t\tr *= l;\n\t\t}\n\t\treturn r;\n\t}\n};\n\nsigned main(){\n\tstring s;\n\tint n;\n\tcin >> s >> n;\n\tint b = 0;\n\tif( fabs(Solve<double>(s).one()-n) < 1e5 ){\n\t\tif( Solve<int>(s).one()-n == 0 ){\n\t\t\tb += 1;\n\t\t}\n\t}\n\tif( fabs(Solve<double>(s).two()-n) < 1e5 ){\n\t\tif( Solve<int>(s).two()-n == 0 ){\n\t\t\tb += 2;\n\t\t}\n\t}\n\tstring table = \"ILMU\";\n\tcout << table[b] << endl;\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\nint calc1(string str){//multiplication-first\n\tstack<int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push((int)stoi(rststr));\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t\tint tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\tint rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nint calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tint rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nint calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\tint rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\tcin >> str;\n\tint ans;\n\tcin >> ans;\n\tint rst1 = calc1(str);\n\tint rst2 = calc3(str);\n\t//cout << rst1 << \" \" << rst2 << endl;\n\tif(rst1==ans){\n\t\tif(rst2==ans) cout << 'U' << endl;\n\t\telse cout << 'M' << endl;\n\t}else{\n\t\tif(rst2==ans) cout << 'L' << endl;\n\t\telse cout << 'I' << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stack>\n#include<string.h>\nusing namespace std;\n\nchar s[20];\nint query;\n\nint M(){\n\tint i;\n\tint a = s[0]-'0',b,c;\n\tfor( i = 1; i < strlen(s); i++ ){\n\t\tif( i%2 ){\n\t\t\tb = s[i+1]-'0';\n\t\t\tif( s[i] == '+'){\n\t\t\t\twhile( i+3 < strlen(s) && s[i+2] == '*' ){\n\t\t\t\t\tc = s[i+3]-'0';\n\t\t\t\t\tb *= c;\n\t\t\t\t\ti += 2;\n\t\t\t\t}\n\t\t\t\ta += b;\n\t\t\t}\n\t\t\telse\n\t\t\t\ta *= b;\n\t\t}\n\t}\n\treturn a;\n}\nint L(){\n\tint i;\n\tint a = s[0]-'0',b;\n\t\n\tfor( i = 1; i < strlen(s); i++ ){\n\t\tif( i%2 ){\n\t\t\tb = s[i+1]-'0';\n\t\t\tif( s[i] == '+')\n\t\t\t\ta += b;\n\t\t\telse\n\t\t\t\ta *= b;\n\t\t}\n\t}\n\treturn a;\n}\n\nint main(){\n\tcin >> s >> query;\n\t//cout << M() << \" \" << L() << endl;\n\tif( M() == query && L() == query )\n\t\tcout << \"U\";\n\telse if( M() == query ){\n\t\tcout << \"M\";\n\t}\n\telse if( L() == query ){\n\t\tcout << \"L\";\n\t}\n\telse{\n\t\tcout << \"I\";\n\t}\n\tcout << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i, n) for(int i = 0; i < (int) (n); i++)\n#define ALL(v) (v).begin(), (v).end()\n#define INF 1e9+7\n\nusing namespace std;\n\nint main(){\n  string str;\n  cin >> str;\n  int lres = str[0] - '0';\n  for(int i=1; i<str.size(); i+=2){\n    char ope = str[i];\n    int tmp = str[i+1] - '0';\n    if(ope == '+') lres += tmp;\n    if(ope == '*') lres *= tmp;\n  }\n  vector<int> digits;\n  int tmp = 1;\n  for(int i=0; i<str.size()-1; i+=2){\n    int digit = str[i] - '0';\n    tmp *= digit;\n    char ope = str[i+1];\n    if(ope == '+') { digits.push_back(tmp); tmp = 1; }\n  }\n  digits.push_back(tmp * (str[str.size()-1] - '0'));\n  int mres = 0;\n  REP(i, digits.size()) mres += digits[i];\n  int ans; cin >> ans;\n  if(mres == ans and lres == ans) cout << \"U\" << endl;\n  else if (mres == ans) cout << \"M\" << endl;\n  else if (lres == ans) cout << \"L\" << endl;\n  else cout << \"I\" << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include<bits/stdc++.h>\nusing namespace std;\n#define inf 1000000000\n#define INF 1000000000000000\n#define ll long long\n#define ull unsigned long long\n#define M (int)(1e9+7)\n#define P pair<int,int>\n#define PLL pair<ll,ll>\n#define FOR(i,m,n) for(int i=(int)m;i<(int)n;i++)\n#define RFOR(i,m,n) for(int i=(int)m;i>=(int)n;i--)\n#define rep(i,n) FOR(i,0,n)\n#define rrep(i,n) RFOR(i,n,0)\n#define all(a) a.begin(),a.end()\n#define IN(a,n) rep(i,n){ cin>>a[i]; }\nconst int vx[4] = {0,1,0,-1};\nconst int vy[4] = {1,0,-1,0};\n#define PI 3.14159265\n#define F first\n#define S second\n#define PB push_back\n#define EB emplace_back\n#define int ll\nvoid init(){\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n}\n\n\nint f(string s){\n  stack<int> st;\n\n  int i=0;\n  int r=0;\n  while('0'<=s[i]&&s[i]<='9'){\n    r*=10;\n    r+=s[i]-'0';\n    i++;\n  }\n  st.push(r);\n\n  while(i<s.size()){\n    bool flag=false;\n    if(s[i]=='+'){\n      flag=true;\n    }\n    i++;\n    r=0;\n    while('0'<=s[i]&&s[i]<='9'){\n      r*=10;\n      r+=s[i]-'0';\n      i++;\n    }\n    int t=st.top(); st.pop();\n    if(flag)\n      st.push(r+t);\n    else\n      st.push(r*t);\n  }\n\n  return st.top();\n}\n\n\nint g(string s){\n  stack<int> st;\n  int i=0,r=0;\n  while('0'<=s[i]&&s[i]<='9'){\n    r*=10;\n    r+=s[i]-'0';\n    i++;\n  }\n  st.push(r);\n\n  while(i<s.size()){\n    bool flag=false;\n    if(s[i]=='*') flag=true;\n    i++;\n    r=0;\n    while('0'<=s[i]&&s[i]<='9'){\n      r*=10;\n      r+=s[i]-'0';\n      i++;\n    }\n    if(flag){\n      int t=st.top(); st.pop();\n      st.push(t*r);\n    }else\n      st.push(r);\n  }\n\n  int ans=0;\n  while(!st.empty()){\n    ans+=st.top();\n    st.pop();\n  }\n\n  return ans;\n}\n\n\nmain(){\n  string s;\n  int n;\n  cin>>s;\n  cin>>n;\n\n  int a=f(s);\n  int b=g(s);\n\n  if(a==n&&b==n){\n    cout<<'U'<<endl;\n  }else if(a==n){\n    cout<<'L'<<endl;\n  }else if(b==n){\n    cout<<'M'<<endl;\n  }else{\n    cout<<'I'<<endl;\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\n\nint main(){\n\tstring f; cin >> f;\n\tint a; cin >> a;\n\tint n = f.size() / 2 ;\n\tint l = f[0] - '0';\n\tfor(int i = 0; i < n; i++){\n\t\tif(f[i*2+1] == '+'){\n\t\t\tl += f[i*2+2] - '0';\n\t\t}else{\n\t\t\tl *= f[i*2+2] - '0';\n\t\t}\n\t}\n\tvector<int> v;\n\tv.push_back(f[0] - '0');\n\tfor(int i = 0; i < n; i++){\n\t\tif(f[i*2+1] == '+'){\n\t\t\tv.push_back(f[i*2+2] - '0');\n\t\t}else{\n\t\t\tv[v.size() - 1] *= f[i*2+2] - '0';\n\t\t}\t\n\t}\n\tint m = 0;\n\tfor(int i = 0; i < m; i++) {\n\t\tm += v[i];\n\t}\n\tif(a==m && a==l) cout << 'U' << endl;\n\tif(a!=m && a==l) cout << 'L' << endl;\n\tif(a==m && a!=l) cout << 'M' << endl;\n\tif(a!=m && a!=l) cout << 'I' << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  string str;\n  cin>>str;\n  int bob;\n  cin>>bob;\nint ans=str[0]-'0';\n int f,multi[20]={};\n\n  for(int i=1;i<str.size();i++){\n    if(str[i]=='+')f=1;\n    else if(str[i]=='*')f=2,multi[i]++;\n    if(str[i]>='0' && str[i]<='9'){\n      if(f==1) ans+=(str[i]-'0');\n      else if(f==2)ans*=(str[i]-'0');\n    }\n  }\n  char ansf='I';\n   if(ans==bob)ansf='L';\n  ans=0;\n  for(int i=1;i<str.size();i++)\n    if(multi[i])ans+=(str[i-1]-'0')*(str[i+1]-'0'),str[i-1]='0',str[i+1]='0',str[i]='+';\n  for(int i=0;i<str.size();i++)\n    if(str[i]>='0' && str[i]<='9')ans+=(str[i]-'0');\n   if(ans==bob && ansf=='L') ansf='U';\n  else if(ans==bob)ansf='M';\n  cout<<ansf<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\nint calc1(string str){//multiplication-first\n\tstack<int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push((int)stoi(rststr));\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t\tint tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\tint rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nint calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tint rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nint calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\tint rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\twhile(cin >> str){\n\t\tint ans;\n\t\tcin >> ans;\n\t\tint rst1 = calc1(str);\n\t\tint rst2 = calc3(str);\n\t\t//cout << rst1 << \" \" << rst2 << endl;\n\t\tif(rst1==ans){\n\t\t\tif(rst2==ans) cout << 'U' << endl;\n\t\t\telse cout << 'M' << endl;\n\t\t}else{\n\t\t\tif(rst2==ans) cout << 'L' << endl;\n\t\t\telse cout << 'I' << endl;\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <cstdlib>\n#include <climits>\n#include <ctime>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <list>\n#include <vector>\n#include <set>\n#include <map>\n#include <iostream>\n#include <deque>\n#include <complex>\n#include <string>\n#include <iomanip>\n#include <sstream>\n#include <bitset>\n#include <valarray>\n#include <iterator>\nusing namespace std;\ntypedef long long int ll;\ntypedef unsigned int uint;\ntypedef unsigned char uchar;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef vector<int> vi;\n\n#define REP(i,x) for(int i=0;i<(int)(x);i++)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();i++)\n#define RREP(i,x) for(int i=((int)(x)-1);i>=0;i--)\n#define RFOR(i,c) for(__typeof((c).rbegin())i=(c).rbegin();i!=(c).rend();i++)\n#define ALL(container) container.begin(), container.end()\n#define RALL(container) container.rbegin(), container.rend()\n#define SZ(container) ((int)container.size())\n#define mp(a,b) make_pair(a, b)\n#define UNIQUE(v) v.erase( unique(v.begin(), v.end()), v.end() );\n\ntemplate<class T> bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T> bool chmin(T &a, const T &b) { if (a>b) { a=b; return 1; } return 0; }\ntemplate<class T> ostream& operator<<(ostream &os, const vector<T> &t) {\nos<<\"[\"; FOR(it,t) {if(it!=t.begin()) os<<\",\"; os<<*it;} os<<\"]\"; return os;\n}\ntemplate<class T> ostream& operator<<(ostream &os, const set<T> &t) {\nos<<\"{\"; FOR(it,t) {if(it!=t.begin()) os<<\",\"; os<<*it;} os<<\"}\"; return os;\n}\ntemplate<class S, class T> ostream& operator<<(ostream &os, const pair<S,T> &t) { return os<<\"(\"<<t.first<<\",\"<<t.second<<\")\";}\n\nconst int INF = 1<<28;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\n\n\nint n;\n\nint ltor(string s){\n\tint x=s[0]-'0';\n\tfor(int i=1;i<s.size();i+=2){\n\t\tif(s[i] == '*') x *= s[i+1]-'0';\n\t\tif(s[i] == '+') x += s[i+1]-'0';\n\t}\n\treturn x;\n}\nint mult(string s){\n\tstack<int> st;\n\tst.push(s[0]-'0');\n\tfor(int i=1;i<s.size();i+=2){\n\t\tif(s[i] == '*') st.top() *= s[i+1]-'0';\n\t\tif(s[i] == '+') st.push(s[i+1]-'0');\n\t}\n\tint ans = 0;\n\twhile(!st.empty()){\n\t\tans += st.top();\n\t\tst.pop();\n\t}\n\treturn ans;\n}\n\nmain(){\n\tios::sync_with_stdio(false);\n\tstring s;\n\tcin >> s >> n;\n\tint ans = (ltor(s) == n)*2 + (mult(s) == n);\n\tputs(ans == 3 ? \"U\" : ans == 2 ? \"L\" : ans == 1 ? \"M\" : \"I\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr, __VA_ARGS__)\n//#define LOG(...)\n#define FOR(i, a, b) for(int i=(int)(a); i<(int)(b); ++i)\n#define REP(i, n) for(int i=0; i<(int)(n); ++i)\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EXIST(s, e) ((s).find(e)!=(s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n#define SQ(n) (n) * (n)\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nint main() {\n  string input;\n  int R;\n  cin >> input >> R;\n  vi num;\n  REP(i, input.length()){\n    switch(input[i]) {\n    case '+':\n      num.push_back(-1);\n      break;\n    case '*':\n      num.push_back(-2);\n      break;\n    default:\n      num.push_back(input[i] - '0');\n      break;\n    }\n  }\n\n  int L = num[0];\n  for(int i = 1; i < num.size(); i+=2) {\n    if(num[i] == -1) {\n      L += num[i + 1];\n    }else {\n      L *= num[i + 1];\n    }\n  }\n\n  for(int i = 1; i < num.size(); i+=2) {\n    if(num[i] == -2) {\n      num[i + 1] = num[i - 1] * num[i + 1];\n      num[i - 1] = 0;\n      num[i] = -1;\n    }\n  }\n\n  int M = num[0];\n  for(int i = 1; i < num.size(); i+=2) {\n      M += num[i + 1];\n  }\n\n  string result = \"IMLU\";\n  int res = ((L==R) & 1) << 1 | (M==R);\n  cout << result[res] << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\n//#define int long long\n#define DBG 1\n#define dump(o) if(DBG){cerr<<#o<<\" \"<<(o)<<\" \";}\n#define dumpl(o) if(DBG){cerr<<#o<<\" \"<<(o)<<endl;}\n#define dumpc(o) if(DBG){cerr<<#o; for(auto &e:(o))cerr<<\" \"<<e;cerr<<endl;}\n#define rep(i,a,b) for(int i=(a);i<(b);i++)\n#define rrep(i,a,b) for(int i=(b)-1;i>=(a);i--)\n#define all(c) begin(c),end(c)\nconst int INF = sizeof(int) == sizeof(long long) ? 0x3f3f3f3f3f3f3f3fLL : 0x3f3f3f3f;\nconst int MOD = (int)(1e9 + 7);\ntemplate<class T> bool chmax(T &a, const T &b) { if (a < b) { a = b; return true; } return false; }\ntemplate<class T> bool chmin(T &a, const T &b) { if (a > b) { a = b; return true; } return false; }\n\nclass Parser {\npublic:\n\tusing Iter = string::const_iterator;\n\tIter it;\n\tParser(Iter it) :it(it) {}\n\tvoid cmp(char expected) { if (*it != expected)cerr << *it << \" is not \" << expected << endl; assert(*it == expected); }\n\t/*\n\tEBNF\n\t???=???,{'+',???};\n\t???=integer,{'*',integer};\n\t*/\n\tint a() {\n\t\tint ret = b();\n\t\twhile (true) {\n\t\t\tif (*it == '+') {\n\t\t\t\tit++;\n\t\t\t\tret += b();\n\t\t\t}\n\t\t\telse break;\n\t\t}\n\t\treturn ret;\n\t}\n\tint b() {\n\t\tint ret = integer();\n\t\twhile (true) {\n\t\t\tif (*it == '*') {\n\t\t\t\tit++;\n\t\t\t\tret *= integer();\n\t\t\t}\n\t\t\telse break;\n\t\t}\n\t\treturn ret;\n\t}\n\tint integer() {\n\t\tint ret = 0;\n\t\twhile (isdigit(*it)) {\n\t\t\tret *= 10;\n\t\t\tret += *it - '0';\n\t\t\tit++;\n\t\t}\n\t\treturn ret;\n\t}\n};\n\nclass Parser2 {\npublic:\n\tusing Iter = string::const_iterator;\n\tIter it;\n\tParser2(Iter it) :it(it) {}\n\tvoid cmp(char expected) { if (*it != expected)cerr << *it << \" is not \" << expected << endl; assert(*it == expected); }\n\t/*\n\tEBNF\n\t???=integer,{('*'|'+'),integer};\n\t*/\n\tint a() {\n\t\tint ret = integer();\n\t\twhile (true) {\n\t\t\tif (*it == '*') {\n\t\t\t\tit++;\n\t\t\t\tret *= integer();\n\t\t\t}\n\t\t\telse if (*it == '+') {\n\t\t\t\tit++;\n\t\t\t\tret += integer();\n\t\t\t}\n\t\t\telse break;\n\t\t}\n\t\treturn ret;\n\t}\n\tint integer() {\n\t\tint ret = 0;\n\t\twhile (isdigit(*it)) {\n\t\t\tret *= 10;\n\t\t\tret += *it - '0';\n\t\t\tit++;\n\t\t}\n\t\treturn ret;\n\t}\n};\n\n\n\nsigned main() {\n\tstring s; getline(cin, s);\n\ts += \"$\";\n\tParser P(s.begin());\n\tParser2 P2(s.begin());\n\tint a; cin >> a;\n\tint a1 = P.a(), a2 = P2.a();\n\tif (a == a1&&a == a2)cout << \"U\" << endl;\n\telse if (a == a1)cout << \"M\" << endl;\n\telse if (a == a2)cout << \"L\" << endl;\n\telse cout << \"I\" << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(){\n  string s;\n  int n;\n  cin>>s>>n;\n  int a=s[0]-'0',c=s[0]-'0',b=0;\n  for(int i=1;i<s.size();i+=2){\n    int p=s[i+1]-'0';\n    if(s[i]=='+')a+=p,b+=c,c=p;\n    else a*=p,c*=p;\n  }\n  b+=c;\n  if(b==n&&a!=n)cout<<'M';\n  else if(a==n&&b!=n)cout<<'L';\n  else if(a==b)cout<<'U';\n  else cout<<'I';\n  cout<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nchar str[20];\nint cur;\nlong long num(){\n\tlong long ret=0;\n\twhile('0'<=str[cur]&&str[cur]<='9'){\n\t//\tprintf(\"%d\\n\",cur);\n\t\tret*=10;\n\t\tret+=str[cur]-'0';\n\t\tcur++;\n\t}\n\treturn ret;\n}\nlong long mul(){\n\tlong long ret=num();\n\twhile(str[cur]=='*'){\n\t\tcur++;\n\t\tret*=num();\n\t}\n\treturn ret;\n}\nlong long plus(){\n\tlong long ret=mul();\n\twhile(str[cur]=='+'){\n\t\tcur++;\n\t\tret+=mul();\n\t}\n\treturn ret;\n}\nint main(){\n\tscanf(\"%s\",str);\n\tlong long a;scanf(\"%lld\",&a);\n\tlong long M=plus();\n\tlong long L=0;\n\tcur=0;\n\tlong long tmp=0;\n\tint last=0;\n\twhile(str[cur]){\n\t\ttmp=0;\n\t\twhile('0'<=str[cur]&&str[cur]<='9'){\n\t\t\ttmp*=10;\n\t\t\ttmp+=str[cur]-'0';\n\t\t\tcur++;\n\t\t}//printf(\"%lld\\n\",L);\n\t\t\n\t\tif(last)L*=tmp;\n\t\telse L+=tmp;\n\t\tif(!str[cur])break;\n\t\tif(str[cur]=='*')last=1;\n\t\telse last=0;\n\t\tcur++;\n\t}\n\tif(a==M&&a==L)printf(\"U\\n\");\n\tif(a==M&&a!=L)printf(\"M\\n\");\n\tif(a!=M&&a!=L)printf(\"I\\n\");\n\tif(a!=M&&a==L)printf(\"L\\n\");\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <ctime>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cmath>\n#include <sstream>\n#include <utility>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef pair<int,int> pii;\n#define all(c) (c).begin(), (c).end()\n#define loop(i,a,b) for(ll i=a; i<ll(b); i++)\n#define rep(i,b) loop(i,0,b)\n#define each(e,c) for(auto&e:c)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define lb lower_bound\n#define ub upper_bound\n#ifdef DEBUG\n#define dump(...) (cerr<<#__VA_ARGS__<<\" = \"<<(DUMP(),__VA_ARGS__).str()<<\" [\"<<__LINE__<<\"]\"<<endl)\nstruct DUMP:ostringstream{template<class T>DUMP &operator,(const T&t){if(this->tellp())*this<<\", \";*this<<t;return *this;}};\n#else\n#define dump(...)\n#endif\ntemplate<class T> ostream& operator<<(ostream& os, vector<T> const& v){\n    rep(i,v.size()) os << v[i] << (i+1==v.size()?\"\":\" \");\n    return os;\n}\n\n#define int ll\n\nint parseL(string s){\n    int res = s[0]-'0';\n    rep(i,s.size()){\n        if(s[i]=='*') res*=s[i+1]-'0';\n        else if(s[i]=='+')res+=s[i+1]-'0';\n    }\n    return res;\n}\n\nint parseM(string s){\n    vi v={s[0]-'0'};\n    rep(i,s.size()){\n        if(s[i]=='*') v.back()*=s[i+1]-'0';\n        else if(s[i]=='+') v.pb(s[i+1]-'0');\n    }\n    int x = 0;\n    rep(i,v.size()) x+=v[i];\n    return x;\n}\n\nsigned main(){\n    string s;\n    while(cin >> s){\n    ll x; cin >> x;\n    int a = parseM(s);\n    int b = parseL(s);\n    char ans;\n    if(x==a && x==b) ans = 'U';\n    else if(x==a) ans = 'M';\n    else if(x==b) ans = 'L';\n    else ans = 'I';\n    cout << ans << endl;\n}\n}"
  },
  {
    "language": "C++",
    "code": "///\n// File:  1346.cpp\n// Author: ymiyamoto\n//\n// Created on Sun Nov 26 02:53:16 2017\n//\n\n#include <cstdint>\n#include <iostream>\n#include <stack>\n#include <string>\n\nusing namespace std;\n\nint32_t main()\n{\n  string str;\n  cin >> str;\n  uint32_t n;\n  cin >> n;\n\n  stack<int32_t> stack;\n  for (uint32_t i = 0; i < str.size(); i++) {\n    if (i % 2 == 0) {\n      uint32_t val = str[i] - '0';\n      stack.push(val);\n    } else {\n      char op = str[i];\n      if (op == '*') {\n        i++;\n        uint32_t val1 = stack.top();\n        stack.pop();\n        uint32_t val2 = str[i] - '0';\n        stack.push(val1 * val2);\n      }\n    }\n  }\n\n  uint32_t result1 = 0;\n  while (!stack.empty()) {\n    result1 += stack.top();\n    stack.pop();\n  }\n\n  uint32_t result2 = str[0] - '0';\n  for (uint32_t i = 1; i < str.size(); i++) {\n    if (str[i] == '+') {\n      i++;\n      result2 += str[i] - '0';\n    } else {\n      i++;\n      result2 *= str[i] - '0';\n    }\n  }\n\n  if (result1 == n && result2 == n) {\n    cout << \"U\" << endl;\n  } else if (result1 == n) {\n    cout << \"M\" << endl;\n  } else if (result2 == n) {\n    cout << \"L\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long   // <-----!!!!!!!!!!!!!!!!!!!\n\n#define rep(i,n) for (int i=0;i<(n);i++)\n#define rep2(i,a,b) for (int i=(a);i<(b);i++)\n#define rrep(i,n) for (int i=(n)-1;i>=0;i--)\n#define rrep2(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n\ntypedef long long ll;\ntypedef pair<int, int> P;\ntypedef tuple<int, int, int> TUPLE;\ntypedef vector<int> V;\ntypedef vector<V> VV;\ntypedef vector<VV> VVV;\n\nsigned main() {\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(0);\n\n    string s;\n    cin >> s;\n    s = \"+\" + s;\n    int b;\n    cin >> b;\n\n    int n = s.size();\n\n    // mul-first\n    int a1 = 0;\n    rep(i, n) {\n        if (s[i] == '+') {\n            int t = 1;\n            rep2(j, i + 1, n) {\n                if (isdigit(s[j])) {\n                    t *= s[j] - '0';\n                }\n                if (s[j] == '+') {\n                    break;\n                }\n            }\n            a1 += t;\n        }\n    }\n\n    // left-to-right\n    int a2 = 0;\n    rep(i, n) {\n        if (s[i] == '+') {\n            a2 += s[i + 1] - '0';\n        }\n        if (s[i] == '*') {\n            a2 *= s[i + 1] - '0';\n        }\n    }\n\n    if (b == a1 && b != a2) {\n        cout << \"M\" << endl;\n    }\n    if (b != a1 && b == a2) {\n        cout << \"L\" << endl;\n    }\n    if (b == a1 && b == a2) {\n        cout << \"U\" << endl;\n    }\n    if (b != a1 && b != a2) {\n        cout << \"I\" << endl;\n    }\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define all(x) (x).begin(),(x).end()\nconst int mod=1000000007,MAX=3005,INF=1<<29;\ntypedef string::const_iterator State;\n\nint expression1(State &begin);\nint expression2(State &begin);\nint term(State &begin);\nint number(State &begin);\n\nint expression1(State &begin){\n    int ret=number(begin);\n    \n    for(;;){\n        if(*begin=='+') ret+=number(++begin);\n        else if(*begin=='*') ret*=number(++begin);\n        else break;\n    }\n    \n    return ret;\n}\n\nint expression2(State &begin){\n    int ret=term(begin);\n    \n    for(;;){\n        if(*begin=='+') ret+=term(++begin);\n        else break;\n    }\n    \n    return ret;\n}\n\nint term(State &begin){\n    int ret=number(begin);\n    \n    for(;;){\n        if(*begin=='*') ret*=number(++begin);\n        else break;\n    }\n    \n    return ret;\n}\n\nint number(State &begin){\n    int ret=0;\n    \n    while(isdigit(*begin)){\n        ret*=10;\n        ret+=*begin-'0';\n        \n        begin++;\n    }\n    \n    return ret;\n}\n \nint main(){\n    \n    std::ifstream in(\"text.txt\");\n    std::cin.rdbuf(in.rdbuf());\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    \n    string S;cin>>S;\n    \n    State a=S.begin(),b=a;\n    int A=expression1(a),B=expression2(b);\n    \n    int T;cin>>T;\n    \n    if(A==T&&B==T) cout<<\"U\"<<endl;\n    else if(A==T) cout<<\"L\"<<endl;\n    else if(B==T) cout<<\"M\"<<endl;\n    else cout<<\"I\"<<endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "/*\n * b.cc: \n */\n\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<iostream>\n#include<string>\n#include<vector>\n#include<map>\n#include<set>\n#include<stack>\n#include<list>\n#include<queue>\n#include<deque>\n#include<algorithm>\n#include<numeric>\n#include<utility>\n#include<complex>\n#include<functional>\n\nusing namespace std;\n\n/* constant */\n\nconst int MAX_N = 100;\n\n/* typedef */\n\n/* global variables */\n\n/* subroutines */\n\nint num(string &s, int &pos) {\n  return (s[pos++] - '0');\n}\n\nint term(string &s, int &pos) {\n  int n0 = num(s, pos);\n  while (pos < s.size() && s[pos] == '*') {\n    pos++; // '*'\n    int n1 = num(s, pos);\n    n0 *= n1;\n  }\n  return n0;\n}\n\nint expr(string &s, int &pos) {\n  int t0 = term(s, pos);\n  while (pos < s.size() && s[pos] == '+') {\n    pos++; // '+'\n    int t1 = term(s, pos);\n    t0 += t1;\n  }\n  return t0;\n}\n\nint ltor(string &s, int &pos) {\n  int n0 = num(s, pos);\n  while (pos < s.size()) {\n    char op = s[pos++]; // '+' or '*'\n    int n1 = num(s, pos);\n    n0 = (op == '+') ? n0 + n1 : n0 * n1;\n  }\n  return n0;\n}\n\n/* main */\n\nint main() {\n  string s;\n  int bans;\n  cin >> s >> bans;\n\n  int pos = 0;\n  int e = expr(s, pos);\n\n  pos = 0;\n  int lr = ltor(s, pos);\n  //printf(\"%d %d\\n\", e, lr);\n\n  char ans = 'I';\n  if (bans == e && bans != lr) ans = 'M';\n  else if (bans != e && bans == lr) ans = 'L';\n  else if (bans == e && bans == lr) ans = 'U';\n\n  printf(\"%c\\n\", ans);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\ntypedef long long int ll;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000001\nusing namespace std;\n\nenum Token{\n\tNONE,\n\tMULT,\n\tPLUS,\n};\n\nint length;\n\nint left_to_right(char buf[18]){\n\tint ans = buf[0] - '0';\n\n\tToken token = NONE;\n\n\tfor(int i = 1; i < length; i++){\n\t\tswitch(buf[i]){\n\t\tcase '+':\n\t\t\ttoken = PLUS;\n\t\t\tbreak;\n\t\tcase '*':\n\t\t\ttoken = MULT;\n\t\t\tbreak;\n\t\tdefault: //??°???\n\t\t\tif(token == MULT){\n\t\t\t\tans *= buf[i] - '0';\n\t\t\t}else if(token == PLUS){\n\t\t\t\tans += buf[i] - '0';\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn ans;\n}\n\nint multi_first(char buf[18]){\n\n\tint tmp;\n\n\tstack<int> NUM;\n\tstack<char> OP;\n\n\tNUM.push(buf[0]-'0');\n\n\tfor(int i = 1; i < length; i++){\n\t\tif(buf[i] >= '0' && buf[i] <= '9'){\n\n\t\t\tif(OP.top() == '*'){\n\t\t\t\tOP.pop();\n\t\t\t\ttmp = NUM.top();\n\t\t\t\tNUM.pop();\n\t\t\t\tNUM.push(tmp*(buf[i]-'0'));\n\t\t\t}else{\n\t\t\t\tNUM.push(buf[i]-'0');\n\t\t\t}\n\t\t}else{\n\t\t\tOP.push(buf[i]);\n\t\t}\n\t}\n\n\tint ans = 0;\n\twhile(!NUM.empty()){\n\t\tans += NUM.top();\n\t\tNUM.pop();\n\t}\n\treturn ans;\n}\n\nint main(){\n\n\tchar buf[18];\n\tint num,rule_1,rule_2;\n\n\tscanf(\"%s\",buf);\n\tscanf(\"%d\",&num);\n\n\tfor(length = 0;buf[length] != '\\0'; length++);\n\n\trule_1 = multi_first(buf);\n\trule_2 = left_to_right(buf);\n\n\tif(num == rule_1 && num == rule_2){\n\t\tprintf(\"U\\n\");\n\t}else if(num != rule_1 && num == rule_2){\n\t\tprintf(\"L\\n\");\n\t}else if(num == rule_1 && num != rule_2){\n\t\tprintf(\"M\\n\");\n\t}else{ //num != rule_1 && num != rule_2\n\t\tprintf(\"I\\n\");\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define all(c) (c).begin(),(c).end()\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;i--)\n#define REP(i,m,n) for(int i=(int)(m);i<(int)(n);i++)\n#define rep(i,n) REP(i,0,n)\n#define iter(c) __typeof((c).begin())\n#define tr(it,c) for(iter(c) it=(c).begin();it!=(c).end();it++)\n#define mem(a) memset(a,0,sizeof(a))\n#define pd(a) printf(\"%.10f\\n\",a)\n#define pb(a) push_back(a)\n#define in(a) insert(a)\n#define pi M_PI\n#define R cin>>\n#define F first\n#define S second\n#define C class\n#define ll long long\n#define ln cout<<'\\n'\n#define _(_1,_2,_3,N,...)N\n#define pr(...) _(__VA_ARGS__,pr3,pr2,pr1)(__VA_ARGS__)\ntemplate<C T>void pr1(T a){cout<<a;ln;}\ntemplate<C T,C T2>void pr2(T a,T2 b){cout<<a<<' '<<b;ln;}\ntemplate<C T,C T2,C T3>void pr3(T a,T2 b,T3 c){cout<<a<<' '<<b<<' '<<c;ln;}\ntemplate<C T>void PR(T a,int n){rep(i,n){if(i)cout<<' ';cout<<a[i];}ln;}\nbool check(int n,int m,int x,int y){return x>=0&&x<n&&y>=0&&y<m;}\nconst ll MAX=1000000007,MAXL=1LL<<60,dx[4]={-1,0,1,0},dy[4]={0,1,0,-1};\ntypedef pair<int,int> P;\n\nstring s;\nstring::iterator p;\nll fact();\nll term();\nll exp();\n\nll fact() {\n  ll x;\n  string num;\n  while(isdigit(*p)) {\n    num += *p;\n    ++p;\n  }\n  if(num.size()) {\n    x = atoi(num.c_str());\n  } else {\n    ++p;\n    x = exp();\n    ++p;\n  }\n  return x;\n}\n \nll term() {\n  ll x = fact();\n  while(*p == '*' || *p == '/') {\n    if(*p == '*') {\n      ++p;\n      x *= fact();\n    } else {\n      ++p;\n      x /= fact();\n    }\n  }\n  return x;\n \n}\n \nll exp() {\n  ll x = term();\n  while(*p == '+' || *p == '-') {\n    if(*p == '+') {\n      ++p;\n      x += term();\n    } else {\n      ++p;\n      x -= term();\n    }\n  }\n  return x;\n}\n\nvoid Main() {\n  R s;p=s.begin();\n  int ans;R ans;\n  ll x=exp();\n  s+='=';\n  ll y=0,d=0,q=1;\n  rep(i,s.size()) {\n    if(isdigit(s[i])) {\n      d*=10;\n      d+=s[i]-'0';\n    } else {\n      if(q) y+=d;\n      else y*=d;\n      d=0;\n      if(s[i]=='+') q=1;\n      else q=0;\n    }\n  }\n  bool f1=ans==x,f2=ans==y;\n  if(f1&&f2) pr(\"U\");\n  else if(f1) pr(\"M\");\n  else if(f2) pr(\"L\");\n  else pr(\"I\");\n}\n\nint main() {\n  ios::sync_with_stdio(0);cin.tie(0);\n  Main();return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\nint main(){\n  string s;\n  cin>>s;\n  int n;\n  cin>>n;\n\n  int pu=0;\n  int ka=0;\n\n  vector<int> x(17,-1);\n  vector<int> f(17,-1);\n  int b=0;\n  int c=0;\n  for(int i=0;i<s.size();i++){\n    if(s[i]=='+'){\n      pu++;\n      f[c]=0;\n      b++;\n      c++;\n    }else if(s[i]=='*'){\n      ka++;\n      f[c]=1;\n      b++;\n      c++;\n    }else{\n      if(x[b]==-1)x[b]=0;\n      x[b]*=10;\n      x[b]+=s[i]-'0';\n    }\n  }\n  int lans=x[0];\n  for(int i=1;x[i]!=-1;i++){\n    if(f[i-1]==0)lans+=x[i];\n    if(f[i-1]==1)lans*=x[i];\n  }\n  //cout<<lans<<endl;\n\n  b=0;\n  c=0;\n  int tmp=1;\n  vector<int> tas;\n  //tmp=x[0];\n  for(int i=0;x[i]!=-1;i++){\n    if(f[c]==0){\n      tmp*=x[i];\n      tas.push_back(tmp);\n      //cout<<tmp<<\"aaa\"<<endl;\n      tmp=1;\n    }else{\n      tmp*=x[i];\n    }\n    b++;\n    c++;\n  }\n  tas.push_back(tmp);\n\n  int mans=0;\n  for(int i=0;i<tas.size();i++){\n    mans+=tas[i];\n    //cout<<tas[i]<<endl;\n  }\n\n  //cout<<lans<<\" \"<<mans<<endl;\n\n  if(n!=lans&&n!=mans){\n    cout<<\"I\"<<endl;\n    return 0;\n  }\n\n  if(lans==mans){\n    cout<<\"U\"<<endl;\n    return 0;\n  }\n\n  if(n==mans){\n    cout<<\"M\"<<endl;\n    return 0;\n  }\n\n  if(n==lans){\n    cout<<\"L\"<<endl;\n    return 0;\n  }\n\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\nll int calc1(string str){//multiplication-first\n\tstack<ll int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push((ll int)stoi(rststr));\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t\tll int tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\tll int rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nll int calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tll int rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nll int calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\tll int rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\tcin >> str;\n\tll int ans;\n\tcin >> ans;\n\tll int rst1 = calc1(str);\n\tll int rst2 = calc3(str);\n\tcout << rst1 << \" \" << rst2 << endl;\n\tif(rst1==ans){\n\t\tif(rst2==ans) cout << 'U' << endl;\n\t\telse cout << 'M' << endl;\n\t}else{\n\t\tif(rst2==ans) cout << 'L' << endl;\n\t\telse cout << 'I' << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n\nusing namespace std;\n\npair<int,int> factor(string s, int i) {\n  int num = s[i] - '0';\n  while(++i < s.size() && s[i] == '*') {\n    num *= s[++i] - '0';\n  }\n  return make_pair(num, i);\n}\n\nint expr(string s) {\n  int num, i;\n  tie(num, i) = factor(s, 0);\n  while(i < s.size()) {\n    int p, j;\n    tie(p, j) = factor(s, i+1);\n    num += p;\n    i = j;\n  }\n  return num;\n}\n\nint expr2(string s) {\n  int i = 0;\n  int num = s[i] - '0';\n  while(++i < s.size()) {\n    if (s[i] == '*')\n      num *= s[++i] - '0';\n    else\n      num += s[++i] - '0';\n  }\n  return num;\n}\n\nint main() {\n  string s;\n  cin>>s;\n  int ans;\n  cin>>ans;\n  int bob = expr2(s);\n  int calc = expr(s);\n  if (ans == bob) {\n    if (ans == calc) {\n      cout << 'U' << endl;\n    } else {\n      cout << 'L' << endl;\n    }\n  } else {\n    if (ans == calc) {\n      cout << 'M' << endl;\n    } else {\n      cout << 'I' << endl;\n    }\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cstdlib>\n\nusing std::cin;\nusing std::cout;\nusing std::endl;\n\nint cal_ltor(std::string str) {\n\tint num_l = 0;\n\tbool plus = true;\n\tfor (int i = 0; i < str.length(); i++) {\n\t\tif ( i%2 == 0 ) {\n\t\t\tif ( plus ) {\n\t\t\t\tnum_l += (int)(str[i] - '0');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnum_l *= (int)(str[i] - '0');\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif ( str[i] == '+' ) {\n\t\t\t\tplus = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tplus = false;\n\t\t\t}\n\t\t}\n\t}\n\treturn num_l;\n}\n\nint cal_multi(std::string str) {\n\tint num_p = 0;\n\tint l = str.length();\n\tstd::vector<bool> cal(l, true);\n\tfor (int i = 0; i < l; i++) {\n\t\tif (str[i] == '*') {\n\t\t\tint end = i;\n\t\t\tint pro = 1;\n\t\t\twhile ( end < l && str[end] != '+') {\n\t\t\t\tend++;\n\t\t\t}\n\t\t\tfor (int j = i-1; j < end; j++) {\n\t\t\t\tif ( j%2 == 0 ) {\n\t\t\t\t\tpro *= (int)(str[j] - '0');\n\t\t\t\t\tcal[j] = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tnum_p += pro;\n\t\t\ti += end;\n\t\t}\n\t}\n\tfor (int i = 0; i < l; i++) {\n\t\tif ( cal[i] && i%2 == 0 ) {\n\t\t\tnum_p += (int)(str[i] - '0');\n\t\t}\n\t}\n\treturn num_p;\n}\n\nint main(void) {\n\tstd::string str;\n\tcin >> str;\n\tint num_l = cal_ltor(str);\n\tint num_p = cal_multi(str);\n\n\tint ans;\n\tcin >> ans;\n\tif ( ans == num_l && ans == num_p ) {\n\t\tcout << \"U\" << endl;\n\t}\n\telse if ( ans == num_l ) {\n\t\tcout << \"L\" << endl;\n\t}\n\telse if ( ans == num_p ) {\n\t\tcout << \"M\" << endl;\n\t}\n\telse {\n\t\tcout << \"I\" << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <functional>\n#include <iostream>\n#include <cstring>\n#include <climits>\n#include <cmath>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <time.h>\n#include <vector>\nusing namespace std;\n \ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> i_i;\ntypedef pair<ll, int> ll_i;\ntypedef pair<double, int> d_i;\ntypedef pair<ll, ll> ll_ll;\ntypedef pair<double, double> d_d;\nstruct edge { int u, v; ll w; };\n \nint MOD = 1000000007;\n\nvector<ll> calc2(vector<ll> v) {\n\tint n = v.size();\n\tvector<ll> res;\n\tif (v[1] == -1)\n\t\tres.push_back(v[0] + v[2]);\n\telse\n\t\tres.push_back(v[0] * v[2]);\n\tfor (int i = 3; i < n; i++)\n\t\tres.push_back(v[i]);\n\treturn res;\n}\n\nvector<ll> calc(vector<ll> v) {\n\tint n = v.size();\n\tfor (int i = 0; i < n; i++)\n\t\tif (v[i] == -2) {\n\t\t\tvector<ll> res;\n\t\t\tfor (int j = 0; j < i - 1; j++)\n\t\t\t\tres.push_back(v[j]);\n\t\t\tres.push_back(v[i - 1] * v[i + 1]);\n\t\t\tfor (int j = i + 2; j < n; j++)\n\t\t\t\tres.push_back(v[j]);\n\t\t\treturn res;\n\t\t}\n\treturn calc2(v);\n}\n\nint main() {\n\tstring s; cin >> s;\n\tint n = s.length();\n\tvector<ll> v;\n\tfor (int i = 0; i < n; i++) {\n\t\tif (s[i] == '+') v.push_back(-1);\n\t\telse if (s[i] == '*') v.push_back(-2);\n\t\telse v.push_back(s[i] - '0');\n\t}\n\tvector<ll> w = v;\n\tfor (int i = 0; i < n / 2; i++) {\n\t\tv = calc(v);\n\t\tw = calc2(w);\n\t}\n\tint x; cin >> x;\n\tif (v[0] == x && w[0] == x) cout << 'U' << endl;\n\tif (v[0] != x && w[0] == x) cout << 'L' << endl;\n\tif (v[0] == x && w[0] != x) cout << 'M' << endl;\n\tif (v[0] != x && w[0] != x) cout << 'I' << endl;\n} "
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nstring s;\nint g(string s);\nint f(string s)\n{\n\tint ans=0,pre=0;\n\tfor(int i=0;i<s.size();i++)\n\t{\n\t\tif(s[i]=='+')\n\t\t{\n\t\t\tans+=g(s.substr(pre,i-pre));\n\t\t\tpre=i+1;\n\t\t}\n\t}\n\treturn ans;\n}\nint g(string s)\n{\n\tint ans=1;\n\tfor(int i=0;i<s.size();i++)ans*=s[i]=='*'?1:s[i]-'0';\n\treturn ans;\n}\nmain()\n{\n\tcin>>s;\n\tint M=f(s+\"+\");\n\tint L=s[0]-'0';\n\tfor(int i=1;i<s.size();i++)\n\t{\n\t\tif(s[i]=='+')L+=s[i+1]-'0';\n\t\telse if(s[i]=='*')L*=s[i+1]-'0';\n\t}\n\tint a;cin>>a;\n\tcout<<(a==M?a==L?\"U\":\"M\":a==L?\"L\":\"I\")<<endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nint comM(string str){\n  int res = 0,sum = 0;\n  if(str[1] == '+' || str.size() == 1) res = str[0]-'0';\n  for(int i=0;i<str.size();i++) {\n    if(str[i] =='*' && sum == 0) sum += (str[i-1]-'0') * (str[i+1]-'0');\n    else if(str[i] =='*' && sum != 0) sum *= (str[i+1] - '0');\n    else if(str[i] == '+') res += sum,sum = 0;\n    if(str[i] == '+' && (i+1 == str.size()-1||str[i+2] != '*')) res += str[i+1]-'0';\n  }\n  return res+sum;\n} \n\nint comL(string str) {\n  int res = str[0]-'0';\n  for(int i=0;i<str.size();i++)\n    if(str[i] == '*') res *= (str[i+1]-'0');\n    else if(str[i]=='+') res += (str[i+1]-'0');\n  return res;\n}\n\nint main(){\n  string str;\n  cin >> str;\n  int n;\n  cin >> n;\n  int M = comM(str);\n  int L = comL(str);\n  if(M==n && L == n) cout << \"U\"<<endl;\n  else if(M==n) cout << \"M\"<<endl;\n  else if(L==n) cout <<\"L\"<<endl;\n  else cout << \"I\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <algorithm>\n#include <iomanip>\n#include <cmath>\n#include <cassert>\nusing namespace std;\n\nint n;\nvector<int> num;\nvector<char> op;\n\nint calc1() {\n\tvector<int> n = num;\n\tvector<char> o = op;\n\tfor(int i = 0; i < o.size();) {\n\t\tif(o[i] == '*') {\n\t\t\tint m = n[i] * n[i + 1];\n\t\t\tn.erase(n.begin() + i);\n\t\t\tn.erase(n.begin() + i);\n\t\t\tn.insert(n.begin() + i, m);\n\t\t\to.erase(o.begin() + i);\n\t\t}\n\t\telse {\n\t\t\ti++;\n\t\t}\n\t}\n\tint sum = 0;\n\tfor(int i = 0; i < n.size(); i++) {\n\t\tsum += n[i];\n\t}\n\treturn sum;\n}\n\nint calc2() {\n\tint s = num[0];\n\tfor(int i = 0; i < op.size(); i++) {\n\t\tif(op[i] == '+') s += num[i + 1];\n\t\telse s *= num[i + 1];\n\t}\n\treturn s;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tstring s;\n\twhile(cin >> s) {\n\t\tcin >> n;\n\t\tnum.clear();\n\t\top.clear();\n\t\tfor(int i = 0; i < s[i]; i++) {\n\t\t\tif(isdigit(s[i])) num.push_back(s[i] - '0');\n\t\t\telse op.push_back(s[i]);\n\t\t}\n\n\t\tbool M = calc1() == n, L = calc2() == n;\n\t\t//cout << calc1() << \" \" << calc2() << endl;\n\t\tif(M && L) cout << \"U\" << endl;\n\t\tif(M && !L) cout << \"M\" << endl;\n\t\tif(!M && L) cout << \"L\" << endl;\n\t\tif(!M && !L) cout << \"I\" << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\n\nstring strerase(string instr,int num){\n\tstring rst = \"\";\n\tfor(int i=num;i<instr.size();i++){\n\t\trst += instr[i];\n\t}\n\treturn rst;\n}\nll int calc1(string str){//multiplication-first\n\tstack<ll int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push((ll int)stoi(rststr));\n\tif(rststr!=\"\") str = strerase(str,log10((double)stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr = strerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\tstr = strerase(str,(int)log10((double)tmp)+1);\n\t\t\tll int tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr = strerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr = strerase(str,(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\tll int rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nll int calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tll int rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str = strerase(str,(int)log10((double)rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr = strerase(str,1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr = strerase(str,1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nll int calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str = strerase(str,(int)log10((double)stoi(rststr))+1);\n\tll int rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr = strerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr = strerase(str,(int)log10((double)tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr = strerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr = strerase(str,(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\tcin >> str;\n\tll int ans;\n\tcin >> ans;\n\tll int rst1 = calc1(str);\n\tll int rst2 = calc3(str);\n\t//cout << rst1 << \" \" << rst2 << endl;\n\tif(rst1==ans){\n\t\tif(rst2==ans) cout << 'U' << endl;\n\t\telse cout << 'M' << endl;\n\t}else{\n\t\tif(rst2==ans) cout << 'L' << endl;\n\t\telse cout << 'I' << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nsigned main(){\n  string s;\n  int ans;\n  cin>>s>>ans;\n  int a[10];\n  int pos=0;\n  a[0]=s[0]-'0';\n  for(int i=1;i<s.length();i+=2){\n    if(s[i]=='+'){\n      a[++pos]=s[i+1]-'0';\n    }else{\n      int t=a[pos];\n      a[pos]=t*(s[i+1]-'0');\n    }\n  }\n  int sa=0;\n  for(int i=0;i<=pos;i++){\n    sa+=a[i];\n  }\n  int sb=s[0]-'0';\n  for(int i=1;i<s.length();i+=2){\n    if(s[i]=='+'){\n      sb+=(s[i+1]-'0');\n    }else{\n      sb*=(s[i+1]-'0');\n    }\n  }\n  if(ans==sa&&ans==sb)\n    cout<<'U'<<endl;\n  else if(ans==sa)\n    cout<<'M'<<endl;\n  else if(ans==sb)\n    cout<<'L'<<endl;\n  else\n    cout<<'I'<<endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint calc0(string s){\n    int res=0,n=s.size(),now=1;\n    for (int i=0;i<n;i+=2){\n        now*=s[i]-'0';\n        if (i==n-1||s[i+1]=='+'){\n            res+=now; now=1;\n        }\n    }\n    return res;\n}\n\nint calc1(string s){\n    int res=0,n=s.size();\n    for (int i=0;i<n;i+=2){\n        if (i&&s[i-1]=='*') res*=s[i]-'0';\n        else res+=s[i]-'0';\n    }\n    return res;\n}\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    string S; int n; cin >> S >> n;\n    int a=calc0(S),b=calc1(S);\n    int m=(a==n?1:0)+(b==n?2:0);\n    string result=\"IMLU\";\n    cout << result[m] << '\\n';\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <stack>\nusing namespace std;\nstring str;\nint N;\n\nint main(void){\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n\n  cin >> str >> N;\n  bool ans[2] = {false, false};\n  stack<int> st;\n  int i = 0;\n  int product = 0;\n  while(i < str.length()){\n    if( isdigit(str[i]) ){\n      st.push(str[i] - '0');\n    }else if(str[i] == '*'){\n      i++;\n      int top = st.top(); st.pop();\n      st.push(top*(str[i] - '0'));\n    }\n    i++;\n  }\n  while(!st.empty()){\n    product += st.top();\n    st.pop();\n  }\n  if(product == N) ans[0] = true;\n\n  product = str[0] - '0';\n  i = 2;\n  while(i < str.length()){\n    if( isdigit(str[i]) ){\n      if(str[i-1] == '*'){\n        product *= (str[i] - '0');\n      }else{\n        product += str[i] - '0';\n      }\n    }\n    i++;\n  }\n  if(product == N){\n    ans[1] = true;\n  }\n  if(ans[1] && ans[0]){\n    cout << 'U' << endl;\n  }else if(ans[0]){\n    cout << 'M' << endl;\n  }else if(ans[1]){\n    cout << 'L' << endl;\n  }else{\n    cout << 'I' << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n\nusing namespace std;\nvector<string> split(string expression,char delimita)\n{\n\tvector<string> ret;\n\tint startIndex = 0;\n\tint length = 1;\n\tint size = expression.size();\n\twhile ((startIndex = expression.find(delimita)) != string::npos)\n\t{\n\t\tstring sub = expression.substr(0,startIndex);\n\t\tstring next = expression.substr(startIndex + 1);\n\t\texpression = next;\n\t\tret.push_back(sub);\n\t}\n\tif (expression.size() > 0)ret.push_back(expression);\n\treturn ret;\n}\nint multi(string exp)\n{\n\tint ret = 1;\n\tfor (int i = 0; i < exp.size(); i+=2)\n\t{\n\t\tret *= (exp[i] - '0');\n\t}\n\treturn ret;\n}\nbool isM(int n,string s)\n{\n\tvector<string> exps = split(s, '+');\n\tint ret = 0;\n\tfor (int i = 0; i < exps.size(); i++)\n\t{\n\t\tret += multi(exps[i]);\n\t}\n\treturn n == ret;\n}\n\nbool isL(int n,string s)\n{\n\tif (s.length() == 1 && s[0] - '0' == n)return true;\n\tint sum = -1;\n\tfor (int i = 1; i < s.length(); i += 2)\n\t{\n\t\tif (i == 1)\n\t\t{\n\t\t\tif (s[i] == '+')\n\t\t\t{\n\t\t\t\tsum = s[i - 1] - '0' + (s[i + 1] - '0');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsum = (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (s[i] == '+')\n\t\t\t{\n\t\t\t\tsum += (s[i + 1] - '0');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsum *= (s[i + 1] - '0');\n\t\t\t}\n\t\t}\n\t}\n\n\tif (sum == n)return true;\n\telse return false;\n}\n\nint main()\n{\n\tstring exp;\n\tint n;\n\tcin >> exp;\n\tcin >> n;\n\tbool M = isM(n, exp);\n\tbool L = isL(n, exp);\n\tif (M && L)\n\t{\n\t\tcout << \"U\" << endl;\n\t}\n\telse if (M)\n\t{\n\t\tcout << \"M\" << endl;\n\t}\n\telse if (L)\n\t{\n\t\tcout << \"L\" << endl;\n\t}\n\telse\n\t{\n\t\tcout << \"I\" << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <set>\n#include <vector>\n#include <algorithm>\n#define REP(i,n) for(int i=0;i<(n);i++)\nusing namespace std;\nint rec1(string s){\n    vector<int>a;\n    vector<bool>b;\n    REP(i,s.size()){\n        if(i%2==0)a.push_back(s[i]-'0');\n        else b.push_back(s[i]=='*'?true:false);\n    }\n    REP(i,b.size()){\n        if(b[i]){\n            a[i+1]=a[i]*a[i+1];\n            a[i]=0;\n        }\n    }\n    int sum=0;\n    REP(i,a.size()){\n        sum+=a[i];\n    }\n    return sum;\n}\nint rec2(string s){\n    int res=s[0]-'0';\n    for(int i=2;i<s.size();i+=2){\n        if(s[i-1]=='*'){\n            res*=(s[i]-'0');\n        }else{\n            res+=(s[i]-'0');\n        }\n    }\n    return res;\n}\nint main(){\n    string s;\n    cin>>s;\n    int bob;\n    cin>>bob;\n    int a=rec1(s);\n    int b=rec2(s);\n    if(a==bob){\n        if(b==bob){\n            cout<<\"U\"<<endl;\n        }else{\n            cout<<\"M\"<<endl;\n        }\n    }else{\n        if(b==bob){\n            cout<<\"L\"<<endl;\n        }else{\n            cout<<\"I\"<<endl;\n        }\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <utility>\n#include <cmath>\n#include <algorithm>\n#include <iostream>\n#include <sstream>\n#include <iomanip>\n#include <vector>\n#include <string>\n#define REP(i,n) for(int i=0;i<n;i++)\ntypedef long long ll;\nusing namespace std;\ntypedef vector<ll> vl;\ntypedef pair<ll,ll> pll;\ntypedef vector<pll> vpll;\ntypedef vector<string> vs;\n\nint main() \n{\n\t//入力\n\tstring s;cin>>s;\n\tll ans;cin>>ans;\n\t\n\t//まずはかけ算\n\tll ans1(0);\n\tint tmp(1);\n\t\n\tif(s.length()==1)\n\t{\n\t\tans1=s[0]-'0';\n\t}\n\telse\n\t{\n\t\tfor(int i=0;i<(s.length())/2;i++)\n\t\t{\n\t\t\tif(i==0)\n\t\t\t{\n\t\t\t\tif(s[i*2+1]=='+')\n\t\t\t\t{\n\t\t\t\t\tans1+=s[i*2]-'0';\n\t\t\t\t\tif(i==(-3+s.length())/2)\n\t\t\t\t{\n\t\t\t\t\tans1+=s[i*2+2]-'0';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttmp*=s[i*2]-'0';\n\t\t\t\tif(i==(-3+s.length())/2)\n\t\t\t\t{\n\t\t\t\t\ttmp*=s[i*2+2]-'0';\n\t\t\t\t\tans1+=tmp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(s[i*2+1]=='+')\n\t\t\t{\n\t\t\t\tif(s[i*2-1]=='*')\n\t\t\t\t{\n\t\t\t\t\ttmp*=s[i*2]-'0';\n\t\t\t\t\tans1+=tmp;tmp=1;\n\t\t\t\t\tif(i==(-3+s.length())/2)\n\t\t\t\t\t{\n\t\t\t\t\t\tans1+=s[i*2+2]-'0';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tans1+=s[i*2]-'0';\n\t\t\t\t\tif(i==(-3+s.length())/2)\n\t\t\t\t\t{\n\t\t\t\t\t\tans1+=s[i*2+2]-'0';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttmp*=s[i*2]-'0';\n\t\t\t\tif(i==(-3+s.length())/2)\n\t\t\t\t{\n\t\t\t\t\ttmp*=s[i*2+2]-'0';\n\t\t\t\t\tans1+=tmp;\n\t\t\t\t}\n\t\t\t}\n\t\t}}\n\t}\n\t\t//足し算\n\tll ans2(0);\n\tif(s.length()==1)\n\t{\n\t\tans2+=s[0]-'0';\n\t}\n\telse\n\t{\n\t\tfor(int i=0;i<(s.length())/2;i++)\n\t\t{\n\t\t\tif(i==0)\n\t\t\t{\n\t\t\t\tif(s[i*2+1]=='+')\n\t\t\t\t{\n\t\t\t\t\tans2+=s[i*2]-'0'+s[i*2+2]-'0';//cout<<\"-1-\"<<\" \"<<ans2<<endl;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tans2+=(s[i*2]-'0')*(s[i*2+2]-'0');//cout<<\"-2-\"<<\" \"<<ans2<<endl;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(s[i*2+1]=='+')\n\t\t\t\t{\n\t\t\t\t\tans2+=s[i*2+2]-'0';//cout<<\"-3-\"<<\" \"<<ans2<<endl;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tans2*=s[i*2+2]-'0';//cout<<\"-4-\"<<\" \"<<ans2<<endl;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tcout << ans1 <<endl<< ans2<<endl;\n\t\n\tbool m =(ans==ans1);\n\tbool l =(ans==ans2);\n\t\t\n\tif(m&&!l){cout<<'M'<<endl;}\n\tif(!m&&l){cout<<'L'<<endl;}\n\tif(m&&l){cout<<'U'<<endl;}\n\tif(!m&&!l){cout<<'I'<<endl;}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long   // <-----!!!!!!!!!!!!!!!!!!!\n\n#define rep(i,n) for (int i=0;i<(n);i++)\n#define rep2(i,a,b) for (int i=(a);i<(b);i++)\n#define rrep(i,n) for (int i=(n)-1;i>=0;i--)\n#define rrep2(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n\ntypedef long long ll;\ntypedef pair<int, int> P;\ntypedef tuple<int, int, int> TUPLE;\ntypedef vector<int> V;\ntypedef vector<V> VV;\ntypedef vector<VV> VVV;\n\nsigned main() {\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(0);\n\n    string s;\n    cin >> s;\n    int b;\n    cin >> b;\n\n    int n = s.size();\n\n    // mul-first\n    int a1 = s[0] - '0';\n    rep(i, n) {\n        if (s[i] == '+') {\n            int t = 1;\n            rep2(j, i + 1, n) {\n                if (isdigit(s[j])) {\n                    t *= s[j] - '0';\n                }\n                if (s[j] == '+') {\n                    break;\n                }\n            }\n            a1 += t;\n        }\n    }\n\n    // left-to-right\n    int a2 = s[0] - '0';\n    rep(i, n) {\n        if (s[i] == '+') {\n            a2 += s[i + 1] - '0';\n        }\n        if (s[i] == '*') {\n            a2 *= s[i + 1] - '0';\n        }\n    }\n\n    if (b == a1 && b != a2) {\n        cout << \"M\" << endl;\n    }\n    if (b != a1 && b == a2) {\n        cout << \"L\" << endl;\n    }\n    if (b == a1 && b == a2) {\n        cout << \"U\" << endl;\n    }\n    if (b != a1 && b != a2) {\n        cout << \"I\" << endl;\n    }\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\nll int calc1(string str){//multiplication-first\n\tstack<ll int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push((ll int)stoi(rststr));\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t\tll int tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\tll int rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nll int calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tll int rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nll int calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\tll int rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\tcin >> str;\n\tll int ans;\n\tcin >> ans;\n\tll int rst1 = calc1(str);\n\tll int rst2 = calc3(str);\n\tcout << rst1 << \" \" << rst2 << endl;\n\tif(rst1==ans){\n\t\tif(rst2==ans) cout << 'U' << endl;\n\t\telse cout << 'M' << endl;\n\t}else{\n\t\tif(rst2==ans) cout << 'L' << endl;\n\t\telse cout << 'I' << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <map>\n#include <set>\n#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <string>\n#include <time.h>\n#include <cctype>\n \n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define FFOR(i,a,b) for(int i=(a);i<=(b);i++)\n#define REP(i,b) FOR(i,0,b)\n#define RREP(i,b) FFOR(i,1,b)\n#define PB push_back\n#define F first\n#define S second\n#define BE(c) c.begin(),c.end()\nusing namespace std;\ntypedef long long LL;\ntypedef LL ut;\ntypedef long double ld;\ntypedef pair<ut,ut> pr;\ntypedef vector<pr> Vpr;\ntypedef vector<ut> VI;\ntypedef pair<ut,pr> ppr;\ntypedef priority_queue<pr,Vpr, greater<pr> > PQ;\nconst int SIZE=1e+5+10;\nconst ut INF=1<<30;\nconst ld eps=1e-6;\nconst LL mod=1e+9 + 7;\n\nvector<int> pp;\ntypedef string::const_iterator SC;\n\nint number(SC& begin){\n\tint res = 0;\n\t\n\twhile(isdigit(*begin)){\n\t\tres *= 10;\n\t\tres += *begin - '0';\n\t\tbegin++;\n\t}\n\t\n\treturn res;\n}\n\n// ?????????????¨??????????(int???)?????????\nint term(SC& begin){\n\tint res = number(begin);\n\t\n\twhile(1){\n\t\tif(*begin == '*'){\n\t\t\tbegin++;\n\t\t\tres *= number(begin);\n\t\t}\n\t\telse{\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\n// ?¶????????????????\nint expression(SC& begin){\n\tint res = term(begin);\n\t\n\twhile(1){\n\t\tif(*begin == '+'){\n\t\t\tbegin++;\n\t\t\tres += term(begin);\n\t\t}\n\t\telse{\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\nint main() {\n\tstring s;\n\tcin >> s;\n\tint n;\n\tcin >> n;\n\tif(s.size() == 1){\n\t\tif((s[0] - '0') == n)\n\t\t\tcout << \"U\" << endl;\n\t\telse\n\t\t\tcout << \"I\" << endl;\n\t\treturn 0;\n\t}\n\tbool mb = false, lb = false;\n\tbool plus = false;\n\tint m = s[0] - '0';\n\tFOR(i,1,s.size()){\n\t\tif(i % 2){\n\t\t\tplus = s[i] == '+';\n\t\t}\n\t\telse{\n\t\t\tif(plus)\n\t\t\t\tm += s[i] - '0';\n\t\t\telse\n\t\t\t\tm *= s[i] - '0';\n\t\t}\n\t}\n\tif(n == m)\n\t\tmb = true;\n\tSC begin = s.begin();\n\tint l = expression(begin);\n\t//cout << l << endl;\n\tif(n == l)\n\t\tlb = true;\n\tif(lb && mb){\n\t\tcout << \"U\" << endl;\n\t}\n\telse if(lb){\n\t\tcout << \"M\" << endl;\n\t}\n\telse if(mb){\n\t\tcout << \"L\" << endl;\t\n\t}\n\telse{\n\t\tcout << \"I\" << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint left_first(string s) {\n  int res=s[0]-'0';\n  for(int i=1;i<s.size();i+=2) {\n    if(s[i]=='*') res*=s[i+1]-'0';\n    else res+=s[i+1]-'0';\n  }\n  return res;\n}\n\nint multi_first(string s) {\n  stack<int> sdig;\n  for(int i=0;i<s.size();++i) {\n    if(s[i]=='*') {\n      int tmp=sdig.top(); sdig.pop();\n      sdig.push(tmp*(s[i+1]-'0'));\n      i++;\n    } else if(isdigit(s[i])) sdig.push(s[i]-'0');\n  }\n  int res=0;\n  while(!sdig.empty()) {\n    res+=sdig.top(); sdig.pop();\n  }\n  return res;\n}\n\nint main(){\n  string s; cin >> s;\n  int a; cin >> a;\n  int le=left_first(s);\n  int mu=multi_first(s);\n  if(le==a&&mu==a) cout << \"U\";\n  else if(le==a) cout << \"L\";\n  else if(mu==a) cout << \"M\";\n  else cout << \"I\";\n  cout << endl;\n  \n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#define  _USE_MATH_DEFINES\n\n#define  rep(i, n) for(int i = 0; i < n; i++)\n#define  repx(i, a, n) for(int i = a; i < n; i++)\n#define  loop while(1)\n#define  lli long long int\n \n#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <numeric>\n#include <string>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <list>\n#include <map>\n#include <utility>\n#include <set>\n\nusing namespace std;\n\nint main() {\n\n  string str;\n  cin >> str;\n\n  int n;\n  cin >> n;\n\n  stack<int> st;\n  st.push((int)(str[0] - '0'));\n  int tmp = 0;\n\n  int ans1 = 0;\n  int ans2 = (int)(str[0] - '0');\n\n  char opr;\n  int  num;\n\n  for (int i = 1; i < str.size() / 2 + 1; i++) {\n    opr = str[2 * i - 1];\n    num = (int)(str[2 * i] - '0');\n    if (opr == '+') {\n      st.push(num);\n      ans2 += num;\n    }\n    else {\n      tmp = st.top();\n      st.pop();\n      st.push(tmp * num);\n      ans2 *= num;\n    }\n  }\n  while (st.size()) {\n    ans1 += st.top();\n    st.pop();\n  }\n\n  if (n == ans1 && n == ans2) cout << 'U' << endl;\n  else if (n == ans1) cout << 'M' << endl;\n  else if (n == ans2) cout << 'L' << endl;\n  else cout << 'I' << endl;\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\nint calc1(string str){//multiplication-first\n\tstack<int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push((int)stoi(rststr));\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t\tint tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\tint rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nint calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tint rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nint calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\tint rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\twhile(cin >> str){\n\t\tcin >> str;\n\t\tint ans;\n\t\tcin >> ans;\n\t\tint rst1 = calc2(str);\n\t\tint rst2 = calc3(str);\n\t\t//cout << rst1 << \" \" << rst2 << endl;\n\t\tif(rst1==ans){\n\t\t\tif(rst2==ans) cout << 'U' << endl;\n\t\t\telse cout << 'M' << endl;\n\t\t}else{\n\t\t\tif(rst2==ans) cout << 'L' << endl;\n\t\t\telse cout << 'I' << endl;\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\nint calc1(string str){//multiplication-first\n\tstack<int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push((int)stoi(rststr));\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t\tint tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\tint rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nint calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tint rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nint calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\tint rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\tcin >> str;\n\tint ans;\n\tcin >> ans;\n\tint rst1 = calc1(str);\n\tint rst2 = calc3(str);\n\t//cout << rst1 << \" \" << rst2 << endl;\n\tif(rst1==ans){\n\t\tif(rst2==ans) cout << 'U' << endl;\n\t\telse cout << 'M' << endl;\n\t}else{\n\t\tif(rst2==ans) cout << 'L' << endl;\n\t\telse cout << 'I' << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#define PB push_back\nusing namespace std;\nint MF(string str)\n{\n  vector<int> ans;\n  ans.PB(str[0]-'0');\n  for(int i=1;i<str.size();i+=2){\n    if(str[i]=='*')\n      ans[ans.size()-1]*=str[i+1]-'0';\n    else ans.PB(str[i+1]-'0');\n  }\n  int answer=0;\n  for(int i=0;i<ans.size();++i)\n    answer+=ans[i];\n  return answer;\n}\nint LF(string str)\n{\n  int answer;\n  answer=str[0]-'0';\n  for(int i=1;i<str.size();i+=2){\n    if(str[i]=='*')\n      answer*=str[i+1]-'0';\n    else answer+=str[i+1]-'0';;\n  }\n  return answer;\n}\nint main(void)\n{\n  string line;\n  int canans;\n  cin >> line;\n  cin >> canans;\n  int tmp=0;\n  if(MF(line)==canans) tmp+=1;\n  if(LF(line)==canans) tmp+=2;\n  string answer[4]={\"I\",\"M\",\"L\",\"U\"};\n  cout << answer[tmp] << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <cctype>\nusing namespace std;\n\ntypedef string::const_iterator iter;\nint factor(iter &p);\nint number(iter &p);\n\nint exprA(iter &p) {\n  // cerr << \"exprA\" << endl;\n  int res = number(p);\n  while(true) {\n    if(*p == '+') {\n      ++p;\n      res += number(p);\n    }\n    else if(*p == '*') {\n      ++p;\n      res *= number(p);\n    }\n    else break;\n  }\n  return res;\n}\n\nint exprB(iter &p) {\n  // cerr << \"exprB\" << endl;\n  int res = factor(p);\n  while(true) {\n    if(*p == '+') {\n      ++p;\n      res += factor(p);\n    }\n    else break;\n  }\n  return res;\n}\n\nint factor(iter &p) {\n  // cerr << \"factor\" << endl;\n  int res = number(p);\n  while(true) {\n    if(*p == '*') {\n      ++p;\n      res *= number(p);\n    }\n    else break;\n  }\n  return res;\n}\n\nint number(iter &p) {\n  // cerr << \"number\" << endl;\n  int res = 0;\n  while(isdigit(*p)) {\n    res *= 10;\n    res += *p - '0';\n    ++p;\n  }\n  return res;\n}\n\nint main() {\n  string S; cin >> S;\n  int T; cin >> T;\n  iter p;\n  p = S.begin();\n\tbool l2 = exprA(p)==T;\n  p = S.begin();\n\tbool l1 = exprB(p)==T;\n\tif (l1 && l2) cout << \"U\" << endl;\n\tif (l1 && !l2) cout << \"M\" << endl;\n\tif (l2 && !l1) cout << \"L\" << endl;\n\tif (!l2 && !l1) cout<< \"I\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <numeric>\n#include <set>\n#include <map>\n#include <queue>\n#include <iostream>\n#include <sstream>\n#include <cstdio>\n#include <cmath>\n#include <ctime>\n#include <cstring>\n#include <cctype>\n#include <cassert>\n#include <limits>\n#include <bitset>\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);++(i))\n#define rer(i,l,u) for(int (i)=(int)(l);(i)<=(int)(u);++(i))\n#define reu(i,l,u) for(int (i)=(int)(l);(i)<(int)(u);++(i))\n#if defined(_MSC_VER) || __cplusplus > 199711L\n#define aut(r,v) auto r = (v)\n#else\n#define aut(r,v) typeof(v) r = (v)\n#endif\n#define each(it,o) for(aut(it, (o).begin()); it != (o).end(); ++ it)\n#define all(o) (o).begin(), (o).end()\n#define pb(x) push_back(x)\n#define mp(x,y) make_pair((x),(y))\n#define mset(m,v) memset(m,v,sizeof(m))\n#define INF 0x3f3f3f3f\n#define INFL 0x3f3f3f3f3f3f3f3fLL\nusing namespace std;\ntypedef vector<int> vi; typedef pair<int,int> pii; typedef vector<pair<int,int> > vpii;\ntypedef long long ll; typedef vector<long long> vl; typedef pair<long long,long long> pll; typedef vector<pair<long long,long long> > vpll;\ntypedef vector<string> vs; typedef long double ld;\ntemplate<typename T, typename U> inline void amin(T &x, U y) { if(y < x) x = y; }\ntemplate<typename T, typename U> inline void amax(T &x, U y) { if(x < y) x = y; }\n\ntypedef const char *Pos;\nlong long number(Pos &p) {\n\tint i;\n\tlong long x;\n\tsscanf(p, \"%lld%n\", &x, &i);\n\tp += i;\n\treturn x;\n};\n\nlong long factor(Pos &p) {\n\tlong long x = number(p);\n\twhile(*p == '*') {\n\t\t++ p;\n\t\tlong long y = number(p);\n\t\tif(x * 1. * y > 1e10) x = INFL;\n\t\telse x *= y;\n\t}\n\treturn x;\n};\n\nlong long expr(Pos &p) {\n\tlong long x = factor(p);\n\twhile(*p == '+') {\n\t\t++ p;\n\t\tlong long y = factor(p);\n\t\tif(x + y > 1e10) x = INFL;\n\t\telse x += y;\n\t}\n\treturn x;\n}\n\nlong long expr2(Pos &p) {\n\tlong long x = number(p);\n\twhile(*p == '+' || *p == '*') {\n\t\tchar op = *p;\n\t\t++ p;\n\t\tlong long y = number(p);\n\t\tif(op == '*') {\n\t\t\tif(x * 1. * y > 1e10) x = INFL;\n\t\t\telse x *= y;\n\t\t}else {\n\t\t\tif(x + y > 1e10) x = INFL;\n\t\t\telse x += y;\n\t\t}\n\t}\n\treturn x;\n}\n\n\nint main() {\n\tchar *s = new char[20];\n\tscanf(\"%s\", s);\n\tlong long t;\n\tcin >> t;\n\tlong long x1, x2;\n\t{\tconst char *p = s;\n\t\tx1 = expr(p);\n\t}\n\t{\tconst char *p = s;\n\t\tx2 = expr2(p);\n\t}\n//\tcerr << x1 << \", \" << x2 << endl;\n\tif(t == x1 && t != x2)\n\t\tputs(\"M\");\n\telse if(t != x1 && t == x2)\n\t\tputs(\"L\");\n\telse if(t == x1 && t == x2)\n\t\tputs(\"U\");\n\telse\n\t\tputs(\"I\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <map>\n#include <set>\n#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <string>\n#include <time.h>\n#include <cctype>\n \n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define FFOR(i,a,b) for(int i=(a);i<=(b);i++)\n#define REP(i,b) FOR(i,0,b)\n#define RREP(i,b) FFOR(i,1,b)\n#define PB push_back\n#define F first\n#define S second\n#define BE(c) c.begin(),c.end()\nusing namespace std;\ntypedef long long LL;\ntypedef LL ut;\ntypedef long double ld;\ntypedef pair<ut,ut> pr;\ntypedef vector<pr> Vpr;\ntypedef vector<ut> VI;\ntypedef pair<ut,pr> ppr;\ntypedef priority_queue<pr,Vpr, greater<pr> > PQ;\nconst int SIZE=1e+5+10;\nconst ut INF=1<<30;\nconst ld eps=1e-6;\nconst LL mod=1e+9 + 7;\n\nvector<int> pp;\ntypedef string::const_iterator SC;\n\nint number(SC& begin){\n\tint res = 0;\n\t\n\twhile(isdigit(*begin)){\n\t\tres *= 10;\n\t\tres += *begin - '0';\n\t\tbegin++;\n\t}\n\t\n\treturn res;\n}\n\n// ?????????????¨??????????(int???)?????????\nint term(SC& begin){\n\tint res = number(begin);\n\t\n\twhile(1){\n\t\tif(*begin == '*'){\n\t\t\tbegin++;\n\t\t\tres *= number(begin);\n\t\t}\n\t\telse{\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\n// ?¶????????????????\nint expression(SC& begin){\n\tint res = term(begin);\n\t\n\twhile(1){\n\t\tif(*begin == '+'){\n\t\t\tbegin++;\n\t\t\tres += term(begin);\n\t\t}\n\t\telse{\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\nint main() {\n\tstring s;\n\tcin >> s;\n\tint n;\n\tcin >> n;\n\tif(s.size() == 1){\n\t\tcout << \"U\" << endl;\n\t\treturn 0;\n\t}\n\tbool mb = false, lb = false;\n\tbool plus = false;\n\tint m = s[0] - '0';\n\tFOR(i,1,s.size()){\n\t\tif(i % 2){\n\t\t\tplus = s[i] == '+';\n\t\t}\n\t\telse{\n\t\t\tif(plus)\n\t\t\t\tm += s[i] - '0';\n\t\t\telse\n\t\t\t\tm *= s[i] - '0';\n\t\t}\n\t}\n\tif(n == m)\n\t\tmb = true;\n\tSC begin = s.begin();\n\tint l = expression(begin);\n\t//cout << l << endl;\n\tif(n == l)\n\t\tlb = true;\n\tif(lb && mb){\n\t\tcout << \"U\" << endl;\n\t}\n\telse if(lb){\n\t\tcout << \"M\" << endl;\n\t}\n\telse if(mb){\n\t\tcout << \"L\" << endl;\t\n\t}\n\telse{\n\t\tcout << \"I\" << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nint main() {\n\tstring s;\n\tcin >> s;\n\tint ans;\n\tcin >> ans;\n\tint lr = s[0] - '0';\n\tREP(i, s.length() / 2){\n\t\tif (s[i * 2 + 1] == '+')\n\t\t\tlr += s[i * 2 + 2] - '0';\n\t\telse\n\t\t\tlr *= s[i * 2 + 2] - '0';\n\t}\n\tint mul = 0;\n\tvector<int> numbers;\n\tREP(i, s.length() / 2 + 1){\n\t\tnumbers.push_back(s[i * 2] - '0');\n\t}\n\tREP(i, (s.length() / 2)){\n\t\tif (s[i * 2 + 1] == '*'){\n\t\t\tnumbers[i + 1] *= numbers[i];\n\t\t\tnumbers[i] = 0;\n\t\t}\n\t}\n\tREP(i, numbers.size()){\n\t\tmul += numbers[i];\n\t}\n\tif (lr == ans&&mul == ans)\n\t\tcout << \"U\" << endl;\n\telse if (lr == ans)\n\t\tcout << \"L\" << endl;\n\telse if (mul == ans)\n\t\tcout << \"M\" << endl;\n\telse\n\t\tcout << \"I\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#include <cstdint>\n#include <sys/time.h>\n\ntypedef std::int_fast32_t  s32;\ntypedef std::uint_fast32_t u32;\ntypedef std::int_fast64_t  s64;\ntypedef std::uint_fast64_t u64;\n\nconst unsigned long mod = 1000000007;\n\nint expr(void);\nint term(void);\nint num(void);\n\nchar str[262144];\nint i;\n\nint expr(void) {\n  int res = term();\n  while( str[i] == '+' ) {\n    i += 1;\n    int temp = term();\n    res += temp;\n  }\n  return res;\n}\n\nint term(void) {\n  int res = num();\n  while( str[i] == '*' ) {\n    i += 1;\n    int temp = num();\n    res *= temp;\n  }\n  return res;\n}\n\nint num(void) {\n  int res = 0;\n  while( '0' <= str[i] and str[i] <= '9' ) {\n    res = res * 10 + (str[i] - '0');\n    i += 1;\n  }\n  return res;\n}\n\nint expr2(void) {\n  int res = num();\n  while( str[i] == '+' or str[i] == '*' ) {\n    char ope = str[i];\n    i += 1;\n    int temp = num();\n    if( ope == '+' ) {\n      res += temp;\n    }\n    else {\n      res *= temp;\n    }\n  }\n  return res;\n}                                           \n\nint main() {\n\n  int bob;\n  bool ans[2] = {false, false};\n  \n  scanf(\"%s\", str);\n  scanf(\"%d\", &bob);\n\n  i = 0;\n  if( bob == expr() ) {\n    ans[0] = true;\n  }\n\n  i = 0;\n  if( bob == expr2() ) {\n    ans[1] = true;\n  }\n\n  if( ans[0] and not ans[1] ) {\n    std::cout << \"M\" << std::endl;\n  }\n  else if( not ans[0] and ans[1] ) {\n    std::cout << \"L\" << std::endl;\n  }\n  else if( ans[0] and ans[1] ) {\n    std::cout << \"U\" << std::endl;\n  }\n  else {\n    std::cout << \"I\" << std::endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>  \nusing namespace std;\nconst int INF = 999;\n//世界一競技プログラミングができない人のソース2\n#define int long long\nint get_number(string str, int& idx){\n  int old = idx;\n  while(isdigit(str[idx])) ++idx;\n  return atoi(str.substr(old, idx - old).c_str());\n}\n\nint Expression(string str, int& idx){\n  int ret = get_number(str, idx);\n  while(true){\n    switch(str[idx]){\n    case '*':\n      ++idx;\n      ret *= get_number( str, idx);\n      break;\n    default:\n      return ret;\n    }\n  }\n}\n\nint nomal(string str, int idx = 0){\n  int res = Expression(str, idx);\n  while(true){\n    switch(str[idx]){\n    case '+':\n      ++idx;\n      res += Expression(str, idx);\n      break;\n    default:\n      return res;\n    }\n  }\n}\nint special(string str, int idx = 0){\n  int ret = get_number(str, idx);\n  while(str.size() > idx){\n    if(str[idx] == '+') ret += get_number(str, ++idx);\n    if(str[idx] == '*') ret *= get_number(str, ++idx);\n    else break;\n  }\n  return ret;\n}\n\nsigned main(){\n  string str;\n  cin >> str;\n  str += \"~\";\n  int digit;\n  cin >> digit;\n\n  bool judge_a = nomal(str) == digit;\n  bool judge_b = special(str) == digit;\n  if(judge_a & judge_b){\n    cout << \"U\" << endl;\n  } else if( judge_a){\n    cout << \"M\" << endl;\n  } else if( judge_b){\n    cout << \"L\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<vector>\nusing namespace std;\nint main(){\n\tchar s[200];\n\tint n,a,b,c,i;\n\tvector<int> v;\n\tscanf(\"%s\",s);\n\tscanf(\"%d\",&c);\n\ta=s[0]-'0';\n\tfor(i=2;s[i-1];i+=2){\n\t\tif(s[i-1]=='+') a+=(s[i]-'0');\n\t\telse a*=(s[i]-'0');\n\t}\n\tv.push_back(s[0]-'0');\n\tfor(i=2;s[i-1];i+=2){\n\t\tif(s[i-1]=='+') v.push_back(s[i]-'0');\n\t\telse v.back()*=(s[i]-'0');\n\t}\n\tb=0;\n\tfor(i=0;i<v.size();i++) b+=v[i];\n\tif(a==c&&b==c) printf(\"U\\n\");\n\telse if(a==c&&b!=c) printf(\"L\\n\");\n\telse if(a!=c&&b==c) printf(\"M\\n\");\n\telse printf(\"I\\n\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cassert>\n#include <tuple>\n#include <utility>\n#include <iostream>\nusing namespace std;\n\nusing ll = long long;\n\nstring expr;\nll a_ans;\n\nll calc1() {\n    ll ans = expr[0] - '0';\n    int idx = 1;\n    while (idx < expr.size()) {\n        char op = expr[idx];\n        ll v = expr[idx+1] - '0';\n\n        if (op == '+') ans += v;\n        if (op == '*') ans *= v;\n\n        idx += 2;\n    }\n\n    return ans;\n}\n\npair<ll, int> term(int idx) {\n    ll ret = expr[idx] - '0';\n    idx+=1;\n\n    while (idx < expr.size()) {\n        char op = expr[idx];\n        if (op == '+') break;\n        assert(op == '*');\n        ll v = expr[idx+1] - '0';\n        ret *= v;\n\n        idx += 2;\n    }\n\n    return make_pair(ret, idx);\n}\n\nll calc2() {\n    ll ans = 0, val;\n    int idx = 0, nidx;\n    while (idx < expr.size()) {\n        tie(val, nidx) = term(idx);\n        ans += val; idx = nidx;\n        idx += 1;\n    }\n    return ans;\n}\n\nint main() {\n    cin >> expr >> a_ans;\n    ll ans1 = calc1(), ans2 = calc2();\n\n    if (ans1 == a_ans && ans2 == a_ans) {\n        cout << \"U\";\n    } else if (ans1 == a_ans && ans2 != a_ans) {\n        cout << \"L\";\n    } else if (ans1 != a_ans && ans2 == a_ans) {\n        cout << \"M\";\n    } else {\n        cout << \"I\";\n    }\n    cout << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing iter = decltype(cbegin(string()))&;\n\nint num(iter it) {\n  assert(isdigit(*it));\n  return *it++ - '0';\n}\nint term(iter it) {\n  int res = num(it);\n  while (*it == '*') {\n    res *= num(++it);\n  }\n  return res;\n}\nint expr(iter it) {\n  int res = term(it);\n  while (*it == '+') {\n    res += term(++it);\n  }\n  return res;\n}\n\nint main() {\n  cin.tie(nullptr);\n  ios::sync_with_stdio(false);\n  string s;\n  cin >> s;\n  int n;\n  cin >> n;\n  auto it = cbegin(s);\n  int a = expr(it);\n  assert(*it == 0);\n  int b = s[0] - '0';\n  for (int i = 1; i < (int)s.size(); i += 2) {\n    if (s[i] == '+') {\n      b += s[i + 1] - '0';\n    } else {\n      b *= s[i + 1] - '0';\n    }\n  }\n  if (n == a and n == b) {\n    cout << \"U\\n\";\n  } else if (n == a) {\n    cout << \"M\\n\";\n  } else if (n == b) {\n    cout << \"L\\n\";\n  } else {\n    cout << \"I\\n\";\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <map>\n#include <set>\n#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <string>\n#include <time.h>\n \n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define FFOR(i,a,b) for(int i=(a);i<=(b);i++)\n#define REP(i,b) FOR(i,0,b)\n#define RREP(i,b) FFOR(i,1,b)\n#define PB push_back\n#define F first\n#define S second\n#define BE(c) c.begin(),c.end()\nusing namespace std;\ntypedef long long LL;\ntypedef LL ut;\ntypedef long double ld;\ntypedef pair<ut,ut> pr;\ntypedef vector<pr> Vpr;\ntypedef vector<ut> VI;\ntypedef pair<ut,pr> ppr;\ntypedef priority_queue<pr,Vpr, greater<pr> > PQ;\nconst int SIZE=1e+5+10;\nconst ut INF=1<<30;\nconst ld eps=1e-6;\nconst LL mod=1e+9 + 7;\n\nvector<int> pp;\n\nint main() {\n\tstring s;\n\tcin >> s;\n\tint n;\n\tcin >> n;\n\tif(s.size() == 1){\n\t\tcout << \"U\" << endl;\n\t\treturn 0;\n\t}\n\tbool mb = false, lb = false;\n\tbool plus = false;\n\tint m = s[0] - '0';\n\tFOR(i,1,s.size()){\n\t\tif(i % 2){\n\t\t\tplus = s[i] == '+';\n\t\t}\n\t\telse{\n\t\t\tif(plus)\n\t\t\t\tm += s[i] - '0';\n\t\t\telse\n\t\t\t\tm *= s[i] - '0';\n\t\t}\n\t}\n\tif(n == m)\n\t\tmb = true;\n\tfor(int i = 1; i < s.size();){\n\t\tif(s[i] == '*'){\n\t\t\tif(i > 1){\n\t\t\t\tstring tmp = s.substr(0, i - 1);\n\t\t\t\ttmp += to_string((s[i - 1] - '0') * (s[i + 1] - '0'));\n\t\t\t\ts = tmp + s.substr(i + 2, s.size() - i - 1);\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\t++i;\n\t\t}\n\t}\n\tREP(i,s.size()){\n\t\tif(s[i] == '+')\n\t\t\tpp.PB(i);\n\t}\n\tpp.PB(s.size());\n\tint l = 0;\n\tl = stoi(s.substr(0, pp[0]));\n\tREP(i,pp.size()-1){\n\t\tl += stoi(s.substr(pp[i], pp[i+1] - pp[i]));\n\t}\n\t//cout << l << endl;\n\tif(n == l)\n\t\tlb = true;\n\tif(lb && mb){\n\t\tcout << \"U\" << endl;\n\t}\n\telse if(lb){\n\t\tcout << \"M\" << endl;\n\t}\n\telse if(mb){\n\t\tcout << \"L\" << endl;\t\n\t}\n\telse{\n\t\tcout << \"I\" << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iostream>\n#include <list>\n#include <map>\n#include <memory>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\nusing namespace std;\n\n#define EPS 1e-10\n#define INF 1000000000\n#define mp make_pair\n#define pb push_back\n\ntypedef vector<int> vi;\ntypedef vector<vi> vii;\ntypedef pair<int,int> pii;\ntypedef long long ll;\n\nll calcWithMFR(string formula) {\n  ll first_num = 1, second_num = 0;\n  for (int i = 0; i < formula.size(); i++) {\n    if (formula[i] == '*') {\n      first_num *= second_num;\n      second_num = 0;\n      continue;\n    } else if (formula[i] == '+') {\n      return first_num * second_num + calcWithMFR(formula.substr(i+1));\n    }\n    int num = (int)(formula[i] - '0');\n    if (second_num == 0) {\n      second_num = num;\n    } else {\n      second_num = second_num * 10 + num;\n    }\n  }\n  first_num *= second_num;\n  return first_num;\n}\n\nll calcWithLRR(string formula) {\n  ll last_num = 0;\n  for (int i = formula.size() - 1; i >= 0; i--) {\n    if (formula[i] == '*') {\n      return calcWithLRR(formula.substr(0, i)) * last_num;\n    } else if (formula[i] == '+') {\n      return calcWithLRR(formula.substr(0, i)) + last_num;\n    }\n    int num = (int)(formula[i] - '0');\n    last_num += pow(10.0, (double)(formula.size() - i - 1)) * num;\n  }\n  return last_num;\n}\n\nint main() {\n  string formula;\n  cin >> formula;\n  ll a;\n  cin >> a;\n  if (calcWithMFR(formula) == a && calcWithLRR(formula) == a) {\n    cout << \"U\" << endl;\n  } else if (calcWithMFR(formula) == a) {\n    cout << \"M\" << endl;\n  } else if (calcWithLRR(formula) == a) {\n    cout << \"L\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\n\nint main(){\n\tstring f; cin >> f;\n\tint a; cin >> a;\n\tint n = f.size() / 2 + 1;\n\tint l = f[0] - '0';\n\tfor(int i = 0; i < n; i++){\n\t\tif(f[i*2+1] == '+'){\n\t\t\tl += f[i*2+2] - '0';\n\t\t}else{\n\t\t\tl *= f[i*2+2] - '0';\n\t\t}\n\t}\n\tvector<int> v;\n\tv.push_back(f[0] - '0');\n\tfor(int i = 0; i < n; i++){\n\t\tif(f[i*2+1] == '+'){\n\t\t\tv.push_back(f[i*2+2] - '0');\n\t\t}else{\n\t\t\tv[v.size() - 1] *= f[i*2+2] - '0';\n\t\t}\t\n\t}\n\tint m = 0;\n\tfor(int i = 0; i < m; i++) {\n\t\tm += v[i];\n\t}\n\tif(a==m && a==l) cout << 'U' << endl;\n\tif(a!=m && a==l) cout << 'L' << endl;\n\tif(a==m && a!=l) cout << 'M' << endl;\n\tif(a!=m && a!=l) cout << 'I' << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define dump(n) cout<<\"# \"<<#n<<'='<<(n)<<endl\n#define repi(i,a,b) for(int i=int(a);i<int(b);i++)\n#define peri(i,a,b) for(int i=int(b);i-->int(a);)\n#define rep(i,n) repi(i,0,n)\n#define per(i,n) peri(i,0,n)\n#define all(c) begin(c),end(c)\n#define mp make_pair\n#define mt make_tuple\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<string> vs;\n\nconst int INF=1e9;\nconst int MOD=1e9+7;\nconst double EPS=1e-9;\n\ntemplate<typename T1,typename T2>\nostream& operator<<(ostream& os,const pair<T1,T2>& p){\n\treturn os<<'('<<p.first<<','<<p.second<<')';\n}\ntemplate<typename T>\nostream& operator<<(ostream& os,const vector<T>& a){\n\tos<<'[';\n\trep(i,a.size()) os<<(i?\" \":\"\")<<a[i];\n\treturn os<<']';\n}\n\ntuple<ll,int> term(const string& s,int i)\n{\n\tll x=s[i++]-'0';\n\twhile(i<s.size() && s[i]=='*'){\n\t\ti++;\n\t\tx*=s[i++]-'0';\n\t}\n\treturn mt(x,i);\n}\nll expr(const string& s)\n{\n\tll x; int i;\n\ttie(x,i)=term(s,0);\n\twhile(i<s.size() && s[i]=='+'){\n\t\ti++;\n\t\tll y; tie(y,i)=term(s,i);\n\t\tx+=y;\n\t}\n\treturn x;\n}\n\nll calc(const string& s)\n{\n\tstack<ll> st;\n\tchar op;\n\tfor(int i=0;i<s.size();i++){\n\t\tif(isdigit(s[i])){\n\t\t\tst.push(s[i]-'0');\n\t\t\tif(st.size()==2){\n\t\t\t\tll b=st.top(); st.pop();\n\t\t\t\tll a=st.top(); st.pop();\n\t\t\t\tst.push(op=='+'?a+b:a*b);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\top=s[i];\n\t}\n\treturn st.top();\n}\n\nint main()\n{\n\tfor(string s;cin>>s && s!=\"#\";){\n\t\tll ans; cin>>ans;\n\t\t\n\t\tll infix=expr(s);\n\t\tll left=calc(s);\n\t\t\n\t\tif(infix==ans && left==ans)\n\t\t\tcout<<'U'<<endl;\n\t\telse if(infix==ans)\n\t\t\tcout<<'M'<<endl;\n\t\telse if(left==ans)\n\t\t\tcout<<'L'<<endl;\n\t\telse\n\t\t\tcout<<'I'<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint l_r_rule(string s)\n{\n    int len = s.length();\n    int res = 0;\n    char ope = '+';\n    for (int i = 0; i < len; i++)\n    {\n        if (i % 2 == 0)\n        { //??°???\n            if (ope == '+')\n                res += (s[i] - 48);\n            else\n                res *= (s[i] - 48);\n        }\n        else\n            ope = s[i];\n    }\n    return res;\n}\n\nint m_f_rule(string s)\n{\n    s += '+';\n    int len = s.length();\n    std::vector<int> v;\n    int tmp = -1;\n    for (int i = 0; i < len / 2; i++)\n    {\n        if (s[i * 2 + 1] == '+')\n        {\n            if (tmp == -1)\n                v.push_back((s[i * 2] - 48));\n            else\n                v.push_back(tmp);\n            tmp = -1;\n        }\n        else\n        {\n            if (tmp == -1)\n                tmp = (s[i * 2] - 48);\n            //cout <<tmp<<endl;\n            tmp *= (s[i * 2 + 2] - 48);\n            //cout <<tmp<<endl;\n        }\n    }\n    int vlen = v.size();\n    int res = 0;\n    for (int i = 0; i < vlen; i++)\n        res += v[i];\n    return res;\n}\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    string s;\n    int n;\n    cin >> s >> n;\n    int mans = m_f_rule(s);\n    int lans = l_r_rule(s);\n    // cout << mans<<\" \"<<lans<<endl;\n    if (mans == n && lans == n)\n        cout << \"U\" << endl;\n    else if (mans == n)\n        cout << \"M\" << endl;\n    else if (lans == n)\n        cout << \"L\" << endl;\n    else\n        cout << \"I\" << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n\nusing namespace std;\n\nvoid swap(int *a,int *b){\n\tint tmp = *a;\n\t*a = *b;\n\t*b = tmp;\n}\n\n\nint lFunc(string str){\n\t\n\tint num=str.at(0)-'0';\n\n\tfor(int i=1;i<str.size();i+=2){\n\t\tif(str.at(i)=='+'){\n\t\t\tnum+=(str.at(i+1)-'0');\n\t\t}\n\t\telse{\n\t\t\tnum*=(str.at(i+1)-'0');\n\t\t}\n\t}\n\n\treturn  num;\n}\n\nint uFunc(string str){\n\t\n\tint *dataNum;\n\tint *dataCal;\n\tint length = str.size()/2;\n\n\tdataNum = new int[str.size()/2+1];\n\tdataCal = new int[str.size()/2];\n\n\tfor(int i=0;i<str.size();i++){\n\t\tif(i%2==0){\n\t\t\tdataNum[i/2]=str.at(i)-'0';\n\t\t}\n\t\telse{\n\t\t\tif(str.at(i)=='+'){\n\t\t\t\tdataCal[i/2]=1;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tdataCal[i/2]=2;\n\t\t\t}\n\t\t}\n\t}\n\t/*\n\tfor(int k=0;k<length+1;k++){\n\t\tcout<<dataNum[k]<<\" \";\n\t}\n\tcout<<endl;\n\n\tfor(int k=0;k<length;k++){\n\t\tcout<<dataCal[k]<<\" \";\n\t}\n\tcout<<endl;\n\t*/\n\n\twhile(1){\n\t\tint flag=0;\n\n\t\tfor(int i=0;i<length;i++){\n\t\t\tif(dataCal[i]==2){\n\t\t\t\tdataNum[i]*=dataNum[i+1];\n\t\t\t\tflag=1;\n\n\t\t\t\tif(i<length-1){\n\t\t\t\t\tswap(&dataNum[i+1],&dataNum[i+2]);\n\t\t\t\t\tswap(&dataCal[i],&dataCal[i+1]);\n\t\t\t\t}\n\t\t\t\tlength--;\n\t\t\t}\n\t\t\t/*\n\t\t\tfor(int k=0;k<length+1;k++){\n\t\t\t\tcout<<dataNum[k]<<\" \";\n\t\t\t}\n\t\t\tcout<<endl;\n\n\t\t\tfor(int k=0;k<length;k++){\n\t\t\t\tcout<<dataCal[k]<<\" \";\n\t\t\t}\n\t\t\tcout<<endl;\n\t\t\t*/\n\t\t}\n\t\tif(flag==0)break;\n\t}\n\n\tint num=dataNum[0];\n\tfor(int i=1;i<=length;i++){\n\t\tnum+=dataNum[i];\n\t}\n//\tcout<<\"U=\"<<num<<endl;\n\n\treturn num;\n}\n\nint main(){\n\n\tstring str;\n\n\tcin>>str;\n\n\tint input;\n\tcin>>input;\n\n\tif(input==lFunc(str) && input==uFunc(str)){\n\t\tcout<<\"U\"<<endl;\n\t}\n\telse if(input == lFunc(str)){\n\t\tcout<<\"L\"<<endl;\n\t}\n\telse if(input == uFunc(str)){\n\t\tcout<<\"M\"<<endl;\n\t}\n\telse{\n\t\tcout<<\"I\"<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<n;i++)\n#define loop(i,s,n) for(int i=s;i<n;i++)\n#define all(in) in.begin(), in.end()\n#define rep(i,n) for(int i=0;i<n;i++)\n#define loop(i,s,n) for(int i=s;i<n;i++)\n#define all(in) in.begin(), in.end()\n#define MP make_pair\n#define INF (sizeof(int) == 4 ? 1e9:1e18)\n#define EPS 0.0000000001\nusing namespace std;\ntemplate<class T, class S> void cmin(T &a, const S &b) { if (a > b)a = b; }\ntemplate<class T, class S> void cmax(T &a, const S &b) { if (a < b)a = b; }\ntemplate<typename Head, typename Value> auto vectors(const Head &head, const Value &v) { return vector<Value>(head, v); }\ntemplate<typename Head, typename... Tail> auto vectors(Head x, Tail... tail) { auto inner = vectors(tail...); return vector<decltype(inner)>(x, inner); }\ntemplate<class T> void join(T a){for(auto itr :a){if(itr != *a.begin())cout << \" \"; cout << itr;} }\nusing ll  = long long;\nusing ld  = long double;\nusing pii = pair<int,int>;\nusing piii = pair<int,pii>;\nint W,H;\nint dx[]={0,0,1,-1}, dy[]={1,-1,0,0};\nbool valid(int x,int y){return (0<=x&&x<W)&&(0<=y&&y<H);}\nint calm(string s){\n        stack<int>num;\n    int res = 0;\n    rep(i,s.size()){\n        char c = s[i];\n        if(c == '*'){\n            int t = (s[++i]-'0') * num.top();\n            num.pop();\n            num.push(t);\n        } else if(c == '+'){\n        } else num.push(c-'0');\n    }\n    while(not num.empty()){res += num.top(); num.pop();}\n    return res;\n}\nint call(string s){\n    int res = 0;\n    rep(i,s.size()){\n        char c  = s[i];\n    if('0' <= c and c <= '9')res += c -'0';\n    else if(c == '*'){\n        res *= (s[++i] - '0');\n    } else\n        res += (s[++i] - '0');\n    }\n    return res;\n}\n#define int ll\nsigned main(){\n    string s; cin >> s;\n    int val; cin >> val;\n    int m = calm(s);\n    int l = call(s);\n    if(m == l and l == val) cout << \"U\" << endl;\n    else if(val == m) cout << \"M\" << endl;\n    else if(val == l)cout << \"L\" << endl;\n    else cout << \"I\" << endl;\n}\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define ll long long\nint main()\n{\n    char str[200];\n    int i,j,k,l,m;\n    ll n;\n    scanf(\"%s\",str);\n    scanf(\"%lld\",&n);\n    ll sum=0;\n     m=strlen(str);\n    for(int i=0;i<m;i+=2)\n    {\n      if(i==0)\n      {\n          sum=str[i]-48;\n          continue;\n      }\n      if(str[i-1]=='*')\n      {\n          sum=sum*(str[i]-48);\n      }\n      else sum=sum+str[i]-48;\n    }\n    ll sum2=0;\n    for(int i=0;i<m;)\n    {\n       // cout<<i<<endl;\n        for(j=i+1;j<m;j+=2){\n            if(str[j]=='*')continue;\n            break;\n        }\n        ll mul=1;\n        for(int k=i;k<j;k+=2)\n        {\n            mul=mul*(str[k]-48);\n        }\n\n        sum2+=mul;\n       // cout<<mul<<\" \"<<j<<\" \"<<(j+1)<<endl;\n        i=j+1;\n    }\n    if(n==sum&&sum==sum2)\n    {\n        printf(\"U\\n\");\n    }\n    else if(n!=sum&&n!=sum2)\n    {\n         printf(\"I\\n\");\n    }\n    else if(sum==n)\n    {\n        printf(\"L\\n\");\n    }\n    else printf(\"M\\n\");\n\n\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n\nint ite;\nint n;\nstring ex;\n\nll num();\nll L();\nll exp();\nll fac();\n\nll num() {\n\tassert(ite < n && isdigit(ex[ite]));\n\tll res = 0;\n\twhile (ite < n && isdigit(ex[ite])) {\n\t\tres += ex[ite] - '0';\n\t\tite++;\n\t}\n\treturn res;\n}\n\nll L() {\n\tll res = num();\n\twhile (ite < n) {\n\t\tif (ex[ite++] == '+') {\n\t\t\tres += num();\n\t\t}\n\t\telse {\n\t\t\tassert(ex[ite - 1] == '*');\n\t\t\tres *= num();\n\t\t}\n\t}\n\treturn res;\n}\n\nll exp() {\n\tll res = fac();\n\twhile (ite < n) {\n\t\tassert(ex[ite] == '+');\n\t\tite++;\n\t\tres += fac();\n\t}\n\treturn res;\n}\n\nll fac() {\n\tll res = num();\n\twhile (ite < n && ex[ite] == '*') {\n\t\tite++;\n\t\tres *= num();\n\t}\n\treturn res;\n}\n\nint main()\n{\n\tll val;\n\tcin >> ex >> val;\n\tn = ex.size();\n\tbool l = L() == val;\n\tite = 0;\n\tbool m = exp() == val;\n\tcout << (m ? l ? 'U' : 'M' : l ? 'L' : 'I') << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <cmath>\n#include <math.h>\nusing namespace std;\nint main(){\n\tstring a,s(\"0123456789\");\n\tint t;\n\tcin>>a>>t;\n\tint len=a.size();\n\tint a1[(len+1)/2];\n\tstring a2[(len-1)/2];\n\tfor(int i=0;i<(len+1)/2;i++){\n\t\tfor(int j=0;j<10;j++){\n\t\t\tif(s[j]==a[2*i]){\n\t\t\t\ta1[i]=j;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=0;i<(len-1)/2;i++){\n\t\ta2[i]=a[2*i+1];\n\t}\n\t//L\n\tint lt=a1[0];\n\tfor(int i=1;i<(len+1)/2;i++){\n\t\tif(a2[i-1]==\"+\"){\n\t\t\tlt=lt+a1[i];\n\t\t}\n\t\telse{\n\t\t\tlt=lt*a1[i];\n\t\t}\n\t}\n\t//M\n\tint mt=0;\n\tfor(int i=0;i<(len-1)/2;i++){\n\t\tif(a2[i]==\"*\"){\n\t\t\ta1[i+1]=a1[i+1]*a1[i];\n\t\t\ta1[i]=0;\n\t\t}\n\t}\n\tfor(int i=0;i<(len+1)/2;i++){\n\t\tmt=mt+a1[i];\n\t}\n\tif(t==mt){\n\t\tif(t==lt){\n\t\t\tcout<<\"U\"<<endl;\n\t\t}\n\t\telse{\n\t\t\tcout<<\"M\"<<endl;\n\t\t}\n\t}\n\telse{\n\t\tif(t==lt){\n\t\t\tcout<<\"L\"<<endl;\n\t\t}\n\t\telse{\n\t\t\tcout<<\"I\"<<endl;\n\t\t}\n\t}\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\ntypedef long double ld;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-10;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\n\nstring s;\nint n;\n\nint mpar()\n{\n\tvi v;\n\tv.push_back(s[0] - '0');\n\tFOR(i, 1, s.size())\n\t{\n\t\tif (s[i] == '+') v.push_back(s[i+1] - '0');\n\t\telse v.back() *= s[i + 1] - '0';\n\t\ti++;\n\t}\n\tint ans = 0;\n\tREP(i, v.size()) ans += v[i];\n\treturn ans;\n}\n\nint lpar()\n{\n\tint ans = s[0]-'0';\n\tFOR(i, 1, s.size())\n\t{\n\t\tint t = s[i + 1] - '0';\n\t\tif (s[i] == '+') ans += t;\n\t\telse ans *= t;\n\t\ti++;\n\t}\n\treturn ans;\n}\n\nint main()\n{\n\tcin >> s >> n;\n\tint l = lpar();\n\tint m = mpar();\n\tchar c;\n\tif (l==n&&m==n) c = 'U';\n\telse if (l == n) c = 'L';\n\telse if (m == n) c = 'M';\n\telse c = 'I';\n\tcout << c << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define MOD 1000000007\n#define INF 0x3f3f3f3f\n#define INFL 0x3f3f3f3f3f3f3f3f\n#define EPS (1e-10)\n#define rep(i,n)for(int i=0;i<n;i++)\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int>P;\n\nint res;\nvoid judge(int i, int j) {\n\tif (i == j&&i == res)puts(\"U\");\n\telse if (i == res)puts(\"L\");\n\telse if (j == res)puts(\"M\");\n\telse puts(\"I\");\n}\nint C(int a, int b, char c) {\n\tif (c == '+')return a + b;\n\treturn a*b;\n}\nint calc(string s) {\n\tint res = s[0] - '0';\n\tchar c;\n\tfor (int i = 1; i < s.size(); i++) {\n\t\tif ('0' <= s[i] && s[i] <= '9')res = C(res, s[i] - '0', c);\n\t\telse c = s[i];\n\t}\n\treturn res;\n}\nint main() {\n\tstring s, t, k; cin >> s >> res; t = s;\n\tint d = 0;\n\tfor (char c : s) {\n\t\tif (c == '+') {\n\t\t\td += calc(k); k = \"\";\n\t\t}\n\t\telse k += c;\n\t}\n\td += calc(k);\n\tjudge(calc(s), d);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nstring s;\nint p, T;\n\nint mul(), expr(), expr2(), factor();\n\n\nint mul()\n{\n\tcerr << \"mul()\" << endl;\n\tint res = s[p++];\n\tfor (;;) {\n\t\tcerr << \"s[p] : \" << s[p] << endl;\n\t\tif (s[p] == '*') {\n\t\t\tp++;\n\t\t\tres *= s[p];\n\t\t\tp++;\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t}\n\tcerr << res << endl;\n\treturn res;\n}\n\nint expr()\n{\n\tcerr << \"expr()\" << endl;\n\tint res = mul();\n\tfor (;;) {\n\t\t//cerr << s[p] << endl;\n\t\tif (p>s.size()) break;\n\t\tif (s[p] == '+') {\n\t\t\tp++;\n\t\t\tres += mul();\n\t\t\tp++;\n\t\t}\n\t}\n\treturn res;\n}\n\nint expr2()\n{\n\tcerr << \"expr2()\" << endl;\n\tint res=s[p++];\n\tfor (;;) {\n\t\tif (p>s.size()) break;\n\t\tif (s[p]=='+') {\n\t\t\tp++;\n\t\t\tres += s[p];\n\t\t\tp++;\n\t\t} else if (s[p] == '*') {\n\t\t\tp++;\n\t\t\tres *= s[p];\n\t\t\tp++;\n\t\t}\n\t}\n\treturn res;\n}\n\nint main()\n{\n\tcin>>s>>T;\n\t\n\tbool l1, l2;\n\tp = 0;\n\tl1 = expr()==T;\n\tp=0;\n\tl2 = expr2()==T;\n\t\n\tif (l1 && l2) cout << \"U\" << endl;\n\tif (l1 && !l2) cout << \"M\" << endl;\n\tif (l2 && !l1) cout << \"L\" << endl;\n\tif (!l2 && !l1) cout<< \"I\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define REP(x,y,z) for(int x=y;x<=z;x++)\n#define FORD(x,y,z) for(int x=y;x>=z;x--)\n#define MSET(x,y) memset(x,y,sizeof(x))\n#define FOR(x,y) for(__typeof(y.begin()) x=y.begin();x!=y.end();x++)\n#define F first\n#define S second\n#define MP make_pair\n#define PB push_back\n#define SZ size()\n#define M 20\n#define INF 1000000000\nvoid RI(){}\ntemplate<typename... T>\nvoid RI( int& head, T&... tail ) {\n    scanf(\"%d\",&head);\n    RI(tail...);\n}\nusing namespace std;\ntypedef long long LL;\nint n;\nvector<string> in;\nvoid read()\n{\n\tstring buf;\n\tcin >> buf;\n\n\tstring cur = \"\";\n\tREP(i,0,(int)buf.length()-1)\n\t{\n\t\tif(buf[i]>='0' && buf[i]<='9') cur += buf[i];\n\t\telse\n\t\t{\n\t\t\tif(cur.length()) in.PB(cur);\n\t\t\tcur = buf[i];\n\t\t\tin.PB( cur );\n\t\t\tcur = \"\";\n\t\t}\n\t}\n\tif(cur.length()) in.PB(cur);\n}\nint main()\n{\n\tbool a1=false, a2=false;\n\tread();\n\tRI(n);\n\n\t//1\n\tint op=0, x;\n\tLL cur=0, tmp;\n\tFOR(i,in)\n\t{\n\t\tif((*i)[0]>='0' && (*i)[0]<='9')\n\t\t{\n\t\t\ttmp = atoi(i->c_str());\n\t\t\tif(op==0) cur = cur + tmp;\n\t\t\telse      cur = cur * tmp;\n\t\t\tif(cur >= INF) break;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(*i == \"+\") op=0;\n\t\t\telse op=1;\n\t\t}\n\t}\n\ta1 = (n==cur);\n\n\n\t//2\n\tvector<LL> vec;\n\top = 0;\n\tFOR(i,in)\n\t{\n\t\tif(*i==\"+\") op=0;\n\t\telse if(*i==\"*\") op=1;\n\t\telse\n\t\t{\n\t\t\tx = atoi(i->c_str());\n\t\t\tif(op==1)\n\t\t\t{\n\t\t\t\ttmp = vec.back();\n\t\t\t\tvec.pop_back();\n\t\t\t\ttmp *= x;\n\t\t\t\tif(tmp >= INF) tmp = INF;\n\t\t\t\tvec.PB(tmp);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvec.PB(x);\n\t\t\t}\n\t\t}\n\t}\n\n\tcur = 0;\n\tcur = accumulate(vec.begin(), vec.end(), cur);\n\ta2 = (n==cur);\n\n\tif(a1 && a2) puts(\"U\");\n\tif(!a1 && !a2) puts(\"I\");\n\tif(a1 && !a2) puts(\"L\");\n\tif(!a1 && a2) puts(\"M\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) begin(a),end(a)\ntypedef pair<int, int> P;\ntypedef long long ll;\ntypedef vector<int> vi;\n#define D10  fixed<<setprecision(10)\n\n\n\nint main()\n{\n\tstring s; int n;\n\tcin >> s >> n;\n\tint t = s[0] - '0';\n\tbool m = false; bool l = false;\n\tREP(i, s.size())\n\t{\n\t\tif (s[i] == '+') t += s[i + 1] - '0';\n\t\tif (s[i] == '*') t *= s[i + 1] - '0';\n\t}\n\tif (t == n) m = true;\n\tbool update = true;\n\twhile (update)\n\t{\n\t\tupdate = false;\n\t\tREP(i, s.size())\n\t\t{\n\t\t\tif (s[i] == '*')\n\t\t\t{\n\t\t\t\tupdate = true;\n\t\t\t\ts[i - 1] = (s[i + 1] - '0')*(s[i - 1] - '0');\n\t\t\t\ts[i - 1] += '0';\n\t\t\t\ts.erase(i,2);\n\t\t\t}\n\t\t}\n\t}\n\tt = 0;\n\tREP(i, s.size())\n\t{\n\t\tif (s[i] != '+') t += s[i] - '0';\n\t}\n\tif (t == n) l = true;\n\tif (m&&l) puts(\"U\");\n\telse if (m) puts(\"L\");\n\telse if (l) puts(\"M\");\n\telse puts(\"I\");\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <sstream>\n\n#define REP(i,k,n) for(int i=k;i<n;i++)\n#define rep(i,n) for(int i=0;i<n;i++)\n\nusing namespace std;\ntypedef long long ll;\n\nvector<string> split(const string &str, char delim) {\n    vector<string> res;\n    size_t current = 0, found;\n    while((found = str.find_first_of(delim, current)) != string::npos) {\n        res.push_back(string(str, current, found - current));\n        current = found + 1;\n    }\n    res.push_back(string(str, current, str.size() - current));\n    return res;\n}\n\nint main() {\n    string S;\n    cin >> S;\n\n    ll n;\n    cin >> n;\n\n    string s = S;\n\n    while(true) {\n        bool F = true;\n        rep(i,s.size()) {\n            if(s[i] == '*') {\n                F = false;\n                int l = s[i-1]-'0';\n                int r = s[i+1]-'0';\n\n                stringstream ss;\n                rep(j,i-1) ss << s[j];\n                ss << l*r;\n\n                REP(j,i+2,s.size()) ss << s[j];\n\n                s = ss.str();\n                break;\n            }\n        }\n\n        if(F) break;\n    }\n\n    ll a = 0;\n    vector<string> ret = split(s,'+');\n    rep(i,ret.size()) {\n        stringstream ss;\n        ss << ret[i];\n\n        int t;\n        ss >> t;\n\n        a += t;\n    }\n\n    s = S;\n    ll b = s[0]-'0';\n    for(int i=1;i+1<s.size();i+=2) {\n        int r = s[i+1] - '0';\n\n        if(s[i] == '+') {\n            b += r;\n        }\n        else {\n            b *= r;\n        }\n    }\n\n    if(a == n && b == n) cout << \"U\" << endl;\n    else if(a == n) cout << \"M\" << endl;\n    else if(b == n) cout << \"L\" << endl;\n    else cout << \"I\" << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>  \nusing namespace std;\nconst int INF = 999;\n//世界一競技プログラミングができない人のソース2\n#define int long long\nint get_number(string str, int& idx){\n  int ret = 0;\n  while(isdigit(str[idx])){\n    ret = ret * 10 + str[idx] - '0';\n    ++idx;\n  }\n  return ret;\n}\n\nint Expression(string str, int& idx){\n  int ret = get_number(str, idx);\n  while(true){\n    switch(str[idx]){\n    case '*':\n      ++idx;\n      ret *= get_number( str, idx);\n      break;\n    default:\n      return ret;\n    }\n  }\n}\n\nint nomal(string str, int idx = 0){\n  int res = Expression(str, idx);\n  while(true){\n    switch(str[idx]){\n    case '+':\n      ++idx;\n      res += Expression(str, idx);\n      break;\n    default:\n      return res;\n    }\n  }\n}\nint special(string str, int idx = 0){\n  int ret = get_number(str, idx);\n  while(idx < str.size() - 1){\n    if(str[idx] == '+') ret += get_number(str, ++idx);\n    else if(str[idx] == '*') ret *= get_number(str, ++idx);\n    else break;\n  }\n  return ret;\n}\nsigned main(){\n  string str;\n  cin >> str;\n  str += \"~\";\n  int digit;\n  cin >> digit;\n\n  bool judge_a = nomal(str) == digit;\n  bool judge_b = special(str) == digit;\n  if(judge_a & judge_b){\n    cout << \"U\" << endl;\n  } else if( judge_a){\n    cout << \"M\" << endl;\n  } else if( judge_b){\n    cout << \"L\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(){\n  string s;\n  cin>>s;\n  int m=0,e=0,ans=1;\n  if(s[0]=='m')m++;\n  for(int i=1;i<s.size();i++){\n    if(s[i]=='m'){\n      if(!m)ans=0;\n      m++;\n    }\n    if(s[i]=='e'){\n      if(!m)ans=0;\n      e++,m--;\n    }\n    if(s[i]=='w'){\n      if(!e)ans=0;\n      e--;\n    }\n  }\n  if(ans&&m+e==0)cout<<\"Cat\"<<endl;\n  else cout<<\"Rabbit\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nnamespace {\n    string s;\n    int X;\n    void input() {\n        cin >> s;\n        cin >> X;\n    }\n\n    int calc(char op, int a, int b) {\n        if (op == '+') return a + b;\n        if (op == '*') return a * b;\n        assert(0);\n    }\n\n    int number(const string& s, int& index) {\n        int r = 0;\n        while (index < s.size() && isdigit(s[index])) {\n            r = r * 10 + (s[index] - '0');\n            index++;\n        }\n        return r;\n    }\n\n    int L(const string& s, int& index) {\n        int r = number(s, index);\n        while (index < s.size()) {\n            char op = s[index++];\n            int a = number(s, index);\n            r = calc(op, r, a);\n        }\n        return r;\n    }\n\n    int term(const string& s, int& index) {\n        int r = number(s, index);\n        while (index < s.size() && s[index] == '*') {\n            index++;\n            int a = number(s, index);\n            r *= a;\n        }\n        return r;\n    }\n\n    int M(const string& s, int& index) {\n        int r = term(s, index);\n        while (index < s.size()) {\n            assert(s[index] == '+');\n            index++;\n            int a = term(s, index);\n            r += a;\n        }\n        return r;\n    }\n\n    void solve() {\n        int index = 0;\n        int m = M(s, index);\n        index = 0;\n        int l = L(s, index);\n        if (m == X && l == X) {\n            cout << \"U\" << endl;\n        } else if (m != X && l != X) {\n            cout << \"I\" << endl;\n        } else if (m == X) {\n            cout << \"M\" << endl;\n        } else if (l == X) {\n            cout << \"L\" << endl;\n        }\n    }\n}\n\nint main() {\n    input(); solve();\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <sstream>\n\n#define REP(i,k,n) for(int i=k;i<n;i++)\n#define rep(i,n) for(int i=0;i<n;i++)\n\nusing namespace std;\ntypedef long long ll;\n\nint main() {\n    string S;\n    cin >> S;\n\n    int n;\n    cin >> n;\n\n    string s = S;\n\n    while(true) {\n        bool F = true;\n        rep(i,s.size()) {\n            if(s[i] == '*') {\n                F = false;\n                int l = s[i-1]-'0';\n                int r = s[i+1]-'0';\n\n                stringstream ss;\n                rep(j,i-1) ss << s[j];\n                ss << l*r;\n\n                REP(j,i+2,s.size()) ss << s[j];\n\n                s = ss.str();\n                break;\n            }\n        }\n\n        if(F) break;\n    }\n\n    int a = 0;\n    rep(i,s.size()) {\n        if('0' <= s[i] && s[i] <= '9') {\n            a += s[i] - '0';\n        }\n    }\n\n    s = S;\n    int b = s[0]-'0';\n    for(int i=1;i+1<s.size();i+=2) {\n        int r = s[i+1] - '0';\n\n        if(s[i] == '+') {\n            b += r;\n        }\n        else {\n            b *= r;\n        }\n    }\n\n    if(a == n && b == n) cout << \"U\" << endl;\n    else if(a == n) cout << \"M\" << endl;\n    else if(b == n) cout << \"L\" << endl;\n    else cout << \"I\" << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n#include<cstdio>\n#include<sstream>\n#include<algorithm>\n#include<cmath>\n#include<map>\n#include<functional>\nusing namespace std;\nint stoi(string x){stringstream ss;ss<<x;int tmp;ss>>tmp;return tmp;}\nstring itos(int x){stringstream ss;ss<<x;return ss.str();}\n//#define __int64 long long\n#define ll __int64 \nint main(){\n\tstring n,a,b,c,tmp;\n\tint a1,a2=0,a3=0;\n\tcin>>n;\n\tcin>>a1;\n\tvector<string>ta,ta2;\n\tfor(int i=0;i<n.size();i++){\n\tif(n[i]=='*'||n[i]=='+'){\n\tta.push_back(tmp);\n\tif(n[i]=='*')ta.push_back(\"*\");\n\tif(n[i]=='+')ta.push_back(\"+\");\n\ttmp.clear();\n\t}\n\telse tmp.push_back(n[i]);\n\t}\n\tta.push_back(tmp);\n\ta2=stoi(ta[0]);\n\tfor(int i=1;i<ta.size();i++){\n\t\tif(ta[i]==\"+\"){\n\t\ta2+=stoi(ta[i+1]);\n\t\ti++;\n\t\t}\n\t\tif(ta[i]==\"*\"){\n\t\ta2*=stoi(ta[i+1]);\n\t\ti++;\n\t\t}\n\t}\n\t\n\tfor(int i=0;i<ta.size();i++){\n\t\tif(ta[i]==\"*\"){\n\t\tta[i]=( itos( stoi(ta[i-1])*stoi(ta[i+1]) ) );\n\t\tta.erase(ta.begin()+i+1);\n\t\tta.erase(ta.begin()+i-1);\n\t\ti--;\n\t\t}\n\t}\n\tfor(int i=0;i<ta.size();i++){\n\tif(ta[i]!=\"+\")a3+=stoi(ta[i]);\n\t}\n\tif(a1==a2&&a1==a3)cout<<\"U\";\n\telse if(a1==a2)cout<<\"L\";\n\telse if(a1==a3)cout<<\"M\";\n\telse cout<<\"I\";\n\tcout<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//include\n//------------------------------------------\n#include <vector>\n#include <list>\n#include <map>\n#include <climits>\n#include <set>\n#include <deque>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <queue>\n#include <random>\n#include <cctype>\n#include <complex>\n#include <regex>\n\nusing namespace std;\n\n#define C_MAX(a, b) ((a)>(b)?(a):(b))\n#define SHOW_VECTOR(v) {std::cerr << #v << \"\\t:\";for(const auto& xxx : v){std::cerr << xxx << \" \";}std::cerr << \"\\n\";}\n#define SHOW_MAP(v) {std::cerr << #v << endl; for(const auto& xxx: v){std::cerr << xxx.first << \" \" << xxx.second << \"\\n\";}}\n\ntypedef string::const_iterator ParseState;\n\nclass ParseError {\n};\n\nint expression(ParseState &begin);\n\nint term(ParseState &begin);\n\nint factor(ParseState &begin);\n\nint number(ParseState &begin);\n\nint expression(ParseState &begin) {\n    int res = term(begin);\n    while (true) {\n        if (*begin != '+') break;\n        begin++;\n        res += term(begin);\n    }\n    return res;\n}\n\nint term(ParseState &begin) {\n    int res = number(begin);\n    while (true) {\n        if (*begin != '*') break;\n        begin++;\n        res *= number(begin);\n    }\n    return res;\n}\n\nint factor(ParseState &begin) {\n\n}\n\nint number(ParseState &begin) {\n    int ret = 0;\n    while (isdigit(*begin)) {\n        ret *= 10;\n        ret += *begin - '0';\n        begin++;\n    }\n    return ret;\n}\n\nint expression2(ParseState &begin) {\n    int res = number(begin);\n    while (true) {\n        if (*begin == '+') {\n            begin++;\n            res += (*begin - '0');\n            begin++;\n            continue;\n        } else if (*begin == '*') {\n            begin++;\n            res *= (*begin - '0');\n            begin++;\n            continue;\n        }\n        break;\n    }\n    return res;\n}\n\nint main() {\n\n    //  while (true) {\n\n    string s;\n    cin >> s;\n\n    int N;\n    cin >> N;\n\n    auto state1 = s.cbegin();\n    auto state2 = s.cbegin();\n\n    int res1 = expression(state1);\n    int res2 = expression2(state2);\n\n    //cout << res1 << res2 << endl;\n\n    if (res1 == res2 && res1 == N) {\n        cout << \"U\" << endl;\n    } else if (res1 == N && res2 != N) {\n        cout << \"M\" << endl;\n    } else if (res1 != N && res2 == N) {\n        cout << \"L\" << endl;\n    } else {\n        cout << \"I\" << endl;\n    }\n\n    //  }\n\n    return 0;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\n\nstring strerase(string instr,int num){\n\tstring rst = \"\";\n\tfor(int i=num;i<instr.size();i++){\n\t\trst += instr[i];\n\t}\n\treturn rst;\n}\nll int calc1(string str){//multiplication-first\n\tstack<ll int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push((ll int)stoi(rststr));\n\tif(rststr!=\"\") str = strerase(str,log10((double)stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr = strerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\tstr = strerase(str,(int)log10((double)tmp)+1);\n\t\t\tll int tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr = strerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr = strerase(str,(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\tll int rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nll int calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tll int rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str = strerase(str,(int)log10((double)rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr = strerase(str,1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr = strerase(str,1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nll int calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str = strerase(str,(int)log10((double)stoi(rststr))+1);\n\tll int rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr = strerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr = strerase(str,(int)log10((double)tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr = strerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr = strerase(str,(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\tcin >> str;\n\tll int ans;\n\tcin >> ans;\n\tll int rst1 = calc2(str);\n\tll int rst2 = calc3(str);\n\t//cout << rst1 << \" \" << rst2 << endl;\n\tif(rst1==ans){\n\t\tif(rst2==ans) cout << 'U' << endl;\n\t\telse cout << 'M' << endl;\n\t}else{\n\t\tif(rst2==ans) cout << 'L' << endl;\n\t\telse cout << 'I' << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<vector>\n#include<cstdlib>\nusing namespace std;\n\nint main(int argc, char *argv[]){\n  string s;\n  int n;\n  cin >> s >> n;\n  int LtoR = atoi(&s[0]), correct = 0;\n  for (int i = 1; i < s.length(); i+=2) {\n    if(s[i] == '+'){\n      LtoR += atoi(&s[i + 1]);\n    }else{\n      LtoR *= atoi(&s[i + 1]);\n    }\n  }\n  vector<int> remove_mal;\n  remove_mal.push_back(atoi(&s[0]));\n  for (int i = 1; i < s.length(); i+=2) {\n    if(s[i] == '*'){\n      remove_mal[remove_mal.size() - 1] *= atoi(&s[i + 1]);\n    }else{\n      remove_mal.push_back(atoi(&s[i + 1]));\n    }\n  }\n  for (int i:remove_mal){\n    //    std::cout << i << std::endl;\n    correct += i;\n  }\n  if(LtoR == correct && correct == n){\n    std::cout << \"U\" << std::endl;\n  }else if(LtoR == n){\n    std::cout << \"L\" << std::endl;\n  }else if(correct == n){\n    std::cout << \"M\" << std::endl;\n  }else{\n    std::cout << \"I\" << std::endl;\n  }\n   // std::cout << \"LtoR:   \" << LtoR    << std::endl;\n   // std::cout << \"correct:\" << correct << std::endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <map>\n#include <vector>\n\nusing namespace std;\n\nstring s;\nint p;\nint T;\n\nint number()\n{\n\tint res = s[p] - '0';\n\tp++;\n\treturn res;\n}\n\nint formula()\n{\n\tint res = number();\n\tfor (;;) {\n\t\tif (s[p] == '*') {\n\t\t\tp++;\n\t\t\tres *= number();\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\nint expr()\n{\n\tint res = number();\n\tfor (;;) {\n\t\tif (s[p] == '+') {\n\t\t\tp++;\n\t\t\tres += formula();\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\nint expr2()\n{\n\tint res = number();\n\tfor (;;) {\n\t\tif (s[p] == '+') {\n\t\t\tp++;\n\t\t\tres += number();\n\t\t}\n\t\telse if (s[p] == '*') {\n\t\t\tp++;\n\t\t\tres *= number();\n\t\t}\n\t\telse {\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\nint main()\n{\n\tcin >> s >> T;\n\n\tbool l1, l2;\n\tp = 0;\n\tl1 = expr() == T;\n\tp = 0;\n\tl2 = expr2() == T;\n\n\tif (l1 && l2) cout << \"U\" << endl;\n\tif (l1 && !l2) cout << \"M\" << endl;\n\tif (!l1 && l2) cout << \"L\" << endl;\n\tif (!l1 && !l2) cout << \"I\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\ntypedef int Val;\ntypedef pair<Val,int> Res;\n#define val first\n#define idx second\n\nRes readExpr(string &s, int idx);\nRes readTerm(string &s, int idx);\nRes readFctr(string &s, int idx);\n\nRes readExpr(string &s, int idx){\n  Res r = readTerm(s, idx);\n  while (s[r.idx]=='+'){\n    Res r2 = readTerm(s, r.idx+1);\n    r.val += r2.val;\n    r.idx = r2.idx;\n  }\n  return r;\n}\nRes readTerm(string &s, int idx){\n  Res r = readFctr(s, idx);\n  while (s[r.idx]=='*'){\n    Res r2 = readFctr(s, r.idx+1);\n    r.val *= r2.val;\n    r.idx = r2.idx;\n  }\n  return r;\n}\nRes readFctr(string &s, int idx){\n  return Res(s[idx]-'0',idx+1);\n}\nVal LtoR(string &s){\n  Val v;\n  v = s[0]-'0';\n  for (int i=1; i<s.size(); i+=2){\n    if (s[i]=='+') v += s[i+1]-'0';\n    else v *= s[i+1]-'0';\n  }\n  return v;\n}\n\nint main(void){\n  string ex;\n  int r,mul,ltr;\n  string buf=\"IMLU\";\n  \n  cin >> ex >> r;\n  mul = readExpr(ex,0).val;\n  ltr = LtoR(ex);\n  cout << buf[(mul==r)+(ltr==r)*2] << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<vector>\nusing namespace std;\nint main(){\n\tchar s[200];\n\tint n,a,b,c,i;\n\tvector<int> v;\n\tscanf(\"%s\",s);\n\tscanf(\"%d\",&c);\n\ta=s[i]-'0';\n\tfor(i=2;s[i];i++){\n\t\tif(s[i-1]=='+') a=a+(s[i]-'0');\n\t\telse a=a*(s[i]-'0');\n\t}\n\tv.push_back(s[i]-'0');\n\tfor(i=2;s[i];i++){\n\t\tif(s[i-1]=='+') v.push_back(s[i]-'0');\n\t\telse v.back()*=(s[i]-'0');\n\t}\n\tb=0;\n\tfor(i=0;i<v.size();i++) b+=v[i];\n\tif(a==c&&b==c) printf(\"U\\n\");\n\telse if(a==c&&b!=c) printf(\"L\\n\");\n\telse if(!a==c&&b==c) printf(\"M\\n\");\n\telse printf(\"I\\n\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <algorithm>\n#include <string>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cstring>\n#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n\n#define INF (int)1e09\n\nusing std::cin;\nusing std::cout;\nusing std::endl;\nusing std::setprecision;\nusing std::fixed;\nusing std::pair;\nusing std::make_pair;\nusing std::min;\nusing std::max;\nusing std::string;\nusing std::vector;\nusing std::list;\nusing std::map;\nusing std::set; // insert erase find count\nusing std::queue;\nusing std::priority_queue;\nusing std::stack;\n\ntemplate <typename T> using Vec = vector<T>; // c++11\ntypedef pair<int, int> PII;\ntypedef pair<int, pair<int, int> > PIII;\n\nint main(void) {\n    string exp;\n    cin >> exp;\n    const int exp_len = (int)exp.length();\n    int co_ans;\n    cin >> co_ans;\n\n    stack<int> calc_m;\n    for (int i = 0; i < exp_len; i++) {\n        if (i % 2 == 0) {\n            calc_m.push((int)(exp[i] - '0'));\n        } else {\n            if (exp[i] == '*') {\n                int mul = calc_m.top() * ((int)(exp[i + 1] - '0'));\n                calc_m.pop();\n                calc_m.push(mul);\n                i++;\n            }\n        }\n    }\n\n    int m = 0;\n    while (!calc_m.empty()) {\n        m += calc_m.top();\n        calc_m.pop();\n    }\n\n    int l = exp[0] - '0';\n    for (int i = 1; i < exp_len; i++) {\n        if (i % 2 == 1) {\n            if (exp[i] == '*') {\n                l *= (exp[i + 1] - '0');\n            } else {\n                l += (exp[i + 1] - '0');\n            }\n        }\n    }\n\n    if (co_ans == m && co_ans == l) {\n        cout << 'U' << endl;\n    } else if (co_ans == m) {\n        cout << 'M' << endl;\n    } else if (co_ans == l) {\n        cout << 'L' << endl;\n    } else {\n        cout << 'I' << endl;\n    } \n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint func1(string line) {\n    int res=0;\n    rep(i,line.size()) {\n        if(i==0) res=line[0]-'0';\n        else if(i%2==1) {\n            if(line[i]=='+') {\n                res+=line[i+1]-'0';\n            }\n            else {\n                res*=line[i+1]-'0';\n            }\n            i++;\n        }\n    }\n    return res;\n}\ntemplate<class T>\nstring to_s(T x) {\n    stringstream ss;\n    ss<<x;\n    return ss.str();\n}\nint to_i(string s) {\n    int res;\n    stringstream ss;\n    ss<<s;\n    ss>>res;\n    return res;\n}\nint func2(string line) {\n    vector<string> vec;\n    set<int> S;\n    rep(i,line.size()) {\n        if(line[i]=='+') {\n        }\n        else if(line[i]=='*') {\n            int x=(line[i-1]-'0')*(line[i+1]-'0');\n            vec.pb(to_s(x));\n            S.insert(i-1);\n            S.insert(i+1);\n        }\n    }\n    rep(i,line.size()) {\n        if(!S.count(i)) {\n            if(line[i]!='+'&&line[i]!='*') vec.pb(to_s(line[i]));\n        }\n    }\n    int res=0;\n    rep(i,vec.size()) res+=to_i(vec[i]);\n    return res;\n}\nstring line;\nint x;\nint main() {\n    cin>>line;\n    cin>>x;\n    int x1=func1(line);\n    int x2=func2(line);\n\n    if(x==x1&&x==x2) {\n        cout<<\"U\"<<endl;\n    }\n    else if(x==x1) {\n        cout<<\"L\"<<endl;\n    }\n    else if(x==x2) {\n        cout<<\"M\"<<endl;\n    }\n    else {\n        cout<<\"I\"<<endl;\n    }\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\nint main() {\n\tstring s; int n;\n\tcin >> s >> n;\n\tint len = s.length();\n\tvector<int> t;\n\trep(i, len) {\n\t\tif (s[i] == '+' || s[i] == '*')t.push_back(0);\n\t\telse t.push_back(s[i] - '0');\n\t}\n\tint m, l; m = 0; l = t[0];\n\trep(i, len) {\n\t\tif (s[i] == '+') {\n\t\t\tm += t[i - 1];\n\t\t\tl += t[i + 1];\n\t\t}\n\t\telse if(s[i]=='*'){\n\t\t\tl *= t[i + 1];\n\t\t\tt[i + 1] *= t[i-1];\n\t\t}\n\t}\n\tm += t[len - 1];\n\tif (m == n && l == n) {\n\t\tcout << \"U\" << endl;\n\t}\n\telse if (m == n) {\n\t\tcout << \"M\" << endl;\n\t}\n\telse if (l == n) {\n\t\tcout << \"L\" << endl;\n\t}\n\telse {\n\t\tcout << \"I\" << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\nstring s;\nlong long x;\n\nint main(){\n\tcin >> s;\n\tcin >> x;\n\tlong long t1 = 0, t2 = 0;\n\tint last_sign = 0;\n\tfor (int i=0;i<s.length();i+=2){\n\t\tif (last_sign){\n\t\t\tif (t1*(s[i]-'0') <= x)\n\t\t\t\tt1 = t1*(s[i]-'0');\n\t\t}else t1 += s[i]-'0';\n\t\tif (i+1 != s.length() and s[i+1] == '+') last_sign = 0;\n\t\telse last_sign = 1;\n\t}\n\tlong long current_multiple = 1;\n\tfor (int i=0;i<s.length();i++){\n\t\tif (s[i] == '+'){\n\t\t\tt2 += current_multiple;\n\t\t\tcurrent_multiple = 1;\n\t\t} else if (s[i] != '*'){\n\t\t\tif (s[i]=='0' or current_multiple <= x)\n\t\t\t\tcurrent_multiple *= s[i]-'0';\n\t\t}\n\t}\n\tt2+=current_multiple;\n\tif (t1 == x and t2!=x){\n\t\tcout << \"L\";\n\t}\n\telse if (t1!=x and t2==x){\n\t\tcout << \"M\";\n\t}\n\telse if (t1 == x and t2 == x){\n\t\tcout << \"U\";\n\t}\n\telse cout << \"I\";\n\tcout << \"\\n\";\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstring change(int a)\n{\n  stringstream ss;\n  ss << a;\n  return ss.str();\n}\n\nint main()\n{\n  string s;\n  stack<string> st1;\n  stack<string> st2;\n  int res1 = 0;\n  int res2 = 0;\n  int ans;\n  \n  cin >> s;\n  cin >> ans;\n  \n  for(int i = 0;i < s.size();i++){\n    string str = &s[i];\n    st1.push(str);\n    if(i < 2) continue;\n    \n    if(s[i-1] == '+'){\n      int a = atoi(st1.top().c_str());\n      st1.pop();\n      st1.pop();\n      int b = atoi(st1.top().c_str());\n      st1.pop();\n      st1.push(change(a+b));\n    }\n    else if(s[i-1] == '*'){\n      int a = atoi(st1.top().c_str());\n      st1.pop();\n      st1.pop();\n      int b = atoi(st1.top().c_str());\n      st1.pop();\n      st1.push(change(a*b));\n    }\n    //cout << \"***\" << st1.top() << endl;\n  }\n  res1 = atoi(st1.top().c_str());\n  st1.pop();\n  \n  for(int i = 0;i < s.size();i++){\n\n    if(s[i] == '+') continue;\n\n    string str = &s[i];\n    st2.push(str);\n    //cout << str << endl;\n    if(i < 2) continue;\n    \n    if(s[i-1] == '*'){\n      int a = atoi(st2.top().c_str());\n      st2.pop();//a\n      st2.pop();//*\n      int b = atoi(st2.top().c_str());\n      st2.pop();//b\n      st2.push(change(a*b));\n      //cout << \"***\" << st2.top() << endl;\n    }\n  }\n  while(!st2.empty()){\n    if(st2.top() == \"+\" || st2.top() == \"*\") st2.pop();\n    else{\n      res2 += atoi(st2.top().c_str());\n      st2.pop();\n      //cout << \"res2 == \" << res2 << endl;\n      //if(!st2.empty()) cout << st2.top() << endl;\n    }\n  }\n  //cout << res1 << endl << res2 << endl;\n  \n  if(res1 == ans && res2 == ans) cout << \"U\" << endl;\n  else if(res2 == ans) cout << \"M\" << endl;\n  else if(res1 == ans) cout << \"L\" << endl;\n  else cout << \"I\" << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cassert>\nusing namespace std;\n\nunsigned int cur = 0;\nstring S;\n\nint digit() {\n  return (int)(S[cur++] - '0');\n}\n\nlong long lrrule() {\n  long long a = digit();\n  while (cur < S.size()) {\n    char op = S[cur++];\n    if (op == '+') {\n      int b = digit();\n      a += b;\n    } else {\n      assert(op == '*');\n      int b = digit();\n      a *= b;\n    } \n  }\n  return a;\n}\n\n/*\n  先学期7月7日の資料を参考にすると、今回のBNFは\n  expression = term { '+' term }\n  term = digit { '*' digit }\n  digit = '0' | \\dots | '9' \n  となる。\n */\n\nlong long term() {\n  long long a = digit();\n  while (cur < S.size() && S[cur] == '*') {\n    cur++;\n    int b = digit();\n    a *= b;\n  }\n  return a;\n}\n\nlong long expression() {\n  long long a = term();\n  while (cur < S.size() && S[cur] == '+') {\n    cur++;\n    long long b = term();\n    a += b;\n  }\n  return a;\n}\n\nlong long mfrule() {\n  return expression();\n}\n\nint main() {\n  long long a;\n  cin >> S >> a;\n  cur = 0;\n  long long x = lrrule();\n  cur = 0;\n  long long y = mfrule();\n  // cerr << \"x = \" << x << \", y = \" << y << endl;\n  if (a == x && a == y) {\n    cout << \"U\" << endl;\n  } else if (a != x && a == y) {\n    cout << \"M\" << endl;\n  } else if (a == x && a != y) {\n    cout << \"L\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstring str;\n\nint cal1(){\n\n  int ans=0;\n  \n  for(int i=1 ; i <= str.size() ; i+=2){\n    if(str[i]=='+' || i == str.size()){\n      ans+=atoi(&str[i-1]);\n    }else if(str[i]=='*'){\n      int temp=atoi(&str[i-1]);\n      while(str[i] == '*'){\n\ttemp*=atoi(&str[i+1]);\n\ti+=2;\n      }\n      ans+=temp;\n    }\n  }\n  \n  return ans;\n}\nint cal2(){\n  \n  int ans=atoi(&str[0]);\n  \n  for(int i=1 ; i < str.size() ; i+=2){\n    int x=atoi(&str[i+1]);\n    if(str[i]=='+'){\n      ans+=x;\n    }else if(str[i]=='*'){\n      ans*=x;\n    }\n  }\n  \n  return ans;\n  \n}\nint main(){\n  \n  int x;\n  \n  cin >>str;\n  cin >>x;\n  \n  int ans1=cal1();\n  int ans2=cal2();\n  \n  if(x==ans1 && x==ans2){\n    cout <<\"U\"<<endl;\n  }else if(x==ans1){\n    cout <<\"M\"<<endl;\n  }else if(x==ans2){\n    cout <<\"L\"<<endl;\n  }else{\n    cout <<\"I\"<<endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nusing i64 = long long int;\nusing ui64 = unsigned long long int;\n\n////////////////////////////////\n\nint main()\n{\n  string s;\n  int ans;\n  cin >> s >> ans;\n  char prev = '+';\n  vector<int> m_terms;\n  int l_val = 0;\n  for(int i=0;i<s.length();i++){\n    if(i&1){\n      prev = s[i];\n    }else{\n      int val = s[i] - '0';\n      if(prev == '+'){\n        l_val += val;\n        m_terms.push_back(val);\n      }else{\n        l_val *= val;\n        m_terms[m_terms.size()-1] *= val;\n      }\n    }\n  }\n  int m_val = 0;\n  for(auto&& x:m_terms)m_val += x;\n  char res;\n  if(ans == m_val && ans == l_val) res = 'U';\n  else if(ans == m_val) res = 'M';\n  else if(ans == l_val) res = 'L';\n  else res = 'I';\n  cout << res << endl;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n\nusing namespace std;\n\nstruct before_main{before_main(){cin.tie(0); ios::sync_with_stdio(false);}} before_main;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntypedef long long ll;\nint const inf = 1<<29;\n\nint N;\nstring s;\n\nint expr(int l, int r);\n\nint term(int l, int r) {\n  if(l + 1 == r) {\n    return s[l] - '0';\n  }\n  if(l >= r) { return 0; }\n\n  int ret = 1;\n  REP(i, l, r+1) {\n    if(i == r || s[i] == '*') {\n      ret *= expr(l, i);\n      l = i + 1;\n    }\n  }\n  return ret;\n}\n\nint expr(int l, int r) {\n  if(l + 1 == r) {\n    return s[l] - '0';\n  }\n  if(l >= r) { return 0; }\n\n  int ret = 0;\n  REP(i, l, r+1) {\n    if(i == r || s[i] == '+') {\n      ret += term(l, i);\n      l = i + 1;\n    }\n  }\n  return ret;\n}\n\nint expr2() {\n  int ret = s[0] - '0';\n  int f = 0;\n  REP(i, 1, N) {\n    if(s[i] == '+') {\n      f = 1;\n    }\n    else if(s[i] == '*') {\n      f = 2;\n    }\n    else {\n      if(f == 1) {\n        ret += s[i] - '0';\n      }\n      else if(f == 2) {\n        ret *= s[i] - '0';\n      }\n      else {\n        assert(0);\n      }\n    }\n  }\n  return ret;\n}\n\nint main() {\n\n  cin >> s;\n  N = s.size();\n\n  auto m = expr(0, N);\n  auto l = expr2();\n\n  int n; cin >> n;\n  if(n == m && n == l) { cout << \"U\" << endl; }\n  else if(n == m) { cout << \"M\" << endl; }\n  else if(n == l) { cout << \"L\" << endl; }\n  else { cout << \"I\" << endl; }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstdlib>\n#include <stack>\nusing namespace std;\nstring s;\nlong long a;\nint f;\nchar* ans = \"ILMU\";\nint main()\n{\n\tcin>>s>>a;\n\tstack<long long> st;\n\tlong long v=0;\n\tfor (int i = 0; i < s.size(); i++)\n\t{\n\t\tif(i&1){\n\t\t\tif(s[i]=='+')\n\t\t\t\tv+=s[++i]-'0';\n\t\t\telse if(s[i]=='*')\n\t\t\t\tv*=s[++i]-'0';\n\t\t\telse;\n\t\t}\n\t\telse v=s[i]-'0';\n\t}\n\tif(v==a)f+=1;\n\tv=0;\n\tfor (int i = 0; i < s.size(); i++){\n\t\tif(i&1){\n\t\t\tif(s[i]=='*'){\n\t\t\t\tlong long top = st.top();st.pop();\n\t\t\t\ttop*=s[++i]-'0';\n\t\t\t\tst.push(top);\n\t\t\t}\n\t\t}\n\t\telse st.push(s[i]-'0');\n\t}\n\twhile(!st.empty()){\n\t\tv+=st.top();\n\t\tst.pop();\n\t}\n\tif(v==a)f+=2;\n\tcout<<ans[f]<<endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n#include <complex>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P > PP;\n\ntypedef complex<double> Point;\nconst static double EPS = 1e-12;\n\nint main(){\n  string expr;\n  int bob_ans;\n  while(cin >> expr >> bob_ans){\n    vector<char> ope;\n    vector<int> ope_pos;\n    vector<int> nums;\n    for(int i = 0; i< expr.size();i++){\n      if(isdigit(expr[i])){\n        int sum = 0;\n        while(i < expr.size() && isdigit(expr[i])){\n          sum *= 10;\n          sum += expr[i] - '0';\n          i++;\n        }\n        nums.push_back(sum);\n        i--;\n      }\n      else if(expr[i] == '+'){\n        ope.push_back(expr[i]);\n        ope_pos.push_back(i);\n      }\n      else if(expr[i] == '*'){\n        ope.push_back(expr[i]);\n        ope_pos.push_back(i);\n      }\n    }\n\n    vector<int> multi_first_num(nums);\n    vector<char> order;\n    order.push_back('*');\n    order.push_back('+');\n\n    bool used[1001];\n    memset(used,false,sizeof(used));\n\n    for(int order_i = 0; order_i < order.size(); order_i++){\n      for(int i = 0; i < ope.size();i++){\n        if(order[order_i] == ope[i]){\n          int res = 0;\n          if(ope[i] == '*') res = multi_first_num[i] * multi_first_num[i+1];\n          if(ope[i] == '+') res = multi_first_num[i] + multi_first_num[i+1];\n\n          for(int j = i+1; j < multi_first_num.size(); j++){\n            multi_first_num[j] = res;\n            if(j == multi_first_num.size() || !used[j]) break;\n          }\n          for(int j = i; j >= 0; j--){\n            multi_first_num[j] = res;\n            if(j == 0 || !used[j - 1]) break;\n          }\n\n          used[i] = true;\n        }\n      }\n    }\n\n\n    vector<int> left2right_num(nums);\n    memset(used,false,sizeof(used));\n\n    for(int i = 0; i < ope.size();i++){\n      int res = 0;\n      if(ope[i] == '*') res = left2right_num[i] * left2right_num[i+1];\n      if(ope[i] == '+') res = left2right_num[i] + left2right_num[i+1];\n      \n      for(int j = i+1; j < left2right_num.size(); j++){\n        left2right_num[j] = res;\n        if(j == left2right_num.size() || !used[j]) break;\n      }\n      for(int j = i; j >= 0; j--){\n        left2right_num[j] = res;\n        if(j == 0 || !used[j - 1]) break;\n      }\n      used[i] = true;\n    }\n\n    if(bob_ans == multi_first_num[0]\n       && bob_ans != left2right_num[0]){\n      printf(\"M\\n\");\n    }\n    else if(bob_ans != multi_first_num[0]\n            && bob_ans == left2right_num[0]){\n      printf(\"L\\n\");\n    }\n    else if(bob_ans == multi_first_num[0]\n            && bob_ans == left2right_num[0]){\n      printf(\"U\\n\");\n    }\n    else{\n      printf(\"I\\n\");\n    }\n  }    \n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nint comM(string str){\n  int res = str[0]-'0';\n  for(int i=0;i<str.size();i++) \n    if(str[i] == '*') {\n      if(i-2< 0 || str[i-2]=='*') res *= (str[i+1]-'0');\n      else if(i-2>=0 && str[i-2]=='+') res += ((str[i-1]-'0')*(str[i+1]-'0')-(str[i-1]-'0'));\n    } \n    else if(str[i]=='+') res += (str[i+1]-'0');\n  return res;\n} \n\nint comL(string str) {\n  int res = str[0]-'0';\n  for(int i=0;i<str.size();i++)\n    if(str[i] == '*') res *= (str[i+1]-'0');\n    else if(str[i]=='+') res += (str[i+1]-'0');\n  return res;\n}\n\nint main(){\n  string str;\n  cin >> str;\n  int n;\n  cin >> n;\n  int M = comM(str);\n  int L = comL(str);\n  //  cout << M<<endl;\n  //cout << L <<endl;\n  if(M==n && L == n) cout << \"U\"<<endl;\n  else if(M==n) cout << \"M\"<<endl;\n  else if(L==n) cout <<\"L\"<<endl;\n  else cout << \"I\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint mba(string s){\n  vector<int> t;\n  t.push_back(s[0] - '0');\n  for(int i = 1; i < s.size() ; i+=2){\n    if(s[i]=='+'){\n      t.push_back(s[i+1] - '0');\n    } else {\n      t.back() *= s[i+1] - '0';\n    }\n  }\n  int res = 0;\n  for(int i : t)res += i;\n  return res;\n}\nint ltr(string s){\n  int res = s[0] - '0';\n  for(int i = 1; i < s.size() ; i+=2){\n    if(s[i]=='+'){\n      res += s[i+1] - '0';\n    } else {\n      res *= s[i+1] - '0';\n    }\n  }\n  return res;\n}\nint main(){\n  string out = \"IMLU\";\n  string s; cin >> s;\n  int e; cin >> e;\n  cout << mba(s) << \",\" << ltr(s);\n  cout << out[(mba(s)==e) + 2*(ltr(s)==e)] << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cstdlib>\n\nusing std::cin;\nusing std::cout;\nusing std::endl;\n\nint cal_ltor(std::string str) {\n\tint num_l = 0;\n\tbool plus = true;\n\tfor (int i = 0; i < str.length(); i++) {\n\t\tif ( i%2 == 0 ) {\n\t\t\tif ( plus ) {\n\t\t\t\tnum_l += (int)(str[i] - '0');\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnum_l *= (int)(str[i] - '0');\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif ( str[i] == '+' ) {\n\t\t\t\tplus = true;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tplus = false;\n\t\t\t}\n\t\t}\n\t}\n\treturn num_l;\n}\n\nint cal_multi(std::string str) {\n\tint num_p = 0;\n\tint l = str.length();\n\tstd::vector<bool> cal(l, true);\n\tfor (int i = 0; i < l; i++) {\n\t\tif (str[i] == '*') {\n\t\t\tint end = i;\n\t\t\tint mv = 0;\n\t\t\tint pro = 1;\n\t\t\twhile ( end < l && str[end] != '+') {\n\t\t\t\tend++;\n\t\t\t\tmv++;\n\t\t\t}\n\t\t\tfor (int j = i-1; j < end; j++) {\n\t\t\t\tif ( j%2 == 0 ) {\n\t\t\t\t\tpro *= (int)(str[j] - '0');\n\t\t\t\t\tcal[j] = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tnum_p += pro;\n\t\t\ti += end - i;\n\t\t}\n\t}\n\tfor (int i = 0; i < l; i++) {\n\t\tif ( cal[i] && i%2 == 0 ) {\n\t\t\tnum_p += (int)(str[i] - '0');\n\t\t}\n\t}\n\treturn num_p;\n}\n\nint main(void) {\n\tstd::string str;\n\tcin >> str;\n\tint num_l = cal_ltor(str);\n\tint num_p = cal_multi(str);\n\n\tint ans;\n\tcin >> ans;\n\tif ( ans == num_l && ans == num_p ) {\n\t\tcout << \"U\" << endl;\n\t}\n\telse if ( ans == num_l ) {\n\t\tcout << \"L\" << endl;\n\t}\n\telse if ( ans == num_p ) {\n\t\tcout << \"M\" << endl;\n\t}\n\telse {\n\t\tcout << \"I\" << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "///\n// File:  1346.cpp\n// Author: ymiyamoto\n//\n// Created on Sun Nov 26 02:53:16 2017\n//\n\n#include <cstdint>\n#include <iostream>\n#include <stack>\n#include <string>\n\nusing namespace std;\n\nuint32_t mult_first(string exp)\n{\n  stack<int32_t> stack;\n  for (uint32_t i = 0; i < exp.size(); i++) {\n    if (i % 2 == 0) {\n      uint32_t val = exp[i] - '0';\n      stack.push(val);\n    } else {\n      char op = exp[i];\n      if (op == '*') {\n        i++;\n        uint32_t val1 = stack.top();\n        stack.pop();\n        uint32_t val2 = exp[i] - '0';\n        stack.push(val1 * val2);\n      }\n    }\n  }\n\n  uint32_t result = 0;\n  while (!stack.empty()) {\n    result += stack.top();\n    stack.pop();\n  }\n  return result;\n}\n\nuint32_t left_to_right(string exp)\n{\n  uint32_t result = exp[0] - '0';\n\n  uint32_t index = 1;\n  while (index < exp.size()) {\n    uint32_t val = exp[index + 1] - '0';\n    if (exp[index] == '+') {\n      result += val;\n    } else {\n      result *= val;\n    }\n    index += 2;\n  }\n  return result;\n}\n\nint32_t main()\n{\n  string exp;\n  cin >> exp;\n  uint32_t n;\n  cin >> n;\n\n  uint32_t result1 = mult_first(exp);\n  uint32_t result2 = left_to_right(exp);\n\n  if (result1 == n && result2 == n) {\n    cout << \"U\" << endl;\n  } else if (result1 == n) {\n    cout << \"M\" << endl;\n  } else if (result2 == n) {\n    cout << \"L\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"iostream\"\n#include \"climits\"\n#include \"list\"\n#include \"queue\"\n#include \"stack\"\n#include \"set\"\n#include \"functional\"\n#include \"algorithm\"\n#include \"string\"\n#include \"map\"\n#include \"unordered_map\"\n#include \"unordered_set\"\n#include \"iomanip\"\n#include \"cmath\"\n#include \"random\"\n#include \"bitset\"\n#include \"cstdio\"\n#include \"numeric\"\n#include \"cassert\"\n#include \"ctime\"\n\nusing namespace std;\n\nconstexpr long long int MOD = 1000000007;\n//constexpr int MOD = 1000000007;\n//constexpr int MOD = 998244353;\n//constexpr long long int MOD = 998244353;\nconstexpr double EPS = 1e-12;\n\n//int N, M, K, T, H, W, L, R;\nlong long int N, M, K, T, H, W, L, R;\n\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\n\tstring s;\n\tcin >> s;\n\tcin >> N;\n\tbool a = false, b = false;\n\tint anum = 0;\n\tbool add = true;\n\tint box = 0;\n\tfor (auto i : s) {\n\t\tif (i == '+') {\n\t\t\tadd = true;\n\t\t\tanum += box;\n\t\t\tbox = 0;\n\t\t}\n\t\telse if (i == '*') {\n\t\t\tadd = false;\n\t\t}\n\t\telse {\n\t\t\tif (add) {\n\t\t\t\tbox += i - '0';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbox *= i - '0';\n\t\t\t}\n\t\t}\n\t}\n\tanum += box;\n\tif (anum == N)a = true;\n\tint bnum = 0;\n\tadd = true;\n\tfor (auto i : s) {\n\t\tif (i == '+')add = true;\n\t\telse if (i == '*')add = false;\n\t\telse {\n\t\t\tif (add) {\n\t\t\t\tbnum += i - '0';\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbnum *= i - '0';\n\t\t\t}\n\t\t}\n\t}\n\tif (bnum == N)b = true;\n\tif (a&&b)cout << \"U\" << endl;\n\telse if (a)cout << \"M\" << endl;\n\telse if (b)cout << \"L\" << endl;\n\telse cout << \"I\" << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define fs first\n#define sc second\n#define mp make_pair\n#define pb push_back\n#define eb emplace_back\n#define ALL(A) A.begin(),A.end()\n#define RALL(A) A.rbegin(),A.rend()\ntypedef long long LL;\ntypedef pair<int,int> P;\nconst LL mod=1000000007;\nconst LL LINF=1LL<<62;\nconst LL INF=1<<17;\n\n\nint main(){\n    string s;\n    int m;\n    cin >> s >> m;\n    int n=s.length();\n    int a=s[0]-'0',b=0;\n    for (int i = 1; i < n; i+=2) {\n        if(s[i]=='+') a+=s[i+1]-'0';\n        else a*=s[i+1]-'0'; \n    }\n    bool c=false;\n    int t=1;\n    for (int i = 1; i < n; i+=2) {\n        if(s[i]=='+'){\n            if(c) b+=t*(s[i-1]-'0');\n            else b+=s[i-1]-'0';\n            t=1;\n            c=false;\n        }\n        else{\n            c=true;\n            t*=s[i-1]-'0';\n        }\n    }\n    if(c) b+=t*(s[n-1]-'0');\n    else b+=s[n-1]-'0';\n    if(m==a&&m==b) puts(\"U\");\n    else if(m==a&&m!=b) puts(\"L\");\n    else if(m!=a&&m==b) puts(\"M\");\n    else puts(\"I\");\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define INF_LL (int64)1e18\n#define INF (int32)1e9\n#define REP(i, n) for(int64 i = 0;i < (n);i++)\n#define FOR(i, a, b) for(int64 i = (a);i < (b);i++)\n#define all(x) x.begin(),x.end()\n#define fs first\n#define sc second\n\nusing int32 = int_fast32_t;\nusing uint32 = uint_fast32_t;\nusing int64 = int_fast64_t;\nusing uint64 = uint_fast64_t;\nusing PII = pair<int32, int32>;\nusing PLL = pair<int64, int64>;\n\nconst double eps = 1e-10;\n\ntemplate<typename A, typename B>inline void chmin(A &a, B b){if(a > b) a = b;}\ntemplate<typename A, typename B>inline void chmax(A &a, B b){if(a < b) a = b;}\n\ntemplate<typename T>\nvector<T> make_v(size_t a){return vector<T>(a);}\n\ntemplate<typename T,typename... Ts>\nauto make_v(size_t a,Ts... ts){\n  return vector<decltype(make_v<T>(ts...))>(a,make_v<T>(ts...));\n}\n\ntemplate<typename T,typename U,typename... V>\ntypename enable_if<is_same<T, U>::value!=0>::type\nfill_v(U &u,const V... v){u=U(v...);}\n\ntemplate<typename T,typename U,typename... V>\ntypename enable_if<is_same<T, U>::value==0>::type\nfill_v(U &u,const V... v){\n  for(auto &e:u) fill_v<T>(e,v...);\n}\n\nint64 expr(string &s, int64 &p);\nint64 term(string &s, int64 &p);\nint64 value(string &s, int64 &p);\n\nint64 expr(string &s, int64 &p) {\n  int64 res = term(s, p);\n  while (p < s.size()) {\n    if (s[p] == '+') {\n      p++;\n      res += term(s, p);\n      continue;\n    }\n    break;\n  }\n  return res;\n}\n\nint64 term(string &s, int64 &p) {\n  int64 res = value(s, p);\n  while (p < s.size()) {\n    if (s[p] == '*') {\n      p++;\n      res *= value(s, p);\n      continue;\n    }\n    break;\n  }\n  return res;\n}\n\nint64 value(string &s, int64 &p) {\n  return s[p++]-'0';\n}\n\nint64 expr2(string &s) {\n  int64 res = s[0]-'0';\n  FOR(i, 1, s.size()) {\n    if (s[i] == '+') {\n      res = res + s[i+1] -'0';\n      i++;\n    } else {\n      res = res * (s[i+1] - '0');\n      i++;\n    }\n  }\n  return res;\n}\n\nint main(void) {\n  string s;\n  int64 ret;\n  cin >> s >> ret;\n  string ans = \"ILMU\";\n  int64 p = 0;\n  int64 res = (ret == expr(s, p)) << 1 | (ret == expr2(s));\n  cout << ans[res] << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define REP(i,s,n) for(int i=s;i<n;i++)\n#define rep(i,n) REP(i,0,n)\n\nusing namespace std;\n\ntypedef long long ll;\nvector<char> op[2];\n\nclass Parsing{\nprivate:\n  string parse;\n  int pos;\npublic:\n \n  Parsing(string s){\n    parse = s;\n    pos = 0;\n  }\n\n  void reset(){ pos = 0; }\n\n  ll eval(ll a,ll b,char o){ return (o=='+')?a+b:a*b; }\n\n  int fact(){\n    ll p=0;\n    while('0' <= parse[pos] && parse[pos] <= '9'){\n      p *= 10LL;\n      p += (ll)( parse[pos]-'0' );\n      pos++;\n    }\n    return p;\n  }\n \n ll term(){\n    ll p = fact();\n    while( 1 ){\n      int index = -1;\n      rep(i,op[0].size()) if( op[0][i] == parse[pos] ) { index = i; break; }\n      if( index == -1 ) break;\n      ++pos;\n      ll q = fact();\n      p = eval(p,q,op[0][index]);\n    }\n    return p;\n  }\n \n ll expression(){\n   ll p = term();\n    while( 1 ){\n      int index = -1;\n      rep(i,op[1].size()) if( op[1][i] == parse[pos] ) { index = i; break; }\n      if( index == -1 ) break;\n\n      ++pos;\n      ll q = term();\n      p = eval(p,q,op[1][index]);\n\n    }\n    return p;\n  } \n \n};\n\n\nint main(int argc,char* argv[]){\n  string s;\n  getline(cin,s);\n  ll bob;\n  cin >> bob;\n  Parsing parser(s);\n  op[0].push_back('*');\n  op[1].push_back('+');\n  ll result1 = parser.expression();\n  parser.reset();\n  rep(i,2) op[i].clear();\n  op[0].push_back('+');\n  op[0].push_back('*');\n  ll result2 = parser.expression();\n  bool flag1 = ( bob == result1 );\n  bool flag2 = ( bob == result2 );\n  if( flag1 && !flag2 ) puts(\"M\");\n  else if( !flag1 && flag2 ) puts(\"L\");\n  else if( flag1 && flag2 ) puts(\"U\");\n  else puts(\"I\");\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  string str;\n  cin>>str;\n  int bob;\n  cin>>bob;\nint ans=str[0]-'0';\n int f;\n\n  for(int i=1;i<str.size();i++){\n    if(str[i]=='+')f=1;\n    else if(str[i]=='*')f=2;\n    if(str[i]>='0' && str[i]<='9'){\n      if(f==1) ans+=(str[i]-'0');\n      else if(f==2)ans*=(str[i]-'0');\n    }\n  }\n  char ansf='I';\n   if(ans==bob)ansf='L';\n    ans=0;\n  for(int i=1;i<str.size();i++){\n    int multi=0;\n    if(str[i]=='*'){\n      multi+=((str[i-1]-'0')*(str[i+1]-'0'));\n      str[i-1]='0',str[i+1]='0';\n      while(1){\n\ti++;\n\tif(i>=str.size()) break;\n\tif(str[i]=='*')multi*=(str[i+1]-'0'),str[i+1]='0';\n\telse if(str[i]=='+') break;\n      }\n    }\n    ans+=multi;\n  }\n      for(int i=0;i<str.size();i++)\n\tif(str[i]>='0' && str[i]<='9')ans+=(str[i]-'0');\n    if(ans==bob && ansf=='L') ansf='U';\n  else if(ans==bob)ansf='M';\n  cout<<ansf<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <stack>\n#include <string>\nusing namespace std;\n\nint main(){\n\tstring s;\n\tlong n;\n\tcin >> s >> n;\n\t\n\tbool a=false, b=false;\t\n\t\n\t//multiplication-first\n\tstack<long> st;\n\tint now=0;\n\tlong m=0;\n\twhile(now<s.size()){\n\t\tif('0'<=s[now] && s[now]<='9') st.push(s[now++]-'0');\n\t\telse{\n\t\t\tif(s[now]=='*'){\n\t\t\t\tlong v=st.top();\n\t\t\t\tst.pop();\n\t\t\t\tst.push(v*(s[now+1]-'0'));\n\t\t\t\tnow+=2;\n\t\t\t}\t\n\t\t\telse now++;\n\t\t}\t\t\n\t}\n\twhile(!st.empty()){\n\t\tm+=st.top();\n\t\tst.pop();\n\t}\n\t\n\tif(m==n) a=true;\n\t//printf(\" a: m=%ld\\n\", m);\n\t\n\t//left-to-right\n\tnow=0;\n\tm=0;\n\twhile(now<s.size()){\n\t\tif('0'<=s[now] && s[now]<='9') st.push(s[now++]-'0');\n\t\telse{\n\t\t\tif(s[now]=='*'){\n\t\t\t\tlong v=st.top();\n\t\t\t\tst.pop();\n\t\t\t\tst.push(v*(s[now+1]-'0'));\n\t\t\t\tnow+=2;\n\t\t\t}\n\t\t\telse if(s[now]=='+'){\n\t\t\t\tlong v=st.top();\n\t\t\t\tst.pop();\n\t\t\t\tst.push(v+(s[now+1]-'0'));\t\n\t\t\t\tnow+=2;\t\n\t\t\t}\t\n\t\t}\t\t\t\n\t}\n\twhile(!st.empty()){\n\t\tm+=st.top();\n\t\tst.pop();\n\t}\n\t\n\tif(m==n) b=true;\n\t//printf(\" b: m=%ld\\n\", m);\n\t\n\t\n\tif(a&&b) printf(\"U\\n\");\n\telse if(a&&!b) printf(\"M\\n\");\n\telse if(!a&&b) printf(\"L\\n\");\n\telse if(!a&&!b) printf(\"I\\n\");\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\nint main(){\n  string s;\n  cin>>s;\n  int n;\n  cin>>n;\n\n  int pu=0;\n  int ka=0;\n\n  vector<int> x(17,-1);\n  vector<int> f(17,-1);\n  int b=0;\n  int c=0;\n  for(int i=0;i<s.size();i++){\n    if(s[i]=='+'){\n      pu++;\n      f[c]=0;\n      b++;\n      c++;\n    }else if(s[i]=='*'){\n      ka++;\n      f[c]=1;\n      b++;\n      c++;\n    }else{\n      if(x[b]==-1)x[b]=0;\n      x[b]*=10;\n      x[b]+=s[i]-'0';\n    }\n  }\n  int lans=x[0];\n  for(int i=1;x[i]!=-1;i++){\n    if(f[i-1]==0)lans+=x[i];\n    if(f[i-1]==1)lans*=x[i];\n  }\n  //cout<<lans<<endl;\n\n  b=0;\n  c=0;\n  int tmp=1;\n  vector<int> tas;\n  //tmp=x[0];\n  for(int i=0;x[i]!=-1;i++){\n    if(f[c]==0){\n      tmp*=x[i];\n      tas.push_back(tmp);\n      //cout<<tmp<<\"aaa\"<<endl;\n      tmp=1;\n    }else{\n      tmp*=x[i];\n    }\n    b++;\n    c++;\n  }\n  tas.push_back(tmp);\n\n  int mans=0;\n  for(int i=0;i<tas.size();i++){\n    mans+=tas[i];\n    //cout<<tas[i]<<endl;\n  }\n\n  //cout<<lans<<\" \"<<mans<<endl;\n\n  if(n!=lans&&n!=mans){\n    cout<<\"I\"<<endl;\n    return 0;\n  }\n\n  if(pu<2){\n    cout<<\"U\"<<endl;\n    return 0;\n  }\n\n  if(n==mans){\n    cout<<\"M\"<<endl;\n    return 0;\n  }\n\n  if(n==lans){\n    cout<<\"L\"<<endl;\n    return 0;\n  }\n\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>  \nusing namespace std;\nconst int INF = 999;\n//世界一競技プログラミングができない人のソース2\n#define int long long\nint get_number(string str, int& idx){\n  int ret = 0;\n  while(isdigit(str[idx])){\n    ret = ret * 10 + str[idx] - '0';\n    ++idx;\n  }\n  return ret;\n}\n\nint Expression(string str, int& idx){\n  int ret = get_number(str, idx);\n  while(true){\n    switch(str[idx]){\n    case '*':\n      ++idx;\n      ret *= get_number( str, idx);\n      break;\n    default:\n      return ret;\n    }\n  }\n}\n\nint nomal(string str, int idx = 0){\n  int res = Expression(str, idx);\n  while(true){\n    switch(str[idx]){\n    case '+':\n      ++idx;\n      res += Expression(str, idx);\n      break;\n    default:\n      return res;\n    }\n  }\n}\nint special(string str, int pos = 0){\n    stack < int > st;\n    st.push(str[pos] - '0');\n    for (int i = pos + 1; i < str.length(); i++){\n        if (str[i] == '+'){\n            int a = st.top(); st.pop();\n            i++;\n            a += (str[i] - '0');\n            st.push(a);\n        }\n        else if (str[i] == '*'){\n            int a = st.top(); st.pop();\n            i++;\n            a *= (str[i] - '0');\n            st.push(a);\n        }\n    }\n     \n    return st.top();\n}\nsigned main(){\n  string str;\n  cin >> str;\n  str += \"~\";\n  int digit;\n  cin >> digit;\n\n  bool judge_a = nomal(str) == digit;\n  bool judge_b = special(str) == digit;\n  if(judge_a & judge_b){\n    cout << \"U\" << endl;\n  } else if( judge_a){\n    cout << \"M\" << endl;\n  } else if( judge_b){\n    cout << \"L\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nint comM(string str){\n  int res = str[0]-'0';\n  for(int i=0;i<str.size();i++) \n    if(str[i] == '*') {\n      res -= str[i-1]-'0';\n      res += (str[i-1]-'0') * (str[i+1]-'0');\n    } \n    else if(str[i]=='+') res += (str[i+1]-'0');\n  return res;\n} \n\nint comL(string str) {\n  int res = str[0]-'0';\n  for(int i=0;i<str.size();i++)\n    if(str[i] == '*') res *= (str[i+1]-'0');\n    else if(str[i]=='+') res += (str[i+1]-'0');\n  return res;\n}\n\nint main(){\n  string str;\n  cin >> str;\n  int n;\n  cin >> n;\n  int M = comM(str);\n  int L = comL(str);\n  if(M==n && L == n) cout << \"U\"<<endl;\n  else if(M==n) cout << \"M\"<<endl;\n  else if(L==n) cout <<\"L\"<<endl;\n  else cout << \"I\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstring str;\nint ans;\n\nint ruleM (string ex) {\n    int num = ex[0] - '0';\n    for (int i = 1; i < ex.size(); i += 2) {\n        if (ex[i] == '*') {\n            num *= ex[i + 1] - '0';\n        } else {\n            string tmp = string(ex.begin() + i + 1, ex.end());\n            num += ruleM(tmp);\n            break;\n        }\n    }\n\n    return num;\n}\n\nbool ruleL (string ex) {\n    int num = ex[0] - '0';\n    for (int i = 1; i < ex.size(); i += 2) {\n        if (ex[i] == '+') {\n            num += ex[i+1] - '0';\n        } else {\n            num *= ex[i+1] - '0';\n        }\n    }\n\n    return num == ans;\n}\n\nint main () {\n    cin >> str >> ans;\n\n    bool m = ruleM(str) == ans, l = ruleL(str);\n    if (!l && m) {\n        cout << \"M\" << endl;\n    } else if (!m && l) {\n        cout << \"L\" << endl;\n    } else if (m && l) {\n        cout << \"U\" << endl;\n    } else {\n        cout << \"I\" << endl;\n    }\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\nint calc1(string str){//multiplication-first\n\tstack<int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push((int)stoi(rststr));\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t\tint tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\tint rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nint calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tint rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nint calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\tint rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\tcin >> str;\n\tint ans;\n\tcin >> ans;\n\tint rst1 = calc2(str);\n\tint rst2 = calc3(str);\n\t//cout << rst1 << \" \" << rst2 << endl;\n\tif(rst1==ans){\n\t\tif(rst2==ans) cout << 'U' << endl;\n\t\telse cout << 'M' << endl;\n\t}else{\n\t\tif(rst2==ans) cout << 'L' << endl;\n\t\telse cout << 'I' << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "// Header {{{\n// includes {{{\n#include <algorithm>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <iostream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <sys/time.h>\n#include <unistd.h>\n#include <vector>\n// }}}\nusing namespace std;\n// consts {{{\nstatic const int INF = 1e9;\nstatic const double PI = acos(-1.0);\nstatic const double EPS = 1e-10;\n// }}}\n// typedefs {{{\ntypedef long long int LL;\ntypedef unsigned long long int ULL;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\ntypedef vector<ULL> VULL;\ntypedef vector<VULL> VVULL;\ntypedef vector<double> VD;\ntypedef vector<VD> VVD;\ntypedef vector<bool> VB;\ntypedef vector<VB> VVB;\ntypedef vector<char> VC;\ntypedef vector<VC> VVC;\ntypedef vector<string> VS;\ntypedef vector<VS> VVS;\ntypedef pair<int, int> PII;\ntypedef complex<int> P;\n// }}}\n// macros & inline functions {{{\n// syntax sugars {{{\n#define FOR(i, b, e) for (typeof(e) i = (b); i < (e); ++i)\n#define FORI(i, b, e) for (typeof(e) i = (b); i <= (e); ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define REPI(i, n) FORI(i, 0, n)\n#define OPOVER(_op, _type) inline bool operator _op (const _type &t) const\n// }}}\n// conversion {{{\ninline int toInt(string s) { int v; istringstream sin(s); sin>>v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout<<x; return sout.str(); }\n// }}}\n// array and STL {{{\n#define ARRSIZE(a) ( sizeof(a) / sizeof(a[0]) )\n#define ZERO(a, v) ( assert(v == 0 || v == -1), memset(a, v, sizeof(a)) )\n#define F first\n#define S second\n#define MP(a, b) make_pair(a, b)\n#define SIZE(a) ((LL)a.size())\n#define PB(e) push_back(e)\n#define SORT(v) sort((v).begin(), (v).end())\n#define RSORT(v) sort((v).rbegin(), (v).rend())\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EACH(c, it) for(typeof((c).begin()) it=(c).begin(); it!=(c).end(); ++it)\n#define REACH(c, it) for(typeof((c).rbegin()) it=(c).rbegin(); it!=(c).rend(); ++it)\n#define EXIST(s, e) ((s).find(e) != (s).end())\n// }}}\n// bit manipulation {{{\n// singed integers are not for bitwise operations, specifically arithmetic shifts ('>>', and maybe not good for '<<' too)\n#define IS_UNSIGNED(n) (!numeric_limits<typeof(n)>::is_signed)\n#define BIT(n) (assert(IS_UNSIGNED(n)), assert(n < 64), (1ULL << (n)))\n#define BITOF(n, m) (assert(IS_UNSIGNED(n)), assert(m < 64), ((ULL)(n) >> (m) & 1))\ninline int BITS_COUNT(ULL b) { int c = 0; while(b != 0) { c += (b & 1); b >>= 1; } return c; }\ninline int MSB(ULL b) { int c = 0; while(b != 0) { ++c; b >>= 1; } return c-1; }\ninline int MAKE_MASK(ULL upper, ULL lower) { assert(lower < 64 && upper < 64 && lower <= upper); return (BIT(upper) - 1) ^ (BIT(lower) - 1); }\n// }}}\n// for readable code {{{\n#define EVEN(n) (n % 2 == 0)\n#define ODD(n) (!EVEN(n))\n// }}}\n// debug {{{\n#define arrsz(a) ( sizeof(a) / sizeof(a[0]) )\n#define dprt(fmt, ...) if (opt_debug) { fprintf(stderr, fmt, ##__VA_ARGS__); }\n#define darr(a) if (opt_debug) { copy( (a), (a) + arrsz(a), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define darr_range(a, f, t) if (opt_debug) { copy( (a) + (f), (a) + (t), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define dvec(v) if (opt_debug) { copy( ALL(v), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define darr2(a) if (opt_debug) { FOR(__i, 0, (arrsz(a))){ darr( (a)[__i] ); } }\n#define dvec2(v) if (opt_debug) { FOR(__i, 0, v.size()){ dvec( (v)[__i] ); } }\n#define WAIT() if (opt_debug) { string _wait_; cerr << \"(hit return to continue)\" << endl; getline(cin, _wait_); }\n#define dump(x) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #x << \" = \" << (x) << endl; }\n#define dumpf() if (opt_debug) { cerr << __PRETTY_FUNCTION__ << endl; }\n#define dumpv(x) if (opt_debug) { cerr << \" [L:\" << __LINE__ << \"] \" << #x << \" = \"; REP(q, (x).size()) cerr << (x)[q] << \" \"; cerr << endl; }\n#define where() if (opt_debug) { cerr << __FILE__ << \": \" << __PRETTY_FUNCTION__ << \" [L: \" << __LINE__ << \"]\" << endl; }\n#define show_bits(b, s) if(opt_debug) { REP(i, s) { cerr << BITOF(b, s-1-i); if(i%4 == 3) cerr << ' '; } cerr << endl; }\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& s, const pair<T1, T2>& d) {return s << \"(\" << d.first << \", \" << d.second << \")\";}\ntemplate<typename T> ostream& operator<<(ostream& s, const complex<T>& d) {return s << \"(\" << d.real() << \", \" << d.imag() << \")\";}\n// }}}\n// }}}\n// time {{{\ninline double now(){ struct timeval tv; gettimeofday(&tv, NULL); return (static_cast<double>(tv.tv_sec) + static_cast<double>(tv.tv_usec) * 1e-6); }\n// }}}\n// string manipulation {{{\ninline VS split(string s, char delimiter) { VS v; string t; REP(i, s.length()) { if(s[i] == delimiter) v.PB(t), t = \"\"; else t += s[i]; } v.PB(t); return v; }\ninline string join(VS s, string j) { string t; REP(i, s.size()) { t += s[i] + j; } return t; }\n// }}}\n// geometry {{{\n#define Y real()\n#define X imag()\n// }}}\n// 2 dimentional array {{{\nP dydx4[4] = { P(-1, 0), P(0, 1), P(1, 0), P(0, -1) };\nP dydx8[8] = { P(-1, 0), P(0, 1), P(1, 0), P(0, -1), P(-1, 1), P(1, 1), P(1, -1), P(-1, -1) };\nint g_height, g_width;\nbool in_field(P p) {\n\treturn (0 <= p.Y && p.Y < g_height) && (0 <= p.X && p.X < g_width);\n}\n// }}}\n// }}}\nbool opt_debug = false;\n\nint main(int argc, char** argv) {\n\tstd::ios_base::sync_with_stdio(false);\n\t// set options {{{\n\tint __c;\n\twhile ( (__c = getopt(argc, argv, \"d\")) != -1 ) {\n\t\tswitch (__c) {\n\t\t\tcase 'd':\n\t\t\t\topt_debug = true;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tabort();\n\t\t}\n\t}\n\t// }}}\n\n\tstring str; cin >> str;\n\tint ans; cin >> ans;\n\n\tdump(str);\n\tdump(ans);\n\n\tint father_ans = str[0] - '0';\n\tfor (int i = 1; i < str.length() - 1; i += 2) {\n\t\tif (str[i] == '+') {\n\t\t\tfather_ans += str[i+1] - '0';\n\t\t} else {\n\t\t\tfather_ans *= str[i+1] - '0';\n\t\t}\n\t}\n\n\tdump(father_ans);\n\n\tint bob_ans = 0;\n\tVI terms;\n\tint len = str.length();\n\tfor (int i = 0; i < len; i += 2) {\n\t\tif (i == len - 1) {\n\t\t\tterms.PB(str[i] - '0');\n\t\t\tbreak;\n\t\t}\n\t\tint term = str[i] - '0';\n\t\twhile (i + 1 < len && str[i+1] == '*') {\n\t\t\ti += 2;\n\t\t\tterm *= str[i] - '0';\n\t\t}\n\t\tterms.PB(term);\n\t}\n\tREP (i, terms.size()) {\n\t\tbob_ans += terms[i];\n\t}\n\n\tdump(bob_ans);\n\n\tchar c;\n\tif (ans == father_ans && ans == bob_ans) {\n\t\tc = 'U';\n\t} else if (ans == father_ans) {\n\t\tc = 'L';\n\t} else if (ans == bob_ans) {\n\t\tc = 'M';\n\t} else {\n\t\tc = 'I';\n\t}\n\tcout << c << endl;\n\n\treturn 0;\n}\n\n// vim: foldmethod=marker"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n\nusing namespace std;\nbool isM(int n,string s)\n{\n\tvector<bool> used(s.length());\n\tfor (int i = 0; i < s.length(); i++)\n\t{\n\t\tused[i] = false;\n\t}\n\tbool flag = false;\n\tint sum = 0;\n\tfor (int i = 1; i < s.length(); i+= 2)\n\t{\n\t\tif (s[i] == '*')\n\t\t{\n\t\t\tif (used[i - 1])\n\t\t\t{\n\t\t\t\tsum *= (s[i + 1] - '0');\n\t\t\t\tused[i + 1] = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (!flag)\n\t\t\t\t{\n\t\t\t\t\tsum = (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t\t\tflag = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tsum *= (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t\t}\n\t\t\t\tused[i - 1] = true;\n\t\t\t\tused[i + 1] = true;\n\t\t\t}\n\t\t}\n\t}\n\tcout << sum << endl;\n\tfor (int i = 0; i < s.length(); i += 2)\n\t{\n\t\tif (used[i])continue;\n\t\tsum += (s[i] - '0');\n\t}\n\tif (n == sum)return true;\n\telse return false;\n}\n\nbool isL(int n,string s)\n{\n\tif (s.length() == 1 && s[0] - '0' == n)return true;\n\tint sum = 0;\n\tfor (int i = 1; i < s.length(); i += 2)\n\t{\n\t\tif (i == 1)\n\t\t{\n\t\t\tif (s[i] == '+')\n\t\t\t{\n\t\t\t\tsum = s[i - 1] - '0' + (s[i + 1] - '0');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsum = (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (s[i] == '+')\n\t\t\t{\n\t\t\t\tsum += (s[i + 1] - '0');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsum *= (s[i + 1] - '0');\n\t\t\t}\n\t\t}\n\t}\n\n\tif (sum == n)return true;\n\telse return false;\n}\n\nint main()\n{\n\tstring exp;\n\tint n;\n\tcin >> exp;\n\tcin >> n;\n\tif (isM(n, exp) && isL(n, exp))\n\t{\n\t\tcout << \"U\" << endl;\n\t}\n\telse if (isM(n,exp))\n\t{\n\t\tcout << \"M\" << endl;\n\t}\n\telse if (isL(n, exp))\n\t{\n\t\tcout << \"L\" << endl;\n\t}\n\telse\n\t{\n\t\tcout << \"I\" << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <stdio.h>\nusing namespace std;\nstring s;\nlong long ans;\nint cur;\nlong long suu(){\n  string num = \"\";\n  while(cur < s.size() && '0' <= s[cur] && s[cur] <= '9' ){\n\tfflush(stdout);\n\tnum += s[cur];\n\tcur++;\n  }\n\n  return stoll(num);\n}\nlong long kou(){\n  long long res = suu();\n  if(cur < s.size() && s[cur] == '*'){\n\tcur++;\n\tres *= kou();\n  }\n  return res;\n}\nlong long siki(){\n  long long res = kou();\t\n  if(cur < s.size() && s[cur] == '+'){\n\tcur++;\n\tres += siki();\n\n  }\n  return res;\n}\nlong long left_siki(){\n  long long res = suu();\n  char op;\n  while( cur < s.size() && ((op = s[cur]) == '+' || (op == '*') ) ){\n\tcur++;\n\tif(op == '+'){\n\t  res += suu();\n\t}else if(op == '*'){\n\t  res *=  suu();\n\t}\n  }\n  return res;\n}\nint main(){\n  cur = 0;\n  cin >> s >> ans;\n  long long res1 = siki();\n\n  cur = 0;\n  long long res2 = left_siki();\n  \n  int flag = 0;\n  if(res1 == ans){\n\tflag = 1;\n  }\n  if(res2 == ans){\n\tflag |= 2;\n  }\n\n  if(flag == 0)cout << \"I\" << endl;\n  else if(flag == 3)cout << \"U\" << endl;\n  else if(flag == 1) cout << \"M\" << endl;\n  else if(flag == 2) cout << \"L\" << endl;\n  \n  return 0;\n  \n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\nstring s;\nlong long x;\n\nint main(){\n\tcin >> s;\n\tcin >> x;\n\tlong long t1 = 0, t2 = 0;\n\tint last_sign = 0;\n\tfor (int i=0;i<s.length();i+=2){\n\t\tif (last_sign){\n\t\t\tt1 = t1*(s[i]-'0');\n\t\t}else t1 += s[i]-'0';\n\t\tif (t1>x) break;\n\t\tif (i+1 != s.length() and s[i+1] == '+') last_sign = 0;\n\t\telse last_sign = 1;\n\t}\n\tlong long current_multiple = 1;\n\tfor (int i=0;i<s.length();i++){\n\t\tif (s[i] == '+'){\n\t\t\tt2 += current_multiple;\n\t\t\tcurrent_multiple = 1;\n\t\t} else if (s[i] != '*'){\n\t\t\tif (s[i]=='0' or current_multiple <= x)\n\t\t\t\tcurrent_multiple *= s[i]-'0';\n\t\t}\n\t}\n\tt2+=current_multiple;\n\tif (t1 == x and t2!=x){\n\t\tcout << \"L\";\n\t}\n\telse if (t1!=x and t2==x){\n\t\tcout << \"M\";\n\t}\n\telse if (t1 == x and t2 == x){\n\t\tcout << \"U\";\n\t}\n\telse cout << \"I\";\n\tcout << \"\\n\";\n}"
  },
  {
    "language": "C++",
    "code": "#include <cassert>\n\n#include <cctype>\n#include <cerrno>\n#include <cfloat>\n#include <ciso646>\n#include <climits>\n#include <clocale>\n#include <cmath>\n#include <csetjmp>\n#include <csignal>\n#include <cstdarg>\n#include <cstddef>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <ccomplex>\n#include <cfenv>\n#include <cinttypes>\n#include <cstdbool>\n#include <cstdint>\n#include <ctgmath>\n#include <cwchar>\n#include <cwctype>\n\n// C++\n#include <algorithm>\n#include <bitset>\n#include <complex>\n#include <deque>\n#include <exception>\n#include <fstream>\n#include <functional>\n#include <iomanip>\n#include <ios>\n#include <iosfwd>\n#include <iostream>\n#include <istream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <locale>\n#include <map>\n#include <memory>\n#include <new>\n#include <numeric>\n#include <ostream>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <stdexcept>\n#include <streambuf>\n#include <string>\n#include <typeinfo>\n#include <utility>\n#include <valarray>\n#include <vector>\n#include <array>\n#include <atomic>\n#include <chrono>\n#include <condition_variable>\n#include <forward_list>\n#include <future>\n#include <initializer_list>\n#include <mutex>\n#include <random>\n#include <ratio>\n#include <regex>\n#include <scoped_allocator>\n#include <system_error>\n#include <thread>\n#include <tuple>\n#include <typeindex>\n#include <type_traits>\n#include <unordered_map>\n#include <unordered_set>\n//#include <boost/foreach.hpp>\n//#include <boost/range/algorithm.hpp>\n#define rep(i,j,k) for(int i=(int)j;i<(int)k;i++)\n#define ll long long\n#define Sort(v) sort(all(v))\n#define INF 1e9\n#define LINF 1e18\n#define END return 0\n#define pb push_back\n#define se second\n#define fi first\n#define pb push_back\n#define all(v) (v).begin() , (v).end()\n#define MP make_pair\n#define MOD 1000000007LL\n//#define int long long\nusing namespace std;\nint day[12]={31,28,31,30,31,30,31,31,30,31,30,31};\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\nstruct edge{int to,cost;};\ntypedef pair<int,int> P;\n\nbool isupper(char c){if('A'<=c&&c<='Z')return 1;return 0;}\nbool islower(char c){if('a'<=c&&c<='z')return 1;return 0;}\nbool isPrime(int x){if(x==1)return 0;if(x==2)return 1;if(x%2==0)return 0;for(int i=3;i*i<=x;i++)if(x%i==0)return 0;return 1;}\nbool iskaibun(string s){for(int i=0;i<s.size()/2;i++)if(s[i]!=s[s.size()-i-1])return 0;return 1;}\nbool isnumber(char c){return ('0'<=c&&c<='9');}\nbool isalpha(char c){return (isupper(c)&&islower(c));}\nvoid printvi(vector<int> v){rep(i,0,v.size()){if(i)cout<<\" \";cout<<v[i];}cout<<endl;}\nvoid printvil(vector<int> v){rep(i,0,v.size()){cout<<v[i]<<endl;}}\nvoid printvvi(vector<vector<int>> v){\n    rep(i,0,v.size()){\n        rep(j,0,v[i].size()){\n            if(j)cout<<\" \";\n            cout<<v[i][j];\n        }\n        cout<<endl;\n    }\n}\nvoid printvstr(vector<string> v){\n    rep(i,0,v.size()){\n        cout<<v[i]<<endl;\n    }\n}\n\nstruct S{\n    double a,b,c;\n};\n\ndouble culc(S a,S b){\n    return (a.a-b.a)*(a.a-b.a)+(a.b-b.b)*(a.b-b.b)+(a.c-b.c)*(a.c-b.c);\n}\n\nsigned main (){\n    string s;\n    cin>>s;\n    int n;cin>>n;\n    bool M=false,L=false;\n    int MM=0,LL=s[0]-'0';\n    for(int i=2;i<s.size();i+=2){\n        if(s[i-1]=='+')LL+=s[i]-'0';\n        else LL*=s[i]-'0';\n    }\n    if(n==LL)L=true;\n\n    vector<int> nums;\n    for(int i=0;i<s.size();i+=2){\n            int num=s[i]-'0';\n            while(i+1<s.size() and s[i+1]=='*'){\n                i+=2;\n                num*=s[i]-'0';\n            }\n            nums.emplace_back(num);\n    }\n    rep(i,0,nums.size()){\n        MM+=nums[i];\n    }\n    //cout<<\"LL,MM\"<<\" \"<<LL<<\" \"<<MM<<endl;\n    if(MM==n)M=true;\n    if(M&&L)cout<<\"U\"<<endl;\n    else if(!M&&L)cout<<\"L\"<<endl;\n    else if(M&&!L)cout<<\"M\"<<endl;\n    else cout<<\"I\"<<endl;\n    \n    \n}\n/*\n*/\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\nint ctoi(char c) {\n\tint i; char ch = '1';\n\tfor (i = 1; i < 10; i++){\n\t\tif (c == ch)return i;\n\t\telse ch++;\n\t}\n\treturn -1;\n}\nint main() {\n\tstring s; cin >> s;\n\tint ans1, ans2, anss = 0;\n\tfor (int i = 0; i < s.size(); i += 2) {\n\t\tif (i == 0) { ans1 = ctoi(s[i]); ans2 = ctoi(s[i]); }\n\t\telse if (i % 2 == 0) {\n\t\t\tif (s[i - 1] == '+') {\n\t\t\t\tans1 += anss;\n\t\t\t\tanss = ctoi(s[i]);\n\t\t\t\tans2 += ctoi(s[i]);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tanss *= ctoi(s[i]);\n\t\t\t\tans2 *= ctoi(s[i]);\n\t\t\t}\n\t\t}\n\t}\n\tans1 += anss;\n\tint v; cin >> v;\n\tif (ans1 == v) {\n\t\tif (ans2 == v)\n\t\t\tcout << \"U\\n\";\n\t\telse\n\t\t\tcout << \"M\\n\";\n\t}\n\telse {\n\t\tif (ans2 == v)\n\t\t\tcout << \"L\\n\";\n\t\telse\n\t\t\tcout << \"I\\n\";\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n\nusing namespace std;\n\npair<int,int> factor(string s, int i) {\n  int num = s[i] - '0';\n  while(++i < s.size() && s[i] == '*') {\n    num *= s[++i] - '0';\n  }\n  return make_pair(num, i);\n}\n\nint expr(string s) {\n  int num, i;\n  tie(num, i) = factor(s, 0);\n  while(i < s.size()) {\n    int p, j;\n    tie(p, j) = factor(s, i+1);\n    num += p;\n    i = j;\n  }\n  return num;\n}\n\nint expr2(string s) {\n  int i = 0;\n  int num = s[i] - '0';\n  while(++i < s.size()) {\n    if (s[i] == '*')\n      num *= s[++i] - '0';\n    else\n      num += s[++i] - '0';\n  }\n  return num;\n}\n\nint main() {\n  string s;\n  cin>>s;\n  int ans;\n  cin>>ans;\n  int bob = expr2(s);\n  int calc = expr(s);\n  if (ans == bob) {\n    if (ans == calc) {\n      cout << 'U' << endl;\n    } else {\n      cout << 'L' << endl;\n    }\n  } else {\n    if (ans == calc) {\n      cout << 'M' << endl;\n    } else {\n      cout << 'I' << endl;\n    }\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\n\nstring strerase(string instr,int num){\n\tstring rst = \"\";\n\tfor(int i=num;i<instr.size();i++){\n\t\trst += instr[i];\n\t}\n\treturn rst;\n}\nll int calc1(string str){//multiplication-first\n\tstack<ll int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push((ll int)stoi(rststr));\n\tif(rststr!=\"\") strerase(str,log10((double)stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstrerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\tstr.erase(str,(int)log10((double)tmp)+1);\n\t\t\tll int tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.rase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr.erase(str,(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\tll int rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nll int calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tll int rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") strerase(str,(int)log10((double)rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstrerase(str,1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstrerase(str,1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nll int calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") strerase(str,(int)log10((double)stoi(rststr))+1);\n\tll int rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstrerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstrerase(str,(int)log10((double)tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstrerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstrerase(str,(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\tcin >> str;\n\tll int ans;\n\tcin >> ans;\n\tll int rst1 = calc1(str);\n\tll int rst2 = calc3(str);\n\tcout << rst1 << \" \" << rst2 << endl;\n\tif(rst1==ans){\n\t\tif(rst2==ans) cout << 'U' << endl;\n\t\telse cout << 'M' << endl;\n\t}else{\n\t\tif(rst2==ans) cout << 'L' << endl;\n\t\telse cout << 'I' << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define mp make_pair\n#define pb push_back\n#define fi first\n#define se second\n#define im imag()\n#define re real()\n#define r(I, N) for(int I=0;I<N;I++)\n#define f(I, A, B) for(int I=A;I<B;I++)\n#define fd(I, A, B) for(int I=A;I>=B;I--)\n#define ite(x) for(__typeof((x).begin()) it=(x).begin();it!=(x).end();it++)\n#define sz(x) ((int)(x).size())\n#define clr(x) memset(x, 0, sizeof(x))\n\ntypedef pair<int, int> pii;\ntypedef long long ll;\ntypedef long double ld;\ntypedef complex<ld> Point;\ntypedef Point Vector;\n\nconst ld pi = acos(-1.0);\nconst ld eps = 1e-12;\n\nint l1, l2;\nchar s[123];\nll num[123], ans;\nbool f1 = true, f2 = true;\nstring buf;\n\nvoid parse(string u)\n{\n      int pt;\n      r(i, u.length())\n      {\n            if(u[i] >= '0' && u[i] <= '9')\n            {\n\n                  pt = i;\n                  while(u[pt] >= '0' && u[pt] <= '9' && pt < u.length())\n                  {\n                        pt++;\n                  }\n                  ll tmp = 0;\n                  f(j, i, pt) tmp *= 10, tmp += u[j] - '0';\n                  num[l2++] = tmp;i = pt - 1;\n            }\n            else\n            {\n                  s[l1++] = u[i];\n            }\n      }\n}\n\n\nint main()\n{\n      cin >> buf >> ans;\n      parse(buf);\n      /// lr Case 1\n      ll a1 = num[0];\n      r(i, l1)\n      {\n            if(s[i] == '+')\n            {\n                  a1 += num[i + 1];\n            }\n            else\n            {\n                  a1 *= num[i + 1];\n            }\n      }\n      if(a1 != ans) f1 = false;\n\n      /// mf Case 2\n      ll a2 = num[0];\n      ll t = 0;\n      r(i, l1)\n      {\n            if(s[i] == '*')\n            {\n                  a2 *= num[i + 1];\n            }\n            else\n            {\n                  t += a2;\n                  a2 = num[i + 1];\n            }\n      }\n      t += a2;\n      if(t != ans) f2 = false;\n      if(f1 && f2) cout << \"U\" << endl;\n      else if(f1 && !f2) cout << \"L\" << endl;\n      else if(!f1 && f2) cout << \"M\" << endl;\n      else cout << \"I\" << endl;\n      return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MOD 1000000007\n#define BIG 1000000010\n#define repi(i,x,n) for(int i=x;i<n;i++)\n#define rep(i,n) repi(i,0,n)\n#define repn(i,n) for(int i=n;i>=0;i--)\ntypedef long long int ll;\n\nint main(){\n  string s;\n  cin>>s;\n  int m=0,l=0,n,nn;\n  cin>>nn;\n  stack<int>q;\n  q.push(s[0]-'0');\n  for(int i=1;i<s.size();i+=2){\n    if(s[i]=='*'){\n      n=q.top();\n      q.pop();\n      q.push(n*(s[i+1]-'0'));\n    }\n    else{\n      q.push(s[i+1]-'0');\n    }\n  }\n  while(!q.empty()){\n    n=q.top();\n    m+=n;\n    q.pop();\n  }\n  q.push(s[0]-'0');\n  for(int i=1;i<s.size();i+=2){\n    if(s[i]=='*'){\n      n=q.top();\n      q.pop();\n      q.push(n*(s[i+1]-'0'));\n    }\n    else{\n      n=q.top();\n      q.pop();\n      q.push(n+(s[i+1]-'0'));\n    }\n  }\n  l=q.top();\n  if(nn==m){\n    if(nn==l) cout<<'U'<<endl;\n    else cout<<'M'<<endl;\n  }\n  else{\n    if(nn==l) cout<<'L'<<endl;\n    else cout<<'I'<<endl;\n  }\n    \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n\nusing namespace std;\n\nvoid swap(int *a,int *b){\n\tint tmp = *a;\n\t*a = *b;\n\t*b = tmp;\n}\n\n\nint lFunc(string str){\n\t\n\tint num=str.at(0)-'0';\n\n\tfor(int i=1;i<str.size();i+=2){\n\t\tif(str.at(i)=='+'){\n\t\t\tnum+=(str.at(i+1)-'0');\n\t\t}\n\t\telse{\n\t\t\tnum*=(str.at(i+1)-'0');\n\t\t}\n\t}\n\n\treturn  num;\n}\n\nint uFunc(string str){\n\t\n\tint *dataNum;\n\tint *dataCal;\n\tint length = str.size()/2;\n\n\tdataNum = new int[str.size()/2+1];\n\tdataCal = new int[str.size()/2];\n\n\tfor(int i=0;i<str.size();i++){\n\t\tif(i%2==0){\n\t\t\tdataNum[i/2]=str.at(i)-'0';\n\t\t}\n\t\telse{\n\t\t\tif(str.at(i)=='+'){\n\t\t\t\tdataCal[i/2]=1;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tdataCal[i/2]=2;\n\t\t\t}\n\t\t}\n\t}\n\t/*\n\tfor(int k=0;k<length+1;k++){\n\t\tcout<<dataNum[k]<<\" \";\n\t}\n\tcout<<endl;\n\n\tfor(int k=0;k<length;k++){\n\t\tcout<<dataCal[k]<<\" \";\n\t}\n\tcout<<endl;\n\t*/\n\n\twhile(1){\n\t\tint flag=0;\n\n\t\tfor(int i=0;i<length;i++){\n\t\t\tif(dataCal[i]==2){\n\t\t\t\tdataNum[i]*=dataNum[i+1];\n\t\t\t\tflag=1;\n\n\t\t\t\tif(i<length-1){\n\t\t\t\t\tswap(&dataNum[i+1],&dataNum[i+2]);\n\t\t\t\t\tswap(&dataCal[i],&dataCal[i+1]);\n\t\t\t\t}\n\t\t\t\tlength--;\n\t\t\t}\n\t\t\t/*\n\t\t\tfor(int k=0;k<length+1;k++){\n\t\t\t\tcout<<dataNum[k]<<\" \";\n\t\t\t}\n\t\t\tcout<<endl;\n\n\t\t\tfor(int k=0;k<length;k++){\n\t\t\t\tcout<<dataCal[k]<<\" \";\n\t\t\t}\n\t\t\tcout<<endl;\n\t\t\t*/\n\t\t}\n\t\tif(flag==0)break;\n\t}\n\n\tint num=dataNum[0];\n\tfor(int i=1;i<=length;i++){\n\t\tnum+=dataNum[i];\n\t}\n//\tcout<<\"U=\"<<num<<endl;\n\n\treturn num;\n}\n\nint main(){\n\n\tstring str;\n\n\tcin>>str;\n\n\tint input;\n\tcin>>input;\n\n\tif(input==lFunc(str) && input==uFunc(str)){\n\t\tcout<<\"U\"<<endl;\n\t}\n\telse if(input == lFunc(str)){\n\t\tcout<<\"L\"<<endl;\n\t}\n\telse if(input == uFunc(str)){\n\t\tcout<<\"M\"<<endl;\n\t}\n\telse{\n\t\tcout<<\"I\"<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <fstream>\nusing namespace std;\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toStr(T x) { ostringstream sout; sout << x; return sout.str(); }\ntypedef vector<int> vi;\ntypedef vector<vi>  vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define FOR(i,a,b) for(int i=(a);i<=(b);++i)\n#define REP(i,n) FOR(i,0,(n)-1)\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\nconst int INF = INT_MAX / 10;\n\nstring s;\nint p;\n\nint term();\nint num();\n\nint expression() {\n\tint ret = term();\n\twhile (s[p] == '+') {\n\t\tp++;\n\t\tret += term();\n\t}\n\treturn ret;\n}\n\nint term() {\n\tint ret = num();\n\twhile (s[p] == '*') {\n\t\tp++;\n\t\tret *= num();\n\t}\n\treturn ret;\n}\n\nint num() {\n\tint ret = 0;\n\twhile (isdigit(s[p])) {\n\t\tret *= 10;\n\t\tret += (s[p] - '0');\n\t\tp++;\n\t}\n\treturn ret;\n}\n\nint expression2() {\n\tint ret = num();\n\twhile (true) {\n\t\tif (s[p] == '+') {\n\t\t\tp++;\n\t\t\tret += num();\n\t\t}\n\t\telse if (s[p] == '*') {\n\t\t\tp++;\n\t\t\tret *= num();\n\t\t}\n\t\telse {\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn ret;\n}\n\nint main() {\n\tint n;\n\tcin >> s >> n;\n\tp = 0;\n\tint ans1 = expression();\n\tp = 0;\n\tint ans2 = expression2();\n\n\tif (n == ans1) {\n\t\tif (n == ans2) {\n\t\t\tcout << 'U' << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << 'M' << endl;\n\t\t}\n\t}\n\telse if (n == ans2) {\n\t\tcout << 'L' << endl;\n\t}\n\telse {\n\t\tcout << 'I' << endl;\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define pp pair<int,int>\n#define rep(i,n) for(int (i)=0;(i)<(n);(i)++)\n#define ll long long\n#define ld long double\n#define all(a) (a).begin(),(a).end()\n#define mk make_pair\nll mod=1000000007;\nll MOD=998244353;\nint inf=1000001000;\nll INF=100000000000000000;\n\n\nint main() {\n    string s;\n    cin >> s;\n    vector<int> a(0);\n    int o=1,b=s[0]-'0';\n    rep(i,s.size()/2){\n        int u=s[2*i]-'0';\n        char t=s[2*i+1];\n        o*=u;\n        if (t=='+') {a.push_back(o);o=1;}\n    }\n    int r=s[s.size()-1]-'0';\n    a.push_back(o*r);\n    int ans=0;\n    for(int i:a) ans+=i;\n    rep(i,s.size()/2){\n        int u=s[2*i+2]-'0';\n        char t=s[2*i+1];\n        if (t=='+') b+=u;\n        else b*=u;\n    }\n    int e;\n    cin >> e;\n    if (e==ans && e==b) cout << \"U\" << endl;\n    else if (e==ans) cout << \"M\" << endl;\n    else if (e==b) cout << \"L\" << endl;\n    else cout << \"I\" << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define _overload3(_1, _2, _3, name, ...) name\n#define _rep(i, n) repi(i, 0, n)\n#define repi(i, a, b) for (ll i = (ll)(a); i < (ll)(b); ++i)\n#define rep(...) _overload3(__VA_ARGS__, repi, _rep, )(__VA_ARGS__)\n#define ll long long\n#define lld long double\n#define ALL(x) x.begin(), x.end()\n#ifdef DEBUG\n#define line() cerr << \"[\" << __LINE__ << \"] \";\n#define dump(i) cerr << #i \": \" << i << \" \";\n#define dumpl(i) cerr << #i \": \" << i << endl;\n#else\n#define line(i)\n#define dump(i)\n#define dumpl(i)\n#endif\nusing namespace std;\n\ntypedef string::const_iterator State;\nclass ParseError\n{\n};\n\nint number(State &begin)\n{\n    int ret = 0;\n\n    while (isdigit(*begin))\n    {\n        ret *= 10;\n        ret += *begin - '0';\n        begin++;\n    }\n    return ret;\n}\n\nint term(State &begin)\n{\n    int ret = number(begin);\n\n    for (;;)\n    {\n        if (*begin == '*')\n        {\n            begin++;\n            ret *= number(begin);\n        }\n        else\n        {\n            break;\n        }\n    }\n    return ret;\n}\n\nint expr(State &begin)\n{\n    int ret = term(begin);\n    for (;;)\n    {\n        if (*begin == '+')\n        {\n            begin++;\n            ret += term(begin);\n        }\n        else\n        {\n            break;\n        }\n    }\n    return ret;\n}\nint exprWrong(State &begin)\n{\n    int ret = number(begin);\n    for (;;)\n    {\n        if (*begin == '+')\n        {\n            begin++;\n            ret += number(begin);\n        }\n        else if (*begin == '*')\n        {\n\n            begin++;\n            ret *= number(begin);\n        }\n        else\n        {\n            break;\n        }\n    }\n    return ret;\n}\nint main(int argc, char const *argv[])\n{\n    string s;\n    cin >> s;\n    int ans;\n    cin >> ans;\n    State begin = s.begin();\n    int ansc = expr(begin);\n    begin = s.begin();\n    int answ = exprWrong(begin);\n    if (ans == ansc && ans != answ)\n    {\n        cout << \"M\" << endl;\n    }\n    else if (ans != ansc && ans == answ)\n    {\n        cout << \"L\" << endl;\n    }\n    else if (ans == ansc && ans == answ)\n    {\n        cout << \"U\" << endl;\n    }\n    else if (ans != ansc && ans != answ)\n    {\n        cout << \"I\" << endl;\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "                                        #include <bits/stdc++.h>\n                                        #include<iostream>\n                                        #include<cstdio>\n                                        #include<vector>\n                                        #include<queue>\n                                        #include<map>\n                                        #include<cstring>\n                                        #include<string>\n                                        #include <math.h>\n                                        #include<algorithm>\n                                    //    #include <boost/multiprecision/cpp_int.hpp>\n                                        #include<functional>\n                                #define int long long\n                                        #define inf  1000000007\n                                        #define pa pair<int,int>\n                                        #define ll long long\n                                        #define pal pair<double,pa>\n                                        #define ppa pair<int,int>\n                                        #define ppap pair<int,pa>\n                                        #define ssa pair<string,int>\n                                        #define  mp make_pair\n                                        #define  pb push_back\n                                        #define EPS (1e-12)\n                                        #define equals(a,b) (fabs((a)-(b))<EPS)\n                                  #define VI vector<int>\n                                        using namespace std;\n                                        \n                                  class pas{\n                                    \tpublic:\n                                    \tint x,y;\n                                    \tpas(int x=0,int y=0):x(x),y(y) {}\n                                    \tpas operator + (pas p) {return pas(x+p.x,y+p.y);}\n                                    \tpas operator - (pas p) {return pas(x-p.x,y-p.y);}\n                                    \tpas operator * (int a) {return pas(x*a,y*a);}\n                                    \tpas operator / (int a) {return pas(x/a,y/a);}\n                                    //\tdouble absv() {return sqrt(norm());}\n                                    \tint norm() {return x*x+y*y;}\n                                    \tbool operator < (const pas &p) const{\n                                   \t\treturn x != p.x ? x<p.x: y<p.y;\n                                   \t}\n                                  //\t\tbool operator < (const pas &p) const{\n                                    //\t\treturn y != p.y ? y<p.y: x<p.x;\n                                    //\t}\n                                    \tbool operator == (const pas &p) const{\n                                    \t\treturn x==p.x && y==p.y;\n                                    \t}\n                                    };\n\n                                        class Point{\n                                        \tpublic:\n                                        \tdouble x,y;\n                                        \tPoint(double x=0,double y=0):x(x),y(y) {}\n                                        \tPoint operator + (Point p) {return Point(x+p.x,y+p.y);}\n                                        \tPoint operator - (Point p) {return Point(x-p.x,y-p.y);}\n                                        \tPoint operator * (double a) {return Point(x*a,y*a);}\n                                        \tPoint operator / (double a) {return Point(x/a,y/a);}\n                                        \tdouble absv() {return sqrt(norm());}\n                                        \tdouble norm() {return x*x+y*y;}\n                                        \tbool operator < (const Point &p) const{\n                                        \t\treturn x != p.x ? x<p.x: y<p.y;\n                                        \t}\n                                        \tbool operator == (const Point &p) const{\n                                        \t\treturn fabs(x-p.x)<EPS && fabs(y-p.y)<EPS;\n                                        \t}\n                                        };\n                                        typedef Point Vector;\n                                 #define pl pair<int,pas>\n                                        struct Segment{\n                                        Point p1,p2;\n                                        };\n                                        \nstruct star{\nSegment se[5];\n};\n                                         double dot(Vector a,Vector b){\n                                        \treturn a.x*b.x+a.y*b.y;\n                                        }\n                                        double cross(Vector a,Vector b){\n                                        \treturn a.x*b.y-a.y*b.x;\n                                        }\n                                    \n            bool parareru(Point a,Point b,Point c,Point d){\n            //\tif(abs(cross(a-b,d-c))<EPS)cout<<\"dd \"<<cross(a-b,d-c)<<endl;\n            \treturn abs(cross(a-b,d-c))<EPS;\n            }\n            double distance_ls_p(Point a, Point b, Point c) {\n              if ( dot(b-a, c-a) < EPS ) return (c-a).absv();\n              if ( dot(a-b, c-b) < EPS ) return (c-b).absv();\n              return abs(cross(b-a, c-a)) / (b-a).absv();\n            }\n            bool is_intersected_ls(Segment a,Segment b) {\n            \tif(a.p1==b.p1||a.p2==b.p1||a.p1==b.p2||a.p2==b.p2) return false;\n            \tif(parareru((a.p2),(a.p1),(b.p1),(b.p2))&&parareru((a.p2),(a.p1),(b.p1),(b.p1))){\n            //\t\tcout<<\"sss\"<<endl;\n            \t\tif(dot(a.p1-b.p1,a.p1-b.p2)<EPS) return true;\n            \t\tif(dot(a.p2-b.p1,a.p2-b.p2)<EPS) return true;\n            \t\tif(dot(a.p1-b.p1,a.p2-b.p1)<EPS) return true;\n            \t\tif(dot(a.p1-b.p2,a.p2-b.p2)<EPS) return true;\n            \t\treturn false;\n            \t}\n              else return ( cross(a.p2-a.p1, b.p1-a.p1) * cross(a.p2-a.p1, b.p2-a.p1) < EPS ) && ( cross(b.p2-b.p1, a.p1-b.p1) * cross(b.p2-b.p1, a.p2-b.p1) < EPS );\n            }\n            double segment_len(Segment a){\n            \t\n            \treturn (a.p1-a.p2).absv();\n            }\n            double segment_dis(Segment a,Segment b){\n            \tif(is_intersected_ls(a,b))return 0;\n            \tdouble r=distance_ls_p(a.p1, a.p2, b.p1);\n            \tr=min(r,distance_ls_p(a.p1, a.p2, b.p2));\n            \tr=min(r,distance_ls_p(b.p1, b.p2, a.p2));\n            \tr=min(r,distance_ls_p(b.p1, b.p2, a.p1));\n            \treturn r;\n            }\n            Point intersection_ls(Segment a, Segment b) {\n              Point ba = b.p2-b.p1;\n              double d1 = abs(cross(ba, a.p1-b.p1));\n              double d2 = abs(cross(ba, a.p2-b.p1));\n              double t = d1 / (d1 + d2);\n             \n              return a.p1 + (a.p2-a.p1) * t;\n            }\n\t\t\tpair<Point,Point> circle_intersection(Point c1,double r1,Point c2,double r2){\n\t\t\t\tdouble d=(c1-c2).absv();\n\t\t\t\tdouble h=(r1*r1-r2*r2+d*d)/2.0/d;\n\t\t\t\tdouble l=sqrt(r1*r1-h*h);\n\t\t\t//\tcout<<d<<\" \"<<h<<\" \"<<l<<endl;\n\t\t\t\tPoint asi=c1+(c2-c1)*h/((c2-c1).absv());\n\t\t\t\tVector r1r2=(c2-c1)/((c2-c1).absv());\n\t\t\t\tVector sui={r1r2.y,-r1r2.x};\n\t\t\t//\tcout<<sui.x<<\" \"<<sui.y<<endl;\n\t\t\t\tpair<Point,Point> z=mp(asi+sui*l,asi-sui*l);\n\t\t\t\tif(z.first.x>z.second.x) swap(z.first,z.second);\n\t\t\t\treturn z;\n\t\t\t}\ndouble dist(star s1,star s2){\n\tdouble ans=10000000000.0;\n\t\n\tfor(int i=0;i<5;i++)for(int j=0;j<5;j++){\n\t\tif( is_intersected_ls(s1.se[i],s2.se[j])) {\n\t\t\t\n//\t\t\tcout<<s1.se[i].p1.x<<\" \"<<s1.se[i].p1.y<<endl;\n//\t\t\tcout<<s1.se[i].p2.x<<\" \"<<s1.se[i].p2.y<<endl;\n//\t\t\tcout<<s2.se[j].p1.x<<\" \"<<s2.se[j].p1.y<<endl;\n//\t\t\tcout<<s2.se[j].p2.x<<\" \"<<s2.se[j].p2.y<<endl;\n\t\treturn 0.0;\n\t\t}\n\t\tans=min(ans,segment_dis(s1.se[i],s2.se[j]));\n//\t\tcout<<\"   \"<<i<<\" \"<<j<<\" \"<<segment_dis(s1.se[i],s2.se[j])<<endl;\n\t}\n\treturn ans;\n}\n\nint a[160][160]={0};\nint ans;\nint ddx[6]={1,0,-1,-1,0,1};\nint ddy[6]={1,1,0,-1,-1,0};\nqueue<ppap> qu;\nvoid dfs(int x,int y,int zan){\n\tqu.push(mp(0,mp(x,y)));\n\t\n\twhile(qu.size()){\n\t\tppap r=qu.front();\n\t\tqu.pop();\n\t\tpa z=r.second;\n\t\tif(a[z.first][z.second]>0) continue;\n\t\ta[z.first][z.second]=1;\n\t\tans++;\n\t\tif(r.first<zan)for(int i=0;i<6;i++)qu.push(mp(r.first+1,mp(z.first+ddx[i],z.second+ddy[i])));\n\t}\n}\n\n     signed main(){\nstring s;\n     \tcin>>s;\n     \tint l=s.length();\n     \t\n     \ts=\"+\"+s;\n     \tl++;\n     \t\n     \tint ans1=0,r=0;\n     \tfor(int i=1;i<l;i+=2){\n     \t\tif(s[i-1]=='+'){\n     \t\t\tans1+=r;\n     \t\t\tr=s[i]-'0';\n     \t\t}\n     \t\telse{\n     \t\t\tr*=s[i]-'0';\n     \t\t}\n     \t}\n     \tans1+=r;\n     \tint ans2=0;\n     \tfor(int i=1;i<l;i+=2){\n     \t\tif(s[i-1]=='+')ans2+=s[i]-'0';\n     \t\telse ans2*=s[i]-'0';\n     \t}\nint ri;\n     \tcin>>ri;\n     \t\n     \tif(ri==ans1 && ri==ans2){\n     \tcout<<\"U\"<<endl;\n     \t}\n     \tif(ri!=ans1 && ri==ans2){\n     \tcout<<\"L\"<<endl;\n     \t}\n     \tif(ri==ans1 && ri!=ans2){\n     \tcout<<\"M\"<<endl;\n     \t}\n     \tif(ri!=ans1 && ri!=ans2){\n     \tcout<<\"I\"<<endl;\n     \t}\n     \t\n           \treturn 0;\n           }\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <map>\n#include <set>\n#include <bitset>\n#include <numeric>\n#include <utility>\n#include <iomanip>\n#include <algorithm>\n#include <functional>\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vint;\ntypedef vector<long long> vll;\ntypedef pair<int,int> pint;\ntypedef pair<long long, long long> pll;\n\n#define MP make_pair\n#define PB push_back\n#define ALL(s) (s).begin(),(s).end()\n#define EACH(i, s) for (__typeof__((s).begin()) i = (s).begin(); i != (s).end(); ++i)\n#define COUT(x) cout << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << endl\n\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\ntemplate<class T1, class T2> ostream& operator << (ostream &s, pair<T1,T2> P) \n{ return s << '<' << P.first << \", \" << P.second << '>'; }\ntemplate<class T> ostream& operator << (ostream &s, vector<T> P) \n{ for (int i = 0; i < P.size(); ++i) { if (i > 0) { s << \" \"; } s << P[i]; } return s; }\ntemplate<class T> ostream& operator << (ostream &s, vector<vector<T> > P) \n{ for (int i = 0; i < P.size(); ++i) { s << endl << P[i]; } return s << endl; }\ntemplate<class T1, class T2> ostream& operator << (ostream &s, map<T1,T2> P) \n{ EACH(it, P) { s << \"<\" << it->first << \"->\" << it->second << \"> \"; } return s; }\n\n\n\ntemplate<class T> struct Parser {\n    typedef pair<T,int> parsed;\n    \n    // rewrite if we need (the following is int version)\n    static T conv(string str) {\n        T res = 0;\n        for (int i = 0; i < str.size(); ++i) {\n            res = res * 10 + (str[i] - '0');\n        }\n        return res;\n    }\n    \n    static T solve(string str) {\n        return equation(str).first;\n    }\n    \n    static parsed equation(string str, int p = 0) {\n        parsed res = factor(str, p);\n        while (str[res.second] == '+' || str[res.second] == '-') {\n            parsed temp = factor(str, res.second+1);\n            if (str[res.second] == '+') res.first = res.first + temp.first;\n            else if (str[res.second] == '-') res.first = res.first - temp.first;\n            res.second = temp.second;\n        }\n        return res;\n    }\n    \n    static parsed factor(string str, int p = 0) {\n        parsed res = term(str, p);\n        while (str[res.second] == '*' || str[res.second] == '/') {\n            parsed temp = term(str, res.second+1);    \n            if (str[res.second] == '*') res.first = res.first * temp.first;\n            else if (str[res.second] == '/') res.first = res.first / temp.first;\n            res.second = temp.second;\n        }\n        return res;\n    }\n    \n    static parsed term(string str, int p = 0) {\n        if (str[p] == '(') {\n            parsed res = equation(str, p+1);\n            res.second += 1;\n            return res;\n        }\n        else {\n            string snum = \"\";\n            if (p < str.size()) {\n                while (isdigit(str[p]) || str[p] == 'i') {\n                    snum += str[p++];\n                }\n            }\n            T num = conv(snum);\n            return parsed(num, p);\n        }\n    }\n};\n\nstring str;\nlong long ans;\n\nint main() {\n    //freopen( \"/Users/macuser/Dropbox/Contest/input.in\", \"r\", stdin );\n    while (cin >> str >> ans) {\n        long long mres = Parser<long long>::solve(str);\n        long long lres = 0;\n        for (int i = 0; i < str.size(); ++i) {\n            if (str[i] == '+' || str[i] == '*') {\n                str = str.substr(0, i) + \" \" + str[i] + \" \" + str.substr(i+1);\n                ++i;\n            }\n        }\n        //COUT(str); \n        \n        long long num;\n        char c;\n        istringstream sin(str);\n        sin >> lres;\n        while (sin >> c >> num) {\n            if (c == '+') lres += num;\n            if (c == '*') lres *= num;\n        }\n        \n        //COUT(mres); COUT(lres);\n        \n        if (mres == ans && lres != ans) puts(\"M\");\n        else if (mres != ans && lres == ans) puts(\"L\");\n        else if (mres == ans && lres == ans) puts(\"U\");\n        else if (mres != ans && lres != ans) puts(\"I\");\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\n#define repb(i, a, b) for(int i = a; i >= b; i--)\n#define all(a) a.begin(), a.end()\n#define o(a) cout << a << endl\n#define int long long\n#define first fi;\n#define second se;\nusing namespace std;\ntypedef pair<int, int> P;\n\nsigned main(){\n    string s;\n    int a;\n    cin >> s >> a;\n    s += \"+0\";\n    vector<int> d;\n    int now = s[0] - '0';\n    int nowl = now;\n    rep(i, 0, s.size() / 2){\n        \n        char c = s[i * 2 + 1];\n        int tmp = s[i * 2 + 2] - '0';\n        if(c == '+'){\n            now += tmp;\n            d.push_back(nowl);\n            nowl = tmp;\n         }else{\n             now *= tmp;\n             nowl *= tmp;\n         }\n    }\n    int sum = 0;\n    rep(i, 0, d.size()) sum += d[i];\n    if(a == sum && a == now) cout << \"U\" << endl;\n    else if(a == sum) cout << \"M\" << endl;\n    else if(a == now) cout << \"L\" << endl;\n    else cout << \"I\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\nint ctoi(char c) {\n\tint i; char ch = '0';\n\tfor (i = 0; i < 10; i++){\n\t\tif (c == ch)return i;\n\t\telse ch++;\n\t}\n\treturn -1;\n}\nint main() {\n\tstring s; cin >> s;\n\tint ans1 = 0, ans2, anss = 0;\n\tfor (int i = 0; i < s.size(); i += 2) {\n\t\tif (i == 0) { anss = ctoi(s[i]); ans2 = ctoi(s[i]); }\n\t\telse if (i % 2 == 0) {\n\t\t\tif (s[i - 1] == '+') {\n\t\t\t\tans1 += anss;\n\t\t\t\tanss = ctoi(s[i]);\n\t\t\t\tans2 += ctoi(s[i]);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tanss *= ctoi(s[i]);\n\t\t\t\tans2 *= ctoi(s[i]);\n\t\t\t}\n\t\t}\n\t}\n\tans1 += anss;\n\tint v; cin >> v;\n\tif (ans1 == v) {\n\t\tif (ans2 == v)\n\t\t\tcout << \"U\\n\";\n\t\telse\n\t\t\tcout << \"M\\n\";\n\t}\n\telse {\n\t\tif (ans2 == v)\n\t\t\tcout << \"L\\n\";\n\t\telse\n\t\t\tcout << \"I\\n\";\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(){\n  string s;\n  int n;\n  cin>>s>>n;\n  int a=s[0]-'0',c=s[0]-'0',b=0;\n  for(int i=1;i<s.size();i+=2){\n    int p=s[i+1]-'0';\n    if(s[i]=='+')a+=p,b+=c,c=p;\n    else a*=p,c*=p;\n  }\n  b+=c;\n  if(b==n&&a!=n)cout<<'M';\n  else if(a==n&&b!=n)cout<<'L';\n  else if(a==b&&a==n)cout<<'U';\n  else cout<<'I';\n  cout<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\ntypedef long long LL;\n#define SORT(c) sort((c).begin(),(c).end())\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\nusing namespace std;\nint main(void)\n{\n  string s;\n  cin >> s;\n  int n;\n  cin >> n;\n  int answerl=s[0]-'0';\n  REP(i,s.size()/2)\n    if(s[i*2+1]=='+') answerl+=(s[i*2+2]-'0');\n    else answerl*=(s[i*2+2]-'0');\n  int answerm=0;\n  vector<int> adds;\n  adds.push_back(s[0]-'0');\n  REP(i,s.size()/2)\n    if(s[i*2+1]=='+') adds.push_back(s[i*2+2]-'0');\n    else adds[adds.size()-1]*=(s[i*2+2]-'0');\n  REP(i,adds.size()) answerm+=adds[i];\n  string ans=\"IMLU\";\n  int ansnum=0;\n  if(n==answerm) ansnum+=1;\n  if(n==answerl) ansnum+=2;\n  cout << ans[ansnum] << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cassert>\n#include <utility>\n#include <iostream>\nusing namespace std;\n\nusing ll = long long;\n\nstring expr;\nll a_ans;\n\nll calc1() {\n    ll ans = expr[0] - '0';\n    int idx = 1;\n    while (idx < expr.size()) {\n        char op = expr[idx];\n        ll v = expr[idx+1] - '0';\n\n        if (op == '+') ans += v;\n        if (op == '*') ans *= v;\n\n        idx += 2;\n    }\n\n    return ans;\n}\n\npair<ll, int> term(int idx) {\n    ll ret = expr[idx] - '0';\n    idx+=1;\n\n    while (idx < expr.size()) {\n        char op = expr[idx];\n        if (op == '+') break;\n        assert(op == '*');\n        ll v = expr[idx+1] - '0';\n        ret *= v;\n\n        idx += 2;\n    }\n\n    return make_pair(ret, idx);\n}\n\nll calc2() {\n    ll ans = 0, val;\n    int idx = 0, nidx;\n    while (idx < expr.size()) {\n        tie(val, nidx) = term(idx);\n        ans += val; idx = nidx;\n        idx += 1;\n    }\n    return ans;\n}\n\nint main() {\n    cin >> expr >> a_ans;\n    ll ans1 = calc1(), ans2 = calc2();\n\n    if (ans1 == a_ans && ans2 == a_ans) {\n        cout << \"U\";\n    } else if (ans1 == a_ans && ans2 != a_ans) {\n        cout << \"L\";\n    } else if (ans1 != a_ans && ans2 == a_ans) {\n        cout << \"M\";\n    } else {\n        cout << \"I\";\n    }\n    cout << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint in = 0;\n\nint num(string str) {\n    int res = str[in] - '0';\n    in++;\n    return res;\n}\n\nint mul(string str) {\n    int res = num(str);\n    int len = str.length();\n    while (in < len && str[in] == '*') {\n        in++;\n        int temp = num(str);\n        res *= temp;\n    }\n    return res;\n}\n\nint eval(string str) {\n    int res = mul(str);\n\tint len = str.length();\n    while (in < len) {\n    \tin++;\n        res += mul(str);\n    }\n    return res;\n}\n    \nint ltor(string str) {\n    int res = str[0] - '0';\n\tint len = str.length();\n    for (int i = 1; i < len; i += 2) {\n        if (str[i] == '+') {\n            res += str[i + 1] - '0';\n        }\n\t\telse {\n            res *= str[i + 1] - '0';\n        }\n   }     \n   return res;\n}\n\nint main() {\n    string expr;\n\tcin >> expr;\n    int result;\n\tcin >> result;\n    int m = eval(expr);\n    int l = ltor(expr);\n    if(result == m && result == l){\n\t\tcout << \"U\\n\";\n    }\n\telse if (result == m) {\n       cout << \"M\\n\";\n    }\n\telse if (result == l) {\n       cout << \"L\\n\";\n    }\n\telse {\n       cout << \"I\\n\";\n    }\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <numeric>\n#include <string>\n#include <utility>\n#include <vector>\n\nusing namespace std;\n\nint main()\n{\n    string s;\n    cin >> s;\n    int n;\n    cin >> n;\n\n    auto multiplicationFirst = [](const string& s) {\n        // value or operator\n        enum class T { V, O };\n        vector<pair<T, int>> v;\n        for (char i : s) {\n            if (i == '*' || i == '+') {\n                v.emplace_back(T::O, i);\n            }\n            else {\n                v.emplace_back(T::V, i - '0');\n            }\n        }\n        while (true) {\n            if (find(begin(v), end(v),\n                     make_pair(T::O, static_cast<int>('*'))) == end(v)) {\n                break;\n            }\n            vector<pair<T, int>> t;\n            for (size_t i = 0; i < v.size(); ++i) {\n                if (v[i] != make_pair(T::O, static_cast<int>('*'))) {\n                    t.push_back(v[i]);\n                }\n                else {\n                    t.pop_back();\n                    t.emplace_back(T ::V, v[i - 1].second * v[i + 1].second);\n                    i += 2;\n                }\n            }\n            v = t;\n        }\n        return accumulate(begin(v), end(v), 0,\n                          [](int a, const pair<T, int>& b) {\n                              if (b.first == T::O) {\n                                  return a;\n                              }\n                              else {\n                                  return a + b.second;\n                              }\n                          });\n    };\n    auto leftToRight = [](const string& s) {\n        int accumulator = s[0] - '0';\n        for (size_t i = 1; i < s.size() - 1; i += 2) {\n            if (s[i] == '+') {\n                accumulator += s[i + 1] - '0';\n            }\n            else {\n                accumulator *= s[i + 1] - '0';\n            }\n        }\n        return accumulator;\n    };\n    auto mf = multiplicationFirst(s);\n    auto lr = leftToRight(s);\n    if (mf == n && lr == n) {\n        cout << 'U' << endl;\n    }\n    else if (mf == n) {\n        cout << 'M' << endl;\n    }\n    else if (lr == n) {\n        cout << 'L' << endl;\n    }\n    else {\n        cout << 'I' << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  string str;\n  cin>>str;\n  int bob;\n  cin>>bob;\nint ans=str[0]-'0';\n int f;\n\n  for(int i=1;i<str.size();i++){\n    if(str[i]=='+')f=1;\n    else if(str[i]=='*')f=2;\n    if(str[i]>='0' && str[i]<='9'){\n      if(f==1) ans+=(str[i]-'0');\n      else if(f==2)ans*=(str[i]-'0');\n    }\n  }\n  char ansf='I';\n   if(ans==bob)ansf='L';\n    ans=0;\n  for(int i=1;i<str.size();i++){\n    if(str[i]=='*'){\n      ans+=((str[i-1]-'0')*(str[i+1]-'0'));\n      str[i-1]='0',str[i+1]='0';\n      while(1){\n\ti++;\n\tif(i>str.size()) break;\n\tif(str[i]=='*')ans*=(str[i+1]-'0'),str[i+1]='0';\n\telse if(str[i]=='+') break;\n      }\n    }\n  }\n      for(int i=0;i<str.size();i++)\n\tif(str[i]>='0' && str[i]<='9')ans+=(str[i]-'0');\n   if(ans==bob && ansf=='L') ansf='U';\n  else if(ans==bob)ansf='M';\n  cout<<ansf<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\nint calc1(string str){//multiplication-first\n\tstack<int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push(stoi(rststr));\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10(stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10(tmp)+1);\n\t\t\tint tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10(tmp)+1);\n\t\t}\n\t}\n\tint rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nint calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tint rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10(rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nint calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10(stoi(rststr))+1);\n\tint rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10(tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10(tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\tcin >> str;\n\tint ans;\n\tcin >> ans;\n\tint rst1 = calc1(str);\n\tint rst2 = calc3(str);\n\t//cout << rst1 << \" \" << rst2 << endl;\n\tif(rst1==ans){\n\t\tif(rst2==ans) cout << 'U' << endl;\n\t\telse cout << 'M' << endl;\n\t}else{\n\t\tif(rst2==ans) cout << 'L' << endl;\n\t\telse cout << 'I' << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <list>\n#include <vector>\n#include <complex>\n#include <utility>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <bitset>\n#include <ctime>\n#include <map>\n#include <unordered_map>\n#include <set>\n#include <unordered_set>\n#include <cassert>\n#include <cstddef>\n#include <iomanip>\n#include <numeric>\n#include <tuple>\n#include <sstream>\n#include <fstream>\n\nusing namespace std;\n#define REP(i, n) for (int (i) = 0; (i) < (n); (i)++)\n#define FOR(i, a, b) for (int (i) = (a); (i) < (b); (i)++)\n#define RREP(i, a) for(int (i) = (a) - 1; (i) >= 0; (i)--)\n#define FORR(i, a, b) for(int (i) = (a) - 1; (i) >= (b); (i)--)\n#define DEBUG(C) cerr << #C << \" = \" << C << endl;\nusing LL = long long;\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing VL = vector<LL>;\nusing VVL = vector<VL>;\nusing VD = vector<double>;\nusing VVD = vector<VD>;\nusing PII = pair<int, int>;\nusing PDD = pair<double, double>;\nusing PLL = pair<LL, LL>;\nusing VPII = vector<PII>;\ntemplate<typename T> using VT = vector<T>;\n#define ALL(a) begin((a)), end((a))\n#define RALL(a) rbegin((a)), rend((a))\n#define SORT(a) sort(ALL((a)))\n#define RSORT(a) sort(RALL((a)))\n#define REVERSE(a) reverse(ALL((a)))\n#define MP make_pair\n#define FORE(a, b) for (auto &&a : (b))\n#define FIND(s, e) ((s).find(e) != (s).end())\n#define EB emplace_back\ntemplate<typename T>inline bool chmax(T &a,T b){if(a<b){a=b;return true;}return false;}\ntemplate<typename T>inline bool chmin(T &a,T b){if(a>b){a=b;return true;}return false;}\n\nconst int INF = 1e9;\nconst int MOD = INF + 7;\nconst LL LLINF = 1e18;\n\nchar strbuf[1000];\nstring s;\nint ans;\n\nint leftToRightCalc(string s) {\n    const int L = s.length();\n    int res = s[0] - '0';\n    bool premul = false;\n    FOR(i, 1, L) {\n        if (isdigit(s[i])) {\n            if (premul) {\n                res *= s[i] - '0';\n            } else {\n                res += s[i] - '0';\n            }\n        } else {\n            premul = s[i] == '*';\n        }\n    }\n    return res;\n}\nint mulFirstCalc(string s) {\n    string news = \"\";\n    int res = 0;\n    bool premul = false;\n    REP(i, s.length()) {\n        if (s[i] == '+') continue;\n        if (isdigit(s[i])) {\n            news += s[i];\n            premul = false;\n        } else {\n            //DEBUG(news)\n            int c = news.back() - '0';\n            if (!premul) news.pop_back();\n            while (!premul && news.back() == '+') news.pop_back();\n            int c2 = s[++i] - '0';\n            res += (c * c2);\n            premul = true;\n        }\n    }\n    //DEBUG(news)\n    return res + leftToRightCalc(news);\n}\n\nint main(void) {\n    scanf(\"%s\", strbuf);\n    s = strbuf;\n    scanf(\"%d\", &ans);\n    int ltr = leftToRightCalc(s);\n    //DEBUG(ltr)\n    int mf = mulFirstCalc(s);\n    //DEBUG(mf)\n    if (ans == mf && ans != ltr) {\n        putchar('M');\n    } else if (ans != mf && ans == ltr) {\n        putchar('L');\n    } else if (ans == mf && ans == ltr) {\n        putchar('U');\n    } else {\n        putchar('I');\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <stdio.h>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <numeric>\n#include <string>\n#include <string.h>\n#include <map>\n#include <set>\n#include <functional>\n#include <complex>\n#include <stack>\n#include <tuple>\n#include <array>\nusing namespace std;\n#define rep(i,n) for (int i=0; i < (n); i++)\n\n\ntypedef long long int ll;\ntypedef double D;      // ??§?¨?????????????double???long double?????????\ntypedef complex<D> P;  // Point\ntypedef pair<P, P> L;  // Line\ntypedef vector<P> VP;\n\n\nconst int INF = (1<<30) - 1;\nconst D EPS = 1e-9;\n\n#define X real()\n#define Y imag()\n#define LE(n,m) ((n) < (m) + EPS)\n#define GE(n,m) ((n) + EPS > (m))\n#define EQ(n,m) (abs((n)-(m)) < EPS)\n\nstring S;\nint ans;\nint cur;\n\nint term(){\n    int n = S[cur++] - '0';\n    if(S[cur] == '*'){\n        cur++;\n        n *= term();\n    }\n    return n;\n}\n\nint expression(){\n    int n = term();\n    if(S[cur] == '+'){\n        cur++;\n        n += expression();\n    }\n    return n;\n}\n\nint left_to_right(){\n    int tans = S[0] - '0';\n    for(int i=1; i<S.length(); i+=2){\n        int n = S[i+1] - '0';\n        if(S[i] == '+')\n            tans += n;\n        else // *\n            tans *= n;\n    }\n    return tans;\n}\n\nvoid solve(){\n    cur = 0;\n    \n    char table[2][2] = {{'I', 'M'}, {'L', 'U'}};\n    \n    bool is_left_to_right = left_to_right() == ans;\n    bool is_multiplication_first = expression() == ans;\n    \n    cout << table[is_left_to_right][is_multiplication_first] << endl;\n}\n\n//g++ -std=c++0x -msse4.2 -O3\n//#include <bits/stdc++.h>\nint main(){\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    //cout.precision(16);\n    \n    cin >> S >> ans;\n    solve();\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <numeric>\n\nusing namespace std;\n\nint left_to_right(string s) {\n    int n = s[0]-'0';\n    for (int i=0; i<(int)s.length()/2; i++) {\n        int right = s[2*i+2]-'0';\n        if (s[2*i+1] == '+') {\n            n += right;\n        }\n        else {\n            n *= right;\n        }\n    }\n    return n;\n}\n\nint multiplication_first(string s) {\n    vector<int> terms;\n    terms.push_back(s[0]-'0');\n    for (int i=0; i<(int)s.length()/2; i++) {\n        int right = s[2*i+2]-'0';\n        if (s[2*i+1] == '+') {\n            terms.push_back(right);\n        }\n        else {\n            terms[terms.size()-1] *= right;\n        }\n    }\n    return accumulate(terms.begin(), terms.end(), 0);\n}\n\nint main() {\n    string s;\n    int n;\n    cin >> s >> n;\n    if (left_to_right(s) == n) {\n        if (multiplication_first(s) == n) {\n            cout << \"U\" << endl;\n        }\n        else {\n            cout << \"L\" << endl;\n        }\n    }\n    else {\n        if (multiplication_first(s) == n) {\n            cout << \"M\" << endl;\n        }\n        else {\n            cout << \"I\" << endl;\n        }\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define FOR(i,s,e) for((i)=(s);(i)<(int)(e);(i)++)\n\ntypedef long long ll;\n\nconst int N = 17;\nint n;\nint dgt[N], oprt[N];\nchar input[N+5];\n\nint main() {\n\tint i, j, k;\n\tint tgt;\n\n\tmemset(input, 0, sizeof(input));\n\tgets(input);\n\ti = j = k = 0;\n\tchar c = input[0];\n\twhile (c=='+' || c=='*' || ('0'<=c && c<='9')) {\n\t\tc = input[k++];\n\t\tif (c=='+' || c=='*')\n\t\t\toprt[j++] = c;\n\t\telse if ('0'<=c && c<='9')\n\t\t\tdgt[i++] = c - '0';\n\t}\n\tn = i;\n\n/*\nprintf(\"dgt:\");\nfor (i=0; i<n; i++)\n\tprintf(\"%d \", dgt[i]);\nputs(\"\");\n\nprintf(\"oprt:\");\nfor (i=0; i<n-1; i++)\n\tprintf(\"%c \", oprt[i]);\nputs(\"\");\n*/\n\n\tscanf(\"%d \", &tgt);\n//printf(\"tgt = %d\\n\", tgt);\n\n\tvector<int> mlt;\n\tmlt.push_back(dgt[0]);\n\ti = j = 0;\n\twhile (j<n-1) {\n\t\tif (oprt[j]=='*')\t{\n\t\t\tmlt[i] *= dgt[j+1];\n\t\t} else {\n\t\t\tmlt.push_back(dgt[j+1]);\n\t\t\ti++;\n\t\t}\n\t\tj++;\t\n\t}\n\tint mltRes = mlt[0];\n\tfor (i=1; i<mlt.size(); i++)\n\t\tmltRes += mlt[i];\n//printf(\"mltRes = %d\\n\", mltRes);\n\n\tint addRes = dgt[0];\t\n\tfor (i=0; i<n-1; i++)\n\t\tif (oprt[i]=='*')\n\t\t\taddRes *= dgt[i+1];\n\t\telse\n\t\t\taddRes += dgt[i+1];\n//printf(\"addRes = %d\\n\", addRes);\n\n\tchar res = 'I';\n\tif (mltRes==tgt && addRes==tgt)\n\t\tres = 'U';\n\telse if (mltRes==tgt)\n\t\tres = 'M';\n\telse if (addRes==tgt)\n\t\tres = 'L';\n\n\tprintf(\"%c\\n\", res);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstring str;\nint ans;\n\nbool A()\n{\n\tstringstream ss(str);\n\t\n\tvector<int> num;\n\tvector<char> sign;\n\t\n\tint t = 0;\n\twhile (!ss.eof()){\n\t\tif (!t){\n\t\t\tint s;\n\t\t\tss >> s;\n\t\t\t\n\t\t\tif (sign.size() && sign.back() == '*'){\n\t\t\t\tnum[num.size() - 1] *= s;\n\t\t\t\tsign.pop_back();\n\t\t\t}\n\t\t\telse num.push_back(s);\n\t\t}\n\t\telse {\n\t\t\tchar s;\n\t\t\tss >> s;\n\t\t\tsign.push_back(s);\n\t\t}\n\t\tt ^= 1;\n\t}\n\t\n\tint res = 0;\n\tfor (int i = 0; i < num.size(); i++){\n\t\tres += num[i];\n\t}\n\t\n\treturn res == ans;\n}\n\nbool B()\n{\n\tstringstream ss(str);\n\t\n\tvector<int> num;\n\tvector<char> sign;\n\t\n\tint t = 0;\n\twhile (!ss.eof()){\n\t\tif (!t){\n\t\t\tint s;\n\t\t\tss >> s;\n\t\t\t\n\t\t\tif (sign.size()){\n\t\t\t\tif (sign.back() == '*') num[num.size() - 1] *= s;\n\t\t\t\tif (sign.back() == '+') num[num.size() - 1] += s;\n\t\t\t\tsign.pop_back();\n\t\t\t}\n\t\t\telse num.push_back(s);\n\t\t}\n\t\telse {\n\t\t\tchar s;\n\t\t\tss >> s;\n\t\t\tsign.push_back(s);\n\t\t}\n\t\tt ^= 1;\n\t}\n\t\n\treturn num.back() == ans;\n}\n\nint main()\n{\n\tcin >> str >> ans;\n\tconst char* s = \"ILMU\";\n\tint res = (A() << 1) | B();\n\tprintf(\"%c\\n\", s[res]);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define debug(x) cout << \"debug \" << x << endl;\nconst int INF = 100000000;\nusing namespace std;\n\ntypedef string::const_iterator State;\nint number(State&);\nint factor(State&);\nint term(State&);\nint expression(State&);\n\n// ??°??????????????????????????????????????°????????????\nint number(State &begin) {\n    int ret = 0;\n\n    while (isdigit(*begin)) {\n        ret *= 10;\n        ret += *begin - '0';\n        begin++;\n    }\n\n    return ret;\n}\n\n// ??¬??§?????°???????????????????????????????????????????????????\nint factor(State &begin) {\n    if (*begin == '(') {\n        begin++; // '('????£???°??????\n        int ret = expression(begin);\n        begin++; // ')'????£???°??????\n    } else {\n        return number(begin);\n    }\n}\n\n// ?????????????????????????????????????????????????????????????????????\nint term(State &begin) {\n    int ret = factor(begin);\n\n    for (;;) {\n        if (*begin == '*') {\n            begin++;\n            ret *= factor(begin);\n        } else if (*begin == '/') {\n            begin++;\n            ret /= factor(begin);\n        } else {\n            break;\n        }\n    }\n\n    return ret;\n}\n\n// ?????????????????????????????????????????????????????????????????????\nint expression(State &begin) {\n    int ret = term(begin);\n\n    for (;;) {\n        if (*begin == '+') {\n            begin++;\n            ret += term(begin);\n        } else if (*begin == '-') {\n            begin++;\n            ret -= term(begin);\n        } else {\n            break;\n        }\n    }\n\n    return ret;\n}\n\nint expression2(State &begin){\n    int ret = term(begin);\n\n    for (;;) {\n        if (*begin == '+') {\n            begin++;\n            ret += number(begin);\n        } else if (*begin == '-') {\n            begin++;\n            ret -= number(begin);\n        } else if (*begin == '*') {\n            begin++;\n            ret *= factor(begin);\n        } else if (*begin == '/') {\n            begin++;\n            ret /= factor(begin);\n        } else {\n            break;\n        }\n    }\n\n    return ret;\n\n}\n\n\nint main(){\n    int n;\n    string s;\n    getline(cin, s);\n    cin >> n;\n    cin.ignore();\n\n    State begin = s.begin();\n    State begin2 = s.begin();\n    int correct = expression(begin);\n    int mistake = expression2(begin2);\n    if(n == correct && n == mistake){\n        cout << 'U' << endl;\n    }else if(n == correct){\n        cout << 'M' << endl;\n    }else if(n == mistake){\n        cout << 'L' << endl;\n    }else{\n        cout << 'I' << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n\nusing namespace std;\nbool isM(int n,string s)\n{\n\tvector<bool> used(s.length());\n\tfor (int i = 0; i < s.length(); i++)\n\t{\n\t\tused[i] = false;\n\t}\n\tbool flag = false;\n\tint sum = 0;\n\tfor (int i = 1; i < s.length(); i+= 2)\n\t{\n\t\tif (s[i] == '*')\n\t\t{\n\t\t\tif (used[i - 1])\n\t\t\t{\n\t\t\t\tsum *= (s[i + 1] - '0');\n\t\t\t\tused[i + 1] = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (!flag)\n\t\t\t\t{\n\t\t\t\t\tsum = (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t\t\tflag = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tsum *= (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t\t}\n\t\t\t\tused[i - 1] = true;\n\t\t\t\tused[i + 1] = true;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 0; i < s.length(); i += 2)\n\t{\n\t\tif (used[i])continue;\n\t\tsum += (s[i] - '0');\n\t}\n\tif (n == sum)return true;\n\telse return false;\n}\n\nbool isL(int n,string s)\n{\n\tif (s.length() == 1 && s[0] - '0' == n)return true;\n\tint sum = 0;\n\tfor (int i = 1; i < s.length(); i += 2)\n\t{\n\t\tif (i == 1)\n\t\t{\n\t\t\tsum = s[i - 1] - '0' + (s[i + 1] - '0');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (s[i] == '+')\n\t\t\t{\n\t\t\t\tsum += (s[i + 1] - '0');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsum *= (s[i + 1] - '0');\n\t\t\t}\n\t\t}\n\t}\n\n\tif (sum == n)return true;\n\telse return false;\n}\n\nint main()\n{\n\tstring exp;\n\tint n;\n\tcin >> exp;\n\tcin >> n;\n\tif (isM(n, exp) && isL(n, exp))\n\t{\n\t\tcout << \"U\" << endl;\n\t}\n\telse if (isM(n,exp))\n\t{\n\t\tcout << \"M\" << endl;\n\t}\n\telse if (isL(n, exp))\n\t{\n\t\tcout << \"L\" << endl;\n\t}\n\telse\n\t{\n\t\tcout << \"I\" << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <ctime>\n#include <cassert>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <numeric>\n#include <list>\n#include <iomanip>\n#include <fstream>\n#include <bitset>\n\nusing namespace std;\n\n#define foreach(it, c) for (__typeof__((c).begin()) it=(c).begin(); it != (c).end(); ++it)\ntemplate <typename T> void print_container(ostream& os, const T& c) { const char* _s = \" \"; if (!c.empty()) { __typeof__(c.begin()) last = --c.end(); foreach (it, c) { os << *it; if (it != last) os << _s; } } }\ntemplate <typename T> ostream& operator<<(ostream& os, const vector<T>& c) { print_container(os, c); return os; }\ntemplate <typename T> ostream& operator<<(ostream& os, const set<T>& c) { print_container(os, c); return os; }\ntemplate <typename T> ostream& operator<<(ostream& os, const multiset<T>& c) { print_container(os, c); return os; }\ntemplate <typename T> ostream& operator<<(ostream& os, const deque<T>& c) { print_container(os, c); return os; }\ntemplate <typename T, typename U> ostream& operator<<(ostream& os, const map<T, U>& c) { print_container(os, c); return os; }\ntemplate <typename T, typename U> ostream& operator<<(ostream& os, const pair<T, U>& p) { os << \"(\" << p.first << \", \" << p.second << \")\"; return os; }\n\ntemplate <typename T> void print(T a, int n, const string& split = \" \") { for (int i = 0; i < n; i++) { cout << a[i]; if (i + 1 != n) cout << split; } cout << endl; }\ntemplate <typename T> void print2d(T a, int w, int h, int width = -1, int br = 0) { for (int i = 0; i < h; ++i) { for (int j = 0; j < w; ++j) { if (width != -1) cout.width(width); cout << a[i][j] << ' '; } cout << endl; } while (br--) cout << endl; }\ntemplate <typename T> void input(T& a, int n) { for (int i = 0; i < n; ++i) cin >> a[i]; }\n#define dump(v) (cerr << #v << \": \" << v << endl)\n\n#define rep(i, n) for (int i = 0; i < (int)(n); ++i)\n#define erep(i, n) for (int i = 0; i <= (int)(n); ++i)\n#define all(a) (a).begin(), (a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define clr(a, x) memset(a, x, sizeof(a))\n#define sz(a) ((int)(a).size())\n#define mp(a, b) make_pair(a, b)\n#define ten(n) ((long long)(1e##n))\n\ntemplate <typename T, typename U> void upmin(T& a, const U& b) { a = min<T>(a, b); }\ntemplate <typename T, typename U> void upmax(T& a, const U& b) { a = max<T>(a, b); }\ntemplate <typename T> void uniq(T& a) { sort(a.begin(), a.end()); a.erase(unique(a.begin(), a.end()), a.end()); }\ntemplate <class T> string to_s(const T& a) { ostringstream os; os << a; return os.str(); }\ntemplate <class T> T to_T(const string& s) { istringstream is(s); T res; is >> res; return res; }\nvoid fast_io() { cin.tie(0); ios::sync_with_stdio(false); }\nbool in_rect(int x, int y, int w, int h) { return 0 <= x && x < w && 0 <= y && y < h; }\n\ntypedef long long ll;\ntypedef pair<int, int> pint;\n\nconst int dx[] = { 0, 1, 0, -1 };\nconst int dy[] = { 1, 0, -1, 0 };\n\n\n\nll mul(vector<pair<ll, char>> e)\n{\n    while (e.size() > 1)\n    {\n        int k = -1;\n        rep(i, e.size())\n            if (e[i].second == '*')\n                k = i;\n        if (k == -1)\n            break;\n\n        ll t = e[k].first * e[k + 1].first;\n        char op = e[k + 1].second;\n        e.erase(e.begin() + k, e.begin() + k + 2);\n        e.insert(e.begin() + k, make_pair(t, op));\n    }\n\n    ll s = 0;\n    for (auto& it : e)\n        s += it.first;\n    return s;\n}\nll left(vector<pair<ll, char>> e)\n{\n    rep(i, sz(e) - 1)\n    {\n        if (e[i].second == '+')\n            e[i + 1].first += e[i].first;\n        else\n            e[i + 1].first *= e[i].first;\n    }\n    return e.back().first;\n}\nint main()\n{\n    string s;\n    ll bob;\n    cin >> s >> bob;\n    s += '@';\n\n    vector<pair<ll, char>> e;\n    for (int i = 0; i < s.size(); i += 2)\n        e.push_back(pair<ll, char>(s[i] - '0', s[i + 1]));\n\n    bool mu = bob == mul(e);\n    bool le = bob == left(e);\n\n    if (mu && le)\n        cout << 'U' << endl;\n    else if (!mu && le)\n        cout << 'L' << endl;\n    else if (mu && !le)\n        cout << 'M' << endl;\n    else\n        cout << 'I' << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\nint main(){\n  string s;\n  cin>>s;\n  int n;\n  cin>>n;\n\n  int pu=0;\n  int ka=0;\n\n  vector<int> x(17,-1);\n  vector<int> f(17,-1);\n  int b=0;\n  int c=0;\n  for(int i=0;i<s.size();i++){\n    if(s[i]=='+'){\n      pu++;\n      f[c]=0;\n      b++;\n      c++;\n    }else if(s[i]=='*'){\n      ka++;\n      f[c]=1;\n      b++;\n      c++;\n    }else{\n      if(x[b]==-1)x[b]=0;\n      x[b]*=10;\n      x[b]+=s[i]-'0';\n    }\n  }\n  int lans=x[0];\n  for(int i=1;x[i]!=-1;i++){\n    if(f[i-1]==0)lans+=x[i];\n    if(f[i-1]==1)lans*=x[i];\n  }\n  //cout<<lans<<endl;\n\n  b=0;\n  c=0;\n  int tmp=1;\n  vector<int> tas;\n  //tmp=x[0];\n  for(int i=0;x[i]!=-1;i++){\n    if(f[c]==0){\n      tmp*=x[i];\n      tas.push_back(tmp);\n      //cout<<tmp<<\"aaa\"<<endl;\n      tmp=1;\n    }else{\n      tmp*=x[i];\n    }\n    b++;\n    c++;\n  }\n  tas.push_back(tmp);\n\n  int mans=0;\n  for(int i=0;i<tas.size();i++){\n    mans+=tas[i];\n    //cout<<tas[i]<<endl;\n  }\n\n  cout<<lans<<\" \"<<mans<<endl;\n\n  if(n!=lans&&n!=mans){\n    cout<<\"I\"<<endl;\n    return 0;\n  }\n\n  if(pu<2){\n    cout<<\"U\"<<endl;\n    return 0;\n  }\n\n  if(n==mans){\n    cout<<\"M\"<<endl;\n    return 0;\n  }\n\n  if(n==lans){\n    cout<<\"L\"<<endl;\n    return 0;\n  }\n\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <utility>\n#include <cmath>\n#include <algorithm>\n#include <iostream>\n#include <sstream>\n#include <iomanip>\n#include <vector>\n#include <string>\n#define REP(i,n) for(int i=0;i<n;i++)\ntypedef long long ll;\nusing namespace std;\ntypedef vector<ll> vl;\ntypedef pair<ll,ll> pll;\ntypedef vector<pll> vpll;\ntypedef vector<string> vs;\n\nint main() \n{\n\t//入力\n\tstring s;cin>>s;\n\tll ans;cin>>ans;\n\t\n\t//まずはかけ算\n\tll ans1(0);\n\tint tmp(1);\n\t\n\tif(s.length()==1)\n\t{\n\t\tans1=s[0]-'0';\n\t}\n\telse\n\t{\n\t\tfor(int i=0;i<(s.length())/2;i++)\n\t\t{\n\t\t\tif(i==0)\n\t\t\t{\n\t\t\t\tif(s[i*2+1]=='+')\n\t\t\t\t{\n\t\t\t\t\tans1+=s[i*2]-'0';\n\t\t\t\t\tif(i==(-3+s.length())/2)\n\t\t\t\t{\n\t\t\t\t\tans1+=s[i*2+2]-'0';\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttmp*=s[i*2]-'0';\n\t\t\t\tif(i==(-3+s.length())/2)\n\t\t\t\t{\n\t\t\t\t\ttmp*=s[i*2+2]-'0';\n\t\t\t\t\tans1+=tmp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(s[i*2+1]=='+')\n\t\t\t{\n\t\t\t\tif(s[i*2-1]=='*')\n\t\t\t\t{\n\t\t\t\t\ttmp*=s[i*2]-'0';\n\t\t\t\t\tans1+=tmp;tmp=1;\n\t\t\t\t\tif(i==(-3+s.length())/2)\n\t\t\t\t\t{\n\t\t\t\t\t\tans1+=s[i*2+2]-'0';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tans1+=s[i*2]-'0';\n\t\t\t\t\tif(i==(-3+s.length())/2)\n\t\t\t\t\t{\n\t\t\t\t\t\tans1+=s[i*2+2]-'0';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttmp*=s[i*2]-'0';\n\t\t\t\tif(i==(-3+s.length())/2)\n\t\t\t\t{\n\t\t\t\t\ttmp*=s[i*2+2]-'0';\n\t\t\t\t\tans1+=tmp;\n\t\t\t\t}\n\t\t\t}\n\t\t}}\n\t}\n\t\t//足し算\n\tll ans2(0);\n\tif(s.length()==1)\n\t{\n\t\tans2+=s[0]-'0';\n\t}\n\telse\n\t{\n\t\tfor(int i=0;i<(s.length())/2;i++)\n\t\t{\n\t\t\tif(i==0)\n\t\t\t{\n\t\t\t\tif(s[i*2+1]=='+')\n\t\t\t\t{\n\t\t\t\t\tans2+=s[i*2]-'0'+s[i*2+2]-'0';//cout<<\"-1-\"<<\" \"<<ans2<<endl;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tans2+=(s[i*2]-'0')*(s[i*2+2]-'0');//cout<<\"-2-\"<<\" \"<<ans2<<endl;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(s[i*2+1]=='+')\n\t\t\t\t{\n\t\t\t\t\tans2+=s[i*2+2]-'0';//cout<<\"-3-\"<<\" \"<<ans2<<endl;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tans2*=s[i*2+2]-'0';//cout<<\"-4-\"<<\" \"<<ans2<<endl;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tbool m =(ans==ans1);\n\tbool l =(ans==ans2);\n\t\t\n\tif(m&&!l){cout<<'M'<<endl;}\n\tif(!m&&l){cout<<'L'<<endl;}\n\tif(m&&l){cout<<'U'<<endl;}\n\tif(!m&&!l){cout<<'I'<<endl;}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <ctime>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cmath>\n#include <sstream>\n#include <utility>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef pair<int,int> pii;\n#define all(c) (c).begin(), (c).end()\n#define loop(i,a,b) for(ll i=a; i<ll(b); i++)\n#define rep(i,b) loop(i,0,b)\n#define each(e,c) for(auto&e:c)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define lb lower_bound\n#define ub upper_bound\n#ifdef DEBUG\n#define dump(...) (cerr<<#__VA_ARGS__<<\" = \"<<(DUMP(),__VA_ARGS__).str()<<\" [\"<<__LINE__<<\"]\"<<endl)\nstruct DUMP:ostringstream{template<class T>DUMP &operator,(const T&t){if(this->tellp())*this<<\", \";*this<<t;return *this;}};\n#else\n#define dump(...)\n#endif\ntemplate<class T> ostream& operator<<(ostream& os, vector<T> const& v){\n    rep(i,v.size()) os << v[i] << (i+1==v.size()?\"\":\" \");\n    return os;\n}\n\n#define int ll\n\nint parseL(string s){\n    int res = s[0]-'0';\n    for(int i=1;i<s.size();i+=2){\n        if(s[i]=='*') res*=s[i+1]-'0';\n        else res+=s[i+1]-'0';\n    }\n    return res;\n}\n\nint parseM(string s){\n    rep(i,s.size()){\n        if(s[i]=='*'){\n            char str[10]={};\n            str[0] = ('0'+(s[i-1]-'0')*(s[i+1]-'0'));\n            return parseM(s.substr(0,i-1)+str+s.substr(i+2));\n        }\n    }\n    return parseL(s);\n}\n\nsigned main(){\n    string s;\n    while(cin >> s){\n    ll x; cin >> x;\n    int a = parseM(s);\n    int b = parseL(s);\n    char ans;\n    if(x==a && x==b) ans = 'U';\n    else if(x==a) ans = 'M';\n    else if(x==b) ans = 'L';\n    else ans = 'I';\n    cout << ans << endl;\n}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#include<string>\nusing namespace std;\n#define lp(i,n) for(int i=0;i<n;i++)\n#define lps(i,j,n) for(int i=j;i<n;i++)\n#define fordebug int hoge;cin>>hoge;\n#define DEKAI 1000000007;\n#define INF (1<<28)\n#define int long long\n#define double long double\n#define floot10 cout<<fixed<<setprecision(10)\n#define G 1\n\nsigned main(){\n  string s;\n  cin>>s;\n  int n;\n  cin>>n;\n  int now=s[0]-'0';\n  for(int i=1;i<s.size();i+=2){\n    if(s[i]=='+'){\n      now+=s[i+1]-'0';\n    }\n    if(s[i]=='*'){\n      now*=s[i+1]-'0';\n    }\n  }\n  int now2=0;\n  int mode=-1;\n  for(int i=0;i<s.size();i+=2){\n    if(i==s.size()-1){\n      if(mode==-1) now2+=s[i]-'0';\n      else{\n\tnow2+=mode*(s[i]-'0');\n      }\n    }\n    else if(s[i+1]=='+'){\n      if(mode==-1){\n\tnow2+=s[i]-'0';\n      }\n      else{\n\tnow2+=mode*(s[i]-'0');\n\tmode=-1;\n      }\n    }\n    else{\n      if(mode==-1) mode=s[i]-'0';\n      else{\n\tmode*=s[i]-'0';\n      }\n    }\n  }\n  //cout<<now<<\" \"<<now2<<endl;\n  if(n==now&&n==now2) cout<<\"U\"<<endl;\n  else if(n==now) cout<<\"L\"<<endl;\n  else if(n==now2) cout<<\"M\"<<endl;\n  else cout<<\"I\"<<endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\n\nint comM(string str){\n  int res = 0;\n  string str2;\n  int sum = 0;\n  for(int i=0;i<str.size();i++) \n    if(str[i] =='*' && sum == 0) sum += (str[i-1]-'0') * (str[i+1]-'0');\n    else if(str[i] =='*' && sum != 0) sum *= (str[i+1] - '0');\n    else if(str[i] == '+') res += sum,sum = 0;\n  res += sum;\n  \n  for(int i=0;i<str.size();i++) \n    if(str[i] == '+' && (i == str.size()-1||str[i+2] != '*')) res += str[i]-'0';\n  return res;\n} \n\nint comL(string str) {\n  int res = str[0]-'0';\n  for(int i=0;i<str.size();i++)\n    if(str[i] == '*') res *= (str[i+1]-'0');\n    else if(str[i]=='+') res += (str[i+1]-'0');\n  return res;\n}\n\nint main(){\n  string str;\n  cin >> str;\n  int n;\n  cin >> n;\n  int M = comM(str);\n  int L = comL(str);\n  //  cout << M<<endl;\n  //cout << L <<endl;\n  if(M==n && L == n) cout << \"U\"<<endl;\n  else if(M==n) cout << \"M\"<<endl;\n  else if(L==n) cout <<\"L\"<<endl;\n  else cout << \"I\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <algorithm>\n#include <string>\n#include <vector>\n#include <cctype>\n#include <numeric>\n\n#define phb push_back\n#define sz(x) int((x).size())\n#define all(x) (x).begin(), (x).end()\nusing namespace std;\n\ntypedef long long ll;\nconst ll kInf = 1000000000;\n\nstring S;\nll T;\nvector< ll > rn;\nvector< char > rt;\n\nvoid solve();\nbool rule1();\nbool rule2();\n\nint main() {\n  cin >> S >> T;\n  solve();\n  return 0;\n}\n\nvoid solve() {\n  bool bb, bc;\n\n  for (int i = 0; i < sz(S); ++i)\n    if (!isdigit(S[i]))\n      rt.phb(S[i]), S[i] = ' ';\n\n  istringstream iss(S);\n  ll tn;\n  while (iss >> tn)\n    rn.phb(tn);\n\n  bb = rule1();\n  bc = rule2();\n\n  if (bb)\n    cout << (bc ? \"U\" : \"M\") << \"\\n\";\n  else\n    cout << (bc ? \"L\" : \"I\") << \"\\n\";\n}\n\nbool rule1() {\n  vector< ll > nrn;\n\n  nrn.phb(rn[0]);\n  for (int i = 0; i < sz(rt); ++i) {\n    if (rt[i] == '+')\n      nrn.phb(rn[i + 1]);\n    else {\n      nrn.back() *= rn[i + 1];\n      if (nrn.back() >= kInf)\n        return false;\n    }\n  }\n\n  return accumulate(all(nrn), ll(0)) == T;\n}\n\nbool rule2() {\n  ll tmp = rn[0];\n\n  for (int i = 0; i < sz(rt); ++i) {\n    if (rt[i] == '+')\n      tmp += rn[i + 1];\n    else\n      tmp *= rn[i + 1];\n\n    if (tmp >= kInf)\n      return false;\n  }\n\n  return tmp == T;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\nint calc1(string str){//multiplication-first\n\tstack<int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push((int)stoi(rststr));\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t\tint tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\tint rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nint calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tint rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nint calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\tint rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\tcin >> str;\n\tint ans;\n\tcin >> ans;\n\tint rst1 = calc2(str);\n\tint rst2 = calc3(str);\n\tcout << rst1 << \" \" << rst2 << endl;\n\tif(rst1==ans){\n\t\tif(rst2==ans) cout << 'U' << endl;\n\t\telse cout << 'M' << endl;\n\t}else{\n\t\tif(rst2==ans) cout << 'L' << endl;\n\t\telse cout << 'I' << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#ifdef LOCAL\n#include \"dump.hpp\"\n#else\n#define dump(...)\n#endif\n\nusing namespace std;\n\nenum { M = 1, L = 2 };\nchar output[] = {'I', 'M', 'L', 'U'};\nint priority[128];\n\nint parse(int l, int r, const string &expression, int p = 2) {\n\tfor(int i = r - 1; i >= l; --i) {\n\t\tif(priority[expression[i]] == p) {\n\t\t\tswitch(expression[i]) {\n\t\t\tcase '+':\n\t\t\t\treturn parse(l, i, expression, p) + parse(i + 1, r, expression, p);\n\t\t\tcase '*':\n\t\t\t\treturn parse(l, i, expression, p) * parse(i + 1, r, expression, p);\n\t\t\tdefault:\n\t\t\t\tassert(false);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn p > 1 ? parse(l, r, expression, p - 1) : stoi(expression.substr(l, r - l));\n}\n\nint main() {\n\tcin.tie(nullptr);\n\tios::sync_with_stdio(false);\n\n\tint Bobs_answer;\n\tstring expression;\n\tcin >> expression >> Bobs_answer;\n\n\tint ans = 0;\n\n\tpriority['+'] = priority['*'] = 2;\n\tif(parse(0, expression.size(), expression) == Bobs_answer) ans |= L;\n\n\tpriority['*'] = 1;\n\tif(parse(0, expression.size(), expression) == Bobs_answer) ans |= M;\n\n\tcout << output[ans] << endl;\n\n\treturn EXIT_SUCCESS;\n}"
  },
  {
    "language": "C++",
    "code": "//#include<bits/stdc++.h>\n#include<iostream>\n#include<iomanip>\n#include<cmath>\n#include<cstdlib>\n#include<cstring>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<stack>\n#include<map>\n#include<numeric>\n#include<bitset>\n#include<limits>\n#include<unordered_map>\n#include<functional>\nusing namespace std;\n\n#define rep(i,s,n) for(int i=s;i<n;i++)\n#define dow(i,n,s) for(int i=n-1;i>=s;i--)\n#define all(a) a.begin(),a.end()\n#define Sort(a) sort(all(a))\n#define Qsort(a,size) qsort(a,size,sizeof(*a),compare_int)\n#define DEBUG\ntypedef pair<int,int> II;\ntypedef unsigned long ul;\ntypedef long long ll;\ntypedef unsigned long long ull;\nbool compare_int(const void *a,const void *b) { return *(int *)a-*(int *)b; }\nbool compare_by_second(II a,II b) { return a.second!=b.second?a.second<b.second:a.first<b.first; }\n\nconst int INF = 1e+9;\nconst int MAX_S = 17;\n\nstring s;\nint ans,M = 0,L = 0;\nvector<int> Mi;\n\n//void solve();\n\nint main() {\n  cin>>s>>ans;\n\n  rep(i,0,s.size()) {\n    if(s[i] =='*') { Mi[Mi.size()-1] = Mi[Mi.size()-1]*(s[i+1]-'0'); i++; }\n    else if('0' <= s[i] && s[i] <= '9') Mi.push_back(s[i] - '0');\n  }\n  rep(i,0,Mi.size()) M+=Mi[i];\n\n  rep(i,0,s.size()) {\n    if(s[i] == '*') { L*=(s[i+1] - '0'); i++; }\n    else if(s[i] == '+') { L+=(s[i+1] - '0'); i++; }\n    else L = (s[i] - '0');\n  }\n\n  //cout<<\"M-->\"<<M<<\" , L-->\"<<L<<endl;\n\n  if(ans == M && ans == L) { cout<<\"U\"<<endl; return 0; }\n  if(ans != M && ans != L) { cout<<\"I\"<<endl; return 0; }\n  if(ans == M) { cout<<\"M\"<<endl; return 0; }\n  cout<<\"L\"<<endl; return 0;\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef ostringstream OSS;\ntypedef istringstream ISS;\n\ntypedef long long LL;\ntypedef pair<int, int> PII;\n\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\ntypedef vector<double> VD;\ntypedef vector<VD> VVD;\ntypedef vector<string> VS;\ntypedef vector<VS> VVS;\ntypedef vector<bool> VB;\ntypedef vector<VB> VVB;\ntypedef vector<PII> VPII;\n\n#define fst first\n#define snd second\n// #define Y first\n// #define X second\n#define MP make_pair\n#define PB push_back\n#define EB emplace_back \n#define ALL(x) (x).begin(),(x).end()\n#define RANGE(x,y,maxX,maxY) (0 <= (x) && 0 <= (y) && (x) < (maxX) && (y) < (maxY))\n#define DUMP( x ) cerr << #x << \" = \" << ( x ) << endl\n#define rep(i, N) for (int i = 0; i < (int)(N); i++)\n#define REP(i, init, N) for (int i = (init); i < (int)(N); i++)\n\ntemplate < typename T > inline T fromString(const string &s) { T res; ISS iss(s); iss >> res; return res; };\ntemplate < typename T > inline string toString(const T &a) { OSS oss; oss << a; return oss.str(); };\n\nconst int INF = 0x3f3f3f3f;\nconst LL INFL = 0x3f3f3f3f3f3f3f3fLL;\nconst double DINF = 0x3f3f3f3f;\nconst int DX[]={1,0,-1,0},DY[]={0,-1,0,1};\n\nstring s;\nint N;\n\nPII digit(int pos) {\n    int res = 0;\n    \n    while (pos < (int)s.size() && isdigit(s[pos])) {\n        res *= 10;\n        res += s[pos] - '0';\n        ++pos;\n    }\n\n    return MP(pos, res);\n}\n\nPII digit_m(int pos) {\n    PII res = digit(pos);\n\n    if (res.fst < (int)s.size() && s[res.fst] == '*') {\n        PII res2 = digit_m(res.fst + 1);\n        return MP(res2.fst, res.snd * res2.snd);\n    } else {\n        return res;\n    }\n}\n\nPII dfs1(int pos0) {\n    PII res0 = digit_m(pos0);\n    int num = res0.snd;\n    int pos = res0.fst;\n\n    if (pos >= (int)s.size()) {\n        return MP(pos, num);\n    } else if (s[pos] == '+') {\n        PII res = dfs1(pos + 1);\n        return MP(res.fst, num + res.snd);\n    } else {\n        cout << pos << \" \" << s[pos] << endl;\n        assert(!\"dfs2 error\" );\n    }\n}\n\nPII dfs2(int pos0) {\n    PII res0 = digit(pos0);\n    int num = res0.snd;\n    int pos = res0.fst;\n\n    while (pos < (int)s.size()) {\n        char ope = s[pos];\n        PII dig = digit(pos + 1);\n        \n        if (ope == '*') {\n            num *= dig.snd;\n        } else if(ope == '+') {\n            num += dig.snd;\n        } else {\n            assert(!\"dfs2 error\");\n        }\n\n        pos = dig.fst;\n    }\n\n    return MP(pos, num);\n}\n\nint main(void) {\n    cin >> s >> N;\n\n    int a = dfs1(0).snd; // normal\n    int b = dfs2(0).snd; // left-right\n\n//    cerr << a << \" \" << b << endl;\n\n    if (a == N && b == N) cout << \"U\" << endl;\n    else if (a == N) cout << \"M\" << endl;\n    else if (b == N) cout << \"L\" << endl;\n    else cout << \"I\" << endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<stack>\n#include<queue>\n#include<string>\n//#include<>\nusing namespace std;\n\n#define rep(i,j) for(i=0;i<j;(i)++)\n\nint main()\n{\n  string line;\n  getline(cin,line);\n  int ans;\n  cin>>ans;\n\n  int ans_M=0,ans_L=0;\n  int i;\n  for(i=0;i<line.size();i++){\n    //L計算\n    if(i==0)ans_L+=atoi(&line[i]);\n    else if(line[i]=='+'){\n      ans_L+=atoi(&line[i+1]);\n      i++;\n    }\n    else if(line[i]=='*'){\n      ans_L*=atoi(&line[i+1]);\n      i++;\n    }\n  }\n  int val=0;\n  for(i=0;i<line.size();i+=2){\n    val=atoi(&line[i]);\n    while(i+1<line.size() && line[i+1]=='*'){\n      i+=2;\n      val*=atoi(&line[i]);\n    }\n    ans_M+=val;\n  }\n  //cout<<ans_L<<\" \"<<ans_M<<endl;\n  if(ans_L==ans && ans_M==ans)cout<<\"U\"<<endl;\n  else if(ans_L==ans)cout<<\"L\"<<endl;\n  else if(ans_M==ans)cout<<\"M\"<<endl;\n  else cout<<\"I\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cctype>\n#include <complex>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iomanip>\n#include <iostream>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 29;\n\nint main(void){\n    string expr; cin >> expr;\n    int ans; cin >> ans;\n\n    char res = 'I';\n\n    int sum = expr[0] - '0';\n    range(i, 1, expr.size()){\n        if(expr[i++] == '+'){\n            sum += expr[i] - '0';\n        }\n        else sum *= expr[i] - '0';\n    }\n    if(ans == sum) res = 'L';\n\n    sum = 0;\n    vi nums;\n    nums.pb(expr[0] - '0');\n    range(i, 1, expr.size()){\n        if(expr[i++] == '+'){\n            nums.pb(expr[i] - '0');\n        }\n        else nums[nums.size() - 1] *= expr[i] - '0';\n    }\n    each(itr, nums){\n        sum += *itr;\n    }\n    if(ans == sum){\n        res = res == 'L' ? 'U':'M';\n    } \n\n    cout << res << endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\ntypedef pair<int, int> PII;\n\nLL solve1(char s[]) {\n  stack<LL> a;\n  stack<char> o;\n  for (int i = 0; s[i]; ++ i) {\n    if (s[i] >= '0' && s[i] <= '9') a.push(s[i] - '0');\n    else {\n      if (s[i] == '+') {\n        while (!o.empty() && o.top() == '*') {\n          LL x = a.top(); a.pop();\n          LL y = a.top(); a.pop();\n          a.push(x * y); o.pop();\n        }\n        o.push('+');\n      }\n      else o.push(s[i]);\n    }\n  }\n  while (!o.empty()) {\n    LL x = a.top(); a.pop();\n    LL y = a.top(); a.pop();\n    if (o.top() == '+') a.push(x + y);\n    else a.push(x * y);\n    o.pop();\n  }\n  return a.top();\n}\n\nLL solve2(char s[]) {\n  LL r(0), p(0);\n  for (int i = 0; s[i]; ++ i) {\n    if (s[i] >= '0' && s[i] <= '9') {\n      if (p) r = r * (s[i] - '0');\n      else r += s[i] - '0';\n    }\n    else {\n      p = s[i] == '*';\n    }\n  }\n  return r;\n}\n\nint main() {\n  char s[100]; int n;\n  while (scanf(\"%s%d\", s, &n) == 2) {\n    LL r1 = solve1(s);\n    LL r2 = solve2(s);\n    if (r1 == n && r2 == n) puts(\"U\");\n    else if (r1 == n && r2 != n) puts(\"M\");\n    else if (r1 != n && r2 == n) puts(\"L\");\n    else puts(\"I\");\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\n\nint comM(string str){\n  int res = 0;\n  int sum = 0;\n  for(int i=0;i<str.size();i++) \n    if(str[i] =='*' && sum == 0) sum += (str[i-1]-'0') * (str[i+1]-'0');\n    else if(str[i] =='*' && sum != 0) sum *= (str[i+1] - '0');\n    else if(str[i] == '+') res += sum,sum = 0;\n  res += sum;\n  if(str[1] == '+') res += str[0]-'0';\n  for(int i=0;i<str.size();i++) \n    if(str[i] == '+' && (i+1 == str.size()-1||str[i+2] != '*')) res += str[i+1]-'0';\n    return res;\n} \n\nint comL(string str) {\n  int res = str[0]-'0';\n  for(int i=0;i<str.size();i++)\n    if(str[i] == '*') res *= (str[i+1]-'0');\n    else if(str[i]=='+') res += (str[i+1]-'0');\n  return res;\n}\n\nint main(){\n  string str;\n  cin >> str;\n  int n;\n  cin >> n;\n  int M = comM(str);\n  int L = comL(str);\n  //  cout << M<<endl;\n  //cout << L <<endl;\n  if(M==n && L == n) cout << \"U\"<<endl;\n  else if(M==n) cout << \"M\"<<endl;\n  else if(L==n) cout <<\"L\"<<endl;\n  else cout << \"I\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <stdlib.h>\n#include <vector>\n#include <string>\nusing namespace std;\n\nvoid\nprint_vec (vector<int> exp)\n{\n\tfor (auto x:exp)\n\t{\n\t\tif (x == -5)\n\t\t\tcout << \"+\";\n\t\telse if (x == -6)\n\t\t\tcout << \"*\";\n\t\telse if (x)\n\t\t\tcout << x;\n\t\telse\n\t\t\tcout << \"error\";\n\t}\n\tcout <<endl;\n}\n\nvector<int>\nstr_to_vec (string exp)\n{\n\tvector<int> v;\n\tfor (int i = 0; i < exp.size(); i++)\n\t{\n\t\tint c = exp[i] - '0';\n\t\tif (0 <= c || c <= 9) // number\n\t\t\tv.push_back(c);\n\t\telse \n\t\t\tv.push_back(c);\n\t}\n\treturn v;\n}\n\nint\nmis_cal (vector<int> exp)\n{\n\tint num = exp[0];\n\tbool add, mul;\n\tadd = mul = false;\n\tfor (int i = 1; i < exp.size(); i++)\n\t{\n\t\tif (exp[i] == -5) // plus\n\t\t\tadd = true;\n\t\telse if (exp[i] == -6) // mul\n\t\t\tmul = true;\n\t\telse \n\t\t{\n\t\t\tif (add)\n\t\t\t{\n\t\t\t\tnum += exp[i];\n\t\t\t\tadd = false;\n\t\t\t}\n\t\t\telse if (mul)\n\t\t\t{\n\t\t\t\tnum *= exp[i];\n\t\t\t\tmul = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcout << \"error\" <<endl;\n\t\t\t\texit(1);\n\t\t\t}\n\t\t}\n\t}\n\treturn num;\n}\n\nint\ncal (vector<int> exp)\n{\n\tint num = exp[0];\n\tvector<int> v;\n\tbool add, mul;\n\tadd = mul = false;\n\tfor (int i = 1; i < exp.size(); i++)\n\t{\n\t\tif (mul)\n\t\t{\n\t\t\tnum *= exp[i];\n\t\t\tmul = false;\n\t\t}\n\t\telse if (add)\n\t\t{\n\t\t\tv.push_back(num);\n\t\t\tv.push_back(-5);\n\t\t\tnum = exp[i];\n\t\t\tadd = false;\n\t\t}\n\t\telse if (exp[i] == -6)\n\t\t\tmul = true;\n\t\telse if (exp[i] == -5)\n\t\t\tadd = true;\n\t\telse if (0 <= exp[i] && exp[i] <= 9)\n\t\t{\n\t\t\tnum = exp[i];\n\t\t}\n\t\telse \n\t\t{\n\t\t\tcout << \"error\"<<endl;\n\t\t\texit(1);\n\t\t}\n\t}\n\tv.push_back(num);\n#ifdef D\n\tcout << \"cal\";\n\tprint_vec(v);\n#endif\n\n\treturn mis_cal(v);\n}\n\n\tint\nmain (void)\n{\n\tint bob_ans;\n\tstring str_exp;\n\tcin >> str_exp >> bob_ans;\n\n\tvector<int> vec_exp = str_to_vec(str_exp);\n#ifdef D\n\tprint_vec(vec_exp);\n\tcout << \"mis_cal \" << mis_cal(vec_exp) << endl;\n\tcout << \"cal     \" << cal(vec_exp) << endl;\n#endif\n\tint m, c;\n\tm = mis_cal(vec_exp); c = cal(vec_exp);\n\tif (bob_ans == m && bob_ans == c)\n\t\tcout << \"U\" <<endl;\n\telse if (bob_ans == c)\n\t\tcout << \"M\" <<endl;\n\telse if (bob_ans == m)\n\t\tcout << \"L\" <<endl;\n\telse\n\t\tcout << \"I\" <<endl;\n\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  string s;\n  int n;\n  cin >> s >> n;\n\n  stack<int> t;\n  t.push(s[0]-'0');\n  for(int i=1;i<s.size();i+=2){\n    int tmp = s[i+1]-'0';\n    if(s[i] == '*')t.top() *= tmp;\n    else t.push(tmp);\n  }\n  int M = 0;\n  while(t.size()){\n    M += t.top(), t.pop();\n  }\n\n  int L = s[0]-'0';\n  for(int i=1;i<s.size();i+=2){\n    int tmp = s[i+1]-'0';\n    if(s[i] == '*')L *= tmp;\n    else L += tmp;\n  }\n\n  if(M == n && L == n)cout << \"U\";\n  else if(M == n)cout << \"M\";\n  else if(L == n)cout << \"L\";\n  else cout << \"I\";\n  cout << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,n) for (int (i)=(0);(i)<(int)(n);++(i))\nusing ll = long long;\nusing P = pair<ll, ll>;\nusing namespace std;\n\ntemplate<class t> void vin(vector<t>& v, int n) {\n    v.resize(n);\n    for (int i = 0; i < n; ++i) {\n        cin >> v[i];\n    }\n}\n\nint get_m(string s) {\n    if (s.size() == 1) return s[0]-'0';\n    vector<string> v;\n    rep(i, s.size()) {\n        if (s[i] != '*') {\n            string tmp = \"\";\n            tmp += s[i];\n            v.push_back(tmp);\n        }\n        else {\n            string last = v[v.size()-1];\n            v.pop_back();\n            int num1 = stoi(last);\n            int num2 = (s[i+1]-'0');\n            int tmp = num1*num2;\n            v.push_back(to_string(tmp));\n            i++;\n        }\n    }\n    int ret = 0;\n    for (int i=1; i<v.size(); i+=2) {\n        if (i == 1) {\n            ret += stoi(v[i-1])+stoi(v[i+1]);\n        }\n        else {\n            ret += stoi(v[i+1]);\n        }\n    }\n    return ret;\n}\n\nint get_l(string s) {\n    if (s.size() == 1) return s[0]-'0';\n    int ret = -1;\n    for (int i=1; i<s.size(); i+=2) {\n        int num2 = s[i+1]-'0';\n        if (i == 1) {\n            int num1 = s[i-1]-'0';\n            if (s[i] == '+') ret = num1 + num2;\n            else ret = num1 * num2;\n        }\n        else {\n            if (s[i] == '+') ret += num2;\n            else ret *= num2;\n        }\n    }\n    return ret;\n}\n\nint main() {\n    string s;\n    cin >> s;\n    int ans;\n    cin >> ans;\n    int m = get_m(s);\n    int l = get_l(s);\n    string ret = \"\";\n    if (m == ans) {\n        if (l == ans) {\n            ret = \"U\";\n        }\n        else {\n            ret = \"M\";\n        }\n    }\n    else if (l == ans) {\n        ret = \"L\";\n    }\n    else {\n        ret = \"I\";\n    }\n    cout << ret << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\n\nint main(){\n\tstring f; cin >> f;\n\tint a; cin >> a;\n\tint n = f.size() / 2;\n\tint l = f[0] - '0';\n\tfor(int i = 0; i < n; i++){\n\t\tif(f[i*2+1] == '+'){\n\t\t\tl += f[i*2+2] - '0';\n\t\t}else{\n\t\t\tl *= f[i*2+2] - '0';\n\t\t}\n\t}\n\tvector<int> v;\n\tv.push_back(f[0] - '0');\n\tfor(int i = 0; i < n; i++){\n\t\tif(f[i*2+1] == '+'){\n\t\t\tv.push_back(f[i*2+2] - '0');\n\t\t}else{\n\t\t\tv[v.size() - 1] *= f[i*2+2] - '0';\n\t\t}\t\n\t}\n\tint m = 0;\n\tfor(auto i: v) m += i;\n\tif(a==m && a==l) cout << 'U' << endl;\n\tif(a!=m && a==l) cout << 'L' << endl;\n\tif(a==m && a!=l) cout << 'M' << endl;\n\tif(a!=m && a!=l) cout << 'I' << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\ntemplate<typename T> T gcd(T a, T b) {\n    if(!b) return a;\n    return gcd(b, a % b);\n}\ntemplate<typename T> T lcm(T a, T b) {\n    return a * b / gcd(a, b);\n}\n\ntemplate<typename T> void chmin(T& a, T b) { a = (a > b) ? b : a; }\ntemplate<typename T> void chmax(T& a, T b) { a = (a < b) ? b : a; }\nint in() { int x; scanf(\"%d\", &x); return x; }\n\nusing namespace std;\n\ntypedef long long Int;\ntypedef unsigned uint;\n\nstring S;\nint res;\n\nint toInt(string s) {\n\tint ans = 0;\n\t\n\tfor (int i = 0; i < (int) s.size(); i++) {\n\t\tans = ans * 10 + (s[i] - '0');\n\t}\n\n\treturn ans;\n}\n\nstring toString(int s) {\n\tstring ans = \"\";\n\n\twhile (s > 0) {\n\t\tans = char('0' + s % 10) + ans;\n\t\ts /= 10;\n\t}\n\n\treturn ans;\n}\n\nbool evalR(string s) {\n\tvector<string> vs;\n\n\tfor (int i = 0; i < s.size(); i++) {\n\t\tvs.push_back(string(1, s[i]));\n\t}\n\n\tfor (int i = 0; i < vs.size(); i++) {\n\t\tif (vs[i] == \"*\") {\n\t\t\tint l = 0, r = 0;\n\n\t\t\tfor (int j = 0; j < vs[i - 1].size(); j++) {\n\t\t\t\tl = l * 10 + (vs[i - 1][j] - '0');\n\t\t\t}\n\n\t\t\tfor (int j = 0; j < vs[i + 1].size(); j++) {\n\t\t\t\tr = r * 10 + (vs[i + 1][j] - '0');\n\t\t\t}\n\n\n\t\t\tint ins = l * r;\n\n\t\t\tvs.erase(vs.begin() + i - 1, vs.begin() + i + 2);\n\t\t\tvs.insert(vs.begin() + i - 1, toString(ins));\n\t\t\ti--;\n\t\t}\n\t}\n\t\n\tfor (int i = 0; i < vs.size(); i++) {\n\t\tif (vs[i] == \"+\") {\n\t\t\tint l = 0, r = 0;\n\n\t\t\tfor (int j = 0; j < vs[i - 1].size(); j++) {\n\t\t\t\tl = l * 10 + (vs[i - 1][j] - '0');\n\t\t\t}\n\n\t\t\tfor (int j = 0; j < vs[i + 1].size(); j++) {\n\t\t\t\tr = r * 10 + (vs[i + 1][j] - '0');\n\t\t\t}\n\n\t\t\tint ins = l + r;\n\n\t\t\tvs.erase(vs.begin() + i - 1, vs.begin() + i + 2);\n\t\t\tvs.insert(vs.begin() + i - 1, toString(ins));\n\t\t\ti--;\n\t\t}\n\t}\t\n\t\n\treturn toInt(vs[0]) == res;\n}\n\nbool evalF(string s) {\n\tvector<string> vs;\n\n\tfor (int i = 0; i < s.size(); i++) {\n\t\tvs.push_back(string(1, s[i]));\n\t}\n\t\n\tfor (int i = 0; i < vs.size(); i++) {\n\t\tif (vs[i] == \"*\" || vs[i] == \"+\") {\n\t\t\tint l = 0, r = 0;\n\n\t\t\tfor (int j = 0; j < vs[i - 1].size(); j++) {\n\t\t\t\tl = l * 10 + (vs[i - 1][j] - '0');\n\t\t\t}\n\n\t\t\tfor (int j = 0; j < vs[i + 1].size(); j++) {\n\t\t\t\tr = r * 10 + (vs[i + 1][j] - '0');\n\t\t\t}\n\n\n\t\t\tint ins = -1;\n\n\t\t\tif (vs[i] == \"+\") {\n\t\t\t\tins = l + r;\n\t\t\t} else {\n\t\t\t\tins = l * r;\n\t\t\t}\n\n\t\t\tvs.erase(vs.begin() + i - 1, vs.begin() + i + 2);\n\t\t\tvs.insert(vs.begin() + i - 1, toString(ins));\n\t\t\ti--;\n\t\t}\n\t}\n\n\treturn toInt(vs[0]) == res;\n}\n\nint main(void) {\n\tcin >> S >> res;\n\n\tbool R = evalR(S);\n\tbool F = evalF(S);\n\n\tif (R && F) {\n\t\tcout << \"U\\n\";\n\t} else if (R) {\n\t\tcout << \"M\\n\";\n\t} else if (F) {\n\t\tcout << \"L\\n\";\n\t} else {\n\t\tcout << \"I\\n\";\n\t}\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<string>\n#include<iostream>\n#include<cmath>\n#include<map>\n#include<set>\n#include<climits>\nusing namespace std;\ntypedef vector<string>vs;\ntypedef vector<int>vi;\ntypedef vector<vi>vvi;\ntypedef vector<double>vd;\ntypedef pair<int,int>pii;\ntypedef long long ll;\ntypedef pair<ll,ll>pll;\ntypedef vector<ll>vl;\ntypedef pair<int,pii>piii;\n#define rrep(i,x,n) for(int i=(x);i<(n);++i)\n#define rep(i,x) rrep(i,0,(x))\n#define fi first\n#define se second\n#define each(i,c) for(__typeof((c).begin()) i=(c).begin();i!=(c).end();++i)\n#define all(c) (c).begin(),(c).end()\n#define rall(c) (c).rbegin(),(c).rend()\n#define pb push_back\n#define maxs(a,b) (a)=max(a,b)\n#define mins(a,b) (a)=min(a,b)\n///#include<sstream>\n///#include<cstring>\n///#include<stack>\n///#include<complex>\n\ntypedef string::const_iterator state;\n\nint number(state &Begin){\n    int ret=0;\n    while(isdigit(*Begin)){\n        ret=ret*10+(*Begin)-'0';\n        Begin++;\n    }\n    return ret;\n}\n\nint multi(state &Begin){\n    int ret=number(Begin);\n    while(true){\n        if(*Begin=='*'){\n            Begin++;\n            ret*=number(Begin);\n        }\n        else break;\n    }\n    return ret;\n}\n\nint solve1(state &Begin){\n    int ret=multi(Begin);\n\n    while(true){\n        if(*Begin=='+'){\n            Begin++;\n            ret+=multi(Begin);\n        }\n        else break;\n    }\n\n    return ret;\n\n}\n\nint solve2(state &Begin){\n    int ret=number(Begin);\n    while(true){\n        if(*Begin=='+'){\n            Begin++;\n            ret+=number(Begin);\n        }\n        else if(*Begin=='*'){\n            Begin++;\n            ret*=number(Begin);\n        }\n        else break;\n    }\n    return ret;\n}\nint main(){\n    string str;\n    int ans;\n    cin>>str>>ans;\n    str+=\"=\";\n    state b=str.begin();\n    int f1=solve1(b);\n    b=str.begin();\n    int f2=solve2(b);\n    if(f1==ans&&f2==ans)puts(\"U\");\n    else if(f1==ans)puts(\"M\");\n    else if(f2==ans)puts(\"L\");\n    else puts(\"I\");\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main(){\n\tstring str;\n\tint n;\n\tcin >> str >> n;\n\tchar x = 'x';\n\tint f = 0, s = 0;\n\tint num[10];\n\tbool used[10];\n\tchar ope[10];\n\tfor(int i = 0; i < str.size(); i++){\n\t\tif(i%2 == 0){\n\t\t\tnum[i/2] = str[i]-'0';\n\t\t} else{\n\t\t\tope[i/2] = str[i];\n\t\t}\n\t}\n\tint t = 0;\n\tfor(int i = 0; i < str.size()/2; i++){\n\t\tif(ope[i] == '*'){\n\t\t\tif(t == 0){\n\t\t\t\tt = num[i]*num[i+1];\n\t\t\t\tused[i] = true;\n\t\t\t\tused[i+1] = true;\n\t\t\t} else{\n\t\t\t\tt *= num[i+1];\n\t\t\t\tused[i+1] = true;\n\t\t\t}\n\t\t} else{\n\t\t\tf += t;\n\t\t\tt = 0;\n\t\t}\n\t}\n\tfor(int i = 0; i < (str.size()+1)/2; i++){\n\t\tif(!used[i]) f += num[i];\n\t}\n\tfor(int i = 0; i < str.size(); i++){\n\t\tif(i%2 == 0){\n\t\t\tif(x == 'x') s = str[i]-'0';\n\t\t\tif(x == '+') s += str[i]-'0';\n\t\t\tif(x == '*') s *= str[i]-'0';\n\t\t} else{\n\t\t\tx = str[i];\n\t\t}\n\t}\n\tif(s == n){\n\t\tif(f == n) cout << \"U\" << endl;\n\t\telse cout << \"L\" << endl;\n\t} else{\n\t\tif(f == n) cout << \"M\" << endl;\n\t\telse cout << \"I\" << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <list>\n#include <vector>\n#include <complex>\n#include <utility>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <bitset>\n#include <ctime>\n#include <map>\n#include <unordered_map>\n#include <set>\n#include <unordered_set>\n#include <cassert>\n#include <cstddef>\n#include <iomanip>\n#include <numeric>\n#include <tuple>\n#include <sstream>\n#include <fstream>\n\nusing namespace std;\n#define REP(i, n) for (int (i) = 0; (i) < (n); (i)++)\n#define FOR(i, a, b) for (int (i) = (a); (i) < (b); (i)++)\n#define RREP(i, a) for(int (i) = (a) - 1; (i) >= 0; (i)--)\n#define FORR(i, a, b) for(int (i) = (a) - 1; (i) >= (b); (i)--)\n#define DEBUG(C) cerr << #C << \" = \" << C << endl;\nusing LL = long long;\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing VL = vector<LL>;\nusing VVL = vector<VL>;\nusing VD = vector<double>;\nusing VVD = vector<VD>;\nusing PII = pair<int, int>;\nusing PDD = pair<double, double>;\nusing PLL = pair<LL, LL>;\nusing VPII = vector<PII>;\ntemplate<typename T> using VT = vector<T>;\n#define ALL(a) begin((a)), end((a))\n#define RALL(a) rbegin((a)), rend((a))\n#define SORT(a) sort(ALL((a)))\n#define RSORT(a) sort(RALL((a)))\n#define REVERSE(a) reverse(ALL((a)))\n#define MP make_pair\n#define FORE(a, b) for (auto &&a : (b))\n#define FIND(s, e) ((s).find(e) != (s).end())\n#define EB emplace_back\ntemplate<typename T>inline bool chmax(T &a,T b){if(a<b){a=b;return true;}return false;}\ntemplate<typename T>inline bool chmin(T &a,T b){if(a>b){a=b;return true;}return false;}\n\nconst int INF = 1e9;\nconst int MOD = INF + 7;\nconst LL LLINF = 1e18;\n\nchar strbuf[1000];\nstring s;\nint ans;\n\nint leftToRightCalc(string s) {\n    const int L = s.length();\n    int res = s[0] - '0';\n    bool premul = false;\n    FOR(i, 1, L) {\n        if (isdigit(s[i])) {\n            if (premul) {\n                res *= s[i] - '0';\n            } else {\n                res += s[i] - '0';\n            }\n        } else {\n            premul = s[i] == '*';\n        }\n    }\n    return res;\n}\nint mulFirstCalc(string s) {\n    string news = \"\";\n    int res = 0;\n    bool premul = false;\n    REP(i, s.length()) {\n        if (s[i] == '+') continue;\n        if (isdigit(s[i])) {\n            news += s[i];\n            premul = false;\n        } else {\n            //DEBUG(news)\n            int c = news.back() - '0';\n            if (!premul) news.pop_back();\n            while (!premul && news.back() == '+') news.pop_back();\n            int c2 = s[++i] - '0';\n            res += (c * c2);\n            premul = true;\n        }\n    }\n    //DEBUG(news)\n    return res + leftToRightCalc(news);\n}\n\nint main(void) {\n    scanf(\"%s\", strbuf);\n    s = strbuf;\n    scanf(\"%d\", &ans);\n    int ltr = leftToRightCalc(s);\n    //DEBUG(ltr)\n    int mf = mulFirstCalc(s);\n    //DEBUG(mf)\n    if (ans == mf && ans != ltr) {\n        puts(\"M\");\n    } else if (ans != mf && ans == ltr) {\n        puts(\"L\");\n    } else if (ans == mf && ans == ltr) {\n        puts(\"U\");\n    } else {\n        puts(\"I\");\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>  \nusing namespace std;\nconst int INF = 999;\n//世界一競技プログラミングができない人のソース2\n\nint get_number(string str, int& idx){\n  int old = idx;\n  while(isdigit(str[idx])) ++idx;\n  return atoi(str.substr(old, idx - old).c_str());\n}\n\nint Expression(string str, int& idx){\n  int ret = get_number(str, idx);\n  while(true){\n    switch(str[idx]){\n    case '*':\n      ret *= get_number( str, ++idx);\n      break;\n    default:\n      return ret;\n    }\n  }\n}\n\nint nomal(string str, int idx = 0){\n  int res = Expression(str, idx);\n  while(true){\n    switch(str[idx]){\n    case '+':\n      ++idx;\n      res += Expression(str, idx);\n      break;\n    default:\n      return res;\n    }\n  }\n}\nint special(string str, int idx = 0){\n  int ret = get_number(str, idx);\n  while(str.size() > idx){\n    if(str[idx] == '+') ret += get_number(str, ++idx);\n    if(str[idx] == '*') ret *= get_number(str, ++idx);\n    else break;\n  }\n  return ret;\n}\n\nint main(){\n  string str;\n  cin >> str;\n  int digit;\n  cin >> digit;\n\n  bool judge_a = nomal(str) == digit;\n  bool judge_b = special(str) == digit;\n  if(judge_a & judge_b){\n    cout << \"U\" << endl;\n  } else if( judge_a){\n    cout << \"M\" << endl;\n  } else if( judge_b){\n    cout << \"L\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n\n}"
  },
  {
    "language": "C++",
    "code": "/* attention to typo and overflow */\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <queue>\n#include <iostream>\n#include <cmath>\n#include <cstdio>\n\nusing namespace std;\nconst int INF=1<<25;\n//void io(){ cin.tie(0);ios::sync_with_stdio(false);} //attention to use of endl\n/*printf(\"%.9Lf\\n\",cf);*/\nchar output(bool i,bool j){\n\tif(i==1 && j==0){\n\t\treturn 'M';\n\t}\n\tif(i==0 && j==1){\n\t\treturn 'L';\n\t}\n\tif(i==0 && j==0){\n\t\treturn 'I';\n\t}\n\tif(i==1 && j==1){\n\t\treturn 'U';\n\t}\n\treturn 'N';\n}\n\nint main(){\n\t//io();\n\tstring s;\n\tgetline(cin,s);\n\t//cin.ignore();\n\tint ans;\n\tcin>>ans;\n\n\tvector <int> plus;\n\tfor(int i=0;i<s.size();i++){\n\t\tif(i%2==0){\n\t\t\tif(i!=0 && s[i-1]=='*'){\n\t\t\t\tplus[plus.size()-1]*=s[i]-'0';\n\t\t\t}else{\n\t\t\t\tplus.push_back(s[i]-'0');\n\t\t\t}\n\t\t}\n\t}\n\n\tint one=0;\n\tfor(int i=0;i<plus.size();i++){\n\t\t//cerr<<plus[i]<<endl;\n\t\tone+=plus[i];\n\t}\n\n\tint two=s[0]-'0';\n\tfor(int i=1;i<s.size();i++){\n\t\tif(i%2==0){\n\t\t\tif(s[i-1]=='+'){\n\t\t\t\ttwo+=s[i]-'0';\n\t\t\t}else{\n\t\t\t\ttwo*=s[i]-'0';\n\t\t\t}\n\t\t}\n\t}\n\n\t//cerr<<ans<<' '<<one<<' '<<two<<endl;\n\n\tcout<<output(ans==one,ans==two)<<endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n\nusing namespace std;\nbool isM(int n,string s)\n{\n\tvector<bool> used(s.length());\n\tfor (int i = 0; i < s.length(); i++)\n\t{\n\t\tused[i] = false;\n\t}\n\tbool flag = false;\n\tint sum = 0;\n\tfor (int i = 1; i < s.length(); i+= 2)\n\t{\n\t\tif (s[i] == '*')\n\t\t{\n\t\t\tif (used[i - 1])\n\t\t\t{\n\t\t\t\tsum *= (s[i + 1] - '0');\n\t\t\t\tused[i + 1] = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (!flag)\n\t\t\t\t{\n\t\t\t\t\tsum = (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t\t\tflag = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tsum *= (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t\t}\n\t\t\t\tused[i - 1] = true;\n\t\t\t\tused[i + 1] = true;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 0; i < s.length(); i += 2)\n\t{\n\t\tif (used[i])continue;\n\t\tsum += (s[i] - '0');\n\t}\n\tif (n == sum)return true;\n\telse return false;\n}\n\nbool isL(int n,string s)\n{\n\tif (s.length() == 1 && s[0] - '0' == n)return true;\n\tint sum = 0;\n\tfor (int i = 1; i < s.length(); i += 2)\n\t{\n\t\tif (i == 1)\n\t\t{\n\t\t\tif (s[i] == '+')\n\t\t\t{\n\t\t\t\tsum = s[i - 1] - '0' + (s[i + 1] - '0');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsum = (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (s[i] == '+')\n\t\t\t{\n\t\t\t\tsum += (s[i + 1] - '0');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsum *= (s[i + 1] - '0');\n\t\t\t}\n\t\t}\n\t}\n\n\tif (sum == n)return true;\n\telse return false;\n}\n\nint main()\n{\n\tstring exp;\n\tint n;\n\tcin >> exp;\n\tcin >> n;\n\tif (isM(n, exp) && isL(n, exp))\n\t{\n\t\tcout << \"U\" << endl;\n\t}\n\telse if (isM(n,exp))\n\t{\n\t\tcout << \"M\" << endl;\n\t}\n\telse if (isL(n, exp))\n\t{\n\t\tcout << \"L\" << endl;\n\t}\n\telse\n\t{\n\t\tcout << \"I\" << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\n\n\ntemplate <class X> class Solve{\npublic:\n\tstring s;\n\tint p;\n\tSolve(string s_){\n\t\ts = s_;\n\t\ts += \"~\";\n\t\tp = 0;\n\t}\n\tX one(){\n\t\tX r = num();\n\t\twhile( s[p] == '+' || s[p] == '*' ){\n\t\t\tchar c = s[p];\n\t\t\tp++;\n\t\t\tX l = num();\n\t\t\tif( c == '*' ){\n\t\t\t\tr *= l;\n\t\t\t}else{\n\t\t\t\tr += l;\n\t\t\t}\n\t\t}\n\t\treturn r;\n\t}\n\tX num(){\n\t\tX ans = 0;\n\t\twhile( s[p] >= '0' && s[p] <= '9'){\n\t\t\tans = ans * 10 + s[p] - '0';\n\t\t\tp++;\n\t\t}\n\t\treturn ans;\n\t}\n\n\tX two(){\n\t\tX r = three();\n\t\twhile( s[p] == '+' ){\n\t\t\tchar c = s[p];\n\t\t\tp++;\n\t\t\tX l = three();\n\t\t\tr += l;\n\t\t}\n\t\treturn r;\n\t}\n\n\tX three(){\n\t\tX r = num();\n\t\twhile( s[p] == '*' ){\n\t\t\tchar c = s[p];\n\t\t\tp++;\n\t\t\tX l = num();\n\t\t\tr *= l;\n\t\t}\n\t\treturn r;\n\t}\n};\n\nsigned main(){\n\tstring s;\n\tint n;\n\tcin >> s >> n;\n\tint b = 0;\n\tif( fabs(Solve<double>(s).one()-n) < 1e5 ){\n\t\tif( Solve<int>(s).one()-n == 0 ){\n\t\t\tb += 1;\n\t\t}\n\t}\n\tif( fabs(Solve<double>(s).two()-n) < 1e5 ){\n\t\tif( Solve<int>(s).two()-n == 0 ){\n\t\t\tb += 2;\n\t\t}\n\t}\n\tstring table = \"ILMU\";\n\tcout << table[b] << endl;\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  string str;\n  cin>>str;\n  int bob;\n  cin>>bob;\nint ans=str[0]-'0';\n int f;\n\n  for(int i=1;i<str.size();i++){\n    if(str[i]=='+')f=1;\n    else if(str[i]=='*')f=2;\n    if(str[i]>='0' && str[i]<='9'){\n      if(f==1) ans+=(str[i]-'0');\n      else if(f==2)ans*=(str[i]-'0');\n    }\n  }\n  char ansf='I';\n   if(ans==bob)ansf='L';\n   cout<<ans<<endl;\n  ans=0;\n  for(int i=1;i<str.size();i++){\n    if(str[i]=='*'){\n      ans+=((str[i-1]-'0')*(str[i+1]-'0'));\n      str[i-1]='0',str[i+1]='0';\n      while(1){\n\ti++;\n\tif(i>str.size()) break;\n\tif(str[i]=='*')ans*=(str[i+1]-'0'),str[i+1]='0';\n\telse if(str[i]=='+') break;\n      }\n    }\n  }\n      for(int i=0;i<str.size();i++)\n\tif(str[i]>='0' && str[i]<='9')ans+=(str[i]-'0');\n   if(ans==bob && ansf=='L') ansf='U';\n  else if(ans==bob)ansf='M';\n  cout<<ansf<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nstring s;\n\nchar p[128]={};\nll f() {\n\tstack<char> st;\n\tstring r = \"\";\n\tfor(auto c: s)\n\t\tif(isdigit(c)) r += c;\n\t\telse {\n\t\t\twhile(st.size()&&p[st.top()]>=p[c]) {\n\t\t\t\tr += st.top(); st.pop();\n\t\t\t}\n\t\t\tst.push(c);\n\t\t}\n\twhile(st.size()) { r += st.top(); st.pop(); }\n\tstack<ll> a;\n\tfor(auto c: r)\n\t\tif(isdigit(c)) a.push(c-'0');\n\t\telse {\n\t\t\tll x = a.top(); a.pop();\n\t\t\tll y = a.top(); a.pop();\n\t\t\ta.push(c == '*' ? x * y : x + y);\n\t\t}\n\treturn a.top();\n}\n\nint main() {\n\tll ans;\n\tcin >> s >> ans;\n\tp['+']=1; p['*']=2; ll a1 = f();\n\tp['+']=1; p['*']=1; ll a2 = f();\n\tif(a1==ans&&a2==ans)puts(\"U\");\n\telse if(a1==ans) puts(\"M\");\n\telse puts(a2 == ans ? \"L\" : \"I\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nchar solve(string& expr, int ans) {\n    for (int i = 0; i < int(expr.size()); i += 2) expr[i] -= '0';\n    return \"ILMU\"[\n        ([&] {\n            int ans_ = expr[0];\n            for (int i = 1; i < int(expr.size()); i += 2) {\n                ans_ = expr[i] == '+' ? ans_ + expr[i + 1]: ans_ * expr[i + 1];\n            }\n            return ans == ans_;\n        }() << 0) |\n        ([&] {\n            stack<int> s; s.push(expr[0]);\n            for (int i = 1; i < int(expr.size()); i += 2) {\n                if (expr[i] == '+') s.push(expr[i + 1]);\n                else {\n                    int e = s.top() * expr[i + 1];\n                    s.pop(); s.push(e);\n                }\n            }\n            int ans_ = 0;\n            for (; !s.empty(); s.pop()) ans_ += s.top();\n            return ans == ans_;\n        }() << 1)];\n}\n\nint main() {\n    string expr; int ans;\n    cin >> expr >> ans;\n    cout << solve(expr, ans) << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <numeric>\n#include <bitset>\n#include <cmath>\n\nstatic const int MOD = 1000000007;\nusing ll = long long;\nusing u32 = uint32_t;\nusing namespace std;\n\ntemplate<class T> constexpr T INF = ::numeric_limits<T>::max() / 32 * 15 + 208;\n\nusing State = string::const_iterator;\n\nint digit(State &s){\n    int ret = *s - '0';\n    s++;\n    return ret;\n}\n\nint term(State &s){\n    int ans = digit(s);\n    while(true){\n        if(*s == '*'){\n            s++;\n            ans *= digit(s);\n        }else break;\n    }\n    return ans;\n}\n\nint expr(State &s){\n    int ans = term(s);\n    while(true){\n        if(*s == '+'){\n            s++;\n            ans += term(s);\n        }else break;\n    }\n    return ans;\n}\n\nint expr2(State &s){\n    int ans = digit(s);\n    while(true){\n        if(*s == '+'){\n            s++;\n            ans += digit(s);\n        }else if(*s == '*'){\n            s++;\n            ans *= digit(s);\n        } else break;\n    }\n    return ans;\n}\n\nint main() {\n    string s;\n    cin >> s;\n    int x = 0;\n    cin >> x;\n    State p = s.begin();\n    int a = expr(p);\n    p = s.begin();\n    int b = expr2(p);\n    string ans = \"IMLU\";\n    cout << ans[(a==x)+(b==x)*2] << \"\\n\";\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <stack>\nusing namespace std;\n\nint main(){\n    string s;\n    cin>>s;\n    int num;\n    cin>>num;\n    int l2r=s[0]-'0';\n    for(int i=1;i<s.size();i+=2){\n        if(s[i]=='*'){\n            l2r*=s[i+1]-'0';\n        }else{\n            l2r+=s[i+1]-'0';\n        }\n    }\n    stack<int> S;\n    S.push(s[0]-'0');\n    for(int i=1;i<s.size();i+=2){\n        if(s[i]=='*'){\n            S.top()*=s[i+1]-'0';\n        }else{\n            S.push(s[i+1]-'0');\n        }\n    }\n    int mf = 0;\n    while(!S.empty()){\n        mf+=S.top();\n        S.pop();\n    }\n    bool L = num==l2r;\n    bool M = num==mf;\n    char ans;\n    if(L&&M){\n        ans = 'U';\n    }else if(L){\n        ans = 'L';\n    }else if(M){\n        ans = 'M';\n    }else{\n        ans = 'I';\n    }\n    cout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long lli;\n\nstring s;\nlli x, p;\n\nnamespace NS1 {\n  lli exp();\n  lli term();\n  lli fact();\n\n  lli exp() {\n    lli x = term();\n    while(s[p] == '+') {\n      ++p;\n      x += term();\n    }\n    return x;\n  }\n\n  lli term() {\n    lli x = fact();\n    while(s[p] == '*') {\n      ++p;\n      x *= fact();\n    }\n    return x;\n  }\n\n  lli fact() {\n    return s[p++] - '0';\n  }\n}\n\nnamespace NS2 {\n  lli exp();\n  lli fact();\n\n  lli exp() {\n    lli x = fact();\n    while(s[p] == '+' || s[p] == '*') {\n      if(s[p] == '+') {\n        ++p;\n        x += fact();\n      } else {\n        ++p;\n        x *= fact();\n      }\n    }\n    return x;\n  }\n\n  lli fact() {\n    return s[p++] - '0';\n  }\n}\n\nint main() {\n  cin >> s;\n  cin >> x;\n  s += \"$\";\n  p = 0;\n  lli A = NS1::exp();\n  p = 0;\n  lli B = NS2::exp();\n  if(A == x && B == x)\n    cout << \"U\" << endl;\n  else if(A == x && B != x)\n    cout << \"M\" << endl;\n  else if(A != x && B == x)\n    cout << \"L\" << endl;\n  else\n    cout << \"I\" << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\n#include<cstdlib>\n#include<map>\n#include<queue>\n#include <deque>\n#include <list>\n#include <ctime>\n#include <stack>\n#include <vector>\n#include<set>\n#define MAX 1005\ntypedef long long ll;\nconst int inf = 0x3f3f3f3f;\nusing namespace std;\n\nchar s[22];\nstack<int> a ;\n\nint main()\n{\n    while(~scanf(\"%s\",s))\n    {\n        int num ;\n        scanf(\"%d\",&num);\n        int len=strlen(s);\n        int l=s[0]-'0';\n        for(int i=1;i<len;i++)\n        {\n            if(i%2==1)\n            {\n                if(s[i]=='+')\n                    l=l+s[i+1]-'0';\n                else\n                    l=l*(s[i+1]-'0');\n            }\n        }\n        while(!a.empty()) a.pop();\n        int m=1;\n        for(int i=0;i<len;i++)\n        {\n            if(i%2==1)\n            {\n                if(s[i]=='*')\n                {\n                   // cout<<m<<endl ;\n                    m=a.top();\n                    m=m*(s[i+1]-'0');\n                    a.pop();\n                    a.push(m);\n                    i++;\n                }\n            }\n            else\n            {\n               // cout<<s[i]-'0'<<endl;\n                a.push(s[i]-'0');\n            }\n        }\n        m=0;\n        while(!a.empty())\n        {\n            m+=a.top();\n            a.pop();\n        }\n        //cout<<m<<\"  \"<<l<<endl ;\n        if(num==l&&num!=m) printf(\"L\\n\");\n        else if(num==m&&num!=l)  printf(\"M\\n\");\n        else if(num==m&&num==l)  printf(\"U\\n\");\n        else printf(\"I\\n\");\n    }\n    return 0 ;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <map>\n#include <vector>\n\nusing namespace std;\n\nstring s;\nint p;\nint T;\n\nint number()\n{\n\tint res = s[p] - '0';\n\tp++;\n\treturn res;\n}\n\nint formula()\n{\n\tint res = number();\n\tfor (;;) {\n\t\tif (s[p] == '*') {\n\t\t\tp++;\n\t\t\tres *= number();\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\nint expr()\n{\n\tint res = formula();\n\tfor (;;) {\n\t\tif (s[p] == '+') {\n\t\t\tp++;\n\t\t\tres += formula();\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\nint expr2()\n{\n\tint res = number();\n\tfor (;;) {\n\t\tif (s[p] == '+') {\n\t\t\tp++;\n\t\t\tres += number();\n\t\t}\n\t\telse if (s[p] == '*') {\n\t\t\tp++;\n\t\t\tres *= number();\n\t\t}\n\t\telse {\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\nint main()\n{\n\tcin >> s >> T;\n\n\tbool l1, l2;\n\tp = 0;\n\tl1 = expr() == T;\n\tp = 0;\n\tl2 = expr2() == T;\n\n\tif (l1 && l2) cout << \"U\" << endl;\n\tif (l1 && !l2) cout << \"M\" << endl;\n\tif (!l1 && l2) cout << \"L\" << endl;\n\tif (!l1 && !l2) cout << \"I\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) begin(a),end(a)\ntypedef pair<int, int> P;\ntypedef long long ll;\ntypedef vector<int> vi;\n#define D10  fixed<<setprecision(10)\n\n\n\nint main()\n{\n\tstring s; int n;\n\tcin >> s >> n;\n\tll t = s[0] - '0';\n\tbool m = false; bool l = false;\n\tREP(i, s.size())\n\t{\n\t\tif (s[i] == '+') t += s[i + 1] - '0';\n\t\tif (s[i] == '*') t *= s[i + 1] - '0';\n\t}\n\tif (t == n) m = true;\n\tbool update = true;\n\twhile (update)\n\t{\n\t\tupdate = false;\n\t\tREP(i, s.size())\n\t\t{\n\t\t\tif (s[i] == '*')\n\t\t\t{\n\t\t\t\tupdate = true;\n\t\t\t\ts[i - 1] = (s[i + 1] - '0')*(s[i - 1] - '0');\n\t\t\t\ts[i - 1] += '0';\n\t\t\t\ts.erase(i,2);\n\t\t\t}\n\t\t}\n\t}\n\tt = 0;\n\tREP(i, s.size())\n\t{\n\t\tif (s[i] != '+') t += s[i] - '0';\n\t}\n\tif (t == n) l = true;\n\tif (m&&l) puts(\"U\");\n\telse if (m) puts(\"L\");\n\telse if (l) puts(\"M\");\n\telse puts(\"I\");\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define syosu(x) fixed<<setprecision(x)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\ntypedef pair<int,int> P;\ntypedef pair<double,double> pdd;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<string> vs;\ntypedef vector<P> vp;\ntypedef vector<vp> vvp;\ntypedef vector<pll> vpll;\ntypedef pair<int,P> pip;\ntypedef vector<pip> vip;\nconst int inf=1<<30;\nconst ll INF=1ll<<60;\nconst double pi=acos(-1);\nconst double eps=1e-11;\nconst ll mod=1e9+7;\nconst int dx[4]={-1,0,1,0},dy[4]={0,-1,0,1};\n\nconst int n=10;\nint a[n][n];\n\nbool f(string s){\n\tint x=0;\n\tfor(int i=0;i<5;i++) x=a[x][s[i]-'0'];\n\treturn x==0;\n}\n\nint main(){\n\tios::sync_with_stdio(0);\n\tcin.tie(0);\n\twhile(1){\n\t\tstring s;\n\t\tint x;\n\t\tcin>>s>>x;\n\t\tint n=s.size(),t=s[0]-'0';\n\t\tfor(int i=1;i<n;i+=2){\n\t\t\tif(s[i]=='+') t+=s[i+1]-'0';\n\t\t\telse t*=s[i+1]-'0';\n\t\t}\n\t\tbool b1=0,b2=0;\n\t\tif(x==t) b1=1;\n\t\tt=0;\n\t\ts+='+';\n\t\tint tmp=1;\n\t\tfor(int i=0;i<=n;i+=2){\n\t\t\tif(s[i+1]=='+'){\n\t\t\t\ttmp*=s[i]-'0';\n\t\t\t\tt+=tmp;\n\t\t\t\ttmp=1;\n\t\t\t}\n\t\t\telse{\n\t\t\t\ttmp*=s[i]-'0';\n\t\t\t}\n\t\t}\n\t\tif(x==t) b2=1;\n\t\tif(b1&&b2) cout<<'U'<<endl;\n\t\tif(b1&&!b2) cout<<'L'<<endl;\n\t\tif(!b1&&b2) cout<<'M'<<endl;\n\t\tif(!b1&&!b2) cout<<'I'<<endl;\n\t\tbreak;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <deque>\n#include <list>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <utility>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <complex>\n#include <cmath>\n#include <limits>\n#include <cfloat>\n#include <climits>\n#include <ctime>\n#include <cassert>\nusing namespace std;\n\n#define rep(i,a,n) for(int (i)=(a); (i)<(n); (i)++)\n#define repq(i,a,n) for(int (i)=(a); (i)<=(n); (i)++)\n#define repr(i,a,n) for(int (i)=(a); (i)>=(n); (i)--)\n#define all(v) begin(v), end(v)\n#define pb(a) push_back(a)\n#define fr first\n#define sc second\n#define INF 2000000000\n#define int long long int\n\n#define X real()\n#define Y imag()\n#define EPS (1e-10)\n#define EQ(a,b) (abs((a) - (b)) < EPS)\n#define EQV(a,b) ( EQ((a).X, (b).X) && EQ((a).Y, (b).Y) )\n#define LE(n, m) ((n) < (m) + EPS)\n#define LEQ(n, m) ((n) <= (m) + EPS)\n#define GE(n, m) ((n) + EPS > (m))\n#define GEQ(n, m) ((n) + EPS >= (m))\n\ntypedef vector<int> VI;\ntypedef vector<VI> MAT;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\ntypedef complex<double> P;\ntypedef pair<P, P> L;\ntypedef pair<P, double> C;\n\nint dx[]={1, -1, 0, 0};\nint dy[]={0, 0, 1, -1};\nint const MOD = 1000000007;\nll mod_pow(ll x, ll n) {return (!n)?1:(mod_pow((x*x)%MOD,n/2)*((n&1)?x:1))%MOD;}\nint madd(int a, int b) {return (a + b) % MOD;}\nint msub(int a, int b) {return (a - b + MOD) % MOD;}\nint mmul(int a, int b) {return (a * b) % MOD;}\nint minv(int a) {return mod_pow(a, MOD-2);}\nint mdiv(int a, int b) {return mmul(a, minv(b));}\n\nnamespace std {\n    bool operator<(const P& a, const P& b) {\n        return a.X != b.X ? a.X < b.X : a.Y < b.Y;\n    }\n}\n\n// split??¢??° (1?????????????????§?????????????????????????????§??????????????????)\nvector<string> split(string s, char c) {\n    vector<string> ret;\n    string temp;\n    replace(s.begin(), s.end(), c, ' ');\n    stringstream ss(s);\n    while(ss >> temp) ret.pb(temp);\n    return ret;\n}\n\nstring s;\nint res;\nsigned main() {\n    cin >> s >> res;\n    int a = 0, b = 0;\n    // multiplication-first rule\n    vector<string> cls = split(s, '+');\n    rep(i,0,cls.size()) {\n        int temp = 1;\n        rep(j,0,cls[i].length()) {\n            if(cls[i][j] != '*') temp *= (cls[i][j] - '0');\n        }\n        a += temp;\n    }\n\n    // left-to-right rule\n    rep(i,0,s.length()) {\n        if(i == 0) b += (s[i] - '0');\n        else if(s[i] == '+') b += (s[i+1] - '0');\n        else if(s[i] == '*') b *= (s[i+1] - '0');\n    }\n\n    if(res == a && res == b) cout << \"U\" << endl;\n    if(res != a && res == b) cout << \"L\" << endl;\n    if(res == a && res != b) cout << \"M\" << endl;\n    if(res != a && res != b) cout << \"I\" << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>  \nusing namespace std;\nconst int INF = 999;\n//世界一競技プログラミングができない人のソース2\n\nint get_number(string str, int& idx){\n  int old = idx;\n  while(isdigit(str[idx])) ++idx;\n  return atoi(str.substr(old, idx - old).c_str());\n}\n\nint Expression(string str, int& idx){\n  int ret = get_number(str, idx);\n  while(true){\n    switch(str[idx]){\n    case '*':\n      ret *= get_number( str, ++idx);\n      break;\n    default:\n      return ret;\n    }\n  }\n}\n\nint nomal(string str, int idx = 0){\n  int res = Expression(str, idx);\n  while(true){\n    switch(str[idx]){\n    case '+':\n      ++idx;\n      res += Expression(str, idx);\n      break;\n    default:\n      return res;\n    }\n  }\n}\nint special(string str, int idx = 0){\n  int ret = get_number(str, idx);\n  while(str.size() > idx){\n    if(str[idx] == '+') ret += get_number(str, ++idx);\n    if(str[idx] == '*') ret *= get_number(str, ++idx);\n    else break;\n  }\n  return ret;\n}\n\nint main(){\n  string str;\n  cin >> str;\n  str += \"~\";\n  int digit;\n  cin >> digit;\n\n  bool judge_a = nomal(str) == digit;\n  bool judge_b = special(str) == digit;\n  if(judge_a & judge_b){\n    cout << \"U\" << endl;\n  } else if( judge_a){\n    cout << \"M\" << endl;\n  } else if( judge_b){\n    cout << \"L\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<stack>\n\nusing namespace std;\n\ntypedef long long ll;\n\nclass MultiFirst{\n    public: \n\n    string s;\n    size_t i;\n    MultiFirst(string s): s(s){}\n    ll parse(){\n        i = 0;\n        return expr(&i);\n    }\n\n    private:\n\n    ll num(size_t *i){\n        return stoll(s.substr(*i, 1));\n    }\n\n    ll term(size_t *i){\n        ll ret = num(i); (*i)++;\n        while(*i < s.length() && s[*i] == '*'){\n            (*i)++; // *\n            ret *= num(i);\n            (*i)++;\n        }\n        return ret;\n    }\n\n    ll expr(size_t *i){\n        ll ret = term(i);\n        while(*i < s.length() && s[*i] == '+'){\n            (*i)++; // +\n            ret += term(i);\n        }\n        return ret;\n    }\n};\n\nclass LeftToRight{\n    public: \n\n    string s;\n    size_t i;\n    LeftToRight(string s): s(s){}\n    ll parse(){\n        stack<int> st;\n        st.push(s[0]-'0');\n        for(size_t i=1;i<s.length();i++){\n            if(st.top() < 0){\n                if('0' <= s[i] && s[i] <= '9'){\n                    int op = st.top(); st.pop();\n                    int a = st.top(); st.pop();\n                    int b = s[i] - '0';\n                    if(op == -1){\n                        st.push(a+b);\n                    }else{\n                        st.push(a*b);\n                    }\n                }\n            }else{\n                if('0' <= s[i] && s[i] <= '9'){\n                    st.push(s[i]-'0');\n                }else if(s[i] == '+'){\n                    st.push(-1);\n                }else{\n                    st.push(-2);\n                }\n            }\n        }\n        return st.top();\n    }\n};\n\nint main(){\n    string s;\n    ll bob;\n    cin >> s >> bob;\n\n    ll m = MultiFirst(s).parse();\n    ll l = LeftToRight(s).parse();\n\n    if(bob == m){\n        if(bob == l){\n            cout << 'U' << endl;\n        }else{\n            cout << 'M' << endl;\n        }\n    }else{\n        if(bob == l){\n            cout << 'L' << endl;\n        }else{\n            cout << 'I' << endl;\n        }\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <utility>\n\nusing namespace std;\ntypedef pair<int, int> pii;\n\npii lex_expr(const char *s, int p);\npii lex_term(const char *s, int p);\n\npii lex_expr(const char *s, int p){\n\tpii r = lex_term(s, p);\n\tp = r.second;\n\twhile(s[p] == '+'){\n\t\tconst pii q = lex_term(s, p + 1);\n\t\tr.first += q.first;\n\t\tr.second = p = q.second;\n\t}\n\treturn r;\n}\npii lex_term(const char *s, int p){\n\tpii r(s[p] - '0', p + 1);\n\t++p;\n\twhile(s[p] == '*'){\n\t\tr.first *= s[p + 1] - '0';\n\t\tr.second = p = p + 2;\n\t}\n\treturn r;\n}\n\nint solve(const char *s){\n\tint p = 1, result = s[0] - '0';\n\twhile(s[p] != '\\0'){\n\t\tif(s[p] == '+'){\n\t\t\tresult += s[p + 1] - '0';\n\t\t}else{\n\t\t\tresult *= s[p + 1] - '0';\n\t\t}\n\t\tp += 2;\n\t}\n\treturn result;\n}\n\nint main(){\n\tios_base::sync_with_stdio(false);\n\tstring s;\n\tint n;\n\tcin >> s >> n;\n\tconst char table[] = \"IMLU\";\n\tint answer = 0;\n\tif(lex_expr(s.c_str(), 0).first == n){ answer |= 1; }\n\tif(solve(s.c_str()) == n){ answer |= 2; }\n\tcout << table[answer] << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing pii = pair<int,int>;\nusing ll = long long;\n#define rep(i, j) for(int i=0; i < (int)(j); i++)\n#define repeat(i, j, k) for(int i = (j); i < (int)(k); i++)\n#define all(v) v.begin(),v.end()\n#define debug(x) cerr << #x << \" : \" << x << endl\n\ntemplate<class T> bool set_min(T &a, const T &b) { return a > b  ? a = b, true : false; }\ntemplate<class T> bool set_max(T &a, const T &b) { return a < b  ? a = b, true : false; }\n// vector\ntemplate<class T> istream&\noperator >> (istream &is , vector<T> &v) { for(T &a : v) is >> a; return is; }\ntemplate<class T> ostream&\noperator << (ostream &os , const vector<T> &v) { for(const T &t : v) os << \"\\t\" << t; return os << endl; }\n// pair\ntemplate<class T, class U> ostream&\noperator << (ostream &os , const pair<T, U> &v) { return os << \"<\" << v.first << \", \" << v.second << \">\"; }\n\nconst int INF = 1 << 30;\nconst ll INFL = 1LL << 60;\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    string S; cin >> S;\n    int M; cin >> M;\n\n    int a = S[0] - '0';\n    vector<int> bs = {S[0] - '0'};\n    for(int i = 2; i < S.size(); i += 2) {\n        int si = S[i] - '0';\n        if(S[i - 1] == '+') {\n            a = a + si;\n            bs.push_back(si);\n        } else if(S[i- 1] == '*') {\n            a = a * si;\n            bs.back() = bs.back() * si;\n        } else assert(0);\n    }\n    int b = 0;\n    for(int i : bs) b += i;\n    if(a == M and b == M) cout << \"U\" << endl;\n    else if(a == M) cout << \"L\" << endl;\n    else if(b == M) cout << \"M\" << endl;\n    else cout << \"I\" << endl;    \n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint func1(string line) {\n    int res=0;\n    rep(i,line.size()) {\n        if(i==0) res=line[0]-'0';\n        else if(i%2==1) {\n            if(line[i]=='+') {\n                res+=line[i+1]-'0';\n            }\n            else {\n                res*=line[i+1]-'0';\n            }\n            i++;\n        }\n    }\n    return res;\n}\ntemplate<class T>\nstring to_s(T x) {\n    stringstream ss;\n    ss<<x;\n    return ss.str();\n}\nint to_i(string s) {\n    int res;\n    stringstream ss;\n    ss<<s;\n    ss>>res;\n    return res;\n}\nint func2(string line) {\n    vector<string> vec;\n    set<int> S;\n    bool f[20]={};\n    rep(i,line.size()) {\n        if(line[i]=='*') {\n            f[i-1]=1;\n            f[i]=1;\n            f[i+1]=1;\n        }\n    }\n    int x=1,idx=0;\n    while(idx<20) {\n        while(!f[idx]&&idx!=20) idx++;\n        if(idx==20) break;\n        while(f[idx]) {\n            if(isdigit(line[idx])) {\n                x*=(line[idx]-'0');\n                S.insert(idx);\n            }\n            idx++;\n        }\n        vec.pb(to_s(x));\n        x=1;\n    }\n\n    rep(i,line.size()) {\n        if(!S.count(i)) {\n            if(line[i]!='+'&&line[i]!='*') vec.pb(to_s(line[i]));\n        }\n    }\n    int res=0;\n    rep(i,vec.size()) res+=to_i(vec[i]);\n    return res;\n}\nstring line;\nint x;\nint main() {\n    cin>>line;\n    cin>>x;\n    int x1=func1(line);\n    int x2=func2(line);\n\n    if(x==x1&&x==x2) {\n        cout<<\"U\"<<endl;\n    }\n    else if(x==x1) {\n        cout<<\"L\"<<endl;\n    }\n    else if(x==x2) {\n        cout<<\"M\"<<endl;\n    }\n    else {\n        cout<<\"I\"<<endl;\n    }\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n#define int long long\n#define stoi stoll\nusing namespace std;\n\nsigned main() {\n\tstring a; cin >> a;\n\tint b; cin >> b;\n\tvector<string>c;\n\tstring e;\n\tfor (char d : a) {\n\t\tif (d == '+' || d == '*') { c.push_back(e); e = \"\"; e += d; c.push_back(e); e = \"\"; }\n\t\telse e += d;\n\t}\n\tc.push_back(e);\n\tvector<string>x, y; x = y = c;\n\tint sum = stoi(x[0]);\n\tfor (int i = 1; i<x.size(); i += 2) {\n\t\tif (x[i] == \"+\")sum += stoi(x[i + 1]);\n\t\telse sum *= stoi(x[i + 1]);\n\t}\n\ty.push_back(\"+\");\n\tint S = 0;\n\tint J = 1;\n\tfor (string t : y) {\n\t\tif (t == \"+\") { S += J; J = 1; }\n\t\telse if (t != \"*\")J *= stoi(t);\n\t}\n\tif (S == b) {\n\t\tif (sum == b) {\n\t\t\tputs(\"U\");\n\t\t}\n\t\telse {\n\t\t\tputs(\"M\");\n\t\t}\n\t}\n\telse {\n\t\tif (sum == b) {\n\t\t\tputs(\"L\");\n\t\t}\n\t\telse {\n\t\t\tputs(\"I\");\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits//stdc++.h\"\nusing namespace std;\ntypedef long long ll;\n#define ALL(v) (v).begin(),(v).end()\nconst ll INF = 1LL << 60;\nconst ll MOD = 1e9 + 7;\nint expression(string &exp, int &pos);\nint term(string &exp, int &pos);\nint factor(string &exp, int &pos);\nint expression(string &exp, int &pos) {\n\tint ret = term(exp, pos);\n\twhile (pos < exp.size() && exp[pos] == '+') {\n\t\tpos++;\n\t\t(ret += term(exp, pos));\n\t}\n\treturn ret;\n}\nint term(string &exp, int &pos) {\n\tint ret = factor(exp, pos);\n\twhile (pos < exp.size() && exp[pos] == '*') {\n\t\tpos++;\n\t\t(ret *= term(exp, pos));\n\t}\n\treturn ret;\n}\nint factor(string &exp, int &pos) {\n\tint num = exp[pos] - '0';\n\tpos++;\n\treturn num;\n}\nint main() {\n\tstring exp;\n\tcin >> exp;\n\tint bobs_ans;\n\tcin >> bobs_ans;\n\tint pos = 0;\n\tint true_ans = expression(exp, pos);\n\tint false_ans = exp[0] - '0';\n\tfor (int i = 1; i < exp.size(); i += 2) {\n\t\tif (exp[i] == '+') {\n\t\t\tfalse_ans += exp[i + 1] - '0';\n\t\t}\n\t\telse {\n\t\t\tfalse_ans *= exp[i + 1] - '0';\n\t\t}\n\t}\n\tif (bobs_ans == true_ans && bobs_ans == false_ans) {\n\t\tcout << \"U\" << endl;\n\t}\n\telse if (bobs_ans == true_ans) {\n\t\tcout << \"M\" << endl;\n\t}\n\telse if (bobs_ans == false_ans) {\n\t\tcout << \"L\" << endl;\n\t}\n\telse {\n\t\tcout << \"I\" << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define mp make_pair\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef pair<int,pii> pip;\ntypedef vector<pip>vip;\nconst double PI=acos(-1);\nconst double EPS=1e-8;\nconst int inf=1e8;\nstring s;\nint solve1(){\n\tint a=0;\n\trep(i,s.size()){\n\t\tint t=s[i]-'0';\n\t\twhile(!(i==s.size()-1||s[i+1]=='+')){\n\t\t\ti+=2;\n\t\t\tt*=s[i]-'0';\n\t\t}\n\t\ti++;\n\t\ta+=t;\n\t}\n\treturn a;\n}\nint solve2(){\n\tint a=s[0]-'0';\n\tloop(i,1,s.size()){\n\t\tif(s[i++]=='+')a+=s[i]-'0';\n\t\telse a*=s[i]-'0';\n\t}\n\treturn a;\n}\nint main(){\n\tint a;\n\tcin>>s>>a;\n\tbool h1=false,h2=false;\n\tif(solve1()==a)h1=true;\n\tif(solve2()==a)h2=true;\n\tif(h1+h2==2)cout<<\"U\"<<endl;\n\telse if(h1)cout<<\"M\"<<endl;\n\telse if(h2)cout<<\"L\"<<endl;\n\telse cout<<\"I\"<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <string>\n#include <sstream>\n#include <stack>\n#include <algorithm>\n#include <cmath>\n#include <queue>\n#include <map>\n#include <set>\n#include <cstdlib>\n#include <bitset>\n#include <tuple>\n#include <assert.h>\n#include <deque>\n#include <bitset>\n#include <iomanip>\n#include <limits>\n#include <chrono>\n#include <random>\n#include <array>\n#include <unordered_map>\n#include <functional>\n#include <complex>\n#include <numeric>\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\n\nconstexpr long long MAX = 5100000;\nconstexpr long long INF = 1LL << 60;\nconstexpr int inf = 1 << 28;\n//constexpr long long mod = 1000000007LL;\n//constexpr long long mod = 998244353LL;\n\nusing namespace std;\ntypedef unsigned long long ull;\ntypedef long long ll;\n\nint main()\n{\n\t/*\n\tcin.tie(nullptr);\n\tios::sync_with_stdio(false);\n\t*/\n\tstring s; cin >> s;\n\tll kkt; cin >> kkt;\n\tll left = s[0] - '0';\n\tll ac = 0;\n\tfor (int i = 2; i < s.size(); i += 2) {\n\t\tif (s[i - 1] == '+') {\n\t\t\tleft += s[i] - '0';\n\t\t}\n\t\telse {\n\t\t\tleft *= s[i] - '0';\n\t\t}\n\t}\n\tstack<ll> st;\n\tst.push(s[0] - '0');\n\tfor (int i = 2; i < s.size(); i += 2) {\n\t\tif (s[i - 1] == '+') st.push(s[i] - '0');\n\t\telse {\n\t\t\tst.top() *= s[i] - '0';\n\t\t}\n\t}\n\twhile (!st.empty()) {\n\t\tac += st.top();\n\t\tst.pop();\n\t}\n\tif (left == kkt && ac == kkt) {\n\t\tputs(\"U\");\n\t}\n\telse if (left == kkt) {\n\t\tputs(\"L\");\n\t}\n\telse if (ac == kkt) {\n\t\tputs(\"M\");\n\t}else{\n\t\tputs(\"I\");\n\t}\n\treturn 0;\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define se second\n#define FOR(i, a, b) for(int i=(a);i<(b);i++)\n#define REP(i, n) FOR(i, 0, n)\n#define RFOR(i, a, b) for(int i=(a);i>=(b);i--)\n#define RREP(i, n) RFOR(i, n, 0)\n#define MFOR(i, m) for(auto i=(m).begin();i!=(m).end();i++)\n#define ALL(a) (a).begin(), (a).end()\n#define SZ(x) ((int)(x).size())\n\ntypedef long long int ll;\ntypedef pair<int, int> P;\ntypedef pair<ll, ll> Pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vll;\ntypedef vector<vll> vvll;\n\nconst double eps = 1e-10;\nconst int MOD = 1000000007;\nconst int INF = 1000000000;\nconst ll LINF = 1 << 30;\n\ntemplate<typename T>\nvoid printv(vector<T> const& s) {\n  REP(i, SZ(s)) {\n    cout << s[i] << \" \";\n  }\n  cout << endl;\n}\n\nbool m(string s, int result) {\n  vi v;\n  v.pb(s[0] - '0');\n  char op;\n  FOR(i, 1, SZ(s)) {\n    if(i%2) {\n      op = s[i];\n    } else {\n      if(op == '*') {\n        v[SZ(v)-1] *= s[i] - '0';\n      } else {\n        v.pb(s[i] - '0');\n      }\n    }\n  }\n  int res = 0;\n  REP(i, SZ(v)) {\n    res += v[i];\n  }\n\n  return res == result;\n}\n\nbool l(string s, int result) {\n  char op;\n  int res = s[0] - '0';\n  FOR(i, 1, SZ(s)) {\n    if(i % 2) {\n      op = s[i];\n    } else {\n      if(op == '+') {\n        res += s[i] - '0';\n      } else {\n        res *= s[i] - '0';\n      }\n    }\n  }\n  return res == result;\n}\n\nint main () {\n  cin.tie(0);\n  cout << setprecision(10);\n\n  string s; cin >> s;\n  int result; cin >> result;\n\n  bool M = m(s, result);\n  bool L = l(s, result);\n  if(M && L) {\n    cout << \"U\" << endl;\n  } else if(M) {\n    cout << \"M\" << endl;\n  } else if(L) {\n    cout << \"L\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\ntypedef long long LL;\n#define SORT(c) sort((c).begin(),(c).end())\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\nusing namespace std;\nint main(void)\n{\n  string s;\n  cin >> s;\n  int n;\n  cin >> n;\n  int answerl=s[0]-'0';\n  REP(i,s.size()/2)\n    if(s[i*2+1]=='+') answerl+=(s[i*2+2]-'0');\n    else answerl*=(s[i*2+2]-'0');\n  int answerm=0;\n  vector<int> adds;\n  adds.push_back(s[0]-'0');\n  REP(i,s.size()/2)\n    if(s[i*2+1]=='+') adds.push_back(s[i*2+2]-'0');\n    else adds[adds.size()-1]*=(s[i*2+2]-'0');\n  REP(i,adds.size()) answerm+=adds[i];\n  string ans=\"IMLU\";\n  int ansnum=0;\n  if(n==answerm) ansnum+=1;\n  if(n==answerl) ansnum+=2;\n  cout << ans[ansnum] << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstruct M{\n  string s;\n  string::iterator it;\n\n  void init(const string &str){\n    s = str;\n    it = s.begin();\n  }\n\n  int fact(){\n    int res = 0;\n    while(isdigit(*it)){\n      res *= 10;\n      res += *it-'0';\n      ++it;\n    }\n    return res;\n  }  \n\n  int exp(){\n    int res = term();\n    while(*it == '+'){\n      ++it;\n      res += term();\n\n    }\n    return res;\n  }\n\n  int term(){\n    int res = fact();\n    while(*it == '*'){\n      ++it;\n      res *= fact();\n    }\n    return res;\n  }\n};\n\nstruct L{\n  string s;\n  string::iterator it;\n\n  void init(const string &str){\n    s = str;\n    it = s.begin();\n  }\n\n  int fact(){\n    int res = 0;\n    while(isdigit(*it)){\n      res *= 10;\n      res += *it-'0';\n      ++it;\n    }\n    return res;\n  }  \n\n  int calc(){\n    int res = fact();\n    while(*it == '+' || *it == '*'){\n      if(*it == '+'){\n        ++it;\n        res += exp();\n      }else{\n        ++it;\n        res *= term();\n      }\n    }\n    return res;\n  }\n\n  int exp(){\n    int res = fact();\n    while(*it == '+'){\n      ++it;\n      res += fact();\n    }\n    return res;\n  }\n\n  int term(){\n    int res = fact();\n    while(*it == '*'){\n      ++it;\n      res *= fact();\n    }\n    return res;\n  }\n};\n\nint main(){\n  int ans;\n  string s;\n  cin >> s >> ans; \n  M m; m.init(s); \n  L l; l.init(s);\n  int Mres = m.exp(), Lres = l.calc();\n\n  if(Mres == ans && Lres != ans){\n    cout << 'M' << endl;\n  }else if(Mres != ans && Lres == ans){\n    cout << 'L' << endl;\n  }else if(Mres == ans && Lres == ans){\n    cout << 'U' << endl;\n  }else{\n    cout << 'I' << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <deque>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define ALL(v) (v).begin(), (v).end()\n#define LENGTHOF(x) (sizeof(x) / sizeof(*(x)))\n#define AFILL(a, b) fill((int*)a, (int*)(a + LENGTHOF(a)), b)\n#define SQ(x) ((x)*(x))\n#define Mod(x, mod) (((x)+(mod)%(mod))\n#define MP make_pair\n#define PB push_back\n#define Fi first\n#define Se second\n#define INF (1<<29)\n#define EPS 1e-10\n#define MOD 1000000007\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nll M(string s)\n{\n  int p=0;\n  stack<ll>st;\n  int multi = 0;  \n  for(int i=0;i<s.size();i++){\n    if(s[i] == '+'){\n      stringstream ss;\n      ss << s.substr(p, i-p);\n      ll x;\n      ss >> x;\n      if(multi){\n\tx *= st.top(); st.pop();\n\tmulti = 0;\n      }\n      st.push(x);\n      p = i+1;\n    }else if(s[i] == '*'){\n      stringstream ss;\n      ss << s.substr(p, i-p);\n      ll x;\n      ss >> x;\n      if(multi){\n\tll t = st.top(); st.pop();\n\tx *= t;\n\tmulti = 0;\n      }\n      st.push(x);\n      p = i+1;\n      multi = 1;      \n    }\n  }\n\n  stringstream ss; ss << s.substr(p);\n  ll x; ss >> x;\n  if(multi){\n    x *= st.top(); st.pop();\n    multi = 0;\n  }\n  st.push(x);\n  ll ret = 0;\n  while(!st.empty()){\n    ret += st.top();\n    st.pop();\n  }\n  return ret;\n}\n\nll L(string s)\n{\n  int p = 0, pe = 0;\n  int mflag = 0, pflag = 0;\n  ll ret = 0;\n  while(pe < s.size()){\n    if(s[pe] == '*'){\n      stringstream ss; ss << s.substr(p, pe-p);\n      ll x; ss >> x;\n      if(mflag){\n\tret *= x;\n\tmflag = 0;\n      }else if(pflag){\n\tret += x;\n\tpflag = 0;\n      }else{\n\tret = x;\n      }\n      mflag = 1;\n      p = pe+1;\n    }else if(s[pe] == '+'){\n      stringstream ss; ss << s.substr(p, pe-p);\n      ll x; ss >> x;\n      if(mflag){\n\tret *= x;\n\tmflag = 0;\n      }else if(pflag){\n\tret += x;\n\tpflag = 0;\n      }else{\n\tret = x;\n      }      \n      pflag = 1;\n      p = pe+1;\n    }\n    pe++;\n  }\n  stringstream ss; ss << s.substr(p);\n  ll x; ss >> x;\n  if(mflag){\n    ret *= x;\n    mflag = 0;\n  }else if(pflag){\n    ret += x;\n    pflag = 0;\n  }else{\n    ret = x;\n  }\n  \n  return ret;\n}\n\nint main()\n{\n  string s;\n  ll bob;  \n  cin >> s >> bob;\n  int Mflag = (M(s) == bob);\n\n  int Lflag = (L(s) == bob);\n  if(Mflag && Lflag) cout << 'U';\n  else if (!Mflag && !Lflag) cout << 'I';\n  else if(Mflag) cout << 'M';\n  else cout << 'L';\n  cout << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main(){\n\tstring str;\n\tint n;\n\tcin >> str >> n;\n\tchar x = 'x';\n\tint f = 0, s = 0;\n\tint num[10];\n\tbool used[10];\n\tchar ope[10];\n\tfor(int i = 0; i < str.size(); i++){\n\t\tif(i%2 == 0){\n\t\t\tnum[i/2] = str[i]-'0';\n\t\t} else{\n\t\t\tope[i/2] = str[i];\n\t\t}\n\t}\n\tint t = 0;\n\tfor(int i = 0; i < str.size()/2; i++){\n\t\tif(ope[i] == '*'){\n\t\t\tif(t == -1){\n\t\t\t\tt = num[i]*num[i+1];\n\t\t\t\tused[i] = true;\n\t\t\t\tused[i+1] = true;\n\t\t\t} else{\n\t\t\t\tt *= num[i+1];\n\t\t\t\tused[i+1] = true;\n\t\t\t}\n\t\t} else{\n\t\t\tif(t != -1) f += t;\n\t\t\tt = -1;\n\t\t}\n\t}\n\tfor(int i = 0; i < (str.size()+1)/2; i++){\n\t\tif(!used[i]) f += num[i];\n\t}\n\tfor(int i = 0; i < str.size(); i++){\n\t\tif(i%2 == 0){\n\t\t\tif(x == 'x') s = str[i]-'0';\n\t\t\tif(x == '+') s += str[i]-'0';\n\t\t\tif(x == '*') s *= str[i]-'0';\n\t\t} else{\n\t\t\tx = str[i];\n\t\t}\n\t}\n\tif(s == n){\n\t\tif(f == n) cout << \"U\" << endl;\n\t\telse cout << \"L\" << endl;\n\t} else{\n\t\tif(f == n) cout << \"M\" << endl;\n\t\telse cout << \"I\" << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <cstdlib>\n#include <climits>\n#include <ctime>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <list>\n#include <vector>\n#include <set>\n#include <map>\n#include <iostream>\n#include <deque>\n#include <complex>\n#include <string>\n#include <iomanip>\n#include <sstream>\n#include <bitset>\n#include <valarray>\n#include <iterator>\nusing namespace std;\ntypedef long long int ll;\ntypedef unsigned int uint;\ntypedef unsigned char uchar;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef vector<int> vi;\n\n#define REP(i,x) for(int i=0;i<(int)(x);i++)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();i++)\n#define RREP(i,x) for(int i=((int)(x)-1);i>=0;i--)\n#define RFOR(i,c) for(__typeof((c).rbegin())i=(c).rbegin();i!=(c).rend();i++)\n#define ALL(container) container.begin(), container.end()\n#define RALL(container) container.rbegin(), container.rend()\n#define SZ(container) ((int)container.size())\n#define mp(a,b) make_pair(a, b)\n#define UNIQUE(v) v.erase( unique(v.begin(), v.end()), v.end() );\n\ntemplate<class T> bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T> bool chmin(T &a, const T &b) { if (a>b) { a=b; return 1; } return 0; }\ntemplate<class T> ostream& operator<<(ostream &os, const vector<T> &t) {\nos<<\"[\"; FOR(it,t) {if(it!=t.begin()) os<<\",\"; os<<*it;} os<<\"]\"; return os;\n}\ntemplate<class T> ostream& operator<<(ostream &os, const set<T> &t) {\nos<<\"{\"; FOR(it,t) {if(it!=t.begin()) os<<\",\"; os<<*it;} os<<\"}\"; return os;\n}\ntemplate<class S, class T> ostream& operator<<(ostream &os, const pair<S,T> &t) { return os<<\"(\"<<t.first<<\",\"<<t.second<<\")\";}\n\nconst int INF = 1<<28;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\n\n\nint n;\n\nint ltor(string s){\n\tint x=s[0]-'0';\n\tfor(int i=1;i<s.size();i+=2){\n\t\tif(s[i] == '*') x *= s[i+1]-'0';\n\t\tif(s[i] == '+') x += s[i+1]-'0';\n\t}\n\treturn x;\n}\nint mult(string s){\n\tstack<int> st;\n\tst.push(s[0]-'0');\n\tfor(int i=1;i<s.size();i+=2){\n\t\tif(s[i] == '*') st.top() *= s[i+1]-'0';\n\t\tif(s[i] == '+') st.push(s[i+1]-'0');\n\t}\n\tint ans = 0;\n\twhile(!st.empty()){\n\t\tans += st.top();\n\t\tst.pop();\n\t}\n\treturn ans;\n}\n\nmain(){\n\tios::sync_with_stdio(false);\n\tstring s;\n\tcin >> s >> n;\n\tint ans = (ltor(s) == n)*2 + (mult(s) == n);\n\tputs(ans == 3 ? \"U\" : ans == 2 ? \"L\" : ans == 1 ? \"M\" : \"I\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main(){\n\tstring str;\n\tint n;\n\tcin >> str >> n;\n\tchar x = 'x';\n\tint f = 0, s = 0;\n\tint num[10];\n\tbool used[10];\n\tfor(int i = 0; i < 10; i++) used[i] = false;\n\tchar ope[10];\n\tfor(int i = 0; i < str.size(); i++){\n\t\tif(i%2 == 0){\n\t\t\tnum[i/2] = str[i]-'0';\n\t\t} else{\n\t\t\tope[i/2] = str[i];\n\t\t}\n\t}\n\tint t = -1;\n\tfor(int i = 0; i < str.size()/2; i++){\n\t\tif(ope[i] == '*'){\n\t\t\tif(t == -1){\n\t\t\t\tt = num[i]*num[i+1];\n\t\t\t\tused[i] = true;\n\t\t\t\tused[i+1] = true;\n\t\t\t} else{\n\t\t\t\tt *= num[i+1];\n\t\t\t\tused[i+1] = true;\n\t\t\t}\n\t\t} else{\n\t\t\tif(t != -1) f += t;\n\t\t\tt = -1;\n\t\t}\n\t}\n\tfor(int i = 0; i < (str.size()+1)/2; i++){\n\t\tif(!used[i]) f += num[i];\n\t}\n\tfor(int i = 0; i < str.size(); i++){\n\t\tif(i%2 == 0){\n\t\t\tif(x == 'x') s = str[i]-'0';\n\t\t\tif(x == '+') s += str[i]-'0';\n\t\t\tif(x == '*') s *= str[i]-'0';\n\t\t} else{\n\t\t\tx = str[i];\n\t\t}\n\t}\n\tif(s == n){\n\t\tif(f == n) cout << \"U\" << endl;\n\t\telse cout << \"L\" << endl;\n\t} else{\n\t\tif(f == n) cout << \"M\" << endl;\n\t\telse cout << \"I\" << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nstring L, M, U;\nlong long a, b, c;\nchar T[11] = \"0123456789\";\n\nint main() {\n\tcin >> L >> a;\n\tfor (int i = 0; i < 10; i++)\n\t{\n\t\tif (L[0] == T[i])\n\t\t{\n\t\t\tb = i; c = i;\n\t\t}\n\t}\n\tif (L[1] == '*')\n\t{\n\t\tU += L[0];\n\t\tb = 0;\n\t}\n\tfor (int i = 1; i < L.size(); i += 2)\n\t{\n\t\tint d;\n\t\tfor (int j = 0; j < 10; j++)\n\t\t{\n\t\t\tif (L[i + 1] == T[j])\n\t\t\t{\n\t\t\t\td = j;\n\t\t\t}\n\t\t}\n\t\tif (L[i] == '+')\n\t\t{\n\t\t\tc += d;\n\t\t}\n\t\tif (L[i] == '*')\n\t\t{\n\t\t\tc *= d;\n\t\t}\n\t}\n\tfor (int i = 1; i < L.size(); i += 2)\n\t{\n\t\tint d, e;\n\t\tfor (int j = 0; j < 10; j++)\n\t\t{\n\t\t\tif (L[i + 1] == T[j])\n\t\t\t{\n\t\t\t\td = j;\n\t\t\t}\n\t\t}\n\t\tif (L[i] == '+')\n\t\t{\n\t\t\tif (U.size() >= 1)\n\t\t\t{\n\t\t\t\te = 1;\n\t\t\t\tfor (int j = 0; j < U.size(); j++)\n\t\t\t\t{\n\t\t\t\t\tfor (int k = 0; k < 10; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (U[j] == T[k])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\te *= k;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tb += e;\n\t\t\t}\n\t\t\tU = \"\";\n\t\t\tif (i == L.size() - 2)\n\t\t\t{\n\t\t\t\tb += d;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (L[i + 2] == '+')\n\t\t\t\t{\n\t\t\t\t\tb += d;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfor (int j = 0; j < 10; j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (L[i + 1] == T[j])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tU += T[j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (L[i] == '*')\n\t\t{\n\t\t\tU += L[i + 1];\n\t\t}\n\t}\n\tif (U.size() >= 1)\n\t{\n\t\tint e = 1;\n\t\tfor (int j = 0; j < U.size(); j++)\n\t\t{\n\t\t\tfor (int k = 0; k < 10; k++)\n\t\t\t{\n\t\t\t\tif (U[j] == T[k])\n\t\t\t\t{\n\t\t\t\t\te *= k;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tb += e;\n\t}\n\tif (b == a && c == a) { cout << 'U' << endl; }\n\tif (b == a && c != a) { cout << 'M' << endl; }\n\tif (b != a && c == a) { cout << 'L' << endl; }\n\tif (b != a && c != a) { cout << 'I' << endl; }\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <map>\n#include <vector>\n\nusing namespace std;\n\nstring s;\nint p;\nint T;\n\nint number()\n{\n\tint res = s[p] - '0';\n\tp++;\n\treturn res;\n}\n\nint formula()\n{\n\tint res = number();\n\tfor (;;) {\n\t\tif (s[p] == '*') {\n\t\t\tp++;\n\t\t\tres *= number();\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\nint expr()\n{\n\tint res = number();\n\tfor (;;) {\n\t\tif (s[p] == '+') {\n\t\t\tp++;\n\t\t\tres += formula();\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\nint expr2()\n{\n\tint res = number();\n\tfor (;;) {\n\t\tif (s[p] == '+') {\n\t\t\tp++;\n\t\t\tres += number();\n\t\t}\n\t\telse if (s[p] == '*') {\n\t\t\tp++;\n\t\t\tres *= number();\n\t\t}\n\t\telse {\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\nint main()\n{\n\tcin >> s >> T;\n\n\tbool l1, l2;\n\tp = 0;\n\tl1 = expr() == T;\n\tp = 0;\n\tl2 = expr2() == T;\n\tif (l1 && l2) cout << \"U\" << endl;\n\tif (l1 && !l2) cout << \"M\" << endl;\n\tif (!l1 && l2) cout << \"L\" << endl;\n\tif (!l1 && !l2) cout << \"I\" << endl;\n\t\n\tcin >> s;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nlong long dfs(int& idx, string s){\n    if(s[idx + 1] == '+') return (int)s[idx] - '0';\n    else{\n        idx += 2;\n        return ((int)s[idx - 2] - '0') * dfs(idx, s);\n    }\n}\n\nint main(){\n\n    string s; cin >> s;\n    s = s + '+';\n    long long n; cin >> n;\n    long long rule1;\n    long long rule2 = 0;\n    //rule2\n    int idx = 0;\n    while(idx < s.size()){\n        rule2 += dfs(idx, s);\n        idx += 2;\n    }\n\n    //rule1\n    for(int i = 0; i < s.size(); i += 2){\n        if(i == 0) rule1 = (int)s[i] - '0';\n        else{\n            if(s[i - 1] == '+') rule1 += (int)s[i] - '0';\n            else rule1 *= (int)s[i] - '0';\n        }\n    }\n\n    if(rule1 == n && rule2 == n) cout << 'U' << endl;\n    else if(rule1 == n) cout << 'L' << endl;\n    else if(rule2 == n) cout << 'M' << endl;\n    else cout << 'I' << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n\nusing namespace std;\n\nint main(){\n  char e[99];\n  cin>>e;\n  int fr=e[0]-'0';\n  int ba=0,bm=fr;\n  for(char *p=e+1;*p;p+=2){\n    int nd=p[1]-'0';\n    if(*p=='+'){\n      fr+=nd;\n      ba+=bm;\n      bm=nd;\n    }else{\n      fr*=nd;\n      bm*=nd;\n    }\n  }\n  int r;\n  cin>>r;\n  cout<<\"IMLU\"[(fr==r)*2+(ba+bm==r)]<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n  char express[20];\n  int bob;\n  scanf(\"%s\\n%d\", express, &bob);\n  strcat(express, \"E\");\n  stack<int> stk;\n  char op;\n  int num;\n  int miscalc;\n  sscanf(express, \"%d%s\", &miscalc, express);\n  stk.push(miscalc);\n  while(strcmp(express, \"E\") != 0){\n    sscanf(express, \"%c%d%s\", &op, &num, express);\n    if(op == '*'){\n      miscalc *= num;\n      int x = stk.top(); stk.pop();\n      stk.push(x*num);\n    } else {\n      miscalc += num;\n      stk.push(num);\n    }\n  }\n  int corcalc = 0;\n  while(!stk.empty()){\n    corcalc += stk.top(); stk.pop();\n  }\n  if(bob == corcalc && bob != miscalc) cout << \"M\" << endl;\n  if(bob != corcalc && bob == miscalc) cout << \"L\" << endl;\n  if(bob == corcalc && bob == miscalc) cout << \"U\" << endl;\n  if(bob != corcalc && bob != miscalc) cout << \"I\" << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nstring L, M, U;\nlong long a, b, c;\nchar T[11] = \"0123456789\";\n\nint main() {\n\tcin >> L >> a;\n\tfor (int i = 0; i < 10; i++)\n\t{\n\t\tif (L[0] == T[i])\n\t\t{\n\t\t\tb = i; c = i;\n\t\t}\n\t\tif (L[1] == '*')\n\t\t{\n\t\t\tU += L[0];\n\t\t\tc = 0;\n\t\t}\n\t}\n\tfor (int i = 1; i < L.size(); i += 2)\n\t{\n\t\tint d;\n\t\tfor (int j = 0; j < 10; j++)\n\t\t{\n\t\t\tif (L[i + 1] == T[j])\n\t\t\t{\n\t\t\t\td = j;\n\t\t\t}\n\t\t}\n\t\tif (L[i] == '+')\n\t\t{\n\t\t\tc += d;\n\t\t}\n\t\tif (L[i] == '*')\n\t\t{\n\t\t\tc *= d;\n\t\t}\n\t}\n\tfor (int i = 1; i < L.size(); i += 2)\n\t{\n\t\tint d, e;\n\t\tfor (int j = 0; j < 10; j++)\n\t\t{\n\t\t\tif (L[i + 1] == T[j])\n\t\t\t{\n\t\t\t\td = j;\n\t\t\t}\n\t\t}\n\t\tif (L[i] == '+')\n\t\t{\n\t\t\tif (U.size() >= 1)\n\t\t\t{\n\t\t\t\te = 1;\n\t\t\t\tfor (int j = 0; j < U.size(); j++)\n\t\t\t\t{\n\t\t\t\t\tfor (int k = 0; k < 10; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (U[j] == T[k])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\te *= k;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tb += e;\n\t\t\t}\n\t\t\tU = \"\";\n\t\t\tb += d;\n\t\t}\n\t\tif (L[i] == '*')\n\t\t{\n\t\t\tU += L[i + 1];\n\t\t}\n\t}\n\tif (b == a && c == a) { cout << 'U' << endl; }\n\tif (b == a && c != a) { cout << 'M' << endl; }\n\tif (b != a && c == a) { cout << 'L' << endl; }\n\tif (b != a && c != a) { cout << 'I' << endl; }\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n \n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n \nstring gettopnum(string str){\n    string rst = \"\";\n    REP(i,str.size()){\n        if(str[i]=='*'||str[i]=='+') break;\n        else rst += str[i];\n    }\n    return rst;\n}\nll int calc1(string str){//multiplication-first\n    stack<ll int> st;\n    string rststr = gettopnum(str);\n    if(rststr!=\"\") st.push((ll int)stoi(rststr));\n    if(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n    while(str.size()!=0){\n        //cout << str << endl;\n        if(str[0]=='*'){\n            str.erase(str.begin(),str.begin()+1);\n            ll int tmp = stoi(gettopnum(str));\n            str.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n            ll int tmp2 = st.top();\n            st.pop();\n            st.push(tmp*tmp2);\n        }else if(str[0]=='+'){\n            str.erase(str.begin(),str.begin()+1);\n            ll int tmp = stoi(gettopnum(str));\n            st.push(tmp);\n            str.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n        }\n    }\n    ll int rst = 0;\n    while(!st.empty()){\n        rst += st.top();\n        st.pop();\n    }\n    return rst;\n}\n \nll int calc2(string str){////multiplication-first2\n    //cout << str << endl;\n    string rststr = gettopnum(str);\n    ll int rst;\n    if(rststr!=\"\") rst = stoi(rststr);\n    if(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)rst)+1);\n    if(str.size()==0) return rst;\n    else if(str[0]=='*') {\n        str.erase(str.begin(),str.begin()+1);\n        return rst*calc2(str);\n    }else if(str[0]=='+'){\n        str.erase(str.begin(),str.begin()+1);\n        return rst+calc2(str);\n    }\n    //dummy\n    return -1;\n}\n \nll int calc3(string str){//leftto-right\n    string rststr = gettopnum(str);\n    if(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n    ll int rst = stoi(rststr);\n    while(str.size()!=0){\n        //cout << str << endl;\n        if(str[0]=='*'){\n            str.erase(str.begin(),str.begin()+1);\n            ll int tmp = stoi(gettopnum(str));\n            rst *= tmp;\n            str.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n        }else if(str[0]=='+'){\n            str.erase(str.begin(),str.begin()+1);\n            ll int tmp = stoi(gettopnum(str));\n            rst += tmp;\n            str.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n        }\n    }\n    return rst;\n}\n \nint main(){\n    string str;\n    cin >> str;\n    ll int ans;\n    cin >> ans;\n    ll int rst1 = calc1(str);\n    ll int rst2 = calc3(str);\n    //cout << rst1 << \" \" << rst2 << endl;\n    if(rst1==ans){\n        if(rst2==ans) cout << 'U' << endl;\n        else cout << 'M' << endl;\n    }else{\n        if(rst2==ans) cout << 'L' << endl;\n        else cout << 'I' << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst int MX=1000005;\nset<int>st,st1;\nset<int>::iterator it,it1;\nint a[MX];\nint main()\n{\n    int n,q,i,j,k,x,y;\n    string s;\n    cin>>n>>q>>s;\n    for(i=0;i<s.size();i++)\n    {\n      if(s[i]==')')\n      {\n        a[i+1]=0;\n        st.insert(i+1);\n      }\n      else\n      {\n        a[i+1]=1;\n        st1.insert(i+1);\n      }\n    }\n    while(q--)\n    {\n      cin>>x;\n      if(n==2||x==1||x==n)\n      {\n        cout<<x<<endl;\n        continue;\n      }\n      if(a[x]==0)\n      {\n        it=st.lower_bound(x);\n        it1=st1.begin();\n        if(*it1==1)\n        {\n          it1++;\n        }\n        y=*it1;\n        if(y<x)\n        {\n          a[x]=1;\n          a[y]=0;\n          st1.erase(it1);\n          st.erase(it);\n          st.insert(y);\n          st1.insert(x);\n          cout<<y<<endl;\n        }\n        else\n        {\n          cout<<x<<endl;\n        }\n      }\n      else\n      {\n        it1=st1.lower_bound(x);\n        it=st.begin();\n        y=*it;\n        if(y<x)\n        {\n          a[x]=0;\n          a[y]=1;\n          st1.erase(it1);\n          st.erase(it);\n          st.insert(x);\n          st1.insert(y);\n          cout<<y<<endl;\n        }\n        else\n        {\n          cout<<x<<endl;\n        }\n      }\n    }\n    return 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <fstream>\nusing namespace std;\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toStr(T x) { ostringstream sout; sout << x; return sout.str(); }\ntypedef vector<int> vi;\ntypedef vector<vi>  vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define FOR(i,a,b) for(int i=(a);i<=(b);++i)\n#define REP(i,n) FOR(i,0,(n)-1)\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\nconst int INF = INT_MAX / 10;\n\nstring s;\nint p;\n\nint term();\nint num();\n\nint expression() {\n\tint ret = num();\n\twhile (s[p] == '+') {\n\t\tp++;\n\t\tret += term();\n\t}\n\treturn ret;\n}\n\nint term() {\n\tint ret = num();\n\twhile (s[p] == '*') {\n\t\tp++;\n\t\tret *= num();\n\t}\n\treturn ret;\n}\n\nint num() {\n\tint ret = 0;\n\twhile (isdigit(s[p])) {\n\t\tret *= 10;\n\t\tret += (s[p] - '0');\n\t\tp++;\n\t}\n\treturn ret;\n}\n\nint expression2() {\n\tint ret = num();\n\twhile (true) {\n\t\tif (s[p] == '+') {\n\t\t\tp++;\n\t\t\tret += num();\n\t\t}\n\t\telse if (s[p] == '*') {\n\t\t\tp++;\n\t\t\tret *= num();\n\t\t}\n\t\telse {\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn ret;\n}\n\nint main() {\n\tint n;\n\tcin >> s >> n;\n\tp = 0;\n\tint ans1 = expression();\n\tp = 0;\n\tint ans2 = expression2();\n\n\tif (n == ans1) {\n\t\tif (n == ans2) {\n\t\t\tcout << 'U' << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << 'M' << endl;\n\t\t}\n\t}\n\telse if (n == ans2) {\n\t\tcout << 'L' << endl;\n\t}\n\telse {\n\t\tcout << 'I' << endl;\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\n\nint calc(string& s, int i) {\n  int res = s[i] - '0';\n  while (i + 2 < s.size()) {\n    i += 2;\n    if (s[i - 1] == '+') res += s[i] - '0';\n    else res *= s[i] - '0';\n  }\n  return res;\n}\n\nint term(string& s, int& i) {\n  int res = s[i++] - '0';\n  while (s[i] == '*') res *= s[++i] - '0', i++;\n  return res;\n}\n\nint expr(string& s, int& i) {\n  int res = term(s, i);\n  while (s[i] == '+') i++, res += term(s, i);\n  return res;\n}\n\nint main() {\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n  \n  string s;\n  int a;\n  cin >> s >> a;  \n\n  int i = 0;\n  bool M = expr(s, i) == a, L = calc(s, 0) == a;\n  cout << (M && L ? \"U\" : M ? \"M\" : L ? \"L\" : \"I\") << endl;\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\nusing namespace std;\n\nint number(string &s, int &i) {\n    return s[i++] - '0';\n}\n\nint term(string &s, int &i) {\n    int res = number(s, i);\n    while (true) {\n        if (s[i] == '*') {\n            i++;\n            res *= number(s, i);\n        } else {\n            break;\n        }\n    }\n    return res;\n}\n\nint expr(string &s, int &i) {\n    int res = term(s, i);\n    while (true) {\n        if (s[i] == '+') {\n            i++;\n            res += term(s, i);\n        } else {\n            break;\n        }\n    }\n    return res;\n}\n\nint main() {\n    string s; cin >> s;\n    int n = s.length();\n    int ans; cin >> ans;\n    int ans_LtoR = s[0] - '0';\n    for (int i = 1; i < n; i += 2) {\n        if (s[i] == '+') ans_LtoR += s[i + 1] - '0';\n        if (s[i] == '*') ans_LtoR *= s[i + 1] - '0';\n    }\n    int i = 0;\n    int ans_Mult = expr(s, i);\n    bool is_LtoR = ans == ans_LtoR;\n    bool is_Mult = ans == ans_Mult;\n    if (is_LtoR && is_Mult) {\n        cout << \"U\" << endl;\n    } else if (is_LtoR) {\n        cout << \"L\" << endl;\n    } else if (is_Mult) {\n        cout << \"M\" << endl;\n    } else {\n        cout << \"I\" << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i, n) for(int i = 0; i < (n); i++)\n#define repp(i, l, r) for(int i = (l); i < (r); i++)\n#define per(i, n) for(int i = ((n)-1); i >= 0; i--)\n#define perr(i, l, r) for(int i = ((r)-1); i >= (l); i--)\n#define all(x) (x).begin(),(x).end()\n#define MOD 1000000007\n#define IINF 1000000000\n#define LINF 1000000000000000000\n#define SP <<\" \"<<\n#define CYES cout<<\"Yes\"<<endl\n#define CNO cout<<\"No\"<<endl\n#define CFS cin.tie(0);ios::sync_with_stdio(false)\n\ntypedef long long LL;\ntypedef long double LD;\n\nint main(){\n  string s;\n  int ans;\n  cin >> s >> ans;\n  int n = s.length();\n  int x,y;\n  stack<int> st;\n  int now=s[0]-'0';\n  rep(i,(n-1)/2){\n    if(s[2*i+1]=='+'){\n      st.push(now);\n      now=s[2*i+2]-'0';\n    }else{\n      now*=s[2*i+2]-'0';\n    }\n  }\n  st.push(now);\n  x=0;\n  while(!st.empty()){\n    x+=st.top();\n    st.pop();\n  }\n  y=s[0]-'0';\n  rep(i,(n-1)/2){\n    if(s[2*i+1]=='+'){\n      y+=s[2*i+2]-'0';\n    }else{\n      y*=s[2*i+2]-'0';\n    }\n  }\n  if(ans==x){\n    if(ans==y){\n      cout << \"U\" << endl;\n    }else{\n      cout << \"M\" << endl;\n    }\n  }else{\n    if(ans==y){\n      cout << \"L\" << endl;\n    }else{\n      cout << \"I\" << endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <sstream>\n\n#define REP(i,k,n) for(int i=k;i<n;i++)\n#define rep(i,n) for(int i=0;i<n;i++)\n\nusing namespace std;\ntypedef long long ll;\n\nvector<string> split(const string &str, char delim) {\n    vector<string> res;\n    size_t current = 0, found;\n    while((found = str.find_first_of(delim, current)) != string::npos) {\n        res.push_back(string(str, current, found - current));\n        current = found + 1;\n    }\n    res.push_back(string(str, current, str.size() - current));\n    return res;\n}\n\nint main() {\n    string S;\n    cin >> S;\n\n    int n;\n    cin >> n;\n\n    string s = S;\n\n    while(true) {\n        bool F = true;\n        rep(i,s.size()) {\n            if(s[i] == '*') {\n                F = false;\n                int l = s[i-1]-'0';\n                int r = s[i+1]-'0';\n\n                stringstream ss;\n                rep(j,i-1) ss << s[j];\n                ss << l*r;\n\n                REP(j,i+2,s.size()) ss << s[j];\n\n                s = ss.str();\n                break;\n            }\n        }\n\n        if(F) break;\n    }\n\n    int a = 0;\n    vector<string> ret = split(s,'+');\n    rep(i,ret.size()) {\n        stringstream ss;\n        ss << ret[i];\n\n        int t;\n        ss >> t;\n\n        a += t;\n    }\n\n    s = S;\n    int b = s[0]-'0';\n    for(int i=1;i+1<s.size();i+=2) {\n        int r = s[i+1] - '0';\n\n        if(s[i] == '+') {\n            b += r;\n        }\n        else {\n            b *= r;\n        }\n    }\n\n    if(a == n && b == n) cout << \"U\" << endl;\n    else if(a == n) cout << \"M\" << endl;\n    else if(b == n) cout << \"L\" << endl;\n    else cout << \"I\" << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\nstring s;\nlong long x;\n\nint main(){\n\tcin >> s;\n\tcin >> x;\n\tlong long t1 = 0, t2 = 0;\n\tint last_sign = 0;\n\tfor (int i=0;i<s.length();i+=2){\n\t\tif (last_sign){\n\t\t\tt1 = t1*(s[i]-'0');\n\t\t}else t1 += s[i]-'0';\n\t\tif (t1>x) break;\n\t\tif (i+1 != s.length() and s[i+1] == '+') last_sign = 0;\n\t\telse last_sign = 1;\n\t}\n\tlong long current_multiple = 1;\n\tfor (int i=0;i<s.length();i++){\n\t\tif (s[i] == '+'){\n\t\t\tt2 += current_multiple;\n\t\t\tcurrent_multiple = 1;\n\t\t} else if (s[i] != '*'){\n\t\t\tif (s[i]=='0' or current_multiple < x)\n\t\t\t\tcurrent_multiple *= s[i]-'0';\n\t\t}\n\t}\n\tt2+=current_multiple;\n\tif (t1 == x and t2!=x){\n\t\tcout << \"L\";\n\t}\n\telse if (t1!=x and t2==x){\n\t\tcout << \"M\";\n\t}\n\telse if (t1 == x and t2 == x){\n\t\tcout << \"U\";\n\t}\n\telse cout << \"I\";\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define reep(i,a,b) for(int i=(a);i<(b);i++)\n#define rep(i,n) reep((i),0,(n))\nint foo2(string s){\n    int ret=0;\n    stringstream ss;\n    ss<<s;\n    ss>>ret;\n    char t;\n    int tt;\n    cout<<s<<endl;\n    while(ss>>t){\n        ss>>tt;\n        if(t=='+'){\n            ret+=tt;\n        }\n        else{\n            ret*=tt;\n        }\n    }\n    return ret;\n}\nint foo1(string s){\n    rep(i,s.size()){\n        if(s[i]=='*'){\n            int l=i-1;\n            int r=i+1;\n            while(isdigit(s[l])) l--;\n            while(isdigit(s[r])) r++;\n            l++;\n            r--;\n            stringstream ss;\n            ss<<atoi(s.substr(l,i-l).c_str())*atoi(s.substr(i+1,r-i).c_str());\n            string t;\n            ss>>t;\n            return foo1(s.substr(0,l)+t+s.substr(r+1));\n        }\n    }\n    return foo2(s);\n}\nint main(){\n    string s;\n    int a;\n    cin>>s>>a;\n    // cout<<foo1(s)<<endl;\n    // cout<<foo2(s)<<endl;\n    bool f1=(a==foo1(s));\n    bool f2=(a==foo2(s));\n    if(f1&&f2) cout<<\"U\"<<endl;\n    else if(f1) cout<<\"M\"<<endl;\n    else if(f2) cout<<\"L\"<<endl;\n    else  cout<<\"I\"<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\n#define valid(y,x,h,w) (0<=y&&y<h&&0<=x&&x<w)\n#define tpl(...) make_tuple(__VA_ARGS__)\nconst int INF = 0x3f3f3f3f;\nconst double EPS = 1e-8;\nconst double PI = acos(-1);\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntemplate<class T>bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a=b; return 1; } return 0; }\ntemplate<class T>ostream&operator<<(ostream &o,const vector<T>&t){o<<'[';FOR(i,t){if(i!=t.begin())o<<',';o<<*i;}return o<<']';}\ntemplate<class S,class T>ostream&operator<<(ostream &o,const pair<S,T>&t){return o<<'('<<t.first<<','<<t.second<<')';}\ntemplate<int N,class Tp>void output(ostream&,const Tp&){}\ntemplate<int N,class Tp,class,class ...Ts>void output(ostream &o,const Tp&t){if(N)o<<',';o<<get<N>(t);output<N+1,Tp,Ts...>(o,t);}\ntemplate<class ...Ts>ostream&operator<<(ostream&o,const tuple<Ts...>&t){o<<'(';output<0,tuple<Ts...>,Ts...>(o,t);return o<<')';}\ntemplate<class T>void output(T t,char z=10){if(t<0)t=-t,putchar(45);int c[20];\nint k=0;while(t)c[k++]=t%10,t/=10;for(k||(c[k++]=0);k;)putchar(c[--k]^48);putchar(z);}\ntemplate<class T>void outputs(T t){output(t);}\ntemplate<class S,class ...T>void outputs(S a,T...t){output(a,32);outputs(t...);}\ntemplate<class T>void output(T *a,int n){REP(i,n)output(a[i],i!=n-1?',':10);}\ntemplate<class T>void output(T *a,int n,int m){REP(i,n)output(a[i],m);}\ntemplate<class T>bool input(T &t){int n=1,c;for(t=0;!isdigit(c=getchar())&&~c&&c-45;);\nif(!~c)return 0;for(c-45&&(n=0,t=c^48);isdigit(c=getchar());)t=10*t+c-48;t=n?-t:t;return 1;}\ntemplate<class S,class ...T>bool input(S&a,T&...t){input(a);return input(t...);}\n\nchar s[1010];\n\nll term(int &i);\nll fact(int &i);\n\nll exp(int &i) {\n  ll p = term(i);\n  while(s[i]=='+' || s[i]=='-') {\n    char c = s[i++];\n    if (c == '+') {\n      ll a = term(i);\n      p += a;\n    }\n    else p -= term(i);\n  }\n  return p;\n}\n\nll term(int &i) {\n  ll p = fact(i);\n  while(s[i]=='*') {\n    i++;\n    p *= fact(i);\n  }\n  return p;\n}\n\nll exp2(int &i) {\n  ll p = fact(i);\n  while(s[i]=='+' || s[i]=='-' || s[i]=='*') {\n    char c = s[i++];\n    if (c == '+') {\n      ll a = fact(i);\n      p += a;\n    }\n    else if (c == '-') p -= fact(i);\n    else {\n      p *= fact(i);\n    }\n  }\n  return p;\n}\n\nll fact(int &i) {\n  if (s[i] == '(') {\n    i++;\n    int p = exp(i);\n    assert(s[i++]==')');\n    return p;\n  } else {\n    int num = 0;\n    while(isdigit(s[i])) {\n      num *= 10;\n      num += s[i]-'0';\n      i++;\n    }\n    return num;\n  }\n}\n\n\nint main() {\n  while(cin >> s) {\n    ll x;\n    cin >> x;\n    int i = 0;\n    ll ans1 = exp(i);\n    i = 0;\n    ll ans2 = exp2(i);\n    // cout << ans1 << \" \" << ans2 << endl;\n    char ans;\n    if (ans1 == x && ans2 == x) {\n      ans = 'U';\n    } else if (ans1 == x) {\n      ans = 'M';\n    } else if (ans2 == x) {\n      ans = 'L';\n    } else {\n      ans = 'I';\n    }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <utility>\n#include <queue>\n#include <string>\n#define llint long long\n#define inf 1e9\n\nusing namespace std;\ntypedef pair<llint, llint> P;\n\nstring s;\nllint x;\n\nint main(void)\n{\n  cin >> s >> x;\n  llint ans = s[0]-'0';\n  for(int i = 2; i < s.size(); i+=2){\n    if(s[i-1] == '+') ans += s[i]-'0';\n    else ans *= s[i]-'0';\n  }\n\n  llint ans2 = 0, mul = 1;\n  for(int i = 0; i < s.size(); i++){\n    if(s[i] == '+'){\n      ans2 += mul;\n      mul = 1;\n    }\n    else if(s[i] != '*') mul *= s[i]-'0';\n  }\n  ans2 += mul;\n\n  if(ans == x){\n    if(ans2 == x) cout << \"U\" << endl;\n    else cout << \"L\" << endl;\n  }\n  else{\n    if(ans2 == x) cout << \"M\" << endl;\n    else cout << \"I\" << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#define LEN (17 / 2 + 1)\n\nconst char* out = \"ILMU\";\n\nint mf( std::string str ){\n\tint sum = 0, pt = 0;\n\tint n[ LEN + 1 ];\n\n\tstd::fill( n, n + LEN + 1, 1 );\n\n\tfor( int i = 0; i < str.size(); i++ ){\n\t\tif( i & 1 ){\n\t\t\tif( str[i] == '+' ){\n\t\t\t\tpt++;\n\t\t\t}\n\t\t}else{\n\t\t\tn[pt] *= (str[i] - '0');\n\t\t}\n\t}\n\n\tfor( int i = 0; i <= pt; ++i ) sum += n[i];\t\n\n\treturn sum;\n}\n\nint lr( std::string str ){\n\tint sum = str[0] - '0' ;\n\n\tfor( int i = 1; i < str.size(); i += 2 ){\n\t\tif(str[i] == '+'){\n\t\t\tsum += str[i+1] - '0';\n\t\t}else{\n\t\t\tsum *= str[i+1] - '0';\n\t\t}\n\t}\n\n\treturn  sum;\n}\n\nint main(){\n\tstd::string str;\n\tint res;\n\tbool equal[2];\n\n\tstd::cin >> str >> res;\n\n\tequal[0] = (mf( str ) == res);\n\tequal[1] = (lr( str ) == res);\n\n\tstd::cout << out[ ((int)equal[0] << 1) + equal[1] ] << std::endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <functional>\n#include <vector>\n#include <utility>\n#include <cstring>\n#include <iomanip>\n#include <numeric>\n#include <cmath>\n#include <queue>\n#include <map>\nusing namespace std;\ntypedef long long ll;\nconst int INF = 1<<30; \nconst int MOD = 1e9 + 7;\nconst int dy[] = {1, 0, -1, 0};\nconst int dx[] = {0, 1, 0, -1};\nint to_int(char ch) { return ch - '0'; }\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    string s; cin >> s;\n    int val; cin >> val;\n    int L = to_int(s[0]);\n    for(int i = 1; i < s.size(); i += 2)\n    {\n        if(s[i] == '+') L += to_int(s[i + 1]);\n        if(s[i] == '*') L *= to_int(s[i + 1]);\n    }\n    vector<int> v;\n    for(int i = 1; i < s.size(); i += 2)\n    {\n        int tmp = to_int(s[i - 1]);\n        while(s[i] == '*')\n        {\n            tmp *= to_int(s[i + 1]);\n            i += 2;\n        }\n        v.push_back(tmp);\n    }\n    if(s[s.size() - 2] == '+' || s.size() == 1) v.push_back(to_int(s.back()));\n    int M = 0;\n    for(int i = 0; i < v.size(); i++) M += v[i];\n    // for(int i = 0; i < v.size(); i++) cout << v[i] << \" \"; cout << endl;\n    // cout << L << \" \" << M << endl;\n    if(val == L && val == M) cout << \"U\" << endl;\n    else if(val == L) cout << \"L\" << endl;\n    else if(val == M) cout << \"M\" << endl;\n    else cout << \"I\" << endl;\n    return 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n\nusing namespace std;\n\nvoid swap(int *a,int *b){\n\tint tmp = *a;\n\t*a = *b;\n\t*b = tmp;\n}\n\n\nint lFunc(string str){\n\t\n\tint num=str.at(0)-'0';\n\n\tfor(int i=1;i<str.size();i+=2){\n\t\tif(str.at(i)=='+'){\n\t\t\tnum+=(str.at(i+1)-'0');\n\t\t}\n\t\telse{\n\t\t\tnum*=(str.at(i+1)-'0');\n\t\t}\n\t}\n\n\treturn  num;\n}\n\nint uFunc(string str){\n\t\n\tint *dataNum;\n\tint *dataCal;\n\tint length = str.size()/2;\n\n\tdataNum = new int[str.size()/2+1];\n\tdataCal = new int[str.size()/2];\n\n\tfor(int i=0;i<str.size();i++){\n\t\tif(i%2==0){\n\t\t\tdataNum[i/2]=str.at(i)-'0';\n\t\t}\n\t\telse{\n\t\t\tif(str.at(i)=='+'){\n\t\t\t\tdataCal[i/2]=1;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tdataCal[i/2]=2;\n\t\t\t}\n\t\t}\n\t}\n\t/*\n\tfor(int k=0;k<length+1;k++){\n\t\tcout<<dataNum[k]<<\" \";\n\t}\n\tcout<<endl;\n\n\tfor(int k=0;k<length;k++){\n\t\tcout<<dataCal[k]<<\" \";\n\t}\n\tcout<<endl;\n\t*/\n\n\twhile(1){\n\t\tint flag=0;\n\n\t\tfor(int i=0;i<length;i++){\n\t\t\tif(dataCal[i]==2){\n\t\t\t\tdataNum[i]*=dataNum[i+1];\n\t\t\t\tflag=1;\n\n\t\t\t\tfor(int now=i;now<length-1;now++){\n\t\t\t\t\tswap(&dataNum[now+1],&dataNum[now+2]);\n\t\t\t\t\tswap(&dataCal[now],&dataCal[now+1]);\n\t\t\t\t}\n\t\t\t\tlength--;\n\t\t\t}\n\t\t\t/*\n\t\t\tfor(int k=0;k<length+1;k++){\n\t\t\t\tcout<<dataNum[k]<<\" \";\n\t\t\t}\n\t\t\tcout<<endl;\n\n\t\t\tfor(int k=0;k<length;k++){\n\t\t\t\tcout<<dataCal[k]<<\" \";\n\t\t\t}\n\t\t\tcout<<endl;\n\t\t\t*/\n\t\t}\n\t\tif(flag==0)break;\n\t}\n\n\tint num=dataNum[0];\n\tfor(int i=1;i<=length;i++){\n\t\tnum+=dataNum[i];\n\t}\n//\tcout<<\"U=\"<<num<<endl;\n\n\treturn num;\n}\n\nint main(){\n\n\tstring str;\n\n\tcin>>str;\n\n\tint input;\n\tcin>>input;\n\n\tif(input==lFunc(str) && input==uFunc(str)){\n\t\tcout<<\"U\"<<endl;\n\t}\n\telse if(input == lFunc(str)){\n\t\tcout<<\"L\"<<endl;\n\t}\n\telse if(input == uFunc(str)){\n\t\tcout<<\"M\"<<endl;\n\t}\n\telse{\n\t\tcout<<\"I\"<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) begin(a),end(a)\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10  fixed<<setprecision(5)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<short, short> P;\ntypedef complex<double> Point;\ntypedef long long ll;\nconst int INF = 1145141919;\nconst int MOD = 100000007;\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\nstruct edge\n{\n\tint from, to, cost;\n\tbool operator < (const edge& e) const { return cost < e.cost; }\n\tbool operator > (const edge& e) const { return cost > e.cost; }\n};\n///*************************************************************************************///\n///*************************************************************************************///\n///*************************************************************************************///\n\n\nint main()\n{\n\tstring s; int n;\n\tcin >> s >> n;\n\tll mul = 0; ll ltr = s[0]-'0';\n\tint l = s.size();\n\tFOR(i,2, l)\n\t{\n\t\tif (isdigit(s[i]))\n\t\t{\n\t\t\tif (s[i - 1] == '+') ltr += s[i]-'0';\n\t\t\telse ltr *= s[i]-'0';\n\t\t}\n\t}\n\tvector<ll> v;\n\tREP(i, l)\n\t{\n\t\tif (isdigit(s[i])) v.push_back(s[i] - '0');\n\t\telse if (s[i] == '+') v.push_back(-1);\n\t\telse v.push_back(-2);\n\t}\n\tbool update = true;\n\twhile (update)\n\t{\n\t\tupdate = false;\n\t\tREP(i, v.size())\n\t\t{\n\t\t\tif (v[i] == -2)\n\t\t\t{\n\t\t\t\tupdate = true;\n\t\t\t\tv[i - 1] = v[i - 1] * v[i + 1];\n\t\t\t\tv.erase(v.begin() + i);\n\t\t\t\tv.erase(v.begin() + i);\n\t\t\t}\n\t\t}\n\t}\n\tREP(i, v.size()) if (v[i] >= 0) mul += v[i];\n\n\tif (n == mul&&n == ltr) puts(\"U\");\n\telse if (n == mul) puts(\"M\");\n\telse if (n == ltr) puts(\"L\");\n\telse puts(\"I\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n\nusing namespace std;\nbool isM(int n,string s)\n{\n\tvector<bool> used(s.length());\n\tfor (int i = 0; i < s.length(); i++)\n\t{\n\t\tused[i] = false;\n\t}\n\tbool flag = false;\n\tint sum = 0;\n\tfor (int i = 1; i < s.length(); i+= 2)\n\t{\n\t\tif (s[i] == '*')\n\t\t{\n\t\t\tif (used[i - 1])\n\t\t\t{\n\t\t\t\tsum *= (s[i + 1] - '0');\n\t\t\t\tused[i + 1] = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (!flag)\n\t\t\t\t{\n\t\t\t\t\tsum = (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t\t\tflag = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tsum += (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t\t}\n\t\t\t\tused[i - 1] = true;\n\t\t\t\tused[i + 1] = true;\n\t\t\t}\n\t\t\t//cout << sum << endl;\n\t\t}\n\t}\n\tfor (int i = 0; i < s.length(); i += 2)\n\t{\n\t\tif (used[i])continue;\n\t\tsum += (s[i] - '0');\n\t}\n\t//cout << sum << endl;\n\tif (n == sum)return true;\n\telse return false;\n}\n\nbool isL(int n,string s)\n{\n\tif (s.length() == 1 && s[0] - '0' == n)return true;\n\tint sum = -1;\n\tfor (int i = 1; i < s.length(); i += 2)\n\t{\n\t\tif (i == 1)\n\t\t{\n\t\t\tif (s[i] == '+')\n\t\t\t{\n\t\t\t\tsum = s[i - 1] - '0' + (s[i + 1] - '0');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsum = (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (s[i] == '+')\n\t\t\t{\n\t\t\t\tsum += (s[i + 1] - '0');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsum *= (s[i + 1] - '0');\n\t\t\t}\n\t\t}\n\t}\n\n\tif (sum == n)return true;\n\telse return false;\n}\n\nint main()\n{\n\tstring exp;\n\tint n;\n\tcin >> exp;\n\tcin >> n;\n\tif (isM(n, exp) && isL(n, exp))\n\t{\n\t\tcout << \"U\" << endl;\n\t}\n\telse if (isM(n,exp))\n\t{\n\t\tcout << \"M\" << endl;\n\t}\n\telse if (isL(n, exp))\n\t{\n\t\tcout << \"L\" << endl;\n\t}\n\telse\n\t{\n\t\tcout << \"I\" << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<cstring>\n#include<queue>\n\nusing namespace std;\n\n#define INF 999999999\n#define REP(i,n) for(int i=0; i<(int)(n); i++)\n\nint main(){\n\tint m, l, a, mins, lins, sta;\n\tstring eq;\n\tcin >> eq;\n\teq += \"+\";\n\tcin >> a;\n\tsta = 0;\n\tm = 0;\n\tl = 0;\n\tfor(int i=0;i<eq.size();i++){\n\t\tif(i%2==0){\n\t\t\tif(!sta){\n\t\t\t\tm += eq[i]-'0';\n\t\t\t\tlins = eq[i]-'0';\n\t\t\t}\n\t\t\telse{\n\t\t\t\tm = m * (eq[i]-'0');\n\t\t\t\tlins *= eq[i]-'0';\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tif(eq[i]=='+'){\n\t\t\t\tsta = 0;\n\t\t\t\tl += lins;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tsta = 1;\n\t\t\t}\n\t\t}\n\t\t//cout << m << \" \" << l << endl;\n\t}\n\tif(a==l&&a==m)cout << \"U\" << endl;\n\telse if(a==l)cout << \"M\" << endl;\n\telse if(a==m)cout << \"L\" << endl;\n\telse cout << \"I\" << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\nint M(char s[]){\n    int i,n,m,a[20];\n    for(i=0,n=0;s[i];i+=2)\n        a[n++]=s[i]-'0';\n    for(i=1;s[i];i+=2){\n        if(s[i]=='*'){\n            a[i/2+1]*=a[i/2];\n            a[i/2]=0;\n        }\n    }\n    for(i=0,m=0;i<n;i++)\n        m+=a[i];\n    return m;\n}\nint L(char s[]){\n    int i,l;\n    for(i=1,l=s[0]-'0';s[i];i+=2){\n        if(s[i]=='+')\n            l+=s[i+1]-'0';\n        else if(s[i]=='*')\n            l*=s[i+1]-'0';\n    }\n    return l;\n}\nint main(void){\n    int i,m,l,b;\n    char s[20];\n    scanf(\"%s\",s);\n    scanf(\"%d\",&b);\n    m=M(s);\n    l=L(s);\n    if(b==m&&b==l)\n        puts(\"U\");\n    else if(b==m)\n        puts(\"M\");\n    else if(b==l)\n        puts(\"L\");\n    else\n        puts(\"I\");\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\nint formula();\nint digit();\nint pls();\nint p,result,cal;\nstring str;\nchar c;\n\nint main(){\n  cin>>str>>result;\n  cal=str[0]-'0';\n  for(int i=1;i<=(int)str.size();i++){\n    if(i%2) c=str[i];\n    else{\n      if(c=='*') cal=cal*(str[i]-'0');\n      else cal=cal+(str[i]-'0');\n    }\n  }\n  p=0;\n  int r=formula();\n  if(cal==result&&r==result) cout<<'U'<<endl;\n  else if(cal==result) cout<<'L'<<endl;\n  else if(r==result) cout<<'M'<<endl;\n  else cout<<'I'<<endl;\n  return 0;\n}\n\nint formula(){\n  int val=pls();\n  while(str[p]=='+'){\n    p++;\n    val=val+pls();\n  }\n  return val;\n}\n\nint pls(){\n  int val=digit();\n  while(str[p]=='*'){\n    p++;\n    val=val*digit();\n  }\n  return val;\n}\n\nint digit(){\n  int val=str[p]-'0';\n  p++;\n  return val;\n}"
  },
  {
    "language": "C++",
    "code": "///\n// File:  1346.cpp\n// Author: ymiyamoto\n//\n// Created on Sun Nov 26 02:53:16 2017\n//\n\n#include <cstdint>\n#include <iostream>\n#include <stack>\n#include <string>\n\nusing namespace std;\n\nuint32_t mult_first(string exp)\n{\n  stack<int32_t> stack;\n\n  stack.push(exp[0] - '0');\n  uint32_t index = 1;\n  while (index < exp.size()) {\n    uint32_t val = exp[index + 1] - '0';\n    if (exp[index] == '+') {\n      stack.push(val);\n    } else {\n      uint32_t val1 = stack.top();\n      stack.pop();\n      stack.push(val * val1);\n    }\n    index += 2;\n  }\n\n  uint32_t result = 0;\n  while (!stack.empty()) {\n    result += stack.top();\n    stack.pop();\n  }\n  return result;\n}\n\nuint32_t left_to_right(string exp)\n{\n  uint32_t result = exp[0] - '0';\n\n  uint32_t index = 1;\n  while (index < exp.size()) {\n    uint32_t val = exp[index + 1] - '0';\n    if (exp[index] == '+') {\n      result += val;\n    } else {\n      result *= val;\n    }\n    index += 2;\n  }\n  return result;\n}\n\nint32_t main()\n{\n  string exp;\n  cin >> exp;\n\n  uint32_t result1 = mult_first(exp);\n  uint32_t result2 = left_to_right(exp);\n\n  uint32_t n;\n  cin >> n;\n  if (result1 == n && result2 == n) {\n    cout << \"U\" << endl;\n  } else if (result1 == n) {\n    cout << \"M\" << endl;\n  } else if (result2 == n) {\n    cout << \"L\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\nusing namespace std;\n#define FOR(i,bg,ed) for(int i=bg;i<ed;i++)\n#define REP(i,n) FOR(i,0,n)\n\ntypedef long long LL;\ntypedef vector<int> V;\nstring s;\nint i(char x){\n    return x-'0';\n}\nLL M(){\n    LL sum=0;\n    LL mul=i(s[0]);\n    int id=1;\n    int n=s.size();\n    while(id<n){\n        char op = s[id++];\n        int num = i(s[id++]);\n        if(op=='+'){\n            sum += mul;\n            mul = num;\n        }\n        if(op=='*'){\n            mul*=num;\n        }\n    }\n    sum+=mul;\n    return sum;\n}\n\nLL L(){\n    LL sum=i(s[0]);\n    int id=1;\n    int n=s.size();\n    while(id<n){\n        char op = s[id++];\n        int num = i(s[id++]);\n        if(op=='+'){\n            sum += num;\n        }\n        if(op=='*'){\n            sum*=num;\n        }\n    }\n    return sum;\n}\nstring ans[]={\"I\",\"L\",\"M\",\"U\"};\n        \nint main(){\n    LL ret;\n    cin>>s>>ret;\n    int x=0;\n    if(M()==ret)x|=2;\n    if(L()==ret)x|=1;\n    cout<<ans[x]<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstring str;\nint ans;\n\nbool ruleM (string ex) {\n    for (int i = 0; i < ex.size(); i++) {\n        if (ex[i] == '*') {\n            string tmp = string(ex.begin(), ex.begin() + i - 1);\n            int mul = (ex[i-1] - '0') * (ex[i+1] - '0');\n            tmp += (char)('0' +  mul);\n            tmp += string(ex.begin() + i + 2, ex.end());\n\n            return ruleM (tmp);\n        }\n    }\n\n    int sum = 0;\n    for (int i = 0; i < ex.size(); i++) {\n        if (ex[i] != '+') {\n            sum += (ex[i] - '0');\n        }\n    }\n\n    return sum == ans;\n}\n\nbool ruleL (string ex) {\n    int num = ex[0] - '0';\n    for (int i = 1; i < ex.size(); i += 2) {\n        if (ex[i] == '+') {\n            num += ex[i+1] - '0';\n        } else {\n            num *= ex[i+1] - '0';\n        }\n    }\n\n    return num == ans;\n}\n\nint main () {\n    cin >> str >> ans;\n\n    bool m = ruleM(str), l = ruleL(str);\n    if (!l && m) {\n        cout << \"M\" << endl;\n    } else if (!m && l) {\n        cout << \"L\" << endl;\n    } else if (m && l) {\n        cout << \"U\" << endl;\n    } else {\n        cout << \"I\" << endl;\n    }\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<fstream>\n#include<stdio.h>\n#include<string>\n#include<vector>\n#include<map>\n#include<math.h>\n#include<algorithm>\n#include<iomanip>\n#include<set>\n#include<utility>\n\nusing namespace std;\n\nint main() {\n  string s;\n  cin >> s;\n  long long ans;\n  cin >> ans;\n  long long mfans = 0, flans = 0;\n  int num = 0;\n  bool b = true;\n  char ls = '+';\n  for(int i = 0; i < s.size(); i++) {\n    if(b) {\n      num = s[i] - '0';\n      b = false;\n    } else {\n      if(s[i] == '+' || s[i] == '*') {\n        if(ls == '+') flans += num;\n        else flans *= num;\n        ls = s[i];\n        b = true;\n      } else {\n        num = num * 10 + s[i] - '0';\n      }\n    }\n  }\n  if(ls == '+') flans += num;\n  else flans *= num;\n  \n  string ss = \"0+\" + s + \"+0\";\n  while(true) {\n    bool bb = false;\n    for(int i = 0; i < ss.size(); i++) {\n      if(ss[i] == '*') {\n        int k = i - 1;\n        for(; k > 0; k--) if(ss[k] == '+' || ss[k] == '*') {\n          k++;\n          break;\n        }\n        int l = i + 1;\n        for(; l < ss.size(); l++) if(ss[l] == '+' || ss[l] == '*') {\n          l--;\n          break;\n        }\n        int lhs = stoi(ss.substr(k, i - k));\n        int rhs = stoi(ss.substr(i + 1, l - i));\n        ss = ss.substr(0, k) + to_string(lhs * rhs) + ss.substr(l + 1, ss.size());\n        bb = true;\n        break;\n      }\n    }\n    if(!bb) break;\n  }\n  num = 0;\n  b = true;\n  for(int i = 0; i < ss.size(); i++) {\n    if(b) {\n      num = ss[i] - '0';\n      b = false;\n    } else {\n      if(ss[i] == '+') {\n        mfans += num;\n        b = true;\n      } else {\n        num = num * 10 + ss[i] - '0';\n      }\n    }\n  }\n  mfans += num;\n  \n  \n  if(flans == ans && mfans == ans) cout << \"U\" << endl;\n  else if(mfans == ans) cout << \"M\" << endl;\n  else if(flans == ans) cout << \"L\" << endl;\n  else cout << \"I\" << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <stack>\n#include <cctype>\nusing namespace std;\n\nint main()\n{\n  string s;\n  int n;\n  cin >> s >> n;\n  stack<int> a;\n  for(int i = 0; i < (int)s.size(); i++){\n    if(isdigit(s[i])){\n      a.push(s[i]-'0');\n    }else if(s[i] == '*'){\n      int x = a.top() * (s[++i] - '0');\n      a.pop();\n      a.push(x);\n    }\n  }\n  int x = 0;\n  while(!a.empty()){\n    x += a.top();\n    a.pop();\n  }\n  for(int i = 0; i < (int)s.size(); i++){\n    if(isdigit(s[i])){\n      a.push(s[i]-'0');\n    }else if(s[i] == '*'){\n      int x = a.top() * (s[++i] - '0');\n      a.pop();\n      a.push(x);\n    }else if(s[i] == '+'){\n      int x = a.top() + (s[++i] - '0');\n      a.pop();\n      a.push(x);\n    }\n  }\n  int y = a.top();\n  if(n == x && n == y)\n    cout << 'U';\n  else if(n == x)\n    cout << 'M';\n  else if(n == y)\n    cout << 'L';\n  else\n    cout << 'I';\n  cout << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define for_(i,a,b) for(int i=a;i<b;++i)\n#define size_of(a) (int)a.size()\n\nint calc(vector< int >& s, vector< char >& op) {\n\tint cur = s[0], j = 1;\n\t\n\tfor_(i,0,size_of(op)) {\n\t\tif (op[i] == '+') cur += s[j++];\n\t\telse cur *= s[j++];\n\t}\n\t\n\treturn cur;\n}\n\nint main() {\n\tstring s; int r;\n\tcin >> s >> r;\n\t\n\tvector< int > s1, s2;;\n\tvector< char > op1, op2;\n\tbool mul = false;\n\t\n\tfor_(i,0,size_of(s)) {\n\t\tif (i & 1) {\n\t\t\tif (s[i] == '*') mul = true;\n\t\t\telse op1.push_back(s[i]), mul = false;\n\t\t\top2.push_back(s[i]);\n\t\t} else {\n\t\t\tif (mul) s1[size_of(s1) - 1] *= s[i] - '0';\n\t\t\telse s1.push_back(s[i] - '0');\n\t\t\ts2.push_back(s[i] - '0');\n\t\t}\n\t}\n\t\n\tint c1 = calc(s1, op1), c2 = calc(s2, op2);\n\tbool f1 = (c1 == r), f2 = (c2 == r);\n\t\n\tif (f1 && f2) cout << \"U\" << endl;\n\telse if (f1) cout << \"M\" << endl;\n\telse if (f2) cout << \"L\" << endl;\n\telse cout << \"I\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\n#define REP(i,n) for (int i=0; i<n; i++)\n\nstring str;\nint j=0;\n\nint calc_mult(){\n\tint num = str[j] - '0';\n\tj++;\n\twhile(1){\n\t\tif (j>=str.size()){\n\t\t\treturn num;\n\t\t}else if (str[j]=='+'){\n\t\t\tj++;\n\t\t\treturn (num += calc_mult());\n\t\t}else{\n\t\t\tj++;\n\t\t\tnum *= str[j] - '0';\n\t\t\tj++;\n\t\t}\n\t}\n}\n\nint calc_lr(){\n\tint ret=str[0] - '0';\n\tchar last_op = '+';\n\tfor (int i=1; i+1<str.size(); i++){\n\t\tlast_op = str[i];\n\t\ti++;\n\t\tret = last_op=='+' ? ret+(str[i]-'0') : ret*(str[i] - '0');\t\n\t}\n\treturn ret;\n}\n\nint main(){\n\tint bob;\n\tcin >> str >> bob;\n\tint mult=calc_mult(), lr = calc_lr();\n\tif (mult==bob){\n\t\tif (lr==bob){\n\t\t\tcout << \"U\" << endl;\n\t\t}else{\n\t\t\tcout << \"M\" << endl;\n\t\t}\n\t}else if (lr==bob){\n\t\tcout << \"L\" << endl;\n\t}else{\n\t\tcout << \"I\" << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n\nusing namespace std;\n\nint main(){\n\n\tstring exp;\n\n\tint ans;\n\tint ma,la;\n\tint mt;\n\n\tcin>>exp;\n\tcin>>ans;\n\n\tif(exp.size()==1){\n\t\tif(exp[0]-'0'==ans) cout<<\"U\"<<endl;\n\t\telse cout<<\"I\"<<endl;\n\t\treturn 0;\n\t}\n\n\tla=(exp[1]=='+')?exp[0]-'0'+exp[2]-'0':(exp[0]-'0')*(exp[2]-'0');\n\tfor(int i=3;i<exp.size();i+=2){\n\t\tif(exp[i]=='+') la+=exp[i+1]-'0';\n\t\telse la*=(exp[i+1]-'0');\n\t}\n\n\tif(exp[1]=='+'){\n\t\tma=exp[0]-'0';\n\t\tmt=-1;\n\t}\n\telse{\n\t\tma=0;\n\t\tmt=exp[0]-'0';\n\t}\n\n\tfor(int i=2;i<exp.size()-1;i+=2){\n\t\tif(exp[i+1]=='*'){\n\t\t\tif(mt==-1) mt=exp[i]-'0';\n\t\t\telse mt*=(exp[i]-'0');\n\t\t}\n\t\telse{\n\t\t\tif(mt!=-1){\n\t\t\t\tma+=(mt*(exp[i]-'0'));\n\t\t\t\tmt=-1;\n\t\t\t}\n\t\t\telse ma+=(exp[i]-'0');\n\t\t}\n\t}\n\tif(mt!=-1){\n\t\tma+=(mt*(exp[exp.size()-1]-'0'));\n\t\tmt=-1;\n\t}\n\telse ma+=(exp[exp.size()-1]-'0');\n\n\tif(ans==ma&&ans==la) cout<<\"U\"<<endl;\n\telse if(ans==ma) cout<<\"M\"<<endl;\n\telse if(ans==la) cout<<\"L\"<<endl;\n\telse cout<<\"I\"<<endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\nusing namespace std;\n\nint main()\n{\n\tstring str;\n\tint answer;\n\n\tcin >> str >> answer;\n\n\tbool flagL = false;\n\tbool flagM = false;\n\n\tint ansL = str[0] - '0';\n\n\tfor (int i = 1; i < str.size(); i += 2) {\n\t\tif (str[i] == '+') {\n\t\t\tansL += str[i + 1] - '0';\n\t\t}\n\t\telse if (str[i] == '*') {\n\t\t\tansL *= str[i + 1] - '0';\n\t\t}\n\t}\n\n\tif (ansL == answer) {\n\t\tflagL = true;\n\t}\n\n\tint ansM = 0;\n\tvector<int> num;\n\tvector<char> calc;\n\n\tfor (int i = 0; i < str.size(); i++) {\n\t\tif (str[i] == '+') {\n\t\t\tcalc.push_back(str[i]);\n\t\t}\n\t\telse if (str[i] == '*') {\n\t\t\tcalc.push_back(str[i]);\n\t\t}\n\t\telse {\n\t\t\tnum.push_back(str[i] - '0');\n\t\t}\n\t}\n\n\twhile (true) {\n\t\tbool flag = false;\n\n\t\tfor (int i = 0; i < calc.size(); i++) {\n\t\t\tif (calc[i] == '*') {\n\t\t\t\tnum[i] = num[i] * num[i + 1];\n\t\t\t\tnum.erase(num.begin() + i + 1);\n\t\t\t\tcalc.erase(calc.begin() + i);\n\t\t\t\tflag = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (flag == true) {\n\t\t\tcontinue;\n\t\t}\n\t\telse {\n\t\t\tfor (int i = 0; i < num.size(); i ++) {\n\t\t\t\tansM += num[i];\n\t\t\t}\n\n\t\t\tif (ansM == answer) {\n\t\t\t\tflagM = true;\n\t\t\t}\n\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (flagL == true && flagM == true) {\n\t\tcout << \"U\" << endl;\n\t}\n\telse if (flagL == true) {\n\t\tcout << \"L\" << endl;\n\t}\n\telse if (flagM == true) {\n\t\tcout << \"M\" << endl;\n\t}\n\telse {\n\t\tcout << \"I\" << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing vi=vector<int>;\n#define all(a) a.begin(),a.end()\n\nint main(){\n\tint l=0,n=0,p;\n\tvector<int> a(1);\n\tstring s;\n\tcin>>s>>p;\n\t\n\tl=a[0]= s[0]-'0';\n\tfor(int i=2; i<s.size()/2 ;i+=2){\n\t\tint t=s[i]-'0';\n\t\tif(s[i-1]=='*'){\n\t\t\tl*=t;\n\t\t\ta.back()*=t;\n\t\t}else{\n\t\t\tl+=t;\n\t\t\ta.push_back(t);\n\t\t}\n\t}\n\tn=accumulate(all(a),0);\n\tcout<<\"ILMU\"[l==p?1:0 + n==p?2:0]<<endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <list>\n#include <vector>\n#include <complex>\n#include <utility>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <bitset>\n#include <ctime>\n#include <map>\n#include <unordered_map>\n#include <set>\n#include <unordered_set>\n#include <cassert>\n#include <cstddef>\n#include <iomanip>\n#include <numeric>\n#include <tuple>\n#include <sstream>\n#include <fstream>\n\nusing namespace std;\n#define REP(i, n) for (int (i) = 0; (i) < (n); (i)++)\n#define FOR(i, a, b) for (int (i) = (a); (i) < (b); (i)++)\n#define RREP(i, a) for(int (i) = (a) - 1; (i) >= 0; (i)--)\n#define FORR(i, a, b) for(int (i) = (a) - 1; (i) >= (b); (i)--)\n#define DEBUG(C) cerr << #C << \" = \" << C << endl;\nusing LL = long long;\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing VL = vector<LL>;\nusing VVL = vector<VL>;\nusing VD = vector<double>;\nusing VVD = vector<VD>;\nusing PII = pair<int, int>;\nusing PDD = pair<double, double>;\nusing PLL = pair<LL, LL>;\nusing VPII = vector<PII>;\ntemplate<typename T> using VT = vector<T>;\n#define ALL(a) begin((a)), end((a))\n#define RALL(a) rbegin((a)), rend((a))\n#define SORT(a) sort(ALL((a)))\n#define RSORT(a) sort(RALL((a)))\n#define REVERSE(a) reverse(ALL((a)))\n#define MP make_pair\n#define FORE(a, b) for (auto &&a : (b))\n#define FIND(s, e) ((s).find(e) != (s).end())\n#define EB emplace_back\ntemplate<typename T>inline bool chmax(T &a,T b){if(a<b){a=b;return true;}return false;}\ntemplate<typename T>inline bool chmin(T &a,T b){if(a>b){a=b;return true;}return false;}\n\nconst int INF = 1e9;\nconst int MOD = INF + 7;\nconst LL LLINF = 1e18;\n\nchar strbuf[1000];\nstring s;\nint ans;\n\nint leftToRightCalc(string s) {\n    const int L = s.length();\n    int res = s[0] - '0';\n    bool premul = false;\n    FOR(i, 1, L) {\n        if (isdigit(s[i])) {\n            if (premul) {\n                res *= s[i] - '0';\n            } else {\n                res += s[i] - '0';\n            }\n        } else {\n            premul = s[i] == '*';\n        }\n    }\n    return res;\n}\nint mulFirstCalc(string s) {\n    string news = \"\";\n    int res = 0;\n    REP(i, s.length()) {\n        if (isdigit(s[i]) || s[i] == '+') {\n            news += s[i];\n        } else {\n            char c = news.back() - '0';\n            news.pop_back();\n            while (news.back() == '+') news.pop_back();\n            char c2 = s[++i] - '0';\n            res += (c * c2);\n        }\n    }\n    //DEBUG(news)\n    return res + leftToRightCalc(news);\n}\n\nint main(void) {\n    scanf(\"%s\", strbuf);\n    s = strbuf;\n    scanf(\"%d\", &ans);\n    int ltr = leftToRightCalc(s);\n    int mf = mulFirstCalc(s);\n    //DEBUG(ltr) DEBUG(mf)\n    if (ans == mf && ans != ltr) {\n        putchar('M');\n    } else if (ans != mf && ans == ltr) {\n        putchar('L');\n    } else if (ans == mf && ans == ltr) {\n        putchar('U');\n    } else {\n        putchar('I');\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  string s; cin>>s;\n  long long int ans; cin>>ans;\n\n  long long int m_rule=0;\n  for(int i=0;i<s.size();i++){\n    if(s[i]=='*'){\n      long long int pro=s[i-1]-'0';\n      for(i=i+2;i<s.size();i+=2){\n\tif(s[i]=='*'){\n\t  pro*=s[i-1]-'0';\n\t}\n\telse{\n\t  break;\n\t}\n      }\n      pro*=s[i-1]-'0';\n      m_rule+=pro;\n    }\n  }\n  if(s.size()==1) m_rule=s[0]-'0';\n  if(s.size()>1  && s[1]=='+') m_rule+=s[0]-'0';\n  if(s.size()>2 && s[s.size()-2]=='+') m_rule+=s[s.size()-1]-'0';\n  for(int i=2;i+1<s.size();i++){\n    if(s[i-1]=='+' && s[i+1]=='+'){\n      m_rule+=s[i]-'0';\n    }\n  }\n\n  long long int l_rule=s[0]-'0';\n  for(int i=1;i<s.size();i+=2){\n    if(s[i]=='+') l_rule+=s[i+1]-'0';\n    else l_rule*=s[i+1]-'0';\n  }\n\n  if(l_rule==ans && m_rule==ans) cout<<\"U\"<<endl;\n  else if(l_rule==ans) cout<<\"L\"<<endl;\n  else if(m_rule==ans) cout<<\"M\"<<endl;\n  else cout<<\"I\"<<endl;\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\nint calc1(string str){//multiplication-first\n\tstack<int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push(stoi(rststr));\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10(stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10(tmp)+1);\n\t\t\tint tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10(tmp)+1);\n\t\t}\n\t}\n\tint rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nint calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tint rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10(rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nint calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10(stoi(rststr))+1);\n\tint rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10(tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10(tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\tcin >> str;\n\tint ans;\n\tcin >> ans;\n\tint rst1 = calc1(str);\n\tint rst2 = calc3(str);\n\t//cout << rst1 << \" \" << rst2 << endl;\n\tif(rst1==ans){\n\t\tif(rst2==ans) cout << 'U' << endl;\n\t\telse cout << 'M' << endl;\n\t}else{\n\t\tif(rst2==ans) cout << 'L' << endl;\n\t\telse cout << 'I' << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr,__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\n\nint main() {\n    string line;\n    int ans;\n    cin >> line;\n    cin >> ans;\n    vi ns;\n    vb ops;\n    for (int i = 0; i < line.length()-1; i += 2) {\n        ns.push_back(line[i] - '0');\n        ops.push_back(line[i+1] == '+');\n    }\n    ns.push_back(line[line.length()-1] - '0');\n\n    int L = ns[0];\n    FOR(i, 1, ns.size()) {\n        if (ops[i-1]) {\n            L += ns[i];\n        } else {\n            L *= ns[i];\n        }\n    }\n\n    FOR(i, 1, ns.size()) {\n        if (!ops[i-1]) {\n            ns[i] = ns[i-1] * ns[i];\n            ns[i-1] = 0;\n        }\n    }\n    int M = accumulate(ALL(ns), 0);\n\n    if (ans == M && ans == L) {\n        cout << \"U\" << endl;\n    } else if (ans == M) {\n        cout << \"M\" << endl;\n    } else if (ans == L) {\n        cout << \"L\" << endl;\n    } else {\n        cout << \"I\" << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\ntypedef long long ll;\n\nll leftrule(string s)\n{\n\tll ret=0;\n\tint i=0;\n\tif(s.size()==1)\n\t\treturn s[0]-'0';\n\t\n\tret=s[0]-'0';\n\ti++;\n\twhile(i<s.size())\n\t{\n\t\tif(s[i]=='+')\n\t\t{\n\t\t\tret+=(s[i+1]-'0');\n\t\t\ti+=2;\n\t\t}else{\n\t\t\tret*=(s[i+1]-'0');\n\t\t\ti+=2;\n\t\t}\n\t}\n\treturn ret;\n}\n\nll multirule(string s)\n{\n\tvector<ll> num;\n\tvector<bool> op;\n\tll ret=0;\n\tif(s.size()==1)\n\t\treturn s[0]-'0';\n\t\n\tfor(int i=0;i<s.size();i++)\n\t{\n\t\tif(s[i]=='+')\n\t\t\top.push_back(false);\n\t\telse if(s[i]=='*')\n\t\t\top.push_back(true);\n\t\telse\n\t\t\tnum.push_back(s[i]-'0');\n\t}\n\tint j=0;\n\tret=num[0];\n\tfor(int i=1;i<num.size();i++)\n\t{\n\t\tif(op[j])\n\t\t{\n\t\t\tret*=num[i];\n\t\t\tj++;\n\t\t}else{\n\t\t\tj++;\n\t\t\tll tmp=num[i];\n\t\t\twhile(op[j])\n\t\t\t{\n\t\t\t\tif(j==op.size())\n\t\t\t\t\tbreak;\n\t\t\t\ti++;\n\t\t\t\ttmp*=num[i];\n\t\t\t\tj++;\n\t\t\t}\n\t\t\tret+=tmp;\n\t\t}\n\t}\n\treturn ret;\n}\n\nint main()\n{\n\tstring s;\n\tstring ss=\"ILMU\";\n\tll a;\n\tint ans=0;\n\tcin>>s;\n\tcin>>a;\n\tll l=leftrule(s);\n\t//cerr<<l<<endl;\n\tll m=multirule(s);\n\t//cerr<<m<<endl;\n\tif(a==l)\n\t\tans+=1;\n\tif(a==m)\n\t\tans+=2;\n\tcout<<ss[ans]<<endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <list>\n#include <vector>\n#include <complex>\n#include <utility>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <bitset>\n#include <ctime>\n#include <map>\n#include <unordered_map>\n#include <set>\n#include <unordered_set>\n#include <cassert>\n#include <cstddef>\n#include <iomanip>\n#include <numeric>\n#include <tuple>\n#include <sstream>\n#include <fstream>\n\nusing namespace std;\n#define REP(i, n) for (int (i) = 0; (i) < (n); (i)++)\n#define FOR(i, a, b) for (int (i) = (a); (i) < (b); (i)++)\n#define RREP(i, a) for(int (i) = (a) - 1; (i) >= 0; (i)--)\n#define FORR(i, a, b) for(int (i) = (a) - 1; (i) >= (b); (i)--)\n#define DEBUG(C) cerr << #C << \" = \" << C << endl;\nusing LL = long long;\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing VL = vector<LL>;\nusing VVL = vector<VL>;\nusing VD = vector<double>;\nusing VVD = vector<VD>;\nusing PII = pair<int, int>;\nusing PDD = pair<double, double>;\nusing PLL = pair<LL, LL>;\nusing VPII = vector<PII>;\ntemplate<typename T> using VT = vector<T>;\n#define ALL(a) begin((a)), end((a))\n#define RALL(a) rbegin((a)), rend((a))\n#define SORT(a) sort(ALL((a)))\n#define RSORT(a) sort(RALL((a)))\n#define REVERSE(a) reverse(ALL((a)))\n#define MP make_pair\n#define FORE(a, b) for (auto &&a : (b))\n#define FIND(s, e) ((s).find(e) != (s).end())\n#define EB emplace_back\ntemplate<typename T>inline bool chmax(T &a,T b){if(a<b){a=b;return true;}return false;}\ntemplate<typename T>inline bool chmin(T &a,T b){if(a>b){a=b;return true;}return false;}\n\nconst int INF = 1e9;\nconst int MOD = INF + 7;\nconst LL LLINF = 1e18;\n\nchar strbuf[1000];\nstring s;\nint ans;\n\nint leftToRightCalc(string s) {\n    const int L = s.length();\n    if (L == 0) return 0;\n    int res = s[0] - '0';\n    bool premul = false;\n    FOR(i, 1, L) {\n        if (isdigit(s[i])) {\n            if (premul) {\n                res *= s[i] - '0';\n            } else {\n                res += s[i] - '0';\n            }\n        } else {\n            premul = s[i] == '*';\n        }\n    }\n    return res;\n}\nint mulFirstCalc(string s) {\n    string news = \"\";\n    int res = 0;\n    bool premul = false;\n    REP(i, s.length()) {\n        if (s[i] == '+') continue;\n        if (isdigit(s[i])) {\n            news += s[i];\n            premul = false;\n        } else {\n            //DEBUG(news)\n            int c = news.back() - '0';\n            if (!premul) news.pop_back();\n            while (!premul && news.back() == '+') news.pop_back();\n            int c2 = s[++i] - '0';\n            res += (c * c2);\n            premul = true;\n        }\n    }\n    //DEBUG(news)\n    return res + leftToRightCalc(news);\n}\n\nint main(void) {\n    scanf(\"%s\", strbuf);\n    s = strbuf;\n    scanf(\"%d\", &ans);\n    int ltr = leftToRightCalc(s);\n    //DEBUG(ltr)\n    int mf = mulFirstCalc(s);\n    //DEBUG(mf)\n    if (ans == mf && ans != ltr) {\n        puts(\"M\");\n    } else if (ans != mf && ans == ltr) {\n        puts(\"L\");\n    } else if (ans == mf && ans == ltr) {\n        puts(\"U\");\n    } else {\n        puts(\"I\");\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint l_r_rule(string s){\n  int len=s.length();\n  int res=0;\n  char ope='+';\n  for(int i=0;i<len;i++){\n    if(i%2==0){//??°???\n      if(ope=='+') res+=(s[i]-48);\n      else res*=(s[i]-48);\n    }\n    else ope=s[i];\n  }\n  return res;\n}\n\nint m_f_rule(string s){\n  s+='+';\n  int len=s.length();\n  std::vector<int> v;\n  int tmp=-1;\n  for(int i=0;i<len/2;i++){\n    if(s[i*2+1]=='+'){\n      if(tmp==-1) v.push_back((s[i*2]-48));\n      else v.push_back(tmp);\n      tmp=-1;\n    }\n    else{\n      if(tmp==-1) tmp=(s[i*2]-48);\n      //cout <<tmp<<endl;\n      tmp*=(s[i*2+2]-48);\n      //cout <<tmp<<endl;\n    }\n  }\n  int vlen=v.size();\n  int res=0;\n  for(int i=0;i<vlen;i++) res+=v[i];\n  return res;\n}\n\nint main(){\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n\n  string s;int n;\n  cin>>s>>n;\n  int mans=m_f_rule(s);\n  int lans=l_r_rule(s);\n  // cout << mans<<\" \"<<lans<<endl;\n  if(mans==n&&lans==n) cout <<\"U\"<<endl;\n  else if(mans==n) cout <<\"M\"<<endl;\n  else if(lans==n) cout << \"L\"<<endl;\n  else cout <<\"I\"<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <ctime>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cmath>\n#include <sstream>\n#include <utility>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef pair<int,int> pii;\n#define all(c) (c).begin(), (c).end()\n#define loop(i,a,b) for(ll i=a; i<ll(b); i++)\n#define rep(i,b) loop(i,0,b)\n#define each(e,c) for(auto&e:c)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define lb lower_bound\n#define ub upper_bound\n#ifdef DEBUG\n#define dump(...) (cerr<<#__VA_ARGS__<<\" = \"<<(DUMP(),__VA_ARGS__).str()<<\" [\"<<__LINE__<<\"]\"<<endl)\nstruct DUMP:ostringstream{template<class T>DUMP &operator,(const T&t){if(this->tellp())*this<<\", \";*this<<t;return *this;}};\n#else\n#define dump(...)\n#endif\ntemplate<class T> ostream& operator<<(ostream& os, vector<T> const& v){\n    rep(i,v.size()) os << v[i] << (i+1==v.size()?\"\":\" \");\n    return os;\n}\n\nint parseL(string s){\n    int res = s[0]-'0';\n    for(int i=1;i<s.size();i+=2){\n        if(s[i]=='*') res*=s[i+1]-'0';\n        else res+=s[i+1]-'0';\n    }\n    return res;\n}\n\nint parseM(string s){\n    rep(i,s.size()){\n        if(s[i]=='*'){\n            char str[10]={};\n            str[0] = ('0'+(s[i-1]-'0')*(s[i+1]-'0'));\n            return parseM(s.substr(0,i-1)+str+s.substr(i+2));\n        }\n    }\n    return parseL(s);\n}\n\nint main(){\n    string s;\n    while(cin >> s){\n    ll x; cin >> x;\n    int a = parseM(s);\n    int b = parseL(s);\n    char ans;\n    if(x==a && x==b) ans = 'U';\n    else if(x==a) ans = 'M';\n    else if(x==b) ans = 'L';\n    else ans = 'I';\n    cout << ans << endl;\n}\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n#define MAX 25\n\nchar ch[MAX], ch1[MAX];\nint len;\n\nint go1(void){\n\tint i, j;\n\tfor (i=1;i<=len;i++){\n\t\tif (ch[i]>='0' && ch[i]<='9') ch[i]-='0';\n\t}\n\tfor (i=3;i<=len;i++){\n\t\tif (ch[i-1]=='*'){\n\t\t\tch[i-2]*=ch[i];\n\t\t\tfor (j=i+1;j<=len;j++){\n\t\t\t\tch[j-2]=ch[j];\n\t\t\t}\n\t\t\tlen-=2;\n\t\t\ti--;\n\t\t}\n\t}\n\n\tfor (i=3;i<=len;i++){\n\t\tif (ch[i-1]=='+'){\n\t\t\tch[i-2]+=ch[i];\n\t\t\tfor (j=i+1;j<=len;j++){\n\t\t\t\tch[j-2]=ch[j];\n\t\t\t}\n\t\t\tlen-=2;\n\t\t\ti--;\n\t\t}\n\t}\n\treturn ch[1];\n}\n\nint go2(void){\n\tint i, j;\n\tfor (i=1;i<=len;i++){\n\t\tif (ch1[i]>='0' && ch1[i]<='9') ch1[i]-='0';\n\t}\n\tfor (i=3;i<=len;i++){\n\t\tif (ch1[i-1]=='+'){\n\t\t\tch1[i-2]+=ch1[i];\n\t\t}else if (ch1[i-1]=='*'){\n\t\t\tch1[i-2]*=ch1[i];\n\t\t}else continue;\n\t\tfor (j=i+1;j<=len;j++){\n\t\t\tch1[j-2]=ch1[j];\n\t\t}\n\t\tlen-=2;\n\t\ti--;\n\t}\n\treturn ch1[1];\n}\n\nint main(void){\n\tint r1, r2, bu;\n\tscanf(\"%s\", &ch[1]);\n\tlen=strlen(&ch[1]);\n\tstrcpy(&ch1[1], &ch[1]);\n\tbu=len;\n\tr1=go1();\n\tlen=bu;\n\tr2=go2();\n\tint n;\n\tscanf(\"%d\", &n);\n\tif (r1==n && r2==n) printf(\"U\\n\");\n\telse if (r1==n) printf(\"M\\n\");\n\telse if (r2==n) printf(\"L\\n\");\n\telse printf(\"I\\n\");\n\treturn false;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <string>\n#include <cmath>\n#include <iostream>\n#include <algorithm>\n#include <stack>\n#include <queue>\n#include <vector>\n#include <set>\n#include <map>\nusing namespace std;\n\n#define repl(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<pii, int> ppi;\n\n#define INF 1000000000\n\nchar l[20];\nint idx;\n\nint term(){\n  int ret=l[idx++] - '0';\n  while(l[idx]=='*'){\n    idx++;\n    ret *= l[idx++] - '0';\n  }\n  return ret;\n}\n\nint m_eval(){\n  idx=0;\n  int ret=term();\n  while(l[idx] != '\\0'){\n    idx++; // skip '+'\n    ret += term();\n  }\n  return ret;\n}\n\nint l_eval(){\n  int ret=0;\n  idx=0;\n  while(l[idx]!='\\0'){\n    if(l[idx] == '+'){\n      idx++;\n    } else if(l[idx] == '*'){\n      idx++;\n      ret *= l[idx++] - '0';\n    } else {\n      ret += l[idx++] - '0';\n    }\n  }\n  return ret;\n}\n\nint main(){\n  int bob;\n  scanf(\"%s\\n%d\", l, &bob);\n\n  idx=0;\n  int m = m_eval();\n  int l = l_eval();\n\n  if(bob==m && bob==l){\n    cout << \"U\" << endl;\n  } else if(bob==m && bob!=l){\n    cout << \"M\" << endl;\n  } else if(bob==l){\n    cout << \"L\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define mp make_pair\n#define pb push_back\n#define F first\n#define S second\n#define endl '\\n'\n#define ALL(a) (a).begin(),(a).end()\n#define SZ(a) (int)((a).size())\ntypedef long long ll;\ntypedef pair<int,int> PI;\n\nint main(int argc, char *argv[])\n{\n  string ex;\n  cin >> ex;\n  int m;\n  cin >> m;\n  int n = ex.size();\n\n  ll nor = 0;\n  ll gre = ex[0] - '0';\n\n  for(int i = 1; i <n;++i){\n    char op = ex[i];\n    ++i;\n    if(op=='*') gre *= ex[i]-'0';\n    else gre += ex[i] - '0';\n  }\n\n  for(int i = 0; i < n; ++i){\n    ll nu = ex[i] - '0';\n    while(i+1 < n && ex[i+1] == '*'){\n      i+=2;\n      nu *= ex[i] - '0';\n    }\n    nor += nu;\n    ++i;\n  }\n\n  if(nor == gre && nor==m) cout << 'U' << endl;\n  if(nor ==m && gre != m) cout << 'M' << endl;\n  if(nor !=m && gre == m) cout << 'L' << endl;\n  if(nor !=m && gre != m) cout << 'I' << endl;  \n  //cout << nor << \" \" << gre << endl;\n  \n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n\nusing namespace std;\n\nchar s[25];\nint n, l; \n\nint calc1(){\n\tchar last = '+';\n\tint l = strlen(s);\n\tint ret = 0; \n\tfor(int i = 0; i < l; i += 2){\n\t\tint d = s[i] - '0';\n\t\tif(last == '+') ret += d;\n\t\telse ret *= d;\n\t\tlast = s[i + 1]; \n\t}\n\treturn ret;\n} \n\nint calc2(){\n\tchar last = '*';\n\tint ret = 0, mul = 1;\n\tint l = strlen(s);\n\tfor(int i = 0; i < l; i += 2){\n\t\tint d = s[i] - '0';\n\t\tif(last == '+') ret += mul, mul = d;\n\t\telse mul *= d;\n\t\t//printf(\"mul = %d ret = %d\\n\", mul, ret);\n\t\tlast = s[i + 1];\n\t} \n\tret += mul;\n\treturn ret;\n}\n\nint main(){\n\twhile(scanf(\"%s%d\", s, &n) == 2) {\n\t\tint l = strlen(s); s[l] = '+'; s[l + 1] = 0; \n\t\tint ans1 = calc1(), ans2 = calc2();\n\t\t//printf(\"%d %d\\n\", ans1, ans2);\n\t\tif(ans1 == n && ans2 == n) puts(\"U\");\n\t\telse if(ans1 != n && ans2 != n) puts(\"I\");\n\t\telse if(ans1 == n) puts(\"L\");\n\t\telse puts(\"M\"); \n\t\t\n\t}\n\treturn 0;\n} "
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  string s;\n  int n;\n  cin >> s >> n;\n\n  stack<int> t;\n  t.push(s[0]-'0');\n  for(int i=1;i<s.size();i+=2){\n    int tmp = s[i+1]-'0';\n    if(s[i] == '*')t.top() *= tmp;\n    else t.push(tmp);\n  }\n  int M = 0;\n  while(t.size()){\n    M += t.top(), t.pop();\n  }\n\n  int L = s[0]-'0';\n  for(int i=1;i<s.size();i+=2){\n    int tmp = s[i+1]-'0';\n    if(s[i] == '*')L *= tmp;\n    else L += tmp;\n  }\n\n  if(M == n && L == n)cout << \"U\";\n  else if(M == n)cout << \"M\";\n  else if(L == n)cout << \"L\";\n  else cout << \"I\";\n  cout << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#include<cctype>\n#include<math.h>\n#include<string>\n#include<string.h>\n#include<stack>\n#include<queue>\n#include<vector>\n#include<utility>\n#include<set>\n#include<map>\n#include<stdlib.h>\n#include<iomanip>\n\nusing namespace std;\n\n#define ll long long\n#define ld long double\n#define EPS 0.0000000001\n#define INF 1e9\n#define MOD 1000000007\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define loop(i,a,n) for(i=a;i<(n);i++)\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\n\n\nstring s;\nint ind;\n\nint number(){\n    int ret = s[ind] - '0';\n    ind++;\n    return ret;\n}\n\nint term(){\n    int ret = number();\n    while(1){\n        if(s[ind] == '*'){\n            ind++;\n            ret *= number();\n        }else{\n            break;\n        }\n    }\n    return ret;\n}\n\nint expression(){\n    int ret = term();\n    while(1){\n        if(s[ind] == '+'){\n            ind++;\n            ret += term();\n        }else{\n            break;\n        }\n    }\n    return ret;\n}\nint f(){\n    int ret = number();\n    while(1){\n        if(s[ind] == '+'){\n            ind++;\n            ret += number();\n        }else if(s[ind] == '*'){\n            ind++;\n            ret *= number();\n        }else{\n            break;\n        }\n    }\n    return ret;\n}\nint main(void) {\n    int i,j;\n    cin >> s;\n    int x;\n    cin >> x;\n    ind = 0;\n    int ans1 = expression();\n    ind = 0;\n    int ans2 = f();\n    if(ans1 == x && ans2 == x){\n        cout << \"U\" << endl;\n    }else if(ans1 == x){\n        cout << \"M\" << endl;\n    }else if(ans2 == x){\n        cout << \"L\" << endl;\n    }else{\n        cout << \"I\" << endl;\n    }\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <stack>\n#include <queue>\n\nusing namespace std;\n\nint main()\n{\n    stack<int> stk;\n\n    // input\n    string str;\n    int result;\n    cin >> str >> result;\n\n    // calc M pattern\n    int mresult = 0;\n    int n;\n    for (int i = 0; i < (int)str.size(); i++) {\n        switch (str[i]) {\n        case '*':\n            n = stk.top(); stk.pop();\n            stk.push(n*(str[i+1]-'0'));\n            i++;\n            break;\n        case '+':\n            break;\n        default:\n            stk.push(str[i]-'0');\n            break;\n        }\n    }\n    while (!stk.empty()) {\n        int a = stk.top(); stk.pop();\n        mresult += a;\n    }\n\n    // calc L pattern\n    int lresult = str[0]-'0';\n    for (int i = 1; i < (int)str.size(); i++) {\n        switch (str[i]) {\n        case '*':\n            lresult *= str[i+1]-'0';\n            break;\n        case '+':\n            lresult += str[i+1]-'0';\n            break;\n        default:\n            break;\n        }\n    }\n\n    // output\n    if (result == mresult) {\n        if (result == lresult)\n            cout << \"U\" << endl;\n        else\n            cout << \"M\" << endl;\n    } else {\n        if (result == lresult)\n            cout << \"L\" << endl;\n        else\n            cout << \"I\" << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//#include <stdio.h>\n//#include <iostream>\n//#include <math.h>\n//#include <numeric>\n//#include <vector>\n//#include <map>\n//#include <functional>\n//#include <stdio.h>\n//#include <array>\n//#include <algorithm>\n//#include <string>\n//#include <assert.h>\n//#include <stdio.h>\n//#include <queue>\n//#include<iomanip>\n//using namespace std;\n//\n//\n//using namespace std;\n////\n////#define N (1<<17) \n////// update(l,r,v) := [l,r]の区間に対してvを一様に足す. k,a,bは飾り\n////\n////struct NODE{\n////\tint sum;//更新された値. この値を参照する時は評価が完全に完了しているようにする.\n////\tint lazy;\t//遅延されている値を保存している\n////\tNODE(){\n////\t\tsum = lazy = 0;\n////\t}\n////};\n////\n////NODE seg[2 * N];\n////\n////// inlineつけないと大変なことになるよ!(遅い)\n////inline void lazy_evaluate_node(int k, int a, int b){\n////\tseg[k].sum +=seg[k].lazy;\n////\tif (k < N){ // 2*k(左の子番号) < 2*N (節点の数) のイメージで. 末端ノードじゃなきゃ伝搬するのと等価.\n////\t\tseg[2 * k].lazy += seg[k].lazy;\t//次は君が伝搬してね☆って感じ.\n////\t\tseg[2 * k + 1].lazy += seg[k].lazy;\n////\t}\n////\tseg[k].lazy = 0;\n////}\n////\n////inline void update_node(int k){ // kの子が既に評価されていることが前提. 末端以外のときしか呼び出さないような位置に書くのでif文要らない.\n////\tseg[k].sum = min(seg[2 * k].sum , seg[2 * k + 1].sum);\n////}\n////\n////// update(l,r,v) := [l,r]を更新する. 区間は1-indexed.\n////void update(int l, int r, int v, int k = 1, int a = 1, int b = N){\n////\tlazy_evaluate_node(k, a, b); \t// とりあえず辿ったノードは都合がいいので伝搬しとけ精神.\n////\n////\tif (b < l || r < a) //[a,b]と[l,r]が交差している場合\n////\t\treturn;\n////\tif (l <= a && b <= r){ // [l,r]が[a,b]を完全に含んでいる場合\n////\t\tseg[k].lazy += v;\n////\t\tlazy_evaluate_node(k, a, b); //一回遅延評価しとかないと都合悪いので.\n////\t\treturn;\n////\t}\n////\n////\tint m = (a + b) / 2;\n////\tupdate(l, r, v, 2 * k, a, m);\n////\tupdate(l, r, v, 2 * k + 1, m + 1, b);\n////\tupdate_node(k);\n////}\n////\n////// get(l,r) := [l,r]に対するクエリの答えを得る. 区間は1-indexed.\n////int get(int l, int r, int k = 1, int a = 1, int b = N){\n////\tlazy_evaluate_node(k, a, b); // とりあえず辿ったノードは都合がいいので伝搬しとけ精神.\n////\n////\tif (b < l || r < a) //[a,b]と[l,r]が交差している場合\n////\t\treturn 0;\n////\n////\tif (l <= a && b <= r){ // [l,r]が[a,b]を完全に含んでいる場合\n////\t\treturn seg[k].sum;\n////\t}\n////\n////\tint m = (a + b) / 2;\n////\tint vl = get(l, r, 2 * k, a, m);\n////\tint vr = get(l, r, 2 * k + 1, m + 1, b);\n////\tupdate_node(k);\n////\treturn min(vl , vr);\n////}\n//\n//\n//int main() {\n//\t//int n;\n//\t//cin >> n;\n//\t//vector<int> aa(n);\n//\t//vector<pair<int,int>>aaa;\n//\t//for (int i = 0; i < n; ++i){\n//\t//\tint a, b;\n//\t//\tcin >> a >> b;\n//\t//\taaa.push_back(make_pair(a, b)); \n//\t//\taa[a]++;\n//\t//\taa[b]--;\n//\t//}\n//\t//vector<int> ans;\n//\t//ans.push_back(aa[0]);\n//\t//int amin=99999999;\n//\t//for(int i=0;i<n;++i){\n//\t//\tans.push_back(ans[i] + aa[i]);\n//\t//}\n//\n//\t//RMQ r;\n//\t//r.init(65536);\n//\t//for (int i = 0; i < 65536;++i){\n//\t//\tr.update(i, ans[i]);\n//\t//}\n//\n//\t//cout << r.query(0, 7) << endl; //1\n//\t//cout << r.query(3, 6) << endl; //2\n//\t//cout << r.query(1, 5) << endl; //1\n//\t//cout << r.query(5, 7) << endl; //4\n//\t//return 0;\n//\n//\tvector<long long int>times;\n//\tfor (int i = 0; i < 7; ++i){\n//\t\tlong long int c;\n//\t\tcin >> c;\n//\t\ttimes.push_back(c);\n//\t}\n//\tif (times[0] == 0)cout << \"YES\" << endl;\n//\telse{\n//\t\ttimes[0]--;\n//\t}\n//\n//\t{\n//\t\tvector<long long int> atimes(times);\n//\t\twhile (1){\n//\t\t\tauto zero_it = find(atimes.begin(), atimes.end(), 0);\n//\t\t\tif (zero_it != atimes.end()){//5 3 2 0 4 4 2 \n//\t\t\t\tconst int num = zero_it - atimes.begin();\n//\t\t\t\tint from = num;\n//\t\t\t\twhile (1){\n//\t\t\t\t\tfrom = (from + 1) % 7;\n//\t\t\t\t\tif (from == num)break;\n//\t\t\t\t\tint to = (from + 1) % 7;\n//\t\t\t\t\tif (atimes[from] != 0 && atimes[to] == 0){\n//\t\t\t\t\t\tbreak;\n//\t\t\t\t\t}\n//\t\t\t\t\tif (atimes[from] > atimes[to]){\n//\t\t\t\t\t\tbreak;\n//\t\t\t\t\t}\n//\t\t\t\t\tlong long int amin = min(atimes[from], atimes[to]);\n//\t\t\t\t\tatimes[from] -= amin;\n//\t\t\t\t\tatimes[to] -= amin;\n//\t\t\t\t\tif (atimes[from] == 0 && atimes[to] == 0){\n//\t\t\t\t\t\tbreak;\n//\t\t\t\t\t}\n//\t\t\t\t}\n//\t\t\t\tif (all_of(atimes.begin(), atimes.end(), [](const int aaa){return aaa == 0; })){\n//\t\t\t\t\tcout << \"YES\" << endl;\n//\t\t\t\t\treturn 0;\n//\t\t\t\t}\n//\t\t\t\telse{\n//\t\t\t\t\tbreak;\n//\t\t\t\t}\n//\t\t\t}\n//\t\t\telse{\n//\t\t\t\tlong long int aamin = atimes[0];\n//\t\t\t\tfor (int i = 0; i < 7; ++i){\n//\t\t\t\t\taamin = min(aamin, atimes[i]);\n//\t\t\t\t}\n//\t\t\t\tfor (int i = 0; i < 7; ++i){\n//\t\t\t\t\tatimes[i] -= aamin;\n//\t\t\t\t}\n//\t\t\t}\n//\t\t}\n//\t}\n//\t{\n//\t\tvector<long long int> btimes(times);\n//\t\tfor (int i = 0; i < 7; ++i){//times[i]のまえがあいだになる\n//\t\t\tbtimes = times;\n//\t\t\tint from = (i + 6) % 7;\n//\t\t\twhile (1){\n//\t\t\t\tfrom = (from + 1) % 7;\n//\t\t\t\tif (from == (i + 6) % 7)break;\n//\t\t\t\tint to = (from + 1) % 7;\n//\t\t\t\tif (btimes[from] != 0 && btimes[to] == 0){\n//\t\t\t\t\tbreak;\n//\t\t\t\t}\n//\t\t\t\tif (btimes[from] > btimes[to]){\n//\t\t\t\t\tbreak;\n//\t\t\t\t}\n//\t\t\t\tlong long int amin = min(btimes[from], btimes[to]);\n//\t\t\t\tbtimes[from] -= amin;\n//\t\t\t\tbtimes[to] -= amin;\n//\t\t\t\tif (btimes[from] == 0 && btimes[to] == 0){\n//\t\t\t\t\tbreak;\n//\t\t\t\t}\n//\t\t\t}\n//\t\t\tif (all_of(btimes.begin(), btimes.end(), [=](int a){return a == 0; })){\n//\t\t\t\tcout << \"YES\" << endl;\n//\t\t\t\treturn 0;\n//\t\t\t}\n//\t\t\telse{\n//\t\t\t\tcontinue;\n//\t\t\t}\n//\t\t}\n//\t}\n//\tcout << \"NO\" << endl;\n//\treturn 0;\n//}\n////3 4 4 4 4 4 4\n\n#include<stdio.h>\n#include <iostream>\n#include <math.h>\n#include <numeric>\n#include <vector>\n#include <map>\n#include <functional>\n#include <stdio.h>\n#include <array>\n#include <algorithm>\n#include <string>\n#include <assert.h>\n#include <stdio.h>\n#include <queue>\n#include<iomanip>\n#include<bitset>\n#include<stack>\nusing namespace std;\n\n//7:10\n//\n//#define REP(i,n) for(int i=0;i<(int)n;++i)\n//#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n//#define ALL(c) (c).begin(), (c).end()\n//\n//typedef int Weight;\n//struct Edge {\n//\tint src, dst;\n//\tWeight weight;\n//\tEdge(int src, int dst, Weight weight) :\n//\t\tsrc(src), dst(dst), weight(weight) { }\n//};\n//bool operator < (const Edge &e, const Edge &f) {\n//\treturn e.weight != f.weight ? e.weight > f.weight : // !!INVERSE!!\n//\te.src != f.src ? e.src < f.src : e.dst < f.dst;\n//}\n//typedef vector<Edge> Edges;\n//typedef vector<Edges> Graph;\n//\n//typedef vector<Weight> Array;\n//typedef vector<Array> Matrix;\n//\n//#define RESIDUE(s,t) (capacity[s][t]-flow[s][t])\n//Weight maximumFlow(const Graph &g, int s, int t) {\n//\tint n = g.size();\n//\tMatrix flow(n, Array(n)), capacity(n, Array(n));\n//\tREP(u, n) for (auto e = g[u].begin(); e != g[u].end();++e)capacity[e->src][e->dst] += e->weight;\n//\n//\tWeight total = 0;\n//\twhile (1) {\n//\t\tqueue<int> Q; Q.push(s);\n//\t\tvector<int> prev(n, -1); prev[s] = s;\n//\t\twhile (!Q.empty() && prev[t] < 0) {\n//\t\t\tint u = Q.front(); Q.pop();\n//\t\t\tfor (auto e = g[u].begin(); e != g[u].end(); ++e) if (prev[e->dst] < 0 && RESIDUE(u, e->dst) > 0) {\n//\t\t\t\tprev[e->dst] = u;\n//\t\t\t\tQ.push(e->dst);\n//\t\t\t}\n//\t\t}\n//\t\tif (prev[t] < 0) return total; // prev[x] == -1 <=> t-side\n//\t\tWeight inc = 999999999;\n//\t\tfor (int j = t; prev[j] != j; j = prev[j])\n//\t\t\tinc = min(inc, RESIDUE(prev[j], j));\n//\t\tfor (int j = t; prev[j] != j; j = prev[j])\n//\t\t\tflow[prev[j]][j] += inc, flow[j][prev[j]] -= inc;\n//\t\ttotal += inc;\n//\t}\n//\treturn total;\n//}\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define ALL(x) (x).begin(),(x).end()\n\n\nconst int mod = 1000000007;\n\nstruct Mod {\n\tlong long int num;\n\tMod() : num(0) { ; }\n\tMod(long long int n) : num((n % mod + mod) % mod) { ; }\n\toperator long long int() { return num; }\n};\n\nMod operator+(Mod a, Mod b) { return Mod((a.num + b.num) % mod); }\nMod operator-(Mod a, Mod b) { return Mod((mod + a.num - b.num) % mod); }\nMod operator*(Mod a, Mod b) { return Mod(((long long)a.num * b.num) % mod); }\nMod operator+=(Mod &a, Mod b) { return a = a + b; }\nMod operator-=(Mod &a, Mod b) { return a = a - b; }\nMod operator*=(Mod &a, Mod b) { return a = a * b; }\nMod operator^(Mod a, int n) {\n\tif (n == 0) return Mod(1);\n\tMod res = (a * a) ^ (n / 2);\n\tif (n % 2) res = res * a;\n\treturn res;\n}\nMod inv(Mod a) { return a ^ (mod - 2); }\nMod operator/(Mod a, Mod b) { return a * inv(b); }\n\n#define MAX_N 1024000\n\nMod fact[MAX_N], factinv[MAX_N];\nvoid init() {\n\tfact[0] = Mod(1); factinv[0] = 1;\n\tREP(i, MAX_N - 1) {\n\t\tfact[i + 1] = fact[i] * Mod(i + 1);\n\t\tfactinv[i + 1] = factinv[i] / Mod(i + 1);\n\t}\n}\nMod comb(int a, int b) {\n\treturn fact[a] * factinv[b] * factinv[a - b];\n}\n\nlong long int memo[20];//nけた\n\nlong long int powint(long long int a, int b){\n\tif (b == 0)return 1;\n\tif (b == 1)return a;\n\telse{\n\t\tlong long int ans = 1;\n\t\tlong long int c = powint(a, b / 2);\n\t\tans *= c*c;\n\t\tans *= (b % 2) ? a : 1;\n\t\treturn ans;\n\t}\n\n}\n\n\nint backnum[100000][20];\n\nstruct Node{\n\tNode(int aid):children(),ancs(){\n\t\tid=(aid);\n\t\tfor (int i = 0; i < 20; ++i){\n\t\t\tancs[i] = -1;\n\t\t}\n\t}\n\tint id;\n\tvector<int>children;\n\tarray<int, 20>ancs;\n};\n\nint main()\n{\n\tstring s;\n\tcin >> s;\n\tvector<int>nums;\n\tvector<int>fun;\n\tnums.push_back(s[0]-48);\n\tfor (int i = 0; i < (s.size()-1)/2; ++i){\n\t\tif (s[2 * i + 1] == '*'){\n\t\t\tfun.push_back(0);\n\t\t}\n\t\telse if (s[2 * i + 1] == '+'){\n\t\t\tfun.push_back(1);\n\t\t}\n\t\telse{\n\t\t\tassert(false);\n\t\t}\n\t\tnums.push_back(s[2 * i + 2]-48);\n\t}\n\tint aaa;\n\tcin >> aaa;\n\n\tbool lrok;\n\t//lefttoright\n\t{\n\t\tlong long int ans = nums[0];\n\t\tfor (int i = 1; i < nums.size();++i){\n\t\t\tif (fun[i - 1])ans += nums[i];\n\t\t\telse{\n\t\t\t\tans *= nums[i];\n\t\t\t}\n\t\t}\n\t\tlrok = (ans == aaa);\n\t}\n\t\n\tbool seok;\n\t//iiyatu\n\t{\n\t\twhile (1){\n\t\t\tauto it(find(fun.begin(), fun.end(), 0));\n\t\t\tif (it == fun.end())break;\n\t\t\tnums[(it - fun.begin())] *= nums[(it - fun.begin()) + 1];\n\t\t\tnums.erase(nums.begin() + (it - fun.begin()) + 1);\n\t\t\tfun.erase(it);\n\t\t}\n\n\t\tlong long int ans = nums[0];\n\t\tfor (int i = 1; i < nums.size();++i){\n\t\t\tif (fun[i - 1])ans += nums[i];\n\t\t\telse{\n\t\t\t\tans *= nums[i];\n\t\t\t}\n\t\t}\n\t\tseok = (ans == aaa);\n\t}\n\tstring k;\n\tif (lrok){\n\t\tif (seok){\n\t\t\tk = \"U\";\n\t\t}\n\t\telse{\n\t\t\tk = \"L\";\n\t\t}\n\t}\n\telse{\n\t\tif (seok){\n\t\t\tk = \"M\";\n\t\t}\n\t\telse{\n\t\t\tk = \"I\";\n\t\t}\n\t}\n\n\tcout << k << endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "// ACM-ICPCアジア地区予選2014 B. Miscalculation\n\n#include <iostream>\n#include <string>\n\nusing namespace std;\n\nint mul(const string& str, int& idx){\n\tint res = str[idx]-'0';\n\twhile(idx+1 < str.size() && str[idx+1]=='*'){\n\t\tidx += 2;\n\t\tres *= str[idx]-'0';\n\t}\n\treturn res;\n}\n\nint add(const string& str, int& idx){\n\tint res = mul(str, idx);\n\twhile(idx+1 < str.size() && str[idx+1] == '+'){\n\t\tidx += 2;\n\t\tres += mul(str, idx);\n\t}\n\treturn res;\n}\n\nint bob(const string& str, int& idx){\n\tint res = str[idx]-'0';\n\twhile(idx+1 < str.size()){\n\t\tif(str[idx+1] == '+') res += str[idx+2]-'0';\n\t\telse                  res *= str[idx+2]-'0';\n\t\tidx += 2;\n\t}\n\treturn res;\n}\n\nint main(){\n\tstring s; int d;\n\twhile(cin >> s >> d){\n\t\tint idx = 0;\n\t\tint a = add(s, idx);\n\t\tidx = 0;\n\t\tint b = bob(s, idx);\n\t\tif(a == d){\n\t\t\tcout << (b == d ? \"U\" : \"M\") << endl;\n\t\t} else {\n\t\t\tcout << (b == d ? \"L\" : \"I\") << endl;\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <stdio.h>\n#include <stdlib.h>\n#include <iostream>\n#include <vector>\n#include <string>\n#include <queue>\n#include <algorithm>\n#include <math.h>\n#include <utility>\n#include <set>\n#include <map>\n#include <cstring>\n#include <cstdio>\n#include <stack>\n#include <cmath>\n#define INF 1000000000\n#define rep(i,n) for(int i =0;i<n;i++)\nusing namespace std;\ntypedef long long int ll;\ntypedef pair<int, int> i_i;\n\n\nint main(){\n    string S;\n    int n;\n    cin >> S >> n;\n    int a=0,b=0;\n    vector<int> cal1(1000),cal2(1000);\n    int c1=0,c2=0;\n    for (int i=0; i<S.length(); i++) {\n        if (S[i]=='+') {\n            int c = cal1[c1];\n            int num = c + (int)S[i+1]-(int)'0';\n            cal1[c1]=num;\n            i++;\n            continue;\n        }\n        if (S[i]=='*') {\n            int a = cal1[c1];\n            int num = a *((int)S[i+1]-(int)'0');\n            cal1[c1]=num;\n            i++;\n            continue;\n        }\n        c1++;\n        cal1[c1]= (int)S[i]-(int)'0';\n    }\n    a = cal1[c1];\n    for (int i=0; i<S.length(); i++) {\n        if (S[i]=='+') {\n            c2++;\n            cal2[c2]=-1;\n            continue;\n        }\n        if (S[i]=='*') {\n            int a = cal2[c2];\n            int num = a *((int)S[i+1]-(int)'0');\n            cal2[c2]=num;\n            i++;\n            continue;\n        }\n        c2++;\n        cal2[c2] = (int)S[i]-(int)'0';\n    }\n    while (c2>0) {\n        if(cal2[c2]!=-1) {\n            b+= cal2[c2];\n        }\n        c2--;\n    }\n    if (a==n and b == n) {\n        cout <<\"U\"<<endl;\n    }else{\n        if (b==n) {\n            cout << \"M\"<<endl;\n        }else{\n            if (a==n) {\n                cout << \"L\"<<endl;\n            }else{\n                cout << \"I\"<<endl;\n            }\n        }\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdint>\n#include <cassert>\n#include <cctype>\n#include <vector>\n#include <algorithm>\n#include <string>\n\nstd::vector<std::string> ops = {\"+-\", \"*\"};\n\nintmax_t parse_int(std::string const& s, size_t& i) {\n  intmax_t res = s[i]-'0';\n  while (isdigit(s[++i])) res = res*10 + s[i]-'0';\n  return res;\n}\n\nintmax_t parse(std::string const& s, size_t& i, size_t preced = 0) {\n  if (preced == ops.size()) {\n    if (isdigit(s[i])) return parse_int(s, i);\n    assert(false);\n  }\n\n  intmax_t res = parse(s, i, preced+1);\n  while (i < s.length()) {\n    char op = s[i];\n    if (!std::count(ops[preced].begin(), ops[preced].end(), op)) break;\n    intmax_t tmp = parse(s, ++i, preced+1);\n    if (op == '+') {\n      res += tmp;\n    } else if (op == '-') {\n      res -= tmp;\n    } else if (op == '*') {\n      res *= tmp;\n    }\n  }\n  return res;\n}\n\nint main() {\n  char buf[131072];\n  scanf(\"%s\", buf);\n  std::string s = buf;\n\n  intmax_t d;\n  scanf(\"%jd\", &d);\n\n  intmax_t res1, res2;\n  {\n    size_t i = 0;\n    res1 = parse(s, i);\n  }\n  ops = std::vector<std::string>{\"+-*\"};\n  {\n    size_t i = 0;\n    res2 = parse(s, i);\n  }\n\n  // fprintf(stderr, \"%jd %jd\\n\", res1, res2);\n\n  if (res1 == d) {\n    if (res2 == d) {\n      puts(\"U\");\n    } else {\n      puts(\"M\");\n    }\n  } else {\n    if (res2 == d) {\n      puts(\"L\");\n    } else {\n      puts(\"I\");\n    }\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\nusing namespace std;\ntypedef long long ll;\n\nll solve1(string s,int l,int n){\n\tll res=0;\n\tll val=1;\n\tfor(int i=l;i<n;i++){\n\t\tif(s[i]=='*')continue;\n\t\telse if(s[i]=='+'){\n\t\t\tres+=val;\n\t\t\tval=1;\n\t\t}\n\t\telse{\n\t\t\tval*=(s[i]-'0');\n\t\t}\n\t}\n\tres+=val;\n\treturn res;\n}\n\nll solve2(string s,int l,int n){\n\tll res=s[0]-'0';\n\tchar op='+';\n\tfor(int i=1;i<n;i++){\n\t\tif(s[i]=='+'||s[i]=='*'){\n\t\t\top=s[i];\n\t\t}else{\n\t\t\tif(op=='+'){\n\t\t\t\tres+=(s[i]-'0');\n\t\t\t}else{\n\t\t\t\tres*=(s[i]-'0');\n\t\t\t}\n\t\t}\n\t}\n\treturn res;\n}\n\nint main(){\n\tcin.tie(nullptr);\n\tios::sync_with_stdio(false);\n\tstring s; cin >> s;\n\tll n; cin >> n;\n\tif(n==solve1(s,0,s.size())){\n\t\tif(n==solve2(s,0,s.size())){\n\t\t\tprintf(\"U\\n\");\n\t\t}else{\n\t\t\tprintf(\"M\\n\");\n\t\t}\n\t}else{\n\t\tif(n==solve2(s,0,s.size())){\n\t\t\tprintf(\"L\\n\");\n\t\t}else{\n\t\t\tprintf(\"I\\n\");\n\t\t}\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\n\nint comM(string str){\n  int res = 0;\n  int sum = 0;\n  if(str.size() == 1) res = str[0]-'0';\n  for(int i=0;i<str.size();i++) \n    if(str[i] =='*' && sum == 0) sum += (str[i-1]-'0') * (str[i+1]-'0');\n    else if(str[i] =='*' && sum != 0) sum *= (str[i+1] - '0');\n    else if(str[i] == '+') res += sum,sum = 0;\n  res += sum;\n  if(str[1] == '+') res += str[0]-'0';\n  for(int i=0;i<str.size();i++) \n    if(str[i] == '+' && (i+1 == str.size()-1||str[i+2] != '*')) res += str[i+1]-'0';\n    return res;\n} \n\nint comL(string str) {\n  int res = str[0]-'0';\n  for(int i=0;i<str.size();i++)\n    if(str[i] == '*') res *= (str[i+1]-'0');\n    else if(str[i]=='+') res += (str[i+1]-'0');\n  return res;\n}\n\nint main(){\n  string str;\n  cin >> str;\n  int n;\n  cin >> n;\n  int M = comM(str);\n  int L = comL(str);\n  //  cout << M<<endl;\n  //cout << L <<endl;\n  if(M==n && L == n) cout << \"U\"<<endl;\n  else if(M==n) cout << \"M\"<<endl;\n  else if(L==n) cout <<\"L\"<<endl;\n  else cout << \"I\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>  \nusing namespace std;\nconst int INF = 999;\n//世界一競技プログラミングができない人のソース2\n#define int long long\nint get_number(string str, int& idx){\n  int ret = 0;\n  while(isdigit(str[idx])){\n    ret = ret * 10 + str[idx] - '0';\n    ++idx;\n  }\n  return ret;\n}\n\nint Expression(string str, int& idx){\n  int ret = get_number(str, idx);\n  while(true){\n    switch(str[idx]){\n    case '*':\n      ++idx;\n      ret *= get_number( str, idx);\n      break;\n    default:\n      return ret;\n    }\n  }\n}\n\nint nomal(string str, int idx = 0){\n  int res = Expression(str, idx);\n  while(true){\n    switch(str[idx]){\n    case '+':\n      ++idx;\n      res += Expression(str, idx);\n      break;\n    default:\n      return res;\n    }\n  }\n}\nint special(string str, int idx = 0){\n  int ret = get_number(str, idx);\n  while(idx < str.size() - 1){\n    if(str[idx] == '+') ret += get_number(str, ++idx);\n    if(str[idx] == '*') ret *= get_number(str, ++idx);\n    else break;\n  }\n  return ret;\n}\nsigned main(){\n  string str;\n  cin >> str;\n  str += \"~\";\n  int digit;\n  cin >> digit;\n\n  bool judge_a = nomal(str) == digit;\n  bool judge_b = special(str) == digit;\n  if(judge_a & judge_b){\n    cout << \"U\" << endl;\n  } else if( judge_a){\n    cout << \"M\" << endl;\n  } else if( judge_b){\n    cout << \"L\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,n) for(int i=0; i<n; i++)\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef vector< vector<int> > vvi;\n\nint mf(string s) {\n\trep(i, s.length()) {\n\t\tif( s[i] == '+' ) {\n\t\t\treturn mf(s.substr(0,i)) + mf(s.substr(i+1));\n\t\t}\n\t}\n\trep(i, s.length()) {\n\t\tif( s[i] == '*' ) {\n\t\t\treturn mf(s.substr(0,i)) * mf(s.substr(i+1));\n\t\t}\n\t}\n\treturn atoi(s.c_str());\n}\n\nint ltr(string s) {\n\tfor(int i=s.length()-1; i>=0; i--) {\n\t\tif( s[i] == '+' ) {\n\t\t\treturn ltr(s.substr(0,i)) + ltr(s.substr(i+1));\n\t\t}\n\t\telse if( s[i] == '*' ) {\n\t\t\treturn ltr(s.substr(0,i)) * ltr(s.substr(i+1));\n\t\t}\n\t}\n\treturn atoi(s.c_str());\n}\n\nint main() {\n\tstring in;\n\tcin >> in;\n\tint ans;\n\tcin >> ans;\n\tint m = mf(in);\n\tint l = ltr(in);\n\tif( m==ans && l==ans ) {\n\t\tcout << \"U\" << endl;\n\t} else if( m == ans ) {\n\t\tcout << \"M\" << endl;\n\t} else if( l == ans ) {\n\t\tcout << \"L\" << endl;\n\t} else {\n\t\tcout << \"I\" << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \n#define INF 1001000100010001000\n#define MOD 1000000007\n#define EPS 1e-10\n#define int long long\n#define rep(i, N) for (int i = 0; i < N; i++)\n#define Rep(i, N) for (int i = 1; i < N; i++)\n#define For(i, a, b) for (int i = (a); i < (b); i++)\n#define pb push_back\n#define mp make_pair\n#define i_i pair<int, int>\n#define vi vector<int>\n#define vvi vector<vi >\n#define vb vector<bool>\n#define vvb vector<vb >\n#define vp vector< i_i >\n#define all(a) (a).begin(), (a).end()\n#define Int(x) int x; scanf(\"%lld\", &x);\n \n//int dxy[5] = {0, 1, 0, -1, 0};\n// assign\n\nint sp;\nstring data;\n\nint calc();\nint num();\nint expr();\nint factor();\n\nsigned main()\n{\n    cin >> data;\n    Int(ans);\n    sp = 0;\n    int a = expr();\n    sp = 0;\n    int b = calc();\n    if (a == ans && b == ans) {\n        cout << \"U\" << endl;\n    } else if (a == ans) {\n        cout << \"M\" << endl;\n    } else if (b == ans) {\n        cout << \"L\" << endl;\n    } else {\n        cout << \"I\" << endl;\n    }\n    return 0;\n}\n\nint calc()\n{\n    int ret = num();\n    while (sp < data.length() ) {\n        if ( data[sp] == '*' ) {\n            sp++;\n            ret *= num();\n        } else if ( data[sp] == '+' ) {\n            sp++;\n            ret += num();\n        } else {\n            break;\n        }\n    }\n    return ret;\n}\n\nint expr()\n{\n    int ret = factor();\n    while ( sp < data.length() ) {\n        if (data[sp] == '+') {\n            sp++;\n            ret += factor();\n        } else {\n            break;\n        }\n    }\n    return ret;\n}\n\nint factor()\n{\n    int ret = num();\n    while ( sp < data.length() ) {\n        if (data[sp] == '*' ) {\n            sp++;\n            ret *= num();\n        } else {\n            break;\n        }\n    }\n    return ret;\n}\n\nint num()\n{\n    int ret = 0;\n    while ( sp < data.length() ) {\n        if ( '0' <= data[sp] && data[sp] <= '9' ) {\n            ret *= 10;\n            ret += data[sp++] - '0';\n        } else {\n            break;\n        }\n    }\n    return ret;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll=long long;\n\nll calcm(string s){\n    ll ret=0;\n    ll tmp=0;\n    int ind=0;\n    char op='+';\n    while(ind<s.size()){\n        ll tn=s[ind]-'0';\n        ++ind;\n        if(ind>=s.size()||s[ind]=='+'){\n            if(op=='*')tmp*=tn;\n            else tmp+=tn;\n            ret+=tmp;\n            tmp=0;\n        }\n        else{\n            if(op=='*')tmp*=tn;\n            else tmp+=tn;\n        }\n        op=s[ind];\n        ++ind;\n    }\n    return ret+tmp;\n}\n\nll calc(string s){\n    ll ret=0;\n    int ind=0;\n    char op='+';\n    while(ind<s.size()){\n        ll tn=s[ind]-'0';\n        ++ind;\n        if(op=='+')ret+=tn;\n        else ret*=tn;\n        op=s[ind];\n        ++ind;\n    }\n    return ret;\n}\n\nll solve(string s,bool mul){\n    if(mul)return calcm(s);\n    else return calc(s);\n}\n\nint main(){\n    string s;\n    cin>>s;\n    ll res;\n    cin>>res;\n    bool ml=false,l=false;\n    ml=(res==solve(s,true));\n    l=(res==solve(s,false));\n\n    if(ml&&!l)cout<<\"M\"<<endl;\n    else if(!ml&&l)cout<<\"L\"<<endl;\n    else if(ml&&l)cout<<\"U\"<<endl;\n    else cout<<\"I\"<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nll calc_m(string s){\n    stack<ll> num;\n    stack<char> ope;\n    for(auto c : s){\n        if(c >= '0' && c <= '9'){\n            num.push(c-'0');\n            if(!ope.empty() && ope.top() == '*'){\n                ll n1, n2;\n                n2 = num.top(), num.pop();\n                n1 = num.top(), num.pop();\n                num.push(n1*n2);\n            }\n        }\n        else ope.push(c);\n    }\n    ll res = 0;\n    while(!num.empty()){\n        res += num.top();\n        num.pop();\n    }\n    return res;\n}\n\nll calc_l(string s){\n    ll res = s[0] - '0';\n    for(int i=1;i<int(s.size());i+=2){\n        if(s[i]=='+'){\n            res += s[i+1]-'0';\n        }\n        else{\n            res *= s[i+1]-'0';\n        }\n    }\n    return res;\n}\n\nint main() {\n    string s;\n    ll x, m, l;\n    cin >> s >> x;\n    m = calc_m(s);\n    l = calc_l(s);\n    if(x==m && x!=l){\n        cout << 'M' << endl;\n    }\n    else if(x!=m && x==l){\n        cout << 'L' << endl;\n    }\n    else if(x==m && x==l){\n        cout << 'U' << endl;\n    }\n    else{\n        cout << 'I' << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\nusing namespace std;\n \n#define REP(i,n) for(int i=0; i<n; ++i)\n#define FOR(i,a,b) for(int i=a; i<=b; ++i)\n#define FORR(i,a,b) for (int i=a; i>=b; --i)\n#define pi M_PI\n \ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef vector<VI> VVI;\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> PL;\n\ntypedef string::const_iterator State;\n \nint expression(State&);\nint term(State&);\nint factor(State&);\nint number(State&);\n \nint expression(State &begin){\n    int ret = term(begin);\n    while (1){\n        if (*begin == '+'){\n            begin++;\n            ret += term(begin);\n        }else if (*begin == '-'){\n            begin++;\n            ret -= term(begin);\n        }else{\n            break;\n        }\n    }\n    return ret;\n}\n \nint term(State &begin){\n    int ret = factor(begin);\n    while (1){\n        if (*begin == '*'){\n            begin++;\n            ret *= factor(begin);\n        }else if (*begin == '/'){\n            begin++;\n            ret /= factor(begin);\n        }else{\n            break;\n        }\n    }\n    return ret;\n}\n \nint factor(State &begin){\n    if (*begin == '('){\n        begin++;\n        int ret = expression(begin);\n        begin++;\n        return ret;\n    }else{\n        return number(begin);\n    }\n}\n \nint number(State &begin){\n    int ret = 0;\n    while (isdigit(*begin)){\n        ret *= 10;\n        ret += *begin - '0';\n        begin++;\n    }\n    return ret;\n}\n\nint main() {\n    string s;\n    int a;\n    cin >> s >> a;\n    State begin = s.begin();\n    bool f1 = (a == expression(begin));\n    int x = s[0] - '0';\n    for (int i = 1; i < s.length(); i += 2){\n        if (s[i] == '+') x += s[i+1] - '0';\n        else x *= s[i+1] - '0';\n    }\n    bool f2 = (a == x);\n\n    char ans;\n    if (f1 & f2) ans = 'U';\n    if (f1 & !f2) ans = 'M';\n    if (!f1 & f2) ans = 'L';\n    if (!f1 & !f2) ans = 'I';\n    cout << ans << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <fstream>\nusing namespace std;\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toStr(T x) { ostringstream sout; sout << x; return sout.str(); }\ntypedef vector<int> vi;\ntypedef vector<vi>  vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define FOR(i,a,b) for(int i=(a);i<=(b);++i)\n#define REP(i,n) FOR(i,0,(n)-1)\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\nconst int INF = INT_MAX / 10;\n\nstring s;\nint p;\n\nint term();\nint num();\n\nint expression() {\n\tint ret = num();\n\twhile (s[p] == '+') {\n\t\tp++;\n\t\tret += term();\n\t}\n\treturn ret;\n}\n\nint term() {\n\tint ret = num();\n\twhile (s[p] == '*') {\n\t\tp++;\n\t\tret *= num();\n\t}\n\treturn ret;\n}\n\nint num() {\n\tint ret = 0;\n\twhile (isdigit(s[p])) {\n\t\tret *= 10;\n\t\tret += (s[p] - '0');\n\t\tp++;\n\t}\n\treturn ret;\n}\n\nint expression2() {\n\tint ret = num();\n\twhile (true) {\n\t\tif (s[p] == '+') {\n\t\t\tp++;\n\t\t\tret += num();\n\t\t}\n\t\telse if (s[p] == '*') {\n\t\t\tp++;\n\t\t\tret *= num();\n\t\t}\n\t\telse {\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn ret;\n}\n\nint main() {\n\tint n;\n\tcin >> s >> n;\n\tp = 0;\n\tint ans1 = expression();\n\tp = 0;\n\tint ans2 = expression2();\n\n\tif (n == ans1) {\n\t\tif (n == ans2) {\n\t\t\tcout << 'U' << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << 'M' << endl;\n\t\t}\n\t}\n\telse if (n == ans2) {\n\t\tcout << 'L' << endl;\n\t}\n\telse {\n\t\tcout << 'I' << endl;\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <stack>\nusing namespace std;\n\nint main(void) {\n\n  string exp; cin >> exp;\n  int ans; cin >> ans;\n\n  stack<int> nums;\n  for (unsigned int i = 0; i < exp.size(); i++) {\n    if (exp[i] == '*') {\n      int v1 = nums.top(); nums.pop();\n      int v2 = exp[++i] - '0';\n      nums.push(v1*v2);\n    } else if (exp[i] == '+') {\n      continue;\n    } else {\n      nums.push(exp[i] - '0');\n    }\n  }\n  int a1 = 0;\n  while (!nums.empty()) {\n    a1 += nums.top(); nums.pop();\n  }\n\n  int a2 = exp[0] - '0';\n  for (unsigned int i = 1; i < exp.size(); i++) {\n    if (exp[i] == '+') {\n      a2 += exp[i+1] - '0';\n    } else if (exp[i] == '*') {\n      a2 *= exp[i+1] - '0';\n    }\n  }\n\n  if (a1 == ans) {\n    if (a2 == ans) {\n      cout << \"U\" << endl;\n    } else {\n      cout << \"M\" << endl;\n    }\n  } else if (a2 == ans) {\n    cout << \"L\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main(){\n\tstring str;\n\tint n;\n\tcin >> str >> n;\n\tchar x = 'x';\n\tint f = 0, s = 0;\n\tint num[10];\n\tbool used[10];\n\tchar ope[10];\n\tfor(int i = 0; i < str.size(); i++){\n\t\tif(i%2 == 0){\n\t\t\tnum[i/2] = str[i]-'0';\n\t\t} else{\n\t\t\tope[i/2] = str[i];\n\t\t}\n\t}\n\tint t = -1;\n\tfor(int i = 0; i < str.size()/2; i++){\n\t\tif(ope[i] == '*'){\n\t\t\tif(t == -1){\n\t\t\t\tt = num[i]*num[i+1];\n\t\t\t\tused[i] = true;\n\t\t\t\tused[i+1] = true;\n\t\t\t} else{\n\t\t\t\tt *= num[i+1];\n\t\t\t\tused[i+1] = true;\n\t\t\t}\n\t\t} else{\n\t\t\tif(t != -1) f += t;\n\t\t\tt = -1;\n\t\t}\n\t}\n\tfor(int i = 0; i < (str.size()+1)/2; i++){\n\t\tif(!used[i]) f += num[i];\n\t}\n\tfor(int i = 0; i < str.size(); i++){\n\t\tif(i%2 == 0){\n\t\t\tif(x == 'x') s = str[i]-'0';\n\t\t\tif(x == '+') s += str[i]-'0';\n\t\t\tif(x == '*') s *= str[i]-'0';\n\t\t} else{\n\t\t\tx = str[i];\n\t\t}\n\t}\n\tif(s == n){\n\t\tif(f == n) cout << \"U\" << endl;\n\t\telse cout << \"L\" << endl;\n\t} else{\n\t\tif(f == n) cout << \"M\" << endl;\n\t\telse cout << \"I\" << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <sstream>\n\n#define REP(i,k,n) for(int i=k;i<n;i++)\n#define rep(i,n) for(int i=0;i<n;i++)\n\nusing namespace std;\ntypedef long long ll;\n\nvector<string> split(const string &str, char delim) {\n    vector<string> res;\n    size_t current = 0, found;\n    while((found = str.find_first_of(delim, current)) != string::npos) {\n        res.push_back(string(str, current, found - current));\n        current = found + 1;\n    }\n    res.push_back(string(str, current, str.size() - current));\n    return res;\n}\n\nint main() {\n    string S;\n    cin >> S;\n\n    ll n;\n    cin >> n;\n\n    string s = S;\n\n    vector<string> T = split(S,'+');\n    vector<int> v;\n    rep(i,T.size()) {\n        vector<string> t = split(T[i],'*');\n        rep(j,t.size()) {\n            stringstream ss;\n            ss << t[j];\n\n            int temp;\n            ss >> temp;\n            v.push_back(temp);\n        }\n    }\n\n    vector<char> t;\n    rep(i,S.size()) {\n        if(S[i] == '+' || S[i] == '*') t.push_back(S[i]);\n    }\n    \n    ll b;\n    stringstream ss;\n    ss << v[0];\n    ss >> b;\n\n    rep(i,t.size()) {\n        int r;\n        stringstream ss2;\n\n        ss2 << v[i+1];\n        ss2 >> r;\n\n        if(t[i] == '+') {\n            b += r;\n        }\n        else b *= r;\n    }\n\n    while(true) {\n        bool F = true;\n        rep(i,t.size()) {\n            if(t[i] == '*') {\n                F = false;\n                int l = v[i];\n                int r = v[i+1];\n                \n                vector<int> temp;\n                rep(j,i) {\n                    temp.push_back(v[j]);\n                }\n                temp.push_back(l*r);\n\n                REP(j,i+2,v.size()) {\n                    temp.push_back(v[j]);\n                }\n\n                v.clear();\n                copy(temp.begin(),temp.end(),back_inserter(v));\n\n                vector<char> temp2;\n                rep(j,i) temp2.push_back(t[j]);\n                REP(j,i+1,t.size()) temp2.push_back(t[j]);\n                t.clear();\n                copy(temp2.begin(),temp2.end(),back_inserter(t));\n                break;\n            }\n        }\n\n        if(F) break;\n    }\n\n    ll a = 0;\n    rep(i,v.size()) {\n        a += v[i];\n    }\n\n    if(a == n && b == n) cout << \"U\" << endl;\n    else if(a == n) cout << \"M\" << endl;\n    else if(b == n) cout << \"L\" << endl;\n    else cout << \"I\" << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main(){\n\t\n\tstring s;\n\tint n,f;\n\tcin>>s>>n;\n\tint k=s[0]-'0';\n\tfor(int i=1;i<s.size();i+=2){\n\t\tif(s[i]=='+')k+=(s[i+1]-'0');\n\t\telse k*=(s[i+1]-'0');\n\t}\n\tf=(k==n);\n\tint a=s[0]-'0',c=0;\n\tfor(int i=1;i<s.size();i+=2){\n\t\tif(s[i]=='+'){\n\t\t\tc+=a;\n\t\t\ta=s[i+1]-'0';\n\t\t}\n\t\telse{\n\t\t\ta*=(s[i+1]-'0');\n\t\t}\n\t}\n\tc+=a;\n\tf+=(2*(c==n));\n\tcout<<\"ILMU\"[f]<<endl;\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstruct M{\n  string s;\n  string::iterator it;\n\n  void init(const string &str){\n    s = str;\n    it = s.begin();\n  }\n\n  int fact(){\n    int res = 0;\n    while(isdigit(*it)){\n      res *= 10;\n      res += *it-'0';\n      ++it;\n    }\n    return res;\n  }  \n\n  int exp(){\n    int res = term();\n    while(*it == '+'){\n      ++it;\n      res += term();\n\n    }\n    return res;\n  }\n\n  int term(){\n    int res = fact();\n    while(*it == '*'){\n      ++it;\n      res *= fact();\n    }\n    return res;\n  }\n};\n\nstruct L{\n  string s;\n  string::iterator it;\n\n  void init(const string &str){\n    s = str;\n    it = s.begin();\n  }\n\n  int fact(){\n    int res = 0;\n    while(isdigit(*it)){\n      res *= 10;\n      res += *it-'0';\n      ++it;\n    }\n    return res;\n  }  \n\n  int exp(){\n    int res = fact();\n    while(*it == '+'){\n      ++it;\n      res += fact();\n      if(*it == '*'){\n        ++it;\n        res *= term();\n      }\n    }\n    return res;\n  }\n\n  int term(){\n    int res = fact();\n    while(*it == '*'){\n      ++it;\n      res *= fact();\n      if(*it == '+'){\n        ++it;\n        res += exp();\n      }\n    }\n    return res;\n  }\n};\n\nint main(){\n  int ans;\n  string s;\n  cin >> s >> ans; \n  M m; m.init(s); \n  L l; l.init(s);\n  int Mres = m.exp(), Lres = l.exp();\n  if(Mres == ans && Lres != ans){\n    cout << 'M' << endl;\n  }else if(Mres != ans && Lres == ans){\n    cout << 'L' << endl;\n  }else if(Mres == ans && Lres == ans){\n    cout << 'U' << endl;\n  }else{\n    cout << 'I' << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\nusing namespace std;\n\nint main(){\n  string str;\n  cin>>str;\n  int n;\n  cin>>n;\n  int ansl=(int)str[0]-48;\n  for(int i=1;i<=int(str.size())/2;i++){\n    if(str[2*i-1]=='+'){\n      ansl+=(int(str[2*i])-48);\n    }else{\n      ansl*=(int(str[2*i])-48);\n    }\n  }\n  int ansm=0;\n  vector<int> vec;\n  for(int i=0;i<int(str.size());i+=2){\n    if((i+1>=(int)str.size()) || (str[i+1]=='+')){\n      vec.push_back((int)str[i]-48);\n    }else{\n      int c=((int)str[i]-48);\n      for(int j=i+2;j<(int)str.size();j+=2){\n\tc*=((int)str[j]-48);\n\tif((j+1>=(int)str.size()) || (str[j+1]=='+')){\n\t  vec.push_back(c);\n\t  i=j;\n\t  break;\n\t}\n      }\n    }\n  }\n  for(int i=0;i<(int)vec.size();i++)\n    ansm+=vec[i];\n  //  cout<<\" l->\"<<ansl<<\" m->\"<<ansm<<endl;\n  if(ansm==ansl){\n    if(ansm==n){\n      cout<<\"U\"<<endl;\n    }else{\n      cout<<\"I\"<<endl;\n    }\n  }else{\n    if(ansm==n){\n      cout<<\"M\"<<endl;\n    }else if(ansl==n){\n      cout<<\"L\"<<endl;\n    }else{\n      cout<<\"I\"<<endl;\n    }\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing vi=vector<int>;\n#define all(a) a.begin(),a.end()\n\nint main(){\n\tint l=0,n=0,p;\n\tvector<int> a(1);\n\tstring s;\n\tcin>>s>>p;\n\t\n\tl=a[0]= s[0]-'0';\n\tfor(int i=2; i<s.size() ;i+=2){\n\t\tint t=s[i]-'0';\n\t\tif(s[i-1]=='*'){\n\t\t\tl*=t;\n\t\t\ta.back()*=t;\n\t\t}else{\n\t\t\tl+=t;\n\t\t\ta.push_back(t);\n\t\t}\n\t}\n\tn=accumulate(all(a),0);\n\tcout<<\"ILMU\"[l==p?1:0 + n==p?2:0]<<endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <iostream>\n#include <map>\n#include <cmath>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <stdlib.h>\n#include <stdio.h>\n#include <bitset>\n#include <cstring>\nusing namespace std;\n#define FOR(I,A,B) for(int I = (A); I < (B); ++I)\n#define CLR(mat) memset(mat, 0, sizeof(mat))\ntypedef long long ll;\nint main()\n{\n  string s; cin >> s;\n  bool used[s.length()]; CLR(used);\n  ll ans1 = 0;\n  ll cal = s[0] - '0';\n  // method 1\n  bool plus = false;\n  for(int i = 1; i < s.length(); i += 2) {\n    if(s[i] == '*') {\n      cal *= s[i+1] - '0';\n      used[i-1] = used[i+1] = true;\n      if(i == s.length() - 2) {\n        ans1 += cal;\n      }\n      plus = true;\n    } else if(plus){\n      ans1 += cal;\n      cal = s[i+1] - '0';\n      plus = false;\n    } else {\n      cal = s[i+1] - '0';\n    }\n  }\n  for(int i = 0; i < s.length(); i += 2) {\n    if(!used[i]) ans1 += s[i] - '0';\n  }\n  // method 2\n  ll ans2 = s[0] - '0';\n  for(int i = 1; i < s.length(); i += 2) {\n    if(s[i] == '*') {\n      ans2 *= s[i+1] - '0';\n    } else {\n      ans2 += s[i+1] - '0';\n    }\n  }\n  //cout << ans1 << \" \" << endl;\n  ll x; cin >> x;\n  if(ans1 == x && ans2 == x) {\n    puts(\"U\");\n  } else if(ans1 == x) {\n    puts(\"M\");\n  } else if(ans2 == x) {\n    puts(\"L\");\n  } else {\n    puts(\"I\");\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint l_r_rule(string s){\n  int len=s.length();\n  int res=0;\n  char ope='+';\n  for(int i=0;i<len;i++){\n    if(i%2==0){//??°???\n      if(ope=='+') res+=(s[i]-48);\n      else res*=(s[i]-48);\n    }\n    else ope=s[i];\n  }\n  return res;\n}\n\nint m_f_rule(string s){\n  s+='+';\n  int len=s.length();\n  std::vector<int> v;\n  int tmp=0;\n  for(int i=0;i<len/2;i++){\n    if(s[i*2+1]=='+'){\n      if(tmp==0) v.push_back((s[i*2]-48));\n      else v.push_back(tmp);\n      tmp=0;\n    }\n    else{\n      if(tmp==0) tmp=(s[i*2]-48);\n      tmp*=(s[i*2+2]-48);\n    }\n  }\n  int vlen=v.size();\n  int res=0;\n  for(int i=0;i<vlen;i++) res+=v[i];\n  return res;\n}\n\nint main(){\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n\n  string s;int n;\n  cin>>s>>n;\n  int mans=m_f_rule(s);\n  int lans=l_r_rule(s);\n  // cout << mans<<\" \"<<lans<<endl;\n  if(mans==n&&lans==n) cout <<\"U\"<<endl;\n  else if(mans==n) cout <<\"M\"<<endl;\n  else if(lans==n) cout << \"L\"<<endl;\n  else cout <<\"I\"<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n \n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n \nstring gettopnum(string str){\n    string rst = \"\";\n    REP(i,str.size()){\n        if(str[i]=='*'||str[i]=='+') break;\n        else rst += str[i];\n    }\n    return rst;\n}\nll int calc1(string str){//multiplication-first\n    stack<ll int> st;\n    string rststr = gettopnum(str);\n    if(rststr!=\"\") st.push((ll int)stoi(rststr));\n    if(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n    while(str.size()!=0){\n        //cout << str << endl;\n        if(str[0]=='*'){\n            str.erase(str.begin(),str.begin()+1);\n            ll int tmp = stoi(gettopnum(str));\n            str.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n            ll int tmp2 = st.top();\n            st.pop();\n            st.push(tmp*tmp2);\n        }else if(str[0]=='+'){\n            str.erase(str.begin(),str.begin()+1);\n            ll int tmp = stoi(gettopnum(str));\n            st.push(tmp);\n            str.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n        }\n    }\n    ll int rst = 0;\n    while(!st.empty()){\n        rst += st.top();\n        st.pop();\n    }\n    return rst;\n}\n \nll int calc2(string str){////multiplication-first2\n    //cout << str << endl;\n    string rststr = gettopnum(str);\n    ll int rst;\n    if(rststr!=\"\") rst = stoi(rststr);\n    if(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)rst)+1);\n    if(str.size()==0) return rst;\n    else if(str[0]=='*') {\n        str.erase(str.begin(),str.begin()+1);\n        return rst*calc2(str);\n    }else if(str[0]=='+'){\n        str.erase(str.begin(),str.begin()+1);\n        return rst+calc2(str);\n    }\n    //dummy\n    return -1;\n}\n \nll int calc3(string str){//leftto-right\n    string rststr = gettopnum(str);\n    if(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n    ll int rst = stoi(rststr);\n    while(str.size()!=0){\n        //cout << str << endl;\n        if(str[0]=='*'){\n            str.erase(str.begin(),str.begin()+1);\n            ll int tmp = stoi(gettopnum(str));\n            rst *= tmp;\n            str.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n        }else if(str[0]=='+'){\n            str.erase(str.begin(),str.begin()+1);\n            ll int tmp = stoi(gettopnum(str));\n            rst += tmp;\n            str.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n        }\n    }\n    return rst;\n}\n \nint main(){\n    string str;\n    cin >> str;\n    ll int ans;\n    cin >> ans;\n    ll int rst1 = calc1(str);\n    ll int rst2 = calc3(str);\n    //cout << rst1 << \" \" << rst2 << endl;\n    if(rst1==ans){\n        if(rst2==ans) cout << 'U' << endl;\n        else cout << 'M' << endl;\n    }else{\n        if(rst2==ans) cout << 'L' << endl;\n        else cout << 'I' << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nint main()\n{\n\tstring str;\n\tint answer;\n\n\tcin >> str >> answer;\n\n\tbool flagL = false;\n\tbool flagM = false;\n\n\tint ansL = str[0] - '0';\n\n\tfor (int i = 1; i < str.size(); i += 2) {\n\t\tif (str[i] == '+') {\n\t\t\tansL += str[i + 1] - '0';\n\t\t}\n\t\telse if (str[i] == '*') {\n\t\t\tansL *= str[i + 1] - '0';\n\t\t}\n\t}\n\n\tif (ansL == answer) {\n\t\tflagL = true;\n\t}\n\n\tint ansM = 0;\n\n\twhile (true) {\n\t\tbool flag = false;\n\n\t\tfor (int i = 0; i < str.size(); i++) {\n\t\t\tif (str[i] == '*') {\n\t\t\t\tint temp = (str[i - 1] - '0') * (str[i + 1] - '0');\n\t\t\t\tstr = str.substr(0, i - 1) + to_string(temp) + str.substr(i + 2);\n\t\t\t\tflag = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (flag == true) {\n\t\t\tcontinue;\n\t\t}\n\t\telse {\n\t\t\tfor (int i = 0; i < str.size(); i += 2) {\n\t\t\t\tansM += str[i] - '0';\n\t\t\t}\n\n\t\t\tif (ansM == answer) {\n\t\t\t\tflagM = true;\n\t\t\t}\n\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (flagL == true && flagM == true) {\n\t\tcout << \"U\" << endl;\n\t}\n\telse if (flagL == true) {\n\t\tcout << \"L\" << endl;\n\t}\n\telse if (flagM == true) {\n\t\tcout << \"M\" << endl;\n\t}\n\telse {\n\t\tcout << \"I\" << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nchar str[20];\nint cur;\nlong long num(){\n\tlong long ret=0;\n\twhile('0'<=str[cur]&&str[cur]<='9'){\n\t//\tprintf(\"%d\\n\",cur);\n\t\tret*=10;\n\t\tret+=str[cur]-'0';\n\t\tcur++;\n\t}\n\treturn ret;\n}\nlong long mul(){\n\tlong long ret=num();\n\twhile(str[cur]=='*'){\n\t\tcur++;\n\t\tret*=num();\n\t}\n\treturn ret;\n}\nlong long plus(){\n\tlong long ret=mul();\n\twhile(str[cur]=='+'){\n\t\tcur++;\n\t\tret+=mul();\n\t}\n\treturn ret;\n}\nint main(){\n\tscanf(\"%s\",str);\n\tlong long a;scanf(\"%lld\",&a);\n\tlong long M=plus();\n\tlong long L=0;\n\tcur=0;\n\tlong long tmp=0;\n\tint last=0;\n\twhile(str[cur]){\n\t\ttmp=0;\n\t\twhile('0'<=str[cur]&&str[cur]<='9'){\n\t\t\ttmp*=10;\n\t\t\ttmp+=str[cur]-'0';\n\t\t\tcur++;\n\t\t}//printf(\"%lld\\n\",L);\n\t\t\n\t\tif(last)L*=tmp;\n\t\telse L+=tmp;\n\t\tif(!str[cur])break;\n\t\tif(str[cur]=='*')last=1;\n\t\telse last=0;\n\t\tcur++;\n\t}\n\tif(a==M&&a==L)printf(\"U\\n\");\n\tif(a==M&&a!=L)printf(\"M\\n\");\n\tif(a!=M&&a!=L)printf(\"I\\n\");\n\tif(a!=M&&a==L)printf(\"L\\n\");\n}"
  },
  {
    "language": "C++",
    "code": "Last login: Wed Nov  5 19:00:32 on ttys001\nDarsein-MBP:B Darsein$ emacs b.cpp &\n[1] 15778\nDarsein-MBP:B Darsein$ gpp b\nDarsein-MBP:B Darsein$ ./b < in1\nI\nDarsein-MBP:B Darsein$ ./b < in2\nI\nDarsein-MBP:B Darsein$ ./b < in3\nI\nDarsein-MBP:B Darsein$ ./b < in4\nI\nDarsein-MBP:B Darsein$ gpp b\nDarsein-MBP:B Darsein$ ./b < in1\n-85 -83\nI\nDarsein-MBP:B Darsein$ gpp b\nDarsein-MBP:B Darsein$ ./b < in1\n1+2*3+4\n-85 -83\nI\nDarsein-MBP:B Darsein$ gpp b\nDarsein-MBP:B Darsein$ ./b < in1\n1\n-85 -83\nI\nDarsein-MBP:B Darsein$ gpp b\nb.cpp: In function 'int main()':\nb.cpp:12:16: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   for(int i=1;i<s.size();i+=2){\n                ^\nb.cpp:23:16: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   for(int i=1;i<s.size();i+=2){\n                ^\nDarsein-MBP:B Darsein$ ./b < in1\n1\n11 13\nM\nDarsein-MBP:B Darsein$ gpp b\nb.cpp: In function 'int main()':\nb.cpp:11:16: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   for(int i=1;i<s.size();i+=2){\n                ^\nb.cpp:22:16: warning: comparison between signed and unsigned integer expressions [-Wsign-compare]\n   for(int i=1;i<s.size();i+=2){\n                ^\nDarsein-MBP:B Darsein$ ./b < in1\nM\nDarsein-MBP:B Darsein$ ./b < in2\nL\nDarsein-MBP:B Darsein$ ./b < in3\nU\nDarsein-MBP:B Darsein$ ./b < in4\nI\nDarsein-MBP:B Darsein$ "
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\n\nstring s;\nint n;\nint p;\n\nint one();\nint two();\nint num();\nint three();\nint one(){\n\tint r = num();\n\twhile( s[p] == '+' || s[p] == '*' ){\n\t\tchar c = s[p];\n\t\tp++;\n\t\tint l = num();\n\t\tif( c == '*' ){\n\t\t\tr *= l;\n\t\t}else{\n\t\t\tr += l;\n\t\t}\n\t}\n\treturn r;\n}\nint num(){\n\tint ans = 0;\n\twhile( s[p] >= '0' && s[p] <= '9'){\n\t\tans = ans * 10 + s[p] - '0';\n\t\tp++;\n\t}\n\treturn ans;\n}\n\nint two(){\n\tint r = num();\n\twhile( s[p] == '+' ){\n\t\tchar c = s[p];\n\t\tp++;\n\t\tint l = three();\n\t\tr += l;\n\t}\n\treturn r;\n}\n\nint three(){\n\tint r = num();\n\twhile( s[p] == '*' ){\n\t\tchar c = s[p];\n\t\tp++;\n\t\tint l = num();\n\t\tr *= l;\n\t}\n\treturn r;\n}\nsigned main(){\n\tcin >> s >> n;\n\ts += \"~\";\n\tp = 0;\n\tint b = 0;\n\tif( one() == n ) b += 1;\n\tp = 0;\n\tif( two() == n ) b += 2;\n\tstring table = \"ILMU\";\n\tcout << table[b] << endl;\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstring str;\nint n;\n\nint calcM(int pos)\n{\n    stack <int> st;\n    st.push(str[pos] - '0');\n    for (int i = pos + 1; i < str.length(); i++){\n        if (str[i] == '+'){\n            continue;\n        }\n        else if (str[i] == '*'){\n            int a = st.top(); st.pop();\n            i++;\n            a *= (str[i] - '0');\n            st.push(a);\n        }\n        else {\n            st.push(str[i] - '0');\n        }\n    }\n    \n    int ret = 0;\n    for (int i = 0; !st.empty(); i++){\n        ret += st.top();\n        st.pop();\n    }\n    return ret;\n}\n\nint calcL(int pos)\n{\n    stack <int> st;\n    st.push(str[pos] - '0');\n    for (int i = pos + 1; i < str.length(); i++){\n        if (str[i] == '+'){\n            int a = st.top(); st.pop();\n            i++;\n            a += (str[i] - '0');\n            st.push(a);\n        }\n        else if (str[i] == '*'){\n            int a = st.top(); st.pop();\n            i++;\n            a *= (str[i] - '0');\n            st.push(a);\n        }\n    }\n    \n    return st.top();\n}\n\nint main(void)\n{\n    cin >> str >> n;\n    \n    int retM = calcM(0);\n    int retL = calcL(0);\n    \n    if (retM == n && retL != n){\n        cout << \"M\" << endl;\n    }\n    else if (retM != n && retL == n){\n        cout << \"L\" << endl;\n    }\n    else if (retM == n && retL == n){\n        cout << \"U\" << endl;\n    }\n    else {\n        cout << \"I\" << endl;\n    }\n    \n    \n    return 0;\n    \n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\ntypedef pair<ll,ll> P;\ntypedef pair<ll,P> PP;\nconst ll MOD = 1e9+7;\n\nint main(){\n  string s;\n  ll t;\n  cin>>s>>t;\n  int n=s.size();\n  ll sn[20];\n\n  ll mf=0;\n  for(int i=0;i<n;i++){\n\tif(s[i]=='+')sn[i]=0;\n\telse if(s[i]=='*')sn[i]=1;\n\telse sn[i]=s[i]-'0';\n  }\n  for(int i=0;i<n;i++){\n\tif(i%2&&sn[i]){\n\t  sn[i+1]=sn[i-1]*sn[i+1];\n\t  sn[i-1]=0;\n\t  sn[i]=0;\n\t}\n  }\n  for(int i=0;i<n;i++){\n\tmf+=sn[i];\n  }\n\n  ll ltr=s[0]-'0';\n  for(int i=1;i<n;i+=2){\n\tif(s[i]=='+')ltr+=(ll)(s[i+1]-'0');\n\telse ltr*=(ll)(s[i+1]-'0');\n  }\n\n  if(t==mf&&t==ltr)cout<<\"U\"<<endl;\n  else if(t==mf)cout<<\"M\"<<endl;\n  else if(t==ltr)cout<<\"L\"<<endl;\n  else cout<<\"I\"<<endl;\n  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing vi = vector<int>;\nusing vvi = vector<vi>;\nusing vs = vector<string>;\nusing msi = map<string, int>;\nusing mii = map<int, int>;\nusing psi = pair<string, int>;\nusing pii = pair<int, int>;\nusing vlai = valarray<int>;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define range(i,s,n) for(int i=s;i<n;i++)\n#define all(a) a.begin(),a.end()\n#define rall(a) a.rbegin(),a.rend()\n#define fs first\n#define sc second\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define INF 1E9\n#define EPS 1E-9\n#define MOD (1E9+7)\n#define PI 3.1415926535897932384\n\nstd::ostream &operator<<(std::ostream &out, const vector<int> &tgt)\n{\n\tstring s;\n\tfor (int i = 0; i<tgt.size(); i++) {\n\t\ts += (to_string(tgt[i]) + ((i != tgt.size() - 1) ? \" \" : \"\"));\n\t}\n\tout << s;\n\treturn out;\n}\n\nll anl(string s) {\n\tif (s.size() == 1)return s[0] - '0';\n\trep(i, s.size()) {\n\t\tif (s[i] == '+') {\n\t\t\treturn anl(s.substr(0,i)) + anl(s.substr(i+1));\n\t\t}\n\t}\n\trep(i, s.size()) {\n\t\tif (s[i] == '*') {\n\t\t\treturn anl(s.substr(0, i)) * anl(s.substr(i + 1));\n\t\t}\n\t}\n}\n\n\nbool mtest(string s, ll n) {\n\tll ans = anl(s);\n\treturn ans == n;\n\n}\n\nbool ltest(string s, ll n) {\n\tll ans = 0;\n\tans = s[0] - '0';\n\tint i = 1;\n\trange(i,1, s.size()) {\n\t\tif (s[i] == '+') {\n\t\t\tans += s[i + 1]-'0';\n\t\t}\n\t\telse ans *= s[i + 1]-'0';\n\t\ti++;\n\t}\n\treturn ans == n;\n}\n\nvoid solve(string s, ll n) {\n\tchar c = 'U';\n\tbool m = mtest(s, n), l = ltest(s, n);\n\tif (m&&l)c = 'U';\n\telse if (m)c = 'M';\n\telse if (l)c = 'L';\n\telse c = 'I';\n\tcout << c << endl;\n}\n\n\nint main() {\n\tstring s;\n\tll n;\n\twhile (cin >> s) {\n\t\tcin >> n;\n\t\tsolve(s, n);\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>  \nusing namespace std;\nconst int INF = 999;\n//世界一競技プログラミングができない人のソース2\n#define int long long\nint get_number(string str, int& idx){\n  int ret = 0;\n  while(isdigit(str[idx])){\n    ret = ret * 10 + str[idx] - '0';\n    ++idx;\n  }\n  return ret;\n}\n\nint Expression(string str, int& idx){\n  int ret = get_number(str, idx);\n  while(true){\n    switch(str[idx]){\n    case '*':\n      ++idx;\n      ret *= get_number( str, idx);\n      break;\n    default:\n      return ret;\n    }\n  }\n}\n\nint nomal(string str, int idx = 0){\n  int res = Expression(str, idx);\n  while(true){\n    switch(str[idx]){\n    case '+':\n      ++idx;\n      res += Expression(str, idx);\n      break;\n    default:\n      return res;\n    }\n  }\n}\nint special(string str, int idx = 0){\n  int ret = get_number(str, idx);\n  while(idx < str.size()){\n    if(str[idx] == '+') ret += get_number(str, ++idx);\n    if(str[idx] == '*') ret *= get_number(str, ++idx);\n    else break;\n  }\n  return ret;\n}\n\nsigned main(){\n  string str;\n  cin >> str;\n  str += \"~\";\n  int digit;\n  cin >> digit;\n\n  bool judge_a = nomal(str) == digit;\n  bool judge_b = special(str) == digit;\n  if(judge_a & judge_b){\n    cout << \"U\" << endl;\n  } else if( judge_a){\n    cout << \"M\" << endl;\n  } else if( judge_b){\n    cout << \"L\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "/* main code starts from line 155. */\n\n/* ---------- STL Libraries ---------- */\n\n// IO library\n#include <cstdio>\n#include <iomanip>\n#include <ios>\n#include <iostream>\n\n// algorithm library\n#include <algorithm>\n#include <cmath>\n#include <numeric>\n\n// container library\n#include <array>\n#include <bitset>\n#include <map>\n#include <queue>\n#include <set>\n#include <string>\n#include <vector>\n\n/* ---------- Namespace ---------- */\n\nusing namespace std;\n\n/* ---------- Type Abbreviation ---------- */\n\ntemplate <typename T>\nusing V = vector<T>;\ntemplate <typename T, typename U>\nusing P = pair<T, U>;\ntemplate <typename T>\nusing PQ = priority_queue<T>;\ntemplate <typename T>\nusing GPQ = priority_queue<T, vector<T>, greater<T>>;\n\nusing ll = long long;\n\n#define fst first\n#define snd second\n#define pb push_back\n#define mp make_pair\n#define mt make_tuple\n\n/* ---------- conversion ---------- */\n\n#define INT(c) static_cast<int>(c)\n#define CHAR(n) static_cast<char>(n)\n#define LL(n) static_cast<ll>(n)\n#define DOUBLE(n) static_cast<double>(n)\n\n/* ---------- container ---------- */\n\n#define ALL(v) (v).begin(), (v).end()\n#define SIZE(v) (LL((v).size()))\n\n#define FIND(v, k) (v).find(k) != (v).end()\n#define VFIND(v, k) find(ALL(v), k) != (v).end()\n\n#define SORT(v) sort(ALL(v))\n#define GSORT(v) sort(ALL(v), greater<decltype((v).front())>())\n\n/* ---------- repetition ---------- */\n\n#define FOR(i, a, b) for (ll i = (a); i <= (b); i++)\n#define RFOR(i, a, b) for (ll i = (a); i >= (b); i--)\n\n/* ---------- Short Functions ---------- */\n\ntemplate <typename T>\nT sq(T a) {\n    return a * a;\n}\n\ntemplate <typename T>\nT gcd(T a, T b) {\n    if (a > b) return gcd(b, a);\n    return a == 0 ? b : gcd(b % a, a);\n}\n\ntemplate <typename T>\nT mypow(T b, T n) {\n    if (n == 0) return 1;\n    if (n == 1) return n;\n    if (n % 2 == 0) {\n        return mypow(sq(b), n / 2);\n    } else {\n        return mypow(b, n - 1) * b;\n    }\n}\n\n/* --------------------\ntemplate <typename T>\nT mypow(T b, T n) {\n    if (n == 0) return 1;\n    if (n == 1) return n % MOD;\n    if (n % 2 == 0) {\n        return mypow(sq(b) % MOD, n / 2);\n    } else {\n        return mypow(b, n - 1) * b % MOD;\n    }\n}\n-------------------- */\n\n#define fcout cout << fixed << setprecision(10)\n\n/* ----------- debug ---------- */\n\ntemplate <typename T, typename U>\nvoid testP2(T a, U b) {\n    cout << \"(\" << a << \", \" << b << \")\" << endl;\n    return;\n}\n\ntemplate <typename T>\nvoid testV(T v) {\n    cout << \"[\";\n    for (auto i : v) {\n        cout << i << \", \";\n    }\n    cout << \"\\b\\b]\" << endl;\n    return;\n}\n\ntemplate <typename T>\nvoid testV2(T v) {\n    for (auto sv : v) {\n        testV(sv);\n    }\n    cout << endl;\n    return;\n}\n\n#define GET_VAR_NAME(variable) #variable\n#define test(x) cout << GET_VAR_NAME(x) << \" = \" << x << endl;\n#define testP(p)                      \\\n    cout << GET_VAR_NAME(p) << \" = \"; \\\n    testP2(p.fst, p.snd);\n\n/* ---------- Constants ---------- */\n\n// const ll MOD = 1e9 + 7;\n// const int INF = 1 << 25;\n// const ll INF = 1LL << 50;\n// const double PI = acos(-1);\n// const double EPS = 1e-10;\n// const ll dx[4] = {0, -1, 1, 0};\n// const ll dy[4] = {-1, 0, 0, 1};\n// const ll dx[8] = {-1, 0, 1, -1, 1, -1, 0, 1};\n// const ll dy[8] = {-1, -1, -1, 0, 0, 1, 1, 1};\n\n/* v-v-v-v-v-v-v-v-v Main Part v-v-v-v-v-v-v-v-v */\n\n/* ---------- Type Definition ----------- */\n\n\n/* ---------- Global Variance ----------- */\n\n\n/* ------------- Functions -------------- */\n\n\n/* ----------- Main Function ------------ */\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    string S;\n    cin >> S;\n\n    S = S + \"+0\";\n\n    ll sum = 0, mul = 1;\n    for (ll itr = 0; itr < SIZE(S) - 1; itr += 2) {\n        mul *= S[itr] - '0';\n        if (S[itr + 1] == '+') {\n            sum += mul;\n            mul = 1;\n        }\n    }\n    ll lr = S[0] - '0';\n    for (ll itr = 1; itr < SIZE(S) - 1; itr += 2) {\n        if (S[itr] == '+') {\n            lr += S[itr + 1] - '0';\n        } else {\n            lr *= S[itr + 1] - '0';\n        }\n    }\n\n    ll K;\n    cin >> K;\n\n    ll judge = ((lr == K) << 1) + (sum == K);\n    cout << \"IMLU\"[judge] << endl;\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <stdio.h>\nusing namespace std;\nstring s;\nlong long ans;\nint cur;\nlong long suu(){\n  string num = \"\";\n  while(cur < s.size() && '0' <= s[cur] && s[cur] <= '9' ){\n\tfflush(stdout);\n\tnum += s[cur];\n\tcur++;\n  }\n\n  return stoll(num);\n}\nlong long kou(){\n  long long res = suu();\n  if(cur < s.size() && s[cur] == '*'){\n\tcur++;\n\tres *= kou();\n  }\n  return res;\n}\nlong long siki(){\n  long long res = kou();\t\n  if(cur < s.size() && s[cur] == '+'){\n\tcur++;\n\tres += siki()\n\n  }\n  return res;\n}\nlong long left_siki(){\n  long long res = suu();\n  char op;\n  while( cur < s.size() && ((op = s[cur]) == '+' || (op == '*') ) ){\n\tcur++;\n\tif(op == '+'){\n\t  res += suu();\n\t}else if(op == '*'){\n\t  res *=  suu();\n\t}\n  }\n  return res;\n}\nint main(){\n  cur = 0;\n  cin >> s >> ans;\n  long long res1 = siki();\n\n  cur = 0;\n  long long res2 = left_siki();\n  \n  int flag = 0;\n  if(res1 == ans){\n\tflag = 1;\n  }\n  if(res2 == ans){\n\tflag |= 2;\n  }\n\n  if(flag == 0)cout << \"I\" << endl;\n  else if(flag == 3)cout << \"U\" << endl;\n  else if(flag == 1) cout << \"M\" << endl;\n  else if(flag == 2) cout << \"L\" << endl;\n  \n  return 0;\n  \n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\nint calc1(string str){//multiplication-first\n\tstack<int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push(stoi(rststr));\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10(stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10(tmp)+1);\n\t\t\tint tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10(tmp)+1);\n\t\t}\n\t}\n\tint rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nint calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tint rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10(rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nint calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10(stoi(rststr))+1);\n\tint rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10(tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10(tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\tcin >> str;\n\tint ans;\n\tcin >> ans;\n\tint rst1 = calc1(str);\n\tint rst2 = calc3(str);\n\t//cout << rst1 << \" \" << rst2 << endl;\n\tif(rst1==ans){\n\t\tif(rst2==ans) cout << 'U' << endl;\n\t\telse cout << 'M' << endl;\n\t}else{\n\t\tif(rst2==ans) cout << 'L' << endl;\n\t\telse cout << 'I' << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\nint calc1(string str){//multiplication-first\n\tstack<int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push((int)stoi(rststr));\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t\tint tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\tint rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nint calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tint rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nint calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\tint rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\twhile(cin >> str){\n\t\tcin >> str;\n\t\tint ans;\n\t\tcin >> ans;\n\t\tint rst1 = calc2(str);\n\t\tint rst2 = calc3(str);\n\t\t//cout << rst1 << \" \" << rst2 << endl;\n\t\tif(rst1==ans){\n\t\t\tif(rst2==ans) cout << 'U' << endl;\n\t\t\telse cout << 'M' << endl;\n\t\t}else{\n\t\t\tif(rst2==ans) cout << 'L' << endl;\n\t\t\telse cout << 'I' << endl;\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\nint ctoi(char c) {\n\tint i; char ch = '1';\n\tfor (i = 1; i < 10; i++){\n\t\tif (c == ch)return i;\n\t\telse ch++;\n\t}\n\treturn -1;\n}\nint main() {\n\tstring s; cin >> s;\n\tint ans1 = 0, ans2, anss = 0;\n\tfor (int i = 0; i < s.size(); i += 2) {\n\t\tif (i == 0) { anss = ctoi(s[i]); ans2 = ctoi(s[i]); }\n\t\telse if (i % 2 == 0) {\n\t\t\tif (s[i - 1] == '+') {\n\t\t\t\tans1 += anss;\n\t\t\t\tanss = ctoi(s[i]);\n\t\t\t\tans2 += ctoi(s[i]);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tanss *= ctoi(s[i]);\n\t\t\t\tans2 *= ctoi(s[i]);\n\t\t\t}\n\t\t}\n\t}\n\tans1 += anss;\n\tint v; cin >> v;\n\tif (ans1 == v) {\n\t\tif (ans2 == v)\n\t\t\tcout << \"U\\n\";\n\t\telse\n\t\t\tcout << \"M\\n\";\n\t}\n\telse {\n\t\tif (ans2 == v)\n\t\t\tcout << \"L\\n\";\n\t\telse\n\t\t\tcout << \"I\\n\";\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n \n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n \nstring gettopnum(string str){\n    string rst = \"\";\n    REP(i,str.size()){\n        if(str[i]=='*'||str[i]=='+') break;\n        else rst += str[i];\n    }\n    return rst;\n}\nll int calc1(string str){//multiplication-first\n    stack<ll int> st;\n    string rststr = gettopnum(str);\n    if(rststr!=\"\") st.push((ll int)stoi(rststr));\n    if(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n    while(str.size()!=0){\n        //cout << str << endl;\n        if(str[0]=='*'){\n            str.erase(str.begin(),str.begin()+1);\n            ll int tmp = stoi(gettopnum(str));\n            str.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n            ll int tmp2 = st.top();\n            st.pop();\n            st.push(tmp*tmp2);\n        }else if(str[0]=='+'){\n            str.erase(str.begin(),str.begin()+1);\n            ll int tmp = stoi(gettopnum(str));\n            st.push(tmp);\n            str.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n        }\n    }\n    ll int rst = 0;\n    while(!st.empty()){\n        rst += st.top();\n        st.pop();\n    }\n    return rst;\n}\n \nll int calc2(string str){////multiplication-first2\n    //cout << str << endl;\n    string rststr = gettopnum(str);\n    ll int rst;\n    if(rststr!=\"\") rst = stoi(rststr);\n    if(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)rst)+1);\n    if(str.size()==0) return rst;\n    else if(str[0]=='*') {\n        str.erase(str.begin(),str.begin()+1);\n        return rst*calc2(str);\n    }else if(str[0]=='+'){\n        str.erase(str.begin(),str.begin()+1);\n        return rst+calc2(str);\n    }\n    //dummy\n    return -1;\n}\n \nll int calc3(string str){//leftto-right\n    string rststr = gettopnum(str);\n    if(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n    ll int rst = stoi(rststr);\n    while(str.size()!=0){\n        //cout << str << endl;\n        if(str[0]=='*'){\n            str.erase(str.begin(),str.begin()+1);\n            ll int tmp = stoi(gettopnum(str));\n            rst *= tmp;\n            str.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n        }else if(str[0]=='+'){\n            str.erase(str.begin(),str.begin()+1);\n            ll int tmp = stoi(gettopnum(str));\n            rst += tmp;\n            str.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n        }\n    }\n    return rst;\n}\n \nint main(){\n    string str;\n    cin >> str;\n    ll int ans;\n    cin >> ans;\n    ll int rst1 = calc1(str);\n    ll int rst2 = calc3(str);\n    //cout << rst1 << \" \" << rst2 << endl;\n    if(rst1==ans){\n        if(rst2==ans) cout << 'U';\n        else cout << 'M' ;\n    }else{\n        if(rst2==ans) cout << 'L' ;\n        else cout << 'I';\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stack>\nusing namespace std;\nstring s;\nint n;\nint p;\n\nint getNum(){\n  int res=0;\n  while('0'<=s[p]&&s[p]<='9'){\n    res*=10;\n    res+=(s[p]-'0');\n    p++;\n  }\n  return res;\n}\n\nint calc(){\n  stack<int> st;\n  st.push(getNum());\n  while(1){\n    char ch=s[p++];\n    if(ch=='=')break;\n    int num=getNum();\n    if(ch=='+')st.push(num);\n    else if(ch=='*'){\n      int x=st.top();st.pop();\n      st.push(x*num);\n    }\n  }\n  int res=0;\n  while(!st.empty()){\n    res+=st.top();\n    st.pop();\n  }\n  return res;\n}\n\nint calc2(){\n  int res=getNum();\n  while(1){\n    char ch=s[p++];\n    if(ch=='=')break;\n    int num=getNum();\n    if(ch=='+')res+=num;\n    else if(ch=='*')res*=num;\n  }\n  return res;\n}\n\nint main(){\n  cin>>s>>n;\n  s+=\"=\";\n  p=0;\n  int a=calc();\n  p=0;\n  int b=calc2();\n  if(a==n&&b!=n)cout<<'M'<<endl;\n  else if(a!=n&&b==n)cout<<'L'<<endl;\n  else if(a==n&&b==n)cout<<'U'<<endl;\n  else cout<<'I'<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cctype>\n#include <cassert>\n#include <string>\n#include <vector>\n#include <algorithm>\n\nint parse(\n    const std::string &s, size_t &i, const std::vector<std::string> &ops,\n    size_t preced=0) {\n\n  if (preced == ops.size()) {\n    assert(isdigit(s[i]));\n    return s[i++]-'0';\n  }\n  int res=parse(s, i, ops, preced+1);\n  while (i < s.length()) {\n    char op=s[i];\n    if (!std::count(ops[preced].begin(), ops[preced].end(), op)) break;\n    int tmp=parse(s, ++i, ops, preced+1);\n    if (op == '+') res += tmp;\n    if (op == '*') res *= tmp;\n  }\n  return res;\n}\n\nint main() {\n  char buf[32];\n  scanf(\"%s\", buf);\n  std::string s=buf;\n  int bob;\n  scanf(\"%d\", &bob);\n\n  int st=0;\n  {\n    size_t i=0;\n    int res=parse(s, i, {\"+\", \"*\"});\n    if (res == bob) st |= 1;\n  }\n  {\n    size_t i=0;\n    int res=parse(s, i, {\"+*\"});\n    if (res == bob) st |= 2;\n  }\n  printf(\"%c\\n\", \"IMLU\"[st]);\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\nint main() {\n\tchar c[19];\n\tint a;\n\tint d[10];\n\tint x1;\n\tint x2 = 0;\n\tint z = 0;\n\tint count = 1;\n\n\tfor (int i = 0; i < 19; i++) {\n\t\tc[i] = 'x';\n\t}\n\n\tfor (int i = 0; i < 10; i++) {\n\t\td[i] = -1;\n\t}\n\n\tcin >> c >> a;\n\n\tx1 = (int)(c[0] - '0');\n\n\tfor (int i = 1; c[i] != 'x'; i += 2) {\n\t\tif (c[i] == '+') {\n\t\t\tx1 += (int)(c[i + 1] - '0');\n\t\t}\n\t\telse if (c[i] == '*') {\n\t\t\tx1 *= (int)(c[i + 1] - '0');\n\t\t}\n\t}\n\n\td[0] = (int)(c[0] - '0');\n\n\tfor (int i = 1; c[i] != 'x'; i += 2) {\n\t\tif (c[i] == '+') {\n\t\t\td[count] = (int)(c[i + 1] - '0');\n\t\t\tcount++;\n\t\t}\n\t\telse if (c[i] == '*') {\n\t\t\td[count - 1] *= (int)(c[i + 1] - '0');\n\t\t}\n\t}\n\n\tfor (int i = 0; d[i] != -1; i++) {\n\t\tx2 += d[i];\n\t}\n\n\tif (x1 == a && x2 != a) {\n\t\tcout << \"L\" << endl;\n\t}\n\telse if (x1 != a && x2 == a) {\n\t\tcout << \"M\" << endl;\n\t}\n\telse if (x1 == a && x2 == a) {\n\t\tcout << \"U\" << endl;\n\t}\n\telse if (x1 != a && x2 != a) {\n\t\tcout << \"I\" << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n  string s; cin>>s;\n  int ans; cin>>ans;\n\n  long long int m_rule=0;\n  for(int i=0;i<s.size();i++){\n    if(s[i]=='*'){\n      long long int pro=s[i-1]-'0';\n      for(i=i+2;i<s.size();i+=2){\n\tif(s[i]=='*'){\n\t  pro*=s[i-1]-'0';\n\t}\n\telse{\n\t  break;\n\t}\n      }\n      pro*=s[i-1]-'0';\n      m_rule+=pro;\n    }\n  }\n\n  if(s.size()>1  && s[1]=='+') m_rule+=s[0]-'0';\n  if(s.size()>2 && s[s.size()-2]=='+') m_rule+=s[s.size()-1]-'0';\n  for(int i=2;i+1<s.size();i++){\n    if(s[i-1]=='+' && s[i+1]=='+'){\n      m_rule+=s[i]-'0';\n    }\n  }\n\n  long long int l_rule=s[0]-'0';\n  for(int i=1;i<s.size();i+=2){\n    if(s[i]=='+') l_rule+=s[i+1]-'0';\n    else l_rule*=s[i+1]-'0';\n  }\n\n  if(l_rule==ans && m_rule==ans) cout<<\"U\"<<endl;\n  else if(l_rule==ans) cout<<\"L\"<<endl;\n  else if(m_rule==ans) cout<<\"M\"<<endl;\n  else cout<<\"I\"<<endl;\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define fo(i,a,b) for (int i = (a); i < (b); i++)\n#define FO(i,a,b) for (int i = (a); i < (b); i++)\n#define pb push_back\n#define eb emplace_back\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int,int> pii;\n\nchar str[1005];\nll T;\n\nll parse1() {\n    int len = strlen(str);\n    ll cN = 1;\n    ll totV = 0;\n    for (int i = 0; i < len; i+= 2) {\n        cN *= (str[i]-'0');\n        if (i == len-1 || str[i+1] == '+') {\n            totV += cN;\n            cN = 1;\n        }\n    }\n    return totV;\n}\n\nll parse2() {\n    int len = strlen(str);\n    ll cN = (str[0]-'0');\n    for (int i = 2; i < len; i += 2) {\n        if (str[i-1] == '+') {\n            cN += (ll)(str[i]-'0');\n        } else {\n            cN *= (long long)(str[i]-'0');\n        }\n    }\n    return cN;\n}\n\nint main() {\n    scanf (\"%s \", str);\n    scanf (\"%lld\", &T);\n    int c1 = (parse1() == T);\n    int c2 = (parse2() == T);\n    if (c1 && c2) {\n        printf (\"U\\n\");\n    } else if (c1) {\n        printf (\"M\\n\");\n    } else if (c2) {\n        printf (\"L\\n\");\n    } else {\n        printf (\"I\\n\");\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) begin(a),end(a)\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10  fixed<<setprecision(5)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<short, short> P;\ntypedef complex<double> Point;\ntypedef long long ll;\nconst int INF = 1145141919;\nconst int MOD = 100000007;\nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\nstruct edge\n{\n\tint from, to, cost;\n\tbool operator < (const edge& e) const { return cost < e.cost; }\n\tbool operator > (const edge& e) const { return cost > e.cost; }\n};\n///*************************************************************************************///\n///*************************************************************************************///\n///*************************************************************************************///\n\n\nint main()\n{\n\tstring s; int n;\n\tcin >> s >> n;\n\tll mul = 0; ll ltr = s[0];\n\tint l = s.size();\n\tFOR(i,2, l)\n\t{\n\t\tif (isdigit(s[i]))\n\t\t{\n\t\t\tif (s[i - 1] == '+') ltr += s[i];\n\t\t\telse ltr *= s[i];\n\t\t}\n\t}\n\tvector<ll> v;\n\tREP(i, l)\n\t{\n\t\tif (isdigit(s[i])) v.push_back(s[i] - '0');\n\t\telse if (s[i] == '+') v.push_back(-1);\n\t\telse v.push_back(-2);\n\t}\n\tbool update = true;\n\twhile (update)\n\t{\n\t\tupdate = false;\n\t\tREP(i, v.size())\n\t\t{\n\t\t\tif (v[i] == -2)\n\t\t\t{\n\t\t\t\tupdate = true;\n\t\t\t\tv[i - 1] = v[i - 1] * v[i + 1];\n\t\t\t\tv.erase(v.begin() + i);\n\t\t\t\tv.erase(v.begin() + i);\n\t\t\t}\n\t\t}\n\t}\n\tREP(i, v.size()) if (v[i] >= 0) mul += v[i];\n\tif (n == mul&&n == ltr) puts(\"U\");\n\telse if (n == mul) puts(\"M\");\n\telse if (n == ltr) puts(\"L\");\n\telse puts(\"I\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \n#define _overload(_1,_2,_3,name,...) name\n#define _rep(i,n) _range(i,0,n)\n#define _range(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define rep(...) _overload(__VA_ARGS__,_range,_rep,)(__VA_ARGS__)\n \n#define _rrep(i,n) _rrange(i,n,0)\n#define _rrange(i,a,b) for(int i=(int)(a)-1;i>=(int)(b);--i)\n#define rrep(...) _overload(__VA_ARGS__,_rrange,_rrep,)(__VA_ARGS__)\n \n#define _all(arg) begin(arg),end(arg)\n#define uniq(arg) sort(_all(arg)),(arg).erase(unique(_all(arg)),end(arg))\n#define getidx(ary,key) lower_bound(_all(ary),key)-begin(ary)\n#define clr(a,b) memset((a),(b),sizeof(a))\n#define bit(n) (1LL<<(n))\n \n// #define DEBUG\n \n#ifdef DEBUG\n    #define dump(...) fprintf(stderr, __VA_ARGS__)\n#else\n    #define dump(...)\n#endif\n \ntemplate<class T>bool chmax(T &a, const T &b) { return (a<b)?(a=b,1):0;}\ntemplate<class T>bool chmin(T &a, const T &b) { return (b<a)?(a=b,1):0;}\n \nusing namespace std;\nusing ll=long long;\nusing vi=vector<int>;\nusing vll=vector<ll>;\n \nconst double EPS = 1e-10;\nconst double PI = acos(-1.0);\nconst ll inf =1LL << 62;\nconst ll mod=1000000007LL;\nconst int dx[4]={1,0,-1,0};\nconst int dy[4]={0,1,0,-1};\n \n \nll extgcd(ll a,ll b,ll& x,ll& y){x=1,y=0;ll g=a;if(b!=0) g=extgcd(b,a%b,y,x),y-=a/b*x;return g;}\nll ADD(const ll &a, const ll &b,const ll &mod) { return (a+b)%mod;}\nll SUB(const ll &a, const ll &b,const ll &mod) { return (a-b+mod)%mod;}\nll MUL(const ll &a, const ll &b,const ll &mod) { return (1LL*a*b)%mod;}\nll DIV(const ll &a, const ll &b,const ll &mod) {ll x,y; extgcd(b,mod,x,y);return MUL(a,(x+mod)%mod,mod);}\n \nrandom_device rd;\nmt19937 mt(rd());\nuniform_int_distribution<int> dice(1,6);\nuniform_real_distribution<double> score(0.0,10.0);\n\nint parse(string& formula){\n    int idx = 0;\n    int ret = 0;\n\n    int len = formula.size();\n    while(idx < len){\n        int diff = formula[idx] - '0';\n        idx++;\n\n        if(idx >= len){\n            ret += diff;\n            break;\n        }\n\n        char op = formula[idx];\n        idx++;\n        while(op == '*'){\n            int cur = formula[idx] - '0';\n            idx++;\n            diff *= cur;\n\n            if(idx >= len) break;\n            op = formula[idx];\n            idx++;\n        }\n\n        ret += diff;\n    }\n\n    return ret;\n}\n\nint main(void){\n    string in; cin >> in;\n    int bob_res; cin >> bob_res;\n\n    int l_res = in[0] - '0';\n    int len = in.size();\n    rep(i, 1, len){\n        char op = in[i];\n        i++;\n\n        int cur = in[i] - '0';\n        switch(op){\n            case '*': { l_res *= cur; break; }\n            case '+': { l_res += cur; break; }\n        }\n    }\n    int f_res = parse(in);\n\n    char res = 'I';\n    if(l_res == bob_res and f_res == bob_res){\n        res = 'U';\n    }\n    else if(l_res == bob_res){\n        res = 'L';\n    }\n    else if(f_res == bob_res){\n        res = 'M';\n    }\n\n    cout << res << endl;\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\n\nstring s;\nint n;\nint p;\n\nint one();\nint two();\nint num();\nint three();\nint one(){\n\tint r = num();\n\twhile( s[p] == '+' || s[p] == '*' ){\n\t\tchar c = s[p];\n\t\tp++;\n\t\tint l = num();\n\t\tif( c == '*' ){\n\t\t\tr *= l;\n\t\t}else{\n\t\t\tr += l;\n\t\t}\n\t\tif( r > 999999999 ) throw \"!\";\n\t}\n\treturn r;\n}\nint num(){\n\tint ans = 0;\n\twhile( s[p] >= '0' && s[p] <= '9'){\n\t\tans = ans * 10 + s[p] - '0';\n\t\tp++;\n\t}\n\tif( ans > 999999999 ) throw \"!\";\n\treturn ans;\n}\n\nint two(){\n\tint r = num();\n\twhile( s[p] == '+' ){\n\t\tchar c = s[p];\n\t\tp++;\n\t\tint l = three();\n\t\tr += l;\n\t\tif( r > 999999999 ) throw \"!\";\n\t}\n\treturn r;\n}\n\nint three(){\n\tint r = num();\n\twhile( s[p] == '*' ){\n\t\tchar c = s[p];\n\t\tp++;\n\t\tint l = num();\n\t\tr *= l;\n\t\tif( r > 999999999 ) throw \"!\";\n\t}\n\treturn r;\n}\nsigned main(){\n\tcin >> s >> n;\n\ts += \"~\";\n\tp = 0;\n\tint b = 0;\n\ttry{\n\t\tif( one() == n ) b += 1;\n\t}catch(const char *msg){\n\t\t//bad\n\t}\n\tp = 0;\n\ttry{\n\t\tif( two() == n ) b += 2;\n\t}catch(const char *msg){\n\t\t\t//bad\n\t}\n\tstring table = \"ILMU\";\n\tcout << table[b] << endl;\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n#define MOD ((int)1e9+7)\n\nsigned  main(){\n  stack<int> sta, sta2;\n  string s;\n  int a = 0, b = 0, r;\n\n  cin>>s>>r;\n\n  //sta.push(s[0] - '0');\n  \n  for(int i = 0; i < s.size(); i++){//cout<<i<<endl;\n    if(s[i] == '+'){//cout<<\"+\"<<endl;\n      sta.push(-1);\n    } else if(s[i] == '*'){//cout<<\"-\"<<endl;\n      sta.push(-2);\n    } else{\n         int temp3 = s[i] - '0';\n      if(sta.size() == 0){\n\tsta.push(temp3);\n      } else {\n      int temp = sta.top(), temp2;//sta.pop();\n      if(temp == -1) {\n\tsta.pop();\n\ttemp2 = sta.top();sta.pop();\n\tsta.push(temp2 + temp3);\n      } else if(temp == -2){\n\tsta.pop();\n\ttemp2 = sta.top(); sta.pop();\n\tsta.push(temp2*temp3);\n      } else {\n\tsta.push(temp3);\n\t\n      }\n      }\n      //  cout<<sta.top()<<endl;\n    }\n  }\n  \n  for(int i = 1; sta.size(); i++){\n    b += sta.top(); sta.pop();\n  }\n  \n    \n  for(int i = 0; i < s.size(); i++){//cout<<i<<\" <-i \"<<endl;\n    if(s[i] == '+'){//cout<<\"+\"<<endl;\n      // sta.push(-1);\n    } else if(s[i] == '*'){//cout<<\"-\"<<endl;\n       sta2.push(-2);\n    } else{\n      // cout<<\"<><><><><><><   \"<<endl;\n      if(sta2.size() == 0){\n\t//cout<<\"fhdsjklfhdsjlkfhsjflkdshf SIZE -->\"<<sta2.size()<<\" \"<<s[i]-'0'<<endl; \n\tsta2.push(s[i] - '0');\n      }else {\n\t//cout<<\"[][][][][][][][][][][][][][][][][\"<<\" \"<<sta2.size()<<endl;\n\t\tint temp = sta2.top();\n\tif(temp == -2){\n\t  sta2.pop();\n\t  int temp2 = sta2.top(); sta2.pop();\n\t  //cout<<temp2<<\" *  \"<<s[i]-'0'<<endl;\n\t  sta2.push((s[i]-'0')*temp2);\n\t} else {\n\t  // cout<<s[i]-'0'<<endl;\n\t  sta2.push(s[i] - '0');\n\t}\n      }\n    }\n    \n  }\n  //cout<<\"stack siza ---> \"<<sta2.size()<<endl;\n for(; sta2.size();){\n    a += sta2.top(); sta2.pop();\n  }\n    \n\n //cout<<a<<\" \"<<b<<endl;\n\n    if(a == r && b == r){\n      cout<<'U'<<endl;\n    } else if(a == r){\n      cout<<'M'<<endl;\n    } else if(b == r){\n      cout<<'L'<<endl;\n    } else {\n      cout<<'I'<<endl;\n    }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<functional>\nusing namespace std;\nint main(int argc, char *argv[])\n{\n  string exp;\n  cin >> exp;\n  int ans;\n  cin >> ans;\n  auto parseLR = [](const string &e) {\n    int c = e[0] - '0';\n    for(int i = 1; i < e.size(); i++) {\n      if(e[i] == '*') {\n        c *= e[i+1] - '0';\n        i++;\n      } else if(e[i] == '+') {\n        c += e[i+1] - '0';\n        i++;\n      } else {\n        throw string(\"something wrong!\");\n      }\n    }\n    return c;\n  };\n  auto num = [](const string &e, int &i) {\n    return e[i++] - '0';\n  };\n  auto mul = [&num](const string &e, int &i) {\n    int c = num(e,i);\n    while(i < e.size() && e[i] == '*') {\n      i++;\n      c *= num(e,i);\n    }\n    return c;\n  };\n  auto add = [&mul](const string &e, int &i) {\n    int c = mul(e,i);\n    while(i < e.size() && e[i] == '+') {\n      i++;\n      c += mul(e,i);\n    }\n    return c;\n  };\n  auto parse = [&add](const string &e) {\n    int i = 0;\n    return add(e, i);\n  };\n  bool lr = parseLR(exp) == ans;\n  bool ty = parse(exp) == ans;\n  if(lr && ty) {\n    cout << \"U\" << endl;;\n  } else if(lr) {\n    cout << \"L\" << endl;\n  } else if(ty) {\n    cout << \"M\" << endl;\n  } else {\n    cout << \"I\" << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<stack>\nusing namespace std;\n\nint main()\n{\n    string a;\n    int b, x[3], res1, res2 = 0;\n    stack<int> s, t;\n\n    cin >> a >> b;\n\n    for( int i = 0; i < a.size(); i++ )\n    {\n        s.push(a[i]-'0');\n        if( s.size() == 3 )\n        {\n            for( int j = 0; j < 3; j++ )\n            {\n                x[j] = s.top();\n                s.pop();\n            }\n            if( x[1] == '+' - '0' )\n                s.push( x[0] + x[2] );\n            else\n                s.push( x[0] * x[2] );\n        }\n    }\n\n    res1 = s.top();\n\n    t.push(a[0]-'0');\n    for( int i = 2; i < a.size(); i++ )\n    {\n        if( a[i-1] == '+' )\n            t.push(a[i]-'0');\n        if( a[i-1] == '*' )\n        {\n            x[0] = t.top(); t.pop();\n            t.push(x[0]*(a[i]-'0'));\n        }\n    }\n\n    while( !t.empty() )\n    {\n        res2 += t.top();\n        t.pop();\n    }\n\n    if( b == res1 && b != res2 )\n        cout << 'L';\n    else if( b != res1 && b == res2 )\n        cout << 'M';\n    else if( b == res1 && b == res2 )\n        cout << 'U';\n    else\n        cout << 'I';\n    \n    cout << endl;\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define rep1(i,n) for(int i=1;i<(n);i++)\n#define all(v) (v).begin(),(v).end()\n#define pb(a) push_back(a)\nusing namespace std;\ntypedef long long LL;\n\nint main(){\n  string s;cin >> s;\n  int n;cin >> n;\n  int a=s[0]-'0';\n  for(int i=1;i<s.length();i+=2){\n    if(s[i]=='+') a+=s[i+1]-'0';\n    else a*=s[i+1]-'0';\n  }\n  int b=0,t=1;\n  bool c=false;\n  for(int i=1;i<s.length();i+=2){\n    if(s[i]=='+'){\n      if(c){\n        b+=t*(s[i-1]-'0');\n      }\n      else b+=s[i-1]-'0';\n      t=1;\n    }\n    else if(s[i]=='*'){\n      c=true;\n      t*=s[i-1]-'0'; \n    }\n  }\n  b+=(s[s.length()-1]-'0')*t;\n  if(n==a&&n==b) puts(\"U\");\n  else if(n==a&&n!=b) puts(\"L\");\n  else if(n!=a&&n==b) puts(\"M\");\n  else puts(\"I\");\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define reep(i,a,b) for(int i=(a);i<(b);i++)\n#define rep(i,n) reep((i),0,(n))\nint foo2(string s){\n    int ret=0;\n    stringstream ss;\n    ss<<s;\n    ss>>ret;\n    char t;\n    int tt;\n    // cout<<s<<endl;\n    while(ss>>t){\n        ss>>tt;\n        if(t=='+'){\n            ret+=tt;\n        }\n        else{\n            ret*=tt;\n        }\n    }\n    return ret;\n}\nint foo1(string s){\n    rep(i,s.size()){\n        if(s[i]=='*'){\n            int l=i-1;\n            int r=i+1;\n            while(isdigit(s[l])) l--;\n            while(isdigit(s[r])) r++;\n            l++;\n            r--;\n            stringstream ss;\n            ss<<atoi(s.substr(l,i-l).c_str())*atoi(s.substr(i+1,r-i).c_str());\n            string t;\n            ss>>t;\n            return foo1(s.substr(0,l)+t+s.substr(r+1));\n        }\n    }\n    return foo2(s);\n}\nint main(){\n    string s;\n    int a;\n    cin>>s>>a;\n    // cout<<foo1(s)<<endl;\n    // cout<<foo2(s)<<endl;\n    bool f1=(a==foo1(s));\n    bool f2=(a==foo2(s));\n    if(f1&&f2) cout<<\"U\"<<endl;\n    else if(f1) cout<<\"M\"<<endl;\n    else if(f2) cout<<\"L\"<<endl;\n    else  cout<<\"I\"<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"stdafx.h\"\n#include<iostream>\n#include<string>\n#include<vector>\n\nusing namespace std;\nbool isM(int n,string s)\n{\n\tvector<bool> used(s.length());\n\tfor (int i = 0; i < s.length(); i++)\n\t{\n\t\tused[i] = false;\n\t}\n\tbool flag = false;\n\tint sum = 0;\n\tfor (int i = 1; i < s.length(); i+= 2)\n\t{\n\t\tif (s[i] == '*')\n\t\t{\n\t\t\tif (used[i - 1])\n\t\t\t{\n\t\t\t\tsum *= (s[i + 1] - '0');\n\t\t\t\tused[i + 1] = true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (!flag)\n\t\t\t\t{\n\t\t\t\t\tsum = (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t\t\tflag = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tsum += (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t\t}\n\t\t\t\tused[i - 1] = true;\n\t\t\t\tused[i + 1] = true;\n\t\t\t}\n\t\t\t//cout << sum << endl;\n\t\t}\n\t}\n\tfor (int i = 0; i < s.length(); i += 2)\n\t{\n\t\tif (used[i])continue;\n\t\tsum += (s[i] - '0');\n\t}\n\t//cout << sum << endl;\n\tif (n == sum)return true;\n\telse return false;\n}\n\nbool isL(int n,string s)\n{\n\tif (s.length() == 1 && s[0] - '0' == n)return true;\n\tint sum = 0;\n\tfor (int i = 1; i < s.length(); i += 2)\n\t{\n\t\tif (i == 1)\n\t\t{\n\t\t\tif (s[i] == '+')\n\t\t\t{\n\t\t\t\tsum = s[i - 1] - '0' + (s[i + 1] - '0');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsum = (s[i - 1] - '0') * (s[i + 1] - '0');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (s[i] == '+')\n\t\t\t{\n\t\t\t\tsum += (s[i + 1] - '0');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsum *= (s[i + 1] - '0');\n\t\t\t}\n\t\t}\n\t}\n\n\tif (sum == n)return true;\n\telse return false;\n}\n\nint main()\n{\n\tstring exp;\n\tint n;\n\tcin >> exp;\n\tcin >> n;\n\tif (isM(n, exp) && isL(n, exp))\n\t{\n\t\tcout << \"U\" << endl;\n\t}\n\telse if (isM(n,exp))\n\t{\n\t\tcout << \"M\" << endl;\n\t}\n\telse if (isL(n, exp))\n\t{\n\t\tcout << \"L\" << endl;\n\t}\n\telse\n\t{\n\t\tcout << \"I\" << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n#include<cstdio>\n#include<sstream>\n#include<algorithm>\n#include<cmath>\n#include<map>\n#include<functional>\nusing namespace std;\nint stoi(string x){stringstream ss;ss<<x;int tmp;ss>>tmp;return tmp;}\nstring itos(int x){stringstream ss;ss<<x;return ss.str();}\n//#define __int64 long long\n#define ll __int64 \nint main(){\n\tstring n,a,b,c,tmp;\n\tint a1,a2=0,a3=0;\n\tcin>>n;\n\tcin>>a1;\n\tvector<string>ta,ta2;\n\tfor(int i=0;i<n.size();i++){\n\tif(n[i]=='*'||n[i]=='+'){\n\tta.push_back(tmp);\n\tif(n[i]=='*')ta.push_back(\"*\");\n\tif(n[i]=='+')ta.push_back(\"+\");\n\ttmp.clear();\n\t}\n\telse tmp.push_back(n[i]);\n\t}\n\tta.push_back(tmp);\n\ta2=stoi(ta[0]);\n\tfor(int i=1;i<ta.size();i++){\n\t\tif(ta[i]==\"+\"){\n\t\ta2+=stoi(ta[i+1]);\n\t\ti++;\n\t\t}\n\t\tif(ta[i]==\"*\"){\n\t\ta2*=stoi(ta[i+1]);\n\t\ti++;\n\t\t}\n\t}\n\t\n\tfor(int i=0;i<ta.size();i++){\n\t\tif(ta[i]==\"*\"){\n\t\tta[i]=( itos( stoi(ta[i-1])*stoi(ta[i+1]) ) );\n\t\tta.erase(ta.begin()+i+1);\n\t\tta.erase(ta.begin()+i-1);\n\t\ti--;\n\t\t}\n\t}\n\tfor(int i=0;i<ta.size();i++){\n\tif(ta[i]!=\"+\")a3+=stoi(ta[i]);\n\t}\n\tif(a1==a2&&a1==a3)cout<<\"U\";\n\telse if(a1==a2)cout<<\"L\";\n\telse if(a1==a3)cout<<\"M\";\n\telse cout<<\"I\";\n\tcout<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstring>\n#include <cstdio>\nusing namespace std;\n\nint l_to_r(const char exp[])\n{\n  int sum;\n  sum=(exp[0]-'0');\n  for(int i=1;i+1<strlen(exp);i+=2){\n    if(exp[i]=='*')\n      sum*=(exp[i+1]-'0');\n    else sum+=(exp[i+1]-'0');\n  }\n   \n  return sum;\n}\n\nint mul_fir(char exp[])\n{\n  int mul,sum=0;\n  vector<int> plus;\n  mul=(exp[0]-'0');\n  for(int i=1;i<strlen(exp);i+=2){\n    if(exp[i]=='*')\n      mul*=(exp[i+1]-'0');\n    else {\n      plus.push_back(mul);\n      mul=(exp[i+1]-'0');\n    }\n  }\n  for(int i=0;i<plus.size();i++)\n    sum+=plus[i];\n  \n  return sum+mul;\n}\n\nint main()\n{\n  long long int n,ans1,ans2;\n  char exp[18];\n\n  scanf(\"%s\", exp);\n  cin>>n;\n  ans1=l_to_r(exp);\n  ans2=mul_fir(exp);\n  if(ans1==n&&ans2!=n) cout<<\"L\"<<endl;\n  else if(ans1!=n&&ans2==n) cout<<\"M\"<<endl;\n  else if(ans1==n&&ans2==n) cout<<\"U\"<<endl;\n  else cout<<\"I\"<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define INF 1e9\n#define llINF 1e18\n#define MOD 1000000007\n#define pb push_back\n#define mp make_pair \n#define F first\n#define S second\n#define ll long long\n#define vi vector<ll>\n#define vvi vector<vi>\n#define BITLE(n) (1LL<<((ll)n))\n#define SHIFT_LEFT(n) (1LL<<((ll)n))\n#define SUBS(s,f,t) ((s).substr((f)-1,(t)-(f)+1))\n#define ALL(a) (a).begin(),(a).end()\nusing namespace std;\nint main(){\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n  string s;\n  cin>>s;\n  ll n = s.size();\n  ll num;cin>>num;\n\n  ll lr = 0;\n  bool plus = true;\n  for(int i=0;i<n;i++){\n    if(i%2){\n      if(s[i] == '+')plus = true;\n      else plus = false;\n    }else{\n      if(plus)lr += (s[i]-'0');\n      else lr *= (s[i]-'0');\n    }\n  }\n  ll cl = 0;\n  vi nu;\n  nu.pb(s[0]-'0');\n  for(int i=1;i<n;i+=2){\n    if(s[i] == '+'){\n      nu.pb(s[i+1]-'0');\n    }else{\n      nu[nu.size()-1] *= (s[i+1]-'0');\n    }\n  }\n  //cout<<nu.size()<<endl;\n\n  for(auto a:nu){cl+=a;}\n  //cout<<cl<<\" \"<<lr<<endl;\n  if(cl != num && lr != num){\n    cout<<\"I\"<<endl;\n  }else{\n    if(cl == lr)cout<<\"U\"<<endl;\n    else if(cl == num)cout<<\"M\"<<endl;\n    else cout<<\"L\"<<endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<cstring>\n#include<vector>\n#include<set>\n#include<list>\n#include<queue>\n#include<cmath>\n#include<functional>\n#include<algorithm>\n#define INF (1<<29)\n#define rep(i,n) for(int i=0;i<(n);i++)\nusing namespace std;\n\n\nlong long lefttoright(const string &s){\n\tlong long a=0,b=0;\n\tint i;\n\tchar op;\n\tfor(i=0;i<s.size()&&s[i]!='+'&&s[i]!='*';i++){\n\t\ta*=10;\n\t\ta+=s[i]-'0';\n\t}\n\tif(i==s.size())return a;\n\top=s[i++];\n\tfor(;i<s.size();i++){\n\t\tif(s[i]=='+'||s[i]=='*'){\n\t\t\tif(op=='+'){\n\t\t\t\ta+=b;\n\t\t\t}else{\n\t\t\t\ta*=b;\n\t\t\t}\n\t\t\top=s[i];\n\t\t\tb=0;\n\t\t}else{\n\t\t\tb*=10;\n\t\t\tb+=s[i]-'0';\n\t\t}\n\t}\n\tif(op=='+'){\n\t\ta+=b;\n\t}else{\n\t\ta*=b;\n\t}\n\treturn a;\n}\n\n\nlong long mulfirst(const string &s){\n\tlong long a=0;\n\tint i,j=-1;\n\tfor(i=0;i<s.size();i++){\n\t\tif(s[i]=='+'){\n\t\t\ta+=lefttoright(s.substr(j+1,i-j-1));\n\t\t\tj=i;\n\t\t}\n\t}\n\ta+=lefttoright(s.substr(j+1,s.size()-j-1));\n\treturn a;\n}\n\n\n\nint main(){\n\tstring expr;\n\tint v;\n\tcin>>expr>>v;\n\tchar ans[]=\"IMLU\";\n\tcout<<ans[(v==mulfirst(expr))+2*(v==lefttoright(expr))]<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <cstring>\n#include <cstdlib>\n#include <cstdio>\n#include <stack>\nusing namespace std;\ntypedef long long LL;\nstack <LL> num;\nint pre[300];\nchar str[100];\nvoid calc (char op) {\n     int u = num.top(); num.pop();\n     int v = num.top(); num.pop();\n     if (op == '+')\n        num.push(u+v);\n     else if (op == '*')  \n        num.push(u*v) ;   \n}\nLL solve1 (void) {\n   int n = strlen(str);\n   while ( !num.empty() )\n        num.pop();\n   stack <char> stk;\n   for (int i=0;i<n;++i) \n       if ('0'<= str[i] && str[i]<='9')\n          num.push(str[i]-'0');\n       else {\n          while ( !stk.empty() && pre[stk.top()] > pre[str[i]] ) {\n                calc (stk.top());\n                stk.pop();  \n          }\n          stk.push(str[i]);\n       }   \n   while ( !stk.empty() ) {\n         calc(stk.top());\n         stk.pop();\n   }\n   return num.top();      \n}\nLL solve2 (void) {\n   LL sum = str[0]-'0';\n   int n = strlen(str);\n   for (int i=1;i<n;++i)\n      if (str[i] == '+')\n        sum += str[i+1]-'0';\n      else if ( str[i]=='*' )\n        sum *= str[i+1]-'0';\n   return sum;        \n}\nint main(void) {\n    int bod_ans;\n    pre['+'] = 1;\n    pre['*'] = 2;\n    while ( scanf(\"%s\",str)==1 ) {\n          scanf (\"%lld\",&bod_ans); \n          LL ans1 = solve1();\n          LL ans2 = solve2();\n          if (ans1 == bod_ans && ans2 == bod_ans)\n            puts(\"U\");\n          else if (ans1 == bod_ans)\n            puts(\"M\");\n          else if (ans2 == bod_ans)\n            puts(\"L\");\n          else\n            puts(\"I\");\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\nint main(){\n  string str;\n  vector <int> nums;\n  vector <int> marks;\n  int i,j,k=0,buf;\n  long long m=0,n=0,ans;\n  vector <int> p;\n  int o=0;\n  cin >> str >> ans;\n  j=0;\n  for(i=0;i<str.size();i++){\n    if(str[i]=='+') {\n      nums.push_back(buf);\n      buf=0;\n      marks.push_back(1);\n    }else if(str[i]=='*'){\n      nums.push_back(buf);\n      buf=0;\n      marks.push_back(2);\n      k++;\n    }else{\n      buf*=10;\n      buf+=(str[i]-'0');\n    }\n  }\n  nums.push_back(buf);\n  m=nums[0];\n  for(i=0;i<marks.size();i++){\n    if(marks[i]==1){\n      m+=nums[i+1];\n    }else{\n      m*=nums[i+1];\n    }\n  }\n  i=0;\n  while(i<marks.size()){\n    if(marks[i]==2){\n      nums[i]*=nums[i+1];\n      nums.erase(nums.begin()+i+1);\n      marks.erase(marks.begin()+i);\n    }else{\n      i++;\n    }\n  }\n  \n  n=nums[0];\n  for(i=0;i<marks.size();i++){\n    n+=nums[i+1];\n    //cout << nums[i+1] << endl;\n  }\n  \n\n  //cout << n << \" \" << m << \" \" << ans << endl;\n   \n  if(n==ans){\n    if(m==ans) cout << \"U\" <<endl;\n    else cout << \"M\" <<endl;\t   \n  }else{\n    if(m==ans) cout << \"L\" <<endl;\n    else cout << \"I\" <<endl;\t  \n  } \n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<fstream>\n#include<string>\n#include<vector>\n#include<deque>\n#include<queue>\n#include<stack>\n#include<set>\n#include<map>\n#include<algorithm>\n#include<functional>\n#include<utility>\n#include<bitset>\n#include<cmath>\n#include<cstdlib>\n#include<ctime>\n#include<cstdio>\n\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<int(n);i++)\n#define foreach(c,itr) for(__typeof((c).begin()) itr=(c).begin();itr!=(c).end();itr++)\ntypedef pair<int,int> P;\ntypedef long long ll;\n\nint main(void){\n\n\tstring x;\n\tll a;\n\tcin >> x >> a;\n\n\tint n=x.size();\n\tll lr=x[0]-'0';\n\tint i;\n\tfor(i=1;i<n;i+=2){\n\t\tif(x[i]=='+') lr+=x[i+1]-'0';\n\t\tif(x[i]=='*') lr*=x[i+1]-'0';\n\t}\n\n\tll mf=0,q=1;\n\tif(n==1){\n\t\tif(a==x[0]-'0') cout << \"U\" << endl;\n\t\telse cout << \"I\" << endl;\n\t\treturn 0;\n\t}\n\tfor(i=0;i<n;i+=2){\n\t\tif(i!=0 && i!=n-1) if(x[i-1]=='*' && x[i+1]=='*') q*=x[i]-'0';\n\t\tif((i==0 && x[i+1]=='*') || (x[i-1]=='+' && x[i+1]=='*')) q*=x[i]-'0';\n\t\tif((i==n-1 && x[i-1]=='*') || (x[i-1]=='*' && x[i+1]=='+')){\n\t\t\tq*=x[i]-'0'; mf+=q; q=1;\n\t\t}\n\n\t\tif(i!=0 && i!=n-1) if(x[i-1]=='+' && x[i+1]=='+') mf+=x[i]-'0';\n\t\tif(i==0) if(x[i+1]=='+') mf+=x[i]-'0';\n\t\tif(i==n-1) if(x[i-1]=='+') mf+=x[i]-'0';\n\t}\n\n\n\n\tif(lr==mf && lr==a) cout << \"U\" << endl;\n\telse if(mf==a) cout << \"M\" << endl;\n\telse if(lr==a) cout << \"L\" << endl;\n\telse cout << \"I\" << endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,n) for (int (i)=(0);(i)<(int)(n);++(i))\nusing ll = long long;\nusing P = pair<ll, ll>;\nusing namespace std;\n\ntemplate<class t> void vin(vector<t>& v, int n) {\n    v.resize(n);\n    for (int i = 0; i < n; ++i) {\n        cin >> v[i];\n    }\n}\n\nint get_m(string s) {\n    if (s.size() == 1) return s[0]-'0';\n    vector<string> v;\n    rep(i, s.size()) {\n        if (s[i] != '*') {\n            string tmp = \"\";\n            tmp += s[i];\n            v.push_back(tmp);\n        }\n        else {\n            string last = v[v.size()-1];\n            v.pop_back();\n            int num1 = stoi(last);\n            int num2 = (s[i+1]-'0');\n            int tmp = num1*num2;\n            v.push_back(to_string(tmp));\n            i++;\n        }\n    }\n    if (v.size() == 1) {\n        return stoi(v[0]);\n    }\n    int ret = 0;\n    for (int i=1; i<v.size(); i+=2) {\n        if (i == 1) {\n            ret += stoi(v[i-1])+stoi(v[i+1]);\n        }\n        else {\n            ret += stoi(v[i+1]);\n        }\n    }\n    return ret;\n}\n\nint get_l(string s) {\n    if (s.size() == 1) return s[0]-'0';\n    int ret = -1;\n    for (int i=1; i<s.size(); i+=2) {\n        int num2 = s[i+1]-'0';\n        if (i == 1) {\n            int num1 = s[i-1]-'0';\n            if (s[i] == '+') ret = num1 + num2;\n            else ret = num1 * num2;\n        }\n        else {\n            if (s[i] == '+') ret += num2;\n            else ret *= num2;\n        }\n    }\n    return ret;\n}\n\nint main() {\n    string s;\n    cin >> s;\n    int ans;\n    cin >> ans;\n    int m = get_m(s);\n    int l = get_l(s);\n    string ret = \"\";\n    if (m == ans) {\n        if (l == ans) {\n            ret = \"U\";\n        }\n        else {\n            ret = \"M\";\n        }\n    }\n    else if (l == ans) {\n        ret = \"L\";\n    }\n    else {\n        ret = \"I\";\n    }\n    cout << ret << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\nusing namespace std;\n\nint main() {\n\n  string in;\n  cin >> in;\n\n  long long int a;\n  cin >> a;\n\n  long long int k = 0;\n  char c = '+';\n  long long int n = 1;\n  long long int ans_0 = 0;\n  long long int ans_1 = 0;\n\n  for ( long long int i = 0; i < in.size(); i++ ) {\n\n    if ( in[i] == '+' ) {\n\n      if ( c == '+' ) {\n\tans_0 += k;\n      }else {\n\tans_0 *= k;\n      }\n      c = '+';\n      n *= k;\n      ans_1 += n;\n      k = 0;\n      n = 1;\n\n    }else if ( in[i] == '*' ) {\n\n      if ( c == '+' ) {\n\tans_0 += k;\n      }else {\n\tans_0 *= k;\n      }\n      c = '*';\n      n *= k;\n      k = 0;\n\n    }else {\n\n      k = k * 10 + in[i] - '0';\n\n    }\n\n  }\n\n  if ( c == '+' ) {\n    ans_0 += k;\n  }else {\n    ans_0 *= k;\n  }\n  n *= k;\n  ans_1 += n;\n\n  string s = \"ILMU\";\n\n  k = 0;\n\n  if ( a == ans_0 ) k++;\n  if ( a == ans_1 ) k += 2;\n\n  cout << s[k] << endl;\n\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\n\nint main(){\n\tstring f; cin >> f;\n\tint a; cin >> a;\n\tint n = f.size() / 2;\n\tint l = f[0] - '0';\n\tfor(int i = 0; i < n; i++){\n\t\tif(f[i*2+1] == '+'){\n\t\t\tl += f[i*2+2] - '0';\n\t\t}else{\n\t\t\tl *= f[i*2+2] - '0';\n\t\t}\n\t}\n\tvector<int> v;\n\tv.push_back(f[0] - '0');\n\tfor(int i = 0; i < n; i++){\n\t\tif(f[i*2+1] == '+'){\n\t\t\tv.push_back(f[i*2+2] - '0');\n\t\t}else{\n\t\t\tv[v.size() - 1] *= f[i*2+2] - '0';\n\t\t}\t\n\t}\n\tint m = 0;\n\tfor(auto i: v) m += i;\n\tif(a==m && a==l) cout << 'U' << endl;\n\tif(a!=m && a==l) cout << 'L' << endl;\n\tif(a==m && a!=l) cout << 'M' << endl;\n\tif(a!=m && a!=l) cout << 'I' << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <map>\n#include <queue>\n#include <set>\n#include <algorithm>\n#include <stack>\n\nusing namespace std;\n\nvoid solve()\n{\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tstring s;\n\tint BobsAns;\n\tcin >> s >> BobsAns;\n\tint ansL = s[0] - '0';\n\tfor (int i = 2; i < s.size(); i += 2)\n\t{\n\t\tif (s[i - 1] == '+')\n\t\t{\n\t\t\tansL += s[i] - '0';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tansL *= s[i] - '0';\n\t\t}\n\t}\n\tint ansM = 0;\n\tstack<int> num;\n\tfor (int i = 0; i < s.size(); ++i)\n\t{\n\t\tif ('0' <= s[i] && s[i] <= '9')\n\t\t{\n\t\t\tnum.push(s[i] - '0');\n\t\t}\n\t\telse if (s[i] == '*')\n\t\t{\n\t\t\tint a = num.top();\n\t\t\tnum.pop();\n\t\t\ta *= s[i + 1] - '0';\n\t\t\tnum.push(a);\n\t\t\t++i;\n\t\t}\n\t}\n\twhile (!num.empty())\n\t{\n\t\tansM += num.top();\n\t\tnum.pop();\n\t}\n\tif (ansL == BobsAns && ansM == BobsAns)\n\t{\n\t\tcout << \"U\" << endl;\n\t}\n\telse if (ansM == BobsAns)\n\t{\n\t\tcout << \"M\" << endl;\n\t}\n\telse if (ansL == BobsAns)\n\t{\n\t\tcout << \"L\" << endl;\n\t}\n\telse\n\t{\n\t\tcout << \"I\" << endl;\n\t}\n}\n\nint main()\n{\n\tsolve();\n\treturn(0);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n// region template\n#define rep(i, a, b) for (int i = (a); i < (b); ++i)\n#define trav(a, x) for (auto &a : x)\n#define all(x) begin(x), end(x)\n#define sz(x) (int)(x).size()\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef vector<int> vi;\n\nll gcd(ll a, ll b) { return __gcd(a, b); }\n\nll euclid(ll a, ll b, ll &x, ll &y) {\n    if (b) { ll d = euclid(b, a % b, y, x);\n        return y -= a/b * x, d; }\n    return x = 1, y = 0, a;\n}\n\ntypedef unsigned long long ull;\ntypedef long double ld;\null mod_mul(ull a, ull b, ull M) {\n    ll ret = a * b - M * ull(ld(a) * ld(b) / ld(M));\n    return ret + M * (ret < 0) - M * (ret >= (ll)M);\n}\null mod_pow(ull b, ull e, ull mod) {\n    ull ans = 1;\n    for (; e; b = mod_mul(b, b, mod), e /= 2)\n        if (e & 1) ans = mod_mul(ans, b, mod);\n    return ans;\n}\n\nconst ll mod = 1000000007;\nstruct Mod {\n    ll x;\n    Mod(ll xx) : x(xx) {}\n    Mod operator+(Mod b) { return Mod((x + b.x) % mod); }\n    Mod operator-(Mod b) { return Mod((x - b.x) % mod); }\n    Mod operator*(Mod b) { return Mod((x * b.x) % mod); }\n    Mod operator/(Mod b) { return *this * invert(b); }\n    Mod invert(Mod a) {\n        ll x, y, g = euclid(a.x, mod, x, y);\n        assert(g == 1); return Mod((x + mod) % mod);\n    }\n    Mod operator^(ll e) {\n        if (!e) return Mod(1);\n        Mod r = *this ^ (e / 2); r = r * r;\n        return e & 1 ? *this * r : r;\n    }\n};\n// endregion\n\nint lreval(string s) {\n    int val = s[0] - '0';\n    for (int i = 1; i < s.length(); i += 2) {\n        if (s[i] == '+') {\n            val = val + (s[i + 1] - '0');\n        } else {\n            val = val * (s[i + 1] - '0');\n        }\n    }\n    return val;\n}\n\nint creval(string s) {\n    int ttl = 0, cur = s[0] - '0';\n    for (int i = 1; i < s.length(); i += 2) {\n        if (s[i] == '*') {\n            cur *= (s[i + 1] - '0');\n        } else {\n            ttl += cur;\n            cur = s[i + 1] - '0';\n        }\n    }\n    ttl += cur;\n    return ttl;\n}\n\nint main() {\n    char mask[] = {'I', 'L', 'M', 'U'};\n    string s; cin >> s;\n    int m = 0, v; cin >> v;\n    // cout << lreval(s) << \" \" << creval(s) << endl;\n    if (lreval(s) == v) m |= 1;\n    if (creval(s) == v) m |= 2;\n    cout << mask[m] << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nint mylog10(int x){\n\tif(x==0) return 0;\n\telse return (int)log10(x);\n}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\n\nstring strerase(string instr,int num){\n\tstring rst = \"\";\n\tfor(int i=num;i<instr.size();i++){\n\t\trst += instr[i];\n\t}\n\treturn rst;\n}\nll int calc1(string str){//multiplication-first\n\tstack<ll int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push((ll int)stoi(rststr));\n\tif(rststr!=\"\") str = strerase(str,mylog10((double)stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr = strerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\tstr = strerase(str,(int)mylog10((double)tmp)+1);\n\t\t\tll int tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr = strerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr = strerase(str,(int)mylog10((double)tmp)+1);\n\t\t}\n\t}\n\tll int rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nll int calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tll int rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str = strerase(str,(int)mylog10((double)rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr = strerase(str,1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr = strerase(str,1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nll int calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str = strerase(str,(int)mylog10((double)stoi(rststr))+1);\n\tll int rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr = strerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr = strerase(str,(int)mylog10((double)tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr = strerase(str,1);\n\t\t\tll int tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr = strerase(str,(int)mylog10((double)tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\tcin >> str;\n\tll int ans;\n\tcin >> ans;\n\tll int rst1 = calc1(str);//calc2　is bug\n\tll int rst2 = calc3(str);\n\t//cout << rst1 << \" \" << rst2 << endl;\n\tif(rst1==ans){\n\t\tif(rst2==ans) cout << 'U' << endl;\n\t\telse cout << 'M' << endl;\n\t}else{\n\t\tif(rst2==ans) cout << 'L' << endl;\n\t\telse cout << 'I' << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <iostream>\n#include <vector>\n#include <numeric>\n#include <algorithm>\nusing namespace std;\nusing ll = long long int;\n\nll solve1(string s, int l, int r) {\n    s += '+'; r++;\n    vector<ll> vs;\n\n    ll val = 1;\n    for(int i=l; i<r; i++) {\n        if(s[i] == '*') continue;\n        if(s[i] == '+') vs.emplace_back(val), val = 1;\n        if(isdigit(s[i])) val *= (s[i] - '0');\n    }\n\n    return accumulate(vs.begin(), vs.end(), 0LL);\n}\n\nll solve2(string s, int l, int r) {\n    ll res = s[0] - '0';\n\n    char op = '?';\n    for(int i=1; i<r; i++) {\n        if(isdigit(s[i])) {\n            if(op == '*') res = res * (s[i] - '0');\n            if(op == '+') res = res + (s[i] - '0');\n        }\n        else op = s[i];\n    }\n    return res;\n}\n\nint main() {\n    string s; cin >> s;\n    int N = s.size();\n    ll res; cin >> res;\n\n    ll v1 = solve1(s, 0, N);\n    ll v2 = solve2(s, 0, N);\n    \n    if(v1 == res and v2 != res) cout << \"M\" << endl;\n    else if(v2 == res and v1 != res) cout << \"L\" << endl;\n    else if(v1 == res and v2 == res) cout << \"U\" << endl;\n    else cout << \"I\" << endl;\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "/**********************************************************\n * ×÷??£?zxf\n * ????£?2017/8/10\n * ±???£?Miscalculation\n * ????£?Gym 100803B\n * ×??????¨£?\n * ????£?\n * Time used£?\n * Memory used£?\n **********************************************************/\n#include <algorithm>\n#include <bitset>\n#include <cassert>\n#include <cctype>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <fstream>\n#include <functional>\n#include <iomanip>\n#include <iostream>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\n#define LL long long\n#define pb push_back\n#define pob pop_back\n#define mp make_pair\n#define FILL(a,v) memset((void*)a,v,sizeof(a))\n#define FILL0(a) FILL(a,0)\n#define FILL1(a) FILL(a,-1)\n#define ALL(a) (a).begin(),(a).end()\n#define Inf 1e9\n#define Mod 1000000007\n#define foreach(it,x) for(typeof(x.begin()) it=x.begin();it!=x.end();it++)\n#define FOR(i,x) for(int i=0;i<x;i++)\n#define RFOR(i,x) for(int i=x-1;i>=0;i--)\n#define FFOR(i,a,b) for(int i=a;i<b;i++)\n#define FRFOR(i,a,b) for(int i=a-1;i>=b;i--)\n#define SZ(a) ((int)(a).size())\n#define FI first\n#define SE second\n#define OVER(a) return puts(a),0\n#define fastio ios::sync_with_stdio(0)\n#define filei(f) freopen(f,\"r\",stdin)\n#define fileo(f) freopen(f,\"w\",stdout)\nusing namespace std;\ntypedef pair<int,int> pii;\ntypedef unsigned long long UINT;\ntypedef unsigned int Uint;\ntypedef long long INT;\ntypedef pair<INT,INT> PII;\ntypedef stringstream sst;\ntypedef istringstream iss;\ntypedef vector<int> vint;\ntypedef vector<INT> VINT;\ntypedef vector<pii> vpii;\ntypedef vector<PII> VPII;\ntypedef priority_queue<int> pqi;\ntypedef priority_queue<INT> PQI;\ntypedef priority_queue<pii> pqp;\ntypedef priority_queue<PII> PQP;\ntypedef priority_queue<int,vint,greater<int> > xqi;\ntypedef priority_queue<INT,VINT,greater<INT> > XQI;\ntypedef priority_queue<pii,vpii,greater<pii> > xqp;\ntypedef priority_queue<PII,VPII,greater<PII> > XQP;\n\nvector<pair<INT,INT> > cal,cal2;\nstring sns;\nINT ans1,ans2,ans;\n\nint main()\n{\n\tcin>>sns;\n\tINT a=0,b=0;\n\tfor(int i=0;i<SZ(sns);i++)\n\t\tif(isdigit(sns[i]))\n\t\t\ta=a*10+sns[i]-'0';\n\t\telse\n\t\t{\n\t\t\tif(sns[i]=='+') b=1;\n\t\t\telse b=2;\n\t\t\tcal.push_back(mp(a,b));\n\t\t\ta=0;\n\t\t}\n\tcal.push_back(mp(a,1));\n\ta=1;\n\tint chenging=0;\n\tfor(int i=0;i<SZ(cal);i++)\n\t{\n\t\tif(chenging)a*=cal[i].first;\n\t\tif(chenging&&cal[i].second==1)\n\t\t{\n\t\t\tcal2.push_back(mp(a,1));\n\t\t\tchenging=0;\n\t\t}\n\t\telse if(!chenging&&cal[i].second==2)\n\t\t\tchenging=1,a=cal[i].first;\n\t\telse if(!chenging)cal2.push_back(mp(cal[i].first,1));\n\t}\n\tans1=0;\n\tfor(int i=0;i<SZ(cal2);i++)\n\t{\n\t\tans1+=cal2[i].first;\n\t}\n\tans2=cal[0].first;\n\tfor(int i=0;i<SZ(cal)-1;i++)\n\t{\n\t\tif(cal[i].second==1)ans2+=cal[i+1].first;\n\t\telse ans2*=cal[i+1].first;\n\t}\n\tcin>>ans;\n\tif(ans==ans1&&ans==ans2)OVER(\"U\");\n\tif(ans==ans1)OVER(\"M\");\n\tif(ans==ans2)OVER(\"L\");\n\tOVER(\"I\");\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nint calc(string s, int type){\n\tint cutA=-1, cutM=-1;\n\tfor(int i=0; i<(int)s.length(); i++){\n\t\tif(s[i]=='+') cutA = i; \n\t\tif(s[i]=='*') cutM = i;\n\t}\n\tif(cutA==-1 && cutM==-1){\n\t\treturn stoi(s);\n\t}else if(cutA==-1 || (type==0 && cutM>cutA)){\n\t\treturn calc(s.substr(0,cutM), type) * calc(s.substr(cutM+1, s.length()-cutM), type);\n\t}else{\n\t\treturn calc(s.substr(0,cutA), type) + calc(s.substr(cutA+1, s.length()-cutA), type);\n\t}\n}\n\nint main(){\n\tstring str;\n\tint ans;\n\tcin >> str >> ans;\n\n\tif(ans == calc(str,0)){\n\t\tif(ans == calc(str, 1)){\n\t\t\tcout << \"U\" << endl;\n\t\t}else{\n\t\t\tcout << \"L\" << endl;\n\t\t}\n\t}else{\n\t\tif(ans == calc(str, 1)){\n\t\t\tcout << \"M\" << endl;\n\t\t}else{\n\t\t\tcout << \"I\" << endl;\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint main(){\n  int a[100],t;\n  string s;\n  cin>>s>>t;\n  char b[100];\n  a[0]=s[0]-'0';\n  r(i,s.size()/2)a[i+1]=s[(i+1)*2]-'0';\n  r(i,s.size()/2)b[i]=s[i*2+1];\n  int p1=a[0],p2=0;\n  r(i,s.size()/2)\n    if(b[i]=='*')p1*=a[i+1];\n    else p1+=a[i+1];\n  r(i,s.size()/2)if(b[i]=='*')a[i+1]=a[i]*a[i+1],a[i]=0;\n  r(i,s.size()/2+1)p2+=a[i];\n  if(t==p1&&t==p2)cout<<'U'<<endl;\n  else if(t!=p1&&t!=p2)cout<<'I'<<endl;\n  else if(t!=p1&&t==p2)cout<<'M'<<endl;\n  else cout<<'L'<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#define __USE_MINGW_ANSI_STDIO 0\n#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<ll> VL;\ntypedef vector<VL> VVL;\ntypedef pair<int, int> PII;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define MP make_pair\n#define PB push_back\n#define MOD 1000000007\n#define INF (1LL<<30)\n#define LLINF (1LL<<60)\n#define PI 3.14159265359\n#define EPS 1e-12\n//#define int ll\n\nVI a, b;\nbool d[100010];\nsigned main(void)\n{\n\tstring s, t = \"\";\n\tint m;\n\tcin >> s >> m;\n\tREP(i, s.size()) {\n\t\tif(s[i] == '+') {\n\t\t\ta.PB(stoi(t));\n\t\t\tb.PB(1);\n\t\t\tt = \"\";\n\t\t} else if(s[i] == '*') {\n\t\t\ta.PB(stoi(t));\n\t\t\tb.PB(0);\n\t\t\tt = \"\";\n\t\t} else {\n\t\t\tt += s[i];\n\t\t}\n\t}\n\ta.PB(stoi(t));\n\t//for(int i: a) cout << i << \" \"; cout << endl;\n\t//for(int i: b) cout << i << \" \"; cout << endl;\n\n\tbool f1 = false, f2 = false;\n\tint c = a[0];\n\tREP(i, b.size()) {\n\t\tif(b[i]) {\n\t\t\tc += a[i+1];\n\t\t} else {\n\t\t\tc *= a[i+1];\n\t\t}\n\t}\n\t//cout << c << \" \";\n\tif(c == m) f1 = true;\n\n\tVI e;\n\tbool con = false;\n\tc = 0;\n\tREP(i, b.size()) {\n\t\tif(!b[i]) {\n\t\t\tif(!con) c = a[i]*a[i+1];\n\t\t\telse c *= a[i+1];\n\t\t\td[i] = d[i+1] = true;\n\t\t\tcon = true;\n\t\t} else {\n\t\t\te.PB(c);\n\t\t\tc = 0;\n\t\t\tcon = false;\n\t\t}\n\t}\n\tREP(i, a.size()) {\n\t\tif(!d[i]) e.PB(a[i]);\n\t}\n\tint ret = 0;\n\tfor(int i: e) ret += i;\n\t//cout << ret << endl;\n\t//for(int i: e) cout << i << \" \"; cout << endl;\n\tif(ret == m) f2 = true;\n\n\tif(f1 && f2) cout << \"U\" << endl;\n\telse if(!f1 && !f2) cout << \"I\" << endl;\n\telse if(f1 && !f2) cout << \"L\" << endl;\n\telse if(!f1 && f2) cout << \"M\" << endl;\n\telse assert(false);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back \nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nstring gettopnum(string str){\n\tstring rst = \"\";\n\tREP(i,str.size()){\n\t\tif(str[i]=='*'||str[i]=='+') break;\n\t\telse rst += str[i];\n\t}\n\treturn rst;\n}\nint calc1(string str){//multiplication-first\n\tstack<int> st;\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") st.push((int)stoi(rststr));\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t\tint tmp2 = st.top();\n\t\t\tst.pop();\n\t\t\tst.push(tmp*tmp2);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\tst.push(tmp);\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\tint rst = 0;\n\twhile(!st.empty()){\n\t\trst += st.top();\n\t\tst.pop();\n\t}\n\treturn rst;\n}\n\nint calc2(string str){////multiplication-first2\n\t//cout << str << endl;\n\tstring rststr = gettopnum(str);\n\tint rst;\n\tif(rststr!=\"\") rst = stoi(rststr);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)rst)+1);\n\tif(str.size()==0) return rst;\n\telse if(str[0]=='*') {\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst*calc2(str);\n\t}else if(str[0]=='+'){\n\t\tstr.erase(str.begin(),str.begin()+1);\n\t\treturn rst+calc2(str);\n\t}\n\t//dummy\n\treturn -1;\n}\n\nint calc3(string str){//leftto-right\n\tstring rststr = gettopnum(str);\n\tif(rststr!=\"\") str.erase(str.begin(),str.begin()+(int)log10((double)stoi(rststr))+1);\n\tint rst = stoi(rststr);\n\twhile(str.size()!=0){\n\t\t//cout << str << endl;\n\t\tif(str[0]=='*'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst *= tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}else if(str[0]=='+'){\n\t\t\tstr.erase(str.begin(),str.begin()+1);\n\t\t\tint tmp = stoi(gettopnum(str));\n\t\t\trst += tmp;\n\t\t\tstr.erase(str.begin(),str.begin()+(int)log10((double)tmp)+1);\n\t\t}\n\t}\n\treturn rst;\n}\n\nint main(){\n\tstring str;\n\twhile(cin >> str){\n\t\tcin >> str;\n\t\tint ans;\n\t\tcin >> ans;\n\t\tint rst1 = calc2(str);\n\t\tint rst2 = calc3(str);\n\t\t//cout << rst1 << \" \" << rst2 << endl;\n\t\tif(rst1==ans){\n\t\t\tif(rst2==ans) cout << 'U' << endl;\n\t\t\telse cout << 'M' << endl;\n\t\t}else{\n\t\t\tif(rst2==ans) cout << 'L' << endl;\n\t\t\telse cout << 'I' << endl;\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define FOR(i,a,b) for (int i=(a);i<(b);i++)\n#define RFOR(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define REP(i,n) for (int i=0;i<(n);i++)\n#define RREP(i,n) for (int i=(n)-1;i>=0;i--)\n#define ALL(a) (a).begin(),(a).end()\n#define DEBUG(a) \"(\" << #a << \": \" << (a) << \")\"\n\ntemplate<typename T>\nvoid chmin(T &x, T y) { x = min(x, y); }\n\ntemplate<typename T>\nvoid chmax(T &x, T y) { x = max(x, y); }\n\ntypedef long long int lli;\ntypedef long double ld;\ntypedef tuple<int,int> P;\n\nconst int INF = INT_MAX/2 - 1;\nconst double EPS = 1e-14;\nconst bool OREWA_MOU_DAMEDA = true;\nconst int dx[4] = {0, 1, 0, -1}; // {-1,  0,  1, -1, 1, -1, 0, 1};\nconst int dy[4] = {1, 0, -1, 0}; // {-1, -1, -1,  0, 0,  1, 1, 1};\n\nstring str; unsigned int p;\n\nlli Digit() {\n  if (isdigit(str[p])) { return str[p++] - '0'; }\n  throw OREWA_MOU_DAMEDA;\n}\n\nlli Factor() {\n  lli lhs = Digit();\n  if (p < str.size() && str[p] == '*') {\n    p++; // read *\n    lli rhs = Factor();\n    return lhs * rhs;\n  }\n  return lhs;\n}\n\nlli Expr() {\n  lli lhs = Factor();\n  if (p < str.size() && str[p] == '+') {\n    p++; // read +\n    lli rhs = Expr();\n    return lhs + rhs;\n  }\n  return lhs;\n}\n\nlli calc_left2right(const string &expr) {\n  lli ans = expr[0] - '0';\n  REP(i, (expr.size() - 1) / 2) {\n    if (expr[2 * i + 1] == '+') {\n      ans += expr[2 * i + 2] - '0';\n    }\n    else if (expr[2 * i + 1] == '*') {\n      ans *= expr[2 * i + 2] - '0';\n    }\n    else {\n      throw OREWA_MOU_DAMEDA;\n    }\n  }\n  return ans;\n}\n\nchar solve(string expr, lli ans) {\n  str = expr, p = 0;\n  lli m = Expr();\n  lli l = calc_left2right(expr);\n  if (ans == m && ans == l) { return 'U'; }\n  if (ans == m) { return 'M'; }\n  if (ans == l) { return 'L'; }\n  return 'I';\n}\n\nint main() {\n  cout << fixed << setprecision(10);\n  string str;\n  lli ans;\n  cin >> str >> ans;\n  cout << solve(str, ans) << endl;\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\nint M(char s[]){\n\tint i,n,m,a[20];\n\tfor(i=0,n=0;s[i];i+=2)\n\t\ta[n++]=s[i]-'0';\n\tfor(i=1;s[i];i+=2){\n\t\tif(s[i]=='*'){\n\t\t\ta[i/2+1]*=a[i/2];\n\t\t\ta[i/2]=0;\n\t\t}\n\t}\n\tfor(i=0,m=0;i<n;i++)\n\t\tm+=a[i];\n\treturn m;\n}\nint L(char s[]){\n\tint i,l;\n\tfor(i=1,l=s[0]-'0';s[i];i+=2){\n\t\tif(s[i]=='+')\n\t\t\tl+=s[i+1]-'0';\n\t\telse if(s[i]=='*')\n\t\t\tl*=s[i+1]-'0';\n\t}\n\treturn l;\n}\nint main(void){\n\tint i,m,l,b;\n\tchar s[20];\n\tscanf(\"%s\",s);\n\tscanf(\"%d\",&b);\n\tm=M(s);\n\tl=L(s);\n\tif(b==m&&b==l)\n\t\tputs(\"U\");\n\telse if(b==m)\n\t\tputs(\"M\");\n\telse if(b==l)\n\t\tputs(\"L\");\n\telse\n\t\tputs(\"I\");\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <queue>\n#include <vector>\n#include <cmath>\n#include <algorithm>\n#include <set>\n#include <map>\n#define mem(a) memset(a,0,sizeof(a))\n\nusing namespace std;\n\nchar str[30];\nint ans;\nint M,L;\n\nint main()\n{\n\t//freopen(\"in.txt\",\"r\",stdin);\n\twhile(~scanf(\"%s\",str))\n\t{\n\t    M = 0;L = 0;\n\t    scanf(\"%d\",&ans);\n\t    char strr[30] = \"\";\n\t    strcat(strr,str);\n\t    int len = strlen(str);\n\t    if(len == 1)\n\t    {\n\t        L = M  = str[0]-48;\n\t        if(ans == M&&ans != L)cout<<\"M\"<<endl;\n\t    else if(ans == L && ans != M)cout<<\"L\"<<endl;\n\t    else if(ans == L && ans == M)cout<<\"U\"<<endl;\n\t    else cout<<\"I\"<<endl;\n\t        continue;\n\t    }\n\t    for(int i = 0;i < len;i ++)\n\t    {\n\t        if(str[i] == '+')\n\t        {\n\t            int a = str[i-1]-48;\n\t            int b = str[i+1]-48;\n\t            str[i+1] = (a + b) + 48;\n\t        }\n\t        else if(str[i] == '*')\n\t        {\n\t            int a = str[i-1]-48;\n\t            int b = str[i+1]-48;\n\t            str[i+1] = (a * b);\n\t        }\n\t        if(i == len - 1)L = str[i];\n\t    }\n\t    for(int i = 0;i < len;i ++)\n\t    {\n\t        if(strr[i] == '*')\n\t        {\n\t            M+=(strr[i-1]-'0')*(strr[i+1]-'0');\n\t            strr[i] = strr[i-1] = strr[i + 1] = '@';\n\t        }\n\t    }\n\t    for(int i = 0 ;i < len;i ++)\n\t    {\n\t        if(strr[i] == '+')\n\t        {\n\t            if(strr[i-1] >= '0'&&strr[i-1]<='9')M+=(strr[i-1]-48);\n\t            if(strr[i+1] >= '0'&&strr[i+1]<='9')M+=(strr[i+1]-48);\n\t        }\n\t        //if(i == len -1)M = str[i];\n\t    }\n\t    //cout<<L<<\"  \"<<M<<endl;\n\t    if(ans == M&&ans != L)cout<<\"M\"<<endl;\n\t    else if(ans == L && ans != M)cout<<\"L\"<<endl;\n\t    else if(ans == L && ans == M)cout<<\"U\"<<endl;\n\t    else cout<<\"I\"<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\nint M(char s[]){\n    int i,n,m,a[20];\n    for(i=0,n=0;s[i];i+=2)\n        a[n++]=s[i]-'0';\n    for(i=1;s[i];i+=2){\n        if(s[i]=='*'){\n            a[i/2+1]*=a[i/2];\n            a[i/2]=0;\n        }\n    }\n    for(i=0,m=0;i<n;i++)\n        m+=a[i];\n    return m;\n}\nint L(char s[]){\n    int i,l;\n    for(i=1,l=s[0]-'0';s[i];i+=2){\n        if(s[i]=='+')\n            l+=s[i+1]-'0';\n        else if(s[i]=='*')\n            l*=s[i+1]-'0';\n    }\n    return l;\n}\nint main(void){\n    int i,m,l,b;\n    char s[20];\n    scanf(\"%s\",s);\n    scanf(\"%d\",&b);\n    m=M(s);\n    l=L(s);\n    if(b==m&&b==l)\n        puts(\"U\");\n    else if(b==m)\n        puts(\"M\");\n    else if(b==l)\n        puts(\"L\");\n    else\n        puts(\"I\");\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "// Aizu 1346: Miscalculation\n// 2017.9.19 bal4u@uu\n\n#include <stdio.h>\n\nchar buf[102], *p;\n\nlong long term()\n{\n\tlong long x = *p++ - '0';\n\twhile (1) {\n\t\tif (*p == '*') p++;\telse break;\n\t\tx *= *p++ - '0';\n\t}\n\treturn x;\n}\n\nlong long multiFirst()\n{\n\tlong long x = term();\n\twhile (1) {\n\t\tif (*p == '+') p++; else break;\n\t\tx += term();\n\t}\n\treturn x;\n}\n\nlong long left2right()\n{\n\tlong long x;\n\tint y, op;\n\t\n\tx = *p++ - '0';\n\twhile (*p) {\n\t\top = *p++, y = *p++ - '0';\n\t\tif (op == '*') x *= y;\n\t\telse           x += y;\n\t}\n\treturn x;\n}\n\nint main()\n{\n\tint k;\n\tlong long a;\n\tchar *ans[4] = { \"I\", \"M\", \"L\", \"U\" };\n\n\tscanf(\"%s%lld\", buf, &a); k = 0;\n\tp = buf; if (multiFirst() == a) k |= 1;\n\tp = buf; if (left2right() == a) k |= 2;\n\tputs(ans[k]);\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#define OPERATOR_PLUS -1\n#define OPERATOR_ASTERISK -2\n\n/* 演算子の優先度を指定して計算式を計算する */\nint calculate(const int* expression, int length, int plusPriority, int asteriskPriority) {\n\tint e[17];\n\tint i, j, p;\n\tfor (i = 0; i < length; i++) e[i] = expression[i];\n\n\t/* 計算 */\n\tfor (p = 0; p < 2; p++) {\n\t\tfor (i = 0; i < length - 2; i++) {\n\t\t\tint flag = 0; /* 演算が行われたか */\n\t\t\tif (p == plusPriority && e[i+1] == OPERATOR_PLUS) {\n\t\t\t\te[i] += e[i+2];\n\t\t\t\tflag = 1;\n\t\t\t} else if (p == asteriskPriority && e[i+1] == OPERATOR_ASTERISK) {\n\t\t\t\te[i] *= e[i+2];\n\t\t\t\tflag = 1;\n\t\t\t}\n\t\t\t/* 処理を終えた計算式を消去して詰める */\n\t\t\tif (flag) {\n\t\t\t\tfor (j = i + 1; j < length - 2; j++) {\n\t\t\t\t\te[j] = e[j+2];\n\t\t\t\t}\n\t\t\t\tlength -= 2;\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn e[0];\n}\n\nint main(void) {\n\tint expression[17];\n\tint length = 0;\n\tint answer;\n\tint m, l;\n\tchar c;\n\n\t/* 計算式を読み込む */\n\twhile (scanf(\"%1[0-9+*]\", &c) == 1) {\n\t\tif (c == '+') expression[length++] = OPERATOR_PLUS;\n\t\telse if (c == '*') expression[length++] = OPERATOR_ASTERISK;\n\t\telse if (c >= '0' && c <= '9') expression[length++] = c - '0';\n\t}\n\t/* 計算結果を読み込む */\n\tscanf(\"%d\", &answer);\n\n\t/* 各演算規則で実際に計算する */\n\tm = calculate(expression, length, 1, 0);\n\tl = calculate(expression, length, 0, 0);\n\n\t/* 出力 */\n\tif (answer == m && answer == l) c = 'U';\n\telse if (answer == m) c = 'M';\n\telse if (answer == l) c = 'L';\n\telse c = 'I';\n\tprintf(\"%c\\n\", c);\n\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nint evaluate(const char* expr, int mode) {\n\tint rp_data[100];\n\tint data_num = 0;\n\tint stack[100];\n\tint stack_num = 0;\n\tint i;\n\t/* siki wo gyaku poorando kihou ni hennkann suru */\n\tfor (i = 0; expr[i] != '\\0'; i++) {\n\t\tif (expr[i] == '+' || expr[i] == '*') {\n\t\t\twhile (stack_num > 0 && (mode || expr[i] == '+' || stack[stack_num - 1] == '*')) {\n\t\t\t\trp_data[data_num++] = stack[--stack_num];\n\t\t\t}\n\t\t\tstack[stack_num++] = expr[i];\n\t\t} else {\n\t\t\trp_data[data_num++] = expr[i];\n\t\t}\n\t}\n\twhile (stack_num > 0) {\n\t\trp_data[data_num++] = stack[--stack_num];\n\t}\n\t/* evaluate the converted data */\n\tstack_num = 0;\n\tfor (i = 0; i < data_num; i++) {\n\t\tif (rp_data[i] == '+') {\n\t\t\tstack[stack_num - 2] += stack[stack_num - 1];\n\t\t\tstack_num--;\n\t\t} else if (rp_data[i] == '*') {\n\t\t\tstack[stack_num - 2] *= stack[stack_num - 1];\n\t\t\tstack_num--;\n\t\t} else {\n\t\t\tstack[stack_num++] = rp_data[i] - '0';\n\t\t}\n\t}\n\treturn stack[0];\n}\n\nint main(void) {\n\tchar expr[32];\n\tint value;\n\tif (scanf(\"%s\", expr) != 1) return 1;\n\tif (scanf(\"%d\", &value) != 1) return 1;\n\tprintf(\"%c\\n\", \"IMLU\"[(evaluate(expr, 0) == value) + (evaluate(expr, 1) == value) * 2]);\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\nint M(char s[]){\n\tint i,n,m,a[20];\n\tfor(i=0,n=0;s[i];i+=2)\n\t\ta[n++]=s[i]-'0';\n\tfor(i=1;s[i];i+=2){\n\t\tif(s[i]=='*'){\n\t\t\ta[i/2]*=a[i/2+1];\n\t\t\ta[i/2+1]=0;\n\t\t}\n\t}\n\tfor(i=0,m=0;i<n;i++)\n\t\tm+=a[i];\n\treturn m;\n}\nint L(char s[]){\n\tint i,l;\n\tfor(i=1,l=s[0]-'0';s[i];i+=2){\n\t\tif(s[i]=='+')\n\t\t\tl+=s[i+1]-'0';\n\t\telse if(s[i]=='*')\n\t\t\tl*=s[i+1]-'0';\n\t}\n\treturn l;\n}\nint main(void){\n\tint i,m,l,b;\n\tchar s[20];\n\tscanf(\"%s\",s);\n\tscanf(\"%d\",&b);\n\tm=M(s);\n\tl=L(s);\n\tif(b==m&&b==l)\n\t\tputs(\"U\");\n\telse if(b==m)\n\t\tputs(\"M\");\n\telse if(b==l)\n\t\tputs(\"L\");\n\telse\n\t\tputs(\"I\");\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\n#include<ctype.h>\nint main(void){\n    char s[20];\n    fgets(s,20,stdin);\n    int len=strlen(s)-1;\n    int n;\n    scanf(\"%d\",&n);\n    //rule1\n    int sum=s[0]-'0';\n    for(int i=1;i<len-1;i+=2){\n        if(s[i]=='+')\n            sum+=s[i+1]-'0';\n        else\n            sum*=s[i+1]-'0';\n    }\n    //printf(\"%d\\n\",sum);\n    //rule2\n    int num[20]={0};\n    int index=0;\n    num[0]=s[0]-'0';\n    for(int i=1;i<len-1;i+=2){\n        if(s[i]=='+')\n            num[++index]=s[i+1]-'0';\n        else\n            num[index]*=s[i+1]-'0';\n    }\n    int wa=0;\n    for(int i=0;i<=index;i++){\n        wa+=num[i];\n        //printf(\"%d \",num[i]);\n    }//puts(\"\");\n    //printf(\"%d\\n\",wa);\n    if(sum!=n&&wa==n) printf(\"M\\n\");\n    if(sum==n&&wa!=n) printf(\"L\\n\");\n    if(sum==n&&wa==n) printf(\"U\\n\");\n    if(sum!=n&&wa!=n) printf(\"I\\n\");\n}\n\n"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\nint main(void){\n\tchar ope[20]={0},x;\n\tint num[20]={0},ltr=0,i=0,j=0,mode=0,bob,cnt=0,ans=0;\n\twhile(1){\n\t\tscanf(\"%c\",&x);\n\t\tif(x=='\\n'){\n\t\t\tbreak;\n\t\t}\n\t\tcnt++;\n\t\tif(mode==0&&x!='*'&&x!='+'){\n\t\t\tltr+=x-48;\n\t\t}\n\t\telse if(x!='*'&&x!='+'){\n\t\t\tltr=ltr*(x-48);\n\t\t}\n\t\tif(x=='*'||x=='+'){\n\t\t\tope[i]=x;\n\t\t\tif(x=='*'){\n\t\t\t\tmode=1;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tmode=0;\n\t\t\t}\n\t\t\ti++;\n\t\t}\n\t\telse{\n\t\t\tnum[j]=x-48;\n\t\t\tj++;\n\t\t}\n\t}\n\ti=0;\n\twhile(i<j){\n\t\tif(ope[i]=='*'){\n\t\t\tnum[i+1]=num[i+1]*num[i];\n\t\t\tnum[i]=0;\n\t\t}\n\t\ti++;\n\t}\n\tfor(i=0;i<=cnt;i++){\n\t\tans+=num[i];\n\t}\n\tscanf(\"%d\",&bob);\n\tif(bob==ans&&bob==ltr){\n\t\tprintf(\"U\\n\");\n\t}\n\telse if(bob==ans){\n\t\tprintf(\"M\\n\");\n\t}\n\telse if(bob==ltr){\n\t\tprintf(\"L\\n\");\n\t}\n\telse{\n\t\tprintf(\"I\\n\");\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\nlong long M(char s[]){\n\tint i,n;\n\tlong long m,a[20];\n\tfor(i=0,n=0;s[i];i+=2)\n\t\ta[n++]=s[i]-'0';\n\tfor(i=1;s[i];i+=2){\n\t\tif(s[i]=='*'){\n\t\t\ta[i/2+1]*=a[i/2];\n\t\t\ta[i/2]=0;\n\t\t}\n\t}\n\tfor(i=0,m=0;i<n;i++)\n\t\tm+=a[i];\n\treturn m;\n}\nlong long L(char s[]){\n\tint i;\n\tlong long l;\n\tfor(i=1,l=s[0]-'0';s[i];i+=2){\n\t\tif(s[i]=='+')\n\t\t\tl+=s[i+1]-'0';\n\t\telse if(s[i]=='*')\n\t\t\tl*=s[i+1]-'0';\n\t}\n\treturn l;\n}\nint main(void){\n\tint i;\n\tlong long m,l,b;\n\tchar s[20];\n\tscanf(\"%s\",s);\n\tscanf(\"%lld\",&b);\n\tm=M(s);\n\tl=L(s);\n\tif(b==m&&b==l)\n\t\tputs(\"U\");\n\telse if(b==m)\n\t\tputs(\"M\");\n\telse if(b==l)\n\t\tputs(\"L\");\n\telse\n\t\tputs(\"I\");\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "\n"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\nint M(char s[]){\n\tint i,n,m,a[20];\n\tfor(i=0,n=0;s[i];i+=2)\n\t\ta[n++]=s[i]-'0';\n\tfor(i=1;s[i];i+=2){\n\t\tif(s[i]=='*'){\n\t\t\ta[i/2+1]*=a[i/2];\n\t\t\ta[i/2]=0;\n\t\t}\n\t}\n\tfor(i=0,m=0;i<n;i++)\n\t\tm+=a[i];\n\treturn m;\n}\nint L(char s[]){\n\tint i,l;\n\tfor(i=1,l=s[0]-'0';s[i];i+=2){\n\t\tif(s[i]=='+')\n\t\t\tl+=s[i+1]-'0';\n\t\telse if(s[i]=='*')\n\t\t\tl*=s[i+1]-'0';\n\t}\n\treturn l;\n}\nint main(void){\n\tint i,m,l,b;\n\tchar s[20];\n\tscanf(\"%s\",s);\n\tscanf(\"%d\",&b);\n\tm=M(s);\n\tl=L(s);\n\tif(b==m&&b==l)\n\t\tputs(\"U\");\n\telse if(b==m)\n\t\tputs(\"M\");\n\telse if(b==l)\n\t\tputs(\"L\");\n\telse\n\t\tputs(\"I\");\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\nint M(char s[]){\n\tint i,n,m,a[20];\n\tfor(i=0,n=0;s[i];i+=2)\n\t\ta[n++]=s[i]-'0';\n\tfor(i=1;s[i];i+=2){\n\t\tif(s[i]=='*'){\n\t\t\ta[i/2+1]*=a[i/2];\n\t\t\ta[i/2]=0;\n\t\t}\n\t}\n\tfor(i=0,m=0;i<n;i++)\n\t\tm+=a[i];\n\treturn m;\n}\nint L(char s[]){\n\tint i,l;\n\tfor(i=1,l=s[0]-'0';s[i];i+=2){\n\t\tif(s[i]=='+')\n\t\t\tl+=s[i+1]-'0';\n\t\telse if(s[i]=='*')\n\t\t\tl*=s[i+1]-'0';\n\t}\n\treturn l;\n}\nint main(void){\n\tint i,m,l,b;\n\tchar s[20];\n\tscanf(\"%s\",s);\n\tscanf(\"%d\",&b);\n\tm=M(s);\n\tl=L(s);\n\tif(b==m&&b==l)\n\t\tputs(\"U\");\n\telse if(b==m)\n\t\tputs(\"M\");\n\telse if(b==l)\n\t\tputs(\"L\");\n\telse\n\t\tputs(\"I\");\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\nchar S[300];\nint A,a,b,T[300],W[300];\n\nint ltr(char *S)\n{\n\tint r=S[0]-'0',i,t;\n\tfor(i=2;S[i];i+=2)\n\t{\n\t\tt=S[i]-'0';\n\t\tif(S[i-1]=='+')r+=t;\n\t\telse r*=t;\n\t}\n\treturn r;\n}\n\nint cal()\n{\n\tint i,j,t;\n\tfor(i=0;i<strlen(S);i++)\n\t\tT[i]=S[i]=='*'?-2:S[i]=='+'?-1:S[i]-'0';\n\tT[i]=-3;\n\tfor(;;)\n\t{\n\t\tfor(i=1,j=0;T[i]!=-3;i+=2)\n\t\t{\n\t\t\tif(T[i]==-2)\n\t\t\t{\n\t\t\t\tW[j++]=T[i-1]*T[i+1];\n\t\t\t\tfor(i=i+2;T[i-1]!=-3;i++)W[j++]=T[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse \n\t\t\t{\n\t\t\t\tW[j++]=T[i-1];\n\t\t\t\tW[j++]=T[i];\n\t\t\t}\n\t\t}\n\t\tif(T[i]==-3)break;\n\t\tmemcpy(T,W,sizeof(T));\n\t}\n\tt=0;\n\tfor(i=0;T[i-1]!=-3;i+=2)t+=T[i];\n\treturn t;\n}\n\nint main()\n{\n\tgets(S);\n\tscanf(\"%d\",&A);\n\ta=ltr(S);\n\tb=cal();\n\tif(a==b&&A==a)puts(\"U\");\n\telse if(a==A)puts(\"L\");\n\telse if(b==A)puts(\"M\");\n\telse puts(\"I\");\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nint eval1(char *exp)  // multiplication-first rule\n{\n\tint result;\n\tint factor;\n\tint p;\n\t\n\tp = 0;\n\t\n\tresult = 0;\n\tfactor = exp[p++] - '0';\n\t\n\twhile (exp[p] != '\\0'){\n\t\tif (exp[p] == '+'){\n\t\t\tp++;\n\t\t\tresult += factor;\n\t\t\tfactor = exp[p++] - '0';\n\t\t}\n\t\telse if (exp[p] == '*'){\n\t\t\tp++;\n\t\t\tfactor *= exp[p++] - '0';\n\t\t}\n\t}\n\tresult += factor;\n\t\n\treturn (result);\n}\n\nint eval2(char *exp)  //  left-to-right rule\n{\n\tint result;\n\tint p;\n\t\n\tp = 0;\n\t\n\tresult = exp[p++] - '0';\n\n\twhile (exp[p] != '\\0'){\n\t\tif (exp[p] == '+'){\n\t\t\tp++;\n\t\t\tresult += exp[p++] - '0';\n\t\t}\n\t\telse if (exp[p] == '*'){\n\t\t\tp++;\n\t\t\tresult *= exp[p++] - '0';\n\t\t}\n\t}\n\n\treturn (result);\n}\n\nint main(void)\n{\n\tchar exp[20];\n\tint res1, res2;\n\tint bob;\n\t\n\tscanf(\"%s\", exp);\n\tscanf(\"%d\", &bob);\n\t\n\tres1 = eval1(exp);\n\tres2 = eval2(exp);\n\n// printf(\"<%d %d>\\n\", res1, res2);\n\t\n\t\n\tif (res1 == bob && res2 == bob){\n\t\tprintf(\"U\\n\");\n\t}\n\telse if (res1 == bob && res2 != bob){\n\t\tprintf(\"M\\n\");\n\t}\n\telse if (res1 != bob && res2 == bob){\n\t\tprintf(\"L\\n\");\n\t}\n\telse {\n\t\tprintf(\"I\\n\");\n\t}\n\t\n\treturn (0);\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\nint isMultFirst(char* s, int n)\n{\n    char stack[20], *p;\n    int sp=0, res=0;\n    for(p=s;*p;++p) {\n        if (*p=='*') {\n            int t=stack[--sp]*(*++p-'0');\n            stack[sp++]=t;\n        }\n        else if (*p!='+') {\n            stack[sp++]=*p-'0';\n        }\n    }\n    while (sp>1) {\n        int a=stack[--sp];\n        int b=stack[--sp];\n        stack[sp++]=a+b;\n    }\n    return stack[0]==n;\n}\nint isLeftToRight(char* s, int n)\n{\n    int res=s[0]-'0';\n    char* p;\n    for(p=s+1;*p;p+=2) {\n        if (*p=='+')\n            res=res+(*(p+1))-'0';\n        else\n            res=res*((*(p+1))-'0');\n    }\n    return res==n;\n}\nint main(void)\n{\n    char s[20];\n    int n;\n    while (~scanf(\"%s%d\", s, &n)) {\n        int multi=isMultFirst(s, n);\n        int ltor=isLeftToRight(s, n);\n        puts(multi && ltor ? \"U\" : multi ? \"M\" : ltor ? \"L\" : \"I\");\n    }\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\nint M(char s[]){\n    int i,n,m,a[20];\n    for(i=0,n=0;s[i];i+=2)\n        a[n++]=s[i]-'0';\n    for(i=1;s[i];i+=2){\n        if(s[i]=='*'){\n            a[i/2+1]*=a[i/2];\n            a[i/2]=0;\n        }\n    }\n    for(i=0,m=0;i<n;i++)\n        m+=a[i];\n    return m;\n}\nint L(char s[]){\n    int i,l;\n    for(i=1,l=s[0]-'0';s[i];i+=2){\n        if(s[i]=='+')\n            l+=s[i+1]-'0';\n        else if(s[i]=='*')\n            l*=s[i+1]-'0';\n    }\n    return l;\n}\nint main(void){\n    int i,m,l,b;\n    char s[20];\n    scanf(\"%s\",s);\n    scanf(\"%d\",&b);\n    m=M(s);\n    l=L(s);\n    if(b==m&&b==l)\n        puts(\"U\");\n    else if(b==m)\n        puts(\"M\");\n    else if(b==l)\n        puts(\"L\");\n    else\n        puts(\"I\");\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\ntypedef long long ll;\nint isMultFirst(char* s, int n)\n{\n    ll stack[20], res=0;\n    char *p;\n    int sp=0;\n    for(p=s;*p;++p) {\n        if (*p=='*') {\n            ll t=stack[--sp]*(*++p-'0');\n            stack[sp++]=t;\n        }\n        else if (*p!='+') {\n            stack[sp++]=*p-'0';\n        }\n    }\n    while (sp>1) {\n        ll a=stack[--sp];\n        ll b=stack[--sp];\n        stack[sp++]=a+b;\n    }\n    return stack[0]==n;\n}\nint isLeftToRight(char* s, int n)\n{\n    ll res=s[0]-'0';\n    char* p;\n    for(p=s+1;*p;p+=2) {\n        if (*p=='+')\n            res=res+(*(p+1))-'0';\n        else\n            res=res*((*(p+1))-'0');\n    }\n    return res==n;\n}\nint main(void)\n{\n    char s[20];\n    int n;\n    while (~scanf(\"%s%d\", s, &n)) {\n        int multi=isMultFirst(s, n);\n        int ltor=isLeftToRight(s, n);\n        puts(multi && ltor ? \"U\" : multi ? \"M\" : ltor ? \"L\" : \"I\");\n    }\n    return 0;\n}"
  },
  {
    "language": "Java",
    "code": "// AOJ 1346 \"Miscalculation\" (ICPCアジア地区予選 2014 東京大会 Problem B)\nimport java.util.Scanner;\n\npublic class Main {\n    static int pos = 0; // 四則演算の構文解析における現在位置\n    public static void main(String[] args) {\n        Scanner sc = new Scanner(System.in);\n        \n        String s = sc.next();\n        int ansOfBob = sc.nextInt();\n        \n        int ansMulFirst = evalMulFirst(s);\n        int ansLeftToRight = evalLeftToRight(s);\n        \n        if (ansOfBob == ansMulFirst && ansOfBob == ansLeftToRight) {\n            System.out.println(\"U\");\n        } else if (ansOfBob == ansMulFirst) {\n            System.out.println(\"M\");\n        } else if (ansOfBob == ansLeftToRight) {\n            System.out.println(\"L\");\n        } else {\n            System.out.println(\"I\");\n        }\n    }\n    \n    public static int evalMulFirst(String s) {\n        int ans = evalMul(s);\n        while (pos < s.length()) {\n            pos++;\n            ans += evalMul(s);\n        }\n        return ans;\n    }\n    \n    private static int evalMul(String s) {\n        int ans = evalFactor(s);\n        while (pos < s.length() && s.charAt(pos) == '*') {\n            pos++;\n            int b = evalFactor(s);\n            ans *= b;\n        }\n        \n        return ans;\n    }\n    \n    private static int evalFactor(String s) {\n        int num = s.charAt(pos) - '0';\n        pos++;\n        return num;\n    }\n    \n    public static int evalLeftToRight(String s) {\n        int ans = s.charAt(0) - '0'; // 最初の文字を足す\n        for (int i = 1; i < s.length(); i += 2) {\n            char c = s.charAt(i);\n            if (c == '+') {\n                ans += s.charAt(i + 1) - '0';\n            } else {\n                ans *= s.charAt(i + 1) - '0';\n            }\n        }\n        \n        return ans;\n    }\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.FileInputStream;\nimport java.io.FileNotFoundException;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.InputMismatchException;\n\npublic class Main {\n\tInputStream is;\n\n\tint __t__ = 1;\n\tint __f__ = 0;\n\tint __FILE_DEBUG_FLAG__ = __f__;\n\tString __DEBUG_FILE_NAME__ = \"src/T1\";\n\n\tFastScanner in;\n\tPrintWriter out;\n\t\n\tint multFirst(String s) {\n\t\tint res = 0;\n\t\tint prev = s.charAt(0) - '0';\n\t\tfor (int i = 1; i < s.length(); i += 2) {\n\t\t\tif (s.charAt(i) == '*') {\n\t\t\t\tprev *= s.charAt(i + 1) - '0';\n\t\t\t} else {\n\t\t\t\tres += prev;\n\t\t\t\tprev = s.charAt(i + 1) - '0';\n\t\t\t}\n\t\t}\n\t\tres += prev;\n\t\treturn res;\n\t}\n\t\n\tint leftToRight(String s) {\n\t\tint res = s.charAt(0) - '0';\n\t\tfor (int i = 1; i < s.length(); i += 2) {\n\t\t\tif (s.charAt(i) == '*') {\n\t\t\t\tres *= s.charAt(i + 1) - '0';\n\t\t\t} else {\n\t\t\t\tres += s.charAt(i + 1) - '0';\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}\n\t\n\tpublic void solve() {\n\t\tString s = in.next();\n\t\tint val = in.nextInt();\n\t\t\n\t\tint a = multFirst(s);\n\t\tint b = leftToRight(s);\n\t\t\n\t\tif (a == val) {\n\t\t\tif (b == val) {\n\t\t\t\tSystem.out.println(\"U\");\n\t\t\t} else {\n\t\t\t\tSystem.out.println(\"M\");\n\t\t\t}\n\t\t} else {\n\t\t\tif (b == val) {\n\t\t\t\tSystem.out.println(\"L\");\n\t\t\t} else {\n\t\t\t\tSystem.out.println(\"I\");\n\t\t\t}\n\t\t}\n\t}\t\n\t\n\tpublic void run() {\n\t\tif (__FILE_DEBUG_FLAG__ == __t__) {\n\t\t\ttry {\n\t\t\t\tis = new FileInputStream(__DEBUG_FILE_NAME__);\n\t\t\t} catch (FileNotFoundException e) {\n\t\t\t\t// TODO ????????????????????? catch ????????????\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t\tSystem.out.println(\"FILE_INPUT!\");\n\t\t} else {\n\t\t\tis = System.in;\n\t\t}\n\t\tin = new FastScanner(is);\n\t\tout = new PrintWriter(System.out);\n\n\t\tsolve();\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tint[][] nextIntMap(int n, int m) {\n\t\t\tint[][] map = new int[n][m];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tmap[i] = nextIntArray(m);\n\t\t\t}\n\t\t\treturn map;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong[][] nextLongMap(int n, int m) {\n\t\t\tlong[][] map = new long[n][m];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tmap[i] = nextLongArray(m);\n\t\t\t}\n\t\t\treturn map;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble[][] nextDoubleMap(int n, int m) {\n\t\t\tdouble[][] map = new double[n][m];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tmap[i] = nextDoubleArray(m);\n\t\t\t}\n\t\t\treturn map;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\nimport java.util.ArrayList;\n\npublic class Main {\n\tScanner sc = new Scanner(System.in);\n\tpublic void run(){\n\t\tString exp = sc.next();\n\t\tcalc(exp);\n\t}\n\tpublic void calc(String exp){\n\t\tint ans1 = 0;\n\t\tint ans2 = Integer.parseInt(exp.substring(0,1));\n\t\t\n\t\tint temp = ans2;\n\t\t\n\t\tfor(int i = 0; i < exp.length() / 2; i++){\n\t\t\tString e = exp.substring(2*i+1, 2*i+2);\n\t\t\tint k = Integer.parseInt(exp.substring(2*i+2, 2*i+3));\n\t\t\t\n\t\t\tif(e.equals(\"+\")){\n\t\t\t\tans2 += k;\n\t\t\t\t\n\t\t\t\tans1 += temp;\n\t\t\t\ttemp = k;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tans2 *= k;\n\t\t\t\t\n\t\t\t\ttemp*= k;\n\t\t\t}\n\t\t}\n\t\tans1 += temp;\n\t\t\n\t\tint bob_ans = sc.nextInt();\n\t\tString output = \"\";\n\t\t\n\t\tif(bob_ans == ans1){\n\t\t\tif(bob_ans == ans2) output = \"U\";\n\t\t\telse output = \"M\";\n\t\t}\n\t\telse if(bob_ans == ans2) output = \"L\";\n\t\telse output = \"I\";\n\t\t\n\t\tSystem.out.println(output);\n\t\t\n\t}\n\t\n\tpublic static void main(String[] args){\n\t\tnew Main().run();\n\t}\n\t\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tString s = sc.next();\n\t\tint n = sc.nextInt();\n\t\tint mulFirst = (int) new Expression(s).value();\n\t\tint leftToRight = s.charAt(0) - '0';\n\t\tint length = (s.length() + 1) / 2;\n\t\tfor(int i=1;i<length;i++) {\n\t\t\tint v = s.charAt(i*2) - '0';\n\t\t\tchar c = s.charAt(i*2-1);\n\t\t\tleftToRight = c == '+' ? leftToRight + v : leftToRight * v;\n\t\t}\n\n\t\t//System.err.println(n + \",\" + mulFirst + \",\" + leftToRight);\n\t\tif (n == mulFirst) {\n\t\t\tif (n == leftToRight) {\n\t\t\t\tSystem.out.println(\"U\");\n\t\t\t}else{\n\t\t\t\tSystem.out.println(\"M\");\n\t\t\t}\n\t\t}else{\n\t\t\tif (n == leftToRight) {\n\t\t\t\tSystem.out.println(\"L\");\n\t\t\t}else{\n\t\t\t\tSystem.out.println(\"I\");\n\t\t\t}\n\t\t}\n\n\t\tsc.close();\n\t}\n}\nclass Expression {\n\tprivate String expression;\n\tprivate int begin = 0;\n\tpublic Expression(String expression) {\n\t\tthis.expression = expression;\n\t}\n\tpublic double value() {\n\t\tdouble num = term();\n\t\twhile(begin<expression.length()) {\n\t\t\tchar c = expression.charAt(begin);\n\t\t\tif (c=='+') {\n\t\t\t\tbegin++;\n\t\t\t\tnum+=term();\n\t\t\t}else if(c=='-') {\n\t\t\t\tbegin++;\n\t\t\t\tnum-=term();\n\t\t\t}else{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn num;\n\t}\n\tprivate double term() {\n\t\tdouble num = factor();\n\t\twhile(begin<expression.length()) {\n\t\t\tchar c = expression.charAt(begin);\n\t\t\tif (c=='*') {\n\t\t\t\tbegin++;\n\t\t\t\tnum*=factor();\n\t\t\t}else if(c=='/') {\n\t\t\t\tbegin++;\n\t\t\t\tnum/=factor();\n\t\t\t}else{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn num;\n\t}\n\tprivate double factor() {\n\t\tchar c = expression.charAt(begin);\n\t\tif (c=='(') {\n\t\t\tbegin++; //(\n\t\t\tdouble num = value();\n\t\t\tbegin++; //)\n\t\t\treturn num;\n\t\t}else{\n\t\t\treturn number();\n\t\t}\n\t}\n\tprivate int number() {\n\t\tint num = 0;\n\t\twhile(begin<expression.length()) {\n\t\t\tif (Character.isDigit(expression.charAt(begin))) {\n\t\t\t\tnum*=10;\n\t\t\t\tnum+=expression.charAt(begin)-'0';\n\t\t\t\tbegin++;\n\t\t\t}else{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn num;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Iterator;\nimport java.util.Scanner;\n\npublic class Main {\n\n\t/**\n\t * @param args\n\t */\n\tpublic static void main(String[] args) {\n\t\tScanner sc=new Scanner(System.in);\n\t\tString s = sc.next();\n\t\tlong ans = sc.nextInt();\n\t\tlong a = 0,b=0;\n\t\t\n\t\t// for a\n\t\tString[] ss =s.split(\"\\\\+\");\n\t\tfor(int i = 0;i<ss.length;i++){\n\t\t\tString sp[] = ss[i].split(\"\\\\*\");\n\t\t\tlong z = 1;\n\t\t\tfor(String t:sp){\n\t\t\t\tint x = Integer.parseInt(t);\n\t\t\t\tz = z * x;\n\t\t\t}\n\t\t\ta += z;\n\t\t}\n\t\t\n\t\tb = s.charAt(0)-'0';\n\t\t// for b\n\t\tfor(int i=1;i<s.length();i+=2){\n\t\t\tint num = s.charAt(i+1)-'0';\n\t\t\tif(s.charAt(i)=='+'){\n\t\t\t\tb = b + num;\n\t\t\t} else {\n\t\t\t\tb = b * num;\n\t\t\t}\n\t\t}\n\t\tif(a==b && a==ans){\n\t\t\tSystem.out.println(\"U\");\n\t\t} else if((a!=ans && b!=ans)){\n\t\t\tSystem.out.println(\"I\");\n\t\t} else if(a==ans){\n\t\t\tSystem.out.println(\"M\");\n\t\t} else if(b==ans){\n\t\t\tSystem.out.println(\"L\");\n\t\t}\n\t\t\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\npublic class Main {\n\tstatic String str,p;\n\tstatic int l,ct;\n\tstatic long ans,a,b,c;\n\tstatic long[] aa=new long[100];\n\tstatic char[] bb=new char[100];\n\tstatic Stack<Long> s=new Stack<Long>();\n\n\tpublic static void main(String[] args) {\n\t\tScanner in=new Scanner(System.in);\n\t\tstr=in.next();ans=in.nextInt();\n\t\tl=str.length();\n\t\tp=\"\";ct=0;\n\t\tfor(int i=0;i<l;i++)\n\t\t{\n\t\t\tif(str.charAt(i)<'9'&&str.charAt(i)>'0')\n\t\t\t\tp+=str.charAt(i);\n\t\t\telse\n\t\t\t{\n\t\t\t\tc=Long.parseLong(p);p=\"\";\n\t\t\t\taa[ct]=c;bb[ct++]=str.charAt(i);\n\t\t\t}\n\t\t}\n\t\tc=Long.parseLong(p);aa[ct]=c;\n\t\ta=aa[0];\n\t\tfor(int i=0;i<ct;i++)\n\t\t{\n\t\t\tif(bb[i]=='+') a+=aa[i+1];\n\t\t\telse a*=aa[i+1];\n\t\t}\n\t\ts.push(aa[0]);\n\t\tfor(int i=0;i<ct;i++)\n\t\t{\n\t\t\tif(bb[i]=='*')\n\t\t\t{\n\t\t\t\tc=s.pop();c=c*aa[i+1];\n\t\t\t\ts.add(c);\n\t\t\t}\n\t\t\telse s.add(aa[i+1]);\n\t\t}\n\t\twhile(!s.isEmpty())\n\t\t{\n\t\t\tc=s.pop();\n\t\t\tb+=c;\n\t\t}\n\t\tif(a!=ans&&b!=ans)\n\t\t\tSystem.out.println(\"I\");\n\t\telse if(a==ans&&b==ans)\n\t\t\tSystem.out.println(\"U\");\n\t\telse if(b==ans)\n\t\t\tSystem.out.println(\"M\");\n\t\telse System.out.println(\"L\");\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\tScanner sc = new Scanner(System.in);\n\tint index = 0;\n\n\tvoid run() {\n\t\tString input = sc.next();\n\t\tint ans = sc.nextInt();\n\t\tboolean M = false;\n\t\tboolean L = false;\n\n\t\tint s = Integer.valueOf(input.charAt(0) - '0');\n\t\tint sum = s;\n\t\t// L\n\t\tfor (int i = 1; i < input.length() - 1; i++) {\n\t\t\tchar c = input.charAt(i);\n\t\t\tchar n = input.charAt(i + 1);\n\t\t\tif (!Character.isDigit(c)) {\n\t\t\t\tif (c == '*') {\n\t\t\t\t\tsum *= Integer.valueOf(n - '0');\n\t\t\t\t} else {\n\t\t\t\t\tsum += Integer.valueOf(n - '0');\n\t\t\t\t}\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t\tif (sum == ans) {\n\t\t\tL = true;\n\t\t}\n\t\t// M\n\t\tif (expression(input) == ans) {\n\t\t\tM = true;\n\t\t}\n\t\tif (L && M) {\n\t\t\tSystem.out.println(\"U\");\n\t\t} else if (L) {\n\t\t\tSystem.out.println(\"L\");\n\t\t} else if (M) {\n\t\t\tSystem.out.println(\"M\");\n\t\t} else {\n\t\t\tSystem.out.println(\"I\");\n\t\t}\n\t}\n\n\tint expression(String sb) {\n\t\tint res = term(sb);\n\t\tfor (; index < sb.length();) {\n\t\t\tif (sb.charAt(index) == '+') {\n\t\t\t\tindex++;\n\t\t\t\tres += term(sb);\n\t\t\t} else if (sb.charAt(index) == '-') {\n\t\t\t\tindex++;\n\t\t\t\tres -= term(sb);\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}\n\n\tint term(String sb) {\n\t\tint res = factor(sb);\n\t\tfor (; index < sb.length();) {\n\t\t\tif (sb.charAt(index) == '*') {\n\t\t\t\tindex++;\n\t\t\t\tres *= factor(sb);\n\t\t\t} else if (sb.charAt(index) == '/') {\n\t\t\t\tindex++;\n\t\t\t\tres /= factor(sb);\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}\n\n\tint factor(String sb) {\n\t\tint res = 0;\n\t\tif (index < sb.length() && sb.charAt(index) == '(') {\n\t\t\tindex++;\n\t\t\tres = expression(sb);\n\t\t\tindex++;\n\t\t} else {\n\t\t\tres = number(sb);\n\t\t}\n\t\treturn res;\n\t}\n\n\tint number(String sb) {\n\t\tint res = 0;\n\t\twhile (index < sb.length() && Character.isDigit(sb.charAt(index))) {\n\t\t\tres *= 10;\n\t\t\tres += sb.charAt(index) - '0';\n\t\t\tindex++;\n\t\t}\n\t\treturn res;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid debu(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main{\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\tstatic final double EPS=1e-10;\n\n\tstatic void solve(){\n\t\tchar[] ex=ir.next().toCharArray();\n\t\tint n=ir.nextInt();\n\t\tint m=0;\n\t\tfor(int i=1;i<=ex.length;i+=2){\n\t\t\tif(i==ex.length){\n\t\t\t\tm+=ex[ex.length-1]-'0';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(ex[i]=='+'){\n\t\t\t\tm+=ex[i-1]-'0';\n\t\t\t}\n\t\t\telse{\n\t\t\t\tint r=ex[i-1];\n\t\t\t\twhile(i<ex.length&&ex[i]!='+'){\n\t\t\t\t\ti+=2;\n\t\t\t\t\tr*=ex[i-1]-'0';\n\t\t\t\t}\n\t\t\t\tr*=ex[i-1]-'0';\n\t\t\t\tm+=r;\n\t\t\t}\n\t\t}\n\t\tint l=ex[0]-'0';\n\t\tfor(int i=1;i<ex.length;i+=2){\n\t\t\tif(ex[i]=='+')\n\t\t\t\tl+=ex[i+1]-'0';\n\t\t\telse\n\t\t\t\tl*=ex[i+1]-'0';\n\t\t}\n\t\tboolean M=m==n;\n\t\tboolean L=l==n;\n\t\tif(M&&L) out.println(\"U\");\n\t\telse if(M) out.println(\"M\");\n\t\telse if(L) out.println(\"L\");\n\t\telse out.println(\"I\");\n\t}\n\n\tstatic String code(String s,int k){\n\t\tif(s.length()<=k) return s;\n\t\treturn s.substring(0,k);\n\t}\n\n\tpublic static void main(String[] args) throws Exception{\n\t\tir=new InputReader(System.in);\n\t\tout=new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer=new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {this.in=in; this.curbuf=this.lenbuf=0;}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif(curbuf>=lenbuf){\n\t\t\t\tcurbuf= 0;\n\t\t\t\ttry{\n\t\t\t\t\tlenbuf=in.read(buffer);\n\t\t\t\t}catch(IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif(lenbuf<=0) return false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte(){if(hasNextByte()) return buffer[curbuf++]; else return -1;}\n\n\t\tprivate boolean isSpaceChar(int c){return !(c>=33&&c<=126);}\n\n\t\tprivate void skip(){while(hasNextByte()&&isSpaceChar(buffer[curbuf])) curbuf++;}\n\n\t\tpublic boolean hasNext(){skip(); return hasNextByte();}\n\n\t\tpublic String next(){\n\t\t\tif(!hasNext()) throw new NoSuchElementException();\n\t\t\tStringBuilder sb=new StringBuilder();\n\t\t\tint b=readByte();\n\t\t\twhile(!isSpaceChar(b)){\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb=readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif(!hasNext()) throw new NoSuchElementException();\n\t\t\tint c=readByte();\n\t\t\twhile (isSpaceChar(c)) c=readByte();\n\t\t\tboolean minus=false;\n\t\t\tif (c=='-') {\n\t\t\t\tminus=true;\n\t\t\t\tc=readByte();\n\t\t\t}\n\t\t\tint res=0;\n\t\t\tdo{\n\t\t\t\tif(c<'0'||c>'9') throw new InputMismatchException();\n\t\t\t\tres=res*10+c-'0';\n\t\t\t\tc=readByte();\n\t\t\t}while(!isSpaceChar(c));\n\t\t\treturn (minus)?-res:res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif(!hasNext()) throw new NoSuchElementException();\n\t\t\tint c=readByte();\n\t\t\twhile (isSpaceChar(c)) c=readByte();\n\t\t\tboolean minus=false;\n\t\t\tif (c=='-') {\n\t\t\t\tminus=true;\n\t\t\t\tc=readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo{\n\t\t\t\tif(c<'0'||c>'9') throw new InputMismatchException();\n\t\t\t\tres=res*10+c-'0';\n\t\t\t\tc=readByte();\n\t\t\t}while(!isSpaceChar(c));\n\t\t\treturn (minus)?-res:res;\n\t\t}\n\n\t\tpublic double nextDouble(){return Double.parseDouble(next());}\n\n\t\tpublic int[] nextIntArray(int n){\n\t\t\tint[] a=new int[n];\n\t\t\tfor(int i=0;i<n;i++) a[i]=nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n){\n\t\t\tlong[] a=new long[n];\n\t\t\tfor(int i=0;i<n;i++) a[i]=nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n,int m){\n\t\t\tchar[][] map=new char[n][m];\n\t\t\tfor(int i=0;i<n;i++) map[i]=next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.*;\n\nimport static java.lang.Integer.parseInt;\n\n/**\n * Miscalculation\n */\npublic class Main {\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line;\n\t\tString[] words;\n\n\t\tString exp = br.readLine();\n\t\tint ans = parseInt(br.readLine());\n\n\t\tint M, L;\n\t\tM = M(exp);\n\t\tL = L(exp);\n\t\tif (ans == M) {\n\t\t\tSystem.out.println('M');\n\t\t} else if (ans == L) {\n\t\t\tSystem.out.println('L');\n\t\t} else if (ans == M && ans == L) {\n\t\t\tSystem.out.println('U');\n\t\t} else {\n\t\t\tSystem.out.println('I');\n\t\t}\n\t}\n\n\tstatic int M(String exp) {\n\t\tchar[] pri = new char[127];\n\t\tfor (int i = '0'; i <= '9'; i++) pri[i] = 3;\n\t\tpri['*'] = 2;\n\t\tpri['+'] = 1;\n\t\tpri[0] = 0;\n\t\treturn calc(exp, pri);\n\t}\n\n\tstatic int L(String exp) {\n\t\tchar[] pri = new char[127];\n\t\tfor (int i = '0'; i <= '9'; i++) pri[i] = 3;\n\t\tpri['*'] = 1;\n\t\tpri['+'] = 1;\n\t\tpri[0] = 0;\n\t\treturn calc(exp, pri);\n\t}\n\n\tstatic int calc(String exp, char[] pri) {\n\t\tDeque<Character> stack = new ArrayDeque<>();\n\t\tDeque<Character> queue = new ArrayDeque<>();\n\n\t\tstack.push('\\0');\n\t\tfor (char c : exp.toCharArray()) {\n\t\t\tif (pri[c] > pri[stack.peek()]) {\n\t\t\t\tstack.push(c);\n\t\t\t} else {\n\t\t\t\twhile (pri[c] < pri[stack.peek()]) {\n\t\t\t\t\tqueue.offer(stack.pop());\n\t\t\t\t}\n\t\t\t\tstack.push(c);\n\t\t\t}\n\t\t}\n\t\twhile (stack.peek() != '\\0') queue.offer(stack.pop());\n\n\t\t//\n\t\tString rpn = \"\";\n\t\tDeque<Integer> ans = new ArrayDeque<>();\n\n\t\tfor (char c : queue) rpn += String.valueOf(c);\n\t\tfor (char c : rpn.toCharArray()) {\n\t\t\tint a, b;\n\t\t\tswitch (c) {\n\t\t\t\tcase '*':\n\t\t\t\t\tb = ans.pop();\n\t\t\t\t\ta = ans.pop();\n\t\t\t\t\tans.push(a * b);\n\t\t\t\t\tbreak;\n\t\t\t\tcase '+':\n\t\t\t\t\tb = ans.pop();\n\t\t\t\t\ta = ans.pop();\n\t\t\t\t\tans.push(a + b);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tans.push(c - '0');\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn ans.peek();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.util.regex.*;\n\nclass Main{\n\tprivate final static Pattern addsubmuldiv = Pattern.compile(\"^(.*?)(-?\\\\d+)([+Z*/])(-?\\\\d+)(.*)$\");\n\tprivate final static Pattern addsub = Pattern.compile(\"^(.*?)(-?\\\\d+)([+Z])(-?\\\\d+)(.*)$\");\n\tprivate final static Pattern muldiv = Pattern.compile(\"^(.*?)(-?\\\\d+)([*/])(-?\\\\d+)(.*)$\");\n\n\tprivate static String process(String s){\n\t\tMatcher m=muldiv.matcher(s);\n\t\twhile(m.find()){\n\t\t\tif(m.group(3).equals(\"*\"))\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))*Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\telse\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))/Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\tm=muldiv.matcher(s);\n\t\t}\n\n\t\tm=addsub.matcher(s);\n\t\twhile(m.find()){\n\t\t\tif(m.group(3).equals(\"+\"))\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))+Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\telse\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))-Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\tm=addsub.matcher(s);\n\t\t}\n\t\treturn s;\n\t}\n\n\tprivate static String process2(String s){\n\t\tMatcher m=addsubmuldiv.matcher(s);\n\t\twhile(m.find()){\n\t\t\tif(m.group(3).equals(\"*\"))\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))*Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\telse if(m.group(3).equals(\"/\"))\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))/Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\telse if(m.group(3).equals(\"+\"))\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))+Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\telse\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))-Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\tm=addsubmuldiv.matcher(s);\n\t\t}\n\t\treturn s;\n\t}\n\n\tpublic static void main(String[]z){\n\t\tScanner x=new Scanner(System.in);\n\t\tfor(;x.hasNext();){\n\t\t\tString s=x.next().replaceAll(\"-\",\"Z\");\n\t\t\tString ans=x.next();\n\t\t\tboolean a=process(s).equals(ans);\n\t\t\tboolean b=process2(s).equals(ans);\n\t\t\tif(a&&b)System.out.println(\"U\");\n\t\t\tif(a&&!b)System.out.println(\"M\");\n\t\t\tif(!a&&b)System.out.println(\"L\");\n\t\t\tif(!a&&!b)System.out.println(\"I\");\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.*;\n \npublic class Main{\n\tpublic void solve(){\n\t\tString exp = next();\n\t\tint m = nextInt();\n\t\t\n\t\tint a = calc2(exp);\n\t\tint b = calc1(exp);\n\t\tif(a == m && b == m){\n\t\t\tout.println(\"U\");\n\t\t}else if(a == m){\n\t\t\tout.println(\"M\");\n\t\t}else if(b == m){\n\t\t\tout.println(\"L\");\n\t\t}else{\n\t\t\tout.println(\"I\");\n\t\t}\n\t}\n\tpublic int calc1(String exp){\n\t\tint ans = exp.charAt(0) - '0';\n\t\tfor(int i = 1; i < exp.length() - 1; i+=2){\n\t\t\tif(exp.charAt(i) == '+'){\n\t\t\t\tans += (exp.charAt(i + 1) - '0');\n\t\t\t}else{\n\t\t\t\tans *= (exp.charAt(i + 1) - '0');\n\t\t\t}\n\t\t}\n\t\treturn ans;\n\t}\n\tString ss;\n\tint idx;\n\tpublic int calc2(String exp){\n\t\tthis.ss = exp;\n\t\tthis.idx = 0;\n\t\treturn e();\n\t}\n\t\n\tpublic int e(){\n\t\tint val = t();\n\t\twhile(idx < ss.length() && ss.charAt(idx) == '+'){\n\t\t\tidx++;\n\t\t\tval += t();\n\t\t}\n\t\treturn val;\n\t}\n\tpublic int t(){\n\t\tint val = f();\n\t\twhile(idx < ss.length() && ss.charAt(idx) == '*'){\n\t\t\tidx++;\n\t\t\tval *= f();\n\t\t}\n\t\treturn val;\n\t}\n\t\n\tpublic int f(){\n\t\tint val = ss.charAt(idx++) - '0';\n\t\treturn val;\n\t}\n\t\n\tprivate static PrintWriter out;\n\tpublic static void main(String[] args){\n\t\tout = new PrintWriter(System.out);\n\t\tnew Main().solve();\n\t\tout.flush();\n\t}\n\t\n\t\n\t\n\tpublic static int nextInt(){\n\t\tint num = 0;\n\t\tString str = next();\n\t\tboolean minus = false;\n\t\tint i = 0;\n\t\tif(str.charAt(0) == '-'){\n\t\t\tminus = true;\n\t\t\ti++;\n\t\t}\n\t\tint len = str.length();\n\t\tfor(;i < len; i++){\n\t\t\tchar c = str.charAt(i);\n\t\t\tif(!('0' <= c && c <= '9')) throw new RuntimeException();\n\t\t\tnum = num * 10 + (c - '0');\n\t\t}\n\t\treturn minus ? -num : num;\n\t}\n\t\n\tpublic static long nextLong(){\n\t\tlong num = 0;\n\t\tString str = next();\n\t\tboolean minus = false;\n\t\tint i = 0;\n\t\tif(str.charAt(0) == '-'){\n\t\t\tminus = true;\n\t\t\ti++;\n\t\t}\n\t\tint len = str.length();\n\t\tfor(;i < len; i++){\n\t\t\tchar c = str.charAt(i);\n\t\t\tif(!('0' <= c && c <= '9')) throw new RuntimeException();\n\t\t\tnum = num * 10l + (c - '0');\n\t\t}\n\t\treturn minus ? -num : num;\n\t}\n\tpublic static String next(){\n\t\tint c;\n\t\twhile(!isAlNum(c = read())){}\n\t\tStringBuilder build = new StringBuilder();\n\t\tbuild.append((char)c);\n\t\twhile(isAlNum(c = read())){\n\t\t\tbuild.append((char)c);\n\t\t}\n\t\treturn build.toString();\n\t}\n\t\n\t\n\tprivate static byte[] inputBuffer = new byte[1024];\n\tprivate static int bufferLength = 0;\n\tprivate static int bufferIndex = 0;\n\tprivate static int read(){\n\t\tif(bufferLength < 0) throw new RuntimeException();\n\t\tif(bufferIndex >= bufferLength){\n\t\t\ttry{\n\t\t\t\tbufferLength = System.in.read(inputBuffer);\n\t\t\t\tbufferIndex = 0;\n\t\t\t}catch(IOException e){\n\t\t\t\tthrow new RuntimeException(e);\n\t\t\t}\n\t\t\tif(bufferLength <= 0) return (bufferLength = -1);\n\t\t}\n\t\treturn inputBuffer[bufferIndex++];\n\t}\n\t\n\tprivate static boolean isAlNum(int c){\n\t\treturn '!' <= c && c <= '~';\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.*;\nimport java.io.*;\n\npublic class Main{\n    static final Reader sc = new Reader();\n    static final PrintWriter out = new PrintWriter(System.out,false);\n\n    public static void main(String[] args) throws Exception {\n    \t\n    \tString s = sc.next();\n    \tint ans = sc.nextInt();\n    \tint l = 0;\n    \tint m = 0;\n    \tint left = 0;\n    \tint a = 0;\n    \tfor(int i=0;i<s.length();i++){\n    \t\tif(s.charAt(i)>='0' && s.charAt(i)<='9'){\n\n    \t\t}\n    \t\telse{\n    \t\t\tint x = 0;\n    \t\t\tfor(int j=left;j<i;j++){\n    \t\t\t\tx += ((int)s.charAt(j)-(int)'0')*(int)Math.pow(10,i-j-1);\n    \t\t\t}\n    \t\t\tif(a==0){\n    \t\t\t\tl += x;\n    \t\t\t}\n    \t\t\telse{\n    \t\t\t\tl *= x;\n    \t\t\t}\n    \t\t\tif(s.charAt(i)=='*'){\n    \t\t\t\ta = 1;\n    \t\t\t}\n    \t\t\telse if(s.charAt(i)=='+'){\n    \t\t\t\ta = 0;\n    \t\t\t}\n    \t\t\tleft = i+1;\n    \t\t}\n    \t\tif(i==s.length()-1){\n    \t\t\tint x = 0;\n    \t\t\tfor(int j=left;j<s.length();j++){\n    \t\t\t\tx += ((int)s.charAt(j)-(int)'0')*(int)Math.pow(10,i-j);\n    \t\t\t}\n    \t\t\tif(a==0){\n    \t\t\t\tl += x;\n    \t\t\t}\n    \t\t\telse{\n    \t\t\t\tl *= x;\n    \t\t\t}\n    \t\t}\n    \t}\n    \tleft = 0;\n    \ta = 0;\n    \tint y = 0;\n    \tint z = 0;\n    \tint ll = 0;\n    \tArrayList<func> list = new ArrayList<func>();\n    \tboolean[] flag = new boolean[s.length()];\n    \tfor(int i=0;i<s.length();i++){\n    \t\tif(s.charAt(i)=='*'){\n    \t\t\tif(a==1){\n    \t\t\t\tz = 0;\n    \t\t\t\tfor(int j=left;j<i;j++){\n    \t\t\t\t\tz += ((int)s.charAt(j)-(int)'0')*(int)Math.pow(10,i-j-1);\n    \t\t\t\t}\n    \t\t\t\ty *= z;\n    \t\t\t}\n    \t\t\telse{\n\t    \t\t\tfor(int j=left;j<i;j++){\n    \t\t\t\t\ty += ((int)s.charAt(j)-(int)'0')*(int)Math.pow(10,i-j-1);\n    \t\t\t\t}\n    \t\t\t\tll = left;\n    \t\t\t}\n    \t\t\tleft = i+1;\n    \t\t\ta = 1;\n    \t\t}\n    \t\telse if(s.charAt(i)=='+'){\n    \t\t\tif(a==1){\n    \t\t\t\tz = 0;\n    \t\t\t\tfor(int j=left;j<i;j++){\n    \t\t\t\t\tz += ((int)s.charAt(j)-(int)'0')*(int)Math.pow(10,i-j-1);\n    \t\t\t\t}\n    \t\t\t\ty *= z;\n    \t\t\t\tfunc w = new func(ll,i-1,y);\n    \t\t\t\tlist.add(w);\n    \t\t\t\tflag[ll] = true;\n    \t\t\t\ty = 0;\n    \t\t\t\tll = 0;\n    \t\t\t}\n    \t\t\tleft = i+1;\n    \t\t\ta = 0;\n    \t\t}\n    \t\tif(i==s.length()-1 && a==1){\n    \t\t\tz = 0;\n    \t\t\tfor(int j=left;j<s.length();j++){\n    \t\t\t\tz += ((int)s.charAt(j)-(int)'0')*(int)Math.pow(10,i-j);\n    \t\t\t}\n    \t\t\ty *= z;\n    \t\t\tfunc w = new func(ll,s.length()-1,y);\n    \t\t\tlist.add(w);\n    \t\t\tflag[ll] = true;\n    \t\t}\n    \t}\n    \tleft = 0;\n    \tint count = 0;\n    \tfor(int i=0;i<s.length();i++){\n    \t\tif(s.charAt(i)=='+'){\n    \t\t\tz = 0;\n    \t\t\tif(flag[left]){\n    \t\t\t\tfunc w = list.get(count);\n    \t\t\t\tz = w.an;\n    \t\t\t\tcount++;\n    \t\t\t}\n    \t\t\telse{\n    \t\t\t\tfor(int j=left;j<i;j++){\n    \t\t\t\t\tz += ((int)s.charAt(j)-(int)'0')*(int)Math.pow(10,i-j-1);\n    \t\t\t\t}\n    \t\t\t}\n    \t\t\tm += z;\n    \t\t\tleft = i+1;\n    \t\t}\n    \t\tif(i==s.length()-1){\n    \t\t\tz = 0;\n    \t\t\tif(flag[left]){\n    \t\t\t\tfunc w = list.get(count);\n    \t\t\t\tz = w.an;\n    \t\t\t}\n    \t\t\telse{\n    \t\t\t\tfor(int j=left;j<s.length();j++){\n    \t\t\t\t\tz += ((int)s.charAt(j)-(int)'0')*(int)Math.pow(10,i-j);\n    \t\t\t\t}\n    \t\t\t}\n    \t\t\tm += z;\n    \t\t}\n    \t}\n    \tif(ans==l && ans==m){\n    \t\tout.println(\"U\");\n    \t}\n    \telse if(ans==l){\n    \t\tout.println(\"L\");\n    \t}\n    \telse if(ans==m){\n    \t\tout.println(\"M\");\n    \t}\n    \telse{\n    \t\tout.println(\"I\");\n    \t}\n    \tout.flush();\n        sc.close();\n        out.close();\n    }\n\n    static void trace(Object... o) { System.out.println(Arrays.deepToString(o));}\n}\n\nclass func {\n\tint ll = 0;\n\tint rr = 0;\n\tint an = 0;\n\tfunc(int ll,int rr,int an){\n\t\tthis.ll = ll;\n\t\tthis.rr = rr;\n\t\tthis.an = an;\n\t}\n}\n\nclass Reader {\n\n    private final InputStream in;\n    private final byte[] buf = new byte[1024];\n    private int ptr = 0;\n    private int buflen = 0;\n\n    public Reader() { this(System.in);}\n    public Reader(InputStream source) { this.in = source;}\n\n    private boolean hasNextByte() {\n        if (ptr < buflen) return true;\n        ptr = 0;\n        try{\n            buflen = in.read(buf);\n        }catch (IOException e) {e.printStackTrace();}\n        if (buflen <= 0) return false;\n        return true;\n    }\n\n    private int readByte() { if (hasNextByte()) return buf[ptr++]; else return -1;}\n\n    private boolean isPrintableChar(int c) { return 33 <= c && c <= 126;}\n\n    private void skip() { while(hasNextByte() && !isPrintableChar(buf[ptr])) ptr++;}\n\n    public boolean hasNext() {skip(); return hasNextByte();}\n\n    public String next() {\n        if (!hasNext()) throw new NoSuchElementException();\n        StringBuilder sb = new StringBuilder();\n        int b = readByte();\n        while (isPrintableChar(b)) {\n            sb.appendCodePoint(b);\n            b = readByte();\n        }\n        return sb.toString();\n    }\n\n    public long nextLong() {\n        if (!hasNext()) throw new NoSuchElementException();\n        boolean minus = false;\n        long num = readByte();\n\n        if(num == '-'){\n            num = 0;\n            minus = true;\n        }else if (num < '0' || '9' < num){\n            throw new NumberFormatException();\n        }else{\n            num -= '0';\n        }\n\n        while(true){\n            int b = readByte();\n            if('0' <= b && b <= '9')\n                num = num * 10 + (b - '0');\n            else if(b == -1 || !isPrintableChar(b))\n                return minus ? -num : num;\n            else\n                throw new NoSuchElementException();\n        }\n    }\n\n    public int nextInt() {\n        long num = nextLong();\n        if (num < Integer.MIN_VALUE || Integer.MAX_VALUE < num)\n            throw new NumberFormatException();\n        return (int)num;\n    }\n\n    public double nextDouble() {\n        return Double.parseDouble(next());\n    }\n\n    public char nextChar() {\n        if (!hasNext()) throw new NoSuchElementException();\n        return (char)readByte();\n    }\n\n    public String nextLine() {\n        while (hasNextByte() && (buf[ptr] == '\\n' || buf[ptr] == '\\r')) ptr++;\n        if (!hasNextByte()) throw new NoSuchElementException();\n\n        StringBuilder sb = new StringBuilder();\n        int b = readByte();\n        while (b != '\\n' && b != '\\r') {\n            sb.appendCodePoint(b);\n            b = readByte();\n        }\n\n        return sb.toString();\n    }\n\n    public int[] nextIntArray(int n) {\n        int[] res = new int[n];\n        for (int i=0; i<n; i++) res[i] = nextInt();\n        return res;\n    }\n\n    public char[] nextCharArray(int n) {\n        char[] res = new char[n];\n        for (int i=0; i<n; i++) res[i] = nextChar();\n        return res;\n    }\n\n    public void close() {try{ in.close();}catch(IOException e){ e.printStackTrace();}};\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tprivate void run() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tString exp = sc.next();\n\t\tint res = sc.nextInt();\n\t\tboolean m = multiple(exp, res);\n\t\tboolean l = left(exp, res);\n\t\tif (m && l)\n\t\t\tSystem.out.println('U');\n\t\telse if (m)\n\t\t\tSystem.out.println('M');\n\t\telse if (l)\n\t\t\tSystem.out.println('L');\n\t\telse\n\t\t\tSystem.out.println('I');\n\t\tsc.close();\n\t}\n\n\tprivate boolean left(String exp, int res) {\n\t\tint result = 0;\n\t\tchar op = '+';\n\t\tfor (char c : exp.toCharArray()) {\n\t\t\tif (Character.isDigit(c))\n\t\t\t\tif (op == '+')\n\t\t\t\t\tresult += c - '0';\n\t\t\t\telse\n\t\t\t\t\tresult *= c - '0';\n\t\t\telse\n\t\t\t\top = c;\n\t\t}\n\t\treturn result == res;\n\t}\n\n\tprivate boolean multiple(String exp, int res) {\n\t\tString[] terms = exp.split(\"\\\\+\");\n\t\tint sum = 0;\n\t\tfor (String term : terms) {\n\t\t\tString[] factors = term.split(\"\\\\*\");\n\t\t\tint fact = 1;\n\t\t\tfor (String factor : factors) {\n\t\t\t\tfact *= Integer.parseInt(factor);\n\t\t\t}\n\t\t\tsum += fact;\n\t\t}\n\t\treturn res == sum;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "// AOJ 1346 \"Miscalculation\" (ICPCアジア地区予選 2014 東京大会 Problem B)\nimport java.util.Scanner;\n\npublic class Main {\n    static int pos = 0; // 四則演算の構文解析における現在位置\n    public static void main(String[] args) {\n        Scanner sc = new Scanner(System.in);\n        \n        String s = sc.next();\n        int ansOfBob = sc.nextInt();\n        \n        int ansMulFirst = evalMulFirst(s);\n        it ansLeftToRight = evalLeftToRight(s);\n        \n        if (ansOfBob == ansMulFirst && ansOfBob == ansLeftToRight) {\n            System.out.println(\"U\");\n        } else if (ansOfBob == ansMulFirst) {\n            System.out.println(\"M\");\n        } else if (ansOfBob == ansLeftToRight) {\n            System.out.println(\"L\");\n        } else {\n            System.out.println(\"I\");\n        }\n    }\n    \n    public static int evalMulFirst(String s) {\n        int ans = evalMul(s);\n        while (pos < s.length()) {\n            pos++;\n            ans += evalMul(s);\n        }\n        return ans;\n    }\n    \n    private static int evalMul(String s) {\n        int ans = evalFactor(s);\n        while (pos < s.length() && s.charAt(pos) == '*') {\n            pos++;\n            int b = evalFactor(s);\n            ans *= b;\n        }\n        \n        return ans;\n    }\n    \n    private static int evalFactor(String s) {\n        int num = s.charAt(pos) - '0';\n        pos++;\n        return num;\n    }\n    \n    public static int evalLeftToRight(String s) {\n        int ans = s.charAt(0) - '0'; // 最初の文字を足す\n        for (int i = 1; i < s.length(); i += 2) {\n            char c = s.charAt(i);\n            if (c == '+') {\n                ans += s.charAt(i + 1) - '0';\n            } else {\n                ans *= s.charAt(i + 1) - '0';\n            }\n        }\n        \n        return ans;\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tString s = sc.next();\n\t\tint n = sc.nextInt();\n\t\tint mulFirst = (int) new Expression(s).value();\n\t\tint leftToRight = s.charAt(0) - '0';\n\t\tint length = (s.length() + 1) / 2;\n\t\tfor(int i=1;i<length;i++) {\n\t\t\tint v = s.charAt(i*2);\n\t\t\tchar c = s.charAt(i*2-1);\n\t\t\tleftToRight = c == '+' ? leftToRight + v : leftToRight * v;\n\t\t}\n\n\t\tif (n == mulFirst) {\n\t\t\tif (n == leftToRight) {\n\t\t\t\tSystem.out.println(\"U\");\n\t\t\t}else{\n\t\t\t\tSystem.out.println(\"M\");\n\t\t\t}\n\t\t}else{\n\t\t\tif (n == leftToRight) {\n\t\t\t\tSystem.out.println(\"L\");\n\t\t\t}else{\n\t\t\t\tSystem.out.println(\"I\");\n\t\t\t}\n\t\t}\n\n\t\tsc.close();\n\t}\n}\nclass Expression {\n\tprivate String expression;\n\tprivate int begin = 0;\n\tpublic Expression(String expression) {\n\t\tthis.expression = expression;\n\t}\n\tpublic double value() {\n\t\tdouble num = term();\n\t\twhile(begin<expression.length()) {\n\t\t\tchar c = expression.charAt(begin);\n\t\t\tif (c=='+') {\n\t\t\t\tbegin++;\n\t\t\t\tnum+=term();\n\t\t\t}else if(c=='-') {\n\t\t\t\tbegin++;\n\t\t\t\tnum-=term();\n\t\t\t}else{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn num;\n\t}\n\tprivate double term() {\n\t\tdouble num = factor();\n\t\twhile(begin<expression.length()) {\n\t\t\tchar c = expression.charAt(begin);\n\t\t\tif (c=='*') {\n\t\t\t\tbegin++;\n\t\t\t\tnum*=factor();\n\t\t\t}else if(c=='/') {\n\t\t\t\tbegin++;\n\t\t\t\tnum/=factor();\n\t\t\t}else{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn num;\n\t}\n\tprivate double factor() {\n\t\tchar c = expression.charAt(begin);\n\t\tif (c=='(') {\n\t\t\tbegin++; //(\n\t\t\tdouble num = value();\n\t\t\tbegin++; //)\n\t\t\treturn num;\n\t\t}else{\n\t\t\treturn number();\n\t\t}\n\t}\n\tprivate int number() {\n\t\tint num = 0;\n\t\twhile(begin<expression.length()) {\n\t\t\tif (Character.isDigit(expression.charAt(begin))) {\n\t\t\t\tnum*=10;\n\t\t\t\tnum+=expression.charAt(begin)-'0';\n\t\t\t\tbegin++;\n\t\t\t}else{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn num;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.util.regex.*;\n\nclass Main{\n\tprivate final static Pattern addsubmuldiv = Pattern.compile(\"^(-?\\\\d+)([+Z*/])(-?\\\\d+)(.*)$\");\n\tprivate final static Pattern addsub = Pattern.compile(\"^(-?\\\\d+)([+Z])(-?\\\\d+)(.*)$\");\n\tprivate final static Pattern muldiv = Pattern.compile(\"^(-?\\\\d+)([*/])(-?\\\\d+)(.*)$\");\n\n\tprivate static String process(String s){\n\t\tMatcher m=muldiv.matcher(s);\n\t\twhile(m.find()){\n\t\t\tif(m.group(2).equals(\"*\"))\n\t\t\t\ts=(Integer.parseInt(m.group(1))*Integer.parseInt(m.group(3)))+m.group(4);\n\t\t\telse\n\t\t\t\ts=(Integer.parseInt(m.group(1))/Integer.parseInt(m.group(3)))+m.group(4);\n\t\t\tm=muldiv.matcher(s);\n\t\t}\n\n\t\tm=addsub.matcher(s);\n\t\twhile(m.find()){\n\t\t\tif(m.group(2).equals(\"+\"))\n\t\t\t\ts=(Integer.parseInt(m.group(1))+Integer.parseInt(m.group(3)))+m.group(4);\n\t\t\telse\n\t\t\t\ts=(Integer.parseInt(m.group(1))-Integer.parseInt(m.group(3)))+m.group(4);\n\t\t\tm=addsub.matcher(s);\n\t\t}\n\t\treturn s;\n\t}\n\n\tprivate static String process2(String s){\n\t\tMatcher m=addsubmuldiv.matcher(s);\n\t\twhile(m.find()){\n\t\t\tif(m.group(2).equals(\"*\"))\n\t\t\t\ts=(Integer.parseInt(m.group(1))*Integer.parseInt(m.group(3)))+m.group(4);\n\t\t\telse if(m.group(2).equals(\"/\"))\n\t\t\t\ts=(Integer.parseInt(m.group(1))/Integer.parseInt(m.group(3)))+m.group(4);\n\t\t\telse if(m.group(2).equals(\"+\"))\n\t\t\t\ts=(Integer.parseInt(m.group(1))+Integer.parseInt(m.group(3)))+m.group(4);\n\t\t\telse\n\t\t\t\ts=(Integer.parseInt(m.group(1))-Integer.parseInt(m.group(3)))+m.group(4);\n\t\t\tm=addsubmuldiv.matcher(s);\n\t\t}\n\t\treturn s;\n\t}\n\n\tpublic static void main(String[]z){\n\t\tScanner x=new Scanner(System.in);\n\t\tfor(;x.hasNext();){\n\t\t\tString s=x.next().replaceAll(\"-\",\"Z\");\n\t\t\tString ans=x.next();\n\t\t\tboolean a=process(s).equals(ans);\n\t\t\tboolean b=process2(s).equals(ans);\n\t\t\tif(a&&b)System.out.println(\"U\");\n\t\t\tif(a&&!b)System.out.println(\"M\");\n\t\t\tif(!a&&b)System.out.println(\"L\");\n\t\t\tif(!a&&!b)System.out.println(\"I\");\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\npublic class Main {\n\tScanner in = new Scanner(System.in);\n\tpublic static void main(String[] args) {\n\t\tnew Main();\n\t}\n\n\tpublic Main(){\n\t\tnew B().doIt();\n\t}\n\t\n\t\n\tclass B{\n\t\tchar[] line;\n\t\tint pos;\n\n\t\tint exp(){\n\t\t\tint r = term();\n\t\t\twhile(true){\n\t\t\t\tchar c = line[pos++];\n\t\t\t\tif(c=='+')r+=term();\n\t\t\t\telse if(c=='-')r-=term();\n\t\t\t\telse break;\n\t\t\t}\n\t\t\treturn r;\n\t\t}\n\n\t\tint term(){\n\t\t\tint r = fact();\n\t\t\twhile(true){\n\t\t\t\tchar c = line[pos++];\n\t\t\t\tif(c=='*') r*=fact();\n\t\t\t\telse if(c=='/')r/=fact();\n\t\t\t\telse break;\n\t\t\t}\n\t\t\tpos--;\n\t\t\treturn r;\n\t\t}\n\n\t\tint fact(){\n\t\t\tchar c = line[pos++];\n\t\t\tif(c=='(')return exp();\n\t\t\tif(c=='-')return -fact();\n\t\t\tif(c=='+')return fact();\n\t\t\tint x = c-'0';\n\t\t\twhile(true){\n\t\t\t\tc = line[pos++];\n\t\t\t\tif(Character.isDigit(c)){\n\t\t\t\t\tx *= 10;\n\t\t\t\t\tx += c-'0';\n\t\t\t\t}\n\t\t\t\telse break;\n\t\t\t}\n\t\t\tpos--;\n\t\t\treturn x;\n\t\t}\n\t\t\n\t\tint left_to_right(){\n//\t\t\tSystem.out.println(Arrays.toString(line));\n\t\t\tint result = Integer.parseInt(line[0]+\"\");\n\t\t\tfor(int i=1;i<line.length-1;i+=2){\n\t\t\t\tif(line[i]=='+'){\n\t\t\t\t\tresult += Integer.parseInt(line[i+1]+\"\");\n\t\t\t\t}else{\n\t\t\t\t\tresult *= Integer.parseInt(line[i+1]+\"\");\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t\t\n\t\tvoid doIt(){\n\t\t\tline = (in.next()+\"=\").toCharArray();\n\t\t\tpos = 0;\n\t\t\tint a = exp();\n\t\t\tint b = left_to_right();\n\t\t\tint c = in.nextInt();\n\t\t\tif(a == b&&a == c)System.out.println(\"U\");\n\t\t\telse if(a == c)System.out.println(\"M\");\n\t\t\telse if(b==c)System.out.println(\"L\");\n\t\t\telse System.out.println(\"I\");\n\t\t}\n\t}\n\t\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.*;\n\nimport static java.lang.Integer.parseInt;\n\n/**\n * Miscalculation\n */\npublic class Main {\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line;\n\t\tString[] words;\n\n\t\tString exp = br.readLine();\n\t\tint ans = parseInt(br.readLine());\n\n\t\tint M, L;\n\t\tM = M(exp);\n\t\tL = L(exp);\n\t\tif (ans == M) {\n\t\t\tSystem.out.println('M');\n\t\t} else if (ans == L) {\n\t\t\tSystem.out.println('L');\n\t\t} else if (ans == M && ans == L) {\n\t\t\tSystem.out.println('U');\n\t\t} else {\n\t\t\tSystem.out.println('I');\n\t\t}\n\t}\n\n\tstatic int M(String exp) {\n\t\tchar[] pri = new char[127];\n\t\tfor (int i = '0'; i <= '9'; i++) pri[i] = 3;\n\t\tpri['*'] = 2;\n\t\tpri['+'] = 1;\n\t\tpri[0] = 0;\n\t\treturn calc(exp, pri);\n\t}\n\n\tstatic int L(String exp) {\n\t\tchar[] pri = new char[127];\n\t\tfor (int i = '0'; i <= '9'; i++) pri[i] = 3;\n\t\tpri['*'] = 1;\n\t\tpri['+'] = 1;\n\t\tpri[0] = 0;\n\t\treturn calc(exp, pri);\n\t}\n\n\tstatic int calc(String exp, char[] pri) {\n\t\tDeque<Character> stack = new ArrayDeque<>();\n\t\tDeque<Character> queue = new ArrayDeque<>();\n\n\t\tstack.push('\\0');\n\t\tfor (char c : exp.toCharArray()) {\n\t\t\tif (pri[c] > pri[stack.peek()]) {\n\t\t\t\tstack.push(c);\n\t\t\t} else {\n\t\t\t\twhile (pri[c] <= pri[stack.peek()]) {\n\t\t\t\t\tqueue.offer(stack.pop());\n\t\t\t\t}\n\t\t\t\tstack.push(c);\n\t\t\t}\n\t\t}\n\t\twhile (stack.peek() != '\\0') queue.offer(stack.pop());\n\n\t\t//\n\t\tString rpn = \"\";\n\t\tDeque<Integer> ans = new ArrayDeque<>();\n\n\t\tfor (char c : queue) rpn += String.valueOf(c);\n\t\tfor (char c : rpn.toCharArray()) {\n\t\t\tint a, b;\n\t\t\tswitch (c) {\n\t\t\t\tcase '*':\n\t\t\t\t\tb = ans.pop();\n\t\t\t\t\ta = ans.pop();\n\t\t\t\t\tans.push(a * b);\n\t\t\t\t\tbreak;\n\t\t\t\tcase '+':\n\t\t\t\t\tb = ans.pop();\n\t\t\t\t\ta = ans.pop();\n\t\t\t\t\tans.push(a + b);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tans.push(c - '0');\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn ans.peek();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.*;\nimport java.io.*;\n\nimport static java.util.Arrays.*;\nimport static java.util.Collections.*;\nimport static java.lang.Math.*;\n\npublic class Main {\n\n\tint INF = 1 << 28;\n\t//long INF = 1L << 62;\n\tdouble EPS = 1e-10;\n\n\tvoid run() {\n\t\tSystem.out.println(solve());\n\t}\n\t\n\tString solve() {\n\t\tScanner sc = new Scanner(System.in);\n\t\ts = sc.next() + \"=\"; long ans = sc.nextLong();\n\t\tlong a = add();\n//\t\tdebug(a);\n\t\tp = 0;\n\t\tlong b = num();\n\t\tchar c = next();\n\t\twhile (c != '=') {\n\t\t\tlong d = num();\n\t\t\tif (c == '*') b *= d;\n\t\t\telse b += d;\n\t\t\tc = next();\n\t\t}\n\t\tif (a == ans && b == ans) return \"U\";\n\t\tif (a == ans) return \"M\";\n\t\tif (b == ans) return \"L\";\n\t\treturn \"I\";\n\t}\n\t\n\tString s; int p;\n\tchar next() {\n\t\treturn s.charAt(p++);\n\t}\n\t\n\tlong add() {\n\t\tlong a = mlt();\n\t\tchar c = next();\n\t\twhile (c == '+') {\n\t\t\tlong b = mlt();\n\t\t\ta += b;\n\t\t\tc = next();\n\t\t}\n\t\tp--;\n\t\treturn a;\n\t}\n\t\n\tlong mlt() {\n\t\tlong a = num();\n\t\tchar c = next();\n\t\twhile(c == '*') {\n\t\t\tlong b = num();\n\t\t\ta *= b;\n\t\t\tc = next();\n\t\t}\n\t\tp--;\n\t\treturn a;\n\t}\n\t\n\tlong num(){\n\t\treturn next() - '0';\n\t}\n\tvoid debug(Object... os) {\n\t\tSystem.err.println(Arrays.deepToString(os));\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Scanner;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner s = new Scanner(System.in);\n\t\tString expr = s.nextLine();\n\t\tlong answer = Long.parseLong(s.nextLine());\n\t\tlong bobs = bobsAnswer(expr);\n\t\tlong calc = calculate(expr);\n\t\tif (bobs == answer) {\n\t\t\tSystem.out.println(bobs == calc ? \"U\" : \"L\");\n\t\t} else {\n\t\t\tSystem.out.println(calc == answer ? \"M\" : \"I\");\n\t\t}\n\t}\n\n\tprivate static long calculate(String expr) {\n\t\tArrayList<String> tokens = lex(expr);\n\t\twhile(tokens.size() > 1) {\n\t\t\tboolean hasAst = false;\n\t\t\tfor(int i = 0; i < tokens.size(); i++) {\n\t\t\t\tif (tokens.get(i).equals(\"*\")) {\n\t\t\t\t\tlong v = Long.parseLong(tokens.get(i-1)) * Long.parseLong(tokens.get(i+1));\n\t\t\t\t\ttokens.set(i, String.valueOf(v));\n\t\t\t\t\ttokens.remove(i+1);\n\t\t\t\t\ttokens.remove(i-1);\n\t\t\t\t\thasAst = true;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (hasAst) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlong total = 0L;\n\t\t\tfor(String token : tokens) {\n\t\t\t\tif (\"+\".equals(token)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\ttotal += Long.parseLong(token);\n\t\t\t}\n\t\t\treturn total;\n\t\t}\n\t\treturn Long.parseLong(tokens.get(0));\n\t}\n\n\tprivate static ArrayList<String> lex(String expr) {\n\t\tArrayList<String> tokens = new ArrayList<String>();\n\t\tString[] nums = expr.split(\"\\\\+|\\\\*\");\n\t\tString[] symbol = expr.split(\"[0-9]+\");\n\t\tfor(int i = 1; i < symbol.length; i++) {\n\t\t\ttokens.add(nums[i-1]);\n\t\t\ttokens.add(symbol[i]);\n\t\t}\n\t\ttokens.add(nums[nums.length-1]);\n\t\treturn tokens;\n\t}\n\n\tprivate static long bobsAnswer(String expr) {\n\t\tArrayList<String> tokens = lex(expr);\n\t\tif (tokens.size() <= 1) {\n\t\t\treturn Long.parseLong(tokens.get(0));\n\t\t}\n\t\tlong total = Long.parseLong(tokens.get(0));\n\t\tfor(int i = 1; i < tokens.size(); i+=2) {\n\t\t\tlong next = Long.parseLong(tokens.get(i+1));\n\t\t\tif (\"+\".equals(tokens.get(i))) {\n\t\t\t\ttotal += next;\t\n\t\t\t} else {\n\t\t\t\ttotal *= next;\n\t\t\t}\n\t\t}\n\t\treturn total;\n\t}\n\t\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.*;\n\nimport static java.lang.Integer.parseInt;\n\n/**\n * Miscalculation\n */\npublic class Main {\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line;\n\t\tString[] words;\n\n\t\tString exp = br.readLine();\n\t\tint ans = parseInt(br.readLine());\n\n\t\tint M, L;\n\t\tM = M(exp);\n\t\tL = L(exp);\n\t\tif (ans == M && ans == L) {\n\t\t\tSystem.out.println('U');\n\t\t} else if (ans == M) {\n\t\t\tSystem.out.println('M');\n\t\t} else if (ans == L) {\n\t\t\tSystem.out.println('L');\n\t\t} else {\n\t\t\tSystem.out.println('I');\n\t\t}\n\t}\n\n\tstatic int M(String exp) {\n\t\tchar[] pri = new char[127];\n\t\tArrays.fill(pri, (char) 3);\n\t\tpri['*'] = 2;\n\t\tpri['+'] = 1;\n\t\tpri[0] = 0;\n\t\treturn calc(exp, pri);\n\t}\n\n\tstatic int L(String exp) {\n\t\tchar[] pri = new char[127];\n\t\tArrays.fill(pri, (char) 3);\n\t\tpri['*'] = 1;\n\t\tpri['+'] = 1;\n\t\tpri[0] = 0;\n\t\treturn calc(exp, pri);\n\t}\n\n\tstatic int calc(String exp, char[] pri) {\n\t\tDeque<Character> stack = new ArrayDeque<>();\n\t\tDeque<Character> queue = new ArrayDeque<>();\n\n\t\tstack.push('\\0');\n\t\tfor (char c : exp.toCharArray()) {\n\t\t\tif (pri[c] > pri[stack.peek()]) {\n\t\t\t\tstack.push(c);\n\t\t\t} else {\n\t\t\t\twhile (pri[c] <= pri[stack.peek()]) {\n\t\t\t\t\tqueue.offer(stack.pop());\n\t\t\t\t}\n\t\t\t\tstack.push(c);\n\t\t\t}\n\t\t}\n\t\twhile (stack.peek() != '\\0') queue.offer(stack.pop());\n\n\t\t//\n\t\tString rpn = \"\";\n\t\tDeque<Integer> ans = new ArrayDeque<>();\n\n\t\tfor (char c : queue) rpn += String.valueOf(c);\n\t\tfor (char c : rpn.toCharArray()) {\n\t\t\tint a, b;\n\t\t\tswitch (c) {\n\t\t\t\tcase '*':\n\t\t\t\t\tb = ans.pop();\n\t\t\t\t\ta = ans.pop();\n\t\t\t\t\tans.push(a * b);\n\t\t\t\t\tbreak;\n\t\t\t\tcase '+':\n\t\t\t\t\tb = ans.pop();\n\t\t\t\t\ta = ans.pop();\n\t\t\t\t\tans.push(a + b);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tans.push(c - '0');\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn ans.peek();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.*;\n\nimport static java.lang.Integer.parseInt;\n\n/**\n * Miscalculation\n */\npublic class Main {\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line;\n\t\tString[] words;\n\n\t\tString exp = br.readLine();\n\t\tint ans = parseInt(br.readLine());\n\n\t\tint M, L;\n\t\tM = M(exp);\n\t\tL = L(exp);\n\t\tif (ans == M && ans == L) {\n\t\t\tSystem.out.println('U');\n\t\t} else if (ans == M) {\n\t\t\tSystem.out.println('M');\n\t\t} else if (ans == L) {\n\t\t\tSystem.out.println('L');\n\t\t} else {\n\t\t\tSystem.out.println('I');\n\t\t}\n\t}\n\n\tstatic int M(String exp) {\n\t\tchar[] pri = new char[127];\n\t\tfor (int i = '0'; i <= '9'; i++) pri[i] = 3;\n\t\tpri['*'] = 2;\n\t\tpri['+'] = 1;\n\t\tpri[0] = 0;\n\t\treturn calc(exp, pri);\n\t}\n\n\tstatic int L(String exp) {\n\t\tchar[] pri = new char[127];\n\t\tfor (int i = '0'; i <= '9'; i++) pri[i] = 3;\n\t\tpri['*'] = 1;\n\t\tpri['+'] = 1;\n\t\tpri[0] = 0;\n\t\treturn calc(exp, pri);\n\t}\n\n\tstatic int calc(String exp, char[] pri) {\n\t\tDeque<Character> stack = new ArrayDeque<>();\n\t\tDeque<Character> queue = new ArrayDeque<>();\n\n\t\tstack.push('\\0');\n\t\tfor (char c : exp.toCharArray()) {\n\t\t\tif (pri[c] > pri[stack.peek()]) {\n\t\t\t\tstack.push(c);\n\t\t\t} else {\n\t\t\t\twhile (pri[c] <= pri[stack.peek()]) {\n\t\t\t\t\tqueue.offer(stack.pop());\n\t\t\t\t}\n\t\t\t\tstack.push(c);\n\t\t\t}\n\t\t}\n\t\twhile (stack.peek() != '\\0') queue.offer(stack.pop());\n\n\t\t//\n\t\tString rpn = \"\";\n\t\tDeque<Integer> ans = new ArrayDeque<>();\n\n\t\tfor (char c : queue) rpn += String.valueOf(c);\n\t\tfor (char c : rpn.toCharArray()) {\n\t\t\tint a, b;\n\t\t\tswitch (c) {\n\t\t\t\tcase '*':\n\t\t\t\t\tb = ans.pop();\n\t\t\t\t\ta = ans.pop();\n\t\t\t\t\tans.push(a * b);\n\t\t\t\t\tbreak;\n\t\t\t\tcase '+':\n\t\t\t\t\tb = ans.pop();\n\t\t\t\t\ta = ans.pop();\n\t\t\t\t\tans.push(a + b);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tans.push(c - '0');\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn ans.peek();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Scanner;\npublic class Main {\n\n\tpublic static void main(String[] args) {\n\t\tScanner stdIn = new Scanner(System.in);\n\t\tString in = stdIn.nextLine();\n\t\tint ix = stdIn.nextInt();\n\t\tString inC = in.substring(0);\n\t\tboolean c1 = check1(inC,ix);\n\t\tboolean c2 = check2(in,ix);\n\t\t\n\t\tif(c1 && c2) {\n\t\t\tSystem.out.println(\"U\");\n\t\t}\n\t\telse if(c1) {\n\t\t\tSystem.out.println(\"M\");\n\t\t}\n\t\telse if(c2) {\n\t\t\tSystem.out.println(\"L\");\n\t\t}\n\t\telse {\n\t\t\tSystem.out.println(\"I\");\n\t\t}\n\t}\n\tstatic boolean check1(String a, int b) {\n\t\tint id = 0;\n\t\tfor(int i = 0; i < a.length(); i++) {\n\t\t\t\n\t\t\t\n\t\t\tif(a.charAt(i) == '+') {\n\t\t\t\tid = i+1;\n\t\t\t}\n\t\t\tif(a.charAt(i) == '*') {\n\t\t\t\tint o1 = Integer.parseInt(a.substring(id, i));\n\t\t\t\tint id2 = 0;\n\t\t\t\tfor(int j = i+1; j < a.length(); j++) {\n\t\t\t\t\tif(a.charAt(j) == '+' || a.charAt(j) == '*' ) {\n\t\t\t\t\t\tid2 = j;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(j == a.length()-1) {\n\t\t\t\t\t\tid2 = j+1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tint o2 = Integer.parseInt(a.substring(i+1,id2));\n\t\t\t\tString tmp = a.substring(0,id);\n\t\t\t\ttmp += (o1 * o2);\n\t\t\t\ttmp += a.substring(id2,a.length());\n\t\t\t\ta = tmp;\n\t\t\t\ti = -1;\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0; i < a.length(); i++) {\n\n\t\t\tif(a.charAt(i) == '+') {\n\t\t\t\tint o1 = Integer.parseInt(a.substring(0,i));\n\t\t\t\tfor(int j = i+1; j < a.length(); j++) {\n\t\t\t\t\t\n\t\t\t\t\tif(a.charAt(j) == '+') {\n\t\t\t\t\t\tint o2 = Integer.parseInt(a.substring(i+1,j));\n\t\t\t\t\t\to1 += o2;\n\t\t\t\t\t\tString tmp = String.valueOf(o1);\n\t\t\t\t\t\ttmp += a.substring(j,a.length());\n\t\t\t\t\t\ta = tmp;\n\t\t\t\t\t\ti = -1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(j == a.length()-1) {\n\t\t\t\t\t\tint o2 = Integer.parseInt(a.substring(i+1,j+1));\n\t\t\t\t\t\to1 += o2;\n\t\t\t\t\t\tString tmp = String.valueOf(o1);\n\t\t\t\t\t\ttmp += a.substring(j+1,a.length());\n\t\t\t\t\t\ta = tmp;\n\t\t\t\t\t\ti = -1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(Integer.parseInt(a) == b) return true;\n\t\treturn false;\n\t\t\n\t}\n\tstatic boolean check2(String a, int b) {\n\t\tfor(int i = 0; i < a.length(); i++) {\n\t\t\tif(a.charAt(i) == '*' || a.charAt(i) == '+') {\n\t\t\t\tboolean x = false;\n\t\t\t\tif(a.charAt(i) == '*') {\n\t\t\t\t\tx = true;\n\t\t\t\t}\n\t\t\t\tint o1 = Integer.parseInt(a.substring(0, i));\n\t\t\t\tfor(int j = i+1; j < a.length(); j++) {\n\t\t\t\t\tif(a.charAt(j) == '*' || a.charAt(j) == '+') {\n\t\t\t\t\t\tint o2 = Integer.parseInt(a.substring(i+1,j));\n\t\t\t\t\t\tif(x) {\n\t\t\t\t\t\t\tString tmp = String.valueOf((o1 * o2)) + a.substring(j);\n\t\t\t\t\t\t\ta = tmp;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tString tmp = String.valueOf((o1 + o2)) + a.substring(j);\n\t\t\t\t\t\t\ta = tmp;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ti = -1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(j == a.length()-1) {\n\t\t\t\t\t\tint o2 = Integer.parseInt(a.substring(i+1,j+1));\n\t\t\t\t\t\tif(x) {\n\t\t\t\t\t\t\tString tmp = String.valueOf((o1 * o2)) + a.substring(j+1);\n\t\t\t\t\t\t\ta = tmp;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tString tmp = String.valueOf((o1 + o2)) + a.substring(j+1);\n\t\t\t\t\t\t\ta = tmp;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ti = -1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(Integer.parseInt(a) == b) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\n\tint parseNumber(String exp) {\n\t\tint res = 0;\n\t\twhile (exp.length() > idx) {\n\t\t\tchar c = exp.charAt(idx);\n\t\t\tif (c == '+' || c == '*') break;\n\t\t\t\n\t\t\tres = res * 10 + c - '0';\n\t\t\tidx++;\n\t\t}\n\t\treturn res;\n\t}\n\t\n\tint idx = 0;\n\tint calcLeftToRight(String exp) {\n\t\tidx = 0;\n\t\tint num1 = 0, num2 = 0;\n\t\twhile (exp.length() > idx) {\n\t\t\tchar c = exp.charAt(idx);\n\t\t\tidx++;\n\t\t\tif ('0' <= c && c <= '9') {\n\t\t\t\tnum1 = num1 * 10 + c - '0';\n\t\t\t} else if (c == '+') {\n\t\t\t\tnum2 = parseNumber(exp);\n\t\t\t\tnum1 += num2;\n\t\t\t} else {\n\t\t\t\tnum2 = parseNumber(exp);\n\t\t\t\tnum1 *= num2;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn num1;\n\t}\n\t\n\tint calcCorrectly(String exp) {\n\t\tString after = \"\";\n\t\tidx = 0;\n\t\tint num1 = 0, num2 = 0;\n\t\twhile (exp.length() > idx) {\n\t\t\tchar c = exp.charAt(idx);\n\t\t\tidx++;\n\t\t\tif ('0' <= c && c <= '9') {\n\t\t\t\tnum1 = num1 * 10 + c - '0';\n\t\t\t} else if (c == '+') {\n\t\t\t\tafter += num1 + \"+\";\n\t\t\t\tnum1 = parseNumber(exp);\n\t\t\t} else {\n\t\t\t\tnum2 = parseNumber(exp);\n\t\t\t\tnum1 *= num2;\n\t\t\t}\n\t\t}\n\t\tafter += num1;\n\t\treturn calcLeftToRight(after);\n\t}\n\t\n\tpublic void run() {\n\t\tString exp = in.next();\n\t\tint val = in.nextInt();\n\t\t\n\t\tint ltor = calcLeftToRight(exp);\n\t\tint correct = calcCorrectly(exp);\n\t\t\n\t\tif (ltor == val) {\n\t\t\tif (correct == val)\n\t\t\t\tSystem.out.println(\"U\");\n\t\t\telse \n\t\t\t\tSystem.out.println(\"L\");\n\t\t} else {\n\t\t\tif (correct == val)\n\t\t\t\tSystem.out.println(\"M\");\n\t\t\telse\n\t\t\t\tSystem.out.println(\"I\");\n\t\t}\n\t\t\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Scanner;\n\npublic class Main {\n\tstatic Scanner sc = new Scanner(System.in);\n\tstatic long MOD = 1000000007;\n\tstatic char[] exp;\n\n\tpublic static void main(String[] args) {\n\t\texp = sc.next().toCharArray();\n\t\tint v = sc.nextInt();\n\t\tint r1 = calc1();\n\t\tint r2 = calc2();\n\t\tif (v == r1) {\n\t\t\tSystem.out.println(v == r2 ? 'U' : 'M');\n\t\t} else {\n\t\t\tSystem.out.println(v == r2 ? 'L' : 'I');\n\t\t}\n\t}\n\n\tstatic int calc1() {\n\t\tArrayList<Integer> stack = new ArrayList<Integer>();\n\t\tstack.add(exp[0] - '0');\n\t\tfor (int i = 1; i < exp.length; i += 2) {\n\t\t\tif (exp[i] == '+') {\n\t\t\t\tstack.add(exp[i + 1] - '0');\n\t\t\t} else {\n\t\t\t\tstack.set(stack.size() - 1, stack.get(stack.size() - 1) * (exp[i + 1] - '0'));\n\t\t\t}\n\t\t}\n\t\tint ret = 0;\n\t\tfor (int v : stack) {\n\t\t\tret += v;\n\t\t}\n\t\treturn ret;\n\t}\n\n\tstatic int calc2() {\n\t\tint v = exp[0] - '0';\n\t\tfor (int i = 1; i < exp.length; i += 2) {\n\t\t\tif (exp[i] == '+') {\n\t\t\t\tv += exp[i + 1] - '0';\n\t\t\t} else {\n\t\t\t\tv *= exp[i + 1] - '0';\n\t\t\t}\n\t\t}\n\t\treturn v;\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.*;\nimport java.util.regex.Matcher;\nimport java.util.regex.Pattern;\nimport java.lang.ArrayIndexOutOfBoundsException;\nimport java.math.BigInteger;\n\nimport javax.script.AbstractScriptEngine;\n\n\n/**\n * @author yoshikyoto\n */\nclass Main extends MyUtil{\n\t// public static Graph g;\n\tpublic static void main(String[] args) throws Exception{\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tExpr e = new Expr(br.readLine());\n\t\tint a = Integer.parseInt(br.readLine());\n\t\tif(e.m == e.l && e.m == a){\n\t\t\tSystem.out.println(\"U\");\n\t\t}else if(e.m == a){\n\t\t\tSystem.out.println(\"M\");\n\t\t}else if(e.l == a){\n\t\t\tSystem.out.println(\"L\");\n\t\t}else{\n\t\t\tSystem.out.println(\"I\");\n\t\t}\n\t}\n}\n\n\nclass Expr{\n\tString toString;\n\tchar[] expr;\n\tint m, l;\n\tExpr(String str){\n\t\ttoString = str;\n\t\texpr = str.toCharArray();\n\t\t\n\t\tm = multFirst(expr, 0, expr.length - 1);\n\t\tl = rightToLeft(expr);\n\t}\n\t\n\t/**\n\t * 左から右に計算していく\n\t */\n\tint rightToLeft(char[] expr){\n\t\tint ans = toInt(expr[0]);\n\t\tfor(int i = 1; i < expr.length; i += 2){\n\t\t\tswitch(expr[i]){\n\t\t\tcase '+':\n\t\t\t\tans += toInt(expr[i+1]);\n\t\t\t\tbreak;\n\t\t\tcase '*':\n\t\t\t\tans *= toInt(expr[i+1]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn ans;\n\t}\n\t\n\tint multFirst(char[] expr, int left, int right){\n\t\tif(left == right){\n\t\t\treturn toInt(expr[left]);\n\t\t}\n\t\t\n\t\t// 足し算\n\t\tfor(int i = left+1; i <= right; i += 2){\n\t\t\tif(expr[i] == '+'){\n\t\t\t\treturn multFirst(expr, left, i-1) + multFirst(expr, i+1, right);\n\t\t\t}\n\t\t}\n\t\t\n\t\t// 足し算がなかったら掛け算を探す\n\t\tfor(int i = left+1; i <= right; i += 2){\n\t\t\tif(expr[i] == '*'){\n\t\t\t\treturn multFirst(expr, left, i-1) * multFirst(expr, i+1, right);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn 0;\n\t}\n\t\n\tint toInt(char c){\n\t\treturn c - '0';\n\t}\n\t\n}\n\n\n// --- ここから下はライブラリ ----------\n \nclass ArrayComp implements Comparator<int[]>{\n\tpublic int compare(int[] a, int[] b){\n\t\tint l = Math.min(a.length, b.length);\n\t\tfor(int i = 0; i < l; i++){\n\t\t\tif(a[i] == b[i]) continue;\n\t\t\treturn a[i] - b[i];\n\t\t}\n\t\treturn 0;\n\t}\n}\n \nclass Node extends ArrayList<Edge>{\n\tint index, depth = -1, dist = -1;\n\tNode(int index){this.index = index;}\n\tNode parent;\n\tboolean visited = false;\n}\nclass Edge{\n\tint from, to, cost;\n\tEdge(int from, int to, int cost){\n\t\tthis.from = from;\n\t\tthis.to = to;\n\t\tthis.cost = cost;\n\t}\n}\nclass NodeComparator implements Comparator<Node>{\n\tpublic int compare(Node a, Node b){\n\t\treturn a.dist - b.dist;\n\t}\n}\n \nclass Graph{\n\tNode n[];\n\tGraph(int node_count){\n\t\tn = new Node[node_count];\n\t\tfor(int i = 0; i < node_count; i++) n[i] = new Node(i);\n\t}\n\tpublic void add(Edge e){\n\t\tn[e.from].add(e);\n\t}\n\tpublic Node get(int i){return n[i];}\n\tpublic Node lca(int a, int b){\n\t\t// 浅い方をaとする\n\t\tNode nodeA, nodeB;\n\t\tif(n[a].depth < n[b].depth){\n\t\t\tnodeA = n[a];\n\t\t\tnodeB = n[b];\n\t\t}else{\n\t\t\tnodeA = n[b];\n\t\t\tnodeB = n[a];\n\t\t}\n\t\t// 同じ深さまで親をたどる\n\t\tint diff = nodeB.depth - nodeA.depth;\n\t\tfor(int k = 0; k < diff; k++){\n\t\t\tnodeB = nodeB.parent;\n\t\t}\n\t\t// 共通祖先を見つける\n\t\twhile(nodeA != nodeB){\n\t\t\tnodeA = nodeA.parent;\n\t\t\tnodeB = nodeB.parent;\n\t\t}\n\t\treturn nodeA;\n\t}\n\tpublic void calcDepth(int root){\n\t\tArrayDeque<Integer> que = new ArrayDeque<Integer>();\n\t\tque.push(root);\n\t\tn[root].depth = 0;\n \n\t\twhile(que.size() > 0){\n\t\t\tint curr = que.pop();\n\t\t\tNode curr_node = n[curr];\n\t\t\tfor(Edge e : curr_node){\n\t\t\t\tint next = e.to;\n\t\t\t\tNode next_node = n[next];\n\t\t\t\tif(next_node.depth == -1){\n\t\t\t\t\tnext_node.depth = curr_node.depth + 1;\n\t\t\t\t\tnext_node.parent = curr_node;\n\t\t\t\t\tque.push(next);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n \n\tpublic int[] dijkstra(int s){\n\t\tPriorityQueue<Node> q = new PriorityQueue<Node>(n.length, new NodeComparator());\n\t\tNode start_node = new Node(s);\n\t\tstart_node.dist = 0;\n\t\tq.add(start_node);\n\t\tint[] dist = new int[n.length];\n\t\tfor (int i = 0; i < dist.length; i++)  dist[i] = -1;\n\t\tdist[s] = 0;\n \n\t\twhile(q.size() > 0){\n\t\t\tNode currNode = q.poll();\n\t\t\tif(dist[currNode.index] < currNode.dist) continue;\n\t\t\tfor(Edge e : n[currNode.index]){\n\t\t\t\tNode nextNode = new Node(e.to);\n\t\t\t\tnextNode.dist = currNode.dist + e.cost;\n\t\t\t\tif(dist[e.to] == -1 || dist[e.to] > nextNode.dist){\n\t\t\t\t\tdist[e.to] = nextNode.dist;\n\t\t\t\t\tq.add(nextNode);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn dist;\n\t}\n}\n \n \n \nclass Regex{\n\tPattern p; Matcher m; String str;\n\tRegex(String regex_str){p = Pattern.compile(regex_str);}\n\tvoid setStr(String str){m = p.matcher(str);}\n\tboolean find(){return m.find();}\n\tString group(int i){return m.group(i);}\n\tString group(){return m.group();}\n}\n \n/**\n * UnionFindTree \n * @author yoshikyoto\n */\nclass UnionFindTree{\n\tpublic int[] parent, rank;\n\tpublic int n;\n\tpublic int count;\n\t// 初期化\n\tUnionFindTree(int n){\n\t\tthis.n = n;\n\t\tcount = n;\n\t\tparent = new int[n];\n\t\trank = new int[n];\n\t\tfor(int i = 0; i < n; i++){\n\t\t\tparent[i] = i;\n\t\t\trank[i] = 0;\n\t\t}\n\t}\n\t// 根を求める\n\tint find(int x){\n\t\tif(parent[x] == x){\n\t\t\treturn x;\n\t\t}else{\n\t\t\treturn parent[x] = find(parent[x]);\n\t\t}\n\t}\n\t// xとyの集合を結合\n\tvoid unite(int x, int y){\n\t\tx = find(x);\n\t\ty = find(y);\n\t\tif(x == y){\n\t\t\treturn;\n\t\t}\n\t\tif(rank[x] < rank[y]){\n\t\t\tparent[x] = y;\n\t\t\tcount--;\n\t\t}else{\n\t\t\tparent[y] = x;\n\t\t\tif(rank[x] == rank[y]) rank[x]++;\n\t\t\tcount--;\n\t\t}\n\t}\n\t// xとyが同じ集合か\n\tboolean same(int x, int y){\n\t\treturn find(x) == find(y);\n\t}\n};\n \n \n\n \nclass CountHashMap<E> extends HashMap<E, Integer>{\n\tArrayList<E> keyArray = new ArrayList<E>();\n\tpublic void add(E key){add(key, 1);}\n\tpublic void add(E key, Integer value){\n\t\tif(containsKey(key)){value += get(key);\n\t\t}else{keyArray.add(key);}\n\t\tput(key, value);\n\t}\n}\n \n/**\n * MyUtil\n * @author yoshikyoto\n */\nclass MyUtil extends MyIO{\n\tpublic static Random rand = new Random();\n\tpublic static int digit(int n){return String.valueOf(n).length();}\n\tpublic static String reverse(String s){return (new StringBuffer(s)).reverse().toString();}\n\tpublic static void dsort(int[] a){\n\t\tArrays.sort(a);\n\t\tint l = a.length;\n\t\tfor(int i = 0; i < l/2; i++){\n\t\t\tint tmp = a[i]; a[i] = a[l-1-i]; a[l-1-i] = tmp;\n\t\t}\n\t}\n\tpublic static void sleep(int t){try{Thread.sleep(t);}catch(Exception e){}}\n\tpublic static int sum(int[] a){int s = 0; for(int i = 0; i < a.length; i++)s+=a[i]; return s;}\n\tpublic static int[] cp(int[] a){\n\t\tint[] b = new int[a.length];\n\t\tfor(int i = 0; i < a.length; i++) b[i] = a[i];\n\t\treturn b;\n\t}\n\tpublic static int randomInt(int min, int max){return min + rand.nextInt(max - min + 1);}\n\tstatic boolean inside(int y, int x, int h, int w){return 0 <= y && y <= (h-1) && 0 <= x && x <= (w-1);};\n\tpublic static boolean isUpper(char c){return 'A'<=c&&c<='Z';}\n\tpublic static boolean isLower(char c){return 'a'<=c&&c<='z';}\n\tpublic static char toUpper(char c){\n\t\tif(isLower(c)) return (char)(c - 'a' + 'A');\n\t\treturn c;\n\t}\n\tpublic static char toLower(char c){\n\t\tif(isUpper(c)) return (char)(c - 'A' + 'a');\n\t\treturn c;\n\t}\n\tpublic static int[] swap(int[] arr, int i, int j){\n\t\tint[] ret = cp(arr);\n\t\tint tmp = ret[i];\n\t\tret[i] = ret[j];\n\t\tret[j] = tmp;\n\t\treturn ret;\n\t}\n\tpublic static int toInt(boolean[] a){\n\t\tint pow = 1, ret = 0, l = a.length;\n\t\tfor(int i = 0; i < l; i++){\n\t\t\tif(a[i]) ret += pow;\n\t\t\tpow *= 2;\n\t\t}\n\t\treturn ret;\n\t}\n}\n \n/**\n * MyIO\n * @author yoshikyoto\n */\nclass MyIO extends MyMath{\n\tstatic Scanner sc = new Scanner(new InputStreamReader(System.in));\n\tpublic static char scNextChar(){return sc.next().charAt(0);}\n\tstatic BufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\tpublic static String line;\n \n\tpublic static int ins[];\n\tpublic static int[] readIntMap() throws IOException{return parseInt(readLine().split(\" \"));}\n\tpublic static int readIntMap(int i) throws Exception{\n\t\tif(i == 0) ins = readIntMap();\n\t\treturn ins[i];\n\t}\n\tpublic static int[][] readIntMap(int n, int m) throws IOException{\n\t\tint[][] ret = new int[n][];\n\t\tfor(int i = 0; i < n; i++) ret[i] = readIntMap();\n\t\treturn ret;\n\t}\n\tpublic static int[] readIntToMap(int n) throws IOException{\n\t\tint[] ret = new int[n];\n\t\tfor(int i = 0; i < n; i++) ret[i] = readInt();\n\t\treturn ret;\n\t}\n\tpublic static int[] readNoDistIntMap() throws IOException{\n\t\tString[] strs = readLine().split(\"\");\n\t\tint l = strs.length;\n\t\tint[] ret = new int[l-1];\n\t\tfor(int i = 1; i < l; i++)\n\t\t\tret[i-1] = parseInt(strs[i]);\n\t\treturn ret;\n\t}\n\tpublic static boolean readToLine() throws IOException{return (line = br.readLine()) != null;}\n\tpublic static String readLine() throws IOException{return br.readLine();}\n\tpublic static int readInt() throws IOException{return Integer.parseInt(br.readLine());}\n\tpublic static int[] parseInt(String[] arr){\n\t\tint[] res = new int[arr.length];\n\t\tfor(int i = 0; i < arr.length; i++)res[i] = Integer.parseInt(arr[i]);\n\t\treturn res;\n\t}\n\tpublic static double[] parseDouble(String[] arr){\n\t\tdouble[] res = new double[arr.length];\n\t\tfor(int i = 0; i < arr.length; i++)res[i] = Double.parseDouble(arr[i]);\n\t\treturn res;\n\t}\n\tpublic static boolean[] parseBool(String[] arr){\n\t\tint[] t = parseInt(arr);\n\t\tboolean[] res = new boolean[t.length];\n\t\tfor(int i = 0; i < t.length; i++){\n\t\t\tif(t[i] == 1){res[i] = true;\n\t\t\t}else{res[i] = false;}\n\t\t}\n\t\treturn res;\n\t}\n\tpublic static int parseInt(Object o){return Integer.parseInt(o.toString());}\n}\n \nclass MyMath{\n\tpublic static int max(int[] arr){return max(arr, 0, arr.length-1);}\n\tpublic static int max(int[] arr, int l, int r){\n\t\tint max = arr[l];\n\t\tfor(int i = l+1; i <= r; i++)\n\t\t\tmax = Math.max(max, arr[i]);\n\t\treturn max;\n\t}\n\tpublic static int min(int[] arr){return min(arr, 0, arr.length-1);}\n\tpublic static int min(int[] arr, int l, int r){\n\t\tint min = arr[l];\n\t\tfor(int i = l+1; i <= r; i++)\n\t\t\tmin = Math.min(min, arr[i]);\n\t\treturn min;\n\t}\n\tpublic static boolean isCross(int x1, int y1, int x2, int y2, int x3, int y3, int x4, int y4){\n\t\t// 並行な場合\n\t\tint m = (x2-x1)*(y4-y3)-(y2-y1)*(x4-x3);\n\t\tif(m == 0) return false;\n\t\t// 媒介変数の値が0より大きく1以下なら交差する、これは問題の状況によって変わるかも。\n\t\tdouble r =(double)((y4-y3)*(x3-x1)-(x4-x3)*(y3-y1))/m;\n\t\tdouble s =(double)((y2-y1)*(x3-x1)-(x2-x1)*(y3-y1))/m;\n\t\treturn (0 < r && r <= 1 && 0 < s && s <= 1);\n\t}\n\tpublic static boolean isParallel(int x1, int y1, int x2, int y2, int x3, int y3, int x4, int y4){\n\t\tif((x2-x1)*(y4-y3) == (y2-y1)*(x4-x3)) return true;\n\t\telse return false;\n\t}\n\tpublic static double sq(double d){return d*d;}\n\tpublic static int sq(int i){return i*i;}\n\tpublic static int sqdist(int x1, int y1, int x2, int y2){return (x1-x2) + sq(y1-y2);}\n\tpublic static double sqdist(double x1, double y1, double x2, double y2){return sq(x1-x2) + sq(y1-y2);}\n\tpublic static double dist(int x1, int y1, int x2, int y2){return Math.sqrt(sqdist(x1, y1, x2, y2));}\n\tpublic static double dist(double x1, double y1, double x2, double y2){return Math.sqrt(sqdist(x1, y1, x2, y2));}\n\tstatic long comb(long n, long m){\n\t\tif(n < m) return 0;\n\t\tlong c = 1; m = (n - m < m ? n - m : m);\n\t\tfor(long ns = n - m + 1, ms = 1; ms <= m; ns ++, ms ++){c *= ns; c /= ms;}\n\t\treturn c;\n\t}\n\tstatic int gcd(int a, int b){if(a%b==0){return(b);}else{return(gcd(b,a%b));}};\n\t/**\n\t * aの中から、合計がborderを超えるペア（重複除く）の数を数える\n\t */\n\tstatic int countPair(int[] a, int border){\n\t\tint count = 0, l = a.length, i = 0, j = l-1;\n\t\tfor (; i < l; i++) {\n\t\t\tfor (; j >= 0; j--) if(a[i] + a[j] <= border) break;\n\t\t\tcount += l - (j + 1);\n\t\t\tif(j < i) count--;\n\t\t}\n\t\treturn count/2;\n\t}\n\t// modに対応したDPのCombination\n\tstatic int mcomb(int n, int m, int mod){\n\t\tn = n - m;\n\t\tint[][] dp = new int[n+1][m+1];\n\t\tfor(int i = 0; i <= n; i++) dp[i][0] = 1;\n\t\tfor(int i = 0; i <= m; i++) dp[0][i] = 1;\n\t\t// mod = 0 の時は余りを取らない\n\t\tif(mod != 0){\n\t\t\tfor(int i = 1; i <= n; i++){\n\t\t\t\tfor(int j = 1; j <= m; j++){\n\t\t\t\t\tdp[i][j] = (dp[i-1][j] + dp[i][j-1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn dp[n][m];\n\t\t// それ以外の時は mod をとっていく\n\t\t}else{\n\t\t\tfor(int i = 1; i <= n; i++){\n\t\t\t\tfor(int j = 1; j <= m; j++){\n\t\t\t\t\tdp[i][j] = (dp[i-1][j] + dp[i][j-1]) % mod;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn dp[n][m] % mod;\n\t\t}\n\t}\n\t\n\n\tstatic long mcomb(int n, int m, long mod){\n\t\tn = n - m;\n\t\tlong[][] dp = new long[n+1][m+1];\n\t\tfor(int i = 0; i <= n; i++) dp[i][0] = 1;\n\t\tfor(int i = 0; i <= m; i++) dp[0][i] = 1;\n\t\t// mod = 0 の時は余りを取らない\n\t\tif(mod != 0){\n\t\t\tfor(int i = 1; i <= n; i++){\n\t\t\t\tfor(int j = 1; j <= m; j++){\n\t\t\t\t\tdp[i][j] = (dp[i-1][j] + dp[i][j-1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn dp[n][m];\n\t\t// それ以外の時は mod をとっていく\n\t\t}else{\n\t\t\tfor(int i = 1; i <= n; i++){\n\t\t\t\tfor(int j = 1; j <= m; j++){\n\t\t\t\t\tdp[i][j] = (dp[i-1][j] + dp[i][j-1]) % mod;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn dp[n][m] % mod;\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.util.regex.*;\n\nclass Main{\n\tprivate final static Pattern addsubmuldiv = Pattern.compile(\"^(.*?)(-?\\\\d+)([+Z*/])(-?\\\\d+)(.*)$\");\n\tprivate final static Pattern addsub = Pattern.compile(\"^(.*?)(-?\\\\d+)([+Z])(-?\\\\d+)(.*)$\");\n\tprivate final static Pattern muldiv = Pattern.compile(\"^(.*?)(-?\\\\d+)([*/])(-?\\\\d+)(.*)$\");\n\n\tprivate static String process(String s){\n\t\tMatcher m=muldiv.matcher(s);\n\t\twhile(m.find()){\n\t\t\tif(m.group(3).equals(\"*\"))\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))*Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\telse\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))/Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\tm=muldiv.matcher(s);\n\t\t}\n\n\t\tm=addsub.matcher(s);\n\t\twhile(m.find()){\n\t\t\tif(m.group(3).equals(\"+\"))\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))+Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\telse\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))-Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\tm=addsub.matcher(s);\n\t\t}\n\t\treturn s;\n\t}\n\n\tprivate static String process2(String s){\n\t\tMatcher m=addsubmuldiv.matcher(s);\n\t\twhile(m.find()){\n\t\t\tif(m.group(3).equals(\"*\"))\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))*Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\telse if(m.group(3).equals(\"/\"))\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))/Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\telse if(m.group(3).equals(\"+\"))\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))+Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\telse\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))-Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\tm=addsubmuldiv.matcher(s);\n\t\t}\n\t\treturn s;\n\t}\n\n\tpublic static void main(String[]z){\n\t\tScanner x=new Scanner(System.in);\n\t\tString s=x.next().replaceAll(\"-\",\"Z\");\n\t\tString ans=x.next();\n\t\tboolean a=process(s).equals(ans);\n\t\tboolean b=process2(s).equals(ans);\n\t\tif(a&&b)System.out.println(\"U\");\n\t\tif(a&&!b)System.out.println(\"M\");\n\t\tif(!a&&b)System.out.println(\"L\");\n\t\tif(!a&&!b)System.out.println(\"I\");\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.*;\n\nimport static java.lang.Integer.parseInt;\n\n/**\n * Miscalculation - Accepted\n */\npublic class Main {\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line;\n\t\tString[] words;\n\n\t\tString exp = br.readLine();\n\t\tint ans = parseInt(br.readLine());\n\n\t\tint M, L;\n\t\tM = M(exp);\n\t\tL = L(exp);\n\n\t\tif (ans == M && ans == L) System.out.println('U');\n\t\telse if (ans == M) System.out.println('M');\n\t\telse if (ans == L) System.out.println('L');\n\t\telse System.out.println('I');\n\t}\n\n\tstatic int M(String exp) {\n\t\tchar[] pri = new char[127];\n\t\tArrays.fill(pri, (char) 3);\n\t\tpri['*'] = 2;\n\t\tpri['+'] = 1;\n\t\tpri[0] = 0;\n\t\treturn eval(exp, pri);\n\t}\n\n\tstatic int L(String exp) {\n\t\tchar[] pri = new char[127];\n\t\tArrays.fill(pri, (char) 3);\n\t\tpri['*'] = 1;   //change pri\n\t\tpri['+'] = 1;\n\t\tpri[0] = 0;\n\t\treturn eval(exp, pri);\n\t}\n\n\tstatic int eval(String exp, char[] pri) {\n\n\t\tDeque<Character> stack = new ArrayDeque<>();\n\t\tString rpn = \"\";\n\n\t\tstack.push('\\0');\n\t\tfor (char c : exp.toCharArray()) {\n\t\t\tif (pri[c] > pri[stack.peek()]) {\n\t\t\t\tstack.push(c);\n\t\t\t} else {\n\t\t\t\twhile (pri[c] <= pri[stack.peek()]) {\n\t\t\t\t\trpn += String.valueOf(stack.pop());\n\t\t\t\t}\n\t\t\t\tstack.push(c);\n\t\t\t}\n\t\t}\n\t\twhile (stack.peek() != '\\0') {\n\t\t\trpn += String.valueOf(stack.pop());\n\t\t}\n\n\t\t//\n\t\tDeque<Integer> ans = new ArrayDeque<>();\n\n\t\tfor (char c : rpn.toCharArray()) {\n\t\t\tint a, b;\n\t\t\tswitch (c) {\n\t\t\t\tcase '*':\n\t\t\t\t\tb = ans.pop();\n\t\t\t\t\ta = ans.pop();\n\t\t\t\t\tans.push(a * b);\n\t\t\t\t\tbreak;\n\t\t\t\tcase '+':\n\t\t\t\t\tb = ans.pop();\n\t\t\t\t\ta = ans.pop();\n\t\t\t\t\tans.push(a + b);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tans.push(c - '0');\n\t\t\t}\n\t\t}\n\t\treturn ans.peek();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.*;\nimport java.util.regex.Matcher;\nimport java.util.regex.Pattern;\nimport java.lang.ArrayIndexOutOfBoundsException;\nimport java.math.BigInteger;\n\nimport javax.script.AbstractScriptEngine;\n\n\n/**\n * @author yoshikyoto\n */\nclass Main extends MyUtil{\n\t// public static Graph g;\n\tpublic static void main(String[] args) throws Exception{\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tExpr e = new Expr(br.readLine());\n\t\tint a = Integer.parseInt(br.readLine());\n\t\tif(e.m == e.l && e.m == a){\n\t\t\tSystem.out.println(\"U\");\n\t\t}else if(e.m == a){\n\t\t\tSystem.out.println(\"M\");\n\t\t}else if(e.l == a){\n\t\t\tSystem.out.println(\"U\");\n\t\t}else{\n\t\t\tSystem.out.println(\"I\");\n\t\t}\n\t}\n}\n\n\nclass Expr{\n\tString toString;\n\tchar[] expr;\n\tint m, l;\n\tExpr(String str){\n\t\ttoString = str;\n\t\texpr = str.toCharArray();\n\t\t\n\t\tm = multFirst(expr, 0, expr.length - 1);\n\t\tl = rightToLeft(expr);\n\t}\n\t\n\t/**\n\t * 左から右に計算していく\n\t */\n\tint rightToLeft(char[] expr){\n\t\tint ans = toInt(expr[0]);\n\t\tfor(int i = 1; i < expr.length; i += 2){\n\t\t\tswitch(expr[i]){\n\t\t\tcase '+':\n\t\t\t\tans += toInt(expr[i+1]);\n\t\t\t\tbreak;\n\t\t\tcase '*':\n\t\t\t\tans *= toInt(expr[i+1]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn ans;\n\t}\n\t\n\tint multFirst(char[] expr, int left, int right){\n\t\tif(left == right){\n\t\t\treturn toInt(expr[left]);\n\t\t}\n\t\t\n\t\t// 足し算\n\t\tfor(int i = left+1; i <= right; i += 2){\n\t\t\tif(expr[i] == '+'){\n\t\t\t\treturn multFirst(expr, left, i-1) + multFirst(expr, i+1, right);\n\t\t\t}\n\t\t}\n\t\t\n\t\t// 足し算がなかったら掛け算を探す\n\t\tfor(int i = left+1; i <= right; i += 2){\n\t\t\tif(expr[i] == '*'){\n\t\t\t\treturn multFirst(expr, left, i-1) * multFirst(expr, i+1, right);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn 0;\n\t}\n\t\n\tint toInt(char c){\n\t\treturn c - '0';\n\t}\n\t\n}\n\n\n// --- ここから下はライブラリ ----------\n \nclass ArrayComp implements Comparator<int[]>{\n\tpublic int compare(int[] a, int[] b){\n\t\tint l = Math.min(a.length, b.length);\n\t\tfor(int i = 0; i < l; i++){\n\t\t\tif(a[i] == b[i]) continue;\n\t\t\treturn a[i] - b[i];\n\t\t}\n\t\treturn 0;\n\t}\n}\n \nclass Node extends ArrayList<Edge>{\n\tint index, depth = -1, dist = -1;\n\tNode(int index){this.index = index;}\n\tNode parent;\n\tboolean visited = false;\n}\nclass Edge{\n\tint from, to, cost;\n\tEdge(int from, int to, int cost){\n\t\tthis.from = from;\n\t\tthis.to = to;\n\t\tthis.cost = cost;\n\t}\n}\nclass NodeComparator implements Comparator<Node>{\n\tpublic int compare(Node a, Node b){\n\t\treturn a.dist - b.dist;\n\t}\n}\n \nclass Graph{\n\tNode n[];\n\tGraph(int node_count){\n\t\tn = new Node[node_count];\n\t\tfor(int i = 0; i < node_count; i++) n[i] = new Node(i);\n\t}\n\tpublic void add(Edge e){\n\t\tn[e.from].add(e);\n\t}\n\tpublic Node get(int i){return n[i];}\n\tpublic Node lca(int a, int b){\n\t\t// 浅い方をaとする\n\t\tNode nodeA, nodeB;\n\t\tif(n[a].depth < n[b].depth){\n\t\t\tnodeA = n[a];\n\t\t\tnodeB = n[b];\n\t\t}else{\n\t\t\tnodeA = n[b];\n\t\t\tnodeB = n[a];\n\t\t}\n\t\t// 同じ深さまで親をたどる\n\t\tint diff = nodeB.depth - nodeA.depth;\n\t\tfor(int k = 0; k < diff; k++){\n\t\t\tnodeB = nodeB.parent;\n\t\t}\n\t\t// 共通祖先を見つける\n\t\twhile(nodeA != nodeB){\n\t\t\tnodeA = nodeA.parent;\n\t\t\tnodeB = nodeB.parent;\n\t\t}\n\t\treturn nodeA;\n\t}\n\tpublic void calcDepth(int root){\n\t\tArrayDeque<Integer> que = new ArrayDeque<Integer>();\n\t\tque.push(root);\n\t\tn[root].depth = 0;\n \n\t\twhile(que.size() > 0){\n\t\t\tint curr = que.pop();\n\t\t\tNode curr_node = n[curr];\n\t\t\tfor(Edge e : curr_node){\n\t\t\t\tint next = e.to;\n\t\t\t\tNode next_node = n[next];\n\t\t\t\tif(next_node.depth == -1){\n\t\t\t\t\tnext_node.depth = curr_node.depth + 1;\n\t\t\t\t\tnext_node.parent = curr_node;\n\t\t\t\t\tque.push(next);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n \n\tpublic int[] dijkstra(int s){\n\t\tPriorityQueue<Node> q = new PriorityQueue<Node>(n.length, new NodeComparator());\n\t\tNode start_node = new Node(s);\n\t\tstart_node.dist = 0;\n\t\tq.add(start_node);\n\t\tint[] dist = new int[n.length];\n\t\tfor (int i = 0; i < dist.length; i++)  dist[i] = -1;\n\t\tdist[s] = 0;\n \n\t\twhile(q.size() > 0){\n\t\t\tNode currNode = q.poll();\n\t\t\tif(dist[currNode.index] < currNode.dist) continue;\n\t\t\tfor(Edge e : n[currNode.index]){\n\t\t\t\tNode nextNode = new Node(e.to);\n\t\t\t\tnextNode.dist = currNode.dist + e.cost;\n\t\t\t\tif(dist[e.to] == -1 || dist[e.to] > nextNode.dist){\n\t\t\t\t\tdist[e.to] = nextNode.dist;\n\t\t\t\t\tq.add(nextNode);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn dist;\n\t}\n}\n \n \n \nclass Regex{\n\tPattern p; Matcher m; String str;\n\tRegex(String regex_str){p = Pattern.compile(regex_str);}\n\tvoid setStr(String str){m = p.matcher(str);}\n\tboolean find(){return m.find();}\n\tString group(int i){return m.group(i);}\n\tString group(){return m.group();}\n}\n \n/**\n * UnionFindTree \n * @author yoshikyoto\n */\nclass UnionFindTree{\n\tpublic int[] parent, rank;\n\tpublic int n;\n\tpublic int count;\n\t// 初期化\n\tUnionFindTree(int n){\n\t\tthis.n = n;\n\t\tcount = n;\n\t\tparent = new int[n];\n\t\trank = new int[n];\n\t\tfor(int i = 0; i < n; i++){\n\t\t\tparent[i] = i;\n\t\t\trank[i] = 0;\n\t\t}\n\t}\n\t// 根を求める\n\tint find(int x){\n\t\tif(parent[x] == x){\n\t\t\treturn x;\n\t\t}else{\n\t\t\treturn parent[x] = find(parent[x]);\n\t\t}\n\t}\n\t// xとyの集合を結合\n\tvoid unite(int x, int y){\n\t\tx = find(x);\n\t\ty = find(y);\n\t\tif(x == y){\n\t\t\treturn;\n\t\t}\n\t\tif(rank[x] < rank[y]){\n\t\t\tparent[x] = y;\n\t\t\tcount--;\n\t\t}else{\n\t\t\tparent[y] = x;\n\t\t\tif(rank[x] == rank[y]) rank[x]++;\n\t\t\tcount--;\n\t\t}\n\t}\n\t// xとyが同じ集合か\n\tboolean same(int x, int y){\n\t\treturn find(x) == find(y);\n\t}\n};\n \n \n\n \nclass CountHashMap<E> extends HashMap<E, Integer>{\n\tArrayList<E> keyArray = new ArrayList<E>();\n\tpublic void add(E key){add(key, 1);}\n\tpublic void add(E key, Integer value){\n\t\tif(containsKey(key)){value += get(key);\n\t\t}else{keyArray.add(key);}\n\t\tput(key, value);\n\t}\n}\n \n/**\n * MyUtil\n * @author yoshikyoto\n */\nclass MyUtil extends MyIO{\n\tpublic static Random rand = new Random();\n\tpublic static int digit(int n){return String.valueOf(n).length();}\n\tpublic static String reverse(String s){return (new StringBuffer(s)).reverse().toString();}\n\tpublic static void dsort(int[] a){\n\t\tArrays.sort(a);\n\t\tint l = a.length;\n\t\tfor(int i = 0; i < l/2; i++){\n\t\t\tint tmp = a[i]; a[i] = a[l-1-i]; a[l-1-i] = tmp;\n\t\t}\n\t}\n\tpublic static void sleep(int t){try{Thread.sleep(t);}catch(Exception e){}}\n\tpublic static int sum(int[] a){int s = 0; for(int i = 0; i < a.length; i++)s+=a[i]; return s;}\n\tpublic static int[] cp(int[] a){\n\t\tint[] b = new int[a.length];\n\t\tfor(int i = 0; i < a.length; i++) b[i] = a[i];\n\t\treturn b;\n\t}\n\tpublic static int randomInt(int min, int max){return min + rand.nextInt(max - min + 1);}\n\tstatic boolean inside(int y, int x, int h, int w){return 0 <= y && y <= (h-1) && 0 <= x && x <= (w-1);};\n\tpublic static boolean isUpper(char c){return 'A'<=c&&c<='Z';}\n\tpublic static boolean isLower(char c){return 'a'<=c&&c<='z';}\n\tpublic static char toUpper(char c){\n\t\tif(isLower(c)) return (char)(c - 'a' + 'A');\n\t\treturn c;\n\t}\n\tpublic static char toLower(char c){\n\t\tif(isUpper(c)) return (char)(c - 'A' + 'a');\n\t\treturn c;\n\t}\n\tpublic static int[] swap(int[] arr, int i, int j){\n\t\tint[] ret = cp(arr);\n\t\tint tmp = ret[i];\n\t\tret[i] = ret[j];\n\t\tret[j] = tmp;\n\t\treturn ret;\n\t}\n\tpublic static int toInt(boolean[] a){\n\t\tint pow = 1, ret = 0, l = a.length;\n\t\tfor(int i = 0; i < l; i++){\n\t\t\tif(a[i]) ret += pow;\n\t\t\tpow *= 2;\n\t\t}\n\t\treturn ret;\n\t}\n}\n \n/**\n * MyIO\n * @author yoshikyoto\n */\nclass MyIO extends MyMath{\n\tstatic Scanner sc = new Scanner(new InputStreamReader(System.in));\n\tpublic static char scNextChar(){return sc.next().charAt(0);}\n\tstatic BufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\tpublic static String line;\n \n\tpublic static int ins[];\n\tpublic static int[] readIntMap() throws IOException{return parseInt(readLine().split(\" \"));}\n\tpublic static int readIntMap(int i) throws Exception{\n\t\tif(i == 0) ins = readIntMap();\n\t\treturn ins[i];\n\t}\n\tpublic static int[][] readIntMap(int n, int m) throws IOException{\n\t\tint[][] ret = new int[n][];\n\t\tfor(int i = 0; i < n; i++) ret[i] = readIntMap();\n\t\treturn ret;\n\t}\n\tpublic static int[] readIntToMap(int n) throws IOException{\n\t\tint[] ret = new int[n];\n\t\tfor(int i = 0; i < n; i++) ret[i] = readInt();\n\t\treturn ret;\n\t}\n\tpublic static int[] readNoDistIntMap() throws IOException{\n\t\tString[] strs = readLine().split(\"\");\n\t\tint l = strs.length;\n\t\tint[] ret = new int[l-1];\n\t\tfor(int i = 1; i < l; i++)\n\t\t\tret[i-1] = parseInt(strs[i]);\n\t\treturn ret;\n\t}\n\tpublic static boolean readToLine() throws IOException{return (line = br.readLine()) != null;}\n\tpublic static String readLine() throws IOException{return br.readLine();}\n\tpublic static int readInt() throws IOException{return Integer.parseInt(br.readLine());}\n\tpublic static int[] parseInt(String[] arr){\n\t\tint[] res = new int[arr.length];\n\t\tfor(int i = 0; i < arr.length; i++)res[i] = Integer.parseInt(arr[i]);\n\t\treturn res;\n\t}\n\tpublic static double[] parseDouble(String[] arr){\n\t\tdouble[] res = new double[arr.length];\n\t\tfor(int i = 0; i < arr.length; i++)res[i] = Double.parseDouble(arr[i]);\n\t\treturn res;\n\t}\n\tpublic static boolean[] parseBool(String[] arr){\n\t\tint[] t = parseInt(arr);\n\t\tboolean[] res = new boolean[t.length];\n\t\tfor(int i = 0; i < t.length; i++){\n\t\t\tif(t[i] == 1){res[i] = true;\n\t\t\t}else{res[i] = false;}\n\t\t}\n\t\treturn res;\n\t}\n\tpublic static int parseInt(Object o){return Integer.parseInt(o.toString());}\n}\n \nclass MyMath{\n\tpublic static int max(int[] arr){return max(arr, 0, arr.length-1);}\n\tpublic static int max(int[] arr, int l, int r){\n\t\tint max = arr[l];\n\t\tfor(int i = l+1; i <= r; i++)\n\t\t\tmax = Math.max(max, arr[i]);\n\t\treturn max;\n\t}\n\tpublic static int min(int[] arr){return min(arr, 0, arr.length-1);}\n\tpublic static int min(int[] arr, int l, int r){\n\t\tint min = arr[l];\n\t\tfor(int i = l+1; i <= r; i++)\n\t\t\tmin = Math.min(min, arr[i]);\n\t\treturn min;\n\t}\n\tpublic static boolean isCross(int x1, int y1, int x2, int y2, int x3, int y3, int x4, int y4){\n\t\t// 並行な場合\n\t\tint m = (x2-x1)*(y4-y3)-(y2-y1)*(x4-x3);\n\t\tif(m == 0) return false;\n\t\t// 媒介変数の値が0より大きく1以下なら交差する、これは問題の状況によって変わるかも。\n\t\tdouble r =(double)((y4-y3)*(x3-x1)-(x4-x3)*(y3-y1))/m;\n\t\tdouble s =(double)((y2-y1)*(x3-x1)-(x2-x1)*(y3-y1))/m;\n\t\treturn (0 < r && r <= 1 && 0 < s && s <= 1);\n\t}\n\tpublic static boolean isParallel(int x1, int y1, int x2, int y2, int x3, int y3, int x4, int y4){\n\t\tif((x2-x1)*(y4-y3) == (y2-y1)*(x4-x3)) return true;\n\t\telse return false;\n\t}\n\tpublic static double sq(double d){return d*d;}\n\tpublic static int sq(int i){return i*i;}\n\tpublic static int sqdist(int x1, int y1, int x2, int y2){return (x1-x2) + sq(y1-y2);}\n\tpublic static double sqdist(double x1, double y1, double x2, double y2){return sq(x1-x2) + sq(y1-y2);}\n\tpublic static double dist(int x1, int y1, int x2, int y2){return Math.sqrt(sqdist(x1, y1, x2, y2));}\n\tpublic static double dist(double x1, double y1, double x2, double y2){return Math.sqrt(sqdist(x1, y1, x2, y2));}\n\tstatic long comb(long n, long m){\n\t\tif(n < m) return 0;\n\t\tlong c = 1; m = (n - m < m ? n - m : m);\n\t\tfor(long ns = n - m + 1, ms = 1; ms <= m; ns ++, ms ++){c *= ns; c /= ms;}\n\t\treturn c;\n\t}\n\tstatic int gcd(int a, int b){if(a%b==0){return(b);}else{return(gcd(b,a%b));}};\n\t/**\n\t * aの中から、合計がborderを超えるペア（重複除く）の数を数える\n\t */\n\tstatic int countPair(int[] a, int border){\n\t\tint count = 0, l = a.length, i = 0, j = l-1;\n\t\tfor (; i < l; i++) {\n\t\t\tfor (; j >= 0; j--) if(a[i] + a[j] <= border) break;\n\t\t\tcount += l - (j + 1);\n\t\t\tif(j < i) count--;\n\t\t}\n\t\treturn count/2;\n\t}\n\t// modに対応したDPのCombination\n\tstatic int mcomb(int n, int m, int mod){\n\t\tn = n - m;\n\t\tint[][] dp = new int[n+1][m+1];\n\t\tfor(int i = 0; i <= n; i++) dp[i][0] = 1;\n\t\tfor(int i = 0; i <= m; i++) dp[0][i] = 1;\n\t\t// mod = 0 の時は余りを取らない\n\t\tif(mod != 0){\n\t\t\tfor(int i = 1; i <= n; i++){\n\t\t\t\tfor(int j = 1; j <= m; j++){\n\t\t\t\t\tdp[i][j] = (dp[i-1][j] + dp[i][j-1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn dp[n][m];\n\t\t// それ以外の時は mod をとっていく\n\t\t}else{\n\t\t\tfor(int i = 1; i <= n; i++){\n\t\t\t\tfor(int j = 1; j <= m; j++){\n\t\t\t\t\tdp[i][j] = (dp[i-1][j] + dp[i][j-1]) % mod;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn dp[n][m] % mod;\n\t\t}\n\t}\n\t\n\n\tstatic long mcomb(int n, int m, long mod){\n\t\tn = n - m;\n\t\tlong[][] dp = new long[n+1][m+1];\n\t\tfor(int i = 0; i <= n; i++) dp[i][0] = 1;\n\t\tfor(int i = 0; i <= m; i++) dp[0][i] = 1;\n\t\t// mod = 0 の時は余りを取らない\n\t\tif(mod != 0){\n\t\t\tfor(int i = 1; i <= n; i++){\n\t\t\t\tfor(int j = 1; j <= m; j++){\n\t\t\t\t\tdp[i][j] = (dp[i-1][j] + dp[i][j-1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn dp[n][m];\n\t\t// それ以外の時は mod をとっていく\n\t\t}else{\n\t\t\tfor(int i = 1; i <= n; i++){\n\t\t\t\tfor(int j = 1; j <= m; j++){\n\t\t\t\t\tdp[i][j] = (dp[i-1][j] + dp[i][j-1]) % mod;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn dp[n][m] % mod;\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "public class Main {\n\n  /*\n   * <Expr> ::= <Term> | <Expr> + <Term> \n   * <Term> ::= <Fact> | <Term> * <Fact> \n   * <Fact> ::= 0-9\n   */\n\n  String line;\n  char sy;\n  int pos = 1;\n\n  char getToken() {\n    if( this.pos == line.length() ) { \n      this.pos++;\n      return '\\0';\n    }\n    return this.sy = line.charAt( this.pos++ );\n  }\n\n  int expression() {\n//    System.out.println( \"EXP\" + \" SY\" + this.sy + \" POS\" + this.pos );\n    int n = this.term();\n    if( this.sy == '+' ) {\n      this.getToken();\n//      System.out.println( \"DBG\" + this.sy + \" \" + this.pos );\n      int m = this.expression();\n//      System.out.println( \">EXP1\" + \" SY\"+ this.sy + \" POS\" + this.pos + \" \" + n + \" \" + m );\n      return n + m;\n    }\n\n//    System.out.println( \">EXP2\" + \" SY\"+ this.sy + \" POS\" + this.pos );\n    return n;\n  }\n\n  int term() {\n//    System.out.println( \"TRM\" + \" SY\"+ this.sy + \" POS\" + this.pos );\n    int n = this.factor();\n    if( this.sy == '*' ) {\n      this.getToken();\n      int m = this.term();\n//      System.out.println( \">TRM1\" + \" SY\"+ this.sy + \" POS\" + this.pos );\n      return n * m;\n    }\n\n//    System.out.println( \">TRM2\" + \" SY\"+ this.sy + \" POS\" + this.pos );\n    return n;\n  }\n\n  int factor() {\n//    System.out.println( \"FCT\" + \" SY\"+ this.sy + \" POS\" + this.pos );\n    if( this.sy < '0' || '9' < this.sy ) {\n      System.err.println( \"ERROR\" );\n      System.exit( -1 ); // Error\n    }\n\n    int n =  this.sy - '0';\n    this.getToken();\n\n//    System.out.println( \">FCT\" + \" SY\"+ this.sy + \" POS\" + this.pos );\n    return n;\n  }\n\n  int mfunc() {\n    int len = this.line.length();\n    int x = this.line.charAt( 0 ) - '0';\n    for( int i = 1; i < len - 1; i += 2 ) {\n      char c = this.line.charAt( i );\n      int opr = this.line.charAt( i + 1 ) - '0';\n      if( c == '+' ) {\n        x += opr;\n      } else if( c == '*' ) {\n        x *= opr;\n      } \n    }\n    return x;\n  }\n\n  void run(\n      java.io.InputStream in,\n      java.io.PrintStream out\n      ) {\n\n      java.util.Scanner sc = new java.util.Scanner( in );\n      this.line = sc.next();\n      int n = Integer.parseInt( sc.next() );\n      this.sy = this.line.charAt(0);\n      int ans1 = this.expression();\n      int ans2 = this.mfunc();\n\n      if( n == ans1 ) {\n        if( n == ans2 ) {\n          out.println( \"U\" );\n        } else {\n          out.println( \"M\" );\n        }\n      } else {\n        if( n == ans2 ) {\n          out.println( \"L\" );\n        } else {\n          out.println( \"I\" );\n        }\n\n      }\n  }\n\n  public static void main( String[] main ) {\n    new Main().run( System.in, System.out );\n  }\n}"
  },
  {
    "language": "Java",
    "code": "public class Main{\n  static int top;\n  public void run(java.io.InputStream in, java.io.PrintStream out){\n    java.util.Scanner sc = new java.util.Scanner(in);\n    int ba, i, tmp;\n    String str;\n    char[] ch;\n    int[] la, ta;\n\n    str = sc.next();\n    ch = new char[str.length()];\n    la = new int[10]; ta = new int[10];\n    for(i = 0;i < str.length();i++)ch[i] = str.charAt(i);\n    ba = sc.nextInt();\n\n    top = 0;\n    for(i = 0;i < str.length();i++){\n      if(ch[i] >= '0' && ch[i] <= '9'){\n        push(la, (int)(ch[i] - '0'));\n      }else if(ch[i] == '+'){\n        tmp = pop(la);\n        push(la, tmp + (int)(ch[++i] - '0'));\n      }else{\n        tmp = pop(la);\n        push(la, tmp * (int)(ch[++i] - '0'));\n      }\n    }\n\n    top = 0;\n    for(i = 0;i < str.length();i++){\n      if(ch[i] >= '0' && ch[i] <= '9'){\n        push(ta, (int)(ch[i] - '0'));\n      }else if(ch[i] == '+'){\n        i++;\n        push(ta, (int)(ch[i] - '0'));\n      }else{\n        tmp = pop(ta);\n        push(ta, tmp * (int)(ch[++i] - '0'));\n      }\n    }\n\n    tmp = 0;\n    for(i = 0;i < top;i++)tmp += ta[i];\n\n    if(ba == la[0] && ba == tmp)out.println(\"U\");\n    else if(ba != la[0] && ba != tmp)out.println(\"I\");\n    else if(ba == la[0] && ba != tmp)out.println(\"L\");\n    else if(ba != la[0] && ba == tmp)out.println(\"M\");\n\n    sc.close();\n  }\n  public static void main(String[] args){\n    (new Main()).run(System.in, System.out);\n  }\n  private static int pop(int[] stack){\n    return stack[--top];\n  }\n\n  private static void push(int[] stack, int a){\n    stack[top++] = a;\n    return;\n  }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\tMyScanner sc = new MyScanner();\n\tScanner sc2 = new Scanner(System.in);\n\tfinal int MOD = 1000000007;\n\tint[] dx = { 1, 0, 0, -1 };\n\tint[] dy = { 0, 1, -1, 0 };\n\n\tvoid run() {\n\t\tString in = sc.next();\n\t\tint ans = sc.nextInt();\n\n\t\tint sum1 = in.charAt(0) - '0';\n\t\tfor (int i = 1; i < in.length(); i++) {\n\t\t\tchar c = in.charAt(i);\n\t\t\tif (Character.isDigit(c)) {\n\t\t\t\tif (in.charAt(i - 1) == '+') {\n\t\t\t\t\tsum1 += c - '0';\n\t\t\t\t} else {\n\t\t\t\t\tsum1 *= c - '0';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint sum2 = expression(in);\n\t\t\n\t\tif(ans == sum1 && ans == sum2) {\n\t\t\tSystem.out.println(\"U\");\n\t\t} else if(ans == sum1 && ans != sum2) {\n\t\t\tSystem.out.println(\"L\");\n\t\t} else if(ans != sum1 && ans == sum2) {\n\t\t\tSystem.out.println(\"M\");\n\t\t} else {\n\t\t\tSystem.out.println(\"I\");\n\t\t}\n\t}\n\n\tint index = 0;\n\n\tint expression(String sb) {\n\t\tint res = term(sb);\n\t\tfor (; index < sb.length();) {\n\t\t\tif (sb.charAt(index) == '+') {\n\t\t\t\tindex++;\n\t\t\t\tres += term(sb);\n\t\t\t} else if (sb.charAt(index) == '-') {\n\t\t\t\tindex++;\n\t\t\t\tres -= term(sb);\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}\n\n\tint term(String sb) {\n\t\tint res = factor(sb);\n\t\tfor (; index < sb.length();) {\n\t\t\tif (sb.charAt(index) == '*') {\n\t\t\t\tindex++;\n\t\t\t\tres *= factor(sb);\n\t\t\t} else if (sb.charAt(index) == '/') {\n\t\t\t\tindex++;\n\t\t\t\tres /= factor(sb);\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}\n\n\tint factor(String sb) {\n\t\tint res = 0;\n\t\tif (index < sb.length() && sb.charAt(index) == '(') {\n\t\t\tindex++;\n\t\t\tres = expression(sb);\n\t\t\tindex++;\n\t\t} else {\n\t\t\tres = number(sb);\n\t\t}\n\t\treturn res;\n\t}\n\n\tint number(String sb) {\n\t\tint res = 0;\n\t\twhile (index < sb.length() && Character.isDigit(sb.charAt(index))) {\n\t\t\tres *= 10;\n\t\t\tres += sb.charAt(index) - '0';\n\t\t\tindex++;\n\t\t}\n\t\treturn res;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid debug(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n\n\tvoid debug2(int[][] array) {\n\t\tfor (int i = 0; i < array.length; i++) {\n\t\t\tfor (int j = 0; j < array[i].length; j++) {\n\t\t\t\tSystem.out.print(array[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tboolean inner(int h, int w, int lim) {\n\t\treturn 0 <= h && h < lim && 0 <= w && w < lim;\n\t}\n\n\tvoid swap(int[] x, int a, int b) {\n\t\tint tmp = x[a];\n\t\tx[a] = x[b];\n\t\tx[b] = tmp;\n\t}\n\n\t// find minimum i (a[i] >= border)\n\tint lower_bound(int a[], int border) {\n\t\tint l = -1;\n\t\tint r = a.length;\n\n\t\twhile (r - l > 1) {\n\t\t\tint mid = (l + r) / 2;\n\t\t\tif (border <= a[mid]) {\n\t\t\t\tr = mid;\n\t\t\t} else {\n\t\t\t\tl = mid;\n\t\t\t}\n\t\t}\n\t\t// r = l + 1\n\t\treturn r;\n\t}\n\n\tclass MyScanner {\n\t\tint nextInt() {\n\t\t\ttry {\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (c != '-' && (c < '0' || '9' < c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tif (c == '-')\n\t\t\t\t\treturn -nextInt();\n\t\t\t\tint res = 0;\n\t\t\t\tdo {\n\t\t\t\t\tres *= 10;\n\t\t\t\t\tres += c - '0';\n\t\t\t\t\tc = System.in.read();\n\t\t\t\t} while ('0' <= c && c <= '9');\n\t\t\t\treturn res;\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tString next() {\n\t\t\ttry {\n\t\t\t\tStringBuilder res = new StringBuilder(\"\");\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (Character.isWhitespace(c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tdo {\n\t\t\t\t\tres.append((char) c);\n\t\t\t\t} while (!Character.isWhitespace(c = System.in.read()));\n\t\t\t\treturn res.toString();\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] in = new int[n];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tin[i] = nextInt();\n\t\t\t}\n\t\t\treturn in;\n\t\t}\n\n\t\tint[][] nextInt2dArray(int n, int m) {\n\t\t\tint[][] in = new int[n][m];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tin[i] = nextIntArray(m);\n\t\t\t}\n\t\t\treturn in;\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] in = new double[n];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tin[i] = nextDouble();\n\t\t\t}\n\t\t\treturn in;\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] in = new long[n];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tin[i] = nextLong();\n\t\t\t}\n\t\t\treturn in;\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.io.*;\nimport java.awt.geom.*;\nimport java.math.*;\n\npublic class Main {\n\n\tstatic final Scanner in = new Scanner(System.in);\n\tstatic final PrintWriter out = new PrintWriter(System.out,false);\n\tstatic boolean debug = false;\n\n\tstatic void solve() {\n\t\tString s = in.next();\n\t\tint n = in.nextInt();\n\t\tint ans1 = s.charAt(0) - '0';\n\t\tfor (int i=1; i<s.length(); i+=2) {\n\t\t\tif (s.charAt(i) == '+') {\n\t\t\t\tans1 += s.charAt(i+1) - '0';\n\t\t\t} else {\n\t\t\t\tans1 *= s.charAt(i+1) - '0';\n\t\t\t}\n\t\t}\n\t\tArrayDeque<Integer> stack = new ArrayDeque<>();\n\t\tstack.add(s.charAt(0) - '0');\n\t\tfor (int i=1; i<s.length(); i+=2) {\n\t\t\tif (s.charAt(i) == '+') {\n\t\t\t\tstack.add(s.charAt(i+1) - '0');\n\t\t\t} else {\n\t\t\t\tstack.add(stack.pollLast()*(s.charAt(i+1) - '0'));\n\t\t\t}\n\t\t}\n\t\tint ans2 = 0;\n\t\twhile (stack.size() > 0) ans2 += stack.poll();\n\n\t\tif (ans1 == n) {\n\t\t\tif (ans2 == n) out.println(\"U\");\n\t\t\telse out.println(\"L\");\n\t\t} else {\n\t\t\tif (ans2 == n) out.println(\"M\");\n\t\t\telse out.println(\"I\");\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tdebug = args.length > 0;\n\t\tlong start = System.nanoTime();\n\n\t\tsolve();\n\t\tout.flush();\n\n\t\tlong end = System.nanoTime();\n\t\tdump((end - start) / 1000000 + \" ms\");\n\t\tin.close();\n\t\tout.close();\n\t}\n\n\tstatic void dump(Object... o) { if (debug) System.err.println(Arrays.deepToString(o)); }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.util.regex.*;\n\nclass Main{\n\tprivate final static Pattern addsubmuldiv = Pattern.compile(\"^(.*?)(-?\\\\d+)([+Z*/])(-?\\\\d+)(.*)$\");\n\tprivate final static Pattern addsub = Pattern.compile(\"^(.*?)(-?\\\\d+)([+Z])(-?\\\\d+)(.*)$\");\n\tprivate final static Pattern muldiv = Pattern.compile(\"^(.*?)(-?\\\\d+)([*/])(-?\\\\d+)(.*)$\");\n\n\tprivate static String process(String s){\n\t\tMatcher m=muldiv.matcher(s);\n\t\twhile(m.find()){\n\t\t\tif(m.group(3).equals(\"*\"))\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))*Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\telse\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))/Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\tm=muldiv.matcher(s);\n\t\t}\n\n\t\tm=addsub.matcher(s);\n\t\twhile(m.find()){\n\t\t\tif(m.group(3).equals(\"+\"))\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))+Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\telse\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))-Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\tm=addsub.matcher(s);\n\t\t}\n\t\treturn s;\n\t}\n\n\tprivate static String process2(String s){\n\t\tMatcher m=addsubmuldiv.matcher(s);\n\t\twhile(m.find()){\n\t\t\tif(m.group(3).equals(\"*\"))\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))*Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\telse if(m.group(3).equals(\"/\"))\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))/Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\telse if(m.group(3).equals(\"+\"))\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))+Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\telse\n\t\t\t\ts=m.group(1)+(Integer.parseInt(m.group(2))-Integer.parseInt(m.group(4)))+m.group(5);\n\t\t\tm=addsubmuldiv.matcher(s);\n\t\t}\n\t\treturn s;\n\t}\n\n\tpublic static void main(String[]z){\n\t\tScanner x=new Scanner(System.in);\n\t\tString s=x.next().replaceAll(\"-\",\"Z\");\n\t\tString ans=x.next();\n\t\tboolean a=process(s).equals(ans);\n\t\tboolean b=process2(s).equals(ans);\n\t\tif(a&&b)System.out.println(\"U\");\n\t\tif(a&&!b)System.out.println(\"M\");\n\t\tif(!a&&b)System.out.println(\"L\");\n\t\tif(!a&&!b)System.out.println(\"I\");\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.InputStreamReader;\nimport java.util.Arrays;\nimport java.util.LinkedList;\nimport java.util.StringTokenizer;\n\npublic class Main{\n\t\n\tpublic static long left_to_right(char[] inputs, int start, int end){\n\t\tint ops_pos = end - 1;\n\t\twhile(ops_pos >= start && ('0' <= inputs[ops_pos] && inputs[ops_pos] <= '9')){\n\t\t\tops_pos--;\n\t\t}\n\t\t\n\t\tlong fst_number = 0;\n\t\tfor(int pos = end - 1, keta = 1; pos > ops_pos; pos--, keta *= 10){\n\t\t\tfst_number += keta * (inputs[pos] - '0');\n\t\t}\n\t\t\n\t\t//System.out.println(start + \" \" + ops_pos + \" \" + end + \" \" + (ops_pos < start ? \"\" : inputs[ops_pos]) + \" \" + fst_number);\n\t\t\n\t\tif(ops_pos < start){\n\t\t\treturn fst_number;\n\t\t}else if(inputs[ops_pos] == '+'){\n\t\t\treturn fst_number + left_to_right(inputs, start, ops_pos);\n\t\t}else{\n\t\t\treturn fst_number * left_to_right(inputs, start, ops_pos);\n\t\t}\n\t}\n\t\n\tpublic static long multi(String input){\n\t\tString[] inputs = input.split(\"\\\\+\");\n\t\t\n\t\tlong ret = 0;\n\t\tfor(String in : inputs){\n\t\t\tString[] multi = in.split(\"\\\\*\");\n\t\t\tlong ret_m = 1;\n\t\t\tfor(String mul : multi){\n\t\t\t\tret_m *= Long.parseLong(mul);\n\t\t\t}\n\t\t\t\n\t\t\tret += ret_m;\n\t\t}\n\t\t\n\t\treturn ret;\n\t}\n\t\n\tpublic static void main(String[] args) throws IOException {\n\t\tScanner sc = new Scanner(System.in);\n\t\t\n\t\tString input = sc.next();\n\t\tfinal long answer = sc.nextInt();\n\t\t\n\t\tfinal long left  = left_to_right(input.toCharArray(), 0, input.length());\n\t\tfinal long multi = multi(input);\n\t\t\n\t\t//System.out.println(left + \" \" + multi);\n\t\t\n\t\tif(left == answer && multi == answer){\n\t\t\tSystem.out.println(\"U\");\n\t\t}else if(left == answer){\n\t\t\tSystem.out.println(\"L\");\n\t\t}else if(multi == answer){\n\t\t\tSystem.out.println(\"M\");\n\t\t}else{\n\t\t\tSystem.out.println(\"I\");\n\t\t}\n\t\t\n\t\tsc.close();\n\t}\n\n\tpublic static class Scanner {\n\t\tprivate BufferedReader br;\n\t\tprivate StringTokenizer tok;\n\n\t\tpublic Scanner(InputStream is) throws IOException {\n\t\t\tbr = new BufferedReader(new InputStreamReader(is));\n\t\t}\n\n\t\tprivate void getLine() throws IOException {\n\t\t\twhile (!hasNext()) {\n\t\t\t\ttok = new StringTokenizer(br.readLine());\n\t\t\t}\n\t\t}\n\n\t\tprivate boolean hasNext() {\n\t\t\treturn tok != null && tok.hasMoreTokens();\n\t\t}\n\n\t\tpublic String next() throws IOException {\n\t\t\tgetLine();\n\t\t\treturn tok.nextToken();\n\t\t}\n\n\t\tpublic int nextInt() throws IOException {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\t\t\n\t\tpublic long nextLong() throws IOException {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\t// 他のnextXXXもXXX.parseXXX()メソッドを使って作れるので省略\n\n\t\tpublic void close() throws IOException {\n\t\t\tbr.close();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\n\t\tString input = br.readLine();\n\t\tint inputAns = Integer.parseInt(br.readLine());\n\n\t\t//真面目に計算する方\n\t\tint numArray1[] = new int[input.length()/2 + 1];\n\t\t//左からしか計算しない方\n\t\tint numArray2[] = new int[input.length()/2 + 1];\n\n\t\tfor(int i = 0; i < numArray1.length; i++){\n\t\t\tnumArray1[i] = numArray2[i] = input.charAt(i*2) - '0';\n\t\t}\n\n\t\tint ans1=0, ans2=0;\n\n\t\t//真面目に計算する方（掛け算->足し算で考える）\n\t\tfor(int i = 0; i < input.length() / 2; i++){\n\t\t\tif(input.charAt(i*2 + 1) == '*'){\n\t\t\t\tnumArray1[i + 1] = numArray1[i]*numArray1[i+1];\n\t\t\t\tnumArray1[i] = 0;\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0; i < numArray1.length; i++){\n\t\t\tans1 += numArray1[i];\n\t\t}\n\n\t\t//左から計算する方\n\t\tfor(int i = 0; i < input.length() / 2; i++){\n\t\t\tif(input.charAt(i*2 + 1) == '*'){\n\t\t\t\tnumArray2[i + 1] = numArray2[i]*numArray2[i+1];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnumArray2[i + 1] = numArray2[i]+numArray2[i+1];\n\t\t\t}\n\t\t}\n\t\tans2 = numArray2[numArray2.length - 1];\n\n\t\tString result = null;\n\t\tif(ans1 == inputAns && ans2 != inputAns){\n\t\t\tresult = \"M\";\n\t\t}\n\t\telse if(ans1 != inputAns && ans2 == inputAns){\n\t\t\tresult = \"L\";\n\t\t}\n\t\telse if(ans1 == inputAns && ans2 == inputAns){\n\t\t\tresult = \"U\";\n\t\t}\n\t\telse {\n\t\t\tresult = \"I\";\n\t\t}\n\n\t\tSystem.out.println(result);\n\t}\n\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main{\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\tstatic final double EPS=1e-10;\n\n\tstatic void solve(){\n\t\tchar[] ex=ir.next().toCharArray();\n\t\tint n=ir.nextInt();\n\t\tint m=0;\n\t\tfor(int i=1;i<=ex.length;i+=2){\n\t\t\tif(i==ex.length){\n\t\t\t\tm+=ex[ex.length-1]-'0';\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(ex[i]=='+'){\n\t\t\t\tm+=ex[i-1]-'0';\n\t\t\t}\n\t\t\telse{\n\t\t\t\tint r=ex[i-1]-'0';\n\t\t\t\twhile(i<ex.length&&ex[i]!='+'){\n\t\t\t\t\ti+=2;\n\t\t\t\t\tr*=ex[i-1]-'0';\n\t\t\t\t}\n\t\t\t\tm+=r;\n\t\t\t}\n\t\t}\n//\t\tout.println(m);\n\t\tint l=ex[0]-'0';\n\t\tfor(int i=1;i<ex.length;i+=2){\n\t\t\tif(ex[i]=='+')\n\t\t\t\tl+=ex[i+1]-'0';\n\t\t\telse\n\t\t\t\tl*=ex[i+1]-'0';\n\t\t}\n\t\tboolean M=m==n;\n\t\tboolean L=l==n;\n\t\tif(M&&L) out.println(\"U\");\n\t\telse if(M) out.println(\"M\");\n\t\telse if(L) out.println(\"L\");\n\t\telse out.println(\"I\");\n\t}\n\n\tstatic String code(String s,int k){\n\t\tif(s.length()<=k) return s;\n\t\treturn s.substring(0,k);\n\t}\n\n\tpublic static void main(String[] args) throws Exception{\n\t\tir=new InputReader(System.in);\n\t\tout=new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer=new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {this.in=in; this.curbuf=this.lenbuf=0;}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif(curbuf>=lenbuf){\n\t\t\t\tcurbuf= 0;\n\t\t\t\ttry{\n\t\t\t\t\tlenbuf=in.read(buffer);\n\t\t\t\t}catch(IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif(lenbuf<=0) return false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte(){if(hasNextByte()) return buffer[curbuf++]; else return -1;}\n\n\t\tprivate boolean isSpaceChar(int c){return !(c>=33&&c<=126);}\n\n\t\tprivate void skip(){while(hasNextByte()&&isSpaceChar(buffer[curbuf])) curbuf++;}\n\n\t\tpublic boolean hasNext(){skip(); return hasNextByte();}\n\n\t\tpublic String next(){\n\t\t\tif(!hasNext()) throw new NoSuchElementException();\n\t\t\tStringBuilder sb=new StringBuilder();\n\t\t\tint b=readByte();\n\t\t\twhile(!isSpaceChar(b)){\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb=readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif(!hasNext()) throw new NoSuchElementException();\n\t\t\tint c=readByte();\n\t\t\twhile (isSpaceChar(c)) c=readByte();\n\t\t\tboolean minus=false;\n\t\t\tif (c=='-') {\n\t\t\t\tminus=true;\n\t\t\t\tc=readByte();\n\t\t\t}\n\t\t\tint res=0;\n\t\t\tdo{\n\t\t\t\tif(c<'0'||c>'9') throw new InputMismatchException();\n\t\t\t\tres=res*10+c-'0';\n\t\t\t\tc=readByte();\n\t\t\t}while(!isSpaceChar(c));\n\t\t\treturn (minus)?-res:res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif(!hasNext()) throw new NoSuchElementException();\n\t\t\tint c=readByte();\n\t\t\twhile (isSpaceChar(c)) c=readByte();\n\t\t\tboolean minus=false;\n\t\t\tif (c=='-') {\n\t\t\t\tminus=true;\n\t\t\t\tc=readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo{\n\t\t\t\tif(c<'0'||c>'9') throw new InputMismatchException();\n\t\t\t\tres=res*10+c-'0';\n\t\t\t\tc=readByte();\n\t\t\t}while(!isSpaceChar(c));\n\t\t\treturn (minus)?-res:res;\n\t\t}\n\n\t\tpublic double nextDouble(){return Double.parseDouble(next());}\n\n\t\tpublic int[] nextIntArray(int n){\n\t\t\tint[] a=new int[n];\n\t\t\tfor(int i=0;i<n;i++) a[i]=nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n){\n\t\t\tlong[] a=new long[n];\n\t\t\tfor(int i=0;i<n;i++) a[i]=nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n,int m){\n\t\t\tchar[][] map=new char[n][m];\n\t\t\tfor(int i=0;i<n;i++) map[i]=next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.ArrayList;\nimport java.util.Scanner;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner s = new Scanner(System.in);\n\t\tString expr = s.nextLine();\n\t\tlong answer = Long.parseLong(s.nextLine());\n\t\tlong bobs = bobsAnswer(expr);\n\t\tlong calc = calculate(expr);\n\t\tif (bobs == answer) {\n\t\t\tSystem.out.println(bobs == calc ? \"U\" : \"L\");\n\t\t} else {\n\t\t\tSystem.out.println(calc == answer ? \"M\" : \"I\");\n\t\t}\n\t}\n\n\tprivate static long calculate(String expr) {\n\t\tArrayList<String> tokens = lex(expr);\n\t\twhile(tokens.size() > 1) {\n\t\t\tfor(int i = 0; i < tokens.size(); i++) {\n\t\t\t\tif (tokens.get(i).equals(\"*\")) {\n\t\t\t\t\tlong v = Long.parseLong(tokens.get(i-1)) * Long.parseLong(tokens.get(i+1));\n\t\t\t\t\ttokens.set(i, String.valueOf(v));\n\t\t\t\t\ttokens.remove(i+1);\n\t\t\t\t\ttokens.remove(i-1);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlong total = 0L;\n\t\t\tfor(String token : tokens) {\n\t\t\t\tif (\"+\".equals(token)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\ttotal += Long.parseLong(token);\n\t\t\t}\n\t\t\treturn total;\n\t\t}\n\t\treturn Long.parseLong(tokens.get(0));\n\t}\n\n\tprivate static ArrayList<String> lex(String expr) {\n\t\tArrayList<String> tokens = new ArrayList<String>();\n\t\tString[] nums = expr.split(\"\\\\+|\\\\*\");\n\t\tString[] symbol = expr.split(\"[0-9]+\");\n\t\tfor(int i = 1; i < symbol.length; i++) {\n\t\t\ttokens.add(nums[i-1]);\n\t\t\ttokens.add(symbol[i]);\n\t\t}\n\t\ttokens.add(nums[nums.length-1]);\n\t\treturn tokens;\n\t}\n\n\tprivate static long bobsAnswer(String expr) {\n\t\tArrayList<String> tokens = lex(expr);\n\t\tif (tokens.size() <= 1) {\n\t\t\treturn Long.parseLong(tokens.get(0));\n\t\t}\n\t\tlong total = Long.parseLong(tokens.get(0));\n\t\tfor(int i = 1; i < tokens.size(); i+=2) {\n\t\t\tlong next = Long.parseLong(tokens.get(i+1));\n\t\t\tif (\"+\".equals(tokens.get(i))) {\n\t\t\t\ttotal += next;\t\n\t\t\t} else {\n\t\t\t\ttotal *= next;\n\t\t\t}\n\t\t}\n\t\treturn total;\n\t}\n\t\n}"
  },
  {
    "language": "C#",
    "code": "using System.Linq;\nusing System.Collections.Generic;\nusing System;\n\npublic class hello\n{\n    public static void Main()\n    {\n        var a = new List<int>();\n        var a2 = new List<int>();\n        var b = new List<int>();\n        var b2 = new List<int>();\n        var s = Console.ReadLine().Trim();\n        for (int i = 0; i < s.Length; i++)\n        {\n            if (i % 2 == 0)\n            {\n                var ww = int.Parse(s[i].ToString());\n                a.Add(ww); a2.Add(ww);\n            }\n            else if (s[i] == '+') { b.Add(0); b2.Add(0); }\n            else { b.Add(1); b2.Add(1); }\n        }\n        var norm = getNomal(a, b);\n        var left = getFromLeft(a2, b2);\n        var bob = int.Parse(Console.ReadLine().Trim());\n        string res;\n        if (bob == norm && bob != left) res = \"M\";\n        else if (bob != norm && bob == left) res = \"L\";\n        else if (bob == norm && bob == left) res = \"U\";\n        else res = \"I\";\n        Console.WriteLine(res);\n    }\n    public static int getFromLeft(List<int> a, List<int> b)\n    {\n        for (int i = 0; i < b.Count(); i++)\n        {\n            if (b[i] == 0) a[i + 1] += a[i];\n            else a[i + 1] *= a[i];\n        }\n        return a[a.Count() - 1];\n    }\n    public static int getNomal(List<int> a, List<int> b)\n    {\n        while (true)\n        {\n            if (b.Sum() == 0) return a.Sum();\n            for (int i = 0; i < b.Count(); i++)\n                if (b[i] == 1)\n                {\n                    a[i] *= a[i + 1];\n                    a.RemoveAt(i + 1);\n                    b.RemoveAt(i);\n                }\n        }\n    }\n}\n"
  },
  {
    "language": "C#",
    "code": "using System.Linq;\nusing System.Collections.Generic;\nusing System;\n\npublic class hello\n{\n    public static void Main()\n    {\n        var a = new List<int>();\n        var a2 = new List<int>();\n        var b = new List<int>();\n        var b2 = new List<int>();\n        var s = Console.ReadLine().Trim();\n        for (int i = 0; i < s.Length; i++)\n        {\n            if (i % 2 == 0) { a.Add(int.Parse(s[i].ToString())); a2.Add(int.Parse(s[i].ToString())); }\n            else if (s[i] == '+') { b.Add(0); b2.Add(0); }\n            else { b.Add(1); b2.Add(1); } \n        }\n        var norm = getNomal(a, b);\n        var left = getFromLeft(a2, b2);\n        var bob = int.Parse(Console.ReadLine().Trim());\n        string res;\n        if (bob == norm && bob != left) res = \"M\";\n        else if (bob != norm && bob == left) res = \"L\";\n        else if (bob == norm && bob == left) res = \"U\";\n        else res = \"I\";\n        Console.WriteLine(res);\n    }\n    public static int getFromLeft(List<int> a, List<int> b)\n    {\n        while (true)\n        {\n            if (a.Count() == 1) return a[0];\n            if (b[0] == 0) a[0] += a[1];\n            else a[0] *= a[1];\n            a.RemoveAt(1);\n            b.RemoveAt(0);\n        }\n    }\n    public static int getNomal(List<int> a, List<int> b)\n    {\n        while (true)\n        {\n            if (b.Sum() == 0) return a.Sum();\n            for (int i = 0; i < b.Count(); i++)\n                if (b[i] == 1)\n                {\n                    a[i] *= a[i + 1];\n                    a.RemoveAt(i + 1);\n                    b.RemoveAt(i);\n                }\n        }\n    }\n}\n"
  },
  {
    "language": "Ruby",
    "code": "s = gets.chomp\nn = gets.to_i\n\nans1 = eval(s)\n\na = s.split(/[+*]/).map(&:to_i)\nop = s.chars.select {|c| c =~ /[+*]/ }\nans2 = a[0]\nop.each_index do |i|\n    if op[i] == '+'\n        ans2 += a[i + 1]\n    else\n        ans2 *= a[i + 1]\n    end\nend\n\nif [ans1, ans2] == [n, n]\n    puts \"U\"\nelsif ans1 == n\n    puts \"M\"\nelsif ans2 == n\n    puts \"L\"\nelse\n    puts \"I\"\nend\n"
  },
  {
    "language": "Ruby",
    "code": "### main\n\nexpr = gets.strip\nbans = gets.to_i\n\nmf = eval expr\n\nlr = expr[0].to_i\nk = 1\nwhile k < expr.length\n  if expr[k] == '+'\n    lr += expr[k + 1].to_i\n  else\n    lr *= expr[k + 1].to_i\n  end\n  k += 2\nend\n\nidx = 0\nidx |= 1 if bans == mf\nidx |= 2 if bans == lr\n\nputs [\"I\", \"M\", \"L\", \"U\"][idx]"
  },
  {
    "language": "Ruby",
    "code": "s = gets.chomp\nans = gets.to_i\nres1 = eval(s)\ns = s.split('')\nn = s.shift\nres2 = s.each_slice(2).reduce(n.to_i){ |res, (c, m)| c == '+' ? res + m.to_i : res * m.to_i }\nif res1 == ans && res2 == ans\n  puts 'U'\nelsif res1 == ans\n  puts 'M'\nelsif res2 == ans\n  puts 'L'\nelse\n  puts 'I'\nend"
  },
  {
    "language": "Ruby",
    "code": "s = gets.chomp\nn = gets.to_i\nlr = 0\nop = \"+\"\ns.each_char do |c|\n    if c == \"+\" || c == \"*\"\n        op = c\n    else\n        if op == \"+\"\n            lr += c.to_i\n        else\n            lr *= c.to_i\n        end\n    end\nend\nwhile s.include?(\"*\")\n    opi = s.index(\"*\")\n    rep = (s[opi - 1].to_i * s[opi + 1].to_i).to_s\n    s.sub!(/.\\*./,rep)\nend\nma = 0\ns.each_char do |c|\n    next if c == \"+\"\n    ma += c.to_i\nend\nif n == lr\n    puts \"L\" if n != ma\n    puts \"U\" if n == ma\nelse\n    puts \"I\" if n != ma\n    puts \"M\" if n == ma\nend"
  },
  {
    "language": "Ruby",
    "code": "def l str\n    result = str[0].to_i\n    ((str.length - 1) / 2).times{|i|\n        result += str[i * 2 + 2].to_i if str[i * 2 + 1] == \"+\"\n        result *= str[i * 2 + 2].to_i if str[i * 2 + 1] == \"*\"\n    }\n    result\nend\n\ndef m str\n    str.split(\"+\").map{|x| l x}.inject(:+)\nend\n\nexpression = gets.chomp\nbob = gets.to_i\n\na = m(expression) == bob\nb = l(expression) == bob\nanswer = \"M\"\nanswer = \"L\" if !a && b\nanswer = \"U\" if a && b\nanswer = \"I\" if !a && !b\nputs answer\n"
  },
  {
    "language": "Ruby",
    "code": "e = gets.chomp\na = gets.to_i\n\nx = eval e\n\nclass Fixnum\n    alias / +\nend\n\ny = eval(e.tr \"+\", \"/\")\n\nputs x == a && y == a ? ?U\n             : x == a ? ?M\n             : y == a ? ?L\n                      : ?I"
  },
  {
    "language": "Ruby",
    "code": "e = gets.chomp\na = gets.to_i\n\nx = eval e\n\nclass Fixnum\n    alias / -\nend\n\ny = eval(e.tr \"+\", \"/\")\n\nputs x == a && y == a ? ?U\n             : x == a ? ?M\n             : y == a ? ?L\n                      : ?I"
  },
  {
    "language": "Ruby",
    "code": "s = gets.chomp\nn = gets.to_i\nlr = 0\nop = \"+\"\ns.each_char do |c|\n    if c == \"+\" || c == \"*\"\n        op = c\n    else\n        if op == \"+\"\n            lr += c.to_i\n        else\n            lr *= c.to_i\n        end\n    end\nend\nwhile s.include?(\"*\")\n    opi = s.index(\"*\")\n    l = opi - 1\n    while s[l - 1] =~ /[0-9]/ && l > 0\n        l -= 1\n    end\n    r = opi + 1\n    while s[r + 1] =~ /[0-9]/ && r < s.length - 1\n        r += 1\n    end\n    rep = (s[l..(opi - 1)].to_i * s[(opi + 1)..r].to_i).to_s\n    s[l..r] = rep\nend\nma = 0\ns.each_char do |c|\n    next if c == \"+\"\n    ma += c.to_i\nend\nif n == lr\n    puts \"L\" if n != ma\n    puts \"U\" if n == ma\nelse\n    puts \"I\" if n != ma\n    puts \"M\" if n == ma\nend"
  },
  {
    "language": "Ruby",
    "code": "s = gets.chomp\nn = gets.to_i\nlr = 0\nop = \"+\"\ns.each_char do |c|\n    if c == \"+\" || c == \"*\"\n        op = c\n    else\n        if op == \"+\"\n            lr += c.to_i\n        else\n            lr *= c.to_i\n        end\n    end\nend\nma = eval(s)\nif n == lr\n    puts \"L\" if n != ma\n    puts \"U\" if n == ma\nelse\n    puts \"I\" if n != ma\n    puts \"M\" if n == ma\nend"
  },
  {
    "language": "Ruby",
    "code": "s = gets.chomp\nn = gets.to_i\nlr = 0\nop = \"+\"\ns.each_char do |c|\n    if c == \"+\" || c == \"*\"\n        op = c\n    else\n        if op == \"+\"\n            lr += c.to_i\n        else\n            lr *= c.to_i\n        end\n    end\nend\nwhile s.include?(\"*\")\n    opi = s.index(\"*\")\n    l = opi - 1\n    while s[l - 1] =~ /[0-9]/ && l > 0\n        l -= 1\n    end\n    r = opi + 1\n    while s[r + 1] =~ /[0-9]/ && r < s.length - 1\n        r += 1\n    end\n    rep = (s[l..(opi - 1)].to_i * s[(opi + 1)..r].to_i).to_s\n    s[l..r] = rep\nend\nma = s.split(\"+\").map(&:to_i).inject(:+)\nif n == lr\n    puts \"L\" if n != ma\n    puts \"U\" if n == ma\nelse\n    puts \"I\" if n != ma\n    puts \"M\" if n == ma\nend"
  },
  {
    "language": "D",
    "code": "void main(){\n  import std.stdio, std.string, std.conv, std.algorithm;\n  import std.array;\n  \n  auto expr=readln.chomp.to!(char[]);\n  int res; rd(res);\n\n  auto n=expr.length;\n  int[] a; a~=(expr[0]-'0');\n  for(auto i=1; i<n; i+=2){\n    if(expr[i]=='+') a~=(expr[i+1]-'0');\n    else{\n      auto bk=a.back; a.popBack;\n      a~=(bk*(expr[i+1]-'0'));\n    }\n  }\n  auto res1=sum(a);\n\n  int res2=(expr[0]-'0');\n  for(auto i=1; i<n; i+=2){\n    if(expr[i]=='+') res2+=(expr[i+1]-'0');\n    else res2*=(expr[i+1]-'0');\n  }\n  \n  if(res1==res2 && res1==res) writeln(\"U\");\n  else if(res1==res) writeln(\"M\");\n  else if(res2==res) writeln(\"L\");\n  else writeln(\"I\");\n}\n\nvoid rd(T...)(ref T x){\n  import std.stdio, std.string, std.conv;\n  auto l=readln.split;\n  assert(l.length==x.length);\n  foreach(i, ref e; x){\n    e=l[i].to!(typeof(e));\n  }\n}\nvoid wr(T...)(T x){\n  import std.stdio;\n  foreach(e; x) write(e, \" \");\n  writeln();\n}"
  },
  {
    "language": "Python",
    "code": "def lr_op(expr, length):\n\top = {\"+\": lambda x,y : x + y, \"*\": lambda x,y : x * y }\n\tresult = expr[0]\n\tinc = 1\n\twhile inc < length:\n\t\tresult = op[expr[inc]](result,expr[inc+1])\n\t\tinc += 2\n\treturn result\ninputs = raw_input()\nlength = len(inputs)\nexpr = [int(inputs[i]) if i % 2 == 0 else inputs[i] for i in range(length)]\nbob = int(raw_input())\nL = lr_op(expr, length)\ninc = 1\nwhile inc < length:\n\tif expr[inc] == \"*\":\n\t\texpr[inc] = expr[inc-1] * expr[inc+1]\n\t\tfor i in range(2):\n\t\t\tdel expr[inc-1+i]\n\t\tlength -= 2\n\telse :\n\t\tinc += 2\nM = lr_op(expr, length)\nif M == bob:\n\tprint \"U\" if L == bob else \"M\"\nelse :\n\tprint \"L\" if L == bob else \"I\""
  },
  {
    "language": "Python",
    "code": "#!usr/bin/env python3\nfrom collections import defaultdict\nfrom collections import deque\nfrom heapq import heappush, heappop\nimport sys\nimport math\nimport bisect\nimport random\nimport itertools\nsys.setrecursionlimit(10**5)\nstdin = sys.stdin\nbisect_left = bisect.bisect_left\nbisect_right = bisect.bisect_right\ndef LI(): return list(map(int, stdin.readline().split()))\ndef LF(): return list(map(float, stdin.readline().split()))\ndef LI_(): return list(map(lambda x: int(x)-1, stdin.readline().split()))\ndef II(): return int(stdin.readline())\ndef IF(): return float(stdin.readline())\ndef LS(): return list(map(list, stdin.readline().split()))\ndef S(): return list(stdin.readline().rstrip())\ndef IR(n): return [II() for _ in range(n)]\ndef LIR(n): return [LI() for _ in range(n)]\ndef FR(n): return [IF() for _ in range(n)]\ndef LFR(n): return [LI() for _ in range(n)]\ndef LIR_(n): return [LI_() for _ in range(n)]\ndef SR(n): return [S() for _ in range(n)]\ndef LSR(n): return [LS() for _ in range(n)]\nmod = 1000000007\ninf = float('INF')\n\n#A\ndef A():\n    s = S()\n    m = II()\n    ans = [\"I\", \"L\", \"M\", \"U\"]\n    nu = 0\n    stack = []\n    bf = int(s[0])\n    for num,si in enumerate(s):\n        if si == \"+\":\n            bf += int(s[num+1])\n        elif si == \"*\":\n            bf *= int(s[num + 1])\n    if bf == m:\n        nu += 1\n    stack = []\n    bf = 0\n    for num, si in enumerate(s):\n        if si == \"*\":\n            s[num + 1] = int(s[num + 1]) * int(s[num - 1])\n            s[num - 1] = 0\n    for si in s:\n        if si != \"*\" and si != \"+\":\n            bf += int(si)\n    if bf == m:\n        nu += 2\n    print(ans[nu])    \n\n    return\n\n#B\ndef B():\n    return\n\n#C\ndef C():\n    return\n\n#D\ndef D():\n    return\n\n#E\ndef E():\n    return\n\n#F\ndef F():\n    return\n\n#G\ndef G():\n    return\n\n#H\ndef H():\n    return\n\n#Solve\nif __name__ == '__main__':\n    A()\n\n"
  },
  {
    "language": "Python",
    "code": "def f(s):\n    return eval(s)\n    \ndef g(s):\n    ret = ord(s[0])-48\n    i = 1\n    while i < len(s):\n        if s[i] == '+':\n            ret += ord(s[i+1])-48\n        else:\n            ret *= ord(s[i+1])-48\n        i += 2\n    return ret\n\ns = input()\nn = int(input())\nf1, f2 = (n == f(s)), (n == g(s))\nif f1 and f2:\n    print(\"U\")\nelif f1:\n    print(\"M\")\nelif f2:\n    print(\"L\")\nelse:\n    print(\"I\")\n"
  },
  {
    "language": "Python",
    "code": "def left2right(formula):\n    ans = int(formula[0])\n    for i in range(1,len(formula),2):\n        ans = eval(str(ans) + formula[i:i+2])\n    return ans\n\nformula = input()\nval = int(input())\nif left2right(formula) == val:\n    print('U' if eval(formula) == val else 'L')\nelse:\n    print('M' if eval(formula) == val else 'I')"
  },
  {
    "language": "Python",
    "code": "s = raw_input()\na = int(raw_input())\nprint \"IMLU\"[int(eval(s) == a)+int(eval(\"(\"*s.count(\"*\")+s.replace(\"*\",\")*\"))== a)<<1]"
  },
  {
    "language": "Python",
    "code": "s = raw_input()\na = int(raw_input())\nm = eval(s)\nl = eval(\"(\"*s.count(\"*\")+s.replace(\"*\",\")*\"))\nprint \"U\" if a == m == l else \"M\" if a == m != l else \"L\" if a == l else \"I\""
  },
  {
    "language": "Python",
    "code": "# -*- coding: utf-8 -*-\n\nS = input()\nbob = int(input())\n\nM = eval(S)\n\nL = int(S[0])\n\nfor o, v in zip(S[1::2], S[2::2]):\n    if o == \"*\":\n        L *= int(v)\n    else:\n        L += int(v)\n\nif M == L == bob:\n    print(\"U\")\nelif M == bob:\n    print(\"M\")\nelif L == bob:\n    print(\"L\")\nelse:\n    print(\"I\")\n"
  },
  {
    "language": "Python",
    "code": "s = input()\nt = int(input())\ne1 = eval(s)\n\ne2 = int(s[0])\ni = 1\nwhile i < len(s):\n    x = int(s[i+1])\n    if s[i] == '+':\n        e2 += x\n    else:\n        e2 *= x\n    i += 2\n\nif e1 == t and e2 == t:\n    print(\"U\")\nelif e1 == t:\n    print(\"M\")\nelif e2 == t:\n    print(\"L\")\nelse:\n    print(\"I\")"
  },
  {
    "language": "Python",
    "code": "s = raw_input()\na = int(raw_input())\nprint \"IMLU\"[int(eval(s) == a)+int(eval(\"(\"*s.count(\"*\")+s.replace(\"*\",\")*\")) == a)*2]"
  },
  {
    "language": "Python",
    "code": "s,ans=input(),int(input())\nx=int(s[0])\nfor i in range(1,len(s),2):\n  y=int(s[i+1])\n  x=x*y if s[i]=='*' else x+y\nprint(\"IMLU\"[int(eval(s)==ans)+(int(x==ans)<<1)])"
  },
  {
    "language": "Python",
    "code": "import re\nclass c(int):\n    def __add__(self,n):\n        return c(int(self)+int(n))\n    def __mul__(self,n):\n        return c(int(self)*int(n))\n\ns=input()\nd=int(input())\na=eval(re.sub(r'(\\d+)',r'c(\\1)',s))\nb=int(s[0])\nfor i in range(1,len(s),2):\n    if s[i]=='+':b+=int(s[i+1])\n    else:b*=int(s[i+1])\nif(a==b==d):e='U'\nelif(a==d):e='M'\nelif(b==d):e='L'\nelse:e='I'\nprint(e)"
  },
  {
    "language": "Python",
    "code": "# -*- coding: utf-8 -*-\n\ndef solvM(e):\n  p = [ 0 ]\n\n  def term():\n    res = 0\n    while p[ 0 ] < len ( e ) and \"0\" <= e[ p[ 0 ] ] <= \"9\":\n      res = res * 10 + ( ord ( e[ p[ 0 ] ] ) - ord ( \"0\" ) )\n      p[ 0 ] = p[ 0 ] + 1\n    return ( res )\n\n  def fact():\n    lv = term ( )\n    while p[ 0 ] < len ( e ):\n      if ( e[ p[ 0 ] ] == \"*\" ):\n        p[ 0 ] = p[ 0 ] + 1\n        lv = lv * term ( )\n      else:\n        break\n    return ( lv )\n\n  def expr():\n    lv = fact ( )\n    while p[ 0 ] < len ( e ):\n      if ( e[ p[ 0 ] ] == \"+\" ):\n        p[ 0 ] = p[ 0 ] + 1\n        lv = lv + fact ( )\n      else:\n        break\n    return ( lv )\n\n  return expr ( )\n\ndef solvL(e):\n  p = 0\n\n  lv = 0\n  while p < len ( e ) and \"0\" <= e[ p ] <= \"9\":\n    lv = lv * 10 + ord ( e[ p ] ) - ord ( \"0\" )\n    p = p + 1\n\n  while p < len ( e ):\n    op = e[ p ]\n    p = p + 1\n\n    rv = 0\n    while p < len ( e ) and \"0\" <= e[ p ] <= \"9\":\n      rv = rv * 10 + ord ( e[ p ] ) - ord ( \"0\" )\n      p = p + 1\n\n    if op == \"+\": \n      lv = lv + rv\n    else:\n      lv = lv * rv\n\n  return ( lv )\n\ne = input ( )\nr = int ( input ( ) )\nm = solvM ( e )\nl = solvL ( e )\n\nif ( m == r and l == r ):\n  print ( \"U\" )\nelif ( m == r ):\n  print ( \"M\" )\nelif ( l == r ):\n  print ( \"L\" )\nelse:\n  print ( \"I\" )"
  },
  {
    "language": "Python",
    "code": "s = raw_input()\na = int(raw_input())\nm = eval(s)\nl = eval(\"(\"*s.count(\"*\")+s.replace(\"*\",\")*\"))\nprint \"U\" if a == m == l else \"M\" if a == m else \"L\" if a == l else \"I\""
  },
  {
    "language": "Python",
    "code": "s,c=input(),int(input())\na=eval(s)\nb=int(s[0])\nfor i in range(1,len(s),2):b=b+int(s[i+1]) if s[i]=='+' else b*int(s[i+1])\nif(a==b==c):e='U'\nelif(a==c):e='M'\nelif(b==c):e='L'\nelse:e='I'\nprint(e)"
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,random,time,copy,functools\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 998244353\n\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\n\n\ndef main():\n    rr = []\n\n    while True:\n        a = [c for c in S()]\n        l = len(a)\n        s = I()\n        t = int(a[0])\n        for i in range(len(a)//2):\n            if a[i*2+1] == '+':\n                t += int(a[i*2+2])\n            else:\n                t *= int(a[i*2+2])\n        u = eval(''.join(a))\n        r = 'I'\n        if s == u:\n            if s == t:\n                r = 'U'\n            else:\n                r = 'M'\n        elif s == t:\n            r = 'L'\n\n        rr.append(r)\n        break\n\n\n    return '\\n'.join(map(str, rr))\n\n\nprint(main())\n\n\n"
  },
  {
    "language": "Python",
    "code": "s = '+'+input()\np = int(input())\nn = 0\nfor a in [i+j for (i,j) in zip(s[::2], s[1::2])]:\n    n = eval(str(n)+a)\nf = 1 if n==p else 0\nf += 2 if eval(s)==p else 0\nprint('ILMU'[f])\n"
  },
  {
    "language": "Python",
    "code": "#!usr/bin/env python3\nfrom collections import defaultdict\nfrom collections import deque\nfrom heapq import heappush, heappop\nimport sys\nimport math\nimport bisect\nimport random\ndef LI(): return list(map(int, sys.stdin.readline().split()))\ndef I(): return int(sys.stdin.readline())\ndef LS():return list(map(list, sys.stdin.readline().split()))\ndef S(): return list(sys.stdin.readline())[:-1]\ndef IR(n):\n    l = [None for i in range(n)]\n    for i in range(n):l[i] = I()\n    return l\ndef LIR(n):\n    l = [None for i in range(n)]\n    for i in range(n):l[i] = LI()\n    return l\ndef SR(n):\n    l = [None for i in range(n)]\n    for i in range(n):l[i] = S()\n    return l\ndef LSR(n):\n    l = [None for i in range(n)]\n    for i in range(n):l[i] = LS()\n    return l\nsys.setrecursionlimit(1000000)\nmod = 1000000007\n\n#A\ndef A():\n    s = input()\n    c = I()\n    a = eval(s)\n    b = int(s[0])\n    n = len(s)\n    if n == 1:\n        if int(s[0]) == c:\n            print(\"U\")\n        else:\n            print(\"I\")\n        quit()\n    key = 0 if s[1] == \"+\" else 1\n    for i in range(2,n):\n        if not i%2:\n            if key:\n                b *= int(s[i])\n            else:\n                b += int(s[i])\n        else:\n            key = 0 if s[i] == \"+\" else 1\n    if a == b:\n        if a == c:\n            print(\"U\")\n        else:\n            print(\"I\")\n    elif a == c:\n        print(\"M\")\n    elif b == c:\n        print(\"L\")\n    else:\n        print(\"I\")\n    return\n\n#B\ndef B():\n    return\n\n#C\ndef C():\n    return\n\n#D\ndef D():\n    return\n\n#E\ndef E():\n    return\n\n#F\ndef F():\n    return\n\n#G\ndef G():\n    return\n\n#H\ndef H():\n    return\n\n#I\ndef I_():\n    return\n\n#J\ndef J():\n    return\n\n#Solve\nif __name__ == \"__main__\":\n    A()\n\n"
  },
  {
    "language": "Python",
    "code": "s = input()\nl = len(s)\ndef parse1(s):\n    cur = 0\n    num = 0; res = 0; op = '+'\n    while cur < len(s):\n        if s[cur] in '+*':\n            if op is '+':\n                res += num\n            else:\n                res *= num\n            num = 0; op = s[cur]\n        else:\n            num = 10 * num + int(s[cur])\n        cur += 1\n    if op is '+':\n        res += num\n    else:\n        res *= num\n    return res\ndef parse2(s):\n    cur = 0\n    def number():\n        nonlocal cur\n        v = int(s[cur]); cur += 1\n        return v\n    def term():\n        nonlocal cur\n        res = 1\n        while 1:\n            res *= number()\n            if l <= cur or s[cur] != '*':\n                break\n            cur += 1\n        return res\n    def expr():\n        nonlocal cur\n        res = 0\n        while 1:\n            res += term()\n            if l <= cur or s[cur] != '+':\n                break\n            cur += 1 # '+'\n        return res\n    return expr()\nv = int(input())\nr1 = parse1(s) == v\nr2 = parse2(s) == v\nprint(\"ILMU\"[r1+2*r2])"
  },
  {
    "language": "Python",
    "code": "# coding: utf-8\nimport functools\n\ndef M(s):\n    s=s.split('+')\n    for i in range(len(s)):\n        if '*' in s[i]:\n            s[i]=functools.reduce(lambda x,y:str(int(x)*int(y)),s[i].split('*'))\n    return int(functools.reduce(lambda x,y:str(int(x)+int(y)),s))\n\ndef L(s):\n    ret=0\n    i=0\n    ope=1\n    while i<len(s):\n        if i%2==0:\n            if ope==1:\n                ret+=int(s[i])\n            else:\n                ret*=int(s[i])\n        else:\n            if s[i]=='+':\n                ope=1\n            else:\n                ope=2\n        i+=1\n    return ret\n\noriginal=input()\nans=int(input())\nf=0\nif ans==M(original):\n    f+=1\nif ans==L(original):\n    f+=2\n\nif f==0:\n    print('I')\nelif f==1:\n    print('M')\nelif f==2:\n    print('L')\nelse:\n    print('U')\n\n\n"
  }
]