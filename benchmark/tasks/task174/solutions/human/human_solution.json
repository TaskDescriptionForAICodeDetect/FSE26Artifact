[
  {
    "language": "C++",
    "code": "//49\n#include<iostream>\n#include<iomanip>\n\nusing namespace std;\n\nint tx,ty,bx,by;\n\n#define tox(c) (((c)-'A')%3)\n#define toy(c) (((c)-'A')/3)\n\n/*\nint tox(char c){\n  return (c-'A')%3;\n}\n\nint toy(char c){\n  return (c-'A')/3;\n}\n*/\n\ndouble cal(int r,int y,int x,double p){\n  if(r==0){\n    return (y==ty && x==tx)?p:0;\n  }else{\n    double a=0;\n    for(int i=0;i<5;i++){\n      static const int d[]={0,1,0,-1,0};\n      int nx=x+d[i];\n      int ny=y+d[i+1];\n      if(0<=nx&&nx<3&&0<=ny&&ny<3&&!(nx==bx&&ny==by)){\n\ta+=cal(r-1,ny,nx,p/4);\n      }else{\n\ta+=cal(r-1,y,x,p/4);\n      }\n    }\n    return a;\n  }\n}\n\nint main(){\n  for(int n;cin>>n,n;){\n    char s,t,b;\n    cin>>s>>t>>b;\n    tx=tox(t);\n    ty=toy(t);\n    bx=tox(b);\n    by=toy(b);\n    cout<<fixed<<setprecision(6)<<cal(n,toy(s),tox(s),1)<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef pair<int,int> P;\n\nint main() {\n    int N;\n    while (cin >> N, N) {\n        char s, t, b;\n        cin >> s >> t >> b;\n\n        int sx, sy;\n        sx = (s - 'A') / 3;\n        sy = (s - 'A') % 3;\n        int tx, ty;\n        tx = (t - 'A') / 3;\n        ty = (t - 'A') % 3;\n        int bx, by;\n        bx = (b - 'A') / 3;\n        by = (b - 'A') % 3;\n        vector<vector<vector<int> > > dp(N+1, vector<vector<int> >(3, vector<int>(3, 0)));\n        dp[0][sx][sy] = 1;\n        int dx[] = {1,0,-1,0};\n        int dy[] = {0,1,0,-1};\n        for (int i = 0; i < N; i++) {\n            for (int x = 0; x < 3; x++) {\n                for (int y = 0; y < 3; y++) {\n                    for (int j = 0; j < 4; j++) {\n                        int nx = x + dx[j];\n                        int ny = y + dy[j];\n                        if (0 <= nx && nx < 3 && 0 <= ny && ny < 3) {\n                            if (nx == bx && ny == by)\n                                dp[i+1][x][y] += dp[i][x][y];\n                            else\n                                dp[i+1][nx][ny] += dp[i][x][y];\n                        } else {\n                            dp[i+1][x][y] += dp[i][x][y];\n                        }\n                    }\n                }\n            }\n        }\n\n        double ans = 0.;\n        double p = 1.;\n        for (int i = 1; i <= N; i++) {\n            p /= 4.;\n        }\n        ans = p * dp[N][tx][ty];\n        printf(\"%0.9f\\n\", ans);\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <queue>\nusing namespace std;\n\ndouble solve(int n, int s, int t, int b)\n{\n  queue<pair<int,int> > q;\n  q.push(make_pair(n, s));\n  int cnt = 0;\n  while (!q.empty()) {\n    const pair<int,int> p = q.front();\n    q.pop();\n    if (p.first == 0) {\n      if (p.second == t) {\n        ++cnt;\n      }\n    } else {\n      for (int d = 0; d < 4; d++) {\n        static const int di[] = {-1, 1, 0, 0};\n        static const int dj[] = {0, 0, -1, 1};\n        const int k = (p.second / 3) + di[d];\n        const int l = (p.second % 3) + dj[d];\n        if (k < 0 || 3 <= k || l < 0 || 3 <= l) {\n          q.push(make_pair(p.first-1, p.second));\n        } else if (3*k+l == b) {\n          q.push(make_pair(p.first-1, p.second));\n        } else {\n          q.push(make_pair(p.first-1, 3*k+l));\n        }\n      }\n    }\n  }\n  return static_cast<double>(cnt) / pow(4.0, static_cast<double>(n));\n}\n\nint main()\n{\n  int n;\n  while (cin >> n && n != 0) {\n    char s, t, b;\n    cin >> s >> t >> b;\n    printf(\"%.8f\\n\",  solve(n, s-'A', t-'A', b-'A'));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <cstring>\nusing namespace std;\nstatic const double EPS = 1e-5;\ntypedef long long ll;\n\n\ndouble p[5][5];\ndouble ne[5][5];\n\nchar s,t,b;\n\n\nint main(){\n\tint n;\n\t\n\twhile(cin>>n){\n\t\tif(n==0)break;\n\t\t\n\t\tcin>>s>>t>>b;\n\t\t\n\t\ts-='A';\n\t\tt-='A';\n\t\tb-='A';\n\t\t\n\t\tfor(int i=0;i<5;i++){\n\t\t\tfor(int j=0;j<5;j++){\n\t\t\t\tp[i][j]=0;\n\t\t\t\tne[i][j]=0;\n\t\t\t}\n\t\t}\n\t\t\n\t\tp[s/3+1][s%3+1]=1;\n\t\t\n\t\twhile(n){\n\t\t\tn--;\n\t\t\tfor(int i=1;i<=3;i++){\n\t\t\t\tfor(int j=1;j<=3;j++){\n\t\t\t\t\tne[i][j]=(p[i+1][j]+p[i-1][j]+p[i][j+1]+p[i][j-1])/4;\n\t\t\t\t}\n\t\t\t}\n\t\t\tne[b/3+1][b%3+1]=0;\n\t\t\tmemcpy(p,ne,sizeof(ne));\n\t\t}\n\t\t\n\t\tprintf(\"%.8f\\n\",ne[t/3+1][t%3+1]);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<map>\n#include<cstdio>\n//ABC\n//DEF\n//GHI\nusing namespace std;;\ntypedef pair<int,int> P;\nint n,out,can,dx[]={0,0,-1,1},dy[]={1,-1,0,0},dp[3][3][16];\nint gox,goy,mox,moy,stx,sty;\nint func(int y,int x,int bat){\n\tif(dp[y][x][bat]>=0)\n\treturn dp[y][x][bat];\n\tif(bat==0){\n\t\tif(y==goy&&x==gox){\n\t\t\tcan++;\n\t\t\tout++;\n\t\t\treturn dp[y][x][bat]=1;\n\t\t}\n\t\tout++;\n\t\treturn 0;\n\t}\n\tint nx,ny,sum=0;\n\tfor(int i=0;i<4;i++){\n\t\tny=dy[i]+y;\n\t\tnx=dx[i]+x;\n\t\tif(!(ny>=0&&ny<3&&nx>=0&&nx<3)||(nx==mox&&ny==moy))\n\t\t\tsum+=func(y,x,bat-1);\n\t\telse\n\t\t\tsum+=func(ny,nx,bat-1);\n\t}\n\treturn dp[y][x][bat]=sum;\n}\nint main(){\n\twhile(cin>>n,n){\n\t\tfor(int i=0;i<3;i++)\n\t\tfor(int j=0;j<3;j++)\n\t\tfor(int k=0;k<=n;k++)\n\t\tdp[i][j][k]=-1;\n\t\tchar a[3];\n\t\tcan=0;\n\t\tout=0;\n\t\tint sx[3],sy[3];\n\t\tcin>>a[0]>>a[1]>>a[2];\n\t\tfor(int i=0;i<3;i++){\n\t\t\tif(a[i]=='A'){\n\t\t\t\tsy[i]=0;sx[i]=0;\n\t\t\t}else if(a[i]=='B'){\n\t\t\t\tsy[i]=0;sx[i]=1;\n\t\t\t}else if(a[i]=='C'){\n\t\t\t\tsy[i]=0;sx[i]=2;\n\t\t\t}else if(a[i]=='D'){\n\t\t\t\tsy[i]=1;sx[i]=0;\n\t\t\t}else if(a[i]=='E'){\n\t\t\t\tsy[i]=1;sx[i]=1;\n\t\t\t}else if(a[i]=='F'){\n\t\t\t\tsy[i]=1;sx[i]=2;\n\t\t\t}else if(a[i]=='G'){\n\t\t\t\tsy[i]=2;sx[i]=0;\n\t\t\t}else if(a[i]=='H'){\n\t\t\t\tsy[i]=2;sx[i]=1;\n\t\t\t}else if(a[i]=='I'){\n\t\t\t\tsy[i]=2;sx[i]=2;\n\t\t\t}\n\t\t}\n\t\tsty=sy[0];stx=sx[0];\n\t\tgoy=sy[1];gox=sx[1];\n\t\tmoy=sy[2];mox=sx[2];\n\t\tfunc(sty,stx,n);\n\t\tint pre=1;\n\t\tfor(int i=0;i<n;i++)\n\t\tpre*=4;\n\t\tprintf(\"%.8lf\\n\",(double)dp[sty][stx][n]/pre);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <set>\n#include <map>\n#include <list>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <ctype.h>\n#include <ctime>\n#include <cstdio>\n#include <vector>\n#include <string>\n#include <bitset>\n#include <cctype>\n#include <cstdlib>\n#include <cstring>\n#include <utility>\n#include <numeric>\n#include <complex>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <cassert>\n#include <iostream>\n#include <iterator>\n#include <algorithm>\n\nusing namespace std;\n//参考http://topcoder.g.hatena.ne.jp/isa_rentacs/20111114/1321278656 \n#define REP(i, x, n) for(int i = x; i < n; i++)\n#define rep(i, n) REP(i, 0, n)\n#define lengthof(x) (sizeof(x) / sizeof(*(x)))\n#define FILL(ptr, value) FILL_((ptr), sizeof(ptr)/sizeof(value), (value))\ntemplate <typename T>\nvoid FILL_(void * ptr, size_t size, T value){\n  std::fill((T*)ptr, (T*)ptr+size, value);\n}\n//4方向ベクトル→↑←↓\nint dx[] ={1,0,-1,0};\nint dy[] ={0,-1,0,1};\n\ndouble dp[16][9];\nint dir[4] = {1,3,-1,-3};\nint main()\n{\n  int n;\n  while(cin >>n,n){\n    fill((int*)dp,(int*)(dp+lengthof(dp)),0);\n    char temp;\n    int s,t,b,x,y;\n    cin >>temp;\n    s =temp -'A';\n    cin >>temp;\n    t =temp -'A';\n    cin >>temp;\n    b = temp -'A';\n    dp[0][s] = 1;\n    for(int i = 0;i < n;i++){\n      for(int j = 0;j < 9;j++){\n\tif(dp[i][j] ==0)\n\t  continue;\n\tx =j%3;\n\ty = j/3;\n\tfor(int k = 0;k < 4;k++){\n\t  if(0 <=x+dx[k]&&x +dx[k] < 3\n\t     &&0 <=y +dy[k]&&y +dy[k] <3\n\t     &&j+dir[k] !=b){\n\t    dp[i+1][j+dir[k]] +=dp[i][j]*0.25;\n\t  }\n\t  else\n\t    dp[i+1][j] +=dp[i][j]*0.25;\n\t}\n      }\n    }\n    printf(\"%.8lf\\n\",dp[n][t]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint dp[16][5][5];\nbool grid[5][5];\nconst int px[] = {1, 1, 1, 2, 2, 2, 3, 3, 3};\nconst int py[] = {1, 2, 3, 1, 2, 3, 1, 2, 3};\nconst int dx[] = {-1, 0, 1, 0, 0};\nconst int dy[] = {0, -1, 0, 1, 0};\n\nint main()\n{\n\tint n;\n\twhile (scanf(\"%d\", &n), n){\n\t\tmemset(dp, 0, sizeof(dp));\n\t\tmemset(grid, true, sizeof(grid));\n\t\t\n\t\tchar s, t, b;\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\ts -= 'A'; t -= 'A'; b -= 'A';\n\t\t\n\t\tfor (int i = 0; i < 9; i++){\n\t\t\tgrid[px[i]][py[i]] = (b == i);\n\t\t}\n\t\t\n\t\tdp[0][px[s]][py[s]] = 1;\n\t\tfor (int i = 0; i < n; i++){\n\t\t\tfor (int x = 1; x <= 3; x++){\n\t\t\t\tfor (int y = 1; y <= 3; y++){\n\t\t\t\t\tbool f = false;\n\t\t\t\t\tfor (int dir = 0; dir < 4; dir++){\n\t\t\t\t\t\tint tx = x + dx[dir];\n\t\t\t\t\t\tint ty = y + dy[dir];\n\t\t\t\t\t\tif (grid[tx][ty]){\n\t\t\t\t\t\t\t//if (f) continue;\n\t\t\t\t\t\t\tdp[i + 1][x][y] += dp[i][x][y];\n\t\t\t\t\t\t\t//f = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse dp[i + 1][tx][ty] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tint sum = 0;\n\t\tint num = 0;\n\t\tfor (int i = 0; i < 9; i++){\n\t\t\tsum += dp[n][px[i]][py[i]];\n\t\t\tnum += dp[n][px[i]][py[i]] * (i == t);\n\t\t}\n\t\t\n\t\tdouble res = (double)num / sum;\n\t\t//printf(\"%d %d\\n\", num, sum);\n\t\t\n\t\tprintf(\"%.8f\\n\", res);\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<map>\n#include<string>\n#include<vector>\n#include<algorithm>\n#include<queue>\n#include<set>\n#include<map>\nusing namespace std;\n\ndouble dp[16][9];\nint k, x, y, z;\nint b[9][4]={\n\t{1,3,-1,-1},\n\t{ 0,2,4,-1 },\n\t{ 1,5,-1,-1 },\n\t{ 0,4,6,-1 },\n\t{ 1,3,5,7 },\n\t{ 2,4,8,-1 },\n\t{ 3,7,-1,-1 },\n\t{ 4,6,8,-1 },\n\t{ 5,7,-1,-1 }\n};\nint main() {\n\twhile (cin >> k, k) {\n\t\tmemset(dp, 0, sizeof(dp));\n\t\tchar a, b, c; cin >> a >> b >> c;\n\t\tdp[0][a - 'A'] = 1;\n\t    y = b - 'A'; z = c - 'A';\n\t\tdouble S = 0;\n\t\tfor (int i = 0; i < k; i++) {\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tfor (int l = 0; l < 4; l++) {\n\t\t\t\t\tif (::b[j][l] == -1 || ::b[j][l] == z) {\n\t\t\t\t\t\tdp[i + 1][j] += dp[i][j] * 0.25;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[i + 1][::b[j][l]] += dp[i][j] * 0.25;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.10lf\\n\", dp[k][y]);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\nusing namespace std;\n\nconst int NMAX = 15;\n\nint index(char c){\n\treturn (int)c - 'A';\n}\n\ndouble dp[NMAX+1][3][3];\nint dx[] = {\n\t1, 0, -1, 0\n};\nint dy[] = {\n\t0, 1, 0 , -1\n};\n\nint main(){\n\tint n;\n\tchar s, t, b;\n\twhile(cin >> n){\n\t\tif(n == 0) break;\n\t\tcin >> s >> t >> b;\n\t\tint sx, sy;\n\t\tint tx, ty;\n\t\tint bx, by;\n\t\tsx = index(s) % 3;\n\t\tsy = index(s) / 3;\n\t\ttx = index(t) % 3;\n\t\tty = index(t) / 3;\n\t\tbx = index(b) % 3;\n\t\tby = index(b) / 3;\n\t\tfor(int i = 0; i <= NMAX; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tdp[i][j][k] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdp[0][ty][tx] = 1.0;\n\t\tfor(int i = 1; i <= n; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tif(j != by || k != bx){\n\t\t\t\t\t\tfor(int l = 0; l < 4; l++)\n\t\t\t\t\t\t\tif(j + dy[l] >= 0 && j + dy[l] < 3 && k + dx[l] >= 0\n\t\t\t\t\t\t\t\t&& k + dx[l] < 3 && (j + dy[l] != by || k + dx[l] != bx))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j][k] += dp[i-1][j+dy[l]][k+dx[l]] / 4;\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tdp[i][j][k] += dp[i-1][j][k] / 4;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tcout << dp[i][j][k] << \" \";\n\t\t\t\t}\n\t\t\t\tcout << endl;\n\t\t\t}\n\t\t}\n\t\tcout << fixed << setprecision(7) << dp[n][sy][sx] << endl;;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<iomanip>\nusing namespace std;\ndouble dp[3][3][16];\nchar map[3][3]={'A','B','C','D','E','F','G','H','I'};\nint main(){\n\tint n;\n\tchar s,t,d;\n\tint dx[4]={0,1,0,-1},dy[4]={1,0,-1,0};\n\twhile(true){\n\tcin>>n;\n\tif(n==0)break;\n\tcin>>s>>t>>d;\n\tfor(int i=0;i<3;i++){\n\t\tfor(int j=0;j<3;j++){\n\t\t\tfor(int k=0;k<=n;k++)dp[i][j][k]=0.0;\n\t\t\tif(map[i][j]==s)dp[i][j][0]=1.0;\n\t\t}\n\t}\n\tfor(int k=1;k<=n;k++){\n\t\tfor(int i=0;i<3;i++){\n\t\t\tfor(int j=0;j<3;j++){\n\t\t\t\tfor(int l=0;l<4;l++){\n\t\t\t\t\tif(j+dx[l]<0||j+dx[l]==3||i+dy[l]<0||i+dy[l]==3)\n\t\t\t\t\t\tdp[i][j][k]+=dp[i][j][k-1];\n\t\t\t\t\telse{\n\t\t\t\t\t\tif(map[j+dx[l]][i+dy[l]]==d)dp[i][j][k]+=dp[i][j][k-1];\n\t\t\t\t\t\telse dp[i][j][k]+=dp[i+dy[l]][j+dx[l]][k-1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdp[i][j][k]/=4.0;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=0;i<3;i++)for(int j=0;j<3;j++)if(map[i][j]==t)cout<<fixed<<setprecision(10)<<dp[i][j][n]<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "// AOJ 1020\n#include<iostream>\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\nusing namespace std;\n\ntypedef double number;\nint n;\nint sx, sy, tx, ty, bx, by;\nnumber room[3][3];\n\nvoid init() {\n  REP(x, 3) REP(y, 3) {\n    room[x][y] = 0;\n  }\n  room[sx][sy] = 1;\n}\n\nbool is_depot(int x, int y) {\n  return x == bx && y == by;\n}\n\nnumber in(int x, int y) {\n  if (x < 0 or 2 < x or y < 0 or 2 < y) return 0;\n  if (is_depot(x, y)) return 0;\n  return room[x][y];\n}\n\nnumber solve() {\n  init();\n  REP(i, n) {\n    number future[3][3];\n    REP(x, 3) REP(y,3) {\n      if (is_depot(x, y)) {\n        future[x][y] = 0;\n        continue;\n      }\n      future[x][y] = \n        in(x + 1, y) / 4 + in(x - 1, y) / 4 +\n        in(x, y + 1) / 4 + in(x, y - 1) / 4;\n    }\n    REP(x, 3) REP(y, 3) {\n      room[x][y] = future[x][y];\n    }\n  }\n  return room[tx][ty];\n}\n\nint room2x(char r) {\n  switch (r) {\n    case 'A': case 'D': case 'G':\n      return 0; break;\n    case 'B': case 'E': case 'H':\n      return 1; break;\n    case 'C': case 'F': case 'I':\n      return 2; break;\n    default:\n      break;\n  }\n}\n\nint room2y(char r) {\n  switch (r) {\n    case 'A': case 'B': case 'C':\n      return 0; break;\n    case 'D': case 'E': case 'F':\n      return 1; break;\n    case 'G': case 'H': case 'I':\n      return 2; break;\n    default:\n      break;\n  }\n}\n\nint main() {\n  while (cin >> n and n) {\n    char s, t, b;\n    cin >> s >> t >> b;\n    sx = room2x(s); sy = room2y(s);\n    tx = room2x(t); ty = room2y(t);\n    bx = room2x(b); by = room2y(b);\n\n    cout << solve() << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstring>\n#include <cmath>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <sstream>\nusing namespace std;\n\nlong cnt,as;\nchar s,t,b;\nconst int dy[]={-1,0,1,0};\nconst int dx[]={0,1,0,-1};\nint main(){\n  int n,field[2][5][5],tx,ty;\n  for(;cin>>n,n;){\n    cin.ignore();\n    cnt=as=0;\n    scanf(\" %c %c %c \",&s,&t,&b);\n    memset(field,0,sizeof(field));\n    int x= s=='A'||s=='D'||s=='G'?1:s=='B'||s=='E'||s=='H'?2:3;\n    int y= s=='A'||s=='B'||s=='C'?1:s=='D'||s=='E'||s=='F'?2:3;\n    \n    int p= t=='A'||t=='D'||t=='G'?1:t=='B'||t=='E'||t=='H'?2:3;\n    int q= t=='A'||t=='B'||t=='C'?1:t=='D'||t=='E'||t=='F'?2:3;\n\n    int u= b=='A'||b=='D'||b=='G'?1:b=='B'||b=='E'||b=='H'?2:3;\n    int t= b=='A'||b=='B'||b=='C'?1:b=='D'||b=='E'||b=='F'?2:3;\n\n    field[0][y][x]=1;\n    field[0][0][0]=field[0][0][1]=field[0][0][2]=field[0][0][3]=field[0][0][4]=1;\n    field[0][4][0]=field[0][4][1]=field[0][4][2]=field[0][4][3]=field[0][4][4]=1;\n    field[0][1][0]=field[0][2][0]=field[0][3][0]=1;\n    field[0][1][4]=field[0][2][4]=field[0][3][4]=1;\n    for(int k=0;k<n;k++){\n      for(int i=1;i<4;i++){\n        for(int j=1;j<4;j++){\n          if(i==t && j==u)continue;\n\n          for(int g=0;g<4;g++){\n            tx=j+dx[g];\n            ty=i+dy[g];\n            if(field[0][i][j]==0 && (tx<1 || ty<1 || tx>=4 || ty>=4))continue;\n            field[1][i][j]+=field[0][ty][tx];\n          }\n          if(field[0][i][j]!=0 && (i-1==t&&j==u || i+1==t&&j==u ||\n             i==t&&j-1==u || i==t&&j+1==u) ){\n            field[1][i][j]++;\n          }\n        }\n      }\n      for(int i=1;i<4;i++)for(int j=1;j<4;j++)field[0][i][j]=field[1][i][j],field[1][i][j]=0;\n    }\n    printf(\"%.8lf\\n\",(double)field[0][q][p]/pow(4.0,(double)n));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define for_(i,a,b) for(int i=(a);i<(b);++i)\n\nconst int dx[4] = {-1,0,1,0};\nconst int dy[4] = {0,-1,0,1};\n\nint n;\nchar s, t, b;\ndouble p[2][3][3];\n\nint getX(char c) { return (c - 'A') % 3; }\nint getY(char c) { return (c - 'A') / 3; }\n\nvoid solve() {\n\tfor_(y,0,3) for_(x,0,3) p[0][y][x] = 0.;\n\tp[0][getY(s)][getX(s)] = 1.0;\n\t\n\tfor_(i,0,n) {\n\t\tfor_(y,0,3) for_(x,0,3) p[1][y][x] = 0.;\n\t\tfor_(y,0,3) for_(x,0,3) {\n\t\t\tif (y == getY(b) && x == getX(b)) continue;\n\t\t\tfor_(d,0,4) {\n\t\t\t\tint nx = x + dx[d], ny = y + dy[d];\n\t\t\t\tif (nx < 0 || nx >= 3 || ny < 0 || ny >= 3) continue;\n\t\t\t\tp[1][y][x] += p[0][ny][nx] * 0.25;\n\t\t\t}\n\t\t}\n\t\tswap(p[0], p[1]);\n\t}\n\t\n\tcout << setprecision(9) << setiosflags(ios::fixed) << p[0][getY(t)][getX(t)] << endl;\n}\n\nint main() {\n\twhile (cin >> n, n) {\n\t\tcin >> s >> t >> b;\n\t\tsolve();\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<cstdio>\nusing namespace std;\nint n,s,t,b;\nint kai[16][9];\nbool visited[16][9];\nint dx[]={0,1,0,-1},dy[]={-3,0,3,0};\n\nvoid dfs(int p,int e){\n  visited[e][p]=1;\n  if(e==n){\n    if(p==t)kai[e][p]=1;\n    return;\n  }\n  for(int i=0;i<4;i++){\n    int np=p+dx[i]+dy[i];\n    if(dx[i]+p%3<0||dx[i]+p%3>=3||np<0||9<=np||np==b)np=p;\n    if(!visited[e+1][np])dfs(np,e+1);\n    kai[e][p]+=kai[e+1][np];\n  }\n}\n\nint main(){\n  while(cin>>n&&n!=0){\n    char sc,tc,bc;\n    memset(kai,0,16*9);\n    memset(visited,0,16*9);\n    cin>>sc>>tc>>bc;\n    s=sc-'A',t=tc-'A',b=bc-'A';\n    dfs(s,0);\n    printf(\"%.8f\\n\",1.0*kai[0][s]/(1<<(n*2)));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n\nusing namespace std;\n\nint b_row,b_col,memo[16][3][3];\n\nchar b[2];\n\nbool rangeCheck(int row,int col){\n\tif(row >= 0 && row <= 2 && col >= 0 && col <= 2)return true;\n\telse{\n\t\treturn false;\n\t}\n}\n\nint translate(char ch){\n\tswitch(ch){\n\tcase 'A':return 0;\n\tcase 'B':return 1;\n\tcase 'C':return 2;\n\tcase 'D':return 10;\n\tcase 'E':return 11;\n\tcase 'F':return 12;\n\tcase 'G':return 20;\n\tcase 'H':return 21;\n\tcase 'I':return 22;\n\t}\n\n\treturn -1; //must not reach here.\n}\n\nint main(){\n\n\tint n,tmp,energy_row,energy_col,row,col,div_row[4] = {-1,0,0,1},div_col[4] = {0,-1,1,0};\n\tchar start[2],energy[2];\n\n\twhile(true){\n\t\tscanf(\"%d\",&n);\n\t\tif(n == 0)break;\n\n\t\tfor(int i = 0; i < 16; i++){\n\t\t\tfor(int p = 0; p < 3; p++){\n\t\t\t\tfor(int k = 0; k < 3; k++)memo[i][p][k] = 0;\n\t\t\t}\n\n\t\t}\n\n\t\tscanf(\"%s %s %s\",start,energy,b);\n\n\t\ttmp = translate(b[0]);\n\t\tb_row = tmp/10;\n\t\tb_col = tmp%10;\n\n\t\ttmp = translate(energy[0]);\n\t\tenergy_row = tmp/10;\n\t\tenergy_col = tmp%10;\n\n\t\ttmp = translate(start[0]);\n\n\t\trow = tmp/10,col = tmp%10;\n\n\t\tmemo[0][row][col] = 1;\n\n\t\tfor(int loop = 0; loop <= n-1; loop++){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tif(i != b_row || k != b_col){ //????????§????????´???\n\t\t\t\t\t\tfor(int p = 0; p < 4; p++){\n\t\t\t\t\t\t\tif(rangeCheck(i+div_row[p],k+div_col[p]) == true && (i+div_row[p] != b_row || k + div_col[p] != b_col)){ //?§????????????§??????????????????????????§??????\n\t\t\t\t\t\t\t\tmemo[loop+1][i+div_row[p]][k+div_col[p]] += memo[loop][i][k];\n\t\t\t\t\t\t\t}else{ //?°?????????¨???1????????????????????????????????´?????????????????´??????????????¨????????´????????°???????????????\n\t\t\t\t\t\t\t\tmemo[loop+1][i][k] += memo[loop][i][k];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\",((double)memo[n][energy_row][energy_col])/((double)pow(4,n)));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#include \"stdio.h\"\n\nusing namespace std;\n\nint dx[] = {-1,0,1,0};\nint dy[] = {0,-1,0,1};\n\nint main(){\n\tint n;\n\tdouble prob[2][3][3];\n\tbool junk[3][3];\n\twhile(cin >> n, n){\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tdouble ans = 0.0;\n\t\tfor(int i=0;i<2;i++)\n\t\t\tfor(int j=0;j<3;j++)\n\t\t\t\tfor(int k=0;k<3;k++) prob[i][j][k] = 0.0;\n\t\tprob[0][(s-'A')/3][(s-'A')%3] = 1.0;\n\t\tint gx = (t-'A')/3, gy = (t-'A')%3;\n\t\tmemset(junk, false, sizeof(junk));\n\t\tjunk[(b-'A')/3][(b-'A')%3] = true;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int x=0;x<3;x++)\n\t\t\t\tfor(int y=0;y<3;y++) prob[1-(i%2)][x][y] = 0.0;\n\t\t\tfor(int x=0;x<3;x++){\n\t\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\t\tfor(int d=0;d<4;d++){\n\t\t\t\t\t\tint nx = x+dx[d], ny = y+dy[d];\n\t\t\t\t\t\tif(nx<0||3<=nx||ny<0||3<=ny||junk[nx][ny]) {\n\t\t\t\t\t\t\tnx = x, ny = y;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tprob[1-(i%2)][nx][ny] += prob[i%2][x][y]*0.25;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\", prob[n%2][gx][gy]);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\nusing namespace std;\nchar s,t,b;\nchar fld[3][3]={\"ABC\",\"DEF\",\"GHI\"};\nint ans,sum,dx[]={1,0,-1,0},dy[]={0,1,0,-1};\nvoid rep(int now,int y,int x){\n\tint X,Y;\n\tif(now==0){\n\t\tsum++;\n\t\tif(fld[y][x]==t){\n\t\t\tans++;\n\t\t}\n\t\treturn ;\n\t}\n\tfor(int i=0;i<4;i++){\n\t\tX=x+dx[i];\n\t\tY=y+dy[i];\n\t\tif(X>=0&&X<3&&Y>=0&&Y<3&&fld[Y][X]!=b){\n\t\t\trep(now-1,Y,X);\n\t\t}\n\t\telse{\n\t\t\trep(now-1,y,x);\n\t\t}\n\t}\n}\nint main(){\n\tint n;\n\twhile(cin>>n,n){\n\t\tcin>>s>>t>>b;\n\t\tsum=0;\n\t\tans=0;\n\t\tfor(int i=0;i<3;i++)\n\t\tfor(int j=0;j<3;j++){\n\t\t\tif(fld[i][j]==s)\n\t\t\trep(n,i,j);\n\t\t}\n\t\tcout<<ans<<' '<<sum<<endl;\n\t\tprintf(\"%.8lf\\n\",(double)ans/sum);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define for_(i,a,b) for(int i=(a);i<(b);++i)\n\nconst int dx[4] = {-1,0,1,0};\nconst int dy[4] = {0,-1,0,1};\n\nint n;\nchar s, t, b;\ndouble p[2][3][3];\n\nint getX(char c) { return (c - 'A') % 3; }\nint getY(char c) { return (c - 'A') / 3; }\n\nvoid solve() {\n\tfor_(y,0,3) for_(x,0,3) p[0][y][x] = 0.;\n\tp[0][getY(s)][getX(s)] = 1.0;\n\t\n\tfor_(i,0,n) {\n\t\tfor_(y,0,3) for_(x,0,3) {\n\t\t\tp[1][y][x] = 0.;\n\t\t\tif (y == getY(b) && x == getX(b)) continue;\n\t\t\tfor_(d,0,4) {\n\t\t\t\tint nx = x + dx[d], ny = y + dy[d];\n\t\t\t\tif (nx < 0 || nx >= 3 || ny < 0 || ny >= 3) {\n\t\t\t\t\tnx = x;\n\t\t\t\t\tny = y;\n\t\t\t\t}\n\t\t\t\tp[1][y][x] += p[0][ny][nx] * 0.25;\n\t\t\t}\n\t\t}\n\t\tswap(p[0], p[1]);\n\t}\n\t\n\tcout << setprecision(12) << setiosflags(ios::fixed) << p[0][getY(t)][getX(t)] << endl;\n}\n\nint main() {\n\twhile (cin >> n, n) {\n\t\tcin >> s >> t >> b;\n\t\tsolve();\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef pair<int,int> P;\n\nint main() {\n    int N;\n    while (cin >> N, N) {\n        char s, t, b;\n        cin >> s >> t >> b;\n\n        int sx, sy;\n        sx = (s - 'A') / 3;\n        sy = (s - 'A') % 3;\n        int tx, ty;\n        tx = (t - 'A') / 3;\n        ty = (t - 'A') % 3;\n        int bx, by;\n        bx = (b - 'A') / 3;\n        by = (b - 'A') % 3;\n        vector<vector<vector<int> > > dp(N+1, vector<vector<int> >(3, vector<int>(3, 0)));\n        dp[0][sx][sy] = 1;\n        int dx[] = {1,0,-1,0};\n        int dy[] = {0,1,0,-1};\n        for (int i = 0; i < N; i++) {\n            for (int x = 0; x < 3; x++) {\n                for (int y = 0; y < 3; y++) {\n                    for (int j = 0; j < 4; j++) {\n                        int nx = x + dx[j];\n                        int ny = y + dy[j];\n                        if (0 <= nx && nx < 3 && 0 <= ny && ny < 3) {\n                            if (x == bx && y == by)\n                                dp[i+1][x][y] += dp[i][x][y];\n                            else\n                                dp[i+1][nx][ny] += dp[i][x][y];\n                        } else {\n                            dp[i+1][x][y] += dp[i][x][y];\n                        }\n                    }\n                }\n            }\n        }\n\n        double ans = 0.;\n        double p = 1.;\n        for (int i = 1; i <= N; i++) {\n            p /= 4.;\n        }\n        ans = p * dp[N][tx][ty];\n        printf(\"%0.9f\\n\", ans);\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <queue>\n\nusing namespace std;\n\nconst int EMPTY   = 0;\nconst int BATTERY = 1;\nconst int STORE   = 2;\nconst int WALL    = 3;\n\nstruct Point {\npublic:\n  int x, y;\n  Point() { }\n  Point(int x, int y): x(x), y(y) { }\n};\n\nstruct State {\npublic:\n  Point p;\n  int battery;\n  State() { };\n  State(Point p, int battery): p(p), battery(battery) { }\n};\n\nPoint int2point(int n) {\n  return Point(1 + n % 3, 1 + n / 3);\n}\n\nint main() {\n  int n, s, t, b;\n  while (true) {\n    cin >> n;\n    if (n == 0) break;\n    char cs, ct, cb;\n    cin >> cs >> ct >> cb;\n    int count = 0, count2 = 0;\n    s = cs - 'A';\n    t = ct - 'A';\n    b = cb - 'A';\n    \n    int field[5][5];\n    memset(field, EMPTY, sizeof(field));\n    for (int i = 0; i < 5; i++) {\n      field[0][i] = WALL;\n      field[4][i] = WALL;\n      field[i][0] = WALL;\n      field[4][i] = WALL;\n    }\n    Point batteryPoint = int2point(t);\n    field[batteryPoint.x][batteryPoint.y] = BATTERY;\n    Point storePoint = int2point(b);\n    field[storePoint.x][storePoint.y] = STORE;\n    State nowState(int2point(s), n);\n    queue<State> q;\n    q.push(nowState);\n    \n    while (!q.empty()) {\n      State s = q.front(); q.pop();\n      if (s.battery == 0) {\n        if (field[s.p.x][s.p.y] == BATTERY) {\n          count2++;\n        }\n        count++;\n        continue;\n      }\n      int dx[4] = { 0, -1, 1, 0 };\n      int dy[4] = { -1, 0, 0, 1 };\n      for (int i = 0; i < 4; i++) {\n        Point np = Point(s.p.x + dx[i], s.p.y + dy[i]);\n        if (field[np.x][np.y] == STORE) {\n          q.push(State(s.p, s.battery - 1));\n          continue;\n        }\n        if (field[np.x][np.y] == WALL) {\n          q.push(State(s.p, s.battery - 1));\n          continue;\n        }\n        q.push(State(np, s.battery - 1));\n      }\n    }\n    printf(\"%.15lf\\n\", (double)count2 / count);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<vector>\n#include<list>\n#include<algorithm>\n#include<iostream>\n#include<string>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\nusing namespace std;\nint f(int a[][4],int b[][4][16],int x,int y,int gx,int gy,int n){\n  int i=0;\n  if(n==0){\n    if(x==gx&&y==gy)\n      return 1;\n    else\n      return 0;\n  }\n  if(b[x][y][n])\n    return b[x][y][n];\n  if(a[x-1][y])\n    i++;\n  else\n    b[x][y][n]+=f(a,b,x-1,y,gx,gy,n-1);\n  if(a[x][y-1])\n    i++;\n  else\n    b[x][y][n]+=f(a,b,x,y-1,gx,gy,n-1);\n  if(a[x+1][y])\n    i++;\n  else\n    b[x][y][n]+=f(a,b,x+1,y,gx,gy,n-1);\n  if(a[x][y+1])\n    i++;\n  else\n    b[x][y][n]+=f(a,b,x,y+1,gx,gy,n-1);\n  b[x][y][n]+=f(a,b,x,y,gx,gy,n-1)*i;\n  return b[x][y][n];\n}\nint main(){\n  int i,j;\n  int a[4][4],b[4][4][16],n,sx,sy,gx,gy;\n  char s;\n  memset(a,-1,sizeof(a));\n  while(cin>>n&&n){\n    for(i=1;i<4;i++)\n      for(j=1;j<4;j++)\n\ta[j][i]=0;\n    cin>>s;\n    sx=(s-'A')%3+1;\n    sy=(s-'A')/3+1;\n    cin>>s;\n    gx=(s-'A')%3+1;\n    gy=(s-'A')/3+1;\n    cin>>s;\n    a[(s-'A')%3+1][(s-'A')/3+1]=-1;\n    memset(b,0,sizeof(b));\n    printf(\"%.8lf\\n\",f(a,b,sx,sy,gx,gy,n)/pow(4,n));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <vector>\n#include <string>\n#include <map>\n#include <sstream>\n#include <queue>\n#include <cstdlib>\n#include <algorithm>\n#include <iterator>\n#include <stack>\n#include <list>\nusing namespace std;\n#define INF 100000000\ntypedef long long int lli;\ntypedef pair<int,int> P;\nlong double dp[16][9];\n\nvoid room(char c,int &x){\n\tswitch(c){\n\t\tcase 'A':\n\t\tx=0;\n\t\tbreak;\n\t\t\n\t\tcase 'B':\n\t\tx=1;\n\t\tbreak;\n\t\t\n\t\tcase 'C':\n\t\tx=2;\n\t\tbreak;\n\t\t\t\n\t\tcase 'D':\n\t\tx=3;\n\t\tbreak;\n\t\t\n\t\tcase 'E':\n\t\tx=4;\n\t\tbreak;\n\t\t\n\t\tcase 'F':\n\t\tx=5;\n\t\tbreak;\n\t\t\n\t\tcase 'G':\n\t\tx=6;\n\t\tbreak;\n\t\t\n\t\tcase 'H':\n\t\tx=7;\n\t\tbreak;\n\t\t\n\t\tcase 'I':\n\t\tx=8;\n\t\tbreak;\n\t\t\n\t\tdefault:\n\t\tbreak;\n\t}\n}\n\nint main(){\n\tint n;\n\twhile(cin>>n&&n){\n\t\tchar s,t,b;\n\t\tcin >> s >> t >> b;\n\t\tint sr,tr,br;\n\t\troom(s,sr);\n\t\troom(t,tr);\n\t\troom(b,br);\n\t\t//cout << sr << \" \" << tr << \" \" << br << \"\\n\";\n\t\tfor(int i=0; i<=n; ++i){\n\t\t\tfor(int j=0; j<9; ++j){\n\t\t\t\tdp[i][j]=0;\n\t\t\t}\n\t\t}\n\t\tdp[0][sr]=1;\n\t\tfor(int i=1; i<=n; ++i){\n\t\t\tfor(int j=0; j<9; ++j){\n\t\t\t\tif(j!=br){\n\t\t\t\t\tswitch(j){\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][1]/2+dp[i-1][3]/2+dp[i-1][0])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][0]+dp[i-1][4]+dp[i-1][2]+dp[i-1][1])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][1]/2+dp[i-1][5]/2+dp[i-1][2])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][0]+dp[i-1][4]+dp[i-1][6]+dp[i-1][3])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][1]+dp[i-1][5]+dp[i-1][7]+dp[i-1][3])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\t\tcase 5:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][2]+dp[i-1][4]+dp[i-1][8]+dp[i-1][5])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 6:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][3]/2+dp[i-1][7]/2+dp[i-1][6])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 7:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][6]+dp[i-1][4]/2+dp[i-1][8]/2+dp[i-1][7]/2)/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 8:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][5]/2+dp[i-1][7]/2+dp[i-1][8])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << dp[n][tr] << \"\\n\";\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\nusing namespace std;\n\nint main()\n{\n  int battery;\n  char s, t, b;\n\n  while (cin >> battery)\n  {\n    double pmatrix[9][9] = {\n      {0.5,  0.25, 0,    0.25, 0,    0,    0,    0,    0}, // 0 A\n      {0.25, 0.25, 0.25, 0,    0.25, 0,    0,    0,    0}, // 1 B\n      {0,    0.25, 0.5,  0,    0,    0.25, 0,    0,    0}, // 2 C\n      {0.25, 0,    0,    0.25, 0.25, 0,    0.25, 0,    0}, // 3 D\n      {0,    0.25, 0,    0.25, 0,    0.25, 0,    0.25, 0}, // 4 E\n      {0,    0,    0.25, 0,    0.25, 0.25, 0,    0,    0.25}, // 5 F\n      {0,    0,    0,    0.25, 0,    0,    0.5,  0.25, 0},    // 6 G\n      {0,    0,    0,    0,    0.25, 0,    0.25, 0.25, 0.25}, // 7 H\n      {0,    0,    0,    0,    0,    0.25, 0,    0.25, 0.5}   // 8 I\n    };\n\n    if (battery==0) return 0;\n    cin >> s >> t >> b;\n\n    int start = s-'A';\n    int broom = t-'A';\n    int junk = b-'A';\n\n    for (int i=0;i<9;i++) pmatrix[junk][i]=pmatrix[i][junk]=0;\n    switch (junk)\n    {\n    case 0:\n      pmatrix[1][1]=pmatrix[3][3]=0.5;\n      break;\n    case 1:\n      pmatrix[0][0]=pmatrix[2][2]=0.75;\n      pmatrix[4][4]=0.25;\n      break;\n    case 2:\n      pmatrix[1][1]=pmatrix[5][5]=0.5;\n      break;\n    case 3:\n      pmatrix[0][0]=pmatrix[6][6]=0.75;\n      pmatrix[4][4]=0.25;\n      break;\n    case 4:\n      pmatrix[1][1]=pmatrix[3][3]=pmatrix[5][5]=pmatrix[7][7]=0.5;\n      break;\n    case 5:\n      pmatrix[2][2]=pmatrix[8][8]=0.75;\n      pmatrix[4][4]=0.25;\n      break;\n    case 6:\n      pmatrix[3][3]=pmatrix[7][7]=0.5;\n      break;\n    case 7:\n      pmatrix[6][6]=pmatrix[8][8]=0.75;\n      pmatrix[4][4]=0.25;\n      break;\n    case 8:\n      pmatrix[5][5]=pmatrix[7][7]=0.5;\n      break;\n    }\n\n    double P[9][9], Q[9][9];\n\n    for (int i=0;i<9;i++)\n      for (int j=0;j<9;j++) P[i][j] = pmatrix[i][j];\n\n    for (int i=1;i<battery;i++)\n    {\n      for (int i=0;i<9;i++)\n      {\n        for (int j=0;j<9;j++)\n        {\n          Q[i][j] = 0.0;\n          for (int k=0; k<9;k++)\n          {\n            Q[i][j] += P[i][k] * pmatrix[k][j];\n          }\n        }\n      }\n      for (int i=0;i<9;i++)\n        for (int j=0;j<9;j++) P[i][j] = Q[i][j];\n\n    }\n    // for (int i=0;i<9;i++)\n    // {\n    //   for (int j=0;j<9;j++) printf(\"%4f \", P[i][j]);\n    //   cout << endl;\n    // }\n\n    printf(\"%.8f\\n\", P[start][broom]);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#include<iostream>\n#include<string.h>\n#include<math.h>\n#include<algorithm>\n#include<cstring>\n#include<queue>\nusing namespace std;\n#define INF 100000000\nint s,t,b,n;\ndouble p,nn;\nint d[4]={1,3,-1,-3};\ndouble df[10][20];\n\nint max(int a,int b){\n\tif(a>b){\n\t\treturn a;\n\t}else{\n\t\treturn b;\n\t}\n}\nvoid dfs(int s,int n){\n\tdouble p1;\n\tif(n==0){\n\t\tif(s==t)p+=pow(0.25,nn);\n\t\treturn;\n\t}\n\tif(df[s][n]>=0){\n\t\tp+=df[s][n];\n\t\treturn;\n\t}else{\n\t\tfor(int i=0;i<4;i++){\n\t\t\tif(s+d[i]==b){\n\t\t\t\tp1=p;\n\t\t\t\tdfs(s,n-1);\n\t\t\t\tdf[s][n-1]=p-p1;\n\t\t\t}else if(s/3!=(s+d[i])/3){//3で割った値に注目するのがポイント\n\t\t\t\tif(d[i]*d[i]==9&&0<=s+d[i]&&s+d[i]<9){\n\t\t\t\t\tp1=p;\n\t\t\t\t\tdfs(s+d[i],n-1);\n\t\t\t\t\tdf[s+d[1]][n-1]=p-p1;\n\t\t\t\t}else{\n\t\t\t\t\tp1=p;\n\t\t\t\t\tdfs(s,n-1);\n\t\t\t\t\tdf[s][n-1]=p-p1;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tp1=p;\n\t\t\t\tdfs(s+d[i],n-1);\n\t\t\t\tdf[s+d[i]][n-1]=p-p1;\n\t\t\t}\n\t\t}\n\t}\n\treturn;\n}\nint main(){\n\twhile(1){\n\t\tchar cs,ct,cb;\n\t\tp=0;\n\t\tcin>>n;\n\t\tnn=n;\n\t\tif(n==0)break;\n\t\tfor(int i=0;i<10;i++){\n\t\t\tfor(int j=0;j<20;j++){\n\t\t\t\tdf[i][j]=-1;\n\t\t\t}\n\t\t}\n\t\tcin>>cs>>ct>>cb;\n\t\ts=(int)cs-'A';\n\t\tt=(int)ct-'A';\n\t\tb=(int)cb-'A';\n\t\tdfs(s,n);\n\t\tcout<<p<<endl;\n\t}\n\treturn 0;\n}\t"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cstdlib>\n\nint main(){\n  while(true){\n    int n;\n    std::cin >> n;\n    if (n == 0) return EXIT_SUCCESS;\n    char s, t, b;\n    std::cin >> s >> t >> b;\n    double p[9];\n    for(int i=0; i<9; i++) p[i] = 0.0;\n    p[s-'A'] = 1.0;\n    for(int i=0; i<n; i++){\n      double newp[9];\n      for(int j=0; j<9; j++) newp[j] = 0.0;\n      for(int j=0; j<9; j++){\n        double p4 = p[j]/4.0;\n        //left\n        if(j%3==0) newp[j]+=p4;\n        else if(j-1 == b-'A') newp[j]+=p4;\n        else newp[j-1]+=p4;\n        //right\n        if(j%3==2) newp[j]+=p4;\n        else if(j+1 == b-'A') newp[j]+=p4;\n        else newp[j+1]+=p4;\n        //up\n        if(j<3) newp[j]+=p4;\n        else if(j-3 == b-'A') newp[j]+=p4;\n        else newp[j-3]+=p4;\n        //down\n        if(j>=6) newp[j]+=p4;\n        else if(j+3 == b-'A') newp[j]+=p4;\n        else newp[j+3]+=p4;\n      }\n      //update\n      for(int j=0; j<9; j++) p[j] = newp[j];\n    }\n    std::cout << std::fixed;\n    std::cout << std::setprecision(8) << p[t-'A'] << std::endl;\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint ans;\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\n\nvoid solve(char x, char y, char n, char room[3][3] ){\n\tif( n == 0 ){\n\t\tif( room[y][x] == 2 ){\n\t\t\tans++;\t\n\t\t}\n\t\treturn;\n\t}else{\n\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\tint mx = x + dx[i];\n\t\t\tint my = y + dy[i];\n\t\t\tif( mx == -1 )\n\t\t\t\tmx = 0;\n\t\t\tif( mx == 3 )\n\t\t\t\tmx = 2;\n\t\t\tif( my == -1 )\n\t\t\t\tmy = 0;\n\t\t\tif( my == 3 )\n\t\t\t\tmy = 2;\n\t\t\tif( room[my][mx] == 1 ){\n\t\t\t\tmx -= dx[i];\n\t\t\t\tmy -= dy[i];\n\t\t\t}\n\t\t\tsolve( mx , my , n-1 , room );\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tchar n, s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A']=i%3;\n\t\tfy[i+'A']=i/3;\n\t}\n\t\n\twhile( scanf(\"%d\", &n) , n ){\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\t\n\t\tchar room[3][3] = {0};\n\t\tchar x = fx[s];\n\t\tchar y = fy[s];\n\t\troom[ fy[t] ][ fx[t] ] = 2;\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\n\t\tans = 0;\n\t\tif( n%2 == 1 && (y*3+x)%2 == (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else if( n%2 == 0 && (y*3+x)%2 != (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else{\n\t\t\tsolve( x , y , n , room );\n\t\t}\n\t\n\t\tprintf(\"%.8f\\n\" , ans/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <complex>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <numeric>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <iostream>\n#include <map>\n#include <set>\nusing namespace std;\ntypedef pair<int,int> P;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-9\n#define INF 2000000000\n#define sz(x) ((int)(x).size())\n#define fi first\n#define sec second\n#define SORT(x) sort((x).begin(),(x).end())\n#define all(x) (x).begin(),(x).end()\n#define EQ(a,b) (abs((a)-(b))<eps)\ndouble cur[3][3],next[3][3];\nint dx[4]={0,1,0,-1};\nint dy[4]={1,0,-1,0};\nint X[9]={0,0,0,1,1,1,2,2,2};\nint Y[9]={0,1,2,0,1,2,0,1,2};\nint sx,sy,gx,gy,mx,my,n;\nP to(int x,int y,int d)\n{\n\tint nx=x+dx[d],ny=y+dy[d];\n\tif(nx<0||nx>=3||ny<0||ny>=3)return P(x,y);\n\tif(nx==mx&&ny==my)return P(x,y);\n\treturn P(nx,ny);\n}\nint main()\n{\n\twhile(1)\n\t{\n\t\tcin >> n;\n\t\tif(n==0)break;\n\t\tchar s,g,m;\n\t\tcin >> s >> g >> m;\n\t\tsx = X[s-'A']; sy = Y[s-'A'];\n\t\tgx = X[g-'A']; gy = Y[g-'A'];\n\t\tmx = X[m-'A']; my = Y[m-'A'];\n\t\tmemset(cur,0,sizeof(cur));\n\t\tmemset(next,0,sizeof(next));\n\t\tcur[sx][sy]=1.0;\n\t\tfor(int t=0;t<n;t++)\n\t\t{\n\t\t\tfor(int i=0;i<3;i++)\n\t\t\t{\n\t\t\t\tfor(int j=0;j<3;j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int d=0;d<4;d++)\n\t\t\t\t\t{\n\t\t\t\t\t\tP ne = to(i,j,d);\n\t\t\t\t\t\tnext[ne.fi][ne.sec]+=cur[i][j]/4.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemcpy(cur,next,sizeof(next));\n\t\t\tmemset(next,0,sizeof(next));\n\t\t}\n\t\tprintf(\"%.12f\\n\",cur[gx][gy]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<cassert>\n#include<iostream>\n#include<sstream>\n#include<string>\n#include<vector>\n#include<queue>\n#include<set>\n#include<map>\n#include<utility>\n#include<numeric>\n#include<algorithm>\n#include<bitset>\n#include<complex>\n\nusing namespace std;\n\ntypedef long long Int;\ntypedef vector<int> vint;\ntypedef pair<int,int> pint;\n#define mp make_pair\n\ntemplate<class T> void pv(T a, T b) { for (T i = a; i != b; ++i) cout << *i << \" \"; cout << endl; }\ntemplate<class T> void chmin(T &t, T f) { if (t > f) t = f; }\ntemplate<class T> void chmax(T &t, T f) { if (t < f) t = f; }\nint in() { int x; scanf(\"%d\", &x); return x; }\n\ndouble dp[20][10];\nint n,s,t,b;\n\nint move(int pos,int x,int y){\n\tif(pos<3&&y==-1)return pos;\n\tif(pos>=6&&y==1)return pos;\n\tif(pos%3==0&&x==-1)return pos;\n\tif(pos%3==2&&x==1)return pos;\n\tpos+=x+3*y;\n\tif(pos==b)return pos-x-3*y;\n\treturn pos;\n}\n\nint main() {\n\tstring ss,tt,bb;\n\twhile(n=in()){\n\t\tcin>>ss>>tt>>bb;\n\t\ts=ss[0]-'A';\n\t\tt=tt[0]-'A';\n\t\tb=bb[0]-'A';\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdp[0][s]=1;\n\t\tint i,j;\n\t\tfor(i=1;i<=n;i++){\n\t\t\tfor(j=0;j<9;j++){\n\t\t\t\tdp[i][move(j,1,0)]+=dp[i-1][j]/4;\n\t\t\t\tdp[i][move(j,-1,0)]+=dp[i-1][j]/4;\n\t\t\t\tdp[i][move(j,0,1)]+=dp[i-1][j]/4;\n\t\t\t\tdp[i][move(j,0,-1)]+=dp[i-1][j]/4;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.12f\\n\",dp[n][t]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include <iostream>\nusing namespace std;\n\nint main() {\n\twhile (1) {\n\t\tint n, s, t, b, sum = 0;\n\t\tint ai[16][3][3] = { 0 };\n\t\tchar a, d, c;\n\t\tscanf(\"%d\", &n);\n\t\tif (n == 0) break;\n\t\tcin >> a >> d >> c;\n\t\ts = a - 'A';  t = d - 'A'; b = c - 'A';\n\t\tai[0][s / 3][s % 3] = 1;\n\t\tfor (int i = 1; i <= n; ++i) {\n\t\t\tfor (int j = 0; j < 3; ++j) {\n\t\t\t\tfor (int l = 0; l < 3; ++l) {\n\t\t\t\t\tif (j - 1 >= 0 && (j-1) * 3 + l != b) ai[i][j - 1][l] += ai[i - 1][j][l];\n\t\t\t\t\telse ai[i][j][l] += ai[i - 1][j][l];\n\t\t\t\t\tif (j + 1 < 3 && (j - 1) * 3 + l != b) ai[i][j + 1][l] += ai[i - 1][j][l];\n\t\t\t\t\telse ai[i][j][l] += ai[i - 1][j][l];\n\n\t\t\t\t\tif (l - 1 >= 0 && j * 3 + l - 1 != b) ai[i][j][l - 1] += ai[i - 1][j][l];\n\t\t\t\t\telse ai[i][j][l] += ai[i - 1][j][l];\n\t\t\t\t\tif (l + 1 < 3 && j * 3 + l - 1 != b) ai[i][j][l + 1] += ai[i - 1][j][l];\n\t\t\t\t\telse ai[i][j][l] += ai[i - 1][j][l];\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (int i = 0; i < 3; ++i) {\n\t\t\tfor (int j = 0; j < 3; ++j) {\n\t\t\t\tsum += ai[n][i][j];\n\t\t\t}\n\t\t}\n\t\tprintf(\"%f\\n\", (double)ai[n][t / 3][t % 3] / sum);\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <sstream>\n#include <string>\n#include <vector>\n#include <map>\n#include <algorithm>\n#include <iostream>\n#include <utility>\n#include <set>\n#include <cctype>\n#include <queue>\n#include <stack>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\nusing namespace std;\n#define INF 100000000\ntypedef long long ll;\n\nint n;\nint sx, sy, gx, gy, bx, by; \nint dx[4] = {1, 0, -1, 0};\nint dy[4] = {0, 1, 0, -1};\n\n// 残りk回動けて今x, yにいるとき最後充電スペースにいける確率\ndouble dfs(int x, int y, int k) {\n    if (k == 0) {\n        if (x == gx && y == gy) return 1;\n        else return 0;\n    }\n    double ret = 0;\n    for (int i = 0; i < 4; i++) {\n        int nx = x + dx[i];\n        int ny = y + dy[i];\n        if (nx < 0 || nx >= 3 || ny < 0 || ny >= 3) ret += dfs(x, y, k-1) / 4;\n        else if (nx == bx && ny == by) ret += dfs(x, y, k-1) / 4;\n        else ret += dfs(nx, ny, k-1) / 4;\n    }\n    return ret;\n}\n\nint main(void) {\n    while (1) {\n        cin >> n;\n        if (n == 0) break;\n        char s, t, b;\n        cin >> s >> t >> b;\n        sx = (int)(s-'A') % 3; sy = (int)(s-'A')/3;\n        gx = (int)(t-'A') % 3; gy = (int)(t-'A')/3;\n        bx = (int)(b-'A') % 3; by = (int)(b-'A')/3;\n        cout << dfs(sx, sy, n) << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <map>\n#include <algorithm>\n#include <cstring>\nusing namespace std;\n#define REP(i,n) for(int i = 0; i < (int)(n); ++i)\n#define FOREACH(it,c) for(typeof(c.begin()) it = c.begin(); it != c.end(); ++it)\n\ndouble a[3][3];\nint s,t,b;\n#define A(v) (a[(v)%3][(v)/3])\n\nint dx[] = {1,0,-1,0}, dy[] = {0,1,0,-1};\nbool go(int x, int y) {\n  if (x < 0 || x > 2 || y < 0 || y > 2 || y*3+x == b) return false;\n  return true;\n}\n\nvoid move() {\n  double atmp[3][3] = {0};\n  REP(x,3) REP(y,3) {\n    double v = a[x][y] / 4.0;\n    REP(d,4) {\n      if(go(x+dx[d],y+dy[d])) atmp[x+dx[d]][y+dy[d]] += v;\n      else atmp[x][y] += v;\n    }\n  }\n  REP(x,3) REP(y,3) a[x][y] = atmp[x][y];\n}\n\nint main() {\n  int n;\n  cout.precision(8);\n  cout<<fixed;\n  while (cin>>n, n) {\n    char ss,tt,bb; cin>>ss>>tt>>bb;\n    s=ss-'A', t=tt-'A', b=bb-'A';\n    memset(a,0,sizeof(a));\n    A(s) = 1;\n    REP(_,n) move();\n    //REP(y,3) {REP(x,3) cout<<a[x][y]<<\" \"; cout<<endl;}\n    cout<<A(t)<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <utility>\n\n#define lli long long int\n\nusing namespace std;\n\ntypedef pair<int,int> Pa;\n\nint dx[4] = {0, 1, 0, -1}, dy[4] = {1, 0, -1, 0};\n\ndouble search(int a[4][4], int n, Pa p, Pa q)\n{\n\tdouble b[4][4], c[4][4], m = n;\n\t\n\tfill(&b[0][0], &b[3][3], 0);\n\tb[p.first][p.second] = 1;\n\twhile(m--){\n\t\tfill(&c[0][0], &c[3][3], 0);\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tif(b[i][j] != 0){\n\t\t\t\t\tfor(int k = 0; k < 4; k++){\n\t\t\t\t\t\tint s = i+dy[k], t = j+dx[k];\n\t\t\t\t\t\tif(0 <= s && s < 3 && 0 <= t && t < 3){\n\t\t\t\t\t\t\tif(a[s][t] != 2){\n\t\t\t\t\t\t\t\tc[s][t] += b[i][j];\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tc[i][j] += b[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tdouble t = c[i][j];\n\t\t\t\tb[i][j] = t;\n\t\t\t}\n\t\t}\n\t}\n\t/*\n\tfor(int i = 0; i < 3; i++){\n\t\tfor(int j = 0; j < 3; j++){\n\t\t\tcout << \" \" << b[i][j];\n\t\t}\n\t\tcout << endl;\n\t}\n\tcout << endl;\n\tcout << b[q.first][q.second] << endl;\n\t*/\n\treturn (double)(b[q.first][q.second])/(1<<(2*n));\n}\n\nPa func(string str)\n{\n\tif(str == \"A\"){\n\t\treturn Pa(0,0);\n\t} else if(str == \"B\"){\n\t\treturn Pa(0,1);\n\t} else if(str == \"C\"){\n\t\treturn Pa(0,2);\n\t} else if(str == \"D\"){\n\t\treturn Pa(1,0);\n\t} else if(str == \"E\"){\n\t\treturn Pa(1,1);\n\t} else if(str == \"F\"){\n\t\treturn Pa(1,2);\n\t} else if(str == \"G\"){\n\t\treturn Pa(2,0);\n\t} else if(str == \"H\"){\n\t\treturn Pa(2,1);\n\t} else {\n\t\treturn Pa(2,2);\n\t}\n}\n\nint main()\n{\n\tint n, a[4][4];\n\tstring s, t, u;\n\tPa p;\n\t\n\twhile(1){\n\t\tcin >> n;\n\t\tif(n == 0){\n\t\t\tbreak;\n\t\t}\n\t\tcin >> s >> t >> u;\n\t\tfill(&a[0][0], &a[3][3], 0);\n\t\t\n\t\tp = func(u);\n\t\ta[p.first][p.second] = 2;\n\t\tp = func(t);\n\t\ta[p.first][p.second] = 1;\n\t\t\n\t\tprintf(\"%.8f\\n\", search(a, n, func(s), p));\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "# include <iostream>\n# include <algorithm>\n# include <vector>\n# include <string>\n# include <set>\n# include <map>\n# include <cmath>\n# include <iomanip>\n# include <functional>\n# include <utility>\n# include <stack>\n# include <queue>\n# include <list>\nusing namespace std;\nusing LL = long long;\nconstexpr int MOD = 1000000000 + 7;\nconstexpr int INF = 2000000000;\nconst double PI = acos(-1);\n\n\nint n;\nchar s, t, b;\npair<int, int> S, T, B;\nint counter[10][10];\n\nint dx[] = { 0,1,0,-1 }, dy[] = { -1,0,1,0 };\n\nvoid dfs(pair<int, int> P, int count) {\n\tif (count == n) {\n\t\tcounter[P.first][P.second]++;\n\t\treturn;\n\t}\n\tfor (int i = 0; i < 4; i++) {\n\t\tint nx = P.second + dx[i], ny = P.first + dy[i];\n\t\tif (0 <= nx&&nx < 3 && 0 <= ny&&ny < 3 && make_pair(ny, nx) != B) dfs(make_pair(ny, nx), count + 1);\n\t\telse dfs(P, count + 1);\n\t}\n}\n\nint main() {\n\twhile (cin >> n&&n) {\n\t\tcin >> s >> t >> b;\n\t\tS = make_pair((s - 'A') / 3, (s - 'A') % 3);\n\t\tT = make_pair((t - 'A') / 3, (t - 'A') % 3);\n\t\tB = make_pair((b - 'A') / 3, (b - 'A') % 3);\n\t\tfor (int i = 0; i < 3; i++) {\n\t\t\tfor (int j = 0; j < 3; j++) {\n\t\t\t\tcounter[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\tdfs(S, 0);\n\t\tdouble sum = 0, ans = 0;\n\t\tfor (int i = 0; i < 3; i++) {\n\t\t\tfor (int j = 0; j < 3; j++) {\n\t\t\t\tif (make_pair(i, j) == T)ans+=counter[i][j];\n\t\t\t\tsum += counter[i][j];\n\t\t\t}\n\t\t}\n\t\tcout << fixed << setprecision(10) << ans / sum << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\nusing namespace std;\nint n,s,t,b;\nint kai[16][9];\nbool visited[16][9];\nint dx[]={0,1,0,-1},dy[]={-3,0,3,0};\n\nvoid dfs(int p,int e){\n  visited[e][p]=1;\n  if(e==n){\n    if(p==t)kai[e][p]=1;\n    return;\n  }\n  for(int i=0;i<4;i++){\n    int np=p+dx[i]+dy[i];\n    if(dx[i]+p%3<0||dx[i]+p%3==3||np<0||9<=np||np==b)np=p;\n    if(!visited[e+1][np])dfs(np,e+1);\n    kai[e][p]+=kai[e+1][np];\n  }\n}\n\nint main(){\n  while(cin>>n&&n!=0){\n    char sc,tc,bc;\n    memset(kai,0,16*9);\n    memset(visited,0,16*9);\n    cin>>sc>>tc>>bc;\n    s=sc-'A',t=tc-'A',b=bc-'A';\n    dfs(s,0);\n    cout<<1.0*kai[0][s]/(1<<(n*2))<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\nusing namespace std;\n\n#define rep(i,n) for(int i=0; i<n; i++)\ndouble dp[16][9];\n\nint main(){\n\tint n;\n\tchar s, t, b;\n\twhile( scanf(\"%d\",&n), n ){\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\tmemset( dp, 0, sizeof(dp) );\n\t\tdp[0][s-'A'] = 1.0;\n\t\trep(i,n){\n\t\t\trep(j,9){\n\t\t\t\tif(j-3>=0 && b-'A'!=j-3)\tdp[i+1][j-3] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t\tif(j-1>=0 && b-'A'!=j-1)\tdp[i+1][j-1] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t\tif(j+1< 9 && b-'A'!=j+1)\tdp[i+1][j+1] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t\tif(j+3< 9 && b-'A'!=j+3)\tdp[i+1][j+3] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.7lf\\n\",dp[n][t-'A']);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\nint main()\n{\n\tint c,n,s,t,b,i,j,k,x[9][4]={\n\t\t{1,3,0,0},\n\t\t{0,2,4,1},\n\t\t{1,5,2,2},\n\t\t{0,4,6,3},\n\t\t{1,3,5,7},\n\t\t{2,4,8,5},\n\t\t{3,7,6,6},\n\t\t{4,6,8,7},\n\t\t{5,7,8,8}\n\t};\n\tchar u,v,w;\n\twhile(scanf(\"%d\",&n),n)\n\t{\n\t\tint a[16][9]={0};\n\t\tscanf(\" %c %c %c\",&u,&v,&w);\n\t\ts=u-'A',t=v-'A',b=w-'A';\n\t\tc=a[0][s]=1;\n\t\tfor(i=0;i<n;++i,c*=4)for(j=0;j<9;++j)for(k=0;k<4;++k)\n\t\t\tif(x[j][k]!=b)a[i+1][x[j][k]]+=a[i][j];\n\t\t\telse a[i+1][j]+=a[i][j];\n\t\tprintf(\"%.8f\\n\",a[n][t]/(double)c);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<vector>\n#include<algorithm>\nusing namespace std;\nconst int dx[]={0,-1,0,1};\nconst int dy[]={-1,0,1,0};\nint main(){\n    int n;\n    while(cin>>n,n){\n        char s,t,b;\n        cin>>s>>t>>b;\n        int dp[2][3][3];\n        fill_n(**dp,18,0);\n        s-='A';t-='A';b-='A';\n        dp[0][s/3][s%3]=1;\n        for(int k=0;k<n;k++){\n            for(int i=0;i<3;i++){\n                for(int j=0;j<3;j++){\n                    for(int l=0;l<4;l++){\n                        int ty=i+dy[l];\n                        int tx=j+dx[l];\n                        if(tx<0||tx>=3||ty<0||ty>=3||ty*3+tx==b){\n                            dp[(k+1)&1][i][j]+=dp[k&1][i][j];\n                        }\n                        else dp[(k+1)&1][ty][tx]+=dp[k&1][i][j];\n                    }\n                    dp[k&1][i][j]=0;\n                }\n            }\n        }\n        int sum=0;\n        for(int i=0;i<3;i++)\n            for(int j=0;j<3;j++)\n                sum+=dp[n&1][i][j],cout<<dp[n&1][i][j]<<endl;\n\n        cout<<fixed<<(double)dp[n&1][t/3][t%3]/sum<<endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cctype>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iomanip>\n#include <iostream>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 30;\n\ntypedef vector<double> vec;\ntypedef vector<vec> mat; \n\nmat mul(mat &A,mat &B){\n\tmat C( A.size(),vec(B[0].size() ));\n\tfor(int i=0;i<A.size();i++)\n\t\tfor(int k=0;k<B.size();k++)\n\t\t\tfor(int j=0;j<B[0].size();j++)\n\t\t\t\tC[i][j]=(C[i][j]+A[i][k]*B[k][j])/*%M*/;\n\treturn C;\n}\n\nmat pow(mat A,ll n){\n\tmat B(A.size(),vec(A[0].size()));\n\tfor(int i=0;i<A.size();i++)\n\t\tB[i][i]=1;\n\twhile(n>0){\n\t\tif(n&1) B=mul(B,A);\n\t\tA=mul(A,A);\n\t\tn >>=1;\n\t}\n\treturn B;\n}\n\nint main(void){\n\tint n;\n\twhile(cin >> n,n){\n\t\tchar s,t,b;\n\t\tcin >> s >> t >> b;\n\t\ts-='A';t-='A';b-='A';\n\t\tmat A(9,vec(9));\n\t\tmat x(9,vec(1));\n\n\t\trep(i,9){\n\t\t\trep(j,9) A[i][j]=0.0;\n\t\t\tint d[4]={-3,-1,1,3};\n\t\t\tint tmp=0;\n\t\t\trep(j,4){\n\t\t\t\tint cx=i%3,cy=i/3;\n\t\t\t\tint nx=(i+d[j])%3,ny=(i+d[j])/3;\n\t\t\t\tif(0<=i+d[j]&&i+d[j]<9&&i+d[j]!=b&&(cx==nx||cy==ny))\n\t\t\t\t\tA[i][i+d[j]]=0.25;\n\t\t\t\telse\n\t\t\t\t\ttmp++;\n\t\t\t}\n\t\t\tA[i][i]=0.25*tmp;\n\n\t\t\t//rep(j,9) cout << A[i][j] << \" \";\n\t\t\t//cout << endl;\n\t\t}\n\t\trep(i,9) x[i][0]=(i==s?1.0:0.0);\n\n\t\tA=pow(A,n);\n\t\tx=mul(A,x);\n\t\tcout << x[t][0] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstring>\n#include <cmath>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <sstream>\nusing namespace std;\n\nint n;\nlong cnt,as;\nchar s,t,b,field[3][3];\nconst int dy[]={-1,0,1,0};\nconst int dx[]={0,1,0,-1};\n\nvoid search(int x,int y,int c){\n  int tx,ty;\n  if(c==0){\n    if(field[y][x]==2)as++;\n    cnt++;\n    return;\n  }\n  for(int k=0;k<4;k++){\n    tx=x+dx[k];\n    ty=y+dy[k];\n    if(tx<0 || ty<0 || tx>=3 || ty>=3){ cnt++; continue;}\n    if(field[ty][tx]==1){\n      search(x,y,c-1);\n    }else{\n      search(tx,ty,c-1);\n    }\n  }\n}\nint main(){\n  for(;cin>>n,n;){\n    cin.ignore();\n    cnt=as=0;\n    scanf(\" %c %c %c \",&s,&t,&b);\n    memset(field,0,sizeof(field));\n    int x= s=='A'||s=='D'||s=='G'?0:s=='B'||s=='E'||s=='H'?1:2;\n    int y= s=='A'||s=='B'||s=='C'?0:s=='D'||s=='E'||s=='F'?1:2;\n    \n    int p= t=='A'||t=='D'||t=='G'?0:t=='B'||t=='E'||t=='H'?1:2;\n    int q= t=='A'||t=='B'||t=='C'?0:t=='D'||t=='E'||t=='F'?1:2;\n    field[q][p]=2;\n\n    int u= b=='A'||b=='D'||b=='G'?0:b=='B'||b=='E'||b=='H'?1:2;\n    int t= b=='A'||b=='B'||b=='C'?0:b=='D'||b=='E'||b=='F'?1:2;\n    field[t][u]=1;\n\n    search(x,y,n);\n    printf(\"%.8lf\\n\",(double)as/(double)cnt);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<map>\n#include<cstdio>\n\n#define X first\n#define Y second\n\nusing namespace std;\n\ntypedef pair<int,int> P;\n\nint dx[4]={0,0,1,-1};\nint dy[4]={1,-1,0,0};\nstring idx=\"ABCDEFGHI\";\n\nint main(void){\n\t\n\tmap<char,P> mp;\n\tint cnt=0,b;\n\t\n\tfor(int i=0;i<3;i++)\n\t\tfor(int j=0;j<3;j++)mp[idx[cnt++]]=P(i,j);\n\t\n\tP s,t,d;\n\tchar S,T,D;\n\twhile(cin >> b >> S >> T >> D){\n\t\t\n\t\ts.X=mp[S].X,s.Y=mp[S].Y;\n\t\tt.X=mp[T].X,t.Y=mp[T].Y;\n\t\td.X=mp[D].X,d.Y=mp[D].Y;\n\t\t\n\t\tdouble dp[16][3][3];\n\t\t\n\t\tfor(int i=0;i<16;i++)\n\t\t\tfor(int j=0;j<3;j++)\n\t\t\t\tfor(int k=0;k<3;k++)dp[i][j][k]=0;\n\t\t\n\t\tdp[0][s.Y][s.X]=1;\n\t\t\n\t\tfor(int k=0;k<b;k++){\n\t\t\tfor(int x=0;x<3;x++){\n\t\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\t\tfor(int i=0;i<4;i++){\n\t\t\t\t\t\tint nx=x+dx[i],ny=y+dy[i];\n\t\t\t\t\t\tif(nx<0 || ny<0 || 2<nx || 2<ny || (nx==d.X && ny==d.Y))nx=x,ny=y;\n\t\t\t\t\t\tdp[k+1][ny][nx]+=dp[k][y][x]/4;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8f\\n\",dp[b][t.Y][t.X]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\ntypedef vector <int> VI;\ntypedef vector <VI> VVI;\n\nconst int dx[4] = { 0, 0, 1, -1 };\nconst int dy[4] = { 1, -1, 0, 0 };\n\nint get_x( char c )\n{\n\tif ( c == 'A' || c == 'D' || c == 'G' ) return 0;\n\tif ( c == 'B' || c == 'E' || c == 'H' ) return 1;\n\tif ( c == 'C' || c == 'F' || c == 'I' ) return 2;\n\treturn -1;\n}\n\nint get_y( char c )\n{\n\tif ( c == 'A' || c == 'B' || c == 'C' ) return 0;\n\tif ( c == 'D' || c == 'E' || c == 'F' ) return 1;\n\tif ( c == 'G' || c == 'H' || c == 'I' ) return 2;\n\treturn -1;\n}\n\n\nint main( void )\n{\n\tint n; char s, t, b;\n\twhile ( 1 )\n\t{\n\t\tcin >> n;\n\t\tif ( n == 0 ) break;\n\t\tcin >> s >> t >> b;\n\n\t\tint sx, sy, gx, gy, ox, oy;\n\t\tsx = get_x( s ); sy = get_y( s );\n\t\tgx = get_x( t ); gy = get_y( t );\n\t\tox = get_x( b ); oy = get_y( b );\n\n\t\tVVI prev( 3, VI(3,0) ), next;\n\t\tprev[sy][sx] = 1;\n\t\tfor ( int lpc = 0; lpc < n; lpc++ )\n\t\t{\n\t\t\tnext = VVI( 3, VI( 3, 0 ) );\n\t\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ )\n\t\t\t{\n\t\t\t\tif ( i == oy && j == ox ) continue;\n\t\t\t\tbool stop = 0;\n\t\t\t\tfor ( int k = 0; k < 4; k++ )\n\t\t\t\t{\n\t\t\t\t\tint nx = j + dx[k];\n\t\t\t\t\tint ny = i + dy[k];\n\t\t\t\t\tif ( nx < 0 || nx >= 3 || ny < 0 || ny >= 3 )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( nx == ox && ny == oy )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnext[i][j] += prev[ny][nx];\n\t\t\t\t}\n\t\t\t\tif ( stop )\n\t\t\t\t{\n\t\t\t\t\tnext[i][j] += prev[i][j];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tprev = next;\n\t\t}\n\n\t\tint sum = 0;\n\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ ) sum += next[i][j];\n\n\t\tdouble answer = (double)next[gy][gx] / (double)sum;\n\n\t\tcout.precision( 8 );\n\t\tcout.setf( ios::fixed );\n\t\tcout << answer << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n)for(int i=0;i<n;i++)\nusing namespace std;\ntypedef pair<char, int>P;\n\nchar dir[4][4]{ \"ABC\",\"DEF\",\"GHI\" };\nint dx[]{ 1,-1,0,0 }, dy[]{ 0,0,1,-1 };\nint main() {\n\tint n;\n\twhile (cin >> n, n) {\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tint sum = 0, cnt = 0;\n\t\tqueue<P>que;\n\t\tque.push(P(s, n));\n\t\twhile (!que.empty()) {\n\t\t\tP p = que.front(); que.pop();\n\t\t\tif (!p.second) {\n\t\t\t\tsum++;\n\t\t\t\tif (p.first == t)cnt++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tint x = (p.first - 'A') / 3, y = (p.first - 'A') % 3;\n\t\t\trep(i, 4) {\n\t\t\t\tint nx = x + dx[i], ny = y + dy[i];\n\t\t\t\tif (nx < 0 || nx >= 3 || ny < 0 || ny >= 3 || dir[nx][ny] == b) {\n\t\t\t\t\tnx = x; ny = y;\n\t\t\t\t}\n\t\t\t\tque.push(P(dir[nx][ny], p.second - 1));\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.7lf\\n\", (double)cnt / (double)sum);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<cstring>\n#include<string>\nusing namespace std;\nchar fie[4][4]={\"ABC\",\n\t\t\"DEF\",\n\t\t\"GHI\"};\nint N;\nchar s,t,b;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\ndouble dp[16][4][4];\nint used[16][4][4];\ndouble solve(int no,int x,int y){\n  if(no==N){\n    if(fie[x][y]==t) return 1.0f;\n    return 0.0f;\n  }\n  if(used[no][x][y]) return dp[no][x][y];\n  double ret=0.0f;\n  for(int i=0;i<4;i++){\n    int nx = x+dx[i],ny = y+dy[i];\n    if( nx < 0 || ny < 0 || nx>=3 || ny>=3 || fie[ny][nx]==b){\n      ret += solve(no+1,x,y)/4.0f;\n    } else{\n      ret += solve(no+1,nx,ny)/4.0f;\n    }\n  }\n  used[no][x][y]=1;\n  return dp[no][x][y]=ret;\n}\nint main(){\n  while(1){\n    int x,y;\n    cin >> N;\n    if(!N) break;\n    memset(dp,0,sizeof(dp));\n    memset(used,0,sizeof(used));\n    cin >> s >> t >> b;\n    for(int i=0;i<3;i++)\n      for(int j=0;j<3;j++)\n\tif(fie[i][j]==s){\n\t  x=j; y=i;\n\t}\n    printf(\"%.9lf\\n\",solve(0,x,y));\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\nusing namespace std;\n\nint y11(string);\nint x11(string);\n\n    int main(){\n\n\tint n;\n\tstring st,ba,sto;\n\tint dx[] = {0,1,0,-1};\n\tint dy[] = {1,0,-1,0};\n\tint ma[3][3] = {{0,0,0},\n                       {0,0,0},\n                       {0,0,0}};\n\n\twhile(true){\n\t  cin >> n;\n\t    double dp[15][4][4];\n\t    for(int i=0;i<15;i++)for(int j=0;j<4;j++)for(int k=0;k<4;k++)dp[i][j][k]=0.0;\n\t    if(n == 0)break;\n\t    cin >> st;\n\t    cin >> ba;\n\t    cin >> sto;\n\t    ma[y11(st)][x11(st)]=1;//X^[g\n\t    ma[y11(ba)][x11(ba)]=9;//[d\n\t    ma[y11(sto)][x11(sto)]=8;//qÉ\n\n\t    int nx,ny;\n\t \t   \n\t    dp[n][y11(st)][x11(st)]=1.0;\n\n\t    while(true){\n\t\tif(n == 0)break;\n\n\t\t\n\t\tfor(int t=0;t<2;t++){\n\t\t    for(int g =0 ;g<2;g++){\n\t\t\tfor(int i=0;i<4;i++){\n\t\t\t    nx = g+dx[i];\n\t\t\t    ny = t+dy[i];\t\t    \n\t\t\t    if(nx>2 || ny>2 ||nx<0 || ny<0)continue;\n\t\t\t    if(nx == x11(sto) && ny == y11(sto)){nx = g;\n\t\t\t\tny = t;\n\t\t\t    }\n\t\t\t    dp[n-1][ny][nx] += dp[n][t][g]/4.0;\t\t    \n\t\t\t}\n\t\t    }\n\t\t}\n\t\tn--;\n\n\t    }\n \n\t    // ----------------DEBUG--------------//\n\t    /*   \n\t\tfor(int g=0;g<3;g++){\n\t\t    for(int f=0;f<3;f++){\n\t\t\tSystem.out.print(dp[0][g][f] + \" \");\n\t\t    }\n\tSystem.out.printf(\"\\n\");\n\t\t}\n\t\n\t\t*/\n\t    //----------------DEBUG---------------//\n\t    //   DecimalFormat dc = new DecimalFormat();\n\t \n\t    printf(\"%.8f\\n\",dp[0][y11(ba)][x11(ba)]);\n\n\n\t      }\n\n\n    }\n\n    \n\n    int y11(string s){\n      if(s == \"A\")return 0;\n\tif(s == \"B\")return 0;\n\tif(s==\"C\")return 0;\n\tif(s==\"D\")return 1;\n\tif(s==\"E\")return 1;\n\tif(s==\"F\")return 1;\n\tif(s==\"G\")return 2;\n\tif(s==\"H\")return 2;\n\tif(s ==\"I\")return 2;\n\n\treturn 9; //±êªÈ¢Æ½©returnµëIÆ¢¤G[ªÅÄ­éÌÅKÉ9ðÔ·æ¤ÉµÆ¢½@x11Ìreturn 9;à¯¶R\n    }\n    int x11(string s){\n\tif(s==\"A\")return 0;\n\tif(s==\"B\")return 1;\n\tif(s==\"C\")return 2;\n\tif(s==\"D\")return 0;\n\tif(s==\"E\")return 1;\n\tif(s==\"F\")return 2;\n\tif(s==\"G\")return 0;\n\tif(s==\"H\")return 1;\n\tif(s==\"I\")return 2;\n\n\treturn 9;\n    }\n\n\n\n\n\n\n\n/*@Yê½Ì´êpðà\n\nQ:3d[vÌÆ±ÈÉµÄñÌH\nA:®SÌðÝÄ(n-i)ñ(i=0,1,EEE,n Å n=0Ìnñ®¢½Ê n=nÌ1ñ®¢½Ê)ÌÊð¾µÄé\nµ¢m¦Å®­©ç1ñ®¢½ç4ÅêÎ¢¢\n\nàµ±êæñÅàí©çÈ¢pÈçvOÌDEBUGð\\¦³¹Ä®«ðmFµÄÝéÆ¢¢\nn=0ÆÈÁÄ¢é©çwè³ê½ñ®¢½Êð\\¦·éæ¤ÉÈÁÄ¢é\n\n*/"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cmath>\n#define N 3\n#define N1 16\nusing namespace std;\nvoid func(int,int,int);\nint n,k,data[N][N],memo[N1][N][N];\nint dy[N+1]={-1,0,1,0};\nint dx[N+1]={0,1,0,-1};\nbool visited[N1][N][N];\nchar s,t,b;\n\nint main(){\n  while(1){\n    cin >> n;\n    if(!n) break;\n    cin >> s >> t >> b;\n    for(int i=0;i<N;i++){\n      for(int j=0;j<N;j++){\n\tdata[i][j]=0;\n\tfor(int k=0;k<N1;k++){\n\t  memo[k][i][j]=0;\n\t  visited[k][i][j]=false;\n\t}\n      }\n    }\n    data[(t-'A')/N][(t-'A')%N]=1;\n    data[(b-'A')/N][(b-'A')%N]=-1;\n    visited[0][(s-'A')/N][(s-'A')%N]=true;\n    func((s-'A')/N,(s-'A')%N,0);\n    k=pow(4,n);\n    printf(\"%.8f\\n\",1.0*memo[0][(s-'A')/N][(s-'A')%N]/k);\n  }\n  return 0;\n}\n\nvoid func(int y,int x,int d){\n  if(d==n){\n    if(data[y][x]==1) memo[d][y][x]=1;\n    return ;\n  }\n  for(int i=0;i<N+1;i++){\n    int ny=y+dy[i],nx=x+dx[i];\n    if(ny<0||nx<0||N<ny||N<nx||data[ny][nx]==-1){\n      if(visited[d+1][y][x]==false){\n\tvisited[d+1][y][x]=true;\n\tfunc(y,x,d+1);\t\n      }\n      memo[d][y][x]+=memo[d+1][y][x];\n    }\n    else{\n      if(visited[d+1][ny][nx]==false){\n\tvisited[d+1][y][x]=true;\n\tfunc(ny,nx,d+1);\n      }\n      memo[d][y][x]+=memo[d+1][ny][nx];\n    }\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define LL long long\n#define VI vector<int>\n#define VVI vector<vector<int>>\n#define VVVI vector<vector<vector<int>>>\n#define VL vector<LL>\n#define VVL vector<vector<LL>>\n#define VVVL vector<vector<vector<LL>>>\n#define VB vector<bool>\n#define FOR(i,a,b) for(int i= (a); i<((int)b); ++i)\n#define RFOR(i,a) for(int i=(a); i >= 0; --i)\n#define FOE(i,a) for(auto i : a)\n#define ALL(c) (c).begin(), (c).end()\n#define RALL(c) (c).rbegin(), (c).rend()\n#define DUMP(x)  cerr << #x << \" = \" << (x) << endl;\n#define SUM(x) std::accumulate(ALL(x), 0LL)\n#define MIN(v) *std::min_element(v.begin(), v.end())\n#define MAX(v) *std::max_element(v.begin(), v.end())\n#define EXIST(v,x) (std::find(v.begin(), v.end(), x) != v.end())\n#define BIT(n) (1LL<<(n))\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end());\n#define EPS 1e-14\n\ntemplate<class T> T ceil(T a, T b) { return (a + b - 1) / b; }\ntemplate<class T> void print(T x) { std::cout << x << std::endl; }\nbool inside(int y, int x, int H, int W) {return 0 <= y and y < H and 0 <= x and x < W; }\n\nconst std::string YES = \"YES\", Yes = \"Yes\", NO = \"NO\", No = \"No\";\nconst std::vector<int> dy = { 0, 1, 0, -1 }, dx = { 1, 0, -1, 0 };    // 4近傍（右, 下, 左, 上）\n\n\nusing namespace std;\n\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while (true) {\n        int N;\n        cin >> N;\n        if (N == 0) { break; }\n        char S, T, B;\n        cin >> S >> T >> B;\n        int sy = (S - 'A') / 3;\n        int sx = (S - 'A') % 3;\n        int ty = (T - 'A') / 3;\n        int tx = (T - 'A') % 3;\n        int by = (B - 'A') / 3;\n        int bx = (B - 'A') % 3;\n\n        vector<vector<vector<double>>> dp(N + 1, vector<vector<double>>(3, vector<double>(3, 0)));\n        dp[N][sy][sx] = 1;\n\n        queue<tuple<int, int, int>> que;\n        que.push({N, sy, sx});\n\n        while (not que.empty()) {\n            int rest, y, x;\n            tie(rest, y, x) = que.front(); que.pop();\n            if (rest == 0) {\n                continue;\n            }\n\n            FOR(i, 0, 4) {\n                int ny = y + dy[i];\n                int nx = x + dx[i];\n\n                if (inside(ny, nx, 3, 3) and not (ny == by and nx == bx)) {\n                    dp[rest - 1][ny][nx] += dp[rest][y][x] * 0.25;\n                    que.push({rest - 1, ny, nx});\n                }\n                else {\n                    dp[rest - 1][y][x] += dp[rest][y][x] * 0.25;\n                    que.push({rest - 1, y, x});\n                }\n            }\n        }\n        print(dp[0][ty][tx]);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<string>\n#include<map>\n#include<cstdio>\n  \n#define f first\n#define s second\n  \nusing namespace std;\n  \ntypedef pair<int,int> P;\n  \nint dx[4]={0,0,1,-1};\nint dy[4]={1,-1,0,0};\n  \nint main(void){\n  \nint n,id=0;\nstring s=\"ABCDEFGHI\";\nchar s,t,d;\nmap<char,P>mp;\n  \nfor(int i=0;i<3;i++){\nfor(int j=0;j<3;j++){\nmp[s[id++]]=P(j,i);\n}\n}\n  \nwhile(cin >> n,n){\ncin >> s >> t >> d;\nP S=mp[s],T=mp[t],D=mp[d];\n  \ndouble dp[16][3][3];\n  \nfor(int k=0;k<16;k++)\nfor(int i=0;i<3;i++)\nfor(int j=0;j<3;j++)dp[k][i][j]=0;\n  \ndp[0][S.s][S.f]=1;\n  \nfor(int k=0;k<n;k++){\nfor(int i=0;i<3;i++){\nfor(int j=0;j<3;j++){\nfor(int l=0;l<4;l++){\nint nx=j+dx[l],ny=i+dy[l];\nif(nx<0 || ny<0 || 2<nx || 2<ny || \n(nx==D.s&&ny==D.f))nx=j,ny=i;\ndp[k+1][ny][nx]+=dp[k][i][j]/4;\n}\n}\n}\n}\nprintf(\"%.8f\\n\",dp[n][T.s][T.f]);\n}\n  \nreturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\nusing namespace std;\n\nint y11(string);\nint x11(string);\n\n    int main(){\n\n\tint n;\n\tstring st,ba,sto;\n\tint dx[] = {0,1,0,-1};\n\tint dy[] = {1,0,-1,0};\n\tint ma[3][3] = {{0,0,0},\n                       {0,0,0},\n                       {0,0,0}};\n\n\twhile(true){\n\t  cin >> n;\n\t    double dp[15][4][4];\n\t    for(int i=0;i<15;i++)for(int j=0;j<4;j++)for(int k=0;k<4;k++)dp[i][j][k]=0.0;\n\t    if(n == 0)break;\n\t    cin >> st;\n\t    cin >> ba;\n\t    cin >> sto;\n\t    ma[y11(st)][x11(st)]=1;//X^[g\n\t    ma[y11(ba)][x11(ba)]=9;//[d\n\t    ma[y11(sto)][x11(sto)]=8;//qÉ\n\n\t    int nx,ny;\n\t \t   \n\t   \n\n\t    while(true){\n\t\tif(n == 0)break;\n dp[n][y11(st)][x11(st)]=1.0;\n\t\t\n\t\tfor(int t=0;t<2;t++){\n\t\t    for(int g =0 ;g<2;g++){\n\t\t\tfor(int i=0;i<4;i++){\n\t\t\t    nx = g+dx[i];\n\t\t\t    ny = t+dy[i];\t\t    \n\t\t\t    if(nx>2 || ny>2 ||nx<0 || ny<0)continue;\n\t\t\t    if(nx == x11(sto) && ny == y11(sto)){nx = g;\n\t\t\t\tny = t;\n\t\t\t    }\n\t\t\t    dp[n-1][ny][nx] += dp[n][t][g]/4.0;\t\t    \n\t\t\t}\n\t\t    }\n\t\t}\n\t\tn--;\n\n\t    }\n \n\t    // ----------------DEBUG--------------//\n\t    /*\n\t\tfor(int g=0;g<3;g++){\n\t\t    for(int f=0;f<3;f++){\n\t\t    cout << dp[0][g][f] << \" \";\n\t\t    }\n\t\t    cout << endl;\n\t\t} */\n\t\n\t\t\n\t    //----------------DEBUG---------------//\n\t    //   DecimalFormat dc = new DecimalFormat();\n\t \n\t    printf(\"%.8f\\n\",dp[1][y11(ba)][x11(ba)]);\n\n\n\t      }\n\n\n    }\n\n    \n\n    int y11(string s){\n      if(s == \"A\")return 0;\n\tif(s == \"B\")return 0;\n\tif(s==\"C\")return 0;\n\tif(s==\"D\")return 1;\n\tif(s==\"E\")return 1;\n\tif(s==\"F\")return 1;\n\tif(s==\"G\")return 2;\n\tif(s==\"H\")return 2;\n\tif(s ==\"I\")return 2;\n\n\treturn 9; //±êªÈ¢Æ½©returnµëIÆ¢¤G[ªÅÄ­éÌÅKÉ9ðÔ·æ¤ÉµÆ¢½@x11Ìreturn 9;à¯¶R\n    }\n    int x11(string s){\n\tif(s==\"A\")return 0;\n\tif(s==\"B\")return 1;\n\tif(s==\"C\")return 2;\n\tif(s==\"D\")return 0;\n\tif(s==\"E\")return 1;\n\tif(s==\"F\")return 2;\n\tif(s==\"G\")return 0;\n\tif(s==\"H\")return 1;\n\tif(s==\"I\")return 2;\n\n\treturn 9;\n    }\n\n\n\n\n\n\n\n/*@Yê½Ì´êpðà\n\nQ:3d[vÌÆ±ÈÉµÄñÌH\nA:®SÌðÝÄ(n-i)ñ(i=0,1,EEE,n Å n=0Ìnñ®¢½Ê n=nÌ1ñ®¢½Ê)ÌÊð¾µÄé\nµ¢m¦Å®­©ç1ñ®¢½ç4ÅêÎ¢¢\n\nàµ±êæñÅàí©çÈ¢pÈçvOÌDEBUGð\\¦³¹Ä®«ðmFµÄÝéÆ¢¢\nn=0ÆÈÁÄ¢é©çwè³ê½ñ®¢½Êð\\¦·éæ¤ÉÈÁÄ¢é\n\n*/"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <sstream>\n#include <map>\n#include <set>\n\n#define REP(i,k,n) for(int i=k;i<n;i++)\n#define rep(i,n) for(int i=0;i<n;i++)\n#define INF 1<<30\n#define pb push_back\n#define mp make_pair\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nint n;\nchar s, t, b;\ndouble d, a;\n\nint dy[4] = {1,0, -1, 0};\nint dx[4] = {0,1, 0, -1};\nchar v[3][3] = { {'A', 'B', 'C'},\n                 {'D', 'E', 'F'},\n                 {'G', 'H', 'I'} };\n\nbool can(int y,int x) {\n    if(0 <= y && y < 3 && 0 <= x && x < 3) return true;\n    return false;\n}\n\nvoid dfs(int y,int x, int cnt) {\n    if(cnt == 0) {\n        a++;\n        if(v[y][x] == t) d++;\n        return;\n    }\n\n    rep(i,4) {\n        int ny = y + dy[i];\n        int nx = x + dx[i];\n\n        if(can(ny,nx) && v[ny][nx] != b) {\n            dfs(ny,nx, cnt-1);\n        } else {\n            dfs(y,x, cnt-1);\n        }\n    }\n\n}\n\nint main() {\n    while(cin >> n && n) {\n        cin >> s >> t >> b;\n\n        d = 0;\n        a = 0;\n        \n        rep(i, 3) {\n            rep(j, 3) {\n                if(v[i][j] == s) {\n                    dfs(i,j,n);\n                }\n            }\n        }\n        \n        cout << fixed;\n        cout.precision(20);\n        cout << (d / a) << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <cstring>\nusing namespace std;\nstatic const double EPS = 1e-5;\ntypedef long long ll;\n\n\ndouble p[5][5];\ndouble ne[5][5];\n\nchar s,t,b;\n\n\ndouble pp(int x,int y){\n\tif(b/3+1==x && b%3+1==y)return 0;\n\telse return p[x][y];\n}\n\nint main(){\n\tint n;\n\t\n\twhile(cin>>n){\n\t\tif(n==0)break;\n\t\t\n\t\tcin>>s>>t>>b;\n\t\t\n\t\ts-='A';\n\t\tt-='A';\n\t\tb-='A';\n\t\t\n\t\tfor(int i=0;i<5;i++){\n\t\t\tfor(int j=0;j<5;j++){\n\t\t\t\tp[i][j]=0;\n\t\t\t\tne[i][j]=0;\n\t\t\t}\n\t\t}\n\t\t\n\t\tp[s/3+1][s%3+1]=1;\n\t\t\n\t\twhile(n){\n\t\t\tn--;\n\t\t\tfor(int i=1;i<=3;i++){\n\t\t\t\tfor(int j=1;j<=3;j++){\n\t\t\t\t\tne[i][j]=(pp(i+1,j)+pp(i-1,j)+pp(i,j+1)+pp(i,j-1))/4;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemcpy(p,ne,sizeof(ne));\n\t\t}\n\t\t\n\t\tcout<<pp(t/3+1,t%3+1)<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <vector>\n#include <string>\n#include <map>\n#include <sstream>\n#include <queue>\n#include <cstdlib>\n#include <algorithm>\n#include <iterator>\n#include <stack>\n#include <list>\nusing namespace std;\n#define INF 100000000\ntypedef long long int lli;\ntypedef pair<int,int> P;\ndouble dp[16][9];\n\nvoid room(char c,int &x){\n\tswitch(c){\n\t\tcase 'A':\n\t\tx=0;\n\t\tbreak;\n\t\t\n\t\tcase 'B':\n\t\tx=1;\n\t\tbreak;\n\t\t\n\t\tcase 'C':\n\t\tx=2;\n\t\tbreak;\n\t\t\t\n\t\tcase 'D':\n\t\tx=3;\n\t\tbreak;\n\t\t\n\t\tcase 'E':\n\t\tx=4;\n\t\tbreak;\n\t\t\n\t\tcase 'F':\n\t\tx=5;\n\t\tbreak;\n\t\t\n\t\tcase 'G':\n\t\tx=6;\n\t\tbreak;\n\t\t\n\t\tcase 'H':\n\t\tx=7;\n\t\tbreak;\n\t\t\n\t\tcase 'I':\n\t\tx=8;\n\t\tbreak;\n\t\t\n\t\tdefault:\n\t\tbreak;\n\t}\n}\n\nint main(){\n\tint n;\n\twhile(cin>>n&&n){\n\t\tchar s,t,b;\n\t\tcin >> s >> t >> b;\n\t\tint sr,tr,br;\n\t\troom(s,sr);\n\t\troom(t,tr);\n\t\troom(b,br);\n\t\tcout << sr << \" \" << tr << \" \" << br << \"\\n\";\n\t\tfor(int i=0; i<=n; ++i){\n\t\t\tfor(int j=0; j<9; ++j){\n\t\t\t\tdp[i][j]=0;\n\t\t\t}\n\t\t}\n\t\tdp[0][sr]=1;\n\t\tfor(int i=1; i<=n; ++i){\n\t\t\tfor(int j=0; j<9; ++j){\n\t\t\t\tif(j!=br){\n\t\t\t\t\tswitch(j){\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][1]/2+dp[i-1][3]/2+dp[i-1][0])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][0]+dp[i-1][4]+dp[i-1][2]+dp[i-1][1])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][1]/2+dp[i-1][5]/2+dp[i-1][2])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][0]+dp[i-1][4]+dp[i-1][6]+dp[i-1][3])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][1]+dp[i-1][5]+dp[i-1][7]+dp[i-1][3])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\t\tcase 5:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][2]+dp[i-1][4]+dp[i-1][8]+dp[i-1][5])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 6:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][3]/2+dp[i-1][7]/2+dp[i-1][6])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 7:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][6]+dp[i-1][4]/2+dp[i-1][8]/2+dp[i-1][7]/2)/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 8:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][5]/2+dp[i-1][7]/2+dp[i-1][8])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << dp[n][tr] << \"\\n\";\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<algorithm>\n#include<array>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<functional>\n#include<limits>\n#include<list>\n#include<map>\n#include<numeric>\n#include<set>\n#include<stack>\n#include<string>\n#include<sstream>\n#include<unordered_map>\n#include<queue>\n#include<vector>\nusing namespace std;\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing pii = pair<int, int>;\n\n#define rep(i,a,b) for(int i=(a);i<(b);i++)\n#define rrep(i,a,b) for(int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n#define dump(o) {cerr<<#o<<\" \"<<o<<endl;}\n#define dumpc(o) {cerr<<#o; for(auto &e:(o))cerr<<\" \"<<e;cerr<<endl;}\n#define INF 0x3f3f3f3f\n#define INFL 0x3f3f3f3f3f3f3f3fLL\nconst int MOD = 1e9 + 7;\n\nint di[4] = { 1,0,-1,0 };\nint dj[4] = { 0,1,0,-1 };\n\nsigned main() {\n\tcout << fixed << setprecision(8);\n\tfor (int n; cin >> n&&n;) {\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tdouble f[3][3] = {};\n\t\tdouble g[3][3] = {};\n\t\tpii S, T, B;\n\t\tS = pii((s - 'A') / 3, (s - 'A') % 3);\n\t\tT = pii((t - 'A') / 3, (t - 'A') % 3);\n\t\tB = pii((b - 'A') / 3, (b - 'A') % 3);\n\t\tf[S.first][S.second] = 1;\n\t\twhile (n--) {\n\t\t\trep(i, 0, 3)rep(j, 0, 3)g[i][j] = 0;\n\t\t\tswap(f, g);\n\t\t\trep(a, 0, 3) rep(b, 0, 3) {\n\t\t\t\tint cnt = 0;\n\t\t\t\t//rep(i, 0, 4) {\n\t\t\t\t//\tif (a + di[i] == B.first&&b + dj[i] == B.second) continue;\n\t\t\t\t//\tif (0 > a + di[i] && a + di[i] > 2)continue;\n\t\t\t\t//\tif (0 > b + dj[i] && b + dj[i] > 2)continue;\n\t\t\t\t//\tf[a + di[i]][b + dj[i]] += g[a][b] / 4;\n\t\t\t\t//\tcnt++;\n\t\t\t\t//}\n\t\t\t\tf[a][b] += (g[a][b] / 4)*(4 - cnt);\n\t\t\t}\n\t\t}\n\t\tcout << f[T.first][T.second] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cmath>\n#include<cstdio>\n#include<cstring>\n\n#define\trep(i,n)\tfor(int i=0;i<(n);i++)\n\nusing namespace std;\n\nconst int dx[]={1,0,-1,0},dy[]={0,-1,0,1};\n\nint tx,ty,bx,by,memo[3][3][16];\n\nvoid f(char c,int &x,int &y){\n\tx=(c-'A')%3;\n\ty=(c-'A')/3;\n}\n\nint dfs(int x,int y,int batt){\n\tif(~memo[y][x][batt])\treturn memo[y][x][batt];\n\tif(batt==0)\treturn (x==tx && y==ty);\n\n\tint cnt=0;\n\trep(i,4){\n\t\tint xx=x+dx[i],yy=y+dy[i];\n\t\tif(0<=xx && xx<3 && 0<=yy && yy<3 && !(xx==bx && yy==by));\n\t\telse\txx=x,yy=y;\n\t\tcnt+=dfs(xx,yy,batt-1);\n\t}\n\treturn memo[y][x][batt]=cnt;\n}\n\nint main(){\n\tint n;\n\tfor(char s,t,b;scanf(\"%d %c %c %c\",&n,&s,&t,&b),n;){\n\t\tmemset(memo,-1,sizeof(memo));\n\t\tint sx,sy;\n\t\tf(s,sx,sy);\n\t\tf(t,tx,ty);\n\t\tf(b,bx,by);\n\t\tprintf(\"%.9f\\n\",dfs(sx,sy,n)/pow(4.0,n));\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\nusing namespace std;\nint mp[3][3],dx[] = {0,0,-1,1},dy[] = {1,-1,0,0};\nint n;\nchar s,t,b;\nint memo[16][3][3],visited[16][3][3];\nvoid saiki(int x,int y,int bat){\n  visited[bat][x][y] = 1;\n  if(n == bat) {\n    if((t-'A')%3==x&&(t-'A')/3==y)memo[bat][x][y]=1;\n    return;\n  }\n  for(int i=0;i<4;i++){\n    int nx = x+dx[i],ny = y+dy[i];\n    if(((b-'A')%3==nx && (b-'A')/3==ny)||nx<0||ny <0||nx>=3||ny>=3) {\n      if(visited[bat+1][x][y]==1) memo[bat][x][y] += memo[bat+1][x][y];\n      else saiki(x,y,bat+1),memo[bat][x][y] += memo[bat+1][x][y];\n    }\n    else {\n      if(visited[bat+1][nx][ny]==1) memo[bat][x][y] += memo[bat+1][nx][ny];\n      else saiki(nx,ny,bat+1),memo[bat][x][y] += memo[bat+1][nx][ny];\n    }\n  }\n}\nint main() {\n  while(1) {\n    cin >> n;\n    if(n==0) break;\n    cin >> s >> t >> b;\n    for(int i=0;i<=n;i++)\n      for(int j=0;j<3;j++)\n\tfor(int k=0;k<3;k++) memo[i][j][k] = visited[i][j][k]=0;\n    saiki((s-'A')%3,(s-'A')/3,0);\n    int ans = memo[0][(s-'A')%3][(s-'A')/3];\n    printf(\"%.8f\\n\",1.0*ans/(1<<(2*n)));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//49\n#include<iostream>\n#include<iomanip>\n\nusing namespace std;\n\nint tx,ty,bx,by;\n\n#define tox(c) (((c)-'A')%3)\n#define toy(c) (((c)-'A')/3)\n\n/*\nint tox(char c){\n  return (c-'A')%3;\n}\n\nint toy(char c){\n  return (c-'A')/3;\n}\n*/\n\ndouble cal(int r,int y,int x,double p){\n  if(r==0){\n    return (y==ty && x==tx)?p:0;\n  }else{\n    double a=0;\n    for(int i=0;i<4;i++){\n      static const int d[]={0,1,0,-1,0};\n      int nx=x+d[i];\n      int ny=y+d[i+1];\n      if(0<=nx&&nx<3&&0<=ny&&ny<3&&!(nx==bx&&ny==by)){\n\ta+=cal(r-1,ny,nx,p/4);\n      }else{\n\ta+=cal(r-1,y,x,p/4);\n      }\n    }\n    return a;\n  }\n}\n\nint main(){\n  for(int n;cin>>n,n;){\n    char s,t,b;\n    cin>>s>>t>>b;\n    tx=tox(t);\n    ty=toy(t);\n    bx=tox(b);\n    by=toy(b);\n    cout<<fixed<<setprecision(6)<<cal(n,toy(s),tox(s),1)<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdlib.h>\n#include<iostream>\nusing namespace std;\nint s,t,b,n;\ndouble p,nn;\nint d[4]={1,3,-1,-3};\ndouble df[10][20];\nvoid dfs(int s,int n){\n\tdouble p1;\n\tif(n==0){\n\t\tif(s==t){p+=pow(0.25,nn);}\n\t\treturn;\n\t}\n\tif(df[s][n]>=0){\n\t\tp+=df[s][n];\n\t\treturn;\n\t}else{\n\t\tfor(int i=0;i<4;i++){\n\t\t\tif(s+d[i]==b){\n\t\t\t\tp1=p;\n\t\t\t\tdfs(s,n-1);\n\t\t\t\tdf[s][n-1]=p-p1;\n\t\t\t}else if(s/3!=(s+d[i])/3){\n\t\t\t\tif(d[i]*d[i]==9&&0<=s+d[i]&&s+d[i]<9){\n\t\t\t\t\tp1=p;\n\t\t\t\t\tdfs(s+d[i],n-1);\n\t\t\t\t\tdf[s+d[1]][n-1]=p-p1;\n\t\t\t\t}else{\n\t\t\t\t\tp1=p;\n\t\t\t\t\tdfs(s,n-1);\n\t\t\t\t\tdf[s][n-1]=p-p1;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tp1=p;\n\t\t\t\tdfs(s+d[i],n-1);\n\t\t\t\tdf[s+d[i]][n-1]=p-p1;\n\t\t\t}\n\t\t}\n\t}\n\treturn;\n}\nint main(){\n\twhile(1){\n\t\tchar cs,ct,cb;\n\t\tp=0;\n\t\tcin>>n;\n\t\tnn=n;\n\t\tif(n==0)break;\n\t\tfor(int i=0;i<10;i++){\n\t\t\tfor(int j=0;j<20;j++){\n\t\t\t\tdf[i][j]=-1;\n\t\t\t}\n\t\t}\n\t\tcin>>cs>>ct>>cb;\n\t\ts=(int)cs-'A';\n\t\tt=(int)ct-'A';\n\t\tb=(int)cb-'A';\n\t\tdfs(s,n);\n\t\tcout<<p<<endl;\n\t}\n\treturn 0;\n}\t"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <queue>\n\nusing namespace std;\n\nconst int EMPTY   = 0;\nconst int BATTERY = 1;\nconst int STORE   = 2;\nconst int WALL    = 3;\n\nstruct Point {\npublic:\n  int x, y;\n  Point() { }\n  Point(int x, int y): x(x), y(y) { }\n};\n\nstruct State {\npublic:\n  Point p;\n  int battery;\n  State() { };\n  State(Point p, int battery): p(p), battery(battery) { }\n};\n\nPoint int2point(int n) {\n  return Point(1 + n % 3, 1 + n / 3);\n}\n\nint field[5][5];\n\nstruct Bunsu {\npublic:\n  int bunbo;\n  int bunsi;\n  Bunsu() { }\n  Bunsu(int a, int b): bunbo(a), bunsi(b) { }  \n  Bunsu operator+=(const Bunsu& b) {\n    this->bunbo += b.bunbo;\n    this->bunsi += b.bunsi;\n    return *this;\n  }\n};\n\nBunsu memo[5][5][16];\nbool memo_b[5][5][16];\n\nBunsu calc(State s) {\n  Bunsu ret = Bunsu(0, 0);\n  if (memo_b[s.p.x][s.p.y][s.battery]) {\n    return memo[s.p.x][s.p.y][s.battery];\n  }\n  if (s.battery == 0) {\n    if (field[s.p.x][s.p.y] == BATTERY) {\n      ret.bunsi++;\n    }\n    ret.bunbo++;\n    return ret;\n  }\n  int dx[4] = { 0, -1, 1, 0 };\n  int dy[4] = { -1, 0, 0, 1 };\n  for (int i = 0; i < 4; i++) {\n    Point np = Point(s.p.x + dx[i], s.p.y + dy[i]);\n    if (field[np.x][np.y] == STORE) {\n      ret += calc(State(s.p, s.battery - 1));\n      continue;\n    }\n    if (field[np.x][np.y] == WALL) {\n      ret += calc(State(s.p, s.battery - 1));\n      continue;\n    }\n    ret += calc(State(np, s.battery - 1));\n  }\n  memo_b[s.p.x][s.p.y][s.battery] = true;\n  return memo[s.p.x][s.p.y][s.battery] = ret;\n}\n\nint main() {\n  int n, s, t, b;\n  while (true) {\n    cin >> n;\n    if (n == 0) break;\n    char cs, ct, cb;\n    cin >> cs >> ct >> cb;\n    s = cs - 'A';\n    t = ct - 'A';\n    b = cb - 'A';\n    \n    memset(field, EMPTY, sizeof(field));\n    for (int i = 0; i < 5; i++) {\n      for (int j = 0; j < 5; j++) {\n        for (int k = 0; k < 16; k++) {\n          memo[i][j][k] = Bunsu(0, 0);\n          memo_b[i][j][k] = false;\n        }\n      }\n    }\n    for (int i = 0; i < 5; i++) {\n      field[0][i] = WALL;\n      field[4][i] = WALL;\n      field[i][0] = WALL;\n      field[4][i] = WALL;\n    }\n    Point batteryPoint = int2point(t);\n    field[batteryPoint.x][batteryPoint.y] = BATTERY;\n    Point storePoint = int2point(b);\n    field[storePoint.x][storePoint.y] = STORE;\n    State nowState(int2point(s), n);\n    \n    Bunsu ans = calc(nowState);\n    printf(\"%.15lf\\n\", (double)ans.bunsi / ans.bunbo);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<fstream>\n#include<cstdio>\n#include<vector>\n#include<list>\n#include<stack>\n#include<deque>\n#include<queue>\n#include<map>\n#include<set>\n#include<algorithm>\n#include<string>\n#include<cmath>\n#include<cstdlib>\nusing namespace std;\nchar mat[][3] = {{'A','B','C'},\n\t\t {'D','E','F'},\n\t\t {'G','H','I'}\n\t\t};\nstruct state{\n\tint bat;\n\tchar pos;\n};\n\nvector<char> getLoc(char el){\n\tint x = 0,y=0;\n\tfor(int i=0;i<3;++i){\n\t\tfor(int j=0;j<3;++j){\n\t\t\tif(mat[i][j] == el){\n\t\t\t\tx = i;\n\t\t\t\ty = j;\n\t\t\t}\n\t\t}\n\t}\n\tvector<char> ret;\n\tif(x-1<0){\n\t\tret.push_back(el);\n\t}else{\n\t\tret.push_back(mat[x-1][y]);\n\t}\n\tif(y-1<0){\n\t\tret.push_back(el);\n\t}else{\n\t\tret.push_back(mat[x][y-1]);\n\t}\n\tif(y+1>2){\n\t\tret.push_back(el);\n\t}else{\n\t\tret.push_back(mat[x][y+1]);\n\t}\n\tif(x+1>2){\n\t\tret.push_back(el);\n\t}else{\n\t\tret.push_back(mat[x+1][y]);\n\t}\n\treturn ret;\n}\n\nint main(){\n\tint n;\n\twhile(scanf(\"%d\",&n)==1,n){\n\t\tint o = 0,t = 0;\n\t\tchar i,b,j;\n\t\tscanf(\" %c %c %c\",&i,&b,&j);\n\t\tqueue<state> states;\n\t\tstate nv;\n\t\tnv.bat = n;nv.pos = i;\n\t\tstates.push(nv);\n\t\twhile(!states.empty()){\n\t\t\tnv = states.front();\n\t\t\tif(nv.bat==0 && nv.pos == b){\n\t\t\t\t++o;++t;\n\t\t\t}else if(nv.bat == 0){\n\t\t\t\t++t;\n\t\t\t}else{\n\t\t\t\tvector<char> getting = getLoc(nv.pos);\n\t\t\t\tfor(int x=0;x<4;++x){\n\t\t\t\t\tchar c = getting[x];\n\t\t\t\t\tif(c == j){\n\t\t\t\t\t\tc = nv.pos;\n\t\t\t\t\t}\n\t\t\t\t\tstate nn;\n\t\t\t\t\tnn.pos = c;\n\t\t\t\t\tnn.bat = nv.bat-1;\n\t\t\t\t\tstates.push(nn);\n\t\t\t\t}\t\n\t\t\t}\n\t\t\tstates.pop();\n\t\t}\n\t\tcout.precision(15);\n\t\tcout<<((o*1.0)/(t*1.0))<<endl;\n\t}\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<string>\n#include<map>\n#include<cstdio>\n      \n#define f first\n#define s second\n      \nusing namespace std;\n      \ntypedef pair<int,int> P;\n      \nint dx[4]={0,0,1,-1};\nint dy[4]={1,-1,0,0};\n      \nint main(void){\n      \nint n,id=0;\nstring idx=\"ABCDEFGHI\";\nchar s,t,d;\nmap<char,P>mp;\n      \nfor(int i=0;i<3;i++){\nfor(int j=0;j<3;j++){\nmp[idx[id++]]=P(j,i);\n}\n}\n      \nwhile(cin >> n,n){\ncin >> s >> t >> d;\n   \nP S=mp[s],T=mp[t],D=mp[d];\n   \ndouble dp[16][3][3];\n      \nfor(int k=0;k<16;k++)\nfor(int i=0;i<3;i++)\nfor(int j=0;j<3;j++)dp[k][i][j]=0;\n      \ndp[0][S.s][S.f]=1;\n      \nfor(int k=0;k<n;k++){\nfor(int y=0;y<3;y++){\nfor(int x=0;x<3;x++){\nfor(int l=0;l<4;l++){\nint nx=x+dx[l],ny=y+dy[l];\nif(nx<0 || ny<0 || 2<nx || 2<ny || \n(nx==D.f&&ny==D.s))nx=x,ny=y;\ndp[k+1][ny][nx]+=dp[k][y][x]/4;\n}\n}\n}\n}\nprintf(\"%.8f\",dp[n][T.s][T.f]);\ncout << endl;\n}\n      \nreturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <ctime>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <numeric>\n#include <list>\n\nusing namespace std;\n\n#ifdef _MSC_VER\n#define __typeof__ decltype\n\ntemplate <class T>\nint __builtin_popcount(T n) { return n ? 1 + __builtin_popcount(n & (n - 1)) : 0; }\n#endif\n\n#define foreach(it, c) for (__typeof__((c).begin()) it=(c).begin(); it != (c).end(); ++it)\n#define all(c) (c).begin(), (c).end()\n#define rall(c) (c).rbegin(), (c).rend()\n#define popcount __builtin_popcount\n\t\n#define rep(i, n) for (int i = 0; i < n; ++i)\n\ntemplate <class T> void max_swap(T& a, const T b) { a = max(a, b); }\ntemplate <class T> void min_swap(T& a, const T b) { a = min(a, b); }\n\nconst double EPS = 1e-10;\ntypedef long long ll;\ntypedef pair<int, int> pint;\n\n\nint main()\n{\n\tint n;\n\tchar s, t, b;\n\twhile (cin >> n, n)\n\t{\n\t\tcin >> s >> t >> b;\n\t\ts -= 'A';\n\t\tt -= 'A';\n\t\tb -= 'A';\n\n\t\tint sx = s % 3, sy = s / 3;\n\t\tint tx = t % 3, ty = t / 3;\n\t\tint bx = b % 3, by = b / 3;\n\n\t\tstatic const int dx[] = { 0, 1, 0, -1 };\n\t\tstatic const int dy[] = { 1, 0, -1, 0 };\n\n\t\tdouble dp[20][3][3];\n\t\tmemset(dp, 0, sizeof(dp));\n\t\tdp[0][sy][sx] = 1;\n\t\trep (i, n)\n\t\t{\n\t\t\trep (y, 3)\n\t\t\t{\n\t\t\t\trep (x, 3)\n\t\t\t\t{\n\t\t\t\t\trep (j, 4)\n\t\t\t\t\t{\n\t\t\t\t\t\tint nx = x + dx[j], ny = y + dy[j];\n\t\t\t\t\t\tif (0 <= nx && nx < 3 && 0 <= ny && ny < 3\n\t\t\t\t\t\t\t&& !(nx == bx && ny == by))\n\t\t\t\t\t\t\tdp[i + 1][ny][nx] += dp[i][y][x] / 4;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tdp[i + 1][y][x] += dp[i][y][x] / 4;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8f\\n\", dp[n][ty][tx]);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<map>\nusing namespace std;\ntypedef pair<int,int> P;\nchar s,t,b;\nP dp[20][5][5];\nchar fld[5][5]={\"ABC\",\"DEF\",\"GHI\"};\nint dx[]={1,0,-1,0},dy[]={0,1,0,-1};\nP rep(int now,int y,int x){\n\tint X,Y,l,r;\n\tif(dp[now][y][x].second>=0)\n\t\treturn dp[now][y][x];\n\tP pre,sum=P(0,0);\n\tif(now==0){\n\t\tif(fld[y][x]==t){\n\t\t\treturn dp[now][y][x]=P(1,1);\n\t\t}\n\t\treturn dp[now][y][x]=P(0,1);\n\t}\n\tfor(int i=0;i<4;i++){\n\t\tX=x+dx[i];\n\t\tY=y+dy[i];\n\t\tif(X>=0&&X<3&&Y>=0&&Y<3&&fld[Y][X]!=b){\n\t\t\tpre=rep(now-1,Y,X);\n\t\t\tsum=P(sum.first+pre.first,sum.second+pre.second);\n\t\t}\n\t\telse{\n\t\t\tpre=rep(now-1,y,x);\n\t\t\tsum=P(sum.first+pre.first,sum.second+pre.second);\n\t\t}\n\t}\n\t\treturn dp[now][y][x]=sum;\n}\nint main(){\n\tint n;\n\tP ans;\n\twhile(cin>>n,n){\n\t\tcin>>s>>t>>b;\n\t\tfor(int i=0;i<=n;i++)\n\t\tfor(int j=0;j<3;j++)\n\t\tfor(int k=0;k<3;k++){\n\t\t\tdp[i][j][k].first=-1;\n\t\t\tdp[i][j][k].second=-1;\n\t\t}\n\t\tfor(int i=0;i<3;i++)\n\t\tfor(int j=0;j<3;j++){\n\t\t\tif(fld[i][j]==s){\n\t\t\t\trep(n,i,j);\n\t\t\t\tans=P(dp[n][i][j].first,dp[n][i][j].second);\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\",(double)ans.first/ans.second);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint dp[16][9];\nconst int m[]={-3,-1,1,3};\nint main(){\n\twhile(true){\n\t\tint n;\tcin>>n;\n\t\tif(n==0)\treturn 0;\n\t\tchar s,t,b;\tcin>>s>>t>>b;\n\t\tint ss=s-'A',bb=b-'A',tt=t-'A';\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdp[0][tt]=1;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int j=0;j<9;j++){\n\t\t\t\tif(dp[i][j]==0)\tcontinue;\n\t\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\t\tif(j+m[k]<0||9<=j+m[k])\tdp[i+1][j]+=dp[i][j];\n\t\t\t\t\telse if(bb==j+m[k])\tdp[i+1][j]+=dp[i][j];\n\t\t\t\t\telse \tdp[i+1][j+m[k]]+=dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.15lf\\n\",(double)dp[n][ss]>>(2*n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\ntypedef vector <int> VI;\ntypedef vector <VI> VVI;\n\nconst int dx[4] = { 0, 0, 1, -1 };\nconst int dy[4] = { 1, -1, 0, 0 };\n\nint get_x( char c )\n{\n\tif ( c == 'A' || c == 'D' || c == 'G' ) return 0;\n\tif ( c == 'B' || c == 'E' || c == 'H' ) return 1;\n\tif ( c == 'C' || c == 'F' || c == 'I' ) return 2;\n\treturn -1;\n}\n\nint get_y( char c )\n{\n\tif ( c == 'A' || c == 'B' || c == 'C' ) return 0;\n\tif ( c == 'D' || c == 'E' || c == 'F' ) return 1;\n\tif ( c == 'G' || c == 'H' || c == 'I' ) return 2;\n\treturn -1;\n}\n\n\nint main( void )\n{\n\tint n; char s, t, b;\n\twhile ( 1 )\n\t{\n\t\tcin >> n;\n\t\tif ( n == 0 ) break;\n\t\tcin >> s >> t >> b;\n\n\t\tint sx, sy, gx, gy, ox, oy;\n\t\tsx = get_x( s ); sy = get_y( s );\n\t\tgx = get_x( t ); gy = get_y( t );\n\t\tox = get_x( b ); oy = get_y( b );\n\n\t\tVVI prev( 3, VI(3,0) ), next;\n\t\tprev[sx][sy] = 1;\n\t\tfor ( int lpc = 0; lpc < n; lpc++ )\n\t\t{\n\t\t\tnext = VVI( 3, VI( 3, 0 ) );\n\t\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ )\n\t\t\t{\n\t\t\t\tif ( i == oy && j == ox ) continue;\n\t\t\t\tbool stop = 0;\n\t\t\t\tfor ( int k = 0; k < 4; k++ )\n\t\t\t\t{\n\t\t\t\t\tint nx = j + dx[k];\n\t\t\t\t\tint ny = i + dy[k];\n\t\t\t\t\tif ( nx < 0 || nx >= 3 || ny < 0 || ny >= 3 )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( nx == ox && ny == oy )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnext[i][j] += prev[ny][nx];\n\t\t\t\t}\n\t\t\t\tif ( stop )\n\t\t\t\t{\n\t\t\t\t\tnext[i][j] += prev[i][j] * stop;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tprev = next;\n\t\t}\n\n\t\tint sum = 0;\n\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ ) sum += next[i][j];\n\n\t\tdouble answer = (double)next[gy][gx] / (double)sum;\n\n\t\tcout.precision( 8 );\n\t\tcout.setf( ios::fixed );\n\t\tcout << answer << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <algorithm>\n\nusing namespace std;\n\nint result[15][9];\nint able[9][4];\nchar t;\n\nint solve(int battery, char room, int dst)\n{\n\tif(able[room-'A'][dst]){\n\t\tif(dst == 0)      room -= 3;\n\t\telse if(dst == 1) ++room;\n\t\telse if(dst == 2) room += 3;\n\t\telse              --room;\n\t}\n\t\n\t--battery;\n\tif(battery == 0){\n\t\treturn room == t;\n\t}else{\n\t\tif(result[battery][room] != -1)\n\t\t\treturn result[battery][room];\n\t\t\n\t\tresult[battery][room] = 0;\n\t\tfor(int i=0 ; i<4 ; ++i)\n\t\t\tresult[battery][room] += solve(battery, room, i);\n\t\t\n\t\treturn result[battery][room];\n\t}\n}\n\nint main()\n{\n\tint n;\n\tchar s;\n\t\n\twhile(scanf(\"%d\", &n), n){\n\t\tchar b;\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\t\n\t\tfor(int i=0 ; i<9 ; ++i){\n\t\t\tfor(int j=0 ; j<4 ; ++j)\n\t\t\t\table[i][j] = 1;\n\t\t\t\n\t\t\tif(i<3)    able[i][0] = 0;\n\t\t\tif(i>5)    able[i][2] = 0;\n\t\t\tif(i%3==0) able[i][3] = 0;\n\t\t\tif(i%3==2) able[i][1] = 0;\n\t\t}\n\t\t\n\t\tb -= 'A';\n\t\tif(b>=3)   able[b-3][2] = 0;\n\t\tif(b<=5)   able[b+3][0] = 0;\n\t\tif(b%3!=0) able[b-1][1] = 0;\n\t\tif(b%3!=2) able[b+1][3] = 0;\n\t\t\n\t\tfor(int i=0 ; i<15 ; ++i){\n\t\t\tfor(int j=0 ; j<9 ; ++j)\n\t\t\t\tresult[i][j] = -1;\n\t\t}\n\t\t\n\t\tint acc = 0;;\n\t\tfor(int i=0 ; i<4 ; ++i)\n\t\t\tacc += solve(n, s, i);\n\t\t\n\t\tprintf(\"%lf\\n\", acc/pow(4.0, n));\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <fstream>\n\nusing namespace std;\n\nint n;\nchar s,t,b;\n\ndouble calc(){\n\n\tchar floar[3][3];\n\tfloar[0][0] = 'A';\n\tfloar[0][1] = 'B';\n\tfloar[0][2] = 'C';\n\tfloar[1][0] = 'D';\n\tfloar[1][1] = 'E';\n\tfloar[1][2] = 'F';\n\tfloar[2][0] = 'G';\n\tfloar[2][1] = 'H';\n\tfloar[2][2] = 'I';\n\n\tpair<int,int> startPlace;\n\tpair<int,int> finPlace;\n\tpair<int,int> wareHouse;\n\n\tfor(int i = 0; i < 3; i++){\n\t\tfor(int j = 0; j < 3; j++){\n\t\t\tif(floar[i][j] == s){\n\t\t\t\tstartPlace.first = i;\n\t\t\t\tstartPlace.second = j;\n\t\t\t}\n\t\t\telse if(floar[i][j] == t){\n\t\t\t\tfinPlace.first = i;\n\t\t\t\tfinPlace.second = j;\n\t\t\t}\n\t\t\telse if(floar[i][j] == b){\n\t\t\t\twareHouse.first = i;\n\t\t\t\twareHouse.second = j;\n\t\t\t}\n\t\t}\n\t}\n\n\tvector<pair<int,int>> placeList;\n\tvector<pair<int,int>> nextPlaceList;\n\n\tplaceList.push_back(startPlace);\n\tint leaveBattery = n;\n\tpair<int,int> newPlace;\n\n\tint trueCount = 0;\n\tint falseCount = 0;\n\twhile(placeList.size()){\n\t\t// àµobe[ª0ÆÈÁ½ç\n\t\tif(leaveBattery == 0){\n\t\t\t// »ÝÊuªobeÌêÌ¨ð¦é\n\t\t\tfor(int i = 0; i < placeList.size(); i++){\n\t\t\t\tif(placeList[i].first == finPlace.first && placeList[i].second == finPlace.second){\n\t\t\t\t\ttrueCount++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}else if(leaveBattery == 1){\n\t\t\tfalseCount = placeList.size() * 4;\n\t\t}\n\t\tfor(int i = 0; i < placeList.size(); i++){\n\t\t\t// ãAºA¶AEÉÍÝoµÄ¢È¢êA©ÂqÉÅÈ¢ê»ÌûüÉÚ®\n\t\t\tif(placeList[i].first - 1 >= 0){\n\t\t\t\tif(wareHouse.first != placeList[i].first - 1 || wareHouse.second != placeList[i].second){\n\t\t\t\t\tnewPlace.first = placeList[i].first - 1;\n\t\t\t\t\tnewPlace.second = placeList[i].second;\n\t\t\t\t\tnextPlaceList.push_back(newPlace);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnextPlaceList.push_back(placeList[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(placeList[i].first + 1 < 3){\n\t\t\t\tif(wareHouse.first != placeList[i].first + 1 || wareHouse.second != placeList[i].second){\n\t\t\t\t\tnewPlace.first = placeList[i].first + 1;\n\t\t\t\t\tnewPlace.second = placeList[i].second;\n\t\t\t\t\tnextPlaceList.push_back(newPlace);\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnextPlaceList.push_back(placeList[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(placeList[i].second - 1 >= 0){\n\t\t\t\tif(wareHouse.first != placeList[i].first || wareHouse.second != placeList[i].second - 1){\n\t\t\t\t\tnewPlace.first = placeList[i].first;\n\t\t\t\t\tnewPlace.second = placeList[i].second - 1;\n\t\t\t\t\tnextPlaceList.push_back(newPlace);\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnextPlaceList.push_back(placeList[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(placeList[i].second + 1 < 3){\n\t\t\t\tif(wareHouse.first != placeList[i].first || wareHouse.second != placeList[i].second + 1){\n\t\t\t\t\tnewPlace.first = placeList[i].first;\n\t\t\t\t\tnewPlace.second = placeList[i].second + 1;\n\t\t\t\t\tnextPlaceList.push_back(newPlace);\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnextPlaceList.push_back(placeList[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tleaveBattery--;\n\t\tplaceList = nextPlaceList;\n\t\tnextPlaceList.clear();\n\t}\n\treturn (double)trueCount/falseCount;\n}\n\nvoid solve(){\n\t//ifstream ifs(\"prob1020.txt\");\n\twhile(1){\n\t\t//ifs >> n;\n\t\tcin >> n;\n\n\t\tif(n == 0)\n\t\t\tbreak;\n\t\tcin >> s;\n\t\tcin >> t;\n\t\tcin >> b;\n\t\t//ifs >> s;\n\t\t//ifs >> t;\n\t\t//ifs >> b;\n\t\tcout << calc() << endl;\n\t}\n}\n\nint main(){\nsolve():\nreturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define for_(i,a,b) for(int i=(a);i<(b);++i)\n\nconst int dx[4] = {-1,0,1,0};\nconst int dy[4] = {0,-1,0,1};\n\nint n;\nchar s, t, b;\ndouble p[2][3][3];\n\nint getX(char c) { return (c - 'A') % 3; }\nint getY(char c) { return (c - 'A') / 3; }\n\nvoid solve() {\n\tfor_(y,0,3) for_(x,0,3) p[0][y][x] = 0.;\n\tp[0][getY(s)][getX(s)] = 1.0;\n\t\n\tfor_(i,0,n) {\n\t\tfor_(y,0,3) for_(x,0,3) {\n\t\t\tp[1][y][x] = 0.;\n\t\t\tif (y == getY(b) && x == getX(b)) continue;\n\t\t\tfor_(d,0,4) {\n\t\t\t\tint nx = x + dx[d], ny = y + dy[d];\n\t\t\t\tif (nx < 0 || nx >= 3 || ny < 0 || ny >= 3) continue;\n\t\t\t\tp[1][y][x] += p[0][ny][nx] * 0.25;\n\t\t\t}\n\t\t}\n\t\tswap(p[0], p[1]);\n\t}\n\t\n\tcout << setprecision(12) << setiosflags(ios::fixed) << p[0][getY(t)][getX(t)] << endl;\n}\n\nint main() {\n\twhile (cin >> n, n) {\n\t\tcin >> s >> t >> b;\n\t\tsolve();\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n\n#define rep(i,n) for(int i=0;i<n;i++)\n#define ck(a) (0<=(a)&&(a)<=9)\n\nint di[]={-3, -1, 1, 3};\n\nint main() {\n  using namespace std;\n  \n  int n, s, t, b; char cs, ct, cb;\n  while(cin>>n,n) {\n    cin >> cs >> ct >> cb;\n    s = cs-'A'; t = ct-'A'; b = cb-'A';\n    // 確率漸化式\n    double p[9]={0}; p[s]=1;\n\n    while(n--) {\n      double q[9]={0};\n      rep(i,9)rep(d,4) {\n\tif(ck(i+di[d])&&!(i%3==0&&di[d]==-1)&&!(i%3==2&&di[d]==1)&&i+di[d]!=b)\n\t  q[i+di[d]]+=p[i]/4;\n\telse q[i]+=p[i]/4;\n      }\n      rep(i,9)p[i]=q[i]; // 最新データに更新\n    }\n    printf(\"%.8f\\n\", p[t]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <map>\n#include <cstdio>\n#include <iomanip>\n\nusing namespace std;\n\nconst double EPS = 1e-8;\n\nint n;\npair<int, int> s, t, b;\ndouble dp[16][3][3];\nint dy[] = {-1, 0, 1, 0};\nint dx[] = {0, 1, 0, -1};\n\nbool equals(double a, double b){\n  return abs(a-b) < EPS;\n}\n\nvoid setp(pair<int, int>& p, char c){\n  int tmp = c - 'A';\n  p = make_pair(tmp/3, tmp-(tmp/3)*3);\n}\n\nmain(){\n  while(cin >> n && n){\n    char in1, in2, in3;\n    cin >> in1 >> in2 >> in3;\n    setp(s, in1);\n    setp(t, in2);\n    setp(b, in3);\n    fill(dp[0][0], dp[16][0], 0.0);\n    dp[0][s.first][s.second] = 1.0;\n    for(int i=0;i<n;i++){\n      for(int j=0;j<3;j++){\n\tfor(int k=0;k<3;k++){\n\t  if(equals(dp[i][j][k], 0.0)) continue;\n\t  /*if(j == t.first && k == t.second){\n\t    dp[i+1][j][k] += dp[i][j][k];\n\t    continue;\n\t    }*/\n\t  for(int l=0;l<4;l++){\n\t    int ty = j + dy[l];\n\t    int tx = k + dx[l];\n\t    if(ty>=0 && ty<3){\n\t      if(tx>=0 && tx<3){\n\t\tif(ty != b.first || tx != b.second){\n\t\t  dp[i+1][ty][tx] += dp[i][j][k] / 4.0;\n\t\t  continue;\n\t\t}\n\t      }\n\t    }\n\t    dp[i+1][j][k] += dp[i][j][k] / 4.0;\n\t  }\n\t}\n      }\n      /*for(int j=0;j<3;j++){\n\tfor(int k=0;k<3;k++){\n\t  cout << setw(6) << dp[i][j][k] << ' ';\n\t}\n\tcout << endl;\n      }\n      cout << endl;*/\n    }\n    /*for(int j=0;j<3;j++){\n      for(int k=0;k<3;k++){\n\tcout << setw(6) << dp[n][j][k] << ' ';\n      }\n      cout << endl;\n      }*/\n    printf(\"%.8f\\n\", dp[n][t.first][t.second]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nlong double dp[16][3][3]={};\nint dx[4]={1,-1,0,0};\nint dy[4]={0,0,1,-1};\nint bx,by;\nint tx,ty;\n\nlong double rec(int rest,int x,int y){\n     //cout<<\"x:\"<<x<<\"y:\"<<y<<endl;\n     if(x<0||x>2||y<0||y>2)return 0;\n     if(dp[rest][x][y]>0)return dp[rest][x][y];\n\n     if(rest==0){\n\t  if(x==tx&&y==ty)return 1;\n\t  else return 0;\n     }\n     long double sum=0;\n     for(int i=0;i<4;i++){\n\t  if(((x+dx[i]==bx)&&(y+dy[i]==by))||x+dx[i]<0||x+dx[i]>2||y+dy[i]>2||y+dy[i]<0){\n\t       sum+=rec(rest-1,x,y);\n\t       }else{\n\t       sum+=rec(rest-1,x+dx[i],y+dy[i]);\n\t  }\n     }\n     sum=sum/4.0;\n     dp[rest][x][y]=sum;\n     return sum;\n}\nvoid topoint(char a,int &x,int &y){\n     int tmp=a-'A';\n     x=tmp/3;\n     y=tmp%3;\n     return;\n}\nint main(){\n     int N;\n     cout.precision(8);\n     cout.setf(ios::fixed);\n     while(cin>>N,N){\n\t  char s,t,b;\n\t  cin>>s>>t>>b;\n\t  int sx,sy;\n\t  topoint(s,sx,sy);\n\t  topoint(t,tx,ty);\n\t  topoint(b,bx,by);\n\t  //cout<<sx<<\":\"<<sy<<\" \"<<tx<<\":\"<<ty<<endl;\n\t  cout<<rec(N,sx,sy)<<endl;\n\t  for(int i=0;i<16;i++){\n\t       for(int j=0;j<3;j++){\n\t\t    for(int k=0;k<3;k++){\n\t\t\t dp[i][j][k]=0;\n\t\t    }\n\t       }\n\t  }\n\t\t   \n     }\n     return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint ans;\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tchar n, s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A']=i%3+1;\n\t\tfy[i+'A']=i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d\", &n) , n ){\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\tchar m[5][5] = {0};\n\t\tfor(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;\n\n\t\tans = 0;\n\t\t//if( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t//\t;\n\t\t//}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t//\t;\n\t\t//}else{\n\t\t\tsolve( n , m );\n\t\t//}\n\t\t//debug( m );\n\t\tprintf(\"%.8f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <fstream>\n\nusing namespace std;\n\nint n;\nchar s,t,b;\n\ntypedef pair<int,int> Pair;\n\ndouble calc(){\n\n\tchar floar[3][3];\n\tfloar[0][0] = 'A';\n\tfloar[0][1] = 'B';\n\tfloar[0][2] = 'C';\n\tfloar[1][0] = 'D';\n\tfloar[1][1] = 'E';\n\tfloar[1][2] = 'F';\n\tfloar[2][0] = 'G';\n\tfloar[2][1] = 'H';\n\tfloar[2][2] = 'I';\n\n\tpair<int,int> startPlace;\n\tpair<int,int> finPlace;\n\tpair<int,int> wareHouse;\n\n\tfor(int i = 0; i < 3; i++){\n\t\tfor(int j = 0; j < 3; j++){\n\t\t\tif(floar[i][j] == s){\n\t\t\t\tstartPlace.first = i;\n\t\t\t\tstartPlace.second = j;\n\t\t\t}\n\t\t\telse if(floar[i][j] == t){\n\t\t\t\tfinPlace.first = i;\n\t\t\t\tfinPlace.second = j;\n\t\t\t}\n\t\t\telse if(floar[i][j] == b){\n\t\t\t\twareHouse.first = i;\n\t\t\t\twareHouse.second = j;\n\t\t\t}\n\t\t}\n\t}\n\n\n\tvector<Pair> placeList;\n\tvector<Pair> nextPlaceList;\n\n\tplaceList.push_back(startPlace);\n\tint leaveBattery = n;\n\tpair<int,int> newPlace;\n\n\tint trueCount = 0;\n\tint falseCount = 0;\n\twhile(placeList.size()){\n\t\t// àµobe[ª0ÆÈÁ½ç\n\t\tif(leaveBattery == 0){\n\t\t\t// »ÝÊuªobeÌêÌ¨ð¦é\n\t\t\tfor(int i = 0; i < placeList.size(); i++){\n\t\t\t\tif(placeList[i].first == finPlace.first && placeList[i].second == finPlace.second){\n\t\t\t\t\ttrueCount++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}else if(leaveBattery == 1){\n\t\t\tfalseCount = placeList.size() * 4;\n\t\t}\n\t\tfor(int i = 0; i < placeList.size(); i++){\n\t\t\t// ãAºA¶AEÉÍÝoµÄ¢È¢êA©ÂqÉÅÈ¢ê»ÌûüÉÚ®\n\t\t\tif(placeList[i].first - 1 >= 0){\n\t\t\t\tif(wareHouse.first != placeList[i].first - 1 || wareHouse.second != placeList[i].second){\n\t\t\t\t\tnewPlace.first = placeList[i].first - 1;\n\t\t\t\t\tnewPlace.second = placeList[i].second;\n\t\t\t\t\tnextPlaceList.push_back(newPlace);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnextPlaceList.push_back(placeList[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(placeList[i].first + 1 < 3){\n\t\t\t\tif(wareHouse.first != placeList[i].first + 1 || wareHouse.second != placeList[i].second){\n\t\t\t\t\tnewPlace.first = placeList[i].first + 1;\n\t\t\t\t\tnewPlace.second = placeList[i].second;\n\t\t\t\t\tnextPlaceList.push_back(newPlace);\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnextPlaceList.push_back(placeList[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(placeList[i].second - 1 >= 0){\n\t\t\t\tif(wareHouse.first != placeList[i].first || wareHouse.second != placeList[i].second - 1){\n\t\t\t\t\tnewPlace.first = placeList[i].first;\n\t\t\t\t\tnewPlace.second = placeList[i].second - 1;\n\t\t\t\t\tnextPlaceList.push_back(newPlace);\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnextPlaceList.push_back(placeList[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(placeList[i].second + 1 < 3){\n\t\t\t\tif(wareHouse.first != placeList[i].first || wareHouse.second != placeList[i].second + 1){\n\t\t\t\t\tnewPlace.first = placeList[i].first;\n\t\t\t\t\tnewPlace.second = placeList[i].second + 1;\n\t\t\t\t\tnextPlaceList.push_back(newPlace);\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnextPlaceList.push_back(placeList[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tleaveBattery--;\n\t\tplaceList = nextPlaceList;\n\t\tnextPlaceList.clear();\n\t}\n\treturn (double)trueCount/falseCount;\n}\n\nvoid solve(){\n\t//ifstream ifs(\"prob1020.txt\");\n\twhile(1){\n\t\t//ifs >> n;\n\t\tcin >> n;\n\n\t\tif(n == 0)\n\t\t\tbreak;\n\t\tcin >> s;\n\t\tcin >> t;\n\t\tcin >> b;\n\t\t//ifs >> s;\n\t\t//ifs >> t;\n\t\t//ifs >> b;\n\t\tcout << calc() << endl;\n\t}\n}\n\n\nint main(){\nsolve();\nreturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define INF 1145141919\n#define MOD 1000000007\n#define ALL(a) begin((a)),end((a))\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10  fixed<<setprecision(10)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> P;\ntypedef long long ll;\nstruct edge\n{\n\tint from, to, cost;\n\tbool operator < (const edge& e) const { return cost < e.cost; }\n\tbool operator >(const edge& e) const { return cost > e.cost; }\n};\ntypedef vector<edge> edges;\n///*************************************************************************************///\n///*************************************************************************************///\n///*************************************************************************************///\n\nbool fld[5][5] = {};\nint main()\n{\n\tint n;\n\twhile (cin >> n, n)\n\t{\n\t\tchar s, t, b;\n\t\tcin >> s >> t >> b;\n\t\tvector<vector<edge>> es(9, vector<edge>(9));\n\t\tMS(fld, true);\n\t\tFOR(i, 1, 4)FOR(j, 1, 4) fld[i][j] = false;\n\t\tif (b == 'A') fld[1][1] = true;\n\t\telse if (b == 'B') fld[1][2] = true;\n\t\telse if (b == 'C') fld[1][3] = true;\n\t\telse if (b == 'D') fld[2][1] = true;\n\t\telse if (b == 'E') fld[2][2] = true;\n\t\telse if (b == 'F') fld[2][3] = true;\n\t\telse if (b == 'G') fld[3][1] = true;\n\t\telse if (b == 'H') fld[3][2] = true;\n\t\telse if (b == 'I') fld[3][3] = true;\n\t\tint dx[] = { -1, 0, 0, 1 }; int dy[] = { 0, -1, 1, 0 };\n\t\tFOR(i, 1, 4)FOR(j, 1, 4)\n\t\t{\n\t\t\tREP(k, 4)\n\t\t\t{\n\t\t\t\tint p = (i - 1) * 3 + j - 1;\n\t\t\t\tint nx = i + dx[k]; int ny = j + dy[k];\n\t\t\t\tint q = (nx - 1) * 3 + ny - 1;\n\t\t\t\tif (nx > 0 && nx<4 && ny>0 && ny < 4 && fld[nx][ny]==false)\n\t\t\t\t{\n\t\t\t\t\tes[i].push_back(edge{ p, q, 1 });\n\t\t\t\t}\n\t\t\t\telse es[i].push_back(edge{ p, p, 1 });\n\t\t\t}\n\t\t}\n\t\tint st = s - 'A';\n\t\tint go = t - 'A';\n\t\tdouble ex[9][16] = {};\n\t\tex[st][0] = 1;\n\t\tFOR(k,1, n+1)\n\t\t{\n\t\t\tREP(i, 9)\n\t\t\t{\n\t\t\t\tREP(j, es[i].size())\n\t\t\t\t{\n\t\t\t\t\tex[es[i][j].to][k] += ex[es[i][j].from][k - 1] * 0.25;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << D10 << ex[go][n] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint dp[3][3][20];\nint mx[]={-1,1,0,0},my[]={0,0,-1,1};\nchar abc[3][4]={\"ABC\",\"DEF\",\"GHI\"};\nint main(){\n\twhile(true){\n\t\tint n;\tcin>>n;\n\t\tif(n==0)\treturn 0;\n\t\tchar s,t,b;\tscanf(\" %c %c %c\",&s,&t,&b);\n\t\tmemset(dp,0,sizeof(dp));\n\t\tint sx,sy,rx,ry;\n\t\tfor(int i=0;i<3;i++){\n\t\t\tfor(int j=0;j<3;j++){\n\t\t\t\tif(abc[i][j]==s){\n\t\t\t\t\tsx=j;\tsy=i;\n\t\t\t\t}\n\t\t\t\telse if(abc[i][j]==t)\tdp[i][j][0]=1;\n\t\t\t\telse if(abc[i][j]==b){\n\t\t\t\t\trx=j;\try=i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\tfor(int x=0;x<3;x++){\n\t\t\t\t\tif(dp[y][x][i]==0)\tcontinue;\n\t\t\t\t\tfor(int j=0;j<4;j++){//dp[y][x][i]を配る\n\t\t\t\t\t\tint cx=x+mx[j],cy=y+my[j];\n\t\t\t\t\t\tif(cx<0||3<cx||cy<0||3<cy){\n\t\t\t\t\t\t\tdp[y][x][i+1]+=dp[y][x][i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(cx==rx&&cy==ry){\n\t\t\t\t\t\t\tdp[y][x][i+1]+=dp[y][x][i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[cy][cx][i+1]+=dp[y][x][i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.15lf\\n\",static_cast<double>(dp[sy][sx][n])/static_cast<double>(1<<2*n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <climits>\n#include <cfloat>\nusing namespace std;\n\ntemplate <class T>\nvector<vector<T> > matrixProduct(const vector<vector<T> >& x, const vector<vector<T> >& y)\n{\n    int a = x.size();\n    int b = x[0].size();\n    int c = y[0].size();\n    vector<vector<T> > z(a, vector<T>(c, 0));\n    for(int i=0; i<a; ++i){\n        for(int j=0; j<c; ++j){\n            for(int k=0; k<b; ++k){\n                z[i][j] += x[i][k] * y[k][j];\n            }\n        }\n    }\n    return z;\n}\n\ntemplate <class T>\nvector<vector<T> > matrixPower(const vector<vector<T> >& x, int k)\n{\n    int n = x.size();\n    vector<vector<T> > y(n, vector<T>(n, 0));\n    for(int i=0; i<n; ++i)\n        y[i][i] = 1;\n\n    vector<vector<T> > z = x;\n    while(k > 0){\n        if(k & 1)\n            y = matrixProduct(y, z);\n        z = matrixProduct(z, z);\n        k >>= 1;\n    }\n    return y;\n}\n\nint main()\n{\n    for(;;){\n        int n;\n        cin >> n;\n        if(n == 0)\n            return 0;\n        char s, t, b;\n        cin >> s >> t >> b;\n\n        vector<vector<double> > mat(9, vector<double>(9, 0.0));\n        for(int i=0; i<9; ++i){\n            if(i > 2 && i-3 != b-'A'){\n                mat[i][i-3] = 0.25;\n            }else{\n                mat[i][i] += 0.25;\n            }\n            if(i < 6 && i+3 != b-'A'){\n                mat[i][i+3] = 0.25;\n            }else{\n                mat[i][i] += 0.25;\n            }\n            if(i % 3 != 0 && i-1 != b-'A'){\n                mat[i][i-1] = 0.25;\n            }else{\n                mat[i][i] += 0.25;\n            }\n            if(i % 3 != 2 && i+1 != b-'A'){\n                mat[i][i+1] = 0.25;\n            }else{\n                mat[i][i] += 0.25;\n            }\n        }\n\n        mat = matrixPower(mat, n);\n        printf(\"%.10f\\n\", mat[s-'A'][t-'A']);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vectoer>\n#include<string>\n#include<map>\n#include<cstdio>\n \n#define f first\n#define s second\n \nusing namespace std;\n \ntypedef pair<int,int> P;\n \nint dx[4]={0,0,1,-1};\nint dy[4]={1,-1,0,0};\n \nint main(void){\n \nint n,id=0;\nstring s=\"ABCDEFGHI\";\nchar s,t,d;\nmap<char,P>mp;\n \nfor(int i=0;i<3;i++){\nfor(int j=0;j<3;j++){\nmp[s[id++]]=P(j,i);\n}\n}\n \nwhile(cin >> n,n){\ncin >> s >> t >> d;\nP S=mp[s],T=mp[t],D=mp[d];\n \ndouble dp[16][3][3];\n \nfor(int k=0;k<16;k++)\nfor(int i=0;i<3;i++)\nfor(int j=0;j<3;j++)dp[k][i][j]=0;\n \ndp[0][S.s][S.f]=1;\n \nfor(int k=0;k<n;k++){\nfor(int i=0;i<3;i++){\nfor(int j=0;j<3;j++){\nfor(int l=0;l<4;l++){\nint nx=j+dx[l],ny=i+dy[l];\nif(nx<0 || ny<0 || 2<nx || 2<ny || \n(nx==D.s&&ny==D.f))nx=j,ny=i;\ndp[k+1][ny][nx]+=dp[k][i][j]/4;\n}\n}\n}\n}\nprintf(\"%.8f\\n\",dp[n][T.s][T.f]);\n}\n \nreturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint ans;\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tchar n, s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A']=i%3+1;\n\t\tfy[i+'A']=i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d\", &n) , n ){\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\tchar m[5][5] = {0};\n\t\tfor(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;\n\n\t\tans = 0;\n\t\tif( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else{\n\t\t\t//solve( n , m );\n\t\t\t;\n\t\t}\n\t\t//debug( m );\n\t\tprintf(\"%.8f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\n\ndouble dp[15][3][3]={};\nint dx[4]={1,-1,0,0};\nint dy[4]={0,0,1,-1};\nint bx,by;\nint tx,ty;\n\ndouble rec(int rest,int x,int y){\n     //cout<<\"x:\"<<x<<\"y:\"<<y<<endl;\n     if(x<0||x>2||y<0||y>2)return 0;\n     if(dp[rest][x][y]>__DBL_EPSILON__)return dp[rest][x][y];\n\n     if(rest==0){\n\t  if(x==tx&&y==ty)return 1;\n\t  else return 0;\n     }\n     double sum=0;\n     for(int i=0;i<4;i++){\n\t  if((x+dx[i]==bx)&&(y+dy[i]==by)){\n\t       double a=rec(rest-1,x,y);\n\t       if(a>__DBL_EPSILON__)dp[rest-1][x][y]=a;\n\t       sum+=a;\n\t       }else{\n\t       double a=rec(rest-1,x+dx[i],y+dy[i]);\n\t       if(a>__DBL_EPSILON__)dp[rest-1][x+dx[i]][y+dy[i]]=a;\n\t       sum+=a;\n\t  }\n     }\n     sum=sum/4.0;\n     return sum;\n}\nvoid topoint(char a,int &x,int &y){\n     int tmp=a-'A';\n     x=tmp/3;\n     y=tmp%3;\n     return;\n}\nint main(){\n     int N;\n     cout.precision(8);\n     cout.setf(ios::fixed);\n     while(cin>>N,N){\n\t  char s,t,b;\n\t  cin>>s>>t>>b;\n\t  int sx,sy;\n\t  topoint(s,sx,sy);\n\t  topoint(t,tx,ty);\n\t  topoint(b,bx,by);\n\t  //cout<<sx<<\":\"<<sy<<\" \"<<tx<<\":\"<<ty<<endl;\n\t  cout<<rec(N,sx,sy)<<endl;\n\t  for(int i=0;i<15;i++){\n\t       for(int j=0;j<3;j++){\n\t\t    for(int k=0;k<3;k++){\n\t\t\t dp[i][j][k]=0;\n\t\t    }\n\t       }\n\t  }\n\t\t   \n     }\n     return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n\n#define WIDTH 3\n#define HEIGHT 3\n#define ERORR -1\n\nusing namespace std;\n\nint main()\n{\n\tint n, ctl, map[2][HEIGHT+2][WIDTH+2], sx, sy, gx, gy, xx, yy, tx, ty;\n\tint dx[] = {0, 0, -1, 1}, dy[] = {-1, 1, 0, 0};\n\tchar s, t, b;\n\twhile(cin >> n, n) {\n\t\tctl = 0;\n\t\tcin >> s >> t >> b;\n\t\tfor(int i=0; i < HEIGHT+2; i++)\n\t\t\tfor(int j=0; j < WIDTH+2; j++) {\n\t\t\t\tfor(int k=0; k < 2; k++) {\n\t\t\t\t\tif(i == 0 || i == HEIGHT+1 || j == 0 || j == WIDTH+1)\n\t\t\t\t\t\tmap[k][i][j] = ERORR;\n\t\t\t\t\telse\n\t\t\t\t\t\tmap[k][i][j] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\tsx = (s-'A') % WIDTH + 1; sy = (s-'A') / WIDTH + 1;\n\t\tgx = (t-'A') % WIDTH + 1; gy = (t-'A') / WIDTH + 1;\n\t\txx = (b-'A') % WIDTH + 1; yy = (b-'A') / WIDTH + 1;\n\t\tmap[0][yy][xx] = map[1][yy][xx] = ERORR;\n\t\tmap[ctl][sy][sx] = 1;\n\t\tint sum = 1 << (2 * n);\n\t\twhile(n--) {\n\t\t\tfor(int i=1; i <= HEIGHT; i++) {\n\t\t\t\tfor(int j=1; j <= WIDTH; j++) {\n\t\t\t\t\tif(map[(ctl+1)%2][i][j] == ERORR) continue;\n\t\t\t\t\tmap[(ctl+1)%2][i][j] = 0;\n\t\t\t\t\tfor(int d=0; d < 4; d++) {\n\t\t\t\t\t\ttx = j + dx[d]; ty = i + dy[d];\n\t\t\t\t\t\tif(map[ctl][ty][tx] == ERORR) { tx = j; ty = i; }\n\t\t\t\t\t\tmap[(ctl+1)%2][i][j] += map[ctl][ty][tx];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tctl = (ctl+1) % 2;\n\t\t}\n\t\tprintf(\"%.8f\\n\", (float)(map[ctl][gy][gx])/sum);\n\t\t\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string.h>\n\nusing namespace std;\n\nint sum,ans;\nint map[3][3];\nvoid move(int x,int y,int n)\n{\n  //  cout<<x<<\" \"<<y<<\" \"<<n<<\" \"<<endl;\n  if(n==0)\n    {\n      sum++;\n      if(map[y][x]==1)\n\tans++;\n      return;\n    }\n\n\n  if(x-1>=0 && map[y][x-1]!=-1)\n      move(x-1,y,n-1);\n  else\n      move(x,y,n-1);\n\n  if(y-1>=0 && map[y-1][x]!=-1)\n      move(x,y-1,n-1);\n  else\n      move(x,y,n-1);\n\n  if(x+1<3 && map[y][x+1]!=-1)\n      move(x+1,y,n-1);\n  else\n      move(x,y,n-1);\n\n  if(y+1<3 && map[y+1][x]!=-1)\n      move(x,y+1,n-1);\n  else\n      move(x,y,n-1); \n}\n\nint main()\n{\n  int n;\n\n  for(;;)\n    {\n      cin>>n;\n      if(n==0)\n\tbreak;\n      char s,t,b;\n      sum=0;\n      ans=0;\n      cin>>s>>t>>b;\n      memset(map,0,sizeof(map));\n      int x,y,tm;\n      tm=t-'A';\n      x=tm%3;\n      y=tm/3;\n      map[y][x]=1;\n      tm=b-'A';\n      x=tm%3;\n      y=tm/3;\n      map[y][x]=-1;\n\n      tm=s-'A';\n      move(tm%3,tm/3,n);\n\n      cout<<(double)ans/sum<<endl;  \n    }\n}"
  },
  {
    "language": "C++",
    "code": "#define rep(i,n) for(int i=0;i<n;i++)\n#define ck(a) (0<=(a)&&(a)<9)\nint di[]={-3,-1,1,3};\nint main(){\n\tint n,s,t,b; char cs,ct,cb;\n\twhile(scanf(\"%d\",&n),n){\n\t\tscanf(\" %c %c %c\",&cs,&ct,&cb); s=cs-'A', t=ct-'A', b=cb-'A';\n\t\tdouble p[9]={0}; p[s]=1;\n\t\t\n\t\twhile(n--){\n\t\t\tdouble q[9]={0};\n\t\t\trep(i,9)rep(d,4){\n\t\t\t\tif(ck(i+di[d])&&i+di[d]!=b)q[i+di[d]]+=p[i]/4;\n\t\t\t\telse q[i]+=p[i]/4;\n\t\t\t}\n\t\t\trep(i,9)p[i]=q[i];\n\t\t}\n\t\t\n\t\tprintf(\"%.8f\\n\",p[t]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\nusing namespace std;\n\nconst int NMAX = 15;\n\nint index(char c){\n\treturn (int)c - 'A';\n}\n\ndouble dp[NMAX+1][3][3];\nint dx[] = {\n\t1, 0, -1, 0\n};\nint dy[] = {\n\t0, 1, 0 , -1\n};\n\nint main(){\n\tint n;\n\tchar s, t, b;\n\twhile(cin >> n){\n\t\tif(n == 0) break;\n\t\tcin >> s >> t >> b;\n\t\tint sx, sy;\n\t\tint tx, ty;\n\t\tint bx, by;\n\t\tsx = index(s) % 3;\n\t\tsy = index(s) / 3;\n\t\ttx = index(t) % 3;\n\t\tty = index(t) / 3;\n\t\tbx = index(b) % 3;\n\t\tby = index(b) / 3;\n\t\tfor(int i = 0; i <= NMAX; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tdp[i][j][k] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdp[0][ty][tx] = 1.0;\n\t\tfor(int i = 1; i <= n; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tif(j != by || k != bx){\n\t\t\t\t\t\tfor(int l = 0; l < 4; l++)\n\t\t\t\t\t\t\tif(j + dy[l] >= 0 && j + dy[l] < 3 && k + dx[l] >= 0\n\t\t\t\t\t\t\t\t&& k + dx[l] < 3 && (j + dy[l] != by || k + dx[l] != bx))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j][k] += dp[i-1][j+dy[l]][k+dx[l]] / 4;\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tdp[i][j][k] += dp[i-1][j][k] / 4;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << fixed << setprecision(7) << dp[n][sy][sx] << endl;;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<n;i++)\nconst int dx[] ={0,1,0,-1};\nconst int dy[] ={-1,0,1,0};\n\nint main(){\n\tint n;\n\twhile(cin >> n , n){\n\t\tlong double dp[15][5][5] = {{{0.0}}};\n\t\tchar map[5][5];\n\t\trep(i,5)rep(j,5)map[i][j] = 'X';\n\t\trep(i,3)rep(j,3)map[i+1][j+1] = ' ';\n\t\tint sx, sy , gx, gy ,bx , by;\n\t\tchar s,t,b;\n\t\tcin >> s >> t >> b ;\n\t\tsy = (s-'A')/3 +1 ,sx = (s-'A')%3 +1;\n\t\tgy = (t-'A')/3 +1 ,gx = (t-'A')%3 +1;\n\t\tby = (b-'A')/3 +1 ,bx = (b-'A')%3 +1;\n\t\tmap[by][bx] = 'X';\n\t\t//rep(i,5){rep(j,5)cout << map[i][j];cout << endl;}\n\t\t\n\t\tdp[n][sy][sx] = 1.0;\n\t\t\n\t\twhile(n){\n\t\t\tfor(int y=1;y<=3;y++){\n\t\t\t\tfor(int x=1;x<=3;x++){\n\t\t\t\t\trep(i,4){\n\t\t\t\t\t\tint tx = x+dx[i], ty = y+dy[i] ;\n\t\t\t\t\t\tif(map[ty][tx] == 'X')continue;\n\t\t\t\t\t\tdp[n-1][ty][tx] += dp[n][y][x] / 4.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tn--;\n\t\t}\n\t\tprintf(\"%.10Lf\\n\",dp[0][gy][gx]);\n\t}\n}\n\t"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cmath>\n#define N 3\n#define N1 16\nusing namespace std;\nvoid func(int,int,int);\nint n,k,data[N][N],memo[N1][N][N];\nint dy[N+1]={-1,0,1,0};\nint dx[N+1]={0,1,0,-1};\nbool visited[N1][N][N];\nchar s,t,b;\n\nint main(){\n  while(1){\n    cin >> n;\n    if(!n) break;\n    cin >> s >> t >> b;\n    for(int i=0;i<N;i++){\n      for(int j=0;j<N;j++){\n\tdata[i][j]=0;\n\tfor(int k=0;k<N1;k++){\n\t  memo[k][i][j]=0;\n\t  visited[k][i][j]=false;\n\t}\n      }\n    }\n    data[(t-'A')/N][(t-'A')%N]=1;\n    data[(b-'A')/N][(b-'A')%N]=-1;\n    visited[1][(s-'A')/N][(s-'A')%N]=true;\n    func((s-'A')/N,(s-'A')%N,0);\n    k=pow(4,n);\n    printf(\"%.8f\\n\",1.0*memo[0][(s-'A')/N][(s-'A')%N]/k);\n  }\n  return 0;\n}\n\nvoid func(int y,int x,int d){\n  if(d==n){\n    if(data[y][x]==1) memo[d][y][x]=1;\n    return ;\n  }\n  for(int i=0;i<N+1;i++){\n    int ny=y+dy[i],nx=x+dx[i];\n    if(ny<0||nx<0||N<ny||N<nx||data[ny][nx]==-1){\n      if(visited[d+1][y][x]==false){\n\tvisited[d+1][y][x]=true;\n\tfunc(y,x,d+1);\t\n      }\n      memo[d][y][x]+=memo[d+1][y][x];\n    }\n    else{\n      if(visited[d+1][ny][nx]==false){\n\tvisited[d+1][y][x]=true;\n\tfunc(ny,nx,d+1);\n      }\n      memo[d][y][x]+=memo[d+1][ny][nx];\n    }\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int dx[] = {-1, 0, 0, 1};\nconst int dy[] = { 0,-1, 1, 0};\n\nint sx, sy, gx, gy, n, bx, by;\ndouble P[3][3][20];\n\nbool check(int x, int y){\n  return (0 <= x && x < 3 && 0 <= y && y < 3);\n}\n\nvoid solve(){\n  P[sy][sx][n] = 1;\n\n  while(n){\n    for(int i = 0 ; i < 3 ; i++){\n      for(int j = 0 ; j < 3 ; j++){\n        for(int k = 0 ; k < 4 ; k++){\n          int nx = i + dx[k];\n          int ny = j + dy[k];\n          if(!check(nx, ny) || (bx == nx && by == ny)){\n            P[j][i][n-1] += P[j][i][n] / 4;\n          }else if(check(nx, ny)){\n            P[ny][nx][n-1] += P[j][i][n] / 4;\n          }\n        }\n      }\n    }\n    n--;\n  }\n\n  printf(\"%.8f\\n\",P[gy][gx][n]);\n}\n\nint main(){\n  char s, t, b;\n  \n  while(cin >> n, n){\n    memset(P, 0, sizeof(P));\n\n    cin >> s >> t >> b;\n    int ss = s - 'A', tt = t - 'A', bb = b - 'A';\n    sx = ss%3; sy = ss/3;\n    gx = tt%3; gy = tt/3;\n    bx = bb%3; by = bb/3;\n    solve();\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\nint initial, battery, junk;\nint dr[] = { -1, 0, 1, 0 }, dc[] = { 0, -1, 0, 1 };\ndouble memo[3][3][16];\ndouble func(int r, int c, int n)\n{\n\tif (n == 0) return (3*r+c == battery);\n\tdouble& res = memo[r][c][n];\n\tif (res > -0.5) return res;\n\n\tres = 0;\n\tfor (int i=0; i<4; ++i) {\n\t\tint nr = r + dr[i], nc = c + dc[i];\n\t\tif (nr<0 || nr>=3 || nc<0 || nc>=3 || 3*nr+nc==junk)\n\t\t\tres += func(r, c, n-1) / 4;\n\t\telse\n\t\t\tres += func(nr, nc, n-1) / 4;\n\t}\n\treturn res;\n}\nint main()\n{\n\tint n;\n\twhile (scanf(\"%d \", &n), n) {\n\t\tfor (int i=0; i<3; ++i) for (int j=0; j<3; ++j) for (int k=0; k<16; ++k)\n\t\t\tmemo[i][j][k] = -1;\n\n\t\tchar s, t, b;\n\t\tscanf(\"%c %c %c \", &s, &t, &b);\n\t\tinitial = s - 'A';\n\t\tbattery = t - 'A';\n\t\tjunk = b - 'A';\n\t\tprintf(\"%.10f\\n\", func(initial/3, initial%3, n));\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i,n) for (int i=0;i<(n);i++)\n#define ALL(a) (a).begin(),(a).end()\n#define RFOR(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define REP(i,n) for (int i=0;i<(n);i++)\n#define RREP(i,n) for (int i=(n)-1;i>=0;i--)\n#define ll long long\n#define ull unsigned long long\nint dx[4] = {1, 0, -1, 0};\nint dy[4] = {0, 1, 0, -1};\n\nusing namespace std;\n\ntypedef pair<int, int> P;\n\nP nukumori(char a) {\n    if (a == 'A') {\n        return P(0, 0);\n    } else if (a == 'B') {\n        return P(1, 0);\n    } else if (a == 'C') {\n        return P(2, 0);\n    } else if (a == 'D') {\n        return P(0, 1);\n    } else if (a == 'E') {\n        return P(1, 1);\n    } else if (a == 'F') {\n        return P(2, 1);\n    } else if (a == 'G') {\n        return P(0, 2);\n    } else if (a == 'H') {\n        return P(1, 2);\n    } else {\n        return P(2, 2);\n    }\n}\n\nint sx, sy, gx, gy, ox, oy;\ndouble memo[3][3][20];\n\ndouble rec(int x, int y, int times) {\n    if (memo[x][y][times] >= 0.0) return memo[x][y][times];\n\n    if (times == 0) {\n        if (x == gx && y == gy) {\n            return 1.0;\n        } else {\n            return 0.0;\n        }\n    }\n\n    double res = 0.0;\n    for (int i = 0; i < 4; i++) {\n        int nx = x + dx[i], ny = y + dy[i];\n        if (nx >= 0 && nx < 3 && ny >= 0 && ny < 3 &&\n                !(nx == ox && ny == oy)) {\n            res += rec(nx, ny, times - 1) / 4.0;\n        } else {\n            res += rec(x, y, times - 1) / 4.0;\n        }\n    }\n    return memo[x][y][times] = res;\n}\n\nint main(){\n    int n;\n    char s, t, b;\n    while (scanf(\"%d\", &n), n) {\n        for (int i = 0; i < 3; i++) {\n            for (int j = 0; j < 3; j++) {\n                for (int k = 0; k < 20; k++) {\n                    memo[i][j][k] = -1.0;\n                }\n            }\n        }\n        cin >> s >> t >> b;\n\n        P temps = nukumori(s),\n          tempt = nukumori(t),\n          tempb = nukumori(b);\n\n        sx = temps.first; sy = temps.second;\n        gx = tempt.first; gy = tempt.second;\n        ox = tempb.first; oy = tempb.second;\n\n        printf(\"%.10f\\n\", rec(sx, sy, n));\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\ntypedef vector <int> VI;\ntypedef vector <VI> VVI;\n\nconst int dx[4] = { 0, 0, 1, -1 };\nconst int dy[4] = { 1, -1, 0, 0 };\n\nint get_x( char c )\n{\n\tif ( c == 'A' || c == 'D' || c == 'G' ) return 0;\n\tif ( c == 'B' || c == 'E' || c == 'H' ) return 1;\n\tif ( c == 'C' || c == 'F' || c == 'I' ) return 2;\n\treturn -1;\n}\n\nint get_y( char c )\n{\n\tif ( c == 'A' || c == 'B' || c == 'C' ) return 0;\n\tif ( c == 'D' || c == 'E' || c == 'F' ) return 1;\n\tif ( c == 'G' || c == 'H' || c == 'I' ) return 2;\n\treturn -1;\n}\n\n\nint main( void )\n{\n\tint n; char s, t, b;\n\twhile ( 1 )\n\t{\n\t\tcin >> n;\n\t\tif ( n == 0 ) break;\n\t\tcin >> s >> t >> b;\n\n\t\tint sx, sy, gx, gy, ox, oy;\n\t\tsx = get_x( s ); sy = get_y( s );\n\t\tgx = get_x( t ); gy = get_y( t );\n\t\tox = get_x( b ); oy = get_y( b );\n\n\t\tVVI prev( 3, VI(3,0) ), next;\n\t\tprev[sy][sx] = 1;\n\t\tfor ( int lpc = 0; lpc < n; lpc++ )\n\t\t{\n\t\t\tnext = VVI( 3, VI( 3, 0 ) );\n\t\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ )\n\t\t\t{\n\t\t\t\tif ( i == oy && j == ox ) continue;\n\t\t\t\tbool stop = 0;\n\t\t\t\tfor ( int k = 0; k < 4; k++ )\n\t\t\t\t{\n\t\t\t\t\tint nx = j + dx[k];\n\t\t\t\t\tint ny = i + dy[k];\n\t\t\t\t\tif ( nx < 0 || nx >= 3 || ny < 0 || ny >= 3 )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( nx == ox && ny == oy )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnext[i][j] += prev[ny][nx];\n\t\t\t\t}\n\t\t\t\tif ( stop ) next[i][j] += prev[i][j]; //* stop;\n\t\t\t}\n\t\t\tprev = next;\n\t\t}\n\n\t\tint sum = 0;\n\t\t// for ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ ) sum += next[i][j];\n\t\tsum = 1; for ( int i = 0; i < n; i++ ) sum *= 4;\n\n\t\tdouble answer = (double)next[gy][gx] / (double)sum;\n\n\t\tcout.precision( 8 );\n\t\tcout.setf( ios::fixed );\n\t\tcout << answer << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cassert>\n#include <climits>\n#include <vector>\n#include <string>\n#include <map>\n#include <algorithm>\n#include <numeric>\nusing namespace std;\n\n#define REP(i, n) for (int i = 0; i < (int)(n); ++i)\n#define FOR(i, a, b) for (int i = (a); i < (int)(b); ++i)\n#define FOREACH(i, c) for (__typeof((c).begin()) i = (c).begin(); i != (c).end(); ++i)\n\nconst int dy[] = {-1, 0, 1, 0};\nconst int dx[] = {0, -1, 0, 1};\ndouble prob[20][3][3];\n\nint main()\n{\n  int n;\n  while (scanf(\"%d\", &n), n) {\n    memset(prob, 0, sizeof(prob));\n    char cs, ct, cb;\n    scanf(\" %c %c %c\", &cs, &ct, &cb);\n    int s = cs - 'A', t = ct - 'A', b = cb - 'A';\n    prob[0][s / 3][s % 3] = 1.0;\n    for (int i = 0; i < n; ++i) {\n      for (int y = 0; y < 3; ++y) {\n        for (int x = 0; x < 3; ++x) {\n          for (int d = 0; d < 4; ++d) {\n            int ny = y + dy[d];\n            int nx = x + dx[d];\n            if (ny < 0 || ny >= 3 || nx < 0 || nx >= 3) { ny = y; nx = x; }\n            if (ny == b / 3 && nx == b % 3) { ny = y; nx = x; }\n            prob[i+1][ny][nx] += 0.25 * prob[i][y][x];\n          }\n        }\n      }\n    }\n    printf(\"%.9lf\\n\", prob[n][t / 3][t % 3]);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#include<iostream>\n#include<string.h>\n#include<math.h>\n#include<algorithm>\n#include<cstring>\n#include<queue>\nusing namespace std;\n#define INF 100000000\nint s,t,b,n;\ndouble p,nn;\nint d[4]={1,3,-1,-3};\nint max(int a,int b){\n\tif(a>b){\n\t\treturn a;\n\t}else{\n\t\treturn b;\n\t}\n}\nvoid dfs(int s,int n){\n\tif(n==0){\n\t\tif(s==t)p+=pow(0.25,nn);\n\t\treturn;\n\t}\n\tfor(int i=0;i<4;i++){\n\t\tif(s+d[i]==b){\n\t\t\tdfs(s,n-1);\n\t\t}else if(s/3!=(s+d[i])/3){//3で割った値に注目するのがポイント\n\t\t\tdfs(s,n-1);\n\t\t}else{\n\t\t\tdfs(s+d[i],n-1);\n\t\t}\n\t\treturn;\n\t}\n\n}\nint main(){\n\twhile(1){\n\t\tchar cs,ct,cb;\n\t\tp=0;\n\t\tcin>>n;\n\t\tnn=n;\n\t\tif(n==0)break;\n\t\tcin>>cs>>ct>>cb;\n\t\ts=(int)cs-'A';\n\t\tt=(int)ct-'A';\n\t\tb=(int)cb-'A';\n\t\tdfs(s,n);\n\t\tcout<<p<<endl;\n\t}\n\treturn 0;\n}\t"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <vector>\n#include <string>\n#include <map>\n#include <sstream>\n#include <queue>\n#include <cstdlib>\n#include <algorithm>\n#include <iterator>\n#include <stack>\n#include <list>\nusing namespace std;\n#define INF 100000000\ntypedef long long int lli;\ntypedef pair<int,int> P;\ndouble dp[16][9];\n\nvoid room(char c,int &x){\n\tswitch(c){\n\t\tcase 'A':\n\t\tx=0;\n\t\tbreak;\n\t\t\n\t\tcase 'B':\n\t\tx=1;\n\t\tbreak;\n\t\t\n\t\tcase 'C':\n\t\tx=2;\n\t\tbreak;\n\t\t\t\n\t\tcase 'D':\n\t\tx=3;\n\t\tbreak;\n\t\t\n\t\tcase 'E':\n\t\tx=4;\n\t\tbreak;\n\t\t\n\t\tcase 'F':\n\t\tx=5;\n\t\tbreak;\n\t\t\n\t\tcase 'G':\n\t\tx=6;\n\t\tbreak;\n\t\t\n\t\tcase 'H':\n\t\tx=7;\n\t\tbreak;\n\t\t\n\t\tcase 'I':\n\t\tx=8;\n\t\tbreak;\n\t\t\n\t\tdefault:\n\t\tbreak;\n\t}\n}\n\nint main(){\n\tint n;\n\twhile(cin>>n&&n){\n\t\tchar s,t,b;\n\t\tcin >> s >> t >> b;\n\t\tint sr,tr,br;\n\t\troom(s,sr);\n\t\troom(t,tr);\n\t\troom(b,br);\n\t\tfor(int i=0; i<=n; ++i){\n\t\t\tfor(int j=0; j<9; ++j){\n\t\t\t\tdp[i][j]=0;\n\t\t\t}\n\t\t}\n\t\tdp[0][sr]=1;\n\t\tfor(int i=1; i<=n; ++i){\n\t\t\tfor(int j=0; j<9; ++j){\n\t\t\t\t/*\n\t\t\t\tif(j!=br){\n\t\t\t\t\tswitch(j){\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][1]/2+dp[i-1][3]/2+dp[i-1][0])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][0]+dp[i-1][4]+dp[i-1][2]+dp[i-1][1])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][1]/2+dp[i-1][5]/2+dp[i-1][2])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][0]+dp[i-1][4]+dp[i-1][6]+dp[i-1][3])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][1]+dp[i-1][5]+dp[i-1][7]+dp[i-1][3])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\t\tcase 5:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][2]+dp[i-1][4]+dp[i-1][8]+dp[i-1][5])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 6:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][3]/2+dp[i-1][7]/2+dp[i-1][6])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 7:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][6]+dp[i-1][4]/2+dp[i-1][8]/2+dp[i-1][7]/2)/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 8:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][5]/2+dp[i-1][7]/2+dp[i-1][8])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\tif(j%3!=0&&j-1!=br){\n\t\t\t\t\tdp[i][j]+=dp[i-1][j-1]/4;\n\t\t\t\t} else {\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j]/4;\n\t\t\t\t}\n\t\t\t\tif(j>=3&&j-3!=br){\n\t\t\t\t\tdp[i][j]+=dp[i-1][j-3]/4;\n\t\t\t\t} else{\n\t\t\t\t\tdp[i][j]+=dp[i-1][j]/4;\n\t\t\t\t}\n\t\t\t\tif(j%3!=2&&j+1!=br){\n\t\t\t\t\tdp[i][j]+=dp[i-1][j+1]/4;\n\t\t\t\t} else {\n\t\t\t\t\tdp[i][j]+=dp[i-1][j]/4;\n\t\t\t\t}\n\t\t\t\tif(j<=5&&j+3!=br){\n\t\t\t\t\tdp[i][j]+=dp[i-1][j+3]/4;\n\t\t\t\t} else {\n\t\t\t\t\tdp[i][j]+=dp[i-1][j]/4;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8f\\n\",dp[n][tr]);\n\t\t//cout << dp[n][tr] << \"\\n\";\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<iomanip>\nusing namespace std;\ndouble dp[3][3][16];\nchar map[3][3]={'A','B','C','D','E','F','G','H','I'};\nint main(){\n\tint n;\n\tchar s,t,d;\n\tint dx[4]={0,1,0,-1},dy[4]={1,0,-1,0};\n\twhile(true){\n\tcin>>n;\n\tif(n==0)break;\n\tcin>>s>>t>>d;\n\tfor(int i=0;i<3;i++){\n\t\tfor(int j=0;j<3;j++){\n\t\t\tfor(int k=0;k<=n;k++)dp[i][j][k]=0.0;\n\t\t\tif(map[i][j]==s)dp[i][j][0]=1.0;\n\t\t}\n\t}\n\tfor(int k=1;k<=n;k++){\n\t\tfor(int i=0;i<3;i++){\n\t\t\tfor(int j=0;j<3;j++){\n\t\t\t\tfor(int l=0;l<4;l++){\n\t\t\t\t\tif(j+dx[l]<0||j+dx[l]==3||i+dy[l]<0||i+dy[l]==3)\n\t\t\t\t\t\tdp[i][j][k]+=dp[i][j][k-1];\n\t\t\t\t\telse{\n\t\t\t\t\t\tif(map[i+dy[l]][j+dx[l]]==d)dp[i][j][k]+=dp[i][j][k-1];\n\t\t\t\t\t\telse dp[i][j][k]+=dp[i+dy[l]][j+dx[l]][k-1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdp[i][j][k]/=4.0;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int k=0;k<=n;k++){\n\t\tfor(int i=0;i<3;i++){\n\t\t\tfor(int j=0;j<3;j++)cout<<dp[i][j][k]<<\" \";\n\t\t\tcout<<endl;\n\t\t}\n\t\tcout<<endl;\n\t}\n\tfor(int i=0;i<3;i++)for(int j=0;j<3;j++)if(map[i][j]==t)cout<<fixed<<setprecision(10)<<dp[i][j][n]<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <cstdio>\n#include <cctype>\n#include <cstring>\n#include <cstdio>\n#include <cstdlib>\n#include <functional>\n#include <algorithm>\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\n\nchar cs, ct, cb;\nint n, s, t, b;\nld dp[16][5][5];\nint dx[] = {0, -1, 0, 1}, dy[] = {1, 0, -1, 0};\n\n\nint main()\n{\n    while(cin >> n && n) {\n        scanf(\"%c\", &cs);\n        cin >> cs >> ct >> cb;\n        s = cs - 'A'; t = ct - 'A'; b = cb - 'A';\n        int sx, sy, tx, ty, bx, by;\n        sx = s % 3 + 1; sy = s / 3 + 1;\n        tx = t % 3 + 1; ty = t / 3 + 1;\n        bx = b % 3 + 1; by = b / 3 + 1;\n\n\n        for (int i = 0; i < 16; i++) for (int j = 0; j < 5; j++) for (int k = 0; k < 5; k++) dp[i][j][k] = 0.0;\n        \n        dp[n][sy][sx] = 1.0;\n        for (; n > 0; n--) {\n            for (int y = 1; y <= 3; y++) {\n                for (int x = 1; x <= 3; x++) {\n                    for (int k = 0; k < 4; k++) {\n                        int nx = x + dx[k], ny = y + dy[k];\n                        if (nx == bx && ny == by) {\n                            nx = x; ny = y;\n                        }\n                        dp[n - 1][ny][nx] += dp[n][y][x] * 0.25;\n                    }\n                }\n            }\n        }\n\n        printf(\"%.8Lf\\n\", dp[0][ty][tx]);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stdio.h>\nusing namespace std;\n\nint dy[]={-1,0,1,0};\nint dx[]={0,1,0,-1};\n\ndouble dp[3][3][16];\nint n;\nchar s,t,b;\nint S,T,B;\n\ndouble solve(int y,int x,int n){\n  if(dp[y][x][n]!=-1.0)return dp[y][x][n];\n  if(n==0)return dp[y][x][n]=(y*3+x==T?1.0:0.0);\n\n  double sum=0.0;\n  for(int i=0;i<4;i++){\n    int ny=y+dy[i];\n    int nx=x+dx[i];\n    if(ny<0||nx<0)sum+=solve(y,x,n-1);\n    else if(ny>=3||nx>=3)sum+=solve(y,x,n-1);\n    else if(ny*3+nx==B)sum+=solve(y,x,n-1);\n    else sum+=solve(ny,nx,n-1);\n  }\n  return dp[y][x][n]=sum/4.0;\n}\n\nvoid init(){\n  for(int i=0;i<3;i++)\n    for(int j=0;j<3;j++)\n      for(int k=0;k<16;k++)\n\tdp[i][j][k]=-1.0;\n}\n\nint main(){\n  while(1){\n    cin>>n;\n    if(n==0)break;\n    cin>>s>>t>>b;\n    init();\n    S=s-'A';\n    T=t-'A';\n    B=b-'A';\n    printf(\"%.8f\\n\",solve(S/3,S%3,n));\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n)for(int i=0;i<n;i++)\nusing namespace std;\ntypedef pair<char, int>P;\n\nchar dir[4][4]{ \"ABC\",\"DEF\",\"GHI\" };\nint dx[]{ 1,-1,0,0 }, dy[]{ 0,0,1,-1 };\nint main() {\n\tint n;\n\twhile (cin >> n, n) {\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tint sum = 0, cnt = 0;\n\t\tqueue<P>que;\n\t\tque.push(P(s, n));\n\t\twhile (!que.empty()) {\n\t\t\tP p = que.front(); que.pop();\n\t\t\tif (!p.second) {\n\t\t\t\tsum++;\n\t\t\t\tif (p.first == t)cnt++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tint x = (p.first - 'A') / 3, y = (p.first - 'A') % 3;\n\t\t\trep(i, 4) {\n\t\t\t\tint nx = x + dx[i], ny = y + dy[i];\n\t\t\t\tif (nx < 0 || nx >= 3 || ny < 0 || ny >= 3 || dir[nx][ny] == b) {\n\t\t\t\t\tnx = x; ny = y;\n\t\t\t\t}\n\t\t\t\tque.push(P(dir[nx][ny], p.second - 1));\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.7lf\\n\", (double)cnt / (double)sum);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\ntypedef vector <int> VI;\ntypedef vector <VI> VVI;\n\nconst int dx[4] = { 0, 0, 1, -1 };\nconst int dy[4] = { 1, -1, 0, 0 };\n\nint get_x( char c )\n{\n\tif ( c == 'A' || c == 'D' || c == 'G' ) return 0;\n\tif ( c == 'B' || c == 'E' || c == 'H' ) return 1;\n\tif ( c == 'C' || c == 'F' || c == 'I' ) return 2;\n\treturn -1;\n}\n\nint get_y( char c )\n{\n\tif ( c == 'A' || c == 'B' || c == 'C' ) return 0;\n\tif ( c == 'D' || c == 'E' || c == 'F' ) return 1;\n\tif ( c == 'G' || c == 'H' || c == 'I' ) return 2;\n\treturn -1;\n}\n\n\nint main( void )\n{\n\tint n; char s, t, b;\n\twhile ( 1 )\n\t{\n\t\tcin >> n;\n\t\tif ( n == 0 ) break;\n\t\tcin >> s >> t >> b;\n\n\t\tint sx, sy, gx, gy, ox, oy;\n\t\tsx = get_x( s ); sy = get_y( s );\n\t\tgx = get_x( t ); gy = get_y( t );\n\t\tox = get_x( b ); oy = get_y( b );\n\n\t\tVVI prev( 3, VI(3,0) ), next;\n\t\tprev[sy][sx] = 1;\n\t\tfor ( int lpc = 0; lpc < n; lpc++ )\n\t\t{\n\t\t\tnext = VVI( 3, VI( 3, 0 ) );\n\t\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ )\n\t\t\t{\n\t\t\t\tif ( i == oy && j == ox ) continue;\n\t\t\t\tbool stop = 0;\n\t\t\t\tfor ( int k = 0; k < 4; k++ )\n\t\t\t\t{\n\t\t\t\t\tint nx = j + dx[k];\n\t\t\t\t\tint ny = i + dy[k];\n\t\t\t\t\tif ( nx < 0 || nx >= 3 || ny < 0 || ny >= 3 )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( nx == ox && ny == oy )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnext[i][j] += prev[ny][nx];\n\t\t\t\t}\n\t\t\t\tif ( stop ) next[i][j] += prev[i][j] * stop;\n\t\t\t}\n\t\t\tprev = next;\n\t\t}\n\n\t\tint sum = 0;\n\t\t// for ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ ) sum += next[i][j];\n\t\tsum = 1; for ( int i = 0; i < n; i++ ) sum *= 4;\n\n\t\tdouble answer = (double)next[gy][gx] / (double)sum;\n\n\t\tcout.precision( 8 );\n\t\tcout.setf( ios::fixed );\n\t\tcout << answer << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <queue>\n\nusing namespace std;\n\ntypedef long double ld;\n\nconst int EMPTY   = 0;\nconst int BATTERY = 1;\nconst int STORE   = 2;\nconst int WALL    = 3;\n\nstruct Point {\npublic:\n  int x, y;\n  Point() { }\n  Point(int x, int y): x(x), y(y) { }\n};\n\nstruct State {\npublic:\n  Point p;\n  int battery;\n  State() { };\n  State(Point p, int battery): p(p), battery(battery) { }\n};\n\nPoint int2point(int n) {\n  return Point(1 + n % 3, 1 + n / 3);\n}\n\nint field[5][5];\n\nstruct Bunsu {\npublic:\n  ld bunbo;\n  ld bunsi;\n  Bunsu() { }\n  Bunsu(int a, int b): bunbo(a), bunsi(b) { }  \n  Bunsu operator+=(const Bunsu& b) {\n    this->bunbo += b.bunbo;\n    this->bunsi += b.bunsi;\n    return *this;\n  }\n};\n\nBunsu memo[5][5][16];\nbool memo_b[5][5][16];\n\nBunsu calc(State s) {\n  Bunsu ret = Bunsu(0, 0);\n  if (memo_b[s.p.x][s.p.y][s.battery]) {\n    return memo[s.p.x][s.p.y][s.battery];\n  }\n  if (s.battery == 0) {\n    if (field[s.p.x][s.p.y] == BATTERY) {\n      ret.bunsi++;\n    }\n    ret.bunbo++;\n    return ret;\n  }\n  int dx[4] = { 0, -1, 1, 0 };\n  int dy[4] = { -1, 0, 0, 1 };\n  for (int i = 0; i < 4; i++) {\n    Point np = Point(s.p.x + dx[i], s.p.y + dy[i]);\n    if (field[np.x][np.y] == STORE) {\n      ret += calc(State(s.p, s.battery - 1));\n      continue;\n    }\n    if (field[np.x][np.y] == WALL) {\n      ret += calc(State(s.p, s.battery - 1));\n      continue;\n    }\n    ret += calc(State(np, s.battery - 1));\n  }\n  memo_b[s.p.x][s.p.y][s.battery] = true;\n  return memo[s.p.x][s.p.y][s.battery] = ret;\n}\n\nint main() {\n  int n, s, t, b;\n  while (true) {\n    cin >> n;\n    if (n == 0) break;\n    char cs, ct, cb;\n    cin >> cs >> ct >> cb;\n    s = cs - 'A';\n    t = ct - 'A';\n    b = cb - 'A';\n    \n    memset(field, EMPTY, sizeof(field));\n    for (int i = 0; i < 5; i++) {\n      for (int j = 0; j < 5; j++) {\n        for (int k = 0; k < 16; k++) {\n          memo[i][j][k] = Bunsu(0, 0);\n          memo_b[i][j][k] = false;\n        }\n      }\n    }\n    for (int i = 0; i < 5; i++) {\n      field[0][i] = WALL;\n      field[4][i] = WALL;\n      field[i][0] = WALL;\n      field[4][i] = WALL;\n    }\n    Point batteryPoint = int2point(t);\n    field[batteryPoint.x][batteryPoint.y] = BATTERY;\n    Point storePoint = int2point(b);\n    field[storePoint.x][storePoint.y] = STORE;\n    State nowState(int2point(s), n);\n    \n    Bunsu ans = calc(nowState);\n    printf(\"%.32llf\\n\", ans.bunsi / ans.bunbo);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n\n#define rep(i,n) for(int i=0;i<n;i++)\n#define ck(a) (0<=(a)&&(a)<9)\n\nint di[]={-3, -1, 1, 3};\n\nint main() {\n  using namespace std;\n  \n  int n, s, t, b; char cs, ct, cb;\n  while((cin>>n),n) {\n    cin >> cs >> ct >> cb;\n    s = cs-'A'; t = ct-'A'; b = cb-'A';\n    // 確率漸化式（添字は場所に対応。漸化式はqを用いることによって更新される）\n    double p[9]={0}; p[s]=1;\n\n    while(n--) {\n      double q[9]={0};\n      rep(i,9)rep(d,4) {\n\tif(ck(i+di[d])&&!(i%3==0&&di[d]==-1)&&!(i%3==2&&di[d]==1)&&i+di[d]!=b)\n\t  q[i+di[d]]+=p[i]/4;\n\telse q[i]+=p[i]/4;\n      }\n      rep(i,9)p[i]=q[i]; // 最新データに更新\n    }\n    printf(\"%.8f\\n\", p[t]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string.h>\n\n\nusing namespace std;\n\nint sum,ans;\nint map[3][3];\nint dp[3][3][15];\nint move(int x,int y,int n)\n{\n  int a = 0;\n  //  cout<<x<<\" \"<<y<<\" \"<<n<<\" \"<<endl;\n  if(dp[x][y][n]!=-1)\n    return dp[x][y][n];\n  if(n==0)\n    {\n      if(map[y][x]==1)\n\treturn 1;\n      else return 0;\n    }\n\n\n  if(x-1>=0 && map[y][x-1]!=-1)\n     a+= move(x-1,y,n-1);\n  else\n    a+=  move(x,y,n-1);\n\n  if(y-1>=0 && map[y-1][x]!=-1)\n     a+= move(x,y-1,n-1);\n  else\n    a+=  move(x,y,n-1);\n\n  if(x+1<3 && map[y][x+1]!=-1)\n    a+=  move(x+1,y,n-1);\n  else\n    a+=  move(x,y,n-1);\n\n  if(y+1<3 && map[y+1][x]!=-1)\n    a+=  move(x,y+1,n-1);\n  else\n    a+=  move(x,y,n-1); \n\n  dp[x][y][n]=a;\n\n  return a;\n}\n\nint main()\n{\n  int n;\n\n  for(;;)\n    {\n      cin>>n;\n      if(n==0)\n\tbreak;\n      char s,t,b;\n      sum=0;\n      ans=0;\n      cin>>s>>t>>b;\n      memset(map,0,sizeof(map));\n      memset(dp,-1,sizeof(dp));\n      int x,y,tm;\n      tm=t-'A';\n      x=tm%3;\n      y=tm/3;\n      map[y][x]=1;\n      tm=b-'A';\n      x=tm%3;\n      y=tm/3;\n      map[y][x]=-1;\n\n      tm=s-'A';\n      ans = move(tm%3,tm/3,n);\n      sum=4;\n      for(int g=1;g<n;g++)\n\tsum *=4;\n      cout<<(double)ans/sum<<endl;  \n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nint xdir[4] = {0, 1, 0, -1}, ydir[4] = {1, 0, -1, 0};\nint main()\n{\n\tint n, p, q;\n\tlong double a[3][3][16];\n\tchar s, t, b, alp[3][3];\n\t\n\tfor(int i = 0; i < 3; i++){\n\t\tfor(int j = 0; j < 3; j++){\n\t\t\talp[i][j] = (char)('A'+(i*3+j));\n\t\t}\n\t}\n\t\n\twhile(cin>>n && n){\n\t\tcin >> s >> t >> b;\n\t\tfill(&a[0][0][0], &a[2][2][n], 0);\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tif(alp[i][j] == s){\n\t\t\t\t\tp = i;\n\t\t\t\t\tq = j;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\ta[p][q][0] = 1.0;\n\t\t\n\t\tfor(int k = 0; k < n; k++){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\t\tfor(int l = 0; l < 4; l++){\n\t\t\t\t\t\tint dx = j+xdir[l], dy = i+ydir[l];\n\t\t\t\t\t\tif(0 <= dx && dx < 3 && 0 <= dy && dy < 3){\n\t\t\t\t\t\t\tif(alp[dy][dx] == b){\n\t\t\t\t\t\t\t\tdy = i;\n\t\t\t\t\t\t\t\tdx = j;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ta[dy][dx][k+1] += a[i][j][k]/4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tif(alp[i][j] == t){\n\t\t\t\t\tp = i;\n\t\t\t\t\tq = j;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tprintf(\"%.8Lf\\n\", a[p][q][n]);\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n\nusing namespace std;\n\nint b_row,b_col,memo[16][3][3];\n\nchar b[2];\n\nbool rangeCheck(int row,int col){\n\tif(row >= 0 && row <= 2 && col >= 0 && col <= 2)return true;\n\telse{\n\t\treturn false;\n\t}\n}\n\nint translate(char ch){\n\tswitch(ch){\n\tcase 'A':return 0;\n\tcase 'B':return 1;\n\tcase 'C':return 2;\n\tcase 'D':return 10;\n\tcase 'E':return 11;\n\tcase 'F':return 12;\n\tcase 'G':return 20;\n\tcase 'H':return 21;\n\tcase 'I':return 22;\n\t}\n\n\treturn -1; //must not reach here.\n}\n\nint main(){\n\n\tint n,tmp,energy_row,energy_col,row,col,div_row[4] = {-1,0,0,1},div_col[4] = {0,-1,1,0};\n\tchar start[2],energy[2];\n\n\twhile(true){\n\t\tscanf(\"%d\",&n);\n\t\tif(n == 0)break;\n\n\t\tfor(int i = 0; i < 16; i++){\n\t\t\tfor(int p = 0; p < 3; p++){\n\t\t\t\tfor(int k = 0; k < 3; k++)memo[i][p][k] = 0;\n\t\t\t}\n\n\t\t}\n\n\t\tscanf(\"%s %s %s\",start,energy,b);\n\n\t\ttmp = translate(b[0]);\n\t\tb_row = tmp/10;\n\t\tb_col = tmp%10;\n\n\t\ttmp = translate(energy[0]);\n\t\tenergy_row = tmp/10;\n\t\tenergy_col = tmp%10;\n\n\t\ttmp = translate(start[0]);\n\n\t\trow = tmp/10,col = tmp%10;\n\n\t\tif(rangeCheck(row,col-1) == true && (row != b_row || col-1 != b_col)){\n\t\t\tmemo[1][row][col-1] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row,col+1) == true && (row != b_row || col+1 != b_col)){\n\t\t\tmemo[1][row][col+1] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row-1,col) == true && (row-1 != b_row || col != b_col)){\n\t\t\tmemo[1][row-1][col] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row+1,col) == true && (row+1 != b_row || col != b_col)){\n\t\t\tmemo[1][row+1][col] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tfor(int loop = 1; loop <= n-1; loop++){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tif(i != b_row || k != b_col){ //????????§????????´???\n\t\t\t\t\t\tfor(int p = 0; p < 4; p++){\n\t\t\t\t\t\t\tif(rangeCheck(i+div_row[p],k+div_col[p]) == true && (i+div_row[p] != b_row || k + div_col[p] != b_col)){ //?§????????????§??????????????????????????§??????\n\t\t\t\t\t\t\t\tmemo[loop+1][i+div_row[p]][k+div_col[p]] += memo[loop][i][k];\n\t\t\t\t\t\t\t}else{ //?°?????????¨???1????????????????????????????????´?????????????????´??????????????¨????????´????????°???????????????\n\t\t\t\t\t\t\t\tmemo[loop+1][i][k] = memo[loop][i][k];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\",((double)memo[n][energy_row][energy_col])/((double)pow(4,n)));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nlong double dp[16][9];\nconst int m[]={-3,-1,1,3};\nint main(){\n\twhile(true){\n\t\tint n;\tcin>>n;\n\t\tif(n==0)\treturn 0;\n\t\tchar s,t,b;\tcin>>s>>t>>b;\n\t\tint ss=s-'A',bb=b-'A',tt=t-'A';\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdp[0][tt]=1.0;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int j=0;j<9;j++){\n\t\t\t\tif(dp[i][j]==0)\tcontinue;\n\t\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\t\tint n=j+m[k];\n\t\t\t\t\tif(0<=n&&n<9&&bb!=n)\tdp[i+1][n]+=dp[i][j]/4.0;\n\t\t\t\t\telse \tdp[i+1][j]+=dp[i][j]/4.0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\",dp[n][ss]);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#define BAT 1\n#define SOU 2\nusing namespace std;\n\nint r[9];\nint deno; // ツ閉ェツ陛ェ\nint num;  // ツ閉ェツ子\n\nvoid rc( int n, int i ){\n  if( n==0 ){\n    deno++;\n    if( r[i]==BAT )\n      num++;\n  }else{\n    --n;\n    // up\n    if( i<3 || r[i-3]==SOU ) rc( n,i );\n    else rc( n,i-3 );\n    // right\n    if( i%3==2 || r[i+1]==SOU ) rc( n,i );\n    else rc( n,i+1 );\n    // down\n    if( i>5 || r[i+3]==SOU ) rc( n,i );\n    else rc( n,i+3 );\n    // left\n    if( i%3==0 || r[i-1]==SOU ) rc( n,i );\n    else rc( n,i-1 );\n  }\n}\n\nint main(){\n  int n;\n  char s,t,b;\n\n  while( cin>>n && n ){\n    cin >> s>>t>>b;\n    for( int i=0;i<9;i++ ) r[i] =0;\n    r[ t-'A' ] = BAT;\n    r[ b-'A' ] = SOU;\n    deno=0;\n    num=0;\n    rc( n,s-'A' );\n    double ans = (double) num/deno;\n    printf(\"%lf\\n\",ans );\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <iostream>\n#include <queue>\nusing namespace std;\n\nint n;\nint field[3][3];\nint goal_i,di[4] = {1,-1,0,0};\nint goal_j,dj[4] = {0,0,1,-1};\ndouble ans;\n\ntypedef struct{\n\tint i,j,n;\n}Info;\n\nint getI(char x){\n\treturn (x - 'A') / 3;\n}\n\nint getJ(char x){\n\treturn (x - 'A') % 3;\n}\n\nvoid solve(queue<Info> q,int now,int before[3][3]){\n\tint sum[3][3];\n\n\tmemset(sum,0,sizeof(sum));\n\n\twhile(1){\n\t\tInfo tmp = q.front();\n\t\tif(tmp.n >= now) break;\n\t\tq.pop();\n\n\t\tfor(int k=0;k<4;k++){\n\t\t\tInfo next;\n\t\t\tint ni = tmp.i + di[k];\n\t\t\tint nj = tmp.j + dj[k];\n\n\t\t\tif(ni<0 || ni>=3 || nj<0 || nj>=3 || field[ni][nj]==2){\n\t\t\t\tnext.i = tmp.i;\n\t\t\t\tnext.j = tmp.j;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tnext.i = ni;\n\t\t\t\tnext.j = nj;\n\t\t\t}\n\t\t\tnext.n = tmp.n + 1;\n\n\t\t\tif(sum[next.i][next.j] == 0){\n\t\t\t\tq.push(next);\n\t\t\t}\n\t\t\tsum[next.i][next.j] += before[tmp.i][tmp.j];\n\t\t}\n\t}\n\n\tif(now < n){\n\t\tsolve(q,now+1,sum);\n\t}\n\telse{\n\t\tans = sum[goal_i][goal_j] * pow(0.25,n);\n\t}\n}\n\nint main(void){\n\tchar s,t,b;\n\tint sum[3][3];\n\n\twhile(1){\n\t\tcin>>n;\n\t\tif(!n) break;\n\n\t\tcin>>s>>t>>b;\n\n\t\tmemset(field,0,sizeof(field));\n\t\tmemset(sum,0,sizeof(sum));\n\n\t\tgoal_i = getI(t);\n\t\tgoal_j = getJ(t);\n\t\tfield[goal_i][goal_j] = 1;\n\t\tfield[getI(b)][getJ(b)] = 2;\n\t\tsum[getI(s)][getJ(s)] = 1;\n\t\tans = 0;\n\t\tInfo tmp = {getI(s),getJ(s),0};\n\t\tqueue<Info> q;\n\t\tq.push(tmp);\n\n\t\tsolve(q,1,sum);\n\t\tprintf(\"%.8lf\\n\",ans);\n\t}\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <set>\n#include <map>\n#include <list>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <ctype.h>\n#include <ctime>\n#include <cstdio>\n#include <vector>\n#include <string>\n#include <bitset>\n#include <cctype>\n#include <cstdlib>\n#include <cstring>\n#include <utility>\n#include <numeric>\n#include <complex>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <cassert>\n#include <iostream>\n#include <iterator>\n#include <algorithm>\n\nusing namespace std;\n//参考http://topcoder.g.hatena.ne.jp/isa_rentacs/20111114/1321278656 \n#define REP(i, x, n) for(int i = x; i < n; i++)\n#define rep(i, n) REP(i, 0, n)\n#define lengthof(x) (sizeof(x) / sizeof(*(x)))\n#define FILL(ptr, value) FILL_((ptr), sizeof(ptr)/sizeof(value), (value))\ntemplate <typename T>\nvoid FILL_(void * ptr, size_t size, T value){\n  std::fill((T*)ptr, (T*)ptr+size, value);\n}\n//4方向ベクトル→↑←↓\nint dx[] ={1,0,-1,0};\nint dy[] ={0,-1,0,1};\n\ndouble dp[16][9];\nint dir[4] = {1,3,-1,-3};\nint main()\n{\n  int n;\n  while(cin >>n,n){\n    FILL(dp,0);\n    char temp;\n    int s,t,b,x,y;\n    cin >>temp;\n    s =(int)(temp -'A');\n    cin >>temp;\n    t =(int)(temp -'A');\n    cin >>temp;\n    b = (int)(temp -'A');\n    dp[0][s] = 1;\n    for(int i = 0;i < n;i++){\n      for(int j = 0;j < 9;j++){\n\tif(dp[i][j] ==0){\n\t  continue;\n\t}\n\tx = j%3;\n\ty = j/3;\n\tfor(int k = 0;k < 4;k++){\n\t  if(0 <=x+dx[k]&&x +dx[k] <=2\n\t     &&0 <=y +dy[k]&&y +dy[k] <=2\n\t     &&j+dir[k] !=b){\n\t    dp[i+1][j+dir[k]] +=dp[i][j]*0.25;\n\t  }\n\t  else{\n\t    dp[i+1][j] +=dp[i][j]*0.25;\n\t  }\n\t}\n      }\n    }\n    printf(\"%.8f\\n\",dp[n][t]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#define rep(i,n) for(int i=0;i<n;i++)\n#define ck(a) (0<=(a)&&(a)<9)\nint di[]={-3,-1,1,3};\nint main(){\n    int n,s,t,b; char cs,ct,cb;\n    while(scanf(\"%d\",&n),n){\n        scanf(\" %c %c %c\",&cs,&ct,&cb); s=cs-'A', t=ct-'A', b=cb-'A';\n        double p[9]={0}; p[s]=1;\n         \n        while(n--){\n            double q[9]={0};\n            rep(i,9)rep(d,4){\n                if(ck(i+di[d])&&!(i%3==0&&di[d]==-1)&&!(i%3==2&&di[d]==1)&&i+di[d]!=b)q[i+di[d]]+=p[i]/4;\n                else q[i]+=p[i]/4;\n            }\n            rep(i,9)p[i]=q[i];\n        }\n         \n        printf(\"%.8f\\n\",p[t]);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <math.h>\n#include <map>\n#include <iomanip>\n#include <vector>\n#include <queue>\n#include <set>\n#define PI 3.14159265359\n#define INF 99999999;\n#define rep(i, n) for(int i=0; i<n; i++)\n#define REP(n) rep(i, n)\n#define EPS 1e-10\ntypedef long long ll;\nusing namespace std;\n\n\n\n/*\nclass Target\n{\npublic:\n\tvector <string> draw(int n)\n\t{\n\n\t}\n};\n*/\n\nint n;\nchar s, t, b;\n\n//(y, x)\npair<int, int> getPos(char c)\n{\n\tswitch (c)\n\t{\n\tcase 'A':\n\t\treturn make_pair(0, 0);\n\t\tbreak;\n\tcase 'B':\n\t\treturn make_pair(0, 1);\n\t\tbreak;\n\tcase 'C':\n\t\treturn make_pair(0, 2);\n\t\tbreak;\n\tcase 'D':\n\t\treturn make_pair(1, 0);\n\t\tbreak;\n\tcase 'E':\n\t\treturn make_pair(1, 1);\n\t\tbreak;\n\tcase 'F':\n\t\treturn make_pair(1, 2);\n\t\tbreak;\n\tcase 'G':\n\t\treturn make_pair(2, 0);\n\t\tbreak;\n\tcase 'H':\n\t\treturn make_pair(2, 1);\n\t\tbreak;\n\tcase 'I':\n\t\treturn make_pair(2, 2);\n\t\tbreak;\n\t}\n}\n\nint vx[] = {1, -1, 0, 0};\nint vy[] = {0, 0, 1, -1};\nint tx, ty, bx, by;\ndouble dp[3][3][16];\n\ndouble dfs(int x, int y, int n)\n{\n\tif (dp[x][y][n] != -1) return dp[x][y][n];\n\t\n\tif (n == 0 && x == tx && y == ty) return 1;\n\tif (n == 0) return 0;\n\t\n\tdouble ret = 0;\n\tfor (int i=0; i<4; i++)\n\t{\n\t\tint nx = x + vx[i];\n\t\tint ny = y + vy[i];\n\t\tif (0 <= nx && nx <= 2 && 0 <= ny && ny <= 2)\n\t\t{\n\t\t\tif (nx == bx && ny == by)\n\t\t\t{\n\t\t\t\tret += dfs(x, y, n - 1) * 0.25;\n\t\t\t} else {\n\t\t\t\tret += dfs(nx, ny, n - 1) * 0.25;\n\t\t\t}\n\t\t} else {\n\t\t\tret += dfs(x, y, n - 1) * 0.25;\n\t\t}\n\t}\n\t\n\treturn dp[x][y][n] = ret;\n}\n\nint main()\n{\n\t\n\twhile (cin >> n, n)\n\t{\n\t\tcin >> s >> t >> b;\n\t\tint sx = getPos(s).second;\n\t\tint sy = getPos(s).first;\n\t\ttx = getPos(t).second;\n\t\tty = getPos(t).first;\n\t\tbx = getPos(b).second;\n\t\tby = getPos(b).first;\n\t\trep(i, 3) rep(j, 3) rep(k, 16) dp[i][j][k] = -1;\n\t\tcout << fixed << setprecision(8);\n\t\tcout << dfs(sx, sy, n) << endl;\n\t}\n\t\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#define rep(i, n) for(int i = 0; i < n; ++i)\n#define ck(a) (0 <= (a) && (a) < 9)\n\nint di[] = {-3, -1, 1, 3};\n\nint main() {\n    int n, s, t, b; char cs, ct, cb;\n    while(scanf(\"%d\", &n), n) {\n        scanf(\"%c %c %c\", &cs, &ct, &cb);\n        s = cs - 'A', t = ct - 'A', b = cb - 'A';\n        double p[9] = {0}; p[s] = 1;\n        while(n--) {\n            double q[9] = {0};\n            rep(i, 9) rep(d, 4) {\n                if(ck(i + di[d]) && !(i % 3 == 0 && di[d] == -1) &&\n                   (i % 3 == 2 && di[i] == 1) && i + di[d] != b)\n                    q[i + di[d]] += p[i];\n                else q[i] += p[i] / 4;\n            }   \n            rep(i, 9) p[i] = q[i];\n        }\n        printf(\"%.8lf\\n\", p[t]);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <cassert>\nusing namespace std;\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define FOR(i,a,b) for(int i=(a);i<=(b);++i)\n#define REP(i,n) FOR(i,0,(n)-1)\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\nconst int INF = INT_MAX/10;\n\nint dy[] = {-1, 0, 1, 0};\nint dx[] = {0, 1, 0, -1};\n\nint main() {\n\tint n;\n\tchar s, t, b;\n\n\twhile(cin >> n, n) {\n\t\tcin >> s >> t >> b;\n\n\t\tint sx = (s-'A')%3, sy = (s-'A')/3;\n\t\tint tx = (t-'A')%3, ty = (t-'A')/3;\n\t\tint bx = (b-'A')%3, by = (b-'A')/3;\n\n\t\tvector<vvi> dp(3, vvi(3, vi(n+1)));\n\t\tdp[sy][sx][0] = 1;\n\t\tFOR(i, 1, n) {\n\t\t\tREP(x, 3) {\n\t\t\t\tREP(y, 3) {\n\t\t\t\t\tREP(d, 4) {\n\t\t\t\t\t\tint nx = x + dx[d];\n\t\t\t\t\t\tint ny = y + dy[d];\n\t\t\t\t\t\tif(nx < 0 || 2 < nx || ny < 0 || 2 < ny) {\n\t\t\t\t\t\t\tnx = x;\n\t\t\t\t\t\t\tny = y;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(nx == bx && ny == by) {\n\t\t\t\t\t\t\tnx = x;\n\t\t\t\t\t\t\tny = y;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdp[ny][nx][i] += dp[y][x][i-1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdouble ans = (double)dp[ty][tx][n]/(1<<(2*n));\n\t\tprintf(\"%.8f\\n\", ans);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <cstring>\n#include <cstdio>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n\n#define rep(i, n) for(int i = 0; i < (n); i++)\n#define FOR(i, a, b) for(int i = (a); i < (b); i++)\n#define all(v) (v).begin(), (v).end()\n#define rev(s) (s).rbegin(), (s).rend()\n#define MP make_pair\n#define X first\n#define Y second\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> P;\n\nconst int INF = 100000000;\n\nstring m = \"012345678\";\nP getP(char c){\n\tint p = m[c-'A']-'0';\n\treturn MP(p%3, p/3);\n}\n\nint dx[] = {0, 0, 1, -1};\nint dy[] = {-1, 1, 0, 0};\n\nint main(){\n\twhile(1){\n\t\tint n;\n\t\tchar s, t, b;\n\t\tcin >> n;\n\t\tif(!n)break;\n\t\tcin >> s >> t >> b;\n\n\t\tP sp = getP(s);\n\t\tP tp = getP(t);\n\t\tP bp = getP(b);\n\n\t\tdouble p[15][3][3] = {};\n\n\t\tp[0][sp.Y][sp.X] = 1.0;\n\n\t\tfor(int i = 1; i <= n; i++){\n\t\t\trep(j, 3){\n\t\t\t\trep(k, 3){\n\t\t\t\t\tif(MP(k, j) == bp) continue;\n\t\t\t\t\tint wallcnt = 0;\n\t\t\t\t\trep(l, 4){\n\t\t\t\t\t\tint x = k+dx[l];\n\t\t\t\t\t\tint y = j+dy[l];\n\t\t\t\t\t\tif(x < 0 || x > 2 || y < 0 || y > 2 ||\n\t\t\t\t\t\t\tMP(x, y) == bp){\n\t\t\t\t\t\t\twallcnt++;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tp[i][j][k] += p[i-1][y][x]/4;\n\t\t\t\t\t}\n\t\t\t\t\tp[i][j][k] += p[i-1][j][k]*wallcnt/4;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\", p[n][tp.Y][tp.X]);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<vector>\n#include<queue>\n#include<cstring>\n#include<cmath>\n#include<cstdio>\n#include<cstdlib>\nusing namespace std;\n#define REP(i,a,n) for(int i = a ; i < n ; i++)\n#define rep(i,n) REP(i,0,n)\n\ntypedef long long ll;\n\nint n;\ndouble dp[20][3][3];\nint dx[] = {-1,1,0,0};\nint dy[] = {0,0,1,-1};\n\nint main(){\n  while(cin>>n,n){\n    char a,b,c;\n    cin>>a>>b>>c;\n    int sx = (a - 'A') % 3;\n    int sy = (a - 'A') / 3;\n    int gx = (b - 'A') % 3;\n    int gy = (b - 'A') / 3;\n    int tx = (c - 'A') % 3;\n    int ty = (c - 'A') / 3;\n\n    memset(dp,0,sizeof(dp));\n    dp[0][sx][sy] = 1;\n\n    rep(i,n){\n      rep(j,3){\n        rep(k,3){\n          if(dp[i][j][k] == 0) continue;\n          rep(d,4){\n            int nx = j + dx[d];\n            int ny = k + dy[d];\n            if(3>nx && nx>=0 && 3>ny && ny>=0 && (nx!=tx || ny!=ty)){\n              dp[i+1][nx][ny] += dp[i][j][k] / 4;\n            }\n            else{\n              dp[i+1][j][k] += dp[i][j][k] / 4;\n            }\n          }\n        }\n      }\n    }\n\n    printf(\"%.8f\\n\",dp[n][gx][gy]);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<algorithm>\n#include<array>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<functional>\n#include<limits>\n#include<list>\n#include<map>\n#include<numeric>\n#include<set>\n#include<stack>\n#include<string>\n#include<sstream>\n#include<unordered_map>\n#include<queue>\n#include<vector>\nusing namespace std;\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing pii = pair<int, int>;\n\n#define rep(i,a,b) for(int i=(a);i<(b);i++)\n#define rrep(i,a,b) for(int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n#define dump(o) {cerr<<#o<<\" \"<<o<<endl;}\n#define dumpc(o) {cerr<<#o; for(auto &e:(o))cerr<<\" \"<<e;cerr<<endl;}\n#define INF 0x3f3f3f3f\n#define INFL 0x3f3f3f3f3f3f3f3fLL\nconst int MOD = 1e9 + 7;\n\nint di[4] = { 1,0,-1,0 };\nint dj[4] = { 0,1,0,-1 };\n\nsigned main() {\n\tcout << fixed << setprecision(8);\n\tfor (int n; cin >> n&&n;) {\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tdouble f[3][3] = {};\n\t\tdouble g[3][3] = {};\n\t\tpii S, T, B;\n\t\tS = pii((s - 'A') / 3, (s - 'A') % 3);\n\t\tT = pii((t - 'A') / 3, (t - 'A') % 3);\n\t\tB = pii((b - 'A') / 3, (b - 'A') % 3);\n\t\tf[S.first][S.second] = 1;\n\t\twhile (n--) {\n\t\t\tmemset(g, 0, sizeof(g));\n\t\t\tswap(f, g);\n\t\t\trep(a, 0, 3) rep(b, 0, 3) {\n\t\t\t\tint cnt = 4;\n\t\t\t\trep(i, 0, 4) {\n\t\t\t\t\tif (a + di[i] == B.first&&b + dj[i] == B.second) continue;\n\t\t\t\t\tif (0 > a + di[i] && a + dj[i] > 2)continue;\n\t\t\t\t\tif (0 > b + di[i] && b + dj[i] > 2)continue;\n\t\t\t\t\tf[a + di[i]][b + dj[i]] += g[a][b] / cnt;\n\t\t\t\t}\n\t\t\t\tf[a][b] += (g[a][b] / cnt)*(4 - cnt);\n\t\t\t}\n\t\t}\n\t\tcout << f[T.first][T.second] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <cstring>\n#include <cstdio>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n\n#define rep(i, n) for(int i = 0; i < (n); i++)\n#define FOR(i, a, b) for(int i = (a); i < (b); i++)\n#define all(v) (v).begin(), (v).end()\n#define rev(s) (s).rbegin(), (s).rend()\n#define MP make_pair\n#define X first\n#define Y second\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> P;\n\nconst int INF = 100000000;\n\nstring m = \"012345678\";\nP getP(char c){\n\tint p = m[c-'A']-'0';\n\treturn MP(p%3, p/3);\n}\n\nint dx[] = {0, 0, 1, -1};\nint dy[] = {-1, 1, 0, 0};\n\nint main(){\n\twhile(1){\n\t\tint n;\n\t\tchar s, t, b;\n\t\tcin >> n;\n\t\tif(!n)break;\n\t\tcin >> s >> t >> b;\n\n\t\tP sp = getP(s);\n\t\tP tp = getP(t);\n\t\tP bp = getP(b);\n\n\t\tdouble p[16][3][3] = {};\n\n\t\tp[0][sp.Y][sp.X] = 1.0;\n\n\t\tfor(int i = 1; i <= n; i++){\n\t\t\trep(j, 3){\n\t\t\t\trep(k, 3){\n\t\t\t\t\tif(MP(k, j) == bp) continue;\n\t\t\t\t\tint wallcnt = 0;\n\t\t\t\t\trep(l, 4){\n\t\t\t\t\t\tint x = k+dx[l];\n\t\t\t\t\t\tint y = j+dy[l];\n\t\t\t\t\t\tif(x < 0 || x > 2 || y < 0 || y > 2 ||\n\t\t\t\t\t\t\tMP(x, y) == bp){\n\t\t\t\t\t\t\twallcnt++;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tp[i][j][k] += p[i-1][y][x]/4;\n\t\t\t\t\t}\n\t\t\t\t\tp[i][j][k] += p[i-1][j][k]*wallcnt/4;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\", p[n][tp.Y][tp.X]);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstring>\n#include <iomanip>\n#include <iostream>\nusing namespace std;\nint n, b1, b2, b3, dr[4] = { -3, -1, 1, 3 }; char c1, c2, c3; double dp[19][9];\nint main() {\n\twhile (cin >> n, n) {\n\t\tcin >> c1 >> c2 >> c3;\n\t\tb1 = c1 - 65, b2 = c2 - 65, b3 = c3 - 65;\n\t\tmemset(dp, 0, sizeof(dp));\n\t\tdp[0][b1] = 1;\n\t\tfor (int i = 1; i <= n; i++) {\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tint r[4] = { 0 };\n\t\t\t\tfor (int k = 0; k < 4; k++) {\n\t\t\t\t\tint u = j + dr[k];\n\t\t\t\t\tif (u < 0 || u > 8 || abs(j % 3 - u % 3) == 2 || u == b3) continue;\n\t\t\t\t\tr[k] = 1;\n\t\t\t\t}\n\t\t\t\tfor (int k = 0; k < 4; k++) {\n\t\t\t\t\tif (r[k]) dp[i][j + dr[k]] += dp[i - 1][j] / 4;\n\t\t\t\t\telse dp[i][j] += dp[i - 1][j] / 4;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << fixed << setprecision(15) << dp[n][b2] << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string.h>\n#include <cmath>\n#include <cstdio>\n\nusing namespace std;\n\nint dx[4]={-1,0,0,1};\nint dy[4]={0,1,-1,0};\n\nint main(void)\n{\n\tint n;\n\tchar s,t,b;\n\tint dp[5][5];\n\tint i1,i2,i3,i4,i5,i6;\n\tdouble ans;\n\tint temp[5][5];\n\n\twhile(1){\n\t\tcin>>n;\n\t\tif(n==0) break;\n\t\tcin>>s>>t>>b;\n\n\t\tmemset(dp,-1,sizeof(dp));\n\t\tmemset(temp,0,sizeof(temp));\n\t\tfor(i1=1;i1<=3;i1++){\n\t\t\tfor(i2=1;i2<=3;i2++){\n\t\t\t\tdp[i1][i2]=0;\n\t\t\t}\n\t\t}\n\t\tdp[((s-'A')/3)+1][((s-'A')%3)+1] = 1;\n\t\tdp[((b-'A')/3)+1][((b-'A')%3)+1] = -1;\n\t\ttemp[((b-'A')/3)+1][((b-'A')%3)+1] = -1;\n\n\t\tfor(i1=0;i1<n;i1++){\n\n\t\t\tfor(i2=1;i2<=3;i2++){\n\t\t\t\tfor(i3=1;i3<=3;i3++){\n\t\t\t\t\t\n\t\t\t\t\tif(dp[i2][i3]>0){\n\t\t\t\t\t\tfor(i4=0;i4<4;i4++){\n\t\t\t\t\t\t\tif(dp[i2+dy[i4]][i3+dx[i4]]==-1) temp[i2][i3]+=dp[i2][i3];\n\t\t\t\t\t\t\telse temp[i2+dy[i4]][i3+dx[i4]]+=dp[i2][i3];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor(i5=1;i5<=3;i5++){\n\t\t\t\tfor(i6=1;i6<=3;i6++){\n\t\t\t\t\tdp[i5][i6]=temp[i5][i6];\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemset(temp,0,sizeof(temp));\n\t\t\ttemp[((b-'A')/3)+1][((b-'A')%3)+1] = -1;\n\t\t}\n\n\t\tans=double(dp[((t-'A')/3)+1][((t-'A')%3)+1])/pow(4.0,n);\n\t\tprintf(\"%.8lf\\n\",ans);\n\n\n\t\t/*for(i1=1;i1<=3;i1++){\n\t\t\tfor(i2=1;i2<=3;i2++){\n\t\t\t\tcout<<dp[i1][i2]<<\" \";\n\t\t\t}\n\t\t\tcout<<endl;\n\t\t}*/\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n)for(int i=0;i<n;i++)\nusing namespace std;\n\nint dx[]{ 1,-1,0,0 }, dy[]{ 0,0,1,-1 };\nint dp[3][3][16];\nint main() {\n\tint n;\n\twhile (cin >> n, n) {\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tmemset(dp, 0, sizeof(dp));\n\t\tdp[(s - 'A') / 3][(s - 'A') % 3][0] = 1;\n\t\trep(k, n) {\n\t\t\trep(i, 3) {\n\t\t\t\trep(j, 3) {\n\t\t\t\t\tif (!dp[i][j][k])continue;\n\t\t\t\t\trep(l, 4) {\n\t\t\t\t\t\tint nx = i + dx[l], ny = j + dy[l];\n\t\t\t\t\t\tif (nx < 0 || ny < 0 || nx >= 3 || ny >= 3 || 'A' + nx * 3 + ny == b)\n\t\t\t\t\t\t\tdp[i][j][k + 1] += dp[i][j][k];\n\t\t\t\t\t\telse dp[nx][ny][k + 1] += dp[i][j][k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint sum = 0;\n\t\trep(i, 3)rep(j, 3)sum += dp[i][j][n];\n\t\tprintf(\"%.7lf\\n\", (double)dp[(t - 'A') / 3][(t - 'A') % 3][n] / (double)sum);\n\t};\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int dx[] = {-1, 0, 1, 0};\nconst int dy[] = {0, -1, 0, 1};\n\nstruct POINT\n{\n\tint x, y;\n\t\n\tbool operator<(const POINT t)const{\n\t\tif (x == t.x) return x < t.x;\n\t\treturn y < t.y;\n\t}\n\t\n\tbool operator==(const POINT t)const{\n\t\treturn (x == t.x && y == t.y);\n\t}\n};\ntypedef pair<POINT, int> P;\n\nPOINT toCoor(char c)\n{\n\tc -= 'A';\n\treturn {c / 3, c % 3};\n}\n\nint main()\n{\t\n\tint n;\n\twhile (scanf(\"%d\", &n), n){\n\t\tchar A, B, C;\n\t\tscanf(\" %c %c %c\", &A, &B, &C);\n\t\t\n\t\tPOINT s, t, b;\n\t\ts = toCoor(A);\n\t\tt = toCoor(B);\n\t\tb = toCoor(C);\n\t\t\n\t\tqueue<P> que;\n\t\tint cnt[3][3] = {0};\n\t\tfor (que.push(P(s, 0)); que.size(); que.pop()){\n\t\t\tP p = que.front();\n\t\t\t\n\t\t\tif (p.second == n){\n\t\t\t\t//printf(\"%d %d\\n\", p.first.x, p.first.y);\n\t\t\t\tcnt[p.first.x][p.first.y]++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tfor (int i = 0; i < 4; i++){\n\t\t\t\tint tx = p.first.x + dx[i];\n\t\t\t\tint ty = p.first.y + dy[i];\n\t\t\t\tif (tx < 0 || tx >= 3 || ty < 0 || ty >= 3 || b == (POINT){tx, ty}){\n\t\t\t\t\tque.push(P(p.first, p.second + 1));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tque.push(P({tx, ty}, p.second + 1));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tint sum = 0, a = 0;\n\t\tfor (int i = 0; i < 3; i++){\n\t\t\tfor (int j = 0; j < 3; j++){\n\t\t\t\t//printf(\"%d\", cnt[i][j]);\n\t\t\t\tsum += cnt[i][j];\n\t\t\t\tif (t == (POINT){i, j}) a += cnt[i][j];\n\t\t\t}\n\t\t\t//puts(\"\");\n\t\t}\n\t\t\n\t\t//printf(\"%d %d\\n\", a, sum);\n\t\tprintf(\"%.8f\\n\", (double)a / (double)sum);\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <strings.h>\n\nusing namespace std;\n\nint global_block;\nint global_agents[16][9];\n\nint north(int x) {\n  if (x < 3 || global_block == x - 3)\n    return x;\n  else\n    return x - 3;\n}\nint east(int x) {\n  if (x % 3 == 2 || global_block == x + 1)\n    return x;\n  else\n    return x + 1;\n}\nint south(int x) {\n  if (x >= 6 || global_block == x + 3)\n    return x;\n  else\n    return x + 3;\n}\nint west(int x) {\n  if (x % 3 == 0 || global_block == x - 1)\n    return x;\n  else\n    return x - 1;\n}\n\ndouble compute(int energy, int start, int target, int block)\n{\n  global_block = block;\n  bzero(global_agents, sizeof(int) * 16 * 9);\n  global_agents[0][start] = 1;\n\n  for (int i=0; i < energy; i++) {\n    for (int pos=0; pos < 9; pos++) {\n      if (global_agents[i][pos] != 0) {\n        global_agents[i+1][north(pos)] += global_agents[i][pos];\n        global_agents[i+1][west (pos)] += global_agents[i][pos];\n        global_agents[i+1][south(pos)] += global_agents[i][pos];\n        global_agents[i+1][east (pos)] += global_agents[i][pos];\n      }\n    }\n  }\n  \n  return pow(0.25, energy) * global_agents[energy][target];\n}\n\nint main(void) \n{\n  while (true) {\n\n    int energy;\n    cin >> energy;\n    if (energy == 0) break;\n    char start, target, block;\n    cin >> start >> target >> block;\n    int s = start  - 'A';\n    int t = target - 'A';\n    int b = block  - 'A';\n    //cout << \"start = \" << s << \", target = \" << t << \", block = \" << b << endl;\n    cout << compute(energy, s, t, b) << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\ndouble dp[15][3][3]={};\nint dx[4]={1,-1,0,0};\nint dy[4]={0,0,1,-1};\nint bx,by;\nint tx,ty;\n\ndouble rec(int rest,int x,int y){\n     //cout<<\"x:\"<<x<<\"y:\"<<y<<endl;\n     if(x<0||x>2||y<0||y>2)return 0;\n     if(dp[rest][x][y]>0)return dp[rest][x][y];\n\n     if(rest==0){\n\t  if(x==tx&&y==ty)return 1;\n\t  else return 0;\n     }\n     double sum=0;\n     for(int i=0;i<4;i++){\n\t  if((x+dx[i]==bx)&&(y+dy[i]==by)){\n\t       sum+=rec(rest-1,x,y);\n\t       }else{\n\t       sum+=rec(rest-1,x+dx[i],y+dy[i]);\n\t  }\n     }\n     sum=sum/4.0;\n     dp[rest][x][y]=sum;\n     return sum;\n}\nvoid topoint(char a,int &x,int &y){\n     int tmp=a-'A';\n     x=tmp/3;\n     y=tmp%3;\n     return;\n}\nint main(){\n     int N;\n     cout.precision(8);\n     cout.setf(ios::fixed);\n     while(cin>>N,N){\n\t  char s,t,b;\n\t  cin>>s>>t>>b;\n\t  int sx,sy;\n\t  topoint(s,sx,sy);\n\t  topoint(t,tx,ty);\n\t  topoint(b,bx,by);\n\t  //cout<<sx<<\":\"<<sy<<\" \"<<tx<<\":\"<<ty<<endl;\n\t  cout<<rec(N,sx,sy)<<endl;\n\t  for(int i=0;i<15;i++){\n\t       for(int j=0;j<3;j++){\n\t\t    for(int k=0;k<3;k++){\n\t\t\t dp[i][j][k]=0;\n\t\t    }\n\t       }\n\t  }\n\t\t   \n     }\n     return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include<cstdio>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<n;i++)\nconst int dx[] ={ 0,1,0,-1};\nconst int dy[] ={-1,0,1, 0};\n\nint main(){\n  int n;\n  while(cin >> n , n){\n    long double dp[16][5][5] = {{{0.0}}};\n    char map[5][5];\n    rep(i,5)rep(j,5)map[i][j] = 'X';\n    rep(i,3)rep(j,3)map[i+1][j+1] = ' ';\n    int sx, sy, gx, gy, bx, by;\n    char s,t,b;\n    cin >> s >> t >> b ;\n    sy = (s-'A')/3 +1 , sx = (s-'A')%3 +1;\n    gy = (t-'A')/3 +1 , gx = (t-'A')%3 +1;\n    by = (b-'A')/3 +1 , bx = (b-'A')%3 +1;\n    \n    map[by][bx] = 'X';\n    dp[n][sy][sx] = 1.0;\n    \n    while(n){\n      for(int y=1;y<=3;y++){\n\tfor(int x=1;x<=3;x++){\n\t  rep(i,4){\n\t    int tx = x+dx[i], ty = y+dy[i] ;\n\t    if(map[ty][tx] == 'X')ty = y , tx = x;\n\t    dp[n-1][ty][tx] += dp[n][y][x] / 4.0;\n\t  }\n\t}\n      }\n      n--;\n    }\n    printf(\"%.8Lf\\n\",dp[0][gy][gx]);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<queue>\n\ntypedef std::pair<int, int> P;\n\ndouble data[3][3];\nint cost[3][3];\nint sx, sy, tx, ty, bx, by;\n\nint dx[] = { 0, 1, 0, -1 };\nint dy[] = { 1, 0, -1, 0 };\n\nvoid bfs(){\n\n\tstd::queue<P>que;\n\tque.push(P(sx, sy));\n\n\twhile (!que.empty()){\n\t\tP p = que.front();\n\t\tque.pop();\n\n\t\tif (cost[p.second][p.first] > 0){\n\n\t\t\tfor (int i = 0; i < 4; i++){\n\t\t\t\tint nx = p.first + dx[i];\n\t\t\t\tint ny = p.second + dy[i];\n\n\t\t\t\tif (0 <= nx&&nx < 3 && 0 <= ny&&ny < 3 ){\n\t\t\t\t\tdata[ny][nx] += data[p.second][p.first] / 4;\n\t\t\t\t\tcost[ny][nx] = cost[p.second][p.first] - 1;\n\n\t\t\t\t\tif (nx == bx&&ny == by)nx = p.first, ny = p.second;\n\n\t\t\t\t\tque.push(P(nx, ny));\n\t\t\t\t}\n\t\t\t}\n\t\t\tcost[p.second][p.first]--;\n\t\t}\n\t}\n}\n\nint main(){\n\tint n;\n\twhile (std::cin >> n, n){\n\n\t\tmemset(data, 0, sizeof(data));\n\t\tmemset(cost, 0, sizeof(cost));\n\n\t\tchar s, t, b;\n\t\tstd::cin >> s >> t >> b;\n\n\t\tsx = (s - 'A') % 3;\n\t\tsy = (s - 'A') / 3;\n\t\ttx = (t - 'A') % 3;\n\t\tty = (t - 'A') / 3;\n\t\tbx = (b - 'A') % 3;\n\t\tby = (b - 'A') / 3;\n\n\t\tdata[sy][sx] = 1;\n\t\tcost[sy][sx] = n;\n\n\t\tbfs();\n\n\t\tprintf(\"%.8f\\n\", data[ty][tx]);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\ntypedef vector <int> VI;\ntypedef vector <VI> VVI;\n\nconst int dx[4] = { 0, 0, 1, -1 };\nconst int dy[4] = { 1, -1, 0, 0 };\n\nint get_x( char c )\n{\n\tif ( c == 'A' || c == 'D' || c == 'G' ) return 0;\n\tif ( c == 'B' || c == 'E' || c == 'H' ) return 1;\n\tif ( c == 'C' || c == 'F' || c == 'I' ) return 2;\n\treturn -1;\n}\n\nint get_y( char c )\n{\n\tif ( c == 'A' || c == 'B' || c == 'C' ) return 0;\n\tif ( c == 'D' || c == 'E' || c == 'F' ) return 1;\n\tif ( c == 'G' || c == 'H' || c == 'I' ) return 2;\n\treturn -1;\n}\n\n\nint main( void )\n{\n\tint n; char s, t, b;\n\twhile ( 1 )\n\t{\n\t\tcin >> n;\n\t\tif ( n == 0 ) break;\n\t\tcin >> s >> t >> b;\n\n\t\tint sx, sy, gx, gy, ox, oy;\n\t\tsx = get_x( s ); sy = get_y( s );\n\t\tgx = get_x( t ); gy = get_y( t );\n\t\tox = get_x( b ); oy = get_y( b );\n\n\t\tVVI prev( 3, VI(3,0) ), next;\n\t\tprev[sy][sx] = 1;\n\t\tfor ( int lpc = 0; lpc < n; lpc++ )\n\t\t{\n\t\t\tnext = VVI( 3, VI( 3, 0 ) );\n\t\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ )\n\t\t\t{\n\t\t\t\tif ( i == oy && j == ox ) continue;\n\t\t\t\tbool stop = 0;\n\t\t\t\tfor ( int k = 0; k < 4; k++ )\n\t\t\t\t{\n\t\t\t\t\tint nx = j + dx[k];\n\t\t\t\t\tint ny = i + dy[k];\n\t\t\t\t\tif ( nx < 0 || nx >= 3 || ny < 0 || ny >= 3 )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( nx == ox && ny == oy )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnext[i][j] += prev[ny][nx];\n\t\t\t\t}\n\t\t\t\tif ( stop )\n\t\t\t\t{\n\t\t\t\t\tnext[i][j] += prev[i][j] * stop;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tprev = next;\n\t\t}\n\n\t\tint sum = 0;\n\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ ) sum += next[i][j];\n\n\t\tdouble answer = (double)next[gy][gx] / (double)sum;\n\n\t\tcout.precision( 8 );\n\t\tcout.setf( ios::fixed );\n\t\tcout << answer << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nint xdir[4] = {0, 1, 0, -1}, ydir[4] = {1, 0, -1, 0};\nint main()\n{\n\tint n, p, q;\n\tlong double a[3][3][16];\n\tchar s, t, b, alp[3][3];\n\t\n\tfor(int i = 0; i < 3; i++){\n\t\tfor(int j = 0; j < 3; j++){\n\t\t\talp[i][j] = (char)('A'+(i*3+j));\n\t\t}\n\t}\n\t\n\twhile(cin>>n && n){\n\t\tcin >> s >> t >> b;\n\t\tfill(&a[0][0][0], &a[2][2][n], 0);\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tif(alp[i][j] == s){\n\t\t\t\t\tp = i;\n\t\t\t\t\tq = j;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\ta[p][q][0] = 1.0;\n\t\t\n\t\tfor(int k = 0; k < n; k++){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\t\tfor(int l = 0; l < 4; l++){\n\t\t\t\t\t\tint dx = j+xdir[l], dy = i+ydir[l];\n\t\t\t\t\t\tif(0 <= dx && dx < 3 && 0 <= dy && dy < 3 && alp[dy][dx] != b){\n\t\t\t\t\t\t\ta[dy][dx][k+1] += a[i][j][k]/4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tif(alp[i][j] == t){\n\t\t\t\t\tp = i;\n\t\t\t\t\tq = j;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tprintf(\"%.8Lf\\n\", a[p][q][n]);\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tchar n, s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\t//fx[i+'A']=i%3+1;\n\t\t//fy[i+'A']=i/3+1;\n\t}\n\t\n\t//while( scanf(\"%d \", &n) , n ){\n\t\t//scanf(\" %c %c %c\", &s, &t, &b);\n\t\tchar m[5][5] = {0};\n\t\t/*for(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;*/\n\n\t\tif( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else{\n\t\t\t//solve( n , m );\n\t\t\t;\n\t\t}\n\t\t//debug( m );\n\t\t//printf(\"%.8f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t//}\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n\nint dp[16][3 + 2][3 + 2];\n\nint main(void)\n{\n\tint n;\n\tchar s[2], e[2], t[2];\n\tint start;\n\tint end;\n\tint barn;\n\tint mot;\n\t\n\twhile (1){\n\t\tscanf(\"%d\", &n);\n\t\tif (n == 0) break;\n\t\t\n\t\tscanf(\"%s%s%s\", s, e, t);\n\t\t\n\t\tfor (int i = 0; i < 5; i++){\n\t\t\tfor (int j = 0; j < 5; j++){\n\t\t\t\tfor (int k = 0; k < 16; k++){\n\t\t\t\t\tif (i == 0 || i == 4 || j == 0 || j == 4){\n\t\t\t\t\t\tdp[k][i][j] = -1;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[k][i][j] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tstart = s[0] - 'A';\n\t\tbarn = t[0] - 'A';\n\t\tdp[0][(start % 3) + 1][(start / 3) + 1] = 1;\n\t\t\n\t\tfor (int i = 0; i < n + 1; i++){\n\t\t\tdp[i][(barn % 3) + 1][(barn / 3) + 1] = -1;\n\t\t}\n\t\t\n\t\tfor (int i = 0; i < n; i++){\n\t\t\tfor (int y = 1; y <= 3; y++){\n\t\t\t\tfor (int x = 1; x <= 3; x++){\n\t\t\t\t\tif (dp[i][x][y] == -1) continue;\n\t\t\t\t\tif (dp[i][x + 1][y] == -1){\n\t\t\t\t\t\tdp[i + 1][x][y] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[i + 1][x + 1][y] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t\tif (dp[i][x - 1][y] == -1){\n\t\t\t\t\t\tdp[i + 1][x][y] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[i + 1][x - 1][y] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t\tif (dp[i][x][y + 1] == -1){\n\t\t\t\t\t\tdp[i + 1][x][y] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[i + 1][x][y + 1] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t\tif (dp[i][x][y - 1] == -1){\n\t\t\t\t\t\tdp[i + 1][x][y] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[i + 1][x][y - 1] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tmot = 0;\n\t\tfor (int y = 1; y <= 3; y++){\n\t\t\tfor (int x = 1; x <= 3; x++){\n\t\t\t\tif (dp[n][x][y] != -1){\n\t\t\t\t\tmot += dp[n][x][y];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tend = e[0] - 'A';\n\t\tprintf(\"%lf\\n\", double((double)(dp[n][(end % 3) + 1][(end / 3) + 1]) / (double)mot));\n\t}\n\t\n\treturn (0);\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <iostream>\n#include <string.h>\n\nusing namespace std;\n\nint n;\nchar room[10] = \"ABCDEFGHI\";\nchar s, t, b;\nint off[4][2] = {{-1, 0}, {1, 0}, {0, -1}, {0, 1}};\nint x, y;\n\ndouble table[3][3];\n\ndouble solve()\n{\n\tmemset(&table[0][0], 0, sizeof(double) * 9);\n\ttable[x][y] = 1.0;\n\tfor(int k=0; k<n; k++)\n\t{\n\t\tdouble temp[3][3];\n\t\tmemset(&temp[0][0], 0, sizeof(double) * 9);\n\t\tfor(int j=0; j<3; j++)\n\t\t{\n\t\t\tfor(int i=0; i<3; i++)\n\t\t\t{\n\t\t\t\tif(table[j][i] != 0.0)\n\t\t\t\t{\n\t\t\t\t\tfor(int m=0; m<4; m++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint xx = i + off[m][0];\n\t\t\t\t\t\tint yy = j + off[m][1];\n\t\t\t\t\t\tint index = xx + yy * 3;\n\t\t\t\t\t\txx = (xx>=0 && xx<3 && room[index] != b) ? xx : i;\n\t\t\t\t\t\tyy = (yy>=0 && yy<3 && room[index] != b) ? yy : j;\n\t\t\t\t\t\ttemp[yy][xx] += table[j][i] / 4.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tmemcpy(&table[0][0], &temp[0][0], sizeof(double) * 9);\n\t}\n\n\tfor(int i=0; i<9; i++)\n\t{\n\t\tif(room[i]==t) return table[i/3][i%3];\n\t}\n\n\treturn 0.0;\n}\n\nint main()\n{\n\twhile( 1 )\n\t{\n\t\tcin >> n;\n\t\tif(n==0) break;\n\t\t\n\t\tcin >> s >> t >> b;\n\t\tfor(int i=0; i<9; i++)\n\t\t{\n\t\t\tif(room[i] == s)\n\t\t\t{\n\t\t\t\tx = i%3;\n\t\t\t\ty = i/3;\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8f\\n\", solve());\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <algorithm>\n\nusing namespace std;\n\nint result[15][9];\nint able[9][4];\nchar t;\n\nint solve(int battery, char room, int dst)\n{\n\tif(able[room-'A'][dst]){\n\t\tif(dst == 0)      room -= 3;\n\t\telse if(dst == 1) ++room;\n\t\telse if(dst == 2) room += 3;\n\t\telse              --room;\n\t}\n\t\n\t--battery;\n\tif(battery == 0){\n\t\treturn room == t;\n\t}else{\n\t\tif(result[battery][room-'A'] != -1)\n\t\t\treturn result[battery][room-'A'];\n\t\t\n\t\tresult[battery][room-'A'] = 0;\n\t\tfor(int i=0 ; i<4 ; ++i)\n\t\t\tresult[battery][room-'A'] += solve(battery, room, i);\n\t\t\n\t\treturn result[battery][room-'A'];\n\t}\n}\n\nint main()\n{\n\tint n;\n\tchar s;\n\t\n\twhile(scanf(\"%d\", &n), n){\n\t\tchar b;\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\t\n\t\tfor(int i=0 ; i<9 ; ++i){\n\t\t\tfor(int j=0 ; j<4 ; ++j)\n\t\t\t\table[i][j] = 1;\n\t\t\t\n\t\t\tif(i<3)    able[i][0] = 0;\n\t\t\tif(i>5)    able[i][2] = 0;\n\t\t\tif(i%3==0) able[i][3] = 0;\n\t\t\tif(i%3==2) able[i][1] = 0;\n\t\t}\n\t\t\n\t\tb -= 'A';\n\t\tif(b>=3)   able[b-3][2] = 0;\n\t\tif(b<=5)   able[b+3][0] = 0;\n\t\tif(b%3!=0) able[b-1][1] = 0;\n\t\tif(b%3!=2) able[b+1][3] = 0;\n\t\t\n\t\tfor(int i=0 ; i<15 ; ++i){\n\t\t\tfor(int j=0 ; j<9 ; ++j)\n\t\t\t\tresult[i][j] = -1;\n\t\t}\n\t\t\n\t\tint acc = 0;;\n\t\tfor(int i=0 ; i<4 ; ++i)\n\t\t\tacc += solve(n, s, i);\n\t\t\n\t\tprintf(\"%lf\\n\", acc/pow(4.0, n));\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string.h>\n#include <cmath>\n#include <cstdio>\n\nusing namespace std;\n\nint dx[4]={-1,0,0,1};\nint dy[4]={0,1,-1,0};\n\nint main(void)\n{\n\tint n;\n\tchar s,t,b;\n\tint dp[5][5];\n\tint i1,i2,i3,i4;\n\tdouble ans;\n\n\twhile(1){\n\t\tcin>>n;\n\t\tif(n==0) break;\n\t\tcin>>s>>t>>b;\n\n\t\tmemset(dp,-1,sizeof(dp));\n\t\tfor(i1=1;i1<=3;i1++){\n\t\t\tfor(i2=1;i2<=3;i2++){\n\t\t\t\tdp[i1][i2]=0;\n\t\t\t}\n\t\t}\n\t\tdp[((s-'A')/3)+1][((s-'A')%3)+1] = 1;\n\t\tdp[((b-'A')/3)+1][((b-'A')%3)+1] = -1;\n\n\t\tfor(i1=0;i1<n;i1++){\n\n\t\t\tfor(i2=1;i2<=3;i2++){\n\t\t\t\tfor(i3=1;i3<=3;i3++){\n\t\t\t\t\tif(dp[i2][i3]==1){\n\t\t\t\t\t\tdp[i2][i3]=0;\n\t\t\t\t\t\tfor(i4=0;i4<4;i4++){\n\t\t\t\t\t\t\tif(dp[i2+dy[i4]][i3+dx[i4]]==-1) dp[i2][i3]++;\n\t\t\t\t\t\t\telse dp[i2+dy[i4]][i3+dx[i4]]++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tans=double(dp[((t-'A')/3)+1][((t-'A')%3)+1])/pow(4.0,n);\n\t\tprintf(\"%.8lf\\n\",ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//============================================================================\n// Name        : TopCoderCompetition.cpp\n// Author      : taguchi\n// Version     :\n// Copyright   : Your copyright notice\n// Description : Hello World in C++, Ansi-style\n//============================================================================\n\n#include <iostream>\n#include <bitset>\n#include <algorithm>\n#include <map>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <numeric>\n#include <list>\n#include <sstream>\nusing namespace std;\n//#define P pair<int,int>\n//#define max 999999\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\n#define rep(i,n) for(ull i = 0;i<n;i++)\n#define pb(n) push_back(n)\n#define clear(n) memset(n,0,sizeof(n))\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\nstruct edge{int cost,to;};\n\nvector<string> split(string &in,char delimiter){\n\tvector<string> re; uint cur = 0,next;\n\twhile((next = in.find_first_of(delimiter,cur)) != string::npos){\n\t\tre.pb(string(in,cur,next-cur));\n\t\tcur = next + 1;\n\t}\n\tre.pb(string(in,cur,in.size()-cur));\n\treturn re;\n}\nvector<int> split_int(string &in, char delimiter){\n\tvector<string> str = split(in,delimiter);\n\tvector<int> re;\n\trep(i,str.size()){\n\t\tre.pb(strtol(str[i].c_str(),NULL,10));\n\t}\n\treturn re;\n}\n\nclass Range{\npublic:\n\tint a,b;\n\tRange(int an,int bn) : a(an),b(bn){}\n\n\tbool operator()(int n){\n\t\treturn a<=n&&n<=b;\n\t}\n\tbool isCross(Range x){\n\t\treturn x(a) || x(b);\n\t}\n\tbool contains(Range x){\n\t\treturn this->a <= x.a && x.b <= this->b;\n\t}\n};\n\n\nint main(){\n\tint dx[] = {0,1,0,-1};\n\tint dy[] = {1,0,-1,0};\n\twhile(1){\n\t\tdouble prob[16][5][5];\n\t\tmemset(prob,0,sizeof(prob));\n\t\tint n;\n\t\tcin >> n;\n\t\tif(n == 0) break;\n\t\tchar s,t,b;\n\t\tcin >> s >> t >> b;\n\t\tint map[5][5];\n\t\tmemset(map,0,sizeof(map));\n\t\trep(i,5){\n\t\t\tmap[i][0] = 1;\n\t\t\tmap[0][i] = 1;\n\t\t\tmap[i][4] = 1;\n\t\t\tmap[4][i] = 1;\n\t\t}\n\t\tint kb = b - 'A';\n\t\tmap[kb%3 + 1][kb/3 + 1] = 1;\n\t\tint ks = s - 'A';\n\t\tprob[n][ks%3 + 1][ks/3 + 1] = 1;\n\t\tfor(int batt = n;batt>=1;batt--){\n\t\t\tfor(int x = 3;x>=1;x--){\n\t\t\t\tfor(int y = 3;y>=1;y--){\n\t\t\t\t\tfor(int p = 0;p<4;p++){\n\t\t\t\t\t\tint nx = x + dx[p];\n\t\t\t\t\t\tint ny = y + dy[p];\n\t\t\t\t\t\tif(map[nx][ny] == 0){\n\t\t\t\t\t\t\tprob[batt-1][nx][ny] += prob[batt][x][y] * 0.25;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tprob[batt-1][x][y] += prob[batt][x][y] * 0.25;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint kt = t - 'A';\n\t\tcout << prob[0][kt%3 + 1][kt/3+1] << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stdio.h>\nusing namespace std;\n\nint dy[]={-1,0,1,0};\nint dx[]={0,1,0.-1};\n\ndouble dp[3][3][16];\nint n;\nchar s,t,b;\nint S,T,B;\n\ndouble solve(int y,int x,int n){\n  if(dp[y][x][n]!=-1.0)return dp[y][x][n];\n  if(n==0)return dp[y][x][n]=(y*3+x==T?1.0:0.0);\n\n  double sum=0.0;\n  for(int i=0;i<4;i++){\n    int ny=y+dy[i];\n    int nx=x+dx[i];\n    if(ny<0||nx<0)sum+=solve(y,x,n-1);\n    if(ny>=3||nx>=3)sum+=solve(y,x,n-1);\n    if(ny*3+nx==B)sum+=solve(y,x,n-1);\n    else sum+=solve(ny,nx,n-1);\n  }\n  return dp[y][x][n]=sum/4.0;\n}\n\nvoid init(){\n  for(int i=0;i<3;i++)\n    for(int j=0;j<3;j++)\n      for(int k=0;k<16;k++)\n\tdp[i][j][k]=-1.0;\n}\n\nint main(){\n  while(1){\n    cin>>n;\n    if(n==0)break;\n    cin>>s>>t>>b;\n    init();\n    S=s-'A';\n    T=t-'A';\n    B=b-'A';\n    printf(\"%.8f\\n\",solve(S/3,S%3,n));\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tchar n, s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\t//fx[i+'A']=i%3+1;\n\t\t//fy[i+'A']=i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d \", &n) , n ){\n\t\t//scanf(\" %c %c %c\", &s, &t, &b);\n\t\tcin >> s >> t >> b;\n\t\tchar m[5][5] = {0};\n\t\t/*for(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;*/\n\n\t\tif( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else{\n\t\t\t//solve( n , m );\n\t\t\t;\n\t\t}\n\t\t//debug( m );\n\t\t//printf(\"%.8f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tint n;\n\tchar s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\t//fx[i+'A']=i%3+1;\n\t\t//fy[i+'A']=i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d \", &n) , n ){\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\t//cin >> s >> t >> b;\n\t\tchar m[5][5] = {0};\n\t\t/*for(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;*/\n\n\t\tif( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else{\n\t\t\t//solve( n , m );\n\t\t\t;\n\t\t}\n\t\t//debug( m );\n\t\t//printf(\"%.8f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define F first\n#define S second\n#define INF 1 << 30\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\ndouble dp[16][3][3];\nint n, dx[] = {0,-1,0,1}, dy[] = {-1,0,1,0};\nchar cs, ct, cb;\nint s, t, b;\n\nint main(){\n  while(scanf(\"%d\", &n) && n){\n    memset(dp, 0.0, sizeof(dp));\n    scanf(\"\\n%c %c %c\", &cs, &ct, &cb);\n    s = cs - 'A';\n    t = ct - 'A';\n    b = cb - 'A';\n    //    fprintf(stderr, \"%c\\n\", cs);\n    dp[0][s/3][s%3] = 1.0;\n\n    rep(i, n) rep(y, 3) rep(x, 3){\n      if(dp[i][y][x] == 0) continue;\n      rep(d, 4){\n\tint ny = y + dy[d], nx = x + dx[d];\n\tif(ny < 0 || nx < 0 || ny >= 3 || nx >= 3 || ny*3+nx == b) dp[i+1][y][x] += dp[i][y][x];\n\telse dp[i+1][ny][nx] += dp[i][y][x]*0.25;\n      }\n    }\n\n    printf(\"%.8lf\\n\", dp[n][t/3][t%3]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nlong double dp[15][3][3]={};\nint dx[4]={1,-1,0,0};\nint dy[4]={0,0,1,-1};\nint bx,by;\nint tx,ty;\n\nlong double rec(int rest,int x,int y){\n     //cout<<\"x:\"<<x<<\"y:\"<<y<<endl;\n     if(x<0||x>2||y<0||y>2)return 0;\n     if(dp[rest][x][y]>0)return dp[rest][x][y];\n\n     if(rest==0){\n\t  if(x==tx&&y==ty)return 1;\n\t  else return 0;\n     }\n     long double sum=0;\n     for(int i=0;i<4;i++){\n\t  if(((x+dx[i]==bx)&&(y+dy[i]==by))||x+dx[i]<0||x+dx[i]>2||y+dy[i]>2||y+dy[i]<0){\n\t       sum+=rec(rest-1,x,y);\n\t       }else{\n\t       sum+=rec(rest-1,x+dx[i],y+dy[i]);\n\t  }\n     }\n     sum=sum/4.0;\n     dp[rest][x][y]=sum;\n     return sum;\n}\nvoid topoint(char a,int &x,int &y){\n     int tmp=a-'A';\n     x=tmp/3;\n     y=tmp%3;\n     return;\n}\nint main(){\n     int N;\n     cout.precision(8);\n     cout.setf(ios::fixed);\n     while(cin>>N,N){\n\t  char s,t,b;\n\t  cin>>s>>t>>b;\n\t  int sx,sy;\n\t  topoint(s,sx,sy);\n\t  topoint(t,tx,ty);\n\t  topoint(b,bx,by);\n\t  //cout<<sx<<\":\"<<sy<<\" \"<<tx<<\":\"<<ty<<endl;\n\t  cout<<rec(N,sx,sy)<<endl;\n\t  for(int i=0;i<15;i++){\n\t       for(int j=0;j<3;j++){\n\t\t    for(int k=0;k<3;k++){\n\t\t\t dp[i][j][k]=0;\n\t\t    }\n\t       }\n\t  }\n\t\t   \n     }\n     return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cctype>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iomanip>\n#include <iostream>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 30;\n\ntypedef vector<double> vec;\ntypedef vector<vec> mat; \n\nmat mul(mat &A,mat &B){\n\tmat C( A.size(),vec(B[0].size() ));\n\tfor(int i=0;i<A.size();i++)\n\t\tfor(int k=0;k<B.size();k++)\n\t\t\tfor(int j=0;j<B[0].size();j++)\n\t\t\t\tC[i][j]=(C[i][j]+A[i][k]*B[k][j])/*%M*/;\n\treturn C;\n}\n\nmat pow(mat A,ll n){\n\tmat B(A.size(),vec(A[0].size()));\n\tfor(int i=0;i<A.size();i++)\n\t\tB[i][i]=1;\n\twhile(n>0){\n\t\tif(n&1) B=mul(B,A);\n\t\tA=mul(A,A);\n\t\tn >>=1;\n\t}\n\treturn B;\n}\n\nint main(void){\n\tint n;\n\twhile(cin >> n,n){\n\t\tchar s,t,b;\n\t\tcin >> s >> t >> b;\n\t\ts-='A';t-='A';b-='A';\n\t\tmat A(9,vec(9));\n\t\tmat x(9,vec(1));\n\n\t\trep(i,9){\n\t\t\trep(j,9) A[i][j]=0.0;\n\t\t\tint d[4]={-3,-1,1,3};\n\t\t\tint tmp=0;\n\t\t\trep(j,4){\n\t\t\t\tif(0<=i+d[j]&&i+d[j]<9&&i+d[j]!=b)\n\t\t\t\t\tA[i][i+d[j]]=0.25;\n\t\t\t\telse\n\t\t\t\t\ttmp++;\n\t\t\t}\n\t\t\tA[i][i]=0.25*tmp;\n\t\t}\n\t\trep(i,9) x[i][0]=(i==s?1.0:0.0);\n\n\t\tA=pow(A,n);\n\t\tx=mul(A,x);\n\t\tcout << x[t][0] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nbool inField(int x,int y){\n    return (0 <= x && x < 3 && 0 <= y && y < 3);\n}\n\nint main(){\n    int n;\n    while(cin >> n, n){\n        char s,t,b;\n        double dp[20][20] = {{0}};\n        int dx[] = {-1,0,1,0};\n        int dy[] = {0,-1,0,1};\n        cin >> s >> t >> b;\n        int S = s-'A',T = t-'A',B = b-'A';\n        dp[n][S] = 1;\n        for(int i = n ; i > 0 ; i--){\n            for(int j = 0 ; j < 9 ; j++){\n                int x = j%3, y = j/3;\n                for(int k = 0 ; k < 4 ; k++){\n                    int nx = x + dx[k],ny = y + dy[k];\n                    int nj = ny*3+nx;\n                    if(!inField(nx,ny) || nj == B){\n                        dp[i-1][j] += dp[i][j]/4;\n                    }else{\n                        dp[i-1][nj] += dp[i][j]/4;\n                    }\n                }\n            }\n        }\n        printf(\"%.12f\\n\",dp[0][T]);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n\n#define rep(i,n) for(int (i)=0;(i)<n;(i)++)\n#define ck(a) (0<=(a)&&(a)<=9)\n\nint di[]={-3, -1, 1, 3};\n\nint main() {\n  using namespace std;\n  \n  int n, s, t, b; char cs, ct, cb;\n  while(cin>>n,n) {\n    cin >> cs >> ct >> cb;\n    s = cs-'A'; t = ct-'A'; b = cb-'A';\n    // 確率漸化式（添字は場所に対応。漸化式はqを用いることによって更新される）\n    double p[9]={0}; p[s]=1;\n\n    while(n--) {\n      double q[9]={0};\n      rep(i,9)rep(d,4) {\n\tif(ck(i+di[d])&&!(i%3==0&&di[d]==-1)&&!(i%3==2&&di[d]==1)&&i+di[d]!=b)\n\t  q[i+di[d]]+=p[i]/4;\n\telse q[i]+=p[i]/4;\n      }\n      rep(i,9)p[i]=q[i]; // 最新データに更新\n    }\n    printf(\"%.8f\\n\", p[t]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//49\n#include<iostream>\n#include<iomanip>\n\nusing namespace std;\n\nint tx,ty,bx,by;\n\n#define tox(c) (((c)-'A')%3)\n#define toy(c) (((c)-'A')/3)\n\n/*\nint tox(char c){\n  return (c-'A')%3;\n}\n\nint toy(char c){\n  return (c-'A')/3;\n}\n*/\n\ndouble cal(int r,int y,int x,double p){\n  if(y==by && x==bx){\n    return 0;\n  }else if(r==0){\n    return (y==ty && x==tx)?p:0;\n  }else{\n    double a=0;\n    for(int i=0;i<5;i++){\n      int d[]={0,1,0,-1,0};\n      int nx=x+d[i];\n      int ny=y+d[i+1];\n      if(0<=nx&&nx<3&&0<=ny&&ny<3){\n\ta+=cal(r-1,ny,nx,p/4);\n      }\n    }\n    return a;\n  }\n}\n\nint main(){\n  for(int n;cin>>n,n;){\n    char s,t,b;\n    cin>>s>>t>>b;\n    tx=tox(t);\n    ty=toy(t);\n    bx=tox(b);\n    by=toy(b);\n    cout<<fixed<<setprecision(6)<<cal(n,toy(s),tox(s),1)<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\n\nint room[3][3];\nint ok;\nint all;\n\nvoid rec(int x, int y, int but) {\n  static int d[4][2] = {{1,0},{0,1},{-1,0},{0,-1}};\n  if(but == 0) {\n    if(room[y][x] == 1) ok++;\n    all++;\n    return;\n  }\n  for(int i = 0; i < 4; i++) {\n    int nx = x + d[i][0];\n    int ny = y + d[i][1];\n    if(nx < 0 || nx >= 3) rec(x, y, but-1);\n    else if(ny < 0 || nx >= 3) rec(x, y, but-1);\n    else if(room[ny][nx] == 2) rec(x, y, but-1);\n    else rec(nx, ny, but-1);\n  }\n}\n\nint main() {\n  while(1) {\n    fill(&room[0][0], &room[2][2]+1, 0);\n    int n;\n    cin >> n;\n    if(n == 0) break;\n\n    char s, t, b;\n    cin >> s >> t >> b;\n    int temp = (int)s-(int)'A';\n    int sx = temp%3;\n    int sy = temp/3;\n    temp = (int)t-(int)'A';\n    room[temp/3][temp%3] = 1;\n    temp = (int)b-(int)'A';\n    room[temp/3][temp%3] = 2;\n\n    ok = all = 0;\n    rec(sx, sy, n);\n\n    printf(\"%.8f\\n\", (double)ok/all);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\nusing namespace std;\n\nint y11(int);\nint x11(int);\n\n    int main(){\n\n\tint n;\n\tchar st,ba,sto;\n\tdouble dx[] = {0.0,1.0,0.0,-1.0};\n\tdouble dy[] = {1.0,0.0,-1.0,0.0};\n\tint ma[3][3] = {{0,0,0},\n                       {0,0,0},\n                       {0,0,0}};\n\n\twhile(true){\n\t  cin >> n;\n\t   long double dp[15][4][4];\n\t    for(int i=0;i<15;i++)for(int j=0;j<4;j++)for(int k=0;k<4;k++)dp[i][j][k]=0.0;\n\t    if(n == 0)break;\n\t    cin >> st;\n\t    cin >> ba;\n\t    cin >> sto;\n\t    ma[y11(st)][x11(st)]=4;//X^[g\n\t    ma[y11(ba)][x11(ba)]=9;//[d\n\t    ma[y11(sto)][x11(sto)]=8;//qÉ\n\n\t    int nx,ny;\n\t    dp[n][y11(st)][x11(st)]=1.0;\n\t   \n\n\t    while(true){\n\t\tif(n ==  0)break;\n\t\n\t\t/*\t\t\n\t\tcout << \"n = \" << n << endl;\n\t\tfor(int g=0;g<3;g++){\n\t\t  for(int f=0;f<3;f++){\n\t\t    cout << dp[n][g][f] << \" \";\n\t\t  }\n\t\t  cout << endl;\n\t\t} \n\t\tcout << endl;\n*/\n\n\t\tfor(int t=0;t<=2;t++){\n\t\t    for(int g =0 ;g<=2;g++){\n\t\t\tfor(int i=0;i<4;i++){\n\t\t\t    nx = g+dx[i];\n\t\t\t    ny = t+dy[i];\t\t    \n\t\t\t    if(nx>2 || ny>2 ||nx<0 || ny<0){nx = g; ny =t;}\n\t\t\t    if(nx == x11(sto) && ny == y11(sto)){nx = g;\n\t\t\t\tny = t;\n\t\t\t    }\n\t\t\t    dp[n-1][ny][nx] += dp[n][t][g]/4.0;\t\t    \n\t\t\t}\n\t\t    }\n\t\t}\n\t\tn--;\n\n\t    }\n \n\t    // ----------------DEBUG--------------//\n\t    \n\n\t    /*\n\t\tfor(int g=0;g<3;g++){\n\t\t    for(int f=0;f<3;f++){\n\t\t    cout << dp[0][g][f] << \" \";\n\t\t    }\n\t\t    cout << endl;\n\t\t} \n\t    */\n\t\t\n\t    //----------------DEBUG---------------//\n\t    //   DecimalFormat dc = new DecimalFormat();\n\t \n\t    printf(\"%.8Lf\\n\",dp[0][y11(ba)][x11(ba)]);\n\n\n\t      }\n\n\n    }\n\n    \n\n    int y11(int s){\n      if(s == 'A')return 0;\n\tif(s == 'B')return 0;\n\tif(s=='C')return 0;\n\tif(s=='D')return 1;\n\tif(s=='E')return 1;\n\tif(s=='F')return 1;\n\tif(s=='G')return 2;\n\tif(s=='H')return 2;\n\tif(s =='I')return 2;\n\treturn 0;\n\t\n    }\n    int x11(int s){\n\tif(s=='A')return 0;\n\tif(s=='B')return 1;\n\tif(s=='C')return 2;\n\tif(s=='D')return 0;\n\tif(s=='E')return 1;\n\tif(s=='F')return 2;\n\tif(s=='G')return 0;\n\tif(s=='H')return 1;\n\tif(s=='I')return 2;\n\treturn 0;\n\n    }\n\n\n\n\n\n\n\n/*@Yê½Ì´êpðà\n\nQ:3d[vÌÆ±ÈÉµÄñÌH\nA:®SÌðÝÄ(n-i)ñ(i=0,1,EEE,n Å n=0Ìnñ®¢½Ê n=nÌ1ñ®¢½Ê)ÌÊð¾µÄé\nµ¢m¦Å®­©ç1ñ®¢½ç4ÅêÎ¢¢\n\nàµ±êæñÅàí©çÈ¢pÈçvOÌDEBUGð\\¦³¹Ä®«ðmFµÄÝéÆ¢¢\nn=0ÆÈÁÄ¢é©çwè³ê½ñ®¢½Êð\\¦·éæ¤ÉÈÁÄ¢é\n\n*/"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<algorithm>\n#include<array>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<functional>\n#include<limits>\n#include<list>\n#include<map>\n#include<numeric>\n#include<set>\n#include<stack>\n#include<string>\n#include<sstream>\n#include<unordered_map>\n#include<queue>\n#include<vector>\nusing namespace std;\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing pii = pair<int, int>;\n\n#define rep(i,a,b) for(int i=(a);i<(b);i++)\n#define rrep(i,a,b) for(int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n#define dump(o) {cerr<<#o<<\" \"<<o<<endl;}\n#define dumpc(o) {cerr<<#o; for(auto &e:(o))cerr<<\" \"<<e;cerr<<endl;}\n#define INF 0x3f3f3f3f\n#define INFL 0x3f3f3f3f3f3f3f3fLL\nconst int MOD = 1e9 + 7;\n\nint di[4] = { 1,0,-1,0 };\nint dj[4] = { 0,1,0,-1 };\n\nsigned main() {\n\tcout << fixed << setprecision(8);\n\tfor (int n; cin >> n&&n;) {\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tdouble f[3][3] = {};\n\t\tdouble g[3][3] = {};\n\t\tpii S, T, B;\n\t\tS = pii((s - 'A') / 3, (s - 'A') % 3);\n\t\tT = pii((t - 'A') / 3, (t - 'A') % 3);\n\t\tB = pii((b - 'A') / 3, (b - 'A') % 3);\n\t\tf[S.first][S.second] = 1;\n\t\twhile (n--) {\n\t\t\trep(i, 0, 3)rep(j, 0, 3)g[i][j] = 0;\n\t\t\tswap(f, g);\n\t\t\trep(a, 0, 3) rep(b, 0, 3) {\n\t\t\t\tint cnt = 0;\n\t\t\t\trep(i, 0, 4) {\n\t\t\t\t\t//if (a + di[i] == B.first&&b + dj[i] == B.second) continue;\n\t\t\t\t\t//if (0 > a + di[i] && a + di[i] > 2)continue;\n\t\t\t\t\t//if (0 > b + dj[i] && b + dj[i] > 2)continue;\n\t\t\t\t\t//f[a + di[i]][b + dj[i]] += g[a][b] / 4;\n\t\t\t\t\tcnt++;\n\t\t\t\t}\n\t\t\t\tf[a][b] += (g[a][b] / 4)*(4 - cnt);\n\t\t\t}\n\t\t}\n\t\tcout << f[T.first][T.second] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<n;i++)\nconst int dx[] ={0,1,0,-1};\nconst int dy[] ={-1,0,1,0};\n\nint main(){\n\tint n;\n\twhile(cin >> n , n){\n\t\tlong double dp[16][5][5] = {{{0.0}}};\n\t\tchar map[5][5];\n\t\trep(i,5)rep(j,5)map[i][j] = 'X';\n\t\trep(i,3)rep(j,3)map[i+1][j+1] = ' ';\n\t\tint sx, sy , gx, gy ,bx , by;\n\t\tchar s,t,b;\n\t\tcin >> s >> t >> b ;\n\t\tsy = (s-'A')/3 +1 ,sx = (s-'A')%3 +1;\n\t\tgy = (t-'A')/3 +1 ,gx = (t-'A')%3 +1;\n\t\tby = (b-'A')/3 +1 ,bx = (b-'A')%3 +1;\n\t\tmap[by][bx] = 'X';\n\t\t\n\t\tdp[n][sy][sx] = 1.0;\n\t\t\n\t\twhile(n){\n\t\t\tfor(int y=1;y<=3;y++){\n\t\t\t\tfor(int x=1;x<=3;x++){\n\t\t\t\t\trep(i,4){\n\t\t\t\t\t\tint tx = x+dx[i], ty = y+dy[i] ;\n\t\t\t\t\t\tif(map[ty][tx] == 'X')continue;\n\t\t\t\t\t\tdp[n-1][ty][tx] += dp[n][y][x] / 4.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tn--;\n\t\t}\n\t\tprintf(\"%.10Lf\\n\",dp[0][gy][gx]);\n\t}\n}\n\t"
  },
  {
    "language": "C++",
    "code": "// AOJ 1020\n#include<iostream>\n#include<iomanip>\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\nusing namespace std;\n\ntypedef long double number;\nint n;\nint sx, sy, tx, ty, bx, by;\nnumber room[3][3];\n\nvoid init() {\n  REP(x, 3) REP(y, 3) {\n    room[x][y] = 0;\n  }\n  room[sx][sy] = 1;\n}\n\nbool is_depot(int x, int y) {\n  return x == bx && y == by;\n}\n\nnumber in(int x, int y) {\n  if (x < 0 or 2 < x or y < 0 or 2 < y) return 0;\n  if (is_depot(x, y)) return 0;\n  return room[x][y];\n}\n\nbool legal(int x, int y) {\n  if (x < 0 or 2 < x or y < 0 or 2 < y) return false;\n  return not is_depot(x, y);\n}\n\nnumber solve() {\n  init();\n  REP(i, n) {\n    number future[3][3];\n    REP(x, 3) REP(y,3) {\n      future[x][y] = 0;\n    }\n    \n    REP(x, 3) REP(y,3) {\n      if (is_depot(x, y)) continue;\n      number prob = room[x][y] / 4;\n      if (legal(x + 1, y)) { future[x + 1][y] += prob; } \n      else { future[x][y] += prob; }\n      \n      if (legal(x - 1, y)) { future[x - 1][y] += prob; } \n      else { future[x][y] += prob; }\n      \n      if (legal(x, y + 1)) { future[x][y + 1] += prob; } \n      else { future[x][y] += prob; }\n      \n      if (legal(x, y - 1)) { future[x][y - 1] += prob; } \n      else { future[x][y] += prob; }\n    }\n    \n    REP(y, 3) { REP(x, 3) {\n        room[x][y] = future[x][y];\n    }}\n  }\n  return room[tx][ty];\n}\n\nint room2x(char r) {\n  switch (r) {\n    case 'A': case 'D': case 'G':\n      return 0; break;\n    case 'B': case 'E': case 'H':\n      return 1; break;\n    case 'C': case 'F': case 'I':\n      return 2; break;\n    default:\n      break;\n  }\n}\n\nint room2y(char r) {\n  switch (r) {\n    case 'A': case 'B': case 'C':\n      return 0; break;\n    case 'D': case 'E': case 'F':\n      return 1; break;\n    case 'G': case 'H': case 'I':\n      return 2; break;\n    default:\n      break;\n  }\n}\n\nint main() {\n  while (cin >> n and n) {\n    char s, t, b;\n    cin >> s >> t >> b;\n    sx = room2x(s); sy = room2y(s);\n    tx = room2x(t); ty = room2y(t);\n    bx = room2x(b); by = room2y(b);\n\n    cout << fixed << setprecision(10) << solve() << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <queue>\n\nusing namespace std;\nstatic const int MV = 100;\ntypedef pair<int, int> T;\n\nint main() {\n  while(1) {\n    int w, h, Gcount=0, sum=0;\n    cin >> w >> h;\n    if (w ==0 && h == 0) break;\n    char M[h][w];\n    int A[h][w];\n    queue<T> Q;\n    \n    for (int i=0;i<h;i++) {\n      for (int j=0;j<w;j++) {\n\tcin >> M[i][j];\n\tA[i][j]=MV;\n\tif (M[i][j] == '*')\n\t  Gcount++;\n\tif (M[i][j] == 'o'){\n\t  Q.push(make_pair(i, j));\n\t  A[i][j]=0;\n\t}\n      }\n    }\n    /*\n      for (int i=0;i<h;i++) {\n      for (int j=0;j<w;j++) {\n      cout << A[i][j];\n      }cout << endl;\n      }\n    */\n    while(Gcount != 0 || Q.empty()) {\n      if(Q.empty()) break;//cout << -1<< endl;\n      int Dy[4]={1, 0, -1, 0}, Dx[4]={0, 1, 0, -1}, ny, nx;\n      M[Q.front().first][Q.front().second]='+';\n      for (int i=0;i<4;i++) {\n\tny = Q.front().first + Dy[i]; nx = Q.front().second + Dx[i];\n\t//      cout << endl << ny << \"    \" << nx << endl;\n\tif (M[ny][nx] == '.' && 0<=nx && nx<w && 0<=ny && ny<h) {\n\t  Q.push(make_pair(ny, nx));\n\t  //\tcout << endl << \"         \" << ny << \"   \" << nx << endl;\n\t  M[ny][nx]='+';\n\t  A[ny][nx]=A[Q.front().first][Q.front().second] + 1;\n\t}\n\tif (M[ny][nx] == '*' && 0<=nx && nx<w && 0<=ny && ny<h) {\n\t  Gcount--;\n\t  M[ny][nx]='+';\n\t  sum+=A[Q.front().first][Q.front().second] + 1;\n\t  //\tcout << endl << sum << endl;\n\t  for (int j=0;j<h;j++) {\n\t    for (int k=0;k<w;k++) {\n\t      A[j][k]=MV;\n\t      if (M[j][k] == '+') {\n\t\tM[j][k] = '.';\n\t      }\n\t    }\n\t  }\n\t  int q=Q.size();\n\t  for (int j=1;j<q;j++) {\n\t    //while(!Q.empty()) {\n\t    Q.pop();\n\t  }\n\t  Q.push(make_pair(ny, nx));\n\t  A[ny][nx] = 0;\n\t  i=4;\n\t}\n      }\n      /*    \n\t    for (int i=0;i<h;i++) {\n\t    for (int j=0;j<w;j++) {\n\t    cout << A[i][j] << \"      \";\n\t    }cout << endl;\n\t    }\n\t    cout << endl;\n      */\n      \n      Q.pop();\n    }\n    if(sum == 0) cout << -1 << endl;\n    else cout << sum << endl;\n  }\n}\n\n  /*\n  while(!Q.empty() || a) {\n    for(int i=0; i<4; i++) {\n      int nx = Q.front().first + dx[i], ny = Q.front().second + dy[i];\n      if(A[nx][ny]!='x' && 0<=nx && nx<w && 0<=ny && ny<h) {\n\tQ.push(make_pair(nx, ny));\n\tA[nx][ny]='+';\n\tA[nx][ny]=AA[Q.front().first][Q.front().second]+1;\n\tfor (int aa=0;aa<h;aa++){\n\t  for (int bb=0;bb<w;bb++){\n\t    cout << AA[aa][bb];\n\t  }cout << endl;\n\t}\n\t}\n\n      if(A[nx][ny]=='*') {\n      \ta=false;\n      }\n    }\n    Q.pop();\n  }\n  */"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#define BAT 1\n#define SOU 2\nusing namespace std;\n\nint main(){\n  int n, sum;\n  char s,t,b;\n  int mem[20][9];\n\n  while( cin>>n && n ){\n    cin >> s>>t>>b;\n    int souko = b-'A';\n    int goal= t-'A';\n    \n    for( int i=0;i<=n;i++ )\n      for( int j=0;j<9;j++ )\n\tmem[i][j] = 0;\n\n    mem[0][ s-'A' ]=1;\n    for( int i=0;i<n;i++ ){\n      for( int j=0;j<9;j++ ){\t\n\tif( mem[i][j]==0 ) continue;\n\tint k=i+1;\n\t// up\n\tif( j<3 || j-3==souko )  mem[k][j]  +=mem[i][j];\n\telse                     mem[k][j-3]+=mem[i][j];\n\t// right\n\tif( j%3==2 || j+1==souko )  mem[k][j] +=mem[i][j];\n\telse                        mem[k][j+1]+=mem[i][j];\n\t// down\n\tif( j>5 || j+3==souko )  mem[k][j] += mem[i][j];\n\telse                     mem[k][j+3] +=mem[i][j];\n\t// left\n\tif( j%3==0 || j-1==souko )  mem[k][j] += mem[i][j];\n\telse                        mem[k][j-1]+=mem[i][j];\n      }\n    }\n    /*\n    for( int i=0;i<=n;i++ ){\n      cout << \"n=\"<<i << \"|\"<<endl ;\n      for( int j=0;j<9;j++ ){\n\tcout << \" \"<<mem[i][j];\n\tif( j%3==2 ) cout << endl;\n      }\n      cout << endl;\n    }\n    */\n    sum=0;\n    for( int i=0;i<9;i++ )\n      sum += mem[n][i];\n    /*\n    cout << \"souko==\" << souko << \" goal=\"<<goal<<endl;\n    cout << \"dev \" << mem[n][goal] << \"/\"<<sum <<endl;\n    */\n    printf(\"%lf\\n\",(double)mem[n][goal]/sum );\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<cstdio>\n#include<sstream>\n#define loop(i,a,b) for(int i=a;i<b;i++)\n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define mp make_pair\n#define all(in) in.begin(),in.end()\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef vector<ll> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef pair<int,pii> pip;\ntypedef vector<pip>vip;\nconst double PI=acos(-1);\nconst double EPS=1e-8;\nconst int inf=1e8;\nint main(){\n  int n;\n  while(cin>>n,n){\n    vvi dp(3,vi(3));\n    char a,b,c;\n    cin>>a>>b>>c;\n    a-='A';b-='A';c-='A';\n    dp[a/3][a%3]=1;\n    //    dp[c/3][c%3]=-1;\n    int dx[]={0,0,1,-1};\n    int dy[]={1,-1,0,0};\n    rep(q,n){\n      vvi nd(3,vi(3));\n      rep(i,3)rep(j,3)rep(k,4){\n\tint x=i+dx[k];\n\tint y=j+dy[k];\n\tif(x<0||y<0||x>=3||y>=3||c/3==x&&c%3==y)\n\t  x-=dx[k],y-=dy[k];\n\tnd[x][y]+=dp[i][j];\n      }\n      dp=nd;\n    }\n    double out=dp[b/3][b%3];\n    printf(\"%.9f\\n\",out/pow(4,n));\n  }  \n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int dx[] = {-1, 0, 0, 1};\nconst int dy[] = { 0,-1, 1, 0};\n\nint sx, sy, gx, gy, n;\ndouble P[3][3];\n\nbool check(int x, int y){\n  return 0 <= x && x < 3 && 0 <= y && y < 3;\n}\n\nvoid solve(){\n  P[sy][sx] = 1;\n\n  queue<int> qx, qy, rem;\n  qx.push(sx), qy.push(sy), rem.push(n);\n\n  while(!qx.empty()){\n    int x = qx.front(); qx.pop();\n    int y = qy.front(); qy.pop();\n    int r = rem.front(); rem.pop();\n\n    if(x == gx && y == gy || r == 0) break;\n\n    for(int i = 0 ; i < 4 ; i++){\n      int nx = x + dx[i];\n      int ny = y + dy[i];\n\n      if(!check(nx, ny)) continue;\n      P[ny][nx] = P[y][x] / 4;\n      qx.push(nx), qy.push(ny), rem.push(r-1);\n    }\n  }\n\n  printf(\"%.6f\\n\",P[gy][gx]);\n}\n\nint main(){\n  char s, t, b;\n  \n  while(cin >> n, n){\n    memset(P, 0, sizeof(P));\n\n    cin >> s >> t >> b;\n    int ss = s - 'A', tt = t - 'A', bb = b - 'A';\n    P[bb/3][bb%3] = -1;\n    sx = ss%3; sy = ss/3;\n    gx = tt%3; gy = tt/3;\n    solve();\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#include<iostream>\n#include<string.h>\n#include<math.h>\n#include<algorithm>\n#include<cstring>\n#include<queue>\nusing namespace std;\n#define INF 100000000\nint s,t,b,n;\ndouble p,nn;\nint d[4]={1,3,-1,-3};\nint max(int a,int b){\n\tif(a>b){\n\t\treturn a;\n\t}else{\n\t\treturn b;\n\t}\n}\nvoid dfs(int s,int n){\n\tif(n==0){\n\t\tif(s==t)p+=pow(0.25,nn);\n\t\treturn;\n\t}\n\tfor(int i=0;i<4;i++){\n\t\tif(s+d[i]==b){\n\t\t\tdfs(s,n-1);\n\t\t}else if(s/3!=(s+d[i])/3){//3で割った値に注目するのがポイント\n\t\t\tif(d[i]*d[i]==9&&0<=s+d[i]&&s+d[i]<9){\n\t\t\t\tdfs(s+d[i],n-1);\n\t\t\t}else{\n\t\t\t\tdfs(s,n-1);\n\t\t\t}\n\t\t}else{\n\t\t\tdfs(s+d[i],n-1);\n\t\t}\n\t}\n\treturn;\n}\nint main(){\n\twhile(1){\n\t\tchar cs,ct,cb;\n\t\tp=0;\n\t\tcin>>n;\n\t\tnn=n;\n\t\tif(n==0)break;\n\t\tcin>>cs>>ct>>cb;\n\t\ts=(int)cs-'A';\n\t\tt=(int)ct-'A';\n\t\tb=(int)cb-'A';\n\t\tdfs(s,n);\n\t\tcout<<p<<endl;\n\t}\n\treturn 0;\n}\t"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef pair<int,int> P;\n\nint main() {\n    int N;\n    while (cin >> N, N) {\n        char s, t, b;\n        cin >> s >> t >> b;\n\n        int sx, sy;\n        sx = (s - 'A') / 3;\n        sy = (s - 'A') % 3;\n        int tx, ty;\n        tx = (t - 'A') / 3;\n        ty = (t - 'A') % 3;\n        int bx, by;\n        bx = (b - 'A') / 3;\n        by = (b - 'A') % 3;\n        vector<vector<vector<int> > > dp(N+1, vector<vector<int> >(3, vector<int>(3, 0)));\n        dp[0][sx][sy] = 1;\n        int dx[] = {1,0,-1,0};\n        int dy[] = {0,1,0,-1};\n        for (int i = 0; i < N; i++) {\n            for (int x = 0; x < 3; x++) {\n                for (int y = 0; y < 3; y++) {\n                    if (!dp[i][x][y]) continue;\n                    if (x == tx && y == ty) continue;\n                    if (x == bx && y == by) continue;\n                    for (int j = 0; j < 4; j++) {\n                        int nx = x + dx[j];\n                        int ny = y + dy[j];\n                        if (0 <= nx && nx < 3 && 0 <= ny && ny < 3) {\n                            dp[i+1][nx][ny] += dp[i][x][y];\n                        }\n                    }\n                }\n            }\n        }\n\n        double ans = 0.;\n        double p = 1. / 4.;\n        for (int i = 1; i <= N; i++) {\n            ans += p * dp[i][tx][ty];\n            p /= 4.;\n        }\n        printf(\"%0.9f\\n\", ans);\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<algorithm>\n#include<array>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<functional>\n#include<limits>\n#include<list>\n#include<map>\n#include<numeric>\n#include<set>\n#include<stack>\n#include<string>\n#include<sstream>\n#include<unordered_map>\n#include<queue>\n#include<vector>\nusing namespace std;\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing pii = pair<int, int>;\n\n#define rep(i,a,b) for(int i=(a);i<(b);i++)\n#define rrep(i,a,b) for(int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n#define dump(o) {cerr<<#o<<\" \"<<o<<endl;}\n#define dumpc(o) {cerr<<#o; for(auto &e:(o))cerr<<\" \"<<e;cerr<<endl;}\n#define INF 0x3f3f3f3f\n#define INFL 0x3f3f3f3f3f3f3f3fLL\nconst int MOD = 1e9 + 7;\n\nint di[4] = { 1,0,-1,0 };\nint dj[4] = { 0,1,0,-1 };\n\nsigned main() {\n\tcout << fixed << setprecision(8);\n\tfor (int n; cin >> n&&n;) {\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tdouble f[3][3] = {};\n\t\tdouble g[3][3] = {};\n\t\tpii S, T, B;\n\t\tS = pii((s - 'A') / 3, (s - 'A') % 3);\n\t\tT = pii((t - 'A') / 3, (t - 'A') % 3);\n\t\tB = pii((b - 'A') / 3, (b - 'A') % 3);\n\t\tf[S.first][S.second] = 1;\n\t\twhile (n--) {\n\t\t\trep(i, 0, 3)rep(j, 0, 3)g[i][j] = 0;\n\t\t\tswap(f, g);\n\t\t\trep(a, 0, 3) rep(b, 0, 3) {\n\t\t\t\tint cnt = 0;\n\t\t\t\trep(i, 0, 4) {\n\t\t\t\t\tif (a + di[i] == B.first&&b + dj[i] == B.second) continue;\n\t\t\t\t\tif (0 > a + di[i] && a + di[i] > 2)continue;\n\t\t\t\t\tif (0 > b + dj[i] && b + dj[i] > 2)continue;\n\t\t\t\t\tf[a + di[i]][b + dj[i]] += g[a][b] / 4;\n\t\t\t\t\tcnt++;\n\t\t\t\t}\n\t\t\t\tf[a][b] += (g[a][b] / 4)*(4 - cnt);\n\t\t\t}\n\t\t}\n\t\tcout << f[T.first][T.second] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <cstring>\n#include <cmath>\n#include <complex>\n#include <map>\n#include <climits>\n#include <sstream>\nusing namespace std;\n\n#define reep(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n) reep((i),0,(n))\n#define ALL(v) (v).begin(),(v).end()\n#define PB push_back\n#define EPS 1e-8\n#define F first\n#define S second\n#define mkp make_pair\n\nstatic const double PI=6*asin(0.5);\ntypedef long long ll;\ntypedef complex<double> CP;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vint;\nstatic const int INF=1<<24;\n\ntemplate <class T>\nvoid initvv(vector<vector<T> > &v,int a,int b, const T  &t = T()){\n\tv.assign(a,vector<T>(b,t));\n}\n\n//v.erase(unique(v.begin(),v.end()),v.end());\n\n\nint main(){\n\tint n;\n\t// map<char,ll> ma;\n\tint dx[]={0,0,1,-1};\n\tint dy[]={1,-1,0,0};\n\tint aa[][4]={\n\t\t{0,0,1,3},\n\t\t{0,1,2,4},\n\t\t{1,2,2,5},\n\t\t{0,3,4,6},\n\t\t{1,3,5,7},\n\t\t{2,4,5,8},\n\t\t{3,6,6,7},\n\t\t{4,6,7,8},\n\t\t{5,7,8,8}\n\t};\n\twhile(cin>>n,n){\n\t\tvector<ll> aaa(9,0);\n\t\tchar x,y,z;\n\t\tcin>>x>>y>>z;\n\t\tint d,e,f;\n\t\td=x-'A';\n\t\te=y-'A';\n\t\tf=z-'A';\n\t\taaa[d]++;\n\t\t\n\t\trep(i,n){\n\t\t\tvector<ll> tmp(9,0);\n\t\t\trep(k,9){\n\t\t\t\trep(j,4){\n\t\t\t\t\tif(aa[k][j]==f){\n\t\t\t\t\t\ttmp[k]+=aaa[k];\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\ttmp[aa[k][j]]+=aaa[k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\taaa=tmp;\n\n\t\t}\n\t\t\n\t\tlong double ans=4.0;\n\t\tans=pow(ans,n);\n\t\tans=aaa[e]/ans;\n\t\t// cout<<ans<<endl;\n\t\tprintf(\"%.8Lf\\n\",ans);\n\t}\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <algorithm>\n#include <bitset>\n#include <cassert>\n#include <cctype>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <deque>\n#include <iomanip>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <stack>\n#include <sstream>\n#include <string>\n#include <vector>\nusing namespace std;\n\n#define EPS 1e-9\n#define INF MOD\n#define MOD 1000000007LL\n#define fir first\n#define iss istringstream\n#define sst stringstream\n#define ite iterator\n#define ll long long\n#define mp make_pair\n#define rep(i,n) rep2(i,0,n)\n#define rep2(i,m,n) for(int i=m;i<n;i++)\n#define pi pair<int,int>\n#define pb push_back\n#define sec second\n#define sh(i) (1LL<<i)\n#define sz size()\n#define vi vector<int>\n#define vc vector\n#define vl vector<ll>\n#define vs vector<string>\n\nint n,dy[]={0,1,0,-1},dx[]={1,0,-1,0};\nchar s,b,j;\nmap<pair<int,char>,double> M;\n\nchar code(int y,int x){\n\treturn 'A'+y*3+x;\n}\n\npi dec(char c){\n\treturn pi((c-'A')/3,(c-'A')%3);\n}\n\ndouble f(int n,char c){\n\tif(n==0)return c==b;\n\tif(M.find(pi(n,c))!=M.end())return M[pi(n,c)];\n\tdouble& res=M[pi(n,c)]=0;\n\tpi p=dec(c);\n\tint y=p.fir,x=p.sec;\n\trep(i,4){\n\t\tint ny=y+dy[i],nx=x+dx[i];\n\t\tif(ny<0||2<ny||nx<0||2<nx||code(ny,nx)==j)res+=f(n-1,c)/4;\n\t\telse res+=f(n-1,code(ny,nx))/4;\n\t}\n\treturn res;\n}\n\nint main(){\n\twhile(cin>>n&&n){\n\t\tM.clear();\n\t\tcin>>s>>b>>j;\n\t\tcout<<f(n,s)<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n\nusing namespace std;\n\nint b_row,b_col,memo[16][3][3];\n\nchar b[2];\n\nbool rangeCheck(int row,int col){\n\tif(row >= 0 && row <= 2 && col >= 0 && col <= 2)return true;\n\telse{\n\t\treturn false;\n\t}\n}\n\nint translate(char ch){\n\tswitch(ch){\n\tcase 'A':return 0;\n\tcase 'B':return 1;\n\tcase 'C':return 2;\n\tcase 'D':return 10;\n\tcase 'E':return 11;\n\tcase 'F':return 12;\n\tcase 'G':return 20;\n\tcase 'H':return 21;\n\tcase 'I':return 22;\n\t}\n\n\treturn -1; //must not reach here.\n}\n\nint main(){\n\n\tint n,tmp,energy_row,energy_col,row,col;\n\tchar start[2],energy[2];\n\n\twhile(true){\n\t\tscanf(\"%d\",&n);\n\t\tif(n == 0)break;\n\n\t\tfor(int i = 0; i < 16; i++){\n\t\t\tfor(int p = 0; p < 3; p++){\n\t\t\t\tfor(int k = 0; k < 3; k++)memo[i][p][k] = 0;\n\t\t\t}\n\n\t\t}\n\n\t\tscanf(\"%s %s %s\",start,energy,b);\n\n\t\ttmp = translate(b[0]);\n\t\tb_row = tmp/10;\n\t\tb_col = tmp%10;\n\n\t\ttmp = translate(energy[0]);\n\t\tenergy_row = tmp/10;\n\t\tenergy_col = tmp%10;\n\n\t\ttmp = translate(start[0]);\n\n\t\trow = tmp/10,col = tmp%10;\n\n\t\tmemo[0][row][col] = 1;\n\n\t\tif(rangeCheck(row,col-1) == true && (row != b_row || col-1 != b_col)){\n\t\t\tmemo[1][row][col-1] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row,col+1) == true && (row != b_row || col+1 != b_col)){\n\t\t\tmemo[1][row][col+1] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row-1,col) == true && (row-1 != b_row || col != b_col)){\n\t\t\tmemo[1][row-1][col] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row+1,col) == true && (row+1 != b_row || col != b_col)){\n\t\t\tmemo[1][row+1][col] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tfor(int loop = 2; loop <= n; loop++){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tif(i == b_row && k == b_col){\n\t\t\t\t\t\tmemo[loop][i][k] = 0;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(i == 0 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][0][0] = memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][0][0] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][0][0] += memo[loop-1][1][0];\n\t\t\t\t\t\t}else if(i == 0 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][0][1] = memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 0)memo[loop][0][1] += memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][0][1] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 2)memo[loop][0][1] += memo[loop-1][0][2];\n\t\t\t\t\t\t}else if(i == 0 && k == 2){\n\t\t\t\t\t\t\tmemo[loop][0][2] = memo[loop-1][0][2];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][0][2] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][0][2] += memo[loop-1][1][2];\n\t\t\t\t\t\t}else if(i == 1 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][1][0] = memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 0)memo[loop][1][0] += memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][1][0] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 0)memo[loop][1][0] += memo[loop-1][2][0];\n\t\t\t\t\t\t}else if(i == 1 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][1][1] = memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][1][1] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][1][1] += memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][1][1] += memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][1][1] += memo[loop-1][2][1];\n\t\t\t\t\t\t}else if(i == 1 && k == 2){\n\t\t\t\t\t\t\tmemo[loop][1][2] = memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 2)memo[loop][1][2] += memo[loop-1][0][2];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][1][2] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 2)memo[loop][1][2] += memo[loop-1][2][2];\n\t\t\t\t\t\t}else if(i == 2 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][2][0] = memo[loop-1][2][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][2][0] += memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][2][0] += memo[loop-1][2][1];\n\t\t\t\t\t\t}else if(i == 2 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][2][1] = memo[loop-1][2][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 0)memo[loop][2][1] += memo[loop-1][2][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][2][1] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 2)memo[loop][2][1] += memo[loop-1][2][2];\n\t\t\t\t\t\t}else{ //i == 2 && k == 2\n\t\t\t\t\t\t\tmemo[loop][2][2] = memo[loop-1][2][2];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][2][2] += memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][2][2] += memo[loop-1][2][1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\",((double)memo[n][energy_row][energy_col])/((double)pow(4,n)));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//49\n#include<iostream>\n#include<iomanip>\n#include<cstring>\n\nusing namespace std;\n\n#define tox(c) (((c)-'A')%3)\n#define toy(c) (((c)-'A')/3)\n\nint main(){\n  for(int n;cin>>n,n;){\n    char s,t,b;\n    double p[3][3]={};\n    cin>>s>>t>>b;\n    p[toy(s)][tox(s)]=1;\n    while(n--){\n      double pt[3][3]={};\n      for(int y=0;y<3;y++){\n\tfor(int x=0;x<3;x++){\n\t  int d[]={0,1,0,-1,0};\n\t  for(int i=0;i<4;i++){\n\t    int ny=y+d[i];\n\t    int nx=x+d[i+1];\n\t    if(0<=ny&&ny<3&&0<=nx&&nx<3&&!(ny==toy(b)&&nx==tox(b))){\n\t      pt[ny][nx]+=p[y][x]/4;\n\t    }else{\n\t      pt[y][x]+=p[y][x]/4;\n\t    }\n\t  }\n\t}\n      }\n      memcpy(p,pt,sizeof(p));\n    }\n    cout<<fixed<<setprecision(6)<<p[toy(t)][tox(t)]<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int dx[] = {-1, 0, 0, 1};\nconst int dy[] = { 0,-1, 1, 0};\n\nint sx, sy, gx, gy, n, bx, by;\ndouble P[3][3];\n\nbool check(int x, int y){\n  return 0 <= x && x < 3 && 0 <= y && y < 3;\n}\n\nvoid solve(){\n  P[sy][sx] = 1;\n\n  queue<int> qx, qy, rem;\n  qx.push(sx), qy.push(sy), rem.push(n);\n\n  while(!qx.empty()){\n    int x = qx.front(); qx.pop();\n    int y = qy.front(); qy.pop();\n    int r = rem.front(); rem.pop();\n\n    if(x == gx && y == gy && r == 0) break;\n    if(r == 0) continue;\n\n    for(int i = 0 ; i < 4 ; i++){\n      int nx = x + dx[i];\n      int ny = y + dy[i];\n\n      if(!check(nx, ny) || (nx == bx && ny == by)){\n        qx.push(nx), qy.push(ny), rem.push(r-1);\n      }else{\n        P[ny][nx] += P[y][x] / 4;\n        qx.push(nx), qy.push(ny), rem.push(r-1);\n      }\n    }\n  }\n\n  printf(\"%.8f\\n\",P[gy][gx]);\n}\n\nint main(){\n  char s, t, b;\n  \n  while(cin >> n, n){\n    memset(P, 0, sizeof(P));\n\n    cin >> s >> t >> b;\n    int ss = s - 'A', tt = t - 'A', bb = b - 'A';\n    sx = ss%3; sy = ss/3;\n    gx = tt%3; gy = tt/3;\n    bx = bb%3; by = bb/3;\n    solve();\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<map>\n#include<string.h>\nusing namespace std;\n\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\n\nint main()\n{\n\tmap<char,pair<int,int> > M;\n\tM['A']=make_pair(0,0);\n\tM['B']=make_pair(1,0);\n\tM['C']=make_pair(2,0);\n\tM['D']=make_pair(0,1);\n\tM['E']=make_pair(1,1);\n\tM['F']=make_pair(2,1);\n\tM['G']=make_pair(0,2);\n\tM['H']=make_pair(1,2);\n\tM['I']=make_pair(2,2);\n\n\tint n;\n\twhile(cin>>n &&n!=0){\n\t\tchar s,t,b;\n\t\tcin>>s>>t>>b;\n\t\tpair<int,int> now=M[s];\n\t\tpair<int,int> goal=M[t];\n\t\tpair<int,int> not=M[b];\n\n\t\tdouble ans[17][3][3];\n\n\t\tfor(int i=0;i<16;i++)\n\t\t\tfor(int x=0;x<3;x++)\n\t\t\t\tfor(int y=0;y<3;y++)\n\t\t\t\t\tans[i][y][x]=0.0;\n\n\t\tcout<<now.first<<\" \"<<now.second<<endl;\n\t\tans[0][now.second][now.first]=1.0;\n\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int x=0;x<3;x++){\n\t\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\t\tfor(int r=0;r<4;r++){\n\t\t\t\t\t\tint nx=x+dx[r],ny=y+dy[r];\n\t\t\t\t\t\tif(nx<0 || nx>=3 || ny<0 || ny>=3 || make_pair(nx,ny)==not){\n\t\t\t\t\t\t\tans[i+1][y][x]+=ans[i][y][x]/4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tans[i+1][ny][nx]+=ans[i][y][x]/4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout<<ans[n][goal.second][goal.first]<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <map>\n#include <cstdio>\n#include <iomanip>\n\nusing namespace std;\n\nconst double EPS = 1e-8;\n\nint n;\npair<int, int> s, t, b;\ndouble dp[16][3][3];\nint dy[] = {-1, 0, 1, 0};\nint dx[] = {0, 1, 0, -1};\n\nbool equals(double a, double b){\n  return abs(a-b) < EPS;\n}\n\nvoid setp(pair<int, int>& p, char c){\n  int tmp = c - 'A';\n  p = make_pair(tmp/3, tmp-(tmp/3)*3);\n}\n\nmain(){\n  while(cin >> n && n){\n    char in1, in2, in3;\n    cin >> in1 >> in2 >> in3;\n    setp(s, in1);\n    setp(t, in2);\n    setp(b, in3);\n    fill(dp[0][0], dp[16][0], 0.0);\n    dp[0][s.first][s.second] = 1.0;\n    for(int i=0;i<n;i++){\n      for(int j=0;j<3;j++){\n\tfor(int k=0;k<3;k++){\n\t  if(equals(dp[i][j][k], 0.0)) continue;\n\t  /*if(j == t.first && k == t.second){\n\t    dp[i+1][j][k] += dp[i][j][k];\n\t    continue;\n\t    }*/\n\t  for(int l=0;l<4;l++){\n\t    int ty = j + dy[l];\n\t    int tx = k + dx[l];\n\t    if(ty>=0 && ty<3){\n\t      if(tx>=0 && tx<3){\n\t\tif(ty != b.first || tx != b.second){\n\t\t  dp[i+1][ty][tx] += dp[i][j][k] / 4.0;\n\t\t  continue;\n\t\t}\n\t      }\n\t    }\n\t    dp[i+1][j][k] += dp[i][j][k] / 4.0;\n\t  }\n\t}\n      }\n      /*for(int j=0;j<3;j++){\n\tfor(int k=0;k<3;k++){\n\t  cout << setw(6) << dp[i][j][k] << ' ';\n\t}\n\tcout << endl;\n      }\n      cout << endl;*/\n    }\n    /*for(int j=0;j<3;j++){\n      for(int k=0;k<3;k++){\n\tcout << setw(6) << dp[n][j][k] << ' ';\n      }\n      cout << endl;\n      }*/\n    printf(\"%.8f\\n\", dp[n][t.first][t.second]);\n  }"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define F first\n#define S second\n#define INF 1 << 30\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\ndouble dp[16][3][3];\nint n, dx[] = {0,-1,0,1}, dy[] = {-1,0,1,0};\nchar cs, ct, cb;\nint s, t, b;\n\nint main(){\n  while(scanf(\"%d\", &n) && n){\n    memset(dp, 0.0, sizeof(dp));\n    scanf(\"\\n%c %c %c\", &cs, &ct, &cb);\n    s = cs - 'A';\n    t = ct - 'A';\n    b = cb - 'A';\n    //    fprintf(stderr, \"%c\\n\", cs);\n    dp[0][s/3][s%3] = 1;\n\n    rep(i, n) rep(y, 3) rep(x, 3){\n      rep(d, 4){\n\tint ny = y + dy[d], nx = x + dx[d];\n\tif(ny < 0 || nx < 0 || ny >= 3 || nx >= 3 || ny*3+nx == b) dp[i+1][y][x] += dp[i][y][x];\n\telse dp[i+1][ny][nx] += dp[i][y][x]*0.25;\n      }\n    }\n\n    printf(\"%.8lf\\n\", dp[n][t/3][t%3]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <algorithm>\n\n#define MAX_SEC 15\n#define MAX_STATE 1 << 9\n\n#define FILL(ptr, value) FILL_((ptr), sizeof(ptr)/sizeof(value), (value))\ntemplate <typename T>\nvoid FILL_(void * ptr, size_t size, T value){\n  std::fill((T*)ptr, (T*)ptr+size, value);\n}\n\nusing namespace std;\n\ndouble dp[MAX_SEC+1][9];\nint dx[4] = {1,0,-1,0};\nint dy[4] = {0,1,0,-1};\nint dir[4] = {1,3,-1,-3};\n\nint main(void){\n  int n;\n  while(cin >> n && n){\n    FILL(dp,0);\n    char tmp;\n    int s,t,b,x,y;\n\n    cin >> tmp; s = (int)(tmp - 'A');\n    cin >> tmp; t = (int)(tmp - 'A');\n    cin >> tmp; b = (int)(tmp - 'A');\n\n    dp[0][s] = 1;\n    for(int i=0;i<n;i++){\n      for(int j=0;j<9;j++){\n\tif(dp[i][j] == 0) continue;\n\tx = j%3;\n\ty = j/3;\n\tfor(int k=0;k<4;k++){\n\t  if(0 <= x+dx[k] && x+dx[k] < 3 &&\n\t     0 <= y+dy[k] && y+dy[k] < 3 &&\n\t     j+dir[k] != b){\n\t    dp[i+1][j+dir[k]] += dp[i][j] * 0.25;\n\t  }else{\n\t    dp[i+1][j] += dp[i][j] * 0.25;\n\t  }\n\t}\n      }\n    }\n    printf(\"%.8lf\\n\", dp[n][t]);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstring>\n#include <cmath>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <sstream>\nusing namespace std;\n\nlong cnt,as;\nchar s,t,b;\nconst int dy[]={-1,0,1,0};\nconst int dx[]={0,1,0,-1};\nint main(){\n  int n,field[2][5][5],tx,ty;\n  for(;cin>>n,n;){\n    cin.ignore();\n    cnt=as=0;\n    scanf(\" %c %c %c \",&s,&t,&b);\n    memset(field,0,sizeof(field));\n    int x= s=='A'||s=='D'||s=='G'?1:s=='B'||s=='E'||s=='H'?2:3;\n    int y= s=='A'||s=='B'||s=='C'?1:s=='D'||s=='E'||s=='F'?2:3;\n    \n    int p= t=='A'||t=='D'||t=='G'?1:t=='B'||t=='E'||t=='H'?2:3;\n    int q= t=='A'||t=='B'||t=='C'?1:t=='D'||t=='E'||t=='F'?2:3;\n\n    int u= b=='A'||b=='D'||b=='G'?1:b=='B'||b=='E'||b=='H'?2:3;\n    int t= b=='A'||b=='B'||b=='C'?1:b=='D'||b=='E'||b=='F'?2:3;\n\n    field[0][y][x]=1;\n    field[0][0][0]=field[0][0][1]=field[0][0][2]=field[0][0][3]=field[0][0][4]=1;\n    field[0][4][0]=field[0][4][1]=field[0][4][2]=field[0][4][3]=field[0][4][4]=1;\n    field[0][1][0]=field[0][2][0]=field[0][3][0]=1;\n    field[0][1][4]=field[0][2][4]=field[0][3][4]=1;\n    for(int k=0;k<n;k++){\n      for(int i=1;i<4;i++){\n        for(int j=1;j<4;j++){\n          if(i==t && j==u)continue;\n\n          for(int g=0;g<4;g++){\n            tx=j+dx[g];\n            ty=i+dy[g];\n            if(field[0][i][j]==0 && (tx<1 || ty<1 || tx>=4 || ty>=4))continue;\n            field[1][i][j]+=field[0][ty][tx];\n          }\n          if(field[0][i][j]!=0 && (i-1==t&&j==u || i+1==t&&j==u ||\n             i==t&&j-1==u || i==t&&j+1==u) ){\n            field[1][i][j]++;\n          }\n        }\n      }\n      /*\n      for(int ii=1;ii<4;ii++){\n        for(int jj=1;jj<4;jj++){\n          printf(\"%7d \",field[1][ii][jj]);\n        }\n        puts(\"\");\n      }\n      puts(\"\");*/\n      for(int i=1;i<4;i++)for(int j=1;j<4;j++)field[0][i][j]=field[1][i][j],field[1][i][j]=0;\n    }\n    long ababa=0;\n    for(int i=1;i<4;i++)for(int j=1;j<4;j++)ababa+=field[0][i][j];\n    \n    printf(\"%.8lf\\n\",(double)field[0][q][p]/(double)ababa);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <set>\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define REP(i,j) FOR(i,0,j)\n#define mp std::make_pair\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef std::pair<int,int> P;\ntypedef std::pair<int,P> State;\n\nconst int INF = 1001001001;\n\n// S N E W(南北東西)\nconst int dx[8] = {0, 0, 1, -1, 1, 1, -1, -1}, dy[8] = {1, -1, 0, 0, 1, -1, 1, -1};\n\ndouble memo[3][3][16];\nint n, s, t, b;\n\nint toIndex(char l){\n    return l - 'A';\n}\n\ndouble pow(double a, int n){\n    double res = 1.0;\n    while(n > 0){\n        if(n & 1){res *= a;}\n        a *= a;\n        n >>= 1;\n    }\n    return res;\n}\n\nvoid rec(int x, int y, int battery){\n    memo[y][x][battery] += pow(0.25, battery);\n\n    if(battery > n){return;}\n\n    REP(i, 4){\n        int nx = x + dx[i], ny = y + dy[i];\n        if(0 <= nx && nx < 3 &&\n           0 <= ny && ny < 3 &&\n           !(nx == b % 3 && ny == b / 3)){\n            rec(nx, ny, battery+1);\n        }else{\n            rec(x, y, battery+1);\n        }\n    }\n}\n\nint main(){\n    while(std::cin >> n, n){\n        std::fill(memo[0][0], memo[0][0]+3*3*16, 0.0);\n\n        char sl, tl, bl;\n        std::cin >> sl >> tl >> bl;\n\n        s = toIndex(sl), t = toIndex(tl), b = toIndex(bl);\n\n        rec(s%3, s/3, 0);\n        printf(\"%.7f\\n\", memo[t/3][t%3][n]);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint grd[3][3];\ndouble dp[3][3][20];\nint mx[]={-1,1,0,0},my[]={0,0,-1,1};\nchar abc[3][4]={\"ABC\",\"DEF\",\"GHI\"};\ndouble dfs(int x,int y,int n){\n\tif(dp[y][x][n]!=0)\treturn dp[y][x][n];\n\tif(n==0){\n\t\tif(grd[x][y]==1)\treturn dp[y][x][n]=1.0;\n\t\telse \treturn dp[y][x][n]=0.0;\n\t}\n\tdouble ret=0.0;\n\tfor(int i=0;i<4;i++){\n\t\tint cx=x+mx[i],cy=y+my[i];\n\t\tif(cx<0||2<cx||cy<0||2<cy)\tcontinue;\n\t\tif(grd[cy][cx]==2)\tret+=dfs(x,y,n-1)*0.25;\n\t\telse \tret+=dfs(cx,cy,n-1)*0.25;\n\t}\n\treturn dp[y][x][n]=ret;\n}\nint main(){\n\twhile(true){\n\t\tint n;\tcin>>n;\n\t\tif(n==0)\treturn 0;\n\t\tchar s,t,b;\tscanf(\" %c %c %c\",&s,&t,&b);\n\t\tmemset(grd,0,sizeof(grd));\tmemset(dp,0,sizeof(dp));\n\t\tint sx,sy;\n\t\tfor(int i=0;i<3;i++){\n\t\t\tfor(int j=0;j<3;j++){\n\t\t\t\tif(abc[i][j]==s){\n\t\t\t\t\tsx=j;\tsy=i;\n\t\t\t\t}\n\t\t\t\telse if(abc[i][j]==t)\tgrd[i][j]=1;\n\t\t\t\telse if(abc[i][j]==b)\tgrd[i][j]=2;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.15lf\\n\",dfs(sx,sy,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr,__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\n\nconst int dxdy[] = {-1,3,1,-3};\n\nint main() {\n    int life;\n    while (cin >> life, life) {\n        char start, goal, soko;\n        cin >> start >> goal >> soko;\n        start -= 'A';\n        goal -= 'A';\n        soko -= 'A';\n\n        vvi dp(2, vi(9, 0));\n        dp[0][start] = 1;\n        FOR(i, 1, life+1) {\n            fill(ALL(dp[1]), 0);\n            REP(j, 9) {\n                if (dp[0][j] > 0) {\n                    REP(k, 4) {\n                        int s = j + dxdy[k];\n                        if (!(0 <= s && s <= 8) || s == soko ||\n                            ((j == 2 || j == 5) && k == 1) || ((j == 3 || j == 6) && k == -1)) {\n                            dp[1][j] += dp[0][j];\n                        } else {\n                            dp[1][s] += dp[0][j];\n                        }\n                    }\n                }\n            }\n            dp[0] = dp[1];\n        }\n        int cnt = 0;\n        REP(i, 9) {\n            cnt += dp[0][i];\n        }\n        printf(\"%.8f\\n\", (double)dp[0][goal] / cnt);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n\nusing namespace std;\n\nint map[3][3],b_row,b_col;\n\nchar b[2];\n\nbool rangeCheck(int row,int col){\n\tif(row >= 0 && row <= 2 && col >= 0 && col <= 2)return true;\n\telse{\n\t\treturn false;\n\t}\n}\n\nint translate(char ch){\n\tswitch(ch){\n\tcase 'A':return 0;\n\tcase 'B':return 1;\n\tcase 'C':return 2;\n\tcase 'D':return 10;\n\tcase 'E':return 11;\n\tcase 'F':return 12;\n\tcase 'G':return 20;\n\tcase 'H':return 21;\n\tcase 'I':return 22;\n\t}\n\n\treturn -1; //must not reach here.\n}\n\nvoid func(int rest,int row,int col){\n\tif(rest == 0){\n\t\tmap[row][col]++;\n\t\treturn;\n\t}\n\n\tif(rangeCheck(row,col-1) == true && (row != b_row || col-1 != b_col)){\n\t\tfunc(rest-1,row,col-1);\n\t}else{\n\t\tfunc(rest-1,row,col);\n\t}\n\n\tif(rangeCheck(row,col+1) == true && (row != b_row || col+1 != b_col)){\n\t\tfunc(rest-1,row,col+1);\n\t}else{\n\t\tfunc(rest-1,row,col);\n\t}\n\n\tif(rangeCheck(row-1,col) == true && (row-1 != b_row || col != b_col)){\n\t\tfunc(rest-1,row-1,col);\n\t}else{\n\t\tfunc(rest-1,row,col);\n\t}\n\n\tif(rangeCheck(row+1,col) == true && (row+1 != b_row || col != b_col)){\n\t\tfunc(rest-1,row+1,col);\n\t}else{\n\t\tfunc(rest-1,row,col);\n\t}\n}\n\nint main(){\n\n\tint n,tmp,energy_row,energy_col;\n\tchar start[2],energy[2];\n\n\twhile(true){\n\t\tscanf(\"%d\",&n);\n\t\tif(n == 0)break;\n\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int k = 0; k < 3; k++)map[i][k] = 0;\n\t\t}\n\n\t\tscanf(\"%s %s %s\",start,energy,b);\n\n\t\ttmp = translate(b[0]);\n\t\tb_row = tmp/10;\n\t\tb_col = tmp%10;\n\n\t\ttmp = translate(energy[0]);\n\t\tenergy_row = tmp/10;\n\t\tenergy_col = tmp%10;\n\n\t\ttmp = translate(start[0]);\n\t\tfunc(n,tmp/10,tmp%10);\n\n\t\tprintf(\"%.8lf\\n\",((double)map[energy_row][energy_col])/((double)pow(4,n)));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)n; ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\nint next[9][4] = {\n  {0,1,0,3},\n  {0,2,1,4},\n  {1,2,2,5},\n  {3,4,0,6},\n  {3,5,1,7},\n  {4,5,2,8},\n  {6,7,3,6},\n  {6,8,4,7},\n  {7,8,5,8}\n};\nint n;\nint s,t,b;\nchar s_,t_,b_;\nint main(){\n  while(cin>>n,n){\n    cin>>s_>>t_>>b_;\n    s = s_-'A';\n    t = t_-'A';\n    b = b_-'A';\n    double dp[20][10] = {};\n    dp[0][s] = 1;\n    REP(time,n)REP(place,9)REP(r,4){\n      int next_place = next[place][r];\n      if(next_place == b) next_place = place;\n      dp[time+1][next_place] += dp[time][place] * 0.25;\n    }\n    cout<<dp[n][t]<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n\nusing namespace std;\n\nint b_row,b_col,memo[16][3][3];\n\nchar b[2];\n\nbool rangeCheck(int row,int col){\n\tif(row >= 0 && row <= 2 && col >= 0 && col <= 2)return true;\n\telse{\n\t\treturn false;\n\t}\n}\n\nint translate(char ch){\n\tswitch(ch){\n\tcase 'A':return 0;\n\tcase 'B':return 1;\n\tcase 'C':return 2;\n\tcase 'D':return 10;\n\tcase 'E':return 11;\n\tcase 'F':return 12;\n\tcase 'G':return 20;\n\tcase 'H':return 21;\n\tcase 'I':return 22;\n\t}\n\n\treturn -1; //must not reach here.\n}\n\nint main(){\n\n\tint n,tmp,energy_row,energy_col,row,col;\n\tchar start[2],energy[2];\n\n\twhile(true){\n\t\tscanf(\"%d\",&n);\n\t\tif(n == 0)break;\n\n\t\tfor(int i = 0; i < 16; i++){\n\t\t\tfor(int p = 0; p < 3; p++){\n\t\t\t\tfor(int k = 0; k < 3; k++)memo[i][p][k] = 0;\n\t\t\t}\n\n\t\t}\n\n\t\tscanf(\"%s %s %s\",start,energy,b);\n\n\t\ttmp = translate(b[0]);\n\t\tb_row = tmp/10;\n\t\tb_col = tmp%10;\n\n\t\ttmp = translate(energy[0]);\n\t\tenergy_row = tmp/10;\n\t\tenergy_col = tmp%10;\n\n\t\ttmp = translate(start[0]);\n\n\t\trow = tmp/10,col = tmp%10;\n\n\t\tif(rangeCheck(row,col-1) == true && (row != b_row || col-1 != b_col)){\n\t\t\tmemo[1][row][col-1] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row,col+1) == true && (row != b_row || col+1 != b_col)){\n\t\t\tmemo[1][row][col+1] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row-1,col) == true && (row-1 != b_row || col != b_col)){\n\t\t\tmemo[1][row-1][col] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row+1,col) == true && (row+1 != b_row || col != b_col)){\n\t\t\tmemo[1][row+1][col] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tfor(int loop = 2; loop <= n; loop++){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tif(i == b_row && k == b_col){\n\t\t\t\t\t\tmemo[loop][i][k] = 0;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(i == 0 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][0][0] = memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][0][0] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][0][0] += memo[loop-1][1][0];\n\t\t\t\t\t\t}else if(i == 0 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][0][1] = memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 0)memo[loop][0][1] += memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][0][1] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 2)memo[loop][0][1] += memo[loop-1][0][2];\n\t\t\t\t\t\t}else if(i == 0 && k == 2){\n\t\t\t\t\t\t\tmemo[loop][0][2] = memo[loop-1][0][2];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][0][2] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][0][2] += memo[loop-1][1][2];\n\t\t\t\t\t\t}else if(i == 1 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][1][0] = memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 0)memo[loop][1][0] += memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][1][0] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 0)memo[loop][1][0] += memo[loop-1][2][0];\n\t\t\t\t\t\t}else if(i == 1 && k == 1){\n\t\t\t\t\t\t\tif(b_row == 1 || b_col == 1){ //????????????????§??????§???????????????????????´?????¨????????????????????§??????????????????????¶??????????????????????\n\t\t\t\t\t\t\t\tmemo[loop][1][1] = memo[loop-1][1][1];\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][1][1] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][1][1] += memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][1][1] += memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][1][1] += memo[loop-1][2][1];\n\t\t\t\t\t\t}else if(i == 1 && k == 2){\n\t\t\t\t\t\t\tmemo[loop][1][2] = memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 2)memo[loop][1][2] += memo[loop-1][0][2];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][1][2] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 2)memo[loop][1][2] += memo[loop-1][2][2];\n\t\t\t\t\t\t}else if(i == 2 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][2][0] = memo[loop-1][2][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][2][0] += memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][2][0] += memo[loop-1][2][1];\n\t\t\t\t\t\t}else if(i == 2 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][2][1] = memo[loop-1][2][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 0)memo[loop][2][1] += memo[loop-1][2][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][2][1] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 2)memo[loop][2][1] += memo[loop-1][2][2];\n\t\t\t\t\t\t}else{ //i == 2 && k == 2\n\t\t\t\t\t\t\tmemo[loop][2][2] = memo[loop-1][2][2];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][2][2] += memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][2][2] += memo[loop-1][2][1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\",((double)memo[n][energy_row][energy_col])/((double)pow(4,n)));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tint n;\n\tchar s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A']=i%3+1;\n\t\tfy[i+'A']=i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d \", &n) , n ){\n\t\tscanf(\"%c %c %c\", &s, &t, &b);\n\t\t\n\t\tchar m[5][5] = {0};\n\t\tfor(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;\n\n\t\tif( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else{\n\t\t\tsolve( n , m );\n\t\t}\n\t\t//debug( m );\n\t\tprintf(\"%.9f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\nusing namespace std;\n\nstring M[3] = {\n\t\"ABC\",\n\t\"DEF\",\n\t\"GHI\"\n};\n\nvector < vector <bool> > V;\n\nchar s, t, b;\nint g;\nint cnt;\n\nchar get( const int x, const int y )\n{\n\treturn M[y][x];\n}\n\nvoid visit( const int x, const int y )\n{\n\tV[y][x] = true;\n}\n\nbool is_visited( const int x, const int y )\n{\n\treturn V[y][x];\n}\n\nvoid search( int &x, int &y, const char c )\n{\n\tfor ( int i = 0; i < 3; i++ )\n\t{\n\t\tfor ( int j = 0; j < 3; j++ )\n\t\t{\n\t\t\tif ( get( i, j ) == c )\n\t\t\t{\n\t\t\t\tx = i;\n\t\t\t\ty = j;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvoid bf( const int x, const int y, const int n )\n{\n\tif ( n == 0 )\n\t{\n\t\tif ( get( x, y ) == t )\n\t\t\tg++;\n\t\tcnt++;\n\t\treturn;\n\t}\n\n\tconst int dx[4] = { 0, 0, 1, -1 };\n\tconst int dy[4] = { 1, -1, 0, 0 };\n\n\tfor ( int i = 0; i < 4; i++ )\n\t{\n\t\tint nx = x + dx[i];\n\t\tint ny = y + dy[i];\n\n\t\tif ( nx < 0 || nx >= 3 || ny < 0 || ny >= 3 )\n\t\t{\n\t\t\tbf( x, y, n - 1 );\n\t\t\tcontinue;\n\t\t}\n\n\t\tif ( get( nx, ny ) == b )\n\t\t{\n\t\t\tbf( x, y, n - 1 );\n\t\t}\n\n\t\tbf( nx, ny, n - 1 );\n\t}\n\n\tbf( x, y, n - 1 );\n\n}\n\nint main( void )\n{\n\tint n;\n\twhile ( cin >> n && n != 0 )\n\t{\n\t\tcin >> s >> t >> b;\n\n\t\tint x, y;\n\n\t\tcnt = 0;\n\t\tg = 0;\n\t\tsearch( x, y, s );\n\n\t\tV = vector < vector <bool> >( 3, vector <bool>( 3, false ) );\n\n\t\tbf( x, y, n );\n\n\t\tdouble probability;\n\t\tif ( cnt != 0 )\n\t\t\tprobability = (double)g/(double)cnt;\n\n\t\tcout.setf( ios::fixed );\n\t\tcout.precision( 8 );\n\t\tcout << probability << endl;\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"stdio.h\"\n#include \"math.h\"\n\nint main()\n{\n int n;\n char s, t, b;\n\n scanf(\"%d\", &n);\n while(n>0){\n  scanf(\" %c %c %c\", &s, &t, &b);\n  s-='A'; t-='A'; b-='A';\n\n  int footprint1[9]={0,0,0,0,0,0,0,0,0};\n  int footprint2[9];\n  footprint1[s] = 1;\n  for(int i=0; i<n; i++){\n   for(int j=0; j<9; j++) footprint2[j]=0;\n   for(int j=0; j<9; j++){\n    if(footprint1[j]>0){\n     if(j>2 && j-3!=b) footprint2[j-3]+=footprint1[j];\n     else footprint2[j]+=footprint1[j];\n     if(j%3>0 && j-1!=b) footprint2[j-1]+=footprint1[j];\n     else footprint2[j]+=footprint1[j];\n     if((j+1)%3>0 && j+1!=b) footprint2[j+1]+=footprint1[j];\n     else footprint2[j]+=footprint1[j];\n     if(j<6 && j+3!=b) footprint2[j+3]+=footprint1[j];\n     else footprint2[j]+=footprint1[j];\n    }\n   }\n   for(int j=0; j<9; j++) footprint1[j]=footprint2[j];\n  }\n\n  printf(\"%f\\n\", footprint1[t] / pow(4.0, n));\n\n  scanf(\"%d\", &n);\n }\n\n return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\nvoid solve(char n, double p[5][5] ){\n\tfor( ; n>0 ; n-- ){\n\t\tdouble tmp[5][5] = {0};\n\t\t\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( p[y][x] > 0.0 ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\ttmp[my][mx] += p[y][x]/4.0;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmp[y][x] += p[y][x]/4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tp[y][x] = tmp[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tint n;\n\tchar s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A'] = i%3+1;\n\t\tfy[i+'A'] = i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d\", &n) , n ){\n\t\tscanf(\" %c %c %c \", &s, &t, &b);\n\t\tdouble p[5][5] = {0};\n\t\tfor(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tp[ fy[s] ][ fx[s] ] = 1.0;\n\t\t\n\t\tsolve( n , p );\n\t\t\n\t\tprintf(\"%.9f\\n\" , p[ fy[t] ][ fx[t] ] );\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<vector>\n#include<cstdio>\n\nusing namespace std;\n\nconst int MAX = 16;\nconst double per = 1.0/4.0;\nchar s,t,b;\nint n;\nint nex[9][9] = {{1,3,0,0},{0,2,4,1},{1,5,2,2},{0,4,6,3},{1,3,5,7},{2,4,8,5},{3,7,6,6},{4,6,8,7},{5,7,8,8}};\ndouble dp[MAX][9];\n\nvoid init(char c){\n  memset(dp,0,sizeof(dp));\n  dp[0][c-'A'] = 1.0;\n}\n\nvector<int> get(int pos){\n  vector<int> V;\n\n  for(int i = 0; i < 4; i++)\n    if(nex[pos][i] == b-'A') V.push_back(pos);\n    else V.push_back(nex[pos][i]);\n\n  return V;\n}\n\nvoid solve(){\n  for(int i = 0; i < n; i++)\n    for(int j = 0; j < 9; j++){\n      vector<int> V = get(j);\n      for(int k = 0; k < V.size(); k++)\n\tdp[i+1][V[k]] += dp[i][j]*per;\n    } \n}\n\nint main(){\n  while(cin >> n && n){\n    cin >> s >> t >> b;\n    init(s);\n    solve();\n    printf(\"%.8f\\n\",dp[n][t-'A']);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <utility>\n\nusing namespace std;\n\ntypedef pair<int,int> Pa;\n\nint dx[4] = {0, 1, 0, -1}, dy[4] = {1, 0, -1, 0};\n\ndouble search(int a[3][3], int n, Pa p, Pa q)\n{\n\tdouble b[3][3], c[3][3], m = n;\n\t\n\tfor(int i = 0; i < 3; i++){\n\t\tfor(int j = 0; j < 3; j++){\n\t\t\tb[i][j] = 0;\n\t\t}\n\t}\n\tb[p.first][p.second] = 1;\n\twhile(m--){\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tc[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tif(b[i][j] != 0){\n\t\t\t\t\tfor(int k = 0; k < 4; k++){\n\t\t\t\t\t\tint s = i+dy[k], t = j+dx[k];\n\t\t\t\t\t\tif(0 <= s && s < 3 && 0 <= t && t < 3){\n\t\t\t\t\t\t\tif(a[s][t] != 2){\n\t\t\t\t\t\t\t\tc[s][t] += b[i][j];\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tc[i][j] += b[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tb[i][j] = c[i][j];\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn (double)(b[q.first][q.second])/(1<<(2*n));\n}\n\nPa func(string str)\n{\n\tif(str == \"A\"){\n\t\treturn Pa(0,0);\n\t} else if(str == \"B\"){\n\t\treturn Pa(0,1);\n\t} else if(str == \"C\"){\n\t\treturn Pa(0,2);\n\t} else if(str == \"D\"){\n\t\treturn Pa(1,0);\n\t} else if(str == \"E\"){\n\t\treturn Pa(1,1);\n\t} else if(str == \"F\"){\n\t\treturn Pa(1,2);\n\t} else if(str == \"G\"){\n\t\treturn Pa(2,0);\n\t} else if(str == \"H\"){\n\t\treturn Pa(2,1);\n\t} else {\n\t\treturn Pa(2,2);\n\t}\n}\n\nint main()\n{\n\tint n, a[3][3];\n\tstring s, t, u;\n\tPa p;\n\t\n\twhile(1){\n\t\tcin >> n;\n\t\tif(n == 0){\n\t\t\tbreak;\n\t\t}\n\t\tcin >> s >> t >> u;\n\t\tfill(&a[0][0], &a[2][2], 0);\n\t\t\n\t\tp = func(u);\n\t\ta[p.first][p.second] = 2;\n\t\tp = func(t);\n\t\ta[p.first][p.second] = 1;\n\t\t\n\t\tprintf(\"%.8f\\n\", search(a, n, func(s), p));\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint dp[16][9];\nconst int m[]={-3,-1,1,3};\nint main(){\n\twhile(true){\n\t\tint n;\tcin>>n;\n\t\tif(n==0)\treturn 0;\n\t\tchar s,t,b;\tcin>>s>>t>>b;\n\t\tint ss=s-'A',bb=b-'A',tt=t-'A';\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdp[0][tt]=1;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int j=0;j<9;j++){\n\t\t\t\tif(dp[i][j]==0)\tcontinue;\n\t\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\t\tif(j+m[k]<0||9<=j+m[k])\tdp[i+1][j]+=dp[i][j];\n\t\t\t\t\telse if(bb==j+m[k])\tdp[i+1][j]+=dp[i][j];\n\t\t\t\t\telse \tdp[i+1][j+m[k]]+=dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint div=1<<(2*n);\n\t\tprintf(\"%.6lf\\n\",(double)dp[n][ss]/(double)div);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <vector>\n#include <string>\n#include <map>\n#include <sstream>\n#include <queue>\n#include <cstdlib>\n#include <algorithm>\n#include <iterator>\n#include <stack>\n#include <list>\nusing namespace std;\n#define INF 100000000\ntypedef long long int lli;\ntypedef pair<int,int> P;\ndouble dp[16][9];\n\nvoid room(char c,int &x){\n\tswitch(c){\n\t\tcase 'A':\n\t\tx=0;\n\t\tbreak;\n\t\t\n\t\tcase 'B':\n\t\tx=1;\n\t\tbreak;\n\t\t\n\t\tcase 'C':\n\t\tx=2;\n\t\tbreak;\n\t\t\t\n\t\tcase 'D':\n\t\tx=3;\n\t\tbreak;\n\t\t\n\t\tcase 'E':\n\t\tx=4;\n\t\tbreak;\n\t\t\n\t\tcase 'F':\n\t\tx=5;\n\t\tbreak;\n\t\t\n\t\tcase 'G':\n\t\tx=6;\n\t\tbreak;\n\t\t\n\t\tcase 'H':\n\t\tx=7;\n\t\tbreak;\n\t\t\n\t\tcase 'I':\n\t\tx=8;\n\t\tbreak;\n\t\t\n\t\tdefault:\n\t\tbreak;\n\t}\n}\n\nint main(){\n\tint n;\n\twhile(cin>>n&&n){\n\t\tchar s,t,b;\n\t\tcin >> s >> t >> b;\n\t\tint sr,tr,br;\n\t\troom(s,sr);\n\t\troom(t,tr);\n\t\troom(b,br);\n\t\tfor(int i=0; i<=n; ++i){\n\t\t\tfor(int j=0; j<9; ++j){\n\t\t\t\tdp[i][j]=0;\n\t\t\t}\n\t\t}\n\t\tdp[0][sr]=1;\n\t\tfor(int i=1; i<=n; ++i){\n\t\t\tfor(int j=0; j<9; ++j){\n\t\t\t\t/*\n\t\t\t\tif(j!=br){\n\t\t\t\t\tswitch(j){\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][1]/2+dp[i-1][3]/2+dp[i-1][0])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][0]+dp[i-1][4]+dp[i-1][2]+dp[i-1][1])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][1]/2+dp[i-1][5]/2+dp[i-1][2])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][0]+dp[i-1][4]+dp[i-1][6]+dp[i-1][3])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][1]+dp[i-1][5]+dp[i-1][7]+dp[i-1][3])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\t\tcase 5:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][2]+dp[i-1][4]+dp[i-1][8]+dp[i-1][5])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 6:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][3]/2+dp[i-1][7]/2+dp[i-1][6])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 7:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][6]+dp[i-1][4]/2+dp[i-1][8]/2+dp[i-1][7]/2)/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 8:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][5]/2+dp[i-1][7]/2+dp[i-1][8])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\tif(j%3!=0){\n\t\t\t\t\tif(j-1!=br){\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j-1]/4;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j]/4;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(j>=3){\n\t\t\t\t\tif(j-3!=br){\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j-3]/4;\n\t\t\t\t\t} else{\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j]/4;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(j%3!=2){\n\t\t\t\t\tif(j+1!=br){\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j+1]/4;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j]/4;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(j<=5){\n\t\t\t\t\tif(j+3!=br){\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j+3]/4;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j]/4;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8f\\n\",dp[n][tr]);\n\t\t//cout << dp[n][tr] << \"\\n\";\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <algorithm>\n#include <bitset>\n#include <cassert>\n#include <cctype>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <deque>\n#include <iomanip>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <stack>\n#include <sstream>\n#include <string>\n#include <vector>\nusing namespace std;\n\n#define EPS 1e-9\n#define INF MOD\n#define MOD 1000000007LL\n#define fir first\n#define iss istringstream\n#define sst stringstream\n#define ite iterator\n#define ll long long\n#define mp make_pair\n#define rep(i,n) rep2(i,0,n)\n#define rep2(i,m,n) for(int i=m;i<n;i++)\n#define pi pair<int,int>\n#define pb push_back\n#define sec second\n#define sh(i) (1LL<<i)\n#define sz size()\n#define vi vector<int>\n#define vc vector\n#define vl vector<ll>\n#define vs vector<string>\n\nint n,dy[]={0,1,0,-1},dx[]={1,0,-1,0};\nchar s,b,j;\nmap<pair<int,char>,double> M;\n\nchar code(int y,int x){\n\treturn 'A'+y*3+x;\n}\n\npi dec(char c){\n\treturn pi((c-'A')/3,(c-'A')%3);\n}\n\ndouble f(int n,char c){\n\tif(n==0)return c==b;\n\tif(M.find(pi(n,c))!=M.end())return M[pi(n,c)];\n\tdouble& res=M[pi(n,c)]=0;\n\tpi p=dec(c);\n\tint y=p.fir,x=p.sec;\n\trep(i,4){\n\t\tint ny=y+dy[i],nx=x+dx[i];\n\t\tif(ny<0||2<ny||nx<0||2<nx||code(ny,nx)==j)res+=f(n-1,c)/4;\n\t\telse res+=f(n-1,code(ny,nx))/4;\n\t}\n\treturn res;\n}\n\nint main(){\n\twhile(cin>>n&&n){\n\t\tcin>>s>>b>>j;\n\t\tcout<<f(n,s)<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <queue>\n\nusing namespace std;\n\ntypedef long double ld;\n\nconst int EMPTY   = 0;\nconst int BATTERY = 1;\nconst int STORE   = 2;\nconst int WALL    = 3;\n\nstruct Point {\npublic:\n  int x, y;\n  Point() { }\n  Point(int x, int y): x(x), y(y) { }\n};\n\nstruct State {\npublic:\n  Point p;\n  int battery;\n  State() { };\n  State(Point p, int battery): p(p), battery(battery) { }\n};\n\nPoint int2point(int n) {\n  return Point(1 + n % 3, 1 + n / 3);\n}\n\nint field[5][5];\n\nld dp[16][5][5];\nint main() {\n  int n, s, t, b;\n  while (true) {\n    cin >> n;\n    if (n == 0) break;\n    char cs, ct, cb;\n    cin >> cs >> ct >> cb;\n    s = cs - 'A';\n    t = ct - 'A';\n    b = cb - 'A';\n    \n    memset(field, EMPTY, sizeof(field));\n    memset(dp, 0, sizeof(dp));\n    for (int i = 0; i < 5; i++) {\n      field[0][i] = WALL;\n      field[4][i] = WALL;\n      field[i][0] = WALL;\n      field[i][4] = WALL;\n    }\n    Point batteryPoint = int2point(t);\n    field[batteryPoint.x][batteryPoint.y] = BATTERY;\n    Point storePoint = int2point(b);\n    field[storePoint.x][storePoint.y] = STORE;\n    State nowState(int2point(s), n);\n\n    dp[0][nowState.p.x][nowState.p.y] = 1.0f;\n    int dx[] ={1,0,-1,0},dy[] ={0,1,0,-1};\n    for(int i = 0; i < nowState.battery; i++){\n      for(int j = 1; j <= 3; j++){\n        for(int k = 1; k <= 3; k++){\n          for(int l = 0;l < 4; l++){\n            int nx = j + dx[l], ny = k + dy[l];\n            if(field[nx][ny] == STORE || field[nx][ny] == WALL) {\n              nx = j, ny = k;\n            }\n            dp[i+1][nx][ny] += dp[i][j][k] / 4.0;\n          }\n        }\n      }\n    }\n    printf(\"%.15llf\\n\", dp[nowState.battery][batteryPoint.x][batteryPoint.y]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\nusing namespace std;\ndouble solve(int loc,int n,int T,int B){\n\tif(n==0){\n\t\tif(loc==T) return 1.0;\n\t\telse return 0.0;\n\t}else{\n\t\tdouble ret=0.0;\n\t\tif(loc/3==(loc+1)/3&&loc+1<9&&loc+1!=B) ret+=solve(loc+1,n-1,T,B)/4;\n\t\telse ret+=solve(loc,n-1,T,B)/4;\n\t\tif(loc/3==(loc-1)/3&&loc-1>=0&&loc-1!=B) ret+=solve(loc-1,n-1,T,B)/4;\n\t\telse ret+=solve(loc,n-1,T,B)/4;\n\t\tif(loc-3>=0&&loc-3!=B) ret+=solve(loc-3,n-1,T,B)/4;\n\t\telse ret+=solve(loc,n-1,T,B)/4;\n\t\tif(loc+3<9&&loc+3!=B) ret+=solve(loc+3,n-1,T,B)/4;\n\t\telse ret+=solve(loc,n-1,T,B)/4;\n\t\treturn ret;\n\t}\n}\nint main(void){\n\tint n;\n\twhile(cin>>n,n){\n\t\tchar s,t,b;\n\t\tint S,T,B;\n\t\tconst string indx=\"ABCDEFGHI\";\n\t\tcin>>s>>t>>b;\n\t\tS=indx.find(s);\n\t\tT=indx.find(t);\n\t\tB=indx.find(b);\n\t\tprintf(\"%.8lf\\n\",solve(S,n,T,B));\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint ans;\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\n\nvoid solve(int x, int y, int n, char room[3][3] ){\n\tif( n == 0 ){\n\t\tif( room[y][x] == 2 ){\n\t\t\tans++;\t\n\t\t}\n\t\treturn;\n\t}else{\n\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\tint mx = x + dx[i];\n\t\t\tint my = y + dy[i];\n\t\t\tif( mx == -1 )\n\t\t\t\tmx = 0;\n\t\t\tif( mx == 3 )\n\t\t\t\tmx = 2;\n\t\t\tif( my == -1 )\n\t\t\t\tmy = 0;\n\t\t\tif( my == 3 )\n\t\t\t\tmy = 2;\n\t\t\tif( room[my][mx] == 1 ){\n\t\t\t\tmx -= dx[i];\n\t\t\t\tmy -= dy[i];\n\t\t\t}\n\t\t\tsolve( mx , my , n-1 , room );\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tchar n, s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A']=i%3;\n\t\tfy[i+'A']=i/3;\n\t}\n\t\n\twhile( scanf(\"%d\", &n) , n ){\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\t\n\t\tchar room[3][3] = {0};\n\t\tint x = fx[s];\n\t\tint y = fy[s];\n\t\troom[ fy[t] ][ fx[t] ] = 2;\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\n\t\tans = 0;\n\t\tsolve( x , y , n , room );\n\t\tprintf(\"%.8f\\n\" , ans/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cctype>\n#include<vector>\n#include<map>\n#include<iomanip>\nusing namespace std;\n#define fr first\n#define sc second\ntypedef pair<int,int> Pt;\nint main(){\n  map<char,Pt> tmp;\n  for(int i = 0 ; i < 9 ; i++ ){\n    tmp['A' + i] = Pt( i / 3 , i % 3 );\n  }\n\n  char s,t,b;\n  Pt st,gt,bt;\n  int n,d[]={0,1,0,-1};\n  while(cin >> n && n){\n    double dp[16][4][4] = {{{}}};\n    cin >> s >> t >> b;\n    st = tmp[s] , gt = tmp[t] , bt = tmp[b];\n    dp[0][st.fr][st.sc] = 1.0;\n    for(int i = 0 ; i < n ; i++ ){\n      for(int x = 0 ; x < 4 ; x++ ){\n        for(int y = 0 ; y < 4 ; y++ ){\n          for(int j = 0 ; j < 4 ; j++ ){\n            int px = x + d[j] , py = y + d[3-j];\n            if( px < 0 || px > 2 || py < 0 || py > 2 || bt == Pt(px,py)){\n              px = x , py = y;\n            }\n            dp[i+1][px][py] += dp[i][x][y] / 4.0;\n          }\n        }\n      }\n    }\n    cout << fixed << setprecision(8) << dp[n][gt.fr][gt.sc] << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "# include <iostream>\n# include <algorithm>\n# include <vector>\n# include <string>\n# include <set>\n# include <map>\n# include <cmath>\n# include <iomanip>\n# include <functional>\n# include <utility>\n# include <stack>\n# include <queue>\n# include <list>\nusing namespace std;\nusing LL = long long;\nconstexpr int MOD = 1000000000 + 7;\nconstexpr int INF = 2000000000;\nconst double PI = acos(-1);\n\n\nint n;\nchar s, t, b;\npair<int, int> S, T, B;\ndouble dp[16][3][3];\n\nint dx[] = { 0,1,0,-1 }, dy[] = { -1,0,1,0 };\n\nint main() {\n\twhile (cin >> n&&n) {\n\t\tcin >> s >> t >> b;\n\t\tS = make_pair((s - 'A') / 3, (s - 'A') % 3);\n\t\tT = make_pair((t - 'A') / 3, (t - 'A') % 3);\n\t\tB = make_pair((b - 'A') / 3, (b - 'A') % 3);\n\t\tmemset(dp, 0.0, sizeof(dp));\n\t\tdp[0][S.first][S.second] = 1;\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int y = 0; y < 3; y++) {\n\t\t\t\tfor (int x = 0; x < 3; x++) {\n\t\t\t\t\tif (dp[i][y][x] == 0)continue;\n\t\t\t\t\tfor (int d = 0; d < 4; d++) {\n\t\t\t\t\t\tint ny = y + dy[d], nx = x + dx[d];\n\t\t\t\t\t\tif (0 <= nx&&nx < 3 && 0 <= ny&&ny < 3 && make_pair(ny, nx) != B)dp[i + 1][ny][nx] += dp[i][y][x] * 0.25;\n\t\t\t\t\t\telse dp[i + 1][y][x] += dp[i][y][x] * 0.25;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << fixed << setprecision(10) << dp[n][T.first][T.second] << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <set>\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define REP(i,j) FOR(i,0,j)\n#define mp std::make_pair\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef std::pair<int,int> P;\ntypedef std::pair<int,P> State;\n\nconst int INF = 1001001001;\n\n// S N E W(南北東西)\nconst int dx[8] = {0, 0, 1, -1, 1, 1, -1, -1}, dy[8] = {1, -1, 0, 0, 1, -1, 1, -1};\n\ndouble dp[3][3][16];\nint n, s, t, b;\n\nint toIndex(char l){\n    return l - 'A';\n}\n\ndouble rec(int x, int y, int battery){\n    if(dp[y][x][battery] > -1e-6){return dp[y][x][battery];}\n    if(x == t % 3 && y == t / 3 && battery == n){return 1.0;}\n    if(battery >= n){return 0.0;}\n\n    double res = 0.0;\n    REP(i, 4){\n        int nx = x + dx[i], ny = y + dy[i];\n        if(0 <= nx && nx < 3 &&\n           0 <= ny && ny < 3 &&\n           !(nx == b % 3 && ny == b / 3)){\n            res += 0.25 * rec(nx, ny, battery+1);\n        }else{\n            res += 0.25 * rec(x, y, battery+1);\n        }\n    }\n\n    return res;\n}\n\nint main(){\n    while(std::cin >> n, n){\n        std::fill(dp[0][0], dp[0][0]+3*3*16, -1.0);\n\n        char sl, tl, bl;\n        std::cin >> sl >> tl >> bl;\n\n        s = toIndex(sl), t = toIndex(tl), b = toIndex(bl);\n\n        printf(\"%.7f\\n\", rec(s%3, s/3, 0));\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#include<iostream>\n#include<string.h>\n#include<math.h>\n#include<algorithm>\n#include<cstring>\n#include<queue>\nusing namespace std;\n#define INF 100000000\nint s,t,b,n;\ndouble p,nn;\nint d[4]={1,3,-1,-3};\ndouble df[9][16];\n\nint max(int a,int b){\n\tif(a>b){\n\t\treturn a;\n\t}else{\n\t\treturn b;\n\t}\n}\nvoid dfs(int s,int n){\n\tint p1;\n\tif(n==0){\n\t\tif(s==t)p+=pow(0.25,nn);\n\t\treturn;\n\t}\n\tif(df[s][n]>=0){\n\t\tp+=df[s][n];\n\t\treturn;\n\t}else{\n\t\tfor(int i=0;i<4;i++){\n\t\t\tif(s+d[i]==b){\n\t\t\t\tp1=p;\n\t\t\t\tdfs(s,n-1);\n\t\t\t\tdf[s][n-1]=p-p1;\n\t\t\t}else if(s/3!=(s+d[i])/3){//3で割った値に注目するのがポイント\n\t\t\t\tif(d[i]*d[i]==9&&0<=s+d[i]&&s+d[i]<9){\n\t\t\t\t\tp1=p;\n\t\t\t\t\tdfs(s+d[i],n-1);\n\t\t\t\t\tdf[s+d[1]][n-1]=p-p1;\n\t\t\t\t}else{\n\t\t\t\t\tp1=p;\n\t\t\t\t\tdfs(s,n-1);\n\t\t\t\t\tdf[s][n-1]=p-p1;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tp1=p;\n\t\t\t\tdfs(s+d[i],n-1);\n\t\t\t\tdf[s+d[i]][n-1]=p-p1;\n\t\t\t}\n\t\t}\n\t}\n\treturn;\n}\nint main(){\n\twhile(1){\n\t\tchar cs,ct,cb;\n\t\tp=0;\n\t\tcin>>n;\n\t\tnn=n;\n\t\tif(n==0)break;\n\t\tfor(int i=0;i<9;i++){\n\t\t\tfor(int j=0;j<9;j++){\n\t\t\t\tdf[i][j]=-1;\n\t\t\t}\n\t\t}\n\t\tcin>>cs>>ct>>cb;\n\t\ts=(int)cs-'A';\n\t\tt=(int)ct-'A';\n\t\tb=(int)cb-'A';\n\t\tdfs(s,n);\n\t\tcout<<p<<endl;\n\t}\n\treturn 0;\n}\t"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <utility>\n\nusing namespace std;\n\ntypedef pair<int,int> Pa;\n\nint dx[4] = {0, 1, 0, -1}, dy[4] = {1, 0, -1, 0};\n\ndouble search(int a[3][3], int n, Pa p, Pa q)\n{\n\tint b[3][3], c[3][3], m = n;\n\t\n\tfill(&b[0][0], &b[2][2], 0);\n\tb[p.first][p.second] = 1;\n\twhile(m--){\n\t\tfill(&c[0][0], &c[2][2], 0);\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tif(b[i][j] != 0){\n\t\t\t\t\tfor(int k = 0; k < 4; k++){\n\t\t\t\t\t\tint s = i+dy[k], t = j+dx[k];\n\t\t\t\t\t\tif(0 <= s && s < 3 && 0 <= t && t < 3){\n\t\t\t\t\t\t\tif(a[s][t] != 2){\n\t\t\t\t\t\t\t\tc[s][t] += b[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tb[i][j] = c[i][j];\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn (double)(b[q.first][q.second])/(1<<(2*n));\n}\n\nPa func(string str)\n{\n\tif(str == \"A\"){\n\t\treturn Pa(0,0);\n\t} else if(str == \"B\"){\n\t\treturn Pa(0,1);\n\t} else if(str == \"C\"){\n\t\treturn Pa(0,2);\n\t} else if(str == \"D\"){\n\t\treturn Pa(1,0);\n\t} else if(str == \"E\"){\n\t\treturn Pa(1,1);\n\t} else if(str == \"F\"){\n\t\treturn Pa(1,2);\n\t} else if(str == \"G\"){\n\t\treturn Pa(2,0);\n\t} else if(str == \"H\"){\n\t\treturn Pa(2,1);\n\t} else {\n\t\treturn Pa(2,2);\n\t}\n}\n\nint main()\n{\n\tint n, a[3][3];\n\tstring s, t, u;\n\tPa p;\n\t\n\twhile(1){\n\t\tcin >> n;\n\t\tif(n == 0){\n\t\t\tbreak;\n\t\t}\n\t\tcin >> s >> t >> u;\n\t\tfill(&a[0][0], &a[2][2], 0);\n\t\t\n\t\tp = func(u);\n\t\ta[p.first][p.second] = 2;\n\t\tp = func(t);\n\t\ta[p.first][p.second] = 1;\n\t\t\n\t\tprintf(\"%.8f\\n\", search(a, n, func(s), p));\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<queue>\n#define N 3\n#define MAX 16\nusing namespace std;\n\ndouble posib[N][N][MAX];\nstatic const int di[] = {-1,0,1,0};\nstatic const int dj[] = {0,1,0,-1};\n\nbool isinside( int i, int j ){\n  return 0<=i&&i<N && 0<=j&&j<N;\n}\n\nint main()\n{\n  while(true){\n    int n;\n    char s,t,b;\n    int si,sj,ti,tj,bi,bj;\n\n    cin >> n >> s >> t >> b;\n    if( n == 0 ) break;\n    // cout << s << ' ' << t << ' ' << b << endl;\n    s -= 'A'; t -= 'A'; b -= 'A';\n    si = s / N; sj = s % N;\n    ti = t / N; tj = t % N;\n    bi = b / N; bj = b % N;\n\n    for(int i = 0; i < N; ++i){\n      for(int j = 0; j < N; ++j){\n\tfor(int k = 0; k < MAX; ++k){\n\t  posib[i][j][k] = 0.0;\n\t}\n      }\n    }\n    posib[ti][tj][0] = 1.0;\n    posib[bi][bj][0] = 0.0;\n\n    for(int k = 1; k < MAX; ++k){\n      //cout << \"K = \" << k << endl;\n      for(int i = 0; i < N; ++i){\n\tfor(int j = 0; j < N; ++j){\n\n\t  if( i == bi && j == bj ) continue;\n\n\t  int cnt = 4;\n\n\t  for(int l = 0; l < sizeof(di)/sizeof(*di); ++l){\n\t    int li = i+di[l];\n\t    int lj = j+dj[l];\n\n\t    if( li == bi && lj == bj || !isinside( li, lj ) ){\n\t      posib[i][j][k] += posib[i][j][k-1] / (double)cnt;\n\t    }else if( isinside( li, lj ) ){\n\t      posib[i][j][k] += posib[li][lj][k-1] / (double)cnt;\n\t    }\n\n\t  }\n\t  \n\t  //cout << posib[i][j][k] << \"(CNT:\"<<cnt<<\") \";\n\t}\n\t//cout << endl;\n      }\n      //cout << endl;\n    }\n    printf(\"%.6lf\\n\", posib[si][sj][n]);\n    //return 0;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <map>\n\nusing namespace std;\ntypedef pair<int, int> pii;\n\nmap<pii, double> memo;\ndouble recur(int n, int room, int goal, int unused){\n\tif(n == 0){ return (room == goal) ? 1.0 : 0.0; }\n\tpii key(n, room);\n\tif(memo.find(key) != memo.end()){ return memo[key]; }\n\tdouble answer = 0.0;\n\tanswer += recur(n - 1, (room % 3 == 0 || room - 1 == unused) ? room : (room - 1), goal, unused);\n\tanswer += recur(n - 1, (room % 3 == 2 || room + 1 == unused) ? room : (room + 1), goal, unused);\n\tanswer += recur(n - 1, (room / 3 == 0 || room - 3 == unused) ? room : (room - 3), goal, unused);\n\tanswer += recur(n - 1, (room / 3 == 2 || room + 3 == unused) ? room : (room + 3), goal, unused);\n\tanswer /= 4;\n\tmemo.insert(make_pair(key, answer));\n\treturn answer;\n}\nint main(){\n\twhile(true){\n\t\tint n;\n\t\tcin >> n;\n\t\tif(n == 0){ break; }\n\t\tchar s, t, b;\n\t\tcin >> s >> t >> b;\n\t\tmemo.clear();\n\t\tcout << recur(n, s - 'A', t - 'A', b - 'A') << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int dx[] = {-1, 0, 0, 1};\nconst int dy[] = { 0,-1, 1, 0};\n\nint sx, sy, gx, gy, n, bx, by;\ndouble P[3][3];\n\nbool check(int x, int y){\n  return 0 <= x && x < 3 && 0 <= y && y < 3;\n}\n\nvoid solve(){\n  P[sy][sx] = 1;\n\n  queue<int> qx, qy, rem;\n  qx.push(sx), qy.push(sy), rem.push(n);\n\n  while(!qx.empty()){\n    int x = qx.front(); qx.pop();\n    int y = qy.front(); qy.pop();\n    int r = rem.front(); rem.pop();\n\n    if(x == gx && y == gy || r == 0) break;\n\n    for(int i = 0 ; i < 4 ; i++){\n      int nx = x + dx[i];\n      int ny = y + dy[i];\n\n      if(!check(nx, ny) || (nx == bx && ny == by)) continue;\n      P[ny][nx] += P[y][x] / 4;\n      qx.push(nx), qy.push(ny), rem.push(r-1);\n    }\n  }\n\n  printf(\"%.6f\\n\",P[gy][gx]);\n}\n\nint main(){\n  char s, t, b;\n  \n  while(cin >> n, n){\n    memset(P, 0, sizeof(P));\n\n    cin >> s >> t >> b;\n    int ss = s - 'A', tt = t - 'A', bb = b - 'A';\n    sx = ss%3; sy = ss/3;\n    gx = tt%3; gy = tt/3;\n    bx = bb%3; by = bb/3;\n    solve();\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);++(i))\n#define each(itr,c) for(__typeof(c.begin()) itr=c.begin(); itr!=c.end(); ++itr)\n#define all(x) (x).begin(),(x).end()\n#define mp make_pair\n#define pb push_back\n#define fi first\n#define se second\n\ntypedef pair<int,int> pi;\n\nbool inline in(int x, int y)\n{\n    return (0<=x&&x<3 && 0<=y&&y<3);\n}\n\nint main()\n{\n    int n;\n    int dx[]={1,-1,0,0}, dy[]={0,0,1,-1};\n    while(cin >>n,n)\n    {\n        char s,t,b;\n        scanf(\" %c %c %c\",&s,&t,&b);\n\n        pi S((s-'A')/3,(s-'A')%3);\n        pi T((t-'A')/3,(t-'A')%3);\n        pi B((b-'A')/3,(b-'A')%3);\n\n        //(j,i)??????????¢????\n        double dp[3][3]={0};\n\n        dp[S.fi][S.se]=1;\n        rep(i,n)\n        {\n            double newdp[3][3]={0};\n            //?????¨??????(x,y)\n            rep(y,3)rep(x,3)\n            {\n                rep(j,4)\n                {\n                    int nx=x+dx[j], ny=y+dy[j];\n                    if(in(nx,ny) && B!=pi(ny,nx))\n                    {\n                        //?§????\n                        newdp[ny][nx]+=dp[y][x]/4;\n                    }\n                    else\n                    {\n                        //??¨?????????\n                        newdp[y][x]+=dp[y][x]/4;\n                    }\n                }\n            }\n\n            memcpy(dp,newdp,sizeof(newdp));\n        }\n\n        printf(\"%.10lf\\n\", dp[T.fi][T.se]);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <climits>\n#include <cmath>\n#include <ctime>\n#include <cassert>\n#include <iostream>\n#include <fstream>\n#include <sstream>\n#include <iomanip>\n#include <complex>\n#include <string>\n#include <vector>\n#include <list>\n#include <deque>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <bitset>\n#include <iterator>\n#include <functional>\n#include <utility>\n#include <algorithm>\n#include <numeric>\n#include <typeinfo>\n\nusing namespace std;\n\n#define dump(n) cout<<\"# \"<<#n<<\"=\"<<(n)<<endl\n#define repi(i,a,b) for(int i=int(a);i<int(b);i++)\n#define rep(i,n) repi(i,0,n)\n#define iter(c) __typeof((c).begin())\n#define foreach(i,c) for(iter(c) i=(c).begin();i!=(c).end();++i)\n#define allof(c) (c).begin(),(c).end()\n#define mp make_pair\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\n\nint main()\n{\n\tfor(int n;cin>>n,n;){\n\t\tvvd cur(3,vd(3));\n\t\tpii barn;\n\t\tchar s,t,b; cin>>s>>t>>b;\n\t\tcur[(s-'A')/3][(s-'A')%3]=1;\n\t\tbarn=mp((b-'A')/3,(b-'A')%3);\n\t\twhile(n--){\n\t\t\tvvd next(3,vd(3));\n\t\t\trep(i,3) rep(j,3){\n\t\t\t\tint di[]={-1,1,0,0};\n\t\t\t\tint dj[]={0,0,-1,1};\n\t\t\t\tint stop=0;\n\t\t\t\trep(k,4){\n\t\t\t\t\tint ni=i+di[k],nj=j+dj[k];\n\t\t\t\t\tif(ni<0 || 3<=ni || nj<0 || 3<=nj || mp(ni,nj)==barn)\n\t\t\t\t\t\tstop++;\n\t\t\t\t\telse\n\t\t\t\t\t\tnext[ni][nj]+=cur[i][j]/4;\n\t\t\t\t}\n\t\t\t\tnext[i][j]+=cur[i][j]*stop/4;\n\t\t\t}\n\t\t\tcur=next;\n\t\t}\n\t\tprintf(\"%f\\n\",cur[(t-'A')/3][(t-'A')%3]);\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\ndouble dp[16][9];\nint k, x, y, z;\nint b[9][4]={\n\t{1,3,-1,-1},\n\t{ 0,2,4,-1 },\n\t{ 1,5,-1,-1 },\n\t{ 0,4,6,-1 },\n\t{ 1,3,5,7 },\n\t{ 2,4,8,-1 },\n\t{ 3,7,-1,-1 },\n\t{ 4,6,8,-1 },\n\t{ 5,7,-1,-1 }\n};\nint main() {\n\twhile (cin >> k, k) {\n\t\tmemset(dp, 0, sizeof(dp));\n\t\tchar a, b, c; cin >> a >> b >> c;\n\t\tdp[0][a - 'A'] = 1;\n\t    y = b - 'A'; z = c - 'A';\n\t\tdouble S = 0;\n\t\tfor (int i = 0; i < k; i++) {\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tfor (int l = 0; l < 4; l++) {\n\t\t\t\t\tif (::b[j][l] == -1 || ::b[j][l] == z) {\n\t\t\t\t\t\tdp[i + 1][j] += dp[i][j] * 0.25;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[i + 1][::b[j][l]] += dp[i][j] * 0.25;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.10lf\\n\", dp[k][y]);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdlib.h>\n#include<iostream>\n#include<stdio.h>\n#include<string.h>\n#include<math.h>\n#include<algorithm>\n#include<cstring>\n#include<queue>\nusing namespace std;\nint s,t,b,n;\ndouble p,nn;\nint d[4]={1,3,-1,-3};\ndouble df[10][20];\nvoid dfs(int s,int n){\n\tdouble p1;\n\tif(n==0){\n\t\tif(s==t){p+=pow(0.25,nn);}\n\t\treturn;\n\t}\n\tif(df[s][n]>=0){\n\t\tp+=df[s][n];\n\t\treturn;\n\t}else{\n\t\tfor(int i=0;i<4;i++){\n\t\t\tif(s+d[i]==b){\n\t\t\t\tp1=p;\n\t\t\t\tdfs(s,n-1);\n\t\t\t\tdf[s][n-1]=p-p1;\n\t\t\t}else if(s/3!=(s+d[i])/3){\n\t\t\t\tif(d[i]*d[i]==9&&0<=s+d[i]&&s+d[i]<9){\n\t\t\t\t\tp1=p;\n\t\t\t\t\tdfs(s+d[i],n-1);\n\t\t\t\t\tdf[s+d[1]][n-1]=p-p1;\n\t\t\t\t}else{\n\t\t\t\t\tp1=p;\n\t\t\t\t\tdfs(s,n-1);\n\t\t\t\t\tdf[s][n-1]=p-p1;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tp1=p;\n\t\t\t\tdfs(s+d[i],n-1);\n\t\t\t\tdf[s+d[i]][n-1]=p-p1;\n\t\t\t}\n\t\t}\n\t}\n\treturn;\n}\nint main(){\n\twhile(1){\n\t\tchar cs,ct,cb;\n\t\tp=0;\n\t\tcin>>n;\n\t\tnn=n;\n\t\tif(n==0)break;\n\t\tfor(int i=0;i<10;i++){\n\t\t\tfor(int j=0;j<20;j++){\n\t\t\t\tdf[i][j]=-1;\n\t\t\t}\n\t\t}\n\t\tcin>>cs>>ct>>cb;\n\t\ts=(int)cs-'A';\n\t\tt=(int)ct-'A';\n\t\tb=(int)cb-'A';\n\t\tdfs(s,n);\n\t\tcout<<p<<endl;\n\t}\n\treturn 0;\n}\t"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<algorithm>\n#include<array>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<functional>\n#include<limits>\n#include<list>\n#include<map>\n#include<numeric>\n#include<set>\n#include<stack>\n#include<string>\n#include<sstream>\n#include<unordered_map>\n#include<queue>\n#include<vector>\nusing namespace std;\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing pii = pair<int, int>;\n\n#define rep(i,a,b) for(int i=(a);i<(b);i++)\n#define rrep(i,a,b) for(int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n#define dump(o) {cerr<<#o<<\" \"<<o<<endl;}\n#define dumpc(o) {cerr<<#o; for(auto &e:(o))cerr<<\" \"<<e;cerr<<endl;}\n#define INF 0x3f3f3f3f\n#define INFL 0x3f3f3f3f3f3f3f3fLL\nconst int MOD = 1e9 + 7;\n\nint di[4] = { 1,0,-1,0 };\nint dj[4] = { 0,1,0,-1 };\n\nsigned main() {\n\tcout << fixed << setprecision(8);\n\tfor (int n; cin >> n&&n;) {\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tdouble f[3][3] = {};\n\t\tdouble g[3][3] = {};\n\t\tpii S, T, B;\n\t\tS = pii((s - 'A') / 3, (s - 'A') % 3);\n\t\tT = pii((t - 'A') / 3, (t - 'A') % 3);\n\t\tB = pii((b - 'A') / 3, (b - 'A') % 3);\n\t\tf[S.first][S.second] = 1;\n\t\twhile (n--) {\n\t\t\tmemset(g, 0, sizeof(g));\n\t\t\tswap(f, g);\n\t\t\trep(a, 0, 3) rep(b, 0, 3) {\n\t\t\t\tint cnt = 4;\n\t\t\t\trep(i, 0, 4) {\n\t\t\t\t\tif (a + di[i] == B.first&&b + dj[i] == B.second) continue;\n\t\t\t\t\tif (0 > a + di[i] && a + dj[i] > 2)continue;\n\t\t\t\t\tif (0 > b + di[i] && b + dj[i] > 2)continue;\n\t\t\t\t\tf[a + di[i]][b + dj[i]] += g[a][b] / cnt;\n\t\t\t\t}\n\t\t\t\tf[a][b] += (g[a][b] / cnt)*(4 - cnt);\n\t\t\t}\n\t\t\trep(i, 0, 3)dumpc(f[i]);\n\t\t}\n\t\tcout << f[T.first][T.second] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <map>\n#include <cstdio>\n\nusing namespace std;\n\ntypedef pair<int, int> P;\n\nint n, p, q;\nchar s, t, b;\ndouble dp[16][3][3];\nmap<char, P> mpp;\nint xdir[4] = {0, 1, 0, -1}, ydir[4] = {1, 0, -1, 0};\n\nvoid init()\n{\n  for(int i = 0; i < 3; ++i)\n    for(int j = 0; j < 3; ++j)\n      mpp[(char)('A'+3*i+j)] = P(i, j);\n\n  return ;\n}\n\nvoid solve()\n{\n  for(;n; --n)\n    for(int i = 0; i < 3; ++i)\n      for(int j = 0; j < 3; ++j)\n\tfor(int k = 0; k < 4; ++k){\n\t  int dy = i+ydir[k], dx = j+xdir[k];\n\t  if(!(0 <= dx && dx <= 2 && 0 <= dy && dy <= 2) \n\t     || (dy == p && dx == q)){ dy = i; dx = j;}\n\t  dp[n-1][dy][dx] += dp[n][i][j]/4.0;\n\t}\n  \n  return ;\n}\n\nint main()\n{\n  init();\n  while(cin>>n && n){\n    cin >> s >> t >> b;\n    fill(&dp[0][0][0], &dp[16][0][0], 0.0);\n    p = mpp[s].first; q = mpp[s].second;\n    dp[n][p][q] = 1.0;\n    p = mpp[b].first; q = mpp[b].second;\n    solve();\n    p = mpp[t].first; q = mpp[t].second;\n\n    printf(\"%.8lf\\n\", dp[0][p][q]);\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n//ABC\n//DEF\n//GHI\nusing namespace std;;\nint n,out,can,dx[]={0,0,-1,1},dy[]={1,-1,0,0};\nint gox,goy,mox,moy,stx,sty;\nvoid func(int y,int x,int bat){\n\tif(bat==0){\n\t\tif(y==goy&&x==gox)\n\t\t\tcan++;\n\t\tout++;\n\t\treturn;\n\t}\n\tint nx,ny;\n\tfor(int i=0;i<4;i++){\n\t\tny=dy[i]+y;\n\t\tnx=dx[i]+x;\n\t\tif(!(ny>=0&&ny<3&&nx>=0&&nx<3)||(nx==mox&&ny==moy))\n\t\t\tfunc(y,x,bat-1);\n\t\telse\n\t\tfunc(ny,nx,bat-1);\n\t}\n}\nint main(){\n\twhile(cin>>n,n){\n\t\tchar a[3];\n\t\tcan=0;\n\t\tout=0;\n\t\tint sx[3],sy[3];\n\t\tcin>>a[0]>>a[1]>>a[2];\n\t\tfor(int i=0;i<3;i++){\n\t\t\tif(a[i]=='A'){\n\t\t\t\ta[i]=0;sx[i]=0;\n\t\t\t}else if(a[i]=='B'){\n\t\t\t\tsy[i]=0;sx[i]=1;\n\t\t\t}else if(a[i]=='C'){\n\t\t\t\tsy[i]=0;sx[i]=2;\n\t\t\t}else if(a[i]=='D'){\n\t\t\t\tsy[i]=1;sx[i]=0;\n\t\t\t}else if(a[i]=='E'){\n\t\t\t\tsy[i]=1;sx[i]=1;\n\t\t\t}else if(a[i]=='F'){\n\t\t\t\tsy[i]=1;sx[i]=2;\n\t\t\t}else if(a[i]=='G'){\n\t\t\t\tsy[i]=2;sx[i]=0;\n\t\t\t}else if(a[i]=='H'){\n\t\t\t\tsy[i]=2;sx[i]=1;\n\t\t\t}else if(a[i]=='I'){\n\t\t\tsy[i]=2;sx[i]=2;\n\t\t\t}\n\t\t}\n\t\tsty=sy[0];stx=sx[0];\n\t\tgoy=sy[1];gox=sx[1];\n\t\tmoy=sy[2];mox=sx[2];\n\t\tfunc(sty,stx,n);\n\t\tprintf(\"%.8lf\\n\",(double)can/out);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\nusing namespace std;\n\nint dx[] = {-1,0,1,0},dy[] = {0,1,0,-1};\n\nint main(){\n\tint n;\n\tchar s,t,b;\n\twhile(cin >> n,n){\n\t\tcin >> s >> t >> b;\n\t\tdouble dp[16][3][3] = {};\n\t\tint sn = s - 'A',tn = t - 'A',bn = b - 'A';\n\t\tdp[0][sn / 3][sn % 3] = 1;\n\t\tfor(int i = 0;i < n;i++){\n\t\t\tfor(int j = 0;j < 3;j++){\n\t\t\t\tfor(int k = 0;k < 3;k++){\n\t\t\t\t\tfor(int l = 0;l < 4;l++){\n\t\t\t\t\t\tint x = j + dx[l],y = k + dy[l];\n\t\t\t\t\t\tif(x >= 0 && x < 3 && y >= 0 && y < 3 && x * 3 + y != bn){\n\t\t\t\t\t\t\tdp[i + 1][x][y] += dp[i][j][k] / 4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.9f\\n\",dp[n][tn / 3][tn % 3]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int dx[] = {-1, 0, 0, 1};\nconst int dy[] = { 0,-1, 1, 0};\n\nint sx, sy, gx, gy, n, bx, by;\ndouble P[3][3][20];\n\nbool check(int x, int y){\n  return 0 <= x && x < 3 && 0 <= y && y < 3;\n}\n\nvoid solve(){\n  P[sy][sx][n] = 1;\n\n  queue<int> qx, qy, rem;\n  qx.push(sx), qy.push(sy), rem.push(n);\n\n  while(!qx.empty()){\n    int x = qx.front(); qx.pop();\n    int y = qy.front(); qy.pop();\n    int r = rem.front(); rem.pop();\n\n    if(r == 0) continue;\n\n    for(int i = 0 ; i < 4 ; i++){\n      int nx = x + dx[i];\n      int ny = y + dy[i];\n\n      if(!check(nx, ny) || (nx == bx && ny == by)){\n        qx.push(nx), qy.push(ny), rem.push(r-1);\n      }else{\n        P[ny][nx][r-1] += P[y][x][r] / 4;\n        qx.push(nx), qy.push(ny), rem.push(r-1);\n      }\n    }\n  }\n\n  printf(\"%.8f\\n\",P[gy][gx][0]);\n}\n\nint main(){\n  char s, t, b;\n  \n  while(cin >> n, n){\n    memset(P, 0, sizeof(P));\n\n    cin >> s >> t >> b;\n    int ss = s - 'A', tt = t - 'A', bb = b - 'A';\n    sx = ss%3; sy = ss/3;\n    gx = tt%3; gy = tt/3;\n    bx = bb%3; by = bb/3;\n    solve();\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "# include <iostream>\n# include <algorithm>\n# include <vector>\n# include <string>\n# include <set>\n# include <map>\n# include <cmath>\n# include <iomanip>\n# include <functional>\n# include <utility>\n# include <stack>\n# include <queue>\n# include <list>\nusing namespace std;\nusing LL = long long;\nconstexpr int MOD = 1000000000 + 7;\nconstexpr int INF = 2000000000;\nconst double PI = acos(-1);\n\n\nint n;\nchar s, t, b;\npair<int, int> S, T, B;\ndouble dp[16][3][3];\n\nint dx[] = { 0,1,0,-1 }, dy[] = { -1,0,1,0 };\n\nint main() {\n\twhile (cin >> n&&n) {\n\t\tcin >> s >> t >> b;\n\t\tS = make_pair((s - 'A') / 3, (s - 'A') % 3);\n\t\tT = make_pair((t - 'A') / 3, (t - 'A') % 3);\n\t\tB = make_pair((b - 'A') / 3, (b - 'A') % 3);\n\t\tmemset(dp, 0.0, sizeof(dp));\n\t\tdp[0][S.first][S.second] = 1;\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int y = 0; y < 3; y++) {\n\t\t\t\tfor (int x = 0; x < 3; x++) {\n\t\t\t\t\tif (dp[i][y][x] == 0)continue;\n\t\t\t\t\tfor (int d = 0; d < 4; d++) {\n\t\t\t\t\t\tint ny = y + dy[d], nx = x + dx[d];\n\t\t\t\t\t\tif (0 <= nx&&nx < 3 && 0 <= ny&&ny < 3 && make_pair(ny, nx) != B)dp[i + 1][ny][nx] += dp[i][y][x] * 0.25;\n\t\t\t\t\t\telse dp[i + 1][y][x] += dp[i][y][x] * 0.25;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << fixed << setprecision(10) << dp[n][T.first][T.second] << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <vector>\nusing namespace std;\n\nint main(){\n  int n;\n  while(cin >> n, n){\n    vector< vector<double> > P(3, vector<double>(3,0));\n    char s, t, b;\n    cin >> s >> t >> b;\n    int S = s - 'A', T = t - 'A', B = b - 'A';\n    P[S/3][S%3] = 1;\n    const int dx[] = {1, 0, -1, 0}, dy[] = {0, 1, 0, -1};\n    for(int i = 0; i < n; ++i){\n      vector< vector<double> > P_(3, vector<double>(3,0));\n      for(int j = 0; j < 3; ++j){\n        for(int k = 0; k < 3; ++k){\n          for(int l = 0; l < 4; ++l){\n            int j_ = j + dx[l], k_ = k + dy[l];\n            if(j_ < 0 || j_ > 2 || k_ < 0 || k_ > 2 || j_*3 + k_ == B){\n              P_[j][k] += P[j][k]*0.25;\n            }else{\n              P_[j_][k_] += P[j][k]*0.25;\n            }\n          }\n        }\n      }\n      P = P_;\n    }\n    printf(\"%.12f\\n\", P[T/3][T%3]);\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define FOR(i,a,b) for(int i= (a); i<((int)b); ++i)\n#define RFOR(i,a) for(int i=(a); i >= 0; --i)\n#define FOE(i,a) for(auto i : a)\n#define ALL(c) (c).begin(), (c).end()\n#define RALL(c) (c).rbegin(), (c).rend()\n#define DUMP(x)  cerr << #x << \" = \" << (x) << endl;\n#define SUM(x) std::accumulate(ALL(x), 0LL)\n#define MIN(v) *std::min_element(v.begin(), v.end())\n#define MAX(v) *std::max_element(v.begin(), v.end())\n#define EXIST(v,x) (std::find(v.begin(), v.end(), x) != v.end())\n#define BIT(n) (1LL<<(n))\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end());\n\ntypedef long long LL;\ntemplate<typename T> using V = std::vector<T>;\ntemplate<typename T> using VV = std::vector<std::vector<T>>;\ntemplate<typename T> using VVV = std::vector<std::vector<std::vector<T>>>;\n\ntemplate<class T> inline T ceil(T a, T b) { return (a + b - 1) / b; }\ntemplate<class T> inline void print(T x) { std::cout << x << std::endl; }\ntemplate<class T> inline void print_vec(const std::vector<T> &v) { for (int i = 0; i < v.size(); ++i) {  if (i != 0) {std::cout << \" \";} std::cout << v[i];} std::cout << \"\\n\"; }\ntemplate<class T> inline bool inside(T y, T x, T H, T W) {return 0 <= y and y < H and 0 <= x and x < W; }\ntemplate<class T> inline double euclidean_distance(T y1, T x1, T y2, T x2) { return sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2)); }\ntemplate<class T> inline double manhattan_distance(T y1, T x1, T y2, T x2) { return abs(x1 - x2) + abs(y1 - y2); }\n\nconst int INF = 1L << 30;\nconst double EPS = 1e-9;\nconst std::string YES = \"YES\", Yes = \"Yes\", NO = \"NO\", No = \"No\";\nconst std::vector<int> dy4 = { 0, 1, 0, -1 }, dx4 = { 1, 0, -1, 0 };    // 4近傍（右, 下, 左, 上）\nconst std::vector<int> dy8 = { 0, -1, 0, 1, 1, -1, -1, 1 }, dx8 = { 1, 0, -1, 0, 1, 1, -1, -1 };\n\nusing namespace std;\n\n\nint main() {\n    cin.tie(0);\n\tios::sync_with_stdio(false);\n\n\twhile (true) {\n        int N;\n        char S, T, B;\n        cin >> N;\n        if (N == 0) {\n            break;\n        }\n        cin >> S >> T >> B;\n\n        map<char, pair<int, int>> d;\n        FOR(y, 0, 3) {\n            FOR(x, 0, 3) {\n                d['A' + 3 * y + x] = make_pair(y, x);\n            }\n        }\n        int sy = d[S].first, sx = d[S].second;\n        int ey = d[T].first, ex = d[T].second;\n        int by = d[B].first, bx = d[B].second;\n\n        vector<vector<vector<double>>> dp(N + 1, vector<vector<double>>(3, vector<double>(3)));\n        dp[N][sy][sx] = 1;\n\n        for (int n = N; n > 0; --n) {\n            FOR(y, 0, 3) {\n                FOR(x, 0, 3) {\n                    if (dp[n][y][x] == 0) {\n                        continue;\n                    }\n\n                    FOR(i, 0, 4) {\n                        int ny = dy4[i] + y;\n                        int nx = dx4[i] + x;\n\n                        if (not inside(ny, nx, 3, 3) or (ny == by and nx == bx)) {\n                            dp[n - 1][y][x] += dp[n][y][x] * 0.25;\n                        }\n                        else {\n                            dp[n - 1][ny][nx] += dp[n][y][x] * 0.25;\n                        }\n                    }\n                }\n            }\n        }\n\n        cout << fixed << setprecision(7) << dp[0][ey][ex] << endl;\n    }\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstring>\n#include <cmath>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <sstream>\nusing namespace std;\n\nlong cnt,as;\nchar s,t,b;\nconst int dy[]={-1,0,1,0};\nconst int dx[]={0,1,0,-1};\nint main(){\n  int n,tx,ty;\n  long field[2][5][5];\n  for(;cin>>n,n;){\n    cin.ignore();\n    cnt=as=0;\n    scanf(\" %c %c %c \",&s,&t,&b);\n    memset(field,0,sizeof(field));\n    int x= s=='A'||s=='D'||s=='G'?1:s=='B'||s=='E'||s=='H'?2:3;\n    int y= s=='A'||s=='B'||s=='C'?1:s=='D'||s=='E'||s=='F'?2:3;\n    \n    int p= t=='A'||t=='D'||t=='G'?1:t=='B'||t=='E'||t=='H'?2:3;\n    int q= t=='A'||t=='B'||t=='C'?1:t=='D'||t=='E'||t=='F'?2:3;\n\n    int u= b=='A'||b=='D'||b=='G'?1:b=='B'||b=='E'||b=='H'?2:3;\n    int t= b=='A'||b=='B'||b=='C'?1:b=='D'||b=='E'||b=='F'?2:3;\n\n    field[0][y][x]=1;\n    field[0][0][0]=field[0][0][1]=field[0][0][2]=field[0][0][3]=field[0][0][4]=1;\n    field[0][4][0]=field[0][4][1]=field[0][4][2]=field[0][4][3]=field[0][4][4]=1;\n    field[0][1][0]=field[0][2][0]=field[0][3][0]=1;\n    field[0][1][4]=field[0][2][4]=field[0][3][4]=1;\n    for(int k=0;k<n;k++){\n      for(int i=1;i<4;i++){\n        for(int j=1;j<4;j++){\n          if(i==t && j==u)continue;\n\n          for(int g=0;g<4;g++){\n            tx=j+dx[g];\n            ty=i+dy[g];\n            if(tx<1 || ty<1 || tx>=4 || ty>=4)continue;\n            field[1][i][j]+=field[0][ty][tx];\n          }\n          /*\n          if(field[0][i][j]!=0 && (i-1==t&&j==u || i+1==t&&j==u ||\n                                   i==t&&j-1==u || i==t&&j+1==u) ){\n            field[1][i][j]++;\n          }*/\n          int uguu=0;\n          if(field[0][i][j]>0){\n            for(int g=0;g<4;g++){\n              tx=j+dx[g];\n              ty=i+dy[g];\n              if((tx<1 || ty<1 || tx>=4 || ty>=4) || ty==t&&tx==u){\n                uguu++;\n              }\n            }\n            \n            field[1][i][j]+=field[0][i][j]*uguu;\n          }\n        }\n      }\n      /*\n      for(int ii=1;ii<4;ii++){\n        for(int jj=1;jj<4;jj++){\n          printf(\"%7ld \",field[1][ii][jj]);\n        }\n        puts(\"\");\n      }\n      puts(\"\");*/\n      for(int i=1;i<4;i++)for(int j=1;j<4;j++)field[0][i][j]=field[1][i][j],field[1][i][j]=0;\n    }\n\n    printf(\"%.8lf\\n\",(double)field[0][q][p]/pow(4.0,(double)n));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<math.h>\nint main()\n{\n\tint n,s,t,b,i,j,k,x[9][4]={{1,3,0,0},{0,2,4,1},{1,5,2,2},{0,4,6,3},{1,3,5,7},{2,4,8,6},{3,7,0,0},{4,6,8,7},{5,7,8,8}};\n\tchar _[9];\n\twhile(scanf(\"%d\",&n),n)\n\t{\n\t\tdouble a[101][9]={0};\n\t\tgetchar(),fgets(_,9,stdin);\n\t\ts=_[0]-'A',t=_[2]-'A',b=_[4]-'A';\n\t\ta[0][s]=1;\n\t\tfor(i=0;i<n;++i)for(j=0;j<9;++j)for(k=0;k<4;++k)\n\t\t\tif(x[j][k]!=b)a[i+1][x[j][k]]+=a[i][j];\n\t\t\telse a[i+1][j]+=a[i][j];\n\t\tprintf(\"%.8f\\n\",a[n][t]/pow(4.0,n));\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tint n;\n\tchar s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A'] = i%3+1;\n\t\tfy[i+'A'] = i/3+1;\n\t}\n\t\n\twhile( scanf(\" %d \", &n) , n ){\n\t\tscanf(\" %c %c %c \", &s, &t, &b);\n\t\t\n\t\tchar m[5][5] = {0};\n\t\tfor(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;\n\t\t\n\t\tsolve( n , m );\n\t\t\n\t\t//debug( m );\n\t\tprintf(\"%.9f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\n\ndouble dp[15][3][3]={};\nint dx[4]={1,-1,0,0};\nint dy[4]={0,0,1,-1};\nint bx,by;\nint tx,ty;\n\ndouble rec(int rest,int x,int y){\n     //cout<<\"x:\"<<x<<\"y:\"<<y<<endl;\n     if(x<0||x>2||y<0||y>2)return 0;\n     if(dp[rest][x][y]>__DBL_EPSILON__)return dp[rest][x][y];\n\n     if(rest==0){\n\t  if(x==tx&&y==ty)return 1;\n\t  else return 0;\n     }\n     double sum=0;\n     for(int i=0;i<4;i++){\n\t  if((x+dx[i]==bx)&&(y+dy[i]==by)){\n\t       double a=rec(rest-1,x,y);\n\t       if(a>__DBL_EPSILON__)dp[rest-1][x+dx[i]][y+dy[i]]=a;\n\t       sum+=a;\n\t       }else{\n\t       double a=rec(rest-1,x+dx[i],y+dy[i]);\n\t       if(a>__DBL_EPSILON__)dp[rest-1][x+dx[i]][y+dy[i]]=a;\n\t       sum+=a;\n\t  }\n     }\n     sum=sum/4;\n     return sum;\n}\nvoid topoint(char a,int &x,int &y){\n     int tmp=a-'A';\n     x=tmp/3;\n     y=tmp%3;\n     return;\n}\nint main(){\n     int N;\n     cout.precision(8);\n     cout.setf(ios::fixed);\n     while(cin>>N,N){\n\t  char s,t,b;\n\t  cin>>s>>t>>b;\n\t  int sx,sy;\n\t  topoint(s,sx,sy);\n\t  topoint(t,tx,ty);\n\t  topoint(b,bx,by);\n\t  //cout<<sx<<\":\"<<sy<<\" \"<<tx<<\":\"<<ty<<endl;\n\t  cout<<rec(N,sx,sy)<<endl;\n\t  for(int i=0;i<15;i++){\n\t       for(int j=0;j<3;j++){\n\t\t    for(int k=0;k<3;k++){\n\t\t\t dp[i][j][k]=0;\n\t\t    }\n\t       }\n\t  }\n\t\t   \n     }\n     return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\n\n\nint main(){\n\tint n;\n\tint dx[]={1,0,-1,0};\n\tint dy[]={0,1,0,-1};\n\tdouble nxt[5][5],cur[5][5];\n\twhile(cin>>n,n){\n\t\tmemset(cur,0,sizeof(cur));\n\t\tint xs[3],ys[3];\n\t\tfor(int i=0;i<3;i++){\n\t\t\tchar c;\n\t\t\tint a;\n\t\t\tcin>>c;\n\t\t\ta=c-'A';\n\t\t\txs[i]=a%3+1;\n\t\t\tys[i]=a/3+1;\n\t\t}\n\t\tcur[xs[0]][ys[0]]=1;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tmemset(nxt,0,sizeof(nxt));\n\t\t\tfor(int x=1;x<=3;x++){\n\t\t\t\tfor(int y=1;y<=3;y++){\n\t\t\t\t\tfor(int i=0;i<4;i++){\n\t\t\t\t\t\tif(x+dx[i]==xs[2]&&y+dy[i]==ys[2])\n\t\t\t\t\t\t\tnxt[x][y]+=cur[x][y]/4;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tnxt[x+dx[i]][y+dy[i]]+=cur[x][y]/4;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemcpy(cur,nxt,sizeof(cur));\n\t\t}\n\t\tprintf(\"%.8f\\n\",cur[xs[1]][ys[1]]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint grd[3][3];\ndouble dp[3][3][20];\nint mx[]={-1,1,0,0},my[]={0,0,-1,1};\nchar abc[3][4]={\"ABC\",\"DEF\",\"GHI\"};\ndouble dfs(int x,int y,int n){\n\tif(dp[y][x][n]!=0)\treturn dp[y][x][n];\n\tif(n==0){\n\t\tif(grd[x][y]==1)\treturn dp[y][x][n]=1.0;\n\t\telse \treturn dp[y][x][n]=0.0;\n\t}\n\tdouble ret=0.0;\n\tfor(int i=0;i<4;i++){\n\t\tint cx=x+mx[i],cy=y+my[i];\n\t\tif(cx<0||2<cx||cy<0||2<cy)\tcontinue;\n\t\tif(grd[cy][cx]==2)\tcontinue;\n\t\tret+=dfs(cx,cy,n-1)*0.25;\n\t}\n\treturn dp[y][x][n]=ret;\n}\nint main(){\n\twhile(true){\n\t\tint n;\tcin>>n;\n\t\tif(n==0)\treturn 0;\n\t\tchar s,t,b;\tscanf(\" %c %c %c\",&s,&t,&b);\n\t\tmemset(grd,0,sizeof(grd));\tmemset(dp,0,sizeof(dp));\n\t\tint sx,sy;\n\t\tfor(int i=0;i<3;i++){\n\t\t\tfor(int j=0;j<3;j++){\n\t\t\t\tif(abc[i][j]==s){\n\t\t\t\t\tsx=j;\tsy=i;\n\t\t\t\t}\n\t\t\t\tif(abc[i][j]==t)\tgrd[i][j]=1;\n\t\t\t\tif(abc[i][j]==b)\tgrd[i][j]=2;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.15lf\\n\",dfs(sx,sy,n));\n\t}\n}\n\t\t"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint dp[16][5][5];\nbool grid[5][5];\nconst int px[] = {1, 1, 1, 2, 2, 2, 3, 3, 3};\nconst int py[] = {1, 2, 3, 1, 2, 3, 1, 2, 3};\nconst int dx[] = {-1, 0, 1, 0, 0};\nconst int dy[] = {0, -1, 0, 1, 0};\n\nint main()\n{\n\tint n;\n\twhile (scanf(\"%d\", &n), n){\n\t\tmemset(dp, 0, sizeof(dp));\n\t\tmemset(grid, false, sizeof(grid));\n\t\t\n\t\tchar s, t, b;\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\ts -= 'A'; t -= 'A'; b -= 'A';\n\t\t\n\t\tfor (int i = 0; i < 9; i++){\n\t\t\tgrid[px[i]][py[i]] = (b == i);\n\t\t}\n\t\t\n\t\tdp[0][px[s]][py[s]] = 1;\n\t\tfor (int i = 0; i < n; i++){\n\t\t\tfor (int x = 1; x <= 3; x++){\n\t\t\t\tfor (int y = 1; y <= 3; y++){\n\t\t\t\t\tbool f = false;\n\t\t\t\t\tfor (int dir = 0; dir < 5; dir++){\n\t\t\t\t\t\tint tx = x + dx[dir];\n\t\t\t\t\t\tint ty = y + dy[dir];\n\t\t\t\t\t\tif (grid[tx][ty] || dir == 4){\n\t\t\t\t\t\t\tif (f) continue;\n\t\t\t\t\t\t\tdp[i + 1][x][y] += dp[i][x][y];\n\t\t\t\t\t\t\tf = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse dp[i + 1][tx][ty] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tint sum = 0;\n\t\tint num = 0;\n\t\tfor (int i = 0; i < 9; i++){\n\t\t\tsum += dp[n][px[i]][py[i]];\n\t\t\tnum += dp[n][px[i]][py[i]] * (i == t);\n\t\t}\n\t\t\n\t\tdouble res = (double)num / sum;\n\t\t//printf(\"%d %d\\n\", num, sum);\n\t\t\n\t\tprintf(\"%.8f\\n\", res);\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int dx[] = {-1, 0, 0, 1};\nconst int dy[] = { 0,-1, 1, 0};\n\nint sx, sy, gx, gy, n, bx, by;\ndouble P[3][3];\n\nbool check(int x, int y){\n  return 0 <= x && x < 3 && 0 <= y && y < 3;\n}\n\nvoid solve(){\n  P[sy][sx] = 1;\n\n  queue<int> qx, qy, rem;\n  qx.push(sx), qy.push(sy), rem.push(n);\n\n  while(!qx.empty()){\n    int x = qx.front(); qx.pop();\n    int y = qy.front(); qy.pop();\n    int r = rem.front(); rem.pop();\n\n    if(x == gx && y == gy) break;\n    if(r == 0) continue;\n\n    for(int i = 0 ; i < 4 ; i++){\n      int nx = x + dx[i];\n      int ny = y + dy[i];\n\n      if(!check(nx, ny) || (nx == bx && ny == by)) continue;\n      P[ny][nx] += P[y][x] / 4;\n      qx.push(nx), qy.push(ny), rem.push(r-1);\n    }\n  }\n\n  printf(\"%.8f\\n\",P[gy][gx]);\n}\n\nint main(){\n  char s, t, b;\n  \n  while(cin >> n, n){\n    memset(P, 0, sizeof(P));\n\n    cin >> s >> t >> b;\n    int ss = s - 'A', tt = t - 'A', bb = b - 'A';\n    sx = ss%3; sy = ss/3;\n    gx = tt%3; gy = tt/3;\n    bx = bb%3; by = bb/3;\n    solve();\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\ntypedef pair<int, int> P;\nint dx[] = {-1, 0, 1,  0};\nint dy[] = { 0, 1, 0, -1};\n\nvoid solve()\n{\n\tint n;\n\twhile(cin >> n, n)\n\t{\n\t\tlong double dp[16][5][5] = {0.0};\n\t\tchar s, t, b;\n\t\tcin >> s >> t >> b;\n\t\tint sx, sy, gx, gy, bx, by;\n\t\tsy = (s-'A')/3 +1, sx = (s-'A')%3 +1;\n\t\tgy = (t-'A')/3 +1, gx = (t-'A')%3 +1;\n\t\tby = (b-'A')/3 +1, bx = (b-'A')%3 +1;\n\t\tchar Map[5][5];\n\t\tfor(int i = 0; i < 5; ++i)\n\t\t{\n\t\t\tfor(int j = 0; j < 5; ++j)\n\t\t\t{\n\t\t\t\tMap[i][j] = 'X';\n\t\t\t}\n\t\t}\n\t\tfor(int i = 1; i < 4; ++i)\n\t\t{\n\t\t\tfor(int j = 1; j < 4; ++j)\n\t\t\t{\n\t\t\t\tif(i != bx || j != by)\n\t\t\t\t{\n\t\t\t\t\tMap[i][j] = ' ';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdp[n][sy][sx] = 1.0;\n\t\twhile(n)\n\t\t{\n\t\t\tfor(int i = 1; i < 4; ++i)\n\t\t\t{\n\t\t\t\tfor(int j = 1; j < 4; ++j)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < 4; ++k)\n\t\t\t\t\t{\n\t\t\t\t\t\tint tx = j + dx[k];\n\t\t\t\t\t\tint ty = i + dy[k];\n\t\t\t\t\t\tif(Map[ty][tx] == 'X')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttx = j; ty = i;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdp[n - 1][ty][tx] += dp[n][i][j] * 0.25;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tn--;\n\t\t}\n\t\tprintf(\"%.8lf\\n\", dp[0][gy][gx]);\n\t}\n}\n\nint main()\n{\n\tsolve();\n\treturn(0);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint dp[20][3][3];\nconst int dx[]={1,-1,0,0};\nconst int dy[]={0,0,1,-1};\nint main(){\n\twhile(true){\n\t\tint n;\tcin>>n;\n\t\tif(n==0)\treturn 0;\n\t\tchar s,t,b;\tcin>>s>>t>>b;\n\t\tint sx,sy,tx,ty,bx,by;\n\t\tfor(int i=0;i<3;i++){\n\t\t\tfor(int j=0;j<3;j++){\n\t\t\t\tint num=3*i+j;\n\t\t\t\tif(num==s-'A'){\n\t\t\t\t\tsy=i;\tsx=j;\n\t\t\t\t}\n\t\t\t\tif(num==t-'A'){\n\t\t\t\t\tty=i;\ttx=j;\n\t\t\t\t}\n\t\t\t\tif(num==b-'A'){\n\t\t\t\t\tby=i;\tbx=j;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<20;i++)\n\t\t\tfor(int j=0;j<3;j++)\n\t\t\t\tfor(int k=0;k<3;k++)\n\t\t\t\t\tdp[i][j][k]=0;\n\t\tdp[0][sy][sx]=1;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\tfor(int x=0;x<3;x++){\n\t\t\t\t\tif(dp[i][y][x]==0)\tcontinue;\n\t\t\t\t\tfor(int l=0;l<4;l++){\n\t\t\t\t\t\tint ny=y+dy[l];\n\t\t\t\t\t\tint nx=x+dx[l];\n\t\t\t\t\t\tif(ny<0||3<=ny||nx<0||3<=nx){\n\t\t\t\t\t\t\tdp[i+1][y][x]+=dp[i][y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(bx==nx&&by==ny){\n\t\t\t\t\t\t\tdp[i+1][y][x]+=dp[i][y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[i+1][ny][nx]+=dp[i][y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.15lf\\n\",(double)dp[n][ty][tx]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <map>\nusing namespace std;\n\ndouble p[20][9];\nint n;\nchar s, t, b;\n\nvector<vector<int>> adj = {\n    {1,3,0,0},\n    {0,2,4,1},\n    {1,5,2,2},\n    {0,4,6,3},\n    {1,3,5,7},\n    {2,4,8,5},\n    {3,7,6,6},\n    {4,6,8,7},\n    {5,7,8,8}\n};\n\nint main() {\n    while (cin >> n, n) {\n        cin >> s >> t >> b;\n        for (int i=0; i<20; ++i) {\n            for (int j=0; j<9; ++j) {\n                p[i][j] = 0;\n            }\n        }\n        p[0][s - 'A'] = 1;\n        for (int i=0; i<n; ++i) {\n            for (int j=0; j<9; ++j) {\n                for (int k=0; k<4; ++k) {\n                    if (adj[j][k] == b - 'A') {\n                        p[i+1][j] += p[i][j] / 4.0;\n                    } else {\n                        p[i+1][adj[j][k]] += p[i][j] / 4.0;\n                    }\n                }\n            }\n        }\n        cout.width(8);\n        cout << fixed << p[n][t - 'A'] << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\nusing namespace std;\n\nconst int MAX = 16;\nconst int NUM = 9;\ndouble f[MAX][NUM];\n\nint main()\n{\t\n\tint n, s, t, b;\n\tchar ts, tt, tb;\n\twhile (cin >> n, n) {\n\t\tcin >> ts >> tt >> tb;\n\t\ts = ts - 'A';\n\t\tt = tt - 'A';\n\t\tb = tb - 'A';\n\t\t\n\t\tfill((double*)f, (double*)f +  MAX + NUM, 0);\n\t\tf[0][s] = 1.0;\n\t\t\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < NUM; j++) {\n\t\t\t\tif (j >= 3 && (j - 3) != b) f[i + 1][j - 3] += f[i][j] * 0.25;\n\t\t\t\telse f[i + 1][j] += f[i][j] * 0.25;\n\t\t\t\tif (j < 6 && (j + 3) != b) f[i + 1][j + 3] += f[i][j] * 0.25;\n\t\t\t\telse f[i + 1][j] += f[i][j] * 0.25;\n\t\t\t\tif (j % 3 != 0 && (j - 1) != b) f[i + 1][j - 1] += f[i][j] * 0.25;\n\t\t\t\telse f[i + 1][j] += f[i][j] * 0.25;\n\t\t\t\tif (j % 3 != 2 && (j + 1) != b) f[i + 1][j + 1] += f[i][j] * 0.25;\n\t\t\t\telse f[i + 1][j] += f[i][j] * 0.25;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\", f[n][t]);\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n\nusing namespace std;\n\ndouble prob[9];\nint global_block;\n\nint north(int x) {\n  if (x < 3 || global_block == x - 3)\n    return x;\n  else\n    return x - 3;\n}\nint east(int x) {\n  if (x % 3 == 2 || global_block == x + 1)\n    return x;\n  else\n    return x + 1;\n}\nint south(int x) {\n  if (x >= 6 || global_block == x + 3)\n    return x;\n  else\n    return x + 3;\n}\nint west(int x) {\n  if (x % 3 == 0 || global_block == x - 1)\n    return x;\n  else\n    return x - 1;\n}\n\nvoid find(int energy, double p, int pos, int target)\n{\n  //cout << \"find(\" << energy << \",\" << p << \",\" << pos << \",\" << target << \")\" << endl;\n  if (energy == 0) { prob[pos] += p; return; }\n  \n  find(energy - 1, p * 0.25, north(pos), target);\n  find(energy - 1, p * 0.25, west(pos),  target);\n  find(energy - 1, p * 0.25, south(pos), target);\n  find(energy - 1, p * 0.25, east(pos),  target);\n}\n\ndouble compute(int energy, int start, int target, int block)\n{\n  for (int i=0; i < 9; i++)\n    prob[i] = 0.0;\n  global_block = block;\n\n  find(energy - 1, 0.25, north(start), target);\n  find(energy - 1, 0.25, west(start),  target);\n  find(energy - 1, 0.25, south(start), target);\n  find(energy - 1, 0.25, east(start),  target);\n\n  return prob[target];\n}\n\nint main(void) \n{\n  while (true) {\n\n    int energy;\n    cin >> energy;\n    if (energy == 0) break;\n    char start, target, block;\n    cin >> start >> target >> block;\n    int s = start  - 'A';\n    int t = target - 'A';\n    int b = block  - 'A';\n    //cout << \"start = \" << s << \", target = \" << t << \", block = \" << b << endl;\n    cout << compute(energy, s, t, b) << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <sstream>\n#include <cassert>\n#include <list>\nusing namespace std;\nstatic const double EPS = 1e-10;\ntypedef long long ll;\ntypedef pair<int,int> PI;\ntypedef vector<int> vi;\n#ifndef M_PI\n#define M_PI 3.14159265358979323846\n#endif\n#define rep(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define F first\n#define S second\n\nint dx[]={0,1,0,-1},dy[]={1,0,-1,0};\n\n\nmain(){\n  int n;\n  int t=0;\n  while(cin>>n,n){\n    ++t;\n    //cout<<n<<endl;\n    //if(t>8)break;\n    double heya[3][3];\n    rep(i,3)rep(j,3)heya[i][j]=0;\n\n    char s,t,b;\n    cin>>s>>t>>b;\n    s-='A';\n    t-='A';\n    b-='A';\n\n    heya[s/3][s%3]=1;\n\n\n    while(n--){\n      //cout<<n<<endl;\n      if(n<0)break;\n      double next[3][3];\n      rep(i,3)rep(j,3)next[i][j]=0;\n\n      rep(i,9){\n\tint cx=i/3,cy=i%3;\n\n\trep(j,4){\n\t  int nx=cx+dx[j],ny=cy+dy[j];\n\t  if(nx<0 || 2<nx || ny<0 || 2<nx || nx*3+ny==b)next[cx][cy]+=heya[cx][cy]/4;\n\t  else next[nx][ny]+=heya[cx][cy]/4;\n\t}\n      }\n      memcpy(heya,next,sizeof(next));\n    }\n    printf(\"%.10f\\n\",heya[t/3][t%3]);\n  }\n}\n    "
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <sstream>\n#include <cassert>\n#include <list>\nusing namespace std;\nstatic const double EPS = 1e-10;\ntypedef long long ll;\ntypedef pair<int,int> PI;\ntypedef vector<int> vi;\n#ifndef M_PI\n#define M_PI 3.14159265358979323846\n#endif\n#define rep(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define F first\n#define S second\n\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\n\n\nmain(){\n  int n;\n\n  while(cin>>n,n){\n    long double heya[20][3][3]={{{0.0}}};\n\n    char s,t,b;\n    cin>>s>>t>>b;\n    s-='A';\n    t-='A';\n    b-='A';\n\n    heya[n][s/3][s%3]=1.0;\n\n\n    while(n--){\n\n      rep(i,9){\n\tint cx=i/3,cy=i%3;\n\n\trep(j,4){\n\t  int nx=cx+dx[j],ny=cy+dy[j];\n\t  if(nx<0 || 2<nx || ny<0 || 2<nx || (nx==b/3 && ny==b%3))heya[n][cx][cy]+=heya[n+1][cx][cy]/4.0;\n\t  else heya[n][nx][ny]+=heya[n+1][cx][cy]/4.0;\n\t}\n      }\n    }\n    printf(\"%.10Lf\\n\",heya[0][t/3][t%3]);\n  }\n}\n    "
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\nint dx[] = {-1, 0, 1,  0};\nint dy[] = { 0, 1, 0, -1};\n\nvoid solve()\n{\n\tint n;\n\twhile(cin >> n, n)\n\t{\n\t\tlong double dp[16][5][5] = {0.0};\n\t\tchar s, t, b;\n\t\tcin >> s >> t >> b;\n\t\tint sx, sy, gx, gy, bx, by;\n\t\tsy = (s-'A')/3 +1, sx = (s-'A')%3 +1;\n\t\tgy = (t-'A')/3 +1, gx = (t-'A')%3 +1;\n\t\tby = (b-'A')/3 +1, bx = (b-'A')%3 +1;\n\t\tchar Map[5][5];\n\t\tfor(int i = 0; i < 5; ++i)\n\t\t{\n\t\t\tfor(int j = 0; j < 5; ++j)\n\t\t\t{\n\t\t\t\tMap[i][j] = 'X';\n\t\t\t}\n\t\t}\n\t\tfor(int i = 1; i < 4; ++i)\n\t\t{\n\t\t\tfor(int j = 1; j < 4; ++j)\n\t\t\t{\n\t\t\t\tMap[i][j] = ' ';\n\t\t\t}\n\t\t}\n\t\tMap[by][bx] = 'X';\n\t\tdp[n][sy][sx] = 1.0;\n\t\twhile(n)\n\t\t{\n\t\t\tfor(int i = 1; i < 4; ++i)\n\t\t\t{\n\t\t\t\tfor(int j = 1; j < 4; ++j)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < 4; ++k)\n\t\t\t\t\t{\n\t\t\t\t\t\tint tx = j + dx[k];\n\t\t\t\t\t\tint ty = i + dy[k];\n\t\t\t\t\t\tif(Map[ty][tx] == 'X')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttx = j; ty = i;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdp[n - 1][ty][tx] += dp[n][i][j] / 4;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tn--;\n\t\t}\n\t\tprintf(\"%.8lf\\n\", dp[0][gy][gx]);\n\t}\n}\n\nint main()\n{\n\tsolve();\n\treturn(0);\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tchar n, s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\t//fx[i+'A']=i%3+1;\n\t\t//fy[i+'A']=i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d \", &n) , n ){\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\tchar m[5][5] = {0};\n\t\t/*for(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;*/\n\n\t\tif( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else{\n\t\t\t//solve( n , m );\n\t\t\t;\n\t\t}\n\t\t//debug( m );\n\t\t//printf(\"%.8f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <map>\n#include <queue>\nusing namespace std;\n\n\ntypedef pair<int, int> P;\ntypedef pair<int, P> P2;\n\nchar s, t, b, field[3][3];\nint n;\nint dx[] = {1, 0, -1, 0};\nint dy[] = {0, 1, 0, -1};\nmap<char, P> d1;\nmap<P, char> d2;\n\ndouble bfs(){\n  double cnt = 0, allcnt = 0;\n  P2 pos;\n  pos.first = n;\n  pos.second = d1[s];\n  queue<P2> que;\n  que.push(pos);\n  while(!que.empty()){\n    P2 p = que.front(); que.pop();\n    int x = p.second.first;\n    int y = p.second.second;   \n    if(p.first == 0){\n      if(d2[P(x, y)] == t){\n\tcnt++;\n\tallcnt++;\n      }\n      else allcnt++;\n    }\n    else{\n      for(int i = 0 ; i < 4 ; i++){\n\tint nx = p.second.first+dx[i];\n\tint ny = p.second.second+dy[i];\n\t\n\tif(d2[P(nx, ny)] == b){\n\t  que.push(P2(p.first-1, P(x, y)));\n\t}\n\telse que.push(P2(p.first-1, P(nx, ny)));\n      }\n    }\n  }\n  return double(cnt / allcnt);\n}\n\nint main(){\n  int c = 0;\n  for(int i = 0 ; i < 3 ; i++){\n    for(int j = 0 ; j < 3 ; j++){\n      d1['A'+c] = P(i, j);\n      d2[P(i, j)] = 'A'+c;\n      c++;\n    }\n  }\n  \n  while(cin >> n, n){\n    cin >> s >> t >> b;\n    printf(\"%.8f\\n\", bfs());\n  }\n}\n  "
  },
  {
    "language": "C++",
    "code": "#include<stdlib.h>\n#include<iostream>\n#include<stdio.h>\n#include<string.h>\n#include<math.h>\n#include<algorithm>\n#include<cstring>\n#include<queue>\nusing namespace std;\nint s,t,b,n;\ndouble p,p1,nn;\nint d[4]={1,3,-1,-3};\ndouble df[10][20];\nvoid dfs(int s,int n){\n    if(n==0){\n        if(s==t){p+=pow(0.25,nn);}\n        return;\n    }else{\n\t\tif(df[s][n]>=0){\n\t\t\tp+=df[s][n];\n\t\t\treturn;\n\t\t}else{\n\t\t    for(int i=0;i<4;i++){\n\t            if(s+d[i]==b){\n\t\t\t\t\tp1=p;\n\t\t\t\t    dfs(s,n-1);\n\t\t\t        df[s][n-1]=p-p1;\n\t\t        }else if((s/3!=(s+d[i])/3)||s+d[i]<0){\n\t\t\t\t    if((d[i]==3||d[i]==-3)&&0<=s+d[i]&&s+d[i]<9){\n\t\t\t\t        p1=p;\n\t\t\t\t\t\tdfs(s+d[i],n-1);\n\t\t\t\t\t    df[s+d[1]][n-1]=p-p1;\n\t\t\t\t    }else{\n\t\t\t            p1=p;\n\t\t                dfs(s,n-1);\n\t                    df[s][n-1]=p-p1;\n\t\t\t\t    }\n\t\t\t    }else{\n\t\t\t\t\t p1=p;\n\t\t\t\t    dfs(s+d[i],n-1);\n\t\t\t\t    df[s+d[i]][n-1]=p-p1;\n\t\t\t    }\n\t\t    }\n\t\t}\n\t}\n    return;\n}\n\nint main(){\n    while(1){\n        char cs,ct,cb;\n        p=0;\n        cin>>n;\n        nn=n;\n        if(n==0)break;\n        for(int i=0;i<10;i++){\n            for(int j=0;j<20;j++){\n                df[i][j]=-1;\n            }\n        }\n        cin>>cs>>ct>>cb;\n        s=(int)cs-'A';\n        t=(int)ct-'A';\n        b=(int)cb-'A';\n        dfs(s,n);\n        printf(\"%f\\n\",p);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int dx[] = {-1, 0, 0, 1};\nconst int dy[] = { 0,-1, 1, 0};\n\nint sx, sy, gx, gy, n, bx, by;\ndouble P[3][3][20];\n\nbool check(int x, int y){\n  return 0 <= x && x < 3 && 0 <= y && y < 3;\n}\n\nvoid solve(){\n  P[sy][sx][n] = 1;\n\n  queue<int> qx, qy, rem;\n  qx.push(sx), qy.push(sy), rem.push(n);\n\n  while(!qx.empty()){\n    int x = qx.front(); qx.pop();\n    int y = qy.front(); qy.pop();\n    int r = rem.front(); rem.pop();\n\n    if(r == 0) continue;\n\n    for(int i = 0 ; i < 4 ; i++){\n      int nx = x + dx[i];\n      int ny = y + dy[i];\n\n      if(!check(nx, ny) || (nx == bx && ny == by)){\n        P[y][x][r-1] += P[y][x][r] / 4;\n        qx.push(x), qy.push(y), rem.push(r-1);\n      }else{\n        P[ny][nx][r-1] += P[y][x][r] / 4;\n        qx.push(nx), qy.push(ny), rem.push(r-1);\n      }\n    }\n  }\n\n  printf(\"%.8f\\n\",P[gy][gx][0]);\n}\n\nint main(){\n  char s, t, b;\n  \n  while(cin >> n, n){\n    memset(P, 0, sizeof(P));\n\n    cin >> s >> t >> b;\n    int ss = s - 'A', tt = t - 'A', bb = b - 'A';\n    sx = ss%3; sy = ss/3;\n    gx = tt%3; gy = tt/3;\n    bx = bb%3; by = bb/3;\n    solve();\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <sstream>\n#include <cassert>\n#include <list>\nusing namespace std;\nstatic const double EPS = 1e-10;\ntypedef long long ll;\ntypedef pair<int,int> PI;\ntypedef vector<int> vi;\n#ifndef M_PI\n#define M_PI 3.14159265358979323846\n#endif\n#define rep(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define F first\n#define S second\n\nint dx[]={0,1,0,-1},dy[]={1,0,-1,0};\n\n\nmain(){\n  int n;\n  int t=0;\n  while(cin>>n,n){\n    ++t;\n    //cout<<n<<endl;\n    //if(t>8)break;\n    long double heya[3][3];\n    rep(i,3)rep(j,3)heya[i][j]=0.0;\n\n    char s,t,b;\n    cin>>s>>t>>b;\n    s-='A';\n    t-='A';\n    b-='A';\n\n    heya[s/3][s%3]=1.0;\n\n\n    while(n--){\n      //cout<<n<<endl;\n\n      long double next[3][3];\n      rep(i,3)rep(j,3)next[i][j]=0.0;\n\n      rep(i,9){\n\tint cx=i/3,cy=i%3;\n\n\trep(j,4){\n\t  int nx=cx+dx[j],ny=cy+dy[j];\n\t  if(nx<0 || 2<nx || ny<0 || 2<nx || (nx==b/3 && ny==b%3))next[cx][cy]+=heya[cx][cy]/4.0;\n\t  else next[nx][ny]+=heya[cx][cy]/4.0;\n\t}\n      }\n      rep(i,9)heya[i/3][i%3]=next[i/3][i%3];\n    }\n    printf(\"%.8Lf\\n\",heya[t/3][t%3]);\n  }\n}\n    "
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n)for(ll i=0;i<n;i++)\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char, ll>P;\n\nchar dir[4][4]{ \"ABC\",\"DEF\",\"GHI\" };\nll dx[]{ 1,-1,0,0 }, dy[]{ 0,0,1,-1 };\nint main() {\n\tll n;\n\twhile (cin >> n, n) {\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tll sum = 0, cnt = 0;\n\t\tqueue<P>que;\n\t\tque.push(P(s, n));\n\t\twhile (!que.empty()) {\n\t\t\tP p = que.front(); que.pop();\n\t\t\tif (!p.second) {\n\t\t\t\tsum++;\n\t\t\t\tif (p.first == t)cnt++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tll x = (p.first - 'A') / 3, y = (p.first - 'A') % 3;\n\t\t\trep(i, 4) {\n\t\t\t\tll nx = x + dx[i], ny = y + dy[i];\n\t\t\t\tif (nx < 0 || nx >= 3 || ny < 0 || ny >= 3 || dir[nx][ny] == b) {\n\t\t\t\t\tnx = x; ny = y;\n\t\t\t\t}\n\t\t\t\tque.push(P(dir[nx][ny], p.second - 1));\n\t\t\t}\n\t\t}\n\t\tif (sum == 0)puts(\"0.00000000\");\n\t\telse printf(\"%.7lf\\n\", (double)cnt / (double)sum);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define r(i,n) for(int i=0;i<n;i++)\nint dx[]={0,0,-1,1};\nint dy[]={1,-1,0,0};\nmain(){\n  string s[3];\n  int n;\n  double a[16][3][3];\n  while(cin>>n,n){\n    memset(a,0,sizeof(a));\n    r(i,3)cin>>s[i];\n    r(i,15)a[i][(s[2][0]-'A')/3][(s[2][0]-'A')%3]=-1;\n    a[0][(s[0][0]-'A')/3][(s[0][0]-'A')%3]=1;\n    r(k,n)r(i,3)r(j,3)if(a[k][i][j]>0)r(l,4){\n      int y=i+dy[l],x=j+dx[l];\n      if(y<0||y>=3||x<0||x>=3)a[k+1][i][j]+=a[k][i][j]/4;\n      else if(a[k][y][x]==-1)a[k+1][i][j]+=a[k][i][j]/4;\n      else a[k+1][y][x]+=a[k][i][j]/4;\n    }\n    printf(\"%.9f\\n\",a[n][(s[1][0]-'A')/3][(s[1][0]-'A')%3]);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <queue>\n\nusing namespace std;\n\nconst int EMPTY   = 0;\nconst int BATTERY = 1;\nconst int STORE   = 2;\nconst int WALL    = 3;\n\nstruct Point {\npublic:\n  int x, y;\n  Point() { }\n  Point(int x, int y): x(x), y(y) { }\n};\n\nstruct State {\npublic:\n  Point p;\n  int battery;\n  State() { };\n  State(Point p, int battery): p(p), battery(battery) { }\n};\n\nPoint int2point(int n) {\n  return Point(1 + n % 3, 1 + n / 3);\n}\n\nint main() {\n  int n, s, t, b;\n  while (true) {\n    cin >> n;\n    if (n == 0) break;\n    char cs, ct, cb;\n    cin >> cs >> ct >> cb;\n    int count = 0, count2 = 0;\n    s = cs - 'A';\n    t = ct - 'A';\n    b = cb - 'A';\n    \n    int field[5][5];\n    memset(field, EMPTY, sizeof(field));\n    for (int i = 0; i < 5; i++) {\n      field[0][i] = WALL;\n      field[4][i] = WALL;\n      field[i][0] = WALL;\n      field[4][i] = WALL;\n    }\n    Point batteryPoint = int2point(t);\n    field[batteryPoint.x][batteryPoint.y] = BATTERY;\n    Point storePoint = int2point(b);\n    field[storePoint.x][storePoint.y] = STORE;\n    State nowState(int2point(s), n);\n    queue<State> q;\n    q.push(nowState);\n    \n    while (!q.empty()) {\n      State s = q.front(); q.pop();\n      if (s.battery == 0) {\n        if (field[s.p.x][s.p.y] == BATTERY) {\n          count2++;\n        }\n        count++;\n        continue;\n      }\n      int dx[4] = { 0, -1, 1, 0 };\n      int dy[4] = { -1, 0, 0, 1 };\n      for (int i = 0; i < 4; i++) {\n        Point np = Point(s.p.x + dx[i], s.p.y + dy[i]);\n        if (field[np.x][np.y] == STORE) {\n          q.push(State(s.p, s.battery - 1));\n          continue;\n        }\n        if (field[np.x][np.y] == WALL) {\n          q.push(State(s.p, s.battery - 1));\n          continue;\n        }\n        q.push(State(np, s.battery - 1));\n      }\n    }\n    printf(\"%.15lf\\n\", (double)count2 / count);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <math.h>\n#include <map>\n#include <iomanip>\n#include <vector>\n#include <queue>\n#include <set>\n#define PI 3.14159265359\n#define INF 99999999;\n#define rep(i, n) for(int i=0; i<n; i++)\n#define REP(n) rep(i, n)\n#define EPS 1e-10\ntypedef long long ll;\nusing namespace std;\n\n\n\n/*\nclass Target\n{\npublic:\n\tvector <string> draw(int n)\n\t{\n\n\t}\n};\n*/\n\nint n;\nchar s, t, b;\n\n//(y, x)\npair<int, int> getPos(char c)\n{\n\tswitch (c)\n\t{\n\tcase 'A':\n\t\treturn make_pair(0, 0);\n\t\tbreak;\n\tcase 'B':\n\t\treturn make_pair(0, 1);\n\t\tbreak;\n\tcase 'C':\n\t\treturn make_pair(0, 2);\n\t\tbreak;\n\tcase 'D':\n\t\treturn make_pair(1, 0);\n\t\tbreak;\n\tcase 'E':\n\t\treturn make_pair(1, 1);\n\t\tbreak;\n\tcase 'F':\n\t\treturn make_pair(1, 2);\n\t\tbreak;\n\tcase 'G':\n\t\treturn make_pair(2, 0);\n\t\tbreak;\n\tcase 'H':\n\t\treturn make_pair(2, 1);\n\t\tbreak;\n\tcase 'I':\n\t\treturn make_pair(2, 2);\n\t\tbreak;\n\t}\n}\n\nint vx[] = {1, -1, 0, 0};\nint vy[] = {0, 0, 1, -1};\nint tx, ty, bx, by;\n\ndouble dfs(int x, int y, int n)\n{\n\tif (n == 0 && x == tx && y == ty) return 1;\n\tif (n == 0) return 0;\n\t\n\tdouble ret = 0;\n\tfor (int i=0; i<4; i++)\n\t{\n\t\tint nx = x + vx[i];\n\t\tint ny = y + vy[i];\n\t\tif (0 <= nx && nx <= 2 && 0 <= ny && ny <= 2)\n\t\t{\n\t\t\tif (nx == bx && ny == by)\n\t\t\t{\n\t\t\t\tret += dfs(x, y, n - 1) * 0.25;\n\t\t\t} else {\n\t\t\t\tret += dfs(nx, ny, n - 1) * 0.25;\n\t\t\t}\n\t\t} else {\n\t\t\tret += dfs(x, y, n - 1) * 0.25;\n\t\t}\n\t}\n\t\n\treturn ret;\n}\n\nint main()\n{\n\t\n\twhile (cin >> n, n)\n\t{\n\t\tcin >> s >> t >> b;\n\t\tint sx = getPos(s).second;\n\t\tint sy = getPos(s).first;\n\t\ttx = getPos(t).second;\n\t\tty = getPos(t).first;\n\t\tbx = getPos(b).second;\n\t\tby = getPos(b).first;\n\t\tcout << fixed << setprecision(8);\n\t\tcout << dfs(sx, sy, n) << endl;\n\t}\n\t\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cmath>\nusing namespace std;\n\nint n;\nint dp[16][4][4];\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nint fie[4][4];\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d%*c\",&n);\n\t\tif(n==0)break;\n\t\tchar a,b,c;\n\t\tscanf(\"%c %c %c\",&a,&b,&c);\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdp[0][(a-'A')%3][(a-'A')/3]=1;\n\t\tmemset(fie,0,sizeof(fie));\n\t\tfie[(c-'A')%3][(c-'A')/3]=-1;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int j=0;j<3;j++){\n\t\t\t\tfor(int k=0;k<3;k++){\n\t\t\t\t\tif(dp[i][j][k]>=1){\n\t\t\t\t\t\tfor(int l=0;l<4;l++){\n\t\t\t\t\t\t\tint nx=j+dx[l],ny=k+dy[l];\n\t\t\t\t\t\t\tif(nx>=0 && nx<3 && ny>=0 && ny<3 && fie[nx][ny]==0){\n\t\t\t\t\t\t\t\tdp[i+1][nx][ny]+=dp[i][j][k];\n\t\t\t\t\t\t\t}else dp[i+1][j][k]+=dp[i][j][k];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.10f\\n\",(double)dp[n][(b-'A')%3][(b-'A')/3]/pow(4,n));\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<cstring>\n#include<string>\nusing namespace std;\nchar fie[4][4]={\"ABC\",\n\t\t\"DEF\",\n\t\t\"GHI\"};\nint N;\nchar s,t,b;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\ndouble dp[16][4][4];\nint used[16][4][4];\ndouble solve(int no,int x,int y){\n  if(no==N){\n    if(fie[y][x]==t) return 1.0f;\n    return 0.0f;\n  }\n  if(used[no][x][y]) return dp[no][x][y];\n  double ret=0.0f;\n  for(int i=0;i<4;i++){\n    int nx = x+dx[i],ny = y+dy[i];\n    if( nx < 0 || ny < 0 || nx>=3 || ny>=3 || fie[ny][nx]==b){\n      ret += solve(no+1,x,y)/4.0f;\n    } else{\n      ret += solve(no+1,nx,ny)/4.0f;\n    }\n  }\n  used[no][x][y]=1;\n  return dp[no][x][y]=ret;\n}\nint main(){\n  while(1){\n    int x,y;\n    cin >> N;\n    if(!N) break;\n    memset(used,0,sizeof(used));\n    cin >> s >> t >> b;\n    for(int i=0;i<3;i++)\n      for(int j=0;j<3;j++)\n\tif(fie[i][j]==s){\n\t  x=j; y=i;\n\t}\n    printf(\"%.9lf\\n\",solve(0,x,y));\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n\nusing namespace std;\n\nint b_row,b_col,memo[16][3][3];\n\nchar b[2];\n\nbool rangeCheck(int row,int col){\n\tif(row >= 0 && row <= 2 && col >= 0 && col <= 2)return true;\n\telse{\n\t\treturn false;\n\t}\n}\n\nint translate(char ch){\n\tswitch(ch){\n\tcase 'A':return 0;\n\tcase 'B':return 1;\n\tcase 'C':return 2;\n\tcase 'D':return 10;\n\tcase 'E':return 11;\n\tcase 'F':return 12;\n\tcase 'G':return 20;\n\tcase 'H':return 21;\n\tcase 'I':return 22;\n\t}\n\n\treturn -1; //must not reach here.\n}\n\nint main(){\n\n\tint n,tmp,energy_row,energy_col,row,col;\n\tchar start[2],energy[2];\n\n\twhile(true){\n\t\tscanf(\"%d\",&n);\n\t\tif(n == 0)break;\n\n\t\tfor(int i = 0; i < 16; i++){\n\t\t\tfor(int p = 0; p < 3; p++){\n\t\t\t\tfor(int k = 0; k < 3; k++)memo[i][p][k] = 0;\n\t\t\t}\n\n\t\t}\n\n\t\tscanf(\"%s %s %s\",start,energy,b);\n\n\t\ttmp = translate(b[0]);\n\t\tb_row = tmp/10;\n\t\tb_col = tmp%10;\n\n\t\ttmp = translate(energy[0]);\n\t\tenergy_row = tmp/10;\n\t\tenergy_col = tmp%10;\n\n\t\ttmp = translate(start[0]);\n\n\t\trow = tmp/10,col = tmp%10;\n\n\t\tif(rangeCheck(row,col-1) == true && (row != b_row || col-1 != b_col)){\n\t\t\tmemo[1][row][col-1] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] += 1;\n\t\t}\n\n\t\tif(rangeCheck(row,col+1) == true && (row != b_row || col+1 != b_col)){\n\t\t\tmemo[1][row][col+1] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] += 1;\n\t\t}\n\n\t\tif(rangeCheck(row-1,col) == true && (row-1 != b_row || col != b_col)){\n\t\t\tmemo[1][row-1][col] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] += 1;\n\t\t}\n\n\t\tif(rangeCheck(row+1,col) == true && (row+1 != b_row || col != b_col)){\n\t\t\tmemo[1][row+1][col] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] += 1;\n\t\t}\n\n\t\tfor(int loop = 2; loop <= n; loop++){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tif(i == b_row && k == b_col){\n\t\t\t\t\t\tmemo[loop][i][k] = 0;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(i == 0 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][0][0] = 2*memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][0][0] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][0][0] += memo[loop-1][1][0];\n\t\t\t\t\t\t}else if(i == 0 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][0][1] = memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 0)memo[loop][0][1] += memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][0][1] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 2)memo[loop][0][1] += memo[loop-1][0][2];\n\t\t\t\t\t\t}else if(i == 0 && k == 2){\n\t\t\t\t\t\t\tmemo[loop][0][2] = 2*memo[loop-1][0][2];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][0][2] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][0][2] += memo[loop-1][1][2];\n\t\t\t\t\t\t}else if(i == 1 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][1][0] = memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 0)memo[loop][1][0] += memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][1][0] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 0)memo[loop][1][0] += memo[loop-1][2][0];\n\t\t\t\t\t\t}else if(i == 1 && k == 1){\n\t\t\t\t\t\t\tif(b_row == 1 || b_col == 1){ //????????????????§??????§???????????????????????´?????¨????????????????????§??????????????????????¶??????????????????????\n\t\t\t\t\t\t\t\tmemo[loop][1][1] = memo[loop-1][1][1];\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][1][1] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][1][1] += memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][1][1] += memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][1][1] += memo[loop-1][2][1];\n\t\t\t\t\t\t}else if(i == 1 && k == 2){\n\t\t\t\t\t\t\tmemo[loop][1][2] = memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 2)memo[loop][1][2] += memo[loop-1][0][2];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][1][2] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 2)memo[loop][1][2] += memo[loop-1][2][2];\n\t\t\t\t\t\t}else if(i == 2 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][2][0] = 2*memo[loop-1][2][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][2][0] += memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][2][0] += memo[loop-1][2][1];\n\t\t\t\t\t\t}else if(i == 2 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][2][1] = memo[loop-1][2][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 0)memo[loop][2][1] += memo[loop-1][2][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][2][1] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 2)memo[loop][2][1] += memo[loop-1][2][2];\n\t\t\t\t\t\t}else{ //i == 2 && k == 2\n\t\t\t\t\t\t\tmemo[loop][2][2] = 2*memo[loop-1][2][2];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][2][2] += memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][2][2] += memo[loop-1][2][1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\",((double)memo[n][energy_row][energy_col])/((double)pow(4,n)));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\nusing namespace std;\nint n,s,t,b;\nint kai[16][9];\nbool visited[16][9];\nint dx[]={0,1,0,-1},dy[]={-3,0,3,0};\n\nvoid dfs(int p,int e){\n  visited[e][p]=1;\n  if(e==n){\n    if(p==t)kai[e][p]=1;\n    return;\n  }\n  for(int i=0;i<4;i++){\n    int np=p+dx[i]+dy[i];\n    if(dx[i]+p%3<0||dx[i]+p%3>=3||np<0||9<=np||np==b)np=p;\n    if(!visited[e+1][np])dfs(np,e+1);\n    kai[e][p]+=kai[e+1][np];\n  }\n}\n\nint main(){\n  while(cin>>n&&n!=0){\n    char sc,tc,bc;\n    for(int i=0;i<16;i++)for(int j=0;j<9;j++)kai[i][j]=0,visited[i][j]=0;\n    cin>>sc>>tc>>bc;\n    s=sc-'A',t=tc-'A',b=bc-'A';\n    dfs(s,0);\n    cout<<1.0*kai[0][s]/(1<<(n*2))<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <sstream>\n#include <cassert>\n#include <list>\nusing namespace std;\nstatic const double EPS = 1e-10;\ntypedef long long ll;\ntypedef pair<int,int> PI;\ntypedef vector<int> vi;\n#ifndef M_PI\n#define M_PI 3.14159265358979323846\n#endif\n#define rep(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define F first\n#define S second\n\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\n\n\nmain(){\n  int n;\n\n  while(cin>>n,n){\n    long double heya[20][3][3]={{{0.0}}};\n\n    char s,t,b;\n    cin>>s>>t>>b;\n    s-='A';\n    t-='A';\n    b-='A';\n\n    heya[0][s/3][s%3]=1.0;\n    //cout<<n<<\" \"<<s/3<<\" \"<<s%3<<endl;\n\n\n    rep(k,n){\n\n      rep(i,9){\n\tint cx=i/3,cy=i%3;\n\n\trep(j,4){\n\t  int nx=cx+dx[j],ny=cy+dy[j];\n\t  if(nx<0 || 2<nx || ny<0 || 2<ny || (nx==b/3 && ny==b%3))heya[k+1][cx][cy]+=heya[k][cx][cy]/4.0;\n\t  else heya[k+1][nx][ny]+=heya[k][cx][cy]/4.0;\n\t}\n      }\n    }\n\n    printf(\"%.10Lf\\n\",heya[n][t/3][t%3]);\n  }\n}\n    "
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tchar n, s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A']=i%3+1;\n\t\tfy[i+'A']=i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d\", &n) , n ){\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\tchar m[5][5] = {0};\n\t\t/*for(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;*/\n\n\t\tif( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else{\n\t\t\t//solve( n , m );\n\t\t\t;\n\t\t}\n\t\t//debug( m );\n\t\t//printf(\"%.8f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<vector>\n#include<algorithm>\nusing namespace std;\nconst int dx[]={0,-1,0,1};\nconst int dy[]={-1,0,1,0};\nint main(){\n    int n;\n    while(cin>>n,n){\n        char s,t,b;\n        cin>>s>>t>>b;\n        int dp[2][3][3];\n        fill_n(**dp,18,0);\n        s-='A';t-='A';b-='A';\n        dp[0][s/3][s%3]=1;\n        for(int k=0;k<n;k++){\n            for(int i=0;i<3;i++){\n                for(int j=0;j<3;j++){\n                    for(int l=0;l<4;l++){\n                        int ty=i+dy[l];\n                        int tx=j+dx[l];\n                        if(tx<0||tx>=3||ty<0||ty>=3||ty*3+tx==b){\n                            dp[(k+1)&1][i][j]+=dp[k&1][i][j];\n                        }\n                        else dp[(k+1)&1][ty][tx]+=dp[k&1][i][j];\n                    }\n                    dp[k&1][i][j]=0;\n                }\n            }\n        }\n        int sum=0;\n        for(int i=0;i<3;i++)\n            for(int j=0;j<3;j++)\n                sum+=dp[n&1][i][j];\n\n        cout<<fixed<<(double)dp[n&1][t/3][t%3]/sum<<endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <utility>\n\nusing namespace std;\n\nvoid decode(char c, int &x, int &y) {\n    x = (c-'A')/3;\n    y = (c-'A')%3;\n}\n\nconst int d[4][2] = {\n    {1, 0}, {-1, 0}, {0, 1}, {0, -1}\n};\n\npair<int,int> memo[16][3][3];\npair<int, int> dfs(int n, int x, int y, int tx, int ty, int bx, int by) {\n    if(memo[n][x][y].first != -1) return memo[n][x][y];\n\n    if(x == bx && y == by) return memo[n][x][y] = make_pair(0, 1);\n    if(n == 0) {\n        if(x == tx && y == ty) return memo[n][x][y] = make_pair(1, 1);\n        else return memo[n][x][y] = make_pair(0, 1);\n    }\n    pair<int, int> cnt = make_pair(0, 0);\n    for(int i = 0; i < 4; ++i) {\n        int nx = x + d[i][0];\n        int ny = y + d[i][1];\n        pair<int,int> tmp;\n        if(nx < 0 || 3 <= nx || ny < 0 || 3 <= ny || (nx == bx && ny == by)) tmp = dfs(n-1, x, y, tx, ty, bx, by);\n        else tmp = dfs(n-1, nx, ny, tx, ty, bx, by);\n        cnt.first += tmp.first;\n        cnt.second += tmp.second;\n    }\n    return memo[n][x][y] = cnt;\n}\n\nint main() {\n    while(true) {\n        int N;\n        cin >> N;\n        if(!N) break;\n        char S, T, B;\n        cin >> S >> T >> B;\n\n        int x, y;\n        int tx, ty;\n        int bx, by;\n        decode(S, x, y);\n        decode(T, tx, ty);\n        decode(B, bx, by);\n\n        for(int i = 0; i <= 15; ++i)\n            for(int j = 0; j < 3; ++j)\n                for(int k = 0; k < 3; ++k)\n                    memo[i][j][k] = make_pair(-1, -1);\n        pair<int, int> cnt = dfs(N, x, y, tx, ty, bx, by);\n        printf(\"%.10f\\n\", (double)cnt.first / cnt.second);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int dx[] = {-1, 0, 0, 1};\nconst int dy[] = { 0,-1, 1, 0};\n\nint sx, sy, gx, gy, n, bx, by;\ndouble P[3][3];\n\nbool check(int x, int y){\n  return 0 <= x && x < 3 && 0 <= y && y < 3;\n}\n\nvoid solve(){\n  P[sy][sx] = 1;\n\n  queue<int> qx, qy, rem;\n  qx.push(sx), qy.push(sy), rem.push(n);\n\n  while(!qx.empty()){\n    int x = qx.front(); qx.pop();\n    int y = qy.front(); qy.pop();\n    int r = rem.front(); rem.pop();\n\n    if(x == gx && y == gy) break;\n    if(r == 0) continue;\n\n    for(int i = 0 ; i < 4 ; i++){\n      int nx = x + dx[i];\n      int ny = y + dy[i];\n\n      if(!check(nx, ny) || (nx == bx && ny == by)){\n        qx.push(nx), qy.push(ny), rem.push(r-1);\n      }else{\n        P[ny][nx] += P[y][x] / 4;\n        qx.push(nx), qy.push(ny), rem.push(r-1);\n      }\n    }\n  }\n\n  printf(\"%.8f\\n\",P[gy][gx]);\n}\n\nint main(){\n  char s, t, b;\n  \n  while(cin >> n, n){\n    memset(P, 0, sizeof(P));\n\n    cin >> s >> t >> b;\n    int ss = s - 'A', tt = t - 'A', bb = b - 'A';\n    sx = ss%3; sy = ss/3;\n    gx = tt%3; gy = tt/3;\n    bx = bb%3; by = bb/3;\n    solve();\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define rep(i,n) for(int i=0;i<n;i++)\n#define ck(a) (0<=(a)&&(a)<9)\nusing namespace std;\nint di[]={-3,-1,1,3};\nint main(){\n\tint n,s,t,b; char cs,ct,cb;\n\twhile(cin>>n,n){\n\t\tcin>>cs>>ct>>cb; s=cs-'A', t=ct-'A', b=cb-'A';\n\t\tdouble p[9]={0}; p[s]=1;\n\t\t\n\t\twhile(n--){\n\t\t\tdouble q[9]={0};\n\t\t\tfor(int i=0;i<9;i++)for(int d=0;d<4;d++){\n\t\t\t\tif(ck(i+di[d])&&i+di[d]!=b)q[i+di[d]]+=p[i]/4;\n\t\t\t\telse q[i]+=p[i]/4;\n\t\t\t}\n\t\t\tfor(int i=0;i<9;i++)p[i]=q[i];\n\t\t}\n\t\t\n\t\tcout<<p[t]<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "# include <iostream>\n# include <algorithm>\n# include <vector>\n# include <string>\n# include <set>\n# include <map>\n# include <cmath>\n# include <iomanip>\n# include <functional>\n# include <utility>\n# include <stack>\n# include <queue>\n# include <list>\nusing namespace std;\nusing LL = long long;\nconstexpr int MOD = 1000000000 + 7;\nconstexpr int INF = 2000000000;\nconst double PI = acos(-1);\n\n\nint n;\nchar s, t, b;\npair<int, int> S, T, B;\ndouble dp[16][3][3];\n\nint dx[] = { 0,1,0,-1 }, dy[] = { -1,0,1,0 };\n\nint main() {\n\twhile (cin >> n&&n) {\n\t\tcin >> s >> t >> b;\n\t\tS = make_pair((s - 'A') / 3, (s - 'A') % 3);\n\t\tT = make_pair((t - 'A') / 3, (t - 'A') % 3);\n\t\tB = make_pair((b - 'A') / 3, (b - 'A') % 3);\n\t\tstd::memset(dp, 0.0, sizeof(dp));\n\t\tdp[0][S.first][S.second] = 1;\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int y = 0; y < 3; y++) {\n\t\t\t\tfor (int x = 0; x < 3; x++) {\n\t\t\t\t\tif (dp[i][y][x] == 0)continue;\n\t\t\t\t\tfor (int d = 0; d < 4; d++) {\n\t\t\t\t\t\tint ny = y + dy[d], nx = x + dx[d];\n\t\t\t\t\t\tif (0 <= nx&&nx < 3 && 0 <= ny&&ny < 3 && make_pair(ny, nx) != B)dp[i + 1][ny][nx] += dp[i][y][x] * 0.25;\n\t\t\t\t\t\telse dp[i + 1][y][x] += dp[i][y][x] * 0.25;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << fixed << setprecision(10) << dp[n][T.first][T.second] << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tint n;\n\tchar s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A'] = i%3+1;\n\t\tfy[i+'A'] = i/3+1;\n\t}\n\t\n\t//while( scanf(\"%d\", &n) , n ){\n\twhile( cin >> n , n ){\n\t\t//scanf(\" %c %c %c \", &s, &t, &b);\n\t\tcin >> s >> t >> b;\n\t\tchar m[5][5] = {0};\n\t\tfor(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;\n\t\t\n\t\tsolve( n , m );\n\t\t\n\t\t//debug( m );\n\t\tprintf(\"%.10f\\n\" , m[ fy[t] ][ fx[t] ] / pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include <iostream>\nusing namespace std;\n\nint main() {\n\twhile (1) {\n\t\tint n, s, t, b, sum = 0;\n\t\tint ai[16][3][3] = { 0 };\n\t\tchar a, d, c;\n\t\tscanf(\"%d\", &n);\n\t\tif (n == 0) break;\n\t\tcin >> a >> d >> c;\n\t\ts = a - 'A';  t = d - 'A'; b = c - 'A';\n\t\tai[0][s / 3][s % 3] = 1;\n\t\tfor (int i = 1; i <= n; ++i) {\n\t\t\tfor (int j = 0; j < 3; ++j) {\n\t\t\t\tfor (int l = 0; l < 3; ++l) {\n\t\t\t\t\tif (j - 1 >= 0 && (j-1) * 3 + l != b) ai[i][j - 1][l] += ai[i - 1][j][l];\n\t\t\t\t\telse ai[i][j][l] += ai[i - 1][j][l];\n\t\t\t\t\tif (j + 1 < 3 && (j + 1) * 3 + l != b) ai[i][j + 1][l] += ai[i - 1][j][l];\n\t\t\t\t\telse ai[i][j][l] += ai[i - 1][j][l];\n\n\t\t\t\t\tif (l - 1 >= 0 && j * 3 + l - 1 != b) ai[i][j][l - 1] += ai[i - 1][j][l];\n\t\t\t\t\telse ai[i][j][l] += ai[i - 1][j][l];\n\t\t\t\t\tif (l + 1 < 3 && j * 3 + l + 1 != b) ai[i][j][l + 1] += ai[i - 1][j][l];\n\t\t\t\t\telse ai[i][j][l] += ai[i - 1][j][l];\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (int i = 0; i < 3; ++i) {\n\t\t\tfor (int j = 0; j < 3; ++j) {\n\t\t\t\tsum += ai[n][i][j];\n\t\t\t}\n\t\t}\n\t\tprintf(\"%f\\n\", (double)ai[n][t / 3][t % 3] / sum);\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstring>\n#include <iomanip>\n#include <iostream>\nusing namespace std;\nint n, b1, b2, b3, dr[4] = { -3, -1, 1, 3 }; char c1, c2, c3; double dp[19][9];\nint main() {\n\twhile (cin >> n, n) {\n\t\tcin >> c1 >> c2 >> c3;\n\t\tb1 = c1 - 65, b2 = c2 - 65, b3 = c3 - 65;\n\t\tmemset(dp, 0, sizeof(dp));\n\t\tdp[0][b1] = 1;\n\t\tfor (int i = 1; i <= n; i++) {\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tint r[4] = { 0 }, c = 0;\n\t\t\t\tfor (int k = 0; k < 4; k++) {\n\t\t\t\t\tint u = j + dr[k];\n\t\t\t\t\tif (u < 0 || u > 8 || j % 3 + u % 3 == 2 || u == b3) continue;\n\t\t\t\t\tr[c++] = u + 1;\n\t\t\t\t}\n\t\t\t\tfor (int k = 0; k < c; k++) {\n\t\t\t\t\tdp[i][r[k] - 1] += dp[i - 1][j] / c;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << fixed << setprecision(15) << dp[n][b2] << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\nusing namespace std;\n\nint y11(int);\nint x11(int);\n\n    int main(){\n\n\tint n;\n\tchar st,ba,sto;\n\tdouble dx[] = {0.0,1.0,0.0,-1.0};\n\tdouble dy[] = {1.0,0.0,-1.0,0.0};\n\tint ma[3][3] = {{0,0,0},\n                       {0,0,0},\n                       {0,0,0}};\n\n\twhile(true){\n\t  cin >> n;\n\t   long double dp[15][4][4];\n\t    for(int i=0;i<15;i++)for(int j=0;j<4;j++)for(int k=0;k<4;k++)dp[i][j][k]=0.0;\n\t    if(n == 0)break;\n\t    cin >> st;\n\t    cin >> ba;\n\t    cin >> sto;\n\t    ma[y11(st)][x11(st)]=4;//X^[g\n\t    ma[y11(ba)][x11(ba)]=9;//[d\n\t    ma[y11(sto)][x11(sto)]=8;//qÉ\n\n\t    int nx,ny;\n\t    dp[n][y11(st)][x11(st)]=1.0;\n\t   \n\n\t    while(true){\n\t\tif(n ==  0)break;\n\t\n\t\t/*\t\t\n\t\tcout << \"n = \" << n << endl;\n\t\tfor(int g=0;g<3;g++){\n\t\t  for(int f=0;f<3;f++){\n\t\t    cout << dp[n][g][f] << \" \";\n\t\t  }\n\t\t  cout << endl;\n\t\t} \n\t\tcout << endl;\n*/\n\n\t\tfor(int t=0;t<=2;t++){\n\t\t    for(int g =0 ;g<=2;g++){\n\t\t\tfor(int i=0;i<4;i++){\n\t\t\t    nx = g+dx[i];\n\t\t\t    ny = t+dy[i];\t\t    \n\t\t\t    if(nx>2 || ny>2 ||nx<0 || ny<0){nx = g; ny =t;}\n\t\t\t    if(nx == x11(sto) && ny == y11(sto)){nx = g;\n\t\t\t\tny = t;\n\t\t\t    }\n\t\t\t    dp[n-1][ny][nx] += dp[n][t][g]/4.0;\t\t    \n\t\t\t}\n\t\t    }\n\t\t}\n\t\tn--;\n\n\t    }\n \n\t    // ----------------DEBUG--------------//\n\t    \n\n\t    /*\n\t\tfor(int g=0;g<3;g++){\n\t\t    for(int f=0;f<3;f++){\n\t\t    cout << dp[0][g][f] << \" \";\n\t\t    }\n\t\t    cout << endl;\n\t\t} \n\t    */\n\t\t\n\t    //----------------DEBUG---------------//\n\t    //   DecimalFormat dc = new DecimalFormat();\n\t \n\t    printf(\"%.8Lf\\n\",dp[0][y11(ba)][x11(ba)]);\n\n\n\t      }\n\n\n    }\n\n    \n\n    int y11(int s){\n      if(s == 'A')return 0;\n\tif(s == 'B')return 0;\n\tif(s=='C')return 0;\n\tif(s=='D')return 1;\n\tif(s=='E')return 1;\n\tif(s=='F')return 1;\n\tif(s=='G')return 2;\n\tif(s=='H')return 2;\n\tif(s =='I')return 2;\n\treturn 0;\n\t\n    }\n    int x11(int s){\n\tif(s=='A')return 0;\n\tif(s=='B')return 1;\n\tif(s=='C')return 2;\n\tif(s=='D')return 0;\n\tif(s=='E')return 1;\n\tif(s=='F')return 2;\n\tif(s=='G')return 0;\n\tif(s=='H')return 1;\n\tif(s=='I')return 2;\n\treturn 0;\n\n    }\n\n\n\n\n\n\n\n/*@Yê½Ì´êpðà\n\nQ:3d[vÌÆ±ÈÉµÄñÌH\nA:®SÌðÝÄ(n-i)ñ(i=0,1,EEE,n Å n=0Ìnñ®¢½Ê n=nÌ1ñ®¢½Ê)ÌÊð¾µÄé\nµ¢m¦Å®­©ç1ñ®¢½ç4ÅêÎ¢¢\n\nàµ±êæñÅàí©çÈ¢pÈçvOÌDEBUGð\\¦³¹Ä®«ðmFµÄÝéÆ¢¢\nn=0ÆÈÁÄ¢é©çwè³ê½ñ®¢½Êð\\¦·éæ¤ÉÈÁÄ¢é\n\n*/"
  },
  {
    "language": "C++",
    "code": "\n#include <iostream>\n\nusing namespace std;\n\nint n;\nchar room[10] = \"ABCDEFGHI\";\nchar s, t, b;\nint off[4][2] = {{-1, 0}, {1, 0}, {0, -1}, {0, 1}};\nint x, y;\n\nvoid simulate(int cx, int cy, int e, int& trial, int& success)\n{\n\tif(e == 0)\n\t{\n\t\tif(room[cx+cy*3] == t) success++;\n\t\ttrial++;\n\t\treturn;\n\t}\n\n\tfor(int i=0; i<4; i++)\n\t{\n\t\tint xx = cx + off[i][0];\n\t\tint yy = cy + off[i][1];\n\t\tint index = xx + yy * 3;\n\t\tif(room[index]==b || xx<0 || yy<0 || xx>=3 || yy>=3)\n\t\t   simulate(x, y, e-1, trial, success);\n\t\telse\n\t\t   simulate(xx, yy, e-1, trial, success);\n\t}\n}\n\ndouble solve()\n{\n\tint trial = 0;\n\tint success = 0;\n\tsimulate(x, y, n, trial, success);\n\treturn (double)success / (double)trial;\n}\n\nint main()\n{\n\twhile( 1 )\n\t{\n\t\tcin >> n;\n\t\tif(n==0) break;\n\t\t\n\t\tcin >> s >> t >> b;\n\t\tfor(int i=0; i<9; i++)\n\t\t{\n\t\t\tif(room[i] == s)\n\t\t\t{\n\t\t\t\tx = i%3;\n\t\t\t\ty = i/3;\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8f\\n\", solve());\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n\nusing namespace std;\n\nint b_row,b_col,memo[16][3][3];\n\nchar b[2];\n\nbool rangeCheck(int row,int col){\n\tif(row >= 0 && row <= 2 && col >= 0 && col <= 2)return true;\n\telse{\n\t\treturn false;\n\t}\n}\n\nint translate(char ch){\n\tswitch(ch){\n\tcase 'A':return 0;\n\tcase 'B':return 1;\n\tcase 'C':return 2;\n\tcase 'D':return 10;\n\tcase 'E':return 11;\n\tcase 'F':return 12;\n\tcase 'G':return 20;\n\tcase 'H':return 21;\n\tcase 'I':return 22;\n\t}\n\n\treturn -1; //must not reach here.\n}\n\nint main(){\n\n\tint n,tmp,energy_row,energy_col,row,col;\n\tchar start[2],energy[2];\n\n\twhile(true){\n\t\tscanf(\"%d\",&n);\n\t\tif(n == 0)break;\n\n\t\tfor(int i = 0; i < 16; i++){\n\t\t\tfor(int p = 0; p < 3; p++){\n\t\t\t\tfor(int k = 0; k < 3; k++)memo[i][p][k] = 0;\n\t\t\t}\n\n\t\t}\n\n\t\tscanf(\"%s %s %s\",start,energy,b);\n\n\t\ttmp = translate(b[0]);\n\t\tb_row = tmp/10;\n\t\tb_col = tmp%10;\n\n\t\ttmp = translate(energy[0]);\n\t\tenergy_row = tmp/10;\n\t\tenergy_col = tmp%10;\n\n\t\ttmp = translate(start[0]);\n\n\t\trow = tmp/10,col = tmp%10;\n\n\t\tif(rangeCheck(row,col-1) == true && (row != b_row || col-1 != b_col)){\n\t\t\tmemo[1][row][col-1] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row,col+1) == true && (row != b_row || col+1 != b_col)){\n\t\t\tmemo[1][row][col+1] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row-1,col) == true && (row-1 != b_row || col != b_col)){\n\t\t\tmemo[1][row-1][col] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row+1,col) == true && (row+1 != b_row || col != b_col)){\n\t\t\tmemo[1][row+1][col] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tfor(int loop = 2; loop <= n; loop++){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tif(i == b_row && k == b_col){\n\t\t\t\t\t\tmemo[loop][i][k] = 0;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(i == 0 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][0][0] = memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][0][0] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][0][0] += memo[loop-1][1][0];\n\t\t\t\t\t\t}else if(i == 0 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][0][1] = memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 0)memo[loop][0][1] += memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][0][1] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 2)memo[loop][0][1] += memo[loop-1][0][2];\n\t\t\t\t\t\t}else if(i == 0 && k == 2){\n\t\t\t\t\t\t\tmemo[loop][0][2] = memo[loop-1][0][2];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][0][2] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][0][2] += memo[loop-1][1][2];\n\t\t\t\t\t\t}else if(i == 1 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][1][0] = memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 0)memo[loop][1][0] += memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][1][0] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 0)memo[loop][1][0] += memo[loop-1][2][0];\n\t\t\t\t\t\t}else if(i == 1 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][1][1] = memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][1][1] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][1][1] += memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][1][1] += memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][1][1] += memo[loop-1][2][1];\n\t\t\t\t\t\t}else if(i == 1 && k == 2){\n\t\t\t\t\t\t\tmemo[loop][1][2] = memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 2)memo[loop][1][2] += memo[loop-1][0][2];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][1][2] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 2)memo[loop][1][2] += memo[loop-1][2][2];\n\t\t\t\t\t\t}else if(i == 2 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][2][0] = memo[loop-1][2][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][2][0] += memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][2][0] += memo[loop-1][2][1];\n\t\t\t\t\t\t}else if(i == 2 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][2][1] = memo[loop-1][2][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 0)memo[loop][2][1] += memo[loop-1][2][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][2][1] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 2)memo[loop][2][1] += memo[loop-1][2][2];\n\t\t\t\t\t\t}else{ //i == 2 && k == 2\n\t\t\t\t\t\t\tmemo[loop][2][2] = memo[loop-1][2][2];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][2][2] += memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][2][2] += memo[loop-1][2][1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\",((double)memo[n][energy_row][energy_col])/((double)pow(4,n)));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\nusing namespace std;\n\nconst double EPS = 1E-8;\nconst int MAX = 16;\nconst int NUM = 9;\ndouble f[MAX][NUM];\n\nint main()\n{\t\n\tint n, s, t, b;\n\tchar ts, tt, tb;\n\twhile (cin >> n, n) {\n\t\tcin >> ts >> tt >> tb;\n\t\ts = ts - 'A';\n\t\tt = tt - 'A';\n\t\tb = tb - 'A';\n\t\t\n\t\tfill((double*)f, (double*)f +  MAX + NUM, 0);\n\t\tf[0][s] = 1.0;\n\t\t\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < NUM; j++) {\n\t\t\t\tif (f[i][j] < EPS) continue;\n\t\t\t\tif (j >= 3 && (j - 3) != b) f[i + 1][j - 3] += f[i][j] * 0.25;\n\t\t\t\telse f[i + 1][j] += f[i][j] * 0.25;\n\t\t\t\tif (j < 6 && (j + 3) != b) f[i + 1][j + 3] += f[i][j] * 0.25;\n\t\t\t\telse f[i + 1][j] += f[i][j] * 0.25;\n\t\t\t\tif (j % 3 != 0 && (j - 1) != b) f[i + 1][j - 1] += f[i][j] * 0.25;\n\t\t\t\telse f[i + 1][j] += f[i][j] * 0.25;\n\t\t\t\tif (j % 3 != 2 && (j + 1) != b) f[i + 1][j + 1] += f[i][j] * 0.25;\n\t\t\t\telse f[i + 1][j] += f[i][j] * 0.25;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\", f[n][t]);\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\nusing namespace std;\n\nint main(){\n  int n;\n  char s,t,b;\n  double p[16][9];\n\n  for(;;){\n    scanf(\" %d \",&n);\n    if(!n)break;\n\n    scanf(\" %c %c %c \",&s,&t,&b);\n\n    for(int i=0;i<=n;i++)\n      for(int j=0;j<9;j++)p[i][j] = 0.0;\n\n    p[0][s-'A'] = 1.0;\n\n    for(int i=0;i<n;i++){\n      for(int j=0;j<9;j++){\n\tif(j>=3 && j-3!=b-'A')p[i+1][j-3] += p[i][j]/4;\n\telse p[i+1][j] += p[i][j]/4;\n\n\tif(j%3!=2 && j+1!=b-'A')p[i+1][j+1] += p[i][j]/4;\n\telse p[i+1][j] += p[i][j]/4;\n\n\tif(j<6 && j+3!=b-'A')p[i+1][j+3] += p[i][j]/4;\n\telse p[i+1][j] += p[i][j]/4;\n\n\tif(j%3 && j-1!=b-'A')p[i+1][j-1] += p[i][j]/4;\n\telse p[i+1][j] += p[i][j]/4;\n      }\n    }\n\n    printf(\"%.8lf\\n\",p[n][t-'A']);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<string>\n#include<map>\n#include<cstdio>\n    \n#define f first\n#define s second\n    \nusing namespace std;\n    \ntypedef pair<int,int> P;\n    \nint dx[4]={0,0,1,-1};\nint dy[4]={1,-1,0,0};\n    \nint main(void){\n    \nint n,id=0;\nstring s=\"ABCDEFGHI\";\nchar s,t,d;\nmap<char,P>mp;\n    \nfor(int i=0;i<3;i++){\nfor(int j=0;j<3;j++){\nmp[s[id++]]=P(j,i);\n}\n}\n    \nwhile(cin >> n,n){\ncin >> s >> t >> d;\n \nP S,T,D;\nS.f=mp[s].f,S.s=mp[s].s;\nT.f=mp[t].f,T.s=mp[t].s;\nD.f=mp[d].f,D.s=mp[d].s;\n \ndouble dp[16][3][3];\n    \nfor(int k=0;k<16;k++)\nfor(int i=0;i<3;i++)\nfor(int j=0;j<3;j++)dp[k][i][j]=0;\n    \ndp[0][S.s][S.f]=1;\n    \nfor(int k=0;k<n;k++){\nfor(int i=0;i<3;i++){\nfor(int j=0;j<3;j++){\nfor(int l=0;l<4;l++){\nint nx=j+dx[l],ny=i+dy[l];\nif(nx<0 || ny<0 || 2<nx || 2<ny || \n(nx==D.s&&ny==D.f))nx=j,ny=i;\ndp[k+1][ny][nx]+=dp[k][i][j]/4;\n}\n}\n}\n}\nprintf(\"%.8f\",dp[n][T.s][T.f]);\ncout << endl;\n}\n    \nreturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <queue>\n#include <cstdio>\nusing namespace std;\nconst int dx[] = {0,0,1,-1};\nconst int dy[] = {1,-1,0,0};\nclass NODE{\n\tpublic:\n\tint y;\n\tint x;\n\tint b;\n};\nint main(){\n\tint n,ret,all;\n\tint y,x;\n\tstring a,b,c;\n\twhile(cin >>n && n){\n\t\tret = 0;\n\t\tall = 0;\n\t\tstring data[5]={\"#####\",\"#ABC#\",\"#DEF#\",\"#GHI#\",\"#####\"};\n\t\tcin >> a >> b >> c;\n\t\tfor(int i=0;i<5;i++){\n\t\t\tif(~data[i].find(a)){\n\t\t\t\ty = i;\n\t\t\t\tx = data[i].find(a);\n\t\t\t}\n\t\t\tif(~data[i].find(b)){\n\t\t\t\tdata[i][data[i].find(b)] = 'X';\n\t\t\t}\n\t\t\tif(~data[i].find(c)){\n\t\t\t\tdata[i][data[i].find(c)] = '#';\n\t\t\t}\n\t\t}\n\t\tqueue<NODE> Q;\n\t\tNODE q = {y,x,n};\n\t\tQ.push(q);\n\t\twhile(!Q.empty()){\n\t\t\tq = Q.front();Q.pop();\n\t\t\tif(q.b == 0 ){\n\t\t\t\tif(data[q.y][q.x]=='X'){\n\t\t\t\t\tret++;\n\t\t\t\t}\n\t\t\t\tall++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfor(int i=0;i<4;i++){\n\t\t\t\tNODE t = {q.y+dy[i],q.x+dx[i],q.b-1};\n\t\t\t\tif(data[t.y][t.x] != '#'){\n\t\t\t\t\tQ.push(t);\n\t\t\t\t}else{\n\t\t\t\t\tNODE t = {q.y,q.x,q.b-1};\n\t\t\t\t\tQ.push(t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\",(double)ret/all);\n\t}\n\t\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<iomanip>\nusing namespace std;\nchar map[3][3]={'A','B','C','D','E','F','G','H','I'};\nint n,ans;\nint dx[4]={0,1,0,-1},dy[4]={1,0,-1,0};\nchar s,t,d;\nvoid DFS(int y,int x,int len){\n\tif(len==0){\n\t\tif(map[y][x]==t)ans++;\n\t\treturn;\n\t}\n\tfor(int i=0;i<4;i++){\n\t\tif(y+dy[i]==-1||y+dy[i]==3||x+dx[i]==-1||x+dx[i]==3)DFS(y,x,len-1);\n\t\telse{\n\t\t\tif(map[y+dy[i]][x+dx[i]]==d)DFS(y,x,len-1);\n\t\t\telse DFS(y+dy[i],x+dx[i],len-1);\n\t\t}\n\t}\n}\nint main(){\n\twhile(true){\n\tcin>>n;\n\tif(n==0)break;\n\tcin>>s>>t>>d;\n\tans=0;\n\tfor(int i=0;i<3;i++)\n\t\tfor(int j=0;j<3;j++)\n\t\t\tif(map[i][j]==s)DFS(i,j,n);\n\tdouble cnt=1.0;\n\tfor(int i=0;i<n;i++)cnt*=4.0;\n\tcout<<fixed<<setprecision(10)<<ans/cnt<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<queue>\n\ntypedef std::pair<int, int> P;\n\ndouble data[3][3];\nint cost[3][3];\nint sx, sy, tx, ty, bx, by;\n\nint dx[] = { 0, 1, 0, -1 };\nint dy[] = { 1, 0, -1, 0 };\n\nvoid bfs(){\n\n\tstd::queue<P>que;\n\tque.push(P(sx, sy));\n\n\twhile (!que.empty()){\n\t\tP p = que.front();\n\t\tque.pop();\n\n\t\tif (cost[p.second][p.first] > 0){\n\n\t\t\tfor (int i = 0; i < 4; i++){\n\t\t\t\tint nx = p.first + dx[i];\n\t\t\t\tint ny = p.second + dy[i];\n\n\t\t\t\tif (0 <= nx&&nx < 3 && 0 <= ny&&ny < 3 && !(nx == bx&&ny == by)){\n\t\t\t\t\tdata[ny][nx] += data[p.second][p.first] / 4;\n\t\t\t\t\tcost[ny][nx] = cost[p.second][p.first] - 1;\n\n\t\t\t\t\tque.push(P(nx, ny));\n\t\t\t\t}\n\t\t\t}\n\t\t\tcost[p.second][p.first]--;\n\t\t}\n\t}\n}\n\nint main(){\n\tint n;\n\twhile (std::cin >> n, n){\n\n\t\tmemset(data, 0, sizeof(data));\n\t\tmemset(cost, 0, sizeof(cost));\n\n\t\tchar s, t, b;\n\t\tstd::cin >> s >> t >> b;\n\n\t\tsx = (s - 'A') % 3;\n\t\tsy = (s - 'A') / 3;\n\t\ttx = (t - 'A') % 3;\n\t\tty = (t - 'A') / 3;\n\t\tbx = (b - 'A') % 3;\n\t\tby = (b - 'A') / 3;\n\n\t\tdata[sy][sx] = 1;\n\t\tcost[sy][sx] = n;\n\n\t\tbfs();\n\n\t\tprintf(\"%.8f\\n\", data[ty][tx]);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "/*\n * Author:  mybestwishes\n * Created Time:  2011/8/31 13:26:03\n * File Name: B.cpp\n */\n#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\n#include <string>\n#include <vector>\n#include <map>\n#include <stack>\n#include <queue>\n#include <set>\n#include <time.h>\nusing namespace std;\n#define Abs(x) (((x) > 0)?(x):(-(x)))\ntypedef long long lint;\ndouble pos = 0 ; \nstruct Q{\n    int i , j ;\n    \n};\nbool operator == (const Q &q1 , const Q &q2){\n    return (q1.i == q2.i) && (q1.j == q2.j) ;\n}\nbool vis[3][3] ;\nvoid search(Q st , Q ba , Q ju , double p , int val){\n    if(st == ba){\n        pos += p ;\n        return ;\n    }\n    if(val == 0) return ;\n    vis[st.i][st.j] = true ;\n    if((st.j-1 >= 0) && (st.j-1 != ju.j || st.i != ju.i)){\n        Q tt = st ; tt.j-- ;\n        if(!vis[tt.i][tt.j])\n            search(tt , ba , ju , p*0.25 , val-1) ;\n    }\n    else search(st , ba , ju , p*0.25 , val-1) ;\n    if(st.j+1 <= 2 && (st.j+1 != ju.j || st.i != ju.i)){\n        Q tt = st ; tt.j++ ;\n        if(!vis[tt.i][tt.j])\n            search(tt , ba , ju , p*0.25 , val-1) ;\n    }\n    else search(st , ba , ju , p*0.25 , val-1) ;\n    if(st.i-1 >= 0 && (st.j != ju.j || st.i-1 != ju.i)){\n        Q tt = st ; tt.i-- ;\n        if(!vis[tt.i][tt.j])\n            search(tt , ba , ju , p*0.25 , val-1) ;\n    }\n    else search(st , ba , ju , p*0.25 , val-1) ;\n    if(st.i+1 <= 2 && (st.j != ju.j || st.i+1 != ju.i)){\n        Q tt = st ; tt.i++ ;\n        if(!vis[tt.i][tt.j])\n            search(tt , ba , ju , p*0.25 , val-1) ;\n    }\n    else search(st , ba , ju , p*0.25 , val-1) ;\n}\nint main() {\n    int val ; \n    while(scanf(\"%d\\n\" , &val) != EOF && val != 0){\n        memset(vis , false, sizeof(vis));\n        pos = 0 ; \n        string tmp ; \n        getline(cin , tmp);\n        Q st , ba ,  ju ; \n        st.i = (tmp[0] - 'A')/3 ;\n        st.j = (tmp[0] - 'A')%3 ;\n        ba.i = (tmp[2] - 'A')/3 ;\n        ba.j = (tmp[2] - 'A')%3 ;\n        ju.i = (tmp[4] - 'A')/3 ;\n        ju.j = (tmp[4] - 'A')%3 ;\n        //cout<<ju.i<<ju.j<<endl;\n        double p = 1 ; \n        search(st , ba , ju , p , val) ;\n        printf(\"%.9lf\\n\" , pos);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstring>\n#include <cmath>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <sstream>\nusing namespace std;\n\nlong cnt,as;\nchar s,t,b;\nconst int dy[]={-1,0,1,0};\nconst int dx[]={0,1,0,-1};\nint main(){\n  int n,field[2][4][4];\n  for(;cin>>n,n;){\n    cin.ignore();\n    cnt=as=0;\n    scanf(\" %c %c %c \",&s,&t,&b);\n    memset(field,0,sizeof(field));\n    int x= s=='A'||s=='D'||s=='G'?1:s=='B'||s=='E'||s=='H'?2:3;\n    int y= s=='A'||s=='B'||s=='C'?1:s=='D'||s=='E'||s=='F'?2:3;\n    \n    int p= t=='A'||t=='D'||t=='G'?1:t=='B'||t=='E'||t=='H'?2:3;\n    int q= t=='A'||t=='B'||t=='C'?1:t=='D'||t=='E'||t=='F'?2:3;\n\n    int u= b=='A'||b=='D'||b=='G'?1:b=='B'||b=='E'||b=='H'?2:3;\n    int t= b=='A'||b=='B'||b=='C'?1:b=='D'||b=='E'||b=='F'?2:3;\n\n    field[0][y][x]=1;\n    for(int k=0;k<n;k++){\n      for(int i=1;i<4;i++){\n        for(int j=1;j<4;j++){\n          if(i==t && j==u)continue;\n          if(field[0][i][j]==0 && field[0][i-1][j]==0 && field[0][i+1][j]==0 &&\n             field[0][i][j-1]==0 && field[0][i][j+1]==0)continue;\n          \n          field[1][i][j]=field[0][i-1][j  ]+\n                         field[0][i+1][j  ]+\n                         field[0][i  ][j-1]+\n                         field[0][i  ][j+1];\n          if(field[0][i][j]!=0 && (i-1==t&&j==u || i+1==t&&j==u ||\n             i==t&&j-1==u || i==t&&j+1==u) ){\n            field[1][i][j]++;\n          }\n        }\n      }\n      for(int i=1;i<4;i++)for(int j=1;j<4;j++)field[0][i][j]=field[1][i][j];\n      /*\n      for(int i=1;i<4;i++){\n        for(int j=1;j<4;j++){\n          printf(\"%8d \",field[0][i][j]);\n        }\n        puts(\"\");\n      }\n      puts(\"\");\n      */\n    }\n    printf(\"%.8lf\\n\",(double)field[0][q][p]/pow(4.0,(double)n));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 100000000\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P> PP;\n \nstatic const double EPS = 1e-8;\n \nconst int tx[] = {0,1,0,-1};\nconst int ty[] = {-1,0,1,0};\n \nchar stage[3][3];\ndouble prob[17][3][3];\n\nint main(){\n    int n;\n    while(~scanf(\"%d\",&n)){\n        if(n==0) break;\n \n        char s,t,b;\n        memset(stage,'.',sizeof(stage));\n        cin >> s >> t >> b;\n        int sx = (s-'A')%3;\n        int sy = (s-'A')/3;\n        int gx = (t-'A')%3;\n        int gy = (t-'A')/3;\n        stage[(b-'A')/3][(b-'A')%3] = 'B';\n\n\t\tfill(prob[0][0],prob[0][0]+3*3*17,0.0);\n\n\t\tprob[0][sy][sx] = 1.0;\n\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\tfor(int x=0;x<3;x++){\n\t\t\t\t\tfor(int j=0;j<4;j++){\n\t\t\t\t\t\tint dx = x + tx[j];\n\t\t\t\t\t\tint dy = y + ty[j];\n\t\t\t\t\t\tif((dx < 0 || dx >= 3 || dy < 0 || dy >= 3)\n\t\t\t\t\t\t\t|| stage[dy][dx]=='B') prob[i+1][y][x] += prob[i][y][x]/4.0;\n\t\t\t\t\t\telse prob[i+1][dy][dx] += prob[i][y][x]/4.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%lf\\n\",prob[n][gy][gx]);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cmath>\n#include <cstdio>\n#include <iostream>\n#include <map>\n#include <utility>\n\nusing namespace std;\nint n, sx, sy, tx, ty, bx, by;\nint mvx[4] = {-1, 1, 0, 0};\nint mvy[4] = {0, 0, -1, 1};\nint c;\n\nvoid dfs(int k, int x, int y){\n    if (k == n) {\n        if (x == tx && y == ty) {\n            c++;\n        }\n        return;\n    }\n    for (int i = 0; i < 4; i++) {\n        int mx = x + mvx[i];\n        int my = y + mvy[i];\n        if (mx < 0 || mx > 2 || my < 0 || my > 2 || (mx == bx && my == by)) {\n            dfs(k+1, x, y);\n            continue;\n        }\n        dfs(k+1, mx, my);\n    }\n}\n\nint main()\n{\n    char s, t, b;\n    map<char, pair<int, int> > rooms;\n    rooms['A'].first = 0; rooms['A'].second = 0;\n    rooms['B'].first = 1; rooms['B'].second = 0;\n    rooms['C'].first = 2; rooms['C'].second = 0;\n    rooms['D'].first = 0; rooms['D'].second = 1;\n    rooms['E'].first = 1; rooms['E'].second = 1;\n    rooms['F'].first = 2; rooms['F'].second = 1;\n    rooms['G'].first = 0; rooms['G'].second = 2;\n    rooms['H'].first = 1; rooms['H'].second = 2;\n    rooms['I'].first = 2; rooms['I'].second = 2;\n\n    while (cin >> n && n) {\n        cin >> s >> t >> b;\n        c = 0;\n        sx = rooms[s].first; sy = rooms[s].second;\n        tx = rooms[t].first; ty = rooms[t].second;\n        bx = rooms[b].first; by = rooms[b].second;\n        dfs(0, sx, sy);\n        printf(\"%.8f\\n\", (double)c / pow(4, n));\n        \n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr,__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\n\nconst int dxdy[] = {-1,3,1,-3};\n\nint main() {\n    int life;\n    while (cin >> life, life) {\n        char start, goal, soko;\n        cin >> start >> goal >> soko;\n        start -= 'A';\n        goal -= 'A';\n        soko -= 'A';\n\n        vvi dp(2, vi(9, 0));\n        dp[0][start] = 1;\n        FOR(i, 1, life+1) {\n            fill(ALL(dp[1]), 0);\n            REP(j, 9) {\n                if (dp[0][j] > 0) {\n                    REP(k, 4) {\n                        int s = j + dxdy[k];\n                        if (!(0 <= s && s <= 8) ||\n                            ((j == 2 || j == 5) && k == 2) || ((j == 3 || j == 6) && k == 0) ||\n                            s == soko) {\n                            dp[1][j] += dp[0][j];\n                        } else {\n                            dp[1][s] += dp[0][j];\n                        }\n                    }\n                }\n            }\n            dp[0] = dp[1];\n        }\n        int cnt = 0;\n        REP(i, 9) {\n            cnt += dp[0][i];\n        }\n        printf(\"%.8f\\n\", (double)dp[0][goal] / cnt);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\nint n;\nchar room[10] = \"ABCDEFGHI\";\nchar s, t, b;\nint off[4][2] = {{-1, 0}, {1, 0}, {0, -1}, {0, 1}};\nint x, y;\n\nvoid simulate(int cx, int cy, int e, int& trial, int& success)\n{\n\tif(e == 0)\n\t{\n\t\tif(room[cx+cy*3] == t) success++;\n\t\ttrial++;\n\t\treturn;\n\t}\n\n\tfor(int i=0; i<4; i++)\n\t{\n\t\tint xx = cx + off[i][0];\n\t\tint yy = cy + off[i][1];\n\t\tint index = xx + yy * 3;\n\t\tif(room[index]==b || xx<0 || yy<0 || xx>=3 || yy>=3)\n\t\t   simulate(x, y, e-1, trial, success);\n\t\telse\n\t\t   simulate(xx, yy, e-1, trial, success);\n\t}\n}\n\ndouble solve()\n{\n\tint trial = 0;\n\tint success = 0;\n\tsimulate(x, y, n, trial, success);\n\treturn (double)success / (double)trial;\n}\n\nint main()\n{\n\tsrand((unsigned long)time(NULL));\n\n\twhile( 1 )\n\t{\n\t\tcin >> n;\n\t\tif(n==0) break;\n\t\t\n\t\tcin >> s >> t >> b;\n\t\tfor(int i=0; i<9; i++)\n\t\t{\n\t\t\tif(room[i] == s)\n\t\t\t{\n\t\t\t\tx = i%3;\n\t\t\t\ty = i/3;\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8f\\n\", solve());\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <set>\n#include <map>\n#include <list>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <ctype.h>\n#include <ctime>\n#include <cstdio>\n#include <vector>\n#include <string>\n#include <bitset>\n#include <cctype>\n#include <cstdlib>\n#include <cstring>\n#include <utility>\n#include <numeric>\n#include <complex>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <cassert>\n#include <iostream>\n#include <iterator>\n#include <algorithm>\n\nusing namespace std;\n//参考http://topcoder.g.hatena.ne.jp/isa_rentacs/20111114/1321278656 \n#define REP(i, x, n) for(int i = x; i < n; i++)\n#define rep(i, n) REP(i, 0, n)\n#define lengthof(x) (sizeof(x) / sizeof(*(x)))\n#define FILL(ptr, value) FILL_((ptr), sizeof(ptr)/sizeof(value), (value))\ntemplate <typename T>\nvoid FILL_(void * ptr, size_t size, T value){\n  std::fill((T*)ptr, (T*)ptr+size, value);\n}\n//4方向ベクトル→↑←↓\nint dx[] ={1,0,-1,0};\nint dy[] ={0,-1,0,1};\n\ndouble dp[16][9];\nint dir[4] = {1,3,-1,-3};\nint main()\n{\n  int n;\n  while(cin >>n,n){\n    fill((int*)dp,(int*)(dp+lengthof(dp)),0);\n    char temp;\n    int s,t,b,x,y;\n    cin >>temp;\n    s =temp -'A';\n    cin >>temp;\n    t =temp -'A';\n    cin >>temp;\n    b = temp -'A';\n    dp[0][s] = 1;\n    for(int i = 0;i < n;i++){\n      for(int j = 0;j < 9;j++){\n\tif(dp[i][j] ==0)\n\t  continue;\n\tx =j%3;\n\ty = j/3;\n\tfor(int k = 0;k < 4;k++){\n\t  if(0 <=x+dx[k]&&x +dx[k] < 3&&0 <=y +dy[k]&&y +dy[k] <3&&j+dir[k] !=b)\n\t    dp[i+1][j+dir[k]] +=dp[i][j]*0.25;\n\t  else\n\t    dp[i+1][j] +=dp[i][j]*0.25;\n\t}\n      }\n    }\n    printf(\"%.8f\\n\",dp[n][t]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "/* 1020 */\n#include <iostream>\n#include <cmath>\n#include <cstdio>\nusing namespace std;\n\nchar s,t,b;\nlong long p[3][3];\nchar m[3][3];\nlong long correct=0.0;\nint n;\nbool c(int i,int j){\n\treturn ((0<=i&&i<3&&0<=j&&j<3));\n}\n\nvoid walk(int step,int i,int j){\n\t// cout<<step<<\" \"<<i<<\" \"<<j<<\" \"<<p[i][j]<<endl;\n\tp[i][j]+=pow(4,step);\n\tif(step==n){\n\t\tif(i==t/3&&j==t%3)correct+=p[i][j];\n\t\treturn;\n\t}\n\tif(m[i][j]=='b')return;\n\tif(c(i+1,j))walk(step+1,i+1,j);\n\telse walk(step+1,i,j);\n\tif(c(i,j-1))walk(step+1,i,j-1);\n\telse walk(step+1,i,j);\n\tif(c(i,j+1))walk(step+1,i,j+1);\n\telse walk(step+1,i,j);\n\tif(c(i-1,j))walk(step+1,i-1,j);\n\telse walk(step+1,i,j);\n}\n\nint main(void){\n\twhile(cin>>n,n){\n\t\tcin>>s>>t>>b;\n\t\tcorrect=0.0;\n\t\tfor(int i=0;i<3;i++){\n\t\t\tfor(int j=0;j<3;j++){\n\t\t\t\tp[i][j]=0;\n\t\t\t\tm[i][j]='.';\n\t\t\t}\n\t\t}\n\t\ts-='A';\n\t\tt-='A';\n\t\tb-='A';\n\t\tm[b/3][b%3]='b';\n\t\twalk(0,s/3,s%3);\n\t\t// if(p[t/3][t%3]==0)cout<<\"0.00000000\"<<endl;\n\t\t// else cout<<1.0/(double)p[t/3][t%3]<<endl;\n\t\t// if(correct==0)cout<<correct<<endl;\n\t\t// else cout<<1.0/(double)correct<<endl;\n\t\tif(correct==0)printf(\"%.8lf\\n\",(double)correct);\n\t\telse printf(\"%.8lf\\n\",1.0/(double)correct);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\ntypedef vector <int> VI;\ntypedef vector <VI> VVI;\n\nconst int dx[4] = { 0, 0, 1, -1 };\nconst int dy[4] = { 1, -1, 0, 0 };\n\nint get_x( char c )\n{\n\tif ( c == 'A' || c == 'D' || c == 'G' ) return 0;\n\tif ( c == 'B' || c == 'E' || c == 'H' ) return 1;\n\tif ( c == 'C' || c == 'F' || c == 'I' ) return 2;\n\treturn -1;\n}\n\nint get_y( char c )\n{\n\tif ( c == 'A' || c == 'B' || c == 'C' ) return 0;\n\tif ( c == 'D' || c == 'E' || c == 'F' ) return 1;\n\tif ( c == 'G' || c == 'H' || c == 'I' ) return 2;\n\treturn -1;\n}\n\n\nint main( void )\n{\n\tint n; char s, t, b;\n\twhile ( 1 )\n\t{\n\t\tcin >> n;\n\t\tif ( n == 0 ) break;\n\t\tcin >> s >> t >> b;\n\n\t\tint sx, sy, gx, gy, ox, oy;\n\t\tsx = get_x( s ); sy = get_y( s );\n\t\tgx = get_x( t ); gy = get_y( t );\n\t\tox = get_x( b ); oy = get_y( b );\n\n\t\tVVI prev( 3, VI(3,0) ), next;\n\t\tprev[sx][sy] = 1;\n\t\tfor ( int lpc = 0; lpc < n; lpc++ )\n\t\t{\n\t\t\tnext = VVI( 3, VI( 3, 0 ) );\n\t\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ )\n\t\t\t{\n\t\t\t\tif ( i == oy && j == ox ) continue;\n\t\t\t\tbool stop = 0;\n\t\t\t\tfor ( int k = 0; k < 4; k++ )\n\t\t\t\t{\n\t\t\t\t\tint nx = j + dx[k];\n\t\t\t\t\tint ny = i + dy[k];\n\t\t\t\t\tif ( nx < 0 || nx >= 3 || ny < 0 || ny >= 3 )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( nx == ox && ny == oy )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnext[i][j] += prev[ny][nx];\n\t\t\t\t}\n\t\t\t\tif ( stop )\n\t\t\t\t{\n\t\t\t\t\tnext[i][j] += prev[i][j] * stop;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tprev = next;\n\t\t}\n\n\t\tint sum = 0;\n\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ ) sum += next[i][j];\n\n\t\tdouble answer = (double)next[gy][gx] / (double)sum;\n\n\t\tcout.setf( ios::fixed );\n\t\tcout << answer << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n\ndouble dp[16][9];\nchar s,t,b;\nint n,d[4]={-3,-1,3,1};\n\nint main() {\n\twhile(scanf(\"%d\",&n),n) {\n\t\tscanf(\"\\n%c %c %c\",&s,&t,&b);s-='A',t-='A',b-='A';\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdp[0][s]=1;\n\t\tfor(int i=0;i<=n-1;i++) {\n\t\t\tfor(int j=0;j<9;j++) {\n\t\t\t\tfor(int k=0;k<4;k++) {\n\t\t\t\t\tif((k==0&&j/3==0)||(k==1&&j%3==0)||(k==2&&j/3==2)||(k==3&&j%3==2)||(j+d[k])==b) {\n\t\t\t\t\t\tdp[i+1][j]+=dp[i][j]*0.25;\n\t\t\t\t\t}else {\n\t\t\t\t\t\tdp[i+1][j+d[k]]+=dp[i][j]*0.25;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\",dp[n][t]);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "//49\n#include<iostream>\n#include<iomanip>\n\nusing namespace std;\n\nint tx,ty,bx,by;\n\nint tox(char c){\n  return (c-'A')%3;\n}\n\nint toy(char c){\n  return (c-'A')/3;\n}\n\ndouble cal(int r,int y,int x,double p){\n  if(y==by && x==bx){\n    return 0;\n  }else if(r==0){\n    return (y==ty && x==tx)?p:0;\n  }else{\n    double a=0;\n    for(int i=0;i<5;i++){\n      int d[]={0,1,0,-1,0};\n      int nx=x+d[i];\n      int ny=y+d[i+1];\n      if(0<=nx&&nx<3&&0<=ny&&ny<3){\n\ta+=cal(r-1,ny,nx,p/4);\n      }\n    }\n    return a;\n  }\n}\n\nint main(){\n  for(int n;cin>>n,n;){\n    char s,t,b;\n    cin>>s>>t>>b;\n    tx=tox(t);\n    ty=toy(t);\n    bx=tox(b);\n    by=toy(b);\n    cout<<fixed<<setprecision(6)<<cal(n,toy(s),tox(s),1)<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define for_(i,a,b) for(int i=(a);i<(b);++i)\n\nconst int dx[4] = {-1,0,1,0};\nconst int dy[4] = {0,-1,0,1};\n\nint n;\nchar s, t, b;\ndouble p[2][3][3];\n\nint getX(char c) { return (c - 'A') % 3; }\nint getY(char c) { return (c - 'A') / 3; }\n\nvoid solve() {\n\tfor_(y,0,3) for_(x,0,3) p[0][y][x] = 0.;\n\tp[0][getY(s)][getX(s)] = 1.0;\n\t\n\tfor_(i,0,n) {\n\t\tfor_(y,0,3) for_(x,0,3) p[1][y][x] = 0.;\n\t\tfor_(y,0,3) for_(x,0,3) {\n\t\t\tfor_(d,0,4) {\n\t\t\t\tint nx = x + dx[d], ny = y + dy[d];\n\t\t\t\tif ((nx < 0 || nx >= 3 || ny < 0 || ny >= 3) ||\n\t\t\t\t\t(ny == getY(b) && nx == getX(b))) {\n\t\t\t\t\tnx = x;\n\t\t\t\t\tny = y;\n\t\t\t\t}\n\t\t\t\tp[1][ny][nx] += p[0][y][x] * 0.25;\n\t\t\t}\n\t\t}\n\t\tswap(p[0], p[1]);\n\t}\n\t\n\tcout << setprecision(12) << setiosflags(ios::fixed) << p[0][getY(t)][getX(t)] << endl;\n}\n\nint main() {\n\twhile (cin >> n, n) {\n\t\tcin >> s >> t >> b;\n\t\tsolve();\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory> \n#include <string> \n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <numeric>\n#include <iomanip>\n\n#define REP(i,n) for(i=0; i < (n); i++)\n#define REPONE(i, n) for(i=1; i <= (n); i++)\n#define LOOP(n) for(int loopCount=1; loopCount <= (n); loopCount++)\n#define ITER(c) __typeof((c).begin())\n#define EACH(c,it) for(ITER(c) it =(c).begin(); it!=(c).end(); it++)\n#define SZ(c) ((int) (c).size())\n#define ALL(c) c.begin(), c.end()\n#define SUM(c) accumulate(ALL(c), 0)\n#define EXIST(c,v) (find(ALL(c), (v)) != (c).end())\n#define PB push_back\n#define MP make_pair\n#define fs first\n#define sc second\n\nusing namespace std;\nstatic const double EPS = 1e-9;\nstatic const double PI = 3.141592653589793238462643383279;\ntypedef long long ll;\n\npair<int, int> toP(char c){\n    int x = c - 'A';\n    return MP(x/3, x%3);\n}\n\nbool isOut(int x, int y){\n    return !(0<=x && x<=2 && 0<=y && y<=2);\n}\n\nint dx[] = {1,0,-1,0}, dy[] = {0,1,0,-1};\n\nint main(){\n    double dp[20][3][3];\n    int i, j, k, l, n, x, y;\n    char c1, c2, c3;\n    pair<int, int> st, tar, obs;\n\n    while(scanf(\"%d\\n\",&n)){\n        if(!n) break;\n        scanf(\"%c %c %c\\n\",&c1, &c2, &c3);\n        st = toP(c1);\n        tar = toP(c2);\n        obs = toP(c3);\n        REP(k,20)REP(i,3)REP(j,3) dp[k][i][j] = 0.0;\n        dp[0][st.fs][st.sc] = 1.0;\n\n        REP(k,n)REP(i,3)REP(j,3){\n            REP(l,4){\n                x = i + dx[l];\n                y = j + dy[l];\n                if(isOut(x,y) || MP(x,y)==obs){\n                    dp[k+1][i][j] += 0.25*dp[k][i][j];\n                }\n                else{\n                    dp[k+1][x][y] += 0.25*dp[k][i][j];\n                }\n            }\n        }\n        printf(\"%.10f\\n\", dp[n][tar.fs][tar.sc]);\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string.h>\n#include <cmath>\n#include <cstdio>\n\nusing namespace std;\n\nint dx[4]={-1,0,0,1};\nint dy[4]={0,1,-1,0};\n\nint main(void)\n{\n\tint n;\n\tchar s,t,b;\n\tint dp[5][5];\n\tint i1,i2,i3,i4;\n\tdouble ans;\n\n\twhile(1){\n\t\tcin>>n;\n\t\tif(n==0) break;\n\t\tcin>>s>>t>>b;\n\n\t\tmemset(dp,-1,sizeof(dp));\n\t\tfor(i1=1;i1<=3;i1++){\n\t\t\tfor(i2=1;i2<=3;i2++){\n\t\t\t\tdp[i1][i2]=0;\n\t\t\t}\n\t\t}\n\t\tdp[((s-'A')/3)+1][((s-'A')%3)+1] = 1;\n\t\tdp[((b-'A')/3)+1][((b-'A')%3)+1] = -1;\n\n\t\tfor(i1=0;i1<n;i1++){\n\n\t\t\tfor(i2=1;i2<=3;i2++){\n\t\t\t\tfor(i3=1;i3<=3;i3++){\n\t\t\t\t\tif(dp[i2][i3]>0){\n\t\t\t\t\t\tdp[i2][i3]--;\n\t\t\t\t\t\tfor(i4=0;i4<4;i4++){\n\t\t\t\t\t\t\tif(dp[i2+dy[i4]][i3+dx[i4]]==-1) dp[i2][i3]++;\n\t\t\t\t\t\t\telse dp[i2+dy[i4]][i3+dx[i4]]++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tans=double(dp[((t-'A')/3)+1][((t-'A')%3)+1])/pow(4.0,n);\n\t\tprintf(\"%.8lf\\n\",ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\nusing ld = long double;\nconst int dx[4] = { -1,0,1,0 };\nconst int dy[4] = { 0,1,0,-1 };\nint main() {\n\twhile (1) {\n\t\tint N; cin >> N;\n\t\tif (!N)break;\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tint start, elec, goal;\n\t\tstart = s - 'A';\n\t\telec = t - 'A';\n\t\tgoal = b - 'A';\n\t\tvector<vector<ld>>pers(N + 1, vector<ld>(9));\n\t\tpers[0][start] = 1;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tfor (int j = 0; j < 9; ++j) {\n\t\t\t\tint x = j / 3;\n\t\t\t\tint y = j % 3;\n\t\t\t\tfor (int way = 0; way < 4; ++way) {\n\t\t\t\t\tint nextx = x + dx[way];\n\t\t\t\t\tint nexty = y + dy[way];\n\t\t\t\t\tif (nextx >= 0 && nextx <= 2 && nexty >= 0 && nexty <= 2) {\n\t\t\t\t\t\tint nextj = nextx * 3 + nexty;\n\t\t\t\t\t\tif (nextj == goal) {\n\t\t\t\t\t\t\tpers[i + 1][j] += pers[i][j] / 4;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tpers[i + 1][nextj] += pers[i][j] / 4;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tpers[i + 1][j] += pers[i][j] / 4;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout <<setprecision(10)<<fixed<< pers[N][elec] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\nusing namespace std;\n\n#define BLANK 0\n#define STORE 1\n#define CHARGER 2\n\nint main()\n{\n  int n;\n  char s,t,b;\n\n  cout<<setprecision(8);\n  cout<<setiosflags(ios::fixed);\n\n  while(cin>>n,n){\n    int room[3+2][3+2]={0};\n    double dp[16][3+2][3+2]={0};\n    int dx[4]={-1,1,0,0};\n    int dy[4]={0,0,-1,1};\n    int i,j,y,x;\n\n    cin>>s>>t>>b;\n    s-='A';\n    t-='A';\n    b-='A';\n    for(i=0;i<3+2;i++){\n      room[0][i]=STORE;\n      room[i][0]=STORE;\n      room[3+2-1][i]=STORE;\n      room[i][3+2-1]=STORE;\n    }\n    room[(t/3)+1][(t%3)+1]=CHARGER;\n    room[(b/3)+1][(b%3)+1]=STORE;\n    dp[0][(s/3)+1][(s%3)+1]=1.0;\n\n    for(i=1;i<=n;i++){\n      for(y=1;y<=3;y++){\n\tfor(x=1;x<=3;x++){\n\t  for(j=0;j<4;j++){\n\t    int yy=y+dy[j],xx=x+dx[j];\n\t    if(room[yy][xx]==STORE){yy=y;xx=x;}\n\t    dp[i][yy][xx]+=dp[i-1][y][x]/4.0;\n\t  }\n\t}\n      }\n    }\n    cout<<dp[n][(t/3)+1][(t%3)+1]<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint ans;\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tchar n, s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A']=i%3+1;\n\t\tfy[i+'A']=i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d\", &n) , n ){\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\tchar m[5][5] = {0};\n\t\tfor(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;\n\n\t\tans = 0;\n\t\tif( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else{\n\t\t\tsolve( n , m );\n\t\t}\n\t\t//debug( m );\n\t\tprintf(\"%.8f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\n\n\nint main(){\n\tint n;\n\tint dx[]={1,0,-1,0};\n\tint dy[]={0,1,0,-1};\n\tdouble nxt[3][3],cur[3][3];\n\twhile(cin>>n,n){\n\t\tmemset(cur,0,sizeof(cur));\n\t\tint xs[3],ys[3];\n\t\tfor(int i=0;i<3;i++){\n\t\t\tchar c;\n\t\t\tint a;\n\t\t\tcin>>c;\n\t\t\ta=c-'A';\n\t\t\txs[i]=a%3;\n\t\t\tys[i]=a/3;\n\t\t}\n\t\tcur[xs[0]][ys[0]]=1;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tmemset(nxt,0,sizeof(nxt));\n\t\t\tfor(int x=0;x<3;x++){\n\t\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\t\tfor(int i=0;i<4;i++){\n\t\t\t\t\t\tif(x+dx[i]==xs[2]&&y+dy[i]==ys[2]||x+dx[i]<0||2<x+dx[i]||y+dy[i]<0||2<y+dy[i])\n\t\t\t\t\t\t\tnxt[x][y]+=cur[x][y]/4;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tnxt[x+dx[i]][y+dy[i]]+=cur[x][y]/4;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemcpy(cur,nxt,sizeof(cur));\n\t\t}\n\t\tprintf(\"%.8f\\n\",cur[xs[1]][ys[1]]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<cstring>\n#include<string>\nusing namespace std;\nchar fie[3][4]={\"ABC\",\n\t\t\"DEF\",\n\t\t\"GHI\"};\nint N;\nchar s,t,b;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\ndouble dp[16][4][4];\nint used[16][4][4];\ndouble solve(int no,int x,int y){\n  if(no==N){\n    if(fie[x][y]==t) return 1.0f;\n    return 0.0f;\n  }\n  if(used[no][x][y]) return dp[no][x][y];\n  double ret=0.0f;\n  for(int i=0;i<4;i++){\n    int nx = x+dx[i],ny = y+dy[i];\n    if( nx < 0 || ny < 0 || nx>=3 || ny>=3 || fie[nx][ny]==b){\n      ret += solve(no+1,x,y)/4.0f;\n    } else{\n      ret += solve(no+1,nx,ny)/4.0f;\n    }\n  }\n  used[no][x][y]=1;\n  return dp[no][x][y]=ret;\n}\nint main(){\n  while(1){\n    int x,y;\n    cin >> N;\n    if(!N) break;\n    memset(dp,0,sizeof(dp));\n    memset(used,0,sizeof(used));\n    cin >> s >> t >> b;\n    for(int i=0;i<3;i++)\n      for(int j=0;j<3;j++)\n\tif(fie[i][j]==s){\n\t  x=j; y=i;\n\t}\n    printf(\"%.8lf\\n\",solve(0,x,y));\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\nusing namespace std;\nint mp[3][3];\nint dx[] = {0,0,-1,1};\nint dy[] = {1,-1,0,0};\nint ans,all;\nint n;\nchar s,t,b;\nvoid saiki(int x,int y,int bat){\n  if(n == bat) {\n    all++;\n    if((t-'A')%3==x&&(t-'A')/3==y)ans++;\n    return;\n  }\n  for(int i=0;i<4;i++){\n    int nx = x+dx[i];\n    int ny = y+dy[i];\n    if(nx <0 || ny <0 || nx>=3 || ny>=3) saiki(x,y,bat+1);\n    else if((b-'A')%3==nx && (b-'A')/3==ny) saiki(x,y,bat+1);\n    else saiki(nx,ny,bat+1);\n  }\n}\n\nint main() {\n\n\n  while(1) {\n  cin >> n;\n  if(n==0) break;\n  ans = all = 0;\n  cin >> s >> t >> b;\n  saiki((s-'A')%3,(s-'A')/3,0);\n\n  cout << ans <<\" \"<<all <<endl;\n  printf(\"%.8f\\n\",1.0*ans/all);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\nusing namespace std;\ndouble cost[9];\nint n,d[4] = {-3,-1,1,3},START,JUNK,BATTERY; \n\nint solve(int pos,int enegy,double ret,int i)\n{\n  if(enegy < 0)return 0;\n  if(i > 100)return 0;\n  cost[pos] = ret;\n  //if(i > 100)return cost[BATTERY];\n  int e = enegy;\n  for(int k = 0 ; k < 4 ; k++ )\n    {\n  int npos = pos + d[k];\n  if(npos<0 || 9<=npos )continue;\n  if(npos == JUNK){\n    solve(pos,e-1,ret*0.25,i+1);\n  } else  solve(npos,e-1,ret*0.25,i+1);\n }\n}\n\nvoid input()\n{\n  int n;\n  while( cin >> n,n )\n    {\n      fill(cost,cost+9,0.0);\n      char a,b,c;\n\n      cin >> a >> b >> c;\n      START = a - 'A',BATTERY = b - 'A',JUNK = c - 'A';\n\n      solve(START,n,1.0,0);\n      //  cout << aa << endl;\n\n      printf(\"%.8f\\n\",cost[BATTERY]);\n\n      /*      for(int i = 0 ; i < 9 ; i++  ){\n\tcout << cost[i] << \" \";\n\tif((i-2)%3 == 0)  cout << endl;\n\t}*/\n\n    }\n}\n\nint main()\n{\n  input();\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint dp[16][5][5];\nbool grid[5][5];\nconst int px[] = {1, 1, 1, 2, 2, 2, 3, 3, 3};\nconst int py[] = {1, 2, 3, 1, 2, 3, 1, 2, 3};\nconst int dx[] = {-1, 0, 1, 0, 0};\nconst int dy[] = {0, -1, 0, 1, 0};\n\nint main()\n{\n\tint n;\n\twhile (scanf(\"%d\", &n), n){\n\t\tmemset(dp, 0, sizeof(dp));\n\t\tmemset(grid, false, sizeof(grid));\n\t\t\n\t\tchar s, t, b;\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\ts -= 'A'; t -= 'A'; b -= 'A';\n\t\t\n\t\tfor (int i = 0; i < 9; i++){\n\t\t\tgrid[px[i]][py[i]] = (b == i);\n\t\t}\n\t\t\n\t\tdp[0][px[s]][py[s]] = 1;\n\t\tfor (int i = 0; i < n; i++){\n\t\t\tfor (int x = 1; x <= 3; x++){\n\t\t\t\tfor (int y = 1; y <= 3; y++){\n\t\t\t\t\tbool f = false;\n\t\t\t\t\tfor (int dir = 0; dir < 5; dir++){\n\t\t\t\t\t\tint tx = x + dx[dir];\n\t\t\t\t\t\tint ty = y + dy[dir];\n\t\t\t\t\t\tif (grid[tx][ty] || dir == 4){\n\t\t\t\t\t\t\tif (f) continue;\n\t\t\t\t\t\t\tdp[i + 1][x][y] += dp[i][x][y];\n\t\t\t\t\t\t\tf = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse dp[i + 1][tx][ty] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tint sum = 0;\n\t\tint num = 0;\n\t\tfor (int i = 0; i < 9; i++){\n\t\t\tsum += dp[n][px[i]][py[i]];\n\t\t\tnum += dp[n][px[i]][py[i]] * (i == t);\n\t\t}\n\t\t\n\t\tdouble res = (double)num / sum;\n\t\tprintf(\"%d %d\\n\", num, sum);\n\t\t\n\t\tprintf(\"%.8f\\n\", res);\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\nusing namespace std;\n\nconst int MAX = 16;\nconst int NUM = 9;\ndouble f[MAX][NUM];\n\nint main()\n{\t\n\tint n, s, t, b;\n\tchar ts, tt, tb;\n\twhile (cin >> n, n) {\n\t\tcin >> ts >> tt >> tb;\n\t\ts = ts - 'A';\n\t\tt = tt - 'A';\n\t\tb = tb - 'A';\n\t\t\n\t\tfill((double*)f, (double*)(f +  MAX) , 0);\n\t\tf[0][s] = 1.0;\n\t\t\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < NUM; j++) {\n\t\t\t\tif (j >= 3 && (j - 3) != b) f[i + 1][j - 3] += f[i][j] * 0.25;\n\t\t\t\telse f[i + 1][j] += f[i][j] * 0.25;\n\t\t\t\tif (j < 6 && (j + 3) != b) f[i + 1][j + 3] += f[i][j] * 0.25;\n\t\t\t\telse f[i + 1][j] += f[i][j] * 0.25;\n\t\t\t\tif (j % 3 != 0 && (j - 1) != b) f[i + 1][j - 1] += f[i][j] * 0.25;\n\t\t\t\telse f[i + 1][j] += f[i][j] * 0.25;\n\t\t\t\tif (j % 3 != 2 && (j + 1) != b) f[i + 1][j + 1] += f[i][j] * 0.25;\n\t\t\t\telse f[i + 1][j] += f[i][j] * 0.25;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\", f[n][t]);\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\nusing namespace std;\n\nint dx[] = {-1,0,1,0},dy[] = {0,1,0,-1};\n\nint main(){\n\tint n;\n\tchar s,t,b;\n\twhile(cin >> n,n){\n\t\tcin >> s >> t >> b;\n\t\tdouble dp[16][3][3] = {};\n\t\tint sn = s - 'A',tn = t - 'A',bn = b - 'A';\n\t\tdp[0][sn / 3][sn % 3] = 1;\n\t\tfor(int i = 0;i < n;i++){\n\t\t\tfor(int j = 0;j < 3;j++){\n\t\t\t\tfor(int k = 0;k < 3;k++){\n\t\t\t\t\tfor(int l = 0;l < 4;l++){\n\t\t\t\t\t\tint x = j + dx[l],y = k + dy[l];\n\t\t\t\t\t\tif(x >= 0 && x < 3 && y >= 0 && y < 3 && x * 3 + y != bn){\n\t\t\t\t\t\t\tdp[i + 1][x][y] += dp[i][j][k] / 4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse dp[i + 1][j][k] += dp[i][j][k] / 4.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.9f\\n\",dp[n][tn / 3][tn % 3]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <cstring>\nusing namespace std;\nstatic const double EPS = 1e-5;\ntypedef long long ll;\n\n\ndouble p[5][5];\ndouble ne[5][5];\n\nchar s,t,b;\n\n\ndouble pp(int x,int y){\n\tif(b/3+1==x && b%3+1==y)return 0;\n\telse return p[x][y];\n}\n\nint main(){\n\tint n;\n\t\n\twhile(cin>>n){\n\t\tif(n==0)break;\n\t\t\n\t\tcin>>s>>t>>b;\n\t\t\n\t\ts-='A';\n\t\tt-='A';\n\t\tb-='A';\n\t\t\n\t\tfor(int i=0;i<5;i++){\n\t\t\tfor(int j=0;j<5;j++){\n\t\t\t\tp[i][j]=0;\n\t\t\t\tne[i][j]=0;\n\t\t\t}\n\t\t}\n\t\t\n\t\tp[s/3+1][s%3+1]=1;\n\t\t\n\t\twhile(n){\n\t\t\tn--;\n\t\t\tfor(int i=1;i<=3;i++){\n\t\t\t\tfor(int j=1;j<=3;j++){\n\t\t\t\t\tne[i][j]=(pp(i+1,j)+pp(i-1,j)+pp(i,j+1)+pp(i,j-1))/4;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemcpy(p,ne,sizeof(ne));\n\t\t}\n\t\t\n\t\tprintf(\"%.8f\\n\",pp(t/3+1,t%3+1));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cstring>\n\nusing namespace std;\n\nint main() {\n\tint n;\n\twhile (cin >> n, n) {\n\t\tlong double room[3][3][n+1];\n\t\tmemset(room, 0, sizeof(room));\n\n\t\tchar s, t, b;\n\t\tcin >> s >> t >> b;\n\n\t\tint y = (s-'A') / 3;\n\t\tint x = (s-'A') % 3;\n\t\tint by = (b-'A') / 3;\n\t\tint bx = (b-'A') % 3;\n\t\tint gy = (t-'A') / 3;\n\t\tint gx = (t-'A') % 3;\n\n\t\troom[y][x][0] = 1.0;\n\n\t\tint dx[] = {-1, 0, 0, 1};\n\t\tint dy[] = {0, -1, 1, 0};\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\tfor (int l = 0; l < 3; l++) {\n\t\t\t\t\tfor (int j = 0; j < 4; j++) {\n\t\t\t\t\t\tint nx = l + dx[j];\n\t\t\t\t\t\tint ny = k + dy[j];\n\t\t\t\t\t\tif (nx < 0 || 2 < nx || ny < 0 || 2 < ny || (bx == l && by == k)) {\n\t\t\t\t\t\t\troom[k][l][i+1] += room[k][l][i] * 0.25;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\troom[ny][nx][i+1] += room[k][l][i] * 0.25;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout.precision(9);\n\t\tcout << fixed << room[gy][gx][n] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<algorithm>\n#include<array>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<functional>\n#include<limits>\n#include<list>\n#include<map>\n#include<numeric>\n#include<set>\n#include<stack>\n#include<string>\n#include<sstream>\n#include<unordered_map>\n#include<queue>\n#include<vector>\nusing namespace std;\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing pii = pair<int, int>;\n\n#define rep(i,a,b) for(int i=(a);i<(b);i++)\n#define rrep(i,a,b) for(int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n#define dump(o) {cerr<<#o<<\" \"<<o<<endl;}\n#define dumpc(o) {cerr<<#o; for(auto &e:(o))cerr<<\" \"<<e;cerr<<endl;}\n#define INF 0x3f3f3f3f\n#define INFL 0x3f3f3f3f3f3f3f3fLL\nconst int MOD = 1e9 + 7;\n\nint di[4] = { 1,0,-1,0 };\nint dj[4] = { 0,1,0,-1 };\n\nsigned main() {\n\tcout << fixed << setprecision(8);\n\tfor (int n; cin >> n&&n;) {\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tdouble f[3][3] = {};\n\t\tdouble g[3][3] = {};\n\t\tpii S, T, B;\n\t\tS = pii((s - 'A') / 3, (s - 'A') % 3);\n\t\tT = pii((t - 'A') / 3, (t - 'A') % 3);\n\t\tB = pii((b - 'A') / 3, (b - 'A') % 3);\n\t\tf[S.first][S.second] = 1;\n\t\twhile (n--) {\n\t\t\trep(i, 0, 3)rep(j, 0, 3)g[i][j] = 0;\n\t\t\tswap(f, g);\n\t\t\trep(a, 0, 3) rep(b, 0, 3) {\n\t\t\t\tint cnt = 4;\n\t\t\t\trep(i, 0, 4) {\n\t\t\t\t\tif (a + di[i] == B.first&&b + dj[i] == B.second) continue;\n\t\t\t\t\tif (0 > a + di[i] && a + dj[i] > 2)continue;\n\t\t\t\t\tif (0 > b + di[i] && b + dj[i] > 2)continue;\n\t\t\t\t\tf[a + di[i]][b + dj[i]] += g[a][b] / cnt;\n\t\t\t\t}\n\t\t\t\tf[a][b] += (g[a][b] / cnt)*(4 - cnt);\n\t\t\t}\n\t\t}\n\t\tcout << f[T.first][T.second] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <queue>\n\nusing namespace std;\nstruct Point\n{\n\tint x;\n\tint y;\n\tPoint(){};\n\tPoint(int a, int b)\n\t{\n\t\tx = a;\n\t\ty = b;\n\t}\n};\nint dx[4] = { 1, 0, -1, 0 };\nint dy[4] = { 0, -1, 0, 1 };\ndouble dp[17][3][3];\nchar stage[3][3];\n\nvoid solve()\n{\n\tint n;\n\twhile (cin >> n, n)\n\t{\n\t\tchar s, t, b;\n\t\tcin >> s >> t >> b;\n\t\tPoint start, goal, warehouse;\n\t\tstart.x = (s - 'A') % 3;\n\t\tstart.y = (s - 'A') / 3;\n\t\tgoal.x = (t - 'A') % 3;\n\t\tgoal.y = (t - 'A') / 3;\n\t\twarehouse.x = (b - 'A') % 3;\n\t\twarehouse.y = (b - 'A') / 3;\n\t\tfill(dp[0][0], dp[0][0] + 3 * 3 * 17, 0.0);\n\t\tdp[0][start.y][start.x] = 1.0;\n\t\tfor (int i = 0; i < n; ++i)\n\t\t{\n\t\t\tfor (int y = 0; y < 3; ++y)\n\t\t\t{\n\t\t\t\tfor (int x = 0; x < 3; ++x)\n\t\t\t\t{\n\t\t\t\t\tfor (int j = 0; j < 4; ++j)\n\t\t\t\t\t{\n\t\t\t\t\t\tint nx = x + dx[j];\n\t\t\t\t\t\tint ny = y + dy[j];\n\t\t\t\t\t\tif ((nx < 0 || nx >= 3 || ny < 0 || ny >= 3) || (nx == warehouse.x && ny == warehouse.y))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[i + 1][y][x] += dp[i][y][x] / 4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[i + 1][ny][nx] += dp[i][y][x] / 4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.7f\\n\", dp[n][goal.y][goal.x]);\n\t}\n}\n\nint main()\n{\n\tsolve();\n\treturn(0);\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<algorithm>\n#include<array>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<functional>\n#include<limits>\n#include<list>\n#include<map>\n#include<numeric>\n#include<set>\n#include<stack>\n#include<string>\n#include<sstream>\n#include<unordered_map>\n#include<queue>\n#include<vector>\nusing namespace std;\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing pii = pair<int, int>;\n\n#define rep(i,a,b) for(int i=(a);i<(b);i++)\n#define rrep(i,a,b) for(int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n#define dump(o) {cerr<<#o<<\" \"<<o<<endl;}\n#define dumpc(o) {cerr<<#o; for(auto &e:(o))cerr<<\" \"<<e;cerr<<endl;}\n#define INF 0x3f3f3f3f\n#define INFL 0x3f3f3f3f3f3f3f3fLL\nconst int MOD = 1e9 + 7;\n\nint di[4] = { 1,0,-1,0 };\nint dj[4] = { 0,1,0,-1 };\n\nsigned main() {\n\tcout << fixed << setprecision(8);\n\tfor (int n; cin >> n&&n;) {\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tdouble f[3][3] = {};\n\t\tdouble g[3][3] = {};\n\t\tpii S, T, B;\n\t\tS = pii((s - 'A') / 3, (s - 'A') % 3);\n\t\tT = pii((t - 'A') / 3, (t - 'A') % 3);\n\t\tB = pii((b - 'A') / 3, (b - 'A') % 3);\n\t\tf[S.first][S.second] = 1;\n\t\twhile (n--) {\n\t\t\trep(i, 0, 3)rep(j, 0, 3)g[i][j] = 0;\n\t\t\tswap(f, g);\n\t\t\trep(a, 0, 3) rep(b, 0, 3) {\n\t\t\t\tint cnt = 0;\n\t\t\t\trep(i, 0, 4) {\n\t\t\t\t\tif (a + di[i] == B.first&&b + dj[i] == B.second) continue;\n\t\t\t\t\tif (0 > a + di[i] && a + di[i] > 2)continue;\n\t\t\t\t\tif (0 > b + dj[i] && b + dj[i] > 2)continue;\n\t\t\t\t\t//f[a + di[i]][b + dj[i]] += g[a][b] / 4;\n\t\t\t\t\tcnt++;\n\t\t\t\t}\n\t\t\t\tf[a][b] += (g[a][b] / 4)*(4 - cnt);\n\t\t\t}\n\t\t}\n\t\tcout << f[T.first][T.second] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<algorithm>\n#include<iostream>\n#include<cstdio>\n\nusing namespace std;\ntypedef pair<int,int> P;\nconst int dx[4] = {0,1,0,-1};\nconst int dy[4] = {1,0,-1,0};\nP position(char bet){\n  if(bet == 'A')return P(0,0);\n  else if(bet == 'B')return P(0,1);\n  else if(bet == 'C')return P(0,2);\n  else if(bet == 'D')return P(1,0);\n  else if(bet == 'E')return P(1,1);\n  else if(bet == 'F')return P(1,2);\n  else if(bet == 'G')return P(2,0);\n  else if(bet == 'H')return P(2,1);\n  else if(bet == 'I')return P(2,2);\n}\n\nint main(){\n  int n;\n  char sc,tc,bc;\n  P s,t,b;  \n\n  while(cin >> n && n){\n    double dp[3][3][n+1];\n    for(int i=0;i<=n;i++){\n      for(int j=0;j<3;j++){\n\tfor(int k=0;k<3;k++){\n\t  dp[j][k][i] = 0;\n\t}\n      }\n    }\n    cin >> sc >> tc >> bc;\n    s = position(sc);\n    t = position(tc);\n    b = position(bc);\n    dp[s.second][s.first][0] = 1;\n    \n    for(int k=0;k<n;k++){\n      for(int i=0;i<3;i++){\n\tfor(int j=0;j<3;j++){\n\t  if(dp[i][j][k] == 0 || (i == b.second && j == b.first))continue;\n\t  \n\t  for(int ii=0;ii<4;ii++){\n\t    int nx = j+dx[ii],ny = i+dy[ii];\n\t    if(0<=nx && nx <3  && 0<=ny && ny <3 && !(nx == b.first && ny == b.second)){\n\t      dp[ny][nx][k+1] += dp[i][j][k]*0.25;\n\t    }\n\t    else{\n\t      dp[i][j][k+1] += dp[i][j][k]*0.25;\n\t    }\n\t  }\n\n\t}\n      }\n    }\n\n    printf(\"%.8f\\n\",dp[t.second][t.first][n]);\n\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<algorithm>\n#include<array>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<functional>\n#include<limits>\n#include<list>\n#include<map>\n#include<numeric>\n#include<set>\n#include<stack>\n#include<string>\n#include<sstream>\n#include<unordered_map>\n#include<queue>\n#include<vector>\nusing namespace std;\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing pii = pair<int, int>;\n\n#define rep(i,a,b) for(int i=(a);i<(b);i++)\n#define rrep(i,a,b) for(int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n#define dump(o) {cerr<<#o<<\" \"<<o<<endl;}\n#define dumpc(o) {cerr<<#o; for(auto &e:(o))cerr<<\" \"<<e;cerr<<endl;}\n#define INF 0x3f3f3f3f\n#define INFL 0x3f3f3f3f3f3f3f3fLL\nconst int MOD = 1e9 + 7;\n\nint di[4] = { 1,0,-1,0 };\nint dj[4] = { 0,1,0,-1 };\n\nsigned main() {\n\tcout << fixed << setprecision(8);\n\tfor (int n; cin >> n&&n;) {\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tdouble f[3][3] = {};\n\t\tdouble g[3][3] = {};\n\t\tpii S, T, B;\n\t\tS = pii((s - 'A') / 3, (s - 'A') % 3);\n\t\tT = pii((t - 'A') / 3, (t - 'A') % 3);\n\t\tB = pii((b - 'A') / 3, (b - 'A') % 3);\n\t\tf[S.first][S.second] = 1;\n\t\twhile (n--) {\n\t\t\trep(i, 0, 3)rep(j, 0, 3)g[i][j] = 0;\n\t\t\tswap(f, g);\n\t\t\t//rep(a, 0, 3) rep(b, 0, 3) {\n\t\t\t//\tint cnt = 0;\n\t\t\t//\trep(i, 0, 4) {\n\t\t\t//\t\tif (a + di[i] == B.first&&b + dj[i] == B.second) continue;\n\t\t\t//\t\tif (0 > a + di[i] && a + di[i] > 2)continue;\n\t\t\t//\t\tif (0 > b + dj[i] && b + dj[i] > 2)continue;\n\t\t\t//\t\tf[a + di[i]][b + dj[i]] += g[a][b] / 4;\n\t\t\t//\t\tcnt++;\n\t\t\t//\t}\n\t\t\t//\tf[a][b] += (g[a][b] / 4)*(4 - cnt);\n\t\t\t//}\n\t\t}\n\t\tcout << f[T.first][T.second] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cmath>\n#define N 3\n#define N1 16\nusing namespace std;\nvoid func(int,int,int);\nint n,k,data[N][N],memo[N1][N][N];\nint dy[N+1]={-1,0,1,0};\nint dx[N+1]={0,1,0,-1};\nbool visited[N1][N][N];\nchar s,t,b;\n\nint main(){\n  while(1){\n    cin >> n;\n    if(!n) break;\n    cin >> s >> t >> b;\n    for(int i=0;i<N;i++){\n      for(int j=0;j<N;j++){\n\tdata[i][j]=0;\n\tfor(int k=0;k<N1;k++){\n\t  memo[k][i][j]=0;\n\t  visited[k][i][j]=false;\n\t}\n      }\n    }\n    data[(t-'A')/N][(t-'A')%N]=1;\n    data[(b-'A')/N][(b-'A')%N]=-1;\n    func((s-'A')/N,(s-'A')%N,0);\n    k=pow(4,n);\n    printf(\"%.8f\\n\",1.0*memo[0][(s-'A')/N][(s-'A')%N]/k);\n  }\n  return 0;\n}\n\nvoid func(int y,int x,int d){\n  visited[d+1][y][x]=true;\n  if(d==n){\n    if(data[y][x]==1) memo[d][y][x]=1;\n    return ;\n  }\n  for(int i=0;i<N+1;i++){\n    int ny=y+dy[i],nx=x+dx[i];\n    if(ny<0||nx<0||N<ny||N<nx||data[ny][nx]==-1){\n      if(visited[d+1][y][x]==false) func(y,x,d+1);\n      memo[d][y][x]+=memo[d+1][y][x];\n    }\n    else{\n      if(visited[d+1][ny][nx]==false) func(ny,nx,d+1);\n      memo[d][y][x]+=memo[d+1][ny][nx];\n    }\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <sstream>\n#include <map>\n#include <set>\n#include <queue>\n\n#define REP(i,k,n) for(int i=k;i<n;i++)\n#define rep(i,n) for(int i=0;i<n;i++)\n#define INF 1<<30\n#define pb push_back\n#define mp make_pair\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nint n;\nchar s, t, b;\ndouble d, a;\n\nint dy[4] = {1,0, -1, 0};\nint dx[4] = {0,1, 0, -1};\nchar v[3][3] = { {'A', 'B', 'C'},\n                 {'D', 'E', 'F'},\n                 {'G', 'H', 'I'} };\n\nint c[3][3] = { { 2, 3, 2},\n                { 3, 4, 3},\n                { 2, 3, 2} };\n\nbool can(int y,int x) {\n    if(0 <= y && y < 3 && 0 <= x && x < 3) return true;\n    return false;\n}\n\nint main() {\n    while(cin >> n && n) {\n        cin >> s >> t >> b;\n\n        rep(i,3) {\n            rep(j,3) {\n                if(v[i][j] != b) continue;\n\n                rep(k,4) {\n                    int ny = i + dy[k];\n                    int nx = j + dx[k];\n\n                    if(can(ny,nx)) {\n                        c[ny][nx]--;\n                    }\n                }\n            }\n        }\n\n        d = 0;\n        a = 1;\n\n        queue<pair<pair<int,int>, int> > que;\n\n        bool inQ[10];\n        memset(inQ, 0, sizeof(inQ));\n\n        int res[3][3];\n        memset(res, 0, sizeof(res));\n\n        rep(i,3) {\n            rep(j,3) {\n                if(v[i][j] == s) {\n                    rep(k,4) {\n                        int ni = i + dy[k];\n                        int nj = j + dx[k];\n\n                        que.push(mp(mp(ni,nj),0));\n                        res[ni][nj] = 1;\n                    }\n                    que.push(mp(mp(i,j), 0));\n                }\n            }\n        }\n\n        n--;\n\n        while(que.size()) {\n            P p = que.front().first;\n            int cnt = que.front().second;\n\n            que.pop();\n            inQ[p.first*3 + p.second] = false;\n\n            if(cnt == n) {\n                break;\n            }\n\n            a *= c[p.first][p.second];\n            rep(i,4) {\n                int ny = p.first + dy[i];\n                int nx = p.second + dx[i];\n\n                if(can(ny,nx)) {\n                    res[ny][nx] += res[p.first][p.second];\n\n                    if(!inQ[ny*3 + nx]) {\n                        inQ[ny*3 + nx] = true;\n                        que.push(mp(mp(ny,nx),cnt+1));\n                    }\n                }\n            }\n        }\n\n        double sum = 0;\n\n        rep(i,3) {\n            rep(j,3) {\n                // cout << res[i][j] << \" \";\n                sum += res[i][j];\n\n                if(v[i][j] == t) {\n                    d = res[i][j];\n                }\n            }\n        }\n\n        cout << fixed;\n        cout.precision(20);\n        // cout << d << \" \" << sum << endl;\n        cout << d / sum << endl;\n    }\n\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\nchar a[5][5] ={{0,0,0,0,0},\n\t       {0,'A','B','C',0},\n\t       {0,'D','E','F',0},\n\t       {0,'G','H','I',0},\n\t       {0,0,0,0,0}};\nchar t,b;\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\ndouble dp[22][5][5];\ndouble solve(int e,int x,int y){\n  if(!e) return (a[x][y] == t)?1:0;\n  if(dp[e][x][y] >= 0) return dp[e][x][y];\n\n  double g = 0;\n  int c = 0;\n  for(int i = 0; i < 4; i++){\n    int nx = x + dx[i];\n    int ny = y + dy[i];\n    c++;\n    if(a[nx][ny]){\n      if(a[nx][ny] == b){\n\tg += solve(e-1,x,y);\n      }else{\n\tg += solve(e-1,nx,ny);\n      }\n    }else{\n      g += solve(e-1,x,y);\n    }\n  }\n  //printf(\"%f\\n\",g);\n  return dp[e][x][y] = g / c;\n}\nint main(void){\n  while(1){\n    int n;\n    scanf(\"%d\",&n); if(!n) break;\n    memset(dp,-1,sizeof(dp));\n    char s;\n    scanf(\" %c %c %c\",&s,&t,&b);\n    s -= 'A';\n    printf(\"%.10f\\n\",solve(n,s/3+1,s%3+1));\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<vector>\n#include<set>\n#include<map>\n#include<queue>\n#include<algorithm>\n#include<numeric>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<cassert>\n\n#define rep(i,n) for(int i=0;i<n;i++)\n#define all(c) (c).begin(),(c).end()\n#define mp make_pair\n#define pb push_back\n#define rp(i,c) rep(i,(c).size())\n#define fr(i,c) for(__typeof((c).begin()) i=(c).begin();i!=(c).end();i++)\n#define dbg(x) cerr<<#x<<\" = \"<<(x)<<endl\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef pair<int,int> pi;\nconst int inf=1<<28;\nconst double INF=1e12,EPS=1e-9;\n\nint dx[]={-1,0,1,0},dy[]={0,-1,0,1};\n\nint main()\n{\n\tint px[256],py[256];\n\trep(i,3)rep(j,3)px['A'+i*3+j]=j,py['A'+i*3+j]=i;\n\t\n\tint n;\n\twhile(cin>>n,n)\n\t{\n\t\tdouble p[20][3][3]; rep(i,n+1)rep(j,3)rep(k,3)p[i][j][k]=0;\n\t\tchar s,t,b; cin>>s>>t>>b;\n\t\tint bx=px[b],by=py[b];\n\t\t\n\t\tp[0][py[s]][px[s]]=1;\n\t\trep(i,n)rep(j,3)rep(k,3)rep(d,4)\n\t\t{\n\t\t\tint ny=j+dy[d],nx=k+dx[d];\n\t\t\tif(ny<0||nx<0||ny>=3||nx>=3 || ny==by&&nx==bx)ny=j,nx=k;\n\t\t\tp[i+1][ny][nx]+=p[i][j][k]/4;\n\t\t}\n\t\t\n\t\tprintf(\"%.8f\\n\",p[n][py[t]][px[t]]);\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n\nusing namespace std;\n\nint b_row,b_col,memo[16][3][3];\n\nchar b[2];\n\nbool rangeCheck(int row,int col){\n\tif(row >= 0 && row <= 2 && col >= 0 && col <= 2)return true;\n\telse{\n\t\treturn false;\n\t}\n}\n\nint translate(char ch){\n\tswitch(ch){\n\tcase 'A':return 0;\n\tcase 'B':return 1;\n\tcase 'C':return 2;\n\tcase 'D':return 10;\n\tcase 'E':return 11;\n\tcase 'F':return 12;\n\tcase 'G':return 20;\n\tcase 'H':return 21;\n\tcase 'I':return 22;\n\t}\n\n\treturn -1; //must not reach here.\n}\n\nint main(){\n\n\tint n,tmp,energy_row,energy_col,row,col,div_row[4] = {-1,0,0,1},div_col[4] = {0,-1,1,0};\n\tchar start[2],energy[2];\n\n\twhile(true){\n\t\tscanf(\"%d\",&n);\n\t\tif(n == 0)break;\n\n\t\tfor(int i = 0; i < 16; i++){\n\t\t\tfor(int p = 0; p < 3; p++){\n\t\t\t\tfor(int k = 0; k < 3; k++)memo[i][p][k] = 0;\n\t\t\t}\n\n\t\t}\n\n\t\tscanf(\"%s %s %s\",start,energy,b);\n\n\t\ttmp = translate(b[0]);\n\t\tb_row = tmp/10;\n\t\tb_col = tmp%10;\n\n\t\ttmp = translate(energy[0]);\n\t\tenergy_row = tmp/10;\n\t\tenergy_col = tmp%10;\n\n\t\ttmp = translate(start[0]);\n\n\t\trow = tmp/10,col = tmp%10;\n\n\t\tmemo[0][row][col] = 1;\n\n\t\tfor(int loop = 0; loop <= n-1; loop++){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tif(i != b_row || k != b_col){\n\t\t\t\t\t\tfor(int p = 0; p < 4; p++){\n\t\t\t\t\t\t\tif(rangeCheck(i+div_row[p],k+div_col[p]) == true && (i+div_row[p] != b_row || k + div_col[p] != b_col)){\n\t\t\t\t\t\t\t\tmemo[loop+1][i+div_row[p]][k+div_col[p]] += memo[loop][i][k];\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tmemo[loop+1][i][k] += memo[loop][i][k]; \n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\",((double)memo[n][energy_row][energy_col])/((double)pow(4,n)));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <array>\n#include <vector>\n\nusing namespace std;\n\nconst int WALL = -1;\n\nint main() {\n  while ( true ) {\n\tint n;\n\tcin >> n;\n\tif ( n == 0 ) break;\n\tchar s, t, b;\n\tcin >> s >> t >> b;\n\tint is = s - 'A', it = t - 'A', ib = b - 'A';\n\n\tarray<double, 9> table;\n\tfill( table.begin(), table.end(), 0.0 );\n\ttable[ is ] = 1.0;\n\n\tarray<int, 4> dx = { -1, 0, 1, 0 };\n\tarray<int, 4> dy = { 0, -1, 0, 1 };\n\tarray<double, 9> before;\n\t\n\tfor ( int i = 0; i < n; i++ ) {\n\t  before = table;\n\t  fill( table.begin(), table.end(), 0 );\n\t  for ( int y = 0; y < 3; y++ ) {\n\t\tfor ( int x = 0; x < 3; x++ ) {\n\t\t  for ( int j = 0; j < 4; j++ ) {\n\t\t\tint nx = x + dx[ j ];\n\t\t\tint ny = y + dy[ j ];\n\t\t\t\n\t\t\tif ( 0 <= nx and nx < 3 and\n\t\t\t\t 0 <= ny and ny < 3 and\n\t\t\t\t ny * 3 + nx != ib ) {\n\t\t\t  \n\t\t\t  table[ ny * 3 + nx ] += before[ y * 3 + x ] / 4;\n\t\t\t} else {\n\t\t\t  table[ y * 3 + x ] += before[ y * 3 + x ] / 4;\n\t\t\t}\n\t\t  }\n\t\t}\n\t  }\n\t}\n\tcout << table[ it ] << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<queue>\n#include<limits.h>\n#include<math.h>\nusing namespace std;\nstruct Point{int y, x;};\nint nari[3][3];\n\n\nint bfs(int,int,int,int);\nint y11(int);\nint x11(int);\n\nint main(){\n  int n,j,i;\n  char s,t,b;\n  double ans;\n  while(1){\n    cin >> n;\n    if(n == 0)break;\n    cin >> s >> t >> b;\n    bfs(s,t,b,n);\n\n    /*\n    for(int i=0;i<3;i++){\n      for(int j=0;j<3;j++){\n\tcout << nari[i][j];\n\tprintf(\"  \");\n      }\n      cout << endl;\n    }\n    */\n\n\n    /* cout <<\"count=\" <<bfs(s,t,b,n) << endl; */\n \n    printf(\"%.8lf\\n\",(double)bfs(s,t,b,n)/pow(4,n));\n    \n  }\n}\n\n\nint bfs(int s,int t,int b,int n){\n  Point u,v;\n  queue<Point> Q;\n  int ny,nx,count=0,nn=0;\n  int dy[4] = {0,-1,0,1};\n  int dx[4] = {1,0,-1,0};\n\n\n  for(int i = 0; i < 3; i++){\n    for(int j = 0; j < 3; j++)nari[i][j] = INT_MAX;\n  }\n  u.y=y11(s);\n  u.x=x11(s);\n  nari[y11(b)][x11(b)]=-1; //qÉ\n  nari[u.y][u.x]=1; //úÊu\n  Q.push(u);\n\n  while(!Q.empty()){\n    nn++;\n    u = Q.front();\n    Q.pop();\n    \n    for(int r=0;r<4;r++){\n      nx = u.x + dx[r];\n      ny = u.y + dy[r];\n      if( nx<0 || ny<0 || ny>=3 || nx>=3){\n\tnx=u.x;\n\tny=u.y;\n      }      \n      if(ny == y11(t) && nx == x11(t) && pow(4,n-1)>=nn)count++;\n      /*cout << \"nn=\" << nn << endl; */\n      /*cout << \"count =\" << count << endl; */\n      /*cout << \"ny=\" << ny << \", y11(t)=\"<<y11(t) <<endl; */\n      /*cout << \"nx=\" << nx << \", x11(t)=\"<<x11(t) <<endl; */\n\n      if( nari[ny][nx] != INT_MAX)continue;\n\t nari[ny][nx] = nari[u.y][u.x] + 1;\n\t v.x = nx;\n\t v.y = ny;\n\t Q.push(v);\n\t \n    }\n    \n  }    \n  \nreturn count;\n}\n    \nint y11(int s){\n  if(s == 'A')return 0;\n  if(s == 'B')return 0;\n  if(s == 'C')return 0;\n  if(s == 'D')return 1;\n  if(s == 'E')return 1;\n  if(s == 'F')return 1;\n  if(s == 'G')return 2;\n  if(s == 'H')return 2;\n  if(s == 'I')return 2;\n}\n\nint x11(int s){\n  if(s == 'A')return 0;\n  if(s == 'B')return 1;\n  if(s == 'C')return 2;\n  if(s == 'D')return 0;\n  if(s == 'E')return 1;\n  if(s == 'F')return 2;\n  if(s == 'G')return 0;\n  if(s == 'H')return 1;\n  if(s == 'I')return 2;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdlib.h>\n#include<iostream>\n#include<stdio.h>\n#include<string.h>\n#include<math.h>\n#include<algorithm>\n#include<cstring>\n#include<queue>\nusing namespace std;\nint s,t,b,n;\ndouble p,p1,nn;\nint d[4]={1,3,-1,-3};\ndouble df[10][20];\nvoid dfs(int s,int n){\n    if(n==0){\n        if(s==t){p+=pow(0.25,nn);}\n        return;\n    }\n    if(df[s][n]>=0){\n        p+=df[s][n];\n        return;\n    }else{\n        for(int i=0;i<4;i++){\n            if(s+d[i]==b){\n                p1=p;\n                dfs(s,n-1);\n                df[s][n-1]=p-p1;\n            }else if(s/3!=(s+d[i])/3){\n                if(d[i]*d[i]==9&&0<=s+d[i]&&s+d[i]<9){\n                    p1=p;\n                    dfs(s+d[i],n-1);\n                    df[s+d[1]][n-1]=p-p1;\n                }else{\n                    p1=p;\n                    dfs(s,n-1);\n                    df[s][n-1]=p-p1;\n                }\n            }else{\n                p1=p;\n                dfs(s+d[i],n-1);\n                df[s+d[i]][n-1]=p-p1;\n            }\n        }\n    }\n    return;\n}\nint main(){\n    while(1){\n        char cs,ct,cb;\n        p=0;\n        cin>>n;\n        nn=n;\n        if(n==0)break;\n        for(int i=0;i<10;i++){\n            for(int j=0;j<20;j++){\n                df[i][j]=-1;\n            }\n        }\n        cin>>cs>>ct>>cb;\n        s=(int)cs-'A';\n        t=(int)ct-'A';\n        b=(int)cb-'A';\n        dfs(s,n);\n        cout<<p<<endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cmath>\n#define N 3\n#define N1 16\nusing namespace std;\nvoid func(int,int,int);\nint n,k,data[N][N],memo[N1][N][N];\nint dy[N+1]={-1,0,1,0};\nint dx[N+1]={0,1,0,-1};\nbool visited[N1][N][N];\nchar s,t,b;\n\nint main(){\n  while(1){\n    cin >> n;\n    if(!n) break;\n    cin >> s >> t >> b;\n    for(int i=0;i<N;i++){\n      for(int j=0;j<N;j++){\n\tdata[i][j]=0;\n\tfor(int k=0;k<N1;k++){\n\t  memo[k][i][j]=0;\n\t  visited[k][i][j]=false;\n\t}\n      }\n    }\n    data[(t-'A')/N][(t-'A')%N]=1;\n    data[(b-'A')/N][(b-'A')%N]=-1;\n    func((s-'A')/N,(s-'A')%N,0);\n    k=pow(4,n);\n    printf(\"%.8f\\n\",1.0*memo[0][(s-'A')/N][(s-'A')%N]/k);\n  }\n  return 0;\n}\n\nvoid func(int y,int x,int d){\n  visited[d][y][x]=true;\n  if(d==n){\n    if(data[y][x]==1) memo[d][y][x]=1;\n    return ;\n  }\n  for(int i=0;i<N+1;i++){\n    int ny=y+dy[i],nx=x+dx[i];\n    if(ny<0||nx<0||N<ny||N<nx||data[ny][nx]==-1){\n      if(visited[d+1][y][x]==false) func(y,x,d+1);\t\n      memo[d][y][x]+=memo[d+1][y][x];\n    }\n    else{\n      if(visited[d+1][ny][nx]==false) func(ny,nx,d+1);\n      memo[d][y][x]+=memo[d+1][ny][nx];\n    }\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stdio.h>\nusing namespace std;\n\nint dy[]={-1,0,1,0};\nint dx[]={0,1,0.-1};\n\ndouble dp[3][3][16];\nint n;\nchar s,t,b;\nint S,T,B;\n\ndouble solve(int y,int x,int n){\n  if(dp[y][x][n]!=-1.0)return dp[y][x][n];\n  if(n==0)return dp[y][x][n]=(y*3+x==T?1.0:0.0);\n\n  double sum=0.0;\n  for(int i=0;i<4;i++){\n    int ny=y+dy[i];\n    int nx=x+dx[i];\n    if(ny<0||nx<0)continue;\n    if(ny>=3||nx>=3)continue;\n    if(ny*3+nx==B)sum+=solve(y,x,n-1);\n    else sum+=solve(ny,nx,n-1);\n  }\n  return dp[y][x][n]=sum/4.0;\n}\n\nvoid init(){\n  for(int i=0;i<3;i++)\n    for(int j=0;j<3;j++)\n      for(int k=0;k<16;k++)\n\tdp[i][j][k]=-1.0;\n}\n\nint main(){\n  while(1){\n    cin>>n;\n    if(n==0)break;\n    cin>>s>>t>>b;\n    init();\n    S=s-'A';\n    T=t-'A';\n    B=b-'A';\n    printf(\"%.8f\\n\",solve(S/3,S%3,n));\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#include<iostream>\n#include<string.h>\n#include<math.h>\n#include<algorithm>\n#include<cstring>\n#include<queue>\nusing namespace std;\n#define INF 100000000\nint s,t,b,n;\ndouble p,nn;\nint d[4]={1,3,-1,-3};\nint max(int a,int b){\n\tif(a>b){\n\t\treturn a;\n\t}else{\n\t\treturn b;\n\t}\n}\nvoid bfs(int s,int n){\n\tif(n==0){\n\t\tif(s==t)p+=pow(0.25,nn);\n\t\treturn;\n\t}\n\tfor(int i=0;i<4;i++){\n\t\tif(s+d[i]==b){\n\t\t\tbfs(s,n-1);\n\t\t}else if(s/3!=(s+d[i])/3){//3で割った値に注目するのがポイント\n\t\t\tbfs(s,n-1);\n\t\t}else{\n\t\t\tbfs(s+d[i],n-1);\n\t\t}\n\t\treturn;\n\t}\n\n}\nint main(){\n\twhile(1){\n\t\tchar cs,ct,cb;\n\t\tp=0;\n\t\tcin>>n;\n\t\tnn=n;\n\t\tif(n==0)break;\n\t\tcin>>cs>>ct>>cb;\n\t\ts=(int)cs-'A';\n\t\tt=(int)ct-'A';\n\t\tb=(int)cb-'A';\n\t\tbfs(0,n);\n\t\tcout<<p<<endl;\n\t}\n\treturn 0;\n}\t"
  },
  {
    "language": "C++",
    "code": "#include <set>\n#include <map>\n#include <list>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <ctype.h>\n#include <ctime>\n#include <cstdio>\n#include <vector>\n#include <string>\n#include <bitset>\n#include <cctype>\n#include <cstdlib>\n#include <cstring>\n#include <utility>\n#include <numeric>\n#include <complex>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <cassert>\n#include <iostream>\n#include <iterator>\n#include <algorithm>\n\nusing namespace std;\n//参考http://topcoder.g.hatena.ne.jp/isa_rentacs/20111114/1321278656 \n#define REP(i, x, n) for(int i = x; i < n; i++)\n#define rep(i, n) REP(i, 0, n)\n#define lengthof(x) (sizeof(x) / sizeof(*(x)))\n#define FILL(ptr, value) FILL_((ptr), sizeof(ptr)/sizeof(value), (value))\ntemplate <typename T>\nvoid FILL_(void * ptr, size_t size, T value){\n  std::fill((T*)ptr, (T*)ptr+size, value);\n}\n//4方向ベクトル→↑←↓\nint dx[] ={1,0,-1,0};\nint dy[] ={0,-1,0,1};\n\ndouble dp[16][9];\nint dir[4] = {1,3,-1,-3};\nint main()\n{\n  int n;\n  while(cin >>n,n){\n    fill((int*)dp,(int*)(dp+lengthof(dp)),0);\n    char temp;\n    int s,t,b,x,y;\n    cin >>temp;\n    s =(int)(temp -'A');\n    cin >>temp;\n    t =(int)(temp -'A');\n    cin >>temp;\n    b = (int)(temp -'A');\n    dp[0][s] = 1;\n    for(int i = 0;i < n;i++){\n      for(int j = 0;j < 9;j++){\n\tif(dp[i][j] ==0)\n\t  continue;\n\tx = j%3;\n\ty = j/3;\n\tfor(int k = 0;k < 4;k++){\n\t  if(0 <=x+dx[k]&&x +dx[k] <=2\n\t     &&0 <=y +dy[k]&&y +dy[k] <=2\n\t     &&j+dir[k] !=b){\n\t    dp[i+1][j+dir[k]] +=dp[i][j]*0.25;\n\t  }\n\t  else\n\t    dp[i+1][j] +=dp[i][j]*0.25;\n\t}\n      }\n    }\n    printf(\"%.8lf\\n\",dp[n][t]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\n\nint pow(int x, int n) {\n  int ans = 1;\n  for(int i = 0; i < n; i++) {\n    ans *= x;\n  }\n  return ans;\n}\n \nint main() {\n  static int d[4][2] = {{1,0},{0,1},{-1,0},{0,-1}};\n  while(1) {\n    int room[3][3];\n    fill(&room[0][0], &room[2][2]+1, 0);\n    int n;\n    cin >> n;\n    if(n == 0) break;\n\n    char s, t, b;\n    cin >> s >> t >> b;\n    int temp = (int)s-(int)'A';\n    int sx = temp%3;\n    int sy = temp/3;\n    temp = (int)t-(int)'A';\n    int gx = temp%3;\n    int gy = temp/3;\n    temp = (int)b-(int)'A';\n    room[temp/3][temp%3] = 2;\n\n    double value[3][3];\n    fill(&value[0][0], &value[2][2]+1, 0);\n    value[sy][sx] = 1;\n    for(int t = 0; t < n; t++) {\n      double newValue[3][3];\n      fill(&newValue[0][0], &newValue[2][2]+1, 0);\n      for(int i = 0; i < 3; i++) {\n\tfor(int j = 0; j < 3; j++) {\n\t  for(int k = 0; k < 4; k++) {\n\t    int nx = j + d[k][0];\n\t    int ny = i + d[k][1];\n\t    if(nx < 0 || nx >= 3) nx = j;\n\t    if(ny < 0 || ny >= 3) ny = i;\n\t    if(room[ny][nx] == 2) {\n\t      nx = j;\n\t      ny = i;\n\t    }\n\t    newValue[ny][nx] += value[i][j]/4;\n\t  }\n\t}\n      }\n      for(int i = 0; i < 3; i++) {\n\tfor(int j = 0; j < 3; j++) {\n\t  value[i][j] = newValue[i][j];\n\t}\n      }\n    }\n    printf(\"%.8f\\n\", value[gy][gx]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#include<iostream>\n#include<string.h>\n#include<math.h>\n#include<algorithm>\n#include<cstring>\n#include<queue>\nusing namespace std;\n#define INF 100000000\nint s,t,b,n;\ndouble p,nn;\nint d[4]={1,3,-1,-3};\nint max(int a,int b){\n\tif(a>b){\n\t\treturn a;\n\t}else{\n\t\treturn b;\n\t}\n}\nvoid dfs(int s,int n){\n\tif(n==0){\n\t\tif(s==t)p+=pow(0.25,nn);\n\t\treturn;\n\t}\n\tfor(int i=0;i<4;i++){\n\t\tif(s+d[i]==b){\n\t\t\tdfs(s,n-1);\n\t\t}else if(s/3!=(s+d[i])/3){//3で割った値に注目するのがポイント\n\t\t\tif(d[i]*d[i]==9&&0<=s+d[i]&&s+d[i]<9){\n\t\t\t\tdfs(s+d[i],n-1);\n\t\t\t}else{\n\t\t\t\tdfs(s,n-1);\n\t\t\t}\n\t\t}else{\n\t\t\tdfs(s+d[i],n-1);\n\t\t}\n\t}\n\treturn;\n}\nint main(){\n\twhile(1){\n\t\tchar cs,ct,cb;\n\t\tp=0;\n\t\tcin>>n;\n\t\tnn=n;\n\t\tif(n==0)break;\n\t\tcin>>cs>>ct>>cb;\n\t\ts=(int)cs-'A';\n\t\tt=(int)ct-'A';\n\t\tb=(int)cb-'A';\n\t\tdfs(s,n);\n\t\tcout<<p<<endl;\n\t}\n\treturn 0;\n}\t"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\n\nusing namespace std;\n\nint main() {\n\tint n;\n\twhile (cin >> n) {\n\t\tif (n == 0) {\n\t\t\tbreak;\n\t\t}\n\t\tvector< vector<double> > dp(n+1, vector<double>(9, 0.0));\n\t\tchar s, t, b, c;\n\t\tcin >> s >> t >> b; \n\t\t//cout << s << ' ' << t << ' ' << b << endl;\n\t\tdp[0][s-'A'] = 1.0;\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tif (j == 0) {\n\t\t\t\t\tif (b == 'A') {\n\t\t\t\t\t} else if (b == 'B') {\n\t\t\t\t\t\tdp[i+1][0] += dp[i][0]*0.75;\n\t\t\t\t\t\tdp[i+1][3] += dp[i][0]*0.25;\n\t\t\t\t\t} else if (b == 'D') {\n\t\t\t\t\t\tdp[i+1][0] += dp[i][0]*0.75;\n\t\t\t\t\t\tdp[i+1][1] += dp[i][0]*0.25;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i+1][0] += dp[i][0]*0.5;\n\t\t\t\t\t\tdp[i+1][1] += dp[i][0]*0.25;\n\t\t\t\t\t\tdp[i+1][3] += dp[i][0]*0.25;\n\t\t\t\t\t}\n\t\t\t\t} else if (j == 1) {\n\t\t\t\t\tif (b == 'B') {\n\t\t\t\t\t} else if (b == 'A') {\n\t\t\t\t\t\tdp[i+1][1] += dp[i][1]*0.5;\n\t\t\t\t\t\tdp[i+1][2] += dp[i][1]*0.25;\n\t\t\t\t\t\tdp[i+1][4] += dp[i][1]*0.25;\n\t\t\t\t\t} else if (b == 'C') {\n\t\t\t\t\t\tdp[i+1][1] += dp[i][1]*0.5;\n\t\t\t\t\t\tdp[i+1][0] += dp[i][1]*0.25;\n\t\t\t\t\t\tdp[i+1][4] += dp[i][1]*0.25;\n\t\t\t\t\t} else if (b == 'E') {\n\t\t\t\t\t\tdp[i+1][1] += dp[i][1]*0.5;\n\t\t\t\t\t\tdp[i+1][0] += dp[i][1]*0.25;\n\t\t\t\t\t\tdp[i+1][2] += dp[i][1]*0.25;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i+1][1] += dp[i][1]*0.25;\n\t\t\t\t\t\tdp[i+1][0] += dp[i][1]*0.25;\n\t\t\t\t\t\tdp[i+1][2] += dp[i][1]*0.25;\n\t\t\t\t\t\tdp[i+1][4] += dp[i][1]*0.25;\n\t\t\t\t\t}\n\t\t\t\t} else if (j == 2) {\n\t\t\t\t\tif (b == 'C') {\n\t\t\t\t\t} else if (b == 'B') {\n\t\t\t\t\t\tdp[i+1][2] += dp[i][2]*0.75;\n\t\t\t\t\t\tdp[i+1][5] += dp[i][2]*0.25;\n\t\t\t\t\t} else if (b == 'F') {\n\t\t\t\t\t\tdp[i+1][2] += dp[i][2]*0.75;\n\t\t\t\t\t\tdp[i+1][1] += dp[i][2]*0.25;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i+1][2] += dp[i][2]*0.5;\n\t\t\t\t\t\tdp[i+1][1] += dp[i][2]*0.25;\n\t\t\t\t\t\tdp[i+1][5] += dp[i][2]*0.25;\n\t\t\t\t\t}\n\t\t\t\t} else if (j == 3) {\n\t\t\t\t\tif (b == 'D') {\n\t\t\t\t\t} else if (b == 'A') {\n\t\t\t\t\t\tdp[i+1][3] += dp[i][3]*0.5;\n\t\t\t\t\t\tdp[i+1][4] += dp[i][3]*0.25;\n\t\t\t\t\t\tdp[i+1][6] += dp[i][3]*0.25;\n\t\t\t\t\t} else if (b == 'E') {\n\t\t\t\t\t\tdp[i+1][3] += dp[i][3]*0.5;\n\t\t\t\t\t\tdp[i+1][0] += dp[i][3]*0.25;\n\t\t\t\t\t\tdp[i+1][6] += dp[i][3]*0.25;\n\t\t\t\t\t} else if (b == 'G') {\n\t\t\t\t\t\tdp[i+1][3] += dp[i][3]*0.5;\n\t\t\t\t\t\tdp[i+1][0] += dp[i][3]*0.25;\n\t\t\t\t\t\tdp[i+1][4] += dp[i][3]*0.25;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i+1][3] += dp[i][3]*0.25;\n\t\t\t\t\t\tdp[i+1][0] += dp[i][3]*0.25;\n\t\t\t\t\t\tdp[i+1][4] += dp[i][3]*0.25;\n\t\t\t\t\t\tdp[i+1][6] += dp[i][3]*0.25;\n\t\t\t\t\t}\n\t\t\t\t} else if (j == 4) {\n\t\t\t\t\tif (b == 'E') {\n\t\t\t\t\t} else if (b == 'B') {\n\t\t\t\t\t\tdp[i+1][4] += dp[i][4]*0.25;\n\t\t\t\t\t\tdp[i+1][3] += dp[i][4]*0.25;\n\t\t\t\t\t\tdp[i+1][5] += dp[i][4]*0.25;\n\t\t\t\t\t\tdp[i+1][7] += dp[i][4]*0.25;\n\t\t\t\t\t} else if (b == 'D') {\n\t\t\t\t\t\tdp[i+1][4] += dp[i][4]*0.25;\n\t\t\t\t\t\tdp[i+1][1] += dp[i][4]*0.25;\n\t\t\t\t\t\tdp[i+1][5] += dp[i][4]*0.25;\n\t\t\t\t\t\tdp[i+1][7] += dp[i][4]*0.25;\n\t\t\t\t\t} else if (b == 'F') {\n\t\t\t\t\t\tdp[i+1][4] += dp[i][4]*0.25;\n\t\t\t\t\t\tdp[i+1][1] += dp[i][4]*0.25;\n\t\t\t\t\t\tdp[i+1][3] += dp[i][4]*0.25;\n\t\t\t\t\t\tdp[i+1][7] += dp[i][4]*0.25;\n\t\t\t\t\t} else if (b == 'H') {\n\t\t\t\t\t\tdp[i+1][4] += dp[i][4]*0.25;\n\t\t\t\t\t\tdp[i+1][1] += dp[i][4]*0.25;\n\t\t\t\t\t\tdp[i+1][3] += dp[i][4]*0.25;\n\t\t\t\t\t\tdp[i+1][5] += dp[i][4]*0.25;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i+1][1] += dp[i][4]*0.25;\n\t\t\t\t\t\tdp[i+1][3] += dp[i][4]*0.25;\n\t\t\t\t\t\tdp[i+1][5] += dp[i][4]*0.25;\n\t\t\t\t\t\tdp[i+1][7] += dp[i][4]*0.25;\n\t\t\t\t\t}\n\t\t\t\t} else if (j == 5) {\n\t\t\t\t\tif (b == 'F') {\n\t\t\t\t\t} else if (b == 'C') {\n\t\t\t\t\t\tdp[i+1][5] += dp[i][5]*0.5;\n\t\t\t\t\t\tdp[i+1][4] += dp[i][5]*0.25;\n\t\t\t\t\t\tdp[i+1][8] += dp[i][5]*0.25;\n\t\t\t\t\t} else if (b == 'E') {\n\t\t\t\t\t\tdp[i+1][5] += dp[i][5]*0.5;\n\t\t\t\t\t\tdp[i+1][2] += dp[i][5]*0.25;\n\t\t\t\t\t\tdp[i+1][8] += dp[i][5]*0.25;\n\t\t\t\t\t} else if (b == 'I') {\n\t\t\t\t\t\tdp[i+1][5] += dp[i][5]*0.5;\n\t\t\t\t\t\tdp[i+1][2] += dp[i][5]*0.25;\n\t\t\t\t\t\tdp[i+1][4] += dp[i][5]*0.25;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i+1][5] += dp[i][5]*0.25;\n\t\t\t\t\t\tdp[i+1][2] += dp[i][5]*0.25;\n\t\t\t\t\t\tdp[i+1][4] += dp[i][5]*0.25;\n\t\t\t\t\t\tdp[i+1][8] += dp[i][5]*0.25;\n\t\t\t\t\t}\n\t\t\t\t} else if (j == 6) {\n\t\t\t\t\tif (b == 'G') {\n\t\t\t\t\t} else if (b == 'D') {\n\t\t\t\t\t\tdp[i+1][6] += dp[i][6]*0.75;\n\t\t\t\t\t\tdp[i+1][7] += dp[i][6]*0.25;\n\t\t\t\t\t} else if (b == 'H') {\n\t\t\t\t\t\tdp[i+1][6] += dp[i][6]*0.75;\n\t\t\t\t\t\tdp[i+1][3] += dp[i][6]*0.25;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i+1][6] += dp[i][6]*0.5;\n\t\t\t\t\t\tdp[i+1][3] += dp[i][6]*0.25;\n\t\t\t\t\t\tdp[i+1][7] += dp[i][6]*0.25;\n\t\t\t\t\t}\n\t\t\t\t} else if (j == 7) {\n\t\t\t\t\tif (b == 'H') {\n\t\t\t\t\t} else if (b == 'E') {\n\t\t\t\t\t\tdp[i+1][7] += dp[i][7]*0.5;\n\t\t\t\t\t\tdp[i+1][6] += dp[i][7]*0.25;\n\t\t\t\t\t\tdp[i+1][8] += dp[i][7]*0.25;\n\t\t\t\t\t} else if (b == 'G') {\n\t\t\t\t\t\tdp[i+1][7] += dp[i][7]*0.5;\n\t\t\t\t\t\tdp[i+1][4] += dp[i][7]*0.25;\n\t\t\t\t\t\tdp[i+1][8] += dp[i][7]*0.25;\n\t\t\t\t\t} else if (b == 'I') {\n\t\t\t\t\t\tdp[i+1][7] += dp[i][7]*0.5;\n\t\t\t\t\t\tdp[i+1][4] += dp[i][7]*0.25;\n\t\t\t\t\t\tdp[i+1][6] += dp[i][7]*0.25;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i+1][7] += dp[i][7]*0.25;\n\t\t\t\t\t\tdp[i+1][4] += dp[i][7]*0.25;\n\t\t\t\t\t\tdp[i+1][6] += dp[i][7]*0.25;\n\t\t\t\t\t\tdp[i+1][8] += dp[i][7]*0.25;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (b == 'I') {\n\t\t\t\t\t} else if (b == 'F') {\n\t\t\t\t\t\tdp[i+1][8] += dp[i][8]*0.75;\n\t\t\t\t\t\tdp[i+1][7] += dp[i][8]*0.25;\n\t\t\t\t\t} else if (b == 'H') {\n\t\t\t\t\t\tdp[i+1][8] += dp[i][8]*0.75;\n\t\t\t\t\t\tdp[i+1][5] += dp[i][8]*0.25;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i+1][8] += dp[i][8]*0.5;\n\t\t\t\t\t\tdp[i+1][5] += dp[i][8]*0.25;\n\t\t\t\t\t\tdp[i+1][7] += dp[i][8]*0.25;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.10f\\n\", dp[n][t-'A']);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <vector>\n#include <string>\n#include <map>\n#include <sstream>\n#include <queue>\n#include <cstdlib>\n#include <algorithm>\n#include <iterator>\n#include <stack>\n#include <list>\nusing namespace std;\n#define INF 100000000\ntypedef long long int lli;\ntypedef pair<int,int> P;\ndouble dp[16][9];\n\nvoid room(char c,int &x){\n\tswitch(c){\n\t\tcase 'A':\n\t\tx=0;\n\t\tbreak;\n\t\t\n\t\tcase 'B':\n\t\tx=1;\n\t\tbreak;\n\t\t\n\t\tcase 'C':\n\t\tx=2;\n\t\tbreak;\n\t\t\t\n\t\tcase 'D':\n\t\tx=3;\n\t\tbreak;\n\t\t\n\t\tcase 'E':\n\t\tx=4;\n\t\tbreak;\n\t\t\n\t\tcase 'F':\n\t\tx=5;\n\t\tbreak;\n\t\t\n\t\tcase 'G':\n\t\tx=6;\n\t\tbreak;\n\t\t\n\t\tcase 'H':\n\t\tx=7;\n\t\tbreak;\n\t\t\n\t\tcase 'I':\n\t\tx=8;\n\t\tbreak;\n\t\t\n\t\tdefault:\n\t\tbreak;\n\t}\n}\n\nint main(){\n\tint n;\n\twhile(cin>>n&&n){\n\t\tchar s,t,b;\n\t\tcin >> s >> t >> b;\n\t\tint sr,tr,br;\n\t\troom(s,sr);\n\t\troom(t,tr);\n\t\troom(b,br);\n\t\tcout << sr << \" \" << tr << \" \" << br << \"\\n\";\n\t\tfor(int i=0; i<=n; ++i){\n\t\t\tfor(int j=0; j<9; ++j){\n\t\t\t\tdp[i][j]=0;\n\t\t\t}\n\t\t}\n\t\tdp[0][sr]=1;\n\t\tfor(int i=1; i<=n; ++i){\n\t\t\tfor(int j=0; j<9; ++j){\n\t\t\t\tif(j!=br){\n\t\t\t\t\tswitch(j){\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][1]/4+dp[i-1][3]/4+dp[i-1][0]/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][0]/4+dp[i-1][4]/4+dp[i-1][2]/4+dp[i-1][1]/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][1]/4+dp[i-1][5]/4+dp[i-1][2]/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][0]/4+dp[i-1][4]/4+dp[i-1][6]/4+dp[i-1][3]/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][1]/4+dp[i-1][5]/4+dp[i-1][7]/4+dp[i-1][3]/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\t\tcase 5:\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][2]/4+dp[i-1][4]/4+dp[i-1][8]/4+dp[i-1][5]/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 6:\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][3]/4+dp[i-1][7]/4+dp[i-1][6]/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 7:\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][6]/2+dp[i-1][4]/4+dp[i-1][8]/4+dp[i-1][7]/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 8:\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][5]/4+dp[i-1][7]/4+dp[i-1][8]/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << dp[n][tr] << \"\\n\";\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nint able[9][4];\nchar t;\nint acc, fal;\n\nvoid solve(int battery, char room, int dst)\n{\n\tif(able[room-'A'][dst]){\n\t\tif(dst == 0)      room -= 3;\n\t\telse if(dst == 1) ++room;\n\t\telse if(dst == 2) room += 3;\n\t\telse              --room;\n\t}\n\t\n\t--battery;\n\tif(battery == 0){\n\t\tif(room == t)\n\t\t\t++acc;\n\t\telse\n\t\t\t++fal;\n\t}else{\n\t\tfor(int i=0 ; i<4 ; ++i)\n\t\t\tsolve(battery, room, i);\n\t}\n}\n\nint main()\n{\n\tint n;\n\tchar s;\n\t\n\twhile(scanf(\"%d\", &n), n){\n\t\tchar b;\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\tacc = fal = 0;\n\t\t\n\t\tfor(int i=0 ; i<9 ; ++i){\n\t\t\tfor(int j=0 ; j<4 ; ++j)\n\t\t\t\table[i][j] = 1;\n\t\t\t\n\t\t\tif(i<3)    able[i][0] = 0;\n\t\t\tif(i>5)    able[i][2] = 0;\n\t\t\tif(i%3==0) able[i][3] = 0;\n\t\t\tif(i%3==2) able[i][1] = 0;\n\t\t}\n\t\t\n\t\tb -= 'A';\n\t\tif(b>=3)   able[b-3][2] = 0;\n\t\tif(b<=5)   able[b+3][0] = 0;\n\t\tif(b%3!=0) able[b-1][1] = 0;\n\t\tif(b%3!=2) able[b+1][3] = 0;\n\t\t\n\t\tfor(int i=0 ; i<4 ; ++i)\n\t\t\tsolve(n, s, i);\n\t\t\n\t\tprintf(\"%lf\\n\", (double)acc/(acc+fal));\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n\nusing namespace std;\n\nint b_row,b_col,memo[16][3][3];\n\nchar b[2];\n\nbool rangeCheck(int row,int col){\n\tif(row >= 0 && row <= 2 && col >= 0 && col <= 2)return true;\n\telse{\n\t\treturn false;\n\t}\n}\n\nint translate(char ch){\n\tswitch(ch){\n\tcase 'A':return 0;\n\tcase 'B':return 1;\n\tcase 'C':return 2;\n\tcase 'D':return 10;\n\tcase 'E':return 11;\n\tcase 'F':return 12;\n\tcase 'G':return 20;\n\tcase 'H':return 21;\n\tcase 'I':return 22;\n\t}\n\n\treturn -1; //must not reach here.\n}\n\nint main(){\n\n\tint n,tmp,energy_row,energy_col,row,col;\n\tchar start[2],energy[2];\n\n\twhile(true){\n\t\tscanf(\"%d\",&n);\n\t\tif(n == 0)break;\n\n\t\tfor(int i = 0; i < 16; i++){\n\t\t\tfor(int p = 0; p < 3; p++){\n\t\t\t\tfor(int k = 0; k < 3; k++)memo[i][p][k] = 0;\n\t\t\t}\n\n\t\t}\n\n\t\tscanf(\"%s %s %s\",start,energy,b);\n\n\t\ttmp = translate(b[0]);\n\t\tb_row = tmp/10;\n\t\tb_col = tmp%10;\n\n\t\ttmp = translate(energy[0]);\n\t\tenergy_row = tmp/10;\n\t\tenergy_col = tmp%10;\n\n\t\ttmp = translate(start[0]);\n\n\t\trow = tmp/10,col = tmp%10;\n\n\t\tmemo[0][row][col] = 1;\n\n\t\tif(rangeCheck(row,col-1) == true && (row != b_row || col-1 != b_col)){\n\t\t\tmemo[1][row][col-1] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row,col+1) == true && (row != b_row || col+1 != b_col)){\n\t\t\tmemo[1][row][col+1] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row-1,col) == true && (row-1 != b_row || col != b_col)){\n\t\t\tmemo[1][row-1][col] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row+1,col) == true && (row+1 != b_row || col != b_col)){\n\t\t\tmemo[1][row+1][col] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tfor(int loop = 2; loop <= n; loop++){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tif(i == b_row && k == b_col){\n\t\t\t\t\t\tmemo[loop][i][k] = 0;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(i == 0 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][0][0] = memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][0][0] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][0][0] += memo[loop-1][1][0];\n\t\t\t\t\t\t}else if(i == 0 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][0][1] = memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 0)memo[loop][0][1] += memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][0][1] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 2)memo[loop][0][1] += memo[loop-1][0][2];\n\t\t\t\t\t\t}else if(i == 0 && k == 2){\n\t\t\t\t\t\t\tmemo[loop][0][2] = memo[loop-1][0][2];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][0][2] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][0][2] += memo[loop-1][1][2];\n\t\t\t\t\t\t}else if(i == 1 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][1][0] = memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 0)memo[loop][1][0] += memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][1][0] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 0)memo[loop][1][0] += memo[loop-1][2][0];\n\t\t\t\t\t\t}else if(i == 1 && k == 1){\n\t\t\t\t\t\t\tif(b_row == 1 || b_col == 1){ //????????????????§??????§???????????????????????´?????¨????????????????????§??????????????????????¶??????????????????????\n\t\t\t\t\t\t\t\tmemo[loop][1][1] = memo[loop-1][1][1];\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][1][1] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][1][1] += memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][1][1] += memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][1][1] += memo[loop-1][2][1];\n\t\t\t\t\t\t}else if(i == 1 && k == 2){\n\t\t\t\t\t\t\tmemo[loop][1][2] = memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 2)memo[loop][1][2] += memo[loop-1][0][2];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][1][2] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 2)memo[loop][1][2] += memo[loop-1][2][2];\n\t\t\t\t\t\t}else if(i == 2 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][2][0] = memo[loop-1][2][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][2][0] += memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][2][0] += memo[loop-1][2][1];\n\t\t\t\t\t\t}else if(i == 2 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][2][1] = memo[loop-1][2][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 0)memo[loop][2][1] += memo[loop-1][2][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][2][1] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 2)memo[loop][2][1] += memo[loop-1][2][2];\n\t\t\t\t\t\t}else{ //i == 2 && k == 2\n\t\t\t\t\t\t\tmemo[loop][2][2] = memo[loop-1][2][2];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][2][2] += memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][2][2] += memo[loop-1][2][1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\",((double)memo[n][energy_row][energy_col])/((double)pow(4,n)));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <set>\n#include <map>\n#include <list>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <ctype.h>\n#include <ctime>\n#include <cstdio>\n#include <vector>\n#include <string>\n#include <bitset>\n#include <cctype>\n#include <cstdlib>\n#include <cstring>\n#include <utility>\n#include <numeric>\n#include <complex>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <cassert>\n#include <iostream>\n#include <iterator>\n#include <algorithm>\n\nusing namespace std;\n\n#define REP(i, x, n) for(int i = x; i < n; i++)\n#define rep(i, n) REP(i, 0, n)\n\n//4方向ベクトル→↑←↓\nint dx[] ={1,0,-1,0};\nint dy[] ={0,-1,0,1};\nint n;\nchar s;//最初にロボットがいる部屋\nchar t;//充電器のある部屋\nchar b;//倉庫として使っている部屋を示す大文字のアルファベット\nchar start;\nchar battery;\nchar souko;\nint nenryo;\nchar board[3][3]={\n  {'A','B','C'},\n  {'D','E','F'},\n  {'G','H','I'}\n};\nint main()\n{\n  srand(time(NULL));\n  while(cin>>n,n){\n\n  double ans = 0;\n  scanf(\" %c %c %c\", &s, &t, &b);\n  for(int k = 0;k < 90000000;k++){\n  int x;\n  int y;\n  start = s;\n  battery = t;\n  souko =b;\n  nenryo = n;\n  while(nenryo--){\n    for(int i = 0;i < 3;i++){\n      for(int j = 0;j < 3;j++){\n\tif(board[i][j] ==start){\n\t  x = j;\n\t  y = i;\n\t}\n      }\n    }\n    int ransu =rand()%4;\n    int nextx =x+dx[ransu];\n    int nexty =y+dy[ransu];\n    if(nexty <0||nextx >2||nexty <0||nexty >2||board[nexty][nextx] ==souko)\n      continue;\n    else\n      start = board[nexty][nextx];\n  }\n  if(start ==battery)\n    ans++;\n  }\n  printf(\"%f\\n\",ans/90000000);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cmath>\n#define N 3\n#define N1 16\nusing namespace std;\nvoid func(int,int,int);\nint n,k,data[N][N],memo[N1][N][N];\nint dy[N+1]={-1,0,1,0};\nint dx[N+1]={0,1,0,-1};\nbool visited[N1][N][N];\nchar s,t,b;\n\nint main(){\n  while(1){\n    cin >> n;\n    if(!n) break;\n    cin >> s >> t >> b;\n    for(int i=0;i<N;i++){\n      for(int j=0;j<N;j++){\n\tdata[i][j]=0;\n\tfor(int k=0;k<N1;k++){\n\t  memo[k][i][j]=0;\n\t  visited[k][i][j]=false;\n\t}\n      }\n    }\n    data[(t-'A')/N][(t-'A')%N]=1;\n    data[(b-'A')/N][(b-'A')%N]=-1;\n    func((s-'A')/N,(s-'A')%N,0);\n    k=pow(4,n);\n    printf(\"%.8f\\n\",1.0*memo[0][(s-'A')/N][(s-'A')%N]/k);\n  }\n  return 0;\n}\n\nvoid func(int y,int x,int d){\n  visited[d][y][x]=true;\n  if(d==n){\n    if(data[y][x]==1) memo[d][y][x]=1;\n    return ;\n  }\n  for(int i=0;i<N+1;i++){\n    int ny=y+dy[i],nx=x+dx[i];\n    if(ny<0||nx<0||N<=ny||N<=nx||data[ny][nx]==-1){\n      if(visited[d+1][y][x]==false) func(y,x,d+1);\t\n      memo[d][y][x]+=memo[d+1][y][x];\n    }\n    else{\n      if(visited[d+1][ny][nx]==false) func(ny,nx,d+1);\n      memo[d][y][x]+=memo[d+1][ny][nx];\n    }\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\ndouble dp[15][3][3]={};\nint dx[4]={1,-1,0,0};\nint dy[4]={0,0,1,-1};\nint bx,by;\nint tx,ty;\n\ndouble rec(int rest,int x,int y){\n     //cout<<\"x:\"<<x<<\"y:\"<<y<<endl;\n     if(x<0||x>2||y<0||y>2)return 0;\n     if(dp[rest][x][y]>0)return dp[rest][x][y];\n\n     if(rest==0){\n\t  if(x==tx&&y==ty)return 1;\n\t  else return 0;\n     }\n     double sum=0;\n     for(int i=0;i<4;i++){\n\t  if(((x+dx[i]==bx)&&(y+dy[i]==by))||x+dx[i]<0||x+dx[i]>2||y+dy[i]>2||y+dy[i]<0){\n\t       sum+=rec(rest-1,x,y);\n\t       }else{\n\t       sum+=rec(rest-1,x+dx[i],y+dy[i]);\n\t  }\n     }\n     sum=sum/4.0;\n     dp[rest][x][y]=sum;\n     return sum;\n}\nvoid topoint(char a,int &x,int &y){\n     int tmp=a-'A';\n     x=tmp/3;\n     y=tmp%3;\n     return;\n}\nint main(){\n     int N;\n     cout.precision(8);\n     cout.setf(ios::fixed);\n     while(cin>>N,N){\n\t  char s,t,b;\n\t  cin>>s>>t>>b;\n\t  int sx,sy;\n\t  topoint(s,sx,sy);\n\t  topoint(t,tx,ty);\n\t  topoint(b,bx,by);\n\t  //cout<<sx<<\":\"<<sy<<\" \"<<tx<<\":\"<<ty<<endl;\n\t  cout<<rec(N,sx,sy)<<endl;\n\t  for(int i=0;i<15;i++){\n\t       for(int j=0;j<3;j++){\n\t\t    for(int k=0;k<3;k++){\n\t\t\t dp[i][j][k]=0;\n\t\t    }\n\t       }\n\t  }\n\t\t   \n     }\n     return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<stack>\n#include<queue>\n#include<cstdio>\n#include<climits>\n#include<cmath>\n#include<cstring>\n#include<string>\n\n#define f first\n#define s second\n#define mp make_pair\n\n#define REP(i,n) for(int i=0; i<(int)(n); i++)\n#define FOR(i,c) for(__typeof((c).begin()) i=(c).begin(); i!=(c).end(); i++)\n#define ALL(c) (c).begin(), (c).end()\n\nusing namespace std;\n\ntypedef unsigned int uint;\ntypedef long long ll;\n\nint main(){\n  int n;\n  const int dx[4] = { 1,-1, 0, 0};\n  const int dy[4] = { 0, 0, 1,-1};\n\n  while(scanf(\"%d \",&n),n){\n    char s,t,b;\n    double d[3][3] = {{0.0}};\n    scanf(\" %c %c %c \",&s,&t,&b);\n    s -= 'A'; t -= 'A'; b -= 'A';\n    d[s/3][s%3] = 1.0;\n\n    REP(i,n){\n      double dn[3][3] = {{0.0}};\n      REP(y,3) REP(x,3){\n\tREP(i,4){\n\t  int xx = x + dx[i];\n\t  int yy = y + dy[i];\n\t  if(xx >= 0 && xx <3 && yy >= 0 && yy <3 && (xx != b%3 || yy != b/3))\n\t     dn[yy][xx] += d[y][x]/4;\n\t     else\n\t       dn[y][x] += d[y][x]/4;\n\t}\n      }\n      memcpy(d,dn,sizeof(d));\n      //REP(y,3){REP(x,3)printf(\"%.2f \",d[y][x]);puts(\"\");}puts(\"\");\n    }\n    printf(\"%.8f\\n\",d[t/3][t%3]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cmath>\n#include <stdio.h>\nusing namespace std;\n\ntypedef long long int ll;\n\nint patterns[2][10];\nint s, t, b;\n\nvoid getMovablePoints(int* ret, int s) {\n\t//up\n\tret[0] = s - 3;\n\t//right\n\tret[1] = s + 1;\n\tif(ret[1] % 3== 0)\n\t\tret[1] = s;\n\t//down\n\tret[2] = s + 3;\n\t//left\n\tret[3] = s - 1;\n\tif(s % 3 == 0)\n\t\tret[3] = s;\n\tfor (int i = 0; i < 4; i++) {\n\t\tif(ret[i] < 0 || 8 < ret[i] || ret[i] == b)\n\t\t\tret[i] = s;\n\t}\n}\n\nint main() {\n\tint n;\n\twhile(cin >> n, n) {\n\t\tchar _s, _t, _b;\n\t\tcin >> _s >> _t >> _b;\n\t\ts = _s - 'A';\n\t\tt = _t - 'A';\n\t\tb = _b - 'A';\n\t\tfor (int i = 0; i < 9; i++) {\n\t\t\tpatterns[0][i] = patterns[1][i] = 0;\n\t\t}\n\t\tpatterns[0][s] = 1;\n\t\tint *pattern, *nextPattern;\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tpattern = patterns[i % 2];\n\t\t\tnextPattern = patterns[(i+1) % 2];\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tnextPattern[j] = 0;\n\t\t\t}\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tint movablePoints[4];\n\t\t\t\tgetMovablePoints(movablePoints, j);\n\t\t\t\tfor (int k = 0; k < 4; k++) {\n\t\t\t\t\tnextPattern[movablePoints[k]] += pattern[j];\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tll sum = 0;\n\t\tfor (int i = 0; i < 9; i++) {\n\t\t\tsum += nextPattern[i];\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\", (double)nextPattern[t] / sum);\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 100000000\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P> PP;\n\nstatic const double EPS = 1e-8;\n\nconst int tx[] = {0,1,0,-1};\nconst int ty[] = {-1,0,1,0};\n\nchar stage[3][3];\n\n\nint main(){\n\tint n;\n\twhile(~scanf(\"%d\",&n)){\n\t\tif(n==0) break;\n\n\t\tchar s,t,b;\n\t\tmemset(stage,'.',sizeof(stage));\n\t\tcin >> s >> t >> b;\n\t\tint sx = (s-'A')%3;\n\t\tint sy = (s-'A')/3;\n\t\tint gx = (t-'A')%3;\n\t\tint gy = (t-'A')/3;\n\t\tstage[(b-'A')/3][(b-'A')%3] = 'B';\n\n\t\tqueue<PP> que;\n\n\t\tbool visited[3][3][16];\n\t\tmemset(visited,0,sizeof(visited));\n\t\tque.push(PP(n,P(sx,sy)));\n\t\tvisited[sy][sx][n] = true;\n\t\tint all=0;\n\t\tint ok=0;\n\n\t\twhile(!que.empty()){\n\t\t\tint cost = que.front().first;\n\t\t\tint sx = que.front().second.first;\n\t\t\tint sy = que.front().second.second;\n\t\t\tque.pop();\n\n\t\t\tif(cost==0){\n\t\t\t\tall++;\n\t\t\t\tif(sx==gx && sy==gy){\n\t\t\t\t\tok++;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tfor(int i=0;i<4;i++){\n\t\t\t\tint dx = sx + tx[i];\n\t\t\t\tint dy = sy + ty[i]; \n\t\t\t\tif((dx < 0 || dx >= 3 || dy < 0 || dy >= 3) && !visited[sy][sx][cost-1]){\n\t\t\t\t\t//visited[sy][sx][cost-1] = true;\n\t\t\t\t\tque.push(PP(cost-1,P(sx,sy)));\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif(dx < 0 || dx >= 3 || dy < 0 || dy >= 3) continue;\n\n\t\t\t\tif(stage[dy][dx] != 'B' && !visited[dy][dx][cost-1]){\n\t\t\t\t\t//visited[dy][dx][cost-1] = true;\n\t\t\t\t\tque.push(PP(cost-1,P(dx,dy)));\n\t\t\t\t}\n\t\t\t\telse if(stage[dy][dx] == 'B' && !visited[sy][sx][cost-1]){\n\t\t\t\t\t//visited[sy][sx][cost-1] = true;\n\t\t\t\t\tque.push(PP(cost-1,P(sx,sy)));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%lf\\n\",(double)ok/(double)all);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint grd[3][3];\ndouble dp[3][3][20];\nint mx[]={-1,1,0,0},my[]={0,0,-1,1};\nchar abc[3][4]={\"ABC\",\"DEF\",\"GHI\"};\ndouble dfs(int x,int y,int n){\n\tif(dp[y][x][n]!=0)\treturn dp[y][x][n];\n\tif(n==0){\n\t\tif(grd[x][y]==1)\treturn dp[y][x][n]=1.0;\n\t\telse \treturn dp[y][x][n]=0.0;\n\t}\n\tdouble ret=0.0;\n\tfor(int i=0;i<4;i++){\n\t\tint cx=x+mx[i],cy=y+my[i];\n\t\tif(cx<0||2<cx||cy<0||2<cy)\tret+=dfs(x,y,n-1)*0.25;\n\t\telse if(grd[cy][cx]==2)\tret+=dfs(x,y,n-1)*0.25;\n\t\telse \tret+=dfs(cx,cy,n-1)*0.25;\n\t}\n\treturn dp[y][x][n]=ret;\n}\nint main(){\n\twhile(true){\n\t\tint n;\tcin>>n;\n\t\tif(n==0)\treturn 0;\n\t\tchar s,t,b;\tscanf(\" %c %c %c\",&s,&t,&b);\n\t\tmemset(grd,0,sizeof(grd));\tmemset(dp,0,sizeof(dp));\n\t\tint sx,sy;\n\t\tfor(int i=0;i<3;i++){\n\t\t\tfor(int j=0;j<3;j++){\n\t\t\t\tif(abc[i][j]==s){\n\t\t\t\t\tsx=j;\tsy=i;\n\t\t\t\t}\n\t\t\t\telse if(abc[i][j]==t)\tgrd[i][j]=1;\n\t\t\t\telse if(abc[i][j]==b)\tgrd[i][j]=2;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.15lf\\n\",dfs(sx,sy,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\nusing namespace std;\n\nstring M[3] = {\n\t\"ABC\",\n\t\"DEF\",\n\t\"GHI\"\n};\n\nvector < vector <bool> > V;\n\nchar s, t, b;\nint g;\nint cnt;\n\nchar get( const int x, const int y )\n{\n\treturn M[y][x];\n}\n\nvoid visit( const int x, const int y )\n{\n\tV[y][x] = true;\n}\n\nbool is_visited( const int x, const int y )\n{\n\treturn V[y][x];\n}\n\nvoid search( int &x, int &y, const char c )\n{\n\tfor ( int i = 0; i < 3; i++ )\n\t{\n\t\tfor ( int j = 0; j < 3; j++ )\n\t\t{\n\t\t\tif ( get( i, j ) == c )\n\t\t\t{\n\t\t\t\tx = i;\n\t\t\t\ty = j;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvoid bf( const int x, const int y, const int n )\n{\n\tif ( n == 0 )\n\t{\n\t\tif ( get( x, y ) == t )\n\t\t\tg++;\n\t\tcnt++;\n\t\treturn;\n\t}\n\n\tconst int dx[4] = { 0, 0, 1, -1 };\n\tconst int dy[4] = { 1, -1, 0, 0 };\n\n\tfor ( int i = 0; i < 4; i++ )\n\t{\n\t\tint nx = x + dx[i];\n\t\tint ny = y + dy[i];\n\n\t\tif ( nx < 0 || nx >= 3 || ny < 0 || ny >= 3 )\n\t\t{\n\t\t\tbf( x, y, n - 1 );\n\t\t\tcontinue;\n\t\t}\n\n\t\tif ( get( nx, ny ) == b )\n\t\t{\n\t\t\tbf( x, y, n - 1 );\n\t\t\tcontinue;\n\t\t}\n\n\t\tbf( nx, ny, n - 1 );\n\t}\n\t// bf( x, y, n - 1 );\n\n}\n\nint main( void )\n{\n\tint n;\n\twhile ( cin >> n && n != 0 )\n\t{\n\t\tcin >> s >> t >> b;\n\n\t\tint x, y;\n\n\t\tcnt = 0;\n\t\tg = 0;\n\t\tsearch( x, y, s );\n\n\t\tV = vector < vector <bool> >( 3, vector <bool>( 3, false ) );\n\n\t\tbf( x, y, n );\n\n\t\tdouble probability;\n\t\tif ( cnt != 0 )\n\t\t\tprobability = (double)g/(double)cnt;\n\n\t\tcout.setf( ios::fixed );\n\t\tcout.precision( 8 );\n\t\tcout << probability << endl;\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint grd[3][3];\ndouble dp[3][3][20];\nint mx[]={-1,1,0,0},my[]={0,0,-1,1};\nchar abc[3][4]={\"ABC\",\"DEF\",\"GHI\"};\ndouble dfs(int x,int y,int n){\n\tif(dp[y][x][n]!=0)\treturn dp[y][x][n];\n\tif(n==0){\n\t\tif(grd[x][y]==1)\treturn dp[y][x][n]=1.0;\n\t\telse \treturn dp[y][x][n]=0.0;\n\t}\n\tdouble ret=0.0;\n\tfor(int i=0;i<4;i++){\n\t\tint cx=x+mx[i],cy=y+my[i];\n\t\tif(cx<0||2<cx||cy<0||2<cy)\tret+=dfs(x,y,n-1)*0.25;\n\t\tif(grd[cy][cx]==2)\tret+=dfs(x,y,n-1)*0.25;\n\t\telse \tret+=dfs(cx,cy,n-1)*0.25;\n\t}\n\treturn dp[y][x][n]=ret;\n}\nint main(){\n\twhile(true){\n\t\tint n;\tcin>>n;\n\t\tif(n==0)\treturn 0;\n\t\tchar s,t,b;\tscanf(\" %c %c %c\",&s,&t,&b);\n\t\tmemset(grd,0,sizeof(grd));\tmemset(dp,0,sizeof(dp));\n\t\tint sx,sy;\n\t\tfor(int i=0;i<3;i++){\n\t\t\tfor(int j=0;j<3;j++){\n\t\t\t\tif(abc[i][j]==s){\n\t\t\t\t\tsx=j;\tsy=i;\n\t\t\t\t}\n\t\t\t\telse if(abc[i][j]==t)\tgrd[i][j]=1;\n\t\t\t\telse if(abc[i][j]==b)\tgrd[i][j]=2;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.15lf\\n\",dfs(sx,sy,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<queue>\n#include<limits.h>\n#include<math.h>\nusing namespace std;\nstruct Point{int y, x;};\nint nari[3][3];\n\n\nint bfs(int,int,int,int);\nint y11(int);\nint x11(int);\n\nint main(){\n  int n,j,i;\n  char s,t,b;\n  double ans;\n  while(1){\n    cin >> n;\n    if(n == 0)break;\n    cin >> s >> t >> b;\n    bfs(s,t,b,n);\n\n    /*\n    for(int i=0;i<3;i++){\n      for(int j=0;j<3;j++){\n\tcout << nari[i][j];\n\tprintf(\"  \");\n      }\n      cout << endl;\n    }\n    */\n\n\n    /* cout <<\"count=\" <<bfs(s,t,b,n) << endl; */\n \n    printf(\"%lf\\n\",(double)bfs(s,t,b,n)/pow(4,n));\n    \n  }\n}\n\n\nint bfs(int s,int t,int b,int n){\n  Point u,v;\n  queue<Point> Q;\n  int ny,nx,count=0,nn=0;\n  int dy[4] = {0,-1,0,1};\n  int dx[4] = {1,0,-1,0};\n\n\n  for(int i = 0; i < 3; i++){\n    for(int j = 0; j < 3; j++)nari[i][j] = INT_MAX;\n  }\n  u.y=y11(s);\n  u.x=x11(s);\n  nari[y11(b)][x11(b)]=-1; //qÉ\n  nari[u.y][u.x]=1; //úÊu\n  Q.push(u);\n\n  while(!Q.empty()){\n    nn++;\n    u = Q.front();\n    Q.pop();\n    \n    for(int r=0;r<4;r++){\n      nx = u.x + dx[r];\n      ny = u.y + dy[r];\n      if( nx<0 || ny<0 || ny>=3 || nx>=3){\n\tnx=u.x;\n\tny=u.y;\n      }      \n      if(ny == y11(t) && nx == x11(t) && pow(4,n-1)>=nn)count++;\n      /*cout << \"nn=\" << nn << endl; */\n      /*cout << \"count =\" << count << endl; */\n      /*cout << \"ny=\" << ny << \", y11(t)=\"<<y11(t) <<endl; */\n      /*cout << \"nx=\" << nx << \", x11(t)=\"<<x11(t) <<endl; */\n\n      if( nari[ny][nx] != INT_MAX)continue;\n\t nari[ny][nx] = nari[u.y][u.x] + 1;\n\t v.x = nx;\n\t v.y = ny;\n\t Q.push(v);\n\t \n    }\n    \n  }    \n  \nreturn count;\n}\n    \nint y11(int s){\n  if(s == 'A')return 0;\n  if(s == 'B')return 0;\n  if(s == 'C')return 0;\n  if(s == 'D')return 1;\n  if(s == 'E')return 1;\n  if(s == 'F')return 1;\n  if(s == 'G')return 2;\n  if(s == 'H')return 2;\n  if(s == 'I')return 2;\n}\n\nint x11(int s){\n  if(s == 'A')return 0;\n  if(s == 'B')return 1;\n  if(s == 'C')return 2;\n  if(s == 'D')return 0;\n  if(s == 'E')return 1;\n  if(s == 'F')return 2;\n  if(s == 'G')return 0;\n  if(s == 'H')return 1;\n  if(s == 'I')return 2;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<cstdio>\nusing namespace std;\nint n,s,t,b;\nint kai[16][9];\nbool visited[16][9];\nint dx[]={0,1,0,-1},dy[]={-3,0,3,0};\n\nvoid dfs(int p,int e){\n  visited[e][p]=1;\n  if(e==n){\n    if(p==t)kai[e][p]=1;\n    return;\n  }\n  for(int i=0;i<4;i++){\n    int np=p+dx[i]+dy[i];\n    if(dx[i]+p%3<0||dx[i]+p%3>=3||np<0||9<=np||np==b)np=p;\n    if(!visited[e+1][np])dfs(np,e+1);\n    kai[e][p]+=kai[e+1][np];\n  }\n}\n\nint main(){\n  while(cin>>n&&n!=0){\n    char sc,tc,bc;\n    for(int i=0;i<16;i++)for(int j=0;j<9;j++)kai[i][j]=0,visited[i][j]=0;\n    //   memset(kai,0,16*9);\n    //   memset(visited,0,16*9);\n    cin>>sc>>tc>>bc;\n    s=sc-'A',t=tc-'A',b=bc-'A';\n    dfs(s,0);\n    printf(\"%.8f\\n\",1.0*kai[0][s]/(1<<(n*2)));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <algorithm>\n\n#define MAX_SEC 15\n#define MAX_STATE 1 << 9\n\n#define FILL(ptr, value) FILL_((ptr), sizeof(ptr)/sizeof(value), (value))\ntemplate <typename T>\nvoid FILL_(void * ptr, size_t size, T value){\n  std::fill((T*)ptr, (T*)ptr+size, value);\n}\n\nusing namespace std;\n\ndouble dp[MAX_SEC+1][9];\nint dir[4] = {-3,-1,1,3};\n\nint main(void){\n  int n;\n  while(cin >> n && n){\n    FILL(dp,0);\n    char tmp;\n    int s,t,b;\n\n    cin >> tmp; s = (int)(tmp - 'A');\n    cin >> tmp; t = (int)(tmp - 'A');\n    cin >> tmp; b = (int)(tmp - 'A');\n\n    dp[0][s] = 1;\n    for(int i=0;i<n;i++){\n      for(int j=0;j<9;j++){\n\tif(dp[i][j] == 0) continue;\n\tfor(int k=0;k<4;k++){\n\t  if(0 <= j+dir[k] && j+dir[k] < 9 && j+dir[k] != b){\n\t    dp[i+1][j+dir[k]] += dp[i][j] * 0.25;\n\t  }else{\n\t    dp[i+1][j] += dp[i][j] * 0.25;\n\t  }\n\t}\n      }\n    }\n    printf(\"%.8lf\\n\", dp[n][t]);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <complex>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <deque>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <vector>\n#include <set>\n#include <limits>\n#include <cstdio>\n#include <cctype>\n#include <cmath>\n#include <cstring>\n#include <cstdlib>\n#include <ctime>\nusing namespace std;\n#define REP(i, j) for(int i = 0; i < (int)(j); ++i)\n#define FOR(i, j, k) for(int i = (int)(j); i < (int)(k); ++i)\n#define P pair<int, int>\n#define SORT(v) sort((v).begin(), (v).end())\n#define REVERSE(v) reverse((v).begin(), (v).end())\nconst int MAX_N = 16;\nconst int Y = 3;\nconst int X = 3;\n\nint N;\nint my[] = {0, 0, -1, 1};\nint mx[] = {1, -1, 0, 0};\ndouble dp[Y][X][MAX_N];\n\nint main() {\n  map<char, P> m;\n  m['A'] = P(0, 0);\n  m['B'] = P(0, 1);\n  m['C'] = P(0, 2);\n  m['D'] = P(1, 0);\n  m['E'] = P(1, 1);\n  m['F'] = P(1, 2);\n  m['G'] = P(2, 0);\n  m['H'] = P(2, 1);\n  m['I'] = P(2, 2);\n  while(cin >>N && N){\n    char S, T, B; cin >>S >>T >>B;\n    REP(i, Y) REP(j, X) REP(k, MAX_N) dp[i][j][k] = 0.0;\n    dp[m[S].first][m[S].second][0] = 1.0;\n    REP(n, N){\n      REP(y, Y){\n        REP(x, Y){\n          REP(i, 4){\n            int ny = y + my[i], nx = x + mx[i];\n            if(ny >= 0 && nx >= 0 && ny < Y && nx < X && !(ny == m[B].first && nx == m[B].second)) dp[ny][nx][n + 1] += (dp[y][x][n] / 4);\n            else dp[y][x][n + 1] += (dp[y][x][n] / 4);\n          }\n        }\n      }\n    }\n    printf(\"%.8lf\\n\", dp[m[T].first][m[T].second][N]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cmath>\nusing namespace std;\n\nint patterns[2][10];\nchar s, t, b;\n\nvoid getMovablePoints(int* ret, int s) {\n\t//up\n\tret[0] = s - 3;\n\t//right\n\tret[1] = s + 1;\n\t//down\n\tret[2] = s + 3;\n\t//left\n\tret[3] = s - 1;\n\tfor (int i = 0; i < 4; i++) {\n\t\tif(ret[i] < 0 || 8 < ret[i] || ret[i] == b)\n\t\t\tret[i] = s;\n\t}\n}\n\nint main() {\n\tint n;\n\twhile(cin >> n, n) {\n\t\tcin >> s >> t >> b;\n\t\ts -= 'A';\n\t\tt -= 'A';\n\t\tb -= 'A';\n\t\tfor (int i = 0; i < 9; i++) {\n\t\t\tpatterns[0][i] = patterns[1][i] = 0;\n\t\t}\n\t\tpatterns[0][s] = 1;\n\t\tint *pattern, *nextPattern;\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tpattern = patterns[i % 2];\n\t\t\tnextPattern = patterns[(i+1) % 2];\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tnextPattern[j] = 0;\n\t\t\t}\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tint movablePoints[4];\n\t\t\t\tgetMovablePoints(movablePoints, j);\n\t\t\t\tfor (int k = 0; k < 4; k++) {\n\t\t\t\t\tnextPattern[movablePoints[k]] += pattern[j];\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tint sum = 0;\n\t\tfor (int i = 0; i < 9; i++) {\n\t\t\tsum += nextPattern[i];\n\t\t}\n\t\tcout << (double)nextPattern[t] / sum << endl;\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <sstream>\n#include <cassert>\n#include <list>\nusing namespace std;\nstatic const double EPS = 1e-10;\ntypedef long long ll;\ntypedef pair<int,int> PI;\ntypedef vector<int> vi;\n#ifndef M_PI\n#define M_PI 3.14159265358979323846\n#endif\n#define rep(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define F first\n#define S second\n\nint dx[]={0,1,0,-1},dy[]={1,0,-1,0};\n\n\nmain(){\n  int n;\n  int t=0;\n  while(cin>>n,n){\n    ++t;\n    //cout<<n<<endl;\n    //if(t>8)break;\n    long double heya[3][3];\n    rep(i,3)rep(j,3)heya[i][j]=0.0;\n\n    char s,t,b;\n    cin>>s>>t>>b;\n    s-='A';\n    t-='A';\n    b-='A';\n\n    heya[s/3][s%3]=1.0;\n\n\n    while(n--){\n      //cout<<n<<endl;\n\n      long double next[3][3];\n      rep(i,3)rep(j,3)next[i][j]=0.0;\n\n      rep(i,9){\n\tint cx=i/3,cy=i%3;\n\n\trep(j,4){\n\t  int nx=cx+dx[j],ny=cy+dy[j];\n\t  if(nx<0 || 2<nx || ny<0 || 2<nx || (nx==b/3 && ny==b%3))next[cx][cy]+=heya[cx][cy]/4.0;\n\t  else next[nx][ny]+=heya[cx][cy]/4.0;\n\t}\n      }\n      rep(i,9)heya[i/3][i%3]=next[i/3][i%3];\n    }\n    printf(\"%.10Lf\\n\",heya[t/3][t%3]);\n  }\n}\n    "
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <fstream>\n#include <algorithm>\n#include <stdio.h>\n\nusing namespace std;\n\nint n;\nchar s,t,b;\n\ntypedef pair<int,int> Pair;\n\ndouble calc(){\n\n\tchar floar[3][3];\n\tfloar[0][0] = 'A';\n\tfloar[0][1] = 'B';\n\tfloar[0][2] = 'C';\n\tfloar[1][0] = 'D';\n\tfloar[1][1] = 'E';\n\tfloar[1][2] = 'F';\n\tfloar[2][0] = 'G';\n\tfloar[2][1] = 'H';\n\tfloar[2][2] = 'I';\n\n\tpair<int,int> startPlace;\n\tpair<int,int> finPlace;\n\tpair<int,int> wareHouse;\n\n\tfor(int i = 0; i < 3; i++){\n\t\tfor(int j = 0; j < 3; j++){\n\t\t\tif(floar[i][j] == s){\n\t\t\t\tstartPlace.first = i;\n\t\t\t\tstartPlace.second = j;\n\t\t\t}\n\t\t\telse if(floar[i][j] == t){\n\t\t\t\tfinPlace.first = i;\n\t\t\t\tfinPlace.second = j;\n\t\t\t}\n\t\t\telse if(floar[i][j] == b){\n\t\t\t\twareHouse.first = i;\n\t\t\t\twareHouse.second = j;\n\t\t\t}\n\t\t}\n\t}\n\n\tvector<Pair> placeList;\n\tvector<Pair> nextPlaceList;\n\n\tplaceList.push_back(startPlace);\n\tint leaveBattery = n;\n\tpair<int,int> newPlace;\n\n\tint trueCount = 0;\n\tint falseCount = 0;\n\n\tint placeCount[3][3];\n\tint nextPlaceCount[3][3];\n\n\tfor(int i = 0; i < 3; i++){\n\t\tfill(placeCount[i],placeCount[i]+3,0);\n\t\tfill(nextPlaceCount[i],nextPlaceCount[i]+3,0);\n\t}\n\n\tplaceCount[startPlace.first][startPlace.second] = 1;\n\n\twhile(leaveBattery){\n\t\tif(leaveBattery == 1){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\t\tfalseCount += placeCount[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tfalseCount = falseCount * 4;\n\t\t}\n\n\t\t// ツ配ツ療アツづ個陳身ツづーツ暗堋督ョツつオツづつ「ツつュ\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tif(placeCount[i][j] >= 1){\n\t\t\t\t\t// ツ湘」ツづ可暗堋督ョ\n\t\t\t\t\tif(i - 1 >= 0 && !(i - 1 == wareHouse.first && j == wareHouse.second)){\n\t\t\t\t\t\tnextPlaceCount[i-1][j]+=placeCount[i][j];\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tnextPlaceCount[i][j]+=placeCount[i][j];\n\t\t\t\t\t// ツ可コ\n\t\t\t\t\tif(i + 1 < 3 && !(i + 1 == wareHouse.first && j == wareHouse.second))\n\t\t\t\t\t\tnextPlaceCount[i+1][j]+=placeCount[i][j];\n\t\t\t\t\telse\n\t\t\t\t\t\tnextPlaceCount[i][j]+=placeCount[i][j];\n\t\t\t\t\t// ツ債カ\n\t\t\t\t\tif(j - 1 >= 0 && !(i == wareHouse.first && j - 1 == wareHouse.second))\n\t\t\t\t\t\tnextPlaceCount[i][j-1]+=placeCount[i][j];\n\t\t\t\t\telse\n\t\t\t\t\t\tnextPlaceCount[i][j]+=placeCount[i][j];\n\t\t\t\t\t// ツ右\n\t\t\t\t\tif(j + 1 < 3 && !(i == wareHouse.first && j + 1 == wareHouse.second))\n\t\t\t\t\t\tnextPlaceCount[i][j+1]+=placeCount[i][j];\n\t\t\t\t\telse\n\t\t\t\t\t\tnextPlaceCount[i][j]+=placeCount[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tplaceCount[i][j] = nextPlaceCount[i][j];\n\t\t\t\tnextPlaceCount[i][j] = 0;\n\t\t\t}\n\t\t}\n\n\t\tleaveBattery--;\n\t}\n\n\ttrueCount = placeCount[finPlace.first][finPlace.second];\n\n\treturn (double)trueCount/falseCount;\n}\n\nvoid solve(){\n\t//ifstream ifs(\"prob1020.txt\");\n\twhile(1){\n\t\t//ifs >> n;\n\t\tcin >> n;\n\n\t\tif(n == 0)\n\t\t\tbreak;\n\t\tcin >> s;\n\t\tcin >> t;\n\t\tcin >> b;\n\t\t//ifs >> s;\n\t\t//ifs >> t;\n\t\t//ifs >> b;\n\t\tdouble result = calc();\n\t\tprintf(\"%.8f\\n\",result);\n\t}\n}\n\nint main(){\nsolve();\nreturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\nusing namespace std;\nint mp[3][3];\nint dx[] = {0,0,-1,1};\nint dy[] = {1,-1,0,0};\nint ans,all;\nint n;\nchar s,t,b;\nvoid saiki(int x,int y,int bat){\n  if(n == bat) {\n    all++;\n    if((t-'A')%3==x&&(t-'A')/3==y)ans++;\n    return;\n  }\n  for(int i=0;i<4;i++){\n    int nx = x+dx[i];\n    int ny = y+dy[i];\n    if(nx <0 || ny <0 || nx>=3 || ny>=3) saiki(x,y,bat+1);\n    else if((b-'A')%3==nx && (b-'A')/3==ny) saiki(x,y,bat+1);\n    else saiki(nx,ny,bat+1);\n  }\n}\n\nint main() {\n\n\n  while(1) {\n  cin >> n;\n  if(n==0) break;\n  ans = all = 0;\n  cin >> s >> t >> b;\n  saiki((s-'A')%3,(s-'A')/3,0);\n  printf(\"%.8f\\n\",1.0*ans/all);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#define rep(i, n) for(int i = 0; i < n; ++i)\n#define ck(a) (0 <= (a) && (a) < 9)\n\nint di[] = {-3, -1, 1, 3};\n\nint main() {\n    int n, s, t, b; char cs, ct, cb;\n    while(scanf(\"%d\", &n)) {\n        if(n == 0) break;\n        getchar();\n        scanf(\"%c %c %c\", &cs, &ct, &cb);\n        s = cs - 'A', t = ct - 'A', b = cb - 'A';\n        double p[9] = {0}; p[s] = 1.0;\n\n\n        while(n--) {\n            double q[9] = {0};\n            rep(i, 9) rep(d, 4) {\n                if(ck(i + di[d]) && !(i % 3 == 0 && di[d] == -1) &&\n                   !(i % 3 == 2 && di[d] == 1) &&\n                   !(i / 3 == 0 && di[d] == -3) &&\n                   !(i / 3 == 2 && di[d] == 3) && i + di[d] != b)\n                    q[i + di[d]] += p[i] / 4;\n                else q[i] += p[i] / 4;\n            }\n            rep(i, 9) p[i] = q[i];\n        }\n        printf(\"%.8lf\\n\", p[t]);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\ntypedef vector <int> VI;\ntypedef vector <VI> VVI;\n\nconst int dx[4] = { 0, 0, 1, -1 };\nconst int dy[4] = { 1, -1, 0, 0 };\n\nint get_x( char c )\n{\n\tif ( c == 'A' || c == 'D' || c == 'G' ) return 0;\n\tif ( c == 'B' || c == 'E' || c == 'H' ) return 1;\n\tif ( c == 'C' || c == 'F' || c == 'I' ) return 2;\n\treturn -1;\n}\n\nint get_y( char c )\n{\n\tif ( c == 'A' || c == 'B' || c == 'C' ) return 0;\n\tif ( c == 'D' || c == 'E' || c == 'F' ) return 1;\n\tif ( c == 'G' || c == 'H' || c == 'I' ) return 2;\n\treturn -1;\n}\n\n\nint main( void )\n{\n\tint n; char s, t, b;\n\twhile ( 1 )\n\t{\n\t\tcin >> n;\n\t\tif ( n == 0 ) break;\n\t\tcin >> s >> t >> b;\n\n\t\tint sx, sy, gx, gy, ox, oy;\n\t\tsx = get_x( s ); sy = get_y( s );\n\t\tgx = get_x( t ); gy = get_y( t );\n\t\tox = get_x( b ); oy = get_y( b );\n\n\t\tVVI prev( 3, VI(3,0) ), next;\n\t\tprev[sx][sy] = 1;\n\t\tfor ( int lpc = 0; lpc < n; lpc++ )\n\t\t{\n\t\t\tnext = VVI( 3, VI( 3, 0 ) );\n\t\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ )\n\t\t\t{\n\t\t\t\tif ( i == oy && j == ox ) continue;\n\t\t\t\tbool stop = 0;\n\t\t\t\tfor ( int k = 0; k < 4; k++ )\n\t\t\t\t{\n\t\t\t\t\tint nx = j + dx[k];\n\t\t\t\t\tint ny = i + dy[k];\n\t\t\t\t\tif ( nx < 0 || nx >= 3 || ny < 0 || ny >= 3 )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( nx == ox && ny == oy )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnext[i][j] += prev[ny][nx];\n\t\t\t\t}\n\t\t\t\tif ( stop )\n\t\t\t\t{\n\t\t\t\t\tnext[i][j] += prev[i][j];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tprev = next;\n\t\t}\n\n\t\tint sum = 0;\n\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ ) sum += next[i][j];\n\n\t\tdouble answer = (double)next[gy][gx] / (double)sum;\n\n\t\tcout.precision( 8 );\n\t\tcout.setf( ios::fixed );\n\t\tcout << answer << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string.h>\n#include <cmath>\n#include <cstdio>\n\nusing namespace std;\n\nint dx[4]={-1,0,0,1};\nint dy[4]={0,1,-1,0};\n\nint main(void)\n{\n\tint n;\n\tchar s,t,b;\n\tint dp[5][5];\n\tint i1,i2,i3,i4;\n\tdouble ans;\n\n\twhile(1){\n\t\tcin>>n;\n\t\tif(n==0) break;\n\t\tcin>>s>>t>>b;\n\n\t\tmemset(dp,-1,sizeof(dp));\n\t\tfor(i1=1;i1<=3;i1++){\n\t\t\tfor(i2=1;i2<=3;i2++){\n\t\t\t\tdp[i1][i2]=0;\n\t\t\t}\n\t\t}\n\t\tdp[((s-'A')/3)+1][((s-'A')%3)+1] = 1;\n\t\tdp[((b-'A')/3)+1][((b-'A')%3)+1] = -1;\n\n\t\tfor(i1=0;i1<n;i1++){\n\n\t\t\tfor(i2=1;i2<=3;i2++){\n\t\t\t\tfor(i3=1;i3<=3;i3++){\n\t\t\t\t\tif(dp[i2][i3]==1){\n\t\t\t\t\t\tfor(i4=0;i4<4;i4++){\n\t\t\t\t\t\t\tif(dp[i2+dy[i4]][i3+dx[i4]]==-1) dp[i2][i3]++;\n\t\t\t\t\t\t\telse dp[i2+dy[i4]][i3+dx[i4]]++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tans=double(dp[((t-'A')/3)+1][((t-'A')%3)+1])/pow(4.0,n);\n\t\tprintf(\"%.8lf\\n\",ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define INF 1145141919\n#define MOD 1000000007\n#define ALL(a) begin((a)),end((a))\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10  fixed<<setprecision(10)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> P;\ntypedef long long ll;\nstruct edge\n{\n\tint from, to, cost;\n\tbool operator < (const edge& e) const { return cost < e.cost; }\n\tbool operator >(const edge& e) const { return cost > e.cost; }\n};\ntypedef vector<edge> edges;\n///*************************************************************************************///\n///*************************************************************************************///\n///*************************************************************************************///\n\nbool fld[5][5] = {};\nint main()\n{\n\tint n;\n\twhile (cin >> n, n)\n\t{\n\t\tchar s, t, b;\n\t\tcin >> s >> t >> b;\n\t\tvector<vector<edge>> es(9, vector<edge>(9));\n\t\tMS(fld, true);\n\t\tFOR(i, 1, 4)FOR(j, 1, 4) fld[i][j] = false;\n\t\tif (b == 'A') fld[1][1] = true;\n\t\telse if (b == 'B') fld[1][2] = true;\n\t\telse if (b == 'C') fld[1][3] = true;\n\t\telse if (b == 'D') fld[2][1] = true;\n\t\telse if (b == 'E') fld[2][2] = true;\n\t\telse if (b == 'F') fld[2][3] = true;\n\t\telse if (b == 'G') fld[3][1] = true;\n\t\telse if (b == 'H') fld[3][2] = true;\n\t\telse if (b == 'I') fld[3][3] = true;\n\t\tint dx[] = { -1, 0, 0, 1 }; int dy[] = { 0, -1, 1, 0 };\n\t\tFOR(i, 1, 4)FOR(j, 1, 4)\n\t\t{\n\t\t\tREP(k, 4)\n\t\t\t{\n\t\t\t\tint p = (i - 1) * 3 + j - 1;\n\t\t\t\tint nx = i + dx[k]; int ny = j + dy[k];\n\t\t\t\tint q = (nx - 1) * 3 + ny - 1;\n\t\t\t\tif (nx > 0 && nx<4 && ny>0 && ny < 4 && fld[nx][ny]==false)\n\t\t\t\t{\n\t\t\t\t\tes[p].push_back(edge{ p, q, 1 });\n\t\t\t\t}\n\t\t\t\telse es[p].push_back(edge{ p, p, 1 });\n\t\t\t}\n\t\t}\n\t\tint st = s - 'A';\n\t\tint go = t - 'A';\n\t\tdouble ex[9][16] = {};\n\t\tex[st][0] = 1;\n\t\tFOR(k,1, n+1)\n\t\t{\n\t\t\tREP(i, 9)\n\t\t\t{\n\t\t\t\tREP(j, es[i].size())\n\t\t\t\t{\n\t\t\t\t\tex[es[i][j].to][k] += ex[es[i][j].from][k - 1] * 0.25;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << D10 << ex[go][n] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\nusing namespace std;\n\n#define rep(i,n) for(int i=0; i<n; i++)\ndouble dp[16][9];\n\nint main(){\n\tint n;\n\tchar s, t, b;\n\twhile( scanf(\"%d\",&n), n ){\n\t\tscanf(\"%c %c %c\", &s, &t, &b);\t// \\n, s, t, b\n\t\tmemset( dp, 0, sizeof(dp) );\n\t\tdp[0][s-'A'] = 1.0;\n\t\trep(i,n){\n\t\t\trep(j,9){\n\t\t\t\tif(j-3>=0 && b-'A'!=j-3)\tdp[i+1][j-3] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t\tif(j-1>=0 && b-'A'!=j-1)\tdp[i+1][j-1] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t\tif(j+1< 9 && b-'A'!=j+1)\tdp[i+1][j+1] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t\tif(j+3< 9 && b-'A'!=j+3)\tdp[i+1][j+3] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.7lf\\n\",dp[n][t-'A']);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)n; ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\nint next[9][4] = {\n  {0,1,0,3},\n  {0,2,1,4},\n  {1,2,2,5},\n  {3,4,0,6},\n  {3,5,1,7},\n  {4,5,2,8},\n  {6,7,3,6},\n  {6,8,4,7},\n  {7,8,5,8}\n};\nint n;\nint s,t,b;\nchar s_,t_,b_;\nint memo[20][10];\nint dfs(int time,int place){\n  if(memo[time][place]!=-1) return memo[time][place];\n  if(time == n) return place == t;\n  int ret = 0;\n  REP(r,4){\n    int nplace = next[place][r];\n    if(nplace==b) nplace = place;\n    ret += dfs(time+1, nplace);\n  }\n  return memo[time][place] = ret;\n}\nint main(){\n  while(cin>>n,n){\n    memset(memo,-1,sizeof(memo));\n    cin>>s_>>t_>>b_;\n    s = s_-'A';\n    t = t_-'A';\n    b = b_-'A';\n    cout<<(double)dfs(0,s)/(1<<(2*n))<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <string>\n#include <cmath>\n#include <cassert>\n#include <iostream>\n#include <algorithm>\n#include <stack>\n#include <queue>\n#include <vector>\n#include <set>\n#include <map>\n#include <bitset>\n#include <functional>\n#include <numeric>\nusing namespace std;\n\n#define repl(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define mp(a,b) make_pair((a),(b))\n#define pb(a) push_back((a))\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<((x))<<endl\n#define fi first\n#define se second\n\n#define INF 2147483600\n#define long long long\n\nint main(){\n  int n;\n  while(cin>>n, n){\n    char a,b,c; // ????§????????????????????????????\n    scanf(\" %c %c %c\", &a, &b, &c);\n    a-='A'; b-='A'; c-='A';\n    vector<vector<double> > prev(3, vector<double>(3,0)), nxt(3,vector<double>(3));\n    prev[a/3][a%3]=1;\n    rep(i,n){\n      rep(j,3) fill(all(nxt[j]), 0);\n      rep(x,3) rep(y,3) if(prev[x][y]>0){\n        const int dx[]={-1,0,0,1}, dy[]={0,-1,1,0};\n        rep(k,4){\n          int nx = x+dx[k], ny=y+dy[k];\n          if(nx<0 || ny<0 || nx>=3 || ny>=3 || nx*3+ny==c) nxt[x][y] += prev[x][y]/4.;\n          else nxt[nx][ny] += prev[x][y]/4.;\n        }\n      }\n      swap(prev, nxt);\n    }\n\n    printf(\"%.6f\\n\", prev[b/3][b%3]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\nint initial, battery, junk;\nint dr[] = { -1, 0, 1, 0 }, dc[] = { 0, -1, 0, 1 };\ndouble func(int r, int c, int n)\n{\n\tif (n == 0) return (3*r+c == battery);\n\tdouble res = 0;\n\tfor (int i=0; i<4; ++i) {\n\t\tint nr = r + dr[i], nc = c + dc[i];\n\t\tif (nr<0 || nr>=3 || nc<0 || nc>=3 || 3*nr+nc==junk)\n\t\t\tres += func(r, c, n-1) / 4;\n\t\telse\n\t\t\tres += func(nr, nc, n-1) / 4;\n\t}\n\treturn res;\n}\nint main()\n{\n\tint n;\n\twhile (scanf(\"%d \", &n), n) {\n\t\tchar s, t, b;\n\t\tscanf(\"%c %c %c \", &s, &t, &b);\n\t\tinitial = s - 'A';\n\t\tbattery = t - 'A';\n\t\tjunk = b - 'A';\n\t\tprintf(\"%.10f\\n\", func(initial/3, initial%3, n));\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include <iostream>\nusing namespace std;\n\nint main() {\n\twhile (1) {\n\t\tint n, s, t, b, sum = 0;\n\t\tint ai[16][3][3] = { 0 };\n\t\tchar a, d, c;\n\t\tscanf(\"%d\", &n);\n\t\tif (n == 0) break;\n\t\tcin >> a >> d >> c;\n\t\ts = a - 'A';  t = d - 'A'; b = c - 'A';\n\t\tai[0][s / 3][s % 3] = 1;\n\t\tfor (int i = 1; i <= n; ++i) {\n\t\t\tfor (int j = 0; j < 3; ++j) {\n\t\t\t\tfor (int l = 0; l < 3; ++l) {\n\t\t\t\t\tif (j - 1 >= 0 && (j-1) * 3 + l != b) ai[i][j - 1][l] += ai[i - 1][j][l];\n\t\t\t\t\telse ai[i][j][l] += ai[i - 1][j][l];\n\t\t\t\t\tif (j + 1 < 3 && (j - 1) * 3 + l != b) ai[i][j + 1][l] += ai[i - 1][j][l];\n\t\t\t\t\telse ai[i][j][l] += ai[i - 1][j][l];\n\n\t\t\t\t\tif (l - 1 >= 0 && j * 3 + l - 1 != b) ai[i][j][l - 1] += ai[i - 1][j][l];\n\t\t\t\t\telse ai[i][j][l] += ai[i - 1][j][l];\n\t\t\t\t\tif (l + 1 < 3 && j * 3 + l + 1 != b) ai[i][j][l + 1] += ai[i - 1][j][l];\n\t\t\t\t\telse ai[i][j][l] += ai[i - 1][j][l];\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (int i = 0; i < 3; ++i) {\n\t\t\tfor (int j = 0; j < 3; ++j) {\n\t\t\t\tsum += ai[n][i][j];\n\t\t\t}\n\t\t}\n\t\tprintf(\"%f\\n\", (double)ai[n][t / 3][t % 3] / sum);\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define for_(i,a,b) for(int i=(a);i<(b);++i)\n\nconst int dx[4] = {-1,0,1,0};\nconst int dy[4] = {0,-1,0,1};\n\nint n;\nchar s, t, b;\ndouble p[2][3][3];\n\nint getX(char c) { return (c - 'A') % 3; }\nint getY(char c) { return (c - 'A') / 3; }\n\nvoid solve() {\n\tfor_(y,0,3) for_(x,0,3) p[0][y][x] = 0.;\n\tp[0][getY(s)][getX(s)] = 1.0;\n\t\n\tfor_(i,0,n) {\n\t\tfor_(y,0,3) for_(x,0,3) {\n\t\t\tif (y == getY(b) && x == getX(b)) continue;\n\t\t\tfor_(d,0,4) {\n\t\t\t\tint nx = x + dx[d], ny = y + dy[d];\n\t\t\t\tif (nx < 0 || nx >= 3 || ny < 0 || ny >= 3) continue;\n\t\t\t\tp[1][y][x] += p[0][ny][nx] * 0.25;\n\t\t\t}\n\t\t}\n\t\tswap(p[0], p[1]);\n\t}\n\t\n\tcout << p[0][getY(t)][getX(t)] << endl;\n}\n\nint main() {\n\twhile (cin >> n, n) {\n\t\tcin >> s >> t >> b;\n\t\tsolve();\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<string>\n#include<map>\n#include<cstdio>\n   \n#define f first\n#define s second\n   \nusing namespace std;\n   \ntypedef pair<int,int> P;\n   \nint dx[4]={0,0,1,-1};\nint dy[4]={1,-1,0,0};\n   \nint main(void){\n   \nint n,id=0;\nstring s=\"ABCDEFGHI\";\nchar s,t,d;\nmap<char,P>mp;\n   \nfor(int i=0;i<3;i++){\nfor(int j=0;j<3;j++){\nmp[s[id++]]=P(j,i);\n}\n}\n   \nwhile(cin >> n,n){\ncin >> s >> t >> d;\n\nP S,T,D;\nS.f=mp[s].f,S.s=mp[s].s;\nT.f=mp[t].f,T.s=mp[t].s;\nD.f=mp[d].f,D.s=mp[d].s;\n\ndouble dp[16][3][3];\n   \nfor(int k=0;k<16;k++)\nfor(int i=0;i<3;i++)\nfor(int j=0;j<3;j++)dp[k][i][j]=0;\n   \ndp[0][S.s][S.f]=1;\n   \nfor(int k=0;k<n;k++){\nfor(int i=0;i<3;i++){\nfor(int j=0;j<3;j++){\nfor(int l=0;l<4;l++){\nint nx=j+dx[l],ny=i+dy[l];\nif(nx<0 || ny<0 || 2<nx || 2<ny || \n(nx==D.s&&ny==D.f))nx=j,ny=i;\ndp[k+1][ny][nx]+=dp[k][i][j]/4;\n}\n}\n}\n}\nprintf(\"%.8f\\n\",dp[n][T.s][T.f]);\n}\n   \nreturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstring>\n#include <cstdio>\n\nusing namespace std;\n\nint main(int argc, char *argv[]) {\n  int n;\n  char s, t, b;\n  long double *rooms, *r;\n  vector<long double> result;\n  rooms = new long double[9];\n  r = new long double[9];\n  while (true) {\n    cin >> n;\n    if (n == 0)\n      break;\n    memset(rooms, 0, 9 * sizeof(long double));\n    cin >> s >> t >> b;\n\n    rooms[s-'A'] = 1;\n    b -= 'A';\n    for (int i = 0; i < n; i++) {\n      memset(r, 0, 9 * sizeof(long double));\n      long double *tmp = rooms;\n      rooms = r;\n      r = tmp;\n      if (b != 0) {\n        rooms[0] += r[0] * 0.5 + r[1] * 0.25 + r[3] * 0.25;\n      } else {\n        rooms[1] += r[1] * 0.25;\n        rooms[3] += r[3] * 0.25;\n      }\n      if (b != 1) {\n        rooms[1] += (r[0] + r[1] + r[2] + r[4]) * 0.25;\n      } else {\n        rooms[0] += r[0] * 0.25;\n        rooms[2] += r[2] * 0.25;\n        rooms[4] += r[4] * 0.25;\n      }\n      if (b != 2) {\n        rooms[2] += r[1] * 0.25 + r[2] * 0.5 + r[5] * 0.25;\n      } else {\n        rooms[1] += r[1] * 0.25;\n        rooms[5] += r[5] * 0.25;\n      }\n      if (b != 3) {\n        rooms[3] += (r[0] + r[3] + r[4] + r[6]) * 0.25;\n      } else {\n        rooms[0] += r[0] * 0.25;\n        rooms[4] += r[4] * 0.25;\n        rooms[6] += r[6] * 0.25;\n      }\n      if (b != 4) {\n        rooms[4] += (r[1] + r[3] + r[5] + r[7]) * 0.25;\n      } else {\n        rooms[1] += r[1] * 0.25;\n        rooms[3] += r[3] * 0.25;\n        rooms[5] += r[5] * 0.25;\n        rooms[7] += r[7] * 0.25;\n      }\n      if (b != 5) {\n        rooms[5] += (r[2] + r[4] + r[5] + r[8]) * 0.25;\n      } else {\n        rooms[2] += r[2] * 0.25;\n        rooms[4] += r[4] * 0.25;\n        rooms[8] += r[8] * 0.25;\n      }\n      if (b != 6) {\n        rooms[6] += r[3] * 0.25 + r[6] * 0.5 + r[7] * 0.25;\n      } else {\n        rooms[3] += r[3] * 0.25;\n        rooms[7] += r[7] * 0.25;\n      }\n      if (b != 7) {\n        rooms[7] += (r[4] + r[6] + r[7] + r[8]) * 0.25;\n      } else {\n        rooms[4] += r[4] * 0.25;\n        rooms[6] += r[6] * 0.25;\n        rooms[8] += r[8] * 0.25;\n      }\n      if (b != 8) {\n        rooms[8] += r[5] * 0.25 + r[7] * 0.25 + r[8] * 0.5;\n      } else {\n        rooms[5] += r[5] * 0.25;\n        rooms[7] += r[7] * 0.25;\n      }\n      /*                                                                                                                                                                                                                                                                                                                                            \n      for (int i = 0; i < 9; i++)                                                                                                                                                                                                                                                                                                                   \n        printf(\"%c: %lf\\n\",(char)('A'+i), rooms[i]);                                                                                                                                                                                                                                                                                                \n      cout << endl;                                                                                                                                                                                                                                                                                                                                 \n      */\n    }\n    result.push_back(rooms[t-'A']);\n  }\n\n  for (int i = 0; i < result.size(); i++)\n    printf(\"%.8Lf\\n\", result[i]);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <queue>\nusing namespace std;\n\ndouble solve(int n, int s, int t, int b)\n{\n  vector<double> probs(9, 0.0);\n  probs[s] = 1.0;\n\n  for (int i = 0; i < n; i++) {\n    vector<double> next(9, 0.0);\n    for (int j = 0; j < 9; j++) {\n      for (int d = 0; d < 4; d++) {\n        static const int di[] = {-1, 1, 0, 0};\n        static const int dj[] = {0, 0, 1, -1};\n        const int k = (j / 3) + di[d];\n        const int l = (j % 3) + dj[d];\n        if (k < 0 || 3 <= k || l < 0 || 3 <= l || 3*k+l == b) {\n          next[j] += probs[j] * 0.25;\n        } else {\n          next[3*k+l] += probs[j] * 0.25;\n        }\n      }\n    }\n    probs = next;\n  }\n\n  return probs[t];\n}\n\nint main()\n{\n  int n;\n  while (cin >> n && n != 0) {\n    char s, t, b;\n    cin >> s >> t >> b;\n    printf(\"%.8f\\n\",  solve(n, s-'A', t-'A', b-'A'));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n)for(ll i=0;i<n;i++)\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char, ll>P;\n\nchar dir[4][4]{ \"ABC\",\"DEF\",\"GHI\" };\nll dx[]{ 1,-1,0,0 }, dy[]{ 0,0,1,-1 };\nint main() {\n\tll n;\n\twhile (cin >> n, n) {\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tll sum = 0, cnt = 0;\n\t\tqueue<P>que;\n\t\tque.push(P(s, n));\n\t\twhile (!que.empty()) {\n\t\t\tP p = que.front(); que.pop();\n\t\t\tif (!p.second) {\n\t\t\t\tsum++;\n\t\t\t\tif (p.first == t)cnt++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tll x = (p.first - 'A') / 3, y = (p.first - 'A') % 3;\n\t\t\trep(i, 4) {\n\t\t\t\tll nx = x + dx[i], ny = y + dy[i];\n\t\t\t\tif (nx < 0 || nx >= 3 || ny < 0 || ny >= 3 || dir[nx][ny] == b) {\n\t\t\t\t\tnx = x; ny = y;\n\t\t\t\t}\n\t\t\t\tque.push(P(dir[nx][ny], p.second - 1));\n\t\t\t}\n\t\t}\n\t\tif (sum == 0)puts(\"0.00000000\");\n\t\tprintf(\"%.7lf\\n\", (double)cnt / (double)sum);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<map>\n#include<string.h>\nusing namespace std;\n\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\n\nint main()\n{\n\tmap<char,pair<int,int> > M;\n\tM['A']=make_pair(0,0);\n\tM['B']=make_pair(1,0);\n\tM['C']=make_pair(2,0);\n\tM['D']=make_pair(0,1);\n\tM['E']=make_pair(1,1);\n\tM['F']=make_pair(2,1);\n\tM['G']=make_pair(0,2);\n\tM['H']=make_pair(1,2);\n\tM['I']=make_pair(2,2);\n\n\tint n;\n\twhile(cin>>n &&n!=0){\n\t\tchar s,t,b;\n\t\tcin>>s>>t>>b;\n\t\tpair<int,int> now=M[s];\n\t\tpair<int,int> goal=M[t];\n\t\tpair<int,int> nota=M[b];\n\n\t\tdouble ans[17][3][3];\n\n\t\tfor(int i=0;i<16;i++)\n\t\t\tfor(int x=0;x<3;x++)\n\t\t\t\tfor(int y=0;y<3;y++)\n\t\t\t\t\tans[i][y][x]=0.0;\n\n\t\tcout<<now.first<<\" \"<<now.second<<endl;\n\t\tans[0][now.second][now.first]=1.0;\n\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int x=0;x<3;x++){\n\t\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\t\tfor(int r=0;r<4;r++){\n\t\t\t\t\t\tint nx=x+dx[r],ny=y+dy[r];\n\t\t\t\t\t\tif(nx<0 || nx>=3 || ny<0 || ny>=3 || make_pair(nx,ny)==nota){\n\t\t\t\t\t\t\tans[i+1][y][x]+=ans[i][y][x]/4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tans[i+1][ny][nx]+=ans[i][y][x]/4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout<<ans[n][goal.second][goal.first]<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<n;i++)\nconst int dx[] ={0,1,0,-1};\nconst int dy[] ={-1,0,1,0};\n\nint main(){\n\tint n;\n\twhile(cin >> n , n){\n\t\tlong double dp[16][5][5] = {{{0.0}}};\n\t\tchar map[5][5];\n\t\trep(i,5)rep(j,5)map[i][j] = 'X';\n\t\trep(i,3)rep(j,3)map[i+1][j+1] = ' ';\n\t\tint sx, sy , gx, gy ,bx , by;\n\t\tchar s,t,b;\n\t\tcin >> s >> t >> b ;\n\t\tsy = (s-'A')/3 +1 ,sx = (s-'A')%3 +1;\n\t\tgy = (t-'A')/3 +1 ,gx = (t-'A')%3 +1;\n\t\tby = (b-'A')/3 +1 ,bx = (b-'A')%3 +1;\n\t\tmap[by][bx] = 'X';\n\t\tdp[n][sy][sx] = 1.0;\n\t\t\n\t\twhile(n){\n\t\t\tfor(int y=1;y<=3;y++){\n\t\t\t\tfor(int x=1;x<=3;x++){\n\t\t\t\t\trep(i,4){\n\t\t\t\t\t\tint tx = x+dx[i], ty = y+dy[i] ;\n\t\t\t\t\t\tif(map[ty][tx] == 'X')continue;\n\t\t\t\t\t\tdp[n-1][ty][tx] += dp[n][y][x] / 4.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tn--;\n\t\t}\n\t\tprintf(\"%.8Lf\\n\",dp[0][gy][gx]);\n\t}\n}\n\t"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\nusing namespace std;\n\n#define pii pair<int,int>\n\n\nint dx[] = {0,1,0,-1};\nint dy[] = {-1,0,1,0};\nint tx, ty, bx, by;\ndouble ans;\n\nvoid rec(int nx, int ny, int v, double p) {\n  //printf(\"(%d, %d), %d, %f\\n\", nx,ny,v,p);\n  if (v==0) {\n    if (nx==tx && ny==ty) {\n      ans += p;\n    }\n    return;\n  }\n  for(int i=0; i<4; i++) {\n    int xx = nx+dx[i], yy = ny+dy[i];\n    if(0<=xx&&xx<3&&0<=yy&&yy<3) {\n      if(!(xx==bx&&yy==by)) {\n        rec(xx, yy, v-1, p*0.25);\n      }\n    }\n  }\n}\n\nint main() {\n  int n;\n  int dx[]={0,1,0,-1};\n  int dy[]={-1,0,1,0};\n  \n  while(cin >> n, n) {\n    char cs, ct, cb;\n    cin >> cs >> ct >> cb;\n    int s=cs-'A', t=ct-'A', b=cb-'A';\n    tx = t%3;\n    ty = t/3;\n    bx = b%3;\n    by = b/3;\n\n//    printf(\"%d,%d  %d,%d\\n\", tx,ty,bx,by);\n\n    ans = 0;\n    rec(s%3, s/3, n, 1);\n\n    printf(\"%.8f\\n\",ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<map>\n#include<cstdio>\n//ABC\n//DEF\n//GHI\nusing namespace std;;\ntypedef pair<int,int> P;\nint n,out,can,dx[]={0,0,-1,1},dy[]={1,-1,0,0},dp[3][3][16];\nint gox,goy,mox,moy,stx,sty;\nint func(int y,int x,int bat){\n\tif(dp[y][x][bat]>=0)\n\treturn dp[y][x][bat];\n\tif(bat==0){\n\t\tif(y==goy&&x==gox){\n\t\t\tcan++;\n\t\t\tout++;\n\t\t\treturn dp[y][x][bat]=1;\n\t\t}\n\t\tout++;\n\t\treturn 0;\n\t}\n\tint nx,ny,sum=0;\n\tfor(int i=0;i<4;i++){\n\t\tny=dy[i]+y;\n\t\tnx=dx[i]+x;\n\t\tif(!(ny>=0&&ny<3&&nx>=0&&nx<3)||(nx==mox&&ny==moy))\n\t\t\tsum+=func(y,x,bat-1);\n\t\telse\n\t\t\tsum+=func(ny,nx,bat-1);\n\t}\n\treturn dp[y][x][bat]=sum;\n}\nint main(){\n\twhile(cin>>n,n){\n\t\tfor(int i=0;i<3;i++)\n\t\tfor(int j=0;j<3;j++)\n\t\tfor(int k=0;k<=n;k++)\n\t\tdp[i][j][k]=-1;\n\t\tchar a[3];\n\t\tcan=0;\n\t\tout=0;\n\t\tint sx[3],sy[3];\n\t\tcin>>a[0]>>a[1]>>a[2];\n\t\tfor(int i=0;i<3;i++){\n\t\t\tif(a[i]=='A'){\n\t\t\t\ta[i]=0;sx[i]=0;\n\t\t\t}else if(a[i]=='B'){\n\t\t\t\tsy[i]=0;sx[i]=1;\n\t\t\t}else if(a[i]=='C'){\n\t\t\t\tsy[i]=0;sx[i]=2;\n\t\t\t}else if(a[i]=='D'){\n\t\t\t\tsy[i]=1;sx[i]=0;\n\t\t\t}else if(a[i]=='E'){\n\t\t\t\tsy[i]=1;sx[i]=1;\n\t\t\t}else if(a[i]=='F'){\n\t\t\t\tsy[i]=1;sx[i]=2;\n\t\t\t}else if(a[i]=='G'){\n\t\t\t\tsy[i]=2;sx[i]=0;\n\t\t\t}else if(a[i]=='H'){\n\t\t\t\tsy[i]=2;sx[i]=1;\n\t\t\t}else if(a[i]=='I'){\n\t\t\tsy[i]=2;sx[i]=2;\n\t\t\t}\n\t\t}\n\t\tsty=sy[0];stx=sx[0];\n\t\tgoy=sy[1];gox=sx[1];\n\t\tmoy=sy[2];mox=sx[2];\n\t\tfunc(sty,stx,n);\n\t\tint pre=1;\n\t\tfor(int i=0;i<n;i++)\n\t\tpre*=4;\n\t\tprintf(\"%.8lf\\n\",(double)dp[sty][stx][n]/pre);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ndouble dp[16][9];\nconst int m[]={-3,-1,1,3};\nint main(){\n\twhile(true){\n\t\tint n;\tcin>>n;\n\t\tif(n==0)\treturn 0;\n\t\tchar s,t,b;\tcin>>s>>t>>b;\n\t\tint ss=s-'A',bb=b-'A',tt=t-'A';\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdp[0][tt]=1.0;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int j=0;j<9;j++){\n\t\t\t\tif(dp[i][j]==0)\tcontinue;\n\t\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\t\tif(j+m[k]<0||9<=j+m[k])\tdp[i+1][j]+=dp[i][j]/4.0;\n\t\t\t\t\telse if(bb==j+m[k])\tdp[i+1][j]+=dp[i][j]/4.0;\n\t\t\t\t\telse \tdp[i+1][j+m[k]]+=dp[i][j]/4.0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\",dp[n][ss]);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "// AOJ 1020\n#include<iostream>\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\nusing namespace std;\n\ntypedef long double number;\nint n;\nint sx, sy, tx, ty, bx, by;\nnumber room[3][3];\n\nvoid init() {\n  REP(x, 3) REP(y, 3) {\n    room[x][y] = 0;\n  }\n  room[sx][sy] = 1;\n}\n\nbool is_depot(int x, int y) {\n  return x == bx && y == by;\n}\n\nnumber in(int x, int y) {\n  if (x < 0 or 2 < x or y < 0 or 2 < y) return 0;\n  if (is_depot(x, y)) return 0;\n  return room[x][y];\n}\n\nnumber solve() {\n  init();\n  REP(i, n) {\n    number future[3][3];\n    REP(x, 3) REP(y,3) {\n      if (is_depot(x, y)) {\n        future[x][y] = 0;\n        continue;\n      }\n\n      future[x][y] = \n        in(x + 1, y) / 4 + in(x - 1, y) / 4 +\n        in(x, y + 1) / 4 + in(x, y - 1) / 4;\n    }\n    REP(x, 3) REP(y, 3) {\n      room[x][y] = future[x][y];\n    }\n  }\n  return room[tx][ty];\n}\n\nint room2x(char r) {\n  switch (r) {\n    case 'A': case 'D': case 'G':\n      return 0; break;\n    case 'B': case 'E': case 'H':\n      return 1; break;\n    case 'C': case 'F': case 'I':\n      return 2; break;\n    default:\n      break;\n  }\n}\n\nint room2y(char r) {\n  switch (r) {\n    case 'A': case 'B': case 'C':\n      return 0; break;\n    case 'D': case 'E': case 'F':\n      return 1; break;\n    case 'G': case 'H': case 'I':\n      return 2; break;\n    default:\n      break;\n  }\n}\n\nint main() {\n  while (cin >> n and n) {\n    char s, t, b;\n    cin >> s >> t >> b;\n    sx = room2x(s); sy = room2y(s);\n    tx = room2x(t); ty = room2y(t);\n    bx = room2x(b); by = room2y(b);\n\n    cout << solve() << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\ntypedef vector <int> VI;\ntypedef vector <VI> VVI;\n\nconst int dx[4] = { 0, 0, 1, -1 };\nconst int dy[4] = { 1, -1, 0, 0 };\n\nint get_x( char c )\n{\n\tif ( c == 'A' || c == 'D' || c == 'G' ) return 0;\n\tif ( c == 'B' || c == 'E' || c == 'H' ) return 1;\n\tif ( c == 'C' || c == 'F' || c == 'I' ) return 2;\n\treturn -1;\n}\n\nint get_y( char c )\n{\n\tif ( c == 'A' || c == 'B' || c == 'C' ) return 0;\n\tif ( c == 'D' || c == 'E' || c == 'F' ) return 1;\n\tif ( c == 'G' || c == 'H' || c == 'I' ) return 2;\n\treturn -1;\n}\n\n\nint main( void )\n{\n\tint n; char s, t, b;\n\twhile ( 1 )\n\t{\n\t\tcin >> n;\n\t\tif ( n == 0 ) break;\n\t\tcin >> s >> t >> b;\n\n\t\tint sx, sy, gx, gy, ox, oy;\n\t\tsx = get_x( s ); sy = get_y( s );\n\t\tgx = get_x( t ); gy = get_y( t );\n\t\tox = get_x( b ); oy = get_y( b );\n\n\t\tVVI prev( 3, VI(3,0) ), next;\n\t\tprev[sy][sx] = 1;\n\t\tfor ( int lpc = 0; lpc < n; lpc++ )\n\t\t{\n\t\t\tnext = VVI( 3, VI( 3, 0 ) );\n\t\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ )\n\t\t\t{\n\t\t\t\tif ( i == oy && j == ox ) continue;\n\t\t\t\tint stop = 0;\n\t\t\t\tfor ( int k = 0; k < 4; k++ )\n\t\t\t\t{\n\t\t\t\t\tint nx = j + dx[k];\n\t\t\t\t\tint ny = i + dy[k];\n\t\t\t\t\tif ( nx < 0 || nx >= 3 || ny < 0 || ny >= 3 )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( nx == ox && ny == oy )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnext[i][j] += prev[ny][nx];\n\t\t\t\t}\n\t\t\t\tif ( stop ) next[i][j] += prev[i][j] * stop;\n\t\t\t}\n\t\t\tprev = next;\n\t\t}\n\n\t\tint sum = 0;\n\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ ) sum += next[i][j];\n\n\t\tdouble answer = (double)next[gy][gx] / (double)sum;\n\n\t\tcout.precision( 8 );\n\t\tcout.setf( ios::fixed );\n\t\tcout << answer << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<algorithm>\n#include<array>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<functional>\n#include<limits>\n#include<list>\n#include<map>\n#include<numeric>\n#include<set>\n#include<stack>\n#include<string>\n#include<sstream>\n#include<unordered_map>\n#include<queue>\n#include<vector>\nusing namespace std;\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing pii = pair<int, int>;\n\n#define rep(i,a,b) for(int i=(a);i<(b);i++)\n#define rrep(i,a,b) for(int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n#define dump(o) {cerr<<#o<<\" \"<<o<<endl;}\n#define dumpc(o) {cerr<<#o; for(auto &e:(o))cerr<<\" \"<<e;cerr<<endl;}\n#define INF 0x3f3f3f3f\n#define INFL 0x3f3f3f3f3f3f3f3fLL\nconst int MOD = 1e9 + 7;\n\nint di[4] = { 1,0,-1,0 };\nint dj[4] = { 0,1,0,-1 };\n\nsigned main() {\n\tcout << fixed << setprecision(8);\n\tfor (int n; cin >> n&&n;) {\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tdouble f[3][3] = {};\n\t\tdouble g[3][3] = {};\n\t\tpii S, T, B;\n\t\tS = pii((s - 'A') / 3, (s - 'A') % 3);\n\t\tT = pii((t - 'A') / 3, (t - 'A') % 3);\n\t\tB = pii((b - 'A') / 3, (b - 'A') % 3);\n\t\tf[S.first][S.second] = 1;\n\t\t//while (n--) {\n\t\t//\trep(i, 0, 3)rep(j, 0, 3)g[i][j] = 0;\n\t\t//\tswap(f, g);\n\t\t//\trep(a, 0, 3) rep(b, 0, 3) {\n\t\t//\t\tint cnt = 0;\n\t\t//\t\trep(i, 0, 4) {\n\t\t//\t\t\tif (a + di[i] == B.first&&b + dj[i] == B.second) continue;\n\t\t//\t\t\tif (0 > a + di[i] && a + di[i] > 2)continue;\n\t\t//\t\t\tif (0 > b + dj[i] && b + dj[i] > 2)continue;\n\t\t//\t\t\tf[a + di[i]][b + dj[i]] += g[a][b] / 4;\n\t\t//\t\t\tcnt++;\n\t\t//\t\t}\n\t\t//\t\tf[a][b] += (g[a][b] / 4)*(4 - cnt);\n\t\t//\t}\n\t\t//}\n\t\tcout << f[T.first][T.second] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint ans;\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tchar n, s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A']=i%3+1;\n\t\tfy[i+'A']=i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d\", &n) , n ){\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\tchar m[5][5] = {0};\n\t\tfor(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;\n\n\t\tans = 0;\n\t\tif( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else{\n\t\t\t//solve( n , m );\n\t\t\t;\n\t\t}\n\t\t//debug( m );\n\t\t//printf(\"%.8f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "int dy[4]={0,0,1,-1};\nint bx,by;\nint tx,ty;\n\nlong double rec(int rest,int x,int y){\n     //cout<<\"x:\"<<x<<\"y:\"<<y<<endl;\n     if(x<0||x>2||y<0||y>2)return 0;\n     if(dp[rest][x][y]>0)return dp[rest][x][y];\n\n     if(rest==0){\n\t  if(x==tx&&y==ty)return 1;\n\t  else return 0;\n     }\n     long double sum=0;\n     for(int i=0;i<4;i++){\n\t  if(((x+dx[i]==bx)&&(y+dy[i]==by))||x+dx[i]<0||x+dx[i]>2||y+dy[i]>2||y+dy[i]<0){\n\t       sum+=rec(rest-1,x,y);\n\t       }else{\n\t       sum+=rec(rest-1,x+dx[i],y+dy[i]);\n\t  }\n     }\n     sum=sum/4.0;\n     dp[rest][x][y]=sum;\n     return sum;\n}\nvoid topoint(char a,int &x,int &y){\n     int tmp=a-'A';\n     x=tmp/3;\n     y=tmp%3;\n     return;\n}\nint main(){\n     int N;\n     cout.precision(8);\n     cout.setf(ios::fixed);\n     while(cin>>N,N){\n\t  char s,t,b;\n\t  cin>>s>>t>>b;\n\t  int sx,sy;\n\t  topoint(s,sx,sy);\n\t  topoint(t,tx,ty);\n\t  topoint(b,bx,by);\n\t  //cout<<sx<<\":\"<<sy<<\" \"<<tx<<\":\"<<ty<<endl;\n\t  cout<<rec(N,sx,sy)<<endl;\n\t  for(int i=0;i<15;i++){\n\t       for(int j=0;j<3;j++){\n\t\t    for(int k=0;k<3;k++){\n\t\t\t dp[i][j][k]=0;\n\t\t    }\n\t       }\n\t  }\n\t\t   \n     }\n     return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<cstdio>\nusing namespace std;\nint n,s,t,b;\nint kai[16][9];\nbool visited[16][9];\nint dx[]={0,1,0,-1},dy[]={-3,0,3,0};\n\nvoid dfs(int p,int e){\n  visited[e][p]=1;\n  if(e==n){\n    if(p==t)kai[e][p]=1;\n    return;\n  }\n  for(int i=0;i<4;i++){\n    int np=p+dx[i]+dy[i];\n    if(dx[i]+p%3<0||dx[i]+p%3==3||np<0||9<=np||np==b)np=p;\n    if(!visited[e+1][np])dfs(np,e+1);\n    kai[e][p]+=kai[e+1][np];\n  }\n}\n\nint main(){\n  while(cin>>n&&n!=0){\n    char sc,tc,bc;\n    memset(kai,0,16*9);\n    memset(visited,0,16*9);\n    cin>>sc>>tc>>bc;\n    s=sc-'A',t=tc-'A',b=bc-'A';\n    dfs(s,0);\n    printf(\"%.8f\\n\",1.0*kai[0][s]/(1<<(n*2)));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <complex>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <deque>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <vector>\n#include <set>\n#include <limits>\n#include <cstdio>\n#include <cctype>\n#include <cmath>\n#include <cstring>\n#include <cstdlib>\n#include <ctime>\nusing namespace std;\n#define REP(i, j) for(int i = 0; i < (int)(j); ++i)\n#define FOR(i, j, k) for(int i = (int)(j); i < (int)(k); ++i)\n#define P pair<int, int>\n#define SORT(v) sort((v).begin(), (v).end())\n#define REVERSE(v) reverse((v).begin(), (v).end())\nconst int MAX_N = 16;\nconst int Y = 3;\nconst int X = 3;\n\nint N;\nint my[] = {0, 0, -1, 1};\nint mx[] = {1, -1, 0, 0};\ndouble dp[Y][X][MAX_N];\n\nint main() {\n  map<char, P> m;\n  m['A'] = P(0, 0);\n  m['B'] = P(0, 1);\n  m['C'] = P(0, 2);\n  m['D'] = P(1, 0);\n  m['E'] = P(1, 1);\n  m['F'] = P(1, 2);\n  m['G'] = P(2, 0);\n  m['H'] = P(2, 1);\n  m['I'] = P(2, 2);\n  while(cin >>N && N){\n    char S, T, B; cin >>S >>T >>B;\n    REP(i, Y) REP(j, X) REP(k, MAX_N) dp[i][j][k] = 0.0;\n    dp[m[S].first][m[S].second][0] = 1.0;\n    REP(n, N)\n      REP(y, Y)\n        REP(x, X)\n          REP(i, 4){\n            int ny = y + my[i], nx = x + mx[i];\n            if(ny >= 0 && nx >= 0 && ny < Y && nx < X && !(ny == m[B].first && nx == m[B].second)) dp[ny][nx][n + 1] += (dp[y][x][n] / 4);\n            else dp[y][x][n + 1] += (dp[y][x][n] / 4);\n          }\n    printf(\"%.8lf\\n\", dp[m[T].first][m[T].second][N]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\nint main()\n{\n#if 0\n\t0 1 2\n\t3 4 5\n\t6 7 8\n#endif\n\tint c,n,s,t,b,i,j,k,x[9][4]={\n\t\t{1,3,0,0},\n\t\t{0,2,4,1},\n\t\t{1,5,2,2},\n\t\t{0,4,6,3},\n\t\t{1,3,5,7},\n\t\t{2,4,8,5},\n\t\t{3,7,6,6},\n\t\t{4,6,8,7},\n\t\t{5,7,8,8}\n\t};\n\twhile(scanf(\"%d\",&n),n)\n\t{\n\t\tint a[16][9]={0};\n\t\t/*\n\t\tchar u,v,w;\n\t\tscanf(\" %c %c %c\",&u,&v,&w);\t\t\t//¶ñÉÜÜêéóª|Cg\n\t\ts=u-'A',t=v-'A',b=w-'A';\n\t\t*/\n\t\tchar str[9];\n\t\tgetchar();fgets(str,9,stdin);\n\t\ts=str[0]-'A',t=str[2]-'A',b=str[4]-'A';\n\n\t\tc=a[0][s]=1;\n\t\tfor(i=0;i<n;++i,c*=4)for(j=0;j<9;++j)for(k=0;k<4;++k)\n\t\t\tif(x[j][k]!=b)a[i+1][x[j][k]]+=a[i][j];\n\t\t\telse a[i+1][j]+=a[i][j];\n\t\tprintf(\"%.8f\\n\",a[n][t]/(double)c);\n\t}\n\treturn 0;\n}\n//¤[ñHPÉóÔð«µÄ¾Á½¾¯¶á AlonglongÅ·çI[o[t[·é¼[\n//Ü »èá ÅIIÉ4^100ð\\»·éKvª éñ¾µA»ñÈÌÅ«Á±È¢Å·æËI\n//ÂÜèÈñ¾HÅ©çdoubleÅ\\»µëÆH\n//»êÆàñGCDÆÁÄSÅêÆH\n\n//Ç¤âç4^100ÍdoubleÅ\\»Å«éæ¤Å·@æ©Á½æ©Á½\n\n//Åà³ðµÄ­êÈ¢¼Ië·Q[©HÇ¤Èñ¾H\n//½ßµÉn=100ÌP[X©ÄÝ½çAÅIIÉevfÌlªe59­ç¢Ì·²¢lÉ@ë·Q[©IH\n//¿ÈÝÉ4^100Íe60­ç¢\n//±ê­ç¢ÈçAdoubleÌ¸xðàÁÄ·êÎ¢¯»¤Èñ¾¯ÇÈ EEE\n//¬³¢lªÏÝdÈÁÄAë·ªoÄ¢éÌ©EEEH\n\n\n//¿åÁÆÒÄAæ­©½çAf[^ZbgÌªÅå100È¾¯Å ÁÄAn<=15¶áÈ¢©\n//Æ¢¤±ÆÍAÇÁ©zñÌvfÅàÔáÁÄ½EEEH\n//Æè ¦¸4^15=10_7374_1824ÅAintÉàüÁÄ­êé\n//zñÌvfÔáÁÄ½@|ê½¢\n//Ü¾³ðµÄ­êÈ¢\n\n//Ü½zñÌvfÔáÁÄ½@ÁòÑ½¢\n//ÅàÜ¾Ü¾³ðµÄ­êÈ¢\n\n//¨¢AñsÚÌüÍÅ\n//fgetsÅæÁÄAs=string[0]-'A'At=string[2]-'A'Ab=string[4]-'A'¾Æs³ð¾Á½ÌÉA\n//scanf(\" %c %c %c\")ÅæÁ½ç³ðµ½¼@Ç¤¢¤±Æ¾"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define EPS (10e-9)\n\nusing namespace std;\n\ndouble dp[16][9];\nconst string room[3] = { \"ABC\", \"DEF\", \"GHI\" };\nconst int dir[][2] = { {-1, 0 }, { 0, 1 }, { 1, 0 }, { 0, -1 } };\n\nint main()\n{\n\tint n;\n\twhile (cin >> n && n ){\n\t\tchar s, t, b;\n\t\tcin >> s >> t >> b;\n\t\tint cr = -1, cc = -1;\n\n\t\trep (i, 16 ) rep (j, 9 ) dp[i][j] = 0.0;\n\t\trep (i, 3 ) rep (j, 3 ){\n\t\t\tif (s == room[i][j] ){\n\t\t\t\tcr = i, cc = j;\n\t\t\t\tbreak;\n\t\t\t} // end if\n\t\t} // end rep\n\n\t\tdp[0][s-'A'] = 1.0;\n\t\trep (i, n ){\n\t\t\tfor (int j = 0; j < 9; j++ ){\n\t\t\t\tif (dp[i][j] > EPS ){\n\t\t\t\t\tcr = j/3, cc = j%3;\n\t\t\t\t\tchar C = room[cr][cc];\n\t\t\t\t\trep (k, 4 ){\n\t\t\t\t\t\tint nr = cr + dir[k][0];\n\t\t\t\t\t\tint nc = cc + dir[k][1];\n\t\t\t\t\t\tif (nr < 0 || nc < 0 || nr >= 3 || nc >= 3 || room[nr][nc] == b ){\n\t\t\t\t\t\t\tdp[i+1][C-'A'] += 1./4.*dp[i][C-'A'];\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tdp[i+1][room[nr][nc]-'A'] += 1./4.*dp[i][C-'A'];\n\t\t\t\t\t\t} // end if\n\t\t\t\t\t} // end rep\n\t\t\t\t} // end if\n\t\t\t} // end for\n\t\t} // end rep\n\t\tprintf (\"%.9lf\\n\", dp[n][t-'A'] );\n\t} // end loop\n\t\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cmath>\n#include <stdio.h>\nusing namespace std;\n\nint patterns[2][10];\nint s, t, b;\n\nvoid getMovablePoints(int* ret, int s) {\n\t//up\n\tret[0] = s - 3;\n\t//right\n\tret[1] = s + 1;\n\t//down\n\tret[2] = s + 3;\n\t//left\n\tret[3] = s - 1;\n\tfor (int i = 0; i < 4; i++) {\n\t\tif(ret[i] < 0 || 8 < ret[i] || ret[i] == b)\n\t\t\tret[i] = s;\n\t}\n}\n\nint main() {\n\tint n;\n\twhile(cin >> n, n) {\n\t\tchar _s, _t, _b;\n\t\tcin >> _s >> _t >> _b;\n\t\ts = _s - 'A';\n\t\tt = _t - 'A';\n\t\tb = _b - 'A';\n\t\tfor (int i = 0; i < 9; i++) {\n\t\t\tpatterns[0][i] = patterns[1][i] = 0;\n\t\t}\n\t\tpatterns[0][s] = 1;\n\t\tint *pattern, *nextPattern;\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tpattern = patterns[i % 2];\n\t\t\tnextPattern = patterns[(i+1) % 2];\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tnextPattern[j] = 0;\n\t\t\t}\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tint movablePoints[4];\n\t\t\t\tgetMovablePoints(movablePoints, j);\n\t\t\t\tfor (int k = 0; k < 4; k++) {\n\t\t\t\t\tnextPattern[movablePoints[k]] += pattern[j];\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tint sum = 0;\n\t\tfor (int i = 0; i < 9; i++) {\n\t\t\tsum += nextPattern[i];\n\t\t}\n\n\t\tprintf(\"%.8f\\n\",(double)nextPattern[t] / sum);\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\ndouble dp[15][3][3]={};\nint dx[4]={1,-1,0,0};\nint dy[4]={0,0,1,-1};\nint bx,by;\nint tx,ty;\n\ndouble rec(int rest,int x,int y){\n     //cout<<\"x:\"<<x<<\"y:\"<<y<<endl;\n     if(x<0||x>2||y<0||y>2)return 0;\n     //if(dp[rest][x][y]>0)return dp[rest][x][y];\n\n     if(rest==0){\n\t  if(x==tx&&y==ty)return 1;\n\t  else return 0;\n     }\n     double sum=0;\n     for(int i=0;i<4;i++){\n\t  if(((x+dx[i]==bx)&&(y+dy[i]==by))||x+dx[i]<0||x+dx[i]>2||y+dy[i]>2||y+dy[i]<0){\n\t       sum+=rec(rest-1,x,y);\n\t       }else{\n\t       sum+=rec(rest-1,x+dx[i],y+dy[i]);\n\t  }\n     }\n     sum=sum/4.0;\n     dp[rest][x][y]=sum;\n     return sum;\n}\nvoid topoint(char a,int &x,int &y){\n     int tmp=a-'A';\n     x=tmp/3;\n     y=tmp%3;\n     return;\n}\nint main(){\n     int N;\n     cout.precision(8);\n     cout.setf(ios::fixed);\n     while(cin>>N,N){\n\t  char s,t,b;\n\t  cin>>s>>t>>b;\n\t  int sx,sy;\n\t  topoint(s,sx,sy);\n\t  topoint(t,tx,ty);\n\t  topoint(b,bx,by);\n\t  //cout<<sx<<\":\"<<sy<<\" \"<<tx<<\":\"<<ty<<endl;\n\t  cout<<rec(N,sx,sy)<<endl;\n\t  for(int i=0;i<15;i++){\n\t       for(int j=0;j<3;j++){\n\t\t    for(int k=0;k<3;k++){\n\t\t\t dp[i][j][k]=0;\n\t\t    }\n\t       }\n\t  }\n\t\t   \n     }\n     return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint dp[16][9];\nconst int m[]={-3,-1,1,3};\nint main(){\n\twhile(true){\n\t\tint n;\tcin>>n;\n\t\tif(n==0)\treturn 0;\n\t\tchar s,t,b;\tcin>>s>>t>>b;\n\t\tint ss=s-'A',bb=b-'A',tt=t-'A';\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdp[0][tt]=1;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int j=0;j<9;j++){\n\t\t\t\tif(dp[i][j]==0)\tcontinue;\n\t\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\t\tif(j+m[k]<0||9<=j+m[k])\tdp[i+1][j]+=dp[i][j];\n\t\t\t\t\telse if(bb==j+m[k])\tdp[i+1][j]+=dp[i][j];\n\t\t\t\t\telse \tdp[i+1][j+m[k]]+=dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.15lf\\n\",(double)dp[n][ss]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<math.h>\nint main()\n{\n\tint n,s,t,b,i,j,k,x[9][4]={{1,3,0,0},{0,2,4,1},{1,5,2,2},{0,4,6,3},{1,3,5,7},{2,4,8,6},{3,7,6,6},{4,6,8,7},{5,7,8,8}};\n\tchar _[9];\n\twhile(scanf(\"%d\",&n),n)\n\t{\n\t\tint a[16][9]={0};\n\t\tgetchar(),fgets(_,9,stdin);\n\t\ts=_[0]-'A',t=_[2]-'A',b=_[4]-'A';\n\t\ta[0][s]=1;\n\t\tfor(i=0;i<n;++i)for(j=0;j<9;++j)for(k=0;k<4;++k)\n\t\t\tif(x[j][k]!=b)a[i+1][x[j][k]]+=a[i][j];\n\t\t\telse a[i+1][j]+=a[i][j];\n\t\tprintf(\"%.8f\\n\",a[n][t]/pow(4.0,n));\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int dx[] = {-1, 0, 0, 1};\nconst int dy[] = { 0,-1, 1, 0};\n\nint sx, sy, gx, gy, n, bx, by;\ndouble P[3][3][20];\n\nbool check(int x, int y){\n  return 0 <= x && x < 3 && 0 <= y && y < 3;\n}\n\nvoid solve(){\n  P[sy][sx][n] = 1;\n\n  queue<int> qx, qy, rem;\n  qx.push(sx), qy.push(sy), rem.push(n);\n\n  while(!qx.empty()){\n    int x = qx.front(); qx.pop();\n    int y = qy.front(); qy.pop();\n    int r = rem.front(); rem.pop();\n\n    if(x == gx && y == gy) break;\n    if(r == 0) continue;\n\n    for(int i = 0 ; i < 4 ; i++){\n      int nx = x + dx[i];\n      int ny = y + dy[i];\n\n      if(!check(nx, ny) || (nx == bx && ny == by)){\n        qx.push(nx), qy.push(ny), rem.push(r-1);\n      }else{\n        P[ny][nx][r-1] += P[y][x][r] / 4;\n        qx.push(nx), qy.push(ny), rem.push(r-1);\n      }\n    }\n  }\n\n  printf(\"%.8f\\n\",P[gy][gx][0]);\n}\n\nint main(){\n  char s, t, b;\n  \n  while(cin >> n, n){\n    memset(P, 0, sizeof(P));\n\n    cin >> s >> t >> b;\n    int ss = s - 'A', tt = t - 'A', bb = b - 'A';\n    sx = ss%3; sy = ss/3;\n    gx = tt%3; gy = tt/3;\n    bx = bb%3; by = bb/3;\n    solve();\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\nusing namespace std;\nchar s,t,b;\nchar fld[5][5]={\"ABC\",\"DEF\",\"GHI\"};\nint ans,sum,dx[]={1,0,-1,0},dy[]={0,1,0,-1};\nvoid rep(int now,int y,int x){\n\tint X,Y;\n\tif(now==0){\n\t\tsum++;\n\t\tif(fld[y][x]==t){\n\t\t\tans++;\n\t\t}\n\t\treturn ;\n\t}\n\tfor(int i=0;i<4;i++){\n\t\tX=x+dx[i];\n\t\tY=y+dy[i];\n\t\tif(X>=0&&X<3&&Y>=0&&Y<3&&fld[Y][X]!=b){\n\t\t\trep(now-1,Y,X);\n\t\t}\n\t\telse{\n\t\t\trep(now-1,y,x);\n\t\t}\n\t}\n}\nint main(){\n\tint n;\n\twhile(cin>>n,n){\n\t\tcin>>s>>t>>b;\n\t\tsum=0;\n\t\tans=0;\n\t\tfor(int i=0;i<3;i++)\n\t\tfor(int j=0;j<3;j++){\n\t\t\tif(fld[i][j]==s)\n\t\t\trep(n,i,j);\n\t\t}\n\t\tcout<<ans<<' '<<sum<<endl;\n\t\tprintf(\"%.8lf\\n\",(double)ans/sum);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n\ndouble memo[15][9];\n\ndouble p(int n, char s, char t, char b){\n    if(!n)\n        return s == t ? 1 : 0;\n    else if(memo[n-1][s-'A'] < 0)\n        return memo[n-1][s-'A'];\n    else{\n        double result = 0.0;\n        if(s >= 'D' && s - b != 3)\n            result += p(n-1, s-3, t, b) / 4;\n        else\n            result += p(n-1, s, t, b) / 4;\n        if(s <= 'F' && b - s != 3)\n            result += p(n-1, s+3, t, b) / 4;\n        else\n            result += p(n-1, s, t, b) / 4;\n        if((s - 'A') % 3 && s - b != 1)\n            result += p(n-1, s-1, t, b) / 4;\n        else\n            result += p(n-1, s, t, b) / 4;\n        if((s - 'A') % 3 != 2 && b -s != 1)\n            result += p(n-1, s+1, t, b) / 4;\n        else\n            result += p(n-1, s, t, b) / 4;\n        memo[n-1][s-'A'] = result;\n        return result;\n    }\n}\n\nint main(){\n    int n;\n    char s, t, b;\n    while(std::cin >> n, n){\n        std::cin >> s >> t >> b;\n        memset(memo, -1.0, 15*9);\n        double result = p(n, s, t, b);\n        std::cout << result << std::endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "\n#Include <iostream>\n#include <queue>\n\nusing namespace std;\nstatic const int MV = 100;\ntypedef pair<int, int> T;\n\nint main() {\n  while(1) {\n    int w, h, Gcount=0, sum=0;\n    cin >> w >> h;\n    if (w ==0 && h == 0) break;\n    char M[h][w];\n    int A[h][w];\n    queue<T> Q;\n    \n    for (int i=0;i<h;i++) {\n      for (int j=0;j<w;j++) {\n\tcin >> M[i][j];\n\tA[i][j]=MV;\n\tif (M[i][j] == '*')\n\t  Gcount++;\n\tif (M[i][j] == 'o'){\n\t  Q.push(make_pair(i, j));\n\t  A[i][j]=0;\n\t}\n      }\n    }\n    /*\n      for (int i=0;i<h;i++) {\n      for (int j=0;j<w;j++) {\n      cout << A[i][j];\n      }cout << endl;\n      }\n    */\n    while(Gcount != 0 || Q.empty()) {\n      if(Q.empty()) break;//cout << -1<< endl;\n      int Dy[4]={1, 0, -1, 0}, Dx[4]={0, 1, 0, -1}, ny, nx;\n      M[Q.front().first][Q.front().second]='+';\n      for (int i=0;i<4;i++) {\n\tny = Q.front().first + Dy[i]; nx = Q.front().second + Dx[i];\n\t//      cout << endl << ny << \"    \" << nx << endl;\n\tif (M[ny][nx] == '.' && 0<=nx && nx<w && 0<=ny && ny<h) {\n\t  Q.push(make_pair(ny, nx));\n\t  //\tcout << endl << \"         \" << ny << \"   \" << nx << endl;\n\t  M[ny][nx]='+';\n\t  A[ny][nx]=A[Q.front().first][Q.front().second] + 1;\n\t}\n\tif (M[ny][nx] == '*' && 0<=nx && nx<w && 0<=ny && ny<h) {\n\t  Gcount--;\n\t  M[ny][nx]='+';\n\t  sum+=A[Q.front().first][Q.front().second] + 1;\n\t  //\tcout << endl << sum << endl;\n\t  for (int j=0;j<h;j++) {\n\t    for (int k=0;k<w;k++) {\n\t      A[j][k]=MV;\n\t      if (M[j][k] == '+') {\n\t\tM[j][k] = '.';\n\t      }\n\t    }\n\t  }\n\t  int q=Q.size();\n\t  for (int j=1;j<q;j++) {\n\t    //while(!Q.empty()) {\n\t    Q.pop();\n\t  }\n\t  Q.push(make_pair(ny, nx));\n\t  A[ny][nx] = 0;\n\t  i=4;\n\t}\n      }\n      /*    \n\t    for (int i=0;i<h;i++) {\n\t    for (int j=0;j<w;j++) {\n\t    cout << A[i][j] << \"      \";\n\t    }cout << endl;\n\t    }\n\t    cout << endl;\n      */\n      \n      Q.pop();\n    }\n    if(sum == 0) cout << -1 << endl;\n    else cout << sum << endl;\n  }\n}\n\n  /*\n  while(!Q.empty() || a) {\n    for(int i=0; i<4; i++) {\n      int nx = Q.front().first + dx[i], ny = Q.front().second + dy[i];\n      if(A[nx][ny]!='x' && 0<=nx && nx<w && 0<=ny && ny<h) {\n\tQ.push(make_pair(nx, ny));\n\tA[nx][ny]='+';\n\tA[nx][ny]=AA[Q.front().first][Q.front().second]+1;\n\tfor (int aa=0;aa<h;aa++){\n\t  for (int bb=0;bb<w;bb++){\n\t    cout << AA[aa][bb];\n\t  }cout << endl;\n\t}\n\t}\n\n      if(A[nx][ny]=='*') {\n      \ta=false;\n      }\n    }\n    Q.pop();\n  }\n  */"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef pair<int, int> pii;\n\npii get_pos(int x)\n{\n    return pii(x / 3, x % 3);\n}\n\nbool inField(int x, int y)\n{\n    return (0 <= x && x < 3 && 0 <= y && y < 3);\n}\n\nint main()\n{\n    int N;\n    while (cin >> N, N) {\n        string S = \"ABCDEFGHI\";\n        char a[3];\n        for (int i = 0; i < 3; i++) {\n            cin >> a[i];\n        }\n        int s = S.find(a[0]);\n        int t = S.find(a[1]);\n        int b = S.find(a[2]);\n\n        double dp[25][9] = {{}};\n        pii p = get_pos(b);\n\n        dp[0][s] = 1;\n        \n        const int di[] = {-1, +0, +1, +0};\n        const int dj[] = {+0, -1, +0, +1};\n        \n        for (int i = 0; i < N; i++) {\n            for (int j = 0; j < 9; j++) {\n                if (dp[i][j] == 0) continue;\n                pii n = get_pos(j);\n                for (int k = 0; k < 4; k++) {\n                    int ni = n.first + di[k];\n                    int nj = n.second + dj[k];\n                    if (!inField(nj, ni) || (pii(ni, nj) == p)) {\n                        dp[i+1][j] += dp[i][j];\n                    } else {\n                        dp[i+1][ni*3+nj] += dp[i][j] / 4;\n                    }\n                }\n\n            }\n        }\n        printf(\"%.10f\\n\", dp[N][t]);            \n    }    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\nusing namespace std;\nint mp[3][3];\nint dx[] = {0,0,-1,1};\nint dy[] = {1,-1,0,0};\nint ans,all;\nint n;\nchar s,t,b;\nint memo[16][3][3];\nint visited[16][3][3];\nvoid saiki(int x,int y,int bat){\n  visited[bat][x][y] = 1;\n  if(n == bat) {\n    if((t-'A')%3==x&&(t-'A')/3==y)memo[bat][x][y]=1;\n    return;\n  }\n  for(int i=0;i<4;i++){\n    int nx = x+dx[i];\n    int ny = y+dy[i];\n    if(((b-'A')%3==nx && (b-'A')/3==ny)||nx<0||ny <0||nx>=3||ny>=3) {\n      if(visited[bat+1][x][y] == 1) memo[bat][x][y] += memo[bat+1][x][y];\n      else {\n\tsaiki(x,y,bat+1);\n\tif(memo[bat+1][x][y]>0)memo[bat][x][y] += memo[bat+1][x][y];\n      }\n    }\n    else {\n      if(visited[bat+1][nx][ny]) memo[bat][x][y] += memo[bat+1][nx][ny];\n      else  {\n\tsaiki(nx,ny,bat+1);\n\tif(memo[bat+1][nx][ny]>0)memo[bat][x][y] += memo[bat+1][nx][ny];\n      }\n    }\n  }\n}\n\nint main() {\n\n\n  while(1) {\n  cin >> n;\n  if(n==0) break;\n  ans = all = 0;\n  cin >> s >> t >> b;\n  for(int i=0;i<=n;i++)\n    for(int j=0;j<3;j++)\n      for(int k=0;k<3;k++) memo[i][j][k] = visited[i][j][k]=0;\n  saiki((s-'A')%3,(s-'A')/3,0);\n  ans = memo[0][(s-'A')%3][(s-'A')/3];\n    printf(\"%.8f\\n\",1.0*ans/(1<<(2*n)));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tchar n, s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\t//fx[i+'A']=i%3+1;\n\t\t//fy[i+'A']=i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d\", &n) , n ){\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\tchar m[5][5] = {0};\n\t\t/*for(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;*/\n\n\t\tif( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else{\n\t\t\t//solve( n , m );\n\t\t\t;\n\t\t}\n\t\t//debug( m );\n\t\t//printf(\"%.8f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nlong double dp[16][9];\nconst int m[]={-3,-1,1,3};\nint main(){\n\twhile(true){\n\t\tint n;\tcin>>n;\n\t\tif(n==0)\treturn 0;\n\t\tchar s,t,b;\tcin>>s>>t>>b;\n\t\tint ss=s-'A',bb=b-'A',tt=t-'A';\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdp[0][tt]=1.0;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int j=0;j<9;j++){\n\t\t\t\tif(dp[i][j]==0)\tcontinue;\n\t\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\t\tif(j+m[k]<0||9<=j+m[k])\tdp[i+1][j]+=dp[i][j]/4.0;\n\t\t\t\t\telse if(bb==j+m[k])\tdp[i+1][j]+=dp[i][j]/4.0;\n\t\t\t\t\telse \tdp[i+1][j+m[k]]+=dp[i][j]/4.0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\",dp[n][ss]);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<string>\n#include<map>\n#include<cstdio>\n     \n#define f first\n#define s second\n     \nusing namespace std;\n     \ntypedef pair<int,int> P;\n     \nint dx[4]={0,0,1,-1};\nint dy[4]={1,-1,0,0};\n     \nint main(void){\n     \nint n,id=0;\nstring idx=\"ABCDEFGHI\";\nchar s,t,d;\nmap<char,P>mp;\n     \nfor(int i=0;i<3;i++){\nfor(int j=0;j<3;j++){\nmp[idx[id++]]=P(j,i);\n}\n}\n     \nwhile(cin >> n,n){\ncin >> s >> t >> d;\n  \nP S,T,D;\nS.f=mp[s].f,S.s=mp[s].s;\nT.f=mp[t].f,T.s=mp[t].s;\nD.f=mp[d].f,D.s=mp[d].s;\n  \ndouble dp[16][3][3];\n     \nfor(int k=0;k<16;k++)\nfor(int i=0;i<3;i++)\nfor(int j=0;j<3;j++)dp[k][i][j]=0;\n     \ndp[0][S.s][S.f]=1;\n     \nfor(int k=0;k<n;k++){\nfor(int i=0;i<3;i++){\nfor(int j=0;j<3;j++){\nfor(int l=0;l<4;l++){\nint nx=j+dx[l],ny=i+dy[l];\nif(nx<0 || ny<0 || 2<nx || 2<ny || \n(nx==D.s&&ny==D.f))nx=j,ny=i;\ndp[k+1][ny][nx]+=dp[k][i][j]/4;\n}\n}\n}\n}\nprintf(\"%.8f\",dp[n][T.s][T.f]);\ncout << endl;\n}\n     \nreturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n\nusing namespace std;\n\nint b_row,b_col,memo[16][3][3];\n\nchar b[2];\n\nbool rangeCheck(int row,int col){\n\tif(row >= 0 && row <= 2 && col >= 0 && col <= 2)return true;\n\telse{\n\t\treturn false;\n\t}\n}\n\nint translate(char ch){\n\tswitch(ch){\n\tcase 'A':return 0;\n\tcase 'B':return 1;\n\tcase 'C':return 2;\n\tcase 'D':return 10;\n\tcase 'E':return 11;\n\tcase 'F':return 12;\n\tcase 'G':return 20;\n\tcase 'H':return 21;\n\tcase 'I':return 22;\n\t}\n\n\treturn -1; //must not reach here.\n}\n\nint main(){\n\n\tint n,tmp,energy_row,energy_col,row,col;\n\tchar start[2],energy[2];\n\n\twhile(true){\n\t\tscanf(\"%d\",&n);\n\t\tif(n == 0)break;\n\n\t\tfor(int i = 0; i < 16; i++){\n\t\t\tfor(int p = 0; p < 3; p++){\n\t\t\t\tfor(int k = 0; k < 3; k++)memo[i][p][k] = 0;\n\t\t\t}\n\n\t\t}\n\n\t\tscanf(\"%s %s %s\",start,energy,b);\n\n\t\ttmp = translate(b[0]);\n\t\tb_row = tmp/10;\n\t\tb_col = tmp%10;\n\n\t\ttmp = translate(energy[0]);\n\t\tenergy_row = tmp/10;\n\t\tenergy_col = tmp%10;\n\n\t\ttmp = translate(start[0]);\n\n\t\trow = tmp/10,col = tmp%10;\n\n\t\tif(rangeCheck(row,col-1) == true && (row != b_row || col-1 != b_col)){\n\t\t\tmemo[1][row][col-1] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row,col+1) == true && (row != b_row || col+1 != b_col)){\n\t\t\tmemo[1][row][col+1] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row-1,col) == true && (row-1 != b_row || col != b_col)){\n\t\t\tmemo[1][row-1][col] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tif(rangeCheck(row+1,col) == true && (row+1 != b_row || col != b_col)){\n\t\t\tmemo[1][row+1][col] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] = 1;\n\t\t}\n\n\t\tfor(int loop = 2; loop <= n; loop++){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tif(i == b_row && k == b_col){\n\t\t\t\t\t\tmemo[loop][i][k] = 0;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(i == 0 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][0][0] = memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][0][0] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][0][0] += memo[loop-1][1][0];\n\t\t\t\t\t\t}else if(i == 0 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][0][1] = memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 0)memo[loop][0][1] += memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][0][1] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 2)memo[loop][0][1] += memo[loop-1][0][2];\n\t\t\t\t\t\t}else if(i == 0 && k == 2){\n\t\t\t\t\t\t\tmemo[loop][0][2] = memo[loop-1][0][2];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][0][2] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][0][2] += memo[loop-1][1][2];\n\t\t\t\t\t\t}else if(i == 1 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][1][0] = memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 0)memo[loop][1][0] += memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][1][0] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 0)memo[loop][1][0] += memo[loop-1][2][0];\n\t\t\t\t\t\t}else if(i == 1 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][1][1] = memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][1][1] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][1][1] += memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][1][1] += memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][1][1] += memo[loop-1][2][1];\n\t\t\t\t\t\t}else if(i == 1 && k == 2){\n\t\t\t\t\t\t\tmemo[loop][1][2] = memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 2)memo[loop][1][2] += memo[loop-1][0][2];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][1][2] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 2)memo[loop][1][2] += memo[loop-1][2][2];\n\t\t\t\t\t\t}else if(i == 2 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][2][0] = memo[loop-1][2][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][2][0] += memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][2][0] += memo[loop-1][2][1];\n\t\t\t\t\t\t}else if(i == 2 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][2][1] = memo[loop-1][2][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 0)memo[loop][2][1] += memo[loop-1][2][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][2][1] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 2)memo[loop][2][1] += memo[loop-1][2][2];\n\t\t\t\t\t\t}else if(i == 2 && k == 2){\n\t\t\t\t\t\t\tmemo[loop][2][2] = memo[loop-1][2][2];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][2][2] += memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][2][2] += memo[loop-1][2][1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\",((double)memo[n][energy_row][energy_col])/((double)pow(4,n)));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cassert>\nusing namespace std;\n#define rep(i, n) for ( int i = 0; i < n; i++ )\nint main(){\n    \n    int n;\n    char source, target, block;\n\n    int M[3][3], T[3][3];\n    while( cin >> n && n){\n\tcin >> source >> target >> block;\n\n\tassert( n <= 15 );\n\tassert( source != target && target != block && block != source );\n\tassert( 'A' <= source && source <= 'I' );\n\tassert( 'A' <= target && target <= 'I' );\n\tassert( 'A' <= block && block <= 'I' );\n\trep(i, 3) rep(j, 3) M[i][j] = 0;\n\t\n\tM[(source-'A')/3][(source-'A')%3] = 1;\n\n\tfor ( int t = 0; t < n; t++ ){\n\t    rep(a, 3) rep(b, 3) T[a][b] = 0;\n\n\t    static const int di[4] = {0, -1, 0, 1};\n\t    static const int dj[4] = {1, 0, -1, 0};\n\t    int ni, nj;\n\t    rep(i, 3) rep(j, 3){\n\t\tfor ( int r = 0; r < 4; r++ ){\n\t\t    ni = i + di[r];\n\t\t    nj = j + dj[r];\n\t\t    if  ( ni < 0 || nj < 0 || ni >= 3 || nj >= 3 || ni*3+nj == (block-'A') ) {\n\t\t\tT[i][j]+=M[i][j];\n\t\t    } else {\n\t\t\tT[ni][nj]+=M[i][j];\n\t\t    }\n\t\t}\n\t    }\n\t    rep(a, 3) rep(b, 3) M[a][b] = T[a][b];\n\t}\n\n\tint pos = target - 'A';\n\tint num = M[pos/3][pos%3];\n\n\tint p = 1;\n\tfor (int i = 0; i < n; i++ ) p *= 4;\n\n\t//\tcout << num << \"/\" << p << endl;\n\tprintf(\"%.7lf\\n\", 1.0*num/p);\n\n\t/*\n\tfor ( int i = 0; i < 3; i++ ){\n\t    for (int j = 0; j < 3; j++ ){\n\t\tprintf(\"%25d\", M[i][j]);\n\t    }\n\t    cout << endl;\n\t    }\n\t*/\n    }\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\nusing namespace std;\n\n#define pii pair<int,int>\n\nint main() {\n  int n;\n  int dx[]={0,1,0,-1};\n  int dy[]={-1,0,1,0};\n  \n  while(cin >> n, n) {\n    char cs, ct, cb;\n    cin >> cs >> ct >> cb;\n    int s=cs-'A', t=ct-'A', b=cb-'A';\n    int sx = s%3, sy = s/3;\n    int tx = t%3, ty = t/3;\n    int bx = b%3, by = b/3;\n\n    double dp[3][3][n+1];\n\n    for (int i=0; i<3;i++)\n      for(int j=0; j<3; j++)\n        for(int k=0; k<=n; k++)\n          dp[i][j][k] = 0;\n    \n    dp[sx][sy][0] = 1;\n    double p = 1;\n    int dx[] = {0,1,0,-1};\n    int dy[] = {-1,0,1,0};\n    \n    for (int i=1; i<=n; i++) {\n      for (int x=0; x<3; x++) {\n        for (int y=0; y<3; y++) {\n          if (x==bx&&y==by) continue;\n          for(int j=0; j<4; j++) {\n            int xx = x+dx[j];\n            int yy = y+dy[j];\n            if (xx<0||3<=xx || yy<0||3<=yy || (xx==bx&&yy==by)) {\n              xx = x;\n              yy = y;\n            }\n            dp[x][y][i] += dp[xx][yy][i-1] * 0.25;\n          }\n        }\n      }\n    }\n\n    printf(\"%.8f\\n\", dp[tx][ty][n]);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint ans;\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\nvoid solve(char n, char m[5][5] ){\n\tfor( ;n;n--){\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tchar n, s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A']=i%3+1;\n\t\tfy[i+'A']=i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d\", &n) , n ){\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\tchar m[5][5] = {0};\n\t\tfor(int i=1 ; i<=3 ; i++)\n\t\t\tfor(int j=1 ; j<=3 ; j++)\n\t\t\t\troom[i][j] = 0;\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;\n\n\t\tans = 0;\n\t\tif( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else{\n\t\t\tsolve( n , m );\n\t\t}\n\t\n\t\tprintf(\"%.8f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <functional>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n \nusing namespace std;\n \n#define REP(i,s,e) for(int i=(s); i<(int)(e); i++)\n#define rep(i,n) REP(i, 0, n)\n#define pb push_back\n#define mp make_pair\n#define all(r) (r).begin(),(r).end()\n#define rall(r) (r).rbegin(),(r).rend()\n#define fi first\n#define se second\n \ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vii;\ntypedef vector<ll> vl;\ntypedef vector<vl> vll;\ntypedef pair<int, int> pii;\ntypedef pair<double, int> pdi;\ntypedef pair<ll, ll> pll;\n \n\n \nconst int INF = 1000000;\nconst double EPS = 1e-8;\nconst int mod = 1e9 + 7;\nconst ll LINF = 1e18;\nconst double PI = acos(-1);\n\nstruct Input\n{\n\tint n;\n\tchar c;\n\tchar str[1024];\n\tint nextInt(){\n\t\tscanf(\"%d\", &n);\n\t\treturn n;\n\t}\n\tchar nextChar(){\n\t\tscanf(\"%c\", &c);\n\t\treturn c;\n\t}\n\tstring next(){\n\t\tscanf(\"%s\", str);\n\t\treturn string(str);\n\t}\n\tbool hasNext(){\n\t\treturn !cin.eof();\n\t}\n};\nInput in;\n\nint dx[]={-1, 0, 1, 0};\nint dy[]={0, -1, 0, 1};\n\nbool isOutofRange(int x, int y, int b){\n\treturn x < 0 || x >= 3 || y < 0 || y >= 3 || y*3+x==b;\n}\n\nint dp[20][3][3];\n\nint main(){\n\twhile(in.hasNext()){\n\t\tint n = in.nextInt();\n\t\tif(n == 0) break;\n\t\trep(i, 20) rep(j, 3) rep(k, 3) dp[i][j][k] = 0;\n\t\tint s = in.next()[0]-'A', t = in.next()[0]-'A', b = in.next()[0]-'A';\n\t\t//cout<<s<<\" \"<<t<<\" \"<<b<<endl;\n\t\t//int x = s % 3, y = s / 3;\n\t\tdp[0][s / 3][s % 3] = 1;\n\n\t\trep(i, n){\n\t\t\trep(x, 3) rep(y, 3)\n\t\t\t\trep(j, 4){\n\t\t\t\t\tint nx = x + dx[j], ny = y + dy[j];\n\t\t\t\t\tif(isOutofRange(nx, ny, b)) dp[i+1][y][x] += dp[i][y][x];\n\t\t\t\t\telse dp[i+1][ny][nx] += dp[i][y][x];\n\t\t\t\t}\n\t\t}\n\n\t\tll ans = 0LL;\n\t\trep(i, 3) rep(j, 3) ans += dp[n][i][j];\n\n\t\tprintf(\"%.15lf\\n\", (double)dp[n][t/3][t%3]/ans);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)n; ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\nint next[9][4] = {\n  {0,1,0,3},\n  {0,2,1,4},\n  {1,2,2,5},\n  {3,4,0,6},\n  {3,5,1,7},\n  {4,5,2,8},\n  {6,7,3,6},\n  {6,8,4,7},\n  {7,8,5,8}\n};\nint n;\nint s,t,b;\nchar s_,t_,b_;\n\nint dfs(int time,int place){\n  if(time == n) return place == t;\n  int ret = 0;\n  REP(r,4){\n    int nplace = next[place][r];\n    if(nplace==b) nplace = place;\n    ret += dfs(time+1, nplace);\n  }\n  return ret;\n}\nint main(){\n  while(cin>>n,n){\n    cin>>s_>>t_>>b_;\n    s = s_-'A';\n    t = t_-'A';\n    b = b_-'A';\n    cout<<(double)dfs(0,s)/(1<<(2*n))<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "# include <iostream>\n# include <algorithm>\n# include <vector>\n# include <string>\n# include <set>\n# include <map>\n# include <cmath>\n# include <iomanip>\n# include <functional>\n# include <utility>\n# include <stack>\n# include <queue>\n# include <list>\nusing namespace std;\nusing LL = long long;\nconstexpr int MOD = 1000000000 + 7;\nconstexpr int INF = 2000000000;\nconst double PI = acos(-1);\n\n\nint n;\nchar s, t, b;\npair<int, int> S, T, B;\ndouble dp[16][3][3];\n\nint dx[] = { 0,1,0,-1 }, dy[] = { -1,0,1,0 };\n\nint main() {\n\twhile (cin >> n&&n) {\n\t\tcin >> s >> t >> b;\n\t\tS = make_pair((s - 'A') / 3, (s - 'A') % 3);\n\t\tT = make_pair((t - 'A') / 3, (t - 'A') % 3);\n\t\tB = make_pair((b - 'A') / 3, (b - 'A') % 3);\n\t\tfor (int i = 0; i < 16; i++) {\n\t\t\tfor (int j = 0; j < 3; j++) {\n\t\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\t\tdp[i][j][k] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdp[0][S.first][S.second] = 1;\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int y = 0; y < 3; y++) {\n\t\t\t\tfor (int x = 0; x < 3; x++) {\n\t\t\t\t\tif (dp[i][y][x] == 0)continue;\n\t\t\t\t\tfor (int d = 0; d < 4; d++) {\n\t\t\t\t\t\tint ny = y + dy[d], nx = x + dx[d];\n\t\t\t\t\t\tif (0 <= nx&&nx < 3 && 0 <= ny&&ny < 3 && make_pair(ny, nx) != B)dp[i + 1][ny][nx] += dp[i][y][x] * 0.25;\n\t\t\t\t\t\telse dp[i + 1][y][x] += dp[i][y][x] * 0.25;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << fixed << setprecision(10) << dp[n][T.first][T.second] << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <sstream>\n#include <string>\n#include <vector>\n#include <map>\n#include <algorithm>\n#include <iostream>\n#include <utility>\n#include <set>\n#include <cctype>\n#include <queue>\n#include <stack>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\nusing namespace std;\n#define INF 100000000\ntypedef long long ll;\n\nint n;\nint sx, sy, gx, gy, bx, by; \nint dx[4] = {1, 0, -1, 0};\nint dy[4] = {0, 1, 0, -1};\ndouble dp[3][3][16];\n\n// 残りk回動けて今x, yにいるとき最後充電スペースにいける確率\ndouble dfs(int x, int y, int k) {\n    if (dp[x][y][k] >= 0) return dp[x][y][k];\n    if (k == 0) {\n        if (x == gx && y == gy) return 1;\n        else return 0;\n    }\n    double ret = 0;\n    for (int i = 0; i < 4; i++) {\n        int nx = x + dx[i];\n        int ny = y + dy[i];\n        if (nx < 0 || nx >= 3 || ny < 0 || ny >= 3) ret += dfs(x, y, k-1) / 4;\n        else if (nx == bx && ny == by) ret += dfs(x, y, k-1) / 4;\n        else ret += dfs(nx, ny, k-1) / 4;\n    }\n    return dp[x][y][k] = ret;\n}\n\nint main(void) {\n    while (1) {\n        cin >> n;\n        if (n == 0) break;\n        char s, t, b;\n        cin >> s >> t >> b;\n        sx = (int)(s-'A') % 3; sy = (int)(s-'A')/3;\n        gx = (int)(t-'A') % 3; gy = (int)(t-'A')/3;\n        bx = (int)(b-'A') % 3; by = (int)(b-'A')/3;\n        for (int i = 0; i < 3; i++)\n            for (int j = 0; j < 3; j++)\n                for (int k = 0; k < 16; k++)\n                    dp[i][j][k] = -1;\n        printf(\"%.10f\\n\", dfs(sx, sy, n));\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<queue>\n\ntypedef std::pair<int, int> P;\n\ndouble data[3][3];\nint cost[3][3];\nint sx, sy, tx, ty, bx, by;\n\nint dx[] = { 0, 1, 0, -1 };\nint dy[] = { 1, 0, -1, 0 };\n\nvoid bfs(){\n\n\tstd::queue<P>que;\n\tque.push(P(sx, sy));\n\n\twhile (!que.empty()){\n\t\tP p = que.front();\n\t\tque.pop();\n\n\t\tif (cost[p.second][p.first] > 0){\n\n\t\t\tfor (int i = 0; i < 4; i++){\n\t\t\t\tint nx = p.first + dx[i];\n\t\t\t\tint ny = p.second + dy[i];\n\n\t\t\t\tif (0 <= nx&&nx < 3 && 0 <= ny&&ny < 3 && !(nx == bx&&ny == by)){\n\t\t\t\t\tdata[ny][nx] += data[p.second][p.first] / 4;\n\t\t\t\t\tcost[ny][nx] = cost[p.second][p.first] - 1;\n\n\t\t\t\t\tque.push(P(nx, ny));\n\t\t\t\t}\n\t\t\t}\n\t\t\tcost[p.second][p.first]--;\n\t\t}\n\t}\n}\n\nint main(){\n\tint n;\n\twhile (std::cin >> n, n){\n\n\t\tmemset(data, 0, sizeof(data));\n\t\tmemset(cost, 0, sizeof(cost));\n\n\t\tchar s, t, b;\n\t\tstd::cin >> s >> t >> b;\n\n\t\tsx = (s - 'A') % 3;\n\t\tsy = (s - 'A') / 3;\n\t\ttx = (t - 'A') % 3;\n\t\tty = (t - 'A') / 3;\n\t\tbx = (b - 'A') % 3;\n\t\tby = (b - 'A') / 3;\n\n\t\tdata[sy][sx] = 1;\n\t\tcost[sy][sx] = n;\n\n\t\tbfs();\n\n\t\tprintf(\"%.8f\\n\", data[ty][tx]);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\nusing namespace std;\n\nint dx[4] = {0, 0, 1, -1};\nint dy[4] = {1, -1, 0, 0};\n\nint main() {\n  int n,pos,bpos;\n  string s,t,b;\n  while(cin>>n, n) {\n    cin>>s>>t>>b;\n    double mat[16][3][3];\n    for(int i=0; i<16; ++i)\n      for(int j=0; j<3; ++j)\n\tfor(int k=0; k<3; ++k)\n\t  mat[i][j][k] = 0.0;\n    pos = s.at(0)-'A';\n    bpos = b.at(0)-'A';\n    mat[0][pos/3][pos%3] = 1.0;\n    for(int i=1; i<=n; ++i) {\n      for(int j=0; j<3; ++j) {\n\tfor(int k=0; k<3; ++k) {\n\t  if(mat[i-1][j][k] > 0.0) {\n\t    for(int l=0; l<4; ++l) {\n\t      if(j+dx[l] == bpos/3 && k+dy[l] == bpos%3)\n\t\tmat[i][j][k] += mat[i-1][j][k] * 0.25;\n\t      else if(j+dx[l] >= 0 && j+dx[l] < 3\n\t\t      && k+dy[l] >= 0 && k+dy[l] < 3)\n\t\tmat[i][j+dx[l]][k+dy[l]] += mat[i-1][j][k] * 0.25;\n\t      else\n\t\tmat[i][j][k] += mat[i-1][j][k] * 0.25;\n\t    }\n\t  }\n\t}\n      }\n    }\n    pos = t.at(0)-'A';\n    printf(\"%.8f\\n\", mat[n][pos/3][pos%3]);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#define rep(i,n) for(int i=0;i<n;i++)\n#define ck(a) (0<=(a)&&(a)<9)\nint di[]={-3,-1,1,3};\nint main(){\n\tint n,s,t,b; char cs,ct,cb;\n\twhile(scanf(\"%d\",&n),n){\n\t\tscanf(\" %c %c %c\",&cs,&ct,&cb); s=cs-'A', t=ct-'A', b=cb-'A';\n\t\tdouble p[9]={0}; p[s]=1;\n\t\t\n\t\twhile(n--){\n\t\t\tdouble q[9]={0};\n\t\t\trep(i,9)rep(d,4){\n\t\t\t\tif(ck(i+di[d])&&!(i%3==0&&di[d]==-1)&&!(i%3==2&&di[d]==1)&&i+di[d]!=b)q[i+di[d]]+=p[i]/4;\n\t\t\t\telse q[i]+=p[i]/4;\n\t\t\t}\n\t\t\trep(i,9)p[i]=q[i];\n\t\t}\n\t\t\n\t\tprintf(\"%.8f\\n\",p[t]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\nusing namespace std;\nchar T[3], U[10] = \"ABCDEFGHI\"; int n, c[3][2], x[5][5]; double p[100][5][5];\n\nvoid A(int E, int B, int C, double D, int F, int G) { \n\tif (x[B][C] == 0) { \n\t\tp[E][B][C] += D; \n\t} \n\telse {\n\t\tp[E][F][G] += D;\n\t}\n}\n\nint main() {\n\twhile (true) {\n\t\tcin >> n;\n\t\tif (!n) { break; }\n\t\tcin >> T[0] >> T[1] >> T[2];\n\t\tfor (int i = 0; i < 3; i++) {\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tif (U[j] == (char)T[i]) {\n\t\t\t\t\tc[i][0] = j / 3 + 1;\n\t\t\t\t\tc[i][1] = j % 3 + 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tp[n][c[0][0]][c[0][1]] = 1;\n\t\tfor (int i = 0; i < 25; i++) {\n\t\t\tx[i / 5][i % 5] = 1;\n\t\t}\n\t\tfor (int i = 1; i <= 3; i++) {\n\t\t\tfor (int j = 1; j <= 3; j++) {\n\t\t\t\tif (i != c[2][0] || j != c[2][1]) {\n\t\t\t\t\tx[i][j] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\tfor (int j = 1; j <= 3; j++) {\n\t\t\t\tfor (int k = 1; k <= 3; k++) {\n\t\t\t\t\tif (p[i + 1][j][k]>0) {\n\t\t\t\t\t\tA(i, j - 1, k, 1.0*p[i + 1][j][k] / 4.0, j, k);\n\t\t\t\t\t\tA(i, j + 1, k, 1.0*p[i + 1][j][k] / 4.0, j, k);\n\t\t\t\t\t\tA(i, j, k + 1, 1.0*p[i + 1][j][k] / 4.0, j, k);\n\t\t\t\t\t\tA(i, j, k - 1, 1.0*p[i + 1][j][k] / 4.0, j, k);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << fixed << setprecision(15) << p[0][c[1][0]][c[1][1]] << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int dx[] = {-1, 0, 0, 1};\nconst int dy[] = { 0,-1, 1, 0};\n\nint sx, sy, gx, gy, n, bx, by;\ndouble P[3][3][20];\n\nbool check(int x, int y){\n  return (0 <= x && x < 3 && 0 <= y && y < 3);\n}\n\nvoid solve(){\n  P[sy][sx][n] = 1;\n\n  queue<int> qx, qy, rem;\n  qx.push(sx), qy.push(sy), rem.push(n);\n\n  while(!qx.empty()){\n    int x = qx.front(); qx.pop();\n    int y = qy.front(); qy.pop();\n    int r = rem.front(); rem.pop();\n\n    if(r == 0) continue;\n\n    for(int i = 0 ; i < 4 ; i++){\n      int nx = x + dx[i];\n      int ny = y + dy[i];\n\n      if(!check(nx, ny) || (nx == bx && ny == by)){\n        P[y][x][r-1] += P[y][x][r] / 4;\n        qx.push(x), qy.push(y), rem.push(r-1);\n      }else if(check(nx, ny)){\n        P[ny][nx][r-1] += P[y][x][r] / 4;\n        qx.push(nx), qy.push(ny), rem.push(r-1);\n      }\n    }\n  }\n\n  printf(\"%.8f\\n\",P[gy][gx][0]);\n}\n\nint main(){\n  char s, t, b;\n  \n  while(cin >> n, n){\n    memset(P, 0, sizeof(P));\n\n    cin >> s >> t >> b;\n    int ss = s - 'A', tt = t - 'A', bb = b - 'A';\n    sx = ss%3; sy = ss/3;\n    gx = tt%3; gy = tt/3;\n    bx = bb%3; by = bb/3;\n    solve();\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#define rep(i, n) for(int i = 0; i < n; ++i)\n#define ck(a) (0 <= (a) && (a) < 9)\n\nint di[] = {-3, -1, 1, 3};\n\nint main() {\n    int n, s, t, b; char cs, ct, cb;\n    while(scanf(\"%d\", &n)) {\n        if(n == 0) break;\n        getchar();\n        scanf(\"%c %c %c\", &cs, &ct, &cb);\n        s = cs - 'A', t = ct - 'A', b = cb - 'A';\n        double p[9] = {0}; p[s] = 1.0;\n\n\n        while(n--) {\n            double q[9] = {0};\n            rep(i, 9) rep(d, 4) {\n                if(ck(i + di[d]) && !(i % 3 == 0 && di[d] == -1) &&\n                   !(i % 3 == 2 && di[i] == 1) && i + di[d] != b)\n                    q[i + di[d]] += p[i] / 4;\n                else q[i] += p[i] / 4;\n            }\n            rep(i, 9) p[i] = q[i];\n        }\n        printf(\"%.8lf\\n\", p[t]);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <sstream>\n#include <cassert>\n#include <list>\nusing namespace std;\nstatic const double EPS = 1e-10;\ntypedef long long ll;\ntypedef pair<int,int> PI;\ntypedef vector<int> vi;\n#ifndef M_PI\n#define M_PI 3.14159265358979323846\n#endif\n#define rep(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define F first\n#define S second\n\nint dx[]={0,1,0,-1},dy[]={1,0,-1,0};\n\n\nmain(){\n  int n;\n  int t=0;\n  while(cin>>n,n){\n    ++t;\n    //cout<<n<<endl;\n    //if(t>8)break;\n    long double heya[3][3];\n    rep(i,3)rep(j,3)heya[i][j]=0.0;\n\n    char s,t,b;\n    cin>>s>>t>>b;\n    s-='A';\n    t-='A';\n    b-='A';\n\n    heya[s/3][s%3]=1.0;\n\n\n    while(n--){\n      //cout<<n<<endl;\n      if(n<0)break;\n      long double next[3][3];\n      rep(i,3)rep(j,3)next[i][j]=0;\n\n      rep(i,9){\n\tint cx=i/3,cy=i%3;\n\n\trep(j,4){\n\t  int nx=cx+dx[j],ny=cy+dy[j];\n\t  if(nx<0 || 2<nx || ny<0 || 2<nx || nx*3+ny==b)next[cx][cy]+=heya[cx][cy]/4;\n\t  else next[nx][ny]+=heya[cx][cy]/4;\n\t}\n      }\n      memcpy(heya,next,sizeof(next));\n    }\n    printf(\"%.8Lf\\n\",heya[t/3][t%3]);\n  }\n}\n    "
  },
  {
    "language": "C++",
    "code": "#include <set>\n#include <map>\n#include <list>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <ctype.h>\n#include <ctime>\n#include <cstdio>\n#include <vector>\n#include <string>\n#include <bitset>\n#include <cctype>\n#include <cstdlib>\n#include <cstring>\n#include <utility>\n#include <numeric>\n#include <complex>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <cassert>\n#include <iostream>\n#include <iterator>\n#include <algorithm>\n\nusing namespace std;\n//参考http://topcoder.g.hatena.ne.jp/isa_rentacs/20111114/1321278656 \n#define REP(i, x, n) for(int i = x; i < n; i++)\n#define rep(i, n) REP(i, 0, n)\n#define lengthof(x) (sizeof(x) / sizeof(*(x)))\n#define FILL(ptr, value) FILL_((ptr), sizeof(ptr)/sizeof(value), (value))\ntemplate <typename T>\nvoid FILL_(void * ptr, size_t size, T value){\n  std::fill((T*)ptr, (T*)ptr+size, value);\n}\n//4方向ベクトル→↑←↓\nint dx[] ={1,0,-1,0};\nint dy[] ={0,-1,0,1};\n\ndouble dp[16][9];\nint dir[4] = {1,-3,-1,3};\nint main()\n{\n  int n;\n  while(cin >>n&&n){\n    FILL(dp,0);\n    char tmp;\n    int s,t,b,x,y;\n    cin >> tmp; s = (int)(tmp - 'A');\n    cin >> tmp; t = (int)(tmp - 'A');\n    cin >> tmp; b = (int)(tmp - 'A');\n\n    dp[0][s] = 1;\n    for(int i = 0;i < n;i++){\n      for(int j = 0;j < 9;j++){\n\tif(dp[i][j] ==0)\n\t  continue;\n\tx = j%3;\n\ty = j/3;\n\tfor(int k = 0;k < 4;k++){\n\t  if(0 <= x+dx[k] && x+dx[k] < 3 &&\n\t     0 <= y+dy[k] && y+dy[k] < 3 &&\n\t     j+dir[k] != b){\n\t    dp[i+1][j+dir[k]] += (dp[i][j]*0.25);\n\t  }\n\t  else{\n\t    dp[i+1][j] +=(dp[i][j]*0.25);\n\t  }\n\t}\n      }\n    }\n    printf(\"%.8f\\n\",dp[n][t]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nint main()\n{\n\twhile ( true )\n\t{\n\t\tint n;\n\t\tchar s, t, b;\n\t\tcin >> n;\n\t\tif ( n == 0 )\n\t\t\tbreak;\n\t\tcin >> s >> t >> b;\n\n\t\tvector<double> P(9);\n\t\tP[s-'A'] = 1;\n\n\t\tfor ( int i=0; i<n; i++ )\n\t\t{\n\t\t\tvector<double> T = P;\n\t\t\tP = vector<double>(9);\n\n\t\t\tP[0] += T[0] / 4 * 2;\n\t\t\tP[1] += T[0] / 4 * 1;\n\t\t\tP[3] += T[0] / 4 * 1;\n\t\t\tP[0] += P[b-'A'],  P[b-'A'] = 0;\n\n\t\t\tP[1] += T[1] / 4 * 1;\n\t\t\tP[0] += T[1] / 4 * 1;\n\t\t\tP[2] += T[1] / 4 * 1;\n\t\t\tP[4] += T[1] / 4 * 1;\n\t\t\tP[1] += P[b-'A'],  P[b-'A'] = 0;\n\n\t\t\tP[2] += T[2] / 4 * 2;\n\t\t\tP[1] += T[2] / 4 * 1;\n\t\t\tP[5] += T[2] / 4 * 1;\n\t\t\tP[2] += P[b-'A'],  P[b-'A'] = 0;\n\t\t\t\n\t\t\tP[3] += T[3] / 4 * 1;\n\t\t\tP[0] += T[3] / 4 * 1;\n\t\t\tP[4] += T[3] / 4 * 1;\n\t\t\tP[6] += T[3] / 4 * 1;\n\t\t\tP[3] += P[b-'A'],  P[b-'A'] = 0;\n\n\t\t\tP[1] += T[4] / 4 * 1;\n\t\t\tP[3] += T[4] / 4 * 1;\n\t\t\tP[5] += T[4] / 4 * 1;\n\t\t\tP[7] += T[4] / 4 * 1;\n\t\t\tP[4] += P[b-'A'],  P[b-'A'] = 0;\n\n\t\t\tP[5] += T[5] / 4 * 1;\n\t\t\tP[2] += T[5] / 4 * 1;\n\t\t\tP[4] += T[5] / 4 * 1;\n\t\t\tP[8] += T[5] / 4 * 1;\n\t\t\tP[5] += P[b-'A'],  P[b-'A'] = 0;\n\n\t\t\tP[6] += T[6] / 4 * 2;\n\t\t\tP[3] += T[6] / 4 * 1;\n\t\t\tP[7] += T[6] / 4 * 1;\n\t\t\tP[6] += P[b-'A'],  P[b-'A'] = 0;\n\t\t\t\n\t\t\tP[7] += T[7] / 4 * 1;\n\t\t\tP[4] += T[7] / 4 * 1;\n\t\t\tP[6] += T[7] / 4 * 1;\n\t\t\tP[8] += T[7] / 4 * 1;\n\t\t\tP[7] += P[b-'A'],  P[b-'A'] = 0;\n\n\t\t\tP[8] += T[8] / 4 * 2;\n\t\t\tP[5] += T[8] / 4 * 1;\n\t\t\tP[7] += T[8] / 4 * 1;\n\t\t\tP[8] += P[b-'A'],  P[b-'A'] = 0;\n\t\t}\n\n\t\tprintf( \"%.20f\\n\", P[t-'A'] );\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <sstream>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <cstring>\n#include <climits>\n#include <cfloat>\n#include <string>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <algorithm>\n#include <functional>\n#include <utility>\n#include <numeric>\n\nusing namespace std;\n\ntypedef unsigned int UI;\ntypedef long long LL;\ntypedef unsigned long long ULL;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int,int> PII;\ntypedef istringstream ISS;\ntypedef ostringstream OSS;\n\n#define REP( i, m, n ) for ( int i = (int)( m ); i < (int)( n ); ++i )\n#define FOR( v, c ) for ( auto &v : c )\n\n#define ITER( c ) __typeof( (c).begin() )\n#define EACH( it, c ) for ( ITER(c) it = c.begin(); it != c.end(); ++it )\n#define ALL( c ) (c).begin(), (c).end()\n\n#define PB( n ) push_back( n )\n#define MP( a, b ) make_pair( ( a ), ( b ) )\n#define EXIST( c, e ) ( (c).find( e ) != (c).end() )\n\n#define fst first\n#define snd second\n\n#define DUMP( x ) cerr << #x << \" = \" << ( x ) << endl\n#define DEBUG( x ) cerr << __FILE__ << \":\" << __LINE__ << \": \" << #x << \" = \" << ( x ) << endl\n\nconst int dir[][2] = {\n\t1, 0,\n\t0, 1,\n\t-1, 0,\n\t0, -1\n};\n\nPII c2idx( char c )\n{\n\tint n = c - 'A';\n\treturn MP( n / 3, n % 3 );\n}\n\nint main()\n{\n\tcin.tie( 0 );\n\tios::sync_with_stdio( false );\n\tcout.precision( 7 );\n\tcout << fixed;\n\n\twhile ( true )\n\t{\n\t\tint n;\n\t\tcin >> n;\n\t\tif ( !n )\n\t\t{\n\t\t\tbreak;\n\t\t}\n\t\t\n\t\tchar s_, t_, b_;\n\t\tcin >> s_ >> t_ >> b_;\n\t\t\n\t\tPII s = c2idx( s_ ), t = c2idx( t_ ), b = c2idx( b_ );\n\n\t\tvector< vector< vector<double> > > dp( n + 1, vector< vector<double> >( 3, vector<double>( 3, 0 ) ) );\n\t\tdp[0][ s.fst ][ s.snd ] = 1;\n\n\t\tREP( t, 0, n )\n\t\t{\n\t\t\tREP( i, 0, 3 )\n\t\t\t{\n\t\t\t\tREP( j, 0, 3 )\n\t\t\t\t{\n\t\t\t\t\tREP( d, 0, 4 )\n\t\t\t\t\t{\n\t\t\t\t\t\tint di = i + dir[d][0], dj = j + dir[d][1];\n\n\t\t\t\t\t\tif ( !( 0 <= di && di < 3 && 0 <= dj && dj < 3 ) || MP( di, dj ) == b )\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[ t + 1 ][i][j] += dp[t][i][j] / 4;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[ t + 1 ][ di ][ dj ] += dp[t][i][j] / 4;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << dp.back()[ t.fst ][ t.snd ] << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<map>\n#include<string>\n#include<vector>\n#include<algorithm>\n#include<queue>\n#include<set>\n#include<map>\nusing namespace std;\n\nint k, x, y, z;\ndouble S;\nint b[9][4]={\n\t{1,3,-1,-1},\n\t{ 0,2,4,-1 },\n\t{ 1,5,-1,-1 },\n\t{ 0,4,6,-1 },\n\t{ 1,3,5,7 },\n\t{ 2,4,8,-1 },\n\t{ 3,7,-1,-1 },\n\t{ 4,6,8,-1 },\n\t{ 5,7,-1,-1 }\n};\nvoid  saiki(int c, int d,double e) {//c?????????d?????§e????¢??????§\n\tif (c == k) {\n\t  if(d==y)\tS += e;\n\t  return;\n\t}\n\tfor (int i = 0; i < 4; i++) {\n\t\tif (b[d][i] ==-1 || b[d][i] == z)saiki(c + 1, d, e*0.25);\n\t\telse saiki(c + 1, b[d][i], e*0.25);\n\t}\n}\nint main() {\n\twhile (cin >> k, k) {\n\t\tS = 0;\n\t\tchar a, b, c; cin >> a >> b >> c;\n\t\tx = a - 'A'; y = b - 'A'; z = c - 'A';\n\t\tsaiki(0, x, 1.0);\n\t\tprintf(\"%.10lf\\n\", S);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <map>\n#include <cstdio>\n\nusing namespace std;\n\nconst double EPS = 1e-8;\n\nint n;\npair<int, int> s, t, b;\ndouble dp[16][3][3];\nint dy[] = {-1, 0, 1, 0};\nint dx[] = {0, 1, 0, -1};\n\nbool equals(double a, double b){\n  return abs(a-b) < EPS;\n}\n\nvoid setp(pair<int, int>& p, char c){\n  int tmp = c - 'A';\n  p = make_pair(tmp/3, tmp-(tmp/3)*3);\n}\n\nmain(){\n  while(cin >> n && n){\n    char in1, in2, in3;\n    cin >> in1 >> in2 >> in3;\n    setp(s, in1);\n    setp(t, in2);\n    setp(b, in3);\n    fill(dp[0][0], dp[16][0], 0.0);\n    dp[0][s.first][s.second] = 1.0;\n    for(int i=0;i<n;i++){\n      for(int j=0;j<3;j++){\n\tfor(int k=0;k<3;k++){\n\t  if(equals(dp[i][j][k], 0.0)) continue;\n\t  if(j == t.first && k == t.second){\n\t    dp[i+1][j][k] += dp[i][j][k];\n\t    continue;\n\t  }\n\t  for(int l=0;l<4;l++){\n\t    int ty = j + dy[l];\n\t    int tx = k + dx[l];\n\t    if(ty>=0 && ty<3){\n\t      if(tx>=0 && tx<3){\n\t\tif(ty != b.first || tx != b.second){\n\t\t  dp[i+1][ty][tx] += dp[i][j][k] / 4.0;\n\t\t  continue;\n\t\t}\n\t      }\n\t    }\n\t    dp[i+1][j][k] += dp[i][j][k] / 4.0;\n\t  }\n\t}\n      }\n    }\n    printf(\"%.8f\\n\", dp[n][t.first][t.second]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include \"bits/stdc++.h\"\n#if defined(_MSC_VER) || defined(ONLINE_JUDGE)\n#define getchar_unlocked _getchar_nolock\n#define putchar_unlocked _putchar_nolock\n#endif\n#define rep(i, n) for(int i=0; i<(n); ++i)\n#define FOR(i, m, n) for(int i=(m); i<(n); ++i)\n#define sz(x) ((int)(x).size())\n#define all(x) (x).begin(),(x).end()\n#define rall(x) (x).rbegin(),(x).rend()\n#define mp make_pair\n#define pb push_back\n#define dump(x) cerr << #x << \" = \" << (x) << endl;\n\nusing namespace std;\nusing LL=long long;\nusing VI=vector<int>;      using VL=vector<LL>;\nusing VS=vector<string>;   using VD=vector<double>;\nusing VVI=vector<VI>;      using VVL=vector<VL>;\nusing PII=pair<int, int>;  using PLL=pair<LL, LL>;\nconst int inf = (int)1e9;  const double pi = acos(-1.0);\nconst LL MOD = 1000000007; const string Snum = \"0123456789\";\nconst int dx[] = { -1,0,1,0,-1,-1,1,1 }, dy[] = { 0,1,0,-1,-1,1,-1,1 };\n\ntemplate<class T>void Sort(T& a) { sort(all(a)); }\ntemplate<class T>void RSort(T& a) { sort(rall(a)); }\ntemplate<class T>void Reverse(T& a) { reverse(all(a)); }\ntemplate<class T>void Unique(T& a) { a.erase(unique(all(a)), a.end()); }\ntemplate<class T>auto Max(const T& a) { return *max_element(all(a)); }\ntemplate<class T>auto Min(const T& a) { return *min_element(all(a)); }\ntemplate<class T>int MaxPos(const T& a) { return max_element(all(a)) - a.begin(); }\ntemplate<class T>int MinPos(const T& a) { return min_element(all(a)) - a.begin(); }\ntemplate<class T, class U>int Count(const T& a, U v) { return count(all(a), v); }\ntemplate<class T, class U>int Find(const T& a, U v) { auto pos = find(all(a), v); return pos == a.end() ? -1 : pos - a.begin(); }\ntemplate<class T, class U>U Sum(const T& a, U v) { return accumulate(all(a), v); }\ntemplate<class T, class U>int Lower(const T& a, U v) { return lower_bound(all(a), v) - a.begin(); }\ntemplate<class T, class U>int Upper(const T& a, U v) { return upper_bound(all(a), v) - a.begin(); }\ntemplate<class T, class P>int CountIf(const T& a, P f) { return count_if(all(a), f); }\ntemplate<class T, class P>void RemoveIf(T& a, P f) { a.erase(remove_if(all(a), f), a.end()); }\ntemplate<class T>T Age(T n, T m) { return (n + m - 1) / m; }\ntemplate<class T>T Gcd(T n, T m) { return m == 0 ? n : Gcd(m, n % m); }\ntemplate<class T>T Lcm(T n, T m) { return n / Gcd(n, m) * m; }\ntemplate<class T>T Pow(T a, T n) { T r = 1; while (n > 0) { if (n & 1)r *= a; a *= a; n /= 2; }return r; }\ntemplate<class T>T Powmod(T a, T n, T m = MOD) { T r = 1; while (n > 0) { if (n & 1)r = r * a % m, n--; else a = a * a % m, n /= 2; }return r; }\nstring operator*(string s, int n) { string ret; rep(i, n)ret += s; return ret; }\n\n/* INPUT */\ntemplate<class T>T InputF() { T ret; cin >> ret; return ret; }\ntemplate<> char InputF() {\n\tchar ret = '\\0', c = getchar_unlocked();\n\twhile (c != '\\0' && c != '\\n' && c != '\\t' && c != ' ') { ret = c; c = getchar_unlocked(); }\n\treturn ret;\n}\ntemplate<> string InputF() {\n\tstring ret; char c = getchar_unlocked();\n\twhile (c != '\\0' && c != '\\n' && c != '\\t' && c != ' ') { ret.push_back(c); c = getchar_unlocked(); }\n\treturn ret;\n}\ntemplate<> int InputF() {\n\tint ret = 0; bool neg = false; char c = getchar_unlocked();\n\tif (c == '-') { neg = true; c = getchar_unlocked(); }\n\twhile ('0' <= c && c <= '9') { ret = ret * 10 + (c - '0'); c = getchar_unlocked(); }\n\treturn neg ? -ret : ret;\n}\ntemplate<> LL InputF() {\n\tLL ret = 0; bool neg = false; char c = getchar_unlocked();\n\tif (c == '-') { neg = true; c = getchar_unlocked(); }\n\twhile ('0' <= c && c <= '9') { ret = ret * 10LL + (LL(c) - LL('0')); c = getchar_unlocked(); }\n\treturn neg ? -ret : ret;\n}\ntemplate<> double InputF() {\n\tdouble ret = 0, dp = 1; bool neg = false, adp = false; char c = getchar_unlocked();\n\tif (c == '-') { neg = true; c = getchar_unlocked(); }\n\twhile (('0' <= c && c <= '9') || c == '.') {\n\t\tif (c == '.') { adp = true; }\n\t\telse if (adp) { dp *= 0.1; ret += (c - '0') * dp; }\n\t\telse { ret = ret * 10.0 + (c - '0'); }\n\t\tc = getchar_unlocked();\n\t}\n\treturn neg ? -ret : ret;\n}\nstring GetLine() {\n\tstring ret; char c = getchar_unlocked();\n\twhile (c != '\\0' && c != '\\n') { ret.push_back(c); c = getchar_unlocked(); }\n\treturn ret;\n}\n\ntemplate<class T>T StoT(string s) { return s; }\ntemplate<> char StoT(string s) { return s.front(); }\ntemplate<> string StoT(string s) { return s; }\ntemplate<> int StoT(string s) { return stoi(s); }\ntemplate<> LL StoT(string s) { return stoll(s); }\ntemplate<> double StoT(string s) { return stod(s); }\n\nVS InputB;\ntemplate<class T>struct InputC {\n\toperator T() { return InputF<T>(); }\n\tvector<T> operator[](int h) {\n\t\tvector<T> ret(h);\n\t\trep(i, h)ret[i] = InputF<T>();\n\t\treturn ret;\n\t}\n\tvector<vector<T>> operator[](PII p) {\n\t\tint h, w; tie(h, w) = p;\n\t\tvector<vector<T>> ret(h, vector<T>(w));\n\t\trep(i, h)rep(j, w)ret[i][j] = InputF<T>();\n\t\treturn ret;\n\t}\n\tT operator()(int n) {\n\t\twhile (sz(InputB) <= n)InputB.pb(InputF<string>());\n\t\treturn StoT<T>(InputB[n]);\n\t}\n\tvector<T> operator()(int n, int h) {\n\t\tvector<T> ret(h);\n\t\trep(i, h)ret[i] = InputC::operator()(i + n);\n\t\treturn ret;\n\t}\n\tvector<vector<T>> operator()(int n, int h, int w) {\n\t\tvector<vector<T>> ret(h, vector<T>(w));\n\t\trep(i, h)rep(j, w)ret[i][j] = InputC::operator()(n + i * w + j);\n\t\treturn ret;\n\t}\n};\nInputC<char> inc; InputC<string> ins; InputC<int> ini; InputC<LL> inl; InputC<double> ind;\n\n/* OUTPUT */\nclass ostreamfbuff : public basic_streambuf<char, char_traits<char>> {\nprotected:int overflow(int nCh = EOF) { putchar_unlocked(nCh); return 0; }\n};\nclass ostreamf : public basic_iostream<char, char_traits<char>> {\npublic:ostreamf(void) : basic_iostream<char, char_traits<char>>(new ostreamfbuff()) {}\n};\nostreamf coutf; ostream& operator<<(ostream& ostr, InputC<string> i) { ostr << string(i); return ostr; }\nstruct BoolStr { string t, f; BoolStr(string _t, string _f) :t(_t), f(_f) {} }yes(\"yes\", \"no\"), Yes(\"Yes\", \"No\"), YES(\"YES\", \"NO\"), Yay(\"Yay!\", \":(\");\nstruct Divizer { string s; Divizer(string _s) :s(_s) {} }spc(\" \"), nosp(\"\"), comma(\",\"), lin(\"\\n\");\nstruct Output {\n\tbool flag = false; BoolStr bs; Divizer di;\n\tOutput(bool f, BoolStr b, Divizer d) :flag(f), bs(b), di(d) {}\n\ttemplate<class T>void print(T o) { coutf << o; }\n\tvoid print(double o) { printf(\"%.20f\", o); }\n\tvoid print(bool o) { coutf << (o ? bs.t : bs.f); }\n\ttemplate<class T, class U>void print(const pair<T, U>& o) {\n\t\tprint(o.first); coutf << di.s; print(o.second);\n\t}\n\ttemplate<class T>void print(const vector<T>& o) {\n\t\tfor (int i = 0; i < (int)o.size(); ++i) { if (i != 0)coutf << di.s; print(o[i]); }\n\t}\n\ttemplate<class T>void print(const vector<vector<T>>& o) {\n\t\tfor (int i = 0; i < (int)o.size(); ++i) { if (i != 0)coutf << '\\n'; print(o[i]); }\n\t}\n\ttemplate<class T, class U>void print(const map<T, U>& o) {\n\t\tcoutf << \"Map\"; for (auto a : o) { coutf << \" {\"; print(a); coutf << \"},\"; } coutf << '\\n';\n\t}\n\ttemplate<class T>void print(const set<T>& o) {\n\t\tcoutf << \"Set {\"; for (auto a : o) { print(a); coutf << \",\"; } coutf << \"}\\n\";\n\t}\n\ttemplate<class T>Output operator ,(T o) {\n\t\tif (flag)coutf << di.s; print(o); Output t(true, bs, di); return t;\n\t}\n\tOutput operator,(Output o) { coutf << '\\n'; Output t(false, bs, di); return t; }\n\tOutput operator,(BoolStr b) { Output t(flag, b, di); return t; }\n\tOutput operator,(Divizer d) { Output t(flag, bs, d); return t; }\n}out(false, Yes, spc);\n\n/* ANSWER */\nstruct Answer {\n\tint mini = INT_MAX, maxi = INT_MIN, sumi = 0;\n\tLL minl = LLONG_MAX, maxl = LLONG_MIN, suml = 0;\n\tdouble mind = DBL_MAX, maxd = DBL_MIN, sumd = 0; int cnt = 0;\n\tvoid operator=(int n) { mini = min(mini, n); maxi = max(maxi, n); sumi += n; cnt++; }\n\tvoid operator=(LL n) { minl = min(minl, n); maxl = max(maxl, n); suml += n; cnt++; }\n\tvoid operator=(double n) { mind = min(mind, n); maxd = max(maxd, n); sumd += n; cnt++; }\n}ans;\n\n\nstruct Point {\n\tint x, y;\n\tPoint() :x(-1), y(-1) {}\n\tPoint(int _x, int _y) :x(_x), y(_y) {}\n\tPoint(int val, int h, int w) :x(val% w), y(val / w) {}\n\tPoint operator+() { return *this; }\n\tPoint operator-() { return { -x,-y }; }\n\tPoint operator+(Point p) { return { x + p.x,y + p.y }; }\n\tPoint operator-(Point p) { return { x - p.x,y - p.y }; }\n\tPoint operator*(Point p) { return { x * p.x,y * p.y }; }\n\tPoint operator/(Point p) { return { x / p.x,y / p.y }; }\n\tPoint operator+(int d) { return { x + d,y + d }; }\n\tPoint operator-(int d) { return { x - d,y - d }; }\n\tPoint operator*(int d) { return { x * d,y * d }; }\n\tPoint operator/(int d) { return { x / d,y / d }; }\n\tPoint& operator+=(Point p) { x += p.x; y += p.y; return *this; }\n\tPoint& operator-=(Point p) { x -= p.x; y -= p.y; return *this; }\n\tPoint& operator*=(Point p) { x *= p.x; y *= p.y; return *this; }\n\tPoint& operator/=(Point p) { x /= p.x; y /= p.y; return *this; }\n\tbool operator==(Point p) { return x == p.x && y == p.y; }\n\tbool operator!=(Point p) { return x != p.x || y != p.y; }\n\tint Dist(Point p) { return abs(x - p.x) + abs(y - p.y); }\n\tbool inBound(int H, int W) { return 0 <= x && x < W && 0 <= y && y < H; }\n\tarray<Point, 4> Adjacent4() {\n\t\tarray<Point, 4> ret = { Point(x,y + 1),Point(x,y + -1),Point(x + 1,y),Point(x + -1,y) };\n\t\treturn ret;\n\t}\n\tarray<Point, 8> Adjacent8() {\n\t\tarray<Point, 8> ret = { Point(x,y + 1),Point(x,y - 1),Point(x + 1,y),Point(x - 1,y),\n\t\t\tPoint(x + 1,y + 1),Point(x + 1,y + -1),Point(x - 1,y + 1),Point(x - 1,y - 1) };\n\t\treturn ret;\n\t}\n\ttemplate<class T>auto& operator[](T& v) { return v[y][x]; }\n};\n\n\nPoint S, T, D;\nint N;\n\nvoid solve() {\n\tvector<VVI> dp(N + 1, VVI(3, VI(3)));\n\tS[dp[0]] = 1;\n\n\tFOR(i, 1, N + 1) {\n\t\trep(y, 3)rep(x, 3) {\n\t\t\tPoint p(x, y);\n\t\t\tfor (auto p2 : p.Adjacent4()) {\n\t\t\t\tif (p2.inBound(3, 3) && p2 != D)p[dp[i]] += p2[dp[i - 1]];\n\t\t\t\telse p[dp[i]] += p[dp[i - 1]];\n\t\t\t}\n\t\t}\n\t}\n\n\tout, T[dp[N]] / pow(4, N), out;\n}\n\nint main() {\n\twhile (cin >> N && N) {\n\t\tchar s, t, d;\n\t\tcin >> s >> t >> d;\n\t\tS = Point(s - 'A', 3, 3);\n\t\tT = Point(t - 'A', 3, 3);\n\t\tD = Point(d - 'A', 3, 3);\n\t\tsolve();\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n\nint dp[16][3 + 2][3 + 2];\n\nint main(void)\n{\n\tint n;\n\tchar s[2], e[2], t[2];\n\tint start;\n\tint end;\n\tint not;\n\tint mot;\n\t\n\twhile (1){\n\t\tscanf(\"%d\", &n);\n\t\tif (n == 0) break;\n\t\t\n\t\tscanf(\"%s%s%s\", s, e, t);\n\t\t\n\t\tfor (int i = 0; i < 5; i++){\n\t\t\tfor (int j = 0; j < 5; j++){\n\t\t\t\tfor (int k = 0; k < 16; k++){\n\t\t\t\t\tif (i == 0 || i == 4 || j == 0 || j == 4){\n\t\t\t\t\t\tdp[k][i][j] = -1;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[k][i][j] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tstart = s[0] - 'A';\n\t\tnot = t[0] - 'A';\n\t\tdp[0][(start % 3) + 1][(start / 3) + 1] = 1;\n\t\t\n\t\tfor (int i = 0; i < n + 1; i++){\n\t\t\tdp[i][(not % 3) + 1][(not / 3) + 1] = -1;\n\t\t}\n\t\t\n\t\tfor (int i = 0; i < n; i++){\n\t\t\tfor (int y = 1; y <= 3; y++){\n\t\t\t\tfor (int x = 1; x <= 3; x++){\n\t\t\t\t\tif (dp[i][x][y] == -1) continue;\n\t\t\t\t\tif (dp[i][x + 1][y] == -1){\n\t\t\t\t\t\tdp[i + 1][x][y] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[i + 1][x + 1][y] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t\tif (dp[i][x - 1][y] == -1){\n\t\t\t\t\t\tdp[i + 1][x][y] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[i + 1][x - 1][y] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t\tif (dp[i][x][y + 1] == -1){\n\t\t\t\t\t\tdp[i + 1][x][y] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[i + 1][x][y + 1] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t\tif (dp[i][x][y - 1] == -1){\n\t\t\t\t\t\tdp[i + 1][x][y] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[i + 1][x][y - 1] += dp[i][x][y];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tmot = 0;\n\t\tfor (int y = 1; y <= 3; y++){\n\t\t\tfor (int x = 1; x <= 3; x++){\n\t\t\t\tif (dp[n][x][y] != -1){\n\t\t\t\t\tmot += dp[n][x][y];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tend = e[0] - 'A';\n\t\tprintf(\"%lf\\n\", double((double)(dp[n][(end % 3) + 1][(end / 3) + 1]) / (double)mot));\n\t}\n\t\n\treturn (0);\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<algorithm>\n#include<array>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<functional>\n#include<limits>\n#include<list>\n#include<map>\n#include<numeric>\n#include<set>\n#include<stack>\n#include<string>\n#include<sstream>\n#include<unordered_map>\n#include<queue>\n#include<vector>\nusing namespace std;\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing pii = pair<int, int>;\n\n#define rep(i,a,b) for(int i=(a);i<(b);i++)\n#define rrep(i,a,b) for(int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n#define dump(o) {cerr<<#o<<\" \"<<o<<endl;}\n#define dumpc(o) {cerr<<#o; for(auto &e:(o))cerr<<\" \"<<e;cerr<<endl;}\n#define INF 0x3f3f3f3f\n#define INFL 0x3f3f3f3f3f3f3f3fLL\nconst int MOD = 1e9 + 7;\n\nint di[4] = { 1,0,-1,0 };\nint dj[4] = { 0,1,0,-1 };\n\nsigned main() {\n\tcout << fixed << setprecision(8);\n\tfor (int n; cin >> n&&n;) {\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tdouble f[3][3] = {};\n\t\tdouble g[3][3] = {};\n\t\tpii S, T, B;\n\t\tS = pii((s - 'A') / 3, (s - 'A') % 3);\n\t\tT = pii((t - 'A') / 3, (t - 'A') % 3);\n\t\tB = pii((b - 'A') / 3, (b - 'A') % 3);\n\t\tf[S.first][S.second] = 1;\n\t\twhile (n--) {\n\t\t\trep(i, 0, 3)rep(j, 0, 3)g[i][j] = 0;\n\t\t\tswap(f, g);\n\t\t\trep(a, 0, 3) rep(b, 0, 3) {\n\t\t\t\tint cnt = 4;\n\t\t\t\trep(i, 0, 4) {\n\t\t\t\t\tif (a + di[i] == B.first&&b + dj[i] == B.second) continue;\n\t\t\t\t\tif (0 > a + di[i] && a + di[i] > 2)continue;\n\t\t\t\t\tif (0 > b + dj[i] && b + dj[i] > 2)continue;\n\t\t\t\t\tf[a + di[i]][b + dj[i]] += g[a][b] / cnt;\n\t\t\t\t}\n\t\t\t\tf[a][b] += (g[a][b] / cnt)*(4 - cnt);\n\t\t\t}\n\t\t}\n\t\tcout << f[T.first][T.second] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\nusing namespace std;\n\nint y11(int);\nint x11(int);\n\n    int main(){\n\n\tint n;\n\tchar st,ba,sto;\n\tdouble dx[] = {0.0,1.0,0.0,-1.0};\n\tdouble dy[] = {1.0,0.0,-1.0,0.0};\n\tint ma[3][3] = {{0,0,0},\n                       {0,0,0},\n                       {0,0,0}};\n\n\twhile(true){\n\t  cin >> n;\n\t   long double dp[15][4][4];\n\t    for(int i=0;i<15;i++)for(int j=0;j<4;j++)for(int k=0;k<4;k++)dp[i][j][k]=0.0;\n\t    if(n == 0)break;\n\t    cin >> st;\n\t    cin >> ba;\n\t    cin >> sto;\n\t    //maÍ¢çÈ¢q\n\t    ma[y11(st)][x11(st)]=4;//X^[g\n\t    ma[y11(ba)][x11(ba)]=9;//[d\n\t    ma[y11(sto)][x11(sto)]=8;//qÉ\n\n\t    int nx,ny;\n\t    dp[n][y11(st)][x11(st)]=1.0;\n\t   \n\n\t    while(1){\n\t\tif(n ==  0)break;\n\t\n\t\t/*\t\t\n\t\tcout << \"n = \" << n << endl;\n\t\tfor(int g=0;g<3;g++){\n\t\t  for(int f=0;f<3;f++){\n\t\t    cout << dp[n][g][f] << \" \";\n\t\t  }\n\t\t  cout << endl;\n\t\t} \n\t\tcout << endl;\n*/\n\n\t\tfor(int t=0;t<=2;t++){\n\t\t    for(int g =0 ;g<=2;g++){\n\t\t\tfor(int i=0;i<4;i++){\n\t\t\t    nx = g+dx[i];\n\t\t\t    ny = t+dy[i];\t\t    \n\t\t\t    if(nx>2 || ny>2 ||nx<0 || ny<0){nx = g; ny =t;}\n\t\t\t    else if(nx == x11(sto) && ny == y11(sto)){nx = g;\n\t\t\t\tny = t;\n\t\t\t    }\n\t\t\t    dp[n-1][ny][nx] += dp[n][t][g]*0.25;\t\t    \n\t\t\t}\n\t\t    }\n\t\t}\n\t\tn--;\n\n\t    }\n \n\t    // ----------------DEBUG--------------//\n\t    \n\n\t    /*\n\t\tfor(int g=0;g<3;g++){\n\t\t    for(int f=0;f<3;f++){\n\t\t    cout << dp[0][g][f] << \" \";\n\t\t    }\n\t\t    cout << endl;\n\t\t} \n\t    */\n\t\t\n\t    //----------------DEBUG---------------//\n\t    //   DecimalFormat dc = new DecimalFormat();\n\t \n\t    printf(\"%.8Lf\\n\",dp[0][y11(ba)][x11(ba)]);\n\n\n\t      }\n\n\n    }\n\n    \n\n    int y11(int s){\n      if(s == 'A')return 0;\n\tif(s == 'B')return 0;\n\tif(s=='C')return 0;\n\tif(s=='D')return 1;\n\tif(s=='E')return 1;\n\tif(s=='F')return 1;\n\tif(s=='G')return 2;\n\tif(s=='H')return 2;\n\tif(s =='I')return 2;\n\treturn 0;\n\t\n    }\n    int x11(int s){\n\tif(s=='A')return 0;\n\tif(s=='B')return 1;\n\tif(s=='C')return 2;\n\tif(s=='D')return 0;\n\tif(s=='E')return 1;\n\tif(s=='F')return 2;\n\tif(s=='G')return 0;\n\tif(s=='H')return 1;\n\tif(s=='I')return 2;\n\treturn 0;\n\n    }"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<vector>\n\nusing namespace std;\n\nconst int MAX = 16;\nconst double per = 1.0/4.0;\nchar s,t,b;\nint n;\nint nex[9][9] = {{1,3,0,0},{0,2,4,1},{1,5,2,2},{0,4,6,3},{1,3,5,7},{2,4,8,5},{3,7,6,6},{4,6,8,7},{5,7,8,8}};\ndouble dp[MAX][9];\n\nvoid init(char c){\n  memset(dp,0,sizeof(dp));\n  dp[0][c-'A'] = 1.0;\n}\n\nvector<int> get(int pos){\n  vector<int> V;\n\n  for(int i = 0; i < 4; i++)\n    if(nex[pos][i] == b-'A') V.push_back(pos);\n    else V.push_back(nex[pos][i]);\n\n  return V;\n}\n\nvoid solve(){\n  for(int i = 0; i < n; i++)\n    for(int j = 0; j < 9; j++){\n      vector<int> V = get(j);\n      for(int k = 0; k < V.size(); k++)\n\tdp[i+1][V[k]] += dp[i][j]*per;\n    } \n}\n\nint main(){\n  while(cin >> n && n){\n    cin >> s >> t >> b;\n    init(s);\n    solve();\n    printf(\"%.8f\\n\",dp[n][t-'A']);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<iomanip>\nusing namespace std;\nchar map[3][3]={'A','B','C','D','E','F','G','H','I'};\ndouble dp[16][3][3];\nint dx[4]={0,1,0,-1},dy[4]={1,0,-1,0};\nint main(){\n\tint n;\n\tchar s,t,d;\n\twhile(true){\n\tcin>>n;\n\tif(n==0)break;\n\tcin>>s>>t>>d;\n\tfor(int i=0;i<=n;i++)for(int f=0;f<3;f++)for(int g=0;g<3;g++)dp[i][f][g]=0.0;\n\tfor(int i=0;i<3;i++)for(int j=0;j<3;j++)if(map[i][j]==s)dp[0][i][j]=1.0;\n\tfor(int i=0;i<n;i++){\n\t\tfor(int f=0;f<3;f++){\n\t\t\tfor(int g=0;g<3;g++){\n\t\t\t\tfor(int j=0;j<4;j++){\n\t\t\t\t\tbool move=false;\n\t\t\t\t\tif(f+dy[j]>=0&&f+dy[j]<3&&g+dx[j]>=0&&g+dx[j]<3){if(map[f+dy[j]][g+dx[j]]!=d)move=true;}\n\t\t\t\t\tif(move)dp[i+1][f+dy[j]][g+dx[j]]+=dp[i][f][g]/4.0;\n\t\t\t\t\telse dp[i+1][f][g]+=dp[i][f][g]/4.0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=0;i<3;i++)for(int j=0;j<3;j++)if(map[i][j]==t)cout<<fixed<<setprecision(10)<<dp[n][i][j]<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\ndouble dp[15][3][3]={};\nint dx[4]={1,-1,0,0};\nint dy[4]={0,0,1,-1};\nint bx,by;\nint tx,ty;\n\ndouble rec(int rest,int x,int y){\n     //cout<<\"x:\"<<x<<\"y:\"<<y<<endl;\n     if(x<0||x>2||y<0||y>2)return 0;\n     if(dp[rest][x][y]>0)return dp[rest][x][y];\n\n     if(rest==0){\n\t  if(x==tx&&y==ty)return 1;\n\t  else return 0;\n     }\n     double sum=0;\n     for(int i=0;i<4;i++){\n\t  if((x+dx[i]==bx)&&(y+dy[i]==by)||x+dx[i]<0||x+dx[i]>2||y+dy[i]>2||y+dy[i]<0){\n\t       sum+=rec(rest-1,x,y);\n\t       }else{\n\t       sum+=rec(rest-1,x+dx[i],y+dy[i]);\n\t  }\n     }\n     sum=sum/4.0;\n     dp[rest][x][y]=sum;\n     return sum;\n}\nvoid topoint(char a,int &x,int &y){\n     int tmp=a-'A';\n     x=tmp/3;\n     y=tmp%3;\n     return;\n}\nint main(){\n     int N;\n     cout.precision(8);\n     cout.setf(ios::fixed);\n     while(cin>>N,N){\n\t  char s,t,b;\n\t  cin>>s>>t>>b;\n\t  int sx,sy;\n\t  topoint(s,sx,sy);\n\t  topoint(t,tx,ty);\n\t  topoint(b,bx,by);\n\t  //cout<<sx<<\":\"<<sy<<\" \"<<tx<<\":\"<<ty<<endl;\n\t  cout<<rec(N,sx,sy)<<endl;\n\t  for(int i=0;i<15;i++){\n\t       for(int j=0;j<3;j++){\n\t\t    for(int k=0;k<3;k++){\n\t\t\t dp[i][j][k]=0;\n\t\t    }\n\t       }\n\t  }\n\t\t   \n     }\n     return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vectoer>\n#include<string>\n#include<map>\n#include<cstdio>\n\n#define f first\n#define s second\n\nusing namespace std;\n\ntypedef pair<int,int> P;\n\nint dx[4]={0,0,1,-1};\nint dy[4]={1,-1,0,0};\n\nint main(void){\n\nint n,id=0;\nstring s=\"ABCDEFGHI\";\nchar s,t,d;\nmap<char,P>mp;\n\nfor(int i=0;i<3;i++){\nfor(int j=0;j<3;j++){\nmp[s[id++]]=P(i,j);\n}\n}\n\nwhile(cin >> n,n){\ncin >> s >> t >> d;\nP S=mp[s],T=mp[t],D=mp[d];\n\nint dp[16][3][3];\n\nfor(int k=0;k<16;k++)\nfor(int i=0;i<3;i++)\nfor(int j=0;j<3;j++)dp[k][i][j]=0;\n\ndp[0][S.s][S.f]=1;\n\nfor(int k=0;k<n;k++){\nfor(int i=0;i<3;i++){\nfor(int j=0;j<3;j++){\nfor(int l=0;l<4;l++){\nint nx=j+dx[l],ny=i+dy[l];\nif(nx<0 || ny<0 || 2<nx || 2<ny || \n(nx==D.s&&ny==D.f))nx=j,ny=i;\ndp[k+1][ny][nx]+=dp[k][i][j]/4;\n}\n}\n}\n}\nprintf(\"%.8f\\n\",dp[n][T.s][T.f]);\n}\n\nreturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<cassert>\n#include<iostream>\n#include<sstream>\n#include<string>\n#include<vector>\n#include<queue>\n#include<set>\n#include<map>\n#include<utility>\n#include<numeric>\n#include<algorithm>\n#include<bitset>\n#include<complex>\n\nusing namespace std;\n\ntypedef long long Int;\ntypedef vector<int> vint;\ntypedef pair<int,int> pint;\n#define mp make_pair\n\ntemplate<class T> void pv(T a, T b) { for (T i = a; i != b; ++i) cout << *i << \" \"; cout << endl; }\ntemplate<class T> void chmin(T &t, T f) { if (t > f) t = f; }\ntemplate<class T> void chmax(T &t, T f) { if (t < f) t = f; }\nint in() { int x; scanf(\"%d\", &x); return x; }\n\ndouble dp[20][10];\nint n,s,t,b;\n\nint move(int pos,int x,int y){\n\tif(pos<3&&y==-1)return pos;\n\tif(pos>6&&y==1)return pos;\n\tif(pos%3==0&&x==-1)return pos;\n\tif(pos%3==2&&x==1)return pos;\n\tpos+=x+3*y;\n\treturn pos;\n}\n\nint main() {\n\tstring ss,tt,bb;\n\twhile(n=in()){\n\t\tcin>>ss>>tt>>bb;\n\t\ts=ss[0]-'A';\n\t\tt=tt[0]-'A';\n\t\tb=bb[0]-'A';\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdp[0][s]=1;\n\t\tint i,j;\n\t\tfor(i=1;i<=n;i++){\n\t\t\tfor(j=0;j<9;j++){\n\t\t\t\tdp[i][move(j,1,0)]+=dp[i-1][j]/4;\n\t\t\t\tdp[i][move(j,-1,0)]+=dp[i-1][j]/4;\n\t\t\t\tdp[i][move(j,0,1)]+=dp[i-1][j]/4;\n\t\t\t\tdp[i][move(j,0,-1)]+=dp[i-1][j]/4;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.12f\\n\",dp[n][t]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\nusing namespace std;\n\n#define pii pair<int,int>\n\n\nint dx[] = {0,1,0,-1};\nint dy[] = {-1,0,1,0};\nint tx, ty, bx, by;\ndouble ans;\n\nvoid rec(int nx, int ny, int v, double p) {\n  // printf(\"(%d, %d), %d, %f\\n\", nx,ny,v,p);\n  if (v==0) {\n    if (nx==tx && ny==ty) {\n      ans += p;\n    }\n    return;\n  }\n  for(int i=0; i<4; i++) {\n    int xx = nx+dx[i];\n    int yy = ny+dy[i];\n    if (xx<0||3<xx || yy<0||3<yy || (xx==bx&&yy==by)) {\n        xx = nx;\n        yy = ny;\n    }\n    rec(xx, yy, v-1, p*0.25);\n  }\n}\n\nint main() {\n  int n;\n  int dx[]={0,1,0,-1};\n  int dy[]={-1,0,1,0};\n  \n  while(cin >> n, n) {\n    char cs, ct, cb;\n    cin >> cs >> ct >> cb;\n    int s=cs-'A', t=ct-'A', b=cb-'A';\n    tx = t%3;\n    ty = t/3;\n    bx = b%3;\n    by = b/3;\n\n    // printf(\"%d,%d  %d,%d\\n\", tx,ty,bx,by);\n\n    ans = 0;\n    rec(s%3, s/3, n, 1);\n\n    printf(\"%.8f\\n\",ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <map>\n#include <cstring>\n#include <cstdio>\nusing namespace std;\n\ntypedef pair<int,int> P;\n\nint n;\n\nP alp2loc(char c) {\n  int i, j;\n  switch (c) {\n    case 'A': {\n      i = 0, j = 0; break;\n    }\n    case 'B': {\n      i = 0, j = 1; break;\n    }\n    case 'C': {\n      i = 0, j = 2; break;\n    }\n    case 'D': {\n      i = 1, j = 0; break;\n    }\n    case 'E': {\n      i = 1, j = 1; break;\n    }\n    case 'F': {\n      i = 1, j = 2; break;\n    }\n    case 'G': {\n      i = 2, j = 0; break;\n    }\n    case 'H': {\n      i = 2, j = 1; break;\n    }\n    case 'I': {\n      i = 2, j = 2; break;\n    }\n  }\n  return P(i,j);\n}\n\nconst int di[4] = {-1, 0, 1, 0};\nconst int dj[4] = {0, 1, 0, -1};\n\nvoid solve() {\n  char s, t, b;\n  cin>>s>>t>>b;\n  \n  P sp = alp2loc(s), st = alp2loc(t), sb = alp2loc(b);\n  \n  double org[3][3];\n  memset(org, 0, sizeof org);\n  \n  org[sp.first][sp.second] = 1.0;\n  for (int turn = 0; turn < n; turn++) {\n    double now[3][3];\n    memset(now, 0, sizeof now);\n    \n    for (int i = 0; i < 3; i++) {\n      for (int j = 0; j < 3; j++) {\n        //\n        double add = org[i][j] / 4.0;\n        for (int k = 0; k < 4; k++) {\n          int ti = i + di[k], tj = j + dj[k];\n          if (0 <= ti && ti < 3 && 0 <= tj && tj < 3 &&\n              !(sb.first == ti && sb.second == tj)) {\n            now[ti][tj] += add;\n          } else {\n            now[i][j] += add;\n          }\n        }\n      }\n    }\n    \n    for(int i=0;i<3;i++)\n    for(int j=0;j<3;j++)\n    org[i][j] = now[i][j];\n  }\n  \n  //cout<<org[st.first][st.second]<<endl;\n  printf(\"%.8f\\n\", org[st.first][st.second]);\n}\n\nint main(int argc, char const* argv[]) {\n  while (cin>>n, n) {\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#include \"stdio.h\"\n\nusing namespace std;\n\nint dx[] = {-1,0,1,0};\nint dy[] = {0,-1,0,1};\n\nint main(){\n\tint n;\n\tdouble prob[2][3][3];\n\tbool junk[3][3];\n\twhile(cin >> n, n){\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tdouble ans = 0.0;\n\t\tfor(int i=0;i<2;i++)\n\t\t\tfor(int j=0;j<3;j++)\n\t\t\t\tfor(int k=0;k<3;k++) prob[i][j][k] = 0.0;\n\t\tprob[0][(s-'A')/3][(s-'A')%3] = 1.0;\n\t\tint gx = (t-'A')/3, gy = (t-'A')%3;\n\t\tmemset(junk, false, sizeof(junk));\n\t\tjunk[(b-'A')/3][(b-'A')%3] = true;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int x=0;x<3;x++)\n\t\t\t\tfor(int y=0;y<3;y++) prob[1-(i%2)][x][y] = 0.0;\n\t\t\tfor(int x=0;x<3;x++){\n\t\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\t\tfor(int d=0;d<n;d++){\n\t\t\t\t\t\tint nx = x+dx[d], ny = y+dy[d];\n\t\t\t\t\t\tif(nx<0||3<=nx||ny<0||3<=ny||junk[nx][ny]) {\n\t\t\t\t\t\t\tnx = x, ny = y;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tprob[1-(i%2)][nx][ny] += prob[i%2][x][y]*0.25;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tans += prob[1-(i%2)][gx][gy];\n\t\t\tprob[1-(i%2)][gx][gy] = 0.0;\n\t\t}\n\t\tprintf(\"%.8lf\\n\", ans);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\ndouble dp[16][3][3];\nchar s[2];\nchar t[2];\nchar b[2];\nint main(){\n\tint a;\n\twhile(scanf(\"%d\",&a),a){\n\t\tfor(int i=0;i<16;i++)\n\t\t\tfor(int j=0;j<3;j++)\n\t\t\t\tfor(int k=0;k<3;k++)\n\t\t\t\t\tdp[i][j][k]=0;\n\t\tscanf(\"%s%s%s\",s,t,b);\n\t\tint row=(s[0]-'A')/3;\n\t\tint col=(s[0]-'A')%3;\n\t\tint NGrow=(b[0]-'A')/3;\n\t\tint NGcol=(b[0]-'A')%3;\n\t\tdp[0][row][col]=1;\n\t\tfor(int i=0;i<a;i++){\n\t\t\tfor(int j=0;j<3;j++)\n\t\t\t\tfor(int k=0;k<3;k++){\n\t\t\t\t\tif(j>0&&(j-1!=NGrow||k!=NGcol))dp[i+1][j-1][k]+=dp[i][j][k]*0.25;\n\t\t\t\t\telse dp[i+1][j][k]+=dp[i][j][k]*0.25;\n\t\t\t\t\tif(k>0&&(j!=NGrow||k-1!=NGcol))dp[i+1][j][k-1]+=dp[i][j][k]*0.25;\n\t\t\t\t\telse dp[i+1][j][k]+=dp[i][j][k]*0.25;\n\t\t\t\t\tif(j<2&&(j+1!=NGrow||k!=NGcol))dp[i+1][j+1][k]+=dp[i][j][k]*0.25;\n\t\t\t\t\telse dp[i+1][j][k]+=dp[i][j][k]*0.25;\n\t\t\t\t\tif(k<2&&(j!=NGrow||k+1!=NGcol))dp[i+1][j][k+1]+=dp[i][j][k]*0.25;\n\t\t\t\t\telse dp[i+1][j][k]+=dp[i][j][k]*0.25;\n\t\t\t\t}\n\t\t}\n\t\tint Grow=(t[0]-'A')/3;\n\t\tint Gcol=(t[0]-'A')%3;\n\t\tprintf(\"%.8lf\\n\",dp[a][Grow][Gcol]);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 100000000\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P> PP;\n\nstatic const double EPS = 1e-8;\n\nconst int tx[] = {0,1,0,-1};\nconst int ty[] = {-1,0,1,0};\n\nchar stage[3][3];\n\nint gAll=0,gOk=0;\n\nint gCount[3][3][16];\n\nvoid dfs(int sx,int sy,int gx,int gy,int cost){\n\n\tif(cost==0){\n\t\tif(sx==gx && sy==gy){\n\t\t\tgOk++;\n\t\t}\n\t\treturn;\n\t}\n\n\tfor(int i=0;i<4;i++){\n\t\tint dx = sx + tx[i];\n\t\tint dy = sy + ty[i]; \n\t\tif(dx < 0 || dx >= 3 || dy < 0 || dy >= 3){\n\t\t\tgCount[sy][sx][cost-1]++;\n\t\t\tif(gCount[sy][sx][cost-1]<=1) dfs(sx,sy,gx,gy,cost-1);\n\t\t}\n\n\t\telse if(stage[dy][dx] != 'B'){\n\t\t\tgCount[dy][dx][cost-1]++;\n\t\t\tif(gCount[dy][dx][cost-1]<=1) dfs(dx,dy,gx,gy,cost-1);\n\t\t}\n\t\telse if(stage[dy][dx] == 'B'){\n\t\t\tgCount[sy][sx][cost-1]++;\n\t\t\tif(gCount[sy][sx][cost-1]<=1) dfs(sx,sy,gx,gy,cost-1);\n\t\t}\n\t}\n}\n\nint main(){\n\tint n;\n\twhile(~scanf(\"%d\",&n)){\n\t\tif(n==0) break;\n\n\t\tchar s,t,b;\n\t\tmemset(stage,'.',sizeof(stage));\n\t\tmemset(gCount,0,sizeof(gCount));\n\t\tcin >> s >> t >> b;\n\t\tint sx = (s-'A')%3;\n\t\tint sy = (s-'A')/3;\n\t\tint gx = (t-'A')%3;\n\t\tint gy = (t-'A')/3;\n\t\tstage[(b-'A')/3][(b-'A')%3] = 'B';\n\n\t\tgOk=0;\n\t\tgAll=0;\n\t\tdfs(sx,sy,gx,gy,n);\n\n\t\tfor(int x=0;x<3;x++){\n\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\tgAll+=gCount[y][x][0];\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\",(double)gOk/(double)gAll);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint main(){\n    double dp[3][3][16];//[x][y][n]\n    char s,t,b;\n    int n;\n    int dx[]={-1,0,1,0};\n    int dy[]={0,1,0,-1};\n    cout.precision(8);\n    cout << fixed;\n    while(cin>>n,n){\n        fill(dp[0][0],dp[3][0],0);\n        cin>>s>>t>>b;\n        s-='A';\n        t-='A';\n        b-='A';\n        dp[s%3][s/3][n]=1;\n        for(;n>0;n--){\n            for(int x=0;x<3;x++){\n                for(int y=0;y<3;y++){\n                    for(int i=0;i<4;i++){\n                        if((0<=x+dx[i]&&x+dx[i]<3)&&(0<=y+dy[i]&&y+dy[i]<3)&&!((x+dx[i])==(b%3)&&(y+dy[i])==(b/3))){\n                            dp[x+dx[i]][y+dy[i]][n-1]+=dp[x][y][n]/4;\n                        }else{\n                            dp[x][y][n-1]+=dp[x][y][n]/4;\n                        }\n                    }\n                }\n            }\n        }\n        cout << dp[t%3][t/3][0] << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <queue>\n\nusing namespace std;\n\ntypedef long double ld;\n\nconst int EMPTY   = 0;\nconst int BATTERY = 1;\nconst int STORE   = 2;\nconst int WALL    = 3;\n\nstruct Point {\npublic:\n  int x, y;\n  Point() { }\n  Point(int x, int y): x(x), y(y) { }\n};\n\nstruct State {\npublic:\n  Point p;\n  int battery;\n  State() { };\n  State(Point p, int battery): p(p), battery(battery) { }\n};\n\nPoint int2point(int n) {\n  return Point(1 + n % 3, 1 + n / 3);\n}\n\nint field[5][5];\n\ndouble dp[16][5][5];\nint main() {\n  int n, s, t, b;\n  while (true) {\n    cin >> n;\n    if (n == 0) break;\n    char cs, ct, cb;\n    cin >> cs >> ct >> cb;\n    s = cs - 'A';\n    t = ct - 'A';\n    b = cb - 'A';\n    \n    memset(field, EMPTY, sizeof(field));\n    memset(dp, 0, sizeof(dp));\n    for (int i = 0; i < 5; i++) {\n      field[0][i] = WALL;\n      field[4][i] = WALL;\n      field[i][0] = WALL;\n      field[4][i] = WALL;\n    }\n    Point batteryPoint = int2point(t);\n    field[batteryPoint.x][batteryPoint.y] = BATTERY;\n    Point storePoint = int2point(b);\n    field[storePoint.x][storePoint.y] = STORE;\n    State nowState(int2point(s), n);\n\n    dp[0][nowState.p.x][nowState.p.y] = 1.0f;\n    int dx[] ={1,0,-1,0},dy[] ={0,1,0,-1};\n    for(int i = 0; i < nowState.battery; i++){\n      for(int j = 1; j <= 3; j++){\n        for(int k = 1; k <= 3; k++){\n          for(int l = 0;l < 4; l++){\n            int nx = j + dx[l], ny = k + dy[l];\n            if(field[nx][ny] == STORE || field[nx][ny] == WALL) {\n              nx = j, ny = k;\n            }\n            dp[i+1][nx][ny] += dp[i][j][k] / 4.0;\n          }\n        }\n      }\n    }\n    printf(\"%.20f\\n\", dp[nowState.battery][batteryPoint.x][batteryPoint.y]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n\n#define rep(i,n) for(int (i)=0;(i)<n;(i)++)\n#define ck(a) (0<=(a)&&(a)<=9)\n\nint di[]={-3, -1, 1, 3};\n\nint main() {\n  using namespace std;\n  \n  int n, s, t, b; char cs, ct, cb;\n  while(cin>>n,n) {\n    cin >> cs >> ct >> cb;\n    s = cs-'A'; t = ct-'A'; b = cb-'A';\n    double p[9]={0}; p[s]=1;\n\n    while(n--) {\n      double q[9]={0};\n      rep(i,9)rep(d,4) {\n\tif(ck(i+di[d])&&!(i%3==0&&di[d]==-1)&&!(i%3==2&&di[d]==1)&&i+di[d]!=b)\n\t  q[i+di[d]]+=p[i]/4;\n\telse q[i]+=p[i]/4;\n      }\n      rep(i,9)p[i]=q[i];\n    }\n    printf(\"%.8f\\n\", p[t]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\ntypedef vector <int> VI;\ntypedef vector <VI> VVI;\n\nconst int dx[4] = { 0, 0, 1, -1 };\nconst int dy[4] = { 1, -1, 0, 0 };\n\nint get_x( char c )\n{\n\tif ( c == 'A' || c == 'D' || c == 'G' ) return 0;\n\tif ( c == 'B' || c == 'E' || c == 'H' ) return 1;\n\tif ( c == 'C' || c == 'F' || c == 'I' ) return 2;\n\treturn -1;\n}\n\nint get_y( char c )\n{\n\tif ( c == 'A' || c == 'B' || c == 'C' ) return 0;\n\tif ( c == 'D' || c == 'E' || c == 'F' ) return 1;\n\tif ( c == 'G' || c == 'H' || c == 'I' ) return 2;\n\treturn -1;\n}\n\n\nint main( void )\n{\n\tint n; char s, t, b;\n\twhile ( 1 )\n\t{\n\t\tcin >> n;\n\t\tif ( n == 0 ) break;\n\t\tcin >> s >> t >> b;\n\n\t\tint sx, sy, gx, gy, ox, oy;\n\t\tsx = get_x( s ); sy = get_y( s );\n\t\tgx = get_x( t ); gy = get_y( t );\n\t\tox = get_x( b ); oy = get_y( b );\n\n\t\tVVI prev( 3, VI(3,0) ), next;\n\t\tprev[sy][sx] = 1;\n\t\tfor ( int lpc = 0; lpc < n; lpc++ )\n\t\t{\n\t\t\tnext = VVI( 3, VI( 3, 0 ) );\n\t\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ )\n\t\t\t{\n\t\t\t\tif ( i == oy && j == ox ) continue;\n\t\t\t\tint stop = 0;\n\t\t\t\tfor ( int k = 0; k < 4; k++ )\n\t\t\t\t{\n\t\t\t\t\tint nx = j + dx[k];\n\t\t\t\t\tint ny = i + dy[k];\n\t\t\t\t\tif ( nx < 0 || nx >= 3 || ny < 0 || ny >= 3 )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( nx == ox && ny == oy )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop++;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnext[i][j] += prev[ny][nx];\n\t\t\t\t}\n\t\t\t\tif ( stop ) next[i][j] += prev[i][j] * stop;\n\t\t\t}\n\t\t\tprev = next;\n\t\t}\n\n\t\tint sum = 0;\n\t\t// for ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ ) sum += next[i][j];\n\t\tsum = 1; for ( int i = 0; i < n; i++ ) sum *= 4;\n\n\t\tdouble answer = (double)next[gy][gx] / (double)sum;\n\n\t\tcout.precision( 8 );\n\t\tcout.setf( ios::fixed );\n\t\tcout << answer << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<map>\n#include<cstdio>\n\n#define X first\n#define Y second\n\nusing namespace std;\n\ntypedef pair<int,int> P;\n\nint dx[4]={0,0,1,-1};\nint dy[4]={1,-1,0,0};\nstring idx=\"ABCDEFGHI\";\n\nint main(void){\n\t\n\tmap<char,P> mp;\n\tint cnt=0,b;\n\t\n\tfor(int i=0;i<3;i++)\n\t\tfor(int j=0;j<3;j++)\n\t\t\tmp[idx[cnt++]]=P(i,j);\n\t\n\tP s,t,d;\n\tchar S,T,D;\n\twhile(cin >> b >> S >> T >> D){\n\t\t\n\t\ts.X=mp[S].X,s.Y=mp[S].Y;\n\t\tt.X=mp[T].X,t.Y=mp[T].Y;\n\t\td.X=mp[D].X,d.Y=mp[D].Y;\n\t\t\n\t\tdouble dp[16][3][3];\n\t\t\n\t\tfor(int i=0;i<16;i++)\n\t\t\tfor(int j=0;j<3;j++)\n\t\t\t\tfor(int k=0;k<3;k++)dp[i][j][k]=0;\n\t\t\n\t\tdp[0][s.Y][s.X]=1;\n\t\t\n\t\tfor(int k=0;k<b;k++){\n\t\t\tfor(int x=0;x<3;x++){\n\t\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\t\tfor(int i=0;i<4;i++){\n\t\t\t\t\t\tint nx=x+dx[i],ny=y+dy[i];\n\t\t\t\t\t\tif(nx<0 || ny<0 || 2<nx || 2<ny || (nx==d.X && ny==d.Y))nx=x,ny=y;\n\t\t\t\t\t\tdp[k+1][ny][nx]+=dp[k][y][x]/4;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8f\\n\",dp[b][t.Y][t.X]);\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tint n;\n\tchar s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A'] = i%3+1;\n\t\tfy[i+'A'] = i/3+1;\n\t}\n\t\n\t//while( scanf(\"%d\", &n) , n ){\n\twhile( cin >> n , n ){\n\t\t//scanf(\" %c %c %c \", &s, &t, &b);\n\t\tcin >> s >> t >> b;\n\t\tchar m[5][5] = {0};\n\t\tfor(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;\n\t\t\n\t\tsolve( n , m );\n\t\t\n\t\t//debug( m );\n\t\tprintf(\"%.9f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <cassert>\nusing namespace std;\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n) FOR(i,0,n)\n#define EACH(t,i,c) for(t::iterator i=(c).begin(); i!=(c).end(); ++i)\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\n\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\nint dx[]={-1,0,1,0},dy[]={0,-1,0,1};\nchar roomChar[3][3]={{'A','B','C'},{'D','E','F'},{'G','H','I'}};\nchar getRoomChar(int x,int y){\n\treturn roomChar[y][x];\n}\npii getRoomLoc(char c){\n\tREP(x,3){\n\t\tREP(y,3){\n\t\t\tif(roomChar[y][x]==c){\n\t\t\t\treturn make_pair(x,y);\n\t\t\t}\n\t\t}\n\t}\n}\nint main(){\n\tint n;\n\twhile(cin>>n,n){\n\t\tchar s,t,b;\n\t\tcin>>s>>t>>b;\n\t\tvector<vvd> p(n+1,vvd(3,vd(3)));\n\t\tpii sl=getRoomLoc(s);\n\t\tp[0][sl.first][sl.second]=1;\n\t\tREP(i,n){\n\t\t\tREP(x,3){\n\t\t\t\tREP(y,3){\n\t\t\t\t\tREP(d,4){\n\t\t\t\t\t\tint xx=x+dx[d];\n\t\t\t\t\t\tint yy=y+dy[d];\n\t\t\t\t\t\tif(xx>=0&&yy>=0&&xx<3&&yy<3&&getRoomChar(xx,yy)!=b){\n\t\t\t\t\t\t\t\tp[i+1][xx][yy]+=p[i][x][y]/4;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tp[i+1][x][y]+=p[i][x][y]/4;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tpii tl=getRoomLoc(t);\n\t\tprintf(\"%.10f\\n\",p[n][tl.first][tl.second]);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define F first\n#define S second\n#define INF 1 << 30\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\ndouble dp[16][3][3];\nint n, dx[] = {0,-1,0,1}, dy[] = {-1,0,1,0};\nchar cs, ct, cb;\nint s, t, b;\n\nint main(){\n  while(scanf(\"%d\", &n) && n){\n    memset(dp, 0.0, sizeof(dp));\n    scanf(\"\\n%c %c %c\", &cs, &ct, &cb);\n    s = cs - 'A';\n    t = ct - 'A';\n    b = cb - 'A';\n    //    fprintf(stderr, \"%c\\n\", cs);\n    dp[0][s/3][s%3] = 1.0;\n\n    rep(i, n) rep(y, 3) rep(x, 3){\n      if(dp[i][y][x] == 0) continue;\n      rep(d, 4){\n\tint ny = y + dy[d], nx = x + dx[d];\n\tif(ny < 0 || nx < 0 || ny >= 3 || nx >= 3 || ny*3+nx == b) dp[i+1][y][x] += dp[i][y][x]*0.25;\n\telse dp[i+1][ny][nx] += dp[i][y][x]*0.25;\n      }\n    }\n\n    printf(\"%.8lf\\n\", dp[n][t/3][t%3]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <fstream>\n\nusing namespace std;\n\nint n;\nchar s,t,b;\n\ndouble calc(){\n\n\tchar floar[3][3];\n\tfloar[0][0] = 'A';\n\tfloar[0][1] = 'B';\n\tfloar[0][2] = 'C';\n\tfloar[1][0] = 'D';\n\tfloar[1][1] = 'E';\n\tfloar[1][2] = 'F';\n\tfloar[2][0] = 'G';\n\tfloar[2][1] = 'H';\n\tfloar[2][2] = 'I';\n\n\tpair<int,int> startPlace;\n\tpair<int,int> finPlace;\n\tpair<int,int> wareHouse;\n\n\tfor(int i = 0; i < 3; i++){\n\t\tfor(int j = 0; j < 3; j++){\n\t\t\tif(floar[i][j] == s){\n\t\t\t\tstartPlace.first = i;\n\t\t\t\tstartPlace.second = j;\n\t\t\t}\n\t\t\telse if(floar[i][j] == t){\n\t\t\t\tfinPlace.first = i;\n\t\t\t\tfinPlace.second = j;\n\t\t\t}\n\t\t\telse if(floar[i][j] == b){\n\t\t\t\twareHouse.first = i;\n\t\t\t\twareHouse.second = j;\n\t\t\t}\n\t\t}\n\t}\n\n\tvector<pair<int,int>> placeList;\n\tvector<pair<int,int>> nextPlaceList;\n\n\tplaceList.push_back(startPlace);\n\tint leaveBattery = n;\n\tpair<int,int> newPlace;\n\n\tint trueCount = 0;\n\tint falseCount = 0;\n\twhile(placeList.size()){\n\t\t// àµobe[ª0ÆÈÁ½ç\n\t\tif(leaveBattery == 0){\n\t\t\t// »ÝÊuªobeÌêÌ¨ð¦é\n\t\t\tfor(int i = 0; i < placeList.size(); i++){\n\t\t\t\tif(placeList[i].first == finPlace.first && placeList[i].second == finPlace.second){\n\t\t\t\t\ttrueCount++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}else if(leaveBattery == 1){\n\t\t\tfalseCount = placeList.size() * 4;\n\t\t}\n\t\tfor(int i = 0; i < placeList.size(); i++){\n\t\t\t// ãAºA¶AEÉÍÝoµÄ¢È¢êA©ÂqÉÅÈ¢ê»ÌûüÉÚ®\n\t\t\tif(placeList[i].first - 1 >= 0){\n\t\t\t\tif(wareHouse.first != placeList[i].first - 1 || wareHouse.second != placeList[i].second){\n\t\t\t\t\tnewPlace.first = placeList[i].first - 1;\n\t\t\t\t\tnewPlace.second = placeList[i].second;\n\t\t\t\t\tnextPlaceList.push_back(newPlace);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnextPlaceList.push_back(placeList[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(placeList[i].first + 1 < 3){\n\t\t\t\tif(wareHouse.first != placeList[i].first + 1 || wareHouse.second != placeList[i].second){\n\t\t\t\t\tnewPlace.first = placeList[i].first + 1;\n\t\t\t\t\tnewPlace.second = placeList[i].second;\n\t\t\t\t\tnextPlaceList.push_back(newPlace);\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnextPlaceList.push_back(placeList[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(placeList[i].second - 1 >= 0){\n\t\t\t\tif(wareHouse.first != placeList[i].first || wareHouse.second != placeList[i].second - 1){\n\t\t\t\t\tnewPlace.first = placeList[i].first;\n\t\t\t\t\tnewPlace.second = placeList[i].second - 1;\n\t\t\t\t\tnextPlaceList.push_back(newPlace);\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnextPlaceList.push_back(placeList[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(placeList[i].second + 1 < 3){\n\t\t\t\tif(wareHouse.first != placeList[i].first || wareHouse.second != placeList[i].second + 1){\n\t\t\t\t\tnewPlace.first = placeList[i].first;\n\t\t\t\t\tnewPlace.second = placeList[i].second + 1;\n\t\t\t\t\tnextPlaceList.push_back(newPlace);\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnextPlaceList.push_back(placeList[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tleaveBattery--;\n\t\tplaceList = nextPlaceList;\n\t\tnextPlaceList.clear();\n\t}\n\treturn (double)trueCount/falseCount;\n}\n\nvoid solve(){\n\t//ifstream ifs(\"prob1020.txt\");\n\twhile(1){\n\t\t//ifs >> n;\n\t\tcin >> n;\n\n\t\tif(n == 0)\n\t\t\tbreak;\n\t\tcin >> s;\n\t\tcin >> t;\n\t\tcin >> b;\n\t\t//ifs >> s;\n\t\t//ifs >> t;\n\t\t//ifs >> b;\n\t\tcout << calc() << endl;\n\t}\n}\n\nint main(){\nsolve();\nreturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n \nusing namespace std;\n \n#define rep(i,n) for(int i=0; i<(n); i++)\n#define repc(i,s,e) for(int i=(s); i<(e); i++)\n#define pb(n) push_back((n))\n#define mp(n,m) make_pair((n),(m))\n#define all(r) r.begin(),r.end()\n#define fi first\n#define se second\n \ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vii;\ntypedef vector<ll> vl;\ntypedef vector<vl> vll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\ntypedef pair<int, pii> pip;\n \n \n \nconst int INF = 1000000;\nconst double EPS = 1e-8;\nconst int mod = 1e9 + 7;\n \n\nint dx[] = {-1, 0, 1, 0};\nint dy[] = {0, -1, 0, 1};\n\n\npii f(char c){\n\tpii ret;\n\tint a = c - 'A';\n\tret.fi = a / 3;\n\tret.se = a % 3;\n\treturn ret;\n}\n\n\nint main(){\n\tint n, bunshi, bunbo;\n\tchar a, b, c;\n\tpii s, t, m;\n\tpip p;\n\twhile(cin>>n && n > 0){\n\t\tcin>>a>>b>>c;\n\t\ts = f(a); t = f(b); m = f(c);\n\t\tbunshi = 0; bunbo = 0;\n\t\tqueue<pip> q;\n\t\tq.push(pip(n, s));\n\t\twhile(!q.empty()){\n\t\t\tp = q.front();\n\t\t\tq.pop();\n\t\t\tif(p.fi == 0) {\n\t\t\t\tbunbo++;\n\t\t\t\tif(p.se == t) bunshi++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfor(int i = 0; i < 4; i++){\n\t\t\t\tpii next(p.se.fi + dx[i], p.se.se + dy[i]);\n\t\t\t\tif(next.fi < 0 || next.fi > 2 || next.se < 0 || next.se > 2 || next == m) q.push(pip(p.fi - 1, p.se));\n\t\t\t\telse q.push(pip(p.fi - 1, next));\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.15lf\\n\", (double)bunshi/bunbo);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define FOR(i,a,b) for(int i= (a); i<((int)b); ++i)\n#define RFOR(i,a) for(int i=(a); i >= 0; --i)\n#define FOE(i,a) for(auto i : a)\n#define ALL(c) (c).begin(), (c).end()\n#define RALL(c) (c).rbegin(), (c).rend()\n#define DUMP(x)  cerr << #x << \" = \" << (x) << endl;\n#define SUM(x) std::accumulate(ALL(x), 0LL)\n#define MIN(v) *std::min_element(v.begin(), v.end())\n#define MAX(v) *std::max_element(v.begin(), v.end())\n#define EXIST(v,x) (std::find(v.begin(), v.end(), x) != v.end())\n#define BIT(n) (1LL<<(n))\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end());\n\ntypedef long long LL;\ntemplate<typename T> using V = std::vector<T>;\ntemplate<typename T> using VV = std::vector<std::vector<T>>;\ntemplate<typename T> using VVV = std::vector<std::vector<std::vector<T>>>;\n\ntemplate<class T> inline T ceil(T a, T b) { return (a + b - 1) / b; }\ntemplate<class T> inline void print(T x) { std::cout << x << std::endl; }\ntemplate<class T> inline void print_vec(const std::vector<T> &v) { for (int i = 0; i < v.size(); ++i) {  if (i != 0) {std::cout << \" \";} std::cout << v[i];} std::cout << \"\\n\"; }\ntemplate<class T> inline bool inside(T y, T x, T H, T W) {return 0 <= y and y < H and 0 <= x and x < W; }\ntemplate<class T> inline double euclidean_distance(T y1, T x1, T y2, T x2) { return sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2)); }\ntemplate<class T> inline double manhattan_distance(T y1, T x1, T y2, T x2) { return abs(x1 - x2) + abs(y1 - y2); }\n\nconst int INF = 1L << 30;\nconst double EPS = 1e-9;\nconst std::string YES = \"YES\", Yes = \"Yes\", NO = \"NO\", No = \"No\";\nconst std::vector<int> dy4 = { 0, 1, 0, -1 }, dx4 = { 1, 0, -1, 0 };    // 4近傍（右, 下, 左, 上）\nconst std::vector<int> dy8 = { 0, -1, 0, 1, 1, -1, -1, 1 }, dx8 = { 1, 0, -1, 0, 1, 1, -1, -1 };\n\nusing namespace std;\n\n\nint main() {\n    cin.tie(0);\n\tios::sync_with_stdio(false);\n\n\twhile (true) {\n        int N;\n        char S, T, B;\n        cin >> N;\n        if (N == 0) {\n            break;\n        }\n        cin >> S >> T >> B;\n\n        map<char, pair<int, int>> d;\n        FOR(y, 0, 3) {\n            FOR(x, 0, 3) {\n                d['A' + 3 * y + x] = make_pair(y, x);\n            }\n        }\n        int sy = d[S].first, sx = d[S].second;\n        int ey = d[T].first, ex = d[T].second;\n        int by = d[B].first, bx = d[B].second;\n\n        vector<vector<vector<double>>> dp(N + 1, vector<vector<double>>(3, vector<double>(3)));\n        dp[N][sy][sx] = 1;\n\n        for (int n = N; n > 0; --n) {\n            FOR(y, 0, 3) {\n                FOR(x, 0, 3) {\n                    if (dp[n][y][x] == 0) {\n                        continue;\n                    }\n\n                    FOR(i, 0, 4) {\n                        int ny = dy4[i] + y;\n                        int nx = dx4[i] + x;\n\n                        if (inside(ny, nx, 3, 3) and not(ny == by and nx == bx)) {\n                            dp[n - 1][ny][nx] += dp[n][y][x] * 0.25;\n                        }\n                    }\n\n                }\n            }\n        }\n\n        cout << fixed << setprecision(7) << dp[0][ey][ex] << endl;\n    }\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <set>\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define REP(i,j) FOR(i,0,j)\n#define mp std::make_pair\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef std::pair<int,int> P;\ntypedef std::pair<int,P> State;\n\nconst int INF = 1001001001;\n\n// S N E W(南北東西)\nconst int dx[8] = {0, 0, 1, -1, 1, 1, -1, -1}, dy[8] = {1, -1, 0, 0, 1, -1, 1, -1};\n\ndouble dp[3][3][16];\nint n, s, t, b;\n\nint toIndex(char l){\n    return l - 'A';\n}\n\ndouble rec(int x, int y, int battery){\n    if(dp[y][x][battery] > -1e-6){return dp[y][x][battery];}\n    if(x == t % 3 && y == t / 3 && battery == n){return 1.0;}\n    if(battery >= n){return 0.0;}\n\n    double res = 0.0;\n    REP(i, 4){\n        int nx = x + dx[i], ny = y + dy[i];\n        if(0 <= nx && nx < 3 &&\n           0 <= ny && ny < 3 &&\n           !(nx == b % 3 && ny == b / 3)){\n            res += 0.25 * rec(nx, ny, battery+1);\n        }else{\n            res += 0.25 * rec(x, y, battery+1);\n        }\n    }\n\n    return dp[y][x][battery] = res;\n}\n\nint main(){\n    while(std::cin >> n, n){\n        std::fill(dp[0][0], dp[0][0]+3*3*16, -1.0);\n\n        char sl, tl, bl;\n        std::cin >> sl >> tl >> bl;\n\n        s = toIndex(sl), t = toIndex(tl), b = toIndex(bl);\n\n        printf(\"%.7f\\n\", rec(s%3, s/3, 0));\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<algorithm>\n#include<array>\n#include<bitset>\n#include<cassert>\n#include<cctype>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<functional>\n#include<limits>\n#include<list>\n#include<map>\n#include<numeric>\n#include<set>\n#include<stack>\n#include<string>\n#include<sstream>\n#include<unordered_map>\n#include<queue>\n#include<vector>\nusing namespace std;\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing pii = pair<int, int>;\n\n#define rep(i,a,b) for(int i=(a);i<(b);i++)\n#define rrep(i,a,b) for(int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n#define dump(o) {cerr<<#o<<\" \"<<o<<endl;}\n#define dumpc(o) {cerr<<#o; for(auto &e:(o))cerr<<\" \"<<e;cerr<<endl;}\n#define INF 0x3f3f3f3f\n#define INFL 0x3f3f3f3f3f3f3f3fLL\nconst int MOD = 1e9 + 7;\n\nint di[4] = { 1,0,-1,0 };\nint dj[4] = { 0,1,0,-1 };\n\nsigned main() {\n\tcout << fixed << setprecision(8);\n\tfor (int n; cin >> n&&n;) {\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tdouble f[3][3] = {};\n\t\tdouble g[3][3] = {};\n\t\tpii S, T, B;\n\t\tS = pii((s - 'A') / 3, (s - 'A') % 3);\n\t\tT = pii((t - 'A') / 3, (t - 'A') % 3);\n\t\tB = pii((b - 'A') / 3, (b - 'A') % 3);\n\t\tf[S.first][S.second] = 1;\n\t\twhile (n--) {\n\t\t\trep(i, 0, 3)rep(j, 0, 3)g[i][j] = 0;\n\t\t\tswap(f, g);\n\t\t\trep(a, 0, 3) rep(b, 0, 3) {\n\t\t\t\tint cnt = 0;\n\t\t\t\trep(i, 0, 4) {\n\t\t\t\t\tif (a + di[i] == B.first&&b + dj[i] == B.second) continue;\n\t\t\t\t\tif (0 > a + di[i] || a + di[i] > 2)continue;\n\t\t\t\t\tif (0 > b + dj[i] || b + dj[i] > 2)continue;\n\t\t\t\t\tf[a + di[i]][b + dj[i]] += g[a][b] / 4;\n\t\t\t\t\tcnt++;\n\t\t\t\t}\n\t\t\t\tf[a][b] += (g[a][b] / 4)*(4 - cnt);\n\t\t\t}\n\t\t}\n\t\tcout << f[T.first][T.second] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cctype>\n#include<vector>\n#include<map>\n#include<iomanip>\nusing namespace std;\n#define fr first\n#define sc second\ntypedef pair<int,int> Pt;\nint main(){\n  map<char,Pt> tmp;\n  for(int i = 0 ; i < 9 ; i++ ) tmp['A' + i] = Pt( i / 3 , i % 3 );\n\n  char s,t,b;\n  Pt st,gt,bt;\n  int n,d[]={0,1,0,-1};\n  while(cin >> n && n){\n    double dp[16][4][4] = {{{}}};\n    cin >> s >> t >> b;\n    st = tmp[s] , gt = tmp[t] , bt = tmp[b];\n    dp[0][st.fr][st.sc] = 1.0;\n    for(int i = 0 ; i < n ; i++ ){\n      for(int x = 0 ; x < 3 ; x++ ){\n        for(int y = 0 ; y < 3 ; y++ ){\n          for(int j = 0 ; j < 4 ; j++ ){\n            int px = x + d[j] , py = y + d[3-j];\n            if( px < 0 || px > 2 || py < 0 || py > 2 || bt == Pt(px,py)){\n              px = x , py = y;\n            }\n            dp[i+1][px][py] += dp[i][x][y] / 4.0;\n          }\n        }\n      }\n    }\n    cout << fixed << setprecision(8) << dp[n][gt.fr][gt.sc] << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<map>\n#include<vector>\n#include<deque>\n#include<cmath>\nusing namespace std;\n\n\nint main() {\n\n    int n;\n    while(cin >> n && n) {\n        vector<vector<int> > cases(n + 1, vector<int>(9)); \n\n        char s, t, b;\n        cin >> s >> t >> b;\n        int start, battery, junk;\n        start = (int)s - 'A';\n        battery = (int)t - 'A';\n        junk = (int)b - 'A';\n\n        for(int i = 0; i <= 8; i++) {\n            cases[0][i] = 0;\n        }\n        cases[0][battery] = 1;\n\n        for(int i = 1; i <= n; i++) {\n            for (int j = 0; j <= 8; j++) {\n                cases[i][j] = 0;\n                // up\n                if (j >= 3 && j - 3 != junk) {\n                    cases[i][j] += cases[i-1][j-3];\n                } else {\n                    cases[i][j] += cases[i-1][j];\n                }\n\n                // down\n                if (j <= 5 && j + 3 != junk) {\n                    cases[i][j] += cases[i-1][j+3];\n                } else {\n                    cases[i][j] += cases[i-1][j];\n                }\n\n                // right\n                if (j % 3 != 2 && j + 1 != junk) {\n                    cases[i][j] += cases[i-1][j+1];\n                } else {\n                    cases[i][j] += cases[i-1][j];\n                }\n\n                // left\n                if (j % 3 != 0 && j - 1 != junk) {\n                    cases[i][j] += cases[i-1][j-1];\n                } else {\n                    cases[i][j] += cases[i-1][j];\n                }\n            }\n\n        }\n\n        printf(\"%.8f\", (double)cases[n][start] / pow(4.0, n));\n        cout << endl;\n    }\n     \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\nusing namespace std;\n\n#define rep(i,n) for(int i=0; i<n; i++)\ndouble dp[16][9];\n\nint main(){\n\tint n;\n\tchar s, t, b;\n\twhile( scanf(\"%d\",&n), n ){\n\t\tscanf(\"%c %c %c %c\", &s, &s, &t, &b);\t// \\n, s, t, b\n\t\tmemset( dp, 0, sizeof(dp) );\n\t\tdp[0][s-'A'] = 1.0;\n\t\trep(i,n){\n\t\t\trep(j,9){\n\t\t\t\tif(j-3>=0 && b-'A'!=j-3)\tdp[i+1][j-3] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t\tif(j-1>=0 && b-'A'!=j-1)\tdp[i+1][j-1] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t\tif(j+1< 9 && b-'A'!=j+1)\tdp[i+1][j+1] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t\tif(j+3< 9 && b-'A'!=j+3)\tdp[i+1][j+3] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.7lf\\n\",dp[n][t-'A']);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <vector>\n#include <string>\n#include <map>\n#include <sstream>\n#include <queue>\n#include <cstdlib>\n#include <algorithm>\n#include <iterator>\n#include <stack>\n#include <list>\nusing namespace std;\n#define INF 100000000\ntypedef long long int lli;\ntypedef pair<int,int> P;\nlong double dp[16][9];\n\nvoid room(char c,int &x){\n\tswitch(c){\n\t\tcase 'A':\n\t\tx=0;\n\t\tbreak;\n\t\t\n\t\tcase 'B':\n\t\tx=1;\n\t\tbreak;\n\t\t\n\t\tcase 'C':\n\t\tx=2;\n\t\tbreak;\n\t\t\t\n\t\tcase 'D':\n\t\tx=3;\n\t\tbreak;\n\t\t\n\t\tcase 'E':\n\t\tx=4;\n\t\tbreak;\n\t\t\n\t\tcase 'F':\n\t\tx=5;\n\t\tbreak;\n\t\t\n\t\tcase 'G':\n\t\tx=6;\n\t\tbreak;\n\t\t\n\t\tcase 'H':\n\t\tx=7;\n\t\tbreak;\n\t\t\n\t\tcase 'I':\n\t\tx=8;\n\t\tbreak;\n\t\t\n\t\tdefault:\n\t\tbreak;\n\t}\n}\n\nint main(){\n\tint n;\n\twhile(cin>>n&&n){\n\t\tchar s,t,b;\n\t\tcin >> s >> t >> b;\n\t\tint sr,tr,br;\n\t\troom(s,sr);\n\t\troom(t,tr);\n\t\troom(b,br);\n\t\tfor(int i=0; i<=n; ++i){\n\t\t\tfor(int j=0; j<9; ++j){\n\t\t\t\tdp[i][j]=0;\n\t\t\t}\n\t\t}\n\t\tdp[0][sr]=1;\n\t\tfor(int i=1; i<=n; ++i){\n\t\t\tfor(int j=0; j<9; ++j){\n\t\t\t\t/*\n\t\t\t\tif(j!=br){\n\t\t\t\t\tswitch(j){\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][1]/2+dp[i-1][3]/2+dp[i-1][0])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][0]+dp[i-1][4]+dp[i-1][2]+dp[i-1][1])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][1]/2+dp[i-1][5]/2+dp[i-1][2])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][0]+dp[i-1][4]+dp[i-1][6]+dp[i-1][3])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][1]+dp[i-1][5]+dp[i-1][7]+dp[i-1][3])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t\t\tcase 5:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][2]+dp[i-1][4]+dp[i-1][8]+dp[i-1][5])/4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 6:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][3]/2+dp[i-1][7]/2+dp[i-1][6])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 7:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][6]+dp[i-1][4]/2+dp[i-1][8]/2+dp[i-1][7]/2)/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcase 8:\n\t\t\t\t\t\tdp[i][j]+=(dp[i-1][5]/2+dp[i-1][7]/2+dp[i-1][8])/2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\tif(j%3!=0){\n\t\t\t\t\tif(j-1!=br){\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j-1]/4;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j]/4;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(j>=3){\n\t\t\t\t\tif(j-3!=br){\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j-3]/4;\n\t\t\t\t\t} else{\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j]/4;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(j%3!=2){\n\t\t\t\t\tif(j+1!=br){\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j+1]/4;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j]/4;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(j<=5){\n\t\t\t\t\tif(j+3!=br){\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j+3]/4;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i][j]+=dp[i-1][j]/4;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << dp[n][tr] << \"\\n\";\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define LL long long\n#define VI vector<int>\n#define VVI vector<vector<int>>\n#define VVVI vector<vector<vector<int>>>\n#define VL vector<LL>\n#define VVL vector<vector<LL>>\n#define VVVL vector<vector<vector<LL>>>\n#define VB vector<bool>\n#define FOR(i,a,b) for(int i= (a); i<((int)b); ++i)\n#define RFOR(i,a) for(int i=(a); i >= 0; --i)\n#define FOE(i,a) for(auto i : a)\n#define ALL(c) (c).begin(), (c).end()\n#define RALL(c) (c).rbegin(), (c).rend()\n#define DUMP(x)  cerr << #x << \" = \" << (x) << endl;\n#define SUM(x) std::accumulate(ALL(x), 0LL)\n#define MIN(v) *std::min_element(v.begin(), v.end())\n#define MAX(v) *std::max_element(v.begin(), v.end())\n#define EXIST(v,x) (std::find(v.begin(), v.end(), x) != v.end())\n#define BIT(n) (1LL<<(n))\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end());\n#define EPS 1e-14\n\ntemplate<class T> T ceil(T a, T b) { return (a + b - 1) / b; }\ntemplate<class T> void print(T x) { std::cout << x << std::endl; }\nbool inside(int y, int x, int H, int W) {return 0 <= y and y < H and 0 <= x and x < W; }\n\nconst std::string YES = \"YES\", Yes = \"Yes\", NO = \"NO\", No = \"No\";\nconst std::vector<int> dy = { 0, 1, 0, -1 }, dx = { 1, 0, -1, 0 };    // 4近傍（右, 下, 左, 上）\n\n\nusing namespace std;\n\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while (true) {\n        int N;\n        cin >> N;\n        if (N == 0) { break; }\n        char S, T, B;\n        cin >> S >> T >> B;\n        int sy = (S - 'A') / 3;\n        int sx = (S - 'A') % 3;\n        int ty = (T - 'A') / 3;\n        int tx = (T - 'A') % 3;\n        int by = (B - 'A') / 3;\n        int bx = (B - 'A') % 3;\n\n        vector<vector<vector<double>>> dp(N + 1, vector<vector<double>>(3, vector<double>(3, 0)));\n        dp[0][sy][sx] = 1;\n\n        FOR(n, 0, N) {\n            FOR(y, 0, 3) {\n                FOR(x, 0, 3) {\n\n                    FOR(i, 0, 4) {\n                        int ny = y + dy[i];\n                        int nx = x + dx[i];\n\n                        if (inside(ny, nx, 3, 3) and not(ny == by and nx == bx)) {\n                            dp[n + 1][ny][nx] += dp[n][y][x] * 0.25;\n                        } else {\n                            dp[n + 1][y][x] += dp[n][y][x] * 0.25;\n                        }\n                    }\n                }\n            }\n        }\n        print(dp[N][ty][tx]);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cmath>\n#include <stdio.h>\nusing namespace std;\n\ntypedef long long int ll;\n\nint patterns[2][10];\nint s, t, b;\n\nvoid getMovablePoints(int* ret, int s) {\n\t//up\n\tret[0] = s - 3;\n\t//right\n\tret[1] = s + 1;\n\t//down\n\tret[2] = s + 3;\n\t//left\n\tret[3] = s - 1;\n\tfor (int i = 0; i < 4; i++) {\n\t\tif(ret[i] < 0 || 8 < ret[i] || ret[i] == b)\n\t\t\tret[i] = s;\n\t}\n}\n\nint main() {\n\tint n;\n\twhile(cin >> n, n) {\n\t\tchar _s, _t, _b;\n\t\tcin >> _s >> _t >> _b;\n\t\ts = _s - 'A';\n\t\tt = _t - 'A';\n\t\tb = _b - 'A';\n\t\tfor (int i = 0; i < 9; i++) {\n\t\t\tpatterns[0][i] = patterns[1][i] = 0;\n\t\t}\n\t\tpatterns[0][s] = 1;\n\t\tint *pattern, *nextPattern;\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tpattern = patterns[i % 2];\n\t\t\tnextPattern = patterns[(i+1) % 2];\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tnextPattern[j] = 0;\n\t\t\t}\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tint movablePoints[4];\n\t\t\t\tgetMovablePoints(movablePoints, j);\n\t\t\t\tfor (int k = 0; k < 4; k++) {\n\t\t\t\t\tnextPattern[movablePoints[k]] += pattern[j];\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tll sum = 0;\n\t\tfor (int i = 0; i < 9; i++) {\n\t\t\tsum += nextPattern[i];\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\", (double)nextPattern[t] / sum);\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stdio.h>\nusing namespace std;\n\nint dy[]={-1,0,1,0};\nint dx[]={0,1,0.-1};\n\ndouble dp[3][3][16];\nint n;\nchar s,t,b;\nint S,T,B;\n\ndouble solve(int y,int x,int n){\n  if(dp[y][x][n]!=-1.0)return dp[y][x][n];\n  if(n==0)return dp[y][x][n]=(y*3+x==T?1.0:0.0);\n\n  double sum=0.0;\n  for(int i=0;i<4;i++){\n    int ny=y+dy[i];\n    int nx=x+dx[i];\n    if(ny<0||nx<0)sum+=solve(y,x,n-1);\n    else if(ny>=3||nx>=3)sum+=solve(y,x,n-1);\n    else if(ny*3+nx==B)sum+=solve(y,x,n-1);\n    else sum+=solve(ny,nx,n-1);\n  }\n  return dp[y][x][n]=sum/4.0;\n}\n\nvoid init(){\n  for(int i=0;i<3;i++)\n    for(int j=0;j<3;j++)\n      for(int k=0;k<16;k++)\n\tdp[i][j][k]=-1.0;\n}\n\nint main(){\n  while(1){\n    cin>>n;\n    if(n==0)break;\n    cin>>s>>t>>b;\n    init();\n    S=s-'A';\n    T=t-'A';\n    B=b-'A';\n    printf(\"%.8f\\n\",solve(S/3,S%3,n));\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<cassert>\n#include<iostream>\n#include<sstream>\n#include<string>\n#include<vector>\n#include<queue>\n#include<set>\n#include<map>\n#include<utility>\n#include<numeric>\n#include<algorithm>\n#include<bitset>\n#include<complex>\n\nusing namespace std;\n\ntypedef long long Int;\ntypedef vector<int> vint;\ntypedef pair<int,int> pint;\n#define mp make_pair\n\ntemplate<class T> void pv(T a, T b) { for (T i = a; i != b; ++i) cout << *i << \" \"; cout << endl; }\ntemplate<class T> void chmin(T &t, T f) { if (t > f) t = f; }\ntemplate<class T> void chmax(T &t, T f) { if (t < f) t = f; }\nint in() { int x; scanf(\"%d\", &x); return x; }\n\ndouble dp[20][10];\nint n,s,t,b;\n\nint move(int pos,int x,int y){\n\tif(pos<3&&y==-1)return pos;\n\tif(pos>6&&y==1)return pos;\n\tif(pos%3==0&&x==-1)return pos;\n\tif(pos%3==2&&x==1)return pos;\n\tpos+=x+3*y;\n\tif(pos==b)return pos-x-3*y;\n\treturn pos;\n}\n\nint main() {\n\tstring ss,tt,bb;\n\twhile(n=in()){\n\t\tcin>>ss>>tt>>bb;\n\t\ts=ss[0]-'A';\n\t\tt=tt[0]-'A';\n\t\tb=bb[0]-'A';\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdp[0][s]=1;\n\t\tint i,j;\n\t\tfor(i=1;i<=n;i++){\n\t\t\tfor(j=0;j<9;j++){\n\t\t\t\tdp[i][move(j,1,0)]+=dp[i-1][j]/4;\n\t\t\t\tdp[i][move(j,-1,0)]+=dp[i-1][j]/4;\n\t\t\t\tdp[i][move(j,0,1)]+=dp[i-1][j]/4;\n\t\t\t\tdp[i][move(j,0,-1)]+=dp[i-1][j]/4;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.12f\\n\",dp[n][t]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\nusing namespace std;\n\n#define rep(i,n) for(int i=0; i<n; i++)\ndouble dp[16][9];\n\nint main(){\n\tint n;\n\tchar s, t, b;\n\twhile( scanf(\"%d\",&n), n ){\n\t\tscanf(\"%c %c %c %c\", &s, &t, &b);\t// \\n, s, t, b\n\t\tmemset( dp, 0, sizeof(dp) );\n\t\tdp[0][s-'A'] = 1.0;\n\t\trep(i,n){\n\t\t\trep(j,9){\n\t\t\t\tif(j-3>=0 && b-'A'!=j-3)\tdp[i+1][j-3] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t\tif(j-1>=0 && b-'A'!=j-1)\tdp[i+1][j-1] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t\tif(j+1< 9 && b-'A'!=j+1)\tdp[i+1][j+1] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t\tif(j+3< 9 && b-'A'!=j+3)\tdp[i+1][j+3] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.7lf\\n\",dp[n][t-'A']);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//49\n#include<iostream>\n#include<iomanip>\n\nusing namespace std;\n\nint tx,ty,bx,by;\n\n#define tox(c) (((c)-'A')%3)\n#define toy(c) (((c)-'A')/3)\n\n/*\nint tox(char c){\n  return (c-'A')%3;\n}\n\nint toy(char c){\n  return (c-'A')/3;\n}\n*/\n\ndouble cal(int r,int y,int x,double p){\n  if(y==by && x==bx){\n    return 0;\n  }else if(r==0){\n    return (y==ty && x==tx)?p:0;\n  }else{\n    double a=0;\n    for(int i=0;i<5;i++){\n      static const int d[]={0,1,0,-1,0};\n      int nx=x+d[i];\n      int ny=y+d[i+1];\n      if(0<=nx&&nx<3&&0<=ny&&ny<3){\n\ta+=cal(r-1,ny,nx,p/4);\n      }\n    }\n    return a;\n  }\n}\n\nint main(){\n  for(int n;cin>>n,n;){\n    char s,t,b;\n    cin>>s>>t>>b;\n    tx=tox(t);\n    ty=toy(t);\n    bx=tox(b);\n    by=toy(b);\n    cout<<fixed<<setprecision(6)<<cal(n,toy(s),tox(s),1)<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstring>\n#include <cmath>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <sstream>\nusing namespace std;\n\nlong cnt,as;\nchar s,t,b,field[3][3];\nconst int dy[]={-1,0,1,0};\nconst int dx[]={0,1,0,-1};\n\nvoid search(int x,int y,int c){\n  int tx,ty;\n  if(c==0.0){\n    if(field[y][x]==2)as++;\n    cnt++;\n    return;\n  }\n  for(int k=0;k<4;k++){\n    tx=x+dx[k];\n    ty=y+dy[k];\n    if(tx<0 || ty<0 || tx>=3 || ty>=3){ cnt++; continue;}\n    if(field[ty][tx]==1){\n      search(x,y,c-1);\n    }else{\n      search(tx,ty,c-1);\n    }\n  }\n}\nint main(){\n  int n;\n  for(;cin>>n,n;){\n    cin.ignore();\n    cnt=as=0;\n    scanf(\" %c %c %c \",&s,&t,&b);\n    memset(field,0,sizeof(field));\n    int x= s=='A'||s=='D'||s=='G'?0:s=='B'||s=='E'||s=='H'?1:2;\n    int y= s=='A'||s=='B'||s=='C'?0:s=='D'||s=='E'||s=='F'?1:2;\n    \n    int p= t=='A'||t=='D'||t=='G'?0:t=='B'||t=='E'||t=='H'?1:2;\n    int q= t=='A'||t=='B'||t=='C'?0:t=='D'||t=='E'||t=='F'?1:2;\n    field[q][p]=2;\n\n    int u= b=='A'||b=='D'||b=='G'?0:b=='B'||b=='E'||b=='H'?1:2;\n    int t= b=='A'||b=='B'||b=='C'?0:b=='D'||b=='E'||b=='F'?1:2;\n    field[t][u]=1;\n\n    search(x,y,n);\n    //printf(\"%lf,%d\\n\",pow(4.0,(double)n),as);\n    printf(\"%.8lf\\n\",(double)as/pow(4.0,(double)n));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <iomanip>\n#include <stdio.h>\nusing namespace std;\n\ndouble prob(int n,int pos,int t,int d)\n{\n\tif (n==0){\n\t\tif (pos==t){\n\t\t\treturn 1;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t}\n\tdouble p=0;\n\tif ((pos-3<0)||(pos-3==d)){\n\t\tp+=prob(n-1,pos,t,d)/4.0;\n\t} else {\n\t\tp+=prob(n-1,pos-3,t,d)/4.0;\n\t}\n\tif ((pos%3 == 0)||(pos-1==d)){\n\t\tp+=prob(n-1,pos,t,d)/4.0;\n\t} else {\n\t\tp+=prob(n-1,pos-1,t,d)/4.0;\n\t}\n\tif ((pos%3 == 2)||(pos+1==d)){\n\t\tp+=prob(n-1,pos,t,d)/4.0;\n\t} else {\n\t\tp+=prob(n-1,pos+1,t,d)/4.0;\n\t}\n\tif ((pos+3>8)||(pos+3==d)){\n\t\tp+=prob(n-1,pos,t,d)/4.0;\n\t} else {\n\t\tp+=prob(n-1,pos+3,t,d)/4.0;\n\t}\n\treturn p;\n}\n\nint main() {\n\tvector<double> r;\n\twhile(true)\n\t{\n\t\tint n;\n\t\tcin >> n;\n\t\tif (n==0){break;}\n\t\tchar a[2],b[2],c[2];\n\t\tint s=0,t=0,d=0;\n\t\tscanf(\"%s %s %s\",a,b,c);\n\t\ts = a[0] - 'A';\n\t\tt = b[0] - 'A';\n\t\td = c[0] - 'A';\n\t\tr.push_back(prob(n,s,t,d));\n\t}\n\tfor(int i=0; i<r.size(); i++)\n\t{\n\t\tcout << setprecision(10) << r[i] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n\n#define WIDTH 3\n#define HEIGHT 3\n\nusing namespace std;\n\nint main()\n{\n\tint n, ctl, map[2][HEIGHT][WIDTH], sx, sy, gx, gy, xx, yy, tx, ty;\n\tint dx[] = {0, 0, -1, 1}, dy[] = {-1, 1, 0, 0};\n\tchar s, t, b;\n\twhile(cin >> n, n) {\n\t\tctl = 0;\n\t\tcin >> s >> t >> b;\n\t\tfor(int i=0; i < HEIGHT; i++) \n\t\t\tfor(int j=0; j < WIDTH; j++)\n\t\t\t\tmap[0][i][j] = map[1][i][j] = 0;\n\t\tsx = (s-'A') % WIDTH; sy = (s-'A') / WIDTH;\n\t\tgx = (t-'A') % WIDTH; gy = (t-'A') / WIDTH;\n\t\txx = (b-'A') % WIDTH; yy = (b-'A') / WIDTH;\n\t\tint cc = n;\n\t\tmap[ctl][sy][sx] = 1;\n\t\twhile(n--) {\n\t\t\tfor(int i=0; i < HEIGHT; i++) {\n\t\t\t\tfor(int j=0; j < WIDTH; j++) {\n\t\t\t\t\tmap[(ctl+1)%2][i][j] = 0;\n\t\t\t\t\tif(!map[ctl][i][j] || (i==yy && j==xx)) continue;\n\t\t\t\t\tfor(int d=0; d < 4; d++) {\n\t\t\t\t\t\ttx = j + dx[d]; ty = i + dy[d];\n\t\t\t\t\t\tif(0 > tx || tx >= WIDTH || 0 > ty || ty >= HEIGHT || (tx == xx && ty == yy))\n\t\t\t\t\t\t\tmap[(ctl+1)%2][i][j] += map[ctl][i][j];\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tmap[(ctl+1)%2][ty][tx] += map[ctl][i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tctl = (ctl+1) % 2;\n\t\t}\n\t\tprintf(\"%.8f\\n\", (float)map[ctl][gy][gx]/(pow(4.0, cc)));\n\t\t\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define F first\n#define S second\n#define INF 1 << 30\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\ndouble dp[16][3][3];\nint n, dx[] = {0,-1,0,1}, dy[] = {-1,0,1,0};\nchar cs, ct, cb;\nint s, t, b;\n\nint main(){\n  while(scanf(\"%d\", &n) && n){\n    memset(dp, 0.0, sizeof(dp));\n    scanf(\"\\n%c %c %c\", &cs, &ct, &cb);\n    s = cs - 'A';\n    t = ct - 'A';\n    b = cb - 'A';\n    //    fprintf(stderr, \"%c\\n\", cs);\n    dp[0][s/3][s%3] = 1;\n\n    rep(i, n) rep(y, 3) rep(x, 3){\n      rep(d, 4){\n\tint ny = y + dy[d], nx = x + dx[d];\n\tif(ny < 0 || nx < 0 || ny >= 3 || nx >= 3 || ny*3+nx == b) continue;\n\tdp[i+1][ny][nx] += dp[i][y][x]*0.25;\n      }\n    }\n\n    printf(\"%.8lf\\n\", dp[n][t/3][t%3]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n\nint main()\n{\n\tint room[16][9];\n\tint n;\n\tint s, t, b;\n\tchar buf[16];\n\n\twhile (scanf(\"%d\", &n), n){\n\t\tscanf(\" %[^\\n]\", buf);\n\t\ts = buf[0] - 'A';\n\t\tt = buf[2] - 'A';\n\t\tb = buf[4] - 'A';\n\n\t\tmemset(room, 0, sizeof(room));\n\t\troom[0][s] = 1;\n\t\tfor (int i = 0; i < n; i++){\n\t\t\tfor (int j = 0; j < 9; j++){\n\t\t\t\tif (room[i][j]){\n\t\t\t\t\tif ((j % 3) + 1 <= 2 && j + 1 != b) {\n\t\t\t\t\t\troom[i + 1][j + 1] += room[i][j];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\troom[i + 1][j] += room[i][j];\n\t\t\t\t\t}\n\t\t\t\t\tif ((j % 3) - 1 >= 0 && j - 1 != b) {\n\t\t\t\t\t\troom[i + 1][j - 1] += room[i][j];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\troom[i + 1][j] += room[i][j];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (j / 3 + 1 <= 2 && j + 3 != b){\n\t\t\t\t\t\troom[i + 1][j + 3] += room[i][j];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\troom[i + 1][j] += room[i][j];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (j / 3 - 1 >= 0 && j - 3 != b){\n\t\t\t\t\t\troom[i + 1][j - 3] += room[i][j];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\troom[i + 1][j] += room[i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tint total_pattern = 0;\n\t\tfor (int i = 0; i < 9; i++){\n\t\t\ttotal_pattern += room[n][i];\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\", (double)room[n][t] / total_pattern);\n\t}\n\n\treturn (0);\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 100000000\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P> PP;\n\nstatic const double EPS = 1e-8;\n\nconst int tx[] = {0,1,0,-1};\nconst int ty[] = {-1,0,1,0};\n\nchar stage[3][3];\n\nint gAll=0,gOk=0;\n\nint gCount[3][3][16];\n\nvoid dfs(int sx,int sy,int gx,int gy,int cost){\n\n\tif(cost==0){\n\t\tif(sx==gx && sy==gy){\n\t\t\tgOk++;\n\t\t}\n\t\treturn;\n\t}\n\n\tfor(int i=0;i<4;i++){\n\t\tint dx = sx + tx[i];\n\t\tint dy = sy + ty[i]; \n\t\tif(dx < 0 || dx >= 3 || dy < 0 || dy >= 3){\n\t\t\tgCount[sy][sx][cost-1]++;\n\t\t\tif(gCount[sy][sx][cost-1]<=1) dfs(sx,sy,gx,gy,cost-1);\n\t\t}\n\n\t\telse if(stage[dy][dx] != 'B'){\n\t\t\tgCount[dy][dx][cost-1]++;\n\t\t\tif(gCount[dy][dx][cost-1]<=1) dfs(dx,dy,gx,gy,cost-1);\n\t\t}\n\t\telse if(stage[dy][dx] == 'B'){\n\t\t\tgCount[sy][sx][cost-1]++;\n\t\t\tif(gCount[sy][sx][cost-1]<=1) dfs(sx,sy,gx,gy,cost-1);\n\t\t}\n\t}\n}\n\nint main(){\n\tint n;\n\twhile(~scanf(\"%d\",&n)){\n\t\tif(n==0) break;\n\n\t\tchar s,t,b;\n\t\tmemset(stage,'.',sizeof(stage));\n\t\tmemset(gCount,0,sizeof(gCount));\n\t\tcin >> s >> t >> b;\n\t\tint sx = (s-'A')%3;\n\t\tint sy = (s-'A')/3;\n\t\tint gx = (t-'A')%3;\n\t\tint gy = (t-'A')/3;\n\t\tstage[(b-'A')/3][(b-'A')%3] = 'B';\n\n\t\tgOk=0;\n\t\tgAll=0;\n\t\tdfs(sx,sy,gx,gy,n);\n\n\t\tfor(int x=0;x<3;x++){\n\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\tgAll+=gCount[y][x][0];\n\t\t\t}\n\t\t}\n\t\tprintf(\"%lf\\n\",(double)gOk/(double)gAll);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<n;i++)\nconst int dx[] ={ 0,1,0,-1};\nconst int dy[] ={-1,0,1, 0};\n\nint main(){\n\tint n;\n\twhile(cin >> n , n){\n\t\tlong double dp[16][5][5] = {{{0.0}}};\n\t\tchar map[5][5];\n\t\trep(i,5)rep(j,5)map[i][j] = 'X';\n\t\trep(i,3)rep(j,3)map[i+1][j+1] = ' ';\n\t\tint sx, sy, gx, gy, bx, by;\n\t\tchar s,t,b;\n\t\tcin >> s >> t >> b ;\n\t\tsy = (s-'A')/3 +1 , sx = (s-'A')%3 +1;\n\t\tgy = (t-'A')/3 +1 , gx = (t-'A')%3 +1;\n\t\tby = (b-'A')/3 +1 , bx = (b-'A')%3 +1;\n\t\t\n\t\tmap[by][bx] = 'X';\n\t\tdp[n][sy][sx] = 1.0;\n\t\t\n\t\twhile(n){\n\t\t\tfor(int y=1;y<=3;y++){\n\t\t\t\tfor(int x=1;x<=3;x++){\n\t\t\t\t\trep(i,4){\n\t\t\t\t\t\tint tx = x+dx[i], ty = y+dy[i] ;\n\t\t\t\t\t\tif(map[ty][tx] == 'X')ty = y , tx = x;\n\t\t\t\t\t\tdp[n-1][ty][tx] += dp[n][y][x] / 4.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tn--;\n\t\t}\n\t\tprintf(\"%.8Lf\\n\",dp[0][gy][gx]);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cmath>\n#include <stdio.h>\nusing namespace std;\n\ntypedef long long int ll;\n\nint patterns[2][10];\nint s, t, b;\n\nvoid getMovablePoints(int* ret, int s) {\n\t//up\n\tret[0] = s - 3;\n\t//right\n\tret[1] = s + 1;\n\t//down\n\tret[2] = s + 3;\n\t//left\n\tret[3] = s - 1;\n\tfor (int i = 0; i < 4; i++) {\n\t\tif(ret[i] < 0 || 8 < ret[i] || ret[i] == b)\n\t\t\tret[i] = s;\n\t\tif(i % 2 == 0 && ret[i] % 3 == 0)\n\t\t\tret[i] = s;\n\t}\n}\n\nint main() {\n\tint n;\n\twhile(cin >> n, n) {\n\t\tchar _s, _t, _b;\n\t\tcin >> _s >> _t >> _b;\n\t\ts = _s - 'A';\n\t\tt = _t - 'A';\n\t\tb = _b - 'A';\n\t\tfor (int i = 0; i < 9; i++) {\n\t\t\tpatterns[0][i] = patterns[1][i] = 0;\n\t\t}\n\t\tpatterns[0][s] = 1;\n\t\tint *pattern, *nextPattern;\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tpattern = patterns[i % 2];\n\t\t\tnextPattern = patterns[(i+1) % 2];\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tnextPattern[j] = 0;\n\t\t\t}\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tint movablePoints[4];\n\t\t\t\tgetMovablePoints(movablePoints, j);\n\t\t\t\tfor (int k = 0; k < 4; k++) {\n\t\t\t\t\tnextPattern[movablePoints[k]] += pattern[j];\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tll sum = 0;\n\t\tfor (int i = 0; i < 9; i++) {\n\t\t\tsum += nextPattern[i];\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\", (double)nextPattern[t] / sum);\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\nusing namespace std;\n\n#define rep(i,n) for(int i=0; i<n; i++)\ndouble dp[16][9];\n\nint main(){\n\tint n;\n\tchar s, t, b;\n\twhile( scanf(\"%d\",&n), n ){\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\tmemset( dp, 0, sizeof(dp) );\n\t\tdp[0][s-'A'] = 1.0;\n\t\trep(i,n){\n\t\t\trep(j,9){\n\t\t\t\tif(j-3>=0 && b-'A'!=j-3)\tdp[i+1][j-3] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t\tif(j%3!=0 && b-'A'!=j-1)\tdp[i+1][j-1] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t\tif(j%3!=2 && b-'A'!=j+1)\tdp[i+1][j+1] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t\tif(j+3< 9 && b-'A'!=j+3)\tdp[i+1][j+3] += dp[i][j]/4.0;\n\t\t\t\telse\t\t\t\t\t\tdp[i+1][j]   += dp[i][j]/4.0;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.7lf\\n\",dp[n][t-'A']);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cstring>\n\nusing namespace std;\n\nint main() {\n\tint n;\n\twhile (cin >> n, n) {\n\t\tlong double room[3][3][n+1];\n\t\tmemset(room, 0, sizeof(room));\n\n\t\tchar s, t, b;\n\t\tcin >> s >> t >> b;\n\n\t\tint y = (s-'A') / 3;\n\t\tint x = (s-'A') % 3;\n\t\tint by = (b-'A') / 3;\n\t\tint bx = (b-'A') % 3;\n\t\tint gy = (t-'A') / 3;\n\t\tint gx = (t-'A') % 3;\n\n\t\troom[y][x][0] = 1.0;\n\n\t\tint dx[] = {-1, 0, 0, 1};\n\t\tint dy[] = {0, -1, 1, 0};\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\tfor (int l = 0; l < 3; l++) {\n\t\t\t\t\tfor (int j = 0; j < 4; j++) {\n\t\t\t\t\t\tint nx = l + dx[j];\n\t\t\t\t\t\tint ny = k + dy[j];\n\t\t\t\t\t\tif (nx < 0 || 2 < nx || ny < 0 || 2 < ny || (bx == nx && by == ny)) {\n\t\t\t\t\t\t\troom[k][l][i+1] += room[k][l][i] * 0.25;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\troom[ny][nx][i+1] += room[k][l][i] * 0.25;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout.precision(9);\n\t\tcout << fixed << room[gy][gx][n] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "// AOJ 1020\n#include<iostream>\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\nusing namespace std;\n\ntypedef double number;\nint n;\nint sx, sy, tx, ty, bx, by;\nnumber room[3][3];\n\nvoid init() {\n  REP(x, 3) REP(y, 3) {\n    room[x][y] = 0;\n  }\n  room[sx][sy] = 1;\n}\n\nbool is_depot(int x, int y) {\n  return x == bx && y == by;\n}\n\nnumber in(int x, int y) {\n  if (x < 0 or 2 < x or y < 0 or 2 < y) return 0;\n  if (is_depot(x, y)) return 0;\n  return room[x][y];\n}\n\nnumber solve() {\n  init();\n  REP(i, n) {\n    number future[3][3];\n    REP(x, 3) REP(y,3) {\n      if (is_depot(x, y)) future[x][y] = 0;\n      future[x][y] = \n        in(x + 1, y) / 4 + in(x - 1, y) / 4 +\n        in(x, y + 1) / 4 + in(x, y - 1) / 4;\n    }\n    REP(x, 3) REP(y, 3) {\n      room[x][y] = future[x][y];\n    }\n  }\n  return room[tx][ty];\n}\n\nint room2x(char r) {\n  switch (r) {\n    case 'A': case 'D': case 'G':\n      return 0; break;\n    case 'B': case 'E': case 'H':\n      return 1; break;\n    case 'C': case 'F': case 'I':\n      return 2; break;\n    default:\n      break;\n  }\n}\n\nint room2y(char r) {\n  switch (r) {\n    case 'A': case 'B': case 'C':\n      return 0; break;\n    case 'D': case 'E': case 'F':\n      return 1; break;\n    case 'G': case 'H': case 'I':\n      return 2; break;\n    default:\n      break;\n  }\n}\n\nint main() {\n  while (cin >> n and n) {\n    char s, t, b;\n    cin >> s >> t >> b;\n    sx = room2x(s); sy = room2y(s);\n    tx = room2x(t); ty = room2y(t);\n    bx = room2x(b); by = room2y(b);\n\n    cout << solve() << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstring>\n#include <cmath>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <sstream>\nusing namespace std;\n\nlong cnt,as;\nchar s,t,b;\nconst int dy[]={-1,0,1,0};\nconst int dx[]={0,1,0,-1};\nint main(){\n  int n,field[2][5][5],tx,ty;\n  for(;cin>>n,n;){\n    cin.ignore();\n    cnt=as=0;\n    scanf(\" %c %c %c \",&s,&t,&b);\n    memset(field,0,sizeof(field));\n    int x= s=='A'||s=='D'||s=='G'?1:s=='B'||s=='E'||s=='H'?2:3;\n    int y= s=='A'||s=='B'||s=='C'?1:s=='D'||s=='E'||s=='F'?2:3;\n    \n    int p= t=='A'||t=='D'||t=='G'?1:t=='B'||t=='E'||t=='H'?2:3;\n    int q= t=='A'||t=='B'||t=='C'?1:t=='D'||t=='E'||t=='F'?2:3;\n\n    int u= b=='A'||b=='D'||b=='G'?1:b=='B'||b=='E'||b=='H'?2:3;\n    int t= b=='A'||b=='B'||b=='C'?1:b=='D'||b=='E'||b=='F'?2:3;\n\n    field[0][y][x]=1;\n    field[0][0][0]=field[0][0][1]=field[0][0][2]=field[0][0][3]=field[0][0][4]=1;\n    field[0][4][0]=field[0][4][1]=field[0][4][2]=field[0][4][3]=field[0][4][4]=1;\n    field[0][1][0]=field[0][2][0]=field[0][3][0]=1;\n    field[0][1][4]=field[0][2][4]=field[0][3][4]=1;\n    for(int k=0;k<n;k++){\n      for(int i=1;i<4;i++){\n        for(int j=1;j<4;j++){\n          if(i==t && j==u)continue;\n\n          for(int g=0;g<4;g++){\n            tx=j+dx[g];\n            ty=i+dy[g];\n            if(field[0][i][j]==0 && (tx<1 || ty<1 || tx>=4 || ty>=4))continue;\n            field[1][i][j]+=field[0][ty][tx];\n          }\n          if(field[0][i][j]!=0 && (i-1==t&&j==u || i+1==t&&j==u ||\n             i==t&&j-1==u || i==t&&j+1==u) ){\n            field[1][i][j]++;\n          }\n        }\n      }\n      for(int ii=1;ii<4;ii++){\n        for(int jj=1;jj<4;jj++){\n          printf(\"%7d \",field[1][ii][jj]);\n        }\n        puts(\"\");\n      }\n      puts(\"\");\n      for(int i=1;i<4;i++)for(int j=1;j<4;j++)field[0][i][j]=field[1][i][j],field[1][i][j]=0;\n    }\n    double ababa=0.0;\n    for(int i=1;i<4;i++)for(int j=1;j<4;j++)ababa+=field[0][i][j];\n    \n    printf(\"%.8lf\\n\",(double)field[0][q][p]/ababa);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<map>\n#include<cstdio>\n//ABC\n//DEF\n//GHI\nusing namespace std;;\ntypedef pair<int,int> P;\nint n,out,can,dx[]={0,0,-1,1},dy[]={1,-1,0,0},dp[3][3][16];\nint gox,goy,mox,moy,stx,sty;\nint func(int y,int x,int bat){\n\tif(dp[y][x][bat]>=0)\n\treturn dp[y][x][bat];\n\tif(bat==0){\n\t\tif(y==goy&&x==gox){\n\t\t\tcan++;\n\t\t\tout++;\n\t\t\treturn dp[y][x][bat]=1;\n\t\t}\n\t\tout++;\n\t\treturn 0;\n\t}\n\tint nx,ny,sum=0;\n\tfor(int i=0;i<4;i++){\n\t\tny=dy[i]+y;\n\t\tnx=dx[i]+x;\n\t\tif(!(ny>=0&&ny<3&&nx>=0&&nx<3)||(nx==mox&&ny==moy))\n\t\t\tsum+=func(y,x,bat-1);\n\t\telse\n\t\t\tsum+=func(ny,nx,bat-1);\n\t}\n\treturn dp[y][x][bat]=sum;\n}\nint main(){\n\twhile(cin>>n,n){\n\t\tfor(int i=0;i<3;i++)\n\t\tfor(int j=0;j<3;j++)\n\t\tfor(int k=0;k<=n;k++)\n\t\tdp[i][j][k]=-1;\n\t\tchar a[3];\n\t\tcan=0;\n\t\tout=0;\n\t\tint sx[3],sy[3];\n\t\tcin>>a[0]>>a[1]>>a[2];\n\t\tfor(int i=0;i<3;i++){\n\t\t\tif(a[i]=='A'){\n\t\t\t\ta[i]=0;sx[i]=0;\n\t\t\t}else if(a[i]=='B'){\n\t\t\t\tsy[i]=0;sx[i]=1;\n\t\t\t}else if(a[i]=='C'){\n\t\t\t\tsy[i]=0;sx[i]=2;\n\t\t\t}else if(a[i]=='D'){\n\t\t\t\tsy[i]=1;sx[i]=0;\n\t\t\t}else if(a[i]=='E'){\n\t\t\t\tsy[i]=1;sx[i]=1;\n\t\t\t}else if(a[i]=='F'){\n\t\t\t\tsy[i]=1;sx[i]=2;\n\t\t\t}else if(a[i]=='G'){\n\t\t\t\tsy[i]=2;sx[i]=0;\n\t\t\t}else if(a[i]=='H'){\n\t\t\t\tsy[i]=2;sx[i]=1;\n\t\t\t}else if(a[i]=='I'){\n\t\t\tsy[i]=2;sx[i]=2;\n\t\t\t}\n\t\t}\n\t\tsty=sy[0];stx=sx[0];\n\t\tgoy=sy[1];gox=sx[1];\n\t\tmoy=sy[2];mox=sx[2];\n\t\tfunc(sty,stx,n);\n\t\tint pre=1;\n\t\tfor(int i=0;i<n;i++)\n\t\tpre*=4;\n\t\tprintf(\"%.8lf\\n\",(double)can/pre);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define EPS (10e-9)\n\nusing namespace std;\n\ndouble dp[16][9];\nconst string room[3] = { \"ABC\", \"DEF\", \"GHI\" };\nconst int dir[][2] = { {-1, 0 }, { 0, 1 }, { 1, 0 }, { 0, -1 } };\n\nint main()\n{\n\tint n;\n\twhile (cin >> n && n ){\n\t\tchar s, t, b;\n\t\tcin >> s >> t >> b;\n\n\t\trep (i, 16 ) rep (j, 9 ) dp[i][j] = 0.0;\n\n\t\tdp[0][s-'A'] = 1.0;\n\t\trep (i, n )\n\t\t\tfor (int j = 0; j < 9; j++ ){\n\t\t\t\tif (dp[i][j] > EPS ){\n\t\t\t\t\tint cr = j/3, cc = j%3;\n\t\t\t\t\tchar C = room[cr][cc];\n\t\t\t\t\trep (k, 4 ){\n\t\t\t\t\t\tint nr = cr + dir[k][0];\n\t\t\t\t\t\tint nc = cc + dir[k][1];\n\t\t\t\t\t\tif (nr < 0 || nc < 0 || nr >= 3 || nc >= 3 || room[nr][nc] == b ){\n\t\t\t\t\t\t\tdp[i+1][C-'A'] += 1./4.*dp[i][C-'A'];\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tchar D = room[nr][nc];\n\t\t\t\t\t\t\tdp[i+1][D-'A'] += 1./4.*dp[i][C-'A'];\n\t\t\t\t\t\t} // end if\n\t\t\t\t\t} // end rep\n\t\t\t\t} // end if\n\t\t\t} // end for\n\n\t\tprintf (\"%.9lf\\n\", dp[n][t-'A'] );\n\t} // end loop\n\t\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\nusing namespace std;\n \n#define CHARGER 1\n#define STORE 2\n \nint room[3][3];\nint dx[4]={0,1,0,-1};\nint dy[4]={-1,0,1,0};\nint cnt,cnt2;\n \nvoid rec(int n, int x, int y)\n{\n int i,xx,yy;\n \n if(n==0){\n  cnt++;\n  if(room[x][y]==CHARGER)cnt2++;\n  return;\n }\n \n n--;\n \n for(i=0;i<4;i++){\n  xx=x+dx[i];\n  yy=y+dy[i];\n  if(xx<0||3<=xx||yy<0||3<=yy){xx-=dx[i];yy-=dy[i];}\n  if(room[x][y]==STORE){xx-=dx[i];yy-=dy[i];}\n  rec(n,xx,yy);\n }\n}\n \nint main(){\n int n,i,j;\n char s,t,b;\n cout<<setprecision(8);\n cout<<setiosflags(ios::fixed);\n while(cin>>n,n){\n  cin>>s>>t>>b;\n  for(i=0;i<3;i++)for(j=0;j<3;j++)room[i][j]=0;\n  s-='A';\n  t-='A';\n  b-='A';\n  room[t%3][t/3]=CHARGER;\n  room[b%3][b/3]=STORE;\n  cnt=cnt2=0;\n  rec(n,s%3,s/3);\n  cout<<(double)cnt2/cnt<<endl;\n }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <cstring>\nusing namespace std;\nstatic const double EPS = 1e-5;\ntypedef long long ll;\n\n\ndouble p[5][5];\ndouble ne[5][5];\n\nchar s,t,b;\n\n\ndouble pp(int x,int y){\n\tif(b/3+1==x && b%3+1==y)return 0;\n\telse return p[x][y];\n}\n\nint main(){\n\tint n;\n\t\n\twhile(cin>>n){\n\t\tif(n==0)break;\n\t\t\n\t\tcin>>s>>t>>b;\n\t\t\n\t\ts-='A';\n\t\tt-='A';\n\t\tb-='A';\n\t\t\n\t\tfor(int i=0;i<5;i++){\n\t\t\tfor(int j=0;j<5;j++){\n\t\t\t\tp[i][j]=0;\n\t\t\t\tne[i][j]=0;\n\t\t\t}\n\t\t}\n\t\t\n\t\tp[s/3+1][s%3+1]=1;\n\t\t\n\t\twhile(n){\n\t\t\tn--;\n\t\t\tfor(int i=1;i<=3;i++){\n\t\t\t\tfor(int j=1;j<=3;j++){\n\t\t\t\t\tne[i][j]=(pp(i+1,j)+pp(i-1,j)+pp(i,j+1)+pp(i,j-1))/4;\n\t\t\t\t\tif(i==b/3+1 && j==b%3+1)ne[i][j]=0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemcpy(p,ne,sizeof(ne));\n\t\t}\n\t\t\n\t\tprintf(\"%.8f\\n\",pp(t/3+1,t%3+1));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 100000000\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P> PP;\n\nstatic const double EPS = 1e-8;\n\nconst int tx[] = {0,1,0,-1};\nconst int ty[] = {-1,0,1,0};\n\nchar stage[3][3];\n\nint gAll=0,gOk=0;\n\nvoid dfs(int sx,int sy,int gx,int gy,int cost){\n\n\tif(cost==0){\n\t\tgAll++;\n\t\tif(sx==gx && sy==gy){\n\t\t\tgOk++;\n\t\t}\n\t\treturn;\n\t}\n\n\tfor(int i=0;i<4;i++){\n\t\tint dx = sx + tx[i];\n\t\tint dy = sy + ty[i]; \n\t\tif(dx < 0 || dx >= 3 || dy < 0 || dy >= 3){\n\t\t\tdfs(sx,sy,gx,gy,cost-1);\n\t\t}\n\n\t\telse if(stage[dy][dx] != 'B'){\n\t\t\tdfs(dx,dy,gx,gy,cost-1);\n\t\t}\n\t\telse if(stage[dy][dx] == 'B'){\n\t\t\tdfs(sx,sy,gx,gy,cost-1);\n\t\t}\n\t}\n}\n\nint main(){\n\tint n;\n\twhile(~scanf(\"%d\",&n)){\n\t\tif(n==0) break;\n\n\t\tchar s,t,b;\n\t\tmemset(stage,'.',sizeof(stage));\n\t\tcin >> s >> t >> b;\n\t\tint sx = (s-'A')%3;\n\t\tint sy = (s-'A')/3;\n\t\tint gx = (t-'A')%3;\n\t\tint gy = (t-'A')/3;\n\t\tstage[(b-'A')/3][(b-'A')%3] = 'B';\n\n\t\tgOk=0;\n\t\tgAll=0;\n\t\tdfs(sx,sy,gx,gy,n);\n\n\t\tprintf(\"%lf\\n\",(double)gOk/(double)gAll);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<n;i++)\nconst int dx[] ={ 0,1,0,-1};\nconst int dy[] ={-1,0,1, 0};\n\nint main(){\n\tint n;\n\twhile(cin >> n , n){\n\t\tlong double dp[16][5][5] = {{{0.0}}};\n\t\tchar map[5][5];\n\t\trep(i,5)rep(j,5)map[i][j] = 'X';\n\t\trep(i,3)rep(j,3)map[i+1][j+1] = ' ';\n\t\tint sx, sy , gx, gy ,bx , by;\n\t\tchar s,t,b;\n\t\tcin >> s >> t >> b ;\n\t\tsy = (s-'A')/3 +1 ,sx = (s-'A')%3 +1;\n\t\tgy = (t-'A')/3 +1 ,gx = (t-'A')%3 +1;\n\t\tby = (b-'A')/3 +1 ,bx = (b-'A')%3 +1;\n\t\t\n\t\tmap[by][bx] = 'X';\n\t\tdp[n][sy][sx] = 1.0;\n\t\t\n\t\twhile(n){\n\t\t\tfor(int y=1;y<=3;y++){\n\t\t\t\tfor(int x=1;x<=3;x++){\n\t\t\t\t\trep(i,4){\n\t\t\t\t\t\tint tx = x+dx[i], ty = y+dy[i] ;\n\t\t\t\t\t\tif(map[ty][tx] == 'X')ty = y , tx = x;\n\t\t\t\t\t\tdp[n-1][ty][tx] += dp[n][y][x] / 4.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tn--;\n\t\t}\n\t\tprintf(\"%.8Lf\\n\",dp[0][gy][gx]);\n\t}\n}\n\t"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\nusing namespace std;\n\ndouble dp[16][9];\n\ndouble solve(int n, int p, const int t, const int b)\n{\n  if (n == 0) {\n    if (p == t)\n      return 1.0;\n    return 0.0;\n  }\n\n  if (dp[n][p] != -1.0)\n    return dp[n][p];\n\n  double res = 0.0;\n  // north\n  if (p > 2 && p-3 != b)\n    res += 0.25 * solve(n-1, p-3, t, b);\n  else\n    res += 0.25 * solve(n-1, p, t, b);\n\n  // east\n  if (p%3 != 2 && p+1 != b)\n    res += 0.25 * solve(n-1, p+1, t, b);\n  else\n    res += 0.25 * solve(n-1, p, t, b);\n\n  // south\n  if (p < 6 && p+3 != b)\n    res += 0.25 * solve(n-1, p+3, t, b);\n  else\n    res += 0.25 * solve(n-1, p, t, b);\n\n  // west\n  if (p%3 != 0 && p-1 != b)\n    res += 0.25 * solve(n-1, p-1, t, b);\n  else\n    res += 0.25 * solve(n-1, p, t, b);\n\n  return dp[n][p] = res;\n}\n\nint main()\n{\n  int n;\n  while (cin >> n) {\n    if (n == 0)\n      break;\n\n    for (int i = 0; i < 16; ++i) {\n      for (int j = 0; j < 9; ++j)\n\tdp[i][j] = -1.0;\n    }\n\n    char s, t, b;\n    cin >> s >> t >> b;\n    printf(\"%.8f\\n\", solve(n, s-'A', t-'A', b-'A'));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <iostream>\nusing namespace std;\nint dx[4]={1,-1,0,0};\nint dy[4]={0,0,1,-1};\ndouble dp[16][3][3];\nchar s,t,b;\nint main() {\n    int n, sx, sy, tx, ty, bx, by;\n    while (scanf(\"%d\",&n)) {\n        if (!n) break;\n        memset(dp, 0, sizeof(dp));\n        cin>>s>>t>>b;\n        sx=(s-'A')/3; sy=(s-'A')%3;\n        tx=(t-'A')/3; ty=(t-'A')%3;\n        bx=(b-'A')/3; by=(b-'A')%3;\n        dp[0][sx][sy]=1.0;\n        for (int i=0; i<=n; i++) {\n            for (int j=0; j<3; j++) {\n                for (int k=0; k<3; k++) {\n                    for (int l=0; l<4; l++) {\n                        int x=j+dx[l], y=k+dy[l];\n                        if (x>=0&&x<3&&y>=0&&y<3&&(x!=bx||y!=by)) {\n                            dp[i+1][x][y]+=dp[i][j][k]/4.0;\n                        } else {\n                            dp[i+1][j][k]+=dp[i][j][k]/4.0;\n                        }\n                    }\n                    // printf(\"%f%c\",dp[i][j][k],k==2?'\\n':' ');\n                }\n            }\n        }\n        printf(\"%.8f\\n\",dp[n][tx][ty]);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tint n;\n\tchar s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A']=i%3+1;\n\t\tfy[i+'A']=i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d \", &n) , n ){\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\t\n\t\tchar m[5][5] = {0};\n\t\tfor(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;\n\n\t\tif( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else{\n\t\t\tsolve( n , m );\n\t\t\t;\n\t\t}\n\t\t//debug( m );\n\t\tprintf(\"%.8f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cmath>\n#include <cstdio>\n#include <iostream>\n#include <map>\n#include <utility>\n\nusing namespace std;\nint n, sx, sy, tx, ty, bx, by;\nint mvx[4] = {-1, 1, 0, 0};\nint mvy[4] = {0, 0, -1, 1};\nint c;\n\nvoid dfs(int k, int x, int y){\n    if (k == n) {\n        if (x == tx && y == ty) {\n            c++;\n        }\n        return;\n    }\n    for (int i = 0; i < 4; i++) {\n        int mx = x + mvx[i];\n        int my = y + mvy[i];\n        if (mx < 0 || mx > 2 || my < 0 || my > 2 || (mx == bx && my == by)) {\n            dfs(k+1, x, y);\n            continue;\n        }\n        dfs(k+1, mx, my);\n    }\n}\n\nint main()\n{\n    char s, t, b;\n    map<char, pair<int, int>> rooms;\n    rooms['A'].first = 0; rooms['A'].second = 0;\n    rooms['B'].first = 1; rooms['B'].second = 0;\n    rooms['C'].first = 2; rooms['C'].second = 0;\n    rooms['D'].first = 0; rooms['D'].second = 1;\n    rooms['E'].first = 1; rooms['E'].second = 1;\n    rooms['F'].first = 2; rooms['F'].second = 1;\n    rooms['G'].first = 0; rooms['G'].second = 2;\n    rooms['H'].first = 1; rooms['H'].second = 2;\n    rooms['I'].first = 2; rooms['I'].second = 2;\n\n    while (cin >> n && n) {\n        cin >> s >> t >> b;\n        c = 0;\n        sx = rooms[s].first; sy = rooms[s].second;\n        tx = rooms[t].first; ty = rooms[t].second;\n        bx = rooms[b].first; by = rooms[b].second;\n        dfs(0, sx, sy);\n        printf(\"%.8f\\n\", (double)c / pow(4, n));\n        \n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define for_(i,a,b) for(int i=(a);i<(b);++i)\n\nconst int dx[4] = {-1,0,1,0};\nconst int dy[4] = {0,-1,0,1};\n\nint n;\nchar s, t, b;\ndouble p[2][3][3];\n\nint getX(char c) { return (c - 'A') % 3; }\nint getY(char c) { return (c - 'A') / 3; }\n\nvoid solve() {\n\tfor_(y,0,3) for_(x,0,3) p[0][y][x] = 0.;\n\tp[0][getY(s)][getX(s)] = 1.0;\n\t\n\tfor_(i,0,n) {\n\t\tfor_(y,0,3) for_(x,0,3) {\n\t\t\tif (y == getY(b) && x == getX(b)) continue;\n\t\t\tfor_(d,0,4) {\n\t\t\t\tint nx = x + dx[d], ny = y + dy[d];\n\t\t\t\tif (nx < 0 || nx >= 3 || ny < 0 || ny >= 3) continue;\n\t\t\t\tp[1][y][x] += p[0][ny][nx] * 0.25;\n\t\t\t}\n\t\t}\n\t\tswap(p[0], p[1]);\n\t}\n\t\n\tcout << setprecision(9) << setiosflags(ios::fixed) << p[0][getY(t)][getX(t)] << endl;\n}\n\nint main() {\n\twhile (cin >> n, n) {\n\t\tcin >> s >> t >> b;\n\t\tsolve();\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <utility>\n#include <queue>\n#include <string>\n\nusing namespace std;\n\ntypedef pair<int,int> Pa;\n\nstruct step{\n\tPa p;\n\tint t;\n};\n\nint dx[4] = {0, 1, 0, -1}, dy[4] = {1, 0, -1, 0};\n\nPa func(string str)\n{\n\tif(str == \"A\"){\n\t\treturn Pa(0,0);\n\t} else if(str == \"B\"){\n\t\treturn Pa(0,1);\n\t} else if(str == \"C\"){\n\t\treturn Pa(0,2);\n\t} else if(str == \"D\"){\n\t\treturn Pa(1,0);\n\t} else if(str == \"E\"){\n\t\treturn Pa(1,1);\n\t} else if(str == \"F\"){\n\t\treturn Pa(1,2);\n\t} else if(str == \"G\"){\n\t\treturn Pa(2,0);\n\t} else if(str == \"H\"){\n\t\treturn Pa(2,1);\n\t} else {\n\t\treturn Pa(2,2);\n\t}\n}\n\ndouble bfs(int a[3][3], Pa st, int n)\n{\n\tdouble rate=0.0;\n\tqueue<step> que;\n\tstep s, tmp;\n\ts.p = st;\n\ts.t = 0;\n\tque.push(s);\n\t\n\twhile(1){\n\t\ts = que.front();\n\t\tif(s.t == n){\n\t\t\tbreak;\n\t\t}\n\t\tque.pop();\n\t\t\n\t\tfor(int i = 0; i < 4; i++){\n\t\t\tint y = s.p.first+dy[i], x = s.p.second+dx[i];\n\t\t\tif(0 <= x && x < 3 && 0 <= y && y < 3){\n\t\t\t\tif(a[y][x] == 2){\n\t\t\t\t\ty = s.p.first;\n\t\t\t\t\tx = s.p.second;\n\t\t\t\t}\n\t\t\t\ttmp.p = Pa(y,x);\n\t\t\t\ttmp.t = s.t+1;\n\t\t\t\tque.push(tmp);\n\t\t\t}\n\t\t}\n\t}\n\t\n\twhile(!que.empty()){\n\t\ts = que.front();\n\t\tque.pop();\n\t\tif(a[s.p.first][s.p.second] == 1){\n\t\t\trate += 1.0;\n\t\t}\n\t}\n\t\n\treturn rate/(1<<(2*n));\n}\n\nint main()\n{\n\tint n, a[3][3];\n\tstring s, t, u;\n\tPa p;\n\t\n\twhile(1){\n\t\tcin >> n;\n\t\tif(n == 0){\n\t\t\tbreak;\n\t\t}\n\t\tcin >> s >> t >> u;\n\t\tfill(&a[0][0], &a[2][2], 0);\n\t\tp = func(t);\n\t\ta[p.first][p.second] = 1;\n\t\tp = func(u);\n\t\ta[p.first][p.second] = 2;\n\t\t\n\t\tprintf(\"%.8f\\n\", bfs(a, func(s), n));\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define rep(i,n) for(int i=0;i<n;i++)\n#define ck(a) (0<=(a)&&(a)<9)\nint di[]={-3,-1,1,3};\nint main(){\n    int n,s,t,b; char cs,ct,cb;\n    while(scanf(\"%d\",&n),n){\n        scanf(\" %c %c %c\",&cs,&ct,&cb); s=cs-'A', t=ct-'A', b=cb-'A';\n        double p[9]={0}; p[s]=1;\n         \n        while(n--){\n            double q[9]={0};\n            rep(i,9)rep(d,4){\n                if(ck(i+di[d])&&!(i%3==0&&di[d]==-1)&&!(i%3==2&&di[d]==1)&&i+di[d]!=b)q[i+di[d]]+=p[i]/4;\n                else q[i]+=p[i]/4;\n            }\n            rep(i,9)p[i]=q[i];\n        }\n         \n        printf(\"%.8f\\n\",p[t]);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#include \"stdio.h\"\n\nusing namespace std;\n\nint dx[] = {-1,0,1,0};\nint dy[] = {0,-1,0,1};\n\nint main(){\n\tint n;\n\tdouble prob[2][3][3];\n\tbool junk[3][3];\n\twhile(cin >> n, n){\n\t\tchar s, t, b; cin >> s >> t >> b;\n\t\tdouble ans = 0.0;\n\t\tfor(int i=0;i<2;i++)\n\t\t\tfor(int j=0;j<3;j++)\n\t\t\t\tfor(int k=0;k<3;k++) prob[i][j][k] = 0.0;\n\t\tprob[0][(s-'A')/3][(s-'A')%3] = 1.0;\n\t\tint gx = (t-'A')/3, gy = (t-'A')%3;\n\t\tmemset(junk, false, sizeof(junk));\n\t\tjunk[(b-'A')/3][(b-'A')%3] = true;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int x=0;x<3;x++)\n\t\t\t\tfor(int y=0;y<3;y++) prob[1-(i%2)][x][y] = 0.0;\n\t\t\tfor(int x=0;x<3;x++){\n\t\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\t\tfor(int d=0;d<n;d++){\n\t\t\t\t\t\tint nx = x+dx[d], ny = y+dy[d];\n\t\t\t\t\t\tif(nx<0||3<=nx||ny<0||3<=ny||junk[nx][ny]) {\n\t\t\t\t\t\t\tnx = x, ny = y;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tprob[1-(i%2)][nx][ny] += prob[i%2][x][y]*0.25;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\", prob[n%2][gx][gy]);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<utility>\n#include<queue>\nusing namespace std;\nint main()\n{\n\tint m[4]={3,-3,1,-1},buttery,s,t,b,ans=0;\n\tchar cs,ct,cb;\n\ttypedef pair <int,int> pa;\n\tqueue<pa> que;\n\tfor(;scanf(\"%d\",&buttery);ans=0)\n\t{\n\t\tif(buttery==0)\n\t\t\treturn 0;\n\t\tscanf(\"\\n%c %c %c\",&cs,&ct,&cb);\n\t\ts=cs-65;\n\t\tt=ct-65;\n\t\tb=cb-65;\n\t\tque.push(pa(buttery,s));\n\t\twhile(!que.empty())\n\t\t{\n\t\t\tpa temp=que.front();\n\t\t\tque.pop();\n\t\t\tif(--temp.first<0)\n\t\t\t{\n\t\t\t\tif(temp.second==t)\n\t\t\t\t\tans++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor(int i=0;i<4;i++)\n\t\t\t\t{\n\t\t\t\t\tif(temp.second+m[i]>=0 && temp.second+m[i]<9 && temp.second+m[i]!=b)\n\t\t\t\t\t\tque.push(pa(temp.first,temp.second+m[i]));\n\t\t\t\t\telse\n\t\t\t\t\t\tque.push(pa(temp.first,temp.second));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint tmp1=1<<(buttery*2);\n\t\tdouble tmp2=(double)ans/tmp1;\n\t\tprintf(\"%.8lf\\n\",tmp2);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nconst int dx[] = { 0, 0,+1,-1};\nconst int dy[] = {+1,-1, 0, 0};\n\nint main()\n{\n\tint N;\n\twhile(cin>>N, N)\n\t{\n\t\tchar S,T,B;\n\t\tcin>>S>>T>>B;\n\t\tint s=S-'A';\n\t\tint t=T-'A';\n\t\tint b=B-'A';\n\n\t\tdouble p[16][3][3]={0};\n\t\tp[0][s/3][s%3] = 1;\n\n\t\tfor(int i=1; i<=N; i++)\n\t\t{\n\t\t\tfor(int y=0; y<3; y++)\n\t\t\tfor(int x=0; x<3; x++)\n\t\t\tfor(int d=0; d<4; d++)\n\t\t\t{\n\t\t\t\tint nx=x+dx[d];\n\t\t\t\tint ny=y+dy[d];\n\n\t\t\t\tif(nx<0 || 3<=nx || ny<0 || 3<=ny)\n\t\t\t\t{ nx=x; ny=y; }\n\n\t\t\t\tif(nx==b%3 && ny==b/3)\n\t\t\t\t{ nx=x; ny=y; }\n\n\t\t\t\tp[i][ny][nx]+=p[i-1][y][x]/4;\n\t\t\t}\n\t\t}\n\n\t\tcout << p[N][t/3][t%3] << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <set>\n#include <map>\n#include <list>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <ctype.h>\n#include <ctime>\n#include <cstdio>\n#include <vector>\n#include <string>\n#include <bitset>\n#include <cctype>\n#include <cstdlib>\n#include <cstring>\n#include <utility>\n#include <numeric>\n#include <complex>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <cassert>\n#include <iostream>\n#include <iterator>\n#include <algorithm>\n\nusing namespace std;\n\n#define REP(i, x, n) for(int i = x; i < n; i++)\n#define rep(i, n) REP(i, 0, n)\n\n//4方向ベクトル→↑←↓\nint dx[] ={1,0,-1,0};\nint dy[] ={0,-1,0,1};\nint n;\nchar s;//最初にロボットがいる部屋\nchar t;//充電器のある部屋\nchar b;//倉庫として使っている部屋を示す大文字のアルファベット\nchar start;\nchar battery;\nchar souko;\nint nenryo;\nchar board[3][3]={\n  {'A','B','C'},\n  {'D','E','F'},\n  {'G','H','I'}\n};\nint main()\n{\n  srand(time(NULL));\n  while(cin>>n,n){\n\n  double ans = 0;\n  scanf(\" %c %c %c\", &s, &t, &b);\n  for(int k = 0;k < 9000000;k++){\n  int x;\n  int y;\n  start = s;\n  battery = t;\n  souko =b;\n  nenryo = n;\n  while(nenryo--){\n    for(int i = 0;i < 3;i++){\n      for(int j = 0;j < 3;j++){\n\tif(board[i][j] ==start){\n\t  x = j;\n\t  y = i;\n\t}\n      }\n    }\n    int ransu =rand()%4;\n    int nextx =x+dx[ransu];\n    int nexty =y+dy[ransu];\n    if(nexty <0||nextx >2||nexty <0||nexty >2||board[nexty][nextx] ==souko)\n      continue;\n    else\n      start = board[nexty][nextx];\n  }\n  if(start ==battery)\n    ans++;\n  }\n  printf(\"%f\\n\",ans/9000000);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <queue>\n\nusing namespace std;\nstatic const int MV = 100;\ntypedef pair<int, int> T;\n\nint main() {\n  while(1) {\n    int w, h, Gcount=0, sum=0;\n    cin >> w >> h;\n    if (w ==0 && h == 0) break;\n    char M[h][w];\n    int A[h][w];\n    queue<T> Q;\n    \n    for (int i=0;i<h;i++) {\n      for (int j=0;j<w;j++) {\n\tcin >> M[i][j];\n\tA[i][j]=MV;\n\tif (M[i][j] == '*')\n\t  Gcount++;\n\tif (M[i][j] == 'o'){\n\t  Q.push(make_pair(i, j));\n\t  A[i][j]=0;\n\t}\n      }\n    }\n\n    while(Gcount != 0 || Q.empty()) {\n      if(Q.empty()) break;\n      int Dy[4]={1, 0, -1, 0}, Dx[4]={0, 1, 0, -1}, ny, nx;\n      M[Q.front().first][Q.front().second]='+';\n      for (int i=0;i<4;i++) {\n\tny = Q.front().first + Dy[i]; nx = Q.front().second + Dx[i];\n\tif (M[ny][nx] == '.' && 0<=nx && nx<w && 0<=ny && ny<h) {\n\t  Q.push(make_pair(ny, nx));\n\t  M[ny][nx]='+';\n\t  A[ny][nx]=A[Q.front().first][Q.front().second] + 1;\n\t}\n\tif (M[ny][nx] == '*' && 0<=nx && nx<w && 0<=ny && ny<h) {\n\t  Gcount--;\n\t  M[ny][nx]='+';\n\t  sum+=A[Q.front().first][Q.front().second] + 1;\n\t  for (int j=0;j<h;j++) {\n\t    for (int k=0;k<w;k++) {\n\t      A[j][k]=MV;\n\t      if (M[j][k] == '+') {\n\t\tM[j][k] = '.';\n\t      }\n\t    }\n\t  }\n\t  int q=Q.size();\n\t  for (int j=1;j<q;j++) {\n\t    Q.pop();\n\t  }\n\t  Q.push(make_pair(ny, nx));\n\t  A[ny][nx] = 0;\n\t  i=4;\n\t}\n      }\n      Q.pop();\n    }\n    if(sum == 0) cout << -1 << endl;\n    else cout << sum << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nint xdir[4] = {0, 1, 0, -1}, ydir[4] = {1, 0, -1, 0};\nint main()\n{\n\tint n, p, q;\n\tlong double a[3][3][16];\n\tchar s, t, b, alp[3][3];\n\t\n\tfor(int i = 0; i < 3; i++){\n\t\tfor(int j = 0; j < 3; j++){\n\t\t\talp[i][j] = (char)('A'+(i*3+j));\n\t\t}\n\t}\n\t\n\twhile(cin>>n && n){\n\t\tcin >> s >> t >> b;\n\t\tfill(&a[0][0][0], &a[2][2][n], 0);\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tif(alp[i][j] == s){\n\t\t\t\t\tp = i;\n\t\t\t\t\tq = j;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\ta[p][q][0] = 1.0;\n\t\t\n\t\tfor(int k = 0; k < n; k++){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\t\tfor(int l = 0; l < 4; l++){\n\t\t\t\t\t\tint dx = j+xdir[l], dy = i+ydir[l];\n\t\t\t\t\t\tif(0 <= dx && dx < 3 && 0 <= dy && dy < 3 && alp[dy][dx] != b){\n\t\t\t\t\t\t\ta[dy][dx][k+1] += a[i][j][k]/4.0;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ta[i][j][k+1] += a[i][j][k]/4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tif(alp[i][j] == t){\n\t\t\t\t\tp = i;\n\t\t\t\t\tq = j;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tprintf(\"%.8Lf\\n\", a[p][q][n]);\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "// AOJ 1020\n#include<iostream>\n#include<iomanip>\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\nusing namespace std;\n\ntypedef long double number;\nint n;\nint sx, sy, tx, ty, bx, by;\nnumber room[3][3];\n\nvoid init() {\n  REP(x, 3) REP(y, 3) {\n    room[x][y] = 0;\n  }\n  room[sx][sy] = 1;\n}\n\nbool is_depot(int x, int y) {\n  return x == bx && y == by;\n}\n\nnumber in(int x, int y) {\n  if (x < 0 or 2 < x or y < 0 or 2 < y) return 0;\n  if (is_depot(x, y)) return 0;\n  return room[x][y];\n}\n\nnumber solve() {\n  init();\n  REP(i, n) {\n    number future[3][3];\n    REP(x, 3) REP(y,3) {\n      if (is_depot(x, y)) {\n        future[x][y] = 0;\n        continue;\n      }\n\n      future[x][y] = \n        in(x + 1, y) / 4 + in(x - 1, y) / 4 +\n        in(x, y + 1) / 4 + in(x, y - 1) / 4;\n    }\n    REP(y, 3) {\n      REP(x, 3) {\n        room[x][y] = future[x][y];\n//        cout << (is_depot(x, y) ? -1 : room[x][y]) << \"\\t\";\n      }\n//      cout << endl;\n    }\n  }\n  return room[tx][ty];\n}\n\nint room2x(char r) {\n  switch (r) {\n    case 'A': case 'D': case 'G':\n      return 0; break;\n    case 'B': case 'E': case 'H':\n      return 1; break;\n    case 'C': case 'F': case 'I':\n      return 2; break;\n    default:\n      break;\n  }\n}\n\nint room2y(char r) {\n  switch (r) {\n    case 'A': case 'B': case 'C':\n      return 0; break;\n    case 'D': case 'E': case 'F':\n      return 1; break;\n    case 'G': case 'H': case 'I':\n      return 2; break;\n    default:\n      break;\n  }\n}\n\nint main() {\n  while (cin >> n and n) {\n    char s, t, b;\n    cin >> s >> t >> b;\n    sx = room2x(s); sy = room2y(s);\n    tx = room2x(t); ty = room2y(t);\n    bx = room2x(b); by = room2y(b);\n\n    cout << fixed << setprecision(10) << solve() << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <queue>\n\nusing namespace std;\nstatic const int MV = 100;\ntypedef pair<int, int> T;\n\nint main() {\n  while(1) {\n    int w, h, Gcount=0, sum=0;\n    cin >> w >> h;\n    if (w ==0 && h == 0) break;\n    char M[h][w];\n    int A[h][w];\n    queue<T> Q;\n    \n    for (int i=0;i<h;i++) {\n      for (int j=0;j<w;j++) {\n\tcin >> M[i][j];\n\tA[i][j]=MV;\n\tif (M[i][j] == '*')\n\t  Gcount++;\n\tif (M[i][j] == 'o'){\n\t  Q.push(make_pair(i, j));\n\t  A[i][j]=0;\n\t}\n      }\n    }\n\n    while(Gcount != 0 || Q.empty()) {\n      if(Q.empty()) break;\n      int Dy[4]={1, 0, -1, 0}, Dx[4]={0, 1, 0, -1}, ny, nx;\n      M[Q.front().first][Q.front().second]='+';\n      for (int i=0;i<4;i++) {\n\tny = Q.front().first + Dy[i]; nx = Q.front().second + Dx[i];\n\tif (M[ny][nx] == '.' && 0<=nx && nx<w && 0<=ny && ny<h) {\n\t  Q.push(make_pair(ny, nx));\n\t  M[ny][nx]='+';\n\t  A[ny][nx]=A[Q.front().first][Q.front().second] + 1;\n\t}\n\tif (M[ny][nx] == '*' && 0<=nx && nx<w && 0<=ny && ny<h) {\n\t  Gcount--;\n\t  M[ny][nx]='+';\n\t  sum+=A[Q.front().first][Q.front().second] + 1;\n\t  for (int j=0;j<h;j++) {\n\t    for (int k=0;k<w;k++) {\n\t      A[j][k]=MV;\n\t      if (M[j][k] == '+') {\n\t\tM[j][k] = '.';\n\t      }\n\t    }\n\t  }\n\t  int q=Q.size();\n\t  for (int j=1;j<q;j++) {\n\t    //while(!Q.empty()) {\n\t    Q.pop();\n\t  }\n\t  Q.push(make_pair(ny, nx));\n\t  A[ny][nx] = 0;\n\t  i=4;\n\t}\n      }\n      /*    \n\t    for (int i=0;i<h;i++) {\n\t    for (int j=0;j<w;j++) {\n\t    cout << A[i][j] << \"      \";\n\t    }cout << endl;\n\t    }\n\t    cout << endl;\n      */\n      \n      Q.pop();\n    }\n    if(sum == 0) cout << -1 << endl;\n    else cout << sum << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdlib.h>\n#include<iostream>\n#include<stdio.h>\n#include<string.h>\n#include<math.h>\n#include<algorithm>\n#include<cstring>\n#include<queue>\nusing namespace std;\nint s,t,b,n;\ndouble p,p1,nn;\nint d[4]={1,3,-1,-3};\ndouble df[10][20];\nvoid dfs(int s,int n){\n    if(n==0){\n        if(s==t){p+=pow(0.25,nn);}\n        return;\n    }else{\n\t\tif(df[s][n]>=0){\n\t\t\tp+=df[s][n];\n\t\t\treturn;\n\t\t}else{\n\t\t    for(int i=0;i<4;i++){\n\t            if(s+d[i]==b){\n\t\t\t\t\tp1=p;\n\t\t\t\t    dfs(s,n-1);\n\t\t\t        df[s][n-1]=p-p1;\n\t\t        }else if((s/3!=(s+d[i])/3)||s+d[i]<0){\n\t\t\t\t    if((d[i]==3||d[i]==-3)&&0<=s+d[i]&&s+d[i]<9){\n\t\t\t\t        p1=p;\n\t\t\t\t\t\tdfs(s+d[i],n-1);\n\t\t\t\t\t    df[s+d[1]][n-1]=p-p1;\n\t\t\t\t    }else{\n\t\t\t            p1=p;\n\t\t                dfs(s,n-1);\n\t                    df[s][n-1]=p-p1;\n\t\t\t\t    }\n\t\t\t    }else{\n\t\t\t\t\t p1=p;\n\t\t\t\t    dfs(s+d[i],n-1);\n\t\t\t\t    df[s+d[i]][n-1]=p-p1;\n\t\t\t    }\n\t\t    }\n\t\t}\n\t}\n    return;\n}\n\nint main(){\n    while(1){\n        char cs,ct,cb;\n        p=0;\n        cin>>n;\n        nn=n;\n        if(n==0)break;\n        for(int i=0;i<10;i++){\n            for(int j=0;j<20;j++){\n                df[i][j]=-1;\n            }\n        }\n        cin>>cs>>ct>>cb;\n        s=(int)cs-'A';\n        t=(int)ct-'A';\n        b=(int)cb-'A';\n        dfs(s,n);\n        cout<<p<<endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef pair<int, int> pii;\n\npii get_pos(int x)\n{\n    return pii(x / 3, x % 3);\n}\n\nbool inField(int x, int y)\n{\n    return (0 <= x && x < 3 && 0 <= y && y < 3);\n}\n\nint main()\n{\n    int N;\n    while (cin >> N, N) {\n        string S = \"ABCDEFGHI\";\n        char a[3];\n        for (int i = 0; i < 3; i++) {\n            cin >> a[i];\n        }\n        int s = S.find(a[0]);\n        int t = S.find(a[1]);\n        int b = S.find(a[2]);\n\n        double dp[25][9] = {{}};\n        pii p = get_pos(b);\n\n        dp[0][s] = 1;\n        \n        const int di[] = {-1, +0, +1, +0};\n        const int dj[] = {+0, -1, +0, +1};\n        \n        for (int i = 0; i < N; i++) {\n            for (int j = 0; j < 9; j++) {\n                if (dp[i][j] == 0) continue;\n                pii n = get_pos(j);\n                for (int k = 0; k < 4; k++) {\n                    int ni = n.first + di[k];\n                    int nj = n.second + dj[k];\n                    if (!inField(nj, ni) || (pii(ni, nj) == p)) {\n                        dp[i+1][j] += dp[i][j] / 4;\n                    } else {\n                        dp[i+1][ni*3+nj] += dp[i][j] / 4;\n                    }\n                }\n            }\n        }\n        printf(\"%.10f\\n\", dp[N][t]);            \n    }    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#include<iostream>\n#include<string.h>\n#include<math.h>\n#include<algorithm>\n#include<cstring>\n#include<queue>\nusing namespace std;\n#define INF 100000000\nint s,t,b,n;\ndouble p,nn;\nint d[4]={1,3,-1,-3};\ndouble df[9][16];\n\nint max(int a,int b){\n\tif(a>b){\n\t\treturn a;\n\t}else{\n\t\treturn b;\n\t}\n}\nvoid dfs(int s,int n){\n\tint p1;\n\tif(n==0){\n\t\tif(s==t)p+=pow(0.25,nn);\n\t\treturn;\n\t}\n\tif(df[s][n]>=0){\n\t\tp+=df[s][n];\n\t\treturn;\n\t}else{\n\t\tfor(int i=0;i<4;i++){\n\t\t\tif(s+d[i]==b){\n\t\t\t\tp1=p;\n\t\t\t\tdfs(s,n-1);\n\t\t\t\tdf[s][n-1]=p-p1;\n\t\t\t}else if(s/3!=(s+d[i])/3){//3で割った値に注目するのがポイント\n\t\t\t\tif(d[i]*d[i]==9&&0<=s+d[i]&&s+d[i]<9){\n\t\t\t\t\tp1=p;\n\t\t\t\t\tdfs(s+d[i],n-1);\n\t\t\t\t\tdf[s+d[1]][n-1]=p-p1;\n\t\t\t\t}else{\n\t\t\t\t\tp1=p;\n\t\t\t\t\tdfs(s,n-1);\n\t\t\t\t\tdf[s][n-1]=p-p1;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tp1=p;\n\t\t\t\tdfs(s+d[i],n-1);\n\t\t\t\tdf[s+d[i]][n-1]=p-p1;\n\t\t\t}\n\t\t}\n\t}\n\treturn;\n}\nint main(){\n\twhile(1){\n\t\tchar cs,ct,cb;\n\t\tp=0;\n\t\tcin>>n;\n\t\tnn=n;\n\t\tif(n==0)break;\n\t\tfor(int i=0;i<9;i++){\n\t\t\tfor(int j=0;j<16;j++){\n\t\t\t\tdf[i][j]=-1;\n\t\t\t}\n\t\t}\n\t\tcin>>cs>>ct>>cb;\n\t\ts=(int)cs-'A';\n\t\tt=(int)ct-'A';\n\t\tb=(int)cb-'A';\n\t\tdfs(s,n);\n\t\tcout<<p<<endl;\n\t}\n\treturn 0;\n}\t"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <stdio.h>\nusing namespace std;\nint date[9][5]={\n\t{2,1,3,0,0},\n\t{3,0,2,4,1},\n\t{2,1,5,2,2},\n\t{3,0,4,6,3},\n\t{4,1,3,5,7},\n\t{3,2,4,8,5},\n\t{2,3,7,6,6},\n\t{3,4,6,8,7},\n\t{2,5,7,8,8}\n};\nint main(){\n\tint n;\n\twhile(cin>>n,n){\n\t\tlong double dp[16][9]={0.0};\n\t\tint s,t,b;\n\t\tchar S,T,B;\n\t\tcin>>S>>T>>B;\n\t\ts=S-'A';\n\t\tt=T-'A';\n\t\tb=B-'A';\n\t\tdp[0][s]=1.0;\n\t\t\n\t\t\n\t\tfor(int i=0;i<15;i++){\n\t\t\tfor(int j=0;j<9;j++){\n\t\t\t\tfor(int k=1;k<=4;k++){\n\t\t\t\t\tif(date[j][k]!=b){\n\t\t\t\t\t\tdp[i+1][date[j][k]]+=dp[i][j]*0.25;\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tdp[i+1][j]+=dp[i][j]*0.25;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//cout<<dp[n][t]<<endl;\n\t\tprintf(\"%.8Lf\\n\",dp[n][t]);\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\nvoid solve(char n, double m[5][5] ){\n\tfor( ; n>0 ; n-- ){\n\t\tdouble tmp[5][5] = {0};\n\t\t\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] > 0.0 ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\ttmp[my][mx] += m[y][x]/4.0;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmp[y][x] += m[y][x]/4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//m[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = tmp[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tint n;\n\tchar s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A'] = i%3+1;\n\t\tfy[i+'A'] = i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d\", &n) , n ){\n\t\tscanf(\" %c %c %c \", &s, &t, &b);\n\t\t//cin >> s >> t >> b;\n\t\tdouble m[5][5] = {0};\n\t\tfor(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\t//m[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1.0;\n\t\t\n\t\tsolve( n , m );\n\t\t\n\t\t//debug( m );\n\t\tprintf(\"%.9f\\n\" , m[ fy[t] ][ fx[t] ] );\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define LL long long\n#define VI vector<int>\n#define VVI vector<vector<int>>\n#define VVVI vector<vector<vector<int>>>\n#define VL vector<LL>\n#define VVL vector<vector<LL>>\n#define VVVL vector<vector<vector<LL>>>\n#define VB vector<bool>\n#define FOR(i,a,b) for(int i= (a); i<((int)b); ++i)\n#define RFOR(i,a) for(int i=(a); i >= 0; --i)\n#define FOE(i,a) for(auto i : a)\n#define ALL(c) (c).begin(), (c).end()\n#define RALL(c) (c).rbegin(), (c).rend()\n#define DUMP(x)  cerr << #x << \" = \" << (x) << endl;\n#define SUM(x) std::accumulate(ALL(x), 0LL)\n#define MIN(v) *std::min_element(v.begin(), v.end())\n#define MAX(v) *std::max_element(v.begin(), v.end())\n#define EXIST(v,x) (std::find(v.begin(), v.end(), x) != v.end())\n#define BIT(n) (1LL<<(n))\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end());\n#define EPS 1e-14\n\ntemplate<class T> T ceil(T a, T b) { return (a + b - 1) / b; }\ntemplate<class T> void print(T x) { std::cout << x << std::endl; }\nbool inside(int y, int x, int H, int W) {return 0 <= y and y < H and 0 <= x and x < W; }\n\nconst std::string YES = \"YES\", Yes = \"Yes\", NO = \"NO\", No = \"No\";\nconst std::vector<int> dy = { 0, 1, 0, -1 }, dx = { 1, 0, -1, 0 };    // 4近傍（右, 下, 左, 上）\n\n\nusing namespace std;\n\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while (true) {\n        int N;\n        cin >> N;\n        if (N == 0) { break; }\n        char S, T, B;\n        cin >> S >> T >> B;\n        int sy = (S - 'A') / 3;\n        int sx = (S - 'A') % 3;\n        int ty = (T - 'A') / 3;\n        int tx = (T - 'A') % 3;\n        int by = (B - 'A') / 3;\n        int bx = (B - 'A') % 3;\n\n        vector<vector<vector<double>>> dp(N + 1, vector<vector<double>>(3, vector<double>(3, 0)));\n        dp[N][sy][sx] = 1;\n\n        queue<tuple<int, int, int>> que;\n        que.push(make_tuple(N, sy, sx));\n\n        while (not que.empty()) {\n            int rest, y, x;\n            tie(rest, y, x) = que.front(); que.pop();\n            if (rest == 0) {\n                continue;\n            }\n\n            FOR(i, 0, 4) {\n                int ny = y + dy[i];\n                int nx = x + dx[i];\n\n                if (inside(ny, nx, 3, 3) and not (ny == by and nx == bx)) {\n                    dp[rest - 1][ny][nx] += dp[rest][y][x] * 0.25;\n                    que.push(make_tuple(rest - 1, ny, nx));\n                }\n                else {\n                    dp[rest - 1][y][x] += dp[rest][y][x] * 0.25;\n                    que.push(make_tuple(rest - 1, y, x));\n                }\n            }\n        }\n        print(dp[0][ty][tx]);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define FOR(i,a,b) for(int i= (a); i<((int)b); ++i)\n#define RFOR(i,a) for(int i=(a); i >= 0; --i)\n#define FOE(i,a) for(auto i : a)\n#define ALL(c) (c).begin(), (c).end()\n#define RALL(c) (c).rbegin(), (c).rend()\n#define DUMP(x)  cerr << #x << \" = \" << (x) << endl;\n#define SUM(x) std::accumulate(ALL(x), 0LL)\n#define MIN(v) *std::min_element(v.begin(), v.end())\n#define MAX(v) *std::max_element(v.begin(), v.end())\n#define EXIST(v,x) (std::find(v.begin(), v.end(), x) != v.end())\n#define BIT(n) (1LL<<(n))\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end());\n\ntypedef long long LL;\ntemplate<typename T> using V = std::vector<T>;\ntemplate<typename T> using VV = std::vector<std::vector<T>>;\ntemplate<typename T> using VVV = std::vector<std::vector<std::vector<T>>>;\n\ntemplate<class T> inline T ceil(T a, T b) { return (a + b - 1) / b; }\ntemplate<class T> inline void print(T x) { std::cout << x << std::endl; }\ntemplate<class T> inline void print_vec(const std::vector<T> &v) { for (int i = 0; i < v.size(); ++i) {  if (i != 0) {std::cout << \" \";} std::cout << v[i];} std::cout << \"\\n\"; }\ntemplate<class T> inline bool inside(T y, T x, T H, T W) {return 0 <= y and y < H and 0 <= x and x < W; }\ntemplate<class T> inline double euclidean_distance(T y1, T x1, T y2, T x2) { return sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2)); }\ntemplate<class T> inline double manhattan_distance(T y1, T x1, T y2, T x2) { return abs(x1 - x2) + abs(y1 - y2); }\n\nconst int INF = 1L << 30;\nconst double EPS = 1e-9;\nconst std::string YES = \"YES\", Yes = \"Yes\", NO = \"NO\", No = \"No\";\nconst std::vector<int> dy4 = { 0, 1, 0, -1 }, dx4 = { 1, 0, -1, 0 };    // 4近傍（右, 下, 左, 上）\nconst std::vector<int> dy8 = { 0, -1, 0, 1, 1, -1, -1, 1 }, dx8 = { 1, 0, -1, 0, 1, 1, -1, -1 };\n\nusing namespace std;\n\n\nint main() {\n    cin.tie(0);\n\tios::sync_with_stdio(false);\n\n\twhile (true) {\n        int N;\n        char S, T, B;\n        cin >> N;\n        if (N == 0) {\n            break;\n        }\n        cin >> S >> T >> B;\n\n        map<char, pair<int, int>> d;\n        FOR(y, 0, 3) {\n            FOR(x, 0, 3) {\n                d['A' + 3 * y + x] = make_pair(y, x);\n            }\n        }\n        int sy = d[S].first, sx = d[S].second;\n        int ey = d[T].first, ex = d[T].second;\n        int by = d[B].first, bx = d[B].second;\n\n        vector<vector<vector<double>>> dp(N + 1, vector<vector<double>>(3, vector<double>(3)));\n        dp[N][sy][sx] = 1;\n\n        for (int n = N; n > 0; --n) {\n            FOR(y, 0, 3) {\n                FOR(x, 0, 3) {\n                    if (dp[n][y][x] == 0) {\n                        continue;\n                    }\n\n                    FOR(i, 0, 4) {\n                        int ny = dy4[i] + y;\n                        int nx = dx4[i] + x;\n\n                        if (not inside(ny, nx, 3, 3)) {\n                            continue;\n                        }\n\n                        if (ny == by and nx == bx) {\n                            dp[n - 1][y][x] += dp[n][y][x] * 0.25;\n                        }\n                        else {\n                            dp[n - 1][ny][nx] += dp[n][y][x] * 0.25;\n                        }\n                    }\n                }\n            }\n        }\n\n        cout << fixed << setprecision(7) << dp[0][ey][ex] << endl;\n    }\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\ntypedef vector <int> VI;\ntypedef vector <VI> VVI;\n\nconst int dx[4] = { 0, 0, 1, -1 };\nconst int dy[4] = { 1, -1, 0, 0 };\n\nint get_x( char c )\n{\n\tif ( c == 'A' || c == 'D' || c == 'G' ) return 0;\n\tif ( c == 'B' || c == 'E' || c == 'H' ) return 1;\n\tif ( c == 'C' || c == 'F' || c == 'I' ) return 2;\n\treturn -1;\n}\n\nint get_y( char c )\n{\n\tif ( c == 'A' || c == 'B' || c == 'C' ) return 0;\n\tif ( c == 'D' || c == 'E' || c == 'F' ) return 1;\n\tif ( c == 'G' || c == 'H' || c == 'I' ) return 2;\n\treturn -1;\n}\n\n\nint main( void )\n{\n\tint n; char s, t, b;\n\twhile ( 1 )\n\t{\n\t\tcin >> n;\n\t\tif ( n == 0 ) break;\n\t\tcin >> s >> t >> b;\n\n\t\tint sx, sy, gx, gy, ox, oy;\n\t\tsx = get_x( s ); sy = get_y( s );\n\t\tgx = get_x( t ); gy = get_y( t );\n\t\tox = get_x( b ); oy = get_y( b );\n\n\t\tVVI prev( 3, VI(3,0) ), next;\n\t\tprev[sx][sy] = 1;\n\t\tfor ( int lpc = 0; lpc < n; lpc++ )\n\t\t{\n\t\t\tnext = VVI( 3, VI( 3, 0 ) );\n\t\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ )\n\t\t\t{\n\t\t\t\tif ( i == oy && j == ox ) continue;\n\t\t\t\tbool stop = false;\n\t\t\t\tfor ( int k = 0; k < 4; k++ )\n\t\t\t\t{\n\t\t\t\t\tint nx = j + dx[k];\n\t\t\t\t\tint ny = i + dy[k];\n\t\t\t\t\tif ( nx < 0 || nx >= 3 || ny < 0 || ny >= 3 )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop = true;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\telse if ( nx == ox && ny == oy )\n\t\t\t\t\t{\n\t\t\t\t\t\tstop = true;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tnext[i][j] += prev[ny][nx];\n\t\t\t\t}\n\t\t\t\tif ( stop )\n\t\t\t\t{\n\t\t\t\t\tnext[i][j] += prev[i][j];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tprev = next;\n\t\t}\n\n\t\tint sum = 0;\n\t\tfor ( int i = 0; i < 3; i++ ) for ( int j = 0; j < 3; j++ ) sum += next[i][j];\n\n\t\tdouble answer = (double)next[gy][gx] / (double)sum;\n\n\t\tcout.setf( ios::fixed );\n\t\tcout << answer << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <queue>\n\nusing namespace std;\n\ntypedef long double ld;\n\nconst int EMPTY   = 0;\nconst int BATTERY = 1;\nconst int STORE   = 2;\nconst int WALL    = 3;\n\nstruct Point {\npublic:\n  int x, y;\n  Point() { }\n  Point(int x, int y): x(x), y(y) { }\n};\n\nstruct State {\npublic:\n  Point p;\n  int battery;\n  State() { };\n  State(Point p, int battery): p(p), battery(battery) { }\n};\n\nPoint int2point(int n) {\n  return Point(1 + n % 3, 1 + n / 3);\n}\n\nint field[5][5];\n\nld dp[16][5][5];\nint main() {\n  int n, s, t, b;\n  while (true) {\n    cin >> n;\n    if (n == 0) break;\n    char cs, ct, cb;\n    cin >> cs >> ct >> cb;\n    s = cs - 'A';\n    t = ct - 'A';\n    b = cb - 'A';\n    \n    memset(field, EMPTY, sizeof(field));\n    memset(dp, 0, sizeof(dp));\n    for (int i = 0; i < 5; i++) {\n      field[0][i] = WALL;\n      field[4][i] = WALL;\n      field[i][0] = WALL;\n      field[4][i] = WALL;\n    }\n    Point batteryPoint = int2point(t);\n    field[batteryPoint.x][batteryPoint.y] = BATTERY;\n    Point storePoint = int2point(b);\n    field[storePoint.x][storePoint.y] = STORE;\n    State nowState(int2point(s), n);\n\n    dp[0][nowState.p.x][nowState.p.y] = 1.0f;\n    int dx[] ={1,0,-1,0},dy[] ={0,1,0,-1};\n    for(int i = 0; i < nowState.battery; i++){\n      for(int j = 1; j <= 3; j++){\n        for(int k = 1; k <= 3; k++){\n          for(int l = 0;l < 4; l++){\n            int nx = j + dx[l], ny = k + dy[l];\n            if(field[nx][ny] == STORE || field[nx][ny] == WALL) {\n              nx = j, ny = k;\n            }\n            dp[i+1][nx][ny] += dp[i][j][k] / 4.0;\n          }\n        }\n      }\n    }\n    printf(\"%.15llf\\n\", dp[nowState.battery][batteryPoint.x][batteryPoint.y]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <set>\n#include <map>\n#include <list>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <ctype.h>\n#include <ctime>\n#include <cstdio>\n#include <vector>\n#include <string>\n#include <bitset>\n#include <cctype>\n#include <cstdlib>\n#include <cstring>\n#include <utility>\n#include <numeric>\n#include <complex>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <cassert>\n#include <iostream>\n#include <iterator>\n#include <algorithm>\n\nusing namespace std;\n//参考http://topcoder.g.hatena.ne.jp/isa_rentacs/20111114/1321278656 \n#define REP(i, x, n) for(int i = x; i < n; i++)\n#define rep(i, n) REP(i, 0, n)\n#define lengthof(x) (sizeof(x) / sizeof(*(x)))\n#define FILL(ptr, value) FILL_((ptr), sizeof(ptr)/sizeof(value), (value))\ntemplate <typename T>\nvoid FILL_(void * ptr, size_t size, T value){\n  std::fill((T*)ptr, (T*)ptr+size, value);\n}\n//4方向ベクトル→↑←↓\nint dx[] ={1,0,-1,0};\nint dy[] ={0,-1,0,1};\n\ndouble dp[16][9];\nint dir[4] = {1,3,-1,-3};\nint main()\n{\n  int n;\n  while(cin >>n,n){\n    fill((int*)dp,(int*)(dp+lengthof(dp)),0);\n    char temp;\n    int s,t,b,x,y;\n    cin >>temp;\n    s =temp -'A';\n    cin >>temp;\n    t =temp -'A';\n    cin >>temp;\n    b = temp -'A';\n    dp[0][s] = 1;\n    for(int i = 0;i < n;i++){\n      for(int j = 0;j < 9;j++){\n\tif(dp[i][j] ==0)\n\t  continue;\n\tx =j%3;\n\ty = j/3;\n\tfor(int k = 0;k < 4;k++){\n\t  if(0 <=x+dx[k]&&x +dx[k] < 3&&0 <=y +dy[k]&&y +dy[k] <3&&j+dir[k] !=b)\n\t    dp[i+1][j+dir[k]] +=dp[i][j]*0.25;\n\t  else\n\t    dp[i+1][j] +=dp[i][j]*0.25;\n\t}\n      }\n    }\n    printf(\"%.8f\",dp[n][t]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <math.h>\n#include <bitset>\n#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <iomanip>\n#include <iostream>\n\n#define VARIABLE(x) cerr << #x << \"=\" << x << endl\n#define BINARY(x) cerr << #x << \"=\" << static_cast<bitset<16> >(x) << endl;\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define REP(i,m,n) for (int i=m;i<(int)(n);i++)\n#define if_range(x, y, w, h) if (0<=(int)(x) && (int)(x)<(int)(w) && 0<=(int)(y) && (int)(y)<(int)(h))\n\nconst int INF = 100000000;\ntypedef double D;\nconst D EPS = 1e-8;\nconst double PI = 3.14159;\nint dx[4]={-1, 0, 1, 0}, dy[4]={0, -1, 0, 1};\nusing namespace std;\ntypedef pair<int, int> PII;\n\n/** Problem1020 : Cleaning Robot **/\nstruct  P {\n\tint x, y;\n\tP() {}\n\tP(int x_, int y_) : x(x_), y(y_) {}\n};\n\nint main()\n{\n\tdouble dp[16][3][3];\n\tP s, b, t;\n\tint N;\n\tchar S, T, B;\n\twhile (cin>>N, N) {\n\t\tcin>>S>>T>>B;\n\t\tmemset(dp, 0, sizeof(dp));\n\t\t\n\t\ts.x = (S-'A')%3;\n\t\ts.y = (S-'A')/3;\n\t\tb.x = (B-'A')%3;\n\t\tb.y = (B-'A')/3;\n\t\tt.x = (T-'A')%3;\n\t\tt.y = (T-'A')/3;\n\t\t\n\t\tdp[0][t.x][t.y]=1;\n\t\t\n\t\tREP(i, 1, N+1) {\n\t\t\trep(y, 3) {\n\t\t\t\trep(x, 3) {\n\t\t\t\t\trep(j, 4) {\n\t\t\t\t\t\tint ox = x+dx[j], oy=y+dy[j];\n\t\t\t\t\t\tif_range(ox, oy, 3, 3) {\n\t\t\t\t\t\t\tif (b.x==ox && b.y == oy) {\n\t\t\t\t\t\t\t\tox = x; oy=y;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tox = x; oy = y;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdp[i][x][y] += dp[i-1][ox][oy]*0.25;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8f\\n\", dp[N][s.x][s.y]);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <queue>\n\nusing namespace std;\n\nconst int EMPTY   = 0;\nconst int BATTERY = 1;\nconst int STORE   = 2;\nconst int WALL    = 3;\n\nstruct Point {\npublic:\n  int x, y;\n  Point() { }\n  Point(int x, int y): x(x), y(y) { }\n};\n\nstruct State {\npublic:\n  Point p;\n  int battery;\n  State() { };\n  State(Point p, int battery): p(p), battery(battery) { }\n};\n\nPoint int2point(int n) {\n  return Point(1 + n % 3, 1 + n / 3);\n}\n\nint field[5][5];\n\nstruct Bunsu {\npublic:\n  int bunbo;\n  int bunsi;\n  Bunsu() { }\n  Bunsu(int a, int b): bunbo(a), bunsi(b) { }  \n  Bunsu operator+=(const Bunsu& b) {\n    this->bunbo += b.bunbo;\n    this->bunsi += b.bunsi;\n    return *this;\n  }\n};\n\nBunsu memo[5][5][16];\nbool memo_b[5][5][16];\n\nBunsu calc(State s) {\n  Bunsu ret = Bunsu(0, 0);\n  if (memo_b[s.p.x][s.p.y][s.battery]) {\n    return memo[s.p.x][s.p.y][s.battery];\n  }\n  if (s.battery == 0) {\n    if (field[s.p.x][s.p.y] == BATTERY) {\n      ret.bunsi++;\n    }\n    ret.bunbo++;\n    return ret;\n  }\n  int dx[4] = { 0, -1, 1, 0 };\n  int dy[4] = { -1, 0, 0, 1 };\n  for (int i = 0; i < 4; i++) {\n    Point np = Point(s.p.x + dx[i], s.p.y + dy[i]);\n    if (field[np.x][np.y] == STORE) {\n      ret += calc(State(s.p, s.battery - 1));\n      continue;\n    }\n    if (field[np.x][np.y] == WALL) {\n      ret += calc(State(s.p, s.battery - 1));\n      continue;\n    }\n    ret += calc(State(np, s.battery - 1));\n  }\n  memo_b[s.p.x][s.p.y][s.battery] = true;\n  return memo[s.p.x][s.p.y][s.battery] = ret;\n}\n\nint main() {\n  int n, s, t, b;\n  while (true) {\n    cin >> n;\n    if (n == 0) break;\n    char cs, ct, cb;\n    cin >> cs >> ct >> cb;\n    s = cs - 'A';\n    t = ct - 'A';\n    b = cb - 'A';\n    \n    memset(field, EMPTY, sizeof(field));\n    for (int i = 0; i < 5; i++) {\n      for (int j = 0; j < 5; j++) {\n        for (int k = 0; k < 16; k++) {\n          memo[i][j][k] = Bunsu(0, 0);\n          memo_b[i][j][k] = false;\n        }\n      }\n    }\n    for (int i = 0; i < 5; i++) {\n      field[0][i] = WALL;\n      field[4][i] = WALL;\n      field[i][0] = WALL;\n      field[4][i] = WALL;\n    }\n    Point batteryPoint = int2point(t);\n    field[batteryPoint.x][batteryPoint.y] = BATTERY;\n    Point storePoint = int2point(b);\n    field[storePoint.x][storePoint.y] = STORE;\n    State nowState(int2point(s), n);\n    \n    Bunsu ans = calc(nowState);\n    printf(\"%.32llf\\n\", (long double)ans.bunsi / ans.bunbo);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\nusing namespace std;\n\n#define loop(i,a,b) for(int i=(a); i<int(b); i++)\n#define rep(i,b) loop(i,0,b)\n\ndouble dp[111][3][3];\nint const dx[]={1,0,0,-1};\nint const dy[]={0,1,-1,0};\n\nbool ok(int x, int y, int b){\n    return 0<=x&&x<3&&0<=y&&y<3 && x*3+y!=b;\n}\n\nint main(){\n    int n;;\n    while(cin>>n && n){\n        char s,t,b;\n        cin>>s>>t>>b;\n        memset(dp,0,sizeof(dp));\n        int S=s-'A';\n        int T=t-'A';\n        int B=b-'A';\n        dp[0][S/3][S%3]=1;\n        rep(i,n){\n            rep(x,3)rep(y,3){\n                rep(d,4){\n                    int nx=x+dx[d];\n                    int ny=y+dy[d];\n                    if(!ok(nx,ny,B)) dp[i+1][x][y]+=dp[i][x][y]/4;\n                    else dp[i+1][nx][ny] += dp[i][x][y]/4;\n                }\n            }\n        }\n        printf(\"%.10lf\\n\",dp[n][T/3][T%3]);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <set>\n#include <map>\n#include <list>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <ctype.h>\n#include <ctime>\n#include <cstdio>\n#include <vector>\n#include <string>\n#include <bitset>\n#include <cctype>\n#include <cstdlib>\n#include <cstring>\n#include <utility>\n#include <numeric>\n#include <complex>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <cassert>\n#include <iostream>\n#include <iterator>\n#include <algorithm>\n\nusing namespace std;\n//参考http://topcoder.g.hatena.ne.jp/isa_rentacs/20111114/1321278656 \n#define REP(i, x, n) for(int i = x; i < n; i++)\n#define rep(i, n) REP(i, 0, n)\n#define lengthof(x) (sizeof(x) / sizeof(*(x)))\n#define FILL(ptr, value) FILL_((ptr), sizeof(ptr)/sizeof(value), (value))\ntemplate <typename T>\nvoid FILL_(void * ptr, size_t size, T value){\n  std::fill((T*)ptr, (T*)ptr+size, value);\n}\n//4方向ベクトル→↑←↓\nint dx[] ={1,0,-1,0};\nint dy[] ={0,-1,0,1};\n\ndouble dp[16][9];\nint dir[4] = {1,3,-1,-3};\nint main()\n{\n  int n;\n  while(cin >>n,n){\n    FILL(dp,0);\n    char temp;\n    int s,t,b,x,y;\n    cin >>temp;\n    s =(int)(temp -'A');\n    cin >>temp;\n    t =(int)(temp -'A');\n    cin >>temp;\n    b = (int)(temp -'A');\n    dp[0][s] = 1;\n    for(int i = 0;i < n;i++){\n      for(int j = 0;j < 9;j++){\n\tif(dp[i][j] ==0)\n\t  continue;\n\tx = j%3;\n\ty = j/3;\n\tfor(int k = 0;k < 4;k++){\n\t  if(0 <=x+dx[k]&&x +dx[k] <=2\n\t     &&0 <=y +dy[k]&&y +dy[k] <=2\n\t     &&j+dir[k] !=b){\n\t    dp[i+1][j+dir[k]] +=dp[i][j]*0.25;\n\t  }\n\t  else\n\t    dp[i+1][j] +=dp[i][j]*0.25;\n\t}\n      }\n    }\n    printf(\"%.8lf\\n\",dp[n][t]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\nusing namespace std;\n\n#define loop(i,a,b) for(int i=(a); i<int(b); i++)\n#define rep(i,b) loop(i,0,b)\n\ndouble dp[111][3][3];\nint const dx[]={1,0,0,-1};\nint const dy[]={0,1,-1,0};\n\nbool ok(int x, int y, int b){\n    return 0<=x&&x<3&&0<=y&&y<3 && x*3+y!=b;\n}\n\nint main(){\n    int n;;\n    while(cin>>n && n){\n        char s,t,b;\n        cin>>s>>t>>b;\n        memset(dp,0,sizeof(dp));\n        int S=s-'A';\n        int T=t-'A';\n        int B=b-'A';\n        dp[0][S/3][S%3]=1;\n        rep(i,n){\n            rep(x,3)rep(y,3){\n                rep(d,4){\n                    int nx=x+dx[d];\n                    int ny=y+dy[d];\n                    if(!ok(nx,ny,B)) dp[i+1][x][y]+=dp[i][x][y]/4;\n                    else dp[i+1][nx][ny] += dp[i][x][y]/4;\n                }\n            }\n        }\n        printf(\"%.10lf\\n\",dp[n][T/3][T%3]);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<map>\n#include<string.h>\nusing namespace std;\n\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\n\nstruct Cor{\n\tint x,y;\n\tCor(int a,int b){\n\t\tx=a,y=b;\n\t}\n};\n\nint main()\n{\n\tmap<char,pair<int,int>> M;\n\tM['A']=make_pair(0,0);\n\tM['B']=make_pair(1,0);\n\tM['C']=make_pair(2,0);\n\tM['D']=make_pair(0,1);\n\tM['E']=make_pair(1,1);\n\tM['F']=make_pair(2,1);\n\tM['G']=make_pair(0,2);\n\tM['H']=make_pair(1,2);\n\tM['I']=make_pair(2,2);\n\n\tint n;\n\twhile(cin>>n &&n!=0){\n\t\tchar s,t,b;\n\t\tcin>>s>>t>>b;\n\t\tpair<int,int> now=M[s];\n\t\tpair<int,int> goal=M[t];\n\t\tpair<int,int> not=M[b];\n\n\t\tdouble ans[17][3][3];\n\n\t\tfor(int i=0;i<16;i++)\n\t\t\tfor(int x=0;x<3;x++)\n\t\t\t\tfor(int y=0;y<3;y++)\n\t\t\t\t\tans[i][y][x]=0.0;\n\n\t\tcout<<now.first<<\" \"<<now.second<<endl;\n\t\tans[0][now.second][now.first]=1.0;\n\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int x=0;x<3;x++){\n\t\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\t\tfor(int r=0;r<4;r++){\n\t\t\t\t\t\tint nx=x+dx[r],ny=y+dy[r];\n\t\t\t\t\t\tif(nx<0 || nx>=3 || ny<0 || ny>=3 || make_pair(nx,ny)==not){\n\t\t\t\t\t\t\tans[i+1][y][x]+=ans[i][y][x]/4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tans[i+1][ny][nx]+=ans[i][y][x]/4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout<<ans[n][goal.second][goal.first]<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\ndouble p(int n, char s, char t, char b){\n    if(!n)\n        return s == t ? 1 : 0;\n    else{\n        double result = 0;\n        if(s >= 'D' && s - b != 3)\n            result += p(n-1, s-3, t, b) / 4;\n        else\n            result += p(n-1, s, t, b) / 4;\n        if(s <= 'F' && b - s != 3)\n            result += p(n-1, s+3, t, b) / 4;\n        else\n            result += p(n-1, s, t, b) / 4;\n        if((s - 'A') % 3 && s - b != 1)\n            result += p(n-1, s-1, t, b) / 4;\n        else\n            result += p(n-1, s, t, b) / 4;\n        if((s - 'A') % 3 != 2 && b -s != 1)\n            result += p(n-1, s+1, t, b) / 4;\n        else\n            result += p(n-1, s, t, b) / 4;\n        return result;\n    }\n}\n\nint main(){\n    int n;\n    char s, t, b;\n    while(std::cin >> n, n){\n        std::cin >> s >> t >> b;\n        double result = p(n, s, t, b);\n        std::cout << result << std::endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tint n;\n\tchar s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A']=i%3+1;\n\t\tfy[i+'A']=i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d \", &n) , n ){\n\t\tscanf(\"%c %c %c\", &s, &t, &b);\n\t\t\n\t\tchar m[5][5] = {0};\n\t\tfor(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;\n\n\t\t//if( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t//\t;\n\t\t//}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t//\t;\n\t\t//}else{\n\t\t\tsolve( n , m );\n\t\t//}\n\t\t//debug( m );\n\t\tprintf(\"%.9f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<map>\n#include<string.h>\nusing namespace std;\n\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\n\nint main()\n{\n\tmap<char,pair<int,int> > M;\n\tM['A']=make_pair(0,0);\n\tM['B']=make_pair(1,0);\n\tM['C']=make_pair(2,0);\n\tM['D']=make_pair(0,1);\n\tM['E']=make_pair(1,1);\n\tM['F']=make_pair(2,1);\n\tM['G']=make_pair(0,2);\n\tM['H']=make_pair(1,2);\n\tM['I']=make_pair(2,2);\n\n\tint n;\n\twhile(cin>>n &&n!=0){\n\t\tchar s,t,b;\n\t\tcin>>s>>t>>b;\n\t\tpair<int,int> now=M[s];\n\t\tpair<int,int> goal=M[t];\n\t\tpair<int,int> nota=M[b];\n\n\t\tdouble ans[17][3][3];\n\n\t\tfor(int i=0;i<16;i++)\n\t\t\tfor(int x=0;x<3;x++)\n\t\t\t\tfor(int y=0;y<3;y++)\n\t\t\t\t\tans[i][y][x]=0.0;\n\n//\t\tcout<<now.first<<\" \"<<now.second<<endl;\n\t\tans[0][now.second][now.first]=1.0;\n\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int x=0;x<3;x++){\n\t\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\t\tfor(int r=0;r<4;r++){\n\t\t\t\t\t\tint nx=x+dx[r],ny=y+dy[r];\n\t\t\t\t\t\tif(nx<0 || nx>=3 || ny<0 || ny>=3 || make_pair(nx,ny)==nota){\n\t\t\t\t\t\t\tans[i+1][y][x]+=ans[i][y][x]/4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tans[i+1][ny][nx]+=ans[i][y][x]/4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout<<ans[n][goal.second][goal.first]<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<map>\n#include<vector>\n#include<deque>\n#include<cmath>\nusing namespace std;\n\nint result;\nint n;\nint battery, junk;\n\nvoid solve(int times, int now) {\n    \n    if (n == times) {\n        if (now == battery) {\n            result += 1;\n        }\n        return;\n    }\n    \n    // up\n    if (now >= 4 && now - 3 != junk) {\n        solve(times + 1, now - 3);\n    } else {\n        solve(times + 1, now);\n    }\n\n    // down\n    if (now <= 6 && now + 3 != junk) {\n        solve(times + 1, now + 3);\n    } else {\n        solve(times + 1, now);\n    }\n\n    // right\n    if (now % 3 != 0 && now + 1 != junk) {\n        solve(times + 1, now + 1);\n    } else {\n        solve(times + 1, now);\n    }\n\n    // left\n    if (now % 3 != 1 && now - 1 != junk) {\n        solve(times + 1, now - 1);\n    } else {\n        solve(times + 1, now);\n    }\n\n}\n\nint main() {\n\n    while(cin >> n && n) {\n        result = 0;\n        char s, t, b;\n        cin >> s >> t >> b;\n        int start;\n        start = s - 'A' + 1;\n        battery = t - 'A' + 1;\n        junk = b - 'A' + 1;\n\n        solve(0, start);\n        printf(\"%.8f\", (double)result / pow(4.0, n));\n        cout << endl;\n    }\n     \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n\n#define rep(i,n) for(int (i)=0;(i)<n;(i)++)\n#define ck(a) (0<=(a)&&(a)<=9)\n\nint di[]={-3, -1, 1, 3};\n\nint main() {\n  using namespace std;\n  \n  int n, s, t, b; char cs, ct, cb;\n  while(cin>>n) {\n    if(n==0) break;\n    cin >> cs >> ct >> cb;\n    s = cs-'A'; t = ct-'A'; b = cb-'A';\n    // 確率漸化式（添字は場所に対応。漸化式はqを用いることによって更新される）\n    double p[9]={0}; p[s]=1;\n\n    while(n--) {\n      double q[9]={0};\n      rep(i,9)rep(d,4) {\n\tif(ck(i+di[d])&&!(i%3==0&&di[d]==-1)&&!(i%3==2&&di[d]==1)&&i+di[d]!=b)\n\t  q[i+di[d]]+=p[i]/4;\n\telse q[i]+=p[i]/4;\n      }\n      rep(i,9)p[i]=q[i]; // 最新データに更新\n    }\n    printf(\"%.8f\\n\", p[t]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <fstream>\n#include <algorithm>\n#include <stdio.h>\n\nusing namespace std;\n\nint n;\nchar s,t,b;\n\ntypedef pair<int,int> Pair;\n\ndouble calc(){\n\n\tchar floar[3][3];\n\tfloar[0][0] = 'A';\n\tfloar[0][1] = 'B';\n\tfloar[0][2] = 'C';\n\tfloar[1][0] = 'D';\n\tfloar[1][1] = 'E';\n\tfloar[1][2] = 'F';\n\tfloar[2][0] = 'G';\n\tfloar[2][1] = 'H';\n\tfloar[2][2] = 'I';\n\n\tpair<int,int> startPlace;\n\tpair<int,int> finPlace;\n\tpair<int,int> wareHouse;\n\n\tfor(int i = 0; i < 3; i++){\n\t\tfor(int j = 0; j < 3; j++){\n\t\t\tif(floar[i][j] == s){\n\t\t\t\tstartPlace.first = i;\n\t\t\t\tstartPlace.second = j;\n\t\t\t}\n\t\t\telse if(floar[i][j] == t){\n\t\t\t\tfinPlace.first = i;\n\t\t\t\tfinPlace.second = j;\n\t\t\t}\n\t\t\telse if(floar[i][j] == b){\n\t\t\t\twareHouse.first = i;\n\t\t\t\twareHouse.second = j;\n\t\t\t}\n\t\t}\n\t}\n\n\tvector<Pair> placeList;\n\tvector<Pair> nextPlaceList;\n\n\tplaceList.push_back(startPlace);\n\tint leaveBattery = n;\n\tpair<int,int> newPlace;\n\n\tint trueCount = 0;\n\tint falseCount = 0;\n\n\tint placeCount[3][3];\n\tint nextPlaceCount[3][3];\n\n\tfor(int i = 0; i < 3; i++){\n\t\tfill(placeCount[i],placeCount[i]+3,0);\n\t\tfill(nextPlaceCount[i],nextPlaceCount[i]+3,0);\n\t}\n\n\tplaceCount[startPlace.first][startPlace.second] = 1;\n\n\twhile(leaveBattery){\n\t\tif(leaveBattery == 1){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\t\tfalseCount += placeCount[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tfalseCount = falseCount * 4;\n\t\t}\n\n\t\t// ツ配ツ療アツづ個陳身ツづーツ暗堋督ョツつオツづつ「ツつュ\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tif(placeCount[i][j] >= 1){\n\t\t\t\t\t// ツ湘」ツづ可暗堋督ョ\n\t\t\t\t\tif(i - 1 >= 0 && !(i - 1 == wareHouse.first && j == wareHouse.second)){\n\t\t\t\t\t\tnextPlaceCount[i-1][j]+=placeCount[i][j];\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tnextPlaceCount[i][j]++;\n\t\t\t\t\t// ツ可コ\n\t\t\t\t\tif(i + 1 < 3 && !(i + 1 == wareHouse.first && j == wareHouse.second))\n\t\t\t\t\t\tnextPlaceCount[i+1][j]+=placeCount[i][j];\n\t\t\t\t\telse\n\t\t\t\t\t\tnextPlaceCount[i][j]++;\n\t\t\t\t\t// ツ債カ\n\t\t\t\t\tif(j - 1 >= 0 && !(i == wareHouse.first && j - 1 == wareHouse.second))\n\t\t\t\t\t\tnextPlaceCount[i][j-1]+=placeCount[i][j];\n\t\t\t\t\telse\n\t\t\t\t\t\tnextPlaceCount[i][j]++;\n\t\t\t\t\t// ツ右\n\t\t\t\t\tif(j + 1 < 3 && !(i == wareHouse.first && j + 1 == wareHouse.second))\n\t\t\t\t\t\tnextPlaceCount[i][j+1]+=placeCount[i][j];\n\t\t\t\t\telse\n\t\t\t\t\t\tnextPlaceCount[i][j]++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tplaceCount[i][j] = nextPlaceCount[i][j];\n\t\t\t\tnextPlaceCount[i][j] = 0;\n\t\t\t}\n\t\t}\n\n\t\tleaveBattery--;\n\t}\n\n\ttrueCount = placeCount[finPlace.first][finPlace.second];\n\n\treturn (double)trueCount/falseCount;\n}\n\nvoid solve(){\n\t//ifstream ifs(\"prob1020.txt\");\n\twhile(1){\n\t\t//ifs >> n;\n\t\tcin >> n;\n\n\t\tif(n == 0)\n\t\t\tbreak;\n\t\tcin >> s;\n\t\tcin >> t;\n\t\tcin >> b;\n\t\t//ifs >> s;\n\t\t//ifs >> t;\n\t\t//ifs >> b;\n\t\tdouble result = calc();\n\t\tprintf(\"%.8f\\n\",result);\n\t}\n}\n\nint main(){\n\nsolve();\n\nreturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cmath>\n#define N 3\n#define N1 16\nusing namespace std;\nvoid func(int,int,int);\nint n,k,data[N][N],memo[N1][N][N];\nint dy[N+1]={-1,0,1,0};\nint dx[N+1]={0,1,0,-1};\nbool visited[N1][N][N];\nchar s,t,b;\n\nint main(){\n  while(1){\n    cin >> n;\n    if(!n) break;\n    cin >> s >> t >> b;\n    for(int i=0;i<N;i++){\n      for(int j=0;j<N;j++){\n\tdata[i][j]=0;\n\tfor(int k=0;k<N1;k++){\n\t  memo[k][i][j]=0;\n\t  visited[k][i][j]=false;\n\t}\n      }\n    }\n    data[(t-'A')/N][(t-'A')%N]=1;\n    data[(b-'A')/N][(b-'A')%N]=-1;\n    func((s-'A')/N,(s-'A')%N,0);\n    k=pow(4,n);\n    printf(\"%.8f\\n\",1.0*memo[0][(s-'A')/N][(s-'A')%N]/k);\n  }\n  return 0;\n}\n\nvoid func(int y,int x,int d){\n  visited[d][y][x]=true;\n  if(d==n){\n    if(data[y][x]==1) memo[d][y][x]=1;\n    return ;\n  }\n  for(int i=0;i<N+1;i++){\n    int ny=y+dy[i],nx=x+dx[i];\n    if(ny<0||nx<0||N<ny||N<nx||data[ny][nx]==-1){\n      if(visited[d+1][y][x]==false) func(y,x,d+1);\n      memo[d][y][x]+=memo[d+1][y][x];\n    }\n    else{\n      if(visited[d+1][ny][nx]==false) func(ny,nx,d+1);\n      memo[d][y][x]+=memo[d+1][ny][nx];\n    }\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<vector>\nusing namespace std;\n\n#define inRange(x,a,b) (a <= x && x < b)\nint dx[8] = {0,0,1,-1,1,1,-1,-1};\nint dy[8] = {1,-1,0,0,1,-1,1,-1};\n\nint col(char x){\n    if(x == 'A' || x == 'D' || x == 'G')    return 0;\n    if(x == 'B' || x == 'E' || x == 'H')    return 1;\n    return 2;\n}\n\nint row(char x){\n    if(x <= 'C')    return 0;\n    if(x <= 'F')    return 1;\n    return 2;\n}\n\nint main(){\n    int n;\n    char s, t, b;\n    while(cin >> n, n){\n        cin >> s >> t >> b;\n\n        vector<vector<int>> mat(3, vector<int>(3, 0));\n        vector<vector<double>> ans(3, vector<double>(3, 0.0)); \n        mat[row(b)][col(b)] = 1;\n        ans[row(s)][col(s)] = 1.0;\n\n        while(n-- > 0){\n            vector<vector<double>> next(3, vector<double>(3, 0.0)); \n            for(int i = 0; i < 3; i++){\n                for(int j = 0; j < 3; j++){\n                    if(ans[i][j] == 0.0)  continue;\n                    for(int k = 0; k < 4; k++){\n                        int di = i+dx[k], dj = j+dy[k];\n                        if(!inRange(di, 0, 3) || !inRange(dj, 0, 3) || mat[di][dj]==1){\n                            next[i][j] += ans[i][j]/4.0;\n                        }else{\n                            next[di][dj] += ans[i][j]/4.0;\n                        }\n                    }\n                }\n            }\n            ans = next;\n        }\n\n        cout << fixed << setprecision(10) << ans[row(t)][col(t)] << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<cstring>\nusing namespace std;\nchar T[3], U[10] = \"ABCDEFGHI\"; int n, c[3][2], x[5][5]; double p[100][5][5];\n\nvoid A(int E, int B, int C, double D, int F, int G) { \n\tif (x[B][C] == 0) { \n\t\tp[E][B][C] += D; \n\t} \n\telse {\n\t\tp[E][F][G] += D;\n\t}\n}\n\nint main() {\n\twhile (true) {\n\t\tmemset(p, 0.0, sizeof(p));\n\t\tcin >> n;\n\t\tif (!n) { break; }\n\t\tcin >> T[0] >> T[1] >> T[2];\n\t\tfor (int i = 0; i < 3; i++) {\n\t\t\tfor (int j = 0; j < 9; j++) {\n\t\t\t\tif (U[j] == (char)T[i]) {\n\t\t\t\t\tc[i][0] = j / 3 + 1;\n\t\t\t\t\tc[i][1] = j % 3 + 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tp[n][c[0][0]][c[0][1]] = 1;\n\t\tfor (int i = 0; i < 25; i++) {\n\t\t\tx[i / 5][i % 5] = 1;\n\t\t}\n\t\tfor (int i = 1; i <= 3; i++) {\n\t\t\tfor (int j = 1; j <= 3; j++) {\n\t\t\t\tif (i != c[2][0] || j != c[2][1]) {\n\t\t\t\t\tx[i][j] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (int i = n - 1; i >= 0; i--) {\n\t\t\tfor (int j = 1; j <= 3; j++) {\n\t\t\t\tfor (int k = 1; k <= 3; k++) {\n\t\t\t\t\tif (p[i + 1][j][k]>0) {\n\t\t\t\t\t\tA(i, j - 1, k, p[i + 1][j][k] / 4.0, j, k);\n\t\t\t\t\t\tA(i, j + 1, k, p[i + 1][j][k] / 4.0, j, k);\n\t\t\t\t\t\tA(i, j, k + 1, p[i + 1][j][k] / 4.0, j, k);\n\t\t\t\t\t\tA(i, j, k - 1, p[i + 1][j][k] / 4.0, j, k);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << fixed << setprecision(15) << p[0][c[1][0]][c[1][1]] << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint dp[3][3][20];\nint mx[]={-1,1,0,0},my[]={0,0,-1,1};\nchar abc[3][4]={\"ABC\",\"DEF\",\"GHI\"};\nint main(){\n\twhile(true){\n\t\tint n;\tcin>>n;\n\t\tif(n==0)\treturn 0;\n\t\tchar s,t,b;\tscanf(\" %c %c %c\",&s,&t,&b);\n\t\tmemset(dp,0,sizeof(dp));\n\t\tint sx,sy,rx,ry;\n\t\tfor(int i=0;i<3;i++){\n\t\t\tfor(int j=0;j<3;j++){\n\t\t\t\tif(abc[i][j]==s){\n\t\t\t\t\tsx=j;\tsy=i;\n\t\t\t\t}\n\t\t\t\telse if(abc[i][j]==t)\tdp[i][j][0]=1;\n\t\t\t\telse if(abc[i][j]==b){\n\t\t\t\t\trx=j;\try=i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\tfor(int x=0;x<3;x++){\n\t\t\t\t\tif(dp[y][x][i]==0)\tcontinue;\n\t\t\t\t\tfor(int j=0;j<4;j++){//dp[y][x][i]を配る\n\t\t\t\t\t\tint cx=x+mx[j],cy=y+my[j];\n\t\t\t\t\t\tif(cx<0||3<cx||cy<0||3<cy){\n\t\t\t\t\t\t\tdp[y][x][i+1]+=dp[y][x][i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(cx==rx&&cy==ry){\n\t\t\t\t\t\t\tdp[y][x][i+1]+=dp[y][x][i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[cy][cx][i+1]+=dp[y][x][i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.15lf\\n\",static_cast<double>(dp[sy][sx][n])/static_cast<double>(1<<2*n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tchar n, s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\t//fx[i+'A']=i%3+1;\n\t\t//fy[i+'A']=i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d\", &n) , n ){\n\t\t//scanf(\" %c %c %c\", &s, &t, &b);\n\t\tchar m[5][5] = {0};\n\t\t/*for(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;*/\n\n\t\tif( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else{\n\t\t\t//solve( n , m );\n\t\t\t;\n\t\t}\n\t\t//debug( m );\n\t\t//printf(\"%.8f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint main(){\n  int n;\n  char s,t,b;\n  while(true){\n\n    //input\n    cin >> n;\n    if(!n)\n      break;\n    cin >>s >>t >>b;\n    int room[n+1][9];\n    for(int i=0;i<9;i++)\n      room[0][i] = 0;\n    room[0][(int)(s-'A')] = 1;\n    \n    //wall\n    int wall[5][5];\n    for(int y=0;y<5;y++){\n      for(int x=0;x<5;x++){\n\tif (x==0||x==4||y==0||y==4)\n\t  wall[x][y]=1;\n\telse\n\t  wall[x][y]=0;\n      }\n    }\n    wall[(int)(b-'A')%3+1][(int)(b-'A')/3+1] = 1;\n\n    for(int i=0;i<n;i++){\n      for(int j=0;j<9;j++)\n\troom[i+1][j] = 0;\n      for(int pos=0;pos<9;pos++){\n\tif(wall[pos%3+1][pos/3])\n\t  room[i+1][pos]+=room[i][pos];\n\telse\n\t  room[i+1][pos-3]+=room[i][pos];\n\tif(wall[pos%3][pos/3+1])\n\t  room[i+1][pos]+=room[i][pos];\n\telse\n\t  room[i+1][pos-1]+=room[i][pos];\n\tif(wall[pos%3+2][pos/3+1])\n\t  room[i+1][pos]+=room[i][pos];\n\telse\n\t  room[i+1][pos+1]+=room[i][pos];\n\tif(wall[pos%3+1][pos/3+2])\n\t  room[i+1][pos]+=room[i][pos];\n\telse\n\t  room[i+1][pos+3]+=room[i][pos];\n      }\n    }\n    printf (\"%.8f\\n\",((double)(room[n][(int)(t-'A')])/pow(4,(double)n)));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define INF 1145141919\n#define MOD 1000000007\n#define ALL(a) begin((a)),end((a))\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10  fixed<<setprecision(10)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> P;\ntypedef long long ll;\nstruct edge\n{\n\tint from, to, cost;\n\tbool operator < (const edge& e) const { return cost < e.cost; }\n\tbool operator >(const edge& e) const { return cost > e.cost; }\n};\ntypedef vector<edge> edges;\n///*************************************************************************************///\n///*************************************************************************************///\n///*************************************************************************************///\n\nbool fld[5][5] = {};\nint main()\n{\n\tint n;\n\twhile (cin >> n, n)\n\t{\n\t\tchar s, t, b;\n\t\tcin >> s >> t >> b;\n\t\tvector<vector<edge>> es(9, vector<edge>(9));\n\t\tMS(fld, true);\n\t\tFOR(i, 1, 4)FOR(j, 1, 4) fld[i][j] = false;\n\t\tif (b == 'A') fld[1][1] = true;\n\t\telse if (b == 'B') fld[1][2] = true;\n\t\telse if (b == 'C') fld[1][3] = true;\n\t\telse if (b == 'D') fld[2][1] = true;\n\t\telse if (b == 'E') fld[2][2] = true;\n\t\telse if (b == 'F') fld[2][3] = true;\n\t\telse if (b == 'G') fld[3][1] = true;\n\t\telse if (b == 'H') fld[3][2] = true;\n\t\telse if (b == 'I') fld[3][3] = true;\n\t\tint dx[] = { -1, 0, 0, 1 }; int dy[] = { 0, -1, 1, 0 };\n\t\tFOR(i, 1, 4)FOR(j, 1, 4)\n\t\t{\n\t\t\tREP(k, 4)\n\t\t\t{\n\t\t\t\tint p = (i - 1) * 3 + j - 1;\n\t\t\t\tint nx = i + dx[k]; int ny = j + dy[k];\n\t\t\t\tint q = (nx - 1) * 3 + ny - 1;\n\t\t\t\tif (nx > 0 && nx<4 && ny>0 && ny < 4 && fld[nx][ny]==false)\n\t\t\t\t{\n\t\t\t\t\tes[p].push_back(edge{ p, q, 1 });\n\t\t\t\t}\n\t\t\t\telse es[p].push_back(edge{ p, p, 1 });\n\t\t\t}\n\t\t}\n\t\tint st = s - 'A';\n\t\tint go = t - 'A';\n\t\tdouble ex[9][16] = {};\n\t\tex[st][0] = 1;\n\t\tFOR(k,1, n+1)\n\t\t{\n\t\t\tREP(i, 9)\n\t\t\t{\n\t\t\t\tREP(j, es[i].size())\n\t\t\t\t{\n\t\t\t\t\tex[es[i][j].to][k] += ex[es[i][j].from][k - 1] * es[i][j].cost* 0.25;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << D10 << ex[go][n] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "// AOJ 1020\n#include<iostream>\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\nusing namespace std;\n\ntypedef double number;\nint n;\nint sx, sy, tx, ty, bx, by;\nnumber room[3][3];\n\nvoid init() {\n  REP(x, 3) REP(y, 3) {\n    room[x][y] = 0;\n  }\n  room[sx][sy] = 1;\n}\n\nbool is_depot(int x, int y) {\n  return x == bx && y == by;\n}\n\nnumber in(int x, int y) {\n  if (x < 0 or 2 < x or y < 0 or 2 < y) return 0;\n  if (is_depot(x, y)) return 0;\n  return room[x][y];\n}\n\nnumber solve() {\n  init();\n  REP(i, n) {\n    number future[3][3];\n    REP(x, 3) REP(y,3) {\n      if (is_depot(x, y)) continue;\n      future[x][y] = \n        in(x + 1, y) / 4 + in(x - 1, y) / 4 +\n        in(x, y + 1) / 4 + in(x, y - 1) / 4;\n    }\n    REP(x, 3) REP(y, 3) {\n      room[x][y] = future[x][y];\n    }\n  }\n  return room[tx][ty];\n}\n\nint room2x(char r) {\n  switch (r) {\n    case 'A': case 'D': case 'G':\n      return 0; break;\n    case 'B': case 'E': case 'H':\n      return 1; break;\n    case 'C': case 'F': case 'I':\n      return 2; break;\n    default:\n      break;\n  }\n}\n\nint room2y(char r) {\n  switch (r) {\n    case 'A': case 'B': case 'C':\n      return 0; break;\n    case 'D': case 'E': case 'F':\n      return 1; break;\n    case 'G': case 'H': case 'I':\n      return 2; break;\n    default:\n      break;\n  }\n}\n\nint main() {\n  while (cin >> n and n) {\n    char s, t, b;\n    cin >> s >> t >> b;\n    sx = room2x(s); sy = room2y(s);\n    tx = room2x(t); ty = room2y(t);\n    bx = room2x(b); by = room2y(b);\n\n    cout << solve() << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tint n;\n\tchar s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\tfx[i+'A']=i%3+1;\n\t\tfy[i+'A']=i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d \", &n) , n ){\n\t\tscanf(\"%c %c %c\", &s, &t, &b);\n\t\t\n\t\tchar m[5][5] = {0};\n\t\tfor(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;\n\n\t\t//if( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t//\t;\n\t\t//}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t//\t;\n\t\t//}else{\n\t\t\tsolve( n , m );\n\t\t//}\n\t\t//debug( m );\n\t\tprintf(\"%.9f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\nusing namespace std;\n\nint main(){\n\t\tint n;\n\tchar s,t,b;\n\twhile(cin>>n,n){\n\t\tdouble dp[16][9]={0.0};\n\t\tint floor[9][4]={\n\t\t\t{0,1,3,0},{1,2,4,0},{2,2,5,1},\n\t\t\t{0,4,6,3},{1,5,7,3},{2,5,8,4},\n\t\t\t{3,7,6,6},{4,8,7,6},{5,8,8,7}\n\t\t};\n\t\tcin>>s>>t>>b;\n\t\tdp[0][s-'A']=1;\n\t\tfor(int i=0;i<9;i++)for(int j=0;j<4;j++)if(floor[i][j]==b-'A')floor[i][j]=i;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int j=0;j<9;j++){\n\t\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\t\tdp[i+1][floor[j][k]]+=dp[i][j]/4;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\",dp[n][t-'A']);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <iostream>\n#include <string.h>\n\nusing namespace std;\n\nint n;\nchar room[10] = \"ABCDEFGHI\";\nchar s, t, b;\nint off[4][2] = {{-1, 0}, {1, 0}, {0, -1}, {0, 1}};\nint x, y;\n\ndouble table[3][3];\n\ndouble solve()\n{\n\tmemset(&table[0][0], 0, sizeof(double) * 9);\n\ttable[y][x] = 1.0;\n\tfor(int k=0; k<n; k++)\n\t{\n\t\tdouble temp[3][3];\n\t\tmemset(&temp[0][0], 0, sizeof(double) * 9);\n\t\tfor(int j=0; j<3; j++)\n\t\t{\n\t\t\tfor(int i=0; i<3; i++)\n\t\t\t{\n\t\t\t\tif(table[j][i] != 0.0)\n\t\t\t\t{\n\t\t\t\t\tfor(int m=0; m<4; m++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint xx = i + off[m][0];\n\t\t\t\t\t\tint yy = j + off[m][1];\n\t\t\t\t\t\tint index = xx + yy * 3;\n\t\t\t\t\t\txx = (xx>=0 && xx<3 && room[index] != b) ? xx : i;\n\t\t\t\t\t\tyy = (yy>=0 && yy<3 && room[index] != b) ? yy : j;\n\t\t\t\t\t\ttemp[yy][xx] += table[j][i] / 4.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tmemcpy(&table[0][0], &temp[0][0], sizeof(double) * 9);\n\t}\n\n\tfor(int i=0; i<9; i++)\n\t{\n\t\tif(room[i]==t) return table[i/3][i%3];\n\t}\n\n\treturn 0.0;\n}\n\nint main()\n{\n\twhile( 1 )\n\t{\n\t\tcin >> n;\n\t\tif(n==0) break;\n\t\t\n\t\tcin >> s >> t >> b;\n\t\tfor(int i=0; i<9; i++)\n\t\t{\n\t\t\tif(room[i] == s)\n\t\t\t{\n\t\t\t\tx = i%3;\n\t\t\t\ty = i/3;\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8f\\n\", solve());\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<string>\n#include<map>\n#include<cstdio>\n#include<cstring>\n#include<vector>\n#include<queue>\nusing namespace std;\n#define mp(a,b) make_pair(a,b)\n#define fr first\n#define sc second\ntypedef pair<int,int> Pi;\nint n;\nchar s,t,d;\nint dx[]={0,1,0,-1},dy[]={1,0,-1,0};\nvoid solve(){\n  int goal[3][3] = {{}};\n  map<char,pair<int,int> > tmp;\n  tmp['A'] = Pi(0,0);tmp['B'] = Pi(0,1);tmp['C'] = Pi(0,2);\n  tmp['D'] = Pi(1,0);tmp['E'] = Pi(1,1);tmp['F'] = Pi(1,2);\n  tmp['G'] = Pi(2,0);tmp['H'] = Pi(2,1);tmp['I'] = Pi(2,2);\n  queue< pair<int,Pi > > que;\n  que.push(mp(n,tmp[s]));\n\n  while(!que.empty()){\n    pair<int,Pi> p = que.front(); que.pop();\n    if(p.fr == 0){\n      goal[p.sc.fr][p.sc.sc]++;\n      continue;\n    }\n    for(int i=0;i<4;i++){\n      int nx = dx[i] + p.sc.fr , ny = dy[i] + p.sc.sc;\n      if(nx >= 0 && nx < 3 && ny >= 0 && ny < 3 && tmp[d] != Pi(nx,ny) ){\n        que.push(mp(p.fr - 1,Pi(nx,ny)));\n      }else{\n        que.push(mp(p.fr - 1,Pi(p.sc.fr,p.sc.sc)));\n      }\n    }\n  }\n  int sum = 0;\n  for(int i=0;i<3;i++){\n    for(int j=0;j<3;j++) sum += goal[i][j];\n  }\n  printf(\"%.7f\\n\",(double)goal[tmp[t].fr][tmp[t].sc]/(double)sum);\n}\n\nint main(){\n  while(cin >> n , n){\n    cin >> s >> t >> d;\n    solve();\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<cmath>\n\nusing namespace std;\ntypedef pair<int,int> P;\nbool mep[3][3];\nint probability;\nconst int dx[4] = {0,1,0,-1};\nconst int dy[4] = {1,0,-1,0};\nint n;\nP sp,tp,bp;\n\nP position(char bet){\n  if(bet == 'A')return P(0,0);\n  else if(bet == 'B')return P(0,1);\n  else if(bet == 'C')return P(0,2);\n  else if(bet == 'D')return P(1,0);\n  else if(bet == 'E')return P(1,1);\n  else if(bet == 'F')return P(1,2);\n  else if(bet == 'G')return P(2,0);\n  else if(bet == 'H')return P(2,1);\n  else if(bet == 'I')return P(2,2);\n}\n\nvoid search(P p,int c){\n  if(c > n)return;\n  else if(p.first == tp.first && p.second == tp.second){\n    probability++;\n  }\n\n  for(int i=0;i<4;i++){\n    int nx = p.first + dx[i],ny = p.second + dy[i];\n    if(0<=nx && nx <3 && 0<= ny && ny <3 && mep[ny][nx]){\n      search(P(nx,ny),c+1);\n    }\n    else {\n      search(p,c+1);\n    }\n  }\n\n}\n\n\nint main(){\n  char s,t,b;\n  while(cin >> n && n){\n    probability = 0;\n    for(int i=0;i<3;i++){\n      mep[i][0] = mep[i][1] = mep[i][2] = true;\n    }\n    cin >> s >> t >> b;\n    sp = position(s),tp = position(t),bp = position(b);\n    mep[bp.second][bp.first] = false;\n    search(sp,0);\n    printf(\"%.8f\\n\",(double)(probability/pow(4,n)));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define F first\n#define S second\n#define INF 1 << 30\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\ndouble dp[16][3][3];\nint n, dx[] = {0,-1,0,1}, dy[] = {-1,0,1,0};\nchar cs, ct, cb;\nint s, t, b;\n\nint main(){\n  while(scanf(\"%d\", &n) && n){\n    memset(dp, 0.0, sizeof(dp));\n    scanf(\"\\n%c %c %c\", &cs, &ct, &cb);\n    s = cs - 'A';\n    t = ct - 'A';\n    b = cb - 'A';\n    //    fprintf(stderr, \"%c\\n\", cs);\n    dp[0][s/3][s%3] = 1;\n\n    rep(i, n) rep(y, 3) rep(x, 3){\n      if(dp[i][y][x] == 0) continue;\n      rep(d, 4){\n\tint ny = y + dy[d], nx = x + dx[d];\n\tif(ny < 0 || nx < 0 || ny >= 3 || nx >= 3 || ny*3+nx == b) dp[i+1][y][x] += dp[i][y][x];\n\telse dp[i+1][ny][nx] += dp[i][y][x]*0.25;\n      }\n    }\n\n    printf(\"%.8lf\\n\", dp[n][t/3][t%3]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<string.h>\n#include<math.h>\n\nint m[4]={3,-3,1,-1},s,t,b,dp[9][16];\n\nint d(int p,int n)\n{\n\tint i,r=0;\n\tif(dp[p][n]!=-1)\n\t\treturn dp[p][n];\n\tif(n==0&&p==t)\n\t\treturn 1;\n\telse if(n>0&&(abs(p/3-t/3)+abs(p%3-t%3))<=n)\n\t{\n\t\tfor(i=0;i<4;i++)\n\t\t{\n\t\t\tif(p+m[i]>=0 && p+m[i]<9 && p+m[i]!=b)\n\t\t\t\tr+=d(p+m[i],n-1);\n\t\t\telse\n\t\t\t\tr+=d(p,n-1);\n\t\t}\n\t}\n\treturn dp[p][n]= r;\n}\n\nint main()\n{\n\tint n,ans,tmp1;\n\tdouble tmp2;\n\tfor(;scanf(\"%d\",&n);ans=0)\n\t{\n\t\tif(n==0)\n\t\t\treturn 0;\n\t\tscanf(\"\\n%c %c %c\",&s,&t,&b);\n\t\tmemset(dp,-1,sizeof(dp));\n\t\ts-=65;t-=65;b-=65;\n\t\tans=d(s,n);\n\t\ttmp1=1<<(n*2);\n\t\ttmp2=(double)ans/tmp1;\n\t\tprintf(\"%lf\\n\",tmp2);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <fstream>\n#include <algorithm>\n\nusing namespace std;\n\nint n;\nchar s,t,b;\n\ntypedef pair<int,int> Pair;\n\ndouble calc(){\n\n\tchar floar[3][3];\n\tfloar[0][0] = 'A';\n\tfloar[0][1] = 'B';\n\tfloar[0][2] = 'C';\n\tfloar[1][0] = 'D';\n\tfloar[1][1] = 'E';\n\tfloar[1][2] = 'F';\n\tfloar[2][0] = 'G';\n\tfloar[2][1] = 'H';\n\tfloar[2][2] = 'I';\n\n\tpair<int,int> startPlace;\n\tpair<int,int> finPlace;\n\tpair<int,int> wareHouse;\n\n\tfor(int i = 0; i < 3; i++){\n\t\tfor(int j = 0; j < 3; j++){\n\t\t\tif(floar[i][j] == s){\n\t\t\t\tstartPlace.first = i;\n\t\t\t\tstartPlace.second = j;\n\t\t\t}\n\t\t\telse if(floar[i][j] == t){\n\t\t\t\tfinPlace.first = i;\n\t\t\t\tfinPlace.second = j;\n\t\t\t}\n\t\t\telse if(floar[i][j] == b){\n\t\t\t\twareHouse.first = i;\n\t\t\t\twareHouse.second = j;\n\t\t\t}\n\t\t}\n\t}\n\n\tvector<Pair> placeList;\n\tvector<Pair> nextPlaceList;\n\n\tplaceList.push_back(startPlace);\n\tint leaveBattery = n;\n\tpair<int,int> newPlace;\n\n\tint trueCount = 0;\n\tint falseCount = 0;\n\n\tint placeCount[3][3];\n\tint nextPlaceCount[3][3];\n\n\tfor(int i = 0; i < 3; i++){\n\t\tfill(placeCount[i],placeCount[i]+3,0);\n\t\tfill(nextPlaceCount[i],nextPlaceCount[i]+3,0);\n\t}\n\n\tplaceCount[startPlace.first][startPlace.second] = 1;\n\n\twhile(leaveBattery){\n\t\tif(leaveBattery == 1){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\t\tfalseCount += placeCount[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tfalseCount = falseCount * 4;\n\t\t}\n\n\t\t// ツ配ツ療アツづ個陳身ツづーツ暗堋督ョツつオツづつ「ツつュ\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tif(placeCount[i][j] >= 1){\n\t\t\t\t\t// ツ湘」ツづ可暗堋督ョ\n\t\t\t\t\tif(i - 1 >= 0 && !(i - 1 == wareHouse.first && j == wareHouse.second)){\n\t\t\t\t\t\tnextPlaceCount[i-1][j]+=placeCount[i][j];\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tnextPlaceCount[i][j]++;\n\t\t\t\t\t// ツ可コ\n\t\t\t\t\tif(i + 1 < 3 && !(i + 1 == wareHouse.first && j == wareHouse.second))\n\t\t\t\t\t\tnextPlaceCount[i+1][j]+=placeCount[i][j];\n\t\t\t\t\telse\n\t\t\t\t\t\tnextPlaceCount[i][j]++;\n\t\t\t\t\t// ツ債カ\n\t\t\t\t\tif(j - 1 >= 0 && !(i == wareHouse.first && j - 1 == wareHouse.second))\n\t\t\t\t\t\tnextPlaceCount[i][j-1]+=placeCount[i][j];\n\t\t\t\t\telse\n\t\t\t\t\t\tnextPlaceCount[i][j]++;\n\t\t\t\t\t// ツ右\n\t\t\t\t\tif(j + 1 < 3 && !(i == wareHouse.first && j + 1 == wareHouse.second))\n\t\t\t\t\t\tnextPlaceCount[i][j+1]+=placeCount[i][j];\n\t\t\t\t\telse\n\t\t\t\t\t\tnextPlaceCount[i][j]++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tplaceCount[i][j] = nextPlaceCount[i][j];\n\t\t\t\tnextPlaceCount[i][j] = 0;\n\t\t\t}\n\t\t}\n\n\t\tleaveBattery--;\n\t}\n\n\ttrueCount = placeCount[finPlace.first][finPlace.second];\n\n\treturn (double)trueCount/falseCount;\n}\n\nvoid solve(){\n\t//ifstream ifs(\"prob1020.txt\");\n\twhile(1){\n\t\t//ifs >> n;\n\t\tcin >> n;\n\n\t\tif(n == 0)\n\t\t\tbreak;\n\t\tcin >> s;\n\t\tcin >> t;\n\t\tcin >> b;\n\t\t//ifs >> s;\n\t\t//ifs >> t;\n\t\t//ifs >> b;\n\t\tcout << calc() << endl;\n\t}\n}\n\nint main(){\n\nsolve();\n\nreturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <map>\n\nusing namespace std;\ntypedef pair<int, int> pii;\n\nmap<pii, double> memo;\ndouble recur(int n, int room, int goal, int unused){\n\tif(n == 0){ return (room == goal) ? 1.0 : 0.0; }\n\tpii key(n, room);\n\tif(memo.find(key) != memo.end()){ return memo[key]; }\n\tdouble answer = 0.0;\n\tif(room - 1 != unused){\n\t\tanswer += recur(n - 1, (room % 3 == 0) ? room : (room - 1), goal, unused);\n\t}\n\tif(room + 1 != unused){\n\t\tanswer += recur(n - 1, (room % 3 == 2) ? room : (room + 1), goal, unused);\n\t}\n\tif(room - 3 != unused){\n\t\tanswer += recur(n - 1, (room / 3 == 0) ? room : (room - 3), goal, unused);\n\t}\n\tif(room + 3 != unused){\n\t\tanswer += recur(n - 1, (room / 3 == 2) ? room : (room + 3), goal, unused);\n\t}\n\tanswer /= 4;\n\tmemo.insert(make_pair(key, answer));\n\treturn answer;\n}\nint main(){\n\twhile(true){\n\t\tint n;\n\t\tcin >> n;\n\t\tif(n == 0){ break; }\n\t\tchar s, t, b;\n\t\tcin >> s >> t >> b;\n\t\tmemo.clear();\n\t\tcout << recur(n, s - 'A', t - 'A', b - 'A') << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint dx[] = {0,0,1,-1};\nint dy[] = {1,-1,0,0};\nchar room[5][5] = {\n\t{1,1,1,1,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,0,0,0,1},\n\t{1,1,1,1,1}\n};\n\n/*void debug(char m[5][5]){\n\tprintf(\"debug : \\n\");\n\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\tprintf(\"%3d\", m[y][x]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}*/\n\nvoid solve(char n, char m[5][5] ){\n\tchar m_[5][5] = {0};\n\tfor( ;n;n--){\n\t\t//debug(m);\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tif( m[y][x] ){\n\t\t\t\t\tfor(int i=0 ; i<4 ; i++ ){\n\t\t\t\t\t\tint mx = x + dx[i];\n\t\t\t\t\t\tint my = y + dy[i];\n\t\t\t\t\t\tif( room[my][mx] == 0 ){\n\t\t\t\t\t\t\tm_[my][mx] += m[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tm[y][x] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int y=1 ; y <= 3 ; y++ ){\n\t\t\tfor(int x=1 ; x <= 3 ; x++ ){\n\t\t\t\tm[y][x] = m_[y][x];\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tchar fx[256] = {0}, fy[256] = {0};\n\tint n;\n\tchar s, t, b;\n\t\n\tfor(int i=0;i<9;i++){\n\t\t//fx[i+'A']=i%3+1;\n\t\t//fy[i+'A']=i/3+1;\n\t}\n\t\n\twhile( scanf(\"%d \", &n) , n ){\n\t\t//scanf(\" %c %c %c\", &s, &t, &b);\n\t\tcin >> s >> t >> b;\n\t\tchar m[5][5] = {0};\n\t\t/*for(int i=1 ; i<=3 ; i++){\n\t\t\tfor(int j=1 ; j<=3 ; j++){\n\t\t\t\troom[i][j] = 0;\n\t\t\t\tm[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\troom[ fy[b] ][ fx[b] ] = 1;\n\t\tm[ fy[s] ][ fx[s] ] = 1;*/\n\n\t\tif( n%2 == 1 && (fy[s]*3+fx[s])%2 == (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else if( n%2 == 0 && (fy[s]*3+fx[s])%2 != (fy[t]*3+fx[t])%2 ){\n\t\t\t;\n\t\t}else{\n\t\t\t//solve( n , m );\n\t\t\t;\n\t\t}\n\t\t//debug( m );\n\t\t//printf(\"%.8f\\n\" , m[ fy[t] ][ fx[t] ]/pow(4,n));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int dx[] = {-1, 0, 0, 1};\nconst int dy[] = { 0,-1, 1, 0};\n\nint sx, sy, gx, gy, n, bx, by;\ndouble P[3][3][20];\n\nbool check(int x, int y){\n  return 0 <= x && x < 3 && 0 <= y && y < 3;\n}\n\nvoid solve(){\n  P[sy][sx][n] = 1;\n\n  queue<int> qx, qy, rem;\n  qx.push(sx), qy.push(sy), rem.push(n);\n\n  while(!qx.empty()){\n    int x = qx.front(); qx.pop();\n    int y = qy.front(); qy.pop();\n    int r = rem.front(); rem.pop();\n\n    if(r == 0) continue;\n\n    for(int i = 0 ; i < 4 ; i++){\n      int nx = x + dx[i];\n      int ny = y + dy[i];\n\n      if(!check(nx, ny) || (nx == bx && ny == by)){\n        P[ny][nx][r-1] += P[y][x][r] / 4;\n        qx.push(x), qy.push(y), rem.push(r-1);\n      }else{\n        P[ny][nx][r-1] += P[y][x][r] / 4;\n        qx.push(nx), qy.push(ny), rem.push(r-1);\n      }\n    }\n  }\n\n  printf(\"%.8f\\n\",P[gy][gx][0]);\n}\n\nint main(){\n  char s, t, b;\n  \n  while(cin >> n, n){\n    memset(P, 0, sizeof(P));\n\n    cin >> s >> t >> b;\n    int ss = s - 'A', tt = t - 'A', bb = b - 'A';\n    sx = ss%3; sy = ss/3;\n    gx = tt%3; gy = tt/3;\n    bx = bb%3; by = bb/3;\n    solve();\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\nint main()\n{\n\tint c,n,s,t,b,i,j,k,x[9][4]={{1,3,0,0},{0,2,4,1},{1,5,2,2},{0,4,6,3},{1,3,5,7},{2,4,8,5},{3,7,6,6},{4,6,8,7},{5,7,8,8}};\n\tchar _[9];\n\twhile(scanf(\"%d\",&n),n)\n\t{\n\t\tint a[16][9]={0};\n\t\tgetchar(),fgets(_,9,stdin);\n\t\ts=_[0]-'A',t=_[2]-'A',b=_[4]-'A';\n\t\tc=a[0][s]=1;\n\t\tfor(i=0;i<n;++i,c*=4)for(j=0;j<9;++j)for(k=0;k<4;++k)\n\t\t\tif(x[j][k]!=b)a[i+1][x[j][k]]+=a[i][j];\n\t\t\telse a[i+1][j]+=a[i][j];\n\t\t\tprintf(\"%.8f\\n\",a[n][t]/(double)c);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <iomanip>\n#include <stdio.h>\nusing namespace std;\n\ndouble prob(int n,int pos,int t,int d)\n{\n\tdouble map[9]={0};\n\tmap[pos] = 1;\n\tfor(int i=0; i<n; i++)\n\t{\n\t\tdouble nmap[9]={0};\n\t\tfor (int j=0; j<9; j++)\n\t\t{\n\t\t\tif ((j-3<0)||(j-3==d)){\n\t\t\t\tnmap[j]+=map[j]/4.0;\n\t\t\t} else {\n\t\t\t\tnmap[j-3]+=map[j]/4.0;\n\t\t\t}\n\t\t\tif ((j%3 == 0)||(j-1==d)){\n\t\t\t\tnmap[j]+=map[j]/4.0;\n\t\t\t} else {\n\t\t\t\tnmap[j-1]+=map[j]/4.0;\n\t\t\t}\n\t\t\tif ((j%3 == 2)||(j+1==d)){\n\t\t\t\tnmap[j]+=map[j]/4.0;\n\t\t\t} else {\n\t\t\t\tnmap[j+1]+=map[j]/4.0;\n\t\t\t}\n\t\t\tif ((j+3>8)||(j+3==d)){\n\t\t\t\tnmap[j]+=map[j]/4.0;\n\t\t\t} else {\n\t\t\t\tnmap[j+3]+=map[j]/4.0;\n\t\t\t}\n\t\t}\n\t\tfor (int j=0; j<9; j++)\n\t\t{\n\t\t\tmap[j]=nmap[j];\n\t\t}\n\t}\n\treturn map[t];\n}\n\nint main() {\n\tvector<double> r;\n\twhile(true)\n\t{\n\t\tint n;\n\t\tcin >> n;\n\t\tif (n==0){break;}\n\t\tchar a[2],b[2],c[2];\n\t\tint s=0,t=0,d=0;\n\t\tscanf(\"%s %s %s\",a,b,c);\n\t\ts = a[0] - 'A';\n\t\tt = b[0] - 'A';\n\t\td = c[0] - 'A';\n\t\tr.push_back(prob(n,s,t,d));\n\t}\n\tfor(int i=0; i<r.size(); i++)\n\t{\n\t\tcout << setprecision(10) << r[i] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint dp[16][9];\nconst int m[]={-3,-1,1,3};\nint main(){\n\twhile(true){\n\t\tint n;\tcin>>n;\n\t\tif(n==0)\treturn 0;\n\t\tchar s,t,b;\tcin>>s>>t>>b;\n\t\tint ss=s-'A',bb=b-'A',tt=t-'A';\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdp[0][tt]=1;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int j=0;j<9;j++){\n\t\t\t\tif(dp[i][j]==0)\tcontinue;\n\t\t\t\tfor(int k=0;k<4;k++){\n\t\t\t\t\tif(j+m[k]<0||9<=j+m[k])\tdp[i+1][j]+=dp[i][j];\n\t\t\t\t\telse if(bb==j+m[k])\tdp[i+1][j]+=dp[i][j];\n\t\t\t\t\telse \tdp[i+1][j+m[k]]+=dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint div=1<<(2*n);\n\t\tprintf(\"%.15lf\\n\",(double)dp[n][ss]/(double)div);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<numeric>\nint main()\n{\n\tint n,s,t,b,i,j,k,x[9][4]={{1,3,0,0},{0,2,4,1},{1,5,2,2},{0,4,6,3},{1,3,5,7},{2,4,8,6},{3,7,0,0},{4,6,8,7},{5,7,8,8}};\n\tchar _[9];\n\twhile(scanf(\"%d\",&n),n)\n\t{\n\t\tint a[101][9]={0};\n\t\tgetchar(),fgets(_,9,stdin);\n\t\ts=_[0]-'A',t=_[2]-'A',b=_[4]-'A';\n\t\ta[0][s]=1;\n\t\tfor(i=0;i<n;++i)for(j=0;j<9;++j)for(k=0;k<4;++k)\n\t\t\tif(x[j][k]!=b)a[i+1][x[j][k]]+=a[i][j];\n\t\t\telse a[i+1][j]+=a[i][j];\n\t\tprintf(\"%f\\n\",a[n][t]/(double)std::accumulate(a[n],a[n]+9,0));\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\nint n;\nchar room[10] = \"ABCDEFGHI\";\nchar s, t, b;\nint off[4][2] = {{-1, 0}, {1, 0}, {0, -1}, {0, 1}};\nint x, y;\n\ndouble table[3][3];\n\ndouble solve()\n{\n\tmemset(&table[0][0], 0, sizeof(double) * 9);\n\ttable[x][y] = 1.0;\n\tfor(int k=0; k<n; k++)\n\t{\n\t\tdouble temp[3][3];\n\t\tmemset(&temp[0][0], 0, sizeof(double) * 9);\n\t\tfor(int j=0; j<3; j++)\n\t\t{\n\t\t\tfor(int i=0; i<3; i++)\n\t\t\t{\n\t\t\t\tif(table[j][i] != 0.0)\n\t\t\t\t{\n\t\t\t\t\tfor(int m=0; m<4; m++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint xx = i + off[m][0];\n\t\t\t\t\t\tint yy = j + off[m][1];\n\t\t\t\t\t\tint index = xx + yy * 3;\n\t\t\t\t\t\txx = (xx>=0 && xx<3 && room[index] != b) ? xx : i;\n\t\t\t\t\t\tyy = (yy>=0 && yy<3 && room[index] != b) ? yy : j;\n\t\t\t\t\t\ttemp[yy][xx] += table[j][i] / 4.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tmemcpy(&table[0][0], &temp[0][0], sizeof(double) * 9);\n\t}\n\n\tfor(int i=0; i<9; i++)\n\t{\n\t\tif(room[i]==t) return table[i/3][i%3];\n\t}\n\n\treturn 0.0;\n}\n\nint main()\n{\n\twhile( 1 )\n\t{\n\t\tcin >> n;\n\t\tif(n==0) break;\n\t\t\n\t\tcin >> s >> t >> b;\n\t\tfor(int i=0; i<9; i++)\n\t\t{\n\t\t\tif(room[i] == s)\n\t\t\t{\n\t\t\t\tx = i%3;\n\t\t\t\ty = i/3;\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8f\\n\", solve());\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n\nusing namespace std;\n\nint b_row,b_col,memo[16][3][3];\n\nchar b[2];\n\nbool rangeCheck(int row,int col){\n\tif(row >= 0 && row <= 2 && col >= 0 && col <= 2)return true;\n\telse{\n\t\treturn false;\n\t}\n}\n\nint translate(char ch){\n\tswitch(ch){\n\tcase 'A':return 0;\n\tcase 'B':return 1;\n\tcase 'C':return 2;\n\tcase 'D':return 10;\n\tcase 'E':return 11;\n\tcase 'F':return 12;\n\tcase 'G':return 20;\n\tcase 'H':return 21;\n\tcase 'I':return 22;\n\t}\n\n\treturn -1; //must not reach here.\n}\n\nint main(){\n\n\tint n,tmp,energy_row,energy_col,row,col,div_row[4] = {-1,0,0,1},div_col[4] = {0,-1,1,0};\n\tchar start[2],energy[2];\n\n\twhile(true){\n\t\tscanf(\"%d\",&n);\n\t\tif(n == 0)break;\n\n\t\tfor(int i = 0; i < 16; i++){\n\t\t\tfor(int p = 0; p < 3; p++){\n\t\t\t\tfor(int k = 0; k < 3; k++)memo[i][p][k] = 0;\n\t\t\t}\n\n\t\t}\n\n\t\tscanf(\"%s %s %s\",start,energy,b);\n\n\t\ttmp = translate(b[0]);\n\t\tb_row = tmp/10;\n\t\tb_col = tmp%10;\n\n\t\ttmp = translate(energy[0]);\n\t\tenergy_row = tmp/10;\n\t\tenergy_col = tmp%10;\n\n\t\ttmp = translate(start[0]);\n\n\t\trow = tmp/10,col = tmp%10;\n\n\t\tmemo[0][row][col] = 1;\n\n\t\tfor(int loop = 0; loop <= n-1; loop++){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tif(i != b_row || k != b_col){ //????????§????????´???\n\t\t\t\t\t\tfor(int p = 0; p < 4; p++){\n\t\t\t\t\t\t\tif(rangeCheck(i+div_row[p],k+div_col[p]) == true && (i+div_row[p] != b_row || k + div_col[p] != b_col)){ //?§????????????§??????????????????????????§??????\n\t\t\t\t\t\t\t\tmemo[loop+1][i+div_row[p]][k+div_col[p]] += memo[loop][i][k];\n\t\t\t\t\t\t\t}else{ //?°?????????¨???1????????????????????????????????´?????????????????´??????????????¨????????´????????°???????????????\n\t\t\t\t\t\t\t\tmemo[loop+1][i][k] = memo[loop][i][k];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\",((double)memo[n][energy_row][energy_col])/((double)pow(4,n)));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdlib.h>\n#include<iostream>\n#include<stdio.h>\n#include<string.h>\n#include<math.h>\n#include<algorithm>\n#include<cstring>\n#include<queue>\nusing namespace std;\n//AOJ1020\n//10 A E C ->0.12537479\nint n,c;\nchar s,t,b;\ndouble p,p1,nn;\nint d1[4]={0,1,0,-1},d2[4]={1,0,-1,0};\nchar map[3][3]={{'A','B','C'},{'D','E','F'},{'G','H','I'}};\ndouble df[10][16];//df[i][j]=i番の部屋にバッテリーjでいたときの確率\nvoid dfs(int y,int x,int n1){\n    double p1;\n\tint st=y*3+x;\n\tif(n1==0){\n        if(map[y][x]==t){\n\t\t\tp+=pow(0.25,nn);\n\t\t\tc++;\n\t\t}\n        return;\n    }else{\n\t\tif(df[st][n1]>=0){\n\t\t\tp+=df[st][n1];\n\t\t\tc++;\n\t\t\treturn;\n\t\t}else{\n\t\t    for(int i=0;i<4;i++){\n\t\t\t\tint my=y+d1[i],mx=x+d2[i];\n\t\t\t\tif(0<=my&&my<=2&&0<=mx&&mx<=2){//外壁にはぶつからない\n\t\t\t\t\tif(map[my][mx]==b){//倉庫にぶつかる\n\t\t\t\t\t\tp1=p;\n\t\t\t\t\t\tdfs(y,x,n1-1);\n\t\t\t\t\t\tdf[st][n1-1]=p-p1;\n\t\t\t\t\t}else{//普通に進む\n\t\t\t\t\t\tp1=p;\n\t\t\t\t\t\tdfs(my,mx,n1-1);\n\t\t\t\t\t\tdf[my*3+mx][n1-1]=p-p1;\n\t\t\t\t\t}\n\t\t\t\t}else{//外壁にぶつかる\n\t\t\t\t\tp1=p;\n\t\t\t\t\tdfs(y,x,n1-1);\n\t\t\t\t\tdf[st][n1-1]=p-p1;\n\t\t\t\t}\n\t\t    }\n\t\t}\n\t}\n    return;\n}\n\nint main(){\n    while(1){\n\t\tint y1,x1;\n        p=0;c=0;\n        cin>>n;\n        nn=(double)n;\n        if(n==0)break;\n        for(int i=0;i<10;i++){\n            for(int j=0;j<16;j++){\n                df[i][j]=-1;\n            }\n        }\n\t\tcin>>s>>t>>b;\n\t\tfor(int i=0;i<3;i++){\n\t\t\tfor(int j=0;j<3;j++){\n\t\t\t\tif(map[i][j]==s){\n\t\t\t\t\ty1=i;x1=j;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n        dfs(y1,x1,n);\n        printf(\"%f\\n\",p);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n\nusing namespace std;\n\nint b_row,b_col,memo[16][3][3];\n\nchar b[2];\n\nbool rangeCheck(int row,int col){\n\tif(row >= 0 && row <= 2 && col >= 0 && col <= 2)return true;\n\telse{\n\t\treturn false;\n\t}\n}\n\nint translate(char ch){\n\tswitch(ch){\n\tcase 'A':return 0;\n\tcase 'B':return 1;\n\tcase 'C':return 2;\n\tcase 'D':return 10;\n\tcase 'E':return 11;\n\tcase 'F':return 12;\n\tcase 'G':return 20;\n\tcase 'H':return 21;\n\tcase 'I':return 22;\n\t}\n\n\treturn -1; //must not reach here.\n}\n\nint main(){\n\n\tint n,tmp,energy_row,energy_col,row,col;\n\tchar start[2],energy[2];\n\n\twhile(true){\n\t\tscanf(\"%d\",&n);\n\t\tif(n == 0)break;\n\n\t\tfor(int i = 0; i < 16; i++){\n\t\t\tfor(int p = 0; p < 3; p++){\n\t\t\t\tfor(int k = 0; k < 3; k++)memo[i][p][k] = 0;\n\t\t\t}\n\n\t\t}\n\n\t\tscanf(\"%s %s %s\",start,energy,b);\n\n\t\ttmp = translate(b[0]);\n\t\tb_row = tmp/10;\n\t\tb_col = tmp%10;\n\n\t\ttmp = translate(energy[0]);\n\t\tenergy_row = tmp/10;\n\t\tenergy_col = tmp%10;\n\n\t\ttmp = translate(start[0]);\n\n\t\trow = tmp/10,col = tmp%10;\n\n\t\tif(rangeCheck(row,col-1) == true && (row != b_row || col-1 != b_col)){\n\t\t\tmemo[1][row][col-1] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] += 1;\n\t\t}\n\n\t\tif(rangeCheck(row,col+1) == true && (row != b_row || col+1 != b_col)){\n\t\t\tmemo[1][row][col+1] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] += 1;\n\t\t}\n\n\t\tif(rangeCheck(row-1,col) == true && (row-1 != b_row || col != b_col)){\n\t\t\tmemo[1][row-1][col] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] += 1;\n\t\t}\n\n\t\tif(rangeCheck(row+1,col) == true && (row+1 != b_row || col != b_col)){\n\t\t\tmemo[1][row+1][col] = 1;\n\t\t}else{\n\t\t\tmemo[1][row][col] += 1;\n\t\t}\n\n\t\tfor(int loop = 2; loop <= n; loop++){\n\t\t\tfor(int i = 0; i < 3; i++){\n\t\t\t\tfor(int k = 0; k < 3; k++){\n\t\t\t\t\tif(i == b_row && k == b_col){\n\t\t\t\t\t\tmemo[loop][i][k] = 0;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(i == 0 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][0][0] = memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][0][0] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][0][0] += memo[loop-1][1][0];\n\t\t\t\t\t\t}else if(i == 0 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][0][1] = memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 0)memo[loop][0][1] += memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][0][1] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 2)memo[loop][0][1] += memo[loop-1][0][2];\n\t\t\t\t\t\t}else if(i == 0 && k == 2){\n\t\t\t\t\t\t\tmemo[loop][0][2] = memo[loop-1][0][2];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][0][2] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][0][2] += memo[loop-1][1][2];\n\t\t\t\t\t\t}else if(i == 1 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][1][0] = memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 0)memo[loop][1][0] += memo[loop-1][0][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][1][0] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 0)memo[loop][1][0] += memo[loop-1][2][0];\n\t\t\t\t\t\t}else if(i == 1 && k == 1){\n\t\t\t\t\t\t\tif(b_row == 1 || b_col == 1){ //????????????????§??????§???????????????????????´?????¨????????????????????§??????????????????????¶??????????????????????\n\t\t\t\t\t\t\t\tmemo[loop][1][1] = memo[loop-1][1][1];\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 1)memo[loop][1][1] += memo[loop-1][0][1];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][1][1] += memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][1][1] += memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][1][1] += memo[loop-1][2][1];\n\t\t\t\t\t\t}else if(i == 1 && k == 2){\n\t\t\t\t\t\t\tmemo[loop][1][2] = memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 0 || b_col != 2)memo[loop][1][2] += memo[loop-1][0][2];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][1][2] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 2)memo[loop][1][2] += memo[loop-1][2][2];\n\t\t\t\t\t\t}else if(i == 2 && k == 0){\n\t\t\t\t\t\t\tmemo[loop][2][0] = memo[loop-1][2][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 0)memo[loop][2][0] += memo[loop-1][1][0];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][2][0] += memo[loop-1][2][1];\n\t\t\t\t\t\t}else if(i == 2 && k == 1){\n\t\t\t\t\t\t\tmemo[loop][2][1] = memo[loop-1][2][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 0)memo[loop][2][1] += memo[loop-1][2][0];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 1)memo[loop][2][1] += memo[loop-1][1][1];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 2)memo[loop][2][1] += memo[loop-1][2][2];\n\t\t\t\t\t\t}else{ //i == 2 && k == 2\n\t\t\t\t\t\t\tmemo[loop][2][2] = memo[loop-1][2][2];\n\t\t\t\t\t\t\tif(b_row != 1 || b_col != 2)memo[loop][2][2] += memo[loop-1][1][2];\n\t\t\t\t\t\t\tif(b_row != 2 || b_col != 1)memo[loop][2][2] += memo[loop-1][2][1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%.8lf\\n\",((double)memo[n][energy_row][energy_col])/((double)pow(4,n)));\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "Haskell",
    "code": "import Control.Applicative ((<$>))\nimport Control.Monad (unless)\nimport Data.List (delete)\nimport Data.Vector.Unboxed (Vector, (!), (//))\nimport qualified Data.Vector.Unboxed as V\nimport Text.Printf\n\nmain :: IO ()\nmain = do\n  n <- readLn\n  unless (n == 0) $ do\n    solve n <$> words <$> getLine >>= printf \"%f\\n\"\n    main\n\nsolve :: Int -> [String] -> Double\nsolve n [s, t, b] = f n (iv b // [(idx s, 1.0)]) ! (idx t)\n  where f p bd | p == 0 = bd\n               | otherwise = f (p-1) (V.accum (+) (iv b) g)\n          where g = do\n                  i <- mvi b\n                  j <- [i-5, i-1, i+1, i+5]\n                  if bd ! j < 0 then return (i, 0.25 * (bd ! i))\n                    else return (i, 0.25 * (bd ! j))\n\nmvi :: String -> [Int]\nmvi b = delete (idx b) [6, 7, 8, 11, 12, 13, 16, 17, 18]\n\niv :: String -> Vector Double\niv b = V.replicate 25 (-1) // [(i, 0) | i <- mvi b]\n\nidx :: String -> Int\nidx \"A\" = 6\nidx \"B\" = 7\nidx \"C\" = 8\nidx \"D\" = 11\nidx \"E\" = 12\nidx \"F\" = 13\nidx \"G\" = 16\nidx \"H\" = 17\nidx \"I\" = 18\nidx _ = -1\n\n"
  },
  {
    "language": "Haskell",
    "code": "import Control.Applicative ((<$>))\nimport Control.Monad (unless)\nimport Data.List (delete)\nimport Data.Vector.Unboxed (Vector, (!), (//))\nimport qualified Data.Vector.Unboxed as V\n\nmain :: IO ()\nmain = do\n  n <- readLn\n  unless (n == 0) $ do\n    solve n <$> words <$> getLine >>= print\n    main\n\nsolve :: Int -> [String] -> Double\nsolve n [s, t, b] = f n (iv b // [(idx s, 1.0)]) ! (idx t)\n  where f p bd | p == 0 = bd\n               | otherwise = f (p-1) (V.accum (+) (iv b) g)\n          where g = do\n                  i <- mvi b\n                  j <- [i-5, i-1, i+1, i+5]\n                  if bd ! j < 0 then return (i, 0.25 * (bd ! i))\n                    else return (i, 0.25 * (bd ! j))\n\nmvi :: String -> [Int]\nmvi b = delete (idx b) [6, 7, 8, 11, 12, 13, 16, 17, 18]\n\niv :: String -> Vector Double\niv b = V.replicate 25 (-1) // [(i, 0) | i <- mvi b]\n\nidx :: String -> Int\nidx \"A\" = 6\nidx \"B\" = 7\nidx \"C\" = 8\nidx \"D\" = 11\nidx \"E\" = 12\nidx \"F\" = 13\nidx \"G\" = 16\nidx \"H\" = 17\nidx \"I\" = 18\nidx _ = -1\n\n"
  },
  {
    "language": "Haskell",
    "code": "import Control.Applicative\nimport Control.Monad\nimport Control.Monad.ST\n-- import qualified Data.ByteString as BS\nimport Data.Functor\nimport Data.Function\nimport Data.Monoid\nimport Data.Maybe\nimport Data.List\nimport qualified Data.Foldable as Foldable\n--import qualified Data.Set as Set\n--import qualified Data.Sequence as Sequence\nimport Data.List.Split\nimport Data.Bits\nimport Data.Char\nimport Data.Ix\nimport Data.Ratio\nimport Data.Ord\nimport Data.Fixed\nimport Data.Tuple\nimport Data.Array\n--import Data.Array.Unboxed\n--import Data.Array.IArray\nimport Data.Array.MArray\nimport Data.Array.IO\nimport Data.Array.ST\nimport Data.IORef\nimport Data.STRef\nimport Text.Printf\nimport System.IO\n-- import System.IO.Unsafe\n \n-- templete\nreadInt = read :: String -> Int\nreadInteger = read :: String -> Integer\nreadDouble = read :: String -> Double\ngetInt = readLn :: IO Int\ngetInts = map readInt . words <$> getLine\ngetInteger = readLn :: IO Integer\ngetIntegers = map readInteger . words <$> getLine\ngetDouble = readLn :: IO Double\ngetDoubles = map readDouble . words <$> getLine\nsjoin :: (Show a) => [a] -> String\nsjoin = unwords . map show\ntjoin :: (Show a, Show b) => (a, b) -> String\ntjoin (x, y) = show x ++ (' ' : show y)\ncond :: a -> a -> Bool -> a\ncond t f c = if c then t else f\napply2 :: (a -> a -> b) -> [a] -> b\napply2 f [x,y] = f x y\napply3 :: (a -> a -> a -> b) -> [a] -> b\napply3 f [x,y,z] = f x y z\napply4 :: (a -> a -> a -> a -> b) -> [a] -> b\napply4 f [x,y,z,w] = f x y z w\nfnTuple :: (a -> b, a -> c) -> a -> (b, c)\nfnTuple (f,g) a = (f a, g a)\nreplace :: (Eq a) => a -> a -> [a] -> [a]\nreplace x y = map (\\z -> if z==x then y else z)\nbinMap :: (a -> a -> b) -> [a] -> [b]\nbinMap f (x:xs@(y:_)) = f x y : binMap f xs\nbinMap _ _ = []\nsplitRec :: Int -> [a] -> [[a]]\nsplitRec _ [] = []\nsplitRec n xs = let (y,ys) = splitAt n xs in y : splitRec n ys\ninfixl 7 `divCeil`\ndivCeil :: Integral a => a -> a -> a\nx `divCeil` y = (x+y-1) `div` y\ncoverC :: Ord a => (a, a) -> a -> Bool\ncoverC (l,r) x = l<=x && x<=r\ncoverH :: Ord a => (a, a) -> a -> Bool\ncoverH (l,r) x = l<=x && x<r\nibsearch :: (Int -> Bool) -> (Int,Int) -> Int\nibsearch f (ok,ng) = if abs (ok-ng) <= 1 then ok else let mid = (ok + ng) `div` 2 in ibsearch f (if f mid then (mid,ng) else (ok,mid))\nwhenM :: Monad m => m Bool -> m () -> m ()\nwhenM c a = c >>= flip when a\nunconsU :: [a] -> (a, [a])\nunconsU (x:xs) = (x, xs)\n-- templete\n\nnext :: Char -> [Char]\nnext 'A' = \"AABD\"\nnext 'B' = \"ABCE\"\nnext 'C' = \"BCCF\"\nnext 'D' = \"DAEG\"\nnext 'E' = \"DBFH\"\nnext 'F' = \"ECFI\"\nnext 'G' = \"GDHG\"\nnext 'H' = \"GEIH\"\nnext 'I' = \"HFII\"\n\nnextTime :: Char -> Array Char Double -> Array Char Double\nnextTime ng a = runSTArray $ do\n    res <- newArray ('A','I') 0.0 :: ST s (STArray s Char Double)\n    forM_ (assocs a) $ \\(c, p) -> do\n        when (c/=ng) $ do\n            forM_ (next c) $ \\d -> do\n                let d' = if d==ng then c else d\n                readArray res d' >>= writeArray res d' . (+(p/4))\n    return res\n\nmain = do\n    n <- getInt\n    when (n/=0) $ do\n        [s,' ',t,' ',b] <- getLine\n        let initial = array ('A','I') $ [(c, 0) | c <- \"ABCDEFGHI\"] ++ [(s, 1)] :: Array Char Double\n        let func = nextTime b\n        let res = foldr ($) initial $ replicate n func\n        printf \"%.15f\\n\" $ res!t\n        main\n"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\n#include<math.h>\n\nint m[4]={3,-3,1,-1},s,t,b;\n\nint dp[9][16];\n\nint d(int pos,int buttery)\n{\n\tint i,n=0;\n\tif(dp[pos][buttery]!=-1)\n\t\treturn dp[pos][buttery];\n\tif(buttery==0&&pos==t)\n\t\treturn 1;\n\telse if(buttery>0&&(abs(pos/3-t/3)+abs(pos%3-t%3))<=buttery)\n\t{\n\t\tfor(i=0;i<4;i++)\n\t\t{\n\t\t\tif(pos+m[i]>=0 && pos+m[i]<9 && pos+m[i]!=b)\n\t\t\t\tn+=d(pos+m[i],buttery-1);\n\t\t\telse\n\t\t\t\tn+=d(pos,buttery-1);\n\t\t}\n\t}\n\treturn dp[pos][buttery]= n;\n}\n\nint main()\n{\n\tint buttery,ans,tmp1;\n\tdouble tmp2;\n\tfor(;scanf(\"%d\",&buttery);ans=0)\n\t{\n\t\tif(buttery==0)\n\t\t\treturn 0;\n\t\tscanf(\"\\n%c %c %c\",&s,&t,&b);\n\t\tmemset(dp,-1,sizeof(dp));\n\t\ts-=65;t-=65;b-=65;\n\t\tans=d(s,buttery);\n\t\ttmp1=1<<(buttery*2);\n\t\ttmp2=(double)ans/tmp1;\n\t\tprintf(\"%.8lf\\n\",tmp2);\n\t}\n}"
  },
  {
    "language": "C",
    "code": "/*\nAizuOnline A1020\nTitle Cleaning Robot\n*/\n#include <stdio.h>\n// Select Below\n//#include <stdlib.h>\n//#include <string.h>\n#include <float.h>\n//#include <math.h>\n//#include <limits.h>\n//Global data section\n// p[from_state][to_state]\n//state 0:A,1:B,2:C\n//      \nint n;\nchar s,t,b;      \ndouble p[16][9];\nint tr0[9][9]={{2,1,0,1,0,0,0,0,0},\n              {1,1,1,0,1,0,0,0,0},\n              {0,1,2,0,0,1,0,0,0},\n              {1,0,0,1,1,0,1,0,0},\n              {0,1,0,1,0,1,0,1,0},\n              {0,0,1,0,1,1,0,0,1},\n              {0,0,0,1,0,0,2,1,0},\n              {0,0,0,0,1,0,1,1,1},\n              {0,0,0,0,0,1,0,1,2}};\nint tr[9][9];\n//\nvoid init()\n{\n        int i;\n\n        for(i=0;i<9;i++)\n                p[0][i]=0.0;\n        p[0][s-'A']=1.0;\n}\nvoid souko()\n{\n        int i,j,b0;\n\n        for(i=0;i<9;i++)\n                for(j=0;j<9;j++)\n                        tr[i][j]=tr0[i][j];\n\n        b0=b-'A';\n        for(i=0;i<9;i++)\n        {\n                tr[i][i] += tr[b0][i];\n                tr[b0][i] = 0;\n        }\n}\nvoid show(int n)\n{\n        printf(\"----------------\\n\");\n        printf(\"%lf %lf %lf\\n\",p[n][0],p[n][1],p[n][2]);\n        printf(\"%lf %lf %lf\\n\",p[n][3],p[n][4],p[n][5]);\n        printf(\"%lf %lf %lf\\n\",p[n][6],p[n][7],p[n][8]);\n}\n\nmain()\n{\n        int i,j,k;\n        double sum;\n        \n        while(scanf(\"%d \",&n) && n)\n        {\n                scanf(\"%c %c %c\",&s,&t,&b);\n                init();\n                souko();\n\n                //show(0);\n                for(i=0;i<n;i++)\n                {                        \n                        for(j=0;j<9;j++)\n                        {\n                                sum=0.0;\n                                for(k=0;k<9;k++)\n                                        sum += (double)tr[j][k]/4.0*p[i][k];\n                                p[i+1][j]=sum;\n                        }\n                        show(i+1);\n                }\n\n                printf(\"%0.8lf\\n\",p[n][t-'A']);\n        }\nreturn(0);\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\n#include<math.h>\n\nint m[4]={3,-3,1,-1},s,t,b,dp[9][16];\n\nint d(int p,int n)\n{\n\tint i,r=0;\n\tif(dp[p][n]!=-1)\n\t\treturn dp[p][n];\n\tif(n==0)\n\t{\n\t\tif(p==t)\n\t\t\treturn 1;\n\t\telse\n\t\t\treturn 0;\n\t}\n\telse if(n>0&&(abs(p/3-t/3)+abs(p%3-t%3))<=n)\n\t{\n\t\tfor(i=0;i<4;i++)\n\t\t{\n\t\t\tif(p+m[i]>=0 && p+m[i]<9 && p+m[i]!=b)\n\t\t\t\tr+=d(p+m[i],n-1);\n\t\t\telse\n\t\t\t\tr+=d(p,n-1);\n\t\t}\n\t}\n\treturn dp[p][n]= r;\n}\n\nint main()\n{\n\tint n,ans,tmp1;\n\tdouble tmp2;\n\tfor(;scanf(\"%d\",&n);ans=0)\n\t{\n\t\tif(n==0)\n\t\t\treturn 0;\n\t\tscanf(\"\\n%c %c %c\",&s,&t,&b);\n\t\tmemset(dp,-1,sizeof(dp));\n\t\ts-=65;t-=65;b-=65;\n\t\tans=d(s,n);\n\t\ttmp1=1<<(n*2);\n\t\ttmp2=(double)ans/tmp1;\n\t\tprintf(\"%lf\\n\",tmp2);\n\t}\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <time.h>\nint main(void){\n\tint n;\n\tchar c;\n\tfor(; scanf(\"%d%c %*c %*c %*c\", &n, &c), n; ){\n\t\tif( c == ' ' ){\n\t\t\tclock_t c1 = clock() + CLOCKS_PER_SEC / 10;\n\t\t\twhile( clock() < c1 );\n\t\t}\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nchar from, battery, to;\ndouble prob[16][16]; //残量iで, 地点jからtoへいける確率\n\ndouble getProb(int lim, int start)\n{\n    int i;\n    double ans;\n    double possi;\n    if (prob[lim][start] >= 0){\n        return (prob[lim][start]);\n    }\n    \n    if (start == battery && lim == 0){\n        return (1.0);\n    }\n    if (lim == 0){\n        return (0);\n    }\n    \n    ans = 0.0;\n    \n    if ((start + 1) % 3 && start + 1 != to){\n        ans += 0.25 * getProb(lim - 1, start + 1);\n    }\n    else {\n        ans += 0.25 * getProb(lim - 1, start);\n    }\n    \n    if (start % 3 && start - 1 != to){\n        ans += 0.25 * getProb(lim - 1, start - 1);\n    }\n    else {\n        ans += 0.25 * getProb(lim - 1, start);\n    }\n    \n    if (start + 3 < 9 && start + 3 != to){\n        ans += 0.25 * getProb(lim - 1, start + 3);\n    }\n    else {\n        ans += 0.25 * getProb(lim - 1, start);\n    }\n    \n    if (start - 3 >= 0 && start - 3 != to){\n        ans += 0.25 * getProb(lim - 1, start - 3);\n    }\n    else {\n        ans += 0.25 * getProb(lim  -1, start);\n    }\n    \n    return (prob[lim][start] = ans);\n}\n\nint main(void)\n{\n    int left;\n    int i, j;\n    \n    while (scanf(\"%d\", &left) && left){\n        getchar();\n        scanf(\"%c %c %c\", &from, &battery, &to);\n        \n        from -= 'A'; battery -= 'A'; to -= 'A';\n        \n        for (i = 0; i < 16; i++){\n            for (j = 0; j < 16; j++){\n                prob[i][j] = -1;\n            }\n        }\n        \n        printf(\"%.8lf\\n\", getProb(left, from));\n    }\n    return (0);\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <ctype.h>\nint main(void){\n\tint a;\n\twhile(scanf(\"%d\",&a),a){\n\t\tif(getchar()==' '){\n\t\t\ta=getchar();\n\t\t\tif(a=='\\n')return 1;\n\t\t\tif(isupper(a))while(1);\n\t\t\tif(a==' '){puts(\"foo\");return 0;}\n\t\t}\n\t\tscanf(\" %*c %*c %*c\");\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "n,s,t,b;\ndouble P[16][9];\nmain(){\n\tint i;\n\tfor(;scanf(\"%d%s%s%s\",&n,&s,&t,&b)*n;){\n\t\tmemset(P,0,sizeof(P));\n\t\tP[n][s-'A']=1;\n\t\tfor(;n--;){\n\t\t\tfor(i=0;i<9;i++){\n\t\t\t\tP[n][i/3>0&&i-3!=b-'A'?i-3:i]+=P[n+1][i]/4;\n\t\t\t\tP[n][i/3<2&&i+3!=b-'A'?i+3:i]+=P[n+1][i]/4;\n\t\t\t\tP[n][i%3>0&&i-1!=b-'A'?i-1:i]+=P[n+1][i]/4;\n\t\t\t\tP[n][i%3<2&&i+1!=b-'A'?i+1:i]+=P[n+1][i]/4;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%f\\n\",P[0][t-'A']);\n\t}\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n\n/** Application main entry point. */\nint main (\n  int     argc,\n  char  * argv[ ]\n  )\n{\n  int i, x, y;\n\n  for ( ; ; )\n  {\n    int map[ 2 ][ 3 ][ 3 ] = { { { 0 } } };\n    int mother = 1;\n    int sw = 0;\n    int n;\n    int sx, sy, tx, ty, bx, by;\n    char s, t, b;\n\n    scanf ( \" %d\", &n );\n    if ( !n ) break ;\n\n    scanf ( \" %c %c %c\", &s, &t, &b );\n    sx = ( s - 'A' ) % 3; sy = ( s - 'A' ) / 3;\n    tx = ( t - 'A' ) % 3; ty = ( t - 'A' ) / 3;\n    bx = ( b - 'A' ) % 3; by = ( b - 'A' ) / 3;\n\n    map[ sw ][ sx ][ sy ] = 1;\n    for ( i = 0; i < n; ++i )\n    {\n      mother *= 4;\n      sw = !sw;\n\n      memset ( map[ sw ], 0, sizeof ( map[ sw ] ) );\n\n      for ( y = 0; y < 3; ++y )\n      for ( x = 0; x < 3; ++x )\n      {\n        map[ sw ][ ( x < 1 || ( y == by && x - 1 == bx ) ? x : x - 1 ) ][ y ]\n          += map[ !sw ][ x ][ y ];\n        map[ sw ][ ( x > 1 || ( y == by && x + 1 == bx ) ? x : x + 1 ) ][ y ]\n          += map[ !sw ][ x ][ y ];\n        map[ sw ][ x ][ ( y < 1 || ( x == bx && y - 1 == by ) ? y : y - 1 ) ]\n          += map[ !sw ][ x ][ y ];\n        map[ sw ][ x ][ ( y > 1 || ( x == bx && y + 1 == by ) ? y : y + 1 ) ]\n          += map[ !sw ][ x ][ y ];\n      }\n    }\n\n    printf ( \"%.6lf\\n\", (double)map[ sw ][ tx ][ ty ] / (double)mother );\n  }\n\n  return ( 0 );\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n\nint first_x,first_y;\nint zyuden_x,zyuden_y;\nint soko_x,soko_y;\ndouble map[16][3][3];\n\nvoid get_where(int* x,int* y,char c) {\n\tif(c=='A'){*x=0;*y=0;}\n\tif(c=='B'){*x=1;*y=0;}\n\tif(c=='C'){*x=2;*y=0;}\n\tif(c=='D'){*x=0;*y=1;}\n\tif(c=='E'){*x=1;*y=1;}\n\tif(c=='F'){*x=2;*y=1;}\n\tif(c=='G'){*x=0;*y=2;}\n\tif(c=='H'){*x=1;*y=2;}\n\tif(c=='I'){*x=2;*y=2;}\n}\n\nint canmove(int x,int y) {\n\tif(x<0 || x>=3 || y<0 || y>=3)return 0;\n\tif(x==soko_x && y==soko_y)return 0;\n\treturn 1;\n}\n\nint main(void) {\n\tint battery;\n\tchar first[2],zyuden[2],soko[2];\n\tint i,j,k;\n\twhile(1) {\n\t\tscanf(\"%d\",&battery);\n\t\tif(battery==0)break;\n\t\tscanf(\"%s%s%s\",first,zyuden,soko);\n\t\tget_where(&first_x,&first_y,first[0]);\n\t\tget_where(&zyuden_x,&zyuden_y,zyuden[0]);\n\t\tget_where(&soko_x,&soko_y,soko[0]);\n\t\tmemset(map,0,sizeof(map));\n\t\tmap[0][first_x][first_y]=1;\n\t\tfor(i=0;i<battery;i++) {\n\t\t\tfor(j=0;j<3;j++) {\n\t\t\t\tfor(k=0;k<3;k++) {\n\t\t\t\t\tif(canmove(j-1,k))map[i+1][j-1][k]+=map[i][j][k]/4;\n\t\t\t\t\telse map[i+1][j][k]+=map[i][j][k]/4;\n\t\t\t\t\tif(canmove(j+1,k))map[i+1][j+1][k]+=map[i][j][k]/4;\n\t\t\t\t\telse map[i+1][j][k]+=map[i][j][k]/4;\n\t\t\t\t\tif(canmove(j,k-1))map[i+1][j][k-1]+=map[i][j][k]/4;\n\t\t\t\t\telse map[i+1][j][k]+=map[i][j][k]/4;\n\t\t\t\t\tif(canmove(j,k+1))map[i+1][j][k+1]+=map[i][j][k]/4;\n\t\t\t\t\telse map[i+1][j][k]+=map[i][j][k]/4;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.15f\\n\",map[battery][zyuden_x][zyuden_y]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\nint main(void){\n\tint n;\n\tchar c;\n\tfor(; scanf(\"%d%c %*c %*c %*c\",&n,&c),n;)\n\t\tif(c==' ')return 1;\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(void){\n  double p[16][9];\n  int souko,goal,robo;\n  char s,t,b,tmp;\n  int n;\n  int i,j,k;\n  while(scanf(\"%d%*c\",&n) && n){\n    scanf(\"%c %c %c%*c\",&s,&t,&b);\n    robo=s-'A';\n    goal=t-'A';\n    souko=b-'A';\n    for(i=0;i<16;i++) for(j=0;j<9;j++) p[i][j]=0;\n    p[0][robo]=1.0;\n    for(i=1;i<=n;i++){\n      for(j=0;j<9;j++){\n\tp[i][j]=0;\n\tif(j==souko) continue;\n\tp[i][j]+=((j<3 || j-3==souko)?p[i-1][j]:p[i-1][j-3])*0.25;\n\tp[i][j]+=((j%3==0 || j-1==souko)?p[i-1][j]:p[i-1][j-1])*0.25;\n\tp[i][j]+=((j%3==2 || j+1==souko)?p[i-1][j]:p[i-1][j+1])*0.25;\n\tp[i][j]+=((j>5 || j+3==souko)?p[i-1][j]:p[i-1][j+3])*0.25;\n      }\n    }\n    printf(\"%.8f\\n\",p[n][goal]);\n  }\n  return 0;\n}\n\t   "
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n\nint first_x,first_y;\nint zyuden_x,zyuden_y;\nint soko_x,soko_y;\ndouble map[16][5][5];\n\nvoid get_where(int* x,int* y,char c) {\n\tif(c=='A'){*x=1;*y=1;}\n\tif(c=='B'){*x=2;*y=1;}\n\tif(c=='C'){*x=3;*y=1;}\n\tif(c=='D'){*x=1;*y=2;}\n\tif(c=='E'){*x=2;*y=2;}\n\tif(c=='F'){*x=3;*y=2;}\n\tif(c=='G'){*x=1;*y=3;}\n\tif(c=='H'){*x=2;*y=3;}\n\tif(c=='I'){*x=3;*y=3;}\n}\n\nint main(void) {\n\tint battery;\n\tchar first[2],zyuden[2],soko[2];\n\tint i,j,k;\n\twhile(1) {\n\t\tscanf(\"%d\",&battery);\n\t\tif(battery==0)break;\n\t\tscanf(\"%s%s%s\",first,zyuden,soko);\n\t\tget_where(&first_x,&first_y,first[0]);\n\t\tget_where(&zyuden_x,&zyuden_y,zyuden[0]);\n\t\tget_where(&soko_x,&soko_y,soko[0]);\n\t\tmemset(map,0,sizeof(map));\n\t\tmap[0][first_x][first_y]=1;\n\t\tfor(i=1;i<=battery;i++) {\n\t\t\tfor(j=1;j<=3;j++) {\n\t\t\t\tfor(k=1;k<=3;k++) {\n\t\t\t\t\tmap[i][j][k]=\n\t\t\t\t\t\t(map[i-1][j-1][k]+map[i-1][j+1][k]+\n\t\t\t\t\t\t map[i-1][j][k-1]+map[i-1][j][k+1])/4.0;\n\t\t\t\t\tif(j==soko_x && k==soko_y)map[i][j][k]=0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.15f\\n\",map[battery][zyuden_x][zyuden_y]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\nint main(void){\n\tchar c;\n\tint a;\n\tfor( a = 0; a < 10; ++a ) scanf(\"%*d%c %*c %*c %*c\", &c );\n\treturn c==' ';\n}"
  },
  {
    "language": "C",
    "code": "/*\n  AOJ 1020\n  Title:cleaning robot\n  @kankichi573\n*/\n#include <stdio.h>\n#include <string.h>\n#include <float.h>\nint n;\nchar s,t,b;\n\ndouble matrix[9][9];\ndouble myvector[9];\nchar rinsetu[24][2];\nchar rinsetu_org[12][2]=\n  {\"AB\",\"BC\",\"DE\",\"EF\",\"GH\",\"HI\",\n   \"AD\",\"DG\",\"BE\",\"EH\",\"CF\",\"FI\"};\nvoid init_rinsetu()\n{\n  int i,j;\n  for(i=0;i<12;i++)\n    for(j=0;j<2;j++)\n      rinsetu[i][j]=rinsetu_org[i][j];\n}\nvoid make_reverse()\n{\n  int i;\n  for(i=0;i<12;i++)\n    {\n      rinsetu[i+12][0]=rinsetu[i][1];\n      rinsetu[i+12][1]=rinsetu[i][0];\n    }\n}\nvoid dump_rinsetu()\n{\n  int i;\n  for(i=0;i<24;i++)\n    printf(\"%c%c|\",rinsetu[i][0],rinsetu[i][1]);\n  printf(\"\\n\");\n}\nvoid delete_souko(char b)\n{\n  int i,j;\n  for(i=0;i<24;i++)\n    for(j=0;j<2;j++)\n      if(rinsetu[i][j]==b)\n\trinsetu[i][j]='X';\n}\n\nvoid make_matrix(char b)\n{\n  int i,j;\n  double s;\n\n  //printf(\"SOUKO=%c\\n\",b);\n  init_rinsetu();\n  make_reverse();\n  //dump_rinsetu();\n  delete_souko(b);\n  //dump_rinsetu();\n\n  for(i=0;i<9;i++)\n    for(j=0;j<9;j++)\n      matrix[i][j]=0.0;\n\n  for(i=0;i<24;i++)\n    if(rinsetu[i][0]!='X' && rinsetu[i][1]!='X')\n      matrix[rinsetu[i][0]-'A'][rinsetu[i][1]-'A']=0.25;\n\n  for(i=0;i<9;i++)\n    {\n      s=0;\n      for(j=0;j<9;j++)\n\t{\n\t  if(i!=j)\n\t    s += matrix[i][j];\n\t}\n      matrix[i][i]=1-s;\n    }\n}\nvoid matrix_vector_product()\n{\n  int i,j;\n  double work[9];\n  for(i=0;i<9;i++)\n    {\n      work[i]=0.0;\n      for(j=0;j<9;j++)\n\t{\n\t  work[i]+=myvector[j]*matrix[i][j];\n\t}\n    }\n  memcpy(myvector,work,9*sizeof(double));\n}\nint init_vector(char c)\n{\n  int i;\n  for(i=0;i<9;i++)\n    myvector[i]=0.0;\n  myvector[c-'A']=1.0;\n}\n void dump_matrix()\n {\n   int i,j;\n   for(i=0;i<9;i++)\n     {\n       for(j=0;j<9;j++)\n\t printf(\"%0.2lf \",matrix[i][j]);\n       printf(\"\\n\");\n     }\n }\nvoid dump_vector()\n{\n  int i;\n  for(i=0;i<9;i++)\n    printf(\"%0.3lf|\",myvector[i]);\n  printf(\"\\n\");\n}\nmain()\n{\n  int i;\n\n  while(scanf(\"%d \",&n) && n)\n    {\n      scanf(\"%c %c %c\",&s,&t,&b);\n      make_matrix(b);\n      init_vector(s);\n      //dump_matrix();\n      //printf(\"--------------------\\n\");\n      //dump_vector();\n      for(i=0;i<n;i++)\n\t{\n\t  matrix_vector_product();\n\t  //dump_vector();\n\t}\n      printf(\"%.7lf\\n\",myvector[t-'A']);\n    }\n\n\n  return(0);\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <ctype.h>\nint main(void){\n\tscanf(\"%*d\");\n\treturn getchar()==' ';\n}"
  },
  {
    "language": "C",
    "code": "// Aizu 1020: Cleaning Robot\n// 2017.9.17 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\nchar map[3][3];\nlong long f[16][3][3];\nint mv[4][2] = {{-1,0},{0,1},{1,0},{0,-1}};\n\nint main()\n{\n\tint n, s, t, b, i, j, r, c, r2, c2;\n\tchar t1[5], t2[5], t3[5];\n\tlong long ans;\n\n\twhile (scanf(\"%d\", &n) && n) {\n\t\tscanf(\"%s%s%s\", t1, t2, t3), s = *t1-'A', t = *t2-'A', b = *t3-'A';\n\t\tmemset(f, 0, sizeof(f)), memset(map, 0, sizeof(map));\n\t\tmap[b/3][b%3] = 1, f[0][s/3][s%3] = 1;\n\t\tfor (j = 1; j <= n; j++) {\n\t\t\tfor (r = 0; r < 3; r++) for (c = 0; c < 3; c++) {\n\t\t\t\tif (!f[j-1][r][c]) continue;\n\t\t\t\tfor (i = 0; i < 4; i++) {\n\t\t\t\t\tr2 = r + mv[i][0], c2 = c + mv[i][1];\n\t\t\t\t\tif (r2 < 0 || r2 >= 3 || c2 < 0 || c2 >= 3 || map[r][c])\n\t\t\t\t\t\t f[j][r][c]   += f[j-1][r][c];\n\t\t\t\t\telse f[j][r2][c2] += f[j-1][r][c];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (ans = 0, r = 0; r < 3; r++) for (c = 0; c < 3; c++) ans += f[n][r][c];\n\t\tprintf(\"%.8lf\\n\", (double)f[n][t/3][t%3] / (double)ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(void){\n  long double p[16][9];\n  int souko,goal,robo;\n  char s,t,b,tmp;\n  int n;\n  int i,j,k;\n  while(scanf(\"%d%*c\",&n) && n){\n    scanf(\"%c %c %c%*c\",&s,&t,&b);\n    robo=s-'A';\n    goal=t-'A';\n    souko=b-'A';\n    for(i=0;i<16;i++) for(j=0;j<9;j++) p[i][j]=0;\n    p[0][robo]=1.0;\n    for(i=1;i<=n;i++){\n      for(j=0;j<9;j++){\n\tp[i][j]=0;\n\tif(j==souko) continue;\n\tp[i][j]+=((j<3 || j-3==souko)?p[i-1][j]:p[i-1][j-3])*0.25;\n\tp[i][j]+=((j%3==0 || j-1==souko)?p[i-1][j]:p[i-1][j-1])*0.25;\n\tp[i][j]+=((j%3==2 || j+1==souko)?p[i-1][j]:p[i-1][j+1])*0.25;\n\tp[i][j]+=((j>5 || j+3==souko)?p[i-1][j]:p[i-1][j+3])*0.25;\n      }\n    }\n    printf(\"%.8Lf\\n\",p[n][goal]);\n  }\n  return 0;\n}\n\t   "
  },
  {
    "language": "C",
    "code": "/*\nAizuOnline A1020\nTitle Cleaning Robot\n*/\n#include <stdio.h>\n// Select Below\n//#include <stdlib.h>\n//#include <string.h>\n#include <float.h>\n//#include <math.h>\n//#include <limits.h>\n//Global data section\n// p[from_state][to_state]\n//state 0:A,1:B,2:C\n//      \nint n;\nchar s,t,b;      \ndouble p[16][9];\nint tr[9][9]={{2,1,0,1,0,0,0,0,0},\n              {1,1,1,0,1,0,0,0,0},\n              {0,1,2,0,0,1,0,0,0},\n              {1,0,0,1,1,0,1,0,0},\n              {0,1,0,1,0,1,0,1,0},\n              {0,0,1,0,1,1,0,0,1},\n              {0,0,0,1,0,0,2,1,0},\n              {0,0,0,0,1,0,1,1,1},\n              {0,0,0,0,0,1,0,1,2}};\n//\nvoid init()\n{\n        int i;\n\n        for(i=0;i<9;i++)\n                p[0][i]=0.0;\n        p[0][s-'A']=1.0;\n}\nvoid souko()\n{\n        int i,b0;\n\n        b0=b-'A';\n        for(i=0;i<9;i++)\n        {\n                tr[i][i] += tr[b0][i];\n                tr[b0][i] = 0;\n        }\n}\nvoid show(int n)\n{\n        printf(\"----------------\\n\");\n        printf(\"%lf %lf %lf\\n\",p[n][0],p[n][1],p[n][2]);\n        printf(\"%lf %lf %lf\\n\",p[n][3],p[n][4],p[n][5]);\n        printf(\"%lf %lf %lf\\n\",p[n][6],p[n][7],p[n][8]);\n}\n\nmain()\n{\n        int i,j,k;\n        double sum;\n        \n        while(scanf(\"%d \",&n) && n)\n        {\n                scanf(\"%c %c %c\",&s,&t,&b);\n                init();\n                souko();\n\n                //show(0);\n                for(i=0;i<n;i++)\n                {                        \n                        for(j=0;j<9;j++)\n                        {\n                                sum=0.0;\n                                for(k=0;k<9;k++)\n                                        sum += (double)tr[j][k]/4.0*p[i][k];\n                                p[i+1][j]=sum;\n                        }\n                        //show(i+1);\n                }\n\n                printf(\"%0.8lf\\n\",p[n][t-'A']);\n        }\nreturn(0);\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#define OUT(x) ((0>x)||(x>2))\ntypedef struct{\n  double new;\n  double prev;\n}point;\n\ntypedef struct{\n  int x;\n  int y;\n}ipoint;\n\npoint bo[3][3];\n\nint main(){\n  int i,j,k,x,y,n;\n  char buf[16];\n  ipoint dic[]={{0,0},{1,0},{2,0},\n\t\t{0,1},{1,1},{2,1},\n\t\t{0,2},{1,2},{2,2}},\n    dir[]={{-1,0},{1,0},{0,-1},{0,1}};\n  ipoint st,go,wa;\n  while(1){\n    fgets(buf,16,stdin);\n    n=atoi(buf);\n    if(!n) break;\n    fgets(buf,16,stdin);\n    st=dic[(int)buf[0]-(int)'A'];\n    go=dic[(int)buf[2]-(int)'A'];\n    wa=dic[(int)buf[4]-(int)'A'];\n    bo[st.y][st.x].prev=1.0;\n    for(i=0;i<n;i++){\n      for(j=0;j<9;j++){\n\tif(bo[dic[j].y][dic[j].x].prev==0.0) continue;\n\tfor(k=0;k<4;k++){\n\t  x=dic[j].x+dir[k].x;\n\t  y=dic[j].y+dir[k].y;\n\t  if(OUT(x)||OUT(y)||((x==wa.x)&&(y==wa.y))){\n\t    x=dic[j].x;\n\t    y=dic[j].y;\n\t  }\n\t  bo[y][x].new+=bo[dic[j].y][dic[j].x].prev/4.0;\n\t}\n      }\n      for(j=0;j<9;j++){\n\tx=dic[j].x;\n\ty=dic[j].y;\n\tbo[y][x].prev=bo[y][x].new;\n\tbo[y][x].new=0.0;\n      }\n    }\n    printf(\"%.8f\\n\",bo[go.y][go.x].prev);\n    for(j=0;j<9;j++){\n      x=dic[j].x;\n      y=dic[j].y;\n      bo[y][x].prev=bo[y][x].new=0;\n    }\n  }\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\nint main(void){\n\tint d[] = { -5, -1, 1, 5 };\n\tint np, bp, tp, pp, i, j, k, n, x, y;\n\tchar s, t, b;\n\t\n\tfor(; scanf(\"%d %c %c %c\", &n, &s, &t, &b), n; ){\n\t\tdouble pr[2][25] = {};\n\t\tnp = ( ( s - 'A' ) / 3 + 1 ) * 5 + ( s - 'A' ) % 3 + 1;\n\t\ttp = ( ( t - 'A' ) / 3 + 1 ) * 5 + ( t - 'A' ) % 3 + 1;\n\t\tbp = ( ( b - 'A' ) / 3 + 1 ) * 5 + ( b - 'A' ) % 3 + 1;\n\t\tpr[n & 1][np] = 1.0;\n\n\t\tfor( ; n--; ){\n\t\t\tfor( i = 1; i < 4; i++ ){\n\t\t\t\tfor( j = 1; j < 4; j++ ){\n\t\t\t\t\tpr[n & 1][i * 5 + j] = 0.0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor( i = 1; i < 4; i++ ){\n\t\t\t\tfor( j = 1; j < 4; j++ ){\n\t\t\t\t\tpp = i * 5 + j;\n\t\t\t\t\tfor( k = 0; k < 4; k++ ){\n\t\t\t\t\t\tnp = pp + d[k];\n\t\t\t\t\t\tx = np % 5;\n\t\t\t\t\t\ty = np / 5;\n\t\t\t\t\t\tif( x < 1 || x > 3 || y < 1 || y > 3 || np == bp ){\n\t\t\t\t\t\t\tpr[n & 1][pp] += pr[~n & 1][pp] * 0.25;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tpr[n & 1][np] += pr[~n & 1][pp] * 0.25;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%f\\n\", pr[0][tp] );\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "/*\nAizuOnline A1020\nCleaning Robot\n*/\n#include <stdio.h>\n#include <float.h>\nint  n;\nchar s,t,b;\n//                A B C D E F G H I\nint   k_t[9][9]={{2,1,0,1,0,0,0,0,0}, //A\n                 {1,1,1,0,1,0,0,0,0}, //B\n                 {0,1,2,0,0,1,0,0,0}, //C\n                 {1,0,0,1,1,0,1,0,0}, //D\n                 {0,1,0,1,0,1,0,1,0}, //E\n                 {0,0,1,0,1,1,0,0,1}, //F\n                 {0,0,0,1,0,0,2,1,0}, //G\n                 {0,0,0,0,1,0,1,1,1}, //H\n                 {0,0,0,0,0,1,0,1,2}  //I\n};\n\nint k_t_a[9][9];\ninit()\n{\n  n = 3;s = 'A';t = 'H';b = 'G';\n}\nunsigned long kakuritu(int bat,char from,char to)\n{ unsigned long ret,w;\n  char next;\n  int  prob;\n  \n\n  // printf(\"%c %c \\n\",from,to);\n  if(bat==0)\n    if(from==to)\n      return(1L<<31);\n    else\n      return(0L);\n\n  ret=0L;\n  for(next='A';next<='I';next++)\n    {  prob= k_t_a[from-'A'][next-'A'];\n      if(prob)\n\tw = (kakuritu(bat-1,next,to)) >> 1;\n      if(prob  & 2)  //0.5\n\t ret += w;\n       if(prob & 1)  //0.25\n\t ret += w >> 1;\n\t \n    }\n  return(ret);\n\n}\nmod_k_t(char b)\n{\n  int i,j;\n  for(i=0;i<9;i++)\n    for(j=0;j<9;j++)\n      k_t_a[i][j]=k_t[i][j];\n    \n  for(i=0;i<9;i++)\n    if(k_t_a[i][b-'A'] > 0)\n      {  k_t_a[i][b-'A']=0;\n\t k_t_a[i][i] += 1;\n      }\n  \n}\n\nmain()\n{\n  //init();\n  while(EOF!=scanf(\"%d\\n\",&n) && n!=0)\n  { scanf(\"%c %c %c\",&s,&t,&b);\n    //printf(\"%d %c %c %c\\n\",n,s,t,b);\n    mod_k_t(b);\n    printf(\"%f\\n\",(float) (kakuritu(n,s,t))/65536/32768);\n    }\n  return(0);\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\n#include<math.h>\n#define c(v) ((v)>=0&&(v)<3)\nint m[5]={0,1,0,-1,0},s,t,b,dp[9][16];\n\nint d(int p,int n)\n{\n\tint i,r=0,x,y;\n\tif(dp[p][n]!=-1)\n\t\treturn dp[p][n];\n\tif(n==0)\n\t{\n\t\tif(p==t)\n\t\t\treturn 1;\n\t\telse\n\t\t\treturn 0;\n\t}\n\telse if(n>0&&(abs(p/3-t/3)+abs(p%3-t%3))<=n)\n\t{\n\t\tfor(i=0;i<4;i++)\n\t\t{\n\t\t\tx=p%3+m[i];\n\t\t\ty=p/3+m[i+1];\n\t\t\tif(c(x)&&c(y)&&y*3+x!=b)\n\t\t\t\tr+=d(y*3+x,n-1);\n\t\t\telse\n\t\t\t\tr+=d(p,n-1);\n\t\t}\n\t}\n\treturn dp[p][n]= r;\n}\n\nint main()\n{\n\tint n,ans,tmp1;\n\tdouble tmp2;\n\tfor(;scanf(\"%d\",&n);ans=0)\n\t{\n\t\tif(n==0)\n\t\t\treturn 0;\n\t\tscanf(\"\\n%c %c %c\",&s,&t,&b);\n\t\tmemset(dp,-1,sizeof(dp));\n\t\ts-=65;t-=65;b-=65;\n\t\tans=d(s,n);\n\t\ttmp1=1<<(n*2);\n\t\ttmp2=(double)ans/tmp1;\n\t\tprintf(\"%lf\\n\",tmp2);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <time.h>\nint main(void){\n\tint a = 0, n;\n\tchar c;\n\t\n\twhile( scanf(\"%d%c %*c %*c %*c\", &n, &c ), n != 0 ){\n\t\tif( c == ' ' ){\n\t\t\tclock_t c1 = clock();\n\t\t\tclock_t c2 = (clock_t)(a * 0.02 * CLOCKS_PER_SEC + c1);\n\t\t\twhile( clock() < c2 );\n\t\t\treturn 0;\n\t\t}\n\t\t++a;\n\t}\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <math.h>\n\nint main(void)\n{\n    int table[9][2] = {{1, 1}, {2, 1}, {3, 1}, \n                       {1, 2}, {2, 2}, {3, 2}, \n                       {1, 3}, {2, 3}, {3, 3}};\n    int n;\n    char s[2], t[2], b[2];\n    int sx, sy, tx, ty, bx, by;\n    int x, y;\n    int room[5][5], room2[5][5];\n    double p[5][5], p2[5][5];\n    int step;\n    int i, j;\n    \n    while (1){\n        scanf(\"%d\", &n);\n        if (n == 0){\n            break;\n        }\n        \n        scanf(\"%s%s%s\", s, t, b);\n        \n        sx = table[s[0] - 'A'][0];\n        sy = table[s[0] - 'A'][1];\n        tx = table[t[0] - 'A'][0];\n        ty = table[t[0] - 'A'][1];\n        bx = table[b[0] - 'A'][0];\n        by = table[b[0] - 'A'][1];\n        \n        for (y = 0; y <= 4; y++){\n            for (x = 0; x <= 4; x++){\n                room[y][x] = room2[y][x] = 0;\n                if (x == 0 || x == 4){\n                    room[y][x] = -1;\n                }\n                if (y == 0 || y == 4){\n                    room[y][x] = -1;\n                }\n                p[y][x] = p2[y][x] = 0.0;\n            }\n        }\n        room[by][bx] = room2[by][bx] = -1;\n        room[sy][sx] = 1;\n        p[sy][sx] = 1.0;\n        for (step = 1; step <= n; step++){\n            for (y = 1; y <= 3; y++){\n                for (x = 1; x <= 3; x++){\n                    if (room[y][x] == step){\n//printf(\"<%d, %d step=%d>\\n\", x, y, step);\n                        if (room[y - 1][x] != -1){\n                            room2[y - 1][x] = step + 1;\n                            p2[y - 1][x] += p[y][x] / 4;\n                        }\n                        else {\n                            room2[y][x] = step + 1;\n                            p2[y][x] += p[y][x] / 4;\n                        }\n                        \n                        if (room[y + 1][x] != -1){\n                            room2[y + 1][x] = step + 1;\n                            p2[y + 1][x] += p[y][x] / 4;\n                        }\n                        else {\n                            room2[y][x] = step + 1;\n                            p2[y][x] += p[y][x] / 4;\n                        }\n                        \n                        if (room[y][x - 1] != -1){\n                            room2[y][x - 1] = step + 1;\n                            p2[y][x - 1] += p[y][x] / 4;\n                        }\n                        else {\n                            room2[y][x] = step + 1;\n                            p2[y][x] += p[y][x] / 4;\n                        }\n                        \n                        if (room[y][x + 1] != -1){\n                            room2[y][x + 1] = step + 1;\n                            p2[y][x + 1] += p[y][x] / 4;\n                        }\n                        else {\n                            room2[y][x] = step + 1;\n                            p2[y][x] += p[y][x] / 4;\n                        }\n                    }\n                }\n            }\n            for (y = 1; y <= 3; y++){\n                for (x = 1; x <= 3; x++){\n                    room[y][x] = room2[y][x];\n                    p[y][x] = p2[y][x];\n                    p2[y][x] = 0.0;\n                }\n            }\n\n#if 0\nfor (y = 1; y <= 3; y++){\n    for (x = 1; x <= 3; x++){\n        printf(\"%d(%.2lf) \", room[y][x], p[y][x]);\n    }\n    printf(\"\\n\");\n}\nprintf(\"\\n\");\n#endif\n\n        }\n        \n        printf(\"%lf\\n\", p[ty][tx]);\n    }\n    \n    return (0);\n}\n\n"
  },
  {
    "language": "C",
    "code": "// Aizu 1020: Cleaning Robot\n// 2017.9.17 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\ntypedef struct { int r, c, k; } Q;\nQ q[500]; int top, end;\nchar map[3][3], mk[3][3][17];\nlong long f[9];\nint mv[4][2] = {{-1,0},{0,1},{1,0},{0,-1}};\n\nint main()\n{\n\tint n, s, t, b, i, r, c, k, r2, c2;\n\tchar b1[5], b2[5], b3[5];\n\tlong long ans;\n\n\twhile (scanf(\"%d\", &n) && n) {\n\t\tmemset(f, 0, sizeof(f)), memset(map, 0, sizeof(map));\n\t\tmemset(mk, 0, sizeof(mk));\n\t\tscanf(\"%s%s%s\", b1, b2, b3), s = *b1-'A', t = *b2-'A', b = *b3-'A';\n\t\tmap[b/3][b%3] = 1;\n\t\tq[0].r = s/3, q[0].c = s%3, q[0].k = n, top = 0, end = 1;\n\t\twhile (top < end) {\n\t\t\tr = q[top].r, c = q[top].c, k = q[top++].k;\n\t\t\tif (k == 0) { f[r*3+c]++; continue; }\n\t\t\tfor (i = 0; i < 4; i++) {\n\t\t\t\tr2 = r + mv[i][0], c2 = c + mv[i][1];\n\t\t\t\tif (r2 < 0 || r2 >= 3 || c2 < 0 || c2 >= 3 || map[r][c]) r2 = r, c2 = c;\n\t\t\t\tif (mk[r2][c2][k]) { f[3*r+c] += (1ULL << 2*(k-1)); continue; }\n\t\t\t\tmk[r2][c2][k] = 1;\n\t\t\t\tq[end].r = r2, q[end].c = c2, q[end++].k = k-1;\n\t\t\t}\n\t\t}\n\t\tfor (ans = 0, i = 0; i < 9; i++) ans += f[i];\n\t\tprintf(\"%.8lf\\n\", (double)f[t] / (double)ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "// Aizu 1020: Cleaning Robot\n// 2017.9.17 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\ndouble f[17][3][3];\nint mv[4][2] = {{-1,0},{0,1},{1,0},{0,-1}};\n\nint main()\n{\n\tint n, s, t, b, i, j, r, c, r2, c2;\n\tchar t1[5], t2[5], t3[5];\n\n\twhile (scanf(\"%d\", &n) && n) {\n\t\tscanf(\"%s%s%s\", t1, t2, t3), s = *t1 - 'A', t = *t2 - 'A', b = *t3 - 'A';\n\t\tmemset(f, 0, sizeof(f)), f[0][s/3][s%3] = 1;\n\t\tfor (j = 1; j <= n; j++) {\n\t\t\tfor (r = 0; r < 3; r++) for (c = 0; c < 3; c++) {\n\t\t\t\tfor (i = 0; i < 4; i++) {\n\t\t\t\t\tr2 = r + mv[i][0], c2 = c + mv[i][1];\n\t\t\t\t\tif (r2 < 0 || r2 >= 3 || c2 < 0 || c2 >= 3 || 3*r2+c2 == b) r2 = r, c2 = c;\n\t\t\t\t\tf[j][r2][c2] += f[j-1][r][c] / 4;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\", f[n][t/3][t%3]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nint from, battery, to;\nint prob[16][16]; //残量iで, 地点jからbatteryへいける確率\n\nint getProb(int lim, int start)\n{\n    int k;\n    int ans;\n    \n    if (prob[lim][start] >= 0){\n        return (prob[lim][start]);\n    }\n    \n    if (start == battery && lim == 0){\n        return (1);\n    }\n    if (lim == 0){\n        return (0);\n    }\n    \n    ans = 0.0;\n    k = 4;\n    \n    if ((start + 1) % 3 && start + 1 != to){\n        ans += getProb(lim - 1, start + 1);\n        k--;\n    }\n    \n    if (start % 3 && start - 1 != to){\n        ans += getProb(lim - 1, start - 1);\n        k--;\n    }\n    \n    if (start + 3 < 9 && start + 3 != to){\n        ans += getProb(lim - 1, start + 3);\n        k--;\n    }\n    \n    if (start - 3 >= 0 && start - 3 != to){\n        ans += getProb(lim - 1, start - 3);\n        k--;\n    }\n    \n    ans += getProb(lim - 1, start) * k;\n    \n    return (prob[lim][start] = ans);\n}\n\nint main(void)\n{\n    int left;\n    int i, j;\n    char in[16];\n    \n    while (1){\n        scanf(\"%d\", &left);\n        if (left == 0){\n            break;\n        }\n        getchar();\n        scanf(\"%c %c %c\", &from, &battery, &to);\n        getchar();\n        from -= 'A';\n        battery -= 'A';\n        to -= 'A';\n        for (i = 0; i < 16; i++){\n            for (j = 0; j < 16; j++){\n                prob[i][j] = -1;\n            }\n        }\n        \n        printf(\"%.8lf\\n\", getProb(left, from) * 1.0 / (1 << (left * 2)));\n    }\n    \n    return (0);\n}"
  },
  {
    "language": "C",
    "code": "/*\nAizuOnline A1020\nCleaning Robot\n*/\n#include <stdio.h>\n#include <float.h>\nint  n;\nchar s,t,b;\n//                A    B    C    D    E    F    G    H    I\nfloat k_t[9][9]={{0.50,0.25,0.00,0.25,0.00,0.00,0.00,0.00,0.00}, //A\n                 {0.25,0.25,0.25,0.00,0.25,0.00,0.00,0.00,0.00}, //B\n                 {0.00,0.25,0.50,0.00,0.00,0.25,0.00,0.00,0.00}, //C\n                 {0.25,0.00,0.00,0.25,0.25,0.00,0.25,0.00,0.00}, //D\n                 {0.00,0.25,0.00,0.25,0.00,0.25,0.00,0.25,0.00}, //E\n                 {0.00,0.00,0.25,0.00,0.25,0.25,0.00,0.00,0.25}, //F\n                 {0.00,0.00,0.00,0.25,0.00,0.00,0.50,0.25,0.00}, //G\n                 {0.00,0.00,0.00,0.00,0.25,0.00,0.25,0.25,0.25}, //H\n                 {0.00,0.00,0.00,0.25,0.00,0.25,0.00,0.25,0.25} //I\n};\n\nfloat k_t_a[9][9];\ninit()\n{\n  n = 3;s = 'A';t = 'H';b = 'G';\n}\ndouble kakuritu(int bat,char from,char to)\n{ double ret;\n  char next;\n  // printf(\"%c %c \\n\",from,to);\n  if(bat==0)\n    if(from==to)\n      return(1.0);\n    else\n      return(0.0);\n\n  ret=0.0;\n  for(next='A';next<='I';next++)\n    ret += k_t_a[from-'A'][next-'A']*kakuritu(bat-1,next,to);\n  return(ret);\n\n}\nmod_k_t(char b)\n{\n  int i,j;\n  for(i=0;i<9;i++)\n    for(j=0;j<9;j++)\n      k_t_a[i][j]=k_t[i][j];\n    \n  for(i=0;i<9;i++)\n    if(k_t_a[i][b-'A'] > 0.0)\n      {  k_t_a[i][b-'A']=0.0;\n\t k_t_a[i][i] += 0.25;\n      }\n  \n}\n\nmain()\n{\n  //init();\n  while(EOF!=scanf(\"%d\\n\",&n) && n!=0)\n  { scanf(\"%c %c %c\",&s,&t,&b);\n    //printf(\"%d %c %c %c\\n\",n,s,t,b);\n    mod_k_t(b);\n    printf(\"%f\\n\",kakuritu(n,s,t));\n    }\n  return(0);\n}"
  },
  {
    "language": "C",
    "code": "/*\n  AOJ 1020\n  Title:cleaning robot\n  @kankichi573\n*/\n#include <stdio.h>\n#include <string.h>\n#include <float.h>\nint n;\nchar s,t,b;\n\ndouble matrix[9][9];\ndouble myvector[9];\nchar rinsetu[24][2];\nchar rinsetu_org[12][2]=\n  {\"AB\",\"BC\",\"DE\",\"EF\",\"GH\",\"HI\",\n   \"AD\",\"DG\",\"BE\",\"EH\",\"CF\",\"FI\"};\nvoid init_rinsetu()\n{\n  int i,j;\n  for(i=0;i<12;i++)\n    for(j=0;j<2;j++)\n      rinsetu[i][j]=rinsetu_org[i][j];\n}\nvoid make_reverse()\n{\n  int i;\n  for(i=0;i<12;i++)\n    {\n      rinsetu[i+12][0]=rinsetu[i][1];\n      rinsetu[i+12][1]=rinsetu[i][0];\n    }\n}\nvoid dump_rinsetu()\n{\n  int i;\n  for(i=0;i<24;i++)\n    printf(\"%c%c|\",rinsetu[i][0],rinsetu[i][1]);\n  printf(\"\\n\");\n}\nvoid delete_souko(char b)\n{\n  int i,j;\n  for(i=0;i<24;i++)\n    for(j=0;j<2;j++)\n      if(rinsetu[i][j]==b)\n\trinsetu[i][j]='X';\n}\n\nvoid make_matrix(char b)\n{\n  int i,j;\n  double s;\n\n  //printf(\"SOUKO=%c\\n\",b);\n  init_rinsetu();\n  make_reverse();\n  //dump_rinsetu();\n  delete_souko(b);\n  //dump_rinsetu();\n\n  for(i=0;i<9;i++)\n    for(j=0;j<9;j++)\n      matrix[i][j]=0.0;\n\n  for(i=0;i<24;i++)\n    if(rinsetu[i][0]!='X' && rinsetu[i][1]!='X')\n      matrix[rinsetu[i][0]-'A'][rinsetu[i][1]-'A']=0.25;\n\n  for(i=0;i<9;i++)\n    {\n      s=0;\n      for(j=0;j<9;j++)\n\t{\n\t  if(i!=j)\n\t    s += matrix[i][j];\n\t}\n      matrix[i][i]=1-s;\n    }\n}\nvoid matrix_vector_product()\n{\n  int i,j;\n  double work[9];\n  for(i=0;i<9;i++)\n    {\n      work[i]=0.0;\n      for(j=0;j<9;j++)\n\t{\n\t  work[i]+=myvector[j]*matrix[i][j];\n\t}\n    }\n  memcpy(myvector,work,9*sizeof(double));\n}\nint init_vector(char c)\n{\n  int i;\n  for(i=0;i<9;i++)\n    myvector[i]=0.0;\n  myvector[c-'A']=1.0;\n}\n void dump_matrix()\n {\n   int i,j;\n   for(i=0;i<9;i++)\n     {\n       for(j=0;j<9;j++)\n\t printf(\"%0.2lf \",matrix[i][j]);\n       printf(\"\\n\");\n     }\n }\nvoid dump_vector()\n{\n  int i;\n  for(i=0;i<9;i++)\n    printf(\"%0.3lf|\",myvector[i]);\n  printf(\"\\n\");\n}\nmain()\n{\n  int i;\n\n  while(scanf(\"%d \",&n) && n)\n    {\n      scanf(\"%c %c %c\",&s,&t,&b);\n      make_matrix(b);\n      init_vector(s);\n      //dump_matrix();\n      //printf(\"--------------------\\n\");\n      //dump_vector();\n      for(i=0;i<n;i++)\n\t{\n\t  matrix_vector_product();\n\t  //dump_vector();\n\t}\n      printf(\"%.7lf\\n\",myvector[t-'A']);\n    }\n\n\n  return(0);\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\nint main(){\n  int n,i,j,k,l,ny,nx;\n  char s,e,f;\n  double p=1;\n  int X[]={0,1,0,-1};\n  int Y[]={1,0,-1,0};\n  while(scanf(\"%d\",&n),n){\n    int c[3][3]={0};\n    scanf(\" %c %c %c\",&s,&e,&f);\n    c[(s-'A')/3][(s-'A')%3]=p=1;\n    while(n--){\n      p*=4;\n      int d[3][3]={0};\n      for(i=0;i<3;i++){\n\tfor(j=0;j<3;j++){\n\t  for(k=0;k<4;k++){\n\t    ny=i+Y[k];\n\t    nx=j+X[k];\n\t    if((f-'A')/3==ny&&(f-'A')%3==nx||nx<0||nx==3||ny<0||ny==3){\n\t     nx-=X[k];\n\t     ny-=Y[k];\n\t    }\n\t    d[ny][nx]+=c[i][j];\n\t  }\n\t}\n     }\n     for(i=0;i<9;i++)c[i/3][i%3]=d[i/3][i%3];\n     //for(i=0;i<9;i++)printf(\"%d \",d[i/3][i%3]);printf(\"\\n\");\n    }\n    printf(\"%f\\n\",c[(e-'A')/3][(e-'A')%3]/p);\n  }\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\nint main(void){\n\tint d[] = { -5, -1, 1, 5 };\n\tint np, bp, tp, i, j, k, n;\n\tchar s, t, b;\n\t\n\tfor(; scanf(\"%d %c %c %c\", &n, &s, &t, &b), n; ){\n\t\tdouble pr[2][25] = {};\n\t\tnp = ( ( s - 'A' ) / 3 + 1 ) * 5 + ( s - 'A' ) % 3 + 1;\n\t\ttp = ( ( t - 'A' ) / 3 + 1 ) * 5 + ( t - 'A' ) % 3 + 1;\n\t\tbp = ( ( b - 'A' ) / 3 + 1 ) * 5 + ( b - 'A' ) % 3 + 1;\n\t\tpr[n & 1][np] = 1.0;\n\n\t\tfor( ; n--; ){\n\t\t\tfor( i = 1; i < 4; i++ ){\n\t\t\t\tfor( j = 1; j < 4; j++ ){\n\t\t\t\t\tnp = i * 5 + j;\n\t\t\t\t\tpr[n & 1][np] = 0.0;\n\t\t\t\t\tfor( k = 0; k < 4; k++ ){\n\t\t\t\t\t\tpr[n & 1][np] += pr[~n & 1][np + d[k]] / 4.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tpr[n & 1][bp] = 0.0;\n\t\t}\n\t\tprintf(\"%f\\n\", pr[0][tp] );\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include \"stdio.h\"\n#include \"math.h\"\n\nint main()\n{\n int n;\n char s, t, b;\n\n scanf(\"%d\", &n);\n while(n>0){\n  scanf(\" %c %c %c\", &s, &t, &b);\n  s-='A'; t-='A'; b-='A';\n\n  int footprint1[9]={0,0,0,0,0,0,0,0,0};\n  int footprint2[9];\n  footprint1[s] = 1;\n  for(int i=0; i<n; i++){\n   for(int j=0; j<9; j++) footprint2[j]=0;\n   for(int j=0; j<9; j++){\n    if(footprint1[j]>0){\n     if(j>2 && j-3!=b) footprint2[j-3]+=footprint1[j];\n     else footprint2[j]+=footprint1[j];\n     if(j%3>0 && j-1!=b) footprint2[j-1]+=footprint1[j];\n     else footprint2[j]+=footprint1[j];\n     if((j+1)%3>0 && j+1!=b) footprint2[j+1]+=footprint1[j];\n     else footprint2[j]+=footprint1[j];\n     if(j<6 && j+3!=b) footprint2[j+3]+=footprint1[j];\n     else footprint2[j]+=footprint1[j];\n    }\n   }\n   for(int j=0; j<9; j++) footprint1[j]=footprint2[j];\n  }\n\n  printf(\"%f\\n\", footprint1[t] / pow(4.0, n));\n\n  scanf(\"%d\", &n);\n }\n\n return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(void){\n  long double p[16][9];\n  int souko,goal,robo;\n  char s,t,b,tmp;\n  int n;\n  int i,j,k;\n  while(scanf(\"%d%*c\",&n) && n){\n    scanf(\"%c %c %c%*c\",&s,&t,&b);\n    robo=s-'A';\n    goal=t-'A';\n    souko=b-'A';\n    for(i=0;i<16;i++) for(j=0;j<9;j++) p[i][j]=0;\n    p[0][robo]=1.0;\n    for(i=1;i<=n;i++){\n      for(j=0;j<9;j++){\n\tp[i][j]=0;\n\tif(j==souko) continue;\n\tp[i][j]+=((j<3 || j-3==souko)?p[i-1][j]:p[i-1][j-3])/4.0;\n\tp[i][j]+=((j%3==0 || j-1==souko)?p[i-1][j]:p[i-1][j-1])/4.0;\n\tp[i][j]+=((j%3==2 || j+1==souko)?p[i-1][j]:p[i-1][j+1])/4.0;\n\tp[i][j]+=((j>5 || j+3==souko)?p[i-1][j]:p[i-1][j+3])/4.0;\n      }\n    }\n    printf(\"%.8Lf\\n\",p[n][goal]);\n  }\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nint from, battery, to;\ndouble prob[16][16]; //残量iで, 地点jからbatteryへいける確率\n\ndouble getProb(int lim, int start)\n{\n    int i;\n    double ans;\n    \n    if (prob[lim][start] >= -1){\n        return (prob[lim][start]);\n    }\n    \n    if (start == battery && lim == 0){\n        return (1.0);\n    }\n    if (lim == 0){\n        return (0);\n    }\n    \n    ans = 0.0;\n    \n    if ((start + 1) % 3 && start + 1 != to){\n        ans += 0.25 * getProb(lim - 1, start + 1);\n    }\n    else {\n        ans += 0.25 * getProb(lim - 1, start);\n    }\n    \n    if (start % 3 && start - 1 != to){\n        ans += 0.25 * getProb(lim - 1, start - 1);\n    }\n    else {\n        ans += 0.25 * getProb(lim - 1, start);\n    }\n    \n    if (start + 3 < 9 && start + 3 != to){\n        ans += 0.25 * getProb(lim - 1, start + 3);\n    }\n    else {\n        ans += 0.25 * getProb(lim - 1, start);\n    }\n    \n    if (start - 3 >= 0 && start - 3 != to){\n        ans += 0.25 * getProb(lim - 1, start - 3);\n    }\n    else {\n        ans += 0.25 * getProb(lim - 1, start);\n    }\n    \n    return (prob[lim][start] = ans);\n}\n\nint main(void)\n{\n    int left;\n    int i, j;\n    char in[16];\n    \n    while (scanf(\"%d%*c\", &left) && left){\n        scanf(\"%[^\\n]s\", in);\n        \n        from = in[0] - 'A';\n        battery = in[2] - 'A';\n        to = in[4] - 'A';\n        \n        for (i = 0; i < 16; i++){\n            for (j = 0; j < 16; j++){\n                prob[i][j] = -99;\n            }\n        }\n        \n        printf(\"%.8lf\\n\", getProb(left, from));\n    }\n    \n    return (0);\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <time.h>\nint main(void){\n\tint a = 1, n, f = 0;\n\tchar c;\n\t\n\tfor(n=0;n<10;++n)scanf(\"%*d %*c %*c %*c\");\n\t\n\twhile( scanf(\"%d%c %*c %*c %*c\", &n, &c ), n != 0 ){\n\t\tif( c == ' ' ){\n\t\t\tclock_t c1 = a * CLOCKS_PER_SEC / 50 + clock();\n\t\t\twhile( clock() < c1 );\n\t\t\tif( f++ ) return 0;\n\t\t\tc1 = CLOCKS_PER_SEC / 2 + clock();\n\t\t\twhile(clock() < c1);\n\t\t}\n\t\t++a;\n\t}\nreturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nint from, battery, to;\nint prob[16][16]; //残量iで, 地点jからbatteryへいける確率\n\nint getProb(int lim, int start)\n{\n    int k;\n    int ans;\n    \n    if (prob[lim][start] >= 0){\n        return (prob[lim][start]);\n    }\n    \n    if (start == battery && lim == 0){\n        return (1);\n    }\n    if (lim == 0){\n        return (0);\n    }\n    \n    ans = 0.0;\n    k = 4;\n    \n    if ((start + 1) % 3 && start + 1 != to){\n        ans += getProb(lim - 1, start + 1);\n        k--;\n    }\n    \n    if (start % 3 && start - 1 != to){\n        ans += getProb(lim - 1, start - 1);\n        k--;\n    }\n    \n    if (start + 3 < 9 && start + 3 != to){\n        ans += getProb(lim - 1, start + 3);\n        k--;\n    }\n    \n    if (start - 3 >= 0 && start - 3 != to){\n        ans += getProb(lim - 1, start - 3);\n        k--;\n    }\n    \n    ans += getProb(lim - 1, start) * k;\n    \n    return (prob[lim][start] = ans);\n}\n\nint main(void)\n{\n    int left;\n    int i, j;\n    char in[16];\n    \n    while (1){\n        scanf(\" %d\", &left);\n        if (left == 0){\n            break;\n        }\n        scanf(\" %c %c %c\", in, in + 2, in + 4);\n        from = in[0] - 'A';\n        battery = in[2] - 'A';\n        to = in[4] - 'A';\n        \n        for (i = 0; i < 16; i++){\n            for (j = 0; j < 16; j++){\n                prob[i][j] = -1;\n            }\n        }\n        \n        printf(\"%.8lf\\n\", getProb(left, from) * 1.0 / (1 << (left * 2)));\n    }\n    \n    return (0);\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\n#include<math.h>\n\nint m[4]={3,-3,1,-1},s,t,b,dp[9][16];\n\nint d(int p,int n)\n{\n\tint i,r=0;\n\tif(dp[p][n]!=-1)\n\t\treturn dp[p][n];\n\tif(n==0&&p==t)\n\t\treturn 1;\n\telse if(n>0&&(abs(p/3-t/3)+abs(p%3-t%3))<=n)\n\t{\n\t\tfor(i=0;i<4;i++)\n\t\t{\n\t\t\tif(p+m[i]>=0 && p+m[i]<9 && p+m[i]!=b)\n\t\t\t\tr+=d(p+m[i],n-1);\n\t\t\telse\n\t\t\t\tr+=d(p,n-1);\n\t\t}\n\t}\n\treturn dp[p][n]= r;\n}\n\nint main()\n{\n\tint n,ans,tmp1;\n\tdouble tmp2;\n\tfor(;scanf(\"%d\",&n);ans=0)\n\t{\n\t\tif(n==0)\n\t\t\treturn 0;\n\t\tscanf(\"\\n%c %c %c\",&s,&t,&b);\n\t\tmemset(dp,-1,sizeof(dp));\n\t\ts-=65;t-=65;b-=65;\n\t\tans=d(s,n);\n\t\ttmp1=1<<(n*2);\n\t\ttmp2=(double)ans/tmp1;\n\t\tprintf(\"%lf\\n\",tmp2);\n\t}\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<math.h>\n\nint m[4]={3,-3,1,-1},ans=0,s,t,b;\n\nvoid d(int pos,int buttery)\n{\n                 int i;\n                 if(buttery==0&&pos==t)\n                                ans++;\n                 else if (buttery>0&&(abs(pos/3-t/3)+abs(pos%3-t%3))<=buttery)\n                {\n                                 for(i=0;i<4;i++)\n                                {\n                                                 if(pos+m[i]>=0 && pos+m[i]<9 && pos+m[i]!=b)\n                                                                d(pos+m[i],buttery-1);\n                                                 else\n                                                                d(pos,buttery-1);\n                                }\n                }\n}\n\nint main()\n{\n                 int buttery;\n                 char cs,ct,cb;\n                 for(;scanf(\"%d\" ,&buttery);ans=0)\n                {\n                                 if(buttery==0)\n                                                 return 0;\n                                scanf( \"\\n%c %c %c\",&cs,&ct,&cb);\n                                s=cs-65;t=ct-65;b=cb-65;\n                                d(s,buttery);\n                                 int tmp1=1<<(buttery*2);\n                                 double tmp2=(double )ans/tmp1;\n                                 printf(\"%.8lf\\n\",tmp2);\n                }\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nint from, battery, to;\nint prob[16][16]; //残量iで, 地点jからbatteryへいける確率\n\nint getProb(int lim, int start)\n{\n    int k;\n    int ans;\n    \n    if (prob[lim][start] >= 0){\n        return (prob[lim][start]);\n    }\n    \n    if (start == battery && lim == 0){\n        return (1);\n    }\n    if (lim == 0){\n        return (0);\n    }\n    \n    ans = 0.0;\n    k = 4;\n    \n    if ((start + 1) % 3 && start + 1 != to){\n        ans += getProb(lim - 1, start + 1);\n        k--;\n    }\n    \n    if (start % 3 && start - 1 != to){\n        ans += getProb(lim - 1, start - 1);\n        k--;\n    }\n    \n    if (start + 3 < 9 && start + 3 != to){\n        ans += getProb(lim - 1, start + 3);\n        k--;\n    }\n    \n    if (start - 3 >= 0 && start - 3 != to){\n        ans += getProb(lim - 1, start - 3);\n        k--;\n    }\n    \n    ans += getProb(lim - 1, start) * k;\n    \n    return (prob[lim][start] = ans);\n}\n\nint main(void)\n{\n    int left;\n    int i, j;\n    char in[16];\n    \n    while (1){\n        scanf(\"%d\", &left);\n        if (left == 0){\n            break;\n        }\n        getchar();\n        fgets(in, 16, stdin);\n        from = in[0] - 'A';\n        battery = in[2] - 'A';\n        to = in[4] - 'A';\n        for (i = 0; i < 16; i++){\n            for (j = 0; j < 16; j++){\n                prob[i][j] = -1;\n            }\n        }\n        \n        printf(\"%.8lf\\n\", getProb(left, from) * 1.0 / (1 << (left * 2)));\n    }\n    \n    return (0);\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nint patterns = 0;\nint goals = 0;\n/* typedef enum { */\n/* \tA = 0, */\n/* \tB, */\n/* \tC, */\n/* \tD, */\n/* \tE, */\n/* \tF, */\n/* \tG, */\n/* \tH, */\n/* \tI, */\n/* } ROOMS; */\nvoid cleaning(char lroom, char groom, char broom, int cnt);\nvoid subcleaning(char lroom, char groom, char broom, int cnt, char next);\n\nvoid subcleaning(char lroom, char groom, char broom, int cnt, char next) {\n//\tprintf(\"%c \", next);\n\t\n\tif (next == broom || next == 'N') {\n\t\tcleaning(lroom, groom, broom, --cnt);\n\t} else {\n\t\tcleaning(next, groom, broom, --cnt);\n\t}\n}\n\nvoid cleaning(char lroom, char groom, char broom, int cnt) {\n//\t++patterns;\n\tif (0 == cnt) {\n\t\t++patterns;\n\t\tif (lroom == groom) {\n\t\t\t++goals;\n\t\t}\n\t\treturn;\n\t}\n\t\n\tswitch(lroom) {\n\tcase 'A':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'B');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'D');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tbreak;\n\tcase 'B':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'A');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'E');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'C');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tbreak;\n\tcase 'C':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'B');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'F');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tbreak;\n\tcase 'D':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'A');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'E');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'G');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tbreak;\n\tcase 'E':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'B');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'D');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'F');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'H');\n\t\tbreak;\n\tcase 'F':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'C');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'E');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'I');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tbreak;\n\tcase 'G':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'D');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'H');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tbreak;\n\tcase 'H':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'G');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'E');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'I');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tbreak;\n\tcase 'I':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'F');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'I');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tbreak;\n\t}\n\treturn;\n}\n\nint main(void) {\n\tint n;\n\tchar s, t, b; \n\twhile(1) {\n\t\tscanf(\"%d\", &n);\n\t\tif (n == 0) {\n\t\t\tbreak;\n\t\t}\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n//\t\tprintf(\"%c %c %c\\n\", s, t, b);\n\t\tpatterns = 0;\n\t\tgoals = 0;\n\t\tcleaning(s, t, b, n);\n\t\tprintf(\"goals = %d\\n\", goals);\n\t\tprintf(\"patterns = %d\\n\", patterns);\n\t\tprintf(\"%lf\\n\", (double)goals/patterns);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "/*\n  AOJ 1020\n  Title:cleaning robot\n  @kankichi573\n*/\n#include <stdio.h>\n#include <string.h>\n#include <float.h>\nint n;\nchar s,t,b;\n\ndouble matrix[9][9];\ndouble myvector[9];\nchar rinsetu[24][2];\nchar rinsetu_org[12][2]=\n  {\"AB\",\"BC\",\"DE\",\"EF\",\"GH\",\"HI\",\n   \"AD\",\"DG\",\"BE\",\"EH\",\"CF\",\"FI\"};\nvoid init_rinsetu()\n{\n  int i,j;\n  for(i=0;i<12;i++)\n    for(j=0;j<2;j++)\n      rinsetu[i][j]=rinsetu_org[i][j];\n}\nvoid make_reverse()\n{\n  int i;\n  for(i=0;i<12;i++)\n    {\n      rinsetu[i+12][0]=rinsetu[i][1];\n      rinsetu[i+12][1]=rinsetu[i][0];\n    }\n}\nvoid dump_rinsetu()\n{\n  int i;\n  for(i=0;i<24;i++)\n    printf(\"%c%c|\",rinsetu[i][0],rinsetu[i][1]);\n  printf(\"\\n\");\n}\nvoid delete_souko(char b)\n{\n  int i,j;\n  for(i=0;i<24;i++)\n    for(j=0;j<2;j++)\n      if(rinsetu[i][j]==b)\n\trinsetu[i][j]='X';\n}\n\nvoid make_matrix(char b)\n{\n  int i,j;\n  double s;\n\n  //printf(\"SOUKO=%c\\n\",b);\n  init_rinsetu();\n  make_reverse();\n  //dump_rinsetu();\n  delete_souko(b);\n  //dump_rinsetu();\n\n  for(i=0;i<24;i++)\n    if(rinsetu[i][0]!='X' && rinsetu[i][1]!='X')\n      matrix[rinsetu[i][0]-'A'][rinsetu[i][1]-'A']=0.25;\n  for(i=0;i<9;i++)\n    {\n      s=0;\n      for(j=0;j<9;j++)\n\t{\n\t  if(i!=j)\n\t    s += matrix[i][j];\n\t}\n      matrix[i][i]=1-s;\n    }\n}\nvoid matrix_vector_product()\n{\n  int i,j;\n  double work[9];\n  for(i=0;i<9;i++)\n    {\n      work[i]=0.0;\n      for(j=0;j<9;j++)\n\t{\n\t  work[i]+=myvector[j]*matrix[i][j];\n\t}\n    }\n  memcpy(myvector,work,9*sizeof(double));\n}\nint init_vector(char c)\n{\n  int i;\n  for(i=0;i<9;i++)\n    myvector[i]=0.0;\n  myvector[c-'A']=1.0;\n}\n void dump_matrix()\n {\n   int i,j;\n   for(i=0;i<9;i++)\n     {\n       for(j=0;j<9;j++)\n\t printf(\"%0.2lf \",matrix[i][j]);\n       printf(\"\\n\");\n     }\n }\nvoid dump_vector()\n{\n  int i;\n  for(i=0;i<9;i++)\n    printf(\"%0.3lf|\",myvector[i]);\n  printf(\"\\n\");\n}\nmain()\n{\n  int i;\n\n  while(scanf(\"%d \",&n) && n)\n    {\n      scanf(\"%c %c %c\",&s,&t,&b);\n\n      //printf(\"STB=%c %c %c\\n\",s,t,b);\n\n\n      make_matrix(b);\n      init_vector(s);\n      //dump_matrix();\n      //printf(\"--------------------\\n\");\n      //dump_vector();\n      for(i=0;i<n;i++)\n\t{\n\t  matrix_vector_product();\n\t  //dump_vector();\n\t}\n    }\n  printf(\"%lf\\n\",myvector[t-'A']);\n\n  return(0);\n}"
  },
  {
    "language": "C",
    "code": "// Aizu 1020: Cleaning Robot\n// 2017.9.17 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\ndouble f[17][3][3];\nint mv[4][2] = {{-1,0},{0,1},{1,0},{0,-1}};\n\nint main()\n{\n\tint n, s, t, b, i, j, r, c, r2, c2;\n\tchar t1[5], t2[5], t3[5];\n\n\twhile (scanf(\"%d\", &n) && n) {\n\t\tscanf(\"%s%s%s\", t1, t2, t3), s = *t1-'A', t = *t2-'A', b = *t3-'A';\n\t\tmemset(f, 0, sizeof(f)), f[0][s/3][s%3] = 1.0;\n\t\tfor (j = 1; j <= n; j++) {\n\t\t\tfor (r = 0; r < 3; r++) for (c = 0; c < 3; c++) {\n\t\t\t\tfor (i = 0; i < 4; i++) {\n\t\t\t\t\tr2 = r + mv[i][0], c2 = c + mv[i][1];\n\t\t\t\t\tif (r2 < 0 || r2 >= 3 || c2 < 0 || c2 >= 3 || 3*r+c == b) r2 = r, c2 = c;\n\t\t\t\t\tf[j][r2][c2] += f[j-1][r][c]/4.0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\", f[n][t/3][t%3]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#define OUT(x) ((0>x)||(x>2))\ntypedef struct{\n  double new;\n  double prev;\n}point;\n\ntypedef struct{\n  int x;\n  int y;\n}ipoint;\n\npoint bo[3][3];\n\nint main(){\n  int i,j,k,x,y,n;\n  char buf[16];\n  ipoint dic[]={{0,0},{1,0},{2,0},\n\t\t{0,1},{1,1},{2,1},\n\t\t{0,2},{1,2},{2,2}},\n    dir[]={{-1,0},{1,0},{0,-1},{0,1}};\n  ipoint st,go,wa;\n  while(1){\n    fgets(buf,16,stdin);\n    n=atoi(buf);\n    if(!n) break;\n    fgets(buf,16,stdin);\n    st=dic[(int)buf[0]-(int)'A'];\n    go=dic[(int)buf[2]-(int)'A'];\n    wa=dic[(int)buf[4]-(int)'A'];\n    bo[st.y][st.x].prev=1.0;\n    for(i=0;i<n;i++){\n      for(j=0;j<9;j++){\n\tif(bo[dic[j].y][dic[j].x].prev==0.0) continue;\n\tfor(k=0;k<4;k++){\n\t  x=dic[j].x+dir[k].x;\n\t  y=dic[j].y+dir[k].y;\n\t  if(OUT(x)||OUT(y)||((x==wa.x)&&(y==wa.y))){\n\t    x=dic[j].x;\n\t    y=dic[j].y;\n\t  }\n\t  bo[y][x].new+=bo[dic[j].y][dic[j].x].prev/4.0;\n\t}\n      }\n      for(j=0;j<3;j++){\n\tfor(k=0;k<3;k++){\n\t  printf(\"%.8f \",bo[j][k].new);\n\t}\n\tprintf(\"\\n\");\n      }\n      printf(\"\\n\");\n      for(j=0;j<9;j++){\n\tx=dic[j].x;\n\ty=dic[j].y;\n\tbo[y][x].prev=bo[y][x].new;\n\tbo[y][x].new=0.0;\n      }\n    }\n    printf(\"%.8f\\n\",bo[go.y][go.x].prev);\n    for(j=0;j<9;j++){\n      x=dic[j].x;\n      y=dic[j].y;\n      bo[y][x].prev=bo[y][x].new=0;\n    }\n  }\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(void){\n  double p[16][9];\n  int souko,goal,robo;\n  char s,t,b,tmp;\n  int n;\n  int i,j,k;\n  while(scanf(\"%d%*c\",&n) && n){\n    scanf(\"%c %c %c%*c\",&s,&t,&b);\n    robo=s-'A';\n    goal=t-'A';\n    souko=b-'A';\n    for(i=0;i<16;i++) for(j=0;j<9;j++) p[i][j]=0;\n    p[0][robo]=1.0;\n    for(i=1;i<=n;i++){\n      for(j=0;j<9;j++){\n\tp[i][j]=0;\n\tp[i][j]+=((j<3 || j-3==souko)?p[i-1][j]:p[i-1][j-3])*0.25;\n\tp[i][j]+=((j%3==0 || j-1==souko)?p[i-1][j]:p[i-1][j-1])*0.25;\n\tp[i][j]+=((j%3==2 || j+1==souko)?p[i-1][j]:p[i-1][j+1])*0.25;\n\tp[i][j]+=((j>5 || j+3==souko)?p[i-1][j]:p[i-1][j+3])*0.25;\n      }\n    }\n    printf(\"%.8f\\n\",p[n][goal]);\n  }\n  return 0;\n}\n\t   "
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nint from, battery, to;\nint prob[16][16]; //残量iで, 地点jからbatteryへいける確率\n\nint getProb(int lim, int start)\n{\n    int k;\n    int ans;\n    \n    if (prob[lim][start] >= 0){\n        return (prob[lim][start]);\n    }\n    \n    if (start == battery && lim == 0){\n        return (1);\n    }\n    if (lim == 0){\n        return (0);\n    }\n    \n    ans = 0.0;\n    k = 4;\n    \n    if ((start + 1) % 3 && start + 1 != to){\n        ans += getProb(lim - 1, start + 1);\n        k--;\n    }\n    \n    if (start % 3 && start - 1 != to){\n        ans += getProb(lim - 1, start - 1);\n        k--;\n    }\n    \n    if (start + 3 < 9 && start + 3 != to){\n        ans += getProb(lim - 1, start + 3);\n        k--;\n    }\n    \n    if (start - 3 >= 0 && start - 3 != to){\n        ans += getProb(lim - 1, start - 3);\n        k--;\n    }\n    \n    ans += getProb(lim - 1, start) * k;\n    \n    return (prob[lim][start] = ans);\n}\n\nint main(void)\n{\n    int left;\n    int i, j;\n    char in[16];\n    \n    while (1){\n        scanf(\"%d\", &left);\n        if (left == 0){\n            break;\n        }\n        getchar();\n        scanf(\"%c %c %c\", &from, &battery, &to);\n        from -= 'A';\n        battery -= 'A';\n        to -= 'A';\n        for (i = 0; i < 16; i++){\n            for (j = 0; j < 16; j++){\n                prob[i][j] = -1;\n            }\n        }\n        \n        printf(\"%.8lf\\n\", getProb(left, from) * 1.0 / (1 << (left * 2)));\n    }\n    \n    return (0);\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n\nint main(void){\n  long double p[16][9];\n  int souko,goal,robo;\n  char s,t,b;\n  int n;\n  int i,j;\n  while(scanf(\"%d%*c\",&n) && n){\n    scanf(\"%c %c %c%*c\",&s,&t,&b);\n    robo=s-'A';\n    goal=t-'A';\n    souko=b-'A';\n    for(i=0;i<16;i++) for(j=0;j<9;j++) p[i][j]=0;\n    p[0][robo]=1.0;\n    for(i=1;i<=n;i++){\n      for(j=0;j<9;j++){\n\tp[i][j]=0;\n\tif(j==souko) continue;\n\tp[i][j]+=((j<3 || j-3==souko)?p[i-1][j]:p[i-1][j-3])/4.0;\n\tp[i][j]+=((j%3==0 || j-1==souko)?p[i-1][j]:p[i-1][j-1])/4.0;\n\tp[i][j]+=((j%3==2 || j+1==souko)?p[i-1][j]:p[i-1][j+1])/4.0;\n\tp[i][j]+=((j>5 || j+3==souko)?p[i-1][j]:p[i-1][j+3])/4.0;\n      }\n    }\n    printf(\"%.8Lf\\n\",p[n][goal]);\n  }\n  return 0;\n}\n\t   "
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nint from, battery, to;\ndouble prob[16][16]; //残量iで, 地点jからbatteryへいける確率\n\ndouble getProb(int lim, int start)\n{\n    int k;\n    double ans;\n    \n    if (prob[lim][start] >= 0){\n        return (prob[lim][start]);\n    }\n    \n    if (start == battery && lim == 0){\n        return (1);\n    }\n    if (lim == 0){\n        return (0);\n    }\n    \n    ans = 0.0;\n    k = 4;\n    \n    if ((start + 1) % 3 && start + 1 != to){\n        ans += 0.25 * getProb(lim - 1, start + 1);\n        k--;\n    }\n    \n    if (start % 3 && start - 1 != to){\n        ans += 0.25 * getProb(lim - 1, start - 1);\n        k--;\n    }\n    \n    if (start + 3 < 9 && start + 3 != to){\n        ans += 0.25 * getProb(lim - 1, start + 3);\n        k--;\n    }\n    \n    if (start - 3 >= 0 && start - 3 != to){\n        ans += 0.25 * getProb(lim - 1, start - 3);\n        k--;\n    }\n    \n    ans += 0.25 * k * getProb(lim - 1, start);\n    \n    return (prob[lim][start] = ans);\n}\n\nint main(void)\n{\n    int left;\n    int i, j;\n    char in[16];\n    \n    while (1){\n        scanf(\" %d\", &left);\n        if (left == 0){\n            break;\n        }\n        scanf(\" %c %c %c\", in, in + 2, in + 4);\n        from = in[0] - 'A';\n        battery = in[2] - 'A';\n        to = in[4] - 'A';\n        \n        for (i = 0; i < 16; i++){\n            for (j = 0; j < 16; j++){\n                prob[i][j] = -1;\n            }\n        }\n        \n        printf(\"%.8lf\\n\", getProb(left, from));\n    }\n    \n    return (0);\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nint from, battery, to;\ndouble prob[16][16]; //残量iで, 地点jからbatteryへいける確率\n\ndouble getProb(int lim, int start)\n{\n    int k;\n    double ans;\n    \n    if (prob[lim][start] >= 0){\n        return (prob[lim][start]);\n    }\n    \n    if (start == battery && lim == 0){\n        return (1);\n    }\n    if (lim == 0){\n        return (0);\n    }\n    \n    ans = 0.0;\n    k = 4;\n    \n    if ((start + 1) % 3 && start + 1 != to){\n        ans += 0.25 * getProb(lim - 1, start + 1);\n        k--;\n    }\n    \n    if (start % 3 && start - 1 != to){\n        ans += 0.25 * getProb(lim - 1, start - 1);\n        k--;\n    }\n    \n    if (start + 3 < 9 && start + 3 != to){\n        ans += 0.25 * getProb(lim - 1, start + 3);\n        k--;\n    }\n    \n    if (start - 3 >= 0 && start - 3 != to){\n        ans += 0.25 * getProb(lim - 1, start - 3);\n        k--;\n    }\n    \n    ans += 0.25 * k * getProb(lim - 1, start);\n    \n    return (prob[lim][start] = ans);\n}\n\nint main(void)\n{\n    int left;\n    int i, j;\n    \n    while (scanf(\"%d\", &left) && left){\n        getchar();\n        if (left == 0){\n            break;\n        }\n        scanf(\"%c %c %c\", &from, &battery, &to);\n        getchar();\n        from -= 'A';\n        battery -= 'A';\n        to -= 'A';\n        \n        for (i = 0; i < 16; i++){\n            for (j = 0; j < 16; j++){\n                prob[i][j] = -1;\n            }\n        }\n        \n        printf(\"%.8lf\\n\", getProb(left, from));\n    }\n    \n    return (0);\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nint from, battery, to;\nint prob[16][16]; //残量iで, 地点jからbatteryへいける確率\n\nint getProb(int lim, int start)\n{\n    int k;\n    int ans;\n    \n    if (prob[lim][start] >= 0){\n        return (prob[lim][start]);\n    }\n    \n    if (start == battery && lim == 0){\n        return (1);\n    }\n    if (lim == 0){\n        return (0);\n    }\n    \n    ans = 0.0;\n    k = 4;\n    \n    if ((start + 1) % 3 && start + 1 != to){\n        ans += getProb(lim - 1, start + 1);\n        k--;\n    }\n    \n    if (start % 3 && start - 1 != to){\n        ans += getProb(lim - 1, start - 1);\n        k--;\n    }\n    \n    if (start + 3 < 9 && start + 3 != to){\n        ans += getProb(lim - 1, start + 3);\n        k--;\n    }\n    \n    if (start - 3 >= 0 && start - 3 != to){\n        ans += getProb(lim - 1, start - 3);\n        k--;\n    }\n    \n    ans += getProb(lim - 1, start) * k;\n    \n    return (prob[lim][start] = ans);\n}\n\nint main(void)\n{\n    int left;\n    int i, j;\n    char in[16];\n    \n    while (scanf(\"%d%*c\", &left) && left){\n        scanf(\"%[^\\n]s\", in);\n        \n        from = in[0] - 'A';\n        battery = in[2] - 'A';\n        to = in[4] - 'A';\n        \n        for (i = 0; i < 16; i++){\n            for (j = 0; j < 16; j++){\n                prob[i][j] = -1;\n            }\n        }\n        \n        printf(\"%.8lf\\n\", getProb(left, from) * 1.0 / (1 << (left * 2)));\n    }\n    \n    return (0);\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nint patterns = 0;\nint goals = 0;\n/* typedef enum { */\n/* \tA = 0, */\n/* \tB, */\n/* \tC, */\n/* \tD, */\n/* \tE, */\n/* \tF, */\n/* \tG, */\n/* \tH, */\n/* \tI, */\n/* } ROOMS; */\nvoid cleaning(char lroom, char groom, char broom, int cnt);\nvoid subcleaning(char lroom, char groom, char broom, int cnt, char next);\n\nvoid subcleaning(char lroom, char groom, char broom, int cnt, char next) {\n//\tprintf(\"%c \", next);\n\t\n\tif (next == broom || next == 'N') {\n\t\tcleaning(lroom, groom, broom, --cnt);\n\t} else {\n\t\tcleaning(next, groom, broom, --cnt);\n\t}\n}\n\nvoid cleaning(char lroom, char groom, char broom, int cnt) {\n//\t++patterns;\n\tif (0 == cnt) {\n\t\t++patterns;\n\t\tif (lroom == groom) {\n\t\t\t++goals;\n\t\t}\n\t\treturn;\n\t}\n\t\n\tswitch(lroom) {\n\tcase 'A':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'B');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'D');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tbreak;\n\tcase 'B':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'A');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'E');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'C');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tbreak;\n\tcase 'C':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'B');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'F');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tbreak;\n\tcase 'D':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'A');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'E');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'G');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tbreak;\n\tcase 'E':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'B');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'D');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'F');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'H');\n\t\tbreak;\n\tcase 'F':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'C');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'E');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'I');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tbreak;\n\tcase 'G':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'D');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'H');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tbreak;\n\tcase 'H':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'G');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'E');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'I');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tbreak;\n\tcase 'I':\n\t\tsubcleaning(lroom, groom, broom, cnt, 'F');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'I');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tsubcleaning(lroom, groom, broom, cnt, 'N');\n\t\tbreak;\n\t}\n\treturn;\n}\n\nint main(void) {\n\tint n;\n\tchar s, t, b; \n\twhile(1) {\n\t\tscanf(\"%d\", &n);\n\t\tif (n == 0) {\n\t\t\tbreak;\n\t\t}\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n//\t\tprintf(\"%c %c %c\\n\", s, t, b);\n\t\tpatterns = 0;\n\t\tgoals = 0;\n\t\tcleaning(s, t, b, n);\n\t\tprintf(\"goals = %d\\n\", goals);\n\t\tprintf(\"patterns = %d\\n\", patterns);\n\t\tprintf(\"%lf\\n\", (double)goals/patterns);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\nint main(void){\n\tint a;\n\twhile(scanf(\"%d\",&a),a){\n\t\tif(getchar()!='\\n')return 1;\n\t\tscanf(\" %*c %*c %*c\");\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n\nint first_x,first_y;\nint zyuden_x,zyuden_y;\nint soko_x,soko_y;\ndouble map[15][5][5];\n\nvoid get_where(int* x,int* y,char c) {\n\tif(c=='A'){*x=1;*y=1;}\n\tif(c=='B'){*x=2;*y=1;}\n\tif(c=='C'){*x=3;*y=1;}\n\tif(c=='D'){*x=1;*y=2;}\n\tif(c=='E'){*x=2;*y=2;}\n\tif(c=='F'){*x=3;*y=2;}\n\tif(c=='G'){*x=1;*y=3;}\n\tif(c=='H'){*x=2;*y=3;}\n\tif(c=='I'){*x=3;*y=3;}\n}\n\nint main(void) {\n\tint battery;\n\tchar first[2],zyuden[2],soko[2];\n\tint i,j,k;\n\twhile(1) {\n\t\tscanf(\"%d\",&battery);\n\t\tif(battery==0)break;\n\t\tscanf(\"%s%s%s\",first,zyuden,soko);\n\t\tget_where(&first_x,&first_y,first[0]);\n\t\tget_where(&zyuden_x,&zyuden_y,zyuden[0]);\n\t\tget_where(&soko_x,&soko_y,soko[0]);\n\t\tmemset(map,0,sizeof(map));\n\t\tmap[0][first_x][first_y]=1;\n\t\tfor(i=1;i<=battery;i++) {\n\t\t\tfor(j=1;j<=3;j++) {\n\t\t\t\tfor(k=1;k<=3;k++) {\n\t\t\t\t\tmap[i][j][k]=\n\t\t\t\t\t\t(map[i-1][j-1][k]+map[i-1][j+1][k]+\n\t\t\t\t\t\t map[i-1][j][k-1]+map[i-1][j][k+1])/4.0;\n\t\t\t\t\tif(j==soko_x && k==soko_y)map[i][j][k]=0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.15f\\n\",map[battery][zyuden_x][zyuden_y]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\nint main(void){\n\tint d[] = { -5, -1, 1, 5 };\n\tint np, bp, tp, i, j, k, n;\n\tchar s, t, b;\n\t\n\tfor(; scanf(\"%d %c %c %c\", &n, &s, &t, &b), n; ){\n\t\tdouble pr[2][25] = {};\n\t\tnp = ( ( s - 'A' ) / 3 + 1 ) * 5 + ( s - 'A' ) % 3 + 1;\n\t\ttp = ( ( t - 'A' ) / 3 + 1 ) * 5 + ( t - 'A' ) % 3 + 1;\n\t\tbp = ( ( b - 'A' ) / 3 + 1 ) * 5 + ( b - 'A' ) % 3 + 1;\n\t\tpr[n & 1][np] = 1.0;\n\n\t\tfor( ; n--; ){\n\t\t\tfor( i = 1; i < 4; i++ ){\n\t\t\t\tfor( j = 1; j < 4; j++ ){\n\t\t\t\t\tnp = i * 5 + j;\n\t\t\t\t\tpr[n & 1][np] = 0.0;\n\t\t\t\t\tfor( k = 0; k < 4; k++ ){\n\t\t\t\t\t\tpr[n & 1][np] += pr[~n & 1][np + d[k]] / 4.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tpr[n & 1][bp] = 0.0;\n\t\t}\n\t\tprintf(\"%.9f\\n\", pr[0][tp] );\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#define OUT(x) ((0>x)||(x>2)||(0>y)||(y>2))\ntypedef struct{\n  double new;\n  double prev;\n}point;\n\ntypedef struct{\n  int x;\n  int y;\n}ipoint;\n\npoint bo[3][3];\n\nint main(){\n  int i,j,k,x,y,n;\n  char buf[16];\n  ipoint dic[]={{0,0},{1,0},{2,0},\n\t\t{0,1},{1,1},{2,1},\n\t\t{0,2},{1,2},{2,2}},\n    dir[]={{-1,0},{1,0},{0,-1},{0,1}};\n  ipoint st,go,wa;\n  while(1){\n    fgets(buf,16,stdin);\n    n=atoi(buf);\n    if(!n) break;\n    fgets(buf,16,stdin);\n    st=dic[(int)buf[0]-(int)'A'];\n    go=dic[(int)buf[2]-(int)'A'];\n    wa=dic[(int)buf[4]-(int)'A'];\n    bo[1][1].prev=1.0;\n    for(i=0;i<n;i++){\n      for(j=0;j<9;j++){\n\tif(bo[dic[j].y][dic[j].x].prev==0.0) continue;\n\tfor(k=0;k<4;k++){\n\t  x=dic[j].x+dir[k].x;\n\t  y=dic[j].y+dir[k].y;\n\t  if(OUT(x)||OUT(y)||((x==wa.x)&&(y==wa.y))){\n\t    x=dic[j].x;\n\t    y=dic[j].y;\n\t  }\n\t  bo[y][x].new+=bo[dic[j].y][dic[j].x].prev/4.0;\n\t}\n      }\n      for(j=0;j<9;j++){\n\tx=dic[j].x;\n\ty=dic[j].y;\n\tbo[y][x].prev=bo[y][x].new;\n\tbo[y][x].new=0.0;\n      }\n    }\n    printf(\"%.8f\\n\",bo[go.y][go.x].prev);\n    for(j=0;j<9;j++){\n      x=dic[j].x;\n      y=dic[j].y;\n      bo[y][x].prev=bo[y][x].new=0.0;\n    }\n  }\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "/*\nAizuOnline A1020\nCleaning Robot\n*/\n#include <stdio.h>\n#include <float.h>\nint  n;\nchar s,t,b;\n//                A B C D E F G H I\nint   k_t[9][9]={{2,1,0,1,0,0,0,0,0}, //A\n                 {1,1,1,0,1,0,0,0,0}, //B\n                 {0,1,2,0,0,1,0,0,0}, //C\n                 {1,0,0,1,1,0,1,0,0}, //D\n                 {0,1,0,1,0,1,0,1,0}, //E\n                 {0,0,1,0,1,1,0,0,1}, //F\n                 {0,0,0,1,0,0,2,1,0}, //G\n                 {0,0,0,0,1,0,1,1,1}, //H\n                 {0,0,0,0,0,1,0,1,2}  //I\n};\n\nint k_t_a[9][9];\ninit()\n{\n  n = 3;s = 'A';t = 'H';b = 'G';\n}\nunsigned long kakuritu(int bat,char from,char to)\n{ unsigned long ret;\n  char next;\n  // printf(\"%c %c \\n\",from,to);\n  if(bat==0)\n    if(from==to)\n      return(1LL<<31);\n    else\n      return(0LL);\n\n  ret=0L;\n  for(next='A';next<='I';next++)\n    if( k_t_a[from-'A'][next-'A'] == 1)\n      ret += kakuritu(bat-1,next,to) >> 2;\n    if( k_t_a[from-'A'][next-'A'] == 2)\n      ret += kakuritu(bat-1,next,to) >> 1;\n    if( k_t_a[from-'A'][next-'A'] == 3)\n      ret += (kakuritu(bat-1,next,to) >> 2\n\t      +kakuritu(bat-1,next,to) >> 1);\n  return(ret);\n\n}\nmod_k_t(char b)\n{\n  int i,j;\n  for(i=0;i<9;i++)\n    for(j=0;j<9;j++)\n      k_t_a[i][j]=k_t[i][j];\n    \n  for(i=0;i<9;i++)\n    if(k_t_a[i][b-'A'] > 0.0)\n      {  k_t_a[i][b-'A']=0.0;\n\t k_t_a[i][i] += 1;\n      }\n  \n}\n\nmain()\n{\n  //init();\n  while(EOF!=scanf(\"%d\\n\",&n) && n!=0)\n  { scanf(\"%c %c %c\",&s,&t,&b);\n    //printf(\"%d %c %c %c\\n\",n,s,t,b);\n    mod_k_t(b);\n    printf(\"%f\\n\",(float) (kakuritu(n,s,t))/65536/32768);\n    }\n  return(0);\n}"
  },
  {
    "language": "C",
    "code": "// Aizu 1020: Cleaning Robot\n// 2017.9.17 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\ndouble f[17][3][3];\nint mv[4][2] = {{-1,0},{0,1},{1,0},{0,-1}};\n\nint main()\n{\n\tint n, s, t, b, i, j, r, c, r2, c2;\n\tchar t1[5], t2[5], t3[5];\n\n\twhile (scanf(\"%d\", &n) && n) {\n\t\tscanf(\"%s%s%s\", t1, t2, t3), s = *t1-'A', t = *t2-'A', b = *t3-'A';\n\t\tmemset(f, 0, sizeof(f)), f[0][s/3][s%3] = 1.0;\n\t\tfor (j = 1; j <= n; j++) {\n\t\t\tfor (r = 0; r < 3; r++) for (c = 0; c < 3; c++) {\n\t\t\t\tfor (i = 0; i < 4; i++) {\n\t\t\t\t\tr2 = r + mv[i][0], c2 = c + mv[i][1];\n\t\t\t\t\tif (r2 < 0 || r2 >= 3 || c2 < 0 || c2 >= 3 || 3*r+c == b)\n\t\t\t\t\t\t f[j][r][c]   += f[j-1][r][c]/4.0;\n\t\t\t\t\telse f[j][r2][c2] += f[j-1][r][c]/4.0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\", f[n][t/3][t%3]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "/*\nAizuOnline A1020\nTitle Cleaning Robot\n6/11 WA\n*/\n#include <stdio.h>\n// Select Below\n//#include <stdlib.h>\n//#include <string.h>\n#include <float.h>\n//#include <math.h>\n//#include <limits.h>\n//Global data section\n// p[from_state][to_state]\n//state 0:A,1:B,2:C\n//      \nint n;\nchar s,t,b;      \ndouble p[16][9];\nint tr0[9][9]={{2,1,0,1,0,0,0,0,0},\n              {1,1,1,0,1,0,0,0,0},\n              {0,1,2,0,0,1,0,0,0},\n              {1,0,0,1,1,0,1,0,0},\n              {0,1,0,1,0,1,0,1,0},\n              {0,0,1,0,1,1,0,0,1},\n              {0,0,0,1,0,0,2,1,0},\n              {0,0,0,0,1,0,1,1,1},\n              {0,0,0,0,0,1,0,1,2}};\nint tr[9][9];\n//\nvoid init()\n{\n        int i;\n\n        for(i=0;i<9;i++)\n                p[0][i]=0.0;\n        p[0][s-'A']=1.0;\n}\nvoid souko()\n{\n        int i,j,b0;\n\n        for(i=0;i<9;i++)\n                for(j=0;j<9;j++)\n                        tr[i][j]=tr0[i][j];\n\n        b0=b-'A';\n        for(i=0;i<9;i++)\n        {\n                tr[i][i] += tr[b0][i];\n                tr[b0][i] = 0;\n        }\n}\nvoid show(int n)\n{\n        printf(\"----------------\\n\");\n        printf(\"%lf %lf %lf\\n\",p[n][0],p[n][1],p[n][2]);\n        printf(\"%lf %lf %lf\\n\",p[n][3],p[n][4],p[n][5]);\n        printf(\"%lf %lf %lf\\n\",p[n][6],p[n][7],p[n][8]);\n}\n\nmain()\n{\n        int i,j,k;\n        double sum;\n        \n        while(scanf(\"%d \",&n) && n)\n        {\n                scanf(\"%c %c %c\",&s,&t,&b);\n                init();\n                souko();\n\n                //show(0);\n                for(i=0;i<n;i++)\n                {                        \n                        for(j=0;j<9;j++)\n                        {\n                                sum=0.0;\n                                for(k=0;k<9;k++)\n                                        sum += (double)tr[j][k]/4.0*p[i][k];\n                                p[i+1][j]=sum;\n                        }\n                        //show(i+1);\n                }\n\n                printf(\"%0.8lf\\n\",p[n][t-'A']);\n        }\nreturn(0);\n}"
  },
  {
    "language": "C",
    "code": "/*\nAizuOnline A1020\nCleaning Robot\n*/\n#include <stdio.h>\n#include <float.h>\nint  n;\nchar s,t,b;\n//                A B C D E F G H I\nint   k_t[9][9]={{2,1,0,1,0,0,0,0,0}, //A\n                 {1,1,1,0,1,0,0,0,0}, //B\n                 {0,1,2,0,0,1,0,0,0}, //C\n                 {1,0,0,1,1,0,1,0,0}, //D\n                 {0,1,0,1,0,1,0,1,0}, //E\n                 {0,0,1,0,1,1,0,0,1}, //F\n                 {0,0,0,1,0,0,2,1,0}, //G\n                 {0,0,0,0,1,0,1,1,1}, //H\n                 {0,0,0,0,0,1,0,1,2}  //I\n};\n\nint k_t_a[9][9];\ninit()\n{\n  n = 3;s = 'A';t = 'H';b = 'G';\n}\nunsigned long kakuritu(int bat,char from,char to)\n{ unsigned long ret,w;\n  char next;\n  int  prob;\n  \n\n  // printf(\"%c %c \\n\",from,to);\n  if(bat==0)\n    if(from==to)\n      return(1L<<31);\n    else\n      return(0L);\n\n  ret=0L;\n  for(next='A';next<='I';next++)\n    {  prob= k_t_a[from-'A'][next-'A'];\n      if(prob  == 1)  //0.25\n\t ret += kakuritu(bat-1,next,to) >> 2;\n       if(prob  == 2)  //0.5\n\t ret += kakuritu(bat-1,next,to) >> 1;\n       if(prob == 3)  // 0.75\n\t { w = (kakuritu(bat-1,next,to) >> 1);\n\t   ret += (w + (w >> 1));\n\t }\n    }\n  return(ret);\n\n}\nmod_k_t(char b)\n{\n  int i,j;\n  for(i=0;i<9;i++)\n    for(j=0;j<9;j++)\n      k_t_a[i][j]=k_t[i][j];\n    \n  for(i=0;i<9;i++)\n    if(k_t_a[i][b-'A'] > 0.0)\n      {  k_t_a[i][b-'A']=0.0;\n\t k_t_a[i][i] += 1;\n      }\n  \n}\n\nmain()\n{\n  //init();\n  while(EOF!=scanf(\"%d\\n\",&n) && n!=0)\n  { scanf(\"%c %c %c\",&s,&t,&b);\n    //printf(\"%d %c %c %c\\n\",n,s,t,b);\n    mod_k_t(b);\n    printf(\"%f\\n\",(float) (kakuritu(n,s,t))/65536/32768);\n    }\n  return(0);\n}"
  },
  {
    "language": "C",
    "code": "#include \"stdio.h\"\n#include \"math.h\"\n\nint main()\n{\n\tint n;\n\tchar s, t, b;\n\n\tscanf(\"%d\", &n);\n\twhile(n>0){\n\t\tscanf(\" %c %c %c\", &s, &t, &b);\n\t\ts-='A'; t-='A'; b-='A';\n\n\t\tint footprint1[9]={0,0,0,0,0,0,0,0,0};\n\t\tint footprint2[9];\n\t\tfootprint1[s] = 1;\n\t\tfor(int i=0; i<n; i++){\n\t\t\tfor(int j=0; j<9; j++) footprint2[j]=0;\n\t\t\tfor(int j=0; j<9; j++){\n\t\t\t\tif(footprint1[j]>0){\n\t\t\t\t\tif(j>2 && j-3!=b) footprint2[j-3]+=footprint1[j];\n\t\t\t\t\telse footprint2[j]+=footprint1[j];\n\t\t\t\t\tif(j%3>0 && j-1!=b) footprint2[j-1]+=footprint1[j];\n\t\t\t\t\telse footprint2[j]+=footprint1[j];\n\t\t\t\t\tif((j+1)%3>0 && j+1!=b) footprint2[j+1]+=footprint1[j];\n\t\t\t\t\telse footprint2[j]+=footprint1[j];\n\t\t\t\t\tif(j<6 && j+3!=b) footprint2[j+3]+=footprint1[j];\n\t\t\t\t\telse footprint2[j]+=footprint1[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int j=0; j<9; j++) footprint1[j]=footprint2[j];\n\t\t}\n\n\t\tprintf(\"%f\\n\", footprint1[t] / pow(4.0, n));\n\n\t\tscanf(\"%d\", &n);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\ndouble p[2][3][3];\nint dx[4]={-1,0,0,1};\nint dy[4]={0,1,-1,0};\nint main(){\n\tint n;\n\tchar a,b,c;\n\tint s,g,x;\n\tint i,j;\n\twhile(1){\n\tscanf(\"%d\",&n);\n\tif(n==0)return 0;\n\tscanf(\" %c %c %c\",&a,&b,&c);\n\ts=(int)a-'A';\n\tg=(int)b-'A';\n\tx=(int)c-'A';\n\tfor(i=0;i<9;i++){\n\t\tif(i!=s)p[0][i/3][i%3]=0.0f;\n\t\telse p[0][i/3][i%3]=1.0f;\n\t\tp[1][i/3][i%3]=0.0f;\n\t}\n\twhile(n>0){\n\t\tn--;\n\t\tfor(i=0;i<9;i++){\n\t\t\tfor(j=0;j<4;j++){\n\t\t\t\tif(i/3+dy[j]<0||i/3+dy[j]>=3||i%3+dx[j]<0||i%3+dx[j]>=3||(i/3+dy[j]==x/3&&i%3+dx[j]==x%3)){\n\t\t\t\t\tp[1][i/3][i%3]+=p[0][i/3][i%3]/4;\n\t\t\t\t}\n\t\t\t\telse p[1][i/3+dy[j]][i%3+dx[j]]+=p[0][i/3][i%3]/4;\n\t\t\t}\n\t\t}\n\t\tfor(i=0;i<9;i++){\n\t\t\tp[0][i/3][i%3]=p[1][i/3][i%3];\n\t\t\tp[1][i/3][i%3]=0.0f;\n\t\t}\n\t}\n\tprintf(\"%lf\\n\",p[0][g/3][g%3]);\n\t}\t\n}\n\t"
  },
  {
    "language": "C",
    "code": "/*\nAizuOnline A1020\nCleaning Robot\n*/\n#include <stdio.h>\n#include <float.h>\nint  n;\nchar s,t,b;\n//                A B C D E F G H I\nint   k_t[9][9]={{2,1,0,1,0,0,0,0,0}, //A\n                 {1,1,1,0,1,0,0,0,0}, //B\n                 {0,1,2,0,0,1,0,0,0}, //C\n                 {1,0,0,1,1,0,1,0,0}, //D\n                 {0,1,0,1,0,1,0,1,0}, //E\n                 {0,0,1,0,1,1,0,0,1}, //F\n                 {0,0,0,1,0,0,2,1,0}, //G\n                 {0,0,0,0,1,0,1,1,1}, //H\n                 {0,0,0,0,0,1,0,1,2}  //I\n};\n\nint k_t_a[9][9];\ninit()\n{\n  n = 3;s = 'A';t = 'H';b = 'G';\n}\nunsigned long kakuritu(int bat,char from,char to)\n{ unsigned long ret;\n  char next;\n  // printf(\"%c %c \\n\",from,to);\n  if(bat==0)\n    if(from==to)\n      return(1LL<<31);\n    else\n      return(0LL);\n\n  ret=0L;\n  for(next='A';next<='I';next++)\n    if( k_t_a[from-'A'][next-'A'] == 1)\n      ret += kakuritu(bat-1,next,to) >> 2;\n    if( k_t_a[from-'A'][next-'A'] == 2)\n      ret += kakuritu(bat-1,next,to) >> 1;\n    if( k_t_a[from-'A'][next-'A'] == 3)\n      ret += (kakuritu(bat-1,next,to) >> 2\n\t      +kakuritu(bat-1,next,to) >> 1);\n  return(ret);\n\n}\nmod_k_t(char b)\n{\n  int i,j;\n  for(i=0;i<9;i++)\n    for(j=0;j<9;j++)\n      k_t_a[i][j]=k_t[i][j];\n    \n  for(i=0;i<9;i++)\n    if(k_t_a[i][b-'A'] > 0.0)\n      {  k_t_a[i][b-'A']=0.0;\n\t k_t_a[i][i] += 1;\n      }\n  \n}\n\nmain()\n{\n  //init();\n  while(EOF!=scanf(\"%d\\n\",&n) && n!=0)\n  { scanf(\"%c %c %c\",&s,&t,&b);\n    //printf(\"%d %c %c %c\\n\",n,s,t,b);\n    mod_k_t(b);\n    printf(\"%f\\n\",(float) (kakuritu(n,s,t))/65536/32768);\n    }\n  return(0);\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\n#include<math.h>\n\nint m[4]={3,-3,1,-1},s,t,b;\n\nint dp[9][16];\n\nint d(int pos,int buttery)\n{\n                 int i,n=0;\n                 if(dp[pos][buttery]!=-1)\n                                 return dp[pos][buttery];\n                 if(buttery==0&&pos==t)\n                                 return 1;\n                 else if (buttery>0&&(abs(pos/3-t/3)+abs(pos%3-t%3))<=buttery)\n                {\n                                 for(i=0;i<4;i++)\n                                {\n                                                 if(pos+m[i]>=0 && pos+m[i]<9 && pos+m[i]!=b)\n                                                                n+=d(pos+m[i],buttery-1);\n                                                 else\n                                                                n+=d(pos,buttery-1);\n                                }\n                }\n                 return dp[pos][buttery]= n;\n}\n\nint main()\n{\n                 int buttery,ans;\n                 char cs,ct,cb;\n                 for(;scanf(\"%d\" ,&buttery);ans=0)\n                {\n                                 if(buttery==0)\n                                                 return 0;\n                                scanf( \"\\n%c %c %c\",&cs,&ct,&cb);\n                                memset(dp,-1, sizeof(dp));\n                                s=cs-65;t=ct-65;b=cb-65;\n                                ans=d(s,buttery);\n                                 int tmp1=1<<(buttery*2);\n                                 double tmp2=(double )ans/tmp1;\n                                printf( \"%.8lf\\n\",tmp2);\n                }\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <time.h>\nint main(void){\n\tint a = 1, n;\n\tchar c;\n\t\n\twhile( scanf(\"%d%c %*c %*c %*c\", &n, &c ), n != 0 ){\n\t\tif( c == ' ' ){\n\t\t\tclock_t c1 = clock();\n\t\t\tclock_t c2 = (clock_t)(a * 0.1 * CLOCKS_PER_SEC + c1);\n\t\t\twhile( clock() < c2 );\n\t\t\treturn 0;\n\t\t}\n\t\t++a;\n\t}\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\nint from, battery, to;\ndouble prob[16][16]; //残量iで, 地点jからbatteryへいける確率\n\ndouble getProb(int lim, int start)\n{\n    int k;\n    double ans;\n    \n    if (prob[lim][start] >= 0){\n        return (prob[lim][start]);\n    }\n    \n    if (start == battery && lim == 0){\n        return (1);\n    }\n    if (lim == 0){\n        return (0);\n    }\n    \n    ans = 0.0;\n    k = 4;\n    \n    if ((start + 1) % 3 && start + 1 != to){\n        ans += 0.25 * getProb(lim - 1, start + 1);\n        k--;\n    }\n    \n    if (start % 3 && start - 1 != to){\n        ans += 0.25 * getProb(lim - 1, start - 1);\n        k--;\n    }\n    \n    if (start + 3 < 9 && start + 3 != to){\n        ans += 0.25 * getProb(lim - 1, start + 3);\n        k--;\n    }\n    \n    if (start - 3 >= 0 && start - 3 != to){\n        ans += 0.25 * getProb(lim - 1, start - 3);\n        k--;\n    }\n    \n    ans += 0.25 * k * getProb(lim - 1, start);\n    \n    return (prob[lim][start] = ans);\n}\n\nint main(void)\n{\n    int left;\n    int i, j;\n    \n    while (1){\n        scanf(\"%d\", &left);\n        getchar();\n        if (left == 0){\n            break;\n        }\n        scanf(\"%c %c %c\", &from, &battery, &to);\n        getchar();\n        from -= 'A';\n        battery -= 'A';\n        to -= 'A';\n        \n        for (i = 0; i < 16; i++){\n            for (j = 0; j < 16; j++){\n                prob[i][j] = -1;\n            }\n        }\n        \n        printf(\"%.8lf\\n\", getProb(left, from));\n    }\n    \n    return (0);\n}"
  },
  {
    "language": "C",
    "code": "// Aizu 1020: Cleaning Robot\n// 2017.9.17 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\nchar map[3][3];\ndouble f[16][3][3];\nint mv[4][2] = {{-1,0},{0,1},{1,0},{0,-1}};\n\nint main()\n{\n\tint n, s, t, b, i, j, r, c, r2, c2;\n\tchar t1[5], t2[5], t3[5];\n\n\twhile (scanf(\"%d\", &n) && n) {\n\t\tscanf(\"%s%s%s\", t1, t2, t3), s = *t1-'A', t = *t2-'A', b = *t3-'A';\n\t\tmemset(f, 0, sizeof(f)), memset(map, 0, sizeof(map));\n\t\tmap[b/3][b%3] = 1, f[0][s/3][s%3] = 1.0;\n\t\tfor (j = 1; j <= n; j++) {\n\t\t\tfor (r = 0; r < 3; r++) for (c = 0; c < 3; c++) {\n\t\t\t\tfor (i = 0; i < 4; i++) {\n\t\t\t\t\tr2 = r + mv[i][0], c2 = c + mv[i][1];\n\t\t\t\t\tif (r2 < 0 || r2 >= 3 || c2 < 0 || c2 >= 3 || map[r][c])\n\t\t\t\t\t\t f[j][r][c]   += f[j-1][r][c]/4.0;\n\t\t\t\t\telse f[j][r2][c2] += f[j-1][r][c]/4.0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\", f[n][t/3][t%3]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "/*\nAizuOnline A1020\nCleaning Robot\n*/\n#include <stdio.h>\n#include <float.h>\nint  n;\nchar s,t,b;\n//                A    B    C    D    E    F    G    H    I\nfloat k_t[9][9]={{0.50,0.25,0.00,0.25,0.00,0.00,0.00,0.00,0.00}, //A\n                 {0.25,0.25,0.25,0.00,0.25,0.00,0.00,0.00,0.00}, //B\n                 {0.00,0.25,0.50,0.00,0.00,0.25,0.00,0.00,0.00}, //C\n                 {0.25,0.00,0.00,0.25,0.25,0.00,0.25,0.00,0.00}, //D\n                 {0.00,0.25,0.00,0.25,0.00,0.25,0.00,0.25,0.00}, //E\n                 {0.00,0.00,0.25,0.00,0.25,0.25,0.00,0.00,0.25}, //F\n                 {0.00,0.00,0.00,0.25,0.00,0.00,0.50,0.25,0.00}, //G\n                 {0.00,0.00,0.00,0.00,0.25,0.00,0.25,0.25,0.25}, //H\n                 {0.00,0.00,0.00,0.25,0.00,0.25,0.00,0.25,0.25} //I\n};\n\nfloat k_t_a[9][9];\ninit()\n{\n  n = 3;s = 'A';t = 'H';b = 'G';\n}\ndouble kakuritu(int bat,char from,char to)\n{ double ret;\n  char next;\n  // printf(\"%c %c \\n\",from,to);\n  if(bat==0)\n    if(from==to)\n      return(1.0);\n    else\n      return(0.0);\n\n  ret=0.0;\n  for(next='A';next<='I';next++)\n    if( k_t_a[from-'A'][next-'A'] > 0.0)\n      ret += k_t_a[from-'A'][next-'A']*kakuritu(bat-1,next,to);\n  return(ret);\n\n}\nmod_k_t(char b)\n{\n  int i,j;\n  for(i=0;i<9;i++)\n    for(j=0;j<9;j++)\n      k_t_a[i][j]=k_t[i][j];\n    \n  for(i=0;i<9;i++)\n    if(k_t_a[i][b-'A'] > 0.0)\n      {  k_t_a[i][b-'A']=0.0;\n\t k_t_a[i][i] += 0.25;\n      }\n  \n}\n\nmain()\n{\n  //init();\n  while(EOF!=scanf(\"%d\\n\",&n) && n!=0)\n  { scanf(\"%c %c %c\",&s,&t,&b);\n    //printf(\"%d %c %c %c\\n\",n,s,t,b);\n    mod_k_t(b);\n    printf(\"%f\\n\",kakuritu(n,s,t));\n    }\n  return(0);\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\nint main(void){\n\tint a;\n\twhile(scanf(\"%d\",&a),a){\n\t\tif(getchar()==' ')return 1;\n\t\tscanf(\" %*c %*c %*c\");\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "// Aizu 1020: Cleaning Robot\n// 2017.9.17 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n#include <stdlib.h>\n#include <ctype.h>\n\ndouble f[17][3][3];\nint mv[4][2] = {{-1,0},{0,1},{1,0},{0,-1}};\n\nint main()\n{\n\tint n, s, t, b, i, j, r, c, r2, c2;\n\tchar buf[30], *p;\n\n\twhile (1) {\n\t\tfgets(buf, 20, stdin); n = atoi(buf); if (!n) break;\n\t\tfgets(buf, 20, stdin); p = buf;\n\t\twhile (isspace(*p)) p++; if (*p < 'A' || *p > 'I') while (1); s = *p++ - 'A';\n\t\twhile (isspace(*p)) p++; if (*p < 'A' || *p > 'I') while (1); t = *p++ - 'A';\n\t\twhile (isspace(*p)) p++; if (*p < 'A' || *p > 'I') while (1); b = *p   - 'A';\n\t\tmemset(f, 0, sizeof(f)), f[0][s/3][s%3] = 1;\n\t\tfor (j = 1; j <= n; j++) {\n\t\t\tfor (r = 0; r < 3; r++) for (c = 0; c < 3; c++) {\n\t\t\t\tfor (i = 0; i < 4; i++) {\n\t\t\t\t\tr2 = r + mv[i][0], c2 = c + mv[i][1];\n\t\t\t\t\tif (r2 < 0 || r2 >= 3 || c2 < 0 || c2 >= 3 || 3*r+c == b) r2 = r, c2 = c;\n\t\t\t\t\tf[j][r2][c2] += f[j-1][r][c] / 4;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%.8lf\\n\", f[n][t/3][t%3]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "Kotlin",
    "code": "\nfun main(args:Array<String>):Unit {\n    val charToPoint = mapOf(Pair(\"A\", Point(0, 0)), Pair(\"B\", Point(1, 0)), Pair(\"C\", Point(2, 0)),\n            Pair(\"D\", Point(0, 1)), Pair(\"E\", Point(1, 1)), Pair(\"F\", Point(2, 1)),\n            Pair(\"G\", Point(0, 2)), Pair(\"H\", Point(1, 2)), Pair(\"I\", Point(2, 2))\n            )\n    val points = (0 until 3).flatMap{y -> (0 until 3).map{Point(it, y)}}\n    while(true){\n        val n = readLine()!!.trim().toInt()\n        if (n == 0) return\n        val roomState = Array(3){Array(3){true}}\n        val (s, t, b) = readLine()!!.trim().split(' ')\n        val start = charToPoint[s]!!\n        val buttery = charToPoint[t]!!\n        roomState[charToPoint[b]!!.y][charToPoint[b]!!.x] = false\n        val matrix = Array(9){Array(9){.0}}\n        points.forEachIndexed { index, point ->\n            point.neighbors().forEach {\n                if (it.x in 0 until 3 && it.y in 0 until 3 && roomState[it.y][it.x]){\n                    matrix[index][it.x + it.y * 3] += 0.25\n                }else{\n                    matrix[index][point.x + point.y * 3] += 0.25\n                }\n            }\n        }\n        val res = exp(matrix, n)\n        println(res[buttery.x + buttery.y * 3][start.x + start.y * 3])\n    }\n}\noperator fun Array<Array<Double>>.times(that:Array<Array<Double>>):Array<Array<Double>> {\n    return this.map{line ->\n        that.first().indices.map{column ->\n            line.zip(that.map{it[column]}).sumByDouble{(a, b) -> a * b}\n        }.toTypedArray()\n    }.toTypedArray()\n}\nfun exp(base:Array<Array<Double>>, e:Int):Array<Array<Double>> {\n    return when(e){\n        0 -> Array(base.size){y -> Array(base.size){x -> if (x == y) 1.0 else .0}}\n        1 -> base\n        else -> exp(base, e / 2).let{if (e % 2 == 1) base * it * it else it * it}\n    }\n}\ndata class Point(val x:Int, val y:Int){\n    operator fun plus(that:Point):Point = Point(x + that.x, y + that.y)\n    fun neighbors():Iterable<Point> = listOf(Point(1, 0), Point(-1, 0), Point(0, 1), Point(0, -1)).map{this + it}\n}\n"
  },
  {
    "language": "Kotlin",
    "code": "\nfun main(args:Array<String>):Unit {\n    val charToPoint = mapOf(Pair(\"A\", Point(0, 0)), Pair(\"B\", Point(1, 0)), Pair(\"C\", Point(2, 0)),\n            Pair(\"D\", Point(0, 1)), Pair(\"E\", Point(1, 1)), Pair(\"F\", Point(2, 1)),\n            Pair(\"G\", Point(0, 2)), Pair(\"H\", Point(1, 2)), Pair(\"I\", Point(2, 2))\n            )\n    val points = (0 until 3).flatMap{y -> (0 until 3).map{Point(it, y)}}\n    while(true){\n        val n = readLine()!!.trim().toInt()\n        if (n == 0) return\n        val roomState = Array(3){Array(3){true}}\n        val (s, t, b) = readLine()!!.trim().split(' ')\n        val start = charToPoint[s]!!\n        val buttery = charToPoint[t]!!\n        roomState[charToPoint[b]!!.y][charToPoint[b]!!.x] = false\n        val matrix = Array(9){Array(9){.0}}\n        points.forEachIndexed { index, point ->\n            point.neighbors().forEach {\n                if (it.x in 0 until 3 && it.y in 0 until 3 && roomState[it.y][it.x]){\n                    matrix[index][it.x + it.y * 3] += 0.25\n                }else{\n                    matrix[index][point.x + point.y * 3] += 0.25\n                }\n            }\n        }\n        val res = exp(matrix, n)\n        println(res[buttery.x + buttery.y * 2][start.x + start.y * 3])\n    }\n}\noperator fun Array<Array<Double>>.times(that:Array<Array<Double>>):Array<Array<Double>> {\n    return this.map{line ->\n        that.first().indices.map{column ->\n            line.zip(that.map{it[column]}).sumByDouble{(a, b) -> a * b}\n        }.toTypedArray()\n    }.toTypedArray()\n}\nfun exp(base:Array<Array<Double>>, e:Int):Array<Array<Double>> {\n    return when(e){\n        0 -> Array(base.size){y -> Array(base.size){x -> if (x == y) 1.0 else .0}}\n        1 -> base\n        else -> exp(base, e / 2).let{if (e % 2 == 1) base * it * it else it * it}\n    }\n}\ndata class Point(val x:Int, val y:Int){\n    operator fun plus(that:Point):Point = Point(x + that.x, y + that.y)\n    fun neighbors():Iterable<Point> = listOf(Point(1, 0), Point(-1, 0), Point(0, 1), Point(0, -1)).map{this + it}\n}\n"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\ttry {\n\t\t\t//initialize\n\t\t\tdouble dp[][][][] = new double[16][9][9][9];\n\t\t\tfor(int i=0;i<16;i++){\n\t\t\t\tfor(int j=0;j<9;j++){\n\t\t\t\t\tfor(int k=0;k<9;k++){\n\t\t\t\t\t\tfor(int l=0;l<9;l++){\n\t\t\t\t\t\t\tdp[i][j][k][l] = -1.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tString line;\n\t\t\twhile(true){\n\t\t\t\t/* input */\n\t\t\t\tline = br.readLine();\n\n\t\t\t\tint n = Integer.parseInt(line);\n\n\t\t\t\tif(n==0) break;\n\n\t\t\t\tline = br.readLine();\n\n\t\t\t\tchar s = line.split(\" \")[0].charAt(0), t = line.split(\" \")[1].charAt(0), b = line.split(\" \")[2].charAt(0);\n\n\t\t\t\t/* processing */\n\t\t\t\t\n\n\t\t\t\tdouble ans = solve(dp, n,s-'A',t-'A',b-'A');\n\t\t\t\t/* output */\n\t\t\t\tSystem.out.println(ans);\n\t\t\t}\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\n\tpublic static double solve(double[][][][] dp, int n, int s, int t, int b){\n\t\tif(dp[n][s][t][b]>=0) return dp[n][s][t][b];\n\t\tif(n==0){\n\t\t\tif(s==t){\n\t\t\t\tdp[n][s][t][b] = 1.0;\n\t\t\t\treturn 1.0;\n\t\t\t} else {\n\t\t\t\tdp[n][s][t][b] = 0.0;\n\t\t\t\treturn 0.0;\n\t\t\t}\n\t\t} else {\n\t\t\tdouble ret = 0;\n\t\t\tif(dp[n-1][s>2&&b!=s-3?s-3:s][t][b]>=0){\n\t\t\t\tret += 0.25*dp[n-1][s>2&&b!=s-3?s-3:s][t][b];\n\t\t\t} else {\n\t\t\t\tdp[n-1][s>2&&b!=s-3?s-3:s][t][b] = solve(dp,n-1,s>2&&b!=s-3?s-3:s,t,b); \n\t\t\t\tret += 0.25*dp[n-1][s>2&&b!=s-3?s-3:s][t][b];\n\t\t\t}\n\t\t\tif(dp[n-1][s%3!=2&&b!=s+1?s+1:s][t][b]>=0){\n\t\t\t\tret += 0.25*dp[n-1][s%3!=2&&b!=s+1?s+1:s][t][b];\n\t\t\t} else {\n\t\t\t\tdp[n-1][s%3!=2&&b!=s+1?s+1:s][t][b] = solve(dp,n-1,s%3!=2&&b!=s+1?s+1:s,t,b); \n\t\t\t\tret += 0.25*dp[n-1][s%3!=2&&b!=s+1?s+1:s][t][b];\n\t\t\t}\n\t\t\tif(dp[n-1][s<6&&b!=s+3?s+3:s][t][b]>=0){\n\t\t\t\tret += 0.25*dp[n-1][s<6&&b!=s+3?s+3:s][t][b];\n\t\t\t} else {\n\t\t\t\tdp[n-1][s<6&&b!=s+3?s+3:s][t][b] = solve(dp,n-1,s<6&&b!=s+3?s+3:s,t,b);\n\t\t\t\tret += 0.25*dp[n-1][s<6&&b!=s+3?s+3:s][t][b];\n\t\t\t}\n\t\t\tif(dp[n-1][s%3!=0&&b!=s-1?s-1:s][t][b]>=0){\n\t\t\t\tret += 0.25*dp[n-1][s%3!=0&&b!=s-1?s-1:s][t][b];\n\t\t\t} else {\n\t\t\t\tdp[n-1][s%3!=0&&b!=s-1?s-1:s][t][b] =solve(dp,n-1,s%3!=0&&b!=s-1?s-1:s,t,b);\n\t\t\t\tret += 0.25*dp[n-1][s%3!=0&&b!=s-1?s-1:s][t][b];\n\t\t\t}\n\t\t\t\n\t\t\tdp[n][s][t][b] = ret;\n\t\t\treturn ret;\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.math.*;\nimport java.awt.geom.*;\nimport java.io.*;\n      \n      \npublic class Main {\n\tstatic int[] vx = new int[]{0,1,0,-1};\n\tstatic int[] vy = new int[]{1,0,-1,0};\n\tstatic int[] Y  = new int[]{0,0,0,1,1,1,2,2,2};\n\tstatic int[] X  = new int[]{0,1,2,0,1,2,0,1,2};\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n == 0) break;\n\t\t\tchar s = sc.next().charAt(0);\n\t\t\tint S = s - 'A';\n\t\t\tchar t = sc.next().charAt(0);\n\t\t\tint T = t - 'A';\n\t\t\tchar b = sc.next().charAt(0);\n\t\t\tint B = b - 'A';\n\t\t\tint[][][] dp = new int[n+1][3][3];\n\t\t\tdp[0][Y[S]][X[S]] = 1;\n\t\t\tfor(int i = 0; i < n; i++) {\n\t\t\t\tfor(int j = 0; j < 3; j++) {\n\t\t\t\t\tfor(int k = 0; k < 3; k++) {\n\t\t\t\t\t\tfor(int l = 0; l < 4; l++) {\n\t\t\t\t\t\t\tint ty = j + vy[l];\n\t\t\t\t\t\t\tint tx = k + vx[l];\n\t\t\t\t\t\t\tif(ty < 0 || tx < 0 || tx >= 3 || ty >= 3 || (ty == Y[B] && tx == X[B])) {\n\t\t\t\t\t\t\t\tty = j;\n\t\t\t\t\t\t\t\ttx = k;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdp[i+1][ty][tx] += dp[i][j][k];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tint sum = 0;\n\t\t\tfor(int i = 0; i < 3; i++) {\n\t\t\t\tfor(int j = 0; j < 3; j++) {\n\t\t\t\t\tsum += dp[n][i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.printf(\"%.25f\",dp[n][Y[T]][X[T]] / (double)sum);\n\t\t\t\n\t\t}\n\t}\n }"
  },
  {
    "language": "Java",
    "code": "import java.text.DecimalFormat;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\tstatic final DecimalFormat df = new DecimalFormat(\"0.0000000000\");\n\tstatic final int A = 0, B = 1, C = 2, D = 3, E = 4, F = 5, G = 6, H = 7,\n\t\t\tI = 8;\n\tstatic final int[][] rooms = {\n\t\t\t//\n\t\t\t{ A, D, B, A }, { B, E, C, A }, { C, F, C, B },//\n\t\t\t{ A, G, E, D }, { B, H, F, D }, { C, I, F, E },//\n\t\t\t{ D, G, H, G }, { E, H, I, G }, { F, I, I, H } };\n\n\tpublic static void main(String[] args) {\n\t\tScanner in = new Scanner(System.in);\n\t\tint n;\n\t\tint[] now = new int[9];\n\t\tint[] next = new int[9];\n\t\twhile ((n = in.nextInt()) > 0) {\n\t\t\tdouble a = Math.pow(4, n);\n\t\t\tint s = in.next().charAt(0) - 'A';\n\t\t\tnow[s] = (int) a;\n\t\t\tint t = in.next().charAt(0) - 'A';// 充電器\n\t\t\tint b = in.next().charAt(0) - 'A';// 入れない\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tfor (int room = 0; room < 9; room++) {\n\t\t\t\t\tint val = now[room] / 4;\n\t\t\t\t\tfor (int arrow = 0; arrow < 4; arrow++) {\n\t\t\t\t\t\tif (rooms[room][arrow] != b)\n\t\t\t\t\t\t\tnext[rooms[room][arrow]] += val;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tnext[room] += val;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tint[] memo = now;\n\t\t\t\tnow = next;\n\t\t\t\tnext = memo;\n\t\t\t\tArrays.fill(next, 0);\n\t\t\t}\n\t\t\tSystem.out.println(df.format(now[t] / a));\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.IOException;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) throws IOException {\n\n\t\tnew Main().run();\n\t}\n\n\tprivate void run() throws IOException {\n\t\tScanner scanner = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint n = scanner.nextInt();\n\t\t\tif (n == 0)\n\t\t\t\tbreak;\n\t\t\tint[] xs = new int[3];\n\t\t\tint[] ys = new int[3];\n\t\t\tfor (int i = 0; i < 3; i++) {\n\t\t\t\tint a = scanner.next().charAt(0) - 'A';\n\t\t\t\txs[i] = a % 3;\n\t\t\t\tys[i] = a / 3;\n\t\t\t}\n\t\t\tdouble[][][] dp = new double[2][3][3];\n\t\t\tint u = 0;\n\t\t\tdp[u][xs[0]][ys[0]] = 1;\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tfor (int x = 0; x < 3; x++) {\n\t\t\t\t\tfor (int y = 0; y < 3; y++) {\n\t\t\t\t\t\tfor (int[] m : move) {\n\t\t\t\t\t\t\tint nx = x + m[0];\n\t\t\t\t\t\t\tint ny = y + m[1];\n\t\t\t\t\t\t\tif (nx == xs[2] && ny == ys[2] || nx < 0 || 2 < nx\n\t\t\t\t\t\t\t\t\t|| ny < 0 || 2 < ny)\n\t\t\t\t\t\t\t\tdp[1 - u][x][y] += dp[u][x][y] / 4;\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tdp[1 - u][nx][ny] += dp[u][x][y] / 4;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdp[u][x][y] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tu = 1 - u;\n\t\t\t}\n\t\t\tSystem.out.printf(\"%.8f\\n\", dp[u][xs[1]][ys[1]]);\n\t\t}\n\t}\n\n\tint[][] move = { { -1, 0 }, { 0, -1 }, { 0, 1 }, { 1, 0 } };\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport static java.util.Arrays.*;\nimport static java.lang.Math.*;\n\nclass Main {\n\tstatic Scanner sc = new Scanner(System.in);\n\tstatic int n;\n\tstatic char s, t, b;\n\tstatic int[] dx = {-1, 0, 1, 0}, dy = {0, -1, 0, 1};\n\t\n\tpublic static void main(String[] args) {\n\t\twhile (read()) {\n\t\t\tsolve();\n\t\t}\n\t}\n\n\tstatic boolean read() {\n\t\tn = sc.nextInt();\n\t\tif (n == 0) return false;\n\t\t\n\t\ts = sc.next().charAt(0);\n\t\tt = sc.next().charAt(0);\n\t\tb = sc.next().charAt(0);\n\t\t\n\t\treturn true;\n\t}\n\n\tstatic void solve() {\n\t\tdouble[][] rooms = new double[5][5];\n\t\tfor (int i = 0; i < 5; i++) fill(rooms[i], 0);\n\t\tint pos_s = s - 'A', pos_t = t - 'A', pos_b = b - 'A';\n\t\trooms[pos_s / 3 + 1][pos_s % 3 + 1] = 1.0;\n\t\t\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 1; j <= 3; j++) {\n\t\t\t\tfor (int k = 1; k <= 3; k++) {\n\t\t\t\t\tif ((j != (pos_b / 3 + 1)) || (k != (pos_b % 3 + 1))) {\n\t\t\t\t\t\tdouble cur = 0.0;\n\t\t\t\t\t\tfor (int l = 0; l < 4; l++) {\n\t\t\t\t\t\t\tcur = max(cur, rooms[j + dy[l]][k + dx[l]]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trooms[j][k] = cur * 0.25;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tSystem.out.printf(\"%.8f\", rooms[pos_t / 3 + 1][pos_t % 3 + 1]);\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.LinkedList;\nimport java.util.Scanner;\npublic class Main\n{\n\tpublic static void main(String[] args) \n\t{\n\t\tScanner in=new Scanner(System.in);\n\t\tString field[][]=\n\t\t\t{\n\t\t\t\t{\"A\",\"B\",\"C\"},\n\t\t\t\t{\"D\",\"E\",\"F\"},\n\t\t\t\t{\"G\",\"H\",\"I\"}\t\n\t\t\t};\n\t\tint dx[]={1,0,0,-1};\n\t\tint dy[]={0,1,-1,0};\n\t\tfor(;;)\n\t\t{\n\t\t\tint n=in.nextInt();//battery\n\t\t\tif(n==0)\n\t\t\t\treturn;\n\t\t\tString te=in.nextLine();\n\t\t\tString str[]=in.nextLine().split(\" \");\n\t\t\tString s=str[0];//start\n\t\t\tString t=str[1];//charge\n\t\t\tString b=str[2];//no-enter\n\t\t\tdouble ans=1;\n\t\t\tint sh=-1,sw=-1;\n\t\t\tint th=-1,tw=-1;\n\t\t\tdouble dp[][][]=new double[n+1][3][3];\n\t\t\tfor(int i=0;i<3;i++)\n\t\t\t\tfor(int j=0;j<3;j++)\n\t\t\t\t{\n\t\t\t\t\tif(s.equals(field[i][j]))\n\t\t\t\t\t{\n\t\t\t\t\t\tsh=i;\n\t\t\t\t\t\tsw=j;\n\t\t\t\t\t}\n\t\t\t\t\tif(t.equals(field[i][j]))\n\t\t\t\t\t{\n\t\t\t\t\t\tth=i;\n\t\t\t\t\t\ttw=j;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\tdp[n][sh][sw]=1;\n\t\t\tfor(int i=n-1;i>=0;i--)\n\t\t\t\tfor(int j=0;j<3;j++)\n\t\t\t\t\tfor(int k=0;k<3;k++)\t\n\t\t\t\t\t\tfor(int l=0;l<4;l++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tint h=j+dy[l];\n\t\t\t\t\t\t\tint w=k+dx[l];\n\t\t\t\t\t\t\tif(0<=h&&h<3&&0<=w&&w<3&&!field[h][w].equals(b))\n\t\t\t\t\t\t\t\tdp[i][h][w]+=dp[i+1][j][k]/4;\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tdp[i][j][k]+=dp[i+1][j][k]/4;\n\t\t\t\t\t\t}\n\t\t\tSystem.out.printf(\"%.8f\\n\",dp[0][th][tw]);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\tfinal static byte nexts[][] = {\n\t\t\t// 東,西,南,北\n\t\t\t{ 1, -1, 3, -1 },// 0:A\n\t\t\t{ 2, 0, 4, -1 }, // 1:B\n\t\t\t{ -1, 1, 5, -1 },// 2:C\n\t\t\t{ 4, -1, 6, 0 }, // 3:D\n\t\t\t{ 5, 3, 7, 1 }, // 4:E\n\t\t\t{ -1, 4, 8, 2 }, // 5:F\n\t\t\t{ 7, -1, -1, 3 },// 6:G\n\t\t\t{ 8, 6, -1, 4 }, // 7:H\n\t\t\t{ -1, 7, -1, 5 } // 8:I\n\t};\n\tfinal static byte distances[][] = {\n\t\t\t// A,B, C, D, E, F, G, H, I\n\t\t\t{ 0, 1, 2, 1, 2, 3, 2, 3, 4 },// 0:A\n\t\t\t{ 1, 0, 1, 2, 1, 2, 3, 2, 3 },// 1:B\n\t\t\t{ 2, 1, 0, 3, 2, 1, 4, 3, 2 },// 2:C\n\t\t\t{ 1, 2, 3, 0, 1, 2, 1, 2, 3 },// 3:D\n\t\t\t{ 2, 1, 2, 1, 0, 1, 2, 1, 2 },// 4:E\n\t\t\t{ 3, 2, 1, 2, 1, 0, 3, 2, 1 },// 5:F\n\t\t\t{ 2, 3, 4, 1, 2, 3, 0, 1, 2 },// 6:G\n\t\t\t{ 3, 2, 3, 2, 1, 2, 1, 0, 1 },// 7:H\n\t\t\t{ 4, 3, 2, 3, 2, 1, 2, 1, 0 } // 8:I\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic int probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tbyte battery;\n\t\t\tbyte start;\n\n\t\t\tbattery = Byte.parseByte(line);\n\t\t\tif (battery == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1 << battery * 2);\n\t\t\tSystem.out.println(probability * Math.pow(4, -battery));\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, int p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t} else if (distance(current, charger) <= battery) {\n\t\t\tfor (byte n : next(current)) {\n\t\t\t\tif (n > -1) {\n\t\t\t\t\tif (n == storeroom) {\n\t\t\t\t\t\t// clean(current, battery, p);\n\t\t\t\t\t\tclean(n, battery - 2, p >> 4);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclean(n, battery - 1, p >> 2);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\treturn nexts[current];\n\t}\n\n\tstatic byte distance(byte current, byte charger) {\n\t\treturn distances[current][charger];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\ttry {\n\t\t\t//initialize\n\t\t\tdouble dp[][][][] = new double[15][9][9][9];\n\t\t\tfor(int i=0;i<15;i++){\n\t\t\t\tfor(int j=0;j<9;j++){\n\t\t\t\t\tfor(int k=0;k<9;k++){\n\t\t\t\t\t\tfor(int l=0;l<9;l++){\n\t\t\t\t\t\t\tdp[i][j][k][l] = -1.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tString line;\n\t\t\twhile(true){\n\t\t\t\t/* input */\n\t\t\t\tline = br.readLine();\n\n\t\t\t\tint n = Integer.parseInt(line);\n\n\t\t\t\tif(n==0) break;\n\n\t\t\t\tline = br.readLine();\n\n\t\t\t\tchar s = line.split(\" \")[0].charAt(0), t = line.split(\" \")[1].charAt(0), b = line.split(\" \")[2].charAt(0);\n\n\t\t\t\t/* processing */\n\t\t\t\t\n\n\t\t\t\tdouble ans = solve(dp, n,s-'A',t-'A',b-'A');\n\t\t\t\t/* output */\n\t\t\t\tSystem.out.println(ans);\n\t\t\t}\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\n\tpublic static double solve(double[][][][] dp, int n, int s, int t, int b){\n\t\tif(dp[n][s][t][b]>=0) return dp[n][s][t][b];\n\t\tif(n==0){\n\t\t\tif(s==t){\n\t\t\t\tdp[n][s][t][b] = 1.0;\n\t\t\t\treturn 1.0;\n\t\t\t} else {\n\t\t\t\tdp[n][s][t][b] = 0.0;\n\t\t\t\treturn 0.0;\n\t\t\t}\n\t\t} else {\n\t\t\tdouble ret = 0;\n\t\t\tif(dp[n-1][s>2&&b!=s-3?s-3:s][t][b]>=0){\n\t\t\t\tret += 0.25*dp[n-1][s>2&&b!=s-3?s-3:s][t][b];\n\t\t\t} else {\n\t\t\t\tdp[n-1][s>2&&b!=s-3?s-3:s][t][b] = solve(dp,n-1,s>2&&b!=s-3?s-3:s,t,b); \n\t\t\t\tret += 0.25*dp[n-1][s>2&&b!=s-3?s-3:s][t][b];\n\t\t\t}\n\t\t\tif(dp[n-1][s%3!=2&&b!=s+1?s+1:s][t][b]>=0){\n\t\t\t\tret += 0.25*dp[n-1][s%3!=2&&b!=s+1?s+1:s][t][b];\n\t\t\t} else {\n\t\t\t\tdp[n-1][s%3!=2&&b!=s+1?s+1:s][t][b] = solve(dp,n-1,s%3!=2&&b!=s+1?s+1:s,t,b); \n\t\t\t\tret += 0.25*dp[n-1][s%3!=2&&b!=s+1?s+1:s][t][b];\n\t\t\t}\n\t\t\tif(dp[n-1][s<6&&b!=s+3?s+3:s][t][b]>=0){\n\t\t\t\tret += 0.25*dp[n-1][s<6&&b!=s+3?s+3:s][t][b];\n\t\t\t} else {\n\t\t\t\tdp[n-1][s<6&&b!=s+3?s+3:s][t][b] = solve(dp,n-1,s<6&&b!=s+3?s+3:s,t,b);\n\t\t\t\tret += 0.25*dp[n-1][s<6&&b!=s+3?s+3:s][t][b];\n\t\t\t}\n\t\t\tif(dp[n-1][s%3!=0&&b!=s-1?s-1:s][t][b]>=0){\n\t\t\t\tret += 0.25*dp[n-1][s%3!=0&&b!=s-1?s-1:s][t][b];\n\t\t\t} else {\n\t\t\t\tdp[n-1][s%3!=0&&b!=s-1?s-1:s][t][b] =solve(dp,n-1,s%3!=0&&b!=s-1?s-1:s,t,b);\n\t\t\t\tret += 0.25*dp[n-1][s%3!=0&&b!=s-1?s-1:s][t][b];\n\t\t\t}\n\t\t\t\n\t\t\tdp[n][s][t][b] = ret;\n\t\t\treturn ret;\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\tfinal static byte nexts[][] = {\n\t\t\t// 東,西,南,北\n\t\t\t{ 1, -1, 3, -1 },// 0:A\n\t\t\t{ 2, 0, 4, -1 }, // 1:B\n\t\t\t{ -1, 1, 5, -1 },// 2:C\n\t\t\t{ 4, -1, 6, 0 }, // 3:D\n\t\t\t{ 5, 3, 7, 1 }, // 4:E\n\t\t\t{ -1, 4, 8, 2 }, // 5:F\n\t\t\t{ 7, -1, -1, 3 },// 6:G\n\t\t\t{ 8, 6, -1, 4 }, // 7:H\n\t\t\t{ -1, 7, -1, 5 } // 8:I\n\t};\n\tfinal static byte distances[][] = {\n\t\t\t// A,B, C, D, E, F, G, H, I\n\t\t\t{ 0, 1, 2, 1, 2, 3, 2, 3, 4 },// 0:A\n\t\t\t{ 1, 0, 1, 2, 1, 2, 3, 2, 3 },// 1:B\n\t\t\t{ 2, 1, 0, 3, 2, 1, 4, 3, 2 },// 2:C\n\t\t\t{ 1, 2, 3, 0, 1, 2, 1, 2, 3 },// 3:D\n\t\t\t{ 2, 1, 2, 1, 0, 1, 2, 1, 2 },// 4:E\n\t\t\t{ 3, 2, 1, 2, 1, 0, 3, 2, 1 },// 5:F\n\t\t\t{ 2, 3, 4, 1, 2, 3, 0, 1, 2 },// 6:G\n\t\t\t{ 3, 2, 3, 2, 1, 2, 1, 0, 1 },// 7:H\n\t\t\t{ 4, 3, 2, 3, 2, 1, 2, 1, 0 } // 8:I\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic int probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tbyte battery;\n\t\t\tbyte start;\n\n\t\t\tbattery = Byte.parseByte(line);\n\t\t\tif (battery == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1 << battery * 2);\n\t\t\tSystem.out.println(probability * Math.pow(4, -battery));\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, int p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t} else if (distance(current, charger) <= battery) {\n\t\t\tbattery--;\n\t\t\tp >>= 2;\n\t\t\tfor (byte n : next(current)) {\n\t\t\t\tif (n < 0 || n == storeroom) {\n\t\t\t\t\tclean(current, battery, p);\n\t\t\t\t} else {\n\t\t\t\t\tclean(n, battery, p);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\treturn nexts[current];\n\t}\n\n\tstatic byte distance(byte current, byte charger) {\n\t\treturn distances[current][charger];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.text.DecimalFormat;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\tstatic final DecimalFormat df = new DecimalFormat(\"0.0000000000\");\n\tstatic final int A = 0, B = 1, C = 2, D = 3, E = 4, F = 5, G = 6, H = 7,\n\t\t\tI = 8;\n\tstatic final int[][] rooms = {\n\t\t\t//\n\t\t\t{ A, D, B, A }, { B, E, C, A }, { C, F, C, B },//\n\t\t\t{ A, G, E, D }, { B, H, F, D }, { C, I, F, E },//\n\t\t\t{ D, G, H, G }, { E, H, I, G }, { F, I, I, H } };\n\n\tpublic static void main(String[] args) {\n\t\tfinal double pow = Math.pow(4, 15);\n\t\tScanner in = new Scanner(System.in);\n\t\tint n;\n\t\tint[] now = new int[9];\n\t\tint[] next = new int[9];\n\t\twhile ((n = in.nextInt()) > 0) {\n\t\t\tArrays.fill(now, 0);\n\t\t\tArrays.fill(next, 0);\n\t\t\tint s = in.next().charAt(0) - 'A';\n\t\t\tnow[s] = 1;\n\t\t\tint t = in.next().charAt(0) - 'A';// 充電器\n\t\t\tint b = in.next().charAt(0) - 'A';// 入れない\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tfor (int room = 0; room < 9; room++) {\n\t\t\t\t\tint val = now[room];\n\t\t\t\t\tfor (int arrow = 0; arrow < 4; arrow++) {\n\t\t\t\t\t\tif (rooms[room][arrow] != b)\n\t\t\t\t\t\t\tnext[rooms[room][arrow]] += val;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tnext[room] += val;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tint[] memo = now;\n\t\t\t\tnow = next;\n\t\t\t\tnext = memo;\n\t\t\t\tArrays.fill(next, 0);\n\t\t\t}\n\t\t\tSystem.out.println(df.format(now[t] / Math.pow(4, n)));\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\n\nimport java.util.*;\nimport java.math.*;\n\nimport static java.lang.Math.*;\nimport static java.util.Arrays.*;\nimport static java.util.Collections.*;\nimport static java.math.BigInteger.*;\nimport static java.lang.Character.*;\n\nclass AOJ1020 {\n\tint[] di = { +1, -1, +3, -3 };\n\n\tpublic void run() {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tif (n == 0)\n\t\t\t\treturn;\n\t\t\tint s = sc.next().charAt(0) - 'A';\n\t\t\tint t = sc.next().charAt(0) - 'A';\n\t\t\tint b = sc.next().charAt(0) - 'A';\n\n\t\t\tdouble[] prob = new double[9];\n\t\t\tdouble[][] move = new double[9][9];\n\t\t\tfor (int i = 0; i < 9; i++)\n\t\t\t\tfor (int d = 0; d < 4; d++)\n\t\t\t\t\tif (isValidMove(i, d)) {\n\t\t\t\t\t\tint j = i == b ? i : i + di[d];\n\t\t\t\t\t\tmove[j][i] = .25;\n\t\t\t\t\t}\n\t\t\tprob[s] = 1.;\n\t\t\tfor (int k = 0; k < n; k++) {\n\t\t\t\tdouble[] np = new double[9];\n\t\t\t\tfor (int i = 0; i < 9; i++)\n\t\t\t\t\tfor (int j = 0; j < 9; j++)\n\t\t\t\t\t\tnp[i] += move[i][j] * prob[j];\n\t\t\t\tprob = np;\n\t\t\t}\n\t\t\tSystem.out.println(prob[t]);\n\t\t}\n\t}\n\n\tboolean isValidMove(int i, int d) {\n\t\tswitch (d) {\n\t\tcase 0:\n\t\t\treturn i % 3 < 2;\n\t\tcase 1:\n\t\t\treturn i % 3 > 0;\n\t\tcase 2:\n\t\t\treturn i < 6;\n\t\tcase 3:\n\t\t\treturn i > 2;\n\t\t}\n\t\treturn false;\n\t}\n}\n\npublic class Main {\n\tpublic static void main(String... args) {\n\t\tnew AOJ1020().run();\n\t}\n\n\tpublic static void debug(Object... os) {\n\t\tSystem.err.println(java.util.Arrays.deepToString(os));\n\t}\n}\n\nclass Scanner {\n\tfinal java.util.Scanner sc;\n\n\tpublic double nextDouble() {\n\t\treturn Double.parseDouble(sc.next());\n\t}\n\n\tpublic Scanner(java.io.InputStream is) {\n\t\tthis.sc = new java.util.Scanner(is);\n\t}\n\n\tpublic boolean hasNext() {\n\t\treturn sc.hasNext();\n\t}\n\n\tpublic String next() {\n\t\treturn sc.next();\n\t}\n\n\tpublic int nextInt() {\n\t\treturn Integer.parseInt(sc.next());\n\t}\n\n\tpublic String nextLine() {\n\t\treturn sc.nextLine();\n\t}\n\n\tpublic long nextLong() {\n\t\treturn Long.parseLong(sc.next());\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\tfinal static byte nexts[][] = {\n\t\t\t// 東,西,南,北\n\t\t\t{ 1, -1, 3, -1 },// 0:A\n\t\t\t{ 2, 0, 4, -1 }, // 1:B\n\t\t\t{ -1, 1, 5, -1 },// 2:C\n\t\t\t{ 4, -1, 6, 0 }, // 3:D\n\t\t\t{ 5, 3, 7, 1 }, // 4:E\n\t\t\t{ -1, 4, 8, 2 }, // 5:F\n\t\t\t{ 7, -1, -1, 3 },// 6:G\n\t\t\t{ 8, 6, -1, 4 }, // 7:H\n\t\t\t{ -1, 7, -1, 5 } // 8:I\n\t};\n\tfinal static byte distances[][] = {\n\t\t\t// A,B, C, D, E, F, G, H, I\n\t\t\t{ 0, 1, 2, 1, 2, 3, 2, 3, 4 },// 0:A\n\t\t\t{ 1, 0, 1, 2, 1, 2, 3, 2, 3 },// 1:B\n\t\t\t{ 2, 1, 0, 3, 2, 1, 4, 3, 2 },// 2:C\n\t\t\t{ 1, 2, 3, 0, 1, 2, 1, 2, 3 },// 3:D\n\t\t\t{ 2, 1, 2, 1, 0, 1, 2, 1, 2 },// 4:E\n\t\t\t{ 3, 2, 1, 2, 1, 0, 3, 2, 1 },// 5:F\n\t\t\t{ 2, 3, 4, 1, 2, 3, 0, 1, 2 },// 6:G\n\t\t\t{ 3, 2, 3, 2, 1, 2, 1, 0, 1 },// 7:H\n\t\t\t{ 4, 3, 2, 3, 2, 1, 2, 1, 0 } // 8:I\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic int probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tbyte battery;\n\t\t\tbyte start;\n\n\t\t\tbattery = Byte.parseByte(line);\n\t\t\tif (battery == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1 << battery * 2);\n\t\t\tSystem.out.println(probability * Math.pow(4, -battery));\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, int p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t} else if (distance(current, charger) <= battery) {\n\t\t\tfor (byte n : next(current)) {\n\t\t\t\tif (n > -1) {\n\t\t\t\t\tif (n == storeroom) {\n\t\t\t\t\t\t// clean(current, battery, p);\n\t\t\t\t\t\tclean(n, battery - 1, p >> 2);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclean(n, battery - 1, p >> 2);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\treturn nexts[current];\n\t}\n\n\tstatic byte distance(byte current, byte charger) {\n\t\treturn distances[current][charger];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n//import java.text.*;\n\nclass Main{\n\n    public static void main(String[] args){\n\tScanner in = new Scanner(System.in);\n\n\tint n;\n\tString st,ba,sto;\n\tint[] dx = {0,1,0,-1};\n\tint[] dy = {1,0,-1,0};\n\tint[][] map = {{0,0,0},\n                       {0,0,0},\n                       {0,0,0}};\n\n\twhile(true){\n\t    n = in.nextInt();\n\t    Double[][][] dp = new Double[15][4][4];\n\t    for(int i=0;i<15;i++)for(int j=0;j<4;j++)for(int k=0;k<4;k++)dp[i][j][k]=0.0;\n\t    if(n == 0)break;\n\t    st = in.next();\n\t    ba = in.next();\n\t    sto = in.next();\n\t    map[y11(st)][x11(st)]=1;//X^[g\n\t    map[y11(ba)][x11(ba)]=9;//[d\n\t    map[y11(sto)][x11(sto)]=8;//qÉ\n\n\t    int nx,ny;\n\t \t   \n\t    dp[n][y11(st)][x11(st)]=1.0;\n\n\t    while(true){\n\t\tif(n == 0)break;\n\n\t\t\n\t\tfor(int t=0;t<2;t++){\n\t\t    for(int g =0 ;g<2;g++){\n\t\t\tfor(int i=0;i<4;i++){\n\t\t\t    nx = g+dx[i];\n\t\t\t    ny = t+dy[i];\t\t    \n\t\t\t    if(nx>2 || ny>2 ||nx<0 || ny<0)continue;\n\t\t\t    if(nx == x11(sto) && ny == y11(sto)){nx = g;\n\t\t\t\tny = t;\n\t\t\t    }\n\t\t\t    dp[n-1][ny][nx] += dp[n][t][g]/4.0;\t\t    \n\t\t\t}\n\t\t    }\n\t\t}\n\t\tn--;\n\n\t    }\n \n\t    // ----------------DEBUG--------------//\n\t    /*   \n\t\tfor(int g=0;g<3;g++){\n\t\t    for(int f=0;f<3;f++){\n\t\t\tSystem.out.print(dp[0][g][f] + \" \");\n\t\t    }\n\tSystem.out.printf(\"\\n\");\n\t\t}\n\t\n\t\t*/\n\t    //----------------DEBUG---------------//\n\t    //   DecimalFormat dc = new DecimalFormat();\n\t \n\t    System.out.println(dp[0][y11(ba)][x11(ba)]);\n\n\n\t}\n\n\n\n\n    }\n\n    public static int y11(String s){\n\tif(s.equals(\"A\"))return 0;\n\tif(s.equals(\"B\"))return 0;\n\tif(s.equals(\"C\"))return 0;\n\tif(s.equals(\"D\"))return 1;\n\tif(s.equals(\"E\"))return 1;\n\tif(s.equals(\"F\"))return 1;\n\tif(s.equals(\"G\"))return 2;\n\tif(s.equals(\"H\"))return 2;\n\tif(s.equals(\"I\"))return 2;\n\n\treturn 9; //±êªÈ¢Æ½©returnµëIÆ¢¤G[ªÅÄ­éÌÅKÉ9ðÔ·æ¤ÉµÆ¢½@x11Ìreturn 9;à¯¶R\n    }\n    public static int x11(String s){\n\tif(s.equals(\"A\"))return 0;\n\tif(s.equals(\"B\"))return 1;\n\tif(s.equals(\"C\"))return 2;\n\tif(s.equals(\"D\"))return 0;\n\tif(s.equals(\"E\"))return 1;\n\tif(s.equals(\"F\"))return 2;\n\tif(s.equals(\"G\"))return 0;\n\tif(s.equals(\"H\"))return 1;\n\tif(s.equals(\"I\"))return 2;\n\n\treturn 9;\n    }\n\n\n\n}\n\n\n\n/*@Yê½Ì´êpðà\n\nQ:3d[vÌÆ±ÈÉµÄñÌH\nA:®SÌðÝÄ(n-i)ñ(i=0,1,EEE,n Å n=0Ìnñ®¢½Ê n=nÌ1ñ®¢½Ê)ÌÊð¾µÄé\nµ¢m¦Å®­©ç1ñ®¢½ç4ÅêÎ¢¢\n\nàµ±êæñÅàí©çÈ¢pÈçvOÌDEBUGð\\¦³¹Ä®«ðmFµÄÝéÆ¢¢\nn=0ÆÈÁÄ¢é©çwè³ê½ñ®¢½Êð\\¦·éæ¤ÉÈÁÄ¢é\n\n*/"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\t// 東,西,南,北\n\tfinal static byte nexts[][] = {//\n\t{ 1, -1, 3, -1 },// 0\n\t\t\t{ 2, 0, 4, -1 },// 1\n\t\t\t{ -1, 1, 5, -1 },// 2\n\t\t\t{ 4, -1, 6, 0 },// 3\n\t\t\t{ 5, 3, 7, 1 },// 4\n\t\t\t{ -1, 4, 8, 2 },// 5\n\t\t\t{ 7, -1, -1, 3 },// 6\n\t\t\t{ 8, 6, -1, 4 },// 7\n\t\t\t{ -1, 7, -1, 5 },// 8\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic double probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\tbyte battery;\n\t\tbyte start;\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tif ((battery = Byte.parseByte(line)) == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1);\n\t\t\tSystem.out.println(probability);\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, double p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t\treturn;\n\t\t} else {\n\t\t\tfor (byte n : next(current)) {\n\t\t\t\tif (n < 0 || n == storeroom) {\n\t\t\t\t\tclean(current, battery - 1, p / 4);\n\t\t\t\t} else {\n\t\t\t\t\tclean(n, battery - 1, p / 4);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\tbyte[] result = null;\n\n\t\tswitch (current) {\n\t\tcase 0:\n\t\t\tresult = nexts[0];\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tresult = nexts[1];\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tresult = nexts[2];\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tresult = nexts[3];\n\t\t\tbreak;\n\t\tcase 4:\n\t\t\tresult = nexts[4];\n\t\t\tbreak;\n\t\tcase 5:\n\t\t\tresult = nexts[5];\n\t\t\tbreak;\n\t\tcase 6:\n\t\t\tresult = nexts[6];\n\t\t\tbreak;\n\t\tcase 7:\n\t\t\tresult = nexts[7];\n\t\t\tbreak;\n\t\tcase 8:\n\t\t\tresult = nexts[8];\n\t\t\tbreak;\n\t\t}\n\t\treturn result;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.*;\nimport java.math.*;\npublic class Main{\n        public static void main(String[] arg) throws IOException {\n                BufferedReader in = new BufferedReader(new InputStreamReader(System.in));\n                String[] ia; \n\n                while(true){\n                        n = Integer.parseInt(in.readLine());\n                        if(n == 0){ \n                                break;\n                        }   \n                        ia = in.readLine().split(\" \");\n                        s = ia[0].charAt(0) - 'A';\n                        t = ia[1].charAt(0) - 'A';\n                        b = ia[2].charAt(0) - 'A';\n                        e = 0;\n                        f = 0;\n                        x = new Integer[9][16][2];\n                        check(n, s); \n                        System.out.printf(\"%.8f\\n\",(double) x[s][n][0]/x[s][n][1]);\n                }   \n        }   \n        static int n;\n        static int s;\n        static int t;\n        static int b;\n        static Integer[][][] x;\n        static int e;\n        static int f;\n        static class pair{\n                int a;\n                int b;\n                pair(Integer s, Integer t){ \n                        a = s;\n                        b = t;\n                }   \n                pair(int s, int t){ \n                        a = s;\n                        b = t;\n                }   \n                void add(pair s){ \n                        this.a += s.a;\n                        this.b += s.b;\n                }\n        }\n        static pair check(int g, int h){\n                if(x[h][g][0] != null){\n                        return new pair(x[h][g][0],x[h][g][1]);\n                }\n                pair p = new pair(0,0);\n                if(g == 0){\n                        p.b++;\n                        if(h == t){\n                                p.a++;\n                        }\n                } else {\n                        if(2 < h){\n                                if(h-3 != b){\n                                        p.add(check(g-1, h-3));\n                                } else {\n                                        p.add(check(g-1, h));\n                                }\n                        } else {\n                                p.add(check(g-1, h));\n                        }\n                        if(0 < h%3){\n                                if(h-1 != b){\n                                        p.add(check(g-1, h-1));\n                                } else {\n                                        p.add(check(g-1, h));\n                                }\n                        } else {\n                                p.add(check(g-1, h));\n                        }\n                        if(h%3 < 2){\n                                if(h+1 != b){\n                                        p.add(check(g-1, h+1));\n                                } else {\n                                        p.add(check(g-1, h));\n                                }\n                        } else {\n                                p.add(check(g-1, h));\n                        }\n                        if(h < 6){\n                                if(h+3 != b){\n                                        p.add(check(g-1, h+3));\n                                } else {\n                                        p.add(check(g-1, h));\n                                }\n                        } else {\n                                p.add(check(g-1, h));\n                        }\n                }\n                x[h][g][0] = p.a;\n                x[h][g][1] = p.b;\n                return p;\n        }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\tfinal static byte nexts[][] = {\n\t\t\t// 東,西,南,北\n\t\t\t{ 1, -1, 3, -1 },// 0:A\n\t\t\t{ 2, 0, 4, -1 }, // 1:B\n\t\t\t{ -1, 1, 5, -1 },// 2:C\n\t\t\t{ 4, -1, 6, 0 }, // 3:D\n\t\t\t{ 5, 3, 7, 1 }, // 4:E\n\t\t\t{ -1, 4, 8, 2 }, // 5:F\n\t\t\t{ 7, -1, -1, 3 },// 6:G\n\t\t\t{ 8, 6, -1, 4 }, // 7:H\n\t\t\t{ -1, 7, -1, 5 } // 8:I\n\t};\n\tfinal static byte distances[][] = {\n\t\t\t// A,B, C, D, E, F, G, H, I\n\t\t\t{ 0, 1, 2, 1, 2, 3, 2, 3, 4 },// 0:A\n\t\t\t{ 1, 0, 1, 2, 1, 2, 3, 2, 3 },// 1:B\n\t\t\t{ 2, 1, 0, 3, 2, 1, 4, 3, 2 },// 2:C\n\t\t\t{ 1, 2, 3, 0, 1, 2, 1, 2, 3 },// 3:D\n\t\t\t{ 2, 1, 2, 1, 0, 1, 2, 1, 2 },// 4:E\n\t\t\t{ 3, 2, 1, 2, 1, 0, 3, 2, 1 },// 5:F\n\t\t\t{ 2, 3, 4, 1, 2, 3, 0, 1, 2 },// 6:G\n\t\t\t{ 3, 2, 3, 2, 1, 2, 1, 0, 1 },// 7:H\n\t\t\t{ 4, 3, 2, 3, 2, 1, 2, 1, 0 } // 8:I\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic int probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tbyte battery;\n\t\t\tbyte start;\n\n\t\t\tbattery = Byte.parseByte(line);\n\t\t\tif (battery == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1 << battery * 2);\n\t\t\tSystem.out.println(String.format(\"%.8f\",\n\t\t\t\t\tprobability * Math.pow(4, -battery)));\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, int p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif (distance(current, charger) <= battery) {\n\t\t\tfor (byte n1 : next(current)) {\n\t\t\t\tif (n1 < 0 || n1 == storeroom) {\n\t\t\t\t\tfor (byte n2 : next(current)) {\n\t\t\t\t\t\tif (n2 != n1 && n2 != storeroom)\n\t\t\t\t\t\t\tclean(n2, battery - 2, (p >> 2) - (p >> 4));\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tclean(n1, battery - 1, p >> 2);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\treturn nexts[current];\n\t}\n\n\tstatic byte distance(byte current, byte charger) {\n\t\treturn distances[current][charger];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\tfinal static byte nexts[][] = {\n\t\t\t// 東,西,南,北\n\t\t\t{ 1, -1, 3, -1 },// 0:A\n\t\t\t{ 2, 0, 4, -1 }, // 1:B\n\t\t\t{ -1, 1, 5, -1 },// 2:C\n\t\t\t{ 4, -1, 6, 0 }, // 3:D\n\t\t\t{ 5, 3, 7, 1 }, // 4:E\n\t\t\t{ -1, 4, 8, 2 }, // 5:F\n\t\t\t{ 7, -1, -1, 3 },// 6:G\n\t\t\t{ 8, 6, -1, 4 }, // 7:H\n\t\t\t{ -1, 7, -1, 5 } // 8:I\n\t};\n\tfinal static byte distances[][] = {\n\t\t\t// A,B, C, D, E, F, G, H, I\n\t\t\t{ 0, 1, 2, 1, 2, 3, 2, 3, 4 },// 0:A\n\t\t\t{ 1, 0, 1, 2, 1, 2, 3, 2, 3 },// 1:B\n\t\t\t{ 2, 1, 0, 3, 2, 1, 4, 3, 2 },// 2:C\n\t\t\t{ 1, 2, 3, 0, 1, 2, 1, 2, 3 },// 3:D\n\t\t\t{ 2, 1, 2, 1, 0, 1, 2, 1, 2 },// 4:E\n\t\t\t{ 3, 2, 1, 2, 1, 0, 3, 2, 1 },// 5:F\n\t\t\t{ 2, 3, 4, 1, 2, 3, 0, 1, 2 },// 6:G\n\t\t\t{ 3, 2, 3, 2, 1, 2, 1, 0, 1 },// 7:H\n\t\t\t{ 4, 3, 2, 3, 2, 1, 2, 1, 0 } // 8:I\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic int probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tbyte battery;\n\t\t\tbyte start;\n\n\t\t\tbattery = Byte.parseByte(line);\n\t\t\tif (battery == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1 << battery * 2);\n\t\t\tSystem.out.println(String.format(\"%.8f\",\n\t\t\t\t\tprobability * Math.pow(4, -battery)));\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, int p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif (distance(current, charger) <= battery) {\n\t\t\tbyte c1, c2;\n\t\t\tc1 = c2 = current;\n\t\t\tfor (byte n1 : next(c1)) {\n\t\t\t\tif (n1 < 0 || n1 == storeroom) {\n\t\t\t\t\tfor (byte n2 : next(c2)) {\n\t\t\t\t\t\tif (n2 != n1)\n\t\t\t\t\t\t\tclean(n2, battery - 2, (p >> 2) - (p >> 4));\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tclean(n1, battery - 1, p >> 2);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\treturn nexts[current];\n\t}\n\n\tstatic byte distance(byte current, byte charger) {\n\t\treturn distances[current][charger];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\n\tstatic Scanner sc = new Scanner(System.in);\n\tstatic int[] DR = { 1, 0, -1, 0 };\n\tstatic int[] DC = { 0, 1, 0, -1 };\n\n\tpublic static void main(String[] args) throws Exception {\n\t\twhile (true) {\n\t\t\tint N = sc.nextInt();\n\t\t\tif (N == 0) break;\n\t\t\tint s = sc.next().charAt(0) - 'A';\n\t\t\tint t = sc.next().charAt(0) - 'A';\n\t\t\tint b = sc.next().charAt(0) - 'A';\n\t\t\tint r = s / 3;\n\t\t\tint c = s % 3;\n\t\t\tdouble[][] prob = new double[3][3];\n\t\t\tprob[r][c] = 1;\n\t\t\tfor (int i = 0; i < N; ++i) {\n\t\t\t\tdouble[][] next = new double[3][3];\n\t\t\t\tfor (int j = 0; j < 3; ++j) {\n\t\t\t\t\tfor (int k = 0; k < 3; ++k) {\n\t\t\t\t\t\tfor (int l = 0; l < 4; ++l) {\n\t\t\t\t\t\t\tint nr = j + DR[l];\n\t\t\t\t\t\t\tint nc = k + DC[l];\n\t\t\t\t\t\t\tif (nr < 0 || 3 <= nr || nc < 0 || 3 <= nc || nr * 3 + nc == b) {\n\t\t\t\t\t\t\t\tnext[j][k] += prob[j][k] / 4;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnext[nr][nc] += prob[j][k] / 4;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tprob = next;\n\t\t\t}\n\t\t\tSystem.out.printf(\"%.9f\\n\", prob[t / 3][t % 3]);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\tfinal static byte nexts[][] = {\n\t\t\t// 東,西,南,北\n\t\t\t{ 1, -1, 3, -1 },// 0:A\n\t\t\t{ 2, 0, 4, -1 }, // 1:B\n\t\t\t{ -1, 1, 5, -1 },// 2:C\n\t\t\t{ 4, -1, 6, 0 }, // 3:D\n\t\t\t{ 5, 3, 7, 1 }, // 4:E\n\t\t\t{ -1, 4, 8, 2 }, // 5:F\n\t\t\t{ 7, -1, -1, 3 },// 6:G\n\t\t\t{ 8, 6, -1, 4 }, // 7:H\n\t\t\t{ -1, 7, -1, 5 } // 8:I\n\t};\n\tfinal static byte distances[][] = {\n\t\t\t// A,B, C, D, E, F, G, H, I\n\t\t\t{ 0, 1, 2, 1, 2, 3, 2, 3, 4 },// 0:A\n\t\t\t{ 1, 0, 1, 2, 1, 2, 3, 2, 3 },// 1:B\n\t\t\t{ 2, 1, 0, 3, 2, 1, 4, 3, 2 },// 2:C\n\t\t\t{ 1, 2, 3, 0, 1, 2, 1, 2, 3 },// 3:D\n\t\t\t{ 2, 1, 2, 1, 0, 1, 2, 1, 2 },// 4:E\n\t\t\t{ 3, 2, 1, 2, 1, 0, 3, 2, 1 },// 5:F\n\t\t\t{ 2, 3, 4, 1, 2, 3, 0, 1, 2 },// 6:G\n\t\t\t{ 3, 2, 3, 2, 1, 2, 1, 0, 1 },// 7:H\n\t\t\t{ 4, 3, 2, 3, 2, 1, 2, 1, 0 } // 8:I\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic int probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tbyte battery;\n\t\t\tbyte start;\n\n\t\t\tbattery = Byte.parseByte(line);\n\t\t\tif (battery == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1 << battery * 2);\n\t\t\tSystem.out.println(probability * Math.pow(4, -battery));\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, int p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t} else if (distance(current, charger) <= battery) {\n\t\t\tfor (byte n : next(current)) {\n\t\t\t\tif (n > -1) {\n\t\t\t\t\tif (n == storeroom) {\n\t\t\t\t\t\t// clean(current, battery, p);\n\t\t\t\t\t\tclean(n, battery - 2, p >> 10);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclean(n, battery - 1, p >> 2);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\treturn nexts[current];\n\t}\n\n\tstatic byte distance(byte current, byte charger) {\n\t\treturn distances[current][charger];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\t// 東,西,南,北\n\tfinal static byte nexts[][] = {//\n\t{ 1, -1, 3, -1 },// 0\n\t\t\t{ 2, 0, 4, -1 },// 1\n\t\t\t{ -1, 1, 5, -1 },// 2\n\t\t\t{ 4, -1, 6, 0 },// 3\n\t\t\t{ 5, 3, 7, 1 },// 4\n\t\t\t{ -1, 4, 8, 2 },// 5\n\t\t\t{ 7, -1, -1, 3 },// 6\n\t\t\t{ 8, 6, -1, 4 },// 7\n\t\t\t{ -1, 7, -1, 5 },// 8\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic double probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\tbyte battery;\n\t\tbyte start;\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tif ((battery = Byte.parseByte(line)) == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1);\n\t\t\tSystem.out.println(probability);\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, double p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t\treturn;\n\t\t} else {\n\t\t\tbattery--;\n\t\t\tp /= 4;\n\t\t\tfor (byte n : next(current)) {\n\t\t\t\tif (n < 0 || n == storeroom) {\n\t\t\t\t\tclean(current, battery, p);\n\t\t\t\t} else {\n\t\t\t\t\tclean(n, battery, p);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\treturn nexts[current];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\npublic class Main{\n\tstatic int n;\n\tstatic int gx,ex;\n\tstatic int gy,ey;\n\tpublic static void main(String[] args) { \n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tn =sc.nextInt();\t\n\t\t\tif(n==0)break;\n\t\t\tString start=sc.next();\n\t\t\tString end=sc.next();\n\t\t\tString not=sc.next();\n\t\t\tint room[][][]=new int[n][2][2];\n\t\t\tint x=0,y=0;\n\t\t\tif(start.equals(\"B\"))\n\t\t\t\tx=1;\n\t\t\telse if(start.equals(\"C\"))\n\t\t\t\tx=2;\n\t\t\telse if(start.equals(\"D\"))\n\t\t\t\tx=1;\n\t\t\telse if(start.equals(\"E\")){\n\t\t\t\tx=1;y=1;\n\t\t\t}else if(start.equals(\"F\")){\n\t\t\t\tx=1;y=2;\n\t\t\t}else if(start.equals(\"G\"))\n\t\t\t\tx=2;\n\t\t\telse if(start.equals(\"H\")){\n\t\t\t\tx=2;y=1;\n\t\t\t}else if(start.equals(\"I\")){\n\t\t\t\tx=2;y=2;\n\t\t\t}\n\t\t\tgx=0;gy=0;\n\t\t\tif(end.equals(\"B\"))\n\t\t\t\tgx=1;\n\t\t\telse if(end.equals(\"C\"))\n\t\t\t\tgx=2;\n\t\t\telse if(end.equals(\"D\"))\n\t\t\t\tgx=1;\n\t\t\telse if(end.equals(\"E\")){\n\t\t\t\tgx=1;gy=1;\n\t\t\t}else if(end.equals(\"F\")){\n\t\t\t\tgx=1;gy=2;\n\t\t\t}else if(end.equals(\"G\"))\n\t\t\t\tgx=2;\n\t\t\telse if(end.equals(\"H\")){\n\t\t\t\tgx=2;gy=1;\n\t\t\t}else if(end.equals(\"I\")){\n\t\t\t\tgx=2;gy=2;\n\t\t\t}\n\t\t\tex=0;ey=0;\n\t\t\tif(not.equals(\"B\"))\n\t\t\t\tex=1;\n\t\t\telse if(not.equals(\"C\"))\n\t\t\t\tex=2;\n\t\t\telse if(not.equals(\"D\"))\n\t\t\t\tex=1;\n\t\t\telse if(not.equals(\"E\")){\n\t\t\t\tex=1;ey=1;\n\t\t\t}else if(not.equals(\"F\")){\n\t\t\t\tex=1;ey=2;\n\t\t\t}else if(not.equals(\"G\"))\n\t\t\t\tex=2;\n\t\t\telse if(not.equals(\"H\")){\n\t\t\t\tex=2;ey=1;\n\t\t\t}else if(not.equals(\"I\")){\n\t\t\t\tex=2;ey=2;\n\t\t\t}\n\t\t\tSystem.out.println(gx+\" \"+gy);\n\t\t\tSystem.out.println((double)dfs(x,y,0)/Math.pow(4, n));\n//\t\t\tMath.pow(4, n)\n\t\t\t\n\t\t}\n\t}\n\tstatic int sx[]={1,0,-1,0};\n\tstatic int sy[]={0,1,0,-1};\n\tstatic int dfs(int x, int y, int battery){\n\t\tSystem.out.println(x+\" \"+y+\" \"+battery);\n\t\tint result = 0;\n\t\tif(battery==n){\n\t\t\tif(gx==x&&gy==y)return 1;\n\t\t\telse return 0;\n\t\t}\n\t\tfor(int i=0;i<4;i++){\n\t\t\tint nx=x+sx[i];int ny=y+sy[i];\n\t\t\tif(nx<0||nx>2||ny<0||ny>2||(nx==ex&&ny==ey))result+=dfs(x,y,battery+1);\n\t\t\telse result+=dfs(nx,ny,battery+1);\n\t\t}\n\t\treturn result;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.math.*;\nimport java.awt.geom.*;\nimport java.io.*;\n      \n      \npublic class Main {\n\tstatic int[] vx = new int[]{0,1,0,-1};\n\tstatic int[] vy = new int[]{1,0,-1,0};\n\tstatic int[] Y  = new int[]{0,0,0,1,1,1,2,2,2};\n\tstatic int[] X  = new int[]{0,1,2,0,1,2,0,1,2};\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tchar s = sc.next().charAt(0);\n\t\t\tint S = s - 'A';\n\t\t\tchar t = sc.next().charAt(0);\n\t\t\tint T = t - 'A';\n\t\t\tchar b = sc.next().charAt(0);\n\t\t\tint B = b - 'A';\n\t\t\tdouble[][][] dp = new double[n+1][3][3];\n\t\t\tdp[0][Y[S]][X[S]] = 1.0;\n\t\t\tfor(int i = 0; i < n; i++) {\n\t\t\t\tfor(int j = 0; j < 3; j++) {\n\t\t\t\t\tfor(int k = 0; k < 3; k++) {\n\t\t\t\t\t\tfor(int l = 0; l < 4; l++) {\n\t\t\t\t\t\t\tint ty = j + vy[l];\n\t\t\t\t\t\t\tint tx = k + vx[l];\n\t\t\t\t\t\t\tif(ty < 0 || tx < 0 || tx >= 3 || ty >= 3 || (ty == Y[B] && tx == X[B])) {\n\t\t\t\t\t\t\t\tty = j;\n\t\t\t\t\t\t\t\ttx = k;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdp[i+1][ty][tx] += dp[i][j][k] / 4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.printf(\"%.25f\",dp[n][Y[T]][X[T]]);\n\t\t\t\n\t\t}\n\t}\n }"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.math.*;\nimport java.awt.geom.*;\nimport java.io.*;\n      \n      \npublic class Main {\n\tstatic int[] vx = new int[]{0,1,0,-1};\n\tstatic int[] vy = new int[]{1,0,-1,0};\n\tstatic int[] Y  = new int[]{0,0,0,1,1,1,2,2,2};\n\tstatic int[] X  = new int[]{0,1,2,0,1,2,0,1,2};\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n == 0) break;\n\t\t\tchar s = sc.next().charAt(0);\n\t\t\tint S = s - 'A';\n\t\t\tchar t = sc.next().charAt(0);\n\t\t\tint T = t - 'A';\n\t\t\tchar b = sc.next().charAt(0);\n\t\t\tint B = b - 'A';\n\t\t\tint[][][] dp = new int[n+1][3][3];\n\t\t\tdp[0][Y[S]][X[S]] = 1;\n\t\t\tfor(int i = 0; i < n; i++) {\n\t\t\t\tfor(int j = 0; j < 3; j++) {\n\t\t\t\t\tfor(int k = 0; k < 3; k++) {\n\t\t\t\t\t\tfor(int l = 0; l < 4; l++) {\n\t\t\t\t\t\t\tint ty = j + vy[l];\n\t\t\t\t\t\t\tint tx = k + vx[l];\n\t\t\t\t\t\t\tif(ty < 0 || tx < 0 || tx >= 3 || ty >= 3 || (ty == Y[B] && tx == X[B])) {\n\t\t\t\t\t\t\t\tty = j;\n\t\t\t\t\t\t\t\ttx = k;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdp[i+1][ty][tx] += dp[i][j][k];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tint sum = 0;\n\t\t\tfor(int i = 0; i < 3; i++) {\n\t\t\t\tfor(int j = 0; j < 3; j++) {\n\t\t\t\t\tsum += dp[n][i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.printf(\"%.25f\\n\",dp[n][Y[T]][X[T]] / (double)sum);\n\t\t\t\n\t\t}\n\t}\n }"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport static java.util.Arrays.*;\nimport static java.lang.Math.*;\n\nclass Main {\n\tstatic Scanner sc = new Scanner(System.in);\n\tstatic int n;\n\tstatic char s, t, b;\n\tstatic int[] dx = {-1, 0, 1, 0}, dy = {0, -1, 0, 1};\n\t\n\tpublic static void main(String[] args) {\n\t\twhile (read()) {\n\t\t\tsolve();\n\t\t}\n\t}\n\n\tstatic boolean read() {\n\t\tn = sc.nextInt();\n\t\tif (n == 0) return false;\n\t\t\n\t\ts = sc.next().charAt(0);\n\t\tt = sc.next().charAt(0);\n\t\tb = sc.next().charAt(0);\n\t\t\n\t\treturn true;\n\t}\n\n\tstatic void solve() {\n\t\tdouble[][][] dp = new double[n + 1][5][5];\n\t\tfor (int i = 0; i < n; i++) \n\t\t\tfor (int j = 0; j < 5; j++)\n\t\t\t\tfill(dp[i][j], 0);\n\t\tint pos_s = s - 'A', pos_t = t - 'A', pos_b = b - 'A';\n\t\tint sx = pos_s % 3 + 1, sy = pos_s / 3 + 1;\n\t\tint gx = pos_t % 3 + 1, gy = pos_t / 3 + 1;\n\t\tint bx = pos_b % 3 + 1, by = pos_b / 3 + 1;\n\t\t\n\t\tdp[0][sy][sx] = 1.0;\n\t\t\n\t\tfor (int i = 1; i <= n; i++) {\n\t\t\tfor (int y = 1; y <= 3; y++) {\n\t\t\t\tfor (int x = 1; x <= 3; x++) {\n\t\t\t\t\tfor (int l = 0; l < 4; l++) {\n\t\t\t\t\t\tint ty = y + dy[l], tx = x + dx[l];\n\t\t\t\t\t\tif ((y == by) && (x == bx)){\n\t\t\t\t\t\t\tty = y; tx = x;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdp[i][ty][tx] += dp[i - 1][y][x] / 4.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tSystem.out.printf(\"%.8f\", dp[n][gy][gx]);\n\t\tSystem.out.println();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nclass Main{\n\n    static int n;\n    static int [][] t = new int[3][3];\n    static int dy[] = {-1,0,1,0};\n    static int dx[] = {0,1,0,-1};\n    static int sx,sy,gx,gy,kx,ky;\n\n    static int change(String ch){\n\tif(ch.equals(\"A\"))return 0;\n\tif(ch.equals(\"B\"))return 1;\n\tif(ch.equals(\"C\"))return 2;\n\tif(ch.equals(\"D\"))return 3;\n\tif(ch.equals(\"E\"))return 4;\n\tif(ch.equals(\"F\"))return 5;\n\tif(ch.equals(\"G\"))return 6;\n\tif(ch.equals(\"H\"))return 7;\n\tif(ch.equals(\"I\"))return 8;\n\telse return -1;\n    }\n\n    static boolean inField(int y,int x){\n\tif(y<0||x<0)return false;\n\tif(y>2||x>2)return false;\n\treturn true;\n    }\n    \n    static double [][][] mem = new double[3][3][16];\n\n    static double solve(int y,int x,int cnt){\n\tif(mem[y][x][cnt]!=200.0)return mem[y][x][cnt];\n\tif(cnt==n){\n\t    if(t[y][x]==1)return 1.0;\n\t    else return 0.0;\n\t}\n\t\n\tint ny,nx;\n\tdouble sum=0.0;\n\tfor(int i=0;i<4;i++){\n\t    ny=y+dy[i];\n\t    nx=x+dx[i];\n\t    if(inField(ny,nx)==false||t[ny][nx]==-1)continue;\n\t    sum+=solve(ny,nx,cnt+1);\n\t}\n\tsum=sum/4.0;\n\tmem[y][x][cnt]=sum;\n\treturn sum;\n    }\n\n    public static void main(String[] args){\n\tScanner scan = new Scanner(System.in);\n\tString ch;\n\twhile(true){\n\t    n=scan.nextInt();\n\n\t    if(n==0)break;\n\t    for(int i=0;i<3;i++){\n\t\tfor(int j=0;j<3;j++){\n\t\t    for(int k=0;k<15;k++)mem[i][j][k]=200.0;\n\t\t    t[i][j]=0;\n\t\t}\n\t    }\n\n\t    ch=scan.next();\n\t    sy=change(ch)/3;\n\t    sx=change(ch)%3;\n\n\t    ch=scan.next();\n\t    gy=change(ch)/3;\n\t    gx=change(ch)%3;\n\n\t    ch=scan.next();\n\t    ky=change(ch)/3;\n\t    kx=change(ch)%3;\n\n\t    /*\n\t    System.out.println(sy+\" \"+sx);\n\t    System.out.println(gy+\" \"+gx);\n\t    System.out.println(ky+\" \"+kx);\n\t    */\n\t    t[gy][gx]=1;\n\t    t[ky][kx]=-1;\n\t    System.out.println(solve(sy,sx,0));\n\n\t}\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Scanner;\n\n/**\n * Cleaning Robot\n *  URL:http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1020&lang=jp\n *\n * @author Igari Kazuya\n *\n */\npublic class Main {\n\n\t/**\n\t * @param args\n\t */\n\tpublic static void main(String[] args) {\n\t\t// TODO ©®¶¬³ê½\\bhEX^u\n\t\tScanner sc = new Scanner(System.in);\n\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\n\t\t\tif(n == 0){\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tString s,t,b;\n\t\t\ts = sc.next();\n\t\t\tt = sc.next();\n\t\t\tb = sc.next();\n\n\t\t\tint[][] map = new int[5][5];\n\t\t\tfor(int i=0;i<5;i++){\n\t\t\t\tmap[0][i] = 1;\n\t\t\t\tmap[i][0] = 1;\n\t\t\t\tmap[4][i] = 1;\n\t\t\t\tmap[i][4] = 1;\n\t\t\t}\n\n\t\t\tint ss = s.charAt(0) - 'A';\n\t\t\tint tt = t.charAt(0) - 'A';\n\t\t\tint bb = b.charAt(0) - 'A';\n\n\t\t\tmap[bb/3 + 1][bb%3 + 1] = 1;//qÉ\n\n\t\t\tArrayList<Integer> list = new ArrayList<Integer>();\n\t\t\tArrayList<Integer> buf = new ArrayList<Integer>();\n\n\t\t\tlist.add(ss);\n\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tfor(int j=0;j<list.size();j++){\n\t\t\t\t\tint bufint = list.get(j);\n\t\t\t\t\tif(map[bufint/3][bufint%3+1] != 1){\n\t\t\t\t\t\tbuf.add(bufint - 3);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbuf.add(bufint);\n\t\t\t\t\t}\n\t\t\t\t\tif(map[bufint/3+2][bufint%3+1] != 1){\n\t\t\t\t\t\tbuf.add(bufint + 3);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbuf.add(bufint);\n\t\t\t\t\t}\n\t\t\t\t\tif(map[bufint/3+1][bufint%3] != 1){\n\t\t\t\t\t\tbuf.add(bufint - 1);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbuf.add(bufint);\n\t\t\t\t\t}\n\t\t\t\t\tif(map[bufint/3+1][bufint%3+2] != 1){\n\t\t\t\t\t\tbuf.add(bufint + 1);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbuf.add(bufint);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlist.clear();\n\n\t\t\t\tfor(int j=0;j<buf.size();j++){\n\t\t\t\t\tlist.add(buf.get(j));\n\t\t\t\t}\n\t\t\t\tbuf.clear();\n\t\t\t}\n\n\t\t\tint count=0;\n\t\t\tfor(int i=0;i<list.size();i++){\n\t\t\t\tif(list.get(i) == tt){\n\t\t\t\t\tcount++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println((double)count/list.size());\n\t\t}\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\n\tstatic Scanner sc = new Scanner(System.in);\n\tstatic int[] DR = { 1, 0, -1, 0 };\n\tstatic int[] DC = { 0, 1, 0, -1 };\n\n\tpublic static void main(String[] args) throws Exception {\n\t\tchar[][] room = new char[3][3];\n\t\tfor (int i = 0; i < 3; ++i) {\n\t\t\tfor (int j = 0; j < 3; ++j) {\n\t\t\t\troom[i][j] = (char) ('A' + i * 3 + j);\n\t\t\t}\n\t\t}\n\t\twhile (true) {\n\t\t\tint N = sc.nextInt();\n\t\t\tif (N == 0) break;\n\t\t\tint s = sc.next().charAt(0) - 'A';\n\t\t\tint t = sc.next().charAt(0) - 'A';\n\t\t\tchar b = sc.next().charAt(0);\n\t\t\tint r = s / 3;\n\t\t\tint c = s % 3;\n\t\t\tdouble[][] prob = new double[3][3];\n\t\t\tprob[r][c] = 1;\n\t\t\tfor (int i = 0; i < N; ++i) {\n\t\t\t\tdouble[][] next = new double[3][3];\n\t\t\t\tfor (int j = 0; j < 3; ++j) {\n\t\t\t\t\tfor (int k = 0; k < 3; ++k) {\n\t\t\t\t\t\tfor (int l = 0; l < 4; ++l) {\n\t\t\t\t\t\t\tint nr = j + DR[l];\n\t\t\t\t\t\t\tint nc = k + DC[l];\n\t\t\t\t\t\t\tif (nr < 0 || 3 <= nr || nc < 0 || 3 <= nc || room[nr][nc] == b) continue;\n\t\t\t\t\t\t\tnext[nr][nc] += prob[j][k] / 4;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tprob = next;\n\t\t\t}\n\t\t\tSystem.out.printf(\"%.9f\\n\", prob[t / 3][t % 3]);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.LinkedList;\nimport java.util.Scanner;\npublic class Main\n{\n\tpublic static void main(String[] args) \n\t{\n\t\tScanner in=new Scanner(System.in);\n\t\tString field[][]=\n\t\t\t{\n\t\t\t\t{\"A\",\"B\",\"C\"},\n\t\t\t\t{\"D\",\"E\",\"F\"},\n\t\t\t\t{\"G\",\"H\",\"I\"}\t\n\t\t\t};\n\t\tint dx[]={1,0,0,-1};\n\t\tint dy[]={0,1,-1,0};\n\t\tfor(;;)\n\t\t{\n\t\t\tint n=in.nextInt();//battery\n\t\t\tif(n==0)\n\t\t\t\treturn;\n\t\t\tString te=in.nextLine();\n\t\t\tString str[]=in.nextLine().split(\" \");\n\t\t\tString s=str[0];//start\n\t\t\tString t=str[1];//charge\n\t\t\tString b=str[2];//no-enter\n\t\t\tLinkedList<String>que=new LinkedList<String>();\n\t\t\tdouble ans=1;\n\t\t\tint sh=-1,sw=-1;\n\t\t\tint th=-1,tw=-1;\n\t\t\tboolean judge=false;\n\t\t\tboolean judge2=false;\n\t\t\tfor(int i=0;i<3;i++)\n\t\t\t\tfor(int j=0;j<3;j++)\n\t\t\t\t{\n\t\t\t\t\tif(s.equals(field[i][j]))\n\t\t\t\t\t{\n\t\t\t\t\t\tsh=i;\n\t\t\t\t\t\tsw=j;\n\t\t\t\t\t}\n\t\t\t\t\tif(t.equals(field[i][j]))\n\t\t\t\t\t{\n\t\t\t\t\t\tth=i;\n\t\t\t\t\t\ttw=j;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\tque.add(sh+\" \"+sw);\n\t\t\twhile(!que.isEmpty())\n\t\t\t{\n\t\t\t\tint size=que.size();\n\t\t\t\tfor(int i=0;i<size;i++)\n\t\t\t\t{\n\t\t\t\t\tString now[]=que.poll().split(\" \");\n\t\t\t\t\tint nh=Integer.valueOf(now[0]);\n\t\t\t\t\tint nw=Integer.valueOf(now[1]);\n\t\t\t\t\tif(n==0)\n\t\t\t\t\t{\n\t\t\t\t\t\tjudge=true;\n\t\t\t\t\t\tif(nh==th&&nw==tw)\n\t\t\t\t\t\t\tjudge2=true;\n\t\t\t\t\t}\n\t\t\t\t\tfor(int j=0;j<4;j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint h=dy[j]+nh;\n\t\t\t\t\t\tint w=dx[j]+nw;\n\t\t\t\t\t\tif(h>=0&&h<3&&w>=0&&w<3&&!field[h][w].equals(b))\n\t\t\t\t\t\t\tque.add(h+\" \"+w);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(judge)\n\t\t\t\t\tbreak;\n\t\t\t\tn--;\n\t\t\t\tans/=4;\n\t\t\t}\n\t\t\tif(!judge2)\n\t\t\t\tans=0;\n\t\t\tSystem.out.printf(\"%.8f\\n\",ans);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Scanner;\n\n/**\n * Cleaning Robot\n *  URL:http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1020&lang=jp\n *\n * @author Igari Kazuya\n *\n */\npublic class Main {\n\n\t/**\n\t * @param args\n\t */\n\tpublic static void main(String[] args) {\n\t\t// TODO ツ篠ゥツ督ョツ青カツ青ャツつウツづェツつスツδソツッツドツ・ツスツタツブ\n\t\tScanner sc = new Scanner(System.in);\n\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\n\t\t\tif(n == 0){\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tString s,t,b;\n\t\t\ts = sc.next();\n\t\t\tt = sc.next();\n\t\t\tb = sc.next();\n\n\t\t\tint[] scoremap = new int[9];\n\t\t\tint[] bufmap = new int[9];\n\t\t\tfor(int i=0;i<3;i++){\n\t\t\t\tscoremap[i] = 0;\n\t\t\t\tbufmap[i] = 0;\n\t\t\t}\n\n\t\t\tint ss = s.charAt(0) - 'A';\n\t\t\tint tt = t.charAt(0) - 'A';\n\t\t\tint bb = b.charAt(0) - 'A';\n\n\t\t\tscoremap[ss] = 1;//ツ機ツ械ツつソツづ。ツづア\n\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tfor(int k=0;k<9;k++){\n\t\t\t\t\tif(k-1 >= 0 && k-1 != bb){\n\t\t\t\t\t\tbufmap[k-1] += scoremap[k];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbufmap[k] += scoremap[k];\n\t\t\t\t\t}\n\t\t\t\t\tif(k-3 >= 0 && k-3 != bb){\n\t\t\t\t\t\tbufmap[k-3] += scoremap[k];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbufmap[k] += scoremap[k];\n\t\t\t\t\t}\n\t\t\t\t\tif(k+1 <= 8 && k+1 != bb){\n\t\t\t\t\t\tbufmap[k+1] += scoremap[k];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbufmap[k] += scoremap[k];\n\t\t\t\t\t}\n\t\t\t\t\tif(k+3 <= 8 && k+3 != bb){\n\t\t\t\t\t\tbufmap[k+3] += scoremap[k];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbufmap[k] += scoremap[k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int k=0;k<9;k++){\n\t\t\t\t\tscoremap[k] = bufmap[k];\n\t\t\t\t\tbufmap[k] = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tint count=0;\n\t\t\tfor(int i=0;i<9;i++){\n\t\t\t\tcount += scoremap[i];\n\t\t\t}\n\t\t\tSystem.out.println(scoremap[tt]/(double)count);\n\t\t}\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\tfinal static byte nexts[][] = {\n\t\t\t// 東,西,南,北\n\t\t\t{ 1, -1, 3, -1 },// 0:A\n\t\t\t{ 2, 0, 4, -1 }, // 1:B\n\t\t\t{ -1, 1, 5, -1 },// 2:C\n\t\t\t{ 4, -1, 6, 0 }, // 3:D\n\t\t\t{ 5, 3, 7, 1 }, // 4:E\n\t\t\t{ -1, 4, 8, 2 }, // 5:F\n\t\t\t{ 7, -1, -1, 3 },// 6:G\n\t\t\t{ 8, 6, -1, 4 }, // 7:H\n\t\t\t{ -1, 7, -1, 5 } // 8:I\n\t};\n\tfinal static byte distances[][] = {\n\t\t\t// A,B, C, D, E, F, G, H, I\n\t\t\t{ 0, 1, 2, 1, 2, 3, 2, 3, 4 },// 0:A\n\t\t\t{ 1, 0, 1, 2, 1, 2, 3, 2, 3 },// 1:B\n\t\t\t{ 2, 1, 0, 3, 2, 1, 4, 3, 2 },// 2:C\n\t\t\t{ 1, 2, 3, 0, 1, 2, 1, 2, 3 },// 3:D\n\t\t\t{ 2, 1, 2, 1, 0, 1, 2, 1, 2 },// 4:E\n\t\t\t{ 3, 2, 1, 2, 1, 0, 3, 2, 1 },// 5:F\n\t\t\t{ 2, 3, 4, 1, 2, 3, 0, 1, 2 },// 6:G\n\t\t\t{ 3, 2, 3, 2, 1, 2, 1, 0, 1 },// 7:H\n\t\t\t{ 4, 3, 2, 3, 2, 1, 2, 1, 0 } // 8:I\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic int probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tbyte battery;\n\t\t\tbyte start;\n\n\t\t\tbattery = Byte.parseByte(line);\n\t\t\tif (battery == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1 << battery * 2);\n\t\t\tSystem.out.println(String.format(\"%.8f\",\n\t\t\t\t\tprobability * Math.pow(4, -battery)));\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, int p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif (distance(current, charger) <= battery) {\n\t\t\tfor (byte n1 : next(current)) {\n\t\t\t\tif (n1 < 0 || n1 == storeroom) {\n\t\t\t\t\tfor (byte n2 : next(current)) {\n\t\t\t\t\t\tif (n2 != n1)\n\t\t\t\t\t\t\tclean(n2, battery - 2, (p >> 2) - (p >> 4));\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tclean(n1, battery - 1, p >> 2);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\treturn nexts[current];\n\t}\n\n\tstatic byte distance(byte current, byte charger) {\n\t\treturn distances[current][charger];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\tfinal static byte nexts[][] = {\n\t\t\t// 東,西,南,北\n\t\t\t{ 1, -1, 3, -1 },// 0:A\n\t\t\t{ 2, 0, 4, -1 }, // 1:B\n\t\t\t{ -1, 1, 5, -1 },// 2:C\n\t\t\t{ 4, -1, 6, 0 }, // 3:D\n\t\t\t{ 5, 3, 7, 1 }, // 4:E\n\t\t\t{ -1, 4, 8, 2 }, // 5:F\n\t\t\t{ 7, -1, -1, 3 },// 6:G\n\t\t\t{ 8, 6, -1, 4 }, // 7:H\n\t\t\t{ -1, 7, -1, 5 } // 8:I\n\t};\n\tfinal static byte distances[][] = {\n\t\t\t// A,B, C, D, E, F, G, H, I\n\t\t\t{ 0, 1, 2, 1, 2, 3, 2, 3, 4 },// 0:A\n\t\t\t{ 1, 0, 1, 2, 1, 2, 3, 2, 3 },// 1:B\n\t\t\t{ 2, 1, 0, 3, 2, 1, 4, 3, 2 },// 2:C\n\t\t\t{ 1, 2, 3, 0, 1, 2, 1, 2, 3 },// 3:D\n\t\t\t{ 2, 1, 2, 1, 0, 1, 2, 1, 2 },// 4:E\n\t\t\t{ 3, 2, 1, 2, 1, 0, 3, 2, 1 },// 5:F\n\t\t\t{ 2, 3, 4, 1, 2, 3, 0, 1, 2 },// 6:G\n\t\t\t{ 3, 2, 3, 2, 1, 2, 1, 0, 1 },// 7:H\n\t\t\t{ 4, 3, 2, 3, 2, 1, 2, 1, 0 } // 8:I\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic int probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tbyte battery;\n\t\t\tbyte start;\n\n\t\t\tbattery = Byte.parseByte(line);\n\t\t\tif (battery == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1 << battery * 2);\n\t\t\tSystem.out.println(String.format(\"%.8f\",\n\t\t\t\t\tprobability * Math.pow(4, -battery)));\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, int p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif (distance(current, charger) <= battery) {\n\t\t\tfor (byte n1 : next(current)) {\n\t\t\t\tif (n1 < 0 || n1 == storeroom) {\n\t\t\t\t\tfor (byte n2 : next(current)) {\n\t\t\t\t\t\tif (n2 != n1)\n\t\t\t\t\t\t\tclean(current, battery - 2, (p >> 2) - (p >> 4));\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tclean(n1, battery - 1, p >> 2);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\treturn nexts[current];\n\t}\n\n\tstatic byte distance(byte current, byte charger) {\n\t\treturn distances[current][charger];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport static java.util.Arrays.*;\nimport static java.lang.Math.*;\n\nclass Main {\n\tstatic Scanner sc = new Scanner(System.in);\n\tstatic int n;\n\tstatic char s, t, b;\n\tstatic int[] dx = {-1, 0, 1, 0}, dy = {0, -1, 0, 1};\n\t\n\tpublic static void main(String[] args) {\n\t\twhile (read()) {\n\t\t\tsolve();\n\t\t}\n\t}\n\n\tstatic boolean read() {\n\t\tn = sc.nextInt();\n\t\tif (n == 0) return false;\n\t\t\n\t\ts = sc.next().charAt(0);\n\t\tt = sc.next().charAt(0);\n\t\tb = sc.next().charAt(0);\n\t\t\n\t\treturn true;\n\t}\n\n\tstatic void solve() {\n\t\tdouble[][][] dp = new double[n + 1][5][5];\n\t\tfor (int i = 0; i < n; i++) \n\t\t\tfor (int j = 0; j < 5; j++)\n\t\t\t\tfill(dp[i][j], 0);\n\t\tint pos_s = s - 'A', pos_t = t - 'A', pos_b = b - 'A';\n\t\tdp[0][pos_s / 3 + 1][pos_s % 3 + 1] = 1.0;\n\t\t\n\t\tfor (int i = 1; i <= n; i++) {\n\t\t\tfor (int j = 1; j <= 3; j++) {\n\t\t\t\tfor (int k = 1; k <= 3; k++) {\n\t\t\t\t\tif ((j != (pos_b / 3 + 1)) || (k != (pos_b % 3 + 1))) {\n\t\t\t\t\t\tfor (int l = 0; l < 4; l++) {\n\t\t\t\t\t\t\tdp[i][j][k] = max(dp[i][j][k], dp[i - 1][j + dy[l]][k + dx[l]]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdp[i][j][k] *= 0.25;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tSystem.out.printf(\"%.8f\", dp[n][pos_t / 3 + 1][pos_t % 3 + 1]);\n\t\tSystem.out.println();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic double probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\tbyte battery;\n\t\tbyte start;\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tif ((battery = Byte.parseByte(line)) == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1);\n\t\t\tSystem.out.println(probability);\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, double p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t\treturn;\n\t\t} else if (battery == 1) {\n\t\t\tboolean b = false;\n\t\t\tfor (byte n : next(current)) {\n\t\t\t\tb |= (n != charger);\n\t\t\t}\n\t\t\tif (!b)\n\t\t\t\treturn;\n\t\t} else {\n\t\t\tfor (byte n : next(current)) {\n\t\t\t\tif (n < 0 || n == storeroom) {\n\t\t\t\t\tclean(current, battery - 1, p / 4);\n\t\t\t\t} else {\n\t\t\t\t\tclean(n, battery - 1, p / 4);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\t// 東,西,南,北\n\t\tfinal byte nexts[][] = {//\n\t\t{ 1, -1, 3, -1 },// 0\n\t\t\t\t{ 2, 0, 4, -1 },// 1\n\t\t\t\t{ -1, 1, 5, -1 },// 2\n\t\t\t\t{ 4, -1, 6, 0 },// 3\n\t\t\t\t{ 5, 3, 7, 1 },// 4\n\t\t\t\t{ -1, 4, 8, 2 },// 5\n\t\t\t\t{ 7, -1, -1, 3 },// 6\n\t\t\t\t{ 8, 6, -1, 4 },// 7\n\t\t\t\t{ -1, 7, -1, 5 },// 8\n\t\t};\n\n\t\tbyte[] result = null;\n\n\t\tswitch (current) {\n\t\tcase 0:\n\t\t\tresult = nexts[0];\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tresult = nexts[1];\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tresult = nexts[2];\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tresult = nexts[3];\n\t\t\tbreak;\n\t\tcase 4:\n\t\t\tresult = nexts[4];\n\t\t\tbreak;\n\t\tcase 5:\n\t\t\tresult = nexts[5];\n\t\t\tbreak;\n\t\tcase 6:\n\t\t\tresult = nexts[6];\n\t\t\tbreak;\n\t\tcase 7:\n\t\t\tresult = nexts[7];\n\t\t\tbreak;\n\t\tcase 8:\n\t\t\tresult = nexts[8];\n\t\t\tbreak;\n\t\t}\n\t\treturn result;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Scanner;\n\n/**\n * Cleaning Robot\n *  URL:http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1020&lang=jp\n *\n * @author Igari Kazuya\n *\n */\npublic class Main{\n\n\t/**\n\t * @param args\n\t */\n\tpublic static void main(String[] args) {\n\t\t// TODO ©®¶¬³ê½\\bhEX^u\n\t\tScanner sc = new Scanner(System.in);\n\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\n\t\t\tif(n == 0){\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tString s,t,b;\n\t\t\ts = sc.next();\n\t\t\tt = sc.next();\n\t\t\tb = sc.next();\n\n\t\t\tint[][] map = new int[5][5];\n\t\t\tfor(int i=0;i<5;i++){\n\t\t\t\tmap[0][i] = 1;\n\t\t\t\tmap[i][0] = 1;\n\t\t\t\tmap[4][i] = 1;\n\t\t\t\tmap[i][4] = 1;\n\t\t\t}\n\n\t\t\tint ss = s.charAt(0) - 'A';\n\t\t\tint tt = t.charAt(0) - 'A';\n\t\t\tint bb = b.charAt(0) - 'A';\n\n\t\t\t//map[ss/3 + 1][ss%3 + 1] = 3;//@B¿áñ\n\t\t\t//map[tt/3 + 1][tt%3 + 1] = 2;//[dí\n\t\t\tmap[bb/3 + 1][bb%3 + 1] = 1;//qÉ\n\n\t\t\tArrayList<Integer> list = new ArrayList<Integer>();\n\t\t\tArrayList<Integer> buf = new ArrayList<Integer>();\n\n\t\t\tlist.add(ss);\n\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tfor(int j=0;j<list.size();j++){\n\t\t\t\t\tint bufint = list.get(j);\n\t\t\t\t\tif(map[bufint/3][bufint%3+1] != 1){\n\t\t\t\t\t\tbuf.add(bufint - 3);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbuf.add(bufint);\n\t\t\t\t\t}\n\t\t\t\t\tif(map[bufint/3+2][bufint%3+1] != 1){\n\t\t\t\t\t\tbuf.add(bufint + 3);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbuf.add(bufint);\n\t\t\t\t\t}\n\t\t\t\t\tif(map[bufint/3+1][bufint%3] != 1){\n\t\t\t\t\t\tbuf.add(bufint - 1);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbuf.add(bufint);\n\t\t\t\t\t}\n\t\t\t\t\tif(map[bufint/3+1][bufint%3+2] != 1){\n\t\t\t\t\t\tbuf.add(bufint + 1);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbuf.add(bufint);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlist.clear();\n\n\t\t\t\tfor(int j=0;j<buf.size();j++){\n\t\t\t\t\tlist.add(buf.get(j));\n\t\t\t\t}\n\t\t\t\tbuf.clear();\n\t\t\t}\n\n\t\t\tint count=0;\n\t\t\tfor(int i=0;i<list.size();i++){\n\t\t\t\tif(list.get(i) == tt){\n\t\t\t\t\tcount++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(list.size()!=0){\n\t\t\t\tSystem.out.println((double)count/list.size());\n\t\t\t}\n\t\t}\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Scanner;\n\n/**\n * Cleaning Robot\n *  URL:http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1020&lang=jp\n *\n * @author Igari Kazuya\n *\n */\npublic class Main {\n\n\t/**\n\t * @param args\n\t */\n\tpublic static void main(String[] args) {\n\t\t// TODO ツ篠ゥツ督ョツ青カツ青ャツつウツづェツつスツδソツッツドツ・ツスツタツブ\n\t\tScanner sc = new Scanner(System.in);\n\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\n\t\t\tif(n == 0){\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tString s,t,b;\n\t\t\ts = sc.next();\n\t\t\tt = sc.next();\n\t\t\tb = sc.next();\n\n\t\t\tint[] scoremap = new int[9];\n\t\t\tint[] bufmap = new int[9];\n\t\t\tfor(int i=0;i<3;i++){\n\t\t\t\tscoremap[i] = 0;\n\t\t\t\tbufmap[i] = 0;\n\t\t\t}\n\n\t\t\tint ss = s.charAt(0) - 'A';\n\t\t\tint tt = t.charAt(0) - 'A';\n\t\t\tint bb = b.charAt(0) - 'A';\n\n\t\t\tscoremap[ss] = 1;//ツ機ツ械ツつソツづ。ツづア\n\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tfor(int k=0;k<9;k++){\n\t\t\t\t\tif(k-1 >= 0 && k-1 != bb){\n\t\t\t\t\t\tbufmap[k-1] += scoremap[k];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbufmap[k] += scoremap[k];\n\t\t\t\t\t}\n\t\t\t\t\tif(k-3 >= 0 && k-3 != bb){\n\t\t\t\t\t\tbufmap[k-3] += scoremap[k];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbufmap[k] += scoremap[k];\n\t\t\t\t\t}\n\t\t\t\t\tif(k+1 <= 8 && k+1 != bb){\n\t\t\t\t\t\tbufmap[k+1] += scoremap[k];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbufmap[k] += scoremap[k];\n\t\t\t\t\t}\n\t\t\t\t\tif(k+3 <= 8 && k+3 != bb){\n\t\t\t\t\t\tbufmap[k+3] += scoremap[k];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbufmap[k] += scoremap[k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int k=0;k<9;k++){\n\t\t\t\t\tscoremap[k] = bufmap[k];\n\t\t\t\t\tbufmap[k] = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tint count=0;\n\t\t\tfor(int i=0;i<9;i++){\n\t\t\t\tcount += scoremap[i];\n\t\t\t}\n\t\t\tSystem.out.printf(\"%.8f\\n\",scoremap[tt]/(double)count);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.IOException;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) throws IOException {\n\n\t\tnew Main().run();\n\t}\n\n\tprivate void run() throws IOException {\n\t\tScanner scanner = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint n = scanner.nextInt();\n\t\t\tif (n == 0)\n\t\t\t\tbreak;\n\t\t\tint[] xs = new int[3];\n\t\t\tint[] ys = new int[3];\n\t\t\tfor (int i = 0; i < 3; i++) {\n\t\t\t\tint a = scanner.next().charAt(0) - 'A';\n\t\t\t\txs[i] = a % 3;\n\t\t\t\tys[i] = a / 3;\n\t\t\t}\n\t\t\tdouble[][][] dp = new double[2][3][3];\n\t\t\tint u = 0;\n\t\t\tdp[u][xs[0]][ys[0]] = 1;\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tfor (int y = 0; y < 3; y++) {\n\t\t\t\t\tfor (int x = 0; x < 3; x++) {\n\t\t\t\t\t\tif(dp[u][y][x]==0)\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tfor (int[] m : move) {\n\t\t\t\t\t\t\tint nx = x + m[0];\n\t\t\t\t\t\t\tint ny = y + m[1];\n\t\t\t\t\t\t\tif (nx == xs[2] && ny == ys[2] || nx < 0 || 2 < nx\n\t\t\t\t\t\t\t\t\t|| ny < 0 || 2 < ny)\n\t\t\t\t\t\t\t\tdp[1 - u][y][x] += dp[u][y][x] / 4;\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tdp[1 - u][ny][nx] += dp[u][y][x] / 4;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdp[u][y][x] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tu = 1 - u;\n\t\t\t}\n\t\t\tSystem.out.printf(\"%.8f\\n\", dp[u][xs[1]][ys[1]]);\n\t\t}\n\t}\n\n\tint[][] move = { { -1, 0 }, { 0, -1 }, { 0, 1 }, { 1, 0 } };\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\tpublic static void main(String args[]) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint n;\n\t\tint start, goal, close;\n\t\tdouble a[][];\n\t\tint k;\n\t\tn = sc.nextInt();\n\t\twhile (n != 0) {\n\t\t\tstart = (int)(sc.next().charAt(0) - 'A' + 1);\n\t\t\tgoal  = (int)(sc.next().charAt(0) - 'A' + 1);\n\t\t\tclose = (int)(sc.next().charAt(0) - 'A' + 1);\n\n\t\t\ta = new double[n + 1][10];\n\t\t\tfor (int i = 0; i <= n; i++) {\n\t\t\t\tfor (int j = 1; j <= 9; j++) {\n\t\t\t\t\tk = 0;\n\t\t\t\t\tif (i == 0) {\n\t\t\t\t\t\tif (j == goal) {\n\t\t\t\t\t\t\ta[i][j] = 1.0;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ta[i][j] = 0.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (j % 3 == 1 && j + 1 != close) {\n\t\t\t\t\t\t\ta[i][j] += a[i - 1][j + 1] / 4;\n\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (j % 3 == 2) {\n\t\t\t\t\t\t\tif (j + 1 != close) {\n\t\t\t\t\t\t\t\ta[i][j] += a[i - 1][j + 1] / 4;\n\t\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (j - 1 != close) {\n\t\t\t\t\t\t\t\ta[i][j] += a[i - 1][j - 1] / 4;\n\t\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (j % 3 == 0 && j - 1 != close) {\n\t\t\t\t\t\t\ta[i][j] += a[i - 1][j - 1] / 4;\n\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (1 <= j && j <= 3 && j + 3 != close) {\n\t\t\t\t\t\t\ta[i][j] += a[i - 1][j + 3] / 4;\n\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (4 <= j && j <= 6) {\n\t\t\t\t\t\t\tif (j - 3 != close) {\n\t\t\t\t\t\t\t\ta[i][j] += a[i - 1][j - 3] / 4;\n\t\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (j + 3 != close) {\n\t\t\t\t\t\t\t\ta[i][j] += a[i - 1][j + 3] / 4;\n\t\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (7 <= j && j <= 9 && j - 3 != close) {\n\t\t\t\t\t\t\ta[i][j] += a[i - 1][j - 3] / 4;\n\t\t\t\t\t\t\tk++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ta[i][j] += a[i - 1][j] * (4 - k) / 4;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(a[n][start]);\n\t\t\tn = sc.nextInt();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic double probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\tbyte battery;\n\t\tbyte start;\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tif ((battery = Byte.parseByte(line)) == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1);\n\t\t\tSystem.out.println(probability);\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, double p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif (battery > 0) {\n\t\t\tfor (byte d : next(current)) {\n\t\t\t\tif (d < 0 || d == storeroom) {\n\t\t\t\t\tclean(current, battery - 1, p / 4);\n\t\t\t\t} else {\n\t\t\t\t\tclean(d, battery - 1, p / 4);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\t// 東,西,南,北\n\t\tfinal byte nexts[][] = {//\n\t\t{ 1, -1, 3, -1 },// 0\n\t\t\t\t{ 2, 0, 4, -1 },// 1\n\t\t\t\t{ -1, 1, 5, -1 },// 2\n\t\t\t\t{ 4, -1, 6, 0 },// 3\n\t\t\t\t{ 5, 3, 7, 1 },// 4\n\t\t\t\t{ -1, 4, 8, 2 },// 5\n\t\t\t\t{ 7, -1, -1, 3 },// 6\n\t\t\t\t{ 8, 6, -1, 4 },// 7\n\t\t\t\t{ -1, 7, -1, 5 },// 8\n\t\t};\n\n\t\tbyte[] result = null;\n\n\t\tswitch (current) {\n\t\tcase 0:\n\t\t\tresult = nexts[0];\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tresult = nexts[1];\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tresult = nexts[2];\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tresult = nexts[3];\n\t\t\tbreak;\n\t\tcase 4:\n\t\t\tresult = nexts[4];\n\t\t\tbreak;\n\t\tcase 5:\n\t\t\tresult = nexts[5];\n\t\t\tbreak;\n\t\tcase 6:\n\t\t\tresult = nexts[6];\n\t\t\tbreak;\n\t\tcase 7:\n\t\t\tresult = nexts[7];\n\t\t\tbreak;\n\t\tcase 8:\n\t\t\tresult = nexts[8];\n\t\t\tbreak;\n\t\t}\n\t\treturn result;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nclass Main{\n\n    static int n;\n    static int [][] t = new int[3][3];\n    static int dy[] = {-1,0,1,0};\n    static int dx[] = {0,1,0,-1};\n    static int sx,sy,gx,gy,kx,ky;\n\n    static int change(String ch){\n\tif(ch.equals(\"A\"))return 0;\n\tif(ch.equals(\"B\"))return 1;\n\tif(ch.equals(\"C\"))return 2;\n\tif(ch.equals(\"D\"))return 3;\n\tif(ch.equals(\"E\"))return 4;\n\tif(ch.equals(\"F\"))return 5;\n\tif(ch.equals(\"G\"))return 6;\n\tif(ch.equals(\"H\"))return 7;\n\tif(ch.equals(\"I\"))return 8;\n\telse return -1;\n    }\n\n    static boolean inField(int y,int x){\n\tif(y<0||x<0)return false;\n\tif(y>2||x>2)return false;\n\treturn true;\n    }\n    \n    static double [][][] mem = new double[3][3][16];\n\n    static double solve(int y,int x,int cnt){\n\tif(mem[y][x][cnt]!=200.0)return mem[y][x][cnt];\n\tif(cnt==n){\n\t    if(t[y][x]==1)return 1.0;\n\t    else return 0.0;\n\t}\n\t\n\tint ny,nx;\n\tdouble sum=0.0;\n\tfor(int i=0;i<4;i++){\n\t    ny=y+dy[i];\n\t    nx=x+dx[i];\n\t    if(inField(ny,nx)==false||t[ny][nx]==-1){\n\t\tsum+=solve(y,x,cnt+1);\n\t    }else{\n\t\tsum+=solve(ny,nx,cnt+1);\n\t    }\n\t}\n\tsum=sum/4.0;\n\tmem[y][x][cnt]=sum;\n\treturn sum;\n    }\n\n    public static void main(String[] args){\n\tScanner scan = new Scanner(System.in);\n\tString ch;\n\twhile(true){\n\t    n=scan.nextInt();\n\n\t    if(n==0)break;\n\t    for(int i=0;i<3;i++){\n\t\tfor(int j=0;j<3;j++){\n\t\t    for(int k=0;k<16;k++)mem[i][j][k]=200.0;\n\t\t    t[i][j]=0;\n\t\t}\n\t    }\n\n\t    ch=scan.next();\n\t    sy=change(ch)/3;\n\t    sx=change(ch)%3;\n\n\t    ch=scan.next();\n\t    gy=change(ch)/3;\n\t    gx=change(ch)%3;\n\n\t    ch=scan.next();\n\t    ky=change(ch)/3;\n\t    kx=change(ch)%3;\n\n\t    /*\n\t    System.out.println(sy+\" \"+sx);\n\t    System.out.println(gy+\" \"+gx);\n\t    System.out.println(ky+\" \"+kx);\n\t    */\n\t    t[gy][gx]=1;\n\t    t[ky][kx]=-1;\n\t    System.out.println(solve(sy,sx,0));\n\n\t}\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.InputStreamReader;\n\nclass Main{\n\tstatic double before[][];\n\tstatic double after[][];\n\tstatic boolean souko[][];\n\tpublic static void main(String args[]){\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\ttry{\n\t\t\twhile(true){\n\t\t\t\tint n = Integer.parseInt(br.readLine());\n\t\t\t\tif(n == 0) return;\n\n\t\t\t\tString strs[] = br.readLine().split(\" \");\n\t\t\t\tchar s = strs[0].charAt(0);\n\t\t\t\tchar t = strs[1].charAt(0);\n\t\t\t\tchar b = strs[2].charAt(0);\n\n\t\t\t\tbefore = new double[3][3];\n\t\t\t\tsouko = new boolean[3][3];\n\n\t\t\t\tint bs[] = charToInts(b);\n\t\t\t\tsouko[bs[0]][bs[1]] = true;\n\t\t\t\t//print(souko);\n\n\t\t\t\tint ss[] = charToInts(s);\n\t\t\t\tbefore[ss[0]][ss[1]] = 1.0;\n\t\t\t\t//print(before);\n\n\t\t\t\tfor(int i = 0; i < n; i++){\n\t\t\t\t\tafter = new double[3][3];\n\t\t\t\t\tcalc();\n\t\t\t\t\tbefore = after;\n\t\t\t\t\t//print(before);\n\t\t\t\t}\n\n\t\t\t\tint ts[] = charToInts(t);\n\t\t\t\tSystem.out.println(before[ts[0]][ts[1]]);\n\t\t\t}\n\t\t}catch(Exception e){\n\t\t}\n\t}\n\n\tstatic void calc(){\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tdouble p = before[i][j] * 0.25;\n\t\t\t\t// ←\n\t\t\t\tif(j == 0 || souko[i][j-1]){\n\t\t\t\t\tafter[i][j] += p;\n\t\t\t\t}else{\n\t\t\t\t\tafter[i][j-1] += p;\n\t\t\t\t}\n\n\t\t\t\t// ↑\n\t\t\t\tif(i == 0 || souko[i-1][j]){\n\t\t\t\t\tafter[i][j] += p;\n\t\t\t\t}else{\n\t\t\t\t\tafter[i-1][j] += p;\n\t\t\t\t}\n\n\t\t\t\t// →\n\t\t\t\tif(j == 2 || souko[i][j+1]){\n\t\t\t\t\tafter[i][j] += p;\n\t\t\t\t}else{\n\t\t\t\t\tafter[i][j+1] += p;\n\t\t\t\t}\n\n\t\t\t\t// ↓\n\t\t\t\tif(i == 2 || souko[i+1][j]){\n\t\t\t\t\tafter[i][j] += p;\n\t\t\t\t}else{\n\t\t\t\t\tafter[i+1][j] += p;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic int[] charToInts(char c){\n\t\tint m = c - 'A';\n\t\t//System.out.println(m);\n\t\tint result[] = {m / 3, m % 3};\n\t\t//System.out.println(\"(\" + result[0] + \", \" + result[1] + \")\");\n\t\treturn result;\n\t}\n\n\tstatic void print(double m[][]){\n\t\tfor(int i = 0; i < m.length; i++){\n\t\t\tfor(int j = 0; j < m[i].length; j++){\n\t\t\t\tSystem.out.print(m[i][j] + \"\\t\");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tstatic void print(boolean m[][]){\n\t\tfor(int i = 0; i < m.length; i++){\n\t\t\tfor(int j = 0; j < m[i].length; j++){\n\t\t\t\tSystem.out.print(m[i][j] + \"\\t\");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.text.DecimalFormat;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\tstatic final DecimalFormat df = new DecimalFormat(\"0.0000000000\");\n\tstatic final int A = 0, B = 1, C = 2, D = 3, E = 4, F = 5, G = 6, H = 7,\n\t\t\tI = 8;\n\tstatic final int[][] rooms = {\n\t\t\t//\n\t\t\t{ A, D, B, A }, { B, E, C, A }, { C, F, C, B },//\n\t\t\t{ A, G, E, D }, { B, H, F, D }, { C, I, F, E },//\n\t\t\t{ D, G, H, G }, { E, H, I, G }, { F, I, I, H } };\n\n\tpublic static void main(String[] args) {\n\t\tfinal double pow = Math.pow(4, 15);\n\t\tSystem.out.println(df.format(pow));\n\t\tSystem.out.println((int) pow);\n\t\tScanner in = new Scanner(System.in);\n\t\tint n;\n\t\tint[] now = new int[9];\n\t\tint[] next = new int[9];\n\t\twhile ((n = in.nextInt()) > 0) {\n\t\t\tArrays.fill(now, 0);\n\t\t\tArrays.fill(next, 0);\n\t\t\tint s = in.next().charAt(0) - 'A';\n\t\t\tnow[s] = 1;\n\t\t\tint t = in.next().charAt(0) - 'A';// 充電器\n\t\t\tint b = in.next().charAt(0) - 'A';// 入れない\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tfor (int room = 0; room < 9; room++) {\n\t\t\t\t\tint val = now[room];\n\t\t\t\t\tfor (int arrow = 0; arrow < 4; arrow++) {\n\t\t\t\t\t\tif (rooms[room][arrow] != b)\n\t\t\t\t\t\t\tnext[rooms[room][arrow]] += val;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tnext[room] += val;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tint[] memo = now;\n\t\t\t\tnow = next;\n\t\t\t\tnext = memo;\n\t\t\t\tArrays.fill(next, 0);\n\t\t\t}\n\t\t\tSystem.out.println(df.format(now[t] / Math.pow(4, n)));\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\tfinal static byte nexts[][] = {\n\t\t\t// 東,西,南,北\n\t\t\t{ 1, -1, 3, -1 },// 0:A\n\t\t\t{ 2, 0, 4, -1 }, // 1:B\n\t\t\t{ -1, 1, 5, -1 },// 2:C\n\t\t\t{ 4, -1, 6, 0 }, // 3:D\n\t\t\t{ 5, 3, 7, 1 }, // 4:E\n\t\t\t{ -1, 4, 8, 2 }, // 5:F\n\t\t\t{ 7, -1, -1, 3 },// 6:G\n\t\t\t{ 8, 6, -1, 4 }, // 7:H\n\t\t\t{ -1, 7, -1, 5 } // 8:I\n\t};\n\tfinal static byte distances[][] = {\n\t\t\t// A,B, C, D, E, F, G, H, I\n\t\t\t{ 0, 1, 2, 1, 2, 3, 2, 3, 4 },// 0:A\n\t\t\t{ 1, 0, 1, 2, 1, 2, 3, 2, 3 },// 1:B\n\t\t\t{ 2, 1, 0, 3, 2, 1, 4, 3, 2 },// 2:C\n\t\t\t{ 1, 2, 3, 0, 1, 2, 1, 2, 3 },// 3:D\n\t\t\t{ 2, 1, 2, 1, 0, 1, 2, 1, 2 },// 4:E\n\t\t\t{ 3, 2, 1, 2, 1, 0, 3, 2, 1 },// 5:F\n\t\t\t{ 2, 3, 4, 1, 2, 3, 0, 1, 2 },// 6:G\n\t\t\t{ 3, 2, 3, 2, 1, 2, 1, 0, 1 },// 7:H\n\t\t\t{ 4, 3, 2, 3, 2, 1, 2, 1, 0 } // 8:I\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic int probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tbyte battery;\n\t\t\tbyte start;\n\n\t\t\tbattery = Byte.parseByte(line);\n\t\t\tif (battery == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1 << battery * 2);\n\t\t\tSystem.out.println(probability * Math.pow(4, -battery));\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, int p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t} else if (distance(current, charger) <= battery) {\n\t\t\tfor (byte n : next(current)) {\n\t\t\t\tif (n > -1) {\n\t\t\t\t\tif (n == storeroom) {\n\t\t\t\t\t\tclean(current, battery - 1, p >> 2);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclean(n, battery - 1, p >> 2);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\treturn nexts[current];\n\t}\n\n\tstatic byte distance(byte current, byte charger) {\n\t\treturn distances[current][charger];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Iterator;\nimport java.util.LinkedList;\nimport java.util.Scanner;\n \n \npublic class Main {\n     \n    public static void main(String[] args) {\n        Scanner sc = new Scanner(System.in);\n        \n        while(true){\n        \tfinal int n = sc.nextInt();\n        \t\n        \tif(n == 0){\n        \t\tbreak;\n        \t}\n        \t\n        \tdouble[] pos = new double[9];\n        \t\n        \tfor(int i = 0; i < 9; i++){\n        \t\tpos[i] = 0;\n        \t}\n        \t\n        \tfinal int start = sc.next().toCharArray()[0] - 'A';\n        \tfinal int end = sc.next().toCharArray()[0] - 'A';\n        \tfinal int not = sc.next().toCharArray()[0] - 'A';\n        \t\n        \tpos[start] = 1;\n        \t\n        \tdouble[] next = new double[9];\n        \t\n        \tfor(int i = 0; i < n; i++){\n        \t\t\n        \t\tfor(int j = 0; j < 9; j++){\n        \t\t\tnext[j] = 0;\n        \t\t}\n        \t\t\n        \t\t//System.out.println(Arrays.toString(pos));\n        \t\t\n        \t\tfor(int j = 0; j < 9; j++){\n        \t\t\tif(j % 3 != 0){\n        \t\t\t\tif(not != j-1){\n        \t\t\t\t\tnext[j-1] += pos[j] / 4;\n        \t\t\t\t}\n        \t\t\t}\n        \t\t\t\n        \t\t\tif(j % 3 != 2){\n        \t\t\t\tif(not != j+1){\n        \t\t\t\t\tnext[j+1] += pos[j] / 4;\n        \t\t\t\t}\n        \t\t\t}\n        \t\t\t\n        \t\t\tif(j / 3 != 0){\n        \t\t\t\tif(not != j-3){\n        \t\t\t\t\tnext[j-3] += pos[j] / 4;\n        \t\t\t\t}\n        \t\t\t}\n        \t\t\t\n        \t\t\tif(j / 3 != 2){\n        \t\t\t\tif(not != j+3){\n        \t\t\t\t\tnext[j+3] += pos[j] / 4;\n        \t\t\t\t}\n        \t\t\t}\n        \t\t}\n        \t\t\n        \t\tdouble[] tmp = next;\n        \t\tnext = pos;\n        \t\tpos = tmp;\n        \t}\n        \t//System.out.println(Arrays.toString(pos));\n        \tSystem.out.println(pos[end]);\n        }\n    }\n \n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nclass Main{\n\n    static int n;\n    static int [][] t = new int[3][3];\n    static int dy[] = {-1,0,1,0};\n    static int dx[] = {0,1,0,-1};\n    static int sx,sy,gx,gy,kx,ky;\n\n    static int change(String ch){\n\tif(ch.equals(\"A\"))return 0;\n\tif(ch.equals(\"B\"))return 1;\n\tif(ch.equals(\"C\"))return 2;\n\tif(ch.equals(\"D\"))return 3;\n\tif(ch.equals(\"E\"))return 4;\n\tif(ch.equals(\"F\"))return 5;\n\tif(ch.equals(\"G\"))return 6;\n\tif(ch.equals(\"H\"))return 7;\n\tif(ch.equals(\"I\"))return 8;\n\telse return -1;\n    }\n\n    static boolean inField(int y,int x){\n\tif(y<0||x<0)return false;\n\tif(y>2||x>2)return false;\n\treturn true;\n    }\n    \n    static double [][][] mem = new double[3][3][16];\n\n    static double solve(int y,int x,int cnt){\n\tif(mem[y][x][cnt]!=200.0)return mem[y][x][cnt];\n\tif(cnt==n){\n\t    if(t[y][x]==1)return 1.0;\n\t    else return 0.0;\n\t}\n\t\n\tint ny,nx;\n\tdouble sum=0.0;\n\tfor(int i=0;i<4;i++){\n\t    ny=y+dy[i];\n\t    nx=x+dx[i];\n\t    if(inField(ny,nx)==false||t[ny][nx]==-1){\n\t\tsum+=solve(y,x,cnt+1);\n\t    }else{\n\t\tsum+=solve(ny,nx,cnt+1);\n\t    }\n\t}\n\tsum=sum/4.0;\n\tmem[y][x][cnt]=sum;\n\treturn sum;\n    }\n\n    public static void main(String[] args){\n\tScanner scan = new Scanner(System.in);\n\tString ch;\n\twhile(true){\n\t    n=scan.nextInt();\n\n\t    if(n==0)break;\n\t    for(int i=0;i<3;i++){\n\t\tfor(int j=0;j<3;j++){\n\t\t    for(int k=0;k<15;k++)mem[i][j][k]=200.0;\n\t\t    t[i][j]=0;\n\t\t}\n\t    }\n\n\t    ch=scan.next();\n\t    sy=change(ch)/3;\n\t    sx=change(ch)%3;\n\n\t    ch=scan.next();\n\t    gy=change(ch)/3;\n\t    gx=change(ch)%3;\n\n\t    ch=scan.next();\n\t    ky=change(ch)/3;\n\t    kx=change(ch)%3;\n\n\t    /*\n\t    System.out.println(sy+\" \"+sx);\n\t    System.out.println(gy+\" \"+gx);\n\t    System.out.println(ky+\" \"+kx);\n\t    */\n\t    t[gy][gx]=1;\n\t    t[ky][kx]=-1;\n\t    System.out.println(solve(sy,sx,0));\n\n\t}\n    }\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\n\nimport java.util.*;\nimport java.math.*;\n\nimport static java.lang.Math.*;\nimport static java.util.Arrays.*;\nimport static java.util.Collections.*;\nimport static java.math.BigInteger.*;\nimport static java.lang.Character.*;\n\nclass AOJ1020 {\n\tint[] di = { +1, -1, +3, -3 };\n\n\tpublic void run() {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tif (n == 0)\n\t\t\t\treturn;\n\t\t\tint s = sc.next().charAt(0) - 'A';\n\t\t\tint t = sc.next().charAt(0) - 'A';\n\t\t\tint b = sc.next().charAt(0) - 'A';\n\n\t\t\tdouble[] prob = new double[9];\n\t\t\tdouble[][] move = new double[9][9];\n\t\t\tfor (int i = 0; i < 9; i++)\n\t\t\t\tfor (int d = 0; d < 4; d++) {\n\t\t\t\t\tint j = (!isValidMove(i, d) || i + di[d] == b) ? i : i + di[d];\n\t\t\t\t\tmove[j][i] += .25;\n\t\t\t\t}\n\n\t\t\tprob[s] = 1.;\n\t\t\tfor (int k = 0; k < n; k++) {\n\t\t\t\tdouble[] np = new double[9];\n\t\t\t\tfor (int i = 0; i < 9; i++)\n\t\t\t\t\tfor (int j = 0; j < 9; j++)\n\t\t\t\t\t\tnp[i] += move[i][j] * prob[j];\n\t\t\t\tprob = np;\n\t\t\t}\n\t\t\tSystem.out.println(prob[t]);\n\t\t}\n\t}\n\n\tboolean isValidMove(int i, int d) {\n\t\tswitch (d) {\n\t\tcase 0:\n\t\t\treturn i % 3 < 2;\n\t\tcase 1:\n\t\t\treturn i % 3 > 0;\n\t\tcase 2:\n\t\t\treturn i < 6;\n\t\tcase 3:\n\t\t\treturn i > 2;\n\t\t}\n\t\treturn false;\n\t}\n}\n\npublic class Main {\n\tpublic static void main(String... args) {\n\t\tnew AOJ1020().run();\n\t}\n\n\tpublic static void debug(Object... os) {\n\t\tSystem.err.println(java.util.Arrays.deepToString(os));\n\t}\n}\n\nclass Scanner {\n\tfinal java.util.Scanner sc;\n\n\tpublic double nextDouble() {\n\t\treturn Double.parseDouble(sc.next());\n\t}\n\n\tpublic Scanner(java.io.InputStream is) {\n\t\tthis.sc = new java.util.Scanner(is);\n\t}\n\n\tpublic boolean hasNext() {\n\t\treturn sc.hasNext();\n\t}\n\n\tpublic String next() {\n\t\treturn sc.next();\n\t}\n\n\tpublic int nextInt() {\n\t\treturn Integer.parseInt(sc.next());\n\t}\n\n\tpublic String nextLine() {\n\t\treturn sc.nextLine();\n\t}\n\n\tpublic long nextLong() {\n\t\treturn Long.parseLong(sc.next());\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tScanner in = new Scanner(System.in);\n\tpublic static void main(String[] args) {\n\t\tnew Main();\n\t}\n\n\tpublic Main() {\n\t\tnew AOJ1020().doIt();\n\t}\n\n\tclass AOJ1020{\n\t\tint[][][] dp;\n\t\tvoid print(int b){\n\t\t\tSystem.out.println();\n\t\t\tfor(int i=0;i<3;i++){\n\t\t\t\tfor(int j=0;j<3;j++)System.out.print(dp[i][j][b]+\" \");\n\t\t\t\tSystem.out.println();\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tvoid doIt(){\n\t\t\tHashMap<Character,Point> map = new HashMap<Character,Point>();\n\t\t\tmap.put('A',new Point(0, 0));\n\t\t\tmap.put('B',new Point(1, 0));\n\t\t\tmap.put('C',new Point(2, 0));\n\t\t\tmap.put('D',new Point(0, 1));\n\t\t\tmap.put('E',new Point(1, 1));\n\t\t\tmap.put('F',new Point(2, 1));\n\t\t\tmap.put('G',new Point(0, 2));\n\t\t\tmap.put('H',new Point(1, 2));\n\t\t\tmap.put('I',new Point(2, 2));\n\t\t\tint sx[] = {1,0,-1,0};\n\t\t\tint sy[] = {0,1,0,-1};\n\t\t\twhile(true){\n\t\t\t\tint n = in.nextInt();\n\t\t\t\tif(n==0)break;\n\t\t\t\tchar s = in.next().charAt(0);\n\t\t\t\tchar t = in.next().charAt(0);\n\t\t\t\tchar b = in.next().charAt(0);\n\t\t\t\tPoint bad = map.get(b);\n\t\t\t\tdp = new int[3][3][n+2];\n\t\t\t\tdp[map.get(s).y][map.get(s).x][0] = 1;\n\t\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\t\tfor(int y=0;y<3;y++)for(int x=0;x<3;x++)if(dp[y][x][i]>0){\n\t\t\t\t\t\tfor(int j=0;j<4;j++){\n\t\t\t\t\t\t\tint nx = x+sx[j];\n\t\t\t\t\t\t\tint ny = y+sy[j];\n\t\t\t\t\t\t\tif(nx<0||nx>=3||ny<0||ny>=3)dp[y][x][i+1]++;\n\t\t\t\t\t\t\telse if(bad.x==nx&&bad.y==ny)dp[y][x][i+1]++;\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tdp[ny][nx][i+1]++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n//\t\t\t\t\tprint(i);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdouble sum = 0;\n\t\t\t\tdouble goal = dp[map.get(t).y][map.get(t).x][n];\n\t\t\t\tfor(int i=0;i<3;i++)for(int k=0;k<3;k++)sum+=dp[i][k][n];\n\t\t\t\tSystem.out.printf(\"%.8f\\n\",goal/sum);\n\t\t\t}\n\t\t}\n\t\tclass Point{\n\t\t\tint x,y;\n\t\t\tpublic Point(int x,int y) {\n\t\t\t\tthis.x = x;\n\t\t\t\tthis.y = y;\n\t\t\t}\n\t\t}\n\n\t}\n\n\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.IOException;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) throws IOException {\n\n\t\tnew Main().run();\n\t}\n\n\tprivate void run() throws IOException {\n\t\tScanner scanner = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint n = scanner.nextInt();\n\t\t\tif (n == 0)\n\t\t\t\tbreak;\n\t\t\tint[] xs = new int[3];\n\t\t\tint[] ys = new int[3];\n\t\t\tfor (int i = 0; i < 3; i++) {\n\t\t\t\tint a = scanner.next().charAt(0) - 'A';\n\t\t\t\txs[i] = a % 3;\n\t\t\t\tys[i] = a / 3;\n\t\t\t}\n\t\t\tdouble[][][] dp = new double[2][3][3];\n\t\t\tint u = 0;\n\t\t\tdp[u][ys[0]][xs[0]] = 1;\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tfor (int y = 0; y < 3; y++) {\n\t\t\t\t\tfor (int x = 0; x < 3; x++) {\n\t\t\t\t\t\tfor (int[] m : move) {\n\t\t\t\t\t\t\tint nx = x + m[0];\n\t\t\t\t\t\t\tint ny = y + m[1];\n\t\t\t\t\t\t\tif (nx == xs[2] && ny == ys[2] || nx < 0 || 2 < nx\n\t\t\t\t\t\t\t\t\t|| ny < 0 || 2 < ny)\n\t\t\t\t\t\t\t\tdp[1 - u][y][x] += dp[u][y][x] / 4;\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tdp[1 - u][ny][nx] += dp[u][y][x] / 4;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdp[u][y][x] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tu = 1 - u;\n\t\t\t}\n\t\t\tSystem.out.printf(\"%.8f\\n\", dp[u][ys[1]][xs[1]]);\n\t\t}\n\t}\n\n\tint[][] move = { { -1, 0 }, { 0, -1 }, { 0, 1 }, { 1, 0 } };\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tScanner in = new Scanner(System.in);\n\tpublic static void main(String[] args) {\n\t\tnew Main();\n\t}\n\n\tpublic Main() {\n\t\tnew AOJ1020().doIt();\n\t}\n\n\tclass AOJ1020{\n\t\tint[][][] dp;\n\t\tvoid print(int b){\n\t\t\tSystem.out.println();\n\t\t\tfor(int i=0;i<3;i++){\n\t\t\t\tfor(int j=0;j<3;j++)System.out.print(dp[i][j][b]+\" \");\n\t\t\t\tSystem.out.println();\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tvoid doIt(){\n\t\t\tHashMap<Character,Point> map = new HashMap<Character,Point>();\n\t\t\tmap.put('A',new Point(0, 0));\n\t\t\tmap.put('B',new Point(1, 0));\n\t\t\tmap.put('C',new Point(2, 0));\n\t\t\tmap.put('D',new Point(0, 1));\n\t\t\tmap.put('E',new Point(1, 1));\n\t\t\tmap.put('F',new Point(2, 1));\n\t\t\tmap.put('G',new Point(0, 2));\n\t\t\tmap.put('H',new Point(1, 2));\n\t\t\tmap.put('I',new Point(2, 2));\n\t\t\tint sx[] = {1,0,-1,0};\n\t\t\tint sy[] = {0,1,0,-1};\n\t\t\twhile(true){\n\t\t\t\tint n = in.nextInt();\n\t\t\t\tif(n==0)break;\n\t\t\t\tchar s = in.next().charAt(0);\n\t\t\t\tchar t = in.next().charAt(0);\n\t\t\t\tchar b = in.next().charAt(0);\n\t\t\t\tPoint bad = map.get(b);\n\t\t\t\tdp = new int[3][3][n+2];\n\t\t\t\tdp[map.get(s).y][map.get(s).x][0] = 1;\n\t\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\t\tfor(int y=0;y<3;y++)for(int x=0;x<3;x++)if(dp[y][x][i]>0){\n\t\t\t\t\t\tfor(int j=0;j<4;j++){\n\t\t\t\t\t\t\tint nx = x+sx[j];\n\t\t\t\t\t\t\tint ny = y+sy[j];\n\t\t\t\t\t\t\tif(nx<0||nx>=3||ny<0||ny>=3)dp[y][x][i+1]++;\n\t\t\t\t\t\t\telse if(bad.x==nx&&bad.y==ny)dp[y][x][i+1]++;\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tdp[ny][nx][i+1]++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n//\t\t\t\t\tprint(i);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdouble sum = 0;\n\t\t\t\tdouble goal = dp[map.get(t).y][map.get(t).x][n];\n\t\t\t\tfor(int i=0;i<3;i++)for(int k=0;k<3;k++)sum+=dp[i][k][n];\n\t\t\t\tif(sum==0||goal==0)System.out.println(\"0.00000000\");\n\t\t\t\telse System.out.printf(\"%.8f\\n\",goal/sum);\n\t\t\t}\n\t\t}\n\t\tclass Point{\n\t\t\tint x,y;\n\t\t\tpublic Point(int x,int y) {\n\t\t\t\tthis.x = x;\n\t\t\t\tthis.y = y;\n\t\t\t}\n\t\t}\n\n\t}\n\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\ttry {\n\t\t\tString line;\n\t\t\twhile(true){\n\t\t\t\t/* input */\n\t\t\t\tline = br.readLine();\n\n\t\t\t\tint n = Integer.parseInt(line);\n\n\t\t\t\tif(n==0) break;\n\t\t\t\t\n\t\t\t\tline = br.readLine();\n\t\t\t\t\n\t\t\t\tchar s = line.split(\" \")[0].charAt(0), t = line.split(\" \")[1].charAt(0), b = line.split(\" \")[2].charAt(0);\n\t\t\t\t\n\t\t\t\t/* processing */\n\t\t\t\tdouble ans = solve(n,s-'A',t-'A',b-'A');\n\t\t\t\t/* output */\n\t\t\t\tSystem.out.println(ans);\n\t\t\t}\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\t\n\tpublic static double solve(int n, int s, int t, int b){\n\t\tif(n==0){\n\t\t\tif(s==t){\n\t\t\t\treturn 1.0;\n\t\t\t} else {\n\t\t\t\treturn 0.0;\n\t\t\t}\n\t\t} else {\n\t\t\tdouble ret = 0;\n\t\t\tret += solve(n-1,s>2&&b!=s-3?s-3:s,t,b);\n\t\t\tret += solve(n-1,s%3!=2&&b!=s+1?s+1:s,t,b);\n\t\t\tret += solve(n-1,s<6&&b!=s+3?s+3:s,t,b);\n\t\t\tret += solve(n-1,s%3!=0&&b!=s-1?s-1:s,t,b);\n\t\t\t\n\t\t\treturn 0.25*ret;\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.InputStreamReader;\n\nclass Main{\n\tstatic double before[][];\n\tstatic double after[][];\n\tstatic boolean souko[][];\n\tpublic static void main(String args[]){\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\ttry{\n\t\t\twhile(true){\n\t\t\t\tint n = Integer.parseInt(br.readLine());\n\t\t\t\tif(n == 0) return;\n\n\t\t\t\tString strs[] = br.readLine().split(\" \");\n\t\t\t\tchar s = strs[0].charAt(0);\n\t\t\t\tchar t = strs[1].charAt(0);\n\t\t\t\tchar b = strs[2].charAt(0);\n\n\t\t\t\tbefore = new double[3][3];\n\t\t\t\tsouko = new boolean[3][3];\n\n\t\t\t\tint bs[] = charToInts(b);\n\t\t\t\tsouko[bs[0]][bs[1]] = true;\n\t\t\t\t//print(souko);\n\n\t\t\t\tint ss[] = charToInts(s);\n\t\t\t\tbefore[ss[0]][ss[1]] = 1.0;\n\t\t\t\t//print(before);\n\n\t\t\t\tfor(int i = 0; i < n; i++){\n\t\t\t\t\tafter = new double[3][3];\n\t\t\t\t\tcalc();\n\t\t\t\t\tbefore = after;\n\t\t\t\t\t//print(before);\n\t\t\t\t}\n\n\t\t\t\tint ts[] = charToInts(t);\n\t\t\t\tSystem.out.println(before[ts[0]][ts[1]]);\n\t\t\t}\n\t\t}catch(Exception e){\n\t\t}\n\t}\n\n\tstatic void calc(){\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tdouble p = before[i][j] * 0.25;\n\t\t\t\t// ←\n\t\t\t\tif(j == 0 || souko[i][j-1]){\n\t\t\t\t\tafter[i][j] += p;\n\t\t\t\t}else{\n\t\t\t\t\tafter[i][j-1] += p;\n\t\t\t\t}\n\n\t\t\t\t// ↑\n\t\t\t\tif(i == 0 || souko[i-1][j]){\n\t\t\t\t\tafter[i][j] += p;\n\t\t\t\t}else{\n\t\t\t\t\tafter[i-1][j] += p;\n\t\t\t\t}\n\n\t\t\t\t// →\n\t\t\t\tif(j == 2 || souko[i][j+1]){\n\t\t\t\t\tafter[i][j] += p;\n\t\t\t\t}else{\n\t\t\t\t\tafter[i][j+1] += p;\n\t\t\t\t}\n\n\t\t\t\t// ↓\n\t\t\t\tif(i == 2 || souko[i+1][j]){\n\t\t\t\t\tafter[i][j] += p;\n\t\t\t\t}else{\n\t\t\t\t\tafter[i+1][j] += p;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic int[] charToInts(char c){\n\t\tint m = c - 'A';\n\t\tSystem.out.println(m);\n\t\tint result[] = {m / 3, m % 3};\n\t\tSystem.out.println(\"(\" + result[0] + \", \" + result[1] + \")\");\n\t\treturn result;\n\t}\n\n\tstatic void print(double m[][]){\n\t\tfor(int i = 0; i < m.length; i++){\n\t\t\tfor(int j = 0; j < m[i].length; j++){\n\t\t\t\tSystem.out.print(m[i][j] + \"\\t\");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tstatic void print(boolean m[][]){\n\t\tfor(int i = 0; i < m.length; i++){\n\t\t\tfor(int j = 0; j < m[i].length; j++){\n\t\t\t\tSystem.out.print(m[i][j] + \"\\t\");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigDecimal;\nimport java.util.*;\nimport static java.util.Arrays.*;\nimport static java.lang.Math.*;\n\nclass Main {\n\tstatic Scanner sc = new Scanner(System.in);\n\tstatic int n;\n\tstatic char s, t, b;\n\tstatic int[] dx = {-1, 0, 1, 0}, dy = {0, -1, 0, 1};\n\t\n\tpublic static void main(String[] args) {\n\t\twhile (read()) {\n\t\t\tsolve();\n\t\t}\n\t}\n\n\tstatic boolean read() {\n\t\tn = sc.nextInt();\n\t\tif (n == 0) return false;\n\t\t\n\t\ts = sc.next().charAt(0);\n\t\tt = sc.next().charAt(0);\n\t\tb = sc.next().charAt(0);\n\t\t\n\t\treturn true;\n\t}\n\n\tstatic void solve() {\n\t\tdouble[][][] dp = new double[n + 1][5][5];\n\t\tfor (int i = 0; i <= n; i++) { \n\t\t\tfor (int j = 0; j < 5; j++) {\n\t\t\t\tfor (int k = 0; k < 5; k++) {\n\t\t\t\t\tdp[i][j][k] = 0.0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t\tint pos_s = s - 'A', pos_t = t - 'A', pos_b = b - 'A';\n\t\tint sx = pos_s % 3 + 1, sy = pos_s / 3 + 1;\n\t\tint gx = pos_t % 3 + 1, gy = pos_t / 3 + 1;\n\t\tint bx = pos_b % 3 + 1, by = pos_b / 3 + 1;\n\t\t\n\t\tdp[n][sy][sx] = 1.0;\n\t\t\n\t\tfor (int i = n; i > 0; i--) {\n\t\t\tfor (int y = 1; y <= 3; y++) {\n\t\t\t\tfor (int x = 1; x <= 3; x++) {\n\t\t\t\t\tfor (int l = 0; l < 4; l++) {\n\t\t\t\t\t\tint ty = y + dy[l], tx = x + dx[l];\n\t\t\t\t\t\tif (((ty == by) && (tx == bx)) || (tx == 0 || tx == 4 || ty == 0 || ty == 4)){\n\t\t\t\t\t\t\tty = y; tx = x;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdp[i - 1][ty][tx] += dp[i][y][x] * 0.25; \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tSystem.out.printf(\"%.8f\", dp[0][gy][gx]);\n\t\tSystem.out.println();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\n/**\n * Cleaning Robot\n *  URL:http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1020&lang=jp\n *\n * @author Igari Kazuya\n *\n */\npublic class Main {\n\n\t/**\n\t * @param args\n\t */\n\tpublic static void main(String[] args) {\n\t\t// TODO ツ篠ゥツ督ョツ青カツ青ャツつウツづェツつスツδソツッツドツ・ツスツタツブ\n\t\tScanner sc = new Scanner(System.in);\n\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\n\t\t\tif(n == 0){\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tString s,t,b;\n\t\t\ts = sc.next();\n\t\t\tt = sc.next();\n\t\t\tb = sc.next();\n\n\t\t\tint[][] map = new int[5][5];\n\t\t\tint[][] scoremap = new int[3][3];\n\t\t\tint[][] bufmap = new int[3][3];\n\t\t\tfor(int i=0;i<3;i++){\n\t\t\t\tfor(int j=0;j<3;j++){\n\t\t\t\t\tscoremap[i][j] = 0;\n\t\t\t\t\tbufmap[i][j] = 0;\n\t\t\t\t\tmap[i+1][j+1] = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor(int i=0;i<5;i++){\n\t\t\t\tmap[i][0] = 1;\n\t\t\t\tmap[0][i] = 1;\n\t\t\t\tmap[i][4] = 1;\n\t\t\t\tmap[4][i] = 1;\n\t\t\t}\n\n\t\t\tint ss = s.charAt(0) - 'A';\n\t\t\tint tt = t.charAt(0) - 'A';\n\t\t\tint bb = b.charAt(0) - 'A';\n\n\t\t\tmap[bb/3+1][bb%3+1] = 1;\n\t\t\tscoremap[ss/3][ss%3] = 1;//ツ機ツ械ツつソツづ。ツづア\n\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\t\tfor(int x=0;x<3;x++){\n\t\t\t\t\t\tif(map[y+1][x] == 0){\n\t\t\t\t\t\t\tbufmap[y][x-1] += scoremap[y][x];\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tbufmap[y][x] += scoremap[y][x];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif(map[y+1][x+2] == 0){\n\t\t\t\t\t\t\tbufmap[y][x+1] += scoremap[y][x];\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tbufmap[y][x] += scoremap[y][x];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif(map[y][x+1] == 0){\n\t\t\t\t\t\t\tbufmap[y-1][x] += scoremap[y][x];\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tbufmap[y][x] += scoremap[y][x];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif(map[y+2][x+1] == 0){\n\t\t\t\t\t\t\tbufmap[y+1][x] += scoremap[y][x];\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tbufmap[y][x] += scoremap[y][x];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int x=0;x<3;x++){\n\t\t\t\t\tfor(int y=0;y<3;y++){\n\t\t\t\t\t\tscoremap[y][x] = bufmap[y][x];\n\t\t\t\t\t\tbufmap[y][x] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tint count=0;\n\t\t\tfor(int i=0;i<3;i++){\n\t\t\t\tfor(int j=0;j<3;j++){\n\t\t\t\t\tcount += scoremap[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.printf(\"%.8f\\n\",(double)scoremap[tt/3][tt%3]/(double)count);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\t// 東,西,南,北\n\tfinal static byte nexts[][] = {//\n\t{ 1, -1, 3, -1 },// 0\n\t\t\t{ 2, 0, 4, -1 },// 1\n\t\t\t{ -1, 1, 5, -1 },// 2\n\t\t\t{ 4, -1, 6, 0 },// 3\n\t\t\t{ 5, 3, 7, 1 },// 4\n\t\t\t{ -1, 4, 8, 2 },// 5\n\t\t\t{ 7, -1, -1, 3 },// 6\n\t\t\t{ 8, 6, -1, 4 },// 7\n\t\t\t{ -1, 7, -1, 5 },// 8\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic double probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\tbyte battery;\n\t\tbyte start;\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tif ((battery = Byte.parseByte(line)) == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1);\n\t\t\tSystem.out.println(probability);\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, double p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif (battery == 1) {\n\t\t\tboolean b = false;\n\t\t\tfor (byte n : next(current)) {\n\t\t\t\tb |= (n == charger);\n\t\t\t}\n\t\t\tif (!b)\n\t\t\t\treturn;\n\t\t} else {\n\t\t\tfor (byte n : next(current)) {\n\t\t\t\tif (n < 0 || n == storeroom) {\n\t\t\t\t\tclean(current, battery - 1, p / 4);\n\t\t\t\t} else {\n\t\t\t\t\tclean(n, battery - 1, p / 4);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\tbyte[] result = null;\n\n\t\tswitch (current) {\n\t\tcase 0:\n\t\t\tresult = nexts[0];\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tresult = nexts[1];\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tresult = nexts[2];\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tresult = nexts[3];\n\t\t\tbreak;\n\t\tcase 4:\n\t\t\tresult = nexts[4];\n\t\t\tbreak;\n\t\tcase 5:\n\t\t\tresult = nexts[5];\n\t\t\tbreak;\n\t\tcase 6:\n\t\t\tresult = nexts[6];\n\t\t\tbreak;\n\t\tcase 7:\n\t\t\tresult = nexts[7];\n\t\t\tbreak;\n\t\tcase 8:\n\t\t\tresult = nexts[8];\n\t\t\tbreak;\n\t\t}\n\t\treturn result;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.Arrays;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\ttry {\n\t\t\tString line;\n\t\t\twhile(true){\n\t\t\t\t/* input */\n\t\t\t\tline = br.readLine();\n\n\t\t\t\tint n = Integer.parseInt(line);\n\n\t\t\t\tif(n==0) break;\n\n\t\t\t\tline = br.readLine();\n\n\t\t\t\tchar s = line.split(\" \")[0].charAt(0), t = line.split(\" \")[1].charAt(0), b = line.split(\" \")[2].charAt(0);\n\n\t\t\t\t/* processing */\n\t\t\t\tdouble dp[][][][] = new double[15][9][9][9];\n\t\t\t\tfor(int i=0;i<15;i++){\n\t\t\t\t\tfor(int j=0;j<9;j++){\n\t\t\t\t\t\tfor(int k=0;k<9;k++){\n\t\t\t\t\t\t\tfor(int l=0;l<9;l++){\n\t\t\t\t\t\t\t\tdp[i][j][k][l] = -1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tdouble ans = solve(dp, n,s-'A',t-'A',b-'A');\n\t\t\t\t/* output */\n\t\t\t\tSystem.out.println(ans);\n\t\t\t}\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\n\tpublic static double solve(double[][][][] dp, int n, int s, int t, int b){\n\t\tif(dp[n][s][t][b]>=0) return dp[n][s][t][b];\n\t\tif(n==0){\n\t\t\tif(s==t){\n\t\t\t\tdp[n][s][t][b] = 1.0;\n\t\t\t\treturn 1.0;\n\t\t\t} else {\n\t\t\t\tdp[n][s][t][b] = 0.0;\n\t\t\t\treturn 0.0;\n\t\t\t}\n\t\t} else {\n\t\t\tdouble ret = 0;\n\t\t\tif(dp[n-1][s>2&&b!=s-3?s-3:s][t][b]>=0){\n\t\t\t\tret += 0.25*dp[n-1][s>2&&b!=s-3?s-3:s][t][b];\n\t\t\t} else {\n\t\t\t\tdp[n-1][s>2&&b!=s-3?s-3:s][t][b] = solve(dp,n-1,s>2&&b!=s-3?s-3:s,t,b); \n\t\t\t\tret += 0.25*dp[n-1][s>2&&b!=s-3?s-3:s][t][b];\n\t\t\t}\n\t\t\tif(dp[n-1][s%3!=2&&b!=s+1?s+1:s][t][b]>=0){\n\t\t\t\tret += 0.25*dp[n-1][s%3!=2&&b!=s+1?s+1:s][t][b];\n\t\t\t} else {\n\t\t\t\tdp[n-1][s%3!=2&&b!=s+1?s+1:s][t][b] = solve(dp,n-1,s%3!=2&&b!=s+1?s+1:s,t,b); \n\t\t\t\tret += 0.25*dp[n-1][s%3!=2&&b!=s+1?s+1:s][t][b];\n\t\t\t}\n\t\t\tif(dp[n-1][s<6&&b!=s+3?s+3:s][t][b]>=0){\n\t\t\t\tret += 0.25*dp[n-1][s<6&&b!=s+3?s+3:s][t][b];\n\t\t\t} else {\n\t\t\t\tdp[n-1][s<6&&b!=s+3?s+3:s][t][b] = solve(dp,n-1,s<6&&b!=s+3?s+3:s,t,b);\n\t\t\t\tret += 0.25*dp[n-1][s<6&&b!=s+3?s+3:s][t][b];\n\t\t\t}\n\t\t\tif(dp[n-1][s%3!=0&&b!=s-1?s-1:s][t][b]>=0){\n\t\t\t\tret += 0.25*dp[n-1][s%3!=0&&b!=s-1?s-1:s][t][b];\n\t\t\t} else {\n\t\t\t\tdp[n-1][s%3!=0&&b!=s-1?s-1:s][t][b] =solve(dp,n-1,s%3!=0&&b!=s-1?s-1:s,t,b);\n\t\t\t\tret += 0.25*dp[n-1][s%3!=0&&b!=s-1?s-1:s][t][b];\n\t\t\t}\n\t\t\t\n\t\t\tdp[n][s][t][b] = ret;\n\t\t\treturn ret;\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tScanner in = new Scanner(System.in);\n\tpublic static void main(String[] args) {\n\t\tnew Main();\n\t}\n\n\tpublic Main() {\n\t\tnew AOJ1020().doIt();\n\t}\n\n\tclass AOJ1020{\n\t\tint[][][] dp;\n\t\tvoid print(int b){\n\t\t\tSystem.out.println();\n\t\t\tfor(int i=0;i<3;i++){\n\t\t\t\tfor(int j=0;j<3;j++)System.out.print(dp[i][j][b]+\" \");\n\t\t\t\tSystem.out.println();\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tvoid doIt(){\n\t\t\tHashMap<Character,Point> map = new HashMap<Character,Point>();\n\t\t\tmap.put('A',new Point(0, 0));\n\t\t\tmap.put('B',new Point(1, 0));\n\t\t\tmap.put('C',new Point(2, 0));\n\t\t\tmap.put('D',new Point(0, 1));\n\t\t\tmap.put('E',new Point(1, 1));\n\t\t\tmap.put('F',new Point(2, 1));\n\t\t\tmap.put('G',new Point(0, 2));\n\t\t\tmap.put('H',new Point(1, 2));\n\t\t\tmap.put('J',new Point(2, 2));\n\t\t\tint sx[] = {1,0,-1,0};\n\t\t\tint sy[] = {0,1,0,-1};\n\t\t\twhile(true){\n\t\t\t\tint n = in.nextInt();\n\t\t\t\tif(n==0)break;\n\t\t\t\tchar s = in.next().charAt(0);\n\t\t\t\tchar t = in.next().charAt(0);\n\t\t\t\tchar b = in.next().charAt(0);\n\t\t\t\tPoint bad = map.get(b);\n\t\t\t\tdp = new int[3][3][n+2];\n\t\t\t\tdp[map.get(s).y][map.get(s).x][0] = 1;\n\t\t\t\tfor(int i=0;i<=n;i++){\n\t\t\t\t\tfor(int y=0;y<3;y++)for(int x=0;x<3;x++)if(dp[y][x][i]>0){\n\t\t\t\t\t\tfor(int j=0;j<4;j++){\n\t\t\t\t\t\t\tint nx = x+sx[j];\n\t\t\t\t\t\t\tint ny = y+sy[j];\n\t\t\t\t\t\t\tif(nx<0||nx>=3||ny<0||ny>=3)dp[y][x][i+1]++;\n\t\t\t\t\t\t\telse if(bad.x==nx&&bad.y==ny)dp[y][x][i+1]++;\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tdp[ny][nx][i+1]++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n//\t\t\t\t\tprint(i);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdouble sum = 0;\n\t\t\t\tdouble goal = dp[map.get(t).y][map.get(t).x][n];\n\t\t\t\tfor(int i=0;i<3;i++)for(int k=0;k<3;k++)sum+=dp[i][k][n];\n\t\t\t\tif(sum==0||goal==0)System.out.println(\"0.00000000\");\n\t\t\t\telse System.out.printf(\"%.8f\\n\",goal/sum);\n\t\t\t}\n\t\t}\n\t\tclass Point{\n\t\t\tint x,y;\n\t\t\tpublic Point(int x,int y) {\n\t\t\t\tthis.x = x;\n\t\t\t\tthis.y = y;\n\t\t\t}\n\t\t}\n\n\t}\n\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\tfinal static byte nexts[][] = {\n\t\t\t// 東,西,南,北\n\t\t\t{ 1, -1, 3, -1 },// 0:A\n\t\t\t{ 2, 0, 4, -1 }, // 1:B\n\t\t\t{ -1, 1, 5, -1 },// 2:C\n\t\t\t{ 4, -1, 6, 0 }, // 3:D\n\t\t\t{ 5, 3, 7, 1 }, // 4:E\n\t\t\t{ -1, 4, 8, 2 }, // 5:F\n\t\t\t{ 7, -1, -1, 3 },// 6:G\n\t\t\t{ 8, 6, -1, 4 }, // 7:H\n\t\t\t{ -1, 7, -1, 5 } // 8:I\n\t};\n\tfinal static byte distances[][] = {\n\t\t\t// A,B, C, D, E, F, G, H, I\n\t\t\t{ 0, 1, 2, 1, 2, 3, 2, 3, 4 },// 0:A\n\t\t\t{ 1, 0, 1, 2, 1, 2, 3, 2, 3 },// 1:B\n\t\t\t{ 2, 1, 0, 3, 2, 1, 4, 3, 2 },// 2:C\n\t\t\t{ 1, 2, 3, 0, 1, 2, 1, 2, 3 },// 3:D\n\t\t\t{ 2, 1, 2, 1, 0, 1, 2, 1, 2 },// 4:E\n\t\t\t{ 3, 2, 1, 2, 1, 0, 3, 2, 1 },// 5:F\n\t\t\t{ 2, 3, 4, 1, 2, 3, 0, 1, 2 },// 6:G\n\t\t\t{ 3, 2, 3, 2, 1, 2, 1, 0, 1 },// 7:H\n\t\t\t{ 4, 3, 2, 3, 2, 1, 2, 1, 0 } // 8:I\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic int probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tbyte battery;\n\t\t\tbyte start;\n\n\t\t\tbattery = Byte.parseByte(line);\n\t\t\tif (battery == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1 << battery * 2);\n\t\t\tSystem.out.println(probability * Math.pow(4, -battery));\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, int p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t} else if (distance(current, charger) <= battery) {\n\t\t\tfor (byte n : next(current)) {\n\t\t\t\tif (n > -1) {\n\t\t\t\t\tif (n == storeroom) {\n\t\t\t\t\t\t// clean(current, battery, p);\n\t\t\t\t\t\tclean(n, battery - 3, p >> 8);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclean(n, battery - 1, p >> 2);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\treturn nexts[current];\n\t}\n\n\tstatic byte distance(byte current, byte charger) {\n\t\treturn distances[current][charger];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.math.*;\nimport java.awt.geom.*;\nimport java.io.*;\n      \n      \npublic class Main {\n\tstatic int[] vx = new int[]{0,1,0,-1};\n\tstatic int[] vy = new int[]{1,0,-1,0};\n\tstatic int[] Y  = new int[]{0,0,0,1,1,1,2,2,2};\n\tstatic int[] X  = new int[]{0,1,2,0,1,2,0,1,2};\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n == 0) break;\n\t\t\tchar s = sc.next().charAt(0);\n\t\t\tint S = s - 'A';\n\t\t\tchar t = sc.next().charAt(0);\n\t\t\tint T = t - 'A';\n\t\t\tchar b = sc.next().charAt(0);\n\t\t\tint B = b - 'A';\n\t\t\tdouble[][][] dp = new double[n+1][3][3];\n\t\t\tdp[0][Y[S]][X[S]] = 1.0;\n\t\t\tfor(int i = 0; i < n; i++) {\n\t\t\t\tfor(int j = 0; j < 3; j++) {\n\t\t\t\t\tfor(int k = 0; k < 3; k++) {\n\t\t\t\t\t\tfor(int l = 0; l < 4; l++) {\n\t\t\t\t\t\t\tint ty = j + vy[l];\n\t\t\t\t\t\t\tint tx = k + vx[l];\n\t\t\t\t\t\t\tif(ty < 0 || tx < 0 || tx >= 3 || ty >= 3 || (ty == Y[B] && tx == X[B])) {\n\t\t\t\t\t\t\t\tty = j;\n\t\t\t\t\t\t\t\ttx = k;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdp[i+1][ty][tx] += dp[i][j][k] / 4.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.printf(\"%.25f\",dp[n][Y[T]][X[T]]);\n\t\t\t\n\t\t}\n\t}\n }"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.IOException;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) throws IOException {\n\n\t\tnew Main().run();\n\t}\n\n\tprivate void run() throws IOException {\n\t\tScanner scanner = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint n = scanner.nextInt();\n\t\t\tif (n == 0)\n\t\t\t\tbreak;\n\t\t\tint[] xs = new int[3];\n\t\t\tint[] ys = new int[3];\n\t\t\tfor (int i = 0; i < 3; i++) {\n\t\t\t\tint a = scanner.next().charAt(0) - 'A';\n\t\t\t\txs[i] = a % 3;\n\t\t\t\tys[i] = a / 3;\n\t\t\t}\n\t\t\tdouble[][][] dp = new double[2][3][3];\n\t\t\tint u = 0;\n\t\t\tdp[u][xs[0]][ys[0]] = 1;\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tfor (int x = 0; x < 3; x++)\n\t\t\t\t\tfor (int y = 0; y < 3; y++)\n\t\t\t\t\t\tfor (int[] m : move) {\n\t\t\t\t\t\t\tint nx = x + m[0];\n\t\t\t\t\t\t\tint ny = y + m[1];\n\t\t\t\t\t\t\tif (nx == xs[2] && ny == ys[2] || nx < 0 || 2 < nx\n\t\t\t\t\t\t\t\t\t|| ny < 0 || 2 < ny)\n\t\t\t\t\t\t\t\tdp[1 - u][x][y] += dp[u][x][y] / 4;\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tdp[1 - u][nx][ny] += dp[u][x][y] / 4;\n\t\t\t\t\t\t}\n\t\t\t\tu = 1 - u;\n\t\t\t}\n\t\t\tSystem.out.printf(\"%.8f\\n\", dp[u][xs[1]][ys[1]]);\n\t\t}\n\t}\n\n\tint[][] move = { { -1, 0 }, { 0, -1 }, { 0, 1 }, { 1, 0 } };\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\tfinal static byte nexts[][] = {\n\t\t\t// 東,西,南,北\n\t\t\t{ 1, -1, 3, -1 },// 0:A\n\t\t\t{ 2, 0, 4, -1 }, // 1:B\n\t\t\t{ -1, 1, 5, -1 },// 2:C\n\t\t\t{ 4, -1, 6, 0 }, // 3:D\n\t\t\t{ 5, 3, 7, 1 }, // 4:E\n\t\t\t{ -1, 4, 8, 2 }, // 5:F\n\t\t\t{ 7, -1, -1, 3 },// 6:G\n\t\t\t{ 8, 6, -1, 4 }, // 7:H\n\t\t\t{ -1, 7, -1, 5 } // 8:I\n\t};\n\tfinal static byte distances[][] = {\n\t\t\t// A,B, C, D, E, F, G, H, I\n\t\t\t{ 0, 1, 2, 1, 2, 3, 2, 3, 4 },// 0:A\n\t\t\t{ 1, 0, 1, 2, 1, 2, 3, 2, 3 },// 1:B\n\t\t\t{ 2, 1, 0, 3, 2, 1, 4, 3, 2 },// 2:C\n\t\t\t{ 1, 2, 3, 0, 1, 2, 1, 2, 3 },// 3:D\n\t\t\t{ 2, 1, 2, 1, 0, 1, 2, 1, 2 },// 4:E\n\t\t\t{ 3, 2, 1, 2, 1, 0, 3, 2, 1 },// 5:F\n\t\t\t{ 2, 3, 4, 1, 2, 3, 0, 1, 2 },// 6:G\n\t\t\t{ 3, 2, 3, 2, 1, 2, 1, 0, 1 },// 7:H\n\t\t\t{ 4, 3, 2, 3, 2, 1, 2, 1, 0 } // 8:I\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic int probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tbyte battery;\n\t\t\tbyte start;\n\n\t\t\tbattery = Byte.parseByte(line);\n\t\t\tif (battery == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1 << battery * 2);\n\t\t\tSystem.out.println(String.format(\"%.8f\",\n\t\t\t\t\tprobability * Math.pow(4, -battery)));\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, int p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t} else if (distance(current, charger) <= battery) {\n\t\t\tfor (byte n : next(current)) {\n\t\t\t\tif (n < 0 || n == storeroom) {\n\t\t\t\t\tclean(current, battery - 1, p >> 2);\n\t\t\t\t} else {\n\t\t\t\t\tclean(n, battery - 1, p >> 2);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\treturn nexts[current];\n\t}\n\n\tstatic byte distance(byte current, byte charger) {\n\t\treturn distances[current][charger];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\tfinal static byte nexts[][] = {\n\t\t\t// 東,西,南,北\n\t\t\t{ 1, -1, 3, -1 },// 0:A\n\t\t\t{ 2, 0, 4, -1 }, // 1:B\n\t\t\t{ -1, 1, 5, -1 },// 2:C\n\t\t\t{ 4, -1, 6, 0 }, // 3:D\n\t\t\t{ 5, 3, 7, 1 }, // 4:E\n\t\t\t{ -1, 4, 8, 2 }, // 5:F\n\t\t\t{ 7, -1, -1, 3 },// 6:G\n\t\t\t{ 8, 6, -1, 4 }, // 7:H\n\t\t\t{ -1, 7, -1, 5 } // 8:I\n\t};\n\tfinal static byte distances[][] = {\n\t\t\t// A,B, C, D, E, F, G, H, I\n\t\t\t{ 0, 1, 2, 1, 2, 3, 2, 3, 4 },// 0:A\n\t\t\t{ 1, 0, 1, 2, 1, 2, 3, 2, 3 },// 1:B\n\t\t\t{ 2, 1, 0, 3, 2, 1, 4, 3, 2 },// 2:C\n\t\t\t{ 1, 2, 3, 0, 1, 2, 1, 2, 3 },// 3:D\n\t\t\t{ 2, 1, 2, 1, 0, 1, 2, 1, 2 },// 4:E\n\t\t\t{ 3, 2, 1, 2, 1, 0, 3, 2, 1 },// 5:F\n\t\t\t{ 2, 3, 4, 1, 2, 3, 0, 1, 2 },// 6:G\n\t\t\t{ 3, 2, 3, 2, 1, 2, 1, 0, 1 },// 7:H\n\t\t\t{ 4, 3, 2, 3, 2, 1, 2, 1, 0 } // 8:I\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic int probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tbyte battery;\n\t\t\tbyte start;\n\n\t\t\tbattery = Byte.parseByte(line);\n\t\t\tif (battery == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1 << battery * 2);\n\t\t\tSystem.out.println(String.format(\"%.8f\",\n\t\t\t\t\tprobability * Math.pow(4, -battery)));\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, int p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif (distance(current, charger) <= battery) {\n\t\t\tfor (byte n1 : next(current)) {\n\t\t\t\tif (n1 < 0 || n1 == storeroom) {\n\t\t\t\t\tfor (byte n2 : next(current)) {\n\t\t\t\t\t\tif (n2 != n1)\n\t\t\t\t\t\t\tclean(n2, battery - 2, p >> 2 - p >> 4);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tclean(n1, battery - 1, p >> 2);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\treturn nexts[current];\n\t}\n\n\tstatic byte distance(byte current, byte charger) {\n\t\treturn distances[current][charger];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.InputStreamReader;\n \nclass Main{\n    static double before[][];\n    static double after[][];\n    static boolean souko[][];\n    public static void main(String args[]){\n        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n        try{\n            while(true){\n                int n = Integer.parseInt(br.readLine());\n                if(n == 0) return;\n \n                String strs[] = br.readLine().split(\" \");\n                char s = strs[0].charAt(0);\n                char t = strs[1].charAt(0);\n                char b = strs[2].charAt(0);\n \n                before = new double[3][3];\n                souko = new boolean[3][3];\n \n                int bs[] = charToInts(b);\n                souko[bs[0]][bs[1]] = true;\n \n                int ss[] = charToInts(s);\n                before[ss[0]][ss[1]] = 1.0;\n \n                for(int i = 0; i < n; i++){\n                    after = new double[3][3];\n                    calc();\n                    before = after;\n                }\n \n                int ts[] = charToInts(t);\n                System.out.println(before[ts[0]][ts[1]]);\n            }\n        }catch(Exception e){\n        }\n    }\n \n    static void calc(){\n        for(int i = 0; i < 3; i++){\n            for(int j = 0; j < 3; j++){\n                double p = before[i][j] * 0.25;\n                // ←\n                if(j == 0 || souko[i][j-1]){\n                    after[i][j] += p;\n                }else{\n                    after[i][j-1] += p;\n                }\n \n                // ↑\n                if(i == 0 || souko[i-1][j]){\n                    after[i][j] += p;\n                }else{\n                    after[i-1][j] += p;\n                }\n \n                // →\n                if(j == 2 || souko[i][j+1]){\n                    after[i][j] += p;\n                }else{\n                    after[i][j+1] += p;\n                }\n \n                // ↓\n                if(i == 2 || souko[i+1][j]){\n                    after[i][j] += p;\n                }else{\n                    after[i+1][j] += p;\n                }\n            }\n        }\n    }\n \n    static int[] charToInts(char c){\n        int m = c - 'A';\n        int result[] = {m / 3, m % 3};\n        return result;\n    }\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.*;\nimport static java.lang.Math.*;\nimport static java.util.Arrays.*;\n\npublic class Main {\n\n\tint INF = 1 << 28;\n\t\n\tint dx[] = {-1,0,1,0};\n\tint dy[] = {0,-1,0,1};\n\t\n\tvoid run() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tfor(;;) {\n\t\t\tint n = sc.nextInt();\n\t\t\tif( n == 0 ) break;\n\t\t\tint[][] map1 = new int[5][5];\n\t\t\tint s = sc.next().charAt(0) - 'A';\n\t\t\tint t = sc.next().charAt(0) - 'A';\n\t\t\tint b = sc.next().charAt(0) - 'A';\n\t\t\tint cnt;\n\t\t\tfor(int[] a: map1) fill(a, -1);\n\t\t\tfor(int i=1;i<=3;i++) for(int j=1;j<=3;j++) map1[i][j] = 0;\n\t\t\tmap1[ b/3+1 ][ b%3+1 ] = -1;\n\t\t\tcnt = 1;\n\t\t\tmap1[ s/3+1 ][ s%3+1 ] = 1;\n//\t\t\tfor(int[] a: map1) debug(a);\n\t\t\tfor(int c=0;c<n;c++) {\n\t\t\t\tint[][] tmp = new int[3][3];\n\t\t\t\tfor(int x=1;x<=3;x++) for(int y=1;y<=3;y++)  {\n\t\t\t\t\tif(map1[x][y] == -1) {\n\t\t\t\t\t\ttmp[x-1][y-1] = map1[x][y];\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tfor(int j=0;j<4;j++) {\n\t\t\t\t\t\tif(map1[x+dx[j]][y+dy[j]] != -1) {\n\t\t\t\t\t\t\ttmp[x+dx[j]-1][y+dy[j]-1] += max(0, map1[x][y]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\ttmp[x-1][y-1] += max(0, map1[x][y]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int x=1;x<=3;x++) for(int y=1;y<=3;y++) {\n\t\t\t\t\tmap1[x][y] = tmp[x-1][y-1];\n\t\t\t\t}\n\t\t\t\tcnt *= 4;\n\t\t\t}\n\t\t\tSystem.out.println(( (double)map1[t/3+1][t%3+1]/cnt ));\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid debug(Object... os) {\n\t\tSystem.err.println(Arrays.deepToString(os));\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tScanner in = new Scanner(System.in);\n\tpublic static void main(String[] args) {\n\t\tnew Main();\n\t}\n\n\tpublic Main() {\n\t\tnew AOJ1020().doIt();\n\t}\n\n\tclass AOJ1020{\n\t\tint[][][] dp;\n\t\tvoid print(int b){\n\t\t\tSystem.out.println();\n\t\t\tfor(int i=0;i<3;i++){\n\t\t\t\tfor(int j=0;j<3;j++)System.out.print(dp[i][j][b]+\" \");\n\t\t\t\tSystem.out.println();\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tvoid doIt(){\n\t\t\tHashMap<Character,Point> map = new HashMap<Character,Point>();\n\t\t\tmap.put('A',new Point(0, 0));\n\t\t\tmap.put('B',new Point(1, 0));\n\t\t\tmap.put('C',new Point(2, 0));\n\t\t\tmap.put('D',new Point(0, 1));\n\t\t\tmap.put('E',new Point(1, 1));\n\t\t\tmap.put('F',new Point(2, 1));\n\t\t\tmap.put('G',new Point(0, 2));\n\t\t\tmap.put('H',new Point(1, 2));\n\t\t\tmap.put('I',new Point(2, 2));\n\t\t\tint sx[] = {1,0,-1,0};\n\t\t\tint sy[] = {0,1,0,-1};\n\t\t\twhile(true){\n\t\t\t\tint n = in.nextInt();\n\t\t\t\tif(n==0)break;\n\t\t\t\tchar s = in.next().charAt(0);\n\t\t\t\tchar t = in.next().charAt(0);\n\t\t\t\tchar b = in.next().charAt(0);\n\t\t\t\tPoint bad = map.get(b);\n\t\t\t\tdp = new int[3][3][n+2];\n\t\t\t\tdp[map.get(s).y][map.get(s).x][0] = 1;\n\t\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\t\tfor(int y=0;y<3;y++)for(int x=0;x<3;x++)if(dp[y][x][i]>0){\n\t\t\t\t\t\tfor(int j=0;j<4;j++){\n\t\t\t\t\t\t\tint nx = x+sx[j];\n\t\t\t\t\t\t\tint ny = y+sy[j];\n\t\t\t\t\t\t\tif(nx<0||nx>=3||ny<0||ny>=3)dp[y][x][i+1]++;\n\t\t\t\t\t\t\telse if(bad.x==nx&&bad.y==ny)dp[y][x][i+1]++;\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tdp[ny][nx][i+1]++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n//\t\t\t\t\tprint(i);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdouble sum = 0;\n\t\t\t\tdouble goal = dp[map.get(t).y][map.get(t).x][n];\n\t\t\t\tfor(int i=0;i<3;i++)for(int k=0;k<3;k++)sum+=dp[i][k][n];\n\t\t\t\tSystem.out.printf(\"%.9f\\n\",(goal/sum));\n\t\t\t}\n\t\t}\n\t\tclass Point{\n\t\t\tint x,y;\n\t\t\tpublic Point(int x,int y) {\n\t\t\t\tthis.x = x;\n\t\t\t\tthis.y = y;\n\t\t\t}\n\t\t}\n\n\t}\n\n\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.IOException;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) throws IOException {\n\n\t\tnew Main().run();\n\t}\n\n\tprivate void run() throws IOException {\n\t\tScanner scanner = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint n = scanner.nextInt();\n\t\t\tif (n == 0)\n\t\t\t\tbreak;\n\t\t\tint[] xs = new int[3];\n\t\t\tint[] ys = new int[3];\n\t\t\tfor (int i = 0; i < 3; i++) {\n\t\t\t\tint a = scanner.next().charAt(0) - 'A';\n\t\t\t\txs[i] = a % 3;\n\t\t\t\tys[i] = a / 3;\n\t\t\t}\n\t\t\tdouble[][][] dp = new double[2][3][3];\n\t\t\tint u = 0;\n\t\t\tdp[u][xs[0]][ys[0]] = 1;\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tfor (int y = 0; y < 3; y++) {\n\t\t\t\t\tfor (int x = 0; x < 3; x++) {\n\t\t\t\t\t\tfor (int[] m : move) {\n\t\t\t\t\t\t\tint nx = x + m[0];\n\t\t\t\t\t\t\tint ny = y + m[1];\n\t\t\t\t\t\t\tif (nx == xs[2] && ny == ys[2] || nx < 0 || 2 < nx\n\t\t\t\t\t\t\t\t\t|| ny < 0 || 2 < ny)\n\t\t\t\t\t\t\t\tdp[1 - u][y][x] += dp[u][y][x] / 4;\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tdp[1 - u][ny][nx] += dp[u][y][x] / 4;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdp[u][y][x] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tu = 1 - u;\n\t\t\t}\n\t\t\tSystem.out.printf(\"%.8f\\n\", dp[u][ys[1]][xs[1]]);\n\t\t}\n\t}\n\n\tint[][] move = { { -1, 0 }, { 0, -1 }, { 0, 1 }, { 1, 0 } };\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\tfinal static byte nexts[][] = {\n\t\t\t// 東,西,南,北\n\t\t\t{ 1, -1, 3, -1 },// 0:A\n\t\t\t{ 2, 0, 4, -1 }, // 1:B\n\t\t\t{ -1, 1, 5, -1 },// 2:C\n\t\t\t{ 4, -1, 6, 0 }, // 3:D\n\t\t\t{ 5, 3, 7, 1 }, // 4:E\n\t\t\t{ -1, 4, 8, 2 }, // 5:F\n\t\t\t{ 7, -1, -1, 3 },// 6:G\n\t\t\t{ 8, 6, -1, 4 }, // 7:H\n\t\t\t{ -1, 7, -1, 5 } // 8:I\n\t};\n\tfinal static byte distances[][] = {\n\t\t\t// A,B, C, D, E, F, G, H, I\n\t\t\t{ 0, 1, 2, 1, 2, 3, 2, 3, 4 },// 0:A\n\t\t\t{ 1, 0, 1, 2, 1, 2, 3, 2, 3 },// 1:B\n\t\t\t{ 2, 1, 0, 3, 2, 1, 4, 3, 2 },// 2:C\n\t\t\t{ 1, 2, 3, 0, 1, 2, 1, 2, 3 },// 3:D\n\t\t\t{ 2, 1, 2, 1, 0, 1, 2, 1, 2 },// 4:E\n\t\t\t{ 3, 2, 1, 2, 1, 0, 3, 2, 1 },// 5:F\n\t\t\t{ 2, 3, 4, 1, 2, 3, 0, 1, 2 },// 6:G\n\t\t\t{ 3, 2, 3, 2, 1, 2, 1, 0, 1 },// 7:H\n\t\t\t{ 4, 3, 2, 3, 2, 1, 2, 1, 0 } // 8:I\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic int probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tbyte battery;\n\t\t\tbyte start;\n\n\t\t\tbattery = Byte.parseByte(line);\n\t\t\tif (battery == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1 << battery * 2);\n\t\t\tSystem.out.println(String.format(\"%.8f\",\n\t\t\t\t\tprobability * Math.pow(4, -battery)));\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, int p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t} else if (distance(current, charger) <= battery) {\n\t\t\tfor (byte n : next(current)) {\n\t\t\t\tif (n > -1) {\n\t\t\t\t\tif (n == storeroom) {\n\t\t\t\t\t\tclean(current, battery - 1, p >> 2);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclean(n, battery - 1, p >> 2);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\treturn nexts[current];\n\t}\n\n\tstatic byte distance(byte current, byte charger) {\n\t\treturn distances[current][charger];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigDecimal;\nimport java.util.*;\nimport static java.util.Arrays.*;\nimport static java.lang.Math.*;\n\nclass Main {\n\tstatic Scanner sc = new Scanner(System.in);\n\tstatic int n;\n\tstatic char s, t, b;\n\tstatic int[] dx = {-1, 0, 1, 0}, dy = {0, -1, 0, 1};\n\t\n\tpublic static void main(String[] args) {\n\t\twhile (read()) {\n\t\t\tsolve();\n\t\t}\n\t}\n\n\tstatic boolean read() {\n\t\tn = sc.nextInt();\n\t\tif (n == 0) return false;\n\t\t\n\t\ts = sc.next().charAt(0);\n\t\tt = sc.next().charAt(0);\n\t\tb = sc.next().charAt(0);\n\t\t\n\t\treturn true;\n\t}\n\n\tstatic void solve() {\n\t\tBigDecimal[][][] dp = new BigDecimal[n + 1][5][5];\n\t\tfor (int i = 0; i <= n; i++) { \n\t\t\tfor (int j = 0; j < 5; j++) {\n\t\t\t\tfor (int k = 0; k < 5; k++) {\n\t\t\t\t\tdp[i][j][k] = new BigDecimal(0.0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t\tint pos_s = s - 'A', pos_t = t - 'A', pos_b = b - 'A';\n\t\tint sx = pos_s % 3 + 1, sy = pos_s / 3 + 1;\n\t\tint gx = pos_t % 3 + 1, gy = pos_t / 3 + 1;\n\t\tint bx = pos_b % 3 + 1, by = pos_b / 3 + 1;\n\t\t\n\t\tdp[0][sy][sx] = new BigDecimal(1.0);\n\t\t\n\t\tBigDecimal bf = new BigDecimal(0.25);\n\t\tfor (int i = 1; i <= n; i++) {\n\t\t\tfor (int y = 1; y <= 3; y++) {\n\t\t\t\tfor (int x = 1; x <= 3; x++) {\n\t\t\t\t\tfor (int l = 0; l < 4; l++) {\n\t\t\t\t\t\tint ty = y + dy[l], tx = x + dx[l];\n\t\t\t\t\t\tif ((y == by) && (x == bx)){\n\t\t\t\t\t\t\tty = y; tx = x;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdp[i][ty][tx] = dp[i][ty][tx].add(dp[i - 1][y][x].multiply(bf));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tSystem.out.printf(\"%.8f\", dp[n][gy][gx]);\n\t\tSystem.out.println();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\tpublic static void main(String[] args) throws Exception {\n\t\ttry(Scanner sc = new Scanner(System.in)) {\n\t\t\twhile(true) {\n\t\t\t\tint n = sc.nextInt();\n\t\t\t\tif(n == 0)\tbreak;\n\t\t\t\tint[][] cor = {{0, 2}, {1, 2}, {2, 2}, {0, 1}, {1, 1}, {2, 1}, {0, 0}, {1, 0}, {2, 0}};\n\t\t\t\tdouble[][][] dp = new double[3][3][n+1];\n\t\t\t\tint[][] dis = {{-1, 0}, {0, 1}, {1, 0}, {0, -1}};\n\t\t\t\tdouble e = 1.0 / 4.0;\n\t\t\t\t//dp[x][y][バッテリー] バッテリーの時のx.yにいる確率\n\t\t\t\t//dp[x][y][ba] = dp[x-1][y][ba+1]*1/4+...\n\t\t\t\tString dummy = sc.nextLine();\n\t\t\t\tString str = sc.nextLine();\n\t\t\t\tString[] s = str.split(\" \");\n\t\t\t\tint sx = cor[s[0].charAt(0) - 'A'][0];\n\t\t\t\tint sy = cor[s[0].charAt(0) - 'A'][1];\n\t\t\t\tint tx = cor[s[1].charAt(0) - 'A'][0];\n\t\t\t\tint ty = cor[s[1].charAt(0) - 'A'][1];\n\t\t\t\tint bx = cor[s[2].charAt(0) - 'A'][0];\n\t\t\t\tint by = cor[s[2].charAt(0) - 'A'][1];\n\t\t\t\t\n\t\t\t\tfor(int x=0; x<3; x++) {\n\t\t\t\t\tfor(int y=0; y<3; y++) {\n\t\t\t\t\t\tfor(int i=0; i<n+1; i++) {\n\t\t\t\t\t\t\tdp[x][y][i] = 0.0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdp[sx][sy][n] = 1.0;\n\t\t\t\t\n\t\t\t\tfor(int i=n; i>0; i--) {\n\t\t\t\t\tfor(int x=0; x<3; x++) {\n\t\t\t\t\t\tfor(int y=0; y<3; y++) {\n\t\t\t\t\t\t\tfor(int next=0; next<4; next++) {\n\t\t\t\t\t\t\t\tint nx = x + dis[next][0];\n\t\t\t\t\t\t\t\tint ny = y + dis[next][1];\n\t\t\t\t\t\t\t\tif(nx == x && ny == y) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if(nx==bx && ny==by) {\n\t\t\t\t\t\t\t\t\tdp[x][y][i-1] += dp[x][y][i]*e;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if((nx<0 || nx>2) || (ny<0 || ny>2)) {\n\t\t\t\t\t\t\t\t\tdp[x][y][i-1] += dp[x][y][i]*e;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tdp[nx][ny][i-1] += dp[x][y][i]*e;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tSystem.out.printf(\"%.8f\\n\", dp[tx][ty][0]);\n\t\t\t}\n\t\t}\n\t}\n\n}\n\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\npublic class Main{\n\tpublic static void main(String[] args){\n        new Main().run2();\n    }\n\tdouble allCount = 0;\n\tdouble ansCount = 0;\n\tint[] dx = {-1,0,0,1};\n\tint[] dy = {0,-1,1,0};\n\tint s;\n\tint t;\n\tint b;\n\tint n;\n\tint[][][][] memo;\n\tpublic void run2(){\n\t\tScanner scan = new Scanner(System.in);\n\t\twhile(scan.hasNext()){\n\t\t\tn = Integer.parseInt(scan.nextLine());\n\t\t\tif(n == 0){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tallCount = 0;\n\t\t\tansCount = 0;\n\t\t\tchar[] ch = scan.nextLine().replaceAll(\" \",\"\").toCharArray();\n\t\t\ts = (ch[0] - 'A');\n\t\t\tt = ch[1] - 'A';\n\t\t\tb = ch[2] - 'A';\n\t\t\tmemo = new int[n+1][2][3][3];\n\t\t\tfor(int i = 0;i < n+1;i++){\n\t\t\t\tfor(int j = 0;j < 3;j++){\n\t\t\t\t\tfor(int k = 0;k < 3;k++){\n\t\t\t\t\t\tmemo[i][0][j][k] = -1;\n\t\t\t\t\t\tmemo[i][1][j][k] = -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tint[] ans = dfs2(s/3,s%3,0);\n\t\t\tSystem.out.printf(\"%.6f\\n\",(double)ans[1] / (double)ans[0]);\n\t\t}\n\t}\n\tpublic int[] dfs2(int y,int x,int count){\n\t\tint[] a = {0,0};\n\t\tif(memo[count][0][x][y] >= 0){\n\t\t\ta[0] += memo[count][0][x][y];\n\t\t\ta[1] += memo[count][1][x][y];\n\t\t\treturn a;\n\t\t}\n\t\tif(count == n){\n\t\t\tmemo[count][0][x][y] = a[0] = 1;\n\t\t\tmemo[count][1][x][y] = a[1] = 0;\n\t\t\tif(x == t % 3 && y == t/3){\n\t\t\t\tmemo[count][1][x][y] = a[1] = 1;\n\t\t\t}\n\t\t\treturn a;\n\t\t}\n\t\tint[] c = new int[2];\n\t\tfor(int i = 0;i < 4;i++){\n\t\t\tif(x+dx[i] >= 0 && x+dx[i] < 3 && y+dy[i] >= 0 && y+dy[i] < 3){\n\t\t\t\tif(x+dx[i] == b % 3 && y+dy[i] == b / 3){\n\t\t\t\t\tc = dfs2(y,x,count+1);\n\t\t\t\t}else{\n\t\t\t\t\tc = dfs2(y+dy[i],x+dx[i],count+1);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tc = dfs2(y,x,count+1);\n\t\t\t}\n\t\t\ta[0] += c[0];\n\t\t\ta[1] += c[1];\n\t\t\tmemo[count][0][x][y] = a[0];\n\t\t\tmemo[count][1][x][y] = a[1];\n\t\t}\n\t\treturn a;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Iterator;\nimport java.util.LinkedList;\nimport java.util.Scanner;\n \n \npublic class Main {\n     \n    public static void main(String[] args) {\n        Scanner sc = new Scanner(System.in);\n        \n        while(true){\n        \tfinal int n = sc.nextInt();\n        \t\n        \tif(n == 0){\n        \t\tbreak;\n        \t}\n        \t\n        \tdouble[] pos = new double[9];\n        \t\n        \tfor(int i = 0; i < 9; i++){\n        \t\tpos[i] = 0;\n        \t}\n        \t\n        \tfinal int start = sc.next().toCharArray()[0] - 'A';\n        \tfinal int end = sc.next().toCharArray()[0] - 'A';\n        \tfinal int not = sc.next().toCharArray()[0] - 'A';\n        \t\n        \tpos[start] = 1;\n        \t\n        \tdouble[] next = new double[9];\n        \t\n        \tfor(int i = 0; i < n; i++){\n        \t\t\n        \t\tfor(int j = 0; j < 9; j++){\n        \t\t\tnext[j] = 0;\n        \t\t}\n        \t\t\n        \t\t//System.out.println(Arrays.toString(pos));\n        \t\t\n        \t\tfor(int j = 0; j < 9; j++){\n        \t\t\tif(j % 3 != 0 && not != j - 1){\n        \t\t\t\tnext[j-1] += pos[j] / 4;\n        \t\t\t}else{\n        \t\t\t\tnext[j] += pos[j] / 4;\n        \t\t\t}\n        \t\t\t\n        \t\t\tif(j % 3 != 2 && not != j + 1){\n        \t\t\t\tnext[j+1] += pos[j] / 4;\n        \t\t\t}else{\n        \t\t\t\tnext[j] += pos[j] / 4;\n        \t\t\t}\n        \t\t\t\n        \t\t\tif(j / 3 != 0 && not != j - 3){\n        \t\t\t\tnext[j-3] += pos[j] / 4;\n        \t\t\t}else{\n        \t\t\t\tnext[j] += pos[j] / 4;\n        \t\t\t}\n        \t\t\t\n        \t\t\tif(j / 3 != 2 && not != j + 3){\n        \t\t\t\tnext[j+3] += pos[j] / 4;\n        \t\t\t}else{\n        \t\t\t\tnext[j] += pos[j] / 4;\n        \t\t\t}\n        \t\t}\n        \t\t\n        \t\tdouble[] tmp = next;\n        \t\tnext = pos;\n        \t\tpos = tmp;\n        \t}\n        \t//System.out.println(Arrays.toString(pos));\n        \tSystem.out.printf(\"%.8f\\n\",pos[end]);\n        }\n    }\n \n}"
  },
  {
    "language": "Java",
    "code": "import java.awt.Point;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\tfinal int INF = 1 << 28;\n\tint s;\n\tint t;\n\tint b;\n\tdouble dp[][];\n\n\tvoid run() {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\t// n\n\t\t\t// s t b\n\t\t\t//\n\t\t\t// n はバッテリーの残ポイント数を示す整数である。 s, t, b\n\t\t\t// はそれぞれ、最初にロボットがいる部屋、充電器のある部屋、倉庫として使っている部屋を示す大文字のアルファベットである。\n\t\t\tint n = sc.nextInt();\n\t\t\tif (n == 0)\n\t\t\t\tbreak;\n\n\t\t\ts = sc.next().charAt(0) - 'A';\n\t\t\tt = sc.next().charAt(0) - 'A';\n\t\t\tb = sc.next().charAt(0) - 'A';\n\t\t\tint x = s % 3;\n\t\t\tint y = (s - x) / 3;\n\t\t\tdp = new double[n + 1][9];\n\t\t\tfor (int i = 0; i <= n; i++) {\n\t\t\t\tArrays.fill(dp[i], -1);\n\t\t\t}\n\t\t\tdouble ans = solve(n, new Point(x, y));\n\t\t\tSystem.out.printf(\"%.8f\\n\", ans);\n\t\t}\n\t}\n\n\tdouble solve(int rest, Point pos) {\n\t\tint x = pos.x;\n\t\tint y = pos.y;\n\t\tif (dp[rest][x + 3 * y] >= 0) {\n\t\t\treturn dp[rest][x + 3 * y];\n\t\t}\n\t\tdouble res = 0;\n\t\tif (rest == 0) {\n\t\t\tif (x + 3 * y == t) {\n\t\t\t\tres = 1.0;\n\t\t\t} else\n\t\t\t\tres = 0.0;\n\t\t} else {\n\t\t\tint dx[] = { 0, 1, 0, -1 };\n\t\t\tint dy[] = { 1, 0, -1, 0 };\n\t\t\tfor (int i = 0; i < 4; i++) {\n\t\t\t\tint nx = x + dx[i];\n\t\t\t\tint ny = y + dy[i];\n\t\t\t\tif (nx < 0 || ny < 0 || nx > 2 || ny > 2 || nx + 3 * ny == b) {\n\t\t\t\t\tres += 1.0 / 4 * solve(rest - 1, pos);\n\t\t\t\t} else {\n\t\t\t\t\tres += 1.0 / 4 * solve(rest - 1, new Point(nx, ny));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn dp[rest][x + 3 * y] = res;\n\t}\n\n\tpublic static void main(String[] args) throws Exception {\n\t\tnew Main().run();\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Scanner;\n\n/**\n * Cleaning Robot\n *  URL:http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1020&lang=jp\n *\n * @author Igari Kazuya\n *\n */\npublic class Main {\n\n\t/**\n\t * @param args\n\t */\n\tpublic static void main(String[] args) {\n\t\t// TODO ©®¶¬³ê½\\bhEX^u\n\t\tScanner sc = new Scanner(System.in);\n\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\n\t\t\tif(n == 0){\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tString s,t,b;\n\t\t\ts = sc.next();\n\t\t\tt = sc.next();\n\t\t\tb = sc.next();\n\n\t\t\tint[][] map = new int[5][5];\n\t\t\tfor(int i=0;i<5;i++){\n\t\t\t\tmap[0][i] = 1;\n\t\t\t\tmap[i][0] = 1;\n\t\t\t\tmap[4][i] = 1;\n\t\t\t\tmap[i][4] = 1;\n\t\t\t}\n\n\t\t\tint ss = s.charAt(0) - 'A';\n\t\t\tint tt = t.charAt(0) - 'A';\n\t\t\tint bb = b.charAt(0) - 'A';\n\n\t\t\t//map[ss/3 + 1][ss%3 + 1] = 3;//@B¿áñ\n\t\t\t//map[tt/3 + 1][tt%3 + 1] = 2;//[dí\n\t\t\tmap[bb/3 + 1][bb%3 + 1] = 1;//qÉ\n\n\t\t\tArrayList<Integer> list = new ArrayList<Integer>();\n\t\t\tArrayList<Integer> buf = new ArrayList<Integer>();\n\n\t\t\tlist.add(ss);\n\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tfor(int j=0;j<list.size();j++){\n\t\t\t\t\tint bufint = list.get(j);\n\t\t\t\t\tif(map[bufint/3][bufint%3+1] != 1){\n\t\t\t\t\t\tbuf.add(bufint - 3);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbuf.add(bufint);\n\t\t\t\t\t}\n\t\t\t\t\tif(map[bufint/3+2][bufint%3+1] != 1){\n\t\t\t\t\t\tbuf.add(bufint + 3);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbuf.add(bufint);\n\t\t\t\t\t}\n\t\t\t\t\tif(map[bufint/3+1][bufint%3] != 1){\n\t\t\t\t\t\tbuf.add(bufint - 1);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbuf.add(bufint);\n\t\t\t\t\t}\n\t\t\t\t\tif(map[bufint/3+1][bufint%3+2] != 1){\n\t\t\t\t\t\tbuf.add(bufint + 1);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbuf.add(bufint);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tlist.clear();\n\n\t\t\t\tfor(int j=0;j<buf.size();j++){\n\t\t\t\t\tlist.add(buf.get(j));\n\t\t\t\t}\n\t\t\t\tbuf.clear();\n\t\t\t}\n\n\t\t\tint count=0;\n\t\t\tfor(int i=0;i<list.size();i++){\n\t\t\t\tif(list.get(i) == tt){\n\t\t\t\t\tcount++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println((double)count/list.size());\n\t\t}\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tScanner in = new Scanner(System.in);\n\tpublic static void main(String[] args) {\n\t\tnew Main();\n\t}\n\n\tpublic Main() {\n\t\tnew AOJ1020().doIt();\n\t}\n\n\tclass AOJ1020{\n\t\tint[][][] memo;\n\t\tHashMap<Character,Point> map;\n\t\tint[] sx = {1,0,-1,0};\n\t\tint[] sy = {0,1,0,-1};\n\t\tint n;\n\t\tPoint bad,goal;\n\t\tint dfs(int x,int y,int battery){\n\t\t\tif(memo[x][y][battery]>0)return memo[x][y][battery];\n\t\t\tif(battery==n){\n\t\t\t\tif(goal.x==x&&goal.y==y)return 1;\n\t\t\t\telse return 0;\n\t\t\t}\n\t\t\tint result = 0;\n\t\t\tfor(int i=0;i<4;i++){\n\t\t\t\tint nx = x+sx[i];\n\t\t\t\tint ny = y+sy[i];\n\t\t\t\tif(nx<0||nx>=3||ny<0||ny>=3||(bad.x==nx&&bad.y==ny))result += dfs(x,y,battery+1);\n\t\t\t\telse result +=  dfs(nx,ny,battery+1);\n\t\t\t}\n\t\t\treturn memo[x][y][battery] = result;\n\t\t}\n\n\n\t\tvoid doIt(){\n\t\t\tmap = new HashMap<Character,Point>();\n\t\t\tmap.put('A',new Point(0, 0));\n\t\t\tmap.put('B',new Point(1, 0));\n\t\t\tmap.put('C',new Point(2, 0));\n\t\t\tmap.put('D',new Point(0, 1));\n\t\t\tmap.put('E',new Point(1, 1));\n\t\t\tmap.put('F',new Point(2, 1));\n\t\t\tmap.put('G',new Point(0, 2));\n\t\t\tmap.put('H',new Point(1, 2));\n\t\t\tmap.put('I',new Point(2, 2));\n\t\t\twhile(true){\n\t\t\t\tn = in.nextInt();\n\t\t\t\tif(n==0)break;\n\t\t\t\tchar s = in.next().charAt(0);\n\t\t\t\tchar g = in.next().charAt(0);\n\t\t\t\tchar b = in.next().charAt(0);\n\t\t\t\tmemo = new int[3][3][n+1];\n\t\t\t\tbad = new Point(map.get(b).x, map.get(b).y);\n\t\t\t\tgoal = new Point(map.get(g).x,map.get(g).y);\n\t\t\t\tdouble a = dfs(map.get(s).x,map.get(s).y,0);\n\t\t\t\tlong c = 4;\n\t\t\t\tfor(int i=0;i<n-1;i++)c*=4;\n//\t\t\t\tSystem.out.println(a+\" \"+c);\n\t\t\t\tSystem.out.printf(\"%.9f\\n\",(a/c));\n\t\t\t\t\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\tclass Point{\n\t\t\tint x,y;\n\t\t\tpublic Point(int x,int y) {\n\t\t\t\tthis.x = x;\n\t\t\t\tthis.y = y;\n\t\t\t}\n\t\t}\n\n\t}\n\n\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.IOException;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) throws IOException {\n\n\t\tnew Main().run();\n\t}\n\n\tprivate void run() throws IOException {\n\t\tScanner scanner = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint n = scanner.nextInt();\n\t\t\tif (n == 0)\n\t\t\t\tbreak;\n\t\t\tint[] xs = new int[3];\n\t\t\tint[] ys = new int[3];\n\t\t\tfor (int i = 0; i < 3; i++) {\n\t\t\t\tint a = scanner.next().charAt(0) - 'A';\n\t\t\t\txs[i] = a % 3;\n\t\t\t\tys[i] = a / 3;\n\t\t\t}\n\t\t\tdouble[][] cur = new double[3][3];\n\t\t\tcur[xs[0]][ys[0]] = 1;\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tdouble[][] nxt = new double[3][3];\n\t\t\t\tfor (int x = 0; x < 3; x++)\n\t\t\t\t\tfor (int y = 0; y < 3; y++)\n\t\t\t\t\t\tfor (int[] m : move) {\n\t\t\t\t\t\t\tint nx = x + m[0];\n\t\t\t\t\t\t\tint ny = y + m[1];\n\t\t\t\t\t\t\tif (nx == xs[2] && ny == ys[2] || nx < 0 || 2 < nx\n\t\t\t\t\t\t\t\t\t|| ny < 0 || 2 < ny)\n\t\t\t\t\t\t\t\tnxt[x][y] += cur[x][y] / 4;\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tnxt[nx][ny] += cur[x][y] / 4;\n\t\t\t\t\t\t}\n\t\t\t\tcur = nxt;\n\t\t\t}\n\t\t\tSystem.out.printf(\"%.8f\\n\", cur[xs[1]][ys[1]]);\n\t\t}\n\t}\n\n\tint[][] move = { { -1, 0 }, { 0, -1 }, { 0, 1 }, { 1, 0 } };\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.text.DecimalFormat;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\tstatic final DecimalFormat df = new DecimalFormat(\"0.0000000000\");\n\tstatic final int A = 0, B = 1, C = 2, D = 3, E = 4, F = 5, G = 6, H = 7,\n\t\t\tI = 8;\n\tstatic final int[][] rooms = {\n\t\t\t//\n\t\t\t{ A, D, B, A }, { B, E, C, A }, { C, F, C, B },//\n\t\t\t{ A, G, E, D }, { B, H, F, D }, { C, I, F, E },//\n\t\t\t{ D, G, H, G }, { E, H, I, G }, { F, I, I, H } };\n\n\tpublic static void main(String[] args) {\n\t\tScanner in = new Scanner(System.in);\n\t\tint n;\n\t\tdouble[] now = new double[9];\n\t\tdouble[] next = new double[9];\n\t\twhile ((n = in.nextInt()) > 0) {\n\t\t\tdouble a = Math.pow(4, n);\n\t\t\tint s = in.next().charAt(0) - 'A';\n\t\t\tnow[s] = (int) a;\n\t\t\tint t = in.next().charAt(0) - 'A';// 充電器\n\t\t\tint b = in.next().charAt(0) - 'A';// 入れない\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tfor (int room = 0; room < 9; room++) {\n\t\t\t\t\tdouble val = now[room] / 4;\n\t\t\t\t\tfor (int arrow = 0; arrow < 4; arrow++) {\n\t\t\t\t\t\tif (rooms[room][arrow] != b)\n\t\t\t\t\t\t\tnext[rooms[room][arrow]] += val;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tnext[room] += val;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tdouble[] memo = now;\n\t\t\t\tnow = next;\n\t\t\t\tnext = memo;\n\t\t\t\tArrays.fill(next, 0);\n\t\t\t}\n\t\t\tSystem.out.println(df.format(now[t] / a));\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\npublic class Main{\n\tstatic int n;\n\tstatic int gx,ex;\n\tstatic int gy,ey;\n\tstatic int[][][] memo;\n\tpublic static void main(String[] args) { \n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tn =sc.nextInt();\t\n\t\t\tif(n==0)break;\n\t\t\tString start=sc.next();\n\t\t\tString end=sc.next();\n\t\t\tString not=sc.next();\n\t\t\tint room[][][]=new int[n][2][2];\n\t\t\tint x=0,y=0;\n\t\t\tif(start.equals(\"B\"))\n\t\t\t\tx=1;\n\t\t\telse if(start.equals(\"C\"))\n\t\t\t\tx=2;\n\t\t\telse if(start.equals(\"D\"))\n\t\t\t\ty=1;\n\t\t\telse if(start.equals(\"E\")){\n\t\t\t\tx=1;y=1;\n\t\t\t}else if(start.equals(\"F\")){\n\t\t\t\tx=2;y=1;\n\t\t\t}else if(start.equals(\"G\"))\n\t\t\t\ty=2;\n\t\t\telse if(start.equals(\"H\")){\n\t\t\t\tx=1;y=2;\n\t\t\t}else if(start.equals(\"I\")){\n\t\t\t\tx=2;y=2;\n\t\t\t}\n\t\t\tgx=0;gy=0;\n\t\t\tif(end.equals(\"B\"))\n\t\t\t\tgx=1;\n\t\t\telse if(end.equals(\"C\"))\n\t\t\t\tgx=2;\n\t\t\telse if(end.equals(\"D\"))\n\t\t\t\tgy=1;\n\t\t\telse if(end.equals(\"E\")){\n\t\t\t\tgx=1;gy=1;\n\t\t\t}else if(end.equals(\"F\")){\n\t\t\t\tgx=2;gy=1;\n\t\t\t}else if(end.equals(\"G\"))\n\t\t\t\tgy=2;\n\t\t\telse if(end.equals(\"H\")){\n\t\t\t\tgx=1;gy=2;\n\t\t\t}else if(end.equals(\"I\")){\n\t\t\t\tgx=2;gy=2;\n\t\t\t}\n\t\t\tex=0;ey=0;\n\t\t\tif(not.equals(\"B\"))\n\t\t\t\tex=1;\n\t\t\telse if(not.equals(\"C\"))\n\t\t\t\tex=2;\n\t\t\telse if(not.equals(\"D\"))\n\t\t\t\tey=1;\n\t\t\telse if(not.equals(\"E\")){\n\t\t\t\tex=1;ey=1;\n\t\t\t}else if(not.equals(\"F\")){\n\t\t\t\tex=2;ey=1;\n\t\t\t}else if(not.equals(\"G\"))\n\t\t\t\tey=2;\n\t\t\telse if(not.equals(\"H\")){\n\t\t\t\tex=1;ey=2;\n\t\t\t}else if(not.equals(\"I\")){\n\t\t\t\tex=2;ey=2;\n\t\t\t}\n\t\t\tmemo=new int[3][3][n+1];\n\t\t\tSystem.out.printf(\"%.9f\\n\",(double)dfs(x,y,0)/Math.pow(4, n));\n//\t\t\tMath.pow(4, n)\n\t\t\t\n\t\t}\n\t}\n\tstatic int sx[]={1,0,-1,0};\n\tstatic int sy[]={0,1,0,-1};\n\t\n\tstatic int dfs(int x, int y, int battery){\n//\t\tSystem.out.println(x+\" \"+y+\" \"+battery);\n\t\t\n\t\tif(memo[x][y][battery]>0)return memo[x][y][battery];\n\t\tint result = 0;\n\t\tif(battery==n){\n\t\t\tif(gx==x&&gy==y)return 1;\n\t\t\telse return 0;\n\t\t}\n\t\tfor(int i=0;i<4;i++){\n\t\t\tint nx=x+sx[i];int ny=y+sy[i];\n\t\t\tif(nx<0||nx>2||ny<0||ny>2||(nx==ex&&ny==ey))result+=dfs(x,y,battery+1);\n\t\t\telse result+=dfs(nx,ny,battery+1);\n\t\t}\n\t\treturn memo[x][y][battery]=result;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\n\nimport java.util.*;\nimport java.math.*;\n\nimport static java.lang.Math.*;\nimport static java.util.Arrays.*;\nimport static java.util.Collections.*;\nimport static java.math.BigInteger.*;\nimport static java.lang.Character.*;\n\nclass AOJ1020 {\n\tint[] di = { +1, -1, +3, -3 };\n\n\tpublic void run() {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tif (n == 0)\n\t\t\t\treturn;\n\t\t\tint s = sc.next().charAt(0) - 'A';\n\t\t\tint t = sc.next().charAt(0) - 'A';\n\t\t\tint b = sc.next().charAt(0) - 'A';\n\n\t\t\tdouble[] prob = new double[9];\n\t\t\tdouble[][] move = new double[9][9];\n\t\t\tfor (int i = 0; i < 9; i++)\n\t\t\t\tfor (int d = 0; d < 4; d++) {\n\t\t\t\t\tint j = (i == b || !isValidMove(i, d)) ? i : i + di[d];\n\t\t\t\t\tmove[j][i] += .25;\n\t\t\t\t}\n\t\t\tprob[s] = 1.;\n\t\t\tfor (int k = 0; k < n; k++) {\n\t\t\t\tdouble[] np = new double[9];\n\t\t\t\tfor (int i = 0; i < 9; i++)\n\t\t\t\t\tfor (int j = 0; j < 9; j++)\n\t\t\t\t\t\tnp[i] += move[i][j] * prob[j];\n\t\t\t\tprob = np;\n\t\t\t}\n\t\t\tSystem.out.println(prob[t]);\n\t\t}\n\t}\n\n\tboolean isValidMove(int i, int d) {\n\t\tswitch (d) {\n\t\tcase 0:\n\t\t\treturn i % 3 < 2;\n\t\tcase 1:\n\t\t\treturn i % 3 > 0;\n\t\tcase 2:\n\t\t\treturn i < 6;\n\t\tcase 3:\n\t\t\treturn i > 2;\n\t\t}\n\t\treturn false;\n\t}\n}\n\npublic class Main {\n\tpublic static void main(String... args) {\n\t\tnew AOJ1020().run();\n\t}\n\n\tpublic static void debug(Object... os) {\n\t\tSystem.err.println(java.util.Arrays.deepToString(os));\n\t}\n}\n\nclass Scanner {\n\tfinal java.util.Scanner sc;\n\n\tpublic double nextDouble() {\n\t\treturn Double.parseDouble(sc.next());\n\t}\n\n\tpublic Scanner(java.io.InputStream is) {\n\t\tthis.sc = new java.util.Scanner(is);\n\t}\n\n\tpublic boolean hasNext() {\n\t\treturn sc.hasNext();\n\t}\n\n\tpublic String next() {\n\t\treturn sc.next();\n\t}\n\n\tpublic int nextInt() {\n\t\treturn Integer.parseInt(sc.next());\n\t}\n\n\tpublic String nextLine() {\n\t\treturn sc.nextLine();\n\t}\n\n\tpublic long nextLong() {\n\t\treturn Long.parseLong(sc.next());\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Iterator;\nimport java.util.LinkedList;\nimport java.util.Scanner;\n \n \npublic class Main {\n     \n    public static void main(String[] args) {\n        Scanner sc = new Scanner(System.in);\n        \n        while(true){\n        \tfinal int n = sc.nextInt();\n        \t\n        \tif(n == 0){\n        \t\tbreak;\n        \t}\n        \t\n        \tdouble[] pos = new double[9];\n        \t\n        \tfor(int i = 0; i < 9; i++){\n        \t\tpos[i] = 0;\n        \t}\n        \t\n        \tfinal int start = sc.next().toCharArray()[0] - 'A';\n        \tfinal int end = sc.next().toCharArray()[0] - 'A';\n        \tfinal int not = sc.next().toCharArray()[0] - 'A';\n        \t\n        \tpos[start] = 1;\n        \t\n        \tdouble[] next = new double[9];\n        \t\n        \tfor(int i = 0; i < n; i++){\n        \t\t\n        \t\tfor(int j = 0; j < 9; j++){\n        \t\t\tnext[j] = 0;\n        \t\t}\n        \t\t\n        \t\t//System.out.println(Arrays.toString(pos));\n        \t\t\n        \t\tfor(int j = 0; j < 9; j++){\n        \t\t\tif(j % 3 != 0){\n        \t\t\t\tif(not != j-1){\n        \t\t\t\t\tnext[j-1] += pos[j] / 4;\n        \t\t\t\t}\n        \t\t\t}\n        \t\t\t\n        \t\t\tif(j % 3 != 2){\n        \t\t\t\tif(not != j+1){\n        \t\t\t\t\tnext[j+1] += pos[j] / 4;\n        \t\t\t\t}\n        \t\t\t}\n        \t\t\t\n        \t\t\tif(j / 3 != 0){\n        \t\t\t\tif(not != j-3){\n        \t\t\t\t\tnext[j-3] += pos[j] / 4;\n        \t\t\t\t}\n        \t\t\t}\n        \t\t\t\n        \t\t\tif(j / 3 != 2){\n        \t\t\t\tif(not != j+3){\n        \t\t\t\t\tnext[j+3] += pos[j] / 4;\n        \t\t\t\t}\n        \t\t\t}\n        \t\t}\n        \t\t\n        \t\tdouble[] tmp = next;\n        \t\tnext = pos;\n        \t\tpos = tmp;\n        \t}\n        \t//System.out.println(Arrays.toString(pos));\n        \tSystem.out.printf(\"%.8f\\n\",pos[end]);\n        }\n    }\n \n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\t// 東,西,南,北\n\tfinal static byte nexts[][] = {//\n\t{ 1, -1, 3, -1 },// 0\n\t\t\t{ 2, 0, 4, -1 },// 1\n\t\t\t{ -1, 1, 5, -1 },// 2\n\t\t\t{ 4, -1, 6, 0 },// 3\n\t\t\t{ 5, 3, 7, 1 },// 4\n\t\t\t{ -1, 4, 8, 2 },// 5\n\t\t\t{ 7, -1, -1, 3 },// 6\n\t\t\t{ 8, 6, -1, 4 },// 7\n\t\t\t{ -1, 7, -1, 5 },// 8\n\t};\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic double probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\tbyte battery;\n\t\tbyte start;\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tif ((battery = Byte.parseByte(line)) == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1);\n\t\t\tSystem.out.println(probability);\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, double p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t}\n\t\t\treturn;\n\t\t} else {\n\t\t\tfor (byte n : next(current)) {\n\t\t\t\tif (n < 0 || n == storeroom) {\n\t\t\t\t\tclean(current, battery - 1, p / 4);\n\t\t\t\t} else {\n\t\t\t\t\tclean(n, battery - 1, p / 4);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\treturn nexts[current];\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\n//Cleaning Robot\npublic class Main{\n\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint[][] move = {{0,1},{0,-1},{1,0},{-1,0}};\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n==0)break;\n\t\t\tint x = sc.next().charAt(0)-'A';\n\t\t\tint si = x/3;\n\t\t\tint sj = x%3;\n\t\t\tx = sc.next().charAt(0)-'A';\n\t\t\tint gi = x/3;\n\t\t\tint gj = x%3;\n\t\t\tx = sc.next().charAt(0)-'A';\n\t\t\tint pi = x/3;\n\t\t\tint pj = x%3;\n\t\t\tdouble[][][] ex = new double[3][3][n+1];\n\t\t\tex[si][sj][0] = 1;\n\t\t\tfor(int k=1;k<=n;k++){\n\t\t\t\tfor(int i=0;i<3;i++){\n\t\t\t\t\tfor(int j=0;j<3;j++){\n\t\t\t\t\t\tfor(int d=0;d<4;d++){\n\t\t\t\t\t\t\tint ni = i+move[d][0];\n\t\t\t\t\t\t\tint nj = j+move[d][1];\n\t\t\t\t\t\t\tif(0<=ni&&ni<3&&0<=nj&&nj<3&&!(ni==pi&&nj==pj)){\n\t\t\t\t\t\t\t\tex[ni][nj][k] += 0.25*ex[i][j][k-1];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tex[i][j][k] += 0.25*ex[i][j][k-1];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.printf(\"%.8f\\n\", ex[gi][gj][n]);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic double probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\tbyte battery;\n\t\tbyte start;\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tif ((battery = Byte.parseByte(line)) == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1);\n\t\t\tSystem.out.println(probability);\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, double p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else {\n\t\t\tfor (byte d : next(current)) {\n\t\t\t\tif (d < 0 || d == storeroom) {\n\t\t\t\t\tclean(current, battery - 1, p / 4);\n\t\t\t\t} else {\n\t\t\t\t\tclean(d, battery - 1, p / 4);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\t// 東,西,南,北\n\t\tfinal byte nexts[][] = {//\n\t\t{ 1, -1, 3, -1 },// 0\n\t\t\t\t{ 2, 0, 4, -1 },// 1\n\t\t\t\t{ -1, 1, 5, -1 },// 2\n\t\t\t\t{ 4, -1, 6, 0 },// 3\n\t\t\t\t{ 5, 3, 7, 1 },// 4\n\t\t\t\t{ -1, 4, 8, 2 },// 5\n\t\t\t\t{ 7, -1, -1, 3 },// 6\n\t\t\t\t{ 8, 6, -1, 4 },// 7\n\t\t\t\t{ -1, 7, -1, 5 },// 8\n\t\t};\n\n\t\tbyte[] result = null;\n\n\t\tswitch (current) {\n\t\tcase 0:\n\t\t\tresult = nexts[0];\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tresult = nexts[1];\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tresult = nexts[2];\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tresult = nexts[3];\n\t\t\tbreak;\n\t\tcase 4:\n\t\t\tresult = nexts[4];\n\t\t\tbreak;\n\t\tcase 5:\n\t\t\tresult = nexts[5];\n\t\t\tbreak;\n\t\tcase 6:\n\t\t\tresult = nexts[6];\n\t\t\tbreak;\n\t\tcase 7:\n\t\t\tresult = nexts[7];\n\t\t\tbreak;\n\t\tcase 8:\n\t\t\tresult = nexts[8];\n\t\t\tbreak;\n\t\t}\n\t\treturn result;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tScanner in = new Scanner(System.in);\n\tpublic static void main(String[] args) {\n\t\tnew Main();\n\t}\n\n\tpublic Main() {\n\t\tnew AOJ1020().doIt();\n\t}\n\n\tclass AOJ1020{\n\t\tint[][][] dp;\n\t\tvoid print(int b){\n\t\t\tSystem.out.println();\n\t\t\tfor(int i=0;i<3;i++){\n\t\t\t\tfor(int j=0;j<3;j++)System.out.print(dp[i][j][b]+\" \");\n\t\t\t\tSystem.out.println();\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tvoid doIt(){\n\t\t\tHashMap<Character,Point> map = new HashMap<Character,Point>();\n\t\t\tmap.put('A',new Point(0, 0));\n\t\t\tmap.put('B',new Point(1, 0));\n\t\t\tmap.put('C',new Point(2, 0));\n\t\t\tmap.put('D',new Point(0, 1));\n\t\t\tmap.put('E',new Point(1, 1));\n\t\t\tmap.put('F',new Point(2, 1));\n\t\t\tmap.put('G',new Point(0, 2));\n\t\t\tmap.put('H',new Point(1, 2));\n\t\t\tmap.put('J',new Point(2, 2));\n\t\t\tint sx[] = {1,0,-1,0};\n\t\t\tint sy[] = {0,1,0,-1};\n\t\t\twhile(true){\n\t\t\t\tint n = in.nextInt();\n\t\t\t\tif(n==0)break;\n\t\t\t\tchar s = in.next().charAt(0);\n\t\t\t\tchar t = in.next().charAt(0);\n\t\t\t\tchar b = in.next().charAt(0);\n\t\t\t\tPoint bad = map.get(b);\n\t\t\t\tdp = new int[3][3][b+1];\n\t\t\t\tdp[map.get(s).y][map.get(s).x][0] = 1;\n//\t\t\t\tprint(0);\n\t\t\t\tfor(int i=0;i<=n;i++){\n\t\t\t\t\tfor(int y=0;y<3;y++)for(int x=0;x<3;x++)if(dp[y][x][i]>0){\n\t\t\t\t\t\tfor(int j=0;j<4;j++){\n\t\t\t\t\t\t\tint nx = x+sx[j];\n\t\t\t\t\t\t\tint ny = y+sy[j];\n\t\t\t\t\t\t\tif(nx<0||nx>=3||ny<0||ny>=3)dp[y][x][i+1]++;\n\t\t\t\t\t\t\telse if(bad.x==nx&&bad.y==ny)dp[y][x][i+1]++;\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tdp[ny][nx][i+1]++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n//\t\t\t\t\tprint(i);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdouble sum = 0;\n\t\t\t\tdouble goal = dp[map.get(t).y][map.get(t).x][n];\n\t\t\t\tfor(int i=0;i<3;i++)for(int k=0;k<3;k++)sum+=dp[i][k][n];\n\t\t\t\tif(sum==0||goal==0)System.out.println(\"0.00000000\");\n\t\t\t\telse System.out.printf(\"%.8f\\n\",goal/sum);\n\t\t\t}\n\t\t}\n\t\tclass Point{\n\t\t\tint x,y;\n\t\t\tpublic Point(int x,int y) {\n\t\t\t\tthis.x = x;\n\t\t\t\tthis.y = y;\n\t\t\t}\n\t\t}\n\n\t}\n\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\npublic class Main{\n\tpublic static void main(String[] args){\n        new Main().run();\n    }\n\tdouble allCount = 0;\n\tdouble ansCount = 0;\n\tint[] dx = {-1,0,0,1};\n\tint[] dy = {0,-1,1,0};\n\tint s;\n\tint t;\n\tint b;\n\tint n;\n\tpublic void run(){\n\t\tScanner scan = new Scanner(System.in);\n\t\twhile(scan.hasNext()){\n\t\t\tn = Integer.parseInt(scan.nextLine());\n\t\t\tif(n == 0){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tallCount = 0;\n\t\t\tansCount = 0;\n\t\t\tchar[] ch = scan.nextLine().replaceAll(\" \",\"\").toCharArray();\n\t\t\ts = (ch[0] - 'A');\n\t\t\tt = ch[1] - 'A';\n\t\t\tb = ch[2] - 'A';\n\t\t\tdfs(s/3,s%3,0);\n\t\t\tSystem.out.printf(\"%.6f\\n\",ansCount / allCount);\n\t\t}\n\t}\n\tpublic void dfs(int y,int x,int count){\n\t\tif(count == n){\n\t\t\tallCount++;\n\t\t\tif(x == t % 3 && y == t/3){\n\t\t\t\tansCount++;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tfor(int i = 0;i < 4;i++){\n\t\t\tif(x+dx[i] >= 0 && x+dx[i] < 3 && y+dy[i] >= 0 && y+dy[i] < 3){\n\t\t\t\tif(x+dx[i] == b % 3 && y+dy[i] == b / 3){\n\t\t\t\t\tdfs(y,x,count+1);\n\t\t\t\t}else{\n\t\t\t\t\tdfs(y+dy[i],x+dx[i],count+1);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tdfs(y,x,count+1);\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\n\npublic class Main {\n\n\tstatic byte charger;\n\tstatic byte storeroom;\n\tstatic double probability;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line = \"\";\n\n\t\tbyte battery;\n\t\tbyte start;\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\t\t\tif ((battery = Byte.parseByte(line)) == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tline = br.readLine();\n\t\t\tstart = (byte) (line.toCharArray()[0] - 'A');\n\t\t\tcharger = (byte) (line.toCharArray()[2] - 'A');\n\t\t\tstoreroom = (byte) (line.toCharArray()[4] - 'A');\n\n\t\t\tprobability = 0;\n\t\t\tclean(start, battery, 1);\n\t\t\tSystem.out.println(probability);\n\t\t}\n\t}\n\n\tstatic void clean(byte current, int battery, double p) {\n\t\tif (battery == 0) {\n\t\t\tif (current == charger) {\n\t\t\t\tprobability += p;\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else {\n\t\t\tfor (byte d : next(current)) {\n\t\t\t\tif (d < 0 || d == storeroom) {\n\t\t\t\t\tclean(current, battery - 1, p / 4);\n\t\t\t\t} else {\n\t\t\t\t\tclean(d, battery - 1, p / 4);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic byte[] next(byte current) {\n\t\t// 東,西,南,北\n\t\tfinal byte nexts[][] = {//\n\t\t{ 1, -1, 3, -1 },//\n\t\t\t\t{ 2, 0, 4, -1 },//\n\t\t\t\t{ -1, 1, 5, -1 },//\n\t\t\t\t{ 4, -1, 6, 0 },//\n\t\t\t\t{ 5, 3, 1, 7 },//\n\t\t\t\t{ -1, 4, 8, 2 },//\n\t\t\t\t{ 7, -1, -1, 3 },//\n\t\t\t\t{ 8, 6, -1, 4 },//\n\t\t\t\t{ -1, 7, -1, 5 },//\n\t\t};\n\n\t\tbyte[] result = null;\n\n\t\tswitch (current) {\n\t\tcase 0:\n\t\t\tresult = nexts[0];\n\t\t\tbreak;\n\t\tcase 1:\n\t\t\tresult = nexts[1];\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tresult = nexts[2];\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tresult = nexts[3];\n\t\t\tbreak;\n\t\tcase 4:\n\t\t\tresult = nexts[4];\n\t\t\tbreak;\n\t\tcase 5:\n\t\t\tresult = nexts[5];\n\t\t\tbreak;\n\t\tcase 6:\n\t\t\tresult = nexts[6];\n\t\t\tbreak;\n\t\tcase 7:\n\t\t\tresult = nexts[7];\n\t\t\tbreak;\n\t\tcase 8:\n\t\t\tresult = nexts[8];\n\t\t\tbreak;\n\t\t}\n\t\treturn result;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.InputStreamReader;\n\nclass Main{\n\tstatic double before[][];\n\tstatic double after[][];\n\tstatic boolean souko[][];\n\tpublic static void main(String args[]){\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\ttry{\n\t\t\twhile(true){\n\t\t\t\tint n = Integer.parseInt(br.readLine());\n\t\t\t\tif(n == 0) return;\n\n\t\t\t\tString strs[] = br.readLine().split(\" \");\n\t\t\t\tchar s = strs[0].charAt(0);\n\t\t\t\tchar t = strs[1].charAt(0);\n\t\t\t\tchar b = strs[2].charAt(0);\n\n\t\t\t\tbefore = new double[3][3];\n\t\t\t\tsouko = new boolean[3][3];\n\n\t\t\t\tint ts[] = charToInts(b);\n\t\t\t\tsouko[ts[0]][ts[1]] = true;\n\t\t\t\t//print(souko);\n\n\t\t\t\tint ss[] = charToInts(s);\n\t\t\t\tbefore[ss[0]][ss[1]] = 1.0;\n\t\t\t\t//print(before);\n\n\t\t\t\tfor(int i = 0; i < n; i++){\n\t\t\t\t\tafter = new double[3][3];\n\t\t\t\t\tcalc();\n\t\t\t\t\tbefore = after;\n\t\t\t\t\t//print(before);\n\t\t\t\t}\n\n\t\t\t\tint tts[] = charToInts(t);\n\t\t\t\tSystem.out.println(before[ts[0]][ts[1]]);\n\t\t\t}\n\t\t}catch(Exception e){\n\t\t}\n\t}\n\n\tstatic void calc(){\n\t\tfor(int i = 0; i < 3; i++){\n\t\t\tfor(int j = 0; j < 3; j++){\n\t\t\t\tdouble p = before[i][j] * 0.25;\n\t\t\t\t// ←\n\t\t\t\tif(j == 0 || souko[i][j-1]){\n\t\t\t\t\tafter[i][j] += p;\n\t\t\t\t}else{\n\t\t\t\t\tafter[i][j-1] += p;\n\t\t\t\t}\n\n\t\t\t\t// ↑\n\t\t\t\tif(i == 0 || souko[i-1][j]){\n\t\t\t\t\tafter[i][j] += p;\n\t\t\t\t}else{\n\t\t\t\t\tafter[i-1][j] += p;\n\t\t\t\t}\n\n\t\t\t\t// →\n\t\t\t\tif(j == 2 || souko[i][j+1]){\n\t\t\t\t\tafter[i][j] += p;\n\t\t\t\t}else{\n\t\t\t\t\tafter[i][j+1] += p;\n\t\t\t\t}\n\n\t\t\t\t// ↓\n\t\t\t\tif(i == 2 || souko[i+1][j]){\n\t\t\t\t\tafter[i][j] += p;\n\t\t\t\t}else{\n\t\t\t\t\tafter[i+1][j] += p;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic int[] charToInts(char c){\n\t\tint m = c - 'A';\n\t\tSystem.out.println(m);\n\t\tint result[] = {m / 3, m % 3};\n\t\tSystem.out.println(\"(\" + result[0] + \", \" + result[1] + \")\");\n\t\treturn result;\n\t}\n\n\tstatic void print(double m[][]){\n\t\tfor(int i = 0; i < m.length; i++){\n\t\t\tfor(int j = 0; j < m[i].length; j++){\n\t\t\t\tSystem.out.print(m[i][j] + \"\\t\");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tstatic void print(boolean m[][]){\n\t\tfor(int i = 0; i < m.length; i++){\n\t\t\tfor(int j = 0; j < m[i].length; j++){\n\t\t\t\tSystem.out.print(m[i][j] + \"\\t\");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\npublic class Main{\n\tstatic int n;\n\tstatic int gx,ex;\n\tstatic int gy,ey;\n\tstatic int[][][] memo;\n\tpublic static void main(String[] args) { \n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tn =sc.nextInt();\t\n\t\t\tif(n==0)break;\n\t\t\tString start=sc.next();\n\t\t\tString end=sc.next();\n\t\t\tString not=sc.next();\n\t\t\tint room[][][]=new int[n][2][2];\n\t\t\tint x=0,y=0;\n\t\t\tif(start.equals(\"B\"))\n\t\t\t\tx=1;\n\t\t\telse if(start.equals(\"C\"))\n\t\t\t\tx=2;\n\t\t\telse if(start.equals(\"D\"))\n\t\t\t\tx=1;\n\t\t\telse if(start.equals(\"E\")){\n\t\t\t\tx=1;y=1;\n\t\t\t}else if(start.equals(\"F\")){\n\t\t\t\tx=1;y=2;\n\t\t\t}else if(start.equals(\"G\"))\n\t\t\t\tx=2;\n\t\t\telse if(start.equals(\"H\")){\n\t\t\t\tx=2;y=1;\n\t\t\t}else if(start.equals(\"I\")){\n\t\t\t\tx=2;y=2;\n\t\t\t}\n\t\t\tgx=0;gy=0;\n\t\t\tif(end.equals(\"B\"))\n\t\t\t\tgx=1;\n\t\t\telse if(end.equals(\"C\"))\n\t\t\t\tgx=2;\n\t\t\telse if(end.equals(\"D\"))\n\t\t\t\tgx=1;\n\t\t\telse if(end.equals(\"E\")){\n\t\t\t\tgx=1;gy=1;\n\t\t\t}else if(end.equals(\"F\")){\n\t\t\t\tgx=1;gy=2;\n\t\t\t}else if(end.equals(\"G\"))\n\t\t\t\tgx=2;\n\t\t\telse if(end.equals(\"H\")){\n\t\t\t\tgx=2;gy=1;\n\t\t\t}else if(end.equals(\"I\")){\n\t\t\t\tgx=2;gy=2;\n\t\t\t}\n\t\t\tex=0;ey=0;\n\t\t\tif(not.equals(\"B\"))\n\t\t\t\tex=1;\n\t\t\telse if(not.equals(\"C\"))\n\t\t\t\tex=2;\n\t\t\telse if(not.equals(\"D\"))\n\t\t\t\tex=1;\n\t\t\telse if(not.equals(\"E\")){\n\t\t\t\tex=1;ey=1;\n\t\t\t}else if(not.equals(\"F\")){\n\t\t\t\tex=1;ey=2;\n\t\t\t}else if(not.equals(\"G\"))\n\t\t\t\tex=2;\n\t\t\telse if(not.equals(\"H\")){\n\t\t\t\tex=2;ey=1;\n\t\t\t}else if(not.equals(\"I\")){\n\t\t\t\tex=2;ey=2;\n\t\t\t}\n\t\t\tmemo=new int[3][3][n+1];\n\t\t\tSystem.out.printf(\"%.9f\\n\",(double)dfs(x,y,0)/Math.pow(4, n));\n//\t\t\tMath.pow(4, n)\n\t\t\t\n\t\t}\n\t}\n\tstatic int sx[]={1,0,-1,0};\n\tstatic int sy[]={0,1,0,-1};\n\t\n\tstatic int dfs(int x, int y, int battery){\n//\t\tSystem.out.println(x+\" \"+y+\" \"+battery);\n\t\t\n\t\tif(memo[x][y][battery]>0)return memo[x][y][battery];\n\t\tint result = 0;\n\t\tif(battery==n){\n\t\t\tif(gx==x&&gy==y)return 1;\n\t\t\telse return 0;\n\t\t}\n\t\tfor(int i=0;i<4;i++){\n\t\t\tint nx=x+sx[i];int ny=y+sy[i];\n\t\t\tif(nx<0||nx>2||ny<0||ny>2||(nx==ex&&ny==ey))result+=dfs(x,y,battery+1);\n\t\t\telse result+=dfs(nx,ny,battery+1);\n\t\t}\n\t\treturn memo[x][y][battery]=result;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport static java.util.Arrays.*;\nimport static java.lang.Math.*;\n\nclass Main {\n\tstatic Scanner sc = new Scanner(System.in);\n\tstatic int n;\n\tstatic char s, t, b;\n\tstatic int[] dx = {-1, 0, 1, 0}, dy = {0, -1, 0, 1};\n\t\n\tpublic static void main(String[] args) {\n\t\twhile (read()) {\n\t\t\tsolve();\n\t\t}\n\t}\n\n\tstatic boolean read() {\n\t\tn = sc.nextInt();\n\t\tif (n == 0) return false;\n\t\t\n\t\ts = sc.next().charAt(0);\n\t\tt = sc.next().charAt(0);\n\t\tb = sc.next().charAt(0);\n\t\t\n\t\treturn true;\n\t}\n\n\tstatic void solve() {\n\t\tdouble[][][] dp = new double[n + 1][5][5];\n\t\tfor (int i = 0; i < n; i++) \n\t\t\tfor (int j = 0; j < 5; j++)\n\t\t\t\tfill(dp[i][j], 0);\n\t\tint pos_s = s - 'A', pos_t = t - 'A', pos_b = b - 'A';\n\t\tint sx = pos_s % 3 + 1, sy = pos_s / 3 + 1;\n\t\tint gx = pos_t % 3 + 1, gy = pos_t / 3 + 1;\n\t\tint bx = pos_b % 3 + 1, by = pos_b / 3 + 1;\n\t\t\n\t\tdp[0][sy][sx] = 1.0;\n\t\t\n\t\tfor (int i = 1; i <= n; i++) {\n\t\t\tfor (int y = 1; y <= 3; y++) {\n\t\t\t\tfor (int x = 1; x <= 3; x++) {\n\t\t\t\t\tfor (int l = 0; l < 4; l++) {\n\t\t\t\t\t\tint ty = y + dy[l], tx = x + dx[l];\n\t\t\t\t\t\tif ((y == by) && (x == bx)){\n\t\t\t\t\t\t\tty = y; tx = x;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdp[i][y][x] += dp[i - 1][ty][tx] / 4.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tSystem.out.printf(\"%.8f\", dp[n][gy][gx]);\n\t\tSystem.out.println();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.IOException;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) throws IOException {\n\n\t\tnew Main().run();\n\t}\n\n\tprivate void run() throws IOException {\n\t\tScanner scanner = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint n = scanner.nextInt();\n\t\t\tif (n == 0)\n\t\t\t\tbreak;\n\t\t\tint[] xs = new int[3];\n\t\t\tint[] ys = new int[3];\n\t\t\tfor (int i = 0; i < 3; i++) {\n\t\t\t\tint a = scanner.next().charAt(0) - 'A';\n\t\t\t\txs[i] = a % 3;\n\t\t\t\tys[i] = a / 3;\n\t\t\t}\n\t\t\tdouble[][][] dp = new double[2][3][3];\n\t\t\tint u = 0;\n\t\t\tdp[u][xs[0]][ys[0]] = 1;\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tfor (int x = 0; x < 3; x++) {\n\t\t\t\t\tfor (int y = 0; y < 3; y++) {\n\t\t\t\t\t\tif(dp[u][x][y]==0)\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tfor (int[] m : move) {\n\t\t\t\t\t\t\tint nx = x + m[0];\n\t\t\t\t\t\t\tint ny = y + m[1];\n\t\t\t\t\t\t\tif (nx == xs[2] && ny == ys[2] || nx < 0 || 2 < nx\n\t\t\t\t\t\t\t\t\t|| ny < 0 || 2 < ny)\n\t\t\t\t\t\t\t\tdp[1 - u][x][y] += dp[u][x][y] / 4;\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tdp[1 - u][nx][ny] += dp[u][x][y] / 4;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdp[u][x][y] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tu = 1 - u;\n\t\t\t}\n\t\t\tSystem.out.printf(\"%.8f\\n\", dp[u][xs[1]][ys[1]]);\n\t\t}\n\t}\n\n\tint[][] move = { { -1, 0 }, { 0, -1 }, { 0, 1 }, { 1, 0 } };\n\n}"
  },
  {
    "language": "C#",
    "code": "using System;\nusing System.Linq;\nusing System.Collections.Generic;\n\n\nnamespace Test1 {\n\n\n\n    class ClassMain {\n\n\n        public static void Main(String[] args) {\n            string line;\n            while ((line = Console.ReadLine()) != null) {\n                //int[] ints = line.Split(' ').Select(int.Parse).ToArray();\n                //int n = ints[0];\n                int n = int.Parse(line);\n                if(n==0){break;}\n\n                //int[] ints = Console.ReadLine().Split(' ').Select(int.Parse).ToArray();\n                string[] strs = Console.ReadLine().Split(' ');\n                char s = strs[0][0];\n                char t = strs[1][0];\n                char b = strs[2][0];\n\n\n                double[,] yasiki = new double[3, 3];\n                int indexS = s - 'A';\n                yasiki[indexS / 3, indexS % 3] = 1.0;\n                int indexB = b - 'A';\n                yasiki[indexB / 3, indexB % 3] = 0.0;\n\n                \n\n                while (n-- > 0) {\n                    double[,] newyasiki = new double[3, 3];\n                    newyasiki[indexB / 3, indexB % 3] = -1.0;\n\n                    if (newyasiki[0, 0] > -0.5) {\n                        newyasiki[0, 0] = yasiki[0, 1] * 0.25 + yasiki[1, 0] * 0.25;\n                        newyasiki[0, 0] += yasiki[0, 0] * 0.5;\n                    }\n                    if (newyasiki[0, 1] > -0.5) {\n                        newyasiki[0, 1] = yasiki[0, 0] * 0.25 + yasiki[0, 2] * 0.25 \n                            + yasiki[1, 1] * 0.25;\n                        newyasiki[0, 1] += yasiki[0, 1] * 0.25;\n                    }\n                    if (newyasiki[0, 2] > -0.5) {\n                        newyasiki[0, 2] = yasiki[0, 1] * 0.25 + yasiki[1, 2] * 0.25;\n                        newyasiki[0, 2] += yasiki[0, 2] * 0.5;\n                    }\n                    if (newyasiki[1, 0] > -0.5) {\n                        newyasiki[1, 0] = yasiki[0, 0] * 0.25 + yasiki[2, 0] * 0.25 + \n                            yasiki[1, 1] * 0.25;\n                        newyasiki[1, 0] += yasiki[1, 0] * 0.25;\n                    }\n                    if (newyasiki[1, 1] > -0.5) {\n                        newyasiki[1, 1] = yasiki[0, 1] * 0.25 + yasiki[1, 0] * 0.25\n                            + yasiki[1, 2] * 0.25 + yasiki[2, 1] * 0.25;\n                    }\n                    if (newyasiki[1, 2] > -0.5) {\n                        newyasiki[1, 2] = yasiki[0, 2] * 0.25 + yasiki[1, 1] * 0.25\n                            + yasiki[2, 2] * 0.25;\n                        newyasiki[1, 2] += yasiki[1, 2] * 0.25;\n                    }\n                    if (newyasiki[2, 0] > -0.5) {\n                        newyasiki[2, 0] = yasiki[2, 1] * 0.25 + yasiki[1, 0] * 0.25;\n                        newyasiki[2, 0] += yasiki[2, 0] * 0.5;\n                    }\n                    if (newyasiki[2, 1] > -0.5) {\n                        newyasiki[2, 1] = yasiki[2, 0] * 0.25 + yasiki[2, 2] * 0.25\n                            + yasiki[1, 1] * 0.25;\n                        newyasiki[2, 1] += yasiki[2, 1] * 0.25;\n                    }\n                    if (newyasiki[2, 2] > -0.5) {\n                        newyasiki[2, 2] = yasiki[2, 1] * 0.25 + yasiki[1, 2] * 0.25;\n                        newyasiki[2, 2] += yasiki[2, 2] * 0.5;\n\n                    }\n                    \n                    \n                    if (indexB == 0) {\n                        newyasiki[0, 1] += 0.25 * yasiki[0, 1];\n                        newyasiki[1, 0] += 0.25 * yasiki[1, 0];\n                    }\n                    if (indexB == 1) {\n                        newyasiki[0, 0] += 0.25 * yasiki[0, 0];\n                        newyasiki[1, 1] += 0.25 * yasiki[1, 1];\n                        newyasiki[0, 2] += 0.25 * yasiki[0, 2];\n                    }\n                    if (indexB == 2) {\n                        newyasiki[0, 1] += 0.25 * yasiki[0, 1];\n                        newyasiki[1, 2] += 0.25 * yasiki[1, 2];\n                    }\n\n\n                    if (indexB == 3) {\n                        newyasiki[0, 0] += 0.25 * yasiki[0, 0];\n                        newyasiki[1, 1] += 0.25 * yasiki[1, 1];\n                        newyasiki[2, 0] += 0.25 * yasiki[2, 0];\n                    }\n                    if (indexB == 4) {\n                        newyasiki[0, 1] += 0.25 * yasiki[0, 1];\n                        newyasiki[1, 0] += 0.25 * yasiki[1, 0];\n                        newyasiki[1, 2] += 0.25 * yasiki[1, 2];\n                        newyasiki[2, 1] += 0.25 * yasiki[2, 1];\n                    }\n                    if (indexB == 5) {\n                        newyasiki[0, 2] += 0.25 * yasiki[0, 2];\n                        newyasiki[1, 1] += 0.25 * yasiki[1, 1];\n                        newyasiki[2, 2] += 0.25 * yasiki[2, 2];\n                    }\n                    if (indexB == 6) {\n                        newyasiki[2, 1] += 0.25 * yasiki[2, 1];\n                        newyasiki[1, 0] += 0.25 * yasiki[1, 0];\n                    }\n                    if (indexB == 7) {\n                        newyasiki[2, 0] += 0.25 * yasiki[2, 0];\n                        newyasiki[1, 1] += 0.25 * yasiki[1, 1];\n                        newyasiki[2, 2] += 0.25 * yasiki[2, 2];\n                    }\n                    if (indexB == 8) {\n                        newyasiki[2, 1] += 0.25 * yasiki[2, 1];\n                        newyasiki[1, 2] += 0.25 * yasiki[1, 2];\n                    }\n\n                    for (int i = 0; i < 3; i++) for (int j = 0; j < 3; j++) {\n                        yasiki[i, j] = newyasiki[i, j];\n                        }\n                    yasiki[indexB / 3, indexB % 3] = 0.0;\n                   \n                }\n\n                int indexT = t - 'A';\n                double prob = yasiki[indexT / 3, indexT % 3];\n                Console.WriteLine(prob);\n\n\n            }\n            \n        }\n\n        \n    }\n\n    \n\n    \n}"
  },
  {
    "language": "C#",
    "code": "using System;\nusing System.Collections.Generic;\nusing System.Text;\n\nclass TEST{\n\tstatic void Main(){\n\t\twhile(true){\n\t\t\tvar d=int.Parse(Console.ReadLine());\n\t\t\tif(d==0)break;\n\t\t\tSol mySol=new Sol(d);\n\t\t\tConsole.WriteLine(\"{0,10:F8}\",mySol.Ans);\n\t\t}\n\t}\n}\n\nclass Sol{\n\tdouble ans;\n\tpublic double Ans{\n\t\tget{return ans;}\n\t}\n\t\n\t\n\tpublic Sol(int d){\n\t\tdouble[,][] P=new double[3,3][];\n\t\tfor(int i=0;i<9;i++)P[i%3,i/3]=new double[d+1];\n\t\t\n\t\tvar ss=Console.ReadLine().Split(' ');\n\t\tint posS;\n\t\tint posT;\n\t\tint posB;\n\t\t\n\t\tfor(int i=0;i<9;i++)P[i%3,i/3][0]=0;\n\t\tposS=(int)(ss[0][0]-'A');\n\t\tposT=(int)(ss[1][0]-'A');\n\t\tposB=(int)(ss[2][0]-'A');\n\t\t\n\t\tP[posS%3,posS/3][0]=1.0;\n\t\t\n\t\tdouble[,][] Pd=new double[3,3][];\n\t\tfor(int i=0;i<9;i++){\n\t\t\tint x=i%3;\n\t\t\tint y=i/3;\n\t\t\tPd[x,y]=new double[5]{0.0,0.25,0.25,0.25,0.25};// 0:pause,1:Left,2:Right,3:Down,4:Up\n\t\t\t\n\t\t\tif(x==0 || (x==posB%3+1 && y==posB/3  ) ){Pd[x,y][0]+=0.25;Pd[x,y][1]-=0.25;}\n\t\t\tif(x==2 || (x==posB%3-1 && y==posB/3  ) ){Pd[x,y][0]+=0.25;Pd[x,y][2]-=0.25;}\n\t\t\tif(y==0 || (x==posB%3   && y==posB/3+1) ){Pd[x,y][0]+=0.25;Pd[x,y][4]-=0.25;}\n\t\t\tif(y==2 || (x==posB%3   && y==posB/3-1) ){Pd[x,y][0]+=0.25;Pd[x,y][3]-=0.25;}\n\t\t\t\n\t\t}\n\t\t\n\t\tfor(int j=1;j<=d;j++){\n\t\t\tfor(int k=0;k<9;k++){\n\t\t\t\tint xx=k%3;\n\t\t\t\tint yy=k/3;\n\t\t\t\tP[xx,yy][j] =P[xx,yy][j-1]*Pd[xx,yy][0];\n\t\t\t\tif(xx+1<=2)P[xx,yy][j]+=P[xx+1,yy][j-1]*Pd[xx+1,yy][1];\n\t\t\t\tif(xx-1>=0)P[xx,yy][j]+=P[xx-1,yy][j-1]*Pd[xx-1,yy][2];\n\t\t\t\tif(yy-1>=0)P[xx,yy][j]+=P[xx,yy-1][j-1]*Pd[xx,yy-1][3];\n\t\t\t\tif(yy+1<=2)P[xx,yy][j]+=P[xx,yy+1][j-1]*Pd[xx,yy+1][4];\n\t\t\t}\n\t\t}\n\t\t\n\t\tans=P[posT%3,posT/3][d];\n\t\n\t}\n}"
  },
  {
    "language": "C#",
    "code": "using System;\nusing System.Linq;\nusing System.Collections.Generic;\n\n\nnamespace Test1 {\n\n\n\n    class ClassMain {\n\n\n        public static void Main(String[] args) {\n            string line;\n            while ((line = Console.ReadLine()) != null) {\n                //int[] ints = line.Split(' ').Select(int.Parse).ToArray();\n                //int n = ints[0];\n                int n = int.Parse(line);\n                if(n==0){break;}\n\n                //int[] ints = Console.ReadLine().Split(' ').Select(int.Parse).ToArray();\n                string[] strs = Console.ReadLine().Split(' ');\n                char s = strs[0][0];\n                char t = strs[1][0];\n                char b = strs[2][0];\n\n\n                double[,] yasiki = new double[3, 3];\n                int indexS = s - 'A';\n                yasiki[indexS / 3, indexS % 3] = 1.0;\n                int indexB = b - 'A';\n                yasiki[indexB / 3, indexB % 3] = 0.0;\n\n                \n\n                while (n-- > 0) {\n                    double[,] newyasiki = new double[3, 3];\n                    newyasiki[indexB / 3, indexB % 3] = -1.0;\n\n                    if (newyasiki[0, 0] > -0.5) {\n                        newyasiki[0, 0] = yasiki[0, 1] * 0.25 + yasiki[1, 0] * 0.25;\n                    }\n                    if (newyasiki[0, 1] > -0.5) {\n                        newyasiki[0, 1] = yasiki[0, 0] * 0.25 + yasiki[0, 2] * 0.25 \n                            + yasiki[1, 1] * 0.25;\n                    }\n                    if (newyasiki[0, 2] > -0.5) {\n                        newyasiki[0, 2] = yasiki[0, 1] * 0.25 + yasiki[1, 2] * 0.25;\n                    }\n                    if (newyasiki[1, 0] > -0.5) {\n                        newyasiki[1, 0] = yasiki[0, 0] * 0.25 + yasiki[2, 0] * 0.25 + \n                            yasiki[1, 1] * 0.25;\n                    }\n                    if (newyasiki[1, 1] > -0.5) {\n                        newyasiki[1, 1] = yasiki[0, 1] * 0.25 + yasiki[1, 0] * 0.25\n                            + yasiki[1, 2] * 0.25 + yasiki[2, 1] * 0.25;\n                    }\n                    if (newyasiki[1, 2] > -0.5) {\n                        newyasiki[1, 2] = yasiki[0, 2] * 0.25 + yasiki[1, 1] * 0.25\n                            + yasiki[2, 2] * 0.25;\n                    }\n                    if (newyasiki[2, 0] > -0.5) {\n                        newyasiki[2, 0] = yasiki[2, 1] * 0.25 + yasiki[1, 0] * 0.25;\n                    }\n                    if (newyasiki[2, 1] > -0.5) {\n                        newyasiki[2, 1] = yasiki[2, 0] * 0.25 + yasiki[2, 2] * 0.25\n                            + yasiki[1, 1] * 0.25;\n                    }\n                    if (newyasiki[2, 2] > -0.5) {\n                        newyasiki[2, 2] = yasiki[2, 1] * 0.25 + yasiki[1, 2] * 0.25;\n                    }\n                    for (int i = 0; i < 3; i++) for (int j = 0; j < 3; j++) {\n                        yasiki[i, j] = newyasiki[i, j];\n                        }\n                    yasiki[indexB / 3, indexB % 3] = 0.0;\n                   \n                }\n\n                int indexT = t - 'A';\n                double prob = yasiki[indexT / 3, indexT % 3];\n                Console.WriteLine(prob);\n\n\n            }\n            \n        }\n\n        \n    }\n\n    \n\n    \n}"
  },
  {
    "language": "Ruby",
    "code": "# encoding: utf-8                                                            \n\n$map = {\n  :A => [1, 1], :B => [1, 2], :C => [1, 3],\n  :D => [2, 1], :E => [2, 2], :F => [2, 3],\n  :G => [3, 1], :H => [3, 2], :I => [3, 3]\n}\n \ndef solve(n, s, b, j)\n  s, b, j = s.to_sym, b.to_sym, j.to_sym\n  dis = ($map[s][0] - $map[b][0]).abs + ($map[s][1] - $map[b][1]).abs\n  if dis > n\n    0.0\n  else\n    0.25 ** dis\n  end\nend\n\nwhile n = gets\n  n = n.to_i  \n  break if n == 0\n  s, b, j = gets.rstrip.split(/\\s/)\n  puts (\"%.8f\" % solve(n, s, b, j))\nend"
  },
  {
    "language": "Ruby",
    "code": "adjacent = {\"A\" => [\"A\", \"B\", \"D\", \"A\"], \"B\" => [\"B\", \"C\", \"E\", \"A\"], \"C\" => [\"C\", \"C\", \"F\", \"B\"],\n            \"D\" => [\"A\", \"E\", \"G\", \"D\"], \"E\" => [\"B\", \"F\", \"H\", \"D\"], \"F\" => [\"C\", \"F\", \"I\", \"E\"],\n            \"G\" => [\"D\", \"H\", \"G\", \"G\"], \"H\" => [\"E\", \"I\", \"H\", \"G\"], \"I\" => [\"F\", \"I\", \"I\", \"H\"]}\nwhile true\n    n = gets.to_i\n    break if n == 0\n    s, t, b = gets.chomp.split\n    arr = Array.new(n + 1){Hash.new(0)}\n    arr[n][s] = 1\n    n.downto(1){|i|\n        arr[i].to_a.each{|k, v|\n            adjacent[k].each{|x|\n                case x\n                when b then arr[i - 1][k] += v\n                else arr[i - 1][x] += v\n                end\n            }\n        }\n    }\n    puts arr[0][t] / arr[0].values.inject(:+).to_f\nend\n"
  },
  {
    "language": "Ruby",
    "code": "require 'matrix'\n\nloop do\n    n = gets.to_i\n    break if n == 0\n    s, t, b = gets.chomp.split.map{|c| c.ord - ?A.ord}\n\n    d = [2, 1, 2,\n         1, 0, 1,\n         2, 1, 2]\n    d[b-3] += 1 if b > 2\n    d[b-1] += 1 if b % 3 > 0\n    d[b+1] += 1 if b % 3 < 2\n    d[b+3] += 1 if b < 6\n\n    m = Matrix.build(9, 9) do |i, j|\n        if j == i\n            d[i] / 4.0\n        elsif j == b\n            0\n        elsif i / 3 == j / 3 && (i - j).abs == 1\n            0.25\n        elsif i % 3 == j % 3 && (i - j).abs == 3\n            0.25\n        else\n            0\n        end\n    end\n\n    a = [0] * 9\n    a[s] = 1.0\n    v = Matrix[a]\n    p (v * m ** n)[0, t]\nend"
  },
  {
    "language": "Ruby",
    "code": "require 'matrix'\n\nloop do\n    n = gets.to_i\n    break if n == 0\n    s, t, b = gets.chomp.split.map{|c| c.ord - ?A.ord}\n\n    d = [2, 1, 2,\n         1, 0, 1,\n         2, 1, 2]\n    d[b-3] += 1 if b > 2\n    d[b-1] += 1 if b % 3 > 0\n    d[b+1] += 1 if b % 3 < 2\n    d[b+3] += 1 if b < 6\n\n    m = Matrix.build(9, 9) do |i, j|\n        if j == i\n            d[i] / 4.0\n        elsif j == b\n            0\n        elsif i / 3 == j / 3 && (i - j).abs == 1\n            0.25\n        elsif i % 3 == j % 3 && (i - j).abs == 3\n            0.25\n        else\n            0\n        end\n    end\n\n    p (m ** n)[s, t]\nend"
  },
  {
    "language": "Ruby",
    "code": "loop{\n\tn = gets.to_i()\n\tif n == 0 then\n\t\tbreak\n\tend\n\t\n\ts,t,b = gets.split\n\troom_path = {\t\"A\"=>[\"B\",\"D\"],\t\t\"B\"=>[\"A\",\"C\",\"E\"],\t\t\"C\"=>[\"B\",\"F\"],\n\t\t\t\t\t\"D\"=>[\"A\",\"E\",\"G\"],\t\"E\"=>[\"D\",\"B\",\"F\",\"H\"],\t\"F\"=>[\"E\",\"C\",\"I\"],\n\t\t\t\t\t\"G\"=>[\"H\",\"D\"],\t\t\"H\"=>[\"E\",\"G\",\"I\"],\t\t\"I\"=>[\"F\",\"H\"]}\n\t\t\t\t\t\n\troom_path[b].each{|r|\n\t\troom_path[r].select!{|item| item != b}\n\t}\n\t\n\troom = Hash.new(0.0)\n\troom[s] = 1.0\n\t\n\t\n\tn.times do\n\t\ttroom = Hash.new(0.0)\n\t\troom_path.each_key{|key|\n\t\t\ttroom[key] = room[key]\n\t\t}\n\t\t\n\t\troom_path.each{|key,path|\n\t\t\troom[key] = ((4.0-path.size())/4) * troom[key]\n\t\t\tpath.each{|r|\n\t\t\t\troom[key] += troom[r]/4\n\t\t\t}\n\t\t}\n\tend\n\tp room[t]\n\t\n}"
  },
  {
    "language": "Ruby",
    "code": "while (n = gets.chomp.to_i) != 0\n  s,t,b = gets.chomp.split\n\n  rooms = {\n    [0,0] => {name: \"A\", value: 0}, \n    [0,1] => {name: \"B\", value: 0}, \n    [0,2] => {name: \"C\", value: 0}, \n    [1,0] => {name: \"D\", value: 0}, \n    [1,1] => {name: \"E\", value: 0}, \n    [1,2] => {name: \"F\", value: 0}, \n    [2,0] => {name: \"G\", value: 0}, \n    [2,1] => {name: \"H\", value: 0}, \n    [2,2] => {name: \"I\", value: 0}\n  } \n\n  rooms.each_value{|room| room[:value] = 1 if room[:name] == s}\n  rooms.delete_if{|k, v| v[:name] == b}\n\n  n.times do |n|\n    tmp = {\n      [0,0] => 0, [0,1] => 0, [0,2] => 0,\n      [1,0] => 0, [1,1] => 0, [1,2] => 0,\n      [2,0] => 0, [2,1] => 0, [2,2] => 0\n    }\n    rooms.each do |k, v|\n      if v[:value] != 0\n        row = k[0]\n        column = k[1]\n        p = v[:value] / 4.0\n        #up\n        if rooms.has_key?([row-1, column])\n          rooms[k][:value] -= p\n          tmp[[row-1, column]] += p\n        end\n        #down\n        if rooms.has_key?([row+1, column])\n          rooms[k][:value] -= p\n          tmp[[row+1, column]] += p\n        end\n        #left\n        if rooms.has_key?([row, column-1])\n          rooms[k][:value] -= p\n          tmp[[row, column-1]] += p\n        end\n        #right\n        if rooms.has_key?([row, column+1])\n          rooms[k][:value] = p\n          tmp[[row, column+1]] += p\n        end\n      end\n    end\n    rooms.each_key do |k|\n      rooms[k][:value] = tmp[k]\n    end\n  end\n  rooms.each_value do |v|\n    puts v[:value] if v[:name] == t\n  end\nend"
  },
  {
    "language": "Ruby",
    "code": "### constant\n\nN = 3\nNN = N * N\n\nDIRS = [[1, 0], [0, -1], [-1, 0], [0, 1]]\n\n### main\n\nch2xy = {}\nfor y in (0...N)\n  for x in (0...N)\n    id = y * N + x\n    ch2xy[('A'.ord + id).chr] = [x, y]\n  end\nend\n#p ch2xy\n\nzmtx = NN.times.map{0.0}\n\nloop do\n  n = gets.to_i\n  break if n == 0\n\n  s, t, b = gets.split\n\n  sx, sy = ch2xy[s]\n  tx, ty = ch2xy[t]\n  bx, by = ch2xy[b]\n  #p [sx, sy, tx, ty, bx, by]\n\n  pmtx = zmtx.clone\n  pmtx[sy * N + sx] = 1.0\n\n  n.times do\n    pmtx0 = pmtx\n    pmtx = zmtx.clone\n\n    for y in (0...N)\n      for x in (0...N)\n        for dir in DIRS\n          x0 = x + dir[0]\n          y0 = y + dir[1]\n          if x0 >= 0 && x0 < N && y0 >= 0 && y0 < N && (x0 != bx || y0 != by)\n            pmtx[y0 * N + x0] += pmtx0[y * N + x] * 0.25\n          else\n            pmtx[y * N + x] += pmtx0[y * N + x] * 0.25\n          end\n        end\n      end\n    end\n  end\n\n  printf(\"%.8f\\n\", pmtx[ty * N + tx])\nend"
  },
  {
    "language": "Ruby",
    "code": "require 'matrix'\n\nloop do\n    n = gets.to_i\n    break if n == 0\n    s, t, b = gets.chomp.split.map{|c| c.ord - ?A.ord}\n\n    d = [2, 1, 2,\n         1, 0, 1,\n         2, 1, 2]\n    d[b-3] += 1 if b > 2\n    d[b-1] += 1 if b % 3 > 0\n    d[b+1] += 1 if b % 3 < 2\n    d[b+3] += 1 if b < 6\n\n    m = Matrix.build(9, 9) do |i, j|\n        if j == i\n            d[i] / 4.0\n        elsif j == b\n            0\n        elsif [1, 3].include?((i - j).abs)\n            0.25\n        else\n            0\n        end\n    end\n\n    p (m ** n)[s, t]\nend"
  },
  {
    "language": "Ruby",
    "code": "while gets\n\tn = $_.to_i\n\tbreak if n == 0\n\ts, t, b = gets.split\n\trm = { \"A\"=>[\"B\",\"D\"],      \"B\"=>[\"A\",\"C\",\"E\"],      \"C\"=>[\"B\",\"F\"],\n           \"D\"=>[\"A\",\"E\",\"G\"],  \"E\"=>[\"D\",\"B\",\"F\",\"H\"],  \"F\"=>[\"E\",\"C\",\"I\"],\n           \"G\"=>[\"H\",\"D\"],      \"H\"=>[\"E\",\"G\",\"I\"],      \"I\"=>[\"F\",\"H\"]}                 \n  \trm.each_key{|k|\n        rm[k].select!{|item| item != b}\n  \t}\n  \tprob = [Hash.new(0.0), Hash.new(0.0)]\n  \tprob[0][s] = 1.0\n  \ti = 0\n  \tn.times do \n  \t\trm.each{|k,v|\n  \t\t\tprob[1-i][k] = ((4.0 - v.size)/4) * prob[i][k]\n  \t\t\tv.each{|r|\n  \t\t\t\tprob[1-i][k] += prob[i][r] / 4\n  \t\t\t}\n  \t\t}\n  \t\ti = 1-i\n  \tend\n\tp prob[i][t]\nend "
  },
  {
    "language": "Ruby",
    "code": "require 'matrix'\n\nloop do\n    n = gets.to_i\n    break if n == 0\n    s, t, b = gets.chomp.split.map{|c| c.ord - ?A.ord}\n\n    d = [2, 1, 2,\n         1, 0, 1,\n         2, 1, 2]\n    d[b-3] += 1 if b > 2\n    d[b-1] += 1 if b % 3 > 0\n    d[b+1] += 1 if b % 3 < 2\n    d[b+3] += 1 if b < 6\n\n    m = Matrix.build(9, 9) do |i, j|\n        if j == i\n            d[i] / 4.0\n        elsif j == b\n            0\n        elsif i / 3 == j / 3 && (i - j).abs == 1 \n            0.25\n        elsif i % 3 == j % 3 && (i - j).abs == 3 \n            0.25\n????????????else\n            0\n        end\n    end\n\n    p (m ** n)[s, t]\nend"
  },
  {
    "language": "Ruby",
    "code": "while (n = gets.chomp.to_i) != 0\n  s,t,b = gets.chomp.split\n\n  rooms = {\n    [0,0] => {name: \"A\", value: 0.0}, \n    [0,1] => {name: \"B\", value: 0.0}, \n    [0,2] => {name: \"C\", value: 0.0}, \n    [1,0] => {name: \"D\", value: 0.0}, \n    [1,1] => {name: \"E\", value: 0.0}, \n    [1,2] => {name: \"F\", value: 0.0}, \n    [2,0] => {name: \"G\", value: 0.0}, \n    [2,1] => {name: \"H\", value: 0.0}, \n    [2,2] => {name: \"I\", value: 0.0}\n  } \n\n  rooms.each_value{|room| room[:value] = 1 if room[:name] == s}\n  rooms.delete_if{|k, v| v[:name] == b}\n\n  n.times do |n|\n    tmp = {\n      [0,0] => 0.0, [0,1] => 0.0, [0,2] => 0.0,\n      [1,0] => 0.0, [1,1] => 0.0, [1,2] => 0.0,\n      [2,0] => 0.0, [2,1] => 0.0, [2,2] => 0.0\n    }\n    rooms.each do |k, v|\n      if v[:value] != 0.0\n        row = k[0]\n        column = k[1]\n        p = v[:value] / 4.0\n        #up\n        if rooms.has_key?([row-1, column])\n          rooms[k][:value] -= p\n          tmp[[row-1, column]] += p\n        end\n        #down\n        if rooms.has_key?([row+1, column])\n          rooms[k][:value] -= p\n          tmp[[row+1, column]] += p\n        end\n        #left\n        if rooms.has_key?([row, column-1])\n          rooms[k][:value] -= p\n          tmp[[row, column-1]] += p\n        end\n        #right\n        if rooms.has_key?([row, column+1])\n          rooms[k][:value] -= p\n          tmp[[row, column+1]] += p\n        end\n      end\n    end\n    rooms.each_key do |k|\n      rooms[k][:value] = tmp[k]\n    end\n  end\n  rooms.each_value do |v|\n    puts v[:value] if v[:name] == t\n  end\nend"
  },
  {
    "language": "Ruby",
    "code": "require 'matrix'\n\nloop do\n    n = gets.to_i\n    break if n == 0\n    s, t, b = gets.chomp.split.map{|c| c.ord - ?A.ord}\n\n    d = [2, 1, 2,\n         1, 0, 1,\n         2, 1, 2]\n    d[b-3] += 1 if b > 2\n    d[b-1] += 1 if b % 3 > 0\n    d[b+1] += 1 if b % 3 < 2\n    d[b+3] += 1 if b < 6\n\n    m = Matrix.build(9, 9) do |i, j|\n        if j == i\n            d[i] / 4.0\n        elsif j == b\n            0\n        elsif i / 3 == j / 3 && (i - j).abs == 1 \n            0.25\n        elsif i % 3 == j % 3 && (i - j).abs == 3 \n            0.25\n????????????else\n            0\n        end\n    end\n\n    p (m ** n)[s, t]\nend"
  },
  {
    "language": "Ruby",
    "code": "loop{\n\tn = gets.to_i()\n\tif n == 0 then\n\t\tbreak\n\tend\n\t\n\ts,t,b = gets.split\n\troom_path = {\t\"A\"=>[\"B\",\"D\"],\t\t\"B\"=>[\"A\",\"C\",\"E\"],\t\t\"C\"=>[\"B\",\"F\"],\n\t\t\t\t\t\"D\"=>[\"A\",\"E\",\"G\"],\t\"E\"=>[\"D\",\"B\",\"F\",\"H\"],\t\"F\"=>[\"E\",\"C\",\"I\"],\n\t\t\t\t\t\"G\"=>[\"H\",\"D\"],\t\t\"H\"=>[\"E\",\"G\",\"I\"],\t\t\"I\"=>[\"F\",\"H\"]}\n\t\t\t\t\t\n\troom_path[b].each{|r|\n\t\troom_path[r].select!{|item| item != b}\n\t}\n\t\n\troom = Hash.new(0.0)\n\troom[s] = 1.0\n\t\n\t\n\tn.times do\n\t\ttroom = Hash.new(0.0)\n\t\troom_path.each_key{|key|\n\t\t\ttroom[key] = room[key]\n\t\t}\n\t\t\n\t\troom_path.each{|key,path|\n\t\t\troom[key] = ((4.-path.size())/4) * troom[key]\n\t\t\tpath.each{|r|\n\t\t\t\troom[key] += troom[r]/4\n\t\t\t}\n\t\t}\n\tend\n\tp room[t]\n\t\n}"
  },
  {
    "language": "Ruby",
    "code": "while (n = gets.chomp.to_i) != 0\n  s,t,b = gets.chomp.split\n\n  rooms = {\n    [0,0] => {name: \"A\", value: 0.0}, \n    [0,1] => {name: \"B\", value: 0.0}, \n    [0,2] => {name: \"C\", value: 0.0}, \n    [1,0] => {name: \"D\", value: 0.0}, \n    [1,1] => {name: \"E\", value: 0.0}, \n    [1,2] => {name: \"F\", value: 0.0}, \n    [2,0] => {name: \"G\", value: 0.0}, \n    [2,1] => {name: \"H\", value: 0.0}, \n    [2,2] => {name: \"I\", value: 0.0}\n  } \n\n  rooms.each_value{|room| room[:value] = 1 if room[:name] == s}\n  rooms.delete_if{|k, v| v[:name] == b}\n\n  n.times do |n|\n    tmp = {\n      [0,0] => 0.0, [0,1] => 0.0, [0,2] => 0.0,\n      [1,0] => 0.0, [1,1] => 0.0, [1,2] => 0.0,\n      [2,0] => 0.0, [2,1] => 0.0, [2,2] => 0.0\n    }\n    rooms.each do |k, v|\n      if v[:value] != 0.0\n        row = k[0]\n        column = k[1]\n        p = v[:value] / 4.0\n        #up\n        if rooms.has_key?([row-1, column])\n          rooms[k][:value] -= p\n          tmp[[row-1, column]] += p\n        else\n          tmp[[row, column]] += p\n        end\n        #down\n        if rooms.has_key?([row+1, column])\n          rooms[k][:value] -= p\n          tmp[[row+1, column]] += p\n        else\n          tmp[[row, column]] += p\n        end\n        #left\n        if rooms.has_key?([row, column-1])\n          rooms[k][:value] -= p\n          tmp[[row, column-1]] += p\n        else\n          tmp[[row, column]] += p\n        end\n        #right\n        if rooms.has_key?([row, column+1])\n          rooms[k][:value] -= p\n          tmp[[row, column+1]] += p\n        else\n          tmp[[row, column]] += p\n        end\n      end\n    end\n    rooms.each_key do |k|\n      rooms[k][:value] = tmp[k]\n    end\n  end\n  rooms.each_value do |v|\n    puts v[:value] if v[:name] == t\n  end\nend"
  },
  {
    "language": "Ruby",
    "code": "while (n = gets.chomp.to_i) != 0\n  s,t,b = gets.chomp.split\n\n  rooms = {\n    [0,0] => {name: \"A\", value: 0}, \n    [0,1] => {name: \"B\", value: 0}, \n    [0,2] => {name: \"C\", value: 0}, \n    [1,0] => {name: \"D\", value: 0}, \n    [1,1] => {name: \"E\", value: 0}, \n    [1,2] => {name: \"F\", value: 0}, \n    [2,0] => {name: \"G\", value: 0}, \n    [2,1] => {name: \"H\", value: 0}, \n    [2,2] => {name: \"I\", value: 0}\n  } \n\n  rooms.each_value{|room| room[:value] = 1 if room[:name] == s}\n  rooms.delete_if{|k, v| v[:name] == b}\n\n  n.times do |n|\n    tmp = {\n      [0,0] => 0, [0,1] => 0, [0,2] => 0,\n      [1,0] => 0, [1,1] => 0, [1,2] => 0,\n      [2,0] => 0, [2,1] => 0, [2,2] => 0\n    }\n    rooms.each do |k, v|\n      if v[:value] != 0\n        row = k[0]\n        column = k[1]\n        p = v[:value] / 4.0\n        #up\n        if rooms.has_key?([row-1, column])\n          rooms[k][:value] -= p\n          tmp[[row-1, column]] += p\n        end\n        #down\n        if rooms.has_key?([row+1, column])\n          rooms[k][:value] -= p\n          tmp[[row+1, column]] += p\n        end\n        #left\n        if rooms.has_key?([row, column-1])\n          rooms[k][:value] -= p\n          tmp[[row, column-1]] += p\n        end\n        #right\n        if rooms.has_key?([row, column+1])\n          rooms[k][:value] -= p\n          tmp[[row, column+1]] += p\n        end\n      end\n    end\n    rooms.each_key do |k|\n      rooms[k][:value] = tmp[k]\n    end\n  end\n  rooms.each_value do |v|\n    puts v[:value] if v[:name] == t\n  end\nend"
  },
  {
    "language": "PHP",
    "code": "<?php\ndefine('DEBUG', 0);\n$dx = [0, 1, 0, -1];\n$dy = [1, 0, -1, 0];\n$cells = array(\n  'A'=>[0,0],\n  'B'=>[1,0],\n  'C'=>[2,0],\n  'D'=>[0,1],\n  'E'=>[1,1],\n  'F'=>[2,1],\n  'G'=>[0,2],\n  'H'=>[1,2],\n  'I'=>[2,2]);\n\n$memo = array();\n\nfunction f($cx, $cy, $n, $t, $b) { // $cx,$cy:セル座標、$n:残りバッテリ\nif (DEBUG) echo \"$cx, $cy, $n, $t, $b:\";\n  global $cells, $dx, $dy, $memo;\n  // メモチェック\n  if (array_key_exists(\"$cx:$cy:$n\", $memo)) {\nif (DEBUG) echo $memo[\"$cx:$cy:$n\"].\"\\n\";\n    return $memo[\"$cx:$cy:$n\"];\n  }\n  if ($n == 0) {\n    // バッテリがなくなった\n    if ($cx == $cells[$t][0] && $cy == $cells[$t][1]) {\n      // 充電器で終了\nif (DEBUG) echo \"1\\n\";\n      return 1;\n    } else {\nif (DEBUG) echo \"0_1\\n\";\n      return 0;\n    }\n  }\n\n  // 4方向に移動する\n  $ret = 0;\n  for($i=0; $i<4; ++$i) {\n    $x = $cx + $dx[$i];\n    $y = $cy + $dy[$i];\n    if ($x < 0 || 2 < $x || $y < 0 || 2 < $y\n       || ($x == $cells[$b][0] && $y == $cells[$b][1])) {\n      // 壁にあたった、又は、倉庫にぶつかったので座標を元に戻す\n      $x = $cx;\n      $y = $cy;\n    }\nif (DEBUG) echo \"f\\n\";\n    $ret += f($x, $y, $n-1, $t, $b);\n  }\n// error_log(\"ret:$ret\");\n  // メモ化\n  $memo[\"$cx:$cy:$n\"] = $ret;\nif (DEBUG) echo \"$ret\\n\";\n  return $ret;\n}\n\nwhile ($n = chop(fgets(STDIN))) {\n  list($s, $t, $b) = explode(' ', chop(fgets(STDIN)));\n  $memo = array();\n  $num = f($cells[$s][0], $cells[$s][1], $n, $t, $b);\n  echo sprintf('%.8f', $num / pow(4, $n)) . \"\\n\";\n  unset($memo);\n}\n\n"
  },
  {
    "language": "Python",
    "code": "#!/usr/bin/env python\n\nfrom collections import deque\nimport itertools as it\nimport sys\nimport math\n\nsys.setrecursionlimit(10000000)\n\nwhile True:\n    n = input()\n    if n == 0:\n        break\n    s, t, b = raw_input().split()\n    s = ord(s) - ord('A')\n    t = ord(t) - ord('A')\n    b = ord(b) - ord('A')\n    lst = [0.0 for i in range(9)]\n    lst[s] = 1.0\n    for loop in range(n):\n        lst2 = [0.0 for i in range(9)]\n        for i in range(9):\n            x = i % 3\n            y = i / 3\n            if y > 0 and (y - 1) * 3 + x != b:\n                lst2[(y - 1) * 3 + x] += lst[y * 3 + x] / 4\n            else:\n                lst2[y * 3 + x] += lst[y * 3 + x] / 4\n            if y < 2 and (y + 1) * 3 + x != b:\n                lst2[(y + 1) * 3 + x] += lst[y * 3 + x] / 4\n            else:\n                lst2[y * 3 + x] += lst[y * 3 + x] / 4\n            if x > 0 and y * 3 + x - 1 != b:\n                lst2[y * 3 + x - 1] += lst[y * 3 + x] / 4\n            else:\n                lst2[y * 3 + x] += lst[y * 3 + x] / 4\n            if x < 2 and y * 3 + x + 1 != b:\n                lst2[y * 3 + x + 1] += lst[y * 3 + x] / 4\n            else:\n                lst2[y * 3 + x] += lst[y * 3 + x] / 4\n        lst = lst2\n    print \"%.10f\" % lst[t]\n"
  },
  {
    "language": "Python",
    "code": "time = -1\nplace = [\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\"]\nempty_count={}\nfor i in place:\n\tempty_count[i] = 0\ncount_d = empty_count.copy()\t\n\ndef reset():\n\tglobal d\n\tglobal count_d\n\td={\"a\":[\"a\",\"a\",\"b\",\"d\"],\"b\":[\"a\",\"e\",\"c\",\"b\"],\"c\":[\"b\",\"f\",\"c\",\"c\"],\"d\":[\"a\",\"e\",\"g\",\"d\"],\"e\":[\"b\",\"d\",\"f\",\"h\"],\"f\":[\"c\",\"e\",\"i\",\"f\"],\"g\":[\"d\",\"h\",\"g\",\"g\"],\"h\":[\"g\",\"e\",\"i\",\"h\"],\"i\":[\"f\",\"h\",\"i\",\"i\"]}\n\tcount_d = empty_count.copy()\n\tprint count_d,\"reset\"\n\t\ndef pre_set(start_place,fix_place):\n\tglobal d\n\tglobal count_d\n\tfor i in place:\n\t\td[i] = list((\"\").join(d[i]).replace(fix_place,i))\n\tcount_d[start_place] = 1\n\tprint count_d,\"preset\"\ndef repeat(time):\n\tglobal count_d\n\tfor i in range (time):\n\t\tnew_count_d = empty_count.copy()\n\t\told_count_d = count_d.copy()\n\t\tfor j in place:\n\t\t\tfor k in d[j]:\n\t\t\t\tnew_count_d[k] += old_count_d[j]\n\t\tprint count_d,\"repeat\",i\n\t\tcount_d = new_count_d.copy() \n\nwhile time != 0:\n\ttime = int(raw_input())\n\tif time == 0:\n\t\tbreak\n\telse:\n\t\tinfo_pre = raw_input().split()\n\t\tinfo = []\n\t\tfor i in info_pre:\n\t\t\tinfo.append(i.lower())\n\t\t\n\treset()\n\tpre_set(info[0],info[2])\n\trepeat(time)\n\tprint (count_d[info[1]])/float((4**time)),count_d[info[1]],float((4**time))"
  },
  {
    "language": "Python",
    "code": "x = []\nfor y in range(9):\n        x += [[chr(65+y),y]]\nRoom = dict(x)\n\nBy = [[0,0,1,3],[0,1,2,4],[1,2,2,5],[0,3,4,6],[1,3,5,7]]\nBy += [[2,4,5,8],[3,6,6,7],[4,6,7,8],[5,7,8,8]]\n\nwhile 1:\n        BatP = input()\n        if BatP == 0:\n                break\n        Info = raw_input().split()\n        Prob = [0 for x in range(9)]\n        Prob[Room[Info[0]]] = 1\n\n        while 0 < BatP:\n                BatP -= 1\n                AftI = Prob[:]\n                for x in range(9):\n                        Prob[x] = 0\n                        if x == Room[Info[2]]:\n                                for y in range(4):\n                                        Prob[By[x][y]] += AftI[By[x][y]] *0.25\n                        else:\n                                for y in range(4):\n                                        Prob[x] += AftI[By[x][y]] * 0.25\n\n        print(Prob[Room[Info[1]]])"
  },
  {
    "language": "Python",
    "code": "dic = {\"A\":(0,0), \"B\":(0,1), \"C\":(0,2),\n       \"D\":(1,1), \"E\":(1,1), \"F\":(1,2),\n       \"G\":(2,1), \"H\":(2,1), \"I\":(2,2)}\nwhile True:\n    n = input()\n    if n == 0:\n        break\n    dp = [[[0] * 3 for _ in xrange(3)] for _ in xrange(n + 1)]\n    s, t, b = raw_input().split()\n    dp[0][dic[s][0]][dic[s][1]] = 1\n    for i in xrange(n):\n        for y in xrange(3):\n            for x in xrange(3):\n                for dx, dy in ((0, 1), (-1, 0), (0, -1), (1, 0)):\n                    if not(0 <= x + dx < 3 and 0 <= y + dy < 3) or dic[b] == (y + dy, x + dx):\n                        dp[i + 1][y][x] += dp[i][y][x]                       \n                    else:\n                        dp[i + 1][y + dy][x + dx] += dp[i][y][x]\n    print \"{:.8f}\".format(dp[n][dic[t][0]][dic[t][1]] / float(sum(reduce(lambda a, b: a + b, dp[n]))))        "
  },
  {
    "language": "Python",
    "code": "# AOJ 1020: Cleaning Robot\n# Python3 2018.7.5 bal4u\n\nmv = ((-1,0),(0,1),(1,0),(0,-1))\nwhile True:\n\tn = int(input())\n\tif n == 0: break\n\tt1, t2, t3 = input().split()\n\ts, t, b = ord(t1)-ord('A'), ord(t2)-ord('A'), ord(t3)-ord('A')\n\tf = [[[0.0 for a in range(3)] for c in range(3)] for r in range(17)]\n\tf[0][s//3][s%3] = 1\n\tfor j in range(1, n+1):\n\t\tfor r in range(3):\n\t\t\tfor c in range(3):\n\t\t\t\tfor i in range(4):\n\t\t\t\t\tr2, c2 = r + mv[i][0], c + mv[i][1]\n\t\t\t\t\tif r2 < 0 or r2 >= 3 or c2 < 0 or c2 >= 3 or 3*r2+c2 == b:\n\t\t\t\t\t\tr2, c2 = r, c\n\t\t\t\t\tf[j][r2][c2] += f[j-1][r][c]/4\n\tprint(f[n][t//3][t%3])\n"
  },
  {
    "language": "Python",
    "code": "#!/usr/bin/python\n\nimport os\nimport sys\nimport itertools\n\nf = sys.stdin\nd = {'A': (0,0), 'B': (0,1), 'C': (0,2),\n     'D': (1,0), 'E': (1,1), 'F': (1,2),\n     'G': (2,0), 'H': (2,1), 'I': (2,2)}\n\nwhile True:\n    n = int(f.readline().strip())\n    if n==0: sys.exit()\n\n    s,t,b = f.readline().split()\n\n    dp = [dict([((j,k),0) for k in xrange(3) for j in xrange(3)]) for i in xrange(n+1)]\n    dp[0][d[t]] = 1\n\n    for i in xrange(1,n+1):\n        for j in xrange(3):\n            for k in xrange(3):\n                # up\n                x,y = max(0,j-1), k\n                if d[b]==(x,y):\n                    dp[i][(j,k)] += dp[i-1][(j,k)]\n                else:\n                    dp[i][(x,y)] += dp[i-1][(j,k)]\n\n                # down\n                x,y = min(j+1,2), k\n                if d[b]==(x,y):\n                    dp[i][(j,k)] += dp[i-1][(j,k)]\n                else:\n                    dp[i][(x,y)] += dp[i-1][(j,k)]\n\n                # left\n                x,y = j, max(0,k-1)\n                if d[b]==(x,y):\n                    dp[i][(j,k)] += dp[i-1][(j,k)]\n                else:\n                    dp[i][(x,y)] += dp[i-1][(j,k)]\n\n                # right\n                x,y = j, min(2, k+1)\n                if d[b]==(x,y):\n                    dp[i][(j,k)] += dp[i-1][(j,k)]\n                else:\n                    dp[i][(x,y)] += dp[i-1][(j,k)]\n\n    print dp[n][d[s]]/4.**n"
  },
  {
    "language": "Python",
    "code": "dic = {\"A\":(0,0), \"B\":(0,1), \"C\":(0,2),\n       \"D\":(1,0), \"E\":(1,1), \"F\":(1,2),\n       \"G\":(2,0), \"H\":(2,1), \"I\":(2,2)}\nwhile True:\n    n = input()\n    if n == 0:\n        break\n    dp = [[[0] * 3 for _ in xrange(3)] for _ in xrange(n + 1)]\n    s, t, b = raw_input().split()\n    dp[0][dic[s][0]][dic[s][1]] = 1\n    for i in xrange(n):\n        for y in xrange(3):\n            for x in xrange(3):\n                for dx, dy in ((0, 1), (-1, 0), (0, -1), (1, 0)):\n                    if not(0 <= x + dx < 3 and 0 <= y + dy < 3) or dic[b] == (y + dy, x + dx):\n                        dp[i + 1][y][x] += dp[i][y][x]\n                    else:\n                        dp[i + 1][y + dy][x + dx] += dp[i][y][x]\n    print \"{:.8f}\".format(float(dp[n][dic[t][0]][dic[t][1]]) / 4.**n)"
  },
  {
    "language": "Python",
    "code": "x = []\nfor y in range(9):\n        x += [[chr(65+y),y]]\nRoom = dict(x)\n\nBy = [[0,0,1,3],[0,1,2,4],[1,2,2,5],[0,3,4,6],[1,3,5,7]]\nBy += [[2,4,5,8],[3,6,6,7],[4,6,7,8],[5,7,8,8]]\n\nwhile 1:\n        BatP = input()\n        if BatP == 0:\n                break\n        Info = raw_input().split()\n        Prob = [0 for x in range(9)]\n        Prob[Room[Info[0]]] = 1\n\n        while 0 < BatP:\n                BatP -= 1\n                AftI = Prob[:]\n                for x in range(9):\n                        Prob[x] = 0\n                        if x == Room[Info[2]]:\n                                for y in range(4):\n                                        Prob[By[x][y]] += AftI[By[x][y]] *0.25\n                        else:\n                                for y in range(4):\n                                        Prob[x] += AftI[By[x][y]] * 0.25\n\n        print('{:.8f}'.format(Prob[Room[Info[1]]]))"
  },
  {
    "language": "Python",
    "code": "pos={\"A\":(0,0),\"B\":(1,0),\"C\":(2,0),\"D\":(0,1),\"E\":(1,1),\"F\":(2,1),\n     \"G\":(0,2),\"H\":(1,2),\"I\":(2,2)}\nmv=((0,1),(0,-1),(1,0),(-1,0))\n\ndef dfs(x,y,n):\n    global prob\n    if n==0:\n        return 1.0 if (x,y)==t else 0.0\n    if (x,y,n) in dp:\n        return dp[(x,y,n)]\n    for dx,dy in mv:\n        mx=x+dx\n        my=y+dy\n        if mx<0 or mx>2 or my<0 or my>2 or (mx,my)==b:\n            prob+=0.25*dfs(x,y,n-1)\n        else:\n            prob+=0.25*dfs(mx,my,n-1)\n        dp[(x,y,n)]=prob\n    return prob\n\nwhile True:\n    n=input()\n    if n==0:break\n    s,t,b=raw_input().split()\n    s,t,b=pos[s],pos[t],pos[b]\n    dp={}\n    prob=0.0\n    print \"%.8f\"%dfs(s[0],s[1],n)"
  },
  {
    "language": "Python",
    "code": "pos={\"A\":(0,0),\"B\":(1,0),\"C\":(2,0),\"D\":(0,1),\"E\":(1,1),\"F\":(2,1),\n     \"G\":(0,2),\"H\":(1,2),\"I\":(2,2)}\nmv=((0,1),(0,-1),(1,0),(-1,0))\n\ndef dfs(x,y,n):\n    global prob\n    if n==0:\n        return 1.0 if (x,y)==t else 0.0\n    for dx,dy in mv:\n        mx=x+dx\n        my=y+dy\n        if mx<0 or mx>2 or my<0 or my>2 or (mx,my)==b:\n            prob+=0.25*dfs(x,y,n-1)\n        else:\n            prob+=0.25*dfs(mx,my,n-1)\n    return prob\n\nwhile True:\n    n=input()\n    if n==0:break\n    s,t,b=raw_input().split()\n    s,t,b=pos[s],pos[t],pos[b]\n    prob=0.0\n    prob=dfs(s[0],s[1],n)\n    print prob"
  },
  {
    "language": "Python",
    "code": "def cnv(c):\n    rm='ABCDEFGHI'\n    id=[(1,1),(1,2),(1,3),(2,1),(2,2),(2,3),(3,1),(3,2),(3,3)]\n    return id[rm.index(c)]\n \nwhile(1):\n    n=int(raw_input())\n    if n==0:\n        break\n    else:\n        [s,t,b]=[cnv(c) for c in raw_input().split()]\n        A=[[0 for i in range(5)] for j in range(5)]\n        B=[[0 for i in range(5)] for j in range(5)]\n        A[s[0]][s[1]]=1\n        for i in range(n):\n            for j in range(1,4):\n                for k in range(1,4):\n                    B[j][k]=(A[j+1][k]+A[j-1][k]+A[j][k+1]+A[j][k-1])*0.25\n            B[b[0]][b[1]]=0 \n            for j in range(1,4):\n                A[j][1:4]=B[j][1:4]\n        print A[t[0]][t[1]]"
  },
  {
    "language": "Python",
    "code": "mv = ((0, 1), (1, 0), (0, -1), (-1, 0))\nconv = {'A': (0, 0),\n        'B': (0, 1),\n        'C': (0, 2),\n        'D': (1, 0),\n        'E': (1, 1),\n        'F': (1, 2),\n        'G': (2, 0),\n        'H': (2, 1),\n        'I': (2, 2)\n        }\n\n\ndef rec(x, y, energy, prob):\n    global ans\n    if energy == 0:\n        if (x, y) == conv[t]:\n            ans += prob\n        return\n\n    for dx, dy in mv:\n        mx = x + dx\n        my = y + dy\n        if mx < 0 or mx >= 3 or my < 0 or my >= 3 or (mx, my) == conv[b]:\n            rec(x, y, energy-1, prob*0.25)\n        else:\n            rec(mx, my, energy-1, prob*0.25)\n\n\nwhile True:\n    n = input()\n    if n == 0:\n        break\n    ans = 0\n    s, t, b = raw_input().split()\n    x, y = conv[s]\n    rec(x, y, n, 1.0)\n    print '%.8f' % ans"
  },
  {
    "language": "Python",
    "code": "while True:\n  n = int(input())\n  if n == 0:\n    break\n\n  s, t, b = input().split()\n  base = ord(\"A\")\n  blank = ord(b) - base\n\n  dp = [[0] * 9 for _ in range(n + 1)]\n  dp[0][ord(s) - base] = 1\n\n  to = {0:(0, 0, 1, 3), 1:(0, 1, 2, 4), 2:(1, 2, 2, 5), 3:(0, 3, 4, 6), \n        4:(1, 3, 5, 7), 5:(2, 4, 5, 8), 6:(3, 6, 6, 7), 7:(4, 6, 7, 8), 8:(5, 7, 8, 8)}\n  \n  def update(x, i):\n    for nex in to[x]:\n      if nex == blank:\n        dp[i][x] += dp[i - 1][x] / 4\n      else:\n        dp[i][nex] += dp[i - 1][x] / 4\n\n  for i in range(1, n + 1):\n    for x in range(9):\n      update(x, i)\n  print(dp[n][ord(t) - base])\n"
  },
  {
    "language": "Python",
    "code": "x = []\nfor y in range(9):\n        x += [[chr(65+y),y]]\nRoom = dict(x)\n\nBy = [[0,0,1,3],[0,1,2,4],[1,2,2,5],[0,3,4,6],[1,3,5,7]]\nBy += [[2,4,5,8],[3,6,6,7],[4,6,7,8],[5,7,8,8]]\n\nwhile 1:\n        BatP = input()\n        if BatP == 0:\n                break\n        Info = raw_input().split()\n        Prob = [0 for x in range(9)]\n        Prob[Room[Info[0]]] = 1\n\n        while 0 < BatP:\n                BatP -= 1\n                AftI = Prob[:]\n                Prob = [0 for x in range(9)]\n\n                for x in range(9):\n                        if x == Room[Info[2]]:\n                                for y in range(4):\n                                        Prob[By[x][y]] += AftI[By[x][y]] *0.25\n                        else:\n                                for y in range(4):\n                                        Prob[x] += AftI[By[x][y]] * 0.25\n\n        print('{:.8f}'.format(Prob[Room[Info[1]]]))"
  },
  {
    "language": "Python",
    "code": "x = []\nfor y in range(9):\n        x += [[chr(65+y),y]]\nRoom = dict(x)\n\nBy = [[0,0,1,3],[0,1,2,4],[1,2,2,5],[0,3,4,6],[1,3,5,7]]\nBy += [[2,4,5,8],[3,6,6,7],[4,6,7,8],[5,7,8,8]]\n\nwhile 1:\n        BatP = input()\n        if BatP == 0:\n                break\n        Info = raw_input().split()\n        Prob = [0 for x in range(9)]\n        Prob[Room[Info[0]]] = 1\n\n        for x in range(3):\n                print(Prob[x*3:x*3+3])\n        while 0 < BatP:\n                BatP -= 1\n                AftI = Prob[:]\n                Prob = [0 for x in range(9)]\n\n                for x in range(9):\n                        if x == Room[Info[2]]:\n                                for y in range(4):\n                                        Prob[By[x][y]] += AftI[By[x][y]] *0.25\n                        else:\n                                for y in range(4):\n                                        Prob[x] += AftI[By[x][y]] * 0.25\n                for x in range(3):\n                        print(Prob[x*3:x*3+3])\n\n        print(Prob[Room[Info[1]]])"
  },
  {
    "language": "Python",
    "code": "while(1):\n    n=int(raw_input())\n    if n==0:\n        break\n    else:\n        [s,t,b]=raw_input().split()\n        rm='ABCDEFGHI'\n        nxt={}\n        A={}\n        B={}\n        nxt[\"A\"]='AABD'\n        nxt[\"B\"]='ABEC'\n        nxt[\"C\"]='CCBF'\n        nxt[\"D\"]='ADEG'\n        nxt[\"E\"]='BDHF'\n        nxt[\"F\"]='CEFI'\n        nxt[\"G\"]='GGDH'\n        nxt[\"H\"]='GHEI'\n        nxt[\"I\"]='IIHF'\n        for r in rm:\n            A[r]=0\n            B[r]=0\n        A[s]=1\n        for i in range(n):\n            for r in rm:\n                B[r]=0\n            for r in rm:\n                for c in nxt[r]:\n                    if c==b:\n                        B[r]+= A[r]*0.25\n                    else:\n                        B[c]+= A[r]*0.25\n            A=B.copy()\n        print A[t]"
  },
  {
    "language": "Python",
    "code": "time = -1\nplace = [\"a\",\"b\",\"c\",\"d\",\"e\",\"f\",\"g\",\"h\",\"i\"]\nempty_count={}\nfor i in place:\n\tempty_count[i] = 0\ncount_d = empty_count.copy()\t\n\ndef reset():\n\tglobal d\n\tglobal count_d\n\td={\"a\":[\"a\",\"a\",\"b\",\"d\"],\"b\":[\"a\",\"e\",\"c\",\"b\"],\"c\":[\"b\",\"f\",\"c\",\"c\"],\"d\":[\"a\",\"e\",\"g\",\"d\"],\"e\":[\"b\",\"d\",\"f\",\"h\"],\"f\":[\"c\",\"e\",\"i\",\"f\"],\"g\":[\"d\",\"h\",\"g\",\"g\"],\"h\":[\"g\",\"e\",\"i\",\"h\"],\"i\":[\"f\",\"h\",\"i\",\"i\"]}\n\tcount_d = empty_count.copy()\n\t\n\t\ndef pre_set(start_place,fix_place):\n\tglobal d\n\tglobal count_d\n\tfor i in place:\n\t\td[i] = list((\"\").join(d[i]).replace(fix_place,i))\n\tcount_d[start_place] = 1\n\t\ndef repeat(time):\n\tglobal count_d\n\tfor i in range (time):\n\t\tnew_count_d = empty_count.copy()\n\t\told_count_d = count_d.copy()\n\t\tfor j in place:\n\t\t\tfor k in d[j]:\n\t\t\t\tnew_count_d[k] += old_count_d[j]\n\t\tcount_d = new_count_d.copy() \n\nwhile time != 0:\n\ttime = int(raw_input())\n\tif time == 0:\n\t\tbreak\n\telse:\n\t\tinfo_pre = raw_input().split()\n\t\tinfo = []\n\t\tfor i in info_pre:\n\t\t\tinfo.append(i.lower())\n\t\t\n\treset()\n\tpre_set(info[0],info[2])\n\trepeat(time)\n\tprint (count_d[info[1]])/float((4**time))\n\t\n\t\t\n\t"
  },
  {
    "language": "Python",
    "code": "pos={\"A\":(0,0),\"B\":(1,0),\"C\":(2,0),\"D\":(0,1),\"E\":(1,1),\"F\":(2,1),\n     \"G\":(0,2),\"H\":(1,2),\"I\":(2,2)}\nmv=((0,1),(0,-1),(1,0),(-1,0))\n\ndef dfs(x,y,n):\n    global prob\n    if n==0:\n        return 1.0 if (x,y)==t else 0.0\n    if (x,y,n) in dp:\n        return dp[(x,y,n)]\n    for dx,dy in mv:\n        mx=x+dx\n        my=y+dy\n        if mx<0 or mx>2 or my<0 or my>2 or (mx,my)==b:\n            prob+=0.25*dfs(x,y,n-1)\n        else:\n            prob+=0.25*dfs(mx,my,n-1)\n        dp[(x,y,n)]=prob\n    return prob\n\nwhile True:\n    n=input()\n    if n==0:break\n    s,t,b=raw_input().split()\n    s,t,b=pos[s],pos[t],pos[b]\n    dp={}\n    prob=0.0\n    print dfs(s[0],s[1],n)"
  },
  {
    "language": "Python",
    "code": "index = \"ABCDEFGHI\".index\ndd = ((-1, 0), (0, -1), (1, 0), (0, 1))\nwhile 1:\n    N = int(input())\n    if N == 0:\n        break\n    s, t, b = map(index, input().split())\n    S = [[0]*3 for i in range(3)]\n    sy, sx = divmod(s, 3)\n    ty, tx = divmod(t, 3)\n    by, bx = divmod(b, 3)\n    T = [[0]*3 for i in range(3)]\n    S[sy][sx] = 1\n    for i in range(N):\n        for y in range(3):\n            for x in range(3):\n                if x == bx and y == by:\n                    T[y][x] = 0\n                    continue\n                r = 0\n                for dx, dy in dd:\n                    nx = x + dx; ny = y + dy\n                    if not 0 <= nx < 3 or not 0 <= ny < 3 or (bx == nx and by == ny):\n                        nx = x; ny = y\n                    r += S[ny][nx]\n                T[y][x] = r\n        S, T = T, S\n    su = sum(sum(e) for e in S)\n    print(\"%.15f\" % (S[ty][tx] / su))\n\n"
  }
]