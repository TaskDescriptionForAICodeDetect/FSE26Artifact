Given an integer K and integers a_1, a_2, ..., a_K, determine whether a sequence P exists that satisfies certain conditions. If it does exist, find the lexicographically smallest such sequence. Every term in P must be an integer between 1 and K (inclusive). Each integer i must appear a_i times in P. Additionally, for each term in P, there must be a contiguous subsequence of length K that includes that term and is a permutation of 1, 2, ..., K.