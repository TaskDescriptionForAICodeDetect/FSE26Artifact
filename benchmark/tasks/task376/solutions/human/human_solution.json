[
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define N 41\nusing namespace std;\ntypedef long long ll;\nll n,m,a,b,p,q,d[N];\nvector<ll> v[2],x[2];\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll ans=m;\n  if(a==1&&b==1){\n    ll ti=min(n,m/(p+q));\n    ans=min(ans,min(m-ti*(p+q),abs(min(ti+1,n)*(p+q)-m)));\n  }\n  ll A=1,B=1;\n  for(int i=0;i<min((ll)N,n);i++){\n    d[i]=p*A+q*B;\n    if(i<min((ll)N,n)/2)v[0].push_back(d[i]);\n    else v[1].push_back(d[i]);\n    if(d[i]>m)break;\n    A*=a,B*=b;\n  }\n  for(int i=0;i<2;i++){\n    v[i].push_back(0);\n    for(int j=0;j<(1<<v[i].size());j++){\n      ll sum=0;\n      for(int k=0;k<v[i].size();k++){\n\tif(!(j&(1<<k)))continue;\n\tsum+=v[i][k];\n      }\n      x[i].push_back(sum);\n    }\n    sort(x[i].begin(),x[i].end());\n  }\n  for(int i=0;i<x[0].size();i++){\n    ll search=m-x[0][i];\n    vector<ll>::iterator r=lower_bound(x[1].begin(),x[1].end(),search);\n    if(r!=x[1].end())ans=min(ans,(*r)-search);\n    if(r!=x[1].begin())ans=min(ans,search-(*(r-1)));\n  }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (int)(k); i < (int)(n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\n\nll pow(ll x, ll n)\n{\n\tll res = 1;\n\twhile (n > 0)\n\t{\n\t\tif (n & 1) res = res * x;\n\t\tx = x*x;\n\t\tn >>= 1;\n\t}\n\treturn res;\n}\n\nll n, m, a, b, p, q;\n\nll calc(ll k)\n{\n\treturn p * pow(a, k) + q * pow(b, k);\n}\n\nbool check(ld k)\n{\n\treturn p * pow(a, k) + q * pow(b, k) <= pow(10, 12);\n}\n\nll use(ll d)\n{\n\tll loop = min(n + 1, 42ll);\n\tll res;\n\tREP(i, loop)\n\t{\n\t\tif (!check(i) || calc(i) > d)\n\t\t{\n\t\t\tres = i - 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\nint main()\n{\n\tcin.sync_with_stdio(false); cout << fixed << setprecision(10);\n\tcin >> n >> m >> a >> b >> p >> q;\n\tll ans = LLONG_MAX;\n\tif (a == 1 && b == 1)\n\t{\n\t\tif (((ld)p + q) * n < (ld)m) ans = m - (p + q) * n;\n\t\telse\n\t\t{\n\t\t\tll t = m / (p + q);\n\t\t\tans = min(m - (p + q) * t, (p + q)*(t + 1) - m);\n\t\t}\n\t}\n\telse if (a > 1 && b > 1)\n\t{\n\t\tset<int> st;\n\t\tll d = m;\n\t\tint cnt = 0, mx = n;\n\t\tint loop = min(n + 1, 41ll);\n\t\twhile (st.size() < loop)\n\t\t{\n\t\t\tll t = use(d);\n\t\t\tif (t + 1 < n && !st.count(t + 1) && d < calc(t + 1))\n\t\t\t{\n\t\t\t\tchmin(ans, calc(t + 1) - d);\n\t\t\t}\n\t\t\tif (t < 0) break;\n\t\t\tll tmp = min(n, t);\n\t\t\twhile (st.count(tmp) && tmp > 0) tmp--;\n\t\t\tif (tmp == 0 && st.count(0)) break;\n\t\t\td -= calc(tmp);\n\t\t\tst.insert(tmp);\n\t\t\tchmin(ans, d);\n\t\t}\n\t\tchmin(ans, d);\n\t}\n\telse\n\t{\n\t\tif (a > b) swap(a, b);\n\t\tint loop = min(n + 1, 41ll);\n\t\tREP(i, loop)\n\t\t{\n\t\t\tset<int> st;\n\t\t\tll d = m;\n\t\t\tint cnt = 0, mx = n;\n\t\t\twhile (st.size() < i)\n\t\t\t{\n\t\t\t\tll t = use(d);\n\t\t\t\tif (t < 0) break;\n\t\t\t\tll tmp = min(n - 1, t);\n\t\t\t\twhile (st.count(tmp) && tmp > 0) tmp--;\n\t\t\t\tif (tmp == 0 && st.count(0)) break;\n\t\t\t\td -= calc(tmp);\n\t\t\t\tst.insert(tmp);\n\t\t\t}\n\t\t\tif (st.size() == i - 1)\n\t\t\t{\n\t\t\t\tif (!st.count(0))\n\t\t\t\t{\n\t\t\t\t\tchmin(ans, calc(0) - d);\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse if (st.size() != i) continue;\n\t\t\tchmin(ans, d);\n\t\t\tif (st.size() > 0)\n\t\t\t{\n\t\t\t\tint last = *st.begin();\n\t\t\t\tif (last + 1 < n && !st.count(last + 1))\n\t\t\t\t{\n\t\t\t\t\td = d + calc(last) - calc(last + 1);\n\t\t\t\t\tchmin(ans, -d);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    assert(p>=1 && q>=1);\n    \n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return min( m%d , m-(m%d) );\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        res=min( res, abs( m- ( T[i]+U[j] )) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define N 41\nusing namespace std;\ntypedef long long ll;\nll n,m,a,b,p,q,d[N];\nvector<ll> v[2],x[2];\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll ans=m;\n  if(a==1&&b==1){\n    ll ti=min(n,m/(p+q));\n    ans=min(ans,min(m-ti*(p+q),min(ti+1,n)*(p+q)-m));\n  }\n  ll A=1,B=1;\n  for(int i=0;i<min((ll)N,n);i++){\n    d[i]=p*A+q*B;\n    if(i<min((ll)N,n)/2)v[0].push_back(d[i]);\n    else v[1].push_back(d[i]);\n    if(d[i]>m)break;\n    A*=a,B*=b;\n  }\n  for(int i=0;i<2;i++){\n    v[i].push_back(0);\n    for(int j=0;j<(1<<v[i].size());j++){\n      ll sum=0;\n      for(int k=0;k<v[i].size();k++){\n\tif(!(j&(1<<k)))continue;\n\tsum+=v[i][k];\n      }\n      x[i].push_back(sum);\n    }\n    sort(x[i].begin(),x[i].end());\n  }\n  for(int i=0;i<x[0].size();i++){\n    ll search=m-x[0][i];\n    vector<ll>::iterator r=lower_bound(x[1].begin(),x[1].end(),search);\n    if(r!=x[1].end())ans=min(ans,(*r)-search);\n    if(r!=x[1].begin())ans=min(ans,search-(*(r-1)));\n  }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dist[40];\nint main(){\n\tlong long a,b,c,d,e,f;\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&a,&b,&c,&d,&e,&f);\n\tif(c==1&&d==1){\n\t\tlong long v=b%(e+f);\n\t\tlong long g=b/(e+f);\n\t\tlong long ret=v+max(0LL,g-a)*(e+f);\n\t\tg++;\n\t\tv=e+f-v;\n\t\tret=min(ret,v+max(0LL,g-a)*(e+f));\n\t\tprintf(\"%lld\\n\",ret);\n\t\t\n\t\treturn 0;\n\t}\n\tint sz=0;\n\tfor(int i=0;i<a;i++){\n\t\tlong long L=e;\n\t\tlong long R=f;\n\t\tlong long Q=b;\n\t\tfor(int j=0;j<i;j++)Q/=max(c,d);\n\t\tif(Q==0)break;\n\t\tfor(int j=0;j<i;j++)L*=c;\n\t\tfor(int j=0;j<i;j++)R*=d;\n\t\tlong long t=L+R;\n\t\tif(t>b*2)break;\n\t\tdist[sz++]=t;\n\t//\tprintf(\"%lld \",dist[sz-1]);\n\t}\n\tif(d==1){\n\t\tswap(c,d);\n\t\tswap(e,f);\n\t}\n\tif(c==1){\n\t\tlong long ret=b;\n\t\tfor(int i=0;i<sz;i++)dist[i]-=e;\n\t\tfor(int i=1;i<=sz;i++){\n\t\t\tlong long tmp=b-(long long)i*e;\n\t\t\tif(tmp<0)break;\n\t\t\tint rem=i;\n\t\t\tfor(int j=sz-1;j>=0;j--){\n\t\t\t\tif(tmp>=dist[j]){\n\t\t\t\t\trem--;\n\t\t\t\t\ttmp-=dist[j];\n\t\t\t\t}else{\n\t\t\t\t\tlong long cost=dist[j]-tmp;\n\t\t\t\t\tif(rem-1<=j){\n\t\t\t\t\t\tfor(int k=0;k<rem-1;k++){\n\t\t\t\t\t\t\tcost+=dist[k];\n\t\t\t\t\t\t}\n\t\t\t\t//\t\tprintf(\"%d %d: %lld\\n\",i,j,cost);\n\t\t\t\t\t\tret=min(ret,cost);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(rem==0)break;\n\t\t\t}\n\t\t\t\n\t\t\tif(rem==0)ret=min(ret,tmp);\n\t\t\t//printf(\"%d: %lld\\n\",i,ret);\n\t\t}\n\t\tprintf(\"%lld\\n\",ret);\n\t\treturn 0;\n\t}\n\tlong long ret=b;\n\tlong long tmp=b;\n\tfor(int i=sz-1;i>=0;i--){\n\t\tif(tmp>=dist[i])tmp-=dist[i];\n\t\telse ret=min(ret,dist[i]-tmp);\n\t\tret=min(ret,tmp);\n\t}\n\tprintf(\"%lld\\n\",ret);\n}\n//11 12 14 18"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i,n) for(ll i=0;i<(ll)(n);i++)\n\nusing namespace std;\ntypedef long long ll;\ntypedef __int128_t dll;\n\nint main() {\n  ll n,m,a,b,p,q;\n  cin>>n>>m>>a>>b>>p>>q;\n  if (a == b && b == 1) {\n    if (n > m/(p+q))\n      cout << min(m%(p+q), ((p+q)-(m%(p+q)))%(p+q)) << endl;\n    else\n      cout << m-(p+q)*n << endl;\n    return 0;\n  }\n  vector<ll> nums;\n  dll pa = p, qb = q;\n  REP(i,n) {\n    if (pa + qb >= 2*m) break;\n    nums.push_back(pa+qb);\n    pa *= a;\n    qb *= b;\n  }\n  int l = nums.size();\n  int s1 = l/2, s2=l-s1;;\n  vector<ll> lsr(begin(nums),begin(nums)+s1);\n  vector<ll> gtr(begin(nums)+s1,end(nums));\n  vector<ll> l1(1<<s1),l2(1<<s2);\n  REP(i,1<<s1) REP(j,s1)\n    if((i>>j)&1) l1[i] += lsr[j];\n  REP(i,1<<s2) REP(j,s2)\n    if((i>>j)&1) l2[i] += gtr[j];\n  sort(begin(l2),end(l2));\n  ll mn = m;\n  REP(i,1<<s1) {\n    auto itr = lower_bound(begin(l2),end(l2),m-l1[i]);\n    if(itr!=end(l2)) mn=min(mn,(l1[i]+*itr)-m);\n    if(itr!=begin(l2)) mn=min(mn,m-(l1[i]+*prev(itr)));\n  }\n  cout << mn << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=__int128;\n\nusing ll2=long long;\n\nconst ll INF=1e15;\n\nll powi(ll x,ll k){\n    ll res=1;\n    while(k){\n        if(k&1) res*=x;\n        if(res>INF) return INF;\n        x*=x;\n        k>>=1;\n    }\n    return res;\n}\nint main(){\n    ll2 nn,mm,aa,bb,pp,qq;\n    cin>>nn>>mm>>aa>>bb>>pp>>qq;\n    ll n=nn,m=mm,a=aa,b=bb,p=pp,q=qq;\n    if(a>=2 || b>=2){\n        int tn=min(n,ll(41));\n        int half=min(tn/2,20);\n        vector<ll> vec(1<<half);\n        for(int i=0;i<(1<<half);i++){\n            ll val=0;\n            for(int j=0;j<half;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,j)+q*powi(b,j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            vec[i]=val;\n\n        }\n        int rest=tn-half;\n        vector<ll> s(1<<rest);\n        for(int i=0;i<(1<<rest);i++){\n            ll val=0;\n            for(int j=0;j<rest;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,half+j)+q*powi(b,half+j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            s[i]=val;\n        }\n        ll2 res=m;\n        for(int i=0;i<vec.size();i++){\n            auto it=lower_bound(s.begin(),s.end(),m-vec[i]);\n            if(it!=s.end()){\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n            if(it!=s.begin()){\n                it--;\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n        }\n        cout<<res<<endl;\n    }\n    else{\n        if((p+q)*n>=m){\n            cout<<ll2(min(m%(p+q),(p+q)-m%(p+q)))<<endl;\n        }\n        else{\n            cout<<ll2(m-(p+q)*n)<<endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cassert>\n#include <typeinfo>\n#include <vector>\n#include <stack>\n#include <cmath>\n#include <set>\n#include <map>\n#include <string>\n#include <algorithm>\n#include <cstdio>\n#include <queue>\n#include <iomanip>\n#include <cctype>\n#include <random>\n#include <complex>\n#define syosu(x) fixed<<setprecision(x)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> P;\ntypedef pair<double,double> pdd;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<char> vc;\ntypedef vector<vc> vvc;\ntypedef vector<string> vs;\ntypedef vector<bool> vb;\ntypedef vector<vb> vvb;\ntypedef vector<P> vp;\ntypedef vector<vp> vvp;\ntypedef vector<pll> vpll;\ntypedef pair<int,P> pip;\ntypedef vector<pip> vip;\nconst int inf=1<<29;\nconst ll INF=1ll<<60;\nconst double pi=acos(-1);\nconst double eps=1e-7;\nconst ll mod=1e9+7;\nconst int dx[4]={0,1,0,-1},dy[4]={1,0,-1,0};\n\nll n,m,a,b,p,q;\n\nint main(){\n\tcin>>n>>m>>a>>b>>p>>q;\n\tif(a==1&&b==1){\n\t\tll x=p+q,tmp=min(m/x,n),res=m-x*tmp;\n\t\tif(tmp!=n) res=min(res,x*(tmp+1)-m);\n\t\tcout<<res<<endl;\n\t\treturn 0;\n\t}\n\tvl x;\n\tbool B=0;\n\tint I=0;\n\tdo{\n\t\tif(p+q>m) B=1;\n\t\tx.push_back(p+q);\n\t\tif(INF/p>a) p*=a;\n\t\telse break;\n\t\tif(INF/q>b) q*=b;\n\t\telse break;\n\t\tI++;\n\t}while(I<n&&!B);\n\tint S=x.size(),S2=S/2,T=S-S2;\n\tvl c(1<<S2);\n\tfor(int i=0;i<1<<S2;i++){\n\t\tfor(int j=0;j<S2;j++) if(i&1<<j) c[i]+=x[j];\n\t}\n\tsort(c.begin(),c.end());\n\tll res=INF;\n\tfor(int i=0;i<1<<T;i++){\n\t\tll tmp=0;\n\t\tfor(int j=0;j<T;j++) if(i&1<<j) tmp+=x[S2+j];\n\t\tauto it=lower_bound(c.begin(),c.end(),m-tmp);\n\t\tif(it!=c.end()) res=min(res,abs(m-tmp-*it));\n\t\tif(it!=c.begin()) res=min(res,abs(m-tmp-*(it-1)));\n\t}\n\tcout<<res<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i,n) for(ll i=0;i<(ll)(n);i++)\n\nusing namespace std;\ntypedef long long ll;\ntypedef __int128_t dll;\n\nint main() {\n  ll n,m,a,b,p,q;\n  cin>>n>>m>>a>>b>>p>>q;\n  if (a == b && b == 1) {\n    if (m >= (p+q)*n)\n      cout << min(m%(p+q), ((p+q)-(m%(p+q)))%(p+q)) << endl;\n    else\n      cout << m-(p+q)*n << endl;\n    return 0;\n  }\n  vector<ll> nums;\n  dll pa = p, qb = q;\n  REP(i,n) {\n    if (pa + qb >= 2*m) break;\n    nums.push_back(pa+qb);\n    pa *= a;\n    qb *= b;\n  }\n  int l = nums.size();\n  int s1 = l/2, s2=l-s1;;\n  vector<ll> lsr(begin(nums),begin(nums)+s1);\n  vector<ll> gtr(begin(nums)+s1,end(nums));\n  vector<ll> l1(1<<s1),l2(1<<s2);\n  REP(i,1<<s1) REP(j,s1)\n    if((i>>j)&1) l1[i] += lsr[j];\n  REP(i,1<<s2) REP(j,s2)\n    if((i>>j)&1) l2[i] += gtr[j];\n  sort(begin(l2),end(l2));\n  ll mn = m;\n  REP(i,1<<s1) {\n    auto itr = lower_bound(begin(l2),end(l2),m-l1[i]);\n    if(itr!=end(l2)) mn=min(mn,(l1[i]+*itr)-m);\n    if(itr!=begin(l2)) mn=min(mn,m-(l1[i]+*prev(itr)));\n  }\n  cout << mn << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <queue>\n#include <cmath>\n#include <algorithm>\n#include <functional>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<(n);++i)\n#define rep1(i,n) for(int i=1;i<=(n);++i)\n#define all(c) (c).begin(),(c).end()\n#define pb push_back\n#define fs first\n#define sc second\n#define show(x) cout << #x << \" = \" << x << endl\ntypedef long long ll;\nll inf=1e17;\nint main(){\n\tll n,m,a,b,p,q;\n\tcin>>n>>m>>a>>b>>p>>q;\n\tif(a>b) swap(n,m),swap(a,b),swap(p,q);\n\tll ans=m;\n\tif(b==1){\n\t\tll k=p+q;\n\t\tll d=min(n,m/k);\n\t\tans=m-k*d;\n\t\tif(d!=n) ans=min(ans,(d+1)*k-m);\n\t}else if(a==1){\n\t\tll bq[45]={},sum[46]={};\n\t\tbq[0]=q;\n\t\tsum[1]=q;\n\t\tll id=0;\n\t\tfor(;id<n-1;id++){\n\t\t\tif(bq[id]>inf/b) break;\n\t\t\tbq[id+1]=bq[id]*b;\n\t\t\tsum[id+2]=sum[id+1]+bq[id+1];\n\t\t}\n\t\t//can use 0~id\n\t\tll id_c=id;\n\t\tfor(ll k=1;k<=id+1;k++){\n\t\t\tif(bq[k-1]==0) break;\n\t\t\tll left=m-p*k;\n\t\t\tll now=0;\n\t\t\tid=id_c;\n\t\t\tint use=0;\n\t\t\tfor(;id>=0;id--){\n\t\t\t\tif(now+bq[id]>left){\n\t\t\t\t\tif(k-use-1>=0&&k-use-1<=id) ans=min(ans,now+bq[id]+sum[k-use-1]-left);\n\t\t\t\t}else{\n\t\t\t\t\tnow+=bq[id];\n\t\t\t\t\tuse++;\n\t\t\t\t\tif(use==k){\n\t\t\t\t\t\tans=min(ans,left-now);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}else{\n\t\tll id=0;\n\t\tll l=p,r=q;\n\t\tll num[40]={};\n\t\tfor(;id<n;id++){\n\t\t\tnum[id]=l+r;\n\t\t\tif(l>inf/a) break;\n\t\t\tif(r>inf/b) break;\n\t\t\tl*=a;\n\t\t\tr*=b;\n\t\t}\n\t\tif(id==n) id--;\n\t\t//can use 0~id\n\t\tll now=0;\n\t\tfor(;id>=0;id--){\n\t\t\tif(now+num[id]>m){\n\t\t\t\tans=min(ans,now+num[id]-m);\n\t\t\t}else{\n\t\t\t\tans=min(ans,m-(now+num[id]));\n\t\t\t\tnow+=num[id];\n\t\t\t}\n\t\t}\n\t}\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (int)(k); i < (int)(n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\n\nll pow(ll x, ll n)\n{\n\tll res = 1;\n\twhile (n > 0)\n\t{\n\t\tif (n & 1) res = res * x;\n\t\tx = x*x;\n\t\tn >>= 1;\n\t}\n\treturn res;\n}\n\nll n, m, a, b, p, q;\n\nll calc(ll k)\n{\n\treturn p * pow(a, k) + q * pow(b, k);\n}\n\nbool check(ld k)\n{\n\treturn p * pow(a, k) + q * pow(b, k) <= pow(10, 12);\n}\n\nll use(ll d)\n{\n\tll loop = min(n + 1, 42ll);\n\tll res;\n\tREP(i, loop)\n\t{\n\t\tif (!check(i) || calc(i) > d)\n\t\t{\n\t\t\tres = i - 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\nint main()\n{\n\tcin.sync_with_stdio(false); cout << fixed << setprecision(10);\n\tcin >> n >> m >> a >> b >> p >> q;\n\tll ans = LLONG_MAX;\n\tif (a == 1 && b == 1)\n\t{\n\t\tif ((p + q) * n < m) ans = m - (p + q) * n;\n\t\telse\n\t\t{\n\t\t\tint t = m / (p + q);\n\t\t\tans = min(m - (p + q) * t, (p + q)*(t + 1) - m);\n\t\t}\n\t}\n\telse if (a > 1 && b > 1)\n\t{\n\t\tset<int> st;\n\t\tll d = m;\n\t\tint cnt = 0, mx = n;\n\t\tint loop = min(n + 1, 41ll);\n\t\twhile (st.size() < loop)\n\t\t{\n\t\t\tll t = use(d);\n\t\t\tif (t + 1 < n && !st.count(t + 1) && d < calc(t + 1))\n\t\t\t{\n\t\t\t\tchmin(ans, calc(t + 1) - d);\n\t\t\t}\n\t\t\tif (t < 0) break;\n\t\t\tll tmp = min(n, t);\n\t\t\twhile (st.count(tmp) && tmp > 0) tmp--;\n\t\t\tif (tmp == 0 && st.count(0)) break;\n\t\t\td -= calc(tmp);\n\t\t\tst.insert(tmp);\n\t\t\tchmin(ans, d);\n\t\t}\n\t\tchmin(ans, d);\n\t}\n\telse\n\t{\n\t\tif (a > b) swap(a, b);\n\t\tint loop = min(n + 1, 41ll);\n\t\tREP(i, loop)\n\t\t{\n\t\t\tset<int> st;\n\t\t\tll d = m;\n\t\t\tint cnt = 0, mx = n;\n\t\t\twhile (st.size() < i)\n\t\t\t{\n\t\t\t\tll t = use(d);\n\t\t\t\tif (t < 0) break;\n\t\t\t\tll tmp = min(n - 1, t);\n\t\t\t\twhile (st.count(tmp) && tmp > 0) tmp--;\n\t\t\t\tif (tmp == 0 && st.count(0)) break;\n\t\t\t\td -= calc(tmp);\n\t\t\t\tst.insert(tmp);\n\t\t\t}\n\t\t\tif (st.size() == i - 1)\n\t\t\t{\n\t\t\t\tif (!st.count(0))\n\t\t\t\t{\n\t\t\t\t\tchmin(ans, calc(0) - d);\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse if (st.size() != i) continue;\n\t\t\tchmin(ans, d);\n\t\t\tif (st.size() > 0)\n\t\t\t{\n\t\t\t\tint last = *st.begin();\n\t\t\t\tif (last + 1 < n && !st.count(last + 1))\n\t\t\t\t{\n\t\t\t\t\td = d + calc(last) - calc(last + 1);\n\t\t\t\t\tchmin(ans, -d);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dist[40];\nint main(){\n\tlong long a,b,c,d,e,f;\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&a,&b,&c,&d,&e,&f);\n\tif(c==1&&d==1){\n\t\tlong long v=b%(e+f);\n\t\tlong long g=b/(e+f);\n\t\tprintf(\"%lld\\n\",v+max(0LL,g-a));\n\t\treturn 0;\n\t}\n\tint sz=0;\n\tfor(int i=0;i<=a;i++){\n\t\tlong long L=e;\n\t\tlong long R=f;\n\t\tfor(int j=0;j<i;j++)L*=c;\n\t\tfor(int j=0;j<i;j++)R*=d;\n\t\tlong long t=L+R;\n\t\tif(t>b)break;\n\t\tdist[sz++]=t;\n\t//\tprintf(\"%lld \",dist[sz-1]);\n\t}\n\tif(d==1){\n\t\tswap(c,d);\n\t\tswap(e,f);\n\t}\n\tif(c==1){\n\t\tlong long ret=b;\n\t\tfor(int i=0;i<sz;i++)dist[i]-=e;\n\t\tfor(int i=1;i<=sz;i++){\n\t\t\tlong long tmp=b-(long long)i*e;\n\t\t\tif(tmp<0)break;\n\t\t\tint rem=i;\n\t\t\tfor(int j=sz-1;j>=0;j--){\n\t\t\t\tif(tmp>=dist[j]){\n\t\t\t\t\trem--;\n\t\t\t\t\ttmp-=dist[j];\n\t\t\t\t}else{\n\t\t\t\t\tlong long cost=dist[j]-tmp;\n\t\t\t\t\tif(rem-1<=j){\n\t\t\t\t\t\tfor(int k=0;k<rem-1;k++){\n\t\t\t\t\t\t\tcost+=dist[k];\n\t\t\t\t\t\t}\n\t\t\t\t//\t\tprintf(\"%d %d: %lld\\n\",i,j,cost);\n\t\t\t\t\t\tret=min(ret,cost);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(rem==0)break;\n\t\t\t}\n\t\t\t\n\t\t\tif(rem==0)ret=min(ret,tmp);\n\t\t\t//printf(\"%d: %lld\\n\",i,ret);\n\t\t}\n\t\tprintf(\"%lld\\n\",ret);\n\t\treturn 0;\n\t}\n\tlong long ret=b;\n\tlong long tmp=b;\n\tfor(int i=sz-1;i>=0;i--){\n\t\tif(tmp>=dist[i])tmp-=dist[i];\n\t\telse ret=min(ret,dist[i]-tmp);\n\t\tret=min(ret,tmp);\n\t}\n\tprintf(\"%lld\\n\",ret);\n}\n//11 12 14 18"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (int)(k); i < (int)(n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\n\nll pow(ll x, ll n)\n{\n\tll res = 1;\n\twhile (n > 0)\n\t{\n\t\tif (n & 1) res = res * x;\n\t\tx = x*x;\n\t\tn >>= 1;\n\t}\n\treturn res;\n}\n\nll n, m, a, b, p, q;\n\nll calc(ll k)\n{\n\treturn p * pow(a, k) + q * pow(b, k);\n}\n\nbool check(ld k)\n{\n\treturn p * pow(a, k) + q * pow(b, k) <= pow(10, 12);\n}\n\nll use(ll d)\n{\n\tll loop = min(n + 1, 42ll);\n\tll res = n - 1;\n\tREP(i, loop)\n\t{\n\t\tif (!check(i) || calc(i) > d)\n\t\t{\n\t\t\tres = i - 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\nint main()\n{\n\tcin.sync_with_stdio(false); cout << fixed << setprecision(10);\n\tcin >> n >> m >> a >> b >> p >> q;\n\tll ans = LLONG_MAX;\n\tif (a == 1 && b == 1)\n\t{\n\t\tif (((ld)p + q) * n < (ld)m) ans = m - (p + q) * n;\n\t\telse\n\t\t{\n\t\t\tll t = m / (p + q);\n\t\t\tans = min(m - (p + q) * t, (p + q)*(t + 1) - m);\n\t\t}\n\t}\n\telse if (a > 1 && b > 1)\n\t{\n\t\tset<int> st;\n\t\tll d = m;\n\t\tint cnt = 0, mx = n;\n\t\tint loop = min(n + 1, 41ll);\n\t\twhile (st.size() < loop)\n\t\t{\n\t\t\tll t = use(d);\n\t\t\tif (t + 1 < n && !st.count(t + 1) && d < calc(t + 1))\n\t\t\t{\n\t\t\t\tchmin(ans, calc(t + 1) - d);\n\t\t\t}\n\t\t\tif (t < 0) break;\n\t\t\tll tmp = min(n, t);\n\t\t\twhile (st.count(tmp) && tmp > 0) tmp--;\n\t\t\tif (tmp == 0 && st.count(0)) break;\n\t\t\td -= calc(tmp);\n\t\t\tst.insert(tmp);\n\t\t\tchmin(ans, d);\n\t\t}\n\t\tchmin(ans, d);\n\t}\n\telse\n\t{\n\t\tint loop = min(n + 1, 41ll);\n\t\tREP(i, loop)\n\t\t{\n\t\t\tset<int> st;\n\t\t\tll d = m;\n\t\t\tint cnt = 0, mx = n;\n\t\t\twhile (st.size() < i)\n\t\t\t{\n\t\t\t\tll t = use(d);\n\t\t\t\tif (t < 0) break;\n\t\t\t\tll tmp = min(n - 1, t);\n\t\t\t\twhile (st.count(tmp) && tmp > 0) tmp--;\n\t\t\t\tif (tmp == 0 && st.count(0)) break;\n\t\t\t\td -= calc(tmp);\n\t\t\t\tst.insert(tmp);\n\t\t\t}\n\t\t\tif (st.size() == i - 1)\n\t\t\t{\n\t\t\t\tif (!st.count(0))\n\t\t\t\t{\n\t\t\t\t\tchmin(ans, calc(0) - d);\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse if (st.size() != i) continue;\n\t\t\tchmin(ans, d);\n\t\t\tif (st.size() > 0)\n\t\t\t{\n\t\t\t\tint last = *st.begin();\n\t\t\t\tif (last + 1 < n && !st.count(last + 1))\n\t\t\t\t{\n\t\t\t\t\td = d + calc(last) - calc(last + 1);\n\t\t\t\t\tchmin(ans, -d);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <vector>\n#include <algorithm>\n\n#define rep(i,n) for(int i = 0; i < n; ++i)\nusing namespace std;\n\nusing ll = long long;\nusing R = long double;\n\nint main(void){\n\tll n,m,a,b,p,q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\n\tif(a == 1 and b == 1){\n\t\tll ticket = p + q;\n\t\tconst ll used = min(n,m/ticket);\n\t\tconst ll ans = m - ticket * used;\n\t\tcout << ans << endl;\n\t\treturn 0;\n\t}\n\n\tvector<ll> ticket;\n\tn = min(n,40LL);\n\n\trep(i,n){\n\t\tll cur = p * pow<ll>(a,i) + q * pow<ll>(b,i);\n\t\tif(1.0 * p * pow<R>(a,i) + 1.0 * q * pow<R>(b,i) > 1e18) break;\n\t\tif(cur > m) break;\n\t\tticket.push_back(cur);\n\t}\n\n\tn = ticket.size();\n\n\tvector<ll> item[2];\n\tconst ll half[2] = {n/2,n-n/2};\n\tconst ll offset[2] = {0,n/2};\n\n\trep(k,2)rep(mask,1 << half[k]){\n\t\tll cur = 0LL;\n\t\trep(i,half[k]) if(mask & (1 << i)) cur += ticket[i+offset[k]];\n\t\titem[k].push_back(cur);\n\t}\n\n\t\n\tll ans = m;\n\tsort(begin(item[1]),end(item[1]));\n\t\n\n\n\tfor(auto &it:item[0]){\n\t\tconst ll arg = m - it;\n\t\tauto it2 = upper_bound(begin(item[1]),end(item[1]),arg);\n\t\tit2--;\n\t\tans = min(ans, m - it - *it2);\n\t}\n\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\nusing namespace std;\n\nlong long vals[50];\nlong long N;\nlong long M;\n\nlong long dfs(int id,int toTake,int taken,long long curVal,bool flg){\n//\tprintf(\"%d %d %d %lld\\n\",id,toTake,taken,curVal);\n\tif(id==-1){\n\t\tif(taken==toTake) return curVal;\n\t\telse return -1;\n\t}\n\tif(toTake==taken){\n\t\treturn curVal;\n\t}\n\tlong long nxtVal=curVal+vals[id];\n//\tprintf(\"nxt=%lld\\n\",nxtVal);\n\tlong long res=-1;\n\tif(nxtVal>M){\n\t\tres=dfs(id-1,toTake,taken,curVal,flg);\n\t\treturn res;\n\t}\n\tif(flg==false){\n\t\t//not take\n\t\tres=dfs(id-1,toTake,taken,curVal,true);\n\t}\n\tlong long res2=dfs(id-1,toTake,taken+1,nxtVal,flg);\n\tres=max(res,res2);\n\treturn res;\n}\n\nlong long dfs2(int id,int toTake,int taken,long long curVal){\n\tif(id==-1){\n\t\tif(toTake!=taken) return -1;\n\t\treturn curVal;\n\t}\n\tlong long nxtVal=curVal+vals[id];\n\tif(toTake==taken+id+1){\n\t\tlong long tmp=dfs2(id-1,toTake,taken+1,nxtVal);\n\t\treturn tmp;\n\t}\n\tlong long notTake=curVal;\n\tfor(int i=1;i<=toTake-taken;i++){\n\t\tnotTake+=vals[id-i];\n\t}\n\tlong long res;\n\tif(notTake>=M){\n\t\tres=dfs2(id-1,toTake,taken,curVal);\n\t}else{\n\t\tres=dfs2(id-1,toTake,taken+1,nxtVal);\n\t}\n\treturn res;\n}\n\nlong long mult(long long a,long long b,long long c){\n\tlong long x=c/a;\n\tif(b>x) return -1;\n\tlong long res=a*b;\n\tif(res>c) return -1;\n\treturn res;\n}\n\nint main(){\n\tlong long a,b,p,q;\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&N,&M,&a,&b,&p,&q);\n\tif(a==1&&b==1){\n\t\tlong long x=p+q;\n\t\tlong long num=M/x;\n\t\tnum=min(num,N);\n\t\tlong long train=x*num;\n\t\tprintf(\"%lld\\n\",M-train);\n\t\treturn 0;\n\t}\n\tlong long pa=1,pb=1;\n\tint n=0;\n\tfor(int i=0;i<N;i++){\n\t\tlong long cur1=mult(pa,p,M);\n\t\tlong long cur2=mult(pb,q,M);\n\t\tif(cur1==-1||cur2==-1) break;\n\t\tlong long cur=cur1+cur2;\n\t\tif(cur>M) break;\n\t\tvals[n++]=cur;\n\t\tpa=mult(pa,a,M);\n\t\tpb=mult(pb,b,M);\n\t\tif(pa==-1||pb==-1) break;\n\t}\n\tif(n==0){\n\t\tprintf(\"%lld\\n\",M);\n\t\treturn 0;\n\t}\n//\tfor(int i=0;i<n;i++){\n//\t\tprintf(\"%d %lld\\n\",i,vals[i]);\n//\t}\n\tN=n;\n\tlong long ans=M;\n\tfor(int i=1;i<=n;i++){\n\t\tlong long tmp=dfs(n-1,i,0,0,false);\n//\t\tprintf(\"%d %lld\\n\",i,tmp);\n\t\tif(tmp==-1) continue;\n\t\tans=min(ans,M-tmp);\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tlong long tmp=dfs2(n-1,i,0,0);\n\t\tif(tmp==-1) continue;\n\t\tans=min(ans,tmp-M);\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\n\nint main(){\n\n\tint POW[22];\n\tfor(int i = 0; i < 22; i++)POW[i] = pow(2,i);\n\n\tll N,M,A,B,P,Q;\n\n\tscanf(\"%lld %lld %lld %lld %lld %lld\",&N,&M,&A,&B,&P,&Q);\n\n\tif(A == 1 && B == 1){\n\n\t\tll num = M/(P+Q);\n\n\t\tif(num >= N){\n\t\t\tprintf(\"%lld\\n\",M-N*(P+Q));\n\t\t}else{\n\t\t\tprintf(\"%lld\\n\",min(M%(P+Q),(num+1)*(P+Q)-M)); //少し足りないと、少し多いの、差が小さい方\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tvector<ll> FIRST;\n\n\tll tmp = P+Q;\n\tll a = 1, b = 1;\n\tll count = 0,over_count = 0;\n\n\tdouble check;\n\n\twhile(true){\n\n\t\tif(tmp > M)over_count++; //超過は1回だけ許す\n\n\t\tFIRST.push_back(tmp);\n\t\tcount++;\n\t\tif(count == N || over_count == 1)break;\n\n\t\tcheck = P*a*A+Q*b*B;\n\t\tif(check > (double)M)break;\n\n\t\ta *= A;\n\t\tb *= B;\n\n\t\ttmp = P*a+Q*b;\n\t}\n\n\t//数字を2つのグループに振り分ける\n\tvector<ll> G[2];\n\tfor(ll i = 0; i < FIRST.size(); i++){\n\t\tif(i <= (FIRST.size())/2){\n\t\t\tG[0].push_back(FIRST[i]);\n\t\t}else{\n\t\t\tG[1].push_back(FIRST[i]);\n\t\t}\n\t}\n\n\tint num[2];\n\tnum[0] = (int)G[0].size();\n\tnum[1] = (int)G[1].size();\n\n\t//各グループで数字を作る\n\tvector<ll> V[2];\n\tV[1].push_back(0);\n\tfor(int group = 0; group < 2; group++){\n\t\tfor(int state = 0; state < POW[num[group]]; state++){\n\t\t\ttmp = 0;\n\t\t\tfor(int loop = 0; loop < num[group]; loop++){\n\t\t\t\tif(state & (1 << loop)){\n\t\t\t\t\ttmp += G[group][loop];\n\t\t\t\t}\n\t\t\t}\n\t\t\tV[group].push_back(tmp);\n\t\t}\n\t\tsort(V[group].begin(),V[group].end());\n\t\tV[group].erase(unique(V[group].begin(),V[group].end()),V[group].end());\n\t}\n\n\tll ans = M,tmp_ans;\n\n\tint left,right,m,loc;\n\n\tfor(int i = 0; i < V[0].size(); i++){\n\n\t\tif(V[0][i] >= M){\n\t\t\tans = min(ans,V[0][i]-M);\n\t\t\tbreak;\n\t\t}\n\n\t\t//2分探索で、和がMを超えない、最大のindexを求める\n\t\tleft = 0,right = (int)V[1].size()-1,m = (left+right);\n\t\tloc = 0;\n\n\t\twhile(left <= right){\n\t\t\tif(V[0][i]+V[1][m] <= M){\n\t\t\t\tloc = m;\n\t\t\t\tleft = m+1;\n\t\t\t}else{\n\t\t\t\tright = m-1;\n\t\t\t}\n\t\t\tm = (left+right)/2;\n\t\t}\n\n\t\ttmp_ans = (M-(V[0][i]+V[1][loc]));\n\t\tif(loc < (int)V[1].size()-1){\n\t\t\ttmp_ans = min(tmp_ans,V[0][i]+V[1][loc+1]-M);\n\t\t}\n\n\t\tans = min(ans,tmp_ans);\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  ll MAX=1000000000000LL;\n  \n  assert( 1<= n &&n <= MAX );\n  assert( 1<= m &&m <= MAX );\n  assert( 1<= a &&a <= MAX );\n  assert( 1<= b &&b <= MAX );\n  assert( 1<= p &&p <= MAX );\n  assert( 1<= q &&q <= MAX );\n  \n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    //    if(total <= m)return m-total;\n    return min(m%d, m-m%d);\n    \n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n    if( i==40 )break;\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        ll c=T[i]+U[j];\n        res=min( res,  abs(m-c) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<climits>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\ntypedef long long ll;\n\nvector<ll> generate(vector<ll> a){\n  vector<ll> ret;\n  int n = a.size();\n  rep(i,(1<<n)){\n    ll tmp = 0;\n    rep(j,n){\n      if ((1<<j)&i)tmp += a[j];\n    }\n    ret.push_back(tmp);\n  }\n  sort(ret.begin(),ret.end());\n  return ret;\n}\n\nll bs(ll m,ll sum,vector<ll> &a,bool fg){\n  int ret = -1;\n  int l = 0,r = a.size()-1;\n  while(l <= r){\n    int mid = (l+r)/2;\n    ll tmp = sum + a[mid];\n    if (fg){\n      if (tmp <= m){//ä¸éããã£ã¨ä¸ããã\n\tret = mid;\n\tl = mid+1;\n      }else {\n\tr = mid-1;\n      }\n    }else {\n      if (tmp >= m){\n\tret = mid;\n\tr = mid-1;\n      }else {\n\tl = mid+1;\t\n      }\n    }\n  }\n\n  /*  cout <<\"dbg\" << endl;\n  rep(i,a.size())cout << a[i] <<\" \" ;cout << endl;\n  cout <<fg <<\" \" <<  m <<\" \" << sum <<\" \" << (ret != -1?a[ret]:-1) <<\" \" << \n    ((ret != -1)?sum+a[ret]:-1)\n       << endl;\n  */\n  if (ret == -1)return llabs(m-sum);\n  return llabs(m-(sum+a[ret]));\n}\n\nll ans;\nvoid search(int n,int now,ll sum,int m,vector<ll> &a,vector<ll> &all){\n  //ub,sumã¨aã®è¦ç´ ã§ãmä»¥ä¸ã§æå¤§ã®ãã®ãæ¢ã\n  //lb,sumã¨aã®è¦ç´ ã®åã§mä»¥ä¸æå°ã®ãã®ãæ¢ã\n  ll ub=bs(m,sum,all,true),lb=bs(m,sum,all,false);\n  ans = min(ans,ub);\n  ans = min(ans,lb);\n  if (now == n)return;\n  //ä½¿ã\n  search(n,now+1,sum+a[now],m,a,all);\n  //ä½¿ããªã\n  search(n,now+1,sum,m,a,all);\n}\n\n/*\n  ååå¨åæãã ãã¡ã¢ãªç¯ç´ãããã®ã§å¾ãååã¯æ¢ç´¢ããã\n */\nll solve2(vector<ll> in,ll m){\n  vector<ll> mae,usiro;\n  rep(i,in.size()){\n    if (i < in.size()/2)mae.push_back(in[i]);\n    else usiro.push_back(in[i]);\n  }\n  vector<ll> all=generate(mae);\n  ans = m;\n  search(usiro.size(),0,0,m,usiro,all);\n  return ans;\n}\n\nll solve(ll n,ll m,ll a,ll b,ll p,ll q){\n  if (a == 1 && b == 1){//ç¹æ®ã±ã¼ã¹\n    ll sum = a+b;\n    ll lb = min(n,m/sum),ub=min(n,(m+sum-1)/sum);\n    ll ret = m;\n    if (lb <= n){\n      ret = min(ret,llabs(m-lb*(a+b)));\n    }\n    if (ub <= n){\n      ret = min(ret,llabs(m-ub*(a+b)));\n    }\n    return ret;\n  }\n\n  //ãã±ããã®çæ\n  //ä¸å¿doubleåã§å¤ã¯åãæ±ã£ã¦ããã\n  //å¿è¦ãªãã±ããã¯æå¤§ï¼ï¼æã§ãããä»¥ä¸ã¯æå³ããªãã\n  int loop = 0;\n  ll cur = p + q;\n  ll mula=1,mulb=1;\n  double m_d=m;\n  double cur_d = p+q;\n  double mula_d = 1, mulb_d = 1;\n  vector<ll> all;\n  all.push_back(cur);\n  while(cur_d <= m_d && loop < n){\n    mula *= a;\n    mulb *= b;\n    cur = p*mula + q*mulb;\n    all.push_back(cur);\n\n    mula_d *= a;\n    mulb_d *= b;\n    cur_d = p*mula_d + q*mulb_d;\n  }\n  //rep(i,all.size())cout << all[i] <<\" \" ;cout << endl;\n\n  if (all.size() == 1){//ä¸ã¤ããä½¿ãããã±ããããªããªããããç­ãã«ããã(å¿ãï¼æã¯ãããã¨ãä¿è¨¼ããã¦ãã)\n    return min(m,llabs(all[0]-m));\n  }\n  return solve2(all,m);\n}\n\nmain(){\n  ll n,m,a,b,p,q;\n  while(cin>>n>>m>>a>>b>>p>>q && n){\n    cout << solve(n,m,a,b,p,q)  << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll,ll> P;\n \nconst double EPS = 1e-10;\nconst ll INF = 100000000;\nconst ll MOD = 1000000007;\n\nll n, m, a, b, p, q;\nll X[41];\nll nX;\nll x[(1<<21)], y[(1<<21)];\nll nx, ny;\n\nint main() {\n    cin >> n >> m >> a >> b >> p >> q;\n    if (a == 1 && b == 1) {\n        if ((p+q) <= m/n) cout << m - n*(p+q) << endl;\n        else cout << min(m % (p+q), p+q - m%(p+q)) << endl;\n        return 0;\n    }\n    {\n        ll pre = p, pos = q;\n        rep(i,n) {\n            X[i] = pre + pos;\n            nX++;\n            if (pre + pos >= m) {\n                break;\n            }\n            pre *= a; pos *= b;\n        }\n    }\n    nx = nX/2;\n    ny = nX - nx;\n    rep(i,(1<<nx)) {\n        ll pos = 0;\n        rep(j,nx) {\n            if (i&(1<<j)) pos += X[j];\n            if (pos > m) break;\n        }\n        x[i] = pos;\n    }\n    rep(i,(1<<ny)) {\n        ll pos = 0;\n        rep(j,ny) {\n            if (i&(1<<j)) pos += X[nx+j];\n            if (pos > m) break;\n        }\n        y[i] = pos;\n    }\n    sort(x, x+(1<<nx));\n    sort(y, y+(1<<ny));\n    ll ans = INF*INF;\n    rep(i,(1<<nx)) {\n        int p = lower_bound(y, y+(1<<ny), m-x[i]) - y;\n        ans = min(ans, abs(y[p]+x[i]-m));\n        if (p != 0) ans = min(ans, abs(y[p-1]+x[i]-m));\n    }\n    cout << ans << endl;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll n,m,a,b,p,q,s[50],g;\nvector<ll> v[2];\n\nvoid dfs(int f,ll pos,ll ss,ll e){\n  if(ss>m)return;\n  if(pos==e){\n    v[f].push_back(ss);\n    return;\n  }\n  ll ns=s[pos]+ss;\n  dfs(f,pos+1,ss,e);\n  dfs(f,pos+1,ns,e);\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  if(b==1&&a==1){\n    if(m/(p+q)>=n)cout<<m-(p+q)*n<<endl;\n    else cout<<min(p+q-(m%(p+q)),m%(p+q))<<endl;    \n  }\n  else{\n    for(ll i=0,x=p,y=q;i<n;i++,x*=a,y*=b){\n      ll ss=x+y;\n      if(ss>m)break;\n      s[g++]=ss;\n    }\n    v[0].push_back(0);\n   v[1].push_back(0);\n   v[1].push_back(1e16);\n    dfs(0,0,0,g/2);\n    dfs(1,g/2,0,g);\n    ll ans=m;\n    sort(v[1].begin(),v[1].end());\n    for(int i=0;i<v[0].size();i++){\n      int l=0,M,r=v[1].size();\n      while(l<r){\n\tM=(l+r)/2;\n\tif(v[0][i]+v[1][M]<=m)l=M+1;\n\telse r=M;\n      }\n      ans=min(ans,m-v[0][i]-v[1][r-1]);\n      ans=min(ans,v[0][i]+v[1][r]-m);\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\n\nint main(){\n\n\tint POW[22];\n\tfor(int i = 0; i < 22; i++)POW[i] = pow(2,i);\n\n\tll N,M,A,B,P,Q;\n\n\tscanf(\"%lld %lld %lld %lld %lld %lld\",&N,&M,&A,&B,&P,&Q);\n\n\tif(A == 1 && B == 1){\n\n\t\tll num = M/(P+Q);\n\n\t\tif(num >= N){\n\t\t\tprintf(\"%lld\\n\",M-N*(P+Q));\n\t\t}else{\n\t\t\tprintf(\"%lld\\n\",min(M%(P+Q),(num+1)*(P+Q)-M)); //少し足りないと、少し多いの、差が小さい方\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tvector<ll> FIRST;\n\n\tll tmp = P+Q;\n\tll a = 1, b = 1;\n\tll count = 0,over_count = 0;\n\n\tdouble check;\n\n\twhile(true){\n\n\t\tif(tmp > M)over_count++; //超過は1回だけ許す\n\n\t\tFIRST.push_back(tmp);\n\t\tcount++;\n\t\tif(count == N || over_count == 1)break;\n\n\t\tcheck = P*a*A+Q*b*B;\n\t\tif(check > (double)M)break;\n\n\t\ta *= A;\n\t\tb *= B;\n\n\t\ttmp = P*a+Q*b;\n\t}\n\n\t//printf(\"count:%lld\\n\",count);\n\n\t//数字を2つのグループに振り分ける\n\tvector<ll> G[2];\n\tfor(ll i = 0; i < FIRST.size(); i++){\n\t\tif(i <= (FIRST.size())/2){\n\t\t\tG[0].push_back(FIRST[i]);\n\t\t}else{\n\t\t\tG[1].push_back(FIRST[i]);\n\t\t}\n\t}\n\n\tint num[2];\n\tnum[0] = (int)G[0].size();\n\tnum[1] = (int)G[1].size();\n\n\t//printf(\"num_0:%d\\n\",num[0]);\n\n\t//各グループで数字を作る\n\tvector<ll> V[2];\n\tV[1].push_back(0);\n\tfor(int group = 0; group < 2; group++){\n\t\tfor(int state = 0; state < POW[num[group]]; state++){\n\t\t\ttmp = 0;\n\t\t\tfor(int loop = 0; loop < num[group]; loop++){\n\t\t\t\tif(state & (1 << loop)){\n\t\t\t\t\ttmp += G[group][loop];\n\t\t\t\t}\n\t\t\t}\n\t\t\tV[group].push_back(tmp);\n\t\t}\n\t\tsort(V[group].begin(),V[group].end());\n\t\tV[group].erase(unique(V[group].begin(),V[group].end()),V[group].end());\n\t}\n\n\tll ans = M,tmp_ans;\n\n\tint left,right,m,loc;\n\n\tfor(int i = 0; i < V[0].size(); i++){\n\n\t\tif(V[0][i] >= M){\n\t\t\tans = min(ans,V[0][i]-M);\n\t\t\tbreak;\n\t\t}\n\n\t\t//2分探索で、和がMを超えない、最大のindexを求める\n\t\tleft = 0,right = (int)V[1].size()-1,m = (left+right);\n\t\tloc = 0;\n\n\t\twhile(left <= right){\n\t\t\tif(V[0][i]+V[1][m] <= M){\n\t\t\t\tloc = m;\n\t\t\t\tleft = m+1;\n\t\t\t}else{\n\t\t\t\tright = m-1;\n\t\t\t}\n\t\t\tm = (left+right)/2;\n\t\t}\n\n\t\ttmp_ans = (M-(V[0][i]+V[1][loc]));\n\t\tif(loc < (int)V[1].size()-1){\n\t\t\ttmp_ans = min(tmp_ans,V[0][i]+V[1][loc+1]-M);\n\t\t}\n\t\t//printf(\"i:%d tmp_ans:%lld\\n\",i,tmp_ans);\n\t\tans = min(ans,tmp_ans);\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nsigned main(){\n\tint n,m,a,b,p,q,mi;\n\tvector<int> vec,num;\n\tcin >> n >> m >> a >> b >> p >> q;\n\tmi = m;\n\tif(a == 1 && b == 1){\n\t\tif((p + q) * n >= m) cout << min(m % (p + q),p + q - m % (p + q)) << endl;\n\t\telse cout << m - (p + q) * n << endl;\n\t\treturn 0;\n\t}\n\tint ta = p,tb = q;\n\tfor(int i = 0;i < n;i++){\n\t\tif(ta + tb > m) break;\n\t\tvec.push_back(ta + tb);\n\t\tif(ta > (m + a - 1) / a || tb > (m + b - 1) / b) break;\n\t\tta *= a;\n\t\ttb *= b;\n\t}\n\tcout << endl;\n\tn = vec.size();\n\tfor(int i = 0;i < (1 << (n / 2));i++){\n\t\tint sum = 0;\n\t\tfor(int j = 0;j < n / 2;j++){\n\t\t\tif((i >> j) & 1) sum += vec[j];\n\t\t}\n\t\tnum.push_back(sum);\n\t}\n\tsort(num.begin(),num.end());\n\tfor(int i = 0;i < (1 << ((n + 1) / 2));i++){\n\t\tint sum = 0;\n\t\tfor(int j = 0;j < (n + 1) / 2;j++){\n\t\t\tif((i >> j) & 1) sum += vec[j + n / 2];\n\t\t}\n\t\tint ind = upper_bound(num.begin(),num.end(),m - sum) - num.begin() - 1;\n\t\tif(ind >= 0) mi = min(mi,m - sum - num[ind]);\n\t\tif(ind + 1 < n) mi = min(mi,-(m - sum - num[ind + 1]));\n\t}\n\tcout << mi << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<set>\n#include<cstdlib>\n\nusing namespace std;\n\nlong long n,m,a,b,p,q;\n\nlong long mul(long long a,long long b){\n  __int128 r=a;\n  r*=b;\n  if(r>1e18)throw 0;\n  return r;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  if(a==1&&b==1){\n    long long c=m/(p+q);\n    cout<<min(m-c*(p+q),(c+1)*(p+q)-m)<<endl;\n  }else{\n    long long t[55]={};\n    t[0]=p+q;\n    long long ak=1,bk=1;\n    try{\n      for(int i=1;i<min(n,42ll);i++){\n\tak=mul(ak,a);\n\tbk=mul(bk,b);\n\tt[i]=mul(p,ak)+mul(q,bk);\n      }\n    }catch(...){\n    }\n    set<long long> s;\n    for(int i=0;i<1<<21;i++){\n      long long c=0;\n      for(int j=0;j<21;j++){\n\tc+=(i>>j&1)*t[j+21];\n      }\n      s.insert(c);\n    }\n    long long ans=1e18;\n    for(int i=0;i<1<<21;i++){\n      long long c=0;\n      for(int j=0;j<21;j++){\n\tc+=(i>>j&1)*t[j];\n      }\n      auto it=s.lower_bound(m-c);\n      if(it!=s.end()){\n\tans=min(ans,llabs(m-*it-c));\n      }\n      if(it!=s.begin()){\n\tit--;\n\tans=min(ans,llabs(m-*it-c));\n      }\n    }\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cassert>\n#include<climits>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\ntypedef long long ll;\n\nvector<ll> generate(vector<ll> a){\n  vector<ll> ret;\n  int n = a.size();\n  rep(i,(1<<n)){\n    ll tmp = 0;\n    rep(j,n){\n      if ((1<<j)&i)tmp += a[j];\n    }\n    ret.push_back(tmp);\n  }\n  sort(ret.begin(),ret.end());\n  return ret;\n}\n\nll bs(ll m,ll sum,vector<ll> &a,bool fg){\n  int ret = -1;\n  int l = 0,r = a.size()-1;\n  while(l <= r){\n    int mid = (l+r)/2;\n    ll tmp = sum + a[mid];\n    if (fg){\n      if (tmp <= m){//ä¸éããã£ã¨ä¸ããã\n\tret = mid;\n\tl = mid+1;\n      }else {\n\tr = mid-1;\n      }\n    }else {\n      if (tmp >= m){\n\tret = mid;\n\tr = mid-1;\n      }else {\n\tl = mid+1;\t\n      }\n    }\n  }\n\n  /*  cout <<\"dbg\" << endl;\n  rep(i,a.size())cout << a[i] <<\" \" ;cout << endl;\n  cout <<fg <<\" \" <<  m <<\" \" << sum <<\" \" << (ret != -1?a[ret]:-1) <<\" \" << \n    ((ret != -1)?sum+a[ret]:-1)\n       << endl;\n  */\n  if (ret == -1)return llabs(m-sum);\n  //cout << m <<\" \" << sum+a[ret] << \" \" << llabs(m-(sum+a[ret])) << endl;\n  return llabs(m-(sum+a[ret]));\n}\n\nll ans;\nvoid search(int n,int now,ll sum,ll m,vector<ll> &a,vector<ll> &all){\n  //ub,sumã¨aã®è¦ç´ ã§ãmä»¥ä¸ã§æå¤§ã®ãã®ãæ¢ã\n  //lb,sumã¨aã®è¦ç´ ã®åã§mä»¥ä¸æå°ã®ãã®ãæ¢ã\n  ll ub=bs(m,sum,all,true),lb=bs(m,sum,all,false);\n  ans = min(ans,ub);\n  ans = min(ans,lb);\n  if (now == n)return;\n  //ä½¿ã\n  search(n,now+1,sum+a[now],m,a,all);\n  //ä½¿ããªã\n  search(n,now+1,sum,m,a,all);\n}\n\n/*\n  ååå¨åæãã ãã¡ã¢ãªç¯ç´ãããã®ã§å¾ãååã¯æ¢ç´¢ããã\n */\nll solve2(vector<ll> in,ll m){\n  vector<ll> mae,usiro;\n  rep(i,in.size()){\n    if (i < in.size()/2)mae.push_back(in[i]);\n    else usiro.push_back(in[i]);\n  }\n  vector<ll> all=generate(mae);\n  ans = m;\n  search(usiro.size(),0,0,m,usiro,all);\n  return ans;\n}\n\nll solve(ll n,ll m,ll a,ll b,ll p,ll q){\n  if (a == 1 && b == 1){//ç¹æ®ã±ã¼ã¹\n    ll sum = p+q;\n    ll lb = min(n,m/sum),ub=min(n,(m+sum-1)/sum);\n    ll ret = m;\n    ret = min(ret,llabs(m-lb*(sum)));\n    ret = min(ret,llabs(m-ub*(sum)));\n    return ret;\n  }\n\n  //ãã±ããã®çæ\n  //ä¸å¿doubleåã§å¤ã¯åãæ±ã£ã¦ããã\n  //å¿è¦ãªãã±ããã¯æå¤§ï¼ï¼æã§ãããä»¥ä¸ã¯æå³ããªãã\n  int loop = 0;\n  ll cur = p + q;\n  ll mula=1,mulb=1;\n  double m_d=m;\n  double cur_d = p + q;\n  double mula_d = 1, mulb_d = 1;\n  vector<ll> all;\n  all.push_back(cur);\n  while(loop < n){\n    mula_d *= a;\n    mulb_d *= b;\n    cur_d   = p*mula_d + q*mulb_d;\n    if (cur_d > 2*m)break;\n    mula *= a;\n    mulb *= b;\n    cur = p*mula + q*mulb;\n    all.push_back(cur);\n\n  }\n\n  //rep(i,all.size())assert(all[i] > 0);\n  //rep(i,all.size())cout << all[i] <<\" \" ;cout << endl;\n\n  if (all.size() == 1){//ä¸ã¤ããä½¿ãããã±ããããªããªããããç­ãã«ããã(å¿ãï¼æã¯ãããã¨ãä¿è¨¼ããã¦ãã)\n    return min(m,llabs(all[0]-m));\n  }\n  return solve2(all,m);\n}\n\nmain(){\n  ll n,m,a,b,p,q;\n  while(cin>>n>>m>>a>>b>>p>>q && n){\n    cout << solve(n,m,a,b,p,q)  << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\nusing namespace std;\n\nlong long vals[50];\nlong long N;\nlong long M;\n\nlong long dfs(int id,int toTake,int taken,long long curVal,bool flg){\n//\tprintf(\"%d %d %d %lld\\n\",id,toTake,taken,curVal);\n\tif(id==-1){\n\t\tif(taken==toTake) return curVal;\n\t\telse return -1;\n\t}\n\tif(toTake==taken){\n\t\treturn curVal;\n\t}\n\tlong long nxtVal=curVal+vals[id];\n//\tprintf(\"nxt=%lld\\n\",nxtVal);\n\tlong long res=-1;\n\tif(nxtVal>M){\n\t\tres=dfs(id-1,toTake,taken,curVal,flg);\n\t\treturn res;\n\t}\n\tif(flg==false){\n\t\t//not take\n\t\tres=dfs(id-1,toTake,taken,curVal,true);\n\t}\n\tlong long res2=dfs(id-1,toTake,taken+1,nxtVal,flg);\n\tres=max(res,res2);\n\treturn res;\n}\n\nlong long dfs2(int id,int toTake,int taken,long long curVal){\n\tif(id==-1){\n\t\tif(toTake!=taken) return -1;\n\t\treturn curVal;\n\t}\n\tlong long nxtVal=curVal+vals[id];\n\tif(toTake==taken+id+1){\n\t\tlong long tmp=dfs2(id-1,toTake,taken+1,nxtVal);\n\t\treturn tmp;\n\t}\n\tlong long notTake=curVal;\n\tfor(int i=1;i<=toTake-taken;i++){\n\t\tnotTake+=vals[id-i];\n\t}\n\tlong long res;\n\tif(notTake>=M){\n\t\tres=dfs2(id-1,toTake,taken,curVal);\n\t}else{\n\t\tres=dfs2(id-1,toTake,taken+1,nxtVal);\n\t}\n\treturn res;\n}\n\nlong long mult(long long a,long long b,long long c){\n\tlong long x=c/a;\n\tif(b>x) return -1;\n\tlong long res=a*b;\n\tif(res>c) return -1;\n\treturn res;\n}\n\nint main(){\n\tlong long a,b,p,q;\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&N,&M,&a,&b,&p,&q);\n\tif(a==1&&b==1){\n\t\tlong long x=p+q;\n\t\tlong long num=M/x;\n\t\tnum=min(num,N);\n\t\tlong long train=x*num;\n\t\tlong long ans=M-train;\n\t\tif(num+1<=N){\n\t\t\ttrain+=x;\n\t\t\tans=min(ans,train-M);\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t\treturn 0;\n\t}\n\tlong long pa=1,pb=1;\n\tint n=0;\n\tfor(int i=0;i<N;i++){\n\t\tlong long cur1=mult(pa,p,M*2);\n\t\tlong long cur2=mult(pb,q,M*2);\n\t\tif(cur1==-1||cur2==-1) break;\n\t\tlong long cur=cur1+cur2;\n\t\tif(cur>M*2) break;\n\t\tvals[n++]=cur;\n\t\tpa=mult(pa,a,M*2);\n\t\tpb=mult(pb,b,M*2);\n\t\tif(pa==-1||pb==-1) break;\n\t}\n\tif(n==0){\n\t\tprintf(\"%lld\\n\",M);\n\t\treturn 0;\n\t}\n//\tfor(int i=0;i<n;i++){\n//\t\tprintf(\"%d %lld\\n\",i,vals[i]);\n//\t}\n\tN=n;\n\tlong long ans=M;\n\tfor(int i=1;i<=n;i++){\n\t\tlong long tmp=dfs(n-1,i,0,0,false);\n//\t\tprintf(\"%d %lld\\n\",i,tmp);\n\t\tif(tmp==-1) continue;\n\t\tans=min(ans,M-tmp);\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tlong long tmp=dfs2(n-1,i,0,0);\n\t\tif(tmp==-1) continue;\n\t\tans=min(ans,tmp-M);\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <queue>\n#include <cmath>\n#include <algorithm>\n#include <functional>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<(n);++i)\n#define rep1(i,n) for(int i=1;i<=(n);++i)\n#define all(c) (c).begin(),(c).end()\n#define pb push_back\n#define fs first\n#define sc second\n#define show(x) cout << #x << \" = \" << x << endl\ntypedef long long ll;\nll inf=1e17;\nint main(){\n\tll n,m,a,b,p,q;\n\tcin>>n>>m>>a>>b>>p>>q;\n\tif(a>b) swap(n,m),swap(a,b),swap(p,q);\n\tll ans=m;\n\tif(b==1){\n\t\tll k=p+q;\n\t\tll d=min(n,m/k);\n\t\tans=m-k*d;\n\t\tif(d!=n) ans=min(ans,(d+1)*k-m);\n\t}else if(a==1){\n\t\tll bq[45]={},sum[46]={};\n\t\tbq[0]=q;\n\t\tsum[1]=q;\n\t\tll id=0;\n\t\tfor(;id<n-1;id++){\n\t\t\tif(bq[id]>inf/b) break;\n\t\t\tbq[id+1]=bq[id]*b;\n\t\t\tsum[id+2]=sum[id+1]+bq[id+1];\n\t\t}\n/*\t\tshow(id);\n\t\trep(i,id+1){\n\t\t\tshow(bq[i]);\n\t\t\tshow(sum[i]);\n\t\t}*/\n\t\t//can use 0~id\n\t\tll id_c=id;\n\t\tfor(ll k=1;k<=min(n,id_c+1);k++){\n\t\t\tif(bq[k-1]==0) break;\n//\t\t\tshow(k);\n\t\t\tll left=m-p*k;\n\t\t\tll now=0;\n\t\t\tid=id_c;\n\t\t\tint use=0;\n\t\t\tfor(;id>=0;id--){\n\t\t\t\tif(now+bq[id]>left){\n\t\t\t\t\tif(k-use-1>=0&&k-use-1<=id) ans=min(ans,now+bq[id]+sum[k-use-1]-left);\n\t\t\t\t}else{\n\t\t\t\t\tnow+=bq[id];\n\t\t\t\t\tuse++;\n\t\t\t\t\tif(use==k){\n\t\t\t\t\t\tans=min(ans,left-now);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}else{\n\t\tll id=0;\n\t\tll l=p,r=q;\n\t\tll num[40]={};\n\t\tfor(;id<n;id++){\n\t\t\tnum[id]=l+r;\n\t\t\tif(l>inf/a) break;\n\t\t\tif(r>inf/b) break;\n\t\t\tl*=a;\n\t\t\tr*=b;\n\t\t}\n\t\tif(id==n) id--;\n\t\t//can use 0~id\n\t\tll now=0;\n\t\tfor(;id>=0;id--){\n\t\t\tif(now+num[id]>m){\n\t\t\t\tans=min(ans,now+num[id]-m);\n\t\t\t}else{\n\t\t\t\tans=min(ans,m-(now+num[id]));\n\t\t\t\tnow+=num[id];\n\t\t\t}\n\t\t}\n\t}\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "// g++ -std=c++11 a.cpp\n#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>   \n#include<map>\n#include<set>\n#include<unordered_map>\n#include<utility>\n#include<cmath>\n#include<random>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<bitset>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#include<typeinfo>\n#define loop(i,a,b) for(ll i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define FOR(i,a) for(auto i:a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n#define show1d(v) rep(i,v.size())cout<<\" \"<<v[i];cout<<endl<<endl;\n#define show2d(v) rep(i,v.size()){rep(j,v[i].size())cout<<\" \"<<v[i][j];cout<<endl;}cout<<endl;\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\n//#define int ll\ntypedef ll Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n#define mt make_tuple\ntypedef tuple<int,int,int,int> tp;\ntypedef vector<tp> vt;\ntemplate<typename A,typename B>bool cmin(A &a,const B &b){return a>b?(a=b,true):false;}\ntemplate<typename A,typename B>bool cmax(A &a,const B &b){return a<b?(a=b,true):false;}\n//template<class C>constexpr int size(const C &c){return (int)c.size();}\n//template<class T,size_t N> constexpr int size(const T (&xs)[N])noexcept{return (int)N;}\nconst double PI=acos(-1);\nconst double EPS=1e-9;\nDef inf = sizeof(Def) == sizeof(long long) ? 2e18 : 1e9+10;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\nint main(){\n\tll n,m,a,b,p,q;\n\tcin>>n>>m>>a>>b>>p>>q;\n\tif(a+b==2){\n\t\tll t=p+q;\n\t\tll T=min(n,m/t);\n\t\tll out=m;\n\t\tloop(i,max(0ll,T-10),min(n+1,T+10))\n\t\t\tout=min(out,abs(t*i-m));\n\t\tcout<<out<<endl;\n\t\treturn 0;\n\t}\n\tvi A,B;\n\tll t=p;\n\tint co=0;\n\twhile(1){\n\t\tA.pb(t);\n\t\tif(to_string(t).size()+to_string(a).size()>16)break;\n\t\tt*=a;\n\t\tif(a==1&&co==40)break;\n\t\tco++;\n\t}\n\tt=q;\n\tco=0;\n\twhile(1){\n\t\tB.pb(t);\n\t\tif(to_string(t).size()+to_string(b).size()>16)break;\n\t\tt*=b;\n\t\tif(b==1&&co==40)break;\n\t\tco++;\n\t}\n\t//show1d(A);\n\t//show1d(B);\n\tvi in;\n\trep(i,min((ll)A.size(),n))\n\t\tif(i<B.size()&&A[i]+B[i]<=3*m)in.pb(A[i]+B[i]);\n\tn=in.size()/2;\n\tll N=1<<n;\n\tvi dp;\n\trep(i,N){\n\t\tll sum=0;\n\t\trep(j,n)if(i&1<<j)sum+=in[j];\n\t\tif(sum<=3*m)dp.pb(sum);\n\t}\n\tsort(all(dp));\n\tll nn=in.size()-n;\n\tN=1<<nn;\n\tll out=m;\n//\tshow1d(in);\n\trep(i,N){\n\t\tll sum=0;\n\t\trep(j,nn)if(i&1<<j)sum+=in[n+j];\n\t\tif(sum>3*m)continue;\n\t\tauto it=upper_bound(all(dp),m-sum);\n\t\tif(it!=dp.end())out=min(out,abs(*it+sum-m));\n\t\tif(it==dp.begin())continue;\n\t\tit--;\n\t\tout=min(out,abs(*it+sum-m));\n\t}\n//\tshow1d(dp);\n\tcout<<out<<endl;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <queue>\n#include <map>\n#include <set>\n#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <cassert>\nusing namespace std;\n\ntypedef long long ll;\n\n#define REP(i, n) for (ll i = 0; i < (ll)(n); ++i)\n#define FOR(i, a, b) for (ll i = (a); i < (ll)(b); ++i)\n#define FOREQ(i, a, b) for (ll i = (a); i <= (ll)(b); ++i)\n#define DEC(i, k) for (ll i = (k); i >= 0; --i)\n#define FORIT(i, c) for (__tyoeof((c).begin()) i = (c).begin(); i != (c).end(); ++i)\n#define SZ(v) (ll)((v).size())\n#define MEMSET(v, h) memset((v), (h), sizeof(v))\n#define FIND(m, w) ((m).find(w) != (m).end())\n#define ALL(c) (c).begin(), (c).end()\n\nll ticket[1000];\nll ticketSum[1000];\nll n, m, a, b, p, q;\nll cnt;\n\nll calc(ll depth, ll lm) {\n  if (depth == cnt || lm <= 0) { return abs(lm); }\n  if (ticketSum[depth] < lm) { return abs(lm - ticketSum[depth]); }\n  ll ret = m;\n  ret = min(ret, calc(depth + 1, lm));\n  ret = min(ret, calc(depth + 1, lm - ticket[depth]));\n  return ret;\n}\n\nint main() {\n  cin >> n >> m >> a >> b >> p >> q;\n  if (a == 1 && b == 1) {\n    ll use = m / (p + q);\n    use = min(use, n - 1);\n    printf(\"%lld\\n\", min(m - use * (p + q), abs(m - (use + 1) * (p + q))));\n    return 0;\n  }\n  cnt = 0;\n  {\n    ll left = p;\n    ll right = q;\n    REP(i, n) {\n      if (left + right > 2 * m) { break; }\n      ticket[cnt++] = left + right;\n      ll pleft = left;\n      ll pright = right;\n      left *= a;\n      right *= b;\n      if (left / a != pleft || right / b != pright) { break; }\n    }\n  }\n  reverse(ticket, ticket + cnt);\n  MEMSET(ticketSum, 0);\n  for (ll i = cnt; i > 0; i--) {\n    ticketSum[i - 1] = ticket[i - 1] + ticketSum[i];\n  }\n  ll ans = calc(0, m);\n  printf(\"%lld\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  ll MAX=1000000000000LL;\n  \n  assert( 1<= n &&n <= MAX );\n  assert( 1<= m &&m <= MAX );\n  assert( 1<= a &&a <= MAX );\n  assert( 1<= b &&b <= MAX );\n  assert( 1<= p &&p <= MAX );\n  assert( 1<= q &&q <= MAX );\n\n\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return min(m%d,d-m%d);\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n    if( i==40 )break;\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        ll c=T[i]+U[j];\n        res=min( res,  abs(m-c) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return min( m%d , m-m%d);\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n  if(n>40)n=40;\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        res=min( res, abs( m- ( T[i]+U[j] )) );      \n      }\n    }\n  }\n  \n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll _pow(ll a, ll n) {\n\tif(n == 0) return 1;\n\telse {\n\t\tll res = 1;\n\t\tll buf = a;\n\t\twhile(n > 0) {\n\t\t\tif(n % 2 == 1) {\n\t\t\t\tres *= buf;\n\t\t\t}\n\t\t\tbuf *= buf;\n\t\t\tn /= 2;\n\t\t}\n\t\treturn res;\n\t}\n}\n\nvoid solve() {\n\tll tmp1, tmp2, tmp3, tmp4, tmp5, tmp6;\n\tcin >> tmp1 >> tmp2 >> tmp3 >> tmp4 >> tmp5 >> tmp6;\n\t__int128 n, m, a, b, p, q;\n\tn = tmp1;\n\tm = tmp2;\n\ta = tmp3;\n\tb = tmp4;\n\tp = tmp5;\n\tq = tmp6;\n\t__int128 ans = m;\n\tif(n == 1) {\n\t\tans = min(m, (__int128)abs((ll)((p + q) - m)));\n\t\tcout << (ll)ans << endl;\n\t\treturn;\n\t}\n\t__int128 c = max(a, b);\n\tif(c == 1) {\n\t\tif((p + q) * n > m) {\n\t\t\tans = min(m - m / (p + q) * (p + q), (m / (p + q) + 1) * (p + q) - m);\n\t\t} else ans = m - (p + q) * n;\n\t} else if(c == 2 || c == 3) {\n\t\t__int128 _n = 0;\n\t\tif(c == 2) _n = min((__int128)41, n);\n\t\tif(c == 3) _n = min((__int128)29, n);\n\t\tll div1 = _n / 2;\n\t\tll div2 = _n - div1;\n\t\tvector<__int128> d1;\n\t\tvector<__int128> d2;\n\t\tREP(bit, (1ll << div1)) {\n\t\t\tbitset<31> bi(bit);\n\t\t\t__int128 sum = 0;\n\t\t\tREP(i, div1) if(bi[i]) sum += p * _pow(a, i) + q * _pow(b, i);\n\t\t\td1.pb(sum);\n\t\t}\n\t\tREP(bit, (1ll << div2)) {\n\t\t\tbitset<31> bi(bit);\n\t\t\t__int128 sum = 0;\n\t\t\tREP(i, div2) if(bi[i]) sum += p * _pow(a, div1 + i) + q * _pow(b, div1 + i);\n\t\t\td2.pb(sum);\n\t\t}\n\t\tsort(ALL(d1));\n\t\tsort(ALL(d2));\n\t\tREP(i, d1.size()) {\n\t\t\tauto ite = upper_bound(ALL(d2), m - d1[i]);\n\t\t\tif(ite != d2.end()) ans = min(ans, (d1[i] + *ite) - m);\n\t\t\tif(ite == d2.begin()) continue;\n\t\t\tite--;\n\t\t\tans = min(ans, m - (d1[i] + *ite));\n\t\t}\n\t} else /* c >= 4 */ {\n\t\tvector<__int128> num;\n\t\tnum.pb(0);\n\t\tnum.pb(p + q);\n\t\tREP(i, min((__int128)23, n - 1)) {\n\t\t\tif((__int128)1000000000007 / (ld)_pow(c, i) < c) break;\n\t\t\tll val = p * _pow(a, i + 1) + q * _pow(b, i + 1); \n\t\t\tvector<__int128> nnum = num;\n\t\t\tREP(j, num.size()) nnum.pb(num[j] + val);\n\t\t\tnum = nnum;\n\t\t}\n\t\tUNIQUE(num);\n\t\tREP(i, num.size()) ans = min(ans, (__int128)abs((ll)(m - num[i])));\n\t}\n\tcout << (ll)ans << endl;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tsolve();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dist[40];\nint main(){\n\tlong long a,b,c,d,e,f;\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&a,&b,&c,&d,&e,&f);\n\tif(c==1&&d==1){\n\t\tlong long v=b%(e+f);\n\t\tlong long g=b/(e+f);\n\t\tlong long ret=v+max(0LL,g-a)*(e+f);\n\t\tg++;\n\t\tv=e+f-v;\n\t\tret=min(ret,v+max(0LL,g-a)*(e+f));\n\t\tprintf(\"%lld\\n\",ret);\n\t\t\n\t\treturn 0;\n\t}\n\tint sz=0;\n\tfor(int i=0;i<=a;i++){\n\t\tlong long L=e;\n\t\tlong long R=f;\n\t\tlong long Q=b;\n\t\tfor(int j=0;j<i;j++)Q/=max(c,d);\n\t\tif(Q==0)break;\n\t\tfor(int j=0;j<i;j++)L*=c;\n\t\tfor(int j=0;j<i;j++)R*=d;\n\t\tlong long t=L+R;\n\t\tif(t>b*2)break;\n\t\tdist[sz++]=t;\n\t\t//printf(\"%lld \",dist[sz-1]);\n\t}\n\tif(d==1){\n\t\tswap(c,d);\n\t\tswap(e,f);\n\t}\n\tif(c==1){\n\t\tlong long ret=b;\n\t\tfor(int i=0;i<sz;i++)dist[i]-=e;\n\t\tfor(int i=1;i<=sz;i++){\n\t\t\tlong long tmp=b-(long long)i*e;\n\t\t\tif(tmp<0)break;\n\t\t\tint rem=i;\n\t\t\tfor(int j=sz-1;j>=0;j--){\n\t\t\t\tif(tmp>=dist[j]){\n\t\t\t\t\trem--;\n\t\t\t\t\ttmp-=dist[j];\n\t\t\t\t}else{\n\t\t\t\t\tlong long cost=dist[j]-tmp;\n\t\t\t\t\tif(rem-1<=j){\n\t\t\t\t\t\tfor(int k=0;k<rem-1;k++){\n\t\t\t\t\t\t\tcost+=dist[k];\n\t\t\t\t\t\t}\n\t\t\t\t//\t\tprintf(\"%d %d: %lld\\n\",i,j,cost);\n\t\t\t\t\t\tret=min(ret,cost);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(rem==0)break;\n\t\t\t}\n\t\t\t\n\t\t\tif(rem==0)ret=min(ret,tmp);\n\t\t\t//printf(\"%d: %lld\\n\",i,ret);\n\t\t}\n\t\tprintf(\"%lld\\n\",ret);\n\t\treturn 0;\n\t}\n\tlong long ret=b;\n\tlong long tmp=b;\n\tfor(int i=sz-1;i>=0;i--){\n\t\tif(tmp>=dist[i])tmp-=dist[i];\n\t\telse ret=min(ret,dist[i]-tmp);\n\t\tret=min(ret,tmp);\n\t}\n\tprintf(\"%lld\\n\",ret);\n}\n//11 12 14 18"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nbool ch(int a,int b){\n  int x=1000000000000000LL;\n  x/=a;\n  x/=b;\n  return x==0;\n}\nsigned main(){\n  int n,m,a,b,p,q;\n  cin>>n>>m>>a>>b>>p>>q;\n  if(a==1&&b==1){\n    //cout<<m%(p+q)<<endl;\n    if(ch(n,p+q)) cout<<min(m%(p+q),(p+q)-m%(p+q))<<endl;\n    else{\n      int t=n*(p+q);\n      if(m>=t) cout<<m-t<<endl;\n      else cout<<min(m%(p+q),(p+q)-m%(p+q))<<endl;\n    }\n    return 0;\n  }\n  int ans=m;\n  int ta=1,tb=1;\n  vector<int> v;\n  for(int i=0;i<n;i++){\n    if(ch(p,ta)) break;\n    if(ch(q,tb)) break;\n    int t=p*ta+q*tb;\n    //cout<<t<<endl;\n    if(t<=m) v.push_back(t);\n    else{\n      ans=min(ans,t-m);\n      break;\n    }\n    if(ch(ta,a)) break;\n    if(ch(tb,b)) break;\n    ta*=a;tb*=b;\n  }\n  int x=v.size();\n  int y=x/2;\n  set<int> s;\n  for(int i=0;i<(1<<y);i++){\n    int t=0;\n    for(int j=0;j<y;j++) if((i>>j)&1) t+=v[j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }    \n    //cout<<t<<endl;\n    s.insert(-t);\n    ans=min(ans,m-t);\n  }\n  \n  for(int i=0;i<(1<<(x-y));i++){\n    int t=0;\n    for(int j=0;j<(x-y);j++) if((i>>j)&1) t+=v[y+j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }\n    //cout<<t<<endl;\n    ans=min(ans,m-t);\n    int u=t-m;\n    int k=*s.lower_bound(u);\n    ans=min(ans,m-(t-k));\n  }\n  \n  s.clear();\n  for(int i=0;i<(1<<y);i++){\n    int t=0;\n    for(int j=0;j<y;j++) if((i>>j)&1) t+=v[j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }    \n    //cout<<t<<endl;\n    s.insert(t);\n    ans=min(ans,m-t);\n  }\n  \n  int inf=m*2;\n  s.insert(inf);\n  for(int i=0;i<(1<<(x-y));i++){\n    int t=0;\n    for(int j=0;j<(x-y);j++) if((i>>j)&1) t+=v[y+j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }\n    //cout<<t<<endl;\n    ans=min(ans,m-t);\n    int v=m-t;\n    int l=*s.lower_bound(v);\n    if(l!=inf) ans=min(ans,(t+l)-m);\n  }\n  //assert(ans>=0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nlong long int pow(long long int a, int x){\n  int ret = 1, t = x;\n  while(x > 0){\n    if(x&1) ret *= t;\n    t *= t;\n  }\n  return ret;\n}\n\nint main(){\n  long long int n, m, a, b, p, q, ans;\n  cin >> n >> m >> a >> b >> p >> q;\n  if(a < b){\n    swap(a, b);\n    swap(p, q);\n  }\n  if(a == 1){\n    if(n < m/2) cout << m - n*2 << endl;\n    else cout << m%2 << endl;\n    return 0;\n  }\n  ans = m;\n  long long int x = 1, y = 1;\n  while(p*x + q*y < m) x *= a, y *= b;\n  ans = min(ans, p*x + q*y);\n  while(x > 0){\n    x /= a;\n    y /= b;\n    ans = min(ans, abs(m - (p*x + q*y)));\n    if(m > p*x + q*y) m -= p*x + q*y;\n  }\n  cout << ans << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<climits>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\ntypedef long long ll;\n\nvector<ll> generate(vector<ll> a){\n  vector<ll> ret;\n  int n = a.size();\n  rep(i,(1<<n)){\n    ll tmp = 0;\n    rep(j,n){\n      if ((1<<j)&i)tmp += a[j];\n    }\n    ret.push_back(tmp);\n  }\n  sort(ret.begin(),ret.end());\n  return ret;\n}\n\nll bs(ll m,ll sum,vector<ll> &a,bool fg){\n  int ret = -1;\n  int l = 0,r = a.size()-1;\n  while(l <= r){\n    int mid = (l+r)/2;\n    ll tmp = sum + a[mid];\n    if (fg){\n      if (tmp <= m){//ºÀðàÁÆã°éB\n\tret = mid;\n\tl = mid+1;\n      }else {\n\tr = mid-1;\n      }\n    }else {\n      if (tmp >= m){\n\tret = mid;\n\tr = mid-1;\n      }else {\n\tl = mid+1;\t\n      }\n    }\n  }\n  /*\n  cout <<\"dbg\" << endl;\n  rep(i,a.size())cout << a[i] <<\" \" ;cout << endl;\n  cout <<fg <<\" \" <<  m <<\" \" << sum <<\" \" << (ret != -1?a[ret]:-1) <<\" \" << \n    ((ret != -1)?sum+a[ret]:-1)\n       << endl;\n  */\n  if (ret == -1)return llabs(m-sum);\n  return llabs(m-(sum+a[ret]));\n}\n\nll ans;\nvoid search(int n,int now,ll sum,int m,vector<ll> &a,vector<ll> &all){\n  //ub,sumÆaÌvfÅAmÈºÅÅåÌàÌðT·\n  //lb,sumÆaÌvfÌaÅmÈãÅ¬ÌàÌðT·\n  ll ub=bs(m,sum,all,true),lb=bs(m,sum,all,false);\n  if (ub != -1)ans = min(ans,ub);\n  if (lb != -1)ans = min(ans,lb);\n  if (now == n)return;\n  //g¤\n  search(n,now+1,sum+a[now],m,a,all);\n  //gíÈ¢\n  search(n,now+1,sum,m,a,all);\n}\n\n/*\n  ¼ªSñ½¾µßñµ½¢ÌÅãë¼ªÍTõ·éB\n */\nll solve2(vector<ll> in,ll m){\n  vector<ll> mae,usiro;\n  rep(i,in.size()){\n    if (i < in.size()/2)mae.push_back(in[i]);\n    else usiro.push_back(in[i]);\n  }\n  vector<ll> all=generate(mae);\n  ans = m;\n  search(usiro.size(),0,0,m,usiro,all);\n  return ans;\n}\n\nll solve(ll n,ll m,ll a,ll b,ll p,ll q){\n  if (a == 1 && b == 1){//ÁêP[X\n    ll sum = a+b;\n    ll lb = min(m/sum,n),ub=min(n,(m+sum-1)/sum);\n    ll ret = m;\n    if (lb <= n){\n      ret = min(ret,llabs(m-lb*(a+b)));\n    }\n    if (ub <= n){\n      ret = min(ret,llabs(m-ub*(a+b)));\n    }\n    return ret;\n  }\n\n  //`PbgÌ¶¬\n  //êdouble^ÅlÍæèµÁÄ¨­B\n  //KvÈ`PbgÍÅåSOÅA»êÈãÍÓ¡ªÈ¢B\n  int loop = 0;\n  ll cur = p + q;\n  ll mula=1,mulb=1;\n  double m_d=m;\n  double cur_d = p+q;\n  double mula_d = 1, mulb_d = 1;\n  vector<ll> all;\n  all.push_back(cur);\n  while(cur_d <= m_d && loop < m){\n    mula *= a;\n    mulb *= b;\n    cur = p*mula + q*mulb;\n    all.push_back(cur);\n\n    mula_d *= a;\n    mulb_d *= b;\n    cur_d = p*mula_d + q*mulb_d;\n  }\n  //rep(i,all.size())cout << all[i] <<\" \" ;cout << endl;\n\n  if (all.size() == 1){//êÂµ©g¦é`PbgªÈ¢Èç»êð¦É·éB(K¸PÍ é±ÆªÛØ³êÄ¢é)\n    return min(m,llabs(all[0]-m));\n  }\n  return solve2(all,m);\n}\n\nmain(){\n  ll n,m,a,b,p,q;\n  while(cin>>n>>m>>a>>b>>p>>q && n){\n    cout << solve(n,m,a,b,p,q)  << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint main(){\n  long long int n, m, a, b, p, q, ans;\n  cin >> n >> m >> a >> b >> p >> q;\n  if(a < b){\n    swap(a, b);\n    swap(p, q);\n  }\n  if(a == 1){\n    cout << m - min(n, m/2)*2 << endl;\n    return 0;\n  }\n  ans = m;\n  long long int x = 1, y = 1;\n  while(p*x + q*y < m) x *= a, y *= b;\n  ans = min(ans, p*x + q*y);\n  while(x > 0){\n    x /= a;\n    y /= b;\n    ans = min(ans, abs(m - (p*x + q*y)));\n    if(m > p*x + q*y) m -= p*x + q*y;\n  }\n  cout << ans << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\n#define LINF 1LL<<60\n\n/*\n<url:http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=2239>\n?????????============================================================\n????????????????????????????????±?????????n ????????£?????????. ?????±????????????????????????0 ??????n ??? 1 ?????§???????????????????????????, \nk ???????????±?????????????????¨, p???a^k + q???b^k ?§????????????¨?????§??????.\n\n??????????????????????§???????m ?§???????????§???????????????????????£??????????????????????????????????,???????????????????????¢??????????????????.\n?§????????????????????????§??????.\n?????±?????????????????????????????§???????????¨???????????¨????????¨???, ????????????????°?????§???????????????§??????????????????.\n\n1 ??? n, m, a, b, p, q ??? 10^12 (??´??°)\n=================================================================\n?§£??¬=============================================================\n================================================================\n*/\n\nconst ll MOD = (ll)1e16;\nll powmod(ll a, ll b) { ll res = 1;a %= MOD; assert(b >= 0); for (;b;b >>= 1) { if (b & 1)res = res*a%MOD;a = a*a%MOD; }return res; }\nint main(void) {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\tll n, m, a, b, p, q; cin >> n >> m >> a >> b >> p >> q;\n\tll res = LINF;\n\tif (a == 1 && b == 1) {\n\t\tll k = m / (p + q);\n\t\tres = min({ m,abs(m - min(k,n)*(p + q)),abs(min((k + 1),n)*(p + q) - m )});\n\t}else {\n\t\tll N = min(40LL, n);\n\t\tvector<ll> L;\n\t\tfor (int i = 0; i < (1 << (N / 2));i++) {\n\t\t\tll T = 0;\n\t\t\tfor (int j = 0; j < N / 2;j++) {\n\t\t\t\tif ((i >> j) & 1) {\n\t\t\t\t\tT += p*powmod(a, j) + q*powmod(b, j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tL.push_back(T);\n\t\t}\n\t\tL.push_back(LINF);\n\t\tsort(L.begin(), L.end());\n\t\tfor (int i = 0; i < (1 << (N - N / 2));i++) {\n\t\t\tll T = 0;\n\t\t\tfor (int j = 0; j < (N - N / 2);j++) {\n\t\t\t\tif ((i >> j) & 1) {\n\t\t\t\t\tT += p*powmod(a, N / 2 + j) + q*powmod(b, N / 2 + j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tauto it = lower_bound(L.begin(), L.end(), m - T);\n\t\t\tres = min(res, abs(m - T - *it));\n\t\t\tif (it != L.begin()) res = min(res, abs(m - T - *(it - 1)));\n\t\t}\n\t}\n\tcout << res << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\n#include<bitset>\n#include<stack>\n#include<unordered_map>\n#include<utility>\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ul;\ntypedef unsigned int ui;\nconst ll mod = 1000000007;\ntypedef long double ld;\nconst ll INF = mod*mod;\ntypedef pair<int, int> P;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\nconst ld eps = 1e-8;\nconst ld pi = acos(-1.0);\ntypedef pair<ld, ld> LDP;\ntypedef pair<ll, ll> LP;\n#define fr first\n#define sc second\n\n//t個が1,x以下とx以上を求める\nLP calc(ll x, int t,int sup=40) {\n\tvector<int> v;\n\trep(i, sup) {\n\t\tll k = (ll)1 << i;\n\t\tif (x&k)v.push_back(i);\n\t}\n\tint len = v.size();\n\tll le = 0;\n\tif (t <= len) {\n\t\tfor (int i = len - 1; i >= len - t; i--) {\n\t\t\tle += (ll)1 << v[i];\n\t\t}\n\t}\n\telse {\n\t\tbool f = false;\n\t\trep(i, len) {\n\t\t\tint cnt = v[i];\n\t\t\tcnt += len - 1 - i;\n\t\t\tif (cnt >= t) {\n\t\t\t\tfor (int j = len - 1; j > i; j--) {\n\t\t\t\t\tle += (ll)1<<v[j];\n\t\t\t\t}\n\t\t\t\tint r = t - (len - 1 - i);\n\t\t\t\trep(j, r) {\n\t\t\t\t\tle += (ll)1 << j;\n\t\t\t\t}\n\t\t\t\tf = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (!f)le = -INF;\n\t}\n\tll ri = 0;\n\tif (t <= len) {\n\t\tint tmp = len;\n\t\trep(i, sup) {\n\t\t\tll k = (ll)1 << i;\n\t\t\tif (k&x) {\n\t\t\t\ttmp--; continue;\n\t\t\t}\n\t\t\tint cnt = i;\n\t\t\tcnt += tmp;\n\t\t\tcnt++;\n\t\t\tif (tmp + 1 <= t && cnt >= t) {\n\t\t\t\tri += k;\n\t\t\t\tRep(j, len-tmp, len) {\n\t\t\t\t\tri += (ll)1 << v[j];\n\t\t\t\t}\n\t\t\t\tint r = t - (tmp + 1);\n\t\t\t\trep(j, r) {\n\t\t\t\t\tri += (ll)1 << j;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\trep(i, len) {\n\t\t\tri += (ll)1 << v[i];\n\t\t}\n\t\tint r = t - len;\n\t\trep(j, sup) {\n\t\t\tif (r == 0)break;\n\t\t\tll k = (ll)1 << j;\n\t\t\tif ((x&k) == 0) {\n\t\t\t\tri += k; r--;\n\t\t\t}\n\t\t}\n\t}\n\treturn { le,ri };\n}\nstring add(string a, string b) {\n\treverse(a.begin(), a.end());\n\treverse(b.begin(), b.end());\n\tint len = max(a.length(), b.length());\n\tint rest = 0; string res;\n\trep(i, len + 1) {\n\t\tif (i < (int)a.length()) {\n\t\t\trest += a[i] - '0';\n\t\t}\n\t\tif (i < (int)b.length()) {\n\t\t\trest += b[i] - '0';\n\t\t}\n\t\tres.push_back('0' + (rest % 10));\n\t\trest /= 10;\n\t}\n\twhile (res.length() && res[res.length() - 1] == '0')res.erase(res.end() - 1);\n\treverse(res.begin(), res.end());\n\treturn res;\n}\nstring multi0(int m, string a) {\n\tstring res;\n\treverse(a.begin(), a.end());\n\tint len = a.length();\n\tint rest = 0;\n\trep(i, len) {\n\t\trest += m * (a[i] - '0');\n\t\tres.push_back('0' + (rest % 10));\n\t\trest /= 10;\n\t}\n\tif (rest)res.push_back('0' + rest);\n\treverse(res.begin(), res.end());\n\treturn res;\n}\nstring multi(string a, string b) {\n\tint len = a.length(); string res = \"0\";\n\tper(i, len) {\n\t\tint t = a[i] - '0'; int rest = len - i - 1;\n\t\tstring nex = multi0(t, b);\n\t\trep(j, rest) {\n\t\t\tnex.push_back('0');\n\t\t}\n\t\tres = add(res, nex);\n\t}\n\treturn res;\n}\nbool invalid(ll a,ll p) {\n\tstring s = to_string(a); string t = to_string(p);\n\tstring st = multi(s, t);\n\tif (st.size() >= 15)return true;\n\telse return false;\n}\nvoid solve() {\n\tll n, m, a, b, p, q; cin >> n >> m >> a >> b >> p >> q;\n\tif (a > b) {\n\t\tswap(a, b); swap(p, q);\n\t}\n\tll ans = INF;\n\tif (invalid(a, p) || invalid(b, q)) {\n\t\tans = m;\n\t\tans = min(ans, abs(m - p - q));\n\t}\n\telse if (invalid(a,a)||invalid(b,b)) {\n\t\t//cout << \"hello\" << endl;\n\t\tans = min(ans, m);\n\t\tans = min(ans, abs(m - p - q));\n\t\tif (n > 1) {\n\t\t\tans = min(ans, abs(m - p * a - q * b));\n\t\t\tans = min(ans, abs(m - p * a - q * b - p - q));\n\t\t}\n\t}\n\telse if (a == 1 && b == 1) {\n\t\tll le = m / (p + q);\n\t\tif (n < le) {\n\t\t\tll sum = (p + q)*n;\n\t\t\tans = min(ans, m - sum);\n\t\t}\n\t\telse {\n\t\t\tans = min(ans, m - (p + q)*le);\n\t\t}\n\t\tif (n >= le + 1) {\n\t\t\tans = min(ans, (p + q)*(le + 1) - m);\n\t\t}\n\t}\n\telse if (a == 1 && b == 2) {\n\t\tll x = a, y = b;\n\t\trep(i, n) {\n\t\t\tll sum = p * x + q * y;\n\t\t\tif (sum >= m) {\n\t\t\t\tans = min(ans, sum - m); break;\n\t\t\t}\n\t\t\tx = x * a; y = y * b;\n\t\t}\n\t\tll s = min(n, (ll)40);\n\t\t//i個使う\n\t\trep1(i, s) {\n\t\t\tll mm = m - i * p;\n\t\t\tll d = mm / q;\n\t\t\tLP z = calc(d, i, s);\n\t\t\tif (z.first != -INF) {\n\t\t\t\tans = min(ans, abs(mm - q * z.first));\n\t\t\t}\n\t\t\tans = min(ans, abs(mm - q * z.second));\n\t\t\t//ll lesum = q * z.first, risum = q * z.second;\n\t\t\t//cout << lesum + i * p << \" i \" << risum + i * p << endl;\n\t\t\t//ans = min(ans, abs(mm - lesum));\n\t\t\t//ans = min(ans, abs(risum - mm));\n\t\t}\n\t}\n\telse if (a == 2 && b == 2) {\n\t\tll d = m / (p + q);\n\t\tll s = min(n, (ll)40);\n\t\tll z = 0;\n\t\trep(i, s) {\n\t\t\tz += (ll)1 << i;\n\t\t}\n\t\tif (z < m)ans = min(ans, m - z * (p + q));\n\t\telse {\n\t\t\tll le = d;\n\t\t\tans = min(ans, m - le * (p + q));\n\t\t\tle++;\n\t\t\tll las = 0;\n\t\t\trep(i, 40) {\n\t\t\t\tll k = (ll)1 << i;\n\t\t\t\tif (k&le) {\n\t\t\t\t\tlas = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (las < n) {\n\t\t\t\tans = min(ans, m - le * (p + q));\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tll x = 1, y = 1;\n\t\tvector<ll> v;\n\t\trep(i, n) {\n\t\t\tll sum = p * x + q * y;\n\t\t\tif (sum >= m) {\n\t\t\t\tans = min(ans, sum - m);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tv.push_back(sum);\n\t\t\tx = x * a; y = y * b;\n\t\t}\n\t\tint len = v.size();\n\t\tll sum = 0;\n\t\tper(i, v.size()) {\n\t\t\tif (sum + v[i] <= m) {\n\t\t\t\tsum += v[i];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tans = min(ans, abs(m - sum-v[i]));\n\t\t\t}\n\t\t}\n\t\tans = min(ans, abs(m - sum));\n\t\t/*cout << len << endl;\n\t\trep(i, (1 << len)) {\n\t\t\tll u = 0;\n\t\t\trep(j, len) {\n\t\t\t\tif (i&(1 << j))u += v[j];\n\t\t\t}\n\t\t\tans = min(ans, abs(m - u));\n\t\t}*/\n\t}\n\tcout << ans << endl;\n}\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\tsolve();\n\t//stop\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define EPS 1e-10\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;--i)\n#define srep(i,s,t) for(int i=(int)(s);i<(int)(t);++i)\n#define each(a,b) for(auto (a): (b))\n#define all(v) (v).begin(),(v).end()\n#define len(v) (int)(v).size()\n#define zip(v) sort(all(v)),v.erase(unique(all(v)),v.end())\n#define cmx(x,y) x=max(x,y)\n#define cmn(x,y) x=min(x,y)\n#define fi first\n#define se second\n#define pb push_back\n#define show(x) cout<<#x<<\" = \"<<(x)<<endl\n#define spair(p) cout<<#p<<\": \"<<p.fi<<\" \"<<p.se<<endl\n#define svec(v) cout<<#v<<\":\";rep(kbrni,v.size())cout<<\" \"<<v[kbrni];cout<<endl\n#define sset(s) cout<<#s<<\":\";each(kbrni,s)cout<<\" \"<<kbrni;cout<<endl\n#define smap(m) cout<<#m<<\":\";each(kbrni,m)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n\nusing namespace std;\n\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<P> vp;\ntypedef vector<string> vs;\n\nconst int MAX_N = 100005;\n\nll lpa[40],lpb[40];\ndouble dpa[40],dpb[40];\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    ll n,m,a,b,p,q;\n    cin >> n >> m >> a >> b >> p >> q;\n    if(a == 1 && b == 1){\n        ll cnt = m/(p+q);\n        cout << min(m-min(n,cnt)*(p+q),abs(min(n,cnt+1)*(p+q)-m)) << \"\\n\";\n    }else{\n        ll cnt = min(n,40LL);\n        ll mid = cnt/2;\n        lpa[0] = lpb[0] = dpa[0] = dpb[0] = 1;\n        rep(i,cnt-1){\n            lpa[i+1] = lpa[i] * a;\n            lpb[i+1] = lpb[i] * b;\n            dpa[i+1] = dpa[i] * a;\n            dpb[i+1] = dpb[i] * b;\n        }\n        vl u,v;\n        rep(i,(1 << mid)){\n            ll val1 = 0;\n            double ch1 = 0;\n            rep(j,mid){\n                if((i >> j) & 1){\n                    val1 += p*lpa[j] + q*lpb[j];\n                    ch1 += p*dpa[j] + q*dpb[j];\n                }\n            }\n            if(ch1 <= 2*m){\n                u.pb(val1);\n            }\n        }\n        rep(i,(1 << (cnt-mid))){\n            ll val2 = 0;\n            double ch2 = 0;\n            rep(j,cnt-mid){\n                if((i >> j) & 1){\n                    val2 += p*lpa[mid+j] + q*lpb[mid+j];\n                    ch2 += p*dpa[mid+j] + q*dpb[mid+j];\n                }\n            }\n            if(ch2 <= 2*m){\n                v.pb(val2);\n            }\n        }\n        // svec(u);\n        // svec(v);\n        sort(all(v));\n        ll mn = (1LL << 60);\n        rep(i,len(u)){\n            int id = upper_bound(all(v),m-u[i]) - v.begin();\n            if(id > 0){\n                cmn(mn,m-(u[i]+v[id-1]));\n            }\n            if(id < len(v)){\n                cmn(mn,(u[i]+v[id])-m);\n            }\n        }\n        cout << mn << \"\\n\";\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb push_back\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\ntypedef vector<int>vint;\ntypedef pair<int,int>pint;\ntypedef vector<pint>vpint;\n\ntemplate<typename A,typename B>inline void chmin(A &a,B b){if(a>b)a=b;}\ntemplate<typename A,typename B>inline void chmax(A &a,B b){if(a<b)a=b;}\n\nint N,M,A,B,P,Q;\n\nint ans;\n\nvoid dfs(int n,int s,int x,int y){\n    if(n==0)return;\n    chmin(ans,abs(M-s));\n    if(1.0*x*A>1e18||1.0*y*B>1e18)return;\n    dfs(n-1,s+x*A+y*B,x*A,y*B);\n    dfs(n-1,s,x*A,y*B);\n}\n\nvoid dfs2(int n,int f,int s,int m){\n    if(n==0){\n        chmin(ans,abs(s-m));\n        return;\n    }\n    if(n-1>=f)dfs2(n-1,f,s,m);\n    if(f&&(s<=m||n==f)){\n        dfs2(n-1,f-1,s+Q*(1ll<<(n-1)),m);\n    }\n}\nsigned main(){\n    cin>>N>>M>>A>>B>>P>>Q;\n\n    if(A>B){\n        swap(A,B);swap(P,Q);\n    }\n\n    ans=M;\n    dfs(min(N,26ll),0,P,Q);\n    dfs(min(N,26ll),P+Q,P,Q);\n\n    if(B==1){\n        P+=Q;\n        if(M/P>N)chmin(ans,abs(M-N*P));\n        else{\n            chmin(ans,abs(M-M/P*P));\n            if(M/P+1<=N)chmin(ans,abs(M-M/P*P-P));\n        }\n    }\n    else if(A==1&&B==2){\n        int t=1;\n        while(Q*(1ll<<t)<1e15)t++;\n        chmin(t,N);\n        for(int i=1;i<=t;i++){\n            dfs2(t,i,0,M-i*P);\n        }\n    }\n    else if(B==2){\n        P+=Q;\n        int t=1;\n        while(Q*(1ll<<t)<1e15)t++;\n        chmin(t,N);\n        for(int i=1;i<=t;i++)dfs2(t,i,0,M);\n    }\n    cout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nbool ch(int a,int b){\n  int x=1000000000000000LL;\n  x/=a;\n  x/=b;\n  return x==0;\n}\nsigned main(){\n  int n,m,a,b,p,q;\n  cin>>n>>m>>a>>b>>p>>q;\n  if(a==1&&b==1){\n    //cout<<m%(p+q)<<endl;\n    if(ch(n,p+q)) cout<<m%(p+q)<<endl;\n    else{\n      int t=n*(p+q);\n      if(m>=t) cout<<m-t<<endl;\n      else cout<<m%(p+q)<<endl;\n    }\n    return 0;\n  }\n  int ta=1,tb=1;\n  vector<int> v;\n  for(int i=0;i<n;i++){\n    if(ch(p,ta)) break;\n    if(ch(q,tb)) break;\n    int t=p*ta+q*tb;\n    //cout<<t<<endl;\n    if(t<=m) v.push_back(t);\n    else break;\n    if(ch(ta,a)) break;\n    if(ch(tb,b)) break;\n    ta*=a;tb*=b;\n  }\n  int x=v.size();\n  int y=x/2;\n  set<int> s;\n  int ans=m;\n  for(int i=0;i<(1<<y);i++){\n    int t=0;\n    for(int j=0;j<y;j++) if((i>>j)&1) t+=v[j];\n    if(t>m) continue;\n    //cout<<t<<endl;\n    s.insert(-t);\n    ans=min(ans,m-t);\n  }\n  for(int i=0;i<(1<<(x-y));i++){\n    int t=0;\n    for(int j=0;j<(x-y);j++) if((i>>j)&1) t+=v[y+j];\n    if(t>m) continue;\n    //cout<<t<<endl;\n    ans=min(ans,m-t);\n    int u=t-m;\n    int k=*s.lower_bound(u);\n    ans=min(ans,m-(t-k));\n  }\n  assert(ans>=0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 1LL<<60;\nll n,m,a,b,p,q;\n\nll calc(ll k){\n  ll A = 1,B = 1;\n  ll res = p+q;\n  while(0<res&&res<=INF&&k--)A*=a,B*=b,res=p*A+q*B;\n  if(res<0||res>INF)return -1; \n  return res;\n}\n\n\nll ans = INF;\ntypedef pair<ll,ll> P;\nset<P> used;\nvoid dfs(ll pos,ll sum){\n  assert(sum>=0);\n\n  if(pos>=n||sum<0LL||sum>INF) return;\n  if(used.count(P(pos,sum))) return ;\n  used.insert(P(pos,sum));\n  ans = min(ans,(ll)abs(m-sum));\n  \n  ll r = calc(pos);\n  if(r<=0) return;\n  dfs(pos+1,sum+r);  \n  dfs(pos+1,sum);\n}\n\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  if(max(a,b)==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - (p+q));\n    if(m/(p+q)==n) t = INF;\n    if(m/(p+q)<=n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n  }\n  \n  dfs(0,0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s, B;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\n\tif (a >= 1000000000 && b >= 1000000000) {\n\t\tif (p >= 1000000000 && q >= 1000000000) {\n\t\t\tcout << min(m, abs(m - p - q)) << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << min(m, min(abs(m - p - q), abs(m - a * p - b * q))) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\n\tif (a == 1 && b == 1) {\n\t\tif (n >= 1000001 && (p + q) >= 1000001) { goto F; }\n\t\tif (m <= n * (p + q)) {\n\t\tF:;\n\t\t\tB = m % (p + q);\n\t\t\tif (B > (p + q) / 2) {\n\t\t\t\tB = (p + q) - B;\n\t\t\t}\n\t\t\tcout << B << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << m - (long long)(n * (p + q)) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = m;\n\td = s;\nE:;\n\trem = m - c[d - 1];\n\tminx = min(minx, abs(rem));\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cassert>\n#include<climits>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\ntypedef long long ll;\n\nvector<ll> generate(vector<ll> a){\n  vector<ll> ret;\n  int n = a.size();\n  rep(i,(1<<n)){\n    ll tmp = 0;\n    rep(j,n){\n      if ((1<<j)&i)tmp += a[j];\n    }\n    ret.push_back(tmp);\n  }\n  sort(ret.begin(),ret.end());\n  return ret;\n}\n\nll bs(ll m,ll sum,vector<ll> &a,bool fg){\n  int ret = -1;\n  int l = 0,r = a.size()-1;\n  while(l <= r){\n    int mid = (l+r)/2;\n    ll tmp = sum + a[mid];\n    if (fg){\n      if (tmp <= m){//ä¸éããã£ã¨ä¸ããã\n\tret = mid;\n\tl = mid+1;\n      }else {\n\tr = mid-1;\n      }\n    }else {\n      if (tmp >= m){\n\tret = mid;\n\tr = mid-1;\n      }else {\n\tl = mid+1;\t\n      }\n    }\n  }\n\n  /*  cout <<\"dbg\" << endl;\n  rep(i,a.size())cout << a[i] <<\" \" ;cout << endl;\n  cout <<fg <<\" \" <<  m <<\" \" << sum <<\" \" << (ret != -1?a[ret]:-1) <<\" \" << \n    ((ret != -1)?sum+a[ret]:-1)\n       << endl;\n  */\n  if (ret == -1)return llabs(m-sum);\n  return llabs(m-(sum+a[ret]));\n}\n\nll ans;\nvoid search(int n,int now,ll sum,int m,vector<ll> &a,vector<ll> &all){\n  //ub,sumã¨aã®è¦ç´ ã§ãmä»¥ä¸ã§æå¤§ã®ãã®ãæ¢ã\n  //lb,sumã¨aã®è¦ç´ ã®åã§mä»¥ä¸æå°ã®ãã®ãæ¢ã\n  ll ub=bs(m,sum,all,true),lb=bs(m,sum,all,false);\n  ans = min(ans,ub);\n  ans = min(ans,lb);\n  if (now == n)return;\n  //ä½¿ã\n  search(n,now+1,sum+a[now],m,a,all);\n  //ä½¿ããªã\n  search(n,now+1,sum,m,a,all);\n}\n\n/*\n  ååå¨åæãã ãã¡ã¢ãªç¯ç´ãããã®ã§å¾ãååã¯æ¢ç´¢ããã\n */\nll solve2(vector<ll> in,ll m){\n  vector<ll> mae,usiro;\n  rep(i,in.size()){\n    if (i < in.size()/2)mae.push_back(in[i]);\n    else usiro.push_back(in[i]);\n  }\n  vector<ll> all=generate(mae);\n  ans = m;\n  search(usiro.size(),0,0,m,usiro,all);\n  return ans;\n}\n\nll solve(ll n,ll m,ll a,ll b,ll p,ll q){\n  if (a == 1 && b == 1){//ç¹æ®ã±ã¼ã¹\n    ll sum = p+q;\n    ll lb = min(n,m/sum),ub=min(n,(m+sum-1)/sum);\n    ll ret = m;\n    ret = min(ret,llabs(m-lb*(sum)));\n    ret = min(ret,llabs(m-ub*(sum)));\n    return ret;\n  }\n\n  //ãã±ããã®çæ\n  //ä¸å¿doubleåã§å¤ã¯åãæ±ã£ã¦ããã\n  //å¿è¦ãªãã±ããã¯æå¤§ï¼ï¼æã§ãããä»¥ä¸ã¯æå³ããªãã\n  int loop = 0;\n  ll cur = p + q;\n  ll mula=1,mulb=1;\n  double m_d=m;\n  double cur_d = p + q;\n  double mula_d = 1, mulb_d = 1;\n  vector<ll> all;\n  all.push_back(cur);\n  while(cur_d <= m_d && loop < n){\n    mula_d *= a;\n    mulb_d *= b;\n    cur_d   = p*mula_d + q*mulb_d;\n    if (cur_d > 2*m)break;\n    mula *= a;\n    mulb *= b;\n    cur = p*mula + q*mulb;\n    all.push_back(cur);\n\n  }\n  rep(i,all.size())assert(all[i] > 0);\n\n  if (all.size() == 1){//ä¸ã¤ããä½¿ãããã±ããããªããªããããç­ãã«ããã(å¿ãï¼æã¯ãããã¨ãä¿è¨¼ããã¦ãã)\n    return min(m,llabs(all[0]-m));\n  }\n  return solve2(all,m);\n}\n\nmain(){\n  ll n,m,a,b,p,q;\n  while(cin>>n>>m>>a>>b>>p>>q && n){\n    cout << solve(n,m,a,b,p,q)  << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <vector>\n#include <algorithm>\n\n#define show(x) cerr << #x << \" = \" << x << endl\n\nusing namespace std;\nusing ld = long double;\nusing ll = long long;\n\ntemplate <typename T>\nostream& operator<<(ostream& os, const vector<T>& v)\n{\n    os << \"[\";\n    for (const auto& e : v) {\n        os << e << \",\";\n    }\n    os << \"] \";\n    os << \"size = \" << v.size() << endl;\n    return os;\n}\n\nint main()\n{\n    ll n, m, a, b, p, q;\n    cin >> n >> m >> a >> b >> p >> q;\n\n    if (p + q > m) {\n        cout << min(m, p + q - m) << endl;\n    } else if (a == b) {\n        cout << min(m % (p + q), (p + q) - (m % (p + q))) << endl;\n    } else {\n        ll k = 0;\n        ll A = 1;\n        ll B = 1;\n        vector<ll> value;\n        for (; p * A + q * B <= m and k <= n; k++) {\n            value.push_back(p * A + q * B);\n            A *= a;\n            B *= b;\n        }\n        n = k;\n        const ll former = n / 2;\n        const ll latter = n - former;\n        const ll fmax = 1 << former;\n        const ll lmax = 1 << latter;\n\n        vector<ll> fsum(fmax, 0LL);\n        for (ll i = 0; i < fmax; i++) {\n            for (ll j = 0; j < former; j++) {\n                if (i & (1LL << j)) {\n                    fsum[i] = fsum[i - (1LL << j)] + value[j];\n                    break;\n                }\n            }\n        }\n        vector<ll> lsum(lmax, 0LL);\n        for (ll i = 0; i < lmax; i++) {\n            for (ll j = 0; j < latter; j++) {\n                if (i & (1LL << j)) {\n                    lsum[i] = lsum[i - (1LL << j)] + value[former + j];\n                    break;\n                }\n            }\n        }\n        sort(lsum.begin(), lsum.end());\n        constexpr ll INF = 1LL << 60;\n        ll error = INF;\n        for (ll f : fsum) {\n            const ll res = m - f;\n            if (res <= 0) {\n                error = min(error, -res);\n            } else {\n                auto it = lower_bound(lsum.begin(), lsum.end(), res);\n                if (it != lsum.end()) {\n                    error = min(error, abs(res - (*it)));\n                }\n                it--;\n                error = min(error, abs(res - (*it)));\n            }\n        }\n        cout << error << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint main(){\n  long long int n, m, a, b, p, q, ans;\n  cin >> n >> m >> a >> b >> p >> q;\n  if(a < b){\n    swap(a, b);\n    swap(p, q);\n  }\n  if(a == 1){\n    if(m/(p + q) >= n) cout << m - n*(p + q) << endl;\n    else{\n      long long int t = m - m/(p + q)*(p + q);\n      cout << min(t, p + q - t) << endl;\n    }\n    return 0;\n  }\n  ans = m;\n  long long int x = 1, y = 1;\n  for(int i = 1; i < n; ++i){\n    if(m <= p*x + q*y) break;\n    x *= a;\n    y *= b;\n  }\n  while(x > 0){\n    ans = min(ans, abs(m - (p*x + q*y)));\n    if(m >= p*x + q*y) m -= p*x + q*y;\n    x /= a;\n    y /= b;\n  }\n  cout << ans << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s, B;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\n\tif (a == 1 && b == 1) {\n\t\tif (m <= s * (n + 1) / 2 * (p + q)) {\n\t\t\tB = m % (p + q);\n\t\t\tif (B > (p + q) / 2) {\n\t\t\t\tB = (p + q) - B;\n\t\t\t}\n\t\t\tcout << B << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << m - (long long)(n * (n + 1) / 2 * (p + q)) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = m;\n\td = s;\nE:;\n\trem = m - c[d - 1];\n\tminx = min(minx, abs(rem));\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dist[40];\nint main(){\n\tlong long a,b,c,d,e,f;\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&a,&b,&c,&d,&e,&f);\n\tif(c==1&&d==1){\n\t\tlong long v=b%(e+f);\n\t\tlong long g=b/(e+f);\n\t\tlong long ret=v+max(0LL,g-a)*(e+f);\n\t\tg++;\n\t\tv=e+f-v;\n\t\tret=min(ret,v+max(0LL,g-a)*(e+f));\n\t\tprintf(\"%lld\\n\",ret);\n\t\t\n\t\treturn 0;\n\t}\n\tint sz=0;\n\tfor(int i=0;i<=a;i++){\n\t\tlong long L=e;\n\t\tlong long R=f;\n\t\tlong long Q=b;\n\t\tfor(int j=0;j<i;j++)Q/=max(c,d);\n\t\tif(Q==0)break;\n\t\tfor(int j=0;j<i;j++)L*=c;\n\t\tfor(int j=0;j<i;j++)R*=d;\n\t\tlong long t=L+R;\n\t\tif(t>b)break;\n\t\tdist[sz++]=t;\n\t//\tprintf(\"%lld \",dist[sz-1]);\n\t}\n\tif(d==1){\n\t\tswap(c,d);\n\t\tswap(e,f);\n\t}\n\tif(c==1){\n\t\tlong long ret=b;\n\t\tfor(int i=0;i<sz;i++)dist[i]-=e;\n\t\tfor(int i=1;i<=sz;i++){\n\t\t\tlong long tmp=b-(long long)i*e;\n\t\t\tif(tmp<0)break;\n\t\t\tint rem=i;\n\t\t\tfor(int j=sz-1;j>=0;j--){\n\t\t\t\tif(tmp>=dist[j]){\n\t\t\t\t\trem--;\n\t\t\t\t\ttmp-=dist[j];\n\t\t\t\t}else{\n\t\t\t\t\tlong long cost=dist[j]-tmp;\n\t\t\t\t\tif(rem-1<=j){\n\t\t\t\t\t\tfor(int k=0;k<rem-1;k++){\n\t\t\t\t\t\t\tcost+=dist[k];\n\t\t\t\t\t\t}\n\t\t\t\t//\t\tprintf(\"%d %d: %lld\\n\",i,j,cost);\n\t\t\t\t\t\tret=min(ret,cost);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(rem==0)break;\n\t\t\t}\n\t\t\t\n\t\t\tif(rem==0)ret=min(ret,tmp);\n\t\t\t//printf(\"%d: %lld\\n\",i,ret);\n\t\t}\n\t\tprintf(\"%lld\\n\",ret);\n\t\treturn 0;\n\t}\n\tlong long ret=b;\n\tlong long tmp=b;\n\tfor(int i=sz-1;i>=0;i--){\n\t\tif(tmp>=dist[i])tmp-=dist[i];\n\t\telse ret=min(ret,dist[i]-tmp);\n\t\tret=min(ret,tmp);\n\t}\n\tprintf(\"%lld\\n\",ret);\n}\n//11 12 14 18"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 1LL<<45;\nll Sum[100];\nll n,m,a,b,p,q;\n\n\nll calc(ll k){\n  ll A = 1,B = 1,res=p+q;\n  while(res<=INF&&k--)A*=a,B*=b,res=p*A+q*B;\n  return min(INF,res);\n}\n\nll ans = INF;\nset<ll> used[101];\nvoid dfs(ll pos,ll sum){\n  ans = min(ans,(ll)abs(m-sum));\n  if(m<sum||pos==-1||sum>INF||used[pos].count(sum)) return;\n  if(Sum[pos]+sum<m){ans=min(ans,m-(Sum[pos]+sum));return;}\n  used[pos].insert(sum);\n  dfs(pos-1,sum+calc(pos));  \n  dfs(pos-1,sum);\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  Sum[0] = calc(0);\n  for(int i=1;i<60;i++)Sum[i]=min(INF,calc(i)+Sum[i-1]);\n    if(max(a,b)==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - (p+q));\n    if(m/(p+q)==n) t = INF;\n    if(m/(p+q)<=n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n    }\n  \n  dfs(min(n-1,50LL),0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <vector>\n#include <queue>\n#include <string>\n#include <algorithm>\n#include <iostream>\n#include <string>\n#include <map>\n#include <set>\n#include <functional>\n#include <iostream>\n#define MOD 1000000007LL\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nll labs(ll x){\n\tif(x<0LL)return -x;\n\treturn x;\n}\n\nint zcnt(ll x){\n\tint cnt=0;\n\twhile(x>0){\n\t\tx/=10LL;\n\t\tcnt++;\n\t}\n\treturn cnt;\n}\n\nll n,m,a,b,p,q;\nll num[51];\nvector<ll> vec;\n\nint main(void){\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&n,&m,&a,&b,&p,&q);\n\tif(a==1LL && b==1LL){\n\t\tll dist=p+q;\n\t\tll cnt=m/dist;\n\t\tprintf(\"%lld\\n\",min(labs(m-min(cnt,n)*dist),labs(m-(min(cnt+1LL,n))*dist)));\n\t}else{\n\t\tll v=0;\n\t\tll np=p,nq=q;\n\t\twhile(np+nq<=m){\n\t\t\tnum[v]=np+nq;\n\t\t\tif(zcnt(np)+zcnt(a)>=zcnt(m)+3 || zcnt(nq)+zcnt(b)>=zcnt(m)+3)break;\n\t\t\tnp*=a;\n\t\t\tnq*=b;\n\t\t\tv++;\n\t\t}\n\t\tll res=m;\n\t\tv=min(v,n);\n\t\tif(v==0){\n\t\t\tres=min(res,labs(m-p-q));\n\t\t}\n\t\tint v2=v/2;\n\t\tfor(int bit=0;bit<(1<<v2);bit++){\n\t\t\tll now=0;\n\t\t\tfor(int i=0;i<v2;i++){\n\t\t\t\tif((bit>>i) & 1){\n\t\t\t\t\tnow+=num[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tvec.push_back(now);\n\t\t}\n\t\tsort(vec.begin(),vec.end());\n\t\tvec.erase(unique(vec.begin(),vec.end()),vec.end());\n\t\tint v3=v-v2;\n\t\tfor(int bit=0;bit<(1<<v3);bit++){\n\t\t\tll now=0;\n\t\t\tfor(int i=0;i<v3;i++){\n\t\t\t\tif((bit>>i) & 1){\n\t\t\t\t\tnow+=num[i+v2];\n\t\t\t\t}\n\t\t\t}\n\t\t\tint l=lower_bound(vec.begin(),vec.end(),m-now)-vec.begin();\n\t\t\tif(l<vec.size())res=min(res,labs(m-now-vec[l]));\n\t\t\tif(l>0 || l==vec.size()){\n\t\t\t\tres=min(res,labs(m-now-vec[l-1]));\n\t\t\t}\n\t\t}\n\t\tprintf(\"%lld\\n\",res);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dist[40];\nint main(){\n\tint a,b,c,d,e,f;\n\tscanf(\"%d%d%d%d%d%d\",&a,&b,&c,&d,&e,&f);\n\tif(c==1&&d==1){\n\t\tint v=b%(e+f);\n\t\tint g=b/(e+f);\n\t\tprintf(\"%d\\n\",v+max(0,g-a));\n\t\treturn 0;\n\t}\n\tint sz=0;\n\tfor(int i=0;i<=a;i++){\n\t\tlong long L=e;\n\t\tlong long R=f;\n\t\tfor(int j=0;j<i;j++)L*=c;\n\t\tfor(int j=0;j<i;j++)R*=d;\n\t\tlong long t=L+R;\n\t\tif(t>b)break;\n\t\tdist[sz++]=t;\n\t//\tprintf(\"%lld \",dist[sz-1]);\n\t}\n\tif(d==1){\n\t\tswap(c,d);\n\t\tswap(e,f);\n\t}\n\tif(c==1){\n\t\tlong long ret=b;\n\t\tfor(int i=0;i<sz;i++)dist[i]-=e;\n\t\tfor(int i=1;i<=sz;i++){\n\t\t\tlong long tmp=b-(long long)i*e;\n\t\t\tif(tmp<0)break;\n\t\t\tint rem=i;\n\t\t\tfor(int j=sz-1;j>=0;j--){\n\t\t\t\tif(tmp>=dist[j]){\n\t\t\t\t\trem--;\n\t\t\t\t\ttmp-=dist[j];\n\t\t\t\t}else{\n\t\t\t\t\tlong long cost=dist[j]-tmp;\n\t\t\t\t\tif(rem-1<=j){\n\t\t\t\t\t\tfor(int k=0;k<rem-1;k++){\n\t\t\t\t\t\t\tcost+=dist[k];\n\t\t\t\t\t\t}\n\t\t\t\t//\t\tprintf(\"%d %d: %lld\\n\",i,j,cost);\n\t\t\t\t\t\tret=min(ret,cost);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(rem==0)break;\n\t\t\t}\n\t\t\t\n\t\t\tif(rem==0)ret=min(ret,tmp);\n\t\t\t//printf(\"%d: %lld\\n\",i,ret);\n\t\t}\n\t\tprintf(\"%lld\\n\",ret);\n\t\treturn 0;\n\t}\n\tlong long ret=b;\n\tlong long tmp=b;\n\tfor(int i=sz-1;i>=0;i--){\n\t\tif(tmp>=dist[i])tmp-=dist[i];\n\t\telse ret=min(ret,dist[i]-tmp);\n\t\tret=min(ret,tmp);\n\t}\n\tprintf(\"%lld\\n\",ret);\n}\n//11 12 14 18"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll n,m,a,b,p,q,s[50],g;\nvector<ll> v[2];\n\nvoid dfs(int f,ll pos,ll ss,ll e){\n  if(pos==e){\n    v[f].push_back(ss);\n    return;\n  }\n  ll ns=s[pos]+ss;\n  dfs(f,pos+1,ss,e);\n  dfs(f,pos+1,ns,e);\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  if(b==1&&a==1){\n    if(m/(p+q)>=n)cout<<m-(p+q)*n<<endl;\n    else cout<<min(p+q-(m%(p+q)),m%(p+q))<<endl;    \n  }\n  else{\n    for(ll i=0,x=p,y=q;i<n;i++,x*=a,y*=b){\n      ll ss=x+y;\n      s[g++]=ss;\n      if(ss>m)break;\n    }\n    v[0].push_back(0);\n   v[1].push_back(0);\n   v[1].push_back(1e16);\n    dfs(0,0,0,g/2);\n    dfs(1,g/2,0,g);\n    ll ans=m;\n    sort(v[1].begin(),v[1].end());\n    for(int i=0;i<v[0].size();i++){\n      int l=0,M,r=v[1].size();\n      while(l<r){\n\tM=(l+r)/2;\n\tif(v[0][i]+v[1][M]<=m)l=M+1;\n\telse r=M;\n      }\n      ans=min(ans,m-v[0][i]-v[1][r-1]);\n      ans=min(ans,v[0][i]+v[1][r]-m);\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s, B;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\n\tif (a == 1 && b == 1) {\n\t\tif (m <= s * (n + 1) / 2 * (p + q)) {\n\t\t\tB = m % (p + q);\n\t\t\tif (m > (p + q) / 2) {\n\t\t\t\tB = (p + q) - B;\n\t\t\t}\n\t\t\tcout << B << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << (long long)(n * (n + 1) / 2 * (p + q)) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = m;\n\td = s;\nE:;\n\trem = m - c[d - 1];\n\tminx = min(minx, abs(rem));\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return min( m%total , m-m%total);\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n  if(n>40)n=40;\n  for(int i=0;i< n ;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        res=min( res, abs( m- ( T[i]+U[j] )) );      \n      }\n    }\n  }\n  \n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    \n    ll d=p+q;\n    ll total=mul(d,n);\n    \n    //    if(total <= m)return m-total;\n    return min( m%d , m-(m%d) );\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        res=min( res, abs( m- ( T[i]+U[j] )) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 1LL<<60;\nll N=0;\nll n,m,a,b,p,q;\n\nll calc(ll k){\n  ll A = 1,B = 1;\n  while(A<INF&&B<INF&&k--)A*=a,B*=b;\n  if(A>=INF||B>=INF) return -1;\n  return p*A+q*B;\n}\n\n\nll ans = INF;\ntypedef pair<ll,ll> P;\nset<P> used;\nvoid dfs(ll pos,ll sum){\n  assert(sum>=0);\n  if(pos>=n||sum<0LL||sum>INF) return;\n  if(used.count(P(pos,sum))) return ;\n  used.insert(P(pos,sum));\n  ans = min(ans,(ll)abs(m-sum));\n  \n  ll r = calc(pos);\n  if(r<=0) return;\n  dfs(pos+1,sum+r);  \n  dfs(pos+1,sum);\n}\n\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  if(max(a,b)==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - p+q);\n    if(m/(p+q)==n-1) t = INF;\n    if(m/(p+q)<n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n  }\n\n  dfs(0,0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define N 41\nusing namespace std;\ntypedef long long ll;\nll n,m,a,b,p,q,d[N];\nvector<ll> v[2],x[2];\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll ans=m;\n  if(a==1&&b==1){\n    ll ti=min(n,m/(p+q));\n    ans=min(ans,min(m-ti*(p+q),abs(min(ti+1,n)*(p+q)-m)));\n  }\n  ll A=1,B=1;\n  for(int i=0;i<min((ll)N,n);i++){\n    d[i]=p*A+q*B;\n    if(i<min((ll)N,n)/2)v[0].push_back(d[i]);\n    else v[1].push_back(d[i]);\n    if(d[i]>m)break;\n    A*=a,B*=b;\n  }\n  int len[2]={v[0].size(),v[1].size()};\n  for(int i=0;i<2;i++){\n    v[i].push_back(0);\n    for(int j=0;j<(1<<len[i]);j++){\n      ll sum=0;\n      for(int k=0;k<len[i];k++){\n\tif(!(j&(1<<k)))continue;\n\tsum+=v[i][k];\n      }\n      x[i].push_back(sum);\n    }\n    sort(x[i].begin(),x[i].end());\n  }\n  for(int i=0;i<x[0].size();i++){\n    ll search=m-x[0][i];\n    vector<ll>::iterator r=lower_bound(x[1].begin(),x[1].end(),search);\n    if(r!=x[1].end())ans=min(ans,(*r)-search);\n    if(r!=x[1].begin())ans=min(ans,search-(*(r-1)));\n  }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cmath>\n#include <algorithm>\n#include <utility>\n#include <queue>\n#include <set>\n#include <map>\n\nusing namespace std;\ntypedef  long long ll;\ntypedef pair<int,int> PII;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\n#define  MP make_pair\n#define  PB push_back\n#define inf  1000000007\n\n\nint main(){\n\tll n,m,a,b,p,q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\tif(a==1&&b==1){\n\t\tll ans = m;\n\t\tll x = p+q;\n\t\tll y = m/x;\n\t\tif(y>=n){\n\t\t\tans = min(ans,m-x*n);\n\t\t\tcout << ans << endl;\n\t\t}else{\n\t\t\tans = min(ans,m-(x*y));\n\t\t\tans = min(ans,x-ans);\n\t\t\tcout << ans << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\tvector<ll> r1,r2;\n\tr1.push_back(1);\n\tr2.push_back(1);\n\tif(p+q >= m){\n\t\tcout << min(m,p+q-m) << endl;\n\t\treturn 0;\n\t}\n\tfor(int i=1;i<n;i++){\n\t\tr1.PB(r1[i-1]*a);\n\t\tr2.PB(r2[i-1]*b);\n\t\tif(p*r1[i]+q*r2[i]>=m){\n\t\t\tn=i+1;\n\t\t}\n\t}\n\tll ans=m;\n\tif(p*r1[n-1]+q*r2[n-1]>=m){\n\t\tans = min(ans,p*r1[n-1]+q*r2[n-1]-m);\n\t\tn--;\n\t}\n\tvector<ll> s1,s2,t1,t2;\n\tconst ll mae = n/2;\n\tconst ll usi = n - mae;\n\tfor(int i=0;i<n/2;i++){\n\t\ts1.push_back(p*r1[i]+q*r2[i]);\n\t}\n\tfor(int i=n/2;i<n;i++){\n\t\ts2.push_back(p*r1[i]+q*r2[i]);\t\n\t}\n\t/*for(int i=0;i<mae;i++){\n\t\tcout << s1[i] << endl;\n\t}\n\tcout << endl;\n\tfor(int i=0;i<usi;i++){\n\t\tcout << s2[i] << endl;\n\t}*/\n\tfor(ll i=0;i<(1LL<<(mae));i++){\n\t\tll s = 0;\n\t\tfor(ll j=0;j<mae;j++){\n\t\t\tif(i&(1LL<<j)){\n\t\t\t\ts += s1[j];\n\t\t\t}\n\t\t}\n\t\tt1.push_back(s);\n\t}\n\tfor(ll i=0;i<(1LL<<(usi));i++){\n\t\tll s = 0;\n\t\tfor(ll j=0;j<usi;j++){\n\t\t\tif(i&(1LL<<j)){\n\t\t\t\ts += s2[j];\n\t\t\t}\n\t\t}\n\t\tt2.push_back(s);\n\t}\n\tsort(t1.begin(),t1.end());\n\tsort(t2.begin(),t2.end());\n\t/*for(int i=0;i<t1.size();i++){\n\t\tcout << t1[i] << endl;\n\t}\n\tfor(int i=0;i<t2.size();i++){\n\t\tcout << t2[i] << endl;\n\t}*/\n\tfor(int i=0;i<t1.size();i++){\n\t\tint k = lower_bound(t2.begin(),t2.end(),m-t1[i])-t2.begin()-1;\n\t\tans = min(ans,abs(m-t1[i]-t2[k]));\n\t\tif(k+1<usi){\n\t\t\tans = min(ans,abs(m-t1[i]-t2[k+1]));\n\t\t}\t\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=100000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return min( m%total , m-m%total);\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n  for(int i=0;i<40;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-1;j<=index+1;j++){\n      if(0<=j && j<(int)U.size()){\n        res=min( res, abs( m- ( T[i]+U[j] )) );      \n      }\n    }\n  }\n  \n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// g++ -std=c++11 a.cpp\n#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>   \n#include<map>\n#include<set>\n#include<unordered_map>\n#include<utility>\n#include<cmath>\n#include<random>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<bitset>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#include<typeinfo>\n#define loop(i,a,b) for(ll i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define FOR(i,a) for(auto i:a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n#define show1d(v) rep(i,v.size())cout<<\" \"<<v[i];cout<<endl<<endl;\n#define show2d(v) rep(i,v.size()){rep(j,v[i].size())cout<<\" \"<<v[i][j];cout<<endl;}cout<<endl;\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\n//#define int ll\ntypedef ll Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n#define mt make_tuple\ntypedef tuple<int,int,int,int> tp;\ntypedef vector<tp> vt;\ntemplate<typename A,typename B>bool cmin(A &a,const B &b){return a>b?(a=b,true):false;}\ntemplate<typename A,typename B>bool cmax(A &a,const B &b){return a<b?(a=b,true):false;}\n//template<class C>constexpr int size(const C &c){return (int)c.size();}\n//template<class T,size_t N> constexpr int size(const T (&xs)[N])noexcept{return (int)N;}\nconst double PI=acos(-1);\nconst double EPS=1e-9;\nDef inf = sizeof(Def) == sizeof(long long) ? 2e18 : 1e9+10;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\nint main(){\n\tll n,m,a,b,p,q;\n\tcin>>n>>m>>a>>b>>p>>q;\n\tvi A,B;\n\tll t=p;\n\twhile(1){\n\t\tA.pb(t);\n\t\tif(to_string(t).size()+to_string(a).size()>16)break;\n\t\tt*=a;\n\t}\n\tt=q;\n\twhile(1){\n\t\tB.pb(t);\n\t\tif(to_string(t).size()+to_string(b).size()>16)break;\n\t\tt*=b;\n\t}\n\t//show1d(A);\n\t//show1d(B);\n\tvi in;\n\trep(i,min((ll)A.size(),n))\n\t\tif(i<B.size()&&A[i]+B[i]<=m)in.pb(A[i]+B[i]);\n\tn=in.size()/2;\n\tll N=1<<n;\n\tvi dp;\n\trep(i,N){\n\t\tll sum=0;\n\t\trep(j,n)if(i&1<<j)sum+=in[j];\n\t\tif(sum<=m)dp.pb(sum);\n\t}\n\tsort(all(dp));\n\tll nn=in.size()-n;\n\tN=1<<nn;\n\tll out=0;\n//\tshow1d(in);\n\trep(i,N){\n\t\tll sum=0;\n\t\trep(j,nn)if(i&1<<j)sum+=in[n+j];\n\t\tif(sum>m)continue;\n\t\tauto it=upper_bound(all(dp),m-sum);\n\t\tif(it==dp.begin())continue;\n\t\tit--;\n\t\tout=max(out,(ll)*it+sum);\n\t}\n//\tshow1d(dp);\n\tcout<<m-out<<endl;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=__int128;\n\nusing ll2=long long;\n\nconst ll INF=1e15;\n\nll powi(ll x,ll k){\n    ll res=1;\n    while(k){\n        if(k&1) res*=x;\n        if(res>INF) return INF;\n        x*=x;\n        k>>=1;\n    }\n    return res;\n}\nint main(){\n    ll2 nn,mm,aa,bb,pp,qq;\n    cin>>nn>>mm>>aa>>bb>>pp>>qq;\n    ll n=nn,m=mm,a=aa,b=bb,p=pp,q=qq;\n    if(a>=2 || b>=2){\n        int tn=min(n,ll(44));\n        int half=tn/2;\n        vector<ll> vec(1<<half);\n        for(int i=0;i<(1<<half);i++){\n            ll val=0;\n            for(int j=0;j<half;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,j)+q*powi(b,j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            vec[i]=val;\n\n        }\n        int rest=tn-half;\n        set<ll> s;\n        for(int i=0;i<(1<<rest);i++){\n            ll val=0;\n            for(int j=0;j<rest;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,half+j)+q*powi(b,half+j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            s.insert(val);\n        }\n        ll res=m;\n        for(int i=0;i<vec.size();i++){\n            auto it=s.lower_bound(m-vec[i]);\n            if(it!=s.end()){\n        \n                res=min(res,abs(m-vec[i]-*it));\n            }\n            if(it!=s.begin()){\n                it--;\n\n                res=min(res,abs(m-vec[i]-*it));\n            }\n        }\n        cout<<ll2(res)<<endl;\n    }\n    else{\n        if((p+q)*n>=m){\n            cout<<ll2(min(m%(p+q),(p+q)-m%(p+q)))<<endl;\n        }\n        else{\n            cout<<ll2(m-(p+q)*n)<<endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll n,m,a,b,p,q,s[50],g;\nvector<ll> v[2];\n\nvoid dfs(int f,ll pos,ll ss,ll e){\n  if(pos==e){\n    v[f].push_back(ss);\n    return;\n  }\n  ll ns=s[pos]+ss;\n  dfs(f,pos+1,ss,e);\n  dfs(f,pos+1,ns,e);\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  if(b==1&&a==1){\n    if(m/(p+q)>=n)cout<<m-(p+q)*n<<endl;\n    else cout<<min(p+q-(m%(p+q)),m%(p+q))<<endl;    \n  }\n  else{\n    for(ll i=0,x=p,y=q;i<n;i++,x*=a,y*=b){\n      ll ss=x+y;\n      s[g++]=ss;\n      if(ss>m)break;\n    }\n    v[0].push_back(0);\n   v[1].push_back(0);\n   v[1].push_back(1e16);\n    dfs(0,0,0,g/2);\n    dfs(1,g/2,0,g);\n    ll ans=m;\n    sort(v[1].begin(),v[1].end());\n    for(int i=0;i<v[0].size();i++){\n      int l=0,M,r=v[1].size();\n      while(l<r){\n\tM=(l+r)/2;\n\tif(v[0][i]+v[1][M]<=m)l=M+1;\n\telse r=M;\n      }\n      ans=min(ans,m-v[0][i]-v[1][r-1]);\n      ans=min(ans,v[0][i]+v[1][r]-m);\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=__int128;\n\nusing ll2=long long;\n\nconst ll INF=1e15;\n\nll powi(ll x,ll k){\n    ll res=1;\n    while(k){\n        if(k&1) res*=x;\n        if(res>INF) return INF;\n        x*=x;\n        k>>=1;\n    }\n    return res;\n}\nint main(){\n    ll2 nn,mm,aa,bb,pp,qq;\n    cin>>nn>>mm>>aa>>bb>>pp>>qq;\n    ll n=nn,m=mm,a=aa,b=bb,p=pp,q=qq;\n    if(a>=2 || b>=2){\n        int tn=min(n,ll(41));\n        int half=min((tn*2)/3,23);\n        vector<ll> vec(1<<half);\n        for(int i=0;i<(1<<half);i++){\n            ll val=0;\n            for(int j=0;j<half;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,j)+q*powi(b,j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            vec[i]=val;\n\n        }\n        int rest=tn-half;\n        vector<int> s(1<<rest);\n        for(int i=0;i<(1<<rest);i++){\n            ll val=0;\n            for(int j=0;j<rest;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,half+j)+q*powi(b,half+j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            s[i]=val;\n        }\n        ll2 res=m;\n        for(int i=0;i<vec.size();i++){\n            auto it=lower_bound(s.begin(),s.end(),m-vec[i]);\n            if(it!=s.end()){\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n            if(it!=s.begin()){\n                it--;\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n        }\n        cout<<res<<endl;\n    }\n    else{\n        if((p+q)*n>=m){\n            cout<<ll2(min(m%(p+q),(p+q)-m%(p+q)))<<endl;\n        }\n        else{\n            cout<<ll2(m-(p+q)*n)<<endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s, B;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\n\tif (a == 1 && b == 1) {\n\t\tif (m <= n * (p + q)) {\n\t\t\tB = m % (p + q);\n\t\t\tif (B > (p + q) / 2) {\n\t\t\t\tB = (p + q) - B;\n\t\t\t}\n\t\t\tcout << B << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << m - (long long)(n * (p + q)) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = m;\n\td = s;\nE:;\n\trem = m - c[d - 1];\n\tminx = min(minx, abs(rem));\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s, B;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\n\tif (a == 1 && b == 1) {\n\t\tif (n >= 100000000) { goto F; }\n\t\tif (m <= n * (n + 1) / 2 * (p + q)) {\n\t\tF:;\n\t\t\tB = m % (p + q);\n\t\t\tif (B > (p + q) / 2) {\n\t\t\t\tB = (p + q) - B;\n\t\t\t}\n\t\t\tcout << B << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << m - (long long)(n * (n + 1) / 2 * (p + q)) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = m;\n\td = s;\nE:;\n\trem = m - c[d - 1];\n\tminx = min(minx, abs(rem));\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb push_back\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\ntypedef vector<int>vint;\ntypedef pair<int,int>pint;\ntypedef vector<pint>vpint;\n\ntemplate<typename A,typename B>inline void chmin(A &a,B b){if(a>b)a=b;}\ntemplate<typename A,typename B>inline void chmax(A &a,B b){if(a<b)a=b;}\n\nint N,M,A,B,P,Q;\n\nvoid dfs(int k,int n,int s,vint &v,vint &latte){\n    if(k==n){\n        latte.pb(s);\n        return;\n    }\n    dfs(k+1,n,s,v,latte);\n    dfs(k+1,n,s+v[k],v,latte);\n}\n\nsigned main(){\n    cin>>N>>M>>A>>B>>P>>Q;\n    vector<int>v;\n    int x=P,y=Q;\n    while(true){\n        v.pb(x+y);\n        if(1.0*x*A>1e15||1.0*y*B>1e15)break;\n        x*=A;y*=B;\n    }\n\n    int n=v.size()/2;\n    vint latte,malta;\n    dfs(0,n,0,v,latte);\n    dfs(n,v.size(),0,v,malta);\n\n    sort(all(latte));\n    sort(all(malta));\n\n    int cur=0;\n    int ans=M;\n    for(int i=(int)malta.size()-1;i>=0;i--){\n        while(cur+1!=latte.size()&&latte[cur+1]+malta[i]<=M)cur++;\n        chmin(ans,abs(M-latte[cur]-malta[i]));\n    }\n\n    cur=0;\n    for(int i=(int)malta.size()-1;i>=0;i--){\n        while(cur+1!=latte.size()&&latte[cur]+malta[cur]<M)cur++;\n        chmin(ans,abs(M-latte[cur]-malta[i]));\n    }\n    cout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cmath>\n#include<cstdio>\n#include<vector>\n#include<algorithm>\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\tll n,m,a,b,p,q; scanf(\"%lld%lld%lld%lld%lld%lld\",&n,&m,&a,&b,&p,&q);\n\n\tll ans=llabs(n*(p+q)-m);\n\tif(a==1 && b==1){\n\t\tll i=m/(p+q);\n\t\tfor(int j=-3;j<=3;j++) if(0<=i+j && i+j<=n) ans=min(ans,llabs((i+j)*(p+q)-m));\n\t}\n\telse{\n\t\tint N;\n\t\tll num[40];\n\t\tfor(int k=0;;k++){\n\t\t\tnum[k]=p*pow(a,k)+q*pow(b,k);\n\t\t\tif(k==n || num[k]>1e9){\n\t\t\t\tN=k;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(N%2==1) num[N++]=0;\n\n\t\tvector<ll> half1,half2;\n\t\trep(S,1<<N/2){\n\t\t\tbool ok1=true,ok2=true;\n\t\t\tll sum1=0,sum2=0;\n\t\t\trep(i,N/2) if(S>>i&1) {\n\t\t\t\tsum1+=num[i];\n\t\t\t\tsum2+=num[i+N/2];\n\t\t\t\tif(sum1>2e9) ok1=false;\n\t\t\t\tif(sum2>2e9) ok2=false;\n\t\t\t}\n\t\t\tif(ok1) half1.push_back(sum1);\n\t\t\tif(ok2) half2.push_back(sum2);\n\t\t}\n\t\thalf1.push_back(0);\n\t\thalf2.push_back(0);\n\n\t\tsort(half1.begin(),half1.end());\n\t\tsort(half2.begin(),half2.end());\n\n\t\trep(i,half1.size()){\n\t\t\tint j=lower_bound(half2.begin(),half2.end(),m-half1[i])-half2.begin();\n\t\t\tif(j<half2.size()) ans=min(ans,llabs(half1[i]+half2[ j ]-m));\n\t\t\tif(j-1>=0)         ans=min(ans,llabs(half1[i]+half2[j-1]-m));\n\t\t}\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define EPS 1e-10\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;--i)\n#define srep(i,s,t) for(int i=(int)(s);i<(int)(t);++i)\n#define each(a,b) for(auto (a): (b))\n#define all(v) (v).begin(),(v).end()\n#define len(v) (int)(v).size()\n#define zip(v) sort(all(v)),v.erase(unique(all(v)),v.end())\n#define cmx(x,y) x=max(x,y)\n#define cmn(x,y) x=min(x,y)\n#define fi first\n#define se second\n#define pb push_back\n#define show(x) cout<<#x<<\" = \"<<(x)<<endl\n#define spair(p) cout<<#p<<\": \"<<p.fi<<\" \"<<p.se<<endl\n#define svec(v) cout<<#v<<\":\";rep(kbrni,v.size())cout<<\" \"<<v[kbrni];cout<<endl\n#define sset(s) cout<<#s<<\":\";each(kbrni,s)cout<<\" \"<<kbrni;cout<<endl\n#define smap(m) cout<<#m<<\":\";each(kbrni,m)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n\nusing namespace std;\n\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<P> vp;\ntypedef vector<string> vs;\n\nconst int MAX_N = 100005;\n\nll lpa[40],lpb[40];\ndouble dpa[40],dpb[40];\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    ll n,m,a,b,p,q;\n    cin >> n >> m >> a >> b >> p >> q;\n    if(a == 1 && b == 1){\n        ll cnt = m/(p+q);\n        cout << m-min(n,cnt)*(p+q) << \"\\n\";\n    }else{\n        ll mid = 20;\n        lpa[0] = lpb[0] = dpa[0] = dpb[0] = 1;\n        rep(i,2*mid-1){\n            lpa[i+1] = lpa[i] * a;\n            lpb[i+1] = lpb[i] * b;\n            dpa[i+1] = dpa[i] * a;\n            dpb[i+1] = dpb[i] * b;\n        }\n        vl u,v;\n        rep(i,(1 << mid)){\n            ll val1 = 0,val2 = 0;\n            double ch1 = 0,ch2 = 0;\n            rep(j,mid){\n                if((i >> j) & 1){\n                    val1 += p*lpa[j] + q*lpb[j];\n                    val2 += p*lpa[mid+j] + q*lpb[mid+j];\n                    ch1 += p*dpa[j] + q*dpb[j];\n                    ch2 += p*dpa[mid+j] + q*dpb[mid+j];\n                }\n            }\n            if(ch1 <= 2*m){\n                u.pb(val1);\n                if(ch2 <= 2*m){\n                    v.pb(val2);\n                }\n            }\n        }\n        // svec(u);\n        // svec(v);\n        sort(all(v));\n        ll mn = (1LL << 60);\n        rep(i,len(u)){\n            int id = upper_bound(all(v),m-u[i]) - v.begin();\n            if(id > 0){\n                cmn(mn,m-(u[i]+v[id-1]));\n            }\n            if(id < len(v)){\n                cmn(mn,(u[i]+v[id])-m);\n            }\n        }\n        cout << mn << \"\\n\";\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s, B;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\n\tif (a == 1 && b == 1) {\n\t\tif (n >= 100000000) { goto F; }\n\t\tif (m <= s * (n + 1) / 2 * (p + q)) {\n\t\tF:;\n\t\t\tB = m % (p + q);\n\t\t\tif (B > (p + q) / 2) {\n\t\t\t\tB = (p + q) - B;\n\t\t\t}\n\t\t\tcout << B << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << m - (long long)(n * (n + 1) / 2 * (p + q)) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = m;\n\td = s;\nE:;\n\trem = m - c[d - 1];\n\tminx = min(minx, abs(rem));\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  ll MAX=1000000000000LL;\n  \n  assert( 1<= n &&n <= MAX );\n  assert( 1<= m &&m <= MAX );\n  assert( 1<= a &&a <= MAX );\n  assert( 1<= b &&b <= MAX );\n  assert( 1<= p &&p <= MAX );\n  assert( 1<= q &&q <= MAX );\n  \n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return m%d;\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n    if( i==40 )break;\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        ll c=T[i]+U[j];\n        res=min( res,  abs(m-c) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// g++ -std=c++11 a.cpp\n#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>   \n#include<map>\n#include<set>\n#include<unordered_map>\n#include<utility>\n#include<cmath>\n#include<random>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<bitset>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#include<typeinfo>\n#define loop(i,a,b) for(ll i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define FOR(i,a) for(auto i:a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n#define show1d(v) rep(i,v.size())cout<<\" \"<<v[i];cout<<endl<<endl;\n#define show2d(v) rep(i,v.size()){rep(j,v[i].size())cout<<\" \"<<v[i][j];cout<<endl;}cout<<endl;\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\n//#define int ll\ntypedef ll Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n#define mt make_tuple\ntypedef tuple<int,int,int,int> tp;\ntypedef vector<tp> vt;\ntemplate<typename A,typename B>bool cmin(A &a,const B &b){return a>b?(a=b,true):false;}\ntemplate<typename A,typename B>bool cmax(A &a,const B &b){return a<b?(a=b,true):false;}\n//template<class C>constexpr int size(const C &c){return (int)c.size();}\n//template<class T,size_t N> constexpr int size(const T (&xs)[N])noexcept{return (int)N;}\nconst double PI=acos(-1);\nconst double EPS=1e-9;\nDef inf = sizeof(Def) == sizeof(long long) ? 2e18 : 1e9+10;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\nint main(){\n\tll n,m,a,b,p,q;\n\tcin>>n>>m>>a>>b>>p>>q;\n\tvi A,B;\n\tll t=p;\n\tint co=0;\n\twhile(1){\n\t\tA.pb(t);\n\t\tif(to_string(t).size()+to_string(a).size()>16)break;\n\t\tt*=a;\n\t\tif(a==1&&co==40)break;\n\t\tco++;\n\t}\n\tt=q;\n\tco=0;\n\twhile(1){\n\t\tB.pb(t);\n\t\tif(to_string(t).size()+to_string(b).size()>16)break;\n\t\tt*=b;\n\t\tif(b==1&&co==40)break;\n\t\tco++;\n\t}\n\t//show1d(A);\n\t//show1d(B);\n\tvi in;\n\trep(i,min((ll)A.size(),n))\n\t\tif(i<B.size()&&A[i]+B[i]<=3*m)in.pb(A[i]+B[i]);\n\tn=in.size()/2;\n\tll N=1<<n;\n\tvi dp;\n\trep(i,N){\n\t\tll sum=0;\n\t\trep(j,n)if(i&1<<j)sum+=in[j];\n\t\tif(sum<=3*m)dp.pb(sum);\n\t}\n\tsort(all(dp));\n\tll nn=in.size()-n;\n\tN=1<<nn;\n\tll out=m;\n//\tshow1d(in);\n\trep(i,N){\n\t\tll sum=0;\n\t\trep(j,nn)if(i&1<<j)sum+=in[n+j];\n\t\tif(sum>3*m)continue;\n\t\tauto it=upper_bound(all(dp),m-sum);\n\t\tif(it!=dp.end())out=min(out,abs(*it+sum-m));\n\t\tif(it==dp.begin())continue;\n\t\tit--;\n\t\tout=min(out,abs(*it+sum-m));\n\t}\n//\tshow1d(dp);\n\tcout<<out<<endl;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 1LL<<53;\nll Sum[100];\nll n,m,a,b,p,q;\n\n\nll calc(ll k){\n  static ll used[101]={},mem[101]={};\n  if(used[k]++) return mem[k];\n  ll A = 1,B = 1;\n  ll &res =mem[k]=p+q;\n  while(0<res&&res<=INF&&k--)A*=a,B*=b,res=p*A+q*B;\n  if(res<0||res>INF)res=INF;\n  return res;\n}\n\n\nll ans = INF;\nset<ll> used[101];\nvoid dfs(ll pos,ll sum){\n  if(sum<0LL||sum>INF) return;\n  ans = min(ans,(ll)abs(m-sum));\n  if(pos==-1)return;\n  if(Sum[pos]+sum<m){ans=min(ans,m-(Sum[pos]+sum));return;}\n  if(m<sum) return;\n  if(used[pos].count(sum)) return ;\n  used[pos].insert(sum);\n  \n  ll r = calc(pos);\n  if(r<INF)dfs(pos-1,sum+r);  \n  dfs(pos-1,sum);\n}\n\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  for(int i=0;i<60;i++) Sum[i] = INF;\n  Sum[0] = calc(0);\n  for(int i=1;i<60;i++)Sum[i]=min(INF,calc(i)+Sum[i-1]);\n\n  if(max(a,b)==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - (p+q));\n    if(m/(p+q)==n) t = INF;\n    if(m/(p+q)<=n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n  }\n  \n  dfs(min(n,50LL),0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define N 45\nusing namespace std;\ntypedef long long ll;\nll n,m,a,b,p,q,ans;\nll d[N],used[N];\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll A=1,B=1;\n  for(int i=0;i<min((ll)N,n);i++){\n    d[i]=p*A+q*B;\n    if(d[i]>m)break;\n    A*=a,B*=b;\n  }\n  ans=m;\n  for(int i=min((ll)N,n)-1;i>=0;i--){\n    if(m<d[i])continue;\n    used[i]=1;\n    m-=d[i];\n  }\n  ans=min(ans,m);\n  for(int i=0;i<min((ll)N,n)-1;i++)\n    if(!used[i]){\n      ans=min(ans,abs(m-d[i]));\n      break;\n    }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<set>\n#include<cstdlib>\n\nusing namespace std;\n\nlong long n,m,a,b,p,q;\n\nlong long mul(long long a,long long b){\n  __int128 r=a;\n  r*=b;\n  if(r>1e18)throw 0;\n  return r;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  if(a==1&&b==1){\n    long long c=m/(p+q);\n    cout<<min(m-min(n,c)*(p+q),min(n,c+1)*(p+q)-m)<<endl;\n  }else{\n    long long t[55]={};\n    t[0]=p+q;\n    long long ak=1,bk=1;\n    try{\n      for(int i=1;i<min(n,42ll);i++){\n\tak=mul(ak,a);\n\tbk=mul(bk,b);\n\tt[i]=mul(p,ak)+mul(q,bk);\n      }\n    }catch(...){\n    }\n    set<long long> s;\n    for(int i=0;i<1<<21;i++){\n      long long c=0;\n      for(int j=0;j<21;j++){\n\tc+=(i>>j&1)*t[j+21];\n      }\n      s.insert(c);\n    }\n    long long ans=1e18;\n    for(int i=0;i<1<<21;i++){\n      long long c=0;\n      for(int j=0;j<21;j++){\n\tc+=(i>>j&1)*t[j];\n      }\n      auto it=s.lower_bound(m-c);\n      if(it!=s.end()){\n\tans=min(ans,llabs(m-*it-c));\n      }\n      if(it!=s.begin()){\n\tit--;\n\tans=min(ans,llabs(m-*it-c));\n      }\n    }\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing PII = pair<int, int>;\nusing LL = __int128;\nusing VL = vector<LL>;\nusing VVL = vector<VL>;\nusing PLL = pair<LL, LL>;\nusing VS = vector<string>;\n\n#define ALL(a)  begin((a)),end((a))\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define EB emplace_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define SORT(c) sort(ALL((c)))\n#define RSORT(c) sort(RALL((c)))\n#define UNIQ(c) (c).erase(unique(ALL((c))), end((c)))\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\n#define FF first\n#define SS second\ntemplate<class S, class T>\nistream& operator>>(istream& is, pair<S,T>& p){\n  return is >> p.FF >> p.SS;\n}\ntemplate<class S, class T>\nostream& operator<<(ostream& os, const pair<S,T>& p){\n  return os << p.FF << \" \" << p.SS;\n}\ntemplate<class T>\nvoid maxi(T& x, T y){\n  if(x < y) x = y;\n}\ntemplate<class T>\nvoid mini(T& x, T y){\n  if(x > y) x = y;\n}\n\n\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\nconst LL MOD = 1e9+7;\nconst LL INF = 1e18;\n\nLL abs(LL x){\n  return x>0? x: -x;\n}\n\nint main(){\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n\n  long long n_, m_, a_, b_, p_, q_;\n  cin >> n_ >> m_ >> a_ >> b_ >> p_ >> q_;\n  LL n, m, a, b, p, q;\n  n = n_;\n  m = m_;\n  a = a_;\n  b = b_;\n  p = p_;\n  q = q_;\n\n  LL ans = INF;\n  if(a == 1 && b == 1){\n\tLL k = min(n, m / (p+q));\n\tmini(ans, abs(k*(p+q) - m));\n\tif(k+1 < n)\n\t  mini(ans, abs((k+1)*(p+q) - m));\n  }\n  else{\n\tLL M = min((LL)42, n);\n\tLL M2 = M / 2;\n\tvector<LL> as(M+1), bs(M+1);\n\tas[0] = bs[0] = 1;\n\tREP(i,M){\n\t  as[i+1] = (as[i]>=INF? INF: as[i] * a);\n\t  bs[i+1] = (bs[i]>=INF? INF: bs[i] * b);\n\t}\n\t\n\tvector<LL> xs = {0}, ys = {0};\n\tfor(int bb=0;bb<1<<M2;++bb){\n\t  LL sum = 0;\n\t  REP(i,M2)\n\t\tif(bb>>i&1){\n\t\t  sum += as[i]*p;\n\t\t  sum += bs[i]*q;\n\t\t  mini(sum, INF);\n\t\t}\n\t  xs.PB(sum);\n\t}\n\tfor(int bb=0;bb<1<<(M-M2);++bb){\n\t  LL sum = 0;\n\t  REP(i,M-M2)\n\t\tif(bb>>i&1){\n\t\t  sum += as[M2+i]*p;\n\t\t  sum += bs[M2+i]*q;\n\t\t  mini(sum, INF);\n\t\t}\n\t  ys.PB(sum);\n\t}\n\n\tfor(auto x: xs){\n\t  auto it = upper_bound(ALL(ys), m - x);\n\t  if(it != end(ys))\n\t\tmini(ans, abs(x + *it - m));\n\t  if(it != begin(ys)){\n\t\t--it;\n\t\tmini(ans, abs(x + *it - m));\n\t  }\n\t}\n  }\n\n  long long ans_ = ans;\n  cout << ans_ << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\n#define LINF 1LL<<60\n\n/*\n<url:http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=2239>\n?????????============================================================\n????????????????????????????????±?????????n ????????£?????????. ?????±????????????????????????0 ??????n ??? 1 ?????§???????????????????????????, \nk ???????????±?????????????????¨, p???a^k + q???b^k ?§????????????¨?????§??????.\n\n??????????????????????§???????m ?§???????????§???????????????????????£??????????????????????????????????,???????????????????????¢??????????????????.\n?§????????????????????????§??????.\n?????±?????????????????????????????§???????????¨???????????¨????????¨???, ????????????????°?????§???????????????§??????????????????.\n\n1 ??? n, m, a, b, p, q ??? 10^12 (??´??°)\n=================================================================\n?§£??¬=============================================================\n================================================================\n*/\n\nll powmod(ll a, ll b) { ll res = 1; assert(b >= 0); for (;b;b >>= 1) { if (b & 1)res = res*a;a = a*a; }return res; }\nint main(void) {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\tll n, m, a, b, p, q; cin >> n >> m >> a >> b >> p >> q;\n\tll res = m;\n\tif (a == 1 && b == 1) {\n\t\tll k = m / (p + q);\n\t\tres = min({ m,abs(m - min(k,n)*(p + q)),abs(min((k + 1),n)*(p + q) - m )});\n\t}else {\n\t\tll N = min(40LL, n);\n\t\tvector<ll> dist;\n\t\tfor (int i = 0; i < N;i++) {\n\t\t\tll d = p * powmod(a, i) + q*powmod(b, i);\n\t\t\tif (d > 2 * m)break;\n\t\t\tdist.push_back(d);\n\t\t}\n\t\tint n1 = (int)dist.size() / 2;\n\t\tint n2 = (int)dist.size() - n1;\n\t\tvector<ll> L;\n\t\tfor (int i = 0; i < (1 << n1);i++) {\n\t\t\tll T = 0;\n\t\t\tfor (int j = 0; j < n1;j++) {\n\t\t\t\tif ((i >> j) & 1) {\n\t\t\t\t\tT += dist[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (T > 2 * m)continue;\n\t\t\tL.push_back(T);\n\t\t}\n\t\tsort(L.begin(), L.end());\n\t\tfor (int i = 0; i < (1 << n2);i++) {\n\t\t\tll T = 0;\n\t\t\tfor (int j = 0; j < n2;j++) {\n\t\t\t\tif ((i >> j) & 1) {\n\t\t\t\t\tT += dist[n1 + j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (T > 2 * m)continue;\n\t\t\tauto it = lower_bound(L.begin(), L.end(), m - T);\n\t\t\tif(it != L.end())res = min(res, abs(m - T - *it));\n\t\t\tif (it != L.begin()) res = min(res, abs(m - T - *(it - 1)));\n\t\t}\n\t}\n\tcout << res << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cassert>\n#include<climits>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\ntypedef long long ll;\n\nvector<ll> generate(vector<ll> a){\n  vector<ll> ret;\n  int n = a.size();\n  rep(i,(1<<n)){\n    ll tmp = 0;\n    rep(j,n){\n      if ((1<<j)&i)tmp += a[j];\n    }\n    ret.push_back(tmp);\n  }\n  sort(ret.begin(),ret.end());\n  return ret;\n}\n\nll bs(ll m,ll sum,vector<ll> &a,bool fg){\n  int ret = -1;\n  int l = 0,r = a.size()-1;\n  while(l <= r){\n    int mid = (l+r)/2;\n    ll tmp = sum + a[mid];\n    if (fg){\n      if (tmp <= m){//ä¸éããã£ã¨ä¸ããã\n\tret = mid;\n\tl = mid+1;\n      }else {\n\tr = mid-1;\n      }\n    }else {\n      if (tmp >= m){\n\tret = mid;\n\tr = mid-1;\n      }else {\n\tl = mid+1;\t\n      }\n    }\n  }\n\n  /*  cout <<\"dbg\" << endl;\n  rep(i,a.size())cout << a[i] <<\" \" ;cout << endl;\n  cout <<fg <<\" \" <<  m <<\" \" << sum <<\" \" << (ret != -1?a[ret]:-1) <<\" \" << \n    ((ret != -1)?sum+a[ret]:-1)\n       << endl;\n  */\n  if (ret == -1)return llabs(m-sum);\n  return llabs(m-(sum+a[ret]));\n}\n\nll ans;\nvoid search(int n,int now,ll sum,int m,vector<ll> &a,vector<ll> &all){\n  //ub,sumã¨aã®è¦ç´ ã§ãmä»¥ä¸ã§æå¤§ã®ãã®ãæ¢ã\n  //lb,sumã¨aã®è¦ç´ ã®åã§mä»¥ä¸æå°ã®ãã®ãæ¢ã\n  ll ub=bs(m,sum,all,true),lb=bs(m,sum,all,false);\n  ans = min(ans,ub);\n  ans = min(ans,lb);\n  if (now == n)return;\n  //ä½¿ã\n  search(n,now+1,sum+a[now],m,a,all);\n  //ä½¿ããªã\n  search(n,now+1,sum,m,a,all);\n}\n\n/*\n  ååå¨åæãã ãã¡ã¢ãªç¯ç´ãããã®ã§å¾ãååã¯æ¢ç´¢ããã\n */\nll solve2(vector<ll> in,ll m){\n  vector<ll> mae,usiro;\n  rep(i,in.size()){\n    if (i < in.size()/2)mae.push_back(in[i]);\n    else usiro.push_back(in[i]);\n  }\n  vector<ll> all=generate(mae);\n  ans = m;\n  search(usiro.size(),0,0,m,usiro,all);\n  return ans;\n}\n\nll solve(ll n,ll m,ll a,ll b,ll p,ll q){\n  if (a == 1 && b == 1){//ç¹æ®ã±ã¼ã¹\n    assert(false);\n    ll sum = p+q;\n    ll lb = min(n,m/sum),ub=min(n,(m+sum-1)/sum);\n    ll ret = m;\n    if (lb <= n){\n      ret = min(ret,llabs(m-lb*(sum)));\n    }\n    if (ub <= n){\n      ret = min(ret,llabs(m-ub*(sum)));\n    }\n    return ret;\n  }\n\n  //ãã±ããã®çæ\n  //ä¸å¿doubleåã§å¤ã¯åãæ±ã£ã¦ããã\n  //å¿è¦ãªãã±ããã¯æå¤§ï¼ï¼æã§ãããä»¥ä¸ã¯æå³ããªãã\n  int loop = 0;\n  ll cur = p + q;\n  ll mula=1,mulb=1;\n  double m_d=m;\n  double cur_d = p+q;\n  double mula_d = 1, mulb_d = 1;\n  vector<ll> all;\n  all.push_back(cur);\n  while(cur_d <= m_d && loop < n){\n    mula *= a;\n    mulb *= b;\n    cur = p*mula + q*mulb;\n    all.push_back(cur);\n\n    mula_d *= a;\n    mulb_d *= b;\n    cur_d = p*mula_d + q*mulb_d;\n  }\n  //rep(i,all.size())cout << all[i] <<\" \" ;cout << endl;\n\n  if (all.size() == 1){//ä¸ã¤ããä½¿ãããã±ããããªããªããããç­ãã«ããã(å¿ãï¼æã¯ãããã¨ãä¿è¨¼ããã¦ãã)\n    return min(m,llabs(all[0]-m));\n  }\n  return solve2(all,m);\n}\n\nmain(){\n  ll n,m,a,b,p,q;\n  while(cin>>n>>m>>a>>b>>p>>q && n){\n    cout << solve(n,m,a,b,p,q)  << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define X begin()\n#define Y end()\n#define N 41\nusing namespace std;\ntypedef long long ll;\nll n,m,a,b,p,q,d[N];\nvector<ll> v[2],x[2];\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll ans=m; p+=q;\n  if(a==1&&b==1){\n    ll ti=min(n,m/p);\n    ans=min(ans,min(m-ti*p,abs(min(ti+1,n)*p-m)));\n  }\n  ll A=1,B=1,T=min((ll)N,n);\n  for(int i=0;i<T;i++){\n    d[i]=p*A+q*B;\n    if(i<T/2)v[0].push_back(d[i]);\n    else v[1].push_back(d[i]);\n    if(d[i]>m)break;\n    A*=a,B*=b;\n  }\n  int len[2]={v[0].size(),v[1].size()};\n  for(int i=0;i<2;i++){\n    v[i].push_back(0);\n    for(int j=0;j<(1<<len[i]);j++){\n      ll sum=0;\n      for(int k=0;k<len[i];k++)\n\tif((j&(1<<k)))sum+=v[i][k];\n      x[i].push_back(sum);\n    }\n    sort(x[i].X,x[i].Y);\n  }\n  for(int i=0;i<x[0].size();i++){\n    ll S=m-x[0][i];\n    vector<ll>::iterator r=lower_bound(x[1].X,x[1].Y,S);\n    if(r!=x[1].Y)ans=min(ans,(*r)-S);\n    if(r!=x[1].X)ans=min(ans,S-(*(r-1)));\n  }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <vector>\n#include <algorithm>\n\n#define show(x) cerr << #x << \" = \" << x << endl\n\nusing namespace std;\nusing ld = long double;\nusing ll = long long;\n\ntemplate <typename T>\nostream& operator<<(ostream& os, const vector<T>& v)\n{\n    os << \"[\";\n    for (const auto& e : v) {\n        os << e << \",\";\n    }\n    os << \"] \";\n    os << \"size = \" << v.size() << endl;\n    return os;\n}\n\nint main()\n{\n    ll n, m, a, b, p, q;\n    cin >> n >> m >> a >> b >> p >> q;\n\n    if (p + q > m) {\n        cout << min(m, p + q - m) << endl;\n    } else if (a == 1 and b == 1) {\n        ll nearest = m / (p + q);\n        if (m - (p + q) * nearest > (p + q) * (nearest + 1) - m) {\n            nearest++;\n        }\n        if (nearest > n) {\n            cout << m - (p + q) * n << endl;\n        } else {\n            cout << (p + q) * nearest - m << endl;\n        }\n\n\n    } else {\n        ll k = 0;\n        ll A = 1;\n        ll B = 1;\n        vector<ll> value;\n        for (; p * A + q * B <= m and k <= n; k++) {\n            value.push_back(p * A + q * B);\n            A *= a;\n            B *= b;\n        }\n        n = k;\n        const ll former = n / 2;\n        const ll latter = n - former;\n        const ll fmax = 1 << former;\n        const ll lmax = 1 << latter;\n\n        vector<ll> fsum(fmax, 0LL);\n        for (ll i = 0; i < fmax; i++) {\n            for (ll j = 0; j < former; j++) {\n                if (i & (1LL << j)) {\n                    fsum[i] = fsum[i - (1LL << j)] + value[j];\n                    break;\n                }\n            }\n        }\n        vector<ll> lsum(lmax, 0LL);\n        for (ll i = 0; i < lmax; i++) {\n            for (ll j = 0; j < latter; j++) {\n                if (i & (1LL << j)) {\n                    lsum[i] = lsum[i - (1LL << j)] + value[former + j];\n                    break;\n                }\n            }\n        }\n        sort(lsum.begin(), lsum.end());\n        constexpr ll INF = 1LL << 60;\n        ll error = INF;\n        for (ll f : fsum) {\n            const ll res = m - f;\n            if (res <= 0) {\n                error = min(error, -res);\n            } else {\n                auto it = lower_bound(lsum.begin(), lsum.end(), res);\n                if (it != lsum.end()) {\n                    error = min(error, abs(res - (*it)));\n                }\n                it--;\n                error = min(error, abs(res - (*it)));\n            }\n        }\n        cout << error << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <vector>\n#include <algorithm>\n\n#define rep(i,n) for(int i = 0; i < n; ++i)\nusing namespace std;\n\nusing ll = long long;\nusing R = long double;\n\nint main(void){\n\tll n,m,a,b,p,q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\n\tif(a == 1 and b == 1){\n\t\tll ticket = p + q;\n\t\tconst ll used = min(n,m/ticket);\n\t\tconst ll ans = min(abs(m - ticket * used),abs(m - ticket * (used+1)));\n\t\tcout << ans << endl;\n\t\treturn 0;\n\t}\n\n\tvector<ll> ticket;\n\tn = min(n,40LL);\n\n\trep(i,n){\n\t\tll cur = p * pow<ll>(a,i) + q * pow<ll>(b,i);\n\t\tif(1.0 * p * pow<R>(a,i) + 1.0 * q * pow<R>(b,i) > 1e18) break;\n\t\tticket.push_back(cur);\n\t\tif(cur > m) break;\n\t}\n\n\tn = ticket.size();\n\n\tvector<ll> item[2];\n\tconst ll half[2] = {n/2,n-n/2};\n\tconst ll offset[2] = {0,n/2};\n\n\trep(k,2)rep(mask,1 << half[k]){\n\t\tll cur = 0LL;\n\t\trep(i,half[k]) if(mask & (1 << i)) cur += ticket[i+offset[k]];\n\t\titem[k].push_back(cur);\n\t}\n\n\t\n\tll ans = m;\n\tsort(begin(item[1]),end(item[1]));\n\t\n\tfor(auto &it:item[0]){\n\t\tconst ll arg = m - it;\n\t\tauto it2 = upper_bound(begin(item[1]),end(item[1]),arg);\n\n\t\tif(it2 != end(item[1])) ans = min(ans, abs(m - it - *it2));\n\t\tit2--;\n\t\tans = min(ans, m - it - *it2);\n\t}\n\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nbool ch(int a,int b){\n  int x=1000000000000000LL;\n  x/=a;\n  x/=b;\n  return x==0;\n}\nsigned main(){\n  int n,m,a,b,p,q;\n  cin>>n>>m>>a>>b>>p>>q;\n  if(a==1&&b==1){\n    //cout<<m%(p+q)<<endl;\n    if(ch(n,p+q)) cout<<min(m%(p+q),m-m%(p+q))<<endl;\n    else{\n      int t=n*(p+q);\n      if(m>=t) cout<<m-t<<endl;\n      else cout<<min(m%(p+q),m-m%(p+q))<<endl;\n    }\n    return 0;\n  }\n  int ans=m;\n  int ta=1,tb=1;\n  vector<int> v;\n  for(int i=0;i<n;i++){\n    if(ch(p,ta)) break;\n    if(ch(q,tb)) break;\n    int t=p*ta+q*tb;\n    //cout<<t<<endl;\n    if(t<=m) v.push_back(t);\n    else{\n      ans=min(ans,t-m);\n      break;\n    }\n    if(ch(ta,a)) break;\n    if(ch(tb,b)) break;\n    ta*=a;tb*=b;\n  }\n  int x=v.size();\n  int y=x/2;\n  set<int> s;\n  for(int i=0;i<(1<<y);i++){\n    int t=0;\n    for(int j=0;j<y;j++) if((i>>j)&1) t+=v[j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }    \n    //cout<<t<<endl;\n    s.insert(-t);\n    ans=min(ans,m-t);\n  }\n  \n  for(int i=0;i<(1<<(x-y));i++){\n    int t=0;\n    for(int j=0;j<(x-y);j++) if((i>>j)&1) t+=v[y+j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }\n    //cout<<t<<endl;\n    ans=min(ans,m-t);\n    int u=t-m;\n    int k=*s.lower_bound(u);\n    ans=min(ans,m-(t-k));\n  }\n  \n  s.clear();\n  for(int i=0;i<(1<<y);i++){\n    int t=0;\n    for(int j=0;j<y;j++) if((i>>j)&1) t+=v[j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }    \n    //cout<<t<<endl;\n    s.insert(t);\n    ans=min(ans,m-t);\n  }\n  \n  int inf=m*2;\n  s.insert(inf);\n  for(int i=0;i<(1<<(x-y));i++){\n    int t=0;\n    for(int j=0;j<(x-y);j++) if((i>>j)&1) t+=v[y+j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }\n    //cout<<t<<endl;\n    ans=min(ans,m-t);\n    int v=m-t;\n    int l=*s.lower_bound(v);\n    if(l!=inf) ans=min(ans,(t+l)-m);\n  }\n  //assert(ans>=0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s, B;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\n\tif (a == 1 && b == 1) {\n\t\tif (n >= 100000000) { goto F; }\n\t\tif (m <= n * (p + q)) {\n\t\tF:;\n\t\t\tB = m % (p + q);\n\t\t\tif (B > (p + q) / 2) {\n\t\t\t\tB = (p + q) - B;\n\t\t\t}\n\t\t\tcout << B << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << m - (long long)(n * (p + q)) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = m;\n\td = s;\nE:;\n\trem = m - c[d - 1];\n\tminx = min(minx, abs(rem));\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<set>\n#include<cstdlib>\n#include<vector>\n#include<algorithm>\n\nusing namespace std;\n\nlong long n,m,a,b,p,q;\n\nlong long mul(long long a,long long b){\n  __int128 r=a;\n  r*=b;\n  if(r>1e18)throw 0;\n  return r;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  if(a==1&&b==1){\n    long long c=m/(p+q);\n    cout<<min(m-min(n,c)*(p+q),llabs(min(n,c+1)*(p+q)-m))<<endl;\n  }else{\n    long long t[55]={};\n    t[0]=p+q;\n    long long ak=1,bk=1;\n    try{\n      for(int i=1;i<min(n,42ll);i++){\n\tak=mul(ak,a);\n\tbk=mul(bk,b);\n\tt[i]=mul(p,ak)+mul(q,bk);\n      }\n    }catch(...){\n    }\n    vector<long long> s(1<<21);\n    for(int i=0;i<1<<21;i++){\n      long long c=0;\n      for(int j=0;j<21;j++){\n\tc+=(i>>j&1)*t[j+21];\n      }\n      s[i]=c;\n    }\n    sort(begin(s),end(s));\n    s.erase(unique(begin(s),end(s)),end(s));\n    long long ans=1e18;\n    for(int i=0;i<1<<21;i++){\n      long long c=0;\n      for(int j=0;j<21;j++){\n\tc+=(i>>j&1)*t[j];\n      }\n      auto it=lower_bound(begin(s),end(s),m-c);\n      if(it!=s.end()){\n\tans=min(ans,llabs(m-*it-c));\n      }\n      if(it!=s.begin()){\n\tit--;\n\tans=min(ans,llabs(m-*it-c));\n      }\n    }\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\nusing namespace std;\n\nlong long int atime(const long long int l, const long long int r) {\n\tif (l > LLONG_MAX / r) {\n\t\treturn LLONG_MAX;\n\t}\n\telse {\n\t\treturn l*r;\n\t}\n}\nlong long int powint(long long int a, long long int b) {\n\tif (!b)return 1;\n\telse {\n\t\treturn atime(a, powint(a, b - 1));\n\t}\n}\n\nlong long int aplus(const long long int l, const long long int r) {\n\tif (l > LLONG_MAX / 3 || r > LLONG_MAX)return LLONG_MAX;\n\telse return l + r;\n}\n\nvoid getans(const vector<long long int>& sums,const vector<long long int>&tickets, const int now, long long int &ans,const long long int rest) {\n\tif (now == tickets.size()) {\n\t\tans = min(ans, rest);\n\t\treturn;\n\t}\n\tif (ans < rest - sums[now])return;\n\t\n\tif (rest >= tickets[now]) {\n\t\tgetans(sums, tickets, now + 1, ans, rest - tickets[now]);\n\t}\n\telse {\n\t\tans = min(ans, tickets[now] - rest);\n\t}\n\tgetans(sums, tickets, now + 1, ans, rest);\n}\nint main() {\n\tlong long int N, M, A, B, P, Q; \n\tcin >> N >> M >> A >> B >> P >> Q;\n\tif (A > B) {\n\t\tswap(A, B);\n\t\tswap(P, Q);\n\t}\n\tassert(A <= B);\n\tif (A == 1 && B == 1) {\n\t\tlong long int ticdis = P + Q;\n\t\tif (atime(ticdis,N) <= M) {\n\t\t\tcout << M - atime(ticdis, N) << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << min(ticdis-M%ticdis,M%ticdis) << endl;\n\t\t}\n\t}\n\telse {\n\t\tvector<long long int>tickets;\n\t\tlong long\tint ans = M;\n\t\tfor (int k = 0; k < N; ++k) {\n\t\t\tlong long int tic =aplus( atime(P, powint(A, k)), atime(Q, powint(B, k)));\n\t\t\tif (tic > M) {\n\t\t\t\tans = min(ans, tic - M);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttickets.emplace_back(tic);\n\t\t\t}\n\t\t}\n\t\treverse(tickets.begin(), tickets.end());\n\t\tvector<long long int>sums(tickets);\n\t\tfor (int i = sums.size()-1; i >0; --i) {\n\t\t\tsums[i - 1] += sums[i];\n\t\t}\n\t\tgetans(sums, tickets, 0, ans, M);\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll _pow(ll a, ll n) {\n\tif(n == 0) return 1;\n\telse {\n\t\tll res = 1;\n\t\tll buf = a;\n\t\twhile(n > 0) {\n\t\t\tif(n % 2 == 1) {\n\t\t\t\tres *= buf;\n\t\t\t}\n\t\t\tbuf *= buf;\n\t\t\tn /= 2;\n\t\t}\n\t\treturn res;\n\t}\n}\n\nvoid solve() {\n\tll n, m, a, b, p, q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\tif(n == 1) {\n\t\tif(p + q > m) cout << m << endl;\n\t\telse cout << m - (p + q) << endl;\n\t\treturn;\n\t}\n\tll c = max(a, b);\n\tif(c == 1) {\n\t\tif((p + q) * n > m) {\n\t\t\tcout << min(m - m / (p + q) * (p + q), m - (m / (p + q) + 1) * (p + q))<< endl;\n\t\t} else cout << m - (p + q) * n << endl;\n\t} else if(c == 2 || c == 3) {\n\t\tll _n = 0;\n\t\tif(c == 2) _n = min(41LL, n);\n\t\tif(c == 3) _n = min(29LL, n);\n\t\tll div1 = n / 2;\n\t\tll div2 = n - div1;\n\t\tvector<ll> d1;\n\t\tvector<ll> d2;\n\t\tREP(bit, (1ll << div1)) {\n\t\t\tbitset<31> bi(bit);\n\t\t\tll sum = 0;\n\t\t\tREP(i, div1) if(bi[i]) sum += p * _pow(a, i) + q * _pow(b, i);\n\t\t\td1.pb(sum);\n\t\t}\n\t\tREP(bit, (1ll << div2)) {\n\t\t\tbitset<31> bi(bit);\n\t\t\tll sum = 0;\n\t\t\tREP(i, div2) if(bi[i]) sum += p * _pow(a, div1 + i) + q * _pow(b, div1 + i);\n\t\t\td2.pb(sum);\n\t\t}\n\t\tsort(ALL(d1));\n\t\tsort(ALL(d2));\n\t\tll ans = m;\n\t\tREP(i, d1.size()) {\n\t\t\tauto ite = upper_bound(ALL(d2), m - d1[i]);\n\t\t\tif(ite != d2.end()) ans = min(ans, (d1[i] + *ite) - m);\n\t\t\tif(ite == d2.begin()) continue;\n\t\t\tite--;\n\t\t\tans = min(ans, m - (d1[i] + *ite));\n\t\t}\n\t\tcout << ans << endl;\n\t} else /* c >= 4 */ {\n\t\tvector<ll> num;\n\t\tnum.pb(0);\n\t\tnum.pb(p + q);\n\t\tREP(i, 23) {\n\t\t\tif(1000000000007LL / (ld)_pow(c, i) < c) break;\n\t\t\tll val = p * _pow(a, i + 1) + q * _pow(b, i + 1); \n\t\t\tvector<ll> nnum = num;\n\t\t\tREP(j, num.size()) nnum.pb(num[j] + val);\n\t\t\tnum = nnum;\n\t\t}\n\t\tUNIQUE(num);\n\t\tll ans = INF*INF;\n\t\tREP(i, num.size()) ans = min(ans, abs(m - num[i]));\n\t\tcout << ans << endl;\n\t}\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tsolve();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cassert>\n#include<climits>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\ntypedef long long ll;\n\nvector<ll> generate(vector<ll> a){\n  vector<ll> ret;\n  int n = a.size();\n  rep(i,(1<<n)){\n    ll tmp = 0;\n    rep(j,n){\n      if ((1<<j)&i)tmp += a[j];\n    }\n    ret.push_back(tmp);\n  }\n  sort(ret.begin(),ret.end());\n  return ret;\n}\n\nll bs(ll m,ll sum,vector<ll> &a,bool fg){\n  int ret = -1;\n  int l = 0,r = a.size()-1;\n  while(l <= r){\n    int mid = (l+r)/2;\n    ll tmp = sum + a[mid];\n    if (fg){\n      if (tmp <= m){//ä¸éããã£ã¨ä¸ããã\n\tret = mid;\n\tl = mid+1;\n      }else {\n\tr = mid-1;\n      }\n    }else {\n      if (tmp >= m){\n\tret = mid;\n\tr = mid-1;\n      }else {\n\tl = mid+1;\t\n      }\n    }\n  }\n\n  /*  cout <<\"dbg\" << endl;\n  rep(i,a.size())cout << a[i] <<\" \" ;cout << endl;\n  cout <<fg <<\" \" <<  m <<\" \" << sum <<\" \" << (ret != -1?a[ret]:-1) <<\" \" << \n    ((ret != -1)?sum+a[ret]:-1)\n       << endl;\n  */\n  if (ret == -1)return llabs(m-sum);\n  return llabs(m-(sum+a[ret]));\n}\n\nll ans;\nvoid search(int n,int now,ll sum,int m,vector<ll> &a,vector<ll> &all){\n  //ub,sumã¨aã®è¦ç´ ã§ãmä»¥ä¸ã§æå¤§ã®ãã®ãæ¢ã\n  //lb,sumã¨aã®è¦ç´ ã®åã§mä»¥ä¸æå°ã®ãã®ãæ¢ã\n  ll ub=bs(m,sum,all,true),lb=bs(m,sum,all,false);\n  ans = min(ans,ub);\n  ans = min(ans,lb);\n  if (now == n)return;\n  //ä½¿ã\n  search(n,now+1,sum+a[now],m,a,all);\n  //ä½¿ããªã\n  search(n,now+1,sum,m,a,all);\n}\n\n/*\n  ååå¨åæãã ãã¡ã¢ãªç¯ç´ãããã®ã§å¾ãååã¯æ¢ç´¢ããã\n */\nll solve2(vector<ll> in,ll m){\n  vector<ll> mae,usiro;\n  rep(i,in.size()){\n    if (i < in.size()/2)mae.push_back(in[i]);\n    else usiro.push_back(in[i]);\n  }\n  vector<ll> all=generate(mae);\n  ans = m;\n  search(usiro.size(),0,0,m,usiro,all);\n  return ans;\n}\n\nll solve(ll n,ll m,ll a,ll b,ll p,ll q){\n  if (a == 1 && b == 1){//ç¹æ®ã±ã¼ã¹\n    assert(false);\n    ll sum = p+q;\n    ll lb = min(n,m/sum),ub=min(n,(m+sum-1)/sum);\n    ll ret = m;\n    ret = min(ret,llabs(m-lb*(sum)));\n    ret = min(ret,llabs(m-ub*(sum)));\n    return ret;\n  }\n\n  //ãã±ããã®çæ\n  //ä¸å¿doubleåã§å¤ã¯åãæ±ã£ã¦ããã\n  //å¿è¦ãªãã±ããã¯æå¤§ï¼ï¼æã§ãããä»¥ä¸ã¯æå³ããªãã\n  int loop = 0;\n  ll cur = p + q;\n  ll mula=1,mulb=1;\n  double m_d=m;\n  double cur_d = p+q;\n  double mula_d = 1, mulb_d = 1;\n  vector<ll> all;\n  all.push_back(cur);\n  while(cur_d <= m_d && loop < n){\n    mula *= a;\n    mulb *= b;\n    cur = p*mula + q*mulb;\n    all.push_back(cur);\n\n    mula_d *= a;\n    mulb_d *= b;\n    cur_d = p*mula_d + q*mulb_d;\n  }\n  //rep(i,all.size())cout << all[i] <<\" \" ;cout << endl;\n\n  if (all.size() == 1){//ä¸ã¤ããä½¿ãããã±ããããªããªããããç­ãã«ããã(å¿ãï¼æã¯ãããã¨ãä¿è¨¼ããã¦ãã)\n    return min(m,llabs(all[0]-m));\n  }\n  return solve2(all,m);\n}\n\nmain(){\n  return 0;\n  ll n,m,a,b,p,q;\n  while(cin>>n>>m>>a>>b>>p>>q && n){\n    cout << solve(n,m,a,b,p,q)  << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll N=0;\nll n,m,a,b,p,q;\n\nll calc(ll k){\n  ll A = 1,B = 1;\n  while(k--)A*=a,B*=b;\n  return p*A+q*B;\n}\n\n\nll ans = 1LL<<60;\ntypedef pair<ll,ll> P;\nset<P> used;\n\nvoid dfs(ll pos,ll sum){\n  if(pos>=n||pos==N+2||sum<0LL) return;\n  if(used.count(P(pos,sum))) return ;\n  used.insert(P(pos,sum));\n  ans = min(ans,(ll)abs(m-sum));\n  \n  dfs(pos+1,sum);\n  dfs(pos+1,sum+calc(pos));\n}\n\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll t = m,d = max(a,b);\n  while(t) t/=d,N++;\n  dfs(0,0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cassert>\n#include <typeinfo>\n#include <vector>\n#include <stack>\n#include <cmath>\n#include <set>\n#include <map>\n#include <string>\n#include <algorithm>\n#include <cstdio>\n#include <queue>\n#include <iomanip>\n#include <cctype>\n#include <random>\n#include <complex>\n#define syosu(x) fixed<<setprecision(x)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> P;\ntypedef pair<double,double> pdd;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<char> vc;\ntypedef vector<vc> vvc;\ntypedef vector<string> vs;\ntypedef vector<bool> vb;\ntypedef vector<vb> vvb;\ntypedef vector<P> vp;\ntypedef vector<vp> vvp;\ntypedef vector<pll> vpll;\ntypedef pair<int,P> pip;\ntypedef vector<pip> vip;\nconst int inf=1<<29;\nconst ll INF=1ll<<60;\nconst double pi=acos(-1);\nconst double eps=1e-7;\nconst ll mod=1e9+7;\nconst int dx[4]={0,1,0,-1},dy[4]={1,0,-1,0};\n\nll n,m,a,b,p,q;\n\nint main(){\n\tcin>>n>>m>>a>>b>>p>>q;\n\tvl x;\n\tbool B=0;\n\tdo{\n\t\tif(p+q>m) B=1;\n\t\tx.push_back(p+q);\n\t\tif(INF/p>a) p*=a;\n\t\telse break;\n\t\tif(INF/q>b) q*=b;\n\t\telse break;\n\t}while(!B);\n\tint S=x.size(),S2=S/2,T=S-S2;\n\tvl c(1<<S2);\n\tfor(int i=0;i<1<<S2;i++){\n\t\tfor(int j=0;j<S2;j++) if(i&1<<j) c[i]+=x[j];\n\t}\n\tsort(c.begin(),c.end());\n\tll res=INF;\n\tfor(int i=0;i<1<<T;i++){\n\t\tll tmp=0;\n\t\tfor(int j=0;j<T;j++) if(i&1<<j) tmp+=x[S2+j];\n\t\tauto it=lower_bound(c.begin(),c.end(),m-tmp);\n\t\tif(it!=c.end()) res=min(res,abs(m-tmp-*it));\n\t\tif(it!=c.begin()) res=min(res,abs(m-tmp-*(it-1)));\n\t}\n\tcout<<res<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (int)(k); i < (int)(n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\n\nll pow(ll x, ll n)\n{\n\tll res = 1;\n\twhile (n > 0)\n\t{\n\t\tif (n & 1) res = res * x;\n\t\tx = x*x;\n\t\tn >>= 1;\n\t}\n\treturn res;\n}\n\nll n, m, a, b, p, q;\n\nll calc(ll k)\n{\n\treturn p * pow(a, k) + q * pow(b, k);\n}\n\nbool check(ld k)\n{\n\treturn p * pow(a, k) + q * pow(b, k) <= pow(10, 12);\n}\n\nll use(ll d)\n{\n\tll loop = min(n + 1, 42ll);\n\tREP(i, loop)\n\t{\n\t\tif (!check(i))\n\t\t{\n\t\t\treturn i - 1;\n\t\t}\n\t\tif (calc(i) > d) return i - 1;\n\t}\n}\n\nint main()\n{\n\tcin.sync_with_stdio(false); cout << fixed << setprecision(10);\n\tcin >> n >> m >> a >> b >> p >> q;\n\tll ans = LLONG_MAX;\n\tif (a == 1 && b == 1)\n\t{\n\t\tif ((p + q) * n < m) ans = m - (p + q) * n;\n\t\telse\n\t\t{\n\t\t\tint t = m / (p + q);\n\t\t\tans = min(m - (p + q) * t, (p + q)*(t + 1) - m);\n\t\t}\n\t}\n\telse if (a > 1 && b > 1)\n\t{\n\t\tset<int> st;\n\t\tll d = m;\n\t\tint cnt = 0, mx = n;\n\t\tint loop = min(n + 1, 41ll);\n\t\twhile (st.size() < loop)\n\t\t{\n\t\t\tll t = use(d);\n\t\t\tif (t + 1 < n && !st.count(t + 1) && d < calc(t + 1))\n\t\t\t{\n\t\t\t\tchmin(ans, calc(t + 1) - d);\n\t\t\t}\n\t\t\tif (t < 0) break;\n\t\t\tll tmp = min(n, t);\n\t\t\twhile (st.count(tmp)) tmp--;\n\t\t\td -= calc(tmp);\n\t\t\tst.insert(tmp);\n\t\t\tchmin(ans, d);\n\t\t}\n\t\tchmin(ans, d);\n\t}\n\telse\n\t{\n\t\tif (a > b) swap(a, b);\n\t\tint loop = min(n + 1, 41ll);\n\t\tREP(i, loop)\n\t\t{\n\t\t\tset<int> st;\n\t\t\tll d = m;\n\t\t\tint cnt = 0, mx = n;\n\t\t\twhile (st.size() < i)\n\t\t\t{\n\t\t\t\tll t = use(d);\n\t\t\t\tif (t < 0) break;\n\t\t\t\tll tmp = min(n - 1, t);\n\t\t\t\twhile (st.count(tmp)) tmp--;\n\t\t\t\td -= calc(tmp);\n\t\t\t\tst.insert(tmp);\n\t\t\t}\n\t\t\tif (st.size() == i - 1)\n\t\t\t{\n\t\t\t\tif (!st.count(0))\n\t\t\t\t{\n\t\t\t\t\tchmin(ans, calc(0) - d);\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse if (st.size() != i) continue;\n\t\t\tchmin(ans, d);\n\t\t\tif (st.size() > 0)\n\t\t\t{\n\t\t\t\tint last = *st.begin();\n\t\t\t\tif (last + 1 < n && !st.count(last + 1))\n\t\t\t\t{\n\t\t\t\t\td = d + calc(last) - calc(last + 1);\n\t\t\t\t\tchmin(ans, -d);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint main(){\n  long long int n, m, a, b, p, q, ans;\n  cin >> n >> m >> a >> b >> p >> q;\n  if(a < b){\n    swap(a, b);\n    swap(p, q);\n  }\n  if(a == 1){\n    cout << m - min(n, m/2)*2 << endl;\n    return 0;\n  }\n  ans = m;\n  long long int x = 1, y = 1;\n  for(int i = 1; i < n; ++i){\n    if(m <= p*x + q*y) break;\n    x *= a;\n    y *= b;\n  }\n  while(x > 0){\n    ans = min(ans, abs(m - (p*x + q*y)));\n    if(m >= p*x + q*y) m -= p*x + q*y;\n    x /= a;\n    y /= b;\n  }\n  cout << ans << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 1LL<<53;\nll Sum[100];\nll n,m,a,b,p,q;\n\n\nll calc(ll k){\n  ll A = 1,B = 1;\n  ll res=p+q;\n  while(0<res&&res<=INF&&k--)A*=a,B*=b,res=p*A+q*B;\n  if(res<0||res>INF)res=INF;\n  return res;\n}\n\n\nll ans = INF;\nset<ll> used[101];\nvoid dfs(ll pos,ll sum){\n  ans = min(ans,(ll)abs(m-sum));\n  if(m<sum||pos==-1||sum<0LL||sum>INF) return;\n  if(Sum[pos]+sum<m){ans=min(ans,m-(Sum[pos]+sum));return;}\n  if(used[pos].count(sum)) return ;\n  used[pos].insert(sum);\n  dfs(pos-1,sum+calc(pos));  \n  dfs(pos-1,sum);\n}\n\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  for(int i=0;i<60;i++) Sum[i] = INF;\n  Sum[0] = calc(0);\n  for(int i=1;i<60;i++)Sum[i]=min(INF,calc(i)+Sum[i-1]);\n\n  if(max(a,b)==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - (p+q));\n    if(m/(p+q)==n) t = INF;\n    if(m/(p+q)<=n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n  }\n  \n  dfs(min(n-1,50LL),0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=__int128;\n\nusing ll2=long long;\n\nconst ll INF=1e15;\n\nll powi(ll x,ll k){\n    ll res=1;\n    while(k){\n        if(k&1) res*=x;\n        if(res>INF) return INF;\n        x*=x;\n        k>>=1;\n    }\n    return res;\n}\nint main(){\n    ll2 nn,mm,aa,bb,pp,qq;\n    cin>>nn>>mm>>aa>>bb>>pp>>qq;\n    ll n=nn,m=mm,a=aa,b=bb,p=pp,q=qq;\n    if(a>=2 || b>=2){\n        int tn=min(n,ll(44));\n        int half=tn/2;\n        vector<ll> vec(1<<half);\n        for(int i=0;i<(1<<half);i++){\n            ll val=0;\n            for(int j=0;j<half;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,j)+q*powi(b,j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            vec[i]=val;\n\n        }\n        int rest=tn-half;\n        set<ll> s;\n        for(int i=0;i<(1<<rest);i++){\n            ll val=0;\n            for(int j=0;j<rest;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,half+j)+q*powi(b,half+j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            s.insert(val);\n        }\n        ll2 res=m;\n        for(int i=0;i<vec.size();i++){\n            auto it=s.lower_bound(m-vec[i]);\n            if(it!=s.end()){\n        \n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n            if(it!=s.begin()){\n                it--;\n\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n        }\n        cout<<res<<endl;\n    }\n    else{\n        if((p+q)*n>=m){\n            cout<<ll2(min(m%(p+q),(p+q)-m%(p+q)))<<endl;\n        }\n        else{\n            cout<<ll2(m-(p+q)*n)<<endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 1LL<<50;\nll Sum[100];\nll n,m,a,b,p,q;\n\n\nll calc(ll k){\n  static ll used[101]={},mem[101]={};\n  if(used[k]++) return mem[k];\n  ll A = 1,B = 1;\n  ll &res =mem[k]=p+q;\n  while(0<res&&res<=INF&&k--)A*=a,B*=b,res=p*A+q*B;\n  if(res<0||res>INF)res=0;\n  return res;\n}\n\n\nll ans = INF;\nset<ll> used[101];\nvoid dfs(ll pos,ll sum){\n  if(sum<0LL||sum>INF) return;\n  ans = min(ans,(ll)abs(m-sum));\n  if(pos==-1)return;\n  if(Sum[pos]>0&&Sum[pos]+sum<m){ans=min(ans,m-(Sum[pos]+sum));return;}\n  if(m<sum) return;\n  if(used[pos].count(sum)) return ;\n  used[pos].insert(sum);\n  \n  ll r = calc(pos);\n  if(r>0)dfs(pos-1,sum+r);  \n  dfs(pos-1,sum);\n}\n\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  Sum[0] = calc(0);\n  for(int i=1;i<50;i++) if(calc(i)>0)Sum[i] = calc(i)+Sum[i-1];\n  if(max(a,b)==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - (p+q));\n    if(m/(p+q)==n) t = INF;\n    if(m/(p+q)<=n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n  }\n  \n  dfs(50,0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb push_back\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\ntypedef vector<int>vint;\ntypedef pair<int,int>pint;\ntypedef vector<pint>vpint;\n\ntemplate<typename A,typename B>inline void chmin(A &a,B b){if(a>b)a=b;}\ntemplate<typename A,typename B>inline void chmax(A &a,B b){if(a<b)a=b;}\n\nint N,M,A,B,P,Q;\n\nvoid dfs(int k,int n,int s,vint &v,vint &latte){\n    if(k==n){\n        latte.pb(s);\n        return;\n    }\n    dfs(k+1,n,s,v,latte);\n    dfs(k+1,n,s+v[k],v,latte);\n}\n\nsigned main(){\n    cin>>N>>M>>A>>B>>P>>Q;\n\n    if(A==1&&B==1){\n        P+=Q;\n        int ans=M;\n        if(M/P>N)chmin(ans,abs(M-P*N));\n        else{\n            chmin(ans,abs(M-M/P*P));\n            if(M/P+1<=N)chmin(ans,abs(M-M/P*P-P));\n        }\n        cout<<ans<<endl;\n        return 0;\n    }\n    vector<int>v;\n    int x=P,y=Q;\n    for(int i=0;i<N;i++){\n        v.pb(x+y);\n        if(1.0*x*A>1e15||1.0*y*B>1e15)break;\n        x*=A;y*=B;\n    }\n\n    int n=v.size()/2;\n    vint latte,malta;\n    dfs(0,n,0,v,latte);\n    dfs(n,v.size(),0,v,malta);\n    sort(all(latte));\n    sort(all(malta));\n\n\n    int ans=M;\n\n    int cur=latte.size()-1;\n    for(int i=0;i<malta.size();i++){\n        while(cur&&latte[cur]+malta[i]>M)cur--;\n        chmin(ans,abs(M-latte[cur]-malta[i]));\n    }\n\n    cur=0;\n    for(int i=(int)malta.size()-1;i>=0;i--){\n        while(cur+1!=latte.size()&&latte[cur]+malta[i]<M)cur++;\n        chmin(ans,abs(M-latte[cur]-malta[i]));\n    }\n\n    cout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing ll = long long;\n\nconstexpr ll inf = 1e18;\n\nll mul(ll a, ll b) {\n    if(a > inf / b) return inf;\n    return a * b;\n}\n\nll mypow(ll x, ll n) {\n    ll res = 1;\n    while(n > 0) {\n        if(n & 1) {\n            res = mul(res, x);\n        }\n        x = mul(x, x);\n        n >>= 1;\n    }\n    return res;\n}\n\nll solve(ll n, ll m, ll a, ll b, ll p, ll q) {\n    if(a == 1 && b == 1) {\n        const ll t = (p + q);\n        ll sum = mul(t, n);\n        if(sum <= m) return m - sum;\n        return min(m % t, t - m % t);\n    }\n\n    vector<ll> s1, s2, t1, t2;\n    for(int i = 0; i < min(n, 40LL); ++i) {\n        (i & 1 ? s1 : s2).push_back(mul(mypow(a, i), p) + mul(mypow(b, i), q));\n    }\n    const int sz1 = s1.size(), sz2 = s2.size();\n    for(int S = 0; S < (1 << sz1); ++S) {\n        ll sum = 0;\n        for(int i = 0; i < sz1; ++i) {\n            if(S & (1 << i)) sum = min(inf, sum + s1[i]);\n        }\n        t1.push_back(sum);\n    }\n    for(int S = 0; S < (1 << sz2); ++S) {\n        ll sum = 0;\n        for(int i = 0; i < sz2; ++i) {\n            if(S & (1 << i)) sum = min(inf, sum + s2[i]);\n        }\n        t2.push_back(sum);\n    }\n    sort(begin(t1), end(t1));\n    sort(begin(t2), end(t2));\n\n    ll res = m;\n    const int tsz2 = t2.size();\n    for(auto x1 : t1) {\n        const ll target = m - x1;\n        const int idx = lower_bound(begin(t2), end(t2), target) - begin(t2);\n        for(int i = idx - 1; i <= idx + 1; ++i) {\n            if(i < 0 || tsz2 <= i) continue;\n            res = min(res, abs(m - (x1 + t2[i])));\n        }\n    }\n\n    return res;\n}\n\nint main() {\n    ll n, m, a, b, p, q;\n    cin >> n >> m >> a >> b >> p >> q;\n\n    cout << solve(n, m, a, b, p, q) << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll N=0;\nll n,m,a,b,p,q;\n\nll calc(ll k){\n  ll A = 1,B = 1;\n  while(k--)A*=a,B*=b;\n  return p*A+q*B;\n}\n\n\nll ans = 1LL<<60;\ntypedef pair<ll,ll> P;\nset<P> used;\nvoid dfs(ll pos,ll sum){\n  if(pos>=n||pos==N+2||sum<0LL) return;\n  if(used.count(P(pos,sum))) return ;\n  used.insert(P(pos,sum));\n  ans = min(ans,(ll)abs(m-sum));\n  \n  dfs(pos+1,sum);\n  ll r = calc(pos);\n  if(r)dfs(pos+1,sum+r);\n}\n\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll t = m,d = max(a,b);\n  \n  while(d>1&&t) t/=d,N++;\n  if(d==1) {\n    if(m/(p+q)<n) cout<<m%(p+q)<<endl;\n    else cout<<  m-(p+q)*n <<endl;\n    return 0;\n  }\n  dfs(0,0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cmath>\n#include<cstdio>\n#include<vector>\n#include<algorithm>\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\tll n,m,a,b,p,q; scanf(\"%lld%lld%lld%lld%lld%lld\",&n,&m,&a,&b,&p,&q);\n\n\tll ans=m;\n\tif(a==1 && b==1){\n\t\tans=min(ans,llabs(n*(p+q)-m));\n\t\tll i=m/(p+q);\n\t\tfor(int j=-3;j<=3;j++) if(0<=i+j && i+j<=n) ans=min(ans,llabs((i+j)*(p+q)-m));\n\t}\n\telse{\n\t\tint N;\n\t\tll num[40];\n\t\tfor(int k=0;;k++){\n\t\t\tlong double tmp=p*pow(a,k)+q*pow(b,k);\n\t\t\tif(k==n || tmp>2e12){\n\t\t\t\tN=k;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tnum[k]=tmp;\n\t\t}\n\t\tif(N%2==1) num[N++]=0;\n\n\t\tvector<ll> half1,half2;\n\t\trep(S,1<<N/2){\n\t\t\tbool ok1=true,ok2=true;\n\t\t\tll sum1=0,sum2=0;\n\t\t\trep(i,N/2) if(S>>i&1) {\n\t\t\t\tsum1+=num[i];\n\t\t\t\tsum2+=num[i+N/2];\n\t\t\t\tif(sum1>2e12) ok1=false;\n\t\t\t\tif(sum2>2e12) ok2=false;\n\t\t\t}\n\t\t\tif(ok1) half1.push_back(sum1);\n\t\t\tif(ok2) half2.push_back(sum2);\n\t\t}\n\t\thalf1.push_back(0);\n\t\thalf2.push_back(0);\n\n\t\tsort(half1.begin(),half1.end());\n\t\tsort(half2.begin(),half2.end());\n\n\t\trep(i,half1.size()){\n\t\t\tint j=lower_bound(half2.begin(),half2.end(),m-half1[i])-half2.begin();\n\t\t\tif(j<half2.size()) ans=min(ans,llabs(half1[i]+half2[ j ]-m));\n\t\t\tif(j>0)            ans=min(ans,llabs(half1[i]+half2[j-1]-m));\n\t\t}\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\tll n,m,a,b,p,q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\t\n\tif(a == 1 && b == 1){\n\t\tcout << max( m%(p+q) , m-(p+q)*n ) << endl;\n\t}\n\telse {\n\t\tvector<ll> vec;\n\t\tll s = 1 , t = 1;\n\t\tfor(int i = 0 ; i < n ; i ++){\n\t\t\tif(p*s+q*t > m)break;\n\t\t\tvec.push_back(p*s+q*t);\n\t\t\ts *= a;\n\t\t\tt *= b;\n\t\t}\n\t\tint N = vec.size();\n\t\tvector<ll> A,B;\n\t\tA.push_back(0);\n\t\tfor(int i = 0 ; i < N/2 ; i ++){\n\t\t\tint x = A.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tA.push_back(vec[i]+A[j]);\n\t\t\t}\n\t\t}\n\t\tB.push_back(0);\n\t\tfor(int i = N/2 ; i < N ; i ++){\n\t\t\tint x = B.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tB.push_back(vec[i]+B[j]);\n\t\t\t}\n\t\t}\n\t\tsort(B.begin(),B.end());\n\t\tll ret = m;\n\t\tfor(int i = 0 ; i < A.size() ; i ++){\n\t\t\tint x = upper_bound(B.begin(),B.end(),m-A[i])-B.begin();\n\t\t\tx --;\n\t\t\tret = min ( ret , m-A[i]-B[x] );\n\t\t}\n\t\tcout << ret << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return min( m%d , m-(m%d) );\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        res=min( res, abs( m- ( T[i]+U[j] )) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <vector>\n#include <algorithm>\n#include <utility>\n\n#define show(x) cerr << #x << \" = \" << x << endl\n\nusing namespace std;\nusing ld = long double;\nusing ll = long long;\n\ntemplate <typename T>\nostream& operator<<(ostream& os, const vector<T>& v)\n{\n    os << \"[\";\n    for (const auto& e : v) {\n        os << e << \",\";\n    }\n    os << \"] \";\n    os << \"size = \" << v.size() << endl;\n    return os;\n}\n\nint main()\n{\n    ll n, m, a, b, p, q;\n    cin >> n >> m >> a >> b >> p >> q;\n\n    if (p + q > m) {\n        cout << min(m, p + q - m) << endl;\n    } else if (a == 1 and b == 1) {\n        ll nearest = m / (p + q);\n        if (m - (p + q) * nearest > (p + q) * (nearest + 1) - m) {\n            nearest++;\n        }\n        if (nearest > n) {\n            cout << m - (p + q) * n << endl;\n        } else {\n            cout << (p + q) * nearest - m << endl;\n        }\n\n\n    } else {\n        ll k = 0;\n        ll A = 1;\n        ll B = 1;\n        vector<ll> value;\n        for (; p * A + q * B <= m and k < n; k++) {\n            value.push_back(p * A + q * B);\n            A *= a;\n            B *= b;\n        }\n        n = k;\n        const ll former = n / 2;\n        const ll latter = n - former;\n        const ll fmax = 1 << former;\n        const ll lmax = 1 << latter;\n\n        vector<ll> fsum(fmax, 0LL);\n        for (ll i = 0; i < fmax; i++) {\n            for (ll j = 0; j < former; j++) {\n                if (i & (1LL << j)) {\n                    fsum[i] = fsum[i - (1LL << j)] + value[j];\n                    break;\n                }\n            }\n        }\n        vector<ll> lsum(lmax, 0LL);\n        for (ll i = 0; i < lmax; i++) {\n            for (ll j = 0; j < latter; j++) {\n                if (i & (1LL << j)) {\n                    lsum[i] = lsum[i - (1LL << j)] + value[former + j];\n                    break;\n                }\n            }\n        }\n        sort(lsum.begin(), lsum.end());\n        constexpr ll INF = 1LL << 60;\n        ll error = INF;\n        for (ll f : fsum) {\n            const ll res = m - f;\n            if (res <= 0) {\n                error = min(error, -res);\n            } else {\n                auto it = lower_bound(lsum.begin(), lsum.end(), res);\n                if (it != lsum.end()) {\n                    error = min(error, abs(res - (*it)));\n                }\n                it--;\n                error = min(error, abs(res - (*it)));\n            }\n        }\n        cout << error << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iomanip>\n#include<limits>\n#include<thread>\n#include<utility>\n#include<iostream>\n#include<string>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<vector>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<numeric>\n#include<cassert>\n#include<random>\n#include<chrono>\n#include<unordered_set>\n#include<unordered_map>\n#include<fstream>\n#include<list>\n#include<functional>\n#include<bitset>\n#include<complex>\n#include<tuple>\nusing namespace std;\ntypedef unsigned long long int ull;\ntypedef long long int ll;\ntypedef pair<ll,ll> pll;\ntypedef pair<int,int> pi;\ntypedef pair<double,double> pd;\ntypedef pair<double,ll> pdl;\n#define F first\n#define S second\nconst ll E=1e18+7;\nconst ll MOD=1000000007;\n\n\n\n__int128 parse(string &s) {\n    __int128 ret = 0;\n    for (int i = 0; i < s.length(); i++)\n        if ('0' <= s[i] && s[i] <= '9')\n            ret = 10 * ret + s[i] - '0';\n    return ret;\n}\n\nstd::ostream &operator<<(std::ostream &dest, __int128_t value) {\n    std::ostream::sentry s(dest);\n    if (s) {\n        __uint128_t tmp = value < 0 ? -value : value;\n        char buffer[128];\n        char *d = std::end(buffer);\n        do {\n            --d;\n            *d = \"0123456789\"[tmp % 10];\n            tmp /= 10;\n        } while (tmp != 0);\n        if (value < 0) {\n            --d;\n            *d = '-';\n        }\n        int len = std::end(buffer) - d;\n        if (dest.rdbuf()->sputn(d, len) != len) {\n            dest.setstate(std::ios_base::badbit);\n        }\n    }\n    return dest;\n}\n\n\nstd::istream &operator>>(std::istream &dest, __int128 &value) {\n    string s;\n    cin>>s;\n    value=parse(s);\n    return dest;\n}\n\ntypedef __int128 Int;\n\nint main(){\n    Int n,m,a,b,p,q;\n    cin>>n>>m>>a>>b>>p>>q;\n    if(a==1 && b==1){\n        Int sum=p+q;\n        Int M=min(m/sum,n);\n        Int ans=m-M*sum;\n        Int k=m-(M+1)*sum;\n        if(k<0){k*=-1;}\n        if(M!=n){ans=min(ans,k);}\n        cout<<ans<<endl;\n    }\n    else{\n        vector<ll> A;\n        Int s=1,t=1;\n        int i;\n        for(i=0;i<n && s*p+t*q<=m;i++,s*=a,t*=b){\n            A.push_back(s*p+t*q);\n        }\n        if(i<n && s*p+t*q<=m*2){A.push_back(s*p+t*q);}\n        vector<ll> B;\n        while(A.size()>B.size()){B.push_back(A.back()); A.pop_back();}\n        vector<ll> F;\n        for(ll i=0;i<(1LL<<A.size());i++){\n            ll sum=0;\n            for(int t=0;t<A.size();t++){\n                if(i>>t&1){sum+=A[t];}\n            }\n            F.push_back(sum);\n        }\n        ll ans=m;\n        sort(F.begin(),F.end());\n        for(ll i=0;i<(1LL<<B.size());i++){\n            ll sum=0;\n            for(int t=0;t<B.size();t++){\n                if(i>>t&1){sum+=B[t];}\n            }\n            ll rem=m-sum;\n            ll idx=lower_bound(F.begin(),F.end(),rem)-F.begin();\n            if(idx!=F.size()){ans=min(ans,abs(F[idx]-rem));}\n            if(idx!=0){ans=min(ans,abs(rem-F[idx-1]));}\n        }\n        cout<<ans<<endl;\n    }\n    \n    \n    \n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll N=0;\nll n,m,a,b,p,q;\n\nll calc(ll k){\n  ll A = 1,B = 1;\n  while(k--)A*=a,B*=b;\n  return p*A+q*B;\n}\n\n\nll ans = 1LL<<60;\ntypedef pair<ll,ll> P;\nset<P> used;\nvoid dfs(ll pos,ll sum){\n  if(pos>=n||pos==N+2||sum<0LL) return;\n  if(used.count(P(pos,sum))) return ;\n  used.insert(P(pos,sum));\n  ans = min(ans,(ll)abs(m-sum));\n  \n  dfs(pos+1,sum);\n  ll r = calc(pos);\n  if(r)dfs(pos+1,sum+r);\n}\n\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll t = m,d = max(a,b);\n  \n  while(d>1&&t) t/=d,N++;\n  if(d==1) {\n    ll t = abs(m- (m/(p+q)) * (p+q) + p+q);\n    if(m/(p+q)==n) t = (1e12)+100;\n\n    if(m/(p+q)<n) cout<<min(t,m%(p+q))<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n  }\n  dfs(0,0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nbool ch(int a,int b){\n  int x=1000000000000000LL;\n  x/=a;\n  x/=b;\n  return x==0;\n}\nsigned main(){\n  int n,m,a,b,p,q;\n  cin>>n>>m>>a>>b>>p>>q;\n  if(a==1&&b==1){\n    //cout<<m%(p+q)<<endl;\n    if(ch(n,p+q)) cout<<m%(p+q)<<endl;\n    else{\n      int t=n*(p+q);\n      if(m>=t) cout<<m-t<<endl;\n      else cout<<m%(p+q)<<endl;\n    }\n    return 0;\n  }\n  int ta=1,tb=1;\n  vector<int> v;\n  for(int i=0;i<n;i++){\n    if(ch(p,ta)) break;\n    if(ch(q,tb)) break;\n    int t=p*ta+q*tb;\n    //cout<<t<<endl;\n    if(t<=m) v.push_back(t);\n    else break;\n    if(ch(ta,a)) break;\n    if(ch(tb,b)) break;\n    ta*=a;tb*=b;\n  }\n  int x=v.size();\n  int y=x/2;\n  set<int> s;\n  int ans=m;\n  for(int i=0;i<(1<<y);i++){\n    int t=0;\n    for(int j=0;j<y;j++) if((i>>j)&1) t+=v[j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }    \n    //cout<<t<<endl;\n    s.insert(-t);\n    s.insert(t);\n    ans=min(ans,m-t);\n  }\n  int inf=m*2;\n  s.insert(inf);\n  for(int i=0;i<(1<<(x-y));i++){\n    int t=0;\n    for(int j=0;j<(x-y);j++) if((i>>j)&1) t+=v[y+j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }\n    //cout<<t<<endl;\n    ans=min(ans,m-t);\n    int u=t-m,v=m-t;\n    int k=*s.lower_bound(u);\n    int l=*s.lower_bound(v);\n    ans=min(ans,m-(t-k));\n    if(l!=inf) ans=min(ans,(t+l)-m);\n  }\n  //assert(ans>=0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cmath>\n#include <vector>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nint main() {\n\tlong long N, M, A, B, P, Q;\n\tcin >> N >> M >> A >> B >> P >> Q;\n\tif (A == 1 && B == 1) {\n\t\tlong long d = M / (P + Q);\n\t\tlong long ret = (M > N * (P + Q) ? M - N * (P + Q) : N * (P + Q) - M);\n\t\tif (d <= N) ret = min(ret, M - d * (P + Q));\n\t\tif (d <= N - 1) ret = min(ret, (d + 1) * (P + Q) - M);\n\t\tcout << ret << endl;\n\t}\n\telse {\n\t\tdouble lim = log(2 * M) / max(log(A), log(B));\n\t\tint rep = int(lim + 0.01);\n\t\tlong long mulA = 1, mulB = 1;\n\t\tvector<long long> v;\n\t\tfor (int i = 0; i <= rep && i < N; ++i) {\n\t\t\tv.push_back(P * mulA + Q * mulB);\n\t\t\tmulA *= A;\n\t\t\tmulB *= B;\n\t\t}\n\t\tint S = v.size();\n\t\tint SL = S / 2, SR = S - S / 2;\n\t\tvector<long long> vl(1 << SL), vr(1 << SR);\n\t\tfor (int i = 0; i < SL; ++i) {\n\t\t\tfor (int j = 1 << i; j < 2 << i; ++j) {\n\t\t\t\tvl[j] = vl[j - (1 << i)] + v[i];\n\t\t\t}\n\t\t\tvector<long long> mem(2 << i);\n\t\t\tmerge(vl.begin(), vl.begin() + (1 << i), vl.begin() + (1 << i), vl.begin() + (2 << i), mem.begin());\n\t\t\tcopy(mem.begin(), mem.end(), vl.begin());\n\t\t}\n\t\tfor (int i = 0; i < SR; ++i) {\n\t\t\tfor (int j = 1 << i; j < 2 << i; ++j) {\n\t\t\t\tvr[j] = vr[j - (1 << i)] + v[i + SL];\n\t\t\t}\n\t\t\tvector<long long> mem(2 << i);\n\t\t\tmerge(vr.begin(), vr.begin() + (1 << i), vr.begin() + (1 << i), vr.begin() + (2 << i), mem.begin());\n\t\t\tcopy(mem.begin(), mem.end(), vr.begin());\n\t\t}\n\t\tint ptr = 1 << SR;\n\t\tlong long ans = M;\n\t\tfor (int i = 0; i < 1 << SL; ++i) {\n\t\t\twhile (ptr != 0 && vl[i] + vr[ptr - 1] > M) --ptr;\n\t\t\tif (ptr != 0) ans = min(ans, M - vl[i] - vr[ptr - 1]);\n\t\t\tif (ptr != (1 << SR)) ans = min(ans, vl[i] + vr[ptr] - M);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nsigned main(){\n\tint n,m,a,b,p,q,mi;\n\tvector<int> vec,num;\n\tcin >> n >> m >> a >> b >> p >> q;\n\tmi = m;\n\tif(a == 1 && b == 1){\n\t\tif((p + q) * n >= m) cout << m % (p + q) << endl;\n\t\telse cout << m - (p + q) * n << endl;\n\t\treturn 0;\n\t}\n\tint ta = p,tb = q;\n\tfor(int i = 0;i < n;i++){\n\t\tif(ta + tb > m) break;\n\t\tvec.push_back(ta + tb);\n\t\tif(ta > (m + a - 1) / a || tb > (m + b - 1) / b) break;\n\t\tta *= a;\n\t\ttb *= b;\n\t}\n\tn = vec.size();\n\tfor(int i = 0;i < (1 << (n / 2));i++){\n\t\tint sum = 0;\n\t\tfor(int j = 0;j < n / 2;j++){\n\t\t\tif((i >> j) & 1) sum += vec[j];\n\t\t}\n\t\tnum.push_back(sum);\n\t}\n\tsort(num.begin(),num.end());\n\tfor(int i = 0;i < (1 << ((n + 1) / 2));i++){\n\t\tint sum = 0;\n\t\tfor(int j = 0;j < (n + 1) / 2;j++){\n\t\t\tif((i >> j) & 1) sum += vec[j + n / 2];\n\t\t}\n\t\tint ind = upper_bound(num.begin(),num.end(),m - sum) - num.begin() - 1;\n\t\tif(ind >= 0) mi = min(mi,m - sum - num[ind]);\n\t}\n\tcout << mi << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <queue>\n#include <map>\n#include <set>\n#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <cassert>\nusing namespace std;\n\ntypedef long long ll;\n\n#define REP(i, n) for (ll i = 0; i < (ll)(n); ++i)\n#define FOR(i, a, b) for (ll i = (a); i < (ll)(b); ++i)\n#define FOREQ(i, a, b) for (ll i = (a); i <= (ll)(b); ++i)\n#define DEC(i, k) for (ll i = (k); i >= 0; --i)\n#define FORIT(i, c) for (__tyoeof((c).begin()) i = (c).begin(); i != (c).end(); ++i)\n#define SZ(v) (ll)((v).size())\n#define MEMSET(v, h) memset((v), (h), sizeof(v))\n#define FIND(m, w) ((m).find(w) != (m).end())\n#define ALL(c) (c).begin(), (c).end()\n\nll ticket[1000];\nll ticketSum[1000];\nll n, m, a, b, p, q;\nll cnt;\n\nll calc(ll depth, ll lm) {\n  if (depth == cnt || lm <= 0) { return abs(lm); }\n  if (ticketSum[depth] < lm) { return abs(lm - ticketSum[depth]); }\n  ll ret = m;\n  ret = min(ret, calc(depth + 1, lm));\n  ret = min(ret, calc(depth + 1, lm - ticket[depth]));\n  return ret;\n}\n\nint main() {\n  cin >> n >> m >> a >> b >> p >> q;\n  if (a == 1 && b == 1) {\n    ll use = m / (p + q);\n    use = min(use, n - 1);\n    printf(\"%lld\\n\", min(m - use * (p + q), abs(m - (use + 1) * (p + q))));\n    return 0;\n  }\n  cnt = 0;\n  {\n    ll left = p;\n    ll right = q;\n    REP(i, n) {\n      if (left + right > 2 * m) { break; }\n      ticket[cnt++] = left + right;\n      ll pleft = left;\n      ll pright = right;\n      left *= a;\n      right *= b;\n      if (left / a != pleft || right / b != pright) { break; }\n    }\n  }\n  reverse(ticket, ticket + cnt);\n  MEMSET(ticketSum, 0);\n  for (ll i = cnt; i > 0; i--) {\n    ticketSum[i - 1] = ticket[i - 1] + ticketSum[i];\n  }\n  ll ans = calc(0, m);\n  printf(\"%lld\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb push_back\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\ntypedef vector<int>vint;\ntypedef pair<int,int>pint;\ntypedef vector<pint>vpint;\n\ntemplate<typename A,typename B>inline void chmin(A &a,B b){if(a>b)a=b;}\ntemplate<typename A,typename B>inline void chmax(A &a,B b){if(a<b)a=b;}\n\nint N,M,A,B,P,Q;\n\nvoid dfs(int k,int n,int s,vint &v,vint &latte){\n    if(k==n){\n        latte.pb(s);\n        return;\n    }\n    dfs(k+1,n,s,v,latte);\n    dfs(k+1,n,s+v[k],v,latte);\n}\n\nsigned main(){\n    cin>>N>>M>>A>>B>>P>>Q;\n\n    if(A==1&&B==1){\n        P+=Q;\n        int ans=M;\n        if(M/P>N)chmin(ans,abs(M-P*N));\n        else{\n            chmin(ans,abs(M-M/P*P));\n            if(M/P+1<=N)chmin(ans,abs(M-M/P*P-P));\n        }\n        cout<<ans<<endl;\n        return 0;\n    }\n    vector<int>v;\n    int x=P,y=Q;\n    for(int i=0;i<N;i++){\n        v.pb(x+y);\n        if(1.0*x*A>1e15||1.0*y*B>1e15||x+y>M)break;\n        x*=A;y*=B;\n    }\n\n    int n=v.size()/2;\n    vint latte,malta;\n    dfs(0,n,0,v,latte);\n    dfs(n,v.size(),0,v,malta);\n    sort(all(latte));\n    sort(all(malta));\n\n\n    int ans=M;\n\n    int cur=latte.size()-1;\n    for(int i=0;i<malta.size();i++){\n        while(cur&&latte[cur]+malta[i]>M)cur--;\n        chmin(ans,abs(M-latte[cur]-malta[i]));\n    }\n\n    cur=0;\n    for(int i=(int)malta.size()-1;i>=0;i--){\n        while(cur+1!=latte.size()&&latte[cur]+malta[i]<M)cur++;\n        chmin(ans,abs(M-latte[cur]-malta[i]));\n    }\n\n    cout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=__int128;\n\nusing ll2=long long;\n\nconst ll INF=1e15;\n\nll powi(ll x,ll k){\n    ll res=1;\n    while(k){\n        if(k&1) res*=x;\n        if(res>INF) return INF;\n        x*=x;\n        k>>=1;\n    }\n    return res;\n}\nint main(){\n    ll2 nn,mm,aa,bb,pp,qq;\n    cin>>nn>>mm>>aa>>bb>>pp>>qq;\n    ll n=nn,m=mm,a=aa,b=bb,p=pp,q=qq;\n    if(a>=2 || b>=2){\n        int tn=min(n,ll(41));\n        int half=min((tn*2)/3,22);\n        vector<ll> vec(1<<half);\n        for(int i=0;i<(1<<half);i++){\n            ll val=0;\n            for(int j=0;j<half;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,j)+q*powi(b,j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            vec[i]=val;\n\n        }\n        int rest=tn-half;\n        vector<int> s(1<<rest);\n        for(int i=0;i<(1<<rest);i++){\n            ll val=0;\n            for(int j=0;j<rest;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,half+j)+q*powi(b,half+j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            s[i]=val;\n        }\n        sort(s.begin(),s.end());\n        ll2 res=m;\n        for(int i=0;i<vec.size();i++){\n            auto it=lower_bound(s.begin(),s.end(),m-vec[i]);\n            if(it!=s.end()){\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n            if(it!=s.begin()){\n                it--;\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n        }\n        cout<<res<<endl;\n    }\n    else{\n        if((p+q)*n>=m){\n            cout<<ll2(min(m%(p+q),(p+q)-m%(p+q)))<<endl;\n        }\n        else{\n            cout<<ll2(m-(p+q)*n)<<endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll N=0;\nll n,m,a,b,p,q;\n\nll calc(ll k){\n  ll A = 1,B = 1;\n  while(A>0&&B>0&&k--)A*=a,B*=b;\n  if(A<0||B<0) return -1;\n  return p*A+q*B;\n}\n\n\nll ans = 1LL<<60;\ntypedef pair<ll,ll> P;\nset<P> used;\n\nvoid dfs(ll pos,ll sum){\n  if(pos>=n||pos==N+2||sum<0LL) return;\n  if(used.count(P(pos,sum))) return ;\n  used.insert(P(pos,sum));\n  ans = min(ans,(ll)abs(m-sum));\n\n  ll r = calc(pos);\n  if(r<=0) return;\n  dfs(pos+1,sum+r);  \n  dfs(pos+1,sum);\n}\n\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll t = m,d = max(a,b);\n  \n  while(d>1&&t) t/=d,N++;\n  if(d==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - p+q);\n    if(m/(p+q)==n-1) t = 1LL<<60;\n    if(m/(p+q)<n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n  }\n\n  dfs(0,0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll _pow(ll a, ll n) {\n\tif(n == 0) return 1;\n\telse {\n\t\tll res = 1;\n\t\tll buf = a;\n\t\twhile(n > 0) {\n\t\t\tif(n % 2 == 1) {\n\t\t\t\tres *= buf;\n\t\t\t}\n\t\t\tbuf *= buf;\n\t\t\tn /= 2;\n\t\t}\n\t\treturn res;\n\t}\n}\n\nvoid solve() {\n\tll tmp1, tmp2, tmp3, tmp4, tmp5, tmp6;\n\tcin >> tmp1 >> tmp2 >> tmp3 >> tmp4 >> tmp5 >> tmp6;\n\t__int128 n, m, a, b, p, q;\n\tn = tmp1;\n\tm = tmp2;\n\ta = tmp3;\n\tb = tmp4;\n\tp = tmp5;\n\tq = tmp6;\n\t__int128 ans = m;\n\tif(n == 1) {\n\t\tans = min(m, (p + q) - m);\n\t\tcout << (ll)ans << endl;\n\t\treturn;\n\t}\n\t__int128 c = max(a, b);\n\tif(c == 1) {\n\t\tif((p + q) * n > m) {\n\t\t\tans = min(m - m / (p + q) * (p + q), (m / (p + q) + 1) * (p + q) - m);\n\t\t} else ans = m - (p + q) * n;\n\t} else if(c == 2 || c == 3) {\n\t\t__int128 _n = 0;\n\t\tif(c == 2) _n = min((__int128)41, n);\n\t\tif(c == 3) _n = min((__int128)29, n);\n\t\tll div1 = _n / 2;\n\t\tll div2 = _n - div1;\n\t\tvector<__int128> d1;\n\t\tvector<__int128> d2;\n\t\tREP(bit, (1ll << div1)) {\n\t\t\tbitset<31> bi(bit);\n\t\t\t__int128 sum = 0;\n\t\t\tREP(i, div1) if(bi[i]) sum += p * _pow(a, i) + q * _pow(b, i);\n\t\t\td1.pb(sum);\n\t\t}\n\t\tREP(bit, (1ll << div2)) {\n\t\t\tbitset<31> bi(bit);\n\t\t\t__int128 sum = 0;\n\t\t\tREP(i, div2) if(bi[i]) sum += p * _pow(a, div1 + i) + q * _pow(b, div1 + i);\n\t\t\td2.pb(sum);\n\t\t}\n\t\tsort(ALL(d1));\n\t\tsort(ALL(d2));\n\t\tREP(i, d1.size()) {\n\t\t\tauto ite = upper_bound(ALL(d2), m - d1[i]);\n\t\t\tif(ite != d2.end()) ans = min(ans, (d1[i] + *ite) - m);\n\t\t\tif(ite == d2.begin()) continue;\n\t\t\tite--;\n\t\t\tans = min(ans, m - (d1[i] + *ite));\n\t\t}\n\t} else /* c >= 4 */ {\n\t\tvector<__int128> num;\n\t\tnum.pb(0);\n\t\tnum.pb(p + q);\n\t\tREP(i, min((__int128)23, n - 1)) {\n\t\t\tif((__int128)1000000000007 / (ld)_pow(c, i) < c) break;\n\t\t\tll val = p * _pow(a, i + 1) + q * _pow(b, i + 1); \n\t\t\tvector<__int128> nnum = num;\n\t\t\tREP(j, num.size()) nnum.pb(num[j] + val);\n\t\t\tnum = nnum;\n\t\t}\n\t\tUNIQUE(num);\n\t\tREP(i, num.size()) ans = min(ans, (__int128)abs((ll)(m - num[i])));\n\t}\n\tcout << (ll)ans << endl;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tsolve();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  ll MAX=1000000000000LL;\n  \n  assert( 1<= n &&n <= MAX );\n  assert( 1<= m &&m <= MAX );\n  assert( 1<= a &&a <= MAX );\n  assert( 1<= b &&b <= MAX );\n  assert( 1<= p &&p <= MAX );\n  assert( 1<= q &&q <= MAX );\n\n\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    assert(n*m*a*b*p*q==1);\n\n    if(total <= m)return m-total;\n    \n    return min(m%d,m-m%d);\n    \n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n    if( i==40 )break;\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        ll c=T[i]+U[j];\n        res=min( res,  abs(m-c) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s, B;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\n\tif (a == 1 && b == 1) {\n\t\tif (m <= s * (n + 1) / 2 * (p + q)) {\n\t\t\tB = m % (p + q);\n\t\t\tif (m > (p + q) / 2) {\n\t\t\t\tB = (p + q) - B;\n\t\t\t}\n\t\t\tcout << B << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << s - (long long)(n * (n + 1) / 2 * (p + q)) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = m;\n\td = s;\nE:;\n\trem = m - c[d - 1];\n\tminx = min(minx, abs(rem));\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\tll n,m,a,b,p,q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\t\n\tif(a == 1 && b == 1){\n\t\tif(m >= (p+q)*n)cout << m-(p+q)*n << endl;\n\t\telse {\n\t\t\tcout << min( m%(p+q) , m-m%(p+q) ) << endl;\n\t\t}\n\t}\n\telse {\n\t\tvector<ll> vec;\n\t\tll s = 1 , t = 1;\n\t\tfor(int i = 0 ; i < n ; i ++){\n\t\t\tvec.push_back(p*s+q*t);\n\t\t\tif(p*s+q*t > m)break;\n\t\t\ts *= a;\n\t\t\tt *= b;\n\t\t}\n\t\tint N = vec.size();\n\t\tvector<ll> A,B;\n\t\tA.push_back(0);\n\t\tfor(int i = 0 ; i < N/2 ; i ++){\n\t\t\tint x = A.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tA.push_back(vec[i]+A[j]);\n\t\t\t}\n\t\t}\n\t\tB.push_back(0);\n\t\tfor(int i = N/2 ; i < N ; i ++){\n\t\t\tint x = B.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tB.push_back(vec[i]+B[j]);\n\t\t\t}\n\t\t}\n\t\tsort(B.begin(),B.end());\n\t\tB.erase(unique(B.begin(),B.end()),B.end());\n\t\tll ret = m;\n\t\tfor(int i = 0 ; i < A.size() ; i ++){\n\t\t\tint x = upper_bound(B.begin(),B.end(),m-A[i])-B.begin();\n\t\t\tif(x < B.size())ret = min ( ret , A[i]+B[x]-m );\n\t\t\tx --;\n\t\t\tret = min ( ret , m-A[i]-B[x] );\n\t\t}\n\t\tcout << ret << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll N=0;\nll n,m,a,b,p,q;\n\nll calc(ll k){\n  ll A = 1,B = 1;\n  while(A>0&&B>0&&k--)A*=a,B*=b;\n  if(A<0||B<0) return -1;\n  return p*A+q*B;\n}\n\n\nll ans = 1LL<<60;\ntypedef pair<ll,ll> P;\nset<P> used;\n\nvoid dfs(ll pos,ll sum){\n  if(pos>=n||pos==N+10||sum<0LL) return;\n  if(used.count(P(pos,sum))) return ;\n  used.insert(P(pos,sum));\n  ans = min(ans,(ll)abs(m-sum));\n\n  ll r = calc(pos);\n  if(r<=0) return;\n  dfs(pos+1,sum+r);  \n  dfs(pos+1,sum);\n}\n\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll t = m,d = max(a,b);  \n  while(d>1&&t) t/=d,N++;\n\n  if(d==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - p+q);\n    if(m/(p+q)==n-1) t = 1LL<<60;\n    if(m/(p+q)<n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n  }\n\n  dfs(0,0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\tll n,m,a,b,p,q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\t\n\tif(a == 1 && b == 1){\n\t\tcout << max( m%(p+q) , m-(p+q)*n ) << endl;\n\t}\n\telse {\n\t\tvector<ll> vec;\n\t\tll s = 1 , t = 1;\n\t\tfor(int i = 0 ; i < n ; i ++){\n\t\t\tvec.push_back(p*s+q*t);\n\t\t\tif(p*s+q*t > m)break;\n\t\t\ts *= a;\n\t\t\tt *= b;\n\t\t}\n\t\tint N = vec.size();\n\t\tvector<ll> A,B;\n\t\tA.push_back(0);\n\t\tfor(int i = 0 ; i < N/2 ; i ++){\n\t\t\tint x = A.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tA.push_back(vec[i]+A[j]);\n\t\t\t}\n\t\t}\n\t\tB.push_back(0);\n\t\tfor(int i = N/2 ; i < N ; i ++){\n\t\t\tint x = B.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tB.push_back(vec[i]+B[j]);\n\t\t\t}\n\t\t}\n\t\tsort(B.begin(),B.end());\n\t\tB.erase(unique(B.begin(),B.end()),B.end());\n\t\tll ret = m;\n\t\tfor(int i = 0 ; i < A.size() ; i ++){\n\t\t\tint x = upper_bound(B.begin(),B.end(),m-A[i])-B.begin();\n\t\t\tif(x < B.size())ret = min ( ret , A[i]+B[x]-m );\n\t\t\tx --;\n\t\t\tret = min ( ret , m-A[i]-B[x] );\n\t\t}\n\t\tcout << ret << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <queue>\n#define REP(i,n) for(int i=0; i<(int)(n); i++)\n\ntypedef long long ll;\n\nusing namespace std;\n\nconst ll inf = 1ll << 60;\n\nll mult(ll a, ll b){\n  if(inf / a < b) throw 0;\n  return a * b;\n}\n\nint main(){\n  ll n, m, a, b, p, q;\n  cin >> n >> m >> a >> b >> p >> q;\n  if(a == 1 && b == 1){\n    ll tmp = min(n + 1, m / (p + q));\n    ll ans = inf;\n    for(ll t = max(0ll, tmp - 2); t < min(n + 1, tmp + 2); t++){\n      ll tt = t * (p + q);\n      ans = min(ans, std::abs(m - tt));\n    }\n    cout << ans << endl;\n    return 0;\n  }\n\n  if(n > 40) n = 40;\n\n  vector<ll> v;\n  ll aa = 1;\n  ll bb = 1;\n\n  try{\n    REP(i,n){\n      ll val = mult(p, aa) + mult(q, bb);\n      if(val <= m + m) v.push_back(val);\n      else break;\n      aa = mult(aa, a);\n      bb = mult(bb, b);\n    }\n  }catch(int n){}\n\n  vector<ll> as;\n  vector<ll> bs;\n\n  n = v.size();\n\n  if(n == 1){\n    cout << min(m, std::abs(m - v[0])) << endl;\n    return 0;\n  }\n\n  REP(i,1<<(n/2)){\n    ll tmp = 0;\n    REP(j,n/2) if(i & (1 << j)) tmp += v[j];\n    as.push_back(tmp);\n  }\n\n  REP(i,1<<(n/2 + n%2)){\n    ll tmp = 0;\n    REP(j,n/2 + n%2) if(i & (1 << j))\n      tmp += v[j + n / 2];\n    bs.push_back(tmp);\n  }\n\n  sort(as.begin(), as.end());\n  sort(bs.rbegin(), bs.rend());\n\n  size_t ai = 0, an = as.size() - 1;\n  size_t bi = 0, bn = bs.size() - 1;\n  ll ans = m;\n\n  while(ai < an || bi < an){\n    ll tmp = as[ai] + bs[bi];\n    ans = min(ans, std::abs(m - tmp));\n    if(tmp > m){\n      if(bi != bn) bi++;\n      else ai++;\n    }else{\n      if(ai != an) ai++;\n      else bi++;\n    }\n  }\n\n  cout << ans << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<set>\n#include<cstdlib>\n\nusing namespace std;\n\nlong long n,m,a,b,p,q;\n\nlong long mul(long long a,long long b){\n  __int128 r=a;\n  r*=b;\n  if(r>1e18)throw 0;\n  return r;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  if(a==1&&b==1){\n    long long c=m/(p+q);\n    cout<<min(m-c*(p+q),(c+1)*(p+q)-m)<<endl;\n  }else{\n    long long t[55]={};\n    t[0]=p+q;\n    long long ak=1,bk=1;\n    try{\n      for(int i=1;i<min(n,41ll);i++){\n\tak=mul(ak,a);\n\tbk=mul(bk,b);\n\tt[i]=mul(p,ak)+mul(q,bk);\n      }\n    }catch(...){\n    }\n    set<long long> s;\n    for(int i=0;i<1<<21;i++){\n      long long c=0;\n      for(int j=0;j<21;j++){\n\tc+=(i>>j&1)*t[j+21];\n      }\n      s.insert(c);\n    }\n    long long ans=1e18;\n    for(int i=0;i<1<<21;i++){\n      long long c=0;\n      for(int j=0;j<21;j++){\n\tc+=(i>>j&1)*t[j];\n      }\n      auto it=s.lower_bound(m-c);\n      if(it!=s.end()){\n\tans=min(ans,llabs(m-*it-c));\n      }\n      if(it!=s.begin()){\n\tit--;\n\tans=min(ans,llabs(m-*it-c));\n      }\n    }\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nbool ch(int a,int b){\n  int x=10000000000000LL;\n  x/=a;\n  x/=b;\n  return x==0;\n}\nsigned main(){\n  int n,m,a,b,p,q;\n  cin>>n>>m>>a>>b>>p>>q;\n  if(a==1&&b==1){\n    //cout<<m%(p+q)<<endl;\n    if(ch(n,p+q)) cout<<m%(p+q)<<endl;\n    else{\n      int t=n*(p+q);\n      if(m>=t) cout<<m-t<<endl;\n      else cout<<m%(p+q)<<endl;\n    }\n    return 0;\n  }\n  int ta=1,tb=1;\n  vector<int> v;\n  for(int i=0;i<n;i++){\n    if(ch(p,ta)) break;\n    if(ch(q,tb)) break;\n    int t=p*ta+q*tb;\n    //cout<<t<<endl;\n    if(t<=m) v.push_back(t);\n    else break;\n    if(ch(ta,a)) break;\n    if(ch(tb,b)) break;\n    ta*=a;tb*=b;\n  }\n  int x=v.size();\n  int y=x/2;\n  if(x==1){\n    cout<<m-v[0]<<endl;\n    return 0;\n  }\n  set<int> s;\n  for(int i=0;i<(1<<y);i++){\n    int t=0;\n    for(int j=0;j<y;j++) if((i>>j)&1) t+=v[j];\n    if(t>m) continue;\n    //cout<<t<<endl;\n    s.insert(-t);\n  }\n  int ans=m;\n  for(int i=0;i<(1<<(x-y));i++){\n    int t=0;\n    for(int j=0;j<(x-y);j++) if((i>>j)&1) t+=v[y+j];\n    if(t>m) continue;\n    //cout<<t<<endl;\n    int u=t-m;\n    int k=*s.lower_bound(u);\n    ans=min(ans,m-(t-k));\n  }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return min( m%total , m-m%total);\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n  for(int i=0;i<40;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        res=min( res, abs( m- ( T[i]+U[j] )) );      \n      }\n    }\n  }\n  \n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 1LL<<53;\nll Sum[100];\nll n,m,a,b,p,q;\n\n\nll calc(ll k){\n  ll A = 1,B = 1,res=p+q;\n  while(0<res&&res<=INF&&k--)A*=a,B*=b,res=p*A+q*B;\n  return min(INF,res);\n}\n\nll ans = INF;\nset<ll> used[101];\nvoid dfs(ll pos,ll sum){\n  ans = min(ans,(ll)abs(m-sum));\n  if(m<sum||pos==-1||sum>INF) return;\n  if(Sum[pos]+sum<m){ans=min(ans,m-(Sum[pos]+sum));return;}\n  if(used[pos].count(sum)) return ;\n  used[pos].insert(sum);\n  dfs(pos-1,sum+calc(pos));  \n  dfs(pos-1,sum);\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  Sum[0] = calc(0);\n  for(int i=1;i<60;i++)Sum[i]=min(INF,calc(i)+Sum[i-1]);\n\n    if(max(a,b)==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - (p+q));\n    if(m/(p+q)==n) t = INF;\n    if(m/(p+q)<=n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n    }\n  \n  dfs(min(n-1,50LL),0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\nusing namespace std;\n\nlong long vals[50];\nlong long N;\nlong long M;\n\nlong long dfs(int id,int toTake,int taken,long long curVal,bool flg){\n//\tprintf(\"%d %d %d %lld\\n\",id,toTake,taken,curVal);\n\tif(id==-1){\n\t\tif(taken==toTake) return curVal;\n\t\telse return -1;\n\t}\n\tif(toTake==taken){\n\t\treturn curVal;\n\t}\n\tlong long nxtVal=curVal+vals[id];\n//\tprintf(\"nxt=%lld\\n\",nxtVal);\n\tlong long res=-1;\n\tif(nxtVal>M){\n\t\tres=dfs(id-1,toTake,taken,curVal,flg);\n\t\treturn res;\n\t}\n\tif(flg==false){\n\t\t//not take\n\t\tres=dfs(id-1,toTake,taken,curVal,true);\n\t}\n\tlong long res2=dfs(id-1,toTake,taken+1,nxtVal,flg);\n\tres=max(res,res2);\n\treturn res;\n}\n\nlong long dfs2(int id,int toTake,int taken,long long curVal){\n\tif(id==-1){\n\t\tif(toTake!=taken) return -1;\n\t\tif(curVal<M) return -1;\n\t\treturn curVal;\n\t}\n\tlong long nxtVal=curVal+vals[id];\n\tif(toTake==taken+id+1){\n\t\tlong long tmp=dfs2(id-1,toTake,taken+1,nxtVal);\n\t\treturn tmp;\n\t}\n\tlong long notTake=curVal;\n\tfor(int i=1;i<=toTake-taken;i++){\n\t\tnotTake+=vals[id-i];\n\t}\n\tlong long res;\n\tif(notTake>=M){\n\t\tres=dfs2(id-1,toTake,taken,curVal);\n\t}else{\n\t\tres=dfs2(id-1,toTake,taken+1,nxtVal);\n\t}\n\treturn res;\n}\n\nlong long mult(long long a,long long b,long long c){\n\tlong long x=c/a;\n\tif(b>x) return -1;\n\tlong long res=a*b;\n\tif(res>c) return -1;\n\treturn res;\n}\n\nint main(){\n\tlong long a,b,p,q;\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&N,&M,&a,&b,&p,&q);\n\tif(a==1&&b==1){\n\t\tlong long x=p+q;\n\t\tlong long num=M/x;\n\t\tnum=min(num,N);\n\t\tlong long train=x*num;\n\t\tlong long ans=M-train;\n\t\tif(num+1<=N){\n\t\t\ttrain+=x;\n\t\t\tans=min(ans,train-M);\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t\treturn 0;\n\t}\n\tlong long pa=1,pb=1;\n\tint n=0;\n\tfor(int i=0;i<N;i++){\n\t\tlong long cur1=mult(pa,p,M*2);\n\t\tlong long cur2=mult(pb,q,M*2);\n\t\tif(cur1==-1||cur2==-1) break;\n\t\tlong long cur=cur1+cur2;\n\t\tif(cur>M*2) break;\n\t\tvals[n++]=cur;\n\t\tpa=mult(pa,a,M*2);\n\t\tpb=mult(pb,b,M*2);\n\t\tif(pa==-1||pb==-1) break;\n\t}\n\tif(n==0){\n\t\tprintf(\"%lld\\n\",M);\n\t\treturn 0;\n\t}\n//\tfor(int i=0;i<n;i++){\n//\t\tprintf(\"%d %lld\\n\",i,vals[i]);\n//\t}\n\tN=n;\n\tlong long ans=M;\n\tfor(int i=1;i<=n;i++){\n\t\tlong long tmp=dfs(n-1,i,0,0,false);\n//\t\tprintf(\"%d %lld\\n\",i,tmp);\n\t\tif(tmp==-1) continue;\n\t\tans=min(ans,M-tmp);\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tlong long tmp=dfs2(n-1,i,0,0);\n\t\tif(tmp==-1) continue;\n\t\tans=min(ans,tmp-M);\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll _pow(ll a, ll n) {\n\tif(n == 0) return 1;\n\telse {\n\t\tll res = 1;\n\t\tll buf = a;\n\t\twhile(n > 0) {\n\t\t\tif(n % 2 == 1) {\n\t\t\t\tres *= buf;\n\t\t\t}\n\t\t\tbuf *= buf;\n\t\t\tn /= 2;\n\t\t}\n\t\treturn res;\n\t}\n}\n\nvoid solve() {\n\tll n, m, a, b, p, q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\tif(n == 1) {\n\t\tif(p + q > m) cout << m << endl;\n\t\telse cout << m - (p + q) << endl;\n\t\treturn;\n\t}\n\tll c = max(a, b);\n\tif(c == 1) {\n\t\tif((p + q) * n > m) {\n\t\t\tcout << min(m - m / (p + q) * (p + q), (m / (p + q) + 1) * (p + q) - m)<< endl;\n\t\t} else cout << m - (p + q) * n << endl;\n\t} else if(c == 2 || c == 3) {\n\t\tll _n = 0;\n\t\tif(c == 2) _n = min(41LL, n);\n\t\tif(c == 3) _n = min(29LL, n);\n\t\tll div1 = _n / 2;\n\t\tll div2 = _n - div1;\n\t\tvector<ll> d1;\n\t\tvector<ll> d2;\n\t\tREP(bit, (1ll << div1)) {\n\t\t\tbitset<31> bi(bit);\n\t\t\tll sum = 0;\n\t\t\tREP(i, div1) if(bi[i]) sum += p * _pow(a, i) + q * _pow(b, i);\n\t\t\td1.pb(sum);\n\t\t}\n\t\tREP(bit, (1ll << div2)) {\n\t\t\tbitset<31> bi(bit);\n\t\t\tll sum = 0;\n\t\t\tREP(i, div2) if(bi[i]) sum += p * _pow(a, div1 + i) + q * _pow(b, div1 + i);\n\t\t\td2.pb(sum);\n\t\t}\n\t\tsort(ALL(d1));\n\t\tsort(ALL(d2));\n\t\tll ans = m;\n\t\tREP(i, d1.size()) {\n\t\t\tauto ite = upper_bound(ALL(d2), m - d1[i]);\n\t\t\tif(ite != d2.end()) ans = min(ans, (d1[i] + *ite) - m);\n\t\t\tif(ite == d2.begin()) continue;\n\t\t\tite--;\n\t\t\tans = min(ans, m - (d1[i] + *ite));\n\t\t}\n\t\tcout << ans << endl;\n\t} else /* c >= 4 */ {\n\t\tvector<ll> num;\n\t\tnum.pb(0);\n\t\tnum.pb(p + q);\n\t\tREP(i, min(23LL, n - 1)) {\n\t\t\tif(1000000000007LL / (ld)_pow(c, i) < c) break;\n\t\t\tll val = p * _pow(a, i + 1) + q * _pow(b, i + 1); \n\t\t\tvector<ll> nnum = num;\n\t\t\tREP(j, num.size()) nnum.pb(num[j] + val);\n\t\t\tnum = nnum;\n\t\t}\n\t\tUNIQUE(num);\n\t\tll ans = INF*INF;\n\t\tREP(i, num.size()) ans = min(ans, abs(m - num[i]));\n\t\tcout << ans << endl;\n\t}\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tsolve();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define EPS 1e-10\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;--i)\n#define srep(i,s,t) for(int i=(int)(s);i<(int)(t);++i)\n#define each(a,b) for(auto (a): (b))\n#define all(v) (v).begin(),(v).end()\n#define len(v) (int)(v).size()\n#define zip(v) sort(all(v)),v.erase(unique(all(v)),v.end())\n#define cmx(x,y) x=max(x,y)\n#define cmn(x,y) x=min(x,y)\n#define fi first\n#define se second\n#define pb push_back\n#define show(x) cout<<#x<<\" = \"<<(x)<<endl\n#define spair(p) cout<<#p<<\": \"<<p.fi<<\" \"<<p.se<<endl\n#define svec(v) cout<<#v<<\":\";rep(kbrni,v.size())cout<<\" \"<<v[kbrni];cout<<endl\n#define sset(s) cout<<#s<<\":\";each(kbrni,s)cout<<\" \"<<kbrni;cout<<endl\n#define smap(m) cout<<#m<<\":\";each(kbrni,m)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n\nusing namespace std;\n\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<P> vp;\ntypedef vector<string> vs;\n\nconst int MAX_N = 100005;\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    ll n,m,a,b,p,q;\n    cin >> n >> m >> a >> b >> p >> q;\n    if(a == 1 && b == 1){\n        ll cnt = m/(p+q);\n        cout << m-min(n,cnt)*(p+q) << \"\\n\";\n    }else{\n        ll mid = 21;\n        vl u,v;\n        rep(i,(1 << mid)){\n            ll val1 = 0,val2 = 0;\n            double ch1 = 0,ch2 = 0;\n            rep(j,mid){\n                if((i >> j) & 1){\n                    val1 += p*pow(a,j) + q*pow(b,j);\n                    val2 += p*pow(a,mid+j) + q*pow(b,mid+j);\n                    ch1 += (double)p*pow(a,j) + (double)q*pow(b,j);\n                    ch2 += (double)p*pow(a,mid+j) + (double)q*pow(b,mid+j);\n                }\n            }\n            if(ch1 <= m){\n                u.pb(val1);\n                if(ch2 <= m){\n                    v.pb(val2);\n                }\n            }\n        }\n        ll mn = (1LL << 60);\n        rep(i,len(u)){\n            int id = upper_bound(all(v),m-u[i]) - v.begin();\n            if(id > 0){\n                cmn(mn,m-(u[i]+v[id]));\n            }\n        }\n        cout << mn << \"\\n\";\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <fstream>\n#include <iomanip>\n#include <iostream>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <valarray>\n#include <vector>\n\n#define EPS 1e-9\n#define INF 1070000000LL\n#define MOD 1000000007LL\n#define fir first\n#define foreach(it,X) for(__typeof((X).begin()) it=(X).begin();it!=(X).end();it++)\n#define ite iterator\n#define mp make_pair\n#define rep(i,n) rep2(i,0,n)\n#define rep2(i,m,n) for(int i=m;i<(n);i++)\n#define pb push_back\n#define sec second\n#define sz(x) ((int)(x).size())\n\nusing namespace std;\n\nstruct timer{\n\ttime_t start;\n\ttimer(){start=clock();}\n\t~timer(){cerr<<1.*(clock()-start)/CLOCKS_PER_SEC<<\" secs\"<<endl;}\n};\n\ntypedef istringstream iss;\ntypedef long long ll;\ntypedef pair<int,int> pi;\ntypedef stringstream sst;\ntypedef vector<int> vi;\n\nll n,m,a,b,p,q;\nvector<ll> v;\n\nint main(){\n\tcin.tie(0);\n\tios_base::sync_with_stdio(0);\n\t\n\tcin>>n>>m>>a>>b>>p>>q;\n\tif(a==1 && b==1){\n\t\tll t=p+q;\n\t\tif(n < (m+t-1)/t){\n\t\t\tcout<<m-t*n<<endl;\n\t\t}else{\n\t\t\tcout<<min(m%t,t-m%t)<<endl;\n\t\t}\n\t\treturn 0;\n\t}\n\tvector<ll> v;\n\tll pa=p,qb=q;\n\tdouble pa_=p,qb_=q;\n\trep(i,n){\n\t\tif(pa_+qb_>3*m)break;\n\t\tif(pa+qb>2*m)break;\n\t\tv.pb(pa+qb);\n\t\tpa*=a,qb*=b;\n\t\tpa_*=a,qb_*=b;\n\t}\n\t//rep(i,sz(v))cout<<v[i]<<\" \";cout<<endl;\n\t\n\tvector<ll> v0,v1,sum;\n\tint N=sz(v)/2;\n\trep(i,sz(v)){\n\t\tif(i<N)v0.pb(v[i]);\n\t\telse v1.pb(v[i]);\n\t}\n\trep(mask,1<<sz(v1)){\n\t\tll s=0;\n\t\trep(i,sz(v1))if(mask>>i&1){\n\t\t\ts+=v1[i];\n\t\t}\n\t\tsum.pb(s);\n\t}\n\tsort(sum.begin(),sum.end());\n\t\n\tll ans=m;\n\trep(mask,1<<sz(v0)){\n\t\tll s=0;\n\t\trep(i,sz(v0))if(mask>>i&1){\n\t\t\ts+=v0[i];\n\t\t}\n\t\tif(s>=m){\n\t\t\tans=min(ans,s-m);\n\t\t}else{\n\t\t\tll rest=m-s;\n\t\t\tvector<ll>::ite it=lower_bound(sum.begin(),sum.end(),rest);\n\t\t\tif(it!=sum.end())ans=min(ans,*it-rest);\n\t\t\tit--;\n\t\t\tans=min(ans,rest-*it);\n\t\t}\n\t}\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=__int128;\n\nusing ll2=long long;\n\nconst ll INF=1e15;\n\nll powi(ll x,ll k){\n    ll res=1;\n    while(k){\n        if(k&1) res*=x;\n        if(res>INF) return INF;\n        x*=x;\n        k>>=1;\n    }\n    return res;\n}\nint main(){\n    ll2 nn,mm,aa,bb,pp,qq;\n    cin>>nn>>mm>>aa>>bb>>pp>>qq;\n    ll n=nn,m=mm,a=aa,b=bb,p=pp,q=qq;\n    if(a>=2 || b>=2){\n        int tn=min(n,ll(41));\n        int half=min(tn/2,20);\n        vector<ll> vec(1<<half);\n        for(int i=0;i<(1<<half);i++){\n            ll val=0;\n            for(int j=0;j<half;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,j)+q*powi(b,j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            vec[i]=val;\n\n        }\n        int rest=tn-half;\n        vector<ll> s(1<<rest);\n        for(int i=0;i<(1<<rest);i++){\n            ll val=0;\n            for(int j=0;j<rest;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,half+j)+q*powi(b,half+j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            s[i]=val;\n        }\n        sort(s.begin(),s.end());\n        ll2 res=m;\n        for(int i=0;i<vec.size();i++){\n            auto it=lower_bound(s.begin(),s.end(),m-vec[i]);\n            if(it!=s.end()){\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n            if(it!=s.begin()){\n                it--;\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n        }\n        cout<<res<<endl;\n    }\n    else{\n        if((p+q)*n>=m){\n            cout<<ll2(min(m%(p+q),(p+q)-m%(p+q)))<<endl;\n        }\n        else{\n            cout<<ll2(m-(p+q)*n)<<endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "// g++ -std=c++11 a.cpp\n#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>   \n#include<map>\n#include<set>\n#include<unordered_map>\n#include<utility>\n#include<cmath>\n#include<random>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<bitset>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#include<typeinfo>\n#define loop(i,a,b) for(ll i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define FOR(i,a) for(auto i:a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n#define show1d(v) rep(i,v.size())cout<<\" \"<<v[i];cout<<endl<<endl;\n#define show2d(v) rep(i,v.size()){rep(j,v[i].size())cout<<\" \"<<v[i][j];cout<<endl;}cout<<endl;\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\n//#define int ll\ntypedef ll Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n#define mt make_tuple\ntypedef tuple<int,int,int,int> tp;\ntypedef vector<tp> vt;\ntemplate<typename A,typename B>bool cmin(A &a,const B &b){return a>b?(a=b,true):false;}\ntemplate<typename A,typename B>bool cmax(A &a,const B &b){return a<b?(a=b,true):false;}\n//template<class C>constexpr int size(const C &c){return (int)c.size();}\n//template<class T,size_t N> constexpr int size(const T (&xs)[N])noexcept{return (int)N;}\nconst double PI=acos(-1);\nconst double EPS=1e-9;\nDef inf = sizeof(Def) == sizeof(long long) ? 2e18 : 1e9+10;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\nint main(){\n\tll n,m,a,b,p,q;\n\tcin>>n>>m>>a>>b>>p>>q;\n\tif(a+b==2){\n\t\tll t=p+q;\n\t\tll T=m/t;\n\t\tll out=m;\n\t\tloop(i,max(0ll,T-10),min(n,T+10))\n\t\t\tout=min(out,abs(t*i-m));\n\t\tcout<<out<<endl;\n\t\treturn 0;\n\t}\n\tvi A,B;\n\tll t=p;\n\tint co=0;\n\twhile(1){\n\t\tA.pb(t);\n\t\tif(to_string(t).size()+to_string(a).size()>16)break;\n\t\tt*=a;\n\t\tif(a==1&&co==40)break;\n\t\tco++;\n\t}\n\tt=q;\n\tco=0;\n\twhile(1){\n\t\tB.pb(t);\n\t\tif(to_string(t).size()+to_string(b).size()>16)break;\n\t\tt*=b;\n\t\tif(b==1&&co==40)break;\n\t\tco++;\n\t}\n\t//show1d(A);\n\t//show1d(B);\n\tvi in;\n\trep(i,min((ll)A.size(),n))\n\t\tif(i<B.size()&&A[i]+B[i]<=3*m)in.pb(A[i]+B[i]);\n\tn=in.size()/2;\n\tll N=1<<n;\n\tvi dp;\n\trep(i,N){\n\t\tll sum=0;\n\t\trep(j,n)if(i&1<<j)sum+=in[j];\n\t\tif(sum<=3*m)dp.pb(sum);\n\t}\n\tsort(all(dp));\n\tll nn=in.size()-n;\n\tN=1<<nn;\n\tll out=m;\n//\tshow1d(in);\n\trep(i,N){\n\t\tll sum=0;\n\t\trep(j,nn)if(i&1<<j)sum+=in[n+j];\n\t\tif(sum>3*m)continue;\n\t\tauto it=upper_bound(all(dp),m-sum);\n\t\tif(it!=dp.end())out=min(out,abs(*it+sum-m));\n\t\tif(it==dp.begin())continue;\n\t\tit--;\n\t\tout=min(out,abs(*it+sum-m));\n\t}\n//\tshow1d(dp);\n\tcout<<out<<endl;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<set>\n#include<cstdlib>\n\nusing namespace std;\n\nlong long n,m,a,b,p,q;\n\nlong long mul(long long a,long long b){\n  __int128 r=a;\n  r*=b;\n  if(r>1e18)throw 0;\n  return r;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  if(a==1&&b==1){\n    long long c=m/(p+q);\n    cout<<min(m-min(n,c)*(p+q),llabs(min(n,c+1)*(p+q)-m))<<endl;\n  }else{\n    long long t[55]={};\n    t[0]=p+q;\n    long long ak=1,bk=1;\n    try{\n      for(int i=1;i<min(n,42ll);i++){\n\tak=mul(ak,a);\n\tbk=mul(bk,b);\n\tt[i]=mul(p,ak)+mul(q,bk);\n      }\n    }catch(...){\n    }\n    set<long long> s;\n    for(int i=0;i<1<<21;i++){\n      long long c=0;\n      for(int j=0;j<21;j++){\n\tc+=(i>>j&1)*t[j+21];\n      }\n      s.insert(c);\n    }\n    long long ans=1e18;\n    for(int i=0;i<1<<21;i++){\n      long long c=0;\n      for(int j=0;j<21;j++){\n\tc+=(i>>j&1)*t[j];\n      }\n      auto it=s.lower_bound(m-c);\n      if(it!=s.end()){\n\tans=min(ans,llabs(m-*it-c));\n      }\n      if(it!=s.begin()){\n\tit--;\n\tans=min(ans,llabs(m-*it-c));\n      }\n    }\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <queue>\n#include <map>\n#include <set>\n#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <cassert>\nusing namespace std;\n\ntypedef long long ll;\n\n#define REP(i, n) for (ll i = 0; i < (ll)(n); ++i)\n#define FOR(i, a, b) for (ll i = (a); i < (ll)(b); ++i)\n#define FOREQ(i, a, b) for (ll i = (a); i <= (ll)(b); ++i)\n#define DEC(i, k) for (ll i = (k); i >= 0; --i)\n#define FORIT(i, c) for (__tyoeof((c).begin()) i = (c).begin(); i != (c).end(); ++i)\n#define SZ(v) (ll)((v).size())\n#define MEMSET(v, h) memset((v), (h), sizeof(v))\n#define FIND(m, w) ((m).find(w) != (m).end())\n#define ALL(c) (c).begin(), (c).end()\n\nll ticket[1000];\nll ticketSum[1000];\nll n, m, a, b, p, q;\nll cnt;\n\nll calc(ll depth, ll lm) {\n  if (depth == cnt || lm <= 0) { return abs(lm); }\n  if (ticketSum[depth] < lm) { return abs(lm - ticketSum[depth]); }\n  ll ret = m;\n  ret = min(ret, calc(depth + 1, lm));\n  ret = min(ret, calc(depth + 1, lm - ticket[depth]));\n  return ret;\n}\n\nint main() {\n  cin >> n >> m >> a >> b >> p >> q;\n  if (a == 1 && b == 1) {\n    ll use = m / (p + q);\n    use = min(use, n - 1);\n    printf(\"%lld\\n\", min(m - use * (p + q), abs(m - (use + 1) * (p + q))));\n    return 0;\n  }\n  cnt = 0;\n  {\n    ll left = p;\n    ll right = q;\n    REP(i, n) {\n      if (left + right > 2 * m) { break; }\n      ticket[cnt++] = left + right;\n      ll pleft = left;\n      ll pright = right;\n      left *= a;\n      right *= b;\n      if (left / a != pleft || right / b != pright) { break; }\n    }\n  }\n  reverse(ticket, ticket + cnt);\n  MEMSET(ticketSum, 0);\n  for (ll i = cnt; i > 0; i--) {\n    ticketSum[i - 1] = ticket[i - 1] + ticketSum[i];\n  }\n  ll ans = calc(0, m);\n  printf(\"%lld\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  ll MAX=1000000000000LL;\n  \n  assert( 1<= n &&n <= MAX );\n  assert( 1<= m &&m <= MAX );\n  assert( 1<= a &&a <= MAX );\n  assert( 1<= b &&b <= MAX );\n  assert( 1<= p &&p <= MAX );\n  assert( 1<= q &&q <= MAX );\n\n\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    assert(n*m*a*b*p*q!=1);\n\n    if(total <= m)return m-total;\n    \n    return min(m%d,m-m%d);\n    \n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n    if( i==40 )break;\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        ll c=T[i]+U[j];\n        res=min( res,  abs(m-c) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <vector>\n\n#define show(x) cerr << #x << \" = \" << x << endl\n\nusing namespace std;\nusing ld = long double;\nusing ll = long long;\n\ntemplate <typename T>\nostream& operator<<(ostream& os, const vector<T>& v)\n{\n    os << \"[\";\n    for (const auto& e : v) {\n        os << e << \",\";\n    }\n    os << \"] \";\n    os << \"size = \" << v.size() << endl;\n    return os;\n}\n\nint main()\n{\n    ll n, m, a, b, p, q;\n    cin >> n >> m >> a >> b >> p >> q;\n\n    if (p + q > m) {\n        cout << m << endl;\n    } else if (a == b) {\n        cout << m % (p + q) << endl;\n    } else {\n        ll k = 0;\n        ll A = 1;\n        ll B = 1;\n        vector<ll> value;\n        for (; p * A + q * B <= m and k <= n; k++) {\n            value.push_back(p * A + q * B);\n            A *= a;\n            B *= b;\n        }\n        n = k;\n        vector<ll> sum(n);\n        for (int i = 0; i < n; i++) {\n            if (i == 0) {\n                sum[i] = value[i];\n            } else {\n                sum[i] = sum[i - 1] + value[i];\n            }\n        }\n        show(sum);\n\n        ll tot = 0;\n        ll res = m;\n        for (int i = n - 1; i >= 1; i--) {\n            if (sum[i - 1] < res) {\n                if (res < value[i]) {\n                    tot += sum[i - 1];\n                    break;\n                } else {\n                    res -= value[i];\n                    tot += value[i];\n                }\n            } else if (sum[i - 1] == res) {\n                tot = m;\n                break;\n            }\n        }\n        cout << m - tot << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\n#define LINF 1LL<<60\n\n/*\n<url:http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=2239>\n?????????============================================================\n????????????????????????????????±?????????n ????????£?????????. ?????±????????????????????????0 ??????n ??? 1 ?????§???????????????????????????, \nk ???????????±?????????????????¨, p???a^k + q???b^k ?§????????????¨?????§??????.\n\n??????????????????????§???????m ?§???????????§???????????????????????£??????????????????????????????????,???????????????????????¢??????????????????.\n?§????????????????????????§??????.\n?????±?????????????????????????????§???????????¨???????????¨????????¨???, ????????????????°?????§???????????????§??????????????????.\n\n1 ??? n, m, a, b, p, q ??? 10^12 (??´??°)\n=================================================================\n?§£??¬=============================================================\n================================================================\n*/\n\nconst ll MOD = (ll)1e16;\nll powmod(ll a, ll b) { ll res = 1;a %= MOD; assert(b >= 0); for (;b;b >>= 1) { if (b & 1)res = res*a%MOD;a = a*a%MOD; }return res; }\nint main(void) {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\tll n, m, a, b, p, q; cin >> n >> m >> a >> b >> p >> q;\n\tll res = LINF;\n\tif (a == 1 && b == 1) {\n\t\tll k = m / (p + q);\n\t\tres = min({ m,m - k*(p + q),(k + 1)*(p + q) - m });\n\t}else {\n\t\tll N = min(40LL, n);\n\t\tvector<ll> L;\n\t\tfor (int i = 0; i < (1 << (N / 2));i++) {\n\t\t\tll T = 0;\n\t\t\tfor (int j = 0; j < N / 2;j++) {\n\t\t\t\tif ((i >> j) & 1) {\n\t\t\t\t\tT += p*powmod(a, j) + q*powmod(b, j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tL.push_back(T);\n\t\t}\n\t\tL.push_back(LINF);\n\t\tsort(L.begin(), L.end());\n\t\tfor (int i = 0; i < (1 << (N - N / 2));i++) {\n\t\t\tll T = 0;\n\t\t\tfor (int j = 0; j < (N - N / 2);j++) {\n\t\t\t\tif ((i >> j) & 1) {\n\t\t\t\t\tT += p*powmod(a, N / 2 + j) + q*powmod(b, N / 2 + j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tauto it = lower_bound(L.begin(), L.end(), m - T);\n\t\t\tres = min(res, abs(m - T - *it));\n\t\t\tif (it != L.begin()) res = min(res, abs(m - T - *(it - 1)));\n\t\t}\n\t}\n\tcout << res << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\n\nint main(){\n\n\tint POW[21];\n\tfor(int i = 0; i < 21; i++)POW[i] = pow(2,i);\n\n\tll N,M,A,B,P,Q;\n\n\tscanf(\"%lld %lld %lld %lld %lld %lld\",&N,&M,&A,&B,&P,&Q);\n\n\tif(A == 1 && B == 1){\n\n\t\tll num = M/(P+Q);\n\n\t\tif(num >= N){\n\t\t\tprintf(\"%lld\\n\",M-N*(P+Q));\n\t\t}else{\n\t\t\tprintf(\"%lld\\n\",min(M%(P+Q),(num+1)*(P+Q)-M)); //少し足りないと、少し多いの、差が小さい方\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tvector<ll> FIRST;\n\n\tll tmp = P+Q;\n\tll a = 1, b = 1;\n\tll count = 0,over_count = 0;\n\n\tdouble check;\n\n\twhile(true){\n\n\t\tif(tmp > M)over_count++; //超過は1回だけ許す\n\n\t\tFIRST.push_back(tmp);\n\t\tcount++;\n\t\tif(count == N || over_count == 1)break;\n\n\t\tcheck = P*a*A+Q*b*B;\n\t\tif(check > (double)M)break;\n\n\t\ta *= A;\n\t\tb *= B;\n\n\t\ttmp = P*a+Q*b;\n\t}\n\n\t//printf(\"count:%lld\\n\",count);\n\n\t//数字を2つのグループに振り分ける\n\tvector<ll> G[2];\n\tfor(ll i = 0; i < FIRST.size(); i++){\n\t\tif(i <= (FIRST.size())/2){\n\t\t\tG[0].push_back(FIRST[i]);\n\t\t}else{\n\t\t\tG[1].push_back(FIRST[i]);\n\t\t}\n\t}\n\n\tint num[2];\n\tnum[0] = (int)G[0].size();\n\tnum[1] = (int)G[1].size();\n\n\t//printf(\"num_0:%d\\n\",num[0]);\n\n\t//各グループで数字を作る\n\tvector<ll> V[2];\n\tV[1].push_back(0);\n\tfor(int group = 0; group < 2; group++){\n\t\tfor(int state = 0; state < POW[num[group]]; state++){\n\t\t\ttmp = 0;\n\t\t\tfor(int loop = 0; loop < num[group]; loop++){\n\t\t\t\tif(state & (1 << loop)){\n\t\t\t\t\ttmp += G[group][loop];\n\t\t\t\t}\n\t\t\t}\n\t\t\tV[group].push_back(tmp);\n\t\t}\n\t\tsort(V[group].begin(),V[group].end());\n\t\tV[group].erase(unique(V[group].begin(),V[group].end()),V[group].end());\n\t}\n\n\tll ans = M,tmp_ans;\n\n\tint left,right,m,loc;\n\n\tfor(int i = 0; i < V[0].size(); i++){\n\n\t\tif(V[0][i] >= M){\n\t\t\tans = min(ans,V[0][i]-M);\n\t\t\tcontinue;\n\t\t}\n\n\t\t//2分探索で、和がMを超えない、最大のindexを求める\n\t\tleft = 0,right = (int)V[1].size()-1,m = (left+right);\n\t\tloc = 0;\n\n\t\twhile(left <= right){\n\t\t\tif(V[0][i]+V[1][m] <= M){\n\t\t\t\tloc = m;\n\t\t\t\tleft = m+1;\n\t\t\t}else{\n\t\t\t\tright = m-1;\n\t\t\t}\n\t\t\tm = (left+right)/2;\n\t\t}\n\n\t\ttmp_ans = (M-(V[0][i]+V[1][loc]));\n\t\tif(loc < (int)V[1].size()-1){\n\t\t\ttmp_ans = min(tmp_ans,V[0][i]+V[1][loc+1]-M);\n\t\t}\n\t\tans = min(ans,tmp_ans);\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <queue>\n#include <map>\n#include <set>\n#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <cassert>\nusing namespace std;\n\ntypedef long long ll;\n\n#define REP(i, n) for (ll i = 0; i < (ll)(n); ++i)\n#define FOR(i, a, b) for (ll i = (a); i < (ll)(b); ++i)\n#define FOREQ(i, a, b) for (ll i = (a); i <= (ll)(b); ++i)\n#define DEC(i, k) for (ll i = (k); i >= 0; --i)\n#define FORIT(i, c) for (__tyoeof((c).begin()) i = (c).begin(); i != (c).end(); ++i)\n#define SZ(v) (ll)((v).size())\n#define MEMSET(v, h) memset((v), (h), sizeof(v))\n#define FIND(m, w) ((m).find(w) != (m).end())\n#define ALL(c) (c).begin(), (c).end()\n\nll ticket[1000];\nll ticketSum[1000];\nll n, m, a, b, p, q;\nll cnt;\n\nll calc(ll depth, ll lm) {\n  if (depth == cnt || lm <= 0) { return abs(lm); }\n  if (ticketSum[depth] < lm) { return abs(lm - ticketSum[depth]); }\n  ll ret = m;\n  ret = min(ret, calc(depth + 1, lm));\n  ret = min(ret, calc(depth + 1, lm - ticket[depth]));\n  return ret;\n}\n\nint main() {\n  cin >> n >> m >> a >> b >> p >> q;\n  if (a == 1 && b == 1) {\n    ll use = m / (p + q);\n    use = min(use, n - 1);\n    printf(\"%lld\\n\", min(m - use * (p + q), abs(m - (use + 1) * (p + q))));\n    return 0;\n  }\n  cnt = 0;\n  {\n    ll left = p;\n    ll right = q;\n    REP(i, n) {\n      if (left + right > 2 * m) { break; }\n      ticket[cnt++] = left + right;\n      ll pleft = left;\n      ll pright = right;\n      left *= a;\n      right *= b;\n      if (left / a != pleft || right / b != pright) { break; }\n    }\n  }\n  reverse(ticket, ticket + cnt);\n  MEMSET(ticketSum, 0);\n  for (ll i = cnt; i > 0; i--) {\n    ticketSum[i - 1] = ticket[i - 1] + ticketSum[i];\n  }\n  ll ans = calc(0, m);\n  printf(\"%lld\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  ll MAX=1000000000000LL;\n  \n  assert( 1<= n &&n <= MAX );\n  assert( 1<= m &&m <= MAX );\n  assert( 1<= a &&a <= MAX );\n  assert( 1<= b &&b <= MAX );\n  assert( 1<= p &&p <= MAX );\n  assert( 1<= q &&q <= MAX );\n  \n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n\n\n    if(total <= m)return m-total;\n    \n    return m%d;\n    \n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n    if( i==40 )break;\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        ll c=T[i]+U[j];\n        res=min( res,  abs(m-c) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <queue>\n#include <map>\n#include <set>\n#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <cassert>\nusing namespace std;\n\ntypedef long long ll;\n\n#define REP(i, n) for (ll i = 0; i < (ll)(n); ++i)\n#define FOR(i, a, b) for (ll i = (a); i < (ll)(b); ++i)\n#define FOREQ(i, a, b) for (ll i = (a); i <= (ll)(b); ++i)\n#define DEC(i, k) for (ll i = (k); i >= 0; --i)\n#define FORIT(i, c) for (__tyoeof((c).begin()) i = (c).begin(); i != (c).end(); ++i)\n#define SZ(v) (ll)((v).size())\n#define MEMSET(v, h) memset((v), (h), sizeof(v))\n#define FIND(m, w) ((m).find(w) != (m).end())\n#define ALL(c) (c).begin(), (c).end()\n\nll ticket[1000];\nll ticketSum[1000];\nll n, m, a, b, p, q;\nll cnt;\n\nll calc(ll depth, ll lm) {\n  if (depth == cnt || lm <= 0) { return abs(lm); }\n  if (ticketSum[depth] < lm) { return abs(lm - ticketSum[depth]); }\n  ll ret = m;\n  ret = min(ret, calc(depth + 1, lm));\n  ret = min(ret, calc(depth + 1, lm - ticket[depth]));\n  return ret;\n}\n\nint main() {\n  cin >> n >> m >> a >> b >> p >> q;\n  if (a == 1 && b == 1) {\n    ll use = m / (p + q);\n    use = min(use, n - 1);\n    printf(\"%lld\\n\", min(m - use * (p + q), abs(m - (use + 1) * (p + q))));\n    return 0;\n  }\n  cnt = 0;\n  {\n    ll left = p;\n    ll right = q;\n    REP(i, n) {\n      if (left + right > 2 * m) { break; }\n      ticket[cnt++] = left + right;\n      ll pleft = left;\n      ll pright = right;\n      left *= a;\n      right *= b;\n      if (left / a != pleft || right / b != pright) { break; }\n    }\n  }\n  reverse(ticket, ticket + cnt);\n  MEMSET(ticketSum, 0);\n  for (ll i = cnt; i > 0; i--) {\n    ticketSum[i - 1] = ticket[i - 1] + ticketSum[i];\n  }\n  ll ans = calc(0, m);\n  printf(\"%lld\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb push_back\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\ntypedef vector<int>vint;\ntypedef pair<int,int>pint;\ntypedef vector<pint>vpint;\n\ntemplate<typename A,typename B>inline void chmin(A &a,B b){if(a>b)a=b;}\ntemplate<typename A,typename B>inline void chmax(A &a,B b){if(a<b)a=b;}\n\nint N,M,A,B,P,Q;\n\nint ans;\n\nvoid dfs(int n,int lim,int s,int x,int y){\n    if(n==0||lim==0)return;\n    chmin(ans,abs(M-s));\n\n    if(1.0*x*A>1e18)return;\n    if(1.0*y*B>1e18)return;\n    dfs(n-1,lim-1,s,x*A,y*B);\n    dfs(n-1,lim-1,s+x+y,x*A,y*B);\n}\n\nsigned main(){\n    cin>>N>>M>>A>>B>>P>>Q;\n\n    if(A>B){\n        swap(A,B);swap(P,Q);\n    }\n    \n    ans=M;\n    dfs(N,26,0,P,Q);\n    if(B==1){\n        P+=Q;\n        int x=M/P*P;\n        chmin(ans,abs(M-x));\n        chmin(ans,abs(M-(x+P)));\n    }\n    else if(A==1&&B==2){\n    }\n    else if(B==2){\n        P+=Q;\n        int x=M/P*P;\n        if(N>50||M/P<(1ll<<N)){\n            chmin(ans,abs(M-x));\n        }\n        if(N>50||M/P+1<(1ll<<N)){\n            chmin(ans,abs(M-(x+P)));\n        }\n    }\n    cout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 1LL<<50;\nll n,m,a,b,p,q;\n\nll calc(ll k){\n  ll A = 1,B = 1;\n  ll res = p+q;\n  while(0<res&&res<=INF&&k--)A*=a,B*=b,res=p*A+q*B;\n  if(res<0||res>INF)return -1; \n  return res;\n}\n\n\nll ans = INF;\ntypedef pair<ll,ll> P;\nset<P> used;\nvoid dfs(ll pos,ll sum){\n  assert(sum>=0);\n  ans = min(ans,(ll)abs(m-sum));\n  if(pos>=n||sum<0LL||sum>INF) return;\n  if(used.count(P(pos,sum))) return ;\n  used.insert(P(pos,sum));\n\n  \n  ll r = calc(pos);\n  if(r<=0) return;\n  dfs(pos+1,sum+r);  \n  dfs(pos+1,sum);\n}\n\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  if(max(a,b)==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - (p+q));\n    if(m/(p+q)==n) t = INF;\n    if(m/(p+q)<=n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n  }\n  \n  dfs(0,0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long int64;\n\nint main()\n{\n  int64 N, M, A, B, P, Q;\n\n  cin >> N >> M >> A >> B >> P >> Q;\n\n  if(A == 1 && B == 1) {\n    int64 T = P + Q;\n    if(N < (M + T - 1) / T) {\n      cout << M - T * N << endl;\n    } else {\n      cout << min(M % T, T - M % T) << endl;\n    }\n  } else {\n    int64 PA = P, QB = Q;\n    vector< int64 > vs;\n    for(int i = 0; i < min(42LL, N); i++) {\n      vs.push_back(PA + QB);\n      if((double) PA * A + QB * B > 1e18) break;\n      PA *= A;\n      QB *= B;\n    }\n\n    int mid = vs.size() / 2;\n    int rest = vs.size() - mid;\n    vector< int64 > ss(1 << mid, 0);\n    for(int i = 0; i < (1 << mid); i++) {\n      for(int j = 0; j < mid; j++) {\n        if((i >> j) & 1) ss[i] += vs[j];\n      }\n    }\n    sort(begin(ss), end(ss));\n    ss.erase(unique(begin(ss), end(ss)), end(ss));\n\n    int64 ret = 1LL << 60;\n    for(int i = 0; i < (1 << rest); i++) {\n      int64 now = 0;\n      for(int j = 0; j < rest; j++) {\n        if((i >> j) & 1) now += vs[mid + j];\n      }\n      auto ptr = lower_bound(begin(ss), end(ss), M - now);\n      if(ptr != ss.end()) ret = min(ret, llabs(M - now - *ptr));\n      if(ptr != ss.begin()) ret = min(ret, llabs(M - now - *--ptr));\n    }\n\n    cout << ret << endl;\n\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (int)(k); i < (int)(n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\n\nll pow(ll x, ll n)\n{\n\tll res = 1;\n\twhile (n > 0)\n\t{\n\t\tif (n & 1) res = res * x;\n\t\tx = x*x;\n\t\tn >>= 1;\n\t}\n\treturn res;\n}\n\nll n, m, a, b, p, q;\n\nll calc(ll k)\n{\n\treturn p * pow(a, k) + q * pow(b, k);\n}\n\nbool check(ld k)\n{\n\treturn p * pow(a, k) + q * pow(b, k) <= pow(10, 12);\n}\n\nll use(ll d)\n{\n\tll loop = min(n + 1, 42ll);\n\tll res = n - 1;\n\tREP(i, loop)\n\t{\n\t\tif (!check(i) || calc(i) > d)\n\t\t{\n\t\t\tres = i - 1;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\nint main()\n{\n\tcin.sync_with_stdio(false); cout << fixed << setprecision(10);\n\tcin >> n >> m >> a >> b >> p >> q;\n\tll ans = LLONG_MAX;\n\tif (a == 1 && b == 1)\n\t{\n\t\tif (((ld)p + q) * n < (ld)m) ans = m - (p + q) * n;\n\t\telse\n\t\t{\n\t\t\tll t = m / (p + q);\n\t\t\tans = min(m - (p + q) * t, (p + q)*(t + 1) - m);\n\t\t}\n\t}\n\telse if (a > 1 && b > 1)\n\t{\n\t\tset<int> st;\n\t\tll d = m;\n\t\tint cnt = 0, mx = n;\n\t\tint loop = min(n + 1, 41ll);\n\t\twhile (st.size() < loop)\n\t\t{\n\t\t\tll t = use(d);\n\t\t\tif (t + 1 < n && !st.count(t + 1) && d < calc(t + 1))\n\t\t\t{\n\t\t\t\tchmin(ans, calc(t + 1) - d);\n\t\t\t}\n\t\t\tif (t < 0) break;\n\t\t\tll tmp = min(n, t);\n\t\t\twhile (st.count(tmp) && tmp > 0) tmp--;\n\t\t\tif (tmp == 0 && st.count(0)) break;\n\t\t\td -= calc(tmp);\n\t\t\tst.insert(tmp);\n\t\t\tchmin(ans, d);\n\t\t}\n\t\tchmin(ans, d);\n\t}\n\telse\n\t{\n\t\tif (a > b) swap(a, b);\n\t\tint loop = min(n + 1, 41ll);\n\t\tREP(i, loop)\n\t\t{\n\t\t\tset<int> st;\n\t\t\tll d = m;\n\t\t\tint cnt = 0, mx = n;\n\t\t\twhile (st.size() < i)\n\t\t\t{\n\t\t\t\tll t = use(d);\n\t\t\t\tif (t < 0) break;\n\t\t\t\tll tmp = min(n - 1, t);\n\t\t\t\twhile (st.count(tmp) && tmp > 0) tmp--;\n\t\t\t\tif (tmp == 0 && st.count(0)) break;\n\t\t\t\td -= calc(tmp);\n\t\t\t\tst.insert(tmp);\n\t\t\t}\n\t\t\tif (st.size() == i - 1)\n\t\t\t{\n\t\t\t\tif (!st.count(0))\n\t\t\t\t{\n\t\t\t\t\tchmin(ans, calc(0) - d);\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse if (st.size() != i) continue;\n\t\t\tchmin(ans, d);\n\t\t\tif (st.size() > 0)\n\t\t\t{\n\t\t\t\tint last = *st.begin();\n\t\t\t\tif (last + 1 < n && !st.count(last + 1))\n\t\t\t\t{\n\t\t\t\t\td = d + calc(last) - calc(last + 1);\n\t\t\t\t\tchmin(ans, -d);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=__int128;\n\nusing ll2=long long;\n\nconst ll INF=1e15;\n\nll powi(ll x,ll k){\n    ll res=1;\n    while(k){\n        if(k&1) res*=x;\n        if(res>INF) return INF;\n        x*=x;\n        k>>=1;\n    }\n    return res;\n}\nint main(){\n    ll2 nn,mm,aa,bb,pp,qq;\n    cin>>nn>>mm>>aa>>bb>>pp>>qq;\n    ll n=nn,m=mm,a=aa,b=bb,p=pp,q=qq;\n    if(a>=2 || b>=2){\n        int tn=min(n,ll(44));\n        int half=tn/2;\n        vector<ll> vec(1<<half);\n        for(int i=0;i<(1<<half);i++){\n            ll val=0;\n            for(int j=0;j<half;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,j)+q*powi(b,j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            vec[i]=val;\n\n        }\n        int rest=tn-half;\n        set<ll> s;\n        for(int i=0;i<(1<<rest);i++){\n            ll val=0;\n            for(int j=0;j<rest;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,half+j)+q*powi(b,half+j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            s.insert(val);\n        }\n        ll2 res=m;\n        for(int i=0;i<vec.size();i++){\n            auto it=s.lower_bound(m-vec[i]);\n            if(it!=s.end()){\n        \n                res=min(res,ll2(abs(m-vec[i]-*it)));\n            }\n            if(it!=s.begin()){\n                it--;\n\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n        }\n        cout<<res<<endl;\n    }\n    else{\n        if((p+q)*n>=m){\n            cout<<ll2(min(m%(p+q),(p+q)-m%(p+q)))<<endl;\n        }\n        else{\n            cout<<ll2(m-(p+q)*n)<<endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cassert>\n#include<climits>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\ntypedef long long ll;\n\nvector<ll> generate(vector<ll> a){\n  vector<ll> ret;\n  int n = a.size();\n  rep(i,(1<<n)){\n    ll tmp = 0;\n    rep(j,n){\n      if ((1<<j)&i)tmp += a[j];\n    }\n    ret.push_back(tmp);\n  }\n  sort(ret.begin(),ret.end());\n  return ret;\n}\n\nll bs(ll m,ll sum,vector<ll> &a,bool fg){\n  int ret = -1;\n  int l = 0,r = a.size()-1;\n  while(l <= r){\n    int mid = (l+r)/2;\n    ll tmp = sum + a[mid];\n    if (fg){\n      if (tmp <= m){//ä¸éããã£ã¨ä¸ããã\n\tret = mid;\n\tl = mid+1;\n      }else {\n\tr = mid-1;\n      }\n    }else {\n      if (tmp >= m){\n\tret = mid;\n\tr = mid-1;\n      }else {\n\tl = mid+1;\t\n      }\n    }\n  }\n\n  /*  cout <<\"dbg\" << endl;\n  rep(i,a.size())cout << a[i] <<\" \" ;cout << endl;\n  cout <<fg <<\" \" <<  m <<\" \" << sum <<\" \" << (ret != -1?a[ret]:-1) <<\" \" << \n    ((ret != -1)?sum+a[ret]:-1)\n       << endl;\n  */\n  if (ret == -1)return llabs(m-sum);\n  //cout << m <<\" \" << sum+a[ret] << \" \" << llabs(m-(sum+a[ret])) << endl;\n  return llabs(m-(sum+a[ret]));\n}\n\nll ans;\nvoid search(int n,int now,ll sum,ll m,vector<ll> &a,vector<ll> &all){\n  //ub,sumã¨aã®è¦ç´ ã§ãmä»¥ä¸ã§æå¤§ã®ãã®ãæ¢ã\n  //lb,sumã¨aã®è¦ç´ ã®åã§mä»¥ä¸æå°ã®ãã®ãæ¢ã\n  ll ub=bs(m,sum,all,true),lb=bs(m,sum,all,false);\n  ans = min(ans,ub);\n  ans = min(ans,lb);\n  if (now == n)return;\n  //ä½¿ã\n  search(n,now+1,sum+a[now],m,a,all);\n  //ä½¿ããªã\n  search(n,now+1,sum,m,a,all);\n}\n\n/*\n  ååå¨åæãã ãã¡ã¢ãªç¯ç´ãããã®ã§å¾ãååã¯æ¢ç´¢ããã\n */\nll solve2(vector<ll> in,ll m){\n  vector<ll> mae,usiro;\n  rep(i,in.size()){\n    if (i < in.size()/2)mae.push_back(in[i]);\n    else usiro.push_back(in[i]);\n  }\n  vector<ll> all=generate(mae);\n  ans = m;\n  search(usiro.size(),0,0,m,usiro,all);\n  return ans;\n}\n\nll solve(ll n,ll m,ll a,ll b,ll p,ll q){\n  if (a == 1 && b == 1){//ç¹æ®ã±ã¼ã¹\n    ll sum = p+q;\n    ll lb = min(n,m/sum),ub=min(n,(m+sum-1)/sum);\n    ll ret = m;\n    ret = min(ret,llabs(m-lb*(sum)));\n    ret = min(ret,llabs(m-ub*(sum)));\n    return ret;\n  }\n\n  //ãã±ããã®çæ\n  //ä¸å¿doubleåã§å¤ã¯åãæ±ã£ã¦ããã\n  //å¿è¦ãªãã±ããã¯æå¤§ï¼ï¼æã§ãããä»¥ä¸ã¯æå³ããªãã\n  int loop = 0;\n  ll cur = p + q;\n  ll mula=1,mulb=1;\n  double m_d=m;\n  double cur_d = p + q;\n  double mula_d = 1, mulb_d = 1;\n  vector<ll> all;\n  all.push_back(cur);\n  while(cur_d <= m_d && loop < n){\n    mula_d *= a;\n    mulb_d *= b;\n    cur_d   = p*mula_d + q*mulb_d;\n    if (cur_d > 2*m)break;\n    mula *= a;\n    mulb *= b;\n    cur = p*mula + q*mulb;\n    all.push_back(cur);\n\n  }\n\n  //rep(i,all.size())assert(all[i] > 0);\n  //rep(i,all.size())cout << all[i] <<\" \" ;cout << endl;\n\n  if (all.size() == 1){//ä¸ã¤ããä½¿ãããã±ããããªããªããããç­ãã«ããã(å¿ãï¼æã¯ãããã¨ãä¿è¨¼ããã¦ãã)\n    return min(m,llabs(all[0]-m));\n  }\n  return solve2(all,m);\n}\n\nmain(){\n  ll n,m,a,b,p,q;\n  while(cin>>n>>m>>a>>b>>p>>q && n){\n    cout << solve(n,m,a,b,p,q)  << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dist[40];\nint main(){\n\tlong long a,b,c,d,e,f;\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&a,&b,&c,&d,&e,&f);\n\tif(c==1&&d==1){\n\t\tlong long v=b%(e+f);\n\t\tlong long g=b/(e+f);\n\t\tprintf(\"%lld\\n\",v+max(0LL,g-a));\n\t\treturn 0;\n\t}\n\tint sz=0;\n\tfor(int i=0;i<=a;i++){\n\t\tlong long L=e;\n\t\tlong long R=f;\n\t\tlong long Q=b;\n\t\tfor(int j=0;j<i;j++)Q/=max(c,d);\n\t\tif(Q==0)break;\n\t\tfor(int j=0;j<i;j++)L*=c;\n\t\tfor(int j=0;j<i;j++)R*=d;\n\t\tlong long t=L+R;\n\t\tif(t>b)break;\n\t\tdist[sz++]=t;\n\t//\tprintf(\"%lld \",dist[sz-1]);\n\t}\n\tif(d==1){\n\t\tswap(c,d);\n\t\tswap(e,f);\n\t}\n\tif(c==1){\n\t\tlong long ret=b;\n\t\tfor(int i=0;i<sz;i++)dist[i]-=e;\n\t\tfor(int i=1;i<=sz;i++){\n\t\t\tlong long tmp=b-(long long)i*e;\n\t\t\tif(tmp<0)break;\n\t\t\tint rem=i;\n\t\t\tfor(int j=sz-1;j>=0;j--){\n\t\t\t\tif(tmp>=dist[j]){\n\t\t\t\t\trem--;\n\t\t\t\t\ttmp-=dist[j];\n\t\t\t\t}else{\n\t\t\t\t\tlong long cost=dist[j]-tmp;\n\t\t\t\t\tif(rem-1<=j){\n\t\t\t\t\t\tfor(int k=0;k<rem-1;k++){\n\t\t\t\t\t\t\tcost+=dist[k];\n\t\t\t\t\t\t}\n\t\t\t\t//\t\tprintf(\"%d %d: %lld\\n\",i,j,cost);\n\t\t\t\t\t\tret=min(ret,cost);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(rem==0)break;\n\t\t\t}\n\t\t\t\n\t\t\tif(rem==0)ret=min(ret,tmp);\n\t\t\t//printf(\"%d: %lld\\n\",i,ret);\n\t\t}\n\t\tprintf(\"%lld\\n\",ret);\n\t\treturn 0;\n\t}\n\tlong long ret=b;\n\tlong long tmp=b;\n\tfor(int i=sz-1;i>=0;i--){\n\t\tif(tmp>=dist[i])tmp-=dist[i];\n\t\telse ret=min(ret,dist[i]-tmp);\n\t\tret=min(ret,tmp);\n\t}\n\tprintf(\"%lld\\n\",ret);\n}\n//11 12 14 18"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb push_back\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\ntypedef vector<int>vint;\ntypedef pair<int,int>pint;\ntypedef vector<pint>vpint;\n\ntemplate<typename A,typename B>inline void chmin(A &a,B b){if(a>b)a=b;}\ntemplate<typename A,typename B>inline void chmax(A &a,B b){if(a<b)a=b;}\n\nint N,M,A,B,P,Q;\n\nvoid dfs(int k,int n,int s,vint &v,vint &latte){\n    if(k==n){\n        latte.pb(s);\n        return;\n    }\n    dfs(k+1,n,s,v,latte);\n    dfs(k+1,n,s+v[k],v,latte);\n}\n\nsigned main(){\n    cin>>N>>M>>A>>B>>P>>Q;\n\n    if(A==1&&B==1){\n        P+=Q;\n        int ans=M;\n        if(M/P>N)chmin(ans,abs(M-P*N));\n        else{\n            chmin(ans,abs(M-M/P*P));\n            if(M/P+1<=N)chmin(ans,abs(M-M/P*P-P));\n        }\n        cout<<ans<<endl;\n        return 0;\n    }\n    vector<int>v;\n    int x=P,y=Q;\n    for(int i=0;i<N;i++){\n        v.pb(x+y);\n        if(1.0*x*A>||1.0*y*B>1e15||x+y>M)break;\n        x*=A;y*=B;\n    }\n\n    int n=v.size()/2;\n    vint latte,malta;\n    dfs(0,n,0,v,latte);\n    dfs(n,v.size(),0,v,malta);\n    sort(all(latte));\n    sort(all(malta));\n\n\n    int ans=M;\n\n    int cur=latte.size()-1;\n    for(int i=0;i<malta.size();i++){\n        while(cur&&latte[cur]+malta[i]>M)cur--;\n        chmin(ans,abs(M-latte[cur]-malta[i]));\n    }\n\n    cur=0;\n    for(int i=(int)malta.size()-1;i>=0;i--){\n        while(cur+1!=latte.size()&&latte[cur]+malta[i]<M)cur++;\n        chmin(ans,abs(M-latte[cur]-malta[i]));\n    }\n\n    cout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-10;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\nint K, R, L;\nld P;\nld E;\nld T;\n\n\nlong long int atime(const long long int l, const long long int r) {\n\tif (l > LLONG_MAX / r) {\n\t\treturn LLONG_MAX;\n\t}\n\telse {\n\t\treturn l*r;\n\t}\n}\nlong long int powint(long long int a, long long int b) {\n\tif (!b)return 1;\n\telse {\n\t\treturn atime(a, powint(a, b - 1));\n\t}\n}\n\nlong long int aplus(const long long int l, const long long int r) {\n\tif (l > LLONG_MAX / 3 || R > LLONG_MAX)return LLONG_MAX;\n\telse return l + r;\n}\n//ld getans(const ld amin, const ld amax,const int rest,const ld per) {\n//\tif (!rest||per<4e-8) {\n//\t\treturn abs((amin + amax) / 2 - T) < E+eps;\n//\t}\n//\tif (amin > E + T+eps)return 0;\n//\tif (amax < T-E - eps)return 0;\n//\tif (amin > T - E - eps&&T + E + eps < amax)return 1;\n//\tld amid = (amin + amax) / 2;\n//\tif (amid > T-eps) {\n//\t\treturn getans(amin, amid,rest-1,per*(1-P))*(1-P) + getans(amid, amax,rest-1,per*P)*P;\n//\t}\n//\telse {\n//\t\treturn getans(amin, amid, rest - 1,per*P)*P + getans(amid, amax, rest - 1,per*(1-P))*(1 - P);\n//\t}\n//}\n\nvoid getans(const vector<long long int>& sums,const vector<long long int>&tickets, const int now, long long int &ans,const long long int rest) {\n\tif (now == tickets.size()) {\n\t\tans = min(ans, rest);\n\t\treturn;\n\t}\n\tif (ans < rest - sums[now])return;\n\t\n\tif (rest >= tickets[now]) {\n\t\tgetans(sums, tickets, now + 1, ans, rest - tickets[now]);\n\t}\n\telse {\n\t\tans = min(ans, tickets[now] - rest);\n\t}\n\tgetans(sums, tickets, now + 1, ans, rest);\n}\nint main() {\n\t//cin >> K >> R >> L;\n\t//cin >> P >> E >> T;\n\t//ld ans = getans(R, L, K,1);\n\t//cout << setprecision(22) << fixed << ans << endl;\n\t//return 0;\n\tlong long int N, M, A, B, P, Q; cin >> N >> M >> A >> B >> P >> Q;\n\tif (A > B) {\n\t\tswap(A, B);\n\t\tswap(P, Q);\n\t}\n\tassert(A <= B);\n\tif (A == 1 && B == 1) {\n\t\tlong long int ticdis = P + Q;\n\t\tif (atime(ticdis,N) <= M) {\n\t\t\tcout << M - atime(ticdis, N) << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << min(ticdis-M%ticdis,M%ticdis) << endl;\n\t\t}\n\t}\n\telse {\n\t\tvector<long long int>tickets;\n\t\tlong long\tint ans = M;\n\t\tfor (int k = 0; k < N; ++k) {\n\t\t\tlong long int tic =aplus( atime(P, powint(A, k)), atime(Q, powint(B, k)));\n\t\t\tif (tic > M) {\n\t\t\t\tans = min(ans, tic - M);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttickets.emplace_back(tic);\n\t\t\t}\n\t\t}\n\t\treverse(tickets.begin(), tickets.end());\n\t\tvector<long long int>sums(tickets);\n\t\tfor (int i = sums.size()-1; i >0; --i) {\n\t\t\tsums[i - 1] += sums[i];\n\t\t}\n\t\tgetans(sums, tickets, 0, ans, M);\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define X begin()\n#define Y end()\n#define N 41\nusing namespace std;\ntypedef long long ll;\nll n,m,a,b,p,q,d[N];\nvector<ll> v[2],x[2];\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll ans=m;\n  if(a==1&&b==1){\n    ll ti=min(n,m/(p+q));\n    ans=min(ans,min(m-ti*(p+q),abs(min(ti+1,n)*(p+q)-m)));\n  }\n  ll A=1,B=1,T=min((ll)N,n);\n  for(int i=0;i<T;i++){\n    d[i]=p*A+q*B;\n    if(i<T/2)v[0].push_back(d[i]);\n    else v[1].push_back(d[i]);\n    if(d[i]>m)break;\n    A*=a,B*=b;\n  }\n  int len[2]={v[0].size(),v[1].size()};\n  for(int i=0;i<2;i++){\n    v[i].push_back(0);\n    for(int j=0;j<(1<<len[i]);j++){\n      ll sum=0;\n      for(int k=0;k<len[i];k++)\n\tif((j&(1<<k)))sum+=v[i][k];\n      x[i].push_back(sum);\n    }\n    sort(x[i].X,x[i].Y);\n  }\n  for(int i=0;i<x[0].size();i++){\n    ll S=m-x[0][i];\n    vector<ll>::iterator r=lower_bound(x[1].X,x[1].Y,S);\n    if(r!=x[1].Y)ans=min(ans,(*r)-S);\n    if(r!=x[1].X)ans=min(ans,S-(*(r-1)));\n  }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\tll n,m,a,b,p,q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\t\n\tif(a == 1 && b == 1){\n\t\tll x = m/(p+q);\n\t\tx = min ( x , n-1 );\n\t\tcout << min ( m-x*(p+q) , (x+1)*(p+q)-m ) << endl;\n\t}\n\telse {\n\t\tvector<ll> vec;\n\t\tll s = 1 , t = 1;\n\t\tfor(int i = 0 ; i < n ; i ++){\n\t\t\tvec.push_back(p*s+q*t);\n\t\t\tif(p*s+q*t > m)break;\n\t\t\ts *= a;\n\t\t\tt *= b;\n\t\t}\n\t\tint N = vec.size();\n\t\tvector<ll> A,B;\n\t\tA.push_back(0);\n\t\tfor(int i = 0 ; i < N/2 ; i ++){\n\t\t\tint x = A.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tA.push_back(vec[i]+A[j]);\n\t\t\t}\n\t\t}\n\t\tB.push_back(0);\n\t\tfor(int i = N/2 ; i < N ; i ++){\n\t\t\tint x = B.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tB.push_back(vec[i]+B[j]);\n\t\t\t}\n\t\t}\n\t\tsort(B.begin(),B.end());\n\t\tB.erase(unique(B.begin(),B.end()),B.end());\n\t\tll ret = m;\n\t\tfor(int i = 0 ; i < A.size() ; i ++){\n\t\t\tint x = upper_bound(B.begin(),B.end(),m-A[i])-B.begin();\n\t\t\tif(x < B.size())ret = min ( ret , A[i]+B[x]-m );\n\t\t\tx --;\n\t\t\tret = min ( ret , m-A[i]-B[x] );\n\t\t}\n\t\tcout << ret << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=__int128;\n\nusing ll2=long long;\n\nconst ll INF=1e15;\n\nll powi(ll x,ll k){\n    ll res=1;\n    while(k){\n        if(k&1) res*=x;\n        if(res>INF) return INF;\n        x*=x;\n        k>>=1;\n    }\n    return res;\n}\nint main(){\n    ll2 nn,mm,aa,bb,pp,qq;\n    cin>>nn>>mm>>aa>>bb>>pp>>qq;\n    ll n=nn,m=mm,a=aa,b=bb,p=pp,q=qq;\n    if(a>=2 || b>=2){\n        int tn=min(n,ll(41));\n        int half=min((tn*2)/3,24);\n        vector<ll> vec(1<<half);\n        for(int i=0;i<(1<<half);i++){\n            ll val=0;\n            for(int j=0;j<half;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,j)+q*powi(b,j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            vec[i]=val;\n\n        }\n        int rest=tn-half;\n        set<ll> s;\n        for(int i=0;i<(1<<rest);i++){\n            ll val=0;\n            for(int j=0;j<rest;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,half+j)+q*powi(b,half+j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            s.insert(val);\n        }\n        ll2 res=m;\n        for(int i=0;i<vec.size();i++){\n            auto it=s.lower_bound(m-vec[i]);\n            if(it!=s.end()){\n        \n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n            if(it!=s.begin()){\n                it--;\n\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n        }\n        cout<<res<<endl;\n    }\n    else{\n        if((p+q)*n>=m){\n            cout<<ll2(min(m%(p+q),(p+q)-m%(p+q)))<<endl;\n        }\n        else{\n            cout<<ll2(m-(p+q)*n)<<endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "// g++ -std=c++11 a.cpp\n#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>   \n#include<map>\n#include<set>\n#include<unordered_map>\n#include<utility>\n#include<cmath>\n#include<random>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<bitset>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#include<typeinfo>\n#define loop(i,a,b) for(ll i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define FOR(i,a) for(auto i:a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n#define show1d(v) rep(i,v.size())cout<<\" \"<<v[i];cout<<endl<<endl;\n#define show2d(v) rep(i,v.size()){rep(j,v[i].size())cout<<\" \"<<v[i][j];cout<<endl;}cout<<endl;\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\n//#define int ll\ntypedef ll Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n#define mt make_tuple\ntypedef tuple<int,int,int,int> tp;\ntypedef vector<tp> vt;\ntemplate<typename A,typename B>bool cmin(A &a,const B &b){return a>b?(a=b,true):false;}\ntemplate<typename A,typename B>bool cmax(A &a,const B &b){return a<b?(a=b,true):false;}\n//template<class C>constexpr int size(const C &c){return (int)c.size();}\n//template<class T,size_t N> constexpr int size(const T (&xs)[N])noexcept{return (int)N;}\nconst double PI=acos(-1);\nconst double EPS=1e-9;\nDef inf = sizeof(Def) == sizeof(long long) ? 2e18 : 1e9+10;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\nint main(){\n\tll n,m,a,b,p,q;\n\tcin>>n>>m>>a>>b>>p>>q;\n\tvi A,B;\n\tll t=p;\n\twhile(1){\n\t\tA.pb(t);\n\t\tif(to_string(t).size()+to_string(a).size()>16)break;\n\t\tt*=a;\n\t\tif(a==1)break;\n\t}\n\tt=q;\n\twhile(1){\n\t\tB.pb(t);\n\t\tif(to_string(t).size()+to_string(b).size()>16)break;\n\t\tt*=b;\n\t\tif(b==1)break;\n\t}\n\t//show1d(A);\n\t//show1d(B);\n\tvi in;\n\trep(i,min((ll)A.size(),n))\n\t\tif(i<B.size()&&A[i]+B[i]<=3*m)in.pb(A[i]+B[i]);\n\tn=in.size()/2;\n\tll N=1<<n;\n\tvi dp;\n\trep(i,N){\n\t\tll sum=0;\n\t\trep(j,n)if(i&1<<j)sum+=in[j];\n\t\tif(sum<=3*m)dp.pb(sum);\n\t}\n\tsort(all(dp));\n\tll nn=in.size()-n;\n\tN=1<<nn;\n\tll out=m;\n//\tshow1d(in);\n\trep(i,N){\n\t\tll sum=0;\n\t\trep(j,nn)if(i&1<<j)sum+=in[n+j];\n\t\tif(sum>3*m)continue;\n\t\tauto it=upper_bound(all(dp),m-sum);\n\t\tif(it!=dp.end())out=min(out,abs(*it+sum-m));\n\t\tif(it==dp.begin())continue;\n\t\tit--;\n\t\tout=min(out,abs(*it+sum-m));\n\t}\n//\tshow1d(dp);\n\tcout<<out<<endl;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 1LL<<50;\nll Sum[100];\nll n,m,a,b,p,q;\n\n\nll calc(ll k){\n  static ll used[101]={},mem[101]={};\n  if(used[k]++) return mem[k];\n  ll A = 1,B = 1;\n  ll &res =mem[k]=p+q;\n  while(0<res&&res<=INF&&k--)A*=a,B*=b,res=p*A+q*B;\n  if(res<0||res>INF)res=-1; \n  return res;\n}\n\n\nll ans = INF;\nset<ll> used[101];\nvoid dfs(ll pos,ll sum){\n  if(pos==-1||sum<0LL||sum>INF) return;\n  if(Sum[pos]>0&&Sum[pos]+sum<m){ans=min(ans,m-Sum[pos]-sum);return;}\n  ans = min(ans,(ll)abs(m-sum));\n  if(m<sum) return;\n  if(used[pos].count(sum)) return ;\n  used[pos].insert(sum);\n  \n  ll r = calc(pos);\n  if(r>0&&sum+r<INF)dfs(pos-1,sum+r);  \n  dfs(pos-1,sum);\n}\n\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  Sum[0] = calc(0);\n  for(int i=1;i<50;i++) if(calc(i)>0)Sum[i] = calc(i)+Sum[i-1];\n  if(max(a,b)==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - (p+q));\n    if(m/(p+q)==n) t = INF;\n    if(m/(p+q)<=n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n  }\n  \n  dfs(50,0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\nusing namespace std;\n\nlong long vals[50];\nlong long N;\nlong long M;\n\nlong long dfs(int id,int toTake,int taken,long long curVal,bool flg){\n//\tprintf(\"%d %d %d %lld\\n\",id,toTake,taken,curVal);\n\tif(id==-1){\n\t\tif(taken==toTake) return curVal;\n\t\telse return -1;\n\t}\n\tif(toTake==taken){\n\t\treturn curVal;\n\t}\n\tlong long nxtVal=curVal+vals[id];\n//\tprintf(\"nxt=%lld\\n\",nxtVal);\n\tlong long res=-1;\n\tif(nxtVal>M){\n\t\tres=dfs(id-1,toTake,taken,curVal,flg);\n\t\treturn res;\n\t}\n\tif(flg==false){\n\t\t//not take\n\t\tres=dfs(id-1,toTake,taken,curVal,true);\n\t}\n\tlong long res2=dfs(id-1,toTake,taken+1,nxtVal,flg);\n\tres=max(res,res2);\n\treturn res;\n}\n\nlong long mult(long long a,long long b,long long c){\n\tlong long x=c/a;\n\tif(b>x) return -1;\n\tlong long res=a*b;\n\tif(res>c) return -1;\n\treturn res;\n}\n\nint main(){\n\tlong long a,b,p,q;\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&N,&M,&a,&b,&p,&q);\n\tif(a==1&&b==1){\n\t\tlong long x=p+q;\n\t\tlong long num=M/x;\n\t\tnum=min(num,N);\n\t\tlong long train=x*num;\n\t\tprintf(\"%lld\\n\",M-train);\n\t\treturn 0;\n\t}\n\tlong long pa=1,pb=1;\n\tint n=0;\n\tfor(int i=0;i<N;i++){\n\t\tlong long cur1=mult(pa,p,M);\n\t\tlong long cur2=mult(pb,q,M);\n\t\tif(cur1==-1||cur2==-1) break;\n\t\tlong long cur=cur1+cur2;\n\t\tif(cur>M) break;\n\t\tvals[n++]=cur;\n\t\tpa=mult(pa,a,M);\n\t\tpb=mult(pb,b,M);\n\t\tif(pa==-1||pb==-1) break;\n\t}\n\tif(n==0){\n\t\tprintf(\"%lld\\n\",M);\n\t\treturn 0;\n\t}\n//\tfor(int i=0;i<n;i++){\n//\t\tprintf(\"%d %lld\\n\",i,vals[i]);\n//\t}\n\tN=n;\n\tlong long ans=M;\n\tfor(int i=1;i<=n;i++){\n\t\tlong long tmp=dfs(n-1,i,0,0,false);\n//\t\tprintf(\"%d %lld\\n\",i,tmp);\n\t\tif(tmp==-1) continue;\n\t\tans=min(ans,M-tmp);\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cmath>\n#include<cstdio>\n#include<vector>\n#include<algorithm>\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\tll n,m,a,b,p,q; scanf(\"%lld%lld%lld%lld%lld%lld\",&n,&m,&a,&b,&p,&q);\n\n\tll ans=llabs(n*(p+q)-m);\n\tif(a==1 && b==1){\n\t\tll i=m/(p+q);\n\t\tfor(int j=-3;j<=3;j++) if(0<=i+j && i+j<=n) ans=min(ans,llabs((i+j)*(p+q)-m));\n\t}\n\telse{\n\t\tint N;\n\t\tll num[40];\n\t\tfor(int k=0;;k++){\n\t\t\tnum[k]=p*pow(a,k)+q*pow(b,k);\n\t\t\tif(k==n-1 || num[k]>1e9){\n\t\t\t\tN=k+1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(N%2==1) num[N++]=0;\n\n\t\tvector<ll> half1,half2;\n\t\trep(S,1<<N/2){\n\t\t\tbool ok1=true,ok2=true;\n\t\t\tll sum1=0,sum2=0;\n\t\t\trep(i,N/2) if(S>>i&1) {\n\t\t\t\tsum1+=num[i];\n\t\t\t\tsum2+=num[i+N/2];\n\t\t\t\tif(sum1>2e9) ok1=false;\n\t\t\t\tif(sum2>2e9) ok2=false;\n\t\t\t}\n\t\t\tif(ok1) half1.push_back(sum1);\n\t\t\tif(ok2) half2.push_back(sum2);\n\t\t}\n\t\thalf1.push_back(0);\n\t\thalf2.push_back(0);\n\n\t\tsort(half1.begin(),half1.end());\n\t\tsort(half2.begin(),half2.end());\n\n\t\trep(i,half1.size()){\n\t\t\tint j=lower_bound(half2.begin(),half2.end(),m-half1[i])-half2.begin();\n\t\t\tif(j<half2.size()) ans=min(ans,llabs(half1[i]+half2[ j ]-m));\n\t\t\tif(j>0)            ans=min(ans,llabs(half1[i]+half2[j-1]-m));\n\t\t}\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nbool ch(int a,int b){\n  int x=1000000000000000LL;\n  x/=a;\n  x/=b;\n  return x==0;\n}\nsigned main(){\n  int n,m,a,b,p,q;\n  cin>>n>>m>>a>>b>>p>>q;\n  if(a==1&&b==1){\n    //cout<<m%(p+q)<<endl;\n    if(ch(n,p+q)) cout<<min(m%(p+q),(p+q)-m%(p+q))<<endl;\n    else{\n      int t=n*(p+q);\n      if(m>=t) cout<<m-t<<endl;\n      else cout<<min(m%(p+q),(p+q)-m%(p+q))<<endl;\n    }\n    return 0;\n  }\n  int ans=m;\n  int ta=1,tb=1;\n  vector<int> v;\n  for(int i=0;i<n;i++){\n    if(ch(p,ta)) break;\n    if(ch(q,tb)) break;\n    int t=p*ta+q*tb;\n    //cout<<t<<endl;\n    if(t<=m) v.push_back(t);\n    else{\n      ans=min(ans,t-m);\n      break;\n    }\n    if(ch(ta,a)) break;\n    if(ch(tb,b)) break;\n    ta*=a;tb*=b;\n  }\n  int x=v.size();\n  int y=x/2;\n  set<int> s;\n  for(int i=0;i<(1<<y);i++){\n    int t=0;\n    for(int j=0;j<y;j++) if((i>>j)&1) t+=v[j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }    \n    //cout<<t<<endl;\n    s.insert(-t);\n    ans=min(ans,m-t);\n  }\n   \n  for(int i=0;i<(1<<(x-y));i++){\n    int t=0;\n    for(int j=0;j<(x-y);j++) if((i>>j)&1) t+=v[y+j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }\n    //cout<<t<<endl;\n    ans=min(ans,m-t);\n    int u=t-m;\n    int k=*s.lower_bound(u);\n    ans=min(ans,m-(t-k));\n  }\n   \n  s.clear();\n  for(int i=0;i<(1<<y);i++){\n    int t=0;\n    for(int j=0;j<y;j++) if((i>>j)&1) t+=v[j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }    \n    //cout<<t<<endl;\n    s.insert(t);\n    ans=min(ans,m-t);\n  }\n   \n  int inf=m*2;\n  s.insert(inf);\n  for(int i=0;i<(1<<(x-y));i++){\n    int t=0;\n    for(int j=0;j<(x-y);j++) if((i>>j)&1) t+=v[y+j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }\n    //cout<<t<<endl;\n    ans=min(ans,m-t);\n    int v=m-t;\n    int l=*s.lower_bound(v);\n    if(l!=inf) ans=min(ans,(t+l)-m);\n  }\n  //assert(ans>=0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// g++ -std=c++11 a.cpp\n#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>   \n#include<map>\n#include<set>\n#include<unordered_map>\n#include<utility>\n#include<cmath>\n#include<random>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<bitset>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#include<typeinfo>\n#define loop(i,a,b) for(ll i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define FOR(i,a) for(auto i:a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n#define show1d(v) rep(i,v.size())cout<<\" \"<<v[i];cout<<endl<<endl;\n#define show2d(v) rep(i,v.size()){rep(j,v[i].size())cout<<\" \"<<v[i][j];cout<<endl;}cout<<endl;\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\n//#define int ll\ntypedef ll Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n#define mt make_tuple\ntypedef tuple<int,int,int,int> tp;\ntypedef vector<tp> vt;\ntemplate<typename A,typename B>bool cmin(A &a,const B &b){return a>b?(a=b,true):false;}\ntemplate<typename A,typename B>bool cmax(A &a,const B &b){return a<b?(a=b,true):false;}\n//template<class C>constexpr int size(const C &c){return (int)c.size();}\n//template<class T,size_t N> constexpr int size(const T (&xs)[N])noexcept{return (int)N;}\nconst double PI=acos(-1);\nconst double EPS=1e-9;\nDef inf = sizeof(Def) == sizeof(long long) ? 2e18 : 1e9+10;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\nint main(){\n\tll n,m,a,b,p,q;\n\tcin>>n>>m>>a>>b>>p>>q;\n\tvi A,B;\n\tll t=p;\n\twhile(1){\n\t\tA.pb(t);\n\t\tif(to_string(t).size()+to_string(a).size()>16)break;\n\t\tt*=a;\n\t}\n\tt=q;\n\twhile(1){\n\t\tB.pb(t);\n\t\tif(to_string(t).size()+to_string(b).size()>16)break;\n\t\tt*=b;\n\t}\n\t//show1d(A);\n\t//show1d(B);\n\tvi in;\n\trep(i,min((ll)A.size(),n))\n\t\tif(i<B.size()&&A[i]+B[i]<=3*m)in.pb(A[i]+B[i]);\n\tn=in.size()/2;\n\tll N=1<<n;\n\tvi dp;\n\trep(i,N){\n\t\tll sum=0;\n\t\trep(j,n)if(i&1<<j)sum+=in[j];\n\t\tif(sum<=3*m)dp.pb(sum);\n\t}\n\tsort(all(dp));\n\tll nn=in.size()-n;\n\tN=1<<nn;\n\tll out=m;\n//\tshow1d(in);\n\trep(i,N){\n\t\tll sum=0;\n\t\trep(j,nn)if(i&1<<j)sum+=in[n+j];\n\t\tif(sum>3*m)continue;\n\t\tauto it=upper_bound(all(dp),m-sum);\n\t\tif(it!=dp.end())out=min(out,abs(*it+sum-m));\n\t\tif(it==dp.begin())continue;\n\t\tit--;\n\t\tout=min(out,abs(*it+sum-m));\n\t}\n//\tshow1d(dp);\n\tcout<<out<<endl;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll _pow(ll a, ll n) {\n\tif(n == 0) return 1;\n\telse {\n\t\tll res = 1;\n\t\tll buf = a;\n\t\twhile(n > 0) {\n\t\t\tif(n % 2 == 1) {\n\t\t\t\tres *= buf;\n\t\t\t}\n\t\t\tbuf *= buf;\n\t\t\tn /= 2;\n\t\t}\n\t\treturn res;\n\t}\n}\n\nvoid solve() {\n\tll n, m, a, b, p, q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\tif(n == 1) {\n\t\tif(p + q > m) cout << m << endl;\n\t\telse cout << m - (p + q) << endl;\n\t\treturn;\n\t}\n\tll c = max(a, b);\n\tif(c == 1) {\n\t\tif((p + q) * n > m) {\n\t\t\tcout << m - m / (p + q) * (p + q) << endl;\n\t\t} else cout << m - (p + q) * n << endl;\n\t} else if(c == 2 || c == 3) {\n\t\tll _n = 0;\n\t\tif(c == 2) _n = min(41LL, n);\n\t\tif(c == 3) _n = min(29LL, n);\n\t\tll div1 = n / 2;\n\t\tll div2 = n - div1;\n\t\tvector<ll> d1;\n\t\tvector<ll> d2;\n\t\tREP(bit, (1ll << div1)) {\n\t\t\tbitset<31> bi(bit);\n\t\t\tll sum = 0;\n\t\t\tREP(i, div1) if(bi[i]) sum += p * _pow(a, i) + q * _pow(b, i);\n\t\t\td1.pb(sum);\n\t\t}\n\t\tREP(bit, (1ll << div2)) {\n\t\t\tbitset<31> bi(bit);\n\t\t\tll sum = 0;\n\t\t\tREP(i, div2) if(bi[i]) sum += p * _pow(a, div1 + i) + q * _pow(b, div1 + i);\n\t\t\td2.pb(sum);\n\t\t}\n\t\tsort(ALL(d1));\n\t\tsort(ALL(d2));\n\t\tll ans = m;\n\t\tREP(i, d1.size()) {\n\t\t\tauto ite = upper_bound(ALL(d2), m - d1[i]);\n\t\t\tif(ite == d2.begin()) continue;\n\t\t\tite--;\n\t\t\tans = min(ans, m - (d1[i] + *ite));\n\t\t}\n\t\tcout << ans << endl;\n\t} else /* c >= 4 */ {\n\t\tvector<ll> num;\n\t\tnum.pb(0);\n\t\tnum.pb(p + q);\n\t\tREP(i, 23) {\n\t\t\tif(1000000000000LL / (ld)_pow(c, i) < c) break;\n\t\t\tll val = p * _pow(a, i + 1) + q * _pow(b, i + 1); \n\t\t\tvector<ll> nnum = num;\n\t\t\tREP(j, num.size()) nnum.pb(num[j] + val);\n\t\t\tnum = nnum;\n\t\t}\n\t\tUNIQUE(num);\n\t\tauto ite = upper_bound(ALL(num), m);\n\t\tite--;\n\t\tcout << *ite << endl;\n\t}\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tsolve();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define N 41\nusing namespace std;\ntypedef long long ll;\nll n,m,a,b,p,q,d;\nvector<ll> v[2],x[2];\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll ti=min(n,m/(p+q));\n  ll ans=min(m,min(m-ti*(p+q),abs(min(ti+1,n)*(p+q)-m)));\n  ll A=1,B=1,T=min((ll)N,n);\n  for(int i=0;i<T;i++){\n    d=p*A+q*B;\n    if(i<T/2)v[0].push_back(d);\n    else v[1].push_back(d);\n    if(d>m)break;\n    A*=a,B*=b;\n  }\n  int len[2]={v[0].size(),v[1].size()};\n  for(int i=0;i<2;i++){\n    v[i].push_back(0);\n    for(int j=0;j<(1<<len[i]);j++){\n      ll sum=0;\n      for(int k=0;k<len[i];k++)\n\tif((j&(1<<k)))sum+=v[i][k];\n      x[i].push_back(sum);\n    }\n    sort(x[i].begin(),x[i].end());\n  }\n  for(int i=0;i<x[0].size();i++){\n    ll S=m-x[0][i];\n    vector<ll>::iterator r=lower_bound(x[1].begin(),x[1].end(),S);\n    if(r!=x[1].end())ans=min(ans,(*r)-S);\n    if(r!=x[1].begin())ans=min(ans,S-(*(r-1)));\n  }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <queue>\n#include <cmath>\n#include <algorithm>\n#include <functional>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<(n);++i)\n#define rep1(i,n) for(int i=1;i<=(n);++i)\n#define all(c) (c).begin(),(c).end()\n#define pb push_back\n#define fs first\n#define sc second\n#define show(x) cout << #x << \" = \" << x << endl\ntypedef long long ll;\nll inf=1e14;\nint main(){\n\tll n,m,a,b,p,q;\n\tcin>>n>>m>>a>>b>>p>>q;\n\tif(a>b) swap(a,b),swap(p,q);\n\tll ans=m;\n\tif(b==1){\n\t\tll k=p+q;\n\t\tll d=min(n,m/k);\n\t\tans=m-k*d;\n\t\tif(d!=n) ans=min(ans,(d+1)*k-m);\n\t}else if(a==1){\n\t\tll bq[45]={},sum[46]={};\n\t\tbq[0]=q;\n\t\tsum[1]=q;\n\t\tll id=0;\n\t\tfor(;id<n-1;id++){\n\t\t\tif(bq[id]>inf/b) break;\n\t\t\tbq[id+1]=bq[id]*b;\n\t\t\tsum[id+2]=sum[id+1]+bq[id+1];\n\t\t}\n/*\t\tshow(id);\n\t\trep(i,id+1){\n\t\t\tshow(bq[i]);\n\t\t\tshow(sum[i]);\n\t\t}*/\n\t\t//can use 0~id\n\t\tll id_c=id;\n\t\tfor(ll k=1;k<=min(n,id_c+1);k++){\n\t\t\tif(bq[k-1]==0) break;\n//\t\t\tshow(k);\n\t\t\tll left=m-p*k;\n\t\t\tll now=0;\n\t\t\tid=id_c;\n\t\t\tint use=0;\n\t\t\tfor(;id>=0;id--){\n\t\t\t\tif(now+bq[id]>left){\n\t\t\t\t\tif(k-use-1>=0&&k-use-1<=id) ans=min(ans,now+bq[id]+sum[k-use-1]-left);\n\t\t\t\t}else{\n\t\t\t\t\tnow+=bq[id];\n\t\t\t\t\tuse++;\n\t\t\t\t\tif(use==k){\n\t\t\t\t\t\tans=min(ans,left-now);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}else{\n\t\tll id=0;\n\t\tll l=p,r=q;\n\t\tll num[45]={};\n\t\tfor(;id<n;id++){\n\t\t\tnum[id]=l+r;\n\t\t\tif(l>inf/a) break;\n\t\t\tif(r>inf/b) break;\n\t\t\tl*=a;\n\t\t\tr*=b;\n\t\t}\n\t\tif(id==n) id--;\n\t\t//can use 0~id\n//\t\tshow(id);\n//\t\trep(i,id+1){\n//\t\t\tshow(num[i]);\n//\t\t}\n\t\tll now=0;\n\t\tfor(;id>=0;id--){\n\t\t\tif(now+num[id]>m){\n\t\t\t\tans=min(ans,now+num[id]-m);\n\t\t\t}else{\n\t\t\t\tans=min(ans,m-(now+num[id]));\n\t\t\t\tnow+=num[id];\n\t\t\t}\n\t\t}\n\t}\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <vector>\n\n#define show(x) cerr << #x << \" = \" << x << endl\n\nusing namespace std;\nusing ld = long double;\nusing ll = long long;\n\ntemplate <typename T>\nostream& operator<<(ostream& os, const vector<T>& v)\n{\n    os << \"[\";\n    for (const auto& e : v) {\n        os << e << \",\";\n    }\n    os << \"] \";\n    os << \"size = \" << v.size() << endl;\n    return os;\n}\n\nint main()\n{\n    ll n, m, a, b, p, q;\n    cin >> n >> m >> a >> b >> p >> q;\n\n    if (p + q > m) {\n        cout << m << endl;\n    } else if (a == b) {\n        cout << m % (p + q) << endl;\n    } else {\n        ll k = 0;\n        ll A = 1;\n        ll B = 1;\n        vector<ll> value;\n        for (; p * A + q * B <= m and k <= n; k++) {\n            value.push_back(p * A + q * B);\n            A *= a;\n            B *= b;\n        }\n        n = k;\n        vector<ll> sum(n);\n        for (int i = 0; i < n; i++) {\n            if (i == 0) {\n                sum[i] = value[i];\n            } else {\n                sum[i] = sum[i - 1] + value[i];\n            }\n        }\n\n        ll tot = 0;\n        ll res = m;\n        for (ll i = n - 1; i >= 1; i--) {\n            if (sum[i - 1] < res) {\n                if (res < value[i]) {\n                    tot += sum[i - 1];\n                    break;\n                } else {\n                    res -= value[i];\n                    tot += value[i];\n                }\n            } else if (sum[i - 1] == res) {\n                tot = m;\n                break;\n            }\n        }\n        cout << m - tot << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=__int128;\n\nusing ll2=long long;\n\nconst ll INF=1e15;\n\nll powi(ll x,ll k){\n    ll res=1;\n    while(k){\n        if(k&1) res*=x;\n        if(res>INF) return INF;\n        x*=x;\n        k>>=1;\n    }\n    return res;\n}\nint main(){\n    ll2 nn,mm,aa,bb,pp,qq;\n    cin>>nn>>mm>>aa>>bb>>pp>>qq;\n    ll n=nn,m=mm,a=aa,b=bb,p=pp,q=qq;\n    if(a>=2 || b>=2){\n        int tn=min(n,ll(42));\n        int half=tn/2;\n        vector<ll> vec(1<<half);\n        for(int i=0;i<(1<<half);i++){\n            ll val=0;\n            for(int j=0;j<half;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,j)+q*powi(b,j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            vec[i]=val;\n\n        }\n        int rest=tn-half;\n        set<ll> s;\n        for(int i=0;i<(1<<rest);i++){\n            ll val=0;\n            for(int j=0;j<rest;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,half+j)+q*powi(b,half+j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            s.insert(val);\n        }\n        ll2 res=m;\n        for(int i=0;i<vec.size();i++){\n            auto it=s.lower_bound(m-vec[i]);\n            if(it!=s.end()){\n        \n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n            if(it!=s.begin()){\n                it--;\n\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n        }\n        cout<<res<<endl;\n    }\n    else{\n        if((p+q)*n>=m){\n            cout<<ll2(min(m%(p+q),(p+q)-m%(p+q)))<<endl;\n        }\n        else{\n            cout<<ll2(m-(p+q)*n)<<endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s, B;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\n\tif (a == 1 && b == 1) {\n\t\tif (m <= (n - 1) * (p + q)) {\n\t\t\tB = m % (p + q);\n\t\t\tif (m > (p + q) / 2) {\n\t\t\t\tB = (p + q) - B;\n\t\t\t}\n\t\t\tcout << B << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << (long long)((n - 1)*(p + q)) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = m;\n\td = s;\nE:;\n\trem = m - c[d - 1];\n\tminx = min(minx, abs(rem));\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\tll n,m,a,b,p,q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\t\n\tif(a == 1 && b == 1){\n\t\tcout << max( m%(p+q) , m-(p+q)*n ) << endl;\n\t}\n\telse {\n\t\tvector<ll> vec;\n\t\tll s = 1 , t = 1;\n\t\tfor(int i = 0 ; i < n ; i ++){\n\t\t\tif(p*s+q*t > m)break;\n\t\t\tvec.push_back(p*s+q*t);\n\t\t\ts *= a;\n\t\t\tt *= b;\n\t\t}\n\t\tint N = vec.size();\n\t\tvector<ll> A,B;\n\t\tA.push_back(0);\n\t\tfor(int i = 0 ; i < N/2 ; i ++){\n\t\t\tint x = A.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tA.push_back(vec[i]+A[j]);\n\t\t\t}\n\t\t}\n\t\tB.push_back(0);\n\t\tfor(int i = N/2 ; i < N ; i ++){\n\t\t\tint x = B.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tB.push_back(vec[i]+B[j]);\n\t\t\t}\n\t\t}\n\t\tsort(B.begin(),B.end());\n\t\tll ret = m;\n\t\tfor(int i = 0 ; i < A.size() ; i ++){\n\t\t\tint x = upper_bound(B.begin(),B.end(),m-A[i])-B.begin();\n\t\t\tx --;\n\t\t\tret = min ( ret , m-A[i]-B[x] );\n\t\t}\n\t\tcout << ret << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint main(){\n  long long int n, m, a, b, p, q, ans;\n  cin >> n >> m >> a >> b >> p >> q;\n  if(a < b){\n    swap(a, b);\n    swap(p, q);\n  }\n  if(a == 1){\n    if(m/(p + q) >= n) cout << m - n*(p + q) << endl;\n    else{\n      long long int t = m - m/(p + q)*(p + q);\n      cout << min(t, p + q - t) << endl;\n    }\n    return 0;\n  }\n  ans = m;\n  long long int x = 1, y = 1;\n  for(int i = 1; i < n; ++i){\n    if(m <= p*x + q*y) break;\n    x *= a;\n    y *= b;\n  }\n  while(x > 0){\n    ans = min(ans, abs(m - (p*x + q*y)));\n    if(m >= p*x + q*y) m -= p*x + q*y;\n    x /= a;\n    y /= b;\n  }\n  cout << ans << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define EPS 1e-10\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;--i)\n#define srep(i,s,t) for(int i=(int)(s);i<(int)(t);++i)\n#define each(a,b) for(auto (a): (b))\n#define all(v) (v).begin(),(v).end()\n#define len(v) (int)(v).size()\n#define zip(v) sort(all(v)),v.erase(unique(all(v)),v.end())\n#define cmx(x,y) x=max(x,y)\n#define cmn(x,y) x=min(x,y)\n#define fi first\n#define se second\n#define pb push_back\n#define show(x) cout<<#x<<\" = \"<<(x)<<endl\n#define spair(p) cout<<#p<<\": \"<<p.fi<<\" \"<<p.se<<endl\n#define svec(v) cout<<#v<<\":\";rep(kbrni,v.size())cout<<\" \"<<v[kbrni];cout<<endl\n#define sset(s) cout<<#s<<\":\";each(kbrni,s)cout<<\" \"<<kbrni;cout<<endl\n#define smap(m) cout<<#m<<\":\";each(kbrni,m)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n\nusing namespace std;\n\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<P> vp;\ntypedef vector<string> vs;\n\nconst int MAX_N = 100005;\n\nll lpa[40],lpb[40];\ndouble dpa[40],dpb[40];\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    ll n,m,a,b,p,q;\n    cin >> n >> m >> a >> b >> p >> q;\n    if(a == 1 && b == 1){\n        ll cnt = m/(p+q);\n        cout << min(m-min(n,cnt)*(p+q),abs(min(n,cnt+1)*(p+q)-m)) << \"\\n\";\n    }else{\n        ll mid = 20;\n        lpa[0] = lpb[0] = dpa[0] = dpb[0] = 1;\n        rep(i,2*mid-1){\n            lpa[i+1] = lpa[i] * a;\n            lpb[i+1] = lpb[i] * b;\n            dpa[i+1] = dpa[i] * a;\n            dpb[i+1] = dpb[i] * b;\n        }\n        vl u,v;\n        rep(i,(1 << mid)){\n            ll val1 = 0,val2 = 0;\n            double ch1 = 0,ch2 = 0;\n            rep(j,mid){\n                if((i >> j) & 1){\n                    val1 += p*lpa[j] + q*lpb[j];\n                    val2 += p*lpa[mid+j] + q*lpb[mid+j];\n                    ch1 += p*dpa[j] + q*dpb[j];\n                    ch2 += p*dpa[mid+j] + q*dpb[mid+j];\n                }\n            }\n            if(ch1 <= 2*m){\n                u.pb(val1);\n                if(ch2 <= 2*m){\n                    v.pb(val2);\n                }\n            }\n        }\n        // svec(u);\n        // svec(v);\n        sort(all(v));\n        ll mn = (1LL << 60);\n        rep(i,len(u)){\n            int id = upper_bound(all(v),m-u[i]) - v.begin();\n            if(id > 0){\n                cmn(mn,m-(u[i]+v[id-1]));\n            }\n            if(id < len(v)){\n                cmn(mn,(u[i]+v[id])-m);\n            }\n        }\n        cout << mn << \"\\n\";\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<ll, ll> P;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(ll i=(ll)(a);i<(ll)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define mmax(x,y) (x>y?x:y)\n#define mmin(x,y) (x<y?x:y)\n#define maxch(x,y) x=mmax(x,y)\n#define minch(x,y) x=mmin(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt __builtin_popcount\n\n#define INF 1e18\n#define mod 1000000007\n\nll n,m,a,b,p,q;\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll res=m;\n  if(a==1&&b==1){\n    ll cnt=min(m/(p+q),n);\n    minch(res,m-cnt*(p+q));\n    cnt=min(cnt+1,n);\n    if(cnt*(p+q)-m>=0)minch(res,cnt*(p+q)-m);\n    cout<<res<<endl;\n    return 0;\n  }\n  ll crt1=p,crt2=q;\n  vector<ll> cs,cs1;\n  rep(k,n){\n    if(2*m<crt1+crt2)break;\n    cs.push_back(crt1+crt2);\n    if(2*m/a<crt1||2*m/b<crt2)break;\n    crt1*=a;\n    crt2*=b;\n  }\n  ll n1=cs.size()/2;\n  ll n2=cs.size()-n1;\n  rep(S,1<<n1){\n    ll sum=0;\n    rep(i,n1){\n      if((S>>i)&1)sum+=cs[i];\n    }\n    cs1.push_back(sum);\n  }\n  sort(all(cs1));\n\n  rep(S,1<<n2){\n    ll sum=0;\n    rep(i,n2){\n      if((S>>i)&1)sum+=cs[n1+i];\n    }\n    if(sum>=m){\n      minch(res,sum-m);\n    }else{\n      ll idx=lower_bound(all(cs1),m-sum)-cs1.begin();\n      if(idx<cs1.size()){\n        minch(res,sum+cs1[idx]-m);\n      }\n      if(idx>0){\n        minch(res,m-(sum+cs1[idx-1]));\n      }\n    }\n  }\n  cout<<res<<endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cassert>\n#include<climits>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\ntypedef long long ll;\n\nvector<ll> generate(vector<ll> a){\n  vector<ll> ret;\n  int n = a.size();\n  rep(i,(1<<n)){\n    ll tmp = 0;\n    rep(j,n){\n      if ((1<<j)&i)tmp += a[j];\n    }\n    ret.push_back(tmp);\n  }\n  sort(ret.begin(),ret.end());\n  return ret;\n}\n\nll bs(ll m,ll sum,vector<ll> &a,bool fg){\n  int ret = -1;\n  int l = 0,r = a.size()-1;\n  while(l <= r){\n    int mid = (l+r)/2;\n    ll tmp = sum + a[mid];\n    if (fg){\n      if (tmp <= m){//ä¸éããã£ã¨ä¸ããã\n\tret = mid;\n\tl = mid+1;\n      }else {\n\tr = mid-1;\n      }\n    }else {\n      if (tmp >= m){\n\tret = mid;\n\tr = mid-1;\n      }else {\n\tl = mid+1;\t\n      }\n    }\n  }\n\n  /*  cout <<\"dbg\" << endl;\n  rep(i,a.size())cout << a[i] <<\" \" ;cout << endl;\n  cout <<fg <<\" \" <<  m <<\" \" << sum <<\" \" << (ret != -1?a[ret]:-1) <<\" \" << \n    ((ret != -1)?sum+a[ret]:-1)\n       << endl;\n  */\n  if (ret == -1)return llabs(m-sum);\n  //cout << m <<\" \" << sum+a[ret] << \" \" << llabs(m-(sum+a[ret])) << endl;\n  return llabs(m-(sum+a[ret]));\n}\n\nll ans;\nvoid search(int n,int now,ll sum,ll m,vector<ll> &a,vector<ll> &all){\n  //ub,sumã¨aã®è¦ç´ ã§ãmä»¥ä¸ã§æå¤§ã®ãã®ãæ¢ã\n  //lb,sumã¨aã®è¦ç´ ã®åã§mä»¥ä¸æå°ã®ãã®ãæ¢ã\n  ll ub=bs(m,sum,all,true),lb=bs(m,sum,all,false);\n  ans = min(ans,ub);\n  ans = min(ans,lb);\n  if (now == n)return;\n  //ä½¿ã\n  search(n,now+1,sum+a[now],m,a,all);\n  //ä½¿ããªã\n  search(n,now+1,sum,m,a,all);\n}\n\n/*\n  ååå¨åæãã ãã¡ã¢ãªç¯ç´ãããã®ã§å¾ãååã¯æ¢ç´¢ããã\n */\nll solve2(vector<ll> in,ll m){\n  vector<ll> mae,usiro;\n  rep(i,in.size()){\n    if (i < in.size()/2)mae.push_back(in[i]);\n    else usiro.push_back(in[i]);\n  }\n  vector<ll> all=generate(mae);\n  ans = m;\n  search(usiro.size(),0,0,m,usiro,all);\n  return ans;\n}\n\nll solve(ll n,ll m,ll a,ll b,ll p,ll q){\n  if (a == 1 && b == 1){//ç¹æ®ã±ã¼ã¹\n    ll sum = p+q;\n    ll lb = min(n,m/sum),ub=min(n,(m+sum-1)/sum);\n    ll ret = m;\n    ret = min(ret,llabs(m-lb*(sum)));\n    ret = min(ret,llabs(m-ub*(sum)));\n    return ret;\n  }\n\n  //ãã±ããã®çæ\n  //ä¸å¿doubleåã§å¤ã¯åãæ±ã£ã¦ããã\n  //å¿è¦ãªãã±ããã¯æå¤§ï¼ï¼æã§ãããä»¥ä¸ã¯æå³ããªãã\n  int loop = 0;\n  ll cur = p + q;\n  ll mula=1,mulb=1;\n  double m_d=m;\n  double cur_d = p + q;\n  double mula_d = 1, mulb_d = 1;\n  vector<ll> all;\n  all.push_back(cur);\n  while(loop < n){\n    mula_d *= a;\n    mulb_d *= b;\n    cur_d   = p*mula_d + q*mulb_d;\n    if (cur_d > 3*m)break;\n    mula *= a;\n    mulb *= b;\n    cur = p*mula + q*mulb;\n    all.push_back(cur);\n\n  }\n\n  //rep(i,all.size())assert(all[i] > 0);\n  //rep(i,all.size())cout << all[i] <<\" \" ;cout << endl;\n\n  if (all.size() == 1){//ä¸ã¤ããä½¿ãããã±ããããªããªããããç­ãã«ããã(å¿ãï¼æã¯ãããã¨ãä¿è¨¼ããã¦ãã)\n    return min(m,llabs(all[0]-m));\n  }\n  return solve2(all,m);\n}\n\nmain(){\n  ll n,m,a,b,p,q;\n  while(cin>>n>>m>>a>>b>>p>>q && n){\n    cout << solve(n,m,a,b,p,q)  << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\n\nint main(){\n\n\tint POW[21];\n\tfor(int i = 0; i < 21; i++)POW[i] = pow(2,i);\n\n\tll N,M,A,B,P,Q;\n\n\tscanf(\"%lld %lld %lld %lld %lld %lld\",&N,&M,&A,&B,&P,&Q);\n\n\tif(A == 1 && B == 1){\n\n\t\tll num = M/(P+Q);\n\n\t\tif(num >= N){\n\t\t\tprintf(\"%lld\\n\",M-N*(P+Q));\n\t\t}else{\n\t\t\tprintf(\"%lld\\n\",min(M%(P+Q),(num+1)*(P+Q)-M)); //少し足りないと、少し多いの、差が小さい方\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tvector<ll> FIRST;\n\n\tll tmp = P+Q;\n\tll a = 1, b = 1;\n\tll count = 0;\n\n\tdouble check;\n\n\twhile(tmp <= M){\n\n\t\tFIRST.push_back(tmp);\n\t\tcount++;\n\t\tif(count == N)break;\n\n\t\tcheck = P*a*A+Q*b*B;\n\t\tif(check > (double)M)break;\n\n\t\ta *= A;\n\t\tb *= B;\n\n\t\ttmp = P*a+Q*b;\n\t}\n\n\t//数字を2つのグループに振り分ける\n\tvector<ll> G[2];\n\tfor(ll i = 0; i < FIRST.size(); i++){\n\t\tif(i < (FIRST.size())/2){\n\t\t\tG[0].push_back(FIRST[i]);\n\t\t}else{\n\t\t\tG[1].push_back(FIRST[i]);\n\t\t}\n\t}\n\n\tint num[2];\n\tnum[0] = (int)G[0].size();\n\tnum[1] = (int)G[1].size();\n\n\t//各グループで数字を作る\n\tvector<ll> V[2];\n\tfor(int group = 0; group < 2; group++){\n\t\tfor(int state = 0; state < POW[num[group]]; state++){\n\t\t\ttmp = 0;\n\t\t\tfor(int loop = 0; loop < num[group]; loop++){\n\t\t\t\tif(state & (1 << loop)){\n\t\t\t\t\ttmp += G[group][loop];\n\t\t\t\t}\n\t\t\t}\n\t\t\tV[group].push_back(tmp);\n\t\t}\n\t\tsort(V[group].begin(),V[group].end());\n\t\tV[group].erase(unique(V[group].begin(),V[group].end()),V[group].end());\n\t}\n\n\tll ans = M,tmp_ans;\n\n\tint left,right,m,loc;\n\n\tfor(int i = 0; i < V[0].size(); i++){\n\t\t//2分探索で、和がMを超えない、最大のindexを求める\n\t\tleft = 0,right = (int)V[1].size()-1,m = (left+right);\n\t\tloc = 0;\n\n\t\twhile(left <= right){\n\t\t\tif(V[0][i]+V[1][m] <= M){\n\t\t\t\tloc = m;\n\t\t\t\tleft = m+1;\n\t\t\t}else{\n\t\t\t\tright = m-1;\n\t\t\t}\n\t\t\tm = (left+right)/2;\n\t\t}\n\n\t\ttmp_ans = (M-(V[0][i]+V[1][loc]));\n\t\tif(loc < (int)V[0].size()-1){\n\t\t\ttmp_ans = min(tmp_ans,V[0][i]+V[1][loc+1]-M);\n\t\t}\n\t\tans = min(ans,tmp_ans);\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 1LL<<45;\nll Sum[100];\nll n,m,a,b,p,q;\n\n\nll calc(ll k){\n  ll A = 1,B = 1,res=p+q;\n  while(res>0&&res<=INF&&k--)A*=a,B*=b,res=p*A+q*B;\n  if(res<0) res = INF;\n  return min(INF,res);\n}\n\nll ans = INF;\nset<ll> used[101];\nvoid dfs(ll pos,ll sum){\n  ans = min(ans,(ll)abs(m-sum));\n  if(m<sum||pos==-1||sum>INF||used[pos].count(sum)) return;\n  if(Sum[pos]+sum<m){ans=min(ans,m-(Sum[pos]+sum));return;}\n  used[pos].insert(sum);\n  dfs(pos-1,sum+calc(pos));  \n  dfs(pos-1,sum);\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  Sum[0] = calc(0);\n  for(int i=1;i<60;i++)Sum[i]=min(INF,calc(i)+Sum[i-1]);\n    if(max(a,b)==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - (p+q));\n    if(m/(p+q)==n) t = INF;\n    if(m/(p+q)<=n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n    }\n  \n  dfs(min(n-1,50LL),0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define P push_back\n#define N 41\nusing namespace std;\ntypedef long long ll;\nll n,m,a,b,p,q,d;\nvector<ll> v[2],x[2];\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll ti=min(n,m/(p+q));\n  ll ans=m;\n  if(a==1&&b==1)\n    ans=min(ans,min(m-ti*(p+q),\n\t\t    abs(min(ti+1,n)*(p+q)-m)));\n  ll A=1,B=1,T=min((ll)N,n);\n  for(int i=0;i<T;i++){\n    d=p*A+q*B;\n    i<T/2?v[0].P(d):v[1].P(d);\n    if(d>m)break;\n    A*=a,B*=b;\n  }\n  int len[2]={v[0].size(),v[1].size()};\n  for(int i=0;i<2;i++){\n    v[i].P(0);\n    for(int j=0;j<(1<<len[i]);j++){\n      ll sum=0;\n      for(int k=0;k<len[i];k++)\n\tif((j&(1<<k)))sum+=v[i][k];\n      x[i].P(sum);\n    }\n    sort(x[i].begin(),x[i].end());\n  }\n  for(int i=0;i<x[0].size();i++){\n    ll S=m-x[0][i];\n    vector<ll>::iterator r=lower_bound(x[1].begin(),x[1].end(),S);\n    if(r!=x[1].end())ans=min(ans,(*r)-S);\n    if(r!=x[1].begin())ans=min(ans,S-(*(r-1)));\n  }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return m%d;\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n  if(n>40)n=40;\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        ll c=T[i]+U[j];\n        res=min( res,  abs(m-c) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <vector>\n#include <queue>\n#include <string>\n#include <algorithm>\n#include <iostream>\n#include <string>\n#include <map>\n#include <set>\n#include <functional>\n#include <iostream>\n#define MOD 1000000007LL\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nll labs(ll x){\n\tif(x<0LL)return -x;\n\treturn x;\n}\n\nint zcnt(ll x){\n\tint cnt=0;\n\twhile(x>0){\n\t\tx/=10LL;\n\t\tcnt++;\n\t}\n\treturn cnt;\n}\n\nll n,m,a,b,p,q;\nll num[51];\nvector<ll> vec;\n\nint main(void){\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&n,&m,&a,&b,&p,&q);\n\tif(a==1LL && b==1LL){\n\t\tll dist=p+q;\n\t\tll cnt=m/dist;\n\t\tprintf(\"%lld\\n\",min(labs(m-min(cnt,n)*dist),labs(m-(min(cnt+1LL,n))*dist)));\n\t}else{\n\t\tll v=0;\n\t\tll np=p,nq=q;\n\t\twhile(np+nq<=m){\n\t\t\tnum[v]=np+nq;\n\t\t\tif(zcnt(np)+zcnt(a)>=zcnt(m)+4 || zcnt(nq)+zcnt(b)>=zcnt(m)+4)break;\n\t\t\tnp*=a;\n\t\t\tnq*=b;\n\t\t\tv++;\n\t\t}\n\t\tnum[v]=np+nq;\n\t\tv++;\n\t\tll res=m;\n\t\tv=min(v,n);\n\t\tif(v==0){\n\t\t\tres=min(res,labs(m-p-q));\n\t\t\tprintf(\"%lld\\n\",res);\n\t\t\treturn 0;\n\t\t}\n\t\tint v2=(int)v/2;\n\t\tfor(int bit=0;bit<(1<<v2);bit++){\n\t\t\tll now=0;\n\t\t\tfor(int i=0;i<v2;i++){\n\t\t\t\tif((bit>>i) & 1){\n\t\t\t\t\tnow+=num[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tvec.push_back(now);\n\t\t}\n\t\tsort(vec.begin(),vec.end());\n\t\tvec.erase(unique(vec.begin(),vec.end()),vec.end());\n\t\tint v3=v-v2;\n\t\tfor(int bit=0;bit<(1<<v3);bit++){\n\t\t\tll now=0;\n\t\t\tfor(int i=0;i<v3;i++){\n\t\t\t\tif((bit>>i) & 1){\n\t\t\t\t\tnow+=num[i+v2];\n\t\t\t\t}\n\t\t\t}\n\t\t\tint l=lower_bound(vec.begin(),vec.end(),m-now)-vec.begin();\n\t\t\tif(l<vec.size())res=min(res,labs(m-now-vec[l]));\n\t\t\tif(l>0 || l==vec.size()){\n\t\t\t\tres=min(res,labs(m-now-vec[l-1]));\n\t\t\t}\n\t\t}\n\t\tprintf(\"%lld\\n\",res);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nbool ch(int a,int b){\n  int x=1000000000000000LL;\n  x/=a;\n  x/=b;\n  return x==0;\n}\nsigned main(){\n  int n,m,a,b,p,q;\n  cin>>n>>m>>a>>b>>p>>q;\n  if(a==1&&b==1){\n    cout<<m%(p+q)<<endl;\n    return 0;\n  }\n  int ta=1,tb=1;\n  vector<int> v;\n  for(int i=0;i<n;i++){\n    if(ch(p,ta)) break;\n    if(ch(q,tb)) break;\n    int t=p*ta+q*tb;\n    if(t<=m) v.push_back(t);\n    else break;\n    //cout<<t<<endl;\n    if(ch(ta,a)) break;\n    if(ch(tb,b)) break;\n    ta*=a;tb*=b;\n  }\n  int x=v.size();\n  int y=x/2;\n  if(x==1){\n    cout<<m-v[0]<<endl;\n    return 0;\n  }\n  set<int> s;\n  for(int i=0;i<(1<<y);i++){\n    int t=0;\n    for(int j=0;j<y;j++) if((i>>j)&1) t+=v[j];\n    if(t>m) continue;\n    //cout<<t<<endl;\n    s.insert(-t);\n  }\n  int ans=m;\n  for(int i=1;i<(1<<(x-y));i++){\n    int t=0;\n    for(int j=0;j<(x-y);j++) if((i>>j)&1) t+=v[y+j];\n    if(t>m) continue;\n    //cout<<t<<endl;\n    int u=t-m;\n    int k=*lower_bound(s.begin(),s.end(),u);\n    ans=min(ans,m-(t-k));\n  }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <queue>\n#define REP(i,n) for(int i=0; i<(int)(n); i++)\n\ntypedef long long ll;\n\nusing namespace std;\n\nconst ll inf = 1ll << 60;\n\nll mult(ll a, ll b){\n  if(inf / a < b) throw 0;\n  return a * b;\n}\n\nint main(){\n  ll n, m, a, b, p, q;\n  cin >> n >> m >> a >> b >> p >> q;\n  if(a == 1 && b == 1){\n    cout << m / (p + q) << endl;\n    return 0;\n  }\n\n  if(n > 40) n = 40;\n\n  vector<ll> v;\n  ll aa = 1;\n  ll bb = 1;\n\n  try{\n    REP(i,n){\n      ll val = mult(p, aa) + mult(q, bb);\n      if(val <= m + m) v.push_back(val);\n      else break;\n      aa = mult(aa, a);\n      bb = mult(bb, b);\n    }\n  }catch(int n){}\n\n  vector<ll> as;\n  vector<ll> bs;\n\n  n = v.size();\n\n  REP(i,1<<(n/2)){\n    ll tmp = 0;\n    REP(j,n/2) if(i & (1 << j)) tmp += v[j];\n    as.push_back(tmp);\n  }\n\n  REP(i,1<<(n/2 + n%2)){\n    ll tmp = 0;\n    REP(j,n/2 + n%2) if(i & (1 << j))\n      tmp += v[j + n / 2];\n    bs.push_back(tmp);\n  }\n\n  sort(as.begin(), as.end());\n  sort(bs.rbegin(), bs.rend());\n\n  // REP(i,as.size()) cout << as[i] << \" \"; cout << endl;\n  // REP(i,bs.size()) cout << bs[i] << \" \"; cout << endl;\n\n  size_t ai = 0, an = as.size() - 1;\n  size_t bi = 0, bn = bs.size() - 1;\n  ll ans = m;\n\n  while(ai < an || bi < an){\n    ll tmp = as[ai] + bs[bi];\n    ans = min(ans, std::abs(m - tmp));\n    if(tmp > m){\n      if(bi != bn) bi++;\n      else ai++;\n    }else{\n      if(ai != bn) ai++;\n      else bi++;\n    }\n  }\n\n  cout << ans << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint main(){\n  long long int n, m, a, b, p, q, ans;\n  cin >> n >> m >> a >> b >> p >> q;\n  if(a < b){\n    swap(a, b);\n    swap(p, q);\n  }\n  if(a == 1LL){\n    if(m/(p + q) >= n) cout << m - n*(p + q) << endl;\n    else{\n      long long int t = m - m/(p + q)*(p + q);\n      cout << min(t, p + q - t) << endl;\n    }\n    return 0;\n  }\n  ans = m;\n  long long int x = 1LL, y = 1LL;\n  for(int i = 1; i < n; ++i){\n    if(x*a < 0 || y*b < 0) break;\n    if(m <= p*x + q*y) break;\n    x *= a;\n    y *= b;\n  }\n\n  while(x > 0){\n    ans = min(ans, abs(m - (p*x + q*y)));\n    if(m >= p*x + q*y) m -= p*x + q*y;\n    x /= a;\n    y /= b;\n  }\n  cout << ans << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <vector>\n#define repeat(i, n) for (int i = 0; (i) < int(n); ++(i))\n#define repeat_from(i, m, n) for (int i = (m); (i) < int(n); ++(i))\n#define whole(f, x, ...) ([&](decltype((x)) whole) { return (f)(begin(whole), end(whole), ## __VA_ARGS__); })(x)\nusing ll = long long;\nusing namespace std;\ntemplate <class T> inline void setmin(T & a, T const & b) { a = min(a, b); }\n\nll solve(ll n, ll m, ll a, ll b, ll p, ll q) {\n    if (a == 1 and b == 1) {\n        ll delta = p + q;\n        ll result = m;\n        setmin(result, abs(m - min(n,  m              / delta) * delta));\n        setmin(result, abs(m - min(n, (m + delta - 1) / delta) * delta));\n        return result;\n    }\n    vector<ll> tickets;\n    for (ll k = 0; k < n; ++ k) {\n        double ticket = p * pow(a, k) + q * pow(b, k);\n        if (2 * m + 3 < ticket) break;\n        tickets.push_back(ticket);\n    }\n    if (tickets.empty()) {\n        return m;\n    } else if (tickets.size() == 1) {\n        return min(m, abs(m - tickets[0]));\n    }\n    auto generate = [&](int l, int r) {\n        vector<ll> acc;\n        acc.push_back(0);\n        repeat_from (k, l, r) {\n            ll ticket = tickets[k];\n            int prev_size = acc.size();\n            repeat (i, prev_size) {\n                acc.push_back(acc[i] + ticket);\n            }\n            whole(sort, acc);\n            acc.erase(whole(unique, acc), acc.end());\n        }\n        return acc;\n    };\n    vector<ll> lower = generate(0, tickets.size() / 2);\n    vector<ll> upper = generate(tickets.size() / 2, tickets.size());\n    ll result = m;\n    for (ll x : lower) {\n        int i = whole(lower_bound, upper, m - x) - upper.begin();\n        repeat_from (j, max(0, i - 3), min<int>(upper.size(), i + 3)) {\n            ll y = upper[j];\n            setmin(result, abs(m - (x + y)));\n        }\n    }\n    return result;\n}\n\nint main() {\n    ll n, m, a, b, p, q; scanf(\"%lld%lld%lld%lld%lld%lld\", &n, &m, &a, &b, &p, &q);\n    ll result = solve(n, m, a, b, p, q);\n    printf(\"%lld\\n\", result);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=__int128;\n\nusing ll2=long long;\n\nconst ll INF=1e15;\n\nll powi(ll x,ll k){\n    ll res=1;\n    while(k){\n        if(k&1) res*=x;\n        if(res>INF) return INF;\n        x*=x;\n        k>>=1;\n    }\n    return res;\n}\nint main(){\n    ll2 nn,mm,aa,bb,pp,qq;\n    cin>>nn>>mm>>aa>>bb>>pp>>qq;\n    ll n=nn,m=mm,a=aa,b=bb,p=pp,q=qq;\n    if(a>=2 || b>=2){\n        int tn=min(n,ll(41));\n        int half=min((tn*2)/3,22);\n        vector<ll> vec(1<<half);\n        for(int i=0;i<(1<<half);i++){\n            ll val=0;\n            for(int j=0;j<half;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,j)+q*powi(b,j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            vec[i]=val;\n\n        }\n        int rest=tn-half;\n        vector<int> s(1<<rest);\n        for(int i=0;i<(1<<rest);i++){\n            ll val=0;\n            for(int j=0;j<rest;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,half+j)+q*powi(b,half+j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            s[i]=val;\n        }\n        ll2 res=m;\n        for(int i=0;i<vec.size();i++){\n            auto it=lower_bound(s.begin(),s.end(),m-vec[i]);\n            if(it!=s.end()){\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n            if(it!=s.begin()){\n                it--;\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n        }\n        cout<<res<<endl;\n    }\n    else{\n        if((p+q)*n>=m){\n            cout<<ll2(min(m%(p+q),(p+q)-m%(p+q)))<<endl;\n        }\n        else{\n            cout<<ll2(m-(p+q)*n)<<endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cassert>\n#include<climits>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\ntypedef long long ll;\n\nvector<ll> generate(vector<ll> a){\n  vector<ll> ret;\n  int n = a.size();\n  rep(i,(1<<n)){\n    ll tmp = 0;\n    rep(j,n){\n      if ((1<<j)&i)tmp += a[j];\n    }\n    ret.push_back(tmp);\n  }\n  sort(ret.begin(),ret.end());\n  return ret;\n}\n\nll bs(ll m,ll sum,vector<ll> &a,bool fg){\n  int ret = -1;\n  int l = 0,r = a.size()-1;\n  while(l <= r){\n    int mid = (l+r)/2;\n    ll tmp = sum + a[mid];\n    if (fg){\n      if (tmp <= m){//ä¸éããã£ã¨ä¸ããã\n\tret = mid;\n\tl = mid+1;\n      }else {\n\tr = mid-1;\n      }\n    }else {\n      if (tmp >= m){\n\tret = mid;\n\tr = mid-1;\n      }else {\n\tl = mid+1;\t\n      }\n    }\n  }\n\n  /*  cout <<\"dbg\" << endl;\n  rep(i,a.size())cout << a[i] <<\" \" ;cout << endl;\n  cout <<fg <<\" \" <<  m <<\" \" << sum <<\" \" << (ret != -1?a[ret]:-1) <<\" \" << \n    ((ret != -1)?sum+a[ret]:-1)\n       << endl;\n  */\n  if (ret == -1)return llabs(m-sum);\n  return llabs(m-(sum+a[ret]));\n}\n\nll ans;\nvoid search(int n,int now,ll sum,int m,vector<ll> &a,vector<ll> &all){\n  //ub,sumã¨aã®è¦ç´ ã§ãmä»¥ä¸ã§æå¤§ã®ãã®ãæ¢ã\n  //lb,sumã¨aã®è¦ç´ ã®åã§mä»¥ä¸æå°ã®ãã®ãæ¢ã\n  ll ub=bs(m,sum,all,true),lb=bs(m,sum,all,false);\n  ans = min(ans,ub);\n  ans = min(ans,lb);\n  if (now == n)return;\n  //ä½¿ã\n  search(n,now+1,sum+a[now],m,a,all);\n  //ä½¿ããªã\n  search(n,now+1,sum,m,a,all);\n}\n\n/*\n  ååå¨åæãã ãã¡ã¢ãªç¯ç´ãããã®ã§å¾ãååã¯æ¢ç´¢ããã\n */\nll solve2(vector<ll> in,ll m){\n  vector<ll> mae,usiro;\n  rep(i,in.size()){\n    if (i < in.size()/2)mae.push_back(in[i]);\n    else usiro.push_back(in[i]);\n  }\n  vector<ll> all=generate(mae);\n  ans = m;\n  search(usiro.size(),0,0,m,usiro,all);\n  return ans;\n}\n\nll solve(ll n,ll m,ll a,ll b,ll p,ll q){\n  if (a == 1 && b == 1){//ç¹æ®ã±ã¼ã¹\n    assert(false);\n    ll sum = a+b;\n    ll lb = min(n,m/sum),ub=min(n,(m+sum-1)/sum);\n    ll ret = m;\n    if (lb <= n){\n      ret = min(ret,llabs(m-lb*(a+b)));\n    }\n    if (ub <= n){\n      ret = min(ret,llabs(m-ub*(a+b)));\n    }\n    return ret;\n  }\n\n  //ãã±ããã®çæ\n  //ä¸å¿doubleåã§å¤ã¯åãæ±ã£ã¦ããã\n  //å¿è¦ãªãã±ããã¯æå¤§ï¼ï¼æã§ãããä»¥ä¸ã¯æå³ããªãã\n  int loop = 0;\n  ll cur = p + q;\n  ll mula=1,mulb=1;\n  double m_d=m;\n  double cur_d = p+q;\n  double mula_d = 1, mulb_d = 1;\n  vector<ll> all;\n  all.push_back(cur);\n  while(cur_d <= m_d && loop < n){\n    mula *= a;\n    mulb *= b;\n    cur = p*mula + q*mulb;\n    all.push_back(cur);\n\n    mula_d *= a;\n    mulb_d *= b;\n    cur_d = p*mula_d + q*mulb_d;\n  }\n  //rep(i,all.size())cout << all[i] <<\" \" ;cout << endl;\n\n  if (all.size() == 1){//ä¸ã¤ããä½¿ãããã±ããããªããªããããç­ãã«ããã(å¿ãï¼æã¯ãããã¨ãä¿è¨¼ããã¦ãã)\n    return min(m,llabs(all[0]-m));\n  }\n  return solve2(all,m);\n}\n\nmain(){\n  ll n,m,a,b,p,q;\n  while(cin>>n>>m>>a>>b>>p>>q && n){\n    cout << solve(n,m,a,b,p,q)  << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<ll, ll> P;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(ll i=(ll)(a);i<(ll)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define mmax(x,y) (x>y?x:y)\n#define mmin(x,y) (x<y?x:y)\n#define maxch(x,y) x=mmax(x,y)\n#define minch(x,y) x=mmin(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt __builtin_popcount\n\n#define INF 1e18\n#define mod 1000000007\n\nll n,m,a,b,p,q;\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll res=m;\n  if(a==1&&b==1){\n    ll cnt=min(m/(p+q),n);\n    minch(res,m-cnt*(p+q));\n    cnt=min(cnt+1,n);\n    if(cnt*(p+q)-m>=0)minch(res,cnt*(p+q)-m);\n    cout<<res<<endl;\n    return 0;\n  }\n  ll crt1=p,crt2=q;\n  vector<ll> cs,cs1;\n  rep(k,n+1){\n    if(2*m<crt1+crt2)break;\n    cs.push_back(crt1+crt2);\n    if(2*m/a<crt1||2*m/b<crt2)break;\n    crt1*=a;\n    crt2*=b;\n  }\n  ll n1=cs.size()/2;\n  ll n2=cs.size()-n1;\n  rep(S,1<<n1){\n    ll sum=0;\n    rep(i,n1){\n      if((S>>i)&1)sum+=cs[i];\n    }\n    cs1.push_back(sum);\n  }\n  sort(all(cs1));\n\n  rep(S,1<<n2){\n    ll sum=0;\n    rep(i,n2){\n      if((S>>i)&1)sum+=cs[n1+i];\n    }\n    if(sum>=m){\n      minch(res,sum-m);\n    }else{\n      ll idx=lower_bound(all(cs1),m-sum)-cs1.begin();\n      if(idx<cs1.size()){\n        minch(res,sum+cs1[idx]-m);\n      }\n      if(idx>0){\n        minch(res,m-(sum+cs1[idx-1]));\n      }\n    }\n  }\n  cout<<res<<endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <vector>\n#include <algorithm>\n\n#define show(x) cerr << #x << \" = \" << x << endl\n\nusing namespace std;\nusing ld = long double;\nusing ll = long long;\n\ntemplate <typename T>\nostream& operator<<(ostream& os, const vector<T>& v)\n{\n    os << \"[\";\n    for (const auto& e : v) {\n        os << e << \",\";\n    }\n    os << \"] \";\n    os << \"size = \" << v.size() << endl;\n    return os;\n}\n\nint main()\n{\n    ll n, m, a, b, p, q;\n    cin >> n >> m >> a >> b >> p >> q;\n\n    if (p + q > m) {\n        cout << min(m, p + q - m) << endl;\n    } else if (a == b) {\n        cout << min(m % (p + q), (p + q) - (m % (p + q))) << endl;\n    } else {\n        ll k = 0;\n        ll A = 1;\n        ll B = 1;\n        vector<ll> value;\n        for (; p * A + q * B <= m and k <= n; k++) {\n            value.push_back(p * A + q * B);\n            A *= a;\n            B *= b;\n        }\n        n = k;\n        const ll former = n / 2;\n        const ll latter = n - former;\n        const ll fmax = 1 << former;\n        const ll lmax = 1 << latter;\n\n        vector<ll> fsum(fmax, 0LL);\n        for (ll i = 0; i < fmax; i++) {\n            for (ll j = 0; j < former; j++) {\n                if (i & (1LL << j)) {\n                    fsum[i] = fsum[i - (1LL << j)] + value[j];\n                    break;\n                }\n            }\n        }\n        vector<ll> lsum(lmax, 0LL);\n        for (ll i = 0; i < lmax; i++) {\n            for (ll j = 0; j < latter; j++) {\n                if (i & (1LL << j)) {\n                    lsum[i] = lsum[i - (1LL << j)] + value[former + j];\n                    break;\n                }\n            }\n        }\n        show(fsum);\n        show(lsum);\n        sort(lsum.begin(), lsum.end());\n        constexpr ll INF = 1LL << 60;\n        ll error = INF;\n        for (ll f : fsum) {\n            const ll res = m - f;\n            if (res <= 0) {\n                error = min(error, -res);\n            } else {\n                auto it = lower_bound(lsum.begin(), lsum.end(), res);\n                if (it != lsum.end()) {\n                    error = min(error, abs(res - (*it)));\n                }\n                it--;\n                error = min(error, abs(res - (*it)));\n            }\n        }\n        cout << error << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <queue>\n#include <cmath>\n#include <algorithm>\n#include <functional>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<(n);++i)\n#define rep1(i,n) for(int i=1;i<=(n);++i)\n#define all(c) (c).begin(),(c).end()\n#define pb push_back\n#define fs first\n#define sc second\n#define show(x) cout << #x << \" = \" << x << endl\ntypedef long long ll;\nll inf=1e14;\nint main(){\n\tll n,m,a,b,p,q;\n\tcin>>n>>m>>a>>b>>p>>q;\n\tif(a>b) swap(n,m),swap(a,b),swap(p,q);\n\tll ans=m;\n\tif(b==1){\n\t\tll k=p+q;\n\t\tll d=min(n,m/k);\n\t\tans=m-k*d;\n\t\tif(d!=n) ans=min(ans,(d+1)*k-m);\n\t}else if(a==1){\n\t\tll bq[45]={},sum[46]={};\n\t\tbq[0]=q;\n\t\tsum[1]=q;\n\t\tll id=0;\n\t\tfor(;id<n-1;id++){\n\t\t\tif(bq[id]>inf/b) break;\n\t\t\tbq[id+1]=bq[id]*b;\n\t\t\tsum[id+2]=sum[id+1]+bq[id+1];\n\t\t}\n/*\t\tshow(id);\n\t\trep(i,id+1){\n\t\t\tshow(bq[i]);\n\t\t\tshow(sum[i]);\n\t\t}*/\n\t\t//can use 0~id\n\t\tll id_c=id;\n\t\tfor(ll k=1;k<=min(n,id_c+1);k++){\n\t\t\tif(bq[k-1]==0) break;\n//\t\t\tshow(k);\n\t\t\tll left=m-p*k;\n\t\t\tll now=0;\n\t\t\tid=id_c;\n\t\t\tint use=0;\n\t\t\tfor(;id>=0;id--){\n\t\t\t\tif(now+bq[id]>left){\n\t\t\t\t\tif(k-use-1>=0&&k-use-1<=id) ans=min(ans,now+bq[id]+sum[k-use-1]-left);\n\t\t\t\t}else{\n\t\t\t\t\tnow+=bq[id];\n\t\t\t\t\tuse++;\n\t\t\t\t\tif(use==k){\n\t\t\t\t\t\tans=min(ans,left-now);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}else{\n\t\tll id=0;\n\t\tll l=p,r=q;\n\t\tll num[40]={};\n\t\tfor(;id<n;id++){\n\t\t\tnum[id]=l+r;\n\t\t\tif(l>inf/a) break;\n\t\t\tif(r>inf/b) break;\n\t\t\tl*=a;\n\t\t\tr*=b;\n\t\t}\n\t\tif(id==n) id--;\n\t\t//can use 0~id\n\t\tll now=0;\n\t\tfor(;id>=0;id--){\n\t\t\tif(now+num[id]>m){\n\t\t\t\tans=min(ans,now+num[id]-m);\n\t\t\t}else{\n\t\t\t\tans=min(ans,m-(now+num[id]));\n\t\t\t\tnow+=num[id];\n\t\t\t}\n\t\t}\n\t}\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define N 41\nusing namespace std;\ntypedef long long ll;\nll n,m,a,b,p,q,d[N];\nvector<ll> v[2],x[2];\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll ans=m;\n  if(a==1&&b==1){\n    ll ti=min(n,m/(p+q));\n    ans=min(ans,min(m-ti*(p+q),abs(min(ti+1,n)*(p+q)-m)));\n  }\n  ll A=1,B=1,T=min((ll)N,n);\n  for(int i=0;i<T;i++){\n    d[i]=p*A+q*B;\n    if(i<T/2)v[0].push_back(d[i]);\n    else v[1].push_back(d[i]);\n    if(d[i]>m)break;\n    A*=a,B*=b;\n  }\n  int len[2]={v[0].size(),v[1].size()};\n  for(int i=0;i<2;i++){\n    v[i].push_back(0);\n    for(int j=0;j<(1<<len[i]);j++){\n      ll sum=0;\n      for(int k=0;k<len[i];k++)\n\tif((j&(1<<k)))sum+=v[i][k];\n      x[i].push_back(sum);\n    }\n    sort(x[i].begin(),x[i].end());\n  }\n  for(int i=0;i<x[0].size();i++){\n    ll S=m-x[0][i];\n    vector<ll>::iterator r=lower_bound(x[1].begin(),x[1].end(),S);\n    if(r!=x[1].end())ans=min(ans,(*r)-S);\n    if(r!=x[1].begin())ans=min(ans,S-(*(r-1)));\n  }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return m%d;\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        res=min( res, abs( m- ( T[i]+U[j] )) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\n#define INF 2e+12\nusing namespace std;\n\nsigned main(){\n\tint n,m,a,b,p,q,mi;\n\tvector<int> vec,num;\n\tcin >> n >> m >> a >> b >> p >> q;\n\tmi = m;\n\tif(a == 1 && b == 1){\n\t\tif(p + q >= (m + n - 1) / n) cout << min(m % (p + q),p + q - m % (p + q)) << endl;\n\t\telse cout << m - (p + q) * n << endl;\n\t\treturn 0;\n\t}\n\tint ta = p,tb = q;\n\tfor(int i = 0;i < n;i++){\n\t\tif(ta + tb > INF) break;\n\t\tvec.push_back(ta + tb);\n\t\tif(ta > (INF + a - 1) / a || tb > (INF + b - 1) / b) break;\n\t\tta *= a;\n\t\ttb *= b;\n\t}\n\tn = vec.size();\n\tfor(int i = 0;i < (1 << (n / 2));i++){\n\t\tint sum = 0;\n\t\tfor(int j = 0;j < n / 2;j++){\n\t\t\tif((i >> j) & 1) sum += vec[j];\n\t\t}\n\t\tnum.push_back(sum);\n\t}\n\tsort(num.begin(),num.end());\n\tfor(int i = 0;i < (1 << ((n + 1) / 2));i++){\n\t\tint sum = 0;\n\t\tfor(int j = 0;j < (n + 1) / 2;j++){\n\t\t\tif((i >> j) & 1) sum += vec[j + n / 2];\n\t\t}\n\t\tint ind = upper_bound(num.begin(),num.end(),m - sum) - num.begin() - 1;\n\t\tif(ind >= 0) mi = min(mi,m - sum - num[ind]);\n\t\tif(ind + 1 < n) mi = min(mi,-(m - sum - num[ind + 1]));\n\t}\n\tcout << mi << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  ll MAX=1000000000000LL;\n  \n  assert( 1<= n &&n <= MAX );\n  assert( 1<= m &&m <= MAX );\n  assert( 1<= a &&a <= MAX );\n  assert( 1<= b &&b <= MAX );\n  assert( 1<= p &&p <= MAX );\n  assert( 1<= q &&q <= MAX );\n  \n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    //    if(total <= m)return m-total;\n    return m%d;\n    \n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n    if( i==40 )break;\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        ll c=T[i]+U[j];\n        res=min( res,  abs(m-c) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i,n) for(ll i=0;i<(ll)(n);i++)\n\nusing namespace std;\ntypedef long long ll;\ntypedef __int128_t dll;\n\nint main() {\n  ll n,m,a,b,p,q;\n  cin>>n>>m>>a>>b>>p>>q;\n  if (a == b && b == 1) {\n    if (m/(p+q) >= n)\n      cout << min(m%(p+q), m-(m%p+q)) << endl;\n    else\n      cout << m-(p+q)*n << endl;\n    return 0;\n  }\n  vector<ll> nums;\n  dll pa = p, qb = q;\n  REP(i,n) {\n    if (pa + qb >= 2*m) break;\n    nums.push_back(pa+qb);\n    pa *= a;\n    qb *= b;\n  }\n  int l = nums.size();\n  int s1 = l/2, s2=l-s1;;\n  vector<ll> lsr(begin(nums),begin(nums)+s1);\n  vector<ll> gtr(begin(nums)+s1,end(nums));\n  vector<ll> l1(1<<s1),l2(1<<s2);\n  REP(i,1<<s1) REP(j,s1)\n    if((i>>j)&1) l1[i] += lsr[j];\n  REP(i,1<<s2) REP(j,s2)\n    if((i>>j)&1) l2[i] += gtr[j];\n  sort(begin(l2),end(l2));\n  ll mn = m;\n  REP(i,1<<s1) {\n    auto itr = lower_bound(begin(l2),end(l2),m-l1[i]);\n    if(itr!=end(l2)) mn=min(mn,(l1[i]+*itr)-m);\n    if(itr!=begin(l2)) mn=min(mn,m-(l1[i]+*prev(itr)));\n  }\n  cout << mn << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <fstream>\n#include <iomanip>\n#include <iostream>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <valarray>\n#include <vector>\n\n#define EPS 1e-9\n#define INF 1070000000LL\n#define MOD 1000000007LL\n#define fir first\n#define foreach(it,X) for(__typeof((X).begin()) it=(X).begin();it!=(X).end();it++)\n#define ite iterator\n#define mp make_pair\n#define rep(i,n) rep2(i,0,n)\n#define rep2(i,m,n) for(int i=m;i<(n);i++)\n#define pb push_back\n#define sec second\n#define sz(x) ((int)(x).size())\n\nusing namespace std;\n\nstruct timer{\n\ttime_t start;\n\ttimer(){start=clock();}\n\t~timer(){cerr<<1.*(clock()-start)/CLOCKS_PER_SEC<<\" secs\"<<endl;}\n};\n\ntypedef istringstream iss;\ntypedef long long ll;\ntypedef pair<int,int> pi;\ntypedef stringstream sst;\ntypedef vector<int> vi;\n\nll n,m,a,b,p,q;\nvector<ll> v;\n\nint main(){\n\tcin.tie(0);\n\tios_base::sync_with_stdio(0);\n\t\n\tcin>>n>>m>>a>>b>>p>>q;\n\tif(a==1 && b==1){\n\t\tll t=p+q;\n\t\tif(n < (m+t-1)/t){\n\t\t\tcout<<m-t*n<<endl;\n\t\t}else{\n\t\t\tcout<<min(m%t,t-m%t)<<endl;\n\t\t}\n\t\treturn 0;\n\t}\n\tvector<ll> v;\n\tll pa=p,qb=q;\n\tdouble pa_=p,qb_=q;\n\trep(i,n){\n\t\tif(pa_+qb_>3*m)break;\n\t\tif(pa+qb>2*m)break;\n\t\tv.pb(pa+qb);\n\t\tpa*=a,qb*=b;\n\t\tpa_*=a,qb_*=b;\n\t}\n\t//rep(i,sz(v))cout<<v[i]<<\" \";cout<<endl;\n\t\n\tvector<ll> v0,v1,sum;\n\tint N=sz(v)/2;\n\trep(i,sz(v)){\n\t\tif(i<N)v0.pb(v[i]);\n\t\telse v1.pb(v[i]);\n\t}\n\trep(mask,1<<sz(v1)){\n\t\tll s=0;\n\t\trep(i,sz(v1))if(mask>>i&1){\n\t\t\ts+=v1[i];\n\t\t}\n\t\tsum.pb(s);\n\t}\n\tsort(sum.begin(),sum.end());\n\t\n\tll ans=m;\n\trep(mask,1<<sz(v0)){\n\t\tll s=0;\n\t\trep(i,sz(v0))if(mask>>i&1){\n\t\t\ts+=v0[i];\n\t\t}\n\t\tif(s>=m){\n\t\t\tans=min(ans,s-m);\n\t\t}else{\n\t\t\tll rest=m-s;\n\t\t\tvector<ll>::ite it=lower_bound(sum.begin(),sum.end(),rest);\n\t\t\tans=min(ans,*it-rest);\n\t\t\tit--;\n\t\t\tans=min(ans,rest-*it);\n\t\t}\n\t}\n\tcout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cassert>\n#include<climits>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\ntypedef long long ll;\n\nvector<ll> generate(vector<ll> a){\n  vector<ll> ret;\n  int n = a.size();\n  rep(i,(1<<n)){\n    ll tmp = 0;\n    rep(j,n){\n      if ((1<<j)&i)tmp += a[j];\n    }\n    ret.push_back(tmp);\n  }\n  sort(ret.begin(),ret.end());\n  return ret;\n}\n\nll bs(ll m,ll sum,vector<ll> &a,bool fg){\n  int ret = -1;\n  int l = 0,r = a.size()-1;\n  while(l <= r){\n    int mid = (l+r)/2;\n    ll tmp = sum + a[mid];\n    if (fg){\n      if (tmp <= m){//ä¸éããã£ã¨ä¸ããã\n\tret = mid;\n\tl = mid+1;\n      }else {\n\tr = mid-1;\n      }\n    }else {\n      if (tmp >= m){\n\tret = mid;\n\tr = mid-1;\n      }else {\n\tl = mid+1;\t\n      }\n    }\n  }\n\n  /*  cout <<\"dbg\" << endl;\n  rep(i,a.size())cout << a[i] <<\" \" ;cout << endl;\n  cout <<fg <<\" \" <<  m <<\" \" << sum <<\" \" << (ret != -1?a[ret]:-1) <<\" \" << \n    ((ret != -1)?sum+a[ret]:-1)\n       << endl;\n  */\n  if (ret == -1)return llabs(m-sum);\n  //cout << m <<\" \" << sum+a[ret] << \" \" << llabs(m-(sum+a[ret])) << endl;\n  return llabs(m-(sum+a[ret]));\n}\n\nll ans;\nvoid search(int n,int now,ll sum,ll m,vector<ll> &a,vector<ll> &all){\n  //ub,sumã¨aã®è¦ç´ ã§ãmä»¥ä¸ã§æå¤§ã®ãã®ãæ¢ã\n  //lb,sumã¨aã®è¦ç´ ã®åã§mä»¥ä¸æå°ã®ãã®ãæ¢ã\n  ll ub=bs(m,sum,all,true),lb=bs(m,sum,all,false);\n  ans = min(ans,ub);\n  ans = min(ans,lb);\n  if (now == n)return;\n  //ä½¿ã\n  search(n,now+1,sum+a[now],m,a,all);\n  //ä½¿ããªã\n  search(n,now+1,sum,m,a,all);\n}\n\n/*\n  ååå¨åæãã ãã¡ã¢ãªç¯ç´ãããã®ã§å¾ãååã¯æ¢ç´¢ããã\n */\nll solve2(vector<ll> in,ll m){\n  vector<ll> mae,usiro;\n  rep(i,in.size()){\n    if (i < in.size()/2)mae.push_back(in[i]);\n    else usiro.push_back(in[i]);\n  }\n  vector<ll> all=generate(mae);\n  ans = m;\n  search(usiro.size(),0,0,m,usiro,all);\n  return ans;\n}\n\nll solve(ll n,ll m,ll a,ll b,ll p,ll q){\n  if (a == 1 && b == 1){//ç¹æ®ã±ã¼ã¹\n    ll sum = p+q;\n    ll lb = min(n,m/sum),ub=min(n,(m+sum-1)/sum);\n    ll ret = m;\n    ret = min(ret,llabs(m-lb*(sum)));\n    ret = min(ret,llabs(m-ub*(sum)));\n    return ret;\n  }\n\n  //ãã±ããã®çæ\n  //ä¸å¿doubleåã§å¤ã¯åãæ±ã£ã¦ããã\n  //å¿è¦ãªãã±ããã¯æå¤§ï¼ï¼æã§ãããä»¥ä¸ã¯æå³ããªãã\n  int loop = 0;\n  ll cur = p + q;\n  ll mula=1,mulb=1;\n  double m_d=m;\n  double cur_d = p + q;\n  double mula_d = 1, mulb_d = 1;\n  vector<ll> all;\n  all.push_back(cur);\n  while(loop < n){\n    mula_d *= a;\n    mulb_d *= b;\n    cur_d   = p*mula_d + q*mulb_d;\n    if (cur_d > 2*m)break;\n    mula *= a;\n    mulb *= b;\n    cur = p*mula + q*mulb;\n    all.push_back(cur);\n\n  }\n\n  //rep(i,all.size())assert(all[i] > 0);\n  //rep(i,all.size())cout << all[i] <<\" \" ;cout << endl;\n\n  if (all.size() == 1){//ä¸ã¤ããä½¿ãããã±ããããªããªããããç­ãã«ããã(å¿ãï¼æã¯ãããã¨ãä¿è¨¼ããã¦ãã)\n    return min(m,llabs(all[0]-m));\n  }\n  return solve2(all,m);\n}\n\nmain(){\n  ll n,m,a,b,p,q;\n  while(cin>>n>>m>>a>>b>>p>>q && n){\n    cout << solve(n,m,a,b,p,q)  << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <vector>\n#include <queue>\n#include <string>\n#include <algorithm>\n#include <iostream>\n#include <string>\n#include <map>\n#include <set>\n#include <functional>\n#include <iostream>\n#define MOD 1000000007LL\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nll labs(ll x){\n\tif(x<0LL)return -x;\n\treturn x;\n}\n\nint zcnt(ll x){\n\tint cnt=0;\n\twhile(x>0){\n\t\tx/=10LL;\n\t\tcnt++;\n\t}\n\treturn cnt;\n}\n\nll n,m,a,b,p,q;\nll num[51];\nvector<ll> vec;\n\nint main(void){\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&n,&m,&a,&b,&p,&q);\n\tif(a==1LL && b==1LL){\n\t\tll dist=p+q;\n\t\tll cnt=m/dist;\n\t\tprintf(\"%lld\\n\",min(labs(m-min(cnt,n)*dist),labs(m-(min(cnt+1LL,n))*dist)));\n\t}else{\n\t\tll v=0;\n\t\tll np=p,nq=q;\n\t\twhile(np+nq<=m){\n\t\t\tnum[v]=np+nq;\n\t\t\tif(zcnt(np)+zcnt(a)>=zcnt(m)+2 || zcnt(nq)+zcnt(b)>=zcnt(m)+2)break;\n\t\t\tnp*=a;\n\t\t\tnq*=b;\n\t\t\tv++;\n\t\t}\n\t\tll res=m;\n\t\tv=min(v,n);\n\t\tint v2=v/2;\n\t\tfor(int bit=0;bit<(1<<v2);bit++){\n\t\t\tll now=0;\n\t\t\tfor(int i=0;i<v2;i++){\n\t\t\t\tif((bit>>i) & 1){\n\t\t\t\t\tnow+=num[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tvec.push_back(now);\n\t\t}\n\t\tsort(vec.begin(),vec.end());\n\t\tvec.erase(unique(vec.begin(),vec.end()),vec.end());\n\t\tint v3=v-v2;\n\t\tfor(int bit=0;bit<(1<<v3);bit++){\n\t\t\tll now=0;\n\t\t\tfor(int i=0;i<v3;i++){\n\t\t\t\tif((bit>>i) & 1){\n\t\t\t\t\tnow+=num[i+v2];\n\t\t\t\t}\n\t\t\t}\n\t\t\tint l=lower_bound(vec.begin(),vec.end(),m-now)-vec.begin();\n\t\t\tres=min(res,labs(m-now-vec[l]));\n\t\t\tif(l>0){\n\t\t\t\tres=min(res,labs(m-now-vec[l-1]));\n\t\t\t}\n\t\t}\n\t\tprintf(\"%lld\\n\",res);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing PII = pair<int, int>;\nusing LL = long long;\nusing VL = vector<LL>;\nusing VVL = vector<VL>;\nusing PLL = pair<LL, LL>;\nusing VS = vector<string>;\n\n#define ALL(a)  begin((a)),end((a))\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define EB emplace_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define SORT(c) sort(ALL((c)))\n#define RSORT(c) sort(RALL((c)))\n#define UNIQ(c) (c).erase(unique(ALL((c))), end((c)))\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\n#define FF first\n#define SS second\ntemplate<class S, class T>\nistream& operator>>(istream& is, pair<S,T>& p){\n  return is >> p.FF >> p.SS;\n}\ntemplate<class S, class T>\nostream& operator<<(ostream& os, const pair<S,T>& p){\n  return os << p.FF << \" \" << p.SS;\n}\ntemplate<class T>\nvoid maxi(T& x, T y){\n  if(x < y) x = y;\n}\ntemplate<class T>\nvoid mini(T& x, T y){\n  if(x > y) x = y;\n}\n\n\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\nconst LL MOD = 1e9+7;\nconst LL INF = 1e17;\n\nint main(){\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n\n  long long n_, m_, a_, b_, p_, q_;\n  cin >> n_ >> m_ >> a_ >> b_ >> p_ >> q_;\n  LL n, m, a, b, p, q;\n  n = n_;\n  m = m_;\n  a = a_;\n  b = b_;\n  p = p_;\n  q = q_;\n\n  LL ans = INF;\n  if(a == 1 && b == 1){\n\tLL k = min(n, m / (p+q));\n\tmini(ans, abs(k*(p+q) - m));\n\tif(k+1 < n)\n\t  mini(ans, abs((k+1)*(p+q) - m));\n  }\n  else{\n\tLL M = min((LL)40, n);\n\tLL M2 = M / 2;\n\tvector<LL> as(M+1), bs(M+1);\n\tas[0] = bs[0] = 1;\n\tREP(i,M){\n\t  as[i+1] = (as[i]>=INF/a? INF: as[i] * a);\n\t  bs[i+1] = (bs[i]>=INF/b? INF: bs[i] * b);\n\t}\n\t\n\tvector<LL> xs = {0}, ys = {0};\n\tfor(int bb=0;bb<1<<M2;++bb){\n\t  LL sum = 0;\n\t  REP(i,M2)\n\t\tif(bb>>i&1){\n\t\t  if(as[i] < INF/p)\n\t\t\tsum += as[i]*p;\n\t\t  else\n\t\t\tsum = INF;\n\t\t  if(bs[i] < INF/p)\n\t\t\tsum += bs[i]*q;\n\t\t  else\n\t\t\tsum = INF;\n\t\t}\n\t  xs.PB(sum);\n\t}\n\tfor(int bb=0;bb<1<<(M-M2);++bb){\n\t  LL sum = 0;\n\t  REP(i,M-M2)\n\t\tif(bb>>i&1){\n\t\t  if(as[i+M2] < INF/p)\n\t\t\tsum += as[i+M2]*p;\n\t\t  else\n\t\t\tsum = INF;\n\t\t  if(bs[i+M2] < INF/p)\n\t\t\tsum += bs[i+M2]*q;\n\t\t  else\n\t\t\tsum = INF;\n\t\t}\n\t  ys.PB(sum);\n\t}\n\n\tfor(auto x: xs){\n\t  auto it = upper_bound(ALL(ys), m - x);\n\t  if(it != end(ys))\n\t\tmini(ans, abs(x + *it - m));\n\t  if(it != begin(ys)){\n\t\t--it;\n\t\tmini(ans, abs(x + *it - m));\n\t  }\n\t}\n  }\n\n  long long ans_ = ans;\n  cout << ans_ << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  ll MAX=1000000000000LL;\n  \n  assert( 1<= n &&n <= MAX );\n  assert( 1<= m &&m <= MAX );\n  assert( 1<= a &&a <= MAX );\n  assert( 1<= b &&b <= MAX );\n  assert( 1<= p &&p <= MAX );\n  assert( 1<= q &&q <= MAX );\n  \n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n\n\n    if(total <= m)return m-total;\n    \n    return min(m%d,m-m%d);\n    \n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n    if( i==40 )break;\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        ll c=T[i]+U[j];\n        res=min( res,  abs(m-c) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n#define INF 1<<30\n#define LINF 1LL<<60\n\n/*\n<url:http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=2239>\n?????????============================================================\n????????????????????????????????±?????????n ????????£?????????. ?????±????????????????????????0 ??????n ??? 1 ?????§???????????????????????????, \nk ???????????±?????????????????¨, p???a^k + q???b^k ?§????????????¨?????§??????.\n\n??????????????????????§???????m ?§???????????§???????????????????????£??????????????????????????????????,???????????????????????¢??????????????????.\n?§????????????????????????§??????.\n?????±?????????????????????????????§???????????¨???????????¨????????¨???, ????????????????°?????§???????????????§??????????????????.\n\n1 ??? n, m, a, b, p, q ??? 10^12 (??´??°)\n=================================================================\n?§£??¬=============================================================\n================================================================\n*/\n\nconst ll MOD = (ll)1e15;\nll powmod(ll a, ll b) { ll res = 1;a %= MOD; assert(b >= 0); for (;b;b >>= 1) { if (b & 1)res = res*a%MOD;a = a*a%MOD; }return res; }\nint main(void) {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\tll n, m, a, b, p, q; cin >> n >> m >> a >> b >> p >> q;\n\tll res = LINF;\n\tif (a == 1 && b == 1) {\n\t\tll k = m / (p + q);\n\t\tres = min({ m,abs(m - min(k,n)*(p + q)),abs(min((k + 1),n)*(p + q) - m )});\n\t}else {\n\t\tll N = min(40LL, n);\n\t\tvector<ll> L;\n\t\tfor (int i = 0; i < (1 << (N / 2));i++) {\n\t\t\tll T = 0;\n\t\t\tfor (int j = 0; j < N / 2;j++) {\n\t\t\t\tif ((i >> j) & 1) {\n\t\t\t\t\tT += p*powmod(a, j) + q*powmod(b, j);\n\t\t\t\t\tif (T > MOD)break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tL.push_back(T);\n\t\t}\n\t\tL.push_back(LINF);\n\t\tfor (auto l : L) {\n\t\t//\tcout << l << endl;\n\t\t}\n\t\tsort(L.begin(), L.end());\n\t\tfor (int i = 0; i < (1 << (N - N / 2));i++) {\n\t\t\tll T = 0;\n\t\t\tfor (int j = 0; j < (N - N / 2);j++) {\n\t\t\t\tif ((i >> j) & 1) {\n\t\t\t\t\tT += p*powmod(a, N / 2 + j) + q*powmod(b, N / 2 + j);\n\t\t\t\t\tif (T > MOD)break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tauto it = lower_bound(L.begin(), L.end(), m - T);\n\t\t\tres = min(res, abs(m - T - *it));\n\t\t\tif (it != L.begin()) res = min(res, abs(m - T - *(it - 1)));\n\t\t}\n\t}\n\tcout << res << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main() {\n    long long n, m, a, b, p, q;\n    cin >> n >> m >> a >> b >> p >> q;\n    if (a == 1 && b == 1) {\n        cout << (m / (p + q) > n ? m - (p + q) * n : m % (p + q)) << \"\\n\";\n        return 0;\n    }\n    double ad = 1, bd = 1;\n    long long ap = 1, bp = 1;\n    vector<long long> v;\n    for (int i = 0; i < n; ++i) {\n        if (p * ad + q * bd > 1e13 || p * ap + q * bp > m) break;\n        v.push_back(p * ap + q * bp);\n        ad *= a;\n        bd *= b;\n        ap *= a;\n        bp *= b;\n    }\n    int l = v.size();\n    int l1 = l / 2;\n    int l2 = l - l1;\n    set<long long> s1, s2;\n    for (int i = 0; i < (1 << l1); ++i) {\n        long long sum = 0;\n        for (int j = 0; j < l1; ++j) if ((i >> j) & 1) sum += v[j];\n        if (sum <= m) s1.insert(sum);\n    }\n    for (int i = 0; i < (1 << l2); ++i) {\n        long long sum = 0;\n        for (int j = 0; j < l2; ++j) if ((i >> j) & 1) sum += v[j + l1];\n        if (sum <= m) s2.insert(sum);\n    }\n    long long ans = m;\n    for (auto i : s1)\n        ans = min(ans, m - i - *--s2.upper_bound(m - i));\n\n    cout << ans << \"\\n\";\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint main(){\n  long long int n, m, a, b, p, q, ans;\n  cin >> n >> m >> a >> b >> p >> q;\n  if(a < b){\n    swap(a, b);\n    swap(p, q);\n  }\n  if(a == 1){\n    cout << m - min(n, m/2)*2 << endl;\n    return 0;\n  }\n  ans = m;\n  long long int x = 1, y = 1;\n  for(int i = 1; i < n; ++i){\n    if(m <= p*x + q*y) break;\n    x *= a;\n    y *= b;\n  }\n  while(x > 0){\n    ans = min(ans, abs(m - (p*x + q*y)));\n    if(m >= p*x + q*y) m -= p*x + q*y;\n    x /= a;\n    y /= b;\n  }\n  cout << ans << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\tll n,m,a,b,p,q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\t\n\tif(a == 1 && b == 1){\n\t\tcout << max( m%(p+q) , m-(p+q)*n ) << endl;\n\t}\n\telse {\n\t\tvector<ll> vec;\n\t\tll s = 1 , t = 1;\n\t\tfor(int i = 0 ; i < n ; i ++){\n\t\t\tif(p*s+q*t > m)break;\n\t\t\tvec.push_back(p*s+q*t);\n\t\t\ts *= a;\n\t\t\tt *= b;\n\t\t}\n\t\tint N = vec.size();\n\t\tvector<ll> A,B;\n\t\tA.push_back(0);\n\t\tfor(int i = 0 ; i < N/2 ; i ++){\n\t\t\tint x = A.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tA.push_back(vec[i]+A[j]);\n\t\t\t}\n\t\t}\n\t\tB.push_back(0);\n\t\tfor(int i = N/2 ; i < N ; i ++){\n\t\t\tint x = B.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tB.push_back(vec[i]+B[j]);\n\t\t\t}\n\t\t}\n\t\tsort(B.begin(),B.end());\n\t\tll ret = m;\n\t\tfor(int i = 0 ; i < A.size() ; i ++){\n\t\t\tint x = upper_bound(B.begin(),B.end(),m-A[i])-B.begin();\n\t\t\tx --;\n\t\t\tret = min ( ret , m-A[i]-B[x] );\n\t\t}\n\t\tcout << ret << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 1LL<<45;\nll Sum[100];\nll n,m,a,b,p,q;\n\n\nll calc(ll k){\n  ll A = 1,B = 1,res=p+q;\n  while(res>0&&res<=INF&&k--)A*=a,B*=b,res=p*A+q*B;\n  if(res<0) res = INF;\n  return min(INF,res);\n}\n\nll ans = INF;\nset<ll> used[101];\nvoid dfs(ll pos,ll sum){\n  ans = min(ans,(ll)abs(m-sum));\n  if(m<sum||pos==-1||sum>INF||used[pos].count(sum)) return;\n  if(Sum[pos]+sum<m){ans=min(ans,m-(Sum[pos]+sum));return;}\n  used[pos].insert(sum);\n  dfs(pos-1,sum+calc(pos));  \n  dfs(pos-1,sum);\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  Sum[0] = calc(0);\n  for(int i=1;i<60;i++)Sum[i]=min(INF,calc(i)+Sum[i-1]);\n\n  /*    if(max(a,b)==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - (p+q));\n    if(m/(p+q)==n) t = INF;\n    if(m/(p+q)<=n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n    }\n  */\n  dfs(min(n-1,50LL),0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\ntemplate<typename T1,typename T2> inline void chmin(T1 &a,T2 b){if(a>b) a=b;}\ntemplate<typename T1,typename T2> inline void chmax(T1 &a,T2 b){if(a<b) a=b;}\n\n//INSERT ABOVE HERE\nsigned main(){\n  using i128 = __int128_t;\n  Int n,m,a,b,p,q;\n  cin>>n>>m>>a>>b>>p>>q;\n  \n  i128 N(n),M(m),A(a),B(b),P(p),Q(q);\n\n\n  auto calc=[&](i128 a,i128 b)->i128{return a<=b?b-a:a-b;};\n  \n  if(a==1&&b==1){\n    i128 need=M/(P+Q);\n    if(need<=N){\n      i128 ans=calc(M,need*(P+Q));\n      if(need-1>=0) chmin(ans,calc(M,(need-1)*(P+Q)));\n      if(need+1<=N) chmin(ans,calc(M,(need+1)*(P+Q)));\n      cout<<Int(ans)<<endl;\n      return 0;\n    }\n    cout<<Int(M-N*(P+Q))<<endl;\n    return 0;\n  }\n  \n  vector<i128> vs;  \n  for(Int i=0;i<n;i++){\n    vs.emplace_back(P+Q);\n    if(P+Q>M) break;\n    P*=A;\n    Q*=B;\n  }\n  \n  const Int H = 20;\n  i128 ans=M;\n  vector<i128> hs;\n  \n  for(Int bit=0;bit<(1LL<<H);bit++){\n    i128 tmp=0;\n    for(Int i=0;i<(Int)vs.size();i++){\n      if((~bit>>i)&1) continue;\n      tmp+=vs[i];\n    }\n    hs.emplace_back(tmp);\n    chmin(ans,calc(M,tmp));\n  }\n  sort(hs.begin(),hs.end());\n  hs.erase(unique(hs.begin(),hs.end()),hs.end());\n  \n  if(vs.size()>H){\n    Int R=vs.size()-H;\n    for(Int bit=0;bit<(1LL<<R);bit++){      \n      i128 tmp=0;\n      for(Int i=H;i<(Int)vs.size();i++){\n        if((~bit>>(i-H))&1) continue;\n        tmp+=vs[i];\n      }\n      auto it=upper_bound(hs.begin(),hs.end(),M-tmp);\n      if(it!=hs.end()) chmin(ans,calc(M,tmp+*it));\n      ++it;\n      if(it!=hs.end()) chmin(ans,calc(M,tmp+*it));\n\n      for(Int k=0;k<3;k++){\n        if(it!=hs.begin()) --it;\n        chmin(ans,calc(M,tmp+*it));\n      }\n    }\n  }\n  cout<<(Int)ans<<endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (int)(k); i < (int)(n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\n\nint pow(ll x, ll n)\n{\n\tll res = 1;\n\twhile (n > 0)\n\t{\n\t\tif (n & 1) res = res * x;\n\t\tx = x*x;\n\t\tn >>= 1;\n\t}\n\treturn res;\n}\n\nll n, m, a, b, p, q;\n\nll calc(ll k)\n{\n\treturn p * pow(a, k) + q * pow(b, k);\n}\n\nll use(ll d)\n{\n\tREP(i, 42)\n\t{\n\t\tif (calc(i) > d) return i - 1;\n\t}\n}\n\nint main()\n{\n\tcin.sync_with_stdio(false); cout << fixed << setprecision(10);\n\tcin >> n >> m >> a >> b >> p >> q;\n\tll ans = LLONG_MAX;\n\tif (a == 1 && b == 1)\n\t{\n\t\tif ((p + q) * n < m) ans = m - (p + q) * n;\n\t\telse\n\t\t{\n\t\t\tint t = m / (p + q);\n\t\t\tans = min(m - (p + q) * t, (p + q)*(t + 1) - m);\n\t\t}\n\t}\n\telse if (a > 1 && b > 1)\n\t{\n\t\tset<int> st;\n\t\tll d = m;\n\t\tint cnt = 0, mx = n;\n\t\twhile (st.size() < n)\n\t\t{\n\t\t\tll t = use(d);\n\t\t\tif (t + 1 < n && !st.count(t + 1)) chmin(ans, calc(t + 1) - d);\n\t\t\tif (t < 0) break;\n\t\t\tll tmp = min(n, t);\n\t\t\twhile (st.count(tmp)) tmp--;\n\t\t\td -= calc(tmp);\n\t\t\tst.insert(tmp);\n\t\t\tchmin(ans, d);\n\t\t}\n\t\tchmin(ans, d);\n\t}\n\telse\n\t{\n\t\tif (a > b) swap(a, b);\n\t\tint loop = min(n, 41ll);\n\t\tREP(i, loop)\n\t\t{\n\t\t\tset<int> st;\n\t\t\tll d = m;\n\t\t\tint cnt = 0, mx = n;\n\t\t\twhile (st.size() < i)\n\t\t\t{\n\t\t\t\tll t = use(d);\n\t\t\t\tif (t < 0) break;\n\t\t\t\tll tmp = min(n, t);\n\t\t\t\twhile (st.count(tmp)) tmp--;\n\t\t\t\td -= calc(tmp);\n\t\t\t\tst.insert(tmp);\n\t\t\t}\n\t\t\tif (st.size() != i) continue;\n\t\t\tchmin(ans, m - d);\n\t\t\tif (st.size() > 0)\n\t\t\t{\n\t\t\t\tint last = *st.begin();\n\t\t\t\tif (!st.count(last + 1))\n\t\t\t\t{\n\t\t\t\t\td = d + calc(last) - calc(last + 1);\n\t\t\t\t\tchmin(ans, -d);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=__int128;\n\nusing ll2=long long;\n\nconst ll INF=1e15;\n\nll powi(ll x,ll k){\n    ll res=1;\n    while(k){\n        if(k&1) res*=x;\n        if(res>INF) return INF;\n        x*=x;\n        k>>=1;\n    }\n    return res;\n}\nint main(){\n    ll2 nn,mm,aa,bb,pp,qq;\n    cin>>nn>>mm>>aa>>bb>>pp>>qq;\n    ll n=nn,m=mm,a=aa,b=bb,p=pp,q=qq;\n    if(a>=2 || b>=2){\n        int tn=min(n,ll(41));\n        int half=min(tn/2,20);\n        vector<ll> vec(1<<half);\n        for(int i=0;i<(1<<half);i++){\n            ll val=0;\n            for(int j=0;j<half;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,j)+q*powi(b,j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            vec[i]=val;\n\n        }\n        int rest=tn-half;\n        vector<int> s(1<<rest);\n        for(int i=0;i<(1<<rest);i++){\n            ll val=0;\n            for(int j=0;j<rest;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,half+j)+q*powi(b,half+j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            s[i]=val;\n        }\n        ll2 res=m;\n        for(int i=0;i<vec.size();i++){\n            auto it=lower_bound(s.begin(),s.end(),m-vec[i]);\n            if(it!=s.end()){\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n            if(it!=s.begin()){\n                it--;\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n        }\n        cout<<res<<endl;\n    }\n    else{\n        if((p+q)*n>=m){\n            cout<<ll2(min(m%(p+q),(p+q)-m%(p+q)))<<endl;\n        }\n        else{\n            cout<<ll2(m-(p+q)*n)<<endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\nusing namespace std;\n\nlong long vals[50];\nlong long N;\nlong long M;\n\nlong long dfs(int id,int toTake,int taken,long long curVal,bool flg){\n//\tprintf(\"%d %d %d %lld\\n\",id,toTake,taken,curVal);\n\tif(id==-1){\n\t\tif(taken==toTake) return curVal;\n\t\telse return -1;\n\t}\n\tif(toTake==taken){\n\t\treturn curVal;\n\t}\n\tlong long nxtVal=curVal+vals[id];\n//\tprintf(\"nxt=%lld\\n\",nxtVal);\n\tlong long res=-1;\n\tif(nxtVal>M){\n\t\tres=dfs(id-1,toTake,taken,curVal,flg);\n\t\treturn res;\n\t}\n\tif(flg==false){\n\t\t//not take\n\t\tres=dfs(id-1,toTake,taken,curVal,true);\n\t}\n\tlong long res2=dfs(id-1,toTake,taken+1,nxtVal,flg);\n\tres=max(res,res2);\n\treturn res;\n}\n\nlong long dfs2(int id,int toTake,int taken,long long curVal){\n\tif(id==-1){\n\t\tif(toTake!=taken) return -1;\n\t\treturn curVal;\n\t}\n\tlong long nxtVal=curVal+vals[id];\n\tif(toTake==taken+id+1){\n\t\tlong long tmp=dfs2(id-1,toTake,taken+1,nxtVal);\n\t\treturn tmp;\n\t}\n\tlong long notTake=curVal;\n\tfor(int i=1;i<=toTake-taken;i++){\n\t\tnotTake+=vals[id-i];\n\t}\n\tlong long res;\n\tif(notTake>=M){\n\t\tres=dfs2(id-1,toTake,taken,curVal);\n\t}else{\n\t\tres=dfs2(id-1,toTake,taken+1,nxtVal);\n\t}\n\treturn res;\n}\n\nlong long mult(long long a,long long b,long long c){\n\tlong long x=c/a;\n\tif(b>x) return -1;\n\tlong long res=a*b;\n\tif(res>c) return -1;\n\treturn res;\n}\n\nint main(){\n\tlong long a,b,p,q;\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&N,&M,&a,&b,&p,&q);\n\tif(a==1&&b==1){\n\t\tlong long x=p+q;\n\t\tlong long num=M/x;\n\t\tnum=min(num,N);\n\t\tlong long train=x*num;\n\t\tlong long ans=M-train;\n\t\tif(num+1<=N){\n\t\t\ttrain+=x;\n\t\t\tans=min(ans,train-M);\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t\treturn 0;\n\t}\n\tlong long pa=1,pb=1;\n\tint n=0;\n\tfor(int i=0;i<N;i++){\n\t\tlong long cur1=mult(pa,p,M);\n\t\tlong long cur2=mult(pb,q,M);\n\t\tif(cur1==-1||cur2==-1) break;\n\t\tlong long cur=cur1+cur2;\n\t\tif(cur>M*2) break;\n\t\tvals[n++]=cur;\n\t\tpa=mult(pa,a,M*2);\n\t\tpb=mult(pb,b,M*2);\n\t\tif(pa==-1||pb==-1) break;\n\t}\n\tif(n==0){\n\t\tprintf(\"%lld\\n\",M);\n\t\treturn 0;\n\t}\n//\tfor(int i=0;i<n;i++){\n//\t\tprintf(\"%d %lld\\n\",i,vals[i]);\n//\t}\n\tN=n;\n\tlong long ans=M;\n\tfor(int i=1;i<=n;i++){\n\t\tlong long tmp=dfs(n-1,i,0,0,false);\n//\t\tprintf(\"%d %lld\\n\",i,tmp);\n\t\tif(tmp==-1) continue;\n\t\tans=min(ans,M-tmp);\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tlong long tmp=dfs2(n-1,i,0,0);\n\t\tif(tmp==-1) continue;\n\t\tans=min(ans,tmp-M);\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\tll n,m,a,b,p,q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\t\n\tif(a == 1 && b == 1){\n\t\tll x = m/(p+q);\n\t\tif(x >= n)cout << m-n*(p+q) << endl;\n\t\telse cout << min ( m-x*(p+q) , (x+1)*(p+q)-m ) << endl;\n\t}\n\telse {\n\t\tvector<ll> vec;\n\t\tll s = 1 , t = 1;\n\t\tfor(int i = 0 ; i < n ; i ++){\n\t\t\tvec.push_back(p*s+q*t);\n\t\t\tif(p*s+q*t > m)break;\n\t\t\ts *= a;\n\t\t\tt *= b;\n\t\t}\n\t\tint N = vec.size();\n\t\tvector<ll> A,B;\n\t\tA.push_back(0);\n\t\tfor(int i = 0 ; i < N/2 ; i ++){\n\t\t\tint x = A.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tA.push_back(vec[i]+A[j]);\n\t\t\t}\n\t\t}\n\t\tB.push_back(0);\n\t\tfor(int i = N/2 ; i < N ; i ++){\n\t\t\tint x = B.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tB.push_back(vec[i]+B[j]);\n\t\t\t}\n\t\t}\n\t\tsort(B.begin(),B.end());\n\t\tB.erase(unique(B.begin(),B.end()),B.end());\n\t\tll ret = m;\n\t\tfor(int i = 0 ; i < A.size() ; i ++){\n\t\t\tint x = upper_bound(B.begin(),B.end(),m-A[i])-B.begin();\n\t\t\tif(x < B.size())ret = min ( ret , A[i]+B[x]-m );\n\t\t\tx --;\n\t\t\tret = min ( ret , m-A[i]-B[x] );\n\t\t}\n\t\tcout << ret << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint main(){\n  long long int n, m, a, b, p, q, ans;\n  cin >> n >> m >> a >> b >> p >> q;\n  if(a < b){\n    swap(a, b);\n    swap(p, q);\n  }\n  if(a == 1){\n    if(m/(p + q) > n) cout << m - n*(p + q) << endl;\n    else{\n      long long int t = m - m/(p + q)*(p + q);\n      cout << min(t, p + q - t) << endl;\n    }\n    return 0;\n  }\n  ans = m;\n  long long int x = 1, y = 1;\n  for(int i = 1; i < n; ++i){\n    if(m <= p*x + q*y) break;\n    x *= a;\n    y *= b;\n  }\n  while(x > 0){\n    ans = min(ans, abs(m - (p*x + q*y)));\n    if(m >= p*x + q*y) m -= p*x + q*y;\n    x /= a;\n    y /= b;\n  }\n  cout << ans << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<deque>\n#include<queue>\n#include<vector>\n#include<algorithm>\n#include<iostream>\n#include<set>\n#include<cmath>\n#include<tuple>\n#include<string>\n#include<chrono>\n#include<functional>\n#include<iterator>\n#include<random>\n#include<unordered_set>\n#include<array>\n#include<map>\n#include<iomanip>\n#include<assert.h>\n#include<list>\n#include<bitset>\n#include<stack>\n#include<memory>\n#include<numeric>\nusing namespace std;\nusing namespace std::chrono;\ntypedef long long int llint;\ntypedef long double lldo;\n#define mp make_pair\n#define mt make_tuple\n#define pub push_back\n#define puf push_front\n#define pob pop_back\n#define pof pop_front\n#define fir first\n#define sec second\n#define res resize\n#define ins insert\n#define era erase\n/*cout<<fixed<<setprecision(20);cin.tie(0);ios::sync_with_stdio(false);*/\nconst llint mod=1000000007 ;\nconst llint big=2.19e15+1;\nconst long double pai=3.141592653589793238462643383279502884197;\nconst long double eps=1e-10;\nconst long double epsA=1e-4;\ntemplate <class T,class U>bool mineq(T& a,U b){if(a>b){a=b;return true;}return false;}\ntemplate <class T,class U>bool maxeq(T& a,U b){if(a<b){a=b;return true;}return false;}\nllint gcd(llint a,llint b){if(a%b==0){return b;}else return gcd(b,a%b);}\nllint lcm(llint a,llint b){if(a==0){return b;}return a/gcd(a,b)*b;}\ntemplate<class T> void SO(T& ve){sort(ve.begin(),ve.end());}\ntemplate<class T> void REV(T& ve){reverse(ve.begin(),ve.end());}\ntemplate<class T>llint LBI(const vector<T>&ar,T in){return lower_bound(ar.begin(),ar.end(),in)-ar.begin();}\ntemplate<class T>llint UBI(const vector<T>&ar,T in){return upper_bound(ar.begin(),ar.end(),in)-ar.begin();}\nint main(void){\n\t//ウサギは進みすぎた後徒歩で戻ってもいいんか\n\t//いったんすべてを決定した後、キャンセルする手法\n\tllint n,m,a,b,p,q,i;cin>>n>>m>>a>>b>>p>>q;\n\tllint ans=m;\n\tif(a>b){swap(p,q);swap(a,b);}\n\t\n\tif(a==1&&b==1){\n\t\tllint f=min(n,m/(p+q));\n\t\tllint fx=min(n,m/(p+q)+1);\n\t\tcout<<min(m-f*(p+q),abs(m-fx*(p+q)))<<endl;\n\t}else{\n\t\t//とりあえずnをfixする\n\t\tllint pg=p,qg=q,aa=0;\n\t\twhile(pg+qg<=m*3){\n\t\t\taa++;\n\t\t\tif(1.0*pg*a+1.0*qg*b>m*4){break;}//オーバーフロー危ない！\n\t\t\tpg*=a;qg*=b;\n\t\t}\n\t\tmineq(n,aa);\n\t\t//cerr<<\"n=\"<<n<<endl;\n\t\tif(a==1){\n\t\t\t//cerr<<\"a\"<<endl;\n\t\t\t//合計枚数を固定して、そこから求める\n\t\t\tllint mai[80];\n\t\t\tqg=q;\n\t\t\tllint wa=0;\n\t\t\tfor(i=0;i<n;i++){mai[i]=qg;wa+=mai[i];qg*=b;}\n\t\t\twa+=n*p;\n\t\t\tfor(int h=0;h<=n;h++){\n\t\t\t\t//枚数を固定する\n\t\t\t\tllint gen=m-h*p;\n\t\t\t\tfor(i=0;i<h;i++){gen-=mai[i];}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t//maiでうまく貪欲法\n\t\t\t\tllint rest=h;\n\t\t\t\tfor(i=n-1;i>=0;i--){\n\t\t\t\t\tif(rest<=0){break;}\n\t\t\t\t\tif(i<rest){break;}\n\t\t\t\t\tif(gen>=mai[i]-mai[rest-1]){gen-=mai[i]-mai[rest-1];rest--;}\n\t\t\t\t}\n\t\t\t\tmineq(ans,abs(gen));\n\t\t\t\t\n\t\t\t\tgen=wa-(m-h*p);\n\t\t\t\tfor(i=0;i<h;i++){gen-=mai[i];}\n\t\t\t\tif(gen<0){continue;}\n\t\t\t\t//maiでうまく貪欲法\n\t\t\t\trest=h;\n\t\t\t\tfor(i=n-1;i>=0;i--){\n\t\t\t\t\tif(rest<=0){break;}\n\t\t\t\t\tif(i<rest){break;}\n\t\t\t\t\tif(gen>=mai[i]-mai[rest-1]){gen-=mai[i]-mai[rest-1];rest--;}\n\t\t\t\t}\n\t\t\t\tmineq(ans,abs(gen));\n\t\t\t\t\n\t\t\t}\n\t\t\tcout<<ans<<endl;\n\t\t}else{\n\t\t\tllint mai[80];\n\t\t\tqg=q;pg=p;\n\t\t\tllint wa=0;\n\t\t\tfor(i=0;i<n;i++){mai[i]=qg+pg;wa+=mai[i];pg*=a;qg*=b;}\n\t\t\tllint gen=m;\n\t\t\tfor(i=n-1;i>=0;i--){\n\t\t\t\t//cerr<<\"gen=\"<<gen<<endl;\n\t\t\t\tif(gen>=mai[i]){gen-=mai[i];}\n\t\t\t}\n\t\t\tmineq(ans,abs(gen));\n\t\t\tgen=wa-m;\n\t\t\tfor(i=n-1;i>=0;i--){\n\t\t\t\t//cerr<<\"gen=\"<<gen<<endl;\n\t\t\t\tif(gen>=mai[i]){gen-=mai[i];}\n\t\t\t}\n\t\t\tmineq(ans,abs(gen));\n\t\t\tcout<<ans<<endl;\n\t\t}\n\t}\n\treturn 0;\n}\n/*\n1 2 4 8 16\n10000000000\n*/\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 1LL<<60;\nll n,m,a,b,p,q;\n\nll calc(ll k){\n  ll A = 1,B = 1;\n  while(A<INF&&B<INF&&k--)A*=a,B*=b;\n  if(A>=INF||B>=INF) return -1;\n  return p*A+q*B;\n}\n\n\nll ans = INF;\ntypedef pair<ll,ll> P;\nset<P> used;\nvoid dfs(ll pos,ll sum){\n  assert(sum>=0);\n  if(pos>=n||sum<0LL||sum>INF) return;\n  if(used.count(P(pos,sum))) return ;\n  used.insert(P(pos,sum));\n  ans = min(ans,(ll)abs(m-sum));\n  \n  ll r = calc(pos);\n  if(r<=0) return;\n  dfs(pos+1,sum+r);  \n  dfs(pos+1,sum);\n}\n\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  if(max(a,b)==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - (p+q));\n    if(m/(p+q)==n) t = INF;\n    if(m/(p+q)<=n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n  }\n\n  dfs(0,0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint main(){\n  long long int n, m, a, b, p, q, ans;\n  cin >> n >> m >> a >> b >> p >> q;\n  if(a < b){\n    swap(a, b);\n    swap(p, q);\n  }\n  if(a == 1LL){\n    if(m/(p + q) >= n) cout << m - n*(p + q) << endl;\n    else{\n      long long int t = m - m/(p + q)*(p + q);\n      cout << min(t, p + q - t) << endl;\n    }\n    return 0;\n  }\n  ans = m;\n  long long int x = 1LL, y = 1LL;\n  for(int i = 1; i < n; ++i){\n    if(m <= p*x + q*y) break;\n    if(x > (1LL<<40)/a || y > (1LL<<40)/b) break;\n    x *= a;\n    y *= b;\n  }\n\n  while(x > 0){\n    ans = min(ans, abs(m - (p*x + q*y)));\n    if(m >= p*x + q*y) m -= p*x + q*y;\n    x /= a;\n    y /= b;\n  }\n  cout << ans << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 1LL<<45;\nll Sum[100],n,m,a,b,p,q;\n\nll calc(ll k){\n  ll A = 1,B = 1,res=p+q;\n  while(res>0&&res<=INF&&k--)A*=a,B*=b,res=p*A+q*B;\n  if(res<0) res = INF;\n  return min(INF,res);\n}\n\nll ans = INF;\nset<ll> used[101];\nvoid dfs(ll pos,ll sum){\n  ans = min(ans,(ll)abs(m-sum));\n  if(m<sum||pos==-1||sum>INF||used[pos].count(sum)) return;\n  used[pos].insert(sum);\n  \n  if(Sum[pos]+sum<m){ans=min(ans,m-(Sum[pos]+sum));return;}\n  dfs(pos-1,sum+calc(pos));  \n  dfs(pos-1,sum);\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  Sum[0] = calc(0);\n  for(int i=1;i<60;i++)Sum[i]=min(INF,calc(i)+Sum[i-1]);\n\n  if(max(a,b)==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - (p+q));\n    if(m/(p+q)==n) t = INF;\n    if(m/(p+q)<=n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n  }\n  dfs(min(n-1,50LL),0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return m%d;\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n  if(n>40)n=40;\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-1;j<=index+1;j++){\n      if(0<=j && j<(int)U.size()){\n        ll c=T[i]+U[j];\n        if(c<=m)res=min( res, m-c );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll _pow(ll a, ll n) {\n\tif(n == 0) return 1;\n\telse {\n\t\tll res = 1;\n\t\tll buf = a;\n\t\twhile(n > 0) {\n\t\t\tif(n % 2 == 1) {\n\t\t\t\tres *= buf;\n\t\t\t}\n\t\t\tbuf *= buf;\n\t\t\tn /= 2;\n\t\t}\n\t\treturn res;\n\t}\n}\n\nvoid solve() {\n\tll n, m, a, b, p, q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\tif(n == 1) {\n\t\tif(p + q > m) cout << m << endl;\n\t\telse cout << m - (p + q) << endl;\n\t\treturn;\n\t}\n\tll c = max(a, b);\n\tif(c == 1) {\n\t\tif((p + q) * n > m) {\n\t\t\tcout << min(m - m / (p + q) * (p + q), m - (m / (p + q) + 1) * (p + q))<< endl;\n\t\t} else cout << m - (p + q) * n << endl;\n\t} else if(c == 2 || c == 3) {\n\t\tll _n = 0;\n\t\tif(c == 2) _n = min(41LL, n);\n\t\tif(c == 3) _n = min(29LL, n);\n\t\tll div1 = _n / 2;\n\t\tll div2 = _n - div1;\n\t\tvector<ll> d1;\n\t\tvector<ll> d2;\n\t\tREP(bit, (1ll << div1)) {\n\t\t\tbitset<31> bi(bit);\n\t\t\tll sum = 0;\n\t\t\tREP(i, div1) if(bi[i]) sum += p * _pow(a, i) + q * _pow(b, i);\n\t\t\td1.pb(sum);\n\t\t}\n\t\tREP(bit, (1ll << div2)) {\n\t\t\tbitset<31> bi(bit);\n\t\t\tll sum = 0;\n\t\t\tREP(i, div2) if(bi[i]) sum += p * _pow(a, div1 + i) + q * _pow(b, div1 + i);\n\t\t\td2.pb(sum);\n\t\t}\n\t\tsort(ALL(d1));\n\t\tsort(ALL(d2));\n\t\tll ans = m;\n\t\tREP(i, d1.size()) {\n\t\t\tauto ite = upper_bound(ALL(d2), m - d1[i]);\n\t\t\tif(ite != d2.end()) ans = min(ans, (d1[i] + *ite) - m);\n\t\t\tif(ite == d2.begin()) continue;\n\t\t\tite--;\n\t\t\tans = min(ans, m - (d1[i] + *ite));\n\t\t}\n\t\tcout << ans << endl;\n\t} else /* c >= 4 */ {\n\t\tvector<ll> num;\n\t\tnum.pb(0);\n\t\tnum.pb(p + q);\n\t\tREP(i, min(23LL, n - 1)) {\n\t\t\tif(1000000000007LL / (ld)_pow(c, i) < c) break;\n\t\t\tll val = p * _pow(a, i + 1) + q * _pow(b, i + 1); \n\t\t\tvector<ll> nnum = num;\n\t\t\tREP(j, num.size()) nnum.pb(num[j] + val);\n\t\t\tnum = nnum;\n\t\t}\n\t\tUNIQUE(num);\n\t\tll ans = INF*INF;\n\t\tREP(i, num.size()) ans = min(ans, abs(m - num[i]));\n\t\tcout << ans << endl;\n\t}\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tsolve();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <vector>\n#include <algorithm>\n\n#define rep(i,n) for(int i = 0; i < n; ++i)\nusing namespace std;\n\nusing ll = long long;\nusing R = long double;\n\nint main(void){\n\tll n,m,a,b,p,q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\n\tif(a == 1 and b == 1){\n\t\tll ticket = p + q;\n\t\tconst ll used = min(n,m/ticket);\n\t\tll ans = abs(m - ticket * used);\n\t\tif(used+1<=n) ans = min(ans,abs(m - ticket * (used+1)));\n\t\tcout << ans << endl;\n\t\treturn 0;\n\t}\n\n\tvector<ll> ticket;\n\tn = min(n,40LL);\n\n\trep(i,n){\n\t\tll cur = p * pow<ll>(a,i) + q * pow<ll>(b,i);\n\t\tif(1.0 * p * pow<R>(a,i) + 1.0 * q * pow<R>(b,i) > 1e18) break;\n\t\tticket.push_back(cur);\n\t\tif(cur > m) break;\n\t}\n\n\tn = ticket.size();\n\n\tvector<ll> item[2];\n\tconst ll half[2] = {n/2,n-n/2};\n\tconst ll offset[2] = {0,n/2};\n\n\trep(k,2)rep(mask,1 << half[k]){\n\t\tll cur = 0LL;\n\t\trep(i,half[k]) if(mask & (1 << i)) cur += ticket[i+offset[k]];\n\t\titem[k].push_back(cur);\n\t}\n\n\t\n\tll ans = m;\n\tsort(begin(item[1]),end(item[1]));\n\t\n\tfor(auto &it:item[0]){\n\t\tconst ll arg = m - it;\n\t\tauto it2 = upper_bound(begin(item[1]),end(item[1]),arg);\n\n\t\tif(it2 != end(item[1])) ans = min(ans, abs(m - it - *it2));\n\t\tit2--;\n\t\tans = min(ans, m - it - *it2);\n\t}\n\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  ll MAX=1000000000000LL;\n  \n  assert( 1<= n &&n <= MAX );\n  assert( 1<= m &&m <= MAX );\n  assert( 1<= a &&a <= MAX );\n  assert( 1<= b &&b <= MAX );\n  assert( 1<= p &&p <= MAX );\n  assert( 1<= q &&q <= MAX );\n  \n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    //    if(total <= m)return m-total;\n    return m%d);\n    \n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n    if( i==40 )break;\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        ll c=T[i]+U[j];\n        res=min( res,  abs(m-c) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s, B;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\n\tif (a >= 1000000000 && b >= 1000000000) {\n\t\tif (p >= 1000000000 && q >= 1000000000) {\n\t\t\tcout << m - p - q << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << min(m - p - q, abs(m - a * p + b * q)) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\n\tif (a == 1 && b == 1) {\n\t\tif (n >= 1000001 && (p + q) >= 1000001) { goto F; }\n\t\tif (m <= n * (p + q)) {\n\t\tF:;\n\t\t\tB = m % (p + q);\n\t\t\tif (B > (p + q) / 2) {\n\t\t\t\tB = (p + q) - B;\n\t\t\t}\n\t\t\tcout << B << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << m - (long long)(n * (p + q)) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = m;\n\td = s;\nE:;\n\trem = m - c[d - 1];\n\tminx = min(minx, abs(rem));\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    assert(0);\n    \n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return min( m%d , m-m%d);\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n  if(n>40){\n    assert(0);\n  }\n  \n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        res=min( res, abs( m- ( T[i]+U[j] )) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nbool ch(int a,int b){\n  int x=1000000000000000LL;\n  x/=a;\n  x/=b;\n  return x==0;\n}\nsigned main(){\n  int n,m,a,b,p,q;\n  cin>>n>>m>>a>>b>>p>>q;\n  if(a==1&&b==1){\n    if(ch(n,p+q)) cout<<m%(p+q)<<endl;\n    else{\n      int t=n*(p+q);\n      if(m>=t) cout<<m-t<<endl;\n      else cout<<m%(p+q)<<endl;\n    }\n    return 0;\n  }\n  int ta=1,tb=1;\n  vector<int> v;\n  for(int i=0;i<n;i++){\n    if(ch(p,ta)) break;\n    if(ch(q,tb)) break;\n    int t=p*ta+q*tb;\n    if(t<=m) v.push_back(t);\n    else break;\n    //cout<<t<<endl;\n    if(ch(ta,a)) break;\n    if(ch(tb,b)) break;\n    ta*=a;tb*=b;\n  }\n  int x=v.size();\n  int y=x/2;\n  if(x==1){\n    cout<<m-v[0]<<endl;\n    return 0;\n  }\n  set<int> s;\n  for(int i=0;i<(1<<y);i++){\n    int t=0;\n    for(int j=0;j<y;j++) if((i>>j)&1) t+=v[j];\n    if(t>m) continue;\n    //cout<<t<<endl;\n    s.insert(-t);\n  }\n  int ans=m;\n  for(int i=0;i<(1<<(x-y));i++){\n    int t=0;\n    for(int j=0;j<(x-y);j++) if((i>>j)&1) t+=v[y+j];\n    if(t>m) continue;\n    //cout<<t<<endl;\n    int u=t-m;\n    int k=*lower_bound(s.begin(),s.end(),u);\n    ans=min(ans,m-(t-k));\n  }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <queue>\n#define REP(i,n) for(int i=0; i<(int)(n); i++)\n\ntypedef long long ll;\n\nusing namespace std;\n\nconst ll inf = 1ll << 60;\n\nll mult(ll a, ll b){\n  if(inf / a < b) throw 0;\n  return a * b;\n}\n\nint main(){\n  ll n, m, a, b, p, q;\n  cin >> n >> m >> a >> b >> p >> q;\n  if(a == 1 && b == 1){\n    cout << m / (p + q) << endl;\n    return 0;\n  }\n\n  if(n > 40) n = 40;\n\n  vector<ll> v;\n  ll aa = 1;\n  ll bb = 1;\n\n  try{\n    REP(i,n){\n      ll val = mult(p, aa) + mult(q, bb);\n      if(val <= inf) v.push_back(val);\n      else break;\n      aa = mult(aa, a);\n      bb = mult(bb, b);\n    }\n  }catch(int n){}\n\n  vector<ll> as;\n  vector<ll> bs;\n\n  n = v.size();\n\n  REP(i,1<<(n/2)){\n    ll tmp = 0;\n    REP(j,n/2) if(i & (1 << j)) tmp += v[j];\n    as.push_back(tmp);\n  }\n\n  REP(i,1<<(n/2 + n%2)){\n    ll tmp = 0;\n    REP(j,n/2 + n%2) if(i & (1 << j))\n      tmp += v[j + n / 2];\n    bs.push_back(tmp);\n  }\n\n  sort(as.begin(), as.end());\n  sort(bs.rbegin(), bs.rend());\n\n  size_t ai = 0, an = as.size() - 1;\n  size_t bi = 0, bn = bs.size() - 1;\n  ll ans = m;\n\n  while(ai < an || bi < an){\n    ll tmp = as[ai] + bs[bi];\n    ans = min(ans, std::abs(m - tmp));\n    if(tmp > m){\n      if(bi != bn) bi++;\n      else ai++;\n    }else{\n      if(ai != bn) ai++;\n      else bi++;\n    }\n  }\n\n  cout << ans << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nsigned main(){\n\tint n,m,a,b,p,q,mi;\n\tvector<int> vec,num;\n\tcin >> n >> m >> a >> b >> p >> q;\n\tmi = m;\n\tif(a == 1 && b == 1){\n\t\tif((p + q) * n >= m) cout << min(m % (p + q),p + q - m % (p + q)) << endl;\n\t\telse cout << m - (p + q) * n << endl;\n\t\treturn 0;\n\t}\n\tint ta = p,tb = q;\n\tfor(int i = 0;i < n;i++){\n\t\tif(ta + tb > m) break;\n\t\tvec.push_back(ta + tb);\n\t\tif(ta > (m + a - 1) / a || tb > (m + b - 1) / b) break;\n\t\tta *= a;\n\t\ttb *= b;\n\t}\n\tn = vec.size();\n\tfor(int i = 0;i < (1 << (n / 2));i++){\n\t\tint sum = 0;\n\t\tfor(int j = 0;j < n / 2;j++){\n\t\t\tif((i >> j) & 1) sum += vec[j];\n\t\t}\n\t\tnum.push_back(sum);\n\t}\n\tsort(num.begin(),num.end());\n\tfor(int i = 0;i < (1 << ((n + 1) / 2));i++){\n\t\tint sum = 0;\n\t\tfor(int j = 0;j < (n + 1) / 2;j++){\n\t\t\tif((i >> j) & 1) sum += vec[j + n / 2];\n\t\t}\n\t\tint ind = upper_bound(num.begin(),num.end(),m - sum) - num.begin() - 1;\n\t\tif(ind >= 0) mi = min(mi,m - sum - num[ind]);\n\t\tif(ind + 1 < n) mi = min(mi,-(m - sum - num[ind + 1]));\n\t}\n\tcout << mi << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <vector>\n#define repeat(i, n) for (int i = 0; (i) < int(n); ++(i))\n#define repeat_from(i, m, n) for (int i = (m); (i) < int(n); ++(i))\n#define whole(f, x, ...) ([&](decltype((x)) whole) { return (f)(begin(whole), end(whole), ## __VA_ARGS__); })(x)\nusing ll = long long;\nusing namespace std;\ntemplate <class T> inline void setmin(T & a, T const & b) { a = min(a, b); }\n\nll solve(ll n, ll m, ll a, ll b, ll p, ll q) {\n    if (a == 1 and b == 1) {\n        ll delta = p + q;\n        ll result = m;\n        setmin(result, m - min(n,  m              / delta) * delta);\n        setmin(result, m - min(n, (m + delta - 1) / delta) * delta);\n        return result;\n    }\n    vector<ll> tickets;\n    repeat (k, n) {\n        double estimated = p * pow(a, k) + q * pow(b, k);\n        if (2 * m + 3 < estimated) break;\n        ll ticket = estimated;\n        tickets.push_back(ticket);\n    }\n    if (tickets.empty()) {\n        return m;\n    } else if (tickets.size() == 1) {\n        return min(m, abs(m - tickets[0]));\n    }\n    auto generate = [&](int l, int r) {\n        vector<ll> acc;\n        acc.push_back(0);\n        repeat_from (k, l, r) {\n            ll ticket = tickets[k];\n            int prev_size = acc.size();\n            repeat (i, prev_size) {\n                acc.push_back(acc[i] + ticket);\n            }\n            whole(sort, acc);\n            acc.erase(whole(unique, acc), acc.end());\n        }\n        return acc;\n    };\n    vector<ll> lower = generate(0, tickets.size() / 2);\n    vector<ll> upper = generate(tickets.size() / 2, tickets.size());\n    ll result = m;\n    for (ll x : lower) {\n        int i = whole(lower_bound, upper, m - x) - upper.begin();\n        repeat_from (j, max(0, i - 3), min<int>(upper.size(), i + 3)) {\n            ll y = upper[j];\n            setmin(result, abs(m - (x + y)));\n        }\n    }\n    return result;\n}\n\nint main() {\n    ll n, m, a, b, p, q; scanf(\"%lld%lld%lld%lld%lld%lld\", &n, &m, &a, &b, &p, &q);\n    ll result = solve(n, m, a, b, p, q);\n    printf(\"%lld\\n\", result);\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 1LL<<53;\nll Sum[100];\nll n,m,a,b,p,q;\n\n\nll calc(ll k){\n  static ll used[101]={},mem[101]={};\n  if(used[k]++) return mem[k];\n  ll A = 1,B = 1;\n  ll &res =mem[k]=p+q;\n  while(0<res&&res<=INF&&k--)A*=a,B*=b,res=p*A+q*B;\n  if(res<0||res>INF)res=INF;\n  return res;\n}\n\n\nll ans = INF;\nset<ll> used[101];\nvoid dfs(ll pos,ll sum){\n  if(sum<0LL||sum>INF) return;\n  ans = min(ans,(ll)abs(m-sum));\n  if(pos==-1)return;\n  if(Sum[pos]+sum<m){ans=min(ans,m-(Sum[pos]+sum));return;}\n  if(m<sum) return;\n  if(used[pos].count(sum)) return ;\n  used[pos].insert(sum);\n  \n  ll r = calc(pos);\n  if(r<INF)dfs(pos-1,sum+r);  \n  dfs(pos-1,sum);\n}\n\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  for(int i=0;i<60;i++) Sum[i] = INF;\n  Sum[0] = calc(0);\n  for(int i=1;i<60;i++)Sum[i]=min(INF,calc(i)+Sum[i-1]);\n\n  if(max(a,b)==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - (p+q));\n    if(m/(p+q)==n) t = INF;\n    if(m/(p+q)<=n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n  }\n  \n  dfs(min(n-1,50LL),0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  ll MAX=1000000000000LL;\n  \n  assert( 1<= n &&n <= MAX );\n  assert( 1<= m &&m <= MAX );\n  assert( 1<= a &&a <= MAX );\n  assert( 1<= b &&b <= MAX );\n  assert( 1<= p &&p <= MAX );\n  assert( 1<= q &&q <= MAX );\n  \n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=d*n;\n\n\n    if(total <= m)return m-total;\n    \n    return min(m%d,m-m%d);\n    \n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n    if( i==40 )break;\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        ll c=T[i]+U[j];\n        res=min( res,  abs(m-c) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb push_back\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\ntypedef vector<int>vint;\ntypedef pair<int,int>pint;\ntypedef vector<pint>vpint;\n\ntemplate<typename A,typename B>inline void chmin(A &a,B b){if(a>b)a=b;}\ntemplate<typename A,typename B>inline void chmax(A &a,B b){if(a<b)a=b;}\n\nint N,M,A,B,P,Q;\n\nint ans;\n\nvoid dfs(int n,int s,int x,int y){\n    if(n==0)return;\n    chmin(ans,abs(M-s));\n    if(1.0*x*A>1e18||1.0*y*B>1e18)return;\n    dfs(n-1,s+x*A+y*B,x*A,y*B);\n    dfs(n-1,s,x*A,y*B);\n}\n\nvoid dfs2(int n,int f,int s,int m){\n    if(n==0){\n        chmin(ans,abs(s-m));\n        return;\n    }\n    if(n-1>=f)dfs2(n-1,f,s,m);\n    if(f&&(s<=m||n==f)){\n        dfs2(n-1,f-1,s+Q*(1ll<<(n-1)),m);\n    }\n}\nsigned main(){\n    cin>>N>>M>>A>>B>>P>>Q;\n\n    if(A>B){\n        swap(A,B);swap(P,Q);\n    }\n\n    ans=M;\n    dfs(min(N,26ll),0,P,Q);\n    dfs(min(N,26ll),P+Q,P,Q);\n\n    if(B==1){\n        P+=Q;\n        int x=M/P*P;\n        chmin(ans,abs(M-x));\n        chmin(ans,abs(M-(x+P)));\n    }\n    else if(A==1&&B==2){\n        int t=1;\n        while(Q*(1ll<<t)<1e15)t++;\n        chmin(t,N);\n        for(int i=1;i<=t;i++){\n            dfs2(t,i,0,M-i*P);\n        }\n    }\n    else if(B==2){\n        P+=Q;\n        int x=M/P*P;\n        if(N>50||M/P<(1ll<<N)){\n            chmin(ans,abs(M-x));\n        }\n        if(N>50||M/P+1<(1ll<<N)){\n            chmin(ans,abs(M-(x+P)));\n        }\n    }\n    cout<<ans<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint main(){\n  long long int n, m, a, b, p, q, ans;\n  cin >> n >> m >> a >> b >> p >> q;\n  if(a < b){\n    swap(a, b);\n    swap(p, q);\n  }\n  if(a == 1LL){\n    if(m/(p + q) >= n) cout << m - n*(p + q) << endl;\n    else{\n      long long int t = m - m/(p + q)*(p + q);\n      cout << min(t, p + q - t) << endl;\n    }\n    return 0;\n  }\n  ans = m;\n  long long int x = 1LL, y = 1LL;\n  for(int i = 1; i < n; ++i){\n    if(x*a < 0 || y*b < 0) break;\n    if(m <= p*x + q*y) break;\n    x *= a;\n    y *= b;\n  }\n\n  while(x > 0){\n    ans = min(ans, abs(m - (p*x + q*y)));\n    if(m >= p*x + q*y) m -= p*x + q*y;\n    x /= a;\n    y /= b;\n  }\n  cout << ans << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint main(){\n  long long int n, m, a, b, p, q, ans;\n  cin >> n >> m >> a >> b >> p >> q;\n  if(a < b){\n    swap(a, b);\n    swap(p, q);\n  }\n  if(a == 1){\n    if(n < m/2) cout << m - n*2 << endl;\n    else cout << m%2 << endl;\n    return 0;\n  }\n  ans = m;\n  long long int x = 1, y = 1;\n  while(p*x + q*y < m) x *= a, y *= b;\n  ans = min(ans, p*x + q*y);\n  while(x > 0){\n    x /= a;\n    y /= b;\n    ans = min(ans, abs(m - (p*x + q*y)));\n    if(m > p*x + q*y) m -= p*x + q*y;\n  }\n  cout << ans << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nsigned main(){\n\tint n,m,a,b,p,q,mi;\n\tvector<int> vec,num;\n\tcin >> n >> m >> a >> b >> p >> q;\n\tmi = m;\n\tif(a == 1 && b == 1){\n\t\tif((p + q) * n >= m) cout << m % (p + q) << endl;\n\t\telse cout << m - (p + q) * n << endl;\n\t\treturn 0;\n\t}\n\tint ta = p,tb = q;\n\tfor(int i = 0;i < n;i++){\n\t\tif(ta + tb > m) break;\n\t\tvec.push_back(ta + tb);\n\t\tif(ta > (m + a - 1) / a || tb > (m + b - 1) / b) break;\n\t\tta *= a;\n\t\ttb *= b;\n\t}\n\tn = vec.size();\n\tfor(int i = 0;i < (1 << (n / 2));i++){\n\t\tint sum = 0;\n\t\tfor(int j = 0;j < n / 2;j++){\n\t\t\tif((i >> j) & 1) sum += vec[j];\n\t\t}\n\t\tnum.push_back(sum);\n\t}\n\tsort(num.begin(),num.end());\n\tfor(int i = 0;i < (1 << ((n + 1) / 2));i++){\n\t\tint sum = 0;\n\t\tfor(int j = 0;j < (n + 1) / 2;j++){\n\t\t\tif((i >> j) & 1) sum += vec[j + n / 2];\n\t\t}\n\t\tint ind = upper_bound(num.begin(),num.end(),m - sum) - num.begin() - 1;\n\t\tif(ind >= 0) mi = min(mi,m - sum - num[ind]);\n\t\tif(ind + 1 < n) mi = min(mi,-(m - sum - num[ind + 1]));\n\t}\n\tcout << mi << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll, ll> l_l;\ntypedef pair<int, int> i_i;\n\ntemplate <typename T>\nbool chmax(T &a, T b) {\n    if(a < b) {\n        a = b;\n        return true;\n    }\n    return false;\n}\n\ntemplate <typename T>\nbool chmin(T &a, T b) {\n    if(a > b) {\n        a = b;\n        return true;\n    }\n    return false;\n}\n\n#define EPS (1e-7)\n#define INF (1e9)\n#define PI (acos(-1))\n//const ll mod = 1000000007;\nll n, m, a, b, p, q;\nll ans = 1e18;\n\nvoid solve1() {\n    ll timer = m / (p + q);\n    chmin(timer, n);\n    chmin(ans, abs(m - timer * (p+q)));\n    timer++;\n    chmin(timer, n);\n    chmin(ans, abs(m - timer * (p+q)));\n    return;\n}\n\nvoid solve2() {\n    ll Mindex = 0;\n    ll pak = p;\n    ll qbk = q;\n    for(ll i = 1; i < n; i++) {\n        if(pak > 1e15 / a) break;\n        if(qbk > 1e15 / b) break;\n        chmax(Mindex, i);\n        pak *= a;\n        qbk *= b;\n    }\n    ll rest = m;\n    while(Mindex >= 0) {\n        //cerr << Mindex << \" \" << rest << \" \" << pak << \" \" << qbk << endl;\n        chmin(ans, abs(rest - pak - qbk));\n        if(rest - pak - qbk >= 0) {\n            rest -= pak + qbk;\n            chmin(ans, rest);\n        }\n        pak /= a;\n        qbk /= b;\n        Mindex--;\n    }\n}\n\nvoid solve3() {\n    ll Mindex = 0;\n    ll qbk = q;\n    for(ll i = 1; i < n; i++) {\n        if(qbk > 1e15 / b) break;\n        chmax(Mindex, i);\n        qbk *= b;\n    }\n    for(int num = 1; num <= Mindex + 1; num++) {\n        ll rest = m - num * p;\n        ll restnum = num;\n        ll nowqbk = qbk;\n        for(int j = Mindex; j >= 0; j--) {\n            if(j + 1 == restnum or (restnum >= 1 and rest - nowqbk >= 0)) {\n                rest -= nowqbk;\n                restnum--;\n            } else {\n                /*\n                ll nowrest = rest;\n                rest -= nowqbk;\n                ll nowrestnum = restnum - 1;\n                ll newqbk = q;\n                for(ll i = 0; i < nowrestnum; i++) {\n                    rest -= newqbk;\n                    newqbk *= b;\n                }\n                */\n                //chmin(ans, abs(nowrest));\n            }\n            nowqbk /= b;\n        }\n        chmin(ans, abs(rest));\n    }\n}\n\nint main() {\n    //cout.precision(10);\n    cin >> n >> m >> a >> b >> p >> q;\n    ans = m;\n    if(a == 1 and b == 1) {\n        solve1();\n    } else if(a != 1 and b != 1) {\n        solve2();\n    } else {\n        if(a != 1) {\n            swap(a, b);\n            swap(p, q);\n        }\n        solve3();\n    }\n    cout << ans << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\tll n,m,a,b,p,q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\t\n\tif(a == 1 && b == 1){\n\t\tcout << max( m%(p+q) , m-(p+q)*n ) << endl;\n\t}\n\telse {\n\t\tvector<ll> vec;\n\t\tll s = 1 , t = 1;\n\t\tfor(int i = 0 ; i < n ; i ++){\n\t\t\tif(p*s+q*t > m)break;\n\t\t\tvec.push_back(p*s+q*t);\n\t\t\ts *= a;\n\t\t\tt *= b;\n\t\t}\n\t\tint N = vec.size();\n\t\tvector<ll> A,B;\n\t\tA.push_back(0);\n\t\tfor(int i = 0 ; i < N/2 ; i ++){\n\t\t\tint x = A.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tA.push_back(vec[i]+A[j]);\n\t\t\t}\n\t\t}\n\t\tB.push_back(0);\n\t\tfor(int i = N/2 ; i < N ; i ++){\n\t\t\tint x = B.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tB.push_back(vec[i]+B[j]);\n\t\t\t}\n\t\t}\n\t\tsort(B.begin(),B.end());\n\t\tB.erase(unique(B.begin(),B.end()),B.end());\n\t\tll ret = m;\n\t\tfor(int i = 0 ; i < A.size() ; i ++){\n\t\t\tint x = upper_bound(B.begin(),B.end(),m-A[i])-B.begin();\n\t\t\tx --;\n\t\t\tret = min ( ret , m-A[i]-B[x] );\n\t\t}\n\t\tcout << ret << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <queue>\n#include <map>\n#include <set>\n#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <cassert>\nusing namespace std;\n\ntypedef long long ll;\n\n#define REP(i, n) for (ll i = 0; i < (ll)(n); ++i)\n#define FOR(i, a, b) for (ll i = (a); i < (ll)(b); ++i)\n#define FOREQ(i, a, b) for (ll i = (a); i <= (ll)(b); ++i)\n#define DEC(i, k) for (ll i = (k); i >= 0; --i)\n#define FORIT(i, c) for (__tyoeof((c).begin()) i = (c).begin(); i != (c).end(); ++i)\n#define SZ(v) (ll)((v).size())\n#define MEMSET(v, h) memset((v), (h), sizeof(v))\n#define FIND(m, w) ((m).find(w) != (m).end())\n#define ALL(c) (c).begin(), (c).end()\n\nll ticket[1000];\nll ticketSum[1000];\nll n, m, a, b, p, q;\nll cnt;\n\nll calc(ll depth, ll lm) {\n  if (depth == cnt || lm <= 0) { return abs(lm); }\n  if (ticketSum[depth] < lm) { return abs(lm - ticketSum[depth]); }\n  ll ret = m;\n  ret = min(ret, calc(depth + 1, lm));\n  ret = min(ret, calc(depth + 1, lm - ticket[depth]));\n  return ret;\n}\n\nint main() {\n  cin >> n >> m >> a >> b >> p >> q;\n  if (a == 1 && b == 1) {\n    ll use = m / (p + q);\n    use = min(use, n - 1);\n    printf(\"%lld\\n\", min(m - use * (p + q), abs(m - (use + 1) * (p + q))));\n    return 0;\n  }\n  cnt = 0;\n  {\n    ll left = p;\n    ll right = q;\n    REP(i, n) {\n      if (left + right > 2 * m) { break; }\n      ticket[cnt++] = left + right;\n      ll pleft = left;\n      ll pright = right;\n      left *= a;\n      right *= b;\n      if (left / a != pleft || right / b != pright) { break; }\n    }\n  }\n  reverse(ticket, ticket + cnt);\n  MEMSET(ticketSum, 0);\n  for (ll i = cnt; i > 0; i--) {\n    ticketSum[i - 1] = ticket[i - 1] + ticketSum[i];\n  }\n  ll ans = calc(0, m);\n  printf(\"%lld\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cassert>\n#include<climits>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\ntypedef long long ll;\n\nvector<ll> generate(vector<ll> a){\n  vector<ll> ret;\n  int n = a.size();\n  rep(i,(1<<n)){\n    ll tmp = 0;\n    rep(j,n){\n      if ((1<<j)&i)tmp += a[j];\n    }\n    ret.push_back(tmp);\n  }\n  sort(ret.begin(),ret.end());\n  return ret;\n}\n\nll bs(ll m,ll sum,vector<ll> &a,bool fg){\n  int ret = -1;\n  int l = 0,r = a.size()-1;\n  while(l <= r){\n    int mid = (l+r)/2;\n    ll tmp = sum + a[mid];\n    if (fg){\n      if (tmp <= m){//ä¸éããã£ã¨ä¸ããã\n\tret = mid;\n\tl = mid+1;\n      }else {\n\tr = mid-1;\n      }\n    }else {\n      if (tmp >= m){\n\tret = mid;\n\tr = mid-1;\n      }else {\n\tl = mid+1;\t\n      }\n    }\n  }\n\n  /*  cout <<\"dbg\" << endl;\n  rep(i,a.size())cout << a[i] <<\" \" ;cout << endl;\n  cout <<fg <<\" \" <<  m <<\" \" << sum <<\" \" << (ret != -1?a[ret]:-1) <<\" \" << \n    ((ret != -1)?sum+a[ret]:-1)\n       << endl;\n  */\n  if (ret == -1)return llabs(m-sum);\n  return llabs(m-(sum+a[ret]));\n}\n\nll ans;\nvoid search(int n,int now,ll sum,int m,vector<ll> &a,vector<ll> &all){\n  //ub,sumã¨aã®è¦ç´ ã§ãmä»¥ä¸ã§æå¤§ã®ãã®ãæ¢ã\n  //lb,sumã¨aã®è¦ç´ ã®åã§mä»¥ä¸æå°ã®ãã®ãæ¢ã\n  ll ub=bs(m,sum,all,true),lb=bs(m,sum,all,false);\n  ans = min(ans,ub);\n  ans = min(ans,lb);\n  if (now == n)return;\n  //ä½¿ã\n  search(n,now+1,sum+a[now],m,a,all);\n  //ä½¿ããªã\n  search(n,now+1,sum,m,a,all);\n}\n\n/*\n  ååå¨åæãã ãã¡ã¢ãªç¯ç´ãããã®ã§å¾ãååã¯æ¢ç´¢ããã\n */\nll solve2(vector<ll> in,ll m){\n  vector<ll> mae,usiro;\n  rep(i,in.size()){\n    if (i < in.size()/2)mae.push_back(in[i]);\n    else usiro.push_back(in[i]);\n  }\n  vector<ll> all=generate(mae);\n  ans = m;\n  search(usiro.size(),0,0,m,usiro,all);\n  return ans;\n}\n\nll solve(ll n,ll m,ll a,ll b,ll p,ll q){\n  if (a == 1 && b == 1){//ç¹æ®ã±ã¼ã¹\n    //assert(false);\n    ll sum = p+q;\n    ll lb = min(n,m/sum),ub=min(n,(m+sum-1)/sum);\n    ll ret = m;\n    if (lb <= n){\n      ret = min(ret,llabs(m-lb*(sum)));\n    }\n    if (ub <= n){\n      ret = min(ret,llabs(m-ub*(sum)));\n    }\n    return ret;\n  }\n\n  //ãã±ããã®çæ\n  //ä¸å¿doubleåã§å¤ã¯åãæ±ã£ã¦ããã\n  //å¿è¦ãªãã±ããã¯æå¤§ï¼ï¼æã§ãããä»¥ä¸ã¯æå³ããªãã\n  int loop = 0;\n  ll cur = p + q;\n  ll mula=1,mulb=1;\n  double m_d=m;\n  double cur_d = p+q;\n  double mula_d = 1, mulb_d = 1;\n  vector<ll> all;\n  all.push_back(cur);\n  while(cur_d <= m_d && loop < n){\n    mula *= a;\n    mulb *= b;\n    cur = p*mula + q*mulb;\n    all.push_back(cur);\n\n    mula_d *= a;\n    mulb_d *= b;\n    cur_d = p*mula_d + q*mulb_d;\n  }\n  //rep(i,all.size())cout << all[i] <<\" \" ;cout << endl;\n\n  if (all.size() == 1){//ä¸ã¤ããä½¿ãããã±ããããªããªããããç­ãã«ããã(å¿ãï¼æã¯ãããã¨ãä¿è¨¼ããã¦ãã)\n    return min(m,llabs(all[0]-m));\n  }\n  return solve2(all,m);\n}\n\nmain(){\n  ll n,m,a,b,p,q;\n  while(cin>>n>>m>>a>>b>>p>>q && n){\n    cout << solve(n,m,a,b,p,q)  << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cassert>\n#include<climits>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\ntypedef long long ll;\n\nvector<ll> generate(vector<ll> a){\n  vector<ll> ret;\n  int n = a.size();\n  rep(i,(1<<n)){\n    ll tmp = 0;\n    rep(j,n){\n      if ((1<<j)&i)tmp += a[j];\n    }\n    ret.push_back(tmp);\n  }\n  sort(ret.begin(),ret.end());\n  return ret;\n}\n\nll bs(ll m,ll sum,vector<ll> &a,bool fg){\n  int ret = -1;\n  int l = 0,r = a.size()-1;\n  while(l <= r){\n    int mid = (l+r)/2;\n    ll tmp = sum + a[mid];\n    if (fg){\n      if (tmp <= m){//ä¸éããã£ã¨ä¸ããã\n\tret = mid;\n\tl = mid+1;\n      }else {\n\tr = mid-1;\n      }\n    }else {\n      if (tmp >= m){\n\tret = mid;\n\tr = mid-1;\n      }else {\n\tl = mid+1;\t\n      }\n    }\n  }\n\n  /*  cout <<\"dbg\" << endl;\n  rep(i,a.size())cout << a[i] <<\" \" ;cout << endl;\n  cout <<fg <<\" \" <<  m <<\" \" << sum <<\" \" << (ret != -1?a[ret]:-1) <<\" \" << \n    ((ret != -1)?sum+a[ret]:-1)\n       << endl;\n  */\n  if (ret == -1)return llabs(m-sum);\n  return llabs(m-(sum+a[ret]));\n}\n\nll ans;\nvoid search(int n,int now,ll sum,int m,vector<ll> &a,vector<ll> &all){\n  //ub,sumã¨aã®è¦ç´ ã§ãmä»¥ä¸ã§æå¤§ã®ãã®ãæ¢ã\n  //lb,sumã¨aã®è¦ç´ ã®åã§mä»¥ä¸æå°ã®ãã®ãæ¢ã\n  ll ub=bs(m,sum,all,true),lb=bs(m,sum,all,false);\n  ans = min(ans,ub);\n  ans = min(ans,lb);\n  if (now == n)return;\n  //ä½¿ã\n  search(n,now+1,sum+a[now],m,a,all);\n  //ä½¿ããªã\n  search(n,now+1,sum,m,a,all);\n}\n\n/*\n  ååå¨åæãã ãã¡ã¢ãªç¯ç´ãããã®ã§å¾ãååã¯æ¢ç´¢ããã\n */\nll solve2(vector<ll> in,ll m){\n  vector<ll> mae,usiro;\n  rep(i,in.size()){\n    if (i < in.size()/2)mae.push_back(in[i]);\n    else usiro.push_back(in[i]);\n  }\n  vector<ll> all=generate(mae);\n  ans = m;\n  search(usiro.size(),0,0,m,usiro,all);\n  return ans;\n}\n\nll solve(ll n,ll m,ll a,ll b,ll p,ll q){\n  if (a == 1 && b == 1){//ç¹æ®ã±ã¼ã¹\n    ll sum = p+q;\n    ll lb = min(n,m/sum),ub=min(n,(m+sum-1)/sum);\n    ll ret = m;\n    ret = min(ret,llabs(m-lb*(sum)));\n    ret = min(ret,llabs(m-ub*(sum)));\n    return ret;\n  }\n\n  //ãã±ããã®çæ\n  //ä¸å¿doubleåã§å¤ã¯åãæ±ã£ã¦ããã\n  //å¿è¦ãªãã±ããã¯æå¤§ï¼ï¼æã§ãããä»¥ä¸ã¯æå³ããªãã\n  int loop = 0;\n  ll cur = p + q;\n  ll mula=1,mulb=1;\n  double m_d=m;\n  double cur_d = p + q;\n  double mula_d = 1, mulb_d = 1;\n  vector<ll> all;\n  all.push_back(cur);\n  while(cur_d <= m_d && loop < n){\n    mula_d *= a;\n    mulb_d *= b;\n    cur_d   = p*mula_d + q*mulb_d;\n    if (cur_d > 2*m)break;\n    mula *= a;\n    mulb *= b;\n    cur = p*mula + q*mulb;\n    all.push_back(cur);\n\n  }\n  //rep(i,all.size())cout << all[i] <<\" \" ;cout << endl;\n\n  if (all.size() == 1){//ä¸ã¤ããä½¿ãããã±ããããªããªããããç­ãã«ããã(å¿ãï¼æã¯ãããã¨ãä¿è¨¼ããã¦ãã)\n    return min(m,llabs(all[0]-m));\n  }\n  return solve2(all,m);\n}\n\nmain(){\n  ll n,m,a,b,p,q;\n  while(cin>>n>>m>>a>>b>>p>>q && n){\n    cout << solve(n,m,a,b,p,q)  << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<climits>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\ntypedef long long ll;\n\nvector<ll> generate(vector<ll> a){\n  vector<ll> ret;\n  int n = a.size();\n  rep(i,(1<<n)){\n    ll tmp = 0;\n    rep(j,n){\n      if ((1<<j)&i)tmp += a[j];\n    }\n    ret.push_back(tmp);\n  }\n  sort(ret.begin(),ret.end());\n  return ret;\n}\n\nll bs(ll m,ll sum,vector<ll> &a,bool fg){\n  int ret = -1;\n  int l = 0,r = a.size()-1;\n  while(l <= r){\n    int mid = (l+r)/2;\n    ll tmp = sum + a[mid];\n    if (fg){\n      if (tmp <= m){//ºÀðàÁÆã°éB\n\tret = mid;\n\tl = mid+1;\n      }else {\n\tr = mid-1;\n      }\n    }else {\n      if (tmp >= m){\n\tret = mid;\n\tr = mid-1;\n      }else {\n\tl = mid+1;\t\n      }\n    }\n  }\n  /*\n  cout <<\"dbg\" << endl;\n  rep(i,a.size())cout << a[i] <<\" \" ;cout << endl;\n  cout <<fg <<\" \" <<  m <<\" \" << sum <<\" \" << (ret != -1?a[ret]:-1) <<\" \" << \n    ((ret != -1)?sum+a[ret]:-1)\n       << endl;\n  */\n  if (ret == -1)return llabs(m-sum);\n  return llabs(m-(sum+a[ret]));\n}\n\nll ans;\nvoid search(int n,int now,ll sum,int m,vector<ll> &a,vector<ll> &all){\n  //ub,sumÆaÌvfÅAmÈºÅÅåÌàÌðT·\n  //lb,sumÆaÌvfÌaÅmÈãÅ¬ÌàÌðT·\n  ll ub=bs(m,sum,all,true),lb=bs(m,sum,all,false);\n  if (ub != -1)ans = min(ans,ub);\n  if (lb != -1)ans = min(ans,lb);\n  if (now == n)return;\n  //g¤\n  search(n,now+1,sum+a[now],m,a,all);\n  //gíÈ¢\n  search(n,now+1,sum,m,a,all);\n}\n\n/*\n  ¼ªSñ½¾µßñµ½¢ÌÅãë¼ªÍTõ·éB\n */\nll solve2(vector<ll> in,ll m){\n  vector<ll> mae,usiro;\n  rep(i,in.size()){\n    if (i < in.size()/2)mae.push_back(in[i]);\n    else usiro.push_back(in[i]);\n  }\n  vector<ll> all=generate(mae);\n  ans = m;\n  search(usiro.size(),0,0,m,usiro,all);\n  return ans;\n}\n\nll solve(ll n,ll m,ll a,ll b,ll p,ll q){\n  if (a == 1 && b == 1){//ÁêP[X\n    ll sum = a+b;\n    ll lb = min(m/sum,n),ub=min(n,(m+sum-1)/sum);\n    ll ret = m;\n    if (lb <= n){\n      ret = min(ret,m-lb*(a+b));\n    }\n    if (ub <= n){\n      ret = min(ret,m-ub*(a+b));\n    }\n    return ret;\n  }\n\n  //`PbgÌ¶¬\n  //êdouble^ÅlÍæèµÁÄ¨­B\n  //KvÈ`PbgÍÅåSOÅA»êÈãÍÓ¡ªÈ¢B\n  int loop = 0;\n  ll cur = p + q;\n  ll mula=1,mulb=1;\n  double m_d=m;\n  double cur_d = p+q;\n  double mula_d = 1, mulb_d = 1;\n  vector<ll> all;\n  all.push_back(cur);\n  while(cur_d <= m_d && loop < m){\n    mula *= a;\n    mulb *= b;\n    cur = p*mula + q*mulb;\n    all.push_back(cur);\n\n    mula_d *= a;\n    mulb_d *= b;\n    cur_d = p*mula_d + q*mulb_d;\n  }\n  //rep(i,all.size())cout << all[i] <<\" \" ;cout << endl;\n\n  if (all.size() == 1){//êÂµ©g¦é`PbgªÈ¢Èç»êð¦É·éB(K¸PÍ é±ÆªÛØ³êÄ¢é)\n    return min(m,llabs(all[0]-m));\n  }\n  return solve2(all,m);\n}\n\nmain(){\n  ll n,m,a,b,p,q;\n  while(cin>>n>>m>>a>>b>>p>>q && n){\n    cout << solve(n,m,a,b,p,q)  << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return min( m%d , m-m%d);\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n  if(n>40)n=41;\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        res=min( res, abs( m- ( T[i]+U[j] )) );      \n      }\n    }\n  }\n  \n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\nusing namespace std;\n\nint main(){\n  long long int n, m, a, b, p, q, ans;\n  cin >> n >> m >> a >> b >> p >> q;\n  if(a < b){\n    swap(a, b);\n    swap(p, q);\n  }\n  if(a == 1){\n    if(m/(p + q) > n) cout << m - n*(p + q) << endl;\n    else{\n      long long int t = m - m/(p + q)*(p + q);\n      cout << min(t, p + q - t) << endl;\n    }\n    return 0;\n  }\n  ans = m;\n  long long int x = 1, y = 1;\n  for(int i = 1; i < n; ++i){\n    if(m <= p*x + q*y) break;\n    x *= a;\n    y *= b;\n  }\n  while(x > 0){\n    ans = min(ans, abs(m - (p*x + q*y)));\n    if(m >= p*x + q*y) m -= p*x + q*y;\n    x /= a;\n    y /= b;\n  }\n  cout << ans << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "import java.util.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tlong n = sc.nextLong();\n\t\tlong m = sc.nextLong();\n\t\tlong a = sc.nextLong();\n\t\tlong b = sc.nextLong();\n\t\tlong p = sc.nextLong();\n\t\tlong q = sc.nextLong();\n\t\tlong INF = 1000_000_000_000_000L;\n\t\tif (a == 1 && b == 1) {\n\t\t\t// (p+q)N\n\t\t\tlong ans = INF;\n\t\t\tlong div = m / (p + q);\n\t\t\tdiv = Math.min(div, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tdiv = Math.min(div + 1, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tSystem.out.println(ans);\n\t\t\treturn;\n\t\t}\n\t\t// pa^k+qb^k\n\t\tlong lim = 0;\n\t\twhile (p * Math.pow(a, lim) + q * Math.pow(b, lim) <= INF) {\n\t\t\t++lim;\n\t\t}\n\t\tlim = Math.min(lim, n);\n\t\tlim = Math.min(lim, 41);\n\t\tArrayList<Long> pending1 = new ArrayList<>();\n\t\tArrayList<Long> pending2 = new ArrayList<>();\n\t\tfor (int t = 0; t < 2; ++t) {\n\t\t\tlong max = (t == 0 ? lim / 2 : (lim + 1) / 2);\n\t\t\touter: for (long i = 0; i < (1L << max); ++i) {\n\t\t\t\tlong s = 0;\n\t\t\t\tfor (int j = 0; j < 20; ++j) {\n\t\t\t\t\tif ((i & (1L << j)) > 0) {\n\t\t\t\t\t\ts += p * Math.pow(a, j + (t == 1 ? lim / 2 : 0)) + q * Math.pow(b, j + (t == 1 ? lim / 2 : 0));\n\t\t\t\t\t\tif (s > INF)\n\t\t\t\t\t\t\tcontinue outer;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t == 0)\n\t\t\t\t\tpending1.add(s);\n\t\t\t\telse\n\t\t\t\t\tpending2.add(s);\n\t\t\t}\n\t\t}\n\n\t\tCollections.sort(pending1);\n\t\tCollections.sort(pending2);\n\n\t\tlong ans = m;\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tint t = pending2.size() - 1;\n\t\t\tfor (int i = 0; i < pending1.size(); ++i) {\n\t\t\t\tif (j == 0)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) > m)\n\t\t\t\t\t\t--t;\n\t\t\t\telse if (j == 1)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) >= m\n\t\t\t\t\t\t\t&& pending1.get(i) + pending2.get(t - 1) >= m)\n\t\t\t\t\t\t--t;\n\t\t\t\tans = Math.min(ans, Math.abs(-m + pending1.get(i) + pending2.get(t)));\n\t\t\t}\n\t\t}\n\n\t\tSystem.out.println(ans);\n\n\t}\n\n\tstatic void tr(Object... objects) {\n\t\tSystem.out.println(Arrays.deepToString(objects));\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  ll MAX=1000000000000LL;\n  \n  assert( 1<= n &&n <= MAX );\n  assert( 1<= m &&m <= MAX );\n  assert( 1<= a &&a <= MAX );\n  assert( 1<= b &&b <= MAX );\n  assert( 1<= p &&p <= MAX );\n  assert( 1<= q &&q <= MAX );\n  \n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return min(m%d, m-(m%d) );\n    \n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n    if( i==40 )break;\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        ll c=T[i]+U[j];\n        res=min( res,  abs(m-c) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define N 41\nusing namespace std;\ntypedef long long ll;\nll n,m,a,b,p,q,d[N];\nvector<ll> v[2],x[2];\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll ans=m;\n  if(a==1&&b==1){\n    ll ti=min(n,m/(p+q));\n    ans=min(ans,min(m-ti*(p+q),abs(min(ti+1,n)*(p+q)-m)));\n  }\n  ll A=1,B=1;\n  for(int i=0;i<min((ll)N,n);i++){\n    d[i]=p*A+q*B;\n    if(i<min((ll)N,n)/2)v[0].push_back(d[i]);\n    else v[1].push_back(d[i]);\n    if(d[i]>m)break;\n    A*=a,B*=b;\n  }\n  int len[2]={v[0].size(),v[1].size()};\n  for(int i=0;i<2;i++){\n    v[i].push_back(0);\n    for(int j=0;j<(1<<len[i]);j++){\n      ll sum=0;\n      for(int k=0;k<len[i];k++){\n\tif(!(j&(1<<k)))continue;\n\tsum+=v[i][k];\n      }\n      x[i].push_back(sum);\n    }\n    sort(x[i].begin(),x[i].end());\n  }\n  cout<<'a'<<endl;\n  for(int i=0;i<x[0].size();i++){\n    ll search=m-x[0][i];\n    vector<ll>::iterator r=lower_bound(x[1].begin(),x[1].end(),search);\n    if(r!=x[1].end())ans=min(ans,(*r)-search);\n    if(r!=x[1].begin())ans=min(ans,search-(*(r-1)));\n  }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=__int128;\n\nusing ll2=long long;\n\nconst ll INF=1e15;\n\nll powi(ll x,ll k){\n    ll res=1;\n    while(k){\n        if(k&1) res*=x;\n        if(res>INF) return INF;\n        x*=x;\n        k>>=1;\n    }\n    return res;\n}\nint main(){\n    ll2 nn,mm,aa,bb,pp,qq;\n    cin>>nn>>mm>>aa>>bb>>pp>>qq;\n    ll n=nn,m=mm,a=aa,b=bb,p=pp,q=qq;\n    if(a>=2 || b>=2){\n        int tn=min(n,ll(44));\n        int half=tn/2;\n        vector<ll> vec(1<<half);\n        for(int i=0;i<(1<<half);i++){\n            ll val=0;\n            for(int j=0;j<half;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,j)+q*powi(b,j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            vec[i]=val;\n\n        }\n        int rest=tn-half;\n        set<ll> s;\n        for(int i=0;i<(1<<rest);i++){\n            ll val=0;\n            for(int j=0;j<rest;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,half+j)+q*powi(b,half+j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            s.insert(val);\n        }\n        ll2 res=m;\n        for(int i=0;i<vec.size();i++){\n            auto it=s.lower_bound(m-vec[i]);\n            if(it!=s.end()){\n        \n                res=min(res,ll2(abs(m-vec[i]-*it)));\n            }\n            if(it!=s.begin()){\n                it--;\n\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n        }\n        cout<<res<<endl;\n    }\n    else{\n        if((p+q)*n>=m){\n            cout<<ll2(min(m%(p+q),(p+q)-m%(p+q)))<<endl;\n        }\n        else{\n            cout<<ll2(m-(p+q)*n)<<endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (int)(k); i < (int)(n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\n\nint pow(ll x, ll n)\n{\n\tll res = 1;\n\twhile (n > 0)\n\t{\n\t\tif (n & 1) res = res * x;\n\t\tx = x*x;\n\t\tn >>= 1;\n\t}\n\treturn res;\n}\n\nll n, m, a, b, p, q;\n\nll calc(ll k)\n{\n\treturn p * pow(a, k) + q * pow(b, k);\n}\n\nll use(ll d)\n{\n\tREP(i, 42)\n\t{\n\t\tif (calc(i) > d) return i - 1;\n\t}\n}\n\nint main()\n{\n\tcin.sync_with_stdio(false); cout << fixed << setprecision(10);\n\tcin >> n >> m >> a >> b >> p >> q;\n\tll ans = LLONG_MAX;\n\tif (a == 1 && b == 1)\n\t{\n\t\tif ((p + q) * n < m) ans = m - (p + q) * n;\n\t\telse\n\t\t{\n\t\t\tint t = m / (p + q);\n\t\t\tans = min(m - (p + q) * t, (p + q)*(t + 1) - m);\n\t\t}\n\t}\n\telse if (a > 1 && b > 1)\n\t{\n\t\tset<int> st;\n\t\tll d = m;\n\t\tint cnt = 0, mx = n;\n\t\twhile (st.size() < n)\n\t\t{\n\t\t\tll t = use(d);\n\t\t\tif (t + 1 < n && !st.count(t + 1)) chmin(ans, calc(t + 1) - d);\n\t\t\tif (t < 0) break;\n\t\t\tll tmp = min(n, t);\n\t\t\twhile (st.count(tmp)) tmp--;\n\t\t\td -= calc(tmp);\n\t\t\tst.insert(tmp);\n\t\t\tchmin(ans, d);\n\t\t}\n\t\tchmin(ans, d);\n\t}\n\telse\n\t{\n\t\tif (a > b) swap(a, b);\n\t\tint loop = min(n + 1, 41ll);\n\t\tREP(i, loop)\n\t\t{\n\t\t\tset<int> st;\n\t\t\tll d = m;\n\t\t\tint cnt = 0, mx = n;\n\t\t\twhile (st.size() < i)\n\t\t\t{\n\t\t\t\tll t = use(d);\n\t\t\t\tif (t < 0) break;\n\t\t\t\tll tmp = min(n - 1, t);\n\t\t\t\twhile (st.count(tmp)) tmp--;\n\t\t\t\td -= calc(tmp);\n\t\t\t\tst.insert(tmp);\n\t\t\t}\n\t\t\tif (st.size() == i - 1)\n\t\t\t{\n\t\t\t\tif (!st.count(0))\n\t\t\t\t{\n\t\t\t\t\tchmin(ans, calc(0) - d);\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\telse if (st.size() != i) continue;\n\t\t\tchmin(ans, d);\n\t\t\tif (st.size() > 0)\n\t\t\t{\n\t\t\t\tint last = *st.begin();\n\t\t\t\tif (last + 1 < n && !st.count(last + 1))\n\t\t\t\t{\n\t\t\t\t\td = d + calc(last) - calc(last + 1);\n\t\t\t\t\tchmin(ans, -d);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s, B;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\n\tif (a == 1 && b == 1) {\n\t\tif (n >= 1000001 && (p + q) >= 1000001) { goto F; }\n\t\tif (m <= n * (p + q)) {\n\t\tF:;\n\t\t\tB = m % (p + q);\n\t\t\tif (B > (p + q) / 2) {\n\t\t\t\tB = (p + q) - B;\n\t\t\t}\n\t\t\tcout << B << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << m - (long long)(n * (p + q)) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = m;\n\td = s;\nE:;\n\trem = m - c[d - 1];\n\tminx = min(minx, abs(rem));\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  ll MAX=1000000000000LL;\n  \n  assert( 1<= n &&n <= MAX );\n  assert( 1<= m &&m <= MAX );\n  assert( 1<= a &&a <= MAX );\n  assert( 1<= b &&b <= MAX );\n  assert( 1<= p &&p <= MAX );\n  assert( 1<= q &&q <= MAX );\n\n\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(n*m*a*b*p*q==1){\n      return 0;\n    }\n\n    if(total <= m)return m-total;\n    \n    return min(m%d,m-m%d);\n    \n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n    if( i==40 )break;\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        ll c=T[i]+U[j];\n        res=min( res,  abs(m-c) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll _pow(ll a, ll n) {\n\tif(n == 0) return 1;\n\telse {\n\t\tll res = 1;\n\t\tll buf = a;\n\t\twhile(n > 0) {\n\t\t\tif(n % 2 == 1) {\n\t\t\t\tres *= buf;\n\t\t\t}\n\t\t\tbuf *= buf;\n\t\t\tn /= 2;\n\t\t}\n\t\treturn res;\n\t}\n}\n\nvoid solve() {\n\tll n, m, a, b, p, q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\tif(n == 1) {\n\t\tif(p + q > m) cout << m << endl;\n\t\telse cout << m - (p + q) << endl;\n\t\treturn;\n\t}\n\tll c = max(a, b);\n\tif(c == 1) {\n\t\tif((p + q) * n > m) {\n\t\t\tcout << min(m - m / (p + q) * (p + q), m - (m / (p + q) + 1) * (p + q))<< endl;\n\t\t} else cout << m - (p + q) * n << endl;\n\t} else if(c == 2 || c == 3) {\n\t\tll _n = 0;\n\t\tif(c == 2) _n = min(41LL, n);\n\t\tif(c == 3) _n = min(29LL, n);\n\t\tll div1 = n / 2;\n\t\tll div2 = n - div1;\n\t\tvector<ll> d1;\n\t\tvector<ll> d2;\n\t\tREP(bit, (1ll << div1)) {\n\t\t\tbitset<31> bi(bit);\n\t\t\tll sum = 0;\n\t\t\tREP(i, div1) if(bi[i]) sum += p * _pow(a, i) + q * _pow(b, i);\n\t\t\td1.pb(sum);\n\t\t}\n\t\tREP(bit, (1ll << div2)) {\n\t\t\tbitset<31> bi(bit);\n\t\t\tll sum = 0;\n\t\t\tREP(i, div2) if(bi[i]) sum += p * _pow(a, div1 + i) + q * _pow(b, div1 + i);\n\t\t\td2.pb(sum);\n\t\t}\n\t\tsort(ALL(d1));\n\t\tsort(ALL(d2));\n\t\tll ans = m;\n\t\tREP(i, d1.size()) {\n\t\t\tauto ite = upper_bound(ALL(d2), m - d1[i]);\n\t\t\tif(ite != d2.end()) ans = min(ans, (d1[i] + *ite) - m);\n\t\t\tif(ite == d2.begin()) continue;\n\t\t\tite--;\n\t\t\tans = min(ans, m - (d1[i] + *ite));\n\t\t}\n\t\tcout << ans << endl;\n\t} else /* c >= 4 */ {\n\t\tvector<ll> num;\n\t\tnum.pb(0);\n\t\tnum.pb(p + q);\n\t\tREP(i, 23) {\n\t\t\tif(100000000000000007LL / (ld)_pow(c, i) < c) break;\n\t\t\tll val = p * _pow(a, i + 1) + q * _pow(b, i + 1); \n\t\t\tvector<ll> nnum = num;\n\t\t\tREP(j, num.size()) nnum.pb(num[j] + val);\n\t\t\tnum = nnum;\n\t\t}\n\t\tUNIQUE(num);\n\t\tll ans = INF*INF;\n\t\tREP(i, num.size()) ans = min(ans, abs(m - num[i]));\n\t\tcout << ans << endl;\n\t}\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tsolve();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return min( m%total , m-m%total);\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n  for(int i=0;i<=40;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        res=min( res, abs( m- ( T[i]+U[j] )) );      \n      }\n    }\n  }\n  \n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<climits>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\ntypedef long long ll;\n\nvector<ll> generate(vector<ll> a){\n  vector<ll> ret;\n  int n = a.size();\n  rep(i,(1<<n)){\n    ll tmp = 0;\n    rep(j,n){\n      if ((1<<j)&i)tmp += a[j];\n    }\n    ret.push_back(tmp);\n  }\n  sort(ret.begin(),ret.end());\n  return ret;\n}\n\nll bs(ll m,ll sum,vector<ll> &a,bool fg){\n  int ret = -1;\n  int l = 0,r = a.size()-1;\n  while(l <= r){\n    int mid = (l+r)/2;\n    ll tmp = sum + a[mid];\n    if (fg){\n      if (tmp <= m){//ºÀðàÁÆã°éB\n\tret = mid;\n\tl = mid+1;\n      }else {\n\tr = mid-1;\n      }\n    }else {\n      if (tmp >= m){\n\tret = mid;\n\tr = mid-1;\n      }else {\n\tl = mid+1;\t\n      }\n    }\n  }\n  /*\n  cout <<\"dbg\" << endl;\n  rep(i,a.size())cout << a[i] <<\" \" ;cout << endl;\n  cout <<fg <<\" \" <<  m <<\" \" << sum <<\" \" << (ret != -1?a[ret]:-1) <<\" \" << \n    ((ret != -1)?sum+a[ret]:-1)\n       << endl;\n  */\n  if (ret == -1)return llabs(m-sum);\n  return llabs(m-(sum+a[ret]));\n}\n\nll ans;\nvoid search(int n,int now,ll sum,int m,vector<ll> &a,vector<ll> &all){\n  //ub,sumÆaÌvfÅAmÈºÅÅåÌàÌðT·\n  //lb,sumÆaÌvfÌaÅmÈãÅ¬ÌàÌðT·\n  ll ub=bs(m,sum,all,true),lb=bs(m,sum,all,false);\n  if (ub != -1)ans = min(ans,ub);\n  if (lb != -1)ans = min(ans,lb);\n  if (now == n)return;\n  //g¤\n  search(n,now+1,sum+a[now],m,a,all);\n  //gíÈ¢\n  search(n,now+1,sum,m,a,all);\n}\n\n/*\n  ¼ªSñ½¾µßñµ½¢ÌÅãë¼ªÍTõ·éB\n */\nll solve2(vector<ll> in,ll m){\n  vector<ll> mae,usiro;\n  rep(i,in.size()){\n    if (i < in.size()/2)mae.push_back(in[i]);\n    else usiro.push_back(in[i]);\n  }\n  vector<ll> all=generate(mae);\n  ans = m;\n  search(usiro.size(),0,0,m,usiro,all);\n  return ans;\n}\n\nll solve(ll n,ll m,ll a,ll b,ll p,ll q){\n  if (a == 1 && b == 1){//ÁêP[X\n    ll sum = a+b;\n    ll lb = min(m/sum,n),ub=min(n,(m+sum-1)/sum);\n    ll ret = m;\n    if (lb <= n){\n      ret = min(ret,llabs(m-lb*(a+b)));\n    }\n    if (ub <= n){\n      ret = min(ret,llabs(m-ub*(a+b)));\n    }\n    return ret;\n  }\n\n  //`PbgÌ¶¬\n  //êdouble^ÅlÍæèµÁÄ¨­B\n  //KvÈ`PbgÍÅåSOÅA»êÈãÍÓ¡ªÈ¢B\n  int loop = 0;\n  ll cur = p + q;\n  ll mula=1,mulb=1;\n  double m_d=m;\n  double cur_d = p+q;\n  double mula_d = 1, mulb_d = 1;\n  vector<ll> all;\n  all.push_back(cur);\n  while(cur_d <= m_d && loop < n){\n    mula *= a;\n    mulb *= b;\n    cur = p*mula + q*mulb;\n    all.push_back(cur);\n\n    mula_d *= a;\n    mulb_d *= b;\n    cur_d = p*mula_d + q*mulb_d;\n  }\n  //rep(i,all.size())cout << all[i] <<\" \" ;cout << endl;\n\n  if (all.size() == 1){//êÂµ©g¦é`PbgªÈ¢Èç»êð¦É·éB(K¸PÍ é±ÆªÛØ³êÄ¢é)\n    return min(m,llabs(all[0]-m));\n  }\n  return solve2(all,m);\n}\n\nmain(){\n  ll n,m,a,b,p,q;\n  while(cin>>n>>m>>a>>b>>p>>q && n){\n    cout << solve(n,m,a,b,p,q)  << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nbool ch(int a,int b){\n  int x=1000000000000000LL;\n  x/=a;\n  x/=b;\n  return x==0;\n}\nsigned main(){\n  int n,m,a,b,p,q;\n  cin>>n>>m>>a>>b>>p>>q;\n  if(a==1&&b==1){\n    cout<<m%(p+q)<<endl;\n    return 0;\n  }\n  int ta=1,tb=1;\n  vector<int> v;\n  for(int i=0;i<n;i++){\n    if(ch(p,ta)) break;\n    if(ch(q,tb)) break;\n    int t=p*ta+q*tb;\n    if(t<=m) v.push_back(t);\n    else break;\n    //cout<<t<<endl;\n    if(ch(ta,a)) break;\n    if(ch(tb,b)) break;\n    ta*=a;tb*=b;\n  }\n  int x=v.size();\n  int y=x/2;\n  if(x==1){\n    cout<<m-v[0]<<endl;\n    return 0;\n  }\n  set<int> s;\n  for(int i=0;i<(1<<y);i++){\n    int t=0;\n    for(int j=0;j<y;j++) if((i>>j)&1) t+=v[j];\n    if(t>m) continue;\n    //cout<<t<<endl;\n    s.insert(-t);\n  }\n  int ans=m;\n  for(int i=0;i<(1<<(x-y));i++){\n    int t=0;\n    for(int j=0;j<(x-y);j++) if((i>>j)&1) t+=v[y+j];\n    if(t>m) continue;\n    //cout<<t<<endl;\n    int u=t-m;\n    int k=*lower_bound(s.begin(),s.end(),u);\n    ans=min(ans,m-(t-k));\n  }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\tll n,m,a,b,p,q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\t\n\tif(a == 1 && b == 1){\n\t\tcout << max( m%(p+q) , m-(p+q)*n ) << endl;\n\t}\n\telse {\n\t\tvector<ll> vec;\n\t\tll s = 1 , t = 1;\n\t\tfor(int i = 0 ; i < n ; i ++){\n\t\t\tif(p*s+q*t > m)break;\n\t\t\tvec.push_back(p*s+q*t);\n\t\t\ts *= a;\n\t\t\tt *= b;\n\t\t}\n\t\tint N = vec.size();\n\t\tvector<ll> A,B;\n\t\tA.push_back(0);\n\t\tfor(int i = 0 ; i < N/2 ; i ++){\n\t\t\tint x = A.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tA.push_back(vec[i]+A[j]);\n\t\t\t}\n\t\t}\n\t\tB.push_back(0);\n\t\tfor(int i = N/2 ; i < N ; i ++){\n\t\t\tint x = B.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tB.push_back(vec[i]+B[j]);\n\t\t\t}\n\t\t}\n\t\tsort(B.begin(),B.end());\n\t\tll ret = m;\n\t\tfor(int i = 0 ; i < A.size() ; i ++){\n\t\t\tint x = upper_bound(B.begin(),B.end(),m-A[i])-B.begin();\n\t\t\tx --;\n\t\t\tret = min ( ret , m-A[i]-B[x] );\n\t\t}\n\t\tcout << ret << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\tfor (int i = 1; i < 10000; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < 10000; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 0; i < 10000; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tbreak;\n\t\t}\n\t}\n\trem = m - c[d - 1];\n\tminx = min(minx, rem);\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <string>\n#include <cmath>\n#include <bitset>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <complex>\n#include <unordered_map>\n#include <unordered_set>\n#include <random>\n#include <cassert>\n#include <fstream>\n#define popcount __builtin_popcount\nusing namespace std;\ntypedef long long ll;\ntypedef __int128_t lll;\ntypedef pair<int, int> P;\n\nint main()\n{\n    ll n, m, a, b, p, q;\n    cin>>n>>m>>a>>b>>p>>q;\n    if(a==1 && b==1){\n        if(p+q<=m/n) cout<<m-(p+q)*n<<endl;\n        else cout<<min(m%(p+q), p+q-m%(p+q))<<endl;\n        return 0;\n    }\n    vector<ll> v;\n    lll x=p, y=q;\n    ll ans=m;\n    for(int i=0; i<n; i++){\n        v.push_back(x+y);\n        if(i<n-1 && x*a+y*b>=m){\n            if(x*a+y*b<2*m){\n                ans=min((ll)(x*a+y*b-m), ans);\n            }\n            break;\n        }\n        x*=a, y*=b;\n    }\n    int k=v.size();\n    ll s1[1<<21], s2[1<<21];\n    for(int i=0; i<(1<<(k/2)); i++){\n        s1[i]=0;\n        for(int j=0; j<k/2; j++){\n            if(i&(1<<j)) s1[i]+=v[j];\n        }\n    }\n    for(int i=0; i<(1<<(k-k/2)); i++){\n        s2[i]=0;\n        for(int j=0; j<k-k/2; j++){\n            if(i&(1<<j)) s2[i]+=v[k/2+j];\n        }\n    }\n    sort(s2, s2+(1<<(k-k/2)));\n    for(int i=0; i<(1<<(k/2)); i++){\n        if(s1[i]>=m){\n            ans=min(ans, s1[i]-m);\n            continue;\n        }\n        int t=lower_bound(s2, s2+(1<<(k-k/2)), m-s1[i])-s2;\n        if(t<(1<<(k-k/2))) ans=min(ans, s1[i]+s2[t]-m);\n        ans=min(ans, m-s1[i]-s2[t-1]);\n    }\n    cout<<ans<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cmath>\n#include<cstdio>\n#include<vector>\n#include<algorithm>\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\tll n,m,a,b,p,q; scanf(\"%lld%lld%lld%lld%lld%lld\",&n,&m,&a,&b,&p,&q);\n\n\tll ans=llabs(n*(p+q)-m);\n\tif(a==1 && b==1){\n\t\tll i=m/(p+q);\n\t\tfor(int j=-3;j<=3;j++) if(0<=i+j && i+j<=n) ans=min(ans,llabs((i+j)*(p+q)-m));\n\t}\n\telse{\n\t\tint N;\n\t\tll num[40];\n\t\tfor(int k=0;;k++){\n\t\t\tnum[k]=p*pow(a,k)+q*pow(b,k);\n\t\t\tif(num[k]>1e9){\n\t\t\t\tN=k;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(N%2==1) num[N++]=0;\n\n\t\tvector<ll> half1,half2;\n\t\trep(S,1<<N/2){\n\t\t\tbool ok1=true,ok2=true;\n\t\t\tll sum1=0,sum2=0;\n\t\t\trep(i,N/2) if(S>>i&1) {\n\t\t\t\tsum1+=num[i];\n\t\t\t\tsum2+=num[i+N/2];\n\t\t\t\tif(sum1>2e9) ok1=false;\n\t\t\t\tif(sum2>2e9) ok2=false;\n\t\t\t}\n\t\t\tif(ok1) half1.push_back(sum1);\n\t\t\tif(ok2) half1.push_back(sum2);\n\t\t}\n\t\thalf1.push_back(0);\n\t\thalf2.push_back(0);\n\n\t\tsort(half1.begin(),half1.end());\n\t\tsort(half2.begin(),half2.end());\n\n\t\trep(i,half1.size()){\n\t\t\tint j=lower_bound(half2.begin(),half2.end(),m-half1[i])-half2.begin();\n\t\t\tif(j<half2.size()) ans=min(ans,llabs(half1[i]+half2[ j ]-m));\n\t\t\tif(j-1>=0)         ans=min(ans,llabs(half1[i]+half2[j-1]-m));\n\t\t}\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define N 45\nusing namespace std;\ntypedef long long ll;\nll n,m,a,b,p,q,ans;\nll d[N],used[N];\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ans=m;\n  if(a==1&&b==1){\n    ll ti=min(n,m/(p+q));\n    ans=min(ans,min(abs(m-ti*(p+q)),abs(m-min(ti+1,n)*(p+q))));\n  }\n  ll A=1,B=1;\n  for(int i=0;i<min((ll)N,n);i++){\n    d[i]=p*A+q*B;\n    if(d[i]>m)break;\n    A*=a,B*=b;\n  }\n\n  for(int i=min((ll)N,n)-1;i>=0;i--){\n    if(m<d[i])continue;\n    used[i]=1;\n    m-=d[i];\n  }\n  ans=min(ans,m);\n  for(int i=0;i<min((ll)N,n)-1;i++)\n    if(!used[i]){\n      ans=min(ans,abs(m-d[i]));\n      break;\n    }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dist[40];\nint main(){\n\tlong long a,b,c,d,e,f;\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&a,&b,&c,&d,&e,&f);\n\tif(c==1&&d==1){\n\t\tlong long v=b%(e+f);\n\t\tlong long g=b/(e+f);\n\t\tprintf(\"%lld\\n\",v+max(0LL,g-a)*(e+f));\n\t\treturn 0;\n\t}\n\tint sz=0;\n\tfor(int i=0;i<=a;i++){\n\t\tlong long L=e;\n\t\tlong long R=f;\n\t\tlong long Q=b;\n\t\tfor(int j=0;j<i;j++)Q/=max(c,d);\n\t\tif(Q==0)break;\n\t\tfor(int j=0;j<i;j++)L*=c;\n\t\tfor(int j=0;j<i;j++)R*=d;\n\t\tlong long t=L+R;\n\t\tif(t>b)break;\n\t\tdist[sz++]=t;\n\t//\tprintf(\"%lld \",dist[sz-1]);\n\t}\n\tif(d==1){\n\t\tswap(c,d);\n\t\tswap(e,f);\n\t}\n\tif(c==1){\n\t\tlong long ret=b;\n\t\tfor(int i=0;i<sz;i++)dist[i]-=e;\n\t\tfor(int i=1;i<=sz;i++){\n\t\t\tlong long tmp=b-(long long)i*e;\n\t\t\tif(tmp<0)break;\n\t\t\tint rem=i;\n\t\t\tfor(int j=sz-1;j>=0;j--){\n\t\t\t\tif(tmp>=dist[j]){\n\t\t\t\t\trem--;\n\t\t\t\t\ttmp-=dist[j];\n\t\t\t\t}else{\n\t\t\t\t\tlong long cost=dist[j]-tmp;\n\t\t\t\t\tif(rem-1<=j){\n\t\t\t\t\t\tfor(int k=0;k<rem-1;k++){\n\t\t\t\t\t\t\tcost+=dist[k];\n\t\t\t\t\t\t}\n\t\t\t\t//\t\tprintf(\"%d %d: %lld\\n\",i,j,cost);\n\t\t\t\t\t\tret=min(ret,cost);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(rem==0)break;\n\t\t\t}\n\t\t\t\n\t\t\tif(rem==0)ret=min(ret,tmp);\n\t\t\t//printf(\"%d: %lld\\n\",i,ret);\n\t\t}\n\t\tprintf(\"%lld\\n\",ret);\n\t\treturn 0;\n\t}\n\tlong long ret=b;\n\tlong long tmp=b;\n\tfor(int i=sz-1;i>=0;i--){\n\t\tif(tmp>=dist[i])tmp-=dist[i];\n\t\telse ret=min(ret,dist[i]-tmp);\n\t\tret=min(ret,tmp);\n\t}\n\tprintf(\"%lld\\n\",ret);\n}\n//11 12 14 18"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cassert>\n#include<climits>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\ntypedef long long ll;\n\nvector<ll> generate(vector<ll> a){\n  vector<ll> ret;\n  int n = a.size();\n  rep(i,(1<<n)){\n    ll tmp = 0;\n    rep(j,n){\n      if ((1<<j)&i)tmp += a[j];\n    }\n    ret.push_back(tmp);\n  }\n  sort(ret.begin(),ret.end());\n  return ret;\n}\n\nll bs(ll m,ll sum,vector<ll> &a,bool fg){\n  int ret = -1;\n  int l = 0,r = a.size()-1;\n  while(l <= r){\n    int mid = (l+r)/2;\n    ll tmp = sum + a[mid];\n    if (fg){\n      if (tmp <= m){//ä¸éããã£ã¨ä¸ããã\n\tret = mid;\n\tl = mid+1;\n      }else {\n\tr = mid-1;\n      }\n    }else {\n      if (tmp >= m){\n\tret = mid;\n\tr = mid-1;\n      }else {\n\tl = mid+1;\t\n      }\n    }\n  }\n\n  /*  cout <<\"dbg\" << endl;\n  rep(i,a.size())cout << a[i] <<\" \" ;cout << endl;\n  cout <<fg <<\" \" <<  m <<\" \" << sum <<\" \" << (ret != -1?a[ret]:-1) <<\" \" << \n    ((ret != -1)?sum+a[ret]:-1)\n       << endl;\n  */\n  if (ret == -1)return llabs(m-sum);\n  //cout << m <<\" \" << sum+a[ret] << \" \" << llabs(m-(sum+a[ret])) << endl;\n  return llabs(m-(sum+a[ret]));\n}\n\nll ans;\nvoid search(int n,int now,ll sum,ll m,vector<ll> &a,vector<ll> &all){\n  //ub,sumã¨aã®è¦ç´ ã§ãmä»¥ä¸ã§æå¤§ã®ãã®ãæ¢ã\n  //lb,sumã¨aã®è¦ç´ ã®åã§mä»¥ä¸æå°ã®ãã®ãæ¢ã\n  ll ub=bs(m,sum,all,true),lb=bs(m,sum,all,false);\n  ans = min(ans,ub);\n  ans = min(ans,lb);\n  if (now == n)return;\n  //ä½¿ã\n  search(n,now+1,sum+a[now],m,a,all);\n  //ä½¿ããªã\n  search(n,now+1,sum,m,a,all);\n}\n\n/*\n  ååå¨åæãã ãã¡ã¢ãªç¯ç´ãããã®ã§å¾ãååã¯æ¢ç´¢ããã\n */\nll solve2(vector<ll> in,ll m){\n  vector<ll> mae,usiro;\n  rep(i,in.size()){\n    if (i < in.size()/2)mae.push_back(in[i]);\n    else usiro.push_back(in[i]);\n  }\n  vector<ll> all=generate(mae);\n  ans = m;\n  search(usiro.size(),0,0,m,usiro,all);\n  return ans;\n}\n\nll solve(ll n,ll m,ll a,ll b,ll p,ll q){\n  if (a == 1 && b == 1){//ç¹æ®ã±ã¼ã¹\n    ll sum = p+q;\n    ll lb = min(n,m/sum),ub=min(n,(m+sum-1)/sum);\n    ll ret = m;\n    ret = min(ret,llabs(m-lb*(sum)));\n    ret = min(ret,llabs(m-ub*(sum)));\n    return ret;\n  }\n\n  //ãã±ããã®çæ\n  //ä¸å¿doubleåã§å¤ã¯åãæ±ã£ã¦ããã\n  //å¿è¦ãªãã±ããã¯æå¤§ï¼ï¼æã§ãããä»¥ä¸ã¯æå³ããªãã\n  int loop = 0;\n  ll cur = p + q;\n  ll mula=1,mulb=1;\n  double m_d=m;\n  double cur_d = p + q;\n  double mula_d = 1, mulb_d = 1;\n  vector<ll> all;\n  all.push_back(cur);\n  while(loop < n){\n    mula_d *= a;\n    mulb_d *= b;\n    cur_d   = p*mula_d + q*mulb_d;\n    if (cur_d > 4*m)break;\n    mula *= a;\n    mulb *= b;\n    cur = p*mula + q*mulb;\n    all.push_back(cur);\n\n  }\n\n  //rep(i,all.size())assert(all[i] > 0);\n  //rep(i,all.size())cout << all[i] <<\" \" ;cout << endl;\n\n  if (all.size() == 1){//ä¸ã¤ããä½¿ãããã±ããããªããªããããç­ãã«ããã(å¿ãï¼æã¯ãããã¨ãä¿è¨¼ããã¦ãã)\n    return min(m,llabs(all[0]-m));\n  }\n  return solve2(all,m);\n}\n\nmain(){\n  ll n,m,a,b,p,q;\n  while(cin>>n>>m>>a>>b>>p>>q && n){\n    cout << solve(n,m,a,b,p,q)  << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\tll n,m,a,b,p,q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\t\n\tif(a == 1 && b == 1){\n\t\tif(m >= (p+q)*n)cout << m-(p+q)*n << endl;\n\t\telse {\n\t\t\tcout << min( m%(p+q) , (p+q)-m%(p+q) ) << endl;\n\t\t}\n\t}\n\telse {\n\t\tvector<ll> vec;\n\t\tll s = 1 , t = 1;\n\t\tfor(int i = 0 ; i < n ; i ++){\n\t\t\tvec.push_back(p*s+q*t);\n\t\t\tif(p*s+q*t > m)break;\n\t\t\ts *= a;\n\t\t\tt *= b;\n\t\t}\n\t\tint N = vec.size();\n\t\tvector<ll> A,B;\n\t\tA.push_back(0);\n\t\tfor(int i = 0 ; i < N/2 ; i ++){\n\t\t\tint x = A.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tA.push_back(vec[i]+A[j]);\n\t\t\t}\n\t\t}\n\t\tB.push_back(0);\n\t\tfor(int i = N/2 ; i < N ; i ++){\n\t\t\tint x = B.size();\n\t\t\tfor(int j = 0 ; j < x ; j ++){\n\t\t\t\tB.push_back(vec[i]+B[j]);\n\t\t\t}\n\t\t}\n\t\tsort(B.begin(),B.end());\n\t\tB.erase(unique(B.begin(),B.end()),B.end());\n\t\tll ret = m;\n\t\tfor(int i = 0 ; i < A.size() ; i ++){\n\t\t\tint x = upper_bound(B.begin(),B.end(),m-A[i])-B.begin();\n\t\t\tif(x < B.size())ret = min ( ret , A[i]+B[x]-m );\n\t\t\tx --;\n\t\t\tret = min ( ret , m-A[i]-B[x] );\n\t\t}\n\t\tcout << ret << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s, B;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\n\tif (a >= 1000000000 && b >= 1000000000) {\n\t\tif (p >= 1000000000 && q >= 1000000000) {\n\t\t\tcout << min(m, abs(m - p - q)) << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << min(m, min(abs(m - p - q), abs(m - a * p + b * q))) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\n\tif (a == 1 && b == 1) {\n\t\tif (n >= 1000001 && (p + q) >= 1000001) { goto F; }\n\t\tif (m <= n * (p + q)) {\n\t\tF:;\n\t\t\tB = m % (p + q);\n\t\t\tif (B > (p + q) / 2) {\n\t\t\t\tB = (p + q) - B;\n\t\t\t}\n\t\t\tcout << B << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << m - (long long)(n * (p + q)) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = m;\n\td = s;\nE:;\n\trem = m - c[d - 1];\n\tminx = min(minx, abs(rem));\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "// g++ -std=c++11 a.cpp\n#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>   \n#include<map>\n#include<set>\n#include<unordered_map>\n#include<utility>\n#include<cmath>\n#include<random>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<bitset>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#include<typeinfo>\n#define loop(i,a,b) for(ll i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define FOR(i,a) for(auto i:a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n#define show1d(v) rep(i,v.size())cout<<\" \"<<v[i];cout<<endl<<endl;\n#define show2d(v) rep(i,v.size()){rep(j,v[i].size())cout<<\" \"<<v[i][j];cout<<endl;}cout<<endl;\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\n//#define int ll\ntypedef ll Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n#define mt make_tuple\ntypedef tuple<int,int,int,int> tp;\ntypedef vector<tp> vt;\ntemplate<typename A,typename B>bool cmin(A &a,const B &b){return a>b?(a=b,true):false;}\ntemplate<typename A,typename B>bool cmax(A &a,const B &b){return a<b?(a=b,true):false;}\n//template<class C>constexpr int size(const C &c){return (int)c.size();}\n//template<class T,size_t N> constexpr int size(const T (&xs)[N])noexcept{return (int)N;}\nconst double PI=acos(-1);\nconst double EPS=1e-9;\nDef inf = sizeof(Def) == sizeof(long long) ? 2e18 : 1e9+10;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\nint main(){\n\tll n,m,a,b,p,q;\n\tcin>>n>>m>>a>>b>>p>>q;\n\tif(a+b==2){\n\t\tll t=p+q;\n\t\tll T=min(n,m/t);\n\t\tll out=m;\n\t\tloop(i,max(0ll,T-10),min(n+1,T+10))\n\t\t\tout=min(out,abs(t*i-m));\n\t\tcout<<out<<endl;\n\t\treturn 0;\n\t}\n\tvi A,B;\n\tll t=p;\n\tint co=0;\n\twhile(1){\n\t\tA.pb(t);\n\t\tif(to_string(t).size()+to_string(a).size()>16)break;\n\t\tt*=a;\n\t\tif(a==1&&co==40)break;\n\t\tco++;\n\t}\n\tt=q;\n\tco=0;\n\twhile(1){\n\t\tB.pb(t);\n\t\tif(to_string(t).size()+to_string(b).size()>16)break;\n\t\tt*=b;\n\t\tif(b==1&&co==40)break;\n\t\tco++;\n\t}\n\t//show1d(A);\n\t//show1d(B);\n\tvi in;\n\trep(i,min((ll)A.size(),n))\n\t\tif(i<B.size()&&A[i]+B[i]<=3*m)in.pb(A[i]+B[i]);\n\tn=in.size()/2;\n\tll N=1<<n;\n\tvi dp;\n\trep(i,N){\n\t\tll sum=0;\n\t\trep(j,n)if(i&1<<j)sum+=in[j];\n\t\tif(sum<=3*m)dp.pb(sum);\n\t}\n\tsort(all(dp));\n\tll nn=in.size()-n;\n\tN=1<<nn;\n\tll out=m;\n//\tshow1d(in);\n\trep(i,N){\n\t\tll sum=0;\n\t\trep(j,nn)if(i&1<<j)sum+=in[n+j];\n\t\tif(sum>3*m)continue;\n\t\tauto it=upper_bound(all(dp),m-sum);\n\t\tif(it!=dp.end())out=min(out,abs(*it+sum-m));\n\t\tif(it==dp.begin())continue;\n\t\tit--;\n\t\tout=min(out,abs(*it+sum-m));\n\t}\n//\tshow1d(dp);\n\tcout<<out<<endl;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n0\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s, B;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\n\tif (a == 1 && b == 1) {\n\t\tif (m <= s * (n + 1) / 2 * (p + q)) {\n\t\t\tB = m % (p + q);\n\t\t\tif (m > (p + q) / 2) {\n\t\t\t\tB = (p + q) - B;\n\t\t\t}\n\t\t\tcout << B << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << m - (long long)(n * (n + 1) / 2 * (p + q)) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = m;\n\td = s;\nE:;\n\trem = m - c[d - 1];\n\tminx = min(minx, abs(rem));\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\nusing namespace std;\n\nlong long vals[50];\nlong long N;\nlong long M;\n\nlong long dfs(int id,int toTake,int taken,long long curVal,bool flg){\n//\tprintf(\"%d %d %d %lld\\n\",id,toTake,taken,curVal);\n\tif(id==-1){\n\t\tif(taken==toTake) return curVal;\n\t\telse return -1;\n\t}\n\tif(toTake==taken){\n\t\treturn curVal;\n\t}\n\tlong long nxtVal=curVal+vals[id];\n//\tprintf(\"nxt=%lld\\n\",nxtVal);\n\tlong long res=-1;\n\tif(nxtVal>M){\n\t\tres=dfs(id-1,toTake,taken,curVal,flg);\n\t\treturn res;\n\t}\n\tif(flg==false){\n\t\t//not take\n\t\tres=dfs(id-1,toTake,taken,curVal,true);\n\t}\n\tlong long res2=dfs(id-1,toTake,taken+1,nxtVal,flg);\n\tres=max(res,res2);\n\treturn res;\n}\n\nlong long dfs2(int id,int toTake,int taken,long long curVal){\n\tif(id==-1){\n\t\tif(toTake!=taken) return -1;\n\t\treturn curVal;\n\t}\n\tlong long nxtVal=curVal+vals[id];\n\tif(toTake==taken+id+1){\n\t\tlong long tmp=dfs2(id-1,toTake,taken+1,nxtVal);\n\t\treturn tmp;\n\t}\n\tlong long notTake=curVal;\n\tfor(int i=1;i<=toTake-taken;i++){\n\t\tnotTake+=vals[id-i];\n\t}\n\tlong long res;\n\tif(notTake>=M){\n\t\tres=dfs2(id-1,toTake,taken,curVal);\n\t}else{\n\t\tres=dfs2(id-1,toTake,taken+1,nxtVal);\n\t}\n\treturn res;\n}\n\nlong long mult(long long a,long long b,long long c){\n\tlong long x=c/a;\n\tif(b>x) return -1;\n\tlong long res=a*b;\n\tif(res>c) return -1;\n\treturn res;\n}\n\nint main(){\n\tlong long a,b,p,q;\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&N,&M,&a,&b,&p,&q);\n\tif(a==1&&b==1){\n\t\tlong long x=p+q;\n\t\tlong long num=M/x;\n\t\tnum=min(num,N);\n\t\tlong long train=x*num;\n\t\tlong long ans=M-train;\n\t\tif(num+1<=N){\n\t\t\ttrain+=x;\n\t\t\tans=min(ans,train-M);\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t\treturn 0;\n\t}\n\tlong long pa=1,pb=1;\n\tint n=0;\n\tfor(int i=0;i<N;i++){\n\t\tlong long cur1=mult(pa,p,M);\n\t\tlong long cur2=mult(pb,q,M);\n\t\tif(cur1==-1||cur2==-1) break;\n\t\tlong long cur=cur1+cur2;\n\t\tif(cur>M*2) break;\n\t\tvals[n++]=cur;\n\t\tpa=mult(pa,a,M);\n\t\tpb=mult(pb,b,M);\n\t\tif(pa==-1||pb==-1) break;\n\t}\n\tif(n==0){\n\t\tprintf(\"%lld\\n\",M);\n\t\treturn 0;\n\t}\n//\tfor(int i=0;i<n;i++){\n//\t\tprintf(\"%d %lld\\n\",i,vals[i]);\n//\t}\n\tN=n;\n\tlong long ans=M;\n\tfor(int i=1;i<=n;i++){\n\t\tlong long tmp=dfs(n-1,i,0,0,false);\n//\t\tprintf(\"%d %lld\\n\",i,tmp);\n\t\tif(tmp==-1) continue;\n\t\tans=min(ans,M-tmp);\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tlong long tmp=dfs2(n-1,i,0,0);\n\t\tif(tmp==-1) continue;\n\t\tans=min(ans,tmp-M);\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=100000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return min( m%total , m-m%total);\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n  for(int i=0;i<40;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n\n  ll res=m;\n  \n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-1;j<=index+1;j++){\n      if(0<=j && j<(int)U.size()){\n        res=min( res, abs( m- ( T[i]+U[j] )) );      \n      }\n    }\n  }\n  \n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\n\nconst ll Inf = (ll)1e17;\n\nll dfs(int k, ll sum, vector<ll>& num, vector<ll>& imos) {\n    if (k < 0) return sum;\n    if (sum >= imos[k]) return sum - imos[k];\n    if (num[k] > sum) return dfs(k - 1, sum, num, imos);\n    long long a = dfs(k - 1, sum, num, imos);\n    long long b = dfs(k - 1, sum - num[k], num, imos);\n    return min(a, b);\n}\n\nint main() {\n    ll n, m, a, b, p, q;\n    cin >> n >> m >> a >> b >> p >> q;\n    if (p + q > m)\n        cout << m << \"\\n\";\n    else if (p * (double)a + q * (double)b - 0.1 > m)\n        cout << (m - (p + q)) << \"\\n\";\n    else if (a >= 1000000 || b >= 1000000) {\n        if (p * (a + 1) + q * (b + 1) > m)\n            cout << (m - (p * a + q * b)) << \"\\n\";\n        else\n            cout << (m - (p * (a + 1) + q * (b + 1))) << \"\\n\";\n    }\n    else if (a == 1 && b == 1) {\n        if ((p + q) * (double)n - 0.1 > m)\n            cout << (m % (p + q)) << \"\\n\";\n        else\n            cout << (m - n * (p + q)) << \"\\n\";\n    }\n    else if (b == 1) {\n        vector<ll> num, imos;\n        int j = 1;\n        num.push_back(p + q);\n        imos.push_back(num[0]);\n        ll aa = a;\n        while (aa * p + q <= m) {\n            num.push_back(aa * p + q);\n            imos.push_back(imos[j - 1] + num[j]);\n            aa *= a;\n            ++j;\n        }\n        cout << dfs(j - 1, m, num, imos) << \"\\n\";\n    }\n    else if (a == 1) {\n        vector<ll> num, imos;\n        int j = 1;\n        num.push_back(p + q);\n        imos.push_back(num[0]);\n        ll bb = b;\n        while (bb * q + p <= m) {\n            num.push_back(bb * q + p);\n            imos.push_back(imos[j - 1] + num[j]);\n            bb *= b;\n            ++j;\n        }\n        cout << dfs(j - 1, m, num, imos) << \"\\n\";\n    }\n    else {\n        vector<ll> num;\n        int j = 1;\n        num.push_back(p + q);\n        ll aa = a, bb = b;\n        while (aa * p + bb * q <= m) {\n            num.push_back(aa * p + bb * q);\n            aa *= a;\n            bb *= b;\n            ++j;\n        }\n        for (--j; j >= 0; --j) {\n            if (m >= num[j]) m -= num[j];\n        }\n        cout << m << \"\\n\";\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\nusing namespace std;\n\nlong long vals[50];\nlong long N;\nlong long M;\n\nlong long dfs(int id,int toTake,int taken,long long curVal,bool flg){\n//\tprintf(\"%d %d %d %lld\\n\",id,toTake,taken,curVal);\n\tif(id==-1){\n\t\tif(taken==toTake) return curVal;\n\t\telse return -1;\n\t}\n\tif(toTake==taken){\n\t\treturn curVal;\n\t}\n\tlong long nxtVal=curVal+vals[id];\n//\tprintf(\"nxt=%lld\\n\",nxtVal);\n\tlong long res=-1;\n\tif(nxtVal>M){\n\t\tres=dfs(id-1,toTake,taken,curVal,flg);\n\t\treturn res;\n\t}\n\tif(flg==false){\n\t\t//not take\n\t\tres=dfs(id-1,toTake,taken,curVal,true);\n\t}\n\tlong long res2=dfs(id-1,toTake,taken+1,nxtVal,flg);\n\tres=max(res,res2);\n\treturn res;\n}\n\nlong long dfs2(int id,int toTake,int taken,long long curVal){\n\tif(id==-1){\n\t\tif(toTake!=taken) return -1;\n\t\treturn curVal;\n\t}\n\tlong long nxtVal=curVal+vals[id];\n\tif(toTake==taken+id+1){\n\t\tlong long tmp=dfs2(id-1,toTake,taken+1,nxtVal);\n\t\treturn tmp;\n\t}\n\tlong long notTake=curVal;\n\tfor(int i=1;i<=toTake-taken;i++){\n\t\tnotTake+=vals[id-i];\n\t}\n\tlong long res;\n\tif(notTake>=M){\n\t\tres=dfs2(id-1,toTake,taken,curVal);\n\t}else{\n\t\tres=dfs2(id-1,toTake,taken+1,nxtVal);\n\t}\n\treturn res;\n}\n\nlong long mult(long long a,long long b,long long c){\n\tlong long x=c/a;\n\tif(b>x) return -1;\n\tlong long res=a*b;\n\tif(res>c) return -1;\n\treturn res;\n}\n\nint main(){\n\tlong long a,b,p,q;\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&N,&M,&a,&b,&p,&q);\n\tif(a==1&&b==1){\n\t\tlong long x=p+q;\n\t\tlong long num=M/x;\n\t\tnum=min(num,N);\n\t\tlong long train=x*num;\n\t\tlong long ans=M-train;\n\t\tif(num+1<=N){\n\t\t\ttrain+=x;\n\t\t\tans=min(ans,train-M);\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t\treturn 0;\n\t}\n\tlong long pa=1,pb=1;\n\tint n=0;\n\tfor(int i=0;i<N;i++){\n\t\tlong long cur1=mult(pa,p,M);\n\t\tlong long cur2=mult(pb,q,M);\n\t\tif(cur1==-1||cur2==-1) break;\n\t\tlong long cur=cur1+cur2;\n\t\tif(cur>M) break;\n\t\tvals[n++]=cur;\n\t\tpa=mult(pa,a,M);\n\t\tpb=mult(pb,b,M);\n\t\tif(pa==-1||pb==-1) break;\n\t}\n\tif(n==0){\n\t\tprintf(\"%lld\\n\",M);\n\t\treturn 0;\n\t}\n//\tfor(int i=0;i<n;i++){\n//\t\tprintf(\"%d %lld\\n\",i,vals[i]);\n//\t}\n\tN=n;\n\tlong long ans=M;\n\tfor(int i=1;i<=n;i++){\n\t\tlong long tmp=dfs(n-1,i,0,0,false);\n//\t\tprintf(\"%d %lld\\n\",i,tmp);\n\t\tif(tmp==-1) continue;\n\t\tans=min(ans,M-tmp);\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tlong long tmp=dfs2(n-1,i,0,0);\n\t\tif(tmp==-1) continue;\n\t\tans=min(ans,tmp-M);\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "// g++ -std=c++11 a.cpp\n#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>   \n#include<map>\n#include<set>\n#include<unordered_map>\n#include<utility>\n#include<cmath>\n#include<random>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<bitset>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#include<typeinfo>\n#define loop(i,a,b) for(ll i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define FOR(i,a) for(auto i:a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n#define show1d(v) rep(i,v.size())cout<<\" \"<<v[i];cout<<endl<<endl;\n#define show2d(v) rep(i,v.size()){rep(j,v[i].size())cout<<\" \"<<v[i][j];cout<<endl;}cout<<endl;\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\n//#define int ll\ntypedef ll Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n#define mt make_tuple\ntypedef tuple<int,int,int,int> tp;\ntypedef vector<tp> vt;\ntemplate<typename A,typename B>bool cmin(A &a,const B &b){return a>b?(a=b,true):false;}\ntemplate<typename A,typename B>bool cmax(A &a,const B &b){return a<b?(a=b,true):false;}\n//template<class C>constexpr int size(const C &c){return (int)c.size();}\n//template<class T,size_t N> constexpr int size(const T (&xs)[N])noexcept{return (int)N;}\nconst double PI=acos(-1);\nconst double EPS=1e-9;\nDef inf = sizeof(Def) == sizeof(long long) ? 2e18 : 1e9+10;\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\nint main(){\n\tll n,m,a,b,p,q;\n\tcin>>n>>m>>a>>b>>p>>q;\n\tif(a+b==2){\n\t\tll t=p+q;\n\t\tll T=min(n,m/t);\n\t\tll out=m;\n\t\tloop(i,max(0ll,T-10),min(n+1,T+10))\n\t\t\tout=min(out,abs(t*i-m));\n\t\tcout<<out<<endl;\n\t\treturn 0;\n\t}\n\tvi A,B;\n\tll t=p;\n\tint co=0;\n\twhile(1){\n\t\tA.pb(t);\n\t\tif(to_string(t).size()+to_string(a).size()>16)break;\n\t\tt*=a;\n\t\tif(a==1&&co==40)break;\n\t\tco++;\n\t}\n\tt=q;\n\tco=0;\n\twhile(1){\n\t\tB.pb(t);\n\t\tif(to_string(t).size()+to_string(b).size()>16)break;\n\t\tt*=b;\n\t\tif(b==1&&co==40)break;\n\t\tco++;\n\t}\n\t//show1d(A);\n\t//show1d(B);\n\tvi in;\n\trep(i,min((ll)A.size(),n))\n\t\tif(i<B.size()&&A[i]+B[i]<=3*m)in.pb(A[i]+B[i]);\n\tn=in.size()/2;\n\tll N=1<<n;\n\tvi dp;\n\trep(i,N){\n\t\tll sum=0;\n\t\trep(j,n)if(i&1<<j)sum+=in[j];\n\t\tif(sum<=3*m)dp.pb(sum);\n\t}\n\tsort(all(dp));\n\tll nn=in.size()-n;\n\tN=1<<nn;\n\tll out=m;\n//\tshow1d(in);\n\trep(i,N){\n\t\tll sum=0;\n\t\trep(j,nn)if(i&1<<j)sum+=in[n+j];\n\t\tif(sum>3*m)continue;\n\t\tauto it=upper_bound(all(dp),m-sum);\n\t\tif(it!=dp.end())out=min(out,abs(*it+sum-m));\n\t\tif(it==dp.begin())continue;\n\t\tit--;\n\t\tout=min(out,abs(*it+sum-m));\n\t}\n//\tshow1d(dp);\n\tcout<<out<<endl;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nbool ch(int a,int b){\n  int x=1000000000000000LL;\n  x/=a;\n  x/=b;\n  return x==0;\n}\nsigned main(){\n  int n,m,a,b,p,q;\n  cin>>n>>m>>a>>b>>p>>q;\n  if(a==1&&b==1){\n    //cout<<m%(p+q)<<endl;\n    if(ch(n,p+q)) cout<<m%(p+q)<<endl;\n    else{\n      int t=n*(p+q);\n      if(m>=t) cout<<m-t<<endl;\n      else cout<<m%(p+q)<<endl;\n    }\n    return 0;\n  }\n  int ta=1,tb=1;\n  vector<int> v;\n  for(int i=0;i<n;i++){\n    if(ch(p,ta)) break;\n    if(ch(q,tb)) break;\n    int t=p*ta+q*tb;\n    //cout<<t<<endl;\n    if(t<=m) v.push_back(t);\n    else break;\n    if(ch(ta,a)) break;\n    if(ch(tb,b)) break;\n    ta*=a;tb*=b;\n  }\n  int x=v.size();\n  int y=x/2;\n  set<int> s;\n  int ans=m;\n  for(int i=0;i<(1<<y);i++){\n    int t=0;\n    for(int j=0;j<y;j++) if((i>>j)&1) t+=v[j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }    \n    //cout<<t<<endl;\n    s.insert(-t);\n    ans=min(ans,m-t);\n  }\n  \n  for(int i=0;i<(1<<(x-y));i++){\n    int t=0;\n    for(int j=0;j<(x-y);j++) if((i>>j)&1) t+=v[y+j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }\n    //cout<<t<<endl;\n    ans=min(ans,m-t);\n    int u=t-m;\n    int k=*s.lower_bound(u);\n    ans=min(ans,m-(t-k));\n  }\n  \n  s.clear();\n  for(int i=0;i<(1<<y);i++){\n    int t=0;\n    for(int j=0;j<y;j++) if((i>>j)&1) t+=v[j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }    \n    //cout<<t<<endl;\n    s.insert(t);\n    ans=min(ans,m-t);\n  }\n  \n  int inf=m*2;\n  s.insert(inf);\n  for(int i=0;i<(1<<(x-y));i++){\n    int t=0;\n    for(int j=0;j<(x-y);j++) if((i>>j)&1) t+=v[y+j];\n    if(t>m){\n      ans=min(ans,t-m);\n      continue;\n    }\n    //cout<<t<<endl;\n    ans=min(ans,m-t);\n    int v=m-t;\n    int l=*s.lower_bound(v);\n    if(l!=inf) ans=min(ans,(t+l)-m);\n  }\n  //assert(ans>=0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return min( m%total , m-m%total);\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n  for(int i=0;i< min(n,40) ;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        res=min( res, abs( m- ( T[i]+U[j] )) );      \n      }\n    }\n  }\n  \n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=__int128;\n\nusing ll2=long long;\n\nconst ll INF=1e15;\n\nll powi(ll x,ll k){\n    ll res=1;\n    while(k){\n        if(k&1) res*=x;\n        if(res>INF) return INF;\n        x*=x;\n        k>>=1;\n    }\n    return res;\n}\nint main(){\n    ll2 nn,mm,aa,bb,pp,qq;\n    cin>>nn>>mm>>aa>>bb>>pp>>qq;\n    ll n=nn,m=mm,a=aa,b=bb,p=pp,q=qq;\n    if(a>=2 || b>=2){\n        int tn=min(n,ll(41));\n        int half=min((tn*2)/3,22);\n        vector<ll> vec(1<<half);\n        for(int i=0;i<(1<<half);i++){\n            ll val=0;\n            for(int j=0;j<half;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,j)+q*powi(b,j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            vec[i]=val;\n\n        }\n        int rest=tn-half;\n        set<ll> s;\n        for(int i=0;i<(1<<rest);i++){\n            ll val=0;\n            for(int j=0;j<rest;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,half+j)+q*powi(b,half+j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            s.insert(val);\n        }\n        ll2 res=m;\n        for(int i=0;i<vec.size();i++){\n            auto it=s.lower_bound(m-vec[i]);\n            if(it!=s.end()){\n        \n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n            if(it!=s.begin()){\n                it--;\n\n                res=min(res,abs(ll2(m-vec[i]-*it)));\n            }\n        }\n        cout<<res<<endl;\n    }\n    else{\n        if((p+q)*n>=m){\n            cout<<ll2(min(m%(p+q),(p+q)-m%(p+q)))<<endl;\n        }\n        else{\n            cout<<ll2(m-(p+q)*n)<<endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return min( m%d , m-m%d);\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n  if(n>40){\n    assert(0);\n  }\n  \n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        res=min( res, abs( m- ( T[i]+U[j] )) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 1LL<<45;\nll Sum[100],n,m,a,b,p,q;\n\nll calc(ll k){\n  ll A = 1,B = 1,res=p+q;\n  while(res>0&&res<=INF&&k--)A*=a,B*=b,res=p*A+q*B;\n  if(res<0) res = INF;\n  return min(INF,res);\n}\n\nll ans = INF;\nset<ll> used[101];\nvoid dfs(ll pos,ll sum){\n  ans = min(ans,(ll)abs(m-sum));\n  if(m<sum||pos==-1||sum>INF||used[pos].count(sum)) return;\n  used[pos].insert(sum);\n  \n  if(Sum[pos]+sum<m){ans=min(ans,m-(Sum[pos]+sum));return;}\n  dfs(pos-1,sum+calc(pos));  \n  dfs(pos-1,sum);\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  Sum[0] = calc(0);\n  for(int i=1;i<60;i++)Sum[i]=min(INF,calc(i)+Sum[i-1]);\n\n  if(max(a,b)==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - (p+q));\n    if(m/(p+q)==n) t = INF;\n    if(m/(p+q)<=n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n  }\n  dfs(min(n-1,50LL),0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nsigned main(){\n\tint n,m,a,b,p,q,mi;\n\tvector<int> vec,num;\n\tcin >> n >> m >> a >> b >> p >> q;\n\tmi = m;\n\tif(a == 1 && b == 1){\n\t\tif(p + q >= (m + n - 1) / n) cout << min(m % (p + q),p + q - m % (p + q)) << endl;\n\t\telse cout << m - (p + q) * n << endl;\n\t\treturn 0;\n\t}\n\tint ta = p,tb = q;\n\tfor(int i = 0;i < n;i++){\n\t\tif(ta + tb > m) break;\n\t\tvec.push_back(ta + tb);\n\t\tif(ta > (m + a - 1) / a || tb > (m + b - 1) / b) break;\n\t\tta *= a;\n\t\ttb *= b;\n\t}\n\tn = vec.size();\n\tfor(int i = 0;i < (1 << (n / 2));i++){\n\t\tint sum = 0;\n\t\tfor(int j = 0;j < n / 2;j++){\n\t\t\tif((i >> j) & 1) sum += vec[j];\n\t\t}\n\t\tnum.push_back(sum);\n\t}\n\tsort(num.begin(),num.end());\n\tfor(int i = 0;i < (1 << ((n + 1) / 2));i++){\n\t\tint sum = 0;\n\t\tfor(int j = 0;j < (n + 1) / 2;j++){\n\t\t\tif((i >> j) & 1) sum += vec[j + n / 2];\n\t\t}\n\t\tint ind = upper_bound(num.begin(),num.end(),m - sum) - num.begin() - 1;\n\t\tif(ind >= 0) mi = min(mi,m - sum - num[ind]);\n\t\tif(ind + 1 < n) mi = min(mi,-(m - sum - num[ind + 1]));\n\t}\n\tcout << mi << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return m%d;\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n    if(ak==INF||bk==INF)break;\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        ll c=T[i]+U[j];\n        res=min( res,  abs(m-c) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define EPS 1e-10\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;--i)\n#define srep(i,s,t) for(int i=(int)(s);i<(int)(t);++i)\n#define each(a,b) for(auto (a): (b))\n#define all(v) (v).begin(),(v).end()\n#define len(v) (int)(v).size()\n#define zip(v) sort(all(v)),v.erase(unique(all(v)),v.end())\n#define cmx(x,y) x=max(x,y)\n#define cmn(x,y) x=min(x,y)\n#define fi first\n#define se second\n#define pb push_back\n#define show(x) cout<<#x<<\" = \"<<(x)<<endl\n#define spair(p) cout<<#p<<\": \"<<p.fi<<\" \"<<p.se<<endl\n#define svec(v) cout<<#v<<\":\";rep(kbrni,v.size())cout<<\" \"<<v[kbrni];cout<<endl\n#define sset(s) cout<<#s<<\":\";each(kbrni,s)cout<<\" \"<<kbrni;cout<<endl\n#define smap(m) cout<<#m<<\":\";each(kbrni,m)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n\nusing namespace std;\n\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<P> vp;\ntypedef vector<string> vs;\n\nconst int MAX_N = 100005;\n\nll lpa[40],lpb[40];\ndouble dpa[40],dpb[40];\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    ll n,m,a,b,p,q;\n    cin >> n >> m >> a >> b >> p >> q;\n    if(a == 1 && b == 1){\n        ll cnt = m/(p+q);\n        cout << m-min(n,cnt)*(p+q) << \"\\n\";\n    }else{\n        ll mid = 20;\n        lpa[0] = lpb[0] = dpa[0] = dpb[0] = 1;\n        rep(i,2*mid-1){\n            lpa[i+1] = lpa[i] * a;\n            lpb[i+1] = lpb[i] * b;\n            dpa[i+1] = dpa[i] * a;\n            dpb[i+1] = dpb[i] * b;\n        }\n        vl u,v;\n        rep(i,(1 << mid)){\n            ll val1 = 0,val2 = 0;\n            double ch1 = 0,ch2 = 0;\n            rep(j,mid){\n                if((i >> j) & 1){\n                    val1 += p*lpa[j] + q*lpb[j];\n                    val2 += p*lpa[mid+j] + q*lpb[mid+j];\n                    ch1 += p*dpa[j] + q*dpb[j];\n                    ch2 += p*dpa[mid+j] + q*dpb[mid+j];\n                }\n            }\n            if(ch1 <= m){\n                u.pb(val1);\n                if(ch2 <= m){\n                    v.pb(val2);\n                }\n            }\n        }\n        ll mn = (1LL << 60);\n        rep(i,len(u)){\n            int id = upper_bound(all(v),m-u[i]) - v.begin();\n            if(id > 0){\n                cmn(mn,m-(u[i]+v[id]));\n            }\n        }\n        cout << mn << \"\\n\";\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dist[40];\nint main(){\n\tint a,b,c,d,e,f;\n\tscanf(\"%d%d%d%d%d%d\",&a,&b,&c,&d,&e,&f);\n\tif(c==1&&d==1){\n\t\tint v=b%(e+f);\n\t\tint g=b/(e+f);\n\t\tprintf(\"%d\\n\",v+max(0,g-a));\n\t\treturn 0;\n\t}\n\tint sz=0;\n\tfor(int i=0;i<a;i++){\n\t\tlong long L=e;\n\t\tlong long R=f;\n\t\tfor(int j=0;j<i;j++)L*=c;\n\t\tfor(int j=0;j<i;j++)R*=d;\n\t\tlong long t=L+R;\n\t\tif(t>b)break;\n\t\tdist[sz++]=t;\n\t}\n\tif(d==1){\n\t\tswap(c,d);\n\t\tswap(e,f);\n\t}\n\tif(c==1){\n\t\tlong long ret=b;\n\t\tfor(int i=0;i<sz;i++)dist[i]-=e;\n\t\tfor(int i=0;i<=sz;i++){\n\t\t\tlong long tmp=b-(long long)i*e;\n\t\t\tif(tmp<0)break;\n\t\t\tint rem=i;\n\t\t\tfor(int j=sz-1;j>=0;j--){\n\t\t\t\tif(tmp>=dist[j]){\n\t\t\t\t\trem--;\n\t\t\t\t\ttmp-=dist[j];\n\t\t\t\t}\n\t\t\t\tif(rem==0)break;\n\t\t\t}\n\t\t\tret=min(ret,tmp);\n\t\t}\n\t\tprintf(\"%lld\\n\",ret);\n\t\treturn 0;\n\t}\n\tlong long ret=b;\n\tfor(int i=sz-1;i>=0;i--){\n\t\tif(ret>=dist[i])ret-=dist[i];\n\t}\n\tprintf(\"%lld\\n\",ret);\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dist[40];\nint main(){\n\tint a,b,c,d,e,f;\n\tscanf(\"%d%d%d%d%d%d\",&a,&b,&c,&d,&e,&f);\n\tif(c==1&&d==1){\n\t\tint v=b%(e+f);\n\t\tint g=b/(e+f);\n\t\tprintf(\"%d\\n\",v+max(0,g-a));\n\t\treturn 0;\n\t}\n\tint sz=0;\n\tfor(int i=0;i<=a;i++){\n\t\tlong long L=e;\n\t\tlong long R=f;\n\t\tfor(int j=0;j<i;j++)L*=c;\n\t\tfor(int j=0;j<i;j++)R*=d;\n\t\tlong long t=L+R;\n\t\tif(t>b)break;\n\t\tdist[sz++]=t;\n\t//\tprintf(\"%lld \",dist[sz-1]);\n\t}\n\tif(d==1){\n\t\tswap(c,d);\n\t\tswap(e,f);\n\t}\n\tif(c==1){\n\t\tlong long ret=b;\n\t\tfor(int i=0;i<sz;i++)dist[i]-=e;\n\t\tfor(int i=0;i<=sz;i++){\n\t\t\tlong long tmp=b-(long long)i*e;\n\t\t\tif(tmp<0)break;\n\t\t\tint rem=i;\n\t\t\tfor(int j=sz-1;j>=0;j--){\n\t\t\t\tif(tmp>=dist[j]){\n\t\t\t\t\trem--;\n\t\t\t\t\ttmp-=dist[j];\n\t\t\t\t}else{\n\t\t\t\t\tlong long cost=dist[j]-tmp;\n\t\t\t\t\tif(rem-1<=j){\n\t\t\t\t\t\tfor(int k=0;k<rem-1;k++){\n\t\t\t\t\t\t\tcost+=dist[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tret=min(ret,cost);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(rem==0)break;\n\t\t\t}\n\t\t\tret=min(ret,tmp);\n\t\t}\n\t\tprintf(\"%lld\\n\",ret);\n\t\treturn 0;\n\t}\n\tlong long ret=b;\n\tlong long tmp=b;\n\tfor(int i=sz-1;i>=0;i--){\n\t\tif(tmp>=dist[i])tmp-=dist[i];\n\t\telse ret=min(ret,dist[i]-tmp);\n\t\tret=min(ret,tmp);\n\t}\n\tprintf(\"%lld\\n\",ret);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define N 41\nusing namespace std;\ntypedef long long ll;\nll n,m,a,b,p,q,d;\nvector<ll> v[2],x[2];\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  ll ti=min(n,m/(p+q));\n  ll ans=m;\n  if(a==1&&b==1)\n    ans=min(ans,min(m-ti*(p+q),\n\t\t    abs(min(ti+1,n)*(p+q)-m)));\n  ll A=1,B=1,T=min((ll)N,n);\n  for(int i=0;i<T;i++){\n    d=p*A+q*B;\n    if(i<T/2)v[0].push_back(d);\n    else v[1].push_back(d);\n    if(d>m)break;\n    A*=a,B*=b;\n  }\n  int len[2]={v[0].size(),v[1].size()};\n  for(int i=0;i<2;i++){\n    v[i].push_back(0);\n    for(int j=0;j<(1<<len[i]);j++){\n      ll sum=0;\n      for(int k=0;k<len[i];k++)\n\tif((j&(1<<k)))sum+=v[i][k];\n      x[i].push_back(sum);\n    }\n    sort(x[i].begin(),x[i].end());\n  }\n  for(int i=0;i<x[0].size();i++){\n    ll S=m-x[0][i];\n    vector<ll>::iterator r=lower_bound(x[1].begin(),x[1].end(),S);\n    if(r!=x[1].end())ans=min(ans,(*r)-S);\n    if(r!=x[1].begin())ans=min(ans,S-(*(r-1)));\n  }\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cmath>\n#include <algorithm>\n#include <utility>\n#include <queue>\n#include <set>\n#include <map>\n\nusing namespace std;\ntypedef  long long ll;\ntypedef pair<int,int> PII;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\n#define  MP make_pair\n#define  PB push_back\n#define inf  1000000007\n\n\nint main(){\n\tll n,m,a,b,p,q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\tif(a==1&&b==1){\n\t\tll ans = m;\n\t\tll x = p+q;\n\t\tll y = m/x;\n\t\tif(y>=n){\n\t\t\tans = min(ans,m-x*n);\n\t\t\tcout << ans << endl;\n\t\t}else{\n\t\t\tans = min(ans,m-(x*y));\n\t\t\tans = min(ans,x-ans);\n\t\t\tcout << ans << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\tvector<ll> r1,r2;\n\tr1.push_back(1);\n\tr2.push_back(1);\n\tif(p+q >= m){\n\t\tcout << min(m,p+q-m) << endl;\n\t\treturn 0;\n\t}\n\tfor(int i=1;i<n;i++){\n\t\tr1.PB(r1[i-1]*a);\n\t\tr2.PB(r2[i-1]*b);\n\t\tif(p*r1[i]+q*r2[i]>=m){\n\t\t\tn=i+1;\n\t\t}\n\t}\n\tll ans=m;\n\tif(p*r1[n-1]+q*r2[n-1]>=m){\n\t\tans = min(ans,p*r1[n-1]+q*r2[n-1]-m);\n\t\tn--;\n\t}\n\tvector<ll> s1,s2,t1,t2;\n\tconst ll mae = n/2;\n\tconst ll usi = n - mae;\n\tfor(int i=0;i<n/2;i++){\n\t\ts1.push_back(p*r1[i]+q*r2[i]);\n\t}\n\tfor(int i=n/2;i<n;i++){\n\t\ts2.push_back(p*r1[i]+q*r2[i]);\t\n\t}\n\t/*for(int i=0;i<mae;i++){\n\t\tcout << s1[i] << endl;\n\t}\n\tcout << endl;\n\tfor(int i=0;i<usi;i++){\n\t\tcout << s2[i] << endl;\n\t}*/\n\tfor(ll i=0;i<(1LL<<(mae));i++){\n\t\tll s = 0;\n\t\tfor(ll j=0;j<mae;j++){\n\t\t\tif(i&(1LL<<j)){\n\t\t\t\ts += s1[j];\n\t\t\t}\n\t\t}\n\t\tt1.push_back(s);\n\t}\n\tfor(ll i=0;i<(1LL<<(usi));i++){\n\t\tll s = 0;\n\t\tfor(ll j=0;j<usi;j++){\n\t\t\tif(i&(1LL<<j)){\n\t\t\t\ts += s2[j];\n\t\t\t}\n\t\t}\n\t\tt2.push_back(s);\n\t}\n\tsort(t1.begin(),t1.end());\n\tsort(t2.begin(),t2.end());\n\t/*for(int i=0;i<t1.size();i++){\n\t\tcout << t1[i] << endl;\n\t}\n\tfor(int i=0;i<t2.size();i++){\n\t\tcout << t2[i] << endl;\n\t}*/\n\tfor(int i=0;i<t1.size();i++){\n\t\tint k = lower_bound(t2.begin(),t2.end(),m-t1[i])-t2.begin()-1;\n\t\tans = min(ans,abs(m-t1[i]-t2[k]));\n\t\tif(k+1<t2.size()){\n\t\t\tans = min(ans,abs(m-t1[i]-t2[k+1]));\n\t\t}\t\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  if(a==1 && b==1){\n    \n    ll d=p+q;\n    ll total=d*n;\n    \n    if(total <= m)return m-total;\n    return min( m%d , m-(m%d) );\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        res=min( res, abs( m- ( T[i]+U[j] )) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cmath>\n#include <vector>\n#include <algorithm>\n\n#define rep(i,n) for(int i = 0; i < n; ++i)\nusing namespace std;\n\nusing ll = long long;\nusing R = long double;\n\nint main(void){\n\tll n,m,a,b,p,q;\n\tcin >> n >> m >> a >> b >> p >> q;\n\n\tif(a == 1 and b == 1){\n\t\tll ticket = p + q;\n\t\tconst ll used = min(n,m/ticket);\n\t\tconst ll ans = m - ticket * used;\n\t\tcout << ans << endl;\n\t\treturn 0;\n\t}\n\n\tvector<ll> ticket;\n\tn = min(n,40LL);\n\n\trep(i,n){\n\t\tll cur = p * pow<ll>(a,i) + q * pow<ll>(b,i);\n\t\tif(1.0 * p * pow<R>(a,i) + 1.0 * q * pow<R>(b,i) > 1e18) break;\n\t\tif(cur > m) break;\n\t\tticket.push_back(cur);\n\t}\n\n\tn = ticket.size();\n\n\tvector<ll> item[2];\n\tconst int half[2] = {n/2,n-n/2};\n\tconst int offset[2] = {0,n/2};\n\n\trep(k,2)rep(mask,1 << half[k]){\n\t\tll cur = 0LL;\n\t\trep(i,half[k]) if(mask & (1 << i)) cur += ticket[i+offset[k]];\n\t\titem[k].push_back(cur);\n\t}\n\n\t\n\tll ans = m;\n\tsort(begin(item[1]),end(item[1]));\n\t\n\n\n\tfor(auto &it:item[0]){\n\t\tconst ll arg = m - it;\n\t\tauto it2 = upper_bound(begin(item[1]),end(item[1]),arg);\n\t\tit2--;\n\t\tans = min(ans, m - it - *it2);\n\t}\n\n\tcout << ans << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = m;\nE:;\n\td = n;\n\trem = m - c[d - 1];\n\tminx = min(minx, abs(rem));\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll n,m,a,b,p,q,s[50],g;\nvector<ll> v[2];\n\nvoid dfs(int f,ll pos,ll ss,ll e){\n  if(ss>m)return;\n  if(pos==e){\n    v[f].push_back(ss);\n    return;\n  }\n  ll ns=s[pos]+ss;\n  dfs(f,pos+1,ss,e);\n  dfs(f,pos+1,ns,e);\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  if(b==1&&a==1){\n    if(m/(p+q)>n)cout<<m-(p+q)*n<<endl;\n    else cout<<m%(p+q)<<endl;    \n  }\n  else{\n    for(ll i=0,x=p,y=q;i<n;i++,x*=a,y*=b){\n      ll ss=x+y;\n      if(ss>m)break;\n      s[g++]=ss;\n    }\n    v[0].push_back(0);\n   v[1].push_back(0);\n    dfs(0,0,0,g/2);\n    dfs(1,g/2,0,g);\n    ll ans=m;\n    sort(v[1].begin(),v[1].end());\n    for(int i=0;i<v[0].size();i++){\n      int l=0,M,r=v[1].size();\n      while(l<r){\n\tM=(l+r)/2;\n\tif(v[0][i]+v[1][M]<=m)l=M+1;\n\telse r=M;\n      }\n      ans=min(ans,m-v[0][i]-v[1][r-1]);\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll INF = 1LL<<53;\nll Sum[100];\nll n,m,a,b,p,q;\n\n\nll calc(ll k){\n  ll A = 1,B = 1,res=p+q;\n  while(0<res&&res<=INF&&k--)A*=a,B*=b,res=p*A+q*B;\n  return min(INF,res);\n}\n\nll ans = INF;\nset<ll> used[101];\nvoid dfs(ll pos,ll sum){\n  ans = min(ans,(ll)abs(m-sum));\n  if(m<sum||pos==-1||sum>INF) return;\n  if(Sum[pos]+sum<m){ans=min(ans,m-(Sum[pos]+sum));return;}\n  if(used[pos].count(sum)) return ;\n  used[pos].insert(sum);\n  dfs(pos-1,sum+calc(pos));  \n  dfs(pos-1,sum);\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  Sum[0] = calc(0);\n  for(int i=1;i<60;i++)Sum[i]=min(INF,calc(i)+Sum[i-1]);\n\n  /*  if(max(a,b)==1) {\n    ll s = abs(m - (m/(p+q))*(p+q));\n    ll t = abs(m - (m/(p+q))*(p+q) - (p+q));\n    if(m/(p+q)==n) t = INF;\n    if(m/(p+q)<=n) cout<<min(s,t)<<endl;\n    else cout<< m-(p+q)*n <<endl;\n    return 0;\n    }*/\n  \n  dfs(min(n-1,50LL),0);\n  cout<<ans<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <queue>\n#include <map>\n#include <set>\n#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <cassert>\nusing namespace std;\n\ntypedef long long ll;\n\n#define REP(i, n) for (ll i = 0; i < (ll)(n); ++i)\n#define FOR(i, a, b) for (ll i = (a); i < (ll)(b); ++i)\n#define FOREQ(i, a, b) for (ll i = (a); i <= (ll)(b); ++i)\n#define DEC(i, k) for (ll i = (k); i >= 0; --i)\n#define FORIT(i, c) for (__tyoeof((c).begin()) i = (c).begin(); i != (c).end(); ++i)\n#define SZ(v) (ll)((v).size())\n#define MEMSET(v, h) memset((v), (h), sizeof(v))\n#define FIND(m, w) ((m).find(w) != (m).end())\n#define ALL(c) (c).begin(), (c).end()\n\nll ticket[1000];\nll ticketSum[1000];\nll n, m, a, b, p, q;\nll cnt;\n\nll calc(ll depth, ll lm) {\n  if (depth == cnt || lm <= 0) { return abs(lm); }\n  if (ticketSum[depth] < lm) { return abs(lm - ticketSum[depth]); }\n  ll ret = m;\n  ret = min(ret, calc(depth + 1, lm));\n  ret = min(ret, calc(depth + 1, lm - ticket[depth]));\n  return ret;\n}\n\nint main() {\n  cin >> n >> m >> a >> b >> p >> q;\n  if (a == 1 && b == 1) {\n    ll use = m / (p + q);\n    use = min(use, n - 1);\n    printf(\"%lld\\n\", min(m - use * (p + q), abs(m - (use + 1) * (p + q))));\n    return 0;\n  }\n  cnt = 0;\n  {\n    ll left = p;\n    ll right = q;\n    REP(i, n) {\n      if (left + right > 2 * m) { break; }\n      ticket[cnt++] = left + right;\n      ll pleft = left;\n      ll pright = right;\n      left *= a;\n      right *= b;\n      if (left / a != pleft || right / b != pright) { break; }\n    }\n  }\n  reverse(ticket, ticket + cnt);\n  MEMSET(ticketSum, 0);\n  for (ll i = cnt; i > 0; i--) {\n    ticketSum[i - 1] = ticket[i - 1] + ticketSum[i];\n  }\n  ll ans = calc(0, m);\n  printf(\"%lld\\n\", ans);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=__int128;\n\nusing ll2=long long;\n\nconst ll INF=1e15;\n\nll powi(ll x,ll k){\n    ll res=1;\n    while(k){\n        if(k&1) res*=x;\n        if(res>INF) return INF;\n        x*=x;\n        k>>=1;\n    }\n    return res;\n}\nint main(){\n    ll2 nn,mm,aa,bb,pp,qq;\n    cin>>nn>>mm>>aa>>bb>>pp>>qq;\n    ll n=nn,m=mm,a=aa,b=bb,p=pp,q=qq;\n    if(a>=2 || b>=2){\n        int tn=min(n,ll(44));\n        int half=tn/2;\n        vector<ll> vec(1<<half);\n        for(int i=0;i<(1<<half);i++){\n            ll val=0;\n            for(int j=0;j<half;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,j)+q*powi(b,j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            vec[i]=val;\n\n        }\n        int rest=tn-half;\n        set<ll> s;\n        for(int i=0;i<(1<<rest);i++){\n            ll val=0;\n            for(int j=0;j<rest;j++){\n                if((i>>j)&1){\n                    val+=p*powi(a,half+j)+q*powi(b,half+j);\n                }\n                if(val>=INF){\n                    break;\n                }\n            }\n            s.insert(val);\n        }\n        ll res=m;\n        for(int i=0;i<vec.size();i++){\n            auto it=s.lower_bound(m-vec[i]);\n            if(it!=s.end()){\n        \n                res=min(res,abs(m-vec[i]-*it));\n            }\n            if(it!=s.begin()){\n                it--;\n\n                res=min(res,abs(m-vec[i]-*it));\n            }\n        }\n        cout<<ll2(res)<<endl;\n    }\n    else{\n        if((p+q)*n>=m){\n            cout<<ll2(min(m%(p+q),(p+q)-m%(p+q)))<<endl;\n        }\n        else{\n            cout<<ll2(m-(p+q)*n)<<endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = m;\n\td = s;\nE:;\n\trem = m - c[d - 1];\n\tminx = min(minx, abs(rem));\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll INF=10000000000000000LL;\n\nll mul(ll a,ll b){\n  if(a>INF/b)return INF;\n  return a*b;\n}\n\nll n,m,a,b,p,q;\n\nvoid dfs(ll x,ll sum,vector<ll> &t,vector<ll> &T){\n  if(x==(int)t.size()){\n    T.push_back(sum);\n  }else{\n    dfs(x+1,sum,t,T);\n    dfs(x+1,min(INF,sum+t[x]),t,T);\n  }\n}\n\nll solve(){\n  ll MAX=1000000000000LL;\n  \n  assert( 1<= n &&n <= MAX );\n  assert( 1<= m &&m <= MAX );\n  assert( 1<= a &&a <= MAX );\n  assert( 1<= b &&b <= MAX );\n  assert( 1<= p &&p <= MAX );\n  assert( 1<= q &&q <= MAX );\n  \n  if(a==1 && b==1){\n    ll d=p+q;\n    ll total=mul(d,n);\n    if(total <= m)return m-total;\n    return m%d;\n  }\n  \n  vector<ll> t, u;\n  ll ak=1,bk=1;\n\n\n  for(int i=0;i<n;i++){\n    if(i&1)t.push_back( mul(ak,p) + mul(bk,q) );\n    else   u.push_back( mul(ak,p) + mul(bk,q) );\n    ak=mul(ak,a);\n    bk=mul(bk,b);\n    if(ak==INF||bk==INF)break;\n  }\n  \n  vector<ll> T,U;\n  dfs(0,0,t,T);\n  dfs(0,0,u,U);\n    \n  sort(T.begin(),T.end());\n  sort(U.begin(),U.end());\n  \n  ll res=m;\n  for(int i=0;i<(int)T.size();i++){\n    ll target=m-T[i];\n    int index=lower_bound(U.begin(),U.end(),target)-U.begin();\n    for(int j=index-2;j<=index+2;j++){\n      if(0<=j && j<(int)U.size()){\n        ll c=T[i]+U[j];\n        res=min( res,  abs(m-c) );      \n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  cin>>n>>m>>a>>b>>p>>q;\n  cout<<solve()<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define MOD 1000000007ll\n#define INF 1000000000ll\n#define EPS 1e-10\n#define FOR(i,n,m) for(ll i=n;i<(ll)m;i++)\n#define REP(i,n) FOR(i,0,n)\n#define DUMP(a) REP(d,a.size()){cout<<a[d];if(d!=a.size()-1)cout<<\" \";else cout<<endl;}\n#define ALL(v) v.begin(),v.end()\n#define UNIQUE(v) sort(ALL(v));v.erase(unique(ALL(v)),v.end());\n#define pb push_back\n\nll _pow(ll a, ll n) {\n\tif(n == 0) return 1;\n\telse {\n\t\tll res = 1;\n\t\tll buf = a;\n\t\twhile(n > 0) {\n\t\t\tif(n % 2 == 1) {\n\t\t\t\tres *= buf;\n\t\t\t}\n\t\t\tbuf *= buf;\n\t\t\tn /= 2;\n\t\t}\n\t\treturn res;\n\t}\n}\n\nvoid solve() {\n\tll tmp1, tmp2, tmp3, tmp4, tmp5, tmp6;\n\tcin >> tmp1 >> tmp2 >> tmp3 >> tmp4 >> tmp5 >> tmp6;\n\t__int128 n, m, a, b, p, q;\n\tn = tmp1;\n\tm = tmp2;\n\ta = tmp3;\n\tb = tmp4;\n\tp = tmp5;\n\tq = tmp6;\n\t__int128 ans = m;\n\tif(n == 1) {\n\t\tans = min(m, abs((p + q) - m));\n\t\tcout << (ll)ans << endl;\n\t\treturn;\n\t}\n\t__int128 c = max(a, b);\n\tif(c == 1) {\n\t\tif((p + q) * n > m) {\n\t\t\tans = min(m - m / (p + q) * (p + q), (m / (p + q) + 1) * (p + q) - m);\n\t\t} else ans = m - (p + q) * n;\n\t} else if(c == 2 || c == 3) {\n\t\t__int128 _n = 0;\n\t\tif(c == 2) _n = min((__int128)41, n);\n\t\tif(c == 3) _n = min((__int128)29, n);\n\t\tll div1 = _n / 2;\n\t\tll div2 = _n - div1;\n\t\tvector<__int128> d1;\n\t\tvector<__int128> d2;\n\t\tREP(bit, (1ll << div1)) {\n\t\t\tbitset<31> bi(bit);\n\t\t\t__int128 sum = 0;\n\t\t\tREP(i, div1) if(bi[i]) sum += p * _pow(a, i) + q * _pow(b, i);\n\t\t\td1.pb(sum);\n\t\t}\n\t\tREP(bit, (1ll << div2)) {\n\t\t\tbitset<31> bi(bit);\n\t\t\t__int128 sum = 0;\n\t\t\tREP(i, div2) if(bi[i]) sum += p * _pow(a, div1 + i) + q * _pow(b, div1 + i);\n\t\t\td2.pb(sum);\n\t\t}\n\t\tsort(ALL(d1));\n\t\tsort(ALL(d2));\n\t\tREP(i, d1.size()) {\n\t\t\tauto ite = upper_bound(ALL(d2), m - d1[i]);\n\t\t\tif(ite != d2.end()) ans = min(ans, (d1[i] + *ite) - m);\n\t\t\tif(ite == d2.begin()) continue;\n\t\t\tite--;\n\t\t\tans = min(ans, m - (d1[i] + *ite));\n\t\t}\n\t} else /* c >= 4 */ {\n\t\tvector<__int128> num;\n\t\tnum.pb(0);\n\t\tnum.pb(p + q);\n\t\tREP(i, min((__int128)23, n - 1)) {\n\t\t\tif((__int128)1000000000007 / (ld)_pow(c, i) < c) break;\n\t\t\tll val = p * _pow(a, i + 1) + q * _pow(b, i + 1); \n\t\t\tvector<__int128> nnum = num;\n\t\t\tREP(j, num.size()) nnum.pb(num[j] + val);\n\t\t\tnum = nnum;\n\t\t}\n\t\tUNIQUE(num);\n\t\tREP(i, num.size()) ans = min(ans, (__int128)abs((ll)(m - num[i])));\n\t}\n\tcout << (ll)ans << endl;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tsolve();\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nlong long dist[40];\nint main(){\n\tlong long a,b,c,d,e,f;\n\tscanf(\"%lld%lld%lld%lld%lld%lld\",&a,&b,&c,&d,&e,&f);\n\tif(c==1&&d==1){\n\t\tlong long v=b%(e+f);\n\t\tlong long g=b/(e+f);\n\t\tprintf(\"%lld\\n\",v+max(0,g-a));\n\t\treturn 0;\n\t}\n\tint sz=0;\n\tfor(int i=0;i<=a;i++){\n\t\tlong long L=e;\n\t\tlong long R=f;\n\t\tfor(int j=0;j<i;j++)L*=c;\n\t\tfor(int j=0;j<i;j++)R*=d;\n\t\tlong long t=L+R;\n\t\tif(t>b)break;\n\t\tdist[sz++]=t;\n\t//\tprintf(\"%lld \",dist[sz-1]);\n\t}\n\tif(d==1){\n\t\tswap(c,d);\n\t\tswap(e,f);\n\t}\n\tif(c==1){\n\t\tlong long ret=b;\n\t\tfor(int i=0;i<sz;i++)dist[i]-=e;\n\t\tfor(int i=1;i<=sz;i++){\n\t\t\tlong long tmp=b-(long long)i*e;\n\t\t\tif(tmp<0)break;\n\t\t\tint rem=i;\n\t\t\tfor(int j=sz-1;j>=0;j--){\n\t\t\t\tif(tmp>=dist[j]){\n\t\t\t\t\trem--;\n\t\t\t\t\ttmp-=dist[j];\n\t\t\t\t}else{\n\t\t\t\t\tlong long cost=dist[j]-tmp;\n\t\t\t\t\tif(rem-1<=j){\n\t\t\t\t\t\tfor(int k=0;k<rem-1;k++){\n\t\t\t\t\t\t\tcost+=dist[k];\n\t\t\t\t\t\t}\n\t\t\t\t//\t\tprintf(\"%d %d: %lld\\n\",i,j,cost);\n\t\t\t\t\t\tret=min(ret,cost);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(rem==0)break;\n\t\t\t}\n\t\t\t\n\t\t\tif(rem==0)ret=min(ret,tmp);\n\t\t\t//printf(\"%d: %lld\\n\",i,ret);\n\t\t}\n\t\tprintf(\"%lld\\n\",ret);\n\t\treturn 0;\n\t}\n\tlong long ret=b;\n\tlong long tmp=b;\n\tfor(int i=sz-1;i>=0;i--){\n\t\tif(tmp>=dist[i])tmp-=dist[i];\n\t\telse ret=min(ret,dist[i]-tmp);\n\t\tret=min(ret,tmp);\n\t}\n\tprintf(\"%lld\\n\",ret);\n}\n//11 12 14 18"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s, B;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\n\tif (a >= 1000000000 && b >= 1000000000) {\n\t\tif (p >= 1000000000 && q >= 1000000000) {\n\t\t\tcout << min(m, abs(m - p - q)) << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << min(m, min(abs(m - p - q), min(abs(m - a * p - b * q), abs(m - a * p - b * q - p - q)))) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\n\tif (a == 1 && b == 1) {\n\t\tif (n >= 1000001 && (p + q) >= 1000001) { goto F; }\n\t\tif (m <= n * (p + q)) {\n\t\tF:;\n\t\t\tB = m % (p + q);\n\t\t\tif (B > (p + q) / 2) {\n\t\t\t\tB = (p + q) - B;\n\t\t\t}\n\t\t\tcout << B << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << m - (long long)(n * (p + q)) << endl;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = m;\n\td = s;\nE:;\n\trem = m - c[d - 1];\n\tminx = min(minx, abs(rem));\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\nlong long n, m, a, b, p, q, minx, d, s;\nlong long x[10000], y[10000], c[10000];\nlong long rem;\n\nint main() {\n\tcin >> n >> m >> a >> b >> p >> q;\n\tx[0] = 1; y[0] = 1;\n\ts = min((long long)10000, n);\n\tfor (int i = 1; i < s; i++) {\n\t\tx[i] = x[i - 1] * a;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 1; i < s; i++) {\n\t\ty[i] = y[i - 1] * b;\n\t\tif (x[i] > m) { break; }\n\t}\n\tfor (int i = 0; i < s; i++) {\n\t\tc[i] = p*x[i] + q*y[i];\n\t\tif (c[i] > m) {\n\t\t\td = i;\n\t\t\tminx = c[i] - m;\n\t\t\tgoto E;\n\t\t}\n\t}\n\tminx = 10000000000000LL;\nE:;\n\td = n;\n\trem = m - c[d - 1];\n\tminx = min(minx, rem);\n\tfor (int i = d - 2; i >= 0; i--) {\n\t\tminx = min(minx, (long long)abs(rem - c[i]));\n\t\tif (rem >= c[i]) {\n\t\t\trem -= c[i];\n\t\t}\n\t}\n\tcout << minx << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cmath>\n#include<cstdio>\n#include<vector>\n#include<algorithm>\n\n#define rep(i,n) for(int i=0;i<(n);i++)\n\nusing namespace std;\n\ntypedef long long ll;\n\nint main(){\n\tll n,m,a,b,p,q; scanf(\"%lld%lld%lld%lld%lld%lld\",&n,&m,&a,&b,&p,&q);\n\n\tll ans=m;\n\tif(a==1 && b==1){\n\t\tans=min(ans,llabs(n*(p+q)-m));\n\t\tll i=m/(p+q);\n\t\tfor(int j=-3;j<=3;j++) if(0<=i+j && i+j<=n) ans=min(ans,llabs((i+j)*(p+q)-m));\n\t}\n\telse{\n\t\tint N;\n\t\tll num[40];\n\t\tfor(int k=0;;k++){\n\t\t\tnum[k]=p*pow(a,k)+q*pow(b,k);\n\t\t\tif(k==n-1 || num[k]>1e9){\n\t\t\t\tN=k+1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(N%2==1) num[N++]=0;\n\n\t\tvector<ll> half1,half2;\n\t\trep(S,1<<N/2){\n\t\t\tbool ok1=true,ok2=true;\n\t\t\tll sum1=0,sum2=0;\n\t\t\trep(i,N/2) if(S>>i&1) {\n\t\t\t\tsum1+=num[i];\n\t\t\t\tsum2+=num[i+N/2];\n\t\t\t\tif(sum1>2e9) ok1=false;\n\t\t\t\tif(sum2>2e9) ok2=false;\n\t\t\t}\n\t\t\tif(ok1) half1.push_back(sum1);\n\t\t\tif(ok2) half2.push_back(sum2);\n\t\t}\n\t\thalf1.push_back(0);\n\t\thalf2.push_back(0);\n\n\t\tsort(half1.begin(),half1.end());\n\t\tsort(half2.begin(),half2.end());\n\n\t\trep(i,half1.size()){\n\t\t\tint j=lower_bound(half2.begin(),half2.end(),m-half1[i])-half2.begin();\n\t\t\tif(j<half2.size()) ans=min(ans,llabs(half1[i]+half2[ j ]-m));\n\t\t\tif(j>0)            ans=min(ans,llabs(half1[i]+half2[j-1]-m));\n\t\t}\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "// AOJ 2239 Nearest Station\n// 2018.4.7 bal4u\n\n#include <stdio.h>\n#include <stdlib.h>\n\n#define ABS(a)  ((a)>=0?(a):-(a))\n\nlong long d[50]; int sz;\nchar f[50];\n\nint cmp(long long *a, long long *b)\n{\n\tif (*a == *b) return 0;\n\tif (*a < *b) return -1;\n\treturn 1;\n}\n\n// 見つからなければ、一つ小さい要素を返す\nint binarySearch(long long x)\n{\n\tint m, l = 1, r = sz;\n\n    while (l < r) {\n        m = (l+r) >> 1;\n\t\tif (d[m] == x) return m;\n        if (d[m] < x) l = m + 1; else r = m;\n    }\n\treturn l-1;\n}\n\nint main()\n{\n\tint  i, j;\n\tlong long n, m, a, b, p, q;\n\tlong long g, s, t, pa, pb, ans;\n\n\tscanf(\"%lld%lld%lld%lld%lld%lld\", &n, &m, &a, &b, &p, &q);\n\tif (a == 1 && b == 1) {\n\t\ts = p + q, t = m/s;\n\t\tif (t > n) t = n;\n\t\tans = ABS(m - t*s);\n\t\tif (t < n) {\n\t\t\tif (++t > n) t = n;\n\t\t\tt = ABS(m - t*s);\n\t\t\tif (ans > t) ans = t;\n\t\t}\n\t} else {\n\t\tsz = 0, pa = pb = 1;\n\t\tfor (i = 0; i < n; i++) {\n\t\t\td[sz++] = s = p*pa + q*pb;\n\t\t\tif (s > m) break;\n\t\t\tif (s == m) { ans = 0; goto done; }\n\t\t\tpa *= a, pb *= b;\n\t\t}\n\t\tqsort(d, sz, sizeof(long long), cmp);\n\n\t\tans = g = m, s = 0;\n\t\twhile (sz) {\n\t\t\ti = binarySearch(g);\n\t\t\tt = ABS(d[i]-g);\n\t\t\tif (t < ans) {\n\t\t\t\tans = t;\n\t\t\t\tif (!ans) goto done;\n\t\t\t}\n\n\t\t\tj = i+1; while (j < sz && d[j] == d[i]) j++;\n\t\t\tif (j < sz) {\n\t\t\t\tt = ABS(d[j]-g);\n\t\t\t\tif (t < ans) ans = t;\n\t\t\t}\n\t\t\ts += d[i], g = ABS(m-s);\n\t\t\twhile (++i < sz) d[i-1] = d[i];\n\t\t\tsz--;\n\t\t}\n\t}\ndone:\n\tprintf(\"%lld\\n\", ans);\n\treturn 0;\n}\n"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tlong n = sc.nextLong();\n\t\tlong m = sc.nextLong();\n\t\tlong a = sc.nextLong();\n\t\tlong b = sc.nextLong();\n\t\tlong p = sc.nextLong();\n\t\tlong q = sc.nextLong();\n\t\tlong INF = 1000_000_000_000_000L;\n\t\tif (a == 1 && b == 1) {\n\t\t\t// (p+q)N\n\t\t\tlong ans = INF;\n\t\t\tlong div = m / (p + q);\n\t\t\tdiv = Math.min(div, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tdiv = Math.min(div + 1, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tSystem.out.println(ans);\n\t\t\treturn;\n\t\t}\n\t\t// pa^k+qb^k\n\t\tlong lim = 0;\n\t\twhile (p * Math.pow(a, lim) + q * Math.pow(b, lim) <= m) {\n\t\t\t++lim;\n\t\t}\n\t\tlim = Math.min(lim, n);\n\t\tlim = Math.min(lim, 41);\n\t\tArrayList<Long> pending1 = new ArrayList<>();\n\t\tArrayList<Long> pending2 = new ArrayList<>();\n\t\tfor (int t = 0; t < 2; ++t) {\n\t\t\tlong max = (t == 0 ? lim / 2 : (lim + 1) / 2);\n\t\t\touter: for (long i = 0; i < (1L << max); ++i) {\n\t\t\t\tlong s = 0;\n\t\t\t\tfor (int j = 0; j < 20; ++j) {\n\t\t\t\t\tif ((i & (1L << j)) > 0) {\n\t\t\t\t\t\ts += p * pow(a, j + (t == 1 ? lim / 2 : 0)) + q * pow(b, j + (t == 1 ? lim / 2 : 0));\n\t\t\t\t\t\tif (s > INF)\n\t\t\t\t\t\t\tcontinue outer;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t == 0)\n\t\t\t\t\tpending1.add(s);\n\t\t\t\telse\n\t\t\t\t\tpending2.add(s);\n\t\t\t}\n\t\t}\n\n\t\tCollections.sort(pending1);\n\t\tCollections.sort(pending2);\n\n\t\tlong ans = m;\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tint t = pending2.size() - 1;\n\t\t\tfor (int i = 0; i < pending1.size(); ++i) {\n\t\t\t\tif (j == 0)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) > m)\n\t\t\t\t\t\t--t;\n\t\t\t\telse if (j == 1)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) >= m\n\t\t\t\t\t\t\t&& pending1.get(i) + pending2.get(t - 1) >= m)\n\t\t\t\t\t\t--t;\n\t\t\t\tans = Math.min(ans, Math.abs(-m + pending1.get(i) + pending2.get(t)));\n\t\t\t}\n\t\t}\n\n\t\tSystem.out.println(ans);\n\n\t}\n\n\tstatic void tr(Object... objects) {\n\t\tSystem.out.println(Arrays.deepToString(objects));\n\t}\n\n\tstatic long pow(long a, long n) {\n\t\tlong ret = 1;\n\t\tfor (; n > 0; n >>= 1, a *= a) {\n\t\t\tif (n % 2 == 1) {\n\t\t\t\tret *= a;\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tlong n = sc.nextLong();\n\t\tlong m = sc.nextLong();\n\t\tlong a = sc.nextLong();\n\t\tlong b = sc.nextLong();\n\t\tlong p = sc.nextLong();\n\t\tlong q = sc.nextLong();\n\t\tlong INF = 1000_000_000_000_000L;\n\t\tif (a == 1 && b == 1) {\n\t\t\t// (p+q)N\n\t\t\tlong ans = INF;\n\t\t\tlong div = m / (p + q);\n\t\t\tdiv = Math.min(div, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tdiv = Math.min(div + 1, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tSystem.out.println(ans);\n\t\t\treturn;\n\t\t}\n\t\t// pa^k+qb^k\n\t\tlong lim = 0;\n\t\twhile (p * Math.pow(a, lim) + q * Math.pow(b, lim) <= m) {\n\t\t\t++lim;\n\t\t}\n\t\tlim = Math.min(lim, n);\n\t\tlim = Math.min(lim, 41);\n\t\tArrayList<Long> pending1 = new ArrayList<>();\n\t\tArrayList<Long> pending2 = new ArrayList<>();\n\t\tfor (int t = 0; t < 2; ++t) {\n\t\t\tlong max = (t == 0 ? lim / 2 : (lim + 1) / 2);\n\t\t\touter: for (long i = 0; i < (1L << max); ++i) {\n\t\t\t\tlong s = 0;\n\t\t\t\tfor (int j = 0; j < 20; ++j) {\n\t\t\t\t\tif ((i & (1L << j)) > 0) {\n\t\t\t\t\t\ts += p * Math.pow(a, j + (t == 1 ? lim / 2 : 0)) + q * Math.pow(b, j + (t == 1 ? lim / 2 : 0));\n\t\t\t\t\t\tif (s > INF)\n\t\t\t\t\t\t\tcontinue outer;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t == 0)\n\t\t\t\t\tpending1.add(s);\n\t\t\t\telse\n\t\t\t\t\tpending2.add(s);\n\t\t\t}\n\t\t}\n\n\t\tCollections.sort(pending1);\n\t\tCollections.sort(pending2);\n\n\t\tlong ans = m;\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tint t = pending2.size() - 1;\n\t\t\tfor (int i = 0; i < pending1.size(); ++i) {\n\t\t\t\tif (j == 0)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) > m)\n\t\t\t\t\t\t--t;\n\t\t\t\telse if (j == 1)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) >= m\n\t\t\t\t\t\t\t&& pending1.get(i) + pending2.get(t - 1) >= m)\n\t\t\t\t\t\t--t;\n\t\t\t\tans = Math.min(ans, Math.abs(-m + pending1.get(i) + pending2.get(t)));\n\t\t\t}\n\t\t}\n\n\t\tSystem.out.println(ans);\n\n\t}\n\n\tstatic void tr(Object... objects) {\n\t\tSystem.out.println(Arrays.deepToString(objects));\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint n = sc.nextInt();\n\t\tint m = sc.nextInt();\n\t\tint a = sc.nextInt();\n\t\tint b = sc.nextInt();\n\t\tint p = sc.nextInt();\n\t\tint q = sc.nextInt();\n\t\tlong INF = 1000_000_000_000_000L;\n\t\tif (a == 1 && b == 1) {\n\t\t\t// (p+q)N\n\t\t\tlong ans = INF;\n\t\t\tint div = m / (p + q);\n\t\t\tdiv = Math.min(div, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tdiv = Math.min(div + 1, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tSystem.out.println(ans);\n\t\t\treturn;\n\t\t}\n\t\t// pa^k+qb^k\n\t\tint lim = 0;\n\t\twhile (p * Math.pow(a, lim) + q * Math.pow(b, lim) <= INF) {\n\t\t\t++lim;\n\t\t}\n\t\tlim = Math.min(lim, n);\n\t\tArrayList<Long> pending1 = new ArrayList<>();\n\t\tArrayList<Long> pending2 = new ArrayList<>();\n\t\tfor (int t = 0; t < 2; ++t) {\n\t\t\tint max = (t == 0 ? lim / 2 : (lim + 1) / 2);\n\t\t\touter: for (long i = 0; i < (1L << max); ++i) {\n\t\t\t\tlong s = 0;\n\t\t\t\tfor (int j = 0; j < 20; ++j) {\n\t\t\t\t\tif ((i & (1L << j)) > 0) {\n\t\t\t\t\t\ts += p * Math.pow(a, j + (t == 1 ? lim / 2 : 0)) + q * Math.pow(b, j + (t == 1 ? lim / 2 : 0));\n\t\t\t\t\t\tif (s > INF)\n\t\t\t\t\t\t\tcontinue outer;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t == 0)\n\t\t\t\t\tpending1.add(s);\n\t\t\t\telse\n\t\t\t\t\tpending2.add(s);\n\t\t\t}\n\t\t}\n\n\t\tCollections.sort(pending1);\n\t\tCollections.sort(pending2);\n\n\t\tlong ans = m;\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tint t = pending2.size() - 1;\n\t\t\tfor (int i = 0; i < pending1.size(); ++i) {\n\t\t\t\tif (j == 0)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) > m)\n\t\t\t\t\t\t--t;\n\t\t\t\telse if (j == 1)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) >= m\n\t\t\t\t\t\t\t&& pending1.get(i) + pending2.get(t - 1) >= m)\n\t\t\t\t\t\t--t;\n\t\t\t\tans = Math.min(ans, Math.abs(-m + pending1.get(i) + pending2.get(t)));\n\t\t\t}\n\t\t}\n\n\t\tSystem.out.println(ans);\n\n\t}\n\n\tstatic void tr(Object... objects) {\n\t\tSystem.out.println(Arrays.deepToString(objects));\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tlong n = sc.nextLong();\n\t\tlong m = sc.nextLong();\n\t\tlong a = sc.nextLong();\n\t\tlong b = sc.nextLong();\n\t\tlong p = sc.nextLong();\n\t\tlong q = sc.nextLong();\n\t\tlong INF = 1000_000_000_000_000L;\n\t\tif (a == 1 && b == 1) {\n\t\t\t// (p+q)N\n\t\t\tlong ans = INF;\n\t\t\tlong div = m / (p + q);\n\t\t\tdiv = Math.min(div, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tdiv = Math.min(div + 1, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tSystem.out.println(ans);\n\t\t\treturn;\n\t\t}\n\t\t// pa^k+qb^k\n\t\tlong lim = 0;\n\t\twhile (p * Math.pow(a, lim) + q * Math.pow(b, lim) <= m) {\n\t\t\t++lim;\n\t\t}\n\t\tlim += 1;\n\t\tlim = Math.min(lim, n);\n\t\tlim = Math.min(lim, 41);\n\t\tArrayList<Long> pending1 = new ArrayList<>();\n\t\tArrayList<Long> pending2 = new ArrayList<>();\n\t\tlong[] powA = new long[42];\n\t\tlong[] powB = new long[42];\n\t\tpowA[0] = 1;\n\t\tpowB[0] = 1;\n\t\tfor (int i = 1; i < powA.length; ++i) {\n\t\t\tpowA[i] = powA[i - 1] * a;\n\t\t\tpowB[i] = powB[i - 1] * b;\n\t\t}\n\t\tfor (int t = 0; t < 2; ++t) {\n\t\t\tlong max = (t == 0 ? lim / 2 : (lim + 1) / 2);\n\t\t\touter: for (long i = 0; i < (1L << max); ++i) {\n\t\t\t\tlong s = 0;\n\t\t\t\tfor (int j = 0; j < 20; ++j) {\n\t\t\t\t\tif ((i & (1L << j)) > 0) {\n\t\t\t\t\t\ts += p * powA[(int) (j + (t == 1 ? lim / 2 : 0))]\n\t\t\t\t\t\t\t\t+ q * powB[(int) (j + (t == 1 ? lim / 2 : 0))];\n\t\t\t\t\t\tif (s > INF)\n\t\t\t\t\t\t\tcontinue outer;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t == 0)\n\t\t\t\t\tpending1.add(s);\n\t\t\t\telse\n\t\t\t\t\tpending2.add(s);\n\t\t\t}\n\t\t}\n\n\t\tCollections.sort(pending1);\n\t\tCollections.sort(pending2);\n\t\tlong ans = m;\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tint t = pending2.size() - 1;\n\t\t\tfor (int i = 0; i < pending1.size(); ++i) {\n\t\t\t\tif (j == 0)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) > m)\n\t\t\t\t\t\t--t;\n\t\t\t\telse if (j == 1)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) >= m\n\t\t\t\t\t\t\t&& pending1.get(i) + pending2.get(t - 1) >= m)\n\t\t\t\t\t\t--t;\n\t\t\t\tans = Math.min(ans, Math.abs(-m + pending1.get(i) + pending2.get(t)));\n\t\t\t}\n\t\t}\n\n\t\tSystem.out.println(ans);\n\n\t}\n\n\tstatic void tr(Object... objects) {\n\t\tSystem.out.println(Arrays.deepToString(objects));\n\t}\n\n\tstatic long pow(long a, long n) {\n\t\tlong ret = 1;\n\t\tfor (; n > 0; n >>= 1, a *= a) {\n\t\t\tif (n % 2 == 1) {\n\t\t\t\tret *= a;\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tlong n = sc.nextLong();\n\t\tlong m = sc.nextLong();\n\t\tlong a = sc.nextLong();\n\t\tlong b = sc.nextLong();\n\t\tlong p = sc.nextLong();\n\t\tlong q = sc.nextLong();\n\t\tlong INF = 1000_000_000_000_000L;\n\t\tif (a == 1 && b == 1) {\n\t\t\t// (p+q)N\n\t\t\tlong ans = INF;\n\t\t\tlong div = m / (p + q);\n\t\t\tdiv = Math.min(div, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tdiv = Math.min(div + 1, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tSystem.out.println(ans);\n\t\t\treturn;\n\t\t}\n\t\t// pa^k+qb^k\n\t\tlong lim = 0;\n\t\twhile (p * Math.pow(a, lim) + q * Math.pow(b, lim) <= m) {\n\t\t\t++lim;\n\t\t}\n\t\tlim += 1;\n\t\tlim = Math.min(lim, n);\n\t\tlim = Math.min(lim, 41);\n\t\tArrayList<Long> pending1 = new ArrayList<>();\n\t\tArrayList<Long> pending2 = new ArrayList<>();\n\t\tlong[] powA = new long[42];\n\t\tlong[] powB = new long[42];\n\t\tfor (int i = 0; i < powA.length; ++i) {\n\t\t\tpowA[i] = pow(a, i);\n\t\t\tpowB[i] = pow(b, i);\n\t\t}\n\t\tfor (int t = 0; t < 2; ++t) {\n\t\t\tlong max = (t == 0 ? lim / 2 : (lim + 1) / 2);\n\t\t\touter: for (long i = 0; i < (1L << max); ++i) {\n\t\t\t\tlong s = 0;\n\t\t\t\tfor (int j = 0; j < 20; ++j) {\n\t\t\t\t\tif ((i & (1L << j)) > 0) {\n\t\t\t\t\t\ts += p * powA[(int) (j + (t == 1 ? lim / 2 : 0))]\n\t\t\t\t\t\t\t\t+ q * powB[(int) (j + (t == 1 ? lim / 2 : 0))];\n\t\t\t\t\t\tif (s > INF)\n\t\t\t\t\t\t\tcontinue outer;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t == 0)\n\t\t\t\t\tpending1.add(s);\n\t\t\t\telse\n\t\t\t\t\tpending2.add(s);\n\t\t\t}\n\t\t}\n\n\t\tCollections.sort(pending1);\n\t\tCollections.sort(pending2);\n\t\tlong ans = m;\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tint t = pending2.size() - 1;\n\t\t\tfor (int i = 0; i < pending1.size(); ++i) {\n\t\t\t\tif (j == 0)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) > m)\n\t\t\t\t\t\t--t;\n\t\t\t\telse if (j == 1)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) >= m\n\t\t\t\t\t\t\t&& pending1.get(i) + pending2.get(t - 1) >= m)\n\t\t\t\t\t\t--t;\n\t\t\t\tans = Math.min(ans, Math.abs(-m + pending1.get(i) + pending2.get(t)));\n\t\t\t}\n\t\t}\n\n\t\tSystem.out.println(ans);\n\n\t}\n\n\tstatic void tr(Object... objects) {\n\t\tSystem.out.println(Arrays.deepToString(objects));\n\t}\n\n\tstatic long pow(long a, long n) {\n\t\tlong ret = 1;\n\t\tfor (; n > 0; n >>= 1, a *= a) {\n\t\t\tif (n % 2 == 1) {\n\t\t\t\tret *= a;\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tlong n = sc.nextLong();\n\t\tlong m = sc.nextLong();\n\t\tlong a = sc.nextLong();\n\t\tlong b = sc.nextLong();\n\t\tlong p = sc.nextLong();\n\t\tlong q = sc.nextLong();\n\t\tlong INF = 1000_000_000_000_000L;\n\t\tif (a == 1 && b == 1) {\n\t\t\t// (p+q)N\n\t\t\tlong ans = INF;\n\t\t\tlong div = m / (p + q);\n\t\t\tdiv = Math.min(div, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tdiv = Math.min(div + 1, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tSystem.out.println(ans);\n\t\t\treturn;\n\t\t}\n\t\t// pa^k+qb^k\n\t\tlong lim = 0;\n\t\twhile (p * Math.pow(a, lim) + q * Math.pow(b, lim) <= m) {\n\t\t\t++lim;\n\t\t}\n\t\tlim += 1;\n\t\tlim = Math.min(lim, n);\n\t\tlim = Math.min(lim, 40);\n\t\tArrayList<Long> pending1 = new ArrayList<>();\n\t\tArrayList<Long> pending2 = new ArrayList<>();\n\t\tlong[] powA = new long[42];\n\t\tlong[] powB = new long[42];\n\t\tpowA[0] = 1;\n\t\tpowB[0] = 1;\n\t\tfor (int i = 1; i < powA.length; ++i) {\n\t\t\tpowA[i] = powA[i - 1] * a;\n\t\t\tpowB[i] = powB[i - 1] * b;\n\t\t}\n\t\tfor (int t = 0; t < 2; ++t) {\n\t\t\tlong max = (t == 0 ? lim / 2 : (lim + 1) / 2);\n\t\t\touter: for (long i = 0; i < (1L << max); ++i) {\n\t\t\t\tlong s = 0;\n\t\t\t\tfor (int j = 0; j < max; ++j) {\n\t\t\t\t\tif ((i & (1L << j)) > 0) {\n\t\t\t\t\t\ts += p * powA[(int) (j + (t == 1 ? lim / 2 : 0))]\n\t\t\t\t\t\t\t\t+ q * powB[(int) (j + (t == 1 ? lim / 2 : 0))];\n\t\t\t\t\t\tif (s > INF)\n\t\t\t\t\t\t\tcontinue outer;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t == 0)\n\t\t\t\t\tpending1.add(s);\n\t\t\t\telse\n\t\t\t\t\tpending2.add(s);\n\t\t\t}\n\t\t}\n\n\t\tCollections.sort(pending1);\n\t\tCollections.sort(pending2);\n\n\t\tlong ans = m;\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tint t = pending2.size() - 1;\n\t\t\tfor (int i = 0; i < pending1.size(); ++i) {\n\t\t\t\tif (j == 0)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) > m)\n\t\t\t\t\t\t--t;\n\t\t\t\telse if (j == 1)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) >= m\n\t\t\t\t\t\t\t&& pending1.get(i) + pending2.get(t - 1) >= m)\n\t\t\t\t\t\t--t;\n\t\t\t\tans = Math.min(ans, Math.abs(-m + pending1.get(i) + pending2.get(t)));\n\t\t\t}\n\t\t}\n\n\t\tSystem.out.println(ans);\n\n\t}\n\n\tstatic void tr(Object... objects) {\n\t\tSystem.out.println(Arrays.deepToString(objects));\n\t}\n\n\tstatic long pow(long a, long n) {\n\t\tlong ret = 1;\n\t\tfor (; n > 0; n >>= 1, a *= a) {\n\t\t\tif (n % 2 == 1) {\n\t\t\t\tret *= a;\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tlong n = sc.nextLong();\n\t\tlong m = sc.nextLong();\n\t\tlong a = sc.nextLong();\n\t\tlong b = sc.nextLong();\n\t\tlong p = sc.nextLong();\n\t\tlong q = sc.nextLong();\n\t\tlong INF = 1000_000_000_000_000L;\n\t\tif (a == 1 && b == 1) {\n\t\t\t// (p+q)N\n\t\t\tlong ans = INF;\n\t\t\tlong div = m / (p + q);\n\t\t\tdiv = Math.min(div, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tdiv = Math.min(div + 1, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tSystem.out.println(ans);\n\t\t\treturn;\n\t\t}\n\t\t// pa^k+qb^k\n\t\tlong lim = 0;\n\t\twhile (p * Math.pow(a, lim) + q * Math.pow(b, lim) <= m) {\n\t\t\t++lim;\n\t\t}\n\t\tlim += 1;\n\t\tlim = Math.min(lim, n);\n\t\tlim = Math.min(lim, 41);\n\t\tArrayList<Long> pending1 = new ArrayList<>();\n\t\tArrayList<Long> pending2 = new ArrayList<>();\n\t\tfor (int t = 0; t < 2; ++t) {\n\t\t\tlong max = (t == 0 ? lim / 2 : (lim + 1) / 2);\n\t\t\touter: for (long i = 0; i < (1L << max); ++i) {\n\t\t\t\tlong s = 0;\n\t\t\t\tfor (int j = 0; j < 20; ++j) {\n\t\t\t\t\tif ((i & (1L << j)) > 0) {\n\t\t\t\t\t\ts += p * pow(a, j + (t == 1 ? lim / 2 : 0)) + q * pow(b, j + (t == 1 ? lim / 2 : 0));\n\t\t\t\t\t\tif (s > INF)\n\t\t\t\t\t\t\tcontinue outer;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t == 0)\n\t\t\t\t\tpending1.add(s);\n\t\t\t\telse\n\t\t\t\t\tpending2.add(s);\n\t\t\t}\n\t\t}\n\n\t\tCollections.sort(pending1);\n\t\tCollections.sort(pending2);\n\n\t\tlong ans = m;\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tint t = pending2.size() - 1;\n\t\t\tfor (int i = 0; i < pending1.size(); ++i) {\n\t\t\t\tif (j == 0)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) > m)\n\t\t\t\t\t\t--t;\n\t\t\t\telse if (j == 1)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) >= m\n\t\t\t\t\t\t\t&& pending1.get(i) + pending2.get(t - 1) >= m)\n\t\t\t\t\t\t--t;\n\t\t\t\tans = Math.min(ans, Math.abs(-m + pending1.get(i) + pending2.get(t)));\n\t\t\t}\n\t\t}\n\n\t\tSystem.out.println(ans);\n\n\t}\n\n\tstatic void tr(Object... objects) {\n\t\tSystem.out.println(Arrays.deepToString(objects));\n\t}\n\n\tstatic long pow(long a, long n) {\n\t\tlong ret = 1;\n\t\tfor (; n > 0; n >>= 1, a *= a) {\n\t\t\tif (n % 2 == 1) {\n\t\t\t\tret *= a;\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tlong n = sc.nextLong();\n\t\tlong m = sc.nextLong();\n\t\tlong a = sc.nextLong();\n\t\tlong b = sc.nextLong();\n\t\tlong p = sc.nextLong();\n\t\tlong q = sc.nextLong();\n\t\tlong INF = 1000_000_000_000_000L;\n\t\tif (a == 1 && b == 1) {\n\t\t\t// (p+q)N\n\t\t\tlong ans = INF;\n\t\t\tlong div = m / (p + q);\n\t\t\tdiv = Math.min(div, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tdiv = Math.min(div + 1, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tSystem.out.println(ans);\n\t\t\treturn;\n\t\t}\n\t\t// pa^k+qb^k\n\t\tlong lim = 0;\n\t\twhile (p * Math.pow(a, lim) + q * Math.pow(b, lim) <= m) {\n\t\t\t++lim;\n\t\t}\n\t\tlim += 1;\n\t\tlim = Math.min(lim, n);\n\t\tlim = Math.min(lim, 40);\n\t\tArrayList<Long> pending1 = new ArrayList<>();\n\t\tArrayList<Long> pending2 = new ArrayList<>();\n\t\tlong[] powA = new long[42];\n\t\tlong[] powB = new long[42];\n\t\tpowA[0] = 1;\n\t\tpowB[0] = 1;\n\t\tfor (int i = 1; i < powA.length; ++i) {\n\t\t\tpowA[i] = powA[i - 1] * a;\n\t\t\tpowB[i] = powB[i - 1] * b;\n\t\t}\n\t\tfor (int t = 0; t < 2; ++t) {\n\t\t\tlong max = (t == 0 ? lim / 2 : (lim + 1) / 2);\n\t\t\touter: for (long i = 0; i < (1L << max); ++i) {\n\t\t\t\tlong s = 0;\n\t\t\t\tfor (int j = 0; j < max; ++j) {\n\t\t\t\t\tif ((i & (1L << j)) > 0) {\n\t\t\t\t\t\ts += p * powA[(int) (j + (t == 1 ? lim / 2 : 0))]\n\t\t\t\t\t\t\t\t+ q * powB[(int) (j + (t == 1 ? lim / 2 : 0))];\n\t\t\t\t\t\tif (s > INF)\n\t\t\t\t\t\t\tcontinue outer;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t == 0)\n\t\t\t\t\tpending1.add(s);\n\t\t\t\telse\n\t\t\t\t\tpending2.add(s);\n\t\t\t}\n\t\t}\n\n\t\tCollections.sort(pending1);\n\t\tCollections.sort(pending2);\n\n\t\tlong ans = m;\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tint t = pending2.size() - 1;\n\t\t\tfor (int i = 0; i < pending1.size(); ++i) {\n\t\t\t\tif (j == 0)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) > m)\n\t\t\t\t\t\t--t;\n\t\t\t\telse if (j == 1)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) >= m\n\t\t\t\t\t\t\t&& pending1.get(i) + pending2.get(t - 1) >= m)\n\t\t\t\t\t\t--t;\n\t\t\t\tans = Math.min(ans, Math.abs(-m + pending1.get(i) + pending2.get(t)));\n\t\t\t}\n\t\t}\n\n\t\tSystem.out.println(ans);\n\n\t}\n\n\tstatic void tr(Object... objects) {\n\t\tSystem.out.println(Arrays.deepToString(objects));\n\t}\n\n\tstatic long pow(long a, long n) {\n\t\tlong ret = 1;\n\t\tfor (; n > 0; n >>= 1, a *= a) {\n\t\t\tif (n % 2 == 1) {\n\t\t\t\tret *= a;\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tlong n = sc.nextLong();\n\t\tlong m = sc.nextLong();\n\t\tlong a = sc.nextLong();\n\t\tlong b = sc.nextLong();\n\t\tlong p = sc.nextLong();\n\t\tlong q = sc.nextLong();\n\t\tlong INF = 1000_000_000_000_000L;\n\t\tif (a == 1 && b == 1) {\n\t\t\t// (p+q)N\n\t\t\tlong ans = INF;\n\t\t\tlong div = m / (p + q);\n\t\t\tdiv = Math.min(div, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tdiv = Math.min(div + 1, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tSystem.out.println(ans);\n\t\t\treturn;\n\t\t}\n\t\t// pa^k+qb^k\n\t\tlong lim = 0;\n\t\twhile (p * Math.pow(a, lim) + q * Math.pow(b, lim) <= INF) {\n\t\t\t++lim;\n\t\t}\n\t\tlim = Math.min(lim, n);\n\t\tArrayList<Long> pending1 = new ArrayList<>();\n\t\tArrayList<Long> pending2 = new ArrayList<>();\n\t\tfor (int t = 0; t < 2; ++t) {\n\t\t\tlong max = (t == 0 ? lim / 2 : (lim + 1) / 2);\n\t\t\touter: for (long i = 0; i < (1L << max); ++i) {\n\t\t\t\tlong s = 0;\n\t\t\t\tfor (int j = 0; j < 20; ++j) {\n\t\t\t\t\tif ((i & (1L << j)) > 0) {\n\t\t\t\t\t\ts += p * Math.pow(a, j + (t == 1 ? lim / 2 : 0)) + q * Math.pow(b, j + (t == 1 ? lim / 2 : 0));\n\t\t\t\t\t\tif (s > INF)\n\t\t\t\t\t\t\tcontinue outer;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t == 0)\n\t\t\t\t\tpending1.add(s);\n\t\t\t\telse\n\t\t\t\t\tpending2.add(s);\n\t\t\t}\n\t\t}\n\n\t\tCollections.sort(pending1);\n\t\tCollections.sort(pending2);\n\n\t\tlong ans = m;\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tint t = pending2.size() - 1;\n\t\t\tfor (int i = 0; i < pending1.size(); ++i) {\n\t\t\t\tif (j == 0)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) > m)\n\t\t\t\t\t\t--t;\n\t\t\t\telse if (j == 1)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) >= m\n\t\t\t\t\t\t\t&& pending1.get(i) + pending2.get(t - 1) >= m)\n\t\t\t\t\t\t--t;\n\t\t\t\tans = Math.min(ans, Math.abs(-m + pending1.get(i) + pending2.get(t)));\n\t\t\t}\n\t\t}\n\n\t\tSystem.out.println(ans);\n\n\t}\n\n\tstatic void tr(Object... objects) {\n\t\tSystem.out.println(Arrays.deepToString(objects));\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint n = sc.nextInt();\n\t\tint m = sc.nextInt();\n\t\tint a = sc.nextInt();\n\t\tint b = sc.nextInt();\n\t\tint p = sc.nextInt();\n\t\tint q = sc.nextInt();\n\t\tlong INF = 1000_000_000_000_000L;\n\n\t\t// pa^k+qb^k\n\t\tint lim = 0;\n\t\twhile (p * Math.pow(a, lim) + q * Math.pow(b, lim) <= INF) {\n\t\t\t++lim;\n\t\t}\n\t\tlim = Math.min(lim, n);\n\t\tArrayList<Long> pending1 = new ArrayList<>();\n\t\tArrayList<Long> pending2 = new ArrayList<>();\n\t\tfor (int t = 0; t < 2; ++t) {\n\t\t\tint max = (t == 0 ? lim / 2 : (lim + 1) / 2);\n\t\t\touter: for (long i = 0; i < (1L << max); ++i) {\n\t\t\t\tlong s = 0;\n\t\t\t\tfor (int j = 0; j < 20; ++j) {\n\t\t\t\t\tif ((i & (1L << j)) > 0) {\n\t\t\t\t\t\ts += p * Math.pow(a, j + (t == 1 ? lim / 2 : 0)) + q * Math.pow(b, j + (t == 1 ? lim / 2 : 0));\n\t\t\t\t\t\tif (s > INF)\n\t\t\t\t\t\t\tcontinue outer;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t == 0)\n\t\t\t\t\tpending1.add(s);\n\t\t\t\telse\n\t\t\t\t\tpending2.add(s);\n\t\t\t}\n\t\t}\n\n\t\tCollections.sort(pending1);\n\t\tCollections.sort(pending2);\n\n\t\tlong ans = m;\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tint t = pending2.size() - 1;\n\t\t\tfor (int i = 0; i < pending1.size(); ++i) {\n\t\t\t\tif (j == 0)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) > m)\n\t\t\t\t\t\t--t;\n\t\t\t\telse if (j == 1)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) >= m\n\t\t\t\t\t\t\t&& pending1.get(i) + pending2.get(t - 1) >= m)\n\t\t\t\t\t\t--t;\n\t\t\t\tans = Math.min(ans, Math.abs(-m + pending1.get(i) + pending2.get(t)));\n\t\t\t}\n\t\t}\n\n\t\tSystem.out.println(ans);\n\n\t}\n\n\tstatic void tr(Object... objects) {\n\t\tSystem.out.println(Arrays.deepToString(objects));\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tlong n = sc.nextLong();\n\t\tlong m = sc.nextLong();\n\t\tlong a = sc.nextLong();\n\t\tlong b = sc.nextLong();\n\t\tlong p = sc.nextLong();\n\t\tlong q = sc.nextLong();\n\t\tlong INF = 1000_000_000_000_000L;\n\t\tif (a == 1 && b == 1) {\n\t\t\t// (p+q)N\n\t\t\tlong ans = INF;\n\t\t\tlong div = m / (p + q);\n\t\t\tdiv = Math.min(div, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tdiv = Math.min(div + 1, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tSystem.out.println(ans);\n\t\t\treturn;\n\t\t}\n\t\t// pa^k+qb^k\n\t\tlong lim = 0;\n\t\twhile (p * Math.pow(a, lim) + q * Math.pow(b, lim) <= m) {\n\t\t\t++lim;\n\t\t}\n\t\tlim += 1;\n\t\tlim = Math.min(lim, n);\n\t\tlim = Math.min(lim, 41);\n\t\tArrayList<Long> pending1 = new ArrayList<>();\n\t\tArrayList<Long> pending2 = new ArrayList<>();\n\t\tlong[] powA = new long[42];\n\t\tlong[] powB = new long[42];\n\t\tpowA[0] = 1;\n\t\tpowB[0] = 1;\n\t\tfor (int i = 1; i < powA.length; ++i) {\n\t\t\tpowA[i] = powA[i - 1] * a;\n\t\t\tpowB[i] = powB[i - 1] * b;\n\t\t}\n\t\tfor (int t = 0; t < 2; ++t) {\n\t\t\tlong max = (t == 0 ? lim / 2 : (lim + 1) / 2);\n\t\t\touter: for (long i = 0; i < (1L << max); ++i) {\n\t\t\t\tlong s = 0;\n\t\t\t\tfor (int j = 0; j < 20; ++j) {\n\t\t\t\t\tif ((i & (1L << j)) > 0) {\n\t\t\t\t\t\ts += p * powA[(int) (j + (t == 1 ? lim / 2 : 0))]\n\t\t\t\t\t\t\t\t+ q * powB[(int) (j + (t == 1 ? lim / 2 : 0))];\n\t\t\t\t\t\tif (s > INF)\n\t\t\t\t\t\t\tcontinue outer;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t == 0)\n\t\t\t\t\tpending1.add(s);\n\t\t\t\telse\n\t\t\t\t\tpending2.add(s);\n\t\t\t}\n\t\t}\n\n\t\tCollections.sort(pending1);\n\t\tCollections.sort(pending2);\n\t\tlong ans = m;\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tint t = pending2.size() - 1;\n\t\t\tfor (int i = 0; i < pending1.size(); ++i) {\n\t\t\t\tif (j == 0)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) > m)\n\t\t\t\t\t\t--t;\n\t\t\t\telse if (j == 1)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) >= m\n\t\t\t\t\t\t\t&& pending1.get(i) + pending2.get(t - 1) >= m)\n\t\t\t\t\t\t--t;\n\t\t\t\tans = Math.min(ans, Math.abs(-m + pending1.get(i) + pending2.get(t)));\n\t\t\t}\n\t\t}\n\n\t\tSystem.out.println(ans);\n\n\t}\n\n\tstatic void tr(Object... objects) {\n\t\tSystem.out.println(Arrays.deepToString(objects));\n\t}\n\n\tstatic long pow(long a, long n) {\n\t\tlong ret = 1;\n\t\tfor (; n > 0; n >>= 1, a *= a) {\n\t\t\tif (n % 2 == 1) {\n\t\t\t\tret *= a;\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tlong n = sc.nextLong();\n\t\tlong m = sc.nextLong();\n\t\tlong a = sc.nextLong();\n\t\tlong b = sc.nextLong();\n\t\tlong p = sc.nextLong();\n\t\tlong q = sc.nextLong();\n\t\tlong INF = 1000_000_000_000_000L;\n\t\tif (a == 1 && b == 1) {\n\t\t\t// (p+q)N\n\t\t\tlong ans = INF;\n\t\t\tlong div = m / (p + q);\n\t\t\tdiv = Math.min(div, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tdiv = Math.min(div + 1, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tSystem.out.println(ans);\n\t\t\treturn;\n\t\t}\n\t\t// pa^k+qb^k\n\t\tlong lim = 0;\n\t\twhile (p * Math.pow(a, lim) + q * Math.pow(b, lim) <= INF) {\n\t\t\t++lim;\n\t\t}\n\t\tlim = Math.min(lim, n);\n\t\tlim = Math.min(lim, 41);\n\t\tArrayList<Long> pending1 = new ArrayList<>();\n\t\tArrayList<Long> pending2 = new ArrayList<>();\n\t\tfor (int t = 0; t < 2; ++t) {\n\t\t\tlong max = (t == 0 ? lim / 2 : (lim + 1) / 2);\n\t\t\touter: for (long i = 0; i < (1L << max); ++i) {\n\t\t\t\tlong s = 0;\n\t\t\t\tfor (int j = 0; j < 20; ++j) {\n\t\t\t\t\tif ((i & (1L << j)) > 0) {\n\t\t\t\t\t\ts += p * Math.pow(a, j + (t == 1 ? lim / 2 : 0)) + q * Math.pow(b, j + (t == 1 ? lim / 2 : 0));\n\t\t\t\t\t\tif (s > INF)\n\t\t\t\t\t\t\tcontinue outer;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t == 0)\n\t\t\t\t\tpending1.add(s);\n\t\t\t\telse\n\t\t\t\t\tpending2.add(s);\n\t\t\t}\n\t\t}\n\n\t\tCollections.sort(pending1);\n\t\tCollections.sort(pending2);\n\n\t\tlong ans = m;\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tint t = pending2.size() - 1;\n\t\t\tfor (int i = 0; i < pending1.size(); ++i) {\n\t\t\t\tif (j == 0)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) > m)\n\t\t\t\t\t\t--t;\n\t\t\t\telse if (j == 1)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) >= m\n\t\t\t\t\t\t\t&& pending1.get(i) + pending2.get(t - 1) >= m)\n\t\t\t\t\t\t--t;\n\t\t\t\tans = Math.min(ans, Math.abs(-m + pending1.get(i) + pending2.get(t)));\n\t\t\t}\n\t\t}\n\n\t\tSystem.out.println(ans);\n\n\t}\n\n\tstatic void tr(Object... objects) {\n\t\tSystem.out.println(Arrays.deepToString(objects));\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class main {\n\tpublic static void Main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tlong n = sc.nextLong();\n\t\tlong m = sc.nextLong();\n\t\tlong a = sc.nextLong();\n\t\tlong b = sc.nextLong();\n\t\tlong p = sc.nextLong();\n\t\tlong q = sc.nextLong();\n\t\tlong INF = 1000_000_000_000_000L;\n\t\tif (a == 1 && b == 1) {\n\t\t\t// (p+q)N\n\t\t\tlong ans = INF;\n\t\t\tlong div = m / (p + q);\n\t\t\tdiv = Math.min(div, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tdiv = Math.min(div + 1, n);\n\t\t\tans = Math.min(ans, Math.abs(div * (p + q) - m));\n\t\t\tSystem.out.println(ans);\n\t\t\treturn;\n\t\t}\n\t\t// pa^k+qb^k\n\t\tlong lim = 0;\n\t\twhile (p * Math.pow(a, lim) + q * Math.pow(b, lim) <= m) {\n\t\t\t++lim;\n\t\t}\n\t\tlim += 1;\n\t\tlim = Math.min(lim, n);\n\t\tlim = Math.min(lim, 40);\n\t\tArrayList<Long> pending1 = new ArrayList<>();\n\t\tArrayList<Long> pending2 = new ArrayList<>();\n\t\tlong[] powA = new long[42];\n\t\tlong[] powB = new long[42];\n\t\tpowA[0] = 1;\n\t\tpowB[0] = 1;\n\t\tfor (int i = 1; i < powA.length; ++i) {\n\t\t\tpowA[i] = powA[i - 1] * a;\n\t\t\tpowB[i] = powB[i - 1] * b;\n\t\t}\n\t\tfor (int t = 0; t < 2; ++t) {\n\t\t\tlong max = (t == 0 ? lim / 2 : (lim + 1) / 2);\n\t\t\touter: for (long i = 0; i < (1L << max); ++i) {\n\t\t\t\tlong s = 0;\n\t\t\t\tfor (int j = 0; j < max; ++j) {\n\t\t\t\t\tif ((i & (1L << j)) > 0) {\n\t\t\t\t\t\ts += p * powA[(int) (j + (t == 1 ? lim / 2 : 0))]\n\t\t\t\t\t\t\t\t+ q * powB[(int) (j + (t == 1 ? lim / 2 : 0))];\n\t\t\t\t\t\tif (s > INF)\n\t\t\t\t\t\t\tcontinue outer;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t == 0)\n\t\t\t\t\tpending1.add(s);\n\t\t\t\telse\n\t\t\t\t\tpending2.add(s);\n\t\t\t}\n\t\t}\n\n\t\tCollections.sort(pending1);\n\t\tCollections.sort(pending2);\n\n\t\tlong ans = m;\n\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\tint t = pending2.size() - 1;\n\t\t\tfor (int i = 0; i < pending1.size(); ++i) {\n\t\t\t\tif (j == 0)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) > m)\n\t\t\t\t\t\t--t;\n\t\t\t\telse if (j == 1)\n\t\t\t\t\twhile (t > 0 && pending1.get(i) + pending2.get(t) >= m\n\t\t\t\t\t\t\t&& pending1.get(i) + pending2.get(t - 1) >= m)\n\t\t\t\t\t\t--t;\n\t\t\t\tans = Math.min(ans, Math.abs(-m + pending1.get(i) + pending2.get(t)));\n\t\t\t}\n\t\t}\n\n\t\tSystem.out.println(ans);\n\n\t}\n\n\tstatic void tr(Object... objects) {\n\t\tSystem.out.println(Arrays.deepToString(objects));\n\t}\n\n\tstatic long pow(long a, long n) {\n\t\tlong ret = 1;\n\t\tfor (; n > 0; n >>= 1, a *= a) {\n\t\t\tif (n % 2 == 1) {\n\t\t\t\tret *= a;\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n}"
  },
  {
    "language": "Ruby",
    "code": "class Array\n\tdef accum\n\t\tac = Array.new(size + 1)\n\t\tac[0] = 0\n\t\t(1..size).each do |i|\n\t\t\tac[i] = ac[i-1] + self[i-1]\n\t\tend\n\t\tac\n\tend\n\n\tdef accum!\n\t\t(1..size-1).each{|i|\n\t\t\tself[i] += self[i-1]\n\t\t}\n\t\tself.unshift(0)\n\tend\n\n\tdef accum_2d\n\t\tac = map{|r| r.accum}\n\t\t(1..size-1).each{|i|\n\t\t\t(1..ac[0].size-1).each{|j|\n\t\t\t\tac[i][j] += ac[i-1][j]\n\t\t\t}\n\t\t}\n\t\tac.unshift([0] * ac[0].size)\n\t\tac\n\tend\n\n\tdef accum_2d!\n\t\teach{|r| r.accum!}\n\t\t(1..size-1).each{|i|\n\t\t\t(1..self[0].size-1).each{|j|\n\t\t\t\tself[i][j] += self[i-1][j]\n\t\t\t}\n\t\t}\n\t\tunshift([0] * self[0].size)\n\tend\n\t\t\n\tdef bsearch_first_index(l = 0, r = size - 1, &pred)\n\t\treturn nil if l > r\n\t\tc = (l + r) / 2 \n\t\tif pred[self[c]]\n\t\t\tbsearch_first_index(l, c-1, &pred) || c\n\t\telse\n\t\t\tbsearch_first_index(c+1, r, &pred)\n\t\tend\n\tend\n\n\tdef bsearch_first_item(l = 0, r = size - 1, &pred)\n\t\ti = bsearch_first_index(l, r, &pred)\n\t\ti ? self[i] : nil\n\tend\n\n\tdef bsearch_last_index(l = 0, r = size - 1, &pred)\n\t\treturn nil if l > r\n\t\tc = (l + r) / 2 \n\t\tif pred[self[c]]\n\t\t\tbsearch_last_index(c+1, r, &pred) || c\n\t\telse\n\t\t\tbsearch_last_index(l, c-1, &pred)\n\t\tend\n\tend\n\n\tdef bsearch_last_item(l = 0, r = size - 1, &pred)\n\t\ti = bsearch_last_index(l, r, &pred)\n\t\ti ? self[i] : nil\n\tend\nend\n\nn, m, a, b, q, r = gets.split.map(&:to_i)\n\nif a == 1 && b == 1\n\tk = m / (q + r)\n\tif k < n\n\t\tp [m - k * (q + r), (k + 1) * (q + r) - m].min\n\telse \n\t\tp m - n * (q + r)\n\tend\n\texit\nend\n\nsteps = []\n(0..n-1).each do |k|\n\ts = q*a**k + r*b**k\n\tsteps << s\n\tbreak if s >= m\nend\n\nmin = m\nif steps[-1] > m\n\tx = steps.pop\n\tmin = x - m if x && x - m < min\nend\n\nhalf1, half2 = steps.partition.with_index{|x, i| i < steps.size / 2}\n\nsubset_sums1 = [0]\n(1..2**half1.size-1).each do |x|\n\ti = ((x - 1) ^ x).to_s(2).size - 1\n\ty = x - (1 << i)\n\tsubset_sums1[x] = subset_sums1[y] + half1[i]\nend\nsubset_sums1.uniq!\nsubset_sums1.sort!\n\nsubset_sums2 = [0]\n(1..2**half2.size-1).each do |x|\n\ti = ((x - 1) ^ x).to_s(2).size - 1\n\ty = x - (1 << i)\n\tsubset_sums2[x] = subset_sums2[y] + half2[i]\nend\n\nsubset_sums2.each do |ss2|\n\tif ss2 >= m\n\t\tmin = ss2 - m if ss2 - m < min\n\t\tnext\n\tend\n\n\ti = subset_sums1.bsearch_last_index {|ss1| ss2 + ss1 <= m}\n\tx = subset_sums1[i] + ss2\n\tmin = m - x if m - x < min\n\tif i < subset_sums1.size - 1\n\t\tx = subset_sums1[i+1] + ss2\n\t\tmin = x - m if x - m < min\n\tend\nend\np min"
  },
  {
    "language": "Ruby",
    "code": "class Array\n\tdef accum\n\t\tac = Array.new(size + 1)\n\t\tac[0] = 0\n\t\t(1..size).each do |i|\n\t\t\tac[i] = ac[i-1] + self[i-1]\n\t\tend\n\t\tac\n\tend\n\n\tdef accum!\n\t\t(1..size-1).each{|i|\n\t\t\tself[i] += self[i-1]\n\t\t}\n\t\tself.unshift(0)\n\tend\n\n\tdef accum_2d\n\t\tac = map{|r| r.accum}\n\t\t(1..size-1).each{|i|\n\t\t\t(1..ac[0].size-1).each{|j|\n\t\t\t\tac[i][j] += ac[i-1][j]\n\t\t\t}\n\t\t}\n\t\tac.unshift([0] * ac[0].size)\n\t\tac\n\tend\n\n\tdef accum_2d!\n\t\teach{|r| r.accum!}\n\t\t(1..size-1).each{|i|\n\t\t\t(1..self[0].size-1).each{|j|\n\t\t\t\tself[i][j] += self[i-1][j]\n\t\t\t}\n\t\t}\n\t\tunshift([0] * self[0].size)\n\tend\n\t\t\n\tdef bsearch_first_index(l = 0, r = size - 1, &pred)\n\t\treturn nil if l > r\n\t\tc = (l + r) / 2 \n\t\tif pred[self[c]]\n\t\t\tbsearch_first_index(l, c-1, &pred) || c\n\t\telse\n\t\t\tbsearch_first_index(c+1, r, &pred)\n\t\tend\n\tend\n\n\tdef bsearch_first_item(l = 0, r = size - 1, &pred)\n\t\ti = bsearch_first_index(l, r, &pred)\n\t\ti ? self[i] : nil\n\tend\n\n\tdef bsearch_last_index(l = 0, r = size - 1, &pred)\n\t\treturn nil if l > r\n\t\tc = (l + r) / 2 \n\t\tif pred[self[c]]\n\t\t\tbsearch_last_index(c+1, r, &pred) || c\n\t\telse\n\t\t\tbsearch_last_index(l, c-1, &pred)\n\t\tend\n\tend\n\n\tdef bsearch_last_item(l = 0, r = size - 1, &pred)\n\t\ti = bsearch_last_index(l, r, &pred)\n\t\ti ? self[i] : nil\n\tend\nend\n\nn, m, a, b, q, r = gets.split.map(&:to_i)\n\nif a == 1 && b == 1\n\tk = m / (q + r)\n\tif k < n\n\t\tp [m - k * (q + r), (k + 1) * (q + r) - m].min\n\telse \n\t\tp m - n * (q + r)\n\tend\n\texit\nend\n\nsteps = []\n(0..n-1).each do |k|\n\ts = q*a**k + r*b**k\n\tsteps << s\n\tbreak if s >= m\nend\n\nmin = nil\nif steps[-1] > m\n\tx = steps.pop\n\tmin = x ? [x - m, m].min : m\nend\n\nhalf1, half2 = steps.partition.with_index{|x, i| i < steps.size / 2}\n\nsubset_sums1 = [0]\n(1..2**half1.size-1).each do |x|\n\ti = ((x - 1) ^ x).to_s(2).size - 1\n\ty = x - (1 << i)\n\tsubset_sums1[x] = subset_sums1[y] + half1[i]\nend\nsubset_sums1.uniq!\nsubset_sums1.sort!\n\nsubset_sums2 = [0]\n(1..2**half2.size-1).each do |x|\n\ti = ((x - 1) ^ x).to_s(2).size - 1\n\ty = x - (1 << i)\n\tsubset_sums2[x] = subset_sums2[y] + half2[i]\nend\n\nsubset_sums2.each do |ss2|\n\tif ss2 >= m\n\t\tmin = ss2 - m if ss2 - m < min\n\t\tnext\n\tend\n\ti = subset_sums1.bsearch_last_index {|ss1| ss2 + ss1 <= m}\n\tx = subset_sums1[i] + ss2\n\tmin = m - x if m - x < min\n\tif i < subset_sums1.size - 1\n\t\tx = subset_sums1[i+1] + ss2\n\t\tmin = x - m if x - m < min\n\tend\nend\np min"
  },
  {
    "language": "Python",
    "code": "import sys\nreadline = sys.stdin.readline\nwrite = sys.stdout.write\ndef solve():\n    N, M, A, B, P, Q = map(int, readline().split())\n    ans = M\n    if A == B == 1:\n        v = P+Q\n        k = min(N, M // v)\n        ans = min(ans, M - k*v)\n        if k+1 <= N:\n            ans = min(ans, (k+1)*v - M)\n    else:\n        k = 0\n        V = []\n        va = 1; vb = 1\n        while k < N:\n            v = P*va + Q*vb\n            V.append(v)\n            if v > M:\n                break\n            va *= A; vb *= B\n            k += 1\n        def make(S):\n            s = {0}\n            for v in S:\n                t = set(s)\n                for e in s:\n                    t.add(e + v)\n                s = t\n            return sorted(s)\n        L = len(V)\n        S0 = make(V[:L//2]); S1 = make(V[L//2:])\n        t = len(S1)-1\n        for s0 in S0:\n            while t > 0 and s0 + S1[t] > M:\n                t -= 1\n            if s0 + S1[t] <= M:\n                ans = min(ans, M - s0 - S1[t])\n        t = len(S1)-1\n        for s0 in S0:\n            while t > 0 and s0 + S1[t-1] >= M:\n                t -= 1\n            if s0 + S1[t] >= M:\n                ans = min(ans, s0 + S1[t] - M)\n    write(\"%d\\n\" % ans)\nsolve()\n"
  },
  {
    "language": "Python",
    "code": "def solve():\n    n,m,a,b,p,q = map(int,input().split())\n    if a==1 and b==1:\n        if (p+q)*n <= m:\n            return m - (p+q)*n\n        else:\n            k = m//(p+q)\n            return min(m-k*(p+q),(k+1)*(p+q)-m)\n    else:\n        ans = m\n        for i in range(min(n-1,40),-1,-1):\n            f = p*(a**i) + q*(b**i)\n            if m < f:\n                ans = min(ans, f-m)\n            else:\n                m -= f\n            ans = min(ans,m)\n        return ans\n\ndef main():\n    print(solve())\n\nif __name__ == '__main__':\n    main()"
  }
]