[
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\nusing namespace std;\nusing llong = long long;\n\nllong n, m;\nvector<llong> maxv;\nvector<llong> minv;\nvector<llong> max_l;\nvector<llong> max_r;\n\nllong solve() {\n  maxv.assign(n + 1, 0);\n  minv.assign(n + 1, 0);\n  max_l.assign(n + 1, 0); // [0, i)\n  max_r.assign(n + 1, 0); // (i, n-1]\n\n  for (int i = 0; i < m; i++) {\n    int s, c;\n    cin >> s >> c;\n    for (int i = 0; i < c; i++) {\n      int id;\n      cin >> id;\n      maxv[id] += s;\n      if (c == 1) minv[id] += s;\n    }\n  }\n\n  for (int i = 1; i <= n; i++) {\n    max_l[i] = max(max_l[i - 1], maxv[i - 1]);\n  }\n  for (int i = n - 1; i > 0; i--) {\n    max_r[i] = max(max_r[i + 1], maxv[i + 1]);\n  }\n\n  llong ans = 0;\n  for (int i = 1; i <= n; i++) {\n    llong mv = max(max_l[i], max_r[i]);\n    ans = max(ans, mv - minv[i] + 1);\n  }\n\n  return ans;\n}\n\nint main() {\n  while (cin >> n >> m, n != 0) {\n    cout << solve() << endl;\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream> #include <iomanip> #include <stack> #include <queue> #include <vector> #include <algorithm> #include <map> #include <set> using namespace std; int main() { int n, m; cin >> n >> m; int s, k, c; while(n != 0 && m != 0){ vector<int> mx(n, 0), mn(n, 0); for(int i = 0; i < m; i++){ cin >> s >> k; for(int j = 0; j < k; j++){ cin >> c; c--; mx[c] += s; } if(k == 1)mn[c] += s; } int ans = 0; for(int i = 0; i < n; i++){ for(int j = 0; j < n; j++){ if(i == j)continue; ans = max(ans, mx[i] - mn[j]); } } cout << ans + 1 << endl; cin >> n >> m; } } \n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = int64_t;\ntemplate <typename T> using V = vector<T>;\n\nbool solve() {\n    ll N, M;\n    cin >> N >> M;\n    if(!(N + M)) return false;\n    V<ll> max_score(N), min_score(N);\n    for(ll i = 0; i < M; i++) {\n        ll S, K;\n        cin >> S >> K;\n        bool one = K == 1;\n        while(K--) {\n            ll c;\n            cin >> c;\n            c--;\n            max_score[c] += S;\n            if(one) min_score[c] += S;\n        }\n    }\n\n    ll ans = 0;\n    for(ll i = 0; i < N; i++) {\n        ll max_diff = 0;\n        for(ll j = 0; j < N; j++) {\n            if(i == j) continue;\n            max_diff = max(max_diff, max_score[i] - min_score[j]);\n        }\n        ans = max(ans, max_diff);\n    }\n\n    cout << ans + 1 << endl;\n    return true;\n}\n\nint main() {\n    while(solve());\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nconst int INF = 1e9;\n\nint main(void) {\n  int N, M;\n  while (cin >> N >> M, N||M) {\n    vector<int> maxi(N, 0);\n    vector<int> mini(N, 0);\n\n    for (int i=0; i<M; i++) {\n      int S, K; \n      cin >> S >> K;\n\n      for (int j=0; j<K; j++) {\n        int C; cin >> C;\n        C--;\n\n        if (K == 1) {\n          mini[C] += S;\n        }\n        maxi[C] += S;\n      }\n    }\n\n    int ans = 0;\n    for (int i=0; i<N; i++) {\n      int min_mini = INF;\n      for (int j=0; j<N; j++) {\n        if (i == j) continue;\n        min_mini = min(min_mini, mini[j]);\n      }\n      ans = max(ans, maxi[i] - min_mini + 1);\n    }\n    cout << ans << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define ll int\n\nint main(){\n\tll n,m;\n\twhile(cin>>n>>m){\n\t\tif(n==0&&m==0)break;\n\t\tll s[m+5],k[m+5];\n\t\tll c[m+5][n+5];\n\t\tfor(ll i=0;i<m;i++){\n\t\t\tcin>>s[i]>>k[i];\n\t\t\tfor(ll j=0;j<k[i];j++){\n\t\t\t\tcin>>c[i][j];\n//\t\t\t\tc[i][j]--;\n\t\t\t}\n\t\t}\n\t\tll maxans[n+5];\n\t\tll minans[n+5];\n\t\tmemset(maxans,0,sizeof(maxans));\n\t\tmemset(minans,0,sizeof(minans));\n\t\tfor(ll i=0;i<m;i++){\n\t\t\tfor(ll j=0;j<k[i];j++){\n\t\t\t\tmaxans[c[i][j]]+=s[i];\n\t\t\t\t//cout<<maxans[c[i][j]]<<endl;\n\t\t\t}\n\t\t}\n\n\t\tll M=0;\n\t\tll v=0;\n\t\tbool isok=false;\n\t\tfor(ll i=1;i<n+1;i++){\n\t\t\tif(M<=maxans[i]){\n\t\t\t\tM = maxans[i];\n\t\t\t\tv = i;\n\t\t\t\tif(M==maxans[i])isok=true;\n\t\t\t}\n\t\t}\n\t\tll mm=1e9;\n\t\tbool flag=false;\n\t\tfor(ll i=0;i<m;i++){\n\t\t\tif(k[i]==1)minans[c[i][0]]+=s[i];\n\t\t//\tcout<<minans[c[i][0]]<<endl;\n\t\t}\n\t\tfor(ll i=1;i<n+1;i++){\n\t\t\tif(i==v)continue;\n\t\t\tmm = min(minans[i],mm);\n\t\t}\n\t\t//cout<<\"M:\"<<M<<\" m:\"<<mm<<endl;\n\t\tcout<<M-mm+1<<endl;\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#include<boost/lambda/lambda.hpp>\nusing namespace std;\n\nint main(){\n    int n,m;\n    while(cin>>n>>m,n){\n        vector<int> s(m);\n        vector<int> k(m);\n        vector<vector<int>> c(m);\n        for(int i=0;i<m;i++){\n            cin>>s[i]>>k[i];            \n            c[i].assign(k[i],0);\n            for(int j=0;j<k[i];j++){\n                cin>>c[i][j];\n                c[i][j]--;\n            }\n        }\n        vector<pair<int,int>> bsc(n);\n        for(int i=0;i<n;i++) bsc[i].first=0,bsc[i].second=i;\n        for(int i=0;i<m;i++){\n            if(k[i]==1) bsc[c[i][0]].first+=s[i];\n        }\n        vector<int> gsc(n);\n        for(int i=0;i<m;i++){\n            for(int j=0;j<k[i];j++){\n                gsc[c[i][j]]+=s[i];\n            }\n        }\n        sort(bsc.begin(),bsc.end());\n        int res=0;\n        for(int i=0;i<n;i++){            \n            if(bsc[0].second==i){\n                res=max(res,gsc[i]-bsc[1].first+1);\n            }\n            else{\n                res=max(res,gsc[i]-bsc[0].first+1);\n            }\n        }\n        cout<<res<<endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing ull = unsigned long long;\n\nconst long double PI = acos(-1);\nconstexpr long double EPS = 1e-15;\nconstexpr int inf = 2e9;\nconstexpr ll INF = 2e18;\nconstexpr ll MOD = 1e9+7;\nconstexpr ll MOD1 = 998244353;\ntypedef pair<ll,ll> P;\n\n//#define all(v) (v).begin(), (v).end()\n#define rep(i,a,b) for (int i = (a); i < (b); i++)\n#define REP(i,n) rep(i,0,n)\n#define sz(s) (s).size()\n#define pb push_back\n#define fi first\n#define se second\n//#define mp make_pair\n\ntemplate<class T>\nvoid maxi(T &a, const T &b){\n    if(a < b) a = b;\n}\ntemplate<class T>\nvoid mini(T &a, const T &b){\n    if(a > b) a = b;\n}\n\nint n, m;\nint ss[11234], alone[11234];\n\nvoid solve() {\n    int ssa = 0, alonea = 100000000;\n    int count = 0;\n    REP(i, n){\n        maxi(ssa, ss[i]);\n    }\n    REP(i, n){\n        count += ss[i] == ssa;\n    }\n    REP(i, n){\n        if(!(ss[i] == ssa && count == 1)){\n            mini(alonea, alone[i]);\n        }\n    }\n    // REP(i, n) cout << ss[i] << \" \\n\"[i == n - 1];\n    // REP(i, n) cout << alone[i] << \" \\n\"[i == n - 1];\n    cout << ssa - alonea + 1 << endl;\n}\n\nint main(int argc, char *argv[]){\n\n  /*ICPC*/\n  while (cin >> n >> m, n && m) {\n    REP(i, m){\n      int s, k;\n      int c[11234];\n      cin >> s >> k;\n      REP(j, k){\n          cin >> c[j];\n          --c[j];\n      }\n      REP(j, k) ss[c[j]] += s;\n      if(k == 1) alone[c[0]] += s;  \n    }\n    solve();\n    REP(i, m){\n        ss[i] = alone[i] = 0;\n    }\n  }\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define REP(i,s,n) for(int i=s;i<n;++i)\n#define rep(i,n) REP(i,0,n)\n#define IINF INT_MAX\n#define LLINF LLONG_MAX\n\nusing namespace std;\n\n\ntypedef long long ll;\n\nint N,M;\nll S[1010];\nvector<int> c[1010];\n\nvoid compute() {\n  ll maxi = 0;\n  REP(win,1,N+1) {\n    unordered_map<int,ll> fix;\n    ll mini = LLINF;\n    ll score = 0;\n    rep(i,M) {\n      int pos = -1;\n      rep(j,(int)c[i].size()) if( c[i][j] == win ) {\n\tpos = j;\n\tbreak;\n      }\n      if( pos == -1 ) {\n\tif( c[i].size() == 1 ) {\n\t  fix[c[i][0]] += S[i];\n\t}\n      } else {\n\tscore += S[i];\n      }\n    }\n\n    for(auto v : fix) {\n      if( v.first != win ) {\n\tmini = min(mini,v.second);\n      }\n    }\n    if( fix.size() != N-1 ) mini = 0;\n    if( mini == LLINF ) mini = 0;\n    //cout << \"win = \" << win << \" \" << score << \" - \" << mini << \" + 1\" << endl;\n    maxi = max(maxi,score-mini+1LL);\n  }\n  cout << maxi << endl;\n}\n\nint main() {\n  while( cin >> N >> M, N|M ) {\n    rep(i,1010) c[i].clear();\n    rep(i,M) {\n      cin >> S[i];\n      c[i].clear();\n      int k;\n      cin >> k;\n      c[i].resize(k);\n      rep(j,k) cin >> c[i][j];\n    }\n    compute();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include\"bits/stdc++.h\"\n\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\nusing pii = pair<int, int>;\nusing pll = pair<ll, ll>;\n\n#define FOR(k,m,n) for(ll (k)=(m);(k)<(n);(k)++)\n#define REP(i,n) FOR((i),0,(n))\n#define WAITING(str) int str;std::cin>>str;\n#define DEBUGING(str) cout<< #str << \" \" str<<endl\n\nconstexpr int INF = (1 << 30);\nconstexpr ll INFL = (1ll << 60);\nconstexpr ll MOD = 1000000007;// 10^9+7\n\n\n\nint main()\n{\n\twhile (true) {\n\t\tint N, M;\n\t\tcin >> N >> M;\n\t\tif(N==0)break;\n\t\tvector<pair<int, int>> mm(N);\n\t\tREP(i, M) {\n\t\t\tint s, k, tmp;\n\t\t\tcin >> s >> k;\n\t\t\t// maximum\n\t\t\tREP(j, k) {\n\t\t\t\tcin >> tmp;\n\t\t\t\ttmp--;\n\t\t\t\tmm[tmp].first += s;\n\t\t\t}\n\t\t\t// minimum\n\t\t\tif (k == 1)mm[tmp].second += s;\n\t\t}\n\t\tvector<pair<int, int>> mini, maxi;\n\t\tREP(i, N) {\n\t\t\tmaxi.push_back({ mm[i].first,i });\n\t\t\tmini.push_back({ mm[i].second,i });\n\t\t}\n\t\tsort(maxi.begin(), maxi.end(), greater<pair<int,int>>());\n\t\tsort(mini.begin(), mini.end());\n\t\tif (maxi.front().second != mini.front().second) {\n\t\t\tcout << maxi.front().first - mini.front().first + 1 << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << max(\n\t\t\t\tmaxi.front().first - mini[1].first,\n\t\t\t\tmaxi[1].first - mini.front().first\n\t\t\t) + 1 << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cmath>\n#include<cstring>\n#include<unordered_map>\n#include<cassert>\n#include<climits>\n#include<vector>\n#include<deque>\n#include<map>\n#include<set>\n#include<algorithm>\n#include<bitset>\n#include<queue>\n#include<sstream>\n\n#define REP(i,s,n) for(int i=s;i<n;++i)\n#define rep(i,n) REP(i,0,n)\n#define IINF INT_MAX\n#define LLINF LLONG_MAX\n\nusing namespace std;\n\n\ntypedef long long ll;\n\nint N,M;\nll S[1010];\nvector<int> c[1010];\n\nconst ll base = 100000;\nvoid compute() {\n  ll maxi = 0;\n  unordered_map<ll,int> mp;\n  rep(i,M) rep(j,(int)c[i].size()) mp[i+c[i][j]*base] = j;\n\n  REP(win,1,N+1) {\n    unordered_map<int,ll> fix;\n    ll mini = LLINF;\n    ll score = 0;\n    rep(i,M) {\n      int pos = -1;\n      if( mp.count(i+win*base)) pos = mp[i+win*base];\n      if( pos == -1 ) {\n\tif( c[i].size() == 1 ) {\n\t  fix[c[i][0]] += S[i];\n\t}\n      } else {\n\tscore += S[i];\n      }\n    }\n    if( score+1LL <= maxi ) continue;\n    for(auto v : fix) {\n      if( v.first != win ) {\n\tmini = min(mini,v.second);\n      }\n    }\n    if( (int)fix.size() != N-1 ) mini = 0;\n    if( mini == LLINF ) mini = 0;\n    //cout << \"win = \" << win << \" \" << score << \" - \" << mini << \" + 1\" << endl;\n    maxi = max(maxi,score-mini+1LL);\n  }\n  cout << maxi << endl;\n}\n\nint main() {\n  while( cin >> N >> M, N|M ) {\n    rep(i,M) {\n      cin >> S[i];\n      c[i].clear();\n      int k;\n      cin >> k;\n      c[i].resize(k);\n      rep(j,k) cin >> c[i][j];\n    }\n    compute();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define rep(i,m,k) for(int i=m;i<k;i++)\n\nint main(){\n    while(1){\n        int n,m;\n        cin >> n >> m;\n        if(n == 0 && m == 0 ) break;\n\n        vector<pair<long long , long long >> v(n);\n        rep(i,0,m){\n            int s,k;\n            cin >> s >> k;\n            rep(j,0,k){\n                int p;\n                cin >> p;\n                p--;\n                v[p].first += s;\n                if(k == 1) v[p].second += s;\n            }\n        }\n\n        /*\n        rep(i,0,n){\n            cout << i << \":\" << v[i].first << \" \" << v[i].second << endl;\n        }\n        */\n\n        long long M = 0 , mi = 0x7FFFFFFF;\n        map<int,bool> mp = {};\n        rep(i,0,n){\n            if( M < v[i].first ){\n                mp = map<int,bool> ();\n                mp[i] = true;\n                M = v[i].first;\n            }\n            else if(M == v[i].first){\n                mp[i] = true;\n            }\n        }\n\n        rep(i,0,n){\n            if( v[i].second < mi&& !mp[i]){\n                mi = v[i].second;\n            }\n        }\n        cout << M - mi + 1 << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\n\nbool cc[1000][10000];\nint main()\n{\n\twhile(1)\n\t{\n\t\tint n,m;\n\t\tcin>>n>>m;\n\t\tif(m==0)\n\t\t\tbreak;\n\t\tint s[1000];\n\t\tint k[1000];\n\t\tfill(cc[0],cc[1000],false);\n\t\tfor(int i=0;i<m;i++)\n\t\t{\n\t\t\tcin>>s[i];\n\t\t\tcin>>k[i];\n\t\t\tfor(int j=0;j<k[i];j++)\n\t\t\t{\n\t\t\t\tint c;\n\t\t\t\tcin>>c;\n\t\t\t\tc--;\n\t\t\t\tcc[i][c]=true;\n\t\t\t}\n\t\t}\n\n\t\t//それぞれの人間が取りうる最高点と最低点を調べる\n\t\tll score[10000][2];\n\t\tfor(int i=0;i<n;i++)\n\t\t{\n\t\t\tscore[i][0]=0;\n\t\t\tscore[i][1]=0;//最低点\n\t\t\tfor(int j=0;j<m;j++)\n\t\t\t{\n\t\t\t\t//もしiしか正解できない問題ならiが取らなくてはならない\n\t\t\t\tif(cc[j][i] && k[j]==1)\n\t\t\t\t\tscore[i][1]+=s[j];\n\t\t\t\t\n\t\t\t\tif(cc[j][i])\n\t\t\t\t\tscore[i][0]+=s[j];\n\t\t\t}\n\t\t}\n\n\t\tll ans=0;\n\t\t//iが最高点を取りjが最低点を取ったときの点差を調べる\n\t\tfor(int i=0;i<n;i++)\n\t\t{\n\t\t\t//cout<<score[i][0]<<\" \"<<score[i][1]<<endl;//fordebug\n\t\t\tfor(int j=0;j<n;j++)\n\t\t\t{\n\t\t\t\tif(i==j)\n\t\t\t\t\tcontinue;\n\t\t\t\tans=max(ans,score[i][0]-score[j][1]);\n\t\t\t}\n\t\t}\n\t\tans++;\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <list>\n#define llint long long\n\nusing namespace std;\n\nllint n, m;\nllint lb[10005], ub[10005];\nllint lmax[10005], rmax[10005];\n\nint main(void)\n{\n\twhile(1){\n\t\tcin >> n >> m;\n\t\tif(n == 0 && m == 0) break;\n\t\t\n\t\tfor(int i = 1; i <= n; i++) lb[i] = ub[i] = 0;\n\t\tllint s, k, x;\n\t\tfor(int i = 1; i <= m; i++){\n\t\t\tcin >> s >> k;\n\t\t\tfor(int j = 0; j < k; j++){\n\t\t\t\tcin >> x;\n\t\t\t\tub[x] += s;\n\t\t\t\tif(k == 1) lb[x] += s;\n\t\t\t}\n\t\t}\n\t\tfor(int i = 1; i <= n; i++) lmax[i] = max(lmax[i-1], ub[i]);\n\t\trmax[n+1] = 0;\n\t\tfor(int i = n; i >= 1; i--) rmax[i] = max(rmax[i+1], ub[i]);\n\t\t\n\t\tllint ans = 0;\n\t\tfor(int i = 1; i <= n; i++) ans = max(ans, max(lmax[i-1], rmax[i+1]) - lb[i]);\n\t\tcout << ans+1 << endl;\n\t}\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <deque>\n#include <list>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <utility>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <complex>\n#include <cmath>\n#include <limits>\n#include <cfloat>\n#include <climits>\n#include <ctime>\n#include <cassert>\n#include <numeric>\n#include <fstream>\n#include <functional>\n#include <bitset>\n\nusing namespace std;\n#define int long long int\nconst int INF = 1001001001001001LL;\nconst int MOD = 1000000007;\n\nstruct info{\n    int mi, ma;\n    info(){\n        mi = 0;\n        ma = 0;\n    }\n};\n\nsigned main(){\n    \n    while(1){\n\n    int n, m; cin >> n >> m;\n    if(!n) break;\n    vector<info> p(n);\n    \n    for(int i = 0; i < m; i++){\n        int s, k; cin >> s >> k;\n        if(k == 1){\n            int id; cin >> id;\n            id--;\n            p[id].mi += s;\n            p[id].ma += s;\n        }else{\n            for(int j = 0; j < k; j++){\n                int id; cin >> id;\n                id--;\n                p[id].ma += s;\n            }\n        }\n    }\n\n    int ans = 0;\n    \n\n    for(int i = 0; i < n; i++){\n        for(int j = 0; j < n; j++){\n            if(i == j) continue;\n            ans = max(ans, p[j].ma - p[i].mi + 1);\n       }\n    }\n\n    cout << ans << endl;\n\n    }\n    return 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<iomanip>\n#include<cmath>\n#include<vector>\n#include<algorithm>\n\nusing namespace std;\n\n#define int long long\n#define endl \"\\n\"\n\nconstexpr long long INF = (long long)1e18;\nconstexpr long long MOD = 1'000'000'007; \n\nstring yn(bool f){return f?\"Yes\":\"No\";}\nstring YN(bool f){return f?\"YES\":\"NO\";}\n\n\nsigned main(){\n\tcin.tie(nullptr);\n\tios::sync_with_stdio(false);\n\tcout<<fixed<<setprecision(10);\n\t\n\twhile(true) {\n\t\tint ans = 0;\n\t\tint N, M;\n\t\tvector<int> s1, s2, S;\n\t\tvector<int> min1, min2;\n\t\t\n\t\tcin>>N>>M;\n\t\t\n\t\tif(!N && !M) break;\n\t\t\n\t\ts1.resize(N);\n\t\ts2.resize(N);\n\t\tS.resize(M);\n\t\t\n\t\tfor(int i = 0; i < M; i++){\n\t\t\tint k;\n\t\t\t\n\t\t\tcin>>S[i]>>k;\n\t\t\t\n\t\t\tfor(int j = 0; j < k; j++){\n\t\t\t\tint c;\n\t\t\t\t\n\t\t\t\tcin>>c;\n\t\t\t\t\n\t\t\t\tc--;\n\t\t\t\t\n\t\t\t\ts1[c] += S[i];\n\t\t\t\t\n\t\t\t\tif(k == 1) s2[c] += S[i];\n\t\t\t}\n\t\t}\n\t\t\n\t\tmin1 = s2;\n\t\tmin2 = s2;\n\t\t\n\t\tfor(int i = 1; i < N; i++){\n\t\t\tmin1[i] = min(min1[i], min1[i-1]);\n\t\t}\n\t\t\n\t\tfor(int i = N-2; i >= 0; i--){\n\t\t\tmin2[i] = min(min2[i], min2[i+1]);\n\t\t}\n\t\t\n\t\tfor(int i = 0; i < N; i++){\n\t\t\tint minimum = INF;\n\t\t\t\n\t\t\tif(i) minimum = min1[i-1];\n\t\t\tif(i+1!=N) minimum = min(min2[i+1], minimum);\n\t\t\t\n\t\t\tans = max(ans, s1[i] - minimum + 1);\n\t\t}\n\t\t\n\t\tcout<<ans<<endl;\n\t}\n\t\n\t\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)   FOR(i,0,n)\n#define pb emplace_back\ntypedef long long ll;\ntypedef pair<int,int> pint;\n\nint amx[10001],amn[10001];\nint main(){\n    int n,m;\n    while(cin>>n>>m,n|m){\n        memset(amx,0,sizeof(amx));\n        memset(amn,0,sizeof(amn));\n        int s,k,c;\n        rep(i,m){\n            cin>>s>>k;\n            rep(j,k){\n                cin>>c;\n                --c;\n                if(k==1) amx[c]+=s,amn[c]+=s;\n                else amx[c]+=s;\n            }\n        }\n        int mx=0,mn=1000100010,ans=0;\n        rep(i,n){\n            ans=max(ans,amx[i]-mn);\n            ans=max(ans,-amn[i]+mx);\n            mx=max(mx,amx[i]);\n            mn=min(mn,amn[i]);\n        }\n        cout<<ans+1<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\n#define INF 1e+18\nusing namespace std;\n\nbool ok[10000][1000];\n\nsigned main(){\n\tint n,m;\n\twhile(cin >> n >> m,n){\n\t\tint s[1000],ans = 0,point[10000] = {};\n\t\tfor(int i = 0;i < n;i++){\n\t\t\tfor(int j = 0;j < m;j++) ok[i][j] = false;\n\t\t}\n\t\tfor(int i = 0;i < m;i++){\n\t\t\tint k;\n\t\t\tcin >> s[i] >> k;\n\t\t\tfor(int j = 0;j < k;j++){\n\t\t\t\tint c;\n\t\t\t\tcin >> c; c--;\n\t\t\t\tif(k == 1){\n\t\t\t\t\tpoint[c] += s[i];\n\t\t\t\t\ts[i] = 0;\n\t\t\t\t}\n\t\t\t\tok[c][i] = true;\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < n;i++){\n\t\t\tint score = point[i],mi = INF;\n\t\t\tfor(int j = 0;j < n;j++){\n\t\t\t\tif(i != j) mi = min(mi,point[j]);\n\t\t\t}\n\t\t\tfor(int j = 0;j < m;j++){\n\t\t\t\tif(ok[i][j]) score += s[j];\n\t\t\t}\n\t\t\tans = max(ans,score - mi);\n\t\t}\n\t\tcout << ans + 1 << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main(void) {\n    while(true) {\n        int n, m;\n        cin >> n >> m;\n        if(n == 0 && m == 0) break;\n        vector<int> win(n, 0), lose(n, 0);\n        for(int i = 0; i < m; i++) {\n            int s, k;\n            cin >> s >> k;\n            if(k == 1) {\n                int c;\n                cin >> c;\n                lose[c - 1] += s;\n                win[c - 1] += s;\n            }\n            else {\n               for(int j = 0; j < k; j++) {\n                   int c;\n                   cin >> c;\n                   win[c - 1] += s;\n                }\n            }\n        }\n    \n        int fmin = INT_MAX, smin = INT_MAX;\n        for(int i = 0; i < n; i++) {\n            if(fmin > lose[i]) {\n                smin = fmin;\n                fmin = lose[i];\n            }\n            else if(smin > lose[i]) smin = min(smin, lose[i]);\n        }\n        int ans = -1;\n        for(int i = 0; i < n; i++) {\n            int diff = win[i] - (lose[i] == fmin ? smin : fmin);\n            ans = max(ans, diff + 1);\n        }\n            cout << ans << \"\\n\";\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define ll long long\n#define fi first\n#define se second\n#define pb push_back\n#define rep(i, s, n) for (int i = s; i < n; i++)\n#define rrep(i, s, n) for (int i = (n)-1; i >= (s); i--)\n#define REP(i,n) for(int i = 0;i < n; i++)\n#define all(a) a.begin(),a.end()\ntypedef pair<int,int>pint;\ntypedef vector<int>vint;\ntypedef vector<pint>vpint;\nconst long long MOD = 1000000007, INF = 1e18;\n \n#define endl '\\n'\n#define IOS() ios_base::sync_with_stdio(0);cin.tie(0)\n \ntemplate<class T>inline bool chmax(T& a,T b){if(a<b){a=b;return true;}return false;}\ntemplate<class T>inline bool chmin(T& a,T b){if(a>b){a=b;return true;}return false;}\ntemplate<typename T>vector<T>\nmake_v(size_t a){return vector<T>(a);}\ntemplate<typename T,typename... Ts>\nauto make_v(size_t a,Ts... ts){\n\treturn vector<decltype(make_v<T>(ts...))>(a,make_v<T>(ts...));\n}\n \ntemplate<typename T,typename V>\ntypename enable_if<is_class<T>::value==0>::type\nfill_v(T &t,const V &v){t=v;}\n \ntemplate<typename T,typename V>\ntypename enable_if<is_class<T>::value!=0>::type\nfill_v(T &t,const V &v){\n\tfor(auto &e:t) fill_v(e,v);\n}\n\n/*bool operator<(const data &d)const{\n\treturn hoge;\n}*/\n\nint N,M;\n\n\nint solve(){\n\tvector<int>g[M];\n\tvector<int>point(M);\n\tvector<int>maxPoint(N,0);\n\tvector<int>minPoint(N,0);\n\trep(i,0,M){\n\t\tcin>>point[i];\n\t\tint t;\n\t\tcin>>t;\n\t\trep(j,0,t){\n\t\t\tint tt;\n\t\t\tcin>>tt;\n\t\t\ttt--;\n\t\t\tg[i].push_back(tt);\n\t\t\tmaxPoint[tt] += point[i];\n\t\t\tif(t==1)minPoint[tt] += point[i];\n\t\t}\n\t}\n\tint ret = 0;\n\trep(i,0,N){\n\t\trep(j,0,N){\n\t\t\tif(i==j)continue;\n\t\t\tchmax(ret,maxPoint[i]-minPoint[j]+1);\n\t\t}\n\t}\n\treturn ret;\n}\n \nsigned main(){\n\tIOS();\n\tvector<int>ans;\n\twhile(cin>>N>>M,N||M){\n\t\tint t = solve();\n\t\tans.push_back(t);\n\t}\n\tfor(auto e:ans){\n\t\tcout<<e<<endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cmath>\n#include<cstring>\n#include<unordered_map>\n#include<cassert>\n#include<climits>\n#include<vector>\n#include<deque>\n#include<map>\n#include<set>\n#include<algorithm>\n#include<bitset>\n#include<queue>\n#include<sstream>\n\n#define REP(i,s,n) for(int i=s;i<n;++i)\n#define rep(i,n) REP(i,0,n)\n#define IINF INT_MAX\n#define LLINF LLONG_MAX\n\nusing namespace std;\n\n\ntypedef long long ll;\n\nint N,M;\nll S[1010];\nvector<int> c[1010];\n\nconst ll base = 100000;\nvoid compute() {\n  ll maxi = 0;\n  unordered_map<ll,int> mp;\n  rep(i,M) rep(j,(int)c[i].size()) mp[i+c[i][j]*base] = j;\n\n  REP(win,1,N+1) {\n    unordered_map<int,ll> fix;\n    ll mini = LLINF;\n    ll score = 0;\n    rep(i,M) {\n      int pos = -1;\n      if( mp.count(i+win*base)) pos = mp[i+win*base];\n      if( pos == -1 ) {\n\tif( c[i].size() == 1 ) {\n\t  fix[c[i][0]] += S[i];\n\t}\n      } else {\n\tscore += S[i];\n      }\n    }\n\n    for(auto v : fix) {\n      if( v.first != win ) {\n\tmini = min(mini,v.second);\n      }\n    }\n    if( fix.size() != N-1 ) mini = 0;\n    if( mini == LLINF ) mini = 0;\n    //cout << \"win = \" << win << \" \" << score << \" - \" << mini << \" + 1\" << endl;\n    maxi = max(maxi,score-mini+1LL);\n  }\n  cout << maxi << endl;\n}\n\nint main() {\n  while( cin >> N >> M, N|M ) {\n    rep(i,M) {\n      cin >> S[i];\n      c[i].clear();\n      int k;\n      cin >> k;\n      c[i].resize(k);\n      rep(j,k) cin >> c[i][j];\n    }\n    compute();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);++(i))\n#define all(x) (x).begin(),(x).end()\n#define pb push_back\n#define fi first\n#define se second\n#define dbg(x) cout<<#x\" = \"<<((x))<<endl\ntemplate<class T,class U> ostream& operator<<(ostream& o, const pair<T,U> &p){o<<\"(\"<<p.fi<<\",\"<<p.se<<\")\";return o;}\ntemplate<class T> ostream& operator<<(ostream& o, const vector<T> &v){o<<\"[\";for(T t:v){o<<t<<\",\";}o<<\"]\";return o;}\n\nint main(){\n    int n,m;\n    while(scanf(\" %d %d\", &n, &m),n){\n        vector<int> mx(n),mn(n);\n        rep(i,m){\n            int s,k;\n            scanf(\" %d %d\", &s, &k);\n\n            rep(j,k){\n                int c;\n                scanf(\" %d\", &c);\n                --c;\n\n                mx[c] += s;\n                if(k==1) mn[c] +=s;\n            }\n        }\n\n        multiset<int> s;\n        rep(i,n) s.insert(mn[i]);\n\n        int ans = 0;\n        rep(i,n){\n            s.erase(s.find(mn[i]));\n            int MN = *s.begin();\n            ans = max(ans, mx[i]-MN);\n            s.insert(mn[i]);\n        }\n        cout << ans+1 << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define D(x) cout << #x \" = \" << x << endl\n#define DD(x, y) cout << \"(\" #x \", \" #y \") = (\" << x << \", \" << y << \")\" << endl\n#define DDD(x, y, z) cout << \"(\" #x \", \" #y \", \" #z \") = (\" << x << \", \" << y << \", \" << z << \")\" << endl\n#define DV(v) for (auto __macro_vi : v){ cout << __macro_vi << \" \";} cout << endl;\n#define DA(a, n) for (int __macro_i = 0; __macro_i < n; ++__macro_i) { cout << a[__macro_i] << \" \"; } cout << endl;\n#define REP(i, n) for (int i = 0; i < n; ++i)\n#define ALL(v) (v).begin(), (v).end()\n#include<iostream>\n#include<vector>\n#include<cassert>\n#include<cmath>\n#include<algorithm>\n#include<climits>\n\nusing namespace std;\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    while(1) {\n        int n, m;\n        cin >> n >> m;\n        if (n == 0) break;\n        vector<int> mn(n, 0);\n        vector<int> mx(n, 0);\n        REP(i, m) {\n            int s, k;\n            cin >> s >> k;\n            if (k == 1) {\n                int c0;\n                cin >> c0;\n                mn[c0 - 1] += s;\n                mx[c0 - 1] += s;\n            } else {\n                REP(j, k) {\n                    int cj;\n                    cin >> cj;\n                    mx[cj - 1] += s;\n                }\n            }\n        }\n        auto mxe = max_element(ALL(mx));\n        auto mne = min_element(ALL(mn));\n        if (distance(mx.begin(), mxe) != distance(mn.begin(), mne)) {\n            cout << *mxe - *mne + 1 << endl;\n            // D('?');\n            continue;\n        }\n        auto mxv = *mxe;\n        auto mnv = *mne;\n        *mxe = -1;\n        *mne = INT_MAX;\n        auto mxv2 = *max_element(ALL(mx));\n        auto mnv2 = *min_element(ALL(mn));\n        cout << max(mxv - mnv2, mxv2 - mnv) + 1 << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define REP(i,b,e) for(int i=(b);i<(e);++i)\n#define rep(i,e) for(int i=0;i<(e);++i)\n\nint n, m, s, k, c;\n\nint main() {\n  while(cin>>n>>m){\n    if(n==0) return 0;\n    int ma[10010]={}, mi[10010]={};\n\n    rep(i, m){\n      cin>>s>>k;\n      rep(j,k){\n        cin>>c; c--;\n        ma[c]+=s;\n        if(k==1) mi[c]+=s;\n      }\n    }\n    int ans = 0;\n    rep(i, n)rep(j, n){\n      if(i!=j) ans=max(ans, ma[i]-mi[j]+1);\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MAX_N 10005\nint N,M;\nint main(){\n  while(cin>>N>>M){\n    int Min[MAX_N]={},Max[MAX_N]={};\n    if(M==0&&N==0)break;\n    for(int i=0;i<M;i++){\n      int p,k,id;\n      cin>>p>>k;\n      for(int j=0;j<k;j++){\n        cin>>id;\n        id--;\n        if(k==1){\n          Min[id]+=p;\n        }\n        Max[id]+=p;\n      }\n    }\n    int ans=0;\n    for(int i=0;i<N;i++){\n      for(int j=0;j<i;j++){\n        if(Max[i]>Min[j])\n          ans=max(ans, abs(Max[i]-Min[j]) );\n        \n        if(Max[j]>Min[i])\n          ans=max(ans, abs(Max[j]-Min[i]) );\n      }\n    }\n    cout<<ans+1<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define REP(i, s, n) for (int i = s; i < n; ++i)\n#define rep(i, n) REP(i, 0, n)\n#define SORT(c) sort((c).begin(), (c).end())\n#define IINF INT_MAX\n#define LLINF LLONG_MAX\n#define DEBUG true\n// sort(a.begin(), a.end(), std::greater<int>());\n\n/*\nstd::vector<std::string> split(const std::string &input, char delimiter)\n{\n    std::istringstream stream(input);\n\n    std::string field;\n    std::vector<std::string> result;\n    while (std::getline(stream, field, delimiter))\n    {\n        result.push_back(field);\n    }\n    return result;\n}\n*/\n\nint main()\n{\n    int n, m;\n    while (cin >> n >> m)\n    {\n        if (n == 0 && m == 0)\n            break;\n        vector<int> mx(n + 1);\n        vector<int> mn(n + 1);\n        int a, b;\n        rep(j, m)\n        {\n            cin >> a >> b;\n\n            rep(i, b)\n            {\n                int temp;\n                cin >> temp;\n                if (b == 1)\n                    mn[temp] += a;\n                mx[temp] += a;\n            }\n        }\n        int hoge = 0;\n        int hogeposi = 0;\n        int piyo = 0;\n        int piyoposi = 0;\n        rep(i, mx.size())\n        {\n            if (hoge < mx[i])\n            {\n                hoge = mx[i];\n                hogeposi = i;\n            }\n        }\n        rep(i, mn.size())\n        {\n            if (piyo < mn[i] && i != hogeposi)\n            {\n                piyo = mn[i];\n                piyoposi = i;\n            }\n        }\n        cout << mx[hogeposi] - mn[piyoposi] + 1 << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#include<cctype>\n#include<math.h>\n#include<string>\n#include<string.h>\n#include<stack>\n#include<queue>\n#include<vector>\n#include<utility>\n#include<set>\n#include<map>\n#include<stdlib.h>\n#include<iomanip>\n\nusing namespace std;\n\n#define ll long long\n#define ld long double\n#define EPS 0.0000000001\n#define INF 1e9\n#define MOD 1000000007\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define loop(i,a,n) for(int i=a;i<(n);i++)\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n\n#define int ll //!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\n\nint gcd(int a, int b){\n    if(b==0) return a;\n    return gcd(b,a%b);\n}\nint lcm(int a, int b){\n    return a*b/gcd(a,b);\n}\n\n\nsigned main(void) {\n    int i,j;\n    int n,m;\n    while(cin >> n >> m, n){\n        vi l(n);\n        vector<pii> h(n);\n        rep(i,n)h[i].second = i;\n        rep(i,m){\n            int s,k;\n            cin >> s >> k;\n            rep(j,k){\n                int t;\n                cin >> t;\n                t--;\n                if(k == 1)l[t] += s;\n                h[t].first += s;\n            }\n        }\n        //rep(i,n)cout << l[i] << \" \" << h[i].first << \" \" << h[i].second << endl;\n        sort(all(h));\n        int ans = 0;\n        rep(i,n){\n            //cout << \" \" << i << \" \" << l[i] << \" \" << h[n-1].second << endl;\n            if(h[n-1].second == i){\n                ans = max(ans, h[n-2].first - l[i]);\n            }else{\n                ans = max(ans, h[n-1].first - l[i]);\n            }\n            //cout << ans << endl;\n        }\n        cout << ans+1 << endl;\n\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <math.h>\nusing namespace std;\ntypedef long long ll;\n\nint main(void){\n    while (1) {\n        ll n, m;\n        cin >> n >> m;\n        if (n == 0 && m == 0) return 0;\n        \n        ll dc[10010], my[10010];\n        for (int i = 0; i < n; i++) {\n            dc[i] = 0;  my[i] = 0;\n        }\n        \n        for (int i = 0; i < m; i++) {\n            ll s, k;\n            cin >> s >> k;\n            for (int i = 0; i < k; i++) {\n                ll c;\n                cin >> c;\n                c--;\n                if (k == 1) dc[c] += s;\n                else my[c] += s;\n            }\n        }\n        \n        vector<pair<ll, ll> > sm, sm2;\n        for (int i = 0; i < n; i++) {\n            sm.emplace_back(dc[i] + my[i], i);\n            sm2.emplace_back(dc[i], i);\n        }\n        \n        sort(sm.begin(), sm.end());\n        sort(sm2.begin(), sm2.end());\n        \n        //for (int i = 0; i < n; i++) cout << sm[i].first << \" \" << sm[i].second << endl;\n        //for (int i = 0; i < n; i++) cout << sm2[i].first << \" \" << sm2[i].second << endl;\n        \n        if (sm[n - 1].second != sm2[0].second) cout << sm[n - 1].first - sm2[0].first + 1 << endl;\n        else {\n            cout << max(sm[n - 2].first - sm2[0].first, sm[n - 1].first - sm2[1].first) + 1 << endl;;\n        }\n        \n        \n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "/*  -*- coding: utf-8 -*-\n *\n * 2825.cc: Quiz\n */\n\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<iostream>\n#include<string>\n#include<vector>\n#include<map>\n#include<set>\n#include<stack>\n#include<list>\n#include<queue>\n#include<deque>\n#include<algorithm>\n#include<numeric>\n#include<utility>\n#include<complex>\n#include<functional>\n \nusing namespace std;\n\n/* constant */\n\nconst int MAX_N = 10000;\nconst int MAX_M = 1000;\nconst int INF = 1 << 30;\n\n/* typedef */\n\ntypedef pair<int,int> pii;\n\n/* global variables */\n\npii minscs[MAX_N];\nint maxscs[MAX_N];\n\n/* subroutines */\n\n/* main */\n\nint main() {\n  for (;;) {\n    int n, m;\n    scanf(\"%d%d\", &n, &m);\n    if (n == 0) break;\n\n    for (int i = 0; i < n; i++) minscs[i] = pii(0, i);\n    fill(maxscs, maxscs + n, 0);\n\n    for (int i = 0; i < m; i++) {\n      int si, ki;\n      scanf(\"%d%d\", &si, &ki);\n\n      for (int j = 0; j < ki; j++) {\n\tint cj;\n\tscanf(\"%d\", &cj);\n\tcj--;\n\tmaxscs[cj] += si;\n\tif (ki == 1) minscs[cj].first += si;\n      }\n    }\n\n    sort(minscs, minscs + n);\n    int &minsc0 = minscs[0].first, &mini0 = minscs[0].second;\n    int &minsc1 = minscs[1].first, &mini1 = minscs[1].second;\n\n    int maxd = 0;\n    for (int i = 0; i < n; i++) {\n      int d = maxscs[i] - (mini0 != i ? minsc0 : minsc1);\n      if (maxd < d) maxd = d;\n    }\n    printf(\"%d\\n\", maxd + 1);\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n\n#define REP(i, a, b) for (int i = int(a); i < int(b); i++)\n#ifdef _DEBUG_\n#define dump(val) cerr << __LINE__ << \":\\t\" << #val << \" = \" << (val) << endl\n#else\n#define dump(val)\n#endif\n\nusing namespace std;\n\ntypedef long long int ll;\n\ntemplate<typename T>\nvector<T> make_v(size_t a, T b) {\n    return vector<T>(a, b);\n}\ntemplate<typename... Ts>\nauto make_v(size_t a, Ts... ts) {\n    return vector<decltype(make_v(ts...))>(a, make_v(ts...));\n}\n\nint main() {\n    cin.tie(nullptr);\n    ios::sync_with_stdio(false);\n    int N, M;\n    while (cin >> N >> M, N + M) {\n        vector<ll> maxPoint(N, 0);\n        vector<ll> forcePoint(N, 0);\n        REP(i, 0, M) {\n            int S, k;\n            cin >> S >> k;\n            if (k == 1) {\n                int c;\n                cin >> c;\n                forcePoint[c - 1] += S;\n                maxPoint[c - 1] += S;\n            } else {\n                REP(j, 0, k) {\n                    int c;\n                    cin >> c;\n                    maxPoint[c - 1] += S;\n                }\n            }\n        }\n        vector<int> ind1(N), ind2(N);\n        REP(i, 0, N) {\n            ind1[i] = ind2[i] = i;\n        }\n        sort(begin(ind1), end(ind1), [&](int a, int b) -> bool {\n            return forcePoint[a] < forcePoint[b];\n        });\n        sort(begin(ind2), end(ind2), [&](int a, int b) -> bool {\n            return maxPoint[a] > maxPoint[b];\n        });\n\n        ll ans = 0;\n        if (ind1[0] == ind2[0]) {\n            ans = max(maxPoint[ind2[1]] - forcePoint[ind1[0]], maxPoint[ind2[0]] - forcePoint[ind1[1]]);\n        } else {\n            ans = maxPoint[ind2[0]] - forcePoint[ind1[0]];\n        }\n        cout << ans + 1 << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main() {\n    while(1){\n        int n,m;\n        cin >> n >> m;\n        if(n==0&&m==0)break;\n        vector<pair<int,int>> mas(n,{0,0}),mis(n,{0,0});\n        for(int i=0;i<n;i++){\n            mas[i].second=i;\n            mis[i].second=i;\n        }\n        for(int i=0;i<m;i++){\n            int s,k;\n            cin >> s >> k;\n            if(k==1){\n                int t;\n                cin >> t;\n                t--;\n                mas[t].first+=s;\n                mis[t].first+=s;\n            }else{\n                for(int j=0;j<k;j++) {\n                    int t;\n                    cin >> t;\n                    t--;\n                    mas[t].first += s;\n                }\n            }\n        }\n        sort(mis.begin(),mis.end());\n        sort(mas.begin(),mas.end());\n        int ans=mas.back().first-mis[0].first+1;\n        if(mas.back().second==mis[0].second){\n            int t1=mas.back().first-mis[1].first+1;\n            int t2=mas[mas.size()-2].first-mis[0].first+1;\n            ans=max(t1,t2);\n        }\n        cout << ans << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cmath>\n#include<cstring>\n#include<unordered_map>\n#include<cassert>\n#include<climits>\n#include<vector>\n#include<deque>\n#include<map>\n#include<set>\n#include<algorithm>\n#include<bitset>\n#include<queue>\n#include<sstream>\n\n#define REP(i,s,n) for(int i=s;i<n;++i)\n#define rep(i,n) REP(i,0,n)\n#define IINF INT_MAX\n#define LLINF LLONG_MAX\n\nusing namespace std;\n\n\ntypedef long long ll;\n\nint N,M;\nll S[1010];\nvector<int> c[1010];\n\nconst ll base = 100000;\nvoid compute() {\n  ll maxi = 0;\n  unordered_map<ll,int> mp;\n  rep(i,M) rep(j,(int)c[i].size()) mp[i+c[i][j]*base] = j;\n\n  REP(win,1,N+1) {\n    unordered_map<int,ll> fix;\n    ll mini = LLINF;\n    ll score = 0;\n    rep(i,M) {\n      int pos = -1;\n      if( mp.count(i+win*base)) pos = mp[i+win*base];\n      if( pos == -1 ) {\n\tif( c[i].size() == 1 ) {\n\t  fix[c[i][0]] += S[i];\n\t}\n      } else {\n\tscore += S[i];\n      }\n    }\n\n    for(auto v : fix) {\n      if( v.first != win ) {\n\tmini = min(mini,v.second);\n      }\n    }\n    if( fix.size() != N-1 ) mini = 0;\n    if( mini == LLINF ) mini = 0;\n    //cout << \"win = \" << win << \" \" << score << \" - \" << mini << \" + 1\" << endl;\n    maxi = max(maxi,score-mini+1LL);\n  }\n  cout << maxi << endl;\n}\n\nint main() {\n  while( cin >> N >> M, N|M ) {\n    rep(i,M) {\n      cin >> S[i];\n      c[i].clear();\n      int k;\n      cin >> k;\n      c[i].resize(k);\n      rep(j,k) cin >> c[i][j];\n    }\n    compute();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i, n) for (int i = 0; i < n; i++)\n#define ALL(obj) obj.begin(), obj.end()\n#define fcout cout << setprecision(10)\n\nconst int iINF = 1e9;\nconst long long llINF = 1e18;\nconst int MOD = 1e9 + 7;\n\nusing namespace std;\n\ntemplate <typename T>\nvoid debug(vector<T> &vec) {\n    for (auto x : vec) {\n        cout << x << \" \";\n    }\n    cout << endl;\n    return;\n}\n\ntemplate <typename A, size_t N, typename T>\nvoid FILL(A (&array)[N], const T &val) {\n    std::fill((T *)array, (T *)(array + N), val);\n}\n\ntemplate <typename T>\nint getFormer(const vector<T> &vec, T x) {\n    return upper_bound(vec.begin(), vec.end(), x) - vec.begin() - 1;\n}\n\ntemplate <typename T>\nint getLatter(const vector<T> &vec, T x) {\n    return lower_bound(vec.begin(), vec.end(), x) - vec.begin();\n}\n\nvoid solve(int N, int M) {\n    vector<pair<long long, int>> maxs(N, make_pair(0, 0)),\n        mins(N, make_pair(0, 0));\n    REP(i, N) {\n        maxs[i].second = i;\n        mins[i].second = i;\n    }\n\n    REP(i, M) {\n        int S, k;\n        REP(j, k) {\n            int c;\n            cin >> c;\n            maxs[c - 1].first += S;\n            j if (k == 1) mins[c - 1].first += S;\n        }\n    }\n\n    sort(ALL(maxs));\n    sort(ALL(mins), greater<pair<long long, int>>());\n\n    if (maxs[0].second == mins[0].second) {\n        cout << max(maxs[0].first - mins[1].first,\n                    maxs[1].first - mins[0].first) +\n                    1\n             << endl;\n    } else {\n        cout << maxs[0].first - mins[0].first + 1 << endl;\n    }\n\n    return;\n}\n\nint main() {\n    int N, M;\n    while (cin >> N >> M && N) {\n        solve(N, M);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,N) for(int i=0;i<(N);i++)\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\nusing namespace std;\nconst long long MOD = 1e9 + 7;\nconst long long INF = 1e12;\nconst int inf = 1e9;\nconst int mod = 1e9+7;\ntypedef long long ll;\ntypedef pair<ll,int> P;\ntypedef set<int> S;\nint main(){\n    cout << fixed << setprecision(10);\n\twhile(1){\n\t\tint n, m; cin >> n >> m;\n\t\tif(!n && !m) break;\n\n\t\tvector<int> sum(n, 0);\n\t\tvector<int> only(n, 0);\n\t\tfor(int i=0; i<m; i++){\n\t\t\tint s, k;\n\t\t\tcin >> s >> k;\n\t\t\tfor(int j=0; j<k; j++){\n\t\t\t\tint c; cin >> c;\n\t\t\t\tc--;\n\t\t\t\tsum[c] += s;\n\t\t\t\tif(k == 1){\n\t\t\t\t\tonly[c] += s;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tint smin = 1000*1000;\n\t\tint smax = -1;\n\t\tint top_idx = -1;\n\t\tfor(int i=0; i<n; i++){\n\t\t\tif(smax < sum[i]){\n\t\t\t\tsmax = sum[i];\n\t\t\t\ttop_idx = i;\n\t\t\t} else if (smax == sum[i]){\n\t\t\t\tif(only[i] > only[top_idx]){\n\t\t\t\t\ttop_idx = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0; i<n; i++){\n\t\t\tif(i == top_idx) continue;\n\t\t\tsmin = min(smin, only[i]);\n\t\t}\n\n\t\tint ans = smax - smin + 1;\n\t\tcout << ans << endl;\n\n\t}\n\treturn 0;\n\n}\n"
  },
  {
    "language": "C++",
    "code": "//#include <bits/stdc++.h>\n//#include <stdio.h>\n#include<iostream>\n#include<cstdio>\n#include<bitset>\n#include<algorithm>\n#include<vector>\n#include<list>\n#include<queue>\n#include<stack>\n#include<string>\n#include<string.h>\n#include<cmath>\n#include<utility>\n#include<functional>\n#include<map>\n#include<set>\n#include<cctype>\n#include<fstream>\n \n \n#define FOR(i, a, b) for( int i=(a);i<=(b);i++)\n#define RFOR(i, a, b) for( int i=(a);i>=(b);i--)\n#define LFOR(i, a, b) for( long long int i=(a);i<=(b);i++)\n#define LRFOR(i, a, b) for(long long int i=(a);i>=(b);i--)\n#define MOD 1000000007\n#define INF 1000000000 //2000000000\n#define LINF 1000000000000000000 //9000000000000000000\n#define PI 3.14159265358979\n#define MAXI 7500000\n \nusing namespace std;\ntypedef long long int ll;\ntypedef pair< long long int, long long  int> P;\n \nint dy[5] = { 0,0,1,-1,0 };\nint dx[5] = { 1,-1,0,0,0 };\n \nint main(void){\n\n\twhile(1){\n\t\tint n,m;\n\t\tint maxi=0;\n\n\t\tcin>>n>>m;\n\t\tif(n==0&&m==0){\n\t\t\tbreak;\n\t\t}\n\n\t\tvector<int> s(m+1),k(m+1);\n\t\tint c;\n\t\tvector<P> total(n);\n\t\tvector<P> mini(n);\n\n\t\tFOR(i,0,n-1){\n\t\t\ttotal[i].second=i+1;\n\t\t\tmini[i].second=i+1;\n\t\t\ttotal[i].first=0;\n\t\t\tmini[i].first=0;\n\t\t}\n\n\t\tFOR(i,1,m){\n\t\t\tcin>>s[i]>>k[i];\n\t\t\tFOR(j,1,k[i]){\n\t\t\t\tcin>>c;\n\t\t\t\ttotal[c-1].first+=s[i];\n\t\t\t\tif(k[i]==1){\n\t\t\t\t\tmini[c-1].first+=s[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tsort(total.begin(),total.end());\n\t\tsort(mini.begin(),mini.end());\n\n\t\tif(total[n-1].second==mini[0].second){\n\t\t\tcout<<total[n-1].first-mini[1].first+1<<endl;\n\t\t}else{\n\t\t\tcout<<total[n-1].first-mini[0].first+1<<endl;\n\t\t}\n\t\t\n\t\t\n\t}\n\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n\n    while(1){\n        int n, m; cin >> n >> m;\n        if(!n) break;\n        vector<int> max_score(n, 0);\n        vector<int> min_score(n, 0);\n\n        for(int i = 0; i < m; i++){\n            int s, k; cin >> s >> k;\n            vector<int> c(k);\n            for(int j = 0; j < k; j++){\n                cin >> c[j];\n                c[j]--;\n                max_score[c[j]] += s;\n            }\n            \n            if(k == 1){\n                min_score[c[0]] += s;\n            }\n        }\n\n        int ans = 0;\n\n        for(int i = 0; i < n; i++){\n            for(int j = 0; j < n; j++){\n                if(i == j) continue;\n\n                ans = max(ans, max_score[i] - min_score[j] + 1);\n            }\n        }\n    \n    cout << ans << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing ull = unsigned long long;\n\nconst long double PI = acos(-1);\nconstexpr long double EPS = 1e-15;\nconstexpr int inf = 2e9;\nconstexpr ll INF = 2e18;\nconstexpr ll MOD = 1e9+7;\nconstexpr ll MOD1 = 998244353;\ntypedef pair<ll,ll> P;\n\n//#define all(v) (v).begin(), (v).end()\n#define rep(i,a,b) for (int i = (a); i < (b); i++)\n#define REP(i,n) rep(i,0,n)\n#define sz(s) (s).size()\n#define pb push_back\n#define fi first\n#define se second\n//#define mp make_pair\n\ntemplate<class T>\nvoid maxi(T &a, const T &b){\n   if(a < b) a = b;\n}\ntemplate<class T>\nvoid mini(T &a, const T &b){\n   if(a > b) a = b;\n}\n\nint n, m;\nint ss[11234], alone[11234];\n\nvoid solve() {\n    int ans = 0;\n    REP(i,n) {\n        REP(j,n) {\n            if (i == j) continue;\n            ans = max(ans, ss[i] - alone[j] + 1);\n        }\n    }\n    cout << ans << endl;\n}\n\nint main(int argc, char *argv[]){\n    while (cin >> n >> m, n && m) {\n    REP(i, m){\n        int s, k;\n        int c[11234];\n        cin >> s >> k;\n        REP(j, k){\n            cin >> c[j];\n            --c[j];\n        }\n        REP(j, k) ss[c[j]] += s;\n        if(k == 1) alone[c[0]] += s;\n    }\n    solve();\n    REP(i, n){\n        ss[i] = alone[i] = 0;\n    }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize(\"O3\")\n#include<cstdio>\n#include<map>\nusing namespace std;\n#define f(i,n) for(int i=0;i<int(n);i++)\n#define N 200000\n\n\nint main() {\n\tint a[N];\n\tint b[N];\n\tint n, m, k;\n\tint x, y;\n\tint m1, m2, mm;\n\tint ans;\n\twhile(true) {\n\t\tscanf(\"%d %d\", &n, &m);\n\t\tif ((n == 0) && (m == 0))break;\n\t\tf(i, n) {\n\t\t\ta[i] = 0;\n\t\t\tb[i] = 0;\n\t\t}\n\t\tf(i, m) {\n\t\t\tscanf(\"%d\", &x);\n\t\t\tscanf(\"%d\", &k);\n\t\t\tf(j, k) {\n\t\t\t\tscanf(\"%d\", &y);\n\t\t\t\ty--;\n\t\t\t\tif (k == 1)a[y] += x;\n\t\t\t\tb[y] += x;\n\t\t\t}\n\t\t}\n\t\tm1 = 1000000000;\n\t\tm2 = 1000000000;\n\t\tf(i, n) {\n\t\t\tif (a[i] < m1) {\n\t\t\t\tm1 = a[i];\n\t\t\t\tmm = i;\n\t\t\t}\n\t\t\telse if (a[i] < m2) {\n\t\t\t\tm2 = a[i];\n\t\t\t}\n\t\t}\n\t\tans = 0;\n\t\tf(i, n) {\n\t\t\tx = b[i] - m1 + 1;\n\t\t\tif (mm == i)x = b[i] - m2 + 1;\n\t\t\tif (ans < x)ans = x;\n\t\t}\n\t\tprintf(\"%d\\n\", ans);\n\t}\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\ntypedef long long ll;\n\nint solve(void);\n\nint main(void)\n{\n\twhile (solve())\n\t{\n\t}\n\n\treturn 0;\n}\n\nint solve(void)\n{\n\tll N, M;\n\tcin >> N >> M;\n\tif(!(N|M)) { return 0; }\n\n\t// v[i][0] = min, v[i][1] = max\n\tvector<vector<ll>> v(N, vector<ll>(2, 0));\n\tfor (ll i = 0; i < M; i++)\n\t{\n\t\tll S, k;\n\t\tcin >> S >> k;\n\t\tfor (ll j = 0; j < k; j++)\n\t\t{\n\t\t\tll c;\n\t\t\tcin >> c;\n\t\t\t// update min\n\t\t\tif (k == 1) {\n\t\t\t\tv[c-1][0] += S;\n\t\t\t}\n\t\t\t// update max\n\t\t\tv[c-1][1] += S;\n\t\t}\n\t}\n\n\tll ans = 0;\n\tfor (ll i = 0; i < N; i++)\n\t{\n\t\tfor (ll j = 0; j < N; j++) {\n\t\t\tif(i == j) continue;\n\t\t\tans = max(ans, v[i][1] - v[j][0] + 1);\n\t\t}\n\t}\n\n\tcout << ans << endl;\n\n\treturn 1;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int INF = 1 << 30;\n\nbool solve() {\n\tint N, M;\n\tcin >> N >> M;\n\tif (N == 0) return false;\n\n\tvector<int> S(M);\n\tvector<vector<int>> C(M);\n\tfor(int i = 0; i < M; ++i) {\n\t\tcin >> S[i];\n\t\tint K;\n\t\tcin >> K;\n\t\tC[i].resize(K);\n\t\tfor(auto& c : C[i]) {\n\t\t\tcin >> c;\n\t\t}\n\t}\n\n\tvector<int> mi(N + 1, 0), ma(N + 1, 0);\n\tfor(int i = 0; i < M; ++i) {\n\t\tfor(auto c : C[i]) {\n\t\t\tma[c] += S[i];\n\t\t}\n\t\tif (C[i].size() == 1) {\n\t\t\tmi[C[i][0]] += S[i];\n\t\t}\n\t}\n\n\tvector<int> mafore(N + 2);\n\tmafore[0] = 0;\n\tfor(int i = 1; i <= N; ++i) {\n\t\tmafore[i] = max(mafore[i - 1], ma[i]);\n\t}\n\n\tvector<int> maback(N + 2);\n\tmafore[N + 1] = 0;\n\tfor(int i = N; i >= 1; --i) {\n\t\tmaback[i] = max(maback[i + 1], ma[i]);\n\t}\n\n\tint ans = 0;\n\tfor(int i = 1; i <= N; ++i) {\n\t\tint score = max(mafore[i - 1], maback[i + 1]) - mi[i];\n\t\tans = max(ans, score);\n\t}\n\tcout << ans + 1 << endl;\n\treturn true;\n}\n\nint main(){\n\twhile(solve()){}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i, n) for (int i = 0; i < n; i++)\n#define ALL(obj) obj.begin(), obj.end()\n#define fcout cout << setprecision(10)\n\nconst int iINF = 1e9;\nconst long long llINF = 1e18;\nconst int MOD = 1e9 + 7;\n\nusing namespace std;\n\ntemplate <typename T>\nvoid debug(vector<T> &vec) {\n    for (auto x : vec) {\n        cout << x << \" \";\n    }\n    cout << endl;\n    return;\n}\n\ntemplate <typename A, size_t N, typename T>\nvoid FILL(A (&array)[N], const T &val) {\n    std::fill((T *)array, (T *)(array + N), val);\n}\n\ntemplate <typename T>\nint getFormer(const vector<T> &vec, T x) {\n    return upper_bound(vec.begin(), vec.end(), x) - vec.begin() - 1;\n}\n\ntemplate <typename T>\nint getLatter(const vector<T> &vec, T x) {\n    return lower_bound(vec.begin(), vec.end(), x) - vec.begin();\n}\n\nvoid solve(int N, int M) {\n    vector<int> S(M), k(M);\n    vector<vector<int>> c(M + 1, vector<int>(N + 1, 0));\n    REP(i, M) {\n        cin >> S[i] >> k[i];\n        REP(j, k[i]) { cin >> c[i][j]; }\n    }\n\n    vector<long long> maxs(N, 0), mins(N, llINF);\n    long long res = 0;\n    REP(i, M) {\n        REP(j, k[i]) { maxs[c[i][j] - 1] += S[i]; }\n    }\n\n    sort(ALL(maxs), greater<long long>());\n\n    REP(i, M) {\n        if (k[i] != 1) continue;\n        REP(j, k[i]) { mins[c[i][j] - 1] = S[i] + (mins[c[i][j] - 1] == llINF ? 0 : mins[c[i][j] - 1]); }\n    }\n\n    sort(ALL(mins));\n\n    if (maxs[0] == mins[0]) {\n        cout << maxs[0] + 1 << endl;\n    } else {\n        cout << maxs[0] - mins[0] + 1 << endl;\n    }\n\n    return;\n}\n\nint main() {\n    int N, M;\n    while (cin >> N >> M && N) {\n        solve(N, M);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint main() {\n\twhile(1) {\n\t\tint n, m;\n\t\tcin >> n >> m;\n\t\tif((n == 0)&&(m == 0)) {\n\t\t\tbreak;\n\t\t} else {\n\t\t\tvector<long long int> arr_max(n, 0);\n\t\t\tvector<long long int> arr_min(n, 0);\n\t\t\tfor(int i = 0; i < m; i++) {\n\t\t\t\tint s, k, c;\n\t\t\t\tcin >> s >> k;\n\t\t\t\tfor(int j = 0; j < k; j++) {\n\t\t\t\t\tcin >> c;\n\t\t\t\t\tc--;\n\t\t\t\t\tarr_max[c] += s;\n\t\t\t\t\tif(k == 1) arr_min[c] += s;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlong long int ans = 0;\n\t\t\tfor(int i = 0; i < n; i++) {\n\t\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\t\tif(i != j) {\n\t\t\t\t\t\tif(ans < arr_max[i] - arr_min[j]) ans = arr_max[i] - arr_min[j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcout << ans + 1 << endl;\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\nint a[1<<17],b[1<<17];\nmain()\n{\n\tint n,m;\n\twhile(cin>>n>>m,n)\n\t{\n\t\tfor(int i=0;i<n;i++)a[i]=b[i]=0;\n\t\tfor(;m--;)\n\t\t{\n\t\t\tint s,k;cin>>s>>k;\n\t\t\tif(k==1)\n\t\t\t{\n\t\t\t\tint x;cin>>x;\n\t\t\t\tx--;\n\t\t\t\ta[x]+=s;\n\t\t\t\tb[x]+=s;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor(;k--;)\n\t\t\t\t{\n\t\t\t\t\tint x;cin>>x;x--;b[x]+=s;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans=1e9;\n\t\tint id=0;\n\t\tfor(int i=0;i<n;i++)\n\t\t{\n\t\t\tif(a[id]>a[i])id=i;\n\t\t}\n\t\tint M=0;\n\t\tfor(int i=0;i<n;i++)if(i!=id)M=max(M,b[i]);\n\t\tans=M-a[id]+1;\n\t\tid=0;\n\t\tfor(int i=0;i<n;i++)\n\t\t{\n\t\t\tif(b[id]<b[i])id=i;\n\t\t}\n\t\tM=1e9;\n\t\tfor(int i=0;i<n;i++)if(i!=id)M=min(M,a[i]);\n\t\tans=max(ans,b[id]-M+1);\n\t\tcout<<ans<<endl;\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\nint main(){\n\twhile(1){\n\t\tint num,M,k,ans,S,c;\n\t\tlong N[10000]={},N2[10000]={};\n\t\tscanf(\"%d %d\",&num,&M);\n\t\tif(num==0&&M==0)break;\n\t\tfor(int i=0;i<M;i++){\n\t\t\tscanf(\"%d %d\",&S,&k);\n\t\t\tfor(int j=0;j<k;j++){\n\t\t\t\tscanf(\"%d\",&c);\n\t\t\t\tN[c-1]+=S;\n\t\t\t\tif(k==1){\n\t\t\t\t\tN2[c-1]+=S;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint MAX,MIN;\n\t\tMAX=N[0];\n\t\tMIN=N2[0];\n\t\tfor(int i=1;i<num;i++){\n\t\t\tif(MAX<N[i]){\n\t\t\t\tMAX=N[i];\n\t\t\t}\n\t\t\tfor(int j=0;j<num;j++){\n\t\t\t\tif(N[j]==MAX){\n\t\t\t\t\tN2[j]=N[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(MIN>N2[i]){\n\t\t\t\tMIN=N2[i];\n\t\t\t}\n\t\t}\n\t\tans=MAX-MIN+1;\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cmath>\n#include<cstring>\n#include<unordered_map>\n#include<cassert>\n#include<climits>\n#include<vector>\n#include<deque>\n#include<map>\n#include<set>\n#include<algorithm>\n#include<bitset>\n#include<queue>\n#include<sstream>\n\n#define REP(i,s,n) for(int i=s;i<n;++i)\n#define rep(i,n) REP(i,0,n)\n#define IINF INT_MAX\n#define LLINF LLONG_MAX\n\nusing namespace std;\n\n\ntypedef long long ll;\n\nint N,M;\nll S[1010];\nvector<int> c[1010];\ntypedef pair<int,int> ii;\n\nvoid compute() {\n  ll maxi = 0;\n  map<ii,int> mp;\n  rep(i,M) rep(j,(int)c[i].size()) mp[ii(i,c[i][j])] = j;\n\n  REP(win,1,N+1) {\n    unordered_map<int,ll> fix;\n    ll mini = LLINF;\n    ll score = 0;\n    rep(i,M) {\n      int pos = -1;\n      if( mp.count(ii(i,win))) pos = mp[ii(i,win)];\n      if( pos == -1 ) {\n\tif( c[i].size() == 1 ) {\n\t  fix[c[i][0]] += S[i];\n\t}\n      } else {\n\tscore += S[i];\n      }\n    }\n\n    for(auto v : fix) {\n      if( v.first != win ) {\n\tmini = min(mini,v.second);\n      }\n    }\n    if( fix.size() != N-1 ) mini = 0;\n    if( mini == LLINF ) mini = 0;\n    //cout << \"win = \" << win << \" \" << score << \" - \" << mini << \" + 1\" << endl;\n    maxi = max(maxi,score-mini+1LL);\n  }\n  cout << maxi << endl;\n}\n\nint main() {\n  while( cin >> N >> M, N|M ) {\n    rep(i,M) {\n      cin >> S[i];\n      c[i].clear();\n      int k;\n      cin >> k;\n      c[i].resize(k);\n      rep(j,k) cin >> c[i][j];\n    }\n    compute();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\n#define REP(i,n) for(ll i=0;i<ll(n);++i)\n#define RREP(i,n) for(ll i=ll(n)-1;i>=0;--i)\n#define FOR(i,m,n) for(ll i=m;i<ll(n);++i)\n#define RFOR(i,m,n) for(ll i=ll(n)-1;i>=ll(m);--i)\n#define ALL(v) (v).begin(),(v).end()\n#define UNIQUE(v) v.erase(unique(ALL(v)),v.end());\n#define INF 1000000001ll\n#define MOD 1000000007ll\n#define EPS 1e-9\n\nconstexpr int dx[8] = { 1,1,0,-1,-1,-1,0,1 };\nconstexpr int dy[8] = { 0,1,1,1,0,-1,-1,-1 };\n\n\nusing namespace std;\n\nusing ll = long long;\nusing vi = vector<int>;\nusing vl = vector<ll>;\nusing vvi = vector<vi>;\nusing vvl = vector<vl>;\nusing pii = pair<int, int>;\nusing pll = pair<ll, ll>;\n\ntemplate <class T> bool chmin(T &a, T b) { if (a > b) { a = b; return true; } return false; }\ntemplate <class T> bool chmax(T &a, T b) { if (a < b) { a = b; return true; } return false; }\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tint n, m;\n\twhile (cin >> n >> m, n) {\n\t\tvvl v(m);\n\t\tvl s(m);\n\t\tREP(i, m) {\n\t\t\tint a; cin >> a;\n\t\t\ts[i] = a;\n\t\t\tint k; cin >> k;\n\t\t\tv[i].resize(k);\n\t\t\tREP(j, v[i].size()) {\n\t\t\t\tcin >> v[i][j];\n\t\t\t\tv[i][j]--;\n\t\t\t}\n\t\t}\n\t\tvl l(n, 0), r(n, 0);\n\t\tREP(i, m) {\n\t\t\tif (v[i].size() == 1)l[v[i][0]] += s[i];\n\t\t\tREP(j, v[i].size())r[v[i][j]] += s[i];\n\t\t}\n\t\tll ans = 0;\n\t\tREP(i, n) {\n\t\t\tREP(j, n) {\n\t\t\t\tif (i == j)continue;\n\t\t\t\tchmax(ans, r[i] - l[j] + 1);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\ntemplate <class T> using vec = vector<T>;\ntemplate <class T> using vvec = vector<vec<T>>;\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    int N,M;\n    while(cin >> N >> M && N){\n        vec<int> mi(N),ma(N);\n        for(int i=0;i<M;i++){\n            int s,k;\n            cin >> s >> k;\n            for(int j=0;j<k;j++){\n                int c;\n                cin >> c;\n                c--;\n                ma[c] += s;\n                if(k==1) mi[c] += s;\n            }\n        }\n        vec<int> L(N+1,1e9),R(N+1,1e9);\n        for(int i=0;i<N;i++) L[i+1] = min(L[i],mi[i]);\n        for(int i=N-1;i>=0;i--) R[i] = min(R[i+1],mi[i]);\n        int ans = 0;\n        for(int i=0;i<N;i++){\n            int now = min(L[i],R[i+1]);\n            ans = max(ans,max(0,ma[i]-now));\n        }\n        cout << ans+1 << \"\\n\";\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n\nint main() {\n  ll N, M;\n  while (cin >> N >> M, N) {\n    auto S = vector<ll>(M);\n    auto k = vector<ll>(M);\n    auto c = vector<vector<ll>>(M);\n    auto sum = vector<ll>(N, 0);\n    auto q = vector<vector<ll>>(N);\n    for (int i = 0; i < M; ++i) {\n      cin >> S[i] >> k[i];\n      c[i] = vector<ll>(k[i]);\n      for (int j = 0; j < k[i]; ++j) {\n        cin >> c[i][j]; --c[i][j];\n        sum[c[i][j]] += S[i];\n        q[c[i][j]].push_back(i);\n      }\n    }\n    auto maxIt = max_element(begin(sum), end(sum));\n    int idx = distance(begin(sum), maxIt);\n    for (auto&& x : q[idx]) S[x] = 0;\n\n    sum = vector<ll>(N, 0);\n    for (int i = 0; i < M; ++i) {\n      for (int j = 0; j < k[i]; ++j) {\n        sum[c[i][j]] += S[i];\n      }\n    }\n    sum[idx] = 1e9;\n    auto minIt = min_element(begin(sum), end(sum));\n    cout << *maxIt - *minIt + 1 << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define all(x) (x).begin(),(x).end()\nconst int mod=1000000007,MAX=23;\nconst ll INF=1LL<<60;\n\nint main(){\n    \n    std::ifstream in(\"text.txt\");\n    std::cin.rdbuf(in.rdbuf());\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    \n    while(1){\n        int N,M;cin>>N>>M;\n        if(N+M==0) break;\n        vector<int> maxi(N),mini(N);\n        \n        for(int i=0;i<M;i++){\n            int S;cin>>S;\n            int k;cin>>k;\n            for(int j=0;j<k;j++){\n                int a;cin>>a;\n                a--;\n                maxi[a]+=S;\n                if(k==1) mini[a]+=S;\n            }\n        }\n        \n        int ans=0;\n        \n        for(int i=0;i<N;i++){\n            for(int j=0;j<N;j++){\n                if(i==j) continue;\n                \n                ans=max(ans,maxi[i]-mini[j]+1);\n            }\n        }\n        \n        cout<<ans<<endl;\n        \n    }\n    \n    \n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nusing i64 = long long int;\nusing ui64 = unsigned long long int;\n\n////////////////////////////////\n\nstruct d{\n    vector<int> k;\n    int s;\n};\n\nint main()\n{\n    int n,m;\n    while(cin >> n >> m,n||m){\n        vector<d> data(m);\n        for(int i=0;i<m;i++){\n            cin >> data[i].s;\n            int k;\n            cin >> k;\n            data[i].k.resize(k);\n            for(int j=0;j<k;j++){\n                cin >> data[i].k[j];\n            }\n        }\n        vector<int> maxscore(n+1,0);\n        for(int i=0;i<m;i++){\n            int s = data[i].s;\n            for(int j=0;j<data[i].k.size();j++){\n                maxscore[data[i].k[j]]+=s;\n            }\n        }\n        // for(int i=0;i<maxscore.size();i++)cout << maxscore[i] << \" \";\n        // cout << endl;\n        vector<int> bestscore(n+1);\n        sort(data.begin(),data.end(),[](const d& l,const d& r){return l.s>r.s;});\n        for(int i=0;i<m;i++){\n            int bestj = 0;\n            for(int j=0;j<data[i].k.size();j++){\n                int c = data[i].k[j];\n                if(bestscore[bestj]<bestscore[c]||(bestscore[bestj]==bestscore[c]&&maxscore[bestj]<maxscore[c])){\n                    bestj = c;\n                }\n            }\n            bestscore[bestj]+=data[i].s;\n        }\n        // for(int i=0;i<bestscore.size();i++)cout << bestscore[i] << \" \";\n        // cout << endl;\n        sort(bestscore.begin(),bestscore.end());\n        // cout << n << \" \" << m << endl;\n        cout << bestscore.back()-bestscore[1] + 1 << endl;\n    }\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\n#define int ll\ntypedef pair<int,int> pii;\n#define rep(i,n) for(ll i=0;i<(ll)(n);i++)\n#define all(a) (a).begin(),(a).end()\n#define pb emplace_back\n#define INF (1LL<<59)\n\n\nsigned main(){\n    int n,m;\n    while(cin>>n>>m&&(n|m)){\n        vector<int> one(n,0);\n        vector<int> sum(n,0);\n        rep(i,m){\n            int score, k;\n            cin>>score>>k;\n            vector<int> v(k);\n            rep(j,k)cin>>v[j];\n            if(k==1)one[v[0]-1]+=score;\n            rep(j,k){\n                sum[v[j]-1]+=score;\n            }\n        }\n\n        int ans = 0;\n        rep(i,n){\n            rep(j,n){\n                if(i==j)continue;\n                ans = max(ans,sum[i]-one[j]);\n            }\n        }\n        cout<<ans+1<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main(){\n\n    while(true){\n        int N, M;\n        cin >> N >> M;\n        if(N == 0){\n            break;\n        }\n        vector<int> s(M);\n        vector<vector<int>> c(M);\n\n        vector<int> maxScore(N, 0);\n        vector<int> minScore(N, 0);\n\n        for(int i = 0; i < M; i++){\n            cin >> s[i];\n            int k;\n            cin >> k;\n            int temp;\n            if(k == 1){\n                cin >> temp;\n                temp--;\n                minScore[temp] += s[i];\n                maxScore[temp] += s[i];\n            }\n            else{\n                for(int j = 0; j < k; j++){\n                    cin >> temp;\n                    temp--;\n                    maxScore[temp] += s[i];\n                }\n            }\n        }\n\n        vector<pair<int, int>> maxPair(N);\n        vector<pair<int, int>> minPair(N);\n        for(int i = 0; i < N; i++){\n            maxPair[i] = make_pair(maxScore[i], i);\n        }\n        for(int i = 0; i < N; i++){\n            minPair[i] = make_pair(minScore[i], i);\n        }\n\n        sort(maxPair.begin(), maxPair.end(), greater<pair<int, int>>());\n        sort(minPair.begin(), minPair.end());\n\n        int ans = 0;\n        for(int i = 0; i < 2; i++){\n            for(int j = 0; j < 2; j++){\n                auto big = maxPair[i];\n                auto small = minPair[j];\n                if(big.second == small.second){\n                    continue;\n                }\n                ans = max(ans, big.first - small.first);\n            }\n        }\n\n        cout << ans + 1 << endl;\n    }\n\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint main(){\n  while (1){\n    int N, M;\n    cin >> N >> M;\n    if (N == 0 && M == 0){\n      break;\n    }\n    vector<int> mx(N, 0);\n    vector<int> mn(N, 0);\n    for (int i = 0; i < M; i++){\n      int S, k;\n      cin >> S >> k;\n      for (int j = 0; j < k; j++){\n        int c;\n        cin >> c;\n        c--;\n        mx[c] += S;\n        if (k == 1){\n          mn[c] += S;\n        }\n      }\n    }\n    vector<pair<int, int>> mx2(N);\n    for (int i = 0; i < N; i++){\n      mx2[i] = make_pair(mx[i], i);\n    }\n    vector<pair<int, int>> mn2(N);\n    for (int i = 0; i < N; i++){\n      mn2[i] = make_pair(mn[i], i);\n    }\n    sort(mx2.rbegin(), mx2.rend());\n    sort(mn2.begin(), mn2.end());\n    if (mx2[0].second != mn2[0].second){\n      cout << mx2[0].first - mn2[0].first + 1 << endl;\n    } else {\n      cout << max(mx2[0].first - mn2[1].first, mx2[1].first - mn2[0].first) + 1 << endl;\n    }\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <utility>\n\nusing namespace std;\ntypedef pair<int, int> P;\n\nint N, M;\nP minS[10005], maxS[10005];\n\nint main(void)\n{\n\twhile(1){\n\t\tcin >> N >> M;\n\t\tif(N == 0 && M == 0) break;\n\t\t\n\t\tfor(int i = 0; i < N; i++){\n\t\t\tminS[i] = maxS[i] = make_pair(0, i);\n\t\t}\n\t\t\n\t\tfor(int i = 0; i < M; i++){\n\t\t\tint S, k, c;\n\t\t\tcin >> S >> k;\n\t\t\tfor(int j = 0; j < k; j++){\n\t\t\t\tcin >> c;\n\t\t\t\tc--;\n\t\t\t\tif(k == 1) minS[c].first += S;\n\t\t\t\tmaxS[c].first += S;\n\t\t\t}\n\t\t}\n\t\t\n\t\tsort(minS, minS+N);\n\t\tsort(maxS, maxS+N);\n\t\treverse(maxS, maxS+N);\n\t\t\n\t\tint ans = 0;\n\t\tif(minS[0].second == maxS[0].second){\n\t\t\tans = max(maxS[1].first - minS[0].first, maxS[0].first - minS[1].first);\n\t\t}else{\n\t\t\tans = maxS[0].first - minS[0].first;\n\t\t}\n\t\tcout << ans + 1 << endl;\n\t}\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<iomanip>\n#include<stack>\n#include<queue>\n#include<string>\n#include<set>\n#include<map>\n#include<cmath>\n#include<cstring>\nusing namespace std;\n#define rep(i,n) for(int i=0;(i)<(n);(i)++)\n#define FOR(i,m,n) for(int i=(m);(i)<(n);(i)++)\n#define All(v) (v).begin(),(v).end()\n#define MP make_pair\n#define pb push_back\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\nconst int INF = 1<<30;\nconst ll LINF = 1LL<<61;\nconst int MOD = 1e9+7;\n\nint main(){\n    int N, M;\n    while(cin >> N >> M,N|M){\n        vector<int> score(M);\n        vector<vector<int>> cood(M,vector<int>());\n        for (int i = 0;i<M;i++){\n            cin >> score[i];\n            int k;cin >> k;\n            for (int j = 0; j < k;j++){\n                int a;\n                cin >> a;\n                a--;\n                cood[i].push_back(a);\n            }\n        }\n        \n        vector<pair<int,int>> minscore(N),maxscore(N);\n        for (int i = 0;i<N;i++){\n            minscore[i].second = i+1;\n            maxscore[i].second = i + 1;\n        }\n        for (int i = 0; i < M; i++)\n        {\n            for (auto c : cood[i])\n            {\n                if (cood[i].size() == 1)\n                {\n                    minscore[c].first += score[i];\n                    maxscore[c].first += score[i];\n                }\n                else\n                {\n                    maxscore[c].first += score[i];\n                }\n            }\n        }\n            \n        sort(minscore.begin(),minscore.end());\n        sort(maxscore.rbegin(),maxscore.rend());\n        int res = -1;\n        for (int i = 0; i < N; i++)\n        {\n            int ma = maxscore[i].first;\n            int mi = minscore[0].first;\n            if (minscore[0].second == maxscore[i].second)\n                mi = minscore[1].first;\n            res = max(ma - mi + 1, res);\n        }\n        cout << res << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n\nint main() {\n  ll N, M;\n  while (cin >> N >> M, N) {\n    auto S = vector<ll>(M);\n    auto k = vector<ll>(M);\n    auto c = vector<vector<ll>>(M);\n    auto sum = vector<ll>(N, 0);\n    auto q = vector<vector<ll>>(N);\n    for (int i = 0; i < M; ++i) {\n      cin >> S[i] >> k[i];\n      c[i] = vector<ll>(k[i]);\n      for (int j = 0; j < k[i]; ++j) {\n        cin >> c[i][j]; --c[i][j];\n        sum[c[i][j]] += S[i];\n        q[c[i][j]].push_back(i);\n      }\n    }\n    auto maxIt = max_element(begin(sum), end(sum));\n    int idx = distance(begin(sum), maxIt);\n    for (auto&& x : q[idx]) S[x] = 0;\n\n    sum = vector<ll>(N, 0);\n    for (int i = 0; i < M; ++i) {\n      for (int j = 0; j < k[i]; ++j) {\n        sum[c[i][j]] += S[i];\n      }\n    }\n    sum[idx] = 1e18;\n    auto minIt = min_element(begin(sum), end(sum));\n    cout << *maxIt - *minIt + 1 << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define ALL(a) (a).begin(), (a).end()\n#define llong long long\n\nusing namespace std;\n/*\nclass SegmentTree{\n\tvector<llong> tree;\n\tsize_t n;\n\n\tpublic:\n\tSegmentTree(size_t n_){\n\t\tif(n_ == 0)throw std::invalid_argument();\n\t\tn = 1 << (32 - __builtin_clz(n_));\n\t\tsize_t treesize = 2*n;\n\t\ttree = vector<llong>(treesize,LLONG_MIN);\n\t}\n\t~SegmentTree(){}\n\n\tvoid update(size_t idx, llong x){\n\t\tidx += n;\n\t\ttree[idx] = x;\n\t\twhile(idx >>= 1){\n\t\t\ttree[idx] = max(tree[idx<<1 +0] + tree[idx<<1 +1]);\n\t\t}\n\t}\n\n\tllong query(llong a, llong b){\n\t\tllong ret = LLONG_MIN;\n\t\ta += n; b += n;\n\t\tfor(; a < b; a >>= 1, b >>= 1){\n\t\t\tif(a&1)ret = max(ret, tree[a++]);\n\t\t\tif(b&1)ret = max(ret, tree[--b]);\n\t\t}\n\t\treturn ret;\n\t}\n};\n*/\n\nsigned main(){\n\twhile(true){\n\t\tint n,m; cin >> n >> m;\n\t\tif(n == 0)break;\n\t\tvector<llong> s(m),k(m);\n\t\tvector<vector<llong> > c(m, vector<llong>());\n\t\tfor(int i = 0; i < m; i++){\n\t\t\tcin >> s[i] >> k[i];\n\t\t\tc[i].resize(k[i]);\n\t\t\tfor(int j = 0; j < k[i]; j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t\tc[i][j]--;\n\t\t\t}\n\t\t}\n\t\tvector<llong> l(n,0),u(n,0);\n\t\tfor(int i = 0; i < m; i++){\n\t\t\tif(k[i] == 1)l[c[i][0]]+=s[i];\n\t\t\tfor(int j = 0; j < k[i]; j++){\n\t\t\t\tu[c[i][j]] += s[i];\n\t\t\t}\n\t\t}\n\t\tmap<llong, int> ll;\n\t\tfor(auto e : l){\n\t\t\tif(ll.find(e) == ll.end())ll[e] = 0;\n\t\t\tll[e] += 1;\n\t\t}\n\t\tauto mm = ll.lower_bound(0);\n\t\tfor(auto &e : l){\n\t\t\tif(mm->second == 1 && mm->first == e){\n\t\t\t\te = next(mm)->first;\n\t\t\t}\n\t\t\telse{\n\t\t\t\te = mm->first;\n\t\t\t}\n\t\t}\n\t\tllong ans = 0;\n\t\tfor(int i = 0; i < n; i++){\n\t\t\tans = max(ans, u[i]-l[i]);\n\t\t}\n\t\tcout << (ans+1) << endl;\n\t}\n\n\n\n\treturn 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing ll = long long;\n\nint main() {\n    int N, M;\n    while(cin >> N >> M, N) {\n        vector<ll> mi(N), ma(N);\n        for(int i = 0; i < M; ++i) {\n            ll S, k;\n            cin >> S >> k;\n            if(k == 1) {\n                int c;\n                cin >> c;\n                c--;\n                mi[c] += S;\n                ma[c] += S;\n            } else {\n                for(int j = 0; j < k; ++j) {\n                    int c;\n                    cin >> c;\n                    c--;\n                    ma[c] += S;\n                }\n            }\n        }\n        ll res = 0;\n        for(int i = 0; i < N; ++i) {\n            for(int j = 0; j < N; ++j) {\n                if(i == j) {\n                    continue;\n                }\n                res = max(res, ma[j] - mi[i]);\n            }\n        }\n        cout << res + 1 << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n//#define int long long\n#define rep(i,a,b) for(int i=(a);i<(b);i++)\n#define rrep(i,a,b) for(int i=(b)-1;i>=(a);i--)\n#define all(c) begin(c),end(c)\ntemplate<class T> bool chmax(T &a, const T &b) { if (a < b) { a = b; return true; } return false; }\ntemplate<class T> bool chmin(T &a, const T &b) { if (b < a) { a = b; return true; } return false; }\nconst int INF = 0x3f3f3f3f;\n\nint main() {\n\tfor (int N, M; cin >> N >> M&&N;) {\n\t\tvector<int> maxi(N), mini(N);\n\t\trep(i, 0, M) {\n\t\t\tint S, k; cin >> S >> k;\n\t\t\tif (k == 1) {\n\t\t\t\tint c; cin >> c; c--;\n\t\t\t\tmini[c] += S;\n\t\t\t\tmaxi[c] += S;\n\t\t\t}\n\t\t\telse {\n\t\t\t\trep(j, 0, k) {\n\t\t\t\t\tint c; cin >> c; c--;\n\t\t\t\t\tmaxi[c] += S;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tusing P = pair<int, int>;\n\t\tvector<P> maxi2(N), mini2(N);\n\t\trep(i, 0, N) {\n\t\t\tmaxi2[i] = P(maxi[i], i);\n\t\t\tmini2[i] = P(mini[i], i);\n\t\t}\n\t\tsort(all(maxi2));\n\t\treverse(all(maxi2));\n\t\tsort(all(mini2));\n\n\t\tint ans = 0;\n\t\trep(i, 0, 2)rep(j, 0, 2) {\n\t\t\tif (mini2[i].second == maxi2[j].second)\n\t\t\t\tcontinue;\n\t\t\tchmax(ans, maxi2[j].first - mini2[i].first + 1);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n    int N, M;\n    while (cin >> N >> M, N || M) {\n        vector<int> v(N), m(N);\n        for (int i = 0; i < M; i++) {\n            int s, k;\n            cin >> s >> k;\n            if (k == 1) {\n                int t;\n                cin >> t;\n                v[t-1] += s;\n                m[t-1] += s;\n            } else {\n                for (int j = 0; j < k; j++) {\n                    int t;\n                    cin >> t;\n                    v[t-1] += s;\n                }\n            }\n        }\n\n        int first = -1, second = -1, idx, idy;\n        for (int i = 0; i < N; i++) {\n            if (first < v[i]) {\n                second = first;\n                idy = idx;\n                first = v[i];\n                idx = i;\n            } else if (second < v[i]) {\n                second = v[i];\n                idy = i;\n            }\n        }\n\n        int ans = 0;\n        for (int i = 0; i < N; i++) {\n            if (idx == i) {\n                ans = max(ans, second - m[i]);\n            } else {\n                ans = max(ans, first - m[i]);\n            }\n        }\n\n        cout << ans+1 << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<set>\nusing namespace std;\n\nint main(){\n    int n, m;\n    while(cin >> n >> m, n+m){\n        vector<int> a(n, 0), b(n, 0);\n        while(m-- > 0){\n            int s, k;\n            cin >> s >> k;\n            if(k == 1){\n                int x;  cin >> x;\n                x--;\n                a[x] += s, b[x] += s;\n                continue;\n            }\n            while(k-- > 0){\n                int x;  cin >> x;\n                x--;\n                b[x] += s;\n            }\n        }\n        int ans = 0;\n        multiset<int> mins;\n        for(int i = 0; i < n; i++)  mins.insert(a[i]);\n        for(int i = 0; i < n; i++){\n            mins.erase(mins.find(a[i]));\n            ans = max(ans, b[i]-*mins.begin());\n            mins.insert(a[i]);\n        }\n        cout << ans+1 << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nclass Solve {\nprivate:\n\npublic:\n\tbool is_last_query{};\n\tSolve()\n\t{\n\t\tint N, M;\n\t\tscanf(\"%d%d\", &N, &M);\n\t\tif (N == 0 && M == 0)\n\t\t{\n\t\t\tis_last_query = true;\n\t\t\treturn;\n\t\t}\n\n\t\tstd::vector<std::pair<int, int>> min_points(N), max_points(N);\n\t\tfor (int i{}; i < N; i++)\n\t\t\tmin_points[i].second = max_points[i].second = i;\n\t\tfor (int i{}; i < M; i++)\n\t\t{\n\t\t\tint S, k;\n\t\t\tscanf(\"%d%d\", &S, &k);\n\t\t\tif (k == 1)\n\t\t\t{\n\t\t\t\tint c;\n\t\t\t\tscanf(\"%d\", &c);\n\t\t\t\tc--;\n\t\t\t\tmin_points[c].first += S;\n\t\t\t\tmax_points[c].first += S;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor (int j{}; j < k; j++)\n\t\t\t\t{\n\t\t\t\t\tint c;\n\t\t\t\t\tscanf(\"%d\", &c);\n\t\t\t\t\tc--;\n\t\t\t\t\tmax_points[c].first += S;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstd::sort(min_points.begin(), min_points.end());\n\t\tstd::sort(max_points.begin(), max_points.end());\n\t\tint max{};\n\t\tif (min_points.front().second != max_points.back().second)\n\t\t\tmax = max_points.back().first - min_points.front().first;\n\t\telse\n\t\t\tmax = std::max(max_points[N - 2].first - min_points[0].first, max_points[N - 1].first - min_points[1].first);\n\t\t\n\t\tprintf(\"%d\\n\", max + 1);\n\t\treturn;\n\t}\n};\n\nint main()\n{\n\twhile (!Solve().is_last_query);\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cassert>\n#include <cmath>\n#include <cstdio>\n#include <deque>\n#include <iomanip>\n#include <iostream>\n#include <map>\n#include <queue>\n#include <set>\n#include <stack>\n#include <unordered_map>\n#include <unordered_set>\n#include <utility>\n#include <vector>\nusing std::cerr;\nusing std::cin;\nusing std::cout;\nusing std::endl;\n\nstruct Quiz{\n  int score;\n  std::vector<int> solver;\n};\n\nint Solve(int n,int m){\n  std::vector<Quiz> quiz(m);\n  for(int i=0;i<m;i++){\n    Quiz nextquiz;\n    int s,k;\n    cin>>s>>k;\n    nextquiz.score=s;\n    for(int j=0;j<k;j++){\n      int num;\n      cin>>num;\n      nextquiz.solver.push_back(num);\n    }\n    quiz[i]=nextquiz;\n  }\n\n  int max_score[10001]={},min_score[10001]={};\n  for(auto q:quiz){\n    for(auto s:q.solver) {\n      max_score[s] += q.score;\n      if (q.solver.size() == 1) {\n        min_score[s] += q.score;\n      }\n    }\n  }\n\n  int result=0;\n  for(int i=1;i<=n;i++){\n    for(int j=1;j<=n;j++){\n      if(i==j) continue;\n      result=std::max(result,max_score[i]-min_score[j]+1);\n    }\n  }\n  return result;\n\n}\n\nint main(void) {\n  cout << std::fixed << std::setprecision(10);\n  cin.tie(0);\n  std::ios::sync_with_stdio(false);\n\n  while(1){\n    int n,m;\n    cin>>n>>m;\n    if(n==0&&m==0){\n      break;\n    }\n    cout<<Solve(n,m)<<endl;\n  }\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <stack>\n#include <queue>\n#include <vector>\n#include <algorithm>\n#include <map>\n#include <set>\nusing namespace std;\n\nint main() {\n    int n, m;\n    cin >> n >> m;\n\n    int s, k, c;\n    while(n != 0 && m != 0){\n        vector<int> mx(n, 0), mn(n, 0);\n        for(int i = 0; i < m; i++){\n            cin >> s >> k;\n\n            for(int j = 0; j < k; j++){\n                cin >> c;\n                c--;\n                mx[c] += s;\n            }\n            if(k == 1)mn[c] += s;\n        }\n\n        int ans = 0;\n        for(int i = 0; i < n; i++){\n            for(int j = 0; j < n; j++){\n                if(i == j)continue;\n\n                ans = max(ans, mx[i] - mn[j]);\n            }\n        }\n        cout << ans + 1 << endl;\n\n        cin >> n >> m;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <cstring>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <list>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <unordered_set>\n#include <unordered_map>\n#include <array>\n#include <cassert>\n#include <bitset>\nusing namespace std;\nusing LL = long long;\n#define INF 1e+18\n//#define int long long\n\nsigned main() {\n\tint N, M;\n\twhile (cin >> N >> M, N) {\n\t\tvector<LL>S;\n\t\tvector<LL>big(N), sml(N);\n\t\tfor (int i = 0; i < M; ++i) {\n\t\t\tLL s; cin >> s;\n\t\t\tS.push_back(s);\n\t\t\tint k;\n\t\t\tcin >> k;\n\t\t\tfor (int j = 0; j < k; ++j) {\n\t\t\t\tint pe; cin >> pe;\n\t\t\t\tpe--;\n\t\t\t\tbig[pe] += s;\n\t\t\t\tif (k == 1) {\n\t\t\t\t\tsml[pe] += s;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tmultiset<LL, greater<LL>>Big;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tBig.insert(big[i]);\n\t\t}\n\t\tLL ans = 0;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tBig.erase(Big.find(big[i]));\n\t\t\tLL tmp = *Big.begin() - sml[i];\n\t\t\tans = max(ans, tmp);\n\t\t\tBig.insert(big[i]);\n\t\t}\n\t\tcout << ans + 1 << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#if __has_include(\"../library/Basic/Debug.hpp\")\n\n#include \"../library/Basic/Debug.hpp\"\n\n#else\n\n/* ----- Header Files ----- */\n// IO\n#include <cstdio>\n#include <iomanip>\n#include <ios>\n#include <iostream>\n\n// algorithm\n#include <algorithm>\n#include <cmath>\n#include <numeric>\n\n// container\n#include <vector>\n#include <string>\n#include <tuple>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <deque>\n\n// others\n#include <random>\n#include <limits>\n#include <functional>\n#include <ctime>\n#include <cassert>\n#include <cstdint>\n\n\n/* ----- Type Alias ----- */\nusing Int = long long int;\nusing Real = long double;\nusing String = std::string;\ntemplate <class... Ts>\nusing Tuple = std::tuple<Ts...>;\n\ntemplate <class T>\nusing Vector = std::vector<T>;\ntemplate <class T>\nusing Queue = std::queue<T>;\ntemplate <class T>\nusing Stack = std::stack<T>;\ntemplate <class T>\nusing Deque = std::deque<T>;\n\ntemplate <class T>\nusing MaxHeap = std::priority_queue<T>;\ntemplate <class T>\nusing MinHeap = std::priority_queue<T, std::vector<T>, std::greater<T>>;\ntemplate <class T>\nusing Set = std::set<T>;\ntemplate <class T, class U>\nusing Map = std::map<T, U>;\n\ntemplate <class T, class... Us>\nusing Func = std::function<T(Us...)>;\n\ntemplate <class T>\nT genv(T v) { return v; }\n\ntemplate <class T, class... Ts>\nauto genv(size_t l, Ts... ts) {\n    return Vector<decltype(genv<T>(ts...))>(l, Vector<T>(ts...));\n}\n\ntemplate <class Cost = Int>\nstruct Edge {\n    Int src, dst;\n    Cost cost;\n    Edge(Int src = -1, Int dst = -1, Cost cost = 1)\n        : src(src), dst(dst), cost(cost){};\n\n    bool operator<(const Edge<Cost>& e) const { return this->cost < e.cost; }\n    bool operator>(const Edge<Cost>& e) const { return this->cost > e.cost; }\n};\n\ntemplate <class Cost = Int>\nusing Edges = Vector<Edge<Cost>>;\ntemplate <class Cost = Int>\nusing Graph = Vector<Vector<Edge<Cost>>>;\n\n#endif\n\n/* ----- Misc ----- */\nvoid fastio() {\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr);\n}\n\nstruct Fout {\n    Int precision;\n    Fout(Int precision) : precision(precision) {}\n};\nstd::ostream& operator<<(std::ostream& os, const Fout& fio) {\n    os << std::fixed << std::setprecision(fio.precision);\n    return os;\n}\n\n\n/* ----- Constants ----- */\n// constexpr Int INF = std::numeric_limits<Int>::max() / 3;\n// constexpr Int MOD = 1000000007;\n// constexpr Real PI = acos(-1);\n// constexpr Real EPS = 1e-10;\n// std::mt19937 mt(int(std::time(nullptr)));\n\nbool solve() {\n    Int n, m;\n    std::cin >> n >> m;\n    if (n == 0) return false;\n\n    Vector<Int> min(n + 1, 0), max(n + 1, 0);\n    for (Int i = 0; i < m; ++i) {\n        Int s, k;\n        std::cin >> s >> k;\n\n        for (Int j = 0; j < k; ++j) {\n            Int c;\n            std::cin >> c;\n            max[c] += s;\n            if (k == 1) min[c] += s;\n        }\n    }\n\n    Vector<Int> max_fore(n + 2), max_back(n + 2);\n    max_fore[0] = 0;\n    for (Int i = 1; i <= n; ++i) {\n        max_fore[i] = std::max(max_fore[i - 1], max[i]);\n    }\n    max_back[n + 1] = 0;\n    for (Int i = n; i >= 1; --i) {\n        max_back[i] = std::max(max_back[i + 1], max[i]);\n    }\n\n    Int ans = 0;\n    for (Int i = 1; i <= n; ++i) {\n        ans = std::max(ans, std::max(max_fore[i - 1], max_back[i + 1]) - min[i] + 1);\n    }\n    std::cout << ans << std::endl;\n    return true;\n}\n\nint main() {\n    while (solve()) {}\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define ALL(a) (a).begin(), (a).end()\n#define llong long long\n\nusing namespace std;\n\nsigned main(){\n\twhile(true){\n\t\tint n,m; cin >> n >> m;\n\t\tif(n == 0)break;\n\t\tvector<int> s(m), k(m);\n\t\tvector<vector<int>> c(m);\n\t\tfor(int i = 0; i < m; i++){\n\t\t\tcin >> s[i] >> k[i];\n\t\t\tfor(int j = 0; j < k[i]; j++){\n\t\t\t\tint tmp; cin >> tmp;\n\t\t\t\tc[i].push_back(tmp-1);\n\t\t\t}\n\t\t}\n\n\t\tvector<pair<int,int>> mmin(n), mmax(n);\n\t\tfor(int i = 0; i < n; i++){\n\t\t\tmmin[i] = {0,i};\n\t\t\tmmax[i] = {0,i};\n\t\t}\n\t\tfor(int i = 0; i < m; i++){\n\t\t\tif(k[i] == 1) mmin[c[i][0]].first += s[i];\n\t\t\tfor(int j = 0; j < k[i]; j++){\n\t\t\t\tmmax[c[i][j]].first += s[i];\n\t\t\t}\n\t\t}\n\t\tint ans = 0;\n\t\t//for(auto e : mmin)cerr << e.first; cerr << endl;\n\t\t//for(auto e : mmax)cerr << e.first; cerr << endl;\n\t\tsort(ALL(mmin));\n\t\tsort(ALL(mmax), greater<pair<int,int>>());\n\t\tif(mmin[0].second == mmax[0].second){\n\t\t\tans = max(mmax[0].first - mmin[1].first, mmax[1].first - mmin[0].first);\n\t\t}\n\t\telse{\n\t\t\tans = mmax[0].first - mmin[0].first;\n\t\t}\n\t\tans++;\n\n\t\t\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n#include<queue>\n#include<stack>\n#include<map>\n#include<set>\n#include<algorithm>\n#include<functional>\n#include<cstdio>\n#include<cstdlib>\n#include<cmath>\n#include<cassert>\n#include<ctime>\nusing namespace std;\n\n#define mind(a,b) (a>b?b:a)\n#define maxd(a,b) (a>b?a:b)\n#define absd(x) (x<0?-(x):x)\n#define pow2(x) ((x)*(x))\n#define rep(i,n) for(int i=0; i<n; ++i)\n#define repr(i,n) for(int i=n-1; i>=0; --i)\n#define repl(i,s,n) for(int i=s; i<=n; ++i)\n#define replr(i,s,n) for(int i=n; i>=s; --i)\n#define repf(i,s,n,j) for(int i=s; i<=n; i+=j)\n#define repe(e,obj) for(auto e : obj)\n\n#define SP << \" \" <<\n#define COL << \" : \" <<\n#define COM << \", \" <<\n#define ARR << \" -> \" <<\n#define PNT(STR) cout << STR << endl\n#define POS(X,Y) \"(\" << X << \", \" << Y << \")\"\n#define DEB(A) \" (\" << #A << \") \" << A\n#define DEBREP(i,n,val) for(int i=0; i<n; ++i) cout << val << \" \"; cout << endl\n#define ALL(V) (V).begin(), (V).end()\n#define INF 1000000007\n#define INFLL 1000000000000000007LL\n#define EPS 1e-9\n\ntypedef unsigned int uint;\ntypedef unsigned long ulong;\ntypedef unsigned long long ull;\ntypedef long long ll;\ntypedef long double ld;\n#define P_TYPE int\ntypedef pair<P_TYPE, P_TYPE> P;\ntypedef pair<P, P_TYPE> PI;\ntypedef pair<P_TYPE, P> IP;\ntypedef pair<P, P> PP;\ntypedef priority_queue<P, vector<P>, greater<P> > pvqueue;\n\n#define N 10003\nint mi[N], ma[N];\nint main() {\n  int n, m;\n  while(cin >> n >> m && n+m) {\n    rep(i, n) mi[i] = ma[i] = 0;\n    rep(i, m) {\n      int s, k;\n      cin >> s >> k;\n      if(k == 1) {\n        int c; cin >> c;\n        mi[c-1]+=s; ma[c-1] += s;\n      } else {\n        rep(j, k) {\n          int c;\n          cin >> c;\n          ma[c-1] += s;\n        }\n      }\n    }\n    int is1, it1, is2, it2, tmps, tmpt;\n    tmps = 1000000007;\n    tmpt = 0;\n    rep(i, n) {\n      if(tmpt < ma[i]) {tmpt = ma[i]; it1 = i;}\n      if(mi[i] < tmps) {tmps = mi[i]; is2 = i;}\n    }\n    tmps = 1000000007;\n    tmpt = 0;\n    rep(i, n) {\n      if(i != it1 && mi[i] < tmps) {tmps = mi[i]; is1 = i;}\n      if(i != is2 && tmpt < ma[i]) {tmpt = ma[i]; it2 = i;}\n    }\n    cout << maxd(ma[it1] - mi[is1], ma[it2] - mi[is2])+1 << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\n\ntypedef long long LL;\n\nint main(){\n  int n,m;\n  while(1){\n    cin >> n >> m;\n    if(n==0) return 0;\n    vector<int> ma(n,0),mi(n,0);\n    int s,k;\n    int c;\n    for(int i=0;i<m;i++){\n      cin >> s >> k;\n      if(k==1){\n        cin >> c;\n        c--;\n        mi[c]+=s;\n      }else{\n        for(int j=0;j<k;j++){\n          cin >> c;\n          c--;\n          ma[c]+=s;\n        }\n      }\n    }\n    int firstma=0,secondma=0,firstmi=100000,secondmi=10000;\n    int firstmai=-1,secondmai=-1,firstmii=-1,secondmii=-1;\n    for(int i=0;i<n;i++){\n      if(ma[i]+mi[i]>=firstma){\n        secondma=firstma;\n        secondmai=firstmai;\n        firstma=ma[i]+mi[i];\n        firstmai=i;\n      }else if(ma[i]+mi[i]>=secondma){\n        secondma=ma[i]+mi[i];\n        secondmai=i;\n      }\n    }\n    for(int i=0;i<n;i++){\n      if(mi[i]<=firstmi){\n        secondmi=firstmi;\n        secondmii=firstmii;\n        firstmi=mi[i];\n        firstmii=i;\n      }else if(mi[i]<=secondma){\n        secondmi=mi[i];\n        secondmii=i;\n      }\n    }\n    if(firstmai!=firstmii){\n      cout << firstma-firstmi+1 << endl;\n    }else{\n      cout << max(firstma-secondmi,secondma-firstmi)+1 << endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  int N, M;\n  while (cin >> N >> M, N) {\n    auto S = vector<int>(M);\n    auto k = vector<int>(M);\n    auto c = vector<vector<int>>(M, vector<int>(M));\n    auto sum = vector<int>(N, 0);\n    auto q = vector<vector<int>>(N);\n    for (int i = 0; i < M; ++i) {\n      cin >> S[i] >> k[i];\n      for (int j = 0; j < k[i]; ++j) {\n        cin >> c[i][j]; --c[i][j];\n        sum[c[i][j]] += S[i];\n        q[c[i][j]].push_back(i);\n      }\n    }\n    auto maxIt = max_element(begin(sum), end(sum));\n    int idx = distance(begin(sum), maxIt);\n    for (auto&& x : q[idx]) S[x] = 0;\n\n    sum = vector<int>(N, 0);\n    for (int i = 0; i < M; ++i) {\n      for (int j = 0; j < k[i]; ++j) {\n        sum[c[i][j]] += S[i];\n      }\n    }\n    sum[idx] = 1e9;\n    auto minIt = min_element(begin(sum), end(sum));\n    cout << *maxIt - *minIt + 1 << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing i64 = int64_t;\n\nconst i64 MOD = 1e9+7;\n\nconst i64 INF = 1e18+7;\n\ntemplate <typename T = i64>\nstruct Range{\n    struct iterator{\n        T value;\n        const T step, last;\n        const T& operator*(){return value;}\n        iterator(T value, T step, T last) :\n            value(step < static_cast<T>(0) ? max(last, value) : min(last, value)),\n            step(step),\n            last(last)\n        {\n        }\n        iterator operator++(){value = step < static_cast<T>(0) ? max(value + step, last) : min(value + step, last); return *this;}\n        bool operator!=(const iterator& x){return value != x.value;}\n    };\n    const T start, last, step;\n\n    Range(const T start, const T last, const T step = static_cast<T>(1)) :\n        start(start),\n        last(last),\n        step(step)\n    {\n    }\n\n    Range(const T last) :\n        start(0),\n        last(last),\n        step(1)\n    {\n    }\n\n    iterator begin(){return iterator(start, step, last);}\n    iterator end(){return iterator(last, step, last);}\n};\n\ntemplate <typename F>\nstruct FixPoint{\n    const F _f;\n    FixPoint(F&& f) : _f(forward<F>(f)){}\n\n    template<typename... Types>\n    decltype(auto) operator()(Types&&... args) const{\n        return _f(*this, forward<Types>(args)...);\n    }\n};\n\ntemplate <typename F>\nstatic decltype(auto) makeRec(F&& f){\n    return FixPoint<F>(forward<F>(f));\n}\n\ntemplate <typename T, T Value = T()>\nvector<T> makeVector(size_t x){\n    return vector<T>(x, T(Value));\n}\n\ntemplate <typename T, T Value = T(), typename... Types>\nauto makeVector(size_t x, Types... args){\n    return vector<decltype(makeVector<T, Value>(args...))>(x, makeVector<T, Value>(args...));\n}\n\ntemplate <typename T = i64>\nbool chmax(T& a, T b){\n    if(a < b){\n        a = b;\n        return true;\n    }\n    return false;\n}\n\ntemplate <typename T = i64>\nbool chmin(T& a, T b){\n    if(a > b){\n        a = b;\n        return true;\n    }\n    return false;\n}\n\n#define dump(x) fprintf(stderr, \"line =%4d, name =%7s , \", __LINE__, #x); clog << \"value = \" << x << endl;\n\n#define vecdump(x) fprintf(stderr, \"line =%4d, name =%7s\\n\", __LINE__, #x); _dump_macro(x);\n\nvoid _dump(int, string& x){\n    clog << x << endl;\n}\n\ntemplate <typename T>\nvoid _dump(bool, T& x){\n    clog << x << \" \";\n}\n\ntemplate <typename T, typename U = typename T::iterator>\nvoid _dump(int, T& x){\n\n    for(auto& elm : x)\n        _dump(0, elm);\n\n    clog << endl;\n}\n\ntemplate <typename T>\nvoid _dump_macro(T& x){\n    _dump(0, x);\n}\n\nvoid _input(int, string& x){\n    cin >> x;\n}\n\ntemplate <typename T>\nvoid _input(bool, T& x){\n    cin >> x;\n}\n\ntemplate <typename T, typename U = typename T::iterator>\nvoid _input(int, T& x){\n\n    for(auto& elm : x)\n        _input(0, elm);\n}\n\ntemplate <typename T>\nvoid input_single(T& x){\n    _input(0, x);\n}\n\nauto input(){}\n\ntemplate <typename T, typename... Types>\nvoid input(T& value, Types&&... args){\n    input_single(value);\n    input(forward<Types>(args)...);\n};\n\nvoid _pararell_input(size_t){}\n\ntemplate <typename T, typename... Types>\nvoid _pararell_input(size_t index, T& value, Types&&... args){\n    input(value[index]);\n    _pararell_input(index, forward<Types>(args)...);\n}\n\ntemplate <typename... Types>\nvoid pararell_input(size_t count, Types&&... args){\n    for(const auto& i : Range<>(count))\n        _pararell_input(i, forward<Types>(args)...);\n}\n\n\ntemplate<typename T>\nstruct Segtree{\n    int n;\n    T op;\n    vector<T> elm;\n    function<T(T, T)> f;\n\n    Segtree(int n, T init, function<T(T, T)> f, T op = T()) :\n        n(n),\n        op(op),\n        elm(2 * n, init),\n        f(f)\n    {\n        for(int i = n - 1; i >= 1; --i)\n            elm[i] = f(elm[2 * i], elm[2 * i + 1]);\n    }\n\n    Segtree(int n, vector<T> init, function<T(T, T)> f, T op = T()) :\n        n(n),\n        op(op),\n        elm(2 * n),\n        f(f)\n    {\n        for(int i = 0; i < n; ++i)\n            elm[i + n] = init[i];\n        for(int i = n - 1; i >= 1; --i)\n            elm[i] = f(elm[2 * i], elm[2 * i + 1]);\n    }\n\n    void set(int x, T val){\n        x += n;\n        elm[x] = val;\n        while(x >>= 1)\n            elm[x] = f(elm[2 * x], elm[2 * x + 1]);\n    }\n\n    void update(int x, T val){\n        x += n;\n        elm[x] = f(val, elm[x]);\n        while(x >>= 1)\n            elm[x] = f(elm[2 * x], elm[2 * x + 1]);\n    }\n\n    T get(int x, int y) const{\n        T l = op, r = op;\n        for(x += n, y += n - 1; x <= y; x >>= 1, y >>= 1){\n            if(x & 1)\n                l = f(l, elm[x++]);\n            if(!(y & 1))\n                r = f(elm[y--], r);\n        }\n        return f(l, r);\n    }\n};\n\n\n\nbool solve(){\n\n    int n, m;\n    input(n, m);\n    if(!n)\n        return false;\n\n    vector<int> t(n, 0), mi(n, 0);\n    for(int i = 0; i < m; ++i){\n        int s, k;\n        input(s, k);\n        vector<int> a(k);\n        input(a);\n        for(int j = 0; j < k; ++j)\n            t[--a[j]] += s;\n        if(k == 1)\n            mi[a[0]] += s;\n    }\n    Segtree<int> seg(n, t, [](auto x, auto y){return max(x, y);}, -MOD);\n    int ans = 0;\n    for(int i = 0; i < n; ++i){\n        seg.set(i, -MOD);\n        chmax(ans, seg.get(0, n) - mi[i]);\n        seg.set(i, t[i]);\n    }\n    cout << ans + 1 << endl;\n\n    return true;\n}\n\nsigned main(){\n\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(20);\n\n    while(solve());\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <algorithm>\n#include <string>\n#include <map>\n#include <numeric>\n#include <bitset>\n#include <vector>\n#include <queue>\n\nusing namespace std;\n\ntypedef long long ll;\n#define FOR(i,a,b)   for(ll i = (a); i < (b); i++ )\n#define REP(i, n)    FOR(i,0,n)\ntypedef pair< ll, ll >   cp2;\ntypedef pair< ll, cp2 >   cp3;\n#define fi first\n#define se second\n#define sec  se.fi\n#define thr  se.se\nconst ll mod = 1000000007;\n//              123456789\n\n \n///////////////////////////////////////////////\n//\n//\n///////////////////////////////////////////////\n\n////////////////////////////////////////////////\n////////////////////////////////////////////////\n\nint N, M, K, S;\nint c; \ncp2 ma[11234];\ncp2 mi[11234];\nll ans;\n\nint main() {\n\t\n\twhile( cin>>N>>M, (N||M) ){\n\t\tREP( i, 11234 ){\n\t\t\tmi[i] = cp2( 0, i );\n\t\t\tma[i] = cp2( 0, i );\n\t\t}\n\t\tREP( i, M ){\n\t\t\tcin>>S>>K;\n\t\t\tREP( i, K ){\n\t\t\t\tcin>>c;\n\t\t\t\tma[c].fi += S;\n\t\t\t}\n\t\t\tif( K == 1 ) mi[c].fi += S;\n\t\t}\n\t\tsort( ma+1, ma+N+1, greater<cp2>() );\n\t\tsort( mi+1, mi+N+1 );\n\t\tif( ma[1].se == mi[1].se ){\n\t\t\tans = max( (ma[1].fi-mi[2].fi), (ma[2].fi-mi[1].fi) ) + 1;\n\t\t}\n\t\telse{\n\t\t\tans = ma[1].fi-mi[1].fi+1;\n\t\t}\n\t\t//cout<<\"@ \";\n\t\tcout<<ans<<endl;\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\n#define int long long\nusing namespace std;\n\ntemplate <typename X, typename T>\nauto vectors(X x, T a) {\n\treturn vector<T>(x, a);\n}\n\ntemplate <typename X, typename Y, typename Z, typename... Zs>\nauto vectors(X x, Y y, Z z, Zs... zs) {\n\tauto cont = vectors(y, z, zs...);\n\treturn vector<decltype(cont)>(x, cont);\n}\n\ntemplate<typename T>\nostream& operator << (ostream& os, vector<T>& v){\n\trep(i,v.size()){ os << v[i] << (i == v.size() - 1 ? \"\" : \" \"); } return os;\n}\ntemplate<typename T>\nistream& operator >> (istream& is, vector<T>& v){\n\tfor(T& x: v){ is >> x; } return is;\n}\n\n\nsigned main(){\n\tint n, m;\n\twhile(cin >> n >> m, n){\n\t\tvector<int> mini(n, 0), maxi(n, 0);\n\t\trep(i,m){\n\t\t\tint s, k;\n\t\t\tcin >> s >> k;\n\n\t\t\tvector<int> c(k);\n\t\t\tcin >> c;\n\n\t\t\tif(k == 1){\n\t\t\t\tmini[c[0] - 1] += s;\n\t\t\t}\n\t\t\tfor(auto i : c){\n\t\t\t\tmaxi[i - 1] += s;\n\t\t\t}\n\t\t}\n\n\t\t//cout << maxi << endl;\n\t\t//cout << mini << endl;\n\n\t\tint ans = 0;\n\t\trep(i,n){\n\t\t\tint m = 0;\n\t\t\trep(j,n){\n\t\t\t\tif(i != j){\n\t\t\t\t\tm = max(m, maxi[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\t//cout << m << ' ' << mini[i] << endl;\n\t\t\tans = max(ans, m - mini[i]);\n\t\t}\n\t\tcout << ans + 1 << endl;\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\ntypedef long long ll;\n\nint solve(void);\n\nint main(void)\n{\n\twhile (solve())\n\t{\n\t}\n\n\treturn 0;\n}\n\nint solve(void)\n{\n\tll N, M;\n\tcin >> N >> M;\n\tif(!(N|M)) { return 0; }\n\n\t// v[i][0] = min, v[i][1] = max\n\tvector<vector<ll>> v(N, vector<ll>(2, 0));\n\tfor (ll i = 0; i < M; i++)\n\t{\n\t\tll S, k;\n\t\tcin >> S >> k;\n\t\tfor (ll j = 0; j < k; j++)\n\t\t{\n\t\t\tll c;\n\t\t\tcin >> c;\n\t\t\t// update min\n\t\t\tif (k == 1) {\n\t\t\t\tv[c-1][0] += S;\n\t\t\t}\n\t\t\t// update max\n\t\t\tv[c-1][1] += S;\n\t\t}\n\t}\n\n\tll ans = 0;\n\tfor (ll i = 0; i < N; i++)\n\t{\n\t\tfor (ll j = 0; j < N; j++) {\n\t\t\tif(i == j) continue;\n\t\t\tans = max(ans, v[i][1] - v[j][0] + 1);\n\t\t}\n\t}\n\n\tcout << ans << endl;\n\n\treturn 1;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MAX_N 10005\nint N,M;\nint main(){\n  while(cin>>N>>M){\n    int Min[MAX_N]={},Max[MAX_N]={};\n    if(M==0&&N==0)break;\n    for(int i=0;i<M;i++){\n      int p,k,id;\n      cin>>p>>k;\n      for(int j=0;j<k;j++){\n        cin>>id;\n        id--;\n        if(k==1){\n          Min[id]+=p;\n        }\n        Max[id]+=p;\n      }\n    }\n\n    int mini=1e9,maxm=-1e9,ans=0;\n\n    for(int i=0;i<N;i++){\n\n      if(Max[i]>mini)\n        ans=max(ans, abs(Max[i]-mini) );\n        \n      if(maxm>Min[i])\n        ans=max(ans, abs(maxm-Min[i]) );\n\n      mini=min(mini,Min[i]);\n      maxm=max(maxm,Max[i]);\n    }\n    cout<<ans+1<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i, n) for (int i = 0; i < n; i++)\n#define ALL(obj) obj.begin(), obj.end()\n#define fcout cout << setprecision(10)\n\nconst int iINF = 1e9;\nconst long long llINF = 1e18;\nconst int MOD = 1e9 + 7;\n\nusing namespace std;\n\ntemplate <typename T>\nvoid debug(vector<T> &vec) {\n    for (auto x : vec) {\n        cout << x << \" \";\n    }\n    cout << endl;\n    return;\n}\n\ntemplate <typename A, size_t N, typename T>\nvoid FILL(A (&array)[N], const T &val) {\n    std::fill((T *)array, (T *)(array + N), val);\n}\n\ntemplate <typename T>\nint getFormer(const vector<T> &vec, T x) {\n    return upper_bound(vec.begin(), vec.end(), x) - vec.begin() - 1;\n}\n\ntemplate <typename T>\nint getLatter(const vector<T> &vec, T x) {\n    return lower_bound(vec.begin(), vec.end(), x) - vec.begin();\n}\n\nvoid solve(int N, int M) {\n    vector<pair<long long, int>> maxs(N, make_pair(0, 0)),\n        mins(N, make_pair(0, 0));\n    REP(i, N) {\n        maxs[i].second = i;\n        mins[i].second = i;\n    }\n\n    REP(i, M) {\n        int S, k;\n        cin >> S >> k;\n        REP(j, k) {\n            int c;\n            cin >> c;\n            maxs[c - 1].first += S;\n            if (k == 1) mins[c - 1].first += S;\n        }\n    }\n\n    sort(ALL(mins));\n    sort(ALL(maxs), greater<pair<long long, int>>());\n\n    if (maxs[0].second == mins[0].second) {\n        cout << max(maxs[0].first - mins[1].first,\n                    maxs[1].first - mins[0].first) +\n                    1\n             << endl;\n    } else {\n        cout << maxs[0].first - mins[0].first + 1 << endl;\n    }\n\n    return;\n}\n\nint main() {\n    int N, M;\n    while (cin >> N >> M && N) {\n        solve(N, M);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <algorithm>\n#include <cstdio>\nusing namespace std;\n\nint main(){\n\tint N,M,s,k,c;\n\tfor(;~scanf(\"%d%d\",&N,&M)&&N&&M;){\n\t\tvector<pair<int,int> >ma(N),mi(N);\n\t\tfor(int i=0;i<N;i++)ma[i].second=mi[i].second=i;\n\t\tfor(int i=0;i<M;i++){\n\t\t\tscanf(\"%d%d\",&s,&k);\n\t\t\tfor(int j=0;j<k;j++){\n\t\t\t\tscanf(\"%d\",&c),c--;\n\t\t\t\tif(k==1)mi[c].first+=s;\n\t\t\t\tma[c].first+=s;\n\t\t\t}\n\t\t}\n\t\tsort(ma.begin(),ma.end());\n\t\tsort(mi.begin(),mi.end());\n\t\tint r=0;\n\t\tfor(int i=N-2;i<N;i++)for(int j=0;j<2;j++){\n\t\t\tif(ma[i].second!=mi[j].second)r=max(r,ma[i].first-mi[j].first);\n\t\t}\n\t\tprintf(\"%d\\n\",r+1);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i, n) for (int i = 0; i < n; i++)\n#define ALL(obj) obj.begin(), obj.end()\n#define fcout cout << setprecision(10)\n\nconst int iINF = 1e9;\nconst long long llINF = 1e18;\nconst int MOD = 1e9 + 7;\n\nusing namespace std;\n\ntemplate <typename T>\nvoid debug(vector<T> &vec) {\n    for (auto x : vec) {\n        cout << x << \" \";\n    }\n    cout << endl;\n    return;\n}\n\ntemplate <typename A, size_t N, typename T>\nvoid FILL(A (&array)[N], const T &val) {\n    std::fill((T *)array, (T *)(array + N), val);\n}\n\ntemplate <typename T>\nint getFormer(const vector<T> &vec, T x) {\n    return upper_bound(vec.begin(), vec.end(), x) - vec.begin() - 1;\n}\n\ntemplate <typename T>\nint getLatter(const vector<T> &vec, T x) {\n    return lower_bound(vec.begin(), vec.end(), x) - vec.begin();\n}\n\nvoid solve(int N, int M) {\n    vector<pair<long long, int>> maxs(N, make_pair(0, 0)),\n        mins(N, make_pair(0, 0));\n    REP(i, N) {\n        maxs[i].second = i;\n        mins[i].second = i;\n    }\n\n    REP(i, M) {\n        int S, k;\n        REP(j, k) {\n            int c;\n            cin >> c;\n            maxs[c - 1].first += S;\n            if (k == 1) mins[c - 1].first += S;\n        }\n    }\n\n    sort(ALL(maxs));\n    sort(ALL(mins), greater<pair<long long, int>>());\n\n    if (maxs[0].second == mins[0].second) {\n        cout << max(maxs[0].first - mins[1].first,\n                    maxs[1].first - mins[0].first) +\n                    1\n             << endl;\n    } else {\n        cout << maxs[0].first - mins[0].first + 1 << endl;\n    }\n\n    return;\n}\n\nint main() {\n    int N, M;\n    while (cin >> N >> M && N) {\n        solve(N, M);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define SZ(x) (int)(x.size())\n#define REP(i, n) for(int i=0;i<(n);++i)\n#define FOR(i, a, b) for(int i=(a);i<(b);++i)\n#define RREP(i, n) for(int i=(int)(n)-1;i>=0;--i)\n#define RFOR(i, a, b) for(int i=(int)(b)-1;i>=(a);--i)\n#define ALL(a) a.begin(),a.end()\n#define DUMP(x) cerr<<#x<<\" = \"<<(x)<<endl\n#define DEBUG(x) cerr<<#x<<\" = \"<<(x)<<\" (L\"<<__LINE__<<\")\"<< endl;\nusing ll = long long;\nusing vi = vector<int>;\nusing vvi = vector<vi>;\nusing vvvi = vector<vvi>;\nusing vll = vector<ll>;\nusing vvll = vector<vll>;\nusing P = pair<int, int>;\nconst double eps = 1e-8;\nconst ll MOD = 1000000007;\nconst int INF = INT_MAX / 2;\nconst ll LINF = LLONG_MAX / 2;\ntemplate <typename T1, typename T2>\nbool chmax(T1 &a, const T2 &b) {\n    if (a < b) { a = b; return true; }\n    return false;\n}\ntemplate <typename T1, typename T2>\nbool chmin(T1 &a, const T2 &b) {\n    if (a > b) { a = b; return true; }\n    return false;\n}\ntemplate<typename T>\nostream &operator<<(ostream &os, const vector<T> &v) {\n    os << \"[\";\n    REP(i, SZ(v)) {\n        if (i) os << \", \";\n        os << v[i];\n    }\n    return os << \"]\";\n}\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const map<T1, T2> &mp) {\n    os << \"{\";\n    int a = 0;\n    for (auto &tp : mp) {\n        if (a) os << \", \";\n        a = 1;\n        os << tp;\n    }\n    return os << \"}\";\n}\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const pair<T1, T2> &p) {\n    os << p.first << \":\" << p.second;\n    return os;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(10);\n\n    for (;;) {\n        int N, M; cin >> N >> M;\n        if (N == 0) break;\n\n        vll mi(N), ma(N);\n        REP(i, M) {\n            int s, k; cin >> s >> k;\n            REP(j, k) {\n                int c; cin >> c; --c;\n                ma[c] += s;\n                if (k == 1) mi[c] += s;\n            }\n        }\n\n        ll ans = 0;\n        int maxI = max_element(ALL(ma)) - ma.begin();\n        int minI = min_element(ALL(mi)) - mi.begin();\n        if (maxI != minI) {\n            ans = *max_element(ALL(ma)) - *min_element(ALL(mi)) + 1;\n        } else {\n            REP(i, N) {\n                if (maxI != i) chmax(ans, ma[maxI] - mi[i] + 1);\n                if (minI != i) chmax(ans, ma[i] - mi[minI] + 1);\n            }\n        }\n        cout << ans << endl;\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\n#define endl '\\n'\n#define FOR(i, a, n) for (int i = (a); i < (n); ++i)\n#define REP(i, n) FOR(i, 0, n)\nusing namespace std;\n\nvoid _main() {\n    int N, M;\n    while (cin >> N >> M, N) {\n        vector<int> lb(N, 0), ub(N, 0);\n        REP (i, M) {\n            int S, k;\n            cin >> S >> k;\n            REP (j, k) {\n                int c;\n                cin >> c;\n                c--;\n                if (k == 1) lb[c] += S;\n                ub[c] += S;\n            }\n        }\n        int ans = 0;\n        REP (i, N) REP (j, N) if (j != i) {\n            ans = max(ans, ub[j] - lb[i] + 1);\n        }\n        cout << ans << endl;\n    }\n}\n\nsigned main() {\n    ios::sync_with_stdio(false);\n    cin.tie(nullptr);\n    cout << fixed << setprecision(10);\n    _main();\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define INF 10000000\nusing namespace std;\nint main()\n{\n  int n, m;\n  while(cin >> n >> m, n | m) {\n    vector<int> A(n + 1, 0);\n    vector<int> B(n + 1, 0);\n    int x, k, p;\n    for(int i = 0; i < m; i++) {\n      cin >> x >> k;\n      for(int j = 0; j < k; j++) {\n\tcin >> p;\n\tp--;\n\tif(k == 1) A[p] += x;\n\tB[p] += x;\n      }\n    }\n    int max_p = -1;\n    int min_p = INF;\n    for(int i = 0; i < n; i++) {\n      if(B[i] > max_p && A[i] < min_p && min_p != INF){\n\tmax_p = max(max_p, B[i]);\n\tcontinue;\n      }\n      max_p = max(max_p, B[i]);\n      min_p = min(min_p, A[i]);\n    }\n    //cout << max_p << \" \" << min_p << endl;\n    int ans = max_p - min_p + 1;\n    cout << ans << endl;\n    //for(int i = 0; i < n; i++)\n    //  cout << B[i] << \" \";\n    //cout << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nconst int INF = 1e9;\nusing LL = long long;\nconst LL LINF = 1e18;\nconst double EPS = 1e-10;\nusing namespace std;\n\n#define SCIN(n) string(n);cin >> (n)\n#define YES(n) cout<<((n)? \"YES\" : \"NO\")<<endl\n#define Yes(n) cout<<((n)? \"Yes\" : \"No\")<<endl\n#define POSSIBLE(n) cout << ((n) ? \"POSSIBLE\" : \"IMPOSSIBLE\"  ) << endl\n#define Possible(n) cout << ((n) ? \"Possible\" : \"Impossible\"  ) <<endl\n\n#define ALL(obj) (obj).begin(),(obj).end()\n\n#define rt return\n#define ENDL cout<<endl\n#define s second\n#define f first\n\ntypedef string::const_iterator State;\nclass PalseError {};\nclass Edge{\npublic:\n    LL from,to,value;\n    Edge(LL a,LL b,LL c){\n        from = a;\n        to = b;\n        value = c;\n    }\n    Edge(LL a,LL b){\n        from = a;\n        to = b;\n    }\n};\n\nint main(){\n    int N,M;\n    while(cin >> N >> M){\n        if(N == 0 && M == 0){\n            return 0;\n        }\n        vector<int> S,K;\n        vector<vector<int>> C;\n        vector<int> scores(N);\n        vector<int> ma_scores(N);\n        for(int a = 0;a < M;a++){\n            int s,k;\n            cin >> s >> k;\n            S.push_back(s);\n            K.push_back(k);\n            vector<int> w;\n            for(int a = 0;a < k;a++){\n                int b;\n                cin >> b;\n                ma_scores.at(b-1) += s;\n                w.push_back(b);\n            }\n            if(k == 1)scores.at(w.front()-1) += s;\n            C.push_back(w);\n        }\n        vector<pair<int,int>> mi,ma;\n        for(int a = 0;a < N;a++){\n            mi.push_back({scores.at(a), a});\n        }\n        for(int a = 0;a < N;a++){\n            ma.push_back({ma_scores.at(a), a});\n        }\n        sort(ma.begin(),ma.end(),greater<pair<int,int>>());\n        sort(mi.begin(),mi.end());\n        int ans = 0;\n        for(int a = 0;a < N;a++){\n            if(ma.at(a).second == mi.at(0).second){\n                ans = max(ans, ma.at(a).first-mi.at(1).first);\n            }else{\n                ans = max(ans, ma.at(a).first-mi.at(0).first);\n            }\n        }\n        cout<<ans+1<<endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nmain(){\n\tint n,m,x,po[10001],p;\n\twhile(cin>>n>>m,n){\n\t\tint ans=0;\n\t\tvector<int>v[1000];\n\t\tr(i,m){\n\t\t\tcin>>po[i]>>x;\n\t\t\tr(j,x){\n\t\t\t\tcin>>p;\n\t\t\t\tv[i].push_back(p-1);\n\t\t\t}\n\t\t}\n\t\tr(i,n){\n\t\t\tint a[n]={},p1=0,p2=1e9;\n\t\t\tr(j,m){\n\t\t\t\tif(v[j].size()>=2)r(k,v[j].size()){\n\t\t\t\t\tif(v[j][k]==i)a[i]+=po[j];\n\t\t\t\t}\n\t\t\t\telse a[v[j][0]]+=po[j];\n\t\t\t}\n\t\t\tr(j,n){\n\t\t\t\tp1=max(p1,a[j]);\n\t\t\t\tp2=min(p2,a[j]);\n\t\t\t}\n\t\t\tans=max(ans,p1-p2+1);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define REP(i,s,n) for(int i=s;i<n;++i)\n#define rep(i,n) REP(i,0,n)\n#define IINF INT_MAX\n#define LLINF LLONG_MAX\n\nusing namespace std;\n\n\ntypedef long long ll;\n\nint N,M;\nll S[1010];\nvector<int> c[1010];\n\nvoid compute() {\n  ll maxi = 0;\n  REP(win,1,N+1) {\n    unordered_map<int,ll> fix;\n    ll mini = LLINF;\n    ll score = 0;\n    rep(i,M) {\n      int pos = -1;\n      rep(j,(int)c[i].size()) if( c[i][j] == win ) {\n\tpos = j;\n\tbreak;\n      }\n      if( pos == -1 ) {\n\tif( c[i].size() == 1 ) {\n\t  fix[c[i][0]] += S[i];\n\t}\n      } else {\n\tscore += S[i];\n      }\n    }\n\n    for(auto v : fix) {\n      if( v.first != win ) {\n\tmini = min(mini,v.second);\n      }\n    }\n    if( fix.size() != N-1 ) mini = 0;\n    if( mini == LLINF ) mini = 0;\n    //cout << \"win = \" << win << \" \" << score << \" - \" << mini << \" + 1\" << endl;\n    maxi = max(maxi,score-mini+1LL);\n  }\n  cout << maxi << endl;\n}\n\nint main() {\n  while( cin >> N >> M, N|M ) {\n    rep(i,1010) c[i].clear();\n    rep(i,M) {\n      cin >> S[i];\n      c[i].clear();\n      int k;\n      cin >> k;\n      c[i].resize(k);\n      rep(j,k) cin >> c[i][j];\n    }\n    compute();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\n#include <set>\nusing namespace std;\nusing pii = pair<int, int>;\n\nint main() {\n    int n, m;\n    while (cin >> n >> m, n) {\n        vector<pii> all(n), only(n);    // score, person\n        for (int j = 0; j < n; j++) {\n            all[j].second = j; only[j].second = j;\n        }\n        for (int i = 0; i < m; i++) {\n            int s, k; cin >> s >> k;\n            if (k == 1) {\n                int c; cin >> c; c--;\n                only[c].first += s;\n                all[c].first += s;\n                continue;\n            }\n            while (k--) {\n                int c; cin >> c; c--;\n                all[c].first += s;\n            }\n        }\n        sort(all.begin(), all.end());\n        sort(only.begin(), only.end());\n        if (all[n - 1].second != only[0].second) {\n            cout << all[n - 1].first - only[0].first + 1 << endl;\n        } else {\n            cout << max(\n                all[n - 1].first - only[1].first,\n                all[n - 2].first - only[0].first\n            ) + 1 << endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef pair<int,int> mp;\nint main(){\n\twhile(1){\n\tint n,m;\n\tcin>>n>>m;\n\tif(n==0)break;\n\tvector<int> dp(n,0),mi(n,0);\n\tfor(int i=0;i<m;i++){\n\t\tint s,k,c;\n\t\tcin>>s>>k;\n\t\tfor(int j=0;j<k;j++){\n\t\t\tcin>>c;\n\t\t\tc--;\n\t\t\tdp[c]+=s;\n\t\t}\n\t\tif(k==1)mi[c]+=s;\n\t}\n\tint ma=0;\n\tfor(int i=0;i<n;i++)\n\t\tfor(int j=0;j<n;j++)\n\t\t\tif(i!=j)ma=max(ma,dp[i]-mi[j]);\n\t//sort(dp.begin(),dp.end());\n\t//sort(mi.begin(),mi.end() );\n\tcout<<ma+1<<endl;\n\n\t}\n\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define MOD 1000000007LL\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nint n,m;\nint s[1001];\nint k[1001];\nvector<int> c[1001];\nint dp[10001];\nint dp2[10001];\n\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tif(n==0 && m==0)break;\n\t\tfor(int i=0;i<m;i++){\n\t\t\tscanf(\"%d\",&s[i]);\n\t\t\tscanf(\"%d\",&k[i]);\n\t\t\tc[i].clear();\n\t\t\tfor(int j=0;j<k[i];j++){\n\t\t\t\tint a;\n\t\t\t\tscanf(\"%d\",&a);\n\t\t\t\tc[i].push_back(a);\n\t\t\t}\n\t\t}\n\t\tmemset(dp,0,sizeof(dp));\n\t\tmemset(dp2,0,sizeof(dp2));\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tfor(int j=0;j<m;j++){\n\t\t\t\tint v=lower_bound(c[j].begin(),c[j].end(),i)-c[j].begin();\n\t\t\t\tif(v<c[j].size() && c[j][v]==i){\n\t\t\t\t\tdp[i]+=s[j];\n\t\t\t\t\tif(c[j].size()==1){\n\t\t\t\t\t\tdp2[i]+=s[j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint res=0;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tfor(int j=1;j<=n;j++){\n\t\t\t\tif(i==j)continue;\n\t\t\t\tres=max(res,dp[i]-dp2[j]);\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",res+1);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\nint main(){\n  int N, M;\n  while(cin >> N >> M, N){\n    vector<int> S(M);\n    vector<int> P(N,0), PM(N,0);\n    for(int i = 0; i < M; ++i){\n      int k;\n      cin >> S[i] >> k;\n      for(int j = 0; j < k; ++j){\n        int c;\n        cin >> c;\n        PM[c-1] += S[i];\n        if(k == 1){\n          P[c-1] += S[i];\n        }\n      }\n    }\n    vector<int> F(N+1,1e9), B(N+1,1e9);\n    for(int i = 0; i < N; ++i){\n      F[i+1] = min(F[i],P[i]);\n    }\n    for(int i = N-2; i >= 0; --i){\n      B[i] = min(B[i+1],P[i+1]);\n    }\n    int ans = 0;\n    for(int i = 0; i < N; ++i){\n      int mi = min(F[i],B[i]);\n      ans = max(ans,PM[i]-mi+1);\n    }\n    cout << ans << endl;\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <sstream>\n#include <string>\n#include <cstring>\n#include <vector>\n#include <set>\n#include <map>\n#include <unordered_map>\n#include <queue>\n#include <deque>\n#include <stack>\n#include <algorithm>\n#include <bitset>\n#include <cmath>\n#include <cstdlib>\n#include <ctime>\n#include <numeric>\n#include <functional>\n#include <cctype>\n#include <list>\n#include <limits>\n#include <cassert>\n//#include <boost/multiprecision/cpp_int.hpp>\n\nconst double EPS = (1e-10);\n\n\nusing namespace std;\nusing Int = long long;\n//using namespace boost::multiprecision;\n\nconst Int MOD = 1000000007;\n\nlong long mod_pow(long long x, long long n) {\n    long long res = 1;\n    for(int i = 0;i < 60; i++){\n        if(n >> i & 1) res = res * x % MOD;\n        x = x * x % MOD;\n    }\n    return res;\n}\n\ntemplate<typename T>\nT gcd(T a, T b) {\n    return b != 0 ? gcd(b, a % b) : a;\n}\n\ntemplate<typename T>\nT lcm(T a, T b) {\n    return a * b / gcd(a, b);\n}\n\nvoid fast_input() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n}\n\nint solve(int N, int M) {\n    vector<pair<int, int>> scores(N);\n    vector<pair<int, int>> minScores(N);\n    for (int i = 0; i < N; i++) {\n        scores[i] = minScores[i] = {0, i};\n    }\n    for (int i = 0; i < M; i++) {\n        int s; cin >> s;\n        int k; cin >> k;\n        for (int j = 0; j < k; j++) {\n            int tmp; cin >> tmp;\n            tmp--;\n            scores[tmp].first += s;\n            if (k == 1) {\n                minScores[tmp].first += s;\n            }\n        }\n    }\n    sort(minScores.begin(), minScores.end());\n    int ret = -1;\n    for (int i = 0; i < N; i++) {\n        int minScore;\n        if (i != minScores[0].second) minScore = minScores[0].first;\n        else minScore = minScores[1].first;\n        if (scores[i].first - minScore >= 0) {\n            ret = max(ret, scores[i].first - minScore);\n        }\n    }\n    return ret + 1;\n}\n\nint main(void) {\n    int N, M;\n    vector<int> ans;\n    while (1) {\n        cin >> N >> M;\n        if (!N && !M) break;\n        ans.push_back(solve(N, M));\n    }\n    for (int &i : ans) {\n        cout << i << endl;\n    }\n}   \n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define lps(i,j,n) for(int i=j;i<n;i++)\n#define lp(i,n) lps(i,0,n)\n#define DEKAI 1000000007\n#define INF (1<<28)\n\nsigned main(){\n  int a[20000],m[20000];\n  while(1){\n    lp(i,20000){\n      m[i]=0;\n      a[i]=0;\n    }\n    int n,mm;\n    cin>>n>>mm;\n    if(n==0&&mm==0) break;\n    lp(i,mm){\n      int s,k;\n      cin>>s>>k;\n      lp(j,k){\n\tint x;\n\tcin>>x;\n\tm[x]+=s;\n\tif(k==1){\n\t  a[x]+=s;\n\t}\n      }\n    }\n    int ansmax=-INF,es,ansmin=INF;\n    lp(i,n){\n      if(ansmax<m[i+1]) es=i;\n      ansmax=max(ansmax,m[i+1]);\n    }\n    lp(i,n){\n      if(i==es) continue;\n      ansmin=min(ansmin,a[i+1]);\n    }\n    //  cout<<ansmax<<\" \"<<ansmin<<endl;\n    cout<<ansmax-ansmin+1<<endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <stack>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define pb push_back\ntypedef pair<int,int> P;\ntypedef pair<P,int> Q;\n#define fi first\ntypedef long long ll;\n#define sc second\n\nll n,m,ans[10005];\nint only[10005];\nvector<int>vec[10005];\n\nint main(){\n\twhile(1){\n\t\tcin>>n>>m;\n\t\tif(n==0) return 0;\n\t\tfor(int i=0;i<1005;i++) vec[i].clear();\n\t\tfor(int i=0;i<10005;i++) ans[i] = only[i] =0;\n\t\trep(i,m){\n\t\t\tint pt; cin>>pt; int k; cin>>k;\n\t\t\trep(j,k){\n\t\t\t\tint a; cin>>a;\n\t\t\t\tvec[i].push_back(a);\n\t\t\t\tans[a] += pt;\n\t\t\t}\n\t\t\tif(k == 1) only[vec[i][0]] += pt;\n\t\t}\n\t\tvector<P>vec;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tvec.push_back(P(ans[i],i));\n\t\t}\n\t\tsort(vec.begin(),vec.end(),greater<P>());\n\t\tint anss = 0;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tint x = only[i];\n\t\t\tint y = vec[0].fi; if(vec[0].sc == i) y = vec[1].fi;\n\t\t\tanss = max(anss,y-x+1);\n\t\t}\n\t\tcout << anss<< endl;\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define P pair<int,int>\n\n\nvoid f(int n,int m){\n  vector<P> big(n),small(n);\n\n  for(int i=0;i<n;i++){\n    big[i]=P(0,i);\n    small[i]=P(0,i);\n  }\n\n  for(int i=0;i<m;i++){\n    int s,k;\n    cin>>s>>k;\n    for(int j=0;j<k;j++){\n      int x;\n      cin>>x;\n      x--;\n      big[x].first+=s;\n      if(k==1) small[x].first+=s;\n    }\n  }\n\n  sort(big.begin(),big.end());\n  reverse(big.begin(),big.end());\n  sort(small.begin(),small.end());\n\n  if(big[0].second!=small[0].second){\n    cout<<big[0].first-small[0].first+1<<endl;\n  }else{\n    int ans=big[0].first-small[1].first;\n    ans = max(ans,big[1].first-small[0].first);\n    cout<<ans+1<<endl;\n  }\n}\n\nmain(){\n  int n,m;\n  while(true){\n    cin>>n>>m;\n    if(n==0) break;\n    f(n,m);\n  }\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n\nint main(){\n    int n,m;\n    while(cin >> n >> m &&n!=0){\n        vector<int> a(n);\n        vector<int> b(n);\n        rep(i,m){\n            int s;\n            cin >> s;\n            int k;\n            cin >> k;\n            rep(j,k){\n                int c;\n                cin >> c;\n                c--;\n                if(k==1){\n                    b[c] += s;\n                }else{\n                    a[c] += s;\n                }\n            }\n        }\n        vector<pair<int,int> > A,B;\n        rep(i,n){\n            A.push_back(make_pair(a[i]+b[i],i));\n            B.push_back(make_pair(b[i],i));\n        }\n        sort(B.begin(),B.end());\n        sort(A.rbegin(),A.rend());\n        int res = 0;\n        rep(i,2){\n            rep(j,2){\n                if(A[i].second!=B[j].second){\n                    res = max(res,A[i].first-B[j].first);\n                }\n            }\n        }\n        cout << res+1 << \"\\n\";\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <bitset>\n#include <map>\n#include <tuple>\n#include <unordered_set>\n#include <unordered_map>\n#include <list>\n#include <numeric>\n#include <utility>\n#include <iterator>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cstring>\n#include <climits>\n#include <ctime>\n#include <cassert>\n#include <random>\n#include <cstring>\n\n#define rep(i,n) for(int i=0;i<int(n);i++)\n#define all(x) (x).begin(),x.end()\n#define pb push_back\n\nusing namespace std;\nusing ll = long long;\n\nconst ll mod = 1000000007;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nint ddx[8]={-1,-1,0,1,1,1,0,-1};\nint ddy[8]={0,1,1,1,0,-1,-1,-1};\nbool debug=false;\n\n/*---------------------------------------------------*/\n\nstruct score{\n  ll min = 0;\n  ll max = 0;\n};\n\nvoid solve(ll N, ll M){\n  ll S, k, c;\n  vector<score> score(N + 10);\n  for(int i = 0; i < M; i++) {\n    scanf(\"%lld %lld\", &S, &k);\n    if(k == 1) {\n      cin >> c;\n      score[c].min += S;\n      score[c].max += S;\n    } else {\n      for(int i = 0; i < k; i++){\n\tscanf(\"%lld\", &c);\n\tscore[c].max += S;\n      }\n    }\n  }\n  \n  ll ans = 0;\n  for(int i = 1; i <= N; i++){\n    for(int j = 1; j <= N; j++){\n      if(i == j) continue;\n      ans = max(ans, score[i].max - score[j].min + 1);\n    }\n  }\n  printf(\"%lld\\n\", ans);\n}\n\nint main(){\n  int N, M;\n  while(scanf(\"%d %d\", &N, &M)) {\n    if(N == 0 && M == 0) break;\n    solve(N, M);\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nll INF = 1000000000000000LL;\nint main() {\n  while (true) {\n    ll n, m;\n    cin >> n >> m;\n    if (n == 0)\n      break;\n    vector<ll> mins(n), maxs(n);\n    for (int i = 0; i < m; i++) {\n      int k;\n      ll s;\n      cin >> s >> k;\n      vector<int> ids(k);\n      for (int j = 0; j < k; j++)\n        cin >> ids[j];\n      for (int j = 0; j < k; j++)\n        ids[j]--;\n      if (k == 1)\n        mins[ids[0]] += s;\n      for (auto &j : ids)\n        maxs[j] += s;\n    }\n    ll ans = 0;\n    vector<ll> maxs2 = maxs;\n    sort(maxs2.begin(), maxs2.end());\n    ll fst = maxs2[n - 1];\n    ll snd = maxs2[n - 2];\n    for (int i = 0; i < n; i++) {\n      if (maxs[i] == fst) {\n        ans = max(ans, snd - mins[i] + 1);\n      } else {\n        ans = max(ans, fst - mins[i] + 1);\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\ntypedef long long ll;\n\nusing namespace std;\n\nstatic const int MAX = 10001;\n\nll n, m;\npair<ll, ll> poll[MAX];\n\nint main(void){\n\n\twhile(1){\n\t\tcin >> n >> m;\n\t\tif(n == 0 && m == 0)break;\n\t\tfor(ll i=0; i<n; i++){\n\t\t\tpoll[i].first = 0;\n\t\t\tpoll[i].second = 0;\n\t\t}\n\t\tfor(ll i=0; i<m; i++){\n\t\t\tll s;\n\t\t\tcin >> s;\n\t\t\tll k=0;\n\t\t\tcin >> k;\n\t\t\tfor(ll j=0; j<k; j++){\n\t\t\t\tll tmp = 0;\n\t\t\t\tcin >> tmp;\n\t\t\t\ttmp--;\n\t\t\t\tif(k==1){\n\t\t\t\t\tpoll[tmp].first+=s;\n\t\t\t\t}\n\t\t\t\tpoll[tmp].second+= s;\n\t\t\t}\n\t\t}\n\n\t\tll sa = 0;\n\t\tfor(int i=0; i<n; i++){\n\t\t\tfor(int j=0; j<n; j++){\n\t\t\t\tif(i!=j){\n\t\t\t\t\tsa = max(sa, poll[i].second - poll[j].first);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << sa + 1 << endl;\n\t}\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define For(i, a, b) for(int (i)=(int)(a); (i)<(int)(b); ++(i))\n#define rFor(i, a, b) for(int (i)=(int)(a)-1; (i)>=(int)(b); --(i))\n#define rep(i, n) For(i, 0, n)\n#define rrep(i, n) rFor(i, n, 0)\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long lint;\ntypedef unsigned long long ulint;\ntypedef pair<int, int> pii;\ntypedef pair<lint, lint> pll;\ntemplate<class T> bool chmax(T &a, const T &b){if(a<b){a=b; return true;} return false;}\ntemplate<class T> bool chmin(T &a, const T &b){if(a>b){a=b; return true;} return false;}\ntemplate<class T> T div_floor(T a, T b){\n    if(b < 0) a *= -1, b *= -1;\n    return a>=0 ? a/b : (a+1)/b-1;\n}\ntemplate<class T> T div_ceil(T a, T b){\n    if(b < 0) a *= -1, b *= -1;\n    return a>0 ? (a-1)/b+1 : a/b;\n}\n\nconstexpr lint mod = 1000000007;\nconstexpr lint INF = mod * mod;\nconstexpr int MAX = 100010;\n\nint n, m;\n\nvoid solve(){\n    int max_score[n], min_score[n];\n    memset(max_score, 0, sizeof(max_score));\n    memset(min_score, 0, sizeof(min_score));\n    rep(_, m){\n        int S, K;\n        scanf(\"%d%d\", &S, &K);\n        rep(__, K){\n            int c;\n            scanf(\"%d\", &c);\n            --c;\n            max_score[c] += S;\n            if(K == 1) min_score[c] += S;\n        }\n    }\n    int ans = 0;\n    rep(i, n)rep(j, n)if(i != j){\n        chmax(ans, max_score[i] - min_score[j] + 1);\n    }\n    printf(\"%d\\n\", ans);\n}\n\nint main(){\n    while(scanf(\"%d%d\", &n, &m) && n){\n        solve();\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define ALL(x) x.begin(),x.end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define debug(v) cout<<#v<<\":\";for(auto x:v){cout<<x<<' ';}cout<<endl;\n#define mod 1000000007\nusing ll=long long;\nconst int INF=1000000000;\nconst ll LINF=1001002003004005006ll;\nint dx[]={1,0,-1,0},dy[]={0,1,0,-1};\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\ntemplate<class T>bool chmax(T &a,const T &b){if(a<b){a=b;return true;}return false;}\ntemplate<class T>bool chmin(T &a,const T &b){if(b<a){a=b;return true;}return false;}\n \nstruct IOSetup{\n    IOSetup(){\n        cin.tie(0);\n        ios::sync_with_stdio(0);\n        cout<<fixed<<setprecision(12);\n    }\n} iosetup;\n \ntemplate<typename T1,typename T2>\nostream &operator<<(ostream &os,const pair<T1,T2>&p){\n    os<<p.first<<\" \"<<p.second;\n    return os;\n}\n \ntemplate<typename T>\nostream &operator<<(ostream &os,const vector<T>&v){\n    for(int i=0;i<(int)v.size();i++) os<<v[i]<<(i+1==(int)v.size()?\"\":\" \");\n    return os;\n}\n\ntemplate<typename T1,typename T2>\nistream &operator>>(istream &is,pair<T1,T2>&p){\n    is>>p.first>>p.second;\n    return is;\n}\n\ntemplate<typename T>\nistream &operator>>(istream &is,vector<T>&v){\n    for(T &x:v)is>>x;\n    return is;\n}\n\nint n,m;\n\n// p[i][j],人iがjを解ける\nint p[10010][1010];\nint s[10010],mx[10010],mi[10010];\n\n// \nvoid solve(){\n    rep(i,n)rep(j,m)p[i][j]=0;\n    rep(j,m){\n        cin>>s[j];\n        int k;cin>>k;\n        rep(_,k){\n            int i;cin>>i;i--;\n            p[i][j]=1;\n        }\n    }\n\n    // iがめっちゃ解く\n    rep(i,n){\n        int res=0;\n        rep(j,m){\n            if(p[i][j]){\n                res+=s[j];\n            }\n        }\n        mx[i]=res;\n    }\n\n    // i解かなくていいなら解かない\n    rep(i,n)mi[i]=0;\n    rep(j,m){\n        int cnt=0;\n        rep(i,n){\n            cnt+=p[i][j];\n        }\n        if(cnt==1){\n            rep(i,n){\n                if(p[i][j]){\n                    mi[i]+=s[j];\n                }\n            }\n        }\n    }\n\n    int ans=0;\n    rep(x,n){\n        rep(y,n)if(x!=y){\n            chmax(ans,mx[x]-mi[y]);\n        }\n    }\n    // cout<<\"mx \";rep(i,n)cout<<mx[i]<<\" \";\n    // cout<<endl;\n    // cout<<\"mi \";rep(i,n)cout<<mi[i]<<\" \";\n    // cout<<endl;\n    cout<<ans+1<<endl;\n}\n\nsigned main(){\n    while(cin>>n>>m,n) solve();\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing ull = unsigned long long;\n\nconst long double PI = acos(-1);\nconstexpr long double EPS = 1e-15;\nconstexpr int inf = 2e9;\nconstexpr ll INF = 2e18;\nconstexpr ll MOD = 1e9+7;\nconstexpr ll MOD1 = 998244353;\ntypedef pair<ll,ll> P;\n\n//#define all(v) (v).begin(), (v).end()\n#define rep(i,a,b) for (int i = (a); i < (b); i++)\n#define REP(i,n) rep(i,0,n)\n#define sz(s) (s).size()\n#define pb push_back\n#define fi first\n#define se second\n//#define mp make_pair\n\ntemplate<class T>\nvoid maxi(T &a, const T &b){\n    if(a < b) a = b;\n}\n\n\nint n, m;\nint ss[11234], alone[11234];\n\nvoid solve() {\n    int ssa = 0, alonea = 0;\n    int count = 0;\n    REP(i, n){\n        maxi(ssa, ss[i]);\n    }\n    REP(i, n){\n        count += ss[i] == ssa;\n    }\n    REP(i, n){\n        if(!(ss[i] == ssa && count == 1)){\n            maxi(alonea, alone[i]);\n        }\n    }\n    // REP(i, n) cout << ss[i] << \" \\n\"[i == n - 1];\n    // REP(i, m) cout << alone[i] << \" \\n\"[i == m - 1];\n    cout << ssa - alonea + 1 << endl;\n}\n\nint main(int argc, char *argv[]){\n\n  /*ICPC*/\n  while (cin >> n >> m, n && m) {\n    REP(i, m){\n      int s, k;\n      int c[11234];\n      cin >> s >> k;\n      REP(j, k){\n          cin >> c[j];\n          --c[j];\n      }\n      REP(j, k) ss[c[j]] += s;\n      if(k == 1) alone[c[0]] += s;  \n    }\n    solve();\n    REP(i, m){\n        ss[i] = alone[i] = 0;\n    }\n  }\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <set>\n#include <cmath>\n#include <string>\n#define FI first\n#define SE second\n#define PF push_front\n#define PB push_back\n#define PPF pop_front\n#define PPB pop_back\n#define MA make_pair\n#define ll long long\n#define PA pair<int,int>\n#define VE vector<int>\n#define VP vector<PA>\n#define FOR(i,a,b) for(int i=a;i<b;i++)\n#define ROF(i,a,b) for(int i=b-1;i>=a;i--)\n#define YES(i) cout<<(i?\"YES\":\"NO\")<<endl\n#define Yes(i) cout<<(i?\"Yes\":\"No\")<<endl\nusing namespace std;\n//\nconst int INF=1e9+7;\nconst int mod=1e9+7;\n//\nstruct poi{\n\tint X;int Y;int Z;\n\tbool operator<(const poi&R)const{\n\t\treturn X==R.X ? Y==R.Y ? Z<R.Z : Y<R.Y : X<R.X;\n\t}\n};\n/*\nll GCD(ll A,ll B){\n  return (B==0)?(A):(GCD(B,A%B));\n}\nll LCM(ll A,ll B){\n  return A/GCD(A,B)*B;\n}\n*/\nint main(){\n\tint N,M;\n\twhile(1){\n\t\tcin>>N>>M;\n\t\tif(N==0&&M==0){\n\t\t\tbreak;\n\t\t}\n\t\tint A[10000];\n\t\tint a[10000];\n\t\tfill(A,A+N,0);\n\t\tfill(a,a+N,0);\n\t\tFOR(i,0,M){\n\t\t\tint S,K,C;\n\t\t\tcin>>S>>K;\n\t\t\tFOR(j,0,K){\n\t\t\t\tcin>>C;\n\t\t\t\tC--;\n\t\t\t\tif(K==1){\n\t\t\t\t\ta[C]+=S;\n\t\t\t\t\tA[C]+=S;\n\t\t\t\t}else{\n\t\t\t\t\tA[C]+=S;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ma=0,mem;\n\t\tFOR(i,0,N){\n\t\t\tif(ma<A[i]){\n\t\t\t\tma=A[i];\n\t\t\t\tmem=i;\n\t\t\t}\n\t\t}\n\t\tint mi=INF;\n\t\tFOR(i,0,N){\n\t\t\tif(i!=mem){\n\t\t\t\tmi=min(mi,a[i]);\n\t\t\t}\n\t\t}\n\t\tcout<<ma-mi+1<<endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define rep(i,n) for(int i = 0; i<(n); ++i)\n\nint s[10004];\nvector<int> c[1003];\n\nint main(){\n    int n,m;\n    while(cin >> n >> m){\n        if( n == 0) return 0;\n        rep(i, m){\n            int k;\n            cin >> s[i] >> k;\n            c[i].clear();\n            rep(j, k){\n                int C;\n                cin >> C;\n                --C;\n                c[i].push_back(C);\n            }\n        }\n        int ret = 0;\n        rep(i, n){\n            int ma = 0;\n            int x[10004];\n            rep(j, n) x[j] = 0;\n            rep(j, m){\n                bool f = false;\n                for(int z:c[j]){\n                    f |= z == i;\n                }\n                if(f) ma+=s[j];\n                else if(c[j].size() == 1){\n                    x[c[j][0]] += s[j];\n                }\n            }\n            int mi = ma;\n            rep(j, n){\n                if(i == j) continue;\n                mi = min(mi, x[j]);\n            }\n//            cout << \"# \" << i+1 << \" \" << ma << \" \" << mi << endl;\n            ret = max(ret, ma - mi + 1 );\n        }\n        cout << ret << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <sstream>\n#include <tuple>\n#include <queue>\n#include <set>\n#include <cstdio>\n#include <climits>\n#include <cmath>\n#include <array>\n#include <functional>\n#include <list>\n#include <iomanip>\n#include <set>\nconst int MOD=1000000007;\nconst int INF=1000000000;\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\nconst double eps=1e-9;\nconst int inf=1e9;\ntypedef pair<ll,ll> P;\n\nint mx[10005];\nint mn[10005];\nint main(int argc,char const* argv[])\n{\n  int n,m;\n  while(cin >> n >> m && n)\n    {\n      memset(mx,0,sizeof(mx));\n      memset(mn,0,sizeof(mn));\n      for(int i=0;i<m;i++)\n\t{\n\t  int s,k;\n\t  cin >> s >> k;\n\t  for(int j=0;j<k;j++)\n\t    {\n\t      int c;\n\t      cin >>c;\n\t      c--;\n\t      if(k==1) mn[c]+=s;\n\t      mx[c]+=s;\n\t    }\n\t}\n      int ans=0;\n      for(int i=0;i<n;i++)\n\t{\n\t  for(int j=0;j<n;j++)\n\t    {\n\t      if(i==j) continue;\n\t      ans=max(ans,mx[i]-mn[j]);\n\t    }\n\t}\n      cout << ans+1 << endl;\n    }\n  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n    int N, M;\n    while (cin >> N >> M, N || M) {\n        vector<int> v(N);\n        vector<int> min_cost(N);\n        for (int i = 0; i < N; i++) {\n            int s, k;\n            cin >> s >> k;\n            if (k == 1) {\n                int t;\n                cin >> t;\n                v[t-1] += s;\n                min_cost[t-1] += s;\n                continue;\n            }\n            for (int j = 0; j < k; j++) {\n                int t; cin >> t;\n                v[t-1] += s;\n            }\n        }\n\n        int max_sum = 0;\n        for (int i = 0; i < N; i++) {\n            max_sum = max(max_sum, v[i]);\n        }\n\n        int ans = 0;\n        for (int i = 0; i < N; i++) {\n            ans = max(ans, max_sum - min_cost[i]);\n        }\n\n        cout << ans+1 << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <utility>\nusing namespace std;\n\nint main(){\n    while(1){\n        int n,m;\n        cin >> n >> m;\n        if(n==0) break;\n\n        vector<int> solvable(n), mustsolve(n);\n        for(int i=0; i<m; i++){\n            int s,k;\n            cin >> s >> k;\n            vector<int> c(k);\n            for(int j=0; j<k; j++){\n                cin >> c[j];\n                c[j]--;\n                solvable[c[j]] += s;\n            }\n            if(k==1){\n                mustsolve[c[0]] += s;\n            }\n        }\n        \n        vector<pair<int,int> > a(n), b(n);\n        for(int i=0; i<n; i++){\n            a[i] = make_pair(solvable[i], i);\n            b[i] = make_pair(mustsolve[i], i);\n        }\n        sort(a.begin(), a.end());\n        sort(b.begin(), b.end());\n\n        if(a[n-1].second != b[0].second){\n            cout << a[n-1].first -b[0].first +1 << endl;\n        }else{\n            cout << max(a[n-1].first -b[1].first, a[n-2].first -b[0].first) +1 << endl;\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i, n) for (int i = 0; i < n; i++)\n#define ALL(obj) obj.begin(), obj.end()\n#define fcout cout << setprecision(10)\n\nconst int iINF = 1e9;\nconst long long llINF = 1e18;\nconst int MOD = 1e9 + 7;\n\nusing namespace std;\n\ntemplate <typename T>\nvoid debug(vector<T> &vec) {\n    for (auto x : vec) {\n        cout << x << \" \";\n    }\n    cout << endl;\n    return;\n}\n\ntemplate <typename A, size_t N, typename T>\nvoid FILL(A (&array)[N], const T &val) {\n    std::fill((T *)array, (T *)(array + N), val);\n}\n\ntemplate <typename T>\nint getFormer(const vector<T> &vec, T x) {\n    return upper_bound(vec.begin(), vec.end(), x) - vec.begin() - 1;\n}\n\ntemplate <typename T>\nint getLatter(const vector<T> &vec, T x) {\n    return lower_bound(vec.begin(), vec.end(), x) - vec.begin();\n}\n\nvoid solve(int N, int M) {\n    vector<int> S(M), k(M);\n    vector<vector<int>> c(M + 1, vector<int>(N + 1, 0));\n    REP(i, M) {\n        cin >> S[i] >> k[i];\n        REP(j, k[i]) { cin >> c[i][j]; }\n    }\n\n    vector<long long> maxs(N, 0), mins(N, 0);\n    long long res = 0;\n    REP(i, M) {\n        REP(j, k[i]) { maxs[c[i][j] - 1] += S[i]; }\n    }\n\n    res = *max_element(ALL(maxs));\n    bool noOne = true;\n\n    REP(i, M) {\n        if (k[i] != 1) continue;\n        REP(j, k[i]) { mins[c[i][j] - 1] += S[i]; }\n        noOne = false;\n    }\n\n    REP(i, N) {\n        if (mins[i] != 0) continue;\n        mins[i] = llINF;\n    }\n\n    if (noOne || res == *min_element(ALL(mins))) {\n        cout << res + 1 << endl;\n    } else {\n        cout << res - *min_element(ALL(mins)) + 1 << endl;\n    }\n\n    return;\n}\n\nint main() {\n    int N, M;\n    while (cin >> N >> M && N) {\n        solve(N, M);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "// #define _GLIBCXX_DEBUG // for STL debug (optional)\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <deque>\n#include <list>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <utility>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <complex>\n#include <cmath>\n#include <limits>\n#include <cfloat>\n#include <climits>\n#include <ctime>\n#include <cassert>\n#include <numeric>\n#include <fstream>\n#include <functional>\n#include <bitset>\nusing namespace std;\n\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n#define int long long int\n \ntemplate<typename T> void chmax(T &a, T b) {a = max(a, b);}\ntemplate<typename T> void chmin(T &a, T b) {a = min(a, b);}\ntemplate<typename T> void chadd(T &a, T b) {a = a + b;}\n \ntypedef pair<int, int> pii;\ntypedef long long ll;\n \nint dx[] = {0, 0, 1, -1};\nint dy[] = {1, -1, 0, 0};\nconst ll INF = 1001001001001001LL;\nconst ll MOD = 1000000007LL;\n\n\nsigned main() {    \n    int N, M;\n    while(cin >> N >> M, N || M) {\n        int sum = 0;\n        vector<int> S(M), point(N), occupy(N);\n        vector< vector<int> > per(M);\n        for(int i=0; i<M; i++) {\n            int K; cin >> S[i] >> K;\n            sum += S[i];\n            for(int j=0; j<K; j++) {\n                int p; cin >> p; p--;\n                per[i].push_back(p);\n\n                point[p] += S[i];\n                if(K == 1) occupy[p] += S[i];\n            }\n        }\n\n        set< pair<int, int> > info;\n        for(int i=0; i<N; i++) {\n            info.emplace(point[i], i);\n        }\n\n        int ub = sum + 10, lb = 0;\n        // fprintf(stderr, \"sum = %lld\\n\", sum);\n        while(ub - lb > 1) {\n            int mid = (ub + lb) / 2;\n\n            bool ok = true;\n            for(int i=0; i<N; i++) {\n                auto tup = make_pair(point[i], i);\n                info.erase(tup);\n\n                // 2 人以上なので OK\n                int max_point = (--info.end()) -> first;\n\n                int user_point = occupy[i] + mid;\n                ok &= (user_point > max_point);\n\n                info.insert(tup);\n            }\n            if(ok) ub = mid;\n            else lb = mid;\n        }\n        cout << ub << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\ntypedef long long ll;\n\nint solve(void);\n\nint main(void)\n{\n\twhile (solve())\n\t{\n\t}\n\n\treturn 0;\n}\n\nint solve(void)\n{\n\tll N, M;\n\tcin >> N >> M;\n\tif(!(N|M)) { return 0; }\n\n\t// v[i][0] = min, v[i][1] = max\n\tvector<vector<ll>> v(N, vector<ll>(2, 0));\n\tfor (ll i = 0; i < M; i++)\n\t{\n\t\tll S, k;\n\t\tcin >> S >> k;\n\t\tfor (ll j = 0; j < k; j++)\n\t\t{\n\t\t\tll c;\n\t\t\tcin >> c;\n\t\t\t// update min\n\t\t\tif (k == 1) {\n\t\t\t\tv[c-1][0] += S;\n\t\t\t}\n\t\t\t// update max\n\t\t\tv[c-1][1] += S;\n\t\t}\n\t}\n\n\tll ans = 0;\n\tfor (ll i = 0; i < N; i++)\n\t{\n\t\tfor (ll j = 0; j < N; j++) {\n\t\t\tif(i == j) continue;\n\t\t\tans = max(ans, v[i][1] - v[j][0] + 1);\n\t\t}\n\t}\n\n\tcout << ans << endl;\n\n\treturn 1;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\n\nnamespace FastFourierTransform\n{\n\tusing C = complex< double >;\n\n\tvoid DiscreteFourierTransform(vector< C > &F, bool rev)\n\t{\n\t\tconst int N = (int)F.size();\n\t\tconst double PI = (rev ? -1 : 1) * acos(-1);\n\t\tfor (int i = 0, j = 1; j + 1 < N; j++) {\n\t\t\tint k=N>>1;\n\t\t\tfor (; k > (i ^= k); k >>= 1);\n\t\t\tif (i > j) {\n\t\t\t\tswap(F[i], F[j]);\n\t\t\t}\n\t\t}\n\t\tC w, s, t;\n\t\tfor (int i = 1; i < N; i <<= 1) {\n\t\t\tfor (int k = 0; k < i; k++) {\n\t\t\t\tw = polar(1.0, PI / i * k);\n\t\t\t\tfor (int j = 0; j < N; j += i * 2) {\n\t\t\t\t\ts = F[j + k];\n\t\t\t\t\tt = C(F[j + k + i].real() * w.real() - F[j + k + i].imag() * w.imag(),\n\t\t\t\t\t\tF[j + k + i].real() * w.imag() + F[j + k + i].imag() * w.real());\n\t\t\t\t\tF[j + k] = s + t, F[j + k + i] = s - t;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (rev) for (int i = 0; i < N; i++) F[i] /= N;\n\t}\n\n\tvector< long long > Multiply(const vector<long long int > &A, const vector<long long int > &B)\n\t{\n\t\tint sz = 1;\n\t\twhile (sz <= A.size() + B.size()) sz <<= 1;\n\t\tvector< C > F(sz), G(sz);\n\t\tfor (int i = 0; i < A.size(); i++) F[i] = A[i];\n\t\tfor (int i = 0; i < B.size(); i++) G[i] = B[i];\n\t\tDiscreteFourierTransform(F, false);\n\t\tDiscreteFourierTransform(G, false);\n\t\tfor (int i = 0; i < sz; i++) F[i] *= G[i];\n\t\tDiscreteFourierTransform(F, true);\n\t\tvector< long long > X(A.size() + B.size() - 1);\n\t\tfor (int i = 0; i < A.size() + B.size() - 1; i++) X[i] = F[i].real() + 0.5;\n\t\treturn (X);\n\t}\n};\n\nlong long int comb(long long int a, long long int k) {\n\tif(k==0)return 1;\n\tif(k==a)return 1;\n\treturn comb(a-1,k-1)+comb(a-1,k);\n}\n\nlong long int solve(int k,const vector<int>&v,vector< int>nums, const int now) {\n\tif (now == 10) {\n\t\tlong long int ans=1;\n\t\tint sum=accumulate(nums.begin(),nums.end(),0);\n\t\tint rest=sum;\n\t\tfor (int i = 0; i < 10; ++i) {\n\t\t\tif (nums[i]) {\n\t\t\t\tans*=comb(rest,nums[i]);\n\t\t\t\trest-=nums[i];\n\t\t\t}\n\t\t}\n\t\tif (nums[0]) {\n\t\t\tlong long int nans=1;\n\t\t\tint rest=sum-1;\n\t\t\tfor (int i = 0; i < 10; ++i) {\n\t\t\t\tif (nums[i]) {\n\t\t\t\t\tif(i==0)nans*=comb(rest,nums[i]-1);\n\t\t\t\t\telse nans*=comb(rest,nums[i]);\n\n\t\t\t\t\tif(i==0)rest-=nums[i]-1;\n\t\t\t\t\telse rest-=nums[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tans-=nans;\n\t\t}\n\t\treturn ans;\n\t}\n\telse {\n\t\tif (v[now]) {\n\t\t\tlong long int ans=0;\n\n\t\t\tfor (int x = 1; x <= v[now];++x) {\n\t\t\t\tnums[now]=x;\n\t\t\t\tans += solve(k, v, nums, now + 1);\n\t\t\t}\n\t\t\treturn ans;\n\t\t}\n\t\telse {\n\t\t\tnums[now]=0;\n\t\t\treturn solve(k,v,nums,now+1);\n\t\t}\n\t}\n}\n\nint main()\n{\n\twhile (true) {\n\t\tint N,M;cin>>N>>M;\n\t\tif(!N)break;\n\t\tvector<int>scores(N);\n\t\tvector<int>plus_scores(N);\n\t\tfor (int i = 0; i < M; ++i) {\n\t\t\tint s;cin>>s;\n\t\t\tint k;cin>>k;\n\t\t\tfor (int j = 0; j < k; ++j) {\n\t\t\t\tint a;cin>>a;a--;\n\t\t\t\tif (k == 1) {\n\t\t\t\t\tscores[a]+=s;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tplus_scores[a]+=s;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvector<pair<int,int>>max_scores;\n\t\tvector<pair<int,int>>min_scores;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tmax_scores.push_back(make_pair(scores[i]+plus_scores[i],i));\n\t\t\tmin_scores.push_back(make_pair(scores[i],i));\n\t\t}\n\t\tsort(max_scores.begin(),max_scores.end(),greater<pair<int,int>>());\n\t\tsort(min_scores.begin(),min_scores.end());\n\n\t\tint ans=-1e9;\n\t\tfor (int i = 0; i < 2; ++i) {\n\t\t\tauto ma_s=max_scores[i];\n\t\t\tfor (int j = 0; j < 2; ++j) {\n\t\t\t\tauto mi_s=min_scores[j];\n\t\t\t\tif (ma_s.second != mi_s.second) {\n\t\t\t\t\tans=max(ans,ma_s.first-mi_s.first+1);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<ll, ll> P;\ntypedef vector<ll> V;\ntypedef complex<double> Point;\n\n#define PI acos(-1.0)\n#define EPS 1e-10\nconst ll INF = 1e16;\nconst ll MOD = 1e9 + 7;\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define rep(i,N) for(int i=0;i<(N);i++)\n#define ALL(s) (s).begin(),(s).end()\n#define EQ(a,b) (abs((a)-(b))<EPS)\n#define EQV(a,b) ( EQ((a).real(), (b).real()) && EQ((a).imag(), (b).imag()) )\n#define fi first\n#define se second\n#define N_SIZE (1LL << 20)\n#define NIL -1\n\nll mod_add(ll a, ll b) { return (a + b) % MOD; }\nll mod_sub(ll a, ll b) { return (a - b + MOD) % MOD; }\nll mod_mul(ll a, ll b) { return a*b % MOD; }\n\nll n,m;\n\nint main(){\n    while(cin >> n >> m && n){\n        ll MAX[10001] = {};\n        ll MIN[10001] = {};\n        rep(i,m){\n            ll s,k;\n            cin >> s >> k;\n            rep(j,k){\n                ll num;\n                cin >> num;\n                num--;\n                if(k == 1)MIN[num] += s;\n                MAX[num] += s;\n            }\n        }\n        ll ans = 0;\n        rep(i,n){\n            rep(j,n){\n                if(i != j)ans = max(ans,MAX[i] - MIN[j]);\n            }\n        }\n        cout << ans + 1 << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nusing i64 = long long int;\nusing ui64 = unsigned long long int;\n\n////////////////////////////////\n\nstruct d{\n    vector<int> k;\n    int s;\n};\n\nint main()\n{\n    int n,m;\n    while(cin >> n >> m,n||m){\n        vector<d> data(m);\n        for(int i=0;i<m;i++){\n            cin >> data[i].s;\n            int k;\n            cin >> k;\n            data[i].k.resize(k);\n            for(int j=0;j<k;j++){\n                cin >> data[i].k[j];\n            }\n        }\n        vector<int> maxscore(n+1,0);\n        for(int i=0;i<m;i++){\n            int s = data[i].s;\n            for(int j=0;j<data[i].k.size();j++){\n                maxscore[data[i].k[j]]+=s;\n            }\n        }\n        for(int i=0;i<maxscore.size();i++)cout << maxscore[i] << \" \";\n        cout << endl;\n        vector<int> bestscore(n+1);\n        sort(data.begin(),data.end(),[](const d& l,const d& r){return l.s>r.s;});\n        for(int i=0;i<m;i++){\n            int bestj = 0;\n            for(int j=0;j<data[i].k.size();j++){\n                int c = data[i].k[j];\n                if(bestscore[bestj]<bestscore[c]||(bestscore[bestj]==bestscore[c]&&maxscore[bestj]<maxscore[c])){\n                    bestj = c;\n                }\n            }\n            bestscore[bestj]+=data[i].s;\n        }\n        for(int i=0;i<bestscore.size();i++)cout << bestscore[i] << \" \";\n        cout << endl;\n        sort(bestscore.begin(),bestscore.end());\n        // cout << n << \" \" << m << endl;\n        cout << bestscore.back()-bestscore[1] + 1 << endl;\n    }\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define lps(i,j,n) for(int i=j;i<n;i++)\n#define lp(i,n) lps(i,0,n)\n#define DEKAI 1000000007\n#define INF (1<<28)\n\nsigned main(){\n  int a[20000],m[20000];\n  while(1){\n    lp(i,20000){\n      m[i]=0;\n      a[i]=0;\n    }\n    int n,mm;\n    cin>>n>>mm;\n    if(n==0&&mm==0) break;\n    lp(i,mm){\n      int s,k;\n      cin>>s>>k;\n      lp(j,k){\n\tint x;\n\tcin>>x;\n\tm[x]+=s;\n\tif(k==1){\n\t  a[x]+=s;\n\t}\n      }\n    }\n    int ansmax=-INF,es,ansmin=INF;\n    lp(i,n){\n      if(ansmax<m[i+1]) es=i;\n      ansmax=max(ansmax,m[i+1]);\n    }\n    lp(i,n){\n      if(i==es) continue;\n      ansmin=min(ansmin,a[i+1]);\n    }\n    //  cout<<ansmax<<\" \"<<ansmin<<endl;\n    cout<<ansmax-ansmin+1<<endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  int n, m;\n  while (cin >> n >> m) {\n    if (n == 0) break;\n    vector<int> mx(n, 0), mn(n, 0);\n    for (int i = 0; i < m; i++) {\n      int s, k;\n      cin >> s >> k;\n      for (int j = 0; j < k; j++) {\n        int c;\n        cin >> c, c--;\n        if (k == 1) mn[c] += s;\n        mx[c] += s;\n      }\n    }\n\n    pair<int, int> pmx(-1, -1), pmn(-1, 1e9);\n    for (int i = 0; i < n; i++) {\n      if (mx[i] > pmx.second) pmx = {i, mx[i]};\n      if (mn[i] < pmn.second) pmn = {i, mn[i]};\n    }\n    int ans = 0;\n    for (int i = 0; i < n; i++) {\n      if (i != pmx.first) ans = max(ans, mx[pmx.first] - mn[i]);\n      if (i != pmn.first) ans = max(ans, mx[i] - mn[pmn.first]);\n    }\n\n    cout << ans + 1 << endl;\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define syosu(x) fixed<<setprecision(x)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\ntypedef pair<int,int> P;\ntypedef pair<double,double> pdd;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<string> vs;\ntypedef vector<P> vp;\ntypedef vector<vp> vvp;\ntypedef vector<pll> vpll;\ntypedef pair<int,P> pip;\ntypedef vector<pip> vip;\nconst int inf=1<<29;\nconst ll INF=1ll<<60;\nconst double pi=acos(-1);\nconst double eps=1e-11;\nconst ll mod=1e9+7;\nconst int dx[4]={-1,0,1,0},dy[4]={0,-1,0,1};\n\n\nint main(){\n\tios::sync_with_stdio(0);\n\tcin.tie(0);\n\twhile(1){\n\t\tint n,m;\n\t\tcin>>n>>m;\n\t\tif(n==0) break;\n\t\tvi a(n),b(n);\n\t\tfor(int i=0;i<m;i++){\n\t\t\tint x,k;\n\t\t\tcin>>x>>k;\n\t\t\tfor(int j=0;j<k;j++){\n\t\t\t\tint id;\n\t\t\t\tcin>>id;\n\t\t\t\tid--;\n\t\t\t\tif(k==1) b[id]+=x;\n\t\t\t\ta[id]+=x;\n\t\t\t}\n\t\t}\n\t\tvi c(n),d(n);\n\t\tint res=0;\n\t\tc[0]=d[n-1]=inf;\n\t\tfor(int i=1;i<n;i++) c[i]=min(c[i-1],b[i-1]);\n\t\tfor(int i=n-2;i>=0;i--) d[i]=min(d[i+1],b[i+1]);\n\t\tfor(int i=0;i<n;i++){\n\t\t\tres=max(res,a[i]-min(c[i],d[i]));\n\t\t}\n\t\tcout<<res+1<<endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\n// #define int ll\nusing PII = pair<ll, ll>;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n\ntemplate<typename T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<typename T> T &chmax(T &a, const T &b) { return a = max(a, b); }\ntemplate<typename T> bool IN(T a, T b, T x) { return a<=x&&x<b; }\ntemplate<typename T> T ceil(T a, T b) { return a/b + !!(a%b); }\n\ntemplate<typename T> vector<T> make_v(size_t a) { return vector<T>(a); }\ntemplate<typename T,typename... Ts>\nauto make_v(size_t a,Ts... ts) {\n    return vector<decltype(make_v<T>(ts...))>(a,make_v<T>(ts...));\n}\ntemplate<typename T,typename V> typename enable_if<is_class<T>::value==0>::type\nfill_v(T &t, const V &v) { t=v; }\ntemplate<typename T,typename V> typename enable_if<is_class<T>::value!=0>::type\nfill_v(T &t, const V &v ) { for(auto &e:t) fill_v(e,v); }\n\ntemplate<class S,class T>\nostream &operator <<(ostream& out,const pair<S,T>& a) {\n    out<<'('<<a.first<<','<<a.second<<')'; return out;\n}\ntemplate<class T>\nostream &operator <<(ostream& out,const vector<T>& a){\n    out<<'[';\n    for(const T &i: a) out<<i<<',';\n    out<<']';\n    return out;\n}\ntemplate<class T>\nostream &operator <<(ostream& out, const set<T>& a) {\n    out<<'{';\n    for(const T &i: a) out<<i<<',';\n    out<<'}';\n    return out;\n}\ntemplate<class T, class S>\nostream &operator <<(ostream& out, const map<T,S>& a) {\n    out<<'{';\n    for(auto &i: a) out<<i<<',';\n    out<<'}';\n    return out;\n}\n\nint dx[] = {0, 1, 0, -1}, dy[] = {1, 0, -1, 0}; // DRUL\nconst int INF = 1<<30;\nconst ll LLINF = 1LL<<60;\nconst ll MOD = 1000000007;\n\nsigned main(void)\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while(1) {\n        ll n, m;\n        cin >> n >> m;\n        if(!n) break;\n\n        vector<ll> s(m), ma(n), mi(n);\n        REP(i, m) {\n            cin >> s[i];\n            ll k;\n            cin >> k;\n            REP(j, k) {\n                ll a;\n                cin >> a;\n                ma[a-1] += s[i];\n                if(k == 1) mi[a-1] += s[i];\n            }\n        }\n\n        ll mi1=LLINF, idx1=-1, mi2=LLINF;\n        REP(i, n) {\n            if(mi1 > mi[i]) {\n                mi2 = mi1;\n                mi1 = mi[i];\n                idx1 = i;\n            } else if(mi2 > mi[i]) {\n                mi2 = mi[i];\n            }\n        }\n\n        ll ret = 0;\n        REP(i, n) chmax(ret, ma[i] - (i==idx1?mi2:mi1));\n        cout << ret+1 << endl;\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\n#include<bitset>\n#include<stack>\n#include<unordered_map>\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int ui;\nconst ll mod = (1e+9) + 7;\nconst ll INF = (ll)1000000007 * 1000000007;\ntypedef pair<int, int> P;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef long double ld;\ntypedef complex<ld> Point;\nconst ld eps = 1e-4;\nconst ld pi = acos(-1.0);\ntypedef pair<ll, ll> LP;\ntypedef pair<ld, ld> LDP;\nint n, m;\nll a[1 << 14], b[1 << 14];\nint main() {\n\twhile (cin >> n >> m, n) {\n\t\trep(i, n) {\n\t\t\ta[i] = b[i] = 0;\n\t\t}\n\t\trep(i, m) {\n\t\t\tll s; cin >> s; int k; cin >> k;\n\t\t\trep(j, k) {\n\t\t\t\tint c; cin >> c; c--;\n\t\t\t\ta[c] += s;\n\t\t\t\tif (k == 1) {\n\t\t\t\t\tb[c] += s;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tll ma = 0; int id;\n\t\tll mi = INF; int chk;\n\t\trep(i, n) {\n\t\t\tif (ma < a[i]) {\n\t\t\t\tma = a[i]; id = i;\n\t\t\t}\n\t\t\tif (mi > b[i]) {\n\t\t\t\tmi = b[i]; chk = i;\n\t\t\t}\n\t\t}\n\t\tll out = 0;\n\t\tif (id != chk) {\n\t\t\tout = ma - mi + 1;\n\t\t}\n\t\telse {\n\t\t\tll ma2 = 0,mi2 = INF;\n\t\t\trep(i, n) {\n\t\t\t\tif (i != id) {\n\t\t\t\t\tma2 = max(ma2, a[i]);\n\t\t\t\t}\n\t\t\t\tif (i != chk) {\n\t\t\t\t\tmi2 = min(mi2, b[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tout = max(ma2 - mi+1, ma - mi2+1);\n\t\t}\n\t\tcout << out << endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define _CRT_SECURE_NO_WARNINGS\n#include \"bits/stdc++.h\"\n#define rep(i, n) for (int i = 0; i < (n); ++i)\n#define FOR(i, m, n) for (int i = (m); i < (n); ++i)\n#define rrep(i, n) for (int i = (n) - 1; i >= 0; --i)\n#define rfor(i, m, n) for (int i = (m); i >= (n); --i)\n#define sz(x) ((int)(x).size())\n#define all(x) (x).begin(),(x).end()\n#define rall(x) (x).rbegin(),(x).rend()\n#define range_it(a, l, r) (a).begin() + (l), (a).begin() + (r)\n\nusing namespace std;\nusing ll = long long;\t\tusing ld = long double;\nusing VB = vector<bool>;\tusing VVB = vector<VB>;\nusing VI = vector<int>;\t\tusing VVI = vector<VI>;\nusing VL = vector<ll>;\t\tusing VVL = vector<VL>;\nusing VS = vector<string>;\tusing VD = vector<ld>;\nusing PII = pair<int, int>;\tusing VP = vector<PII>;\nusing PLL = pair<ll, ll>;\tusing VPL = vector<PLL>;\ntemplate<class T>using PQ = priority_queue<T>;\ntemplate<class T>using PQS = priority_queue<T, vector<T>, greater<T>>;\nconstexpr int inf = (int)1e9;\nconstexpr ll inf_ll = (ll)1e18, MOD = 1000000007;\nconstexpr ld PI = M_PI, EPS = 1e-12;\n\n// --- input --- //\n#ifdef _WIN32\n#define getchar_unlocked _getchar_nolock\n#define putchar_unlocked _putchar_nolock\n#define fwrite_unlocked fwrite\n#define fflush_unlocked _fflush_nolock\n#endif\ninline int gc() { return getchar_unlocked(); }\ntemplate<class T>inline void InputF(T& v) { cin >> v; }\ninline void InputF(char& v) { while (isspace(v = gc())); }\ninline void InputF(bool& v) { char c; InputF(c); v = c != '0'; }\ninline void InputF(string& v) {\n\tv.clear(); char c; for (InputF(c); !isspace(c); c = gc())v += c;\n}\ninline void InputF(int& v) {\n\tbool neg = false; v = 0; char c; InputF(c);\n\tif (c == '-') { neg = true; c = gc(); }\n\tfor (; isdigit(c); c = gc())v = v * 10 + (c - '0');\n\tif (neg)v = -v;\n}\ninline void InputF(long long& v) {\n\tbool neg = false; v = 0; char c; InputF(c);\n\tif (c == '-') { neg = true; c = gc(); }\n\tfor (; isdigit(c); c = gc())v = v * 10 + (c - '0');\n\tif (neg)v = -v;\n}\ninline void InputF(double& v) {\n\tdouble dp = 1; bool neg = false, adp = false; v = 0; char c; InputF(c);\n\tif (c == '-') { neg = true; c = gc(); }\n\tfor (; isdigit(c) || c == '.'; c = gc()) {\n\t\tif (c == '.')adp = true;\n\t\telse if (adp)v += (c - '0') * (dp *= 0.1);\n\t\telse v = v * 10 + (c - '0');\n\t}\n\tif (neg)v = -v;\n}\ntemplate<class T, class U>inline void InputF(pair<T, U>& v) {\n\tInputF(v.first); InputF(v.second);\n}\ntemplate<class T>inline void InputF(vector<T>& v) {\n\tfor (auto& e : v)InputF(e);\n}\ntemplate<class T>inline T InputF() { T v; InputF(v); return v; }\ninline string GetLine() {\n\tstring v; char c; for (InputF(c); c != '\\n' && c != '\\0'; c = gc())v += c; return v;\n}\nstruct InputV {\n\tint n, m;\n\tInputV(int N) :n(N), m(0) {}\n\tInputV(pair<int, int> N) :n(N.first), m(N.second) {}\n\ttemplate<class T>operator vector<T>() {\n\t\tvector<T> v(n); InputF(v); return v;\n\t}\n\ttemplate<class T>operator vector<vector<T>>() {\n\t\tvector<vector<T>> v(n, vector<T>(m)); InputF(v); return v;\n\t}\n};\nstruct Input {\n\ttemplate<class T>operator T() { return InputF<T>(); }\n\tint operator--(int) { int v; InputF(v); v--; return v; }\n\tInputV operator[](int n) { return InputV(n); }\n\tInputV operator[](pair<int, int> n) { return InputV(n); }\n\tvoid operator()() {}\n\ttemplate<class H, class...T>void operator()(H&& h, T&& ...t) {\n\t\tInputF(h); operator()(forward<T>(t)...);\n\t}\n\ttemplate<class T>Input& operator,(T&& v) {\n\t\tInputF(v); return *this;\n\t}\n}in;\n#define input(T) InputF<T>()\n#define ini input(int)\n#define inl input(ll)\n#define ins input(string)\n#define inputs(T, ...) T __VA_ARGS__; in(__VA_ARGS__)\n#define INT(...) inputs(int, __VA_ARGS__)\n#define LL(...) inputs(ll, __VA_ARGS__)\n#define STR(...) inputs(string, __VA_ARGS__)\n\n// --- output --- //\nstruct BoolStr {\n\tconst char* t, * f; BoolStr(const char* _t, const char* _f) :t(_t), f(_f) {}\n}Yes(\"Yes\", \"No\"), yes(\"yes\", \"no\"), YES(\"YES\", \"NO\"), Int(\"1\", \"0\");\nstruct DivStr {\n\tconst char* d, * l; DivStr(const char* _d, const char* _l) :d(_d), l(_l) {}\n}spc(\" \", \"\\n\"), no_spc(\"\", \"\\n\"), end_line(\"\\n\", \"\\n\"), comma(\",\", \"\\n\"), no_endl(\" \", \"\");\nclass Output {\n\tBoolStr B{ Yes }; DivStr D{ spc };\n\tvoid p(int v) {\n\t\tif (v < 0)putchar_unlocked('-'), v = -v;\n\t\tchar b[10]; int i = 0;\n\t\twhile (v)b[i++] = '0' + v % 10, v /= 10;\n\t\tif (!i)b[i++] = '0';\n\t\twhile (i--)putchar_unlocked(b[i]);\n\t}\n\tvoid p(ll v) {\n\t\tif (v < 0)putchar_unlocked('-'), v = -v;\n\t\tchar b[20]; int i = 0;\n\t\twhile (v)b[i++] = '0' + v % 10, v /= 10;\n\t\tif (!i)b[i++] = '0';\n\t\twhile (i--)putchar_unlocked(b[i]);\n\t}\n\tvoid p(bool v) { p(v ? B.t : B.f); }\n\tvoid p(char v) { putchar_unlocked(v); }\n\tvoid p(const char* v) { fwrite_unlocked(v, 1, strlen(v), stdout); }\n\tvoid p(double v) { printf(\"%.20f\", v); }\n\tvoid p(ld v) { printf(\"%.20Lf\", v); }\n\ttemplate<class T> void p(const T& v) { cout << v; }\n\ttemplate<class T, class U>void p(const pair<T, U>& v) { p(v.first); p(D.d); p(v.second); }\n\ttemplate<class T>void p(const vector<T>& v) { rep(i, sz(v)) { if (i)p(D.d); p(v[i]); } }\n\ttemplate<class T>void p(const vector<vector<T>>& v) { rep(i, sz(v)) { if (i)p(D.l); p(v[i]); } }\npublic:\n\tOutput& operator()() { p(D.l); return *this; }\n\ttemplate<class H>Output& operator()(H&& h) { p(h); p(D.l); return *this; }\n\ttemplate<class H, class...T>Output& operator()(H&& h, T&& ...t) {\n\t\tp(h); p(D.d); return operator()(forward<T>(t)...);\n\t}\n\ttemplate<class...T>void exit(T&& ...t) { operator()(forward<T>(t)...); std::exit(EXIT_SUCCESS); }\n\tOutput& flush() { fflush_unlocked(stdout); return *this; }\n\tOutput& set(const BoolStr& b) { B = b; return *this; }\n\tOutput& set(const DivStr& d) { D = d; return *this; }\n\tOutput& set(const char* t, const char* f) { B = BoolStr(t, f); return *this; }\n}out;\n\n// --- step --- //\ntemplate<class T>struct Step {\n\tclass It {\n\t\tT a, b, c;\n\tpublic:\n\t\tconstexpr It() : a(T()), b(T()), c(T()) {}\n\t\tconstexpr It(T _b, T _c, T _s) : a(_b), b(_c), c(_s) {}\n\t\tconstexpr It& operator++() { --b; a += c; return *this; }\n\t\tconstexpr It operator++(int) { It tmp = *this; --b; a += c; return tmp; }\n\t\tconstexpr const T& operator*()const { return a; }\n\t\tconstexpr const T* operator->()const { return &a; }\n\t\tconstexpr bool operator==(const It& i)const { return b == i.b; }\n\t\tconstexpr bool operator!=(const It& i)const { return !(b == i.b); }\n\t\tconstexpr T start()const { return a; }\n\t\tconstexpr T count()const { return b; }\n\t\tconstexpr T step()const { return c; }\n\t};\n\tconstexpr Step(T b, T c, T s) : be(b, c, s) {}\n\tconstexpr It begin()const { return be; }\n\tconstexpr It end()const { return en; }\n\tconstexpr T start()const { return be.start(); }\n\tconstexpr T count()const { return be.count(); }\n\tconstexpr T step()const { return be.step(); }\n\tconstexpr T sum()const { return start() * count() + step() * (count() * (count() - 1) / 2); }\n\toperator vector<T>()const { return as_vector(); }\n\tvector<T> as_vector()const {\n\t\tvector<T> res; res.reserve(count()); each([&](T i) {res.push_back(i); }); return res;\n\t}\n\ttemplate<class F>void each(const F& f)const { for (T i : *this)f(i); }\n\ttemplate<class F>auto map(const F& f)const {\n\t\tvector<decay_t<result_of_t<F(T)>>> res; res.reserve(count());\n\t\teach([&](T i) {res.push_back(f(i)); }); return res;\n\t}\n\ttemplate<class F>int count_if(const F& f)const {\n\t\tint res = 0; each([&](T i) {res += static_cast<bool>(f(i)); }); return res;\n\t}\n\ttemplate<class F>vector<T> select(const F& f)const {\n\t\tvector<T> res; each([&](T i) {if (f(i))res.push_back(i); }); return res;\n\t}\n\ttemplate<class F>auto max(const F& f)const {\n\t\tauto v = map(f); return *max_element(v.begin(), v.end());\n\t}\n\ttemplate<class F>auto min(const F& f)const {\n\t\tauto v = map(f); return *min_element(v.begin(), v.end());\n\t}\n\ttemplate<class F, class U = decay_t<result_of_t<F(T)>>>auto sum(const F& f)const {\n\t\tU res = 0; each([&](T i) {res += static_cast<U>(f(i)); }); return res;\n\t}\n\tusing value_type = T;\n\tusing iterator = It;\nprivate:\n\tIt be, en;\n};\ntemplate<class T>inline constexpr auto step(T a) { return Step<T>(0, a, 1); }\ntemplate<class T>inline constexpr auto step(T a, T b) { return Step<T>(a, b - a, 1); }\ntemplate<class T>inline constexpr auto step(T a, T b, T c) { return Step<T>(a, a < b ? (b - a - 1) / c + 1 : 0, c); }\n\n// --- functions --- //\ninline namespace {\n\ttemplate<class T>inline void Sort(T& a) { sort(all(a)); }\n\ttemplate<class T>inline void RSort(T& a) { sort(rall(a)); }\n\ttemplate<class T>inline T Sorted(T a) { Sort(a); return a; }\n\ttemplate<class T>inline T RSorted(T a) { RSort(a); return a; }\n\ttemplate<class T, class F>inline void Sort(T& a, const F& f) {\n\t\tsort(all(a), [&](const auto& x, const auto& y) {return f(x) < f(y); });\n\t}\n\ttemplate<class T, class F>inline void RSort(T& a, const F& f) {\n\t\tsort(rall(a), [&](const auto& x, const auto& y) {return f(x) < f(y); });\n\t}\n\ttemplate<class T>inline void Reverse(T& a) { reverse(all(a)); }\n\ttemplate<class T>inline void Unique(T& a) { a.erase(unique(all(a)), a.end()); }\n\ttemplate<class T>inline void Rotate(T& a, int left) { rotate(a.begin(), a.begin() + left, a.end()); }\n\ttemplate<class T>inline T Reversed(T a) { Reverse(a); return a; }\n\ttemplate<class T>inline T Uniqued(T a) { Unique(a); return a; }\n\ttemplate<class T>inline T Rotated(T a, int left) { Rotate(a, left); return a; }\n\ttemplate<class T>inline auto Max(const T& a) { return *max_element(all(a)); }\n\ttemplate<class T>inline auto Min(const T& a) { return *min_element(all(a)); }\n\ttemplate<class T>inline int MaxPos(const T& a) { return max_element(all(a)) - a.begin(); }\n\ttemplate<class T>inline int MinPos(const T& a) { return min_element(all(a)) - a.begin(); }\n\ttemplate<class T, class F>inline auto Max(const T& a, const F& f) {\n\t\treturn *max_element(all(a), [&](const auto& x, const auto& y) {return f(x) < f(y); });\n\t}\n\ttemplate<class T, class F>inline auto Min(const T& a, const F& f) {\n\t\treturn *min_element(all(a), [&](const auto& x, const auto& y) {return f(x) < f(y); });\n\t}\n\ttemplate<class T, class U>inline int Count(const T& a, const U& v) { return count(all(a), v); }\n\ttemplate<class T, class F>inline int CountIf(const T& a, const F& f) { return count_if(all(a), f); }\n\ttemplate<class T, class U>inline int Find(const T& a, const U& v) { return find(all(a), v) - a.begin(); }\n\ttemplate<class T, class F>inline int FindIf(const T& a, const F& f) { return find_if(all(a), f) - a.begin(); }\n\ttemplate<class T, class U = typename T::value_type>inline U Sum(const T& a) { return accumulate(all(a), U()); }\n\ttemplate<class T, class F>inline auto Sum(const T& v, const F& f) {\n\t\treturn accumulate(next(v.begin()), v.end(), f(v.front()), [&](auto a, auto b) {return a + f(b); });\n\t}\n\ttemplate<class T, class U>inline int Lower(const T& a, const U& v) { return lower_bound(all(a), v) - a.begin(); }\n\ttemplate<class T, class U>inline int Upper(const T& a, const U& v) { return upper_bound(all(a), v) - a.begin(); }\n\ttemplate<class T, class F>inline void RemoveIf(T& a, const F& f) { a.erase(remove_if(all(a), f), a.end()); }\n\ttemplate<class F>inline auto Vector(size_t size, const F& f) {\n\t\tvector<decay_t<result_of_t<F(size_t)>>> res(size); for (size_t i = 0; i < size; ++i)res[i] = f(i); return res;\n\t}\n\ttemplate<class T>inline auto Grid(size_t h, size_t w, const T& v = T()) { return vector<vector<T>>(h, vector<T>(w, v)); }\n\ttemplate<class T>inline auto Slice(const T& v, size_t i, size_t len) {\n\t\treturn i < v.size() ? T(v.begin() + i, v.begin() + min(i + len, v.size())) : T();\n\t}\n\ttemplate<class T, class F>inline auto Each(const T& v, const F& f) { for (auto& i : v)f(i); }\n\ttemplate<class T, class F>inline auto Select(const T& v, const F& f) {\n\t\tT res; for (const auto& e : v)if (f(e))res.push_back(e); return res;\n\t}\n\ttemplate<class T, class F>inline auto Map(const T& v, const F& f) {\n\t\tvector<decay_t<result_of_t<F(typename T::value_type)>>> res(v.size());\n\t\tsize_t i = 0; for (const auto& e : v)res[i++] = f(e); return res;\n\t}\n\ttemplate<class T, class F>inline auto MapIndex(const T& v, const F& f) {\n\t\tvector<decay_t<result_of_t<F(size_t, typename T::value_type)>>> res(v.size());\n\t\tsize_t i = 0; for (auto it = v.begin(); it != v.end(); ++it, ++i)res[i] = f(i, *it); return res;\n\t}\n\ttemplate<class T, class F>inline auto TrueIndex(const T& v, const F& f) {\n\t\tvector<size_t> res; for (size_t i = 0; i < v.size(); ++i)if (f(v[i]))res.push_back(i); return res;\n\t}\n\tinline string operator*(string s, size_t n) { string ret; for (size_t i = 0; i < n; ++i)ret += s; return ret; }\n\ttemplate<class T>inline T Ceil(T n, T m) { return (n + m - 1) / m; }\n\ttemplate<class T>inline T Ceil2(T n, T m) { return Ceil(n, m) * m; }\n\ttemplate<class T>inline T Tri(T n) { return (n & 1) ? (n + 1) / 2 * n : n / 2 * (n + 1); }\n\ttemplate<class T>inline T nC2(T n) { return (n & 1) ? (n - 1) / 2 * n : n / 2 * (n - 1); }\n\ttemplate<class T>inline T Mid(const T& l, const T& r) { return l + (r - l) / 2; }\n\tinline int pop_count(int n) { return bitset<32>(n).count(); }\n\tinline int pop_count(ll n) { return bitset<64>(n).count(); }\n\ttemplate<class T>inline bool chmax(T& a, const T& b) { if (a < b) { a = b; return true; } return false; }\n\ttemplate<class T>inline bool chmin(T& a, const T& b) { if (a > b) { a = b; return true; } return false; }\n\ttemplate<class T>inline bool inRange(const T& v, const T& min, const T& max) { return min <= v && v < max; }\n\ttemplate<class T = ll>inline T BIT(int b) { return T(1) << b; }\n\ttemplate<class T>inline T Gcd(T n, T m) { return m ? Gcd(m, n % m) : n; }\n\ttemplate<class T>inline T Lcm(T n, T m) { return n / Gcd(n, m) * m; }\n\ttemplate<class T, class U = typename T::value_type>inline U Gcdv(const T& v) {\n\t\treturn accumulate(next(v.begin()), v.end(), U(*v.begin()), Gcd<U>);\n\t}\n\ttemplate<class T, class U = typename T::value_type>inline U Lcmv(const T& v) {\n\t\treturn accumulate(next(v.begin()), v.end(), U(*v.begin()), Lcm<U>);\n\t}\n\ttemplate<class T>inline T Pow(T a, T n) { T r = 1; while (n > 0) { if (n & 1)r *= a; a *= a; n /= 2; } return r; }\n\ttemplate<class T>inline T Powmod(T a, T n, T m = MOD) {\n\t\tT r = 1; while (n > 0) { if (n & 1)r = r * a % m, n--; else a = a * a % m, n /= 2; }return r;\n\t}\n}\n\n// --- dump --- //\n#if __has_include(\"dump.hpp\")\n#include \"dump.hpp\"\n#else\n#define dump(...) ((void)0)\n#endif\n\n// ---------------------------------------------------------------- //\n\nint main() {\n\tfor (int n = in, m = in; n + m; in(n, m)) {\n\t\tVI s(m);\n\t\tVVI c(m);\n\t\tauto flag = Grid<bool>(m, n);\n\t\trep(i, m) {\n\t\t\tint k; in(s[i], k);\n\t\t\tc[i] = in[k];\n\t\t\tfor (int& j : c[i]) {\n\t\t\t\tj--;\n\t\t\t\tflag[i][j] = true;\n\t\t\t}\n\t\t}\n\n\t\tVP sum1(n);\n\t\trep(i, n)sum1[i].second = i;\n\t\trep(i, m) {\n\t\t\tif (sz(c[i]) == 1)\n\t\t\t\tsum1[c[i][0]].first += s[i];\n\t\t}\n\t\tSort(sum1);\n\n\t\tint ans = 0;\n\t\trep(ma, n) {\n\t\t\tint sum_ma = 0;\n\t\t\trep(i, m) {\n\t\t\t\tif (flag[i][ma])sum_ma += s[i];\n\t\t\t}\n\t\t\tint sum_mi = sum1[0].second != ma ? sum1[0].first : sum1[1].first;\n\t\t\tchmax(ans, sum_ma - sum_mi + 1);\n\t\t}\n\t\tout(ans);\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream> #include <iomanip> #include <stack> #include <queue> #include <vector> #include <algorithm> #include <map> #include <set> using namespace std; int main() { int n, m; cin >> n >> m; int s, k, c; while(n != 0 && m != 0){ vector<int> mx(n, 0), mn(n, 0); for(int i = 0; i < m; i++){ cin >> s >> k; for(int j = 0; j < k; j++){ cin >> c; c--; mx[c] += s; } if(k == 1)mn[c] += s; } int ans = 0; for(int i = 0; i < n; i++){ for(int j = 0; j < n; j++){ if(i == j)continue; ans = max(ans, mx[i] - mn[j]); } } cout << ans + 1 << endl; cin >> n >> m; } } \n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<ll, ll>P;\n\n\nint main(){\n    \n    for(ll N, M; cin >> N >> M, N;){\n        vector<ll>mx(N, 0);\n        vector<ll>mn(N, 0);\n        for(ll i = 0; i < M; i++){\n            ll s, k;\n            cin >> s >> k;\n            for(ll j = 0; j < k; j++){\n                ll c;\n                cin >> c;\n                c--;\n                if(k == 1)mn[c] += s;\n                mx[c] += s;\n            }\n        }\n        ll ans = 0;\n        P x(-1, -1), y(-2, -2);\n        for(ll i = 0; i < N; i++){\n            if(mx[i] >= x.first){\n                swap(x, y);\n                x.first = mx[i];\n                x.second = i;\n            }\n            else if(mx[i] >= y.first){\n                y.first = mx[i];\n                y.second = i;\n            }\n        }\n        for(ll i = 0; i < N; i++){\n            if(i == x.second)continue;\n            ans = max(ans, mx[x.second] - mn[i]);\n        }\n        for(ll i = 0; i < N; i++){\n            if(i == y.second)continue;\n            ans = max(ans, mx[y.second] - mn[i]);\n        }\n        cout << ans + 1 << endl;\n    }\n    \n    return 0;    \n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\nusing ll = long long;\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    int n, m;\n    while (cin >> n >> m, n || m)\n    {\n        assert(m>0 && n>0);\n        vector<ll> s(m), mi(n,0), sum(n,0);\n        for (int i = 0; i < m; i++)\n        {\n            cin >> s[i];\n            int k;\n            cin >> k;\n            vector<ll> c;\n            for (int j = 0; j < k; j++)\n            {\n                int tt;\n                cin >> tt;\n                tt--;\n                c.push_back(tt);\n            }\n            if(k==1)\n            {\n                mi[c[0]] += s[i];\n            }\n            else\n            {\n                for(auto v:c) sum[v] += s[i];\n            }\n        }\n        ll ret = 0;\n        for(int i=0;i<n;i++)\n        {\n            for(int j=0;j<n;j++)\n            {\n                if(i==j) continue;\n                ret = max({ret, mi[j] + sum[j]-mi[i]});\n            }\n        }\n        cout << ret + 1 << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define F first\n#define S second\n#define pi M_PI\n#define R cin>>\n#define Z class\n#define ll long long\n#define ln cout<<'\\n'\n#define in(a) insert(a)\n#define pb(a) push_back(a)\n#define pd(a) printf(\"%.10f\\n\",a)\n#define mem(a) memset(a,0,sizeof(a))\n#define all(c) (c).begin(),(c).end()\n#define iter(c) __typeof((c).begin())\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;i--)\n#define REP(i,m,n) for(int i=(int)(m);i<(int)(n);i++)\n#define rep(i,n) REP(i,0,n)\n#define tr(it,c) for(iter(c) it=(c).begin();it!=(c).end();it++)\ntemplate<Z A>void pr(A a){cout<<a;ln;}\ntemplate<Z A,Z B>void pr(A a,B b){cout<<a<<' ';pr(b);}\ntemplate<Z A,Z B,Z C>void pr(A a,B b,C c){cout<<a<<' ';pr(b,c);}\ntemplate<Z A,Z B,Z C,Z D>void pr(A a,B b,C c,D d){cout<<a<<' ';pr(b,c,d);}\ntemplate<Z A>void PR(A a,ll n){rep(i,n){if(i)cout<<' ';cout<<a[i];}ln;}\nll check(ll n,ll m,ll x,ll y){return x>=0&&x<n&&y>=0&&y<m;}\nconst ll MAX=1000000007,MAXL=1LL<<61,dx[4]={-1,0,1,0},dy[4]={0,1,0,-1};\ntypedef pair<ll,ll> P;\n\nvoid Main() {\n  int n,m;\n  while(cin >> n >> m && n) {\n    ll d[n][2];\n    mem(d);\n    rep(j,m) {\n      int s,k;\n      cin >> s >> k;\n      int a[k];\n      rep(i,k) {\n        R a[i];\n        a[i]--;\n      }\n      if(k==1) d[a[0]][0]+=s;\n      rep(i,k) d[a[i]][1]+=s;\n    }\n    vector<P> a(n),b(n);\n    rep(i,n) {\n      a[i]=P(d[i][1],i);\n      b[i]=P(d[i][0],i);\n    }\n    sort(all(a),greater<P>());\n    sort(all(b));\n    ll ans=0;\n    rep(i,2) {\n      ll x=a[i].F;\n      ll y=b[0].F;\n      if(b[0].S==a[i].S) y=b[1].F;\n      ans=max(ans,x-y+1);\n    }\n    pr(ans);\n  }\n}\n\nint main(){ios::sync_with_stdio(0);cin.tie(0);Main();return 0;}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\nsigned main(){\n  Int N, M;\n  while(cin >> N >> M, N || M) {\n    vector<Int> all(N), one(N);\n    for(Int i = 0; i < M; i++) {\n      Int S, k;\n      cin >> S >> k;\n      for(Int j = 0; j < k; j++) {\n        Int c;\n        cin >> c; c--;\n        all[c] += S;\n        if(k == 1) one[c] += S;\n      }\n    }\n    Int idx = -1;\n    Int mx = -1;\n    for(Int i = 0; i < N; i++) {\n      if(mx < all[i]) {\n        idx = i;\n        mx = all[i];\n      }\n    }\n    Int mn = 1000000;\n    for(Int i = 0; i < N; i++) {\n      if(i == idx) continue;\n      if(mn > one[i]) mn = one[i];\n    }\n    cout << mx - mn + 1 << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <iostream>\n#include <string>\n#include <utility>\n#include <vector>\n\nusing namespace std;\n\n#define rep(i, a, n) for(int i = (a);i < (n);i++)\n#define REP(i, n) rep(i,0,n)\n#define all(e) (e).begin(),(e).end()\n\n#ifdef LOCAL\n#define show(x) cerr<<__LINE__<<\": \"<<#x<<(x)<<endl\n#else\n#define show(x) true\n#endif\n\ntypedef long long ll;\ntemplate<class T> using V=vector<T>;\n\ntemplate<class T, class U>\nvoid chmin(T &t, const U u) { if (t > u) t = u; }\n\ntemplate<class T, class U>\nvoid chmax(T &t, const U u) { if (t < u) t = u; }\n\nconst int INF = (1 << 30) - 1;\nconst ll INFL = (ll) 5e15;\nconst int MOD = 1e9 + 7;\n\nstruct Solve {\n\n    bool solve() {\n        int N, M;\n        cin >> N >> M;\n        if (N == 0) return false;\n        vector<ll> high(N);\n        vector<ll> low(N);\n\n        for (int i = 0; i < M; ++i) {\n            ll s;\n            cin >> s;\n            int k;\n            cin >> k;\n            for (int j = 0; j < k; ++j) {\n                int c;\n                cin >> c;\n                c--;\n                if (k == 1) {\n                    low[c] += s;\n                }\n                high[c] += s;\n            }\n        }\n        vector<pair<ll, int>> hp(N);\n        vector<pair<ll, int>> lp(N);\n        for (int i = 0; i < N; ++i) {\n            hp[i].first = high[i];\n            hp[i].second = i;\n            lp[i].first = low[i];\n            lp[i].second = i;\n        }\n        sort(all(hp));\n        sort(all(lp));\n        ll ans = 0;\n\n        for (auto e : hp) {\n            ll H = e.first;\n            ll L = lp[0].first;\n            if (lp[0].second == e.second) {\n                L = lp[1].first;\n            }\n            ll tmp = H - L + 1;\n            chmax(ans, tmp);\n        }\n        cout << ans << endl;\n\n\n        return true;\n    }\n\n};\n\n\nint main() {\n    while (Solve().solve());\n    return 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cmath>\n#include<cstring>\n#include<unordered_map>\n#include<cassert>\n#include<climits>\n#include<vector>\n#include<deque>\n#include<map>\n#include<set>\n#include<algorithm>\n#include<bitset>\n#include<queue>\n#include<sstream>\n\n#define REP(i,s,n) for(int i=s;i<n;++i)\n#define rep(i,n) REP(i,0,n)\n#define IINF INT_MAX\n#define LLINF LLONG_MAX\n\nusing namespace std;\n\n\ntypedef long long ll;\n\nint N,M;\nll S[1010];\nvector<int> c[1010];\n\nvoid compute() {\n  ll maxi = 0;\n  REP(win,1,N+1) {\n    unordered_map<int,ll> fix;\n    ll mini = LLINF;\n    ll score = 0;\n    rep(i,M) {\n      int pos = -1;\n      rep(j,(int)c[i].size()) if( c[i][j] == win ) {\n\tpos = j;\n\tbreak;\n      }\n      if( pos == -1 ) {\n\tif( c[i].size() == 1 ) {\n\t  fix[c[i][0]] += S[i];\n\t}\n      } else {\n\tscore += S[i];\n      }\n    }\n\n    for(auto v : fix) {\n      if( v.first != win ) {\n\tmini = min(mini,v.second);\n      }\n    }\n    if( fix.size() != N-1 ) mini = 0;\n    if( mini == LLINF ) mini = 0;\n    //cout << \"win = \" << win << \" \" << score << \" - \" << mini << \" + 1\" << endl;\n    maxi = max(maxi,score-mini+1LL);\n  }\n  cout << maxi << endl;\n}\n\nint main() {\n  while( cin >> N >> M, N|M ) {\n    rep(i,M) c[i].clear();\n    rep(i,M) {\n      cin >> S[i];\n      c[i].clear();\n      int k;\n      cin >> k;\n      c[i].resize(k);\n      rep(j,k) cin >> c[i][j];\n    }\n    compute();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <utility>\n\nusing namespace std;\n\nusing Pii = pair<int, int>;\n\nint solve(int n, int q) {\n    vector<Pii> max_points(n, {0, 0}), min_points(n, {0, 0});\n    for(int i=0;i<n;++i) {\n        max_points[i].second = i;\n        min_points[i].second = i;\n    }\n    int s, k, player;\n    for(int i=0;i<q;++i) {\n        cin >> s >> k;\n        for(int j=0;j<k;++j) {\n            cin >> player;\n            max_points[player-1].first += s;\n            if(k == 1) min_points[player-1].first += s;\n        }\n    }\n\n    sort(max_points.rbegin(), max_points.rend());\n    sort(min_points.begin(), min_points.end());\n    if(max_points[0].second != min_points[0].second) {\n        return max_points[0].first+1-min_points[0].first;\n    }\n    int ret1 = max_points[1].first+1-min_points[0].first;\n    int ret2 = max_points[0].first+1-min_points[1].first;\n    return max(ret1, ret2);\n    \n}\n\nint main() {\n    int n,m;\n    while(cin >> n >> m && n) {\n        cout << solve(n, m) << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <string>\n#include <sstream>\n#include <stack>\n#include <algorithm>\n#include <cmath>\n#include <queue>\n#include <map>\n#include <set>\n#include <cstdlib>\n#include <bitset>\n#include <tuple>\n#include <assert.h>\n#include <deque>\n#include <bitset>\n#include <iomanip>\n#include <limits>\n#include <chrono>\n#include <random>\n#include <array>\n#include <unordered_map>\n#include <functional>\n#include <complex>\n\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\n\nconstexpr long long MAX = 5100000;\nconstexpr long long INF = 1LL << 60;\nconstexpr int inf = 1 << 28;\nconstexpr long long mod = 1000000007LL;\n//constexpr long long mod = 998244353LL;\n\nusing namespace std;\ntypedef unsigned long long ull;\ntypedef long long ll;\n\nint main()\n{\n\t/*\n\tcin.tie(nullptr);\n\tios::sync_with_stdio(false);\n\t*/\n\tint kkt = 89;\n\twhile (kkt) {\n\t\tll N, M; scanf(\"%lld %lld\", &N, &M); if (N == 0 && M == 0) break;\n\t\tvector<pair<ll, int>> score(N); for (int i = 0; i < N; i++) score[i].second = i;\n\t\tvector<pair<ll, int>> mn(N); for (int i = 0; i < N; i++) mn[i].second = i;\n\t\tfor (int i = 0; i < M; i++) {\n\t\t\tll s; scanf(\"%lld\", &s);\n\t\t\tll k; scanf(\"%lld\", &k);\n\t\t\tif (k == 1) {\n\t\t\t\tll x; scanf(\"%lld\", &x);\n\t\t\t\tx--;\n\t\t\t\tscore[x].first += s;\n\t\t\t\tmn[x].first += s;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (int j = 0; j < k; j++) {\n\t\t\t\t\tll x; scanf(\"%lld\", &x);\n\t\t\t\t\tx--;\n\t\t\t\t\tscore[x].first += s;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsort(score.rbegin(), score.rend());\n\t\tsort(mn.begin(), mn.end());\n\t\tif (score[0].second != mn[0].second) {\n\t\t\tcout << score[0].first - mn[0].first + 1<< \"\\n\";\n\t\t}\n\t\telse {\n\t\t\tcout << max(score[0].first - mn[1].first, score[1].first - mn[0].first) + 1 << \"\\n\";\n\t\t}\n\t}\n\treturn 0;\n\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n#include <queue>\n#include <vector>\ntypedef long long int ll;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\nusing namespace std;\n\nstruct Info_max{\n\tInfo_max(int arg_point,int arg_id){\n\t\tpoint = arg_point;\n\t\tid = arg_id;\n\t}\n\tbool operator<(const struct Info_max &arg) const{\n\t\t\treturn point < arg.point;\n\t};\n\tint point,id;\n};\n\nstruct Info_min{\n\tInfo_min(int arg_point,int arg_id){\n\t\tpoint = arg_point;\n\t\tid = arg_id;\n\t}\n\tbool operator<(const struct Info_min &arg) const{\n\t\t\treturn point > arg.point;\n\t};\n\tint point,id;\n};\n\n int main(){\n\n\t int N,M,max_points[10001],point,num,tmp,forced_points[10001],maximum,minimum;\n\t priority_queue<Info_max> MAX;\n\t priority_queue<Info_min> MIN;\n\t while(true){\n\t\t scanf(\"%d %d\",&N,&M);\n\t\t if(N == 0 && M == 0)break;\n\n\t\t for(int i = 1; i <= N; i++){\n\t\t\t max_points[i] = 0;\n\t\t\t forced_points[i] = 0;\n\t\t }\n\n\t\t for(int loop = 0; loop < M; loop++){\n\t\t\t scanf(\"%d %d\",&point,&num);\n\t\t\t if(num == 1){\n\t\t\t\t scanf(\"%d\",&tmp);\n\t\t\t\t forced_points[tmp] += point;\n\t\t\t\t max_points[tmp] += point;\n\t\t\t }else{ //num > 1\n\t\t\t\t for(int i = 0; i < num; i++){\n\t\t\t\t\t scanf(\"%d\",&tmp);\n\t\t\t\t\t max_points[tmp] += point;\n\t\t\t\t }\n\t\t\t }\n\t\t }\n\n\t\t while(!MAX.empty())MAX.pop();\n\t\t while(!MIN.empty())MIN.pop();\n\n\t\t for(int i = 1; i <= N; i++){\n\t\t\t MAX.push(Info_max(max_points[i],i));\n\t\t\t MIN.push(Info_min(forced_points[i],i));\n\t\t }\n\n\t\t if(MAX.top().id != MIN.top().id){\n\t\t\t printf(\"%d\\n\",MAX.top().point-MIN.top().point+1);\n\t\t }else{\n\t\t\t maximum = MAX.top().point;\n\t\t\t MAX.pop();\n\t\t\t minimum = MIN.top().point;\n\t\t\t MIN.pop();\n\t\t\t printf(\"%d\\n\",max(maximum-MIN.top().point,MAX.top().point-minimum)+1);\n\t\t }\n\t }\n\n\t return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n\nint main() {\n  ll N, M;\n  while (cin >> N >> M, N) {\n    auto S = vector<ll>(M);\n    auto k = vector<ll>(M);\n    auto c = vector<vector<ll>>(M, vector<ll>(M));\n    auto sum = vector<ll>(N, 0);\n    auto q = vector<vector<ll>>(N);\n    for (int i = 0; i < M; ++i) {\n      cin >> S[i] >> k[i];\n      for (int j = 0; j < k[i]; ++j) {\n        cin >> c[i][j]; --c[i][j];\n        sum[c[i][j]] += S[i];\n        q[c[i][j]].push_back(i);\n      }\n    }\n    auto maxIt = max_element(begin(sum), end(sum));\n    int idx = distance(begin(sum), maxIt);\n    for (auto&& x : q[idx]) S[x] = 0;\n\n    sum = vector<ll>(N, 0);\n    for (int i = 0; i < M; ++i) {\n      for (int j = 0; j < k[i]; ++j) {\n        sum[c[i][j]] += S[i];\n      }\n    }\n    sum[idx] = 1e9;\n    auto minIt = min_element(begin(sum), end(sum));\n    cout << *maxIt - *minIt + 1 << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> P;\ntypedef pair<int, P> P3;\nconst ll MOD = 1000000007;\nconst int IINF = INT_MAX;\nconst ll LLINF = LLONG_MAX;\nconst int MAX_N = int(1e4 + 5);\nconst double EPS = 1e-11;\nconst int di[] = {0, 1, 0, -1}, dj[] = {1, 0, -1, 0};\n#define REP(i, n) for (int i = 0; i < n; i++)\n#define REPR(i, n) for (int i = n; i >= 0; i--)\n#define SORT(v) sort((v).begin(), (v).end())\n#define ALL(v) (v).begin(), (v).end()\n\nint main() {\n    int n, m;\n    P smax[MAX_N], smin[MAX_N];\n    while(cin >> n >> m, n){\n        REP(i,n){\n            smax[i] = {0,i};\n            smin[i] = {0,i};\n        }\n        REP(i,m){\n            int s, k;\n            cin >> s >> k;\n            REP(j,k){\n                int c;\n                cin >> c;\n                c--;\n                smax[c].first += s;\n                if(k==1)smin[c].first += s;\n            }\n        }\n        sort(smin,smin+n);\n        sort(smax,smax+n);\n        reverse(smax,smax+n);\n        if(smax[0].second!=smin[0].second){\n            cout << smax[0].first-smin[0].first+1 << endl;\n        }\n        else{\n            cout << max(smax[0].first-smin[1].first, smax[1].first-smin[0].first)+1 << endl;\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n#include <queue>\n#include <vector>\ntypedef long long int ll;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\nusing namespace std;\n\nstruct Info_max{\n\tInfo_max(int arg_point,int arg_id){\n\t\tpoint = arg_point;\n\t\tid = arg_id;\n\t}\n\tbool operator<(const struct Info_max &arg) const{\n\t\t\treturn point < arg.point;\n\t};\n\tint point,id;\n};\n\nstruct Info_min{\n\tInfo_min(int arg_point,int arg_id){\n\t\tpoint = arg_point;\n\t\tid = arg_id;\n\t}\n\tbool operator<(const struct Info_min &arg) const{\n\t\t\treturn point > arg.point;\n\t};\n\tint point,id;\n};\n\n int main(){\n\n\t int N,M,max_points[10001],point,num,tmp,forced_points[10001],maximum,minimum;\n\n\t while(true){\n\t\t scanf(\"%d %d\",&N,&M);\n\t\t if(N == 0 && M == 0)break;\n\n\t\t for(int i = 1; i <= N; i++){\n\t\t\t max_points[i] = 0;\n\t\t\t forced_points[i] = 0;\n\t\t }\n\n\t\t for(int loop = 0; loop < M; loop++){\n\t\t\t scanf(\"%d %d\",&point,&num);\n\t\t\t if(num == 1){\n\t\t\t\t scanf(\"%d\",&tmp);\n\t\t\t\t forced_points[tmp] += point;\n\t\t\t\t max_points[tmp] += point;\n\t\t\t }else{ //num > 1\n\t\t\t\t for(int i = 0; i < num; i++){\n\t\t\t\t\t scanf(\"%d\",&tmp);\n\t\t\t\t\t max_points[tmp] += point;\n\t\t\t\t }\n\t\t\t }\n\t\t }\n\n\t\t priority_queue<Info_max> MAX;\n\t\t priority_queue<Info_min> MIN;\n\n\t\t for(int i = 1; i <= N; i++){\n\t\t\t MAX.push(Info_max(max_points[i],i));\n\t\t\t MIN.push(Info_min(forced_points[i],i));\n\t\t }\n\n\t\t if(MAX.top().id != MIN.top().id){\n\t\t\t printf(\"%d\\n\",MAX.top().point-MIN.top().point+1);\n\t\t }else{\n\t\t\t maximum = MAX.top().point;\n\t\t\t MAX.pop();\n\t\t\t minimum = MIN.top().point;\n\t\t\t MIN.pop();\n\t\t\t printf(\"%d\\n\",max(maximum-MIN.top().point,MAX.top().point-minimum)+1);\n\t\t }\n\t }\n\n\t return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\nusing namespace std;\n\nint main() {\n    int n, m;\n    while (cin >> n >> m, n + m) {\n        vector<int> pmax(n, 0), pmin(n, 0);\n        for (int i = 0; i < m; i++) {\n            int s, k, c; cin >> s >> k;\n            for (int j = 0; j < k; j++) {\n                cin >> c; c--;\n                pmax[c] += s;\n            }\n            if (k == 1) pmin[c] += s;\n        }\n        int ans = 0;\n        for (int i = 0; i < n; i++) {\n            for (int j = 0; j < n; j++) {\n                if (i == j) continue;\n                ans = max(ans, pmax[i] - pmin[j]);\n            }\n        }\n        cout << ans + 1 << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing p = pair<long long, long long>;\nlong long n, m;\nvector<p> memo[2];\n\nint main() {\n  while(1) {\n    cin >> n >> m;\n    if(n + m == 0) break;\n    memo[0].assign(n, {0, 0});\n    memo[1].assign(n, {0, 0});\n    for(int i = 0; i < n; ++i)\n      for(int j = 0; j < 2; ++j) memo[j][i].second = i;\n    for(int i = 0; i < m; ++i) {\n      long long s, k;\n      cin >> s >> k;\n      for(int j = 0; j < k; ++j) {\n        long long c;\n        cin >> c;\n        --c;\n        memo[0][c].first += s;\n        if(k == 1) memo[1][c].first += s;\n      }\n    }\n    sort(memo[0].begin(), memo[0].end(), greater<p>());\n    sort(memo[1].begin(), memo[1].end());\n    if(memo[0][0].second != memo[1][0].second)\n      cout << memo[0][0].first - memo[1][0].first + 1\n           << endl;\n    else\n      cout << max(memo[0][1].first - memo[1][0].first,\n                  memo[0][0].first - memo[1][1].first) +\n                  1\n           << endl;\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define min(a,b) ((a)<(b)?(a):(b))\n#define max(a,b) ((a)>(b)?(a):(b))\n#define REP(i,n) for(int i=0;i<n;i++)\n#define FOR(i,n1,n2) for(int i=n1;i<n2;i++)\n#define bFOR(i,n1,n2) for(int i=n1;i>=n2;i--)\n#define speed_up    ios_base::sync_with_stdio(false); cin.tie(0); cout.tie(0);\n\ntypedef long long int ll;\ntypedef pair<ll,ll> Pi;\nconst int INF=(ll)(1LL<<30)-1;\nconst double INFd=100000000000.0;\nconst ll INFl=(ll)9223372036854775807;\nconst int MAX=10000;\nconst ll MOD=(ll)1e9+7;\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a, b)*b;}\nint dx[4]={0,-1,0,1},dy[4]={-1,0,1,0};\nint mdx[4]={0,1,0,-1},mdy[4]={-1,0,1,0};\n\n\ntemplate<typename A, size_t N, typename T>\nvoid Fill(A (&array)[N], const T &val){\n    std::fill( (T*)array, (T*)(array+N), val );\n}\n\nint n,m;\nint s[1010];\nint k[1010];\nint c[1010][10010];\nvector<int> anst;\nint max_point[10010];\nint min_point[10010];\n\nint main(){\n\twhile(1){\n\t\tcin>>n>>m;\n\t\tif(n==0&&m==0)break;\n\t\tREP(i,10010){\n\t\t\tmax_point[i]=0;\n\t\t\tmin_point[i]=0;\n\t\t}\n\t\tfor(int i=0;i<m;i++){\n\t\t\tcin>>s[i];\n\t\t\tcin>>k[i];\n\t\t\tfor(int j=0;j<k[i];j++){\n\t\t\t\tcin>>c[i][j];\n\t\t\t\tmax_point[c[i][j]]+=s[i];\n\t\t\t}\n\t\t\tif(k[i]==1)min_point[c[i][0]]+=s[i];\n\t\t}\n\t\tint amax=1,amin=1;\n\t\tint amax2=2,amin2=2;\n\t\tif(max_point[amax]<max_point[amax2]){\n\t\t\tamax=2;\n\t\t\tamax2=1;\n\t\t}\n\t\tif(min_point[amin]>min_point[amin2]){\n\t\t\tamin=2;\n\t\t\tamin2=1;\n\t\t}\n\t\tfor(int i=3;i<=n;i++){\n\t\t\tif(max_point[amax]<max_point[i]){\n\t\t\t\tamax2=amax;\n\t\t\t\tamax=i;\n\t\t\t}else if(max_point[amax2]<max_point[i]){\n\t\t\t\tamax2=i;\n\t\t\t}\n\t\t\tif(min_point[amin]>min_point[i]){\n\t\t\t\tamin2=amin;\n\t\t\t\tamin=i;\n\t\t\t}else if(min_point[amin2]>min_point[i]){\n\t\t\t\tamin2=i;\n\t\t\t}\n\t\t}\n\t\tint ans;\n\t\tif(amax!=amin){\n\t\t\tans=max_point[amax]-min_point[amin];\n\t\t}else{\n\t\t\tans=max(max_point[amax2]-min_point[amin],max_point[amax]-min_point[amin2]);\n\t\t}\t\n\t\tcout<<ans+1<<endl;\t\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//JAG2017C クイズ　8/23 13:33~\n\n#include <iostream>\n#include <algorithm>\n#include <vector>\n\nusing namespace std;\n\nint main(void){\n\twhile(1){\n\t\tint n, m; cin >> n >> m;\n\t\tif(!n && !m) break;\n\n\t\tvector<int> sum(n, 0);\n\t\tvector<int> only(n, 0);\n\t\tfor(int i=0; i<m; i++){\n\t\t\tint s, k;\n\t\t\tcin >> s >> k;\n\t\t\tfor(int j=0; j<k; j++){\n\t\t\t\tint c; cin >> c;\n\t\t\t\tc--;\n\t\t\t\tsum[c] += s;\n\t\t\t\tif(k == 1){\n\t\t\t\t\tonly[c] += s;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tint smin = 1000*1000;\n\t\tint smax = -1;\n\t\tint top_idx = -1;\n\t\tfor(int i=0; i<n; i++){\n\t\t\tif(smax < sum[i]){\n\t\t\t\tsmax = sum[i];\n\t\t\t\ttop_idx = i;\n\t\t\t} else if (smax == sum[i]){\n\t\t\t\tif(only[i] > only[top_idx]){\n\t\t\t\t\ttop_idx = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0; i<n; i++){\n\t\t\tif(i == top_idx) continue;\n\t\t\tsmin = min(smin, only[i]);\n\t\t}\n\n\t\tint ans = smax - smin + 1;\n\t\tcout << ans << endl;\n\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "// I SELL YOU...! \n#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<functional>\n#include<queue>\n#include<chrono>\n#include<iomanip>\n#include<map>\n#include<set>\nusing namespace std;\nusing ll = long long;\nusing P = pair<ll,ll>;\nvoid init_io(){\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n  cout << setprecision(10);\n}\nvoid solve(){\n  ll n,m,k,tmp,max_v=0,max_i=0,sum=0,min_v=1000000000000;\n  cin >> n >>m;\n  if(n==0&&m==0) return;\n  set<ll> st[m];\n  vector<ll> s(m),min_t(n);\n  for(int i=0;i<m;i++){\n    cin >> s[i] >> k;\n    for(int j=0;j<k;j++){\n      cin >> tmp;\n      tmp--;\n      st[i].insert(tmp);\n    }\n    if(k==1){\n      min_t[*st[i].begin()] += s[i];\n    }\n  }\n  for(ll i=0;i<n;i++){\n    tmp = 0;\n    for(ll j=0;j<m;j++){\n      if(st[j].find(i)!=st[j].end()){\n        tmp += s[j];\n      }\n    }\n    if(tmp>max_v){\n      max_v = tmp; \n      max_i = i;\n    }\n  }\n  for(int i=0;i<n;i++){\n    if(i==max_i) continue;\n    min_v = min(min_v,min_t[i]);\n  }\n  cout << max_v-min_v+1<<endl;\n  solve();\n}\nsigned main(){\n  init_io();\n  solve();\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\nint main(){\n\tint N,M;\n\tcin>>N>>M;\n\twhile(N){\n\t\tint ans=0;\n\t\tvector<int>v(N+1);\n\t\tvector<int>w(N+1);\n\t\tfor(int i=0;i<M;i++){\n\t\t\tint a,b,c;\n\t\t\tcin>>a>>b;\n\t\t\tfor(int j=0;j<b;j++){\n\t\t\t\tcin>>c;\n\t\t\t\tv[c]+=a;\n\t\t\t\tif(b==1)w[c]+=a;\n\t\t\t}\n\t\t}\n\t\tpair<int,int>vf,vs,wf,ws;\n\t\tvf={0,0};\n\t\tvs={0,0};\n\t\twf={INT_MAX,0};\n\t\tws={INT_MAX,0};\n\t\tfor(int j=1;j<=N;j++){\n\t\t\tpair<int,int>p={v[j],j};\n\t\t\tif(vf<p){\n\t\t\t\tvs=vf;\n\t\t\t\tvf=p;\n\t\t\t}\n\t\t\telse if(vs<p){\n\t\t\t\tvs=p;\n\t\t\t}\n\t\t\tp={w[j],j};\n\t\t\tif(wf>p){\n\t\t\t\tws=wf;\n\t\t\t\twf=p;\n\t\t\t}\n\t\t\telse if(ws>p){\n\t\t\t\tws=p;\n\t\t\t}\n\t\t}\n\t\tif(vf.second==wf.second){\n\t\t\tans=max(vf.first-ws.first,vs.first-wf.first)+1;\n\t\t}\n\t\telse{\n\t\t\tans=vf.first-wf.first+1;\n\t\t}\n\t\tcout<<ans<<endl;\n\t\tcin>>N>>M;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\n#define rep(i, n) for (int i = 0; i < (int)(n); i++)\n#define reps(i, s, n) for (int i = (int)(s); i < (int)(n); i++)\nconst ll mod = ll(1e9) + 7;\nconst int INF = int(1e9);\nint vector_finder(std::vector<int> vec, int number)\n{\n    auto itr = std::find(vec.begin(), vec.end(), number);\n    size_t index = std::distance(vec.begin(), itr);\n    if (index != vec.size())\n    { // 発見できたとき\n        return 1;\n    }\n    else\n    { // 発見できなかったとき\n        return 0;\n    }\n}\nint main()\n{\n    vector<int> res;\n    while (1)\n    {\n        int N, M;\n        cin >> N >> M;\n        if (N == 0 && M == 0)\n            break;\n        vector<int> score(N);\n        vector<int> S(M);\n        vector<vector<int>> C(M);\n        rep(i, M)\n        {\n            cin >> S[i];\n            int k;\n            cin >> k;\n            rep(j, k)\n            {\n                int c;\n                cin >> c;\n                c--;\n                C[i].push_back(c);\n                score[c] += S[i];\n            }\n        }\n        int ans_max = 0;\n        int highest = 0;\n        rep(i, N)\n        {\n            if (ans_max < score[i])\n            {\n                ans_max = score[i];\n                highest = i;\n            }\n        }\n        rep(i, N) score[i] = 0;\n        rep(i, M)\n        {\n            if (vector_finder(C[i], highest))\n                continue;\n            if (C[i].size() == 1)\n            {\n                score[C[i][0]] += S[i];\n            }\n        }\n        int ans_min = INF;\n        int lowest = 0;\n        rep(i, N)\n        {\n            if (ans_min > score[i] && i != highest)\n            {\n                ans_min = score[i];\n                lowest = i;\n            }\n        }\n        res.push_back(ans_max - ans_min + 1);\n    }\n    rep(i, res.size()) cout << res[i] << endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <algorithm>\n\nint testcase_ends() {\n  size_t N, M;\n  scanf(\"%zu %zu\", &N, &M);\n  if (N == 0 && M == 0) return 1;\n\n  std::vector<int> min(N), max(N);\n  for (size_t i = 0; i < M; ++i) {\n    int S;\n    size_t k;\n    scanf(\"%d %zu\", &S, &k);\n    std::vector<size_t> c(k);\n    for (size_t j = 0; j < k; ++j) {\n      scanf(\"%zu\", &c[j]);\n      --c[j];\n    }\n\n    if (k == 1) {\n      min[c[0]] += S;\n      max[c[0]] += S;\n      continue;\n    }\n    for (size_t j = 0; j < k; ++j) {\n      max[c[j]] += S;\n    }\n  }\n\n  std::vector<int> max_left(N+1), max_right(N+1);\n\n  for (size_t i = 0; i < N; ++i) {\n    max_left[i+1] = std::max(max_left[i], max[i]);\n  }\n  for (size_t i = N; i--;) {\n    max_right[i] = std::max(max_right[i+1], max[i]);\n  }\n\n  int res = 0;\n  for (size_t i = 0; i < N; ++i) {\n    int max0 = std::max(max_left[i], max_right[i+1]);\n    res = std::max(res, max0-min[i]+1);\n  }\n  printf(\"%d\\n\", res);\n  return 0;\n}\n\nint main() {\n  while (!testcase_ends()) {}\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n#include <queue>\n#include <vector>\ntypedef long long int ll;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\nusing namespace std;\n\nstruct Info_max{\n\tInfo_max(int arg_point,int arg_id){\n\t\tpoint = arg_point;\n\t\tid = arg_id;\n\t}\n\tbool operator<(const struct Info_max &arg) const{\n\t\t\treturn point < arg.point;\n\t};\n\tint point,id;\n};\n\nstruct Info_min{\n\tInfo_min(int arg_point,int arg_id){\n\t\tpoint = arg_point;\n\t\tid = arg_id;\n\t}\n\tbool operator<(const struct Info_min &arg) const{\n\t\t\treturn point > arg.point;\n\t};\n\tint point,id;\n};\n\n int main(){\n\n\t int N,M,max_points[10001],point,num,tmp,forced_points[10001],maximum,minimum;\n\t /*priority_queue<Info_max> MAX;\n\t priority_queue<Info_min> MIN;*/\n\t while(true){\n\t\t scanf(\"%d %d\",&N,&M);\n\t\t if(N == 0 && M == 0)break;\n\n\t\t for(int i = 1; i <= N; i++){\n\t\t\t max_points[i] = 0;\n\t\t\t forced_points[i] = 0;\n\t\t }\n\n\t\t for(int loop = 0; loop < M; loop++){\n\t\t\t scanf(\"%d %d\",&point,&num);\n\t\t\t if(num == 1){\n\t\t\t\t scanf(\"%d\",&tmp);\n\t\t\t\t forced_points[tmp] += point;\n\t\t\t\t max_points[tmp] += point;\n\t\t\t }else{ //num > 1\n\t\t\t\t for(int i = 0; i < num; i++){\n\t\t\t\t\t scanf(\"%d\",&tmp);\n\t\t\t\t\t max_points[tmp] += point;\n\t\t\t\t }\n\t\t\t }\n\t\t }\n\n\t\t /*while(!MAX.empty())MAX.pop();\n\t\t while(!MIN.empty())MIN.pop();*/\n\n\t\t priority_queue<Info_max> MAX;\n\t\t priority_queue<Info_min> MIN;\n\n\t\t for(int i = 1; i <= N; i++){\n\t\t\t MAX.push(Info_max(max_points[i],i));\n\t\t\t MIN.push(Info_min(forced_points[i],i));\n\t\t }\n\n\t\t if(MAX.top().id != MIN.top().id){\n\t\t\t printf(\"%d\\n\",MAX.top().point-MIN.top().point+1);\n\t\t }else{\n\t\t\t maximum = MAX.top().point;\n\t\t\t MAX.pop();\n\t\t\t minimum = MIN.top().point;\n\t\t\t MIN.pop();\n\t\t\t printf(\"%d\\n\",max(maximum-MIN.top().point,MAX.top().point-minimum)+1);\n\t\t }\n\t }\n\n\t return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <map>\n#include <queue>\n#include <cstdio>\n#include <ctime>\n#include <assert.h>\n#include <chrono>\n#include <random>\n#include <numeric>\n#include <set>\n#include <deque>\n#include <stack>\n#include <bitset>\nusing namespace std;\ntypedef long long int ll;\ntypedef unsigned long long ull;\n\nmt19937_64 rng(chrono::steady_clock::now().time_since_epoch().count());\nll myRand(ll B) {\n\treturn (ull)rng() % B;\n}\n\nint main(){\n    cin.tie(nullptr);\n    ios::sync_with_stdio(false);\n    int n,m;\n    while(cin >> n >> m,n){\n        vector<ll> sum(n,0);\n        vector<ll> mi(n,0);\n        for(int i=0;i<m;i++){\n            ll s; cin >> s;\n            int k; cin >> k;\n            if(k==1){\n                k--;\n                int x; cin >> x;\n                x--;\n                mi[x]+=s;\n                sum[x]+=s;\n            }\n            while(k--){\n                int x; cin >> x;\n                x--;\n                sum[x]+=s;\n            }\n        }\n        ll res=0;\n        multiset<ll> ss;\n        for(int i=0;i<n;i++){\n            ss.insert(mi[i]);\n        }\n        for(int i=0;i<n;i++){\n            ss.erase(ss.find(mi[i]));\n            res=max(res,sum[i]-*ss.begin());\n            ss.insert(mi[i]);\n        }\n        printf(\"%lld\\n\",res+1);\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define INF 10000000\nusing namespace std;\nint main()\n{\n  int n, m;\n  while(cin >> n >> m, n | m) {\n    vector<int> A(n + 1, 0);\n    vector<int> B(n + 1, 0);\n    int x, k, p;\n    for(int i = 0; i < m; i++) {\n      cin >> x >> k;\n      for(int j = 0; j < k; j++) {\n\tcin >> p;\n\tp--;\n\tif(k == 1) A[p] += x;\n\tB[p] += x;\n      }\n    }\n    int max_p = -1;\n    int min_p = INF;\n    for(int i = 0; i < n; i++) {\n      if(B[i] > max_p && A[i] < min_p && min_p != INF){\n\tmax_p = max(max_p, B[i]);\n\tcontinue;\n      }\n      max_p = max(max_p, B[i]);\n      min_p = min(min_p, A[i]);\n    }\n    int ans = max_p - min_p + 1;\n    cout << ans << endl;\n  }\n  return 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<n;++i)\n#define rep1(i,n) for(int i=1;i<=n;++i)\n#define all(a) a.begin(),a.end()\n\nint main(void){\n    int N,M;\n    while(cin>>N>>M,N|M){\n        vector<pair<int,int>> a(N+1),b(N+1); //max,min\n        rep1(i,N) a[i].second=b[i].second=i;\n        rep(i,M){\n            int s,k,c;\n            cin>>s>>k;\n            rep(j,k){\n                cin>>c;\n                if(k==1) b[c].first += s;\n                a[c].first += s;\n            }\n        }\n        sort(all(a));\n        sort(all(b));\n        if(a[N].second == b[1].second){\n            cout<<max(a[N].first-b[2].first,a[N-1].first-b[1].first)+1<<endl;\n        }else{\n            cout<<a[N].first-b[1].first+1<<endl;\n        }\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint N, M;\nint sum[10010], dis[10010];\n\nint main()\n{\n    while(cin >> N >> M, N)\n    {\n        for(int i = 0; i < N; i++)sum[i] = dis[i] = 0;\n        for(int i = 0; i < M; i++)\n        {\n            int s,k;\n            cin >> s >> k;\n            for(int j = 0; j < k; j++)\n            {\n                int c;\n                cin >> c;\n                c--;\n                sum[c] += s;\n                if(k == 1)dis[c] += s;\n            }\n        }\n\n        int MAX = 0;\n        int MAX_index = 0;\n        for(int i = 0; i < N; i++)\n        {\n            if(MAX < sum[i])\n            {\n                MAX = sum[i];\n                MAX_index = i;\n            }\n        }\n        sum[MAX_index] = -1;\n\n        int second_MAX = 0;\n        for(int i = 0; i < N; i++)\n        {\n            second_MAX = max(second_MAX, sum[i]);\n        }\n\n        int ans = 0;\n        for(int i = 0; i < N; i++)\n        {\n            ans = max(ans, ((i == MAX_index) ? second_MAX : MAX) - dis[i]);\n        }\n\n        cout << ans + 1 << endl;\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\n#define pu push\n#define pb push_back\n#define mp make_pair\n#define eps 1e-7\n#define INF 1000000000\n#define sz(x) ((int)(x).size())\n#define sq(x) ((x)*(x))\n#define fi first\n#define sec second\n#define SORT(x) sort((x).begin(),(x).end())\n#define all(x) (x).begin(),(x).end()\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);(i)++)\n#define repn(i,a,n) for(int (i)=(a);(i)<(int)(n);(i)++)\n#define EQ(a,b) (abs((a)-(b))<eps)\nint N,M;\nint S[1010],k[1010];\nvector<int> c[1010];\nint mx[10010];\nint mi[10010];\nint solve(){\n\tcin >> N >> M;\n\tif(N+M==0)return 1;\n\tmemset(mx,0,sizeof(mx));\n\tmemset(mi,0,sizeof(mi));\n\tfor(int i=0;i<1010;i++)c[i].clear();\n\tfor(int i=0;i<M;i++){\n\t\tcin >> S[i] >> k[i];\n\t\tc[i].resize(k[i]);\n\t\tfor(int j=0;j<k[i];j++){\n\t\t\tcin >> c[i][j];\n\t\t\tc[i][j]--;\n\t\t\tmx[c[i][j]]+=S[i];\n\t\t\tif(k[i]==1)mi[c[i][j]]+=S[i];\n\t\t}\n\t}\n\t/*for(int i=0;i<N;i++){\n\t\tprintf(\"%d: mi %d, mx %d\\n\",i,mi[i],mx[i]);\n\t}*/\n\tmultiset<int> ms;\n\tfor(int i=0;i<N;i++)ms.insert(mx[i]);\n\tint ans = 0;\n\tfor(int i=0;i<N;i++){\n\t\tmultiset<int>::iterator it = ms.find(mx[i]);\n\t\tassert(it!=ms.end());\n\t\tms.erase(it);\n\t\tans = max(ans,(*ms.rbegin())-mi[i]);\n\t\tms.insert(mx[i]);\n\t}\n\tcout << ans+1 << endl;\n\treturn 0;\n}\nint main(){\n\twhile(!solve()){}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define rep(i,n) REP(i,0,n)\n#define REP(i,s,e) for(int i=(s); i<(int)(e); i++)\n#define repr(i, n) REPR(i, n, 0)\n#define REPR(i, s, e) for(int i=(int)(s-1); i>=(int)(e); i--)\n#define pb push_back\n#define all(r) r.begin(),r.end()\n#define rall(r) r.rbegin(),r.rend()\n#define fi first\n#define se second\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int INF = 1e9;\nconst ll MOD = 1e9 + 7;\ndouble EPS = 1e-8;\n\n// #define DEBUG_MODE\n#ifdef DEBUG_MODE\n#define dump(x) cout << #x << \" : \" << x << endl\n#define LINE cout << \"line : \" << __LINE__ << endl\n#define dumpV(v) cout << #v << \" : [\"; for(auto& t : v) cout << t << \", \"; cout<<\"]\" << endl\n#define STOP assert(false)\n#else\n#define dump(x) ;\n#define LINE \t;\n#define dumpV(v);\n#define STOP \t;\n#endif\n#define mp make_pair\n\nnamespace std {\ntemplate<class S, class T>\nostream &operator <<(ostream& out, const pair<S, T>& a) {\n\tout << '(' << a.fi << \", \" << a.se << ')';\n\treturn out;\n}\n}\n\n\nint main() {\n\tint n, m;\n\twhile (cin >> n >> m) {\n\t\tif (n == 0 && m == 0) break;\n\t\tvi s(m), v(n), u(n);\n\t\trep(i, m) {\n\t\t\tint k, a;\n\t\t\tcin >> s[i] >> k;\n\t\t\trep(j, k) {\n\t\t\t\tcin >> a;\n\t\t\t\tv[a - 1] += s[i];\n\t\t\t\tif (k == 1) u[a - 1] += s[i];\n\t\t\t}\n\t\t}\n\t\tvi idxV(n), idxU(n);\n\t\trep(i, n) idxV[i] = idxU[i] = i;\n\t\tsort(all(idxV), [&](int a, int b) {return v[a] < v[b];});\n\t\tsort(all(idxU), [&](int a, int b) {return u[a] < u[b];});\n\t\tint ans = 0;\n\t\tif (idxV[n - 1] != idxU[0]) ans = max(ans, v[idxV[n - 1]] - u[idxU[0]]);\n\t\telse ans = max(ans, v[idxV[n - 1]] - u[idxU[1]]);\n\t\tif (idxV[n - 2] != idxU[0]) ans = max(ans, v[idxV[n - 2]] - u[idxU[0]]);\n\t\telse ans = max(ans, v[idxV[n - 2]] - u[idxU[1]]);\n\t\tcout << ans+1 << endl;\n\t\tdumpV(v);\n\t\tdumpV(u);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\n\ntypedef long long LL;\n\nint main(){\n  int n,m;\n  while(1){\n    cin >> n >> m;\n    if(n==0) return 0;\n    vector<int> ma(n,0),mi(n,0);\n    int s,k;\n    int c;\n    for(int i=0;i<m;i++){\n      cin >> s >> k;\n      if(k==1){\n        cin >> c;\n        c--;\n        mi[c]+=s;\n      }else{\n        for(int j=0;j<k;j++){\n          cin >> c;\n          c--;\n          ma[c]+=s;\n        }\n      }\n    }\n    int firstma=0,secondma=0,firstmi=100000,secondmi=10000;\n    int firstmai=-1,secondmai=-1,firstmii=-1,secondmii=-1;\n    for(int i=0;i<n;i++){\n      if(ma[i]+mi[i]>=firstma){\n        secondma=firstma;\n        secondmai=firstmai;\n        firstma=ma[i]+mi[i];\n        firstmai=i;\n      }else if(ma[i]+mi[i]>=secondma){\n        secondma=ma[i]+mi[i];\n        secondmai=i;\n      }\n    }\n    for(int i=0;i<n;i++){\n      if(mi[i]<=firstmi){\n        secondmi=firstmi;\n        secondmii=firstmii;a\n        firstmi=mi[i];\n        firstmii=i;\n      }else if(mi[i]<=secondmi){\n        secondmi=mi[i];\n        secondmii=i;\n      }\n    }\n    if(firstmai!=firstmii){\n      cout << firstma-firstmi+1 << endl;\n    }else{\n      cout << max(firstma-secondmi,secondma-firstmi)+1 << endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n  \n  while (true) {\n    int n, m;\n    cin >> n >> m;\n    if (n + m == 0) return 0;\n    \n    vector<int> maximum(n), minimum(n);\n    for (int i = 0; i < m; i++) {\n      int s, k;\n      cin >> s >> k;\n      for (int j = 0; j < k; j++) {\n        int c;\n        cin >> c;\n        c--;\n        if (k == 1) minimum[c] += s;\n        maximum[c] += s;\n      }\n    }\n    \n    vector<int> minl(n, 1e9), minr(n, 1e9);\n    for (int i = 1; i < n; i++) minl[i] = min(minl[i - 1], minimum[i - 1]);\n    for (int i = n - 2; i >= 0; i--) minr[i] = min(minr[i + 1], minimum[i + 1]);\n    \n    int diff = 0;\n    for (int i = 0; i < n; i++) diff = max(diff, maximum[i] - min(minl[i], minr[i]));\n    \n    cout << diff + 1 << '\\n';\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <numeric>\n#include <bitset>\n#include <cmath>\n\nstatic const int MOD = 1000000007;\nusing ll = long long;\nusing u32 = uint32_t;\nusing namespace std;\n\ntemplate<class T> constexpr T INF = ::numeric_limits<T>::max()/32*15+208;\n\nint main() {\n    int n, m;\n    while(cin >> n >> m, n){\n        vector<int> v(n), u(n);\n        for (int i = 0; i < m; ++i) {\n            int s, k;\n            scanf(\"%d %d\", &s, &k);\n            if(k == 1){\n                int x;\n                scanf(\"%d\", &x);\n                v[x-1] += s;\n            }else {\n                for (int j = 0; j < k; ++j) {\n                    int x;\n                    scanf(\"%d\", &x);\n                    u[x-1] += s;\n                }\n            }\n        }\n        vector<int> vv(v);\n        sort(vv.begin(),vv.end());\n        int ans = 0;\n        for (int i = 0; i < n; ++i) {\n            ans = max(ans, v[i]+u[i]-(vv[0] == v[i] ? vv[1] : vv[0])+1);\n        }\n        cout << ans << \"\\n\";\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\ntemplate<typename T,T e = 0>\nstruct SegmentTree{\n    int length;\n    vector<T> data;\n    vector<int> l,r;\n\n    inline T merge(const T& a,const T& b){\n        return max(a,b);\n    }\n\n    T query(int i,int j){\n        T ans = e;\n        queue<int> que;\n        que.push(0);\n        int k;\n        while(que.size()){\n            k = que.front();\n            que.pop();\n            if(r[k] <= i || j <= l[k]){\n                continue;\n            }\n            if(i <= l[k] && r[k] <= j){\n                ans = merge(ans,data[k]);\n                continue;\n            }\n            que.push(2*k+1);\n            que.push(2*k+2);\n        }\n        return ans;\n    }\n\n    SegmentTree(vector<T> v) : length(1) {\n        while(!(length >= v.size()))length *= 2;\n        data = vector<T>(length*2-1,e);\n        for(int i = length-1;i < length-1+v.size();i++){\n            data[i] = v[i-length+1];\n        }\n        for(int i = length-2;0 <= i;i--){\n            data[i] = merge(data[i*2+1],data[i*2+2]);\n        }\n        l.resize(length*2-1);\n        r.resize(length*2-1);\n        for(int i = length-1;i < length*2-1;i++){\n            l[i] = i - length + 1;\n            r[i] = min(i-length+2,(int)v.size());\n        }\n        for(int i = length-2;0 <= i;i--){\n            l[i] = l[i*2+1];\n            r[i] = r[i*2+2];\n        }\n    };\n\n};\n\nint solve(int N,int M){\n    vector<int> upper(N,0),lower(N,0);\n    for(int i = 0;i < M;i++){\n        int S,k;\n        cin >> S >> k;\n        if(k == 1){\n            int c;\n            cin >> c;\n            c--;\n            upper[c] += S;\n            lower[c] += S;\n        }else{\n            for(int j = 0;j < k;j++){\n                int c;\n                cin >> c;\n                c--;\n                upper[c] += S;\n            }\n        }\n    }\n    SegmentTree<int> st(upper);\n    int ans = max(st.query(1,N)-lower[0],st.query(0,N-1)-lower[N-1]);\n    for(int i = 1;i < N-1;i++){\n        int tmp = max(st.query(0,i),st.query(i+1,N)) - lower[i];\n        ans = max(ans,tmp);\n    }\n    return ans + 1;\n}\n\nint main(){\n    int N,M;\n    while(true){\n        cin >> N >> M;\n        if(!N)break;\n        cout << solve(N,M) << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MAX_N 10005\n\nint main(){\n  while(1){\n    int N,M;\n    scanf(\"%d %d\",&N,&M);\n    if(M==0&&N==0)break;\n    vector<int> Min(N,0);\n    vector<int> Max(N,0);\n    for(int i=0;i<M;i++){\n      int p,k,id;\n      scanf(\"%d %d\",&p,&k);\n      for(int j=0;j<k;j++){\n        scanf(\"%d\",&id);\n        id--;\n        if(k==1){\n          Min[id]+=p;\n        }\n        Max[id]+=p;\n      }\n    }\n\n    int mini=1e9,maxm=-1e9,ans=0;\n\n    for(int i=0;i<N;i++){\n\n      if(Max[i]>mini)\n        ans=max(ans, abs(Max[i]-mini) );\n        \n      if(maxm>Min[i])\n        ans=max(ans, abs(maxm-Min[i]) );\n\n      mini=min(mini,Min[i]);\n      maxm=max(maxm,Max[i]);\n    }\n    cout<<ans+1<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll,ll> pll;\n\n\nint main(){\n  ll n,m;\n  while(cin>>n>>m && n){\n  vector<pll> dp(n);\n  vector<pll> mi(n);\n  for(int i=0;i<n;i++){\n    dp[i]=mi[i]={0,i};\n  }\n  for(int i=0;i<m;i++){\n    ll s,k;\n    cin>>s>>k;\n    for(int t=0;t<k;t++){\n      ll p;\n      cin>>p;\n      p--;\n      if(k==1){mi[p].first+=s;}\n      dp[p].first+=s;\n    }\n  }\n  sort(dp.begin(),dp.end(),greater<pll>());\n  sort(mi.begin(),mi.end());\n  if(n==1){cout<<0<<endl;}\n  else{\n    ll mx=0;\n    if(dp[0].second!=mi[0].second){mx=dp[0].first-mi[0].first;}\n    else{\n      mx=max(dp[0].first-mi[1].first,dp[1].first-mi[0].first);\n    }\n    cout<<mx+1<<endl;\n  }\n\n  }\n\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<n;++i)\n#define all(a) a.begin(),a.end()\n\nint main(void){\n    int N,M;\n    while(cin>>N>>M,N|M){\n        vector<pair<int,int>> a(N+1),b(N+1); //max,min\n        rep(i,M){\n            int s,k,c;\n            cin>>s>>k;\n            rep(j,k){\n                cin>>c;\n                if(k==1) b[c]={s+b[c].first,j};\n                a[c]={s+a[c].first,j};\n            }\n        }\n        sort(all(a));\n        sort(all(b));\n        if(a[N].second == b[1].second){\n            cout<<max(a[N].first-b[2].first,a[N-1].first-b[1].first)+1<<endl;\n        }else{\n            cout<<a[N].first-b[1].first<<endl;\n        }\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define  _CRT_SECURE_NO_WARNINGS\n#pragma comment (linker, \"/STACK:526000000\")\n\n#include \"bits/stdc++.h\"\n\nusing namespace std;\ntypedef string::const_iterator State;\n#define eps 1e-11L\n#define MAX_MOD 1000000007LL\n#define GYAKU 500000004LL\n\n#define MOD 998244353LL\n#define seg_size 262144*2LL\n#define pb push_back\n#define mp make_pair\ntypedef long long ll;\n#define REP(a,b) for(long long (a) = 0;(a) < (b);++(a))\n#define ALL(x) (x).begin(),(x).end()\n\nunsigned long xor128() {\n\tstatic unsigned long x = 123456789, y = 362436069, z = 521288629, w = time(NULL);\n\tunsigned long t = (x ^ (x << 11));\n\tx = y; y = z; z = w;\n\treturn (w = (w ^ (w >> 19)) ^ (t ^ (t >> 8)));\n}\n\nvoid init() {\n\tiostream::sync_with_stdio(false);\n\tcout << fixed << setprecision(20);\n}\n#define int ll\nvoid solve(){\n\twhile (true) {\n\t\tint n, m;\n\t\tcin >> n >> m;\n\t\tif (n == 0) return;\n\t\tint based[20000] = {};\n\t\tint cnt[20000] = {};\n\t\tREP(i, m) {\n\t\t\tint a, b;\n\t\t\tcin >> a >> b;\n\t\t\tREP(q, b) {\n\t\t\t\tint c;\n\t\t\t\tcin >> c;\n\t\t\t\tc--;\n\t\t\t\tif (b == 1) {\n\t\t\t\t\tbased[c] += a;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tcnt[c] += a;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans = 0;\n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tint now_min = 1e9;\n\t\t\tREP(q, n) {\n\t\t\t\tif (i == q) continue;\n\t\t\t\tnow_min = min(now_min, based[q]);\n\t\t\t\tif (now_min == 0) break;\n\t\t\t}\n\t\t\tans = max(ans, cnt[i] + based[i] - now_min);\n\t\t}\n\t\tcout << ans + 1LL << endl;\n\t}\n}\n\n#undef int\nint main() {\n\tinit();\n\tsolve();\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define chmin(a, b) ((a)=min((a), (b)))\n#define chmax(a, b) ((a)=max((a), (b)))\n#define fs first\n#define sc second\n#define eb emplace_back\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> P;\ntypedef tuple<int, int, int> T;\n\nconst ll MOD=1e9+7;\nconst ll INF=1e18;\n\nint dx[]={1, -1, 0, 0};\nint dy[]={0, 0, 1, -1};\n\nint main(){\n    int n, m;\n    while(cin>>n>>m, n){\n        vector<int> maxs(n+10, 0), mins(n+10, 0);\n        for(int i=0; i<m; i++){\n            int s, k; cin>>s>>k;\n\n            for(int j=0; j<k; j++){\n                int c; cin>>c;\n                c--;\n                \n                if(k==1) mins[c]+=s;\n\n                maxs[c]+=s;\n            }\n        }\n\n        int MIN=1e9, MAX=0;\n        int minid, maxid;\n        for(int i=0; i<n; i++){\n            if(mins[i]<MIN){\n                MIN=min(MIN, mins[i]);\n                minid=i;\n            }\n            if(MAX<maxs[i]){\n                MAX=max(MAX, maxs[i]);\n                maxid=i;\n            }\n        }\n\n        int MIN2=1e9, MAX2=0;\n        for(int i=0; i<n; i++){\n            if(mins[i]<MIN2 && i!=minid){\n                MIN2=min(MIN2, mins[i]);\n            }\n            if(MAX2<maxs[i] && i!=maxid){\n                MAX2=max(MAX2, maxs[i]);\n            }\n        }\n\n        if(minid!=maxid) cout << MAX-MIN+1 << endl;\n        else cout << max(MAX-MIN2+1, MAX2-MIN+1) << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdint>\n#include <vector>\n#include <algorithm>\n\nint testcase_ends() {\n  size_t N, M;\n  scanf(\"%zu %zu\", &N, &M);\n  if (N == 0 && M == 0) return 1;\n\n  std::vector<int> S(M);\n  std::vector<std::vector<size_t>> c(M);\n  std::vector<int> max(N);\n  std::vector<int> forced(N);\n  for (size_t i = 0; i < M; ++i) {\n    size_t k;\n    scanf(\"%d %zu\", &S[i], &k);\n    c[i].resize(k);\n    for (auto& cij: c[i]) {\n      scanf(\"%zu\", &cij);\n      --cij;\n      max[cij] += S[i];\n    }\n    if (k == 1) {\n      forced[c[i][0]] += S[i];\n    }\n  }\n\n  std::vector<int> ml(N+1), mr(N+1);\n  for (size_t i = 0; i < N; ++i)\n    ml[i+1] = std::max(ml[i], max[i]);\n  for (size_t i = N; i--;)\n    mr[i] = std::max(mr[i+1], max[i]);\n\n  int res = 0;\n  for (size_t i = 0; i < N; ++i)\n    res = std::max(res, std::max(ml[i], mr[i+1]) - forced[i]);\n\n  printf(\"%d\\n\", res+1);\n  return 0;\n}\n\nint main() {\n  while (!testcase_ends()) {}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing ull = unsigned long long;\n\nconst long double PI = acos(-1);\nconstexpr long double EPS = 1e-15;\nconstexpr int inf = 2e9;\nconstexpr ll INF = 2e18;\nconstexpr ll MOD = 1e9+7;\nconstexpr ll MOD1 = 998244353;\ntypedef pair<ll,ll> P;\n\n//#define all(v) (v).begin(), (v).end()\n#define rep(i,a,b) for (int i = (a); i < (b); i++)\n#define REP(i,n) rep(i,0,n)\n#define sz(s) (s).size()\n#define pb push_back\n#define fi first\n#define se second\n//#define mp make_pair\n\ntemplate<class T>\nvoid maxi(T &a, const T &b){\n    if(a < b) a = b;\n}\ntemplate<class T>\nvoid mini(T &a, const T &b){\n    if(a > b) a = b;\n}\n\nint n, m;\nint ss[11234], alone[11234];\n\nvoid solve() {\n    int ssa = 0, alonea = 100000000;\n    int count = 0;\n    REP(i, n){\n        maxi(ssa, ss[i]);\n    }\n    REP(i, n){\n        count += ss[i] == ssa;\n    }\n    REP(i, n){\n        if(!(ss[i] == ssa && count == 1)){\n            mini(alonea, alone[i]);\n        }\n    }\n    // REP(i, n) cout << ss[i] << \" \\n\"[i == n - 1];\n    // REP(i, n) cout << alone[i] << \" \\n\"[i == n - 1];\n    cout << ssa - alonea + 1 << endl;\n}\n\nint main(int argc, char *argv[]){\n\n  /*ICPC*/\n  while (cin >> n >> m, n && m) {\n    REP(i, m){\n      int s, k;\n      int c[11234];\n      cin >> s >> k;\n      REP(j, k){\n          cin >> c[j];\n          --c[j];\n      }\n      REP(j, k) ss[c[j]] += s;\n      if(k == 1) alone[c[0]] += s;  \n    }\n    solve();\n    REP(i, m){\n        ss[i] = alone[i] = 0;\n    }\n  }\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nint N, M, A[10009], B[10009];\n\nint main() {\n\twhile (true) {\n\t\tcin >> N >> M; if (N + M == 0) break;\n\t\tfor (int i = 1; i <= N; i++) { A[i] = 0; B[i] = 0; }\n\t\tfor (int i = 1; i <= M; i++) {\n\t\t\tvector<int>vec; int S, P; cin >> S >> P;\n\t\t\tfor (int j = 0; j < P; j++) { int pos; cin >> pos; vec.push_back(pos); }\n\n\t\t\tif (vec.size() == 1) { B[vec[0]] += S; }\n\t\t\tfor (int j = 0; j < vec.size(); j++) A[vec[j]] += S;\n\t\t}\n\n\t\tvector<pair<int, int>>L1, L2;\n\t\tfor (int i = 1; i <= N; i++) L1.push_back(make_pair(A[i], i));\n\t\tfor (int i = 1; i <= N; i++) L2.push_back(make_pair(B[i], i));\n\t\tsort(L1.begin(), L1.end()); reverse(L1.begin(), L1.end());\n\t\tsort(L2.begin(), L2.end());\n\n\t\tint maxn = 0;\n\t\tfor (int j = 0; j < min(2, (int)L1.size()); j++) {\n\t\t\tfor (int k = 0; k < min(2, (int)L2.size()); k++) {\n\t\t\t\tif (L1[j].second != L2[k].second) maxn = max(maxn, L1[j].first - L2[k].first);\n\t\t\t}\n\t\t}\n\t\tcout << maxn + 1 << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define pii pair<int, int>\nusing namespace std;\n\nint main() {\n    int n, m;\n    while (cin >> n >> m, n | m) {\n        vector<int> ma(n, 0), mi(n, 0);\n        for (int i = 0; i < m; i++) {\n            int sc, k;\n            cin >> sc >> k;\n            for (int j = 0; j < k; j++) {\n                int c;\n                cin >> c;\n                ma[c - 1] += sc;\n                if (k == 1) mi[c - 1] += sc;\n            }\n        }\n        int ans = 0;\n        for (int i = 0; i < n; i++) {\n            for (int j = 0; j < n; j++) {\n                if (i == j) continue;\n                ans = max(ans, ma[i] - mi[j] + 1);\n            }\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <map>\nusing namespace std;\n\ntypedef pair<int, int>P;\n\nint main(){\n\n    for(int n, m;cin>>n>>m, n;){\n        vector<int>mn(n, 0), mx(n, 0);\n        for(int i=0;i<m;i++){\n            int s, k;\n            cin>>s>>k;\n            for(int j=0;j<k;j++){\n                int c;\n                cin>>c;\n                c--;\n                mx[c]+=s;\n                if(k==1)mn[c]+=s;\n            }\n        }\n        vector<P>vec;\n        for(int i=0;i<n;i++){\n            vec.push_back(P(mx[i], i));\n        }\n        sort(vec.begin(), vec.end());\n        reverse(vec.begin(), vec.end());\n        int ans = 0;\n        for(int i=0;i<n;i++){\n            for(int j=0;;j++){\n                if(vec[j].second==i)continue;\n                ans = max(ans, vec[j].first - mn[i]);\n                break;\n            }\n        }\n        cout<<ans+1<<endl;\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main()\n{\n\tint N, M;\n\twhile (cin >> N >> M, N | M) {\n\t\tvector<unordered_set<int>> g(M);\n\t\tvector<int> S(M);\n\t\tfor (int i = 0; i < M; i++) {\n\t\t\tcin >> S[i];\n\t\t\tint k;\n\t\t\tcin >> k;\n\t\t\tfor (int j = 0; j < k; j++) {\n\t\t\t\tint c;\n\t\t\t\tcin >> c; --c;\n\t\t\t\tg[i].insert(c);\n\t\t\t}\n\t\t}\n\t\tint ma = 0;\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tvector<int> sc(N);\n\t\t\tfor (int j = 0; j < M; j++) if (g[j].count(i)) {\n\t\t\t\tsc[i] += S[j];\n\t\t\t}\n\t\t\tfor (int j = 0; j < M; j++) if ((int)g[j].size() == 1 && *g[j].begin() != i) {\n\t\t\t\tsc[*g[j].begin()] += S[j];\n\t\t\t}\n\t\t\tma = max(ma, *max_element(sc.begin(), sc.end()) - *min_element(sc.begin(), sc.end()));\n\t\t}\n\t\tcout << ma + 1 << endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define loop for(;;)\n#define rep(i, n) for(long i = 0; i < (long)(n); ++i)\ntypedef std::vector<long> LI;\n\nstruct Solver {\n   void solve() {\n      long n, m; std::cin >> n >> m;\n      if( n == 0 and m == 0 ) exit(0);\n      LI cs[1123];\n      LI ss(m), ks(m);\n      LI minP(n), maxP(n);\n      rep(i, m) {\n         std::cin >> ss[i] >> ks[i];\n         cs[i].resize(ks[i]);\n         rep(k, ks[i]) {\n            std::cin >> cs[i][k];\n            cs[i][k] -= 1;\n            maxP[cs[i][k]] += ss[i];\n         }\n         if( ks[i] == 1 ) {\n            minP[cs[i][0]] += ss[i];\n         }\n      }\n      long res = 0;\n      rep(i, n) {\n         rep(k, n) {\n            if( i == k ) continue;\n            res = std::max(res, maxP[i] - minP[k] + 1);\n         }\n      }\n      printf(\"%ld\\n\", res);\n   }\n};\n\nint main() { loop std::shared_ptr<Solver>(new Solver())->solve(); }"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define pb push_back\n#define fi first\n#define se second\ntypedef pair<ll,ll> P;\n#define Mod 1000000007\nusing VP = vector<P>; using VVP = vector<VP>;\nusing VI = vector<ll>; using VVI = vector<VI>; using VVVI = vector<VVI>;\n#define INF 1ll<<59\n\nint main(){\n  ll n,m;\n  while(1){\n    cin>>n>>m;\n    if(n==0) return 0;\n\n    vector<ll> ma(n,0),mi(n,0);\n    \n    ll s,k,x;\n    ll i,j;\n\n    for(i=0;i<m;i++){\n        cin>>s>>k;\n        if(k==1){\n          cin>>x;\n          ma[x-1]+=s;\n          mi[x-1]+=s;\n        }\n        else {\n          for(j=0;j<k;j++){\n            cin>>x;\n            ma[x-1]+=s;\n          }\n        }\n    }\n\n    vector<ll> v1,v2;\n    ll MM=0,mm=mi[0];\n    for(i=0;i<n;i++){\n      MM=max(MM,ma[i]);\n      \n      mm=min(mm,mi[i]);\n    }\n    for(i=0;i<n;i++){\n      if(MM==ma[i]) v1.pb(i);\n      if(mm==mi[i]) v2.pb(i);\n    }\n    if(v1.size()>1||v2.size()>1) cout<<MM-mm+1<<endl;\n    else if(v1[0]!=v2[0]) cout<<MM-mm+1<<endl;\n    else {\n      ll MM2=-1;\n      ll mm2=1000000000;\n      for(i=0;i<n;i++){\n        if(ma[i]<MM) MM2=max(ma[i],MM2);\n        if(mi[i]>mm) mm2=min(mi[i],mm2);\n      }\n      cout<<max(MM2-mm+1,MM-mm2+1)<<endl;\n    }\n\n\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\n\ntypedef long long LL;\n\nint main(){\n  int n,m;\n  while(1){\n    cin >> n >> m;\n    if(n==0) return 0;\n    vector<int> ma(n,0),mi(n,0);\n    int s,k;\n    int c;\n    for(int i=0;i<m;i++){\n      cin >> s >> k;\n      if(k==1){\n        cin >> c;\n        c--;\n        mi[c]+=s;\n      }else{\n        for(int j=0;j<k;j++){\n          cin >> c;\n          c--;\n          ma[c]+=s;\n        }\n      }\n    }\n    int firstma=0,secondma=0,firstmi=100000,secondmi=10000;\n    int firstmai=-1,secondmai=-1,firstmii=-1,secondmii=-1;\n    for(int i=0;i<n;i++){\n      if(ma[i]+mi[i]>=firstma){\n        secondma=firstma;\n        secondmai=firstmai;\n        firstma=ma[i]+mi[i];\n        firstmai=i;\n      }else if(ma[i]+mi[i]>=secondma){\n        secondma=ma[i]+mi[i];\n        secondmai=i;\n      }\n    }\n    for(int i=0;i<n;i++){\n      if(mi[i]<=firstmi){\n        secondmi=firstmi;\n        secondmii=firstmii;\n        firstmi=mi[i];\n        firstmii=i;\n      }else if(mi[i]<=secondmi){\n        secondmi=mi[i];\n        secondmii=i;\n      }\n    }\n    if(firstmai!=firstmii){\n      cout << firstma-firstmi+1 << endl;\n    }else{\n      cout << max(firstma-secondmi,secondma-firstmi)+1 << endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstdio>\n#include <string.h>\n#include <algorithm>\n#define rep(i, n) for (int i = 0; i < (int)n; i++)\nusing namespace std;\n\n\n\nint main(void)\n{\n  int n,m;\n  while(1){\n    cin>>n>>m;\n    if(n==0&&m==0)return 0;\n    vector<pair<int,int>>n_max(n);\n    vector<pair<int,int>>n_min(n);\n    vector<int>quiz(m);\n    for(int i=0;i<n;i++){\n      n_max[i].second=i;\n      n_min[i].second=i;\n    }\n    int k;\n    for(int i=0;i<m;i++){\n      cin>>quiz[i];\n      cin>>k;\n      for(int j=0;j<k;j++){\n        int tmp;\n        cin>>tmp;\n        tmp--;\n        n_max[tmp].first+=quiz[i];\n        if(k==1)n_min[tmp].first+=quiz[i];\n      }\n    }\n    \n    sort(n_max.begin(),n_max.end());\n    sort(n_min.begin(),n_min.end());\n    int ans=0;\n    if(n_max[n-1].second==n_min[0].second){\n      ans=max((n_max[n-2].first-n_min[0].first),(n_max[n-1].first-n_min[1].first));\n    }else{\n      ans=n_max[n-1].first-n_min[0].first;\n    }\n    cout<<ans+1<<endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\n#define REP(i, n ,N) for(ll i = (n); i < (N); i++)\n#define p(s) cout<<(s)<<endl\n#define p2(a, b) cout<<(a)<<\" \"<<(b)<<endl\nusing namespace std;\ntypedef long long ll;\nll MOD = 1e9+7;\nll inf = 1e18;\n\n\nll N, M;\nint main() {\n\twhile (cin >> N >> M && N > 0) {\n\t\tll sum_max[10101] = {};\n\t\tll sum_min[10101] = {};\n\t\tll S[1010] = {};\n\t\tvector<ll> C[1010];\n\t\tREP(i,0,M){\n\t\t\tll k;\n\t\t\tcin >> S[i] >> k;\n\t\t\tREP(j,0,k){\n\t\t\t\tll c;\n\t\t\t\tcin >> c;\n\t\t\t\tC[i].push_back(c-1);\n\t\t\t}\n\t\t}\n\t\tREP(i,0,M){\n\t\t\tif(C[i].size() == 1){\n\t\t\t\tsum_max[C[i][0]] += S[i];\n\t\t\t\tsum_min[C[i][0]] += S[i];\n\t\t\t}else{\n\t\t\t\tREP(j,0,C[i].size()){\n\t\t\t\t\tsum_max[C[i][j]] += S[i];\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tll ans = 0;\n\t\tREP(i,0,N){\n\t\t\tREP(j,0,N){\n\t\t\t\tif(i==j) continue;\n\t\t\t\tans = max(ans, sum_max[i] - sum_min[j]+1);\n\t\t\t}\n\n\t\t}\n\t\tp(ans);\n\t}\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define lambda(RES_TYPE, ...) (function<RES_TYPE(__VA_ARGS__)>)[&](__VA_ARGS__) -> RES_TYPE\n#define method(FUNC_NAME, RES_TYPE, ...) function<RES_TYPE(__VA_ARGS__)> FUNC_NAME = lambda(RES_TYPE, __VA_ARGS__)\n\nint func(int n,int m){\n    vector<int> min_score(n,0);\n    vector<int> max_score(n,0);\n    for(int i=0;i<m;++i){\n        int score;\n        int k;\n        cin >> score >> k;\n        for(int j=0;j<k;++j){\n            int d;\n            cin >> d;\n            --d;\n            max_score[d] += score;\n            if(k==1)min_score[d] += score;\n        }\n    }\n\n    using pii = pair<int,int>;\n    vector<pii> mins;\n    vector<pii> maxs;\n    for(int i=0;i<n;++i){\n        mins.emplace_back(min_score[i],i);\n        maxs.emplace_back(max_score[i],i);\n    }\n\n    sort(mins.begin(),mins.end());\n    sort(maxs.begin(),maxs.end(),greater<pii>());\n    \n    int res = 0;\n    for(int i=0;i<2;++i){\n        for(int j=0;j<2;++j){\n            if(mins[i].second==maxs[j].second)continue;\n            int d = maxs[j].first - mins[i].first + 1;\n            if(res<d)res=d;\n        }\n    }\n    return res;\n}\n\nint main(){\n    int n,m;\n    while(true){\n        cin >> n >> m;\n        if(n==0 and m==0)break;\n        cout << func(n,m) << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nmain(){\n  int n, m, s, k, c;\n  while(cin>>n>>m, n){\n    int a[10001]={}, b[10001]={}, ma=0, mi=100000;\n    for(int i=0;i<m;i++){\n      cin>>s>>k;\n      if(k==1){\n        cin>>c;\n        a[c]+=s;\n        b[c]+=s;\n      }else{\n        for(int i=0;i<k;i++){\n          cin>>c;\n          a[c]+=s;\n        }\n      }\n    }\n    int x;\n    for(int i=1;i<=n;i++){\n      if(a[i]>ma){\n        ma=a[i];\n        x=i;\n      }\n    }\n    for(int i=1;i<=n;i++){\n      if(i!=x){\n        mi=min(mi, b[i]);\n      }\n    }\n    cout<<ma-mi+1<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define REP(i, s, n) for (int i = s; i < n; ++i)\n#define rep(i, n) REP(i, 0, n)\n#define SORT(c) sort((c).begin(), (c).end())\n#define IINF INT_MAX\n#define LLINF LLONG_MAX\n#define DEBUG true\n// sort(a.begin(), a.end(), std::greater<int>());\n\n/*\nstd::vector<std::string> split(const std::string &input, char delimiter)\n{\n    std::istringstream stream(input);\n\n    std::string field;\n    std::vector<std::string> result;\n    while (std::getline(stream, field, delimiter))\n    {\n        result.push_back(field);\n    }\n    return result;\n}\n*/\n\nint main()\n{\n    int n, m;\n    while (cin >> n >> m)\n    {\n        if (n == 0 && m == 0)\n            break;\n        vector<int> mx(n + 1);\n        vector<int> mn(n + 1);\n        int a, b;\n        rep(j, m)\n        {\n            cin >> a >> b;\n\n            rep(i, b)\n            {\n                int temp;\n                cin >> temp;\n                if (b == 1)\n                    mn[temp] += a;\n                mx[temp] += a;\n            }\n        }\n        int hoge = 0;\n        int hogeposi = 0;\n        int piyo = 0;\n        int piyoposi = 0;\n        REP(i,1, mx.size())\n        {\n            if (hoge < mx[i])\n            {\n                hoge = mx[i];\n                hogeposi = i;\n            }\n        }\n        REP(i,1, mn.size())\n        {\n            if (piyo < mn[i] && i != hogeposi)\n            {\n                piyo = mn[i];\n                piyoposi = i;\n            }\n        }\n        cout << hoge-piyo + 1 << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n\n    while(1){\n        int n, m; cin >> n >> m;\n        if(!n) break;\n        vector<int> max_score(n, 0);\n        vector<int> min_score(n, 0);\n\n        for(int i = 0; i < m; i++){\n            int s, k; cin >> s >> k;\n            vector<int> c(k);\n            for(int j = 0; j < k; j++){\n                cin >> c[j];\n                c[j]--;\n                max_score[c[j]] += s;\n            }\n            \n            if(k == 1){\n                min_score[c[0]] += s;\n            }\n        }\n\n        int ans = 0;\n\n        for(int i = 0; i < n; i++){\n            for(int j = 0; j < n; j++){\n                if(i == j) continue;\n\n                ans = max(ans, max_score[i] - min_score[j] + 1);\n            }\n        }\n    \n    cout << ans << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <algorithm>\n\nint testcase_ends() {\n  size_t N, M;\n  scanf(\"%zu %zu\", &N, &M);\n  if (N == 0 && M == 0) return 1;\n\n  std::vector<int> min(N), max(N);\n  for (size_t i = 0; i < M; ++i) {\n    int S;\n    size_t k;\n    scanf(\"%d %zu\", &S, &k);\n    std::vector<size_t> c(k);\n    for (size_t j = 0; j < k; ++j) {\n      scanf(\"%zu\", &c[j]);\n      --c[j];\n    }\n\n    if (k == 1) {\n      min[c[0]] += S;\n      max[c[0]] += S;\n      continue;\n    }\n    for (size_t j = 0; j < k; ++j) {\n      max[c[j]] += S;\n    }\n  }\n\n  std::vector<int> max_left(N), max_right(N+1);\n\n  for (size_t i = 0; i < N; ++i) {\n    max_left[i+1] = std::max(max_left[i], max[i]);\n  }\n  for (size_t i = N; i--;) {\n    max_right[i] = std::max(max_right[i+1], max[i]);\n  }\n\n  int res = 0;\n  for (size_t i = 0; i < N; ++i) {\n    int max0 = std::max(max_left[i], max_right[i+1]);\n    res = std::max(res, max0-min[i]+1);\n  }\n  printf(\"%d\\n\", res);\n  return 0;\n}\n\nint main() {\n  while (!testcase_ends()) {}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n//type\ntypedef long long ll;\nusing pii = pair<int, int>;\nusing vi = vector<int>;\n//x * y * 1.0 can cause overflow\n//constant\n#define inf (int)(1e9+7)\n#define mod (ll)(1e9+7)\n#define eps 1e-10\n//int dy[] = {0, 0, -1, 1, -1, 1, -1, 1}; //右、左、マイナス、プラス\n//int dx[] = {1, -1, 0, 0, -1, 1, 1, -1};\n//omission\n#define eb emplace_back\n#define F first\n#define S second\n#define SZ(x) ((int)(x).size())\n#define all(v) v.begin(), v.end()\n//manip\n#define chmax(a, b) a = max(a, b)\n#define chmin(a, b) a = min(a, b)\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end(), v.end());\n#define ceil(a, b) a / b + !!(a % b)\ntemplate<class T> T power(T a, T b)\n{return b ? power(a * a % inf, b / 2) * (b % 2 ? a : 1) % inf : 1;}\n#define LB(v, x) (int)(lower_bound(v.begin(), v.end(), x) - v.begin())\n#define UB(v, x) (int)(upper_bound(v.begin(), v.end(), x) - v.begin())\n//loop\n#define rep(i, n) for (int i = 0, i##_len = (n); i < i##_len; ++i)\n#define rep3(i, st, n) for (int i = st; i < n; ++i)\n//algorithm\n//double pointer, l start, how many adds, can be 0 -> init r = l, sum = 0\n//bfs, not x, y, i, j\n//not !(i % 2), i % 2 == 0\n\n\n\nbool comp(pii a, pii b) {\n    return a.S < b.S;\n}\n\n\nint main() {\n    //cast caution\n    //look constraints always\n    cin.tie(0); ios::sync_with_stdio(false);\n    \n    \n    \n    \n    int n, m;\n    while (cin >> n && n) {\n        cin >> m;\n        vector<pii> ALL(n, pii(0, 0));\n        vector<pii> only(n, pii(0, 0));\n        rep(i, n) {ALL[i].F = i; only[i].F = i;}\n        rep(i, m) {\n            int s, k; cin >> s >> k;\n            \n            rep(j, k) {\n                int c; cin >> c; c--;\n                \n                ALL[c].S += s;\n                if (k == 1) only[c].S += s;\n            }\n            \n        }\n        \n        sort(all(ALL), comp);\n        sort(all(only), comp);\n        \n        //cout << endl; rep(i, n) cout << ALL[i].F << \" \" << ALL[i].S << endl;\n        //cout << endl; rep(i, n) cout << only[i].F << \" \" << only[i].S << endl;\n        \n        if (ALL[n - 1].F != only[0].F) {\n            cout << ALL[n - 1].S - only[0].S + 1 << endl;\n        } else {\n            cout << max(ALL[n - 1].S - only[1].S + 1, ALL[n - 2].S - only[0].S + 1) << endl;\n        }\n        \n        \n        \n    }\n    \n    \n    \n    \n}\n\n/*\n いっちばん解ける人といっちばん解けない人の差\n \n 1. いっちばん解ける人\n その人の解けるの全問解ける\n みんなの全問解けた場合考えてその最大\n \n \n \n 2. いっちばん解けない人\n その人にしか解けないのだけ\n みんなの、自分しか解けない場合考えてその最小\n \n ただし、1. 2. がかぶったら2番目の人考慮すればいいのかな\n \n \n \n */\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n#define REP(i, m, n) for (int i = (int)m; i < (int)n; i++)\n#define rep(i, n) REP(i, 0, n)\n\n\nint main()\n{\n  ll sum1[10010], sum2[10010];\n  while (1)\n  {\n    ll n, m;\n    cin >> n >> m;\n    if (n == 0)\n      break;\n    fill(sum1, sum1 + n, 0);\n    fill(sum2, sum2 + n, 0);\n    rep(mi, m)\n    {\n      ll s;\n      cin >> s;\n      int k;\n      cin >> k;\n      if (k == 1)\n      {\n        ll c;\n        cin >> c;\n        c--;\n        sum1[c] += s, sum2[c] += s;\n      }\n      else\n      {\n        rep(ki, k)\n        {\n          ll c;\n          cin >> c;\n          c--;\n          sum1[c] += s;\n        }\n      }\n    }\n    ll Max = 0;\n    rep(i, n) rep(j, n)\n    {\n      if (i == j)\n        continue;\n      Max = max(Max, sum1[i] - sum2[j] + 1);\n    }\n    cout << Max << \"\\n\";\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cmath>\n#include<cstring>\n#include<unordered_map>\n#include<cassert>\n#include<climits>\n#include<vector>\n#include<deque>\n#include<map>\n#include<set>\n#include<algorithm>\n#include<bitset>\n#include<queue>\n#include<sstream>\n\n#define REP(i,s,n) for(int i=s;i<n;++i)\n#define rep(i,n) REP(i,0,n)\n#define IINF INT_MAX\n#define LLINF LLONG_MAX\n\nusing namespace std;\n\n\ntypedef long long ll;\n\nint N,M;\nll S[1010];\nvector<int> c[1010];\n\nvoid compute() {\n  ll maxi = 0;\n  REP(win,1,N+1) {\n    unordered_map<int,ll> fix;\n    ll mini = LLINF;\n    ll score = 0;\n    rep(i,M) {\n      int pos = -1;\n      rep(j,(int)c[i].size()) if( c[i][j] == win ) {\n\tpos = j;\n\tbreak;\n      }\n      if( pos == -1 ) {\n\tif( c[i].size() == 1 ) {\n\t  fix[c[i][0]] += S[i];\n\t}\n      } else {\n\tscore += S[i];\n      }\n    }\n\n    for(auto v : fix) {\n      if( v.first != win ) {\n\tmini = min(mini,v.second);\n      }\n    }\n    if( fix.size() != N-1 ) mini = 0;\n    if( mini == LLINF ) mini = 0;\n    //cout << \"win = \" << win << \" \" << score << \" - \" << mini << \" + 1\" << endl;\n    maxi = max(maxi,score-mini+1LL);\n  }\n  cout << maxi << endl;\n}\n\nint main() {\n  while( cin >> N >> M, N|M ) {\n    rep(i,N) c[i].clear();\n    rep(i,M) {\n      cin >> S[i];\n      c[i].clear();\n      int k;\n      cin >> k;\n      c[i].resize(k);\n      rep(j,k) cin >> c[i][j];\n    }\n    compute();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n\n    while(1){\n        int n, m; cin >> n >> m;\n        if(!n) break;\n        vector<int> max_score(n, 0);\n        vector<int> min_score(n, 0);\n\n        for(int i = 0; i < m; i++){\n            int s, k; cin >> s >> k;\n            vector<int> c(k);\n            for(int j = 0; j < k; j++){\n                cin >> c[j];\n                c[j]--;\n                max_score[c[j]] += s;\n            }\n            \n            if(k == 1){\n                min_score[c[0]] += s;\n            }\n        }\n\n        int ans = 0;\n\n        for(int i = 0; i < n; i++){\n            for(int j = 0; j < n; j++){\n                if(i == j) continue;\n\n                ans = max(ans, max_score[i] - min_score[j] + 1);\n            }\n        }\n    \n    cout << ans << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "/////16:35~\n/////B:16:42\n/////C:\n\n#include<iostream>\n#include<vector>\n#include<algorithm>\n\nint S[1010];\nint k[1010];\nint Nmax[10101];\nint Nmin[10101];\nusing namespace std;\nint main(){\n    while(true){\n        int N,M;\n        cin>>N>>M;\n        if(N==0)return 0;\n        for(int i =0;i<=N;i++){\n            Nmin[i]=0;\n            Nmax[i]=0;\n        }\n        vector<vector<int> > c(M+1);\n        for(int i = 1;i<=M;i++){\n            cin>>S[i]>>k[i];\n            for(int j=1;j<=k[i];j++){\n                int tmp;\n                cin>>tmp;\n                c[i].push_back(tmp);\n                Nmax[tmp]+=S[i];\n            }\n            if(k[i]==1){\n                Nmin[c[i][0]]+=S[i];\n            }\n        }\n        int min1=1e9,min2=1e9,ans=0,minpos=0;\n        for(int i =1;i<=N;i++){\n            if(Nmin[i]<=min1){\n                min1 = Nmin[i];\n                minpos = i;\n            }\n        }\n        for(int i =1;i<=N;i++){\n            if(Nmin[i]<=min2){\n                if(i!=minpos){\n                    min2 = Nmin[i];\n                }\n            }\n        }\n        for(int i =1;i<=N;i++){\n            if(i == minpos){\n                ans = max(ans,Nmax[i]-min2);\n            }else{\n                ans = max(ans,Nmax[i]-min1);\n            }\n        }\n        cout<<ans+1<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MAX_N 10005\nint N,M;\nint main(){\n  while(cin>>N>>M){\n    int Min[MAX_N]={},Max[MAX_N]={};\n    if(M==0&&N==0)break;\n    for(int i=0;i<M;i++){\n      int p,k,id;\n      cin>>p>>k;\n      for(int j=0;j<k;j++){\n        cin>>id;\n        id--;\n        if(k==1){\n          Min[id]+=p;\n        }\n        Max[id]+=p;\n      }\n    }\n\n    for(int i=0;i<N;i++){\n      cout<<Max[i]<<' '<<Min[i]<<endl;\n    }\n    \n    int ans=0;\n    for(int i=0;i<N;i++){\n      for(int j=0;j<i;j++){\n        if(Max[i]>Min[j])\n          ans=max(ans, abs(Max[i]-Min[j]) );\n        \n        if(Max[j]>Min[i])\n          ans=max(ans, abs(Max[j]-Min[i]) );\n      }\n    }\n    cout<<ans+1<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing P = pair<int, int>;\n\nconst int M = 1000000007;\n\nint main() {\n    while (true) {\n        int n, m;\n        cin >> n >> m;\n        if (!n) return 0;\n\n        vector<P> ma(n), mi(n);\n        for (int i = 0; i < n; ++i) {\n            ma[i] = P(0, i);\n            mi[i] = P(0, i);\n        }\n        for (int i = 0; i < m; ++i) {\n            int s, k;\n            cin >> s >> k;\n            if (k == 1) {\n                int a;\n                cin >> a;\n                ma[a - 1].first += s;\n                mi[a - 1].first += s;\n            }\n            else {\n                for (int j = 0; j < k; ++j) {\n                    int a;\n                    cin >> a;\n                    ma[a - 1].first += s;\n                }\n            }\n        }\n        sort(ma.begin(), ma.end());\n        reverse(ma.begin(), ma.end());\n        sort(mi.begin(), mi.end());\n        if (ma[0].second != mi[0].second)\n            cout << ma[0].first - mi[0].first + 1 << \"\\n\";\n        else\n            cout << max(ma[0].first - mi[1].first, ma[1].first - mi[0].first) + 1 << \"\\n\";\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nconst int INF = 1e9;\nconst ll LINF = 1e18;\ninline ll gcd(ll a, ll b) { return b ? gcd(b, a%b) : a; }\ninline ll lcm(ll a, ll b) { return a / gcd(a, b)*b; }\ntemplate<class S,class T> ostream& operator << (ostream& out,const pair<S,T>& o){ out << \"(\" << o.first << \",\" << o.second << \")\"; return out; }\ntemplate<class T> ostream& operator << (ostream& out,const vector<T>& V){ for(int i = 0; i < V.size(); i++){ out << V[i]; if(i!=V.size()-1) out << \" \";} return out; }\ntemplate<class T> ostream& operator << (ostream& out,const vector<vector<T> >& Mat){ for(int i = 0; i < Mat.size(); i++) { if(i != 0) out << endl; out << Mat[i];} return out; }\ntemplate<class S,class T> ostream& operator << (ostream& out,const map<S,T>& mp){ out << \"{ \"; for(auto it = mp.begin(); it != mp.end(); it++){ out << it->first << \":\" << it->second; if(mp.size()-1 != distance(mp.begin(),it)) out << \", \"; } out << \" }\"; return out; }\ntemplate<typename T>vector<T> make_v(size_t a){return vector<T>(a);}\ntemplate<typename T,typename... Ts>auto make_v(size_t a,Ts... ts){return vector<decltype(make_v<T>(ts...))>(a,make_v<T>(ts...));}\ntemplate<typename T,typename V> typename enable_if<is_class<T>::value==0>::type fill_v(T &t,const V &v){t=v;}\ntemplate<typename T,typename V> typename enable_if<is_class<T>::value!=0>::type fill_v(T &t,const V &v){for(auto &e:t) fill_v(e,v);}\n/*\n <url:http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=2825&lang=jp>\n 問題文============================================================\n =================================================================\n 解説=============================================================\n ================================================================\n */\n\nstruct solver{\n    ll id;\n    ll min_s;\n    ll max_s;\n    solver(){}\n    solver(ll id,ll min_s, ll max_s):id(id),min_s(min_s),max_s(max_s){}\n};\ntemplate<class Type>\nType solve(Type res = Type()){\n    ll N,M;\n    while(cin >> N >> M,N){\n        vector<solver> solvers(N);\n        for(int i = 0; i < N;i++){\n            solvers[i] = solver(i,0,0);\n        }\n        \n        for(int i = 0; i < M;i++){\n            ll S; cin >> S;\n            ll k; cin >> k;\n            for(int j = 0; j < k;j++){\n                ll c; cin >> c;\n                c--;\n                if(k == 1){\n                    solvers[c].min_s += S;\n                }\n                solvers[c].max_s += S;\n            }\n        }\n        \n        sort(solvers.begin(),solvers.end(),[](const solver& l,const solver& r){\n            return l.min_s < r.min_s;\n        });\n        \n        solver MIN[2];\n        for(int i = 0; i<  2;i++){\n            MIN[i] = solvers[i];\n        }\n        sort(solvers.begin(),solvers.end(),[](const solver& l,const solver& r){\n            return l.max_s > r.max_s;\n        });\n        \n        solver MAX[2];\n        for(int i = 0; i<  2;i++){\n            MAX[i] = solvers[i];\n        }\n        \n        ll ans = 0;\n        for(int i = 0; i < 2;i++){\n            for(int j = 0; j < 2;j++){\n                if(MIN[i].id == MAX[j].id) continue;\n                ans = max(ans,MAX[j].max_s - MIN[i].min_s);\n            }\n        }\n        cout << ans+1 << endl;\n    }\n    return res;\n}\nint main(void) {\n    cin.tie(0); ios_base::sync_with_stdio(false);\n    solve(0);\n    // cout << fixed << setprecision(15) << solve<ll>() << endl;\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "//#include <bits/stdc++.h>\n\n#include <iostream>\n#include <algorithm>\n\n#include <bitset>\n#include <vector>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <cstring>\n#include <string>\n#include <utility>\n#include <array>\n#include <complex>\n#include <valarray>\n\n#include <cassert>\n#include <cmath>\n#include <functional>\n#include <iomanip>\n#include <chrono>\n#include <random>\n#include <numeric>\n\n#include<memory>\n\n\nusing namespace std;\n#define int long long\n\ntypedef long long ll;\ntypedef unsigned long long ull;\n//typedef unsigned __int128 HASH;\ntypedef pair<int,int> pii;\ntypedef pair<ll, ll> pll;\ntypedef pair<ull, ull> pullull;\ntypedef pair<ll,int> plli;\ntypedef pair<double,int> pdi;\ntypedef pair<long double, int> pdbi;\ntypedef pair<int,pii> pipii;\ntypedef pair<ll,pll> plpll;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vi> vvi;\ntypedef vector<vvi> vvvi;\ntypedef vector<pii> vpii;\ntypedef vector<vector<int>> mat;\n\n#define rep(i,n) for (int i=0;i<(n);i++)\n#define rep2(i,a,b) for (int i=(a);i<(b);i++)\n#define rrep(i,n) for (int i=(n);i>0;i--)\n#define rrep2(i,a,b) for (int i=(a);i>b;i--)\n#define pb push_back\n#define fi first\n#define se second\n#define all(a) (a).begin(),(a).end()\n#define rall(a) (a).rbegin(),(a).rend()\n\nconst ll hmod1 = 999999937;\nconst ll hmod2 = 1000000000 + 9;\nconst int INF = 1<<30;\nconst ll INFLL = 1LL<<62;\nconst long double EPS = 1e-12;\nconst ll mod = 1000000000 + 7;\n//const ll mod = 998244353;\nconst int dx4[4] = {1, 0, -1, 0};\nconst int dy4[4] = {0, 1, 0, -1};\nconst int dx8[8] = {1, 1, 1, 0, 0, -1, -1, -1};\nconst int dy8[8] = {0, 1, -1, 1, -1, 0, 1, -1};\nconst long double pi = 3.141592653589793;\n\n#define addm(X, Y) (X) = ((X) + ((Y) % mod) + mod) % mod\n#define inside(y, x, h, w) (0 <= (y) && (y) < (h) && 0 <= (x) && (x) < (w)) ? true : false\n\n//debug\n#define DEBUG\n\n#define DUMPOUT cout\n\n#ifdef DEBUG\n#define dump(...) DUMPOUT<<#__VA_ARGS__<<\" :[\"<<__FUNCTION__<<\":\"<<__LINE__<<\"]\"<<endl; DUMPOUT<<\"    \"; dump_func(__VA_ARGS__)\n#else\n#define dump(...)\n#endif\n\nvoid dump_func() {DUMPOUT << endl;};\n\ntemplate <class Head, class... Tail> void dump_func(Head&& head, Tail&&... tail) {\n    DUMPOUT << head;\n    if (sizeof...(Tail) == 0) DUMPOUT << \" \";\n    else DUMPOUT << \", \";\n    dump_func(std::move(tail)...);\n}\n\n//ostream\ntemplate<typename T> ostream& operator << (ostream& os, vector<T>& vec) {\n    os << \"[\"; for (int i = 0; i<vec.size(); i++) os << vec[i] << (i + 1 == vec.size() ? \"\" : \", \"); os << \"]\";\n    return os;\n}\n\ntemplate<typename T, typename U> ostream& operator << (ostream& os, pair<T, U>& pair_var) {\n    os << \"(\" << pair_var.first << \", \" << pair_var.second << \")\";\n    return os;\n}\n\ntemplate<typename T, typename U> ostream& operator << (ostream& os, map<T, U>& map_var) {\n    os << \"[\";\n    for (auto itr = map_var.begin(); itr != map_var.end(); itr++) {\n        os << \"(\" << itr->first << \", \" << itr->second << \")\"; itr++;  if(itr != map_var.end()) os << \", \"; itr--;\n    }\n    os << \"]\";\n    return os;\n}\n\ntemplate<typename T> ostream& operator << (ostream& os, set<T>& set_var) {\n    os << \"[\";\n    for (auto itr = set_var.begin(); itr != set_var.end(); itr++) {\n        os << *itr; ++itr; if(itr != set_var.end()) os << \", \"; itr--;\n    }\n    os << \"]\";\n    return os;\n}\n\nstruct segtree {\n    int size;\n    vector<long long> node;\n\n    segtree (int n) : size(1) {\n        while (size < n) size *= 2;\n        node.resize(2 * size - 1, INFLL / 2);\n    }\n\n    void update(int k, int a) {\n        k += size - 1;\n        node[k] = a;\n        while (k > 0){\n            k = (k - 1) / 2;\n            node[k] = min(node[2 * k + 1], node[2 * k + 2]);\n        }\n    }\n    //[queryL: queryR)\n    long long get(int queryL, int queryR, int k = 0, int nodeL = 0, int nodeR = -1) {\n        if (nodeR == -1) nodeR = size;\n        if (nodeR <= queryL || queryR <= nodeL) return INFLL;//初期値より大きく\n        if (queryL <= nodeL && nodeR <= queryR) return node[k];\n        else{\n            int nodeM = (nodeL + nodeR) / 2;\n            long long vl = get(queryL, queryR, 2 * k + 1, nodeL, nodeM);\n            long long vr = get(queryL, queryR, 2 * k + 2, nodeM, nodeR);\n            return min(vl, vr);\n        }\n    }\n};\n\nsigned main() {\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n  while (true) {\n    int n, m;\n    cin >> n >> m;\n    if (n == 0) break;\n    int s[10000 + 5] = {};\n    int score[10000 + 5] = {};\n    vector<vector<int>> kouho(m);\n    vector<vector<bool>> included(m, vector<bool>(n));\n    rep(i, m) {\n      int k;\n      cin >> s[i] >> k;\n      rep(j, k) {\n        int answer;\n        cin >> answer;\n        answer--;\n        kouho[i].push_back(answer);\n        included[i][answer] = true;\n      }\n    }\n    //確定\n    rep(i, m) {\n      if (kouho[i].size() == 1) {\n        int idx = kouho[i][0];\n        score[idx] += s[i];\n      }\n    }\n    segtree seg(n);\n    rep(i, n) {\n      seg.update(i, score[i]);\n    }\n    int ans = 0;\n    rep(i, n) {\n      int tmpmx = score[i];\n      rep(j, m) {\n        if (kouho[j].size() == 1) continue;\n        if (included[j][i]) tmpmx += s[j];\n      }\n      int mnl = seg.get(0, i);\n      int mnr = seg.get(i+1, n);\n      // min[S\\i], S = {0, 1, ..., n}\n      int mn = min(mnl, mnr);\n      if (ans < tmpmx - mn) {\n        ans = tmpmx - mn;\n      }\n    }\n    cout << ans+1 << endl;\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <utility>\nusing namespace std;\n\nint main(){\n\twhile(1){\n\t\tint n,m;\n\t\tcin >> n >> m;\n\t\tif(n == 0) break;\n\n\t\tvector<int> atmost(n, 0), atleast(n, 0);\n\t\tfor(int i=0; i<m; i++){\n\t\t\tint s,k;\n\t\t\tcin >> s >> k;\n\t\t\tfor(int i=0; i<k; i++){\n\t\t\t\tint c;\n\t\t\t\tcin >> c;\n\t\t\t\tc--;\n\t\t\t\tatmost[c] += s;\n\t\t\t\tif(k == 1) atleast[c] += s;\n\t\t\t}\n\t\t}\n\n\t\tvector<pair<int, int> > a(n), b(n);\n\t\tfor(int i=0; i<n; i++){\n\t\t\ta[i] = make_pair(atmost[i], i);\n\t\t\tb[i] = make_pair(atleast[i], i);\n\t\t}\n\t\tsort(a.begin(), a.end(), greater<pair<int, int> >());\n\t\tsort(b.begin(), b.end());\n\t\tif(a[0].second == b[0].second){\n\t\t\tcout << max(a[0].first -b[1].first, a[1].first -b[0].first) +1 << endl;\n\t\t}else{\n\t\t\tcout << a[0].first -b[0].first +1 << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<math.h>\n#include<algorithm>\n#include<utility>\n#include<functional>\n#include<queue>\n#include<string.h>\n#include<string>\n#include<set>\n#include<map>\n#include<vector>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> P;\nconst int MOD = 1000000007;\nconst ll INF=2e18;\n\nll N,M;\nll s[1010];\nll minPoint[100010]={};\nll maxPoint[100010]={};\nP ma[100010]={};\nP mi[100010]={};\nint main(){\n    while(cin>>N>>M,N!=0){\n        for(ll i=0;i<N;i++){\n            minPoint[i]=0;\n            maxPoint[i]=0;\n        }\n        for(ll i=0;i<M;i++){\n            ll s,k,c;\n            cin>>s>>k;\n            for(ll j=0;j<k;j++){\n                cin>>c;\n                c--;\n                maxPoint[c]+=s;\n            }\n            if(k==1){\n                minPoint[c]+=s;\n            }\n        }\n        for(ll i=0;i<N;i++){\n            ma[i]=P(maxPoint[i],i);\n            mi[i]=P(minPoint[i],i);\n        }\n        sort(ma,ma+N);\n        sort(mi,mi+N);\n        P ma1=ma[N-1],ma2=ma[N-2];\n        P mi1=mi[0],mi2=mi[1];\n        if(ma1.second!=mi1.second){\n            cout<<ma1.first-mi1.first+1<<endl;\n        }else{\n            cout<<max(ma2.first-mi1.first,ma1.first-mi2.first)+1<<endl;\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream> #include <iomanip> #include <stack> #include <queue> #include <vector> #include <algorithm> #include <map> #include <set> using namespace std; int main() { int n, m; cin >> n >> m; int s, k, c; while(n != 0 && m != 0){ vector<int> mx(n, 0), mn(n, 0); for(int i = 0; i < m; i++){ cin >> s >> k; for(int j = 0; j < k; j++){ cin >> c; c--; mx[c] += s; } if(k == 1)mn[c] += s; } int ans = 0; for(int i = 0; i < n; i++){ for(int j = 0; j < n; j++){ if(i == j)continue; ans = max(ans, mx[i] - mn[j]); } } cout << ans + 1 << endl; cin >> n >> m; } } \n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<math.h>\n#include<vector>\n#include<algorithm>\n#include<queue>\n#include<set>\n#include<map>\n#define REP(i, n) for(long long i = 0; i < n; ++i)\n#define ALL(a) a.begin(), a.end()\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll, ll> P;\n\nint main() {\n\twhile(1) {\n\t\tint n, m;\n\t\tcin>>n>>m;\n\t\tif(n==0&&m==0) break;\n\t\tvector<int> mini(n, 0);\n\t\tvector<int> maxi(n, 0);\n\t\tREP(i, m) {\n\t\t\tint s, k;\n\t\t\tcin>>s>>k;\n\t\t\tREP(j, k) {\n\t\t\t\tint c;\n\t\t\t\tcin>>c;\n\t\t\t\t--c;\n\t\t\t\tif(k == 1) mini[c] += s;\n\t\t\t\tmaxi[c] += s;\n\t\t\t}\n\t\t}\n\t\tint res = 0;\n\t\tREP(i, n) {\n\t\t\tREP(j, n) {\n\t\t\t\tif(i == j) continue;\n\t\t\t\tres = max(res, maxi[i] - mini[j]);\n\t\t\t}\n\t\t}\n\t\tcout<<res + 1<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define REP(i, s, n) for (int i = s; i < n; ++i)\n#define rep(i, n) REP(i, 0, n)\n#define SORT(c) sort((c).begin(), (c).end())\n#define IINF INT_MAX\n#define LLINF LLONG_MAX\n#define DEBUG true\n// sort(a.begin(), a.end(), std::greater<int>());\n\n/*\nstd::vector<std::string> split(const std::string &input, char delimiter)\n{\n    std::istringstream stream(input);\n\n    std::string field;\n    std::vector<std::string> result;\n    while (std::getline(stream, field, delimiter))\n    {\n        result.push_back(field);\n    }\n    return result;\n}\n*/\n\nint main()\n{\n    int n, m;\n    while (cin >> n >> m)\n    {\n        if (n == 0 && m == 0)\n            break;\n        vector<int> mx(n + 1);\n        vector<int> mn(n + 1);\n        int a, b;\n        rep(j, m)\n        {\n            cin >> a >> b;\n\n            rep(i, b)\n            {\n                int temp;\n                cin >> temp;\n                if (b == 1)\n                    mn[temp] += a;\n                mx[temp] += a;\n            }\n        }\n        int hoge = 0;\n        int hogeposi = 0;\n        int piyo = INT_MAX;\n        int piyoposi = 0;\n        REP(i,1, mx.size())\n        {\n            if (hoge < mx[i])\n            {\n                hoge = mx[i];\n                hogeposi = i;\n            }\n        }\n        REP(i,1, mn.size())\n        {\n            if (piyo > mn[i] && i != hogeposi)\n            {\n                piyo = mn[i];\n                piyoposi = i;\n            }\n        }\n        cout << hoge-piyo + 1 << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cmath>\n#include<cstring>\n#include<unordered_map>\n#include<cassert>\n#include<climits>\n#include<vector>\n#include<deque>\n#include<map>\n#include<set>\n#include<algorithm>\n#include<bitset>\n#include<queue>\n#include<sstream>\n\n#define REP(i,s,n) for(int i=s;i<n;++i)\n#define rep(i,n) REP(i,0,n)\n#define IINF INT_MAX\n#define LLINF LLONG_MAX\n\nusing namespace std;\n\n\ntypedef long long ll;\n\nint N,M;\nll S[1010];\nvector<int> c[1010];\n\nvoid compute() {\n  ll maxi = 0;\n  REP(win,1,N+1) {\n    unordered_map<int,ll> fix;\n    ll mini = LLINF;\n    ll score = 0;\n    rep(i,M) {\n      int pos = -1;\n      rep(j,(int)c[i].size()) if( c[i][j] == win ) {\n\tpos = j;\n\tbreak;\n      }\n      if( pos == -1 ) {\n\tif( c[i].size() == 1 ) {\n\t  fix[c[i][0]] += S[i];\n\t}\n      } else {\n\tscore += S[i];\n      }\n    }\n\n    for(auto v : fix) {\n      if( v.first != win ) {\n\tmini = min(mini,v.second);\n      }\n    }\n    if( fix.size() != N-1 ) mini = 0;\n    if( mini == LLINF ) mini = 0;\n    //cout << \"win = \" << win << \" \" << score << \" - \" << mini << \" + 1\" << endl;\n    maxi = max(maxi,score-mini+1LL);\n  }\n  cout << maxi << endl;\n}\n\nint main() {\n  while( cin >> N >> M, N|M ) {\n    rep(i,M) {\n      cin >> S[i];\n      c[i].clear();\n      int k;\n      cin >> k;\n      c[i].resize(k);\n      rep(j,k) cin >> c[i][j];\n    }\n    compute();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main() {\n  int n, m;\n  while (cin >> n >> m, n) {\n    vector<int> s(m), k(m);\n    vector<vector<int>> c(m, vector<int>());\n    for (int i = 0; i < m; i++) {\n      cin >> s[i] >> k[i];\n      for (int j = 0; j < k[i]; j++) {\n        int a;\n        cin >> a;\n        a--;\n        c[i].emplace_back(a);\n      }\n    }\n    vector<int> smin(n, 0), smax(n, 0);\n    for (int i = 0; i < m; i++) {\n      if (k[i] == 1) smin[c[i][0]] += s[i];\n      for (int j = 0; j < k[i]; j++) {\n        int idx = c[i][j];\n        smax[idx] += s[i];\n      }\n    }\n    int ans = 0;\n    for (int i = 0; i < n; i++) {\n      for (int j = 0; j < n; j++) {\n        if (i == j) continue;\n        ans = max(ans, smax[i] - smin[j] + 1);\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define INF 1e18\n#define int long long\n#define Rep(i, a, n) for (int i = (a); i < (n); i++)\n#define rep(i, n) Rep(i, 0, n)\n#define all(a) (a).begin(), (a).end()\nusing namespace std;\ntypedef pair<int, int> P;\ntypedef pair<int, P> PP;\nconst int mod = 1000000007;\n//const int mod = 998244353;\n\nsigned main()\n{\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n\n    while (1)\n    {\n        int n, m;\n        cin >> n >> m;\n        if (n == 0)\n            break;\n        vector<int> Max(n, 0), Min(n, 0);\n        rep(i, m)\n        {\n            int s, k;\n            cin >> s >> k;\n            rep(j, k)\n            {\n                int c;\n                cin >> c;\n                c--;\n                Max[c] += s;\n                if (k == 1)\n                    Min[c] += s;\n            }\n        }\n        int MAX1 = -1, MAX2 = -1, MIN1 = INF, MIN2 = INF;\n        int who[4];\n        rep(i, n)\n        {\n            if (MAX1 <= Max[i])\n            {\n                MAX2 = MAX1;\n                MAX1 = Max[i];\n                who[1] = who[0];\n                who[0] = i;\n            }\n            else if (MAX2 <= Max[i])\n            {\n                MAX2 = Max[i];\n                who[1] = i;\n            }\n            if (MIN1 >= Min[i])\n            {\n                MIN2 = MIN1;\n                MIN1 = Min[i];\n                who[3] = who[2];\n                who[2] = i;\n            }\n            else if (MIN2 >= Min[i])\n            {\n                MIN2 = Min[i];\n                who[3] = i;\n            }\n        }\n        if (who[0] != who[2])\n            cout << MAX1 - MIN1 + 1 << endl;\n        else\n            cout << max(MAX1 - MIN2 + 1, MAX2 - MIN1 + 1) << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nint main() {\n\tcin.tie(0);\n\tios_base::sync_with_stdio(false);\n\tint N, M;\n\twhile (cin >> N >> M, N) {\n\t\tvector<int> mx(N), mn(N);\n\t\tfor (int i = 0; i < M; ++i) {\n\t\t\tint s, l, x;\n\t\t\tcin >> s >> l;\n\t\t\tfor (int j = 0; j < l; ++j) {\n\t\t\t\tcin >> x; --x;\n\t\t\t\tmx[x] += s;\n\t\t\t\tif (l == 1) mn[x] += s;\n\t\t\t}\n\t\t}\n\t\tvector<int> lmx(N + 1), rmx(N + 1);\n\t\tfor (int i = 0; i < N; ++i) lmx[i + 1] = max(lmx[i], mx[i]);\n\t\tfor (int i = N - 1; i >= 0; --i) rmx[i] = max(rmx[i + 1], mx[i]);\n\t\tint ans = 0;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tans = max(ans, max(lmx[i], rmx[i + 1]) - mn[i]);\n\t\t}\n\t\tcout << ans + 1 << '\\n';\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nusing i64 = long long int;\nusing ui64 = unsigned long long int;\n\n////////////////////////////////\n\nstruct d{\n    vector<int> k;\n    int s;\n};\n\nint main()\n{\n    int n,m;\n    while(cin >> n >> m,n||m){\n        vector<d> data(m);\n        for(int i=0;i<m;i++){\n            cin >> data[i].s;\n            int k;\n            cin >> k;\n            data[i].k.resize(k);\n            for(int j=0;j<k;j++){\n                cin >> data[i].k[j];\n            }\n        }\n        vector<int> maxscore(n+1,0);\n        for(int i=0;i<m;i++){\n            int s = data[i].s;\n            for(int j=0;j<data[i].k.size();j++){\n                maxscore[data[i].k[j]]+=s;\n            }\n        }\n        // for(int i=0;i<maxscore.size();i++)cout << maxscore[i] << \" \";\n        // cout << endl;\n        vector<int> bestscore(n+1);\n        sort(data.begin(),data.end(),[](const d& l,const d& r){return l.s>r.s;});\n        for(int i=0;i<m;i++){\n            int bestj = 0;\n            for(int j=0;j<data[i].k.size();j++){\n                int c = data[i].k[j];\n                if(bestscore[bestj]<bestscore[c]||(bestscore[bestj]==bestscore[c]&&maxscore[bestj]<maxscore[c])){\n                    bestj = c;\n                }\n            }\n            bestscore[bestj]+=data[i].s;\n        }\n        // for(int i=0;i<bestscore.size();i++)cout << bestscore[i] << \" \";\n        // cout << endl;\n        sort(bestscore.begin(),bestscore.end());\n        // cout << n << \" \" << m << endl;\n        cout << bestscore.back()-bestscore[1] + 1 << endl;\n    }\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include\"bits/stdc++.h\"\n\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\nusing pii = pair<int, int>;\nusing pll = pair<ll, ll>;\n\n#define FOR(k,m,n) for(ll (k)=(m);(k)<(n);(k)++)\n#define REP(i,n) FOR((i),0,(n))\n#define WAITING(str) int str;std::cin>>str;\n#define DEBUGING(str) cout<< #str << \" \" str<<endl\n\nconstexpr int INF = (1 << 30);\nconstexpr ll INFL = (1ll << 60);\nconstexpr ll MOD = 1000000007;// 10^9+7\n\n\n\nint main()\n{\n\twhile (true) {\n\t\tint N, M;\n\t\tcin >> N >> M;\n\t\tif(N==0)break;\n\t\tvector<pair<int, int>> mm(N);\n\t\tREP(i, M) {\n\t\t\tint s, k, tmp;\n\t\t\tcin >> s >> k;\n\t\t\t// maximum\n\t\t\tREP(j, k) {\n\t\t\t\tcin >> tmp;\n\t\t\t\ttmp--;\n\t\t\t\tmm[tmp].first += s;\n\t\t\t}\n\t\t\t// minimum\n\t\t\tif (k == 1)mm[tmp].second += s;\n\t\t}\n\t\tvector<pair<int, int>> mini, maxi;\n\t\tREP(i, N) {\n\t\t\tmaxi.push_back({ mm[i].first,i });\n\t\t\tmini.push_back({ mm[i].second,i });\n\t\t}\n\t\tsort(maxi.begin(), maxi.end(), greater<pair<int,int>>());\n\t\tsort(mini.begin(), mini.end());\n\t\tif (maxi.front().second != mini.front().second) {\n\t\t\tcout << maxi.front().first - mini.front().first + 1 << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << max(\n\t\t\t\tmaxi.front().first - mini[N - 2].first,\n\t\t\t\tmaxi[1].first - mini.back().first\n\t\t\t) + 1 << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream> #include <iomanip> #include <stack> #include <queue> #include <vector> #include <algorithm> #include <map> #include <set> using namespace std; int main() { int n, m; cin >> n >> m; int s, k, c; while(n != 0 && m != 0){ vector<int> mx(n, 0), mn(n, 0); for(int i = 0; i < m; i++){ cin >> s >> k; for(int j = 0; j < k; j++){ cin >> c; c--; mx[c] += s; } if(k == 1)mn[c] += s; } int ans = 0; for(int i = 0; i < n; i++){ for(int j = 0; j < n; j++){ if(i == j)continue; ans = max(ans, mx[i] - mn[j]); } } cout << ans + 1 << endl; cin >> n >> m; } } \n"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#define ll long long\n#define rep(i,l,r)for(ll i=(l);i<(r);i++)\n#define min(p,q)((p)<(q)?(p):(q))\n#define max(p,q)((p)>(q)?(p):(q))\n#define INF ((1LL<<62)-(1LL<<31))\n\nll s[10010];//1人問題の得点\nll t[10010];//それ以外の得点\n\nint main(){\n\tll n,m;\n\twhile(scanf(\"%lld%lld\",&n,&m),n){\n\t\trep(i,1,n+1)s[i]=t[i]=0;\n\t\trep(i,0,m){\n\t\t\tll ten,k;\n\t\t\tscanf(\"%lld%lld\",&ten,&k);\n\t\t\tll hito;\n\t\t\tif(k==1){\n\t\t\t\tscanf(\"%lld\",&hito);\n\t\t\t\ts[hito]+=ten;\n\t\t\t}else{\n\t\t\t\trep(_,0,k){\n\t\t\t\t\tscanf(\"%lld\",&hito);\n\t\t\t\t\tt[hito]+=ten;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tll m1=INF,mi,m2=INF;\n\t\trep(i,1,n+1)if(s[i]<m1){\n\t\t\tm1=s[i];\n\t\t\tmi=i;\n\t\t}\n\t\trep(i,1,n+1)if(i!=mi&&s[i]<m2)m2=s[i];\n\t\t\n\t\tll ans=0;\n\t\trep(i,1,n+1){\n\t\t\tif(i==mi)ans=max(ans,t[i]+s[i]-m2);\n\t\t\telse ans=max(ans,t[i]+s[i]-m1);\n\t\t}\n\t\tprintf(\"%lld\\n\",ans+1);\n\t}\n}\n"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\ntypedef struct{\n    int min;\n    int max;\n}Point;\nint main(void){\n    while(1){\n        int N,M;\n        scanf(\"%d%d\",&N,&M);\n        if(N+M==0) break;\n        Point p[10001]={0};\n        for(int i=0;i<M;i++){\n            int score,k;\n            scanf(\"%d%d\",&score,&k);\n            for(int j=0;j<k;j++){\n                int hito;\n                scanf(\"%d\",&hito);\n                if(k==1){\n                    p[hito].min+=score;\n                    p[hito].max+=score;\n                }\n                else{\n                    p[hito].max+=score;\n                }\n            }\n        }\n        int diff=0;\n        for(int i=1;i<=N;i++){\n            for(int j=1;j<=N;j++){\n                if(i==j) continue;\n                if(diff<p[i].max-p[j].min)\n                    diff=p[i].max-p[j].min;\n            }\n        }\n        /*for(int i=1;i<=N;i++){\n            printf(\"%d %d\\n\",p[i].min,p[i].max);\n        }*/\n        printf(\"%d\\n\",diff+1);\n    }\n}\n\n"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <memory.h>\nint main(void){\n\tint n,m,s,k,c,q[10000],l[10000],i,j,max,min;\n\twhile(1){\n\t\tscanf(\"%d %d\",&n,&m);\n\t\tif(!n) break;\n\t\tmemset(q,0,sizeof(q));\n\t\tmemset(l,0,sizeof(l));\n\t\tfor(i=0;i<m;i++){\n\t\t\tscanf(\"%d %d\",&s,&k);\n\t\t\tfor(j=0;j<k;j++){\n\t\t\t\tscanf(\"%d\",&c);\n\t\t\t\tq[c-1]+=s;\n\t\t\t}\n\t\t\tif(k==1)\n\t\t\t\tl[c-1]+=s;\n\t\t}\n\t\tmax=0;\n\t\tfor(i=0;i<n;i++){\n\t\t\tif(max<q[i])\n\t\t\t\tmax=q[i];\n\t\t}\n\t\tmin=114514;\n\t\tfor(i=0;i<n;i++){\n\t\t\tif(min>l[i]&&max!=q[i])\n\t\t\t\tmin=l[i];\n\t\t}\n\t\tprintf(\"%d\\n\",max-min+1);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "// AOJ 2825: Quiz\n// 2017.12.7 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\nint max[10002], min[10002];\n\nchar buf[60000], *p;\nint getint()\n{\n\tint n = 0;\n\twhile (*p >= '0') n = (n<<3) + (n<<1) + (*p++ & 0xf);\n\tp++;\n\treturn n;\n}\n\nint main()\n{\n\tint n, m, s, k, c, i, pmin, pmax;\n\n\twhile (fgets(p=buf, 20, stdin) && *p != '0') {\n\t\tn = getint(), m = getint();\n\t\tmemset(min, 0, sizeof(min));\n\t\tmemset(max, 0, sizeof(max));\n\n\t\tfor (i = 0; i < m; i++) {\n\t\t\tfgets(p=buf, 60000, stdin);\n\t\t\ts = getint();\n\t\t\tk = getint();\n\t\t\tif (k == 1) min[c = getint()] += s, max[c] += s;\n\t\t\telse while (k--) max[getint()] += s;\n\t\t}\n\n\t\tpmax = -1;\n\t\tfor (i = 1; i <= n; i++) if (max[i] > pmax) pmax = max[i], c = i;\n\n\t\tpmin = 0x7fffffff;\n\t\tfor (i = 1; i <= n; i++) if (i != c && min[i] < pmin) pmin = min[i];\n\n\t\tprintf(\"%d\\n\", pmax - pmin + 1);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "Kotlin",
    "code": "import javax.swing.border.EmptyBorder\n\nfun main(args:Array<String>):Unit{\n    val (n, m) = readLine()!!.split(' ').map(String::toInt)\n    f(n, m)\n}\ntailrec fun f(n:Int, m:Int):Unit{\n    if (n != 0 && m != 0){\n        val maxHighScore = Array(n){0}\n        val minLowScore = Array(n){0}\n        for (i in 1 .. m){\n            val args = readLine()!!.split(' ').map(String::toInt).toIntArray()\n            for (idx in 2 until args.size){\n                maxHighScore[args[idx] - 1] += args[0]\n            }\n            if (args[1] == 1) minLowScore[args[2] - 1] += args[0]\n        }\n        val min = minLowScore.mapIndexed { index, i -> Man(index, i) }.sortedBy(Man::score)\n        val max = maxHighScore.mapIndexed{index, i -> Man(index, i)}.sortedByDescending(Man::score)\n        if (max.first().number != min.first().number){\n            println(max.first().score - min.first().score + 1)\n        }else{\n            println(max(max.first().score - min[1].score, max[1].score - min.first().score) + 1)\n        }\n        val (nn, mm) = readLine()!!.split(' ').map(String::toInt)\n        f(nn, mm)\n    }\n}\nfun max(a:Int, b:Int):Int = if (a > b) a else b\ndata class Man(val number:Int, val score:Int)\n"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Comparator;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tstatic int[][] map;\n\tstatic int[][] directions8= {{-1,-1},{-1,0},{-1,1},{0,-1},{0,1},{1,-1},{1,0},{1,1}};\n\tstatic int[][] directions4= {{-1,0},{1,0},{0,-1},{0,1}};\n\tstatic int ans;\n\n\tpublic static void main(String[] args) {\n\n\t\tScanner sc = new Scanner(System.in);\n\n\t\twhile(true) {\n\n\t\t\tint N = sc.nextInt();\n\t\t\tint M = sc.nextInt();\n\n\t\t\tif((N|M)==0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tint[] S = new int[M];\n\t\t\tint[] k = new int[M];\n\t\t\tKaitousha[] maxScores = new Kaitousha[N];\n\t\t\tfor(int i = 0; i < N; i++) {\n\t\t\t\tmaxScores[i] = new Kaitousha();\n\t\t\t\tmaxScores[i].idx = i;\n\t\t\t}\n\t\t\tKaitousha[] minScores = new Kaitousha[N];\n\t\t\tfor(int i = 0; i < N; i++) {\n\t\t\t\tminScores[i] = new Kaitousha();\n\t\t\t\tminScores[i].idx = i;\n\t\t\t}\n\t\t\tfor(int i = 0; i < M; i++) {\n\t\t\t\tS[i]=sc.nextInt();\n\t\t\t\tk[i] = sc.nextInt();\n\t\t\t\tfor(int j = 0; j <k[i]; j++) {\n\t\t\t\t\tint c = sc.nextInt()-1;\n\t\t\t\t\tmaxScores[c].score+=S[i];\n\t\t\t\t\tif(k[i] == 1) {\n\t\t\t\t\t\tminScores[c].score += S[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tArrays.sort(maxScores, Comparator.reverseOrder());\n\t\t\tArrays.sort(minScores);\n\n\t\t\tlong ans = maxScores[0].score - minScores[0].score;\n\n\t\t\tif(maxScores[0].idx == minScores[0].idx) {\n\t\t\t\tlong p1 = maxScores[1].score - minScores[0].score;\n\t\t\t\tlong p2 = maxScores[0].score - minScores[1].score;\n\n\t\t\t\tans = Math.max(p1, p2);\n\n\t\t\t}\n\t\t\tSystem.out.println(ans+1);\n\t\t}\n\t}\n\n\t//BFS用に二つの配列を足し算する\n\tstatic int[] addArrayElms(int[] a, int[] b) {\n\t\tint[] c = new int[a.length];\n\t\tfor(int i = 0; i < a.length; i++) {\n\t\t\tc[i] = a[i] + b[i];\n\t\t}\n\t\treturn c;\n\t}\n\n//\t//二分探索\n\t//k <= num となる最小の配列要素kのインデックスを返す\n\tstatic private int binarySearch(long num, long[] orderedArray){\n\t\tint lowerBorder = -1;\n\t\tint upperBorder = orderedArray.length;\n\t\tint mid;\n\n\t\twhile(upperBorder - lowerBorder >1) {\n\t\t\tmid = (upperBorder + lowerBorder)/2;\n\t\t\tif(orderedArray[mid]<=num) {\n\t\t\t\tlowerBorder = mid;\n\t\t\t}else {\n\t\t\t\tupperBorder = mid;\n\t\t\t}\n\t\t}\n\t\treturn lowerBorder;\n\t}\n\n\t//二分探索\n\t//k <= num となる最小のList要素kのインデックスを返す\n\tstatic private int binarySearch(long num, ArrayList<Long> orderedList){\n\t\tint lowerBorder = -1;\n\t\tint upperBorder = orderedList.size();\n\t\tint mid;\n\n\t\twhile(upperBorder - lowerBorder >1) {\n\t\t\tmid = (upperBorder + lowerBorder)/2;\n\t\t\tif(orderedList.get(mid)<=num) {\n\t\t\t\tlowerBorder = mid;\n\t\t\t}else {\n\t\t\t\tupperBorder = mid;\n\t\t\t}\n\t\t}\n\t\treturn lowerBorder;\n\t}\n\n\t//aとbの最小公倍数を求める\n\tpublic static int gcd(int a, int b) {\n\t\treturn b == 0 ? a: gcd(b, a % b);\n\t}\n\tpublic static long gcd(long a, long b) {\n\t\treturn b == 0 ? a: gcd(b, a % b);\n\t}\n}\n\nclass Kaitousha implements Comparable<Kaitousha>{\n\tint idx;\n\tlong score;\n\t@Override\n\tpublic int compareTo(Kaitousha o) {\n\t\tif(this.score < o.score) {\n\t\t\treturn -1;\n\t\t}else if(this.score > o.score){\n\t\t\treturn 1;\n\t\t}else {\n\t\t\treturn 0;\n\t\t}\n\t}\n}\n\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main{\n\tpublic static void main(String[] args){\n\t\ttry(Scanner sc = new Scanner(System.in)){\n\t\t\twhile(true){\n\t\t\t\tint N = sc.nextInt(), M = sc.nextInt();\n\t\t\t\tif(N == 0 && M == 0){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tint[] Vmin = new int[N], Vmax = new int[N];\n\t\t\t\t\n\t\t\t\tfor(int i = 0; i < M; i++){\n\t\t\t\t\tint v = sc.nextInt();\n\t\t\t\t\tint num = sc.nextInt();\n\t\t\t\t\tfor(int j = 0; j < num; j++){\n\t\t\t\t\t\tint p = sc.nextInt() - 1;\n\t\t\t\t\t\tVmax[p] += v;\n\t\t\t\t\t\tif(num == 1){\n\t\t\t\t\t\t\tVmin[p] += v;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tint ansmin = 0, ansmax = 0;\n\t\t\t\tfor(int i = 0; i < N; i++){\n\t\t\t\t\tif(Vmax[i] > Vmax[ansmax]){\n\t\t\t\t\t\tansmax = i;\n\t\t\t\t\t} else if(Vmin[i] < Vmin[ansmin]){\n\t\t\t\t\t\tansmin = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tSystem.out.println(Vmax[ansmax] - Vmin[ansmin] + 1);\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Scanner;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tArrayList<Integer> result = new ArrayList<Integer>();\n\t\tScanner insert = new Scanner(System.in);\n\t\tint n = -1;\n\t\tint m = -1;\n\t\twhile(true) {\n\t\t\tif((n==0) && (m==0)) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tString line = insert.nextLine();\n\t\t\tString array1[] = line.split(\" \");\n\t\t\tn = Integer.parseInt(array1[0]);\n\t\t\tm = Integer.parseInt(array1[1]);\n\t\t\tint[] min = new int[n];\n\t\t\tint[] max = new int[n];\n\t\t\tint sum = 0;\n\t\t\tfor(int i =0; i < m; i++) {\n\t\t\t\tString line2 = insert.nextLine();\n\t\t\t\tString array2[] = line2.split(\" \");\n\t\t\t\tint s = Integer.parseInt(array2[0]);\n\t\t\t\tint ninzu = Integer.parseInt(array2[1]);\n\t\t\t\tsum+= s;\n\t\t\t\tif(ninzu == 1) {\n\t\t\t\t\tmin[Integer.parseInt(array2[2]) - 1] +=s;\n\t\t\t\t\tmax[Integer.parseInt(array2[2]) - 1] +=s;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfor(int j = 0; j < ninzu; j++) {\n\t\t\t\t\t\tmax[Integer.parseInt(array2[j+2]) - 1] +=s;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tint minN =sum;\n\t\t\tint maxN = 0;\n\t\t\tint index = -1;\n\t\t\tfor(int i =0;i < n; i++) {\n\n\t\t\t\tif(maxN < max[i]) {\n\t\t\t\t\tmaxN = max[i];\n\t\t\t\t\tindex = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i =0;i < n; i++) {\n\n\t\t\t\tif((i != index) && (minN > min[i])) {\n\t\t\t\t\tminN = min[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tresult.add(maxN - minN +1);\n\t\t}\n\t\tfor(int i = 0;i < (result.size() - 1);i++) {\n\t\t\tSystem.out.println(result.get(i));\n\t\t}\n\n\t}\n\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.io.PrintWriter;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n    public static void main(String[] args) {\n        Scanner in = new Scanner(System.in);\n        PrintWriter out = new PrintWriter(System.out);\n\n        int n = in.nextInt(), m = in.nextInt();\n        while (n != 0 && m != 0) {\n            long[] p = new long[n];\n            long[] q = new long[n];\n            for (int i = 0; i < m; i++) {\n                int s = in.nextInt();\n                int k = in.nextInt();\n                if (k == 1) {\n                    int c = in.nextInt() - 1;\n                    q[c] += s;\n                    p[c] += s;\n                } else {\n                    for (int j = 0; j < k; j++) {\n                        p[in.nextInt() - 1] += s;\n                    }\n                }\n            }\n\n            long[] pl = new long[n + 1], pr = new long[n + 1];\n            for (int i = 0; i < n; i++) {\n                pl[i + 1] = Math.max(pl[i], p[i]);\n            }\n            for (int i = n - 1; i >= 0; i--) {\n                pr[i] = Math.max(pr[i + 1], p[i]);\n            }\n            long ans = 0;\n            for (int i = 0; i < n; i++) {\n                ans = Math.max(ans, 1 + Math.max(pl[i], pr[i + 1]) - q[i]);\n            }\n            out.println(ans);\n\n            n = in.nextInt();\n            m = in.nextInt();\n        }\n        out.close();\n    }\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\npublic class Main{\n\tpublic static void main(String[] args){\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\t\t\tint m = sc.nextInt();\n\t\t\tif(n == 0){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlong[][] score = new long[2][n];\n\t\t\tfor(int i = 0;i < m;i++){\n\t\t\t\tint s = sc.nextInt();\n\t\t\t\tint k = sc.nextInt();\n\t\t\t\tint[] c = new int[k];\t\n\t\t\t\tfor(int j = 0;j < k;j++){\n\t\t\t\t\tc[j] = sc.nextInt()-1;\n\t\t\t\t\tscore[0][c[j]] += s;\n\t\t\t\t}\n\t\t\t\tif(k == 1) {\n\t\t\t\t\tscore[1][c[0]] += s;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlong max = 0;\n\t\t\tint maxIndex = 0;\n\t\t\tlong max2 = 0;\n\t\t\tint maxIndex2 = 0;\n\t\t\tfor(int i = 0;i < n;i++){\n\t\t\t\tif(score[0][i] >= max){\n\t\t\t\t\tmax = score[0][i];\n\t\t\t\t\tmaxIndex = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0;i < n;i++){\n\t\t\t\tif(i == maxIndex){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(score[0][i] >= max2){\n\t\t\t\t\tmax2 = score[0][i];\n\t\t\t\t\tmaxIndex2 = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlong min = Long.MAX_VALUE;\n\t\t\tint minIndex = 0;\n\t\t\tlong min2 = Long.MAX_VALUE;\n\t\t\tint minIndex2 = 0;\n\t\t\tfor(int i = 0;i < n;i++){\n\t\t\t\tif(score[1][i] <= min){\n\t\t\t\t\tmin = score[1][i];\n\t\t\t\t\tminIndex = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0;i < n;i++){\n\t\t\t\tif(i == minIndex){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(score[1][i] <= min2){\n\t\t\t\t\tmin2= score[1][i];\n\t\t\t\t\tminIndex2 = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlong ans = 0;\n\t\t\tif(minIndex == maxIndex){\n\t\t\t\tans = max2 - min+1;\n\t\t\t\tans = Math.max(ans,max - min2+1);\t\n\t\t\t\tSystem.out.println(ans);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tans = max - min +1;\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n}\n\n"
  },
  {
    "language": "C#",
    "code": "using System.Linq;\nusing System;\n\npublic class P\n{\n    public int id { get; set; }\n    public int p { get; set; }\n}\n\npublic class hello\n{\n    public static void Main()\n    {\n        while (true)\n        {\n            string[] line = Console.ReadLine().Trim().Split(' ');\n            var n = int.Parse(line[0]);\n            var m = int.Parse(line[1]);\n            if (n == 0 && m == 0) break;\n            var ps = new P[n];\n            for (int i = 0; i < n; i++) ps[i] = new P { id = i };\n            var minp = new int[n];\n            for (int i = 0; i < m; i++)\n            {\n                line = Console.ReadLine().Trim().Split(' ');\n                var s = int.Parse(line[0]);\n                var k = int.Parse(line[1]);\n                for (int j = 0; j < k; j++)\n                {\n                    var w = int.Parse(line[j + 2]) - 1;\n                    ps[w].p += s;\n                    if (k == 1) minp[w] += s;\n                }\n            }\n            var res = getAns(ps, minp);\n            Console.WriteLine(res);\n        }\n    }\n    public static int getAns(P[] ps, int[] minp)\n    {\n        var w = ps.OrderByDescending(x => x.p).ToArray();\n        var no1p = w[0].p;\n        var no1pid = w[0].id;\n        var no2p = w[1].p;\n        var ret = 0;\n        for (int i = 0; i < minp.Length; i++)\n            if (i != no1pid)\n            {\n                var t = no1p - minp[i] + 1;\n                ret = Math.Max(ret, t);\n            }\n            else\n            {\n                var t = no2p - minp[i] + 1;\n                ret = Math.Max(ret, t);\n            }\n        return ret;\n    }\n}\n"
  },
  {
    "language": "JavaScript",
    "code": "var input = require('fs').readFileSync('/dev/stdin', 'utf8');\nvar arr = input.trim().split(\"\\n\");\nwhile (true) {\n   if (arr[0] == \"0 0\") break;\n   var nm = arr.shift().split(\" \").map(Number);\n   var point = [];\n   for (var i = 0; i < nm[0]; i++) point[i] = [0, 0];\n   for (var i = 0; i < nm[1]; i++) {\n      var c = arr.shift().split(\" \").map(Number);\n      var s = c.shift();\n      var k = c.shift();\n      if (k == 1) point[c[0] - 1][0] += s;\n      c.forEach(function(v, i) {\n         point[v - 1][1] += s;\n      });\n   }\n   var max = 0;\n   for (var i = 0; i < nm[0]; i++) {\n      for (var j = 0; j < nm[0]; j++) {\n         if (i == j) continue;\n         max = Math.max(max, point[i][1] - point[j][0]);\n      }\n   }\n   console.log(max + 1);\n}"
  },
  {
    "language": "Ruby",
    "code": "while 1\n    n, m = gets.split.map(&:to_i)\n    break if n == 0\n    min = {}\n    max = {}\n    (1..n).each {|i| min[i] = max[i] = 0}\n    m.times do\n        s, k, *cs = gets.split.map(&:to_i)\n        min[cs[0]] += s if k == 1\n        cs.each do |c|\n            max[c] += s\n        end\n    end\n    min_key, second_min_key = min.keys.sort_by {|i| min[i]}[0..1]\n    second_max_key, max_key = max.keys.sort_by {|i| max[i]}[-2..-1]\n    if min_key != max_key\n        p max[max_key] - min[min_key] + 1\n    else\n        p [max[max_key] - min[second_min_key], max[second_max_key] - min[min_key]].max + 1\n    end\nend\n"
  },
  {
    "language": "Python",
    "code": "import sys\ndef solve(n,m):\n    d = [0]*n\n    d_ = [0]*n\n    for i in range(m):\n        p = [int(x) for x in sys.stdin.readline().split()]\n        for c in p[2:]:\n            d[c-1] += p[0]\n        if len(p) == 3:\n            d_[p[2]-1] += p[0]\n    ma = max(d)\n    mi = min(d_)\n    for i in range(n):\n        if d[i] == ma:\n            if d_[i] != mi:\n                print(ma-mi+1)\n                return\n        else:\n            if d_[i] == mi:\n                print(ma-mi+1)\n                return\n    d.sort()\n    d_.sort()\n    print(max(d[-2]-mi,ma-d_[1])+1)\nwhile 1:\n    n,m = [int(x) for x in sys.stdin.readline().split()]\n    if n == 0:\n        break\n    solve(n,m)\n\n"
  },
  {
    "language": "Python",
    "code": "#!/usr/bin/env python3\n#AOJ C\n\nwhile 1:\n    N,M = map(int,input().split())\n    if N == 0 and M == 0:\n        break\n    I = [list(map(int,input().split())) for _ in range(M)]\n    P = [0 for _ in range(N)]\n    mP = [0 for _ in range(N)]\n    for i in range(M):\n        k = I[i][1]\n        if k == 1:\n            mP[I[i][2]-1] += I[i][0]\n        for j in range(k):\n            P[I[i][2+j]-1] += I[i][0]\n    maxp = 0\n    minp = float(\"inf\")\n    for i in range(N):\n        if maxp < P[i]:\n            maxp = P[i]\n            index = i\n    for i in range(N):\n        if i != index:\n            if minp > mP[i]:\n                minp = mP[i]\n    f = 0\n    for i in range(N):\n        if i != index:\n            if mP[i] == 0:\n                f = 1\n    if f:\n        print(max(P)+1)\n    else:\n        print(max(P)+1-minp)\n\n"
  },
  {
    "language": "Python",
    "code": "while True:\n  N, M = map(int, input().split())\n  if N==M==0:\n    break\n  Mi = [0] * N\n  Ma = [0] * N\n  for _ in range(M):\n    L = list(map(int, input().split()))\n    s, k = L[:2]\n    if k==1:\n      Mi[L[2]-1] += s\n    for c in L[2:]:\n      Ma[c-1] += s\n  Mi_ = sorted(zip(Mi, range(N)))\n  Ma_ = sorted(zip(Ma, range(N)))\n  ans = Ma_[-1][0] - Mi_[0][0]\n  #print(Ma, Mi)\n\n  if Ma_[-1][1] == Mi_[0][1]:\n    ans = max(Ma_[-1][0] - Mi_[1][0], Ma_[-2][0] - Mi_[0][0])\n  print(ans + 1)\n\n"
  },
  {
    "language": "Python",
    "code": "def main_a():\n    y, m, d = map(int, input().split())\n    a = (y - 1) // 3\n    b = (y - 1) % 3\n    c = a * 590 + 195 * b \n    if y % 3:\n        a = (m - 1) // 2\n        b = (m - 1) % 2\n        c += a * 39 + b * 20\n    else:\n        c += (m - 1) * 20\n    c += d - 1\n    print(196470 - c)\ndef a():\n    n = int(input())\n    for i in range(n):\n        main_a()\n\ndef main_b():\n    s = input()\n    ans = []\n    for i in range(1,len(s)):\n        ans.append(s[:i] + s[i:])\n        ans.append(s[i-1::-1] + s[i:])\n        ans.append(s[i-1::-1] + s[len(s):i-1:-1])\n        ans.append(s[:i] + s[len(s):i - 1:-1])\n        ans.append(s[i:] + s[:i])\n        ans.append(s[i:] + s[i - 1::-1])\n        ans.append(s[len(s):i - 1:-1] + s[i - 1::-1])\n        ans.append(s[len(s):i - 1:-1] + s[:i])\n    print(len(set(ans)))\n\ndef b():\n    n = int(input())\n    for i in range(n):\n        main_b()\n\ndef main_c(n, m):\n    a = [0] * n\n    s = [0] * n\n    for _ in range(m):\n        skc = list(map(int, input().split()))\n        si = skc[0]\n        c = skc[2:]\n        if skc[1] == 1:\n            s[c[0] - 1] += si\n        for i in c:\n            a[i-1] += si\n    an = max(a)\n    anindex = a.index(an)\n\n    sm = 10**20\n    for i in range(n):\n        if i != anindex:\n            if sm > s[i]:\n                sm = s[i]\n\n    flg = False\n \n    for i in range(n):\n        if i != anindex:\n            if s[i] == 0:\n                flg = True\n    if flg:\n        ans = an + 1\n    else:\n        ans = an + 1 - sm\n    print(ans)\n\n\ndef c():\n    while 1:\n        n, m = map(int, input().split())\n        if n == m == 0:\n            return\n        main_c(n,m)\n\nc()\n"
  },
  {
    "language": "Python",
    "code": "while True:\n  n, m = map(int, input().split())\n  if n == 0:break\n  max_score = [0] * n\n  min_score = [0] * n\n  for _ in range(m):\n    line = list(map(int, input().split()))\n    s, k = line[:2]\n    for i in line[2:]:\n      max_score[i - 1] += s\n    if k == 1:\n      min_score[line[2] - 1] += s\n  \n  print(max([max_score[i] - min(min_score[:i] + min_score[i + 1:]) + 1 for i in range(n)]))\n"
  },
  {
    "language": "Python",
    "code": "import sys\n\n\ndef solve(n, m, s, k, c):\n    maxvs = [0] * (n + 1)\n    minvs = [0] * (n + 1)\n    for i in enumerate(c):\n        for j in i[1]:\n            maxvs[j] += s[i[0]]\n            if k[i[0]] == 1:\n                minvs[j] += s[i[0]]\n\n\n\n    # maxmaxvs = max(maxvs)\n    # print(maxvs)\n    # print(minvs)\n    # print(max(maxvs) - min(minvs[1:]) + 1)\n    ans = -1\n    for i in range(1,  n+1):\n        ans = max(ans, maxvs[i]-min(minvs[1:i]+minvs[i+1:]))\n    print(ans+1)\n\n\n\n\n\nwhile True:\n    N, M = map(int, input().split())\n    if N == M == 0:\n        break\n    S = []\n    K = []\n    C = []\n    for i in range(M):\n        Skc = list(map(int, input().split()))\n        S.append(Skc[0])\n        K.append(Skc[1])\n        C.append(Skc[2:])\n    solve(N, M, S, K, C)\n\n"
  },
  {
    "language": "Python",
    "code": "from collections import defaultdict,deque\nimport sys,heapq,bisect,math,itertools,string,queue,copy,time\nsys.setrecursionlimit(10**8)\nINF = float('inf')\nmod = 10**9+7\neps = 10**-7\ndef inp(): return int(input())\ndef inpl(): return list(map(int, input().split()))\ndef inpl_str(): return list(input().split())\n\nwhile True:\n    N,M = inpl()\n    if N == 0 and M == 0:\n        break\n    else:\n        MINlist = [[0,i] for i in range(N)]\n        MAXlist = [[0,i] for i in range(N)]\n        for _ in range(M):\n            arg = inpl()\n            s = arg[0]\n            k = arg[1]\n            cc = arg[2:]\n            for c in cc:\n                MAXlist[c-1][0] += s\n            if k == 1:\n                MINlist[c-1][0] += s\n\n        MINlist.sort()\n        MAXlist.sort(reverse=True)\n        MinVal1,MinId1 = MINlist[0]\n        MinVal2,MinId2 = MINlist[1]\n        MaxVal1,MaxId1 = MAXlist[0]\n        MaxVal2,MaxId2 = MAXlist[1]\n        if MinId1 != MaxId1:\n            print(MaxVal1-MinVal1+1)\n        else:\n            print(max(MaxVal2-MinVal1,MaxVal1-MinVal2)+1)\n\n"
  },
  {
    "language": "Python",
    "code": "def main():\n    while(True):\n        N, M = map(int, input().split())\n        if(N == 0 and M == 0):\n            return\n        skc = []\n        for i in range(M):\n            skc.append(list(map(int, input().split())))\n        point = [0 for i in range(N)]\n        for i in range(M):\n            for j in range(2, len(skc[i])):\n                point[skc[i][j] - 1] += skc[i][0]\n        point_fixed = [0 for i in range(N)]\n        for i in range(M):\n            if(skc[i][1] == 1):\n                point_fixed[skc[i][2] - 1] += skc[i][0]\n        maxPlayer = 0\n        Max = 0\n        for i in range(N):\n            if(Max < point[i]):\n                Max = point[i]\n                maxPlayer = i + 1\n        minPlayer = 0\n        Min = 1e9\n        for i in range(N):\n            if(i + 1 == maxPlayer):\n                continue\n            if(Min > point_fixed[i]):\n                Min = point_fixed[i]\n                minPlayer = i + 1        \n        print(point[maxPlayer - 1] - point_fixed[minPlayer - 1] + 1)\n\nif __name__ == '__main__':\n    main()\n"
  },
  {
    "language": "Python",
    "code": "while 1:\n    n,m=map(int,input().split())\n    if n==m==0:break\n    p_max=[0]*(n)\n    p_min=[0]*(n)\n    for i in range(m):\n        quiz=list(map(int,input().split()))\n        for j in quiz[2:]:\n            p_max[j-1]+=quiz[0]\n        if quiz[1]==1:\n            p_min[j-1]+=quiz[0]\n    pmax=max(p_max)\n    while p_max.count(pmax)==1:\n        k=p_max.index(pmax)\n        del p_max[k]\n        del p_min[k]\n    print(pmax-min(p_min)+1)\n"
  },
  {
    "language": "Python",
    "code": "while True:\n    n, m = map(int, input().split())\n    if n == 0:break\n    minp = [0] * (n + 1)\n    minp[0] = 1e10\n    maxp = [0] * (n + 1)\n    for _ in range(m):\n        s, k, *c =  map(int, input().split())\n        if k == 1:\n            minp[c[0]] += s\n        for i in range(k):\n            maxp[c[i]] += s\n    p = list(zip(maxp, minp))\n    p.sort(key = lambda x:x[1])\n    p.sort(key = lambda x:x[0], reverse = True)\n    p.pop()\n    s = 0\n    for i in range(n - 1):\n        if p[i][0] <= s:break\n        for j in range(i + 1, n):\n            s = max(s, p[i][0] - p[j][1])\n    print(s + 1)\n"
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,random,time,copy,functools\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 10**9+7\ndd = [(-1,0),(0,1),(1,0),(0,-1)]\nddn = [(-1,0),(-1,1),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1)]\n\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\n\n\ndef main():\n    rr = []\n\n    def f(n,m):\n        xd = collections.defaultdict(int)\n        nd = collections.defaultdict(int)\n        for i in range(1,n+1):\n            nd[i] = 0\n            xd[i] = 0\n\n        for _ in range(m):\n            t = LI()\n            s = t[0]\n            if t[1] == 1:\n                nd[t[2]] += s\n            for i in t[2:]:\n                xd[i] += s\n\n        na = sorted(nd.items(), key=lambda x: [x[1], x[0]])\n        xa = sorted(xd.items(), key=lambda x: [-x[1], x[0]])\n        if na[0][0] != xa[0][0]:\n            return xa[0][1] - na[0][1] + 1\n        r = xa[1][1] - na[0][1] + 1\n        t = xa[0][1] - na[1][1] + 1\n        if r < t:\n            r = t\n\n        return r\n\n    while 1:\n        n,m = LI()\n        if n == 0:\n            break\n        rr.append(f(n,m))\n\n    return '\\n'.join(map(str, rr))\n\n\nprint(main())\n\n"
  },
  {
    "language": "Python",
    "code": "# AOJ 2825: Quiz\n# Python3 2018.7.12 bal4u\n\nwhile True:\n\tN, M = map(int, input().split())\n\tif N == 0: break\n\tmi, ma = [0]*N, [0]*N\n\tfor i in range(M):\n\t\ta = list(map(int, input().split()))\n\t\tS = a.pop(0)\n\t\tK = a.pop(0)\n\t\tif K == 1:\n\t\t\tmi[a[0]-1] += S\n\t\t\tma[a[0]-1] += S\n\t\telse:\n\t\t\tfor j in a: ma[j-1] += S\n\tvmax = max(ma)\n\tmi.pop(ma.index(vmax))\n\tvmin = min(mi)\n\tprint(vmax-vmin+1)\n"
  },
  {
    "language": "Rust",
    "code": "use std::cmp;\n\nfn main() {\n    let (r, w) = (std::io::stdin(), std::io::stdout());\n    let mut sc = IO::new(r.lock(), w.lock());\n    loop {\n        let n: usize = sc.read();\n        let m: usize = sc.read();\n        if n == 0 {\n            return;\n        }\n        let mut max = vec![0; n];\n        let mut min = vec![0; n];\n        for _ in 0..m {\n            let s: u64 = sc.read();\n            let k: usize = sc.read();\n            for _ in 0..k {\n                let i = sc.read::<usize>() - 1;\n                max[i] += s;\n                if k == 1 {\n                    min[i] += s;\n                }\n            }\n        }\n\n        let mut ans = 0;\n        for i in 0..n {\n            let min = min[i];\n            let mut max_max = 0;\n            for j in 0..n {\n                if i == j {\n                    continue;\n                }\n                max_max = cmp::max(max_max, max[j]);\n            }\n\n            if max_max >= min {\n                ans = cmp::max(ans, max_max - min);\n            }\n        }\n\n        println!(\"{}\", ans + 1);\n    }\n}\n\npub struct IO<R, W: std::io::Write>(R, std::io::BufWriter<W>);\n\nimpl<R: std::io::Read, W: std::io::Write> IO<R, W> {\n    pub fn new(r: R, w: W) -> Self {\n        IO(r, std::io::BufWriter::new(w))\n    }\n    pub fn write<S: ToString>(&mut self, s: S) {\n        use std::io::Write;\n        self.1.write_all(s.to_string().as_bytes()).unwrap();\n    }\n    pub fn read<T: std::str::FromStr>(&mut self) -> T {\n        use std::io::Read;\n        let buf = self\n            .0\n            .by_ref()\n            .bytes()\n            .map(|b| b.unwrap())\n            .skip_while(|&b| b == b' ' || b == b'\\n' || b == b'\\r' || b == b'\\t')\n            .take_while(|&b| b != b' ' && b != b'\\n' && b != b'\\r' && b != b'\\t')\n            .collect::<Vec<_>>();\n        unsafe { std::str::from_utf8_unchecked(&buf) }\n            .parse()\n            .ok()\n            .expect(\"Parse error.\")\n    }\n    pub fn vec<T: std::str::FromStr>(&mut self, n: usize) -> Vec<T> {\n        (0..n).map(|_| self.read()).collect()\n    }\n    pub fn chars(&mut self) -> Vec<char> {\n        self.read::<String>().chars().collect()\n    }\n}\n\n"
  }
]