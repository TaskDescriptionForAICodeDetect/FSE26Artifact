In a supermarket, a strategy meeting is held to determine the optimal order for purchasing items during a time sale to maximize discounts. The supermarket has a grid layout where various items can be picked up, but there are restrictions on the time when items can be acquired. You need to write a program that, given the layout of the supermarket and the time sale information, calculates the maximum sum of discount values that can be obtained. The grid features aisles and shelves with items identified by their numbers. Movement is restricted to adjacent aisle cells, and item picking timing is governed by sale start and end times. Multiple datasets will be provided, concluded with two zeroes. Your output should be the maximum discount value for each dataset.