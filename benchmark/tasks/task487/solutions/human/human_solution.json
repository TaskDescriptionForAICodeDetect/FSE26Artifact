[
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n#include<sstream>\n#define fs first\n#define sc second\nusing namespace std;\n \ntypedef pair<char,int> Run;\ntypedef vector<Run> RLE;\n \nRLE decode(string s){\n  stringstream ss(s);\n  int l;\n  RLE res;\n \n  ss >> s;\n  while(s!=\"$\"){\n    ss >> l;\n    res.push_back(make_pair(s[0],l));\n    ss >> s;\n  }\n  return res;\n}\n \nint main(){\n  string a,b,c;\n  RLE ra,rb,rc;\n \n  while(getline(cin,a)){\n    //input\n    ra = decode(a);\n    getline(cin,b);\n    rb = decode(b);\n    getline(cin,c);\n    rc = decode(c);\n \n    int n = ra.size(), m = rb.size();\n    \n    if(m==1){\n      for(int i=0;i<n;i++){\n\t//check matching\n\tif(ra[i].fs == rb[0].fs && ra[i].sc >= rb[0].sc){\n\t  //replace\n\t  RLE tmp;\n\t  for(int j=0;j<i;j++)tmp.push_back(ra[j]);\n\t  for(int j=0;j<(int)rc.size();j++)tmp.push_back(rc[j]);\n\t  if(ra[i].sc > rb[0].sc){\n\t    tmp.push_back(make_pair(ra[i].fs, ra[i].sc - rb[0].sc));\n\t  }\n\t  for(int j=i+1;j<n;j++)tmp.push_back(ra[j]);\n\t  ra = tmp;\n\t  break;\n\t}\n      }\n    }else{\n      for(int i=0;i<n-m+1;i++){\n\t//check matching\n\tbool f = true;\n\tif(ra[i].fs != rb[0].fs || ra[i].sc < rb[0].sc)f = false;\n\tfor(int j=1;j<m-1;j++){\n\t  if(ra[i+j].fs != rb[j].fs || ra[i+j].sc != rb[j].sc)f = false;\n\t}\n\tif(ra[i+m-1].fs != rb[m-1].fs || ra[i+m-1].sc < rb[m-1].sc)f = false;\n\t\n\tif(f){\n\t  //replace\n\t  RLE tmp;\n\t  for(int j=0;j<i;j++)tmp.push_back(ra[j]);\t  \n\t  if(ra[i].sc != rb[0].sc){\n\t    tmp.push_back(make_pair(ra[i].fs,ra[i].sc-rb[0].sc));\n\t  }\n\t  for(int j=0;j<(int)rc.size();j++)tmp.push_back(rc[j]);\n\t  if(ra[i+m-1].sc != rb[m-1].sc){\n\t    tmp.push_back(make_pair(ra[i+m-1].fs,ra[i+m-1].sc-rb[m-1].sc));\n\t  }\n      \t  for(int j=i+m;j<n;j++)tmp.push_back(ra[j]);\n\t  ra = tmp;\n\t  break;\n\t}\n      }\n    }\n \n    //output with modifying\n    char c = ra[0].fs;\n    int l = ra[0].sc;\n    for(int i=1;i<(int)ra.size();i++){\n      if(ra[i].fs == c){\n\tl += ra[i].sc;\n      }else{\n\tcout << c << \" \" << l << \" \";\n\tc = ra[i].fs; l = ra[i].sc;\n      }\n    }\n    cout << c << \" \" << l << \" $\" << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-9;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\nvector<pair<char, int>>comp(vector<pair<char, int>>ps) {\n\tvector<pair<char, int>>newps;\n\tfor (int i = 0; i < ps.size(); ++i) {\n\t\tif (i==ps.size()-1||ps[i].first != ps[i + 1].first) {\n\t\t\tif (ps[i].second) {\n\t\t\t\tnewps.push_back(ps[i]);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tps[i + 1].second += ps[i].second;\n\t\t}\n\t}\n\tps = newps;\n\tnewps.clear();\n\tfor (int i = 0; i < ps.size(); ++i) {\n\t\tif (i == ps.size() - 1 || ps[i].first != ps[i + 1].first) {\n\t\t\tif (ps[i].second) {\n\t\t\t\tnewps.push_back(ps[i]);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tps[i + 1].second += ps[i].second;\n\t\t}\n\t}\n\treturn newps;\n}\nvoid input(vector<pair<char, int>>&p) {\n\twhile (1) {\n\t\tchar c; cin >> c;\n\t\tif (c == '$')break;\n\t\tint n; cin >> n;\n\t\tp.push_back(make_pair(c, n));\n\t}\n}\nint main() {\n\tvector<pair<char, int>>a, b, c;\n\tinput(a); input(b); input(c);\n\ta = comp(a); b = comp(b); c = comp(c);\n\tif (a.size() < b.size()) {\n\n\t}else\n\tif (b.size() == 1) {\n\t\tfor (int i = 0; i < a.size(); ++i) {\n\t\t\tif (a[i].first == b[0].first&&a[i].second>=b[0].second) {\n\t\t\t\ta[i].second -= b[0].second;\n\t\t\t\ta.insert(a.begin() + i, c.begin(),c.end());\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tfor (int l = 0; l <= a.size() - b.size(); ++l) {\n\t\t\tbool aok = true;\n\t\t\tif (a[l].first != b[0].first||a[l].second < b[0].second) {\n\t\t\t\taok = false;\n\t\t\t}\n\t\t\tfor (int i = 1; i < b.size() - 1; ++i) {\n\t\t\t\tif (a[l + i] != b[i]) {\n\t\t\t\t\taok = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (a[l+b.size()-1].first != b[b.size()-1].first || a[l + b.size() - 1].second < b[b.size() - 1].second) {\n\t\t\t\taok = false;\n\t\t\t}\n\t\t\tif (aok) {\n\t\t\t\ta[l].second -= b[0].second;\n\t\t\t\ta[l + b.size() - 1].second -= b[b.size() - 1].second;\n\t\t\t\ta.erase(a.begin() + l + 1, a.begin() + l + b.size() - 1);\n\t\t\t\ta.insert(a.begin() + l + 1, c.begin(), c.end());\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\ta = comp(a);\n\tfor (int i = 0; i < a.size(); ++i) {\n\t\tcout << a[i].first << \" \" << a[i].second << \" \";\n\t}\n\tcout << \"$\" << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\n\n\nvector<P>A,B,C;\n\nvoid input(vector<P> &a){\n  int num;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin>>num;\n    a.push_back(P(ch,num));\n  }\n}\n\nbool check(int i){\n  int n = A.size();\n  int m = B.size();\n  if(i+m>=n) return 0;\n  if(A[i].first!=B[0].first||A[i].second<B[0].second)return 0;\n  if(m == 1) return 1;\n\n  i++;\n  for(int j=1;i<m-1;j++,i++)\n    if(A[i].first!=B[j].first||A[i].second!=B[j].second)return 0;\n  \n  if(A[i].first!=B[m-1].first||A[i].second<B[m-1].second)return 0;\n  return 1;\n}\n\nvoid mergePush(vector<P> &res,P a){\n  int c = a.second;\n  char ch = a.first;\n  if(c == 0)return;\n  if(res.size() && res.back().first == ch)res.back().second+=c;\n  else res.push_back(P(ch,c));\n}\n\nvector<P> solve(){\n  vector<P> res;\n  int n = A.size();\n  int m = B.size();\n  int l = C.size();\n  for(int i=0;i<n;i++){\n    if(A[i].second == 0) continue;\n    if(!check(i)){mergePush(res,A[i]);continue;}\n    \n    mergePush(res,P(A[i].first,A[i].second - B[0].second));   \n    for(int j=0;j<l;j++) mergePush(res,C[j]);\n    i+=m-1;\n    A[i--].second -= B.back().second;\n    \n    }\n  return res;\n}\n\n\nint main(){\n  input(A);\n  input(B);\n  input(C);\n  assert(B.size()>1);\n  vector<P> ans = solve();\n  for(P a:ans) cout<<a.first<<\" \"<<a.second<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\nusing namespace std;\n \n#define REP(i,n) for(int i=0; i<n; ++i)\n#define FOR(i,a,b) for(int i=a; i<=b; ++i)\n#define FORR(i,a,b) for (int i=a; i>=b; --i)\n \ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef vector<VI> VVI;\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> PL;\n\nifstream ifs(\"in.txt\");\n\nvoid inp(vector<pair<char, int> > &a){\n    while (1){\n        char c;\n        cin >> c;\n        if (c == '$') break;\n        int x;\n        cin >> x;\n        a.push_back(make_pair(c, x));\n    }\n}\n\nint main() {\n    vector<pair<char, int> > a, b, c, res, ans;\n    inp(a);\n    inp(b);\n    inp(c);\n    REP(i,(int)a.size() - (int)b.size() + 1){\n        bool f = true;\n        REP(j,b.size()){\n            if (a[i+j].first != b[j].first){\n                f = false;\n                break;\n            }\n            if (j == 0 || j == b.size()-1){\n                if (a[i+j].second < b[j].second){\n                    f = false;\n                    break;\n                }\n            }else{\n                if (a[i+j].second != b[j].second){\n                    f = false;\n                    break;\n                }\n            }\n        }\n        if (f){\n            REP(j,i) res.push_back(a[j]);\n            if (b.size() > 1){\n                a[i].second -= b[0].second;\n                res.push_back(a[i]);\n            }\n            REP(j,c.size()) res.push_back(c[j]);\n            a[i+b.size()-1].second -= b[b.size()-1].second;\n            res.push_back(a[i+b.size()-1]);\n            FOR(j,i+b.size(),a.size()-1) res.push_back(a[j]);\n        }\n    }\n    if (res.empty()){\n        REP(i,a.size()){\n            printf(\"%c %d \", a[i].first, a[i].second);\n        }\n        printf(\"$\\n\");\n    }else{\n        REP(i,res.size()){\n            if (!ans.empty() && ans[ans.size()-1].first == res[i].first){\n                ans[ans.size()-1].second += res[i].second;\n            }else if (res[i].second > 0){\n                ans.push_back(res[i]);\n            }\n        }\n        REP(i,ans.size()){\n            printf(\"%c %d \", ans[i].first, ans[i].second);\n        }\n        printf(\"$\\n\");\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing P=pair<char,int>;\n\nint main(){\n    vector<P> A,B,C;\n    char c;\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        A.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        B.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        C.emplace_back(c,l);\n    }\n    vector<P> ans;\n    for(int i=0;i<A.size();i++){\n        if(A[i].first==B.front().first&&A[i].first>=B.front().first){\n            bool flag=true;\n            if(i+B.size()<=A.size()){\n                for(int d=1;d<B.size();d++){\n                    if(A[i+d].first!=B[d].first){\n                        flag=false;\n                        break;\n                    }\n                    if(d==B.size()-2){\n                        if(A[i+d].second!=B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }else{\n                        if(A[i+d].second<B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }\n                }\n            }else{\n                continue;\n            }\n            if(flag){\n                for(int j=0;j<i;j++){\n                    ans.push_back(A[j]);\n                }\n                if(A[i].second!=B[0].second){\n                    ans.emplace_back(A[i].first,A[i].second-B[0].second);\n                }\n                for(int j=0;j<C.size();j++){\n                    if(j==0&&ans.back().first==C.front().first){\n                        ans.back().second+=C.front().second;\n                    }else{\n                        ans.push_back(C[j]);\n                    }\n                }\n\n                if(A[i+B.size()-1].second!=B.back().second){\n                    if(ans.back().first==B.back().first){\n                        ans.back().second+=A[i+B.size()-1].second-B.back().second;\n                    }else{\n                        ans.emplace_back(B.back().first, A[i+B.size()-1].second-B.back().second);\n                    }\n                }\n                for(int j=i+B.size();j<A.size();j++){\n                    ans.push_back(A[j]);\n                }\n                for(auto p:ans){\n                    char c; int l;\n                    tie(c,l)=p;\n                    cout<<c<<' '<<l<<' ';\n                }\n                cout<<'$'<<endl;\n                return 0;\n            }\n        }   \n    }\n    for(auto p:A){\n        char c; int l;\n        tie(c,l)=p;\n        cout<<c<<' '<<l<<' ';\n    }\n    cout<<'$'<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\nint main(){\n  vector <P> a,b,c;\n  ll i,j,k;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    a.push_back(P(ch,k));\n  }\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    b.push_back(P(ch,k));\n  }\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    c.push_back(P(ch,k));\n  }\n  for(i=0;i+b.size()<=a.size();i++){\n    if(a[i].first!=b[0].first||a[i].second<b[0].second) continue;\n    bool f = true;\n    k=b.size()-1;\n    for(j=1;j<k;j++){\n      if(a[i+j].first!=b[j].first||a[i+j].second!=b[j].second) {\n\tf=false;\n\tbreak;\n      }\n    }\n    if(a[i+k].first!=b[k].first||a[i+k].second<b[k].second) continue;\n    if(f){\n      //cout << i << endl;\n      for(j=0;j<k+1;j++){\n\ta[i+j].second-=b[j].second;\n      }\n      a.insert(a.begin()+i+1,c.begin(),c.end());\n      i+=b.size()+c.size()-1;\n      //break;\n    }\n  }\n\n\n  bool ff=true;\n  while(ff){\n    ff=false;\n    k=0;\n    while(k<a.size()){\n      if(a[k].second==0) {\n\ta.erase(a.begin()+k);\n\tff=true;\n      }else k++;\n    }\n    for(i=0;i<a.size()-1;i++){\n      if(a[i].first==a[i+1].first){\n\ta[i+1].second+=a[i].second;\n\ta[i].second=0;\n      }\n    }\n  }\n  \n  for(i=0;i<a.size();i++){\n    if(a[i].second==0) continue;\n    cout << a[i].first << \" \" << a[i].second << \" \";\n  }\n  cout << \"$\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\nusing namespace std;\ntypedef pair<char,long long> P;\n\nchar c[3][1001];\nlong long l[3][1001];\nint si[3];\nvector<P> ans;\n\nint main(){\n\trep(i,3){\n\t\tfor(int j = 0;;j++){\n\t\t\tcin >> c[i][j];\n\t\t\tif(c[i][j] == '$'){\n\t\t\t\tsi[i] = j;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcin >> l[i][j];\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tif(si[0]-i < si[1]) break;\n\t\tif(c[0][i] == c[1][0] && l[0][i] >= l[1][0]){\n\t\t\tif(si[1] == 1){\n\t\t\t\tl[0][i] -= l[1][0];\n\t\t\t\trep(j,i) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t\trep(j,si[2]) ans.push_back(P(c[2][j],l[2][j]));\n\t\t\t\tfor(int j = i; j < si[0]; j++){\n\t\t\t\t\tif(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t\t}\n\t\t\t\tfor(int j = ans.size()-1; j >= 1; j--){\n\t\t\t\t\tif(ans[j].first == ans[j-1].first){\n\t\t\t\t\t\tans[j-1].second += ans[j].second;\n\t\t\t\t\t\tans[j].second = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trep(j,ans.size()){\n\t\t\t\t\tif(ans[j].second == 0) continue;\n\t\t\t\t\tprintf(\"%c %lld \",ans[j].first,ans[j].second);\n\t\t\t\t}\n\t\t\t\tputs(\"$\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbool ok = true;\n\t\t\tfor(int j = 1; j < si[1]-1; j++){\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] != l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!ok) continue;\n\t\t\t{\n\t\t\t\tint j = si[1]-1;\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] < l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(!ok) continue;\n\t\t\t\tl[0][i] -= l[1][0];\n\t\t\t\tl[0][i+j] -= l[1][j];\n\t\t\t}\n\t\t\trep(j,i+1) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\trep(j,si[2]) ans.push_back(P(c[2][j],l[2][j]));\n\t\t\tfor(int j = i+si[1]-1; j < si[0]; j++){\n\t\t\t\tif(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t}\n\t\t\tfor(int j = ans.size()-1; j >= 1; j--){\n\t\t\t\tif(ans[j].first == ans[j-1].first){\n\t\t\t\t\tans[j-1].second += ans[j].second;\n\t\t\t\t\tans[j].second = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\trep(j,ans.size()){\n\t\t\t\tif(ans[j].second == 0) continue;\n\t\t\t\tprintf(\"%c %lld \",ans[j].first,ans[j].second);\n\t\t\t}\n\t\t\tputs(\"$\");\n\t\t\treturn 0;\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tprintf(\"%c %lld \",c[0][i],l[0][i]);\n\t}\n\tputs(\"$\");\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n#define NUM 1000000000\n\n\nstruct Node{\n\tchar ch;\n\tint length;\n\tNode* prev;\n\tNode* next;\n};\n\nstruct Info{\n\tvoid set(char arg_ch,int arg_length){\n\t\tch = arg_ch;\n\t\tlength = arg_length;\n\t}\n\tchar ch;\n\tint length;\n\tbool isFirst,isLast;\n};\n\nInfo A[2000],B[2000],C[2000];\nint a_len = 0,b_len = 0,c_len = 0;\n\nclass List{\npublic:\n\tList(){\n\t\tmotherNode = new Node();\n\t\tmotherNode->ch = '#';\n\t\tmotherNode->length = -1;\n\t\tmotherNode->prev = motherNode;\n\t\tmotherNode->next = motherNode;\n\t\tmatchFirstNode = motherNode;\n\t\tmatchLastNode = motherNode;\n\t\tleft_complete_match = false;\n\t\tright_complete_match = false;\n\t};\n\tvoid registA(Info info){\n\n\t\tNode* tmpNode = motherNode->prev;\n\t\tmotherNode->prev = new Node;\n\t\tmotherNode->prev->ch = info.ch;\n\t\tmotherNode->prev->length = info.length;\n\t\tmotherNode->prev->next = motherNode;\n\t\tmotherNode->prev->prev = tmpNode;\n\t\ttmpNode->next = motherNode->prev;\n\t};\n\n\tbool isMatchB(){\n\n\t\tbool FLG;\n\t\tint index;\n\n\t\tNode* startNode = motherNode;\n\t\tNode* tmpNode;\n\n\t\twhile(true){\n\t\t\tstartNode = startNode->next;\n\t\t\tif(startNode == motherNode)break;\n\n\t\t\ttmpNode = startNode;\n\n\t\t\tindex = 0;\n\n\t\t\tFLG = true;\n\n\t\t\twhile(tmpNode != motherNode){\n\t\t\t\tif(tmpNode->ch != B[index].ch){\n\t\t\t\t\tFLG = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}else{\n\n\t\t\t\t\tif(B[index].isFirst == false && B[index].isLast == false){\n\t\t\t\t\t\tif(tmpNode->length != B[index].length){\n\t\t\t\t\t\t\tFLG = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmpNode = tmpNode->next;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(tmpNode->length >= B[index].length){\n\t\t\t\t\t\t\ttmpNode = tmpNode->next;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tFLG = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(index == b_len)break;\n\t\t\t}\n\n\t\t\tif(FLG == true && index == b_len){\n\n\t\t\t\tif(startNode->length == B[0].length){\n\t\t\t\t\tmatchFirstNode = startNode->prev;\n\t\t\t\t\tleft_complete_match = true;\n\t\t\t\t}else{\n\t\t\t\t\tmatchFirstNode = startNode;\n\t\t\t\t}\n\n\t\t\t\ttmpNode = tmpNode->prev;\n\t\t\t\tif(tmpNode->length == B[b_len-1].length){\n\t\t\t\t\tmatchLastNode = tmpNode->next;\n\t\t\t\t\tright_complete_match = true;\n\t\t\t\t}else{\n\t\t\t\t\tmatchLastNode = tmpNode;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tvoid replace(){\n\n\t\tNode* tmpNode,*preNode,*firstNext;\n\t\tint index;\n\n\t\tfirstNext = matchFirstNode->next;\n\n\t\tif(left_complete_match){\n\t\t\tif(matchFirstNode->ch == C[0].ch){\n\t\t\t\tmatchFirstNode->length += C[0].length;\n\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\tindex = 1;\n\t\t\t}else{\n\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\tindex = 0;\n\t\t\t}\n\t\t}else{\n\t\t\tif(matchFirstNode->ch != C[0].ch){\n\t\t\t\tmatchFirstNode->length -= B[0].length;\n\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\tindex = 0;\n\t\t\t}else{\n\t\t\t\tmatchFirstNode->length = matchFirstNode->length - B[0].length + C[0].length;\n\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\tindex = 1;\n\t\t\t}\n\t\t}\n\n\t\tpreNode = matchFirstNode;\n\n\t\tif(index == c_len){ //c_len == 1\n\t\t\tif(right_complete_match){\n\t\t\t\tif(matchLastNode->ch != C[0].ch){\n\t\t\t\t\tmatchFirstNode->next = matchLastNode;\n\t\t\t\t\tmatchLastNode->prev = matchFirstNode;\n\t\t\t\t}else{\n\t\t\t\t\tmatchFirstNode->length += matchLastNode->length;\n\t\t\t\t\tmatchFirstNode->next = matchLastNode->next;\n\t\t\t\t\tmatchLastNode->next->prev = matchFirstNode;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(matchFirstNode != matchLastNode){\n\t\t\t\t\tif(matchLastNode->ch != C[0].ch){\n\t\t\t\t\t\tmatchFirstNode->next = matchLastNode;\n\t\t\t\t\t\tmatchLastNode->prev = matchFirstNode;\n\t\t\t\t\t\tmatchLastNode->length -= B[b_len-1].length;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tmatchFirstNode->length += matchLastNode->length - B[b_len-1].length;\n\t\t\t\t\t\tmatchFirstNode->next = matchLastNode->next;\n\t\t\t\t\t\tmatchLastNode->next->prev = matchFirstNode;\n\t\t\t\t\t}\n\t\t\t\t}else{ //matchFirstNode == matchLastNode\n\t\t\t\t\tif(firstNext->ch != C[0].ch){\n\t\t\t\t\t\tmatchFirstNode->next = firstNext;\n\t\t\t\t\t}else{\n\t\t\t\t\t\t//Do nothing\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\twhile(index < c_len){\n\t\t\tif(index != c_len - 1){\n\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\tpreNode = tmpNode;\n\t\t\t\ttmpNode->next = new Node;\n\t\t\t\ttmpNode = tmpNode->next;\n\t\t\t\tindex++;\n\t\t\t}else{ //index == c_len-1\n\t\t\t\tif(right_complete_match){\n\t\t\t\t\tif(matchLastNode->ch != C[index].ch){\n\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\ttmpNode->next = matchLastNode;\n\t\t\t\t\t\tmatchLastNode->prev = tmpNode;\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}else{\n\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\ttmpNode->length = C[index].length + matchLastNode->length;\n\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\ttmpNode->next = matchLastNode->next;\n\t\t\t\t\t\tmatchLastNode->next->prev = tmpNode;\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\n\t\t\t\t\tif(matchFirstNode != matchLastNode){\n\t\t\t\t\t\tif(matchLastNode->ch != C[index].ch){\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = matchLastNode;\n\t\t\t\t\t\t\tmatchLastNode->length -= B[b_len-1].length;\n\t\t\t\t\t\t\tmatchLastNode->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = matchLastNode->length-B[b_len-1].length + C[index].length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = matchLastNode->next;\n\t\t\t\t\t\t\tmatchLastNode->next->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{ //matchFirstNode == matchLastNode\n\t\t\t\t\t\tif(firstNext->ch != C[index].ch){\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = firstNext;\n\t\t\t\t\t\t\tfirstNext->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = C[index].length + firstNext->length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = firstNext->next;\n\t\t\t\t\t\t\tfirstNext->next->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tvoid output(){\n\n\t\tNode* tmpNode = motherNode->next;\n\t\twhile(tmpNode != motherNode){\n\t\t\tprintf(\"%c %d \",tmpNode->ch,tmpNode->length);\n\t\t\ttmpNode = tmpNode->next;\n\t\t}\n\n\t\tprintf(\"$\\n\");\n\t}\n\nprivate:\n\tNode* motherNode,*matchFirstNode,*matchLastNode;\n\tbool left_complete_match,right_complete_match;\n};\n\n\n\nint main(){\n\n\tList list;\n\n\tchar buf[2];\n\tint num;\n\tInfo tmp;\n\n\t//A???????????????\n\twhile(true){\n\t\tscanf(\"%s\",buf);\n\t\tif(buf[0] == '$')break;\n\n\t\tscanf(\"%d\",&num);\n\n\t\ttmp.set(buf[0],num);\n\t\tA[a_len++].set(buf[0],num);\n\n\t\tlist.registA(tmp);\n\t}\n\n\tfor(int i = 0; i < 2000; i++){\n\t\tB[i].isFirst = false;\n\t\tB[i].isLast = false;\n\t}\n\n\twhile(true){\n\t\tscanf(\"%s\",buf);\n\t\tif(buf[0] == '$')break;\n\n\t\tscanf(\"%d\",&num);\n\n\t\tB[b_len++].set(buf[0],num);\n\t}\n\n\tB[0].isFirst = true;\n\tB[b_len-1].isLast = true;\n\n\tif(!list.isMatchB()){\n\n\t\tfor(int i = 0; i < a_len; i++){\n\t\t\tprintf(\"%c %d \",A[i].ch,A[i].length);\n\t\t}\n\t\tprintf(\"$\\n\");\n\t\treturn 0;\n\t}\n\n\twhile(true){\n\t\tscanf(\"%s\",buf);\n\t\tif(buf[0] == '$')break;\n\n\t\tscanf(\"%d\",&num);\n\n\t\tC[c_len++].set(buf[0],num);\n\t}\n\n\tlist.replace();\n\n\tlist.output();\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-9;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\nvector<pair<char, int>>comp(vector<pair<char, int>>ps) {\n\tvector<pair<char, int>>newps;\n\tfor (int i = 0; i < ps.size(); ++i) {\n\t\tif (i==ps.size()-1||ps[i].first != ps[i + 1].first) {\n\t\t\tif (ps[i].second) {\n\t\t\t\tnewps.push_back(ps[i]);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tps[i + 1].second += ps[i].second;\n\t\t}\n\t}\n\treturn newps;\n}\nvoid input(vector<pair<char, int>>&p) {\n\twhile (1) {\n\t\tchar c; cin >> c;\n\t\tif (c == '$')break;\n\t\tint n; cin >> n;\n\t\tp.push_back(make_pair(c, n));\n\t}\n}\nint main() {\n\tvector<pair<char, int>>a, b, c;\n\tinput(a); input(b); input(c);\n\ta = comp(a); b = comp(b); c = comp(c);\n\tif (b.size() == 1) {\n\t\tfor (int i = 0; i < a.size(); ++i) {\n\t\t\tif (a[i].first == b[i].first) {\n\t\t\t\ta[i].second -= b[i].second;\n\t\t\t\ta.insert(a.begin() + i, c.begin(),c.end());\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tfor (int l = 0; l <= a.size() - b.size(); ++l) {\n\t\t\tbool aok = true;\n\t\t\tif (a[l].first != b[0].first||a[l].second < b[0].second) {\n\t\t\t\taok = false;\n\t\t\t}\n\t\t\tfor (int i = 1; i < b.size() - 1; ++i) {\n\t\t\t\tif (a[l + i] != b[i]) {\n\t\t\t\t\taok = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (a[l+b.size()-1].first != b[b.size()-1].first || a[l + b.size() - 1].second < b[b.size() - 1].second) {\n\t\t\t\taok = false;\n\t\t\t}\n\t\t\tif (aok) {\n\t\t\t\ta[l].second -= b[0].second;\n\t\t\t\ta[l + b.size() - 1].second -= b[b.size() - 1].second;\n\t\t\t\ta.erase(a.begin() + l + 1, a.begin() + l + b.size() - 1);\n\t\t\t\ta.insert(a.begin() + l + 1, c.begin(), c.end());\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\ta = comp(a);\n\tfor (int i = 0; i < a.size(); ++i) {\n\t\tcout << a[i].first << \" \" << a[i].second << \" \";\n\t}\n\tcout << \"$\" << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define s second\n#define f first\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\nvector<P> A[3],ans;\nll len[3];\n\nint main(){\n  char c;\n  ll n;\n  for(int i=0;i<3;i++){\n    while(cin>>c,c!='$')\n      cin>>n,A[i].push_back(P(c,n));\n    len[i]=A[i].size();\n  }\n  for(int i=0;i<len[0];i++){\n    if(i>len[0]-len[1]){\n      ans.push_back(A[0][i]);\n      continue;\n    }\n    int flag=0;\n    for(int j=0;j<len[1];j++){\n      ll a=A[0][i+j].s,b=A[1][j].s;\n      if(A[0][i+j].f!=A[1][j].f)flag=1;\n      if(!j&&a<b)flag=1;\n      if(j&&j!=len[1]-1&&a!=b)flag=1;\n      if(j==len[1]-1&&a<b)flag=1;\n    }\n    if(!flag){\n      if(A[0][i].s>A[1][0].s&&len[1]!=1)\n\tans.push_back(P(A[1][0].f,A[0][i].s-A[1][0].s));\n      for(int j=0;j<len[2];j++)\n\tans.push_back(A[2][j]);\n      A[0][i+len[1]-1].s-=A[1][len[1]-1].s;\n      i+=len[1]-2;\n    }else if(A[0][i].s)ans.push_back(A[0][i]);\n  }\n  char ch=ans[0].f;\n  ll sum=ans[0].s;\n  for(int i=1;i<ans.size();i++){\n    if(ch==ans[i].f)sum+=ans[i].s;\n    else cout<<ch<<' '<<sum<<' ',ch=ans[i].f,sum=ans[i].s;\n  }\n  cout<<ch<<' '<<sum<<\" $\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i, a, b) for (int i = a; i < (b); ++i)\n#define trav(a, x) for (auto& a : x)\n#define all(x) begin(x), end(x)\n#define sz(x) (int)(x).size()\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef vector<int> vi;\n\nvector<pair<char, int>> a, b, c;\n\nvoid read(vector<pair<char, int>> &v) {\n\tchar c; int d;\n\twhile (true) {\n\t\tcin >> skipws >> c;\n\t\tif (c == '$') return;\n\t\tcin >> d;\n\t\tv.push_back({c, d});\n\t}\n}\n\nint main() {\n\tread(a); read(b); read(c);\n\n\tfor (int st = 0; st <= (int)a.size() - (int)b.size(); st++) {\n\t\tint midlen = b.size() - 2;\n\t\tbool ok = true;\n\t\tfor (int i = 0; i < midlen; i++) {\n\t\t\tok = ok && a[st + i + 1] == b[i + 1];\n\t\t}\n\t\tif (ok && b.size() > 1) {\n\t\t\tif (a[st].first == b.front().first && a[st + b.size() - 1].first == b.back().first &&\n\t\t\t\ta[st].second >= b.front().second && a[st + b.size() - 1].second >= b.back().second) {\n\t\t\t\t// do replacement\n\t\t\t\t//cerr << \"Replacement\" << endl;\n\t\t\t\tvector<pair<char, int>> na;\n\t\t\t\tfor (int i = 0; i < st; i++) na.push_back(a[i]);\n\t\t\t\tif (a[st].second > b.front().second) na.push_back({ b.front().first, a[st].second - b.front().second });\n\t\t\t\tfor (auto p : c) na.push_back(p);\n\t\t\t\tif (b.size() > 1 && a[st + b.size() - 1].second > b.back().second) na.push_back({ b.back().first, a[st + b.size() - 1].second - b.back().second });\n\t\t\t\tfor (int i = st + b.size(); i < a.size(); i++) na.push_back(a[i]);\n\t\t\t\ta = na;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} else if (ok) {\n\t\t\tif (a[st].first == b.front().first && a[st].second >= b.front().second) {\n\t\t\t\tvector<pair<char, int>> na;\n\t\t\t\tfor (int i = 0; i < st; i++) na.push_back(a[i]);\n\t\t\t\tfor (auto p : c) na.push_back(p);\n\t\t\t\tif (a[st].second > b.front().second) na.push_back({ a[st].first, a[st].second - b.front().second });\n\t\t\t\tfor (int i = st + b.size(); i < a.size(); i++) na.push_back(a[i]);\n\t\t\t\ta = na;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// simplify (condense) a\n\t{\n\t\tvector<pair<char, int>> na;\n\t\tpair<char, int> b = a[0];\n\t\tfor (int i = 1; i < a.size(); i++) {\n\t\t\tif (a[i].first == b.first) b.second += a[i].second;\n\t\t\telse {\n\t\t\t\tna.push_back(b);\n\t\t\t\tb = a[i];\n\t\t\t}\n\t\t}\n\t\tna.push_back(b);\n\t\ta = na;\n\t}\n\t\n\t// output a\n\tfor (auto p : a) cout << p.first << \" \" << p.second << \" \";\n\tcout << \"$\" << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\nusing namespace std;\n\nint main() {\n    vector<string> v[3];\n    for(int i=0; i<3; ++i) {\n        while(true) {\n            char c;\n            cin >> c;\n            if(c != '$') {\n                v[i].push_back(string{c});\n                string len;\n                cin >> len;\n                v[i].push_back(len);\n            } else {\n                break;\n            }\n        }\n    }\n    auto A = v[0], B = v[1], C = v[2];\n    vector<string> res;\n    for(int i=0; i<A.size(); i += 2) {\n        if(A[i] == B[0] && stoi(B[1]) <= stoi(A[i+1])) {\n            bool ok = B.size() == 2;\n            for(int j=2; i+j+1<A.size() && j+1<B.size(); j += 2) {\n                if(j == B.size() - 2) {\n                    if(A[i+j] == B[j] && stoi(A[i+j+1]) >= stoi(B[j+1])) {\n                        ok = true;\n                        break;\n                    }\n                } else if(A[i+j] != B[j] || stoi(A[i+j+1]) != stoi(B[j+1])) {\n                    break;\n                }\n            }\n            if(ok) {\n                for(int j=0; j<i; ++j) {\n                    res.push_back(A[j]);\n                }\n                if(B.size() != 2 && stoi(A[i+1]) - stoi(B[1]) > 0) {\n                    res.push_back(A[i]);\n                    res.push_back(to_string(stoi(A[i+1]) - stoi(B[1])));\n                }\n                res.push_back(C[0]);\n                res.push_back(C[1]);\n                for(int j=2; j<C.size(); ++j) {\n                    res.push_back(C[j]);\n                }\n                if(stoi(A[i+B.size()-1]) > stoi(B[B.size()-1])) {\n                    res.push_back(A[i+B.size()-2]);\n                    res.push_back(to_string(stoi(A[i+B.size()-1]) - stoi(B[B.size()-1])));\n                }\n                for(int j=i+B.size(); j<A.size(); ++j) {\n                    res.push_back(A[j]);\n                }\n                break;\n            }\n        }\n    }\n    if(res.empty()) {\n        res = A;\n    }\n    for(int i=0; i+1<res.size(); i+=2) {\n        while(i + 3 < res.size() && res[i+2] == res[i]) {\n            res[i+3] = to_string(stoi(res[i+3]) + stoi(res[i+1]));\n            i += 2;\n        }\n        cout << res[i] << \" \" << res[i+1] << \" \";\n    }\n    cout << '$' << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n \n \nstruct strint{\n  string x;\n  strint() {\n    x = \"\";\n  }\n  int size()const{\n    return x.size();\n  }\n  char operator[](int id) const {\n    return x[id];\n  }\n  bool operator<(const strint &ot) const{\n    if( size() < ot.size() ) return true;\n    if( size() > ot.size() ) return false;\n    for(int i=0;i<size();i++){\n      if( x[i] < ot[i] ) return true;\n      if( x[i] > ot[i] ) return false;\n    }\n    return false;\n  }\n  void operator+=(const string &s) {\n    x+=s;\n  }\n  strint operator=(const string &s){\n    x = s;\n    return *this;\n  }\n  strint operator=(char s[]){\n    x = s;\n    return *this;\n  }\n};\n \n \nchar buf[111];\nstrint memo[55][55];\nstrint memn[55][55];\nstrint memr[55][55];\nstrint meml[55][55];\nstrint parse(int l,int r);\n \nstrint number(int l,int r){\n  //cout << \"number : \"<< l <<\" , \" << r << endl;\n  strint &ret = memn[l][r];\n  if( ret.x != \"\" ) return ret;\n  strint res;\n  if( buf[l] == '0' ){\n    if( l+1 == r ) return memn[l][r] = (string)\"0\";\n    else return memn[l][r] = (string)\"/\";\n  }\n  while( l < r && (isdigit(buf[l]) || buf[l] == '?') ){\n    if( buf[l] == '?' ) res += (string)\"9\";\n    else res.x += buf[l];    \n    l++;\n  }\n  ret = res;\n  //cout << res << \" \" << l << \"-\"<< r << endl;\n  if( l == r ) return ret;\n  return ret = (string)\"/\";\n}\n \nstrint parseR(int l,int r){\n  strint &ret = memr[l][r];\n  if( ret.x != \"\" ) return ret;\n  ret = (string)\"/\";\n  //cout << \"R : \"<< l <<\" , \" << r << endl;\n  if( (buf[l] == 'R' || buf[l] == '?') && (buf[r-1] == ')' || buf[r-1] == '?' ) ){\n    l++; r--;\n    if( buf[l] == '(' || buf[l] == '?' ) {\n      l++;\n      for(int i=l+1;i+1<r;i++){       \n        if( (buf[i] == ',' || buf[i] == '?') && parse(l,i).x != \"/\" ){\n          //strint x = parse(i+1,r);\n          //if( x != \"/\" ) return x;\n          ret = max( ret, parse(i+1,r) );\n        }\n      }\n    }\n  } \n  return ret;\n}\n \nstrint parseL(int l,int r){\n  strint &ret = meml[l][r];\n  if( ret.x != \"\" ) return ret;\n  ret = (string)\"/\";\n  //cout << \"L : \"<< l <<\" , \" << r << endl;\n  if( (buf[l] == 'L' || buf[l] == '?') && (buf[r-1] == ')' || buf[r-1] == '?' ) ){\n    l++; r--;\n    if( buf[l] == '(' || buf[l] == '?' ) {\n      l++;\n      for(int i=l+1;i+1<r;i++){       \n        if( (buf[i] == ',' || buf[i] == '?') && parse(i+1,r).x != \"/\" ){\n          //ret = parse(l,i);\n          //if( ret != \"/\" ) return ret;\n          ret = max( ret, parse(l,i) );\n        }\n      }\n    }\n  } \n  return ret;\n}\n \n \nstrint parse(int l,int r){\n  //cout << l << \", \" << r << endl;\n  strint &ret = memo[l][r];\n  if( ret.x != \"\" ) return ret;\n  if( l >= r ) return ret = (string)\"/\";\n  return ret = max( number(l,r), max( parseR(l,r) , parseL(l,r) ) );\n}\n \nint main(){\n  cin >> buf;\n  strint res = parse(0,strlen(buf));\n  if( res.x == \"/\" ) cout << \"invalid\" << endl;\n  else cout << res.x << endl;\n \n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\nusing namespace std;\n\n#define MOD 1000000007\ntypedef long long LL;\n\nstruct node{\n\tchar c;\n\tLL l;\n\t};\n\nnode a[2005],b[1005],c[1005],d[2005];\nint na,nb,nc,nd;\n\nint main(){\n\tchar e;\n\tint i,j,k;\n\twhile(scanf(\" %c\",&e)&&e!='$'){\n\t\ta[na].c=e;\n\t\tscanf(\"%lld\",&a[na++].l);\n\t\t}\n\twhile(scanf(\" %c\",&e)&&e!='$'){\n\t\tb[nb].c=e;\n\t\tscanf(\"%lld\",&b[nb++].l);\n\t\t}\n\twhile(scanf(\" %c\",&e)&&e!='$'){\n\t\tc[nc].c=e;\n\t\tscanf(\"%lld\",&c[nc++].l);\n\t\t}\n\tfor(i=0;i<=na-nb;i++){\n\t\tif(a[i].c!=b[0].c||a[i].l<b[0].l)\tcontinue;\n\t\tif(nb==1){\n\t\t\tfor(nd=0;nd<i;nd++)\n\t\t\t\td[nd]=a[nd];\n\t\t\tfor(k=0;k<nc;k++)\n\t\t\t\td[nd++]=c[k];\n\t\t\tif(a[i].l>b[0].l){\n\t\t\t\td[nd]=a[i];\n\t\t\t\td[nd++].l-=b[0].l;\n\t\t\t\t}\n\t\t\tfor(k=i+1;k<na;k++)\n\t\t\t\td[nd++]=a[k];\n\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\telse{\n\t\t\t\tfor(j=1;j<nb;j++){\n\t\t\t\t\tif(a[i+j].c!=b[j].c||a[i+j].l!=b[j].l)\tbreak;\n\t\t\t\t\t}\n\t\t\t\tif(j>=nb-1){\n\t\t\t\t\tif(a[i+nb-1].c==b[nb-1].c&&a[i+nb-1].l>=b[nb-1].l){\n\t\t\t\t\t\tfor(nd=0;nd<i;nd++)\n\t\t\t\t\t\t\td[nd]=a[nd];\n\t\t\t\t\t\tif(a[i].l>b[0].l){\n\t\t\t\t\t\t\td[nd]=a[i];\n\t\t\t\t\t\t\td[nd++].l-=b[0].l;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(k=0;k<nc;k++)\n\t\t\t\t\t\t\td[nd++]=c[k];\n\t\t\t\t\t\tif(a[i+nb-1].l>b[nb-1].l){\n\t\t\t\t\t\t\td[nd]=a[i+nb-1];\n\t\t\t\t\t\t\td[nd++].l-=b[nb-1].l;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(k=i+nb;k<na;k++)\n\t\t\t\t\t\t\td[nd++]=a[k];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\tif(i<=na-nb){\n\t\tna=0;\n\t\ta[na]=d[0];\n\t\tfor(i=1;i<nd;i++){\n\t\t\tif(d[i].c==a[na].c)\n\t\t\t\ta[na].l+=d[i].l;\n\t\t\telse\n\t\t\t\ta[++na]=d[i];\n\t\t\t}\n\t\tna++;\n\t\t}\n\tfor(i=0;i<na;i++)\n\t\tprintf(\"%c %lld \",a[i].c,a[i].l);\n\tprintf(\"$\\n\");\n\treturn 0;\n\t}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-9;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\nvector<pair<char, int>>comp(vector<pair<char, int>>ps) {\n\tvector<pair<char, int>>newps;\n\tfor (int i = 0; i < ps.size(); ++i) {\n\t\tif (i==ps.size()-1||ps[i].first != ps[i + 1].first) {\n\t\t\tif (ps[i].second) {\n\t\t\t\tnewps.push_back(ps[i]);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tps[i + 1].second += ps[i].second;\n\t\t}\n\t}\n\treturn newps;\n}\nvoid input(vector<pair<char, int>>&p) {\n\twhile (1) {\n\t\tchar c; cin >> c;\n\t\tif (c == '$')break;\n\t\tint n; cin >> n;\n\t\tp.push_back(make_pair(c, n));\n\t}\n}\nint main() {\n\tvector<pair<char, int>>a, b, c;\n\tinput(a); input(b); input(c);\n\ta = comp(a); b = comp(b); c = comp(c);\n\tif (b.size() == 1) {\n\t\tfor (int i = 0; i < a.size(); ++i) {\n\t\t\tif (a[i].first == b[0].first&&a[i].second>=b[0].second) {\n\t\t\t\ta[i].second -= b[0].second;\n\t\t\t\ta.insert(a.begin() + i, c.begin(),c.end());\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tfor (int l = 0; l <= a.size() - b.size(); ++l) {\n\t\t\tbool aok = true;\n\t\t\tif (a[l].first != b[0].first||a[l].second < b[0].second) {\n\t\t\t\taok = false;\n\t\t\t}\n\t\t\tfor (int i = 1; i < b.size() - 1; ++i) {\n\t\t\t\tif (a[l + i] != b[i]) {\n\t\t\t\t\taok = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (a[l+b.size()-1].first != b[b.size()-1].first || a[l + b.size() - 1].second < b[b.size() - 1].second) {\n\t\t\t\taok = false;\n\t\t\t}\n\t\t\tif (aok) {\n\t\t\t\ta[l].second -= b[0].second;\n\t\t\t\ta[l + b.size() - 1].second -= b[b.size() - 1].second;\n\t\t\t\ta.erase(a.begin() + l + 1, a.begin() + l + b.size() - 1);\n\t\t\t\ta.insert(a.begin() + l + 1, c.begin(), c.end());\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\ta = comp(a);\n\tfor (int i = 0; i < a.size(); ++i) {\n\t\tcout << a[i].first << \" \" << a[i].second << \" \";\n\t}\n\tcout << \"$\" << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define s second\n#define f first\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\nvector<P> A[3],ans;\nll len[3];\n\nint main(){\n  char c;\n  ll n;\n  for(int i=0;i<3;i++){\n    while(cin>>c,c!='$')\n      cin>>n,A[i].push_back(P(c,n));\n    len[i]=A[i].size();\n  }\n  for(int i=0;i<len[0];i++){\n    if(i>len[0]-len[1]){\n      ans.push_back(A[0][i]);\n      continue;\n    }\n    int flag=0;\n    for(int j=0;j<len[1];j++){\n      ll a=A[0][i+j].s,b=A[1][j].s;\n      if(A[0][i+j].f!=A[1][j].f)flag=1;\n      if(!j&&a<b)flag=1;\n      if(j&&j!=len[1]-1&&a!=b)flag=1;\n      if(j==len[1]-1&&a<b)flag=1;\n    }\n    if(!flag){\n      if(A[0][i].s>A[1][0].s)\n\tans.push_back(P(A[1][0].f,A[0][i].s-A[1][0].s));\n      for(int j=0;j<len[2];j++)\n\tans.push_back(A[2][j]);\n      A[0][i+len[1]-1].s-=A[1][len[1]-1].s;\n      i+=len[1]-2;\n    }else if(A[0][i].s)ans.push_back(A[0][i]);\n  }\n  char ch=ans[0].f;\n  ll sum=ans[0].s;\n  for(int i=1;i<ans.size();i++){\n    if(ch==ans[i].f)sum+=ans[i].s;\n    else cout<<ch<<' '<<sum<<' ',ch=ans[i].f,sum=ans[i].s;\n  }\n  cout<<ch<<' '<<sum<<\" $\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\nusing Pi = pair<int, int>;\nusing Pl = pair<ll, ll>;\nusing Ti = tuple<int, int, int>;\nusing Tl = tuple<ll, ll, ll>;\n\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define F first\n#define S second\n#define Get(t, i) get<(i)>((t))\n#define all(v) (v).begin(), (v).end()\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define reps(i, f, n) for(int i = (int)(f); i < (int)(n); i++)\n#define each(a, b) for(auto& a : b)\n\nconst int inf = 1 << 25;\nconst ll INF = 1LL << 55;\n\nusing P = pair<char, int>;\n\nvoid input(vector<P>& v)\n{\n  char c; int l;\n  while(cin >> c, c != '$') {\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n}\n\nint main()\n{\n  vector<P> A; input(A);\n  vector<P> B; input(B);\n  vector<P> C; input(C);\n\n  rep(i, A.size()-B.size()+1) {\n    if(A[i].F == B[0].F && A[i].S >= B[i].S &&\n       A[i+B.size()-1].F == B[B.size()-1].F &&\n       A[i+B.size()-1].S >= B[B.size()-1].S) {\n      bool flag = true;\n      reps(j, 1, B.size()-1) {\n\tflag &= (A[i+j].F == B[j].F && A[i+j].S == B[j].S);\n      }\n      if(flag) {\n\tint Abofst = (A[i].S > B[0].S);\n\tint Aeofst = (A[i+B.size()-1].S > B[B.size()-1].S);\n\tif(Abofst) A[i].S -= B[0].S;\n\tif(Aeofst) A[i+B.size()-1].S -= B[B.size()-1].S;\n\tint Cbofst = (A[i-!Abofst].F == C[0].F);\n\tint Ceofst = (A[i+B.size()-1+!Aeofst].F == C[C.size()-1].F);\n\tif(Cbofst) A[i-!Abofst].S += C[0].S;\n\tif(Ceofst) A[i+B.size()-1+!Aeofst].S += C[C.size()-1].S;\n\tif(B.size() == 1) {\n\t  Abofst = 0;\n\t  //Aeofst = 0;\n\t  A[i].S += B[0].S;\n\t}\n\tif(i+Abofst < B.size()-Aeofst) A.erase(A.begin()+i+Abofst, A.begin()+B.size()-Aeofst);\n\tvector<P> D;\n\treps(j, Cbofst, C.size()-Ceofst) D.push_back(C[j]);\n\tA.insert(A.begin()+i+Abofst, D.begin(), D.end());\n\trep(j, A.size()) {\n\t  if(j + 1 < A.size() && A[j].F == A[j+1].F) {\n\t    cout << A[j].F << \" \" << A[j].S+A[j+1].S-C[0].S << \" \";\n\t    j++;\n\t  } else {\n\t    cout << A[j].F << \" \" << A[j].S << \" \";\n\t  }\n\t}\n\tcout << \"$\" << endl;\n\treturn 0;\n      }\n    }\n  }\n  rep(i, A.size()) {\n    cout << A[i].F << \" \" << A[i].S << \" \";\n  }\n  cout << \"$\" << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\nusing namespace std;\nvector<pair<char,int> >a[5];\nint main(){\n\tfor(int i=0;i<3;i++){\n\t\twhile(true){\n\t\t\tchar C;int P;\n\t\t\tcin>>C;if(C=='$')break;\n\t\t\tcin>>P;a[i].push_back(make_pair(C,P));\n\t\t}\n\t}\n\tint cnt=0;\n\tfor(int i=0;i<=(int)a[0].size()-(int)a[1].size();i++){\n\t\tif(a[0][i].first!=a[1][0].first)continue;\n\t\tif(a[0][i].second<a[1][0].second)continue;\n\t\tint OK=0;\n\t\tfor(int j=1;j<a[1].size();j++){\n\t\t\tif(j!=a[1].size()-1){\n\t\t\t\tif(a[0][i+j].first!=a[1][j].first)OK=1;\n\t\t\t\tif(a[0][i+j].second!=a[1][j].second)OK=1;\n\t\t\t}\n\t\t\tif(j==a[1].size()-1){\n\t\t\t\tif(a[0][i+j].first!=a[1][j].first)OK=1;\n\t\t\t\tif(a[0][i+j].second<a[1][j].second)OK=1;\n\t\t\t}\n\t\t}\n\t\tif(OK==0){\n\t\t\t//start\n\t\t\tfor(int j=0;j<i;j++)a[3].push_back(a[0][j]);\n\t\t\t//second\n\t\t\tif(a[1].size()>=2){\n\t\t\t\ta[3].push_back(make_pair(a[0][i].first,a[0][i].second-a[1][0].second));\n\t\t\t}\n\t\t\t//third\n\t\t\tfor(int j=0;j<a[2].size();j++)a[3].push_back(a[2][j]);\n\t\t\t//fourth\n\t\t\tint num=a[0][i+a[1].size()-1].second-a[1][a[1].size()-1].second;\n\t\t\ta[3].push_back(make_pair(a[1][a[1].size()-1].first,num));\n\t\t\t//fifth\n\t\t\tfor(int j=i+a[1].size();j<a[0].size();j++)a[3].push_back(a[0][j]);\n\t\t\tcnt=1;break;\n\t\t}\n\t}\n\tfor(int i=0;i<a[3].size();i++){\n\t\tif(a[3][i].second==0)continue;\n\t\tif(a[4].size()==0)a[4].push_back(a[3][i]);\n\t\telse{\n\t\t\tif(a[3][i].second==0)continue;\n\t\t\tif(a[4][a[4].size()-1].first==a[3][i].first){\n\t\t\t\ta[4][a[4].size()-1].second+=a[3][i].second;\n\t\t\t}\n\t\t\telse{a[4].push_back(a[3][i]);}\n\t\t}\n\t}\n\tif(cnt==1){\n\t\tfor(int i=0;i<a[4].size();i++){\n\t\t\tcout<<a[4][i].first<<' '<<a[4][i].second<<' ';\n\t\t}\n\t}\n\tif(cnt==0){\n\t\tfor(int i=0;i<a[0].size();i++){\n\t\t\tcout<<a[0][i].first<<' '<<a[0][i].second<<' ';\n\t\t}\n\t}\n\tcout<<\"$\"<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing PII = pair<ll, ll>;\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\ntemplate<typename T> void chmin(T &a, const T &b) { a = min(a, b); }\ntemplate<typename T> void chmax(T &a, const T &b) { a = max(a, b); }\nstruct FastIO {FastIO() { cin.tie(0); ios::sync_with_stdio(0); }}fastiofastio;\n#ifdef DEBUG_ \n#include \"../program_contest_library/memo/dump.hpp\"\n#else\n#define dump(...)\n#endif\nconst ll INF = 1LL<<60;\n\nint main(void) {\n    using P = pair<char,ll>;\n    vector<P> a, b, c;\n    while(1) {\n        char c;\n        cin >> c;\n        if(c == '$') break;\n        ll l;\n        cin >> l;\n        a.emplace_back(c, l);\n    }\n    while(1) {\n        char c;\n        cin >> c;\n        if(c == '$') break;\n        ll l;\n        cin >> l;\n        b.emplace_back(c, l);\n    }\n    while(1) {\n        char cc;\n        cin >> cc;\n        if(cc == '$') break;\n        ll l;\n        cin >> l;\n        c.emplace_back(cc, l);\n    }\n\n    vector<P> ans;\n    ll n = a.size(), idx = 0;\n    REP(i, n) {\n        if(a[i].first == b[idx].first && a[i].second >= b[idx].second) {\n            if(b.size() == 1) {\n                REP(j, n) {\n                    if(j != i) ans.push_back(a[j]);\n                    else {\n                        for(auto k: c) ans.push_back(k);\n                        if(a[i].second-b[0].second>0) {\n                            ans.push_back({a[i].first, a[i].second-b[0].second});\n                        }\n                    }\n                }\n                break;\n            }\n\n            if(0 < idx && idx < (int)b.size()-1 && a[i].second != b[idx].second) {\n                // ng\n                idx = 0;\n            } else {\n                idx++;\n                if(idx == (ll)b.size()) {\n                    // [i-b.size()+1, i] の部分を消して c に置換する\n                    // dump(i-b.size(), i);\n                    vector<bool> del(a.size());\n                    REP(j, b.size()) {\n                        a[j+i-b.size()+1].second -= b[j].second;\n                        if(a[j+i-b.size()+1].second == 0) {\n                            del[j+i-b.size()+1] = true;\n                        }\n                    }\n                    // REP(i, 10) cerr << del[i] << \" \";\n                    // cerr << endl;\n                    bool first = true;\n                    REP(j, a.size()) {\n                        if((del[j] || j>i-(ll)b.size()+1) && first) {\n                            for(auto k: c) ans.push_back(k);\n                            first = false;\n                        }\n                        if(!del[j]) ans.push_back(a[j]);\n                    }\n                    break;\n                }\n            }\n        } else {\n            // ng\n            idx = 0;\n        }\n    }\n\n    if(ans.size() == 0) ans = a;\n    // REP(i, 10) cerr << ans[i] << \" \";\n    // cerr << endl;\n\n    vector<ll> head(ans.size());\n    head[0] = 0;\n    FOR(i, 1, ans.size()) {\n        if(ans[i].first == ans[i-1].first) {\n            head[i] = head[i-1];\n            ans[head[i]].second += ans[i].second;\n            ans[i].second = 0;\n        } else {\n            head[i] = i;\n        }\n    }\n\n    vector<P> nans;\n    for(auto i: ans) if(i.second != 0) nans.push_back(i);\n    REP(i, nans.size()) cout << nans[i].first << \" \" << nans[i].second << \" \";\n    cout << \"$\" << endl;\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing P=pair<char,int>;\n\nint main(){\n    vector<P> A,B,C;\n    char c;\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        A.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        B.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        C.emplace_back(c,l);\n    }\n    vector<P> ans;\n    for(int i=0;i<A.size();i++){\n        if(A[i].first==B.front().first&&A[i].second>=B.front().second){\n            bool flag=true;\n            if(i+B.size()<=A.size()){\n                for(int d=1;d<B.size();d++){\n                    if(A[i+d].first!=B[d].first){\n                        flag=false;\n                        break;\n                    }\n                    if(d!=B.size()-1){\n                        if(A[i+d].second!=B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }else{\n                        if(A[i+d].second<B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }\n                }\n            }else{\n                continue;\n            }\n            if(flag){\n                for(int j=0;j<i;j++){\n                    ans.push_back(A[j]);\n                }\n                if(B.size()==1){\n                    for(auto p:C) ans.push_back(p);\n                    ans.emplace_back(A[i].first,A[i].second-B[0].second);\n                    for(int j=i+B.size();j<A.size();j++){\n                        if(j==i+B.size()&&ans.back().first==A[j].first){\n                            ans.back().second+=A[j].second;\n                        }else{\n                            ans.push_back(A[j]);                            \n                        }\n                    }\n                }else{\n                    ans.emplace_back(A[i].first,A[i].second-B[0].second);\n                    for(int j=0;j<C.size();j++){\n                        if(j==0&&!ans.empty()&&ans.back().first==C.front().first){\n                            ans.back().second+=C.front().second;\n                        }else{\n                            ans.push_back(C[j]);\n                        }\n                    }\n\n                    if(A[i+B.size()-1].second!=B.back().second){\n                        if(ans.back().first==B.back().first){\n                            ans.back().second+=A[i+B.size()-1].second-B.back().second;\n                        }else{\n                            ans.emplace_back(B.back().first, A[i+B.size()-1].second-B.back().second);\n                        }\n                    }\n                    for(int j=i+B.size();j<A.size();j++){\n                        ans.push_back(A[j]);\n                    }\n                }\n                for(auto p:ans){\n                    char c; int l;\n                    tie(c,l)=p;\n                    cout<<c<<' '<<l<<' ';\n                }\n                cout<<'$'<<endl;\n                /*\n                {\n                    bool b=true;\n                    for(int i=0;i<A.size();i++){\n                        if(A[i]!=B[i]){\n                            cout<<i<<' '<<A[i].first<<' '<<A[i].second<<' '<<B[i].first<<' '<<B[i].second<<endl;\n                        }\n                    }\n                    cout<<b<<endl;\n                }*/\n                \n                // cout<<A.size()<<endl;\n                // cout<<B.size()<<endl;\n                // cout<<C.size()<<endl;\n                // cout<<ans.size()<<endl;\n                 \n                return 0;\n            }\n        }   \n    }\n    for(auto p:A){\n        char c; int l;\n        tie(c,l)=p;\n        cout<<c<<' '<<l<<' ';\n    }\n    cout<<'$'<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\nusing Pi = pair<int, int>;\nusing Pl = pair<ll, ll>;\nusing Ti = tuple<int, int, int>;\nusing Tl = tuple<ll, ll, ll>;\n\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define F first\n#define S second\n#define Get(t, i) get<(i)>((t))\n#define all(v) (v).begin(), (v).end()\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define reps(i, f, n) for(int i = (int)(f); i < (int)(n); i++)\n#define each(a, b) for(auto& a : b)\n\nconst int inf = 1 << 25;\nconst ll INF = 1LL << 55;\n\nusing P = pair<char, int>;\n\nvoid input(vector<P>& v)\n{\n  char c; int l;\n  while(cin >> c, c != '$') {\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n}\n\nint main()\n{\n  vector<P> A; input(A);\n  vector<P> B; input(B);\n  vector<P> C; input(C);\n\n  rep(i, A.size()-B.size()+1) {\n    if(A[i].F == B[0].F && A[i].S >= B[i].S &&\n       A[i+B.size()-1].F == B[B.size()-1].F &&\n       A[i+B.size()-1].S >= B[B.size()-1].S) {\n      bool flag = true;\n      reps(j, 1, B.size()-1) {\n\tflag &= (A[i+j].F == B[j].F && A[i+j].S == B[j].S);\n      }\n      if(flag) {\n\tint Abofst = (A[i].S > B[0].S);\n\tint Aeofst = (A[i+B.size()-1].S > B[B.size()-1].S);\n\tif(Abofst) A[i].S -= B[0].S;\n\tif(Aeofst) A[i+B.size()-1].S -= B[B.size()-1].S;\n\tint Cbofst = (A[i-(Abofst ? 0 : 1)].F == C[0].F);\n\tint Ceofst = (A[i+B.size()-1+(Aeofst ? 0 : 1)].F == C[C.size()-1].F);\n\tif(Cbofst) A[i-(Abofst ? 0 : 1)].S += C[0].S;\n\tif(Ceofst) A[i+B.size()-1+(Aeofst ? 0 : 1)].S += C[C.size()-1].S;\n\tif(B.size() == 1) {\n\t  Abofst = 0;\n\t  Aeofst = 0;\n\t  A[i].S += B[0].S;\n\t}\n\tif(i+Abofst < B.size()-Aeofst) A.erase(A.begin()+i+Abofst, A.begin()+B.size()-Aeofst);\n\tvector<P> D;\n\treps(j, Cbofst, C.size()-Ceofst) D.push_back(C[j]);\n\tA.insert(A.begin()+i+Abofst, D.begin(), D.end());\n\trep(j, A.size()) {\n\t  if(j + 1 < A.size() && A[j].F == A[j+1].F) {\n\t    cout << A[j].F << \" \" << A[j].S+A[j+1].S-C[0].S << \" \";\n\t    j++;\n\t  } else {\n\t    cout << A[j].F << \" \" << A[j].S << \" \";\n\t  }\n\t}\n\tcout << \"$\" << endl;\n\treturn 0;\n      }\n    }\n  }\n  rep(i, A.size()) {\n    cout << A[i].F << \" \" << A[i].S << \" \";\n  }\n  cout << \"$\" << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\ntypedef pair<char, ll> pci;\nvector<pci> a, b, c;\n\nint main()\n{\n\tchar let; ll n;\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\ta.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tb.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tc.emplace_back(let, n);\n\t}\n\tint sza = a.size(), szb = b.size(), szc = c.size();\n\tvector<pci> res;\n\t\n\tREP(i, sza - szb + 1)\n\t{\n\t\tif (a[i].first == b[0].first&&a[i].second >= b[0].second)\n\t\t{\n\t\t\tbool f = true;\n\t\t\tint j;\n\t\t\tfor (j = 1; j < szb; j++)\n\t\t\t{\n\t\t\t\tif (j == szb - 1)\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second > a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second != a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (f)\n\t\t\t{\n\t\t\t\tif (szb <= 1)\n\t\t\t\t{\n\t\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\t\tif (a[i].second > b[0].second) res.emplace_back(a[i].first, a[i].second - b[0].second);\n\t\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\t\tif (a[i].second > b[0].second) res.emplace_back(a[i].first, a[i].second - b[0].second);\n\t\t\t\t\tREP(k, szc) res.emplace_back(c[k]);\n\t\t\t\t\tif (a[i + szb - 1].second > b.back().second) res.emplace_back(b.back().first, a[i + b.size() - 1].second - b.back().second);\n\t\t\t\t\tFOR(k, i + szb, sza) res.emplace_back(a[k]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tvector<pci> ans;\n\tif (res.size() == 0) ans = a;\n\telse\n\t{\n\t\tans.emplace_back(res[0]);\n\t\tFOR(i, 1, res.size())\n\t\t{\n\t\t\tif (res[i].first == ans.back().first) ans.back().second += res[i].second;\n\t\t\telse ans.emplace_back(res[i]);\n\t\t}\n\t}\n\tREP(i, ans.size()) cout << ans[i].first << \" \" << ans[i].second << \" \";\n\tcout << \"$\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\n\nvector<P>A,B,C;\nvoid input(vector<P> &a){\n  int num;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin>>num;\n    a.push_back(P(ch,num));\n  }\n}\n\nbool check(int i){\n  int n = A.size();\n  int m = B.size();\n  if(i+m>n) return 0;\n  if(A[i].first!=B[0].first||A[i].second<B[0].second)return 0;\n  if(m == 1) return 1;\n\n  i++;\n  for(int j=1;i<m-1;j++,i++)\n    if(A[i].first!=B[j].first||A[i].second!=B[j].second)return 0;\n  \n  if(A[i].first!=B[m-1].first||A[i].second<B[m-1].second)return 0;\n  return 1;\n}\n\nvoid mergePush(vector<P> &res,P a){\n  int c = a.second;\n  char ch = a.first;\n  if(c == 0)return;\n  if(res.size() && res.back().first == ch)res.back().second+=c;\n  else res.push_back(P(ch,c));\n}\n\nvector<P> solve(){\n  vector<P> res;\n  int n = A.size();\n  int m = B.size();\n  int l = C.size();\n  int flg = 0;\n  for(int i=0;i<n;i++){\n    if(!check(i)||flg++){mergePush(res,A[i]);continue;}\n    A[i].second -= B[0].second;\n    if(m == 1){\n      for(int j=0;j<l;j++) mergePush(res,C[j]);\n      mergePush(res,P(A[i].first,A[i].second));   \n    }\n    else {\n      for(int j=0;j<l;j++) mergePush(res,C[j]);\n      A[i+m-1].second -= B.back().second;\n    }\n  }\n  return res;\n}\n\n\nint main(){\n  input(A),input(B),input(C);\n  vector<P> ans = solve();\n  for(P a:ans) cout<<a.first<<\" \"<<a.second<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing P=pair<char,int>;\n\nint main(){\n    vector<P> A,B,C;\n    char c;\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        A.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        B.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        C.emplace_back(c,l);\n    }\n    vector<P> ans;\n    for(int i=0;i<A.size();i++){\n        if(A[i].first==B.front().first&&A[i].second>=B.front().second){\n            bool flag=true;\n            if(i+B.size()<=A.size()){\n                for(int d=1;d<B.size();d++){\n                    if(A[i+d].first!=B[d].first){\n                        flag=false;\n                        break;\n                    }\n                    if(d!=B.size()-1){\n                        if(A[i+d].second!=B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }else{\n                        if(A[i+d].second<B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }\n                }\n            }else{\n                continue;\n            }\n            if(flag){\n                for(int j=0;j<i;j++){\n                    ans.push_back(A[j]);\n                }\n                if(A[i].second!=B[0].second){\n                    ans.emplace_back(A[i].first,A[i].second-B[0].second);\n                }\n                for(int j=0;j<C.size();j++){\n                    if(j==0&&!ans.empty()&&ans.back().first==C.front().first){\n                        ans.back().second+=C.front().second;\n                    }else{\n                        ans.push_back(C[j]);\n                    }\n                }\n\n                if(B.size()>=2&&A[i+B.size()-1].second!=B.back().second){\n                    if(ans.back().first==B.back().first){\n                        ans.back().second+=A[i+B.size()-1].second-B.back().second;\n                    }else{\n                        ans.emplace_back(B.back().first, A[i+B.size()-1].second-B.back().second);\n                    }\n                }\n                for(int j=i+B.size();j<A.size();j++){\n                    ans.push_back(A[j]);\n                }\n                for(auto p:ans){\n                    char c; int l;\n                    tie(c,l)=p;\n                    cout<<c<<' '<<l<<' ';\n                }\n                cout<<'$'<<endl;\n                /*\n                {\n                    bool b=true;\n                    for(int i=0;i<A.size();i++){\n                        if(A[i]!=B[i]){\n                            cout<<i<<' '<<A[i].first<<' '<<A[i].second<<' '<<B[i].first<<' '<<B[i].second<<endl;\n                        }\n                    }\n                    cout<<b<<endl;\n                }*/\n                \n                // cout<<A.size()<<endl;\n                // cout<<B.size()<<endl;\n                // cout<<C.size()<<endl;\n                // cout<<ans.size()<<endl;\n                 \n                return 0;\n            }\n        }   \n    }\n    for(auto p:A){\n        char c; int l;\n        tie(c,l)=p;\n        cout<<c<<' '<<l<<' ';\n    }\n    cout<<'$'<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\n//const int INF = 1e8;\nusing namespace std;\n\n#define int long long\n\nstruct Data{\n\tchar c;\n\tint n;\n\tData(char c, int n) : c(c), n(n) {}\n};\n\nvoid parser(vector<Data>& a){\n\tchar chr;\n\tint num;\n\twhile(cin >> chr, chr != '$'){\n\t\tcin >> num;\n\t\ta.emplace_back(chr, num);\n\t}\n}\n\nvector<Data> a, b, c, ans;\n\nbool canReplace(int idx){\n\trep(i,b.size()){\n\t\tif(a[i + idx].c != b[i].c) return false;\n\t\tif(i == 0 or i == b.size() - 1){\n\t\t\tif(a[i + idx].n < b[i].n) return false;\n\t\t}else{\n\t\t\tif(a[i + idx].n != b[i].n) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\nsigned main(){\n\tparser(a);\n\tparser(b);\n\tparser(c);\n\n\trep(i,static_cast<int>(a.size()) - static_cast<int>(b.size()) + 1){\n\t\tif(canReplace(i)){\n\t\t\trep(j,i) ans.emplace_back(a[j]);\n\n\t\t\tif(b.size() > 1){\n\t\t\t\ta[i].n -= b[0].n;\n\t\t\t\tif(a[i].n > 0) ans.emplace_back(a[i]);\n\t\t\t}\n\t\t\trep(j,c.size()) ans.emplace_back(c[j]);\n\n\t\t\ta[i + b.size() - 1].n -= b.back().n;\n\t\t\tif(a[i + b.size() - 1].n > 0) ans.emplace_back(a[i + b.size() - 1]);\n\t\t\trange(j,i + b.size(), a.size()) ans.emplace_back(a[j]);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif(ans.empty()) ans = a;\n\n\trep(i,ans.size()){\n\t\tif(i + 1 < ans.size() and ans[i + 1].c == ans[i].c){\n\t\t\tans[i + 1].n += ans[i].n;\n\t\t}else{\n\t\t\tcout << ans[i].c << ' ' << ans[i].n << ' ';\n\t\t}\n\t}\n\tcout << '$' << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "/*\n * 2684.cc: RLE Replacement\n */\n\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<iostream>\n#include<string>\n#include<vector>\n#include<map>\n#include<set>\n#include<stack>\n#include<list>\n#include<queue>\n#include<deque>\n#include<algorithm>\n#include<numeric>\n#include<utility>\n#include<complex>\n#include<functional>\n \nusing namespace std;\n\n/* constant */\n\nconst int MAX_N = 1000;\n\n/* typedef */\n\ntypedef pair<char,int> pci;\ntypedef vector<pci> vpci;\n\n/* global variables */\n\n/* subroutines */\n\nvoid read_rle(vpci &v) {\n  for (;;) {\n    char ch;\n    cin >> ch;\n    if (ch == '$') break;\n\n    int l;\n    cin >> l;\n    v.push_back(pci(ch, l));\n  }\n}\n\nvoid print_rle(vpci &v) {\n  for (int i = 0; i < v.size(); i++)\n    printf(\"%c %d \", v[i].first, v[i].second);\n  putchar('$'); putchar('\\n');\n}\n\n/* main */\n\nint main() {\n  vpci va, vb, vc;\n  read_rle(va);\n  read_rle(vb);\n  read_rle(vc);\n  int van =  va.size(), vbn = vb.size(), vcn = vc.size();\n  //printf(\"%d %d %d\\n\", an, bn, cn);\n\n\n  int k = 0;\n  for (; k <= van - vbn; k++) {\n    bool ok = true;\n    if (va[k].first != vb[0].first ||\n\tva[k].second < vb[0].second ||\n\tva[k + vbn - 1].first != vb[vbn - 1].first ||\n\tva[k + vbn - 1].second < vb[vbn - 1].second) ok = false;\n    else\n      for (int i = 1; ok && i < vbn - 1; i++)\n\tif (va[k + i].first != vb[i].first ||\n\t    va[k + i].second != vb[i].second) ok = false;\n    if (ok) break;\n  }\n  //printf(\"k=%d\\n\", k);\n\n  if (k > van - vbn) {\n    print_rle(va);\n    return 0;\n  }\n\n  vpci vt;\n  for (int i = 0; i < k; i++) vt.push_back(va[i]);\n  int l0 = va[k].second - vb[0].second;\n  if (l0 > 0) vt.push_back(pci(va[k].first, l0));\n  for (int i = 0; i < vcn; i++) vt.push_back(vc[i]);\n  int l1 = va[k + vbn - 1].second - vb[vbn - 1].second;\n  if (l1 > 0) vt.push_back(pci(va[k + vbn - 1].first, l1));\n  for (int i = k + vbn; i < van; i++) vt.push_back(pci(va[i]));\n  //print_rle(vt);\n\n  vpci vr;\n  pci prv = vt[0];\n  for (int i = 1; i < vt.size(); i++) {\n    if (prv.first == vt[i].first) prv.second += vt[i].second;\n    else {\n      vr.push_back(prv);\n      prv = vt[i];\n    }\n  }\n  vr.push_back(prv);\n\n  print_rle(vr);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <sstream>\n\nusing namespace std;\n\nusing Array = basic_string<pair<char, int>>;\nArray a, b, c;\n\nvoid output(const Array &xs){\n    for(auto &x : xs){\n        cout << '[' << x.first << ',' << x.second << ']';\n    }\n};\n\nvoid input(Array &a) {\n    string c; int l;\n    while (cin >> c, c[0] != '$') {\n        cin >> l;\n        a += make_pair(c[0], l);\n    }\n}\n\nint main(){\n    input(a);\n    input(b);\n    input(c);\n    a = make_pair('0', 0) + a + make_pair('0', 0);\n    if (b.size() == 1) {\n        for (int i = 0; i < a.size(); ++i) {\n            if (a[i].first == b[0].first && a[i].second >= b[0].second) {\n                a[i].second -= b[0].second;\n                a = a.substr(0, i) + c + a.substr(i);\n                break;\n            }\n        }\n    } else {\n        for (int i = 1; i + b.size() - 2 <= a.size(); ++i) {\n            if (b.substr(1, b.size() - 2) == a.substr(i, b.size() - 2)) {\n                if (a[i - 1].first == b[0].first && a[i - 1].second >= b[0].second &&\n                    a[i + b.size() - 2].first == b.back().first && a[i + b.size() - 2].second >= b.back().second) {\n                    // cout << i << endl;\n                    a[i - 1].second -= b[0].second;\n                    a[i + b.size() - 2].second -= b.back().second;\n                    a = a.substr(0, i) + c + a.substr(i + b.size() - 2);\n                    break;\n                }\n            }\n        }\n    }\n\n    a.erase(remove_if(a.begin(), a.end(), [](pair<char,int> x){ return x.second == 0; }), a.end());\n    for (int i = 0; i < a.size(); ++i) {\n        int j = i + 1;\n        while(j < a.size() && a[i].first == a[j].first){\n            a[i].second += a[j].second;\n            a[j].second = 0;\n            ++j;\n        }\n    }\n    for (int i = 0; i < a.size(); ++i) {\n        cout << a[i].first << ' ' << a[i].second << ' ';\n    }\n    cout << '$' << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\nusing namespace std;\ntypedef pair<char,int> P;\nint main(){\n  vector <P> a,b,c;\n  int i,j,k;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    a.push_back(P(ch,k));\n  }\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    b.push_back(P(ch,k));\n  }\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    c.push_back(P(ch,k));\n  }\n  for(i=0;i+b.size()<=a.size();i++){\n    if(a[i].first!=b[0].first||a[i].second<b[0].second) continue;\n    bool f = true;\n    k=b.size()-1;\n    for(j=1;j<k;j++){\n      if(a[i+j].first!=b[j].first||a[i+j].second!=b[j].second) {\n\tf=false;\n\tbreak;\n      }\n    }\n    if(a[i+k].first!=b[k].first||a[i+k].second<b[k].second) continue;\n    if(f){\n      //cout << i << endl;\n      for(j=0;j<k+1;j++){\n\ta[i+j].second-=b[j].second;\n      }\n      a.insert(a.begin()+i+1,c.begin(),c.end());\n      break;\n    }\n  }\n  k=0;\n  while(k<a.size()){\n    if(a[k].second==0) a.erase(a.begin()+k);\n    else k++;\n  }\n\n  \n  for(i=0;i<a.size()-1;i++){\n    //cout << i << a[i].first << a[i+1].first << endl;\n    if(a[i].first==a[i+1].first){\n      a[i+1].second+=a[i].second;\n      a[i].second=0;\n    }\n  }\n  \n  for(i=0;i<a.size();i++){\n    if(a[i].second==0) continue;\n    cout << a[i].first << \" \" << a[i].second << \" \";\n  }\n  cout << \"$\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\n#define F first\n#define S second\ntypedef long long ll;\ntypedef pair<char, ll> P;\n\nint main()\n{\n    ll len[3];\n    vector<P> X[3];\n    for (int i = 0; i < 3; i++) {\n        char c;\n        ll l;\n        while (cin >> c, c != '$') {\n            cin >> l;\n            X[i].push_back(P(c, l));\n        }\n        len[i] = X[i].size();\n    }\n    for (int i = 0; i <= len[0]-len[1]; i++) {\n        bool same = 1;\n        for (int j = i; j < i+len[1]; j++) {\n            if (X[1][j-i].F != X[0][j].F ||\n                (i < j && j < i+len[1]-1 && X[1][j-i].S != X[0][j].S)) {\n                same = 0;\n                break;\n            }\n        }\n        if (len[1] == 1) {\n            if (X[1][0].F != X[0][i].F || X[0][i].S < X[1][0].S) {\n                continue;\n            }\n        }\n        if (same) {\n            vector<P> v, res;\n            for (int j = 0; j < i; j++) {\n                v.push_back(X[0][j]);\n            }\n            ll diff = X[0][i].S - X[1][0].S;\n            if (len[1] != 1) {\n                if (diff > 0) {\n                    v.push_back(P(X[0][i].F, diff));      \n                }\n                for (int j = 0; j < len[2]; j++) {\n                    v.push_back(X[2][j]);\n                }\n                diff = X[0][i+len[1]-1].S - X[1][len[1]-1].S;\n                if (diff > 0) {\n                    v.push_back(P(X[0][i+len[1]-1].F, diff));\n                }\n            } else {\n                for (int j = 0; j < len[2]; j++) {\n                    v.push_back(X[2][j]);\n                }                \n                if (diff > 0) {\n                    v.push_back(P(X[0][i].F, diff));   \n                }\n            }\n            for (int j = i+len[1]; j < len[0]; j++) {\n                v.push_back(X[0][j]);\n            }\n            \n            for (int j = 0; j < (int)v.size(); ) {\n                ll k = j, sum = 0;\n                while (k < (ll)v.size() &&\n                       v[j].F == v[k].F) {\n                    sum += v[k].S;\n                    k++;\n                }\n                res.push_back(P(v[j].F, sum));\n                j = k;\n            }\n            \n            for (int j = 0; j < (int)res.size(); j++) {\n                cout << res[j].F << \" \" << res[j].S << \" \";\n            }\n            cout << \"$\" << endl;\n            break;\n        }\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define f first\n#define s second\n#define mp make_pair\nusing namespace std;\n\nint main()\n{\n  vector<pair<char,long long> > A,B,C;\n  char c;\n  int a;\n\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    A.push_back(mp(c,a));\n  }\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    B.push_back(mp(c,a));\n  }\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    C.push_back(mp(c,a));\n  }\n  int size=A.size()-B.size()+1;\n  for(int i=0;i<=size;i++){\n    bool flag=true;\n    for(int j=0;j<B.size();j++){\n      if(j==0 || j==B.size()-1){\n\tif(A[i+j].f!=B[j].f || A[i+j].s<B[j].s)flag=false;\n      }\n      else {\n\tif(A[i+j].f!=B[j].f || A[i+j].s!=B[j].s)flag=false;\n      }\n    }\n    if(flag){\n      for(int j=0;j<B.size();j++)A[i+j].s-=B[j].s;\n      A.insert(A.begin()+i+1,C.begin(),C.end());\n      size+=C.size();\n      for(int j=0;j<A.size();j++){\n\tif(A[j].s==0){\n\t  A.erase(A.begin()+j);\n\t  j--;\n\t  size--;\n\t}\n      }\n      for(int j=1;j<A.size();j++){\n\tif(A[j].f==A[j-1].f){\n\t  A[j-1].s+=A[j].s;\n\t  A.erase(A.begin()+j);\n\t  j--;\n\t  size--;\n\t}\n      }\n    }\n  }\n\n  for(int i=0;i<A.size();i++)cout<<A[i].f<<\" \"<<A[i].s<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\n//const int INF = 1e8;\nusing namespace std;\n\n#define int long long\n\nstruct Data{\n\tchar c;\n\tint n;\n\tData(char c, int n) : c(c), n(n) {}\n};\n\nvoid parser(list<Data>& a){\n\tchar chr;\n\tint num;\n\twhile(cin >> chr, chr != '$'){\n\t\tcin >> num;\n\t\ta.emplace_back(chr, num);\n\t}\n}\n\nlist<Data> a, b, c;\n\nbool canReplace(list<Data>::iterator it){\n\tint idx = 0;\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n\tfor(auto i = it, j = b.begin(); j != b.end(); i++, j++, idx++){\n\t\tif(i->c != j->c) return false;\n\t\tif(idx == 0 or idx == b.size() - 1){\n\t\t\tif(i->n < j->n) return false;\n\t\t}else{\n\t\t\tif(i->n != j->n) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\n\nvoid replaceList(list<Data>::iterator& it){\n\tint loop = 1;\n\tif(b.size() == 1){\n\t\tint loop = it->n / b.begin()->n;\n\t\tit->n -= loop * b.begin()->n;\n\t\tif(it->n == 0) it = a.erase(it);\n\t}else{\n\t\trep(i,b.size()){\n\t\t\tif(i == 0){\n\t\t\t\tit->n -= (*b.begin()).n;\n\t\t\t\tif(it->n == 0) it = a.erase(it);\n\t\t\t\telse it++;\n\t\t\t}else if(i == b.size() - 1){\n\t\t\t\tit->n -= (*--b.end()).n;\n\t\t\t\tif(it->n == 0) it = a.erase(it);\n\t\t\t}else{\n\t\t\t\tit = a.erase(it);\n\t\t\t}\n\t\t}\n\t}\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n\t//for(auto i : c){ cout << i.c; } cout << endl;\n\twhile(loop--){\n\t\tfor(auto& i : c){\n\t\t\ta.insert(it,i);\n\t\t}\n\t}\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n}\n\nbool check(){\n\tint idx = 0;\n\tbool f = false;\n\tfor(auto it = a.begin(); idx + b.size() <= a.size(); it++, idx++){\n\t\tif(canReplace(it)){\n\t\t\treplaceList(it);\n\t\t\tf = true;\n\t\t}\n\t}\n\treturn f;\n}\n\nvoid compress(){\n\tauto it = a.begin();\n\twhile(it != a.end()){\n\t\tif(it->c == next(it, 1)->c){\n\t\t\tit->n += next(it, 1)->n;\n\t\t\ta.erase(next(it,1));\n\t\t}else if(it->n == 0){\n\t\t\tit = a.erase(it);\n\t\t}else{\n\t\t\tit++;\n\t\t}\n\t}\n}\n\nbool comp(){\n\n\tint idx = 0;\n\tfor(auto i = a.begin(), j = b.begin(); i != a.end(); i++, j++, idx++){\n\t\tif(i->c != j->c or i->n != j->n){\n\t\t\tshow(idx)\n\t\tcout << i->c << ' ' << j->c << endl;\n\t\tcout << i->n << ' ' << j->n << endl;\n return true;\n\t\t}\n\t}\n\treturn false;\n}\n\nsigned main(){\n\tparser(a);\n\tparser(b);\n\tparser(c);\n\n\n\twhile(true){\n\t\tcompress();\n\t\tif(check() == false) break;\n\t}\n\t\n\tfor(auto i : a){\n\t\tcout << i.c << ' ' << i.n << ' ';\n\t}\n\tcout << '$' << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n#include <fstream>\n\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\n#define watch(a) { cout << #a << \" = \" << a << endl; }\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntypedef long long ll;\nint const inf = 1<<29;\n\nvoid change(deque<pair<char, int>>& nv0) {\n  if(nv0.size() > 1 && nv0[nv0.size()-2].first == nv0.back().first) {\n    int k = nv0.back().second;\n    nv0.pop_back();\n    nv0.back().second += k;\n  }\n}\n\nvoid output(deque<pair<char, int>>& out) {\n  rep(i, out.size()) {\n    if(i) cout << \" \";\n    cout << out[i].first << \" \" << out[i].second;\n  }\n  cout << \" $\" << endl;\n}\n\nint main() {\n\n  vector<deque<pair<char, int>>> v(3);\n  for(auto& u: v) {\n    while(1) {\n      char c; cin >> c;\n      if(c == '$') break;\n      int n; cin >> n;\n      u.emplace_back(c, n);\n    }\n  }\n\n  rep(i, (int)v[0].size()-(int)v[1].size()+1) {\n\n    if(v[1].size() == 1) {\n      const int a = v[0][i].second, b = v[1][0].second;\n      if(v[0][i].first == v[1][0].first && a >= b) {\n        deque<pair<char, int>> nv0;\n        rep(k, i) {\n          nv0.push_back(v[0][k]);\n        }\n\n        rep(k, v[2].size()) {\n          nv0.push_back(v[2][k]);\n          change(nv0);\n        }\n\n        if(a - b > 0) {\n          nv0.push_back(v[0][i]);\n          nv0.back().second = a - b;\n        }\n        REP(k, i+1, v[0].size()) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n        v[0] = nv0;\n        break;\n      } else {\n        continue;\n      }\n\n    }\n\n    int j = 0;\n    vector<int> V;\n    while(j < v[1].size() && v[0][i+j].first == v[1][j].first) {\n      if(j == 0 || j == (int)v[1].size()-1) {\n        if(v[0][i+j].second < v[1][j].second) break;\n        V.push_back(v[0][i+j].second - v[1][j].second);\n      }\n      else {\n        if(v[0][i+j].second != v[1][j].second) break;\n      }\n      j++;\n    }\n\n    deque<pair<char, int>> nv0;\n\n    if(j == v[1].size()) {\n      rep(k, v[0].size()) {\n        if(k < i) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n        if(k == i) {\n          if(V[0] > 0) nv0.emplace_back(v[0][i].first, V[0]);\n          rep(l, v[2].size()) {\n            nv0.push_back(v[2][l]);\n            change(nv0);\n          }\n          k = i+v[1].size()-1;\n        }\n        if(k == i+j-1) {\n          if(V[1] > 0) nv0.emplace_back(v[0][i+j-1].first, V[1]);\n          change(nv0);\n        }\n        if(i+j <= k) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n      }\n      v[0] = nv0;\n      break;\n    }\n  }\n\n  output(v[0]);\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\n#define F first\n#define S second\ntypedef long long ll;\ntypedef pair<char, ll> P;\n\nint main()\n{\n    ll len[3];    \n    vector<P> X[3];\n    for (int i = 0; i < 3; i++) {\n        char c;\n        ll l;\n        while (cin >> c, c != '$') {\n            cin >> l;\n            X[i].push_back(P(c, l));\n        }\n        len[i] = X[i].size();\n    }\n    for (int i = 0; i <= len[0]-len[1]; i++) {\n        bool same = 1;\n        for (int j = i; j < i+len[1]; j++) {\n            if (X[1][j-i].F != X[0][j].F ||\n                (i < j && j < i+len[1]-1 && X[1][j-i].S != X[0][j].S)) {\n                same = 0;\n                break;\n            }\n        }\n        if (X[0][i].S < X[1][0].S || X[0][i+len[1]-1].S < X[1][len[1]-1].S) {\n            continue;\n        }\n\n        if (same) {\n            vector<P> v, res;\n            for (int j = 0; j < i; j++) {\n                v.push_back(X[0][j]);\n            }\n            ll diff = X[0][i].S - X[1][0].S;\n            if (len[1] != 1) {\n                if (diff > 0) {\n                    v.push_back(P(X[0][i].F, diff));      \n                }\n                for (int j = 0; j < len[2]; j++) {\n                    v.push_back(X[2][j]);\n                }\n                diff = X[0][i+len[1]-1].S - X[1][len[1]-1].S;\n                if (diff > 0) {\n                    v.push_back(P(X[0][i+len[1]-1].F, diff));\n                }\n            } else {\n                for (int j = 0; j < len[2]; j++) {\n                    v.push_back(X[2][j]);\n                }                \n                if (diff > 0) {\n                    v.push_back(P(X[0][i].F, diff));   \n                }\n            }\n            for (int j = i+len[1]; j < len[0]; j++) {\n                v.push_back(X[0][j]);\n            }\n            \n            for (int j = 0; j < (int)v.size(); ) {\n                ll k = j, sum = 0;\n                while (k < (ll)v.size() &&\n                       v[j].F == v[k].F) {\n                    sum += v[k].S;\n                    k++;\n                }\n                res.push_back(P(v[j].F, sum));\n                j = k;\n            }\n            X[0] = res;\n            break;\n        }\n    }\n    for (int i = 0; i < X[0].size(); i++) {\n        cout << X[0][i].F << \" \" << X[0][i].S << \" \";\n    }\n    cout << \"$\" << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 998244353;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef long double ld;\ntypedef complex<ld> Point;\nconst ld eps = 1e-11;\nconst ld pi = acos(-1.0);\ntypedef pair<ll, ll> LP;\nint main() {\n\tchar at[1000]; int an[1000];\n\tchar bt[1000]; int bn[1000];\n\tchar ct[1000]; int cn[1000];\n\tchar x;\n\tint c1 = 0; int m;\n\twhile (cin >> x) {\n\t\tif (x == '$')break;\n\t\tcin >> m;\n\t\tat[c1] = x; an[c1] = m; c1++;\n\t}\n\tint c2 = 0;\n\twhile (cin >> x) {\n\t\tif (x == '$')break;\n\t\tcin >> m;\n\t\tbt[c2] = x; bn[c2] = m; c2++;\n\t}\n\tint c3 = 0;\n\twhile (cin >> x) {\n\t\tif (x == '$')break;\n\t\tcin >> m;\n\t\tct[c3] = x; cn[c3] = m; c3++;\n\t}\n\tint chk = -1;\n\trep(i, c1 - c2+1) {\n\t\tif (at[i] == bt[0]) {\n\t\t\tbool f = true;\n\t\t\tif (an[i] < bn[0])f = false;\n\t\t\tRep(k, 1 ,c2-1){\n\t\t\t\tif (at[i + k] != bt[k] || an[i + k] != bn[k])f = false;\n\t\t\t}\n\t\t\tif (an[i + c2 - 1] < bn[i + c2 - i])f = false;\n\t\t\tif (f) {\n\t\t\t\tchk = i; break;\n\t\t\t}\n\t\t}\n\t}\n\tqueue<pair<char, int>> q1, q2;\n\tif (chk == -1) {\n\t\trep(i, c1) {\n\t\t\tq1.push({ at[i],an[i] });\n\t\t}\n\t}\n\telse {\n\t\trep(i, chk - 1) {\n\t\t\tq1.push({ at[i],an[i] });\n\t    }\n\t\tif (an[chk] - bn[chk] > 0) {\n\t\t\tq1.push({ at[chk],an[chk] - bn[chk] });\n\t\t}\n\t\trep(i, c3) {\n\t\t\tq1.push({ ct[i],cn[i] });\n\t\t}\n\t\tif (an[chk + c2 - 1] - bn[chk + c2 - 1] > 0) {\n\t\t\tq1.push({ at[chk + c2 - 1],an[chk + c2 - 1] - bn[chk + c2 - 1] });\n\t\t}\n\t\tRep(i, chk + c2, c1) {\n\t\t\tq1.push({ at[i],an[i] });\n\t\t}\n\t}\n\tpair<char, int>memo = { '#',-1 };\n\twhile (!q1.empty()) {\n\t\tpair<char, int> now = q1.front(); q1.pop();\n\t\tif (now.first == memo.first) {\n\t\t\tmemo.second += now.second;\n\t\t}\n\t\telse {\n\t\t\tif (memo.second >= 0) {\n\t\t\t\tq2.push(memo);\n\t\t\t}\n\t\t\tmemo = now;\n\t\t}\n\t}\n\tq2.push(memo);\n\twhile (!q2.empty()) {\n\t\tpair<char, int> out = q2.front(); q2.pop();\n\t\tcout << out.first << \" \" << out.second << \" \";\n\t}\n\tcout << '$' << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "// g++ -std=c++11 a.cpp\n#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<unordered_map>\n#include<utility>\n#include<cmath>\n#include<random>\n#include<cstring>\n#include<queue>\n#include<stack>\n#include<bitset>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#include<assert.h>\n#include<typeinfo>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define FOR(i,a) for(auto i:a)\n#define pb push_back\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n#define show1d(v) rep(_,v.size())cout<<\" \"<<v[_];cout<<endl;\n#define show2d(v) rep(_,v.size()){rep(__,v[_].size())cout<<\" \"<<v[_][__];cout<<endl;}cout<<endl;\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\n#define int ll\ntypedef int Def;\ntypedef pair<Def,Def> pii;\ntypedef vector<Def> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef pair<Def,pii> pip;\ntypedef vector<pip>vip;\n// #define mt make_tuple\n// typedef tuple<int,int,int> tp;\n// typedef vector<tp> vt;\ntemplate<typename A,typename B>bool cmin(A &a,const B &b){return a>b?(a=b,true):false;}\ntemplate<typename A,typename B>bool cmax(A &a,const B &b){return a<b?(a=b,true):false;}\n//template<class C>constexpr int size(const C &c){return (int)c.size();}\n//template<class T,size_t N> constexpr int size(const T (&xs)[N])noexcept{return (int)N;}\nconst double PI=acos(-1);\nconst double EPS=1e-9;\nDef inf = sizeof(Def) == sizeof(long long) ? 1e18+10 : 1e9+10;\nint dx[]={0,1,0,-1,1,1,-1,-1};\nint dy[]={1,0,-1,0,1,-1,1,-1};//RDLU\nsigned main(){\n\tvp a,b,c;\n\tchar q;int w;\n\twhile(cin>>q){\n\t\tif(q=='$')break;\n\t\tcin>>w;\n\t\ta.pb({q,w});\n\t}\n\twhile(cin>>q){\n\t\tif(q=='$')break;\n\t\tcin>>w;\n\t\tb.pb({q,w});\n\t}\n\twhile(cin>>q){\n\t\tif(q=='$')break;\n\t\tcin>>w;\n\t\tc.pb({q,w});\n\t}\n\tif(b.size()==1){\n\t\trep(i,a.size())if(a[i].first==b[0].first&&a[i].second>=b[0].second){\n\t\t\tvp out;\n\t\t\trep(j,i)out.pb(a[j]);\n\t\t\trep(j,c.size())out.pb(c[j]);\n\t\t\tif(a[i].second!=b[0].second)out.pb({a[i].first,a[i].second-b[0].second});\n\t\t\tloop(j,i+1,a.size())out.pb(a[j]);\n\t\t\ta=out;\n\t\t\tbreak;\n\t\t}\n\t}else{\n\t\trep(i,a.size()){\n\t\t\tif(a.size()-i<b.size())break;\n\t\t\tbool h=true;\n\t\t\tloop(j,i+1,i+b.size()-1){\n\t\t\t\tif(a[j]!=b[j-i])h=false;\n\t\t\t}\n\t\t\tif(!h)continue;\n\t\t\tif(a[i].first!=b[0].first||a[i].second<b[0].second)continue;\n\t\t\tif(a[i+b.size()-1].first!=b[b.size()-1].first||a[i+b.size()-1].second<b[b.size()-1].second)continue;\n\t\t\tvp out;\n\t\t\trep(j,i)out.pb(a[j]);\n\t\t\tif(a[i].second>b[0].second)out.pb({a[i].first,a[i].second-b[0].second});\n\t\t\trep(j,c.size())out.pb(c[j]);\n\t\t\tif(a[i+b.size()-1].second>b[b.size()-1].second)out.pb({a[i+b.size()-1].first,a[i+b.size()-1].second-b[b.size()-1].second});\n\t\t\tloop(j,i+b.size(),a.size())out.pb(a[j]);\n\t\t\ta=out;\n\t\t\tbreak;\n\t\t}\n\t}\n\trep(i,a.size()-1)if(a[i].first==a[i+1].first){\n\t\ta[i].second+=a[i+1].second;\n\t\ta.erase(a.begin()+i+1);\n\t\ti--;\n\t}\n\trep(i,a.size())cout<<(char)a[i].first<<\" \"<<a[i].second<<\" \";cout<<\"$\"<<endl;\n}\n/*\nR 100 L 20 E 10 $\nR 5 L 10 $\nX 20 $\n\nA 3 B 3 A 3 $\nA 1 B 3 A 1 $\nA 2 $\n*/\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\n//const int INF = 1e8;\nusing namespace std;\n\n#define int long long\n\nstruct Data{\n\tchar c;\n\tint n;\n\tData(char c, int n) : c(c), n(n) {}\n};\n\nvoid parser(list<Data>& a){\n\tchar chr;\n\tint num;\n\twhile(cin >> chr, chr != '$'){\n\t\tcin >> num;\n\t\ta.emplace_back(chr, num);\n\t}\n}\n\nlist<Data> a, b, c;\n\nbool canReplace(list<Data>::iterator it){\n\tint idx = 0;\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n\tfor(auto i = it, j = b.begin(); j != b.end(); i++, j++, idx++){\n\t\tif(i->c != j->c) return false;\n\t\tif(idx == 0 or idx == b.size() - 1){\n\t\t\tif(i->n < j->n) return false;\n\t\t}else{\n\t\t\tif(i->n != j->n) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\n\nvoid replaceList(list<Data>::iterator& it){\n\trep(i,b.size()){\n\t\tif(i == 0){\n\t\t\tit->n -= (*b.begin()).n;\n\t\t\tif(it->n == 0) it = a.erase(it);\n\t\t\telse it++;\n\t\t}else if(i == b.size() - 1){\n\t\t\tit->n -= (*--b.end()).n;\n\t\t\tif(it->n == 0) it = a.erase(it);\n\t\t}else{\n\t\t\tit = a.erase(it);\n\t\t}\n\t}\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n\t//for(auto i : c){ cout << i.c; } cout << endl;\n\tfor(auto& i : c){\n\t\ta.insert(it,i);\n\t}\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n}\n\nbool check(){\n\tint idx = 0;\n\tbool f = false;\n\tfor(auto it = a.begin(); idx + b.size() <= a.size(); it++, idx++){\n\t\tif(canReplace(it)){\n\t\t\treplaceList(it);\n\t\t\tf = true;\n\t\t}\n\t}\n\treturn f;\n}\n\nvoid compress(){\n\tauto it = a.begin();\n\twhile(it != a.end()){\n\t\tif(it->c == next(it, 1)->c){\n\t\t\tit->n += next(it, 1)->n;\n\t\t\ta.erase(next(it,1));\n\t\t}else if(it->n == 0){\n\t\t\tit = a.erase(it);\n\t\t}else{\n\t\t\tit++;\n\t\t}\n\t}\n}\n\nbool comp(){\n\n\tint idx = 0;\n\tfor(auto i = a.begin(), j = b.begin(); i != a.end(); i++, j++, idx++){\n\t\tif(i->c != j->c or i->n != j->n){\n\t\t\tshow(idx)\n\t\tcout << i->c << ' ' << j->c << endl;\n\t\tcout << i->n << ' ' << j->n << endl;\n return true;\n\t\t}\n\t}\n\treturn false;\n}\n\nsigned main(){\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tparser(a);\n\tparser(b);\n\tparser(c);\n\n\n\twhile(true){\n\t\tcompress();\n\t\tif(check() == false) break;\n\t}\n\t\n\tfor(auto i : a){\n\t\tcout << i.c << ' ' << i.n << ' ';\n\t}\n\tcout << '$' << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "\n#include<iostream>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<cstdio>\nusing namespace std;\ntypedef long long ll;\nconst int MAXN = 2e3 + 10;\nchar s1[MAXN], s2[MAXN], s3[MAXN], tmp[3], ans[MAXN];\nll l1[MAXN], l2[MAXN], l3[MAXN], al[MAXN];\nint t1, t2, t3, t4;\nvoid addword(char* s, ll* l, int& tt, char c, ll tn){\n\tif (tt == 0 || s[tt - 1] != c){\n\t\ts[tt] = c;\n\t\tl[tt] = tn;\n\t\t++tt;\n\t}\n\telse{\n\t\tl[tt - 1] += tn;\n\t}\n}\nint main(){\n\tt1 = t2 = t3 = t4 = 0;\n\twhile (scanf(\"%s\", tmp) != EOF&&tmp[0] != '$'){\n\t\tll tttt;\n\t\tscanf(\"%I64d\", &tttt);\n\t\taddword(s1, l1, t1, tmp[0], tttt);\n\t}\n\twhile (scanf(\"%s\", tmp) != EOF&&tmp[0] != '$'){\n\t\tll tttt;\n\t\tscanf(\"%I64d\", &tttt);\n\t\taddword(s2, l2, t2, tmp[0], tttt);\n\t}\n\twhile (scanf(\"%s\", tmp) != EOF&&tmp[0] != '$'){\n\t\tll tttt;\n\t\tscanf(\"%I64d\", &tttt);\n\t\taddword(s3, l3, t3, tmp[0], tttt);\n\t}\n\tfor (int i = 0; i < t1; ++i){\n\t\tbool ff = true;\n\t\tfor (int j = 0; j < t2; ++j){\n\t\t\tint ti = i + j;\n\t\t\tif (s1[ti] != s2[j] || ((j == 0 && j == t2 - 1) && l1[ti] < l2[j]) || (j != 0 && j != t2 - 1 && l1[ti] != l2[j])){\n\t\t\t\tff = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (ff){\n\t\t\tif (l1[i] - l2[0] > 0)\n\t\t\t\taddword(ans, al, t4, s1[i], l1[i] - l2[0]);\n\t\t\tfor (int j = 0; j < t3; ++j){\n\t\t\t\taddword(ans, al, t4, s3[j], l3[j]);\n\t\t\t}\n\t\t\tif (t2 != 1 && l1[i + t2 - 1] - l2[t2 - 1]>0)\n\t\t\t\taddword(ans, al, t4, s1[i + t2 - 1], l1[i + t2 - 1] - l2[t2 - 1]);\n\t\t\tfor (int j = i + t2; j < t1; ++j){\n\t\t\t\taddword(ans, al, t4, s1[j], l1[j]);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\taddword(ans, al, t4, s1[i], l1[i]);\n\t}\n\tfor (int i = 0; i < t4; ++i){\n\t\tprintf(\"%c %I64d \", ans[i], al[i]);\n\t}\n\tprintf(\"$\\n\");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-9;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\nvector<pair<char, int>>comp(vector<pair<char, int>>ps) {\n\tvector<pair<char, int>>newps;\n\tfor (int i = 0; i < ps.size(); ++i) {\n\t\tif (i==ps.size()-1||ps[i].first != ps[i + 1].first) {\n\t\t\tif (ps[i].second) {\n\t\t\t\tnewps.push_back(ps[i]);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tps[i + 1].second += ps[i].second;\n\t\t}\n\t}\n\tps = newps;\n\tfor (int i = 0; i < ps.size(); ++i) {\n\t\tif (i == ps.size() - 1 || ps[i].first != ps[i + 1].first) {\n\t\t\tif (ps[i].second) {\n\t\t\t\tnewps.push_back(ps[i]);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tps[i + 1].second += ps[i].second;\n\t\t}\n\t}\n\treturn newps;\n}\nvoid input(vector<pair<char, int>>&p) {\n\twhile (1) {\n\t\tchar c; cin >> c;\n\t\tif (c == '$')break;\n\t\tint n; cin >> n;\n\t\tp.push_back(make_pair(c, n));\n\t}\n}\nint main() {\n\tvector<pair<char, int>>a, b, c;\n\tinput(a); input(b); input(c);\n\ta = comp(a); b = comp(b); c = comp(c);\n\tif (a.size() < b.size()) {\n\n\t}else\n\tif (b.size() == 1) {\n\t\tfor (int i = 0; i < a.size(); ++i) {\n\t\t\tif (a[i].first == b[0].first&&a[i].second>=b[0].second) {\n\t\t\t\ta[i].second -= b[0].second;\n\t\t\t\ta.insert(a.begin() + i, c.begin(),c.end());\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tfor (int l = 0; l <= a.size() - b.size(); ++l) {\n\t\t\tbool aok = true;\n\t\t\tif (a[l].first != b[0].first||a[l].second < b[0].second) {\n\t\t\t\taok = false;\n\t\t\t}\n\t\t\tfor (int i = 1; i < b.size() - 1; ++i) {\n\t\t\t\tif (a[l + i] != b[i]) {\n\t\t\t\t\taok = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (a[l+b.size()-1].first != b[b.size()-1].first || a[l + b.size() - 1].second < b[b.size() - 1].second) {\n\t\t\t\taok = false;\n\t\t\t}\n\t\t\tif (aok) {\n\t\t\t\ta[l].second -= b[0].second;\n\t\t\t\ta[l + b.size() - 1].second -= b[b.size() - 1].second;\n\t\t\t\ta.erase(a.begin() + l + 1, a.begin() + l + b.size() - 1);\n\t\t\t\ta.insert(a.begin() + l + 1, c.begin(), c.end());\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\ta = comp(a);\n\tfor (int i = 0; i < a.size(); ++i) {\n\t\tcout << a[i].first << \" \" << a[i].second << \" \";\n\t}\n\tcout << \"$\" << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "/* template.cpp {{{ */\n#include <bits/stdc++.h>\nusing namespace std;\n\nnamespace solver {\n\n#define GET_MACRO(a, b, c, d, NAME, ...) NAME\n#define REP1(n) REP2(i_, n)\n#define REP2(i, n) REP3(i, 0, n)\n#define REP3(i, a, b) REP4(i, a, b, 1)\n#define REP4(i, a, b, s) for (ll i = (a); i < (ll)(b); i += (ll)(s))\n#define RREP1(n) RREP2(i_, n)\n#define RREP2(i, n) RREP3(i, 0, n)\n#define RREP3(i, a, b) RREP4(i, a, b, 1)\n#define RREP4(i, a, b, s) for (ll i = (b) - 1; i >= (ll)(a); i -= (ll)(s))\n#define rep(...) GET_MACRO(__VA_ARGS__, REP4, REP3, REP2, REP1)(__VA_ARGS__)\n#define rrep(...) GET_MACRO(__VA_ARGS__, RREP4, RREP3, RREP2, RREP1)(__VA_ARGS__)\n#define each(x, c) for (auto &&x : c)\n#define all(c) std::begin(c), std::end(c)\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing uint = unsigned int;\nusing ld = long double;\ntemplate<typename T>\nusing MinPQ = priority_queue<T, vector<T>, greater<T>>;\ntemplate<typename T>\nusing MaxPQ = priority_queue<T, vector<T>, less<T>>;\ntemplate<bool cond, typename T = void>\nusing enable_if_t = typename enable_if<cond, T>::type;\n\nconst int INF = 1e9 + 10;\nconst ll INF_LL = 1e18 + 10;\nconst double INF_D = 1e12;\nconst ld INF_LD = 1e24;\nconst ld EPS = 1e-8;\nconst ld PI = acos(-1.0l);\nconst int dx[] = {-1, 0, 1, 0, -1, 1, 1, -1};\nconst int dy[] = {0, -1, 0, 1, -1, -1, 1, 1};\n\ntemplate<typename T>\ninline T sq(const T &x){ return x * x; }\ntemplate<typename T, typename U>\ninline T &chmin(T &x, const U &y){ if (x > y) x = y; return x; }\ntemplate<typename T, typename U>\ninline T &chmax(T &x, const U &y){ if (x < y) x = y; return x; }\n\nll gcd(ll a, ll b){ return b ? gcd(b, a % b) : a; }\nll lcm(ll a, ll b){ return a / gcd(a, b) * b; }\ntuple<ll, ll, ll> extgcd(ll a, ll b){\n  if (b == 0) return make_tuple(a, 1, 0);\n  ll g, x, y;\n  tie(g, x, y) = extgcd(b, a % b);\n  return make_tuple(g, y, x - a / b * y);\n}\nll invmod(ll a, ll m = 1000000007){\n  ll g, x;\n  tie(g, x, ignore) = extgcd(a, m);\n  return g == 1 ? (x + m) % m : 0;\n}\n\nvoid solve();\n\n}\n\nsigned main(){\n  auto begin = std::chrono::high_resolution_clock::now();\n  std::ios::sync_with_stdio(false);\n  std::cin.tie(nullptr);\n  std::cout << std::fixed << std::setprecision(12);\n  solver::solve();\n  auto end = std::chrono::high_resolution_clock::now();\n  auto time = std::chrono::duration_cast<std::chrono::milliseconds>(end - begin);\n#ifdef DEBUG\n  std::cerr << \"time: \" << time.count() << \" [ms]\" << std::endl;\n#endif\n}\n\nnamespace solver {\n/* }}} */\n\nvector<pair<string, int>> s[3];\n\nvector<pair<string, int>> input(){\n  vector<pair<string, int>> v;\n  while (true){\n    string c;\n    int l;\n    cin >> c;\n    if (c == \"$\") break;\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n  return v;\n}\n\nvoid solve(){\n  rep(i, 3) s[i] = input();\n  rep(i, s[0].size()){\n    if (i + s[1].size() > s[0].size()) continue;\n    if (s[1].size() == 1){\n      if (s[0][i].first == s[1][0].first && s[0][i].second >= s[1][0].second){\n        s[0][i].second -= s[1][0].second;\n        s[0].insert(begin(s[0]) + i, all(s[2]));\n        break;\n      }\n    }\n    else {\n      bool match = true;\n      match &= s[0][i].first == s[1][0].first;\n      match &= s[0][i].second >= s[1][0].second;\n      match &= s[0][i + s[1].size() - 1].first == s[1].back().first;\n      match &= s[0][i + s[1].size() - 1].second >= s[1].back().second;\n      rep(j, 1, s[1].size() - 1) match &= s[0][i + j] == s[1][j];\n      if (match){\n        rep(j, s[1].size()) s[0][i + j].second -= s[1][j].second;\n        s[0].insert(begin(s[0]) + i + 1, all(s[2]));\n        break;\n      }\n    }\n  }\n  rep(i, s[0].size()){\n    if (s[0][i].second == 0) s[0].erase(begin(s[0]) + i);\n  }\n  rep(i, s[0].size() - 1){\n    if (s[0][i].first == s[0][i + 1].first){\n      s[0][i].second += s[0][i + 1].second;\n      s[0].erase(begin(s[0]) + i + 1);\n      i--;\n    }\n  }\n  each(p, s[0]) cout << p.first << \" \" << p.second << \" \";\n  cout << \"$\\n\";\n}\n\n} /* namespace solver */"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define F first\n#define S second\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define reps(i, f, n) for(int i = (int)(f); i < (int)(n); i++)\n\nconst int inf = 1 << 25;\n\ntypedef pair<char, int> P;\n\nvoid input(vector<P>& v)\n{\n  char c; int l;\n  while(cin >> c, c != '$') {\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n}\n\nint main()\n{\n  vector<P> A; input(A);\n  vector<P> B; input(B);\n  vector<P> C; input(C);\n\n  int a = A.size();\n  int b = B.size();\n  int c = C.size();\n\n  rep(i, a-b+1) {\n    if(A[i].F == B[0].F && A[i].S >= B[0].S &&\n       A[i+b-1].F == B[b-1].F && A[i+b-1].S >= B[b-1].S) {\n      bool flag = true;\n      reps(j, 1, b-1) flag &= (A[i+j].F == B[j].F && A[i+j].S == B[j].S);\n      if(!flag) continue;\n      if(b == 1) {\n\tA[i].S -= B[0].S;\n\tif(A[i].S == 0)\tA.erase(begin(A)+i, begin(A)+i+1);\n\tA.insert(begin(A)+i, begin(C), end(C));\n      } else {\n\tA[i].S -= B[0].S;\n        A[i+b-1].S -= B[b-1].S;\n\tauto it1 = begin(A)+i;\n\tauto it2 = it1 + b;\n\tif(A[i].S != 0) it1++;\n\tif(A[i+b-1].S != 0) it2--;\n\tA.erase(it1, it2);\n\tA.insert(it1, begin(C), end(C));\n      }\n      for(auto it = begin(A); it != end(A); it++) {\n\tauto itr = it+1;\n\twhile(itr != end(A) && it->F == itr->F) it->S += itr->S, itr++;\n\tif(itr != it+1) A.erase(it+1, itr);\n      }\n    }\n  }\n\n  rep(i, A.size()) cout << A[i].F << \" \" << A[i].S << \" \";\n  cout << \"$\" << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nvoid Output(vector< pair< char, int > >& B)\n{\n  for(int i = B.size() - 1; i > 0; i--) {\n    if(B[i].first == B[i - 1].first) {\n      B[i - 1].second += B[i].second;\n      B[i].second = 0;\n    }\n  }\n  for(int i = 0; i < B.size(); i++) {\n    if(B[i].second > 0) {\n      cout << B[i].first << \" \" << B[i].second << \" \";\n    }\n  }\n  cout << \"$\" << endl; \n  exit(0);\n}\n\n\n  \nint main()\n{\n  vector< pair< char, int > > A[3];\n  vector< pair< char, int > > B;\n  \n  for(int i = 0; i < 3; i++) {\n    char C;\n    while(cin >> C, C != '$') {\n      int D;\n      cin >> D;\n      A[i].emplace_back(C, D);\n    }\n  }\n  \n  if(A[1].size() == 1) {\n    for(int i = 0; i < A[0].size(); i++) {\n      if(A[0][i].first == A[1][0].first && A[0][i].second >= A[1][0].second) {\n        for(int j = 0; j < i; j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        for(int j = 0; j < A[2].size(); j++) {\n          B.emplace_back(A[2][j].first, A[2][j].second);\n        }\n        if(A[0][i].second != A[1][0].second) {\n          B.emplace_back(A[0][i].first, A[0][i].second - A[1][0].second);\n        }\n        for(int j = i + 1; j < A[0].size(); j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n      }\n    }\n    Output(B);\n  } else {\n    for(int i = 0; i <= A[0].size() - A[1].size(); i++) {\n      if(A[0][i].first == A[1][0].first && A[0][i].second >= A[1][0].second && A[0][i + A[1].size() - 1].first == A[1].back().first && A[0][i + A[1].size() - 1].second >= A[1].back().second) {\n        bool flag = true;\n        for(int j = 1; j < A[1].size() - 1; j++) {\n          flag &= A[0][i + j] == A[1][j];\n        }\n        if(!flag) continue;\n        for(int j = 0; j < i; j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        if(A[0][i].second != A[1][0].second) {\n          B.emplace_back(A[0][i].first, A[0][i].second - A[1][0].second);\n        }\n        for(int j = 0; j < A[2].size(); j++) {\n          B.emplace_back(A[2][j].first, A[2][j].second);\n        }\n        if(A[0][i + A[1].size() - 1].second != A[1].back().second) {\n          B.emplace_back(A[0][i + A[1].size() - 1].first, A[0][i + A[1].size() - 1].second - A[1].back().second);\n        }\n        for(int j = i + A[1].size(); j < A[0].size(); j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n      }\n    }\n    Output(B);\n  }\n  Output(B);\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nstruct UnionFind {\n\tvector<int> v;\n\tUnionFind(int n) : v(n) { for (int i = 0; i < n; i++) v[i] = i; }\n\tint  find(int x) { return v[x] == x ? x : v[x] = find(v[x]); }\n\tvoid unite(int x, int y) { v[find(x)] = find(y); }\n};\n\nint main() {\n\tvector<pair<char, long long>> A;\n\tvector<pair<char, long long>> B;\n\tvector<pair<char, long long>> C;\n\tchar c;\n\twhile (cin >> c, c != '$') {\n\t\tint a;\n\t\tcin >> a;\n\t\tA.push_back({ c,a });\n\t}\n\twhile (cin >> c, c != '$') {\n\t\tint a;\n\t\tcin >> a;\n\t\tB.push_back({ c,a });\n\t}\n\twhile (cin >> c, c != '$') {\n\t\tint a;\n\t\tcin >> a;\n\t\tC.push_back({ c,a });\n\t}\n\tint clear = -1;\n\tREP(i, A.size() - B.size() + 1) {\n\t\tREP(j, B.size()) {\n\t\t\tif (A[i + j].first == B[j].first&&A[i + j].second >= B[j].second) {\n\t\t\t\tif (j != 0 && j != B.size()-1 && A[i + j].second > B[j].second)\n\t\t\t\t\tbreak;\n\t\t\t\tif (j == B.size() - 1) {\n\t\t\t\t\tclear = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tvector<pair<char, long long>> ANS = A;\n\tif (clear != -1) {\n\t\tif (B.size() == 1) {\n\t\t\tANS[clear].second -= B[0].second;\n\t\t\tREP(i, C.size())\n\t\t\tANS.insert(ANS.begin() + clear+i, C[i]);\n\t\t}\n\t\telse {\n\t\t\tREP(i, B.size()) {\n\t\t\t\tANS[clear+i].second -= B[i].second;\n\t\t\t}\n\t\t\tREP(i,C.size())\n\t\t\tANS.insert(ANS.begin() + clear + 1+i, C[i]);\n\t\t}\n\t\tREP(i, ANS.size())\n\t\t\tif (ANS[i].second == 0) {\n\t\t\t\tANS.erase(ANS.begin() + i);\n\t\t\t\ti--;\n\t\t\t}\n\t\tREP(i, ANS.size()-1)\n\t\t\tif (ANS[i].first ==ANS[i+1].first) {\n\t\t\t\tANS[i].second += ANS[i + 1].second;\n\t\t\t\tANS.erase(ANS.begin() + i+1);\n\t\t\t\ti--;\n\t\t\t}\n\t}\n\n\tREP(i, ANS.size()) {\n\t\tcout << ANS[i].first << \" \" << ANS[i].second << \" \";\n\t}\n\tcout << \"$\" << endl;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\n#define F first\n#define S second\ntypedef long long ll;\ntypedef pair<char, ll> P;\n\nint main()\n{\n    ll len[3];\n    vector<P> X[3];\n    for (int i = 0; i < 3; i++) {\n        char c;\n        ll l;\n        while (cin >> c, c != '$') {\n            cin >> l;\n            X[i].push_back(P(c, l));\n        }\n        len[i] = X[i].size();\n    }\n    for (int i = 0; i <= len[0]-len[1]; i++) {\n        bool same = 1;\n        for (int j = i; j < i+len[1]; j++) {\n            if (X[1][j-i].F != X[0][j].F &&\n                (i < j && j < i+len[1]-1 && X[1][j-1].S != X[0][j].S)) {\n                same = 0;\n                break;\n            }\n        }\n        if (len[1] == 1) {\n            if (X[1][0].F != X[0][i].F || X[0][i].S < X[1][0].S) {\n                continue;\n            }\n        }\n        if (same) {\n            vector<P> v, res;\n            for (int j = 0; j < i; j++) {\n                v.push_back(X[0][j]);\n            }\n            ll diff = X[0][i].S - X[1][0].S;\n            if (len[1] != 1) {\n                if (diff > 0) {\n                    v.push_back(P(X[0][i].F, diff));      \n                }\n                for (int j = 0; j < len[2]; j++) {\n                    v.push_back(X[2][j]);\n                }\n                diff = X[0][i+len[1]-1].S - X[1][len[1]-1].S;\n                if (diff > 0) {\n                    v.push_back(P(X[0][i+len[1]-1].F, diff));\n                }\n            } else {\n                for (int j = 0; j < len[2]; j++) {\n                    v.push_back(X[2][j]);\n                }                \n                if (diff > 0) {\n                    v.push_back(P(X[0][i].F, diff));   \n                }\n            }\n            for (int j = i+len[1]; j < len[0]; j++) {\n                v.push_back(X[0][j]);\n            }\n            \n            for (int j = 0; j < (int)v.size(); ) {\n                ll k = j, sum = 0;\n                while (k < (ll)v.size() &&\n                       v[j].F == v[k].F) {\n                    sum += v[k].S;\n                    k++;\n                }\n                res.push_back(P(v[j].F, sum));\n                j = k;\n            }\n            \n            for (int j = 0; j < (int)res.size(); j++) {\n                cout << res[j].F << \" \" << res[j].S << \" \";\n            }\n            cout << \"$\" << endl;\n            break;\n        }\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\n//const int INF = 1e8;\nusing namespace std;\n\n#define int long long\n\nstruct Data{\n\tchar c;\n\tint n;\n\tData(char c, int n) : c(c), n(n) {}\n};\n\nvoid parser(list<Data>& a){\n\tchar chr;\n\tint num;\n\twhile(cin >> chr, chr != '$'){\n\t\tcin >> num;\n\t\ta.emplace_back(chr, num);\n\t}\n}\n\nlist<Data> a, b, c;\n\nbool canReplace(list<Data>::iterator it){\n\tint idx = 0;\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n\tfor(auto i = it, j = b.begin(); j != b.end(); i++, j++, idx++){\n\t\tif(i->c != j->c) return false;\n\t\tif(idx == 0 or idx == b.size() - 1){\n\t\t\tif(i->n < j->n) return false;\n\t\t}else{\n\t\t\tif(i->n != j->n) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\n\nvoid replaceList(list<Data>::iterator& it){\n\tint loop = 1;\n\tif(b.size() == 1){\n\t\tloop = (it->n) / (b.begin()->n);\n\t\tit->n -= loop * b.begin()->n;\n\t\tif(it->n == 0) it = a.erase(it);\n\t}else{\n\t\trep(i,b.size()){\n\t\t\tif(i == 0){\n\t\t\t\tit->n -= (*b.begin()).n;\n\t\t\t\tif(it->n == 0) it = a.erase(it);\n\t\t\t\telse it++;\n\t\t\t}else if(i == b.size() - 1){\n\t\t\t\tit->n -= (*--b.end()).n;\n\t\t\t\tif(it->n == 0) it = a.erase(it);\n\t\t\t}else{\n\t\t\t\tit = a.erase(it);\n\t\t\t}\n\t\t}\n\t}\n\t//show(loop)\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n\t//for(auto i : c){ cout << i.c; } cout << endl;\n\twhile(loop--){\n\t\tfor(auto& i : c){\n\t\t\ta.insert(it,i);\n\t\t}\n\t}\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n}\n\nbool check(){\n\tint idx = 0;\n\tbool f = false;\n\tfor(auto it = a.begin(); idx + b.size() <= a.size(); it++, idx++){\n\t\tif(canReplace(it)){\n\t\t\treplaceList(it);\n\t\t\tf = true;\n\t\t}\n\t}\n\treturn f;\n}\n\nvoid compress(){\n\tauto it = a.begin();\n\twhile(it != a.end()){\n\t\tif(it->c == next(it, 1)->c){\n\t\t\tit->n += next(it, 1)->n;\n\t\t\ta.erase(next(it,1));\n\t\t}else if(it->n == 0){\n\t\t\tit = a.erase(it);\n\t\t}else{\n\t\t\tit++;\n\t\t}\n\t}\n}\n\nbool comp(){\n\n\tint idx = 0;\n\tfor(auto i = a.begin(), j = b.begin(); i != a.end(); i++, j++, idx++){\n\t\tif(i->c != j->c or i->n != j->n){\n\t\t\tshow(idx)\n\t\tcout << i->c << ' ' << j->c << endl;\n\t\tcout << i->n << ' ' << j->n << endl;\n return true;\n\t\t}\n\t}\n\treturn false;\n}\n\nsigned main(){\n\tparser(a);\n\tparser(b);\n\tparser(c);\n\n\n\twhile(true){\n\t\tcompress();\n\t\tif(check() == false) break;\n\t}\n\t\n\tfor(auto i : a){\n\t\tcout << i.c << ' ' << i.n << ' ';\n\t}\n\tcout << '$' << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing P=pair<char,int>;\n\nint main(){\n    vector<P> A,B,C;\n    char c;\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        A.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        B.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        C.emplace_back(c,l);\n    }\n    vector<P> ans;\n    for(int i=0;i<A.size();i++){\n        if(A[i].first==B.front().first&&A[i].second>=B.front().second){\n            bool flag=true;\n            if(i+B.size()<=A.size()){\n                for(int d=1;d<B.size();d++){\n                    if(A[i+d].first!=B[d].first){\n                        flag=false;\n                        break;\n                    }\n                    if(d!=B.size()-1){\n                        if(A[i+d].second!=B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }else{\n                        if(A[i+d].second<B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }\n                }\n            }else{\n                continue;\n            }\n            if(flag){\n                // cout<<i<<endl;\n                if(B.size()==1){\n                    for(int j=0;j<i;j++) ans.push_back(A[j]);\n                    for(auto p:C) ans.push_back(p);\n                    if(A[i].second>B[0].second){\n                        ans.emplace_back(B[0].first,A[i].second-B[0].second);\n                    }\n                    for(int j=i+1;j<A.size();j++) ans.push_back(A[j]);\n                }else{\n                    if(A[i].second>B[0].second){\n                        ans.emplace_back(B[0].first,A[i].second-B[0].second);\n                    }\n                    for(auto p:C) ans.push_back(p);\n                    if(A[i+B.size()-1].second>B.back().second){\n                        ans.emplace_back(B.back().first, A[i+B.size()-1].second-B.back().second);\n                    }\n                    for(int j=i+B.size();j<A.size();j++) ans.push_back(A[j]);\n                }\n\n                for(int j=ans.size()-2;j>=0;j--){\n                    if(ans[j].first==ans[j+1].first){\n                        ans[j].second+=ans[j+1].second;\n                        ans[j+1].second=0;\n                    }\n                }\n                for(auto p:ans){\n                    char c; int l;\n                    tie(c,l)=p;\n                    if(l) cout<<c<<' '<<l<<' ';\n                }\n                cout<<'$'<<endl;\n                /*\n                {\n                    bool b=true;\n                    for(int i=0;i<A.size();i++){\n                        if(A[i]!=B[i]){\n                            cout<<i<<' '<<A[i].first<<' '<<A[i].second<<' '<<B[i].first<<' '<<B[i].second<<endl;\n                        }\n                    }\n                    cout<<b<<endl;\n                }*/\n                \n                // cout<<A.size()<<endl;\n                // cout<<B.size()<<endl;\n                // cout<<C.size()<<endl;\n                // cout<<ans.size()<<endl;\n                 \n                return 0;\n            }\n        }   \n    }\n    for(auto p:A){\n        char c; int l;\n        tie(c,l)=p;\n        cout<<c<<' '<<l<<' ';\n    }\n    cout<<'$'<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define For(i, a, b) for(int (i)=(int)(a); (i)<(int)(b); ++(i))\n#define rFor(i, a, b) for(int (i)=(int)(a)-1; (i)>=(int)(b); --(i))\n#define rep(i, n) For((i), 0, (n))\n#define rrep(i, n) rFor((i), (n), 0)\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long lint;\ntypedef unsigned long long ulint;\ntypedef pair<int, int> pii;\ntypedef pair<lint, lint> pll;\ntemplate<class T> bool chmax(T &a, const T &b){if(a<b){a=b; return true;} return false;}\ntemplate<class T> bool chmin(T &a, const T &b){if(a>b){a=b; return true;} return false;}\ntemplate<class T> T div_floor(T a, T b){\n    if(b < 0) a *= -1, b *= -1;\n    return a>=0 ? a/b : (a+1)/b-1;\n}\ntemplate<class T> T div_ceil(T a, T b){\n    if(b < 0) a *= -1, b *= -1;\n    return a>0 ? (a-1)/b+1 : a/b;\n}\n\nconstexpr lint mod = 1000000007;\nconstexpr lint INF = mod * mod;\nconstexpr int MAX = 200010;\n\nvoid input(char *a, int *al, int &an){\n    while(true){\n        scanf(\" %c\", &a[an]);\n        if(a[an] == '$') break;\n        scanf(\"%d\", &al[an++]);\n    }\n}\n\nvoid push(deque<pair<char, int>> &dq, pair<char, int> p){\n    if(p.se == 0) return;\n    else if(!dq.empty() && dq.rbegin()->fi == p.fi) dq.rbegin()->se += p.se;\n    else dq.push_back(p);\n}\n\nint main(){\n    char a[1010], b[1010], c[1010];\n    int al[1010], bl[1010], cl[1010];\n    int an = 0, bn = 0, cn = 0;\n    input(a, al, an);\n    input(b, bl, bn);\n    input(c, cl, cn);\n\n    deque<pair<char, int>> dq;\n    if(bn == 1){\n        rep(i, an)if(a[i] == b[0] && al[i] >= bl[0]){\n            al[i] -= bl[0];\n            rep(j, i) push(dq, {a[j], al[j]});\n            rep(j, cn) push(dq, {c[j], cl[j]});\n            For(j, i, an) push(dq, {a[j], al[j]});\n            break;\n        }\n    }\n    else{\n        rep(i, an)if(a[i] == b[0] && al[i] >= bl[0] && a[i+bn-1] == b[bn-1] && al[i+bn-1] >= bl[bn-1]){\n            bool flag = true;\n            For(j, 1, bn-1)if(a[i+j] != b[j] || al[i+j] != bl[j]){\n                flag = false;\n                break;\n            }\n            if(flag){\n                al[i] -= bl[0];\n                al[i+bn-1] -= bl[bn-1];\n                rep(j, i+1) push(dq, {a[j], al[j]});\n                rep(j, cn) push(dq, {c[j], cl[j]});\n                For(j, i+bn-1, an) push(dq, {a[j], al[j]});\n                i = MAX;\n                break;\n            }\n        }\n    }\n\n    if(!dq.empty()){\n        for(auto p: dq) printf(\"%c %d \", p.fi, p.se);\n    }\n    else{\n        rep(i, an) printf(\"%c %d \", a[i], al[i]);\n    }\n    printf(\"%c\\n\", '$');\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n#include <fstream>\n\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\n#define watch(a) { cout << #a << \" = \" << a << endl; }\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntypedef long long ll;\nint const inf = 1<<29;\n\nvoid change(deque<pair<char, int>>& nv0) {\n  if(nv0.size() > 1 && nv0[nv0.size()-2].first == nv0.back().first) {\n    int k = nv0.back().second;\n    nv0.pop_back();\n    nv0.back().second += k;\n  }\n}\n\nvoid output(deque<pair<char, int>>& out) {\n  rep(i, out.size()) {\n    if(i) cout << \" \";\n    cout << out[i].first << \" \" << out[i].second;\n  }\n  cout << \" $\" << endl;\n}\n\nint main() {\n\n  vector<deque<pair<char, int>>> v(3);\n  for(auto& u: v) {\n    while(1) {\n      char c; cin >> c;\n      if(c == '$') break;\n      int n; cin >> n;\n      u.emplace_back(c, n);\n    }\n  }\n\n  rep(i, (int)v[0].size()-(int)v[1].size()+1) {\n\n    if(v[1].size() == 1) {\n      const int a = v[0][i].second, b = v[1][0].second;\n      if(v[0][i].first == v[1][0].first && a >= b) {\n        deque<pair<char, int>> nv0;\n        rep(k, i) {\n          nv0.push_back(v[0][k]);\n        }\n\n        rep(k, v[2].size()) {\n          nv0.push_back(v[2][k]);\n          change(nv0);\n        }\n\n        if(a - b > 0) {\n          nv0.push_back(v[0][i]);\n          nv0.back().second = a - b;\n          change(nv0);\n        }\n        REP(k, i+1, v[0].size()) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n        v[0] = nv0;\n        break;\n      } else {\n        continue;\n      }\n\n    }\n\n    int j = 0;\n    vector<int> V;\n    while(j < v[1].size() && v[0][i+j].first == v[1][j].first) {\n      if(j == 0 || j == (int)v[1].size()-1) {\n        if(v[0][i+j].second < v[1][j].second) break;\n        V.push_back(v[0][i+j].second - v[1][j].second);\n      }\n      else {\n        if(v[0][i+j].second != v[1][j].second) break;\n      }\n      j++;\n    }\n\n    deque<pair<char, int>> nv0;\n\n    if(j == v[1].size()) {\n      rep(k, v[0].size()) {\n        if(k < i) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n        if(k == i) {\n          if(V[0] > 0) nv0.emplace_back(v[0][i].first, V[0]);\n          rep(l, v[2].size()) {\n            nv0.push_back(v[2][l]);\n            change(nv0);\n          }\n          k = i+v[1].size()-1;\n        }\n        if(k == i+j-1) {\n          if(V[1] > 0) nv0.emplace_back(v[0][i+j-1].first, V[1]);\n          change(nv0);\n        }\n        if(i+j <= k) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n      }\n      v[0] = nv0;\n      break;\n    }\n  }\n\n  output(v[0]);\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(ll i=(ll)(a);i<(ll)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define each(itr,v) for(auto itr:v)\n#define pb push_back\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define mmax(x,y) (x>y?x:y)\n#define mmin(x,y) (x<y?x:y)\n#define maxch(x,y) x=mmax(x,y)\n#define minch(x,y) x=mmin(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt __builtin_popcount\n\n#define INF INT_MAX/3\n\ntypedef pair<char,ll> p;\ntypedef vector<p> pv;\n\npv read_rle(){\n  pv res;\n  while(1){\n    char c; ll n;\n    cin>>c;\n    if(c=='$')break;\n    cin>>n;\n    res.push_back(p(c,n));\n  }\n  return res;\n}\n\nvoid print_rle(pv s){\n  rep(i,s.size()){\n    printf(\"%c %lld \", s[i].fi,s[i].se);\n  }\n  printf(\"$\\n\");\n}\n\nint main(){\n\tcin.sync_with_stdio(false);\n  pv a,b,c;\n  a=read_rle(); b=read_rle(); c=read_rle();\n  int na=a.size(),nb=b.size(),nc=c.size();\n  int st=-1,en=-1;\n  rep(i,na){\n    if(i+nb-1>=na)continue;\n    if(b[0].fi!=a[i].fi||b[0].se>a[i].se||b[nb-1].fi!=a[i+nb-1].fi||b[nb-1].se>a[i+nb-1].se)continue;\n    bool ok=true;\n    repl(j,1,nb-1){\n      if(b[j]!=a[i+j])ok=false;\n    }\n    if(!ok)continue;\n    st=i; en=i+nb-1; break;\n  }\n  if(st==-1)print_rle(a);\n  else{\n    pv res,res2;\n    rep(i,st)res.push_back(a[i]);\n    if(nb>1&&a[st].se-b[0].se>0)res.push_back(p(a[st].fi,a[st].se-b[0].se));\n    rep(i,nc){\n      res.push_back(c[i]);\n    }\n    if(a[en].se-b[nb-1].se>0)res.push_back(p(a[en].fi,a[en].se-b[nb-1].se));\n    repl(i,en+1,na)res.push_back(a[i]);\n    //print_rle(res);\n    res2.push_back(res[0]);\n    repl(i,1,res.size()){\n      if(res[i-1].fi==res[i].fi){\n        res2.back().se+=res[i].se;\n      }else{\n        res2.push_back(res[i]);\n      }\n    }\n    print_rle(res2);\n  }\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\ntypedef pair<char, int> pci;\n\nint main()\n{\n\tvector<pci> a, b, c;\n\tchar let; int n;\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\ta.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tb.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tc.emplace_back(let, n);\n\t}\n\tvector<pci> res;\n\t\n\tREP(i, (int)a.size() - (int)b.size() + 1)\n\t{\n\t\tif (a[i].first == b[0].first&&a[i].second >= b[0].second)\n\t\t{\n\t\t\tbool f = true;\n\t\t\tint j;\n\t\t\tfor (j = 1; j < b.size(); j++)\n\t\t\t{\n\t\t\t\tif (j == b.size() - 1)\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second >= a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second != a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (f)\n\t\t\t{\n\n\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\tif (a[i].second > b[i].second) res.emplace_back(a[i].first, a[i].second - b[i].second);\n\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\tif (b.size()>1 && a[i + b.size() - 1].second > b.back().second) res.emplace_back(b.back().first, a[i + b.size() - 1].second - b.back().second);\n\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\ti = INF;\n\t\t\t}\n\t\t}\n\t}\n\tvector<pci> ans;\n\tif (res.size() == 0) ans = a;\n\telse\n\t{\n\t\tans.emplace_back(res[0]);\n\t\tFOR(i, 1, res.size())\n\t\t{\n\t\t\tif (res[i].first == ans.back().first) ans.back().second += res[i].second;\n\t\t\telse ans.emplace_back(res[i]);\n\t\t}\n\t}\n\tREP(i, ans.size()) cout << ans[i].first << \" \" << ans[i].second << (i == ans.size() - 1 ? \" $\\n\" : \" \");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "// >>> TEMPLATES\n#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\nusing i32 = int32_t;\nusing i64 = int64_t;\nusing u32 = uint32_t;\nusing u64 = uint64_t;\n#define int ll\n#define double ld\n#define rep(i,n) for (int i = 0; i < (int)(n); i++)\n#define rep1(i,n) for (int i = 1; i <= (int)(n); i++)\n#define repR(i,n) for (int i = (int)(n)-1; i >= 0; i--)\n#define rep1R(i,n) for (int i = (int)(n); i >= 1; i--)\n#define loop(i,a,B) for (int i = a; i B; i++)\n#define loopR(i,a,B) for (int i = a; i B; i--)\n#define all(x) (x).begin(), (x).end()\n#define allR(x) (x).rbegin(), (x).rend()\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define fst first\n#define snd second\ntemplate <class Int> auto constexpr inf = numeric_limits<Int>::max()/2-1;\nauto constexpr INF32 = inf<int32_t>;\nauto constexpr INF64 = inf<int64_t>;\nauto constexpr INF   = inf<int>;\n#ifdef LOCAL\n#include \"debug.hpp\"\n#else\n#define dump(...) (void)(0)\n#define say(x) (void)(0)\n#define debug if (0)\n#endif\ntemplate <class T> using pque_max = priority_queue<T>;\ntemplate <class T> using pque_min = priority_queue<T, vector<T>, greater<T> >;\ntemplate <class T, class = typename T::iterator, class = typename enable_if<!is_same<T, string>::value>::type>\nostream& operator<<(ostream& os, T const& v) { bool f = true; for (auto const& x : v) os << (f ? \"\" : \" \") << x, f = false; return os; }\ntemplate <class T, class = typename T::iterator, class = typename enable_if<!is_same<T, string>::value>::type>\nistream& operator>>(istream& is, T &v) { for (auto& x : v) is >> x; return is; }\ntemplate <class T, class S> ostream& operator<<(ostream& os, pair<T,S> const& p) { return os << \"(\" << p.first << \", \" << p.second << \")\"; }\ntemplate <class T, class S> istream& operator>>(istream& is, pair<T,S>& p) { return is >> p.first >> p.second; }\nstruct IOSetup { IOSetup() { cin.tie(nullptr); ios::sync_with_stdio(false); cout << fixed << setprecision(15); } } iosetup;\ntemplate <class F> struct FixPoint : private F {\n    constexpr FixPoint(F&& f) : F(forward<F>(f)) {}\n    template <class... T> constexpr auto operator()(T&&... x) const { return F::operator()(*this, forward<T>(x)...); }\n};\nstruct MakeFixPoint {\n    template <class F> constexpr auto operator|(F&& f) const { return FixPoint<F>(forward<F>(f)); }\n};\n#define MFP MakeFixPoint()|\n#define def(name, ...) auto name = MFP [&](auto &&name, __VA_ARGS__)\ntemplate <class T, size_t d> struct vec_impl {\n    using type = vector<typename vec_impl<T,d-1>::type>;\n    template <class... U> static type make_v(size_t n, U&&... x) { return type(n, vec_impl<T,d-1>::make_v(forward<U>(x)...)); }\n};\ntemplate <class T> struct vec_impl<T,0> { using type = T; static type make_v(T const& x = {}) { return x; } };\ntemplate <class T, size_t d = 1> using vec = typename vec_impl<T,d>::type;\ntemplate <class T, size_t d = 1, class... Args> auto make_v(Args&&... args) { return vec_impl<T,d>::make_v(forward<Args>(args)...); }\ntemplate <class T> void quit(T const& x) { cout << x << endl; exit(0); }\ntemplate <class T, class U> constexpr bool chmin(T& x, U const& y) { if (x > y) { x = y; return true; } return false; }\ntemplate <class T, class U> constexpr bool chmax(T& x, U const& y) { if (x < y) { x = y; return true; } return false; }\ntemplate <class It> constexpr auto sumof(It b, It e) { return accumulate(b,e,typename iterator_traits<It>::value_type{}); }\ntemplate <class T> int sz(T const& x) { return x.size(); }\ntemplate <class C, class T> int lbd(C const& v, T const& x) {\n    return lower_bound(v.begin(), v.end(), x)-v.begin();\n}\ntemplate <class C, class T> int ubd(C const& v, T const& x) {\n    return upper_bound(v.begin(), v.end(), x)-v.begin();\n}\nconst int dx[] = { 1,0,-1,0 };\nconst int dy[] = { 0,1,0,-1 };\nconstexpr int popcnt(ll x) { return __builtin_popcountll(x); }\ntemplate <class Int> struct Random {\n    mt19937_64 mt{random_device{}()};\n    //mt19937_64 mt{(unsigned)time(0)};\n    Int a,b; // [a,b]\n    Random(Int a, Int b) : a(a), b(b) {}\n    Int operator()() { return uniform_int_distribution<Int>(a,b)(mt); }\n};\ntemplate <class Int> Int rand(Int a, Int b) { // [a,b]\n    static mt19937_64 mt{random_device{}()};\n    return uniform_int_distribution<Int>(a,b)(mt);\n}\n// <<<\n\nint32_t main() {\n    auto read = [&]() {\n        vector<pair<char,int>> v;\n        while (true) {\n            char c; cin >> c;\n            if (c == '$') break;\n            int k; cin >> k;\n            v.eb(c,k);\n        }\n        return v;\n    };\n    auto A = read();\n    auto B = read();\n    auto C = read();\n\n    rep (i,A.size()-B.size()+1) {\n        bool ok = true;\n        rep (j,B.size()) {\n            if (A[i+j].fst != B[j].fst) ok = false;\n            if (j == 0 || j == sz(B)-1) {\n                if (A[i+j].snd < B[j].snd) ok = false;\n            } else {\n                if (A[i+j].snd != B[j].snd) ok = false;\n            }\n        }\n        if (not ok) continue;\n\n        vector<pair<char,int>> ans;\n        auto add = [&](char c, int k) {\n            if (ans.size() && ans.back().fst == c) {\n                ans.back().snd += k;\n            } else if (k > 0) {\n                ans.eb(c,k);\n            }\n        };\n        rep (k,i) add(A[k].fst, A[k].snd);\n        if (sz(B) > 1) add(A[i].fst, A[i].snd-B[0].snd);\n        rep (k,C.size()) add(C[k].fst, C[k].snd);\n        add(A[i+sz(B)-1].fst, A[i+sz(B)-1].snd-B[sz(B)-1].snd);\n        loop (k,i+sz(B),<sz(A)) add(A[k].fst, A[k].snd);\n        for (auto p : ans) {\n            cout << p.fst << \" \" << p.snd << \" \";\n        }\n        cout << \"$\\n\";\n        return 0;\n    }\n\n    for (auto p : A) {\n        cout << p.fst << \" \" << p.snd << \" \";\n    }\n    cout << \"$\\n\";\n\n\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\nusing Pi = pair<int, int>;\nusing Pl = pair<ll, ll>;\nusing Ti = tuple<int, int, int>;\nusing Tl = tuple<ll, ll, ll>;\n\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define F first\n#define S second\n#define Get(t, i) get<(i)>((t))\n#define all(v) (v).begin(), (v).end()\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define reps(i, f, n) for(int i = (int)(f); i < (int)(n); i++)\n#define each(a, b) for(auto& a : b)\n\nconst int inf = 1 << 25;\nconst ll INF = 1LL << 55;\n\nusing P = pair<char, int>;\n\nvoid input(vector<P>& v)\n{\n  char c; int l;\n  while(cin >> c, c != '$') {\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n}\n\nint main()\n{\n  vector<P> A; input(A);\n  vector<P> B; input(B);\n  vector<P> C; input(C);\n\n  rep(i, A.size()-B.size()+1) {\n    if(A[i].F == B[0].F && A[i].S >= B[i].S &&\n       A[i+B.size()-1].F == B[B.size()-1].F &&\n       A[i+B.size()-1].S >= B[B.size()-1].S) {\n      bool flag = true;\n      reps(j, 1, B.size()-1) {\n\tflag &= (A[i+j].F == B[j].F && A[i+j].S == B[j].S);\n      }\n      if(flag) {\n\tint Abofst = (A[i].S > B[0].S);\n\tint Aeofst = (A[i+B.size()-1].S > B[B.size()-1].S);\n\tif(Abofst) A[i].S -= B[0].S;\n\tif(Aeofst) A[i+B.size()-1].S -= B[B.size()-1].S;\n\tint Cbofst = (A[i-!Abofst].F == C[0].F);\n\tint Ceofst = (A[i+B.size()-1+!Aeofst].F == C[C.size()-1].F);\n\tif(Cbofst) A[i-!Abofst].S += C[0].S;\n\tif(Ceofst) A[i+B.size()-1+!Aeofst].S += C[C.size()-1].S;\n\tif(B.size() == 1) {\n\t  Abofst = 0;\n\t  Aeofst = 0;\n\t  A[i].S += B[0].S;\n\t}\n\tif(i+Abofst < B.size()-Aeofst) A.erase(A.begin()+i+Abofst, A.begin()+B.size()-Aeofst);\n\tvector<P> D;\n\treps(j, Cbofst, C.size()-Ceofst) D.push_back(C[j]);\n\tA.insert(A.begin()+i+Abofst, D.begin(), D.end());\n\trep(j, A.size()) {\n\t  if(j + 1 < A.size() && A[j].F == A[j+1].F) {\n\t    cout << A[j].F << \" \" << A[j].S+A[j+1].S-C[0].S << \" \";\n\t    j++;\n\t  } else {\n\t    cout << A[j].F << \" \" << A[j].S << \" \";\n\t  }\n\t}\n\tcout << \"$\" << endl;\n\treturn 0;\n      }\n    }\n  }\n  rep(i, A.size()) {\n    cout << A[i].F << \" \" << A[i].S << \" \";\n  }\n  cout << \"$\" << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define s second\n#define f first\n#define N 1005\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\nvector<P> A[3],ans;\nint len[3];\n\nint main(){\n  char c;\n  int n;\n  for(int i=0;i<3;i++){\n    while(cin>>c,c!='$')\n      cin>>n,A[i].push_back(P(c,n));\n    len[i]=A[i].size();\n  }\n  for(int i=0;i<len[0];i++){\n    if(i>len[0]-len[1]){\n      ans.push_back(A[0][i]);\n      continue;\n    }\n    int flag=0;\n    for(int j=0;j<len[1];j++){\n      ll a=A[0][i+j].s,b=A[1][j].s;\n      if(A[0][i+j].f!=A[1][j].f)flag=1;\n      if(!j&&a<b)flag=1;\n      if(j&&j!=len[1]-1&&a!=b)flag=1;\n      if(j==len[1]-1&&a<b)flag=1;\n    }\n    if(!flag){\n      if(A[0][i].s>A[1][0].s)\n\tans.push_back(P(A[1][0].f,A[0][i].s-A[1][0].s));\n      for(int j=0;j<len[2];j++)\n\tans.push_back(A[2][j]);\n      A[0][i+len[1]-1].s-=A[1][len[1]-1].s;\n      i+=len[1]-2;\n    }else if(A[0][i].s)ans.push_back(A[0][i]);\n  }\n  char ch=ans[0].f;\n  ll sum=ans[0].s;\n  for(int i=1;i<ans.size();i++){\n    if(ch==ans[i].f)sum+=ans[i].s;\n    else cout<<ch<<' '<<sum<<' ',ch=ans[i].f,sum=ans[i].s;\n  }\n  cout<<ch<<' '<<sum<<\" $\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define F first\n#define S second\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define reps(i, f, n) for(int i = (int)(f); i < (int)(n); i++)\n\nconst int inf = 1 << 25;\n\ntypedef pair<char, int> P;\n\nvoid input(vector<P>& v)\n{\n  char c; int l;\n  while(cin >> c, c != '$') {\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n}\n\nint main()\n{\n  vector<P> A; input(A);\n  vector<P> B; input(B);\n  vector<P> C; input(C);\n\n  int a = A.size();\n  int b = B.size();\n  int c = C.size();\n\n  rep(i, a-b+1) {\n    if(A[i].F == B[0].F && A[i].S >= B[i].S &&\n       A[i+b-1].F == B[b-1].F && A[i+b-1].S >= B[b-1].S) {\n      bool flag = true;\n      reps(j, 1, b-1) flag &= (A[i+j].F == B[j].F && A[i+j].S == B[j].S);\n      if(!flag) continue;\n      if(b == 1) {\n\tif(A[i].S > B[0].S) A[i].S -= B[0].S;\n\tauto it1 = begin(A)+i;\n\tif(A[i].S == 0)\tA.erase(begin(A)+i, begin(A)+i+1);\n\telse it1++;\n\tA.insert(it1, begin(C), end(C));\n      } else {\n\tif(A[i].S > B[0].S) A[i].S -= B[0].S;\n\tif(A[i+b-1].S > B[b-1].S) A[i+b-1].S -= B[b-1].S;\n\tauto it1 = begin(A)+i;\n\tauto it2 = it1 + b;\n\tif(A[i].S != 0) it1++;\n\tif(A[i+b-1].S != 0) it2--;\n\tA.erase(it1, it2);\n\tA.insert(it1, begin(C), end(C));\n      }\n      for(auto it = begin(A); it != end(A); it++) {\n\tauto itr = it+1;\n\twhile(itr != end(A) && it->F == itr->F) it->S += itr->S, itr++;\n\tif(itr != it+1) A.erase(it+1, itr);\n      }\n    }\n  }\n\n  rep(i, A.size()) cout << A[i].F << \" \" << A[i].S << \" \";\n  cout << \"$\" << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing P=pair<char,int>;\n\nint main(){\n    vector<P> A,B,C;\n    char c;\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        A.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        B.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        C.emplace_back(c,l);\n    }\n    vector<P> ans;\n    for(int i=0;i<A.size();i++){\n        if(A[i].first==B.front().first&&A[i].second>=B.front().second){\n            bool flag=true;\n            if(i+B.size()<=A.size()){\n                for(int d=1;d<B.size();d++){\n                    if(A[i+d].first!=B[d].first){\n                        flag=false;\n                        break;\n                    }\n                    if(d!=B.size()-1){\n                        if(A[i+d].second!=B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }else{\n                        if(A[i+d].second<B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }\n                }\n            }else{\n                continue;\n            }\n            if(flag){\n                for(int j=0;j<i;j++){\n                    ans.push_back(A[j]);\n                }\n                if(A[i].second!=B[0].second){\n                    ans.emplace_back(A[i].first,A[i].second-B[0].second);\n                }\n                for(int j=0;j<C.size();j++){\n                    if(j==0&&!ans.empty()&&ans.back().first==C.front().first){\n                        ans.back().second+=C.front().second;\n                    }else{\n                        ans.push_back(C[j]);\n                    }\n                }\n\n                if(A[i+B.size()-1].second!=B.back().second){\n                    if(ans.back().first==B.back().first){\n                        ans.back().second+=A[i+B.size()-1].second-B.back().second;\n                    }else{\n                        ans.emplace_back(B.back().first, A[i+B.size()-1].second-B.back().second);\n                    }\n                }\n                for(int j=i+B.size();j<A.size();j++){\n                    ans.push_back(A[j]);\n                }\n                for(auto p:ans){\n                    char c; int l;\n                    tie(c,l)=p;\n                    cout<<c<<' '<<l<<' ';\n                }\n                cout<<'$'<<endl;\n                /*\n                {\n                    bool b=true;\n                    for(int i=0;i<A.size();i++){\n                        if(A[i]!=B[i]){\n                            cout<<i<<' '<<A[i].first<<' '<<A[i].second<<' '<<B[i].first<<' '<<B[i].second<<endl;\n                        }\n                    }\n                    cout<<b<<endl;\n                }\n\n                cout<<A.size()<<endl;\n                cout<<B.size()<<endl;\n                cout<<C.size()<<endl;\n                cout<<ans.size()<<endl;\n                */\n                return 0;\n            }\n        }   \n    }\n    for(auto p:A){\n        char c; int l;\n        tie(c,l)=p;\n        cout<<c<<' '<<l<<' ';\n    }\n    cout<<'$'<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <iostream>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\ntypedef long long LL;\nusing namespace std;\nchar s[2005], t[2005], w[2005], ans[2005];\nint lenans;\nint a[2005], b[2005], d[2005], e[2005];\nchar Get() {\n    auto c = getchar();\n    while (c != '$' && (c < 'A' || c > 'Z'))\n        c = getchar();\n    return c;\n}\nvoid legal(char *c, int *l, int &len) {\n    int newlen = 0;\n    char newc[2005];\n    int newl[2005];\n    for (int i = 0; i < len; ++i) {\n        if (l[i] == 0)\n            continue;\n        if (newlen && newc[newlen - 1] == c[i]) {\n            newl[newlen - 1] += l[i];\n        } else {\n            newc[newlen] = c[i];\n            newl[newlen++] = l[i];\n        }\n    }\n    len = newlen;\n    for (int i = 0; i < len; ++i) {\n        c[i] = newc[i];\n        l[i] = newl[i];\n    }\n}\nint main() {\n    int lena = 0;\n    for (char c = Get(); c != '$'; c = Get()) {\n        s[lena] = c;\n        scanf(\"%d\", &a[lena++]);\n    }\n    int lenb = 0;\n    for (char c = Get(); c != '$'; c = Get()) {\n        t[lenb] = c;\n        scanf(\"%d\", &b[lenb++]);\n    }\n    int lenc = 0;\n    for (char c = Get(); c != '$'; c = Get()) {\n        w[lenc] = c;\n        scanf(\"%d\", &d[lenc++]);\n    }\n    if (lenb == 1) {\n        for (int i = 0; i < lena; ++i) {\n            if (s[i] != t[0] || a[i] < b[0])\n                continue;\n            for (int j = 0; j < i; ++j) {\n                ans[lenans] = s[j];\n                e[lenans++] = a[j];\n            }\n            for (int j = 0; j < lenc; ++j) {\n                ans[lenans] = w[j];\n                e[lenans++] = d[j];\n            }\n            ans[lenans] = s[i];\n            e[lenans++] = a[i] - b[0];\n            for (int j = i + 1; j < lena; ++j) {\n                ans[lenans] = s[j];\n                e[lenans++] = a[j];\n            }\n            legal(ans, e, lenans);\n            for (int i = 0; i < lenans; ++i) {\n                printf(\"%c %d \", ans[i], e[i]);\n            }\n            printf(\"$\\n\");\n            return 0;\n        }\n        for (int i = 0; i < lena; ++i) {\n            printf(\"%c %d \", s[i], a[i]);\n        }\n        printf(\"$\\n\");\n        return 0;\n    }\n    for (int i = 0; i < lena; ++i) {\n        if (s[i] != t[0] || a[i] < b[0])\n            continue;\n        bool flag = true;\n        for (int j = 1; j < lenb - 1; ++j) {\n            if (i + j >= lena) {\n                flag = false;\n                break;\n            }\n            flag &= (s[i + j] == t[j] && a[i + j] == b[j]);\n        }\n        if (!flag)\n            continue;\n        if (i + lenb - 1 >= lena || s[i + lenb - 1] != t[lenb - 1] ||\n            a[i + lenb - 1] < b[lenb - 1])\n            continue;\n        for (int j = 0; j < i; ++j) {\n            ans[lenans] = s[j];\n            e[lenans++] = a[j];\n        }\n        ans[lenans] = s[i];\n        e[lenans++] = a[i] - b[0];\n        for (int j = 0; j < lenc; ++j) {\n            ans[lenans] = w[j];\n            e[lenans++] = d[j];\n        }\n        ans[lenans] = s[i + lenb - 1];\n        e[lenans++] = a[i + lenb - 1] - b[lenb - 1];\n        for (int j = i + lenb; j < lena; ++j) {\n            ans[lenans] = s[j];\n            e[lenans++] = a[j];\n        }\n        legal(ans, e, lenans);\n        for (int i = 0; i < lenans; ++i) {\n            printf(\"%c %d \", ans[i], e[i]);\n        }\n        printf(\"$\\n\");\n        return 0;\n    }\n    for (int i = 0; i < lena; ++i) {\n        printf(\"%c %d \", s[i], a[i]);\n    }\n    printf(\"$\\n\");\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nint main(){\n    vector<vector<char> > c(4);\n    vector<vector<int> > len(4);\n    for(int i=0; i<3; i++){\n        while(1){\n            char letter;\n            int n;\n            cin >> letter;\n            if(letter == '$') break;\n            cin >> n;\n            c[i].push_back(letter);\n            len[i].push_back(n);\n        }\n    }\n\n    int asize = c[0].size();\n    int bsize = c[1].size();\n    int csize = c[2].size();\n    for(int i=0; i<asize-bsize+1; i++){\n        bool flag = true;\n        for(int j=0; j<bsize; j++){\n            if(c[0][i+j] == c[1][j]){\n                if(j==0 || j==bsize-1){\n                    if(len[0][i+j]<len[1][j]){\n                        flag = false;\n                        break;\n                    }\n                }else{\n                    if(len[0][i+j]!=len[1][j]){\n                        flag = false;\n                        break;\n                    }\n                }\n            }else{\n                flag = false;\n                break;\n            }\n        }\n        if(flag){\n            int s=i;\n            for(int j=0; j<s; j++){\n                c[3].push_back(c[0][j]);\n                len[3].push_back(len[0][j]);\n            }\n            if(bsize!=1){\n                c[3].push_back(c[0][s]);\n                len[3].push_back(len[0][s]-len[1][0]);\n            }\n            for(int j=0; j<csize; j++){\n                c[3].push_back(c[2][j]);\n                len[3].push_back(len[2][j]);\n            }\n            c[3].push_back(c[0][s+bsize-1]);\n            len[3].push_back(len[0][s+bsize-1] -len[1].back());\n            for(int j=s+bsize; j<asize; j++){\n                c[3].push_back(c[0][j]);\n                len[3].push_back(len[0][j]);\n            }\n            break;\n        }\n    }\n\n    if(c[3].empty()){\n        c[3] = c[0];\n        len[3] = len[0];\n    }\n    for(int i=0; i<(int)c[3].size(); i++){\n        int n=len[3][i];\n        int curr = c[3][i];\n        for(; i<(int)c[3].size()-1; i++){\n            if(curr==c[3][i+1] || len[3][i+1]==0){\n                n+=len[3][i+1];\n            }else{\n                break;\n            }\n        }\n        if(n!=0){\n            cout << c[3][i] << \" \" << n << \" \";\n        }\n    }\n    cout << \"$\" << endl;\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <vector>\nusing namespace std;\n\nusing Array = basic_string<pair<char, int>>;\nArray a, b, c;\n\nvoid input(Array &a){\n    string c; int l;\n    while(cin >> c, c[0] != '$'){\n        cin >> l;\n        a += make_pair(c[0], l);\n    }\n}\n\nint main(){\n    input(a);\n    input(b);\n    input(c);\n    a = make_pair('0', 0) + a + make_pair('0', 0);\n    if(b.size() == 1){\n        for(int i = 0; i < (int)a.size(); ++i){\n            if(a[i].first == b[0].first && a[i].second >= b[0].second){\n                a[i].second -= b[0].second;\n                a = a.substr(0, i) + c + a.substr(i);\n                break;\n            }\n        }\n    } else {\n        for(int i = 1; i+b.size()-2 <= a.size(); ++i){\n            if(b.substr(1, b.size()-2) == a.substr(i, b.size()-2)){\n                if(a[i-1].first == b[0].first && a[i-1].second >= b[0].second &&\n                    a[i+b.size()-2].first == b.back().first && a[i+b.size()-2].second >= b.back().second){\n                    a[i-1].second -= b[0].second;\n                    a[i+b.size()-2].second -= b.back().second;\n                    a = a.substr(0,i) + c + a.substr(i+b.size()-2);\n                    break;\n                }\n            }\n        }\n    }\n\n    a.erase(remove_if(a.begin(), a.end(), [](pair<char,int> x){ return x.second == 0; }), a.end());\n    for(int i = 0; i < (int)a.size(); ++i){\n        int j = i + 1;\n        while(j < (int)a.size() && a[i].first == a[j].first){\n            a[i].second += a[j].second;\n            a.erase(a.begin()+j);\n        }\n    }\n    for(int i = 0; i < (int)a.size(); ++i){\n        cout << a[i].first << ' ' << a[i].second << ' ';\n    }\n    cout << '$' << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nvoid Output(vector< pair< char, int > >& B)\n{\n  int tal = B.size() - 2;\n  for(int i = B.size() - 1; i > 0; i--) {\n    tal = min(tal, i - 1);\n    while(tal > 0 && B[tal].second == 0) --tal;\n    if(B[i].first == B[tal].first) {\n      B[tal].second += B[i].second;\n      B[i].second = 0;\n    }\n  }\n  for(int i = 0; i < B.size(); i++) {\n    if(B[i].second > 0) {\n      cout << B[i].first << \" \" << B[i].second << \" \";\n    }\n  }\n  cout << \"$\" << endl; \n  exit(0);\n}\n\n\n  \nint main()\n{\n  vector< pair< char, int > > A[3];\n  vector< pair< char, int > > B;\n  \n  for(int i = 0; i < 3; i++) {\n    char C;\n    while(cin >> C, C != '$') {\n      int D;\n      cin >> D;\n      A[i].emplace_back(C, D);\n    }\n  }\n  \n  if(A[1].size() == 1) {\n    for(int i = 0; i < A[0].size(); i++) {\n      if(A[0][i].first == A[1][0].first && A[0][i].second >= A[1][0].second) {\n        for(int j = 0; j < i; j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        for(int j = 0; j < A[2].size(); j++) {\n          B.emplace_back(A[2][j].first, A[2][j].second);\n        }\n        if(A[0][i].second != A[1][0].second) {\n          B.emplace_back(A[0][i].first, A[0][i].second - A[1][0].second);\n        }\n        for(int j = i + 1; j < A[0].size(); j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        Output(B);\n      }\n    }\n  } else {\n    for(int i = 0; i <= A[0].size() - A[1].size(); i++) {\n      if(A[0][i].first == A[1][0].first && A[0][i].second >= A[1][0].second && A[0][i + A[1].size() - 1].first == A[1].back().first && A[0][i + A[1].size() - 1].second >= A[1].back().second) {\n        bool flag = true;\n        for(int j = 1; j < A[1].size() - 1; j++) {\n          flag &= A[0][i + j] == A[1][j];\n        }\n        if(!flag) continue;\n        for(int j = 0; j < i; j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        if(A[0][i].second != A[1][0].second) {\n          B.emplace_back(A[0][i].first, A[0][i].second - A[1][0].second);\n        }\n        for(int j = 0; j < A[2].size(); j++) {\n          B.emplace_back(A[2][j].first, A[2][j].second);\n        }\n        if(A[0][i + A[1].size() - 1].second != A[1].back().second) {\n          B.emplace_back(A[0][i + A[1].size() - 1].first, A[0][i + A[1].size() - 1].second - A[1].back().second);\n        }\n        for(int j = i + A[1].size(); j < A[0].size(); j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        Output(B);\n      }\n    }\n  }\n  for(int i = 0; i < A[0].size(); i++) {\n    B.emplace_back(A[0][i].first, A[0][i].second);\n  }\n  Output(B);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define fi first\n#define se second\nusing namespace std;\ntypedef pair<string,int> P;\nvector<P>v1,v2,v3;\nint x;\nstring s;\nmain(){\n  while(cin>>s,s!=\"$\")cin>>x,v1.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v2.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v3.push_back(P(s,x));\n  r(i,v1.size())if(v1[i].fi==v2[0].fi&&v1[i].se>=v2[0].se){\n    int flag=0,jj=0,ff=0;\n    r(j,(int)v2.size()-2){\n      jj=j+1;\n      if(i+jj>=v1.size()){flag++;break;}\n      if(v2[jj].se!=v1[i+jj].se||v2[jj].fi!=v1[i+jj].fi)flag++;\n    }\n    jj++;\n    if(i+jj>=v1.size())flag++;\n    else if((v2[v2.size()-1].fi!=v1[i+jj].fi||v2[v2.size()-1].se>v1[i+jj].se))flag++;\n    if(v2.size()!=1){\n      if(!flag&&v2[jj].fi==v1[i+jj].fi&&v2[jj].se<=v1[i+jj].se){\n        v1[i].se-=v2[0].se;\n        r(j,v2.size()-2)v1.erase(v1.begin()+i+1);\n        v1[i+1].se-=v2[v2.size()-1].se;\n        r(j,v3.size())v1.insert(v1.begin()+i+1,v3[(int)v3.size()-1-j]);\n      }\n      if(flag)goto L;\n      ff++;\n    }\n    else{\n      if(flag)goto L;\n      v1[i].se-=v2[0].se;\n      r(j,v3.size())v1.insert(v1.begin()+i,v3[(int)v3.size()-1-j]);\n      ff++;\n    }\n    r(j,v1.size())if(v1[j].se==0)v1.erase(v1.begin()+j);\n    r(j,(int)v1.size()-1)if(v1[j].fi==v1[j+1].fi)\n      v1[j].se+=v1[j+1].se,v1.erase(v1.begin()+j+1),j--;\n    break;\n    L:;\n  }\n  r(k,v1.size())cout<<v1[k].fi<<' '<<v1[k].se<<' ';\n  cout<<'$'<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nvoid Output(vector< pair< char, int > >& B)\n{\n  int tal = B.size() - 2;\n  for(int i = B.size() - 1; i > 0; i--) {\n    tal = min(tal, i - 1);\n    while(tal > 0 && B[tal].second == 0) --tal;\n    if(B[i].first == B[tal].first) {\n      B[tal].second += B[i].second;\n      B[i].second = 0;\n    }\n  }\n  for(int i = 0; i < B.size(); i++) {\n    if(B[i].second > 0) {\n      cout << B[i].first << \" \" << B[i].second << \" \";\n    }\n  }\n  cout << \"$\" << endl; \n  exit(0);\n}\n\n\n  \nsigned main()\n{\n  vector< pair< char, int > > A[3];\n  vector< pair< char, int > > B;\n  \n  for(int i = 0; i < 3; i++) {\n    char C;\n    while(cin >> C, C != '$') {\n      int D;\n      cin >> D;\n      A[i].emplace_back(C, D);\n    }\n  }\n  \n  if(A[1].size() == 1) {\n    for(int i = 0; i < A[0].size(); i++) {\n      if(A[0][i].first == A[1][0].first && A[0][i].second >= A[1][0].second) {\n        for(int j = 0; j < i; j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        for(int j = 0; j < A[2].size(); j++) {\n          B.emplace_back(A[2][j].first, A[2][j].second);\n        }\n        if(A[0][i].second != A[1][0].second) {\n          B.emplace_back(A[0][i].first, A[0][i].second - A[1][0].second);\n        }\n        for(int j = i + 1; j < A[0].size(); j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        Output(B);\n      }\n    }\n  } else {\n    for(int i = 0; i <= (int)A[0].size() - (int)A[1].size(); i++) {\n      if(A[0][i].first == A[1][0].first && A[0][i].second >= A[1][0].second && A[0][i + A[1].size() - 1].first == A[1].back().first && A[0][i + A[1].size() - 1].second >= A[1].back().second) {\n        bool flag = true;\n        for(int j = 1; j < A[1].size() - 1; j++) {\n          flag &= A[0][i + j] == A[1][j];\n        }\n        if(!flag) continue;\n        for(int j = 0; j < i; j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        if(A[0][i].second != A[1][0].second) {\n          B.emplace_back(A[0][i].first, A[0][i].second - A[1][0].second);\n        }\n        for(int j = 0; j < A[2].size(); j++) {\n          B.emplace_back(A[2][j].first, A[2][j].second);\n        }\n        if(A[0][i + A[1].size() - 1].second != A[1].back().second) {\n          B.emplace_back(A[0][i + A[1].size() - 1].first, A[0][i + A[1].size() - 1].second - A[1].back().second);\n        }\n        for(int j = i + A[1].size(); j < A[0].size(); j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        Output(B);\n      }\n    }\n  }\n  for(int i = 0; i < A[0].size(); i++) {\n    B.emplace_back(A[0][i].first, A[0][i].second);\n  }\n  Output(B);\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define F first\n#define S second\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define reps(i, f, n) for(int i = (int)(f); i < (int)(n); i++)\n\nconst int inf = 1 << 25;\n\ntypedef pair<char, int> P;\n\nvoid input(vector<P>& v)\n{\n  char c; int l;\n  while(cin >> c, c != '$') {\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n}\n\nint main()\n{\n  vector<P> A; input(A);\n  vector<P> B; input(B);\n  vector<P> C; input(C);\n\n  int a = A.size();\n  int b = B.size();\n  int c = C.size();\n\n  rep(i, a-b+1) {\n    a = A.size();\n    if(A[i].F == B[0].F && A[i].S >= B[0].S &&\n       A[i+b-1].F == B[b-1].F && A[i+b-1].S >= B[b-1].S) {\n      bool flag = true;\n      reps(j, 1, b-1) flag &= (A[i+j].F == B[j].F && A[i+j].S == B[j].S);\n      if(!flag) continue;\n      if(b == 1) {\n\tA[i].S -= B[0].S;\n\tA.insert(begin(A)+i, begin(C), end(C));\n\t//if(A[i].S == 0) A.erase(begin(A)+i, begin(A)+i+1);\n      } else {\n\tA[i].S -= B[0].S;\n        A[i+b-1].S -= B[b-1].S;\n\tauto it1 = begin(A)+i;\n\tauto it2 = it1 + b;\n\tit1++, it2--;\n\t//if(A[i].S != 0) it1++;\n\t//if(A[i+b-1].S != 0) it2--;\n\tA.erase(it1, it2);\n\tA.insert(it1, begin(C), end(C));\n      }\n      i += C.size()+1;\n      for(auto it = begin(A); it != end(A); it++) {\n\tif(it->S == 0) {\n\t  it = A.erase(it, it+1) - 1, i--;\n\t} else {\n\t  auto itr = it+1;\n\t  while(itr != end(A) && it->F == itr->F) it->S += itr->S, itr++, i--;\n\t  if(itr != it+1) it = A.erase(it+1, itr) - 1;\n\t}\n      }\n    }\n  }\n\n  //rep(i, A.size()) cout << A[i].F << \" \" << A[i].S << \" \";\n  rep(i, A.size()) cout << A[i].F << endl << A[i].S << endl;\n  cout << \"$\" << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nstruct UnionFind {\n\tvector<int> v;\n\tUnionFind(int n) : v(n) { for (int i = 0; i < n; i++) v[i] = i; }\n\tint  find(int x) { return v[x] == x ? x : v[x] = find(v[x]); }\n\tvoid unite(int x, int y) { v[find(x)] = find(y); }\n};\n\nint main() {\n\tvector<pair<char, int>> A;\n\tvector<pair<char, int>> B;\n\tvector<pair<char, int>> C;\n\tchar c;\n\twhile (cin >> c, c != '$') {\n\t\tint a;\n\t\tcin >> a;\n\t\tA.push_back({ c,a });\n\t}\n\twhile (cin >> c, c != '$') {\n\t\tint a;\n\t\tcin >> a;\n\t\tB.push_back({ c,a });\n\t}\n\twhile (cin >> c, c != '$') {\n\t\tint a;\n\t\tcin >> a;\n\t\tC.push_back({ c,a });\n\t}\n\tint clear = -1;\n\tREP(i, A.size() - B.size() + 1) {\n\t\tREP(j, B.size()) {\n\t\t\tif (A[i + j].first == B[j].first&&A[i + j].second >= B[j].second) {\n\t\t\t\tif (j != 0 && j != B.size()-1 && A[i + j].second > B[j].second)\n\t\t\t\t\tbreak;\n\t\t\t\tif (j == B.size() - 1) {\n\t\t\t\t\tclear = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tvector<pair<char, int>> ANS = A;\n\tif (clear != -1) {\n\t\tif (B.size() == 1) {\n\t\t\tANS[clear].second -= B[0].second;\n\t\t\tREP(i, C.size())\n\t\t\tANS.insert(ANS.begin() + clear+i, C[i]);\n\t\t}\n\t\telse {\n\t\t\tREP(i, B.size()) {\n\t\t\t\tANS[clear+i].second -= B[i].second;\n\t\t\t}\n\t\t\tREP(i,C.size())\n\t\t\tANS.insert(ANS.begin() + clear + 1+i, C[i]);\n\t\t}\n\t\tREP(i, ANS.size())\n\t\t\tif (ANS[i].second == 0) {\n\t\t\t\tANS.erase(ANS.begin() + i);\n\t\t\t\ti--;\n\t\t\t}\n\t\tREP(i, ANS.size()-1)\n\t\t\tif (ANS[i].first ==ANS[i+1].first) {\n\t\t\t\tANS[i].second += ANS[i + 1].second;\n\t\t\t\tANS.erase(ANS.begin() + i+1);\n\t\t\t\ti--;\n\t\t\t}\n\t}\n\n\tREP(i, ANS.size()) {\n\t\tcout << ANS[i].first << \" \" << ANS[i].second << \" \";\n\t}\n\tcout << \"$\" << endl;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nint main(){\n    vector<vector<char> > c(4);\n    vector<vector<int> > len(4);\n    for(int i=0; i<3; i++){\n        while(1){\n            char letter;\n            int n;\n            cin >> letter;\n            if(letter == '$') break;\n            cin >> n;\n            c[i].push_back(letter);\n            len[i].push_back(n);\n        }\n    }\n\n    int asize = c[0].size();\n    int bsize = c[1].size();\n    int csize = c[2].size();\n    for(int i=0; i<asize-bsize+1; i++){\n        bool flag = true;\n        for(int j=0; j<bsize; j++){\n            if(c[0][i+j] == c[1][j]){\n                if(j==0 || j==bsize-1){\n                    if(len[0][i+j]<len[1][j]){\n                        flag = false;\n                        break;\n                    }\n                }else{\n                    if(len[0][i+j]!=len[1][j]){\n                        flag = false;\n                        break;\n                    }\n                }\n            }else{\n                flag = false;\n                break;\n            }\n        }\n        if(flag){\n            int s=i;\n            for(int j=0; j<s; j++){\n                c[3].push_back(c[0][j]);\n                len[3].push_back(len[0][j]);\n            }\n            if(bsize!=1){\n                c[3].push_back(c[0][s]);\n                len[3].push_back(len[0][s]-len[1][0]);\n            }\n            for(int j=0; j<csize; j++){\n                c[3].push_back(c[2][j]);\n                len[3].push_back(len[2][j]);\n            }\n            c[3].push_back(c[0][s+bsize-1]);\n            len[3].push_back(len[0][s+bsize-1] -len[1].back());\n            for(int j=s+bsize; j<asize; j++){\n                c[3].push_back(c[0][j]);\n                len[3].push_back(len[0][j]);\n            }\n            break;\n        }\n    }\n\n    if(c[3].empty()){\n        c[3] = c[0];\n        len[3] = len[0];\n    }\n    for(int i=0; i<(int)c[3].size(); i++){\n        int n=len[3][i];\n        char curr = c[3][i];\n        for(; i<(int)c[3].size()-1; i++){\n            if(curr==c[3][i+1] || len[3][i+1]==0){\n                n+=len[3][i+1];\n            }else{\n                break;\n            }\n        }\n        if(n!=0){\n            cout << curr << \" \" << n << \" \";\n        }\n    }\n    cout << \"$\" << endl;\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\n\nvector<P>A,B,C;\nvoid input(vector<P> &a){\n  int num;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin>>num;\n    a.push_back(P(ch,num));\n  }\n}\n\nbool check(int i){\n  int n = A.size();\n  int m = B.size();\n  if(i+m>n) return 0;\n  if(A[i].first!=B[0].first||A[i].second<B[0].second)return 0;\n  if(m == 1) return 1;\n\n  i++;\n  for(int j=1;i<m-1;j++,i++)\n    if(A[i].first!=B[j].first||A[i].second!=B[j].second)return 0;\n  \n  if(A[i].first!=B[m-1].first||A[i].second<B[m-1].second)return 0;\n  return 1;\n}\n\nvoid mergePush(vector<P> &res,P a){\n  int c = a.second;\n  char ch = a.first;\n  if(c == 0)return;\n  if(res.size() && res.back().first == ch)res.back().second+=c;\n  else res.push_back(P(ch,c));\n}\n\nvector<P> solve(){\n  vector<P> res;\n  int n = A.size();\n  int m = B.size();\n  int l = C.size();\n  int flg = 0;\n  for(int i=0;i<n;i++){\n    if(!check(i)){mergePush(res,A[i]);continue;}\n    A[i].second -= B[0].second;\n    if(m == 1){\n      for(int j=0;j<l;j++) mergePush(res,C[j]);\n    }\n    else {\n      mergePush(res,P(A[i].first,A[i].second));   \n      for(int j=0;j<l;j++) mergePush(res,C[j]);\n      A[i+m-1].second -= B.back().second;\n    }\n    i+=m-2;\n  }\n  return res;\n}\n\n\nint main(){\n  input(A),input(B),input(C);\n  vector<P> ans = solve();\n  for(P a:ans) cout<<a.first<<\" \"<<a.second<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nint main(){\n    vector<vector<char> > c(4);\n    vector<vector<int> > len(4);\n    for(int i=0; i<3; i++){\n        while(1){\n            char letter;\n            int n;\n            cin >> letter;\n            if(letter == '$') break;\n            cin >> n;\n            c[i].push_back(letter);\n            len[i].push_back(n);\n        }\n    }\n\n    int asize = c[0].size();\n    int bsize = c[1].size();\n    int csize = c[2].size();\n    for(int i=0; i<asize-bsize+1; i++){\n        bool flag = true;\n        for(int j=0; j<bsize; j++){\n            if(c[0][i+j] == c[1][j]){\n                if(j==0 || j==bsize-1){\n                    if(len[0][i+j]<len[1][j]){\n                        flag = false;\n                        break;\n                    }\n                }else{\n                    if(len[0][i+j]!=len[1][j]){\n                        flag = false;\n                        break;\n                    }\n                }\n            }else{\n                flag = false;\n                break;\n            }\n        }\n        if(flag){\n            int s=i;\n            for(int j=0; j<s; j++){\n                c[3].push_back(c[0][j]);\n                len[3].push_back(len[0][j]);\n            }\n            c[3].push_back(c[0][s]);\n            len[3].push_back(len[0][s]-len[1][0]);\n            \n            for(int j=0; j<csize; j++){\n                c[3].push_back(c[2][j]);\n                len[3].push_back(len[2][j]);\n            }\n            c[3].push_back(c[0][s+bsize-1]);\n            len[3].push_back(len[0][s+bsize-1] -len[1].back());\n            for(int j=s+bsize; j<asize; j++){\n                c[3].push_back(c[0][j]);\n                len[3].push_back(len[0][j]);\n            }\n            break;\n        }\n    }\n\n    for(int i=0; i<(int)c[3].size(); i++){\n        int n=len[3][i];\n        for(;i<(int)c[3].size(); i++){\n            if(i==(int)c[3].size()-1 || c[3][i]!=c[3][i+1]){\n                i++;\n                break;\n            }else{\n                n+=len[3][i+1];\n            }\n        }\n        i--;\n        if(n!=0){\n            cout << c[3][i] << \" \" << n << \" \";\n        }\n    }\n    cout << \"$\" << endl;\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);++(i))\n#define all(x) (x).begin(),(x).end()\n#define pb push_back\n#define fi first\n#define se second\n#define dbg(x) cout<<#x\" = \"<<((x))<<endl\ntemplate<class T,class U> ostream& operator<<(ostream& o, const pair<T,U> &p){o<<\"(\"<<p.fi<<\",\"<<p.se<<\")\";return o;}\ntemplate<class T> ostream& operator<<(ostream& o, const vector<T> &v){o<<\"[\";for(T t:v){o<<t<<\",\";}o<<\"]\";return o;}\n\nusing pc = pair<char,int>;\nusing icpc = vector<pc>;\n\nicpc readICPC()\n{\n    icpc ret;\n    char c;\n    while(cin >>c,(c!='$'))\n    {\n        int l;\n        cin >>l;\n        ret.pb({c,l});\n    }\n    return ret;\n}\n\nicpc solve(icpc a, icpc b, icpc c)\n{\n    int A = a.size(), B = b.size(), C = c.size();\n\n    if(B==1)\n    {\n        rep(i,A)\n        {\n            // ?????????????????§??????\n            if(a[i].fi==b[0].fi && a[i].se>=b[0].se)\n            {\n                icpc ret;\n                rep(j,i) ret.pb(a[j]);\n                rep(j,C) ret.pb(c[j]);\n                ret.pb({b[0].fi, a[i].se-b[0].se});\n                for(int j=i+1; j<A; ++j) ret.pb(a[j]);\n                return ret;\n            }\n        }\n    }\n    else\n    {\n        rep(i,A-B+1)\n        {\n            bool ok = false;\n            if(a[i].fi==b[0].fi && a[i].se>=b[0].se && a[i+B-1].fi==b[B-1].fi && a[i+B-1].se>=b[B-1].se)\n            {\n                ok = true;\n                for(int j=1; j<B-1; ++j)\n                {\n                    if(!(a[i+j].fi==b[j].fi && a[i+j].se==b[j].se)) ok = false;\n                }\n            }\n\n            if(ok)\n            {\n                icpc ret;\n                rep(j,i) ret.pb(a[j]);\n                ret.pb({a[i].fi, a[i].se-b[0].se});\n                rep(j,C) ret.pb(c[j]);\n                ret.pb({a[i+B-1].fi, a[i+B-1].se-b[B-1].se});\n                for(int j=i+B; j<A; ++j) ret.pb(a[j]);\n                return ret;\n            }\n        }\n    }\n    // ???????????????????????°???????????????\n    return a;\n}\n\nicpc compress(icpc s)\n{\n    icpc ret;\n    rep(i,s.size())\n    {\n        if(s[i].se == 0) continue;\n\n        if(ret.size() == 0) ret.pb(s[i]);\n        else\n        {\n            int R = ret.size();\n            if(ret[R-1].fi == s[i].fi) ret[R-1].se += s[i].se;\n            else ret.pb(s[i]);\n        }\n    }\n    return ret;\n}\n\nint main()\n{\n    icpc a = readICPC();\n    icpc b = readICPC();\n    icpc c = readICPC();\n\n    icpc ans = compress(solve(a,b,c));\n    rep(i,ans.size()) printf(\"%c %d \", ans[i].fi, ans[i].se);\n    printf(\"$\\n\");\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define fi first\n#define se second\nusing namespace std;\ntypedef pair<string,int> P;\nvector<P>v1,v2,v3;\nint x;\nstring s;\nmain(){\n  while(cin>>s,s!=\"$\")cin>>x,v1.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v2.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v3.push_back(P(s,x));\n  r(i,v1.size())if(v1[i].fi==v2[0].fi&&v1[i].se>=v2[0].se){\n    int flag=0,jj=0;\n    r(j,v2.size()-2){\n      jj=j+1;\n      if(i+jj>=v1.size()){flag++;break;}\n      if(v2[jj].se!=v1[i+jj].se||v2[jj].fi!=v1[i+jj].fi)flag++;\n    }\n    jj++;\n    if(!flag&&v2[jj].fi==v1[i+jj].fi&&v2[jj].se<=v1[i+jj].se){\n      v1[i].se-=v2[0].se;\n      r(j,v2.size()-2)v1.erase(v1.begin()+i+1);\n      v1[i+1].se-=v2[v2.size()-1].se;\n      r(j,v3.size())v1.insert(v1.begin()+i+1,v3[j]);\n    }\n    r(j,v1.size())if(v1[j].se==0)v1.erase(v1.begin()+i);\n    r(j,v1.size()-1)if(v1[j].fi==v1[j+1].fi)\n      v1[j].se+=v1[j+1].se,v1.erase(v1.begin()+j+1),j--;\n  }\n  r(k,v1.size())cout<<v1[k].fi<<' '<<v1[k].se<<' ';\n  cout<<'$'<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#include <string>\n#include <cstdio>\n#include <algorithm>\n#include <cstdlib>\n#include <ctype.h>\n#include <cmath>\n#include <stack>\n#include <queue>\n#include <map>\n#include <vector>\n#include <limits.h>\nusing namespace std;\nconst int INF = 0x3f3f3f3f;\nconst int N = 1000+10;\nint ai, bi, ci;\nint m, n;\nint begin, end;\nstruct node{\n\tchar x;\n\tint y;\n}a[N],b[N],c[N],ans[N],bns[N];\nint bj = 0;\nbool flag = true;\nbool dfs(int t, int x){\n\tif(t == ci && flag)\treturn flag;\n\tif(t == 0){\n\t\tif(c[t].x == a[x].x && c[t].y <= a[x].y){\n\t\t\tbegin = a[x].y - c[t].y;\n\t\t\tdfs(t+1, x+1);\n\t\t}else{\n\t\t\tflag = false;\n\t\t\treturn false;\n\t\t}\n\t}else if(t == ci-1){\n\t\tif(c[t].x == a[x].x && c[t].y <= a[x].y){\n\t\t\tend = a[x].y - c[t].y;\n\t\t\treturn true;\n\t\t}else{\n\t\t\tflag = false;\n\t\t\treturn false;\n\t\t}\n\t}else{\n\t\tif(c[t].x == a[x].x && c[t].x == a[x].x){\n\t\t\tdfs(t+1, x+1);\n\t\t}else{\n\t\t\tflag = false;\n\t\t\treturn false;\n\t\t}\n\t} \n}\nvoid print(){\n\tbns[0].x = ans[0].x;\n\tbns[0].y = ans[0].y;\n\tfor(int i = 1; i < ai+bi; i++){\n\t\tif(ans[i].y == 0)\tcontinue;\n\t\tif(ans[i].x == bns[bj].x){\n\t\t\tbns[bj].y += ans[i].y;\n\t\t}else{\n\t\t\tbj++;\n\t\t\tbns[bj].x = ans[i].x;\n\t\t\tbns[bj].y = ans[i].y;\n\t\t}\n\t}\n}\n\nint main(){\n\tstd::ios::sync_with_stdio(false);\n\tai = bi = ci = 0;\n\tchar le;\n\tint num;\n\twhile(1){\n\t\tcin >> le;\n\t\tif(le == '$') \tbreak;\n\t\tcin >> num;\n\t\ta[ai].x = le;\n\t\ta[ai].y = num;\n\t\tai++;\n\t}\n\twhile(1){\n\t\tcin >> le;\n\t\tif(le == '$') \tbreak;\n\t\tcin >> num;\n\t\tc[ci].x = le;\n\t\tc[ci].y = num;\n\t\tci++;\n\t}\n\twhile(1){\n\t\tcin >> le;\n\t\tif(le == '$') \tbreak;\n\t\tcin >> num;\n\t\tb[bi].x = le;\n\t\tb[bi].y = num;\n\t\tbi++;\n\t}\n\tif(ci > ai){\n\t\tfor(int i = 0; i < ai; i++)\n\t\tcout << a[i].x << \" \" << a[i].y << \" \";\n\t\tcout << endl;\n\t\treturn 0; \n\t}\n\tfor(int i = 0; i <= ai-ci; i++){\n\t\tif(dfs(0,i)){\n\t\t\tint j = 0;\n\t\t\tfor(j = 0; j <= i; j++){\n\t\t\t\tif(j == i){\n\t\t\t\t\tans[j].x = a[j].x;\n\t\t\t\t\tans[j].y = begin;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tans[j].x = a[j].x;\n\t\t\t\tans[j].y = a[j].y;\n\t\t\t}\n\t\t\tint mm;\n\t\t\tfor(int k = 0; k < bi; k++,j++){\n\t\t\t\tans[j].x = b[k].x;\n\t\t\t\tans[j].y = b[k].y;\n\t\t\t}\n\t\t\tfor(int k = i+ci-1; k < ai; j++,k++){\n\t\t\t\tif(k == ai-1){\n\t\t\t\t\tans[j].x = a[k].x;\n\t\t\t\t\tans[j].y = end;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tans[j].x = a[k].x;\n\t\t\t\tans[j].y = a[k].y;\n\t\t\t}\n\t\t\tprint();\n\t\t\tfor(int i = 0; i <= bj; i++)\n\t\t\tcout << bns[i].x << \" \" << bns[i].y << \" \";\n\t\t\tcout << \"$\" << endl;\n\t\t\treturn 0;\n\t\t}\n\t}\n\tfor(int i = 0; i < ai; i++)\n\t\tcout << a[i].x << \" \" << a[i].y << \" \";\n\t\tcout << endl;\n\treturn 0;\n}\n\n\n/*\n\nR 100 L 100 $\nR 50 L 50 $\nC 50 D 50 $\n\n\n\n*/\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <cassert>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<(n);++i)\n#define rep1(i,n) for(int i=1;i<=(n);++i)\n#define ALL(c) (c).begin(),(c).end()\ntypedef pair<char,int> P;\nvector<P> a,b,c,ans;\nvoid init(vector<P>& vc){\n\twhile(true){\n\t\tchar ch;\n\t\tint l;\n\t\tcin >> ch;\n\t\tif(ch=='$') break;\n\t\tcin >> l;\n\t\tvc.push_back(P(ch,l));\n\t}\n}\nint main(){\n\tinit(a);\n\tinit(b);\n\tinit(c);\n//\tassert(a.size()-b.size()<=a.size());\n\tif(b.size()>a.size()){\n\t\trep(j,a.size()) cout << a[j].first << \" \" << a[j].second << \" \";\n\t\tcout << \"$\" << endl;\n\t\treturn 0;\n\t}\n\trep(i,(int)(a.size())-b.size()+1){\n//\t\tassert(i<a.size());\n//\t\tassert(b.size()>0);\t\t//true\n\t\tbool able=true;\n\t\trep(j,b.size()){\n\t\t\tif(b[j].first!=a[i+j].first){\n\t\t\t\table=false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!able) continue;\n\t\tif(b[0].second>a[i].second) continue;\n\t\table=true;\n\t\tfor(int j=1;j<b.size()-1;j++){\n\t\t\tif(b[j].second!=a[i+j].second){\n\t\t\t\table=false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!able) continue;\n\t\tif(b[b.size()-1].second>a[i+b.size()-1].second) continue;\n\t\trep(j,i){\n//\t\t\tassert(j<a.size());\t\t\t//false\n\t\t\tans.push_back(a[j]);\n//\t\t\tassert(a[j].second>=0);\t\t//a[j]==0???????????????\n\t\t}\n\t\tif(b.size()>1 && a[i].second!=b[0].second){\n\t\t\tans.push_back(P(a[i].first,a[i].second-b[0].second));\n//\t\t\tassert(a[i].second-b[0].second>0);\n\t\t}\n\t\trep(j,c.size()){\n\t\t\tans.push_back(c[j]);\n//\t\t\tassert(c[j].second>0);\n\t\t}\n\t\tif(a[i+b.size()-1].second!=b[b.size()-1].second){\n\t\t\tans.push_back(P(a[i+b.size()-1].first,a[i+b.size()-1].second-b[b.size()-1].second));\n//\t\t\tassert(a[i+b.size()-1].second-b[b.size()-1].second>0);\n\t\t}\n\t\tfor(int j=i+b.size();j<a.size();j++) ans.push_back(a[j]);\n\t\trep(j,ans.size()-1){\n\t\t\tif(ans[j].first==ans[j+1].first){\n\t\t\t\tans[j].second+=ans[j+1].second;\n\t\t\t\tans.erase(ans.begin()+(j+1));\n\t\t\t\tj--;\n\t\t\t}\n\t\t}\n\t\trep(j,ans.size()) cout << ans[j].first << \" \" << ans[j].second << \" \";\n\t\tcout << \"$\" << endl;\n\t\treturn 0;\n\t}\n\trep(i,a.size()){\n//\t\tassert(a[i].second!=0);\n\t\tcout << a[i].first << \" \" << a[i].second << \" \";\n\t}\n\tcout << \"$\" << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\nusing namespace std;\ntypedef pair<char,int> P;\n\nchar c[3][1001];\nint l[3][1001];\nint si[3];\nvector<P> ans;\n\nint main(){\n\trep(i,3){\n\t\tfor(int j = 0;;j++){\n\t\t\tcin >> c[i][j];\n\t\t\tif(c[i][j] == '$'){\n\t\t\t\tsi[i] = j;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcin >> l[i][j];\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\t//if(si[0]-i < si[1]) break;\n\t\tif(c[0][i] == c[1][0] && l[0][i] >= l[1][0]){\n\t\t\tif(si[1] == 1){\n\t\t\t\tl[0][i] -= l[1][0];\n\t\t\t\trep(j,i) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t\trep(j,si[2]) ans.push_back(P(c[2][j],l[2][j]));\n\t\t\t\tfor(int j = i; j < si[0]; j++){\n\t\t\t\t\tif(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t\t}\n\t\t\t\tfor(int j = ans.size()-1; j >= 1; j--){\n\t\t\t\t\tif(ans[j].first == ans[j-1].first){\n\t\t\t\t\t\tans[j-1].second += ans[j].second;\n\t\t\t\t\t\tans[j].second = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trep(j,ans.size()){\n\t\t\t\t\tif(ans[j].second == 0) continue;\n\t\t\t\t\tprintf(\"%c %d \",ans[j].first,ans[j].second);\n\t\t\t\t}\n\t\t\t\tputs(\"$\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbool ok = true;\n\t\t\tfor(int j = 1; j < si[1]-1; j++){\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] != l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!ok) continue;\n\t\t\t{\n\t\t\t\tint j = si[1]-1;\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] < l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(!ok) continue;\n\t\t\t\tl[0][i] -= l[1][0];\n\t\t\t\tl[0][i+j] -= l[1][j];\n\t\t\t}\n\t\t\trep(j,i+1) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\trep(j,si[2]) ans.push_back(P(c[2][j],l[2][j]));\n\t\t\tfor(int j = i+si[1]-1; j < si[0]; j++){\n\t\t\t\tif(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t}\n\t\t\tfor(int j = ans.size()-1; j >= 1; j--){\n\t\t\t\tif(ans[j].first == ans[j-1].first){\n\t\t\t\t\tans[j-1].second += ans[j].second;\n\t\t\t\t\tans[j].second = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\trep(j,ans.size()){\n\t\t\t\tif(ans[j].second == 0) continue;\n\t\t\t\tprintf(\"%c %d \",ans[j].first,ans[j].second);\n\t\t\t}\n\t\t\tputs(\"$\");\n\t\t\treturn 0;\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tprintf(\"%c %d \",c[0][i],l[0][i]);\n\t}\n\tputs(\"$\");\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\nint main(){\n  vector<char> A_c, B_c, C_c, ans_c;\n  vector<int> A_l, B_l, C_l, ans_l;\n  char c_ = '!';\n  int l;\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    A_c.push_back(c_);\n    A_l.push_back(l);\n  }\n  c_ = '!';\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    B_c.push_back(c_);\n    B_l.push_back(l);\n  }\n  c_ = '!';\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    C_c.push_back(c_);\n    C_l.push_back(l);\n  }\n  int a = A_c.size(), b = B_c.size(), c = C_c.size();\n  bool g = false;\n  for(int i = 0; i < a; ++i){\n    bool f = true;\n    for(int j = 0; j < b; ++j){\n      if(g || i+j >= a){\n        f = false;\n        break;\n      }\n      if((j > 0 && j < b - 1 && A_l[i+j] != B_l[j]) ||\n         (A_c[i+j] != B_c[j]) ||\n         (j%(b-1) == 0 && A_l[i+j] < B_l[j])){\n        f = false;\n        break;\n      }\n    }\n    if(f){\n      g = true;\n      if(A_l[i] - B_l[0] > 0){\n        ans_c.push_back(A_c[i]);\n        ans_l.push_back(A_l[i] - B_l[0]);\n      }\n      for(int j = 0; j < c; ++j){\n        if(ans_c.size() > 0 && ans_c.back() == C_c[j]) ans_l.back() += C_l[j];\n        else{\n          ans_c.push_back(C_c[j]);\n          ans_l.push_back(C_l[j]);\n        }\n      }\n      if(A_l[i+b-1] - B_l.back() > 0){\n        if(ans_c.back() == A_c[i+b-1]) ans_l.back() += A_l[i+b-1] - B_l[b-1];\n        else{\n          ans_c.push_back(A_c[i+b-1]);\n          ans_l.push_back(A_l[i+b-1] - B_l[b-1]);\n        }\n      }\n    }else{\n      if(ans_c.back() == A_c[i]) ans_l.back() += A_l[i];\n      else{\n        ans_c.push_back(A_c[i]);\n        ans_l.push_back(A_l[i]);\n      }\n    }\n    i += b-1;\n  }\n  for(int i = 0; i < ans_c.size(); ++i){\n    cout << ans_c[i] <<  \" \" << ans_l[i] << \" \";\n  }\n  cout << \"$\" << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 998244353;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef long double ld;\ntypedef complex<ld> Point;\nconst ld eps = 1e-11;\nconst ld pi = acos(-1.0);\ntypedef pair<ll, ll> LP;\nint main() {\n\tchar at[1000]; int an[1000];\n\tchar bt[1000]; int bn[1000];\n\tchar ct[1000]; int cn[1000];\n\tchar x;\n\tint c1 = 0; int m;\n\twhile (cin >> x) {\n\t\tif (x == '$')break;\n\t\tcin >> m;\n\t\tat[c1] = x; an[c1] = m; c1++;\n\t}\n\tint c2 = 0;\n\twhile (cin >> x) {\n\t\tif (x == '$')break;\n\t\tcin >> m;\n\t\tbt[c2] = x; bn[c2] = m; c2++;\n\t}\n\tint c3 = 0;\n\twhile (cin >> x) {\n\t\tif (x == '$')break;\n\t\tcin >> m;\n\t\tct[c3] = x; cn[c3] = m; c3++;\n\t}\n\tint chk = -1;\n\trep(i, c1 - c2+1) {\n\t\tif (at[i] == bt[0]) {\n\t\t\tbool f = true;\n\t\t\tif (an[i] < bn[0])f = false;\n\t\t\tRep(k, 1 ,c2-1){\n\t\t\t\tif (at[i + k] != bt[k] || an[i + k] != bn[k])f = false;\n\t\t\t}\n\t\t\tif (at[i+c2-1]!=bt[c2-1]||an[i + c2 - 1] < bn[c2 - 1])f = false;\n\t\t\tif (f) {\n\t\t\t\tchk = i; break;\n\t\t\t}\n\t\t}\n\t}\n\tqueue<pair<char, int>> q1, q2;\n\tif (chk == -1) {\n\t\trep(i, c1) {\n\t\t\tq1.push({ at[i],an[i] });\n\t\t}\n\t}\n\telse {\n\t\trep(i, chk) {\n\t\t\tq1.push({ at[i],an[i] });\n\t    }\n\t\tif (c2>1&&an[chk] - bn[0] > 0) {\n\t\t\tq1.push({ at[chk],an[chk] - bn[0] });\n\t\t}\n\t\trep(i, c3) {\n\t\t\tq1.push({ ct[i],cn[i] });\n\t\t}\n\t\tif (an[chk + c2 - 1] - bn[c2 - 1] > 0) {\n\t\t\tq1.push({ at[chk + c2 - 1],an[chk + c2 - 1] - bn[c2 - 1] });\n\t\t}\n\t\tRep(i, chk + c2, c1) {\n\t\t\tq1.push({ at[i],an[i] });\n\t\t}\n\t}\n\tpair<char, int>memo = { '#',-1 };\n\twhile (!q1.empty()) {\n\t\tpair<char, int> now = q1.front(); q1.pop();\n\t\tif (now.first == memo.first) {\n\t\t\tmemo.second += now.second;\n\t\t}\n\t\telse {\n\t\t\tif (memo.second >= 0) {\n\t\t\t\tq2.push(memo);\n\t\t\t}\n\t\t\tmemo = now;\n\t\t}\n\t}\n\tq2.push(memo);\n\twhile (!q2.empty()) {\n\t\tpair<char, int> out = q2.front(); q2.pop();\n\t\tcout << out.first << \" \" << out.second << \" \";\n\t}\n\tcout << '$' << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\n\nstruct Node{\n\tchar ch;\n\tint length;\n\tNode* prev;\n\tNode* next;\n};\n\nstruct Info{\n\tvoid set(char arg_ch,int arg_length){\n\t\tch = arg_ch;\n\t\tlength = arg_length;\n\t}\n\tchar ch;\n\tint length;\n\tbool isFirst,isLast;\n};\n\nInfo A[3000],B[3000],C[3000];\nint a_len = 0,b_len = 0,c_len = 0;\n\nclass List{\npublic:\n\tList(){\n\t\tmotherNode = new Node();\n\t\tmotherNode->ch = '#';\n\t\tmotherNode->length = -1;\n\t\tmotherNode->prev = motherNode;\n\t\tmotherNode->next = motherNode;\n\t\tmatchFirstNode = motherNode;\n\t\tmatchLastNode = motherNode;\n\t\tleft_complete_match = false;\n\t\tright_complete_match = false;\n\t};\n\tvoid registA(Info info){\n\n\t\tNode* tmpNode = motherNode->prev;\n\t\tmotherNode->prev = new Node;\n\t\tmotherNode->prev->ch = info.ch;\n\t\tmotherNode->prev->length = info.length;\n\t\tmotherNode->prev->next = motherNode;\n\t\tmotherNode->prev->prev = tmpNode;\n\t\ttmpNode->next = motherNode->prev;\n\t};\n\n\tbool isMatchB(){\n\n\t\tbool FLG;\n\t\tint index;\n\n\t\tNode* startNode = motherNode;\n\t\tNode* tmpNode;\n\n\t\twhile(true){\n\t\t\tstartNode = startNode->next;\n\t\t\tif(startNode == motherNode)break;\n\n\t\t\ttmpNode = startNode;\n\n\t\t\tindex = 0;\n\n\t\t\tFLG = true;\n\n\t\t\twhile(tmpNode != motherNode){\n\t\t\t\tif(tmpNode->ch != B[index].ch){\n\t\t\t\t\tFLG = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}else{\n\n\t\t\t\t\tif(B[index].isFirst == false && B[index].isLast == false){\n\t\t\t\t\t\tif(tmpNode->length != B[index].length){\n\t\t\t\t\t\t\tFLG = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmpNode = tmpNode->next;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(tmpNode->length >= B[index].length){\n\t\t\t\t\t\t\ttmpNode = tmpNode->next;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tFLG = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(index == b_len)break;\n\t\t\t}\n\n\t\t\tif(FLG == true && index == b_len){\n\n\t\t\t\tif(startNode->length == B[0].length){\n\t\t\t\t\tmatchFirstNode = startNode->prev;\n\t\t\t\t\tleft_complete_match = true;\n\t\t\t\t}else{\n\t\t\t\t\tmatchFirstNode = startNode;\n\t\t\t\t}\n\n\t\t\t\ttmpNode = tmpNode->prev;\n\t\t\t\tif(tmpNode->length == B[b_len-1].length){\n\t\t\t\t\tmatchLastNode = tmpNode->next;\n\t\t\t\t\tright_complete_match = true;\n\t\t\t\t}else{\n\t\t\t\t\tmatchLastNode = tmpNode;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tvoid replace(){\n\n\t\tNode* tmpNode,*preNode,*firstNext;\n\t\tint index;\n\n\t\tfirstNext = matchFirstNode->next;\n\n\t\tif(left_complete_match){\n\t\t\tif(matchFirstNode->ch == C[0].ch){\n\t\t\t\tmatchFirstNode->length += C[0].length;\n\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\tindex = 1;\n\t\t\t}else{\n\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\tindex = 0;\n\t\t\t}\n\t\t}else{\n\n\t\t\tif(b_len > 1){\n\t\t\t\tif(matchFirstNode->ch != C[0].ch){\n\t\t\t\t\tmatchFirstNode->length -= B[0].length;\n\t\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\t\tindex = 0;\n\t\t\t\t}else{\n\t\t\t\t\tmatchFirstNode->length = matchFirstNode->length - B[0].length + C[0].length;\n\t\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\t\tindex = 1;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tfirstNext->prev = new Node;\n\t\t\t\tfirstNext->prev->next = firstNext;\n\t\t\t\tfirstNext->prev->ch = matchFirstNode->ch;\n\t\t\t\tfirstNext->prev->length = matchFirstNode->length - B[0].length;\n\t\t\t\tfirstNext = firstNext->prev;\n\t\t\t\tfirstNext->prev = matchFirstNode;\n\n\t\t\t\tif(matchFirstNode->prev->ch == C[0].ch){\n\t\t\t\t\tmatchFirstNode->prev->length += C[0].length;\n\t\t\t\t\ttmpNode = matchFirstNode;\n\t\t\t\t\tindex = 1;\n\t\t\t\t}else{\n\t\t\t\t\ttmpNode = matchFirstNode;\n\t\t\t\t\tindex = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tpreNode = matchFirstNode;\n\n\t\tif(index == c_len){\n\t\t\tif(right_complete_match){\n\t\t\t\tif(matchLastNode->ch != C[0].ch){\n\t\t\t\t\tmatchFirstNode->next = matchLastNode;\n\t\t\t\t\tmatchLastNode->prev = matchFirstNode;\n\t\t\t\t}else{\n\t\t\t\t\tmatchFirstNode->length += matchLastNode->length;\n\t\t\t\t\tmatchFirstNode->next = matchLastNode->next;\n\t\t\t\t\tmatchLastNode->next->prev = matchFirstNode;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(matchFirstNode != matchLastNode){\n\t\t\t\t\tif(matchLastNode->ch != C[0].ch){\n\t\t\t\t\t\tmatchFirstNode->next = matchLastNode;\n\t\t\t\t\t\tmatchLastNode->prev = matchFirstNode;\n\t\t\t\t\t\tmatchLastNode->length -= B[b_len-1].length;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tmatchFirstNode->length += matchLastNode->length - B[b_len-1].length;\n\t\t\t\t\t\tmatchFirstNode->next = matchLastNode->next;\n\t\t\t\t\t\tmatchLastNode->next->prev = matchFirstNode;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\n\t\t\t\t\tif(b_len == 1){ //c_len == 1\n\t\t\t\t\t\tif(firstNext->ch != C[0].ch){\n\t\t\t\t\t\t\tmatchFirstNode->ch = C[0].ch;\n\t\t\t\t\t\t\tmatchFirstNode->length = C[0].length;\n\t\t\t\t\t\t\tmatchFirstNode->next = firstNext;\n\t\t\t\t\t\t}else{ //firstNext.ch == C[0].ch\n\t\t\t\t\t\t\tmatchFirstNode->ch = C[0].ch;\n\t\t\t\t\t\t\tmatchFirstNode->length = C[0].length + firstNext->length;\n\t\t\t\t\t\t\tmatchFirstNode->next = firstNext->next;\n\t\t\t\t\t\t\tfirstNext->next->prev = matchFirstNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{ //b_len != 1\n\t\t\t\t\t\t//Do nothing\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\twhile(index < c_len){\n\t\t\tif(index != c_len - 1){\n\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\tpreNode = tmpNode;\n\t\t\t\ttmpNode->next = new Node;\n\t\t\t\ttmpNode = tmpNode->next;\n\t\t\t\tindex++;\n\t\t\t}else{\n\t\t\t\tif(right_complete_match){\n\t\t\t\t\tif(matchLastNode->ch != C[index].ch){\n\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\ttmpNode->next = matchLastNode;\n\t\t\t\t\t\tmatchLastNode->prev = tmpNode;\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}else{\n\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\ttmpNode->length = C[index].length + matchLastNode->length;\n\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\ttmpNode->next = matchLastNode->next;\n\t\t\t\t\t\tmatchLastNode->next->prev = tmpNode;\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\n\t\t\t\t\tif(matchFirstNode != matchLastNode){\n\t\t\t\t\t\tif(matchLastNode->ch != C[index].ch){\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = matchLastNode;\n\t\t\t\t\t\t\tmatchLastNode->length -= B[b_len-1].length;\n\t\t\t\t\t\t\tmatchLastNode->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = matchLastNode->length-B[b_len-1].length + C[index].length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = matchLastNode->next;\n\t\t\t\t\t\t\tmatchLastNode->next->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\n\t\t\t\t\t\tif(firstNext->ch != C[index].ch){\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = firstNext;\n\t\t\t\t\t\t\tfirstNext->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = C[index].length + firstNext->length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = firstNext->next;\n\t\t\t\t\t\t\tfirstNext->next->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tvoid output(){\n\n\t\tNode* tmpNode = motherNode->next;\n\t\twhile(tmpNode != motherNode){\n\t\t\tprintf(\"%c %d \",tmpNode->ch,tmpNode->length);\n\t\t\ttmpNode = tmpNode->next;\n\t\t}\n\n\t\tprintf(\"$\\n\");\n\t}\n\nprivate:\n\tNode* motherNode,*matchFirstNode,*matchLastNode;\n\tbool left_complete_match,right_complete_match;\n};\n\n\n\nint main(){\n\n\tList list;\n\n\tchar buf[2];\n\tint num;\n\tInfo tmp;\n\n\twhile(true){\n\t\tscanf(\"%s\",buf);\n\t\tif(buf[0] == '$')break;\n\n\t\tscanf(\"%d\",&num);\n\n\t\ttmp.set(buf[0],num);\n\t\tA[a_len++].set(buf[0],num);\n\n\t\tlist.registA(tmp);\n\t}\n\n\tfor(int i = 0; i < 2000; i++){\n\t\tB[i].isFirst = false;\n\t\tB[i].isLast = false;\n\t}\n\n\twhile(true){\n\t\tscanf(\"%s\",buf);\n\t\tif(buf[0] == '$')break;\n\n\t\tscanf(\"%d\",&num);\n\n\t\tB[b_len++].set(buf[0],num);\n\t}\n\n\tB[0].isFirst = true;\n\tB[b_len-1].isLast = true;\n\n\tif(!list.isMatchB()){\n\n\t\tfor(int i = 0; i < a_len; i++){\n\t\t\tprintf(\"%c %d \",A[i].ch,A[i].length);\n\t\t}\n\t\tprintf(\"$\\n\");\n\t\treturn 0;\n\t}\n\n\twhile(true){\n\t\tscanf(\"%s\",buf);\n\t\tif(buf[0] == '$')break;\n\n\t\tscanf(\"%d\",&num);\n\n\t\tC[c_len++].set(buf[0],num);\n\t}\n\n\tlist.replace();\n\n\tlist.output();\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\n\nvector<P>A,B,C;\nvoid input(vector<P> &a){\n  int num;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin>>num;\n    a.push_back(P(ch,num));\n  }\n}\n\nbool check(int i){\n  int n = A.size();\n  int m = B.size();\n  if(i+m>n) return 0;\n  if(A[i].first!=B[0].first||A[i].second<B[0].second)return 0;\n  if(m == 1) return 1;\n\n  i++;\n  for(int j=1;i<m-1;j++,i++)\n    if(A[i].first!=B[j].first||A[i].second!=B[j].second)return 0;\n  \n  if(A[i].first!=B[m-1].first||A[i].second<B[m-1].second)return 0;\n  return 1;\n}\n\nvoid mergePush(vector<P> &res,P a){\n  int c = a.second;\n  char ch = a.first;\n  if(c == 0)return;\n  if(res.size() && res.back().first == ch)res.back().second+=c;\n  else res.push_back(P(ch,c));\n}\n\nvector<P> solve(){\n  vector<P> res;\n  int n = A.size();\n  int m = B.size();\n  int l = C.size();\n  int flg = 0;\n  for(int i=0;i<n;i++){\n    if(!check(i)||flg++){mergePush(res,A[i]);continue;}\n    A[i].second -= B[0].second;\n    if(m == 1){\n      for(int j=0;j<l;j++) mergePush(res,C[j]);\n      mergePush(res,P(A[i].first,A[i].second));   \n    }\n    else {\n      mergePush(res,P(A[i].first,A[i].second));   \n      for(int j=0;j<l;j++) mergePush(res,C[j]);\n      A[i+m-1].second -= B.back().second;\n    }\n    i+=m-2;\n  }\n  return res;\n}\n\n\nint main(){\n  input(A),input(B),input(C);\n  vector<P> ans = solve();\n  for(P a:ans) cout<<a.first<<\" \"<<a.second<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"iostream\"\n#include \"climits\"\n#include \"list\"\n#include \"queue\"\n#include \"stack\"\n#include \"set\"\n#include \"functional\"\n#include \"algorithm\"\n#include \"string\"\n#include \"map\"\n#include \"unordered_map\"\n#include \"unordered_set\"\n#include \"iomanip\"\n#include \"cmath\"\n#include \"random\"\n#include \"bitset\"\n#include \"cstdio\"\n#include \"numeric\"\n#include \"cassert\"\n#include \"ctime\"\n\nusing namespace std;\n\nconstexpr long long int MOD = 1000000007;\n//constexpr int MOD = 1000000007;\n//constexpr int MOD = 998244353;\n//constexpr long long int MOD = 998244353;\nconstexpr double EPS = 1e-12;\n\n//int N, M, K, T, H, W, L, R;\nlong long int N, M, K, T, H, W, L, R;\n\nvoid push(vector<pair<char, long long int>>&ans, pair<char , long long int>c) {\n\tif (ans.empty() || ans.back().first!= c.first) {\n\t\tans.push_back(c);\n\t}\n\telse ans.back().second += c.second;\n}\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\n\tvector<pair<char, long long int>>v;\n\tvector<pair<char, long long int>>w;\n\tvector<pair<char, long long int>>u;\n\tchar c;\n\twhile (cin >> c, c != '$') {\n\t\tcin >> N;\n\t\tv.push_back({ c,N });\n\t}\n\twhile (cin >> c, c != '$') {\n\t\tcin >> N;\n\t\tw.push_back({ c,N });\n\t}\n\twhile (cin >> c, c != '$') {\n\t\tcin >> N;\n\t\tu.push_back({ c,N });\n\t}\n\tvector<pair<char, long long int>>ans;\n\tif (w.size() == 1) {\n\t\tbool can = true;\n\t\tfor (auto i : v) {\n\t\t\tif (can&&i.first == w.front().first&&i.second >= w.front().second) {\n\t\t\t\tcan = false;\n\t\t\t\tfor (auto j : u)push(ans, j);\n\t\t\t\tif (i.second - w.front().second) {\n\t\t\t\t\tpush(ans, { i.first,i.second - w.front().second });\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tpush(ans, i);\n\t\t\t}\n\t\t}\n\t}\n\telse{\n\t\tbool can = true;\n\t\tfor (int i = 0; i < v.size(); i++) {\n\t\t\tif (i + w.size() > v.size()) {\n\t\t\t\tpush(ans, v[i]);\n\t\t\t}\n\t\t\telse if (v[i].first != w[0].first) {\n\t\t\t\tpush(ans, v[i]);\n\t\t\t}\n\t\t\telse if (v[i].second < w[0].second) {\n\t\t\t\tpush(ans, v[i]);\n\t\t\t}\n\t\t\telse if(can){\n\t\t\t\tbool flag = true;\n\t\t\t\tfor (int j = 1; j + 1 < w.size(); j++) {\n\t\t\t\t\tif (v[i + j] != w[j])flag = false;\n\t\t\t\t}\n\t\t\t\tif (v[i + w.size() - 1].first != w.back().first)flag = false;\n\t\t\t\telse if (v[i + w.size() - 1].second < w.back().second)flag = false;\n\t\t\t\tif (!flag) {\n\t\t\t\t\tpush(ans, v[i]);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (v[i].second > w.front().second) {\n\t\t\t\t\t\tpush(ans, { v[i].first, v[i].second - w.front().second });\n\t\t\t\t\t}\n\t\t\t\t\tfor (auto j : u) {\n\t\t\t\t\t\tpush(ans, j);\n\t\t\t\t\t}\n\t\t\t\t\ti += w.size();\n\t\t\t\t\ti--;\n\t\t\t\t\tv[i].second -= w.back().second;\n\t\t\t\t\tif (v[i].second)i--;\n\t\t\t\t\tcan = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tpush(ans, v[i]);\n\t\t\t}\n\t\t}\n\t}\n\t//cout << ans.size() << endl;\n\tfor (auto i : ans) {\n\t\tcout << i.first << \" \" << i.second << \" \";\n\t}\n\tcout << \"$\\n\";\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define s second\n#define f first\n#define N 1005\nusing namespace std;\ntypedef pair<char,int> P;\nvector<P> A[3],ans;\nint len[3];\n\nint main(){\n  char c;\n  int n;\n  for(int i=0;i<3;i++){\n    while(cin>>c,c!='$')\n      cin>>n,A[i].push_back(P(c,n));\n    len[i]=A[i].size();\n  }\n  for(int i=0;i<len[0];i++){\n    if(i>len[0]-len[1]){\n      ans.push_back(A[0][i]);\n      continue;\n    }\n    int flag=0;\n    for(int j=0;j<len[1];j++){\n      int a=A[0][i+j].s,b=A[1][j].s;\n      if(A[0][i+j].f!=A[1][j].f)flag=1;\n      if(!j&&a<b)flag=1;\n      if(j&&j!=len[1]-1&&a!=b)flag=1;\n      if(j==len[1]-1&&a<b)flag=1;\n    }\n    if(!flag){\n      if(A[0][i].s>A[1][0].s)\n\tans.push_back(P(A[1][0].f,A[0][i].s-A[1][0].s));\n      for(int j=0;j<len[2];j++)\n\tans.push_back(A[2][j]);\n      A[0][i+len[1]-1].s-=A[1][len[1]-1].s;\n      i+=len[1]-2;\n    }else if(A[0][i].s)ans.push_back(A[0][i]);\n  }\n  char ch=ans[0].f;\n  int sum=ans[0].s;\n  for(int i=1;i<ans.size();i++){\n    if(ch==ans[i].f)sum+=ans[i].s;\n    else cout<<ch<<' '<<sum<<' ',ch=ans[i].f,sum=ans[i].s;\n  }\n  cout<<ch<<' '<<sum<<\" $\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-9;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\nvector<pair<char, int>>comp(vector<pair<char, int>>ps) {\n\tvector<pair<char, int>>newps;\n\tfor (int i = 0; i < ps.size(); ++i) {\n\t\tif (i==ps.size()-1||ps[i].first != ps[i + 1].first) {\n\t\t\tif (ps[i].second) {\n\t\t\t\tnewps.push_back(ps[i]);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tps[i + 1].second += ps[i].second;\n\t\t}\n\t}\n\treturn newps;\n}\nvoid input(vector<pair<char, int>>&p) {\n\twhile (1) {\n\t\tchar c; cin >> c;\n\t\tif (c == '$')break;\n\t\tint n; cin >> n;\n\t\tp.push_back(make_pair(c, n));\n\t}\n}\nint main() {\n\tvector<pair<char, int>>a, b, c;\n\tinput(a); input(b); input(c);\n\ta = comp(a); b = comp(b); c = comp(c);\n\tif (a.size() < b.size()) {\n\n\t}else\n\tif (b.size() == 1) {\n\t\tfor (int i = 0; i < a.size(); ++i) {\n\t\t\tif (a[i].first == b[0].first&&a[i].second>=b[0].second) {\n\t\t\t\ta[i].second -= b[0].second;\n\t\t\t\ta.insert(a.begin() + i, c.begin(),c.end());\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tfor (int l = 0; l <= a.size() - b.size(); ++l) {\n\t\t\tbool aok = true;\n\t\t\tif (a[l].first != b[0].first||a[l].second < b[0].second) {\n\t\t\t\taok = false;\n\t\t\t}\n\t\t\tfor (int i = 1; i < b.size() - 1; ++i) {\n\t\t\t\tif (a[l + i] != b[i]) {\n\t\t\t\t\taok = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (a[l+b.size()-1].first != b[b.size()-1].first || a[l + b.size() - 1].second < b[b.size() - 1].second) {\n\t\t\t\taok = false;\n\t\t\t}\n\t\t\tif (aok) {\n\t\t\t\ta[l].second -= b[0].second;\n\t\t\t\ta[l + b.size() - 1].second -= b[b.size() - 1].second;\n\t\t\t\ta.erase(a.begin() + l + 1, a.begin() + l + b.size() - 1);\n\t\t\t\ta.insert(a.begin() + l + 1, c.begin(), c.end());\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\ta = comp(a);\n\tfor (int i = 0; i < a.size(); ++i) {\n\t\tcout << a[i].first << \" \" << a[i].second << \" \";\n\t}\n\tcout << \"$\" << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\nusing lint = long long;\nusing ldouble = long double;\n\nvector<pair<char, int>> input() {\n    vector<pair<char, int>> ret;\n    while (true) {\n        char c;\n        cin >> c;\n        if (c == '$') break;\n        int l;\n        cin >> l;\n        ret.emplace_back(c, l);\n    }\n    return ret;\n}\n\nvoid print(vector<pair<char, int>> A) {\n    for (auto p : A) {\n        cout << p.first << \" \" << p.second << \" \";\n    }\n    cout << \"$\" << endl;\n}\n\nint main() {\n    auto A = input(), B = input(), C = input();\n\n    for (int L = 0; L + B.size() <= A.size(); ++L) {\n        bool judge = true;\n        for (int i = 0; i < B.size(); ++i) {\n            if (A[L + i].first != B[i].first) judge = false;\n        }\n\n        if (A[L].second < B[0].second) judge = false;\n        for (int i = 1; i < B.size() - 1; ++i) {\n            if (A[L + i].second != B[i].second) judge = false;\n        }\n        if (A[L + B.size() - 1].second < B[B.size() - 1].second) judge = false;\n\n        if (!judge) continue;\n\n        vector<pair<char, int>> ans;\n\n        copy(A.begin(), A.begin() + L, back_inserter(ans));\n\n        if (B.size() > 1 && A[L].second > B[0].second) {\n            ans.emplace_back(A[L].first, A[L].second - B[0].second);\n        }\n\n        copy(C.begin(), C.end(), back_inserter(ans));\n\n        if (A[L + B.size() - 1].second > B[B.size() - 1].second) {\n            ans.emplace_back(A[L + B.size() - 1].first, A[L + B.size() - 1].second - B[B.size() - 1].second);\n        }\n\n        copy(A.begin() + L + B.size(), A.end(), back_inserter(ans));\n\n        bool update = true;\n        while (update) {\n            update = false;\n\n            A.clear();\n            for (int i = 0; i < ans.size(); ++i) {\n                if (i < ans.size() - 1 && ans[i].first == ans[i + 1].first) {\n                    A.emplace_back(ans[i].first, ans[i].second + ans[i + 1].second);\n                    update = true;\n                    ++i;\n                } else {\n                    A.push_back(ans[i]);\n                }\n            }\n            ans = A;\n        }\n\n        break;\n    }\n\n    print(A);\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "//#include <bits/stdc++.h>\n#include <stdio.h>\n#include <iostream>\n#include <string.h>\n#include <math.h>\n#include <stdlib.h>\n#include <limits.h>\n#include <algorithm>\n#include <queue>\n#include <vector>\n#include <set>\n#include <map>\n#include <stack>\n#include <bitset>\n#include <string>\n#include <time.h>\nusing namespace std;\nlong double esp=1e-11;\n//#pragma comment(linker, \"/STACK:1024000000,1024000000\")\n#define fi first\n#define se second\n#define all(a) (a).begin(),(a).end()\n#define cle(a) while(!a.empty())a.pop()\n#define mem(p) memset(p,0,sizeof(p))\n#define memf(p) memset(p,0x3f,sizeof(p))\n#define memn(p) memset(p,-1,sizeof(p))\n#define mp(A, B) make_pair(A, B)\n#define pb push_back\n#define lson l , m , rt << 1\n#define rson m + 1 , r , rt << 1 | 1\ntypedef long long int LL;\nconst long double PI = acos((long double)-1);\nconst LL INF=0x3f3f3f3f3f3f3f3fll;\nconst int MOD = 1000000007;\nconst int maxn=110000;\npair<char,int> S[maxn],quS[maxn];     //quS主串\nint len,len1;\nint nx[maxn];\nint kmp_next()      //nx数?表示匹配失配后模式串跳?位置ababc-10-102\n{\n    int len,i=0,j=nx[0]=-1;\n    while(i<len)\n    {\n        while(j!=-1&&S[i]!=S[j])j=nx[j];\n        i++;j++;\n        nx[i]=(S[i]==S[j])?nx[j]:j;\n        //nx[i]=j; \t\t前i-1最大前?后? whlielen+1\n    }\n    return len;\n}\nvector<pair<char,int> >q[3],ans,ans1;\nvoid pr()\n{\n    int l=ans.size(),l1=-1;\n    ans1.clear();\n    for(int x=0;x<l;x++)\n    {                   //printf(\"%c %d \",ans[x].fi,ans[x].se);\n        if(l1>=0&&ans[x].fi==ans1[l1].fi)\n        {\n            ans1[l1].se+=ans[x].se;\n            continue;\n        }\n        ans1.pb(ans[x]);\n        l1++;\n    }\n    l=ans1.size();\n    for(int x=0;x<l;x++)\n        printf(\"%c %d \",ans1[x].fi,ans1[x].se);\n    printf(\"$\\n\");\n}\nvoid kmp()\n{\n    int i=0,j=0;\n    int n=len,m=len1;\n    int sl=q[1].size();\n    while(i<n)\n    {\n        while(j!=-1&&quS[i]!=S[j])j=nx[j];\n        i++;j++;\n        if(j>=m)\n        {\n            //ans++;\t\t//i在主串匹配的字串的后1位\n            if(i<len&&quS[i].fi==q[1][sl-1].fi&&quS[i].se>=q[1][sl-1].se&&\n               i-m-1>=0&&quS[i-m-1].fi==q[1][0].fi&&quS[i-m-1].se>=q[1][0].se)\n            {\n                ans.clear();\n                for(int x=0;x<=i-m-2;x++)\n                    ans.pb(q[0][x]);\n                if(quS[i-m-1].se>q[1][0].se)\n                    ans.pb(mp(quS[i-m-1].fi,quS[i-m-1].se-q[1][0].se));\n                int tem=q[2].size();\n                for(int x=0;x<tem;x++)\n                    ans.pb(q[2][x]);\n                if(quS[i].se>q[1][sl-1].se)\n                    ans.pb(mp(quS[i].fi,quS[i].se-q[1][sl-1].se));\n                for(int x=i+1;x<len;x++)\n                    ans.pb(q[0][x]);\n                pr();\n                return ;\n            }\n            j=nx[j];\n        }\n    }\n    for(int x=0;x<len;x++)\n        ans.pb(q[0][x]);\n    pr();\n    return;\n}\nint main()\n{\n    //freopen(\"in.txt\", \"r\", stdin);\n    //freopen(\"inlay.in\", \"r\", stdin);\n    //freopen(\"out.txt\", \"w\", stdout);\n    //map<long long int,int>ma;                 %I64d\n    //vector<int>::iterator iter;\n    //memset(m,0,sizeof(int));\n    //for(int x=1;x<=n;x++)\n    //for(int y=1;y<=n;y++)\n    //scanf(\"%d%d\",&a,&b);\n    //scanf(\"%d\",&a);\n    //printf(\"%d\\n\",ans);\n    q[0].clear();\n    q[1].clear();\n    q[2].clear();\n    ans.clear();\n    char s[10],f=0;\n    int t;\n    while(f<3)\n    {\n        scanf(\"%s\",s);\n        if(s[0]=='$'){f++;continue;}\n        scanf(\"%d\",&t);\n        q[f].pb(mp((char)s[0],t));\n    }\n    len=q[0].size();\n    if(q[1].size()==1)\n    {\n        ans.clear();\n        for(int x=0;x<len;x++)\n        {\n            if(q[0][x].fi==q[1][0].fi&&q[1][0].se<=q[0][x].se)\n            {\n                int len2=q[2].size();\n                for(int y=0;y<len2;y++)\n                    ans.pb(q[2][y]);\n                if(q[1][0].se<q[0][x].se)\n                    ans.pb(mp(q[0][x].fi,q[0][x].se-q[1][0].se));\n                for(int y=x+1;y<len;y++)\n                    ans.pb(q[0][y]);\n                break;\n            }\n            else\n                ans.pb(q[0][x]);\n        }\n        pr();\n        return 0;\n    }\n    if(q[1].size()==2)\n    {\n        ans.clear();\n        for(int x=0;x<len;x++)\n        {\n            if(x<len-1&&q[0][x].fi==q[1][0].fi&&q[1][0].se<=q[0][x].se&&q[0][x+1].fi==q[1][1].fi&&q[1][1].se<=q[0][x+1].se)\n            {\n                int len2=q[2].size();\n                if(q[1][0].se<q[0][x].se)\n                    ans.pb(mp(q[0][x].fi,q[0][x].se-q[1][0].se));\n                for(int y=0;y<len2;y++)\n                    ans.pb(q[2][y]);\n                if(q[1][1].se<q[0][x+1].se)\n                    ans.pb(mp(q[0][x+1].fi,q[0][x+1].se-q[1][1].se));\n                for(int y=x+2;y<len;y++)\n                    ans.pb(q[0][y]);\n                break;\n            }\n            else\n                ans.pb(q[0][x]);\n        }\n        pr();\n        return 0;\n    }\n    len1=q[1].size()-2;\n    for(int x=1;x<len-1;x++)\n        S[x-1]=q[1][x];\n    for(int x=0;x<len;x++)\n        quS[x]=q[0][x];\n    kmp_next();\n    kmp();\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define all(x) (x).begin(),(x).end()\nconst int mod=1000000007,MAX=203,INF=1<<30;\n\nint main(){\n    \n    std::ifstream in(\"text.txt\");\n    std::cin.rdbuf(in.rdbuf());\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    \n    vector<int> A,B,C,D,E;\n    vector<char> a,b,c,d,e;\n    \n    while(1){\n        char x;cin>>x;\n        if(x!='$'){\n            a.push_back(x);\n            int y;cin>>y;\n            A.push_back(y);\n        }else{\n            break;\n        }\n    }\n    \n    while(1){\n        char x;cin>>x;\n        if(x!='$'){\n            b.push_back(x);\n            int y;cin>>y;\n            B.push_back(y);\n        }else{\n            break;\n        }\n    }\n    \n    while(1){\n        char x;cin>>x;\n        if(x!='$'){\n            c.push_back(x);\n            int y;cin>>y;\n            C.push_back(y);\n        }else{\n            break;\n        }\n    }\n    \n    int i=0,j=0;\n    \n    while(i<A.size()&&j<B.size()){\n        if(a[i]==b[j]&&A[i]>=B[j]){\n            int ii=i+1,jj=j+1;\n            bool ok=false;\n            if(jj==B.size()){\n                for(int k=0;k<i;k++){\n                    d.push_back(a[k]);\n                    D.push_back(A[k]);\n                }\n                for(int k=0;k<C.size();k++){\n                    d.push_back(c[k]);\n                    D.push_back(C[k]);\n                }\n                if(A[i]!=B[j]){\n                    d.push_back(a[i]);\n                    D.push_back(A[i]-B[j]);\n                }\n                for(int k=ii;k<A.size();k++){\n                    d.push_back(a[k]);\n                    D.push_back(A[k]);\n                }\n                break;\n            }\n            \n            while(ii<A.size()&&jj<B.size()){\n                if(jj==B.size()-1){\n                    if(a[ii]==b[jj]&&A[ii]>=B[jj]){\n                        ok=true;\n                    }\n                    break;\n                }else{\n                    if(a[ii]==b[jj]&&A[ii]==B[jj]){\n                        ii++;\n                        jj++;\n                    }else{\n                        break;\n                    }\n                }\n            }\n            \n            if(ok){\n                for(int k=0;k<i;k++){\n                    d.push_back(a[k]);\n                    D.push_back(A[k]);\n                }\n                if(A[i]!=B[j]){\n                    d.push_back(a[i]);\n                    D.push_back(A[i]-B[j]);\n                }\n                for(int k=0;k<C.size();k++){\n                    d.push_back(c[k]);\n                    D.push_back(C[k]);\n                }\n                if(A[ii]!=B[jj]){\n                    d.push_back(a[ii]);\n                    D.push_back(A[ii]-B[jj]);\n                }\n                for(int k=ii+1;k<A.size();k++){\n                    d.push_back(a[k]);\n                    D.push_back(A[k]);\n                }\n                \n                break;\n            }else i++;\n        }else i++;\n    }\n    \n    //for(int i=0;i<D.size();i++) cout<<d[i]<<\" \"<<D[i]<<endl;\n    \n    if(D.size()==0){\n        for(int i=0;i<A.size();i++){\n            cout<<a[i]<<\" \"<<A[i]<<\" \";\n        }\n        cout<<\"$\\n\";\n    }else{\n        for(int i=0;i<D.size();i++){\n            if(e.size()&&E.size()&&e.back()==d[i]){\n                E.back()+=D[i];\n            }else{\n                e.push_back(d[i]);\n                E.push_back(D[i]);\n            }\n        }\n        \n        for(int i=0;i<E.size();i++){\n            cout<<e[i]<<\" \"<<E[i]<<\" \";\n        }\n        cout<<\"$\\n\";\n    }\n    \n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\nint main(){\n  vector <P> a,b,c;\n  ll i,j,k;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    a.push_back(P(ch,k));\n  }\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    b.push_back(P(ch,k));\n  }\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    c.push_back(P(ch,k));\n  }\n  for(i=0;i+b.size()<=a.size();i++){\n    if(a[i].first!=b[0].first||a[i].second<b[0].second) continue;\n    bool f = true;\n    k=b.size()-1;\n    for(j=1;j<k;j++){\n      if(a[i+j].first!=b[j].first||a[i+j].second!=b[j].second) {\n\tf=false;\n\tbreak;\n      }\n    }\n    if(a[i+k].first!=b[k].first||a[i+k].second<b[k].second) continue;\n    if(f){\n      //cout << i << endl;\n      for(j=0;j<k+1;j++){\n\ta[i+j].second-=b[j].second;\n      }\n      a.insert(a.begin()+i+1,c.begin(),c.end());\n      i+=b.size()+c.size();\n      //break;\n    }\n  }\n\n\n  bool ff=true;\n  while(ff){\n    ff=false;\n    k=0;\n    while(k<a.size()){\n      if(a[k].second==0) {\n\ta.erase(a.begin()+k);\n\tff=true;\n      }else k++;\n    }\n    for(i=0;i<a.size()-1;i++){\n      if(a[i].first==a[i+1].first){\n\ta[i+1].second+=a[i].second;\n\ta[i].second=0;\n      }\n    }\n  }\n  \n  for(i=0;i<a.size();i++){\n    if(a[i].second==0) continue;\n    cout << a[i].first << \" \" << a[i].second << \" \";\n  }\n  cout << \"$\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\n\nstruct Node{\n\tchar ch;\n\tint length;\n\tNode* prev;\n\tNode* next;\n};\n\nstruct Info{\n\tvoid set(char arg_ch,int arg_length){\n\t\tch = arg_ch;\n\t\tlength = arg_length;\n\t}\n\tchar ch;\n\tint length;\n\tbool isFirst,isLast;\n};\n\nInfo A[3000],B[3000],C[3000];\nint a_len = 0,b_len = 0,c_len = 0;\n\nclass List{\npublic:\n\tList(){\n\t\tmotherNode = new Node();\n\t\tmotherNode->ch = '#';\n\t\tmotherNode->length = -1;\n\t\tmotherNode->prev = motherNode;\n\t\tmotherNode->next = motherNode;\n\t\tmatchFirstNode = motherNode;\n\t\tmatchLastNode = motherNode;\n\t\tleft_complete_match = false;\n\t\tright_complete_match = false;\n\t};\n\tvoid registA(Info info){\n\n\t\tNode* tmpNode = motherNode->prev;\n\t\tmotherNode->prev = new Node;\n\t\tmotherNode->prev->ch = info.ch;\n\t\tmotherNode->prev->length = info.length;\n\t\tmotherNode->prev->next = motherNode;\n\t\tmotherNode->prev->prev = tmpNode;\n\t\ttmpNode->next = motherNode->prev;\n\t};\n\n\tbool isMatchB(){\n\n\t\tbool FLG;\n\t\tint index;\n\n\t\tNode* startNode = motherNode;\n\t\tNode* tmpNode;\n\n\t\twhile(true){\n\t\t\tstartNode = startNode->next;\n\t\t\tif(startNode == motherNode)break;\n\n\t\t\ttmpNode = startNode;\n\n\t\t\tindex = 0;\n\n\t\t\tFLG = true;\n\n\t\t\twhile(tmpNode != motherNode){\n\t\t\t\tif(tmpNode->ch != B[index].ch){\n\t\t\t\t\tFLG = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}else{\n\n\t\t\t\t\tif(B[index].isFirst == false && B[index].isLast == false){\n\t\t\t\t\t\tif(tmpNode->length != B[index].length){\n\t\t\t\t\t\t\tFLG = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmpNode = tmpNode->next;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(tmpNode->length >= B[index].length){\n\t\t\t\t\t\t\ttmpNode = tmpNode->next;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tFLG = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(index == b_len)break;\n\t\t\t}\n\n\t\t\tif(FLG == true && index == b_len){\n\n\t\t\t\tif(startNode->length == B[0].length){\n\t\t\t\t\tmatchFirstNode = startNode->prev;\n\t\t\t\t\tleft_complete_match = true;\n\t\t\t\t}else{\n\t\t\t\t\tmatchFirstNode = startNode;\n\t\t\t\t}\n\n\t\t\t\ttmpNode = tmpNode->prev;\n\t\t\t\tif(tmpNode->length == B[b_len-1].length){\n\t\t\t\t\tmatchLastNode = tmpNode->next;\n\t\t\t\t\tright_complete_match = true;\n\t\t\t\t}else{\n\t\t\t\t\tmatchLastNode = tmpNode;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tvoid replace(){\n\n\t\tNode* tmpNode,*preNode,*firstNext;\n\t\tint index;\n\n\t\tfirstNext = matchFirstNode->next;\n\n\t\tif(left_complete_match){\n\t\t\tif(matchFirstNode->ch == C[0].ch){\n\t\t\t\tmatchFirstNode->length += C[0].length;\n\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\tindex = 1;\n\t\t\t}else{\n\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\tindex = 0;\n\t\t\t}\n\t\t}else{\n\n\t\t\tif(b_len > 1){\n\t\t\t\tif(matchFirstNode->ch != C[0].ch){\n\t\t\t\t\tmatchFirstNode->length -= B[0].length;\n\t\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\t\tindex = 0;\n\t\t\t\t}else{\n\t\t\t\t\tmatchFirstNode->length = matchFirstNode->length - B[0].length + C[0].length;\n\t\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\t\tindex = 1;\n\t\t\t\t}\n\t\t\t}else{\n\n\t\t\t\tfirstNext->prev = new Node;\n\t\t\t\tfirstNext->prev->next = firstNext;\n\t\t\t\tfirstNext->prev->ch = matchFirstNode->ch;\n\t\t\t\tfirstNext->prev->length = matchFirstNode->length - B[0].length;\n\t\t\t\tfirstNext = firstNext->prev;\n\t\t\t\tfirstNext->prev = matchFirstNode;\n\t\t\t\ttmpNode = matchFirstNode;\n\t\t\t}\n\t\t}\n\n\t\tpreNode = matchFirstNode;\n\n\t\tif(index == c_len){\n\t\t\tif(right_complete_match){\n\t\t\t\tif(matchLastNode->ch != C[0].ch){\n\t\t\t\t\tmatchFirstNode->next = matchLastNode;\n\t\t\t\t\tmatchLastNode->prev = matchFirstNode;\n\t\t\t\t}else{\n\t\t\t\t\tmatchFirstNode->length += matchLastNode->length;\n\t\t\t\t\tmatchFirstNode->next = matchLastNode->next;\n\t\t\t\t\tmatchLastNode->next->prev = matchFirstNode;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(matchFirstNode != matchLastNode){\n\t\t\t\t\tif(matchLastNode->ch != C[0].ch){\n\t\t\t\t\t\tmatchFirstNode->next = matchLastNode;\n\t\t\t\t\t\tmatchLastNode->prev = matchFirstNode;\n\t\t\t\t\t\tmatchLastNode->length -= B[b_len-1].length;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tmatchFirstNode->length += matchLastNode->length - B[b_len-1].length;\n\t\t\t\t\t\tmatchFirstNode->next = matchLastNode->next;\n\t\t\t\t\t\tmatchLastNode->next->prev = matchFirstNode;\n\t\t\t\t\t}\n\t\t\t\t}else{ //matchFirstNode == matchLastNode\n\n\t\t\t\t\tif(b_len == 1){ //c_len == 1\n\t\t\t\t\t\tif(firstNext->ch != C[0].ch){\n\t\t\t\t\t\t\tmatchFirstNode->ch = C[0].ch;\n\t\t\t\t\t\t\tmatchFirstNode->length = C[0].length;\n\t\t\t\t\t\t\tmatchFirstNode->next = firstNext;\n\t\t\t\t\t\t}else{ //firstNext.ch == C[0].ch\n\t\t\t\t\t\t\tmatchFirstNode->ch = C[0].ch;\n\t\t\t\t\t\t\tmatchFirstNode->length = C[0].length + firstNext->length;\n\t\t\t\t\t\t\tmatchFirstNode->next = firstNext->next;\n\t\t\t\t\t\t\tfirstNext->next->prev = matchFirstNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{ //b_len != 1\n\t\t\t\t\t\t//Do nothing\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\twhile(index < c_len){\n\t\t\tif(index != c_len - 1){\n\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\tpreNode = tmpNode;\n\t\t\t\ttmpNode->next = new Node;\n\t\t\t\ttmpNode = tmpNode->next;\n\t\t\t\tindex++;\n\t\t\t}else{\n\t\t\t\tif(right_complete_match){\n\t\t\t\t\tif(matchLastNode->ch != C[index].ch){\n\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\ttmpNode->next = matchLastNode;\n\t\t\t\t\t\tmatchLastNode->prev = tmpNode;\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}else{\n\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\ttmpNode->length = C[index].length + matchLastNode->length;\n\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\ttmpNode->next = matchLastNode->next;\n\t\t\t\t\t\tmatchLastNode->next->prev = tmpNode;\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\n\t\t\t\t\tif(matchFirstNode != matchLastNode){\n\t\t\t\t\t\tif(matchLastNode->ch != C[index].ch){\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = matchLastNode;\n\t\t\t\t\t\t\tmatchLastNode->length -= B[b_len-1].length;\n\t\t\t\t\t\t\tmatchLastNode->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = matchLastNode->length-B[b_len-1].length + C[index].length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = matchLastNode->next;\n\t\t\t\t\t\t\tmatchLastNode->next->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\n\t\t\t\t\t\tif(firstNext->ch != C[index].ch){\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = firstNext;\n\t\t\t\t\t\t\tfirstNext->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = C[index].length + firstNext->length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = firstNext->next;\n\t\t\t\t\t\t\tfirstNext->next->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tvoid output(){\n\n\t\tNode* tmpNode = motherNode->next;\n\t\twhile(tmpNode != motherNode){\n\t\t\tprintf(\"%c %d \",tmpNode->ch,tmpNode->length);\n\t\t\ttmpNode = tmpNode->next;\n\t\t}\n\n\t\tprintf(\"$\\n\");\n\t}\n\nprivate:\n\tNode* motherNode,*matchFirstNode,*matchLastNode;\n\tbool left_complete_match,right_complete_match;\n};\n\n\n\nint main(){\n\n\tList list;\n\n\tchar buf[2];\n\tint num;\n\tInfo tmp;\n\n\twhile(true){\n\t\tscanf(\"%s\",buf);\n\t\tif(buf[0] == '$')break;\n\n\t\tscanf(\"%d\",&num);\n\n\t\ttmp.set(buf[0],num);\n\t\tA[a_len++].set(buf[0],num);\n\n\t\tlist.registA(tmp);\n\t}\n\n\tfor(int i = 0; i < 3000; i++){\n\t\tB[i].isFirst = false;\n\t\tB[i].isLast = false;\n\t}\n\n\twhile(true){\n\t\tscanf(\"%s\",buf);\n\t\tif(buf[0] == '$')break;\n\n\t\tscanf(\"%d\",&num);\n\n\t\tB[b_len++].set(buf[0],num);\n\t}\n\n\tB[0].isFirst = true;\n\tB[b_len-1].isLast = true;\n\n\tif(!list.isMatchB()){\n\n\t\tfor(int i = 0; i < a_len; i++){\n\t\t\tprintf(\"%c %d \",A[i].ch,A[i].length);\n\t\t}\n\t\tprintf(\"$\\n\");\n\t\treturn 0;\n\t}\n\n\twhile(true){\n\t\tscanf(\"%s\",buf);\n\t\tif(buf[0] == '$')break;\n\n\t\tscanf(\"%d\",&num);\n\n\t\tC[c_len++].set(buf[0],num);\n\t}\n\n\tlist.replace();\n\n\tlist.output();\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define fi first\n#define se second\nusing namespace std;\ntypedef pair<string,int> P;\nvector<P>v1,v2,v3;\nint x;\nstring s;\nmain(){\n  while(cin>>s,s!=\"$\")cin>>x,v1.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v2.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v3.push_back(P(s,x));\n  r(i,v1.size())if(v1[i].fi==v2[0].fi&&v1[i].se>=v2[0].se){\n    int flag=0,jj=0,ff=0;\n    r(j,(int)v2.size()-2){\n      jj=j+1;\n      if(i+jj>=v1.size()){flag++;break;}\n      if(v2[jj].se!=v1[i+jj].se||v2[jj].fi!=v1[i+jj].fi)flag++;\n    }\n    if(v2.size()==2&&(v2[1].fi!=v1[i+1].fi||v2[1].se>v1[i+1].se))flag++;\n    if(v2.size()!=1){\n      jj++;\n      if(!flag&&v2[jj].fi==v1[i+jj].fi&&v2[jj].se<=v1[i+jj].se){\n        v1[i].se-=v2[0].se;\n        r(j,v2.size()-2)v1.erase(v1.begin()+i+1);\n        v1[i+1].se-=v2[v2.size()-1].se;\n        r(j,v3.size())v1.insert(v1.begin()+i+1,v3[(int)v3.size()-1-j]);\n      }\n      if(flag)goto L;\n      ff++;\n    }\n    else{\n      if(flag)goto L;\n      v1[i].se-=v2[0].se;\n      r(j,v3.size())v1.insert(v1.begin()+i,v3[(int)v3.size()-1-j]);\n      ff++;\n    }\n    r(j,v1.size())if(v1[j].se==0)v1.erase(v1.begin()+j);\n    r(j,(int)v1.size()-1)if(v1[j].fi==v1[j+1].fi)\n      v1[j].se+=v1[j+1].se,v1.erase(v1.begin()+j+1),j--;\n    r(j,v3.size())i++;\n    if(ff)break;\n    L:;\n  }\n  r(k,v1.size())cout<<v1[k].fi<<' '<<v1[k].se<<' ';\n  cout<<'$'<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=long long;\nstruct RLEchar{\n    char x;\n    ll len;\n};\n\nusing RLE=vector<RLEchar>;\nistream& operator>>(istream& in,RLE& rle){\n    char c;\n    while(cin>>c,c!='$'){\n        int l; cin>>l;\n        rle.push_back(RLEchar{c,l});\n    }\n    return in;\n}\nostream& operator<<(ostream& out,RLE rle){\n    for(int i=0;i<rle.size();i++){\n        out<<rle[i].x<<\" \"<<rle[i].len<<\" \";\n    }\n    out<<\"$\";\n    return out;\n}\n\nvoid shrink(RLE &rle){\n    RLE res;\n    for(int i=0;i<rle.size();i++){\n        if(rle[i].len==0) continue;\n        else if(res.size()==0 || res.back().x!=rle[i].x) res.push_back(rle[i]);\n        else res.back().len+=rle[i].len;\n    }\n    rle=res;\n}\n\nvoid replace(RLE& a,RLE b,RLE c){\n    for(int i=0;i+b.size()<=a.size();i++){\n        if(b.size()==1){\n            if(a[i].x==b[0].x && a[i].len>=b[0].len){\n                RLE tmp;\n                for(int j=0;j<i;j++){\n                    tmp.push_back(a[j]);\n                }\n                for(int j=0;j<c.size();j++) tmp.push_back(c[j]);\n                tmp.push_back(RLEchar{a[i].x,a[i].len-b[0].len});\n                for(int j=i+1;j<a.size();j++){\n                    tmp.push_back(a[j]);\n                }\n                a=tmp;\n                break;\n            }\n        }\n        else{\n            bool isok=(a[i].x==b[0].x && a[i].len>=b[0].len);\n            for(int j=1;j+1<b.size();j++){\n                isok&=(a[i+j].x==b[j].x && a[i+j].len==b[j].len);\n            }\n            isok&=(a[i+b.size()-1].x==b.back().x && a[i+b.size()-1].len>=b.back().len);\n            if(isok){\n                RLE tmp;\n                for(int j=0;j<i;j++){\n                    tmp.push_back(a[j]);\n                }\n                tmp.push_back(RLEchar{a[i].x,a[i].len-b[0].len});\n                for(int j=0;j<c.size();j++) tmp.push_back(c[j]);\n                tmp.push_back(RLEchar{a[i+b.size()-1].x,a[i+b.size()-1].len-b.back().len});\n                for(int j=i+b.size();j<a.size();j++){\n                    tmp.push_back(a[j]);\n                }\n                a=tmp;\n                break;\n            }\n        }\n    }\n    shrink(a);\n}\n\nint main(){\n    RLE a,b,c;\n    cin>>a>>b>>c;\n    replace(a,b,c);\n    cout<<a<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\n//const int INF = 1e8;\nusing namespace std;\n\n#define int long long\n\nstruct Data{\n\tchar c;\n\tint n;\n\tData(char c, int n) : c(c), n(n) {}\n};\n\nvoid parser(list<Data>& a){\n\tchar chr;\n\tint num;\n\twhile(cin >> chr, chr != '$'){\n\t\tcin >> num;\n\t\ta.emplace_back(chr, num);\n\t}\n}\n\nlist<Data> a, b, c;\n\nbool canReplace(list<Data>::iterator it){\n\tint idx = 0;\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n\tfor(auto i = it, j = b.begin(); j != b.end(); i++, j++, idx++){\n\t\tif(i->c != j->c) return false;\n\t\tif(idx == 0 or idx == b.size() - 1){\n\t\t\tif(i->n < j->n) return false;\n\t\t}else{\n\t\t\tif(i->n != j->n) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\n\nvoid replaceList(list<Data>::iterator& it){\n\trep(i,b.size()){\n\t\tif(i == 0){\n\t\t\tit->n -= (*b.begin()).n;\n\t\t\tif(it->n == 0) it = a.erase(it);\n\t\t\telse it++;\n\t\t}else if(i == b.size() - 1){\n\t\t\tit->n -= (*--b.end()).n;\n\t\t\tif(it->n == 0) it = a.erase(it);\n\t\t}else{\n\t\t\tit = a.erase(it);\n\t\t}\n\t}\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n\t//for(auto i : c){ cout << i.c; } cout << endl;\n\tfor(auto i : c){\n\t\ta.insert(it,i);\n\t}\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n}\n\nbool check(){\n\tint idx = 0;\n\tbool f = false;\n\tfor(auto it = a.begin(); idx + b.size() <= a.size(); it++, idx++){\n\t\tif(canReplace(it)){\n\t\t\treplaceList(it);\n\t\t\tf = true;\n\t\t}\n\t}\n\treturn f;\n}\n\nvoid compress(){\n\tauto it = a.begin();\n\twhile(it != a.end()){\n\t\tif(it->c == next(it, 1)->c){\n\t\t\tit->n += next(it, 1)->n;\n\t\t\ta.erase(next(it,1));\n\t\t}else if(it->n == 0){\n\t\t\tit = a.erase(it);\n\t\t}else{\n\t\t\tit++;\n\t\t}\n\t}\n}\n\nbool comp(){\n\n\tint idx = 0;\n\tfor(auto i = a.begin(), j = b.begin(); i != a.end(); i++, j++, idx++){\n\t\tif(i->c != j->c or i->n != j->n){\n\t\t\tshow(idx)\n\t\tcout << i->c << ' ' << j->c << endl;\n\t\tcout << i->n << ' ' << j->n << endl;\n return true;\n\t\t}\n\t}\n\treturn false;\n}\n\nsigned main(){\n\tparser(a);\n\tparser(b);\n\tparser(c);\n\n\n\twhile(true){\n\t\tcompress();\n\t\tif(check() == false) break;\n\t}\n\t\n\tfor(auto i : a){\n\t\tcout << i.c << ' ' << i.n << ' ';\n\t}\n\tcout << '$' << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\ntypedef pair<char, int> pci;\n\nint main()\n{\n\tvector<pci> a, b, c;\n\tchar let; int n;\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\ta.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tb.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tc.emplace_back(let, n);\n\t}\n\tvector<pci> res;\n\t\n\tREP(i, (int)a.size() - (int)b.size() + 1)\n\t{\n\t\tif (a[i].first == b[0].first&&a[i].second >= b[0].second)\n\t\t{\n\t\t\tbool f = true;\n\t\t\tint j;\n\t\t\tfor (j = 1; j < b.size(); j++)\n\t\t\t{\n\t\t\t\tif (j == b.size() - 1)\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second >= a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second != a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (f)\n\t\t\t{\n\n\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\tif (a[i].second > b[i].second) res.emplace_back(a[i].first, a[i].second - b[i].second);\n\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\tif (a[i + b.size() - 1].second > b.back().second) res.emplace_back(b.back().first, a[i + b.size() - 1].second - b.back().second);\n\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\ti = INF;\n\t\t\t}\n\t\t}\n\t}\n\tvector<pci> ans;\n\tif (res.size() == 0) ans = a;\n\telse\n\t{\n\t\tans.emplace_back(res[0]);\n\t\tFOR(i, 1, res.size())\n\t\t{\n\t\t\tif (res[i].first == ans.back().first) ans.back().second += res[i].second;\n\t\t\telse ans.emplace_back(res[i]);\n\t\t}\n\t}\n\tREP(i, ans.size()) cout << ans[i].first << \" \" << ans[i].second << (i == ans.size() - 1 ? \" $\\n\" : \" \");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\n\nvector<P>A,B,C;\nvoid input(vector<P> &a){\n  int num;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin>>num;\n    a.push_back(P(ch,num));\n  }\n}\n\nbool check(int i){\n  int n = A.size();\n  int m = B.size();\n  if(i+m>n) return 0;\n  if(A[i].first!=B[0].first||A[i].second<B[0].second)return 0;\n  if(m == 1) return 1;\n\n  i++;\n  for(int j=1;i<m-1;j++,i++)\n    if(A[i].first!=B[j].first||A[i].second!=B[j].second)return 0;\n  \n  if(A[i].first!=B[m-1].first||A[i].second<B[m-1].second)return 0;\n  return 1;\n}\n\nvoid mergePush(vector<P> &res,P a){\n  int c = a.second;\n  char ch = a.first;\n  if(c == 0)return;\n  if(res.size() && res.back().first == ch)res.back().second+=c;\n  else res.push_back(P(ch,c));\n}\n\nvector<P> solve(){\n  vector<P> res;\n  int n = A.size();\n  int m = B.size();\n  int l = C.size();\n  int flg = 0;\n  for(int i=0;i<n;i++){\n    if(!check(i)||flg++){mergePush(res,A[i]);continue;}\n    A[i].second -= B[0].second;\n    if(m == 1){\n      for(int j=0;j<l;j++) mergePush(res,C[j]);\n    }\n    else {\n      mergePush(res,P(A[i].first,A[i].second));   \n      for(int j=0;j<l;j++) mergePush(res,C[j]);\n      A[i+m-1].second -= B.back().second;\n    }\n    i+=m-2;\n  }\n  return res;\n}\n\n\nint main(){\n  input(A),input(B),input(C);\n  vector<P> ans = solve();\n  for(P a:ans) cout<<a.first<<\" \"<<a.second<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\n#include<vector>\nusing namespace std;\nvector<pair<char,int> >A;\nvector<pair<char,int> >B;\nvector<pair<char,int> >C;\nvector<pair<char,int> >res;\nvoid out(){\n\tint tmp=0;\n\tfor(int i=0;i<res.size();i++){\n\t\tif(i+1==res.size()||res[i].first!=res[i+1].first){\n\t\t\tprintf(\"%c %d \",res[i].first,tmp+res[i].second);\n\t\t\ttmp=0;\n\t\t}else{\n\t\t\ttmp+=res[i].second;\n\t\t}\n\t}\n\tprintf(\"$\\n\");\n}\nchar in[2];\nint main(){\n\twhile(1){\n\t\tscanf(\"%s\",in);if(in[0]=='$')break;\n\t\tint p;scanf(\"%d\",&p);\n\t\tA.push_back(make_pair(in[0],p));\n\t}\n\twhile(1){\n\t\tscanf(\"%s\",in);if(in[0]=='$')break;\n\t\tint p;scanf(\"%d\",&p);\n\t\tB.push_back(make_pair(in[0],p));\n\t}\n\twhile(1){\n\t\tscanf(\"%s\",in);if(in[0]=='$')break;\n\t\tint p;scanf(\"%d\",&p);\n\t\tC.push_back(make_pair(in[0],p));\n\t}\n\tfor(int i=0;i+B.size()<=A.size();i++){\n\t\tbool ok=true;\n\t\tfor(int j=0;j<B.size();j++){\n\t\t\tif(A[i+j].first!=B[j].first)ok=false;\n\t\t\tif(j+1<B.size()&&A[i+j].second!=B[j].second)ok=false;\n\t\t\tif(A[i+j].second<B[j].second)ok=false;\n\t\t}\n\t\tif(ok){\n\t\t\tfor(int j=0;j<i;j++)res.push_back(A[j]);\n\t\t\tfor(int j=0;j<C.size();j++)res.push_back(C[j]);\n\t\t\tif(A[i+B.size()-1].second!=B[B.size()-1].second)res.push_back(make_pair(A[i+B.size()-1].first,A[i+B.size()-1].second-B[B.size()-1].second));\n\t\t\tfor(int j=i+B.size();j<A.size();j++)res.push_back(A[j]);\n\t\t\tout();\n\t\t\treturn 0;\n\t\t}\n\t\tok=true;\n\t\tfor(int j=0;j<B.size();j++){\n\t\t\tif(A[i+j].first!=B[j].first)ok=false;\n\t\t\tif(j&&j+1<B.size()&&A[i+j].second!=B[j].second)ok=false;\n\t\t\tif(A[i+j].second<B[j].second)ok=false;\n\t\t}\n\t\tif(ok){\n\t\t\tfor(int j=0;j<i;j++)res.push_back(A[j]);\n\t\t\tif(A[i].second!=B[0].second)res.push_back(make_pair(A[i].first,A[i].second-B[0].second));\n\t\t\tfor(int j=0;j<C.size();j++)res.push_back(C[j]);\n\t\t\tif(A[i+B.size()-1].second!=B[B.size()-1].second)res.push_back(make_pair(A[i+B.size()-1].first,A[i+B.size()-1].second-B[B.size()-1].second));\n\t\t\tfor(int j=i+B.size();j<A.size();j++)res.push_back(A[j]);\n\t\t\tout();\n\t\t\treturn 0;\n\t\t}\n\t}\n\tfor(int i=0;i<A.size();i++)printf(\"%c %d \",A[i].first,A[i].second);\n\tprintf(\"$\\n\");\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\nusing namespace std;\nvector<pair<char,int> >a[5];\nint main(){\n\tfor(int i=0;i<3;i++){\n\t\twhile(true){\n\t\t\tchar C;int P;\n\t\t\tcin>>C;if(C=='$')break;\n\t\t\tcin>>P;a[i].push_back(make_pair(C,P));\n\t\t}\n\t}\n\tfor(int i=0;i<=a[0].size()-a[1].size();i++){\n\t\tif(a[0][i].first!=a[1][0].first)continue;\n\t\tif(a[0][i].second<a[1][0].second)continue;\n\t\tint OK=0;\n\t\tfor(int j=1;j<a[1].size();j++){\n\t\t\tif(j!=a[1].size()-1){\n\t\t\t\tif(a[0][i+j].first!=a[1][j].first)OK=1;\n\t\t\t\tif(a[0][i+j].second!=a[1][j].second)OK=1;\n\t\t\t}\n\t\t\tif(j==a[1].size()-1){\n\t\t\t\tif(a[0][i+j].first!=a[1][j].first)OK=1;\n\t\t\t\tif(a[0][i+j].second<a[1][j].second)OK=1;\n\t\t\t}\n\t\t}\n\t\tif(OK==0){\n\t\t\t//start\n\t\t\tfor(int j=0;j<i;j++)a[3].push_back(a[0][j]);\n\t\t\t//second\n\t\t\tif(a[1].size()>=2){\n\t\t\t\ta[3].push_back(make_pair(a[0][i].first,a[0][i].second-a[1][0].second));\n\t\t\t}\n\t\t\t//third\n\t\t\tfor(int j=0;j<a[2].size();j++)a[3].push_back(a[2][j]);\n\t\t\t//fourth\n\t\t\tint num=a[0][i+a[1].size()-1].second-a[1][a[1].size()-1].second;\n\t\t\ta[3].push_back(make_pair(a[1][a[1].size()-1].first,num));\n\t\t\t//fifth\n\t\t\tfor(int j=i+a[1].size();j<a[0].size();j++)a[3].push_back(a[0][j]);\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor(int i=0;i<a[3].size();i++){\n\t\tif(a[3][i].second==0)continue;\n\t\tif(a[4].size()==0)a[4].push_back(a[3][i]);\n\t\telse{\n\t\t\tif(a[3][i].second==0)continue;\n\t\t\tif(a[4][a[4].size()-1].first==a[3][i].first){\n\t\t\t\ta[4][a[4].size()-1].second+=a[3][i].second;\n\t\t\t}\n\t\t\telse{a[4].push_back(a[3][i]);}\n\t\t}\n\t}\n\tfor(int i=0;i<a[4].size();i++){\n\t\tcout<<a[4][i].first<<' '<<a[4][i].second<<' ';\n\t}\n\tcout<<\"$\"<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <sstream>\n\nusing namespace std;\n\nusing Array = basic_string<pair<char, int>>;\nArray a, b, c;\n\nvoid input(Array &a) {\n    string c; int l;\n    while (cin >> c, c[0] != '$') {\n        cin >> l;\n        a += make_pair(c[0], l);\n    }\n}\n\nostream &operator << (ostream &os, basic_string<pair<char, int>> xs){\n    for(auto &x : xs){\n        os << '[' << x.first << ' ' << x.second << ']';\n    }\n    return os;\n}\n\nint main() {\n    input(a);\n    input(b);\n    input(c);\n    a = make_pair('0', 0) + a + make_pair('0', 0);\n    // cout << a << endl;\n    // cout << b << endl;\n    // cout << c << endl;\n    if (b.size() == 1) {\n        for (int i = 0; i < a.size(); ++i) {\n            if (a[i].first == b[0].first && a[i].second >= b[0].second) {\n                a[i].second -= b[0].second;\n                a = a.substr(0, i) + c + a.substr(i);\n                break;\n            }\n        }\n    } else {\n        for (int i = 1; i + b.size() - 2 <= a.size(); ++i) {\n            if (b.substr(1, b.size() - 2) == a.substr(i, b.size() - 2)) {\n                if (a[i - 1].first == b[0].first && a[i - 1].second >= b[0].second &&\n                    a[i + b.size() - 2].first == b.back().first && a[i + b.size() - 2].second >= b.back().second) {\n                    // cout << i << endl;\n                    a[i - 1].second -= b[0].second;\n                    a[i + b.size() - 2].second -= b.back().second;\n                    a = a.substr(0, i) + c + a.substr(i + b.size() - 2);\n                    break;\n                }\n            }\n        }\n    }\n    for (int i = 1; i < a.size(); ++i) {\n        if (a[i].first == a[i - 1].first) {\n            a[i].second += a[i - 1].second;\n            a[i - 1].second = 0;\n        }\n    }\n    for (int i = 0; i < a.size(); ++i) {\n        if(a[i].second){\n            cout << a[i].first << ' ' << a[i].second << ' ';\n        }\n    }\n    cout << '$' << endl;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include<iostream>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<cstdio>\nusing namespace std;\ntypedef long long ll;\nconst int MAXN = 4e3 + 10;\nchar s1[MAXN], s2[MAXN], s3[MAXN], tmp[3], ans[MAXN];\nll l1[MAXN], l2[MAXN], l3[MAXN], al[MAXN];\nint t1, t2, t3, t4;\nvoid addword(char* s, ll* l, int& tt, char c, ll tn){\n\tif (tt == 0 || s[tt - 1] != c){\n\t\ts[tt] = c;\n\t\tl[tt] = tn;\n\t\t++tt;\n\t}\n\telse{\n\t\tl[tt - 1] += tn;\n\t}\n}\nint main(){\n\tt1 = t2 = t3 = t4 = 0;\n\twhile (cin >> tmp&&tmp[0] != '$'){\n\t\tll tttt;\n\t\tcin >> tttt;\n\t\taddword(s1, l1, t1, tmp[0], tttt);\n\t}\n\twhile (cin >> tmp&&tmp[0] != '$'){\n\t\tll tttt;\n\t\tcin >> tttt;\n\t\taddword(s2, l2, t2, tmp[0], tttt);\n\t}\n\twhile (cin >> tmp&&tmp[0] != '$'){\n\t\tll tttt;\n\t\tcin >> tttt;\n\t\taddword(s3, l3, t3, tmp[0], tttt);\n\t}\n\tif (t2 == 0){\n\t\twhile (true);\n\t\tfor (int i = 0; i < t3; ++i){\n\t\t\taddword(ans, al, t4, s3[i], l3[i]);\n\t\t}\n\t\tfor (int i = 0; i < t1; ++i){\n\t\t\taddword(ans, al, t4, s1[i], l1[i]);\n\t\t}\n\t}\n\tfor (int i = 0; i < t1&&t2; ++i){\n\t\tbool ff = true;\n\t\tfor (int j = 0; j < t2; ++j){\n\t\t\tint ti = i + j;\n\t\t\tif (s1[ti] != s2[j] || ((j == 0 && j == t2 - 1) && l1[ti] < l2[j]) || (j != 0 && j != t2 - 1 && l1[ti] != l2[j])){\n\t\t\t\tff = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (ff){\n\t\t\tif (t2 == 1){\n\t\t\t\tfor (int j = 0; j < t3; ++j){\n\t\t\t\t\taddword(ans, al, t4, s3[j], l3[j]);\n\t\t\t\t}\n\t\t\t\tif (l1[i] - l2[0] > 0)\n\t\t\t\t\taddword(ans, al, t4, s1[i], l1[i] - l2[0]);\n\t\t\t\tfor (int j = i + t2; j < t1; ++j){\n\t\t\t\t\taddword(ans, al, t4, s1[j], l1[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif (l1[i] - l2[0] > 0)\n\t\t\t\t\taddword(ans, al, t4, s1[i], l1[i] - l2[0]);\n\t\t\t\tfor (int j = 0; j < t3; ++j){\n\t\t\t\t\taddword(ans, al, t4, s3[j], l3[j]);\n\t\t\t\t}\n\t\t\t\tif (l1[i + t2 - 1] - l2[t2 - 1]>0)\n\t\t\t\t\taddword(ans, al, t4, s1[i + t2 - 1], l1[i + t2 - 1] - l2[t2 - 1]);\n\t\t\t\tfor (int j = i + t2; j < t1; ++j){\n\t\t\t\t\taddword(ans, al, t4, s1[j], l1[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\taddword(ans, al, t4, s1[i], l1[i]);\n\t}\n\tfor (int i = 0; i < t4; ++i){\n\t\tcout << ans[i] << \" \" << al[i] << \" \";\n\t}\n\tcout << \"$\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<char, ll> P;\n\nint main()\n{\n    ll len[3];\n    vector<P> X[3];\n    for (ll i = 0; i < 3; i++) {\n        char c;\n        ll l;\n        while (cin >> c, c != '$') {\n            cin >> l;\n            X[i].push_back(P(c, l));\n        }\n        len[i] = X[i].size();\n    }\n    for (ll i = 0; i < len[0]; i++) {\n        if (i+len[1] > len[0]) {\n            continue;\n        }\n        bool same = 1;\n        for (ll j = i; j < i+len[1]; j++) {\n            if (X[1][j-i].first != X[0][j].first) {\n                same = 0;\n                break;\n            }\n        }\n        bool update = 1;\n        if (same) {\n            for (ll j = i+1; j < i+len[1]-1; j++) {\n                if (X[1][j-i].second != X[0][j].second) {\n                    update = 0;\n                    break;\n                }\n            }\n            vector<P> v, res;\n            for (ll j = 0; j < i; j++) {\n                v.push_back(X[0][j]);\n            }\n            ll diff = X[0][i].second - X[1][0].second;\n            if (diff > 0 && i != len[1]-1) {\n                v.push_back(P(X[0][i].first, diff));\n            }\n            for (ll j = 0; j < len[2]; j++) {\n                v.push_back(X[2][j]);\n            }\n            diff = X[0][i+len[1]-1].second - X[1][len[1]-1].second;\n            if (diff > 0) {\n                v.push_back(P(X[0][i+len[1]-1].first, diff));\n            }\n            for (ll j = i+len[1]; j < len[0]; j++) {\n                v.push_back(X[0][j]);\n            }            \n\n            for (ll j = 0; j < (ll)v.size(); ) {\n                ll k = j, sum = 0;\n                while (k < (ll)v.size() &&\n                       v[j].first == v[k].first) {\n                    sum += v[k].second;\n                    k++;\n                }\n                res.push_back(P(v[j].first, sum));\n                j = k;\n            }\n            \n            for (ll j = 0; j < (ll)res.size(); j++) {\n                cout << res[j].first << \" \" << res[j].second << \" \";\n            }\n            cout << \"$\" << endl;\n        }\n        if (update) {\n            break;\n        }\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include<iostream>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<cstdio>\nusing namespace std;\ntypedef long long ll;\nconst int MAXN = 4e3 + 10;\nchar s1[MAXN], s2[MAXN], s3[MAXN], tmp[3], ans[MAXN];\nll l1[MAXN], l2[MAXN], l3[MAXN], al[MAXN];\nint t1, t2, t3, t4;\nvoid addword(char* s, ll* l, int& tt, char c, ll tn){\n\tif (tt == 0 || s[tt - 1] != c){\n\t\ts[tt] = c;\n\t\tl[tt] = tn;\n\t\t++tt;\n\t}\n\telse{\n\t\tl[tt - 1] += tn;\n\t}\n}\nint main(){\n\tt1 = t2 = t3 = t4 = 0;\n\twhile (cin >> tmp&&tmp[0] != '$'){\n\t\tll tttt;\n\t\tcin >> tttt;\n\t\taddword(s1, l1, t1, tmp[0], tttt);\n\t}\n\twhile (cin >> tmp&&tmp[0] != '$'){\n\t\tll tttt;\n\t\tcin >> tttt;\n\t\taddword(s2, l2, t2, tmp[0], tttt);\n\t}\n\twhile (cin >> tmp&&tmp[0] != '$'){\n\t\tll tttt;\n\t\tcin >> tttt;\n\t\taddword(s3, l3, t3, tmp[0], tttt);\n\t}\n\tif (t2 == 0){\n\t\tfor (int i = 0; i < t3; ++i){\n\t\t\taddword(ans, al, t4, s3[i], l3[i]);\n\t\t}\n\t\tfor (int i = 0; i < t1; ++i){\n\t\t\taddword(ans, al, t4, s1[i], l1[i]);\n\t\t}\n\t}\n\tfor (int i = 0; i < t1&&t2; ++i){\n\t\tbool ff = true;\n\t\tfor (int j = 0; j < t2; ++j){\n\t\t\tint ti = i + j;\n\t\t\tif (s1[ti] != s2[j] || ((j == 0 && j == t2 - 1) && l1[ti] < l2[j]) || (j != 0 && j != t2 - 1 && l1[ti] != l2[j])){\n\t\t\t\tff = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (ff){\n\t\t\tif (t2 == 1){\n\t\t\t\tfor (int j = 0; j < t3; ++j){\n\t\t\t\t\taddword(ans, al, t4, s3[j], l3[j]);\n\t\t\t\t}\n\t\t\t\tif (l1[i] - l2[0] > 0)\n\t\t\t\t\taddword(ans, al, t4, s1[i], l1[i] - l2[0]);\n\t\t\t\tfor (int j = i + t2; j < t1; ++j){\n\t\t\t\t\taddword(ans, al, t4, s1[j], l1[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif (l1[i] - l2[0] > 0)\n\t\t\t\t\taddword(ans, al, t4, s1[i], l1[i] - l2[0]);\n\t\t\t\tfor (int j = 0; j < t3; ++j){\n\t\t\t\t\taddword(ans, al, t4, s3[j], l3[j]);\n\t\t\t\t}\n\t\t\t\tif (l1[i + t2 - 1] - l2[t2 - 1]>0)\n\t\t\t\t\taddword(ans, al, t4, s1[i + t2 - 1], l1[i + t2 - 1] - l2[t2 - 1]);\n\t\t\t\tfor (int j = i + t2; j < t1; ++j){\n\t\t\t\t\taddword(ans, al, t4, s1[j], l1[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\taddword(ans, al, t4, s1[i], l1[i]);\n\t}\n\tfor (int i = 0; i < t4; ++i){\n\t\tcout << ans[i] << \" \" << al[i] << \" \";\n\t}\n\tcout << \"$\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\nusing namespace std;\n \n#define REP(i,n) for(int i=0; i<n; ++i)\n#define FOR(i,a,b) for(int i=a; i<=b; ++i)\n#define FORR(i,a,b) for (int i=a; i>=b; --i)\n \ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef vector<VI> VVI;\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> PL;\n\nifstream ifs(\"in.txt\");\n\nvoid inp(vector<pair<char, int> > &a){\n    while (1){\n        char c;\n        cin >> c;\n        if (c == '$') break;\n        int x;\n        cin >> x;\n        a.push_back(make_pair(c, x));\n    }\n}\n\nint main() {\n    vector<pair<char, int> > a, b, c, res, ans;\n    inp(a);\n    inp(b);\n    inp(c);\n    REP(i,(int)a.size() - (int)b.size() + 1){\n        bool f = true;\n        REP(j,b.size()){\n            if (a[i+j].first != b[j].first){\n                f = false;\n                break;\n            }\n            if (j == 0 || j == b.size()-1){\n                if (a[i+j].second < b[j].second){\n                    f = false;\n                    break;\n                }\n            }else{\n                if (a[i+j].second != b[j].second){\n                    f = false;\n                    break;\n                }\n            }\n        }\n        if (f){\n            REP(j,i) res.push_back(a[j]);\n            a[i].second -= b[0].second;\n            res.push_back(a[i]);\n            REP(j,c.size()) res.push_back(c[j]);\n            if (b.size() > 1){\n                a[i+b.size()-1].second -= b[b.size()-1].second;\n                res.push_back(a[i+b.size()-1]);\n            }\n            FOR(j,i+b.size(),a.size()-1) res.push_back(a[j]);\n        }\n    }\n    if (res.empty()){\n        REP(i,a.size()){\n            printf(\"%c %d \", a[i].first, a[i].second);\n        }\n        printf(\"$\\n\");\n    }else{\n        REP(i,res.size()){\n            if (!ans.empty() && ans[ans.size()-1].first == res[i].first){\n                ans[ans.size()-1].second += res[i].second;\n            }else if (res[i].second > 0){\n                ans.push_back(res[i]);\n            }\n        }\n        REP(i,ans.size()){\n            printf(\"%c %d \", ans[i].first, ans[i].second);\n        }\n        printf(\"$\\n\");\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\ntypedef pair<char, ll> pci;\n\nint main()\n{\n\tvector<pci> a, b, c;\n\tchar let; ll n;\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\ta.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tb.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tc.emplace_back(let, n);\n\t}\n\tvector<pci> res;\n\t\n\tREP(i, (int)a.size() - (int)b.size() + 1)\n\t{\n\t\tif (a[i].first == b[0].first&&a[i].second >= b[0].second)\n\t\t{\n\t\t\tbool f = true;\n\t\t\tint j;\n\t\t\tfor (j = 1; j < b.size(); j++)\n\t\t\t{\n\t\t\t\tif (j == b.size() - 1)\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second > a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second != a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (f)\n\t\t\t{\n\t\t\t\tif (b.size() == 1)\n\t\t\t\t{\n\t\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\t\tif (a[i].second > b[0].second) res.emplace_back(a[i].first, a[i].second - b[0].second);\n\t\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\t\tif (a[i].second > b[0].second) res.emplace_back(a[i].first, a[i].second - b[0].second);\n\t\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\t\tif (a[i + b.size() - 1].second > b.back().second) res.emplace_back(b.back().first, a[i + b.size() - 1].second - b.back().second);\n\t\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\t\ti = INF;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tvector<pci> ans;\n\tif (res.size() == 0) ans = a;\n\telse\n\t{\n\t\tans.emplace_back(res[0]);\n\t\tFOR(i, 1, res.size())\n\t\t{\n\t\t\tif (res[i].first == ans.back().first) ans.back().second += res[i].second;\n\t\t\telse ans.emplace_back(res[i]);\n\t\t}\n\t}\n\tREP(i, ans.size()) cout << ans[i].first << \" \" << ans[i].second << (i == ans.size() - 1 ? \" $\\n\" : \" \");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define fi first\n#define se second\nusing namespace std;\ntypedef pair<string,int> P;\nvector<P>v1,v2,v3;\nint x;\nstring s;\nmain(){\n  while(cin>>s,s!=\"$\")cin>>x,v1.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v2.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v3.push_back(P(s,x));\n  r(i,v1.size())if(v1[i].fi==v2[0].fi&&v1[i].se>=v2[0].se){\n    int flag=0,jj=0,ff=0;\n    r(j,(int)v2.size()-2){\n      jj=j+1;\n      if(i+jj>=v1.size()){flag++;break;}\n      if(v2[jj].se!=v1[i+jj].se||v2[jj].fi!=v1[i+jj].fi)flag++;\n    }\n    jj++;\n    if(v2.size()==1)jj++;\n    else if(i+jj>=v1.size())flag++;\n    else if((v2[v2.size()-1].fi!=v1[i+jj].fi||v2[v2.size()-1].se>v1[i+jj].se))flag++;\n    if(v2.size()!=1){\n      if(!flag&&v2[jj].fi==v1[i+jj].fi&&v2[jj].se<=v1[i+jj].se){\n        v1[i].se-=v2[0].se;\n        r(j,v2.size()-2)v1.erase(v1.begin()+i+1);\n        v1[i+1].se-=v2[v2.size()-1].se;\n        r(j,v3.size())v1.insert(v1.begin()+i+1,v3[(int)v3.size()-1-j]);\n      }\n      if(flag)goto L;\n      ff++;\n    }\n    else{\n      if(flag)goto L;\n      v1[i].se-=v2[0].se;\n      r(j,v3.size())v1.insert(v1.begin()+i,v3[(int)v3.size()-1-j]);\n      ff++;\n    }\n    r(j,v1.size())if(v1[j].se==0)v1.erase(v1.begin()+j);\n    r(j,(int)v1.size()-1)if(v1[j].fi==v1[j+1].fi)\n      v1[j].se+=v1[j+1].se,v1.erase(v1.begin()+j+1),j--;\n    break;\n    L:;\n  }\n  r(k,v1.size())cout<<v1[k].fi<<' '<<v1[k].se<<' ';\n  cout<<'$'<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\nusing namespace std;\nvector<pair<char,int> >A,B,C;\nmain()\n{\n\tchar c;\n\twhile(cin>>c,c!='$')\n\t{\n\t\tint a;cin>>a;\n\t\tA.push_back(make_pair(c,a));\n\t}\n\twhile(cin>>c,c!='$')\n\t{\n\t\tint a;cin>>a;\n\t\tB.push_back(make_pair(c,a));\n\t}\n\twhile(cin>>c,c!='$')\n\t{\n\t\tint a;cin>>a;\n\t\tC.push_back(make_pair(c,a));\n\t}\n\tint id=-1;\n\tfor(int i=0;i<A.size();i++)\n\t{\n\t\tif(A[i].first==B[0].first&&A[i].second>=B[0].second)\n\t\t{\n\t\t\tbool flag=1;\n\t\t\tfor(int j=1;j+1<B.size();j++)flag&=i+j<A.size()&&A[i+j]==B[j];\n\t\t\tif(B.size()>1)flag&=i+B.size()<=A.size()&&A[i+B.size()-1].first==B[B.size()-1].first&&A[i+B.size()-1].second>=B[B.size()-1].second;\n\t\t\tif(flag)\n\t\t\t{\n\t\t\t\tid=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tvector<pair<char,int> >ans;\n\tif(id<0)\n\t{\n\t\tans=A;\n\t}\n\telse\n\t{\n\t\tfor(int i=0;i<id;i++)ans.push_back(A[i]);\n\t\tif(B.size()>1)\n\t\t{\n\t\t\tif(A[id].second>B[0].second)ans.push_back(make_pair(A[id].first,A[id].second-B[0].second));\n\t\t\tfor(int i=0;i<C.size();i++)ans.push_back(C[i]);\n\t\t\tint next=id+B.size()-1;\n\t\t\tif(A[next].second>B[next-id].second)\n\t\t\t\tans.push_back(make_pair(A[next].first,A[next].second-B[next-id].second));\n\t\t\tid=next+1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor(int i=0;i<C.size();i++)ans.push_back(C[i]);\n\t\t\tif(A[id].second>B[0].second)\n\t\t\t{\n\t\t\t\tans.push_back(make_pair(A[id].first,A[id].second-B[0].second));\n\t\t\t}\n\t\t\tid++;\n\t\t}\n\t\tfor(;id<A.size();id++)ans.push_back(A[id]);\n\t}\n\tfor(int i=0;i<ans.size();i++)\n\t{\n\t\twhile(i+1<ans.size()&&ans[i].first==ans[i+1].first)\n\t\t{\n\t\t\tans[i+1].second+=ans[i].second;\n\t\t\ti++;\n\t\t}\n\t\tcout<<ans[i].first<<\" \"<<ans[i].second<<\" \";\n\t}\n\tcout<<\"$\"<<endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define fi first\n#define se second\nusing namespace std;\ntypedef pair<string,int> P;\nvector<P>v1,v2,v3;\nint x;\nstring s;\nmain(){\n  while(cin>>s,s!=\"$\")cin>>x,v1.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v2.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v3.push_back(P(s,x));\n  r(i,v1.size())if(v1[i].fi==v2[0].fi&&v1[i].se>=v2[0].se){\n    int flag=0,jj=0,ff=0;\n    r(j,(int)v2.size()-2){\n      jj=j+1;\n      if(i+jj>=v1.size()){flag++;break;}\n      if(v2[jj].se!=v1[i+jj].se||v2[jj].fi!=v1[i+jj].fi)flag++;\n    }\n    if(v2.size()==2&&(v2[1].fi!=v1[i+1].fi||v2[1].se>v1[i+1].se))flag++;\n    if(v2.size()!=1){\n      jj++;\n      if(!flag&&v2[jj].fi==v1[i+jj].fi&&v2[jj].se<=v1[i+jj].se){\n        v1[i].se-=v2[0].se;\n        r(j,v2.size()-2)v1.erase(v1.begin()+i+1);\n        v1[i+1].se-=v2[v2.size()-1].se;\n        r(j,v3.size())v1.insert(v1.begin()+i+1,v3[(int)v3.size()-1-j]);\n      }\n      if(flag)goto L;\n      ff++;\n    }\n    else{\n      if(flag)goto L;\n      v1[i].se-=v2[0].se;\n      r(j,v3.size())v1.insert(v1.begin()+i,v3[(int)v3.size()-1-j]);\n      ff++;\n    }\n    r(j,v1.size())if(v1[j].se==0)v1.erase(v1.begin()+i);\n    r(j,(int)v1.size()-1)if(v1[j].fi==v1[j+1].fi)\n      v1[j].se+=v1[j+1].se,v1.erase(v1.begin()+j+1),j--;\n    r(j,v3.size())i++;\n    if(ff)break;\n    L:;\n  }\n  r(k,v1.size())cout<<v1[k].fi<<' '<<v1[k].se<<' ';\n  cout<<'$'<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\nusing namespace std;\n \n#define REP(i,n) for(int i=0; i<n; ++i)\n#define FOR(i,a,b) for(int i=a; i<=b; ++i)\n#define FORR(i,a,b) for (int i=a; i>=b; --i)\n \ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef vector<VI> VVI;\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> PL;\n\nvoid inp(vector<pair<char, int> > &a){\n    while (1){\n        char c;\n        cin >> c;\n        if (c == '$') break;\n        int x;\n        cin >> x;\n        a.push_back(make_pair(c, x));\n    }\n}\n\nint main() {\n    vector<pair<char, int> > a, b, c, res, ans;\n    inp(a);\n    inp(b);\n    inp(c);\n    REP(i,a.size() - b.size() + 1){\n        bool f = true;\n        REP(j,b.size()){\n            if (a[i+j].first != b[j].first){\n                f = false;\n                break;\n            }\n            if (j == 0 || j == b.size()-1){\n                if (a[i+j].second < b[j].second){\n                    f = false;\n                    break;\n                }\n            }else{\n                if (a[i+j].second != b[j].second){\n                    f = false;\n                    break;\n                }\n            }\n        }\n        if (f){\n            REP(j,i) res.push_back(a[j]);\n            a[i].second -= b[0].second;\n            res.push_back(a[i]);\n            REP(j,c.size()) res.push_back(c[j]);\n            if (b.size() > 1){\n                a[i+b.size()-1].second -= b[b.size()-1].second;\n                res.push_back(a[i+b.size()-1]);\n            }\n            FOR(j,i+b.size(),a.size()-1) res.push_back(a[j]);\n        }\n    }\n    if (res.empty()){\n        REP(i,a.size()){\n            printf(\"%c %d \", a[i].first, a[i].second);\n        }\n        printf(\"$\\n\");\n    }else{\n        REP(i,res.size()){\n            if (!ans.empty() && ans[ans.size()-1].first == res[i].first){\n                ans[ans.size()-1].second += res[i].second;\n            }else if (res[i].second > 0){\n                ans.push_back(res[i]);\n            }\n        }\n        REP(i,ans.size()){\n            printf(\"%c %d \", ans[i].first, ans[i].second);\n        }\n        printf(\"$\\n\");\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\nusing namespace std;\nstring s; int x; vector<pair<string, int> > a, b, c;\nvector<pair<string, int> > shift(vector<pair<string, int> > v) {\n\tvector<pair<string, int> > w;\n\tfor (int i = 0; i < v.size(); i++) {\n\t\tif (v[i].second > 0) w.push_back(v[i]);\n\t}\n\tv = w;\n\tvector<pair<string, int> > ret;\n\tint sum = v[0].second;\n\tfor (int i = 1; i <= v.size(); i++) {\n\t\tif (i == v.size() || v[i - 1].first != v[i].first) {\n\t\t\tret.push_back(make_pair(v[i - 1].first, sum));\n\t\t\tsum = 0;\n\t\t}\n\t\tif (i != v.size()) sum += v[i].second;\n\t}\n\treturn ret;\n}\nint main() {\n\twhile (cin >> s, s != \"$\") cin >> x, a.push_back(make_pair(s, x));\n\twhile (cin >> s, s != \"$\") cin >> x, b.push_back(make_pair(s, x));\n\twhile (cin >> s, s != \"$\") cin >> x, c.push_back(make_pair(s, x));\n\tfor (int i = 0; i <= (int)(a.size() - b.size()); i++) {\n\t\tbool ok = true;\n\t\tfor (int j = 0; j < b.size(); j++) {\n\t\t\tif (a[i + j].first != b[j].first) ok = false;\n\t\t}\n\t\tfor (int j = 2; j < b.size(); j++) {\n\t\t\tif (a[i + j - 1].second != b[j - 1].second) ok = false;\n\t\t}\n\t\tif (a[i].second < b[0].second) ok = false;\n\t\tif (a[i + b.size() - 1].second < b[b.size() - 1].second) ok = false;\n\t\tif (ok) {\n\t\t\tvector<pair<string, int> > d(a.begin(), a.begin() + i);\n\t\t\tif(b.size() != 1) d.push_back(make_pair(a[i].first, a[i].second - b[0].second));\n\t\t\td.insert(d.end(), c.begin(), c.end());\n\t\t\td.push_back(make_pair(a[i + b.size() - 1].first, a[i + b.size() - 1].second - b[b.size() - 1].second));\n\t\t\td.insert(d.end(), a.begin() + i + b.size(), a.end());\n\t\t\ta = shift(d);\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor (int i = 0; i < a.size(); i++) cout << a[i].first << ' ' << a[i].second << ' ';\n\tcout << \"$\" << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n#include <fstream>\n\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\n#define watch(a) { cout << #a << \" = \" << a << endl; }\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntypedef long long ll;\nint const inf = 1<<29;\n\nvoid change(deque<pair<char, int>>& nv0) {\n  if(nv0.size() > 1 && nv0[nv0.size()-2].first == nv0.back().first) {\n    int k = nv0.back().second;\n    nv0.pop_back();\n    nv0.back().second += k;\n  }\n}\n\nvoid output(deque<pair<char, int>>& out) {\n  rep(i, out.size()) {\n    if(i) cout << \" \";\n    cout << out[i].first << \" \" << out[i].second;\n  }\n  cout << \" $\" << endl;\n}\n\nint main() {\n\n  vector<deque<pair<char, int>>> v(3);\n  for(auto& u: v) {\n    while(1) {\n      char c; cin >> c;\n      if(c == '$') break;\n      int n; cin >> n;\n      u.emplace_back(c, n);\n    }\n  }\n\n  rep(i, v[0].size()-(int)v[1].size()+1) {\n    int j = 0;\n    vector<int> V;\n    while(j < v[1].size() && v[0][i+j].first == v[1][j].first) {\n      if(j == 0 || j == v[1].size()-1) {\n        if(v[0][i+j].second < v[1][j].second) break;\n        V.push_back(v[0][i+j].second - v[1][j].second);\n      }\n      else {\n        if(v[0][i+j].second != v[1][j].second) break;\n      }\n      j++;\n    }\n\n    deque<pair<char, int>> nv0;\n    if(j == v[1].size()) {\n      rep(k, v[0].size()) {\n        if(k < i) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n        if(k == i) {\n          if(V[0] > 0) nv0.emplace_back(v[0][i].first, V[0]);\n          rep(l, v[2].size()) {\n            nv0.push_back(v[2][l]);\n            change(nv0);\n          }\n          k = i+v[1].size()-1;\n        }\n        if(k == i+j-1) {\n          if(V[1] > 0) nv0.emplace_back(v[0][i+j-1].first, V[1]);\n          change(nv0);\n        }\n        if(i+j <= k) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n      }\n      v[0] = nv0;\n      i--;\n    }\n  }\n\n  output(v[0]);\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define syosu(x) fixed<<setprecision(x)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\ntypedef pair<int,int> P;\ntypedef pair<double,double> pdd;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<string> vs;\ntypedef vector<P> vp;\ntypedef vector<vp> vvp;\ntypedef vector<pll> vpll;\ntypedef pair<int,P> pip;\ntypedef vector<pip> vip;\nconst int inf=1<<29;\nconst ll INF=1ll<<60;\nconst double pi=acos(-1);\nconst double eps=1e-9;\nconst ll mod=1e9+7;\nconst int dx[4]={-1,0,1,0},dy[4]={0,-1,0,1};\n\nvoid f(vector<pair<char,int>> &a){\n\twhile(1){\n\t\tchar c;\n\t\tint x;\n\t\tcin>>c;\n\t\tif(c=='$') break;\n\t\tcin>>x;\n\t\ta.push_back(make_pair(c,x));\n\t}\n}\n\nvector<pair<char,int>> a,b,c,d,res,ans;\n\nint main(){\n\tf(a),f(b),f(c),f(ans);\n\td=a;\n\tint n=a.size(),m=b.size();\n\tfor(int i=0;i+m-1<n;i++) if(a[i].first==b[0].first&&a[i].second>=b[0].second){\n\t\tbool B=1;\n\t\tfor(int j=1;j<m;j++){\n\t\t\tif(a[i+j].first!=b[j].first) B=0;\n\t\t\tif(j<m-1&&a[i+j].second!=b[j].second) B=0;\n\t\t\tif(j==m-1&&a[i+j].second<b[j].second) B=0;\n\t\t}\n\t\tif(B){\n\t\t\td.clear();\n\t\t\tfor(int j=0;j<i;j++) d.push_back(a[j]);\n\t\t\tif(m>1) d.push_back(make_pair(a[i].first,a[i].second-b[0].second));\n\t\t\tfor(auto p:c) d.push_back(p);\n\t\t\td.push_back(make_pair(a[i+m-1].first,a[i+m-1].second-b[m-1].second));\n\t\t\tfor(int j=i+m;j<n;j++) d.push_back(a[j]);\n\t\t\tbreak;\n\t\t}\n\t}\n\tn=d.size();\n\tfor(int i=0;i<n;i++) if(d[i].second) res.push_back(d[i]);\n\td=res;\n\tres.clear();\n\tn=d.size();\n\tfor(int i=0;i<n;){\n\t\tchar c=d[i].first;\n\t\tint x=0;\n\t\twhile(i<n&&c==d[i].first){\n\t\t\tx+=d[i].second;\n\t\t\ti++;\n\t\t}\n\t\tres.push_back(make_pair(c,x));\n\t}\n\tfor(int i=0;i<res.size();i++) cout<<res[i].first<<' '<<res[i].second<<' ';\n\tcout<<'$'<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\n\n\nvector<P>A,B,C;\n\nvoid input(vector<P> &a){\n  int num;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin>>num;\n    a.push_back(P(ch,num));\n  }\n}\n\nbool check(int i){\n  int n = A.size();\n  int m = B.size();\n  if(i+m>n) return 0;\n  if(A[i].first!=B[0].first||A[i].second<B[0].second)return 0;\n  if(m == 1) return 1;\n\n  i++;\n  for(int j=1;i<m-1;j++,i++)\n    if(A[i].first!=B[j].first||A[i].second!=B[j].second)return 0;\n  \n  if(A[i].first!=B[m-1].first||A[i].second<B[m-1].second)return 0;\n  return 1;\n}\n\nvoid mergePush(vector<P> &res,P a){\n  int c = a.second;\n  char ch = a.first;\n  if(c == 0)return;\n  if(res.size() && res.back().first == ch)res.back().second+=c;\n  else res.push_back(P(ch,c));\n}\n\nvector<P> solve(){\n  vector<P> res;\n  int n = A.size();\n  int m = B.size();\n  int l = C.size();\n  for(int i=0;i<n;i++){\n    if(A[i].second == 0) continue;\n    if(!check(i)){mergePush(res,A[i]);continue;}\n    \n    mergePush(res,P(A[i].first,A[i].second - B[0].second));   \n    for(int j=0;j<l;j++) mergePush(res,C[j]);\n    i+=m-1;\n    A[i--].second -= B.back().second;\n  }\n  return res;\n}\n\nvector<P> sovle2(){\n  vector<P> res;\n  int n = A.size();\n  int m = B.size();\n  int l = C.size();\n  for(int i = 0;i<n;i++){\n    \n  }\n\n}\n\n\nint main(){\n  input(A);\n  input(B);\n  input(C);\n  vector<P> ans = solve();\n  for(P a:ans) cout<<a.first<<\" \"<<a.second<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define fi first\n#define se second\nusing namespace std;\ntypedef pair<string,int> P;\nvector<P>v1,v2,v3;\nint x;\nstring s;\nmain(){\n  while(cin>>s,s!=\"$\")cin>>x,v1.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v2.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v3.push_back(P(s,x));\n  r(i,v1.size())if(v1[i].fi==v2[0].fi&&v1[i].se>=v2[0].se){\n    int flag=0,jj=0,ff=0;\n    r(j,(int)v2.size()-2){\n      jj=j+1;\n      if(i+jj>=v1.size()){flag++;break;}\n      if(v2[jj].se!=v1[i+jj].se||v2[jj].fi!=v1[i+jj].fi)flag++;\n    }\n    if(v2.size()!=1){\n      jj++;\n      if(!flag&&v2[jj].fi==v1[i+jj].fi&&v2[jj].se<=v1[i+jj].se){\n        v1[i].se-=v2[0].se;\n        r(j,v2.size()-2)v1.erase(v1.begin()+i+1);\n        v1[i+1].se-=v2[v2.size()-1].se;\n        r(j,v3.size())v1.insert(v1.begin()+i+1,v3[j]);\n      }\n      ff++;\n    }\n    else{\n      v1[i].se-=v2[0].se;\n      r(j,v3.size())v1.insert(v1.begin()+i,v3[(int)v3.size()-1-j]);\n      ff++;\n    }\n    r(j,v1.size())if(v1[j].se==0)v1.erase(v1.begin()+i);\n    r(j,(int)v1.size()-1)if(v1[j].fi==v1[j+1].fi)\n      v1[j].se+=v1[j+1].se,v1.erase(v1.begin()+j+1),j--;\n    r(j,v3.size())i++;\n    if(ff)break;\n  }\n  r(k,v1.size())cout<<v1[k].fi<<' '<<v1[k].se<<' ';\n  cout<<'$'<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 998244353;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef long double ld;\ntypedef complex<ld> Point;\nconst ld eps = 1e-11;\nconst ld pi = acos(-1.0);\ntypedef pair<ll, ll> LP;\nint main() {\n\tchar at[1000]; int an[1000];\n\tchar bt[1000]; int bn[1000];\n\tchar ct[1000]; int cn[1000];\n\tchar x;\n\tint c1 = 0; int m;\n\twhile (cin >> x) {\n\t\tif (x == '$')break;\n\t\tcin >> m;\n\t\tat[c1] = x; an[c1] = m; c1++;\n\t}\n\tint c2 = 0;\n\twhile (cin >> x) {\n\t\tif (x == '$')break;\n\t\tcin >> m;\n\t\tbt[c2] = x; bn[c2] = m; c2++;\n\t}\n\tint c3 = 0;\n\twhile (cin >> x) {\n\t\tif (x == '$')break;\n\t\tcin >> m;\n\t\tct[c3] = x; cn[c3] = m; c3++;\n\t}\n\tint chk = -1;\n\trep(i, c1 - c2+1) {\n\t\tif (at[i] == bt[0]) {\n\t\t\tbool f = true;\n\t\t\tif (an[i] < bn[0])f = false;\n\t\t\tRep(k, 1 ,c2-1){\n\t\t\t\tif (at[i + k] != bt[k] || an[i + k] != bn[k])f = false;\n\t\t\t}\n\t\t\tif (an[i + c2 - 1] < bn[c2 - 1])f = false;\n\t\t\tif (f) {\n\t\t\t\tchk = i; break;\n\t\t\t}\n\t\t}\n\t}\n\tqueue<pair<char, int>> q1, q2;\n\tif (chk == -1) {\n\t\trep(i, c1) {\n\t\t\tq1.push({ at[i],an[i] });\n\t\t}\n\t}\n\telse {\n\t\trep(i, chk) {\n\t\t\tq1.push({ at[i],an[i] });\n\t    }\n\t\tif (c2>1&&an[chk] - bn[0] > 0) {\n\t\t\tq1.push({ at[chk],an[chk] - bn[0] });\n\t\t}\n\t\trep(i, c3) {\n\t\t\tq1.push({ ct[i],cn[i] });\n\t\t}\n\t\tif (an[chk + c2 - 1] - bn[c2 - 1] > 0) {\n\t\t\tq1.push({ at[chk + c2 - 1],an[chk + c2 - 1] - bn[c2 - 1] });\n\t\t}\n\t\tRep(i, chk + c2, c1) {\n\t\t\tq1.push({ at[i],an[i] });\n\t\t}\n\t}\n\tpair<char, int>memo = { '#',-1 };\n\twhile (!q1.empty()) {\n\t\tpair<char, int> now = q1.front(); q1.pop();\n\t\tif (now.first == memo.first) {\n\t\t\tmemo.second += now.second;\n\t\t}\n\t\telse {\n\t\t\tif (memo.second >= 0) {\n\t\t\t\tq2.push(memo);\n\t\t\t}\n\t\t\tmemo = now;\n\t\t}\n\t}\n\tq2.push(memo);\n\twhile (!q2.empty()) {\n\t\tpair<char, int> out = q2.front(); q2.pop();\n\t\tcout << out.first << \" \" << out.second << \" \";\n\t}\n\tcout << '$' << endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#define  _CRT_SECURE_NO_WARNINGS\n#pragma comment (linker, \"/STACK:526000000\")\n\n#include \"bits/stdc++.h\"\n\nusing namespace std;\ntypedef string::const_iterator State;\n#define eps 1e-11L\n#define MAX_MOD 1000000007LL\n#define GYAKU 500000004LL\n\n#define MOD 998244353LL\n#define seg_size 262144 * 4LL\n#define pb push_back\n#define mp make_pair\ntypedef long long ll;\n#define REP(a,b) for(long long (a) = 0;(a) < (b);++(a))\n#define ALL(x) (x).begin(),(x).end()\n\nunsigned long xor128() {\n\tstatic unsigned long x = 123456789, y = 362436069, z = 521288629, w = time(NULL);\n\tunsigned long t = (x ^ (x << 11));\n\tx = y; y = z; z = w;\n\treturn (w = (w ^ (w >> 19)) ^ (t ^ (t >> 8)));\n}\nvoid init() {\n\tiostream::sync_with_stdio(false);\n\tcout << fixed << setprecision(20);\n}\n\n#define int ll\n\nvoid solve(){\n\twhile (true) {\n\t\tauto input = []() {\n\t\t\tvector<pair<char, int>> ans;\n\t\t\twhile (true) {\n\t\t\t\tstring s;\n\t\t\t\tcin >> s;\n\t\t\t\tif (s == \"$\") return ans;\n\t\t\t\tint a;\n\t\t\t\tcin >> a;\n\t\t\t\tans.push_back(mp(s[0], a));\n\t\t\t}\n\t\t};\n\t\tauto output = [](vector<pair<char, int>> a) {\n\t\t\tfor (int i = 0; i < a.size(); ++i) {\n\t\t\t\tif (a[i].second == 0) {\n\t\t\t\t\ta.erase(a.begin() + i);\n\t\t\t\t\ti--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (i + 1 < a.size() && a[i].first == a[i + 1].first) {\n\t\t\t\t\ta[i].second += a[i + 1].second;\n\t\t\t\t\ta.erase(a.begin() + i + 1);\n\t\t\t\t\ti--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int i = 0; i < a.size(); ++i) {\n\t\t\t\tif (a[i].second == 0) {\n\t\t\t\t\ta.erase(a.begin() + i);\n\t\t\t\t\ti--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (i + 1 < a.size() && a[i].first == a[i + 1].first) {\n\t\t\t\t\ta[i].second += a[i + 1].second;\n\t\t\t\t\ta.erase(a.begin() + i + 1);\n\t\t\t\t\ti--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tint skipping = 0;\n\t\t\tREP(i, a.size()) {\n\t\t\t\tif (skipping == 1) cout << \" \";\n\t\t\t\tskipping = 1;\n\t\t\t\tcout << a[i].first << \" \" << a[i].second;\n\t\t\t}\n\t\t\tcout << \" $\" << endl;\n\t\t};\n\n\t\tvector<pair<char,int>> A = input(), B = input(), C = input();\n\t\tif (B.size() == 1) {\n\t\t\t// exception here.\n\t\t\tfor (int i = 0; i < A.size(); ++i) {\n\t\t\t\tif (A[i].first == B[0].first && A[i].second >= B[0].second) {\n\t\t\t\t\tA[i].second -= B[0].second;\n\t\t\t\t\tfor (int q = C.size() - 1; q >= 0; --q) {\n\t\t\t\t\t\tA.insert(A.begin() + i, C[q]);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfor (int i = 0; i < (int)A.size() - (int)B.size() + 1; ++i) {\n\t\t\t\tif (A[i].first == B[0].first && A[i].second >= B[0].second) {\n\t\t\t\t\tint ok = 1;\n\t\t\t\t\tfor (int q = 1; q < B.size() - 1; ++q) {\n\t\t\t\t\t\tif (A[i + q] != B[q]) {\n\t\t\t\t\t\t\tok = 0;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (ok == 0) continue;\n\t\t\t\t\tif (A[i + B.size() - 1].first != B.back().first || A[i + B.size() - 1].second < B.back().second) continue;\n\t\t\t\t\tA[i].second -= B[0].second;\n\t\t\t\t\tREP(q, B.size() - 2) {\n\t\t\t\t\t\tA.erase(A.begin() + i + 1);\n\t\t\t\t\t}\n\t\t\t\t\tA[i + 1].second -= B.back().second;\n\t\t\t\t\tREP(q, C.size()) {\n\t\t\t\t\t\tA.insert(A.begin() + i + 1, C[C.size()-1-q]);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\toutput(A);\n\t\treturn;\n\t}\n}\n\n#undef int\n\nint main() {\n\tinit();\n\tsolve();\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define s second\n#define f first\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\nvector<P> A[3],ans;\nll len[3];\n\nint main(){\n  char c;\n  ll n;\n  for(int i=0;i<3;i++){\n    while(cin>>c,c!='$')\n      cin>>n,A[i].push_back(P(c,n));\n    len[i]=A[i].size();\n  }\n  int F=0;\n  for(int i=0;i<len[0];i++){\n    if(i>len[0]-len[1]){\n      ans.push_back(A[0][i]);\n      continue;\n    }\n    int flag=0;\n    for(int j=0;j<len[1];j++){\n      ll a=A[0][i+j].s,b=A[1][j].s;\n      if(A[0][i+j].f!=A[1][j].f)flag=1;\n      if(!j&&a<b)flag=1;\n      if(j&&j!=len[1]-1&&a!=b)flag=1;\n      if(j==len[1]-1&&a<b)flag=1;\n    }\n    if(!F&&!flag){\n      F=1;\n      if(A[0][i].s>A[1][0].s&&len[1]!=1)\n\tans.push_back(P(A[1][0].f,A[0][i].s-A[1][0].s));\n      for(int j=0;j<len[2];j++)\n\tans.push_back(A[2][j]);\n      A[0][i+len[1]-1].s-=A[1][len[1]-1].s;\n      i+=len[1]-2;\n    }else if(A[0][i].s)ans.push_back(A[0][i]);\n  }\n  char ch=ans[0].f;\n  ll sum=ans[0].s;\n  for(int i=1;i<ans.size();i++){\n    if(ch==ans[i].f)sum+=ans[i].s;\n    else cout<<ch<<' '<<sum<<' ',ch=ans[i].f,sum=ans[i].s;\n  }\n  cout<<ch<<' '<<sum<<\" $\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n \ntypedef pair<char,int> P;\nvector<P> A,B,C;\nvoid input(vector<P> &a){\n  while( true ){\n    char c; cin >> c;\n    if( c == '$' ) return;\n    int l; cin >> l;\n    a.push_back( P(c,l) );\n  }\n}\nint main(){\n  input(A);  input(B);  input(C);\n  vector<P> res;\n  for(int i=0;i<(int)A.size();i++){\n    if( A[i].first == B[0].first && A[i].second >= B[0].second ){\n      int n = (int)B.size();\n      bool ok = true;\n      for(int j=1;j<n-1;j++){\n        if( !(A[i+j].first == B[j].first && A[i+j].second == B[j].second) ){\n          ok = false; break;\n        }\n      }\n      if( ok && ( A[i+n-1].first == B[n-1].first && A[i+n-1].second >= B[n-1].second ) ){\n \n        for(int j=0;j<i;j++) res.push_back( A[j] );\n        if(n == 1 ) {\n          for(int j=0;j<(int)C.size();j++) res.push_back( C[j] );        \n          res.push_back( P(A[i].first, A[i].second - B[0].second) );\n          for(int j=i+n;j<(int)A.size();j++) res.push_back( A[j] );\n        } else {\n          res.push_back( P(A[i].first, A[i].second - B[0].second) );\n          for(int j=0;j<(int)C.size();j++) res.push_back( C[j] );\n          res.push_back( P(A[i+n-1].first, A[i+n-1].second-B[n-1].second) );\n          for(int j=i+n;j<(int)A.size();j++) res.push_back( A[j] );\n        }\n        break;\n \n      }\n    }\n  }\n  if( res.empty() ){\n    for(int i=0;i<(int)A.size();i++)\n      cout << A[i].first << \" \" << A[i].second << \" \";  \n    cout << \"$\" << endl;    \n    return 0;\n  }\n  bool modf=false;\n  do{\n    modf = false;\n    for(int i=0;i<(int)res.size();i++){\n      if( res[i].second == 0 ) {\n        res.erase(res.begin()+i);\n        modf = true;\n        break;\n      }\n    }\n    if(modf)continue;\n    for(int i=0;i<(int)res.size()-1;i++){\n      if( res[i].first == res[i+1].first ){\n        res[i].second += res[i+1].second;\n        res[i+1].second = 0;\n        modf = true;\n        break;\n      }\n    }\n  }while( modf );\n \n  for(int i=0;i<(int)res.size();i++)\n    cout << res[i].first << \" \" << res[i].second << \" \";  \n  cout << \"$\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define fi first\n#define se second\nusing namespace std;\ntypedef pair<string,int> P;\nvector<P>v1,v2,v3;\nint x;\nstring s;\nmain(){\n  while(cin>>s,s!=\"$\")cin>>x,v1.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v2.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v3.push_back(P(s,x));\n  r(i,v1.size())if(v1[i].fi==v2[0].fi&&v1[i].se>=v2[0].se){\n    int flag=0,jj=0,ff=0;\n    r(j,(int)v2.size()-2){\n      jj=j+1;\n      if(i+jj>=v1.size()){flag++;break;}\n      if(v2[jj].se!=v1[i+jj].se||v2[jj].fi!=v1[i+jj].fi)flag++;\n    }\n    if(v2.size()!=1){\n      jj++;\n      if(!flag&&v2[jj].fi==v1[i+jj].fi&&v2[jj].se<=v1[i+jj].se){\n        v1[i].se-=v2[0].se;\n        r(j,v2.size()-2)v1.erase(v1.begin()+i+1);\n        v1[i+1].se-=v2[v2.size()-1].se;\n        r(j,v3.size())v1.insert(v1.begin()+i+1,v3[j]);\n      }\n      ff++;\n    }\n    else{\n      v1[i].se-=v2[0].se;\n      r(j,v3.size())v1.insert(v1.begin()+i+1,v3[j]);\n      ff++;\n    }\n    r(j,v1.size())if(v1[j].se==0)v1.erase(v1.begin()+i);\n    r(j,(int)v1.size()-1)if(v1[j].fi==v1[j+1].fi)\n      v1[j].se+=v1[j+1].se,v1.erase(v1.begin()+j+1),j--;\n    r(j,v3.size())i++;\n    if(ff)break;\n  }\n  r(k,v1.size())cout<<v1[k].fi<<' '<<v1[k].se<<' ';\n  cout<<'$'<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\ntypedef pair<char, ll> pci;\nvector<pci> a, b, c;\n\nint main()\n{\n\tchar let; ll n;\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\ta.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tb.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tc.emplace_back(let, n);\n\t}\n\tvector<pci> res;\n\t\n\tREP(i, (int)a.size() - (int)b.size() + 1)\n\t{\n\t\tif (a[i].first == b[0].first&&a[i].second >= b[0].second)\n\t\t{\n\t\t\tbool f = true;\n\t\t\tint j;\n\t\t\tfor (j = 1; j < b.size(); j++)\n\t\t\t{\n\t\t\t\tif (j == b.size() - 1)\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second > a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second != a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (f)\n\t\t\t{\n\t\t\t\tif (b.size() == 1)\n\t\t\t\t{\n\t\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\t\tif (a[i].second > b[0].second) res.emplace_back(a[i].first, a[i].second - b[0].second);\n\t\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\t\tif (a[i].second > b[0].second) res.emplace_back(a[i].first, a[i].second - b[0].second);\n\t\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\t\tif (a[i + b.size() - 1].second > b.back().second) res.emplace_back(b.back().first, a[i + b.size() - 1].second - b.back().second);\n\t\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\t\ti = INF;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tvector<pci> ans;\n\tif (res.size() == 0) ans = a;\n\telse\n\t{\n\t\tans.emplace_back(res[0]);\n\t\tFOR(i, 1, res.size())\n\t\t{\n\t\t\tif (res[i].first == ans.back().first) ans.back().second += res[i].second;\n\t\t\telse ans.emplace_back(res[i]);\n\t\t}\n\t}\n\tREP(i, ans.size()) cout << ans[i].first << \" \" << ans[i].second << (i == ans.size() - 1 ? \" $\\n\" : \" \");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\n//const int INF = 1e8;\nusing namespace std;\n\n#define int long long\n\nstruct Data{\n\tchar c;\n\tint n;\n\tData(char c, int n) : c(c), n(n) {}\n};\n\nvoid parser(list<Data>& a){\n\tchar chr;\n\tint num;\n\twhile(cin >> chr, chr != '$'){\n\t\tcin >> num;\n\t\ta.emplace_back(chr, num);\n\t}\n}\n\nlist<Data> a, b, c;\n\nbool canReplace(list<Data>::iterator it){\n\tint idx = 0;\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n\tfor(auto i = it, j = b.begin(); j != b.end(); i++, j++){\n\t\tif(i->c != j->c) return false;\n\t\tif(idx == 0 or idx == b.size() - 1){\n\t\t\tif(i->n < j->n) return false;\n\t\t}else{\n\t\t\tif(i->n != j->n) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\n\nvoid replaceList(list<Data>::iterator& it){\n\trep(i,b.size()){\n\t\tif(i == 0){\n\t\t\tit->n -= (*b.begin()).n;\n\t\t\tif(it->n == 0) it = a.erase(it);\n\t\t\telse it++;\n\t\t}else if(i == b.size() - 1){\n\t\t\tit->n -= (*--b.end()).n;\n\t\t\tif(it->n == 0) it = a.erase(it);\n\t\t}else{\n\t\t\tit = a.erase(it);\n\t\t}\n\t}\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n\t//for(auto i : c){ cout << i.c; } cout << endl;\n\tfor(auto i : c){\n\t\ta.insert(it,i);\n\t}\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n}\n\nbool check(){\n\tint idx = 0;\n\tbool f = false;\n\tfor(auto it = a.begin(); idx + b.size() <= a.size(); it++, idx++){\n\t\tif(canReplace(it)){\n\t\t\treplaceList(it);\n\t\t\tf = true;\n\t\t}\n\t}\n\treturn f;\n}\n\nvoid compress(){\n\tauto it = a.begin();\n\twhile(it != a.end()){\n\t\tif(it->c == next(it, 1)->c){\n\t\t\tit->n += next(it, 1)->n;\n\t\t\ta.erase(next(it,1));\n\t\t}else if(it->n == 0){\n\t\t\tit = a.erase(it);\n\t\t}else{\n\t\t\tit++;\n\t\t}\n\t}\n}\n\nbool comp(){\n\tfor(auto i = a.begin(), j = b.begin(); i != a.end(); i++, j++){\n\t\tif(i->c != j->c or i->n != j->n) return false;\n\t}\n\treturn true;\n}\n\nsigned main(){\n\tparser(a);\n\tparser(b);\n\tparser(c);\n\n\tif(comp())\n\twhile(true){\n\t\tcompress();\n\t\tif(check() == false) break;\n\t}\n\t\n\tfor(auto i : a){\n\t\tcout << i.c << ' ' << i.n << ' ';\n\t}\n\tcout << '$' << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "/* template.cpp {{{ */\n#include <bits/stdc++.h>\nusing namespace std;\n\nnamespace solver {\n\n#define GET_MACRO(a, b, c, d, NAME, ...) NAME\n#define REP1(n) REP2(i_, n)\n#define REP2(i, n) REP3(i, 0, n)\n#define REP3(i, a, b) REP4(i, a, b, 1)\n#define REP4(i, a, b, s) for (ll i = (a); i < (ll)(b); i += (ll)(s))\n#define RREP1(n) RREP2(i_, n)\n#define RREP2(i, n) RREP3(i, 0, n)\n#define RREP3(i, a, b) RREP4(i, a, b, 1)\n#define RREP4(i, a, b, s) for (ll i = (b) - 1; i >= (ll)(a); i -= (ll)(s))\n#define rep(...) GET_MACRO(__VA_ARGS__, REP4, REP3, REP2, REP1)(__VA_ARGS__)\n#define rrep(...) GET_MACRO(__VA_ARGS__, RREP4, RREP3, RREP2, RREP1)(__VA_ARGS__)\n#define each(x, c) for (auto &&x : c)\n#define all(c) std::begin(c), std::end(c)\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing uint = unsigned int;\nusing ld = long double;\ntemplate<typename T>\nusing MinPQ = priority_queue<T, vector<T>, greater<T>>;\ntemplate<typename T>\nusing MaxPQ = priority_queue<T, vector<T>, less<T>>;\ntemplate<bool cond, typename T = void>\nusing enable_if_t = typename enable_if<cond, T>::type;\n\nconst int INF = 1e9 + 10;\nconst ll INF_LL = 1e18 + 10;\nconst double INF_D = 1e12;\nconst ld INF_LD = 1e24;\nconst ld EPS = 1e-8;\nconst ld PI = acos(-1.0l);\nconst int dx[] = {-1, 0, 1, 0, -1, 1, 1, -1};\nconst int dy[] = {0, -1, 0, 1, -1, -1, 1, 1};\n\ntemplate<typename T>\ninline T sq(const T &x){ return x * x; }\ntemplate<typename T, typename U>\ninline T &chmin(T &x, const U &y){ if (x > y) x = y; return x; }\ntemplate<typename T, typename U>\ninline T &chmax(T &x, const U &y){ if (x < y) x = y; return x; }\n\nll gcd(ll a, ll b){ return b ? gcd(b, a % b) : a; }\nll lcm(ll a, ll b){ return a / gcd(a, b) * b; }\ntuple<ll, ll, ll> extgcd(ll a, ll b){\n  if (b == 0) return make_tuple(a, 1, 0);\n  ll g, x, y;\n  tie(g, x, y) = extgcd(b, a % b);\n  return make_tuple(g, y, x - a / b * y);\n}\nll invmod(ll a, ll m = 1000000007){\n  ll g, x;\n  tie(g, x, ignore) = extgcd(a, m);\n  return g == 1 ? (x + m) % m : 0;\n}\n\nvoid solve();\n\n}\n\nsigned main(){\n  auto begin = std::chrono::high_resolution_clock::now();\n  std::ios::sync_with_stdio(false);\n  std::cin.tie(nullptr);\n  std::cout << std::fixed << std::setprecision(12);\n  solver::solve();\n  auto end = std::chrono::high_resolution_clock::now();\n  auto time = std::chrono::duration_cast<std::chrono::milliseconds>(end - begin);\n#ifdef DEBUG\n  std::cerr << \"time: \" << time.count() << \" [ms]\" << std::endl;\n#endif\n}\n\nnamespace solver {\n/* }}} */\n\nvector<pair<string, ll>> s[3];\n\nvector<pair<string, ll>> input(){\n  vector<pair<string, ll>> v;\n  while (true){\n    string c;\n    ll l;\n    cin >> c;\n    if (c == \"$\") break;\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n  return v;\n}\n\nvoid solve(){\n  rep(i, 3) s[i] = input();\n  rep(i, s[0].size()){\n    if (i + s[1].size() > s[0].size()) continue;\n    if (s[1].size() == 1){\n      if (s[0][i].first == s[1][0].first && s[0][i].second >= s[1][0].second){\n        s[0][i].second -= s[1][0].second;\n        s[0].insert(begin(s[0]) + i, all(s[2]));\n        break;\n      }\n    }\n    else {\n      bool match = true;\n      match &= s[0][i].first == s[1][0].first;\n      match &= s[0][i].second >= s[1][0].second;\n      match &= s[0][i + s[1].size() - 1].first == s[1].back().first;\n      match &= s[0][i + s[1].size() - 1].second >= s[1].back().second;\n      rep(j, 1, s[1].size() - 1) match &= s[0][i + j] == s[1][j];\n      if (match){\n        rep(j, s[1].size()) s[0][i + j].second -= s[1][j].second;\n        s[0].insert(begin(s[0]) + i + 1, all(s[2]));\n        break;\n      }\n    }\n  }\n  rep(i, s[0].size()){\n    if (s[0][i].second == 0) s[0].erase(begin(s[0]) + i);\n  }\n  rep(i, s[0].size() - 1){\n    if (s[0][i].first == s[0][i + 1].first){\n      s[0][i].second += s[0][i + 1].second;\n      s[0].erase(begin(s[0]) + i + 1);\n      i--;\n    }\n  }\n  each(p, s[0]) cout << p.first << \" \" << p.second << \" \";\n  cout << \"$\\n\";\n}\n\n} /* namespace solver */"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing P=pair<char,int>;\n\nint main(){\n    vector<P> A,B,C;\n    char c;\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        A.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        B.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        C.emplace_back(c,l);\n    }\n    vector<P> ans;\n    for(int i=0;i<A.size();i++){\n        if(A[i].first==B.front().first&&A[i].second>=B.front().second){\n            bool flag=true;\n            if(i+B.size()<=A.size()){\n                for(int d=1;d<B.size();d++){\n                    if(A[i+d].first!=B[d].first){\n                        flag=false;\n                        break;\n                    }\n                    if(d!=B.size()-1){\n                        if(A[i+d].second!=B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }else{\n                        if(A[i+d].second<B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }\n                }\n            }else{\n                continue;\n            }\n            if(flag){\n                if(B.size()==1){\n                    for(int j=0;j<i;j++) ans.push_back(A[i]);\n                    for(auto p:C) ans.push_back(p);\n                    if(A[i].second>B[0].second){\n                        ans.emplace_back(B[0].first,A[i].second-B[0].second);\n                    }\n                    for(int j=i+1;j<A.size();j++) ans.push_back(A[j]);\n                }else{\n                    if(A[i].second>B[0].second){\n                        ans.emplace_back(B[0].first,A[i].second-B[0].second);\n                    }\n                    for(auto p:C) ans.push_back(p);\n                    if(A[i+B.size()-1].second>B.back().second){\n                        ans.emplace_back(B.back().first, A[i+B.size()-1].second-B.back().second);\n                    }\n                    for(int j=i+B.size();j<A.size();j++) ans.push_back(A[j]);\n                }\n\n                for(int i=0;i<ans.size()-1;i++){\n                    if(ans[i].first==ans[i+1].first){\n                        ans[i].second+=ans[i+1].second;\n                        ans[i+1].second=0;\n                    }\n                }\n                for(auto p:ans){\n                    char c; int l;\n                    tie(c,l)=p;\n                    if(l) cout<<c<<' '<<l<<' ';\n                }\n                cout<<'$'<<endl;\n                /*\n                {\n                    bool b=true;\n                    for(int i=0;i<A.size();i++){\n                        if(A[i]!=B[i]){\n                            cout<<i<<' '<<A[i].first<<' '<<A[i].second<<' '<<B[i].first<<' '<<B[i].second<<endl;\n                        }\n                    }\n                    cout<<b<<endl;\n                }*/\n                \n                // cout<<A.size()<<endl;\n                // cout<<B.size()<<endl;\n                // cout<<C.size()<<endl;\n                // cout<<ans.size()<<endl;\n                 \n                return 0;\n            }\n        }   \n    }\n    for(auto p:A){\n        char c; int l;\n        tie(c,l)=p;\n        cout<<c<<' '<<l<<' ';\n    }\n    cout<<'$'<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\ntypedef pair<char, int> P;\n\nint main()\n{\n    int len[3];\n    vector<P> X[3];\n    for (int i = 0; i < 3; i++) {\n        char c;\n        int l;\n        while (cin >> c, c != '$') {\n            cin >> l;\n            X[i].push_back(P(c, l));\n        }\n        len[i] = X[i].size();\n    }\n    for (int i = 0; i < len[0]; i++) {\n        if (i+len[1] > len[0]) {\n            continue;\n        }\n        bool same = 1;\n        for (int j = i; j < i+len[1]; j++) {\n            if (X[1][j-i].first != X[0][j].first) {\n                same = 0;\n                break;\n            }\n        }\n        bool update = 1;\n        if (same) {\n            for (int j = i+1; j < i+len[1]-1; j++) {\n                if (X[1][j-i].second != X[0][j].second) {\n                    update = 0;\n                    break;\n                }\n            }\n            vector<P> v, res;\n            for (int j = 0; j < i; j++) {\n                v.push_back(X[0][j]);\n            }\n            int diff = X[0][i].second - X[1][0].second;\n            if (diff > 0) {\n                v.push_back(P(X[0][i].first, diff));\n            }\n            for (int j = 0; j < len[2]; j++) {\n                v.push_back(X[2][j]);\n            }\n            diff = X[0][i+len[1]-1].second - X[1][len[1]-1].second;\n            if (diff > 0) {\n                v.push_back(P(X[0][i+len[1]-1].first, diff));\n            }\n            for (int j = i+len[1]; j < len[0]; j++) {\n                v.push_back(X[0][j]);\n            }            \n\n            for (int j = 0; j < (int)v.size(); ) {\n                int k = j, sum = 0;\n                while (k < (int)v.size() &&\n                       v[j].first == v[k].first) {\n                    sum += v[k].second;\n                    k++;\n                }\n                res.push_back(P(v[j].first, sum));\n                j = k;\n            }\n            \n            for (int j = 0; j < (int)res.size(); j++) {\n                cout << res[j].first << \" \" << res[j].second << \" \";\n            }\n            cout << \"$\" << endl;\n        }\n        if (update) {\n            break;\n        }\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\nusing namespace std;\nstring s; int x; vector<pair<string, int> > a, b, c;\nvector<pair<string, int> > shift(vector<pair<string, int> > v) {\n\tvector<pair<string, int> > ret;\n\tint p = 0, sum = v[0].second;\n\tfor (int i = 1; i <= v.size(); i++) {\n\t\tif (i == v.size() || v[i - 1].first != v[i].first) {\n\t\t\tif (sum > 0) ret.push_back(make_pair(v[i - 1].first, sum));\n\t\t\tsum = 0;\n\t\t}\n\t\tif (i != v.size()) sum += v[i].second;\n\t}\n\treturn ret;\n}\nint main() {\n\twhile (cin >> s, s != \"$\") cin >> x, a.push_back(make_pair(s, x));\n\twhile (cin >> s, s != \"$\") cin >> x, b.push_back(make_pair(s, x));\n\twhile (cin >> s, s != \"$\") cin >> x, c.push_back(make_pair(s, x));\n\tfor (int i = 0; i <= (int)(a.size() - b.size()); i++) {\n\t\tbool ok = true;\n\t\tfor (int j = 0; j < b.size(); j++) {\n\t\t\tif (a[i + j].first != b[j].first) ok = false;\n\t\t}\n\t\tfor (int j = 2; j < b.size(); j++) {\n\t\t\tif (a[i + j - 1].second != b[j - 1].second) ok = false;\n\t\t}\n\t\tif (a[i].second < b[0].second) ok = false;\n\t\tif (a[i + b.size() - 1].second < b[b.size() - 1].second) ok = false;\n\t\tif (ok) {\n\t\t\tvector<pair<string, int> > d(a.begin(), a.begin() + i);\n\t\t\td.push_back(make_pair(a[i].first, a[i].second - b[0].second));\n\t\t\td.insert(d.end(), c.begin(), c.end());\n\t\t\td.push_back(make_pair(a[i + b.size() - 1].first, a[i + b.size() - 1].second - b[b.size() - 1].second));\n\t\t\td.insert(d.end(), a.begin() + i + b.size(), a.end());\n\t\t\ta = shift(d);\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor (int i = 0; i < a.size(); i++) cout << a[i].first << ' ' << a[i].second << ' ';\n\tcout << \"$\" << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\n//const int INF = 1e8;\nusing namespace std;\n\n#define int long long\n\nstruct Data{\n\tchar c;\n\tint n;\n\tData(char c, int n) : c(c), n(n) {}\n};\n\nvoid parser(vector<Data>& a){\n\tchar chr;\n\tint num;\n\twhile(cin >> chr, chr != '$'){\n\t\tcin >> num;\n\t\ta.emplace_back(chr, num);\n\t}\n}\n\nvector<Data> a, b, c, ans;\n\nbool canReplace(int idx){\n\trep(i,b.size()){\n\t\tif(a[i + idx].c != b[i].c) return false;\n\t\tif(i == 0 or i == b.size() - 1){\n\t\t\tif(a[i + idx].n < b[i].n) return false;\n\t\t}else{\n\t\t\tif(a[i + idx].n != b[i].n) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\nsigned main(){\n\tparser(a);\n\tparser(b);\n\tparser(c);\n\n\trep(i,a.size() - b.size() + 1){\n\t\tif(canReplace(i)){\n\t\t\trep(j,i) ans.emplace_back(a[j]);\n\t\t\tif(b.size() > 1){\n\t\t\t\ta[i].n -= b[0].n;\n\t\t\t\tif(a[i].n > 0) ans.emplace_back(a[i]);\n\t\t\t}\n\t\t\trep(j,c.size()) ans.emplace_back(c[j]);\n\n\t\t\ta[i + b.size() - 1].n -= b.back().n;\n\t\t\tif(a[i + b.size() - 1].n > 0) ans.emplace_back(a[i + b.size() - 1]);\n\t\t\trange(j,i + b.size(), a.size()) ans.emplace_back(a[j]);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif(ans.empty()) ans = a;\n\n\trep(i,ans.size()){\n\t\tif(i + 1 < ans.size() and ans[i + 1].c == ans[i].c){\n\t\t\tans[i + 1].n += ans[i].n;\n\t\t}else{\n\t\t\tcout << ans[i].c << ' ' << ans[i].n << ' ';\n\t\t}\n\t}\n\tcout << '$' << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\nusing namespace std;\nstring s; int x; vector<pair<string, int> > a, b, c;\nvector<pair<string, int> > shift(vector<pair<string, int> > v) {\n\tvector<pair<string, int> > w;\n\tfor (int i = 0; i < v.size(); i++) {\n\t\tif (v[i].second > 0) w.push_back(v[i]);\n\t}\n\tv = w;\n\tvector<pair<string, int> > ret;\n\tint sum = v[0].second;\n\tfor (int i = 1; i <= v.size(); i++) {\n\t\tif (i == v.size() || v[i - 1].first != v[i].first) {\n\t\t\tret.push_back(make_pair(v[i - 1].first, sum));\n\t\t\tsum = 0;\n\t\t}\n\t\tif (i != v.size()) sum += v[i].second;\n\t}\n\treturn ret;\n}\nint main() {\n\twhile (cin >> s, s != \"$\") cin >> x, a.push_back(make_pair(s, x));\n\twhile (cin >> s, s != \"$\") cin >> x, b.push_back(make_pair(s, x));\n\twhile (cin >> s, s != \"$\") cin >> x, c.push_back(make_pair(s, x));\n\tfor (int i = 0; i <= (int)(a.size() - b.size()); i++) {\n\t\tbool ok = true;\n\t\tfor (int j = 0; j < b.size(); j++) {\n\t\t\tif (a[i + j].first != b[j].first) ok = false;\n\t\t}\n\t\tfor (int j = 2; j < b.size(); j++) {\n\t\t\tif (a[i + j - 1].second != b[j - 1].second) ok = false;\n\t\t}\n\t\tif (a[i].second < b[0].second) ok = false;\n\t\tif (a[i + b.size() - 1].second < b[b.size() - 1].second) ok = false;\n\t\tif (ok) {\n\t\t\tvector<pair<string, int> > d(a.begin(), a.begin() + i);\n\t\t\tif(b.size() != 1) d.push_back(make_pair(a[i].first, a[i].second - b[0].second));\n\t\t\td.insert(d.end(), c.begin(), c.end());\n\t\t\td.push_back(make_pair(a[i + b.size() - 1].first, a[i + b.size() - 1].second - b[b.size() - 1].second));\n\t\t\td.insert(d.end(), a.begin() + i + b.size(), a.end());\n\t\t\ta = shift(d);\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor (int i = 0; i < a.size(); i++) cout << a[i].first << ' ' << a[i].second << ' ';\n\tcout << \"$\" << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define f first\n#define s second\n#define mp make_pair\nusing namespace std;\n\nint main()\n{\n  vector<pair<char,long long> > A,B,C;\n  char c;\n  int a;\n\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    A.push_back(mp(c,a));\n  }\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    B.push_back(mp(c,a));\n  }\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    C.push_back(mp(c,a));\n  }\n\n  int size=A.size()-B.size()+1;\n  for(int i=0;i<=size;i++){\n    bool flag=true;\n    for(int j=0;j<B.size();j++){\n      if(j==0 || j==B.size()-1){\n\tif(A[i+j].f!=B[j].f || A[i+j].s<B[j].s)flag=false;\n      }\n      else {\n\tif(A[i+j].f!=B[j].f || A[i+j].s!=B[j].s)flag=false;\n      }\n    }\n    if(flag){\n      for(int j=0;j<B.size();j++)A[i+j].s-=B[j].s;\n\n      if(B.size()==1)A.insert(A.begin()+i,C.begin(),C.end());\n      else A.insert(A.begin()+i+1,C.begin(),C.end());\n\n      size+=C.size();\n      for(int j=0;j<A.size();j++){\n\tif(A[j].s==0){\n\t  A.erase(A.begin()+j);\n\t  j--;\n\t  size--;\n\t}\n      }\n      for(int j=1;j<A.size();j++){\n\tif(A[j].f==A[j-1].f){\n\t  A[j-1].s+=A[j].s;\n\t  A.erase(A.begin()+j);\n\t  j--;\n\t  size--;\n\t}\n      }\n      i--;\n    }\n  }\n\n  for(int j=0;j<A.size();j++)cout<<A[j].f<<\" \"<<A[j].s<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define s second\n#define f first\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\nvector<P> A[3],ans;\nll len[3];\n\nint main(){\n  char c;\n  ll n;\n  for(int i=0;i<3;i++){\n    while(cin>>c,c!='$')\n      cin>>n,A[i].push_back(P(c,n));\n    len[i]=A[i].size();\n  }\n  int F=0;\n  for(int i=0;i<len[0];i++){\n    if(i>len[0]-len[1]&&A[0][i].s){\n      ans.push_back(A[0][i]);\n      continue;\n    }\n    int flag=0;\n    for(int j=0;j<len[1];j++){\n      ll a=A[0][i+j].s,b=A[1][j].s;\n      if(A[0][i+j].f!=A[1][j].f)flag=1;\n      if(!j&&a<b)flag=1;\n      if(j&&j!=len[1]-1&&a!=b)flag=1;\n      if(j==len[1]-1&&a<b)flag=1;\n    }\n    if(!F&&!flag){\n      F=1;\n      if(A[0][i].s>A[1][0].s&&len[1]!=1)\n\tans.push_back(P(A[1][0].f,A[0][i].s-A[1][0].s));\n      for(int j=0;j<len[2];j++)\n\tans.push_back(A[2][j]);\n      A[0][i+len[1]-1].s-=A[1][len[1]-1].s;\n      i+=len[1]-2;\n    }else if(A[0][i].s)ans.push_back(A[0][i]);\n  }\n  char ch=ans[0].f;\n  ll sum=ans[0].s;\n  for(int i=1;i<ans.size();i++){\n    if(ch==ans[i].f)sum+=ans[i].s;\n    else cout<<ch<<' '<<sum<<' ',ch=ans[i].f,sum=ans[i].s;\n  }\n  cout<<ch<<' '<<sum<<\" $\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define f first\n#define s second\n#define mp make_pair\nusing namespace std;\n\nint main()\n{\n  vector<pair<char,long long> > A,B,C;\n  char c;\n  int a;\n\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    A.push_back(mp(c,a));\n  }\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    B.push_back(mp(c,a));\n  }\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    C.push_back(mp(c,a));\n  }\n\n  int size=A.size()-B.size()+1;\n  for(int i=0;i<size;i++){\n    bool flag=true;\n    for(int j=0;j<B.size();j++){\n      if(j==0 || j==B.size()-1){\n\tif(A[i+j].f!=B[j].f || A[i+j].s<B[j].s)flag=false;\n      }\n      else {\n\tif(A[i+j].f!=B[j].f || A[i+j].s!=B[j].s)flag=false;\n      }\n    }\n    if(flag){\n      for(int j=0;j<B.size();j++)A[i+j].s-=B[j].s;\n\n      if(B.size()==1)A.insert(A.begin()+i,C.begin(),C.end());\n      else A.insert(A.begin()+i+1,C.begin(),C.end());\n\n      size+=C.size();\n      for(int j=0;j<A.size();j++){\n\tif(A[j].s==0){\n\t  A.erase(A.begin()+j);\n\t  j--;\n\t  size--;\n\t}\n      }\n      for(int j=1;j<A.size();j++){\n\tif(A[j].f==A[j-1].f){\n\t  A[j-1].s+=A[j].s;\n\t  A.erase(A.begin()+j);\n\t  j--;\n\t  size--;\n\t}\n      }\n      break;\n    }\n  }\n\n  for(int j=0;j<A.size();j++)cout<<A[j].f<<\" \"<<A[j].s<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\n#define F first\n#define S second\ntypedef long long ll;\ntypedef pair<char, ll> P;\n\nint main()\n{\n    ll len[3];    \n    vector<P> X[3];\n    for (int i = 0; i < 3; i++) {\n        char c;\n        ll l;\n        while (cin >> c, c != '$') {\n            cin >> l;\n            X[i].push_back(P(c, l));\n        }\n        len[i] = X[i].size();\n    }\n    for (int i = 0; i <= len[0]-len[1]; i++) {\n        bool same = 1;\n        for (int j = i; j < i+len[1]; j++) {\n            if (X[1][j-i].F != X[0][j].F ||\n                (i < j && j < i+len[1]-1 && X[1][j-i].S != X[0][j].S)) {\n                same = 0;\n                break;\n            }\n        }\n        if (X[0][i].S < X[1][0].S || X[0][i+len[1]-1].S < X[1][len[1]-1].S) {\n            continue;\n        }\n\n        if (same) {\n            vector<P> v, res;\n            for (int j = 0; j < i; j++) {\n                v.push_back(X[0][j]);\n            }\n            ll diff = X[0][i].S - X[1][0].S;\n            if (len[1] != 1) {\n                if (diff > 0) {\n                    v.push_back(P(X[0][i].F, diff));      \n                }\n                for (int j = 0; j < len[2]; j++) {\n                    v.push_back(X[2][j]);\n                }\n                diff = X[0][i+len[1]-1].S - X[1][len[1]-1].S;\n                if (diff > 0) {\n                    v.push_back(P(X[0][i+len[1]-1].F, diff));\n                }\n            } else {\n                for (int j = 0; j < len[2]; j++) {\n                    v.push_back(X[2][j]);\n                }                \n                if (diff > 0) {\n                    v.push_back(P(X[0][i].F, diff));   \n                }\n            }\n            for (int j = i+len[1]; j < len[0]; j++) {\n                v.push_back(X[0][j]);\n            }\n            \n            for (int j = 0; j < (int)v.size(); ) {\n                ll k = j, sum = 0;\n                while (k < (ll)v.size() &&\n                       v[j].F == v[k].F) {\n                    sum += v[k].S;\n                    k++;\n                }\n                res.push_back(P(v[j].F, sum));\n                j = k;\n            }\n            X[0] = res;\n            break;\n        }\n    }\n    for (int i = 0; i < X[0].size(); i++) {\n        cout << X[0][i].F << \" \" << X[0][i].S << \" \";\n    }\n    cout << \"$\" << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#include<cctype>\n#include<math.h>\n#include<string>\n#include<string.h>\n#include<stack>\n#include<queue>\n#include<vector>\n#include<utility>\n#include<set>\n#include<map>\n#include<stdlib.h>\n#include<iomanip>\n\nusing namespace std;\n\n#define ll long long\n#define ld long double\n#define EPS 0.0000000001\n#define INF 1e9\n#define LINF (ll)INF*INF\n#define MOD 1000000007\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define loop(i,a,n) for(int i=a;i<(n);i++)\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n\n#define int ll //!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\ntypedef vector<pii> vp;\n\nint gcd(int a, int b){\n    if(b==0) return a;\n    return gcd(b,a%b);\n}\nint lcm(int a, int b){\n    return a*b/gcd(a,b);\n}\n\nvp in(){\n    vp ret;\n    string s;\n    while(cin >> s, s != \"$\"){\n        int a;\n        cin >> a;\n        ret.push_back(pii(s[0],a));\n    }\n    return ret;\n}\nvoid print(vp a){\n    cout << endl;\n    rep(i,a.size())cout << char(a[i].first) << \" \" << a[i].second << endl;\n}\n\nsigned main(void) {\n    int i,j;\n    vp a,b,c;\n    a = in();\n    b = in();\n    c = in();\n    vp t;\n    bool ans = true;\n    rep(i,a.size()){\n        bool p = true;\n        rep(j,b.size()){\n            if(j == 0 || j == b.size()-1){\n                if(a[i+j].first != b[j].first || a[i+j].second < b[j].second){\n                    p = false;\n                }\n            }else{\n                if(a[i+j].first != b[j].first || a[i+j].second != b[j].second){\n                    p = false;\n                }\n            }\n        }\n        if(p && ans){\n            a[i+b.size()-1].second -= b.back().second;\n            if(b.size() > 1 && a[i].second-b[0].second){\n                if(t.size() && t.back().first == a[i].first) t.back().second += a[i].second-b[0].second;\n                else t.push_back(pii(a[i].first,a[i].second-b[0].second));\n            }\n            rep(j,c.size()){\n                if(t.size() && t.back().first == c[j].first){\n                    t.back().second += c[j].second;\n                }else{\n                    t.push_back(c[j]);\n                }\n            }\n            ans = false;\n            i += b.size()-2;\n        }else{\n            if(t.size() && t.size() && t.back().first == a[i].first){\n                t.back().second += a[i].second;\n            }else if(a[i].second){\n                t.push_back(a[i]);\n            }\n        }\n    }\n\n    rep(i,t.size()){\n        cout << char(t[i].first) << \" \" << t[i].second << \" \";\n    }\n    cout << \"$\" << endl;\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\nint main(){\n  vector <P> a,b,c;\n  ll i,j,k;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    a.push_back(P(ch,k));\n  }\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    b.push_back(P(ch,k));\n  }\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    c.push_back(P(ch,k));\n  }\n  if(b.size()==1){\n    for(i=0;i+b.size()<=a.size();i++){\n      if(a[i].first!=b[0].first||a[i].second<b[0].second) continue;\n      a[i].second-=b[0].second;\n      a.insert(a.begin()+i,c.begin(),c.end());\n      break;\n    }\n  }else{\n    for(i=0;i+b.size()<=a.size();i++){\n      if(a[i].first!=b[0].first||a[i].second<b[0].second) continue;\n      bool f = true;\n      k=b.size()-1;\n      for(j=1;j<k;j++){\n\tif(a[i+j].first!=b[j].first||a[i+j].second!=b[j].second) {\n\t  f=false;\n\t  break;\n\t}\n      }\n      if(a[i+k].first!=b[k].first||a[i+k].second<b[k].second) continue;\n      if(f){\n\t//cout << i << endl;\n\tfor(j=0;j<k+1;j++){\n\t  a[i+j].second-=b[j].second;\n\t}\n\ta.insert(a.begin()+i+1,c.begin(),c.end());\n\t//i+=b.size()+c.size()-1;\n\tbreak;\n      }\n    }\n  }\n\n  bool ff=true;\n  while(ff){\n    ff=false;\n    k=0;\n    while(k<a.size()){\n      if(a[k].second==0) {\n\ta.erase(a.begin()+k);\n\tff=true;\n      }else k++;\n    }\n    for(i=0;i<a.size()-1;i++){\n      if(a[i].first==a[i+1].first){\n\ta[i+1].second+=a[i].second;\n\ta[i].second=0;\n      }\n    }\n  }\n  \n  for(i=0;i<a.size();i++){\n    if(a[i].second==0) continue;\n    cout << a[i].first << \" \" << a[i].second << \" \";\n  }\n  cout << \"$\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstruct RLEchar{\n    char x;\n    int len;\n};\n\nusing RLE=vector<RLEchar>;\nistream& operator>>(istream& in,RLE& rle){\n    char c;\n    while(cin>>c,c!='$'){\n        int l; cin>>l;\n        rle.push_back(RLEchar{c,l});\n    }\n    return in;\n}\nostream& operator<<(ostream& out,RLE rle){\n    for(int i=0;i<rle.size();i++){\n        out<<rle[i].x<<\" \"<<rle[i].len<<\" \";\n    }\n    out<<\"$\";\n    return out;\n}\n\nvoid shrink(RLE &rle){\n    RLE res;\n    for(int i=0;i<rle.size();i++){\n        if(rle[i].len==0) continue;\n        else if(res.size()==0) res.push_back(rle[i]);\n        else if(res.back().x!=rle[i].x) res.push_back(rle[i]);\n        else res.back().len+=rle[i].len;\n    }\n    rle=res;\n}\n\nvoid replace(RLE& a,RLE b,RLE c){\n    for(int i=0;i+b.size()<=a.size();i++){\n        if(b.size()==1){\n            if(a[i].x==b[0].x && a[i].len>=b[0].len){\n                RLE tmp;\n                for(int j=0;j<i;j++){\n                    tmp.push_back(a[j]);\n                }\n                tmp.push_back(RLEchar{a[i].x,a[i].len-b[0].len});\n                for(int j=0;j<c.size();j++) tmp.push_back(c[j]);\n                for(int j=i+1;j<a.size();j++){\n                    tmp.push_back(a[j]);\n                }\n                a=tmp;\n                break;\n            }\n        }\n        else{\n            bool isok=(a[i].x==b[0].x && a[i].len>=b[0].len);\n            for(int j=1;j+1<b.size();j++){\n                isok&=(a[i+j].x==b[j].x && a[i+j].len==b[j].len);\n            }\n            isok&=(a[i+b.size()-1].x==b.back().x && a[i+b.size()-1].len>=b.back().len);\n            if(isok){\n                RLE tmp;\n                for(int j=0;j<i;j++){\n                    tmp.push_back(a[j]);\n                }\n                tmp.push_back(RLEchar{a[i].x,a[i].len-b[0].len});\n                for(int j=0;j<c.size();j++) tmp.push_back(c[j]);\n                tmp.push_back(RLEchar{a[i+b.size()-1].x,a[i+b.size()-1].len-b.back().len});\n                for(int j=i+b.size();j<a.size();j++){\n                    tmp.push_back(a[j]);\n                }\n                a=tmp;\n                break;\n            }\n        }\n    }\n    shrink(a);\n}\n\nint main(){\n    RLE a,b,c;\n    cin>>a>>b>>c;\n    replace(a,b,c);\n    cout<<a<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\nint main(){\n  vector<char> A_c, B_c, C_c, ans_c;\n  vector<int> A_l, B_l, C_l, ans_l;\n  char c_ = '!';\n  int l;\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    A_c.push_back(c_);\n    A_l.push_back(l);\n  }\n  c_ = '!';\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    B_c.push_back(c_);\n    B_l.push_back(l);\n  }\n  c_ = '!';\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    C_c.push_back(c_);\n    C_l.push_back(l);\n  }\n  int a = A_c.size(), b = B_c.size(), c = C_c.size();\n  bool g = false;\n  for(int i = 0; i < a; ++i){\n    bool f = true;\n    for(int j = 0; j < b; ++j){\n      if(g || i+j >= a){\n        f = false;\n        break;\n      }\n      if((j > 0 && j < b - 1 && A_l[i+j] != B_l[j]) ||\n         (A_c[i+j] != B_c[j]) ||\n         (j%(b-1) == 0 && A_l[i+j] < B_l[j])){\n        f = false;\n        break;\n      }\n    }\n    if(f){\n      g = true;\n      if(A_l[i] - B_l[0] > 0){\n        ans_c.push_back(A_c[i]);\n        ans_l.push_back(A_l[i] - B_l[0]);\n      }\n      for(int j = 0; j < c; ++j){\n        if(ans_c.back() == C_c[j]) ans_l.back() += C_l[j];\n        else{\n          ans_c.push_back(C_c[j]);\n          ans_l.push_back(C_l[j]);\n        }\n      }\n      if(A_l[i+b-1] - B_l.back() > 0){\n        if(ans_c.back() == A_c[i+b-1]) ans_l.back() += A_l[i+b-1] - B_l[b-1];\n        else{\n          ans_c.push_back(A_c[i+b-1]);\n          ans_l.push_back(A_l[i+b-1] - B_l[b-1]);\n        }\n      }\n    }else{\n      if(ans_c.back() == A_c[i]) ans_l.back() += A_l[i];\n      else{\n        ans_c.push_back(A_c[i]);\n        ans_l.push_back(A_l[i]);\n      }\n    }\n    i += b-1;\n  }\n  for(int i = 0; i < ans_c.size(); ++i){\n    cout << ans_c[i] <<  \" \" << ans_l[i] << \" \";\n  }\n  cout << \"$\" << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<queue>\n#include<climits>\n#include<algorithm>\n#include<cstdlib>\n#include<cmath>\n#include<cstring>\n#include<string>\n#include<ctype.h>\n#include<set>\n#include<vector>\n#include<map>\n#include<time.h>\n#include<list>\n#include<stack>\n//#include<iostream>\nusing namespace std;\n#define mod 1000000007\n#define mem(x,k ) memset(x,k,sizeof(x))\n#define mp(A, B) make_pair(A, B)\n#define pb push_back\n#define sca scanf\n#define pri printf\n#define fi first\n#define se second\n\ntypedef long long LL;\ntypedef long double LD;\n\nconst LL INFLL=0x3f3f3f3f3f3f3f3fll;\nconst int INF=0x7fffffff;\nconst double PI=acos(-1.0);\nconst double  eps=1e-9;\nint n,m;\n//freopen(\"D.in\",\"r\",stdin);\n//freopen(\"D.out\",\"w\",stdout);\n//KMP ??×???´??\\?????? O(n+m)\n\n//KMP ×???´??\\?? O(n+m)\nstruct note{\n    int c,g;\n    bool operator==(const note &B)const\n    {\n        return c==B.c&&g==B.g;\n    }\n    bool operator!=(const note &B)const\n    {\n        return c!=B.c||g!=B.g;\n    }\n};\ntypedef note Xchar;\nnote Q,H;\nconst int MAXN = 1003,MAXM = 1003;\nXchar T[MAXN],P[MAXM];\nnote C[MAXN];\nnote ANS[3*MAXN+100];\nint c;\nint Next[MAXM];\nint GETNEXT(Xchar *str,int len,int *next)\n{\n    next[0]=-1;\n\tnext[1]=0;\n    for(int i=1;i<len;i++)\n    {\n        int j=next[i];\n        while(j&&str[i]!=str[j])\n        \tj=next[j];\n        next[i+1]= str[i]==str[j] ?j+1:0;\n    }\n    return len;\n}\n//?????\\??×???´????? T,N£?±??\\??´?£¨??´?£? P,M£??\\??´?£?\nint ans=-1;\nint L,R;\nbool OK(int i,int &L,int &R){\n    if ( i+1 <n&&i-m>=0&&\n        T[i-m].c==Q.c&&T[i-m].g>=Q.g&&T[i+1].c==H.c&&T[i+1].g>=H.g)\n        {   if (T[i-m].g>Q.g) L=i-m; else L=i-m-1;\n            if (T[i+1].g>H.g) R=i+1; else R=i+2;\n            T[i-m].g-=Q.g;\n            T[i+1].g-=H.g;\n            return 1;\n        }\n    return 0;\n}\n\nvoid KMP(Xchar *T,int N,Xchar *P,int M){\n    GETNEXT(P,M,Next);\n\tint i=0,j=0;\n    while(i<N&&j<M){\n\t\tif(T[i]==P[j]||j==-1)i++,j++;\n        \telse j = Next[j];\n\t\tif (j>=M) {\n            if (OK(i-1,L,R)){\n                ans=M;\n                return ;\n            }\n\t\t\tj = Next[j];\n        }\n    }\n    return ;\n}\nchar s[4];\nvoid init(){\n    n=0;m=0;c=0;\n    while (sca(\"%s\",s)&&s[0]!='$'){\n        T[n].c=s[0];\n        sca(\"%d\",&T[n++].g);\n    }\n    while (sca(\"%s\",s)&&s[0]!='$'){\n        P[m].c=s[0];\n        sca(\"%d\",&P[m++].g);\n    }\n    while (sca(\"%s\",s)&&s[0]!='$'){\n        C[c].c=s[0];\n        sca(\"%d\",&C[c++].g);\n    }\n}\nint k=0;\nvoid PR(int l,int r){\n    for (int i=l;i<=r;i++){\n        ANS[k++]=T[i];\n    }\n}\nvoid HB(int l,int r){\n    if (l!=-1)\n    ANS[k++]=T[l];\n    for (int i=0;i<c;i++){\n        ANS[k++]=C[i];\n    }\n    if (r<=n-1)\n    ANS[k++]=T[r];\n}\nvoid doit(){\n    ans=-1;int i;\n    if (m==1){\n        for (i=0;i<n;i++){\n            if (T[i].c==P[0].c&&T[i].g>=P[0].g){\n                if (T[i].g>P[0].g){\n                    R=i;\n                    L=i-1;\n                }else{\n                    L=i-1;\n                    R=i+1;\n                }\n                T[i].g-=P[0].g;\n                ans=1;\n            }\n        }\n    }else\n    if (m==2){\n        for (i=0;i<n-1;i++){\n            if (T[i].c==P[0].c&&T[i].g>=P[0].g&&T[i+1].c==P[1].c&&T[i+1].g>=P[1].g){\n                if (T[i].g>P[0].g) L=i; else L=i-1;\n                if (T[i+1].g>P[1].g) R=i+1; else R=i+2;\n                T[i].g-=P[0].g;\n                T[i+1].g-=P[1].g;\n                ans=2;\n            }\n        }\n    }else{\n        Q=P[0];\n        for (int i=0;i<m-2;i++) P[i]=P[i+1];\n        H=P[m-1];\n        m=m-2;\n        KMP(T,n,P,m);\n    }\n    if (ans==-1){\n        PR(0,n-1);\n        return ;\n    }else{\n        PR(0,L-1);\n        HB(L,R);\n        PR(R+1,n-1);\n        return ;\n    }\n}\nvoid print(){\n    for (int i=0;i<k;i++){\n        while(i<k-1&&ANS[i+1].c==ANS[i].c){\n            ANS[i+1].g+=ANS[i].g;\n            i++;\n        }\n        printf(\"%c %d \",ANS[i].c,ANS[i].g);\n    }\n    pri(\"$\\n\");\n}\nint main(){\n    init();\n    doit();\n    print();\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\n\nvector<P>A,B,C;\nvoid input(vector<P> &a){\n  int num;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin>>num;\n    a.push_back(P(ch,num));\n  }\n}\n\nbool check(int i){\n  int n = A.size();\n  int m = B.size();\n  if(i+m>n) return 0;\n\n  if(A[i].first!=B[0].first||A[i].second<B[0].second)return 0;\n  if(m == 1) return 1;\n\n  int j = 0;\n  for(j++,i++;j<m-1;j++,i++)\n    if(A[i].first!=B[j].first||A[i].second!=B[j].second)return 0;\n  \n  if(A[i].first!=B[j].first||A[i].second<B[j].second)return 0;\n  \n  return 1;\n}\n\nvoid mergePush(vector<P> &res,P a){\n  int c = a.second;\n  char ch = a.first;\n  if(c == 0)return;\n  if(res.size() && res.back().first == ch)res.back().second+=c;\n  else res.push_back(P(ch,c));\n}\n\nvector<P> solve(){\n  vector<P> res;\n  int n = A.size();\n  int m = B.size();\n  int l = C.size();\n  int flg = 0;\n\n  for(int i=0;i<n;i++){\n    if(!check(i)||flg++){mergePush(res,A[i]);continue;}\n    A[i].second -= B[0].second;\n\n    if(m == 1) for(int j=0;j<l;j++) mergePush(res,C[j]);\n    else {\n      mergePush(res,P(A[i].first,A[i].second));   \n      for(int j=0;j<l;j++) mergePush(res,C[j]);\n      A[i+m-1].second -= B.back().second;\n    }\n    i+=m-2;\n  }\n  return res;\n}\n\n\nint main(){\n  input(A),input(B),input(C);\n  vector<P> ans = solve();\n  for(P a:ans) cout<<a.first<<\" \"<<a.second<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define f first\n#define s second\n#define mp make_pair\nusing namespace std;\n\nint main()\n{\n  vector<pair<char,long long> > A,B,C;\n  char c;\n  int a;\n\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    A.push_back(mp(c,a));\n  }\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    B.push_back(mp(c,a));\n  }\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    C.push_back(mp(c,a));\n  }\n\n  int size=A.size()-B.size()+1;\n  for(int i=0;i<size;i++){\n    bool flag=true;\n    for(int j=0;j<B.size();j++){\n      if(j==0 || j==B.size()-1){\n\tif(A[i+j].f!=B[j].f || A[i+j].s<B[j].s)flag=false;\n      }\n      else {\n\tif(A[i+j].f!=B[j].f || A[i+j].s!=B[j].s)flag=false;\n      }\n    }\n    if(flag){\n      for(int j=0;j<B.size();j++)A[i+j].s-=B[j].s;\n\n      if(B.size()==1)A.insert(A.begin()+i,C.begin(),C.end());\n      else A.insert(A.begin()+i+1,C.begin(),C.end());\n\n      size+=C.size();\n      for(int j=0;j<A.size();j++){\n\tif(A[j].s==0){\n\t  A.erase(A.begin()+j);\n\t  j--;\n\t  size--;\n\t}\n      }\n      for(int j=1;j<A.size();j++){\n\tif(A[j].f==A[j-1].f){\n\t  A[j-1].s+=A[j].s;\n\t  A.erase(A.begin()+j);\n\t  j--;\n\t  size--;\n\t}\n      }\n      i--;\n    }\n  }\n\n  for(int j=0;j<A.size();j++)cout<<A[j].f<<\" \"<<A[j].s<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nsigned main() {\n  vector<char> ca;\n  vector<int> la;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      ca.emplace_back(c);\n      la.emplace_back(l);      \n    }\n  }\n\n  vector<char> cb;\n  vector<int> lb;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      cb.emplace_back(c);\n      lb.emplace_back(l);      \n    }\n  }\n\n  vector<char> cc;\n  vector<int> lc;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      cc.emplace_back(c);\n      lc.emplace_back(l);      \n    }\n  }\n\n  int a = ca.size(), b = cb.size(), c = cc.size();\n  vector<char> ansc;\n  vector<int> ansl;  \n  for ( int i = 0; i < a; i++ ) {\n    if ( ca[i] != cb[0] || la[i] < lb[0] ) continue;\n    if ( i+b > a ) continue;\n    if ( ca[i+b-1] != cb[b-1] ||la[i+b-1] < lb[b-1] ) continue;\n    bool flag = true;\n    for ( int j = 1; j < b-1; j++ ) {\n      if ( ca[i+j] != cb[j] ||la[i+j] != lb[j] ) {\n\tflag = false;\n\tbreak;\n      }\n    }\n\n    if ( flag ) {\n      for ( int j = 0; j < i; j++ ) {\n\t// cout << ca[j] << \" \" << la[j] << \" \";\n\tansc.emplace_back(ca[j]);\n\tansl.emplace_back(la[j]);\n      }\n      // cout << ca[i] << \" \" << la[i]-lb[0] << \" \";\n      ansc.emplace_back(ca[i]);\n      ansl.emplace_back(la[i]-lb[0]);      \n      for ( int j = 0; j < c; j++ ) {\n\t// cout << cc[i] << \" \" << lc[j] << \" \";\n\tansc.emplace_back(cc[j]);\n\tansl.emplace_back(lc[j]);\n      }\n      // cout << ca[i+b-1] << \" \" << la[i+b-1]-lb[b-1] << \" \";\n      ansc.emplace_back(ca[i+b-1]);\n      ansl.emplace_back(la[i+b-1]-lb[b-1]);      \n      for ( int j = i+b; j < a; j++ ) {\n\t// cout << ca[j] << \" \" << la[j] << \" \";\n\tansc.emplace_back(ca[j]);\n\tansl.emplace_back(la[j]);\t\n      }\n      break;      \n    }\n  }\n\n  if ( ansc.size() == 0 ) {\n    ansc = ca; ansl = la;    \n  }\n  \n  for ( int i = 0; i < ansc.size(); i++ ) {\n    if ( i < ansc.size()-1 ) {\n      if ( ansc[i] == ansc[i+1] ) {\n\tansl[i+1] += ansl[i];\t\n      } else {\n\tcout << ansc[i] << \" \" << ansl[i] << \" \";\t\n      }\n    } else {\n      cout << ansc[i] << \" \" << ansl[i] << \" \";\t\n    }\n  }\n  cout << '$' << endl;\n  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<char, ll> P;\n\nint main()\n{\n    ll len[3];\n    vector<P> X[3];\n    for (ll i = 0; i < 3; i++) {\n        char c;\n        ll l;\n        while (cin >> c, c != '$') {\n            cin >> l;\n            X[i].push_back(P(c, l));\n        }\n        len[i] = X[i].size();\n    }\n    for (ll i = 0; i < len[0]; i++) {\n        if (i+len[1] > len[0]) {\n            continue;\n        }\n        bool same = 1;\n        for (ll j = i; j < i+len[1]; j++) {\n            if (X[1][j-i].first != X[0][j].first) {\n                same = 0;\n                break;\n            }\n        }\n        bool update = 1;\n        if (same) {\n            for (ll j = i+1; j < i+len[1]-1; j++) {\n                if (X[1][j-i].second != X[0][j].second) {\n                    update = 0;\n                    break;\n                }\n            }\n            vector<P> v, res;\n            for (ll j = 0; j < i; j++) {\n                v.push_back(X[0][j]);\n            }\n            ll diff = X[0][i].second - X[1][0].second;\n            if (diff > 0) {\n                v.push_back(P(X[0][i].first, diff));\n            }\n            for (ll j = 0; j < len[2]; j++) {\n                v.push_back(X[2][j]);\n            }\n            diff = X[0][i+len[1]-1].second - X[1][len[1]-1].second;\n            if (diff > 0) {\n                v.push_back(P(X[0][i+len[1]-1].first, diff));\n            }\n            for (ll j = i+len[1]; j < len[0]; j++) {\n                v.push_back(X[0][j]);\n            }            \n\n            for (ll j = 0; j < (ll)v.size(); ) {\n                ll k = j, sum = 0;\n                while (k < (ll)v.size() &&\n                       v[j].first == v[k].first) {\n                    sum += v[k].second;\n                    k++;\n                }\n                res.push_back(P(v[j].first, sum));\n                j = k;\n            }\n            \n            for (ll j = 0; j < (ll)res.size(); j++) {\n                cout << res[j].first << \" \" << res[j].second << \" \";\n            }\n            cout << \"$\" << endl;\n        }\n        if (update) {\n            break;\n        }\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//created by missever\n\n#include<bits/stdc++.h>\n#define MAX 1000000007\nusing namespace std;\n\nstruct node\n{\n    char c;\n    long long l;\n};\n\nnode a[2005],b[1005],c[1005],d[2005];\nint na,nb,nc,nd;\n\nint main()\n{\n    char e;\n    int i,j,k;\n    while(scanf(\" %c\",&e) && e != '$')\n    {\n        a[na].c = e;\n        scanf(\"%lld\",&a[na++].l);\n    }\n    while(scanf(\" %c\",&e) && e != '$')\n    {\n        b[nb].c = e;\n        scanf(\"%lld\",&b[nb++].l);\n    }\n    while(scanf(\" %c\",&e) && e != '$')\n    {\n        c[nc].c = e;\n        scanf(\"%lld\",&c[nc++].l);\n    }\n    for(i = 0; i <= na - nb; i++)\n    {\n        if(a[i].c != b[0].c || a[i].l < b[0].l) continue;\n        if(nb == 1)\n        {\n            for(nd = 0; nd < i; nd++) d[nd] = a[nd];\n            for(k = 0; k < nc; k++) d[nd++] = c[k];\n            if(a[i].l > b[0].l)\n            {\n                d[nd] = a[i];\n                d[nd++].l -= b[0].l;\n            }\n            for(k = i + 1; k < na; k++) d[nd++] = a[k];\n            break;\n        }\n        else\n        {\n            for(j = 1; j < nb; j++)\n            {\n                if(a[i+j].c != b[j].c || a[i+j].l != b[j].l) break;\n            }\n            if(j >= nb - 1)\n            {\n                if(a[i+nb-1].c == b[nb-1].c && a[i+nb-1].l >= b[nb-1].l)\n                {\n                    for(nd = 0; nd < i; nd++) d[nd] = a[nd];\n                    if(a[i].l > b[0].l)\n                    {\n                        d[nd] = a[i];\n                        d[nd++].l -= b[0].l;\n                    }\n                    for(k = 0; k < nc; k++) d[nd++] = c[k];\n                    if(a[i+nb-1].l > b[nb-1].l)\n                    {\n                        d[nd] = a[i+nb-1];\n                        d[nd++].l -= b[nb-1].l;\n                    }\n                    for(k = i + nb; k < na; k++) d[nd++] = a[k];\n                    break;\n                }\n            }\n        }\n    }\n    if(i <= na - nb)\n    {\n        na = 0;\n        a[na] = d[0];\n        for(i = 1; i < nd; i++)\n        {\n            if(d[i].c == a[na].c) a[na].l += d[i].l;\n            else a[++na] = d[i];\n        }\n        na++;\n    }\n    for(i = 0; i < na; i++) printf(\"%c %lld \",a[i].c,a[i].l);\n    printf(\"$\\n\");\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <deque>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define ALL(v) (v).begin(), (v).end()\n#define LENGTHOF(x) (sizeof(x) / sizeof(*(x)))\n#define AFILL(a, b) fill((int*)a, (int*)(a + LENGTHOF(a)), b)\n#define SQ(x) ((x)*(x))\n#define Mod(x, mod) (((x)+(mod)%(mod))\n#define MP make_pair\n#define PB push_back\n#define Fi first\n#define Se second\n#define INF (1<<29)\n#define EPS 1e-10\n#define MOD 1000000007\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nvoid input_rle(vector<string> &S, vector<int> &I)\n{\n  string c; int l;\n  while(cin >> c, c != \"$\"){\n    S.push_back(c);\n    cin >> l;\n    I.push_back(l);\n  }\n}\n\nint find_rle(vector<string> &A1, vector<int>&A2, vector<string>&B1, vector<int>&B2)\n{\n  int ret = -1;\n  if(A1.size() < B1.size()) return -1;\n  if(B1.size() == 1){\n    rep(i, A1.size()){\n      if(A1[i] == B1[0] && A2[i] >= B2[0]) return i;\n    }\n  }else if(B1.size() == 2){\n    rep(i, A1.size()-1){\n      if(A1[i] == B1[0] && A1[i+1] == B1[1] && A2[i] >= B2[0] && A2[i+1] >= B2[1]) return i;\n    }\n  }else{\n    rep(i, A1.size()-B1.size()+1){\n      if(!(A1[i] == B1[0] && A2[i] >= B2[0]\n\t   && A1[i+B1.size()-1] == B1[B1.size()-1] && A2[i+B1.size()-1] >= B2[B2.size()-1])) continue;\n      for(int j=1;j<B1.size()-1;j++){\n\tif(!(A1[i+j] == B1[j] && A2[i+j] == B2[j])) break;\n\tif(j == B2.size()-2) return i;\n      }\n    }\n  }\n  return ret;\n}\n\nvoid merge(vector<string> &A1, vector<int>&A2)\n{\n  deque<string>D1; \n  deque<int>D2;    \n  int i = 0;\n  while(A2[i] == 0) i++;\n  D1.push_back(A1[i]);  \n  D2.push_back(A2[i]);\n  ++i;\n  for(;i<A1.size();i++){\n    string d1 = D1.back(); \n    int  d2  = D2.back();\n    if(A2[i] == 0) continue;\n    if(d1 == A1[i]){\n      D2.pop_back(); d2 += A2[i];\n      D2.push_back(d2);\n    }else{\n      D1.push_back(A1[i]);\n      D2.push_back(A2[i]);\n    }\n  }\n\n  A1.clear();\n  A1.clear();\n  A1.insert(A1.begin(), D1.begin(), D1.end());\n  A2.insert(A2.begin(), D2.begin(), D2.end());\n}\n\nvoid replace_rle(vector<string> &A1, vector<int>&A2, vector<string>&B1, vector<int>&B2,\n\t      vector<string> &C1, vector<int>&C2, int pos)\n{\n  if(B1.size() == 1){\n    A2[pos] -= B2[0];\n    A1.insert(A1.begin() + pos, C1.begin(), C1.end());\n    A2.insert(A2.begin() + pos, C2.begin(), C2.end());\n  }else{\n    A2[pos] -= B2[0];\n    A2[pos+B2.size()-1] -= B2[B2.size()-1];\n    A1.erase(A1.begin() + pos+1, A1.begin() + pos + B1.size()-1);\n    A2.erase(A2.begin() + pos+1, A2.begin() + pos + B2.size()-1);\n    A1.insert(A1.begin() + pos+1, C1.begin(), C1.end());\n    A2.insert(A2.begin() + pos+1, C2.begin(), C2.end());    \n  }\n}\n\nint main()\n{\n  vector<string>A1, B1, C1;\n  vector<int>A2, B2, C2;\n\n  input_rle(A1, A2);\n  input_rle(B1, B2);\n  input_rle(C1, C2);\n\n  int pos = find_rle(A1, A2, B1, B2);\n\n  //  cout << pos << endl;\n  if(pos != -1){\n    replace_rle(A1, A2, B1, B2, C1, C2, pos);\n    merge(A1, A2);\n  }\n  \n  rep(i, A1.size())\n    cout << A1[i] << \" \" << A2[i] << \" \";\n  cout << \"$\\n\";\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\n#define F first\n#define S second\ntypedef long long ll;\ntypedef pair<char, ll> P;\n\nint main()\n{\n    ll len[3];\n    vector<P> X[3];\n    for (int i = 0; i < 3; i++) {\n        char c;\n        ll l;\n        while (cin >> c, c != '$') {\n            cin >> l;\n            X[i].push_back(P(c, l));\n        }\n        len[i] = X[i].size();\n    }\n    for (int i = 0; i <= len[0]-len[1]; i++) {\n        bool same = 1;\n        for (int j = i; j < i+len[1]; j++) {\n            if (X[1][j-i].F != X[0][j].F &&\n                (i < j && j < i+len[1]-1 && X[1][j-1].S != X[0][j].S)) {\n                same = 0;\n                break;\n            }\n        }\n        if (len[1] == 1) {\n            if (X[0][i].S < X[1][0].S) {\n                continue;\n            }\n        }\n        if (same) {\n            vector<P> v, res;\n            for (int j = 0; j < i; j++) {\n                v.push_back(X[0][j]);\n            }\n            ll diff = X[0][i].S - X[1][0].S;\n            if (len[1] != 1) {\n                if (diff > 0) {\n                    v.push_back(P(X[0][i].F, diff));      \n                }\n                for (int j = 0; j < len[2]; j++) {\n                    v.push_back(X[2][j]);\n                }\n                diff = X[0][i+len[1]-1].S - X[1][len[1]-1].S;\n                if (diff > 0) {\n                    v.push_back(P(X[0][i+len[1]-1].F, diff));\n                }\n                for (int j = i+len[1]; j < len[0]; j++) {\n                    v.push_back(X[0][j]);\n                }            \n            } else {\n                for (int j = 0; j < len[2]; j++) {\n                    v.push_back(X[2][j]);\n                }                \n                if (diff > 0) {\n                    v.push_back(P(X[0][i].F, diff));   \n                }\n                for (int j = i+len[1]; j < len[0]; j++) {\n                    v.push_back(X[0][j]);\n                }               \n            }\n            for (int j = 0; j < (int)v.size(); ) {\n                ll k = j, sum = 0;\n                while (k < (ll)v.size() &&\n                       v[j].F == v[k].F) {\n                    sum += v[k].S;\n                    k++;\n                }\n                res.push_back(P(v[j].F, sum));\n                j = k;\n            }\n            \n            for (int j = 0; j < (int)res.size(); j++) {\n                cout << res[j].F << \" \" << res[j].S << \" \";\n            }\n            cout << \"$\" << endl;\n            break;\n        }\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\n#define F first\n#define S second\ntypedef long long ll;\ntypedef pair<char, ll> P;\n\nint main()\n{\n    bool found = 0;\n    ll len[3];    \n    vector<P> X[3];\n    for (int i = 0; i < 3; i++) {\n        char c;\n        ll l;\n        while (cin >> c, c != '$') {\n            cin >> l;\n            X[i].push_back(P(c, l));\n        }\n        len[i] = X[i].size();\n    }\n    for (int i = 0; i <= len[0]-len[1]; i++) {\n        bool same = 1;\n        for (int j = i; j < i+len[1]; j++) {\n            if (X[1][j-i].F != X[0][j].F ||\n                (i < j && j < i+len[1]-1 && X[1][j-i].S != X[0][j].S)) {\n                same = 0;\n                break;\n            }\n        }\n        if (X[0][i].S < X[1][0].S || X[0][i+len[1]-1].S < X[1][len[1]-1].S) {\n            continue;\n        }\n\n        if (same) {\n            vector<P> v, res;\n            for (int j = 0; j < i; j++) {\n                v.push_back(X[0][j]);\n            }\n            ll diff = X[0][i].S - X[1][0].S;\n            if (len[1] != 1) {\n                if (diff > 0) {\n                    v.push_back(P(X[0][i].F, diff));      \n                }\n                for (int j = 0; j < len[2]; j++) {\n                    v.push_back(X[2][j]);\n                }\n                diff = X[0][i+len[1]-1].S - X[1][len[1]-1].S;\n                if (diff > 0) {\n                    v.push_back(P(X[0][i+len[1]-1].F, diff));\n                }\n            } else {\n                for (int j = 0; j < len[2]; j++) {\n                    v.push_back(X[2][j]);\n                }                \n                if (diff > 0) {\n                    v.push_back(P(X[0][i].F, diff));   \n                }\n            }\n            for (int j = i+len[1]; j < len[0]; j++) {\n                v.push_back(X[0][j]);\n            }\n            \n            for (int j = 0; j < (int)v.size(); ) {\n                ll k = j, sum = 0;\n                while (k < (ll)v.size() &&\n                       v[j].F == v[k].F) {\n                    sum += v[k].S;\n                    k++;\n                }\n                res.push_back(P(v[j].F, sum));\n                j = k;\n            }\n            \n            for (int j = 0; j < (int)res.size(); j++) {\n                cout << res[j].F << \" \" << res[j].S << \" \";\n            }\n            cout << \"$\" << endl;\n            found = 1;\n            break;\n        }\n    }\n    if (!found) {\n        for (int i = 0; i < len[0]; i++) {\n            cout << X[0][i].F << \" \" << X[0][i].S << \" \";\n        }\n        cout << \"$\" << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nint main(){\n    vector<vector<char> > c(4);\n    vector<vector<int> > len(4);\n    for(int i=0; i<3; i++){\n        while(1){\n            char letter;\n            int n;\n            cin >> letter;\n            if(letter == '$') break;\n            cin >> n;\n            c[i].push_back(letter);\n            len[i].push_back(n);\n        }\n    }\n\n    int asize = c[0].size();\n    int bsize = c[1].size();\n    int csize = c[2].size();\n    for(int i=0; i<asize-bsize+1; i++){\n        bool flag = true;\n        for(int j=0; j<bsize; j++){\n            if(c[0][i+j] == c[1][j]){\n                if(j==0 || j==bsize-1){\n                    if(len[0][i+j]<len[1][j]){\n                        flag = false;\n                        break;\n                    }\n                }else{\n                    if(len[0][i+j]!=len[1][j]){\n                        flag = false;\n                        break;\n                    }\n                }\n            }else{\n                flag = false;\n                break;\n            }\n        }\n        if(flag){\n            int s=i;\n            for(int j=0; j<s; j++){\n                c[3].push_back(c[0][j]);\n                len[3].push_back(len[0][j]);\n            }\n            c[3].push_back(c[0][s]);\n            len[3].push_back(len[0][s]-len[1][0]);\n            \n            for(int j=0; j<csize; j++){\n                c[3].push_back(c[2][j]);\n                len[3].push_back(len[2][j]);\n            }\n            c[3].push_back(c[0][s+bsize-1]);\n            len[3].push_back(len[0][s+bsize-1] -len[1].back());\n            for(int j=s+bsize; j<asize; j++){\n                c[3].push_back(c[0][j]);\n                len[3].push_back(len[0][j]);\n            }\n            break;\n        }\n    }\n\n    for(int i=0; i<(int)c[3].size(); i++){\n        int n=len[3][i];\n        for(;i<(int)c[3].size()-1; i++){\n            if(c[3][i]==c[3][i+1]){\n                n+=len[3][i+1];\n            }else{\n                i++;\n                break;\n            }\n        }\n        i--;\n        if(n!=0){\n            cout << c[3][i] << \" \" << n << \" \";\n        }\n    }\n    cout << \"$\" << endl;\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\nusing namespace std;\ntypedef pair<char,int> P;\n\nchar c[3][1000];\nint l[3][1000];\nint si[3];\nvector<P> ans;\n\nint main(){\n\trep(i,3){\n\t\tfor(int j = 0;;j++){\n\t\t\tcin >> c[i][j];\n\t\t\tif(c[i][j] == '$'){\n\t\t\t\tsi[i] = j;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcin >> l[i][j];\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tif(si[0]-i < si[1]) break;\n\t\tif(c[0][i] == c[1][0] && l[0][i] >= l[1][0]){\n\t\t\tif(si[1] == 1){\n\t\t\t\tl[0][i] -= l[1][0];\n\t\t\t\trep(j,i) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t\trep(j,si[2]) ans.push_back(P(c[2][j],l[2][j]));\n\t\t\t\tfor(int j = i; j < si[0]; j++){\n\t\t\t\t\tif(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t\t}\n\t\t\t\tfor(int j = ans.size()-1; j >= 1; j--){\n\t\t\t\t\tif(ans[j].first == ans[j-1].first){\n\t\t\t\t\t\tans[j-1].second += ans[j].second;\n\t\t\t\t\t\tans[j].second = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trep(j,ans.size()){\n\t\t\t\t\tif(ans[j].second == 0) continue;\n\t\t\t\t\tprintf(\"%c %d \",ans[j].first,ans[j].second);\n\t\t\t\t}\n\t\t\t\tputs(\"$\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbool ok = true;\n\t\t\tfor(int j = 1; j < si[1]-1; j++){\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] != l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!ok) continue;\n\t\t\t{\n\t\t\t\tint j = si[1]-1;\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] < l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(!ok) continue;\n\t\t\t\tl[0][i] -= l[1][0];\n\t\t\t\tif(j != 0) l[0][i+j] -= l[1][j];\n\t\t\t}\n\t\t\trep(j,i+1) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\trep(j,si[2]) ans.push_back(P(c[2][j],l[2][j]));\n\t\t\tfor(int j = i+si[1]-1; j < si[0]; j++){\n\t\t\t\tif(si[1] == 1 && j == i+si[1]-1) continue;\n\t\t\t\tif(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t}\n\t\t\tfor(int j = ans.size()-1; j >= 1; j--){\n\t\t\t\tif(ans[j].first == ans[j-1].first){\n\t\t\t\t\tans[j-1].second += ans[j].second;\n\t\t\t\t\tans[j].second = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\trep(j,ans.size()){\n\t\t\t\tif(ans[j].second == 0) continue;\n\t\t\t\tprintf(\"%c %d \",ans[j].first,ans[j].second);\n\t\t\t}\n\t\t\tputs(\"$\");\n\t\t\treturn 0;\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tprintf(\"%c %d \",c[0][i],l[0][i]);\n\t}\n\tputs(\"$\");\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n#include <fstream>\n\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\n#define watch(a) { cout << #a << \" = \" << a << endl; }\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntypedef long long ll;\nint const inf = 1<<29;\n\nvoid change(deque<pair<char, int>>& nv0) {\n  if(nv0.size() > 1 && nv0[nv0.size()-2].first == nv0.back().first) {\n    int k = nv0.back().second;\n    nv0.pop_back();\n    nv0.back().second += k;\n  }\n}\n\nvoid output(deque<pair<char, int>>& out) {\n  rep(i, out.size()) {\n    if(i) cout << \" \";\n    cout << out[i].first << \" \" << out[i].second;\n  }\n  cout << \" $\" << endl;\n}\n\nint main() {\n\n  vector<deque<pair<char, int>>> v(3);\n  for(auto& u: v) {\n    while(1) {\n      char c; cin >> c;\n      if(c == '$') break;\n      int n; cin >> n;\n      u.emplace_back(c, n);\n    }\n  }\n\n  rep(i, (int)v[0].size()-(int)v[1].size()+1) {\n    int j = 0;\n    vector<int> V;\n    while(j < v[1].size() && v[0][i+j].first == v[1][j].first) {\n      if(j == 0 || j == (int)v[1].size()-1) {\n        if(v[0][i+j].second < v[1][j].second) break;\n        V.push_back(v[0][i+j].second - v[1][j].second);\n      }\n      else {\n        if(v[0][i+j].second != v[1][j].second) break;\n      }\n      j++;\n    }\n\n    deque<pair<char, int>> nv0;\n\n    if(j == v[1].size()) {\n      rep(k, v[0].size()) {\n        if(k < i) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n        if(k == i) {\n          if(V[0] > 0) nv0.emplace_back(v[0][i].first, V[0]);\n          rep(l, v[2].size()) {\n            nv0.push_back(v[2][l]);\n            change(nv0);\n          }\n          k = i+v[1].size()-1;\n        }\n        if(k == i+j-1) {\n          if(V[1] > 0) nv0.emplace_back(v[0][i+j-1].first, V[1]);\n          change(nv0);\n        }\n        if(i+j <= k) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n      }\n      v[0] = nv0;\n      i += (int)v[2].size();\n//      i--;\n    }\n  }\n\n  output(v[0]);\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nvoid Output(vector< pair< char, int > >& B)\n{\n  for(int i = B.size() - 1; i > 0; i--) {\n    if(B[i].first == B[i - 1].first) {\n      B[i - 1].second += B[i].second;\n      B[i].second = 0;\n    }\n  }\n  for(int i = 0; i < B.size(); i++) {\n    if(B[i].second > 0) {\n      cout << B[i].first << \" \" << B[i].second << \" \";\n    }\n  }\n  cout << \"$\" << endl; \n  exit(0);\n}\n\n\n  \nint main()\n{\n  vector< pair< char, int > > A[3];\n  vector< pair< char, int > > B;\n  \n  for(int i = 0; i < 3; i++) {\n    char C;\n    while(cin >> C, C != '$') {\n      int D;\n      cin >> D;\n      A[i].emplace_back(C, D);\n    }\n  }\n  \n  if(A[1].size() == 1) {\n    for(int i = 0; i < A[0].size(); i++) {\n      if(A[0][i].first == A[1][0].first && A[0][i].second >= A[1][0].second) {\n        for(int j = 0; j < i; j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        for(int j = 0; j < A[2].size(); j++) {\n          B.emplace_back(A[2][j].first, A[2][j].second);\n        }\n        if(A[0][i].second != A[1][0].second) {\n          B.emplace_back(A[0][i].first, A[0][i].second - A[1][0].second);\n        }\n        for(int j = i + 1; j < A[0].size(); j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        Output(B);\n      }\n    }\n  } else {\n    for(int i = 0; i <= A[0].size() - A[1].size(); i++) {\n      if(A[0][i].first == A[1][0].first && A[0][i].second >= A[1][0].second && A[0][i + A[1].size() - 1].first == A[1].back().first && A[0][i + A[1].size() - 1].second >= A[1].back().second) {\n        bool flag = true;\n        for(int j = 1; j < A[1].size() - 1; j++) {\n          flag &= A[0][i + j] == A[1][j];\n        }\n        if(!flag) continue;\n        for(int j = 0; j < i; j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        if(A[0][i].second != A[1][0].second) {\n          B.emplace_back(A[0][i].first, A[0][i].second - A[1][0].second);\n        }\n        for(int j = 0; j < A[2].size(); j++) {\n          B.emplace_back(A[2][j].first, A[2][j].second);\n        }\n        if(A[0][i + A[1].size() - 1].second != A[1].back().second) {\n          B.emplace_back(A[0][i + A[1].size() - 1].first, A[0][i + A[1].size() - 1].second - A[1].back().second);\n        }\n        for(int j = i + A[1].size(); j < A[0].size(); j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        Output(B);\n      }\n    }\n  }\n  for(int i = 0; i < A[0].size(); i++) {\n    B.emplace_back(A[0][i].first, A[0][i].second);\n  }\n  Output(B);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define fi first\n#define se second\nusing namespace std;\ntypedef pair<string,int> P;\nvector<P>v1,v2,v3;\nint x;\nstring s;\nmain(){\n  while(cin>>s,s!=\"$\")cin>>x,v1.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v2.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v3.push_back(P(s,x));\n  r(i,v1.size())if(v1[i].fi==v2[0].fi&&v1[i].se>=v2[0].se){\n    int flag=0,jj=0,ff=0;\n    r(j,(int)v2.size()-2){\n      jj=j+1;\n      if(i+jj>=v1.size()){flag++;break;}\n      if(v2[jj].se!=v1[i+jj].se||v2[jj].fi!=v1[i+jj].fi)flag++;\n    }\n    if(v2.size()!=1){\n      jj++;\n      if(!flag&&v2[jj].fi==v1[i+jj].fi&&v2[jj].se<=v1[i+jj].se){\n        v1[i].se-=v2[0].se;\n        r(j,v2.size()-2)v1.erase(v1.begin()+i+1);\n        v1[i+1].se-=v2[v2.size()-1].se;\n        r(j,v3.size())v1.insert(v1.begin()+i,v3[j]);\n      }\n      ff++;\n    }\n    else{\n      v1[i].se-=v2[0].se;\n      r(j,v3.size())v1.insert(v1.begin()+i,v3[j]);\n      ff++;\n    }\n    r(j,v1.size())if(v1[j].se==0)v1.erase(v1.begin()+i);\n    r(j,(int)v1.size()-1)if(v1[j].fi==v1[j+1].fi)\n      v1[j].se+=v1[j+1].se,v1.erase(v1.begin()+j+1),j--;\n    r(j,v3.size())i++;\n    if(ff)break;\n  }\n  r(k,v1.size())cout<<v1[k].fi<<' '<<v1[k].se<<' ';\n  cout<<'$'<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nsigned main() {\n  vector<char> ca;\n  vector<int> la;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      ca.emplace_back(c);\n      la.emplace_back(l);      \n    }\n  }\n\n  vector<char> cb;\n  vector<int> lb;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      cb.emplace_back(c);\n      lb.emplace_back(l);      \n    }\n  }\n\n  vector<char> cc;\n  vector<int> lc;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      cc.emplace_back(c);\n      lc.emplace_back(l);      \n    }\n  }\n\n  int a = ca.size(), b = cb.size(), c = cc.size();\n  vector<char> ansc;\n  vector<int> ansl;  \n  for ( int i = 0; i < a; i++ ) {\n    if ( ca[i] != cb[0] || la[i] < lb[0] ) continue;\n    if ( i+b > a ) continue;\n    if ( ca[i+b-1] != cb[b-1] ||la[i+b-1] < lb[b-1] ) continue;\n    bool flag = true;\n    for ( int j = 1; j < b-1; j++ ) {\n      if ( ca[i+j] != cb[j] ||la[i+j] != lb[j] ) {\n\tflag = false;\n\tbreak;\n      }\n    }\n\n    if ( flag ) {\n      if ( b == 1 ) {\n\tfor ( int j = 0; j < i; j++ ) {\n\t  // cout << ca[j] << \" \" << la[j] << \" \";\n\t  ansc.emplace_back(ca[j]);\n\t  ansl.emplace_back(la[j]);\n\t}\n\tfor ( int j = 0; j < c; j++ ) {\n\t  // cout << cc[i] << \" \" << lc[j] << \" \";\n\t  ansc.emplace_back(cc[j]);\n\t  ansl.emplace_back(lc[j]);\n\t}\n\tif ( la[i]-lb[0] >= 1 ) {\n\t  ansc.emplace_back(ca[i]);\n\t  ansl.emplace_back(la[i]-lb[0]);\n\t}\n\tfor ( int j = i+b; j < a; j++ ) {\n\t  // cout << ca[j] << \" \" << la[j] << \" \";\n\t  ansc.emplace_back(ca[j]);\n\t  ansl.emplace_back(la[j]);\t\n\t}\n\tbreak;  \n      } else {\n\tfor ( int j = 0; j < i; j++ ) {\n\t  // cout << ca[j] << \" \" << la[j] << \" \";\n\t  ansc.emplace_back(ca[j]);\n\t  ansl.emplace_back(la[j]);\n\t}\n\t// cout << ca[i] << \" \" << la[i]-lb[0] << \" \";\n\tif ( la[i]-lb[0] >= 1 ) {\n\t  ansc.emplace_back(ca[i]);\n\t  ansl.emplace_back(la[i]-lb[0]);\n\t}\n\tfor ( int j = 0; j < c; j++ ) {\n\t  // cout << cc[i] << \" \" << lc[j] << \" \";\n\t  ansc.emplace_back(cc[j]);\n\t  ansl.emplace_back(lc[j]);\n\t}\n\t// cout << ca[i+b-1] << \" \" << la[i+b-1]-lb[b-1] << \" \";\n\tif ( b > 1 ) {\n\t  if ( la[i+b-1]-lb[b-1] >= 1 ) {\n\t    ansc.emplace_back(ca[i+b-1]);\n\t    ansl.emplace_back(la[i+b-1]-lb[b-1]);\n\t  }\n\t}\n\tfor ( int j = i+b; j < a; j++ ) {\n\t  // cout << ca[j] << \" \" << la[j] << \" \";\n\t  ansc.emplace_back(ca[j]);\n\t  ansl.emplace_back(la[j]);\t\n\t}\n\tbreak;      \n      }\n    }\n  }\n\n  if ( ansc.size() == 0 ) {\n    ansc = ca; ansl = la;    \n  }\n  \n  for ( int i = 0; i < (int)ansc.size(); i++ ) {\n    if ( ansl[i] == 0 ) continue;    \n    if ( i < (int)ansc.size()-1 ) {\n      if ( ansc[i] == ansc[i+1] ) {\n\tansl[i+1] += ansl[i];\t\n      } else {\n\tcout << ansc[i] << \" \" << ansl[i] << \" \";\t\n      }\n    } else {\n      cout << ansc[i] << \" \" << ansl[i] << \" \";\t\n    }\n  }\n  cout << '$' << endl;\n  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\nint main(){\n  vector <P> a,b,c;\n  ll i,j,k;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    a.push_back(P(ch,k));\n  }\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    b.push_back(P(ch,k));\n  }\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    c.push_back(P(ch,k));\n  }\n  for(i=0;i+b.size()<=a.size();i++){\n    if(a[i].first!=b[0].first||a[i].second<b[0].second) continue;\n    bool f = true;\n    k=b.size()-1;\n    for(j=1;j<k;j++){\n      if(a[i+j].first!=b[j].first||a[i+j].second!=b[j].second) {\n\tf=false;\n\tbreak;\n      }\n    }\n    if(a[i+k].first!=b[k].first||a[i+k].second<b[k].second) continue;\n    if(f){\n      //cout << i << endl;\n      for(j=0;j<k+1;j++){\n\ta[i+j].second-=b[j].second;\n      }\n      a.insert(a.begin()+i+1,c.begin(),c.end());\n      break;\n    }\n  }\n\n\n  bool ff=true;\n  while(ff){\n    ff=false;\n    k=0;\n    while(k<a.size()){\n      if(a[k].second==0) {\n\ta.erase(a.begin()+k);\n\tff=true;\n      }else k++;\n    }\n    for(i=0;i<a.size()-1;i++){\n      if(a[i].first==a[i+1].first){\n\ta[i+1].second+=a[i].second;\n\ta[i].second=0;\n      }\n    }\n  }\n  \n  for(i=0;i<a.size();i++){\n    if(a[i].second==0) continue;\n    cout << a[i].first << \" \" << a[i].second << \" \";\n  }\n  cout << \"$\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#include <string>\n#include <cstdio>\n#include <algorithm>\n#include <cstdlib>\n#include <ctype.h>\n#include <cmath>\n#include <stack>\n#include <queue>\n#include <map>\n#include <vector>\n#include <limits.h>\nusing namespace std;\nconst int INF = 0x3f3f3f3f;\nconst int N = 1000+10;\nint ai, bi, ci;\nint m, n;\nint cbegin, cend;\nstruct node{\n\tchar x;\n\tint y;\n}a[N],b[N],c[N],ans[N],bns[N];\nint bj = 0;\nbool flag = true;\nbool dfs(int t, int x){\n\tif(t == 0){\n\t\tif(c[t].x == a[x].x && c[t].y <= a[x].y){\n\t\t\tcbegin = a[x].y - c[t].y;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t}\n\tt++;\n\tx++;\n\tif(t == ci)\treturn true;\n\tfor( ; t < ci; t++,x++){\n\t\tif(t == ci - 1){\n\t\t\tif(c[t].x == a[x].x && c[t].y <= a[x].y){\n\t\t\t\tcend = a[x].y - c[t].y;\n\t\t\t\treturn true;\n\t\t\t}else{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}else{\n\t\t\tif(c[t].x != a[x].x || c[t].x != a[x].x){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\t\n}\n\nvoid print(){\n\tbns[0].x = ans[0].x;\n\tbns[0].y = ans[0].y;\n\tfor(int i = 1; i < ai+bi; i++){\n\t\tif(ans[i].y == 0)\tcontinue;\n\t\tif(ans[i].x == bns[bj].x){\n\t\t\tbns[bj].y += ans[i].y;\n\t\t}else{\n\t\t\tbj++;\n\t\t\tbns[bj].x = ans[i].x;\n\t\t\tbns[bj].y = ans[i].y;\n\t\t}\n\t}\n}\n\nint main(){\n\tstd::ios::sync_with_stdio(false);\n\tai = bi = ci = 0;\n\tchar le;\n\tint num;\n\twhile(1){\n\t\tcin >> le;\n\t\tif(le == '$') \tbreak;\n\t\tcin >> num;\n\t\ta[ai].x = le;\n\t\ta[ai].y = num;\n\t\tai++;\n\t}\n\twhile(1){\n\t\tcin >> le;\n\t\tif(le == '$') \tbreak;\n\t\tcin >> num;\n\t\tc[ci].x = le;\n\t\tc[ci].y = num;\n\t\tci++;\n\t}\n\twhile(1){\n\t\tcin >> le;\n\t\tif(le == '$') \tbreak;\n\t\tcin >> num;\n\t\tb[bi].x = le;\n\t\tb[bi].y = num;\n\t\tbi++;\n\t}\n\tif(ci > ai){\n\t\tfor(int i = 0; i < ai; i++)\n\t\tcout << a[i].x << \" \" << a[i].y << \" \";\n\t\tcout << \"$\" << endl;\n\t\treturn 0; \n\t}\n\tfor(int i = 0; i <= ai-ci; i++){\n\t\tif(dfs(0,i)){\n\t\t\tint j = 0;\n\t\t\tfor(j = 0; j <= i; j++){\n\t\t\t\tif(j == i){\n\t\t\t\t\tans[j].x = a[j].x;\n\t\t\t\t\tans[j].y = cbegin;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tans[j].x = a[j].x;\n\t\t\t\tans[j].y = a[j].y;\n\t\t\t}\n\t\t\tint mm;\n\t\t\tfor(int k = 0; k < bi; k++,j++){\n\t\t\t\t\n\t\t\t\tans[j].x = b[k].x;\n\t\t\t\tans[j].y = b[k].y;\n\t\t\t}\n\t\t\tfor(int k = i+ci-1; k < ai; j++,k++){\n\t\t\t\tif(k == i+ci-1){\n\t\t\t\t\tans[j].x = a[k].x;\n\t\t\t\t\tans[j].y = cend;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tans[j].x = a[k].x;\n\t\t\t\tans[j].y = a[k].y;\n\t\t\t}\n\t\t\tprint();\n\t\t\tfor(int i = 0; i <= bj; i++){\n\t\t\t\tif(!bns[i].y) continue;\n\t\t\t\tcout << bns[i].x << \" \" << bns[i].y << \" \";\n\t\t\t}\n\t\t\tcout << \"$\" << endl;\n\t\t\treturn 0;\n\t\t}\n\t}\n\tfor(int i = 0; i < ai; i++){\n\t\tif(!a[i].y)\tcontinue;\n\t\tcout << a[i].x << \" \" << a[i].y << \" \";\n\t}\n\tcout << \"$\" << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define f first\n#define s second\n#define mp make_pair\nusing namespace std;\n\nint main()\n{\n  vector<pair<char,long long> > A,B,C;\n  char c;\n  int a;\n\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    A.push_back(mp(c,a));\n  }\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    B.push_back(mp(c,a));\n  }\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    C.push_back(mp(c,a));\n  }\n\n  for(int i=0;i<A.size();i++){\n    bool flag=true;\n    for(int j=0;j<B.size();j++){\n      if(j==0 || j==B.size()-1){\n\tif(A[i+j].f!=B[j].f || A[i+j].s<B[j].s)flag=false;\n      }\n      else {\n\tif(A[i+j].f!=B[j].f || A[i+j].s!=B[j].s)flag=false;\n      }\n    }\n    if(flag){\n      for(int j=0;j<B.size();j++){\n\tif(j==0 || j==B.size()-1){\n\t  A[i+j].s-=B[j].s;\n\t}\n\telse A[i+j].s=0;\n      }\n      A.insert(A.begin()+i+1,C.begin(),C.end());\n      break;\n    }\n  }\n  for(int i=0;i<A.size();i++){\n    if(A[i].s==0){\n      A.erase(A.begin()+i);\n      i--;\n    }\n  }\n  for(int i=1;i<A.size();i++){\n    if(A[i].f==A[i-1].f){\n      A[i-1].s+=A[i].s;\n      A.erase(A.begin()+i);\n      i--;\n    }\n  }\n  for(int i=0;i<A.size();i++)cout<<A[i].f<<\" \"<<A[i].s<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\nusing namespace std;\ntypedef pair<char,int> P;\n\nchar c[3][1001];\nint l[3][1001];\nint si[3];\nvector<P> ans;\n\nint main(){\n\trep(i,3){\n\t\tfor(int j = 0;;j++){\n\t\t\tcin >> c[i][j];\n\t\t\tif(c[i][j] == '$'){\n\t\t\t\tsi[i] = j;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcin >> l[i][j];\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tif(si[0]-i < si[1]) break;\n\t\tif(c[0][i] == c[1][0] && l[0][i] >= l[1][0]){\n\t\t\tif(si[1] == 1){\n\t\t\t\tl[0][i] -= l[1][0];\n\t\t\t\trep(j,i) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t\trep(j,si[2]) ans.push_back(P(c[2][j],l[2][j]));\n\t\t\t\tfor(int j = i; j < si[0]; j++){\n\t\t\t\t\tif(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t\t}\n\t\t\t\tfor(int j = ans.size()-1; j >= 1; j--){\n\t\t\t\t\tif(ans[j].first == ans[j-1].first){\n\t\t\t\t\t\tans[j-1].second += ans[j].second;\n\t\t\t\t\t\tans[j].second = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trep(j,ans.size()){\n\t\t\t\t\tif(ans[j].second == 0) continue;\n\t\t\t\t\tprintf(\"%c %d \",ans[j].first,ans[j].second);\n\t\t\t\t}\n\t\t\t\tputs(\"$\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbool ok = true;\n\t\t\tfor(int j = 1; j < si[1]-1; j++){\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] != l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!ok) continue;\n\t\t\t{\n\t\t\t\tint j = si[1]-1;\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] < l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(!ok) continue;\n\t\t\t\tl[0][i] -= l[1][0];\n\t\t\t\tl[0][i+j] -= l[1][j];\n\t\t\t}\n\t\t\trep(j,i+1) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\trep(j,si[2]) ans.push_back(P(c[2][j],l[2][j]));\n\t\t\tfor(int j = i+si[1]-1; j < si[0]; j++){\n\t\t\t\tif(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t}\n\t\t\tfor(int j = ans.size()-1; j >= 1; j--){\n\t\t\t\tif(ans[j].first == ans[j-1].first){\n\t\t\t\t\tans[j-1].second += ans[j].second;\n\t\t\t\t\tans[j].second = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\trep(j,ans.size()){\n\t\t\t\tif(ans[j].second == 0) continue;\n\t\t\t\tprintf(\"%c %d \",ans[j].first,ans[j].second);\n\t\t\t}\n\t\t\tputs(\"$\");\n\t\t\treturn 0;\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tprintf(\"%c %d \",c[0][i],l[0][i]);\n\t}\n\tputs(\"$\");\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <string>\n#include <utility>\n#include <vector>\nusing namespace std;\ntypedef pair<string, int> PSI;\n\nvector<PSI> read_str() {\n    string s; int val;\n    vector<PSI> ret;\n    while(1) {\n        cin >> s;\n        if(s == \"$\") break;\n        cin >> val;\n        ret.push_back(make_pair(s, val));\n    }\n    return ret;\n}\n\nint main() {\n    vector<PSI> A = read_str(), B = read_str(), C = read_str();\n    int L = B.size(), N = A.size();\n\n    for(int l=0; l<N-L+1; l++) {\n        int r = l + L;\n        bool ok = true;\n        for(int k=l; k<r; k++) {\n            int i = k-l;\n            if(A[k].first != B[i].first) ok = false;\n\n            // 端の要素\n            if(k == l || k == r-1) {\n                if(A[k].second < B[i].second) ok = false;\n            }\n            else {\n                if(A[k].second != B[i].second) ok = false;\n            }\n        }\n\n        if(ok) {\n            // replace\n            vector<PSI> tmp, ans;\n            for(int i=0; i<N; i++) {\n                // l == i のときにまとめてやってるから無視\n                if(l < i && i < r) continue;\n                if(r <= i || i < l) {\n                    // 被ってないので普通に入れる\n                    tmp.push_back(A[i]);\n                }\n                else {\n                    if(L != 1) {\n                        int diff = A[l].second - B[0].second;\n                        if(diff > 0) {\n                            PSI nxt1 = make_pair(A[l].first, diff);\n                            tmp.push_back(nxt1);\n                        }\n                    }\n\n                    int M = C.size();\n                    for(int k=0; k<M; k++) {\n                        tmp.push_back(C[k]);\n                    }\n\n                    \n                    int diff = A[l+L-1].second - B[L-1].second;\n                    if(diff > 0) {\n                        PSI nxt2 = make_pair(A[l+L-1].first, diff);\n                        tmp.push_back(nxt2);\n                    }\n                }\n            }\n\n            // 重複してるやつをどうにかする\n            int S = tmp.size();\n            ans.push_back(tmp[0]);\n            for(int i=1; i<S; i++) {\n                if(ans.back().first == tmp[i].first) {\n                    ans.back().second += tmp[i].second;\n                }\n                else {\n                    ans.push_back(tmp[i]);\n                }\n            }\n\n            // こたえ\n            for(auto e : ans) {\n                printf(\"%s %d \", e.first.c_str(), e.second);\n            }\n            printf(\"$\\n\");\n            return 0;\n        }\n    }\n    // マッチしないのでそのまま出す\n    for(auto e : A) {\n        printf(\"%s %d \", e.first.c_str(), e.second);\n    }\n    printf(\"$\\n\");\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\nint main(){\n  vector <P> a,b,c;\n  ll i,j,k;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    a.push_back(P(ch,k));\n  }\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    b.push_back(P(ch,k));\n  }\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    c.push_back(P(ch,k));\n  }\n  for(i=0;i+b.size()<=a.size();i++){\n    if(a[i].first!=b[0].first||a[i].second<b[0].second) continue;\n    bool f = true;\n    k=b.size()-1;\n    for(j=1;j<k;j++){\n      if(a[i+j].first!=b[j].first||a[i+j].second!=b[j].second) {\n\tf=false;\n\tbreak;\n      }\n    }\n    if(a[i+k].first!=b[k].first||a[i+k].second<b[k].second) continue;\n    if(f){\n      //cout << i << endl;\n      for(j=0;j<k+1;j++){\n\ta[i+j].second-=b[j].second;\n      }\n      a.insert(a.begin()+i+1,c.begin(),c.end());\n      break;\n    }\n  }\n  k=0;\n  while(k<a.size()){\n    if(a[k].second==0) a.erase(a.begin()+k);\n    else k++;\n  }\n\n  \n  for(i=0;i<a.size()-1;i++){\n    //cout << i << a[i].first << a[i+1].first << endl;\n    if(a[i].first==a[i+1].first){\n      a[i+1].second+=a[i].second;\n      a[i].second=0;\n    }\n  }\n  \n  for(i=0;i<a.size();i++){\n    if(a[i].second==0) continue;\n    cout << a[i].first << \" \" << a[i].second << \" \";\n  }\n  cout << \"$\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing P=pair<char,int>;\n\nint main(){\n    vector<P> A,B,C;\n    char c;\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        A.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        B.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        C.emplace_back(c,l);\n    }\n    vector<P> ans;\n    for(int i=0;i<A.size();i++){\n        if(A[i].first==B.front().first&&A[i].second>=B.front().second){\n            bool flag=true;\n            if(i+B.size()<=A.size()){\n                for(int d=1;d<B.size();d++){\n                    if(A[i+d].first!=B[d].first){\n                        flag=false;\n                        break;\n                    }\n                    if(d!=B.size()-1){\n                        if(A[i+d].second!=B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }else{\n                        if(A[i+d].second<B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }\n                }\n            }else{\n                continue;\n            }\n            if(flag){\n                for(int j=0;j<i;j++){\n                    ans.push_back(A[j]);\n                }\n                if(B.size()==1){\n                    for(auto p:C) ans.push_back(p);\n                    if(ans.back().first==A[i].first){\n                        ans.back().second+=A[i].second-B[0].second;\n                    }else{\n                        ans.emplace_back(A[i].first,A[i].second-B[0].second);\n                    }\n                    for(int j=i+B.size();j<A.size();j++){\n                        if(j==i+B.size()&&ans.back().first==A[j].first){\n                            ans.back().second+=A[j].second;\n                        }else{\n                            ans.push_back(A[j]);                            \n                        }\n                    }\n                }else{\n                    ans.emplace_back(A[i].first,A[i].second-B[0].second);\n                    for(int j=0;j<C.size();j++){\n                        if(j==0&&!ans.empty()&&ans.back().first==C.front().first){\n                            ans.back().second+=C.front().second;\n                        }else{\n                            ans.push_back(C[j]);\n                        }\n                    }\n\n                    if(A[i+B.size()-1].second!=B.back().second){\n                        if(ans.back().first==B.back().first){\n                            ans.back().second+=A[i+B.size()-1].second-B.back().second;\n                        }else{\n                            ans.emplace_back(B.back().first, A[i+B.size()-1].second-B.back().second);\n                        }\n                    }\n                    for(int j=i+B.size();j<A.size();j++){\n                        ans.push_back(A[j]);\n                    }\n                }\n                for(auto p:ans){\n                    char c; int l;\n                    tie(c,l)=p;\n                    cout<<c<<' '<<l<<' ';\n                }\n                cout<<'$'<<endl;\n                /*\n                {\n                    bool b=true;\n                    for(int i=0;i<A.size();i++){\n                        if(A[i]!=B[i]){\n                            cout<<i<<' '<<A[i].first<<' '<<A[i].second<<' '<<B[i].first<<' '<<B[i].second<<endl;\n                        }\n                    }\n                    cout<<b<<endl;\n                }*/\n                \n                // cout<<A.size()<<endl;\n                // cout<<B.size()<<endl;\n                // cout<<C.size()<<endl;\n                // cout<<ans.size()<<endl;\n                 \n                return 0;\n            }\n        }   \n    }\n    for(auto p:A){\n        char c; int l;\n        tie(c,l)=p;\n        cout<<c<<' '<<l<<' ';\n    }\n    cout<<'$'<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstruct RLEchar{\n    char x;\n    int len;\n};\n\nusing RLE=vector<RLEchar>;\nistream& operator>>(istream& in,RLE& rle){\n    char c;\n    while(cin>>c,c!='$'){\n        int l; cin>>l;\n        rle.push_back(RLEchar{c,l});\n    }\n    return in;\n}\nostream& operator<<(ostream& out,RLE rle){\n    for(int i=0;i<rle.size();i++){\n        out<<rle[i].x<<\" \"<<rle[i].len<<\" \";\n    }\n    out<<\"$\"<<endl;\n    return out;\n}\n\nvoid shrink(RLE &rle){\n    RLE res;\n    for(int i=0;i<rle.size();i++){\n        if(rle[i].len==0) continue;\n        else if(res.size()==0) res.push_back(rle[i]);\n        else if(res.back().x!=rle[i].x) res.push_back(rle[i]);\n        else res.back().len+=rle[i].len;\n    }\n    rle=res;\n}\n\nvoid replace(RLE& a,RLE b,RLE c){\n    for(int i=0;i+b.size()<=a.size();i++){\n        if(b.size()==1){\n            if(a[i].x==b[0].x && a[i].len>=b[0].len){\n                RLE tmp;\n                for(int j=0;j<i;j++){\n                    tmp.push_back(a[j]);\n                }\n                tmp.push_back(RLEchar{a[i].x,a[i].len-b[0].len});\n                for(int j=0;j<c.size();j++) tmp.push_back(c[j]);\n                for(int j=i+1;j<a.size();j++){\n                    tmp.push_back(a[j]);\n                }\n                a=tmp;\n                break;\n            }\n        }\n        else{\n            bool isok=(a[i].x==b[0].x && a[i].len>=b[0].len);\n            for(int j=1;j+1<b.size();j++){\n                isok&=(a[i+j].x==b[j].x && a[i+j].len==b[j].len);\n            }\n            isok&=(a[i+b.size()-1].x==b.back().x && a[i+b.size()-1].len>=b.back().len);\n            if(isok){\n                RLE tmp;\n                for(int j=0;j<i;j++){\n                    tmp.push_back(a[j]);\n                }\n                tmp.push_back(RLEchar{a[i].x,a[i].len-b[0].len});\n                for(int j=0;j<c.size();j++) tmp.push_back(c[j]);\n                tmp.push_back(RLEchar{a[i+b.size()-1].x,a[i+b.size()-1].len-b.back().len});\n                for(int j=i+b.size();j<a.size();j++){\n                    tmp.push_back(a[j]);\n                }\n                a=tmp;\n                break;\n            }\n        }\n    }\n    shrink(a);\n}\n\nint main(){\n    RLE a,b,c;\n    cin>>a>>b>>c;\n    replace(a,b,c);\n    cout<<a<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define F first\n#define S second\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define reps(i, f, n) for(int i = (int)(f); i < (int)(n); i++)\n\nconst int inf = 1 << 25;\n\ntypedef pair<char, int> P;\n\nvoid input(vector<P>& v)\n{\n  char c; int l;\n  while(cin >> c, c != '$') {\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n}\n\nint main()\n{\n  vector<P> A; input(A);\n  vector<P> B; input(B);\n  vector<P> C; input(C);\n\n  int a = A.size();\n  int b = B.size();\n  int c = C.size();\n\n  rep(i, a-b+1) {\n    a = A.size();\n    if(A[i].F == B[0].F && A[i].S >= B[0].S &&\n       A[i+b-1].F == B[b-1].F && A[i+b-1].S >= B[b-1].S) {\n      bool flag = true;\n      reps(j, 1, b-1) flag &= (A[i+j].F == B[j].F && A[i+j].S == B[j].S);\n      if(!flag) continue;\n      if(b == 1) {\n\tA[i].S -= B[0].S;\n\tA.insert(begin(A)+i, begin(C), end(C));\n\t//if(A[i].S == 0) A.erase(begin(A)+i, begin(A)+i+1);\n      } else {\n\tA[i].S -= B[0].S;\n        A[i+b-1].S -= B[b-1].S;\n\tauto it1 = begin(A)+i;\n\tauto it2 = it1 + b;\n\tit1++, it2--;\n\t//if(A[i].S != 0) it1++;\n\t//if(A[i+b-1].S != 0) it2--;\n\tA.erase(it1, it2);\n\tA.insert(it1, begin(C), end(C));\n      }\n      i += C.size()+1;\n      for(auto it = begin(A); it != end(A); it++) {\n\tif(it->S == 0) {\n\t  it = A.erase(it, it+1) - 1, i--;\n\t} else {\n\t  auto itr = it+1;\n\t  while(itr != end(A) && it->F == itr->F) it->S += itr->S, itr++, i--;\n\t  if(itr != it+1) it = A.erase(it+1, itr) - 1;\n\t}\n      }\n    }\n  }\n\n  rep(i, A.size()) cout << A[i].F << \" \" << A[i].S << \" \";\n  //rep(i, A.size()) cout << A[i].F << endl << A[i].S << endl;\n  cout << \"$\" << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\n//const int INF = 1e8;\nusing namespace std;\n\n#define int long long\n\nstruct Data{\n\tchar c;\n\tint n;\n\tData(char c, int n) : c(c), n(n) {}\n};\n\nvoid parser(list<Data>& a){\n\tchar chr;\n\tint num;\n\twhile(cin >> chr, chr != '$'){\n\t\tcin >> num;\n\t\ta.emplace_back(chr, num);\n\t}\n}\n\nlist<Data> a, b, c;\n\nbool canReplace(list<Data>::iterator it){\n\tint idx = 0;\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n\tfor(auto i = it, j = b.begin(); j != b.end(); i++, j++){\n\t\tif(i->c != j->c) return false;\n\t\tif(idx == 0 or idx == b.size() - 1){\n\t\t\tif(i->n < j->n) return false;\n\t\t}else{\n\t\t\tif(i->n != j->n) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\n\nvoid replaceList(list<Data>::iterator& it){\n\trep(i,b.size()){\n\t\tif(i == 0){\n\t\t\tit->n -= (*b.begin()).n;\n\t\t\tit++;\n\t\t}else if(i == b.size() - 1){\n\t\t\tit->n -= (*--b.end()).n;\n\t\t}else{\n\t\t\tit = a.erase(it);\n\t\t}\n\t}\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n\tfor(auto i : c){\n\t\ta.insert(it,i);\n\t\tit++;\n\t}\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n}\n\nbool check(){\n\tint idx = 0;\n\tbool f = false;\n\tfor(auto it = a.begin(); idx + b.size() <= a.size(); it++, idx++){\n\t\tif(canReplace(it)){\n\t\t\treplaceList(it);\n\t\t\tf = true;\n\t\t}\n\t}\n\treturn f;\n}\n\nvoid compress(){\n\tauto it = a.begin();\n\twhile(it != a.end()){\n\t\tif(it->c == next(it, 1)->c){\n\t\t\tit->n += next(it, 1)->n;\n\t\t\ta.erase(next(it,1));\n\t\t}else if(it->n == 0){\n\t\t\tit = a.erase(it);\n\t\t}else{\n\t\t\tit++;\n\t\t}\n\t}\n}\n\nsigned main(){\n\tparser(a);\n\tparser(b);\n\tparser(c);\n\n\twhile(true){\n\t\tcompress();\n\t\tcompress();\n\t\tif(check() == false) break;\n\t}\n\t\n\tfor(auto i : a){\n\t\tcout << i.c << ' ' << i.n << ' ';\n\t}\n\tcout << '$' << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\nint main(){\n  vector<char> A_c, B_c, C_c, ans_c;\n  vector<int> A_l, B_l, C_l, ans_l;\n  char c_ = '!';\n  int l;\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    A_c.push_back(c_);\n    A_l.push_back(l);\n  }\n  c_ = '!';\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    B_c.push_back(c_);\n    B_l.push_back(l);\n  }\n  c_ = '!';\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    C_c.push_back(c_);\n    C_l.push_back(l);\n  }\n  int a = A_c.size(), b = B_c.size(), c = C_c.size();\n  bool g = false;\n  for(int i = 0; i < a; ++i){\n    bool f = true;\n    for(int j = 0; j < b; ++j){\n      if(g || i + j >= a){\n        f = false;\n        break;\n      }\n      if((j > 0 && j < b - 1 && A_l[i+j] != B_l[j]) ||\n         (A_c[i+j] != B_c[j]) ||\n         ((j == 0 || j == b-1) && A_l[i+j] < B_l[j])){\n        f = false;\n        break;\n      }\n    }\n    if(f){\n      g = true;\n      if(B_l.size() > 1 && A_l[i] - B_l[0] > 0){\n        ans_c.push_back(A_c[i]);\n        ans_l.push_back(A_l[i] - B_l[0]);\n      }\n      for(int j = 0; j < c; ++j){\n        if(ans_c.size() > 0 && ans_c.back() == C_c[j])\n          ans_l.back() += C_l[j];\n        else{\n          ans_c.push_back(C_c[j]);\n          ans_l.push_back(C_l[j]);\n        }\n      }\n      if(A_l[i+b-1] - B_l.back() > 0){\n        if(ans_c.size() > 0 && ans_c.back() == A_c[i+b-1])\n          ans_l.back() += A_l[i+b-1] - B_l.back();\n        else{\n          ans_c.push_back(A_c[i+b-1]);\n          ans_l.push_back(A_l[i+b-1] - B_l.back());\n        }\n      }\n    }else{\n      if(ans_c.size() > 0 && ans_c.back() == A_c[i])\n        ans_l.back() += A_l[i];\n      else{\n        ans_c.push_back(A_c[i]);\n        ans_l.push_back(A_l[i]);\n      }\n    }\n    i += b-1;\n  }\n  for(int i = 0; i < ans_c.size(); ++i){\n    cout << ans_c[i] <<  \" \" << ans_l[i] << \" \";\n  }\n  cout << \"$\" << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\nusing namespace std;\nvector<pair<char,int> >a[5];\nint main(){\n\tfor(int i=0;i<3;i++){\n\t\twhile(true){\n\t\t\tchar C;int P;\n\t\t\tcin>>C;if(C=='$')break;\n\t\t\tcin>>P;a[i].push_back(make_pair(C,P));\n\t\t}\n\t}\n\tint cnt=0;\n\tfor(int i=0;i<=a[0].size()-a[1].size();i++){\n\t\tif(a[0][i].first!=a[1][0].first)continue;\n\t\tif(a[0][i].second<a[1][0].second)continue;\n\t\tint OK=0;\n\t\tfor(int j=1;j<a[1].size();j++){\n\t\t\tif(j!=a[1].size()-1){\n\t\t\t\tif(a[0][i+j].first!=a[1][j].first)OK=1;\n\t\t\t\tif(a[0][i+j].second!=a[1][j].second)OK=1;\n\t\t\t}\n\t\t\tif(j==a[1].size()-1){\n\t\t\t\tif(a[0][i+j].first!=a[1][j].first)OK=1;\n\t\t\t\tif(a[0][i+j].second<a[1][j].second)OK=1;\n\t\t\t}\n\t\t}\n\t\tif(OK==0){\n\t\t\t//start\n\t\t\tfor(int j=0;j<i;j++)a[3].push_back(a[0][j]);\n\t\t\t//second\n\t\t\tif(a[1].size()>=2){\n\t\t\t\ta[3].push_back(make_pair(a[0][i].first,a[0][i].second-a[1][0].second));\n\t\t\t}\n\t\t\t//third\n\t\t\tfor(int j=0;j<a[2].size();j++)a[3].push_back(a[2][j]);\n\t\t\t//fourth\n\t\t\tint num=a[0][i+a[1].size()-1].second-a[1][a[1].size()-1].second;\n\t\t\ta[3].push_back(make_pair(a[1][a[1].size()-1].first,num));\n\t\t\t//fifth\n\t\t\tfor(int j=i+a[1].size();j<a[0].size();j++)a[3].push_back(a[0][j]);\n\t\t\tcnt=1;break;\n\t\t}\n\t}\n\tfor(int i=0;i<a[3].size();i++){\n\t\tif(a[3][i].second==0)continue;\n\t\tif(a[4].size()==0)a[4].push_back(a[3][i]);\n\t\telse{\n\t\t\tif(a[3][i].second==0)continue;\n\t\t\tif(a[4][a[4].size()-1].first==a[3][i].first){\n\t\t\t\ta[4][a[4].size()-1].second+=a[3][i].second;\n\t\t\t}\n\t\t\telse{a[4].push_back(a[3][i]);}\n\t\t}\n\t}\n\tif(cnt==1){\n\t\tfor(int i=0;i<a[4].size();i++){\n\t\t\tcout<<a[4][i].first<<' '<<a[4][i].second<<' ';\n\t\t}\n\t}\n\tif(cnt==0){\n\t\tfor(int i=0;i<a[0].size();i++){\n\t\t\tcout<<a[0][i].first<<' '<<a[0][i].second<<' ';\n\t\t}\n\t}\n\tcout<<\"$\"<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "/*\n * 2684.cc: RLE Replacement\n */\n\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<iostream>\n#include<string>\n#include<vector>\n#include<map>\n#include<set>\n#include<stack>\n#include<list>\n#include<queue>\n#include<deque>\n#include<algorithm>\n#include<numeric>\n#include<utility>\n#include<complex>\n#include<functional>\n \nusing namespace std;\n\n/* constant */\n\nconst int MAX_N = 1000;\n\n/* typedef */\n\ntypedef pair<char,int> pci;\ntypedef vector<pci> vpci;\n\n/* global variables */\n\n/* subroutines */\n\nvoid read_rle(vpci &v) {\n  for (;;) {\n    char ch;\n    cin >> ch;\n    if (ch == '$') break;\n\n    int l;\n    cin >> l;\n    v.push_back(pci(ch, l));\n  }\n}\n\nvoid print_rle(vpci &v) {\n  for (int i = 0; i < v.size(); i++)\n    printf(\"%c %d \", v[i].first, v[i].second);\n  putchar('$'); putchar('\\n');\n}\n\n/* main */\n\nint main() {\n  vpci va, vb, vc;\n  read_rle(va);\n  read_rle(vb);\n  read_rle(vc);\n  int van =  va.size(), vbn = vb.size(), vcn = vc.size();\n  //printf(\"%d %d %d\\n\", an, bn, cn);\n\n\n  int k = 0;\n  for (; k <= van - vbn; k++) {\n    bool ok = true;\n    if (va[k].first != vb[0].first ||\n\tva[k].second < vb[0].second ||\n\tva[k + vbn - 1].first != vb[vbn - 1].first ||\n\tva[k + vbn - 1].second < vb[vbn - 1].second) ok = false;\n    else\n      for (int i = 1; ok && i < vbn - 1; i++)\n\tif (va[k + i].first != vb[i].first ||\n\t    va[k + i].second != vb[i].second) ok = false;\n    if (ok) break;\n  }\n  //printf(\"k=%d\\n\", k);\n\n  if (k > van - vbn) {\n    print_rle(va);\n    return 0;\n  }\n\n  vpci vt;\n  if (vbn == 1) {\n    for (int i = 0; i < k; i++) vt.push_back(va[i]);\n    for (int i = 0; i < vcn; i++) vt.push_back(vc[i]);\n    int l0 = va[k].second - vb[0].second;\n    if (l0 > 0) vt.push_back(pci(va[k].first, l0));\n    for (int i = k + vbn; i < van; i++) vt.push_back(pci(va[i]));\n  }\n  else {\n    for (int i = 0; i < k; i++) vt.push_back(va[i]);\n    int l0 = va[k].second - vb[0].second;\n    if (l0 > 0) vt.push_back(pci(va[k].first, l0));\n    for (int i = 0; i < vcn; i++) vt.push_back(vc[i]);\n    int l1 = va[k + vbn - 1].second - vb[vbn - 1].second;\n    if (l1 > 0) vt.push_back(pci(va[k + vbn - 1].first, l1));\n    for (int i = k + vbn; i < van; i++) vt.push_back(pci(va[i]));\n  }\n  //print_rle(vt);\n\n  vpci vr;\n  pci prv = vt[0];\n  for (int i = 1; i < vt.size(); i++) {\n    if (prv.first == vt[i].first) prv.second += vt[i].second;\n    else {\n      vr.push_back(prv);\n      prv = vt[i];\n    }\n  }\n  vr.push_back(prv);\n\n  print_rle(vr);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing P=pair<char,int>;\n\nint main(){\n    vector<P> A,B,C;\n    char c;\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        A.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        B.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        C.emplace_back(c,l);\n    }\n    vector<P> ans;\n    for(int i=0;i<A.size();i++){\n        if(A[i].first==B.front().first&&A[i].first>=B.front().first){\n            bool flag=true;\n            if(i+B.size()<=A.size())\n            for(int d=1;d<B.size();d++){\n                if(A[i+d].first!=B[d].first){\n                    flag=false;\n                    break;\n                }\n                if(d==B.size()-2){\n                    if(A[i+d].second!=B[d].second){\n                        flag=false;\n                        break;\n                    }\n                }else{\n                    if(A[i+d].second<B[d].second){\n                        flag=false;\n                        break;\n                    }\n                }\n            }\n            if(flag){\n                for(int j=0;j<i;j++){\n                    ans.push_back(A[j]);\n                }\n                if(A[i].second!=B[0].second){\n                    ans.emplace_back(A[i].first,A[i].second-B[0].second);\n                }\n                //\n                for(int j=0;j<C.size();j++){\n                    if(j==0&&ans.back().first==C.front().first){\n                        ans.back().second+=C.front().second;\n                    }else{\n                        ans.push_back(C[j]);\n                    }\n                }\n\n                if(A[i+B.size()-1].second!=B.back().second){\n                    if(ans.back().first==B.back().first){\n                        ans.back().second+=A[i+B.size()-1].second-B.back().second;\n                    }else{\n                        ans.emplace_back(B.back().first, A[i+B.size()-1].second-B.back().second);\n                    }\n                }\n                for(int j=i+B.size();j<A.size();j++){\n                    ans.push_back(A[j]);\n                }\n                for(auto p:ans){\n                    char c; int l;\n                    tie(c,l)=p;\n                    cout<<c<<' '<<l<<' ';\n                }\n                cout<<'$'<<endl;\n                return 0;\n            }\n        }   \n    }\n    for(auto p:A){\n        char c; int l;\n        tie(c,l)=p;\n        cout<<c<<' '<<l<<' ';\n    }\n    cout<<'$'<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n#include <fstream>\n\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\n#define watch(a) { cout << #a << \" = \" << a << endl; }\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntypedef long long ll;\nint const inf = 1<<29;\n\nvoid change(deque<pair<char, int>>& nv0) {\n  if(nv0.size() > 1 && nv0[nv0.size()-2].first == nv0.back().first) {\n    int k = nv0.back().second;\n    nv0.pop_back();\n    nv0.back().second += k;\n  }\n}\n\nvoid output(deque<pair<char, int>>& out) {\n  rep(i, out.size()) {\n    if(i) cout << \" \";\n    cout << out[i].first << \" \" << out[i].second;\n  }\n  cout << \" $\" << endl;\n}\n\nint main() {\n\n  vector<deque<pair<char, int>>> v(3);\n  for(auto& u: v) {\n    while(1) {\n      char c; cin >> c;\n      if(c == '$') break;\n      int n; cin >> n;\n      u.emplace_back(c, n);\n    }\n  }\n\n  rep(i, (int)v[0].size()-(int)v[1].size()+1) {\n\n    if(v[1].size() == 1) {\n      const int a = v[0][i].second, b = v[1][0].second;\n      if(v[0][i].first == v[1][0].first && a >= b) {\n        deque<pair<char, int>> nv0;\n        rep(k, i) {\n          nv0.push_back(v[0][k]);\n        }\n\n        rep(k, v[2].size()) {\n          nv0.push_back(v[2][k]);\n          change(nv0);\n        }\n\n        if(a - b > 0) {\n          nv0.push_back(v[0][i]);\n          nv0.back().second = a - b;\n          change(nv0);\n        }\n        REP(k, i+1, v[0].size()) {\n          nv0.push_back(v[0][k]);\n        }\n        v[0] = nv0;\n        break;\n      }\n      continue;\n    }\n\n    int j = 0;\n    vector<int> V;\n    while(j < v[1].size() && v[0][i+j].first == v[1][j].first) {\n      if(j == 0 || j == (int)v[1].size()-1) {\n        if(v[0][i+j].second < v[1][j].second) break;\n        V.push_back(v[0][i+j].second - v[1][j].second);\n      }\n      else {\n        if(v[0][i+j].second != v[1][j].second) break;\n      }\n      j++;\n    }\n\n    deque<pair<char, int>> nv0;\n\n    if(j == v[1].size()) {\n      rep(k, v[0].size()) {\n        if(k < i) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n        if(k == i) {\n          if(V[0] > 0) nv0.emplace_back(v[0][i].first, V[0]);\n          rep(l, v[2].size()) {\n            nv0.push_back(v[2][l]);\n            change(nv0);\n          }\n          k = i+v[1].size()-1;\n        }\n        if(k == i+j-1) {\n          if(V[1] > 0) nv0.emplace_back(v[0][i+j-1].first, V[1]);\n          change(nv0);\n        }\n        if(i+j <= k) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n      }\n      v[0] = nv0;\n      break;\n    }\n  }\n\n  output(v[0]);\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\nint main(){\n  vector<char> A_c, B_c, C_c, ans_c;\n  vector<int> A_l, B_l, C_l, ans_l;\n  char c_ = '!';\n  int l;\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    A_c.push_back(c_);\n    A_l.push_back(l);\n  }\n  c_ = '!';\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    B_c.push_back(c_);\n    B_l.push_back(l);\n  }\n  c_ = '!';\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    C_c.push_back(c_);\n    C_l.push_back(l);\n  }\n  int a = A_c.size(), b = B_c.size(), c = C_c.size();\n  bool g = false;\n  for(int i = 0; i < a; ++i){\n    bool f = true;\n    for(int j = 0; j < b; ++j){\n      if(g || i + j >= a){\n        f = false;\n        break;\n      }\n      if((A_c[i+j] != B_c[j]) ||\n         (j > 0 && j < b - 1 && A_l[i+j] != B_l[j]) ||\n         ((j == 0 || j == b-1) && A_l[i+j] < B_l[j])){\n        f = false;\n        break;\n      }\n    }\n    if(f){\n      g = true;\n      if(B_l.size() > 1 && A_l[i] - B_l[0] > 0){\n        ans_c.push_back(A_c[i]);\n        ans_l.push_back(A_l[i] - B_l[0]);\n      }\n      for(int j = 0; j < c; ++j){\n        if(ans_c.size() > 0 && ans_c.back() == C_c[j])\n          ans_l.back() += C_l[j];\n        else{\n          ans_c.push_back(C_c[j]);\n          ans_l.push_back(C_l[j]);\n        }\n      }\n      if(A_l[i+b-1] - B_l.back() > 0){\n        if(ans_c.size() > 0 && ans_c.back() == A_c[i+b-1])\n          ans_l.back() += A_l[i+b-1] - B_l.back();\n        else{\n          ans_c.push_back(A_c[i+b-1]);\n          ans_l.push_back(A_l[i+b-1] - B_l.back());\n        }\n      }\n      i += b - 1;\n    }else{\n      if(ans_c.size() > 0 && ans_c.back() == A_c[i])\n        ans_l.back() += A_l[i];\n      else{\n        ans_c.push_back(A_c[i]);\n        ans_l.push_back(A_l[i]);\n      }\n    }\n  }\n  for(int i = 0; i < ans_c.size(); ++i){\n    cout << ans_c[i] <<  \" \" << ans_l[i] << \" \";\n  }\n  cout << \"$\" << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(ll i=(ll)(a);i<(ll)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define each(itr,v) for(auto itr:v)\n#define pb push_back\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define mmax(x,y) (x>y?x:y)\n#define mmin(x,y) (x<y?x:y)\n#define maxch(x,y) x=mmax(x,y)\n#define minch(x,y) x=mmin(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt __builtin_popcount\n\n#define INF INT_MAX/3\n\ntypedef pair<char,ll> p;\ntypedef vector<p> pv;\n\npv read_rle(){\n  pv res;\n  while(1){\n    char c; ll n;\n    cin>>c;\n    if(c=='$')break;\n    cin>>n;\n    res.push_back(p(c,n));\n  }\n  return res;\n}\n\nvoid print_rle(pv s){\n  rep(i,s.size()){\n    printf(\"%c %lld \", s[i].fi,s[i].se);\n  }\n  printf(\"$\\n\");\n}\n\nint main(){\n\tcin.sync_with_stdio(false);\n  pv a,b,c;\n  a=read_rle(); b=read_rle(); c=read_rle();\n  int na=a.size(),nb=b.size(),nc=c.size();\n  int st=-1,en=-1;\n  rep(i,na){\n    if(i+nb-1>=na)continue;\n    if(b[0].fi!=a[i].fi||b[0].se>a[i].se||b[nb-1].fi!=a[i+nb-1].fi||b[nb-1].se>a[i+nb-1].se)continue;\n    bool ok=true;\n    repl(j,1,nb-1){\n      if(b[j]!=a[i+j])ok=false;\n    }\n    if(!ok)continue;\n    st=i; en=i+nb-1; break;\n  }\n  if(st==-1)print_rle(a);\n  else{\n    pv res,res2;\n    rep(i,st)res.push_back(a[i]);\n    if(a[st].se-b[0].se>0)res.push_back(p(a[st].fi,a[st].se-b[0].se));\n    rep(i,nc){\n      res.push_back(c[i]);\n    }\n    if(a[en].se-b[nb-1].se>0)res.push_back(p(a[en].fi,a[en].se-b[nb-1].se));\n    repl(i,en+1,na)res.push_back(a[i]);\n    res2.push_back(res[0]);\n    repl(i,1,res.size()){\n      while(i<res.size()&&res2.back().fi==res[i].fi){\n        res2.back().se+=res[i].se;\n        i++;\n      }\n      if(i==res.size())break;\n      res2.push_back(res[i]);\n    }\n    print_rle(res2);\n  }\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef long long LL;\ntypedef pair<LL, LL> PLL;\n\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define EB emplace_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define EACH(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\n#define FF first\n#define SS second\ntemplate<class S, class T>\nistream& operator>>(istream& is, pair<S,T>& p){\n  return is >> p.FF >> p.SS;\n}\n\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\nconst LL MOD = 1e9+7;\n\nstruct RLE{\n  char c;\n  LL n;\n  RLE(char c_,LL n_):c(c_),n(n_){}\n  RLE(){}\n};\n\nvector<RLE> normal(const vector<RLE>& xs){\n  vector<RLE> res;\n  for(auto& x: xs){\n\tif(x.n <= 0) continue;\n\tif(!res.empty() && res.back().c == x.c)\n\t  res.back().n += x.n;\n\telse\n\t  res.EB(x);\n  }\n  return res;\n}\n\nint main(){\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n\n  vector<vector<RLE>> S(3);\n  REP(i,3){\n\twhile(true){\n\t  char c; cin >> c;\n\t  if(c == '$') break;\n\t  LL n; cin >> n;\n\t  S[i].EB(c,n);\n\t}\n  }\n\n  vector<RLE> ans;\n  if(SZ(S[1]) == 1){\n\tbool done = false;\n\tfor(auto& x: S[0]){\n\t  if(!done && x.c == S[1][0].c && x.n >= S[1][0].n){\n\t\tans.insert(end(ans), ALL(S[2]));\n\t\tans.EB(x.c, x.n - S[1][0].n);\n\t\tdone = true;\n\t  }\n\t  else\n\t\tans.EB(x);\n\t}\n  }\n  else{\n\tbool done = false;\n\tfor(int i=0;i<SZ(S[0]);++i){\n\t  bool ok = (i+SZ(S[1]) <= SZ(S[0])) && !done;\n\t  for(int j=0;ok&&j<SZ(S[1]);++j){\n\t\tif(j==0 || j+1 == SZ(S[1])){\n\t\t  if(S[0][i+j].c != S[1][j].c || S[0][i+j].n < S[1][j].n)\n\t\t\tok = false;\n\t\t}\n\t\telse if(S[0][i+j].c != S[1][j].c || S[0][i+j].n != S[1][j].n)\n\t\t  ok = false;\n\t  }\n\t  if(ok){\n\t\tdone = true;\n\t\tans.EB(S[0][i].c, S[0][i].n - S[1][0].n);\n\t\tans.insert(end(ans), ALL(S[2]));\n\t\tans.EB(S[0][i+SZ(S[1])-1].c, S[0][i+SZ(S[1])-1].n - S[1].back().n);\n\t\ti += SZ(S[1]) - 1;\n\t  }\n\t  else{\n\t\tans.EB(S[0][i]);\n\t  }\n\t}\n  }\n\n  ans = normal(ans);\n  REP(i,SZ(ans)) cout << ans[i].c << \" \" << ans[i].n << \" \";\n  cout << \"$\" << endl;\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\nusing namespace std;\ntypedef pair<char,int> P;\n\nchar c[3][1000];\nint l[3][1000];\nint si[3];\nvector<P> ans;\n\nint main(){\n\trep(i,3){\n\t\tfor(int j = 0;;j++){\n\t\t\tcin >> c[i][j];\n\t\t\tif(c[i][j] == '$'){\n\t\t\t\tsi[i] = j;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcin >> l[i][j];\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tif(si[0]-i < si[1]) break;\n\t\tif(c[0][i] == c[1][0] && l[0][i] >= l[1][0]){\n\t\t\tbool ok = true;\n\t\t\tfor(int j = 1; j < si[1]-1; j++){\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] != l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!ok) continue;\n\t\t\t{\n\t\t\t\tint j = si[1]-1;\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] < l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(!ok) continue;\n\t\t\t\tl[0][i] -= l[1][0];\n\t\t\t\tif(j != 0) l[0][i+j] -= l[1][j];\n\t\t\t}\n\t\t\trep(j,i+1) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\trep(j,si[2]) ans.push_back(P(c[2][j],l[2][j]));\n\t\t\tfor(int j = i+si[1]-1; j < si[0]; j++){\n\t\t\t\tif(si[1] == 1 && j == i+si[1]-1) continue;\n\t\t\t\tif(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t}\n\t\t\tfor(int j = ans.size()-1; j >= 1; j--){\n\t\t\t\tif(ans[j].first == ans[j-1].first){\n\t\t\t\t\tans[j-1].second += ans[j].second;\n\t\t\t\t\tans[j].second = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\trep(j,ans.size()){\n\t\t\t\tif(ans[j].second == 0) continue;\n\t\t\t\tprintf(\"%c %d \",ans[j].first,ans[j].second);\n\t\t\t}\n\t\t\tputs(\"$\");\n\t\t\treturn 0;\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tprintf(\"%c %d \",c[0][i],l[0][i]);\n\t}\n\tputs(\"$\");\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define fi first\n#define se second\nusing namespace std;\ntypedef pair<string,int> P;\nvector<P>v1,v2,v3;\nint x;\nstring s;\nmain(){\n  while(cin>>s,s!=\"$\")cin>>x,v1.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v2.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v3.push_back(P(s,x));\n  r(i,v1.size())if(v1[i].fi==v2[0].fi&&v1[i].se>=v2[0].se){\n    int flag=0,jj=0;\n    r(j,(int)v2.size()-2){\n      jj=j+1;\n      if(i+jj>=v1.size()){flag++;break;}\n      if(v2[jj].se!=v1[i+jj].se||v2[jj].fi!=v1[i+jj].fi)flag++;\n    }\n    if(v2.size()!=1){\n      jj++;\n      if(!flag&&v2[jj].fi==v1[i+jj].fi&&v2[jj].se<=v1[i+jj].se){\n        v1[i].se-=v2[0].se;\n        r(j,v2.size()-2)v1.erase(v1.begin()+i+1);\n        v1[i+1].se-=v2[v2.size()-1].se;\n        r(j,v3.size())v1.insert(v1.begin()+i+1,v3[j]);\n      }\n    }\n    else{\n      v1[i].se-=v2[0].se;\n      r(j,v3.size())v1.insert(v1.begin()+i+1,v3[j]);\n    }\n    r(j,v1.size())if(v1[j].se==0)v1.erase(v1.begin()+i);\n    r(j,(int)v1.size()-1)if(v1[j].fi==v1[j+1].fi)\n      v1[j].se+=v1[j+1].se,v1.erase(v1.begin()+j+1),j--;\n    r(j,v3.size())i++;\n  }\n  r(k,v1.size())cout<<v1[k].fi<<' '<<v1[k].se<<' ';\n  cout<<'$'<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n#include <fstream>\n\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\n#define watch(a) { cout << #a << \" = \" << a << endl; }\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntypedef long long ll;\nint const inf = 1<<29;\n\nvoid change(deque<pair<char, int>>& nv0) {\n  if(nv0.size() > 1 && nv0[nv0.size()-2].first == nv0.back().first) {\n    int k = nv0.back().second;\n    nv0.pop_back();\n    nv0.back().second += k;\n  }\n}\n\nvoid output(deque<pair<char, int>>& out) {\n  rep(i, out.size()) {\n    if(i) cout << \" \";\n    cout << out[i].first << \" \" << out[i].second;\n  }\n  cout << \" $\" << endl;\n}\n\nint main() {\n\n  vector<deque<pair<char, int>>> v(3);\n  for(auto& u: v) {\n    while(1) {\n      char c; cin >> c;\n      if(c == '$') break;\n      int n; cin >> n;\n      u.emplace_back(c, n);\n    }\n  }\n\n  rep(i, v[0].size()-(int)v[1].size()+1) {\n    int j = 0;\n    vector<int> V;\n    while(j < v[1].size() && v[0][i+j].first == v[1][j].first) {\n      if(j == 0 || j == v[1].size()-1) {\n        if(v[0][i+j].second < v[1][j].second) break;\n        V.push_back(v[0][i+j].second - v[1][j].second);\n      }\n      else {\n        if(v[0][i+j].second != v[1][j].second) break;\n      }\n      j++;\n    }\n\n    deque<pair<char, int>> nv0;\n    if(j == v[1].size()) {\n      rep(k, v[0].size()) {\n        if(k < i) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n        if(k == i) {\n          if(V[0] > 0) nv0.emplace_back(v[0][i].first, V[0]);\n          rep(l, v[2].size()) {\n            nv0.push_back(v[2][l]);\n            change(nv0);\n          }\n          k = i+v[1].size()-1;\n        }\n        if(k == i+j-1) {\n          if(V[1] > 0) nv0.emplace_back(v[0][i+j-1].first, V[1]);\n          change(nv0);\n        }\n        if(i+j <= k) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n      }\n      v[0] = nv0;\n//      i--;\n    }\n  }\n\n  output(v[0]);\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing P=pair<char,int>;\n\nint main(){\n    vector<P> A,B,C;\n    char c;\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        A.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        B.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        C.emplace_back(c,l);\n    }\n    vector<P> ans;\n    for(int i=0;i<A.size();i++){\n        if(A[i].first==B.front().first&&A[i].second>=B.front().second){\n            bool flag=true;\n            if(i+B.size()<=A.size()){\n                for(int d=1;d<B.size();d++){\n                    if(A[i+d].first!=B[d].first){\n                        flag=false;\n                        break;\n                    }\n                    if(d!=B.size()-1){\n                        if(A[i+d].second!=B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }else{\n                        if(A[i+d].second<B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }\n                }\n            }else{\n                continue;\n            }\n            if(flag){\n                for(int j=0;j<i;j++){\n                    ans.push_back(A[j]);\n                }\n                if(B.size()==1){\n                    for(auto p:C) ans.push_back(p);\n                    if(ans.back().first==A[i].first){\n                        ans.back().second+=A[i].second-B[0].second;\n                    }else if(A[i].second-B[0].second>0){\n                        ans.emplace_back(A[i].first,A[i].second-B[0].second);\n                    }\n                    for(int j=i+B.size();j<A.size();j++){\n                        if(j==i+B.size()&&ans.back().first==A[j].first){\n                            ans.back().second+=A[j].second;\n                        }else{\n                            ans.push_back(A[j]);                            \n                        }\n                    }\n                }else{\n                    ans.emplace_back(A[i].first,A[i].second-B[0].second);\n                    for(int j=0;j<C.size();j++){\n                        if(j==0&&!ans.empty()&&ans.back().first==C.front().first){\n                            ans.back().second+=C.front().second;\n                        }else{\n                            ans.push_back(C[j]);\n                        }\n                    }\n\n                    if(A[i+B.size()-1].second!=B.back().second){\n                        if(ans.back().first==B.back().first){\n                            ans.back().second+=A[i+B.size()-1].second-B.back().second;\n                        }else{\n                            ans.emplace_back(B.back().first, A[i+B.size()-1].second-B.back().second);\n                        }\n                    }\n                    for(int j=i+B.size();j<A.size();j++){\n                        ans.push_back(A[j]);\n                    }\n                }\n                for(auto p:ans){\n                    char c; int l;\n                    tie(c,l)=p;\n                    cout<<c<<' '<<l<<' ';\n                }\n                cout<<'$'<<endl;\n                /*\n                {\n                    bool b=true;\n                    for(int i=0;i<A.size();i++){\n                        if(A[i]!=B[i]){\n                            cout<<i<<' '<<A[i].first<<' '<<A[i].second<<' '<<B[i].first<<' '<<B[i].second<<endl;\n                        }\n                    }\n                    cout<<b<<endl;\n                }*/\n                \n                // cout<<A.size()<<endl;\n                // cout<<B.size()<<endl;\n                // cout<<C.size()<<endl;\n                // cout<<ans.size()<<endl;\n                 \n                return 0;\n            }\n        }   \n    }\n    for(auto p:A){\n        char c; int l;\n        tie(c,l)=p;\n        cout<<c<<' '<<l<<' ';\n    }\n    cout<<'$'<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\nint main(){\n  vector<char> A_c, B_c, C_c, ans_c;\n  vector<int> A_l, B_l, C_l, ans_l;\n  char c_ = '!';\n  int l;\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    A_c.push_back(c_);\n    A_l.push_back(l);\n  }\n  c_ = '!';\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    B_c.push_back(c_);\n    B_l.push_back(l);\n  }\n  c_ = '!';\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    C_c.push_back(c_);\n    C_l.push_back(l);\n  }\n  int a = A_c.size(), b = B_c.size(), c = C_c.size();\n  bool g = false;\n  for(int i = 0; i < a; ++i){\n    bool f = true;\n    for(int j = 0; j < b; ++j){\n      if(g){\n        f = false;\n        break;\n      }\n      if((j > 0 && j < b - 1 && A_l[i+j] != B_l[j]) ||\n         (A_c[i+j] != B_c[j]) ||\n         ((j == 0 || j == b-1)&& A_l[i+j] < B_l[j])){\n        f = false;\n        break;\n      }\n    }\n    if(f){\n      g = true;\n      if(B_l.size() > 1 && A_l[i] - B_l[0] > 0){\n        ans_c.push_back(A_c[i]);\n        ans_l.push_back(A_l[i] - B_l[0]);\n      }\n      for(int j = 0; j < c; ++j){\n        if(ans_c.size() > 0 && ans_c.back() == C_c[j])\n          ans_l.back() += C_l[j];\n        else{\n          ans_c.push_back(C_c[j]);\n          ans_l.push_back(C_l[j]);\n        }\n      }\n      if(A_l[i+b-1] - B_l.back() > 0){\n        if(ans_c.size() > 0 && ans_c.back() == A_c[i+b-1])\n          ans_l.back() += A_l[i+b-1] - B_l.back();\n        else{\n          ans_c.push_back(A_c[i+b-1]);\n          ans_l.push_back(A_l[i+b-1] - B_l.back());\n        }\n      }\n    }else{\n      if(ans_c.size() > 0 && ans_c.back() == A_c[i]) ans_l.back() += A_l[i];\n      else{\n        ans_c.push_back(A_c[i]);\n        ans_l.push_back(A_l[i]);\n      }\n    }\n    i += b-1;\n  }\n  for(int i = 0; i < ans_c.size(); ++i){\n    cout << ans_c[i] <<  \" \" << ans_l[i] << \" \";\n  }\n  cout << \"$\" << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\n//const int INF = 1e8;\nusing namespace std;\n\n#define int long long\n\nstruct Data{\n\tchar c;\n\tint n;\n\tData(char c, int n) : c(c), n(n) {}\n};\n\nvoid parser(list<Data>& a){\n\tchar chr;\n\tint num;\n\twhile(cin >> chr, chr != '$'){\n\t\tcin >> num;\n\t\ta.emplace_back(chr, num);\n\t}\n}\n\nlist<Data> a, b, c;\n\nbool canReplace(list<Data>::iterator it){\n\tint idx = 0;\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n\tfor(auto i = it, j = b.begin(); j != b.end(); i++, j++){\n\t\tif(i->c != j->c) return false;\n\t\tif(idx == 0 or idx == b.size() - 1){\n\t\t\tif(i->n < j->n) return false;\n\t\t}else{\n\t\t\tif(i->n != j->n) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\n\nvoid replaceList(list<Data>::iterator& it){\n\trep(i,b.size()){\n\t\tif(i == 0){\n\t\t\tit->n -= (*b.begin()).n;\n\t\t\tit++;\n\t\t}else if(i == b.size() - 1){\n\t\t\tit->n -= (*--b.end()).n;\n\t\t}else{\n\t\t\tit = a.erase(it);\n\t\t}\n\t}\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n\tfor(auto i : c){\n\t\ta.insert(it,i);\n\t\tit++;\n\t}\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n}\n\nbool check(){\n\tint idx = 0;\n\tbool f = false;\n\tfor(auto it = a.begin(); idx + b.size() <= a.size(); it++, idx++){\n\t\tif(canReplace(it)){\n\t\t\treplaceList(it);\n\t\t\tf = true;\n\t\t}\n\t}\n\treturn f;\n}\n\nvoid compress(){\n\tauto it = a.begin();\n\twhile(it != a.end()){\n\t\tif(it->c == next(it, 1)->c){\n\t\t\tit->n += next(it, 1)->n;\n\t\t\ta.erase(next(it,1));\n\t\t}else if(it->n == 0){\n\t\t\tit = a.erase(it);\n\t\t}else{\n\t\t\tit++;\n\t\t}\n\t}\n}\n\nsigned main(){\n\tparser(a);\n\tparser(b);\n\tparser(c);\n\n\twhile(true){\n\t\tcompress();\n\t\tif(check() == false) break;\n\t}\n\t\n\tfor(auto i : a){\n\t\tcout << i.c << ' ' << i.n << ' ';\n\t}\n\tcout << '$' << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-9;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\nvector<pair<char, int>>comp(vector<pair<char, int>>ps) {\n\tvector<pair<char, int>>newps;\n\tfor (int i = 0; i < ps.size(); ++i) {\n\t\tif (i==ps.size()-1||ps[i].first != ps[i + 1].first) {\n\t\t\tif (ps[i].second) {\n\t\t\t\tnewps.push_back(ps[i]);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tps[i + 1].second += ps[i].second;\n\t\t}\n\t}\n\treturn newps;\n}\nvoid input(vector<pair<char, int>>&p) {\n\twhile (1) {\n\t\tchar c; cin >> c;\n\t\tif (c == '$')break;\n\t\tint n; cin >> n;\n\t\tp.push_back(make_pair(c, n));\n\t}\n}\nint main() {\n\tvector<pair<char, int>>a, b, c;\n\tinput(a); input(b); input(c);\n\ta = comp(a); b = comp(b); c = comp(c);\n\tif (b.size() == 1) {\n\t\tfor (int i = 0; i < a.size(); ++i) {\n\t\t\tif (a[i].first == b[i].first&&a[i].second>=b[i].second) {\n\t\t\t\ta[i].second -= b[i].second;\n\t\t\t\ta.insert(a.begin() + i, c.begin(),c.end());\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tfor (int l = 0; l <= a.size() - b.size(); ++l) {\n\t\t\tbool aok = true;\n\t\t\tif (a[l].first != b[0].first||a[l].second < b[0].second) {\n\t\t\t\taok = false;\n\t\t\t}\n\t\t\tfor (int i = 1; i < b.size() - 1; ++i) {\n\t\t\t\tif (a[l + i] != b[i]) {\n\t\t\t\t\taok = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (a[l+b.size()-1].first != b[b.size()-1].first || a[l + b.size() - 1].second < b[b.size() - 1].second) {\n\t\t\t\taok = false;\n\t\t\t}\n\t\t\tif (aok) {\n\t\t\t\ta[l].second -= b[0].second;\n\t\t\t\ta[l + b.size() - 1].second -= b[b.size() - 1].second;\n\t\t\t\ta.erase(a.begin() + l + 1, a.begin() + l + b.size() - 1);\n\t\t\t\ta.insert(a.begin() + l + 1, c.begin(), c.end());\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\ta = comp(a);\n\tfor (int i = 0; i < a.size(); ++i) {\n\t\tcout << a[i].first << \" \" << a[i].second << \" \";\n\t}\n\tcout << \"$\" << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\nusing namespace std;\n \n#define REP(i,n) for(int i=0; i<n; ++i)\n#define FOR(i,a,b) for(int i=a; i<=b; ++i)\n#define FORR(i,a,b) for (int i=a; i>=b; --i)\n \ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef vector<VI> VVI;\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> PL;\n\nvoid inp(vector<pair<char, int> > &a){\n    while (1){\n        char c;\n        cin >> c;\n        if (c == '$') break;\n        int x;\n        cin >> x;\n        a.push_back(make_pair(c, x));\n    }\n}\n\nint main() {\n    vector<pair<char, int> > a, b, c, res, ans;\n    inp(a);\n    inp(b);\n    inp(c);\n    REP(i,a.size() - b.size() + 1){\n        bool f = true;\n        REP(j,b.size()){\n            if (a[i+j].first != b[j].first){\n                f = false;\n                break;\n            }\n            if (j == 0 || j == b.size()-1){\n                if (a[i+j].second < b[j].second){\n                    f = false;\n                    break;\n                }\n            }else{\n                if (a[i+j].second != b[j].second){\n                    f = false;\n                    break;\n                }\n            }\n        }\n        if (f){\n            REP(j,i) res.push_back(a[j]);\n            a[i].second -= b[0].second;\n            res.push_back(a[i]);\n            REP(j,c.size()) res.push_back(c[j]);\n            if (b.size() > 1){\n                a[i+b.size()-1].second -= b[b.size()-1].second;\n                res.push_back(a[i+b.size()-1]);\n            }\n            FOR(j,i+b.size(),a.size()-1) res.push_back(a[j]);\n        }\n    }\n    if (res.empty()){\n        REP(i,a.size()){\n            printf(\"%c %d \", a[i].first, a[i].second);\n        }\n        printf(\"$ \\n\");\n    }else{\n        REP(i,res.size()){\n            if (i != 0 && ans[ans.size()-1].first == res[i].first){\n                ans[ans.size()-1].second += res[i].second;\n            }else if (res[i].second > 0){\n                ans.push_back(res[i]);\n            }\n        }\n        REP(i,ans.size()){\n            printf(\"%c %d \", ans[i].first, ans[i].second);\n        }\n        printf(\"$ \\n\");\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing P=pair<char,int>;\n\nint main(){\n    vector<P> A,B,C;\n    char c;\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        A.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        B.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        C.emplace_back(c,l);\n    }\n    vector<P> ans;\n    for(int i=0;i<A.size();i++){\n        if(A[i].first==B.front().first&&A[i].second>=B.front().second){\n            bool flag=true;\n            if(i+B.size()<=A.size()){\n                for(int d=1;d<B.size();d++){\n                    if(A[i+d].first!=B[d].first){\n                        flag=false;\n                        break;\n                    }\n                    if(d!=B.size()-1){\n                        if(A[i+d].second!=B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }else{\n                        if(A[i+d].second<B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }\n                }\n            }else{\n                continue;\n            }\n            if(flag){\n                // cout<<i<<endl;\n                if(B.size()==1){\n                    for(int j=0;j<i;j++) ans.push_back(A[j]);\n                    for(auto p:C) ans.push_back(p);\n                    if(A[i].second>B[0].second){\n                        ans.emplace_back(B[0].first,A[i].second-B[0].second);\n                    }\n                    for(int j=i+1;j<A.size();j++) ans.push_back(A[j]);\n                }else{\n                    for(int j=0;j<i;j++) ans.push_back(A[j]);                    \n                    if(A[i].second>B[0].second){\n                        ans.emplace_back(B[0].first,A[i].second-B[0].second);\n                    }\n                    for(auto p:C) ans.push_back(p);\n                    if(A[i+B.size()-1].second>B.back().second){\n                        ans.emplace_back(B.back().first, A[i+B.size()-1].second-B.back().second);\n                    }\n                    for(int j=i+B.size();j<A.size();j++) ans.push_back(A[j]);\n                }\n\n                for(int j=ans.size()-2;j>=0;j--){\n                    if(ans[j].first==ans[j+1].first){\n                        ans[j].second+=ans[j+1].second;\n                        ans[j+1].second=0;\n                    }\n                }\n                for(auto p:ans){\n                    char c; int l;\n                    tie(c,l)=p;\n                    if(l) cout<<c<<' '<<l<<' ';\n                }\n                cout<<'$'<<endl;\n                /*\n                {\n                    bool b=true;\n                    for(int i=0;i<A.size();i++){\n                        if(A[i]!=B[i]){\n                            cout<<i<<' '<<A[i].first<<' '<<A[i].second<<' '<<B[i].first<<' '<<B[i].second<<endl;\n                        }\n                    }\n                    cout<<b<<endl;\n                }*/\n                \n                // cout<<A.size()<<endl;\n                // cout<<B.size()<<endl;\n                // cout<<C.size()<<endl;\n                // cout<<ans.size()<<endl;\n                 \n                return 0;\n            }\n        }   \n    }\n    for(auto p:A){\n        char c; int l;\n        tie(c,l)=p;\n        cout<<c<<' '<<l<<' ';\n    }\n    cout<<'$'<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\n#define F first\n#define S second\ntypedef long long ll;\ntypedef pair<char, ll> P;\n\nint main()\n{\n    ll len[3];    \n    vector<P> X[3];\n    for (int i = 0; i < 3; i++) {\n        char c;\n        ll l;\n        while (cin >> c, c != '$') {\n            cin >> l;\n            X[i].push_back(P(c, l));\n        }\n        len[i] = X[i].size();\n    }\n    for (int i = 0; i <= len[0]-len[1]; i++) {\n        bool same = 1;\n        for (int j = i; j < i+len[1]; j++) {\n            if (X[1][j-i].F != X[0][j].F ||\n                (i < j && j < i+len[1]-1 && X[1][j-i].S != X[0][j].S)) {\n                same = 0;\n                break;\n            }\n        }\n        if (X[0][i].S < X[1][0].S || X[0][i+len[1]-1].S < X[1][len[1]-1].S) {\n            continue;\n        }\n\n        if (same) {\n            vector<P> v, res;\n            for (int j = 0; j < i; j++) {\n                v.push_back(X[0][j]);\n            }\n            ll diff = X[0][i].S - X[1][0].S;\n            if (len[1] != 1) {\n                if (diff > 0) {\n                    v.push_back(P(X[0][i].F, diff));      \n                }\n                for (int j = 0; j < len[2]; j++) {\n                    v.push_back(X[2][j]);\n                }\n                diff = X[0][i+len[1]-1].S - X[1][len[1]-1].S;\n                if (diff > 0) {\n                    v.push_back(P(X[0][i+len[1]-1].F, diff));\n                }\n            } else {\n                for (int j = 0; j < len[2]; j++) {\n                    v.push_back(X[2][j]);\n                }                \n                if (diff > 0) {\n                    v.push_back(P(X[0][i].F, diff));   \n                }\n            }\n            for (int j = i+len[1]; j < len[0]; j++) {\n                v.push_back(X[0][j]);\n            }\n            \n            for (int j = 0; j < (int)v.size(); ) {\n                ll k = j, sum = 0;\n                while (k < (ll)v.size() &&\n                       v[j].F == v[k].F) {\n                    sum += v[k].S;\n                    k++;\n                }\n                res.push_back(P(v[j].F, sum));\n                j = k;\n            }\n            X[0] = res;\n            break;\n        }\n    }\n    for (int i = 0; i < len[0]; i++) {\n        cout << X[0][i].F << \" \" << X[0][i].S << \" \";\n    }\n    cout << \"$\" << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "/* template.cpp {{{ */\n#include <bits/stdc++.h>\nusing namespace std;\n\nnamespace solver {\n\n#define GET_MACRO(a, b, c, d, NAME, ...) NAME\n#define REP1(n) REP2(i_, n)\n#define REP2(i, n) REP3(i, 0, n)\n#define REP3(i, a, b) REP4(i, a, b, 1)\n#define REP4(i, a, b, s) for (ll i = (a); i < (ll)(b); i += (ll)(s))\n#define RREP1(n) RREP2(i_, n)\n#define RREP2(i, n) RREP3(i, 0, n)\n#define RREP3(i, a, b) RREP4(i, a, b, 1)\n#define RREP4(i, a, b, s) for (ll i = (b) - 1; i >= (ll)(a); i -= (ll)(s))\n#define rep(...) GET_MACRO(__VA_ARGS__, REP4, REP3, REP2, REP1)(__VA_ARGS__)\n#define rrep(...) GET_MACRO(__VA_ARGS__, RREP4, RREP3, RREP2, RREP1)(__VA_ARGS__)\n#define each(x, c) for (auto &&x : c)\n#define all(c) std::begin(c), std::end(c)\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing uint = unsigned int;\nusing ld = long double;\ntemplate<typename T>\nusing MinPQ = priority_queue<T, vector<T>, greater<T>>;\ntemplate<typename T>\nusing MaxPQ = priority_queue<T, vector<T>, less<T>>;\ntemplate<bool cond, typename T = void>\nusing enable_if_t = typename enable_if<cond, T>::type;\n\nconst int INF = 1e9 + 10;\nconst ll INF_LL = 1e18 + 10;\nconst double INF_D = 1e12;\nconst ld INF_LD = 1e24;\nconst ld EPS = 1e-8;\nconst ld PI = acos(-1.0l);\nconst int dx[] = {-1, 0, 1, 0, -1, 1, 1, -1};\nconst int dy[] = {0, -1, 0, 1, -1, -1, 1, 1};\n\ntemplate<typename T>\ninline T sq(const T &x){ return x * x; }\ntemplate<typename T, typename U>\ninline T &chmin(T &x, const U &y){ if (x > y) x = y; return x; }\ntemplate<typename T, typename U>\ninline T &chmax(T &x, const U &y){ if (x < y) x = y; return x; }\n\nll gcd(ll a, ll b){ return b ? gcd(b, a % b) : a; }\nll lcm(ll a, ll b){ return a / gcd(a, b) * b; }\ntuple<ll, ll, ll> extgcd(ll a, ll b){\n  if (b == 0) return make_tuple(a, 1, 0);\n  ll g, x, y;\n  tie(g, x, y) = extgcd(b, a % b);\n  return make_tuple(g, y, x - a / b * y);\n}\nll invmod(ll a, ll m = 1000000007){\n  ll g, x;\n  tie(g, x, ignore) = extgcd(a, m);\n  return g == 1 ? (x + m) % m : 0;\n}\n\nvoid solve();\n\n}\n\nsigned main(){\n  auto begin = std::chrono::high_resolution_clock::now();\n  std::ios::sync_with_stdio(false);\n  std::cin.tie(nullptr);\n  std::cout << std::fixed << std::setprecision(12);\n  solver::solve();\n  auto end = std::chrono::high_resolution_clock::now();\n  auto time = std::chrono::duration_cast<std::chrono::milliseconds>(end - begin);\n#ifdef DEBUG\n  std::cerr << \"time: \" << time.count() << \" [ms]\" << std::endl;\n#endif\n}\n\nnamespace solver {\n/* }}} */\n\nvector<pair<string, ll>> s[3];\n\nvector<pair<string, ll>> input(){\n  vector<pair<string, ll>> v;\n  while (true){\n    string c;\n    ll l;\n    cin >> c;\n    if (c == \"$\") break;\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n  return v;\n}\n\nvoid solve(){\n  rep(i, 3) s[i] = input();\n  rep(i, s[0].size()){\n    if (i + s[1].size() > s[0].size()) break;\n    if (s[1].size() == 1){\n      if (s[0][i].first == s[1][0].first && s[0][i].second >= s[1][0].second){\n        s[0][i].second -= s[1][0].second;\n        s[0].insert(begin(s[0]) + i, all(s[2]));\n        break;\n      }\n    }\n    else {\n      bool match = true;\n      match &= s[0][i].first == s[1][0].first;\n      match &= s[0][i].second >= s[1][0].second;\n      match &= s[0][i + s[1].size() - 1].first == s[1].back().first;\n      match &= s[0][i + s[1].size() - 1].second >= s[1].back().second;\n      rep(j, 1, s[1].size() - 1) match &= s[0][i + j] == s[1][j];\n      if (match){\n        rep(j, s[1].size()) s[0][i + j].second -= s[1][j].second;\n        s[0].insert(begin(s[0]) + i + 1, all(s[2]));\n        break;\n      }\n    }\n  }\n  rep(i, s[0].size()){\n    if (s[0][i].second == 0) s[0].erase(begin(s[0]) + i--);\n  }\n  rep(i, s[0].size() - 1){\n    if (s[0][i].first == s[0][i + 1].first){\n      s[0][i].second += s[0][i + 1].second;\n      s[0].erase(begin(s[0]) + i-- + 1);\n    }\n  }\n  each(p, s[0]) cout << p.first << \" \" << p.second << \" \";\n  cout << \"$\\n\";\n}\n\n} /* namespace solver */"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nvoid Output(vector< pair< char, int > >& B)\n{\n  int tal = B.size() - 2;\n  for(int i = B.size() - 1; i > 0; i--) {\n    tal = min(tal, i - 1);\n    while(tal > 0 && B[tal].second == 0) --tal;\n    if(B[i].first == B[tal].first) {\n      B[tal].second += B[i].second;\n      B[i].second = 0;\n    }\n  }\n  for(int i = 0; i < B.size(); i++) {\n    if(B[i].second > 0) {\n      cout << B[i].first << \" \" << B[i].second << \" \";\n    }\n  }\n  cout << \"$\" << endl; \n  exit(0);\n}\n\n\n  \nint main()\n{\n  vector< pair< char, int > > A[3];\n  vector< pair< char, int > > B;\n  \n  for(int i = 0; i < 3; i++) {\n    char C;\n    while(cin >> C, C != '$') {\n      int D;\n      cin >> D;\n      A[i].emplace_back(C, D);\n    }\n  }\n  \n  if(A[1].size() == 1) {\n    for(int i = 0; i < A[0].size(); i++) {\n      if(A[0][i].first == A[1][0].first && A[0][i].second >= A[1][0].second) {\n        for(int j = 0; j < i; j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        for(int j = 0; j < A[2].size(); j++) {\n          B.emplace_back(A[2][j].first, A[2][j].second);\n        }\n        if(A[0][i].second != A[1][0].second) {\n          B.emplace_back(A[0][i].first, A[0][i].second - A[1][0].second);\n        }\n        for(int j = i + 1; j < A[0].size(); j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        Output(B);\n      }\n    }\n  } else {\n    for(int i = 0; i <= A[0].size() - A[1].size(); i++) {\n      if(A[0][i].first == A[1][0].first && A[0][i].second >= A[1][0].second && A[0][i + A[1].size() - 1].first == A[1].back().first && A[0][i + A[1].size() - 1].second >= A[1].back().second) {\n        bool flag = true;\n        for(int j = 1; j < A[1].size() - 1; j++) {\n          flag &= A[0][i + j] == A[1][j];\n        }\n        if(!flag) continue;\n        for(int j = 0; j < i; j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        if(A[0][i].second != A[1][0].second) {\n          B.emplace_back(A[0][i].first, A[0][i].second - A[1][0].second);\n        }\n        for(int j = 0; j < A[2].size(); j++) {\n          B.emplace_back(A[2][j].first, A[2][j].second);\n        }\n        if(A[0][i + A[1].size() - 1].second != A[1].back().second) {\n          B.emplace_back(A[0][i + A[1].size() - 1].first, A[0][i + A[1].size() - 1].second - A[1].back().second);\n        }\n        for(int j = i + A[1].size(); j < A[0].size(); j++) {\n          B.emplace_back(A[0][j].first, A[0][j].second);\n        }\n        Output(B);\n      }\n    }\n  }\n  for(int i = 0; i < A[0].size(); i++) {\n    B.emplace_back(A[0][i].first, A[0][i].second);\n  }\n  Output(B);\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\ntypedef vector<int>vint;\ntypedef pair<int,int>pint;\ntypedef vector<pint>vpint;\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define reps(i,f,n) for(int i=(f);i<(n);i++)\n#define all(v) (v).begin(),(v).end()\n#define each(it,v) for(__typeof((v).begin()) it=(v).begin();it!=(v).end();it++)\n#define pb push_back\n#define fi first\n#define se second\ntemplate<typename A,typename B>inline void chmin(A &a,B b){if(a>b)a=b;}\ntemplate<typename A,typename B>inline void chmax(A &a,B b){if(a<b)a=b;}\n\ntypedef pair<char,int>latte;\n\nvector<latte>in(){\n    char c;\n    int d;\n    vector<latte>A;\n    while(cin>>c,c!='$'){\n        cin>>d;\n        A.pb(latte(c,d));\n    }\n    return A;\n}\n\nsigned main(){\n    vector<latte>A,B,C;\n    A=in();B=in();C=in();\n\n    for(int i=0;i+B.size()<=A.size();i++){\n        bool ok=true;\n        if(A[i].fi!=B[0].fi||A[i].se<B[0].se)ok=false;\n        if(A[i+B.size()-1].fi!=B[B.size()-1].fi||A[i+B.size()-1].se<B[B.size()-1].se)ok=false;\n        for(int j=1;j+1<B.size();j++)if(A[i+j]!=B[j])ok=false;\n        if(!ok)continue;\n        A[i].se-=B[0].se;\n        if(B.size()>1)A[i+B.size()-1].se-=B[B.size()-1].se;\n        for(int j=1;j+1<B.size();j++)A[i+j].se=0;\n        A.insert(A.begin()+i+1,all(C));\n        break;\n    }\n\n    vector<latte>ans;\n    rep(i,A.size()){\n        if(A[i].se==0)continue;\n        if(ans.size()&&ans.back().fi==A[i].fi)ans.back().se+=A[i].se;\n        else ans.pb(A[i]);\n    }\n\n    rep(i,ans.size())cout<<ans[i].fi<<\" \"<<ans[i].se<<\" \";cout<<\"$\"<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\n\nvector<P>A,B,C;\nvoid input(vector<P> &a){\n  int num;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin>>num;\n    a.push_back(P(ch,num));\n  }\n}\n\nbool check(int i){\n  int n = A.size();\n  int m = B.size();\n  if(i+m>n) return 0;\n\n  if(A[i].first!=B[0].first||A[i].second<B[0].second)return 0;\n\n  if(m == 1) return 1;\n\n  int j = 0;\n  for(j++,i++;j<m-1;j++,i++)\n    if(A[i].first!=B[j].first||A[i].second!=B[j].second)return 0;\n  \n  if(A[i].first!=B[j].first||A[i].second<B[j].second)return 0;\n  \n  return 1;\n}\n\nvoid mergePush(vector<P> &res,P a){\n  int c = a.second;\n  char ch = a.first;\n  if(c == 0)return;\n  if(res.size() && res.back().first == ch)res.back().second+=c;\n  else res.push_back(P(ch,c));\n}\n\nvector<P> solve(){\n  vector<P> res;\n  int n = A.size();\n  int m = B.size();\n  int l = C.size();\n  int flg = 0;\n  for(int i=0;i<n;i++){\n    if(!check(i)||flg++){mergePush(res,A[i]);continue;}\n    A[i].second -= B[0].second;\n    if(m == 1) for(int j=0;j<l;j++) mergePush(res,C[j]);\n    else {\n      mergePush(res,P(A[i].first,A[i].second));   \n      for(int j=0;j<l;j++) mergePush(res,C[j]);\n      A[i+m-1].second -= B.back().second;\n    }\n    i+=m-2;\n  }\n  return res;\n}\n\n\nint main(){\n  input(A),input(B),input(C);\n  vector<P> ans = solve();\n  for(P a:ans) cout<<a.first<<\" \"<<a.second<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\nusing namespace std;\ntypedef pair<char,int> P;\n\nchar c[3][10001];\nint l[3][10001];\nint si[3];\nvector<P> ans;\n\nint main(){\n\trep(i,3){\n\t\tfor(int j = 0;;j++){\n\t\t\tcin >> c[i][j];\n\t\t\tif(c[i][j] == '$'){\n\t\t\t\tsi[i] = j;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcin >> l[i][j];\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tif(si[0]-i < si[1]) break;\n\t\tif(c[0][i] == c[1][0] && l[0][i] >= l[1][0]){\n\t\t\tif(si[1] == 1){\n\t\t\t\tl[0][i] -= l[1][0];\n\t\t\t\trep(j,i) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t\trep(j,si[2]) ans.push_back(P(c[2][j],l[2][j]));\n\t\t\t\tfor(int j = i; j < si[0]; j++){\n\t\t\t\t\tif(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t\t}\n\t\t\t\tfor(int j = ans.size()-1; j >= 1; j--){\n\t\t\t\t\tif(ans[j].first == ans[j-1].first){\n\t\t\t\t\t\tans[j-1].second += ans[j].second;\n\t\t\t\t\t\tans[j].second = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trep(j,ans.size()){\n\t\t\t\t\tif(ans[j].second == 0) continue;\n\t\t\t\t\tprintf(\"%c %d \",ans[j].first,ans[j].second);\n\t\t\t\t}\n\t\t\t\tputs(\"$\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbool ok = true;\n\t\t\tfor(int j = 1; j < si[1]-1; j++){\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] != l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!ok) continue;\n\t\t\t{\n\t\t\t\tint j = si[1]-1;\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] < l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t}\n\t\t\t\tif(!ok) continue;\n\t\t\t\tl[0][i] -= l[1][0];\n\t\t\t\tl[0][i+j] -= l[1][j];\n\t\t\t}\n\t\t\trep(j,i+1) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\trep(j,si[2]) ans.push_back(P(c[2][j],l[2][j]));\n\t\t\tfor(int j = i+si[1]-1; j < si[0]; j++){\n\t\t\t\tif(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t}\n\t\t\tfor(int j = ans.size()-1; j >= 1; j--){\n\t\t\t\tif(ans[j].first == ans[j-1].first){\n\t\t\t\t\tans[j-1].second += ans[j].second;\n\t\t\t\t\tans[j].second = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\trep(j,ans.size()){\n\t\t\t\tif(ans[j].second == 0) continue;\n\t\t\t\tprintf(\"%c %d \",ans[j].first,ans[j].second);\n\t\t\t}\n\t\t\tputs(\"$\");\n\t\t\treturn 0;\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tprintf(\"%c %d \",c[0][i],l[0][i]);\n\t}\n\tputs(\"$\");\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <sstream>\n\nusing namespace std;\n\nusing Array = basic_string<pair<char, int>>;\nArray a, b, c;\n\nvoid output(const Array &xs){\n    for(auto &x : xs){\n        cout << '[' << x.first << ',' << x.second << ']';\n    }\n};\n\nvoid input(Array &a) {\n    string c; int l;\n    while (cin >> c, c[0] != '$') {\n        cin >> l;\n        a += make_pair(c[0], l);\n    }\n}\n\nint main(){\n    input(a);\n    input(b);\n    input(c);\n    a = make_pair('0', 0) + a + make_pair('0', 0);\n    if (b.size() == 1) {\n        for (int i = 0; i < a.size(); ++i) {\n            if (a[i].first == b[0].first && a[i].second >= b[0].second) {\n                a[i].second -= b[0].second;\n                a = a.substr(0, i) + c + a.substr(i);\n                break;\n            }\n        }\n    } else {\n        for (int i = 1; i + b.size() - 2 <= a.size(); ++i) {\n            if (b.substr(1, b.size() - 2) == a.substr(i, b.size() - 2)) {\n                if (a[i - 1].first == b[0].first && a[i - 1].second >= b[0].second &&\n                    a[i + b.size() - 2].first == b.back().first && a[i + b.size() - 2].second >= b.back().second) {\n                    // cout << i << endl;\n                    a[i - 1].second -= b[0].second;\n                    a[i + b.size() - 2].second -= b.back().second;\n                    a = a.substr(0, i) + c + a.substr(i + b.size() - 2);\n                    break;\n                }\n            }\n        }\n    }\n\n    a.erase(remove_if(a.begin(), a.end(), [](pair<char,int> x){ return x.second == 0; }), a.end());\n    for (int i = 0; i < a.size(); ++i) {\n        int j = i + 1;\n        while(j < a.size() && a[i].first == a[j].first){\n            a[i].second += a[j].second;\n            a.erase(a.begin() + j);\n        }\n    }\n    for (int i = 0; i < a.size(); ++i) {\n        cout << a[i].first << ' ' << a[i].second << ' ';\n    }\n    cout << '$' << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing P=pair<char,int>;\n\nint main(){\n    vector<P> A,B,C;\n    char c;\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        A.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        B.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        C.emplace_back(c,l);\n    }\n    vector<P> ans;\n    for(int i=0;i<A.size();i++){\n        if(A[i].first==B.front().first&&A[i].second>=B.front().second){\n            bool flag=true;\n            if(i+B.size()<=A.size()){\n                for(int d=1;d<B.size();d++){\n                    if(A[i+d].first!=B[d].first){\n                        flag=false;\n                        break;\n                    }\n                    if(d==B.size()-2){\n                        if(A[i+d].second!=B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }else{\n                        if(A[i+d].second<B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }\n                }\n            }else{\n                continue;\n            }\n            if(flag){\n                for(int j=0;j<i;j++){\n                    ans.push_back(A[j]);\n                }\n                if(A[i].second!=B[0].second){\n                    ans.emplace_back(A[i].first,A[i].second-B[0].second);\n                }\n                for(int j=0;j<C.size();j++){\n                    if(j==0&&ans.back().first==C.front().first){\n                        ans.back().second+=C.front().second;\n                    }else{\n                        ans.push_back(C[j]);\n                    }\n                }\n\n                if(A[i+B.size()-1].second!=B.back().second){\n                    if(ans.back().first==B.back().first){\n                        ans.back().second+=A[i+B.size()-1].second-B.back().second;\n                    }else{\n                        ans.emplace_back(B.back().first, A[i+B.size()-1].second-B.back().second);\n                    }\n                }\n                for(int j=i+B.size();j<A.size();j++){\n                    ans.push_back(A[j]);\n                }\n                for(auto p:ans){\n                    char c; int l;\n                    tie(c,l)=p;\n                    cout<<c<<' '<<l<<' ';\n                }\n                cout<<'$'<<endl;\n                return 0;\n            }\n        }   \n    }\n    for(auto p:A){\n        char c; int l;\n        tie(c,l)=p;\n        cout<<c<<' '<<l<<' ';\n    }\n    cout<<'$'<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\nusing namespace std;\ntypedef pair<char,long long> P;\n\nchar c[3][10001];\nlong long l[3][10001];\nint si[3];\nvector<P> ans;\n\nint main(){\n\trep(i,3){\n\t\tfor(int j = 0;;j++){\n\t\t\tcin >> c[i][j];\n\t\t\tif(c[i][j] == '$'){\n\t\t\t\tsi[i] = j;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcin >> l[i][j];\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tif(si[0]-i < si[1]) break;\n\t\tif(c[0][i] == c[1][0] && l[0][i] >= l[1][0]){\n\t\t\tif(si[1] == 1){\n\t\t\t\tl[0][i] -= l[1][0];\n\t\t\t\trep(j,i) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t\trep(j,si[2]) ans.push_back(P(c[2][j],l[2][j]));\n\t\t\t\tfor(int j = i; j < si[0]; j++){\n\t\t\t\t\tif(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t\t}\n\t\t\t\tfor(int j = ans.size()-1; j >= 1; j--){\n\t\t\t\t\tif(ans[j].first == ans[j-1].first){\n\t\t\t\t\t\tans[j-1].second += ans[j].second;\n\t\t\t\t\t\tans[j].second = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trep(j,ans.size()){\n\t\t\t\t\tif(ans[j].second == 0) continue;\n\t\t\t\t\tprintf(\"%c %lld \",ans[j].first,ans[j].second);\n\t\t\t\t}\n\t\t\t\tputs(\"$\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tbool ok = true;\n\t\t\tfor(int j = 1; j < si[1]-1; j++){\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] != l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!ok) continue;\n\t\t\t{\n\t\t\t\tint j = si[1]-1;\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] < l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(!ok) continue;\n\t\t\t\tl[0][i] -= l[1][0];\n\t\t\t\tl[0][i+j] -= l[1][j];\n\t\t\t}\n\t\t\trep(j,i+1) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\trep(j,si[2]) ans.push_back(P(c[2][j],l[2][j]));\n\t\t\tfor(int j = i+si[1]-1; j < si[0]; j++){\n\t\t\t\tif(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\t}\n\t\t\tfor(int j = ans.size()-1; j >= 1; j--){\n\t\t\t\tif(ans[j].first == ans[j-1].first){\n\t\t\t\t\tans[j-1].second += ans[j].second;\n\t\t\t\t\tans[j].second = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\trep(j,ans.size()){\n\t\t\t\tif(ans[j].second == 0) continue;\n\t\t\t\tprintf(\"%c %lld \",ans[j].first,ans[j].second);\n\t\t\t}\n\t\t\tputs(\"$\");\n\t\t\treturn 0;\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tprintf(\"%c %lld \",c[0][i],l[0][i]);\n\t}\n\tputs(\"$\");\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\n\nvector<P>A,B,C;\nvoid input(vector<P> &a){\n  int num;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin>>num;\n    a.push_back(P(ch,num));\n  }\n}\n\nbool check(int i){\n  int n = A.size();\n  int m = B.size();\n  if(i+m>n) return 0;\n  if(A[i].first!=B[0].first||A[i].second<B[0].second)return 0;\n  if(m == 1) return 1;\n\n  i++;\n  for(int j=1;i<m-1;j++,i++)\n    if(A[i].first!=B[j].first||A[i].second!=B[j].second)return 0;\n  \n  if(A[i].first!=B[m-1].first||A[i].second<B[m-1].second)return 0;\n  return 1;\n}\n\nvoid mergePush(vector<P> &res,P a){\n  int c = a.second;\n  char ch = a.first;\n  if(c == 0)return;\n  if(res.size() && res.back().first == ch)res.back().second+=c;\n  else res.push_back(P(ch,c));\n}\n\nvector<P> solve(){\n  vector<P> res;\n  int n = A.size();\n  int m = B.size();\n  int l = C.size();\n  int flg = 0;\n  for(int i=0;i<n;i++){\n    if(!check(i)||flg++){mergePush(res,A[i]);continue;}\n    A[i].second -= B[0].second;\n    if(m == 1){\n      for(int j=0;j<l;j++) mergePush(res,C[j]);\n      mergePush(res,P(A[i].first,A[i].second));   \n    }\n    else {\n      mergePush(res,P(A[i].first,A[i].second));   \n      for(int j=0;j<l;j++) mergePush(res,C[j]);\n      A[i+m-1].second -= B.back().second;\n    }\n  }\n  return res;\n}\n\n\nint main(){\n  input(A),input(B),input(C);\n  vector<P> ans = solve();\n  for(P a:ans) cout<<a.first<<\" \"<<a.second<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\n\n\nvector<P>A,B,C;\n\nvoid input(vector<P> &a){\n  int num;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin>>num;\n    a.push_back(P(ch,num));\n  }\n}\n\nbool check(int i){\n  int n = A.size();\n  int m = B.size();\n  if(i+m>n) return 0;\n  if(A[i].first!=B[0].first||A[i].second<B[0].second)return 0;\n  if(m == 1) return 1;\n\n  i++;\n  for(int j=1;i<m-1;j++,i++)\n    if(A[i].first!=B[j].first||A[i].second!=B[j].second)return 0;\n  \n  if(A[i].first!=B[m-1].first||A[i].second<B[m-1].second)return 0;\n  return 1;\n}\n\nvoid mergePush(vector<P> &res,P a){\n  int c = a.second;\n  char ch = a.first;\n  if(c == 0)return;\n  if(res.size() && res.back().first == ch)res.back().second+=c;\n  else res.push_back(P(ch,c));\n}\n\nvector<P> solve(){\n  vector<P> res;\n  int n = A.size();\n  int m = B.size();\n  int l = C.size();\n  for(int i=0;i<n;i++){\n    if(A[i].second == 0) continue;\n    if(!check(i)){mergePush(res,A[i]);continue;}\n    \n    mergePush(res,P(A[i].first,A[i].second - B[0].second));   \n    for(int j=0;j<l;j++) mergePush(res,C[j]);\n    i+=m-1;\n    A[i--].second -= B.back().second;\n    \n    }\n  return res;\n}\n\n\nint main(){\n  input(A);\n  input(B);\n  input(C);\n  assert(B.size()>1);\n  vector<P> ans = solve();\n  for(P a:ans) cout<<a.first<<\" \"<<a.second<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n#include <fstream>\n\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\n#define watch(a) { cout << #a << \" = \" << a << endl; }\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntypedef long long ll;\nint const inf = 1<<29;\n\nvoid change(deque<pair<char, int>>& nv0) {\n  if(nv0.size() > 1 && nv0[nv0.size()-2].first == nv0.back().first) {\n    int k = nv0.back().second;\n    nv0.pop_back();\n    nv0.back().second += k;\n  }\n}\n\nvoid output(deque<pair<char, int>>& out) {\n  rep(i, out.size()) {\n    if(i) cout << \" \";\n    cout << out[i].first << \" \" << out[i].second;\n  }\n  cout << \" $\" << endl;\n}\n\nint main() {\n\n  vector<deque<pair<char, int>>> v(3);\n  for(auto& u: v) {\n    while(1) {\n      char c; cin >> c;\n      if(c == '$') break;\n      int n; cin >> n;\n      u.emplace_back(c, n);\n    }\n  }\n\n  rep(i, (int)v[0].size()-(int)v[1].size()+1) {\n\n    int j = 0;\n    vector<int> V;\n    while(j < v[1].size() && v[0][i+j].first == v[1][j].first) {\n      if(j == 0 || j == (int)v[1].size()-1) {\n        if(v[0][i+j].second < v[1][j].second) break;\n        V.push_back(v[0][i+j].second - v[1][j].second);\n      }\n      else {\n        if(v[0][i+j].second != v[1][j].second) break;\n      }\n      j++;\n    }\n\n    deque<pair<char, int>> nv0;\n\n    if(j == v[1].size()) {\n      rep(k, v[0].size()) {\n        if(k < i) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n        if(k == i) {\n          if(V[0] > 0) nv0.emplace_back(v[0][i].first, V[0]);\n          rep(l, v[2].size()) {\n            nv0.push_back(v[2][l]);\n            change(nv0);\n          }\n          k = i+v[1].size()-1;\n        }\n        if(k == i+j-1) {\n          if(V[1] > 0) nv0.emplace_back(v[0][i+j-1].first, V[1]);\n          change(nv0);\n        }\n        if(i+j <= k) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n      }\n      v[0] = nv0;\n      break;\n    }\n  }\n\n  output(v[0]);\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\nint main(){\n  vector<char> A_c, B_c, C_c, ans_c;\n  vector<int> A_l, B_l, C_l, ans_l;\n  char c_ = '!';\n  int l;\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    A_c.push_back(c_);\n    A_l.push_back(l);\n  }\n  c_ = '!';\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    B_c.push_back(c_);\n    B_l.push_back(l);\n  }\n  c_ = '!';\n  while(cin >> c_, c_ != '$'){\n    cin >> l;\n    C_c.push_back(c_);\n    C_l.push_back(l);\n  }\n  int a = A_c.size(), b = B_c.size(), c = C_c.size();\n  bool g = false;\n  for(int i = 0; i < a; ++i){\n    bool f = true;\n    for(int j = 0; j < b; ++j){\n      if(g || i+j >= a){\n        f = false;\n        break;\n      }\n      if((j > 0 && j < b - 1 && A_l[i+j] != B_l[j]) ||\n         (A_c[i+j] != B_c[j]) ||\n         (j%(b-1) == 0 && A_l[i+j] < B_l[j])){\n        f = false;\n        break;\n      }\n    }\n    if(f){\n      g = true;\n      if(A_l[i] - B_l[0] > 0){\n        ans_c.push_back(A_c[i]);\n        ans_l.push_back(A_l[i] - B_l[0]);\n      }\n      for(int j = 0; j < c; ++j){\n        if(ans_c.size() > 0 && ans_c.back() == C_c[j]) ans_l.back() += C_l[j];\n        else{\n          ans_c.push_back(C_c[j]);\n          ans_l.push_back(C_l[j]);\n        }\n      }\n      if(A_l[i+b-1] - B_l.back() > 0){\n        if(ans_c.back() == A_c[i+b-1]) ans_l.back() += A_l[i+b-1] - B_l[b-1];\n        else{\n          ans_c.push_back(A_c[i+b-1]);\n          ans_l.push_back(A_l[i+b-1] - B_l[b-1]);\n        }\n      }\n    }else{\n      if(ans_c.size() > 0 && ans_c.back() == A_c[i]) ans_l.back() += A_l[i];\n      else{\n        ans_c.push_back(A_c[i]);\n        ans_l.push_back(A_l[i]);\n      }\n    }\n    i += b-1;\n  }\n  for(int i = 0; i < ans_c.size(); ++i){\n    cout << ans_c[i] <<  \" \" << ans_l[i] << \" \";\n  }\n  cout << \"$\" << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nstruct UnionFind {\n\tvector<int> v;\n\tUnionFind(int n) : v(n) { for (int i = 0; i < n; i++) v[i] = i; }\n\tint  find(int x) { return v[x] == x ? x : v[x] = find(v[x]); }\n\tvoid unite(int x, int y) { v[find(x)] = find(y); }\n};\n\nint main() {\n\tvector<pair<char, long long>> A;\n\tvector<pair<char, long long>> B;\n\tvector<pair<char, long long>> C;\n\tchar c;\n\twhile (cin >> c, c != '$') {\n\t\tint a;\n\t\tcin >> a;\n\t\tA.push_back({ c,a });\n\t}\n\twhile (cin >> c, c != '$') {\n\t\tint a;\n\t\tcin >> a;\n\t\tB.push_back({ c,a });\n\t}\n\twhile (cin >> c, c != '$') {\n\t\tint a;\n\t\tcin >> a;\n\t\tC.push_back({ c,a });\n\t}\n\tint clear = -1;\n\tREP(i, A.size() - B.size() + 1) {\n\t\tREP(j, B.size()) {\n\t\t\tif (A[i + j].first == B[j].first&&A[i + j].second >= B[j].second) {\n\t\t\t\tif (j != 0 && j != B.size()-1 && A[i + j].second > B[j].second)\n\t\t\t\t\tbreak;\n\t\t\t\tif (j == B.size() - 1) {\n\t\t\t\t\tclear = i;\n\t\t\t\t\ti = A.size();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tvector<pair<char, long long>> ANS = A;\n\tif (clear != -1) {\n\t\tif (B.size() == 1) {\n\t\t\tANS[clear].second -= B[0].second;\n\t\t\tREP(i, C.size())\n\t\t\tANS.insert(ANS.begin() + clear+i, C[i]);\n\t\t}\n\t\telse {\n\t\t\tREP(i, B.size()) {\n\t\t\t\tANS[clear+i].second -= B[i].second;\n\t\t\t}\n\t\t\tREP(i,C.size())\n\t\t\tANS.insert(ANS.begin() + clear + 1+i, C[i]);\n\t\t}\n\t\tREP(i, ANS.size())\n\t\t\tif (ANS[i].second == 0) {\n\t\t\t\tANS.erase(ANS.begin() + i);\n\t\t\t\ti--;\n\t\t\t}\n\t\tREP(i, ANS.size()-1)\n\t\t\tif (ANS[i].first ==ANS[i+1].first) {\n\t\t\t\tANS[i].second += ANS[i + 1].second;\n\t\t\t\tANS.erase(ANS.begin() + i+1);\n\t\t\t\ti--;\n\t\t\t}\n\t}\n\n\tREP(i, ANS.size()) {\n\t\tcout << ANS[i].first << \" \" << ANS[i].second << \" \";\n\t}\n\tcout << \"$\" << endl;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nsigned main() {\n  vector<char> ca;\n  vector<int> la;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      ca.emplace_back(c);\n      la.emplace_back(l);      \n    }\n  }\n\n  vector<char> cb;\n  vector<int> lb;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      cb.emplace_back(c);\n      lb.emplace_back(l);      \n    }\n  }\n\n  vector<char> cc;\n  vector<int> lc;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      cc.emplace_back(c);\n      lc.emplace_back(l);      \n    }\n  }\n\n  int a = ca.size(), b = cb.size(), c = cc.size();\n  vector<char> ansc;\n  vector<int> ansl;  \n  for ( int i = 0; i < a; i++ ) {\n    if ( ca[i] != cb[0] || la[i] < lb[0] ) continue;\n    if ( i+b > a ) continue;\n    if ( ca[i+b-1] != cb[b-1] ||la[i+b-1] < lb[b-1] ) continue;\n    bool flag = true;\n    for ( int j = 1; j < b-1; j++ ) {\n      if ( ca[i+j] != cb[j] ||la[i+j] != lb[j] ) {\n\tflag = false;\n\tbreak;\n      }\n    }\n\n    if ( flag ) {\n      if ( b == 1 ) {\n\tfor ( int j = 0; j < i; j++ ) {\n\t  // cout << ca[j] << \" \" << la[j] << \" \";\n\t  ansc.emplace_back(ca[j]);\n\t  ansl.emplace_back(la[j]);\n\t}\n\tfor ( int j = 0; j < c; j++ ) {\n\t  // cout << cc[i] << \" \" << lc[j] << \" \";\n\t  ansc.emplace_back(cc[j]);\n\t  ansl.emplace_back(lc[j]);\n\t}\n\tif ( la[i]-lb[0] >= 1 ) {\n\t  ansc.emplace_back(ca[i]);\n\t  ansl.emplace_back(la[i]-lb[0]);\n\t}\n\tfor ( int j = i+b; j < a; j++ ) {\n\t  // cout << ca[j] << \" \" << la[j] << \" \";\n\t  ansc.emplace_back(ca[j]);\n\t  ansl.emplace_back(la[j]);\t\n\t}\n\tbreak;  \n      } else {\n\tfor ( int j = 0; j < i; j++ ) {\n\t  // cout << ca[j] << \" \" << la[j] << \" \";\n\t  ansc.emplace_back(ca[j]);\n\t  ansl.emplace_back(la[j]);\n\t}\n\t// cout << ca[i] << \" \" << la[i]-lb[0] << \" \";\n\tif ( la[i]-lb[0] >= 1 ) {\n\t  ansc.emplace_back(ca[i]);\n\t  ansl.emplace_back(la[i]-lb[0]);\n\t}\n\tfor ( int j = 0; j < c; j++ ) {\n\t  // cout << cc[i] << \" \" << lc[j] << \" \";\n\t  ansc.emplace_back(cc[j]);\n\t  ansl.emplace_back(lc[j]);\n\t}\n\t// cout << ca[i+b-1] << \" \" << la[i+b-1]-lb[b-1] << \" \";\n\tif ( b > 1 ) {\n\t  if ( la[i+b-1]-lb[b-1] >= 1 ) {\n\t    ansc.emplace_back(ca[i+b-1]);\n\t    ansl.emplace_back(la[i+b-1]-lb[b-1]);\n\t  }\n\t}\n\tfor ( int j = i+b; j < a; j++ ) {\n\t  // cout << ca[j] << \" \" << la[j] << \" \";\n\t  ansc.emplace_back(ca[j]);\n\t  ansl.emplace_back(la[j]);\t\n\t}\n\tbreak;      \n      }\n    }\n  }\n\n  if ( ansc.size() == 0 ) {\n    ansc = ca; ansl = la;    \n  }\n  \n  for ( int i = 0; i < (int)ansc.size(); i++ ) {\n    if ( ansl[i] == 0 ) continue;    \n    if ( i < (int)ansc.size()-1 ) {\n      if ( ansc[i] == ansc[i+1] ) {\n\tansl[i+1] += ansl[i];\t\n      } else {\n\tcout << ansc[i] << \" \" << ansl[i] << \" \";\t\n      }\n    } else {\n      cout << ansc[i] << \" \" << ansl[i] << \" \";\t\n    }\n  }\n  cout << '$' << endl;\n  \n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\ntypedef pair<char, int> pci;\n\nint main()\n{\n\tvector<pci> a, b, c;\n\tchar let; int n;\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\ta.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tb.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tc.emplace_back(let, n);\n\t}\n\tvector<pci> res;\n\t\n\tREP(i, (int)a.size() - (int)b.size() + 1)\n\t{\n\t\tif (a[i].first == b[0].first&&a[i].second >= b[0].second)\n\t\t{\n\t\t\tbool f = true;\n\t\t\tint j;\n\t\t\tfor (j = 1; j < b.size(); j++)\n\t\t\t{\n\t\t\t\tif (j == b.size() - 1)\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second > a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second != a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (f)\n\t\t\t{\n\t\t\t\tif (b.size() == 1)\n\t\t\t\t{\n\t\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\t\tif (a[i].second > b[0].second) res.emplace_back(a[i].first, a[i].second - b[0].second);\n\t\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\t\tif (a[i].second > b[0].second) res.emplace_back(a[i].first, a[i].second - b[0].second);\n\t\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\t\tif (a[i + b.size() - 1].second > b.back().second) res.emplace_back(b.back().first, a[i + b.size() - 1].second - b.back().second);\n\t\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\t\ti = INF;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tvector<pci> ans;\n\tif (res.size() == 0) ans = a;\n\telse\n\t{\n\t\tans.emplace_back(res[0]);\n\t\tFOR(i, 1, res.size())\n\t\t{\n\t\t\tif (res[i].first == ans.back().first) ans.back().second += res[i].second;\n\t\t\telse ans.emplace_back(res[i]);\n\t\t}\n\t}\n\tREP(i, ans.size()) cout << ans[i].first << \" \" << ans[i].second << (i == ans.size() - 1 ? \" $\\n\" : \" \");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n \nusing namespace std;\n \nint main() {\n    string str[3];\n    vector<vector<int> > num(3);\n \n    for(int i = 0; i < 3; i++) {\n        string str_tmp;\n        vector<int> num_tmp;\n        while(true) {\n            char c;\n            int n;\n            cin >> c;\n            if(c == '$') {\n                break;\n            }\n            cin >> n;\n            str_tmp += c;\n            num_tmp.push_back(n);\n        }\n        str[i] = str_tmp;\n        num[i] = num_tmp;\n    }\n \n    string A = str[0];\n    string B = str[1];\n    string C = str[2];\n \n    int idx = 0;\n    int pos;\n    bool flag = false;\n \n    while((pos = A.find(B, idx)) != string::npos) {\n        int i = pos;\n        flag = true;\n        while(i < pos+B.size()) {\n            if(i == pos) {\n                if(num[0][i] < num[1][i-pos]) {\n                    flag = false;\n                }\n            }\n            else if(i == pos+B.size()-1) {\n                if(num[0][i] < num[1][i-pos]) {\n                    flag = false;\n                }\n            }\n            else {\n                if(num[0][i] != num[1][i-pos]) {\n                    flag = false;\n                }\n            }\n            i++;\n        }\n        if(!flag) {\n            idx = pos+1;\n        }\n        else {\n            break;\n        }\n    }\n \n    if(flag) {\n        string D = A.substr(0, pos);\n        vector<int> D_num;\n        for(int i = 0; i < pos; i++) {\n            D_num.push_back(num[0][i]);\n        }\n \n        if(B.size() != 1) {\n            if(num[0][pos] > num[1][0]) {\n                D.push_back(B[0]);\n                D_num.push_back(num[0][pos] - num[1][0]);\n            }\n        }\n \n        D += C;\n        for(int i = 0; i < C.size(); i++) {\n            D_num.push_back(num[2][i]);\n        }\n \n        if(num[0][pos+B.size()-1] > num[1].back()) {\n            D.push_back(B.back());\n            D_num.push_back(num[0][pos+B.size()-1] - num[1].back());\n        }\n \n        for(int i = pos+B.size(); i < A.size(); i++) {\n            D_num.push_back(num[0][i]);\n        }\n        D += A.substr(pos+B.size());\n \n        for(int i = 0; i < D.size(); i++) {\n            char c = D[i];\n            int n = D_num[i];\n            if(i < D.size()-1 && D[i] == D[i+1]) {\n                D_num[i+1] += n;\n                continue;\n            }\n            else {\n                cout << c << \" \" << n << \" \";\n            }\n        }\n        cout << \"$\" << endl;\n    }\n    else {\n        for(int i = 0; i < A.size(); i++) {\n            cout << A[i] << \" \" << num[0][i] << \" \";\n        }\n        cout << \"$\" << endl;\n         \n    }\n \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\ntypedef pair<char, ll> pci;\nvector<pci> a, b, c;\n\nint main()\n{\n\tchar let; ll n;\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\ta.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tb.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tc.emplace_back(let, n);\n\t}\n\tvector<pci> res;\n\t\n\tREP(i, (int)a.size() - (int)b.size() + 1)\n\t{\n\t\tif (a[i].first == b[0].first&&a[i].second >= b[0].second)\n\t\t{\n\t\t\tbool f = true;\n\t\t\tint j;\n\t\t\tfor (j = 1; j < b.size(); j++)\n\t\t\t{\n\t\t\t\tif (j == b.size() - 1)\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second > a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second != a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (f)\n\t\t\t{\n\t\t\t\tif (b.size() == 1)\n\t\t\t\t{\n\t\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\t\tif (a[i].second > b[0].second) res.emplace_back(a[i].first, a[i].second - b[0].second);\n\t\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\t\tif (a[i].second > b[0].second) res.emplace_back(a[i].first, a[i].second - b[0].second);\n\t\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\t\tif (a[i + b.size() - 1].second > b.back().second) res.emplace_back(b.back().first, a[i + b.size() - 1].second - b.back().second);\n\t\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\t\ti = INF;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tvector<pci> ans;\n\tif (res.size() == 0) ans = a;\n\telse\n\t{\n\t\tans.emplace_back(res[0]);\n\t\tFOR(i, 1, res.size())\n\t\t{\n\t\t\tif (res[i].first == ans.back().first) ans.back().second += res[i].second;\n\t\t\telse ans.emplace_back(res[i]);\n\t\t}\n\t}\n\tREP(i, ans.size()) cout << ans[i].first << \" \" << ans[i].second << \" \";\n\tcout << \"$\\n\";\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\nusing namespace std;\nvector<pair<char,int> >a[5];\nint main(){\n\tfor(int i=0;i<3;i++){\n\t\twhile(true){\n\t\t\tchar C;int P;\n\t\t\tcin>>C;if(C=='$')break;\n\t\t\tcin>>P;a[i].push_back(make_pair(C,P));\n\t\t}\n\t}\n\tfor(int i=0;i<=a[0].size()-a[1].size();i++){\n\t\tif(a[0][i].first!=a[1][0].first)continue;\n\t\tif(a[0][i].second<a[1][0].second)continue;\n\t\tint OK=0;\n\t\tfor(int j=1;j<a[1].size();j++){\n\t\t\tif(j!=a[1].size()-1){\n\t\t\t\tif(a[0][i+j].first!=a[1][j].first)OK=1;\n\t\t\t\tif(a[0][i+j].second!=a[1][j].second)OK=1;\n\t\t\t}\n\t\t\tif(j==a[1].size()-1){\n\t\t\t\tif(a[0][i+j].first!=a[1][j].first)OK=1;\n\t\t\t\tif(a[0][i+j].second<a[1][j].second)OK=1;\n\t\t\t}\n\t\t}\n\t\tif(OK==0){\n\t\t\t//start\n\t\t\tfor(int j=0;j<i;j++)a[3].push_back(a[0][j]);\n\t\t\t//second\n\t\t\tif(a[1].size()>=2){\n\t\t\t\ta[3].push_back(make_pair(a[0][i].first,a[0][i].second-a[1][0].second));\n\t\t\t}\n\t\t\t//third\n\t\t\tfor(int j=0;j<a[2].size();j++)a[3].push_back(a[2][j]);\n\t\t\t//fourth\n\t\t\tint num=a[0][i+a[1].size()-1].second-a[1][a[1].size()-1].second;\n\t\t\ta[3].push_back(make_pair(a[1][a[1].size()-1].first,num));\n\t\t\t//fifth\n\t\t\tfor(int j=i+a[1].size();j<a[0].size();j++)a[3].push_back(a[0][j]);\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor(int i=0;i<a[3].size();i++){\n\t\tif(i==0)a[4].push_back(a[3][i]);\n\t\telse{\n\t\t\tif(a[3][i].second==0)continue;\n\t\t\tif(a[4][a[4].size()-1].first==a[3][i].first){\n\t\t\t\ta[4][a[4].size()-1].second+=a[3][i].second;\n\t\t\t}\n\t\t\telse{a[4].push_back(a[3][i]);}\n\t\t}\n\t}\n\tfor(int i=0;i<a[4].size();i++){\n\t\tcout<<a[4][i].first<<' '<<a[4][i].second<<' ';\n\t}\n\tcout<<\"$\"<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef pair<char,int> P;\n\nvector<P> A,B,C,ans;\nint a,b,c;\n\nvector<P> input(){\n  char ch;\n  int num;\n  vector<P> res;\n  while(1){\n    cin>>ch;\n    if(ch=='$')break;\n    cin>>num;\n    res.push_back(P(ch,num));\n  }\n  return res;\n}\n\nint main(){\n  A=input();a=A.size();\n  B=input();b=B.size();\n  C=input();c=C.size();  \n  for(int i=0;i+b-1<a;i++){\n    bool flg=true;\n    for(int j=0;j<b;j++){\n      if(A[i+j].first!=B[j].first)flg=false;\n      if(j==0||j+1==b){\n        if(A[i+j].second<B[j].second)flg=false;\n      }else{\n        if(A[i+j].second!=B[j].second)flg=false;\n      }\n    }\n    if(flg){\n      for(int k=0;k<i;k++)ans.push_back(A[k]);\n      if(b>1){\n        A[i].second-=B[0].second;\n        if(A[i].second>0)ans.push_back(A[i]);\n      }\n      for(int k=0;k<c;k++)ans.push_back(C[k]);\n      A[i+b-1].second-=B[b-1].second;\n      if(A[i+b-1].second>0)ans.push_back(A[i+b-1]);\n      for(int k=i+b;k<a;k++)ans.push_back(A[k]);\n      break;\n    }\n  }\n  if(ans.empty())ans=A;\n\n  for(int i=0;i<(int)ans.size();i++){\n    if(i+1<(int)ans.size() && ans[i].first==ans[i+1].first){\n      ans[i+1].second+=ans[i].second;\n    }else{\n      cout<<ans[i].first<<' '<<ans[i].second<<' ';\n    }\n  }\n  cout<<'$'<<endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "/* template.cpp {{{ */\n#include <bits/stdc++.h>\nusing namespace std;\n\nnamespace solver {\n\n#define GET_MACRO(a, b, c, d, NAME, ...) NAME\n#define REP1(n) REP2(i_, n)\n#define REP2(i, n) REP3(i, 0, n)\n#define REP3(i, a, b) REP4(i, a, b, 1)\n#define REP4(i, a, b, s) for (ll i = (a); i < (ll)(b); i += (ll)(s))\n#define RREP1(n) RREP2(i_, n)\n#define RREP2(i, n) RREP3(i, 0, n)\n#define RREP3(i, a, b) RREP4(i, a, b, 1)\n#define RREP4(i, a, b, s) for (ll i = (b) - 1; i >= (ll)(a); i -= (ll)(s))\n#define rep(...) GET_MACRO(__VA_ARGS__, REP4, REP3, REP2, REP1)(__VA_ARGS__)\n#define rrep(...) GET_MACRO(__VA_ARGS__, RREP4, RREP3, RREP2, RREP1)(__VA_ARGS__)\n#define each(x, c) for (auto &&x : c)\n#define all(c) std::begin(c), std::end(c)\n\nusing ll = long long;\nusing ull = unsigned long long;\nusing uint = unsigned int;\nusing ld = long double;\ntemplate<typename T>\nusing MinPQ = priority_queue<T, vector<T>, greater<T>>;\ntemplate<typename T>\nusing MaxPQ = priority_queue<T, vector<T>, less<T>>;\ntemplate<bool cond, typename T = void>\nusing enable_if_t = typename enable_if<cond, T>::type;\n\nconst int INF = 1e9 + 10;\nconst ll INF_LL = 1e18 + 10;\nconst double INF_D = 1e12;\nconst ld INF_LD = 1e24;\nconst ld EPS = 1e-8;\nconst ld PI = acos(-1.0l);\nconst int dx[] = {-1, 0, 1, 0, -1, 1, 1, -1};\nconst int dy[] = {0, -1, 0, 1, -1, -1, 1, 1};\n\ntemplate<typename T>\ninline T sq(const T &x){ return x * x; }\ntemplate<typename T, typename U>\ninline T &chmin(T &x, const U &y){ if (x > y) x = y; return x; }\ntemplate<typename T, typename U>\ninline T &chmax(T &x, const U &y){ if (x < y) x = y; return x; }\n\nll gcd(ll a, ll b){ return b ? gcd(b, a % b) : a; }\nll lcm(ll a, ll b){ return a / gcd(a, b) * b; }\ntuple<ll, ll, ll> extgcd(ll a, ll b){\n  if (b == 0) return make_tuple(a, 1, 0);\n  ll g, x, y;\n  tie(g, x, y) = extgcd(b, a % b);\n  return make_tuple(g, y, x - a / b * y);\n}\nll invmod(ll a, ll m = 1000000007){\n  ll g, x;\n  tie(g, x, ignore) = extgcd(a, m);\n  return g == 1 ? (x + m) % m : 0;\n}\n\nvoid solve();\n\n}\n\nsigned main(){\n  auto begin = std::chrono::high_resolution_clock::now();\n  std::ios::sync_with_stdio(false);\n  std::cin.tie(nullptr);\n  std::cout << std::fixed << std::setprecision(12);\n  solver::solve();\n  auto end = std::chrono::high_resolution_clock::now();\n  auto time = std::chrono::duration_cast<std::chrono::milliseconds>(end - begin);\n#ifdef DEBUG\n  std::cerr << \"time: \" << time.count() << \" [ms]\" << std::endl;\n#endif\n}\n\nnamespace solver {\n/* }}} */\n\nvector<pair<string, ll>> s[3];\n\nvector<pair<string, ll>> input(){\n  vector<pair<string, ll>> v;\n  while (true){\n    string c;\n    ll l;\n    cin >> c;\n    if (c == \"$\") break;\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n  return v;\n}\n\nvoid solve(){\n  rep(i, 3) s[i] = input();\n  rep(i, s[0].size()){\n    if (i + s[1].size() > s[0].size()) continue;\n    if (s[1].size() == 1){\n      if (s[0][i].first == s[1][0].first && s[0][i].second >= s[1][0].second){\n        s[0][i].second -= s[1][0].second;\n        s[0].insert(begin(s[0]) + i, all(s[2]));\n        break;\n      }\n    }\n    else {\n      bool match = true;\n      match &= s[0][i].first == s[1][0].first;\n      match &= s[0][i].second >= s[1][0].second;\n      match &= s[0][i + s[1].size() - 1].first == s[1].back().first;\n      match &= s[0][i + s[1].size() - 1].second >= s[1].back().second;\n      rep(j, 1, s[1].size() - 1) match &= s[0][i + j] == s[1][j];\n      if (match){\n        rep(j, s[1].size()) s[0][i + j].second -= s[1][j].second;\n        s[0].insert(begin(s[0]) + i + 1, all(s[2]));\n        break;\n      }\n    }\n  }\n  rep(i, s[0].size()){\n    if (s[0][i].second == 0) s[0].erase(begin(s[0]) + i);\n  }\n  rep(i, s[0].size() - 1){\n    if (s[0][i].first == s[0][i + 1].first){\n      s[0][i].second += s[0][i + 1].second;\n      s[0].erase(begin(s[0]) + i + 1);\n      i--;\n    }\n  }\n  each(p, s[0]) cout << p.first << \" \" << p.second << \" \";\n  cout << \"$\\n\";\n}\n\n} /* namespace solver */"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <string>\nusing namespace std;\n\nchar data[4][1000001];\nint cnt[4][1000001];\nint len[4];\nint main(void){\n\tfor(int i=0;i<3;i++){\n\t\twhile(1){\n\t\t\tscanf(\"%c%*c\",&data[i][len[i]]);\n\t\t\tif(data[i][len[i]]=='$'){\n\t\t\t\tlen[i]++;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tscanf(\"%d%*c\",&cnt[i][len[i]]);\n\t\t\tlen[i]++;\n\t\t}\n\t}\n\tint i;\n\tfor(i=0;i<=len[0]-len[1];i++){\n\t\tint j;\n\t\tfor(j=0;j<len[1]-1;j++){\n\t\t\tif(data[0][i+j]!=data[1][j])break;\n\t\t\tif(j==0 && cnt[0][i+j]>cnt[1][j])continue;\n\t\t\tif(cnt[0][i+j]==cnt[1][j])continue;\n\t\t\tif(j==len[1]-2 && cnt[0][i+j]>cnt[1][j])continue;\n\t\t\tbreak;\n\t\t}\n\t\tif(j==len[1]-1){\n\t\t\tfor(int j=0;j<len[0];j++){\n\t\t\t\tif(j<i){\n\t\t\t\t\tdata[3][len[3]]=data[0][j];\n\t\t\t\t\tcnt[3][len[3]]=cnt[0][j];\n\t\t\t\t\tlen[3]++;\n\t\t\t\t}else if(i==j){\n\t\t\t\t\tif(len[1]==2){\n\t\t\t\t\t\tfor(int k=0;k<len[2]-1;k++){\n\t\t\t\t\t\t\tif(len[3]>0 && data[3][len[3]-1]==data[2][k])cnt[3][len[3]-1]+=cnt[2][k];\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tdata[3][len[3]]=data[2][k];\n\t\t\t\t\t\t\t\tcnt[3][len[3]]=cnt[2][k];\n\t\t\t\t\t\t\t\tlen[3]++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(cnt[0][j]>cnt[1][0]){\n\t\t\t\t\t\t\tif(len[3]>0 && data[3][len[3]-1]==data[0][j])cnt[3][len[3]-1]+=cnt[0][j]-cnt[1][0];\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tdata[3][len[3]]=data[0][j];\n\t\t\t\t\t\t\t\tcnt[3][len[3]]=cnt[0][j]-cnt[1][0];\n\t\t\t\t\t\t\t\tlen[3]++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(cnt[0][j]>cnt[1][0]){\n\t\t\t\t\t\t\tdata[3][len[3]]=data[0][j];\n\t\t\t\t\t\t\tcnt[3][len[3]]=cnt[0][j]-cnt[1][0];\n\t\t\t\t\t\t\tlen[3]++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(int k=0;k<len[2]-1;k++){\n\t\t\t\t\t\t\tif(len[3]>0 && data[3][len[3]-1]==data[2][k])cnt[3][len[3]-1]+=cnt[2][k];\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tdata[3][len[3]]=data[2][k];\n\t\t\t\t\t\t\t\tcnt[3][len[3]]=cnt[2][k];\n\t\t\t\t\t\t\t\tlen[3]++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else if(len[1]>2 && j==i+len[1]-2){\n\t\t\t\t\tif(cnt[0][j]>cnt[1][len[1]-2]){\n\t\t\t\t\t\tif(len[3]>0 && data[3][len[3]-1]==data[0][j])cnt[3][len[3]-1]+=cnt[0][j]-cnt[1][len[1]-2];\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdata[3][len[3]]=data[0][j];\n\t\t\t\t\t\t\tcnt[3][len[3]]=cnt[0][j]-cnt[1][len[1]-2];\n\t\t\t\t\t\t\tlen[3]++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}else if(j>=i+len[1]-1){\n\t\t\t\t\tif(len[3]>0 && data[3][len[3]-1]==data[0][j])cnt[3][len[3]-1]+=cnt[0][j];\n\t\t\t\t\telse{\n\t\t\t\t\t\tdata[3][len[3]]=data[0][j];\n\t\t\t\t\t\tcnt[3][len[3]]=cnt[0][j];\n\t\t\t\t\t\tlen[3]++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\tif(i==len[0]-len[1]+1 || len[0]<len[1]){\n\t\tfor(int j=0;j<len[0];j++){\n\t\t\tprintf(\"%c\",data[0][j]);\n\t\t\tif(data[0][j]=='$'){\n\t\t\t\tprintf(\"\\n\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tprintf(\" %d \",cnt[0][j]);\n\t\t}\n\t}\n\tfor(i=0;i<len[3];i++){\n\t\tprintf(\"%c\",data[3][i]);\n\t\tif(data[3][i]=='$'){\n\t\t\tprintf(\"\\n\");\n\t\t\tbreak;\n\t\t}\n\t\tprintf(\" %d \",cnt[3][i]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\nusing namespace std;\ntypedef pair<char,int> P;\n\nchar c[3][1000];\nint l[3][1000];\nint si[3];\nvector<P> ans;\n\nint main(){\n\trep(i,3){\n\t\tfor(int j = 0;;j++){\n\t\t\tcin >> c[i][j];\n\t\t\tif(c[i][j] == '$'){\n\t\t\t\tsi[i] = j;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcin >> l[i][j];\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tif(si[0]-i < si[1]) break;\n\t\tif(c[0][i] == c[1][0] && l[0][i] >= l[1][0]){\n\t\t\tbool ok = true;\n\t\t\tfor(int j = 1; j < si[1]-1; j++){\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] != l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!ok) continue;\n\t\t\t{\n\t\t\t\tint j = si[1]-1;\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] < l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(!ok) continue;\n\t\t\t\tl[0][i] -= l[1][0];\n\t\t\t\tif(j != 0) l[0][i+j] -= l[1][j];\n\t\t\t}\n\t\t\trep(j,i+1) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\trep(j,si[2]) ans.push_back(P(c[2][j],l[2][j]));\n\t\t\tfor(int j = i+si[1]-1; j < si[0]; j++) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\tfor(int j = ans.size()-1; j >= 1; j--){\n\t\t\t\tif(ans[j].first == ans[j-1].first){\n\t\t\t\t\tans[j-1].second += ans[j].second;\n\t\t\t\t\tans[j].second = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\trep(j,ans.size()){\n\t\t\t\tif(ans[j].second == 0) continue;\n\t\t\t\tprintf(\"%c %d \",ans[j].first,ans[j].second);\n\t\t\t}\n\t\t\tputs(\"$\");\n\t\t\treturn 0;\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tprintf(\"%c %d \",c[0][i],l[0][i]);\n\t}\n\tputs(\"$\");\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=long long;\nstruct RLEchar{\n    char x;\n    ll len;\n};\n\nusing RLE=vector<RLEchar>;\nistream& operator>>(istream& in,RLE& rle){\n    char c;\n    while(cin>>c,c!='$'){\n        int l; cin>>l;\n        rle.push_back(RLEchar{c,l});\n    }\n    return in;\n}\nostream& operator<<(ostream& out,RLE rle){\n    for(int i=0;i<rle.size();i++){\n        out<<rle[i].x<<\" \"<<rle[i].len<<\" \";\n    }\n    out<<\"$\";\n    return out;\n}\n\nvoid shrink(RLE &rle){\n    RLE res;\n    for(int i=0;i<rle.size();i++){\n        if(rle[i].len==0) continue;\n        else if(res.size()==0) res.push_back(rle[i]);\n        else if(res.back().x!=rle[i].x) res.push_back(rle[i]);\n        else res.back().len+=rle[i].len;\n    }\n    rle=res;\n}\n\nvoid replace(RLE& a,RLE b,RLE c){\n    for(int i=0;i+b.size()<=a.size();i++){\n        if(b.size()==1){\n            if(a[i].x==b[0].x && a[i].len>=b[0].len){\n                RLE tmp;\n                for(int j=0;j<i;j++){\n                    tmp.push_back(a[j]);\n                }\n                tmp.push_back(RLEchar{a[i].x,a[i].len-b[0].len});\n                for(int j=0;j<c.size();j++) tmp.push_back(c[j]);\n                for(int j=i+1;j<a.size();j++){\n                    tmp.push_back(a[j]);\n                }\n                a=tmp;\n                break;\n            }\n        }\n        else{\n            bool isok=(a[i].x==b[0].x && a[i].len>=b[0].len);\n            for(int j=1;j+1<b.size();j++){\n                isok&=(a[i+j].x==b[j].x && a[i+j].len==b[j].len);\n            }\n            isok&=(a[i+b.size()-1].x==b.back().x && a[i+b.size()-1].len>=b.back().len);\n            if(isok){\n                RLE tmp;\n                for(int j=0;j<i;j++){\n                    tmp.push_back(a[j]);\n                }\n                tmp.push_back(RLEchar{a[i].x,a[i].len-b[0].len});\n                for(int j=0;j<c.size();j++) tmp.push_back(c[j]);\n                tmp.push_back(RLEchar{a[i+b.size()-1].x,a[i+b.size()-1].len-b.back().len});\n                for(int j=i+b.size();j<a.size();j++){\n                    tmp.push_back(a[j]);\n                }\n                a=tmp;\n                break;\n            }\n        }\n    }\n    shrink(a);\n}\n\nint main(){\n    RLE a,b,c;\n    cin>>a>>b>>c;\n    replace(a,b,c);\n    cout<<a<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nint main(){\n    vector<vector<char> > c(4);\n    vector<vector<int> > len(4);\n    for(int i=0; i<3; i++){\n        while(1){\n            char letter;\n            int n;\n            cin >> letter;\n            if(letter == '$') break;\n            cin >> n;\n            c[i].push_back(letter);\n            len[i].push_back(n);\n        }\n    }\n\n    int asize = c[0].size();\n    int bsize = c[1].size();\n    int csize = c[2].size();\n    for(int i=0; i<asize-bsize+1; i++){\n        bool flag = true;\n        for(int j=0; j<bsize; j++){\n            if(c[0][i+j] == c[1][j]){\n                if(j==0 || j==bsize-1){\n                    if(len[0][i+j]<len[1][j]){\n                        flag = false;\n                        break;\n                    }\n                }else{\n                    if(len[0][i+j]!=len[1][j]){\n                        flag = false;\n                        break;\n                    }\n                }\n            }else{\n                flag = false;\n                break;\n            }\n        }\n        if(flag){\n            int s=i;\n            for(int j=0; j<s; j++){\n                c[3].push_back(c[0][j]);\n                len[3].push_back(len[0][j]);\n            }\n            c[3].push_back(c[0][s]);\n            len[3].push_back(len[0][s]-len[1][0]);\n            \n            for(int j=0; j<csize; j++){\n                c[3].push_back(c[2][j]);\n                len[3].push_back(len[2][j]);\n            }\n            c[3].push_back(c[0][s+bsize-1]);\n            len[3].push_back(len[0][s+bsize-1] -len[1].back());\n            for(int j=s+bsize; j<asize; j++){\n                c[3].push_back(c[0][j]);\n                len[3].push_back(len[0][j]);\n            }\n            break;\n        }\n    }\n\n    for(int i=0; i<(int)c[3].size(); i++){\n        int n=len[3][i];\n        for(;i<(int)c[3].size()-1; i++){\n            if(c[3][i]==c[3][i+1]){\n                n+=len[3][i+1];\n            }else{\n                break;\n            }\n        }\n        if(n!=0){\n            cout << c[3][i] << \" \" << n << \" \";\n        }\n    }\n    cout << \"$\" << endl;\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n#include <fstream>\n\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\n#define watch(a) { cout << #a << \" = \" << a << endl; }\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntypedef long long ll;\nint const inf = 1<<29;\n\nvoid change(deque<pair<char, int>>& nv0) {\n  if(nv0.size() > 1 && nv0[nv0.size()-2].first == nv0.back().first) {\n    int k = nv0.back().second;\n    nv0.pop_back();\n    nv0.back().second += k;\n  }\n}\n\nvoid output(deque<pair<char, int>>& out) {\n  rep(i, out.size()) {\n    if(i) cout << \" \";\n    cout << out[i].first << \" \" << out[i].second;\n  }\n  cout << \" $\" << endl;\n}\n\nint main() {\n\n  vector<deque<pair<char, int>>> v(3);\n  for(auto& u: v) {\n    while(1) {\n      char c; cin >> c;\n      if(c == '$') break;\n      int n; cin >> n;\n      u.emplace_back(c, n);\n    }\n  }\n\n  rep(i, (int)v[0].size()-(int)v[1].size()+1) {\n    int j = 0;\n    vector<int> V;\n    while(j < v[1].size() && v[0][i+j].first == v[1][j].first) {\n      if(j == 0 || j == (int)v[1].size()-1) {\n        if(v[0][i+j].second < v[1][j].second) break;\n        V.push_back(v[0][i+j].second - v[1][j].second);\n      }\n      else {\n        if(v[0][i+j].second != v[1][j].second) break;\n      }\n      j++;\n    }\n\n    deque<pair<char, int>> nv0;\n\n    if(j == v[1].size()) {\n      rep(k, v[0].size()) {\n        if(k < i) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n        if(k == i) {\n          if(V[0] > 0) nv0.emplace_back(v[0][i].first, V[0]);\n          rep(l, v[2].size()) {\n            nv0.push_back(v[2][l]);\n            change(nv0);\n          }\n          k = i+v[1].size()-1;\n        }\n        if(k == i+j-1) {\n          if(V[1] > 0) nv0.emplace_back(v[0][i+j-1].first, V[1]);\n          change(nv0);\n        }\n        if(i+j <= k) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n      }\n      v[0] = nv0;\n      i += (int)v[2].size()-1;\n//      i--;\n    }\n  }\n\n  output(v[0]);\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\ntypedef pair<char, int> pci;\n\nint main()\n{\n\tvector<pci> a, b, c;\n\tchar let; int n;\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\ta.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tb.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tc.emplace_back(let, n);\n\t}\n\tvector<pci> res;\n\t\n\tREP(i, (int)a.size() - (int)b.size() + 1)\n\t{\n\t\tif (a[i].first == b[0].first&&a[i].second >= b[0].second)\n\t\t{\n\t\t\tbool f = true;\n\t\t\tint j;\n\t\t\tfor (j = 1; j < b.size(); j++)\n\t\t\t{\n\t\t\t\tif (j == b.size() - 1)\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second > a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second != a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (f)\n\t\t\t{\n\t\t\t\tif (b.size() == 1)\n\t\t\t\t{\n\t\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\t\tif (a[i].second > b[0].second) res.emplace_back(a[i].first, a[i].second - b[0].second);\n\t\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\t\tif (a[i].second > b[0].second) res.emplace_back(a[i].first, a[i].second - b[0].second);\n\t\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\t\tif (a[i + b.size() - 1].second > b.back().second) res.emplace_back(b.back().first, a[i + b.size() - 1].second - b.back().second);\n\t\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\t\ti = INF;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tvector<pci> ans;\n\tif (res.size() == 0) ans = a;\n\telse\n\t{\n\t\tans.emplace_back(res[0]);\n\t\tFOR(i, 1, res.size())\n\t\t{\n\t\t\tif (res[i].first == ans.back().first) ans.back().second += res[i].second;\n\t\t\telse ans.emplace_back(res[i]);\n\t\t}\n\t}\n\tREP(i, ans.size()) cout << ans[i].first << \" \" << ans[i].second << (i == ans.size() - 1 ? \" $\\n\" : \" \");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\n#define F first\n#define S second\ntypedef long long ll;\ntypedef pair<char, ll> P;\n\nint main()\n{\n    bool found = 0;\n    ll len[3];    \n    vector<P> X[3];\n    for (int i = 0; i < 3; i++) {\n        char c;\n        ll l;\n        while (cin >> c, c != '$') {\n            cin >> l;\n            X[i].push_back(P(c, l));\n        }\n        len[i] = X[i].size();\n    }\n    for (int i = 0; i <= len[0]-len[1]; i++) {\n        bool same = 1;\n        for (int j = i; j < i+len[1]; j++) {\n            if (X[1][j-i].F != X[0][j].F ||\n                (i < j && j < i+len[1]-1 && X[1][j-i].S != X[0][j].S)) {\n                same = 0;\n                break;\n            }\n        }\n        if (len[1] == 1) {\n            if (X[0][i].S < X[1][0].S) {\n                continue;\n            }\n        }\n        if (same) {\n            vector<P> v, res;\n            for (int j = 0; j < i; j++) {\n                v.push_back(X[0][j]);\n            }\n            ll diff = X[0][i].S - X[1][0].S;\n            if (len[1] != 1) {\n                if (diff > 0) {\n                    v.push_back(P(X[0][i].F, diff));      \n                }\n                for (int j = 0; j < len[2]; j++) {\n                    v.push_back(X[2][j]);\n                }\n                diff = X[0][i+len[1]-1].S - X[1][len[1]-1].S;\n                if (diff > 0) {\n                    v.push_back(P(X[0][i+len[1]-1].F, diff));\n                }\n            } else {\n                for (int j = 0; j < len[2]; j++) {\n                    v.push_back(X[2][j]);\n                }                \n                if (diff > 0) {\n                    v.push_back(P(X[0][i].F, diff));   \n                }\n            }\n            for (int j = i+len[1]; j < len[0]; j++) {\n                v.push_back(X[0][j]);\n            }\n            \n            for (int j = 0; j < (int)v.size(); ) {\n                ll k = j, sum = 0;\n                while (k < (ll)v.size() &&\n                       v[j].F == v[k].F) {\n                    sum += v[k].S;\n                    k++;\n                }\n                res.push_back(P(v[j].F, sum));\n                j = k;\n            }\n            \n            for (int j = 0; j < (int)res.size(); j++) {\n                cout << res[j].F << \" \" << res[j].S << \" \";\n            }\n            cout << \"$\" << endl;\n            found = 1;\n            break;\n        }\n    }\n    if (!found) {\n        for (int i = 0; i < len[0]; i++) {\n            cout << X[0][i].F << \" \" << X[0][i].S << \" \";\n        }\n        cout << \"$\" << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nint main(){\n    vector<vector<char> > c(4);\n    vector<vector<int> > len(4);\n    for(int i=0; i<3; i++){\n        while(1){\n            char letter;\n            int n;\n            cin >> letter;\n            if(letter == '$') break;\n            cin >> n;\n            c[i].push_back(letter);\n            len[i].push_back(n);\n        }\n    }\n\n    int asize = c[0].size();\n    int bsize = c[1].size();\n    int csize = c[2].size();\n    for(int i=0; i<asize-bsize+1; i++){\n        bool flag = true;\n        for(int j=0; j<bsize; j++){\n            if(c[0][i+j] == c[1][j]){\n                if(j==0 || j==bsize-1){\n                    if(len[0][i+j]<len[1][j]){\n                        flag = false;\n                        break;\n                    }\n                }else{\n                    if(len[0][i+j]!=len[1][j]){\n                        flag = false;\n                        break;\n                    }\n                }\n            }else{\n                flag = false;\n                break;\n            }\n        }\n        if(flag){\n            int s=i;\n            for(int j=0; j<s; j++){\n                c[3].push_back(c[0][j]);\n                len[3].push_back(len[0][j]);\n            }\n            c[3].push_back(c[0][s]);\n            len[3].push_back(len[0][s]-len[1][0]);\n            \n            for(int j=0; j<csize; j++){\n                c[3].push_back(c[2][j]);\n                len[3].push_back(len[2][j]);\n            }\n            c[3].push_back(c[0][s+bsize-1]);\n            len[3].push_back(len[0][s+bsize-1] -len[1].back());\n            for(int j=s+bsize; j<asize; j++){\n                c[3].push_back(c[0][j]);\n                len[3].push_back(len[0][j]);\n            }\n            break;\n        }\n    }\n\n    if(c[3].empty()){\n        c[3] = c[0];\n        len[3] = len[0];\n    }\n    for(int i=0; i<(int)c[3].size(); i++){\n        int n=len[3][i];\n        for(;i<(int)c[3].size(); i++){\n            if(i==(int)c[3].size()-1 || c[3][i]!=c[3][i+1]){\n                i++;\n                break;\n            }else{\n                n+=len[3][i+1];\n            }\n        }\n        i--;\n        if(n!=0){\n            cout << c[3][i] << \" \" << n << \" \";\n        }\n    }\n    cout << \"$\" << endl;\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <sstream>\n\nusing namespace std;\n\nusing Array = basic_string<pair<char, int>>;\nArray a, b, c;\n\nvoid input(Array &a) {\n    string c; int l;\n    while (cin >> c, c[0] != '$') {\n        cin >> l;\n        a += make_pair(c[0], l);\n    }\n}\n\nostream &operator << (ostream &os, basic_string<pair<char, int>> xs){\n    for(auto &x : xs){\n        os << '[' << x.first << ' ' << x.second << ']';\n    }\n    return os;\n}\n\nint main() {\n    input(a);\n    input(b);\n    input(c);\n    a = make_pair('0', 0) + a + make_pair('0', 0);\n    cout << a << endl;\n    cout << b << endl;\n    cout << c << endl;\n    if (b.size() == 1) {\n        for (int i = 0; i < a.size(); ++i) {\n            if (a[i].first == b[0].first && a[i].second >= b[0].second) {\n                a[i].second -= b[0].second;\n                a = a.substr(0, i) + c + a.substr(i);\n                break;\n            }\n        }\n    } else {\n        for (int i = 1; i + b.size() - 2 <= a.size(); ++i) {\n            if (b.substr(1, b.size() - 2) == a.substr(i, b.size() - 2)) {\n                if (a[i - 1].first == b[0].first && a[i - 1].second >= b[0].second &&\n                    a[i + b.size() - 2].first == b.back().first && a[i + b.size() - 2].second >= b.back().second) {\n                    cout << i << endl;\n                    a[i - 1].second -= b[0].second;\n                    a[i + b.size() - 2].second -= b.back().second;\n                    a = a.substr(0, i) + c + a.substr(i + b.size() - 2);\n                    break;\n                }\n            }\n        }\n    }\n    for (int i = 1; i < a.size(); ++i) {\n        if (a[i].first == a[i - 1].first) {\n            a[i].second += a[i - 1].second;\n            a[i - 1].second = 0;\n        }\n    }\n    for (int i = 0; i < a.size(); ++i) {\n        if(a[i].second){\n            cout << a[i].first << ' ' << a[i].second << ' ';\n        }\n    }\n    cout << '$' << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\nint main(){\n  vector <P> a,b,c;\n  ll i,j,k;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    a.push_back(P(ch,k));\n  }\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    b.push_back(P(ch,k));\n  }\n  while(cin>>ch,ch!='$'){\n    cin >> k;\n    c.push_back(P(ch,k));\n  }\n  bool ff=false;\n  for(i=0;i+b.size()<=a.size();i++){\n    if(a[i].first!=b[0].first||a[i].second<b[0].second) continue;\n    bool f = true;\n    k=b.size()-1;\n    for(j=1;j<k;j++){\n      if(a[i+j].first!=b[j].first||a[i+j].second!=b[j].second) {\n\tf=false;\n\tbreak;\n      }\n    }\n    if(a[i+k].first!=b[k].first||a[i+k].second<b[k].second) continue;\n    if(f){\n      //cout << i << endl;\n      for(j=0;j<k+1;j++){\n\ta[i+j].second-=b[j].second;\n      }\n      a.insert(a.begin()+i+1,c.begin(),c.end());\n      ff=true;\n      break;\n    }\n  }\n\n  if(!ff) return 0;\n  \n  k=0;\n  while(k<a.size()){\n    if(a[k].second==0) a.erase(a.begin()+k);\n    else k++;\n  }\n\n  \n  for(i=0;i<a.size()-1;i++){\n    //cout << i << a[i].first << a[i+1].first << endl;\n    if(a[i].first==a[i+1].first){\n      a[i+1].second+=a[i].second;\n      a[i].second=0;\n    }\n  }\n  \n  for(i=0;i<a.size();i++){\n    if(a[i].second==0) continue;\n    cout << a[i].first << \" \" << a[i].second << \" \";\n  }\n  cout << \"$\" << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define fi first\n#define se second\nusing namespace std;\ntypedef pair<string,int> P;\nvector<P>v1,v2,v3;\nint x;\nstring s;\nmain(){\n  while(cin>>s,s!=\"$\")cin>>x,v1.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v2.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v3.push_back(P(s,x));\n  r(i,v1.size())if(v1[i].fi==v2[0].fi&&v1[i].se>=v2[0].se){\n    int flag=0,jj=0,ff=0;\n    r(j,(int)v2.size()-2){\n      jj=j+1;\n      if(i+jj>=v1.size()){flag++;break;}\n      if(v2[jj].se!=v1[i+jj].se||v2[jj].fi!=v1[i+jj].fi)flag++;\n    }jj++;\n    if((v2[v2.size()-1].fi!=v1[i+jj].fi||v2[v2.size()-1].se>v1[i+jj].se))flag++;\n    if(v2.size()!=1){\n      if(!flag&&v2[jj].fi==v1[i+jj].fi&&v2[jj].se<=v1[i+jj].se){\n        v1[i].se-=v2[0].se;\n        r(j,v2.size()-2)v1.erase(v1.begin()+i+1);\n        v1[i+1].se-=v2[v2.size()-1].se;\n        r(j,v3.size())v1.insert(v1.begin()+i+1,v3[(int)v3.size()-1-j]);\n      }\n      if(flag)goto L;\n      ff++;\n    }\n    else{\n      if(flag)goto L;\n      v1[i].se-=v2[0].se;\n      r(j,v3.size())v1.insert(v1.begin()+i,v3[(int)v3.size()-1-j]);\n      ff++;\n    }\n    r(j,v1.size())if(v1[j].se==0)v1.erase(v1.begin()+j);\n    r(j,(int)v1.size()-1)if(v1[j].fi==v1[j+1].fi)\n      v1[j].se+=v1[j+1].se,v1.erase(v1.begin()+j+1),j--;\n    cout<<i<<endl;\n    break;\n    L:;\n  }\n  r(k,v1.size())cout<<v1[k].fi<<' '<<v1[k].se<<' ';\n  cout<<'$'<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  vector<char> ca;\n  vector<int> la;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      ca.emplace_back(c);\n      la.emplace_back(l);      \n    }\n  }\n\n  vector<char> cb;\n  vector<int> lb;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      cb.emplace_back(c);\n      lb.emplace_back(l);      \n    }\n  }\n\n  vector<char> cc;\n  vector<int> lc;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      cc.emplace_back(c);\n      lc.emplace_back(l);      \n    }\n  }\n\n  int a = ca.size(), b = cb.size(), c = cc.size();\n  vector<char> ansc;\n  vector<int> ansl;  \n  for ( int i = 0; i < a; i++ ) {\n    if ( ca[i] != cb[0] || la[i] < lb[0] ) continue;\n    if ( i+b > a ) continue;\n    if ( ca[i+b-1] != cb[b-1] ||la[i+b-1] < lb[b-1] ) continue;\n    bool flag = true;\n    for ( int j = 1; j < b-1; j++ ) {\n      if ( ca[i+j] != cb[j] ||la[i+j] != lb[j] ) {\n\tflag = false;\n\tbreak;\n      }\n    }\n\n    if ( flag ) {\n      for ( int j = 0; j < i; j++ ) {\n\t// cout << ca[j] << \" \" << la[j] << \" \";\n\tansc.emplace_back(ca[j]);\n\tansl.emplace_back(la[j]);\n      }\n      // cout << ca[i] << \" \" << la[i]-lb[0] << \" \";\n      ansc.emplace_back(ca[i]);\n      ansl.emplace_back(la[i]-lb[0]);      \n      for ( int j = 0; j < c; j++ ) {\n\t// cout << cc[i] << \" \" << lc[j] << \" \";\n\tansc.emplace_back(cc[j]);\n\tansl.emplace_back(lc[j]);\n      }\n      // cout << ca[i+b-1] << \" \" << la[i+b-1]-lb[b-1] << \" \";\n      ansc.emplace_back(ca[i+b-1]);\n      ansl.emplace_back(la[i+b-1]-lb[b-1]);      \n      for ( int j = i+b; j < a; j++ ) {\n\t// cout << ca[j] << \" \" << la[j] << \" \";\n\tansc.emplace_back(ca[j]);\n\tansl.emplace_back(la[j]);\t\n      }\n      break;      \n    }\n  }\n\n  if ( ansc.size() == 0 ) {\n    ansc = ca; ansl = la;    \n  }\n  \n  for ( int i = 0; i < ansc.size(); i++ ) {\n    if ( i < ansc.size()-1 ) {\n      if ( ansc[i] == ansc[i+1] ) {\n\tansl[i+1] += ansl[i];\t\n      } else {\n\tcout << ansc[i] << \" \" << ansl[i] << \" \";\t\n      }\n    } else {\n      cout << ansc[i] << \" \" << ansl[i] << \" \";\t\n    }\n  }\n  cout << '$' << endl;\n  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\n\n\nvector<P>A,B,C;\n\nvoid input(vector<P> &a){\n  int num;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin>>num;\n    a.push_back(P(ch,num));\n  }\n}\n\nbool check(int i){\n  int n = A.size();\n  int m = B.size();\n  if(i+m>n) return 0;\n  if(A[i].first!=B[i].first||A[i].second<B[i].second)return 0;\n  if(m == 1) return 1;\n\n  for(++i;i<m-1;i++)\n    if(A[i].first!=B[i].first||A[i].second!=B[i].second)return 0;\n\n  if(A[i].first!=B[i].first||A[i].second<B[i].second)return 0;\n  return 1;\n}\n\nvoid mergePush(vector<P> &res,P a){\n  int c = a.second;\n  char ch = a.first;\n  if(c == 0)return;\n  if(res.size() && res.back().first == ch)res.back().second+=c;\n  else res.push_back(P(ch,c));\n}\n\nvector<P> solve(){\n  vector<P> res;\n  int n = A.size();\n  int m = B.size();\n  int l = C.size();\n  for(int i=0;i<n;i++){\n    if(A[i].second == 0) continue;\n    if(!check(i)){mergePush(res,A[i]);continue;}\n    \n    mergePush(res,P(A[i].first,A[i].second - B[0].second));   \n    for(int j=0;j<l;j++) mergePush(res,C[j]);\n    i+=m-1;\n    A[i--].second -= B.back().second;\n    \n    }\n  return res;\n}\n\n\nint main(){\n  input(A);\n  input(B);\n  input(C);\n  assert(B.size()>1);\n  vector<P> ans = solve();\n  for(P a:ans) cout<<a.first<<\" \"<<a.second<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\n\n\nvector<P>A,B,C;\n\nvoid input(vector<P> &a){\n  int num;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin>>num;\n    a.push_back(P(ch,num));\n  }\n}\n\nbool check(int i){\n  int n = A.size();\n  int m = B.size();\n  if(i+m>n) return 0;\n  if(A[i].first!=B[0].first||A[i].second<B[0].second)return 0;\n  if(m == 1) return 1;\n\n  i++;\n  for(int j=1;i<m-1;j++,i++)\n    if(A[i].first!=B[j].first||A[i].second!=B[j].second)return 0;\n  \n  if(A[i].first!=B[m-1].first||A[i].second<B[m-1].second)return 0;\n  return 1;\n}\n\nvoid mergePush(vector<P> &res,P a){\n  int c = a.second;\n  char ch = a.first;\n  if(c == 0)return;\n  if(res.size() && res.back().first == ch)res.back().second+=c;\n  else res.push_back(P(ch,c));\n}\n\nvector<P> solve2(){\n  vector<P> res;\n  int n = A.size();\n  int m = B.size();\n  int l = C.size();\n  for(int i = 0;i<n;i++){\n    if(!check(i)){mergePush(res,A[i]);continue;}\n    for(int j=0;j<l;j++)mergePush(res,C[j]);\n    A[i--].second -= B[0].second;\n  }\n  return res;\n}\n\n\nvector<P> solve(){\n  vector<P> res;\n  int n = A.size();\n  int m = B.size();\n  int l = C.size();\n  if(m==1) return solve2();\n\n  for(int i=0;i<n;i++){\n    if(!check(i)){mergePush(res,A[i]);continue;}\n    mergePush(res,P(A[i].first,A[i].second - B[0].second));   \n    for(int j=0;j<l;j++) mergePush(res,C[j]);\n    i+=m-1;\n    A[i--].second -= B.back().second;\n  }\n  return res;\n}\n\n\n\nint main(){\n  input(A);\n  input(B);\n  input(C);\n  vector<P> ans = solve();\n  for(P a:ans) cout<<a.first<<\" \"<<a.second<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-9;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\nvector<pair<char, int>>comp(vector<pair<char, int>>ps) {\n\tvector<pair<char, int>>newps;\n\tfor (int i = 0; i < ps.size(); ++i) {\n\t\tif (i==ps.size()-1||ps[i].first != ps[i + 1].first) {\n\t\t\tif (ps[i].second) {\n\t\t\t\tnewps.push_back(ps[i]);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tps[i + 1].second += ps[i].second;\n\t\t}\n\t}\n\treturn newps;\n}\nvoid input(vector<pair<char, int>>&p) {\n\twhile (1) {\n\t\tchar c; cin >> c;\n\t\tif (c == '$')break;\n\t\tint n; cin >> n;\n\t\tp.push_back(make_pair(c, n));\n\t}\n}\nint main() {\n\tvector<pair<char, int>>a, b, c;\n\tinput(a); input(b); input(c);\n\ta = comp(a); b = comp(b); c = comp(c);\n\tif (b.size() == 1) {\n\t\tfor (int i = 0; i < a.size(); ++i) {\n\t\t\tif (a[i].first == b[i].first) {\n\t\t\t\ta[i].second -= b[i].second;\n\t\t\t\ta.insert(a.begin() + i, c.begin(),c.end());\n\t\t\t\tbreak;\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tfor (int l = 0; l <= a.size() - b.size(); ++l) {\n\t\t\tbool aok = true;\n\t\t\tif (a[l].first != b[0].first||a[l].second < b[0].second) {\n\t\t\t\taok = false;\n\t\t\t}\n\t\t\tfor (int i = 1; i < b.size() - 1; ++i) {\n\t\t\t\tif (a[l + i] != b[i]) {\n\t\t\t\t\taok = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (a[l+b.size()-1].first != b[b.size()-1].first || a[l + b.size() - 1].second < b[b.size() - 1].second) {\n\t\t\t\taok = false;\n\t\t\t}\n\t\t\tif (aok) {\n\t\t\t\ta[l].second -= b[0].second;\n\t\t\t\ta[l + b.size() - 1].second -= b[b.size() - 1].second;\n\t\t\t\ta.erase(a.begin() + l + 1, a.begin() + l + b.size() - 1);\n\t\t\t\ta.insert(a.begin() + l + 1, c.begin(), c.end());\n\t\t\t}\n\t\t}\n\t}\n\ta = comp(a);\n\tfor (int i = 0; i < a.size(); ++i) {\n\t\tcout << a[i].first << \" \" << a[i].second << \" \";\n\t}\n\tcout << \"$\" << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\ntypedef pair<char, int> pci;\n\nint main()\n{\n\tvector<pci> a, b, c;\n\tchar let; int n;\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\ta.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tb.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tc.emplace_back(let, n);\n\t}\n\tvector<pci> res;\n\tREP(i, a.size() - b.size() + 1)\n\t{\n\t\tif (a[i].first == b[0].first&&a[i].second >= b[0].second)\n\t\t{\n\t\t\tbool f = true;\n\t\t\tint j;\n\t\t\tfor (j = 1; j < b.size(); j++)\n\t\t\t{\n\t\t\t\tif (j == b.size() - 1)\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second >= a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second != a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (f)\n\t\t\t{\n\n\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\tif (a[i].second > b[i].second) res.emplace_back(a[i].first, a[i].second - b[i].second);\n\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\tif (a[i + b.size() - 1].second > b.back().second) res.emplace_back(b.back().first, a[i + b.size() - 1].second - b.back().second);\n\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\ti = INF;\n\t\t\t}\n\t\t}\n\t}\n\tvector<pci> ans;\n\tif (res.size() == 0) ans = a;\n\telse\n\t{\n\t\tans.emplace_back(res[0]);\n\t\tFOR(i, 1, res.size())\n\t\t{\n\t\t\tif (res[i].first == ans.back().first) ans.back().second += res[i].second;\n\t\t\telse ans.emplace_back(res[i]);\n\t\t}\n\t}\n\tREP(i, ans.size()) cout << ans[i].first << \" \" << ans[i].second << (i == ans.size() - 1 ? \"\\n\" : \" \");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\nusing namespace std;\n \n#define REP(i,n) for(int i=0; i<n; ++i)\n#define FOR(i,a,b) for(int i=a; i<=b; ++i)\n#define FORR(i,a,b) for (int i=a; i>=b; --i)\n \ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef vector<VI> VVI;\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> PL;\n\nvoid inp(vector<pair<char, int> > &a){\n    while (1){\n        char c;\n        cin >> c;\n        if (c == '$') break;\n        int x;\n        cin >> x;\n        a.push_back(make_pair(c, x));\n    }\n}\n\nint main() {\n    vector<pair<char, int> > a, b, c, res, ans;\n    inp(a);\n    inp(b);\n    inp(c);\n    REP(i,a.size() - b.size() + 1){\n        bool f = true;\n        REP(j,b.size()){\n            if (a[i+j].first != b[j].first){\n                f = false;\n                break;\n            }\n            if (j == 0 || j == b.size()-1){\n                if (a[i+j].second < b[j].second){\n                    f = false;\n                    break;\n                }\n            }else{\n                if (a[i+j].second != b[j].second){\n                    f = false;\n                    break;\n                }\n            }\n        }\n        if (f){\n            REP(j,i) res.push_back(a[j]);\n            a[i].second -= b[0].second;\n            res.push_back(a[i]);\n            REP(j,c.size()) res.push_back(c[j]);\n            if (b.size() > 1){\n                a[i+b.size()-1].second -= b[b.size()-1].second;\n                res.push_back(a[i+b.size()-1]);\n            }\n            FOR(j,i+b.size(),a.size()-1) res.push_back(a[j]);\n        }\n    }\n    if (res.empty()){\n        REP(i,a.size()){\n            printf(\"%c %d \", a[i].first, a[i].second);\n        }\n        printf(\"$\\n\");\n    }else{\n        REP(i,res.size()){\n            if (i != 0 && ans[ans.size()-1].first == res[i].first){\n                ans[ans.size()-1].second += res[i].second;\n            }else if (res[i].second > 0){\n                ans.push_back(res[i]);\n            }\n        }\n        REP(i,ans.size()){\n            printf(\"%c %d \", ans[i].first, ans[i].second);\n        }\n        printf(\"$\\n\");\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long int ll;\ntypedef pair<string, ll> P;\n\nint issubseq(const vector<P>& a, const vector<P>& b){\n\tint pos = -1, i, j;\n\tif(a.size() < b.size()) return pos;\n\tfor(i = 0;i < a.size() - b.size() + 1;++i){\n\t\tfor(j = 0;j < b.size();++j){\n\t\t\tif(a[i + j].first != b[j].first) break;\n\t\t\tif(j == 0 || j == b.size() - 1){\n\t\t\t\tif(a[i + j].second < b[j].second) break;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(a[i + j].second != b[j].second) break;\n\t\t\t}\n\t\t}\n\t\tif(j == b.size()) {\n\t\t\tpos = i;\n\t\t\tbreak;\n\t\t}\n\t\telse {\n\t\t\ti += j;\n\t\t}\n\t}\n\treturn pos;\n}\n\nint main(){\n\tint idx;\n\tstring s;\n\tvector<string> tokens[3];\n\tvector<P> vp[3], ans, t;\n\tfor(int i = 0;i < 3;++i){\n\t\tfor(;cin >> s, s != \"$\";){\n\t\t\ttokens[i].emplace_back(s);\n\t\t}\n\t\tfor(int j = 0;j < tokens[i].size();j += 2){\n\t\t\tvp[i].emplace_back(make_pair(tokens[i][j], stoi(tokens[i][j + 1])));\n\t\t}\n\t}\n\tidx = issubseq(vp[0], vp[1]);\n\tif(idx == -1){\n\t\tfor(const auto& v : vp[0]){\n\t\t\tcout << v.first << \" \" << v.second << \" \";\n\t\t}\n\t\tcout << '$' << endl;\n\t}\n\telse {\n\t\tfor(int i = 0;i < vp[0].size();++i){\n\t\t\tif(i == idx) {\n\t\t\t\tint l = vp[1].size() - 1;\n\t\t\t\tP p = vp[0][i];\n\t\t\t\tif(l) {\n\t\t\t\t\tif(p.second - vp[1][0].second > 0) {\n\t\t\t\t\t\tt.emplace_back(p.first, p.second - vp[1][0].second);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j = 0;j < vp[2].size();++j){\n\t\t\t\t\tt.emplace_back(vp[2][j]);\n\t\t\t\t}\n\t\t\t\tp = vp[0][i + l];\n\t\t\t\tif(p.second - vp[1][l].second > 0) {\n\t\t\t\t\tt.emplace_back(p.first, p.second - vp[1][l].second);\n\t\t\t\t}\n\t\t\t\ti += l;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tt.emplace_back(vp[0][i]);\n\t\t\t}\n\t\t}\n\t\treverse(t.begin(), t.end());\n\t\tfor(int i = 0;i < t.size();++i) {\n\t\t\tif(!ans.empty()) {\n\t\t\t\tif(t[i].first == ans[0].first) {\n\t\t\t\t\tans[0].second += t[i].second;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tans.insert(ans.begin(), t[i]);\n\t\t}\n\t\tfor(const auto &v : ans) {\n\t\t\tcout << v.first << \" \" << v.second << \" \";\n\t\t}\n\t\tcout << '$' << endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\n\nstruct Node{\n\tchar ch;\n\tint length;\n\tNode* prev;\n\tNode* next;\n};\n\nstruct Info{\n\tvoid set(char arg_ch,int arg_length){\n\t\tch = arg_ch;\n\t\tlength = arg_length;\n\t}\n\tchar ch;\n\tint length;\n\tbool isFirst,isLast;\n};\n\nInfo A[3000],B[3000],C[3000];\nint a_len = 0,b_len = 0,c_len = 0;\n\nclass List{\npublic:\n\tList(){\n\t\tmotherNode = new Node();\n\t\tmotherNode->ch = '#';\n\t\tmotherNode->length = -1;\n\t\tmotherNode->prev = motherNode;\n\t\tmotherNode->next = motherNode;\n\t\tmatchFirstNode = motherNode;\n\t\tmatchLastNode = motherNode;\n\t\tleft_complete_match = false;\n\t\tright_complete_match = false;\n\t};\n\tvoid registA(Info info){\n\n\t\tNode* tmpNode = motherNode->prev;\n\t\tmotherNode->prev = new Node;\n\t\tmotherNode->prev->ch = info.ch;\n\t\tmotherNode->prev->length = info.length;\n\t\tmotherNode->prev->next = motherNode;\n\t\tmotherNode->prev->prev = tmpNode;\n\t\ttmpNode->next = motherNode->prev;\n\t};\n\n\tbool isMatchB(){\n\n\t\tbool FLG;\n\t\tint index;\n\n\t\tNode* startNode = motherNode;\n\t\tNode* tmpNode;\n\n\t\twhile(true){\n\t\t\tstartNode = startNode->next;\n\t\t\tif(startNode == motherNode)break;\n\n\t\t\ttmpNode = startNode;\n\n\t\t\tindex = 0;\n\n\t\t\tFLG = true;\n\n\t\t\twhile(tmpNode != motherNode){\n\t\t\t\tif(tmpNode->ch != B[index].ch){\n\t\t\t\t\tFLG = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}else{\n\n\t\t\t\t\tif(B[index].isFirst == false && B[index].isLast == false){\n\t\t\t\t\t\tif(tmpNode->length != B[index].length){\n\t\t\t\t\t\t\tFLG = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmpNode = tmpNode->next;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(tmpNode->length >= B[index].length){\n\t\t\t\t\t\t\ttmpNode = tmpNode->next;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tFLG = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(index == b_len)break;\n\t\t\t}\n\n\t\t\tif(FLG == true && index == b_len){\n\n\t\t\t\tif(startNode->length == B[0].length){\n\t\t\t\t\tmatchFirstNode = startNode->prev;\n\t\t\t\t\tleft_complete_match = true;\n\t\t\t\t}else{\n\t\t\t\t\tmatchFirstNode = startNode;\n\t\t\t\t}\n\n\t\t\t\ttmpNode = tmpNode->prev;\n\t\t\t\tif(tmpNode->length == B[b_len-1].length){\n\t\t\t\t\tmatchLastNode = tmpNode->next;\n\t\t\t\t\tright_complete_match = true;\n\t\t\t\t}else{\n\t\t\t\t\tmatchLastNode = tmpNode;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tvoid replace(){\n\n\t\tNode* tmpNode,*preNode,*firstNext;\n\t\tint index;\n\n\t\tfirstNext = matchFirstNode->next;\n\n\t\tif(left_complete_match){\n\t\t\tif(matchFirstNode->ch == C[0].ch){\n\t\t\t\tmatchFirstNode->length += C[0].length;\n\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\tindex = 1;\n\t\t\t}else{\n\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\tindex = 0;\n\t\t\t}\n\t\t}else{\n\n\t\t\tif(b_len > 1){\n\t\t\t\tif(matchFirstNode->ch != C[0].ch){\n\t\t\t\t\tmatchFirstNode->length -= B[0].length;\n\t\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\t\tindex = 0;\n\t\t\t\t}else{\n\t\t\t\t\tmatchFirstNode->length = matchFirstNode->length - B[0].length + C[0].length;\n\t\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\t\tindex = 1;\n\t\t\t\t}\n\t\t\t}else{\n\n\t\t\t\tfirstNext->prev = new Node;\n\t\t\t\tfirstNext->prev->next = firstNext;\n\t\t\t\tfirstNext->prev->ch = matchFirstNode->ch;\n\t\t\t\tfirstNext->prev->length = matchFirstNode->length - B[0].length;\n\t\t\t\tfirstNext = firstNext->prev;\n\t\t\t\tfirstNext->prev = matchFirstNode;\n\t\t\t\ttmpNode = matchFirstNode;\n\t\t\t\tindex = 0;\n\t\t\t}\n\t\t}\n\n\t\tpreNode = matchFirstNode;\n\n\t\tif(index == c_len){\n\t\t\tif(right_complete_match){\n\t\t\t\tif(matchLastNode->ch != C[0].ch){\n\t\t\t\t\tmatchFirstNode->next = matchLastNode;\n\t\t\t\t\tmatchLastNode->prev = matchFirstNode;\n\t\t\t\t}else{\n\t\t\t\t\tmatchFirstNode->length += matchLastNode->length;\n\t\t\t\t\tmatchFirstNode->next = matchLastNode->next;\n\t\t\t\t\tmatchLastNode->next->prev = matchFirstNode;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(matchFirstNode != matchLastNode){\n\t\t\t\t\tif(matchLastNode->ch != C[0].ch){\n\t\t\t\t\t\tmatchFirstNode->next = matchLastNode;\n\t\t\t\t\t\tmatchLastNode->prev = matchFirstNode;\n\t\t\t\t\t\tmatchLastNode->length -= B[b_len-1].length;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tmatchFirstNode->length += matchLastNode->length - B[b_len-1].length;\n\t\t\t\t\t\tmatchFirstNode->next = matchLastNode->next;\n\t\t\t\t\t\tmatchLastNode->next->prev = matchFirstNode;\n\t\t\t\t\t}\n\t\t\t\t}else{ //matchFirstNode == matchLastNode\n\n\t\t\t\t\tif(b_len == 1){ //c_len == 1\n\t\t\t\t\t\tif(firstNext->ch != C[0].ch){\n\t\t\t\t\t\t\tmatchFirstNode->ch = C[0].ch;\n\t\t\t\t\t\t\tmatchFirstNode->length = C[0].length;\n\t\t\t\t\t\t\tmatchFirstNode->next = firstNext;\n\t\t\t\t\t\t}else{ //firstNext.ch == C[0].ch\n\t\t\t\t\t\t\tmatchFirstNode->ch = C[0].ch;\n\t\t\t\t\t\t\tmatchFirstNode->length = C[0].length + firstNext->length;\n\t\t\t\t\t\t\tmatchFirstNode->next = firstNext->next;\n\t\t\t\t\t\t\tfirstNext->next->prev = matchFirstNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{ //b_len != 1\n\t\t\t\t\t\t//Do nothing\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\twhile(index < c_len){\n\t\t\tif(index != c_len - 1){\n\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\tpreNode = tmpNode;\n\t\t\t\ttmpNode->next = new Node;\n\t\t\t\ttmpNode = tmpNode->next;\n\t\t\t\tindex++;\n\t\t\t}else{\n\t\t\t\tif(right_complete_match){\n\t\t\t\t\tif(matchLastNode->ch != C[index].ch){\n\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\ttmpNode->next = matchLastNode;\n\t\t\t\t\t\tmatchLastNode->prev = tmpNode;\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}else{\n\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\ttmpNode->length = C[index].length + matchLastNode->length;\n\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\ttmpNode->next = matchLastNode->next;\n\t\t\t\t\t\tmatchLastNode->next->prev = tmpNode;\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\n\t\t\t\t\tif(matchFirstNode != matchLastNode){\n\t\t\t\t\t\tif(matchLastNode->ch != C[index].ch){\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = matchLastNode;\n\t\t\t\t\t\t\tmatchLastNode->length -= B[b_len-1].length;\n\t\t\t\t\t\t\tmatchLastNode->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = matchLastNode->length-B[b_len-1].length + C[index].length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = matchLastNode->next;\n\t\t\t\t\t\t\tmatchLastNode->next->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\n\t\t\t\t\t\tif(firstNext->ch != C[index].ch){\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = firstNext;\n\t\t\t\t\t\t\tfirstNext->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = C[index].length + firstNext->length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = firstNext->next;\n\t\t\t\t\t\t\tfirstNext->next->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tvoid output(){\n\n\t\tNode* tmpNode = motherNode->next;\n\t\twhile(tmpNode != motherNode){\n\t\t\tprintf(\"%c %d \",tmpNode->ch,tmpNode->length);\n\t\t\ttmpNode = tmpNode->next;\n\t\t}\n\n\t\tprintf(\"$\\n\");\n\t}\n\nprivate:\n\tNode* motherNode,*matchFirstNode,*matchLastNode;\n\tbool left_complete_match,right_complete_match;\n};\n\n\n\nint main(){\n\n\tList list;\n\n\tchar buf[2];\n\tint num;\n\tInfo tmp;\n\n\twhile(true){\n\t\tscanf(\"%s\",buf);\n\t\tif(buf[0] == '$')break;\n\n\t\tscanf(\"%d\",&num);\n\n\t\ttmp.set(buf[0],num);\n\t\tA[a_len++].set(buf[0],num);\n\n\t\tlist.registA(tmp);\n\t}\n\n\tfor(int i = 0; i < 3000; i++){\n\t\tB[i].isFirst = false;\n\t\tB[i].isLast = false;\n\t}\n\n\twhile(true){\n\t\tscanf(\"%s\",buf);\n\t\tif(buf[0] == '$')break;\n\n\t\tscanf(\"%d\",&num);\n\n\t\tB[b_len++].set(buf[0],num);\n\t}\n\n\tB[0].isFirst = true;\n\tB[b_len-1].isLast = true;\n\n\tif(!list.isMatchB()){\n\n\t\tfor(int i = 0; i < a_len; i++){\n\t\t\tprintf(\"%c %d \",A[i].ch,A[i].length);\n\t\t}\n\t\tprintf(\"$\\n\");\n\t\treturn 0;\n\t}\n\n\twhile(true){\n\t\tscanf(\"%s\",buf);\n\t\tif(buf[0] == '$')break;\n\n\t\tscanf(\"%d\",&num);\n\n\t\tC[c_len++].set(buf[0],num);\n\t}\n\n\tlist.replace();\n\n\tlist.output();\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n\npair<vector<char>, vector<ll>> get_rle() {\n\tvector<char> c;\n\tvector<ll> l;\n\tchar ch;\n\twhile (cin >> ch, ch != '$') {\n\t\tint x;\n\t\tcin >> x;\n\t\tc.push_back(ch);\n\t\tl.push_back(x);\n\t}\n\treturn make_pair(c, l);\n}\n\npair<vector<char>, vector<ll>> compress_rle(const vector<char>& c, const vector<ll>& l) {\n\tint n = c.size();\n\tvector<char> rc(1, c[0]);\n\tvector<ll> rl(1, l[0]);\n\tfor (int i = 1; i < n; i++) {\n\t\tif (c[i] == rc.back()) {\n\t\t\trl.back() += l[i];\n\t\t}\n\t\telse if (l[i] > 0) {\n\t\t\trc.push_back(c[i]);\n\t\t\trl.push_back(l[i]);\n\t\t}\n\t}\n\treturn make_pair(rc, rl);\n}\n\nvoid out_rle(const vector<char>& c, const vector<ll>& l) {\n\tint n = c.size();\n\tfor (int i = 0; i < n; i++) {\n\t\tcout << c[i] << ' ' << l[i] << ' ';\n\t}\n\tcout << '$' << endl;\n}\n\nint main()\n{\n\tvector<char> ac, bc, cc, rc;\n\tvector<ll> al, bl, cl, rl;\n\ttie(ac, al) = get_rle();\n\ttie(bc, bl) = get_rle();\n\ttie(cc, cl) = get_rle();\n\tint l1 = ac.size(), l2 = bc.size(), l3 = cc.size();\n\tbool end = false;\n\tfor (int i = 0; i < l1; i++) {\n\t\tif (l2 == 1) {\n\t\t\tif (!end && ac[i] == bc[0] && al[i] >= bl[0]) {\n\t\t\t\tend = true;\n\t\t\t\tal[i] -= bl[0];\n\t\t\t\tfor (int j = 0; j < l3; j++) {\n\t\t\t\t\trc.push_back(cc[j]);\n\t\t\t\t\trl.push_back(cl[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (al[i]) {\n\t\t\t\trc.push_back(ac[i]);\n\t\t\t\trl.push_back(al[i]);\n\t\t\t}\n\t\t}\n\t\telse if (i + l2 <= l1 && ac[i] == bc[0] && al[i] >= bl[0]) {\n\t\t\tbool ng = false;\n\t\t\tfor (int j = 1; j + 1 < l2; j++) {\n\t\t\t\tif (ac[i + j] != bc[j] || al[i + j] != bl[j]) {\n\t\t\t\t\tng = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (ac[i + l2 - 1] != bc[l2 - 1] || al[i + l2 - 1] < bl[l2 - 1]) ng = true;\n\t\t\tif (end || ng) {\n\t\t\t\trc.push_back(ac[i]);\n\t\t\t\trl.push_back(al[i]);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tend = true;\n\t\t\tif (al[i] - bl[0] > 0) {\n\t\t\t\trc.push_back(ac[i]);\n\t\t\t\trl.push_back(al[i] - bl[0]);\n\t\t\t}\n\t\t\tfor (int j = 0; j < l3; j++) {\n\t\t\t\trc.push_back(cc[j]);\n\t\t\t\trl.push_back(cl[j]);\n\t\t\t}\n\t\t\tal[i + l2 - 1] -= bl.back();\n\t\t\ti += l2 - 2;\n\t\t}\n\t\telse if (al[i] > 0) {\n\t\t\trc.push_back(ac[i]);\n\t\t\trl.push_back(al[i]);\n\t\t}\n\t}\n\ttie(rc, rl) = compress_rle(rc, rl);\n\tout_rle(rc, rl);\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <sstream>\n\nusing namespace std;\n\nusing Array = basic_string<pair<char, int>>;\nArray a, b, c;\n\nostream &operator << (ostream &os, basic_string<pair<char, int>> xs){\n    for(auto &x : xs){\n        os << '[' << x.first << ',' << x.second << ']';\n    }\n    return os;\n}\n\nint main() {\n    auto input = [](Array &a) {\n        string c; int l;\n        while (cin >> c, c[0] != '$') {\n            cin >> l;\n            a += make_pair(c[0], l);\n        }\n    };\n\n    input(a);\n    input(b);\n    input(c);\n    a = make_pair('0', 0) + a + make_pair('0', 0);\n    if (b.size() == 1) {\n        for (int i = 0; i < a.size(); ++i) {\n            if (a[i].first == b[0].first && a[i].second >= b[0].second) {\n                a[i].second -= b[0].second;\n                a = a.substr(0, i) + c + a.substr(i);\n                break;\n            }\n        }\n    } else {\n        for (int i = 1; i + b.size() - 2 <= a.size(); ++i) {\n            if (b.substr(1, b.size() - 2) == a.substr(i, b.size() - 2)) {\n                if (a[i - 1].first == b[0].first && a[i - 1].second >= b[0].second &&\n                    a[i + b.size() - 2].first == b.back().first && a[i + b.size() - 2].second >= b.back().second) {\n                    // cout << i << endl;\n                    a[i - 1].second -= b[0].second;\n                    a[i + b.size() - 2].second -= b.back().second;\n                    a = a.substr(0, i) + c + a.substr(i + b.size() - 2);\n                    break;\n                }\n            }\n        }\n    }\n    for (int i = 0; i < a.size(); ++i) {\n        int j = i;\n        int s = 0;\n        while(j < a.size() && a[i].first == a[j].first){\n            s += a[j].second;\n            a[j].second = 0;\n            ++j;\n        }\n        a[i].second = s;\n    }\n    for (int i = 0; i < a.size(); ++i) {\n        if(a[i].second){\n            cout << a[i].first << ' ' << a[i].second << ' ';\n        }\n    }\n    cout << '$' << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\n\nstruct Node{\n\tchar ch;\n\tint length;\n\tNode* prev;\n\tNode* next;\n};\n\nstruct Info{\n\tvoid set(char arg_ch,int arg_length){\n\t\tch = arg_ch;\n\t\tlength = arg_length;\n\t}\n\tchar ch;\n\tint length;\n\tbool isFirst,isLast;\n};\n\nInfo A[3000],B[3000],C[3000];\nint a_len = 0,b_len = 0,c_len = 0;\n\nclass List{\npublic:\n\tList(){\n\t\tmotherNode = new Node();\n\t\tmotherNode->ch = '#';\n\t\tmotherNode->length = -1;\n\t\tmotherNode->prev = motherNode;\n\t\tmotherNode->next = motherNode;\n\t\tmatchFirstNode = motherNode;\n\t\tmatchLastNode = motherNode;\n\t\tleft_complete_match = false;\n\t\tright_complete_match = false;\n\t};\n\tvoid registA(Info info){\n\n\t\tNode* tmpNode = motherNode->prev;\n\t\tmotherNode->prev = new Node;\n\t\tmotherNode->prev->ch = info.ch;\n\t\tmotherNode->prev->length = info.length;\n\t\tmotherNode->prev->next = motherNode;\n\t\tmotherNode->prev->prev = tmpNode;\n\t\ttmpNode->next = motherNode->prev;\n\t};\n\n\tbool isMatchB(){\n\n\t\tbool FLG;\n\t\tint index;\n\n\t\tNode* startNode = motherNode;\n\t\tNode* tmpNode;\n\n\t\twhile(true){\n\t\t\tstartNode = startNode->next;\n\t\t\tif(startNode == motherNode)break;\n\n\t\t\ttmpNode = startNode;\n\n\t\t\tindex = 0;\n\n\t\t\tFLG = true;\n\n\t\t\twhile(tmpNode != motherNode){\n\t\t\t\tif(tmpNode->ch != B[index].ch){\n\t\t\t\t\tFLG = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}else{\n\n\t\t\t\t\tif(B[index].isFirst == false && B[index].isLast == false){\n\t\t\t\t\t\tif(tmpNode->length != B[index].length){\n\t\t\t\t\t\t\tFLG = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmpNode = tmpNode->next;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(tmpNode->length >= B[index].length){\n\t\t\t\t\t\t\ttmpNode = tmpNode->next;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tFLG = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(index == b_len)break;\n\t\t\t}\n\n\t\t\tif(FLG == true && index == b_len){\n\n\t\t\t\tif(startNode->length == B[0].length){\n\t\t\t\t\tmatchFirstNode = startNode->prev;\n\t\t\t\t\tleft_complete_match = true;\n\t\t\t\t}else{\n\t\t\t\t\tmatchFirstNode = startNode;\n\t\t\t\t}\n\n\t\t\t\ttmpNode = tmpNode->prev;\n\t\t\t\tif(tmpNode->length == B[b_len-1].length){\n\t\t\t\t\tmatchLastNode = tmpNode->next;\n\t\t\t\t\tright_complete_match = true;\n\t\t\t\t}else{\n\t\t\t\t\tmatchLastNode = tmpNode;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tvoid replace(){\n\n\t\tNode* tmpNode,*preNode,*firstNext;\n\t\tint index;\n\n\t\tfirstNext = matchFirstNode->next;\n\n\t\tif(left_complete_match){\n\t\t\tif(matchFirstNode->ch == C[0].ch){\n\t\t\t\tmatchFirstNode->length += C[0].length;\n\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\tindex = 1;\n\t\t\t}else{\n\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\tindex = 0;\n\t\t\t}\n\t\t}else{\n\n\t\t\tif(b_len > 1){\n\t\t\t\tif(matchFirstNode->ch != C[0].ch){\n\t\t\t\t\tmatchFirstNode->length -= B[0].length;\n\t\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\t\tindex = 0;\n\t\t\t\t}else{\n\t\t\t\t\tmatchFirstNode->length = matchFirstNode->length - B[0].length + C[0].length;\n\t\t\t\t\tmatchFirstNode->next = new Node;\n\t\t\t\t\ttmpNode = matchFirstNode->next;\n\t\t\t\t\tindex = 1;\n\t\t\t\t}\n\t\t\t}else{\n\n\t\t\t\tfirstNext->prev = new Node;\n\t\t\t\tfirstNext->prev->next = firstNext;\n\t\t\t\tfirstNext->prev->ch = matchFirstNode->ch;\n\t\t\t\tfirstNext->prev->length = matchFirstNode->length - B[0].length;\n\t\t\t\tfirstNext = firstNext->prev;\n\t\t\t\tfirstNext->prev = matchFirstNode;\n\t\t\t\ttmpNode = matchFirstNode;\n\t\t\t}\n\t\t}\n\n\t\tpreNode = matchFirstNode;\n\n\t\tif(index == c_len){\n\t\t\tif(right_complete_match){\n\t\t\t\tif(matchLastNode->ch != C[0].ch){\n\t\t\t\t\tmatchFirstNode->next = matchLastNode;\n\t\t\t\t\tmatchLastNode->prev = matchFirstNode;\n\t\t\t\t}else{\n\t\t\t\t\tmatchFirstNode->length += matchLastNode->length;\n\t\t\t\t\tmatchFirstNode->next = matchLastNode->next;\n\t\t\t\t\tmatchLastNode->next->prev = matchFirstNode;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(matchFirstNode != matchLastNode){\n\t\t\t\t\tif(matchLastNode->ch != C[0].ch){\n\t\t\t\t\t\tmatchFirstNode->next = matchLastNode;\n\t\t\t\t\t\tmatchLastNode->prev = matchFirstNode;\n\t\t\t\t\t\tmatchLastNode->length -= B[b_len-1].length;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tmatchFirstNode->length += matchLastNode->length - B[b_len-1].length;\n\t\t\t\t\t\tmatchFirstNode->next = matchLastNode->next;\n\t\t\t\t\t\tmatchLastNode->next->prev = matchFirstNode;\n\t\t\t\t\t}\n\t\t\t\t}else{ //matchFirstNode == matchLastNode\n\n\t\t\t\t\tif(b_len == 1){ //c_len == 1\n\t\t\t\t\t\tif(firstNext->ch != C[0].ch){\n\t\t\t\t\t\t\tmatchFirstNode->ch = C[0].ch;\n\t\t\t\t\t\t\tmatchFirstNode->length = C[0].length;\n\t\t\t\t\t\t\tmatchFirstNode->next = firstNext;\n\t\t\t\t\t\t}else{ //firstNext.ch == C[0].ch\n\t\t\t\t\t\t\tmatchFirstNode->ch = C[0].ch;\n\t\t\t\t\t\t\tmatchFirstNode->length = C[0].length + firstNext->length;\n\t\t\t\t\t\t\tmatchFirstNode->next = firstNext->next;\n\t\t\t\t\t\t\tfirstNext->next->prev = matchFirstNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{ //b_len != 1\n\t\t\t\t\t\t//Do nothing\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\twhile(index < c_len){\n\t\t\tif(index != c_len - 1){\n\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\tpreNode = tmpNode;\n\t\t\t\ttmpNode->next = new Node;\n\t\t\t\ttmpNode = tmpNode->next;\n\t\t\t\tindex++;\n\t\t\t}else{\n\t\t\t\tif(right_complete_match){\n\t\t\t\t\tif(matchLastNode->ch != C[index].ch){\n\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\ttmpNode->next = matchLastNode;\n\t\t\t\t\t\tmatchLastNode->prev = tmpNode;\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}else{\n\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\ttmpNode->length = C[index].length + matchLastNode->length;\n\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\ttmpNode->next = matchLastNode->next;\n\t\t\t\t\t\tmatchLastNode->next->prev = tmpNode;\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\n\t\t\t\t\tif(matchFirstNode != matchLastNode){\n\t\t\t\t\t\tif(matchLastNode->ch != C[index].ch){\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = matchLastNode;\n\t\t\t\t\t\t\tmatchLastNode->length -= B[b_len-1].length;\n\t\t\t\t\t\t\tmatchLastNode->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = matchLastNode->length-B[b_len-1].length + C[index].length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = matchLastNode->next;\n\t\t\t\t\t\t\tmatchLastNode->next->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\n\t\t\t\t\t\tif(firstNext->ch != C[index].ch){\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = C[index].length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = firstNext;\n\t\t\t\t\t\t\tfirstNext->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\ttmpNode->ch = C[index].ch;\n\t\t\t\t\t\t\ttmpNode->length = C[index].length + firstNext->length;\n\t\t\t\t\t\t\ttmpNode->prev = preNode;\n\t\t\t\t\t\t\ttmpNode->next = firstNext->next;\n\t\t\t\t\t\t\tfirstNext->next->prev = tmpNode;\n\t\t\t\t\t\t\tindex++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tvoid output(){\n\n\t\tNode* tmpNode = motherNode->next;\n\t\twhile(tmpNode != motherNode){\n\t\t\tprintf(\"%c %d \",tmpNode->ch,tmpNode->length);\n\t\t\ttmpNode = tmpNode->next;\n\t\t}\n\n\t\tprintf(\"$\\n\");\n\t}\n\nprivate:\n\tNode* motherNode,*matchFirstNode,*matchLastNode;\n\tbool left_complete_match,right_complete_match;\n};\n\n\n\nint main(){\n\n\tList list;\n\n\tchar buf[2];\n\tint num;\n\tInfo tmp;\n\n\twhile(true){\n\t\tscanf(\"%s\",buf);\n\t\tif(buf[0] == '$')break;\n\n\t\tscanf(\"%d\",&num);\n\n\t\ttmp.set(buf[0],num);\n\t\tA[a_len++].set(buf[0],num);\n\n\t\tlist.registA(tmp);\n\t}\n\n\tfor(int i = 0; i < 2000; i++){\n\t\tB[i].isFirst = false;\n\t\tB[i].isLast = false;\n\t}\n\n\twhile(true){\n\t\tscanf(\"%s\",buf);\n\t\tif(buf[0] == '$')break;\n\n\t\tscanf(\"%d\",&num);\n\n\t\tB[b_len++].set(buf[0],num);\n\t}\n\n\tB[0].isFirst = true;\n\tB[b_len-1].isLast = true;\n\n\tif(!list.isMatchB()){\n\n\t\tfor(int i = 0; i < a_len; i++){\n\t\t\tprintf(\"%c %d \",A[i].ch,A[i].length);\n\t\t}\n\t\tprintf(\"$\\n\");\n\t\treturn 0;\n\t}\n\n\twhile(true){\n\t\tscanf(\"%s\",buf);\n\t\tif(buf[0] == '$')break;\n\n\t\tscanf(\"%d\",&num);\n\n\t\tC[c_len++].set(buf[0],num);\n\t}\n\n\tlist.replace();\n\n\tlist.output();\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define s second\n#define f first\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\nvector<P> A[3],ans;\nll len[3];\n\nint main(){\n  char c;\n  ll n;\n  for(int i=0;i<3;i++){\n    while(cin>>c,c!='$')\n      cin>>n,A[i].push_back(P(c,n));\n    len[i]=A[i].size();\n  }\n  int F=0;\n  for(int i=0;i<len[0];i++){\n    if((F||i>len[0]-len[1])&&A[0][i].s){\n      ans.push_back(A[0][i]);\n      continue;\n    }\n    if(F)continue;\n    int flag=0;\n    for(int j=0;j<len[1];j++){\n      ll a=A[0][i+j].s,b=A[1][j].s;\n      if(A[0][i+j].f!=A[1][j].f)flag=1;\n      if(!j&&a<b)flag=1;\n      if(j&&j!=len[1]-1&&a!=b)flag=1;\n      if(j==len[1]-1&&a<b)flag=1;\n    }\n    if(!flag){\n      F=1;\n      if(A[0][i].s>A[1][0].s&&len[1]!=1)\n\tans.push_back(P(A[1][0].f,A[0][i].s-A[1][0].s));\n      for(int j=0;j<len[2];j++)\n\tans.push_back(A[2][j]);\n      A[0][i+len[1]-1].s-=A[1][len[1]-1].s;\n      i+=len[1]-2;\n    }\n  }\n  char ch=ans[0].f;\n  ll sum=ans[0].s;\n  for(int i=1;i<ans.size();i++){\n    if(ch==ans[i].f)sum+=ans[i].s;\n    else cout<<ch<<' '<<sum<<' ',ch=ans[i].f,sum=ans[i].s;\n  }\n  cout<<ch<<' '<<sum<<\" $\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing P=pair<char,int>;\n\nint main(){\n    vector<P> A,B,C;\n    char c;\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        A.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        B.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        C.emplace_back(c,l);\n    }\n    vector<P> ans;\n    for(int i=0;i<A.size();i++){\n        if(A[i].first==B.front().first&&A[i].second>=B.front().second){\n            bool flag=true;\n            if(i+B.size()<A.size()){\n                for(int d=1;d<B.size();d++){\n                    if(A[i+d].first!=B[d].first){\n                        flag=false;\n                        break;\n                    }\n                    if(d==B.size()-2){\n                        if(A[i+d].second!=B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }else{\n                        if(A[i+d].second<B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }\n                }\n            }else{\n                continue;\n            }\n            if(flag){\n                for(int j=0;j<i;j++){\n                    ans.push_back(A[j]);\n                }\n                if(A[i].second!=B[0].second){\n                    ans.emplace_back(A[i].first,A[i].second-B[0].second);\n                }\n                for(int j=0;j<C.size();j++){\n                    if(j==0&&ans.back().first==C.front().first){\n                        ans.back().second+=C.front().second;\n                    }else{\n                        ans.push_back(C[j]);\n                    }\n                }\n\n                if(A[i+B.size()-1].second!=B.back().second){\n                    if(ans.back().first==B.back().first){\n                        ans.back().second+=A[i+B.size()-1].second-B.back().second;\n                    }else{\n                        ans.emplace_back(B.back().first, A[i+B.size()-1].second-B.back().second);\n                    }\n                }\n                for(int j=i+B.size();j<A.size();j++){\n                    ans.push_back(A[j]);\n                }\n                for(auto p:ans){\n                    char c; int l;\n                    tie(c,l)=p;\n                    cout<<c<<' '<<l<<' ';\n                }\n                cout<<'$'<<endl;\n                return 0;\n            }\n        }   \n    }\n    for(auto p:A){\n        char c; int l;\n        tie(c,l)=p;\n        cout<<c<<' '<<l<<' ';\n    }\n    cout<<'$'<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\nusing Pi = pair<int, int>;\nusing Pl = pair<ll, ll>;\nusing Ti = tuple<int, int, int>;\nusing Tl = tuple<ll, ll, ll>;\n\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define F first\n#define S second\n#define Get(t, i) get<(i)>((t))\n#define all(v) (v).begin(), (v).end()\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define reps(i, f, n) for(int i = (int)(f); i < (int)(n); i++)\n#define each(a, b) for(auto& a : b)\n\nconst int inf = 1 << 25;\nconst ll INF = 1LL << 55;\n\nusing P = pair<char, int>;\n\nvoid input(vector<P>& v)\n{\n  char c; int l;\n  while(cin >> c, c != '$') {\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n}\n\nint main()\n{\n  vector<P> A; input(A);\n  vector<P> B; input(B);\n  vector<P> C; input(C);\n\n  rep(i, A.size()-B.size()+1) {\n    if(A[i].F == B[0].F && A[i].S >= B[i].S &&\n       A[i+B.size()-1].F == B[B.size()-1].F &&\n       A[i+B.size()-1].S >= B[B.size()-1].S) {\n      bool flag = true;\n      reps(j, 1, B.size()-1) {\n\tflag &= (A[i+j].F == B[j].F && A[i+j].S == B[j].S);\n      }\n      if(flag) {\n\tint Abofst = (A[i].S > B[0].S);\n\tint Aeofst = (A[i+B.size()-1].S > B[B.size()-1].S);\n\tif(Abofst) A[i].S -= B[0].S;\n\tif(Aeofst) A[i+B.size()-1].S -= B[B.size()-1].S;\n\tint Cbofst = (A[i-!Abofst].F == C[0].F);\n\tint Ceofst = (A[i+B.size()-1+!Aeofst].F == C[C.size()-1].F);\n\tif(Cbofst) A[i-!Abofst].S += C[0].S;\n\tif(Ceofst) A[i+B.size()-1+!Aeofst].S += C[C.size()-1].S;\n\tif(B.size() == 1) {\n\t  Abofst = 0;\n\t  //Aeofst = 0;\n\t  A[i].S += B[0].S;\n\t}\n\tif(i+Abofst < B.size()-Aeofst) A.erase(A.begin()+i+Abofst, A.begin()+B.size()-Aeofst);\n\tvector<P> D;\n\treps(j, Cbofst, C.size()-Ceofst) D.push_back(C[j]);\n\tA.insert(A.begin()+i+Abofst, D.begin(), D.end());\n\trep(j, A.size()) {\n\t  if(j + 1 < A.size() && A[j].F == A[j+1].F) {\n\t    cout << A[j].F << \" \" << A[j].S+A[j+1].S-C[0].S << \" \";\n\t    j++;\n\t  } else {\n\t    cout << A[j].F << \" \" << A[j].S << \" \";\n\t  }\n\t}\n\tcout << \"$\" << endl;\n\treturn 0;\n      }\n    }\n  }\n  rep(i, A.size()) {\n    cout << A[i].F << \" \" << A[i].S << \" \";\n  }\n  cout << \"$\" << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define F first\n#define S second\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define reps(i, f, n) for(int i = (int)(f); i < (int)(n); i++)\n\nconst int inf = 1 << 25;\n\ntypedef pair<char, int> P;\n\nvoid input(vector<P>& v)\n{\n  char c; int l;\n  while(cin >> c, c != '$') {\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n}\n\nint main()\n{\n  vector<P> A; input(A);\n  vector<P> B; input(B);\n  vector<P> C; input(C);\n\n  int a = A.size();\n  int b = B.size();\n  int c = C.size();\n\n  rep(i, a-b+1) {\n    if(A[i].F == B[0].F && A[i].S >= B[0].S &&\n       A[i+b-1].F == B[b-1].F && A[i+b-1].S >= B[b-1].S) {\n      bool flag = true;\n      reps(j, 1, b-1) flag &= (A[i+j].F == B[j].F && A[i+j].S == B[j].S);\n      if(!flag) continue;\n      if(b == 1) {\n\tA[i].S -= B[0].S;\n\tauto it1 = begin(A)+i;\n\tif(A[i].S == 0)\tA.erase(begin(A)+i, begin(A)+i+1);\n\telse it1++;\n\tA.insert(it1, begin(C), end(C));\n      } else {\n\tA[i].S -= B[0].S;\n        A[i+b-1].S -= B[b-1].S;\n\tauto it1 = begin(A)+i;\n\tauto it2 = it1 + b;\n\tif(A[i].S != 0) it1++;\n\tif(A[i+b-1].S != 0) it2--;\n\tA.erase(it1, it2);\n\tA.insert(it1, begin(C), end(C));\n      }\n      for(auto it = begin(A); it != end(A); it++) {\n\tauto itr = it+1;\n\twhile(itr != end(A) && it->F == itr->F) it->S += itr->S, itr++;\n\tif(itr != it+1) A.erase(it+1, itr);\n      }\n    }\n  }\n\n  rep(i, A.size()) cout << A[i].F << \" \" << A[i].S << \" \";\n  cout << \"$\" << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\nusing namespace std;\nstring s; int x; vector<pair<string, int> > a, b, c;\nvector<pair<string, int> > shift(vector<pair<string, int> > v) {\n\tvector<pair<string, int> > ret;\n\tint p = 0, sum = v[0].second;\n\tfor (int i = 1; i <= v.size(); i++) {\n\t\tif (i == v.size() || v[i - 1].first != v[i].first) {\n\t\t\tif (sum > 0) ret.push_back(make_pair(v[i - 1].first, sum));\n\t\t\tsum = 0;\n\t\t}\n\t\tif (i != v.size()) sum += v[i].second;\n\t}\n\treturn ret;\n}\nint main() {\n\twhile (cin >> s, s != \"$\") cin >> x, a.push_back(make_pair(s, x));\n\twhile (cin >> s, s != \"$\") cin >> x, b.push_back(make_pair(s, x));\n\twhile (cin >> s, s != \"$\") cin >> x, c.push_back(make_pair(s, x));\n\tfor (int i = 0; i <= a.size() - b.size(); i++) {\n\t\tbool ok = true;\n\t\tfor (int j = 0; j < b.size(); j++) {\n\t\t\tif (a[i + j].first != b[j].first) ok = false;\n\t\t}\n\t\tfor (int j = 2; j < b.size(); j++) {\n\t\t\tif (a[i + j - 1].second != b[j - 1].second) ok = false;\n\t\t}\n\t\tif (a[i].second < b[0].second) ok = false;\n\t\tif (a[i + b.size() - 1].second < b[b.size() - 1].second) ok = false;\n\t\tif (ok) {\n\t\t\tvector<pair<string, int> > d(a.begin(), a.begin() + i);\n\t\t\td.push_back(make_pair(a[i].first, a[i].second - b[0].second));\n\t\t\td.insert(d.end(), c.begin(), c.end());\n\t\t\td.push_back(make_pair(a[i + b.size() - 1].first, a[i + b.size() - 1].second - b[b.size() - 1].second));\n\t\t\td.insert(d.end(), a.begin() + i + b.size(), a.end());\n\t\t\ta = shift(d);\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor (int i = 0; i < a.size(); i++) cout << a[i].first << ' ' << a[i].second << ' ';\n\tcout << \"$\" << endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing P=pair<char,int>;\n\nint main(){\n    vector<P> A,B,C;\n    char c;\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        A.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        B.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        C.emplace_back(c,l);\n    }\n    vector<P> ans;\n    for(int i=0;i<A.size();i++){\n        if(A[i].first==B.front().first&&A[i].second>=B.front().second){\n            bool flag=true;\n            if(i+B.size()<=A.size()){\n                for(int d=1;d<B.size();d++){\n                    if(A[i+d].first!=B[d].first){\n                        flag=false;\n                        break;\n                    }\n                    if(d!=B.size()-2){\n                        if(A[i+d].second!=B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }else{\n                        if(A[i+d].second<B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }\n                }\n            }else{\n                continue;\n            }\n            if(flag){\n                for(int j=0;j<i;j++){\n                    ans.push_back(A[j]);\n                }\n                if(A[i].second!=B[0].second){\n                    ans.emplace_back(A[i].first,A[i].second-B[0].second);\n                }\n                for(int j=0;j<C.size();j++){\n                    if(j==0&&!ans.empty()&&ans.back().first==C.front().first){\n                        ans.back().second+=C.front().second;\n                    }else{\n                        ans.push_back(C[j]);\n                    }\n                }\n\n                if(A[i+B.size()-1].second!=B.back().second){\n                    if(ans.back().first==B.back().first){\n                        ans.back().second+=A[i+B.size()-1].second-B.back().second;\n                    }else{\n                        ans.emplace_back(B.back().first, A[i+B.size()-1].second-B.back().second);\n                    }\n                }\n                for(int j=i+B.size();j<A.size();j++){\n                    ans.push_back(A[j]);\n                }\n                for(auto p:ans){\n                    char c; int l;\n                    tie(c,l)=p;\n                    cout<<c<<' '<<l<<' ';\n                }\n                cout<<'$'<<endl;\n                /*\n                {\n                    bool b=true;\n                    for(int i=0;i<A.size();i++){\n                        if(A[i]!=B[i]){\n                            cout<<i<<' '<<A[i].first<<' '<<A[i].second<<' '<<B[i].first<<' '<<B[i].second<<endl;\n                        }\n                    }\n                    cout<<b<<endl;\n                }\n\n                cout<<A.size()<<endl;\n                cout<<B.size()<<endl;\n                cout<<C.size()<<endl;\n                cout<<ans.size()<<endl;\n                */\n                return 0;\n            }\n        }   \n    }\n    for(auto p:A){\n        char c; int l;\n        tie(c,l)=p;\n        cout<<c<<' '<<l<<' ';\n    }\n    cout<<'$'<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <numeric>\n#include <bitset>\n#include <cmath>\n\nstatic const int MOD = 1000000007;\nusing ll = long long;\nusing u32 = uint32_t;\nusing namespace std;\n\ntemplate<class T> constexpr T INF = ::numeric_limits<T>::max()/32*15+208;\n\nvoid insert(vector<pair<char, int>> &v, pair<char, int> c){\n    if(c.second == 0) return;\n    if(v.empty() || v.back().first != c.first) v.emplace_back(c);\n    else v.back().second += c.second;\n}\n\nint main() {\n    vector<pair<char, int>> A, B, C;\n    char c;\n    int cnt = 1;\n    while(cin >> c, c != '$'){\n        int x; cin >> x;\n        A.emplace_back(c, x);\n        cnt++;\n    }\n    while(cin >> c, c != '$'){\n        int x; cin >> x;\n        B.emplace_back(c, x);\n        cnt--;\n    }\n    while(cin >> c, c != '$'){\n        int x; cin >> x;\n        C.emplace_back(c, x);\n    }\n    int n = A.size(), m = B.size(), p = C.size();\n    for (int i = 0; i < cnt; ++i) {\n        int ok = 1;\n        for (int j = 0; j < m; ++j) {\n            if(A[i+j].first != B[j].first) {\n                ok = 0;\n                break;\n            }\n            if(j == 0 || j+1 == m){\n                if(A[i+j].second < B[j].second) {\n                    ok = 0;\n                    break;\n                }\n            }else {\n                if(A[i+j].second != B[j].second){\n                    ok = 0;\n                    break;\n                }\n            }\n        }\n        if(ok){\n            for (int j = 0; j < m; ++j) {\n                A[i+j].second -= B[j].second;\n            }\n            vector<pair<char, int>> ans;\n            for (int j = 0; j <= i-(m == 1); ++j) {\n                insert(ans, A[j]);\n            }\n            for (int k = 0; k < p; ++k) {\n                insert(ans, C[k]);\n            }\n            for (int j = i+1-(m == 1); j < n; ++j) {\n                insert(ans, A[j]);\n            }\n            for (auto &&l : ans) {\n                cout << l.first << \" \" << l.second << \" \";\n            }\n            puts(\"$\");\n            return 0;\n        }\n\n    }\n    for (auto &&l : A) {\n        cout << l.first << \" \" << l.second << \" \";\n    }\n    puts(\"$\");\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<char,ll> P;\n\n\nvector<P>A,B,C;\nvoid input(vector<P> &a){\n  int num;\n  char ch;\n  while(cin>>ch,ch!='$'){\n    cin>>num;\n    a.push_back(P(ch,num));\n  }\n}\n\nbool check(int i){\n  int n = A.size();\n  int m = B.size();\n  if(i+m>n) return 0;\n  if(A[i].first!=B[0].first||A[i].second<B[0].second)return 0;\n  if(m == 1) return 1;\n\n  i++;\n  for(int j=1;i<m-1;j++,i++)\n    if(A[i].first!=B[j].first||A[i].second!=B[j].second)return 0;\n  \n  if(A[i].first!=B[m-1].first||A[i].second<B[m-1].second)return 0;\n  return 1;\n}\n\nvoid mergePush(vector<P> &res,P a){\n  int c = a.second;\n  char ch = a.first;\n  if(c == 0)return;\n  if(res.size() && res.back().first == ch)res.back().second+=c;\n  else res.push_back(P(ch,c));\n}\n\nvector<P> solve2(){\n  vector<P> res;\n  int n = A.size();\n  int m = B.size();\n  int l = C.size();\n  for(int i = 0;i<n;i++){\n    if(!check(i)){mergePush(res,A[i]);continue;}\n    for(int j=0;j<l;j++)mergePush(res,C[j]);\n    A[i--].second -= B[0].second;\n  }\n  return res;\n}\n\n\nvector<P> solve(){\n  vector<P> res;\n  int n = A.size();\n  int m = B.size();\n  int l = C.size();\n  if(m==1) return solve2();\n\n  for(int i=0;i<n;i++){\n    if(!check(i)){mergePush(res,A[i]);continue;}\n    mergePush(res,P(A[i].first,A[i].second - B[0].second));   \n    for(int j=0;j<l;j++) mergePush(res,C[j]);\n    i+=m-1;\n    A[i--].second -= B.back().second;\n  }\n  return res;\n}\n\n\n\nint main(){\n  input(A);\n  input(B);\n  input(C);\n  vector<P> ans = solve();\n  for(P a:ans) cout<<a.first<<\" \"<<a.second<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <sstream>\n\nusing namespace std;\n\nusing Array = basic_string<pair<char, int>>;\nArray a, b, c;\n\nvoid input(Array &a){\n    string c; int l;\n    while(cin >> c, c[0] != '$'){\n        cin >> l;\n        a += make_pair(c[0], l);\n    }\n}\n\nint main(){\n    input(a);\n    input(b);\n    input(c);\n    a = make_pair('0', 0) + a + make_pair('0', 0);\n    if(b.size() == 1){\n        for(int i = 0; i < (int)a.size(); ++i){\n            if(a[i].first == b[0].first && a[i].second >= b[0].second){\n                a[i].second -= b[0].second;\n                a = a.substr(0, i) + c + a.substr(i);\n                break;\n            }\n        }\n    } else {\n        for(int i = 1; i+b.size()-2 <= a.size(); ++i){\n            if(b.substr(1, b.size()-2) == a.substr(i, b.size()-2)){\n                if(a[i-1].first == b[0].first && a[i-1].second >= b[0].second &&\n                    a[i+b.size()-2].first == b.back().first && a[i+b.size()-2].second >= b.back().second){\n                    a[i-1].second -= b[0].second;\n                    a[i+b.size()-2].second -= b.back().second;\n                    a = a.substr(0,i) + c + a.substr(i+b.size()-2);\n                    break;\n                }\n            }\n        }\n    }\n\n    for(int i = 0; i < (int)a.size(); ++i){\n        while(i < (int)a.size() && a[i].second == 0) a.erase(a.begin()+i);\n        int j = i + 1;\n        while(j < (int)a.size() && a[i].first == a[j].first){\n            a[i].second += a[j].second;\n            a.erase(a.begin()+j);\n        }\n    }\n    for(int i = 0; i < (int)a.size(); ++i){\n        cout << a[i].first << ' ' << a[i].second << ' ';\n    }\n    cout << '$' << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\n//const int INF = 1e8;\nusing namespace std;\n\nstruct Data{\n\tchar c;\n\tint n;\n\tData(char c, int n) : c(c), n(n) {}\n};\n\nvoid parser(list<Data>& a){\n\tchar chr;\n\tint num;\n\twhile(cin >> chr, chr != '$'){\n\t\tcin >> num;\n\t\ta.emplace_back(chr, num);\n\t}\n}\n\nlist<Data> a, b, c;\n\nbool canReplace(list<Data>::iterator it){\n\tint idx = 0;\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n\tfor(auto i = it, j = b.begin(); j != b.end(); i++, j++){\n\t\tif(i->c != j->c) return false;\n\t\tif(idx == 0 or idx == b.size() - 1){\n\t\t\tif(i->n < j->n) return false;\n\t\t}else{\n\t\t\tif(i->n != j->n) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\n\nvoid replaceList(list<Data>::iterator& it){\n\trep(i,b.size()){\n\t\tif(i == 0){\n\t\t\tit->n -= (*b.begin()).n;\n\t\t\tit++;\n\t\t}else if(i == b.size() - 1){\n\t\t\tit->n -= (*--b.end()).n;\n\t\t}else{\n\t\t\tit = a.erase(it);\n\t\t}\n\t}\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n\tfor(auto i : c){\n\t\ta.insert(it,i);\n\t\tit++;\n\t}\n\t//for(auto i : a){ cout << i.c << ' ' << i.n << ' '; } cout << endl;\n}\n\nbool check(){\n\tint idx = 0;\n\tbool f = false;\n\tfor(auto it = a.begin(); idx + b.size() <= a.size(); it++, idx++){\n\t\tif(canReplace(it)){\n\t\t\treplaceList(it);\n\t\t\tf = true;\n\t\t}\n\t}\n\treturn f;\n}\n\nvoid compress(){\n\tauto it = a.begin();\n\twhile(it != a.end()){\n\t\tif(it->c == next(it, 1)->c){\n\t\t\tit->n += next(it, 1)->n;\n\t\t\ta.erase(next(it,1));\n\t\t}else if(it->n == 0){\n\t\t\tit = a.erase(it);\n\t\t}else{\n\t\t\tit++;\n\t\t}\n\t}\n}\n\nint main(){\n\tparser(a);\n\tparser(b);\n\tparser(c);\n\n\twhile(true){\n\t\tcompress();\n\t\tif(check() == false) break;\n\t}\n\t\n\tfor(auto i : a){\n\t\tcout << i.c << ' ' << i.n << ' ';\n\t}\n\tcout << '$' << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define f first\n#define s second\n#define mp make_pair\nusing namespace std;\n\nint main()\n{\n  vector<pair<char,long long> > A,B,C;\n  char c;\n  int a;\n\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    A.push_back(mp(c,a));\n  }\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    B.push_back(mp(c,a));\n  }\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    C.push_back(mp(c,a));\n  }\n\n  for(int i=0;i<A.size();i++){\n    bool flag=true;\n    for(int j=0;j<B.size();j++){\n      if(j==0 || j==B.size()-1){\n\tif(A[i+j].f!=B[j].f || A[i+j].s<B[j].s)flag=false;\n      }\n      else {\n\tif(A[i+j].f!=B[j].f || A[i+j].s!=B[j].s)flag=false;\n      }\n    }\n    if(flag){\n      for(int j=0;j<B.size();j++){\n\tif(j==0 || j==B.size()-1){\n\t  A[i+j].s-=B[j].s;\n\t}\n\telse A[i+j].s=0;\n      }\n      A.insert(A.begin()+i+1,C.begin(),C.end());\n      for(int j=0;j<A.size();j++){\n\tif(A[j].s==0){\n\t  A.erase(A.begin()+j);\n\t  j--;\n\t}\n      }\n      for(int j=1;j<A.size();j++){\n\tif(A[j].f==A[j-1].f){\n\t  A[j-1].s+=A[j].s;\n\t  A.erase(A.begin()+j);\n\t  j--;\n\t}\n      }\n      i--;\n    }\n  }\n\n  for(int i=0;i<A.size();i++)cout<<A[i].f<<\" \"<<A[i].s<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstruct RLEchar{\n    char x;\n    int len;\n};\n\nusing RLE=vector<RLEchar>;\nistream& operator>>(istream& in,RLE& rle){\n    char c;\n    while(cin>>c,c!='$'){\n        int l; cin>>l;\n        rle.push_back(RLEchar{c,l});\n    }\n    return in;\n}\nostream& operator<<(ostream& out,RLE rle){\n    for(int i=0;i<rle.size();i++){\n        out<<rle[i].x<<\" \"<<rle[i].len<<\" \";\n    }\n    out<<\"$\"<<endl;\n    return out;\n}\n\nvoid shrink(RLE &rle){\n    RLE res;\n    for(int i=0;i<rle.size();i++){\n        if(rle[i].len==0) continue;\n        else if(res.size()==0) res.push_back(rle[i]);\n        else if(res.back().x!=rle[i].x) res.push_back(rle[i]);\n        else res.back().len+=rle[i].len;\n    }\n    rle=res;\n}\n\nvoid replace(RLE& a,RLE b,RLE c){\n    for(int i=0;i+b.size()<=a.size();i++){\n        if(b.size()==1){\n            if(a[i].x==b[0].x && a[i].len>=b[0].len){\n                RLE tmp;\n                for(int j=0;j<i;j++){\n                    tmp.push_back(a[j]);\n                }\n                tmp.push_back(RLEchar{a[i].x,a[i].len-b[0].len});\n                for(int j=0;j<c.size();j++) tmp.push_back(c[j]);\n                for(int j=i+1;j<a.size();j++){\n                    tmp.push_back(a[j]);\n                }\n                a=tmp;\n                break;\n            }\n        }\n        else{\n            bool isok=(a[i].x==b[0].x && a[i].len>=b[0].len);\n            for(int j=1;j+1<b.size();j++){\n                isok&=(a[i+j].x==b[j].x && a[i+j].len==b[j].len);\n            }\n            isok&=(a[i+b.size()-1].x==b.back().x && a[i+b.size()-1].len>=b.back().len);\n            if(isok){\n                RLE tmp;\n                for(int j=0;j<i;j++){\n                    tmp.push_back(a[j]);\n                }\n                tmp.push_back(RLEchar{a[i].x,a[i].len-b[0].len});\n                for(int j=0;j<c.size();j++) tmp.push_back(c[j]);\n                tmp.push_back(RLEchar{a[i+b.size()-1].x,a[i+b.size()-1].len-b.back().len});\n                for(int j=i+b.size();j<a.size();j++){\n                    tmp.push_back(a[j]);\n                }\n                a=tmp;\n                break;\n            }\n        }\n    }\n    shrink(a);\n}\n\nint main(){\n    RLE a,b,c;\n    cin>>a>>b>>c;\n    replace(a,b,c);\n    cout<<a<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nsigned main() {\n  vector<char> ca;\n  vector<int> la;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      ca.emplace_back(c);\n      la.emplace_back(l);      \n    }\n  }\n\n  vector<char> cb;\n  vector<int> lb;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      cb.emplace_back(c);\n      lb.emplace_back(l);      \n    }\n  }\n\n  vector<char> cc;\n  vector<int> lc;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      cc.emplace_back(c);\n      lc.emplace_back(l);      \n    }\n  }\n\n  int a = ca.size(), b = cb.size(), c = cc.size();\n  vector<char> ansc;\n  vector<int> ansl;  \n  for ( int i = 0; i < a; i++ ) {\n    if ( ca[i] != cb[0] || la[i] < lb[0] ) continue;\n    if ( i+b > a ) continue;\n    if ( ca[i+b-1] != cb[b-1] ||la[i+b-1] < lb[b-1] ) continue;\n    bool flag = true;\n    for ( int j = 1; j < b-1; j++ ) {\n      if ( ca[i+j] != cb[j] ||la[i+j] != lb[j] ) {\n\tflag = false;\n\tbreak;\n      }\n    }\n\n    if ( flag ) {\n      for ( int j = 0; j < i; j++ ) {\n\t// cout << ca[j] << \" \" << la[j] << \" \";\n\tansc.emplace_back(ca[j]);\n\tansl.emplace_back(la[j]);\n      }\n      // cout << ca[i] << \" \" << la[i]-lb[0] << \" \";\n      ansc.emplace_back(ca[i]);\n      ansl.emplace_back(la[i]-lb[0]);      \n      for ( int j = 0; j < c; j++ ) {\n\t// cout << cc[i] << \" \" << lc[j] << \" \";\n\tansc.emplace_back(cc[j]);\n\tansl.emplace_back(lc[j]);\n      }\n      // cout << ca[i+b-1] << \" \" << la[i+b-1]-lb[b-1] << \" \";\n      if ( b > 1 ) {\t\n\tansc.emplace_back(ca[i+b-1]);\n\tansl.emplace_back(la[i+b-1]-lb[b-1]);\t\n      }\n      for ( int j = i+b; j < a; j++ ) {\n\t// cout << ca[j] << \" \" << la[j] << \" \";\n\tansc.emplace_back(ca[j]);\n\tansl.emplace_back(la[j]);\t\n      }\n      break;      \n    }\n  }\n\n  if ( ansc.size() == 0 ) {\n    ansc = ca; ansl = la;    \n  }\n  \n  for ( int i = 0; i < (int)ansc.size(); i++ ) {\n    if ( ansl[i] == 0 ) continue;    \n    if ( i < (int)ansc.size()-1 ) {\n      if ( ansc[i] == ansc[i+1] ) {\n\tansl[i+1] += ansl[i];\t\n      } else {\n\tcout << ansc[i] << \" \" << ansl[i] << \" \";\t\n      }\n    } else {\n      cout << ansc[i] << \" \" << ansl[i] << \" \";\t\n    }\n  }\n  cout << '$' << endl;\n  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\ntypedef pair<char, int> pci;\n\nint main()\n{\n\tvector<pci> a, b, c;\n\tchar let; int n;\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\ta.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tb.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tc.emplace_back(let, n);\n\t}\n\tvector<pci> res;\n\t\n\tREP(i, (int)a.size() - (int)b.size() + 1)\n\t{\n\t\tif (a[i].first == b[0].first&&a[i].second >= b[0].second)\n\t\t{\n\t\t\tbool f = true;\n\t\t\tint j;\n\t\t\tfor (j = 1; j < b.size(); j++)\n\t\t\t{\n\t\t\t\tif (j == b.size() - 1)\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second >= a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second != a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (f)\n\t\t\t{\n\t\t\t\tif (b.size() == 1)\n\t\t\t\t{\n\t\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\t\tif (a[i].second > b[0].second) res.emplace_back(a[i].first, a[i].second - b[0].second);\n\t\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\t\tif (a[i].second > b[0].second) res.emplace_back(a[i].first, a[i].second - b[0].second);\n\t\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\t\tif (a[i + b.size() - 1].second > b.back().second) res.emplace_back(b.back().first, a[i + b.size() - 1].second - b.back().second);\n\t\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\t\ti = INF;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tvector<pci> ans;\n\tif (res.size() == 0) ans = a;\n\telse\n\t{\n\t\tans.emplace_back(res[0]);\n\t\tFOR(i, 1, res.size())\n\t\t{\n\t\t\tif (res[i].first == ans.back().first) ans.back().second += res[i].second;\n\t\t\telse ans.emplace_back(res[i]);\n\t\t}\n\t}\n\tREP(i, ans.size()) cout << ans[i].first << \" \" << ans[i].second << (i == ans.size() - 1 ? \" $\\n\" : \" \");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing pii = pair<int, int>;\n\nstring A, B, C;\nusing P = pair<char, int>;\nvector<P> a, b, c;\n\nint main() {\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n  cout << fixed << setprecision(10);\n  \n  getline(cin, A);\n  getline(cin, B);\n  getline(cin, C);\n  char x;\n  int y;\n  stringstream ssa(A), ssb(B), ssc(C);\n  while (ssa >> x >> y, x != '$') {\n    a.emplace_back(x, y);\n  }\n  while (ssb >> x >> y, x != '$') {\n    b.emplace_back(x, y);\n  }\n  while (ssc >> x >> y, x != '$') {\n    c.emplace_back(x, y);\n  }\n  int az = a.size(), bz = b.size(), cz = c.size();\n  int pos = -1;\n  for (int i = 0; i + bz - 1 < az; i++) {\n    if (a[i].first != b[0].first) continue;\n    if (a[i].second < b[0].second) continue;\n    if (a[i + bz - 1].first != b[bz - 1].first) continue;\n    if (a[i + bz - 1].second < b[bz - 1].second) continue;\n    int no = 0;\n    for (int j = 1; j < bz - 1; j++) {\n      if (a[i + j] != b[j]) no = 1;\n    }\n    if (!no) {\n      pos = i;\n      break;\n    }\n  }\n  if (pos == -1) {\n    for (int i = 0; i < az; i++) {\n      cout << a[i].first << \" \" << a[i].second << \" \";\n    }\n    cout << \"$\" << endl;\n    return 0;\n  }\n  vector<P> v;\n  for (int i = 0; i < pos; i++) {\n    v.emplace_back(a[i]);\n  }\n  if (bz != 1 && a[pos].second - b[0].second) {\n    v.emplace_back(a[pos].first, a[pos].second - b[0].second);\n  }\n  for (int i = 0; i < cz; i++) {\n    v.emplace_back(c[i]);\n  }\n  if (a[pos + bz - 1].second - b[bz - 1].second) {\n    v.emplace_back(a[pos + bz - 1].first, a[pos + bz - 1].second - b[bz - 1].second);\n  }\n  for (int i = pos + bz; i < az; i++) {\n    v.emplace_back(a[i]);\n  }\n  vector<P> ans;\n  int l = 0, r = 0;\n  while (l < v.size()) {\n    int sum = 0;\n    while (r < v.size() && v[r].first == v[l].first) {\n      sum += v[r++].second;\n    }\n    ans.emplace_back(v[l].first, sum);\n    l = r;\n  }\n  for (int i = 0; i < ans.size(); i++) {\n    cout << ans[i].first << \" \" << ans[i].second << \" \";\n  }\n  cout << \"$\" << endl;\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define F first\n#define S second\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define reps(i, f, n) for(int i = (int)(f); i < (int)(n); i++)\n\nconst int inf = 1 << 25;\n\ntypedef pair<char, int> P;\n\nvoid input(vector<P>& v)\n{\n  char c; int l;\n  while(cin >> c, c != '$') {\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n}\n\nint main()\n{\n  vector<P> A; input(A);\n  vector<P> B; input(B);\n  vector<P> C; input(C);\n\n  int a = A.size();\n  int b = B.size();\n  int c = C.size();\n\n  rep(i, A.size()-b+1) {\n    if(A[i].F == B[0].F && A[i].S >= B[0].S &&\n       A[i+b-1].F == B[b-1].F && A[i+b-1].S >= B[b-1].S) {\n      bool flag = true;\n      reps(j, 1, b-1) flag &= (A[i+j].F == B[j].F && A[i+j].S == B[j].S);\n      if(!flag) continue;\n      rep(j, b) A[i+j].S -= B[j].S;\n      if(b == 1) A.insert(begin(A)+i, begin(C), end(C));\n      else A.insert(begin(A)+i+1, begin(C), end(C));\n      break;\n    }\n  }\n\n  auto it = begin(A);\n  while(it != end(A)) {\n    auto itr = it+1;\n    if(it->S == 0) {\n      while(itr != end(A) && itr->S == 0) itr++;\n      it = A.erase(it, itr);\n    } else {\n      while(itr != end(A) && it->F == itr->F) it->S += itr->S, itr++;\n      if(itr != it+1) it = A.erase(it+1, itr);\n      else it++;\n    }\n  }\n\n  rep(i, A.size()) cout << A[i].F << \" \" << A[i].S << \" \";\n  //rep(i, A.size()) cout << A[i].F << endl << A[i].S << endl;\n  cout << \"$\" << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\nusing namespace std;\n \n#define REP(i,n) for(int i=0; i<n; ++i)\n#define FOR(i,a,b) for(int i=a; i<=b; ++i)\n#define FORR(i,a,b) for (int i=a; i>=b; --i)\n \ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef vector<VI> VVI;\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> PL;\n\nvoid inp(vector<pair<char, int> > &a){\n    while (1){\n        char c;\n        cin >> c;\n        if (c == '$') break;\n        int x;\n        cin >> x;\n        a.push_back(make_pair(c, x));\n    }\n}\n\nint main() {\n    vector<pair<char, int> > a, b, c, res, ans;\n    inp(a);\n    inp(b);\n    inp(c);\n    REP(i,a.size() - b.size() + 1){\n        bool f = true;\n        REP(j,b.size()){\n            if (a[i+j].first != b[j].first){\n                f = false;\n                break;\n            }\n            if (j == 0 || j == b.size()-1){\n                if (a[i+j].second < b[j].second){\n                    f = false;\n                    break;\n                }\n            }else{\n                if (a[i+j].second != b[j].second){\n                    f = false;\n                    break;\n                }\n            }\n        }\n        if (f){\n            REP(j,i) res.push_back(a[j]);\n            a[i].second -= b[0].second;\n            res.push_back(a[i]);\n            REP(j,c.size()) res.push_back(c[j]);\n            if (b.size() > 1){\n                a[i+b.size()-1].second -= b[b.size()-1].second;\n                res.push_back(a[i+b.size()-1]);\n            }\n            FOR(j,i+b.size(),a.size()-1) res.push_back(a[j]);\n        }\n    }\n    if (res.empty()){\n        REP(i,a.size()){\n            printf(\"%c %d \", a[i].first, a[i].second);\n        }\n        printf(\"$ \\n\");\n    }else{\n        REP(i,res.size()){\n            if (i != 0 && ans[ans.size()-1].first == res[i].first){\n                ans[ans.size()-1].second += res[i].second;\n            }else if (res[i].second > 0){\n                ans.push_back(res[i]);\n            }\n        }\n        REP(i,ans.size()){\n            printf(\"%c %d \", ans[i].first, ans[i].second);\n        }\n        printf(\"$ \\n\");\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define f first\n#define s second\n#define mp make_pair\nusing namespace std;\n\nint main()\n{\n  vector<pair<char,long long> > A,B,C;\n  char c;\n  int a;\n\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    A.push_back(mp(c,a));\n  }\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    B.push_back(mp(c,a));\n  }\n  while(1){\n    cin>>c;\n    if(c=='$')break;\n    cin>>a;\n    C.push_back(mp(c,a));\n  }\n\n  for(int i=0;i<A.size();i++){\n    bool flag=true;\n    for(int j=0;j<B.size();j++){\n      if(j==0 || j==B.size()-1){\n\tif(A[i+j].f!=B[j].f || A[i+j].s<B[j].s)flag=false;\n      }\n      else {\n\tif(A[i+j].f!=B[j].f || A[i+j].s!=B[j].s)flag=false;\n      }\n    }\n    if(flag){\n      for(int j=0;j<B.size();j++){\n\tif(j==0 || j==B.size()-1){\n\t  A[i+j].s-=B[j].s;\n\t}\n\telse A[i+j].s=0;\n      }\n      for(int j=0;j<A.size();j++){\n\tif(A[j].s==0){\n\t  A.erase(A.begin()+j);\n\t  j--;\n\t}\n      }\n      A.insert(A.begin()+i+1,C.begin(),C.end());\n      for(int j=1;j<A.size();j++){\n\tif(A[j].f==A[j-1].f){\n\t  A[j-1].s+=A[j].s;\n\t  A.erase(A.begin()+j);\n\t  j--;\n\t}\n      }\n    }\n  }\n\n  for(int i=0;i<A.size();i++)cout<<A[i].f<<\" \"<<A[i].s<<\" \";\n  cout<<\"$\"<<endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define show(x)  cerr << #x << \" = \" << (x) << endl;\n//const int INF = 1e8;\nusing namespace std;\n\n#define int long long\n\nstruct Data{\n\tchar c;\n\tint n;\n\tData(char c, int n) : c(c), n(n) {}\n};\n\nvoid parser(vector<Data>& a){\n\tchar chr;\n\tint num;\n\twhile(cin >> chr, chr != '$'){\n\t\tcin >> num;\n\t\ta.emplace_back(chr, num);\n\t}\n}\n\nvector<Data> a, b, c, ans;\n\nbool canReplace(int idx){\n\trep(i,b.size()){\n\t\tif(a[i + idx].c != b[i].c) return false;\n\t\tif(i == 0 or i == b.size() - 1){\n\t\t\tif(a[i + idx].n < b[i].n) return false;\n\t\t}else{\n\t\t\tif(a[i + idx].n != b[i].n) return false;\n\t\t}\n\t}\n\treturn true;\n}\n\nsigned main(){\n\tparser(a);\n\tparser(b);\n\tparser(c);\n\n\trep(i,a.size() - b.size() + 1){\n\t\tif(canReplace(i)){\n\t\t\trep(j,i) ans.emplace_back(a[j]);\n\n\t\t\tif(b.size() > 1){\n\t\t\t\ta[i].n -= b[0].n;\n\t\t\t\tif(a[i].n > 0) ans.emplace_back(a[i]);\n\t\t\t}\n\t\t\trep(j,c.size()) ans.emplace_back(c[j]);\n\n\t\t\ta[i + b.size() - 1].n -= b.back().n;\n\t\t\tif(a[i + b.size() - 1].n > 0) ans.emplace_back(a[i + b.size() - 1]);\n\t\t\trange(j,i + b.size(), a.size()) ans.emplace_back(a[j]);\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif(ans.empty()) ans = a;\n\n\trep(i,ans.size()){\n\t\tif(i + 1 < ans.size() and ans[i + 1].c == ans[i].c){\n\t\t\tans[i + 1].n += ans[i].n;\n\t\t}else{\n\t\t\tcout << ans[i].c << ' ' << ans[i].n << ' ';\n\t\t}\n\t}\n\tcout << '$' << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\ntypedef vector<int>vint;\ntypedef pair<int,int>pint;\ntypedef vector<pint>vpint;\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define reps(i,f,n) for(int i=(f);i<(n);i++)\n#define all(v) (v).begin(),(v).end()\n#define each(it,v) for(__typeof((v).begin()) it=(v).begin();it!=(v).end();it++)\n#define pb push_back\n#define fi first\n#define se second\ntemplate<typename A,typename B>inline void chmin(A &a,B b){if(a>b)a=b;}\ntemplate<typename A,typename B>inline void chmax(A &a,B b){if(a<b)a=b;}\n\ntypedef pair<char,int>latte;\n\nvector<latte>in(){\n    char c;\n    int d;\n    vector<latte>A;\n    while(cin>>c,c!='$'){\n        cin>>d;\n        A.pb(latte(c,d));\n    }\n    return A;\n}\n\nsigned main(){\n    vector<latte>A,B,C;\n    A=in();B=in();C=in();\n\n    for(int i=0;i+B.size()<=A.size();i++){\n        bool ok=true;\n        if(A[i].fi!=B[0].fi||A[i].se<B[0].se)ok=false;\n        if(A[i+B.size()-1].fi!=B[B.size()-1].fi||A[i+B.size()-1].se<B[B.size()-1].se)ok=false;\n        for(int j=1;j+1<B.size();j++)if(A[i+j]!=B[j])ok=false;\n        if(!ok)continue;\n        A[i].se-=B[0].se;\n        if(B.size()>1)A[i+B.size()-1].se-=B[B.size()-1].se;\n        for(int j=1;j+1<B.size();j++)A[i+j].se=0;\n        A.insert(A.begin()+i+(B.size()>1),all(C));\n        break;\n    }\n\n    vector<latte>ans;\n    rep(i,A.size()){\n        if(A[i].se==0)continue;\n        if(ans.size()&&ans.back().fi==A[i].fi)ans.back().se+=A[i].se;\n        else ans.pb(A[i]);\n    }\n\n    rep(i,ans.size())cout<<ans[i].fi<<\" \"<<ans[i].se<<\" \";cout<<\"$\"<<endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\ntypedef pair<char, int> pci;\n\nint main()\n{\n\tvector<pci> a, b, c;\n\tchar let; int n;\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\ta.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tb.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tc.emplace_back(let, n);\n\t}\n\tvector<pci> res;\n\tREP(i, a.size() - b.size() + 1)\n\t{\n\t\tif (a[i].first == b[0].first&&a[i].second >= b[0].second)\n\t\t{\n\t\t\tbool f = true;\n\t\t\tint j;\n\t\t\tfor (j = 1; j < b.size(); j++)\n\t\t\t{\n\t\t\t\tif (j == b.size() - 1)\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second >= a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second != a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (f)\n\t\t\t{\n\n\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\tif (a[i].second > b[i].second) res.emplace_back(a[i].first, a[i].second - b[i].second);\n\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\tif (a[i + b.size() - 1].second > b.back().second) res.emplace_back(b.back().first, a[i + b.size() - 1].second - b.back().second);\n\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\ti = INF;\n\t\t\t}\n\t\t}\n\t}\n\tvector<pci> ans;\n\tif (res.size() == 0) ans = a;\n\telse\n\t{\n\t\tans.emplace_back(res[0]);\n\t\tFOR(i, 1, res.size())\n\t\t{\n\t\t\tif (res[i].first == ans.back().first) ans.back().second += res[i].second;\n\t\t\telse ans.emplace_back(res[i]);\n\t\t}\n\t}\n\tREP(i, ans.size()) cout << ans[i].first << \" \" << ans[i].second << (i == ans.size() - 1 ? \" $\\n\" : \" \");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n#include <fstream>\n\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\n#define watch(a) { cout << #a << \" = \" << a << endl; }\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntypedef long long ll;\nint const inf = 1<<29;\n\nvoid change(deque<pair<char, int>>& nv0) {\n  if(nv0.size() > 1 && nv0[nv0.size()-2].first == nv0.back().first) {\n    int k = nv0.back().second;\n    nv0.pop_back();\n    nv0.back().second += k;\n  }\n}\n\nvoid output(deque<pair<char, int>>& out) {\n  rep(i, out.size()) {\n    if(i) cout << \" \";\n    cout << out[i].first << \" \" << out[i].second;\n  }\n  cout << \" $\" << endl;\n}\n\nint main() {\n\n  vector<deque<pair<char, int>>> v(3);\n  for(auto& u: v) {\n    while(1) {\n      char c; cin >> c;\n      if(c == '$') break;\n      int n; cin >> n;\n      u.emplace_back(c, n);\n    }\n  }\n\n  rep(i, (int)v[0].size()-(int)v[1].size()+1) {\n\n    if(v[1].size() == 1) {\n      if(v[0][i].first == v[1][0].first && v[0][i].second >= v[1][0].second) {\n        deque<pair<char, int>> nv0;\n        rep(k, i) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n\n        int a = v[0][i].second, b = v[1][0].second;\n        rep(k, 1) rep(l, v[2].size()) {\n          nv0.push_back(v[2][l]);\n          change(nv0);\n        }\n\n        if(a - b > 0) {\n          nv0.push_back(v[0][i]);\n          nv0.back().second = a - b;\n          change(nv0);\n        }\n        int ni = nv0.size();\n        REP(k, i+1, v[0].size()) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n        v[0] = nv0;\n        i = ni - 1;\n      }\n      break;\n    }\n\n    int j = 0;\n    vector<int> V;\n    while(j < v[1].size() && v[0][i+j].first == v[1][j].first) {\n      if(j == 0 || j == (int)v[1].size()-1) {\n        if(v[0][i+j].second < v[1][j].second) break;\n        V.push_back(v[0][i+j].second - v[1][j].second);\n      }\n      else {\n        if(v[0][i+j].second != v[1][j].second) break;\n      }\n      j++;\n    }\n\n    deque<pair<char, int>> nv0;\n\n    if(j == v[1].size()) {\n      rep(k, v[0].size()) {\n        if(k < i) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n        if(k == i) {\n          if(V[0] > 0) nv0.emplace_back(v[0][i].first, V[0]);\n          rep(l, v[2].size()) {\n            nv0.push_back(v[2][l]);\n            change(nv0);\n          }\n          k = i+v[1].size()-1;\n        }\n        if(k == i+j-1) {\n          if(V[1] > 0) nv0.emplace_back(v[0][i+j-1].first, V[1]);\n          change(nv0);\n        }\n        if(i+j <= k) {\n          nv0.push_back(v[0][k]);\n          change(nv0);\n        }\n      }\n      v[0] = nv0;\n      break;\n    }\n  }\n\n  output(v[0]);\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define F first\n#define S second\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define reps(i, f, n) for(int i = (int)(f); i < (int)(n); i++)\n\nconst int inf = 1 << 25;\n\ntypedef pair<char, int> P;\n\nvoid input(vector<P>& v)\n{\n  char c; int l;\n  while(cin >> c, c != '$') {\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n}\n\nint main()\n{\n  vector<P> A; input(A);\n  vector<P> B; input(B);\n  vector<P> C; input(C);\n\n  int a = A.size();\n  int b = B.size();\n  int c = C.size();\n\n  rep(i, a-b+1) {\n    if(A[i].F == B[0].F && A[i].S >= B[0].S &&\n       A[i+b-1].F == B[b-1].F && A[i+b-1].S >= B[b-1].S) {\n      bool flag = true;\n      reps(j, 1, b-1) flag &= (A[i+j].F == B[j].F && A[i+j].S == B[j].S);\n      if(!flag) continue;\n      if(b == 1) {\n\tif(A[i].S > B[0].S) A[i].S -= B[0].S;\n\tauto it1 = begin(A)+i;\n\tif(A[i].S == 0)\tA.erase(begin(A)+i, begin(A)+i+1);\n\telse it1++;\n\tA.insert(it1, begin(C), end(C));\n      } else {\n\tif(A[i].S > B[0].S) A[i].S -= B[0].S;\n\tif(A[i+b-1].S > B[b-1].S) A[i+b-1].S -= B[b-1].S;\n\tauto it1 = begin(A)+i;\n\tauto it2 = it1 + b;\n\tif(A[i].S != 0) it1++;\n\tif(A[i+b-1].S != 0) it2--;\n\tA.erase(it1, it2);\n\tA.insert(it1, begin(C), end(C));\n      }\n      for(auto it = begin(A); it != end(A); it++) {\n\tauto itr = it+1;\n\twhile(itr != end(A) && it->F == itr->F) it->S += itr->S, itr++;\n\tif(itr != it+1) A.erase(it+1, itr);\n      }\n    }\n  }\n\n  rep(i, A.size()) cout << A[i].F << \" \" << A[i].S << \" \";\n  cout << \"$\" << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nlong long INF = 10000000000000;\nint main(){\n  vector<pair<char, long long>> A;\n  while (1){\n    char c;\n    cin >> c;\n    if (c == '$'){\n      break;\n    }\n    int l;\n    cin >> l;\n    A.push_back(make_pair(c, l));\n  }\n  vector<pair<char, long long>> B;\n  while (1){\n    char c;\n    cin >> c;\n    if (c == '$'){\n      break;\n    }\n    int l;\n    cin >> l;\n    B.push_back(make_pair(c, l));\n  }\n  vector<pair<char, long long>> C;\n  while (1){\n    char c;\n    cin >> c;\n    if (c == '$'){\n      break;\n    }\n    int l;\n    cin >> l;\n    C.push_back(make_pair(c, l));\n  }\n  int N = A.size();\n  A.push_back(make_pair('$', INF));\n  int M = B.size();\n  long long sum = 0;\n  for (int i = 0; i < M; i++){\n    sum += B[i].second;\n  }\n  bool ok = false;\n  for (int i = 0; i < N; i++){\n    if (A[i].first == B[0].first && A[i].second >= B[0].second){\n      vector<pair<char, long long>> S;\n      S.push_back(B[0]);\n      long long L = B[0].second;\n      int p = i + 1;\n      while (1){\n        if (L + A[p].second > sum){\n          if (sum - L > 0){\n            S.push_back(make_pair(A[p].first, sum - L));\n          }\n          break;\n        } else{\n          S.push_back(A[p]);\n          L += A[p].second;\n          p++;\n        }\n      }\n      if (S == B){\n        vector<pair<char, int>> T;\n        for (int j = 0; j < i; j++){\n          T.push_back(A[j]);\n        }\n        if (B.size() > 1){\n          if (A[i].second > B[0].second){\n            T.push_back(make_pair(A[i].first, A[i].second - B[0].second));\n          }\n          for (auto P : C){\n            T.push_back(P);\n          }\n        } else {\n          for (auto P : C){\n            T.push_back(P);\n          }\n          if (A[i].second > B[0].second){\n            T.push_back(make_pair(A[i].first, A[i].second - B[0].second));\n          }\n        }\n        if (p < N){\n          T.push_back(make_pair(A[p].first, A[p].second - (sum - L)));\n        }\n        for (int j = p + 1; j < N; j++){\n          T.push_back(A[j]);\n        }\n        int K = T.size();\n        vector<pair<char, int>> ans;\n        ans.push_back(T[0]);\n        for (int j = 1; j < K; j++){\n          if (T[j].first == T[j - 1].first){\n            ans.back().second += T[j].second;\n          } else {\n            ans.push_back(T[j]);\n          }\n        }\n        int m = ans.size();\n        for (int j = 0; j < m; j++){\n          cout << ans[j].first << ' ' << ans[j].second << ' ';\n        }\n        cout << '$' << endl;\n        ok = true;\n        break;\n      }\n    }\n  }\n  if (!ok){\n    for (int i = 0; i < N; i++){\n      cout << A[i].first << ' ' << A[i].second << ' ';\n    }\n    cout << '$' << endl;\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\nusing namespace std;\n \n#define REP(i,n) for(int i=0; i<n; ++i)\n#define FOR(i,a,b) for(int i=a; i<=b; ++i)\n#define FORR(i,a,b) for (int i=a; i>=b; --i)\n \ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef vector<VI> VVI;\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> PL;\n\nifstream ifs(\"in.txt\");\n\nvoid inp(vector<pair<char, int> > &a){\n    while (1){\n        char c;\n        cin >> c;\n        if (c == '$') break;\n        int x;\n        cin >> x;\n        a.push_back(make_pair(c, x));\n    }\n}\n\nint main() {\n    vector<pair<char, int> > a, b, c, res, ans;\n    inp(a);\n    inp(b);\n    inp(c);\n    REP(i,(int)a.size() - (int)b.size() + 1){\n        bool f = true;\n        REP(j,b.size()){\n            if (a[i+j].first != b[j].first){\n                f = false;\n                break;\n            }\n            if (j == 0 || j == b.size()-1){\n                if (a[i+j].second < b[j].second){\n                    f = false;\n                    break;\n                }\n            }else{\n                if (a[i+j].second != b[j].second){\n                    f = false;\n                    break;\n                }\n            }\n        }\n        if (f){\n            REP(j,i) res.push_back(a[j]);\n            if (b.size() > 1){\n                a[i].second -= b[0].second;\n                res.push_back(a[i]);\n            }\n            REP(j,c.size()) res.push_back(c[j]);\n            a[i+b.size()-1].second -= b[b.size()-1].second;\n            res.push_back(a[i+b.size()-1]);\n            FOR(j,i+b.size(),a.size()-1) res.push_back(a[j]);\n            break;\n        }\n    }\n    if (res.empty()){\n        REP(i,a.size()){\n            printf(\"%c %d \", a[i].first, a[i].second);\n        }\n        printf(\"$\\n\");\n    }else{\n        REP(i,res.size()){\n            if (!ans.empty() && ans[ans.size()-1].first == res[i].first){\n                ans[ans.size()-1].second += res[i].second;\n            }else if (res[i].second > 0){\n                ans.push_back(res[i]);\n            }\n        }\n        REP(i,ans.size()){\n            printf(\"%c %d \", ans[i].first, ans[i].second);\n        }\n        printf(\"$\\n\");\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nsigned main() {\n  vector<char> ca;\n  vector<int> la;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      ca.emplace_back(c);\n      la.emplace_back(l);      \n    }\n  }\n\n  vector<char> cb;\n  vector<int> lb;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      cb.emplace_back(c);\n      lb.emplace_back(l);      \n    }\n  }\n\n  vector<char> cc;\n  vector<int> lc;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      cc.emplace_back(c);\n      lc.emplace_back(l);      \n    }\n  }\n\n  int a = ca.size(), b = cb.size(), c = cc.size();\n  vector<char> ansc;\n  vector<int> ansl;  \n  for ( int i = 0; i < a; i++ ) {\n    if ( ca[i] != cb[0] || la[i] < lb[0] ) continue;\n    if ( i+b > a ) continue;\n    if ( ca[i+b-1] != cb[b-1] ||la[i+b-1] < lb[b-1] ) continue;\n    bool flag = true;\n    for ( int j = 1; j < b-1; j++ ) {\n      if ( ca[i+j] != cb[j] ||la[i+j] != lb[j] ) {\n\tflag = false;\n\tbreak;\n      }\n    }\n\n    if ( flag ) {\n      for ( int j = 0; j < i; j++ ) {\n\t// cout << ca[j] << \" \" << la[j] << \" \";\n\tansc.emplace_back(ca[j]);\n\tansl.emplace_back(la[j]);\n      }\n      // cout << ca[i] << \" \" << la[i]-lb[0] << \" \";\n      if ( la[i]-lb[0] >= 1 ) {\n\tansc.emplace_back(ca[i]);\n\tansl.emplace_back(la[i]-lb[0]);\n      }\n      for ( int j = 0; j < c; j++ ) {\n\t// cout << cc[i] << \" \" << lc[j] << \" \";\n\tansc.emplace_back(cc[j]);\n\tansl.emplace_back(lc[j]);\n      }\n      // cout << ca[i+b-1] << \" \" << la[i+b-1]-lb[b-1] << \" \";\n      if ( b > 1 ) {\n\tif ( la[i+b-1]-lb[b-1] >= 1 ) {\n\t  ansc.emplace_back(ca[i+b-1]);\n\t  ansl.emplace_back(la[i+b-1]-lb[b-1]);\n\t}\n      }\n      for ( int j = i+b; j < a; j++ ) {\n\t// cout << ca[j] << \" \" << la[j] << \" \";\n\tansc.emplace_back(ca[j]);\n\tansl.emplace_back(la[j]);\t\n      }\n      break;      \n    }\n  }\n\n  if ( ansc.size() == 0 ) {\n    ansc = ca; ansl = la;    \n  }\n  \n  for ( int i = 0; i < (int)ansc.size(); i++ ) {\n    if ( ansl[i] == 0 ) continue;    \n    if ( i < (int)ansc.size()-1 ) {\n      if ( ansc[i] == ansc[i+1] ) {\n\tansl[i+1] += ansl[i];\t\n      } else {\n\tcout << ansc[i] << \" \" << ansl[i] << \" \";\t\n      }\n    } else {\n      cout << ansc[i] << \" \" << ansl[i] << \" \";\t\n    }\n  }\n  cout << '$' << endl;\n  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef pair<char,int> P;\n\nvector<P> A,B,C,ans;\nint a,b,c;\n\nvector<P> input(){\n  char ch;\n  int num;\n  vector<P> res;\n  while(1){\n    cin>>ch;\n    if(ch=='$')break;\n    cin>>num;\n    res.push_back(P(ch,num));\n  }\n  return res;\n}\n\nint main(){\n  A=input();a=A.size();\n  B=input();b=B.size();\n  C=input();c=C.size();  \n  for(int i=0;i+b-1<a;i++){\n    bool flg=true;\n    for(int j=0;j<b;j++){\n      if(A[i+j].first!=B[j].first)flg=false;\n      if(j==0||j+1==b){\n        if(A[i+j].second<B[j].second)flg=false;\n      }else{\n        if(A[i+j].second!=B[j].second)flg=false;\n      }\n    }\n    if(flg){\n      for(int k=0;k<i;k++)ans.push_back(A[k]);\n      if(b>1){\n        A[i].second-=B[0].second;\n        if(A[i].second>0)ans.push_back(A[i]);\n      }\n      for(int k=0;k<c;k++)ans.push_back(C[k]);\n      A[i+b-1].second-=B[b-1].second;\n      if(A[i+b-1].second>0)ans.push_back(A[i+b-1]);\n      for(int k=i+b;k<a;k++)ans.push_back(A[k]);\n      break;\n    }\n  }\n  if(ans.empty()){\n    for(int i=0;i<a;i++){\n      cout<<A[i].first<<' '<<A[i].second<<endl;\n    }\n  }else{\n    for(int i=0;i<(int)ans.size();i++){\n      if(i+1<(int)ans.size() && ans[i].first==ans[i+1].first){\n        ans[i+1].second+=ans[i].second;\n      }else{\n        cout<<ans[i].first<<' '<<ans[i].second<<' ';\n      }\n    }\n    cout<<'$'<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\nusing Pi = pair<int, int>;\nusing Pl = pair<ll, ll>;\nusing Ti = tuple<int, int, int>;\nusing Tl = tuple<ll, ll, ll>;\n\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define F first\n#define S second\n#define Get(t, i) get<(i)>((t))\n#define all(v) (v).begin(), (v).end()\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define reps(i, f, n) for(int i = (int)(f); i < (int)(n); i++)\n#define each(a, b) for(auto& a : b)\n\nconst int inf = 1 << 25;\nconst ll INF = 1LL << 55;\n\nusing P = pair<char, int>;\n\nvoid input(vector<P>& v)\n{\n  char c; int l;\n  while(cin >> c, c != '$') {\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n}\n\nint main()\n{\n  vector<P> A; input(A);\n  vector<P> B; input(B);\n  vector<P> C; input(C);\n\n  rep(i, A.size()-B.size()+1) {\n    if(A[i].F == B[0].F && A[i].S >= B[i].S &&\n       A[i+B.size()-1].F == B[B.size()-1].F &&\n       A[i+B.size()-1].S >= B[B.size()-1].S) {\n      bool flag = true;\n      reps(j, 1, B.size()-1) {\n\tflag &= (A[i+j].F == B[j].F && A[i+j].S == B[j].S);\n      }\n      if(flag) {\n\tint Abofst = (A[i].S > B[0].S);\n\tint Aeofst = (A[i+B.size()-1].S > B[B.size()-1].S);\n\tif(Abofst) A[i].S -= B[0].S;\n\tif(Aeofst) A[i+B.size()-1].S -= B[B.size()-1].S;\n\tint Cbofst = (A[i-!Abofst].F == C[0].F);\n\tint Ceofst = (A[i+B.size()-1+!Aeofst].F == C[C.size()-1].F);\n\tif(Cbofst) A[i-!Abofst].S += C[0].S;\n\tif(Ceofst) A[i+B.size()-1+!Aeofst].S += C[C.size()-1].S;\n\tA.erase(A.begin()+i+Abofst, A.begin()+B.size()-Aeofst);\n\tvector<P> D;\n\treps(j, Cbofst, C.size()-Ceofst) D.push_back(C[j]);\n\tA.insert(A.begin()+i+Abofst, D.begin(), D.end());\n\trep(j, A.size()) {\n\t  if(j + 1 < A.size() && A[j].F == A[j+1].F) {\n\t    cout << A[j].F << \" \" << A[j].S+A[j].S-C[0].S << \" \";\n\t    j++;\n\t  } else {\n\t    cout << A[j].F << \" \" << A[j].S << \" \";\n\t  }\n\t}\n\tcout << \"$\" << endl;\n\treturn 0;\n      }\n    }\n  }\n  rep(i, A.size()) {\n    cout << A[j].F << \" \" << A[j].S << \" \";\n  }\n  cout << \"$\" << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nsigned main() {\n  vector<char> ca;\n  vector<int> la;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      ca.emplace_back(c);\n      la.emplace_back(l);      \n    }\n  }\n\n  vector<char> cb;\n  vector<int> lb;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      cb.emplace_back(c);\n      lb.emplace_back(l);      \n    }\n  }\n\n  vector<char> cc;\n  vector<int> lc;\n  {\n    char c;\n    while ( cin >> c, c != '$' ) {\n      int l;\n      cin >> l;\n      cc.emplace_back(c);\n      lc.emplace_back(l);      \n    }\n  }\n\n  int a = ca.size(), b = cb.size(), c = cc.size();\n  vector<char> ansc;\n  vector<int> ansl;  \n  for ( int i = 0; i < a; i++ ) {\n    if ( ca[i] != cb[0] || la[i] < lb[0] ) continue;\n    if ( i+b > a ) continue;\n    if ( ca[i+b-1] != cb[b-1] ||la[i+b-1] < lb[b-1] ) continue;\n    bool flag = true;\n    for ( int j = 1; j < b-1; j++ ) {\n      if ( ca[i+j] != cb[j] ||la[i+j] != lb[j] ) {\n\tflag = false;\n\tbreak;\n      }\n    }\n\n    if ( flag ) {\n      for ( int j = 0; j < i; j++ ) {\n\t// cout << ca[j] << \" \" << la[j] << \" \";\n\tansc.emplace_back(ca[j]);\n\tansl.emplace_back(la[j]);\n      }\n      // cout << ca[i] << \" \" << la[i]-lb[0] << \" \";\n      ansc.emplace_back(ca[i]);\n      ansl.emplace_back(la[i]-lb[0]);      \n      for ( int j = 0; j < c; j++ ) {\n\t// cout << cc[i] << \" \" << lc[j] << \" \";\n\tansc.emplace_back(cc[j]);\n\tansl.emplace_back(lc[j]);\n      }\n      // cout << ca[i+b-1] << \" \" << la[i+b-1]-lb[b-1] << \" \";\n      if ( b > 1 ) {\t\n\tansc.emplace_back(ca[i+b-1]);\n\tansl.emplace_back(la[i+b-1]-lb[b-1]);\t\n      }\n      for ( int j = i+b; j < a; j++ ) {\n\t// cout << ca[j] << \" \" << la[j] << \" \";\n\tansc.emplace_back(ca[j]);\n\tansl.emplace_back(la[j]);\t\n      }\n      break;      \n    }\n  }\n\n  if ( ansc.size() == 0 ) {\n    ansc = ca; ansl = la;    \n  }\n  \n  for ( int i = 0; i < ansc.size(); i++ ) {\n    if ( ansl[i] == 0 ) continue;    \n    if ( i < ansc.size()-1 ) {\n      if ( ansc[i] == ansc[i+1] ) {\n\tansl[i+1] += ansl[i];\t\n      } else {\n\tcout << ansc[i] << \" \" << ansl[i] << \" \";\t\n      }\n    } else {\n      cout << ansc[i] << \" \" << ansl[i] << \" \";\t\n    }\n  }\n  cout << '$' << endl;\n  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define fi first\n#define se second\nusing namespace std;\ntypedef pair<string,int> P;\nvector<P>v1,v2,v3;\nint x;\nstring s;\nmain(){\n  while(cin>>s,s!=\"$\")cin>>x,v1.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v2.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v3.push_back(P(s,x));\n  r(i,v1.size())if(v1[i].fi==v2[0].fi&&v1[i].se>=v2[0].se){\n    int flag=0,jj=0;\n    r(j,v2.size()-2){\n      jj=j+1;\n      if(i+jj>=v1.size()){flag++;break;}\n      if(v2[jj].se!=v1[i+jj].se||v2[jj].fi!=v1[i+jj].fi)flag++;\n    }\n    if(v2.size()!=1){\n      jj++;\n      if(!flag&&v2[jj].fi==v1[i+jj].fi&&v2[jj].se<=v1[i+jj].se){\n        v1[i].se-=v2[0].se;\n        r(j,v2.size()-2)v1.erase(v1.begin()+i+1);\n        v1[i+1].se-=v2[v2.size()-1].se;\n        r(j,v3.size())v1.insert(v1.begin()+i+1,v3[j]);\n      }\n    }\n    else{\n      v1[i].se-=v2[0].se;\n      r(j,v3.size())v1.insert(v1.begin()+i+1,v3[j]);\n    }\n    r(j,v1.size())if(v1[j].se==0)v1.erase(v1.begin()+i);\n    r(j,v1.size()-1)if(v1[j].fi==v1[j+1].fi)\n      v1[j].se+=v1[j+1].se,v1.erase(v1.begin()+j+1),j--;\n  }\n  r(k,v1.size())cout<<v1[k].fi<<' '<<v1[k].se<<' ';\n  cout<<'$'<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing P=pair<char,int>;\n\nint main(){\n    vector<P> A,B,C;\n    char c;\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        A.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        B.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        C.emplace_back(c,l);\n    }\n    vector<P> ans;\n    for(int i=0;i<A.size();i++){\n        if(A[i].first==B.front().first&&A[i].second>=B.front().second){\n            bool flag=true;\n            if(i+B.size()<=A.size()){\n                for(int d=1;d<B.size();d++){\n                    if(A[i+d].first!=B[d].first){\n                        flag=false;\n                        break;\n                    }\n                    if(d!=B.size()-1){\n                        if(A[i+d].second!=B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }else{\n                        if(A[i+d].second<B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }\n                }\n            }else{\n                continue;\n            }\n            if(flag){\n                if(B.size()==1){\n                    for(int j=0;j<i;j++) ans.push_back(A[i]);\n                    for(auto p:C) ans.push_back(p);\n                    if(A[i].second>B[0].second){\n                        ans.emplace_back(B[0].first,A[i].second-B[0].second);\n                    }\n                    for(int j=i+1;j<A.size();j++) ans.push_back(A[j]);\n                }else{\n                    if(A[i].second>B[0].second){\n                        ans.emplace_back(B[0].first,A[i].second-B[0].second);\n                    }\n                    for(auto p:C) ans.push_back(p);\n                    if(A[i+B.size()-1].second>B.back().second){\n                        ans.emplace_back(B.back().first, A[i+B.size()-1].second-B.back().second);\n                    }\n                    for(int j=i+B.size();j<A.size();j++) ans.push_back(A[j]);\n                }\n\n                for(int j=ans.size()-2;j>=0;j--){\n                    if(ans[j].first==ans[j+1].first){\n                        ans[j].second+=ans[j+1].second;\n                        ans[j+1].second=0;\n                    }\n                }\n                for(auto p:ans){\n                    char c; int l;\n                    tie(c,l)=p;\n                    if(l) cout<<c<<' '<<l<<' ';\n                }\n                cout<<'$'<<endl;\n                /*\n                {\n                    bool b=true;\n                    for(int i=0;i<A.size();i++){\n                        if(A[i]!=B[i]){\n                            cout<<i<<' '<<A[i].first<<' '<<A[i].second<<' '<<B[i].first<<' '<<B[i].second<<endl;\n                        }\n                    }\n                    cout<<b<<endl;\n                }*/\n                \n                // cout<<A.size()<<endl;\n                // cout<<B.size()<<endl;\n                // cout<<C.size()<<endl;\n                // cout<<ans.size()<<endl;\n                 \n                return 0;\n            }\n        }   \n    }\n    for(auto p:A){\n        char c; int l;\n        tie(c,l)=p;\n        cout<<c<<' '<<l<<' ';\n    }\n    cout<<'$'<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<deque>\n#include<queue>\n#include<vector>\n#include<algorithm>\n#include<iostream>\n#include<set>\n#include<cmath>\n#include<tuple>\n#include<string>\n#include<chrono>\n#include<functional>\n#include<iterator>\n#include<random>\n#include<unordered_set>\n#include<array>\n#include<map>\n#include<iomanip>\n#include<assert.h>\n#include<bitset>\n#include<stack>\n#include<memory>\nusing namespace std;\nusing namespace std::chrono;\ntypedef long long int llint;\ntypedef double lldo;\n#define mp make_pair\n#define mt make_tuple\n#define pub push_back\n#define puf push_front\n#define pob pop_back\n#define pof pop_front\n#define fir first\n#define sec second\n#define res resize\n#define ins insert\n#define era erase\n/*cout<<fixed<<setprecision(20);cin.tie(0);ios::sync_with_stdio(false);*/\nconst llint mod=998244353;\nconst llint big=2.19e15+1;\nconst long double pai=3.141592653589793238462643383279502884197;\nconst long double eps=1e-15;\ntemplate <class T,class U>bool mineq(T& a,U b){if(a>b){a=b;return true;}return false;}\ntemplate <class T,class U>bool maxeq(T& a,U b){if(a<b){a=b;return true;}return false;}\nllint gcd(llint a,llint b){if(a%b==0){return b;}else return gcd(b,a%b);}\nllint lcm(llint a,llint b){if(a==0){return b;}return a/gcd(a,b)*b;}\ntemplate<class T> void SO(T& ve){sort(ve.begin(),ve.end());}\ntemplate<class T> void REV(T& ve){reverse(ve.begin(),ve.end());}\ntemplate<class T>llint LBI(vector<T>&ar,T in){return lower_bound(ar.begin(),ar.end(),in)-ar.begin();}\ntemplate<class T>llint UBI(vector<T>&ar,T in){return upper_bound(ar.begin(),ar.end(),in)-ar.begin();}\nint main(void){\n\tvector<pair<char,int>>A,B,C,D;\n\tint i,j;\n\twhile(-1){\n\t\tchar c;cin>>c;\n\t\tif(c=='$'){break;}\n\t\tint x;cin>>x;\n\t\tA.pub(mp(c,x));\n\t}\n\twhile(-1){\n\t\tchar c;cin>>c;\n\t\tif(c=='$'){break;}\n\t\tint x;cin>>x;\n\t\tB.pub(mp(c,x));\n\t}\n\twhile(-1){\n\t\tchar c;cin>>c;\n\t\tif(c=='$'){break;}\n\t\tint x;cin>>x;\n\t\tC.pub(mp(c,x));\n\t}\n\tint n=A.size(),m=B.size();\n\tfor(i=0;i+m<=n;i++){\n\t\t//スタート\n\t\tbool ok=true;\n\t\tif(A[i].fir!=B[0].fir){continue;}\n\t\tif(A[i].sec<B[0].sec){continue;}\n\t\tfor(j=1;j+1<m;j++){\n\t\t\tif(A[i+j]!=B[j]){ok=false;}\n\t\t}\n\t\tif(!ok){continue;}\n\t\tif(A[i+m-1].fir!=B[m-1].fir){continue;}\n\t\tif(A[i+m-1].sec<B[m-1].sec){continue;}\n\t\t\n\t\tA[i].sec-=B[0].sec;\n\t\tif(m==1){i--;}\n\t\tfor(j=1;j<m-1;j++){A.erase(A.begin()+i+1);}\n\t\tif(m>1){A[i+1].sec-=B[m-1].sec;}\n\t\tfor(j=C.size()-1;j>=0;j--){A.insert(A.begin()+i+1,C[j]);}\n\t\tbreak;\n\t}\n\tfor(auto it:A){\n\t\tif(it.sec==0){continue;}\n\t\tif(D.size()==0||D.back().fir!=it.fir){D.pub(it);}\n\t\telse{D.back().sec+=it.sec;}\n\t}\n\tfor(auto it:D){cout<<it.fir<<\" \"<<it.sec<<\" \";}\n\tcout<<\"$\"<<endl;\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing P=pair<char,int>;\n\nint main(){\n    vector<P> A,B,C;\n    char c;\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        A.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        B.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        C.emplace_back(c,l);\n    }\n    vector<P> ans;\n    for(int i=0;i<A.size();i++){\n        if(A[i].first==B.front().first&&A[i].second>=B.front().second){\n            bool flag=true;\n            if(i+B.size()<=A.size()){\n                for(int d=1;d<B.size();d++){\n                    if(A[i+d].first!=B[d].first){\n                        flag=false;\n                        break;\n                    }\n                    if(d!=B.size()-1){\n                        if(A[i+d].second!=B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }else{\n                        if(A[i+d].second<B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }\n                }\n            }else{\n                continue;\n            }\n            if(flag){\n                for(int j=0;j<i;j++){\n                    ans.push_back(A[j]);\n                }\n                if(B.size()>=2&&A[i].second!=B[0].second){\n                    ans.emplace_back(A[i].first,A[i].second-B[0].second);\n                }\n                for(int j=0;j<C.size();j++){\n                    if(j==0&&!ans.empty()&&ans.back().first==C.front().first){\n                        ans.back().second+=C.front().second;\n                    }else{\n                        ans.push_back(C[j]);\n                    }\n                }\n\n                if(A[i+B.size()-1].second!=B.back().second){\n                    if(ans.back().first==B.back().first){\n                        ans.back().second+=A[i+B.size()-1].second-B.back().second;\n                    }else{\n                        ans.emplace_back(B.back().first, A[i+B.size()-1].second-B.back().second);\n                    }\n                }\n                for(int j=i+B.size();j<A.size();j++){\n                    ans.push_back(A[j]);\n                }\n                for(auto p:ans){\n                    char c; int l;\n                    tie(c,l)=p;\n                    cout<<c<<' '<<l<<' ';\n                }\n                cout<<'$'<<endl;\n                /*\n                {\n                    bool b=true;\n                    for(int i=0;i<A.size();i++){\n                        if(A[i]!=B[i]){\n                            cout<<i<<' '<<A[i].first<<' '<<A[i].second<<' '<<B[i].first<<' '<<B[i].second<<endl;\n                        }\n                    }\n                    cout<<b<<endl;\n                }*/\n                \n                // cout<<A.size()<<endl;\n                // cout<<B.size()<<endl;\n                // cout<<C.size()<<endl;\n                // cout<<ans.size()<<endl;\n                 \n                return 0;\n            }\n        }   \n    }\n    for(auto p:A){\n        char c; int l;\n        tie(c,l)=p;\n        cout<<c<<' '<<l<<' ';\n    }\n    cout<<'$'<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <tuple>\nusing namespace std;\nusing P=pair<char,int>;\n\nint main(){\n    vector<P> A,B,C;\n    char c;\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        A.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        B.emplace_back(c,l);\n    }\n    while(cin>>c, c!='$'){\n        int l;\n        cin>>l;\n        C.emplace_back(c,l);\n    }\n    vector<P> ans;\n    for(int i=0;i<A.size();i++){\n        if(A[i].first==B.front().first&&A[i].second>=B.front().second){\n            bool flag=true;\n            if(i+B.size()<=A.size()){\n                for(int d=1;d<B.size();d++){\n                    if(A[i+d].first!=B[d].first){\n                        flag=false;\n                        break;\n                    }\n                    if(d==B.size()-2){\n                        if(A[i+d].second!=B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }else{\n                        if(A[i+d].second<B[d].second){\n                            flag=false;\n                            break;\n                        }\n                    }\n                }\n            }else{\n                continue;\n            }\n            if(flag){\n                for(int j=0;j<i;j++){\n                    ans.push_back(A[j]);\n                }\n                if(A[i].second!=B[0].second){\n                    ans.emplace_back(A[i].first,A[i].second-B[0].second);\n                }\n                for(int j=0;j<C.size();j++){\n                    if(j==0&&!ans.empty()&&ans.back().first==C.front().first){\n                        ans.back().second+=C.front().second;\n                    }else{\n                        ans.push_back(C[j]);\n                    }\n                }\n\n                if(A[i+B.size()-1].second!=B.back().second){\n                    if(ans.back().first==B.back().first){\n                        ans.back().second+=A[i+B.size()-1].second-B.back().second;\n                    }else{\n                        ans.emplace_back(B.back().first, A[i+B.size()-1].second-B.back().second);\n                    }\n                }\n                for(int j=i+B.size();j<A.size();j++){\n                    ans.push_back(A[j]);\n                }\n                for(auto p:ans){\n                    char c; int l;\n                    tie(c,l)=p;\n                    cout<<c<<' '<<l<<' ';\n                }\n                cout<<'$'<<endl;\n                return 0;\n            }\n        }   \n    }\n    for(auto p:A){\n        char c; int l;\n        tie(c,l)=p;\n        cout<<c<<' '<<l<<' ';\n    }\n    cout<<'$'<<endl;\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i = 0; i < n; i++)\nusing namespace std;\ntypedef pair<char,int> P;\n\nchar c[3][1000];\nint l[3][1000];\nint si[3];\nvector<P> ans;\n\nint main(){\n\trep(i,3){\n\t\tfor(int j = 0;;j++){\n\t\t\tcin >> c[i][j];\n\t\t\tif(c[i][j] == '$'){\n\t\t\t\tsi[i] = j;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcin >> l[i][j];\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tif(si[0]-i < si[1]) break;\n\t\tif(c[0][i] == c[1][0] && l[0][i] >= l[1][0]){\n\t\t\tbool ok = true;\n\t\t\tfor(int j = 1; j < si[1]-1; j++){\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] != l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!ok) continue;\n\t\t\t{\n\t\t\t\tint j = si[1]-1;\n\t\t\t\tif(c[0][i+j] != c[1][j] || l[0][i+j] < l[1][j]){\n\t\t\t\t\tok = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(!ok) continue;\n\t\t\t\tl[0][i] -= l[1][0];\n\t\t\t\tl[0][i+j] -= l[1][j];\n\t\t\t}\n\t\t\trep(j,i+1) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\trep(j,si[2]) ans.push_back(P(c[2][j],l[2][j]));\n\t\t\tfor(int j = i+si[1]-1; j < si[0]; j++) if(l[0][j] != 0) ans.push_back(P(c[0][j],l[0][j]));\n\t\t\tfor(int j = ans.size()-1; j >= 1; j--){\n\t\t\t\tif(ans[j].first == ans[j-1].first){\n\t\t\t\t\tans[j-1].second += ans[j].second;\n\t\t\t\t\tans[j].second = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\trep(j,ans.size()){\n\t\t\t\tif(ans[j].second == 0) continue;\n\t\t\t\tprintf(\"%c %d \",ans[j].first,ans[j].second);\n\t\t\t}\n\t\t\tputs(\"$\");\n\t\t\treturn 0;\n\t\t}\n\t}\n\trep(i,si[0]){\n\t\tprintf(\"%c %d \",c[0][i],l[0][i]);\n\t}\n\tputs(\"$\");\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef long long ll;\ntypedef long double ld;\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-12;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\ntypedef pair<char, int> pci;\n\nint main()\n{\n\tvector<pci> a, b, c;\n\tchar let; int n;\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\ta.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tb.emplace_back(let, n);\n\t}\n\twhile (cin >> let&&let != '$')\n\t{\n\t\tcin >> n;\n\t\tc.emplace_back(let, n);\n\t}\n\tvector<pci> res;\n\t\n\tREP(i, (int)a.size() - (int)b.size() + 1)\n\t{\n\t\tif (a[i].first == b[0].first&&a[i].second >= b[0].second)\n\t\t{\n\t\t\tbool f = true;\n\t\t\tint j;\n\t\t\tfor (j = 1; j < b.size(); j++)\n\t\t\t{\n\t\t\t\tif (j == b.size() - 1)\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second >= a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (b[j].first != a[i + j].first || b[j].second != a[i + j].second) f = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (f)\n\t\t\t{\n\n\t\t\t\tREP(k, i) res.emplace_back(a[k]);\n\t\t\t\tif (a[i].second > b[0].second) res.emplace_back(a[i].first, a[i].second - b[i].second);\n\t\t\t\tREP(k, c.size()) res.emplace_back(c[k]);\n\t\t\t\tif (b.size()>1 && a[i + b.size() - 1].second > b.back().second) res.emplace_back(b.back().first, a[i + b.size() - 1].second - b.back().second);\n\t\t\t\tFOR(k, i + b.size(), a.size()) res.emplace_back(a[k]);\n\t\t\t\ti = INF;\n\t\t\t}\n\t\t}\n\t}\n\tvector<pci> ans;\n\tif (res.size() == 0) ans = a;\n\telse\n\t{\n\t\tans.emplace_back(res[0]);\n\t\tFOR(i, 1, res.size())\n\t\t{\n\t\t\tif (res[i].first == ans.back().first) ans.back().second += res[i].second;\n\t\t\telse ans.emplace_back(res[i]);\n\t\t}\n\t}\n\tREP(i, ans.size()) cout << ans[i].first << \" \" << ans[i].second << (i == ans.size() - 1 ? \" $\\n\" : \" \");\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define fi first\n#define se second\nusing namespace std;\ntypedef pair<string,int> P;\nvector<P>v1,v2,v3;\nint x;\nstring s;\nmain(){\n  while(cin>>s,s!=\"$\")cin>>x,v1.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v2.push_back(P(s,x));\n  while(cin>>s,s!=\"$\")cin>>x,v3.push_back(P(s,x));\n  r(i,v1.size())if(v1[i].fi==v2[0].fi&&v1[i].se>=v2[0].se){\n    int flag=0,jj=0,ff=0;\n    r(j,(int)v2.size()-2){\n      jj=j+1;\n      if(i+jj>=v1.size()){flag++;break;}\n      if(v2[jj].se!=v1[i+jj].se||v2[jj].fi!=v1[i+jj].fi)flag++;\n    }jj++;\n    if((v2[v2.size()-1].fi!=v1[i+jj].fi||v2[v2.size()-1].se>v1[i+jj].se))flag++;\n    if(v2.size()!=1){\n      if(!flag&&v2[jj].fi==v1[i+jj].fi&&v2[jj].se<=v1[i+jj].se){\n        v1[i].se-=v2[0].se;\n        r(j,v2.size()-2)v1.erase(v1.begin()+i+1);\n        v1[i+1].se-=v2[v2.size()-1].se;\n        r(j,v3.size())v1.insert(v1.begin()+i+1,v3[(int)v3.size()-1-j]);\n      }\n      if(flag)goto L;\n      ff++;\n    }\n    else{\n      if(flag)goto L;\n      v1[i].se-=v2[0].se;\n      r(j,v3.size())v1.insert(v1.begin()+i,v3[(int)v3.size()-1-j]);\n      ff++;\n    }\n    r(j,v1.size())if(v1[j].se==0)v1.erase(v1.begin()+j);\n    r(j,(int)v1.size()-1)if(v1[j].fi==v1[j+1].fi)\n      v1[j].se+=v1[j+1].se,v1.erase(v1.begin()+j+1),j--;\n    break;\n    L:;\n  }\n  r(k,v1.size())cout<<v1[k].fi<<' '<<v1[k].se<<' ';\n  cout<<'$'<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define F first\n#define S second\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define reps(i, f, n) for(int i = (int)(f); i < (int)(n); i++)\n\nconst int inf = 1 << 25;\n\ntypedef pair<char, int> P;\n\nvoid input(vector<P>& v)\n{\n  char c; int l;\n  while(cin >> c, c != '$') {\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n}\n\nint main()\n{\n  vector<P> A; input(A);\n  vector<P> B; input(B);\n  vector<P> C; input(C);\n\n  int a = A.size();\n  int b = B.size();\n  int c = C.size();\n\n  rep(i, A.size()-b+1) {\n    if(A[i].F == B[0].F && A[i].S >= B[0].S &&\n       A[i+b-1].F == B[b-1].F && A[i+b-1].S >= B[b-1].S) {\n      bool flag = true;\n      reps(j, 1, b-1) flag &= (A[i+j].F == B[j].F && A[i+j].S == B[j].S);\n      if(!flag) continue;\n      rep(j, b) A[i+j].S -= B[j].S;\n      if(b == 1) A.insert(begin(A)+i, begin(C), end(C));\n      else A.insert(begin(A)+i+1, begin(C), end(C));\n      break;\n    }\n  }\n\n  auto it = begin(A);\n  while(it != end(A)) {\n    if(it->S == 0) {\n      auto itr = it+1;\n      while(itr != end(A) && itr->S == 0) itr++;\n      it = A.erase(it, itr);\n    } else {\n      it++;\n    }\n  }\n  it = begin(A);\n  while(it != end(A)) {\n    auto itr = it+1;\n    while(itr != end(A) && it->F == itr->F) it->S += itr->S, itr++;\n    if(itr != it+1) it = A.erase(it+1, itr);\n    else it++;\n  }\n\n  rep(i, A.size()) cout << A[i].F << \" \" << A[i].S << \" \";\n  //rep(i, A.size()) cout << A[i].F << endl << A[i].S << endl;\n  cout << \"$\" << endl;\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\nusing Pi = pair<int, int>;\nusing Pl = pair<ll, ll>;\nusing Ti = tuple<int, int, int>;\nusing Tl = tuple<ll, ll, ll>;\n\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define F first\n#define S second\n#define Get(t, i) get<(i)>((t))\n#define all(v) (v).begin(), (v).end()\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define reps(i, f, n) for(int i = (int)(f); i < (int)(n); i++)\n#define each(a, b) for(auto& a : b)\n\nconst int inf = 1 << 25;\nconst ll INF = 1LL << 55;\n\nusing P = pair<char, int>;\n\nvoid input(vector<P>& v)\n{\n  char c; int l;\n  while(cin >> c, c != '$') {\n    cin >> l;\n    v.emplace_back(c, l);\n  }\n}\n\nint main()\n{\n  vector<P> A; input(A);\n  vector<P> B; input(B);\n  vector<P> C; input(C);\n\n  rep(i, A.size()-B.size()+1) {\n    if(A[i].F == B[0].F && A[i].S >= B[i].S &&\n       A[i+B.size()-1].F == B[B.size()-1].F &&\n       A[i+B.size()-1].S >= B[B.size()-1].S) {\n      bool flag = true;\n      reps(j, 1, B.size()-1) {\n\tflag &= (A[i+j].F == B[j].F && A[i+j].S == B[j].S);\n      }\n      if(flag) {\n\tint Abofst = (A[i].S > B[0].S);\n\tint Aeofst = (A[i+B.size()-1].S > B[B.size()-1].S);\n\tif(Abofst) A[i].S -= B[0].S;\n\tif(Aeofst) A[i+B.size()-1].S -= B[B.size()-1].S;\n\tint Cbofst = (A[i-!Abofst].F == C[0].F);\n\tint Ceofst = (A[i+B.size()-1+!Aeofst].F == C[C.size()-1].F);\n\tif(Cbofst) A[i-!Abofst].S += C[0].S;\n\tif(Ceofst) A[i+B.size()-1+!Aeofst].S += C[C.size()-1].S;\n\tA.erase(A.begin()+i+Abofst, A.begin()+B.size()-Aeofst);\n\tvector<P> D;\n\treps(j, Cbofst, C.size()-Ceofst) D.push_back(C[j]);\n\tA.insert(A.begin()+i+Abofst, D.begin(), D.end());\n\trep(j, A.size()) {\n\t  if(j + 1 < A.size() && A[j].F == A[j+1].F) {\n\t    cout << A[j].F << \" \" << A[j].S+A[j].S-C[0].S << \" \";\n\t    j++;\n\t  } else {\n\t    cout << A[j].F << \" \" << A[j].S << \" \";\n\t  }\n\t}\n\tcout << \"$\" << endl;\n\treturn 0;\n      }\n    }\n  }\n  rep(i, A.size()) {\n    cout << A[i].F << \" \" << A[i].S << \" \";\n  }\n  cout << \"$\" << endl;\n  return 0;\n}"
  },
  {
    "language": "Ruby",
    "code": "idx = nil\n(0..(rle.size-word.size)/2).each do |k|\n    catch(:break) do\n        i = 2 * k\n        throw(:break) unless rle[i] == word[0]\n        throw(:break) unless rle[i+1].to_i >= word[1].to_i\n        (2..word.size-2).each do |j|\n            throw(:break) unless rle[i+j] == word[j]\n        end\n        if rle[i+word.size-1].to_i >= word[-1].to_i\n            idx = k\n        end\n    end\n    break if idx\nend\n\nif !idx\n    puts rle * ' ' + \" $\"\n    exit\nend\n\na = (idx == 0 ? [] : rle[0..2*idx-1])\nb = alter\nb = [word[0], rle[2*idx+1].to_i - word[1].to_i] + b if rle[2*idx+1].to_i > word[1].to_i\nb += [word[-2], rle[2*idx+word.size-1].to_i - word[-1].to_i] if rle[2*idx+word.size-1].to_i > word[-1].to_i\nc = rle[2*idx+word.size..-1]\n\nx = a + b + c\ny = []\n\nx.each_slice(2) do |c, k|\n    k = k.to_i\n    if c == y[-2]\n        y[-1] += k\n    else\n        y += [c, k]\n    end\nend\n\nputs y * ' ' + \" $\""
  },
  {
    "language": "Ruby",
    "code": "rle = gets.split[0..-2]\nword = gets.split[0..-2]\nalter = gets.split[0..-2]\n\nidx = nil\n(0..(rle.size-word.size)/2).each do |k|\n    catch(:break) do\n        i = 2 * k\n        throw(:break) unless rle[i] == word[0]\n        throw(:break) unless rle[i+1].to_i >= word[1].to_i\n        (2..word.size-2).each do |j|\n            throw(:break) unless rle[i+j] == word[j]\n        end\n        if rle[i+word.size-1].to_i >= word[-1].to_i\n            idx = k\n        end\n    end\n    break if idx\nend\n\nif !idx\n    puts rle * ' ' + \" $\"\n    exit\nend\n\na = (idx == 0 ? [] : rle[0..2*idx-1])\nb = alter\nb = [word[0], rle[2*idx+1].to_i - word[1].to_i] + b if rle[2*idx+1].to_i > word[1].to_i && word.size > 2\nb += [word[-2], rle[2*idx+word.size-1].to_i - word[-1].to_i] if rle[2*idx+word.size-1].to_i > word[-1].to_i\nc = rle[2*idx+word.size..-1]\n\nx = a + b + c\ny = []\n\nx.each_slice(2) do |c, k|\n    k = k.to_i\n    if c == y[-2]\n        y[-1] += k\n    else\n        y += [c, k]\n    end\nend\n\nputs y * ' ' + \" $\""
  },
  {
    "language": "Ruby",
    "code": "rle = gets.split[0..-2]\nword = gets.split[0..-2]\nalter = gets.split[0..-2]\n\nidx = nil\n(0..(rle.size-word.size)/2).each do |k|\n    catch(:break) do\n        i = 2 * k\n        throw(:break) unless rle[i] == word[0]\n        throw(:break) unless rle[i+1].to_i >= word[1].to_i\n        (2..word.size-2).each do |j|\n            throw(:break) unless rle[i+j] == word[j]\n        end\n        if rle[i+word.size-1].to_i >= word[-1].to_i\n            idx = k\n        end\n    end\n    break if idx\nend\n\nif !idx\n    puts rle * ' ' + \" $\"\n    exit\nend\n\na = (idx == 0 ? [] : rle[0..2*idx-1])\nb = alter\nb = [word[0], rle[2*idx+1].to_i - word[1].to_i] + b if rle[2*idx+1].to_i > word[1].to_i\nb += [word[-2], rle[2*idx+word.size-1].to_i - word[-1].to_i] if rle[2*idx+word.size-1].to_i > word[-1].to_i\nc = rle[2*idx+word.size..-1]\n\nx = a + b + c\ny = []\n\nx.each_slice(2) do |c, k|\n    k = k.to_i\n    if c == y[-2]\n        y[-1] += k\n    else\n        y += [c, k]\n    end\nend\n\nputs y * ' ' + \" $\""
  },
  {
    "language": "Python",
    "code": "#!/usr/bin/python\n\nimport re\n\ndef clean(t):\n    res = re.sub(r'[A-Z]0', '', t)\n    res = re.sub(r'([A-Z])(\\d+)\\1(\\d+)', lambda m: m.group(1)+str(int(m.group(2))+int(m.group(3))), res)\n    res = re.sub(r'([A-Z])(\\d+)\\1(\\d+)', lambda m: m.group(1)+str(int(m.group(2))+int(m.group(3))), res)\n    res = re.sub(r'([A-Z])(\\d+)\\1(\\d+)', lambda m: m.group(1)+str(int(m.group(2))+int(m.group(3))), res)\n\n    res = re.sub(r'([A-Z])(\\d+)', r'\\1 \\2 ', res) + '$'\n\n    return res\n\ndef main():\n    A = raw_input()\n    B = raw_input()\n    C = raw_input()\n\n    dele = re.compile(r' |\\$')\n    a = dele.sub('', A)\n    b = dele.sub('', B)\n    c = dele.sub('', C)\n\n    num = re.findall(r'^\\w(\\d+)|(\\d+)$', b)\n\n    if len(num) == 1:\n        ch1 = b[0]\n        int1 = int(b[1:])\n        res = ''\n        repled = False\n        for s in re.findall(r'([A-Z])(\\d+)', a):\n            if s[0] != ch1 or repled:\n                res += s[0] + s[1]\n            elif int(s[1]) >= int1:\n                res += c + s[0] + str(int(s[1])-int1)\n                repled = True\n            else:\n                res += s[0] + s[1]\n\n        print clean(res)\n        return\n\n    L = int(num[0][0])\n    R = int(num[1][1])\n\n    b = re.sub(r'\\d+', r'(\\\\d+)', b, 1)\n    b = re.sub(r'\\d+$', r'(\\\\d+)', b)\n\n    #print 'str:', a\n    #print 're:', b\n    #print 'repl:', c\n\n    key = re.compile(b)\n    m = key.search(a)\n    while m is not None:\n        int1 = int(m.group(1))\n        int2 = int(m.group(2))\n        #print int1, int2\n        if L <= int1 and R <= int2:\n            print m.group()\n            ch1 = m.group()[0]\n            ch2 = re.search(r'([A-Z])\\d+$', m.group()).group(1)\n            a = a[:m.start()] + key.sub(ch1+str(int1-L)+c+ch2+str(int2-R), a[m.start():], 1)\n            break\n\n        m = key.search(a, pos=m.end())\n\n    print clean(a)\n\nif __name__ == '__main__':\n    main()"
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,random,time,copy,functools\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 10**9+7\ndd = [(-1,0),(0,1),(1,0),(0,-1)]\nddn = [(-1,0),(-1,1),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1)]\n\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\n\n\ndef main():\n    def inp():\n        s = LS()\n        a = []\n        for i in range(len(s)-1):\n            if i % 2 == 0:\n                a.append(s[i])\n            else:\n                a.append(int(s[i]))\n        return a\n\n    def com(a):\n        r = a[:2]\n        for i in range(2,len(a), 2):\n            if a[i] == r[-2]:\n                r[-1] += a[i+1]\n            else:\n                r += a[i:i+2]\n        return r\n\n    a = com(inp())\n    b = com(inp())\n    c = com(inp())\n\n    r = []\n    ff = True\n    if len(b) == 2:\n        b0 = b[0]\n        b1 = b[1]\n        for i in range(0,len(a),2):\n            if a[i] == b0:\n                while a[i+1] >= b1 and ff:\n                    r += c\n                    a[i+1] -= b1\n                    ff = False\n                if a[i+1] > 0:\n                    r += a[i:i+2]\n            else:\n                r += a[i:i+2]\n    else:\n        i = 0\n        al = len(a)\n        bl = len(b)\n        be = bl - 2\n        while i < al:\n            f = True\n            for j in range(0,bl,2):\n                ii = i + j\n                if al <= ii or a[ii] != b[j] or (a[ii+1] == b[j+1] if j in [0, be] else a[ii+1] < b[j+1]) or not ff:\n                    f = False\n                    break\n            if f:\n                for j in range(0,bl,2):\n                    ii = i + j\n                    a[ii+1] -= b[j+1]\n            if a[i+1] > 0:\n                r += a[i:i+2]\n            if f:\n                r += c\n                ff = False\n            i += 2\n\n    r += '$'\n\n\n    return ' '.join(map(str,com(r)))\n\n\n\n\nprint(main())\n\n"
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,random,time,copy,functools\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 10**9+7\ndd = [(-1,0),(0,1),(1,0),(0,-1)]\nddn = [(-1,0),(-1,1),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1)]\n\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\n\n\ndef main():\n    def inp():\n        s = LS()\n        a = []\n        for i in range(len(s)-1):\n            if i % 2 == 0:\n                a.append(s[i])\n            else:\n                a.append(int(s[i]))\n        return a\n\n    def com(a):\n        r = a[:2]\n        for i in range(2,len(a), 2):\n            if a[i] == r[-2]:\n                r[-1] += a[i+1]\n            else:\n                r += a[i:i+2]\n        return r\n\n    a = com(inp())\n    b = com(inp())\n    c = com(inp())\n\n    r = []\n    ff = True\n    if len(b) == 2:\n        b0 = b[0]\n        b1 = b[1]\n        for i in range(0,len(a),2):\n            if a[i] == b0:\n                while a[i+1] >= b1 and ff:\n                    r += c\n                    a[i+1] -= b1\n                    ff = False\n                if a[i+1] > 0:\n                    r += a[i:i+2]\n            else:\n                r += a[i:i+2]\n    else:\n        i = 0\n        al = len(a)\n        bl = len(b)\n        be = bl - 2\n        while i < al:\n            f = True\n            for j in range(0,bl,2):\n                ii = i + j\n                if al <= ii or a[ii] != b[j] or (a[ii+1] < b[j+1] if j in [0, be] else a[ii+1] != b[j+1]) or not ff:\n                    f = False\n                    break\n            if f:\n                for j in range(0,bl,2):\n                    ii = i + j\n                    a[ii+1] -= b[j+1]\n            if a[i+1] > 0:\n                r += a[i:i+2]\n            if f:\n                r += c\n                ff = False\n            i += 2\n\n    r += '$'\n\n\n    return ' '.join(map(str,com(r)))\n\n\n\n\nprint(main())\n\n"
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,random,time,copy,functools\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 10**9+7\ndd = [(-1,0),(0,1),(1,0),(0,-1)]\nddn = [(-1,0),(-1,1),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1)]\n\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\n\n\ndef main():\n    def inp():\n        s = LS()\n        a = []\n        for i in range(len(s)-1):\n            if i % 2 == 0:\n                a.append(s[i])\n            else:\n                a.append(int(s[i]))\n        return a\n\n    def com(a):\n        r = a[:2]\n        for i in range(2,len(a), 2):\n            if a[i] == r[-2]:\n                r[-1] += a[i+1]\n            else:\n                r += a[i:i+2]\n        return r\n\n    a = com(inp())\n    b = com(inp())\n    c = com(inp())\n\n    r = []\n    if len(b) == 2:\n        b0 = b[0]\n        b1 = b[1]\n        for i in range(0,len(a),2):\n            if a[i] == b0:\n                while a[i+1] >= b1:\n                    r += c\n                    a[i+1] -= b1\n                if a[i+1] > 0:\n                    r += a[i:i+2]\n            else:\n                r += a[i:i+2]\n    else:\n        i = 0\n        al = len(a)\n        bl = len(b)\n        be = bl - 2\n        while i < al:\n            f = True\n            for j in range(0,bl,2):\n                ii = i + j\n                if al <= ii or a[ii] != b[j] or (a[ii+1] == b[j+1] if j in [0, be] else a[ii+1] < b[j+1]):\n                    f = False\n                    break\n            if f:\n                for j in range(0,bl,2):\n                    ii = i + j\n                    a[ii+1] -= b[j+1]\n            if a[i+1] > 0:\n                r += a[i:i+2]\n            if f:\n                r += c\n            i += 2\n\n    r += '$'\n\n\n    return ' '.join(map(str,com(r)))\n\n\n\n\nprint(main())\n\n"
  },
  {
    "language": "Python",
    "code": "#!/usr/bin/python\n\nimport re\n\ndef clean(t):\n    res = re.sub(r'[A-Z]0', '', t)\n    res = re.sub(r'([A-Z])(\\d+)\\1(\\d+)', lambda m: m.group(1)+str(int(m.group(2))+int(m.group(3))), res)\n    res = re.sub(r'([A-Z])(\\d+)\\1(\\d+)', lambda m: m.group(1)+str(int(m.group(2))+int(m.group(3))), res)\n    res = re.sub(r'([A-Z])(\\d+)\\1(\\d+)', lambda m: m.group(1)+str(int(m.group(2))+int(m.group(3))), res)\n\n    res = re.sub(r'([A-Z])(\\d+)', r'\\1 \\2 ', res) + '$'\n\n    return res\n\ndef main():\n    A = raw_input()\n    B = raw_input()\n    C = raw_input()\n\n    dele = re.compile(r' |\\$')\n    a = dele.sub('', A)\n    b = dele.sub('', B)\n    c = dele.sub('', C)\n\n    num = re.findall(r'^\\w(\\d+)|(\\d+)$', b)\n\n    if len(num) == 1:\n        ch1 = b[0]\n        int1 = int(b[1:])\n        res = ''\n        repled = False\n        for s in re.findall(r'([A-Z])(\\d+)', a):\n            if s[0] != ch1 or repled:\n                res += s[0] + s[1]\n            elif int(s[1]) >= int1:\n                res += c + s[0] + str(int(s[1])-int1)\n                repled = True\n            else:\n                res += s[0] + s[1]\n\n        print clean(res)\n        return\n\n    L = int(num[0][0])\n    R = int(num[1][1])\n\n    b = re.sub(r'\\d+', r'(\\\\d+)', b, 1)\n    b = re.sub(r'\\d+$', r'(\\\\d+)', b)\n\n    #print 'str:', a\n    #print 're:', b\n    #print 'repl:', c\n\n    key = re.compile(b)\n    m = key.search(a)\n    while m is not None:\n        int1 = int(m.group(1))\n        int2 = int(m.group(2))\n        #print int1, int2\n        if L <= int1 and R <= int2:\n            ch1 = m.group()[0]\n            ch2 = re.search(r'([A-Z])\\d+$', m.group()).group(1)\n            a = a[:m.start()] + key.sub(ch1+str(int1-L)+c+ch2+str(int2-R), a[m.start():], 1)\n            break\n\n        m = key.search(a, pos=m.end())\n\n    print clean(a)\n\nif __name__ == '__main__':\n    main()"
  },
  {
    "language": "Python",
    "code": "#!/usr/bin/python\n\nimport re\n\ndef clean(t):\n    res = re.sub(r'[A-Z]0', '', t)\n    res = re.sub(r'([A-Z])(\\d+)\\1(\\d+)', lambda m: m.group(1)+str(int(m.group(2))+int(m.group(3))), res)\n    res = re.sub(r'([A-Z])(\\d+)\\1(\\d+)', lambda m: m.group(1)+str(int(m.group(2))+int(m.group(3))), res)\n    res = re.sub(r'([A-Z])(\\d+)\\1(\\d+)', lambda m: m.group(1)+str(int(m.group(2))+int(m.group(3))), res)\n\n    res = re.sub(r'([A-Z])(\\d+)', r'\\1 \\2 ', res) + '$'\n\n    return res\n\ndef main():\n    A = raw_input()\n    B = raw_input()\n    C = raw_input()\n\n    dele = re.compile(r' |\\$')\n    a = dele.sub('', A)\n    b = dele.sub('', B)\n    c = dele.sub('', C)\n\n    num = re.findall(r'^\\w(\\d+)|(\\d+)$', b)\n\n    if len(num) == 1:\n        ch1 = b[0]\n        int1 = int(b[1:])\n        res = ''\n        repled = False\n        for s in re.findall(r'([A-Z])(\\d+)', a):\n            if s[0] != ch1 or repled:\n                res += s[0] + s[1]\n            elif int(s[1]) >= int1:\n                res += c + s[0] + str(int(s[1])-int1)\n                repled = True\n            else:\n                res += s[0] + s[1]\n\n        print clean(res)\n        return\n\n    L = int(num[0][0])\n    R = int(num[1][1])\n\n    b = re.sub(r'\\d+', r'(\\\\d+)', b, 1)\n    b = re.sub(r'\\d+$', r'(\\\\d+)', b)\n\n    #print 'str:', a\n    #print 're:', b\n    #print 'repl:', c\n\n    key = re.compile(b)\n    m = key.search(a)\n    while m is not None and m.end() <= len(a):\n        int1 = int(m.group(1))\n        int2 = int(m.group(2))\n        if L <= int1 and R <= int2:\n            ch1 = m.group()[0]\n            ch2 = re.search(r'([A-Z])\\d+$', m.group()).group(1)\n            a = key.sub(ch1+str(int1-L)+c+ch2+str(int2-R), a, 1)\n            break\n\n        m = key.search(a, pos=m.end())\n\n    print clean(a)\n\nif __name__ == '__main__':\n    main()"
  }
]