Bitaro the Brave faces the Demon King. Bitaro wants to attack using magic, which is influenced by the placement of jewels, orbs, and ingots on a grid of H rows and W columns. Each cell in the grid contains either a Jewel (represented by 'J'), an Orb (represented by 'O'), or an Ingot (represented by 'I'). The power of the magic is determined by the following condition: there exists integers (i, j, k, l) such that cell (i, j) contains a Jewel, cell (i, l) contains an Orb, and cell (k, j) contains an Ingot. Create a program that calculates the magic power given the arrangement of jewels, orbs, and ingots on the grid.