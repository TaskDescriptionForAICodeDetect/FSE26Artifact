[
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<numeric>\nusing namespace std;\nint main(){\n    while(true){\n        int n,m,t,p;\n        cin>>n>>m>>t>>p;\n        if(n==0)break;\n        vector<int> d(t);\n        vector<int> c(t);\n        vector<vector<int> > origami(n*3,vector<int>(m*3,1));\n        int xpos=0;\n        int ypos=0;\n        for(int i=0;i<t;i++){\n            cin>>d[i]>>c[i];\n            if(d[i]==1){\n                for(int k=c[i]+xpos;k<c[i]*2+xpos;k++){\n                    for(int j=ypos;j<m;j++){\n                        origami[k][j]+=origami[k-(c[i])][j];\n                    }\n                }\n                xpos+=c[i];\n            }else{\n                for(int k=xpos;k<n;k++){\n                    for(int j=c[i]+ypos;j<c[i]*2+ypos;j++){\n                        origami[k][j]+=origami[k][j-c[i]];\n                    }\n                }\n                ypos+=c[i];\n            }\n            \n        }\n        vector<int> x(p);\n        vector<int> y(p);\n        int ans=0;\n        for(int i=0;i<p;i++){\n            cin>>x[i]>>y[i];\n            cout<<origami[x[i]+xpos][y[i]+ypos]<<endl;\n        }\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int AX = 1e3+66;\nint vis[AX][AX];\nint res[AX][AX];\nint main(){\n\tint n , m , t,  p;\n\twhile ( scanf(\"%d%d%d%d\",&n,&m,&t,&p) && n && m && t && p ){\n\t\tmemset( vis , 0 , sizeof(vis) );\n\t\tfor( int i = 0 ; i < m ; i++ ){\n\t\t\tfor( int j = 0 ; j < n ; j++ ){\n\t\t\t\tvis[i][j] = 1;\n\t\t\t}\n\t\t}\n\t\tint left = 0 ;\n\t\tint down = 0 ;\n\t\tint x , y ;  \n\t\tint op;\n\t\tfor( int i = 0 ;  i < t ;i ++ ){\n\t\t\t//cout << \"?? : \" << vis[3][4] << endl;\n\t\t\tscanf(\"%d%d\",&op,&x);\n\t\t\tif( op == 2 ){\n\t\t\t\tdown += x  ;\n\t\t\t\tint s = 0 ;\n\t\t\t\tm = max( m , down + x );\n\t\t\t\tfor( int k = down ; k < down + x ; k++ ){\n\t\t\t\t\ts ++;\n\t\t\t\t\tfor( int j = left ; j < n ; j++ ){\n\t\t\t\t\t\tvis[k][j] += vis[down-s][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tleft += x  ;\n\t\t\t\tint s = 0;\n\t\t\t\tn = max( n , left + x );\n\t\t\t\tfor( int j = left ; j < left + x ; j++ ){\n\t\t\t\t\ts ++;\n\t\t\t\t\tfor( int k = down ; k < m ; k++ ){\n\t\t\t\t\t\tvis[k][j] += vis[k][left-s];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor( int i = 0 ; i < p ; i++ ){\n\t\t\tscanf(\"%d%d\",&x,&y);\t\n\n\t\t\tprintf(\"%d\\n\",vis[y+down][x+left]);\n\t\t}\n\t}\n\treturn 0 ;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define For(i, a, b) for(int (i)=(int)(a); (i)<(int)(b); ++(i))\n#define rFor(i, a, b) for(int (i)=(int)(a)-1; (i)>=(int)(b); --(i))\n#define rep(i, n) For((i), 0, (n))\n#define rrep(i, n) rFor((i), (n), 0)\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long lint;\ntypedef unsigned long long ulint;\ntypedef pair<int, int> pii;\ntemplate<class T> bool chmax(T &a, const T &b){if(a<b){a=b; return true;} return false;}\ntemplate<class T> bool chmin(T &a, const T &b){if(a>b){a=b; return true;} return false;}\ntemplate<class T> T div_floor(T a, T b){\n    if(b < 0) a *= -1, b *= -1;\n    return a>=0 ? a/b : (a+1)/b-1;\n}\ntemplate<class T> T div_ceil(T a, T b){\n    if(b < 0) a *= -1, b *= -1;\n    return a>0 ? (a-1)/b+1 : a/b;\n}\n\nconstexpr lint mod = 1e9+7;\nconstexpr lint INF = mod * mod;\nconstexpr int MAX = 100010;\n\nusing arr = array<array<int, 32>, 32>;\n\narr fold1(arr &a, int c){\n    arr ret;\n    rep(i, 32)rep(j, 32) ret[i][j] = 0;\n    rep(i, 32)rep(j, c) ret[i][c-1-j] = a[i][j];\n    rep(i, 32)For(j, c, 32) ret[i][j-c] += a[i][j];\n    return ret;\n}\n\narr fold2(arr &a, int c){\n    arr ret;\n    rep(i, 32)rep(j, 32) ret[i][j] = 0;\n    rep(j, 32)rep(i, c) ret[c-1-i][j] = a[i][j];\n    rep(j, 32)For(i, c, 32) ret[i-c][j] += a[i][j];\n    return ret;\n}\n\nint main(){\n    int n, m, t, p, d, c, x, y;\n    while(scanf(\"%d%d%d%d\", &n, &m, &t, &p) && n){\n        arr a;\n        rep(i, 32)rep(j, 32) a[i][j] = 0;\n        rep(i, m)rep(j, n) a[i][j] = 1;\n        rep(_, t){\n            scanf(\"%d%d\", &d, &c);\n            a = (d == 1 ? fold1(a, c) : fold2(a, c));\n        }\n        rep(_, p){\n            scanf(\"%d%d\", &x, &y);\n            printf(\"%d\\n\", a[y][x]);\n        }\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h> \n\nusing namespace std;\nusing ll=long long;\nusing ull=unsigned long long;\nusing pii=pair<int,int>;\n\n#define INF LONG_MAX\n#define MOD 1000000007\n#define rng(a) a.begin(),a.end()\n#define rrng(a) a.end(),a.begin()\n\nint main(){\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n\n  while(true){\n    int n,m,t,p;\n    cin>>n>>m>>t>>p;\n    if(n==0&&m==0&&t==0&&p==0)return 0;\n    vector<int>d(t),c(t),x(p),y(p);\n    for(int i=0;i<t;i++)cin>>d[i]>>c[i];\n    for(int i=0;i<p;i++)cin>>x[i]>>y[i];\n    //n -, m |\n    vector<vector<int>>paper(n,vector<int>(m,1));\n    for(int i=0;i<t;i++){\n      /*\n      cout<<\"#----------------------\"<<endl;\n      for(int y=0;y<m;y++){\n        for(int x=0;x<n;x++){\n          cout<<paper[x][y]<<\" \";\n        }\n        cout<<endl;\n      }\n      cout<<\"#----------------------\"<<endl;\n      */\n      int C=c[i];\n      // |\n      if(d[i]==1){\n        vector<vector<int>>fold(C,vector<int>(m));\n        for(int i=0;i<C;i++){\n          for(int j=0;j<m;j++){\n            fold[i][j]=paper[i][j];\n          }\n        }\n\n        vector<vector<int>>copy=paper;\n        for(int i=0;i<n;i++){\n          for(int j=0;j<m;j++){\n            if(i+C<n)paper[i][j]=copy[i+C][j];\n            else paper[i][j]=0;\n          }\n        }\n\n        for(int i=0;i<C;i++){\n          for(int j=0;j<m;j++){\n            paper[i][j]+=fold[(C-1)-i][j];\n          }\n        }\n      }\n      // -\n      else if(d[i]==2){\n        vector<vector<int>>fold(n,vector<int>(C));\n        for(int i=0;i<n;i++){\n          for(int j=0;j<C;j++){\n            fold[i][j]=paper[i][j];\n          }\n        }\n\n        vector<vector<int>>copy=paper;\n        for(int i=0;i<n;i++){\n          for(int j=0;j<m;j++){\n            if(j+C<m)paper[i][j]=copy[i][j+C];\n            else paper[i][j]=0;\n          }\n        }\n\n        for(int i=0;i<n;i++){\n          for(int j=0;j<C;j++){\n            paper[i][j]+=fold[i][(C-1)-j];\n          }\n        }\n      }\n    }\n\n    /*\n    cout<<\"-----------------------\"<<endl;\n    for(int y=0;y<m;y++){\n      for(int x=0;x<n;x++){\n        cout<<paper[x][y]<<\" \";\n      }\n      cout<<endl;\n    }\n    cout<<\"-----------------------\"<<endl;\n    */\n\n    for(int i=0;i<p;i++){\n      int X=x[i];\n      int Y=y[i];\n      cout<<paper[X][Y]<<endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\nusing namespace std;\ntypedef long long ll;\n\nll n, m, t, p, d, c, x, y, data[32][32], cp[32][32];\n\nint main() {\n  while (scanf(\"%lld%lld%lld%lld\", &n, &m, &t, &p), n) {\n    for (ll i = 0; i < m; i++) for (ll j = 0; j < n; j++) data[i][j] = 1;\n    for (ll i = 0; i < t; i++) {\n      scanf(\"%lld%lld\", &d, &c);\n      for (ll i = 0; i < m; i++) for (ll j = 0; j < n; j++) cp[i][j] = data[i][j];\n      if (d == 1) {\n        for (ll i = 0; i < m; i++) for (ll j = 0; j < n; j++) {\n          data[i][j] = (c+j<n?cp[i][c+j]:0) + (c-j-1<0?0:cp[i][c-j-1]);\n        }\n      } else {\n        for (ll i = 0; i < m; i++) for (ll j = 0; j < n; j++) {\n          data[i][j] = (c+i<m?cp[c+i][j]:0) + (c-i-1<0?0:cp[c-i-1][j]);\n        }\n      }\n      /*\n      for (ll i = 0; i < m; i++) for (ll j = 0; j < n; j++) printf(\"%lld%c\", data[i][j], j==n-1?'\\n':' ');\n      printf(\"\\n\");\n      */\n    }\n    for (ll i = 0; i < p; i++) {\n      scanf(\"%lld%lld\", &x, &y);\n      printf(\"%lld\\n\", data[y][x]);\n    }\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\nint main(){\n    int n,m,t,p;\n    while(true){\n        cin>>n>>m>>t>>p;\n        int hnum=0,wnum=0;\n        long long int origami[500][500];\n        for(int i=0;i<500;i++){\n            for(int j=0;j<500;j++){\n                origami[i][j]=0;\n            }\n        }\n        for(int i=0;i<n;i++){\n            for(int j=0;j<m;j++){\n                origami[i][j]=1;\n            }\n        }\n        if(n==0)break;\n        for(int i=0;i<t;i++){\n            int d,c;\n            cin>>d>>c;\n            if(d==1){\n                for(int j=wnum+c;j<wnum+c*2;j++){\n                    for(int k=0;k<m*2;k++){\n                        origami[j][k]+=origami[c+wnum-(j-wnum-c)-1][k];\n                    }\n                }\n                wnum+=c;\n            }else{\n                for(int j=0;j<n*2;j++){\n                    for(int k=hnum+c;k<hnum+c*2;k++){\n                        origami[j][k]+=origami[j][c+hnum-(k-hnum-c)-1];\n                    }\n                }\n                hnum+=c;\n            }\n            /*\n            for(int j=0;j<m;j++){\n                for(int k =0;k<n+1;k++){\n                    cerr<<origami[k][j];\n                }\n                cerr<<endl;\n            }*/\n            \n        }\n        for(int i=0;i<p;i++){\n            int x,y;\n            cin>>x>>y;\n            cout<<origami[x+wnum][y+hnum]<<endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n \n#define MAX 500\n \nusing namespace std;\n\nint main(void){\n    while(1){\n        int kami[MAX][MAX]={0};\n\t\tint w, h, t, p;\n\t\tcin >> w >> h >> t >> p;\n        if(!w && !h && !t && !p) break;\n        for(int i=0; i<h; i++){\n\t\t\tfill(kami[i], kami[i]+w, 1);\n        }\n \n        int origin_x = 0, origin_y =0;\n        for(int k=0; k<t; k++){\n\t\t\tint d, c;\n\t\t\tcin >> d >> c;\n\t\t\t\n\t\t\tint dist = 1;\n            if(d == 1){\n\t\t\t\tfor(int j=origin_x+c; j<origin_x+(2*c); j++){\n                     for(int i=origin_y; i<MAX; i++){\n                        if(j-dist >= 0)kami[i][j] += kami[i][j-dist];\n\t                }\n\t\t            dist += 2;\n\t\t\t    }\n                origin_x += c;\n            } else{\n                for(int i=origin_y+c; i<origin_y+(2*c); i++){\n                    for(int j=origin_x; j<MAX; j++){\n                        if(i-dist >= 0)kami[i][j] += kami[i-dist][j];\n                    }\n                    dist += 2;\n                }\n                origin_y += c;\n            }\n        }\n         \n        for(int k=0; k<p; k++){\n\t\t\tint x, y;\n\t\t\tcin >> x >> y;\n\t\t\tcout << kami[origin_y+y][origin_x+x] << endl;\n        }\n    }\n \n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\n#define uint unsigned int\n#define pii pair<int, int>\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define FORR(i,a,b) for(int i=(a);i>=(b);--i)\n#define REP(i,n) FOR(i,0,n)\n#define REPR(i,n) FORR(i,n,0)\n#define ALL(c) ((c).begin(),(c).end())\n#define PB(a) push_back(a)\n#define EMPB(...) emplace_back(__VA_ARGS__)\n#define EMP(...) emplace(__VA_ARGS__)\n#define MP(a,b) make_pair(a,b)\n#define MT(...) make_tuple(__VA_ARGS__)\n#define ZERO(a) memset(a,0,sizeof(a))\n#define MINUS(a) memset(a,0xff,sizeof(a))\n#define MINF(a) memset(a,0x3f,sizeof(a))\n#define PW(n) (1LL<<(n))\nusing namespace std;\ntemplate <class T> inline bool CHMIN(T& a, T b) { if(a>b) { a=b; return 1; } return 0; }\ntemplate <class T> inline bool CHMAX(T& a, T b) { if(a<b) { a=b; return 1; } return 0; }\ntemplate <class T> inline void SORT(T& a) { sort(ALL(a)); }\ntemplate <class T> inline void REV(T& a) { reverse(ALL(a)); }\ntemplate <class T> inline void UNI(T& a) { SORT(a); a.erase(unique(ALL(a)),a.end()); }\ntemplate <class S, class T> ostream& operator<<(ostream& os, const pair<S,T> a) {\n  return os << a.first << ' ' << a.second;\n}\nconst int MOD = 1000000007;\nconst int INF = 0x3f3f3f3f3f3f3f3f;\nconst double EPS = 1e-10;\n/* ---------------------------------------------------------------------------------------------------- */\n\nint n,m,t,p;\nint pre[50][50];\nint nxt[50][50];\n\nvoid fold(int c, int& n, int& m) {\n  if (2*c <= n) {\n    for (int i = 0; c+i < n; ++i) {\n      REP(j,m) nxt[i][j] = pre[c+i][j];\n    }\n    for (int i = 0; c-1-i >= 0; ++i) {\n      REP(j,m) nxt[i][j] += pre[c-1-i][j];\n    }\n    n = n-c;\n  } else {\n    for (int i = 0; c-1-i >= 0; ++i) {\n      REP(j,m) nxt[i][j] = pre[c-1-i][j];\n    }\n    for (int i = 0; c+i < n; ++i) {\n      REP(j,m) nxt[i][j] += pre[c+i][j];\n    }\n    n = c;\n  }\n}\n\nvoid rotate(int d) {\n  int tmp[50][50];\n  if (d > 0) {\n    REP(i,m) REP(j,n) tmp[i][j] = pre[n-1-j][i];\n    REP(i,m) REP(j,n) pre[i][j] = tmp[i][j];\n  } else {\n    REP(i,n) REP(j,m) tmp[i][j] = pre[j][n-1-i];\n    REP(i,n) REP(j,m) pre[i][j] = tmp[i][j];\n  }\n}\n\nsigned main() {\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n  cout << fixed << setprecision(10);\n\n  while (cin >> n >> m >> t >> p, n) {\n    REP(i,n) REP(j,m) pre[i][j] = 1;\n    REP(_,t) {\n      ZERO(nxt);\n      int d,c;\n      cin >> d >> c;\n      if (d == 1) {\n        fold(c,n,m);\n        swap(pre,nxt);\n      } else {\n        rotate(1);\n        fold(c,m,n);\n        swap(pre,nxt);\n        rotate(-1);\n      }\n    }\n\n    REP(_,p) {\n      int x,y;\n      cin >> x >> y;\n      cout << pre[x][y] << endl;\n    }\n  }\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nint s[35][35];\n\nsigned main(){\n  \n  while(1){\n    \n    int w, h, t, p;\n    cin>>w>>h>>t>>p;\n    \n    if( !w && !h && !t && !p ) break;\n    \n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++) s[i][j] = 1;\n    }\n    \n    while(t--){\n      \n      int d, c;\n      cin>>d>>c;\n      \n      int t[35][35] = {};\n                  \n      if( d == 1 ){\n\t\n\tfor(int i=0;i<h;i++){\n\t  \n\t  for(int j=0;j<c;j++){\n\t    \n\t    t[i][j] = s[i][c-j-1];\n\t    \n\t  }\n\t  \n\t}\n\t\n\tfor(int i=0;i<h;i++){\n\t  \n\t  for(int j=c;j<w;j++){\n\t    \n\t    t[i][j-c] += s[i][j];\n\t    \n\t  }\n\t  \n\t}\n\t\n\tw = max( c, w - c );\n\t\n\tfor(int i=0;i<h;i++){\n\t  for(int j=0;j<w;j++) s[i][j] = t[i][j];\n\t}\n\t\n      }\n      else{\n\t\n\tfor(int i=0;i<c;i++){\n\t  \n\t  for(int j=0;j<w;j++){\n\t    \n\t    t[i][j] = s[c-i-1][j];\n\t    \n\t  }\n\t  \n\t}\n\t\n\tfor(int i=c;i<h;i++){\n\t  \n\t  for(int j=0;j<w;j++){\n\t    \n\t    t[i-c][j] += s[i][j];\n\t    \n\t  }\n\t  \n\t}\n\t\n\th = max( c, h - c );\n\t\n\tfor(int i=0;i<h;i++){\n\t  for(int j=0;j<w;j++) s[i][j] = t[i][j];\n\t}\n\t\n      }      \n      \n    }\n    \n    while(p--){\n      \n      int x, y;\n      cin>>x>>y;\n      \n      cout<<s[y][x]<<endl;\n      \n    }\n    \n  }\n  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MA_DEFINES\n#include <bits/stdc++.h>\n#define int long long\n#define rep(i,n) for(int i=0;i<n;i++)\n#define Rep(i,a,b) for(int i=a;i<b;i++)\n#define REP(i,a,b) for(int i=a;i<=b;i++)\n#define rev(i,n) for(int i=n-1;i>=0;i--)\n#define vi vector<int>\n#define vvi vector<vi>\n#define pb push_back\n#define pi pair<int,int>\n#define vp vector<pair<int,int>>\n#define mp make_pair\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\n#define MEMSET(a) memset(a,0,sizeof(a))\n#define inf (1ll<<60)\n#define Yes(f) cout<<(f?\"Yes\":\"No\")<<endl\n#define yes(f) cout<<(f?\"yes\":\"no\")<<endl\n#define YES(f) cout<<(f?\"YES\":\"NO\")<<endl\n#define SORT(v) sort(all(v))\n#define RSORT(v) sort(all(v), greater<int>())\n\nusing namespace std;\n\nconst int mod=1e9+7;\n\nvoid run();\n\nvoid init() {\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    cout<<fixed<<setprecision(12);\n}\n\nsigned main(){\n    init();\n    run();\n    return 0;\n}\n\nvoid run(){\n    int n,m,t,p;\n    cin>>n>>m>>t>>p;\n    while(n){\n        int a[1000][1000];\n        int x=0,y=0,w=n,h=m;\n        rep(i,m)rep(j,n)a[i][j]=1;\n        while(t--){\n            int d,c;\n            cin>>d>>c;\n            if(d==1){\n                Rep(i,y,h){\n                    rep(j,c){\n                        a[i][x+2*c-j-1]+=a[i][x+j];\n                    }\n                }\n                w=max(w,x+2*c);\n                x+=c;\n            }\n            else{\n                Rep(i,x,w){\n                    rep(j,c){\n                        a[y+2*c-j-1][i]+=a[y+j][i];\n                    }\n                }\n                h=max(h,y+2*c);\n                y+=c;\n            }\n        }\n        while(p--){\n            int r,t;\n            cin>>r>>t;\n            cout<<a[y+t][x+r]<<endl;\n        }\n        cin>>n>>m>>t>>p;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<cstdio>\nusing namespace std;\nint n,m,t,p;\nint x,y;\nint a[1000][1000];\nint l,r,top,b;\nvoid show()\n{\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\n\t\t\tprintf(\"%d \",a[i][j]);\n\t\t}\n\t\tprintf(\"\\n\");\n\t}\n}\nvoid change(int x,int y)\n{\n\tif(x==2)\n\t{\n\t\tif(y>n/2) y=n-y;\n\t\tfor(int i=1;i<=y;i++)\n\t\t{\n\t\t\tfor(int j=1;j<=m;j++)\n\t\t\t{\n\t\t\t\ta[n-y-i+1][j]+=a[n-i+1][j];\n\t\t\t}\n\t\t}\n\t\tn-=y;\n\t}\n\telse\n\t{\n\t\tif(y>m/2) y=m-y;\n\t\tfor(int i=1;i<=y;i++)\n\t\t{\n\t\t\tfor(int j=1;j<=n;j++)\n\t\t\t{\n\t\t\t\ta[j][m-y-i+1]+=a[j][m-i+1];\n\t\t\t}\n\t\t}\n\t\tm-=y;\n\t}\n}\nint main()\n{\n\twhile(true)\n\t{\n\t\tscanf(\"%d%d%d%d\",&m,&n,&t,&p);\n\t\tfor(int i=1;i<=max(n,m);i++)\n\t\tfor(int j=1;j<=max(n,m);j++)\n\t\ta[i][j]=1;\n\t\tif(n==m&&n==0) return 0;\n\t\tfor(int i=1;i<=t;i++)\n\t\t{\n\t\t\tscanf(\"%d%d\",&x,&y);\n\t\t\tchange(x,y);\n\t\t}\n\t\tfor(int i=1;i<=p;i++)\n\t\t{\n\t\t\tscanf(\"%d%d\",&x,&y);\n\t\t\tprintf(\"%d\\n\",a[n-y][m-x]);\n\t\t}\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  int hh, w, t, p;\n  while (cin >> w >> hh >> t >> p, w) {\n    int res[40][40];\n    for (int i = 0; i < 40; i++) for (int j = 0; j < 40; j++) res[i][j] = 0;\n    for (int i = 0; i < hh; i++) for (int j = 0; j < w; j++) res[i][j] = 1;\n    for (int ii = 0; ii < t; ii++) {\n      int d, c; cin >> d >> c;\n      int tmp[40][40];\n      for (int i = 0; i < 40; i++) for (int j = 0; j < 40; j++) tmp[i][j] = 0;\n      if (d == 1) {\n        for (int i = 0; i < 40; i++) {\n          for (int j = c; j < 40; j++) {\n            tmp[i][j - c] += res[i][j];\n          }\n        }\n        for (int i = 0; i < 40; i++) {\n          for (int j = c - 1; j >= 0; j--) {\n            tmp[i][c - 1 - j] += res[i][j];\n          }\n        }\n      } else {\n        int h = 0;\n        for (int i = 0; i < 40; i++) {\n          if (res[i][0] != 0) h++;\n        }\n        if (c >= h - c) {\n          for (int i = h - 1; i >= h - c; i--) {\n            for (int j = 0; j < 40; j++) {\n              tmp[h - 1 - i][j] += res[i][j];\n            }\n          }\n          for (int i = 0; i < h - c; i++) {\n            for (int j = 0; j < 40; j++) {\n              tmp[i + 2 * c - h][j] += res[i][j];\n            }\n          }\n        } else {\n          for (int i = 0; i < h - c; i++) {\n            for (int j = 0; j < 40; j++) {\n              tmp[i][j] += res[i][j];\n            }\n          }\n          int now = c;\n          for (int i = h - 1; i >= h - c; i--) {\n            for (int j = 0; j < 40; j++) {\n              tmp[i - 2 * now + 1][j] += res[i][j];\n            }\n            now--;\n          }\n        }\n      }\n      for (int i = 0; i < 40; i++) {\n        for (int j = 0; j < 40; j++) {\n          res[i][j] = tmp[i][j];\n        }\n      }\n    }\n    int hlen = 0;\n    for (int i = 0; i < 40; i++) {\n      if (res[i][0] != 0) hlen++;\n    }\n    for (int i = 0; i < p; i++) {\n      int x, y; cin >> x >> y;\n      cout << res[hlen - 1 - y][x] << endl;\n    }\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<set>\n#include<map>\n#include<stack>\n\n#define MOD 10000000\nusing namespace std; \ntypedef long long LL;\n\nlong long quickpow(long long n, long long base) {\n    long long res = 1;\n    while(n) {\n        if(n & 1) {\n            res = res * base % MOD;\n        }\n        n >>= 1;\n        base = base * base % MOD;\n    }\n    return res;\n}//??? \n\nint ans[50];\nint A[100][100];\nint main()\n{\n\t  int n,m,t,p;\n\t  cin>>n>>m>>t>>p;\n\t  int d,c,x,y;\n\n      while(n!=0||m!=0||t!=0||p!=0)\n      {\n      \t  for(int i=1;i<=m;i++)\n      \t  for(int j=1;j<=n;j++)\n      \t  {\n  \t      \t A[i][j]=1;\n  \t      }\n  \t      for(int i=1;i<=t;i++)\n  \t      {\n      \t  \tcin>>d>>c;\n      \t  \t  if(d==1)\n      \t  \t  {\n\t  \t      \t  if(c<=(n/2))\n\t  \t      \t  {\n\t  \t      \t  \t   for(int i=1;i<=m;i++)\n  \t      \t  \t\t   for(int j=c+1;j<=(2*c);j++)\n  \t      \t  \t\t   A[i][j]+=A[i][(2*c)+1-j];\n   \t  \t\t           for(int i=1;i<=m;i++)\n  \t\t               for(int j=1;j<=(n-c);j++)\n  \t\t               A[i][j]=A[i][j+c];\n                       n-=c;\n  \t      \t  \t  }\n  \t      \t  \t  else\n  \t      \t  \t  {\n  \t  \t      \t  \t  for(int i=1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=c+1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]+=A[i][(2*c)+1-j];\n  \t  \t      \t  \t  for(int i=1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=c;j>=n-c+1;j--)\n  \t  \t      \t  \t  A[i][j]=A[i][c+1-j];\n  \t  \t      \t  \t  for(int i=1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n-c;j++)\n  \t  \t      \t  \t  A[i][j]=A[i][j+c];\n                      n=c;\n  \t      \t  \t  }\n  \t          }\n  \t          if(d==2)\n  \t          {\n\t  \t      \t  if(c<=(m/2))\n\t  \t      \t  {\n\t  \t      \t  \t   for(int i=c+1;i<=(2*c);i++)\n  \t      \t  \t\t   for(int j=1;j<=n;j++)\n  \t      \t  \t\t   A[i][j]+=A[(2*c)+1-i][j];\n   \t  \t\t           for(int i=1;i<=m-c;i++)\n  \t\t               for(int j=1;j<=n;j++)\n  \t\t               A[i][j]=A[i+c][j];\n                       m-=c;\n\n  \t      \t  \t  }\n  \t      \t  \t  else\n  \t      \t  \t  {\n  \t  \t      \t  \t  for(int i=c+1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]+=A[(2*c)+1-i][j];\n  \t  \t      \t  \t  for(int i=c;i>=m-c+1;i--)\n  \t  \t      \t  \t  for(int j=1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]=A[m+1-i][j];\n  \t  \t      \t  \t  for(int i=1;i<=m-c;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]=A[i+c][j];\n                      m=c;\n  \t      \t  \t  }\n          \t  }\n      \t  }\n      \t  int j=0;\n      \t  for(int i=1;i<=p;i++)\n      \t  {\n      \t  \tcin>>x>>y;\n  \t      \tans[++j]=A[y+1][x+1];\n  \t      }\n  \t      for(int i=1;i<=j;i++)\n  \t      {\n      \t  \tcout<<ans[i]<<endl;\n      \t  }\n      \t  cin>>n>>m>>t>>p;\n      }\n}\n"
  },
  {
    "language": "C++",
    "code": "//author Eterna\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<string>\n#include<cstring>\n#include<vector>\n#include<map>\n#include<set>\n#include<queue>\n#include<stack>\n#include<utility>\n#include<cmath>\n#include<climits>\n#include<deque>\n#include<functional>\n#define max(a,b) (a>b?a:b)\n#define min(a,b) (a<b?a:b)\n#define INF 0x7fffffff\n#define maxn 100000\n#define eps 1e-15\n#define MOD ((int)(1e9+7))\n#define ABS(x) ((x)>=0?(x):(-(x)))\n#define pb(x) push_back(x)\n#define lowbit(x) (x&-x)\n#define mid (L+R)/2\n#define Lson (index*2)\n#define Rson (index*2+1)\nusing namespace std;\ntypedef long long ll;\ninline int read() {\n\tchar c;\n\tint ret = 0, sgn = 1;\n\tdo { c = getchar(); } while ((c < '0' || c > '9') && c != '-');\n\tif (c == '-') sgn = -1; else ret = c - '0';\n\twhile ((c = getchar()) >= '0' && c <= '9') ret = ret * 10 + (c - '0');\n\treturn sgn * ret;\n}\nint arr[65][65], n, m, t, p, o, x, a, b;\nvoid move_left(int x) {\n\tfor (int i = 1; i <= m; i++)\n\t\tfor (int j = 1; j <= max(x, n - x); j++)\n\t\t\tarr[i][j] = arr[i][j + x];\n\tn = max(x, n - x);\n\t/*for (int i = 1; i <= m; i++) {\n\t\tfor (int j = 1; j <= n; j++)cout << arr[i][j] << \" \";\n\t\tcout << endl;\n\t}*/\n}\nvoid move_down(int x) {\n\tfor (int i = 1; i <= n; i++)\n\t\tfor (int j = 1; j <= max(x, m - x); j++)\n\t\t\tarr[j][i] = arr[j + x][i];\n\tm = max(x, m - x);\n\t/*for (int i = 1; i <= m; i++) {\n\t\tfor (int j = 1; j <= n; j++)cout << arr[i][j] << \" \";\n\t\tcout << endl;\n\t}*/\n}\nint main(void)\n{\n\twhile (cin >> n >> m >> t >> p&&n) {\n\t\tmemset(arr, 0, sizeof(arr));\n\t\tfor (int i = 1; i <= m; i++)\n\t\t\tfor (int j = 1; j <= n; j++) arr[i][j] = 1;\n\t\tfor (int i = 1; i <= t; i++) {\n\t\t\tcin >> o >> x;\n\t\t\tif (o == 1) {\n\t\t\t\tfor (int k = 1; k <= m; k++) {\n\t\t\t\t\tfor (int j = 1; j <= x; j++)\n\t\t\t\t\t\tarr[k][2 * x - j + 1] += arr[k][j];\n\t\t\t\t}\n\t\t\t\tmove_left(x);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (int k = 1; k <= n; k++)\n\t\t\t\t\tfor (int j = 1; j <= x; j++)\n\t\t\t\t\t\tarr[2 * x - j + 1][k] += arr[j][k];\n\t\t\t\tmove_down(x);\n\t\t\t}\n\t\t}\n\t\tfor (int i = 1; i <= p; i++) {\n\t\t\tcin >> a >> b; a++; b++;\n\t\t\tcout << arr[b][a] << endl;\n\t\t}\n\t}\n\t//system(\"pause\");\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  int n, m, t, p;\n  while (cin >> n >> m >> t >> p, n) {\n    vector<pair<int, int>> d(t), x(p);\n    for (auto &e : d) cin >> e.first >> e.second;\n    for (auto &e : x) cin >> e.first >> e.second;\n\n    vector<vector<int>> a(2 * m, vector<int>(2 * n));\n    for (int i = 0; i < m; i++) {\n      for (int j = 0; j < n; j++) {\n        a[i][j] = 1;\n      }\n    }\n    int x0 = 0, y0 = 0;\n    for (auto e : d) {\n      if (e.first == 1) {\n        x0 += e.second;\n        for (int i = 0; a[y0 + i][x0]; i++) {\n          for (int j = 0; x0 - j - 1 >= 0 && (a[y0 + i][x0 + j] || a[y0 + i][x0 - j - 1]); j++) {\n            a[y0 + i][x0 + j] += a[y0 + i][x0 - j - 1];\n            a[y0 + i][x0 - j - 1] = 0;\n          }\n        }\n      } else {\n        y0 += e.second;\n        for (int j = 0; a[y0][x0 + j]; j++) {\n          for (int i = 0; y0 - i - 1 >= 0 && (a[y0 + i][x0 + j] || a[y0 - i - 1][x0 + j]); i++) {\n            a[y0 + i][x0 + j] += a[y0 - i - 1][x0 + j];\n            a[y0 - i - 1][x0 + j] = 0;\n          }\n        }\n      }\n    }\n\n    for (auto e : x) {\n      cout << a[y0 + e.second][x0 + e.first] << endl;\n    }\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n  \nint main(){\n  int n,m,t,p;\n  \n  while(1){\n    cin >> n >> m >> t >> p ;\n  \n    if(n==0 && m==0 && t==0 && p==0){\n      break;\n    }\n  \n    int Ori[64][64] = {{0}};\n    for(int y=0;y<m;y++){\n      for(int x=0;x<n;x++){\n        Ori[y][x] = 1;\n      }\n    }\n  \n    for(int i=0;i<t;i++){\n      int d,c;\n      cin >> d >> c;\n  \n      if(d==1){\n        for(int x=0;x<c;x++){\n          for(int y=0;y<m;y++){\n            Ori[y][2*c-1-x] += Ori[y][x];\n            Ori[y][x] = 0;\n          }\n        }\n  \n        for(int x=0;x<n;x++){\n          for(int y=0;y<m;y++){\n            Ori[y][x] = Ori[y][x+c];\n            Ori[y][x+c] = 0;\n          }\n        }\n      }\n      else{\n        for(int y=0;y<c;y++){\n          for(int x=0;x<n;x++){\n            Ori[2*c-1-y][x] += Ori[y][x];\n            Ori[y][x] = 0;\n          }\n        }\n  \n        for(int y=0;y<m;y++){\n          for(int x=0;x<n;x++){\n            Ori[y][x] = Ori[y+c][x];\n            Ori[y+c][x] = 0;\n          }\n        }\n      }\n    }\n  \n    for(int i=0;i<p;i++){\n      int x,y;\n      cin >> x >> y;\n  \n      cout << Ori[y][x] << endl;\n    }\n  }\n  \n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint main(){\n  while (1){\n    int n, m, t, p;\n    cin >> n >> m >> t >> p;\n    if (n == 0 && m == 0 && t == 0 && p == 0){\n      break;\n    }\n    vector<vector<int>> cnt(m, vector<int>(n, 1));\n    for (int i = 0; i < t; i++){\n      int d, c;\n      cin >> d >> c;\n      vector<vector<int>> cnt2(m, vector<int>(n, 0));\n      if (d == 1){\n        for (int j = 0; j < m; j++){\n          for (int k = 0; k < n; k++){\n            if (k < c){\n              cnt2[j][c - k - 1] += cnt[j][k];\n            } else {\n              cnt2[j][k - c] += cnt[j][k];\n            }\n          }\n        }\n      }\n      if (d == 2){\n        for (int j = 0; j < m; j++){\n          for (int k = 0; k < n; k++){\n            if (j < c){\n              cnt2[c - j - 1][k] += cnt[j][k];\n            } else {\n              cnt2[j - c][k] += cnt[j][k];\n            }\n          }\n        }\n      }\n      swap(cnt, cnt2);\n    }\n    for (int i = 0; i < p; i++){\n      int x, y;\n      cin >> x >> y;\n      cout << cnt[y][x] << endl;\n    }\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nconst int inf = 1e9;\n\nvoid bottomleft(vector<vector<int> > &fp){\n    int h = fp.size();\n    int w = fp[0].size();\n    int b=inf, l=inf;\n    for(int i=0; i<h; i++){\n        for(int j=0; j<w; j++){\n            if(fp[i][j] > 0){\n                b = min(b, i);\n                l = min(l, j);\n            }\n        }\n    }\n    for(int i=0; i<h-b; i++){\n        for(int j=0; j<w-l; j++){\n            fp[i][j] = fp[i+b][j+l];\n            fp[i+b][j+l] = 0;\n        }\n    }\n}\n\nvoid foldLtoR(vector<vector<int> > &fp, int c){\n    int h = fp.size();\n    for(int i=0; i<h; i++){\n        for(int j=0; j<c; j++){\n            fp[i][2*c-j-1] += fp[i][j];\n            fp[i][j] = 0;\n        }\n    }\n    bottomleft(fp);\n}\n\nvoid foldBtoU(vector<vector<int> > &fp, int c){\n    int w = fp[0].size();\n    for(int i=0; i<c; i++){\n        for(int j=0; j<w; j++){\n            fp[2*c-i-1][j] += fp[i][j];\n            fp[i][j] = 0;\n        }\n    }\n    bottomleft(fp);\n}\n\nint main(){\n    while(1){\n        int w,h,t,p;\n        cin >> w >> h >> t >> p;\n        if(w == 0) break;\n\n        vector<vector<int> > fp(2*h, vector<int>(2*w, 0));\n        for(int i=0; i<h; i++){\n            for(int j=0; j<w; j++){\n                fp[i][j] = 1;\n            }\n        }\n        for(int i=0; i<t; i++){\n            int d,c;\n            cin >> d >> c;\n            if(d == 1) foldLtoR(fp, c);\n            else foldBtoU(fp, c);\n        }\n        for(int i=0; i<p; i++){\n            int x,y;\n            cin >> x >> y;\n            cout << fp[y][x] << endl;\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint tbl[1000][1000]; //前面为行，后面为列 \nint main(){\n\tint n,m,k,l;\n\twhile(scanf(\"%d%d%d%d\",&n,&m,&k,&l)==4&&(n!=0&&m!=0&&k!=0&&l!=0)){ \n\t\tfor(int i=0;i<1000;i++){\n\t\t\tfor(int j=0;j<1000;j++){\n\t\t\t\ttbl[i][j]=0;\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<m;i++){\n\t\t\tfor(int j=0;j<n;j++){\n\t\t\t\ttbl[i][j]=1;\n\t\t\t}\n\t\t}\n\t\tint start=0,curm=m;\t//目前的n和m \n\t\tint d,c,x,y;\n\t\tfor(int i=0;i<k;i++){\n\t\t\tcin>>d>>c;\n\t\t\tif(d==1){\n\t\t\t\tfor(int j=start+c;j<2*c+start;j++){\n\t\t\t\t\tfor(int b=0;b<curm;b++){\t//高度不变 \n\t\t\t\t\t\ttbl[b][j]+=tbl[b][2*(c+start)-j-1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstart+=c;\n\t\t\t\tn=max(start+2*c,n);\n\t\t\t}\n\t\t\tif(d==2){\n\t\t\t\tfor(int j=curm-2*c;j<curm-c;j++){\n\t\t\t\t\tfor(int b=start;b<n;b++){\n\t\t\t\t\t\ttbl[j][b]+=tbl[2*(curm-c)-j-1][b];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcurm-=c;\t//线的坐标为curm-c \n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<l;i++){\n\t\t\tcin>>x>>y;\n\t\t\tcout<<tbl[curm-y-1][x+start]<<endl;\n\t\t}\n\t\t\n\t}\n} \n\n/*\n2 1 1 1\n1 1\n0 0\n1 3 2 1\n2 1\n2 1\n0 0\n10 8 3 2\n2 2\n1 3\n1 1\n0 1\n3 4\n3 3 3 2\n1 2\n2 1\n1 1\n0 1\n0 0\n0 0 0 0\n\n\n4 5 3 2\n2 2\n1 1 \n1 1\n0 0\n0 1\n*/\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll, ll> l_l;\ntypedef pair<int, int> i_i;\n\n#define EPS (1e-7)\n#define INF (1e9)\n#define PI (acos(-1))\n//const ll mod = 1000000007;\n\nint main() {\n    //cout.precision(10);\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    while(true) {\n        int W, H, t, p;\n        cin >> W >> H >> t >> p;\n        if(W == 0) break;\n        int Prev[40][40];\n        int Next[40][40];\n        for(int i = 0; i < 40; i++) {\n            for(int j = 0; j < 40; j++) {\n                Prev[i][j] = 0;\n                Next[i][j] = 0;\n            }\n        }\n        for(int h = 1; h <= H; h++ ){\n            for(int w = 1; w <= W; w++) Prev[h][w] = 1;\n        }\n        while(t--) {\n            for(int i = 0; i < 40; i++) {\n                for(int j = 0; j < 40; j++) Next[i][j] = 0;\n            }\n            int d, c;\n            cin >> d >> c;\n            for(int h = 1; h <= H; h++) {\n                for(int w = 1; w <= W; w++) {\n                    if(d == 1) {\n                        if(w <= c) Next[h][c - w + 1] += Prev[h][w];\n                        else Next[h][w-c] += Prev[h][w];\n                    }\n                    if(d == 2) {\n                        if(h <= c) Next[c - h + 1][w] += Prev[h][w];\n                        else Next[h-c][w] += Prev[h][w];\n                    }\n                }\n            }\n            swap(Prev, Next);\n        }\n        //int ans = 0;\n        while(p--) {\n            int x, y;\n            cin >> x >> y;\n            cout << Prev[y+1][x+1] << endl;\n        }\n       // cout << ans << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nint n,m,t,p;\nint type,c;\nint main()\n{\n    while(~scanf(\"%d%d%d%d\",&m,&n,&t,&p)&&(m+n+t+p))\n    {\n        vector<vector<ll> >q(50);\n        for(int i=0; i<n; i++)\n        {\n            for(int j=0; j<m; j++)\n            {\n                q[i].push_back(1ll);\n            }\n        }\n        while(t--)\n        {\n            scanf(\"%d%d\",&type,&c);\n            if(type==1)\n            {\n                for(int j=0; j<n; j++)\n                {\n                    for(int i=0; i<=c-1; i++)\n                        q[j][2*c-1-i]+=q[j][i];\n                }\n                for(int i=0; i<n; i++)\n                    for(int j=0; j<m-c; j++)\n                        q[i][j]=q[i][j+c];\n            }\n            else if(type==2)\n            {\n                for(int j=0; j<m; j++)\n                    for(int i=0; i<=c-1; i++)\n                    {\n                        q[2*c-1-i][j]+=q[i][j];\n                    }\n                q.erase(q.begin(),q.begin()+c);\n            }\n        }\n        int x,y;\n        ll ans=0;\n        while(p--)\n        {\n            scanf(\"%d%d\",&x,&y);\n            printf(\"%lld\\n\",q[y][x]);\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\ntypedef long long ll;\nll n,m,p,q,A[33],B[33],a,b,C[33];\nint main(void){\n    while(1){\n        cin>>n>>m>>p>>q;\n        //cout<<n<<\" \"<<m<<\" \"<<p<<\" \"<<q<<\" \"<<endl;\n        if(n==0&&m==0&&p==0&&q==0){\n            return 0;\n        }\n        for(int i=0;i<33;i++){\n            A[i]=1,B[i]=1;\n        }\n        for(int i=0;i<p;i++){\n            cin>>a>>b;\n            //cout<<a<<b<<\"W\"<<p<<q<<endl;\n            if(a==1){\n                if(n-b<b){\n                    b=min(b,n-b);\n                    n-=b;\n                    for(int j=0;j<b;j++){\n                        A[b+j+1]+=A[b-j];\n                    }\n                    for(int j=0;j<n;j++){\n                        C[j+1]=A[n+b-j];\n                    }\n                    for(int j=1;j<=n;j++){\n                        A[j]=C[j];\n                    }\n                }\n                else{\n                    b=min(b,n-b);\n                    n-=b;\n                    for(int j=0;j<b;j++){\n                        A[n-j]+=A[n+j+1];\n                    }\n                }\n            }\n            if(a==2){\n                if(m-b<b){\n                    b=min(b,m-b);\n                    m-=b;\n                    for(int j=0;j<b;j++){\n                        B[b+j+1]+=B[b-j];\n                    }\n                    for(int j=0;j<m;j++){\n                        C[j+1]=B[m+b-j];\n                    }\n                    for(int j=1;j<=m;j++){\n                        B[j]=C[j];\n                    }\n                }\n                else{\n                    b=min(b,m-b);\n                    m-=b;\n                    for(int j=0;j<b;j++){\n                        B[m-j]+=B[m+j+1];\n                    }\n                }\n            }\n        }/*\n        if(p==3){\n            for(int i=0;i<=n;i++)cout<<A[i];\n            cout<<endl;\n            for(int j=0;j<=m;j++)cout<<B[j];\n            cout<<endl;\n        }*/\n        for(int i=0;i<q;i++){\n            cin>>a>>b;\n            cout<<A[n-a]*B[m-b]<<endl;\n        }\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i, n) for (int i = 0; i < n; i++)\n#define ALL(obj) obj.begin(), obj.end()\n\nconst int iINF = 1e9;\nconst long long llINF = 1e18;\nconst int MOD = 1e9 + 7;\n\nusing namespace std;\n\ntemplate <typename T>\nint getFormer(const vector<T> &vec, T x) {\n    return upper_bound(vec.begin(), vec.end(), x) - vec.begin() - 1;\n}\n\ntemplate <typename T>\nint getLatter(const vector<T> &vec, T x) {\n    return lower_bound(vec.begin(), vec.end(), x) - vec.begin();\n}\n\nvoid solve(int n, int m, int t, int p) {\n    vector<int> d(t), c(t), _x(p), _y(p);\n    vector<vector<int>> before(m, vector<int>(n, 1)), after;\n    REP(i, t) {\n        int d, c;\n        cin >> d >> c;\n        if (d == 1) {\n            int _n = max(n - c, c);\n            after = vector<vector<int>> (m, vector<int> (_n));\n            REP(y, m) {\n                REP(x, n - c) {\n                    after[y][x] = before[y][x + c];\n                }\n            }\n\n            REP(y, m) {\n                REP(x, c) {\n                    after[y][c - x - 1] += before[y][x];\n                }\n            }\n            n = _n;\n        } else {\n            int _m = max(m - c, c);\n            after = vector<vector<int>> (_m, vector<int> (n));\n            REP(x, n) {\n                REP(y, m - c) {\n                    after[y][x] = before[y + c][x];\n                }\n            }\n\n            REP(x, n) {\n                REP(y, c) {\n                    after[c - y - 1][x] += before[y][x];\n                }\n            }\n            m = _m;\n        }\n        before = after;\n    }\n\n    REP(i, p) {\n        int x, y;\n        cin >> x >> y;\n        cout << before[y][x] << endl;\n    }\n}\n\nint main() {\n    int n, m, t, p;\n    while(cin >> n>> m >> t >> p && n) {\n        solve(n, m, t, p);\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\nconst int max_v = 100;\n\nint origami[max_v][max_v];\nint tmp[max_v][max_v];\n\nvoid copy() {\n    for (int i = 0; i < max_v; i++) {\n        for (int j = 0; j < max_v; j++) { tmp[i][j] = origami[i][j]; }\n    }\n}\n\nvoid show() {\n    for (int i = 0; i < max_v; i++) {\n        for (int j = 0; j < max_v; j++) {\n            cout << origami[i][j] << \" \";\n        } \n        cout << endl;\n    }\n    cout << \"-------------------\" << endl;\n}\n\nvoid fold_a(int c) {\n    int t = c;\n    for (int i = 0; i < c; i++) {\n        for (int j = 0; j < max_v; j++) {\n            origami[j][t+i] += origami[j][t-i-1];\n            origami[j][t-i-1] = 0;\n        }\n    }\n\n    copy();\n\n    for (int i = 0; i < max_v; i++) {\n        for (int j = 0; j < max_v; j++) {\n            if (j-c < 0 || max_v-1 < j-c) { continue; }\n            origami[i][j-c] = tmp[i][j];\n        }\n    }\n}\n\n\nvoid fold_b(int c) {\n    int t = max_v-c-1;\n    for (int i = 0; i < max_v; i++) {\n        for (int j = 0; j < c; j++) {\n            origami[t-j][i] += origami[t+j+1][i];\n            origami[t+j+1][i] = 0;\n        }\n    }\n\n    copy();\n\n    for (int i = 0; i < max_v; i++) {\n        for (int j = 0; j < max_v; j++) {\n            if (i+c < 0 || max_v-1 < i+c) { continue; }\n            origami[i+c][j] = tmp[i][j];\n        }\n    }\n}\n\nint main() {\n    int n, m, t, p;\n    int d, c, x, y;\n\n    while (cin >> n >> m >> t >> p) {\n        if (!n && !m && !t && !p) { break; }\n\n        for (int i = 0; i < max_v; i++) {\n            for (int j = 0; j < max_v; j++) {\n                origami[i][j] = 0;\n            }\n        }\n        for (int i = 0; i < n; i++) {\n            for (int j = 0; j < m; j++) {\n                origami[max_v-j-1][i] = 1;\n            }\n        }\n\n        for (int i = 0; i < t; i++) {\n            cin >> d >> c;\n            if (d == 1) { fold_a(c); }\n            if (d == 2) { fold_b(c); }\n        }\n \n        for (int i = 0; i < p; i++) {\n            cin >> x >> y;\n            cout << origami[max_v-y-1][x] << endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define LL long long\n\nusing namespace std;\n\nint a[100][100];\n\nint main()\n{\n    int n,m,t,p;\n    while (scanf(\"%d%d%d%d\",&m,&n,&t,&p))\n    {\n        if (n==0 && m==0 && t==0 && p==0) break;\n\n        memset(a,0,sizeof(a));\n        for (int i=0;i<n;i++)\n            for (int j=0;j<m;j++)\n                a[i][j]=1;\n\n\n        for (int i=0;i<t;i++)\n        {\n            int d,c;\n            scanf(\"%d%d\",&d,&c);\n            if (d==2)\n            {\n                for (int j=0;j<c;j++)\n                    for (int k=0;k<m;k++)\n                        a[j][k]=a[j][k]+a[j+c][k];\n                n=max(c,n-c);\n            }\n            if (d==1)\n            {\n                for (int j=0;j<n;j++)\n                    for (int k=0;k<c;k++)\n                        a[j][k]=a[j][k]+a[j][k+c];\n                m=max(c,m-c);\n            }\n        }\n        for (int i=0;i<p;i++)\n            {\n                int x,y;\n                scanf(\"%d%d\",&x,&y);\n                printf(\"%d\\n\",a[y][x]);\n            }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n\nusing namespace std;\n\nint paper[500][500];\n\nint main() {\n\tint n, m, t, p; \n\twhile (cin >> n >> m >> t >> p, n) {\n\t\tint dx = 0, dy = 0;\n\t\tmemset(paper, 0, sizeof(paper));\n\t\tfor (int i = 0; i < n; ++i)\n\t\t\tfor (int j = 0; j < m; ++j)\n\t\t\t\tpaper[i][j] = 1;\n\t\twhile (t--) {\n\t\t\tint d, c; cin >> d >> c;\n\t\t\tif (d == 1) {\n\t\t\t\tfor (int i = 0; i < c; ++i)\n\t\t\t\t\tfor (int j = dy; j < m; ++j)\n\t\t\t\t\t\tpaper[dx + c + i][j] += paper[dx + c - i - 1][j];\n\t\t\t\tdx += c;\n\t\t\t\tif (n < dx + 2 * c) n = dx + 2 * c;\n\t\t\t} else {\n\t\t\t\tfor (int i = 0; i < c; ++i)\n\t\t\t\t\tfor (int j = dx; j < n; ++j)\n\t\t\t\t\t\tpaper[j][dy + c + i] += paper[j][dy + c - i - 1];\n\t\t\t\tdy += c;\n\t\t\t\tif (m < dy + 2 * c) m = dy + 2 * c;\n\t\t\t}\n\t\t}\n\t\twhile (p--) {\n\t\t\tint x, y; cin >> x >> y;\n\t\t\tcout << paper[dx + x][dy + y] << endl;\n\t\t}\n\t}\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint main(){\n    while(true){\n        short n,m,t,p;\n        cin>>n>>m>>t>>p;\n        if(n==0&&m==0&&t==0&&p==0){\n            return 0;\n        }\n        short Ori[64][64]={{0}};\n        for(int y=0;y<m;y++){\n            for(int x=0;x<n;x++){\n                Ori[y][x]=1;\n            }\n        }\n        for(int i=0;i<t;i++){\n            int d,c;\n            cin>>d>>c;\n            if(d==1){\n                for(int x=0;x<c;x++){\n                    for(int y=0;y<m;y++){\n                        Ori[y][2*c-1-x] += Ori[y][x];\n                        Ori[y][x] = 0; \n                    }\n                }\n                for(int x=0;x<n;x++){\n                    for(int y=0;y<m;y++){\n                        Ori[y][x]=Ori[y][x+c];\n                        Ori[y][x+c]=0;\n                    }\n                }\n            }else{\n                for(int y=0;y<c;y++){\n                    for(int x=0;x<n;x++){\n                        Ori[2*c-1-y][x] += Ori[y][x];\n                        Ori[y][x] = 0; \n                    }\n                }\n                for(int y=0;y<m;y++){\n                    for(int x=0;x<n;x++){\n                        Ori[y][x]=Ori[y+c][x];\n                        Ori[y+c][x]=0;\n                    }\n                }\n            }\n        }\n        for(int i=0;i<p;i++){\n            int x,y;\n            cin>>x>>y;\n            cout<<Ori[y][x]<<endl;\n        }\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "// I SELL YOU...! \n#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<functional>\n#include<queue>\n#include<chrono>\n#include<iomanip>\n#define MAX 33*21\nusing namespace std;\nusing ll = long long;\nusing P = pair<ll,ll>;\nint d[MAX][MAX];\nint n,m,t,p,cmd,line;\nvoid init_io(){\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n  cout << setprecision(10);\n}\nvoid up(int sy,int border){\n  int end = border + 1 + (border-sy);\n  for(int x=0;x<MAX;x++){\n    for(int y=sy;y<=border;y++){\n      ll ady = end - (y-sy);\n      d[ady][x] += d[y][x];\n      d[y][x] = 0;\n    }\n  }\n}\nvoid right(int sx,int border){\n  int end = border + 1 + (border-sx);\n  for(int y=0;y<MAX;y++){\n    for(int x=sx;x<=border;x++){\n      ll adx = end - (x-sx);\n      d[y][adx] += d[y][x];\n      d[y][x] = 0;\n    }\n  }\n}\nsigned main(){\n  int ans=0,most_l,most_u,x,y;\n  cin >> n >> m >> t >> p;\n  while(n!=0&&m!=0){\n    most_l = most_u = 0;\n    fill(d[0],d[MAX],0);\n    for(int i=0;i<m;i++){\n      for(int j=0;j<n;j++){\n        d[i][j] = 1;\n      }\n    }\n    for(int i=0;i<t;i++){\n      cin >> cmd >> line;\n      if(cmd==1){\n        right(most_l,most_l+line-1);\n        most_l += line;\n      }else{\n        up(most_u,most_u+line-1);\n        most_u += line;\n      }\n    }\n    for(int i=0;i<p;i++){\n      cin >> x >> y;\n      ans = d[most_u+y][most_l+x];\n      cout << ans << endl;\n    }\n    cin >> n >> m >> t >> p;\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#define _SILENCE_ALL_CXX17_DEPRECATION_WARNINGS\n#include <stdio.h>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <cstring>\n#include <queue>\n#include <stack>\n#include <math.h>\n#include <iterator>\n#include <vector>\n#include <string>\n#include <set>\n#include <math.h>\n#include <iostream>\n#include <random>\n#include <map>\n#include <fstream>\n#include <iomanip>\n#include <time.h>\n#include <stdlib.h>\n#include <list>\n#include <typeinfo>\n#include <list>\n#include <set>\n#include <assert.h>\n#include <complex>\nusing namespace std;\n#define LONG_INF 10000000000000\n#define GOLD 1.61803398874989484820458\n#define MAX_MOD 1000000007\n#define MOD 998244353LL\n#define seg_size 65536*4\n#define REP(i,n) for(long long i = 0;i < n;++i)\nint main() {\n\twhile (true) {\n\t\tint n, m, t, p;\n\t\tcin >> n >> m >> t >> p;\n\t\tif (n == 0) {\n\t\t\treturn 0;\n\t\t}\n\t\tint grid[200][200] = {};\n\t\tfor (int i = 0; i < n; ++i) {\n\t\t\tfor (int q = 0; q < m; ++q) {\n\t\t\t\tgrid[i][q]++;\n\t\t\t}\n\t\t}\n\t\tREP(tere, t) {\n\t\t\tint a, b;\n\t\t\tcin >> a >> b;\n\t\t\tif (a == 1) {\n\t\t\t\tfor (int i = 0;i < m;i++) {\n\t\t\t\t\tfor (int q = 0; q < b; ++q) {\n\t\t\t\t\t\tgrid[(2 * b - q - 1)][i] += grid[q][i];\n\t\t\t\t\t\tgrid[q][i] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (int i = 0; i < n; ++i) {\n\t\t\t\t\tfor (int q = 0; q < m; ++q) {\n\t\t\t\t\t\tgrid[i][q] = grid[i + b][q];\n\t\t\t\t\t\tgrid[i + b][q] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (int i = 0; i < n; ++i) {\n\t\t\t\t\tfor (int q = 0; q < b; ++q) {\n\t\t\t\t\t\tgrid[i][(2*b - q - 1)] += grid[i][q];\n\t\t\t\t\t\tgrid[i][q] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (int i = 0; i < n; ++i) {\n\t\t\t\t\tfor (int q = 0; q < m; ++q) {\n\t\t\t\t\t\tgrid[i][q] = grid[i][q + b];\n\t\t\t\t\t\tgrid[i][q + b] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tREP(i, p) {\n\t\t\tint a, b;\n\t\t\tcin >> a >> b;\n\t\t\tcout << grid[a][b] << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define rep(i, j, k) for(int i = j; i < k; i++)\n#define rrep(i, j, k) for(int i = j; i > k; i--)\n\n\nusing namespace std;\n\n\nvoid sol(int &n, int &m, int &t, int &p) {\n    int now[40][40];\n    int w = n, h = m;\n    rep(i, 0, h) rep(j, 0, w) now[i][j] = 1;\n    // rep(i, 0, h) {\n    //     rep(j, 0, w) {\n    //         cerr << now[i][j] << \" \";\n    //     }\n    //     cerr << endl;\n    // }\n    //cerr << \"hi\" << endl;\n    for (int tt = 0; tt < t; tt++) {\n        int tmp[40][40];\n        rep(i, 0, 40) rep(j, 0, 40) tmp[i][j] = 0;        \n        int d, c; cin >> d >> c;\n        //cerr << \"(h, w) = \" << h << \" \" << w << endl;\n        if (d == 1) {\n            for (int i = 0; i < h; i++) {\n                int idx = 0;\n                for (int j = c - 1; j >= 0; j--) {\n                    tmp[i][idx] += now[i][j];\n                    idx++;\n                }\n            }\n        //     for (int i = 0; i < h; i++) {\n        //     for (int j = 0; j < w; j++) {\n        //         cerr << tmp[i][j] << \" \";\n        //     }\n        //     cerr << endl;\n        // }\n            for (int i = 0; i < h; i++) {\n                int idx = 0;\n                for (int j = c; j < w; j++) {\n                    tmp[i][idx] += now[i][j];\n                    idx++;\n                }\n            }\n        //     for (int i = 0; i < h; i++) {\n        //     for (int j = 0; j < w; j++) {\n        //         cerr << tmp[i][j] << \" \";\n        //     }\n        //     cerr << endl;\n        // }\n            w = max(c, w - c);\n        } else {\n            if (h - c >= c) {\n                for (int j = 0; j < w; j++) {\n                    int idx = 0;\n                    for (int i = 0; i < h - c; i++) {\n                        tmp[idx][j] += now[i][j];\n                        idx++;\n                    }\n                }\n                for (int j = 0; j < w; j++) {\n                    int idx = h - c - 1;\n                    for (int i = h - c; i < h; i++) {\n                        tmp[idx][j] += now[i][j];\n                        idx--;\n                    }\n                }\n            } else {\n                for (int j = 0; j < w; j++) {\n                    int idx = 0;\n                    for (int i = h - 1; i >= h - c; i--) {\n                        tmp[idx][j] += now[i][j];\n                        idx++;\n                    }\n                }\n                for (int j = 0; j < w; j++) {\n                    int idx = c - 1;\n                    for (int i = h - c - 1; i >= 0; i--) {\n                        tmp[idx][j] += now[i][j];\n                        idx--;\n                    }\n                }\n            }\n            h = max(c, h - c);\n            //rep(i, 0, 40) rep(j, 0, 40) now[i][j] = tmp[i][j];\n        }\n        // for (int i = 0; i < h; i++) {\n        //     for (int j = 0; j < w; j++) {\n        //         cerr << now[i][j] << \" \";\n        //     }\n        //     cerr << endl;\n        // }\n            rep(i, 0, 40) rep(j, 0, 40) now[i][j] = tmp[i][j];\n    }\n    //cerr << \"hi\" << endl;\n    int ans = 0;\n    for (int tt = 0; tt < p; tt++) {\n        int x, y; cin >> x >> y;\n        y = h - 1 - y;\n        cout << now[y][x] << endl;\n    }\n    //cerr << \"hi\" << endl;\n}\n\nint n, m, t, p;\n\nint main() {\n    while (cin >> n >> m >> t >> p, n) {\n        sol(n, m, t, p);\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int MAX_NM=33,MAX_TP=21;\n\nint n,m,t,p,ans;\nint d[MAX_TP],c[MAX_TP],x[MAX_TP],y[MAX_TP];\npair<int,int> pos[MAX_NM][MAX_NM];\n\nvoid solve(){\n    for (int i=0;i<n;++i)\n        for (int j=0;j<m;++j)\n            pos[i][j]={i,j};\n    for (int k=0;k<t;++k){\n        if (d[k]==1){\n            for (int i=0;i<n;++i){\n                for (int j=0;j<m;++j){\n                    if (pos[i][j].first<c[k]){\n                        pos[i][j].first=c[k]-pos[i][j].first-1;\n                    } else pos[i][j].first-=c[k];\n                }\n            }\n        } else {\n            for (int i=0;i<n;++i){\n                for (int j=0;j<m;++j){\n                    if (pos[i][j].second<c[k]){\n                        pos[i][j].second=c[k]-pos[i][j].second-1;\n                    } else pos[i][j].second-=c[k];\n                }\n            }\n        }\n    }\n    for (int k=0;k<p;++k){\n        ans=0;\n        for (int i=0;i<n;++i)\n            for (int j=0;j<m;++j)\n                ans+=(pos[i][j]==make_pair(x[k],y[k]));\n        cout << ans << '\\n';\n    }\n}\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    while(cin >> n >> m >> t >> p,n){\n        for (int i=0;i<t;++i) cin >> d[i] >> c[i];\n        for (int i=0;i<p;++i) cin >> x[i] >> y[i];\n        solve();\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "    #include <bits/stdc++.h>\n\n #define int long long\n using namespace std;\n\nint a[100][100][100];\n\nint n,m;\nint yoko(int kai,int r){\n\t\n\tfor(int i=0;i<r;i++){\n\t\tfor(int j=0;j<m;j++)\t{\n\t\t\ta[kai][2*r-1-i][j]+=a[kai][i][j];\n\t\t\ta[kai][i][j]=0;\n\t\t}\n\t}\n\tfor(int i=r;i<2*n;i++)for(int j=0;j<m;j++){\n\t\ta[kai+1][i-r][j]=a[kai][i][j];\n\t}\n\t\n}\nint tate(int kai,int r){\n\t\n\tfor(int j=0;j<r;j++){\n\t\tfor(int i=0;i<n;i++)\t{\n\t\t\ta[kai][i][2*r-j-1]+=a[kai][i][j];\n\t\t\ta[kai][i][j]=0;\n\t\t}\n\t}\n\tfor(int j=r;j<2*m;j++)for(int i=0;i<n;i++){\n\t\ta[kai+1][i][j-r]=a[kai][i][j];\n\t}\n\t\n}\n\n\nvoid solve(){\nint t,p;\n\tcin>>n>>m>>t>>p;\nif(n==0) exit(0);\n\t\n\tfor(int i=0;i<100;i++)for(int j=0;j<100;j++)for(int k=0;k<100;k++)a[i][j][k]=0;\n\t\n\tint ans=0;\n\t\n\tfor(int i=0;i<n;i++)for(int j=0;j<m;j++)a[0][i][j]=1;\n\t\n\tfor(int i=0;i<t;i++){\n\t\tint y,yy;\n\t\tcin>>y>>yy;\n\t\tif(y==1){\n\t\t\tyoko(i,yy);\n\t\t}\n\t\telse tate(i,yy);\n\t}\n\t\n\tfor(int i=0;i<p;i++){\n\t\tint y,yy;\n\t\tcin>>y>>yy;\n\t\tcout<<a[t][y][yy]<<endl;\n\t}\n\n}\n\n    signed main(){\n               cin.tie(0);\n    \t\tios::sync_with_stdio(false);\n\n \n    \t\n    \tfor(int i=0;;i++){\n    \t\tsolve();\n    \t\n    \t}\n    \treturn 0;\n    \t\n            }\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define FOR(i, a, b) for (int i = (a); i < (b); ++i)\n#define rep(i, n) for (int i = 0; i < (int)(n); i++)\n#define all(x) (x).begin(), (x).end()\n\ninline int toInt(string s) {\n  int v;\n  istringstream sin(s);\n  sin >> v;\n  return v;\n}\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector<vector<int> > Mat;\ntypedef tuple<int, int, int, int> T;\n\nconst int MOD = (int)1e9 + 7;\nconst int INF = (int)1e9;\nconst int dx[] = {0, 1, 0, -1};\nconst int dy[] = {1, 0, -1, 0};\nconst int ddx[] = {0, 1, 1, 1, 0, -1, -1, -1};\nconst int ddy[] = {1, 1, 0, -1, -1, -1, 0, 1};\n\nint main() {\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n\n  int n, m, t, p;\n  while (1) {\n    cin >> n >> m >> t >> p;\n\n    if (n + m + t + p == 0) break;\n    vector<vector<int> > paper(33 * 21, vector<int>(33 * 21, 0));\n    int ox = 0, oy = 0, dx = n, dy = m;\n    rep(i, m) rep(j, n) paper[i][j] += 1;\n\n    rep(_, t) {\n      int d, c;\n      cin >> d >> c;\n      if (d == 1) {\n        dx = max(dx, ox + c * 2);\n        FOR(i, ox, ox + c) {\n          FOR(j, oy, dy) paper[j][2 * ox + 2 * c - 1 - i] += paper[j][i];\n        }\n        ox += c;\n      } else {\n        dy = max(dy, oy + c * 2);\n        FOR(i, oy, oy + c) {\n          FOR(j, ox, dx) paper[2 * oy + 2 * c - 1 - i][j] += paper[i][j];\n        }\n        oy += c;\n      }\n    }\n\n    /*\n      FOR(i, oy, dy) {\n        FOR(j, ox, dx) cout << paper[i][j];\n        cout << endl;\n      }\n      */\n\n    rep(_, p) {\n      int x, y;\n      cin >> x >> y;\n      cout << paper[y + oy][x + ox] << \"\\n\";\n    }\n  }\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <functional>\n#include <vector>\n#include <utility>\n#include <cstring>\n#include <cmath>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n#include <numeric> \n#define MAX_N 100\nusing namespace std;\ntypedef long long ll;\nconst int INF = 1<<30; \nconst int MOD = 1e9 + 7;\nconst int dx[] = {1, 0, -1, 0};\nconst int dy[] = {0, 1, 0, -1};\nint main()\n{\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tint w, h, t, p, d, c;\n\twhile(cin >> w >> h >> t >> p, w | h | t | p)\n\t{\n\t\tint table[2 * MAX_N][2 * MAX_N] = {};\n\t\tfor(int i = 0; i < h; i++)\n\t\t\tfor(int j = 0; j < w; j++) table[i][j] = 1;\n\t\tfor(int i = 0; i < t; i++)\n\t\t{\n\t\t\tcin >> d >> c;\n\t\t\tif(d == 1)\n\t\t\t{\n\t\t\t\tfor(int j = 0; j < h; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < c; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint alpha = c - k - 1;\n\t\t\t\t\t\ttable[j][c + alpha] += table[j][k];\n\t\t\t\t\t\ttable[j][k] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j = 0; j < MAX_N; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < MAX_N; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\ttable[j][k] = table[j][k + c];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(d == 2)\n\t\t\t{\n\t\t\t\tfor(int j = 0; j < c; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < w; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint alpha = c - j - 1;\n\t\t\t\t\t\ttable[c + alpha][k] += table[j][k];\n\t\t\t\t\t\ttable[j][k] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j = 0; j < MAX_N; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < MAX_N; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\ttable[j][k] = table[j + c][k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint x, y;\n\t\tfor(int i = 0; i < p; i++)\n\t\t{\n\t\t\tcin >> x >> y;\n\t\t\tcout << table[y][x] << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<cmath>\n#include<cstdlib>\n#include<cstring>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<numeric>\n#include<map>\n#include<limits>\nusing namespace std;\n\n#define R(i,s,n) for(int i=s;i<n;i++)\n#define D(i,n,s) for(int i=n-1;i>=s;i--)\ntypedef pair<int,int> P;\ntypedef unsigned long long ull;\ntypedef long long ll;\n\nint n,m,t,p;\n\nint main() {\n  while(cin >> n >> m >> t >> p && !(!n && !m && !t && !p)){\n    //初期化\n    int d[t],c[t],x[p],y[p];\n    R(i,0,t){\n      cin >> d[i] >> c[i];\n    }\n    R(i,0,p){\n      cin >> x[i] >> y[i];\n    }\n    vector< vector<int> > t1(32,vector<int>(32,0));\n    R(i,0,m){\n      R(j,0,n){\n        t1[i][j] = 1;\n      }\n    }\n\n    //折る\n    //d=1左,d=2上\n    R(oru,0,t){\n      vector< vector<int> > t2(32,vector<int>(32,0));\n      R(i,0,m){\n        R(j,0,n){\n          if(d[oru] == 1){\n            if(c[oru]-j-1 >= 0) t2[i][j] += t1[i][c[oru]-j-1];\n          }else{\n            if(c[oru]-i-1 >= 0) t2[i][j] += t1[c[oru]-i-1][j];\n          }\n          if((d[oru]==1?j+c[oru]:i+c[oru]) >= 32)continue;\n          t2[i][j] += t1[d[oru]==2?i+c[oru]:i][d[oru]==1?j+c[oru]:j];\n        }\n      }\n      /*\n      D(i,d[oru]==1?m:c[oru],0){\n        D(j,d[oru]==2?n:c[oru],0){\n          t2[d[oru]==1?m-i-1:c[oru]-i-1][d[oru]==2?n-j-1:c[oru]-j-1] += t1[i][j];\n        }\n      }*/\n      t1 = t2;\n    }\n    /*\n    R(i,0,32){\n      R(j,0,32){\n        cout << t1[i][j] << \" \";\n      }\n      cout << endl;\n    }\n    */\n    //穴\n    R(ana,0,p){\n      cout << t1[y[ana]][x[ana]] << endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define MAX 35\nusing namespace std;\nint G[MAX][MAX];\nint main()\n{\n    int n,m,t,p;\n    while(scanf(\"%d%d%d%d\",&n,&m,&t,&p)!=EOF&&n)//n-j,m-i;\n    {\n        int res=0;\n        for(int i=1;i<=m;i++)\n            for(int j=1;j<=n;j++)\n            G[i][j]=1;\n        int d,c,sx=1,sy=1,mm=m,nn=n;\n        while(t--)\n        {\n            scanf(\"%d%d\",&d,&c);\n            if(d==1)\n            {\n                for(int i=sx;i<sx+mm;i++)\n                    for(int l=sy+c-1,r=l+1;l>=sy;l--,r++)\n                    G[i][r]+=G[i][l];\n                sy+=c;\n            }\n            if(d==2)\n            {\n                for(int j=sy;j<sy+nn;j++)\n                    for(int d=mm-c+1,u=d-1;d<=mm;d++,u--)\n                    G[u][j]+=G[d][j];\n                mm-=c;\n            }\n//            for(int i=sx;i<=mm;i++)\n//            {\n//                for(int j=sy;j<=nn;j++)\n//                    cout<<G[i][j]<<\" \";\n//                cout<<endl;\n//            }\n        }\n//        cout<<endl;\n        while(p--)\n        {\n            int x,y;\n            scanf(\"%d%d\",&x,&y);\n            int a=mm-y;\n            int b=sy+x;\n//            cout<<\"a=\"<<a<<\" b=\"<<b<<endl;\n//            cout<<\"gab=\"<<G[a][b]<<endl;\n            res+=G[a][b];\n        }\n        cout<<res<<endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n//repetition\n#define FOR(i, a, b) for (ll i = (a); i < (b); ++i)\n#define rep(i, n) for (ll i = 0; i < (ll)(n); i++)\n\n//container util\n#define all(x) (x).begin(), (x).end()\n\n//typedef\ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<ll> VLL;\ntypedef vector<VLL> VVLL;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef pair<ll, ll> PLL;\n\n//conversion\ninline int toInt(string s)\n{\n    int v;\n    istringstream sin(s);\n    sin >> v;\n    return v;\n}\ninline ll toLL(string s)\n{\n    ll v;\n    istringstream sin(s);\n    sin >> v;\n    return v;\n}\ntemplate <class T>\ninline string toString(T x)\n{\n    ostringstream sout;\n    sout << x;\n    return sout.str();\n}\n\nvoid dump(vector<vector<int>> &v)\n{\n    rep(i, v.size())\n    {\n        rep(j, v[0].size())\n        {\n            cerr << v[i][j] << \" \";\n        }\n        cerr << endl;\n    }\n    cerr << \"------\" << endl;\n}\n\nint main()\n{\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    while (true)\n    {\n        int n, m, t, p;\n        cin >> n >> m >> t >> p;\n        if (n == 0 && m == 0)\n            break;\n        int a[32][32];\n\n        int w = n, h = m;\n        rep(i, 32) rep(j, 32)\n        {\n            if (i < m && j < n)\n                a[i][j] = 1;\n            else\n                a[i][j] = 0;\n        }\n        rep(_, t)\n        {\n            int d, c;\n            cin >> d >> c;\n            vector<vector<int>> b(32, vector<int>(32, 0));\n            rep(i, 32) rep(j, 32)\n                b[i][j] = 0;\n\n            if (d == 1)\n            {\n                rep(i, 32) rep(j, 32)\n                {\n                    if (c + j < n)\n                    {\n                        b[i][j] += a[i][j + c];\n                        // cerr << \"add1 \" << i << \",\" << j << \",\" << a[c + i][j] << endl;\n                    }\n                    if (c - j - 1 >= 0)\n                    {\n                        b[i][j] += a[i][c - 1 - j];\n                        //   cerr << \"add2 \" << i << \",\" << j << \",\" << a[c - i - 1][j] << endl;\n                    }\n                }\n                rep(i, 32) rep(j, 32)\n                    a[i][j] = b[i][j];\n            }\n            else\n            {\n                rep(i, 32) rep(j, 32)\n                {\n                    if (c + i < m)\n                    {\n                        b[i][j] += a[i + c][j];\n                        // cerr << \"add1 \" << i << \",\" << j << \",\" << a[c + i][j] << endl;\n                    }\n                    if (c - i - 1 >= 0)\n                    {\n                        b[i][j] += a[c - 1 - i][j];\n                        //   cerr << \"add2 \" << i << \",\" << j << \",\" << a[c - i - 1][j] << endl;\n                    }\n                }\n                rep(i, 32) rep(j, 32)\n                    a[i][j] = b[i][j];\n            }\n                }\n        rep(_, p)\n        {\n            int x, y;\n            cin >> x >> y;\n            cout << a[y][x] << endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\nint main(){\n\tint H,W,N,M;\n\tcin>>W>>H>>N>>M;\n\tvector<int>ret;\n\twhile(W){\n\t\tvector<vector<int>>v(H,vector<int>(W,1));\n\t\tfor(int i=0;i<N;i++){\n\t\t\tint a,b;\n\t\t\tcin>>a>>b;\n\t\t\tvector<vector<int>>w(H,vector<int>(W));\n\t\t\tif(a==1){\n\t\t\t\tfor(int j=0;j<H;j++){\n\t\t\t\t\tfor(int k=0;k<W;k++){\n\t\t\t\t\t\tif(k<b){\n\t\t\t\t\t\t\tw[j][b-k-1]+=v[j][k];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tw[j][k-b]+=v[j][k];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfor(int j=0;j<H;j++){\n\t\t\t\t\tfor(int k=0;k<W;k++){\n\t\t\t\t\t\tif(j<b){\n\t\t\t\t\t\t\tw[b-j-1][k]+=v[j][k];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tw[j-b][k]+=v[j][k];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tv=w;\n\t\t}\n\t\tfor(int i=0;i<M;i++){\n\t\t\tint a,b;\n\t\t\tcin>>a>>b;\n\t\t\tret.push_back(v[b][a]);\n\t\t}\n\t\tcin>>W>>H>>N>>M;\n\t}\n\tfor(auto i:ret)cout<<i<<endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "//#include <bits/stdc++.h>\n//using namespace std;\n//const  int maxn=3e5+100;\n//#define INF 0x3f3f3f;\n//const int mod=998244353;\n//typedef  long long ll;\n//int ma[100][100];\n//int main()\n//{\n//    int n,m,t,q;\n//    while(scanf(\"%d%d%d%d\",&n,&m,&t,&q)){\n//        if(n==0 && m==0 && t==0 && q==0)  break;\n//        //cout<<n<<m<<t<<q;\n//        memset(ma,-1,sizeof(ma));\n//        for(int i=0; i<n; i++){\n//            for(int j=0; j<m; j++){\n//                ma[i][j] = 1;\n//            }\n//        }\n//        int x0 = 0,x1 = n-1;\n//        int y0 = 0,y1 = m-1;\n////        for(int i=0; i<=x1; i++){\n////            for(int j=0; j<=y1; j++){\n////                cout<<ma[i][j]<<\"  \";\n////            }\n////            cout<<endl;\n////        }\n//        int u,v;\n//        while(t--){\n//            scanf(\"%d%d\",&u,&v);\n//            if(u==1){\n//                v = v + x0;\n//                for(int i=v; i>x0; i--){\n//                    for(int j=y0; j<=y1; j++){\n//                        ma[v+i-1][j] += ma[v-i][j];\n//                        ma[v-i][j] = 0;\n//                    }\n//                }\n//                x0 = v;\n//            }\n//            else{\n//                v = v + y0;\n//                for(int i=v; i>y0; i--){\n//                    for(int j=x0; j<=x1; j++){\n//                        ma[j][v+i-1] += ma[j][v-i];\n//                        ma[j][v-i] = 0;\n//                    }\n//                }\n//                y0 = v;\n//            }\n//        }\n//        cout<<\"*\"<<x0<<\" \"<<x1<<\" \"<<y0<<\" \"<<y1<<endl;\n//        for(int i=0; i<=x1; i++){\n//            for(int j=0; j<=y1; j++){\n//                cout<<ma[i][j]<<\"  \";\n//            }\n//            cout<<endl;\n//        }\n//        while(q--){\n//            scanf(\"%d%d\",&u,&v);\n//            u = u + x0;\n//            v = v + y0;\n//            printf(\"%d\\n\",ma[u][v]);\n//        }\n//    }\n//    return 0;\n//}\n#include <iostream>\n#include <stdlib.h>\n#include <algorithm>\n#include <vector>\n#include <stdio.h>\nusing namespace std;\ntypedef long long ll;\nint n,m,t,p;\nint type,c;\nint main()\n{\n    while(~scanf(\"%d%d%d%d\",&m,&n,&t,&p)&&(m+n+t+p))\n    {\n        vector<vector<ll> >q(100);\n        for(int i=0; i<n; i++)\n        {\n            for(int j=0; j<m; j++)\n            {\n                q[i].push_back(1ll);\n            }\n        }\n        while(t--)\n        {\n            scanf(\"%d%d\",&type,&c);\n            if(type==1)\n            {\n                for(int j=0; j<n; j++)\n                {\n                    for(int i=0; i<=c-1; i++)\n                        q[j][2*c-1-i]+=q[j][i];\n                }\n                for(int i=0; i<n; i++)\n                    for(int j=0; j<m-c; j++)\n                        q[i][j]=q[i][j+c];\n            }\n            else if(type==2)\n            {\n                for(int j=0; j<m; j++)\n                    for(int i=0; i<=c-1; i++)\n                    {\n                        q[2*c-1-i][j]+=q[i][j];\n                    }\n                q.erase(q.begin(),q.begin()+c);\n            }\n        }\n        int x,y;\n        //ll ans=0;\n        while(p--)\n        {\n            scanf(\"%d%d\",&x,&y);\n            printf(\"%lld\\n\",q[y][x]);\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint main(){\n  while(1){\n    int n,m,t,p;\n    cin >> n >> m >> t >> p;\n\n    if(n==0){\n      break;\n    }\n\n    int o[64][64];\n    for(int y=0; y<64; y++){\n      for(int x=0; x<64; x++){\n        if(y<m && x<n){\n          o[y][x]=1;\n        }else{\n          o[y][x]=0;\n        }\n      }\n    }\n\n    for(int i=0; i<t; i++){\n      int d,c;\n      cin >> d >> c;\n\n      if(d==1){\n        for(int x=0; x<c; x++){\n          for(int y=0; y<m; y++){\n            o[y][2*c-1-x]+=o[y][x];\n            o[y][x]=0;\n          }\n        }\n        for(int x=0; x<n; x++){\n          for(int y=0; y<m; y++){\n            o[y][x]=o[y][x+c];\n            o[y][x+c]=0;\n          }\n        }\n\n      }else if(d==2){\n        for(int y=0; y<c; y++){\n          for(int x=0; x<n; x++){\n            o[2*c-1-y][x]+=o[y][x];\n            o[y][x]=0;\n          }\n        }\n        for(int y=0; y<m; y++){\n          for(int x=0; x<n; x++){\n            o[y][x]=o[y+c][x];\n            o[y+c][x]=0;\n          }\n        }\n      }\n    }\n\n    for(int i=0; i<p; i++){\n      int x,y;\n      cin >> x >> y;\n      cout << o[y][x] << endl;\n    }\n\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\n\nint n, m, t, p;\nint d, c, x, y;\nint mp[1000][1000];\nint xx, yy;\n\nint main(){\n\twhile(scanf(\"%d%d%d%d\", &n, &m, &t, &p)==4){\n\t\tif(!n&&!m&&!t&&!p)\n\t\t\tbreak;\n\t\tfor(int i = 1; i <= 999 ; i++){\n\t\t\tfor(int j = 1; j <= 999; j++){\n\t\t\t\tmp[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\tfor(int i = 1; i <= m; i++){\n\t\t\tfor(int j = 1; j <= n; j++){\n\t\t\t\tmp[i][j] = 1;\n\t\t\t}\n\t\t}\n\t\tint zuo = 1, xia = m;\n\t\tfor(int i = 1; i<= t; i++){\n\t\t\tscanf(\"%d%d\", &d, &c);\n\t\t\tif(d == 1){\n\t\t\t\tfor(int j = zuo + c; j <= zuo+2*c-1; j++){\n\t\t\t\t\tfor(int k = xia; k >= 1; k--){\n\t\t\t\t\t\tmp[k][j] += mp[k][j-c];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tzuo += c;\n\t\t\t}\n\t\t\telse if(d == 2){\n\t\t\t\tfor(int j = zuo; j < max(2*c+zuo, n+1); j++){\n\t\t\t\t\tfor(int k = xia-c; k > xia - 2*c; k--){\n\t\t\t\t\t\tmp[k][j] += mp[k+c][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\txia -= c;\n\t\t\t}\n\t\t}\n\t\t//printf(\"%d %d\\n\", zuo, xia);\n\t\tfor(int i = 1; i <= p; i++){\n\t\t\tscanf(\"%d%d\", &x, &y);\n\t\t\tprintf(\"%d\\n\", mp[xia-y][zuo+x]);\n\t\t}\n\t}\nreturn 0;\n} \n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define INF 1e18\n#define int long long\n#define Rep(i, a, n) for (int i = (a); i < (n); i++)\n#define rep(i, n) Rep(i, 0, n)\n#define all(a) (a).begin(), (a).end()\nusing namespace std;\ntypedef pair<int, int> P;\ntypedef pair<int, P> PP;\nconst int mod = 1000000007;\n//const int mod = 998244353;\n\nint w, h, t, p;\nint field[1000][1000];\n\nsigned main()\n{\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n\n    while (1)\n    {\n        cin >> w >> h >> t >> p;\n        if (w == 0)\n            break;\n        rep(i, 1000) rep(j, 1000) field[i][j] = 0;\n        rep(i, h) rep(j, w) field[i][j] = 1;\n        int oy = 0, ox = 0;\n        rep(i, t)\n        {\n            int d, c;\n            cin >> d >> c;\n            if (d == 1) //横\n            {\n                int l = ox + c - 1, r = ox + c;\n                rep(j, c)\n                {\n                    rep(k, 1000)\n                    {\n                        field[k][r + j] += field[k][l - j];\n                        field[k][l - j] = 0;\n                    }\n                }\n                ox += c;\n            }\n            else //縦\n            {\n                int l = oy + c - 1, r = oy + c;\n                rep(j, c)\n                {\n                    rep(k, 1000)\n                    {\n                        field[r + j][k] += field[l - j][k];\n                        field[l - j][k] = 0;\n                    }\n                }\n                oy += c;\n            }\n        }\n        rep(i, p)\n        {\n            int x, y;\n            cin >> x >> y;\n            cout << field[oy + y][ox + x] << endl;\n        }\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>   \nusing namespace std;      \nint main(){\n    while(true){\n        int n; int m; int t; int p;\n        cin >> n >> m >> t >> p;\n        if(n==0&&m==0&&t==0&&p==0)break;\n\n        int dc[t][2];\n        int xy[p][2];\n\n        for(int i=0;i<t;i++){\n            cin>>dc[i][0]>>dc[i][1];\n        }\n        for(int i=0;i<p;i++){\n            cin>>xy[i][0]>>xy[i][1];\n        }\n    int kasanari[n][m];\n\n    for(int i=0;i<n;i++){\n        for(int j=0;j<m;j++){\n            kasanari[i][j] = 1;\n        }\n    }\n\n    for(int i=0;i<t;i++){\n        int nw[n][m];\n        if(dc[i][0]==1){\n            for(int j=0;j<n;j++){\n                for(int k=0;k<m;k++){\n                    if(dc[i][1]-j-1<0){\n                        if(dc[i][1]+j>n-1){\n                            nw[j][k] = 0;\n                        }else{\n                            nw[j][k] = kasanari[dc[i][1]+j][k];\n                        }\n                    }\n                    else{\n                        if(dc[i][1]+j>n-1){\n                            nw[j][k] = kasanari[dc[i][1]-j-1][k];\n                        }\n                        else{nw[j][k] = kasanari[dc[i][1]-j-1][k] + kasanari[dc[i][1]+j][k];\n                            }\n                    }\n                }\n            }\n        }else{\n            for(int j=0;j<n;j++){\n                for(int k=0;k<m;k++){\n                    if(dc[i][1]-k-1<0){\n                        if(dc[i][1]+k>m-1){\n                            nw[j][k] = 0;\n                        }else{\n                            nw[j][k] = kasanari[j][dc[i][1]+k];\n                        }\n                    }\n                    else{\n                        if(dc[i][1]+k>m-1){\n                            nw[j][k] = kasanari[j][dc[i][1]-k-1];\n                        }else{\n                        nw[j][k] = kasanari[j][dc[i][1]-k-1] + kasanari[j][dc[i][1]+k];\n                        }\n                    }\n                }\n            }\n        }\n\n        for(int j=0;j<n;j++){\n            for(int k=0;k<m;k++){\n                kasanari[j][k] = nw[j][k];\n            }\n        }\n    }\n\n\n    for(int i=0;i<p;i++){\n        cout << kasanari[xy[i][0]][xy[i][1]] << endl;\n    }\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define FOR(i,a,b) for(int i = (a); i < (b); ++i)\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define all(x) (x).begin(),(x).end()\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v; return v;}\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector< vector<int> > Mat;\ntypedef tuple<int, int, int, int> T;\n\nconst int MOD = (int)1e9+7;\nconst int INF = (int)1e9;\nconst int dx[] = {0, 1, 0, -1};\nconst int dy[] = {1, 0, -1, 0};\nconst int ddx[] = {0, 1, 1, 1, 0, -1, -1, -1};\nconst int ddy[] = {1, 1, 0, -1, -1, -1, 0, 1};\n\nint main(){\n    ios::sync_with_stdio(false);\n\tcin.tie(0);\n\n    int n, m, t, p;\n    while(1){\n        cin >> n >> m >> t >> p;\n        if(n+m+t+p == 0) break;\n        vector< vector<int> > paper(m*2, vector<int>(n*2, 0));\n        int ox = 0, oy = 0, dx = n, dy = m;\n        rep(i, n) rep(j, m) paper[i][j] += 1;\n        \n\n        rep(i, t){\n            int d, c;\n            cin >> d >> c;\n            if(d == 1){\n                dx = max(dx, ox+(c+1)*2);\n                FOR(i, ox, ox+c){\n                    FOR(j, oy, dy) paper[j][c+i] += paper[j][i];\n                }\n                ox += c;\n            }else{\n                dy = max(dy, oy+(c+1)*2);\n                FOR(i, oy, oy+c){\n                    FOR(j, ox, dx) paper[c+i][j] += paper[i][j];\n                }\n                oy += c;\n            }\n        }\n\n        rep(i, p){\n            int x, y;\n            cin >> x >> y;\n            cout << paper[y+oy][x+ox] << endl;\n        }\n\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<deque>\n#include<queue>\n#include<vector>\n#include<algorithm>\n#include<iostream>\n#include<set>\n#include<cmath>\n#include<tuple>\n#include<string>\n#include<chrono>\n#include<functional>\n#include<iterator>\n#include<random>\n#include<unordered_set>\n#include<array>\n#include<map>\n#include<iomanip>\n#include<assert.h>\n#include<bitset>\n#include<stack>\n#include<memory>\nusing namespace std;\nusing namespace std::chrono;\ntypedef long long int llint;\ntypedef double lldo;\n#define mp make_pair\n#define mt make_tuple\n#define pub push_back\n#define puf push_front\n#define pob pop_back\n#define pof pop_front\n#define fir first\n#define sec second\n#define res resize\n#define ins insert\n#define era erase\n/*cout<<fixed<<setprecision(20);cin.tie(0);ios::sync_with_stdio(false);*/\nconst llint mod=998244353;\nconst llint big=2.19e17+1;\nconst long double pai=3.141592653589793238462643383279502884197;\nconst long double eps=1e-15;\ntemplate <class T,class U>bool mineq(T& a,U b){if(a>b){a=b;return true;}return false;}\ntemplate <class T,class U>bool maxeq(T& a,U b){if(a<b){a=b;return true;}return false;}\nllint gcd(llint a,llint b){if(a%b==0){return b;}else return gcd(b,a%b);}\nllint lcm(llint a,llint b){if(a==0){return b;}return a/gcd(a,b)*b;}\ntemplate<class T> void SO(T& ve){sort(ve.begin(),ve.end());}\ntemplate<class T> void REV(T& ve){reverse(ve.begin(),ve.end());}\ntemplate<class T>llint LBI(vector<T>&ar,T in){return lower_bound(ar.begin(),ar.end(),in)-ar.begin();}\ntemplate<class T>llint UBI(vector<T>&ar,T in){return upper_bound(ar.begin(),ar.end(),in)-ar.begin();}\n//  16:30-\n//A 16:36\nint solve(void){\n\tint n,m,t,p,i,wa=0,ans=0,x=0,y=0;cin>>n>>m>>t>>p;\n\tif(n==0){return 0;}\n\tint a[3000]={};\n\tint b[3000]={};\n\tfor(i=0;i<n;i++){a[i]=1;}\n\tfor(i=0;i<m;i++){b[i]=1;}\n\twhile(t--){\n\t\tint d,c;cin>>d>>c;\n\t\tif(d==1){\n\t\t\tfor(i=0;i<c;i++){a[c+c-1-i+x]+=a[i+x];}\n\t\t\tx+=c;\n\t\t}else{\n\t\t\tfor(i=0;i<c;i++){b[c+c-1-i+y]+=b[i+y];}\n\t\t\ty+=c;\n\t\t}\n\t}\n\twhile(p--){\n\t\tint xa,ya;cin>>xa>>ya;\n\t\txa+=x;ya+=y;\n\t\tcout<<a[xa]*b[ya]<<endl;\n\t}\n\treturn 1;\n}\nint main(void){\n\twhile(solve()){}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n,m,t,p,mm,nn;\nint memo[40][40];\nint d,c,x,y;\n\nint main(){\n  int i,j,a,ans;\n  while(1){\n    cin >> n >> m >> t >> p;\n    if(n+m+t+p==0)break;\n    nn = n;\n    mm = m;\n    ans = 0;\n    for(int i=0;i<40;++i)for(int j=0;j<40;++j)memo[i][j]=0;\n    for(i=0;i<m;i++)for(j=0;j<n;j++)memo[i][j]=1;\n    for(a=0;a<t;a++){\n\n      cin >> d >> c;\n      if(d==1){\n\tfor(i=0;i<mm;i++)for(j=0;j<c/2;j++){\n\t    swap(memo[i][j],memo[i][c-j-1]);\n\t  }\n\tif(nn-c>c/2)nn-=c;\n\telse nn = c;\n\tfor(i=0;i<mm;i++)for(j=0;j<nn;j++){\n\t    if(j<c)memo[i][j]+=memo[i][j+c];\n\t    else memo[i][j]=memo[i][j+c];\n\t  }\n      }\n      else{\n\tfor(i=0;i<c/2;i++)for(j=0;j<nn;j++){\n\t    swap(memo[i][j],memo[c-i-1][j]);\n\t  }\n\tif(mm-c>c/2)mm-=c;\n\telse mm = c;\n\tfor(i=0;i<mm;i++)for(j=0;j<nn;j++){\n\t    if(i<c)memo[i][j]+=memo[i+c][j];\n\t    else memo[i][j]=memo[i+c][j];\n\t  }\n      }\n      for(i=0;i<m;i++)for(j=0;j<n;j++)if(i>=mm||j>=nn)memo[i][j]=0;\n      /*for(i=0;i<m;i++){\n\tfor(j=0;j<n;j++)cout << memo[i][j]<<\" \";\n\tcout << endl;\n\t}\n\tcout << endl;*/\n\n    }\n    for(a=0;a<p;a++){\n      cin >> x >> y;\n      cout<<memo[y][x]<<endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n    while (1){\n        int n, m, t, p;\n        cin >> n >> m >> t >> p;\n        if (n == 0) break;\n        vector<vector<int>> paper(m, vector<int>(n, 1));\n        for (int i = 0; i < t; i++){\n            int d, c;\n            cin >> d >> c;\n            if (d == 1){\n                int nn = max(c, n - c);\n                vector<vector<int>> newpaper(m, vector<int>(nn, 0));\n                for (int x = 0; x < m; x++){\n                    for (int y = 0; y < nn; y++){\n                        if (0 <= y+c && y+c < n) newpaper[x][y] += paper[x][y+c];\n                        if (0 <= c-y-1 && c-y-1 < n) newpaper[x][y] += paper[x][c-y-1];\n                    }\n                }\n                paper = newpaper;\n                n = nn;\n\n            }\n            else{\n                int nm = max(c, m - c);\n                vector<vector<int>> newpaper(nm, vector<int>(n, 0));\n                for (int x = 0; x < nm; x++){\n                    for (int y = 0; y < n; y++){\n                        if (0 <= x+c && x+c < m) newpaper[x][y] += paper[x+c][y];\n                        if (0 <= c-x-1 && c-x-1 < m) newpaper[x][y] += paper[c-x-1][y];\n                    }\n                }\n                paper = newpaper;\n                m = nm;\n            }\n        }\n        for (int i = 0; i < p; i++){\n            int x, y;\n            cin >> x >> y;\n            cout << paper[y][x] << endl;\n        }\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define pb push_back\n#define all(x) x.begin(),x.end()\n#define dbg(x) cout<<#x<<\":\"<<x<<endl\n#define int long long\ntypedef pair<int,int> P;\ntypedef pair<int,P> PP;\n\nsigned main(){\n  int n,m,t,p;\n  while(1){\n    cin>>n>>m>>t>>p;\n    if(n+m+t+p==0)break;\n    int ma[400][400]={};\n    for(int i=0;i<m;i++){\n\t for(int j=0;j<n;j++){\n\t   ma[i][j]=1;\n\t }\n    }\n\n    int h=m;\n  \n    for(int i=0;i<t;i++){\n\n\t int d,c;\n\t cin>>d>>c;\n\t if(d==1){\n\n\t   for(int i=0;i<m;i++){\n\t\tfor(int j=0;j<c;j++){\n\t\t  ma[i][2*c-1-j]+=ma[i][j];\n\t\t  ma[i][j]=0;\n\t\t}\n\t   }\n\t \n\t }else{\n\n\t   h=max(c,h-c);\n\t \n\t   for(int i=0;i<n;i++){\n\t\tfor(int j=0;j<c;j++){\n\t\t  ma[2*c-1-j][i]+=ma[j][i];\n\t\t  ma[j][i]=0;\n\t\t}\n\t   }\n\t \n\t }\n    \n\t [&](){\n\t   for(int i=0;i<100;i++){\n\t\tfor(int j=0;j<100;j++){\n\t\t  if(ma[i][j]==0)continue;\n\t\t  for(int x=0;x<100;x++){\n\t\t    for(int y=0;y<100;y++){\n\t\t\t ma[x][y]=ma[i+x][j+y];\n\t\t\t ma[i+x][j+y]=0;\n\t\t    }\n\t\t  }\n\t\t  return;\n\t\t}\n\t   }\n\t }();\n\t /*\n\t   cout<<\"ma\"<<endl;\n\t   for(int i=0;i<m;i++){\n\t   for(int j=0;j<n;j++){\n\t   cout<<ma[i][j]<<\" \";\n\t   }\n\t   cout<<endl;\n\t   }\n\t //*/ \n    \n    }\n    //  dbg(h);\n    for(int i=0;i<p;i++){\n\t int x,y;\n\t cin>>x>>y;\n\t cout<<ma[y][x]<<endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<set>\n#include<map>\n#include<stack>\n\n#define MOD 10000000\nusing namespace std; \ntypedef long long LL;\n\nlong long quickpow(long long n, long long base) {\n    long long res = 1;\n    while(n) {\n        if(n & 1) {\n            res = res * base % MOD;\n        }\n        n >>= 1;\n        base = base * base % MOD;\n    }\n    return res;\n}//??? \n\nint ans[50];\nint A[100][100];\nint main()\n{\n\t  int n,m,t,p;\n\t  cin>>n>>m>>t>>p;\n\t  int d,c,x,y;\n\n      while(n!=0||m!=0||t!=0||p!=0)\n      {\n      \t  for(int i=1;i<=m;i++)\n      \t  for(int j=1;j<=n;j++)\n      \t  {\n  \t      \t A[i][j]=1;\n  \t      }\n  \t      for(int i=1;i<=t;i++)\n  \t      {\n      \t  \tcin>>d>>c;\n      \t  \t  if(d==1)\n      \t  \t  {\n\t  \t      \t  if(c<=(n/2))\n\t  \t      \t  {\n\t  \t      \t  \t   for(int i=1;i<=m;i++)\n  \t      \t  \t\t   for(int j=c+1;j<=(2*c);j++)\n  \t      \t  \t\t   A[i][j]+=A[i][(2*c)+1-j];\n   \t  \t\t           for(int i=1;i<=m;i++)\n  \t\t               for(int j=1;j<=(n-c);j++)\n  \t\t               A[i][j]=A[i][j+c];\n                       n-=c;\n  \t      \t  \t  }\n  \t      \t  \t  else\n  \t      \t  \t  {\n  \t  \t      \t  \t  for(int i=1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=c+1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]+=A[i][(2*c)+1-j];\n  \t  \t      \t  \t  for(int i=1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=c;j>=n-c+1;j--)\n  \t  \t      \t  \t  A[i][j]=A[i][j-(n-c)];\n  \t  \t      \t  \t  for(int i=1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n-c;j++)\n  \t  \t      \t  \t  A[i][j]=A[i][j+c];\n                      n=c;\n  \t      \t  \t  }\n  \t          }\n  \t          if(d==2)\n  \t          {\n\t  \t      \t  if(c<=(m/2))\n\t  \t      \t  {\n\t  \t      \t  \t   for(int i=c+1;i<=(2*c);i++)\n  \t      \t  \t\t   for(int j=1;j<=n;j++)\n  \t      \t  \t\t   A[i][j]+=A[(2*c)+1-i][j];\n   \t  \t\t           for(int i=1;i<=m-c;i++)\n  \t\t               for(int j=1;j<=n;j++)\n  \t\t               A[i][j]=A[i+c][j];\n                       m-=c;\n\n  \t      \t  \t  }\n  \t      \t  \t  else\n  \t      \t  \t  {\n  \t  \t      \t  \t  for(int i=c+1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]+=A[(2*c)+1-i][j];\n  \t  \t      \t  \t  for(int i=c;i>=m-c+1;i--)\n  \t  \t      \t  \t  for(int j=1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]=A[i-(m-c)][j];\n  \t  \t      \t  \t  for(int i=1;i<=m-c;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]=A[i+c][j];\n                      m=c;\n  \t      \t  \t  }\n          \t  }\n      \t  }\n      \t  int j=0;\n      \t  for(int i=1;i<=p;i++)\n      \t  {\n      \t  \tcin>>x>>y;\n  \t      \tans[++j]=A[y+1][x+1];\n  \t      }\n  \t      for(int i=1;i<=j;i++)\n  \t      {\n      \t  \tcout<<ans[i]<<endl;\n      \t  }\n      \t  cin>>n>>m>>t>>p;\n      }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n#define repl(i,a,b) for(int (i)=(int)(a);i<(int)(b);i++)\n#define rep(i,n) repl(i,0,n)\n\nvector<vector<ll>> fold(vector<vector<ll>> tile, pair<ll,ll> way){\n  ll dir = way.first;\n  ll dist = way.second;\n  if(dir==2){\n    int H = max(dist, (int)tile.size()-dist);\n    int W = tile[0].size();\n    vector<vector<ll>> res(H,vector<ll>(W,0));\n\n    rep(h,H)rep(w,W){\n      // way1\n      int tgth = dist - h - 1;\n      if(0<=tgth && tgth < tile.size()){\n        res[h][w]+=tile[tgth][w];\n      }\n      tgth = h+dist;\n      if(0<=tgth && tgth < tile.size()){\n        res[h][w]+=tile[tgth][w];\n      }\n    }\n    return res;\n  }\n  else{\n    int H = tile.size();\n    int W = max(dist, (int)tile[0].size()-dist);\n    vector<vector<ll>> res(H,vector<ll>(W,0));\n\n    rep(h,H)rep(w,W){\n      int tgtw = dist - w - 1;\n      if(0<=tgtw && tgtw < tile[0].size()){\n        res[h][w]+=tile[h][tgtw];\n      }\n      tgtw = w+dist;\n      if(0<=tgtw && tgtw < tile[0].size()){\n        res[h][w]+=tile[h][tgtw];\n      }\n    }\n    return res;\n  }\n}\n\nint main(){\n  while(1){\n    ll n,m,t,p;\n    cin>>n>>m>>t>>p;\n    if(n==0 && m==0)break;\n    vector<pair<ll,ll>> dc(t), xy(p);\n    rep(i,t)cin >> dc[i].first>>dc[i].second;\n    rep(i,p)cin>>xy[i].first>>xy[i].second;\n\n    vector<vector<ll>> tile(m,vector<ll>(n,1));\n    for(auto p:dc){\n      tile = fold(tile,p);\n    }\n    for(auto p:xy){\n      cout << tile[p.second][p.first] << endl;\n    }\n  }\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\n#define REP(i, n ,N) for(ll i = (n); i < (N); i++)\n#define p(s) cout<<(s)<<endl\n#define p2(a, b) cout<<(a)<<\" \"<<(b)<<endl\nusing namespace std;\ntypedef long long ll;\nll MOD = 1e9+7;\nll inf = 1e18;\n\n\nll N, M, T, P;\nll field[1010][1010];\nint main() {\n\twhile (cin >> N >> M >> T >> P && N > 0) {\n\t\tREP(i,0,1010){\n\t\t\tREP(j,0,1010){\n\t\t\t\tfield[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\tREP(i,0,M){\n\t\t\tREP(j,0,N){\n\t\t\t\tfield[i][j] = 1;\n\t\t\t}\n\t\t}\n\t\tll nx = 0;\n\t\tll ny = 0;\n\t\tREP(i, 0, T){\n\t\t\tll d, c;\n\t\t\tcin >> d >> c;\n\t\t\tif(d == 1){\n\t\t\t\tREP(x,nx,nx+c){\n\t\t\t\t\tREP(y,ny,1000){\n\t\t\t\t\t\tfield[y][nx+c+(nx+c-x-1)] += field[y][x];\n\t\t\t\t\t\tfield[y][x] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnx = nx+c;\n\t\t\t}else{\n\t\t\t\tREP(y,ny,ny+c){\n\t\t\t\t\tREP(x,nx,1000){\n\t\t\t\t\t\tfield[ny+c+(ny+c-y-1)][x] += field[y][x];\n\t\t\t\t\t\tfield[y][x] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tny = ny+c;\n\t\t\t}\n\t\t}\n\t\tREP(i,0,P){\n\t\t\tll x, y;\n\t\t\tcin >> x >> y;\n\t\t\tp(field[ny+y][nx+x]);\n\t\t}\n\t}\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int maxn=1000+7;\nint n,m,t,p;\nstruct node\n{\n    int x,y;\n}order[25];\nint pic[100][100];\nint main()\n{\n    while (scanf(\"%d%d%d%d\",&n,&m,&t,&p))\n    {\n        int nowx=n,nowy=m;\n        if(n==0&&m==0&&t==0&&p==0)\n            break;\n        memset(pic,0,sizeof(pic));\n        for(int i=0;i<m;i++)\n           for(int j=0;j<n;j++)\n              pic[i][j]=1;\n        //初始化\n        for(int i=1;i<=t;i++)\n            scanf(\"%d%d\",&order[i].x,&order[i].y);\n        for(int i=1;i<=t;i++) //处理指令\n        {\n            int d=order[i].x , c=order[i].y;\n            if(d==1)\n             {\n               //修改\n                for(int i=0;i<m;i++)\n                {\n                    for(int j=0;j<c;j++)\n                    {\n                        pic[i][2*c-1-j]+=pic[i][j];\n                    }\n                }\n                for(int i=0;i<m;i++)\n                    for(int j=0;j<n;j++)\n                       {\n                          pic[i][j]=pic[i][j+c];\n                       }\n             }\n            else\n              {\n                //修改\n                for(int j=0;j<n;j++)\n                {\n                    for(int i=0;i<c;i++)\n                    {\n                        pic[2*c-1-i][j]+=pic[i][j];\n                    }\n                }\n\n                for(int i=0;i<m;i++)\n                {\n                    for(int j=0;j<n;j++)\n                        {\n                            pic[i][j]=pic[i+c][j];\n                        }\n                }\n              }\n             /*\n              cout<<endl<<endl;\n            for(int i=0;i<m;i++)\n            {\n                for(int j=0;j<n;j++)\n                   cout<<pic[i][j]<<\" \";\n                cout<<endl;\n            }\n            cout<<endl<<endl;\n\n           */\n        }\n        for(int i=0;i<m;i++)\n           for(int j=0;j<n;j++)\n                {\n                    if(!pic[i][j])\n                        pic[i][j]=1;\n                }\n        for(int i=1;i<=p;i++)\n         {\n            int x,y;\n            scanf(\"%d%d\",&x,&y);\n               printf(\"%d\\n\",pic[y][x]);\n         }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nint s[35][35];\n\nsigned main(){\n  \n  while(1){\n    \n    int w, h, t, p;\n    cin>>w>>h>>t>>p;\n    \n    if( !w && !h && !t && !p ) break;\n    \n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++) s[i][j] = 1;\n    }\n    \n    while(t--){\n      \n      int d, c;\n      cin>>d>>c;\n      \n      int t[35][35] = {};\n                  \n      if( d == 1 ){\n\t\n\tfor(int i=0;i<h;i++){\n\t  \n\t  for(int j=0;j<c;j++){\n\t    \n\t    t[i][j] = s[i][c-j-1];\n\t    \n\t  }\n\t  \n\t}\n\t\n\tfor(int i=0;i<h;i++){\n\t  \n\t  for(int j=c;j<w;j++){\n\t    \n\t    t[i][j-c] += s[i][j];\n\t    \n\t  }\n\t  \n\t}\n\t\n\tw = max( c, w - c );\n\t\n\tfor(int i=0;i<h;i++){\n\t  for(int j=0;j<w;j++) s[i][j] = t[i][j];\n\t}\n\t\n      }\n      else{\n\t\n\tfor(int i=0;i<c;i++){\n\t  \n\t  for(int j=0;j<w;j++){\n\t    \n\t    t[i][j] = s[c-i-1][j];\n\t    \n\t  }\n\t  \n\t}\n\t\n\tfor(int i=c;i<h;i++){\n\t  \n\t  for(int j=0;j<w;j++){\n\t    \n\t    t[i-c][j] += s[i][j];\n\t    \n\t  }\n\t  \n\t}\n\t\n\th = max( c, h - c );\n\t\n\tfor(int i=0;i<h;i++){\n\t  for(int j=0;j<w;j++) s[i][j] = t[i][j];\n\t}\n\t\n      }      \n      \n    }\n    \n    while(p--){\n      \n      int x, y;\n      cin>>x>>y;\n      \n      cout<<s[y][x]<<endl;\n      \n    }\n    \n  }\n  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\nint main()\n{\n\twhile(1)\n\t{\n\t\tint n,m,t,p;\n\t\tcin>>n>>m>>t>>p;\n\t\tif(n==0)\n\t\t\tbreak;\n\t\tint kami[64][64];\n\t\tfill(kami[0],kami[64],0);\n\t\t//初期値を置く\n\t\tfor(int i=0;i<m;i++)\n\t\t{\n\t\t\tfor(int j=0;j<n;j++)\n\t\t\t\tkami[i][j]=1;\n\t\t}\n\t\tint l=0;//現在の左のインデックス\n\t\tint u=0;//現在の上のインデックス\n\t\tint oru[20][2];\n\t\tfor(int i=0;i<t;i++)\n\t\t\tcin>>oru[i][0]>>oru[i][1];\n\t\tint ana[20][2];\n\t\tfor(int i=0;i<p;i++)\n\t\t\tcin>>ana[i][0]>>ana[i][1];\n\t\t\n\t\t//実際に折る\n\t\tfor(int i=0;i<t;i++)\n\t\t{\n\t\t\t//左側に折る\n\t\t\tif(oru[i][0]==1)\n\t\t\t{\n\t\t\t\tl=l+oru[i][1];\n\t\t\t\tfor(int i=0;i<l;i++)\n\t\t\t\t{\n\t\t\t\t\tfor(int j=0;j<64;j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tkami[j][l+i]+=kami[j][l-i-1];\n\t\t\t\t\t\tkami[j][l-i-1]=0;//折り終わったところにはもう何もない\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//横にずらす\n\t\t\t\tfor(int i=l;i<64;i++)\n\t\t\t\t{\n\t\t\t\t\tfor(int j=0;j<64;j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tkami[j][i-l]=kami[j][i];\n\t\t\t\t\t\tkami[j][i]=0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tl=0;\n\t\t\t}else{\n\t\t\t\t//下に折る（実際には上）\n\t\t\t\tu=u+oru[i][1];\n\t\t\t\tfor(int i=0;i<u;i++)\n\t\t\t\t{\n\t\t\t\t\tfor(int j=0;j<64;j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tkami[u+i][j]+=kami[u-i-1][j];\n\t\t\t\t\t\tkami[u-i-1][j]=0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//縦にずらす\n\t\t\t\tfor(int i=u;i<64;i++)\n\t\t\t\t{\n\t\t\t\t\tfor(int j=0;j<64;j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tkami[i-u][j]=kami[i][j];\n\t\t\t\t\t\tkami[i][j]=0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tu=0;\n\t\t\t}\n\t\t\t//for debug\n\t\t\t/*\n\t\t\tfor(int j=0;j<m;j++)\n\t\t\t{\n\t\t\t\tfor(int k=0;k<n;k++)\n\t\t\t\t\tcout<<kami[j][k]<<\" \";\n\t\t\t\tcout<<endl;\n\t\t\t}\n\t\t\tcout<<endl;\n\t\t\t*/\n\t\t}\n\n\t\t//穴を開ける\n\t\tfor(int i=0;i<p;i++)\n\t\t\tcout<<kami[u+ana[i][1]][l+ana[i][0]]<<endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n,m,t,p,d,c,ls=0,bs=0,rs,us,x,y;\nvector<int> ans;\nint main(){\n    for(int i=0;i<1000;i++){\n        scanf(\"%d%d%d%d\",&n,&m,&t,&p);\n        if(n==0&&m==0&&t==0&&p==0)break;\n\n        vector<int> hline(n,1);\n        vector<int> vline(m,1);\n\n        for(int k=0;k<t;k++){\n            scanf(\"%d%d\",&d,&c);\n            if(d==1){\n                vector<int> hl(n,0);\n                int cnt=max(c,n-c);\n                for(int l=0;l<cnt;l++)\n                    hl[l]=(  (c-l-1<0)? 0 : hline[c-l-1] )+( (c+l>=n)?0:hline[c+l] );\n                for(int l=0;l<n;l++)\n                    hline[l]=hl[l];\n            }else{\n                vector<int> vl(m,0);\n                int cnt=max(c,m-c);\n                for(int l=0;l<cnt;l++)\n                    vl[l]= ( (c-l-1<0)? 0 : vline[c-l-1] )+( (c+l>=m)?0:vline[c+l] );\n                for(int l=0;l<m;l++)\n                    vline[l]=vl[l];\n            }\n        }\n        for(int k=0;k<p;k++){\n            scanf(\"%d%d\",&x,&y);\n            ans.push_back(hline[x]*vline[y]);\n        }\n    }\n    for(int i=0;i<ans.size();i++){\n        printf(\"%d\\n\",ans[i]);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<b;i++)\n#define rrep(i,a,b) for(int i=a;i>=b;i--)\n#define fore(i,a) for(auto &i:a)\n#define all(x) (x).begin(),(x).end()\nusing namespace std; void _main(); int main() { cin.tie(0); ios::sync_with_stdio(false); _main(); }\ntypedef long long ll; const int inf = INT_MAX / 2; const ll infl = 1LL << 60;\ntemplate<class T>bool chmax(T &a, const T &b) { if (a<b) { a = b; return 1; } return 0; }\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a = b; return 1; } return 0; }\n//---------------------------------------------------------------------------------------------------\n/*---------------------------------------------------------------------------------------------------\n　　　　　　　　　　　 ∧＿∧  \n　　　　　 ∧＿∧ 　（´<_｀ ）　 Welcome to My Coding Space!\n　　　　 （ ´_ゝ`）　/　 ⌒i     \n　　　　／　　　＼　 　  |　|     \n　　　 /　　 /￣￣￣￣/　　|  \n　 ＿_(__ﾆつ/　    ＿/ .| .|＿＿＿＿  \n　 　　　＼/＿＿＿＿/　（u　⊃  \n---------------------------------------------------------------------------------------------------*/\n\n\n\n\nint W, H, T, P;\nint A[2][101][101];\n//---------------------------------------------------------------------------------------------------\nvoid _main() {\n    while (cin >> W >> H >> T >> P) {\n        if (W == 0) return;\n        \n        rep(t, 0, 2) rep(y, 0, 101) rep(x, 0, 101) A[t][y][x] = 0;\n        rep(y, 0, H) rep(x, 0, W) A[0][y][x] = 1;\n\n        rep(t, 0, T) {\n            int d, c; cin >> d >> c;\n            rep(y, 0, 101) rep(x, 0, 101) A[(t + 1) % 2][y][x] = 0;\n\n            if (d == 1) {\n                rep(y, 0, H) rep(x, 0, W) A[(t + 1) % 2][y][x] = A[t % 2][y][x + c];\n                rep(x, 0, c) rep(y, 0, H) A[(t + 1) % 2][y][x] += A[t % 2][y][c - 1 - x];\n            } else {\n                rep(y, 0, H) rep(x, 0, W) A[(t + 1) % 2][y][x] = A[t % 2][y + c][x];\n                rep(x, 0, W) rep(y, 0, c) A[(t + 1) % 2][y][x] += A[t % 2][c - 1 - y][x];\n            }\n        }\n\n        rep(p, 0, P) {\n            int x, y; cin >> x >> y;\n            printf(\"%d\\n\", A[T % 2][y][x]);\n        }\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define ARC(i, a, b) for(int i = (a); i < (b); ++i)\n#define RC(i, n) ARC(i, 0, n)\n#define ARCH(i, a, b) for(int i = (a) - 1; i >= (b); --i)\n#define RCH(i, n) ARCH(i, n, 0)\n\ntemplate<typename T> T ant(const T &a, const T &b){ return a > b ? a : b; }\ntemplate<typename T> T ont(const T &a, const T &b){ return a < b ? a : b; }\ntemplate<typename T> T rng(const T &a, const T &b){ return a > b ? a - b : b - a; }\ntemplate<typename T> T &anth(T &a, const T &b){ return a = ant(a, b); }\ntemplate<typename T> T &onth(T &a, const T &b){ return a = ont(a, b); }\n\ntemplate<typename T> T make_v(T val){ return val; }\ntemplate<typename... Ts> auto make_v(size_t n, Ts... ts){ return std::vector<decltype(make_v(ts...))>(n, make_v(ts...)); }\n\nint solve(){\n\tint n, m, t, p;\n\tscanf(\"%d%d%d%d\", &n, &m, &t, &p);\n\tif(!n && !m && !t && !p) return 0;\n\t\n\tint paper[30][100][100] = {};\n\tRC(i, n) RC(j, m) paper[0][i][j] = 1;\n\n\tRC(i, t){\n\t\tint d, c;\n\t\tscanf(\"%d%d\", &d, &c);\n\t\tif(d == 1){\n\t\t\tRC(j, n) RC(k, m) paper[i + 1][j < c ? c - j - 1 : j - c][k] += paper[i][j][k];\n\t\t\tn = ant(c, n - c);\n\t\t}else{\n\t\t\tRC(j, n) RC(k, m) paper[i + 1][j][k < c ? c - k - 1 : k - c] += paper[i][j][k];\n\t\t\tm = ant(c, m - c);\n\t\t}\n\t}\n\n\t//RCH(i, m){ RC(j, n) printf(\"%d \", paper[t&1][j][i]); putchar('\\n'); }\n\n\tRC(i, p){\n\t\tint x, y;\n\t\tscanf(\"%d%d\", &x, &y);\n\t\tprintf(\"%d\\n\", paper[t][x][y]);\n\t}\n\n\treturn 1;\n}\n\nint main(){\n\twhile(solve());\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint a[1000][1000];\n\nint main()\n{\n\tint n, m, t, p;\n\twhile (cin >> n >> m >> t >> p, n | m | t | p) {\n\t\tint xl = 0, xr = n, yl = 0, yr = m;\n\t\tfor (int i = xl; i < xr; i++) {\n\t\t\tfor (int j = yl; j < yr; j++) {\n\t\t\t\ta[i][j] = 1;\n\t\t\t}\n\t\t}\n\t\tfor (int i = 0; i < t; i++) {\n\t\t\tint d, c;\n\t\t\tcin >> d >> c;\n\t\t\tif (d == 1) {\n\t\t\t\tfor (int j = 0; j < c; j++) {\n\t\t\t\t\tfor (int y = yl; y < yr; y++) {\n\t\t\t\t\t\ta[xl + c * 2 - 1 - j][y] += a[xl + j][y];\n\t\t\t\t\t\ta[xl + j][y] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\txr = max(xr, xl + c * 2);\n\t\t\t\txl += c;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (int x = xl; x < xr; x++) {\n\t\t\t\t\tfor (int j = 0; j < c; j++) {\n\t\t\t\t\t\ta[x][yl + c * 2 - 1 - j] += a[x][yl + j];\n\t\t\t\t\t\ta[x][yl + j] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tyr = max(yr, yl + c * 2);\n\t\t\t\tyl += c;\n\t\t\t}\n\t\t}\n\t\twhile (p--) {\n\t\t\tint x, y;\n\t\t\tcin >> x >> y;\n\t\t\tprintf(\"%d\\n\", a[xl + x][yl + y]);\n\t\t}\n\t\tfor (int i = xl; i < xr; i++) {\n\t\t\tfor (int j = yl; j < yr; j++) {\n\t\t\t\ta[i][j] = 0;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\n#include<bitset>\n#include<stack>\n#include<unordered_map>\n#include<utility>\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int ui;\nconst ll mod = 1000000007;\ntypedef long double ld;\nconst ll INF = 1e+14;\ntypedef pair<int, int> P;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef complex<ld> Point;\nconst ld eps = 1e-8;\nconst ld pi = acos(-1.0);\ntypedef pair<ld, ld> LDP;\ntypedef pair<ll, ll> LP;\n#define fr first\n#define sc second\n#define all(c) c.begin(),c.end()\n#define pb push_back\n\nvoid Yes(){\n\tcout<<\"Yes\"<<endl;\n\texit(0);\n}\n \nvoid No(){\n\tcout<<\"No\"<<endl;\n\texit(0);\n}\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n    int n, m, t, p;\n    //int cnt[661][661];\n    for(;;) {\n        cin >> n >> m >> t >> p;\n        vector<vector<int>> cnt(1000,vector<int>(1000,0));\n        if(n == 0 && m == 0 && t == 0 && p == 0) return 0;\n        rep(i, m) {\n            rep(j, n) {         \n                cnt[i][j] = 1;\n            }\n        }\n        /*\n        for(int i = m; i <= 660 ; i++) {\n            for(int j = n; j <= 660; j++) {\n                cnt[i][j] = 0;\n            }\n        }\n        */\n        int a = -1, b = -1;\n        rep(i, t) {\n            int d, c; cin >> d >> c;\n            if(d == 2) {\n                a += c;\n                int l = a;\n                for(int k = a; k >= 0; k--) {\n                    l ++;\n                    rep(j, 600) {\n                        cnt[l][j] += cnt[k][j];\n                        cnt[k][j] = 0;\n                    }\n                }\n            } if(d == 1) {\n                b += c;\n                int l = b;\n                for(int k = b; k >= 0; k--) {\n                    l ++;\n                    rep(j, 600) {\n                        cnt[j][l] += cnt[j][k];\n                        cnt[j][k] = 0;\n                    }\n                }\n            }\n        }\n        rep(j, p) {\n            int x, y; cin >> x >> y;\n            cout << cnt[y  + a + 1][x + b + 1] << endl;\n        }\n       \n        /*rep(i, m) {\n            rep(j, n) {\n                cout << cnt[i + a + 1][j + b + 1] << \" \";\n            }\n            cout << endl;\n        }\n        */\n        \n    }\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define LL long long\nusing namespace std;\nint d[50],c[50],x[50],y[50],a[35][35],cc[35][35],m,n;\nvoid fan(int x1,int y1,int f)\n{\n    int b[35][35],i,j;\n    if(f==1)\n    {\n        for(i=1;i<=y1;i++)\n            for(j=1;j<=x1;j++)\n            b[i][j]=a[i][x1-j+1];\n        for(i=1;i<=y1;i++)\n            for(j=1;j<=x1;j++)\n            a[i][j]=b[i][j];\n    }\n    else\n    {\n        for(i=1;i<=y1;i++)\n            for(j=1;j<=x1;j++)\n            b[i][j]=a[y1-i+1][j];\n        for(i=1;i<=y1;i++)\n            for(j=1;j<=x1;j++)\n            a[i][j]=b[i][j];\n    }\n\n\n}\nint main()\n{\n    int i,j,k,all,q,p,w,u,l,r,ans,t;\n    scanf(\"%d %d %d %d\",&n,&m,&t,&p);\n    while(n!=0&&m!=0&&t!=0&&p!=0)\n    {\n        w=n;u=m;l=r=0;ans=0;\n        for(i=1;i<=m;i++)\n            for(j=1;j<=n;j++)\n            a[i][j]=1;\n        for(i=1;i<=t;i++)\n        {\n            scanf(\"%d%d\",&d[i],&c[i]);\n        }\n        for(i=1;i<=p;i++)\n        {\n            scanf(\"%d%d\",&x[i],&y[i]);\n        }\n        for(i=1;i<=t;i++)\n        {\n            if(d[i]==1)\n            {\n                if(c[i]<=w/2)\n                {\n                    for(j=1;j<=c[i];j++)\n                        for(k=1;k<=u;k++)\n                    {\n                        cc[k][j]=a[k][j+c[i]]+a[k][c[i]-j+1];\n                    }\n                    for(j=1;j<=c[i];j++)\n                        for(k=1;k<=u;k++)\n                            a[k][j]=cc[k][j];\n                    w-=c[i];\n                    for(j=c[i]+1;j<=w;j++)\n                        for(k=1;k<=u;k++)\n                            a[k][j]=a[k][j+c[i]];\n                }\n                else\n                {\n                    for(j=1;j<=w-c[i];j++)\n                         for(k=1;k<=u;k++)\n                         cc[k][c[i]-j+1]=a[k][j+c[i]]+a[k][c[i]-j+1];\n                        for(j=1;j<=w-c[i];j++)\n                         for(k=1;k<=u;k++)\n                            a[k][c[i]-j+1]=cc[k][c[i]-j+1];\n                    w=c[i];\n                    fan(w,u,1);\n                }\n\n            }\n\n            if(d[i]==2)\n            {\n                if(c[i]<=u/2)\n                {\n                    for(j=1;j<=c[i];j++)\n                        for(k=1;k<=w;k++)\n                    {\n                        cc[j][k]=a[j+c[i]][k]+a[c[i]-j+1][k];\n                    }\n                    for(j=1;j<=c[i];j++)\n                        for(k=1;k<=w;k++)\n                            a[j][k]=cc[j][k];\n                    u-=c[i];\n                }\n                else\n                {\n                    for(j=1;j<=u-c[i];j++)\n                        for(k=1;k<=w;k++)\n                        {cc[c[i]-j+1][k]=a[c[i]-j+1][k]+a[c[i]+j][k];\n                        }\n                    for(j=1;j<=u-c[i];j++)\n                        for(k=1;k<=w;k++)\n                            a[c[i]-j+1][k]=cc[c[i]-j+1][k];\n                    u=c[i];\n                   fan(w,u,2);\n                }\n\n            }\n            /*for(k=1;k<=m;k++)\n            {for(j=1;j<=n;j++)\n            printf(\"%d \",a[k][j]);\n            printf(\"\\n\");\n            }\n            printf(\"\\n\");*/\n\n        }\n        /*for(i=1;i<=m;i++)\n            {for(j=1;j<=n;j++)\n            printf(\"%d \",a[i][j]);\n            printf(\"\\n\");\n            }*/\n        for(i=1;i<=p;i++)\n            {ans=a[y[i]+1][x[i]+1];\n        printf(\"%d\\n\",ans);}\n        scanf(\"%d%d%d%d\",&n,&m,&t,&p);\n        }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\nusing namespace std;\nint n,m,t,p;\nint main()\n{\n    for(;;)\n    {\n        int a[35][35],x[1000],y[1000];\n        scanf(\"%d %d %d %d\",&n,&m,&t,&p);\n        if(n==0&&m==0&&t==0&&p==0)break;\n        for(int i=0;i<33;i++)\n            for(int j=0;j<33;j++)\n            a[j][i]=1;\n        for(int i=0;i<t;i++)\n        {\n            int d,c;\n            scanf(\"%d %d\",&d,&c);\n            if(d==1)\n            {\n                int z[35][35];\n                if(c<=n/2)\n                {\n                    for(int j=c-1;j>=0;j--)\n                        for(int k=0;k<m;k++)\n                    {\n                        z[k][j]=a[k][c-j-1]+a[k][c+j];\n                    }\n                    for(int j=c-1;j>=0;j--)\n                        for(int k=0;k<m;k++)\n                        a[k][j]=z[k][j];\n                    for(int j=c;j<n-c;j++)\n                        for(int k=0;k<m;k++)\n                        a[k][j]=a[k][j+c];\n                    n=n-c;\n                }\n                else\n                {\n                    for(int j=0;j<n-c;j++)\n                        for(int k=0;k<m;k++)\n                        z[k][c-j-1]=a[k][j];\n                    for(int j=n-c-1;j>=0;j--)\n                        for(int k=0;k<m;k++)\n                    {\n                        z[k][j]=a[k][c-j-1]+a[k][c+j];\n                    }\n                    for(int j=0;j<c;j++)\n                        for(int k=0;k<m;k++)\n                        a[k][j]=z[k][j];\n                    n=c;\n                }\n            }\n            else if(d==2)\n            {\n                int z[35][35];\n                if(c>=m/2+1)\n                {\n                    for(int j=2*c-m;j<c;j++)\n                        for(int k=0;k<n;k++)\n                    {\n                        a[j][k]=a[j][k]+a[2*c-j-1][k];\n                    }\n                    m=c;\n                }\n                else\n                {\n                    for(int j=m-2*c;j<m-c;j++)\n                        for(int k=0;k<n;k++)\n                    {\n                        z[j][k]=a[j+2*c-m][k]+a[m-j-1][k];\n                    }\n                    for(int j=0;j<m-2*c;j++)\n                        for(int k=0;k<n;k++)\n                        z[j][k]=a[m-j-1][k];\n                    for(int j=0;j<m-c;j++)\n                        for(int k=0;k<n;k++)\n                    {\n                        a[j][k]=z[j][k];\n                    }\n                    m=m-c;\n                }\n            }\n        }\n        for(int i=0;i<p;i++)\n        {\n            scanf(\"%d %d\",&x[i],&y[i]);\n        }\n        for(int i=0;i<p;i++)\n        {\n            printf(\"%d\\n\",a[m-1-y[i]][x[i]]);\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "//tempa\n//#pragma GCC optimize (\"-O3\")\n#ifdef _DEBUG\n#include<cassert>\n#include \"bits_stdc++.h\"\n#else\n#include <bits/stdc++.h>\n#endif\n\n#define t_T template<class T>\n\nusing namespace std;\n//@起動時\nstruct initon {\n    initon() {\n        cin.tie(0);\n        ios::sync_with_stdio(false);\n        cout.setf(ios::fixed);\n        cout.precision(3);\n        srand((unsigned) clock() + (unsigned) time(NULL));\n    };\n} __initon;\n//衝突対策\n#define ws ___ws\n#define over4(o1, o2, o3, o4, name, ...) name\n\n#define int long long\n#define ll long long\n#define double long double\n#define ull unsigned long long\nusing dou = double;\nusing itn = int;\nusing str = string;\nusing bo= bool;\n#define au auto\nusing P = pair<ll, ll>;\n\n#define fi first\n#define se second\n#define vec vector\n#define beg begin\n#define rbeg rbegin\n#define con continue\n#define bre break\n#define brk break\n#define is ==\nusing vi = vector<ll>;\nusing vb = vector<bool>;\nusing vs = vector<string>;\nusing vd = vector<double>;\nusing vc = vector<char>;\nusing vp = vector<P>;\n\n//#define V vector\n#define vvt0(t) vector<vector<t>>\n#define vvt1(t, a) vector<vector<t>>a\n#define vvt2(t, a, b) vector<vector<t>>a(b)\n#define vvt3(t, a, b, c) vector<vector<t>> a(b,vector<t>(c))\n#define vvt4(t, a, b, c, d) vector<vector<t>> a(b,vector<t>(c,d))\n\n#define vvi(...) over4(__VA_ARGS__,vvt4,vvt3,vvt2 ,vvt1,vvt0)(ll,__VA_ARGS__)\n#define vvb(...) over4(__VA_ARGS__,vvt4,vvt3,vvt2 ,vvt1,vvt0)(bool,__VA_ARGS__)\n#define vvs(...) over4(__VA_ARGS__,vvt4,vvt3,vvt2 ,vvt1,vvt0)(string,__VA_ARGS__)\n#define vvd(...) over4(__VA_ARGS__,vvt4,vvt3,vvt2 ,vvt1,vvt0)(double,__VA_ARGS__)\n#define vvc(...) over4(__VA_ARGS__,vvt4,vvt3,vvt2 ,vvt1,vvt0)(char,__VA_ARGS__)\n#define vvp(...) over4(__VA_ARGS__,vvt4,vvt3,vvt2 ,vvt1,vvt0)(P,__VA_ARGS__)\n\n\n#define v3i(a, b, c, d) vector<vector<vi>> a(b, vector<vi>(c, vi(d)))\n#define v3d(a, b, c, d) vector<vector<vd>> a(b, vector<vd>(c, vd(d)))\n#define v3m(a, b, c, d) vector<vector<vm>> a(b, vector<vm>(c, vm(d)))\n\n\n#define PQ priority_queue<ll, vector<ll>, greater<ll> >\n#define tos to_string\n\nusing mapi = map<int, int>;\nusing mapd = map<dou, int>;\nusing mapc = map<char, int>;\nusing maps = map<str, int>;\nusing seti = set<int>;\nusing setd = set<dou>;\nusing setc = set<char>;\nusing sets = set<str>;\nusing qui = queue<int>;\n#define bset bitset\n#define uset unordered_set\n#define mset multiset\n#define umap unordered_map\n#define umapi unordered_map<int,int>\n#define umapp unordered_map<P,int>\n#define mmap multimap\n\n//マクロ 繰り返し\n#define _overloadrep(_1, _2, _3, _4, name, ...) name\n# define _rep(i, n) for(int i = 0,_lim=n; i < _lim ; i++)\n#define repi(i, m, n) for(int i = m,_lim=n; i < _lim ; i++)\n#define repadd(i, m, n, ad) for(int i = m,_lim=n; i < _lim ; i+= ad)\n#define rep(...) _overloadrep(__VA_ARGS__,repadd,repi,_rep,)(__VA_ARGS__)\n#define _rer(i, n) for(int i = n; i >= 0 ; i--)\n#define reri(i, m, n) for(int i = m,_lim=n; i >= _lim ; i--)\n#define rerdec(i, m, n, dec) for(int i = m,_lim=n; i >= _lim ; i-=dec)\n#define rer(...) _overloadrep(__VA_ARGS__,rerdec,reri,_rer,)(__VA_ARGS__)\n#define fora(a, b) for(auto&& a : b)\n\n//マクロ 定数\n#define k3 1010\n#define k4 10101\n#define k5 101010\n#define k6 1010101\n#define k7 10101010\n\nt_T T MAX() { return numeric_limits<T>::max(); }\nt_T T MIN() { return numeric_limits<T>::min(); }\nconst int inf = (int) 1e9 + 100;\nconst ll linf = (ll) 1e18 + 100;\nt_T T INF() { return MAX<T>() / 2; }\ntemplate<> signed INF() { return inf; }\ntemplate<> ll INF() { return linf; }\ntemplate<> double INF() { return (double) linf * linf; }\n\nconst double eps = 1e-9;\nconst double PI = 3.1415926535897932384626433832795029L;\nll ma = numeric_limits<ll>::min();\nll mi = numeric_limits<ll>::max();\nconst int y4[] = {-1, 1, 0, 0};\nconst int x4[] = {0, 0, -1, 1};\nconst int y8[] = {0, 1, 0, -1, -1, 1, 1, -1};\nconst int x8[] = {1, 0, -1, 0, 1, -1, 1, -1};\n\n//マクロ省略形 関数等\n#define sz(a) ((int)(a).size())\n#define rs resize\n#define mp make_pair\n#define mt make_tuple\n#define pb push_back\n#define pf push_front\n#define eb emplace_back\n#define all(a) (a).begin(),(a).end()\n#define rall(a) (a).rbegin(),(a).rend()\n\n/*@formatter:off*/\ninline void sort(string &a) { sort(all(a)); }\nt_T inline void sort(vector<T> &a) { sort(all(a)); };\nt_T inline void rsort(vector<T> &a) { sort(all(a), greater<T>()); };\ntemplate<class U> inline void sortp(vector<U> &a, vector<U> &b) {    vp c;    int n = sz(a);    assert(n == sz(b));    rep(i, n)c.eb(a[i], b[i]);    sort(c);    rep(i, n) {        a[i] = c[i].first;        b[i] = c[i].second;;    }};//F = T<T>\n//例えばreturn p.fi + p.se;\ntemplate<class U> inline void rsortp(vector<U> &a, vector<U> &b) {    vp c;    int n = sz(a);    assert(n == sz(b));    rep(i, n)c.eb(a[i], b[i]);    rsort(c);    rep(i, n) {        a[i] = c[i].first;        b[i] = c[i].second;    }};\ntemplate<typename V, typename T>\nvoid fill(V &xx, const T vall) {xx = vall;}\ntemplate<typename V, typename T>\nvoid fill(vector<V> &vecc, const T vall) {for (auto &&vx: vecc) fill(vx, vall);}\n\n//@汎用便利関数 入力\ntemplate<typename T = int> T _in() {T x;cin >> x;return (x);}\n#define _overloadin(_1, _2, _3, _4, name, ...) name\n#define in0() _in()\n#define in1(a) cin>>a\n#define in2(a, b) cin>>a>>b\n#define in3(a, b, c) cin>>a>>b>>c\n#define in4(a, b, c, d) cin>>a>>b>>c>>d\n#define in(...) _overloadin(__VA_ARGS__,in4,in3,in2 ,in1,in0)(__VA_ARGS__)\n\n#define _overloaddin(_1, _2, _3, _4, name, ...) name\n#define din1(a) int a;cin>>a\n#define din2(a, b) int a,b;cin>>a>>b\n#define din3(a, b, c) int a,b,c;cin>>a>>b>>c\n#define din4(a, b, c, d) int a,b,c,d;cin>>a>>b>>c>>d\n#define din(...) _overloadin(__VA_ARGS__,din4,din3,din2 ,din1)(__VA_ARGS__)\n\n#define _overloaddind(_1, _2, _3, _4, name, ...) name\n#define din1d(a) int a;cin>>a;a--\n#define din2d(a, b) int a,b;cin>>a>>b;a--,b--\n#define din3d(a, b, c) int a,b,c;cin>>a>>b>>c;a--,b--,c--\n#define din4d(a, b, c, d) int a,b,c,d;cin>>a>>b>>c>>d;;a--,b--,c--,d--\n#define dind(...) _overloaddind(__VA_ARGS__,din4d,din3d,din2d ,din1d)(__VA_ARGS__)\ntemplate<typename W, typename H> void resize(W &vec_, const H head) { vec_.resize(head); }\ntemplate<typename W, typename H, typename ... T> void resize(W &vec_, const H &head, const T ... tail) {vec_.resize(head);for (auto &v: vec_)resize(v, tail...);}\n\n\nstring sin() { return _in<string>(); }\nll lin() { return _in<ll>(); }\nt_T void na(vector<T> &a, ll n) {a.resize(n);rep(i, n)cin >> a[i];}\n#define dna(a, n) vi a; na(a, n);/*nを複数使うと n==in()の時バグる事に注意*/\n#define dnad(a, n) vi a; nad(a, n);\nt_T void nad(vector<T> &a, ll n) {a.resize(n);rep(i, n)cin >> a[i], a[i]--;}\ntemplate<class T, class U> void na2(vector<T> &a, vector<U> &b, ll n) {a.resize(n);b.resize(n);rep(i, n)cin >> a[i] >> b[i];}\n#define dna2(a, b, n) vi a,b; na2(a,b,n);\ntemplate<class T, class U, class W> void na3(vector<T> &a, vector<U> &b, vector<W> &c, ll n) {a.resize(n);b.resize(n);c.resize(n);rep(i, n)cin >> a[i] >> b[i] >> c[i];}\n#define nt(a, h, w) resize(a,h,w);rep(nthi,h)rep(ntwi,w) cin >> a[nthi][ntwi];\n#define ntd(a, h, w) resize(a,h,w);rep(ntdhi,h)rep(ntdwi,w) cin >> a[ntdhi][ntdwi], a[ntdhi][ntdwi]--;\n#define ntp(a, h, w) resize(a,h+2,w+2);fill(a,'#');rep(ntphi,1,h+1)rep(ntpwi,1,w+1) cin >> a[ntphi][ntpwi];\n#define dnt(S, h, w) vvi(S,h,w);nt(S,h,w);\n#define dntc(S, h, w) vvc(S,h,w);nt(S,h,w);\n#define dnts(S, h, w) vvs(S,h,w);nt(S,h,w);\n\n//デバッグ\n#define sp << \" \" <<\nconstexpr int DEB_LEN =20;\nconstexpr int DEB_LEN_H =12;\nstring deb_tos(const int &v) { if (abs(v) == inf || abs(v) == linf)return \"e\"; else return to_string(v); }\ntemplate<class T> string deb_tos(const T &a) {stringstream ss;ss << a;return ss.str();}\ntemplate<class T> string deb_tos(const vector<T> &a, ll W = inf) {    stringstream ss;    if (W == inf)W = min(sz(a), DEB_LEN);    if (sz(a) == 0)return ss.str();    rep(i, W) {        ss << deb_tos(a[i]);        if (typeid(a[i]) == typeid(P)) { ss << endl; } else { ss << \" \"; }    }    return ss.str();}\ntemplate<class T> string deb_tos(const vector<vector<T> > &a, vi H, vi W, int key = -1) {    stringstream ss;    ss << endl;    vi lens(sz(W));    fora(h, H) {        rep(wi, sz(W)) {            lens[wi] = max(lens[wi], sz(deb_tos(a[h][W[wi]])) + 1);            lens[wi] = max(lens[wi], sz(deb_tos(W[wi])) + 1);        }    }    if (key == -1)ss << \" *|\"; else ss << \" \" << key << \"|\";    int wi = 0;    fora(w, W) {        ss << std::right << std::setw(lens[wi]) << w;        wi++;    }    ss << \"\" << endl;    rep(i, sz(W))rep(_, lens[i]) ss << \"_\";    rep(i, 3)ss << \"_\";    ss << \"\" << endl;    fora(h, H) {        ss << std::right << std::setw(2) << h << \"|\";        int wi = 0;        fora(w, W) {            ss << std::right << std::setw(lens[wi]) << deb_tos(a[h][w]);            wi++;        }        ss << \"\" << endl;    }    return ss.str();}\ntemplate<class T> string deb_tos(const vector<vector<T> > &a, ll H = inf, ll W = inf, int key = -1) {    H = (H != inf) ? H : min({H, sz(a), DEB_LEN_H});    W = min({W, sz(a[0]), DEB_LEN_H});    vi hs, ws;    rep(h, H) { hs.push_back(h); }    rep(w, W) { ws.push_back(w); }    return deb_tos(a, hs, ws, key);}\ntemplate<class T> string deb_tos(const vector<vector<vector<T> > > &a, ll H = inf) {    stringstream ss;    if (H == inf)H = DEB_LEN_H;    H = min(H, sz(a));    rep(i, H) {        ss << endl;        ss << deb_tos(a[i], inf, inf, i);    }    return ss.str();}\ntemplate<class T, size_t A> string deb_tos(T (&a)[A]) { return deb_tos(vector<T>(begin(a), end(a))); }\ntemplate<class T, size_t A, size_t B> string deb_tos(T (&a)[A][B]) { return deb_tos(vector<vector<T> >(begin(a), end(a))); }\ntemplate<class T, size_t A, size_t B, size_t C> string deb_tos(T (&a)[A][B][C]) { return deb_tos(vector<vector<vector<T> > >(begin(a), end(a))); }\n\n#define debugName(VariableName) # VariableName\n\n#define _deb1(x) cerr <<  debugName(x)<<\" = \"<<deb_tos(x) << endl\n#define _deb2(x, y) cerr <<  debugName(x)<<\" = \"<<deb_tos(x)<<\", \"<< debugName(y)<<\" = \"<<deb_tos(y)<< endl\n#define _deb3(x, y, z) cerr <<  debugName(x)<<\" = \"<<deb_tos(x)  << \", \" <<  debugName(y)<<\" = \"<<deb_tos(y) <<\", \" debugName(z)<<\" = \"<<deb_tos(z) <<endl\n#define _deb4(x, y, z, a) cerr <<  debugName(x)<<\" = \"<<deb_tos(x) <<\", \" <<   debugName(y)<<\" = \"<<deb_tos(y) <<\", \" <<  debugName(z)<<\" = \"<<deb_tos(z) <<\", \" <<  debugName(a)<<\" = \"<<deb_tos(a)<<endl\n#define _deb5(x, y, z, a, b) cerr <<  debugName(x)<<\" = \"<<deb_tos(x) <<\", \" <<   debugName(y)<<\" = \"<<deb_tos(y) <<\", \" <<  debugName(z)<<\" = \"<<deb_tos(z) <<\", \" <<  debugName(a)<<\" = \"<<deb_tos(a)<<\", \" <<  debugName(b)<<\" = \"<<deb_tos(b)<<endl\n\n\n#define _overloadebug(_1, _2, _3, _4, _5, name, ...) name\n#define debug(...) _overloadebug(__VA_ARGS__,_deb5,_deb4,_deb3,_deb2,_deb1)(__VA_ARGS__)\n#ifdef _DEBUG\n#define deb(...) _overloadebug(__VA_ARGS__,_deb5,_deb4,_deb3,_deb2,_deb1)(__VA_ARGS__)\n#else\n#define deb(...) ;\n#endif\n\n\n#define debugline(x) cerr << x << \" \" << \"(L:\" << __LINE__ << \")\" << '\\n'\n\n\nll gcd(ll a, ll b) { return b ? gcd(b, a % b) : a; }\nll gcd(vi b) {ll res = b[0];for (auto &&v :b)res = gcd(v, res);return res;}\nll lcm(ll a, ll b) { return a / gcd(a, b) * b; }\nll rev(ll a) {    ll res = 0;    while (a) {        res *= 10;        res += a % 10;        a /= 10;    }    return res;}\ntemplate<class T> auto rev(const T &v, int i) {return v[sz(v) - 1 - i];}\nt_T vector<T> rev(vector<T> &a) {    auto b = a;    reverse(all(b));    return b;}\nstr rev(str &a) {str s = a;reverse(all(s));return s;}\nll ceil(ll a, ll b) {if (b == 0) {cerr<<\"ceil\"<<endl;exit(1);return -1;} else return (a + b - 1) / b;}\nll sqrt(ll a) {    if (a < 0) {        cerr<<\"sqrt\"<<endl;        exit(1);    }    ll res = (ll) std::sqrt(a);    while (res * res < a)res++;    return res;}\ndouble log(double e, double x) { return log(x) / log(e); }\nll sig(ll t) { return (1 + t) * t / 2; }\nll sig(ll s, ll t) { return (s + t) * (t - s + 1) / 2; }\n\nvi divisors(int v) {    vi res;    double lim = std::sqrt(v);    rep(i, 1, lim+1){        if (v % i == 0) {            res.pb(i);            if (i != v / i)res.pb(v / i);        }    }    return res;}\nvb isPrime;\nvi primes;\n\nvoid setPrime() {    int len = 4010101;    isPrime.resize(4010101);    fill(isPrime, true);    isPrime[0] = isPrime[1] = false;    for (int i = 2; i <= sqrt(len) + 5; ++i) {        if (!isPrime[i])continue;        for (int j = 2; i * j < len; ++j) {            isPrime[i * j] = false;        }    }    rep(i, len)if (isPrime[i])primes.pb(i);}\n\nvi factorization(int v) {    int tv = v;    vi res;    if (isPrime.size() == 0)setPrime();    for (auto &&p :primes) {        if (v % p == 0)res.push_back(p);        while (v % p == 0) {            v /= p;        }        if (v == 1 || p * p > tv)break;    }    if (v > 1)res.pb(v);    return res;}\ninline bool inside(int h, int w, int H, int W) { return h >= 0 && w >= 0 && h < H && w < W; }\ninline bool inside(int v, int l, int r) { return l <= v && v < r; }\n\n\nt_T vector<T> ruiv(vector<T> &a) {    vector<T> ret(a.size() + 1);    rep(i, a.size())ret[i + 1] = ret[i] + a[i];    return ret;}\n//imoは0-indexed\n//ruiは1-indexed\nt_T vector<T> imo(vector<T> &v) {    vector<T> ret = v;    rep(i, sz(ret) - 1)ret[i + 1] += ret[i];    return ret;}\n\n#define ins inside\nll u0(ll a) { return a < 0 ? 0 : a; }\nt_T vector<T> u(const vector<T> &a) {\n    vector<T> ret = a;fora(v, ret)v = u0(v);return ret;}\n#define MIN(a) numeric_limits<a>::min()\n#define MAX(a) numeric_limits<a>::max()\ntemplate<class T, class U> pair<T,U> operator+(const pair<T,U> &a, const pair<T,U> & b) {return pair<T,U>(a.fi+b.fi,a.se+b.se);}\n\nvoid yn(bool a) {\n    if (a)cout << \"yes\" << endl;\n    else cout << \"no\" << endl;\n}\nvoid Yn(bool a) {\n    if (a)cout << \"Yes\" << endl;\n    else cout << \"No\" << endl;\n}\nvoid YN(bool a) {\n    if (a)cout << \"YES\" << endl;\n    else cout << \"NO\" << endl;\n}\nvoid fyn(bool a) {\n    if (a)cout << \"yes\" << endl;\n    else cout << \"no\" << endl;\n    exit(0);\n}\nvoid fYn(bool a) {\n    if (a)cout << \"Yes\" << endl;\n    else cout << \"No\" << endl;\n    exit(0);\n}\nvoid fYN(bool a) {\n    if (a)cout << \"YES\" << endl;\n    else cout << \"NO\" << endl;\n    exit(0);\n}\nvoid Possible(bool a) {\n    if (a)cout << \"Possible\" << endl;\n    else cout << \"Impossible\" << endl;\n    exit(0);\n}\nvoid POSSIBLE(bool a) {\n    if (a)cout << \"POSSIBLE\" << endl;\n    else cout << \"IMPOSSIBLE\" << endl;\n    exit(0);\n}\ntemplate<class T, class U> set<T> &operator+=(set<T> &a, U v) {\n    a.insert(v);\n    return a;\n}\ntemplate<class T, class U> vector<T> &operator+=(vector<T> &a, U v) {\n    a.push_back(v);\n    return a;\n}\ntemplate<class T> vector<T>& operator+=(vector<T> & a,const vector<T> & b){\n    rep(i, sz(b))a += b[i];\n    return a;\n}\nt_T T sum(vector<T> &v, int s = 0, int t = inf) {    T ret = 0;    rep(i, s, min(sz(v), t))ret += v[i];    return ret;}\nvoid mod(int &a, int m) { a = (a % m + m) % m; }\ntemplate<class F> inline int mgr(int ok, int ng, F f) {\n#define _mgrbody int mid = (ok + ng) / 2; if (f(mid))ok = mid; else ng = mid;\n    if (ok < ng)while (ng - ok > 1) { _mgrbody } else while (ok - ng > 1) { _mgrbody }\n    return ok;\n}\n\ntemplate<class F> inline int mgr(int ok, int ng, int second, F f) {\n#define _mgrbody2 int mid = (ok + ng) / 2; if (f(mid, second))ok = mid; else ng = mid;\n    if (ok < ng) while (ng - ok > 1) { _mgrbody2 } else while (ok - ng > 1) { _mgrbody2 }\n    return ok;\n}\ntemplate<typename T> ostream &operator<<(ostream &os, vector<T> &m) {    rep(i, sz(m)){os << m[i];if(i < sz(m)-1)os<<\" \";}   return os;}\nostream &operator<<(ostream &os, vector<char> &m) {rep(i, sz(m)){os << m[i];}   return os;}\ntemplate<typename T> ostream &operator<<(ostream &os, vector<vector<T>> &m) {rep(i, sz(m)){os << m[i]; if(i < sz(m)-1)os << endl;}   return os;}\nconstexpr bool bget(ll m, int keta) { return (m >> keta) & 1; }\nint bget(ll m, int keta, int sinsuu) {m /= (ll) pow(sinsuu, keta);return m % sinsuu;}\nll bit(int n) { return (1LL << (n)); }\nll bit(int n, int sinsuu) { return (ll) pow(sinsuu, n); }\nint mask(int n) { return (1ll << n) - 1; }\n#define bcou __builtin_popcountll\ntemplate<class T, class U> inline bool chma(T &a, const U &b) {if (a < b) {a = b;return true;}return false;}\ntemplate<class U> inline bool chma(const U &b) { return chma(ma, b); }\ntemplate<class T, class U> inline bool chmi(T &a, const U &b) {    if (b < a) {        a = b;        return true;    }    return false;}\ntemplate<class U> inline bool chmi(const U &b) { return chmi(mi, b); }\n#define unique(v) v.erase( unique(v.begin(), v.end()), v.end() );\nint max(vi &a) {    int res = a[0];    fora(v, a) {        res = max(res, v);    }    return res;}\nint min(vi &a) {    int res = a[0];    fora(v, a) {        res = min(res, v);    }    return res;}\ntemplate<typename T> class fixed_point        : T {public:    explicit constexpr fixed_point(T &&t) noexcept: T(std::forward<T>(t)) {}    template<typename... Args> constexpr decltype(auto) operator()(Args &&... args) const { return T::operator()(*this, std::forward<Args>(args)...); }};template<typename T> static inline constexpr decltype(auto) fix(T &&t) noexcept { return fixed_point<T>{std::forward<T>(t)}; }\nconstexpr ll h4[] = {1, -1, 0, 0};\nconstexpr ll w4[] = {0, 0, -1, 1};\nconstexpr ll h8[] = {0, 1, 0, -1, -1, 1, 1, -1};\nconstexpr ll w8[] = {1, 0, -1, 0, 1, -1, 1, -1};\nint mei_inc(int h, int w, int H, int W, int i) {while (++i < 4) { if (inside(h + h4[i], w + w4[i], H, W))return i; }return i;}\n#define mei(nh, nw, h, w) for (int i = mei_inc(h, w, H, W, -1), nh = i<4? h + h4[i] : 0, nw = i<4? w + w4[i] : 0; i < 4; i=mei_inc(h,w,H,W,i), nh = h+h4[i], nw = w+w4[i])\nint mei_inc8(int h, int w, int H, int W, int i) {    while (++i < 8) {        if (inside(h + h8[i], w + w8[i], H, W))return i;    }    return i;}\n#define mei8(nh, nw, h, w) for (int i = mei_inc8(h, w, H, W, -1), nh = i<8? h + h8[i] : 0, nw = i<8? w + w8[i] : 0; i < 8; i=mei_inc8(h,w,H,W,i), nh = h+h8[i], nw = w+w8[i])\nint mei_incv(int h, int w, int H, int W, int i, vp &p) {    while (++i < sz(p)) { if (inside(h + p[i].fi, w + p[i].se, H, W))return i; }    return i;}\n#define meiv(nh, nw, h, w, p) for (int i = mei_incv(h, w, H, W, -1, p), nh = i<sz(p)? h + p[i].fi : 0, nw = i<sz(p)? w + p[i].se : 0; i < sz(p); i=mei_incv(h,w,H,W,i,p), nh = h+p[i].fi, nw = w+p[i].se)\nvi compress(vi &A) {    vi B = A;    sort(B);    unique(B);    vi inds(sz(B));    rep(i, sz(A)) {        int ind = lower_bound(all(B), A[i]) - B.begin();        inds[ind] = A[i];        A[i] = ind;    }    return inds;}\nvi compress(vi &A, umapi& map){    vi i_v = compress(A);    rep(i, sz(i_v)){        map[i_v[i]] = i;    }    return i_v;}\n\nt_T void out2(T head) {    cout << head;}\ntemplate<class T, class... U> void out2(T head, U ... tail) {    cout << head << \" \";      out2(tail...);}\ntemplate<class T, class... U> void out(T head, U ... tail) {    cout << head << \" \";        out2(tail...);    cout << \"\" << endl;}\nt_T void out(T head) {    cout << head << endl; }\nvoid out() { cout << \"\" << endl; }\n#define lowerIndex(a, v) (lower_bound(all(a),v)-a.begin())\n#define upperIndex(a, v) (uppereturnbound(all(a),v)-a.begin())\ntemplate<typename T> vector<T> make_v(size_t a) { return vector<T>(a); }\ntemplate<typename T, typename... Ts> auto make_v(size_t a, Ts... ts) { return vector<decltype(make_v<T>(ts...))>(a, make_v<T>(ts...)); }\n#define vni(name, ...) auto name = make_v<ll>(__VA_ARGS__)\n#define vnb(name, ...) auto name = make_v<bool>(__VA_ARGS__)\n#define vns(name, ...) auto name = make_v<string>(__VA_ARGS__)\n#define vnd(name, ...) auto name = make_v<double>(__VA_ARGS__)\n#define vnc(name, ...) auto name = make_v<char>(__VA_ARGS__)\n#define vnp(name, ...) auto name = make_v<P>(__VA_ARGS__)\n#define vn(type, name, ...) auto name = make_v<type>(__VA_ARGS__)\n#define VEC vector\n\n/*@formatter:on*/\nint N, M, H, W;\nvi A, B, C;\n\nvoid print(map<int, map<int, int>>& a) {\n    return; \n//    int h = 0, w = 0;\n//    rep(i, H) {\n//        rep(j, W) {\n//            if (a[i].count(j)) {\n//                chma(h, i);\n//                chma(w, j);\n//\n//            }\n//        }\n//    }\n//    vvi(A, h + 1, w + 1);\n//    rep(i, h + 1) {\n//        rep(j, w + 1) {\n//            A[i][j] = a[i][j];\n//        }\n//    }\n//    deb(A);\n}\n//0:54\nvoid solve() {\n    map<int, map<int, int>> cou;\n    int i=0;\n    while (in(W, H, N, M)) {\n        deb(i);\n        if (!H && !W && !N && !M)break;\n        map<int, map<int, int>> cou;\n        rep(h, H) {\n            rep(w, W) {\n                cou[h][w] = 1;\n            }\n        }\n        print(cou);\n        auto set = [&](int ah, int aw) {\n            map<int, map<int, int>> ncou;\n            rep(h, ah, ah + H) {\n                rep(w, aw, aw + W) {\n                    if (cou[h][w])ncou[h - ah][w - aw] = cou[h][w];\n                }\n            }\n            swap(cou, ncou);\n        };\n        rep(_, N) {\n            din(d, c);\n            if (d == 1) {\n                int mw = c;\n                rep(h, H) {\n                    rep(w, mw) {\n                        int addw = mw - w - 1;\n                        int nw = mw + addw;\n                        cou[h][nw] += cou[h][w];\n                        cou[h][w] = 0;\n                    }\n                }\n                set(0, mw);\n            } else {\n                int mh = c;\n                rep(h, mh) {\n                    rep(w, W) {\n                        int addh = mh - h - 1;\n                        int nh = mh + addh;\n                        cou[nh][w] += cou[h][w];\n                        cou[h][w] = 0;\n                    }\n                }\n                set(mh, 0);\n            }\n            deb(d,c);\n            print(cou);\n        }\n        rep(_, M){\n            din(w, h);\n            out(cou[h][w]);\n        }\n    }\n}\n\nsigned main() {\n    solve();\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <functional>\n#include <vector>\n#include <utility>\n#include <cstring>\n#include <cmath>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n#include <numeric> \n#define MAX_N 100\nusing namespace std;\ntypedef long long ll;\nconst int INF = 1<<30; \nconst int MOD = 1e9 + 7;\nconst int dx[] = {1, 0, -1, 0};\nconst int dy[] = {0, 1, 0, -1};\nint main()\n{\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tint w, h, t, p, d, c;\n\twhile(cin >> w >> h >> t >> p, w | h | t | p)\n\t{\n\t\tint table[2 * MAX_N][2 * MAX_N] = {};\n\t\tfor(int i = 0; i < h; i++)\n\t\t\tfor(int j = 0; j < w; j++) table[i][j] = 1;\n\t\tfor(int i = 0; i < t; i++)\n\t\t{\n\t\t\tcin >> d >> c;\n\t\t\tif(d == 1)\n\t\t\t{\n\t\t\t\tfor(int j = 0; j < h; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < c; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint alpha = c - k - 1;\n\t\t\t\t\t\ttable[j][c + alpha] += table[j][k];\n\t\t\t\t\t\ttable[j][k] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j = 0; j < MAX_N; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < MAX_N; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\ttable[j][k] = table[j][k + c];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(d == 2)\n\t\t\t{\n\t\t\t\tfor(int j = 0; j < c; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < w; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint alpha = c - j - 1;\n\t\t\t\t\t\ttable[c + alpha][k] += table[j][k];\n\t\t\t\t\t\ttable[j][k] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j = 0; j < MAX_N; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < MAX_N; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\ttable[j][k] = table[j + c][k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint x, y;\n\t\tfor(int i = 0; i < p; i++)\n\t\t{\n\t\t\tcin >> x >> y;\n\t\t\tcout << table[y][x] << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\nint main() {\n\twhile (true) {\n\t\tint n, m, t, p;\n\t\tcin >> n >> m >> t >> p;\n\t\tif (n == 0) break;\n\n\t\tvector<vector<int>> card(500, vector<int>(500, 0));\n\t\tfor(int x = 0; x < n; ++x) {\n\t\t\tfor(int y = 0; y < m; ++y) {\n\t\t\t\tcard[x][y] = 1;\n\t\t\t}\n\t\t}\n\n\t\tint l = 0, u = 0;\n\t\tfor(int q = 0; q < t; ++q) {\n\t\t\tint d, c;\n\t\t\tcin>>d>>c;\n\n\t\t\tif (d == 1) {\n\t\t\t\tfor(int x = 0; x < c; ++x) {\n\t\t\t\t\tfor(int y = 0; y < m; ++y) {\n\t\t\t\t\t\tcard[l + c * 2 - x - 1][u + y] += card[l + x][u + y];\n\t\t\t\t\t\tcard[l + x][u + y] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tl += c;\n\t\t\t\tn = max(c, n - c);\n\t\t\t} else {\n\t\t\t\tfor(int x = 0; x < n; ++x) {\n\t\t\t\t\tfor(int y = 0; y < c; ++y) {\n\t\t\t\t\t\tcard[l + x][u + c * 2 - 1 - y] += card[l + x][u + y];\n\t\t\t\t\t\tcard[l + x][u + y] = 0; \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tu += c;\n\t\t\t\tm = max(c, m - c);\n\t\t\t}\n\t\t}\n\n\t\tfor(int q = 0; q < p; ++q) {\n\t\t\tint x, y;\n\t\t\tcin >> x >> y;\n\t\t\tcout << card[l + x][u + y] << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n, m, t, p, mm, nn;\nint memo[100][100];\nint d, c, x, y;\n\nint main() {\n  int i, j, a, ans;\n  while(1) {\n    cin >> n >> m >> t >> p;\n    if(n + m + t + p == 0) break;\n    nn = n;\n    mm = m;\n    ans = 0;\n    for(i = 0; i < 100; ++i)\n      for(j = 0; j < 100; ++j) memo[i][j] = 0;\n    for(i = 0; i < m; i++)\n      for(j = 0; j < n; j++) memo[i][j] = 1;\n    for(a = 0; a < t; a++) {\n      cin >> d >> c;\n      if(d == 1) {\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < c / 2; j++) { swap(memo[i][j], memo[i][c - j - 1]); }\n        if(c <= nn / 2)\n          nn -= c;\n        else\n          nn = c;\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < nn; j++) {\n            if(j < c)\n              memo[i][j] += memo[i][j + c];\n            else\n              memo[i][j] = memo[i][j + c];\n            memo[i][j + c] = 0;\n          }\n      }\n      else {\n        for(i = 0; i < c / 2; i++)\n          for(j = 0; j < nn; j++) { swap(memo[i][j], memo[c - i - 1][j]); }\n        if(c <= mm / 2)\n          mm -= c;\n        else\n          mm = c;\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < nn; j++) {\n            if(i < c)\n              memo[i][j] += memo[i + c][j];\n            else\n              memo[i][j] = memo[i + c][j];\n            memo[i + c][j] = 0;\n          }\n      }\n      /*for(i = 0; i < m; i++)\n        for(j = 0; j < n; j++)\n          if(i >= mm || j >= nn) memo[i][j] = 0;*/\n      /*for(i = 0; i < m; i++) {\n        for(j = 0; j < n; j++) cout << memo[i][j] << \" \";\n        cout << endl;\n      }\n      cout << endl;*/\n      // cout << n << \" \" << nn << \" \" << m << \" \" << mm << endl;\n    }\n    for(a = 0; a < p; a++) {\n      cin >> x >> y;\n      cout << memo[y][x] << endl;\n      // if(memo[y][x] == 96)\n      // cout << n << \" \" << m << \" \" << t << \" \" << p << endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint paper[100][100];\nvoid init(){\n    for(int i = 0; i < 100; i++){\n        for(int j = 0; j < 100; j++){\n            paper[i][j] = 0;\n        }\n    }\n}\n\nvoid adjust(){\n    for(int x = 0; x < 100; x++){\n        queue<int>Q;\n        for(int y = 0; y < 100; y++){\n            if(paper[y][x]){\n                Q.push(paper[y][x]);\n                paper[y][x] = 0;\n            }\n        }\n        for(int y = 0; y < 100; y++){\n            if(Q.empty())break;\n            paper[y][x] = Q.front();\n            Q.pop();\n        }\n    }\n    for(int y = 0; y < 100; y++){\n        queue<int>Q;\n        for(int x = 0; x < 100; x++){\n            if(paper[y][x]){\n                Q.push(paper[y][x]);\n                paper[y][x] = 0;\n            }\n        }\n        for(int x = 0; x < 100; x++){\n            if(Q.empty())break;\n            paper[y][x] = Q.front();\n            Q.pop();\n        }\n    }\n}\n\nvoid turn(){\n    int d, c;\n    cin >> d >> c;\n    if(d == 2){\n        for(int y1 = 0; y1 < c; y1++){\n            int y2 = 2 * c - 1 - y1;\n            for(int x = 0; x < 100; x++){\n                paper[y2][x] += paper[y1][x];\n                paper[y1][x] = 0;\n            }\n        }\n    }\n    else{\n        for(int x1 = 0; x1 < c; x1++){\n            int x2 = 2 * c - 1 - x1;\n            for(int y = 0; y < 100; y++){\n                paper[y][x2] += paper[y][x1];\n                paper[y][x1] = 0;\n            }\n        }\n    }\n    adjust();\n}\n\nint main(){\n    \n    for(int w, h, t, p; cin >> w >> h >> t >> p, w;){\n        init();\n        for(int y = 0; y < h; y++){\n            for(int x = 0; x < w; x++){\n                paper[y][x] = 1;\n            }\n        }\n        for(int i = 0; i < t; i++){\n            turn();\n        }\n        for(int i = 0; i < p; i++){\n            int x, y;\n            cin >> x >> y;\n            cout << paper[y][x] << endl;            \n        }\n    }    \n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <algorithm>\n\n\nusing namespace std;\n\n\n#define REP(i, n) for (int (i) = 0; (i) < (n); (i)++)\n\nint main() {\n  int n, m, t, p;\n  int a[700][700];\n  while(cin >> n >> m >> t >> p, n){\n    int zerox = 0, zeroy = 0;\n    fill(a[0], a[699], 0);\n    REP(i,n)REP(j,m) a[i][j] = 1;\n    REP(i,t){\n      int d, c;\n      cin >> d >> c;\n      if(d == 1){ // left\n        zerox += c;\n        for(int t = 0; t < c; t++){\n          for(int y = zeroy; y < m + zeroy; y++){\n            a[zerox + t][y] += a[zerox - 1 - t][y];\n          }\n        }\n      }else{ // below\n        zeroy += c;\n        for(int t = 0; t < c; t++){\n          for(int x = zerox; x < n + zerox; x++){\n            a[x][zeroy + t] += a[x][zeroy - 1 - t];\n          }\n        }\n      }\n    }\n    // Output    \n    REP(i,p){\n      int x, y;\n      cin >> x >> y;\n      cout << a[zerox + x][zeroy + y] << endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define LL long long\nusing namespace std;\nint d[50],c[50],x[50],y[50],a[35][35],m,n;\nvoid fan(int x1,int y1,int f)\n{\n    int b[35][35],i,j;\n    if(f==1)\n    {\n        for(i=1;i<=y1;i++)\n            for(j=1;j<=x1;j++)\n            b[i][j]=a[i][x1-j+1];\n        for(i=1;i<=y1;i++)\n            for(j=1;j<=x1;j++)\n            a[i][j]=b[i][j];\n    }\n    else\n    {\n        for(i=1;i<=y1;i++)\n            for(j=1;j<=x1;j++)\n            b[i][j]=a[y1-i+1][j];\n        for(i=1;i<=y1;i++)\n            for(j=1;j<=x1;j++)\n            a[i][j]=b[i][j];\n    }\n\n\n}\nint main()\n{\n    int i,j,k,all,q,p,w,u,l,r,ans,t;\n    scanf(\"%d %d %d %d\",&n,&m,&t,&p);\n    while(n!=0&&m!=0&&t!=0&&p!=0)\n    {\n        w=n;u=m;l=r=0;ans=0;\n        for(i=1;i<=m;i++)\n            for(j=1;j<=n;j++)\n            a[i][j]=1;\n        for(i=1;i<=t;i++)\n        {\n            scanf(\"%d%d\",&d[i],&c[i]);\n        }\n        for(i=1;i<=p;i++)\n        {\n            scanf(\"%d%d\",&x[i],&y[i]);\n        }\n        for(i=1;i<=t;i++)\n        {\n            if(d[i]==1)\n            {\n                if(c[i]<=w/2)\n                {\n                    for(j=1;j<=c[i];j++)\n                        for(k=1;k<=u;k++)\n                    {\n                        a[k][c[i]-j+1]=a[k][j+c[i]]+a[k][c[i]-j+1];\n                    }\n                    w-=c[i];\n                    for(j=c[i]+1;j<=w;j++)\n                        for(k=1;k<=u;k++)\n                            a[k][j]=a[k][j+c[i]];\n                }\n                else\n                {\n                    for(j=1;j<=w-c[i];j++)\n                         for(k=1;k<=u;k++)\n                         a[k][c[i]-j+1]=a[k][j+c[i]]+a[k][c[i]-j+1];\n                    w=c[i];\n                    fan(w,u,1);\n                }\n\n            }\n\n            if(d[i]==2)\n            {\n                if(c[i]<=u/2)\n                {\n                    for(j=1;j<=c[i];j++)\n                        for(k=1;k<=w;k++)\n                    {\n                        a[c[i]-j+1][k]=a[j+c[i]][k]+a[c[i]-j+1][k];\n                        //printf(\"%d\\n\",a[j][k]);\n                    }\n                    u-=c[i];\n                    /*for(j=c[i]+1;j<=u;j++)\n                        for(k=1;k<=w;k++)\n                            a[j][k]=a[j+c[i]][k];*/\n                }\n                else\n                {\n                    for(j=1;j<=u-c[i];j++)\n                        for(k=1;k<=w;k++)\n                        {a[c[i]-j+1][k]=a[c[i]-j+1][k]+a[c[i]+j][k];\n                        }\n\n                    u=c[i];\n                   fan(w,u,2);\n                }\n\n            }\n           /* for(k=1;k<=m;k++)\n            {for(j=1;j<=n;j++)\n            printf(\"%d \",a[k][j]);\n            printf(\"\\n\");\n            }\n            printf(\"\\n\");*/\n\n        }\n       /* for(i=1;i<=m;i++)\n            {for(j=1;j<=n;j++)\n            printf(\"%d \",a[i][j]);\n            printf(\"\\n\");\n            }*/\n        for(i=1;i<=p;i++)\n            {ans=a[y[i]+1][x[i]+1];\n        printf(\"%d\\n\",ans);}\n        scanf(\"%d%d%d%d\",&n,&m,&t,&p);\n        }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint A[200][200];\n\nint main(){\n  int n,m,t,p;\n  while(1){\n    cin>>n>>m>>t>>p;\n    if(n==0&&m==0&&t==0&&p==0)break;\n\n    for(int i=0;i<200;i++)\n      for(int j=0;j<200;j++)\n        A[i][j]=0;\n    \n    for(int i=0;i<m;i++)\n      for(int j=0;j<n;j++)\n        A[i][j]=1;\n    \n    for(int u=0;u<t;u++){\n      int d,c;\n      cin>>d>>c;\n      if(d==1){\n        \n        for(int i=0;i<m;i++){\n          for(int j=0;j<c;j++){\n            int dist=c-j;\n            A[i][c+dist-1]+=A[i][j];\n            A[i][j]=0;\n          }\n        }\n\n        for(int i=0;i<m;i++){\n          for(int j=0;j<n;j++){\n            A[i][j]=A[i][j+c];\n          }\n        }\n        \n      }else{\n        \n        for(int i=0;i<c;i++){\n          for(int j=0;j<n;j++){\n            int dist=c-i;\n            A[c+dist-1][j]+=A[i][j];\n            A[i][j]=0;\n          }\n        }\n\n        for(int i=0;i<m;i++){\n          for(int j=0;j<n;j++){\n            A[i][j]=A[i+c][j];\n          }\n        }\n        \n      }\n      \n    }\n    \n    for(int i=0;i<p;i++){\n      int x,y;\n      cin>>x>>y;\n      cout<<A[y][x]<<endl;\n    }\n    \n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n    int n, m, t, p;\n    while(cin >> n >> m >> t >> p, n) {\n        vector<vector<int>> cur(n, vector<int>(m, 1));\n        for(int i = 0; i < t; ++i) {\n            int d, c; cin >> d >> c;\n            const int nw = (d == 2 ? cur.size() : max(c, (int)cur.size() - c));\n            const int nh = (d == 1 ? cur[0].size() : max(c, (int)cur[0].size() - c));\n            vector<vector<int>> nxt(nw, vector<int>(nh));\n            for(int x = 0; x < (int)cur.size(); ++x) {\n                for(int y = 0; y < (int)cur[0].size(); ++y) {\n                    const int nx = (d == 2 ? x : x < c ? c - x - 1 : x - c);\n                    const int ny = (d == 1 ? y : y < c ? c - y - 1 : y - c);\n                    nxt[nx][ny] += cur[x][y];\n                }\n            }\n            cur = move(nxt);\n        }\n\n        for(int i = 0; i < p; ++i) {\n            int x, y; cin >> x >> y;\n            cout << cur[x][y] << endl;\n        }\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <cstring>\n#include <climits>\n#include <vector>\n#include <map>\n#include <set>\n#include <list>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <iostream>\n#include <string>\n\n#define REP(i,n) for(long long i=0;i<n;++i)\n#define REPR(i,n) for(long long i=n;i>=0;--i)\n#define REPI(itr,v) for(auto itr=v.begin();itr!=v.end();++itr)\n#define REPIR(itr,v) for(auto itr=v.rbegin();itr!=v.rend();++itr)\n#define FOR(i,a,b) for(long long i=a;i<b;++i)\n#define SORT(v,n) sort(v, v+n)\n#define SORTV(v) sort(v.begin(), v.end())\n#define ALL(v) v.begin(),v.end()\n#define llong long long\n#define INF 999999999\n#define MOD 1000000007\n#define pb push_back\n#define pf push_front\n#define MP make_pair\n#define SV(v) {for(long long sitr=0;sitr<v.size();++sitr){cin>>v[sitr];}}\n\nint dx[] = {0, 0, -1, 1};\nint dy[] = {1, -1, 0, 0};\n\nusing namespace std;\n\ntypedef pair<int,int> pii;\n\nint d[20], c[20], x[20], y[20];\nint n, m, t, p;\n\nvoid solve(vector<vector<int>> mass, int h, int w, int num){\n  if(num == t){\n    //こたえ合わせ\n\n    REP(i,p){\n      cout << mass[y[i]][x[i]] << endl;\n    }\n    return;\n  }\n\n  vector<vector<int>> new_mass;\n  if(d[num] == 1){\n    //超えないとき\n    if(w / 2 >= c[num]){\n      int new_h = h, new_w = w - c[num];\n\n      new_mass = vector<vector<int>>(new_h, vector<int>(new_w, 0));\n      //折り返し部分\n      REP(i,new_h){\n        REP(j,c[num]){\n          new_mass[i][j] += mass[i][c[num]-j-1];\n        }\n      }\n      //そのままの部分\n      REP(i,new_h){\n        REP(j,new_w){\n          new_mass[i][j] += mass[i][c[num]+j];\n        }\n      }\n    \n      solve(new_mass, new_h, new_w, num+1);\n    }else{\n      int new_h = h, new_w = c[num];\n\n      new_mass = vector<vector<int>>(new_h, vector<int>(new_w, 0));\n      //そのままの部分\n      REP(i,h){\n        REP(j,w - c[num]){\n          new_mass[i][j] += mass[i][c[num]+j];\n        }\n      }\n      //折り返し部分\n      REP(i,h){\n        REP(j,new_w){\n          new_mass[i][j] += mass[i][c[num]-j-1];\n        }\n      }\n\n      solve(new_mass, new_h, new_w, num+1);\n    }\n  }else{\n    //超えない時\n    if(h / 2 >= c[num]){\n      int new_h = h - c[num], new_w = w;\n\n      new_mass = vector<vector<int>>(new_h, vector<int>(new_w, 0));\n      //そのままの部分\n      REP(i,new_h){\n        REP(j,new_w){\n          new_mass[i][j] += mass[c[num]+i][j];\n        }\n      }\n      //折り返し\n      REP(i,c[num]){\n        REP(j,new_w){\n          new_mass[i][j] += mass[c[num]-i-1][j];\n        }\n      }\n\n      solve(new_mass, new_h, new_w, num+1);\n    //越える時\n    }else{\n      int new_h = c[num], new_w = w;\n\n      new_mass = vector<vector<int>>(new_h, vector<int>(new_w, 0));\n\n      //そのまま\n      REP(i,h - c[num]){\n        REP(j,w){\n          new_mass[i][j] += mass[c[num] + i][j];\n        }\n      }\n      //折り返し\n      REP(i,new_h){\n        REP(j,new_w){\n          new_mass[i][j] += mass[c[num]-i-1][j];\n        }\n      }\n\n      solve(new_mass, new_h, new_w, num+1);\n    }\n  }\n}\n\nint main(){\n\n  while(true){\n    cin >> n >> m >> t >> p;\n    if(n == 0 && m == 0 && t == 0 && p == 0) break;\n    vector<vector<int>> mass;\n    mass = vector<vector<int>>(m, vector<int>(n, 0));\n    REP(i,m){\n      REP(j,n){\n        mass[i][j] = 1;\n      }\n    }\n    REP(i,t){\n      cin >> d[i] >> c[i];\n    }\n    REP(i,p){\n      cin >> x[i] >> y[i];\n    }\n\n    solve(mass, m, n, 0);\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define ll long long\n#define fornum(A,B,C) for(A=B;A<C;A++)\n#define mp make_pair\n#define pii pair<int,int>\n#define pll pair<ll,ll>\n\nusing namespace std;\n\n/////////////////////////////////////////////////////\nll n,m,t,p;\nll km[100][100],km2[100][100];\nll i, j, k;\nvoid oru(ll d,ll c){\n    ll i, j, k;\n    if(d==1){\n        \n        fornum(i,0,m){\n            fornum(j,0,n){\n                km2[i][j<c?c-j-1:j-c] += km[i][j];\n            }\n        }\n        n = max(n-c,c);\n    }else if(d==2){\n        \n        fornum(i,0,m){\n            fornum(j,0,n){\n                km2[i<c?c-i-1:i-c][j] += km[i][j];\n            }\n        }\n        m = max(m-c,c);\n    }\n    fornum(i,0,m){\n        fornum(j,0,n){\n            km[i][j] = km2[i][j];\n            km2[i][j] = 0;\n            //printf(\"%lld \",km[i][j]);\n        }\n        //printf(\"\\n\");\n    }\n    //printf(\"\\n\");\n    //printf(\"%lld,%lldpp\\n\", n, m);\n}\nint main(){\n    \n    scanf(\"%lld%lld%lld%lld\", &n,&m,&t,&p);\n    while(n){\n        \n        //ll ans = 0;\n        fornum(i,0,m){\n            fornum(j,0,n){\n                km[i][j] = 1;\n            }\n        }\n        //printf(\"%lldp\\n\", p);\n        fornum(i,0,t){\n            ll d, c;\n            scanf(\"%lld%lld\", &d, &c);\n            oru(d, c);\n        }\n        //printf(\"%lldp\\n\", p);\n        fornum(i,0,p){\n            ll x, y;\n            scanf(\"%lld%lld\", &x, &y);\n            //y = m - 1 - y;\n            printf(\"%lld\\n\",km[y][x]);\n        }\n        scanf(\"%lld%lld%lld%lld\", &n,&m,&t,&p);\n        //printf(\"%lld%lld%lld%lld\\n\", n,m,t,p);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nint score[1000][1000];\n\nint main(){\n        int d[20],c[20];\n        int n,m,t,p,height,width,ans,w,h;\n\n        while(1) {\n                height=0;\n                width=0;\n                ans=0;\n\n                for(int i=0; i<400; i++) {\n                        for(int j=0; j<400; j++) {\n                                score[i][j]=0;\n                        }\n                }\n\n                cin>>n>>m>>t>>p;\n\n                if(n==0&&m==0&&t==0&&p==0) {\n                        break;\n                }\n\n                for(int i=0; i<m; i++) {\n                        for(int j=0; j<n; j++) {\n                                score[i][j]=1;\n                        }\n                }\n\n                for(int i=0; i<t; i++) {\n                        cin>>d[i]>>c[i];\n\n                        if(d[i]==2) {\n                                height += c[i];\n                                m += height;\n                                for(int x=height; x<height+c[i]; x++) {\n                                        for(int y=width; y<n; y++) {\n                                                score[x][y]+=score[2*height-x-1][y];\n                                                //  cout<<x<<':'<<y<<':'<<score[x][y]<<endl;\n                                        }\n                                }\n                        }else{\n                                width += c[i];\n                                n += width;\n                                for(int x=width; x<width+c[i]; x++) {\n                                        for(int y=height; y<m; y++) {\n                                                score[y][x]+=score[y][2*width-x-1];\n                                                //      cout<<y<<':'<<x<<':'<<score[y][x]<<endl;\n                                        }\n                                }\n                        }\n                }\n\n                for(int i=0; i<p; i++) {\n                        cin>>w>>h;\n\n                        ans = score[h+height][w+width];\n                        cout<<ans<<endl;\n                }\n        }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  while (true) {\n    int n, m, t, p;\n    cin >> n >> m >> t >> p;\n    if (n + m + t + p == 0) break;\n    \n    vector<vector<int>> x(m, vector<int>(n, 1));\n    for (int k = 0; k < t; k++) {\n      int d, c;\n      cin >> d >> c;\n      \n      if (d == 1) {\n        vector<vector<int>> y(x.size(), vector<int>(max<int>(c, x[0].size() - c), 0));\n        for (int i = 0; i < x.size(); i++) {\n          for (int j = 0; j < x[0].size(); j++) {\n            if (j < c) y.at(i).at(c - 1 - j) += x.at(i).at(j);\n            else y.at(i).at(j - c) += x.at(i).at(j);\n          }\n        }\n        x = y;\n      }\n      else {\n        vector<vector<int>> y(max<int>(c, x.size() - c), vector<int>(x[0].size(), 0));\n        for (int j = 0; j < x[0].size(); j++) {\n          for (int i = 0; i < x.size(); i++) {\n            if (i < c) y.at(c - 1 - i).at(j) += x.at(i).at(j);\n            else y.at(i - c).at(j) += x.at(i).at(j);\n          }\n        }\n        x = y;\n      }\n    }\n    \n    for (int i = 0; i < p; i++) {\n      int xx, yy;\n      cin >> xx >> yy;\n      swap(xx, yy);\n      cout << x.at(xx).at(yy) << '\\n';\n    }\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n,m,t,p,mm,nn;\nint memo[40][40];\nint d,c,x,y;\n\nint main(){\n  int i,j,a,ans;\n  while(1){\n    cin >> n >> m >> t >> p;\n    if(n+m+t+p==0)break;\n    nn = n;\n    mm = m;\n    ans = 0;\n    for(int i=0;i<40;++i)for(int j=0;j<40;++j)memo[i][j]=0;\n    for(i=0;i<m;i++)for(j=0;j<n;j++)memo[i][j]=1;\n    for(a=0;a<t;a++){\n\n      cin >> d >> c;\n      if(d==1){\n\tfor(i=0;i<mm;i++)for(j=0;j<c/2;j++){\n\t    swap(memo[i][j],memo[i][c-j-1]);\n\t  }\n\tif(nn-c>c/2)nn-=c;\n\telse nn = c;\n\tfor(i=0;i<mm;i++)for(j=0;j<nn;j++){\n\t    if(j<c)memo[i][j]+=memo[i][j+c];\n\t    else memo[i][j]=memo[i][j+c];\n\t  }\n      }\n      else{\n\tfor(i=0;i<c/2;i++)for(j=0;j<nn;j++){\n\t    swap(memo[i][j],memo[c-i-1][j]);\n\t  }\n\tif(mm-c>c/2)mm-=c;\n\telse mm = c;\n\tfor(i=0;i<mm;i++)for(j=0;j<nn;j++){\n\t    if(i<c)memo[i][j]+=memo[i+c][j];\n\t    else memo[i][j]=memo[i+c][j];\n\t  }\n      }\n      for(i=0;i<m;i++)for(j=0;j<n;j++)if(i>=mm||j>=nn)memo[i][j]=0;\n      /*for(i=0;i<m;i++){\n\tfor(j=0;j<n;j++)cout << memo[i][j]<<\" \";\n\tcout << endl;\n\t}\n\tcout << endl;*/\n\n    }\n    for(a=0;a<p;a++){\n      cin >> x >> y;\n      cout<<memo[y][x]<<endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MA_DEFINES\n#include <bits/stdc++.h>\n#define int long long\n#define rep(i,n) for(int i=0;i<n;i++)\n#define Rep(i,a,b) for(int i=a;i<b;i++)\n#define REP(i,a,b) for(int i=a;i<=b;i++)\n#define rev(i,n) for(int i=n-1;i>=0;i--)\n#define vi vector<int>\n#define vvi vector<vi>\n#define pb push_back\n#define pi pair<int,int>\n#define vp vector<pair<int,int>>\n#define mp make_pair\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\n#define MEMSET(a) memset(a,0,sizeof(a))\n#define inf (1ll<<60)\n#define Yes(f) cout<<(f?\"Yes\":\"No\")<<endl\n#define yes(f) cout<<(f?\"yes\":\"no\")<<endl\n#define YES(f) cout<<(f?\"YES\":\"NO\")<<endl\n#define SORT(v) sort(all(v))\n#define RSORT(v) sort(all(v), greater<int>())\n\nusing namespace std;\n\nconst int mod=1e9+7;\n\nvoid run();\n\nvoid init() {\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    cout<<fixed<<setprecision(12);\n}\n\nsigned main(){\n    init();\n    run();\n    return 0;\n}\n\nvoid run(){\n    int n,m,t,p;\n    cin>>n>>m>>t>>p;\n    while(n){\n        int a[m*t][n*t];\n        int x=0,y=0,w=n,h=m;\n        rep(i,m)rep(j,n)a[i][j]=1;\n        while(t--){\n            int d,c;\n            cin>>d>>c;\n            if(d==1){\n                Rep(i,y,h){\n                    rep(j,c){\n                        a[i][x+2*c-j-1]+=a[i][x+j];\n                    }\n                }\n                w=max(w,x+2*c);\n                x+=c;\n            }\n            else{\n                Rep(i,x,w){\n                    rep(j,c){\n                        a[y+2*c-j-1][i]+=a[y+j][i];\n                    }\n                }\n                h=max(h,y+2*c);\n                y+=c;\n            }\n        }\n        while(p--){\n            int r,t;\n            cin>>r>>t;\n            cout<<a[y+t][x+r]<<endl;\n        }\n        cin>>n>>m>>t>>p;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint n,m,t,p;\nint a,b,c,d;\nint field[2000][2000]={};\nint main(){\n  while(1){\n    cin >> n >> m >> t >> p;\n    if(n==0 && m==0 && t==0 && p==0) break;\n    int x_0=0,y_0=0,x_max=n-1,y_max=m-1;\n    for(int i=0;i<2000;i++){\n      for(int j=0;j<2000;j++){\n        field[i][j]=0;\n      }\n    }\n    for(int i=x_0;i<=x_max;i++){\n      for(int j=y_0;j<=y_max;j++){\n        field[i][j]=1;\n      }\n    }\n    for(int T=0;T<t;T++){\n      int c,d;\n      cin >> c >> d;\n      if(c==1){\n        int k=1;\n        /*for(int i=x_max-d;i>=x_0;i--){\n          for(int j=y_0;j<=y_max;j++){\n            field[i+k][j]+=field[i][j];\n            field[i][j]=0;\n          }\n          k+=2;\n        }//caution\n        //x_max=max(x_max,x_0+k);\n        int tmp=x_0;\n        x_0=x_max-d+1;\n        x_max=max(x_max,2*x_max-2*d-tmp+1);\n        //for(int s=0;s<=4;s++) cout << field[s][0] << \" \";\n        //cout << endl;\n        //cout << \"x_max \" << x_max << \"x0\" << x_0 << \" \" << \"y0\" << y_0 << endl;*/\n        for(int i=x_0+d-1;i>=x_0;i--){\n          for(int j=y_0;j<=y_max;j++){\n            field[i+k][j]+=field[i][j];\n            field[i][j]=0;\n          }\n          k+=2;\n        }//caution\n        int tmp=x_0;\n        x_0+=d;\n        x_max=max(x_max,tmp+2*d-1);\n      }\n      else{\n        int k=1;\n        for(int j=y_0+d-1;j>=y_0;j--){\n          for(int i=x_0;i<=x_max;i++){\n            field[i][j+k]+=field[i][j];\n            field[i][j]=0;\n          }\n          k+=2;\n        }//caution\n        int tmp=y_0;\n        y_0+=d;\n        y_max=max(y_max,tmp+2*d-1);\n      }\n    }\n    for(int i=0;i<p;i++){\n    int q,w;\n    cin >> q >> w;\n    cout << field[x_0+q][y_0+w] << endl;\n  }\n//a=y_max,b=y_0,c=x_max,d=x_0;\n}\n/*for(int j=a;j>=b;j--){\n  for(int i=d;i<=c;i++){\n    cout << field[i][j] << \" \";\n  }\n  cout << endl;\n}\ncout << field[d+3][b+4] << endl;*/\nreturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n//repetition\n#define FOR(i,a,b) for(ll i=(a);i<(b);++i)\n#define rep(i, n) for(ll i = 0; i < (ll)(n); i++)\n\n//container util\n#define all(x) (x).begin(),(x).end()\n\n//typedef\ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<ll> VLL;\ntypedef vector<VLL> VVLL;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef pair<ll, ll> PLL;\n\n\n//conversion\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ninline ll toLL(string s) {ll v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\n\n\nint main(){\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    int n,m,t,p;\n\n\n    while (true) {\n      cin >> n >> m >> t >> p;\n      if(n==0 && m==0) break;\n      //グラフの領域を確保する\n      VVI g(3*m,VI(3*n,0));\n      int d[t],c[t];\n      int x[p],y[p];\n      rep(i,m) rep(j,n) g[i][j] = 1;\n\n      rep(i,t) cin >> d[i] >> c[i];\n      rep(i,p) cin >> x[i] >> y[i];\n\n      // cout << \"newg --------------------\" << endl;\n      // rep(y,m*3){\n      //   rep(z,n*3) cerr<<g[y][z]<<\" \";\n      //   cerr<<endl;\n      // }\n      // cout << \"--------------------\" << endl;\n      rep(i,t){ //命令のループ\n        if (d[i]==1){// 左端から ci だけ右側を通る垂直の折り線の左側を右側に折り重ねる．\n          VVI newg(3*m,VI(3*n,0));\n          rep(j,m){\n            rep(k,c[i]){\n              //if(j == 0) printf(\"(%d,%d) = (%d,%d) + (%d,%d)\\n\",j,k,j,k,j,2*c[i]-1-k) ;\n              newg[j][c[i]-1-k] = g[j][k] + g[j][2*c[i]-1-k];\n            }\n            FOR(k,c[i],n*2){\n              newg[j][k] = g[j][k + c[i]];\n            }\n          }\n          // copy newg -> g\n          rep(height,3*m){\n            rep(width,3*n){\n              g[height][width] = newg[height][width];\n            }\n          }\n          // cout << \"1 --------------------\" << endl;\n          // rep(y,m*3){\n          //   rep(z,n*3) cerr<<g[y][z]<<\" \";\n          //   cerr<<endl;\n          // }\n          // cout << \"--------------------\" << endl;\n        }\n        else{\n          VVI newg(3*m,VI(3*n,0));\n          rep(k,n){\n            rep(j,c[i]){\n              newg[c[i]-1-j][k] = g[j][k] + g[2*c[i]-1-j][k];\n            }\n            FOR(j,c[i],2*m){\n              newg[j][k] = g[j+c[i]][k];\n            }\n          }\n\n          int om = -1;\n          int on = -1;\n          bool flag = true;\n          rep(height,3*m){\n            rep(width,3*n){\n              if(newg[height][width] != 0) {\n                g[height][width] = newg[height][width];\n                om = height;\n                on = width;\n                flag = false;\n              }\n              if(flag == false) break;\n            }\n            if(flag == false) break;\n          }\n          // copy newg -> g\n          FOR(height,om,3*m-om){\n            FOR(width,on,3*n-on){\n              g[height][width] = newg[height][width];\n            }\n          }\n\n          // cout << \"2 --------------------\" << endl;\n          // rep(y,m*3){\n          //   rep(z,n*3) cerr<<newg[y][z]<<\" \";\n          //   cerr<<endl;\n          // }\n          // cout << \"--------------------\" << endl;\n        }\n      }\n\n      rep(i,p){\n        cout<<g[y[i]][x[i]]<<endl;\n      }\n\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <numeric>\n#include <bitset>\n#include <cmath>\n\nstatic const int MOD = 1000000007;\nusing ll = long long;\nusing u32 = uint32_t;\nusing namespace std;\n\ntemplate<class T> constexpr T INF = ::numeric_limits<T>::max()/32*15+208;\n\nint main() {\n    int n, m, t, p;\n    while (cin >> n >> m >> t >> p, n){\n        vector<int> v(n, 1), u(m, 1);\n        for (int i = 0; i < t; ++i) {\n            int d, c;\n            cin >> d >> c;\n            if(d == 1){\n                vector<int> vv(max((int)v.size()-c, c));\n                for (int j = 0; j < vv.size(); ++j) {\n                    if(j+c < v.size()) vv[j] = v[j+c];\n                    if(c-1-j >= 0) vv[j] += v[c-1-j];\n                }\n                v.swap(vv);\n            }else {\n                vector<int> uu(max((int)u.size()-c, c));\n                for (int j = 0; j < uu.size(); ++j) {\n                    if(j+c < u.size()) uu[j] = u[j+c];\n                    if(c-1-j >= 0) uu[j] += u[c-1-j];\n                }\n                u.swap(uu);\n            }\n        }\n        for (int i = 0; i < p; ++i) {\n            int x, y;\n            cin >> x >> y;\n            cout << u[y]*v[x] << \"\\n\";\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n\nconst double eps = 1e-10;\nconst int MOD = 1000000007;\nconst int INF = 1000000000;\nconst ll LINF = 1ll<<50;\n\ntemplate<typename T>\nvoid printv(const vector<T>& s) {\n  for(int i=0;i<(int)(s.size());++i) {\n    cout << s[i];\n    if(i == (int)(s.size())-1) cout << endl;\n    else cout << \" \";\n  }\n}\n\nint main () {\n  cin.tie(0);\n  cout << fixed << setprecision(10);\n\n  while(1) {\n    int n, m, t, p; cin >> n >> m >> t >> p;\n    if(n == 0 && m == 0 && t == 0 && p == 0) break;\n    vector<vector<int>> s(1000, vector<int>(1000, 0));\n    for(int i=0;i<m;++i) {\n      for(int j=0;j<n;++j) {\n        s[i][j] = 1;\n      }\n    }\n    int cx = 0, cy = 0;\n    for(int i=0;i<t;++i) {\n      int d, c; cin >> d >> c;\n      if(d == 1) {\n        for(int i=cy; i<1000;++i) {\n          for(int j=0;j<c;++j) {\n            // cout << i << \":\" << j << endl;\n            s[i][cx+2*c-1-j] += s[i][cx+j];\n          }\n        }\n        cx += c;\n      } else {\n        for(int j=cx;j<1000;++j) {\n          for(int i=0;i<c;++i) {\n            s[cy+2*c-1-i][j] += s[cy+i][j];\n          }\n        }\n        cy += c;\n      }\n/*       cout << endl;\n      for(int i=0;i<m;++i) {\n        printv(s[i]);\n      } */\n    }\n/*     cout << endl;\n    for(int i=0;i<m;++i) {\n      printv(s[i]);\n    } */\n    for(int i=0;i<p;++i) {\n      int x, y; cin >> x >> y;\n      cout << s[cy+y][cx+x] << endl;\n    }\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<functional>\n#include<queue>\n#include<stack>\n#include<set>\n#include<map>\n#include<unordered_map>\n#include<climits>\n#include<cstdlib>\n#include<cmath>\n#include<string>\n#include<iomanip>\n#include<bitset>\n#include<list>\n\nusing namespace std;\n\n#define ll long long int\n\nll const MOD = 1000000007;\nll const INF = (long long int)1 << 61;\n\nll mypow(ll x,ll n){\n    ll ret = 1;\n    while(n > 0){\n        if(n&1){\n            ret = (ret*x)%MOD;\n        }\n        x = (x*x)%MOD;\n        n >>= 1;\n    }\n    return ret;\n}\n\nlist<ll> solve(ll w,ll h,ll n,ll m){\n    vector<vector<ll>> paper(20*h+1,vector<ll>(20*w+1,0));\n\n    for(int i = 0; i < h; i++){\n        for(int j = 0; j < w; j++){\n            paper[i][j] = 1;\n        }\n    }\n\n    vector<ll> a(n),b(n),c(m),d(m);\n    for(int i = 0; i < n; i++){\n        cin >> a[i] >> b[i];\n    }\n    for(int i = 0; i < m; i++){\n        cin >> c[i] >> d[i];\n    }\n\n    ll hb = 0;\n    ll wb = 0;\n\n    for(int i = 0; i < n; i++){\n        if(a[i] == 1){\n            for(int j = 0; j < b[i]; j++){\n                for(int k = 0; k < 20*h+1; k++){\n                    paper[k][(b[i] + wb) + abs(b[i] - j) - 1] += paper[k][wb + j];\n                    paper[k][wb + j] = 0;\n                }\n            }\n            wb += b[i];\n        }else{\n            for(int j = 0; j < b[i]; j++){\n                for(int k = 0; k < 20*w+1; k++){\n                    paper[(b[i] + hb) + abs(b[i] - j) - 1][k] += paper[hb + j][k];\n                    paper[hb + j][k] = 0;\n                }\n            }\n            hb += b[i];\n        }\n    }\n\n    list<ll> ans;\n\n    for(int i = 0; i < m; i++){\n        ans.push_back(paper[hb + d[i]][wb + c[i]]);\n        paper[hb + d[i]][wb + c[i]] = 0;\n    }\n    return ans;\n}\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    vector<list<ll>> ans;\n \n    while(true){\n        ll a,b,c,d;\n        cin >> a >> b >> c >> d;\n        if(a == 0 && b == 0 && c == 0 && d == 0){\n            break;\n        }\n        ans.push_back(solve(a,b,c,d));\n    }\n\n    for(auto &x: ans){\n        for(auto itr = x.begin(); itr != x.end(); itr++){\n            cout << *itr << endl;\n        }\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n//#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nint n,m,t,p;\nint type,c;\nvector<vector<ll> >q(1000);\nint main()\n{\n    while(~scanf(\"%d%d%d%d\",&m,&n,&t,&p)&&(m+n+t+p))\n    {\n        for(int i=0; i<n; i++)\n        {\n            for(int j=0; j<m; j++)\n            {\n                q[i].push_back(1ll);\n            }\n        }\n        while(t--)\n        {\n            scanf(\"%d%d\",&type,&c);\n            if(type==1)\n            {\n                for(int j=0; j<n; j++)\n                {\n                    for(int i=0; i<=c-1; i++)\n                        q[j][2*c-1-i]+=q[j][i];\n                }\n                for(int i=0; i<n; i++)\n                    for(int j=0; j<m-c; j++)\n                        q[i][j]=q[i][j+c];\n            }\n            else if(type==2)\n            {\n                for(int j=0; j<m; j++)\n                    for(int i=0; i<=c-1; i++)\n                    {\n                        q[2*c-1-i][j]+=q[i][j];\n                    }\n                q.erase(q.begin(),q.begin()+c);\n            }\n        }\n        int x,y;\n        ll ans=0;\n        while(p--)\n        {\n            scanf(\"%d%d\",&x,&y);\n            printf(\"%lld\\n\",q[y][x]);\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\nint main(){\n  while(true){\n    int n,m,t,p;\n    cin>>n>>m>>t>>p;\n    if(n==0&&m==0){\n      if(t==0&&p==0){\n        break;\n      }\n    }\n    int Ori[64][64]={{0}};\n    for (int y=0;y<m;y++){\n      for(int x=0;x<n;x++){\n        Ori[y][x]=1;\n      }\n    }\n    for(int i=0;i<t;i++){\n      int d,c;\n      cin>>d>>c;\n      if(d==1){\n        for(int x=0;x<c;x++){\n          for(int y=0;y<m;y++){\n            Ori[y][2*c-1-x]+=Ori[y][x];\n            Ori[y][x]=0;\n          }\n        }\n        for(int x=0;x<n;x++){\n          for(int y=0;y<m;y++){\n            Ori[y][x]+=Ori[y][x+c];\n            Ori[y][x+c]=0;\n          }\n        }\n      }else{\n        for(int x=0;x<n;x++){\n          for(int y=0;y<c;y++){\n            Ori[2*c-1-y][x]+=Ori[y][x];\n            Ori[y][x]=0;\n          }\n        }\n        for(int x=0;x<n;x++){\n          for(int y=0;y<m;y++){\n            Ori[y][x]+=Ori[y+c][x];\n            Ori[y+c][x]=0;\n          }\n        }\n      }\n    }\n    for(int i=0;i<p;i++){\n      int x,y;\n      cin>>x>>y;\n      cout<<Ori[y][x]<<endl;\n    }\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\nint main(void){\n    // Your code here!\n    //w h oru hole\n    \n    while(1){\n    \n    int w = 0;\n    int h = 0;\n    int zure_w = 0;\n    int zure_h = 0;\n    int koe_w = 0;\n    int koe_h = 0;\n    int oru_count = 0;\n    int hole_count = 0;\n    \n    scanf(\"%d\",&w);\n    scanf(\"%d\",&h);\n    scanf(\"%d\",&oru_count);\n    scanf(\"%d\",&hole_count);\n    \n    if(w ==0 && h==0 && oru_count==0 && hole_count==0)break;\n    \n    static int oru_dir[30] = {0};\n    static int oru_dist[30] = {0};\n    \n    for(int i=0;i<oru_count;i++){\n        scanf(\"%d\",&oru_dir[i]);\n        scanf(\"%d\",&oru_dist[i]);\n    }\n    \n    static int hole_x[30] = {0};\n    static int hole_y[30] = {0};\n    for(int i=0;i<hole_count;i++){\n        scanf(\"%d\",&hole_x[i]);\n        scanf(\"%d\",&hole_y[i]);\n    }\n    \n    static int map[100][100];\n    \n    for(int i=0;i<100;i++){\n        for(int j=0;j<100;j++){\n            if(j<h && i<w)\n            map[i][j] = 1;\n            else map[i][j] = 0;\n        }\n    }\n    \n    for(int i=0;i<oru_count;i++){\n        if(oru_dir[i] == 1){\n            for(int k=0;k<h+koe_h;k++){\n                for(int itr = zure_w;itr<zure_w+oru_dist[i]+koe_w;itr++){\n                    map[k][itr+oru_dist[i]]+=map[k][itr];\n                }\n            }\n            if(zure_w+oru_dist[i]*2-1>w+koe_w-1)koe_w+=zure_w+oru_dist[i]*2-1-(w-1);\n            zure_w += oru_dist[i];\n        }\n        else{\n            for(int k=h-1-zure_h;k>(h-1)-(zure_h+oru_dist[i]);k--){\n                for(int itr = zure_w;itr<w+koe_w;itr++){\n                    map[k-oru_dist[i]][itr]+=map[k][itr];\n                }\n            }\n            if(zure_h+oru_dist[i]*2>h+koe_h-1)koe_h+=zure_h+oru_dist[i]*2-(h-1);\n            zure_h += oru_dist[i];\n        }\n    }\n    \n    for(int i=0;i<hole_count;i++){\n        cout << map[h-1-(hole_y[i]+zure_h)][hole_x[i]+zure_w] << endl;\n    }\n    }\n    \n    /*for(int i=0;i<h+koe_h;i++){\n        for(int j=0;j<w+koe_w;j++){\n            cout << map[i][j] << \" \";\n        }\n        cout << endl;\n    }\n    \n    cout << sum << endl;*/\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\ntypedef long long ll;\n\nint u[700][700];\n\nint r=0;\n\nint main(){\n\tint n,m,t,p;\n\twhile(cin >> n >> m >> t >> p,n&&m&&t&&p){\n\t\tfor(int i=0;i<700;i++){\n\t\t\tfor(int j=0;j<700;j++){\n\t\t\t\tu[i][j]=0;\n\t\t\t}\n\t\t}\n\t\tvector<int> d(t),c(t),x(p),y(p);\n\t\tfor(int i=0;i<t;i++){\n\t\t\tcin >> d[i] >> c[i];\n\t\t}\n\t\tfor(int i=0;i<p;i++){\n\t\t\tcin >> x[i] >> y[i];\n\t\t}\n\t\tint xx=r,yy=r;\n\t\tint xxx=r+n,yyy=r+m;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int j=0;j<m;j++){\n\t\t\t\tu[xx+i][yy+j]=1;\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<t;i++){\n\t\t\tif(d[i]==1){\n\t\t\t\tfor(int k=yy;k<yyy;k++){\n\t\t\t\t\tint pp=1;\n\t\t\t\t\tfor(int j=xx+c[i];j<xx+c[i]+35;j++){\n\t\t\t\t\t\tif(j-pp>=0){\n\t\t\t\t\t\t\tu[j][k]+=u[j-pp][k];\n\t\t\t\t\t\t\tu[j-pp][k]=0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpp+=2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\txx+=c[i];\n\t\t\t\tfor(int j=35;j>=0;j--){\n\t\t\t\t\tif(u[xx+j][yy]>=1){\n\t\t\t\t\t\txxx=xx+j+1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfor(int k=xx;k<xxx;k++){\n\t\t\t\t\tint pp=1;\n\t\t\t\t\tfor(int j=yy+c[i];j<yy+c[i]+35;j++){\n\t\t\t\t\t\tif(j-pp>=0){\n\t\t\t\t\t\t\tu[k][j]+=u[k][j-pp];\n\t\t\t\t\t\t\tu[k][j-pp]=0;\n\t\t\t\t\t\t\t//cout << u[k][j-pp] << \" \" << j << \" \" << pp << endl;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpp+=2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tyy+=c[i];\n\t\t\t\tfor(int j=35;j>=0;j--){\n\t\t\t\t\tif(u[xx][yy+j]>=1){\n\t\t\t\t\t\tyyy=yy+j+1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<p;i++){\n\t\t\tprintf(\"%d\\n\",u[xx+x[i]][yy+y[i]]);\n\t\t}\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\nusing namespace std;\n\nclass Point{\npublic:\n    int x, y, id;\n    Point(int x, int y, int id): x(x), y(y), id(id){}\n};\n\nint main(){\n    int N, M, T, P;\n    while(cin >> N >> M >> T >> P, N|M|T|P){\n        vector<int> D(T), C(T);\n        for(int i=0; i<T; i++)\n            cin >> D[i] >> C[i];\n        \n        vector<Point> points;\n        for(int i=0; i<P; i++){\n            int x, y; cin >> x >> y;\n            points.emplace_back(x, y, i);\n        }\n        \n        for(int i=T-1; i>=0; i--){\n            vector<Point> tpoints;\n            for(auto p: points){\n                if(D[i] == 1){\n                    if(p.x<C[i])\n                        tpoints.emplace_back(C[i]-p.x-1, p.y, p.id);\n                    tpoints.emplace_back(p.x+C[i], p.y, p.id);\n                }else{\n                    if(p.y<C[i])\n                        tpoints.emplace_back(p.x, C[i]-p.y-1, p.id);\n                    tpoints.emplace_back(p.x, p.y+C[i], p.id);\n                }\n            }\n            points = tpoints;\n        }\n        vector<int> counts(P);\n        for(auto p: points) if(p.x<N && p.y<M)\n            counts[p.id]++;\n        \n        for(auto v: counts)\n            cout << v << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <vector>\n\nusing namespace std;\nusing ll = long long;\n\nvector<vector<int>> f(vector<vector<int>>& a, int c) {\n\tint m = a.size();\n\tint n = a[0].size();\n\t//cout << m << \" \" << n << endl;\n\tvector<vector<int>> na;\n\tif (c + c <= n) {\n\t\tna.resize(m);\n\t\tfor (int i = 0; i < m; i++) na[i].resize(n - c);\n\t\tfor (int i = 0; i < m; i++) {\n\t\t\tfor (int j = 0; j < c; j++) {\n\t\t\t\t//cout << na.size() << \" \" << na[0].size() << \" \" << i << \" \" << j << \" \" << c + c - 1 - j << \"\\n\";\n\t\t\t\tna[i][j] = a[i][c - 1 - j] + a[i][c + j];\n\t\t\t}\n\t\t\tfor (int j = c; j < na[i].size(); j++) {\n\t\t\t\tna[i][j] = a[i][j + c];\n\t\t\t}\n\t\t}\n\t}\n\telse {\n\t\tna.resize(m);\n\t\tfor (int i = 0; i < m; i++) na[i].resize(c);\n\t\tint cnt = n - c;\n\t\tfor (int i = 0; i < m; i++) {\n\t\t\tfor (int j = 0; j < cnt; j++) {\n\t\t\t\tna[i][j] = a[i][c + j] + a[i][c - 1 - j];\n\t\t\t}\n\t\t\tfor (int j = cnt; j < na[i].size(); j++) {\n\t\t\t\tna[i][j] = a[i][c - 1 - j];\n\t\t\t}\n\t\t}\n\t}\n\treturn na;\n}\nvoid suzuken() {\n\tll n, m, t, p; scanf(\"%lld %lld %lld %lld\", &n, &m, &t, &p); if (n == 0 and m == 0 and t == 0 and p == 0) exit(0);\n\tvector<vector<int>> a(m, vector<int>(n, 1));\n\twhile (t--) {\n\t\tint d, c; scanf(\"%d %d\", &d, &c);\n\t\tvector<vector<int>> na;\n\t\tif (d == 1) {\n\t\t\tna = f(a, c);\n\t\t}\n\t\telse {\n\t\t\tvector<vector<int>> b(n, vector<int>(m));\n\t\t\tfor (int i = 0; i < m; i++) {\n\t\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\t\tb[n - 1 - j][m - 1 - i] = a[i][j];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tauto nb = f(b, c);\n\n\t\t\tna = vector<vector<int>>(nb[0].size(), vector<int>(nb.size()));\n\t\t\tfor (int i = 0; i < nb.size(); i++) {\n\t\t\t\tfor (int j = 0; j < nb[0].size(); j++) {\n\t\t\t\t\tna[nb[0].size() - 1 - j][nb.size() - 1 - i] = nb[i][j];\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\ta = na;\n\t\tm = a.size();\n\t\tn = a[0].size();\n\t\t/*\n\t\tfor (int i = 0; i < m; i++) {\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tcerr << a[i][j];\n\t\t\t}\n\t\t\tcerr << \"\\n\";\n\t\t}\n\t\t*/\n\t\n\t}\n\n\twhile (p--) {\n\t\tint x, y; scanf(\"%d %d\", &x, &y);\n\t\t//cerr << \"^^^^^^^^^^^^^^^^^^^^^^^^\" << \"\\n\";\n\t\tcout << a[m - 1 - y][x] << \"\\n\";\n\t\t//cerr << \"^\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\" << \"\\n\";\n\t}\n\t//cout << res << \"\\n\";\n}\nint main() {\n\tint kkt = 89;\n\twhile (kkt) {\n\t\tsuzuken();\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n\nusing namespace std;\n\nint main(){\n    int n,m,p,t;\n    while(true){\n        cin>>n>>m>>t>>p;\n        if(n==0&&m==0&&t==0&&p==0){\n            break;\n        }\n        int d,c,x,y;\n        int pp[40][40];\n        for(int i=0;i<m;++i){\n            for(int j=0;j<n;++j){\n                pp[i][j]=1;\n            }\n        }\n        int h=m,w=n;\n        for(int i=0;i<t;++i){\n            cin>>d>>c;\n            int a[40][40]={0},b[40][40]={0};\n            if(d==1){\n                for(int j=0;j<h;++j){\n                    for(int k=0;k<c;++k){\n                        a[j][c-1-k]=pp[j][k];\n                    }\n                    for(int k=0;k<w-c;++k){\n                        b[j][k]=pp[j][k+c];\n                    }\n                }\n                w=max(c,w-c);\n                for(int j=0;j<w;++j){\n                    for(int k=0;k<h;++k){\n                        pp[k][j]=a[k][j]+b[k][j];\n                        //cout<<pp[0][0]<<endl;\n                    }\n                }\n            }\n            else{\n                for(int j=0;j<w;++j){\n                    for(int k=0;k<c;++k){\n                        a[c-1-k][j]=pp[k][j];\n                    }\n                    for(int k=0;k<h-c;++k){\n                        b[k][j]=pp[k+c][j];\n                    }\n                }\n                h=max(c,h-c);\n                for(int j=0;j<w;++j){\n                    for(int k=0;k<h;++k){\n                        pp[k][j]=a[k][j]+b[k][j];\n                        //cout<<pp[0][0]<<endl;\n                    }\n                }\n            }\n        }\n        \n        for(int i=0;i<p;++i){\n            cin>>x>>y;\n            cout<<pp[y][x]<<endl;\n        }\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,n) for(int i=0,i##_cond=(n);i<i##_cond;++i)\n#define FOR(i,a,b) for(int i=(a),i##_cond=(b);i<i##_cond;++i)\nusing vi  = vector<int>;\nusing vvi = vector<vi>;\n\nint main(){\n  int n, m, t, p;\n  while(cin >> n >> m >> t >> p, n){\n    vvi paper(600, vi(600));\n    rep(i,n) rep(j,m) paper[i][j] = 1;\n\n    int x = 0, y = 0;\n    rep(_,t){\n      int d, c;\n      cin >> d >> c;\n      if(d == 1){\n\tFOR(i,x,x+c) FOR(j,y,y+m){\n\t  paper[(x+c)+(x+c-1-i)][j] += paper[i][j];\n\t}\n\tx += c;\n      }else{\n\tFOR(i,x,x+n) FOR(j,y,y+c){\n\t  paper[i][(y+c)+(y+c-1-j)] += paper[i][j];\n\t}\n\ty += c;\n      }\n    }\n\n    rep(_,p){\n      int xq, yq;\n      cin >> xq >> yq;\n      cout << paper[x+xq][y+yq] << endl;\n    }\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\nint main(void){\n    // Your code here!\n    //w h oru hole\n    \n    while(1){\n    \n    int w = 0;\n    int h = 0;\n    int zure_w = 0;\n    int zure_h = 0;\n    int koe_w = 0;\n    int koe_h = 0;\n    int oru_count = 0;\n    int hole_count = 0;\n    \n    scanf(\"%d\",&w);\n    scanf(\"%d\",&h);\n    scanf(\"%d\",&oru_count);\n    scanf(\"%d\",&hole_count);\n    \n    if(w ==0 && h==0 && oru_count==0 && hole_count==0)break;\n    \n    static int oru_dir[30] = {0};\n    static int oru_dist[30] = {0};\n    \n    for(int i=0;i<oru_count;i++){\n        scanf(\"%d\",&oru_dir[i]);\n        scanf(\"%d\",&oru_dist[i]);\n    }\n    \n    static int hole_x[30] = {0};\n    static int hole_y[30] = {0};\n    for(int i=0;i<hole_count;i++){\n        scanf(\"%d\",&hole_x[i]);\n        scanf(\"%d\",&hole_y[i]);\n    }\n    \n    static int map[100][100];\n    \n    for(int i=0;i<100;i++){\n        for(int j=0;j<100;j++){\n            if(j<h && i<w)\n            map[i][j] = 1;\n            else map[i][j] = 0;\n        }\n    }\n    \n    for(int i=0;i<oru_count;i++){\n        if(oru_dir[i] == 1){\n            for(int k=0;k<h+koe_h;k++){\n                for(int itr = zure_w;itr<zure_w+oru_dist[i]+koe_w;itr++){\n                    map[k][itr+oru_dist[i]]+=map[k][itr];\n                }\n            }\n            if(zure_w+oru_dist[i]*2-1>w+koe_w-1)koe_w+=zure_w+oru_dist[i]*2-1-(w-1);\n            zure_w += oru_dist[i];\n        }\n        else{\n            for(int k=h-1-zure_h;k>(h-1)-(zure_h+oru_dist[i]);k--){\n                for(int itr = zure_w;itr<w+koe_w;itr++){\n                    map[k-oru_dist[i]][itr]+=map[k][itr];\n                }\n            }\n            if(zure_h+oru_dist[i]*2>h+koe_h-1)koe_h+=zure_h+oru_dist[i]*2-(h-1);\n            zure_h += oru_dist[i];\n        }\n    }\n    \n    for(int i=0;i<hole_count;i++){\n        cout << map[h-1-(hole_y[i]+zure_h)][hole_x[i]+zure_w] << endl;\n    }\n    }\n    \n    /*for(int i=0;i<h+koe_h;i++){\n        for(int j=0;j<w+koe_w;j++){\n            cout << map[i][j] << \" \";\n        }\n        cout << endl;\n    }\n    \n    cout << sum << endl;*/\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#ifndef _GLIBCXX_NO_ASSERT\n#include <cassert>\n#endif\n#include <cctype>\n#include <cerrno>\n#include <cfloat>\n#include <ciso646>\n#include <climits>\n#include <clocale>\n#include <cmath>\n#include <csetjmp>\n#include <csignal>\n#include <cstdarg>\n#include <cstddef>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n\n#if __cplusplus >= 201103L\n#include <ccomplex>\n#include <cfenv>\n#include <cinttypes>\n#include <cstdbool>\n#include <cstdint>\n#include <ctgmath>\n#include <cwchar>\n#include <cwctype>\n#endif\n\n// C++\n#include <algorithm>\n#include <bitset>\n#include <complex>\n#include <deque>\n#include <exception>\n#include <fstream>\n#include <functional>\n#include <iomanip>\n#include <ios>\n#include <iosfwd>\n#include <iostream>\n#include <istream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <locale>\n#include <map>\n#include <memory>\n#include <new>\n#include <numeric>\n#include <ostream>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <stdexcept>\n#include <streambuf>\n#include <string>\n#include <typeinfo>\n#include <utility>\n#include <valarray>\n#include <vector>\n\n#if __cplusplus >= 201103L\n#include <array>\n#include <atomic>\n#include <chrono>\n#include <condition_variable>\n#include <forward_list>\n#include <future>\n#include <initializer_list>\n#include <mutex>\n#include <random>\n#include <ratio>\n#include <regex>\n#include <scoped_allocator>\n#include <system_error>\n#include <thread>\n#include <tuple>\n#include <typeindex>\n#include <type_traits>\n#include <unordered_map>\n#include <unordered_set>\n#endif\nusing namespace std;\n\ntypedef long long ll;\n//typedef pair<int,int> Pint;\n//typedef pair<ll, ll> P;\n//typedef pair<ll, pair<ll, ll>> P;\n//typedef tuple<int,int,int> T;\ntypedef vector<ll> vec;\ntypedef vector<vec> mat;\n#define rep(i, n) for(ll i = 0; i < n; i++)\n#define revrep(i, n) for(ll i = n-1; i >= 0; i--)\n#define pb push_back\n#define f first\n#define s second\nll INFL = 1LL << 60;//10^18 = 2^60\nint INF = 1 << 30;//10^9\nll MOD = 1e9 + 7;\n//ll MOD  = 998244353;\nvector<ll> dy = {0, 0, 1, -1, 1, 1, -1, -1, 0};\nvector<ll> dx = {1, -1, 0, 0, 1, -1, 1, -1, 0};\n\nll max(ll a, ll b){return (a > b) ? a : b;}\nll min(ll a, ll b){return (a < b) ? a : b;}\nll pow_long(ll x, ll k){\n  ll res = 1;\n  while(k > 0){\n    if(k % 2) res *= x;\n    x *= x;\n    k /= 2;\n  }\n  return res;\n}\n\nll pow_mod(ll x, ll k){\n  x %= MOD; x += MOD; x %= MOD;\n  ll res = 1;\n  while(k > 0){\n    if(k % 2){\n      res *= x; res %= MOD;\n    }\n    x *= x; x %= MOD;\n    k /= 2;\n  }\n  return res;\n}\nll inverse(ll x){return pow_mod(x, MOD - 2);};\n\nll gcd(ll a, ll b){\n    if(b == 0) return a;\n    return gcd(b, a % b);\n}\nll lcm(ll x, ll y){return x / gcd(x, y) * y % MOD;};\n\nvector<ll> add(vector<ll> T, vector<ll> S){\n  vector<ll> res(S.size(), 0);\n  rep(i, S.size()) res[i] = S[i] + T[i];\n  return res;\n}\nvector<ll> pile(vector<ll> S){\n  vector<ll> res(S.size(), 0);\n  rep(i, S.size()){\n    if(i == 0) continue;\n    res[i] = S[i-1];\n  }\n  return res;\n}\n\nint main(){\n  while(true){\n    ll N, M, T, P; cin >> N >> M >> T >> P;\n    if(N == 0 && M == 0 && T == 0 && P == 0) break;\n    vector<ll> d(T), c(T);\n    vector<ll> x(P), y(P);\n    rep(i, T) cin >> d[i] >> c[i];\n    rep(i, P) cin >> x[i] >> y[i];\n    vector<vector<ll>> cnt(M, vector<ll>(N, 1));\n    rep(t, T){\n      if(d[t] == 1){\n        if(c[t] <= N - c[t]){\n          vector<vector<ll>> nextcnt(M, vector<ll>(N-c[t], 0));\n          rep(i, M)rep(j, N-c[t]){\n            if(j < c[t]) nextcnt[i][j] = cnt[i][c[t]+j] + cnt[i][c[t]-1-j];\n            else nextcnt[i][j] = cnt[i][c[t]+j];\n          }\n          N = N - c[t];\n          cnt = nextcnt;\n        }else{\n          vector<vector<ll>> nextcnt(M, vector<ll>(c[t], 0));\n          rep(i, M)rep(j, c[t]){\n            if(j < N - c[t]) nextcnt[i][j] = cnt[i][c[t]+j] + cnt[i][c[t]-1-j];\n            else nextcnt[i][j] = cnt[i][c[t]-1-j];\n          }\n          N = c[t];\n          cnt = nextcnt;\n        }\n      }else{\n        if(c[t] <= M - c[t]){\n          vector<vector<ll>> nextcnt(M-c[t], vector<ll>(N, 0));\n          rep(i, M-c[t])rep(j, N){\n            if(i < c[t]) nextcnt[i][j] = cnt[c[t]-1-i][j] + cnt[c[t]+i][j];\n            else nextcnt[i][j] = cnt[c[t]+i][j];\n          }\n          M = M-c[t];\n          cnt = nextcnt;\n        }else{\n          vector<vector<ll>> nextcnt(c[t], vector<ll>(N, 0));\n          rep(i, c[t])rep(j, N){\n            if(i < M - c[t]) nextcnt[i][j] = cnt[c[t]+i][j] + cnt[c[t]-1-i][j];\n            else nextcnt[i][j] = cnt[c[t]-1-i][j];\n          }\n          M = c[t];\n          cnt = nextcnt;\n        }\n      }\n    }\n    rep(i, P){\n      cout << cnt[y[i]][x[i]] << endl;\n    }\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cstring>\nusing namespace std;\nint M,N,T,P,d,c;\nint a[65][65];\nint vis[65][65];\nint cnt;\nvoid rev () {\n\tint t = N & 1;\n\tt ^= 1;\n\n    for(int i = 0;i < N / 2;++i)\n\t\tfor(int j = 0;j < M;++j)\n\t\t\tswap(a[i][j],a[N / 2 - i + N / 2 - t][j]);\n}\n\nint main () {\n\twhile(1) {\n\t\tscanf(\"%d%d%d%d\",&M,&N,&T,&P);\n\n        for(int i = 0;i < N;++i)\n\t\t\tfor(int j = 0;j < M;++j) {\n\t\t\t\ta[i][j] = 1;\n\t\t\t\tvis[i][j] = 1;\n\t\t\t}\n\n\n\n\n        for(int i = 1;i <= T;++i) {\n\t\t\t++cnt;\n\t\t\tscanf(\"%d%d\",&d,&c);\n\n\t\t\tif(d == 1) {\n\t\t\t\t\tfor(int j = 0;j < c;++j) {\n\t\t\t\t\t\tfor(int k = 0;k < N;++k) {\n\t\t\t\t\t\t\tif(vis[k][c - j + c - 1] == cnt)\n\t\t\t\t\t\t\t\ta[k][c - j + c - 1] += a[k][j];\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\ta[k][c - j + c - 1] = a[k][j];\n\t\t\t\t\t\t\t\tvis[k][c - j + c - 1] = cnt;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(M - c > c)\n\t\t\t\t\t\tM = M - c;\n\t\t\t\t\telse M = c;\n\t\t\t\t\tfor(int j = 0;j < N;++j) {\n\t\t\t\t\t\tfor(int k = 0;k < M;++k) {\n\t\t\t\t\t\t\ta[j][k] = a[j][k + c];\n\t\t\t\t\t\t\tvis[j][k] = cnt + 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t\tfor(int j = 0;j < c;++j) {\n\t\t\t\t\t\tfor(int k = 0;k < M;++k) {\n\t\t\t\t\t\t\tif(vis[c - j + c - 1][k] == cnt)\n\t\t\t\t\t\t\t\ta[c - j + c - 1][k] += a[j][k];\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\ta[c - j + c - 1][k] = a[j][k];\n\t\t\t\t\t\t\t\tvis[c - j + c - 1][k] = cnt;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n                    if(c > N - c)\n\t\t\t\t\t\tN = c;\n\t\t\t\t\telse N -= c;\n\t\t\t\t\tfor(int j = 0;j < N;++j)\n\t\t\t\t\t\tfor(int k = 0;k < M;++k) {\n                            a[j][k] = a[j + c][k];\n\t\t\t\t\t\t\tvis[j][k] = cnt + 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t//rev();\n\t\t\t}\n        }\n\n\t\tint ans = 0,x,y;\n        for(int i = 1;i <= P;++i) {\n        \tscanf(\"%d%d\",&x,&y);\n            printf(\"%d\\n\",a[y][x]);\n        }\n\n\t}\n}\n/*\n10 8 3 2\n2 2\n1 3\n1 1\n0 1\n*/\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n\nusing namespace std;\nusing vec = vector<int>;\nusing mat = vector<vec>;\nconst int SIZE = 640;\n\nbool solve()\n{\n  int n,m,t,p;\n  if(n==0) return false;\n  cin >> n >> m >> t >> p;\n  mat kami(SIZE,vec(SIZE,0));\n  int Ox=0,Oy=0;\n  \n  for(int x=0;x<n;++x)\n    for(int y=0;y<m;++y)\n    \tkami[y][x]=1;\n  \n  for(int i=0;i<t;++i)\n  {\n    int d,c; cin >> d >> c;\n    if(d==1)\n    {\n      for(int y=0;y+Oy<SIZE;++y)\n      {\n        for(int x=0;x<c;++x)\n        {\n          kami[Oy+y][Ox+2*c-x-1] += kami[Oy+y][Ox+x];\n        }\n      }\n      Ox += c;\n    }\n    else if(d==2)\n    {\n      for(int y=0;y<c;++y)\n      {\n        for(int x=0;x+Ox<SIZE;++x)\n        {\n          kami[Oy+2*c-y-1][Ox+x] += kami[Oy+y][Ox+x];\n        }\n      }\n      Oy += c;\n    }\n  }\n  \n\n  \n  \n  int ans = 0;\n  for(int i=0;i<p;++i)\n  {\n    int x,y;cin >> x >> y;\n    cout << kami[Oy+y][Ox+x] << endl;\n  }\n  \n  return true;\n}\n\nint main()\n{\n  while(solve());\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<string>\n#include<iostream>\n#include<cstdlib>\n\ntypedef struct paper\n{\n\tint mat[32][32];\n\tint w;\n\tint h;\n} Paper;\n\nvoid initPaper(int m, int n, Paper *p);\nvoid copyPaper(Paper *ps, Paper *pt);\nvoid printPaper(Paper *p);\nint getHole(int x, int y, Paper *p);\nvoid reversePaper(int vh, Paper *p);\n\nvoid initPaper(int m, int n, Paper *p, int initNum)\n{\n\tint i = 0, j = 0;\n\tp->w = m;\n\tp->h = n;\n\tfor(j = 0;j < p->h;j++)\n\t{\n\t\tfor(i = 0;i < p->w;i++)\n\t\t{\n\t\t\tp->mat[i][j] = initNum;\n\t\t}\n\t}\n\treturn;\n}\n\nvoid copyPaper(Paper *ps, Paper *pt)\n{\n\tint i, j;\n\tpt->w = ps->w;\n\tpt->h = ps->h;\n\tfor(i = 0; i < ps->w; i++)\n\t\tfor(j = 0; j < ps->h; j++)\n\t\t\tpt->mat[i][j] = ps->mat[i][j];\n\treturn;\n}\n\nvoid printPaper(Paper *p)\n{\n\tint i, j;\n\tfor(j = 0; j < p->h; j++)\n\t{\n\t\tfor(i = 0; i < p->w; i++)\n\t\t\tstd::cout << p->mat[i][(p->h)-1-j] << \" \";\n\t\tstd::cout << std::endl;\n\t}\n\treturn;\n}\n\nint getHole(int x, int y, Paper *p)\n{\n\treturn p->mat[x][y];\n}\n\nvoid reversePaper(int vh, Paper *p)\n{\n\tint i, j, tmp;\n\tfor(i = 0; (vh == 1?i*2:i) < p->w;i++)\n\t\tfor(j = 0; (vh == 2?j*2:j) < p->h; j++)\n\t\t{\n\t\t\ttmp = p->mat[i][j];\n\t\t\tp->mat[i][j] = p->mat[(vh == 1?(p->w)-i-1:i)][(vh == 2?(p->h)-j-1:j)];\n\t\t\tp->mat[(vh == 1?(p->w)-i-1:i)][(vh == 2?(p->h)-j-1:j)] = tmp;\n\t\t}\n\treturn;\n}\nvoid foldPaper(int vh, int n, Paper *p)\n{\n\tint i, j;\n\tPaper tmp;\n\tif(vh == 1)\n\t{\n\t\tinitPaper(((p->w)-n > n? (p->w)-n:n), p->h, &tmp, 1);\n\t\tfor(j = 0; j < p->h; j++)\n\t\t\tfor(i = 0; i < p->w; i++)\n\t\t\t{\n\t\t\t\tif(i < n)\n\t\t\t\t\ttmp.mat[n-i-1][j] = p->mat[i][j]+ ((n-i)+n-1 >= (p->w)?0:p->mat[2*n-i-1][j]);\n\t\t\t\telse \n\t\t\t\t\ttmp.mat[i][j] = p->mat[n+i][j];\n\t\t\t}\n\t}\n\tif(vh == 2)\n\t{\n\t\tinitPaper(p->w, ((p->h)-n > n? (p->h)-n:n), &tmp, 1);\n\t\tfor(j = 0; j < p->h; j++)\n\t\t\tfor(i = 0; i < p->w; i++)\n\t\t\t{\n\t\t\t\tif(j < n)\n\t\t\t\t\ttmp.mat[i][n-j-1] = p->mat[i][j]+ ((n-j)+n-1 >= (p->h)?0:p->mat[i][2*n-j-1]);\n\t\t\t\telse\n\t\t\t\t\ttmp.mat[i][j] = p->mat[i][n+j];\n\t\t\t}\n\t}\n\tcopyPaper(&tmp, p);\n}\n\nint main()\n{\n\tPaper p1;\n\tint foldn = 0, holen = 0, x, y, w, h, i, mode, foldL;\n\tstd::string property;\n\tdo\n\t{\n\t\tstd::getline(std::cin, property);\n\t\tw = std::stoi(property.substr(0, property.find_first_of(\" \")));\n\t\tproperty = property.substr(property.find_first_of(\" \")+1,property.size()-property.find_first_of(\" \"));\n\t\th = std::stoi(property.substr(0, property.find_first_of(\" \")));\n\t\tproperty = property.substr(property.find_first_of(\" \")+1,property.size()-property.find_first_of(\" \"));\n\t\tfoldn = std::stoi(property.substr(0, property.find_first_of(\" \")));\n\t\tproperty = property.substr(property.find_first_of(\" \")+1,property.size()-property.find_first_of(\" \"));\n\t\tholen = std::stoi(property.substr(0, property.find_first_of(\" \")));\n\t\tproperty = property.substr(property.find_first_of(\" \")+1,property.size()-property.find_first_of(\" \"));\n\t\tinitPaper(w, h, &p1, 1);\n\t\tfor(i = 0; i < foldn; i++)\n\t\t{\n\t\t\tstd::getline(std::cin, property);\n\t\t\tmode = std::stoi(property.substr(0, property.find_first_of(\" \")));\n\t\t\tproperty = property.substr(property.find_first_of(\" \")+1,property.size()-property.find_first_of(\" \")); \n\t\t\tfoldL = std::stoi(property.substr(0, property.find_first_of(\" \")));\n\t\t\tfoldPaper(mode, foldL, &p1);\n\t\t\t//printPaper(&p1);\n\t\t\t//std::cout << std::endl;\n\t\t}\n\t\tfor(i = 0; i < holen; i++)\n\t\t{\n\t\t\tstd::getline(std::cin, property);\n\t\t\tx = std::stoi(property.substr(0, property.find_first_of(\" \")));\n\t\t\tproperty = property.substr(property.find_first_of(\" \")+1,property.size()-property.find_first_of(\" \")); \n\t\t\ty = std::stoi(property.substr(0, property.find_first_of(\" \")));\n\t\t\tproperty = property.substr(property.find_first_of(\" \")+1,property.size()-property.find_first_of(\" \")); \n\t\t\tstd::cout << getHole(x, y, &p1) << std::endl;\n\t\t}\n\t}while(!(p1.w==0 && p1.h==0 && foldn==0 && holen==0));\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\nint g[650][650];\nvoid initial(int n,int m){\n    for(int i=0; i<n; i++)\n        for(int j=0; j<m; j++)\n            g[i][j] = 1;\n    for(int i=n; i<650; i++)\n        for(int j=0; j<650; j++)\n            g[i][j] = 0;\n    for(int i=0; i<n; i++)\n        for(int j=m; j<650; j++)\n            g[i][j] = 0;\n}\n\nvoid  pf(int w1,int wid,int w2,int hig){\n    for(int i=w2+hig-1; i>=w2; i--){\n        for(int j=w1; j<w1+wid; j++){\n            printf(\"%d \",g[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n\nvoid opt(int d,int c,int& wid,int& hig,int& w1,int& w2){\n    if(d==1){\n        for(int j=0; j<c; j++){\n            for(int i=w2; i<w2+hig; i++){\n                int f = g[i][w1+j] + g[i][2*c-1-j+w1];\n                g[i][w1+j] = f;\n                g[i][2*c-1-j+w1] = f;\n            }\n        }\n        w1+=c;\n        wid = max(c,wid-c);\n    }\n    else if(d==2){\n        for(int i=0; i<c; i++){\n            for(int j=w1; j<w1+wid; j++){\n                int f = g[w2+i][j] + g[2*c-1-i+w2][j];\n                g[w2+i][j] = f;\n                g[2*c-1-i+w2][j] = f;\n            }\n        }\n        w2+=c;\n        hig = max(c,hig-c);\n    }\n    // pf(w1,wid,w2,hig);\n}\n\nint main(){\n    int n,m,t,p;\n    while(scanf(\"%d%d%d%d\",&m,&n,&t,&p)&&!(n==0&&m==0&&t==0&&p==0)){\n        initial(n,m);\n        int w1=0,w2=0,wid=m,hig=n;\n        //pf(w1,wid,w2,hig);\n        while(t--){\n            int d,c;\n            scanf(\"%d%d\",&d,&c);\n            opt(d,c,wid,hig,w1,w2);\n        }\n        while(p--){\n            int x,y;\n            scanf(\"%d%d\",&x,&y);\n            x+=w1,y+=w2;\n            printf(\"%d\\n\",g[y][x]);\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<string>\n#include<iomanip>\n#include<set>\n\nusing namespace std;\n\nint main()\n{\n\tint n,m,t,p;\n\twhile(true)\n\t{\n\t\tcin >> n >> m >> t >> p;\n\t\tif(n==0)break;\n\t\tvector<vector<int> > mp(70,vector<int>(70,0));\n\t\tvector<vector<int> > tmpmp(70,vector<int>(70,0));\n\t\tfor(int i=0;i<n;i++)\n\t\t\tfor(int j=0;j<m;j++)\n\t\t\t\tmp[i][j]=1;\n\t\tfor(int i=0;i<t;i++)\n\t\t{\n\t\t\tint d,c;\n\t\t\tcin >> d >> c;\n\t\t\ttmpmp=vector<vector<int> >(70,vector<int>(70,0));\n\t\t\tif(d==1)\n\t\t\t{\n\t\t\t\tfor(int i=c;i<c*2;i++)\n\t\t\t\t\tfor(int j=0;j<m;j++)\n\t\t\t\t\t\ttmpmp[i][j]=mp[i][j]+mp[c-(i-c+1)][j];\n\t\t\t\tfor(int i=c*2;i<n;i++)\n\t\t\t\t\tfor(int j=0;j<m;j++)\n\t\t\t\t\t\ttmpmp[i][j]=mp[i][j];\n\t\t\t\tmp=vector<vector<int> >(70,vector<int>(70,0));\n\t\t\t\tfor(int i=0;i<n;i++)\n\t\t\t\t\tfor(int j=0;j<m;j++)\n\t\t\t\t\t\tmp[i][j]=tmpmp[i+c][j];\n\n\t\t\t}\n\t\t\telse if(d==2)\n\t\t\t{\n\t\t\t\tfor(int i=c;i<c*2;i++)\n\t\t\t\t\tfor(int j=0;j<n;j++)\n\t\t\t\t\t\ttmpmp[j][i]=mp[j][i]+mp[j][c-(i-c+1)];\n\t\t\t\tfor(int i=c*2;i<m;i++)\n\t\t\t\t\tfor(int j=0;j<n;j++)\n\t\t\t\t\t\ttmpmp[j][i]=mp[j][i];\n\t\t\t\tmp=vector<vector<int> >(70,vector<int>(70,0));\n\t\t\t\tfor(int i=0;i<m;i++)\n\t\t\t\t\tfor(int j=0;j<n;j++)\n\t\t\t\t\t\tmp[j][i]=tmpmp[j][i+c];\n\n\n\t\t\t}\n\t\t\t\n\t\t\tfor(int i=0;i<n;i++)\n\t\t\t{\n//\t\t\t\tfor(int j=0;j<m;j++)\n//\t\t\t\t\tcout << mp[i][j] << \" \";\n//\t\t\t\tcout << endl;\n\t\t\t}\n\n\t\t}\n\n\t\tfor(int i=0;i<p;i++)\n\t\t{\n\t\t\tint x,y;\n\t\t\tcin >> x >> y;\n\t\t\tcout << mp[x][y] << endl;\n\t\t}\n\n\t\t\n\t}\n\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\nint ufp[777777],ufr[777777];\n\nvoid ufinit(int h, int w){\n\tint i,j;\n\tfor(i=0; i<20*h; ++i){\n\t\tfor(j=0; j<20*w; ++j){\n\t\t\tufp[i*1000+j] = i*1000+j;\n\t\t\tufr[i*1000+j] = 0;\n\t\t}\n\t}\n\tfor(i=0; i<h; ++i){\n\t\tfor(j=0; j<w; ++j){\n\t\t\t++ufr[i*1000+j];\n\t\t}\n\t}\n}\n\nint ufind(int x){\n\tif(ufp[x]!=x){\n\t\tufp[x] = ufind(ufp[x]);\n\t}\n\treturn ufp[x];\n}\n\nvoid unionf(int x, int y){\n\tx = ufind(x);\n\ty = ufind(y);\n\tif(x==y){\n\t\treturn;\n\t}\n\tif(ufr[x] < ufr[y]){\n\t\tswap(x,y);\n\t}\n\tufp[y] = x;\n\tufr[x] += ufr[y];\n}\n\nint main(void){\n\tint n,m,t,p,i,j,k,xl,xr,yl,yr,d,c,ans=0;\n\twhile(cin >> n >> m >> t >> p){\n\t\tif(!(n||m||t||p)){\n\t\t\tbreak;\n\t\t}\n\t\tufinit(n,m); ans = 0;\n\t\txl = 0; xr = n; yl = 0; yr = m;\n\t\tfor(k=0; k<t; ++k){\n\t\t\tcin >> d >> c;\n\t\t\tif(d==1){\n\t\t\t\tfor(i=0; i<c; ++i){\n\t\t\t\t\tfor(j=yl; j<yr; ++j){\n\t\t\t\t\t\tunionf((xl+i)*1000+j,(xl+2*c-i-1)*1000+j);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\txl += c; xr = max(xr,xl+c);\n\t\t\t}else{\n\t\t\t\tfor(i=xl; i<xr; ++i){\n\t\t\t\t\tfor(j=0; j<c; ++j){\n\t\t\t\t\t\tunionf(i*1000+(yl+j),i*1000+(yl+2*c-j-1));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tyl += c; yr = max(yr,yl+c);\n\t\t\t}\n\t\t}\n\t\tfor(k=0; k<p; ++k){\n\t\t\tcin >> i >> j;\n\t\t\ti += xl; j += yl;\n\t\t\tcout << ufr[ufind(i*1000+j)] << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n\nsigned\nmain(){\n\t\tint n,m,t,p;\n\t\twhile(cin >> n >> m >> t >> p && !(n==0 && m==0 && t==0 && p==0))\n\t\t{\n\t\t\t\tvector<vector<int> > z(m, vector<int>(n,1));\n\n\t\t\t\t//w,hは更新されていく幅と高さ\n\t\t\t\tint w = n, h = m;\n\n\t\t\t\tfor(int i=0;i<t;i++)\n\t\t\t\t{\n\t\t\t\t\t\tint d,c;\n\t\t\t\t\t\tcin >> d >> c;\n\n\t\t\t\t\t\tif(d==1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvector<vector<int> > tmp(h, vector<int>(w, 0)), tmp2(h, vector<int>(w, 0));\n\t\t\t\t\t\t\t\t//tmpの初期化\n\t\t\t\t\t\t\t\tfor(int a=0;a<h;a++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tfor(int b=0;b<w-c;b++)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttmp[a][b] = z[a][b+c];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\t\tfor(int a=0;a<h;a++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tfor(int b=0;b<c;b++)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttmp2[a][b] = z[a][c-1-b];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t//最後にtmpの状態をzに適用\n\t\t\t\t\t\t\t\tfor(int a=0;a<h;a++)\n                                {\n                                        for(int b=0;b<w;b++)\n                                        {\n                                        \t\tz[a][b] = 0;\n\t\t \t\t\t\t\t\t\t\t\tz[a][b] = tmp[a][b] + tmp2[a][b];\n\t\t\t\t\t\t\t\t\t\t}\n                                }\n\n\t\t\t\t\t\t\t\t//wの値を更新\n\t\t\t\t\t\t\t\tw = max(w-c,c);\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(d==2)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvector<vector<int> > tmp(h, vector<int>(w, 0)),tmp2(h, vector<int>(w, 0));\n\t\t\t\t\t\t\t\t//tmpの初期化\n\t\t\t\t\t\t\t\tfor(int a=0;a<h-c;a++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tfor(int b=0;b<w;b++)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttmp[a][b] = z[a+c][b];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tfor(int a=0;a<c;a++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tfor(int b=0;b<w;b++)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttmp2[a][b] = z[c-1-a][b];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t//最後にtmpの状態をzに適用\n\t\t\t\t\t\t\t\tfor(int a=0;a<h;a++)\n                                {\n                                        for(int b=0;b<w;b++)\n                                        {\n                                        \t\t//初期化\n                                        \t\tz[a][b] = 0;\n\t\t \t\t\t\t\t\t\t\t\tz[a][b] = tmp[a][b] + tmp2[a][b];\n\t\t\t\t\t\t\t\t\t\t}\n                                }\n\n\t\t\t\t\t\t\t\t//hの値を更新\n\t\t\t\t\t\t\t\th = max(h-c,c);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//debug\n\t\t\t\t\t\t/*\n\t\t\t\t\t\tfor(int a=0;a<m;a++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor(int b=0;b<n;b++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcout << z[a][b] << \" \";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcout << endl;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t*/\n\n\t\t\t\t}\n\n\n\t\t\t\tint ans = 0;\n\n\t\t\t\tfor(int i=0;i<p;i++)\n\t\t\t\t{\n\t\t\t\t\t\tint x,y;\n\t\t\t\t\t\tcin >> x >> y;\n\t\t\t\t\t\tcout << z[y][x] << endl;\n\n\t\t\t\t}\n\t\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#define rep(i, n) for(i = 0; i < n; i++)\nusing namespace std;\n\nint w, h, t, p;\nint d[20], c[20];\nint x[20], y[20];\n\nvoid solve() {\n\tint cnts[2][64][64] = {0};\n\tint i, j, k;\n\t\n\trep(i, h) rep(j, w) cnts[0][i][j] = 1;\n\trep(i, t) {\n\t\trep(j, h) {\n\t\t\trep(k, w) {\n\t\t\t\tint nj = j;\n\t\t\t\tint nk = k;\n\t\t\t\tif (d[i] == 2 && nj < c[i]) nj = c[i] + (c[i] - nj) - 1;\n\t\t\t\tif (d[i] == 1 && nk < c[i]) nk = c[i] + (c[i] - nk) - 1;\n\t\t\t\tcnts[1][nj][nk] += cnts[0][j][k];\n\t\t\t}\n\t\t}\n\t\t\n\t\t//原点を求める\n\t\tint minJ = 114514;\n\t\tint minK = 114514;\n\t\trep(j, 2 * h) {\n\t\t\trep(k, 2 * w) {\n\t\t\t\tif (cnts[1][j][k] > 0) {\n\t\t\t\t\tminJ = min(minJ, j);\n\t\t\t\t\tminK = min(minK, k);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t//コピー\n\t\trep(j, 2 * h) rep(k, 2 * w) cnts[0][j][k] = 0;\n\t\trep(j, 2 * h) {\n\t\t\trep(k, 2 * w) {\n\t\t\t\tif (j < minJ || k < minK) continue;\n\t\t\t\tcnts[0][j - minJ][k - minK] = cnts[1][j][k];\n\t\t\t}\n\t\t}\n\t}\n\t\n\trep(i, p) {\n\t\tcout << cnts[0][y[i]][x[i]] << endl;\n\t}\n}\n\nint main() {\n\twhile (cin >> w >> h >> t >> p) {\n\t\tif (!w) break;\n\t\tint i;\n\t\trep(i, t) cin >> d[i] >> c[i];\n\t\trep(i, p) cin >> x[i] >> y[i];\n\t\tsolve();\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <functional>\n#include <vector>\n#include <utility>\n#include <cstring>\n#include <cmath>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n#include <numeric> \n#define MAX_N 100\nusing namespace std;\ntypedef long long ll;\nconst int INF = 1<<30; \nconst int MOD = 1e9 + 7;\nconst int dx[] = {1, 0, -1, 0};\nconst int dy[] = {0, 1, 0, -1};\nint main()\n{\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tint w, h, t, p, d, c;\n\twhile(cin >> w >> h >> t >> p, w | h | t | p)\n\t{\n\t\tint table[MAX_N][MAX_N] = {};\n\t\tfor(int i = 0; i < h; i++)\n\t\t\tfor(int j = 0; j < w; j++) table[i][j] = 1;\n\t\tfor(int i = 0; i < t; i++)\n\t\t{\n\t\t\tcin >> d >> c;\n\t\t\tif(d == 1)\n\t\t\t{\n\t\t\t\tfor(int j = 0; j < h; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < c; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint alpha = c - k - 1;\n\t\t\t\t\t\ttable[j][c + alpha] += table[j][k];\n\t\t\t\t\t\ttable[j][k] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j = 0; j < MAX_N; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < MAX_N; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\ttable[j][k] = table[j][k + c];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(d == 2)\n\t\t\t{\n\t\t\t\tfor(int j = 0; j < c; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < w; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint alpha = c - j - 1;\n\t\t\t\t\t\ttable[c + alpha][k] += table[j][k];\n\t\t\t\t\t\ttable[j][k] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j = 0; j < MAX_N; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < MAX_N; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\ttable[j][k] = table[j + c][k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint x, y;\n\t\tfor(int i = 0; i < p; i++)\n\t\t{\n\t\t\tcin >> x >> y;\n\t\t\tcout << table[y][x] << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <unordered_set>\n#include <unordered_map>\n#include <deque>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <queue>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <fstream>\n#include <cstdio>\n#include <climits>\n#include <complex>\n#include <cstdint>\n#include <tuple>\n\n#define M_PI       3.14159265358979323846\n\nusing namespace std;\n\n//conversion\n//------------------------------------------\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout << x; return sout.str(); }\ninline int readInt() { int x; scanf(\"%d\", &x); return x; }\n\n//typedef\n//------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef pair<int, PII> TIII;\ntypedef long long LL;\ntypedef unsigned long long ULL;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\n\n//container util\n\n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define SQ(a) ((a)*(a))\n#define EACH(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n\n//repetition\n//------------------------------------------\n#define FOR(i,s,n) for(int i=s;i<(int)n;++i)\n#define REP(i,n) FOR(i,0,n)\n#define MOD 1000000007\n\n#define rep(i, a, b) for(int i = a; i < (b); ++i)\n#define trav(a, x) for(auto& a : x)\n#define all(x) x.begin(), x.end()\n#define sz(x) (int)(x).size()\nstruct Edge {\n    int to, cost;\n    Edge(int to, int cost): to(to), cost(cost) {}\n};\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef vector<int> vi;\ntypedef vector<vector<Edge>> AdjList;\nAdjList graph;\n\nconst int INF = 100000000;\nint n, m, t, p;\nint main() {\n    //cout << fixed << setprecision(15);\n\n    while(cin >> n >> m >> t >> p){\n        if(n==0 && m == 0 && t == 0 && p == 0) break;\n\n        int grid[510][510]={0}; // y  x\n        REP(i, n) REP(j, m) grid[i][j]=1;\n\n        int subw=0, subh=0;\n\n        //nが幅, mが高さ\n\n        //  左上を(x, y) = (subh, subw)で表現する\n        REP(i, t){\n            int d = readInt(), c = readInt();\n            if(d == 1){\n                \n\n                if(n>=2*c){\n                    n-=c;\n                }else{\n                    n -= n-c;\n                }\n                for(int j=0; j<c; ++j){\n                    for(int k=0; k<m; ++k){\n                        grid[subw+c+j][k+subh] += grid[subw+c-j-1][k+subh];\n                    }\n                }\n                subw += c;\n            }else {\n                \n\n                if(m>=2*c){\n                    m-=c;\n                }else{\n                    m -= m-c;\n                }\n                for(int j=0; j<c; ++j){\n                    for(int k=0; k<n; ++k){\n                        grid[k+subw][subh+c+j] += grid[k+subw][subh+c-j-1];\n                    }\n                }subh += c;\n            }\n            \n            \n        }\n        REP(i, p){\n            int x = readInt(), y = readInt();\n            cout << grid[subw+x][subh+y] << endl;\n        }\n        \n        \n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define test(a) printf(\"(%3d)\", a)\ntypedef long long ll;\ntypedef unsigned long long ull;\nusing namespace std;\n\nconst int MAXN = 5e4 + 10;\n\nint mp[1001][1001];\nint n, m, t, p;\nint d, c, x, y;\nint ox, oy, xlen, ylen;\n\nvoid fold1 (int pos) { // horizontal\n    for (int i = 0; i < pos; i++) {\n        for (int j = 0; j < ylen; j++) {\n            mp[ox-pos-1-i][oy+j] += mp[ox-pos+i][oy+j];\n            mp[ox-pos+i][oy+j] = 0;\n        }\n    }\n    xlen = (ox-pos) - min(ox-2*pos,ox-xlen);\n    ox -= pos;\n}\n\nvoid fold2 (int pos) { // vertical\n    for (int j = 0; j < pos; j++) {\n        for (int i = 0; i < xlen; i++) {\n            mp[ox-1-i][oy+pos+j] += mp[ox-1-i][oy+pos-1-j];\n            mp[ox-1-i][oy+pos-1-j] = 0;\n        }\n    }\n    ylen = max(oy+2*pos,oy+ylen)-(oy+pos);\n    oy += pos;\n}\n\nvoid init (void) {\n    for (int i = 0; i < xlen; i++) {\n        for (int j = 0; j < ylen; j++) {\n            mp[ox-1-i][oy+j] = 0;\n        }\n    }\n    ox = 1000, oy = 0;\n    xlen = m, ylen = n;\n    for (int i = 0; i < xlen; i++) {\n        for (int j = 0; j < ylen; j++) {\n            mp[ox-i-1][oy+j] = 1;\n        }\n    }\n}\n\nint main (void) {\n    while (~scanf(\"%d%d%d%d\", &n, &m, &t, &p) && (n||m||t||p)) {\n        init();\n        while (t--) {\n            scanf(\"%d%d\", &d, &c);\n            if (d == 1) fold2(c);\n            else fold1(c);\n        }\n        while (p--) {\n            scanf(\"%d%d\", &x, &y);\n            printf(\"%d\\n\", mp[ox-1-y][oy+x]);\n        }\n    } \n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n/*{{{*/  //template\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\nconstexpr int INF = numeric_limits<int>::max()/2;\nconstexpr long long LINF = numeric_limits<long long>::max()/3;\n#define mp make_pair\n#define pb push_back\n#define eb emplace_back\n#define fi first\n#define se second\n#define all(v) (v).begin(),(v).end()\n#define sz(x) (int)(x).size()\n#define debug(x) cerr<<#x<<\":\"<<x<<endl\n#define debug2(x,y) cerr<<#x<<\",\"<<#y\":\"<<x<<\",\"<<y<<endl\n//struct fin{ fin(){ cin.tie(0); ios::sync_with_stdio(false); } } fin_;\nstruct Double{ double d; explicit Double(double x) : d(x){} };\nostream& operator<<(ostream& os,const Double x){ os << fixed << setprecision(20) << x.d; return os; }\ntemplate<typename T> ostream& operator<<(ostream& os,const vector<T>& vec){ os << \"[\"; for(const auto& v : vec){ os << v << \",\"; } os << \"]\"; return os; }\ntemplate<typename T,typename U> ostream& operator<<(ostream& os,const pair<T,U>& p){ os << \"(\" << p.first << \",\"<< p.second <<\")\"; return os; }\ntemplate<typename T> ostream& operator<<(ostream& os,const set<T>& st){ os<<\"{\"; for(T v:st) os<<v<<\",\"; os <<\"}\"; return os; }\ntemplate<typename T,typename U> inline void chmax(T &x,U y){ if(y>x) x = y; }\ntemplate<typename T,typename U> inline void chmin(T &x,U y){ if(y<x) x = y; }\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\nll gcd(ll a,ll b){ if(b==0) return a; else return gcd(b,a%b); }\n//constexpr double eps = 1e-14; \nconstexpr double eps = 1e-10; \nconstexpr ll mod = 1e9+7;\nconst int dx[]={1,0,-1,0} ,dy[] = {0,1,0,-1};\n/*}}}*/\n\nint n,m,t,p;\n\nvoid solve(){\n    vector<vector<int>> table(n,vector<int>(m,1));\n\n    rep(i,t){\n        int d,c; cin >> d >> c;\n        if(d==1){\n            int H = table[0].size();\n            int W1 = table.size();\n            int W2 = max(c,W1-c);\n            vvi cpy(W2,vi(H,0));\n            for(int i=0;i<W1-c;i++){\n                for(int j=0;j<H;j++){\n                    cpy[i][j] = table[i+c][j];\n                }\n            }\n            for(int i=0;i<c;i++){\n                for(int j=0;j<H;j++){\n                    cpy[i][j] += table[c-1-i][j];\n                }\n            }\n            table = cpy;\n        }else{\n            int W = table.size();\n            int H1 = table[0].size();\n            int H2 = max(c,H1-c);\n            vvi cpy(W,vi(H2,0));\n            for(int i=0;i<W;i++){\n                for(int j=0;j<H1-c;j++){\n                    cpy[i][j] = table[i][j+c];\n                }\n            }\n            for(int i=0;i<W;i++){\n                for(int j=0;j<c;j++){\n                    cpy[i][j] += table[i][c-1-j];\n                }\n            }\n            table = cpy;\n        }\n    }\n\n    rep(i,p){\n        int x,y; cin >> x >> y;\n        cout << table[x][y] << endl;\n    }\n}\n\nint main(){\n    while(1){\n        cin >> n >> m >> t >> p;\n        if(n==0 and m==0 and t==0 and p==0) break;\n        solve();\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int AX = 300;\nint vis[AX][AX];\nint res[AX][AX];\nint main(){\n\tint n , m , t,  p;\n\twhile ( scanf(\"%d%d%d%d\",&n,&m,&t,&p) && n && m && t && p ){\n\t\tfor( int i = 0 ; i < AX ; i++ ){\n\t\t\tfor( int j = 0 ; j < AX; j++ ){\n\t\t\t\tvis[i][j] = 0 ;\n\t\t\t}\n\t\t}\n\t\tfor( int i = 0 ; i < m ; i++ ){\n\t\t\tfor( int j = 0 ; j < n ; j++ ){\n\t\t\t\tvis[i][j] = 1;\n\t\t\t}\n\t\t}\n\t\tint left = 0 ;\n\t\tint down = 0 ;\n\t\tint x , y ;  \n\t\tint op;\n\t\tfor( int i = 0 ;  i < t ;i ++ ){\n\t\t\t//cout << \"?? : \" << vis[3][4] << endl;\n\t\t\tscanf(\"%d%d\",&op,&x);\n\t\t\tif( op == 2 ){\n\t\t\t\tdown += x  ;\n\t\t\t\tint s = 0 ;\n\t\t\t\tm = max( m , down + x );\n\t\t\t\tfor( int k = down ; k < down + x ; k++ ){\n\t\t\t\t\ts ++;\n\t\t\t\t\tfor( int j = left ; j < n ; j++ ){\n\t\t\t\t\t\tvis[k][j] += vis[down-s][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tleft += x  ;\n\t\t\t\tint s = 0;\n\t\t\t\tn = max( n , left + x );\n\t\t\t\tfor( int j = left ; j < left + x ; j++ ){\n\t\t\t\t\ts ++;\n\t\t\t\t\tfor( int k = down ; k < m ; k++ ){\n\t\t\t\t\t\tvis[k][j] += vis[k][left-s];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor( int i = 0 ; i < p ; i++ ){\n\t\t\tscanf(\"%d%d\",&x,&y);\t\n\n\t\t\tprintf(\"%d\\n\",vis[y+down][x+left]);\n\t\t}\n\t}\n\treturn 0 ;\n}\n"
  },
  {
    "language": "C++",
    "code": "\n#if 1\n#include <iostream>\n#include <fstream>\n#include <string>\n#include <vector>\n#include <map>\n#include <set>\n#include <unordered_map>\n#include <unordered_set>\n#include <queue>\n#include <stack>\n#include <array>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <cstdint>\n#include <functional>\n#include <iomanip>\n#include <numeric>\n#include <assert.h>\n#include <bitset>\n#include <list>\n#include <cmath>\n#include <sstream>\n\n#define all_range(C) std::begin(C), std::end(C)\n\n\n\nint map[100][100];\n\n\nint main()\n{\n\tusing std::endl;\n\tusing std::cout;\n\tusing std::cin;\n\n\twhile (true)\n\t{\n\t\tint W,H,t,p;\n\t\tcin >> W>>H>>t>>p;\n\t\tif (W == 0 && H==0&&t==0&&p==0) { break; }\n\n\t\tfor (int i = 0; i < 100; i++)\n\t\t\tfor (int j = 0; j < 100; j++)\n\t\t{\n\t\t\t\tmap[i][j] = 0;\n\t\t}\n\t\t\n\t\tfor (int i = 0; i < H; i++)\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t{\n\t\t\tmap[i][j] = 1;\n\t\t}\n\n\t\twhile(t--)\n\t\t{\n\t\t\tint d, c;\n\t\t\tcin >> d >> c;\n\n\t\t\tif (d == 2) {\n\t\t\t\tfor (int h = 0; h < c; h++)\n\t\t\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t\t{\n\t\t\t\t\tmap[2*c-1-h][j] += map[h][j];\n\t\t\t\t}\n\n\t\t\t\tH = std::max(c, H - c);\n\t\t\t\tfor (int h = 0; h < 100; h++)\n\t\t\t\t\tfor (int j = 0; j < 100; j++)\n\t\t\t\t{\n\t\t\t\t\tif (h < H && j < W) {\n\t\t\t\t\t\tmap[h][j] = map[h + c][j];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tmap[h][j] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (int i = 0; i < H; i++)\n\t\t\t\t\tfor (int w = 0; w < c; w++)\n\t\t\t\t{\n\t\t\t\t\tmap[i][2*c-1 - w] += map[i][w];\n\t\t\t\t}\n\n\t\t\t\tW = std::max(c, W - c);\n\t\t\t\tfor (int i = 0; i < 100; i++)\n\t\t\t\t\tfor (int w = 0; w < 100; w++)\n\t\t\t\t{\n\t\t\t\t\tif (i < H && w < W) {\n\t\t\t\t\t\tmap[i][w] = map[i][w + c];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tmap[i][w] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tint count = 0;\n\t\twhile (p--) {\n\t\t\tint h, w;\n\t\t\tcin  >> w >> h;\n\t\t\tcount = map[h][w];\n\t\t\tcout << count << endl;\n\t\t}\n\t}\n\n\treturn 0;\n}\n#endif\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define rep(i,n) for(int i=0;i<n;i++)\n#define rep2(i,a,b) for(int i=a;i<=b;i++)\n#define all(c) (c).begin(),(c).end()\n\nusing namespace std;\nint in(){int x;cin>>x;return x;}\n\n#define int long long\nmain(){\n    while(1){\n        int m=in(),n=in(),t=in(),p=in();\n        if(n==0 and m==0 and t==0 and p==0) break;\n        vector<vector<int> > v(n,vector<int>(m,1));\n        int a = 0,b = 0;\n        rep(_,t){\n            int d=in(),c=in();\n            if(d==2){\n                vector<vector<int> > w(n,vector<int>(m));\n                rep(i,c){\n                    rep(j,m)w[c-1-i][j]+=v[i][j];\n                }\n                rep2(i,c,n-1)rep(j,m)w[i-c][j]+=v[i][j];\n                v=w;\n            }\n            else{\n                vector<vector<int> > w(n,vector<int>(m));\n                rep(i,n)rep(j,c)w[i][c-1-j]+=v[i][j];\n                rep(i,n)rep2(j,c,m-1)w[i][j-c]+=v[i][j];\n                v = w;\n            }\n        }\n        int ans = 0;\n        rep(i,p){\n            int x=in(),y=in();\n            cout << v[y][x] << endl;\n        }\n                \n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n\nsigned\nmain(){\n\t\tint n,m,t,p;\n\t\twhile(cin >> n >> m >> t >> p && !(n==0 && m==0 && t==0 && p==0))\n\t\t{\n\t\t\t\tvector<vector<int> > z(m, vector<int>(n,1));\n\n\t\t\t\t//w,hは更新されていく幅と高さ\n\t\t\t\tint w = n, h = m;\n\n\t\t\t\tfor(int i=0;i<t;i++)\n\t\t\t\t{\n\t\t\t\t\t\tint d,c;\n\t\t\t\t\t\tcin >> d >> c;\n\n\t\t\t\t\t\tif(d==1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvector<vector<int> > tmp(h, vector<int>(w, 0)), tmp2(h, vector<int>(w, 0));\n\t\t\t\t\t\t\t\t//tmpの初期化\n\t\t\t\t\t\t\t\tfor(int a=0;a<h;a++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tfor(int b=0;b<w-c;b++)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttmp[a][b] = z[a][b+c];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\t\tfor(int a=0;a<h;a++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tfor(int b=0;b<c;b++)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttmp2[a][b] = z[a][c-1-b];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t//最後にtmpの状態をzに適用\n\t\t\t\t\t\t\t\tfor(int a=0;a<h;a++)\n                                {\n                                        for(int b=0;b<w;b++)\n                                        {\n                                        \t\tz[a][b] = 0;\n\t\t \t\t\t\t\t\t\t\t\tz[a][b] = tmp[a][b] + tmp2[a][b];\n\t\t\t\t\t\t\t\t\t\t}\n                                }\n\n\t\t\t\t\t\t\t\t//wの値を更新\n\t\t\t\t\t\t\t\tw = max(w-c,c);\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(d==2)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvector<vector<int> > tmp(h, vector<int>(w, 0)),tmp2(h, vector<int>(w, 0));\n\t\t\t\t\t\t\t\t//tmpの初期化\n\t\t\t\t\t\t\t\tfor(int a=0;a<h-c;a++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tfor(int b=0;b<w;b++)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttmp[a][b] = z[a+c][b];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tfor(int a=0;a<c;a++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tfor(int b=0;b<w;b++)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\ttmp2[a][b] = z[c-1-a][b];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t//最後にtmpの状態をzに適用\n\t\t\t\t\t\t\t\tfor(int a=0;a<h;a++)\n                                {\n                                        for(int b=0;b<w;b++)\n                                        {\n                                        \t\t//初期化\n                                        \t\tz[a][b] = 0;\n\t\t \t\t\t\t\t\t\t\t\tz[a][b] = tmp[a][b] + tmp2[a][b];\n\t\t\t\t\t\t\t\t\t\t}\n                                }\n\n\t\t\t\t\t\t\t\t//hの値を更新\n\t\t\t\t\t\t\t\th = max(h-c,c);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//debug\n\t\t\t\t\t\t/*\n\t\t\t\t\t\tfor(int a=0;a<m;a++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor(int b=0;b<n;b++)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcout << z[a][b] << \" \";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcout << endl;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t*/\n\n\t\t\t\t}\n\n\n\t\t\t\tint ans = 0;\n\n\t\t\t\tfor(int i=0;i<p;i++)\n\t\t\t\t{\n\t\t\t\t\t\tint x,y;\n\t\t\t\t\t\tcin >> x >> y;\n\t\t\t\t\t\tcout << z[y][x] << endl;\n\n\t\t\t\t}\n\t\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define int long long\n#define FOR(i, a, b) for(ll i = (a); i < (b); ++i)\n#define FORR(i, a, b) for(ll i = (a); i > (b); --i)\n#define REP(i, n) for(ll i = 0; i < (n); ++i)\n#define REPR(i, n) for(ll i = n; i >= 0; i--)\n#define FOREACH(x, a) for(auto &(x) : (a))\n#define VECCIN(x)                                                              \\\n  for(auto &youso_ : (x)) cin >> youso_\n#define mp make_pair\n#define bitcnt __builtin_popcount\n#define SZ(x) ((ll)(x).size())\n#define All(a) (a).begin(), (a).end()\ntemplate <typename T = long long> inline T IN() {\n  T x;\n  cin >> x;\n  return (x);\n}\ninline void CIN() {}\ntemplate <class Head, class... Tail>\ninline void CIN(Head &&head, Tail &&... tail) {\n  cin >> head;\n  CIN(move(tail)...);\n}\n#define CINT(...)                                                              \\\n  int __VA_ARGS__;                                                           \\\n  CIN(__VA_ARGS__)\n#define LCIN(...)                                                              \\\n  ll __VA_ARGS__;                                                            \\\n  CIN(__VA_ARGS__)\n#define SCIN(...)                                                              \\\n  string __VA_ARGS__;                                                        \\\n  CIN(__VA_ARGS__)\n#define Yes(a) cout << (a ? \"Yes\" : \"No\") << \"\\n\"\n#define YES(a) cout << (a ? \"YES\" : \"NO\") << \"\\n\"\n#define Printv(v)                                                              \\\n  {                                                                          \\\n  FOREACH(x, v) { cout << x << \" \"; }                                    \\\n    cout << \"\\n\";                                                          \\\n    }\n\ntypedef long long ll;\ntypedef unsigned long long ul;\ntypedef vector<ll> VL;\ntypedef pair<ll, ll> PL;\ntypedef priority_queue<ll> PQ;\ntypedef priority_queue<ll, VL, greater<ll>> PQG;\n\nconst int INF = 1e9;\nconst int MOD = 1e9 + 7;\n// const int MOD = 998244353;\nconst ll LINF = 1e18;\nconst ll dx[] = {1, -1, 0, 0};\nconst ll dy[] = {0, 0, 1, -1};\n\nll W, H, t, p;\nvector<VL> a;\n\nvoid transpose(ll &h, ll &w, vector<VL> &a){\n  vector<VL> b(w,VL(h));\n  REP(i,h)REP(j,w){\n    b[j][i]=a[i][j];\n  }\n  a.swap(b);\n  swap(h,w);\n}\n\nsigned main(){\n  while(1){\n    cin>>W>>H>>t>>p;\n    if(W==0 && H==0 && t==0 && p==0) break;\n    a.assign(H,VL(W,1));\n    while(t--){\n      LCIN(d,c);\n      if(d==2) transpose(H,W,a);\n      ll wl=max(c,W-c);\n      vector<VL> b(H,VL(wl));\n      REP(i,H)REP(j,W){\n\tll jl = j<c?c-j-1:j-c;\n\tb[i][jl]+=a[i][j];\n      }\n      a.swap(b);\n      W = wl;\n      if(d==2) transpose(H,W,a);\n    }\n    while(p--){\n      LCIN(x,y);\n      cout << a[y][x] << \"\\n\";\n    }\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing i64 = int64_t;\nusing vi = vector<i64>;\nusing vvi = vector<vi>;\n\nvoid printboard(vvi b) {\n    for (int j = b.front().size() - 1; j >= 0; j--) {\n        for (int i = 0; i < b.size(); i++) {\n            cout << b[i][j] << '\\t';\n        }\n        cout << endl;\n    }\n    cout << endl;\n}\n\nvvi fold_hor(vvi b, int x) {\n    for (int j = 0; j < b.front().size(); j++) {\n        for (int i = 0; i < x; i++) {\n            b[x + i][j] += b[x - 1 - i][j];\n        }\n    }\n    vvi ret(b.size() - x, vi(b.front().size()));\n    for (int i = x; i < b.size(); i++) {\n        for (int j = 0; j < b.front().size(); j++) {\n            ret[i - x][j] = b[i][j];\n        }\n    }\n    return ret;\n}\n\nvvi fold_ver(vvi b, int y) {\n    for (int i = 0; i < b.size(); i++) {\n        for (int j = 0; j < y; j++) {\n            b[i][y + j] += b[i][y - 1 - j];\n        }\n    }\n    vvi ret(b.size(), vi(b.front().size() - y));\n    for (int i = 0; i < b.size(); i++) {\n        for (int j = y; j < b.front().size(); j++) {\n            ret[i][j - y] = b[i][j];\n        }\n    }\n    return ret;\n}\n\nint main() {\n    int n, m, t, p;\n    while (1) {\n        cin >> n >> m >> t >> p;\n        if (n == 0) return 0;\n        vvi board(500, vi(500, 0));\n        for (int i = 0; i < n; i++) {\n            for (int j = 0; j < m; j++) {\n                board[i][j] = 1;\n            }\n        }\n        for (int i = 0; i < t; i++) {\n            int d, c;\n            cin >> d >> c;\n            if (d == 2) {\n                board = fold_ver(board, c);\n            } else {\n                board = fold_hor(board, c);\n            }\n            // printboard(board);\n        }\n        for (int i = 0; i < p; i++) {\n            int x, y;\n            cin >> x >> y;\n            cout << board[x][y] << endl;\n        }\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define fi first\n#define se second\n#define show(x) cerr << #x << \"=\" << \"\\n\"\ntypedef long long ll;\ntypedef unsigned long long ull;\n\nusing namespace std;\n\nint main() {\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  cout.precision(10);\n  cout << fixed;\n#ifdef LOCAL_DEFINE\n  FILE *stream1;\n  //FILE *stream2;\n  stream1 = freopen(\"in.txt\", \"r\", stdin);\n  //stream2 = freopen(\"out.txt\", \"w\", stdout);\n  if (stream1 == NULL) return 0;\n  //if (stream2 == NULL) return 0;\n#endif\n  int n, m, t, p;\n  while (cin >> n >> m >> t >> p, n) {\n    int past[40][40];\n    for (int i = 0; i < 40; i++) {\n      for (int j = 0; j < 40; j++) {\n        past[i][j] = 0;\n      }\n    }\n    for (int i = 0; i < m; i++) {\n      for (int j = 0; j < n; j++) {\n        past[i][j] = 1;\n      }\n    }\n    for (int ti = 0; ti < t; ti++) {\n      int d, c; cin >> d >> c;\n      int nw[40][40];\n      for (int i = 0; i < 40; i++) {\n        for (int j = 0; j < 40; j++) {\n          nw[i][j] = 0;\n        }\n      }\n      if (d == 1) {\n        for (int i = 0; i < 40; i++) {\n          for (int j = c; j < 40; j++) {\n            nw[i][j - c] += past[i][j];\n          }\n        }\n        for (int i = 0; i < 40; i++) {\n          for (int j = 0; j < c; j++) {\n            nw[i][j] += past[i][j];\n          }\n        }\n      } else {\n        int h = 0;\n        int last = 0;\n        for (int i = 0; i < 40; i++) {\n          if (past[i][0] != 0) {\n            h++;\n            last = i;\n          }\n        }\n        if (c >= h - c) {\n          int cont = 0;\n          int now = last;\n          while (cont < c) {\n            for (int i = 0; i < 40; i++) {\n              nw[cont][i] += past[now][i];\n            }\n            cont++;\n            now--;\n          }\n          for (int i = 0; i < now + 1; i++) {\n            for (int j = 0; j < 40; j++) {\n              nw[c - 1 - i][j] += past[i][j];\n            }\n          }\n        } else {\n          for (int i = 0; i < h - c; i++) {\n            for (int j = 0; j < 40; j++) {\n              nw[i][j] += past[i][j];\n            }\n          }\n          int cont = 0;\n          while (cont < c) {\n            for (int i = 0; i < 40; i++) {\n              nw[h - c - cont - 1][i] += past[h - c + cont][i];\n            }\n            cont++;\n          }\n        }\n      }\n      for (int i = 0; i < 40; i++) {\n        for (int j = 0; j < 40; j++) {\n          past[i][j] = nw[i][j];\n        }\n      }\n      // for (int i = 0; i < 10; i++) {\n      //   for (int j = 0; j < 10; j++) {\n      //     cerr << past[i][j];\n      //   }\n      //   cerr << endl;\n      // }\n    }\n    int h = 0;\n    for (int i = 0; i < 40; i++) {\n      if (past[i][0] != 0) {\n        h++;\n      }\n    }\n    for (int i = 0; i < p; i++) {\n      int x, y; cin >> x >> y;\n      cout << past[h - y - 1][x] << endl;\n    }\n    // for (int i = 0; i < 10; i++) {\n    //   for (int j = 0; j < 10; j++) {\n    //     cerr << past[i][j];\n    //   }\n    //   cerr << endl;\n    // }\n  }\n#ifdef LOCAL_DEFINE\n  cerr << \"Time elapsed: \" << 1.0 * clock() / CLOCKS_PER_SEC << \"s.\\n\";\n  fclose(stream1);\n  //fclose(stream2);\n#endif\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n//type\ntypedef long long ll;\nusing pii = pair<int, int>;\nusing vi = vector<int>;\n//x * y * 1.0 can cause overflow\n//constant\n#define inf (int)(1e9+7)\n#define mod (ll)(1e9+7)\n#define eps 1e-10\nint di[] = {0, 0, -1, 1, -1, 1, -1, 1}; //右、左、マイナス、プラス\nint dj[] = {1, -1, 0, 0, -1, 1, 1, -1};\n//omission\n#define eb emplace_back\n#define F first\n#define S second\n#define SZ(x) ((int)(x).size())\n#define all(v) v.begin(), v.end()\n//manip\ntemplate<class T> bool chmax(T &a, T &b) {if (a < b) {a = b; return 1;} return 0;}\ntemplate<class T> bool chmin(T &a, T &b) {if (a > b) {a = b; return 1;} return 0;}\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end(), v.end());\n#define ceil(a, b) a / b + !!(a % b)\ntemplate<class T> T power(T a, T b)\n{return b ? power(a * a % inf, b / 2) * (b % 2 ? a : 1) % inf : 1;}\n#define LB(v, x) (int)(lower_bound(v.begin(), v.end(), x) - v.begin())\n#define UB(v, x) (int)(upper_bound(v.begin(), v.end(), x) - v.begin())\n//loop\n#define rep(i, n) for (int i = 0, i##_len = (n); i < i##_len; ++i)\n#define rep3(i, st, n) for (int i = st; i < n; ++i)\n//algorithm\n//double pointer, l start, how many adds, can be 0 -> init r = l, sum = 0\n//bfs, not x, y, i, j\n//not !(i % 2), i % 2 == 0\n\n\n\n\n\n\nint main() {\n    //cast caution\n    //look constraints always\n    cin.tie(0); ios::sync_with_stdio(false);\n    \n    \n    \n    \n    \n    \n    \n    \n    int w, h, t, p;\n    while (cin >> w && w) {\n        cin >> h >> t >> p;\n        int d[t], c[t];\n        rep(i, t) cin >> d[i] >> c[i];\n        int x[p], y[p];\n        rep(i, p) cin >> x[i] >> y[i];\n        \n        int table[32 * 20][32 * 20];\n        rep(i, 32 * 20) rep(j, 32 * 20) table[i][j] = 1;\n        int table2[32 * 20][32 * 20];\n        rep(i, 32 * 20) rep(j, 32 * 20) table2[i][j] = 1;\n        //table2 -> table\n        rep(i, t) {\n            if (d[i] == 1) {\n                int ol = min(c[i], w - c[i]); //overlap\n                rep(j, ol) rep(k, h) table[k][j] = table2[k][c[i] + j] + table2[k][c[i] - 1 - j];\n               \n                int rest = w - 2 * ol;\n                if (ol == c[i]) {\n                    rep(j, rest) rep(k, h) table[k][ol + j] = table2[k][2 * c[i] + j];\n                } else {\n                    rep(j, rest) rep(k, h) table[k][ol + j] = table2[k][w - 1 - 2 * ol - j];\n                }\n                w -= ol;\n            } else {\n                //copy and paste\n                int ol = min(c[i], h - c[i]); //overlap\n                rep(k, ol) rep(j, w) table[k][j] = table2[c[i] + k][j] + table2[c[i] - 1 - k][j];\n                \n                /*\n                if (i == 2) {\n                    cout << endl; rep(k, h) {rep(j, w) cout << table[k][j] << \" \"; cout << endl;}\n                    return 0;\n                }\n                */\n                \n                int rest = h - 2 * ol;\n                if (ol == c[i]) {\n                    rep(k, rest) rep(j, w) table[ol + k][j] = table2[2 * c[i] + k][j];\n                } else {\n                    rep(k, rest) rep(j, w) table[ol + k][j] = table2[h - 1 - 2 * ol - k][j];\n                }\n                h -= ol;\n            }\n            rep(j, h) rep(k, w) table2[j][k] = table[j][k];\n            //cout << endl; rep(k, h) {rep(j, w) cout << table[k][j] << \" \"; cout << endl;}\n        }\n        rep(i, p) {\n            cout << table[y[i]][x[i]] << endl;\n        }\n        \n    }\n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n    \n}\n//cast caution\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long int;\nusing lc = complex<double>;\n\nint main(void) {\n    constexpr ll MOD = 1e9 + 7;\n    constexpr double PI = acos(-1);\n    cout << fixed << setprecision(32);\n    cin.tie(0); ios::sync_with_stdio(false);\n\n    while(1) {\n        ll n, m, t, p;\n        cin >> n >> m >> t >> p;\n        if(!n) break;\n        vector<vector<ll>> v(m, vector<ll>(n, 1));\n\n        ll si = 0, sj = 0;\n        while(t--) {\n            ll d, c;\n            cin >> d >> c;\n            if(d == 1) {\n                if(c > n-sj-c)\n                    for(ll i=si; i<m; i++)\n                        for(ll j=sj; j<n-1+sj-j; j++)\n                            swap(v[i][j], v[i][n-1+sj-j]);\n\n                c = min(c, n-sj-c);\n                for(ll i=si; i<m; i++)\n                    for(ll j=0; j<c; j++)\n                        v[i][sj+c+j] += v[i][sj+c-1-j];\n                sj += c;\n            } else {\n                if(c > m-si-c)\n                    for(ll i=si; i<m-1+si-i; i++)\n                        for(ll j=sj; j<n; j++)\n                            swap(v[i][j], v[m-1+si-i][j]);\n\n                c = min(c, m-si-c);\n                for(ll j=sj; j<n; j++)\n                    for(ll i=0; i<c; i++)\n                        v[si+c+i][j] += v[si+c-1-i][j];\n                si += c;\n            }\n            assert(si < m);\n            assert(sj < n);\n        }\n\n        while(p--) {\n            ll x, y;\n            cin >> x >> y;\n            cout << v[si+y][sj+x] << endl;\n        }\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n    \n    while(1){\n        int n, m, t, p; cin >> n >> m >> t >> p;\n        if(!n) break;\n        vector<int> d(t);\n        vector<int> c(t);\n        vector<int> x(p);                                             \n        vector<int> y(p);                                             //  y\n                                                                      //  ^\n        for(int i = 0; i < t; i++) cin >> d[i] >> c[i];               //  |\n        for(int i = 0; i < p; i++) cin >> x[i] >> y[i];               //  |\n                                                                      //  |\n        vector<vector<vector<int> > > dp(t + 1);                      //  |\n        dp[0].resize(n, vector<int> (m, 1));                          //  |          dp[x][y]\n                                                                      //  |\n        for(int i = 0; i < t; i++){                                   //  |\n                                                                      //  |\n            int now_x = (int)dp[i].size();                            //  |\n            int now_y = (int)dp[i][0].size();                         //  O----------------------------> x\n            \n            if(d[i] == 2){\n\n                //下から上へ折りたたむ\n                \n                //次の折り紙のサイズを計算\n                int next_x = now_x;\n                int next_y = now_y - c[i] + max(0, (2*c[i] - now_y));\n                dp[i + 1].resize(next_x, vector<int> (next_y, 0));\n                //ここ dp じゃね?\n                for(int x = 0; x < now_x; x++){\n                    for(int y = 0; y < now_y; y++){\n                        int nx = x;\n                        int ny = y - c[i];\n                        if(ny < 0){\n                            ny = -ny - 1;\n                        }\n                        dp[i + 1][nx][ny] += dp[i][x][y];\n                    }\n                }\n\n            }else{\n\n                //左から右へ折りたたむ\n\n                //次の折り紙のサイズを計算\n                int next_x = now_x - c[i] + max(0, (2*c[i] - now_x));\n                int next_y = now_y;\n                dp[i + 1].resize(next_x, vector<int> (next_y, 0));\n                //ここ dp じゃね?\n                for(int x = 0; x < now_x; x++){\n                    for(int y = 0; y < now_y; y++){\n                        int nx = x - c[i];\n                        int ny = y;\n                        if(nx < 0){\n                            nx = -nx - 1;\n                        }\n\n                        dp[i + 1][nx][ny] += dp[i][x][y];\n                    }\n                }\n            }\n            \n            /*cout << endl;\n            cout << i << endl;\n            for(int x = 0; x < now_x; x++){\n                for(int y = 0; y < now_y; y++){\n                    cout << dp[i][x][y] <<  \" \";\n                }\n                cout << endl;\n            }*/\n        \n        }\n\n        for(int i = 0; i < p; i++){\n            cout << dp[t][x[i]][y[i]] << endl;\n        }\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\nusing namespace std;\n#define rep(i,n) for(int i = 0; i < (n); i++)\n\nint main(){\n    int n,m,t,p;\n    while(cin >> m >> n >> t >> p, n){\n        vector<vector<int> > v(n,vector<int>(m,1));\n        while(t--){\n            int d,c;\n            cin >> d >> c;\n            n = v.size();\n            m = v[0].size();\n            if(d == 1){\n                int x = max(m-c,c);\n                vector<vector<int> > ne(n,vector<int>(x,0));\n                rep(i,n)rep(j,x){\n                    if(j+c < m)ne[i][j] += v[i][j+c];\n                    if(c-j-1 >= 0)ne[i][j] += v[i][c-j-1];\n                }\n                v = ne;\n            }else{\n                int x = max(n-c,c);\n                vector<vector<int> > ne(x,vector<int>(m,0));\n                rep(i,x)rep(j,m){\n                    if(i+c < n)ne[i][j] += v[i+c][j];\n                    if(c-i-1 >= 0)ne[i][j] += v[c-i-1][j];\n                }\n                v = ne;\n            }\n            /*\n            cout << endl;\n            rep(i,v.size()){\n                rep(j,v[0].size())cout << \" \" << v[i][j];cout << endl;\n            }\n        */\n        }\n        n = v.size();\n        m = v[0].size();\n\n        while(p--){\n            int x,y;\n            cin >> x >> y;\n            cout << v[y][x] << endl;\n        }\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n\nusing namespace std;\n\nint main(){\n  int EX=100,EY=100;\n  while(true){\n    int m,n,t,p;\n    //入力\n    cin >>n>>m>>t>>p;\n\n    //終了条件\n    if(n==0&&m==0)break;\n\n    //折り紙のinit\n    int map[EX][EY];\n    for(int x=0;x<EX;x++){\n      for(int y=0;y<EY;y++){\n        if(x<n&&y<m){\n          map[x][y]=1;\n        }else{\n          map[x][y]=0;\n        }\n      }\n    }\n\n\n    //折り返し動作の処理\n    for(int i=0;i<t;i++){\n      int d,c;\n      cin >>d>>c;\n      //init\n      int n_map[EX][EY];\n      for(int x=0;x<EX;x++){\n        for(int y=0;y<EY;y++){\n          if(x<n&&y<m){\n            n_map[x][y]=1;\n          }else{\n            n_map[x][y]=0;\n          }\n        }\n      }\n\n      //処理\n      if(d==1){\n        for(int x=0;x+c<EX;x++){\n          for(int y=0;y<EY;y++){\n            n_map[x][y]=map[x+c][y];\n          }\n        }\n        for(int x=0;x<c;x++){\n          for(int y=0;y<EY;y++){\n            n_map[x][y]+=map[c-(x+1)][y];\n          }\n        }\n\n      }else{\n        for(int x=0;x<EX;x++){\n          for(int y=0;y+c<EY;y++){\n            n_map[x][y]=map[x][y+c];\n          }\n        }\n        for(int x=0;x<EX;x++){\n          for(int y=0;y<c;y++){\n            n_map[x][y]+=map[x][c-(y+1)];\n          }\n        }\n\n      }\n      //mapにn_mapを転送\n      //cout<<\"start\"<<endl;\n      for(int x=0;x<EX;x++){\n        for(int y=0;y<EY;y++){\n          map[x][y]=n_map[x][y];\n          //cout<<map[x][y]<<\" \";\n        }\n        //cout<<endl;\n      }\n      //cout<<\"end\"<<endl;\n    }\n    //穴あけ処理\n    for(int i=0;i<p;i++){\n      int x,y;\n      cin >>x >> y;\n      cout<<map[x][y]<<endl;\n    }\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<n;++i)\n#define FOR(i,l,r) for(int i=l;i<r;++i)\n\nint main(void){\n    int X,Y,T,P;\n    while(cin>>X>>Y>>T>>P, X|Y|T|P){\n        vector<vector<int>> s(2500, vector<int>(2500, 0));\n        int x1 = 0, y1 = 0, x2 = X, y2 = Y;\n        rep(y,Y) rep(x,X) s[y][x] = 1;\n        rep(_,T){\n            int d,c;\n            cin>>d>>c;\n            if(d == 1){\n                rep(i,c){\n                    FOR(y, y1, y2){\n                        int rx = x1+c*2-1-i;\n                        s[y][rx] += s[y][x1+i];\n                        s[y][x1+i] = 0;\n                    }\n                }\n                x2 = max(x2, x1+2*c);\n                x1 += c;\n            }else{\n                FOR(x, x1, x2){\n                    rep(i,c){\n                        int uy = y1+c*2-1-i;\n                        s[uy][x] += s[y1+i][x];\n                        s[y1+i][x] = 0;\n                    }\n                }\n                y2 = max(y2, y1+2*c);\n                y1 += c;\n            }\n        }\n        rep(_,P){\n            int x,y;\n            cin>>x>>y;\n            cout<<s[y1+y][x1+x]<<endl;\n        }\n    } \n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i, n) for(int i = 0; i < (n); i++)\n#define repp(i, l, r) for(int i = (l); i < (r); i++)\n#define per(i, n) for(int i = ((n)-1); i >= 0; i--)\n#define perr(i, l, r) for(int i = ((r)-1); i >= (l); i--)\n#define all(x) (x).begin(),(x).end()\n#define MOD 1000000007\n#define IINF 1000000000\n#define LINF 1000000000000000000\n#define SP <<\" \"<<\n#define CYES cout<<\"Yes\"<<endl\n#define CNO cout<<\"No\"<<endl\n#define CFS cin.tie(0);ios::sync_with_stdio(false)\n\ntypedef long long LL;\ntypedef long double LD;\n\nint main(){\n  while(1){\n    int h,w,t,p;\n    cin >> w >> h >> t >> p;\n    if(h==0) return 0;\n    vector<vector<int>> paper(2*h,vector<int>(2*w,0));\n    rep(i,h) rep(j,w) paper[i][j]=1;\n    int d,c;\n    rep(tt,t){\n      cin >> d >> c;\n      if(d==1){\n        rep(i,2*h){\n          repp(j,c,2*w){\n            if(2*c-j-1>=0) paper[i][j]+=paper[i][2*c-j-1];\n          }\n        }\n        rep(i,2*h){\n          rep(j,2*w-c){\n            paper[i][j]=paper[i][j+c];\n          }\n          repp(j,2*w-c,2*w){\n            paper[i][j]=0;\n          }\n        }\n      }else{\n        rep(j,2*w){\n          repp(i,c,2*h){\n            if(2*c-i-1>=0) paper[i][j]+=paper[2*c-i-1][j];\n          }\n        }\n        rep(j,2*w){\n          rep(i,2*h-c){\n            paper[i][j]=paper[i+c][j];\n          }\n          repp(i,2*h-c,2*h){\n            paper[i][j]=0;\n          }\n        }\n      }\n    }\n    int x,y;\n    rep(tt,p){\n      cin >> x >> y;\n      cout << paper[y][x] << endl;\n    }\n  }\n  return 0;\n}\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n#define FOR(i,a,b) for(ll i=(a);i<(b);++i)\n#define REP(i,n) FOR(i,0,n)\nusing vi = vector<int>;\nusing vvi = vector<vector<int>>;\nint main(){\n  int n,m,t,p;\n  while(cin >> n >> m >> t >> p, n){\n    vector<int> d(t),c(t);\n    REP(i,t) cin >> d[i] >> c[i];\n    vector<int> x(p),y(p);\n    REP(i,p) cin >> x[i] >> y[i];\n    vvi a(n,vi(m,1));\n    REP(k,t){\n      vvi b;\n      if(d[k]==1){\n        b.assign(max(c[k],n-c[k]),vi(m,0));\n        if(c[k]<n-c[k]){\n          REP(i,n-c[k])REP(j,m){\n            b[i][j] += a[i+c[k]][j];\n          }\n          REP(i,c[k])REP(j,m){\n            b[i][j] += a[c[k]-i-1][j];\n          }\n        }else{\n          REP(i,n-c[k])REP(j,m){\n            b[i][j] += a[i+c[k]][j];\n          }\n          REP(i,c[k])REP(j,m){\n            b[i][j] += a[c[k]-i-1][j];\n          }\n          // REP(i,c[k])REP(j,m){\n          //   b[i][j] += a[c[k]-i-1][j];\n          // }\n          // REP(i,c[k])REP(j,m){\n          //   b[i][j] += a[i+c[k]][j];\n          // }\n        }\n        n = max(c[k],n-c[k]);\n      }else{\n        b.assign(n,vi(max(c[k],m-c[k]),0));\n        if(c[k]<m-c[k]){\n          REP(i,n)REP(j,m-c[k]){\n            b[i][j] += a[i][j+c[k]];\n          }\n          REP(i,n)REP(j,c[k]){\n            b[i][j] += a[i][c[k]-j-1];\n          }\n        }else{\n          REP(i,n)REP(j,m-c[k]){\n            b[i][j] += a[i][j+c[k]];\n          }\n          REP(i,n)REP(j,c[k]){\n            b[i][j] += a[i][c[k]-j-1];\n          }\n        }\n        m = max(c[k],m-c[k]);\n      }\n      a = b;\n    }\n    REP(i,p){\n      cout << a[x[i]][y[i]] << endl;\n    }\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntemplate <class T> inline bool chmax(T &a, T b) {\n    if(a < b) {\n        a = b;\n        return 1;\n    }\n    return 0;\n}\ntemplate <class T> inline bool chmin(T &a, T b) {\n    if(a > b) {\n        a = b;\n        return 1;\n    }\n    return 0;\n}\nusing ll = long long;\n\n#define ALL(v) (v).begin(), (v).end()\n#define RALL(v) (v).rbegin(), (v).rend()\n#define endl \"\\n\"\nconst double EPS = 1e-7;\nconst int INF = 1 << 30;\nconst ll LLINF = 1LL << 60;\nconst double PI = acos(-1);\nconstexpr int MOD = 1000000007;\nconst int dx[4] = {1, 0, -1, 0};\nconst int dy[4] = {0, 1, 0, -1};\n\n//-------------------------------------\n\nbool solve() {\n    int n, m, t, p;\n    cin >> m >> n >> t >> p;\n    if(n == 0) {\n        return false;\n    }\n    vector<vector<int>> cnt(2 * n + 10, vector<int>(2 * m + 10, 0));\n    for(int i = 0; i < n; i++) {\n        for(int j = 0; j < m; j++) {\n            cnt[i][j]++;\n        }\n    }\n    while(t--) {\n        int d, c;\n        cin >> d >> c;\n        if(d == 1) {\n            for(int i = 0; i < n; i++) {\n                for(int j = 0; j < c; j++) {\n                    int k = c - 1 + (c - j);\n                    cnt[i][k] += cnt[i][j];\n                    cnt[i][j] = 0;\n                }\n            }\n            for(int i = 0; i < n; i++) {\n                for(int j = c; j < 2 * m + 10; j++) {\n                    cnt[i][j - c] = cnt[i][j];\n                    cnt[i][j] = 0;\n                }\n            }\n        } else {\n            for(int i = 0; i < c; i++) {\n                for(int j = 0; j < m; j++) {\n                    int k = c - 1 + (c - i);\n                    cnt[k][j] += cnt[i][j];\n                    cnt[i][j] = 0;\n                }\n            }\n            for(int i = c; i < 2 * n + 10; i++) {\n                for(int j = 0; j < m; j++) {\n                    cnt[i - c][j] = cnt[i][j];\n                    cnt[i][j] = 0;\n                }\n            }\n        }\n        // for(int i = 0; i < n; i++) {\n        //     for(int j = 0; j < m; j++) {\n        //         cout << cnt[i][j] << \" \";\n        //     }\n        //     cout << endl;\n        // }\n    }\n    while(p--) {\n        int x, y;\n        cin >> x >> y;\n        cout << cnt[y][x] << endl;\n    }\n    return true;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    while(1) {\n        if(!solve()) {\n            return 0;\n        }\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\nusing namespace std;\n\nint v[750][750];\n\nint main(){\n    int w, h, t, p;\n    while(cin >> w >> h >> t >> p, w+h+t+p){\n        int oi = 0, oj = 0;\n        memset(v, 0, sizeof(v));\n        for(int i = 0; i < h; i++){\n            for(int j = 0; j < w; j++){\n                v[i][j] = 1;\n            }\n        }\n        while(t-- > 0){\n            int d, c;\n            cin >> d >> c;\n            if(d == 1){\n                for(int add = 0; add < c; add++){\n                    for(int i = oi; i < oi+h; i++){\n                        v[i][oj+2*c-1-add] += v[i][oj+add];\n                        v[i][oj+add] = 0;\n                    }\n                }\n                oj += c;\n            }else{\n                for(int add = 0; add < c; add++){\n                    for(int j = oj; j < oj+w; j++){\n                        v[oi+2*c-1-add][j] += v[oi+add][j];\n                        v[oi+add][j] = 0;\n                    }\n                }\n                oi += c;\n            }\n        }\n\n        while(p-- > 0){\n            int x, y;\n            cin >> x >> y;\n            cout << v[oi+y][oj+x] << endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define all(x) (x).begin(),(x).end()\n#define fore(i,a) for(auto &i:a)\n#define rep(i,a,b) for(int i=a;i<b;i++)\n#define rrep(i,a,b) for(int i=a;i>=b;i--)\nusing namespace std; void _main(); int main() { cin.tie(0); ios::sync_with_stdio(false); _main(); }\ntypedef long long ll; const int inf = INT_MAX / 2; const ll infl = 1LL << 60;\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a = b; return 1; } return 0; }\ntemplate<class T>bool chmax(T &a, const T &b) { if (a<b) { a = b; return 1; } return 0; }\n\n\nint A[2][101][101];\nint W, H, T, P;\n\n//---------------------------------------------------------------------------------------------------\nvoid _main() {\n    while (cin >> W >> H >> T >> P) {\n        if (W == 0) return;\n        \n        rep(t, 0, 2) rep(y, 0, 101) rep(x, 0, 101) A[t][y][x] = 0;\n        rep(y, 0, H) rep(x, 0, W) A[0][y][x] = 1;\n\n        rep(t, 0, T) {\n            int d, c; cin >> d >> c;\n            rep(y, 0, 101) rep(x, 0, 101) A[(t + 1) % 2][y][x] = 0;\n\n            if (d == 1) {\n                rep(y, 0, H) rep(x, 0, W) A[(t + 1) % 2][y][x] = A[t % 2][y][x + c];\n                rep(x, 0, c) rep(y, 0, H) A[(t + 1) % 2][y][x] += A[t % 2][y][c - 1 - x];\n            } else {\n                rep(y, 0, H) rep(x, 0, W) A[(t + 1) % 2][y][x] = A[t % 2][y + c][x];\n                rep(x, 0, W) rep(y, 0, c) A[(t + 1) % 2][y][x] += A[t % 2][c - 1 - y][x];\n            }\n        }\n\n        rep(p, 0, P) {\n            int x, y; cin >> x >> y;\n            printf(\"%d\\n\", A[T % 2][y][x]);\n        }\n    }\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\n\nint x1,x2,y1,y2;\nint ma[500][500];\n\nvoid init()\n{\n    for(int i=1;i<=450;i++)\n        for(int j=1;j<=450;j++)\n            ma[i][j]=0;\n    for(int i=1;i<=x2;i++)\n        for(int j=1;j<=y2;j++)\n    ma[i][j]=1;\n}\n\nvoid fold1(int t)\n{\n    for(int i=y1;i<=y2+1;i++)\n        for(int j=1;j<=t-x1;j++)\n    {\n        ma[t+j][i]+=ma[t-j+1][i];\n        ma[t-j+1][i]=0;\n    }\n    x1=t;\n    x2=max(2*t-x1,x2);\n}\nvoid fold2(int t)\n{\n    for(int i=x1;i<=x2+1;i++)\n        for(int j=1;j<=t-y1;j++)\n    {\n        ma[i][t+j]+=ma[i][t-j+1];\n        ma[i][t-j+1]=0;\n    }\n    y1=t;\n    y2=max(2*t-y1,y2);\n}\n\nint main()\n{\n    int n, m, t, p;\n    while(1)\n    {\n        scanf(\"%d%d%d%d\",&n,&m,&t,&p);\n        if(n==0) return 0;\n        x1=0;x2=n;\n        y1=0;y2=m;\n        init();\n        while(t--)\n        {\n            int c, d;\n            scanf(\"%d%d\",&c,&d);\n            if(c==1) fold1(d+x1);\n            if(c==2) fold2(d+y1);\n        }\n        while(p--)\n        {\n            int x, y;\n            scanf(\"%d%d\",&x,&y);\n            printf(\"%d\\n\",ma[x+x1+1][y+y1+1]);\n        }\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\nusing namespace std;\nint n,m,t,p;\nint main()\n{\n    for(;;)\n    {\n        int a[35][35],x[1000],y[1000];\n        scanf(\"%d %d %d %d\",&n,&m,&t,&p);\n        if(n==0&&m==0&&t==0&&p==0)break;\n        for(int i=0;i<33;i++)\n            for(int j=0;j<33;j++)\n            a[j][i]=1;\n        for(int i=0;i<t;i++)\n        {\n            int d,c;\n            scanf(\"%d %d\",&d,&c);\n            if(d==1)\n            {\n                int z[35][35];\n                if(c>n/2)c=n-c;\n                for(int j=c-1;j>=0;j--)\n                    for(int k=0;k<m;k++)\n                {\n                    z[k][j]=a[k][c-j-1]+a[k][c+j];\n                }\n                for(int j=c-1;j>=0;j--)\n                    for(int k=0;k<m;k++)\n                    a[k][j]=z[k][j];\n                for(int j=c;j<n-c;j++)\n                    for(int k=0;k<m;k++)\n                    a[k][j]=a[k][j+c];\n                n=n-c;\n            }\n            else if(d==2)\n            {\n                if(c<m/2+1)c=m-c;\n                for(int j=2*c-m;j<c;j++)\n                    for(int k=0;k<n;k++)\n                {\n                    a[j][k]=a[j][k]+a[2*c-j-1][k];\n                }\n                m=c;\n            }\n        }\n        for(int i=0;i<p;i++)\n        {\n            scanf(\"%d %d\",&x[i],&y[i]);printf(\"%d\\n\",a[m-1-y[i]][x[i]]);\n        }\n        for(int i=0;i<p;i++)\n        {\n\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\nint main(int argc, char const *argv[])\n {\n   \n   while(true){\n      int n, m, t, p; cin >> n >> m >> t >> p;\n      if (n == 0) break;\n      int d[t], c[t]; for (int i = 0; i < t; i++) cin >> d[i] >> c[i];\n      int x[p], y[p]; for (int i = 0; i < p; i++) cin >> x[i] >> y[i];\n\n      int cell[20*n][20*m] = {}; \n      for (int i = 0; i < n; i++) for (int j = 0; j < m; j++) cell[i][j] = 1;\n      int xoffset = 0, yoffset = 0;\n      int count1=0, count2=0;\n      for (int k = 0; k < t; k++) {\n        if (d[k] == 1) {\n          int count = 0;\n          while((c[k]-count)!=0){\n            for (int j = 0; j < 20*m; j++){\n              cell[c[k]+count+count1][j] += cell[c[k]-count-1+count1][j];\n              cell[c[k]-count-1+count1][j] = 0;\n            }\n            count++;\n          }\n          count1 += c[k];\n        } \n        else {\n          int count = 0;\n          while((c[k]-count)!=0){\n            for (int i = 0; i < 20*n; i++){\n              cell[i][c[k]+count+count2] += cell[i][c[k]-count-1+count2];\n              cell[i][c[k]-count-1+count2] = 0;\n            }\n            count++;\n          }\n          count2+=c[k];\n        }\n\n      }\n      \n      for (int i = 0; i < p; i++) {\n        cout << cell[x[i]+count1][y[i]+count2] << endl;\n      }\n    }\n   return 0;\n }\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\nbool solve() {\n    int N, M, T, P;\n    cin >> N >> M >> T >> P;\n    if (N == 0) return false;\n\n    vector<vector<int>> card(500, vector<int>(500, 0));\n    for (int x = 0; x < N; ++x) {\n        for (int y = 0; y < M; ++y) {\n            card[x][y] = 1;\n        }\n    }\n\n    int l = 0, u = 0;\n    for (int q = 0; q < T; ++q) {\n        int d, c;\n        cin >> d >> c;\n        if (d == 1) {\n            for (int x = 0; x < c; ++x) {\n                for (int y = 0; y < M; ++y) {\n                    card[l + 2 * c - 1 - x][u + y] += card[l + x][u + y];\n                    card[l + x][u + y] = 0;\n                }\n            }\n            l += c;\n            N = max(c, N - c);\n        } else {\n            for (int x = 0; x < N; ++x) {\n                for (int y = 0; y < c; ++y) {\n                    card[l + x][u + 2 * c - 1 - y] += card[l + x][u + y];\n                    card[l + x][u + y] = 0;\n                }\n            }\n            u += c;\n            M = max(c, M - c);\n        }\n    }\n\n    for (int q = 0; q < P; ++q) {\n        int x, y;\n        cin >> x >> y;\n        cout << card[l + x][u + y] << endl;\n    }\n\n    return true;\n}\n\nint main() {\n    while (solve()) {}\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint N,M,T,P,d,c,x,y;\nint A[2][50][50] = {};\n\nint main(){\n\twhile(cin >> N >> M >> T >> P && N>0){\n\t\tfor(int i=1;i<=N;i++){\n\t\t\tfor(int j=1;j<=M;j++){\n\t\t\t\tA[0][i][j] = 1;\n\t\t\t\tA[1][i][j] = 0;\n\t\t\t}\n\t\t}\n\t\tint n = N,m = M;\n\t\tfor(int t=0;t<T;t++){\n\t\t\tcin >> d >> c;\n\t\t\tif(d==1){\n\t\t\t\tfor(int i=c+1;i<=n;i++){\n\t\t\t\t\tfor(int j=1;j<=m;j++){\n\t\t\t\t\t\tA[1-t%2][i-c][j] = A[t%2][i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int i=1;i<=c;i++){\n\t\t\t\t\tfor(int j=1;j<=m;j++){\n\t\t\t\t\t\tA[1-t%2][i][j] += A[t%2][c-i+1][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tn = max(n-c,c);\n\t\t\t}else{\n\t\t\t\tfor(int i=1;i<=n;i++){\n\t\t\t\t\tfor(int j=c+1;j<=m;j++){\n\t\t\t\t\t\tA[1-t%2][i][j-c] = A[t%2][i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int i=1;i<=n;i++){\n\t\t\t\t\tfor(int j=1;j<=c;j++){\n\t\t\t\t\t\tA[1-t%2][i][j] += A[t%2][i][c-j+1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tm = max(m-c,c);\n\t\t\t}\n\t\t\tfor(int i=1;i<=N;i++){\n\t\t\t\tfor(int j=1;j<=M;j++){\n\t\t\t\t\tA[t%2][i][j] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<P;i++){\n\t\t\tcin >> x >> y;\n\t\t\tcout << A[T%2][x+1][y+1] << endl;\n\t\t}\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <cstring>\nusing namespace std;\nconst int maxn=70;\nint g[maxn][maxn];\nint n=0,m=0,t=0,p=0;\nint d=0,c=0;\nint x=0,y=0;\nint dx=0,dy=0;\nint main()\n{\n    //freopen(\"C:\\\\Users\\\\atara\\\\Desktop\\\\in.txt\",\"r\",stdin);\n    while(scanf(\"%d%d%d%d\",&n,&m,&t,&p)==4&&(n+m+t+p)!=0)\n    {\n        dx=0;\n        dy=0;\n        memset(g,0,sizeof(g));\n        for(int i=0;i<m;++i)\n            for(int j=0;j<n;++j)\n        {\n            g[i][j]=1;\n        }\n        for(int k=0;k<t;++k)\n        {\n            scanf(\"%d%d\",&d,&c);\n            if(d==1)\n            {\n                dy+=c;\n                for(int i=dx;i<70;++i)\n                    for(int j=dy;j<dy+c;++j)\n                     g[i][j]=g[i][j]+g[i][j-c];\n            }\n            else\n            {\n\n                dx+=c;\n                for(int i=dx;i<dx+c;++i)\n                    for(int j=dy;j<70;++j)\n                   g[i][j]=g[i][j]+g[i-c][j];\n            }\n           /* printf(\"%d %d\\n\",dx,dy);\n           for(int i=m-1;i>=0;--i)\n            {\n\n                 for(int j=0;j<n;++j)\n                    printf(\"%d \",g[i][j]);\n                 printf(\"\\n\");\n            }*/\n\n\n        }\n        for(int k=0;k<p;++k)\n        {\n            scanf(\"%d%d\",&x,&y);\n            printf(\"%d\\n\",g[dx+y][dy+x]);\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<set>\n#include<map>\n#include<stack>\n\n#define MOD 10000000\nusing namespace std; \ntypedef long long LL;\n\nlong long quickpow(long long n, long long base) {\n    long long res = 1;\n    while(n) {\n        if(n & 1) {\n            res = res * base % MOD;\n        }\n        n >>= 1;\n        base = base * base % MOD;\n    }\n    return res;\n}//快速幂 \n\nint ans[50];\nint A[50][50];\nint main()\n{\n\t  int n,m,t,p;\n\t  cin>>n>>m>>t>>p;\n\t  int d,c,x,y;\n\n      while(n!=0||m!=0||t!=0||p!=0)\n      {\n      \t  for(int i=1;i<=m;i++)\n      \t  for(int j=1;j<=n;j++)\n      \t  {\n  \t      \t A[i][j]=1;\n  \t      }\n  \t      for(int i=1;i<=t;i++)\n  \t      {\n      \t  \tcin>>d>>c;\n      \t  \t  if(d==1)\n      \t  \t  {\n\t  \t      \t  if(c<=(n/2))\n\t  \t      \t  {\n\t  \t      \t  \t   for(int i=1;i<=m;i++)\n  \t      \t  \t\t   for(int j=c+1;j<=(2*c);j++)\n  \t      \t  \t\t   A[i][j]+=A[i][(2*c)+1-j];\n   \t  \t\t           for(int i=1;i<=m;i++)\n  \t\t               for(int j=1;j<=(n-c);j++)\n  \t\t               A[i][j]=A[i][j+c];\n                       n-=c;\n  \t      \t  \t  }\n  \t      \t  \t  else\n  \t      \t  \t  {\n  \t  \t      \t  \t  for(int i=1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=c+1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]+=A[i][(2*c)+1-j];\n  \t  \t      \t  \t  for(int i=1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=n-c+1;j<=c;j++)\n  \t  \t      \t  \t  A[i][j]=A[i][j-(n-c)];\n  \t  \t      \t  \t  for(int i=1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n-c;j++)\n  \t  \t      \t  \t  A[i][j]=A[i][j+c];\n                      n=c;\n  \t      \t  \t  }\n  \t          }\n  \t          if(d==2)\n  \t          {\n\t  \t      \t  if(c<=(m/2))\n\t  \t      \t  {\n\t  \t      \t  \t   for(int i=c+1;i<=(2*c);i++)\n  \t      \t  \t\t   for(int j=1;j<=n;j++)\n  \t      \t  \t\t   A[i][j]+=A[(2*c)+1-i][j];\n   \t  \t\t           for(int i=1;i<=m-c;i++)\n  \t\t               for(int j=1;j<=n;j++)\n  \t\t               A[i][j]=A[i+c][j];\n                       m-=c;\n\n  \t      \t  \t  }\n  \t      \t  \t  else\n  \t      \t  \t  {\n  \t  \t      \t  \t  for(int i=c+1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]+=A[(2*c)+1-i][j];\n  \t  \t      \t  \t  for(int i=m-c+1;i<=c;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]=A[i-(n-c)][j];\n  \t  \t      \t  \t  for(int i=1;i<=m-c;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]=A[i+c][j];\n                      m=c;\n  \t      \t  \t  }\n          \t  }\n      \t  }\n      \t  int j=0;\n      \t  for(int i=1;i<=p;i++)\n      \t  {\n      \t  \tcin>>x>>y;\n  \t      \tans[++j]=A[y+1][x+1];\n  \t      }\n  \t      for(int i=1;i<=j;i++)\n  \t      {\n      \t  \tcout<<ans[i]<<endl;\n      \t  }\n      \t  cin>>n>>m>>t>>p;\n      }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n\nint main(){\n  while(true){\n    int n, m, t, p, d, c, x, y, temp[100][100] = {}, ll, bb;\n    cin>>n>>m>>t>>p;\n\n    if(!m&&!n&&!t&&!p)break;\n    \n    for(int i = 1; i <= m; i++)for(int j = 1; j<= n; j++)temp[i][j] = 1;\n    ll = 1; bb = m;\n    for(int i = 1; i <= t; i++){\n      cin>>d>>c;\n      if(d==1){\n        //c = min(c, (n-ll+1)-c);\n\tif(c > (n-ll+1)-c){\n\t  c = (n-ll+1)-c;\n\t  for(int j = n; j >= ll ; j--){\n\t    for(int k = 1; k<= bb; k++){\n\t      if(j < n-j+ll)break;\n\t      swap(temp[k][j],temp[k][n-j+ll]);\n\t    }\n\t  }\n\t}\n\t\n\t\n\tfor(int j = 1; j <= c; j++){\n\t  for(int k = 1; k <= bb; k++){\n\t    temp[k][ll+c+j-1]+=temp[k][ll+c-j];\n\t    temp[k][ll+c-j] = 0;\n\t  }\n\t}\n\tll += c;\n      }else if(d==2){\n\t//c = min(c, bb-c);\n\tif(c > bb-c){\n\t  c = bb - c;\n\t  for(int j = 1; j <= bb; j++){\n\t    for(int k = ll; k <= n; k++){\n\t      if(j > bb-j+1)break;\n\t      swap(temp[j][k],temp[bb-j+1][k]);\n\t    }\n\t  }\n\t}\n\t\n\tfor(int j = 1; j <= c; j++){\n\t  for(int k = ll; k <= n; k++){\n\t    temp[bb-c-j+1][k]+=temp[bb-c+j][k];\n\t    temp[bb-c+j][k] = 0;\n\t  }\n\t}\n\tbb -= c; \n      }\n      /*\n      for(int i = 0; i <= m+1; i++){\n\tfor(int j = 0; j<= n+1; j++){\n\t  cout<<temp[i][j]<<\" \";\n\t}\n\tcout<<endl;\n      }cout<<endl;\n      \n\n      cout<<bb<<\" \"<<ll<<endl<<endl;\n      */\n    }\n    \n    for(int i = 1; i <= p; i++){\n      cin>>x>>y;\n      cout<<temp[bb-y][ll+x]<<endl;\n    }\n  }\n  \n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n  while(true){\n    int n,m,t,p;\n    cin >> n>>m>>t>>p;\n    if(n==0&&m==0&&t==0&&p==0)\n      break;\n    int Ori[64][64] = {{0}};\n    for(int i=0;i<m;i++){\n      for(int j=0;j<n;j++){\n        Ori[i][j]=1;\n      }\n    }\n    for(int i=0;i<t;i++){\n      int d,c;\n      cin >> d>>c;\n      if(d==1){\n        for(int x=0;x<c;x++){\n          for(int y=0;y<m;y++){\n            Ori[y][2*c-1-x] += Ori[y][x];\n            Ori[y][x]=0;\n          }\n        }\n        for(int x=0;x<n;x++){\n          for(int y=0;y<m;y++){\n            Ori[y][x]=Ori[y][x+c];\n            Ori[y][x+c]=0;\n          }\n        }\n      }else{\n        for(int y=0;y<c;y++){\n          for(int x=0;x<n;x++){\n            Ori[2*c-1-y][x] += Ori[y][x];\n            Ori[y][x]=0;\n          }\n        }\n        for(int y=0;y<m;y++){\n          for(int x=0;x<n;x++){\n            Ori[y][x]=Ori[y+c][x];\n            Ori[y+c][x]=0;\n          }\n        }\n      }\n    }\n    for(int i=0;i<p;i++){\n      int x,y;\n      cin>>x>>y;\n      cout<<Ori[y][x]<<endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint main(){\n  while(true){\n    int n, m, t, p;\n    cin >> n >> m >> t >> p;\n\n    if(n==0 && m==0 && t==0 && p==0){\n      break;\n    }\n\n    int Ori[64][64] = {{0}};\n    for(int y=0; y<m; y++){\n      for(int x=0; x<n; x++){\n        Ori[y][x] = 1;\n      }\n    }\n\n    for(int i=0; i<t; i++){\n      int d, c;\n      cin >> d >> c;\n\n      if(d==1){\n        for(int x=0; x<c; x++){\n          for(int y=0; y<m; y++){\n            Ori[y][2*c-1-x] += Ori[y][x];\n            Ori[y][x] = 0;\n          }\n        }\n\n          for(int x=0; x<n; x++){\n            for(int y=0; y<m; y++){\n              Ori[y][x] = Ori[y][x+c];\n              Ori[y][x+c] = 0;\n            }\n          }\n       }\n       else{\n         for(int y=0; y<c; y++){\n           for(int x=0; x<n; x++){\n             Ori[2*c-1-y][x] += Ori[y][x];\n             Ori[y][x] = 0;\n           }\n         }\n\n           for(int y=0; y<m; y++){\n             for(int x=0; x<n; x++){\n               Ori[y][x] = Ori[y+c][x];\n               Ori[y+c][x] = 0;\n             }\n           }\n       }\n     }\n     for(int i=0; i<p; i++){\n       int x, y;\n       cin >> x >> y;\n\n       cout << Ori[y][x] << endl;\n     }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nconst long mod = 1000000007;\ntypedef long long lint;\n\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define repi(N) for(int i = 0; i < (int)(N); i++)\n#define all(x) (x).begin(),(x).end()\n#define length(x) ((int)(x).size())\n#define prln(s) cout<<s<<endl;\n\n#define str(s) string s;cin>>s;\n#define int1(x) int x;cin>>x;\n#define int2(x,y) int x,y;cin>>x>>y;\n\nint paper[64][64];\n\nvoid move(int x, int y){\n  if(x!=0 && y==0){//yokohoko\n    rep(i,64-x){\n      rep(j,64){\n        paper[i][j]=paper[i+x][j];\n        paper[i+x][j]=0;\n      }\n    }\n  }else if(x==0 && y!=0){//yokohoko\n    rep(i,64){\n      rep(j,64-x){\n        paper[i][j]=paper[i][j+y];\n        paper[i][j+y]=0;\n      }\n    }\n  }\n}\nvoid print(){\n  //return;\n  prln(\"----Start\");\n  rep(i,64){\n    rep(j,64){\n      cout<<paper[i][j]<<\" \";\n    }\n    cout<<endl;\n  }\n  prln(\"---End\");\n}\nint linenum=0;\nint main() {\n  while(true){\n    int2(n,m);\n    int2(t,p);\n    if(n*m*t*p==0){break;}\n    rep(i,64){\n      rep(j,64){\n        paper[i][j]=0;\n      }\n    }\n    rep(i,n){\n      rep(j,m){\n        paper[i][j]=1;\n      }\n    }\n    rep(i,t){\n      int2(d,c);\n      if(d==1){\n        for(int i=c-1;i>=0;i--){\n          rep(j,m){\n            paper[2*c-i-1][j]+=paper[i][j];\n            paper[i][j]=0;\n          }\n\t\n        }\n        move(c,0);\n      }else{\n        for(int i=c-1;i>=0;i--){\n          rep(j,n){\n            paper[j][2*c-i-1]+=paper[j][i];\n            paper[j][i]=0;\n\t  \n          }\n        }\n        move(0,c);\n      }\n    }\n    int anal  =0;\n    rep(i,p){\n      int2(x,y);\n      prln(paper[x][y]);\n    \n    }\n  }\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, b) for(ll i = ll(a); i < ll(b); i++)\n#define rer(i, a, b) for(ll i = ll(a) - 1; i >= ll(b); i--)\n#define sz(v) (int)(v).size()\n#define pb push_back\n#define sc second\n#define fr first\n#define sor(v) sort(v.begin(),v.end())\n#define rev(s) reverse(s.begin(),s.end())\n#define lb(vec,a) lower_bound(vec.begin(),vec.end(),a)\n#define ub(vec,a) upper_bound(vec.begin(),vec.end(),a)\n#define uniq(vec) vec.erase(unique(vec.begin(),vec.end()),vec.end())\nusing namespace std;\ntypedef long long int ll;\ntypedef pair <int, int> P;\n\nconst ll MOD=1000000007;\n\nint main() {\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    for(;;){\n        int n,m,t,p;\n        cin>>n>>m>>t>>p;\n        if(!n) return 0;\n        vector<vector<ll>> f(700,vector<ll>(700,0));\n        int L=0,R=n, U=0,D=m;\n        rep(i,0,m){\n            rep(j,0,n) f[i][j]=1;\n        }\n        rep(_,0,t){\n            int d,c;\n            cin>>d>>c;\n            if(d==1){\n                rep(i,U,D){\n                    rep(j,L+c,2*c+L){\n                        f[i][j]+=f[i][2*L+2*c-1-j];\n                    }\n                }\n                L+=c;\n                R=max(R,L+2*c);\n            }\n            else{\n                rep(i,U+c,U+2*c){\n                    rep(j,L,R){\n                        f[i][j]+=f[2*U+2*c-1-i][j];\n                    }\n                }\n                U+=c;\n                D=max(D,U+2*c);\n            }\n        }\n        rep(_,0,p){\n            int x,y;\n            cin>>x>>y;\n            x+=L;\n            y+=U;\n            cout <<f[y][x]<<\"\\n\";\n        }\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n \nint main(){\n  int n,m,t,p;\n \n  while(1){\n    cin >> n >> m >> t >> p ;\n \n    if(n==0 && m==0 && t==0 && p==0){\n      break;\n    }\n \n    int Ori[64][64] = {{0}};\n    for(int y=0;y<m;y++){\n      for(int x=0;x<n;x++){\n        Ori[y][x] = 1;\n      }\n    }\n \n    for(int i=0;i<t;i++){\n      int d,c;\n      cin >> d >> c;\n \n      if(d==1){\n        for(int x=0;x<c;x++){\n          for(int y=0;y<m;y++){\n            Ori[y][2*c-1-x] += Ori[y][x];\n            Ori[y][x] = 0;\n          }\n        }\n \n        for(int x=0;x<n;x++){\n          for(int y=0;y<m;y++){\n            Ori[y][x] = Ori[y][x+c];\n            Ori[y][x+c] = 0;\n          }\n        }\n      }\n      else{\n        for(int y=0;y<c;y++){\n          for(int x=0;x<n;x++){\n            Ori[2*c-1-y][x] += Ori[y][x];\n            Ori[y][x] = 0;\n          }\n        }\n \n        for(int y=0;y<m;y++){\n          for(int x=0;x<n;x++){\n            Ori[y][x] = Ori[y+c][x];\n            Ori[y+c][x] = 0;\n          }\n        }\n      }\n    }\n \n    for(int i=0;i<p;i++){\n      int x,y;\n      cin >> x >> y;\n \n      cout << Ori[y][x] << endl;\n    }\n  }\n \n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define INF_LL (int64)1e18\n#define INF (int32)1e9\n#define REP(i,n) for(int64 i = 0; i < (n); i++)\n#define FOR(i, a, b) for(int64 i = (a);i < (b);i++)\n#define FORR(i,a,b) for(int64 i = (a); i >= (b);--i )\n#define all(x) x.begin(),x.end()\n#define fs first;\n#define sc second;\n\nusing int32 = int_fast32_t;\nusing int64 = int_fast64_t;\nusing PII = pair<int32, int32>;\nusing PLL = pair<int64, int64>;\n\ntemplate<typename A, typename B> inline void chmin(A &a, B b) { if(a > b) a = b; }\ntemplate<typename A, typename B> inline void chmax(A &a, B b) { if(a < b) a = b; }\n\n\n\nint main(void){\n  cin.tie(0);\n  int32 n;\n  while (cin >> n && n) {\n    int32 m,t,p;\n    cin >> m >> t >> p;\n    vector<vector<int64>> kami(n*(t+1), vector<int64>(m*(t+1),0));\n    int32 a,b;\n    a = 0;\n    b = 0;\n    REP(i,n)REP(j,m){\n      kami[i][j] = 1;\n    }\n    REP(k,t){\n      int32 d,c;\n      cin >> d >> c;\n      if(d == 1){\n        REP(i,c)REP(j,m){\n          kami[a+c+i][b+j] += kami[a+c-i-1][b+j];\n        }\n        a += c;\n      }else{\n        REP(i,n)REP(j,c){\n          kami[a+i][b+c+j] += kami[a+i][b+c-j-1];\n        }\n        b += c;\n      }\n    }\n    // cout << endl;\n    // REP(i,2*n){\n    //   REP(j,2*m){\n    //     cout << kami[i][j];\n    //   }\n    //   cout << endl;\n    // }\n    // cout << endl;\n    REP(k,p){\n      int64 cnt = 0;\n      int32 x,y;\n      cin >> x >> y;\n      cnt += kami[a+x][b+y];\n      cout << cnt << endl;\n    }\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cmath>\n#include <iostream>\n#include <vector>\n#include <queue>\n#include <deque>\n#include <map>\n#include <set>\n#include <stack>\n#include <tuple>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <utility>\n#include <iomanip>\n\n#define int long long int\n#define rep(i, n) for(int i = 0; i < (n); ++i)\n\nusing namespace std;\n\ntypedef pair<int, int> P;\n\nconst int INF = 1e15;\nconst int MOD = 1e9+7;\n\nsigned main(){\n    while(true){\n        int n, m, t, p;\n        cin >> n >> m >> t >> p;\n\n        if(n == 0 && m == 0 && t == 0 && p == 0){\n            break;\n        }\n\n        vector<vector<int>> a(n*2, vector<int>(m*2, 0));\n        rep(i, n){\n            rep(j, m){\n                a[i][j] = 1;\n            }\n        }\n        rep(i, t){\n            int d, c;\n            cin >> d >> c;\n\n            if(d == 1){\n                for(int j = c; j < n + c; j++){\n                    int s = c*2-1;\n                    if(s-j < 0){\n                        break;\n                    }\n                    rep(k, m){\n                        a[j][k] += a[s-j][k];\n                        a[s-j][k] = 0;\n                    }\n                }\n                for(int j = c; j < n + c; j++){\n                    rep(k, m){\n                        a[j-c][k] = a[j][k];\n                        a[j][k] = 0;\n                    }\n                }\n                n = max(c, n-c);\n            }\n\n            if(d == 2){\n                for(int j = c; j < m + c; j++){\n                    int s = c*2-1;\n                    if(s-j < 0){\n                        break;\n                    }\n                    rep(k, n){\n                        a[k][j] += a[k][s-j];\n                        a[k][s-j] = 0;\n                    }\n                }\n                for(int j = c; j < m + c; j++){\n                    rep(k, n){\n                        a[k][j-c] = a[k][j];\n                        a[k][j] = 0;\n                    }\n                }\n                m = max(c, m-c);\n            }\n        }\n\n        rep(i, p){\n            int x, y;\n            cin >> x >> y;\n            cout << a[x][y] << endl;\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n#include <tuple>\n\nusing namespace std;\n\nclass Solver {\n};\n\nint main() {\n\twhile (true) {\n\t\tint n, m, t, p;\n\t\tcin >> n >> m >> t >> p;\n\t\tif (n == 0)break;\n\n\t\tvector<vector<int>> grid(m, vector<int>(n, 1));\n\t\tint left = 0;\n\t\tint down = 0;\n\t\tfor (int i = 0; i < t; i++) {\n\t\t\tint d, c;\n\t\t\tcin >> d >> c;\n\t\t\tif (d == 1) {\n\t\t\t\tif (n - left - c < c) {\n\t\t\t\t\tfor (int j = 0; left + j < n - 1 - j; j++) {\n\t\t\t\t\t\tfor (int k = 0; k < m; k++) {\n\t\t\t\t\t\t\tint tmp = grid[k][left + j];\n\t\t\t\t\t\t\tgrid[k][left + j] = grid[k][n - 1 - j];\n\t\t\t\t\t\t\tgrid[k][n - 1 - j] = tmp;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tc = n - left - c;\n\t\t\t\t}\n\n\t\t\t\tfor (int j = 0; j < c; j++) {\n\t\t\t\t\tint target = left + c * 2 - 1 - j;\n\t\t\t\t\tfor (int k = 0; k < m; k++) {\n\t\t\t\t\t\tgrid[k][target] += grid[k][left + j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tleft += c;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (m - down - c < c) {\n\t\t\t\t\tfor (int j = 0; down+j < m - 1 - j; j++) {\n\t\t\t\t\t\tfor (int k = 0; k < n; k++) {\n\t\t\t\t\t\t\tint tmp = grid[down + j][k];\n\t\t\t\t\t\t\tgrid[down + j][k] = grid[m - 1 - j][k];\n\t\t\t\t\t\t\tgrid[m - 1 - j][k] = tmp;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tc = m - down - c;\n\t\t\t\t}\n\n\t\t\t\tfor (int j = 0; j < c; j++) {\n\t\t\t\t\tint target = down + c * 2 - 1 - j;\n\t\t\t\t\tfor (int k = 0; k < n; k++) {\n\t\t\t\t\t\tgrid[target][k] += grid[down + j][k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdown += c;\n\t\t\t}\n\t\t}\n\n\t\tfor (int i = 0; i < p; i++) {\n\t\t\tint x, y;\n\t\t\tcin >> x >> y;\n\t\t\tcout << grid[down + y][left + x] << endl;\n\t\t}\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint main(){\n  int n,m,t,p;\n  int d,c,x,y;\n  int ans=0;\n  int a=0,b=0;\n  int paper[70][70];\n  while(1){\n     for(int i=0;i<70;i++){\n      for(int j=0;j<70;j++){\n        paper[i][j]=0;\n      }\n    }\n    cin>>n>>m>>t>>p;\n    if(n==0 && m==0 && t==0 && p==0) break;\n    for(int i=0;i<m;i++){\n      for(int j=0;j<n;j++){\n        paper[i][j]=1;\n      }\n    }\n    /*for(int j=0;j<m;j++){\n        for(int k=0;k<n;k++){\n          cout<<paper[j][k]<<\" \";\n        }\n        cout<<endl;\n    }*/\n    for(int i=0;i<t;i++){\n      cin>>d>>c;\n      a=1;\n      if(d==1){\n        for(int j=c;j<c+c;j++){\n          for(int k=0;k<m;k++){\n          paper[k][j]+=paper[k][j-a];\n          paper[k][j-a]=0;\n        }\n         a+=2;\n        }\n        for(int j=(n-1);j>=0;j--){\n          for(int k=0;k<m;k++){\n            if(paper[k][j]==0){\n              for(int a=j;a<n*2;a++){\n                paper[k][a]=paper[k][a+1];\n              }\n            }\n          }\n        }\n        }\n      if(d==2){\n        for(int j=c;j<c+c;j++){\n          for(int k=0;k<n;k++){\n            paper[j][k]+=paper[j-a][k];\n            paper[j-a][k]=0;\n          }\n          a+=2;\n        }\n        for(int j=(m-1);j>=0;j--){\n          for(int k=0;k<n;k++){\n            if(paper[j][k]==0){\n              for(int a=j;a<m*2;a++){\n                paper[a][k]=paper[a+1][k];\n              }\n            }\n          }\n        }\n      }\n   /*for(int j=0;j<m;j++){\n        for(int k=0;k<n;k++){\n          cout<<paper[j][k]<<\" \";\n        }\n        cout<<endl;\n        }*/\n      }\n    for(int i=0;i<p;i++){\n      cin>>x>>y;\n      ans=paper[y][x];\n      cout<<ans<<endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n/*{{{*/  //template\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\nconstexpr int INF = numeric_limits<int>::max()/2;\nconstexpr long long LINF = numeric_limits<long long>::max()/3;\n#define mp make_pair\n#define pb push_back\n#define eb emplace_back\n#define fi first\n#define se second\n#define all(v) (v).begin(),(v).end()\n#define sz(x) (int)(x).size()\n#define debug(x) cerr<<#x<<\":\"<<x<<endl\n#define debug2(x,y) cerr<<#x<<\",\"<<#y\":\"<<x<<\",\"<<y<<endl\n//struct fin{ fin(){ cin.tie(0); ios::sync_with_stdio(false); } } fin_;\nstruct Double{ double d; explicit Double(double x) : d(x){} };\nostream& operator<<(ostream& os,const Double x){ os << fixed << setprecision(20) << x.d; return os; }\ntemplate<typename T> ostream& operator<<(ostream& os,const vector<T>& vec){ os << \"[\"; for(const auto& v : vec){ os << v << \",\"; } os << \"]\"; return os; }\ntemplate<typename T,typename U> ostream& operator<<(ostream& os,const pair<T,U>& p){ os << \"(\" << p.first << \",\"<< p.second <<\")\"; return os; }\ntemplate<typename T> ostream& operator<<(ostream& os,const set<T>& st){ os<<\"{\"; for(T v:st) os<<v<<\",\"; os <<\"}\"; return os; }\ntemplate<typename T,typename U> inline void chmax(T &x,U y){ if(y>x) x = y; }\ntemplate<typename T,typename U> inline void chmin(T &x,U y){ if(y<x) x = y; }\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\nll gcd(ll a,ll b){ if(b==0) return a; else return gcd(b,a%b); }\n//constexpr double eps = 1e-14; \nconstexpr double eps = 1e-10; \nconstexpr ll mod = 1e9+7;\nconst int dx[]={1,0,-1,0} ,dy[] = {0,1,0,-1};\n/*}}}*/\n\nint n,m,t,p;\n\nvoid solve(){\n    vector<vector<int>> table(n,vector<int>(m,1));\n\n    rep(i,t){\n        int d,c; cin >> d >> c;\n        if(d==1){\n            int H = table[0].size();\n            int W1 = table.size();\n            int W2 = max(c,W1-c);\n            vvi cpy(W2,vi(H,0));\n            for(int i=0;i<W1-c;i++){\n                for(int j=0;j<H;j++){\n                    cpy[i][j] = table[i+c][j];\n                }\n            }\n            for(int i=0;i<c;i++){\n                for(int j=0;j<H;j++){\n                    cpy[i][j] += table[c-1-i][j];\n                }\n            }\n            table = cpy;\n        }else{\n            int W = table.size();\n            int H1 = table[0].size();\n            int H2 = max(c,H1-c);\n            vvi cpy(W,vi(H2,0));\n            for(int i=0;i<W;i++){\n                for(int j=0;j<H1-c;j++){\n                    cpy[i][j] = table[i][j+c];\n                }\n            }\n            for(int i=0;i<W;i++){\n                for(int j=0;j<c;j++){\n                    cpy[i][j] += table[i][c-1-j];\n                }\n            }\n            table = cpy;\n        }\n    }\n\n    rep(i,p){\n        int x,y; cin >> x >> y;\n        cout << table[x][y] << endl;\n    }\n}\n\nint main(){\n    while(1){\n        cin >> n >> m >> t >> p;\n        if(n==0 and m==0 and t==0 and p==0) break;\n        solve();\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "\n#include<bits/stdc++.h>\nusing namespace std;\n#define inf 1000000000\n#define INF 1000000000000000\n#define ll long long\n#define ull unsigned long long\n#define M (int)(1e9+7)\n#define P pair<int,int>\n#define PLL pair<ll,ll>\n#define FOR(i,m,n) for(int i=(int)m;i<(int)n;i++)\n#define RFOR(i,m,n) for(int i=(int)m;i>=(int)n;i--)\n#define rep(i,n) FOR(i,0,n)\n#define rrep(i,n) RFOR(i,n,0)\n#define all(a) a.begin(),a.end()\n#define IN(a,n) rep(i,n){ cin>>a[i]; }\nconst int vx[4] = {0,1,0,-1};\nconst int vy[4] = {1,0,-1,0};\n#define PI 3.14159265\n#define F first\n#define S second\n#define PB push_back\n#define EB emplace_back\nvoid init(){\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n}\n\n\nvoid f(int n,int m,int t,int p){\n  int a[1000][1000]={};\n  rep(i,m){\n    rep(j,n){\n      a[i][j]=1;\n    }\n  }\n  int sx=0,sy=0;\n  /*\n  rep(i,20){\n    rep(j,20){\n      cout<<a[i][j]<<' ';\n    }\n    cout<<endl;\n  }\n  cout<<endl;\n   */\n\n  while(t--){\n    int d,c;\n    cin>>d>>c;\n    if(d==1){\n      rep(i,m){\n        rep(j,c){\n          a[sy+i][sx+2*c-j-1]+=a[sy+i][sx+j];\n        }\n      }\n      sx+=c;\n    }\n    if(d==2){\n      rep(j,n){\n        rep(i,c){\n        \n          a[sy+2*c-i-1][sx+j]+=a[sy+i][sx+j];\n        }\n      }\n      sy+=c;\n    }\n\n\n/*  rep(i,20){\n    rep(j,20){\n      cout<<a[i][j]<<' ';\n    }\n    cout<<endl;\n  }\n  cout<<endl;\n */  \n  }\n\n/*  rep(i,20){\n    rep(j,20){\n      cout<<a[i][j]<<' ';\n    }\n    cout<<endl;\n  }\n  */\n  \n  while(p--){\n    int x,y;\n    cin>>x>>y;\n    cout<<a[sy+y][sx+x]<<endl;\n  }\n}\n\n\n\nint main(){\n  int n,m,t,p;\n  while(true){\n    cin>>n>>m>>t>>p;\n    if(!n) break;\n    f(n,m,t,p);\n  }\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\nint main()\n{\n\twhile(1)\n\t{\n\t\tint n,m,t,p;\n\t\tcin>>n>>m>>t>>p;\n\t\tif(n==0)\n\t\t\tbreak;\n\t\tint kami[96][96];\n\t\tfill(kami[0],kami[96],0);\n\t\t//初期値を置く\n\t\tfor(int i=0;i<m;i++)\n\t\t{\n\t\t\tfor(int j=0;j<n;j++)\n\t\t\t\tkami[i][j]=1;\n\t\t}\n\t\tint l=0;//現在の左のインデックス\n\t\tint u=0;//現在の上のインデックス\n\t\tint oru[20][2];\n\t\tfor(int i=0;i<t;i++)\n\t\t\tcin>>oru[i][0]>>oru[i][1];\n\t\tint ana[20][2];\n\t\tfor(int i=0;i<p;i++)\n\t\t\tcin>>ana[i][0]>>ana[i][1];\n\t\t\n\t\t//実際に折る\n\t\tfor(int i=0;i<t;i++)\n\t\t{\n\t\t\t//左側に折る\n\t\t\tif(oru[i][0]==1)\n\t\t\t{\n\t\t\t\tl=l+oru[i][1];\n\t\t\t\tfor(int i=0;i<l;i++)\n\t\t\t\t{\n\t\t\t\t\tfor(int j=0;j<96;j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tkami[j][l+i]+=kami[j][l-i-1];\n\t\t\t\t\t\tkami[j][l-i-1]=0;//折り終わったところにはもう何もない\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t//下に折る（実際には上）\n\t\t\t\tu=u+oru[i][1];\n\t\t\t\tfor(int i=0;i<u;i++)\n\t\t\t\t{\n\t\t\t\t\tfor(int j=0;j<96;j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tkami[u+i][j]+=kami[u-i-1][j];\n\t\t\t\t\t\tkami[u-i-1][j]=0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//for debug\n\t\t\t/*\n\t\t\tfor(int j=0;j<m*2;j++)\n\t\t\t{\n\t\t\t\tfor(int k=0;k<n*2;k++)\n\t\t\t\t\tcout<<kami[j][k]<<\" \";\n\t\t\t\tcout<<endl;\n\t\t\t}*/\n\t\t}\n\n\t\t//穴を開ける\n\t\tfor(int i=0;i<p;i++)\n\t\t\tcout<<kami[u+ana[i][1]][l+ana[i][0]]<<endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <unordered_map>\n#include <map>\n#include <set>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <bitset>\n#include <assert.h>\n#include <unordered_map>\n#include <fstream>\n#include <ctime>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<char> vc;\ntypedef vector<string> vs;\ntypedef vector<bool> vb;\ntypedef vector<double> vd;\ntypedef pair<ll,ll> P;\ntypedef pair<int,int> pii;\ntypedef vector<P> vpl;\ntypedef tuple<ll,ll,ll> tapu;\n#define rep(i,n) for(int i=0; i<(n); i++)\n#define REP(i,a,b) for(int i=(a); i<(b); i++)\n#define all(x) (x).begin(), (x).end()\n#define rall(x) (x).rbegin(), (x).rend()\nconst int inf = 1<<30;\nconst ll linf = 1LL<<62;\nconst int MAX = 510000;\nll dy[8] = {1,-1,0,0,1,-1,1,-1};\nll dx[8] = {0,0,1,-1,1,-1,-1,1};\nconst double pi = acos(-1);\nconst double eps = 1e-7;\ntemplate<typename T1,typename T2> inline bool chmin(T1 &a,T2 b){\n\tif(a>b){\n\t\ta = b; return true;\n\t}\n\telse return false;\n}\ntemplate<typename T1,typename T2> inline bool chmax(T1 &a,T2 b){\n\tif(a<b){\n\t\ta = b; return true;\n\t}\n\telse return false;\n}\ntemplate<typename T> inline void print(T &a){\n    rep(i,a.size()) cout << a[i] << \" \";\n    cout << \"\\n\";\n}\ntemplate<typename T1,typename T2> inline void print2(T1 a, T2 b){cout << a << \" \" << b << \"\\n\";}\ntemplate<typename T1,typename T2,typename T3> inline void print3(T1 a, T2 b, T3 c){\n\tcout << a << \" \" << b << \" \" << c << \"\\n\";\n}\nll pcount(ll x) {return __builtin_popcountll(x);}\nconst int mod = 1e9 + 7;\n//const int mod = 998244353;\n\nint a[800][800];\n\nint main(){\n\twhile(1){\n\t\tll w,h,t,p; cin >> w >> h >> t >> p;\n\t\tif(w+h+t+p == 0) break;\n\t\trep(i,h) rep(j,w) a[i][j] = 1;\n\t\tint l = 0, u = 0;\n\t\trep(z,t){\n\t\t\tint d,c; cin >> d >> c;\n\t\t\tif(d == 2){\n\t\t\t\tfor(int i=u; i<u+c; i++){\n\t\t\t\t\tREP(j,l,w+l){\n\t\t\t\t\t\ta[2*u+2*c-1-i][j] += a[i][j];\n\t\t\t\t\t\ta[i][j] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tu += c;\n\t\t\t}else{\n\t\t\t\tfor(int j=l; j<l+c; j++){\n\t\t\t\t\tREP(i,u,h+u){\n\t\t\t\t\t\ta[i][2*l+2*c-1-j] += a[i][j];\n\t\t\t\t\t\ta[i][j] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tl += c;\n\t\t\t}\n\t\t}\n\t\trep(i,p){\n\t\t\tint x,y; cin >> x >> y;\n\t\t\tcout << a[y+u][x+l] << \"\\n\";\n\t\t}\n\t\tREP(i,u,u+h) REP(j,l,l+w) a[i][j] = 0;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include<string>\n#include<cmath>\n#include<algorithm>\n#include<cctype>\n#include<queue>\n#include<deque>\n#include<regex>\n#include<stack>\n#include<stdio.h>\n#include<vector>\n#include<set>\n#include<map>\n#include<iomanip>\n\n#define rep(i, n) for(int i=0;i<n;i++)\n\ntypedef int long long ll;\nusing namespace std;\ntypedef pair<int, int> P;\nint dx[4] = {1, 0, -1, 0};\nint dy[4] = {0, 1, 0, -1};\nconst ll MOD = 1e9 + 7;\nstatic const int MAX = 100;\nstatic const int INF = (1 << 23);\n\nint main() {\nint n,m,t,p;\nwhile(true) {\n    cin >> n >> m >> t >> p;\n    if(n+m+t+p==0)break;\n    int ori[100][100];\n    rep(i,100){rep(j,100)ori[i][j]=0;}\n    rep(i,n){rep(j,m)ori[j][i]=1;}\n\n    int sx=0;\n    int sy=0;\n\n    rep(i,t){\n        int d,c;\n        cin>>d>>c;\n        if(d==1){\n            for(int y=sy;y<m;y++){\n                int xi=sx+c;\n                for(int x=(sx+c-1);x>=sx;x--){\n                    ori[y][xi]+=ori[y][x];\n                    ori[y][x]=0;\n                    xi++;\n                }\n            }\n            int presx=sx;\n            sx+=c;\n            if(n-presx-c<c){\n                int hami=presx+(2*c)-n;\n                for(int x=sx;x<n+hami;x++){\n                    for(int y=sy;y<m;y++){\n                        ori[y][x-hami]=ori[y][x];\n                    }\n                }\n                for(int x=n;x<n+hami;x++){\n                    for(int y=sy;y<m;y++){\n                        ori[y][x]=0;\n                    }\n                }\n                sx-=hami;\n            }\n\n\n        }else{\n            for(int x=sx;x<n;x++){\n                int yi=sy+c;\n                for(int y=(sy+c-1);y>=sy;y--){\n                    ori[yi][x]+=ori[y][x];\n                    ori[y][x]=0;\n                    yi++;\n                }\n            }\n            int presy=sy;\n            sy+=c;\n            if(m-presy-c<c){\n                int hami=presy+2*c-m;\n                for(int y=sy;y<m+hami;y++){\n                    for(int x=sx;x<n;x++){\n                        ori[y-hami][x]=ori[y][x];\n                    }\n                }\n                for(int y=m;y<m+hami;y++){\n                    for(int x=sx;x<n;x++){\n                        ori[y][x]=0;\n                    }\n                }\n                sy-=hami;\n            }\n        }\n//        for(int j=m-1;j>=0;j--) {\n//            for (int i = 0; i < n; i++) {\n//                cout << ori[j][i];\n//            }\n//            cout << endl;\n//        }\n//        cout<<sx<<\" \"<<sy<<endl;\n    }\n\n\n    rep(i,p){\n        int x,y;\n        cin>>x>>y;\n        cout<<ori[sy+y][sx+x]<<endl;\n    }\n\n}\n\n\n\n\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\nconst int OFS = 100;\nInt dp[111][111];\nvoid mvX(Int k){\n  for(Int i=0;i<111;i++)\n    for(Int j=0;j+k<111;j++)\n      dp[i][j]=dp[i][j+k];\n}\n\nvoid mvY(Int k){\n  for(Int j=0;j<111;j++)\n    for(Int i=110;i>=k;i--)\n      dp[i][j]=dp[i-k][j];\n}\n\n\nsigned main(){\n  Int w,h,t,p;\n  while(cin>>w>>h>>t>>p,w){\n    vector<Int> d(t),c(t);\n    for(Int i=0;i<t;i++) cin>>d[i]>>c[i];\n    vector<Int> x(p),y(p);\n    for(Int i=0;i<p;i++) cin>>x[i]>>y[i];\n    memset(dp,0,sizeof(dp));\n    for(Int i=0;i<h;i++)\n      for(Int j=0;j<w;j++)\n\tdp[OFS-i][j]=1;\n    \n    for(Int k=0;k<t;k++){\n      if(d[k]==1){\n\tfor(Int i=0;i<111;i++){\n\t  for(Int j=0;j<c[k];j++){\n\t    dp[i][c[k]*2-(j+1)]+=dp[i][j];\n\t    dp[i][j]=0;\n\t  }\n\t}\n\tmvX(c[k]);\n      }else{\n\tfor(Int j=0;j<111;j++){\n\t  for(Int i=0;i<c[k];i++){\n\t    dp[OFS-c[k]*2+(i+1)][j]+=dp[OFS-i][j];\n\t    dp[OFS-i][j]=0;\n\t  }\n\t}\n\tmvY(c[k]);\n      }\n      if(0){\n\tfor(int i=0;i<h;i++){\n\t  for(int j=0;j<w;j++){\n\t    cout<<dp[OFS-i][j];\n\t  }\n\t  cout<<endl;\n\t}\n\tcout<<endl;\n      }\n    }\n\n    for(Int i=0;i<p;i++)\n      cout<<dp[OFS-y[i]][x[i]]<<endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n \n#define MAX 500\n \nusing namespace std;\n\nint main(void){\n    while(1){\n        int kami[MAX][MAX]={0};\n\t\tint w, h, t, p;\n\t\tcin >> w >> h >> t >> p;\n        if(!w && !h && !t && !p) break;\n        for(int i=0; i<h; i++){\n\t\t\tfill(kami[i], kami[i]+w, 1);\n        }\n \n        int origin_x = 0, origin_y =0;\n        for(int k=0; k<t; k++){\n\t\t\tint d, c;\n\t\t\tcin >> d >> c;\n\t\t\t\n\t\t\tint dist = 1;\n            if(d == 1){\n\t\t\t\tfor(int j=origin_x+c; j<origin_x+(2*c); j++){\n                     for(int i=origin_y; i<MAX; i++){\n                        kami[i][j] += kami[i][j-dist];\n\t                }\n\t\t            dist += 2;\n\t\t\t    }\n                origin_x += c;\n            } else{\n                for(int i=origin_y+c; i<origin_y+(2*c); i++){\n                    for(int j=origin_x; j<MAX; j++){\n                        if(i-dist >= 0)kami[i][j] += kami[i-dist][j];\n                    }\n                    dist += 2;\n                }\n                origin_y += c;\n            }\n        }\n         \n        for(int k=0; k<p; k++){\n\t\t\tint x, y;\n\t\t\tcin >> x >> y;\n\t\t\tcout << kami[origin_y+y][origin_x+x] << endl;\n        }\n    }\n \n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//#include <bits/stdc++.h>\n//#include <stdio.h>\n#include<iostream>\n#include<cstdio>\n#include<bitset>\n#include<algorithm>\n#include<vector>\n#include<list>\n#include<queue>\n#include<stack>\n#include<string>\n#include<string.h>\n#include<cmath>\n#include<utility>\n#include<functional>\n#include<map>\n#include<set>\n#include<cctype>\n#include<fstream>\n \n \n#define FOR(i, a, b) for( int i=(a);i<=(b);i++)\n#define RFOR(i, a, b) for( int i=(a);i>=(b);i--)\n#define LFOR(i, a, b) for( long long int i=(a);i<=(b);i++)\n#define LRFOR(i, a, b) for(long long int i=(a);i>=(b);i--)\n#define MOD 1000000007\n#define INF 1000000000 //2000000000\n#define LINF 1000000000000000000 //9000000000000000000\n#define PI 3.14159265358979\n#define MAXI 7500000\n \nusing namespace std;\ntypedef long long int ll;\ntypedef pair< long long int, long long  int> P;\n \nint dy[5] = { 0,0,1,-1,0 };\nint dx[5] = { 1,-1,0,0,0 };\n \nint main(void){\n\n\t//ofstream ofs(\"./output\");\n\n\twhile(1){\n\t\tint n,m,t,p;\n\t\tint d[21],c[21];\n\t\tint x[21],y[21];\n\t\tint paper[70][70]={};//x,y\n\t\tint  count=0;\n\n\t\tFOR(i,0,69){\n\t\t\tFOR(j,0,69){\n\t\t\t\tpaper[i][j]=0;\n\t\t\t}\n\t\t}\n\n\t\tcin>>n>>m>>t>>p;\n\t\tif(n==0&&m==0&&t==0&&p==0){\n\t\t\tbreak;\n\t\t}\n\t\tFOR(i,1,t){\n\t\t\tcin>>d[i]>>c[i];\n\t\t}\n\t\tFOR(i,1,p){\n\t\t\tcin>>x[i]>>y[i];\n\t\t}\n\t\tFOR(i,0,n-1){\n\t\t\tFOR(j,0,m-1){\n\t\t\t\tpaper[i][j]=1;\n\t\t\t}\n\t\t}\n\n\t\tFOR(i,1,t){\n\t\t\tif(d[i]==1){\n\t\t\t\tFOR(j,1,c[i]){\n\t\t\t\t\tFOR(k,0,69){//y\n\t\t\t\t\t\tpaper[c[i]+(c[i]-j)][k]+=paper[j-1][k];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tFOR(j,c[i],c[i]+69){//x\n\t\t\t\t\tFOR(k,0,69){//y\n\t\t\t\t\tif(j>69){\n\t\t\t\t\t\tpaper[j-c[i]][k]=0;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tpaper[j-c[i]][k]=paper[j][k];\n\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\n\t\t\t}else{\n\t\t\t\tFOR(j,1,c[i]){\n\t\t\t\t\tFOR(k,0,69){//x\n\t\t\t\t\t\tpaper[k][c[i]+(c[i]-j)]+=paper[k][j-1];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tFOR(j,c[i],c[i]+69){//y\n\t\t\t\t\tFOR(k,0,69){//x\n\t\t\t\t\t\tif(j>69){\n\t\t\t\t\t\t\tpaper[k][j-c[i]]=0;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tpaper[k][j-c[i]]=paper[k][j];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t/*if(i<=5){\n\t\t\t\tRFOR(r,69,0){\n\t\t\t\t\tFOR(s,0,69){\n\t\t\t\t\t\tcout<<paper[s][r]<<\"\";\n\t\t\t\t\t}\n\t\t\t\t\tcout<<endl;\n\t\t\t\t}\n\t\t\tcout<<endl;\n\t\t\t}*/\n\t\t\t\n\n\t\t}\n\n\t\tFOR(i,1,p){\n\t\t\tcout<<paper[x[i]][y[i]]<<endl;\n\t\t\t//ofs<<paper[x[i]][y[i]]<<endl;\n\t\t}\n\n\t\t/*RFOR(r,69,0){\n\t\t\tFOR(s,0,69){\n\t\t\t\tcout<<paper[s][r]<<\"\";\n\t\t\t}\n\t\t\tcout<<endl;\n\t\t}*/\n\n\n\t\t\n\t}\n\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define ALL(x) x.begin(),x.end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define debug(v) cout<<#v<<\":\";for(auto x:v){cout<<x<<' ';}cout<<endl;\n#define INF 1000000000\n#define mod 1000000007\nusing ll=long long;\nconst ll LINF=1001002003004005006ll;\nint dx[]={1,0,-1,0};\nint dy[]={0,1,0,-1};\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\ntemplate<class T>bool chmax(T &a,const T &b){if(a<b){a=b;return true;}return false;}\ntemplate<class T>bool chmin(T &a,const T &b){if(b<a){a=b;return true;}return false;}\n\nint n,m,t,p;\n\nvoid solve(){\n    int h=m,w=n;\n    int g[h][w];\n    rep(i,h)rep(j,w) g[i][j]=1;\n    rep(_,t){\n        int d,c;cin>>d>>c;\n        int new_g[h][w]={};\n        if(d==1){\n            rep(i,h){\n                for(int j=0;j<c;j++){\n                    new_g[i][j]=g[i][c-1-j]+(c+j<w?g[i][c+j]:0);\n                }\n                for(int j=c;j<w-c;j++){\n                    new_g[i][j]=(j+c<w?g[i][j+c]:0);\n                }\n            }\n        }\n        else{\n            // c=h-c;\n            rep(j,w){\n                for(int i=0;i<c;i++){\n                    new_g[i][j]=g[c-1-i][j]+(c+i<h?g[c+i][j]:0);\n                }\n                for(int i=c;i<h-c;i++){\n                    new_g[i][j]=(i+c<h?g[i+c][j]:0);\n                }\n            }\n        }\n        rep(i,h){\n            rep(j,w){\n                g[i][j]=new_g[i][j];\n            }\n        }\n    }\n\n    // cout<<\"debug=-begin\"<<endl;\n    // rep(i,h){\n    //     rep(j,w){\n    //         cout<<g[i][j]<<\"  \";\n    //     }cout<<endl;\n    // }\n    // cout<<\"debug---end\"<<endl;\n\n    // int geta=0;\n    // while(g[h-1-geta][0]==0) geta++;\n    rep(_,p){\n        int x,y;cin>>x>>y;\n        cout<<g[y][x]<<endl;\n    }\n    // cout<<n<<m<<t<<p<<endl;\n}\n\nsigned main(){\n    cin.tie(0);\n    ios::sync_with_stdio(0);\n    \n    while(true){\n        cin>>n>>m>>t>>p;\n        solve();\n        if(n==0 and m==0 and t==0 and p==0) return 0;\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#ifdef __GNUC__\n#include <bits/stdc++.h>\n#else\n#define _CRT_SECURE_NO_WARNINGS\n#include <__msvc_all_public_headers.hpp>\n#undef min\n#undef max\n#endif\n#define rep(i, n) for (int i = 0; i < (n); ++i)\n#define FOR(i, m, n) for (int i = (m); i < (n); ++i)\n#define rrep(i, n) for (int i = (n) - 1; i >= 0; --i)\n#define rfor(i, m, n) for (int i = (m); i >= (n); --i)\n#define sz(x) ((int)(x).size())\n#define all(x) (x).begin(),(x).end()\n#define rall(x) (x).rbegin(),(x).rend()\n#define range_it(a, l, r) (a).begin() + (l), (a).begin() + (r)\n\nusing namespace std;\nusing ll = long long;\t\tusing ld = long double;\nusing VB = vector<bool>;\tusing VVB = vector<VB>;\nusing VI = vector<int>;\t\tusing VVI = vector<VI>;\nusing VL = vector<ll>;\t\tusing VVL = vector<VL>;\nusing VS = vector<string>;\tusing VD = vector<ld>;\nusing PII = pair<int, int>;\tusing VP = vector<PII>;\nusing PLL = pair<ll, ll>;\tusing VPL = vector<PLL>;\ntemplate<class T>using PQ = priority_queue<T>;\ntemplate<class T>using PQS = priority_queue<T, vector<T>, greater<T>>;\nconstexpr int inf = (int)1e9;\nconstexpr ll inf_ll = (ll)1e18, MOD = 1000000007;\nconstexpr ld PI = M_PI, EPS = 1e-12;\n\n// --- input --- //\n#ifdef _WIN32\n#define getchar_unlocked _getchar_nolock\n#define putchar_unlocked _putchar_nolock\n#define fwrite_unlocked _fwrite_nolock\n#define fflush_unlocked _fflush_nolock\n#endif\ninline int gc() { return getchar_unlocked(); }\ntemplate<class T>inline void InputF(T& v) { cin >> v; }\ninline void InputF(char& v) { while (isspace(v = gc())); }\ninline void InputF(bool& v) { char c; InputF(c); v = c != '0'; }\ninline void InputF(string& v) {\n\tchar c; for (InputF(c); !isspace(c); c = gc())v += c;\n}\ninline void InputF(int& v) {\n\tbool neg = false; v = 0; char c; InputF(c);\n\tif (c == '-') { neg = true; c = gc(); }\n\tfor (; isdigit(c); c = gc())v = v * 10 + (c - '0');\n\tif (neg)v = -v;\n}\ninline void InputF(long long& v) {\n\tbool neg = false; v = 0; char c; InputF(c);\n\tif (c == '-') { neg = true; c = gc(); }\n\tfor (; isdigit(c); c = gc())v = v * 10 + (c - '0');\n\tif (neg)v = -v;\n}\ninline void InputF(double& v) {\n\tdouble dp = 1; bool neg = false, adp = false; v = 0; char c; InputF(c);\n\tif (c == '-') { neg = true; c = gc(); }\n\tfor (; isdigit(c) || c == '.'; c = gc()) {\n\t\tif (c == '.')adp = true;\n\t\telse if (adp)v += (c - '0') * (dp *= 0.1);\n\t\telse v = v * 10 + (c - '0');\n\t}\n\tif (neg)v = -v;\n}\ntemplate<class T, class U>inline void InputF(pair<T, U>& v) {\n\tInputF(v.first); InputF(v.second);\n}\ntemplate<class T>inline void InputF(vector<T>& v) {\n\tfor (auto& e : v)InputF(e);\n}\ntemplate<class T>inline T InputF() { T v; InputF(v); return v; }\ninline string GetLine() {\n\tstring v; char c; for (InputF(c); c != '\\n' && c != '\\0'; c = gc())v += c; return v;\n}\nstruct InputV {\n\tint n, m;\n\tInputV(int N) :n(N), m(0) {}\n\tInputV(pair<int, int> N) :n(N.first), m(N.second) {}\n\ttemplate<class T>operator vector<T>() {\n\t\tvector<T> v(n); InputF(v); return v;\n\t}\n\ttemplate<class T>operator vector<vector<T>>() {\n\t\tvector<vector<T>> v(n, vector<T>(m)); InputF(v); return v;\n\t}\n};\nstruct Input {\n\ttemplate<class T>operator T() { return InputF<T>(); }\n\tint operator--(int) { int v; InputF(v); v--; return v; }\n\tInputV operator[](int n) { return InputV(n); }\n\tInputV operator[](pair<int, int> n) { return InputV(n); }\n\tvoid operator()() {}\n\ttemplate<class H, class...T>void operator()(H&& h, T&& ...t) {\n\t\tInputF(h); operator()(forward<T>(t)...);\n\t}\n\ttemplate<class T>Input& operator,(T&& v) {\n\t\tInputF(v); return *this;\n\t}\n}in;\n#define input(T) InputF<T>()\n#define ini input(int)\n#define inl input(ll)\n#define ins input(string)\n#define inputs(T, ...) T __VA_ARGS__; in(__VA_ARGS__)\n#define INT(...) inputs(int, __VA_ARGS__)\n#define LL(...) inputs(ll, __VA_ARGS__)\n#define STR(...) inputs(string, __VA_ARGS__)\n\n// --- output --- //\nstruct BoolStr {\n\tconst char* t, * f; BoolStr(const char* _t, const char* _f) :t(_t), f(_f) {}\n}Yes(\"Yes\", \"No\"), yes(\"yes\", \"no\"), YES(\"YES\", \"NO\"), Int(\"1\", \"0\");\nstruct DivStr {\n\tconst char* d, * l; DivStr(const char* _d, const char* _l) :d(_d), l(_l) {}\n}spc(\" \", \"\\n\"), no_spc(\"\", \"\\n\"), end_line(\"\\n\", \"\\n\"), comma(\",\", \"\\n\"), no_endl(\" \", \"\");\nclass Output {\n\tBoolStr B{ Yes }; DivStr D{ spc };\n\tvoid p(int v) {\n\t\tif (v < 0)putchar_unlocked('-'), v = -v;\n\t\tchar b[10]; int i = 0;\n\t\twhile (v)b[i++] = '0' + v % 10, v /= 10;\n\t\tif (!i)b[i++] = '0';\n\t\twhile (i--)putchar_unlocked(b[i]);\n\t}\n\tvoid p(ll v) {\n\t\tif (v < 0)putchar_unlocked('-'), v = -v;\n\t\tchar b[20]; int i = 0;\n\t\twhile (v)b[i++] = '0' + v % 10, v /= 10;\n\t\tif (!i)b[i++] = '0';\n\t\twhile (i--)putchar_unlocked(b[i]);\n\t}\n\tvoid p(bool v) { p(v ? B.t : B.f); }\n\tvoid p(char v) { putchar_unlocked(v); }\n\tvoid p(const char* v) { fwrite_unlocked(v, 1, strlen(v), stdout); }\n\tvoid p(double v) { printf(\"%.20f\", v); }\n\tvoid p(ld v) { printf(\"%.20Lf\", v); }\n\ttemplate<class T> void p(const T& v) { cout << v; }\n\ttemplate<class T, class U>void p(const pair<T, U>& v) { p(v.first); p(D.d); p(v.second); }\n\ttemplate<class T>void p(const vector<T>& v) { rep(i, sz(v)) { if (i)p(D.d); p(v[i]); } }\n\ttemplate<class T>void p(const vector<vector<T>>& v) { rep(i, sz(v)) { if (i)p(D.l); p(v[i]); } }\npublic:\n\tOutput& operator()() { p(D.l); return *this; }\n\ttemplate<class H>Output& operator()(H&& h) { p(h); p(D.l); return *this; }\n\ttemplate<class H, class...T>Output& operator()(H&& h, T&& ...t) {\n\t\tp(h); p(D.d); return operator()(forward<T>(t)...);\n\t}\n\ttemplate<class...T>void exit(T&& ...t) { operator()(forward<T>(t)...); std::exit(EXIT_SUCCESS); }\n\tOutput& flush() { fflush_unlocked(stdout); return *this; }\n\tOutput& set(const BoolStr& b) { B = b; return *this; }\n\tOutput& set(const DivStr& d) { D = d; return *this; }\n\tOutput& set(const char* t, const char* f) { B = BoolStr(t, f); return *this; }\n}out;\n\n// --- step --- //\ntemplate<class T>struct Step {\n\tclass It {\n\t\tT a, b, c;\n\tpublic:\n\t\tconstexpr It() : a(T()), b(T()), c(T()) {}\n\t\tconstexpr It(T _b, T _c, T _s) : a(_b), b(_c), c(_s) {}\n\t\tconstexpr It& operator++() { --b; a += c; return *this; }\n\t\tconstexpr It operator++(int) { It tmp = *this; --b; a += c; return tmp; }\n\t\tconstexpr const T& operator*()const { return a; }\n\t\tconstexpr const T* operator->()const { return &a; }\n\t\tconstexpr bool operator==(const It& i)const { return b == i.b; }\n\t\tconstexpr bool operator!=(const It& i)const { return !(b == i.b); }\n\t\tconstexpr T start()const { return a; }\n\t\tconstexpr T count()const { return b; }\n\t\tconstexpr T step()const { return c; }\n\t};\n\tconstexpr Step(T b, T c, T s) : be(b, c, s) {}\n\tconstexpr It begin()const { return be; }\n\tconstexpr It end()const { return en; }\n\tconstexpr T start()const { return be.start(); }\n\tconstexpr T count()const { return be.count(); }\n\tconstexpr T step()const { return be.step(); }\n\tconstexpr T sum()const { return start() * count() + step() * (count() * (count() - 1) / 2); }\n\toperator vector<T>()const { return as_vector(); }\n\tvector<T> as_vector()const {\n\t\tvector<T> res; res.reserve(count()); each([&](T i) {res.push_back(i); }); return res;\n\t}\n\ttemplate<class F>void each(const F& f)const { for (T i : *this)f(i); }\n\ttemplate<class F>auto map(const F& f)const {\n\t\tvector<decay_t<result_of_t<F(T)>>> res; res.reserve(count());\n\t\teach([&](T i) {res.push_back(f(i)); }); return res;\n\t}\n\ttemplate<class F>int count_if(const F& f)const {\n\t\tint res = 0; each([&](T i) {res += static_cast<bool>(f(i)); }); return res;\n\t}\n\ttemplate<class F>vector<T> select(const F& f)const {\n\t\tvector<T> res; each([&](T i) {if (f(i))res.push_back(i); }); return res;\n\t}\n\ttemplate<class F>auto max(const F& f)const {\n\t\tauto v = map(f); return *max_element(v.begin(), v.end());\n\t}\n\ttemplate<class F>auto min(const F& f)const {\n\t\tauto v = map(f); return *min_element(v.begin(), v.end());\n\t}\n\ttemplate<class F, class U = decay_t<result_of_t<F(T)>>>auto sum(const F& f)const {\n\t\tU res = 0; each([&](T i) {res += static_cast<U>(f(i)); }); return res;\n\t}\n\tusing value_type = T;\n\tusing iterator = It;\nprivate:\n\tIt be, en;\n};\ntemplate<class T>inline constexpr auto step(T a) { return Step<T>(0, a, 1); }\ntemplate<class T>inline constexpr auto step(T a, T b) { return Step<T>(a, b - a, 1); }\ntemplate<class T>inline constexpr auto step(T a, T b, T c) { return Step<T>(a, a < b ? (b - a - 1) / c + 1 : 0, c); }\n\n// --- functions --- //\ninline namespace {\n\ttemplate<class T>inline void Sort(T& a) { sort(all(a)); }\n\ttemplate<class T>inline void RSort(T& a) { sort(rall(a)); }\n\ttemplate<class T>inline T Sorted(T a) { Sort(a); return a; }\n\ttemplate<class T>inline T RSorted(T a) { RSort(a); return a; }\n\ttemplate<class T, class F>inline void Sort(T& a, const F& f) {\n\t\tsort(all(a), [&](const auto& x, const auto& y) {return f(x) < f(y); });\n\t}\n\ttemplate<class T, class F>inline void RSort(T& a, const F& f) {\n\t\tsort(rall(a), [&](const auto& x, const auto& y) {return f(x) < f(y); });\n\t}\n\ttemplate<class T>inline void Reverse(T& a) { reverse(all(a)); }\n\ttemplate<class T>inline void Unique(T& a) { a.erase(unique(all(a)), a.end()); }\n\ttemplate<class T>inline void Rotate(T& a, int left) { rotate(a.begin(), a.begin() + left, a.end()); }\n\ttemplate<class T>inline T Reversed(T a) { Reverse(a); return a; }\n\ttemplate<class T>inline T Uniqued(T a) { Unique(a); return a; }\n\ttemplate<class T>inline T Rotated(T a, int left) { Rotate(a, left); return a; }\n\ttemplate<class T>inline auto Max(const T& a) { return *max_element(all(a)); }\n\ttemplate<class T>inline auto Min(const T& a) { return *min_element(all(a)); }\n\ttemplate<class T>inline int MaxPos(const T& a) { return max_element(all(a)) - a.begin(); }\n\ttemplate<class T>inline int MinPos(const T& a) { return min_element(all(a)) - a.begin(); }\n\ttemplate<class T, class F>inline auto Max(const T& a, const F& f) {\n\t\treturn *max_element(all(a), [&](const auto& x, const auto& y) {return f(x) < f(y); });\n\t}\n\ttemplate<class T, class F>inline auto Min(const T& a, const F& f) {\n\t\treturn *min_element(all(a), [&](const auto& x, const auto& y) {return f(x) < f(y); });\n\t}\n\ttemplate<class T, class U>inline int Count(const T& a, const U& v) { return count(all(a), v); }\n\ttemplate<class T, class F>inline int CountIf(const T& a, const F& f) { return count_if(all(a), f); }\n\ttemplate<class T, class U>inline int Find(const T& a, const U& v) { return find(all(a), v) - a.begin(); }\n\ttemplate<class T, class F>inline int FindIf(const T& a, const F& f) { return find_if(all(a), f) - a.begin(); }\n\ttemplate<class T, class U = typename T::value_type>inline U Sum(const T& a) { return accumulate(all(a), U()); }\n\ttemplate<class T, class F>inline auto Sum(const T& v, const F& f) {\n\t\treturn accumulate(next(v.begin()), v.end(), f(v.front()), [&](auto a, auto b) {return a + f(b); });\n\t}\n\ttemplate<class T, class U>inline int Lower(const T& a, const U& v) { return lower_bound(all(a), v) - a.begin(); }\n\ttemplate<class T, class U>inline int Upper(const T& a, const U& v) { return upper_bound(all(a), v) - a.begin(); }\n\ttemplate<class T, class F>inline void RemoveIf(T& a, const F& f) { a.erase(remove_if(all(a), f), a.end()); }\n\ttemplate<class F>inline auto Vector(size_t size, const F& f) {\n\t\tvector<decay_t<result_of_t<F(size_t)>>> res(size); for (size_t i = 0; i < size; ++i)res[i] = f(i); return res;\n\t}\n\ttemplate<class T>inline auto Grid(size_t h, size_t w, const T& v = T()) { return vector<vector<T>>(h, vector<T>(w, v)); }\n\ttemplate<class T>inline auto Slice(const T& v, size_t i, size_t len) {\n\t\treturn i < v.size() ? T(v.begin() + i, v.begin() + min(i + len, v.size())) : T();\n\t}\n\ttemplate<class T, class F>inline auto Each(const T& v, const F& f) { for (auto& i : v)f(i); }\n\ttemplate<class T, class F>inline auto Select(const T& v, const F& f) {\n\t\tT res; for (const auto& e : v)if (f(e))res.push_back(e); return res;\n\t}\n\ttemplate<class T, class F>inline auto Map(const T& v, const F& f) {\n\t\tvector<decay_t<result_of_t<F(typename T::value_type)>>> res(v.size());\n\t\tsize_t i = 0; for (const auto& e : v)res[i++] = f(e); return res;\n\t}\n\ttemplate<class T, class F>inline auto MapIndex(const T& v, const F& f) {\n\t\tvector<decay_t<result_of_t<F(size_t, typename T::value_type)>>> res(v.size());\n\t\tsize_t i = 0; for (auto it = v.begin(); it != v.end(); ++it, ++i)res[i] = f(i, *it); return res;\n\t}\n\ttemplate<class T, class F>inline auto TrueIndex(const T& v, const F& f) {\n\t\tvector<size_t> res; for (size_t i = 0; i < v.size(); ++i)if (f(v[i]))res.push_back(i); return res;\n\t}\n\tinline string operator*(string s, size_t n) { string ret; for (size_t i = 0; i < n; ++i)ret += s; return ret; }\n\ttemplate<class T>inline T Ceil(T n, T m) { return (n + m - 1) / m; }\n\ttemplate<class T>inline T Ceil2(T n, T m) { return Ceil(n, m) * m; }\n\ttemplate<class T>inline T Tri(T n) { return (n & 1) ? (n + 1) / 2 * n : n / 2 * (n + 1); }\n\ttemplate<class T>inline T nC2(T n) { return (n & 1) ? (n - 1) / 2 * n : n / 2 * (n - 1); }\n\ttemplate<class T>inline T Mid(const T& l, const T& r) { return l + (r - l) / 2; }\n\tinline int pop_count(int n) { return bitset<32>(n).count(); }\n\tinline int pop_count(ll n) { return bitset<64>(n).count(); }\n\ttemplate<class T>inline bool chmax(T& a, const T& b) { if (a < b) { a = b; return true; } return false; }\n\ttemplate<class T>inline bool chmin(T& a, const T& b) { if (a > b) { a = b; return true; } return false; }\n\ttemplate<class T>inline bool inRange(const T& v, const T& min, const T& max) { return min <= v && v < max; }\n\ttemplate<class T = ll>inline T BIT(int b) { return T(1) << b; }\n\ttemplate<class T>inline T Gcd(T n, T m) { return m ? Gcd(m, n % m) : n; }\n\ttemplate<class T>inline T Lcm(T n, T m) { return n / Gcd(n, m) * m; }\n\ttemplate<class T, class U = typename T::value_type>inline U Gcdv(const T& v) {\n\t\treturn accumulate(next(v.begin()), v.end(), U(*v.begin()), Gcd<U>);\n\t}\n\ttemplate<class T, class U = typename T::value_type>inline U Lcmv(const T& v) {\n\t\treturn accumulate(next(v.begin()), v.end(), U(*v.begin()), Lcm<U>);\n\t}\n\ttemplate<class T>inline T Pow(T a, T n) { T r = 1; while (n > 0) { if (n & 1)r *= a; a *= a; n /= 2; } return r; }\n\ttemplate<class T>inline T Powmod(T a, T n, T m = MOD) {\n\t\tT r = 1; while (n > 0) { if (n & 1)r = r * a % m, n--; else a = a * a % m, n /= 2; }return r;\n\t}\n}\n\n// --- dump --- //\n#if __has_include(\"dump.hpp\")\n#include \"dump.hpp\"\n#else\n#define dump(...) ((void)0)\n#endif\n\n// ---------------------------------------------------------------- //\n\nVVL fold_suityoku(const VVL& a, int c) {\n\tint h = sz(a), w = sz(a[0]);\n\tint W = max(w - c, c);\n\n\tauto res = Grid<ll>(h, W);\n\trep(i, h)rep(j, w) {\n\t\tif (j < c) {\n\t\t\tres[i][c - 1 - j] += a[i][j];\n\t\t} else {\n\t\t\tres[i][j - c] += a[i][j];\n\t\t}\n\t}\n\treturn res;\n}\nVVL fold_suihei(const VVL& a, int c) {\n\tint h = sz(a), w = sz(a[0]);\n\tint H = max(h - c, c);\n\n\tauto res = Grid<ll>(H, w);\n\trep(i, h)rep(j, w) {\n\t\tif (i < c) {\n\t\t\tres[c - 1 - i][j] += a[i][j];\n\t\t} else {\n\t\t\tres[i - c][j] += a[i][j];\n\t\t}\n\t}\n\treturn res;\n}\n\nint main() {\n\tfor (int w = in, h = in, t = in, p = in; w + h + t + p; in(w, h, t, p)) {\n\t\tauto cnt = Grid<ll>(h, w, 1);\n\t\trep(i, t) {\n\t\t\tINT(d, c);\n\t\t\tif (d == 2) {\n\t\t\t\tcnt = fold_suihei(cnt, c);\n\t\t\t} else {\n\t\t\t\tcnt = fold_suityoku(cnt, c);\n\t\t\t}\n\t\t}\n\t\tdump(cnt);\n\t\trep(i, p) {\n\t\t\tINT(x, y);\n\t\t\tout(cnt[y][x]);\n\t\t}\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint s[65][65];\n\nvoid func1(int c, int m){\n  for(int i=0; i<c; i++){\n      for(int j=0; j<m; j++){\n          s[2*c-1-i][j] += s[i][j];\n      }\n  }\n\n}\n\nvoid func2(int c, int n){\n    for(int i=0; i<c; i++){\n      for(int j=0; j<n; j++){\n          s[j][2*c-1-i] += s[j][i];\n      }\n    }\n}\n\nvoid func3(int c, int n, int m){\n    for(int i=0; i<n; i++){\n        for(int j=0; j<m; j++){\n            s[i][j] = s[i+c][j];\n        }\n    }\n\n    for(int i=0; i<c; i++){\n        for(int j=0; j<m; j++){\n            s[n+i][j] = 0;\n        }\n    }\n}\n\nvoid func4(int c, int n, int m){\n    for(int i=0; i<n; i++){\n        for(int j=0; j<m; j++){\n            s[i][j] = s[i][j+c];\n        }\n    }\n    for(int i=0; i<n; i++){\n        for(int j=0; j<c; j++){\n            s[i][m+j] = 0;\n        }\n    }\n}\n\n\nint main(){\n    for(int i=0; i<65; i++){\n        for(int j=0; j<65; j++){\n            s[i][j] = 0;\n        }\n    }\n    while(1){\n        int n,m,t,p;\n        cin>>n>>m>>t>>p;\n        if(n == 0 && m == 0 && t == 0 && p == 0){\n            break;\n        }\n\n        for(int i=0; i<n; i++){\n            for(int j=0; j<m; j++){\n                s[i][j] = 1;\n            }\n        }\n\n        int d;\n        int c;\n        for(int i=0; i<t; i++){\n            cin>>d>>c;\n            switch(d){\n                case 1:{\n                    if(n < 2*c)  n += 2*c-n;\n                    func1(c, m);\n                    n -= c;\n                    func3(c, n, m);\n                    break;\n                }\n                case 2:{\n                    if(m < 2*c)  m += 2*c-m;\n                    func2(c, n);\n                    m -= c;\n                    func4(c, n, m);\n                    break;\n                }\n            }\n        }\n\n        int x[p];\n        int y[p];\n        int cnt = 0;\n        for(int i=0; i<p; i++){\n            cin>>x[i]>>y[i];\n        }\n\n        for(int i=0; i<p; i++){\n            cout << s[x[i]][y[i]] <<endl;\n        }\n\n        for(int i=0; i<65; i++){\n            for(int j=0; j<65; j++){\n                s[i][j] = 0;\n            }\n        }\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\n// #define int ll\nusing PII = pair<ll, ll>;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n\ntemplate<typename T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<typename T> T &chmax(T &a, const T &b) { return a = max(a, b); }\ntemplate<typename T> bool IN(T a, T b, T x) { return a<=x&&x<b; }\ntemplate<typename T> T ceil(T a, T b) { return a/b + !!(a%b); }\n\ntemplate<typename T> vector<T> make_v(size_t a) { return vector<T>(a); }\ntemplate<typename T,typename... Ts>\nauto make_v(size_t a,Ts... ts) {\n    return vector<decltype(make_v<T>(ts...))>(a,make_v<T>(ts...));\n}\ntemplate<typename T,typename V> typename enable_if<is_class<T>::value==0>::type\nfill_v(T &t, const V &v) { t=v; }\ntemplate<typename T,typename V> typename enable_if<is_class<T>::value!=0>::type\nfill_v(T &t, const V &v ) { for(auto &e:t) fill_v(e,v); }\n\ntemplate<class S,class T>\nostream &operator <<(ostream& out,const pair<S,T>& a) {\n    out<<'('<<a.first<<','<<a.second<<')'; return out;\n}\ntemplate<class T>\nostream &operator <<(ostream& out,const vector<T>& a){\n    out<<'[';\n    for(const T &i: a) out<<i<<',';\n    out<<']';\n    return out;\n}\ntemplate<class T>\nostream &operator <<(ostream& out, const set<T>& a) {\n    out<<'{';\n    for(const T &i: a) out<<i<<',';\n    out<<'}';\n    return out;\n}\ntemplate<class T, class S>\nostream &operator <<(ostream& out, const map<T,S>& a) {\n    out<<'{';\n    for(auto &i: a) out<<i<<',';\n    out<<'}';\n    return out;\n}\n\nint dx[] = {0, 1, 0, -1}, dy[] = {1, 0, -1, 0}; // DRUL\nconst int INF = 1<<30;\nconst ll LLINF = 1LL<<60;\nconst ll MOD = 1000000007;\n\nsigned main(void)\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while(1) {\n        ll w, h, t, p;\n        cin >> w >> h >> t >> p;\n        if(!w) break;\n\n        vector<vector<ll>> v(2*h, vector<ll>(2*w));\n        REP(i, h) REP(j, w) v[i][j] = 1;\n        // REP(i, h) cout << v[i] << endl;\n        REP(i, t) {\n            ll d, c;\n            cin >> d >> c;\n            if(d == 1) {\n                REP(i, h) FOR(j, c, 2*c) {\n                    v[i][j] += v[i][2*c-1-j];\n                }\n                REP(i, h) REP(j, 2*w-c) {\n                    v[i][j] = v[i][j+c];\n                }\n                REP(i, h) FOR(j, 2*w-c, 2*w) {\n                    v[i][j] = 0;\n                }\n            } else {\n                REP(i, w) FOR(j, c, 2*c) {\n                    v[j][i] += v[2*c-1-j][i];\n                }\n                REP(i, w) REP(j, 2*h-c) {\n                    v[j][i] = v[j+c][i];\n                }\n                REP(i, w) FOR(j, 2*h-c, 2*h) {\n                    v[j][i] = 0;\n                }\n            }\n\n            // REP(i, h) cout << v[i] << endl;\n        }\n\n        REP(i, p) {\n            ll x, y;\n            cin >> x >> y;\n            cout << v[y][x] << endl;\n        }\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  int n, m, t, p;\n  while (cin >> n >> m >> t >> p, n) {\n    vector<pair<int, int>> d(t), x(p);\n    for (auto &e : d) cin >> e.first >> e.second;\n    for (auto &e : x) cin >> e.first >> e.second;\n\n    vector<vector<int>> a((t + 1) * m, vector<int>((t + 1) * n));\n    for (int i = 0; i < m; i++) {\n      for (int j = 0; j < n; j++) {\n        a[i][j] = 1;\n      }\n    }\n    int x0 = 0, y0 = 0;\n    for (auto e : d) {\n      if (e.first == 1) {\n        x0 += e.second;\n        for (int i = 0; a[y0 + i][x0]; i++) {\n          for (int j = 0; x0 - j - 1 >= 0 && (a[y0 + i][x0 + j] || a[y0 + i][x0 - j - 1]); j++) {\n            a[y0 + i][x0 + j] += a[y0 + i][x0 - j - 1];\n            a[y0 + i][x0 - j - 1] = 0;\n          }\n        }\n      } else {\n        y0 += e.second;\n        for (int j = 0; a[y0][x0 + j]; j++) {\n          for (int i = 0; y0 - i - 1 >= 0 && (a[y0 + i][x0 + j] || a[y0 - i - 1][x0 + j]); i++) {\n            a[y0 + i][x0 + j] += a[y0 - i - 1][x0 + j];\n            a[y0 - i - 1][x0 + j] = 0;\n          }\n        }\n      }\n    }\n\n    for (auto e : x) {\n      cout << a[y0 + e.second][x0 + e.first] << endl;\n    }\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define fi first\n#define se second\n#define show(x) cerr << #x << \"=\" << \"\\n\"\ntypedef long long ll;\ntypedef unsigned long long ull;\n\nusing namespace std;\n\nint main() {\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  cout.precision(10);\n  cout << fixed;\n#ifdef LOCAL_DEFINE\n  FILE *stream1;\n  //FILE *stream2;\n  stream1 = freopen(\"in.txt\", \"r\", stdin);\n  //stream2 = freopen(\"out.txt\", \"w\", stdout);\n  if (stream1 == NULL) return 0;\n  //if (stream2 == NULL) return 0;\n#endif\n  int hh, w, t, p;\n  while (cin >> w >> hh >> t >> p, w) {\n    int res[40][40];\n    for (int i = 0; i < 40; i++) for (int j = 0; j < 40; j++) res[i][j] = 0;\n    for (int i = 0; i < hh; i++) for (int j = 0; j < w; j++) res[i][j] = 1;\n    for (int ii = 0; ii < t; ii++) {\n      int d, c; cin >> d >> c;\n      int tmp[40][40];\n      for (int i = 0; i < 40; i++) for (int j = 0; j < 40; j++) tmp[i][j] = 0;\n      if (d == 1) {\n        // d == 1\n        for (int i = 0; i < 40; i++) {\n          for (int j = c; j < 40; j++) {\n            tmp[i][j - c] += res[i][j];\n          }\n        }\n        for (int i = 0; i < 40; i++) {\n          for (int j = c - 1; j >= 0; j--) {\n            tmp[i][c - 1 - j] += res[i][j];\n          }\n        }\n      } else {\n        // d == 2\n        int h = 0;\n        for (int i = 0; i < 40; i++) {\n          if (res[i][0] != 0) h++;\n        }\n        if (c >= h - c) {\n          for (int i = h - 1; i >= h - c; i--) {\n            for (int j = 0; j < 40; j++) {\n              tmp[h - 1 - i][j] += res[i][j];\n            }\n          }\n          for (int i = 0; i < h - c; i++) {\n            for (int j = 0; j < 40; j++) {\n              tmp[i + 2 * c - h][j] += res[i][j];\n            }\n          }\n        } else {\n          for (int i = 0; i < h - c; i++) {\n            for (int j = 0; j < 40; j++) {\n              tmp[i][j] += res[i][j];\n            }\n          }\n          int now = c;\n          for (int i = h - 1; i >= h - c; i--) {\n            for (int j = 0; j < 40; j++) {\n              tmp[i - 2 * now + 1][j] += res[i][j];\n            }\n            now--;\n          }\n        }\n      }\n      //tmp -> res\n      for (int i = 0; i < 40; i++) {\n        for (int j = 0; j < 40; j++) {\n          res[i][j] = tmp[i][j];\n        }\n      }\n      // for (int i = 0; i < 10; i++) {\n      //   for (int j = 0; j < 10; j++) {\n      //     cerr << res[i][j];\n      //   }\n      //   cerr << endl;\n      // }\n    }\n    // ans\n    int hlen = 0;\n    for (int i = 0; i < 40; i++) {\n      if (res[i][0] != 0) hlen++;\n    }\n    for (int i = 0; i < p; i++) {\n      int x, y; cin >> x >> y;\n      cout << res[hlen - 1 - y][x] << endl;\n    }\n  }\n#ifdef LOCAL_DEFINE\n  cerr << \"Time elapsed: \" << 1.0 * clock() / CLOCKS_PER_SEC << \"s.\\n\";\n  fclose(stream1);\n  //fclose(stream2);\n#endif\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define fi first\n#define se second\n#define show(x) cerr << #x << \"=\" << \"\\n\"\ntypedef long long ll;\ntypedef unsigned long long ull;\n\nusing namespace std;\n\nint n, m, t, p;\n\nint main() {\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  cout.precision(10);\n  cout << fixed;\n#ifdef LOCAL_DEFINE\n  FILE *stream1;\n  //FILE *stream2;\n  stream1 = freopen(\"in.txt\", \"r\", stdin);\n  //stream2 = freopen(\"out.txt\", \"w\", stdout);\n  if (stream1 == NULL) return 0;\n  //if (stream2 == NULL) return 0;\n#endif\n  while (cin >> n >> m >> t >> p, n) {\n    int past[40][40];\n    for (int i = 0; i < 40; i++) {\n      for (int j = 0; j < 40; j++) {\n        past[i][j] = 0;\n      }\n    }\n    for (int i = 0; i < m; i++) {\n      for (int j = 0; j < n; j++) {\n        past[i][j] = 1;\n      }\n    }\n    for (int i = 0; i < t; i++) {\n      int d, c; cin >> d >> c;\n      int nw[40][40];\n      for (int i = 0; i < 40; i++) {\n        for (int j = 0; j < 40; j++) {\n          nw[i][j] = 0;\n        }\n      }\n      if (d == 1) {\n        for (int i = 0; i < 40; i++) {\n          for (int j = c; j < 40; j++) {\n            nw[i][j - c] += past[i][j];\n          }\n        }\n        for (int i = 0; i < 40; i++) {\n          for (int j = 0; j < c; j++) {\n            nw[i][j] += past[i][j];\n          }\n        }\n        for (int i = 0; i < 40; i++) {\n          for (int j = 0; j < 40; j++) {\n            past[i][j] = nw[i][j];\n          }\n        }\n      } else {\n        int h = 0;\n        int last = 0;\n        for (int i = 0; i < 40; i++) {\n          if (past[i][0] != 0) {\n            h++;\n            last = i;\n          }\n        }\n        if (c >= h - c) {\n          int cont = 0;\n          int now = last;\n          while (cont < c) {\n            for (int i = 0; i < 40; i++) {\n              nw[cont][i] += past[now][i];\n            }\n            cont++;\n            now--;\n          }\n          for (int i = now; i >= 0; i--) {\n            for (int j = 0; j < 40; j++) {\n              nw[c - i + now - 1][j] += past[h - c - i + now - 1][j];\n            }\n          }\n        } else {\n          for (int i = 0; i < h - c; i++) {\n            for (int j = 0; j < 40; j++) {\n              nw[i][j] += past[i][j];\n            }\n          }\n          int cont = 0;\n          while (cont < c) {\n            for (int i = 0; i < 40; i++) {\n              nw[h - c - cont - 1][i] += past[h - c + cont][i];\n            }\n            cont++;\n          }\n        }\n        for (int i = 0; i < 40; i++) {\n          for (int j = 0; j < 40; j++) {\n            past[i][j] = nw[i][j];\n          }\n        }\n        // for (int i = 0; i < 10; i++) {\n        //   for (int j = 0; j < 10; j++) {\n        //     cerr << past[i][j];\n        //   }\n        //   cerr << endl;\n        // }\n      }\n    }\n    int h = 0;\n    for (int i = 0; i < 40; i++) {\n      if (past[i][0] != 0) {\n        h++;\n      }\n    }\n    for (int i = 0; i < p; i++) {\n      int x, y; cin >> x >> y;\n      cout << past[h - y - 1][x] << endl;\n    }\n    // for (int i = 0; i < 10; i++) {\n    //   for (int j = 0; j < 10; j++) {\n    //     cerr << past[i][j];\n    //   }\n    //   cerr << endl;\n    // }\n  }\n#ifdef LOCAL_DEFINE\n  cerr << \"Time elapsed: \" << 1.0 * clock() / CLOCKS_PER_SEC << \"s.\\n\";\n  fclose(stream1);\n  //fclose(stream2);\n#endif\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <climits>\n#include <fstream>\n#include <cmath>\n#include <iostream>\n#include <map>\n#include <cmath>\n#include <algorithm>\n#include <functional>\n\nusing namespace std;\n\nint n, m, t, p;\ntypedef map<int, map<int, int>> mp;\n\nconst int getOrigValue(const mp& s, const int x, const int y)\n{\n\tif (s.find(x) == s.end()) {\n\t\treturn 0;\n\t}\n\tif (s.at(x).find(y) == s.at(x).end()) {\n\t\treturn 0;\n\t}\n\treturn s.at(x).at(y);\n}\n\nmp calc(const mp& sheet)\n{\n\tint d, c;\n\tcin >> d >> c;\n\n\tmp new_sheet(sheet);\n\t\n\tconst int xmax = sheet.size();\n\tconst int ymax = sheet.at(0).size();\n\tif (d == 1) \n\t{\n\t\tfor (int y = 0; y < ymax; y++)\n\t\t{\n\t\t\tfor (int x = 0; x < c; x++)\n\t\t\t{\n\t\t\t\tconst int tx = 2 * c - x - 1;\n\t\t\t\tconst int ty = y;\n\t\t\t\tnew_sheet[tx][ty] = sheet.at(x).at(y) + getOrigValue(sheet, tx, ty);\n\t\t\t\tnew_sheet[x][y] = 0;\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tfor (int x = 0; x < xmax; x++)\n\t\t{\n\t\t\tfor (int y = 0; y < c; y++)\n\t\t\t{\n\t\t\t\tconst int tx = x;\n\t\t\t\tconst int ty = 2 * c - y - 1;\n\t\t\t\tnew_sheet[tx][ty] = sheet.at(x).at(y) + getOrigValue(sheet, tx, ty);\n\t\t\t\tnew_sheet[x][y] = 0;\n\t\t\t}\n\t\t}\n\t}\n\n\tmp ret;\n\n\tint xmin = INT_MAX, ymin = INT_MAX;\n\tfor (const auto& xitr : new_sheet) {\n\t\tfor (const auto& yitr : xitr.second) {\n\t\t\tif (yitr.second != 0) {\n\t\t\t\txmin = min(xmin, xitr.first);\n\t\t\t\tymin = min(ymin, yitr.first);\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (const auto& xitr : new_sheet) {\n\t\tfor (const auto& yitr : xitr.second) {\n\t\t\tif (yitr.second != 0)\n\t\t\t\tret[xitr.first-xmin][yitr.first-ymin] = yitr.second;\n\t\t}\n\t}\n\n\treturn ret;\n}\n\nvoid solve(const mp& s)\n{\n\tint x, y;\n\tcin >> x >> y;\n\tcout << s.at(x).at(y) << endl;\n}\n\n\nint main(void)\n{\n\twhile (true) {\n\t\tcin >> n >> m >> t >> p;\n\t\tif (!(n | m | t | p)) { break; }\n\t\tmp sheet;\n\t\tfor (int y = 0; y < m; y++)\n\t\t\tfor (int x = 0; x < n; x++)\n\t\t\t\tsheet[x][y] = 1;\n\t\tfor (int i = 0; i < t; i++)\n\t\t\tsheet = calc(sheet);\n\t\tfor (int i = 0; i < p; i++)\n\t\t\tsolve(sheet);\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <functional>\n#include <vector>\n#include <utility>\n#include <cstring>\n#include <cmath>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n#include <numeric> \n#define MAX_N 1000\nusing namespace std;\ntypedef long long ll;\nconst int INF = 1<<30; \nconst int MOD = 1e9 + 7;\nconst int dx[] = {1, 0, -1, 0};\nconst int dy[] = {0, 1, 0, -1};\nint main()\n{\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tint w, h, t, p, d, c;\n\twhile(cin >> w >> h >> t >> p, w | h | t | p)\n\t{\n\t\tint table[MAX_N][MAX_N] = {};\n\t\tint bottom = 0, height = h, left = 0, right = w;\n\t\tfor(int i = 0; i < h; i++)\n\t\t\tfor(int j = 0; j < w; j++) table[i][j] = 1;\n\t\tfor(int i = 0; i < t; i++)\n\t\t{\n\t\t\tcin >> d >> c;\n\t\t\tif(d == 1)\n\t\t\t{\n\t\t\t\tfor(int j = bottom; j < height; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = left; k < left + c; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\ttable[j][k + c] += table[j][k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tleft += c;\n\t\t\t\tif(c > right / 2) right += c - right / 2;\n\t\t\t}\n\t\t\telse if(d == 2)\n\t\t\t{\n\t\t\t\tfor(int j = bottom; j < bottom + c; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = left; k < right; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\ttable[j + c][k] += table[j][k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbottom += c;\n\t\t\t\tif(c > height / 2) height += c - height / 2;\n\t\t\t}\n\t\t}\n\t\tint x, y;\n\t\tfor(int i = 0; i < p; i++)\n\t\t{\n\t\t\tcin >> x >> y;\n\t\t\tcout << table[y + bottom][x + left] << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n//#include <bits/stdc++.h>\n#include <vector>\n#include <algorithm>\n#include <Cstdio>\nusing namespace std;\ntypedef long long ll;\nint n,m,t,p;\nint type,c;\nint main()\n{\n    while(~scanf(\"%d%d%d%d\",&m,&n,&t,&p)&&(m+n+t+p))\n    {\n        vector<vector<ll> >q(50);\n        for(int i=0; i<n; i++)\n        {\n            for(int j=0; j<m; j++)\n            {\n                q[i].push_back(1ll);\n            }\n        }\n        while(t--)\n        {\n            scanf(\"%d%d\",&type,&c);\n            if(type==1)\n            {\n                for(int j=0; j<n; j++)\n                {\n                    for(int i=0; i<=c-1; i++)\n                        q[j][2*c-1-i]+=q[j][i];\n                }\n                for(int i=0; i<n; i++)\n                    for(int j=0; j<m-c; j++)\n                        q[i][j]=q[i][j+c];\n            }\n            else if(type==2)\n            {\n                for(int j=0; j<m; j++)\n                    for(int i=0; i<=c-1; i++)\n                    {\n                        q[2*c-1-i][j]+=q[i][j];\n                    }\n                q.erase(q.begin(),q.begin()+c);\n            }\n        }\n        int x,y;\n        ll ans=0;\n        while(p--)\n        {\n            scanf(\"%d%d\",&x,&y);\n            printf(\"%lld\\n\",q[y][x]);\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define chmin(a, b) ((a)=min((a), (b)))\n#define chmax(a, b) ((a)=max((a), (b)))\n#define fs first\n#define sc second\n#define eb emplace_back\nusing namespace std;\n \ntypedef long long ll;\ntypedef pair<int, int> P;\ntypedef tuple<int, int, int> T;\n \nconst ll MOD=1e9+7;\nconst ll INF=1e18;\n \nint dx[]={1, -1, 0, 0};\nint dy[]={0, 0, 1, -1};\n\n\nint ori[1700][1700];\n\n\nint main(){\n    int O[2];\n    int n,m,t,p;\n    while(1){\n        cin >> n >> m >> t >> p;\n        if(n == 0)break;\n        for(int i = 0;i < 700;i++){ // 初期化\n            for(int j = 0;j < 700;j++){\n                ori[i][j] = 0;\n            }\n        }\n        \n        O[0] = 0; O[1] = 0;\n        for(int i = 0;i < m;i++){\n            for(int j = 0;j < n;j++){\n                ori[O[0]+i][O[1]+j] = 1;\n            }\n        }\n        \n        for(int iii = 0;iii < t;iii++){ //折る動作\n            int d,c;\n            cin >> d >> c;\n            if(d == 1){\n                for(int i = 0;i < m;i++){\n                    for(int j = 0;j < c;j++){\n                        ori[O[0]+i][O[1]+j+(c-j-1)*2+1] += ori[O[0]+i][O[1]+j];\n                        ori[O[0]+i][O[1]+j] = 0;\n                    }\n                }\n                O[1] += c;\n                n = max(n-c,c);\n            }else if(d == 2){\n                for(int j = 0;j < n;j++){\n                    for(int i = 0;i < c;i++){\n                        ori[O[0]+i+(c-i-1)*2+1][O[1]+j] += ori[O[0]+i][O[1]+j];\n                        ori[O[0]+i][O[1]+j] = 0;\n                    }\n                }\n                O[0] += c;\n                m = max(m-c,c);\n            }\n        }\n        \n        for(int ii = 0;ii < p;ii++){\n            int x,y;\n            cin >> x >> y;\n            cout << ori[O[0]+y][O[1]+x] << endl;\n        }\n\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nvector<vector<int>> field(500, vector<int>(500, 0));\n\npair<int, int> origin = {0, 0};  // y, x\n\nvector<int> solve(int T, int P) {\n    int d, c;\n    for (int r = 0; r < T; r++) {\n        cin >> d >> c;\n        if (d == 1) {  // 左右に折る\n            for (int i = 0; i < c; i++) {\n                int j = origin.first;\n                while (field[j][origin.second + c - i - 1] >= 1) {\n                    field[j][origin.second + i + c] += field[j][origin.second + c - i - 1];\n                    field[j][origin.second + c - i - 1] = 0;\n                    j++;\n                }\n            }\n            origin.second += c;\n        } else {  //上下に折る\n            for (int i = 0; i < c; i++) {\n                int j = origin.second;\n                while (field[origin.first + c - i - 1][j] >= 1) {\n                    field[origin.first + i + c][j] += field[origin.first + c - i - 1][j];\n                    field[origin.first + c - i - 1][j] = 0;\n                    j++;\n                }\n            }\n            origin.first += c;\n        }\n    }\n\n    int x, y;\n    vector<int> ret;\n    for (int r = 0; r < P; r++) {\n        cin >> x >> y;\n        ret.push_back(field[origin.first + y][origin.second + x]);\n    }\n    return ret;\n}\n\nint main() {\n    int n, m, t, p;\n    while (1) {\n        for (int i = 0; i < field.size(); i++) {\n            for (int j = 0; j < field[i].size(); j++) {\n                field[i][j] = 0;\n            }\n        }\n        origin.first = 0;\n        origin.second = 0;\n        cin >> n >> m >> t >> p;\n        if (!n & !m & !t & !p) break;\n        for (int i = 0; i < m; i++) {\n            for (int j = 0; j < n; j++) {\n                field[i][j] = 1;\n            }\n        }\n        vector<int> ans = solve(t, p);\n        for (auto &i : ans) {\n            cout << i << endl;\n        }\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\n#include<bitset>\n#include<stack>\n#include<unordered_map>\n#include<utility>\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int ui;\nconst ll mod = 1000000007;\ntypedef long double ld;\nconst ll INF = 1e+14;\ntypedef pair<int, int> P;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef complex<ld> Point;\nconst ld eps = 1e-8;\nconst ld pi = acos(-1.0);\ntypedef pair<ld, ld> LDP;\ntypedef pair<ll, ll> LP;\n#define fr first\n#define sc second\n#define all(c) c.begin(),c.end()\n#define pb push_back\n\nvoid Yes(){\n\tcout<<\"Yes\"<<endl;\n\texit(0);\n}\n \nvoid No(){\n\tcout<<\"No\"<<endl;\n\texit(0);\n}\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n    int n, m, t, p;\n    //int cnt[661][661];\n    for(;;) {\n        cin >> n >> m >> t >> p;\n        vector<vector<int>> cnt(1000,vector<int>(1000,0));\n        if(n == 0 && m == 0 && t == 0 && p == 0) return 0;\n        rep(i, m) {\n            rep(j, n) {         \n                cnt[i][j] = 1;\n            }\n        }\n        /*\n        for(int i = m; i <= 660 ; i++) {\n            for(int j = n; j <= 660; j++) {\n                cnt[i][j] = 0;\n            }\n        }\n        */\n        int a = -1, b = -1;\n        rep(i, t) {\n            int d, c; cin >> d >> c;\n            if(d == 2) {\n                a += c;\n                int l = a;\n                for(int k = a; k >= 0; k--) {\n                    l ++;\n                    rep(j, 600) {\n                        cnt[l][j] += cnt[k][j];\n                        cnt[k][j] = 0;\n                    }\n                }\n            } if(d == 1) {\n                b += c;\n                int l = b;\n                for(int k = b; k >= 0; k--) {\n                    l ++;\n                    rep(j, 600) {\n                        cnt[j][l] += cnt[j][k];\n                        cnt[j][k] = 0;\n                    }\n                }\n            }\n        }\n        rep(j, p) {\n            int x, y; cin >> x >> y;\n            cout << cnt[y  + a + 1][x + b + 1] << endl;\n        }\n       \n        /*rep(i, m) {\n            rep(j, n) {\n                cout << cnt[i + a + 1][j + b + 1] << \" \";\n            }\n            cout << endl;\n        }\n        */\n        \n    }\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\n\nint W,H;\nint num_fold,num_hole;\nint table[70][70];\n\nvoid func(){\n\n\tfor(int row = 0; row < 2*H; row++){\n\t\tfor(int col = 0; col < 2*W; col++){\n\t\t\ttable[row][col] = 0;\n\t\t}\n\t}\n\n\tfor(int row = 0; row < H; row++){\n\t\tfor(int col = 0; col < W; col++){\n\t\t\ttable[row][col] = 1;\n\t\t}\n\t}\n\n\tint work[64][64];\n\n\tint command,loc;\n\tint tmp_H = H,tmp_W = W;\n\tint left,right,top,bottom;\n\n\tfor(int loop = 0; loop < num_fold; loop++){\n\n\t\tscanf(\"%d %d\",&command,&loc);\n\n\t\t//workの初期化\n\t\tfor(int row = 0; row < 2*H; row++){\n\t\t\tfor(int col = 0; col < 2*W; col++){\n\t\t\t\twork[row][col] = 0;\n\t\t\t}\n\t\t}\n\n\t\t//tableの状態をworkに転記\n\t\tfor(int row = 0; row < tmp_H; row++){\n\t\t\tfor(int col = 0; col < tmp_W; col++){\n\t\t\t\twork[row][col] = table[row][col];\n\t\t\t}\n\t\t}\n\n\t\tif(command == 1){ //左右に折る\n\n\t\t\tfor(int row = 0; row <= tmp_H-1; row++){\n\n\t\t\t\tfor(int col = 0; col <= loc-1; col++){\n\t\t\t\t\twork[row][loc+((loc-1)-col)] += table[row][col];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tleft = loc;\n\t\t\tright = tmp_W-1+max(0,loc-(tmp_W-loc));\n\t\t\ttmp_W = right-left+1;\n\n\t\t\t//workからテーブルへの転記\n\t\t\tfor(int row = 0; row <= tmp_H-1; row++){\n\t\t\t\tfor(int col = left; col <= right; col++){\n\t\t\t\t\ttable[row][col-left] = work[row][col];\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t}else{ //上下に折る\n\n\t\t\tfor(int col = 0; col <= tmp_W-1; col++){\n\t\t\t\tfor(int row = 0; row <= loc-1; row++){\n\t\t\t\t\twork[loc+((loc-1)-row)][col] += table[row][col];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbottom = loc;\n\t\t\ttop = tmp_H-1+max(0,loc-(tmp_H-loc));\n\t\t\ttmp_H = top-bottom+1;\n\n\t\t\t//workからテーブルへの転記\n\t\t\tfor(int col = 0; col <= tmp_W-1; col++){\n\t\t\t\tfor(int row = bottom; row <= top; row++){\n\t\t\t\t\ttable[row-bottom][col] = work[row][col];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tint x,y;\n\n\tfor(int loop = 0; loop < num_hole; loop++){\n\t\tscanf(\"%d %d\",&x,&y);\n\n\t\tprintf(\"%d\\n\",table[y][x]);\n\t}\n}\n\nint main(){\n\n\twhile(true){\n\t\tscanf(\"%d %d %d %d\",&W,&H,&num_fold,&num_hole);\n\t\tif(W == 0 && H == 0 && num_fold == 0 && num_hole == 0)break;\n\n\t\tfunc();\n\t}\n\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<ll, ll> P;\ntypedef complex<double> Point;\n\n#define PI acos(-1.0)\n#define EPS 1e-10\nconst ll INF = 1e16;\nconst ll MOD = 1e9 + 7;\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define rep(i,N) for(int i=0;i<(N);i++)\n#define ALL(s) (s).begin(),(s).end()\n#define EQ(a,b) (abs((a)-(b))<EPS)\n#define EQV(a,b) ( EQ((a).real(), (b).real()) && EQ((a).imag(), (b).imag()) )\n#define fi first\n#define se second\n#define N_SIZE (1LL << 20)\n#define NIL -1\n\nll mod_add(ll a, ll b) { return (a + b) % MOD; }\nll mod_sub(ll a, ll b) { return (a - b + MOD) % MOD; }\nll mod_mul(ll a, ll b) { return a*b % MOD; }\n\nll h,w,t,p;\n\nll f[1000][1000];\n\nvoid calc(ll &cy,ll &cx,ll d,ll c){\n    if(d == 1){\n        rep(i,h){\n            rep(j,c){\n                f[cy + i][cx + 2 * c - 1 - j] += f[cy + i][cx + j];\n            }\n        }\n        cx += c;\n    }\n    else{\n        rep(i,c){\n            rep(j,w){\n                f[cy + 2 * c - 1 - i][cx + j] += f[cy + i][cx + j];\n            }\n        }\n        cy += c;\n    }\n}\n\nint main(){\n    while(cin >> w >> h >> t >> p && w){\n        rep(i,1000)rep(j,1000)f[i][j] = 0;\n        rep(i,h)rep(j,w)f[i][j] = 1;\n        ll cx = 0;\n        ll cy = 0;\n        rep(i,t){\n            ll d,c;\n            cin >> d >> c;\n            calc(cy,cx,d,c);\n        }\n        ll ans = 0;\n        // rep(i,cy + h){\n        //     rep(j,cx + w){\n        //         cout << f[i][j] << \" \";\n        //     }\n        //     cout << endl;\n        // }\n        // cout << cy << \" \" << cx << endl;\n        rep(i,p){\n            ll x,y;\n            cin >> x >> y;\n            x += cx;\n            y += cy;\n            cout << f[y][x] << endl;\n            // ans += f[y][x];\n        }\n        // cout << ans << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\nint main() {\n\twhile (true) {\n\t\tint n, m, t, p;\n\t\tcin >> n;\n\t\tcin >> m;\n\t\tcin >> t;\n\t\tcin >> p;\n\t\tif (n == 0 && m == 0 && t == 0 && p == 0) {\n\t\t\treturn 0;\n\t\t}\n\t\tint kami[n][m];\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tfor (int j = 0; j < m; j++) {\n\t\t\t\tkami[i][j] = 1;\n\t\t\t}\n\t\t}\n\t\tfor (int i = 0; i < t; i++) {\n\t\t\tint d, c;\n\t\t\tint kami2[n][m];\n\t\t\tcin >> d;\n\t\t\tcin >> c;\n\t\t\tif (d == 1) {\n\t\t\t\tif (c * 2 <= n) {\n\t\t\t\t\tfor (int s = 0; s < c; s++) {\n\t\t\t\t\t\tfor (int t = 0; t < m; t++) {\n\t\t\t\t\t\t\tkami2[s][t] = kami[c - s-1][t] + kami[c + s][t];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfor (int s = c; s < n; s++) {\n\t\t\t\t\t\tfor (int t = 0; t < m; t++){\n\t\t\t\t\t\t\tif (c +s< n) {\n\t\t\t\t\t\t\t\tkami2[s][t] = kami[c + s][t];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tkami2[s][t] = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfor (int s = 0; s < n-c; s++) {\n\t\t\t\t\t\tfor (int t = 0; t < m; t++) {\n\t\t\t\t\t\t\tkami2[s][t] = kami[c + s][t] + kami[c - s - 1][t];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\tfor (int s = n - c; s < n; s++) {\n\t\t\t\t\t\tfor (int t = 0; t < m; t++) {\n\t\t\t\t\t\t\tif (c - s-1>=0) {\n\t\t\t\t\t\t\t\tkami2[s][t] = kami[c - s - 1][t];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tkami2[s][t] = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tfor (int j = 0; j < m; j++) {\n\t\t\t\t\t\tkami[i][j] = kami2[i][j];\n\t\t\t\t\t\t//cout << kami[i][j] << \", \";\n\t\t\t\t\t}\n\t\t\t\t\t//cout << endl;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//kami = kami2;\n\t\t\t}\n\t\t\telse if(d==2) {\n\t\t\t\tint kami2[n][m];\n\t\t\t\tif (c * 2 <= m) {\n\t\t\t\t\tfor (int s = 0; s < n; s++) {\n\t\t\t\t\t\tfor (int t = 0; t < c; t++) {\n\t\t\t\t\t\t\tkami2[s][t] = kami[s][c-t-1] + kami[s][c+t];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (int t = c; t < m; t++) {\n\t\t\t\t\t\t\tif (c + t < m) {\n\t\t\t\t\t\t\t\tkami2[s][t] = kami[s][c + t];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tkami2[s][t] = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tfor (int s = 0; s < n; s++) {\n\t\t\t\t\t\tfor (int t = 0; t < m-c; t++) {\n\t\t\t\t\t\t\tkami2[s][t] = kami[s][c+t] + kami[s][c-1-t];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (int t = m-c; t < m; t++) {\n\t\t\t\t\t\t\tif (c-t-1>=0) {\n\t\t\t\t\t\t\t\tkami2[s][t] = kami[s][c-t-1];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tkami2[s][t] = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\t\tfor (int j = 0; j < m; j++) {\n\t\t\t\t\t\tkami[i][j] = kami2[i][j];\n\t\t\t\t\t\t//cout << kami[i][j] << \", \";\n\t\t\t\t\t}\n\t\t\t\t\t//cout << endl;\n\t\t\t\t}\n\t\t\t\t//kami = kami2;\n\t\t\t}\n\t\t}\n\t\t\n//\t\tint sum = 0;\n\t\tfor (int i = 0; i < p; i++) {\n\t\t\tint x,y;\n\t\t\tcin >> x;\n\t\t\tcin >> y;\n\t\t\t//sum += kami[x][y];\n\t\t\tcout << kami[x][y]<<endl;\n\t\t}\n\t\t\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#define rep(i, n) for(i = 0; i < n; i++)\nusing namespace std;\n\nint w, h, t, p;\nint d[20], c[20];\nint x[20], y[20];\n\nvoid solve() {\n\tint cnts[2][64][64] = {0};\n\tint i, j, k;\n\t\n\trep(i, h) rep(j, w) cnts[0][i][j] = 1;\n\trep(i, t) {\n\t\trep(j, h) {\n\t\t\trep(k, w) {\n\t\t\t\tint nj = j;\n\t\t\t\tint nk = k;\n\t\t\t\tif (d[i] == 2 && nj < c[i]) nj = c[i] + (c[i] - nj) - 1;\n\t\t\t\tif (d[i] == 1 && nk < c[i]) nk = c[i] + (c[i] - nk) - 1;\n\t\t\t\tcnts[1][nj][nk] += cnts[0][j][k];\n\t\t\t}\n\t\t}\n\t\t\n\t\t//原点を求める\n\t\tint minJ = 114514;\n\t\tint minK = 114514;\n\t\trep(j, 2 * h) {\n\t\t\trep(k, 2 * w) {\n\t\t\t\tif (cnts[1][j][k] > 0) {\n\t\t\t\t\tminJ = min(minJ, j);\n\t\t\t\t\tminK = min(minK, k);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t//コピー\n\t\trep(j, 2 * h) rep(k, 2 * w) cnts[0][j][k] = 0;\n\t\trep(j, 2 * h) {\n\t\t\trep(k, 2 * w) {\n\t\t\t\tif (j < minJ || k < minK) continue;\n\t\t\t\tcnts[0][j - minJ][k - minK] = cnts[1][j][k];\n\t\t\t}\n\t\t}\n\t\trep(j, 2 * h) rep(k, 2 * w) cnts[1][j][k] = 0;\t//cnt1の初期化を忘れないこと！\n\t}\n\t\n\trep(i, p) {\n\t\tcout << cnts[0][y[i]][x[i]] << endl;\n\t}\n}\n\nint main() {\n\twhile (cin >> w >> h >> t >> p) {\n\t\tif (!w) break;\n\t\tint i;\n\t\trep(i, t) cin >> d[i] >> c[i];\n\t\trep(i, p) cin >> x[i] >> y[i];\n\t\tsolve();\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//#include <tourist>\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int INF = 1e9;\nconst ll LINF = ll(1e18) + 1;\nconst int MOD = 1000000007;\nconst int dx[4] = {0, 1, 0, -1}, dy[4] = {-1, 0, 1, 0};\nconst int Dx[8] = {0, 1, 1, 1, 0, -1, -1, -1}, Dy[8] = {-1, -1, 0, 1, 1, 1, 0, -1};\n#define yes cout << \"Yes\" << endl\n#define YES cout << \"YES\" << endl\n#define no cout << \"No\" << endl\n#define NO cout << \"NO\" << endl\n#define rep(i, n) for (int i = 0; i < n; i++)\n#define ALL(v) v.begin(), v.end()\n#define debug(v)          \\\n    cout << #v << \":\";    \\\n    for (auto x : v)      \\\n    {                     \\\n        cout << x << ' '; \\\n    }                     \\\n    cout << endl;\ntemplate <class T>\nbool chmax(T &a, const T &b)\n{\n    if (a < b)\n    {\n        a = b;\n        return 1;\n    }\n    return 0;\n}\ntemplate <class T>\nbool chmin(T &a, const T &b)\n{\n    if (b < a)\n    {\n        a = b;\n        return 1;\n    }\n    return 0;\n}\n//cout<<fixed<<setprecision(15);有効数字15桁\n//-std=c++14\nll gcd(ll a, ll b) { return b ? gcd(b, a % b) : a; }\nll lcm(ll a, ll b) { return a / gcd(a, b) * b; }\nint n, m, t, p;\nvector<int> a;\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    vector<ll> ans;\n    while (true)\n    {\n        cin >> n >> m >> t >> p;\n        if (n == 0)\n            break;\n        vector<vector<int> > board(m+1000,vector<int>(n+1000,0));\n        for(int i=0;i<m;i++){\n            for(int j=0;j<n;j++){\n                board[i][j]=1;\n            }\n        }\n        int l=0;\n        int down=0;\n        rep(h, t)\n        {\n            int d, c;\n            cin >> d >> c;\n            if(d==1){\n                l += c;\n                for(int i=0;i<c;i++){\n                    for(int j=down;j<m+down;j++){\n                        board[j][l+i]+=board[j][l-i-1];\n                    }\n                }\n            }\n            else{\n                down += c;\n                for(int i=0;i<c;i++){\n                    for(int j=l;j<n+l;j++){\n                        board[down+i][j]+=board[down-i-1][j];\n                    }\n                }\n            }\n        }\n        rep(h,p){\n            int x,y;\n            cin>>x>>y;\n            ans.push_back(board[down+ y][l+x]);\n        }\n        //cout<<l<<\" \"<<down<<\"\\n\";\n        /*\n        for(int i=0;i<m;i++){\n            for(int j=0;j<n;j++){\n                cout<<board[i][j]<<\" \";\n            }\n            cout<<\"\\n\";\n        }\n        */\n    }\n    rep(i,ans.size())\n    cout << ans[i] << \"\\n\";\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define FOR(i,a,b) for(int i = (a); i < (b); ++i)\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define all(x) (x).begin(),(x).end()\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v; return v;}\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector< vector<int> > Mat;\ntypedef tuple<int, int, int, int> T;\n\nconst int MOD = (int)1e9+7;\nconst int INF = (int)1e9;\nconst int dx[] = {0, 1, 0, -1};\nconst int dy[] = {1, 0, -1, 0};\nconst int ddx[] = {0, 1, 1, 1, 0, -1, -1, -1};\nconst int ddy[] = {1, 1, 0, -1, -1, -1, 0, 1};\n\nint main(){\n    ios::sync_with_stdio(false);\n\tcin.tie(0);\n\n    int n, m, t, p;\n    while(1){\n        cin >> n >> m >> t >> p;\n        if(n+m+t+p == 0) break;\n        vector< vector<int> > paper(m*2, vector<int>(n*2, 0));\n        int ox = 0, oy = 0, dx = n, dy = m;\n        rep(i, n) rep(j, m) paper[i][j] += 1;\n        \n\n        rep(i, t){\n            int d, c;\n            cin >> d >> c;\n            if(d == 1){\n                dx = max(dx, ox+(c+1)*2);\n                FOR(i, ox, ox+c){\n                    FOR(j, oy, dy) paper[j][c+i] += paper[j][i];\n                }\n                ox += c;\n            }else{\n                dy = max(dy, oy+(c+1)*2);\n                FOR(i, oy, oy+c){\n                    FOR(j, ox, dx) paper[c+i][j] += paper[i][j];\n                }\n                oy += c;\n            }\n        }\n\n        rep(i, p){\n            int x, y;\n            cin >> x >> y;\n            cout << paper[y+oy][x+ox] << endl;\n        }\n\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n// region template\n#define rep(i, a, b) for (int i = (a); i < (b); ++i)\n#define trav(a, x) for (auto &a : x)\n#define all(x) begin(x), end(x)\n#define sz(x) (int)(x).size()\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef vector<int> vi;\n\nll gcd(ll a, ll b) { return __gcd(a, b); }\n\nll euclid(ll a, ll b, ll &x, ll &y) {\n    if (b) { ll d = euclid(b, a % b, y, x);\n        return y -= a/b * x, d; }\n    return x = 1, y = 0, a;\n}\n\ntypedef unsigned long long ull;\ntypedef long double ld;\null mod_mul(ull a, ull b, ull M) {\n    ll ret = a * b - M * ull(ld(a) * ld(b) / ld(M));\n    return ret + M * (ret < 0) - M * (ret >= (ll)M);\n}\null mod_pow(ull b, ull e, ull mod) {\n    ull ans = 1;\n    for (; e; b = mod_mul(b, b, mod), e /= 2)\n        if (e & 1) ans = mod_mul(ans, b, mod);\n    return ans;\n}\n\nconst ll mod = 1000000007;\nstruct Mod {\n    ll x;\n    Mod(ll xx) : x(xx) {}\n    Mod operator+(Mod b) { return Mod((x + b.x) % mod); }\n    Mod operator-(Mod b) { return Mod((x - b.x) % mod); }\n    Mod operator*(Mod b) { return Mod((x * b.x) % mod); }\n    Mod operator/(Mod b) { return *this * invert(b); }\n    Mod invert(Mod a) {\n        ll x, y, g = euclid(a.x, mod, x, y);\n        assert(g == 1); return Mod((x + mod) % mod);\n    }\n    Mod operator^(ll e) {\n        if (!e) return Mod(1);\n        Mod r = *this ^ (e / 2); r = r * r;\n        return e & 1 ? *this * r : r;\n    }\n};\n// endregion\n\nvoid printboard(int m, int n, const vector<vi> &paper) {\n    cout << \"--------------------------\" << endl;\n    cout << \"Board:\" << endl;\n    for (int j = 0; j < m; j++) {\n        for (int i = 0; i < n; i++) {\n            cout << paper[i][j];\n        }\n        cout << endl;\n    }\n    cout << \"--------------------------\" << endl;\n}\n\nint main() {\n    for (;;) {\n        int n, m, t, p; cin >> n >> m >> t >> p; if (!n) break;\n        vector<vi> paper(n, vi(m, 1));\n            // printboard(m, n, paper);\n        for (int i = 0; i < t; i++) {\n            int d, c; cin >> d >> c;\n\n            if (d == 1) {\n                if (c * 2 > n) {\n                    reverse(all(paper));\n                    c = n - c;\n                }\n\n                for (int i = 0; i < c; i++) {\n                    for (int j = 0; j < m; j++) {\n                        paper[c + i][j] += paper[c - 1 - i][j];\n                        paper[c - 1 - i][j] = 0;\n                    }\n                }\n                paper = vector<vi>(paper.begin() + c, paper.end());\n\n                n -= c;\n            } else if (d == 2) {\n                if (c * 2 > m) {\n                    for (int i = 0; i < n; i++) reverse(all(paper[i]));\n                    c = m - c;\n                }\n                for (int i = 0; i < n; i++) {\n\n                    for (int j = 0; j < c; j++) {\n                        paper[i][m - c - 1 - j] += paper[i][m - c + j];\n                    }\n                    paper[i] = vi(paper[i].begin(), paper[i].end() - c);\n                }\n\n                m -= c;\n            }\n            // printboard(m, n, paper);\n        }\n        int ans = 0;\n        rep(i, 0, p) {\n            // cout << n << \" \" << m << endl;\n            int x, y; cin >> x >> y;\n            cout << paper[x][m - 1 - y] << endl;\n        }\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  int n, m, t, p;\n\n  while (cin >> n >> m >> t >> p, n) {\n    vector<vector<int>> a(m, vector<int>(n, 1));\n    while (t--) {\n      int d, c;\n      cin >> d >> c;\n\n      if (d == 1) {\n        vector<vector<int>> b(m, vector<int>(max(c, n - c), 0));\n        for (int i = 0; i < m; ++i) {\n          for (int j = 0; j < max(c, n - c); ++j) {\n            if (c + j < n) b[i][j] += a[i][c + j];\n            if (c - j - 1 >= 0) b[i][j] += a[i][c - j - 1];\n          }\n        }\n\n        a = b;\n        n = max(c, n - c);\n      } else {\n        vector<vector<int>> b(max(c, m - c), vector<int>(n, 0));\n        for (int j = 0; j < n; ++j) {\n          for (int i = 0; i < max(c, m - c); ++i) {\n            if (c + i < m) b[i][j] += a[c + i][j];\n            if (c - i - 1 >= 0) b[i][j] += a[c - i - 1][j];\n          }\n        }\n\n        a = b;\n        m = max(c, m - c);\n      }\n    }\n\n    while (p--) {\n      int x, y;\n      cin >> x >> y;\n\n      cout << a[y][x] << endl;\n    }\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nusing vector2D = vector< vector<int> >;\n\nvector2D rotate_right(vector2D board) {\n    int H = board.size(), W = board[0].size();\n\n    vector2D ret(W, vector<int>(H));\n    for(int i=0; i<H; i++) {\n        for(int j=0; j<W; j++) {\n            int ni = j, nj = H - i - 1;\n            ret[ni][nj] = board[i][j];\n        }\n    }\n\n    return ret;\n}\n\nvector2D rotate_left(vector2D board) {\n    vector2D ret = rotate_right(board);\n\n    reverse(ret.begin(), ret.end());\n    for(int i=0; i<(int)ret.size(); i++) {\n        reverse(ret[i].begin(), ret[i].end());\n    }\n    return ret;\n}\n\npair< vector2D, vector2D > split_board(vector2D board, int col) {\n    int H = board.size(), W = board[0].size();\n\n    vector2D A(H, vector<int>(col)), B(H, vector<int>(W - col));\n    for(int i=0; i<H; i++) {\n        for(int j=0; j<col; j++) {\n            int idx = j;\n            A[i][idx] = board[i][j];\n        }\n        for(int j=col; j<W; j++) {\n            int idx = j - col;\n            B[i][idx] = board[i][j];\n        }\n    }\n\n    for(int i=0; i<H; i++) {\n        reverse(A[i].begin(), A[i].end());\n    }\n\n    return make_pair(A, B);\n}\n\nvector2D fold(vector2D board, int col) {\n    vector2D A, B;\n    tie(A, B) = split_board(board, col);\n\n    int H = max(A.size(), B.size());\n    int W = max(A[0].size(), B[0].size());\n\n    vector2D ret(H, vector<int>(W));\n    for(int i=0; i<H; i++) {\n        for(int j=0; j<W; j++) {\n            if(i < A.size() && j < A[0].size()) {\n                ret[i][j] += A[i][j];\n            }\n            if(i < B.size() && j < B[0].size()) {\n                ret[i][j] += B[i][j];\n            }\n        }\n    }\n    return ret;\n}\n\nvoid print_board(vector2D board) {\n    cout << \"status:\" << endl;\n\n    int H = board.size(), W = board[0].size();\n    for(int i=0; i<H; i++) {\n        for(int j=0; j<W; j++) {\n            cout << board[i][j] << \" \";\n        }\n        cout << endl;\n    }\n}\n\nint main() {\n    int W, H, T, P;\n    while(cin >> W >> H >> T >> P, W + H + T + P) {\n        vector2D board(H, vector<int>(W, 1));\n\n        for(int i=0; i<T; i++) {\n            // print_board(board);\n\n            int d, col; cin >> d >> col;\n            if(d == 2) {\n                board = rotate_right(board);\n            }\n\n            board = fold(board, col);\n\n            if(d == 2) {\n                board = rotate_left(board);\n            }\n        }\n\n        H = board.size(), W = board[0].size();\n        for(int i=0; i<P; i++) {\n            int x, y; cin >> x >> y;\n            // printf(\"x = %d, y = %d, H = %d, W = %d\\n\", x, y, H, W);\n            cout << board[H - y - 1][x] << endl;\n        }\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\nint main()\n{\n\twhile(1)\n\t{\n\t\tint n,m,t,p;\n\t\tcin>>n>>m>>t>>p;\n\t\tif(n==0)\n\t\t\tbreak;\n\t\tint kami[96][96];\n\t\tfill(kami[0],kami[96],0);\n\t\t//初期値を置く\n\t\tfor(int i=0;i<m;i++)\n\t\t{\n\t\t\tfor(int j=0;j<n;j++)\n\t\t\t\tkami[i][j]=1;\n\t\t}\n\t\tint l=0;//現在の左のインデックス\n\t\tint u=0;//現在の上のインデックス\n\t\tint oru[20][2];\n\t\tfor(int i=0;i<t;i++)\n\t\t\tcin>>oru[i][0]>>oru[i][1];\n\t\tint ana[2][20];\n\t\tfor(int i=0;i<p;i++)\n\t\t\tcin>>ana[i][0]>>ana[i][1];\n\t\t\n\t\t//実際に折る\n\t\tfor(int i=0;i<t;i++)\n\t\t{\n\t\t\t//左側に折る\n\t\t\tif(oru[i][0]==1)\n\t\t\t{\n\t\t\t\tl=l+oru[i][1];\n\t\t\t\tfor(int i=0;i<l;i++)\n\t\t\t\t{\n\t\t\t\t\tfor(int j=0;j<96;j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tkami[j][l+i]+=kami[j][l-i-1];\n\t\t\t\t\t\tkami[j][l-i-1]=0;//折り終わったところにはもう何もない\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t//下に折る（実際には上）\n\t\t\t\tu=u+oru[i][1];\n\t\t\t\tfor(int i=0;i<u;i++)\n\t\t\t\t{\n\t\t\t\t\tfor(int j=0;j<96;j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tkami[u+i][j]+=kami[u-i-1][j];\n\t\t\t\t\t\tkami[u-i-1][j]=0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//for debug\n\t\t\t/*\n\t\t\tfor(int j=0;j<m*2;j++)\n\t\t\t{\n\t\t\t\tfor(int k=0;k<n*2;k++)\n\t\t\t\t\tcout<<kami[j][k]<<\" \";\n\t\t\t\tcout<<endl;\n\t\t\t}*/\n\t\t}\n\n\t\t//穴を開ける\n\t\tfor(int i=0;i<p;i++)\n\t\t\tcout<<kami[u+ana[i][1]][l+ana[i][0]]<<endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define REP(i,n) for(long long i=0;i<n;i++)\n#define REP1(i,n) for(long long i=1;i<=n;i++)\n#define REP2D(i,j,h,w) for(long long i=0;i<h;i++) for(long long j=0;j<w;j++)\n#define REP2D1(i,j,h,w) for(long long i=1;i<=h;i++) for(long long j=1;j<=w;j++)\n#define PER(i,n) for(long long i=((n)-1);i>=0;i--)\n#define PER1(i,n) for(long long i=(n);i>0;i--)\n#define FOR(i,a,b) for(long long i=(a);i<(b);i++)\n#define FORE(i,a,b) for(long long i=(a);i<=(b);i++)\n#define ITE(arr) for(auto ite=(arr).begin();ite!=(arr).end();++ite)\n#define ALL(a) (a.begin()),(a.end())\n#define RANGE(a) (a),(a+sizeof(a))\n#define ZERO(a) memset(a,0,sizeof(a))\n#define MINUS(a) memset(a,0xff,sizeof(a))\n#define YNPRT(b) cout<<((b)?\"Yes\":\"No\")<<endl\n#define REV(arr) reverse(ALL(arr))\n#define PRT(a) cout<<a<<endl;\n#define PRTLST(arr,num) REP(_i,num) cout<<_i<<\" - \"<<arr[_i]<<endl;\n#define PRTLST2(arr2,d1,d2) REP(_i,d1) REP(_j,d2) cout<<_i<<\",\"<<_j<<\" : \"<<arr2[_i][_j]<<endl;\n#define PRTLST2D(arr2,d1,d2) do{cout<<\"L\\t\";REP(_i,d2) cout<<_i<<\"\\t\"; cout<<endl; REP(_i,d1){cout<<_i<<\"\\t\";REP(_j,d2){cout<<arr2[_i][_j]<<\"\\t\";}cout<<endl;}}while(0);\n#define MIN(target,v1) (target)=min(target,v1)\n#define MAX(target,v1) (target)=max(target,v1)\n#define P1 first\n#define P2 second\n#define PB push_back\n#define UB upper_bound\n#define LB lower_bound\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\nconst int INF_INT = 2147483647;\nconst ll INF_LL = 9223372036854775807LL;\nconst ull INF_ULL = 18446744073709551615Ull;\nconst ll P = 92540646808111039LL;\nconst int Move[4][2] = {-1,0,0,1,1,0,0,-1};\nconst int Move_[8][2] = {-1,0,-1,-1,0,1,1,1,1,0,1,-1,0,-1,-1,-1};\ntemplate<typename T1,typename T2>\nostream& operator<<(ostream& os,const pair<T1,T2>& p) {os<<\"( \"<<p.P1<<\" , \"<<p.P2<<\" )\";return os;}\ntemplate<typename T>\nostream& operator<<(ostream& os,const vector<T>& v) {ITE(v) os << (ite-v.begin()) << \" : \" << *ite <<endl;return os;}\ntemplate<typename T>\nostream& operator<<(ostream& os,const set<T>& v) {os<<\" { \";ITE(v) {os<<*ite;if(ite!=--v.end()){os<<\" , \";}} os<<\" } \";return os;}\ntemplate<typename T1,typename T2>\nostream& operator<<(ostream& os,const map<T1,T2>& m) {ITE(m) {os<<ite->P1<<\"\\t\\t|->\\t\\t\"<<ite->P2<<endl;} return os;}\n\n//---------------------\n#define MAXN 34\n//---------------------\n\nint n,m,t,p,d[20],c[20],x[20],y[20];\nint data[MAXN][MAXN];\nint p1x,p1y,p2x,p2y;\n\nint w(){\n    return p2x-p1x+1;\n}\nint h(){\n    return p2y-p1y+1;\n}\n\nint mirId(int a,int m){\n    return 2*m-a-1;\n}\n\nvoid flipLR(){\n    int memo[50];\n    FORE(j,p1y,p2y){\n        FORE(i,p1x,p2x){\n            memo[i]=data[i][j];\n        }\n        FORE(i,p1x,p2x){\n            data[p2x-(i-p1x)][j]=memo[i];\n        }\n    }\n}\n\nvoid flipUB(){\n    int memo[50];\n    FORE(i,p1x,p2x){\n        FORE(j,p1y,p2y){\n            memo[j]=data[i][j];\n        }\n        FORE(j,p1y,p2y){\n            data[i][p2y-(j-p1y)]=memo[j];\n        }\n    }\n}\n\nvoid lr(int num){\n    if(num<=(w()>>1)){\n        FOR(i,0,num){\n            FOR(j,0,h()){\n                data[p1x+mirId(i,num)][j+p1y]+=data[i+p1x][j+p1y];\n            }\n        }\n        p1x+=num;\n    }else{\n        num=w()-num;\n        FOR(i,0,num){\n            FOR(j,0,h()){\n                data[p2x-mirId(i,num)][j+p1y]+=data[p2x-i][j+p1y];\n            }\n        }\n        p2x-=num;\n        flipLR();\n    }\n}\n\nvoid ud(int num){\n    if(num<=(h()>>1)){\n        FOR(i,0,w()){\n            FOR(j,0,num){\n                data[i+p1x][p1y+mirId(j,num)]+=data[i+p1x][j+p1y];\n            }\n        }\n        p1y+=num;\n    }else{\n        num=h()-num;\n        FOR(i,0,w()){\n            FOR(j,0,num){\n                data[i+p1x][p2y-mirId(j,num)]+=data[i+p1x][p2y-j];\n            }\n        }\n        p2y-=num;\n        flipUB();\n    }\n}\n\nbool init(){\n    ZERO(d);ZERO(c);ZERO(data);ZERO(x);ZERO(y);\n    cin>>n>>m>>t>>p;\n\n    if(n<=0) return false;\n\n    REP(i,t) cin>>d[i]>>c[i];\n    REP(i,p) cin>>x[i]>>y[i];\n\n    REP2D1(i,j,n,m) data[i][j] = 1;\n\n    p1x=p1y=1;\n    p2x=n;\n    p2y=m;\n\n    return true;\n}\n\nint main()\n{\n    while(init()){\n        REP(i,t){\n            if(d[i]==1){\n                lr(c[i]);\n            }else{\n                ud(c[i]);\n            }\n        }\n        REP(i,p)\n        cout<< data[p1x+x[i]][p1y+y[i]] <<endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<set>\n#include<map>\n#include<stack>\n\n#define MOD 10000000\nusing namespace std; \ntypedef long long LL;\n\nlong long quickpow(long long n, long long base) {\n    long long res = 1;\n    while(n) {\n        if(n & 1) {\n            res = res * base % MOD;\n        }\n        n >>= 1;\n        base = base * base % MOD;\n    }\n    return res;\n}//¿ìËÙÃÝ \n\nint ans[50];\nint A[50][50];\nint main()\n{\n\t  int n,m,t,p;\n\t  cin>>n>>m>>t>>p;\n\t  int d,c,x,y;\n\n      while(n!=0||m!=0||t!=0||p!=0)\n      {\n      \t  for(int i=1;i<=m;i++)\n      \t  for(int j=1;j<=n;j++)\n      \t  {\n  \t      \t A[i][j]=1;\n  \t      }\n  \t      for(int i=1;i<=t;i++)\n  \t      {\n      \t  \tcin>>d>>c;\n      \t  \t  if(d==1)\n      \t  \t  {\n\t  \t      \t  if(c<=n/2)\n\t  \t      \t  {\n\t  \t      \t  \t   for(int i=1;i<=m;i++)\n  \t      \t  \t\t   for(int j=c+1;j<=2*c;j++)\n  \t      \t  \t\t   A[i][j]+=A[i][2*c+1-j];\n   \t  \t\t           for(int i=1;i<=m;i++)\n  \t\t               for(int j=1;j<=n-c;j++)\n  \t\t               A[i][j]=A[i][j+c];\n                       n-=c;\n \n  \t      \t  \t  }\n  \t      \t  \t  else\n  \t      \t  \t  {\n  \t  \t      \t  \t  for(int i=1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=c+1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]+=A[i][2*c+1-j];\n  \t  \t      \t  \t  for(int i=1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=n-c+1;j<=c;j++)\n  \t  \t      \t  \t  A[i][j]=A[i][j-(n-c)];\n  \t  \t      \t  \t  for(int i=1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n-c;j++)\n  \t  \t      \t  \t  A[i][j]=A[i][j+c];\n                      n=c;\n  \t      \t  \t  }\n  \t          }\n  \t          if(d==2)\n  \t          {\n\t  \t      \t  if(c<=m/2)\n\t  \t      \t  {\n\t  \t      \t  \t   for(int i=c+1;i<=2*c;i++)\n  \t      \t  \t\t   for(int j=1;j<=n;j++)\n  \t      \t  \t\t   A[i][j]+=A[2*c+1-i][j];\n   \t  \t\t           for(int i=1;i<=m-c;i++)\n  \t\t               for(int j=1;j<=n;j++)\n  \t\t               A[i][j]=A[i+c][j];\n                       m-=c;\n\n  \t      \t  \t  }\n  \t      \t  \t  else\n  \t      \t  \t  {\n  \t  \t      \t  \t  for(int i=c+1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]+=A[2*c+1-i][j];\n  \t  \t      \t  \t  for(int i=m-c+1;i<=c;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]=A[i-(n-c)][j];\n  \t  \t      \t  \t  for(int i=1;i<=m-c;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]=A[i+c][j];\n                      m=c;\n  \t      \t  \t  }\n          \t  }\n      \t  }\n      \t  int j=0;\n      \t  for(int i=1;i<=p;i++)\n      \t  {\n      \t  \tcin>>x>>y;\n  \t      \tans[++j]=A[y+1][x+1];\n  \t      }\n  \t      for(int i=1;i<=j;i++)\n  \t      {\n      \t  \tcout<<ans[i]<<endl;\n      \t  }\n      \t  cin>>n>>m>>t>>p;\n      }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n    int n, m, t, p, d, c, x, y;\n    while (cin >> n >> m >> t >> p) {\n        if (n == 0) break;\n\n        int h = m, w = n;\n        vector<vector<int>> ov(h, vector<int>(w, 1));\n        for (int i=0; i<t; ++i) {\n            cin >> d >> c;\n            if (d == 1) {\n                int w2 = max(c, w-c);\n                vector<vector<int>> ov2(h, vector<int>(w2, 0));\n                // left part\n                for (int j=0; j<h; ++j)\n                    for (int k=0; k<c; ++k)\n                        ov2[j][c-1-k] += ov[j][k];\n                // right part\n                for (int j=0; j<h; ++j)\n                    for (int k=c; k<w; ++k)\n                        ov2[j][k-c] += ov[j][k];\n                ov = ov2;\n                w = w2;\n            } else {\n                int h2 = max(c, h-c);\n                vector<vector<int>> ov2(h2, vector<int>(w, 0));\n                // bottom part\n                for (int j=0; j<c; ++j) \n                    for (int k=0; k<w; ++k) \n                        ov2[c-1-j][k] += ov[j][k];\n                // up part\n                for (int j=c; j<h; ++j) \n                    for (int k=0; k<w; ++k) \n                        ov2[j-c][k] += ov[j][k];\n                ov = ov2;\n                h = h2;\n            }\n        }\n        for (int i=0; i<p; ++i) {\n            cin >> x >> y;\n            cout << ov[y][x] << endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cmath>\n#include <iostream>\n#include <vector>\n\nusing namespace std;\n\nint main() {\n  while (true) {\n    int n, m, t, p;\n    cin >> n >> m >> t >> p;\n    if (n == 0) break;\n    vector<int> x, y;\n    for (int i = 0; i < m; ++i) {\n      for (int j = 0; j < n; ++j) {\n        x.emplace_back(j);\n        y.emplace_back(i);\n      }\n    }\n    for (int i = 0; i < t; ++i) {\n      int d, c;\n      cin >> d >> c;\n      for (int& k : (d == 1 ? x : y)) k = abs(k - c + 0.5) - 0.5;\n    }\n    for (int i = 0; i < p; ++i) {\n      int xi, yi, c = 0;\n      cin >> xi >> yi;\n      for (int k = 0; k < n * m; ++k) {\n        if (x[k] == xi && y[k] == yi) ++c;\n      }\n      cout << c << endl;\n    }\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\nint main() {\n\twhile (true) {\n\t\tint n, m, t, p;\n\t\tcin >> n >> m >> t >> p;\n\t\tif (n == 0) break;\n\n\t\tvector<vector<int>> card(300, vector<int>(300, 0));\n\t\tfor(int x = 0; x < n; ++x) {\n\t\t\tfor(int y = 0; y < m; ++y) {\n\t\t\t\tcard[x][y] = 1;\n\t\t\t}\n\t\t}\n\n\t\tint l = 0, u = 0;\n\t\tfor(int q = 0; q < t; ++q) {\n\t\t\tint d, c;\n\t\t\tcin>>d>>c;\n\n\t\t\tif (d == 1) {\n\t\t\t\tfor(int x = 0; x < c; ++x) {\n\t\t\t\t\tfor(int y = 0; y < m; ++y) {\n\t\t\t\t\t\tcard[l + c * 2 - x - 1][u + y] += card[l + x][u + y];\n\t\t\t\t\t\tcard[l + x][u + y] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tl += c;\n\t\t\t\tn = max(c, n - c);\n\t\t\t} else {\n\t\t\t\tfor(int x = 0; x < n; ++x) {\n\t\t\t\t\tfor(int y = 0; y < c; ++y) {\n\t\t\t\t\t\tcard[l + x][u + c * 2 - 1 - y] += card[l + x][u + y];\n\t\t\t\t\t\tcard[l + x][u + y] = 0; \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tu += c;\n\t\t\t\tm = max(c, m - c);\n\t\t\t}\n\t\t}\n\n\t\tfor(int q = 0; q < p; ++q) {\n\t\t\tint x, y;\n\t\t\tcin >> x >> y;\n\t\t\tcout << card[l + x][u + y] << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <iostream>\n#include <string>\n#include <vector>\n\nusing namespace std;\ntypedef long long int ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\n\n#define INF (1e9)\n\nint N, M, T, P;\n\nint main() {\n    while (true) {\n        cin >> N >> M >> T >> P;\n        if (N == 0 && M == 0 && T == 0 && P == 0) break;\n\n        vvi A(N, vi(M, 1));\n        for (int i = 0; i < T; i++) {\n            vvi B(N, vi(M, 0));\n            int d, c;\n            cin >> d >> c;\n            if (d == 1) {  // →\n                for (int x = 0; x < N; x++) {\n                    for (int y = 0; y < M; y++) {\n                        if (x < c) {\n                            B[c - x - 1][y] += A[x][y];\n                        } else {\n                            B[x - c][y] += A[x][y];\n                        }\n                    }\n                }\n            } else {  // ↑\n                for (int x = 0; x < N; x++) {\n                    for (int y = 0; y < M; y++) {\n                        if (y < c) {\n                            B[x][c - y - 1] += A[x][y];\n                        } else {\n                            B[x][y - c] += A[x][y];\n                        }\n                    }\n                }\n            }\n            A = B;\n        }\n\n        for (int i = 0; i < P; i++) {\n            int x, y;\n            cin >> x >> y;\n            cout << A[x][y] << endl;\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\n#define REP(i,n) for(ll i=0;i<ll(n);++i)\n#define RREP(i,n) for(ll i=ll(n)-1;i>=0;--i)\n#define FOR(i,m,n) for(ll i=m;i<ll(n);++i)\n#define RFOR(i,m,n) for(ll i=ll(n)-1;i>=ll(m);--i)\n#define ALL(v) (v).begin(),(v).end()\n#define UNIQUE(v) v.erase(unique(ALL(v)),v.end());\n#define INF 1000000001ll\n#define MOD 1000000007ll\n#define EPS 1e-9\n\nconst int dx[8] = { 1,1,0,-1,-1,-1,0,1 };\nconst int dy[8] = { 0,1,1,1,0,-1,-1,-1 };\n\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector<vi> vvi;\ntypedef vector<vl> vvl;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\n\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tint n, m, t, p;\n\twhile (cin >> m >> n >> t >> p, n) {\n\t\tvvi v(n, vi(m, 1));\n\t\tREP(adfad, t) {\n\t\t\tint d, c;\n\t\t\tcin >> d >> c;\n\t\t\tif (d == 1) {\n\t\t\t\tint k = max(m - c, c);\n\t\t\t\tvvi t(n, vi(k));\n\t\t\t\tREP(i, n) {\n\t\t\t\t\tREP(j, k) {\n\t\t\t\t\t\tint tmp = 0;\n\t\t\t\t\t\tif (j < c)tmp += v[i][c - j - 1];\n\t\t\t\t\t\tif (c + j < m)tmp += v[i][c + j];\n\t\t\t\t\t\tt[i][j] = tmp;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tm = k;\n\t\t\t\tv = t;\n\n\t\t\t}\n\t\t\telse {\n\t\t\t\tint k = max(n - c, c);\n\t\t\t\tvvi t(k, vi(m));\n\t\t\t\tREP(i, k) {\n\t\t\t\t\tREP(j, m) {\n\t\t\t\t\t\tint tmp = 0;\n\t\t\t\t\t\tif (i < c)tmp += v[c - i - 1][j];\n\t\t\t\t\t\tif (i + c < n)tmp += v[c + i][j];\n\t\t\t\t\t\tt[i][j] = tmp;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tn = k;\n\t\t\t\tv = t;\n\t\t\t}\n\t\t}\n\t\tREP(i, p) {\n\t\t\tint x, y;\n\t\t\tcin >> x >> y;\n\t\t\tcout << v[y][x] << endl;\n\t\t}\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "// 2018/12/12 Tazoe\n\n#include <iostream>\nusing namespace std;\n\nint main()\n{\n\twhile(true){\n\t\tint n, m, t, p;\n\t\tcin >> n >> m >> t >> p;\n\n\t\tif(n==0 && m==0 && t==0 && p==0)\n\t\t\tbreak;\n\n\t\tint Ori[64][64] = { {0} };\n\t\tfor(int y=0; y<m; y++){\n\t\t\tfor(int x=0; x<n; x++){\n\t\t\t\tOri[y][x] = 1;\n\t\t\t}\n\t\t}\n\n\t\tfor(int i=0; i<t; i++){\n\t\t\tint d, c;\n\t\t\tcin >> d >> c;\n\n\t\t\tif(d==1){\n\t\t\t\tfor(int x=0; x<c; x++){\n\t\t\t\t\tfor(int y=0; y<m; y++){\n\t\t\t\t\t\tOri[y][2*c-1-x] += Ori[y][x];\n\t\t\t\t\t\tOri[y][x] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor(int x=0; x<n; x++){\n\t\t\t\t\tfor(int y=0; y<m; y++){\n\t\t\t\t\t\tOri[y][x] = Ori[y][x+c];\n\t\t\t\t\t\tOri[y][x+c] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfor(int y=0; y<c; y++){\n\t\t\t\t\tfor(int x=0; x<n; x++){\n\t\t\t\t\t\tOri[2*c-1-y][x] += Ori[y][x];\n\t\t\t\t\t\tOri[y][x] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor(int y=0; y<m; y++){\n\t\t\t\t\tfor(int x=0; x<n; x++){\n\t\t\t\t\t\tOri[y][x] = Ori[y+c][x];\n\t\t\t\t\t\tOri[y+c][x] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n/*\n\t\t\tfor(int y=0; y<m; y++){\n\t\t\t\tfor(int x=0; x<n; x++){\n\t\t\t\t\tcout << Ori[y][x];\n\t\t\t\t}\n\t\t\t\tcout << endl;\n\t\t\t}\n*/\n\t\t}\n\n\t\tfor(int i=0; i<p; i++){\n\t\t\tint x, y;\n\t\t\tcin >> x >> y;\n\n\t\t\tcout << Ori[y][x] << endl;\n\t\t}\n\t}\n\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define r(i,n) for(int i=0;i<n;i++)\n\nusing namespace std;\n\nint a[35][35],w,h,m,q;\n\nint main(){\n  while(cin>>w>>h>>m>>q,h){\n    \n    memset(a,0,sizeof(a));\n\n    r(i,h){\n      r(j,w)a[i][j]=1;\n    }\n\n    r(i,m){//cout<<h<<' '<<w<<endl;\n      int d,c;\n      cin>>d>>c;\n      if(d==1){\n\tint p[35][35]={};\n\tfor(int i=0;i<h;i++){\n\t  for(int j=c-1,k=0;j>=0;j--,k++){\n\t    p[i][k]=a[i][j];\n\t  }\n\t}\n\tfor(int i=0;i<h;i++){\n\t  for(int j=c;j<w;j++){\n\t    a[i][j-c]=a[i][j];\n\t  }\n\t}\n        int W=c;\n\tif(w<=c);\n\telse W=w-c;\n\tr(i,h)for(int j=W;j<w;j++)a[i][j]=0;\n\tw=max(w-c,c);\n\tfor(int i=0;i<h;i++){\n\t  for(int j=0;j<w;j++){\n\t    a[i][j]+=p[i][j];\n\t  }\n\t}\n      }\n      else{\n\tint p[35][35]={};\n\tfor(int i=c-1,k=0;i>=0;i--,k++){\n\t  for(int j=0;j<w;j++){\n\t    p[k][j]=a[i][j];\n\t  }\n\t}\n\tfor(int i=c;i<h;i++){\n\t  for(int j=0;j<w;j++){\n\t    a[i-c][j]=a[i][j];\n\t  }\n\t}\n\tint H=c;\n\tif(h<=c);\n\telse H=h-c;\n\tfor(int i=H;i<h;i++)r(j,w)a[i][j]=0;\n\th=max(h-c,c);\n\tfor(int i=0;i<h;i++){\n\t  for(int j=0;j<w;j++){\n\t    a[i][j]+=p[i][j];\n\t  }\n\t}\n      }\n\n    }\n    int ans=0;\n    r(i,q){\n      int x,y;\n      cin>>x>>y;\n      cout<<a[y][x]<<endl;;\n    }\n    // cout<<ans<<endl;\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std ;\nint bcj[2000] ;\nint father( int x ){\n    return bcj[x] == x ? x : bcj[x] = father( bcj[x] ) ;\n}\nvoid join( int x , int y ){\n    int fx = father( x ) ;\n    int fy = father( y ) ;\n    if ( fx != fy ) bcj[fy] = fx ;\n}\nint calc( int x , int y ){\n    return 32 * x + y ;\n}\nint main(){\n    int n , m , t , p ;\n    while( 1 ){\n          scanf( \"%d%d%d%d\" , &m , &n , &t , &p ) ;\n          if ( n == 0 && m == 0 && t == 0 && p == 0 ) break ;\n          for( int i = 0 ; i < 32 * 32 ; i++ )\n              bcj[i] = i ;\n          while( t-- ){\n                int d , c ;\n                scanf( \"%d%d\" , &d , &c ) ;\n                if ( d == 1 ){\n                    for( int i = m - 1 ; i >= m - c ; i-- ){\n                        int pos = 2 * m - 2 * c - 1 - i ;\n                        for( int j = 0 ; j < n ; j++ ){\n                            int x = calc( j , i ) ;\n                            int y = calc( j , pos ) ;\n                            join( x , y ) ;\n                        }\n                    }\n                    m -= c ;\n                }\n                else{\n                    for( int i = n - 1 ; i >= n - c ; i-- ){\n                        int pos = 2 * n - 2 * c - 1 - i ;\n                        for( int j = 0 ; j < m ; j++ ){\n                            int x = calc( i , j ) ;\n                            int y = calc( pos , j ) ;\n                            join( x , y ) ;\n                        }\n                    }\n                    n -= c ;\n                }\n          }\n          while( p-- ){\n                int x , y ;\n                scanf( \"%d%d\" , &y , &x ) ;\n                x = n - 1 - x ; y = m - 1 - y ;\n                int ans = 0 ;\n                int res = father( calc( x , y ) ) ;\n                for( int i = 0 ; i < 32 * 32 ; i++ ){\n                    int fa = father( i ) ;\n                    if ( res == fa ) ans++ ;\n                }\n                printf( \"%d\\n\" , ans ) ;\n          }\n    }\n    return 0 ;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n  \n#define MAX 500\n  \nusing namespace std;\n \nint main(void){\n    while(1){\n        int w, h, t, p; cin >> w >> h >> t >> p;\n        if(!w && !h && !t && !p) break;\n\n        int kami[MAX][MAX]={0};\n        for(int i=0; i<h; i++){\n            fill(kami[i], kami[i]+w, 1);\n        }\n  \n        int origin_x = 0, origin_y =0;\n        for(int k=0; k<t; k++){\n            int d, c; cin >> d >> c;\n            int dist = 1;\n            if(d == 1){\n                for(int j=origin_x+c; j<origin_x+(2*c); j++){\n                     for(int i=origin_y; i<MAX; i++){\n                        kami[i][j] += kami[i][j-dist];\n                    }\n                    dist += 2;\n                }\n                origin_x += c;\n            } else{\n                for(int i=origin_y+c; i<origin_y+(2*c); i++){\n                    for(int j=origin_x; j<MAX; j++){\n                        kami[i][j] += kami[i-dist][j];\n                    }\n                    dist += 2;\n                }\n                origin_y += c;\n            }\n        }\n          \n        for(int k=0; k<p; k++){\n            int x, y; cin >> x >> y;\n            cout << kami[origin_y+y][origin_x+x] << endl;\n        }\n    }\n  \n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//#include <bits/stdc++.h>\n//using namespace std;\n//const  int maxn=3e5+100;\n//#define INF 0x3f3f3f;\n//const int mod=998244353;\n//typedef  long long ll;\n//int ma[100][100];\n//int main()\n//{\n//    int n,m,t,q;\n//    while(scanf(\"%d%d%d%d\",&n,&m,&t,&q)){\n//        if(n==0 && m==0 && t==0 && q==0)  break;\n//        //cout<<n<<m<<t<<q;\n//        memset(ma,-1,sizeof(ma));\n//        for(int i=0; i<n; i++){\n//            for(int j=0; j<m; j++){\n//                ma[i][j] = 1;\n//            }\n//        }\n//        int x0 = 0,x1 = n-1;\n//        int y0 = 0,y1 = m-1;\n////        for(int i=0; i<=x1; i++){\n////            for(int j=0; j<=y1; j++){\n////                cout<<ma[i][j]<<\"  \";\n////            }\n////            cout<<endl;\n////        }\n//        int u,v;\n//        while(t--){\n//            scanf(\"%d%d\",&u,&v);\n//            if(u==1){\n//                v = v + x0;\n//                for(int i=v; i>x0; i--){\n//                    for(int j=y0; j<=y1; j++){\n//                        ma[v+i-1][j] += ma[v-i][j];\n//                        ma[v-i][j] = 0;\n//                    }\n//                }\n//                x0 = v;\n//            }\n//            else{\n//                v = v + y0;\n//                for(int i=v; i>y0; i--){\n//                    for(int j=x0; j<=x1; j++){\n//                        ma[j][v+i-1] += ma[j][v-i];\n//                        ma[j][v-i] = 0;\n//                    }\n//                }\n//                y0 = v;\n//            }\n//        }\n//        cout<<\"*\"<<x0<<\" \"<<x1<<\" \"<<y0<<\" \"<<y1<<endl;\n//        for(int i=0; i<=x1; i++){\n//            for(int j=0; j<=y1; j++){\n//                cout<<ma[i][j]<<\"  \";\n//            }\n//            cout<<endl;\n//        }\n//        while(q--){\n//            scanf(\"%d%d\",&u,&v);\n//            u = u + x0;\n//            v = v + y0;\n//            printf(\"%d\\n\",ma[u][v]);\n//        }\n//    }\n//    return 0;\n//}\n#include <iostream>\n#include <stdlib.h>\n#include <algorithm>\n#include <vector>\n#include <stdio.h>\nusing namespace std;\ntypedef long long ll;\nint n,m,t,p;\nint type,c;\nint main()\n{\n    while(~scanf(\"%d%d%d%d\",&m,&n,&t,&p)&&(m+n+t+p))\n    {\n        vector<vector<ll> >q(1000);\n        for(int i=0; i<n; i++)\n        {\n            for(int j=0; j<m; j++)\n            {\n                q[i].push_back(1ll);\n            }\n        }\n        while(t--)\n        {\n            scanf(\"%d%d\",&type,&c);\n            if(type==1)\n            {\n                for(int j=0; j<n; j++)\n                {\n                    for(int i=0; i<=c-1; i++)\n                        q[j][2*c-1-i]+=q[j][i];\n                }\n                for(int i=0; i<n; i++)\n                    for(int j=0; j<m-c; j++)\n                        q[i][j]=q[i][j+c];\n            }\n            else if(type==2)\n            {\n                for(int j=0; j<m; j++)\n                    for(int i=0; i<=c-1; i++)\n                    {\n                        q[2*c-1-i][j]+=q[i][j];\n                    }\n                q.erase(q.begin(),q.begin()+c);\n            }\n        }\n        int x,y;\n        //ll ans=0;\n        while(p--)\n        {\n            scanf(\"%d%d\",&x,&y);\n            printf(\"%lld\\n\",q[y][x]);\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define dump(x) cout << (x) << '\\n';\ntypedef int64_t Int;\nInt mod = 1e9+7;\nInt INF = 1e9+18;\n\nint main() {\n    ios::sync_with_stdio(false);   \n    Int w, h, t, p;\n    Int d[30] = {};\n    Int c[30] = {};\n    Int x[50] = {};\n    Int y[50] = {};\n    Int field[50][50] = {};\n    while (true) {\n        cin >> w >> h >> t >> p;\n        Int w1 = 0;\n        Int w2 = w;\n        Int h1 = 0;\n        Int h2 = h;\n        if (w == 0) break;\n        bool rev_w = false;\n        bool rev_h = false;\n        for (Int i = h1; i < h2; i++) {\n            for (Int j = w1; j < w2; j++) {\n                field[i][j] = 1;\n            }\n        }\n        for (Int i = 0; i < t; i++) cin >> d[i] >> c[i];\n        for (Int i = 0; i < p; i++) cin >> x[i] >> y[i];\n        for (Int i = 0; i < t; i++) {\n            if (d[i] == 1) {\n                if (rev_w) c[i] = w2 - w1 - c[i];\n                if (c[i] <= w2 - w1 - c[i]) {\n                    rev_w = false;\n                    w1 += c[i];\n                    for (Int k = h1; k < h2; k++) {\n                        for (Int j = 0; j < c[i]; j++) {\n                            field[k][w1 + j] += field[k][w1 - 1 - j];\n                        }\n                    }\n                }\n                else {\n                    rev_w = true;\n                    Int x = w2 - w1 - c[i];\n                    w2 -= x;\n                    for (Int k = h1; k < h2; k++) {\n                        for (Int j = 0; j < x; j++) {\n                            field[k][w2 - 1 - j] += field[k][w2 + j];\n                        }\n                    }\n                }\n            }\n            else {\n                if (rev_h) c[i] = h2 - h1 - c[i];\n                if (c[i] <= h2 - h1 - c[i]) {                    \n                    rev_h = false;\n                    h2 -= c[i];\n                    for (Int k = w1; k < w2; k++) {\n                        for (Int j = 0; j < c[i]; j++) {\n                            field[h2 - 1 - j][k] += field[h2 + j][k];\n                        }\n                    }\n                }\n                else {\n                    rev_h = true;\n                   //  dump(\"MO\");\n                    Int x = h2 - h1 - c[i];\n                    h1 += x;\n                    for (Int k = w1; k < w2; k++) {\n                        for (Int j = 0; j < x; j++) {\n                            field[h1 + j][k] += field[h1 - 1 - j][k];\n                        }\n                    }\n                }\n            }\n            /* for (Int i = h1; i < h2; i++) {\n                for (Int j = w1; j < w2; j++) {\n                    cout << field[i][j] << \" \";\n                }\n                cout << endl;\n            } */\n        }\n        \n        for (Int i = 0; i < p; i++) {\n            Int a = !rev_h ? h2 - 1 - y[i] : h1 + y[i];\n            Int b = !rev_w ? w1 + x[i] : w2 - 1 - x[i];\n            dump(field[a][b]);\n        }\n       /*  cout << endl;\n        for (Int i = h1; i < h2; i++) {\n            for (Int j = w1; j < w2; j++) {\n                cout << field[i][j] << \" \";\n            }\n            cout << endl;\n        }\n        cout << endl; */\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define syosu(x) fixed<<setprecision(x)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\ntypedef pair<int,int> P;\ntypedef pair<double,double> pdd;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<string> vs;\ntypedef vector<P> vp;\ntypedef vector<vp> vvp;\ntypedef vector<pll> vpll;\ntypedef pair<int,P> pip;\ntypedef vector<pip> vip;\nconst int inf=1<<30;\nconst ll INF=1ll<<60;\nconst double pi=acos(-1);\nconst double eps=1e-11;\nconst ll mod=1e9+7;\nconst int dx[4]={-1,0,1,0},dy[4]={0,-1,0,1};\n\n\nint main(){\n\tios::sync_with_stdio(0);\n\tcin.tie(0);\n\twhile(1){\n\t\tint h,w,n,m;\n\t\tcin>>h>>w>>n>>m;\n\t\tif(h==0) break;\n\t\tvvi a(h,vi(w,1));\n\t\tfor(int i=0;i<n;i++){\n\t\t\tint t,x;\n\t\t\tcin>>t>>x;\n\t\t\tvvi b;\n\t\t\tif(t==1){\n\t\t\t\tb=vvi(max(h-x,x),vi(w));\n\t\t\t\tfor(int j=0;j<h;j++) for(int k=0;k<w;k++){\n\t\t\t\t\tif(j<x) b[x-j-1][k]+=a[j][k];\n\t\t\t\t\telse b[j-x][k]+=a[j][k];\n\t\t\t\t}\n\t\t\t\th=max(h-x,x);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tb=vvi(h,vi(max(w-x,x)));\n\t\t\t\tfor(int j=0;j<h;j++) for(int k=0;k<w;k++){\n\t\t\t\t\tif(k<x) b[j][x-k-1]+=a[j][k];\n\t\t\t\t\telse b[j][k-x]+=a[j][k];\n\t\t\t\t}\n\t\t\t\tw=max(w-x,x);\n\t\t\t}\n\t\t\ta=b;\n\t\t}\n/*\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++) cout<<a[i][j]<<' ';cout<<endl;\n\t\t}*/\n\t\tfor(int i=0;i<m;i++){\n\t\t\tint x,y;\n\t\t\tcin>>x>>y;\n\t\t\tcout<<a[x][y]<<endl;\n\t\t}\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "//author Eterna\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<string>\n#include<cstring>\n#include<vector>\n#include<map>\n#include<set>\n#include<queue>\n#include<stack>\n#include<utility>\n#include<cmath>\n#include<climits>\n#include<deque>\n#include<functional>\n#define max(a,b) (a>b?a:b)\n#define min(a,b) (a<b?a:b)\n#define INF 0x7fffffff\n#define maxn 100000\n#define eps 1e-15\n#define MOD ((int)(1e9+7))\n#define ABS(x) ((x)>=0?(x):(-(x)))\n#define pb(x) push_back(x)\n#define lowbit(x) (x&-x)\n#define mid (L+R)/2\n#define Lson (index*2)\n#define Rson (index*2+1)\nusing namespace std;\ntypedef long long ll;\ninline int read() {\n\tchar c;\n\tint ret = 0, sgn = 1;\n\tdo { c = getchar(); } while ((c < '0' || c > '9') && c != '-');\n\tif (c == '-') sgn = -1; else ret = c - '0';\n\twhile ((c = getchar()) >= '0' && c <= '9') ret = ret * 10 + (c - '0');\n\treturn sgn * ret;\n}\nint arr[100][100], n, m, t, p, o, x, a, b;\nvoid move_left(int x) {\n\tfor (int i = 1; i <= m; i++)\n\t\tfor (int j = 1; j <= max(x, n - x); j++)\n\t\t\tarr[i][j] = arr[i][j + x];\n\tn = max(x, n - x);\n\t/*cout << \"arr\" << endl;\n\tfor (int i = 1; i <= m; i++) {\n\t\tfor (int j = 1; j <= n; j++)cout << arr[i][j] << \" \";\n\t\tcout << endl;\n\t}*/\n}\nvoid move_down(int x) {\n\tfor (int i = 1; i <= n; i++)\n\t\tfor (int j = 1; j <= max(x, m - x); j++)\n\t\t\tarr[j][i] = arr[j + x][i];\n\tm = max(x, m - x);\n/*\tcout << \"arr\" << endl;\n\tfor (int i = 1; i <= m; i++) {\n\t\tfor (int j = 1; j <= n; j++)cout << arr[i][j] << \" \";\n\t\tcout << endl;\n\t}*/\n}\nint main(void)\n{\n\twhile (cin >> n >> m >> t >> p&&n) {\n\t\tmemset(arr, 0, sizeof(arr));\n\t\tfor (int i = 1; i <= m; i++)\n\t\t\tfor (int j = 1; j <= n; j++) arr[i][j] = 1;\n\t\tfor (int i = 1; i <= t; i++) {\n\t\t\tcin >> o >> x;\n\t\t\tif (o == 1) {\n\t\t\t\tfor (int k = 1; k <= m; k++) {\n\t\t\t\t\tfor (int j = 1; j <= x; j++)\n\t\t\t\t\t\tarr[k][2 * x - j + 1] += arr[k][j];\n\t\t\t\t}\n\t\t\t\tmove_left(x);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor (int k = 1; k <= n; k++)\n\t\t\t\t\tfor (int j = 1; j <= x; j++)\n\t\t\t\t\t\tarr[2 * x - j + 1][k] += arr[j][k];\n\t\t\t\tmove_down(x);\n\t\t\t}\n\t\t}\n\t\tfor (int i = 1; i <= p; i++) {\n\t\t\tcin >> a >> b; a++; b++;\n\t\t\tcout << arr[b][a] << endl;\n\t\t}\n\t}\n\t//system(\"pause\");\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\n#define rep(i,n) for(ll i=0; i<(n); i++)\n\nint main(){\n\twhile(1){\n\t\tll m,n,t,p; cin >> m >> n >> t >> p;\n\t\tif(m+n+t+p == 0) break;\n\t\tvector<int> d(t),c(t),x(p),y(p);\n\t\tll idn = 0; ll idm = 0;\n\t\tll backn = n-1; ll backm = m-1;\n\t\tvector<vector<int>> a(1000,vector<int>(1000,0));\n\t\trep(i,n) rep(j,m) a[i][j] = 1;\n\t\trep(z,t){\n\t\t\tcin >> d[z] >> c[z];\n\t\t\tif(d[z] == 1){\n\t\t\t\tfor(ll i=idn; i<=backn; i++){\n\t\t\t\t\tfor(ll j=idm; j<idm+c[z]; j++){\n\t\t\t\t\t\ta[i][idm+2*c[z]-1+(idm-j)] += a[i][j];\n\t\t\t\t\t\tbackm = max(backm, idm+2*c[z]-1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tidm += c[z];\n\t\t\t}else{\n\t\t\t\tfor(ll j=idm; j<=backm; j++){\n\t\t\t\t\tfor(ll i=idn; i<idn+c[z]; i++){\n\t\t\t\t\t\ta[idn+2*c[z]-1+(idn-i)][j] += a[i][j]; \n\t\t\t\t\t\tbackn = max(backn, idn+2*c[z]-1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tidn += c[z];\n\t\t\t}\n\t\t}\n\t\t/*rep(i,6){\n\t\t\trep(j,6) cout << a[i][j] << \" \";\n\t\t\tcout << \"\\n\";\n\t\t}\n\t\tcout << idm << \" \" << idn << \"\\n\";*/\n\t\trep(i,p){\n\t\t\tcin >> x[i] >> y[i];\n\t\t\tx[i] = x[i] + idm;\n\t\t\ty[i] = y[i] + idn;\n\t\t\tcout << a[y[i]][x[i]] << \"\\n\";\n\t\t}\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for(int i = 0;i < (int)n;i++)\n#define repb(i,n) for(int i = (int)n;i >= 0;i--)\n#define reps(i,m,n) for(int i = (int)m;i < (int)n;i++)\n#define repsb(i,m,n) for(int i = (int)m;i >= (int)n;i--)\n#define SORT(v,n) sort(v,v+n);\n#define VSORT(v) sort(v.begin(), v.end());\n#define pb(a) push_back(a)\n#define INF 999999999999999999\n#define ll long long int\nint dy[]={0, 0, 1, -1, 0};\nint dx[]={1, -1, 0, 0, 0};\ntemplate<class T>bool chmax(T &a, const T &b) { if (a<b) { a = b; return 1; } return 0; }\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a = b; return 1;} return 0;}\n//vector<vector<int>> vec(n_rows, vector<int>(n_cols, value));\nusing namespace std;\nint main(int argc, char const *argv[]) {\n    int n,m,t,p;\n    int tmp[2][101][101];\n    while (cin >> n >> m >> t >> p, n || m || t || p)\n    {\n        rep(i,2){\n            rep(j,101){\n                rep(k,101){\n                    tmp[i][j][k] = 0;\n                }\n            }\n        }\n        rep(y,m){\n            rep(x,n){\n                tmp[0][y][x] = 1;\n            }\n        }\n        int d, c;\n        rep(i,t){\n            cin >> d >> c;\n            rep(y,101){\n                rep(x,101){\n                    tmp[(i + 1) % 2][y][x] = 0;\n                }\n            }\n            if(d==1){\n                rep(y, m)\n                {\n                    rep(x, n)\n                    {\n                        tmp[(i + 1) % 2][y][x] = tmp[i % 2][y][x+c];\n                    }\n                }\n                rep(x,c){\n                    rep(y,m){\n                        tmp[(i + 1) % 2][y][x] += tmp[i % 2][y][c-x-1];\n                    }\n                }\n            }\n            else{\n                rep(y, m)\n                {\n                    rep(x, n)\n                    {\n                        tmp[(i + 1) % 2][y][x] = tmp[i % 2][y+c][x];\n                    }\n                }\n                rep(x, n)\n                {\n                    rep(y, c)\n                    {\n                        tmp[(i + 1) % 2][y][x] += tmp[i % 2][c-y-1][x];\n                    }\n                }\n            }\n\n        }\n        int x, y;\n        rep(i,p){\n            cin >> x >> y;\n            cout <<tmp[t%2][y][x] << endl;\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <complex>\n#include <string>\n#include <vector>\n#include <array>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <limits>\n#include <climits>\n#include <cfloat>\n#include <functional>\n#include <iterator>\n#include <memory>\n#include <regex>\nusing namespace std;\n\nint main()\n{\n    for(;;){\n        int w, h, t, p;\n        cin >> w >> h >> t >> p;\n        if(w == 0)\n            return 0;\n\n        vector<vector<int> > v(h, vector<int>(w, 1));\n        while(--t >= 0){\n            int d, c;\n            cin >> d >> c;\n\n            int h2 = h;\n            int w2 = w;\n            int cy = 0;\n            int cx = 0;\n            if(d == 1){\n                w2 = max(c, w - c);\n                cx = c;\n            }\n            else{\n                h2 = max(c, h - c);\n                cy = c;\n            }\n\n            vector<vector<int> > v2(h2, vector<int>(w2, 0));\n            for(int y=0; y<h; ++y){\n                for(int x=0; x<w; ++x){\n                    int y2 = abs(y * 2 - cy * 2 + 1) / 2;\n                    int x2 = abs(x * 2 - cx * 2 + 1) / 2;\n                    v2[y2][x2] += v[y][x];\n                }\n            }\n            v = move(v2);\n            h = h2;\n            w = w2;\n        }\n\n        while(--p >= 0){\n            int x, y;\n            cin >> x >> y;\n            cout << v[y][x] << endl;\n        }\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define min(a,b) ((a)<(b)?(a):(b))\n#define max(a,b) ((a)>(b)?(a):(b))\n#define REP(i,n) for(int i=0;i<n;i++)\n#define FOR(i,n1,n2) for(int i=n1;i<n2;i++)\n#define speed_up    ios_base::sync_with_stdio(false); cin.tie(0); cout.tie(0);\n\ntypedef long long int ll;\ntypedef pair<ll,ll> Pi;\nconst int INF=(ll)(1LL<<31)-1;\nconst ll INFl=(ll)9223372036854775807;\nconst int MAX=10000;\nconst ll MOD=(ll)1e9+7;\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a, b)*b;}\n//int dx[4]={1,0,-1,0},dy[4]={0,1,0,-1};\n\ntemplate<typename A, size_t N, typename T>\nvoid Fill(A (&array)[N], const T &val){\n    std::fill( (T*)array, (T*)(array+N), val );\n}\n\nint n,m,t,p;\nint a[70][70];\nint main(){\n\twhile(1){\n\t\t\n\t\tcin>>n>>m>>t>>p;\n\t\tif(n==0&&m==0&&t==0&&p==0)break;\n\t\tint nh=m,nw=n;\n\t\tfor(int i=0;i<m;i++){\n\t\t\tfor(int j=0;j<n;j++){\n\t\t\t\ta[i][j]=1;\n\t\t\t}\n\t\t}\n\t\tfor(int ppp=0;ppp<t;ppp++){\n\t\t\tint d,s;\n\t\t\tcin>>d>>s;\n\t\t\tif(d==1){\n\t\t\t\tif(s<=nw-s){\n\t\t\t\t\tfor(int i=1;i<=s;i++){\n\t\t\t\t\t\tfor(int j=0;j<nh;j++){\n\t\t\t\t\t\t\ta[j][s+i-1]+=a[j][s-i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfor(int i=0;i<nw-s;i++){\n\t\t\t\t\t\tfor(int j=0;j<nh;j++){\n\t\t\t\t\t\t\ta[j][i]=a[j][i+s];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tnw=nw-s;\n\t\t\t\t}else{\n\t\t\t\t\tfor(int j=0;j<nh;j++){\n\t\t\t\t\t\tfor(int i=1;s+i-1<nw;i++){\n\t\t\t\t\t\t\ta[j][s+i-1]+=a[j][s-i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(int i=2*s-nw-1;i>=0;i--){\n\t\t\t\t\t\t\ta[j][nw+(2*s-nw-1-i)]=a[j][i];\n\t\t\t\t\t\t}\t\n\t\t\t\t\t}\n\t\t\t\t\tfor(int i=0;i<s;i++){\n\t\t\t\t\t\tfor(int j=0;j<nh;j++){\n\t\t\t\t\t\t\ta[j][i]=a[j][s+i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tnw=s;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(s<=nh-s){\n\t\t\t\t\tfor(int i=1;i<=s;i++){\n\t\t\t\t\t\tfor(int j=0;j<nw;j++){\n\t\t\t\t\t\t\ta[s+i-1][j]+=a[s-i][j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfor(int i=0;i<nh-s;i++){\n\t\t\t\t\t\tfor(int j=0;j<nw;j++){\n\t\t\t\t\t\t\ta[i][j]=a[i+s][j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tnh=nh-s;\n\t\t\t\t}else{\n\t\t\t\t\tfor(int j=0;j<nw;j++){\n\t\t\t\t\t\tfor(int i=1;s+i-1<nh;i++){\n\t\t\t\t\t\t\ta[s+i-1][j]+=a[s-i][j];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor(int i=2*s-nh-1;i>=0;i--){\n\t\t\t\t\t\t\ta[nh+(2*s-nh-1-i)][j]=a[i][j];\n\t\t\t\t\t\t}\t\n\t\t\t\t\t}\n\t\t\t\t\tfor(int i=0;i<s;i++){\n\t\t\t\t\t\tfor(int j=0;j<nw;j++)\n\t\t\t\t\t\ta[i][j]=a[s+i][j];\n\t\t\t\t\t}\n\t\t\t\t\tnh=s;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\n\n\t\t\t\n\t\t}\n\t\t\t/*for(int i=0;i<nh;i++){\n\t\t\t\tfor(int j=0;j<nw;j++){\n\t\t\t\t\tcout<<a[i][j];\n\t\t\t\t}\n\t\t\t\tcout<<endl;\n\t\t\t}*/\n\t\t\tint ans=0;\n\t\t\tfor(int i=0;i<p;i++){\n\t\t\t\tint xx,yy;\n\t\t\t\tcin>>xx>>yy;\n\t\t\t\tcout<<a[yy][xx]<<endl;\n\t\t\t}\n\t\t\n\n\t\t\n\t}\n\treturn 0;\n}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\t\n\n\t\t\t\t\t\n\t\t\t\t\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<b;i++)\n#define rrep(i,a,b) for(int i=a;i>=b;i--)\n#define fore(i,a) for(auto &i:a)\n#define all(x) (x).begin(),(x).end()\nusing namespace std; void _main(); int main() { cin.tie(0); ios::sync_with_stdio(false); _main(); }\ntypedef long long ll; const int inf = INT_MAX / 2; const ll infl = 1LL << 60;\ntemplate<class T>bool chmax(T &a, const T &b) { if (a<b) { a = b; return 1; } return 0; }\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a = b; return 1; } return 0; }\n\nint W, H, T, P;\nint A[2][101][101];\n//---------------------------------------------------------------------------------------------------\nvoid _main() {\n    while (cin >> W >> H >> T >> P) {\n        if (W == 0) return;\n        \n        rep(t, 0, 2) rep(y, 0, 101) rep(x, 0, 101) A[t][y][x] = 0;\n        rep(y, 0, H) rep(x, 0, W) A[0][y][x] = 1;\n\n        rep(t, 0, T) {\n            int d, c; cin >> d >> c;\n            rep(y, 0, 101) rep(x, 0, 101) A[(t + 1) % 2][y][x] = 0;\n\n            if (d == 1) {\n                rep(y, 0, H) rep(x, 0, W) A[(t + 1) % 2][y][x] = A[t % 2][y][x + c];\n                rep(x, 0, c) rep(y, 0, H) A[(t + 1) % 2][y][x] += A[t % 2][y][c - 1 - x];\n            } else {\n                rep(y, 0, H) rep(x, 0, W) A[(t + 1) % 2][y][x] = A[t % 2][y + c][x];\n                rep(x, 0, W) rep(y, 0, c) A[(t + 1) % 2][y][x] += A[t % 2][c - 1 - y][x];\n            }\n        }\n\n        rep(p, 0, P) {\n            int x, y; cin >> x >> y;\n            printf(\"%d\\n\", A[T % 2][y][x]);\n        }\n    }\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i, n) for (int i = 0; i < n; i++)\n#define ALL(obj) obj.begin(), obj.end()\n\nconst int iINF = 1e9;\nconst long long llINF = 1e18;\nconst int MOD = 1e9 + 7;\n\nusing namespace std;\n\ntemplate <typename T>\nint getFormer(const vector<T> &vec, T x) {\n    return upper_bound(vec.begin(), vec.end(), x) - vec.begin() - 1;\n}\n\ntemplate <typename T>\nint getLatter(const vector<T> &vec, T x) {\n    return lower_bound(vec.begin(), vec.end(), x) - vec.begin();\n}\n\nvoid solve(int n, int m, int t, int p) {\n    vector<int> d(t), c(t), _x(p), _y(p);\n    vector<vector<int>> before(m, vector<int>(n, 1)), after;\n    REP(i, t) {\n        int d, c;\n        cin >> d >> c;\n        if (d == 1) {\n            int _n = max(n - c, c);\n            after = vector<vector<int>> (m, vector<int> (_n));\n            REP(y, m) {\n                REP(x, n - c) {\n                    after[y][x] = before[y][x + c];\n                }\n            }\n\n            REP(y, m) {\n                REP(x, c) {\n                    after[y][c - x - 1] += before[y][x];\n                }\n            }\n            n = _n;\n        } else {\n            int _m = max(m - c, c);\n            after = vector<vector<int>> (_m, vector<int> (n));\n            REP(x, n) {\n                REP(y, m - c) {\n                    after[y][x] = before[y + c][x];\n                }\n            }\n\n            REP(x, n) {\n                REP(y, c) {\n                    after[c - y - 1][x] += before[y][x];\n                }\n            }\n            m = _m;\n        }\n        before = after;\n    }\n\n    REP(i, p) {\n        int x, y;\n        cin >> x >> y;\n        cout << before[y][x] << endl;\n    }\n}\n\nint main() {\n    int n, m, t, p;\n    while(cin >> n>> m >> t >> p && n) {\n        solve(n, m, t, p);\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nlong long l[10000],r[10000],x1,x2,y1,y2,m,n,t,p,d[10000],c[10000],a[300][300],b[300][300],x,y;\nint main()\n{\nwhile (1)\n{\n    scanf(\"%lld%lld%lld%lld\",&n,&m,&t,&p);\n    if (n==0&&m==0&&t==0&&p==0) break;\n    x1=32; y1=32; x2=31+m; y2=31+n;\n    memset(a,0,sizeof(a));\n    for (int i=32;i<=m+31;i++)\n        for (int j=32;j<=n+31;j++)\n        a[i][j]=1;\n    for (int k=1;k<=t;k++)\n    {\n        scanf(\"%lld%lld\",&d[k],&c[k]);\n        if (d[k]==2)\n        {\n          for (int i=x2-c[k]+1;i<=x2;i++)\n          for (int j=32;j<=y2;j++)\n          {\n              a[2*(x2-c[k])+1-i][j]+=a[i][j];\n              a[i][j]=0;\n          }\n          x1=min(x1,x2-2*c[k]+1);\n          x2=x2-c[k];\n          x=31;\n          for (int i=x1;i<=x2;i++)\n          {\n              x++;\n              y=31;\n              for (int j=y1;j<=y2;j++)\n              b[x][++y]=a[i][j];\n          }\n          memset(a,0,sizeof(a));\n          for (int i=32;i<=x;i++)\n          for (int j=32;j<=y;j++)\n            a[i][j]=b[i][j];\n          x1=32; y1=32;\n          x2=x; y2=y;\n        } else\n        if (d[k]==1)\n        {\n          c[k]+=31;\n          for (int i=32;i<=x2;i++)\n          for (int j=32;j<=c[k];j++)\n          {\n              a[i][2*c[k]+1-j]+=a[i][j];\n              a[i][j]=0;\n          }\n          y2=max(y2,2*c[k]-31);\n          y1=c[k]+1;\n          x=31;\n          for (int i=x1;i<=x2;i++)\n          {\n              x++;\n              y=31;\n              for (int j=y1;j<=y2;j++)\n              b[x][++y]=a[i][j];\n          }\n          memset(a,0,sizeof(a));\n          for (int i=32;i<=x;i++)\n          for (int j=32;j<=y;j++)\n            a[i][j]=b[i][j];\n          x1=32; y1=32;\n          x2=x; y2=y;\n        }\n    }\n   for (int k=1;k<=p;k++)\n   {\n       scanf(\"%lld%lld\",&l[k],&r[k]);\n       l[k]+=32;\n       printf(\"%lld\\n\",a[x2-r[k]][l[k]]);\n   }\n}\n    return(0);\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define LL long long\n#define REP(i,n) for(int i=0;i<(n);++i)\n#define REPA(i,n) for(int i=1;i<(n);++i)\n#define PII pair<int,int>\n#define PLI pair<long long, int>\n#define PLL pair<long long, long long>\n#define PDD pair<double, double>\n#define MOD ((int)1e9 + 7)\n#define INF ((int)2e9)\n#define INFLL ((LL)2e18)\n#define ALL(x) (x).begin(),(x).end()\n#define ctoi(x) (x - 'a') \n#define CTOI(x) (x - 'A')\n#define BIT(x) (2 << (x))\nusing namespace std;\n\nsigned  main(){\n    int n, m, t, p;\n    while(cin>>n>>m>>t>>p&&n){\n        vector<vector<int> > paper(n, vector<int>(m, 1));\n        REP(i, t){\n            int d, c;\n            cin >> d >> c;\n            if(d==1){\n                vector<vector<int> > newpaper(max((int)paper.size()-c, c), vector<int>((int)paper.front().size(), 0));\n                REP(y, paper.front().size()){\n                    REP(j, c){\n                        newpaper[j][y]+=paper[c-j-1][y];\n                    }\n                    REP(j, paper.size()-c){\n                        newpaper[j][y]+=paper[j+c][y];\n                    }\n                }\n                paper=newpaper;\n            }else{\n                vector<vector<int> > newpaper(paper.size(), vector<int>(max((int)paper.front().size()-c, c), 0));\n                REP(x, paper.size()){\n                    REP(j, c+1){\n                        newpaper[x][j]+=paper[x][c-j-1];\n                    }\n                    REP(j, paper.front().size()-c){\n                        newpaper[x][j]+=paper[x][j+c];\n                    }\n                }\n                paper=newpaper;\n            }\n        }\n        REP(i, p){\n            int x, y;\n            cin >> x >> y;\n            cout << paper[x][y] << endl;\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int maxn=1000+7;\nint n,m,t,p;\nstruct node\n{\n    int x,y;\n}order[25],hole[25];\nint pic[40][40];\nint main()\n{\n    while (scanf(\"%d%d%d%d\",&n,&m,&t,&p))\n    {\n        int nowx=n,nowy=m;\n        if(n==0&&m==0&&t==0&&p==0)\n            break;\n        memset(pic,0,sizeof(pic));\n        for(int i=0;i<n;i++)\n           for(int j=0;j<m;j++)\n              pic[j][i]=1;\n        //初始化\n        for(int i=1;i<=t;i++)\n            scanf(\"%d%d\",&order[i].x,&order[i].y);\n        for(int i=1;i<=p;i++)\n            scanf(\"%d%d\",&hole[i].x,&hole[i].y);\n        for(int i=1;i<=t;i++) //处理指令\n        {\n            int d=order[i].x , c=order[i].y;\n            if(d==1)\n             {\n               //修改\n                for(int i=0;i<m;i++)\n                {\n                    for(int j=0;j<c;j++)\n                    {\n                        pic[i][2*c-1-j]+=pic[i][j];\n                    }\n                }\n                for(int i=0;i<m;i++)\n                    for(int j=0;j<n;j++)\n                       {\n                          pic[i][j]=pic[i][j+c];\n                          if(pic[i][j]==0)\n                            pic[i][j]=1;\n                       }\n             }\n            else\n              {\n                //修改\n                for(int j=0;j<n;j++)\n                {\n                    for(int i=0;i<c;i++)\n                    {\n                        pic[2*c-1-i][j]+=pic[i][j];\n                    }\n                }\n\n                for(int i=0;i<m;i++)\n                {\n                    for(int j=0;j<n;j++)\n                        {\n                            pic[i][j]=pic[i+c][j];\n                            if(pic[i][j]==0)\n                               pic[i][j]=1;\n                        }\n                }\n\n              }\n          /*\n              cout<<endl<<endl;\n            for(int i=0;i<m;i++)\n            {\n                for(int j=0;j<n;j++)\n                   cout<<pic[i][j]<<\" \";\n                cout<<endl;\n            }\n            cout<<endl<<endl;\n       */\n\n        }\n        for(int i=1;i<=p;i++)\n         {\n            int x=hole[i].x , y=hole[i].y;\n            printf(\"%d\\n\",pic[y][x]);\n         }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int maxn = 10000;\nint row[maxn], col[maxn];\n\nint main()\n{\n//    ios_base::sync_with_stdio(false),cin.tie(0),cout.tie(0);\n    //freopen(\"B1.txt\",\"r\",stdin);\n    int n, m, t, p;\n    while( scanf(\"%d%d%d%d\",&n,&m,&t,&p) && n )\n    {\n        memset(row,0,sizeof(row)), memset(col,0,sizeof(col));\n        for(int i = 0; i < n; ++i)\n            col[i] = 1;\n        for(int i = 0; i < m; ++i)\n            row[i] = 1;\n\n        int tx = 0, ty = 0;\n        int d, c;\n        for(int i = 0; i < t; ++i)\n        {\n            scanf(\"%d%d\",&d,&c);\n\n            if(d == 1)\n            {\n\n                for(int j = tx + c; j < tx + 2 * c; ++j)\n                    col[j] += col[2*tx+2*c-1-j];\n                tx += c;\n            }\n            else//向下翻折\n            {\n\n                for(int j = ty + c; j < ty + 2 * c; ++j)\n                    row[j] += row[2*ty+2*c-1-j];\n                ty += c;\n            }\n        }\n\n        int x, y;\n        for(int i = 0; i < p; ++i)\n        {\n            scanf(\"%d%d\",&x,&y);\n            printf(\"%d\\n\",row[ty+y] * col[tx+x]);\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main() {\n  int n, m, t, p;\n  while (cin >> n >> m >> t >> p, n) {\n    vector<vector<int>> g(n * n, vector<int>(m * m, 0));\n    for (int i = 0; i < n; i++) {\n      for (int j = 0; j < m; j++) {\n        g[i][j] = 1;\n      }\n    }\n    int px = 0, py = 0;\n\n    for (int i = 0; i < t; i++) {\n      int d, c;\n      cin >> d >> c, d--;\n      if (d) {\n        py += c;\n        for (int j = 0; j < c; j++) {\n          for (int i = 0; i < n * n; i++) {\n            g[i][py + j] += g[i][py - j - 1];\n          }\n        }\n      } else {\n        px += c;\n        for (int i = 0; i < c; i++) {\n          for (int j = 0; j < m * m; j++) {\n            g[px + i][j] += g[px - i - 1][j];\n          }\n        }\n      }  \n    }\n\n    for (int i = 0; i < p; i++) {\n      int x, y;\n      cin >> x >> y;\n      cout << g[px + x][py + y] << endl;\n    }\n\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define MOD 1000000007\ntypedef long long ll;\nusing namespace std;\n\nint N,M,T,P;\n\nvoid solve(){\n    vector<int> d(T),c(T);\n    vector<int> x(P),y(P);\n    for(int i=0;i<T;i++) cin>>d[i]>>c[i];\n    for(int i=0;i<P;i++) cin>>x[i]>>y[i];\n\n    int num[50][50]={};\n    for(int i=0;i<M;i++) for(int j=0;j<N;j++) num[i][j]=1;\n    int h=M,w=N;\n    for(int i=0;i<T;i++){\n        int nex[50][50]={};\n        int nh,nw;\n        if(d[i]==1){\n            nh=h;\n            nw=max(c[i],w-c[i]);\n            for(int j=0;j<nh;j++){\n                for(int k=c[i];k<w;k++){\n                    nex[j][k-c[i]]+=num[j][k];\n                }\n            }\n            for(int j=0;j<nh;j++){\n                for(int k=0;k<c[i];k++){\n                    nex[j][c[i]-1-k]+=num[j][k];\n                }\n            }\n        }else{\n            nh=max(c[i],h-c[i]);\n            nw=w;\n            for(int j=c[i];j<h;j++){\n                for(int k=0;k<nw;k++){\n                    nex[j-c[i]][k]+=num[j][k];\n                }\n            }\n            for(int j=0;j<c[i];j++){\n                for(int k=0;k<nw;k++){\n                    nex[c[i]-1-j][k]+=num[j][k];\n                }\n            }\n        }\n\n        for(int j=0;j<nh;j++){\n            for(int k=0;k<nw;k++){\n                num[j][k]=nex[j][k];\n            }\n        }\n        h=nh;\n        w=nw;\n    }\n\n    for(int i=0;i<P;i++){\n        cout<<num[y[i]][x[i]]<<endl;\n    }\n}\n\nint main(){\n  while(1){\n      cin>>N>>M>>T>>P;\n      if(N==0) break;\n      solve();\n  }\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "/*  -*- coding: utf-8 -*-\n *\n * 1625.cc: Origami, or the art of folding paper\n */\n\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<iostream>\n#include<string>\n#include<vector>\n#include<map>\n#include<set>\n#include<stack>\n#include<list>\n#include<queue>\n#include<deque>\n#include<algorithm>\n#include<numeric>\n#include<utility>\n#include<complex>\n#include<functional>\n \nusing namespace std;\n\n/* constant */\n\nconst int MAX_H = 32;\nconst int MAX_W = 32;\n\n/* typedef */\n\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef pair<int,int> pii;\n\n/* global variables */\n\nint cs[2][MAX_H][MAX_W];\n\n/* subroutines */\n\n/* main */\n\nint main() {\n  for (int w, h, t, p;\n       scanf(\"%d%d%d%d\", &w, &h, &t, &p) == 4 && w > 0;) {\n\n    for (int y = 0; y < h; y++) fill(cs[0][y], cs[0][y] + w, 1);\n    int cur = 0, nxt = 1;\n\n    while (t--) {\n      int di, ci;\n      scanf(\"%d%d\", &di, &ci);\n\n      memset(cs[nxt], 0, sizeof(cs[nxt]));\n      if (di == 1) {\n\tfor (int y = 0; y < h; y++)\n\t  for (int x = 0; x < w; x++) {\n\t    if (x < ci) cs[nxt][y][ci - x - 1] += cs[cur][y][x];\n\t    else cs[nxt][y][x - ci] += cs[cur][y][x];\n\t  }\n\tw = max(ci, w - ci);\n      }\n      else {\n\tfor (int x = 0; x < w; x++)\n\t  for (int y = 0; y < h; y++) {\n\t    if (y < ci) cs[nxt][ci - y - 1][x] += cs[cur][y][x];\n\t    else cs[nxt][y - ci][x] += cs[cur][y][x];\n\t  }\n\th = max(ci, h - ci);\n      }\n\n      swap(cur, nxt);\n    }\n\n    while (p--) {\n      int px, py;\n      scanf(\"%d%d\", &px, &py);\n      printf(\"%d\\n\", cs[cur][py][px]);\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint solve(){\n    int n, m, t, p;\n    cin >> n >> m >> t >> p;\n    if(n == 0) return 1;\n    vector<vector<int> > cnt(m, vector<int>(n,1));\n    for(;t>0;t--){\n        int d, c;\n        cin >> d >> c;\n        if(d==2){\n            vector<vector<int> > tmp(n, vector<int>(m));\n            for(int i=0;i<m;i++){\n                for(int j=0;j<n;j++){\n                    tmp[j][i] = cnt[i][j];\n                }\n            }\n            cnt = tmp;\n            swap(m,n);\n        }\n        for(int i=0;i<m;i++){\n            cnt[i].resize(max(n,c*2));\n            for(int j=0;j<c;j++){\n                cnt[i][c+j] += cnt[i][c-1-j];\n            }\n            cnt[i].erase(cnt[i].begin(), cnt[i].begin()+c);\n        }\n        n = cnt[0].size();\n        if(d==2){\n            vector<vector<int> > tmp(n, vector<int>(m));\n            for(int i=0;i<m;i++){\n                for(int j=0;j<n;j++){\n                    tmp[j][i] = cnt[i][j];\n                }\n            }\n            cnt = tmp;\n            swap(m,n);\n        }\n    }\n    for(;p>0;p--){\n        int x, y;\n        cin >> x >> y;\n        cout << cnt[y][x] << endl;\n    }\n\n    return 0;\n}\n\nint main(){\n    while(solve()==0);\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n\nusing namespace std;\n\nint n, m, t, p, k;\nint a[1000][1000];\n\nint main()\n{\n    while(scanf(\"%d%d%d%d\", &n, &m, &t, &p)){\n        if(n == 0){\n            return 0;\n        }\n        memset(a, 0, sizeof(a));\n        int nr = n + 500;\n        int mr = m + 500;\n        int nl = 501;\n        int ml = 501;\n        for(int i = 501; i <= nr; i++){\n            for(int j = 501; j <= mr; j++){\n                a[i][j] = 1;\n            }\n        }\n        int d, c;\n        for(int i = 0; i < t; i++){\n            scanf(\"%d %d\", &d, &c);\n            if(d == 1){\n                nr -= c;\n                for(int j = 0; j < c; j++){\n                    for(k = ml; k <= mr; k++){\n                        a[nr-j][k] += a[nr+j+1][k];\n                        //a[nr+j+1][k] = 0;\n                    }\n                }\n                if(nl > (nr - c)){\n                    nl = (nr - c);\n                }\n                //nl = min(nl, nr - c);\n            }\n            else{\n                mr -= c;\n                for(int j = 0; j < c; j++){\n                    for(k = nl; k <= nr; k++){\n                        a[k][mr-j] += a[k][mr+j+1];\n                        //a[k][mr+j+1] = 0;\n                    }\n                }\n                if(ml > (mr - c)){\n                    ml = (mr - c);\n                }\n                //ml = min(ml, mr - c);\n            }\n        }\n        int x, y;\n        for(int i = 0; i < p; i++){\n            scanf(\"%d %d\", &x, &y);\n            printf(\"%d\\n\", a[nr-x][mr-y]);\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing ll = long long;\nusing Pi = pair<int, int>;\nusing Pl = pair<ll, ll>;\nusing vint = vector<int>;\nusing vvint = vector<vint>;\nusing vvvint = vector<vvint>;\nusing vdouble = vector<double>;\nusing vvdouble = vector<vdouble>;\nusing vvvdouble = vector<vvdouble>;\nusing vll = vector<ll>;\nusing vvll = vector<vll>;\nusing vvvll = vector<vvll>;\nusing uint = unsigned int;\nusing ull = unsigned long long;\n\ntemplate<typename T> using uset = unordered_set<T>;\ntemplate<typename T1, typename T2> using umap = unordered_map<T1, T2>;\n\nconstexpr int INF = (1 << 30) - 1;\nconstexpr ll LLINF = 1LL << 60;\nconstexpr int dy[] = {1, 0, -1, 0, 1, -1, -1, 1};\nconstexpr int dx[] = {0, 1, 0, -1, 1, 1, -1, -1};\nconstexpr char el = '\\n';\nconstexpr int mod = 1000000007;\n\ntemplate<typename T> T gcd(T a, T b) { return (b ? gcd(b, a % b) : a); }\ntemplate<typename T> T lcm(T a, T b) { return (a / gcd(a, b) * b); }\ntemplate<typename T1, typename T2>\ninline bool chmin(T1 &a, T2 b) { return (a > b && (a = b, true)); }\ntemplate<typename T1, typename T2>\ninline bool chmax(T1 &a, T2 b) { return (a < b && (a = b, true)); }\n\ntemplate<typename T>\nostream& operator <<(ostream &os, vector<T> &v) {\n\tos << v[0];\n\tfor (int i = 1; i < v.size(); i++) os << \" \" << v[i];\n\treturn (os);\n}\n\ntemplate<typename T>\nistream& operator >>(istream &is, vector<T> &v) {\n\tfor (auto &u : v) is >> u; return (is);\n}\n\ntemplate<typename T1, typename T2>\nistream& operator >>(istream &is, pair<T1, T2> &p) {\n\treturn (is >> p.first >> p.second);\n}\n\nbool solve() {\n\tint W, H, T, P; cin >> W >> H >> T >> P;\n\tif (!W && !H && !T && !P) return (false);\n\n\tint ofx = 0, ofy = 0;\n\tvvint paper(1000, vint(1000, 0));\n\tfor (int i = 0; i < H; i++) {\n\t\tfor (int j = 0; j < W; j++) {\n\t\t\tpaper[i][j] = 1;\n\t\t}\n\t}\n\n\twhile (T--) {\n\t\tint d, c; cin >> d >> c;\n\t\tif (d == 1) {\n\t\t\tchmax(W, ofx+2*c);\n\t\t\tfor (int i = ofy; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < c; j++) {\n\t\t\t\t\tpaper[i][ofx+2*c-j-1] += paper[i][ofx+j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tofx += c;\n\t\t}\n\t\tif (d == 2) {\n\t\t\tchmax(H, ofy+2*c);\n\t\t\tfor (int i = 0; i < c; i++) {\n\t\t\t\tfor (int j = ofx; j < W; j++) {\n\t\t\t\t\tpaper[ofy+2*c-i-1][j] += paper[ofy+i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tofy += c;\n\t\t}\n\t\t/*\n\t\tfor (int i = ofy; i < H; i++) {\n\t\t\tfor (int j = ofx; j < W; j++) {\n\t\t\t\tcout << paper[i][j] << \" \";\n\t\t\t}\n\t\t\tcout << endl;\n\t\t}\n\t\tcout << endl;\n\t\t*/\n\t}\n\n\twhile (P--) {\n\t\tint x, y;\n\t\tcin >> x >> y;\n\t\t//cout << ofy << \" \" << endl;\n\t\tcout << paper[y+ofy][x+ofx] << endl;\n\t}\n\n\treturn (true);\n}\n\nvoid Main() {\n\twhile (solve());\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(0);\n\tcout << fixed << setprecision(20);\n\tMain();\n\treturn (0);\n}\n\n"
  },
  {
    "language": "C++",
    "code": "//#include <bits/stdc++.h>\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n\nusing namespace std;\n\nint sum[600][600] = {};\n\nint solve(){\n  int h, w, n, m;\n\n  memset(sum, 0, sizeof(sum));\n  \n  scanf(\"%d%d%d%d\", &w, &h, &n, &m);\n\n  if(!h)return false;\n  \n  for(int i=0;i<h;i++)\n    for(int j=0;j<w;j++)\n      sum[i][j] = 1;\n\n  int l = 0, u = 0;\n\n  for(int i=0;i<n;i++){\n    int d, c;\n\n    scanf(\"%d%d\", &d, &c);\n    \n    if(d == 1){\n      c += l;\n      for(int j=l;j<c;j++){\n        for(int k=u;k<u+32;k++){\n          sum[k][c+(c-j-1)] += sum[k][j];\n          sum[k][j] = 0;\n        }\n      }\n    }else{\n      c += u;\n      for(int j=u;j<c;j++){\n        for(int k=l;k<l+32;k++){\n          sum[c+(c-j-1)][k] += sum[j][k];\n          sum[j][k] = 0;\n        }\n      }\n    }\n\n    int l2 = l, u2 = u;\n    \n    l = -1;\n    for(int i=u2;i<u2+32;i++){\n      for(int j=l2;j<l2+32;j++){\n        if(sum[i][j]){\n          l = j; u = i;\n          break;\n        }\n      }\n      if(l != -1) break;\n    }\n  }\n\n\n  assert(l != -1);\n  \n  for(int i=0;i<m;i++){\n    int x, y;\n\n    scanf(\"%d%d\", &x, &y);\n\n    printf(\"%d\\n\", sum[y+u][x+l]);\n  }\n\n  return 1;\n}\n\nint main(){\n  while(solve());\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define FOR(i,a,b) for(int i = (a); i < (b); ++i)\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define all(x) (x).begin(),(x).end()\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v; return v;}\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector< vector<int> > Mat;\ntypedef tuple<int, int, int, int> T;\n\nconst int MOD = (int)1e9+7;\nconst int INF = (int)1e9;\nconst int dx[] = {0, 1, 0, -1};\nconst int dy[] = {1, 0, -1, 0};\nconst int ddx[] = {0, 1, 1, 1, 0, -1, -1, -1};\nconst int ddy[] = {1, 1, 0, -1, -1, -1, 0, 1};\n\nint main(){\n    ios::sync_with_stdio(false);\n\tcin.tie(0);\n\n    int n, m, t, p;\n    while(1){\n        cin >> n >> m >> t >> p;\n\n        if(n+m+t+p == 0) break;\n        vector< vector<int> > paper((m+1)*2, vector<int>((n+1)*2, 0));\n        int ox = 0, oy = 0, dx = n, dy = m;\n        rep(i, m) rep(j, n) paper[i][j] += 1;\n        \n        rep(_, t){\n            int d, c;\n            cin >> d >> c;\n            if(d == 1){\n                dx = max(dx, ox+(c+1)*2);\n                FOR(i, ox, ox+c){\n                    FOR(j, oy, dy) paper[j][c+i] += paper[j][i];\n                }\n                ox += c;\n            }else{\n                dy = max(dy, oy+(c+1)*2);\n                FOR(i, oy, oy+c){\n                    FOR(j, ox, dx) paper[c+i][j] += paper[i][j];\n                }\n                oy += c;\n            }\n        }\n        \n        rep(_, p){\n            int x, y;\n            cin >> x >> y;\n            cout << paper[y+oy][x+ox] << endl;\n        }\n\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\n#include<bitset>\n#include<stack>\n#include<unordered_map>\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int ui;\nconst ll mod = (1e+9)+7;\nconst ll INF = (ll)1000000007 * 1000000007;\ntypedef pair<int, int> P;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef long double ld;\ntypedef complex<ld> Point;\nconst ld eps = 1e-8;\nconst ld pi = acos(-1.0);\ntypedef pair<ll, ll> LP;\ntypedef pair<ld, ld> LDP;\nint main(){\n\tint n, m, t, p;\n\twhile (cin >> n >> m >> t >> p, n) {\n\t\tint pepar[32][32],cop[32][32];\n\t\trep(i, m) {\n\t\t\trep(j, n) {\n\t\t\t\tpepar[i][j] = 1;\n\t\t\t}\n\t\t}\n\t\trep(i, t) {\n\t\t\trep(j, 32) {\n\t\t\t\trep(k, 32) {\n\t\t\t\t\tcop[j][k] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tint d, c; cin >> d >> c;\n\t\t\tif (d == 1) {\n\t\t\t\tRep(j, c, n) {\n\t\t\t\t\trep(k, m) {\n\t\t\t\t\t\tcop[k][j - c] += pepar[k][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tper(j, c) {\n\t\t\t\t\trep(k, m) {\n\t\t\t\t\t\tcop[k][c - j - 1] += pepar[k][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tn = max(n-c,c);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tRep(k, c, m) {\n\t\t\t\t\trep(j, n) {\n\t\t\t\t\t\tcop[k - c][j] += pepar[k][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tper(k, c) {\n\t\t\t\t\trep(j, n) {\n\t\t\t\t\t\tcop[c - k - 1][j] += pepar[k][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tm = max(m - c, c);\n\t\t\t}\n\t\t\trep(j, m) {\n\t\t\t\trep(k, n) {\n\t\t\t\t\tpepar[j][k] = cop[j][k];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\trep(i, p) {\n\t\t\tint x, y; cin >> y >> x;\n\t\t\tcout << pepar[x][y] << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#include<cctype>\n#include<math.h>\n#include<string>\n#include<string.h>\n#include<stack>\n#include<queue>\n#include<vector>\n#include<utility>\n#include<set>\n#include<map>\n#include<stdlib.h>\n#include<iomanip>\n\nusing namespace std;\n\n#define ll long long\n#define ld long double\n#define EPS 0.0000000001\n#define INF 1e9\n#define MOD 1000000007\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define loop(i,a,n) for(int i=a;i<(n);i++)\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n\n#define int ll //!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\ntypedef pair<int,pii> pip;\ntypedef vector<vi> vvi;\n\nint gcd(int a, int b){\n    if(b==0) return a;\n    return gcd(b,a%b);\n}\nint lcm(int a, int b){\n    return a*b/gcd(a,b);\n}\n\nvoid print(vvi a){\n    cout << endl;\n    rep(i,a.size()){\n        rep(j,a[i].size())cout << \" \" << a[i][j];\n        cout << endl;\n    }\n}\n\nsigned main(void) {\n    int n,m,t,p;\n    while(cin >> n >> m >> t >> p,n){\n        vvi a(n,vi(m,1));\n        rep(i,t){\n            //print(a);\n            int d,c;\n            cin >> d >> c;\n            if(d == 2){\n                int nn = n;\n                int mm = max(m-c,c);\n                vvi b(nn,vi(mm,0));\n                rep(i,nn)rep(j,mm){\n                    if(j+c < m)b[i][j] += a[i][j+c];\n                    if(c-j-1 >= 0)b[i][j] += a[i][c-j-1];\n                }\n                n = nn,m = mm;\n                a = b;\n            }else{\n                int nn = max(n-c,c);\n                int mm = m;\n                vvi b(nn,vi(mm,0));\n                rep(i,nn)rep(j,mm){\n                    if(i+c < n)b[i][j] += a[i+c][j];\n                    if(c-i-1 >= 0)b[i][j] += a[c-i-1][j];\n                }\n                n = nn,m = mm;\n                a = b;\n            }\n        }\n        //print(a);\n        rep(i,p){\n            int x,y;\n            cin >> x >> y;\n            cout << a[x][y] << endl;\n        }\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "\n#include <iostream>\n#include <cstring>\n#include <algorithm>\n#include <utility>\n#include <iomanip>\n#include <queue>\n#include <functional>\n#include <stack>\n#include <map>\n#include <vector>\n#include <cmath>\n#define ll long long\n#define REP(i,n) for(int i=0;i<(n);i++)\n#define PB push_back\n#define MP make_pair\nusing namespace std;\nint main(){\n    int n,m,t,p;\n    while(cin>>n>>m>>t>>p){\n        if(n==0 && m==0 && t==0 && p==0){\n            break;\n        }\n        \n        ll d[t], c[t] , x[p], y[p];\n        for(int i=0; i<t; i++){\n            cin >> d[i] >> c[i];\n        }\n        for(int i=0; i<p; i++){\n            cin >> x[i] >> y[i];\n        }\n        \n        ll matrix[1000][1000]={};\n        \n        ll left=0;\n        ll bottom=0;\n     \n        \n        for(int i=0; i<n; i++){\n        for(int j=0; j<m; j++){\n                matrix[i][j]=1;\n            }\n        }\n        \n        \n        for(int i=0; i<t; i++){\n            \n            if(d[i]==1){\n                for(int yoko=0; yoko<c[i]; yoko++){\n                    for(int tate=bottom; tate<bottom+m; tate++){\n                        matrix[left+c[i]+yoko][tate]+=matrix[left+c[i]-1-yoko][tate];\n                    }\n                }\n                \n                left+=c[i];\n            }\n            \n            else if(d[i]==2){\n                for(int tate=0; tate<c[i]; tate++){\n                    for(int yoko=left; yoko<left+n; yoko++){\n                        matrix[yoko][bottom+c[i]+tate]+=matrix[yoko][bottom+c[i]-1-tate];\n                    }\n                }\n                \n                bottom+=c[i];\n            }\n            \n        }\n        \n        \n        for(int i=0; i<p; i++){\n            cout<<matrix[left+x[i]][bottom+y[i]]<<endl;\n        }\n        \n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cstring>\n#include <tuple>\n#include <set>\n#define ll long long\n#define N 100000\n\nusing namespace std;\n\nint g[64][64], dx, dy;\n\nint main(void) {\n#ifdef _DEBUG\n\tfreopen(\"1.in\", \"r\", stdin);\n#else \n\tios::sync_with_stdio(0); cin.tie(0); cout.tie(0);\n#endif\n\tint n, m, t, p;\n\twhile (cin >> n >> m >> t >> p, n) {\n\t\tdx = dy = 0;\n\t\tmemset(g, 0, sizeof(g));\n\t\tfor (int i = 0; i != n; ++i) for (int j = 0; j != m; ++j) g[i][j] = 1;\n\t\twhile (t--) { \n\t\t\tint d, c; cin >> d >> c;\n\t\t\tif (d == 1) {\n\t\t\t\tfor (int i = 0; i != c; ++i)\n\t\t\t\t\tfor (int j = 0; j != m - dy; ++j)\n\t\t\t\t\t\tg[dx + c + i][dy + j] += g[dx + c - i - 1][dy + j];\n\t\t\t\tdx += c;\n\t\t\t\tif (n < dx + 2 * c) n = dx + 2 * c;\n\t\t\t}\n\t\t\telse if (d == 2) {\n\t\t\t\tfor (int j = 0; j != c; ++j)\n\t\t\t\t\tfor (int i = 0; i != n - dx; ++i)\n\t\t\t\t\t\tg[dx + i][dy + c + j] += g[dx + i][dy + c - j - 1];\n\t\t\t\tdy += c;\n\t\t\t\tif (m < dy + 2 * c) m = dy + 2 * c;\n\t\t\t}\n\t\t}\n\t\twhile (p--) {\n\t\t\tint x, y; cin >> x >> y;\n\t\t\tcout << g[dx + x][dy + y] << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\nconst int maxn=33;\nint g[maxn][maxn];\nint n=0,m=0,t=0,p=0;\nint d=0,c=0;\nint x=0,y=0;\nint dx=0,dy=0;\nint main()\n{\n    //freopen(\"C:\\\\Users\\\\atara\\\\Desktop\\\\in.txt\",\"r\",stdin);\n    while(scanf(\"%d%d%d%d\",&n,&m,&t,&p)==4&&(n+m+t+p)!=0)\n    {\n        dx=0;\n        dy=0;\n        for(int i=0;i<m;++i)\n            for(int j=0;j<n;++j)\n        {\n            g[i][j]=1;\n        }\n        for(int k=0;k<t;++k)\n        {\n            scanf(\"%d%d\",&d,&c);\n            if(d==1)\n            {\n                if(c>n/2)\n                    c=n-c;\n                dy+=c;\n                for(int i=dx;i<m;++i)\n                    for(int j=dy;j<dy+c;++j)\n                     g[i][j]=g[i][j]+g[i][j-c];\n            }\n            else\n            {\n                if(c>m/2) c=m-c;\n                dx+=c;\n                for(int i=dx;i<dx+c;++i)\n                    for(int j=dy;j<n;++j)\n                   g[i][j]=g[i][j]+g[i-c][j];\n            }\n           /* printf(\"%d %d\\n\",dx,dy);\n           for(int i=m-1;i>=0;--i)\n            {\n\n                 for(int j=0;j<n;++j)\n                    printf(\"%d \",g[i][j]);\n                 printf(\"\\n\");\n            }*/\n\n\n        }\n        for(int k=0;k<p;++k)\n        {\n            scanf(\"%d%d\",&x,&y);\n            printf(\"%d\\n\",g[dx+y][dy+x]);\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for (int i = 0; i < n; i++)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pi;\ntypedef pair<ll, ll> pl;\nconst double EPS = 1e-9;\nconst ll mod = 1000000007;\nconst int inf = 1 << 30;\nconst ll linf = 1LL << 60;\nconst double PI = 3.14159265358979323846;\n\nint n, m, t, p;\nint o[1000][1000];\n\nvoid solve() {\n    memset(o, 0, sizeof(o));\n    rep(i,m) rep(j,n) o[i][j] = 1;\n    int h = 0, w = 0;\n    rep(i,t) {\n        int d, c; cin >> d >> c;\n        if (d == 1) {\n            rep(j,1000) {\n                rep(k,c) {\n                    o[j][w+2*c-1-k] += o[j][w+k];\n                }\n            }\n            w += c;\n        } else {\n            rep(j,1000) {\n                rep(k,c) {\n                    o[h+2*c-1-k][j] += o[h+k][j];\n                }\n            }\n            h += c;\n        }\n    }\n    rep(i,p) {\n        int x, y; cin >> x >> y;\n        cout << o[h+y][w+x] << endl;\n    }\n}\n\nint main() {\n#ifndef LOCAL\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n#endif\n    cout << fixed;\n    cout.precision(20);\n    cerr << fixed;\n    cerr.precision(6);\n#ifdef LOCAL\n    //freopen(\"in.txt\", \"wt\", stdout); //for tester\n    freopen(\"in.txt\", \"rt\", stdin);\n#endif  \n    while (cin >> n >> m >> t >> p) {\n        if (n == 0 && m == 0 && t == 0 && p == 0) break;\n        solve();\n    }\n    //cerr << \"Time elapsed: \" << 1.0 * clock() / CLOCKS_PER_SEC << \" s.\\n\";\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint n, m, t, p;\nint maps[1000][1000];\n\nint main()\n{\n\tfreopen(\"a.in\", \"r\", stdin);\n\twhile(true)\n\t{\n\t\tscanf(\"%d%d%d%d\", &n, &m, &t, &p);\n\t\tif(!n && !m && !t && !p)\n\t\t\tbreak;\n\t\tmemset(maps, 0, sizeof(maps));\n\t\tfor(int i = 0; i < m; i++)\n\t\t\tfor(int j = 0; j < n; j++)\n\t\t\t\tmaps[i][j] = 1;\n\t\tint cn = 0, cm = 0, w = n, h = m;\n\t\tfor(int i = 0; i < t; i++)\n\t\t{\n\t\t\tint d, c;\n\t\t\tscanf(\"%d%d\", &d, &c);\n\t\t\tif(d == 1)\n\t\t\t{\n\t\t\t\tfor(int x = cn; x < cn+h; x++)\n\t\t\t\t{\n\t\t\t\t\tfor(int y = cm+c; y < cm+2*c; y++)\n\t\t\t\t\t{\n\t\t\t\t\t\tmaps[x][y] += maps[x][(int)(2*(cm+c-0.5))-y];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcm += c;\n\t\t\t\tif(c < w - c)\n\t\t\t\t\tw -= c;\n\t\t\t\telse\n\t\t\t\t\tw = c;\n\t\t\t}\n\t\t\telse if(d == 2)\n\t\t\t{\n\t\t\t\tfor(int x = cn+c; x < cn+2*c; x++)\n\t\t\t\t{\n\t\t\t\t\tfor(int y = cm; y < cm+w; y++)\n\t\t\t\t\t{\n\t\t\t\t\t\tmaps[x][y] += maps[(int)(2*(cn+c-0.5))-x][y];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcn += c;\n\t\t\t\tif(c < h - c)\n\t\t\t\t\th -= c;\n\t\t\t\telse\n\t\t\t\t\th = c;\n\t\t\t}\n//\t\t\tfor(int x = 0; x < cn+h; x++)\n//\t\t\t{\n//\t\t\t\tfor(int y = 0; y < cm+w; y++)\n//\t\t\t\t{\n//\t\t\t\t\tprintf(\"%d \", maps[x][y]);\n//\t\t\t\t}\n//\t\t\t\tprintf(\"\\n\");\n//\t\t\t}\n//\t\t\tprintf(\"\\n\");\n\t\t}\n\t\tfor(int i = 0; i < p; i++)\n\t\t{\n\t\t\tint x, y;\n\t\t\tscanf(\"%d%d\", &x, &y);\n\t\t\tprintf(\"%d\\n\", maps[cn+y][cm+x]);\n\t\t}\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nconst int INF = 1e9;\nconst ll LINF = 1e18;\n\nint main(void) {\n    cin.tie(0); ios_base::sync_with_stdio(false);\n    int n,m,t,p;\n    while(cin >> n >> m >> t >> p,n){\n        vector<vector<int>> masu(2000,vector<int>(2000));\n        pii ll = {1000,1000};\n        pii ur = {1000+m-1,1000+n-1};\n        for(int i = ll.first; i <= ur.first;i++){\n            for(int j = ll.second; j <= ur.second;j++){\n                masu[i][j] = 1;\n            }\n        }\n        \n        auto show = [&]{\n//            cout << endl;\n//            for(int y = 1000; y <= 1010;y++){\n//                for(int x = 1000;x<=1010;x++){\n//                    cout << masu[y][x] << \" \";\n//                }\n//                cout << endl;\n//            }\n//            cout << \"===\" << endl;\n        };\n        for(int _ = 0; _ < t; _++){\n            show();\n            int d,c; cin >> d >> c;\n            if(d == 1){\n                for(int i = ll.first; i <= ur.first ;i++){\n                    for(int j = ll.second; j < ll.second+c ;j++){\n                        masu[i][(c-(j-ll.second)-1) + ll.second+c] += masu[i][j];\n                    }\n                }\n                ur.second = max(ur.second,ll.second+2*c-1);\n                ll.second += c;\n            }else{\n                for(int i = ll.first; i < ll.first+c ;i++){\n                    for(int j = ll.second; j <= ur.second ;j++){\n                        masu[c-(i-ll.first)-1+ll.first+c][j] += masu[i][j];\n                    }\n                }\n                ur.first= max(ur.first,ll.first+2*c-1);\n                ll.first += c;\n            }\n        }\n        show();\n        \n        for(int _ = 0; _ < p; _++){\n            int x,y; cin >> x >> y;\n            cout << masu[ll.first+y][ll.second+x] << endl;\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <cstring>\nusing namespace std;\nconst int maxn=640;\nint g[maxn][maxn];\nint n=0,m=0,t=0,p=0;\nint d=0,c=0;\nint x=0,y=0;\nint dx=0,dy=0;\nint main()\n{\n    //freopen(\"C:\\\\Users\\\\atara\\\\Desktop\\\\in.txt\",\"r\",stdin);\n    while(scanf(\"%d%d%d%d\",&n,&m,&t,&p)==4&&(n+m+t+p)!=0)\n    {\n        dx=0;\n        dy=0;\n        memset(g,0,sizeof(g));\n        for(int i=0;i<m;++i)\n            for(int j=0;j<n;++j)\n        {\n            g[i][j]=1;\n        }\n        for(int k=0;k<t;++k)\n        {\n            scanf(\"%d%d\",&d,&c);\n            if(d==1)\n            {\n                dy+=c;\n                for(int i=dx;i<maxn;++i)\n                    for(int j=dy;j<dy+c;++j)\n                     g[i][j]=g[i][j]+g[i][j-c];\n            }\n            else\n            {\n\n                dx+=c;\n                for(int i=dx;i<dx+c;++i)\n                    for(int j=dy;j<maxn;++j)\n                   g[i][j]=g[i][j]+g[i-c][j];\n            }\n           /*printf(\"%d %d\\n\",dx,dy);\n           for(int i=10-1;i>=0;--i)\n            {\n\n                 for(int j=0;j<10;++j)\n                    printf(\"%d \",g[i][j]);\n                 printf(\"\\n\");\n            }*/\n\n\n        }\n        for(int k=0;k<p;++k)\n        {\n            scanf(\"%d%d\",&x,&y);\n            printf(\"%d\\n\",g[dx+y][dy+x]);\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "//#include <bits/stdc++.h>\n#include <deque>\n#include <iostream>\n#include <iomanip>\n#include <map>\n#include <cstring>\n#include <cstdio>\n#include <algorithm>\n#include <vector>\n#define DEBUG 1\n\nusing namespace std;\n\ntypedef long long LL;\ntypedef long double LD;\ntypedef pair<int, int> PII;\ntypedef pair<LL, LL> PLL;\ntypedef pair<LD, LD> PLDLD;\ntypedef vector<int> VI;\ntypedef vector<LL> VLL;\ntypedef vector<char> VB;\n\n#define FOR(i,a,b) for(int i=(a);i<(int)(b);++i)\n#define REP(i,n) FOR(i,0,n)\n#define CLR(a) memset((a), 0 ,sizeof(a))\n#define ALL(a) a.begin(),a.end()\n#define UNQ(a) a.erase(std::unique(ALL(a)),a.end());\n//#define endl \"\\n\"\n\nconst LD EPS=1e-10;\nconst long long INFLL=(LL)(1e9)*(LL)(1e9);\nconst int INF=1e9+7;\n\ntemplate<class T>\nvoid chmin(T& a, const T b)\n{\n\tif(a>b)\n\t\ta=b;\n}\ntemplate<class T>\nvoid chmax(T& a, const T b)\n{\n\tif(a<b)\n\t\ta=b;\n}\n\nconst LL powLL(const LL p, const LL q)\n{\n\tLL t=1;\n\tfor(int i=0;i<q;i++)\n\t\tt*=p;\n\treturn t;\n}\n\ntemplate <typename T>\nstruct has_iter\n{\n\tprivate:\n\t\ttemplate <typename U>\n\t\tstatic constexpr true_type check(typename U::iterator*);\n\t\ttemplate <typename U>\n\t\tstatic constexpr false_type check(...);\n\n\tpublic:\n\t\tstatic constexpr bool value = decltype(check<T>(nullptr))::value;\n};\n\n\ntemplate<typename T, typename U = typename T::iterator>\nvoid print(const T& container)\n{\n\t\tauto&& first=begin(container), last=end(container);\n\t\tauto&& back=prev(last);\n\t\tfor(auto e=first; e!=last; e=next(e))\n\t\t\tcout<<*e<<\" \\n\"[e==back];\n}\n\n\nextern void* enabler;\ntemplate<typename Head, typename enable_if<!has_iter<Head>::value>::type*& = enabler>\nvoid print(const Head& head)\n{\n\tcout<<head<<endl;\n}\n\ntemplate<> void print<string>(const string& container)\n{\n\tcout<<container<<endl;\n}\n\ntemplate<typename Head, typename... Tail>\nvoid print(const Head& head, const Tail&... tail)\n{\n\tcout<<head<<\" \";\n\tprint(tail...);\n}\n\ntemplate<typename... Args>\nvoid printd(const Args&... args)\n{\n\t#ifdef DEBUG\n\t\tprint(args...);\n\t#endif\n}\n\ntemplate<typename Head>\nvoid input(Head& head)\n{\n\tcin>>head;\n}\n\ntemplate<typename Head, typename... Tail>\nvoid input(Head& head, Tail&... tail)\n{\n\tcin>>head;\n\tinput(tail...);\n}\n\nvoid io_speedup()\n{\n\tcin.tie(0);\n\tcout.tie(0);\n\tios::sync_with_stdio(false);\n}\n\ntemplate<typename T>\nistream& operator >> (istream& is, vector<T>& vec)\n{\n\tfor(T& x: vec) is >> x;\n\treturn is;\n}\n\ntemplate<int N, typename... Ts, typename enable_if<N == sizeof...(Ts)-1>::type*& = enabler>\nvoid tuple_out(ostream &os,const tuple<Ts...> &t)\n{\n\tos<<get<N>(t);\n}\ntemplate<int N, typename... Ts, typename enable_if<N < sizeof...(Ts)-1>::type*& = enabler>\nvoid tuple_out(ostream &os,const tuple<Ts...> &t)\n{\n\tos<<get<N>(t)<<\", \";\n\ttuple_out<N+1, Ts...>(os, t);\n}\n\ntemplate<typename... Ts>\nostream& operator << (ostream& os, const tuple<Ts...>& t)\n{\n\tos<<'(';\n\ttuple_out<0, Ts...>(os, t);\n\tos<<')';\n\treturn os;\n}\n\ntemplate<typename T>\nvector<T> read(int n)\n{\n\tvector<T> t(n);\n\tcin>>t;\n\treturn t;\n}\n\ntemplate<typename T>\nT read()\n{\n\tT t;\n\tcin>>t;\n\treturn t;\n}\n\ntemplate<typename Head, typename... Tail>\nstruct vector_demensions\n{\n\tusing type=vector<typename vector_demensions<Tail...>::type>;\n};\n\ntemplate<typename Head>\nstruct vector_demensions<Head> { using type=Head; };\n\ntemplate<typename T>\nvector<T> make_vectors(int size, T val)\n{\n\treturn vector<T>(size, val);\n}\n\ntemplate<typename T=int, typename... Args>\nauto make_vectors(int size, Args... tail)\n\t-> typename vector_demensions<Args..., T>::type\n{\n\tauto val=make_vectors<T>(forward<Args>(tail)...);\n\treturn vector<decltype(val)>(size, val);\n}\n\n\nint main()\n{\n\tint n,m,t,p;\n\twhile(cin>>n)\n\t{\n\t\tcin>>m>>t>>p;\n\t\tif(n==0) return 0;\n\t\tvector<VI> g(n,VI(m,1));\n\t\tint d,c;\n\t\tREP(i,t)\n\t\t{\n\t\t\tcin>>d>>c;\n\t\t\tif(d==1)\n\t\t\t{\n\t\t\t\tvector<VI> g2(n,VI(m,0));\n\t\t\t\tREP(j,m)\n\t\t\t\t{\n\t\t\t\t\tREP(k,c)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(k+c<n)\n\t\t\t\t\t\t\tg2[k][j]=g[k+c][j] + g[c-k-1][j];\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tg2[k][j]=g[c-k-1][j];\n\t\t\t\t\t}\n\t\t\t\t\tFOR(k,c*2,n)\n\t\t\t\t\t\tg2[k-c][j]=g[k][j];\n\t\t\t\t}\n\t\t\t\tg=g2;\n\t\t\t}\n\t\t\telse if(d==2)\n\t\t\t{\n\t\t\t\tvector<VI> g2(n,VI(m,0));\n\t\t\t\tREP(j,n)\n\t\t\t\t{\n\t\t\t\t\tREP(k,c)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(k+c<m)\n\t\t\t\t\t\t\tg2[j][k]=g[j][k+c] + g[j][c-k-1];\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tg2[j][k]=g[j][c-k-1];\n\t\t\t\t\t}\n\t\t\t\t\tFOR(k,c*2,m)\n\t\t\t\t\t\tg2[j][k-c]=g[j][k];\n\t\t\t\t}\n\t\t\t\tg=g2;\n\t\t\t}\n\t\t}\n\t\t//REP(j,m)\n\t\t//REP(i,n)\n\t\t//\tcout<<g[i][j]<<\" \\n\"[i==n-1];\n\t\tREP(i,p)\n\t\t{\n\t\t\tint x,y;\n\t\t\tcin>>x>>y;\n\t\t\tcout<<g[x][y]<<endl;\n\t\t}\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define LL long long\n\nusing namespace std;\n\nint a[1005][1005];\n\nint main()\n{\n    int n,m,t,p;\n    while (scanf(\"%d%d%d%d\",&m,&n,&t,&p))\n    {\n        if (n==0 && m==0 && t==0 && p==0) break;\n        int ox=0,oy=0;\n        memset(a,0,sizeof(a));\n        for (int i=0;i<n;i++)\n            for (int j=0;j<m;j++)\n                a[i][j]=1;\n\n\n        for (int i=0;i<t;i++)\n        {\n            int d,c;\n            scanf(\"%d%d\",&d,&c);\n            if (d==2)\n            {\n                for (int j=c+ox;j<c+ox+c;j++)\n                    for (int k=oy;k<oy+m;k++)\n                        if (2*(c+ox)-j-1>=0) a[j][k]+=a[2*(c+ox)-j-1][k];\n                ox+=c;\n                n=max(n-c,c);\n            }\n\n            if (d==1)\n            {\n                for (int j=ox;j<ox+n;j++)\n                    for (int k=c+oy;k<c+oy+c;k++)\n                       if (2*(c+oy)-k-1>=0) a[j][k]+=a[j][2*(c+oy)-k-1];\n\n                oy+=c;\n                m=max(m-c,c);\n            }\n\n\n        }\n        for (int i=0;i<p;i++)\n            {\n                int x,y;\n                scanf(\"%d%d\",&x,&y);\n                printf(\"%d\\n\",a[y+ox][x+oy]);\n            }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define fi first\n#define se second\n#define show(x) cerr << #x << \"=\" << \"\\n\"\ntypedef long long ll;\ntypedef unsigned long long ull;\n\nusing namespace std;\n\nint main() {\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  cout.precision(10);\n  cout << fixed;\n#ifdef LOCAL_DEFINE\n  FILE *stream1;\n  //FILE *stream2;\n  stream1 = freopen(\"in.txt\", \"r\", stdin);\n  //stream2 = freopen(\"out.txt\", \"w\", stdout);\n  if (stream1 == NULL) return 0;\n  //if (stream2 == NULL) return 0;\n#endif\n  int n, m, t, p;\n  while (cin >> n >> m >> t >> p, n) {\n    int past[40][40];\n    for (int i = 0; i < 40; i++) {\n      for (int j = 0; j < 40; j++) {\n        past[i][j] = 0;\n      }\n    }\n    for (int i = 0; i < m; i++) {\n      for (int j = 0; j < n; j++) {\n        past[i][j] = 1;\n      }\n    }\n    for (int i = 0; i < t; i++) {\n      int d, c; cin >> d >> c;\n      int nw[40][40];\n      for (int i = 0; i < 40; i++) {\n        for (int j = 0; j < 40; j++) {\n          nw[i][j] = 0;\n        }\n      }\n      if (d == 1) {\n        for (int i = 0; i < 40; i++) {\n          for (int j = c; j < 40; j++) {\n            nw[i][j - c] += past[i][j];\n          }\n        }\n        for (int i = 0; i < 40; i++) {\n          for (int j = 0; j < c; j++) {\n            nw[i][j] += past[i][j];\n          }\n        }\n      } else {\n        int h = 0;\n        int last = 0;\n        for (int i = 0; i < 40; i++) {\n          if (past[i][0] != 0) {\n            h++;\n            last = i;\n          }\n        }\n        if (c >= h - c) {\n          int cont = 0;\n          int now = last;\n          while (cont < c) {\n            for (int i = 0; i < 40; i++) {\n              nw[cont][i] += past[now][i];\n            }\n            cont++;\n            now--;\n          }\n          for (int i = 0; i < now + 1; i++) {\n            for (int j = 0; j < 40; j++) {\n              nw[c - 1 - i][j] += past[i][j];\n            }\n          }\n        } else {\n          for (int i = 0; i < h - c; i++) {\n            for (int j = 0; j < 40; j++) {\n              nw[i][j] += past[i][j];\n            }\n          }\n          int cont = 0;\n          while (cont < c) {\n            for (int i = 0; i < 40; i++) {\n              nw[h - c - cont - 1][i] += past[h - c + cont][i];\n            }\n            cont++;\n          }\n        }\n      }\n      for (int i = 0; i < 40; i++) {\n        for (int j = 0; j < 40; j++) {\n          past[i][j] = nw[i][j];\n        }\n      }\n      // for (int i = 0; i < 10; i++) {\n      //   for (int j = 0; j < 10; j++) {\n      //     cerr << past[i][j];\n      //   }\n      //   cerr << endl;\n      // }\n    }\n    int h = 0;\n    for (int i = 0; i < 40; i++) {\n      if (past[i][0] != 0) {\n        h++;\n      }\n    }\n    for (int i = 0; i < p; i++) {\n      int x, y; cin >> x >> y;\n      cout << past[h - y - 1][x] << endl;\n    }\n    // for (int i = 0; i < 10; i++) {\n    //   for (int j = 0; j < 10; j++) {\n    //     cerr << past[i][j];\n    //   }\n    //   cerr << endl;\n    // }\n  }\n#ifdef LOCAL_DEFINE\n  cerr << \"Time elapsed: \" << 1.0 * clock() / CLOCKS_PER_SEC << \"s.\\n\";\n  fclose(stream1);\n  //fclose(stream2);\n#endif\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <functional>\n#include <vector>\n#include <utility>\n#include <cstring>\n#include <cmath>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n#include <numeric> \n#define MAX_N 100\nusing namespace std;\ntypedef long long ll;\nconst int INF = 1<<30; \nconst int MOD = 1e9 + 7;\nconst int dx[] = {1, 0, -1, 0};\nconst int dy[] = {0, 1, 0, -1};\nint main()\n{\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tint w, h, t, p, d, c;\n\twhile(cin >> w >> h >> t >> p, w | h | t | p)\n\t{\n\t\tint table[MAX_N + 10][MAX_N + 10] = {};\n\t\tfor(int i = 0; i < h; i++)\n\t\t\tfor(int j = 0; j < w; j++) table[i][j] = 1;\n\t\tfor(int i = 0; i < t; i++)\n\t\t{\n\t\t\tcin >> d >> c;\n\t\t\tif(d == 1)\n\t\t\t{\n\t\t\t\tfor(int j = 0; j < h; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < c; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint alpha = c - k - 1;\n\t\t\t\t\t\ttable[j][c + alpha] += table[j][k];\n\t\t\t\t\t\ttable[j][k] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j = 0; j < MAX_N; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < MAX_N; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\ttable[j][k] = table[j][k + c];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(d == 2)\n\t\t\t{\n\t\t\t\tfor(int j = 0; j < c; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < w; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint alpha = c - j - 1;\n\t\t\t\t\t\ttable[c + alpha][k] += table[j][k];\n\t\t\t\t\t\ttable[j][k] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int j = 0; j < MAX_N; j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int k = 0; k < MAX_N; k++)\n\t\t\t\t\t{\n\t\t\t\t\t\ttable[j][k] = table[j + c][k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint x, y;\n\t\tfor(int i = 0; i < p; i++)\n\t\t{\n\t\t\tcin >> x >> y;\n\t\t\tcout << table[y][x] << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\nconst int maxn = 1e3 + 10;\nconst int mod = 1e9 + 7;\nconst int inf = 0x3f3f3f3f;\n#define ll long long\n#define ull unsigned long long\n\nint s[maxn][maxn];\n\nint n, m, t, p, sx, sy,ex,ey;\n\nint main() {\n    //freopen(\"input.txt\", \"r\", stdin);\n    //freopen(\"output.txt\",\"w\",stdout);\n    int _;\n    int d, c, x, y;\n    //scanf(\"%d\", &_);\n    while (scanf(\"%d %d %d %d\", &n, &m, &t, &p)!=EOF) {\n        if(n==0&&m==0&&t==0&&p==0) break;\n        ex = n,ey = m;\n        sx = 0, sy = 0;\n        memset(s, 0, sizeof(s));\n        for(int i=0;i<n;i++)\n            for(int j=0;j<m;j++)\n                s[i][j] = 1;\n        while (t--) {\n            scanf(\"%d %d\", &d, &c);\n            if (d == 1) {\n                for (int i = 0; i < c; i++) {\n                    for (int j = sy; j <= ey; j++) {\n                        s[sx + c + i][j] += s[sx + c - i - 1][j];\n                    }\n                }\n                ex = max(ex,sx+c+c);\n                sx += c;\n            } else {\n                for (int i = sx; i <= ex; i++) {\n                    for (int j = 0; j < c; j++) {\n                        s[i][sy + c + j] += s[i][sy + c - j - 1];\n                    }\n                }\n                ey = max(ey,sy+c+c);\n\n                sy += c;\n            }\n        }\n        int ans = 0;\n//        cout<<endl;\n//        for(int i=0;i<ex;i++){\n//            for(int j=0;j<ey;j++){\n//                cout<<s[i][j]<<\" \";\n//            }\n//            cout<<endl;\n//        }\n        while (p--) {\n            scanf(\"%d %d\", &x, &y);\n\n            printf(\"%d\\n\", s[sx + x][sy + y]);\n\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define SZ(x) (int)(x.size())\n#define REP(i, n) for(int i=0;i<(n);++i)\n#define FOR(i, a, b) for(int i=(a);i<(b);++i)\n#define RREP(i, n) for(int i=(int)(n)-1;i>=0;--i)\n#define RFOR(i, a, b) for(int i=(int)(b)-1;i>=(a);--i)\n#define ALL(a) a.begin(),a.end()\n#define DUMP(x) cerr<<#x<<\" = \"<<(x)<<endl\n#define DEBUG(x) cerr<<#x<<\" = \"<<(x)<<\" (L\"<<__LINE__<<\")\"<< endl;\nusing ll = long long;\nusing vi = vector<int>;\nusing vvi = vector<vi>;\nusing vvvi = vector<vvi>;\nusing vll = vector<ll>;\nusing vvll = vector<vll>;\nusing P = pair<int, int>;\nconst double eps = 1e-8;\nconst ll MOD = 1000000007;\nconst int INF = INT_MAX / 2;\nconst ll LINF = LLONG_MAX / 2;\ntemplate <typename T1, typename T2>\nbool chmax(T1 &a, const T2 &b) {\n    if (a < b) { a = b; return true; }\n    return false;\n}\ntemplate <typename T1, typename T2>\nbool chmin(T1 &a, const T2 &b) {\n    if (a > b) { a = b; return true; }\n    return false;\n}\ntemplate<typename T>\nostream &operator<<(ostream &os, const vector<T> &v) {\n    os << \"[\";\n    REP(i, SZ(v)) {\n        if (i) os << \", \";\n        os << v[i];\n    }\n    return os << \"]\";\n}\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const map<T1, T2> &mp) {\n    os << \"{\";\n    int a = 0;\n    for (auto &tp : mp) {\n        if (a) os << \", \";\n        a = 1;\n        os << tp;\n    }\n    return os << \"}\";\n}\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const pair<T1, T2> &p) {\n    os << p.first << \":\" << p.second;\n    return os;\n}\n\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(10);\n\n\n    for (;;) {\n        int n, m, t, p;\n        cin >> n >> m >> t >> p;\n        if (n == 0) break;\n\n        int x = 0, y = 0;\n\n        const int MAX = 700;\n\n        vvi S(MAX, vi(MAX, 0));\n        REP(i, m) {\n            REP(j, n) {\n                S[i][j] = 1;\n            }\n        }\n\n        REP(q, t) {\n            int d, c; cin >> d >> c;\n            if (d == 1) {\n                for (int j = 0; j < c; ++j) {\n                    REP(i, MAX) {\n                        S[i][x + c + j] += S[i][x + c - 1 - j];\n                        S[i][x + c - 1 - j] = 0;\n                    }\n                }\n                x += c;\n            }\n            if (d == 2) {\n                for (int i = 0; i < c; ++i) {\n                    REP(j, MAX) {\n                        S[y + c + i][j] += S[y + c - 1 - i][j];\n                        S[y + c - 1 - i][j] = 0;\n                    }\n                }\n                y += c;\n            }\n        }\n\n        REP(q, p) {\n            int X, Y; cin >> X >> Y;\n            cout << S[Y + y][X + x] << endl;\n        }\n    }\n\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\ntypedef long long ll;\n\nint main(void) {\n  ll i, j, n, m, t, p, d, c, x, y, k;\n  while( 1 ) {\n    scanf(\"%lld%lld%lld%lld\", &n, &m, &t, &p);\n    if(!n) break;\n    ll a[n * (t + 1)][m * (t + 1)], ans = 0, now = 0, ox = 0, oy = 0, lx = n, ly = m;\n    for(i = 0; i < n * (t + 1); ++i) for(j = 0; j < m * (t + 1); ++j) {\n      if(i < n && j < m) a[i][j] = 1;\n      else a[i][j] = 0;\n    }\n    for(k = 0; k < t; ++k) {\n      scanf(\"%lld%lld\", &d, &c);\n      if(d == 1) {\n        for(i = ox; i < c + ox; ++i) for(j = oy; j < ly; ++j) {\n          a[2 * (c + ox) - i - 1][j] += a[i][j];\n        }\n        lx = lx > 2 * c + ox ? lx : 2 * c + ox, ox = ox + c;\n      } else {\n        for(i = oy; i < c + oy; ++i) for(j = ox; j < lx; ++j) {\n          a[j][2 * (c + oy) - i - 1] += a[j][i];\n        }\n        ly = ly > 2 * c + oy ? ly : 2 * c + oy, oy = oy + c;\n      }\n    }\n    for(i = 0; i < p; ++i) {\n      scanf(\"%lld%lld\", &x, &y);\n      printf(\"%lld\\n\", a[ox + x][oy + y]);\n    }\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\n#include <cstring>\nusing namespace std;\nconst int maxn=640;\nint g[maxn][maxn];\nint n=0,m=0,t=0,p=0;\nint d=0,c=0;\nint x=0,y=0;\nint dx=0,dy=0;\nint main()\n{\n    //freopen(\"C:\\\\Users\\\\atara\\\\Desktop\\\\in.txt\",\"r\",stdin);\n    while(scanf(\"%d%d%d%d\",&n,&m,&t,&p)==4&&(n+m+t+p)!=0)\n    {\n        dx=0;\n        dy=0;\n        int tmp1=0;\n        int tmp2=0;\n        memset(g,0,sizeof(g));\n        for(int i=0;i<m;++i)\n            for(int j=0;j<n;++j)\n        {\n            g[i][j]=1;\n        }\n        for(int k=0;k<t;++k)\n        {\n            scanf(\"%d%d\",&d,&c);\n            if(d==1)\n            {\n                dy+=c;\n                tmp1=dy+c;\n                for(int i=dx;i<max(m,tmp2);++i)\n                    for(int j=dy;j<tmp1;++j)\n                     g[i][j]=g[i][j]+g[i][j-c];\n            }\n            else\n            {\n\n                dx+=c;\n                tmp2=dx+c;\n                for(int i=dx;i<tmp2;++i)\n                    for(int j=dy;j<max(tmp1,n);++j)\n                   g[i][j]=g[i][j]+g[i-c][j];\n            }\n           /*printf(\"%d %d\\n\",dx,dy);\n           for(int i=10-1;i>=0;--i)\n            {\n\n                 for(int j=0;j<10;++j)\n                    printf(\"%d \",g[i][j]);\n                 printf(\"\\n\");\n            }*/\n\n\n        }\n        for(int k=0;k<p;++k)\n        {\n            scanf(\"%d%d\",&x,&y);\n            printf(\"%d\\n\",g[dx+y][dy+x]);\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\n\nint main(){\n  while(true){\n    int n, m, t, p;\n    cin >> n >> m >> t >> p;\n\n    if(n==0 && m==0 && t==0 && p==0)\n      break;\n\n    int Ori[64][64] = { {0} };\n    for(int y=0; y<m; y++){\n      for(int x=0; x<n; x++){\n        Ori[y][x] = 1;\n      }\n    }\n\n    for(int i=0; i<t; i++){\n      int d,c;\n      cin >> d >> c;\n\n      if(d==1){\n        for(int x=0; x<c; x++){\n          for(int y=0; y<m; y++){\n            Ori[y][2*c-1-x] += Ori[y][x];\n            Ori[y][x] = 0;\n          }\n        }\n        for(int x=0; x<n; x++){\n          for(int y=0; y<m; y++){\n            Ori[y][x] = Ori[y][x+c];\n            Ori[y][x+c] = 0;\n          }\n        }\n      }\n      else{\n        for(int y=0; y<c; y++){\n          for(int x=0; x<n; x++){\n            Ori[2*c-1-y][x] += Ori[y][x];\n            Ori[y][x] = 0;\n          }\n        }\n        for(int y=0; y<m; y++){\n          for(int x=0; x<n; x++){\n            Ori[y][x] = Ori[y+c][x];\n            Ori[y+c][x] = 0;\n          }\n        }\n      }\n    }\n    for(int i=0; i<p; i++){\n      int x, y;\n      cin >> x >> y;\n\n      cout << Ori[y][x] << endl;\n    }\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\n\nint main(){\n  while(1){\n    int n,m,t,p;\n    cin >> n >> m >> t >> p;\n    if(n==0 && m==0 && t==0 && p==0){\n      break;\n    }\n\n    int Ori[64][64] = {{0}};\n    for(int y=0; y<m; y++){\n      for(int x=0; x<n; x++){\n        Ori[y][x] = 1;\n      }\n    }\n    for(int i=0; i<t; i++){\n      int d,c;\n      cin >> d >> c;\n\n      if(d==1){\n        for(int x=0; x<c; x++){\n          for(int y=0; y<m; y++){\n            Ori[y][2*c-1-x] += Ori[y][x];\n            Ori[y][x] = 0;\n          }\n        }\n        for(int x=0; x<n; x++){\n          for(int y=0; y<m; y++){\n            Ori[y][x] = Ori[y][x+c];\n            Ori[y][x+c] = 0;\n          }\n        }\n      }\n      else{\n        for(int y=0; y<c; y++){\n          for(int x=0; x<n; x++){\n            Ori[2*c-1-y][x] += Ori[y][x];\n            Ori[y][x] = 0;\n          }\n        }\n        for(int y=0; y<m; y++){\n          for(int x=0; x<n; x++){\n            Ori[y][x] = Ori[y+c][x];\n            Ori[y+c][x] = 0;\n          }\n        }\n      }\n    }\n    for(int i=0; i<p; i++){\n      int x,y;\n      cin >> x >> y;\n\n      cout << Ori[y][x] << endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <math.h>\n#include <stdlib.h>\n#include <string.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> P;\ntypedef priority_queue<int, vector<int>, greater<int> > minpq;\n\nint main() {\n    while (true) {    \n        int n, m, t, p;\n        cin >> n >> m >> t >> p;\n        if (n == 0) break;\n        int yoko[32], tate[32];\n        fill(yoko, yoko + n, 1);\n        fill(tate, tate + m, 1);\n\n        for (int i=0; i<t; i++) {\n            int d, c;\n            cin >> d >> c;\n            int buf[32] = {0};\n            if (d == 1) {\n                for (int j = 0; j < n; j++) {\n                    if (c + j < n) buf[j] += yoko[c + j];\n                    if (c - 1 - j >= 0) buf[j] += yoko[c - 1 - j];\n                }\n                copy(buf, buf + n, yoko);\n                n = max(c, n - c);\n            } else {\n                for (int j = 0; j < m; j++) {\n                    if (c + j < m) buf[j] += tate[c + j];\n                    if (c - 1 - j >= 0) buf[j] += tate[c - 1 - j];\n                }\n                copy(buf, buf + m, tate);\n                m = max(c, m - c);\n            }\n        }\n        int x[p], y[p];\n        for (int i = 0; i < p; i++) {\n            cin >> x[i] >> y[i];\n        }\n\n        for (int i=0; i<p; i++) {\n            cout << yoko[x[i]] * tate[y[i]] << '\\n';\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <math.h>\n#include <stdlib.h>\n#include <string.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> P;\ntypedef priority_queue<int, vector<int>, greater<int> > minpq;\n\nint main() {\n    while (true) {    \n        int n, m, t, p;\n        cin >> n >> m >> t >> p;\n        if (n == 0) break;\n        int yoko[32], tate[32];\n        fill(yoko, yoko + n, 1);\n        fill(tate, tate + m, 1);\n\n        for (int i=0; i<t; i++) {\n            int d, c;\n            cin >> d >> c;\n            int buf[32] = {0};\n            if (d == 1) {\n                for (int j = 0; j < n; j++) {\n                    if (c + j < n) buf[j] += yoko[c + j];\n                    if (c - 1 - j >= 0) buf[j] += yoko[c - 1 - j];\n                }\n                copy(buf, buf + n, yoko);\n                n = max(c, n - c);\n            } else {\n                for (int j = 0; j < m; j++) {\n                    if (c + j < m) buf[j] += tate[c + j];\n                    if (c - 1 - j >= 0) buf[j] += tate[c - 1 - j];\n                }\n                copy(buf, buf + m, tate);\n                m = max(c, m - c);\n            }\n        }\n        int x[p], y[p];\n        for (int i = 0; i < p; i++) {\n            cin >> x[i] >> y[i];\n        }\n\n        for (int i=0; i<p; i++) {\n            cout << yoko[x[i]] * tate[y[i]] << '\\n';\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\n\nint n, m, t, p;\nint d, c, x, y;\nint mp[100][100];\nint xx, yy;\n\nint main(){\n\twhile(scanf(\"%d%d%d%d\", &n, &m, &t, &p)==4){\n\t\tif(!n&&!m&&!t&&!p)\n\t\t\tbreak;\n\t\tfor(int i = 1; i <= 99 ; i++){\n\t\t\tfor(int j = 1; j <= 99; j++){\n\t\t\t\tmp[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\tfor(int i = 1; i <= m; i++){\n\t\t\tfor(int j = 1; j <= n; j++){\n\t\t\t\tmp[i][j] = 1;\n\t\t\t}\n\t\t}\n\t\tint zuo = 1, xia = m;\n\t\tfor(int i = 1; i<= t; i++){\n\t\t\tscanf(\"%d%d\", &d, &c);\n\t\t\tif(d == 1){\n\t\t\t\tfor(int j = zuo + c; j <= zuo+2*c-1; j++){\n\t\t\t\t\tfor(int k = xia; k >= 1; k--){\n\t\t\t\t\t\tmp[k][j] += mp[k][j-c];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tzuo += c;\n\t\t\t}\n\t\t\telse if(d == 2){\n\t\t\t\tfor(int j = zuo; j < max(2*c+zuo, n+1); j++){\n\t\t\t\t\tfor(int k = xia-c; k > xia - 2*c; k--){\n\t\t\t\t\t\tmp[k][j] += mp[k+c][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\txia -= c;\n\t\t\t}\n\t\t}\n\t\t//printf(\"%d %d\\n\", zuo, xia);\n\t\tfor(int i = 1; i <= p; i++){\n\t\t\tscanf(\"%d%d\", &x, &y);\n\t\t\tprintf(\"%d\\n\", mp[xia-y][zuo+x]);\n\t\t}\n\t}\nreturn 0;\n} \n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\nint h, w, t, p;\nint a[105][105], b[105][105];\n\nint main(void)\n{\n  while(1){\n    cin >> w >> h >> t >> p;\n    if(w == 0 && h == 0 && t == 0 && p == 0) break;\n\n    for(int x = 0; x < 105; x++){\n      for(int y = 0; y < 105; y++){\n        a[x][y] = 0;\n        if(x < w && y < h) a[x][y] = 1;\n      }\n    }\n    int d, c;\n    for(int i = 0; i < t; i++){\n      cin >> d >> c;\n      for(int x = 0; x < 105; x++){\n        for(int y = 0; y < 105; y++){\n          b[x][y] = 0;\n        }\n      }\n      if(d == 1){\n        for(int x = 0; x < w; x++){\n          for(int y = 0; y < h; y++){\n            b[x][y] = a[x][y];\n          }\n        }\n        for(int x = 0; x < c; x++){\n          for(int y = 0; y < h; y++){\n            int nx = c + (c - x - 1);\n            b[nx][y] += b[x][y];\n          }\n        }\n        for(int x = 0; x < w; x++){\n          for(int y = 0; y < h; y++){\n            a[x][y] = b[x+c][y];\n          }\n        }\n        w -= min(c, w-c);\n      }\n\n      if(d == 2){\n        for(int x = 0; x < w; x++){\n          for(int y = 0; y < h; y++){\n            b[x][y] = a[x][y];\n          }\n        }\n        for(int x = 0; x < w; x++){\n          for(int y = 0; y < c; y++){\n            int ny = c + (c - y - 1);\n            b[x][ny] += b[x][y];\n          }\n        }\n        for(int x = 0; x < w; x++){\n          for(int y = 0; y < h; y++){\n            a[x][y] = b[x][y+c];\n          }\n        }\n        h -= min(c, h-c);\n      }\n    }\n\n    int x, y;\n    for(int i = 0; i < p; i++){\n      cin >> x >> y;\n      cout << a[x][y] << endl;\n    }\n  }\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\nint main(){\n    int w,h,t,p;\n    while(cin>>w>>h>>t>>p){\n        if(w+h+t+p==0)break;\n        vector<vector<int>> v(1000,vector<int>(1000,0)); //適当に大きく取る\n        for(int i=0;i<h;i++){\n            for(int j=0;j<w;j++){\n                v[1000-i-1][j]=1;\n            }\n        }\n        int x0=0,y0=999; //現状の原点\n        auto debug=[&](int y,int x){\n            for(int i=0;i<y;i++){\n                for(int j=0;j<x;j++){\n                    cout<<\" \"<<v[1000-i-1][j];\n                }\n                cout<<endl;\n            }\n            cout<<\"x0,y0= \"<<x0<<\" \"<<y0<<endl;\n        };\n        for(int i=0;i<t;i++){\n            int d,c;\n            cin>>d>>c;\n            if(d==1){ //横向きに折る\n                for(int j=0;j<y0+1;j++){\n                    int idx=x0+c;\n                    //cout<<idx<<endl;\n                    for(int k=0;k<c;k++){\n                        v[j][idx+k]+=v[j][idx-k-1];\n                    }\n                }\n                x0=x0+c;\n            }else { //縦向きに折る\n                for(int j=x0;j<1000;j++){\n                    for(int k=0;k<c;k++){\n                        int idx=y0-c;\n                        v[idx-k][j]+=v[idx+k+1][j];\n                    }\n                }\n                //debug(5,5);\n                y0=y0-c;\n            }\n        }\n        \n        //debug(5,5);\n        for(int i=0;i<p;i++){\n            int x,y;\n            cin>>x>>y;\n            cout<<v[y0-y][x0+x]<<endl;\n        }\n    }\n\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#define ll long long\n#define N 100000\n\nusing namespace std;\n\nint g[600][600], dx, dy;\n\nint main(void) {\n#ifdef _DEBUG\n\tfreopen(\"1.in\", \"r\", stdin);\n#else \n\tios::sync_with_stdio(0); cin.tie(0); cout.tie(0);\n#endif\n\tint n, m, t, p;\n\twhile (cin >> n >> m >> t >> p, n) {\n\t\tdx = dy = 0;\n\t\tmemset(g, 0, sizeof(g));\n\t\tfor (int i = 0; i != n; ++i) for (int j = 0; j != m; ++j) g[i][j] = 1;\n\t\twhile (t--) { \n\t\t\tint d, c; cin >> d >> c;\n\t\t\tif (d == 1) {\n\t\t\t\tfor (int i = 0; i != c; ++i)\n\t\t\t\t\tfor (int j = 0; j != m - dy; ++j)\n\t\t\t\t\t\tg[dx + c + i][dy + j] += g[dx + c - i - 1][dy + j];\n\t\t\t\tdx += c;\n\t\t\t\tif (n < dx + 2 * c) n = dx + 2 * c;\n\t\t\t}\n\t\t\telse if (d == 2) {\n\t\t\t\tfor (int j = 0; j != c; ++j)\n\t\t\t\t\tfor (int i = 0; i != n - dx; ++i)\n\t\t\t\t\t\tg[dx + i][dy + c + j] += g[dx + i][dy + c - j - 1];\n\t\t\t\tdy += c;\n\t\t\t\tif (m < dy + 2 * c) m = dy + 2 * c;\n\t\t\t}\n\t\t}\n\t\twhile (p--) {\n\t\t\tint x, y; cin >> x >> y;\n\t\t\tcout << g[dx + x][dy + y] << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>    // std::copy\nusing namespace std;\n\nint main(void){\n    // Your code here!\n    while(true){\n        int n,m,t,p;\n        cin >> n >> m >> t >> p;\n        \n        if(n == 0 && m == 0 && t == 0 && p == 0){\n            break;\n        }\n        vector <int> origami(n*m,1);\n        for(int i=0;i<t;i++){\n            int way;\n            int c;\n            cin >> way >> c;\n            vector <int> origamiTemp;\n            switch(way){\n            case 1://横\n                if(n / 2 >= c){\n                    for(int j = 0;j<m;j++){\n                        for(int k=0;k<n-c;k++){\n                            int value = origami[k + c + j*n];\n                            if(k < c){\n                                value += origami[(c - k - 1) + j*n];\n                            }\n                            \n                            origamiTemp.push_back(value);\n                        }\n                    }\n                    n = n - c;\n                }else{\n                    //cout << \"success\" << c << endl;;\n                    for(int j = 0;j<m;j++){\n                        for(int k=0;k<c;k++){\n                            int value;\n                            if(k >= n - c){\n                                //int pos = k - (n - c);\n                                //int num = n - c - pos ;\n                                value = origami[c - k - 1  + j*n];\n                                //cout << num <<\" \";\n                                //cout << num + j* n <<\" \";\n                            }else{\n                                value = origami[c + k + j*n] + origami[c - 1 - k + j*n];\n                                //cout << \"aaa\" << \" \";\n                            }\n                            //cout << value <<\" \" <<k <<endl;\n                            origamiTemp.push_back(value);\n                        }\n                        //cout << endl;\n                    }\n                    //cout <<endl;\n                    n = c;\n                }\n                break;\n            case 2://縦\n                if(m / 2 >= c){\n                    for(int j = 0;j<m-c;j++){\n                        for(int k=0;k<n;k++){\n                            int value = origami[k + j*n];\n                            if(j >= m - 2*c){\n                                int temp = j - (m - 2*c);\n                                value += origami[k + (m - temp - 1)*n];\n                            }\n                            \n                            origamiTemp.push_back(value);\n                        }\n                    }\n                    m = m - c;\n                }else{\n                    for(int j = 0;j<c;j++){\n                        for(int k=0;k<n;k++){\n                            int value;\n                            if(j < 2 * c - m){\n                                value = origami[k+(m - j - 1)*n];\n                            }else{\n                                int c2m = 2 * c - m;\n                                int pos = j - c2m;\n                                value = origami[k + (pos)*n] + origami[k + (m - j - 1)*n];\n                            }\n                            \n                            origamiTemp.push_back(value);\n                        }\n                    }\n                    m = c;\n                }\n                break;\n            }\n            origami = origamiTemp;\n            /*for(int i=0;i<m;i++){\n                for(int j=0;j<n;j++){\n                    cout<<origami[j +i * n] <<\" \";\n                }\n                cout << endl;\n            }\n            cout <<endl;*/\n        }\n        \n        for(int i=0;i<p;i++){\n            int x,y;\n            cin >> x>> y;\n            y = m - y - 1;\n            cout << origami[x + y * n] <<endl;\n        }\n        \n        //cout<< ans<<endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint a[1000][1000];\nint n,m,x,y,p,q;\nmain()\n{\n\twhile(cin>>n>>m>>p>>q,n)\n\t{\n\t\tx=y=0;\n\t\tfor(int i=0;i<1000;i++)for(int j=0;j<1000;j++)a[i][j]=0;\n\t\tfor(int i=0;i<n;i++)for(int j=0;j<m;j++)a[i][j]=1;\n\t\tfor(;p--;)\n\t\t{\n\t\t\tint d,c;cin>>d>>c;\n\t\t\tif(d==2)\n\t\t\t{\n\t\t\t\tfor(int i=0;i<1000;i++)\n\t\t\t\t{\n\t\t\t\t\tfor(int j=0;j<c;j++)a[i][y+2*c-j-1]+=a[i][y+j];\n\t\t\t\t}\n\t\t\t\ty+=c;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor(int j=0;j<1000;j++)\n\t\t\t\t{\n\t\t\t\t\tfor(int i=0;i<c;i++)a[x+2*c-i-1][j]+=a[x+i][j];\n\t\t\t\t}\n\t\t\t\tx+=c;\n\t\t\t}\n\t\t}\n\t\tfor(;q--;)\n\t\t{\n\t\t\tint A,b;cin>>A>>b;\n\t\t\tcout<<a[x+A][y+b]<<endl;\n\t\t}\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <bitset>\n#include <fstream>\n#include <string>\n#include <cstring>\n#include <cmath>\n#include <cstdlib>\n#include <ctime>\n#include <vector>\n#include <algorithm>\n#include <numeric>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <functional>\n#include <cctype>\n#include <list>\n#include <limits>\n#define Debug 0\n//#include <boost/multiprecision/cpp_int.hpp>\n\nconst double EPS = (1e-10);\n\n\nusing namespace std;\nusing Int = long long;\n//using namespace boost::multiprecision;\n\nconst Int MOD = 1000000007;\n\nInt mod_pow(Int x, Int n) {\n    Int res = 1;\n    while(n > 0) {\n        if(n & 1) res = (res * x) % MOD; //ビット演算(最下位ビットが1のとき)\n        x = (x * x) % MOD;\n        n >>= 1; //右シフト(n = n >> 1)\n    }\n    return res;\n}\n\n//最大公約数\ntemplate<typename T>\nT gcd(T a, T b) {\n    return b != 0 ? gcd(b, a % b) : a;\n}\n\n//最小公倍数\ntemplate<typename T>\nT lcm(T a, T b) {\n    return a * b / gcd(a, b);\n}\n\nvoid fold(int N, int M, int d, int c, vector<vector<long long>> &field, int origin_x, int origin_y) {\n    if (d == 1) {\n        for (int x = origin_x + c; x < origin_x + c + c; x++) {\n            for (int y = origin_y; y < origin_y + M; y++) {\n                field[x][y] += field[origin_x + c - (x - origin_x - c + 1)][y];\n            }\n        }\n    } else {\n        for (int y = origin_y + c; y < origin_y + c + c; y++) {\n            for (int x = origin_x; x < origin_x + N; x++) {\n                field[x][y] += field[x][origin_y + c - (y - origin_y - c + 1)];\n            }\n        }\n    }\n}\n\nvector<long long> solve(int N, int M, int T, int P) {\n    //field[x][y] := 折り紙の左からx番目,　下からy番目のマス目(0-indexed)\n    vector<vector<long long>> field(1000, vector<long long>(1000));\n    for (int i = 0; i < N; i++) {\n        for (int j = 0; j < M; j++) {\n            field[i][j] = 1;\n        }\n    }\n\n    int origin_x = 0;\n    int origin_y = 0;\n    for (int i = 0; i < T; i++) {\n        int d, c; cin >> d >> c;\n        fold(N, M, d, c, field, origin_x, origin_y);\n        if (d == 1) {\n            origin_x += c;\n        } else {\n            origin_y += c;\n        }\n    }\n    vector<long long> ret;\n    for (int i = 0; i < P; i++) {\n        int x, y; cin >> x >> y;\n        ret.push_back(field[origin_x + x][origin_y + y]);\n    }\n    if (Debug) {\n        for (int y = M-1; y >= 0; y--) {\n            for (int x = 0; x < N; x++) {\n                cout << field[x][y] << \" \";\n            }\n            cout << endl;\n        }\n    }\n    return ret;\n}\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    vector<vector<long long>> ans;\n    while (1) {\n        int N, M, T, P; cin >> N >> M >> T >> P;\n        if (!N && !M && !T && !P) break;\n        ans.push_back(solve(N, M, T, P));\n    }\n    for (auto i: ans) {\n        for (auto j: i) {\n            cout << j << endl;\n        }\n    }\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nint main() {\n  while (true) {\n    int n, m, t, p;\n    cin >> n >> m >> t >> p;\n    if (n == 0)\n      break;\n    int size = 2000;\n    vector<vector<int>> mp(size, vector<int>(size));\n    int h = 1000, w = 1000;\n    for (int i = 0; i < n; i++)\n      for (int j = 0; j < m; j++)\n        mp[i + h][j + w] = 1;\n    for (int i = 0; i < t; i++) {\n      int d, c;\n      cin >> d >> c;\n      if (d == 1) {\n        for (int j = 0; j < size; j++) {\n          for (int k = 0; h + c - k - 1 >= 0 && h + c + k < size; k++) {\n            if (mp[h + c + k][j] + mp[h + c - k - 1][j] == 0)\n              break;\n            mp[h + c + k][j] += mp[h + c - k - 1][j];\n            mp[h + c - k - 1][j] = 0;\n          }\n        }\n        if (n > c * 2) {\n          n = n - c;\n        } else {\n          n -= n - c;\n        }\n        h += c;\n      } else {\n        c = m - c;\n        for (int j = 0; j < size; j++) {\n          for (int k = 0; w + c - k - 1 >= 0 && w + c + k < size; k++) {\n            if (mp[j][w + c - k - 1] + mp[j][w + c + k] == 0)\n              break;\n            mp[j][w + c - k - 1] += mp[j][w + c + k];\n            mp[j][w + c + k] = 0;\n          }\n        }\n        if (m > c * 2) {\n          w -= m - 2 * c;\n          m = m - c;\n        } else {\n          m -= m - c;\n        }\n      }\n    }\n    for (int i = 0; i < p; i++) {\n      int x, y;\n      cin >> x >> y;\n      y = m - y - 1;\n      cout << mp[x + h][y + w] << endl;\n    }\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define FOR(i,a,b) for(int i = (a); i < (b); ++i)\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define all(x) (x).begin(),(x).end()\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v; return v;}\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector< vector<int> > Mat;\ntypedef tuple<int, int, int, int> T;\n\nconst int MOD = (int)1e9+7;\nconst int INF = (int)1e9;\nconst int dx[] = {0, 1, 0, -1};\nconst int dy[] = {1, 0, -1, 0};\nconst int ddx[] = {0, 1, 1, 1, 0, -1, -1, -1};\nconst int ddy[] = {1, 1, 0, -1, -1, -1, 0, 1};\n\nint main(){\n    ios::sync_with_stdio(false);\n\tcin.tie(0);\n\n    int n, m, t, p;\n    while(1){\n        cin >> n >> m >> t >> p;\n        if(n+m+t+p == 0) break;\n        vector< vector<int> > paper(m*2, vector<int>(n*2, 0));\n        int ox = 0, oy = 0, dx = n, dy = m;\n        rep(i, n) rep(j, m) paper[i][j] += 1;\n        \n\n        rep(i, t){\n            int d, c;\n            cin >> d >> c;\n            if(d == 1){\n                dx = max(dx, ox+(c+1)*2);\n                FOR(i, ox, ox+c){\n                    FOR(j, oy, dy) paper[j][c+i] += paper[j][i];\n                }\n                ox += c;\n            }else{\n                dy = max(dy, oy+(c+1)*2);\n                FOR(i, oy, oy+c){\n                    FOR(j, ox, dx) paper[c+i][j] += paper[i][j];\n                }\n                oy += c;\n            }\n        }\n\n        rep(i, p){\n            int x, y;\n            cin >> x >> y;\n            cout << paper[y+oy][x+ox] << endl;\n        }\n\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing lint = long long;\ntemplate<class T = int> using V = vector<T>;\ntemplate<class T = int> using VV = V< V<T> >;\n\nint main() {\n  cin.tie(nullptr); ios::sync_with_stdio(false);\n  while (true) {\n    int n, m, t, p; cin >> n >> m >> t >> p;\n    if (!n) break;\n    VV<> a(n, V<>(m, 1));\n    while (t--) {\n      int d, c; cin >> d >> c;\n      if (d == 1) {\n        VV<> na(max(c, n - c), V<>(m));\n        for (int j = 0; j < m; ++j) {\n          for (int i = 0; i < n - c; ++i) na[i][j] += a[c + i][j];\n          for (int i = 0; i < c; ++i) na[i][j] += a[c + ~i][j];\n        }\n        swap(a, na);\n        n = a.size();\n      } else {\n        VV<> na(n, V<>(max(c, m - c)));\n        for (int i = 0; i < n; ++i) {\n          for (int j = 0; j < m - c; ++j) na[i][j] += a[i][c + j];\n          for (int j = 0; j < c; ++j) na[i][j] += a[i][c + ~j];\n        }\n        swap(a, na);\n        m = a[0].size();\n      }\n    }\n    while (p--) {\n      int x, y; cin >> x >> y;\n      cout << a[x][y] << '\\n';\n    }\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n \n#define MAX 500\n \nusing namespace std;\n\nint main(void){\n    while(1){\n        int kami[MAX][MAX]={0};\n\t\tint w, h, t, p;\n\t\tcin >> w >> h >> t >> p;\n        if(!w && !h && !t && !p) break;\n        for(int i=0; i<h; i++){\n\t\t\tfill(kami[i], kami[i]+w, 1);\n        }\n \n        int origin_x = 0, origin_y =0;\n        for(int k=0; k<t; k++){\n\t\t\tint d, c;\n\t\t\tcin >> d >> c;\n\t\t\t\n\t\t\tint dist = 1;\n            if(d == 1){\n\t\t\t\tfor(int j=origin_x+c; j<origin_x+(2*c); j++){\n                     for(int i=origin_y; i<MAX; i++){\n                        kami[i][j] += kami[i][j-dist];\n\t                }\n\t\t            dist += 2;\n\t\t\t    }\n                origin_x += c;\n            } else{\n                for(int i=origin_y+c; i<origin_y+(2*c); i++){\n                    for(int j=origin_x; j<MAX; j++){\n                        kami[i][j] += kami[i-dist][j];\n                    }\n                    dist += 2;\n                }\n                origin_y += c;\n            }\n        }\n         \n        for(int k=0; k<p; k++){\n\t\t\tint x, y;\n\t\t\tcin >> x >> y;\n\t\t\tcout << kami[origin_y+y][origin_x+x] << endl;\n        }\n    }\n \n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define INF_LL (int64)1e18\n#define INF (int32)1e9\n#define REP(i, n) for(int64 i = 0;i < (n);i++)\n#define FOR(i, a, b) for(int64 i = (a);i < (b);i++)\n#define all(x) x.begin(),x.end()\n#define fs first\n#define sc second\n\nusing int32 = int_fast32_t;\nusing uint32 = uint_fast32_t;\nusing int64 = int_fast64_t;\nusing uint64 = uint_fast64_t;\nusing PII = pair<int32, int32>;\nusing PLL = pair<int64, int64>;\n\nconst double eps = 1e-10;\n\ntemplate<typename A, typename B>inline void chmin(A &a, B b){if(a > b) a = b;}\ntemplate<typename A, typename B>inline void chmax(A &a, B b){if(a < b) a = b;}\n\ntemplate<typename T>\nvector<T> make_v(size_t a){return vector<T>(a);}\n\ntemplate<typename T,typename... Ts>\nauto make_v(size_t a,Ts... ts){\n  return vector<decltype(make_v<T>(ts...))>(a,make_v<T>(ts...));\n}\n\ntemplate<typename T,typename U,typename... V>\ntypename enable_if<is_same<T, U>::value!=0>::type\nfill_v(U &u,const V... v){u=U(v...);}\n\ntemplate<typename T,typename U,typename... V>\ntypename enable_if<is_same<T, U>::value==0>::type\nfill_v(U &u,const V... v){\n  for(auto &e:u) fill_v<T>(e,v...);\n}\n\nint main(void) {\n  int64 n, m, t, p;\n  while(cin >> n >> m >> t >> p && n+m+t+p) {\n  vector<vector<int64>> v(m, vector<int64>(n, 1));\n  REP(i, t) {\n    vector<vector<int64>> nv(m, vector<int64>(n, 0));\n    int64 ty, c;\n    cin >> ty >> c;\n    if (ty == 1) {\n      REP(y, m) {\n        REP(x, n-c) {\n          nv[y][x] += v[y][x+c];\n        }\n        REP(x, c) {\n          nv[y][c-x-1] += v[y][x];\n        }\n      }\n    } else {\n      REP(x, n) {\n        REP(y, m-c)\n          nv[y][x] += v[y+c][x];\n        REP(y, c)\n          nv[c-y-1][x] += v[y][x];\n      }\n    }\n    swap(nv, v);\n  }\n  int64 res = 0;\n  REP(i, p) {\n    int64 x, y;\n    cin >> x >> y;\n    cout << v[y][x] << endl;\n  }\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n, m, t, p, mm, nn;\nint memo[40][40];\nint d, c, x, y;\n\nint main() {\n  int i, j, a, ans;\n  while(1) {\n    cin >> n >> m >> t >> p;\n    if(n + m + t + p == 0) break;\n    nn = n;\n    mm = m;\n    ans = 0;\n    for(i = 0; i < 40; ++i)\n      for(j = 0; j < 40; ++j) memo[i][j] = 0;\n    for(i = 0; i < m; i++)\n      for(j = 0; j < n; j++) memo[i][j] = 1;\n    for(a = 0; a < t; a++) {\n      cin >> d >> c;\n      if(d == 1) {\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < c / 2; j++) { swap(memo[i][j], memo[i][c - j - 1]); }\n        if(nn - c > c / 2)\n          nn -= c;\n        else\n          nn = c;\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < nn; j++) {\n            if(j < c)\n              memo[i][j] += memo[i][j + c];\n            else\n              memo[i][j] = memo[i][j + c];\n          }\n      }\n      else {\n        for(i = 0; i < c / 2; i++)\n          for(j = 0; j < nn; j++) { swap(memo[i][j], memo[c - i - 1][j]); }\n        if(mm - c > c / 2)\n          mm -= c;\n        else\n          mm = c;\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < nn; j++) {\n            if(i < c)\n              memo[i][j] += memo[i + c][j];\n            else\n              memo[i][j] = memo[i + c][j];\n          }\n      }\n      for(i = 0; i < m; i++)\n        for(j = 0; j < n; j++)\n          if(i >= mm || j >= nn) memo[i][j] = 0;\n      /*for(i=0;i<m;i++){\n        for(j=0;j<n;j++)cout << memo[i][j]<<\" \";\n        cout << endl;\n        }\n        cout << endl;*/\n    }\n    for(a = 0; a < p; a++) {\n      cin >> x >> y;\n      cout << memo[y][x] << endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define fi first\n#define se second\n#define pb push_back\n#define rep(i, s, n) for (int i = s; i < n; i++)\n#define rrep(i, s, n) for (int i = (n)-1; i >= (s); i--)\n#define all(a) a.begin(),a.end()\nconst long long MOD = 1e9+7, INF = 1e18;\ntemplate<class T>inline bool chmax(T&a,T b){if(a<b){a=b;return true;}return false;}\ntemplate<class T>inline bool chmin(T&a,T b){if(a>b){a=b;return true;}return false;}\n\n\n\nsigned main(){\n\tint N,M,T,P;\n\tvector<int>ans;\n\twhile(cin>>N>>M>>T>>P,N||M||T||P){\n\t\tvector<vector<int>>v(M*30,vector<int>(N*30,0));\n\t\trep(i,0,M)rep(j,0,N)v[i][j]=1;\n\t\tpair<int,int>now = {0,0};\n\t\trep(_,0,T){\n\t\t\tint a,b;\n\t\t\tcin>>a>>b;\n\t\t\tif(a==2){\n\t\t\t\trep(i,0,b){\n\t\t\t\t\trep(j,0,N*30){\n\t\t\t\t\t\tv[now.fi+b+b-i-1][j]+=v[now.fi+i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnow.fi += b;\n\t\t\t}else{\n\t\t\t\trep(i,0,M*30){\n\t\t\t\t\trep(j,0,b){\n\t\t\t\t\t\tv[i][now.se+b+b-j-1]+=v[i][now.se+j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnow.se += b;\n\t\t\t}\n\t\t\t/*\n\t\t\tcout<<now.fi<<\" \"<<now.se<<endl;\n\t\t\trep(i,0,M*2){\n\t\t\t\trep(j,0,N*2){\n\t\t\t\t\tif(j)cout<<\" \";\n\t\t\t\t\tcout<<v[i][j];\n\t\t\t\t}\n\t\t\t\tcout<<endl;\n\t\t\t}\n\t\t\t*/\n\t\t}\n\t\trep(i,0,P){\n\t\t\tint a,b;\n\t\t\tcin>>a>>b;\n\t\t\tans.push_back(v[now.fi+b][now.se+a]);\n\t\t}\n\t\t/*\n\t\tcout<<now.fi<<\" \"<<now.se<<endl;\n\t\trep(i,0,M*2){\n\t\t\trep(j,0,N*2){\n\t\t\t\tif(j)cout<<\" \";\n\t\t\t\tcout<<v[i][j];\n\t\t\t}\n\t\t\tcout<<endl;\n\t\t}\n\t\t*/\n\t}\n\tfor(auto e:ans){\n\t\tcout<<e<<endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\n\nint x1,x2,y1,y2;\nint ma[50][50];\n\nvoid init()\n{\n    for(int i=1;i<=45;i++)\n        for(int j=1;j<=45;j++)\n            ma[i][j]=0;\n    for(int i=1;i<=x2;i++)\n        for(int j=1;j<=y2;j++)\n    ma[i][j]=1;\n}\n\nvoid fold1(int t)\n{\n    for(int i=y1+1;i<=y2+1;i++)\n        for(int j=1;j<=t-x1;j++)\n    {\n        ma[t+j][i]+=ma[t-j+1][i];\n        ma[t-j+1][i]=0;\n    }\n    x1=t;\n    x2=max(2*t-x1,x2);\n}\nvoid fold2(int t)\n{\n    for(int i=x1+1;i<=x2+1;i++)\n        for(int j=1;j<=t-y1;j++)\n    {\n        ma[i][t+j]+=ma[i][t-j+1];\n        ma[i][t-j+1]=0;\n    }\n    y1=t;\n    y2=max(2*t-y1,y2);\n}\n\nint main()\n{\n    int n, m, t, p;\n    while(1)\n    {\n        scanf(\"%d%d%d%d\",&n,&m,&t,&p);\n        if(n==0) return 0;\n        x1=0;x2=n;\n        y1=0;y2=m;\n        init();\n        while(t--)\n        {\n            int c, d;\n            scanf(\"%d%d\",&c,&d);\n            if(c==1) fold1(d+x1);\n            if(c==2) fold2(d+y1);\n        }\n        while(p--)\n        {\n            int x, y;\n            scanf(\"%d%d\",&x,&y);\n            printf(\"%d\\n\",ma[x+x1+1][y+y1+1]);\n        }\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <tuple>\n#include <utility>\nusing namespace std;\n\nusing vector2D = vector< vector<int> >;\n\nvector2D rotate_right(vector2D board) {\n    int H = board.size(), W = board[0].size();\n\n    vector2D ret(W, vector<int>(H));\n    for(int i=0; i<H; i++) {\n        for(int j=0; j<W; j++) {\n            int ni = j, nj = H - i - 1;\n            ret[ni][nj] = board[i][j];\n        }\n    }\n\n    return ret;\n}\n\nvector2D rotate_left(vector2D board) {\n    vector2D ret = rotate_right(board);\n\n    reverse(ret.begin(), ret.end());\n    for(int i=0; i<(int)ret.size(); i++) {\n        reverse(ret[i].begin(), ret[i].end());\n    }\n    return ret;\n}\n\npair< vector2D, vector2D > split_board(vector2D board, int col) {\n    int H = board.size(), W = board[0].size();\n\n    vector2D A(H, vector<int>(col)), B(H, vector<int>(W - col));\n    for(int i=0; i<H; i++) {\n        for(int j=0; j<col; j++) {\n            int idx = j;\n            A[i][idx] = board[i][j];\n        }\n        for(int j=col; j<W; j++) {\n            int idx = j - col;\n            B[i][idx] = board[i][j];\n        }\n    }\n\n    for(int i=0; i<H; i++) {\n        reverse(A[i].begin(), A[i].end());\n    }\n\n    return make_pair(A, B);\n}\n\nvector2D fold(vector2D board, int col) {\n    vector2D A, B;\n    tie(A, B) = split_board(board, col);\n\n    int H = max(A.size(), B.size());\n    int W = max(A[0].size(), B[0].size());\n\n    vector2D ret(H, vector<int>(W));\n    for(int i=0; i<H; i++) {\n        for(int j=0; j<W; j++) {\n            if(i < A.size() && j < A[0].size()) {\n                ret[i][j] += A[i][j];\n            }\n            if(i < B.size() && j < B[0].size()) {\n                ret[i][j] += B[i][j];\n            }\n        }\n    }\n    return ret;\n}\n\nvoid print_board(vector2D board) {\n    cout << \"status:\" << endl;\n\n    int H = board.size(), W = board[0].size();\n    for(int i=0; i<H; i++) {\n        for(int j=0; j<W; j++) {\n            cout << board[i][j] << \" \";\n        }\n        cout << endl;\n    }\n}\n\nint main() {\n    int W, H, T, P;\n    while(cin >> W >> H >> T >> P, W + H + T + P) {\n        vector2D board(H, vector<int>(W, 1));\n\n        for(int i=0; i<T; i++) {\n            // print_board(board);\n\n            int d, col; cin >> d >> col;\n            if(d == 2) {\n                board = rotate_right(board);\n            }\n\n            board = fold(board, col);\n\n            if(d == 2) {\n                board = rotate_left(board);\n            }\n        }\n\n        H = board.size(), W = board[0].size();\n        for(int i=0; i<P; i++) {\n            int x, y; cin >> x >> y;\n            // printf(\"x = %d, y = %d, H = %d, W = %d\\n\", x, y, H, W);\n            cout << board[H - y - 1][x] << endl;\n        }\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <map>\n#include <vector>\n#define rep(i, n) for(i = 0; i < n; i++)\nusing namespace std;\ntypedef pair<int, int> P;\t//(x, y)\n\nint w, h, t, p;\nint d[20], c[20];\nint x[20], y[20];\n\nvoid solve() {\n\tmap<P, int> mp[21];\n\tmap<P, int>::iterator it;\n\tint i, j;\n\t\n\trep(i, w) rep(j, h) mp[0][P(i, j)] = 1;\n\trep(i, t) {\n\t\tfor (it = mp[i].begin(); it != mp[i].end(); it++) {\n\t\t\tP pos = it->first;\n\t\t\tint px = pos.first;\n\t\t\tint py = pos.second;\n\t\t\tif (d[i] == 1) {\n\t\t\t\tif (px < c[i]) {\n\t\t\t\t\tpx = 2 * c[i] - px - 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (d[i] == 2) {\n\t\t\t\tif (py < c[i]) {\n\t\t\t\t\tpy = 2 * c[i] - py - 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (mp[i + 1].find(P(px, py)) == mp[i + 1].end()) {\n\t\t\t\tmp[i + 1][P(px, py)] = 0;\n\t\t\t}\n\t\t\t//cout << \"px, py = \" << px << \", \" << py << endl;\n\t\t\tmp[i + 1][P(px, py)] += it->second;\n\t\t}\n\t\t\n\t\t//mp[i+1]の相対座標に変換\n\t\tint minX = 114514;\n\t\tint minY = 114514;\n\t\tmap<P, int> tmp;\n\t\tfor (it = mp[i + 1].begin(); it != mp[i + 1].end(); it++) {\n\t\t\tP pos = it->first;\n\t\t\tint px = pos.first;\n\t\t\tint py = pos.second;\n\t\t\tminX = min(minX, px);\n\t\t\tminY = min(minY, py);\n\t\t}\n\t\tfor (it = mp[i + 1].begin(); it != mp[i + 1].end(); it++) {\n\t\t\tP pos = it->first;\n\t\t\ttmp[P(pos.first - minX, pos.second - minY)] = it->second;;\n\t\t}\n\t\tmp[i + 1] = tmp;\n\t\t\n\t\t/*cout << endl;\n\t\tfor (it = mp[i + 1].begin(); it != mp[i + 1].end(); it++) {\n\t\t\tcout << (it->first).first << \", \" << (it->first).second << \" -> \" << it->second << endl;\n\t\t}*/\n\t}\n\t\n\trep(i, p) {\n\t\tcout << mp[t][P(x[i], y[i])] << endl;\n\t}\n}\n\nint main() {\n\twhile (cin >> w >> h >> t >> p) {\n\t\tif (!w) break;\n\t\tint i;\n\t\trep(i, t) cin >> d[i] >> c[i];\n\t\trep(i, p) cin >> x[i] >> y[i];\n\t\tsolve();\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <set>\nusing namespace std;\n#define mp make_pair\n#define pb push_back\n#define rep(i,n) for(int i=0;i<n;i++)\n#define repn(i,n) for(int i=1;i<=n;i++)\ntypedef long long ll;\n\nint n,m,a[2505][2505];\nint t,p;\n\nint main(){\n    while(1){\n        cin>>m>>n>>t>>p;\n        if(m==0) return 0;\n        rep(i,2505) rep(j,2505) a[i][j] = 0;\n        for(int i=1200;i<1200+n;i++) for(int j=1200;j<1200+m;j++) a[i][j] = 1;\n        int a1 = 1200, a2 = 1200+n-1;\n        int b1 = 1200, b2 = 1200+m-1;\n        rep(i,t){\n            int d,c; cin>>d>>c;\n\t\t\tint aa=1e9,bb=1e9;\n\t\t\tint ac=-1e9,bc=-1e9;\n\t\t\t\n            if(d == 1){\n                for(int x=b1;x<b1+c;x++){\n\t\t\t\t\tfor(int i=a1;i<=a2;i++) {a[i][(b1+c)*2-1-x] += a[i][x];if(a[i][(b1+c)*2-1-x]){\n\t\t\t\t\t\taa=min(aa,i); ac=max(aa,i); bb=min(bb,(b1+c)*2-1-x); bc=max(bc,(b1+c)*2-1-x);}\n\t\t\t\t\t\ta[i][x] = 0;}\n                }\n            }\n            else if(d == 2){\n                for(int x=a2;x>a2-c;x--){\n\t\t\t\t\tfor(int i=b1;i<=b2;i++) { a[(a2-c)*2+1-x][i] += a[x][i];if(a[(a2-c)*2+1-x][i] ){\n\t\t\t\t\t\taa=min(aa,(a2-c)*2+1-x); ac=max(aa,(a2-c)*2+1-x); bb=min(bb,i); bc=max(bc,i);}a[x][i] = 0;}\n                }\n            }\n\t\t\tint  A= aa-30,B=bb-30;\n\t\t\tfor(int i=A;i<=A+60;i++) for(int j=B;j<=B+60;j++){\n\t\t\t\tif(a[i][j]){\n\t\t\t\t\taa=min(aa,i); ac = max(ac,i);\n\t\t\t\t\tbb=min(bb,j); bc = max(bc,j);\n\t\t\t\t}\n\t\t\t}\n            a1 = aa; a2 = ac; b1 = bb; b2 = bc;\n        }\n        rep(i,p){\n            int x,y; cin>>x>>y;\n            cout << a[a2-y][b1+x] << endl;\n        }\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\nusing namespace std;\n\nvoid tate_yose(vector<vector<int> >& origami, int h_shift) {\n    for (int i = 0; i < origami.size() - h_shift; i++) {\n        for (int j = 0; j < origami[i].size(); j++) {\n            origami[i][j] = origami[i + h_shift][j];\n        }\n    }\n}\n\nvoid yoko_yose(vector<vector<int> >& origami, int w_shift) {\n    for (int i = 0; i < origami.size(); i++) {\n        for (int j = 0; j < origami[i].size() - w_shift; j++) {\n            origami[i][j] = origami[i][j + w_shift];\n        }\n    }\n}\n\nvoid tate_ori(vector<vector<int> >& origami, int c) {\n    for (int i = 0; i < c; i++) {\n        for (int j = 0; j < origami[i].size(); j++) {\n            origami[2 * c - i - 1][j] += origami[i][j];\n            origami[i][j] = 0;\n        }\n    }\n    tate_yose(origami, c);\n}\n\nvoid yoko_ori(vector<vector<int> >& origami, int c) {\n    for (int i = 0; i < origami.size(); i++) {\n        for (int j = 0; j < c; j++) {\n            origami[i][2 * c - j - 1] += origami[i][j];\n            origami[i][j] = 0;\n        }\n    }\n    yoko_yose(origami, c);\n}\n\nvoid solve(int n, int m, int t, int p) {\n    vector<vector<int> > origami(3 * m + 3, vector<int>(3 * n + 3, 0));\n    for (int i = 0; i < m; i++) {\n        for (int j = 0; j < n; j++) origami[i][j] = 1;\n    }\n    int d, c;\n    for (int i = 0; i < t; i++) {\n        cin >> d >> c;\n        if (d == 1) yoko_ori(origami, c);\n        else tate_ori(origami, c);\n    }\n    int x, y;\n    vector<int> ans(p);\n    for (int i = 0; i < p; i++) {\n        cin >> x >> y;\n        ans[i] = origami[y][x];\n    }\n    for (int i = 0; i < p; i++) cout << ans[i] << endl;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    int N, M, T, P;\n    while (true) {\n        cin >> N >> M >> T >> P;\n        if (N == 0 && M == 0 && T == 0 && P == 0) break;\n        solve(N, M, T, P);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdint>\n#include <vector>\n#include <algorithm>\n#include <utility>\n#include <tuple>\n\nvoid yoko(std::vector<std::vector<int>>& a, size_t c) {\n  size_t h = a.size();\n  size_t w = a[0].size();\n\n  std::vector<std::vector<int>> b(h);\n  for (size_t i = 0; i < h; ++i) {\n    std::vector<int> a0(c);\n    for (size_t j = 0; j < c; ++j)\n      a0[j] += a[i][j];\n\n    std::reverse(a0.begin(), a0.end());\n\n    std::vector<int> a1(w-c);\n    for (size_t j = c; j < w; ++j)\n      a1[j-c] += a[i][j];\n\n    b[i].resize(std::max(c, w-c));\n    for (size_t j = 0; j < c; ++j) b[i][j] += a0[j];\n    for (size_t j = 0; j < w-c; ++j) b[i][j] += a1[j];\n  }\n  a = std::move(b);\n}\n\nvoid rotate(std::vector<std::vector<int>>& a) {\n  size_t h = a.size();\n  size_t w = a[0].size();\n  std::vector<std::vector<int>> b(w, std::vector<int>(h));\n  for (size_t i = 0; i < h; ++i)\n    for (size_t j = 0; j < w; ++j)\n      b[j][h-1-i] = a[i][j];\n\n  a = std::move(b);\n}\n\nvoid tate(std::vector<std::vector<int>>& a, size_t c) {\n  rotate(a);\n  yoko(a, c);\n  rotate(a);\n  rotate(a);\n  rotate(a);\n}\n\nint testcase_ends () {\n  size_t n, m, t, p;\n  scanf(\"%zu %zu %zu %zu\", &n, &m, &t, &p);\n  if (n == 0 && m == 0 && t == 0 && p == 0) return 1;\n\n  std::vector<std::vector<int>> a(m, std::vector<int>(n, 1));\n  for (size_t i = 0; i < t; ++i) {\n    int d;\n    size_t c;\n    scanf(\"%d %zu\", &d, &c);\n\n    if (d == 1) {\n      yoko(a, c);\n    } else {\n      tate(a, c);\n    }\n  }\n\n  for (size_t i = 0; i < p; ++i) {\n    size_t x, y;\n    scanf(\"%zu %zu\", &x, &y);\n    printf(\"%d\\n\", a[a.size()-1-y][x]);\n  }\n  return 0;\n}\n\nint main() {\n  while (!testcase_ends()) {}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<algorithm>\n#include<cmath>\n#include<iomanip>\n#include<iostream>\n#include<map>\n#include<numeric>\n#include<queue>\n#include<set>\n#include<stack>\n#include<utility>\n#include<vector>\n\n#define lint long long\n#define VI vector<int>\n#define VL vector<lint>\n#define VC vector<char>\n#define VVI vector<VI>\n#define rep(i, n) for(int i = 0 ; i < n ; i++)\n\nusing namespace std;\n\nint main(){\n    while(true){\n        int n, m, t, p;\n        cin >> n >> m >> t >> p;\n        if(n == 0 && m == 0 && t == 0 && p == 0){\n            break;\n        }\n        VVI paper(m*23);\n        rep(i, m*23){\n            paper[i].resize(n*23);\n        }\n        rep(i, m){\n            rep(j, n){\n                paper[i][j] = 1;\n            }\n        }\n        int sx = 0, sy = 0;\n        rep(k, t){\n            int d, c;\n            cin >> d >> c;\n            if(d == 1){\n                rep(j, c){\n                    rep(i, 23*m - sy - 1){\n                        paper[sy+i][sx+2*c-j-1] += paper[sy+i][sx+j];\n                        paper[sy+i][sx+j] = 0;\n                    }\n                }\n                sx += c;\n            }else{\n                rep(i, c){\n                    rep(j, 23*n - sx - 1){\n                        paper[sy+2*c-i-1][sx+j] += paper[sy+i][sx+j];\n                        paper[sy+i][sx+j] = 0;\n                    }\n                }\n                sy += c;\n            }\n        }\n        rep(i, p){\n            int x, y;\n            cin >> x >> y;\n            cout << paper[sy+y][sx+x] << endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\n\nint main(){\n    int op_hole[70][70];//開く穴の数\n    int n,m,t,p;\n    int fold[2];\n    while(1){\n        cin>>n>>m>>t>>p;\n        if(n==0&&m==0&&t==0&&p==0)break;\n        int f_n=n,f_m=m;//おられた後の横の長さ及び縦の長さを記録\n        for(int i=0;i<70;i++)\n            for(int j=0;j<70;j++)\n                op_hole[i][j]=0;\n        for(int i=0;i<m;i++)//1で初期化\n            for(int j=0;j<n;j++)\n                op_hole[i][j]=1;\n        for(int i=0;i<t;i++){\n            cin>>fold[0]>>fold[1];\n            int f=fold[1];\n            if(fold[0]==1){//横におる場合の重なりを計算\n                for(int j=0;j<f;j++)\n                    for(int k=0;k<f_m;k++)\n                        op_hole[k][2*f-1-j] += op_hole[k][j];\n                if(f_n-f >= f){f_n = f_n-f;}\n                else{f_n = f;} //f_n-f+f-(f_n-f)より\n                for(int j=0;j<f_m;j++)//座標の移動\n                    for(int k=0;k<f_n;k++)\n                        op_hole[j][k] = op_hole[j][k+f];\n                for(int j=0;j<f_m;j++)//座標移動による残骸を0にして処理\n                    for(int k=f_n;k<70;k++)\n                        op_hole[j][k]=0;\n            }\n            else if(fold[0]==2){//縦におる場合の重なりを計算\n                for(int j=0;j<f;j++)\n                    for(int k=0;k<f_n;k++)\n                        op_hole[2*f-1-j][k] += op_hole[j][k];\n                if(f_m-f >= f){f_m = f_m-f;}\n                else{f_m = f;}\n                for(int j=0;j<f_n;j++)\n                    for(int k=0;k<f_m;k++)\n                        op_hole[k][j] = op_hole[k+f][j];\n                for(int j=0;j<f_n;j++)\n                    for(int k=f_m;k<70;k++)\n                        op_hole[k][j]=0;\n            }\n        }\n        for(int i=0;i<p;i++){\n            int a,b;\n            cin>>a>>b;\n            cout<<op_hole[b][a]<<endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define REP(i, n) for (int i = 0; i < (n); i++)\n#define FOR(i, m, n) for (int i = (m); i < (n); i++)\n#define int long long\nint A[500][500];\nbool solve() {\n    REP(i, 500) REP(j, 500) A[i][j] = 0;\n    int n, m, t, p;\n    cin >> n >> m >> t >> p;\n    if (n == 0) return false;\n    REP(i, n) {\n        REP(j, m) { A[i][j] = 1; }\n    }\n    int l = 0, u = 0;\n    REP(_, t) {\n        int d, c;\n        cin >> d >> c;\n        if (d == 2) {\n            REP(i, 500) {\n                REP(j, c) {\n                    int dif = 2 * c - 2 * j - 1;\n                    A[i][l + j + dif] += A[i][l + j];\n                    A[i][l + j] = 0;\n                }\n            }\n            l = l + c;\n        } else {\n            REP(j, 500) {\n                REP(i, c) {\n                    int dif = 2 * c - 2 * i - 1;\n                    A[u + i + dif][j] += A[u + i][j];\n                }\n            }\n            u += c;\n        }\n    }\n    REP(_, p) {\n        int x, y;\n        cin >> x >> y;\n        cout << A[u + x][l + y] << endl;\n    }\n    return true;\n}\nsigned main() {\n    while (solve())\n        ;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n, m, t, p, mm, nn;\nint memo[40][40];\nint d, c, x, y;\n\nint main() {\n  int i, j, a, ans;\n  while(1) {\n    cin >> n >> m >> t >> p;\n    if(n + m + t + p == 0) break;\n    nn = n;\n    mm = m;\n    ans = 0;\n    for(i = 0; i < 40; ++i)\n      for(j = 0; j < 40; ++j) memo[i][j] = 0;\n    for(i = 0; i < m; i++)\n      for(j = 0; j < n; j++) memo[i][j] = 1;\n    for(a = 0; a < t; a++) {\n      cin >> d >> c;\n      if(d == 1) {\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < c / 2; j++) { swap(memo[i][j], memo[i][c - j - 1]); }\n        if(nn - c > c / 2)\n          nn -= c;\n        else\n          nn = c;\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < nn; j++) {\n            if(j < c)\n              memo[i][j] += memo[i][j + c];\n            else\n              memo[i][j] = memo[i][j + c];\n            memo[i][j + c] = 0;\n          }\n      }\n      else {\n        for(i = 0; i < c / 2; i++)\n          for(j = 0; j < nn; j++) { swap(memo[i][j], memo[c - i - 1][j]); }\n        if(mm - c > c / 2)\n          mm -= c;\n        else\n          mm = c;\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < nn; j++) {\n            if(i < c)\n              memo[i][j] += memo[i + c][j];\n            else\n              memo[i][j] = memo[i + c][j];\n            memo[i + c][j] = 0;\n          }\n      }\n      /*for(i = 0; i < m; i++)\n        for(j = 0; j < n; j++)\n          if(i >= mm || j >= nn) memo[i][j] = 0;*/\n      /*for(i=0;i<m;i++){\n        for(j=0;j<n;j++)cout << memo[i][j]<<\" \";\n        cout << endl;\n        }\n        cout << endl;*/\n    }\n    for(a = 0; a < p; a++) {\n      cin >> x >> y;\n      cout << memo[y][x] << endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<string>\n#include<algorithm>\nusing namespace std;\nint mapy1[70][70],mapy2[70][70],n,m,t,p,xx,yy,flg,orix,oriy,ans[20005],cnt;\nvoid init()\n{\n\torix=n;oriy=m;\n\tmemset(mapy1,0,sizeof(mapy1));\n\tfor(int i=0;i<orix;i++)\n\tfor(int j=0;j<oriy;j++)mapy1[i][j]=1;\n\tflg=0;\n}\n\nint main()\n{\n\t// freopen(\"a.out\",\"w\",stdout);\n\tscanf(\"%d %d %d %d\",&n,&m,&t,&p);\n\twhile(n||m||t||p){\n\t\tinit();\n\tfor(int i=1;i<=t;i++){\n\t\tscanf(\"%d %d\",&xx,&yy);\n\t\tif(xx==1){\n\t\t\torix=max(yy,orix-yy);\n\t\t\tif(flg){\n\t\t\tmemset(mapy1,0,sizeof(mapy1));\n\t\t\tfor(int j=0;j<orix;j++)\n\t\t\tfor(int k=0;k<oriy;k++)mapy1[j][k]=mapy2[j+yy][k]+mapy2[yy-j-1][k];\n\t\t    flg=0;\n\t\t\t}\n\t\t    else{\n\t\t    memset(mapy2,0,sizeof(mapy2));\n\t\t\tfor(int j=0;j<orix;j++)\n\t\t\tfor(int k=0;k<oriy;k++)mapy2[j][k]=mapy1[j+yy][k]+mapy1[yy-j-1][k];\n\t\t\tflg=1;\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\toriy=max(yy,oriy-yy);\n\t\t\tif(flg){\n\t\t\tmemset(mapy1,0,sizeof(mapy1));\n\t\t\tfor(int j=0;j<orix;j++)\n\t\t\tfor(int k=0;k<oriy;k++)mapy1[j][k]=mapy2[j][k+yy]+mapy2[j][yy-k-1];\n\t\t    flg=0;\n\t\t\t}\n\t\t    else{\n\t\t    memset(mapy2,0,sizeof(mapy2));\n\t\t\tfor(int j=0;j<orix;j++)\n\t\t\tfor(int k=0;k<oriy;k++)mapy2[j][k]=mapy1[j][k+yy]+mapy1[j][yy-k-1];\n\t\t\tflg=1;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=p;i++){\n\t\t\tscanf(\"%d %d\",&xx,&yy);cnt++;\n\t\t    if(flg)ans[cnt]=mapy2[xx][yy];\n\t\t    else ans[cnt]=mapy1[xx][yy];\n\t}\n\tscanf(\"%d %d %d %d\",&n,&m,&t,&p);\n\t}\n\tfor(int i=1;i<=cnt;i++)printf(\"%d\\n\",ans[i]);\n\treturn 0;\n } \n"
  },
  {
    "language": "C++",
    "code": "//#include <bits/stdc++.h>\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n#include <cassert>\n\nusing namespace std;\n\nint sum[600][600] = {};\n\nint solve(){\n  int h, w, n, m;\n\n  memset(sum, 0, sizeof(sum));\n  \n  scanf(\"%d%d%d%d\", &w, &h, &n, &m);\n\n  if(!h)return false;\n  \n  for(int i=0;i<h;i++)\n    for(int j=0;j<w;j++)\n      sum[i][j] = 1;\n\n  int l = 0, u = 0;\n\n  for(int i=0;i<n;i++){\n    int d, c;\n\n    scanf(\"%d%d\", &d, &c);\n    \n    if(d == 1){\n      c += l;\n      for(int j=l;j<c;j++){\n        for(int k=u;k<u+32;k++){\n          sum[k][c+(c-j-1)] += sum[k][j];\n          sum[k][j] = 0;\n        }\n      }\n    }else{\n      c += u;\n      for(int j=u;j<c;j++){\n        for(int k=l;k<l+32;k++){\n          sum[c+(c-j-1)][k] += sum[j][k];\n          sum[j][k] = 0;\n        }\n      }\n    }\n\n    int l2 = l, u2 = u;\n    \n    l = -1;\n    for(int i=u2;i<u2+32;i++){\n      for(int j=l2;j<l2+32;j++){\n        if(sum[i][j]){\n          l = j; u = i;\n          break;\n        }\n      }\n      if(l != -1) break;\n    }\n  }\n\n\n  assert(l != -1);\n  \n  for(int i=0;i<m;i++){\n    int x, y;\n\n    scanf(\"%d%d\", &x, &y);\n\n    printf(\"%d\\n\", sum[y+u][x+l]);\n  }\n\n  return 1;\n}\n\nint main(){\n  while(solve());\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MA_DEFINES\n#include <bits/stdc++.h>\n#define int long long\n#define rep(i,n) for(int i=0;i<n;i++)\n#define Rep(i,a,b) for(int i=a;i<b;i++)\n#define REP(i,a,b) for(int i=a;i<=b;i++)\n#define rev(i,n) for(int i=n-1;i>=0;i--)\n#define vi vector<int>\n#define vvi vector<vi>\n#define pb push_back\n#define pi pair<int,int>\n#define vp vector<pair<int,int>>\n#define mp make_pair\n#define all(v) (v).begin(),(v).end()\n#define fi first\n#define se second\n#define MEMSET(a) memset(a,0,sizeof(a))\n#define inf (1ll<<60)\n#define Yes(f) cout<<(f?\"Yes\":\"No\")<<endl\n#define yes(f) cout<<(f?\"yes\":\"no\")<<endl\n#define YES(f) cout<<(f?\"YES\":\"NO\")<<endl\n#define SORT(v) sort(all(v))\n#define RSORT(v) sort(all(v), greater<int>())\n\nusing namespace std;\n\nconst int mod=1e9+7;\n\nvoid run();\n\nvoid init() {\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    cout<<fixed<<setprecision(12);\n}\n\nsigned main(){\n    init();\n    run();\n    return 0;\n}\n\nvoid run(){\n    int n,m,t,p;\n    cin>>n>>m>>t>>p;\n    while(n){\n        int a[1000][1000]={};\n        int x=0,y=0,w=n,h=m;\n        rep(i,m)rep(j,n)a[i][j]=1;\n        while(t--){\n            int d,c;\n            cin>>d>>c;\n            if(d==1){\n                Rep(i,y,h){\n                    rep(j,c){\n                        a[i][x+2*c-j-1]+=a[i][x+j];\n                    }\n                }\n                w=max(w,x+2*c);\n                x+=c;\n            }\n            else{\n                Rep(i,x,w){\n                    rep(j,c){\n                        a[y+2*c-j-1][i]+=a[y+j][i];\n                    }\n                }\n                h=max(h,y+2*c);\n                y+=c;\n            }\n        }\n        while(p--){\n            int r,t;\n            cin>>r>>t;\n            cout<<a[y+t][x+r]<<endl;\n        }\n        cin>>n>>m>>t>>p;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\n#define INF 1e9\n#define llINF 1e18\n#define MOD 1e9+7\n#define pb push_back\n#define mp make_pair \n#define F first\n#define S second\n#define ll long long\nusing namespace std;\nint main(){\n  int w,h,t,p;\n  while(cin>>w>>h>>t>>p,w){\n    int paper[h*h+10][w*w+10]={};\n    for(int i=0;i<h;i++)\n      for(int j=0;j<w;j++)\n\tpaper[i][j]=1;\n    int hcnt=0,wcnt=0;\n    for(int i=0;i<t;i++){\n      int d,c;cin>>d>>c;\n      if(d==1){\n\tfor(int j=0;j<c;j++){\n\t  for(int k=0;k<h*h;k++){\n\t    paper[k][wcnt+c+j]+=paper[k][wcnt+c-j-1];\n\t  }\n\t}\n\twcnt+=c;\n      }else if(d==2){\n\tfor(int j=0;j<c;j++){\n\t  for(int k=0;k<w*w;k++){\n\t    paper[hcnt+c+j][k]+=paper[hcnt+c-j-1][k];\n\t  }\n\t}\n\thcnt+=c;\n      }\n    }\n    // for(int i=0;i<h;i++){\n    //   for(int j=0;j<w;j++)\n    // \tcout<<paper[i][j];\n    //   cout<<endl;\n    // }\n    for(int i=0;i<p;i++){\n      int x,y;cin>>x>>y;\n      cout<<paper[y+hcnt][x+wcnt]<<endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n, m, t, p, mm, nn;\nint memo[40][40];\nint d, c, x, y;\n\nint main() {\n  int i, j, a, ans;\n  while(1) {\n    cin >> n >> m >> t >> p;\n    if(n + m + t + p == 0) break;\n    nn = n;\n    mm = m;\n    ans = 0;\n    for(i = 0; i < 40; ++i)\n      for(j = 0; j < 40; ++j) memo[i][j] = 0;\n    for(i = 0; i < m; i++)\n      for(j = 0; j < n; j++) memo[i][j] = 1;\n    for(a = 0; a < t; a++) {\n      cin >> d >> c;\n      if(d == 1) {\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < c / 2; j++) { swap(memo[i][j], memo[i][c - j - 1]); }\n        if(nn - c > c / 2)\n          nn -= c;\n        else\n          nn = c;\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < nn; j++) {\n            if(j < c)\n              memo[i][j] += memo[i][j + c];\n            else\n              memo[i][j] = memo[i][j + c];\n            memo[i][j + c] = 0;\n          }\n      }\n      else {\n        for(i = 0; i < c / 2; i++)\n          for(j = 0; j < nn; j++) { swap(memo[i][j], memo[c - i - 1][j]); }\n        if(mm - c > c / 2)\n          mm -= c;\n        else\n          mm = c;\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < nn; j++) {\n            if(i < c)\n              memo[i][j] += memo[i + c][j];\n            else\n              memo[i][j] = memo[i + c][j];\n            memo[i + c][j] = 0;\n          }\n      }\n      /*for(i = 0; i < m; i++)\n        for(j = 0; j < n; j++)\n          if(i >= mm || j >= nn) memo[i][j] = 0;*/\n      /*for(i=0;i<m;i++){\n        for(j=0;j<n;j++)cout << memo[i][j]<<\" \";\n        cout << endl;\n        }\n        cout << endl;*/\n    }\n    for(a = 0; a < p; a++) {\n      cin >> x >> y;\n      cout << memo[y][x] << endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n, m, t, p, mm, nn;\nint memo[100][100];\nint d, c, x, y;\n\nint main() {\n  int i, j, a, ans;\n  while(1) {\n    cin >> n >> m >> t >> p;\n    if(n + m + t + p == 0) break;\n    nn = n;\n    mm = m;\n    ans = 0;\n    for(i = 0; i < 100; ++i)\n      for(j = 0; j < 100; ++j) memo[i][j] = 0;\n    for(i = 0; i < m; i++)\n      for(j = 0; j < n; j++) memo[i][j] = 1;\n    for(a = 0; a < t; a++) {\n      cin >> d >> c;\n      if(d == 1) {\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < c / 2; j++) { swap(memo[i][j], memo[i][c - j - 1]); }\n        if(nn - c > c / 2)\n          nn -= c;\n        else\n          nn = c;\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < nn; j++) {\n            if(j < c)\n              memo[i][j] += memo[i][j + c];\n            else\n              memo[i][j] = memo[i][j + c];\n            memo[i][j + c] = 0;\n          }\n      }\n      else {\n        for(i = 0; i < c / 2; i++)\n          for(j = 0; j < nn; j++) { swap(memo[i][j], memo[c - i - 1][j]); }\n        if(mm - c > c / 2)\n          mm -= c;\n        else\n          mm = c;\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < nn; j++) {\n            if(i < c)\n              memo[i][j] += memo[i + c][j];\n            else\n              memo[i][j] = memo[i + c][j];\n            memo[i + c][j] = 0;\n          }\n      }\n      /*for(i = 0; i < m; i++)\n        for(j = 0; j < n; j++)\n          if(i >= mm || j >= nn) memo[i][j] = 0;*/\n      /*for(i=0;i<m;i++){\n        for(j=0;j<n;j++)cout << memo[i][j]<<\" \";\n        cout << endl;\n        }\n        cout << endl;*/\n    }\n    for(a = 0; a < p; a++) {\n      cin >> x >> y;\n      cout << memo[y][x] << endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define FOR(i,a,b) for(int i = (a); i < (b); ++i)\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define all(x) (x).begin(),(x).end()\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v; return v;}\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector< vector<int> > Mat;\ntypedef tuple<int, int, int, int> T;\n\nconst int MOD = (int)1e9+7;\nconst int INF = (int)1e9;\nconst int dx[] = {0, 1, 0, -1};\nconst int dy[] = {1, 0, -1, 0};\nconst int ddx[] = {0, 1, 1, 1, 0, -1, -1, -1};\nconst int ddy[] = {1, 1, 0, -1, -1, -1, 0, 1};\n\nint main(){\n    ios::sync_with_stdio(false);\n\tcin.tie(0);\n\n    int n, m, t, p;\n    while(1){\n        cin >> n >> m >> t >> p;\n\n        if(n+m+t+p == 0) break;\n        vector< vector<int> > paper(33*21, vector<int>(33*21, 0));\n        int ox = 0, oy = 0, dx = n, dy = m;\n        rep(i, m) rep(j, n) paper[i][j] += 1;\n        \n        rep(_, t){\n            int d, c;\n            cin >> d >> c;\n            if(d == 1){\n                dx = max(dx, ox+(c+1)*2);\n                FOR(i, ox, ox+c){\n                    FOR(j, oy, dy) paper[j][c+i] += paper[j][i];\n                }\n                ox += c;\n            }else{\n                dy = max(dy, oy+(c+1)*2);\n                FOR(i, oy, oy+c){\n                    FOR(j, ox, dx) paper[c+i][j] += paper[i][j];\n                }\n                oy += c;\n            }\n        }\n        \n        rep(_, p){\n            int x, y;\n            cin >> x >> y;\n            cout << paper[y+oy][x+ox] << endl;\n        }\n\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);++(i))\n#define all(x) (x).begin(),(x).end()\n#define pb push_back\n#define fi first\n#define se second\n#define dbg(x) cout<<#x\" = \"<<((x))<<endl\ntemplate<class T,class U> ostream& operator<<(ostream& o, const pair<T,U> &p){o<<\"(\"<<p.fi<<\",\"<<p.se<<\")\";return o;}\ntemplate<class T> ostream& operator<<(ostream& o, const vector<T> &v){o<<\"[\";for(T t:v){o<<t<<\",\";}o<<\"]\";return o;}\n\nusing pi = pair<int,int>;\n\nint main(){\n    int w,h,t,p;\n    while(cin >>w >>h >>t >>p,w){\n        vector<int> dir(t),c(t);\n        rep(i,t) cin >>dir[i] >>c[i];\n        vector<pi> hole(p);\n        rep(i,p){\n            int x,y;\n            cin >>x >>y;\n            hole[i] = {y,x};\n        }\n\n        vector<vector<pi>> a(h,vector<pi>(w));\n        rep(i,h)rep(j,w) a[i][j] = {i,j};\n\n        auto F = [&](int d, int z){\n            if(d==1){\n                int mx = w;\n                rep(i,h)rep(j,w){\n                    if(a[i][j].se < z) a[i][j].se = z + (z-1-a[i][j].se);\n                    mx = min(mx, a[i][j].se);\n                }\n                rep(i,h)rep(j,w) a[i][j].se -= mx;\n            }\n            else{\n                int my = h;\n                rep(i,h)rep(j,w){\n                    if(a[i][j].fi < z) a[i][j].fi = z + (z-1-a[i][j].fi);\n                    my = min(my, a[i][j].fi);\n                }\n                rep(i,h)rep(j,w) a[i][j].fi -= my;\n            }\n        };\n\n        rep(i,t) F(dir[i],c[i]);\n\n        rep(k,p){\n            int ans = 0;\n            rep(i,h)rep(j,w)if(a[i][j] == hole[k]) ++ans;\n            cout << ans << endl;\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll; \nconst ll mod=1e9+7;\nint coun[33][33];\nint n,m,t,p;\nint main() {\t\n\t//freopen(\"slyar.in\", \"r\", stdin);  \n    //freopen(\"slyar.out\", \"w\", stdout);\n    //ios::sync_with_stdio(false);\n  //\tcin.tie(0);\n    cin>>n>>m>>t>>p;\n    while(1)\n    {\n    \tll ans=0;\n    \tif(n==0&&m==0&&t==0&&p==0) break;\n    \t//memset(coun,1,sizeof(coun));\n    \tfor(int i=1;i<=m;i++)\n    \t{\n    \t\tfor(int j=1;j<=n;j++)\n    \t\t{\n    \t\t\tcoun[i][j]=1;\n    \t\t}\n    \t}\n\t\tint x1=1;\n    \tfor(int i=1;i<=t;i++)\n    \t{\n    \t\tint d,c;\n    \t\tcin>>d>>c;\n    \t\tif(d==1)\n    \t\t{\n    \t\t\tx1+=c;\n    \t\t\tfor(int i=0;i<c;i++)\n    \t\t\t{\n    \t\t\t\tfor(int j=1;j<=m;j++)\n    \t\t\t\t{\n    \t\t\t\t\tcoun[j][x1+i]+=coun[j][x1-i-1];\n    \t\t\t\t}\n    \t\t\t}\n    \t\t}\n    \t\telse if(d==2)\n    \t\t{\n    \t\t    m-=c;\n    \t\t    for(int i=0;i<c;i++)\n    \t\t\t{\n    \t\t\t\tfor(int j=x1;j<=n;j++)\n    \t\t\t\t{\n    \t\t\t\t\tcoun[m-i][j]+=coun[m+i+1][j];\n    \t\t\t\t}\n    \t\t\t}\n    \t\t}\n   \t\t}\n   \t/*\tfor(int i=1;i<=m;i++)\n   \t\t{\n   \t\t\tfor(int j=x1;j<=n;j++)\n   \t\t\t{\n   \t\t\t\tcout<<coun[i][j]<<\" \";\n   \t\t\t}\n   \t\t\tcout<<endl;\n   \t\t}*/\n    \tfor(int i=1;i<=p;i++)\n    \t{\n    \t\tdouble y=0,x=0;\n    \t    cin>>y>>x;\n    \t    double d=(double)m/2;\n    \t    y+=0.5;\n    \t    //while(y>n) y-=n;\n\t\t\tint y2=(int)y;\n\t\t\tif(y-y2!=0) y2++; \n\t\t\tx=x+d+0.5;\n\t\t\twhile(x>m) x-=m;\n\t\t\tint x2=(int)x;\n\t\t\tif(x-x2!=0) x2++;\n\t\t    cout<<coun[x2][y2+x1-1]<<endl;\n   \t    }\n    }\n\t//fclose(stdin);\n    //fclose(stdout);\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define LL long long\nusing namespace std;\nint d[50],c[50],x[50],y[50],a[55][55],m,n;\nvoid fan(int x1,int y1,int f)\n{\n    int b[55][55],i,j;\n    if(f==1)\n    {\n        for(i=1;i<=y1;i++)\n            for(j=1;j<=x1;j++)\n            b[i][j]=a[i][x1-j+1];\n        for(i=1;i<=y1;i++)\n            for(j=1;j<=x1;j++)\n            a[i][j]=b[i][j];\n    }\n    else\n    {\n        for(i=1;i<=y1;i++)\n            for(j=1;j<=x1;j++)\n            b[i][j]=a[y1-i+1][j];\n        for(i=1;i<=y1;i++)\n            for(j=1;j<=x1;j++)\n            a[i][j]=b[i][j];\n    }\n\n\n}\nint main()\n{\n    int i,j,k,all,q,p,w,u,l,r,ans,t;\n    scanf(\"%d %d %d %d\",&n,&m,&t,&p);\n    while(n!=0&&m!=0&&t!=0&&p!=0)\n    {\n        w=n;u=m;l=r=0;ans=0;\n        for(i=1;i<=m;i++)\n            for(j=1;j<=n;j++)\n            a[i][j]=1;\n        for(i=1;i<=t;i++)\n        {\n            scanf(\"%d%d\",&d[i],&c[i]);\n        }\n        for(i=1;i<=p;i++)\n        {\n            scanf(\"%d%d\",&x[i],&y[i]);\n        }\n        for(i=1;i<=t;i++)\n        {\n            if(d[i]==1)\n            {\n                if(c[i]<=w/2)\n                {\n                    for(j=1;j<=c[i];j++)\n                        for(k=1;k<=u;k++)\n                    {\n                        a[k][c[i]-j+1]=a[k][j+c[i]]+a[k][c[i]-j+1];\n                    }\n                    w-=c[i];\n                    for(j=c[i]+1;j<=w;j++)\n                        for(k=1;k<=u;k++)\n                            a[k][j]=a[k][j+c[i]];\n                }\n                else\n                {\n                    for(j=1;j<=w-c[i];j++)\n                         for(k=1;k<=u;k++)\n                         a[k][c[i]-j+1]=a[k][j+c[i]]+a[k][c[i]-j+1];\n                    w=c[i];\n                    fan(w,u,1);\n                }\n\n            }\n\n            if(d[i]==2)\n            {\n                if(c[i]<=u/2)\n                {\n                    for(j=1;j<=c[i];j++)\n                        for(k=1;k<=w;k++)\n                    {\n                        a[c[i]-j+1][k]=a[j+c[i]][k]+a[c[i]-j+1][k];\n                    }\n                    u-=c[i];\n                }\n                else\n                {\n                    for(j=1;j<=u-c[i];j++)\n                        for(k=1;k<=w;k++)\n                        {a[c[i]-j+1][k]=a[c[i]-j+1][k]+a[c[i]+j][k];\n                        }\n\n                    u=c[i];\n                   fan(w,u,2);\n                }\n\n            }\n           /* for(k=1;k<=m;k++)\n            {for(j=1;j<=n;j++)\n            printf(\"%d \",a[k][j]);\n            printf(\"\\n\");\n            }\n            printf(\"\\n\");*/\n\n        }\n        /*for(i=1;i<=m;i++)\n            {for(j=1;j<=n;j++)\n            printf(\"%d \",a[i][j]);\n            printf(\"\\n\");\n            }*/\n        for(i=1;i<=p;i++)\n            {ans=a[y[i]+1][x[i]+1];\n        printf(\"%d\\n\",ans);}\n        scanf(\"%d%d%d%d\",&n,&m,&t,&p);\n        }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\n#include <map>\nusing namespace std;\n\nint main() {\n    int w, h, t, p;\n    while (cin >> w >> h >> t >> p, w) {\n        int zx = 0, zy = 0, mx = w, my = h;\n        map<pair<int, int>, int> field;\n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) field[{i, j}] = 1;\n        }\n        while (t--) {\n            int d, c; cin >> d >> c;\n            // d = 1: 左側から c, d = 1: 下側から c 折り曲げる\n            if (d == 1) {\n                for (int t = 0; t < c; t++) {\n                    for (int i = 0; i < my; i++) {\n                        field[{i, zx + 2 * c - 1 - t}] += field[{i, zx + t}];\n                        field[{i, zx + t}] = 0;\n                    }\n                }\n                zx += c;\n                mx = max(mx, zx + 2 * c);\n            } else {\n                for (int t = 0; t < c; t++) {\n                    for (int j = 0; j < mx; j++) {\n                        field[{zy + 2 * c - 1 - t, j}] += field[{zy + t, j}];\n                        field[{zy + t, j}] = 0;\n                    }\n                }\n                zy += c;\n                my = max(my, zy + 2 * c);\n            }\n        }\n        while (p--) {\n            int x, y; cin >> x >> y;\n            cout << field[{zy + y, zx + x}] << endl;\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define all(x) (x).begin(),(x).end()\nconst int mod=1000000007,MAX=100005,INF=1<<30;\n\nint main(){\n    \n    std::ifstream in(\"text.txt\");\n    std::cin.rdbuf(in.rdbuf());\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    \n    while(1){\n        int H,W,T,P;cin>>W>>H>>T>>P;\n        if(H+W+T+P==0) break;\n        vector<vector<int>> cnt(H,vector<int>(W,1));\n        \n        while(T--){\n            int Q,L;cin>>Q>>L;\n            \n            if(Q==1){\n                if(cnt[0].size()>=2*L){\n                    vector<vector<int>> change(cnt.size(),vector<int>(cnt[0].size()-L));\n                    \n                    for(int i=0;i<cnt.size();i++){\n                        for(int j=0;j<L;j++){\n                            change[i][j]=cnt[i][L-1-j]+cnt[i][L+j];\n                        }\n                        for(int j=L;j<cnt[0].size()-L;j++){\n                            change[i][j]=cnt[i][L+j];\n                        }\n                    }\n                    \n                    cnt=change;\n                }else{\n                    vector<vector<int>> change(cnt.size(),vector<int>(L));\n                    \n                    for(int i=0;i<cnt.size();i++){\n                        for(int j=0;j<cnt[0].size()-L;j++){\n                            change[i][j]=cnt[i][L-1-j]+cnt[i][L+j];\n                        }\n                        for(int j=cnt[0].size()-L;j<L;j++){\n                            change[i][j]=cnt[i][L-1-j];\n                        }\n                    }\n                    \n                    cnt=change;\n                }\n            }else{\n                vector<vector<int>> save(cnt[0].size(),vector<int>(cnt.size()));\n                for(int i=0;i<cnt[0].size();i++){\n                    for(int j=0;j<cnt.size();j++){\n                        save[i][j]=cnt[cnt.size()-1-j][i];\n                    }\n                }\n                \n                cnt=save;\n                \n                if(cnt[0].size()>=2*L){\n                    vector<vector<int>> change(cnt.size(),vector<int>(cnt[0].size()-L));\n                    \n                    for(int i=0;i<cnt.size();i++){\n                        for(int j=0;j<L;j++){\n                            change[i][j]=cnt[i][L-1-j]+cnt[i][L+j];\n                        }\n                        for(int j=L;j<cnt[0].size()-L;j++){\n                            change[i][j]=cnt[i][L+j];\n                        }\n                    }\n                    \n                    cnt=change;\n                }else{\n                    vector<vector<int>> change(cnt.size(),vector<int>(L));\n                    \n                    for(int i=0;i<cnt.size();i++){\n                        for(int j=0;j<cnt[0].size()-L;j++){\n                            change[i][j]=cnt[i][L-1-j]+cnt[i][L+j];\n                        }\n                        for(int j=cnt[0].size()-L;j<L;j++){\n                            change[i][j]=cnt[i][L-1-j];\n                        }\n                    }\n                    \n                    cnt=change;\n                }\n                \n                vector<vector<int>> to(cnt[0].size(),vector<int>(cnt.size()));\n                \n                for(int i=0;i<cnt[0].size();i++){\n                    for(int j=0;j<cnt.size();j++){\n                        to[i][j]=cnt[j][cnt[0].size()-1-i];\n                    }\n                }\n                \n                cnt=to;\n            }\n        }\n        \n        while(P--){\n            int a,b;cin>>a>>b;\n            b=cnt.size()-1-b;\n            \n            cout<<cnt[b][a]<<endl;\n        }\n    }\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <math.h>\n#include <iomanip>\nusing namespace std;\n\nint main(void){\n    while (1) {\n        int n, m, t, p;\n        cin >> n >> m >> t >> p;\n        \n        if (n == 0 && m == 0 && t == 0 && p == 0) return 0;\n        \n        int pile[35][35];\n        for (int i = 0; i < m; i++) {\n            for (int j = 0; j < n; j++) pile[i][j] = 1;\n        }\n        \n        for (int i = 0; i < t; i++) {\n            int d, c;\n            cin >> d >> c;\n            \n            if (d == 1) {\n                if (c <= n - c) {\n                    for (int j = 0; j < c; j++) {\n                        for (int k = 0; k < m; k++) {\n                            pile[k][c + j] += pile[k][c - j - 1];\n                        }\n                    }\n                    for (int j = 0; j < n - c; j++) {\n                        for (int k = 0; k < m; k++) {\n                            pile[k][j] = pile[k][c + j];\n                        }\n                    }\n                    n -= c;\n                }\n                else {\n                    for (int j = 0; j < n - c; j++) {\n                        for (int k = 0; k < m; k++) {\n                            pile[k][c - j - 1] += pile[k][c + j];\n                        }\n                    }\n                    int tmp[35][35];\n                    for (int j = 0; j < c; j++) {\n                        for (int k = 0; k < m; k++) {\n                            tmp[k][j] = pile[k][c - j - 1];\n                        }\n                    }\n                    for (int j = 0; j < c; j++) {\n                        for (int k = 0; k < m; k++) {\n                            pile[k][j] = tmp[k][j];\n                        }\n                    }\n                    n -= n - c;\n                }\n            }\n            else {\n                if (c <= m - c) {\n                    for (int j = 0; j < c; j++) {\n                        for (int k = 0; k < n; k++) {\n                            pile[c + j][k] += pile[c - j - 1][k];\n                        }\n                    }\n                    for (int j = 0; j < m - c; j++) {\n                        for (int k = 0; k < n; k++) {\n                            pile[j][k] = pile[c + j][k];\n                        }\n                    }\n                    m -= c;\n                }\n                else {\n                    for (int j = 0; j < m - c; j++) {\n                        for (int k = 0; k < n; k++) {\n                            pile[c - j - 1][k] += pile[c + j][k];\n                        }\n                    }\n                    int tmp[35][35];\n                    /*\n                    for (int j = 0; j < c; j++) {\n                        for (int k = 0; k < m; k++) {\n                            tmp[k][j] = pile[k][c - j - 1];\n                        }\n                    }\n                    for (int j = 0; j < c; j++) {\n                        for (int k = 0; k < m; k++) {\n                            pile[k][j] = tmp[k][j];\n                        }\n                    }*/\n                    \n                    for (int j = 0; j < c; j++) {\n                        for (int k = 0; k < n; k++) {\n                            tmp[j][k] = pile[c - j - 1][k];\n                        }\n                    }\n                    for (int j = 0; j < c; j++) {\n                        for (int k = 0; k < n; k++) {\n                            pile[j][k] = tmp[j][k];\n                        }\n                    }\n                    m -= m - c;\n                }\n            }\n            \n        }\n        \n        for (int i = 0; i < p; i++) {\n            int x, y;\n            cin >> x >> y;\n            cout << pile[y][x] << endl;\n        }\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\nusing namespace std;\nint n,m,t,p;\nint main()\n{\n    for(;;)\n    {\n        int a[35][35],x[1000],y[1000];\n        scanf(\"%d %d %d %d\",&n,&m,&t,&p);\n        if(n==0&&m==0&&t==0&&p==0)break;\n        for(int i=0;i<33;i++)\n            for(int j=0;j<33;j++)\n            a[j][i]=1;\n        for(int i=0;i<t;i++)\n        {\n            int d,c;\n            scanf(\"%d %d\",&d,&c);\n            if(d==1)\n            {\n                int z[35][35];\n                if(c>n/2)c=n-c;\n                for(int j=c-1;j>=0;j--)\n                    for(int k=0;k<m;k++)\n                {\n                    z[k][j]=a[k][c-j-1]+a[k][c+j];\n                }\n                for(int j=c-1;j>=0;j--)\n                    for(int k=0;k<m;k++)\n                    a[k][j]=z[k][j];\n                for(int j=c;j<n-c;j++)\n                    for(int k=0;k<m;k++)\n                    a[k][j]=a[k][j+c];\n                n=n-c;\n            }\n            else if(d==2)\n            {\n                if(c<m/2+1)c=m-c;\n                for(int j=2*c-m;j<c;j++)\n                    for(int k=0;k<n;k++)\n                {\n                    a[j][k]=a[j][k]+a[2*c-j-1][k];\n                }\n                m=c;\n            }\n        }\n        for(int i=0;i<p;i++)\n        {\n            scanf(\"%d %d\",&x[i],&y[i]);\n        }\n        for(int i=0;i<p;i++)\n        {\n            printf(\"%d\\n\",a[m-1-y[i]][x[i]]);\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <ostream>\n#include <tuple>\n#include <cassert>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\ntemplate<class T>\nostream& operator<<(ostream& os, const vector<T>& vs) {\n    if (vs.empty()) return os << \"[]\";\n    os << \"[\";\n    bool fst = true;\n    for (auto&& v : vs) {\n        if (fst) fst = false;\n        else os << \",\";\n        os << v;\n    }\n    return os << \"]\";\n}\n\nnamespace {\n    int N, M, T, P;\n    vector<int> D, C, X, Y;\n    bool input() {\n        cin >> N >> M >> T >> P;\n        if (N == 0 && M == 0 && T == 0 && P == 0) return false;\n        D = vector<int>(T, 0);\n        C = vector<int>(T, 0);\n        X = vector<int>(P, 0);\n        Y = vector<int>(P, 0);\n        for (int t = 0; t < T; t++) {\n            cin >> D[t] >> C[t];\n        }\n        for (int p = 0; p < P; p++) {\n            cin >> X[p] >> Y[p];\n        }\n        return true;\n    }\n\n    void solve() {\n        vector<vector<int>> F(M, vector<int>(N, 1));\n        for (int t = 0; t < T; t++) {\n            int d = D[t];\n            int c = C[t];\n            auto trans = [&](int x, int y) {\n                if (d == 1) {\n                    if (x < c) {\n                        return make_tuple(c - x - 1, y);\n                    } else {\n                        return make_tuple(x - c, y);\n                    }\n                } else if (d == 2) {\n                    if (y < c) {\n                        return make_tuple(x, c - y - 1);\n                    } else {\n                        return make_tuple(x, y - c);\n                    }\n                } else {\n                    assert(false);\n                }\n            };\n            int n = F[0].size();\n            int m = F.size();\n            vector<vector<int>> nF;\n            if (d == 1) {\n                nF = vector<vector<int>>(m, vector<int>(max(c, n - c), 0));\n            } else if (d == 2) {\n                nF = vector<vector<int>>(max(c, m - c), vector<int>(n, 0));\n            } else {\n                assert(false);\n            }\n            for (int x = 0; x < n; x++) {\n                for (int y = 0; y < m; y++) {\n                    int nx, ny;\n                    tie(nx, ny) = trans(x, y);\n                    nF[ny][nx] += F[y][x];\n                }\n            }\n            //cout << \"---nF---\" << endl;\n            //cout << nF << endl;\n            F = nF;\n        }\n        for (int p = 0; p < P; p++) {\n            int x = X[p];\n            int y = Y[p];\n            cout << F[y][x] << endl;\n        }\n    }\n}\n\nint main() {\n    while (input()) {\n        solve();\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <complex>\n#include <deque>\n#include <exception>\n#include <fstream>\n#include <functional>\n#include <iomanip>\n#include <ios>\n#include <iosfwd>\n#include <iostream>\n#include <istream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <locale>\n#include <map>\n#include <memory>\n#include <new>\n#include <numeric>\n#include <ostream>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <stdexcept>\n#include <streambuf>\n#include <string>\n#include <typeinfo>\n#include <utility>\n#include <valarray>\n#include <vector>\n#include <climits>\n#include <cstring>\n\n#define rep(i, m, n) for(int i=int(m);i<int(n);i++)\n#define all(c) begin(c),end(c)\n\ntemplate<typename T1, typename T2>\ninline void chmin(T1 &a, T2 b) { if (a > b) a = b; }\n\ntemplate<typename T1, typename T2>\ninline void chmax(T1 &a, T2 b) { if (a < b) a = b; }\n\n//改造\ntypedef long long int ll;\nusing ll = long long int;\nusing ull = long long unsigned int;\nusing namespace std;\n#define INF (1 << 30) - 1\n#define INFl (ll)5e15\n#define DEBUG 0 //デバッグする時1にしてね\n#define dump(x)  cerr << #x << \" = \" << (x) << endl\n#define MOD 1000000007\n\n\n//ここから編集する\nclass Solve {\npublic:\n    int n, m;\n    vector<vector<int>> state;\n\n    void left(int x) {\n        vector<vector<int>> tmp(n, vector<int>(m));\n        vector<vector<int>> tmp2(n, vector<int>(m));\n        for (int i = 0; i < n; ++i) {\n            if (i < x) {\n                for (int j = 0; j < m; ++j) {\n                    tmp[x - i - 1][j] = state[i][j];\n                }\n            } else {\n                for (int j = 0; j < m; ++j) {\n                    tmp2[i - x][j] = state[i][j];\n                }\n            }\n        }\n        state.assign(n, vector<int>(m, 0));\n        for (int i = 0; i < n; ++i) {\n            for (int j = 0; j < m; ++j) {\n                state[i][j] = tmp[i][j] + tmp2[i][j];\n            }\n        }\n    }\n\n    void down(int x) {\n        vector<vector<int>> tmp(n, vector<int>(m));\n        vector<vector<int>> tmp2(n, vector<int>(m));\n        for (int i = 0; i < n; ++i) {\n            for (int j = 0; j < m; ++j) {\n                if (j < x) {\n                    tmp[i][x - 1 - j] = state[i][j];\n                } else {\n                    tmp2[i][j - x] = state[i][j];\n                }\n\n            }\n        }\n\n        state.assign(n, vector<int>(m, 0));\n        for (int i = 0; i < n; ++i) {\n            for (int j = 0; j < m; ++j) {\n                state[i][j] = tmp[i][j] + tmp2[i][j];\n            }\n        }\n    }\n\n    bool solve() {\n        int t, p;\n        cin >> n >> m >> t >> p;\n        if (n == 0)return false;\n        state.resize(n, vector<int>(m, 1));\n\n        for (int i = 0; i < t; ++i) {\n            int d, c;\n            cin >> d >> c;\n            if (d == 1) {\n                left(c);\n            } else {\n                down(c);\n            }\n        }\n        for (int i = 0; i < p; ++i) {\n            int x, y;\n            cin >> x >> y;\n//            x--, y--;\n            cout << state[x][y] << endl;\n        }\n\n        return true;\n    }\n};\n\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(10);\n\n    while (Solve().solve());\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<set>\n#include<map>\n#include<stack>\n\n#define MOD 10000000\nusing namespace std; \ntypedef long long LL;\n\nlong long quickpow(long long n, long long base) {\n    long long res = 1;\n    while(n) {\n        if(n & 1) {\n            res = res * base % MOD;\n        }\n        n >>= 1;\n        base = base * base % MOD;\n    }\n    return res;\n}//??? \n\nint ans[50];\nint A[100][100];\nint main()\n{\n\t  int n,m,t,p;\n\t  cin>>n>>m>>t>>p;\n\t  int d,c,x,y;\n\n      while(n!=0||m!=0||t!=0||p!=0)\n      {\n      \t  for(int i=1;i<=m;i++)\n      \t  for(int j=1;j<=n;j++)\n      \t  {\n  \t      \t A[i][j]=1;\n  \t      }\n  \t      for(int i=1;i<=t;i++)\n  \t      {\n      \t  \tcin>>d>>c;\n      \t  \t  if(d==1)\n      \t  \t  {\n\t  \t      \t  if(c<=(n/2))\n\t  \t      \t  {\n\t  \t      \t  \t   for(int i=1;i<=m;i++)\n  \t      \t  \t\t   for(int j=c+1;j<=(2*c);j++)\n  \t      \t  \t\t   A[i][j]+=A[i][(2*c)+1-j];\n   \t  \t\t           for(int i=1;i<=m;i++)\n  \t\t               for(int j=1;j<=(n-c);j++)\n  \t\t               A[i][j]=A[i][j+c];\n                       n-=c;\n  \t      \t  \t  }\n  \t      \t  \t  else\n  \t      \t  \t  {\n  \t  \t      \t  \t  for(int i=1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=c+1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]+=A[i][(2*c)+1-j];\n  \t  \t      \t  \t  for(int i=1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=c;j>=n-c+1;j--)\n  \t  \t      \t  \t  A[i][j]=A[i][c+1-j];\n  \t  \t      \t  \t  for(int i=1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n-c;j++)\n  \t  \t      \t  \t  A[i][j]=A[i][j+c];\n                      n=c;\n  \t      \t  \t  }\n  \t          }\n  \t          if(d==2)\n  \t          {\n\t  \t      \t  if(c<=(m/2))\n\t  \t      \t  {\n\t  \t      \t  \t   for(int i=c+1;i<=(2*c);i++)\n  \t      \t  \t\t   for(int j=1;j<=n;j++)\n  \t      \t  \t\t   A[i][j]+=A[(2*c)+1-i][j];\n   \t  \t\t           for(int i=1;i<=m-c;i++)\n  \t\t               for(int j=1;j<=n;j++)\n  \t\t               A[i][j]=A[i+c][j];\n                       m-=c;\n\n  \t      \t  \t  }\n  \t      \t  \t  else\n  \t      \t  \t  {\n  \t  \t      \t  \t  for(int i=c+1;i<=m;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]+=A[(2*c)+1-i][j];\n  \t  \t      \t  \t  for(int i=c;i>=m-c+1;i--)\n  \t  \t      \t  \t  for(int j=1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]=A[c+1-i][j];\n  \t  \t      \t  \t  for(int i=1;i<=m-c;i++)\n  \t  \t      \t  \t  for(int j=1;j<=n;j++)\n  \t  \t      \t  \t  A[i][j]=A[i+c][j];\n                      m=c;\n  \t      \t  \t  }\n          \t  }\n      \t  }\n      \t  int j=0;\n      \t  for(int i=1;i<=p;i++)\n      \t  {\n      \t  \tcin>>x>>y;\n  \t      \tans[++j]=A[y+1][x+1];\n  \t      }\n  \t      for(int i=1;i<=j;i++)\n  \t      {\n      \t  \tcout<<ans[i]<<endl;\n      \t  }\n      \t  cin>>n>>m>>t>>p;\n      }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\nint main()\n{\n\twhile(1)\n\t{\n\t\tint n,m,t,p;\n\t\tcin>>n>>m>>t>>p;\n\t\tif(n==0)\n\t\t\tbreak;\n\t\tint kami[64][64];\n\t\tfill(kami[0],kami[64],0);\n\t\t//初期値を置く\n\t\tfor(int i=0;i<m;i++)\n\t\t{\n\t\t\tfor(int j=0;j<n;j++)\n\t\t\t\tkami[i][j]=1;\n\t\t}\n\t\tint l=0;//現在の左のインデックス\n\t\tint u=0;//現在の上のインデックス\n\t\tint oru[20][2];\n\t\tfor(int i=0;i<t;i++)\n\t\t\tcin>>oru[i][0]>>oru[i][1];\n\t\tint ana[2][20];\n\t\tfor(int i=0;i<p;i++)\n\t\t\tcin>>ana[i][0]>>ana[i][1];\n\t\t\n\t\t//実際に折る\n\t\tfor(int i=0;i<t;i++)\n\t\t{\n\t\t\t//左側に折る\n\t\t\tif(oru[i][0]==1)\n\t\t\t{\n\t\t\t\tl=l+oru[i][1];\n\t\t\t\tfor(int i=0;i<l;i++)\n\t\t\t\t{\n\t\t\t\t\tfor(int j=0;j<64;j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tkami[j][l+i]+=kami[j][l-i-1];\n\t\t\t\t\t\tkami[j][l-i-1]=0;//折り終わったところにはもう何もない\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t//下に折る（実際には上）\n\t\t\t\tu=u+oru[i][1];\n\t\t\t\tfor(int i=0;i<u;i++)\n\t\t\t\t{\n\t\t\t\t\tfor(int j=0;j<64;j++)\n\t\t\t\t\t{\n\t\t\t\t\t\tkami[u+i][j]+=kami[u-i-1][j];\n\t\t\t\t\t\tkami[u-i-1][j]=0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//for debug\n\t\t\t/*\n\t\t\tfor(int j=0;j<m*2;j++)\n\t\t\t{\n\t\t\t\tfor(int k=0;k<n*2;k++)\n\t\t\t\t\tcout<<kami[j][k]<<\" \";\n\t\t\t\tcout<<endl;\n\t\t\t}*/\n\t\t}\n\n\t\t//穴を開ける\n\t\tfor(int i=0;i<p;i++)\n\t\t\tcout<<kami[u+ana[i][1]][l+ana[i][0]]<<endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint n, m, t, p, mm, nn;\nint memo[40][40];\nint d, c, x, y;\n\nint main() {\n  int i, j, a, ans;\n  while(1) {\n    cin >> n >> m >> t >> p;\n    if(n + m + t + p == 0) break;\n    nn = n;\n    mm = m;\n    ans = 0;\n    for(i = 0; i < 40; ++i)\n      for(j = 0; j < 40; ++j) memo[i][j] = 0;\n    for(i = 0; i < m; i++)\n      for(j = 0; j < n; j++) memo[i][j] = 1;\n    for(a = 0; a < t; a++) {\n      cin >> d >> c;\n      if(d == 1) {\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < c / 2; j++) { swap(memo[i][j], memo[i][c - j - 1]); }\n        if(nn - c > c / 2)\n          nn -= c;\n        else\n          nn = c;\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < nn; j++) {\n            if(j < c)\n              memo[i][j] += memo[i][j + c];\n            else\n              memo[i][j] = memo[i][j + c];\n            memo[i][j + c] = 0;\n          }\n      }\n      else {\n        for(i = 0; i < c / 2; i++)\n          for(j = 0; j < nn; j++) { swap(memo[i][j], memo[c - i - 1][j]); }\n        if(mm - c > c / 2)\n          mm -= c;\n        else\n          mm = c;\n        for(i = 0; i < mm; i++)\n          for(j = 0; j < nn; j++) {\n            if(i < c)\n              memo[i][j] += memo[i + c][j];\n            else\n              memo[i][j] = memo[i + c][j];\n            memo[i + c][j] = 0;\n          }\n      }\n      /*for(i = 0; i < m; i++)\n        for(j = 0; j < n; j++)\n          if(i >= mm || j >= nn) memo[i][j] = 0;*/\n      /*for(i=0;i<m;i++){\n        for(j=0;j<n;j++)cout << memo[i][j]<<\" \";\n        cout << endl;\n        }\n        cout << endl;*/\n    }\n    for(a = 0; a < p; a++) {\n      cin >> x >> y;\n      cout << memo[y][x] << endl;\n    }\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\nusing namespace std;\nint n,m,t,p;\nint main()\n{\n    for(;;)\n    {\n        int a[35][35],x[1000],y[1000];\n        scanf(\"%d %d %d %d\",&n,&m,&t,&p);\n        if(n==0&&m==0&&t==0&&p==0)break;\n        for(int i=0;i<33;i++)\n            for(int j=0;j<33;j++)\n            a[j][i]=1;\n        for(int i=0;i<t;i++)\n        {\n            int d,c;\n            scanf(\"%d %d\",&d,&c);\n            if(d==1)\n            {\n                int z[35][35];\n                if(c<=n/2)\n                {\n                    for(int j=c-1;j>=0;j--)\n                        for(int k=0;k<m;k++)\n                    {\n                        z[k][j]=a[k][c-j-1]+a[k][c+j];\n                    }\n                    for(int j=c-1;j>=0;j--)\n                        for(int k=0;k<m;k++)\n                        a[k][j]=z[k][j];\n                    for(int j=c;j<n-c;j++)\n                        for(int k=0;k<m;k++)\n                        a[k][j]=a[k][j+c];\n                    n=n-c;\n                }\n                else\n                {\n                    for(int j=0;j<n-c;j++)\n                        for(int k=0;k<m;k++)\n                        z[k][c-j-1]=a[k][j];\n                    for(int j=n-c-1;j>=0;j--)\n                        for(int k=0;k<m;k++)\n                    {\n                        z[k][j]=a[k][c-j-1]+a[k][c+j];\n                    }\n                    for(int j=0;j<c;j++)\n                        for(int k=0;k<m;k++)\n                        a[k][j]=z[k][j];\n                    n=c;\n                }\n            }\n            else if(d==2)\n            {\n                int z[35][35];\n                if(c>=m/2+1)\n                {\n                    for(int j=2*c-m;j<c;j++)\n                        for(int k=0;k<n;k++)\n                    {\n                        a[j][k]=a[j][k]+a[2*c-j-1][k];\n                    }\n                    m=c;\n                }\n                else\n                {\n                    for(int j=m-2*c;j<m-c;j++)\n                        for(int k=0;k<n;k++)\n                    {\n                        z[j][k]=a[j+2*c-m][k]+a[m-j-1][k];\n                    }\n                    for(int j=0;j<m-2*c;j++)\n                        for(int k=0;k<n;k++)\n                        z[j][k]=a[m-j-1][k];\n                    for(int j=0;j<m-c;j++)\n                        for(int k=0;k<n;k++)\n                    {\n                        a[j][k]=z[j][k];\n                    }\n                    m=m-c;\n                }\n            }\n        }\n        for(int i=0;i<p;i++)\n        {\n            scanf(\"%d %d\",&x[i],&y[i]);printf(\"%d\\n\",a[m-1-y[i]][x[i]]);\n        }\n        for(int i=0;i<p;i++)\n        {\n\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = int64_t;\n\nconst size_t arr_size = 32 * 24;\nint arr[arr_size][arr_size];\n\npair<int, int> edge(pair<int, int> orig) {\n    int h, w;\n    tie(h, w) = orig;\n    int rh = h, rw = w;\n    while(arr[rh][w] > 0) rh++;\n    while(arr[h][rw] > 0) rw++;\n    return make_pair(rh, rw);\n}\n\nbool solve() {\n    int N, M, T, P;\n    cin >> N >> M >> T >> P;\n\n    if(!(N + M + T + P)) return false;\n\n    for(int i = 0; i < arr_size; i++) for(int j = 0; j < arr_size; j++) {\n        arr[i][j] = (0 <= i && i < M &&\n                     0 <= j && j < N);\n    }\n\n    pair<int, int> orig(0, 0);\n    while(T--) {\n        int d, c;\n        cin >> d >> c;\n        int oh, ow;\n        tie(oh, ow) = orig;\n        int bh, bw;\n        tie(bh, bw) = edge(orig);\n        if(d == 1) {\n            int nh = oh, nw = ow + c;\n            int w_sum = 2 * c - 1;\n            for(int h = oh; h < bh; h++) {\n                for(int dw = 0; dw < w_sum - dw; dw++) {\n                    arr[h][ow + w_sum - dw] += arr[h][ow + dw];\n                    arr[h][ow + dw] = 0;\n                }\n            }\n            orig = make_pair(nh, nw);\n        } else {\n            int nh = oh + c, nw = ow;\n            int h_sum = 2 * c - 1;\n            for(int dh = 0; dh < h_sum - dh; dh++) {\n                for(int w = ow; w < bw; w++) {\n                    arr[oh + h_sum - dh][w] += arr[oh + dh][w];\n                    arr[oh + dh][w] = 0;\n                }\n            }\n            orig = make_pair(nh, nw);\n        }\n    }\n\n    int oh, ow;\n    tie(oh, ow) = orig;\n    while(P--) {\n        int x, y;\n        cin >> x >> y;\n        cout << arr[oh + y][ow + x] << endl;\n    }\n    return true;\n}\n\nint main() {\n    while(solve());\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint A[200][200];\n\nint main(){\n  int n,m,t,p;\n  while(1){\n    cin>>n>>m>>t>>p;\n    if(n==0&&m==0&&t==0&&p==0)break;\n\n    for(int i=0;i<200;i++)\n      for(int j=0;j<200;j++)\n        A[i][j]=0;\n    \n    for(int i=0;i<m;i++)\n      for(int j=0;j<n;j++)\n        A[i][j]=1;\n    \n    for(int u=0;u<t;u++){\n      int d,c;\n      cin>>d>>c;\n      if(d==1){\n        \n        for(int i=0;i<m;i++){\n          for(int j=0;j<c;j++){\n            int dist=c-j;\n            A[i][c+dist-1]+=A[i][j];\n            A[i][j]=0;\n          }\n        }\n\n        for(int i=0;i<100;i++){\n          for(int j=0;j<100;j++){\n            A[i][j]=A[i][j+c];\n          }\n        }\n        \n      }else{\n        \n        for(int i=0;i<c;i++){\n          for(int j=0;j<n;j++){\n            int dist=c-i;\n            A[c+dist-1][j]+=A[i][j];\n            A[i][j]=0;\n          }\n        }\n\n        for(int i=0;i<100;i++){\n          for(int j=0;j<100;j++){\n            A[i][j]=A[i+c][j];\n          }\n        }\n        \n      }\n      \n    }\n    \n    for(int i=0;i<p;i++){\n      int x,y;\n      cin>>x>>y;\n      cout<<A[y][x]<<endl;\n    }\n    \n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst long long mod = 1e9+7;\n\n\nint main(){\n    ios::sync_with_stdio(false);\n\tcin.tie(0);\n\n    int n,m,t,p;\n    vector<int> ans;\n    while(cin>>n>>m>>t>>p){\n        if(n==0) break;\n        vector<int> h(50000),w(50000);\n        for(int i=0;i<m;i++) h[i] = 1;\n        for(int i=0;i<n;i++) w[i] = 1;\n        int dd,c;\n        int l=0,d=0;\n        for(int i=0;i<t;i++){\n            cin>>dd>>c;\n            if(dd==1){\n                for(int j=1;j<=c;j++){\n                    w[l+c+j-1] += w[l+c-j];\n                }\n                l+=c;\n            }\n            else {\n                for(int j=1;j<=c;j++){\n                    h[d+c+j-1] += h[d+c-j];\n                }\n                d+=c;\n            }\n        }\n        \n        \n        int x,y;\n        for(int i=0;i<p;i++){\n            cin >> x >> y;\n            cout << h[d+y] * w[l+x] << endl;;\n            ans.push_back( h[d+y] * w[l+x]  );\n        }\n    }\n    //cerr<<endl;\n    //for(auto i:ans) cerr<<i<<endl;\n    \n    \n    \n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <stdlib.h>\n#include <algorithm>\n#include <vector>\n#include <stdio.h>\nusing namespace std;\ntypedef long long ll;\nint n,m,t,p;\nint type,c;\nint main()\n{\n    while(~scanf(\"%d%d%d%d\",&m,&n,&t,&p)&&(m+n+t+p))\n    {\n        vector<vector<ll> >q(50);\n        for(int i=0; i<n; i++)\n        {\n            for(int j=0; j<m; j++)\n            {\n                q[i].push_back(1ll);\n            }\n        }\n        while(t--)\n        {\n            scanf(\"%d%d\",&type,&c);\n            if(type==1)\n            {\n                for(int j=0; j<n; j++)\n                {\n                    for(int i=0; i<=c-1; i++)\n                        q[j][2*c-1-i]+=q[j][i];\n                }\n                for(int i=0; i<n; i++)\n                    for(int j=0; j<m-c; j++)\n                        q[i][j]=q[i][j+c];\n            }\n            else if(type==2)\n            {\n                for(int j=0; j<m; j++)\n                    for(int i=0; i<=c-1; i++)\n                    {\n                        q[2*c-1-i][j]+=q[i][j];\n                    }\n                q.erase(q.begin(),q.begin()+c);\n            }\n        }\n        int x,y;\n        //ll ans=0;\n        while(p--)\n        {\n            scanf(\"%d%d\",&x,&y);\n            printf(\"%lld\\n\",q[y][x]);\n        }\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint main()\n{\n    while(true){\n        int n, m, t, p;\n        cin >> n >> m >> t >> p;\n        if(n == 0 && m == 0 && t == 0 && p == 0){\n            break;\n        }\n        int d[35], c[35];\n        for(int i = 0; i < t; i++){\n            cin >> d[i] >> c[i];\n        }\n        int a[70][70];\n        for(int i = 0; i < 70; i++){\n            for(int j = 0; j < 70; j++){\n                a[i][j] = 0;\n            }\n        }\n        for(int i = 0; i < n; i++){\n            for(int j = 0; j < m; j++){\n                a[i][j] = 1;\n            }\n        }\n        for(int i = 0; i < t; i++){\n            if(d[i] == 1){\n                for(int j = c[i]; j < c[i] * 2; j++){\n                    for(int k = 0; k < m; k++){\n                        a[j][k] += a[c[i] * 2 - 1 - j][k];\n                    }\n                }\n                for(int j = 0; j < 35; j++){\n                    for(int k = 0; k < m; k++){\n                        a[j][k] = a[j + c[i]][k];\n                    }\n                }\n                for(int j = 35; j < 70; j++){\n                    for(int k = 0; k < m; k++){\n                        a[j][k] = 0;\n                    }\n                }\n            }\n            if(d[i] == 2){\n                for(int j = c[i]; j < c[i] * 2; j++){\n                    for(int k = 0; k < n; k++){\n                        a[k][j] += a[k][c[i] * 2 - 1 - j];\n                    }\n                }\n                for(int j = 0; j < 35; j++){\n                    for(int k = 0; k < n; k++){\n                        a[k][j] = a[k][j + c[i]];\n                    }\n                }\n                for(int j = 35; j < 70; j++){\n                    for(int k = 0; k < n; k++){\n                        a[k][j] = 0;\n                    }\n                }\n            }\n        }\n        int x[35], y[35];\n        for(int i = 0; i < p; i++){\n            cin >> x[i] >> y[i];\n            cout << a[x[i]][y[i]] << endl;\n        }\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "//author Eterna\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<string>\n#include<cstring>\n#include<vector>\n#include<map>\n#include<set>\n#include<queue>\n#include<stack>\n#include<utility>\n#include<cmath>\n#include<climits>\n#include<deque>\n#include<functional>\n#define INF 0x7fffffff\n#define maxn 100000\n#define eps 1e-15\n#define MOD ((int)(1e9+7))\n#define ABS(x) ((x)>=0?(x):(-(x)))\n#define pb(x) push_back(x)\n#define lowbit(x) (x&-x)\n#define mid (L+R)/2\n#define Lson (index*2)\n#define Rson (index*2+1)\nusing namespace std;\ntypedef long long ll;\ninline ll read() {\n\tchar c;\n\tll ret = 0, sgn = 1;\n\tdo { c = getchar(); } while ((c < '0' || c > '9') && c != '-');\n\tif (c == '-') sgn = -1; else ret = c - '0';\n\twhile ((c = getchar()) >= '0' && c <= '9') ret = ret * 10 + (c - '0');\n\treturn sgn * ret;\n}\nint arr[100][100];\nint n, m, t, p, o, x, a, b;\nvoid move_left(ll x) {\n\tfor (ll i = 1; i <= m; i++)\n\t\tfor (ll j = 1; j <= max(x, n - x); j++) {\n\t\t\tarr[i][j] = arr[i][j + x];\n\t\t\tarr[i][j + x] = 0;\n\t\t}\n\tn = max(x, n - x);\n}\nvoid move_down(ll x) {\n\tfor (ll i = 1; i <= n; i++)\n\t\tfor (ll j = 1; j <= max(x, m - x); j++) {\n\t\t\tarr[j][i] = arr[j + x][i];\n\t\t\tarr[j + x][i] = 0;\n\t\t}\n\tm = max(x, m - x);\n}\nint main(void)\n{\n\twhile (scanf(\"%d %d %d %d\", &n, &m, &t, &p) && n&&m&&t&&p) {\n\t\tmemset(arr, 0, sizeof(arr));\n\t\tfor (ll i = 1; i <= m; i++)\n\t\t\tfor (ll j = 1; j <= n; j++) arr[i][j] = 1;\n\t\tfor (ll i = 1; i <= t; i++) {\n\t\t\tcin >> o >> x;\n\t\t\tif (o == 1) {\n\t\t\t\tfor (int k = 1; k <= m; k++) {\n\t\t\t\t\tfor (int j = 1; j <= x; j++)\n\t\t\t\t\t\tarr[k][2 * x - j + 1] += arr[k][j];\n\t\t\t\t}\n\t\t\t\tmove_left(x);\n\t\t\t}\n\t\t\telse if (o == 2) {\n\t\t\t\tfor (int k = 1; k <= n; k++)\n\t\t\t\t\tfor (int j = 1; j <= x; j++)\n\t\t\t\t\t\tarr[2 * x - j + 1][k] += arr[j][k];\n\t\t\t\tmove_down(x);\n\t\t\t}\n\t\t}\n\t\tfor (int i = 1; i <= p; i++) {\n\t\t\tcin >> a >> b; a++; b++;\n\t\t\tcout << arr[b][a] << endl;\n\t\t}\n\t}\n\t//system(\"pause\");\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <stdlib.h>\n#include <algorithm>\n#include <vector>\n#include <stdio.h>\nusing namespace std;\ntypedef long long ll;\nint n,m,t,p;\nint type,c;\nint main()\n{\n    while(~scanf(\"%d%d%d%d\",&m,&n,&t,&p)&&(m+n+t+p))\n    {\n        vector<vector<ll> >q(5050);\n        for(int i=0; i<n; i++)\n        {\n            for(int j=0; j<m; j++)\n            {\n                q[i].push_back(1ll);\n            }\n        }\n        while(t--)\n        {\n            scanf(\"%d%d\",&type,&c);\n            if(type==1)\n            {\n                for(int j=0; j<n; j++)\n                {\n                    for(int i=0; i<=c-1; i++)\n                        q[j][2*c-1-i]+=q[j][i];\n                }\n                for(int i=0; i<n; i++)\n                    for(int j=0; j<m-c; j++)\n                        q[i][j]=q[i][j+c];\n            }\n            else if(type==2)\n            {\n                for(int j=0; j<m; j++)\n                    for(int i=0; i<=c-1; i++)\n                    {\n                        q[2*c-1-i][j]+=q[i][j];\n                    }\n                q.erase(q.begin(),q.begin()+c);\n            }\n        }\n        int x,y;\n        ll ans=0;\n        while(p--)\n        {\n            scanf(\"%d%d\",&x,&y);\n            printf(\"%lld\\n\",q[y][x]);\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint main(){\n  while(true){\n    int n, m, t, p;\n    cin >> n >> m >> t >> p;\n\n    if(n==0 && m==0 && t==0 && p==0)\n      break;\n\n    int Ori[64][64] = { {0} };\n    for(int y=0; y<m; y++){\n      for(int x=0; x<n; x++){\n\tOri[y][x] = 1;\n      }\n    }\n\n    for(int i=0; i<t; i++){\n      int d, c;\n      cin >> d >> c;\n\n      if(d==1){\n\tfor(int x=0; x<c; x++){\n\t  for(int y=0; y<m; y++){\n\t    Ori[y][2*c-x-1] += Ori[y][x];\n\t    Ori[y][x] = 0;\n\t  }\n\t}\n\n\tfor(int x=0; x<n; x++){\n\t  for(int y=0; y<m; y++){\n\t    Ori[y][x] = Ori[y][x+c];\n\t    Ori[y][x+c] = 0;\n\t  }\n\t}\n      }\n      else{\n\tfor(int y=0; y<c; y++){\n\t  for(int x=0; x<n; x++){\n\t    Ori[2*c-1-y][x] += Ori[y][x];\n\t    Ori[y][x] = 0;\n\t  }\n\t}\n\n\tfor(int y=0; y<m; y++){\n\t  for(int x=0; x<n; x++){\n\t    Ori[y][x] = Ori[y+c][x];\n\t    Ori[y+c][x] = 0;\n\t  }\n\t}\n      }\n    }\n\n    for(int i=0; i<p; i++){\n      int x, y;\n      cin >> x >> y;\n\n      cout << Ori[y][x] << endl;\n    }\n  }\n\n  return 0;\n}\n\t\t\t\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint main(){\n  int n,m,t,p;\n\n  while(1){\n    cin >> n >> m >> t >> p ;\n\n    if(n==0 && m==0 && t==0 && p==0){\n      break;\n    }\n\n    int Ori[64][64] = {{0}};\n    for(int y=0;y<m;y++){\n      for(int x=0;x<n;x++){\n        Ori[y][x] = 1;\n      }\n    }\n\n    for(int i=0;i<t;i++){\n      int d,c;\n      cin >> d >> c;\n\n      if(d==1){\n        for(int x=0;x<c;x++){\n          for(int y=0;y<m;y++){\n            Ori[y][2*c-1-x] += Ori[y][x];\n            Ori[y][x] = 0;\n          }\n        }\n\n        for(int x=0;x<n;x++){\n          for(int y=0;y<m;y++){\n            Ori[y][x] = Ori[y][x+c];\n            Ori[y][x+c] = 0;\n          }\n        }\n      }\n      else{\n        for(int y=0;y<c;y++){\n          for(int x=0;x<n;x++){\n            Ori[2*c-1-y][x] += Ori[y][x];\n            Ori[y][x] = 0;\n          }\n        }\n\n        for(int y=0;y<m;y++){\n          for(int x=0;x<n;x++){\n            Ori[y][x] = Ori[y+c][x];\n            Ori[y+c][x] = 0;\n          }\n        }\n      }\n    }\n\n    for(int i=0;i<p;i++){\n      int x,y;\n      cin >> x >> y;\n\n      cout << Ori[y][x] << endl;\n    }\n  }\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long int ll;\ntypedef pair<ll,ll> mp;\nll inf =  1e9;\n\n\nint main(){\n    while(1){\n\tint n,m,t,p;//n:wide m:height\n\tcin>>n>>m>>t>>p;\n\tif(n==0)break;\n\tvector<vector<int> > s(2*m,vector<int>(2*n,0));\n\tfor(int i=0;i<m;i++)for(int j=0;j<n;j++)s[i][j] = 1;\n\t//cout<<\"OK\"<<endl;\n\t//for(int i=0;i<2*m;i++){\n\t  //  for(int j=0;j<2*n;j++){\n\t//\tcout<<s[i][j]<<' ';\n\t  //  }\n\t    //cout<<endl;\n\t//}\n\tfor(int i=0;i<t;i++){\n\t    vector<vector<int> > s2(2*m,vector<int>(2*n,0) );\n\t    int d,c;\n\t    cin>>d>>c;\n\t    int w = 0,h = 0;\n\t    if(d==1){\n\t\tw = c;\n\t\tfor(int i=0;i<2*m;i++)for(int j=0;j<c;j++) s[i][j+c] += s[i][c-1-j];\n\t    }else{\n\t\th = c;\n\t\tfor(int i=0;i<c;i++)for(int j=0;j<2*n;j++) s[i+c][j] += s[c-1-i][j];\n\t    }\n\t    for(int i=h;i<2*m;i++)for(int j=w;j<2*n;j++)s2[i-h][j-w] = s[i][j];\n\t    //cout<<i<<endl;\n\t    //for(int i=0;i<2*m;i++){\n\t\t//for(int j=0;j<2*n;j++)cout<<s2[i][j]<<' ';\n\t\t//cout<<endl;\n\t    //}\n\t    s = s2;\n\t}\n\tfor(int i=0;i<p;i++){\n\t    int x,y;\n\t    cin>>x>>y;\n\t    cout<<s[y][x]<<endl;\n\t}\n\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define rep(i,n) for(int i=0;i<n;i++)\n#define rep2(i,a,b) for(int i=a;i<=b;i++)\n#define all(c) (c).begin(),(c).end()\n\nusing namespace std;\nint in(){int x;cin>>x;return x;}\n\n#define int long long\nmain(){\n    while(1){\n        int m=in(),n=in(),t=in(),p=in();\n        if(n==0 and m==0 and t==0 and p==0) break;\n        vector<vector<int> > v(n,vector<int>(m,1));\n        int a = 0,b = 0;\n        rep(_,t){\n            int d=in(),c=in();\n            if(d==2){\n                vector<vector<int> > w(n,vector<int>(m));\n                rep(i,c){\n                    rep(j,m)w[c-1-i][j]+=v[i][j];\n                }\n                rep2(i,c,n-1)rep(j,m)w[i-c][j]+=v[i][j];\n                v=w;\n            }\n            else{\n                vector<vector<int> > w(n,vector<int>(m));\n                rep(i,n)rep(j,c)w[i][c-1-j]+=v[i][j];\n                rep(i,n)rep2(j,c,m-1)w[i][j-c]+=v[i][j];\n                v = w;\n            }\n        }\n        int ans = 0;\n        rep(i,p){\n            int x=in(),y=in();\n            cout << v[y][x] << endl;\n        }\n                \n    }\n}\n\n\n"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\n#define MAX 500\n\nint main(void){\n\tint w, h, t, p, d, c, x, y;\n\tint ans, dist, origin_x, origin_y;\n\n\twhile(1){\n\t\tint kami[MAX][MAX]={0};\n\n\t\tscanf(\"%d %d %d %d\", &w, &h, &t, &p);\n\t\tif(w==0 && h==0 && t==0 && p==0) break;\n\t\tfor(int i=0; i<h; i++){\n\t\t\tfor(int j=0; j<w; j++){\n\t\t\t\tkami[i][j] = 1;//初期化\n\t\t\t}\n\t\t}\n\n\t\torigin_x = origin_y =0;\n\t\tfor(int k=0; k<t; k++){\n\t\t\tscanf(\"%d %d\",&d, &c);\n\n\t\t\tif(d == 1){\n\t\t\t\tdist = 1;\n\t\t\t\t\tfor(int j=origin_x+c; j<origin_x+(2*c); j++){\n\t\t\t\t\t\tfor(int i=origin_y; i<MAX; i++){\n\t\t\t\t\t\t\tif(j-dist >= 0)kami[i][j] += kami[i][j-dist];\n\t\t\t\t\t}\n\t\t\t\t\tdist += 2;\n\t\t\t\t}\n\t\t\t\torigin_x += c;\n\t\t\t} else{\n\t\t\t\tdist = 1;\n\t\t\t\tfor(int i=origin_y+c; i<origin_y+(2*c); i++){\n\t\t\t\t\tfor(int j=origin_x; j<MAX; j++){\n\t\t\t\t\t\tif(i-dist >= 0)kami[i][j] += kami[i-dist][j];\n\t\t\t\t\t}\n\t\t\t\t\tdist += 2;\n\t\t\t\t}\n\t\t\t\torigin_y += c;\n\t\t\t}\n\n\n\t\t}\n\t\t\n\t\tfor(int k=0; k<p; k++){\n\t\t\tscanf(\"%d %d\", &x, &y);\n\t\t\tprintf(\"%d\\n\", kami[origin_y+y][x+origin_x]);\n\t\t}\n\t}\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\n#define MAX 500 //配列の大きさは500*500で十分です。\n\nusing namespace std;\n\nint main(void){\n\twhile(1){\n\t\t//問題ではn, m, t, pとして与えられますが、\n\t\t//nはw、mはhとして変数を用意します。\n\t\tint w, h, t, p; \n\t\tscanf(\" %d %d %d %d\", &w, &h, &t, &p);\n\t\tif(!w && !h && !t && !p) break;\n\n\t\t//2次元配列は行列のように、i行j列(kami[i][j])として考えます。\n\t\t//そのため、座標(x, y)は kami[y][x] となります。\n\t\tint kami[MAX][MAX] = {0};\n\t\tfor(int i=0; i<h; i++){\n\t\t\tfor(int j=0; j<w; j++){\n\t\t\t\tkami[i][j] = 1;//折り紙が存在する部分を1で初期化\n\t\t\t}\n\t\t}\n\n\t\tint origin_x = 0, origin_y =0; //折り紙左上の角の座標を原点として記憶(kami[origin_y][origin_x])\n\t\tfor(int k=0; k<t; k++){\n\t\t\tint d, c;\n\t\t\tscanf(\" %d %d\", &d, &c);\n\n\t\t\tif(d == 1){\n\t\t\t\t//もし d が 1 なら，左端から c だけ右側を通る垂直の折り線の左側を右側に折り重ねる．\n\t\t\t\tint dist = 1; //distは折られる前の座標と、折る先の座標の差の絶対値。\n\t\t\t\tfor(int j=origin_x+c; j<origin_x+(2*c); j++){\t//折られる先のx座標\n\t\t\t\t\tfor(int i=origin_y; i<MAX; i++){\t//垂直方向に折るループ\n\t\t\t\t\t\tkami[i][j] += kami[i][j-dist];\n\t\t\t\t\t}\n\t\t\t\t\tdist += 2;\n\t\t\t\t}\n\t\t\t\torigin_x += c;\n\t\t\t} else{\n\t\t\t\t//このプログラムの場合は、上下を入れ替えています。\n\t\t\t\t//\t→もし d が 2 なら，上端から c だけ下側を通る水平の折り線の上側を下側に折り重ねる。\n\t\t\t\tint dist = 1; //distは折られる前の座標と、折る先の座標の差の絶対値。\n\t\t\t\tfor(int i=origin_y+c; i<origin_y+(2*c); i++){\t//折られる先のy座標\n\t\t\t\t\tfor(int j=origin_x; j<MAX; j++){\t//水平方向に折るループ\n\t\t\t\t\t\tkami[i][j] += kami[i-dist][j];\n\t\t\t\t\t}\n\t\t\t\t\tdist += 2;\n\t\t\t\t}\n\t\t\t\torigin_y += c;\n\t\t\t}\n\t\t}\n\n\t\tfor(int k=0; k<p; k++){\n\t\t\tint x, y;\n\t\t\tscanf(\" %d %d\", &x, &y);\n\t\t\tprintf(\"%d\\n\", kami[origin_y+y][origin_x+x]);\n\t\t}\n\t}\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#define ll long long\n#define rep(i,l,r)for(ll i=l;i<r;i++)\n#define max(p,q)((p)>(q)?(p):(q))\n\nint main(){\n\tll w,h,n,q;\n\twhile(scanf(\"%lld%lld%lld%lld\",&w,&h,&n,&q),n){\n\t\tint tate[40],yoko[40];\n\t\trep(i,0,h)tate[i]=1;\n\t\trep(i,0,w)yoko[i]=1;\n\t\twhile(n--){\n\t\t\tll c,f;\n\t\t\tscanf(\"%lld%lld\",&f,&c);\n\t\t\tif(f==1){\n\t\t\t\t//yoko\n\t\t\t\tint temp[40]={};\n\t\t\t\trep(i,0,max(c,w-c)){\n\t\t\t\t\tif(c+i<w)temp[i]+=yoko[c+i];\n\t\t\t\t\tif(i<c)temp[i]+=yoko[c-1-i];\n\t\t\t\t}\n\t\t\t\tw=max(c,w-c);\n\t\t\t\trep(i,0,w)yoko[i]=temp[i];\n\t\t\t}else{\n\t\t\t\t//tate\n\t\t\t\tint temp[40]={};\n\t\t\t\trep(i,0,max(c,h-c)){\n\t\t\t\t\tif(c+i<h)temp[i]+=tate[c+i];\n\t\t\t\t\tif(i<c)temp[i]+=tate[c-1-i];\n\t\t\t\t}\n\t\t\t\th=max(c,h-c);\n\t\t\t\trep(i,0,h)tate[i]=temp[i];\n\t\t\t}\n\t\t}\n\t\twhile(q--){\n\t\t\tll x,y;\n\t\t\tscanf(\"%lld%lld\",&x,&y);\n\t\t\tprintf(\"%lld\\n\",yoko[x]*tate[y]);\n\t\t}\n\t}\n}\n"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\nint a[501][501]={0},n,m,p,t,i,j,z,d,c,si,sj,qq,s,h,mm;\nint main()\n{\n    scanf(\"%d %d %d %d\",&n,&m,&t,&p);\n    while(!((n==0)&&(m==0)&&(p==0)&&(t==0)))\n    {\n       si=0;\n       sj=0;\n       /*8\n       for(i=1;i<=100;i=i+1)\n         for(j=1;j<=100;j=j+1)\n           a[i][j]=0;\n           */\n       //printf();\n       for(i=1;i<=m;i=i+1)\n         for(j=1;j<=n;j=j+1)\n         {\n              a[i][j]=1;\n         }\n\n       for(z=1;z<=t;z=z+1)\n       {\n            scanf(\"%d %d\",&d,&c);\n            if(d==1)\n            {\n                for(i=si;i<=m;i=i+1)\n                   for(j=sj+c;j>=sj+1;j=j-1)\n                    {\n                        qq=sj+c-j;\n                        if(sj+c+1+qq>n)\n                        {\n                            n=sj+c+1+qq;\n                            for(mm=1;mm<=m;mm=mm+1)\n                                a[mm][sj+c+1+qq]=0;\n                        }\n                        a[i][sj+c+1+qq]=a[i][sj+c+1+qq]+a[i][j];\n                    }\n               sj=sj+c;\n            }\n            if(d==2)\n            {\n                for(j=sj;j<=n;j=j+1)\n                   for(i=si+c;i>=si+1;i=i-1)\n                    {\n                        qq=si+c-i;\n                        if(si+c+1+qq>m)\n                        {\n                            m=si+c+1+qq;\n                            for(mm=1;mm<=n;mm=mm+1)\n                                a[si+c+1+qq][mm]=0;\n                        }\n                        a[si+c+1+qq][j]=a[si+c+1+qq][j]+a[i][j];\n                    }\n                si=si+c;\n            }\n            /*\n            printf(\"----------\\n\");\n            for(i=1;i<=2*m;i=i+1)\n            {\n\n               for(j=1;j<=2*n;j=j+1)\n                 printf(\"%d \",a[i][j]);\n               printf(\"\\n\");\n            }\n            printf(\"----------\\n\");\n            printf(\"si=%d sj=%d\\n\",si,sj);\n            */\n\n       }\n       /*\n       printf(\"----------\\n\");\n       for(i=1;i<=2*m;i=i+1)\n       {\n\n           for(j=1;j<=2*n;j=j+1)\n            printf(\"%d \",a[i][j]);\n           printf(\"\\n\");\n       }\n       printf(\"----------\\n\");\n       printf(\"si=%d sj=%d\\n\",si,sj);\n       */\n       for(z=1;z<=p;z=z+1)\n       {\n           scanf(\"%d %d\",&d,&c);\n           d=d+1;\n           c=c+1;\n           printf(\"%d\\n\",a[c+si][d+sj]);\n       }\n\n       scanf(\"%d %d %d %d\",&n,&m,&t,&p);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\n#define MAX 500 //配列の大きさは500*500で十分です。\n\nint main(void){\n\twhile(1){\n\t\t//入力\n\t\t//問題ではn, m, t, pとして与えられますが、\n\t\t//nはw、mはhとして変数を用意します。\n\t\tint w, h, t, p; \n\t\tscanf(\" %d %d %d %d\", &w, &h, &t, &p);\n\t\tif(!w && !h && !t && !p) break;\n\n\t\t//2次元配列は行列のように、i行j列(kami[i][j])として考えます。\n\t\t//そのため、座標(x, y)は kami[y][x] となります。\n\t\tint kami[MAX][MAX] = {0};\n\t\tfor(int i=0; i<h; i++){\n\t\t\tfor(int j=0; j<w; j++){\n\t\t\t\tkami[i][j] = 1;//折り紙が存在する部分を1で初期化\n\t\t\t}\n\t\t}\n\n\t\t//処理\n\t\tint origin_x = 0, origin_y =0; //折り紙左上の角の座標を原点として記憶(kami[origin_y][origin_x])\n\t\tfor(int k=0; k<t; k++){\n\t\t\tint d, c;\n\t\t\tscanf(\" %d %d\", &d, &c);\n\n\t\t\tif(d == 1){\n\t\t\t\t//もし d が 1 なら，左端から c だけ右側を通る垂直の折り線の左側を右側に折り重ねる．\n\t\t\t\tint dist = 1; //distは折られる前の座標と、折る先の座標の差の絶対値。\n\t\t\t\tfor(int j=origin_x+c; j<origin_x+(2*c); j++){\t//折られる先のx座標\n\t\t\t\t\tfor(int i=0; i<MAX; i++){\t//垂直方向に折るループ\n\t\t\t\t\t\tkami[i][j] += kami[i][j-dist];\n\t\t\t\t\t}\n\t\t\t\t\tdist += 2;\n\t\t\t\t}\n\t\t\t\torigin_x += c;\n\t\t\t} else{\n\t\t\t\t//このプログラムの場合は、上下を入れ替えています。\n\t\t\t\t//\t→もし d が 2 なら，上端から c だけ下側を通る水平の折り線の上側を下側に折り重ねる。\n\t\t\t\tint dist = 1; //distは折られる前の座標と、折る先の座標の差の絶対値。\n\t\t\t\tfor(int i=origin_y+c; i<origin_y+(2*c); i++){\t//折られる先のy座標\n\t\t\t\t\tfor(int j=0; j<MAX; j++){\t//水平方向に折るループ\n\t\t\t\t\t\tkami[i][j] += kami[i-dist][j];\n\t\t\t\t\t}\n\t\t\t\t\tdist += 2;\n\t\t\t\t}\n\t\t\t\torigin_y += c;\n\t\t\t}\n\t\t}\n\n\t\t//入力・出力\n\t\tfor(int k=0; k<p; k++){\n\t\t\tint x, y;\n\t\t\tscanf(\" %d %d\", &x, &y);\n\t\t\tprintf(\"%d\\n\", kami[origin_y+y][origin_x+x]);\n\t\t}\n\t}\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\nint main(void){\n    int wid, hei, t, p;\n    while(1){\n        scanf(\"%d%d%d%d\",&wid,&hei,&t,&p);\n        if(wid==0) break;\n        int mat[500][500];//mat[wid][hei]\n        for(int i=0;i<500;i++){\n            for(int j=0;j<500;j++){\n                if(i<wid&&j<hei) mat[i][j]=1;\n                else mat[i][j]=0;\n            }\n        }\n        int nw=0, nh=0;\n        /*for(int i=0;i<10;i++){\n            for(int j=0;j<10;j++){\n                printf(\"%d \",mat[i][j]);\n            }puts(\"\");\n        }*/\n        for(int i=0;i<t;i++){\n            int d, c;\n            scanf(\"%d%d\",&d,&c);\n            if(d==1){\n                nw+=c;\n                for(int j=0;j<c;j++){\n                    for(int k=0;k<hei;k++){\n                        mat[nw+j][nh+k] += mat[nw-j-1][nh+k];\n                    }\n                }\n                wid = (c>wid-c)?c:wid-c;\n            }else{\n                nh+=c;\n                for(int j=0;j<c;j++){\n                    for(int k=0;k<wid;k++){\n                        mat[nw+k][nh+j] += mat[nw+k][nh-j-1];\n                    }\n                }\n                hei = (c>hei-c)?c:hei-c;\n            }\n        }\n        for(int i=0;i<p;i++){\n            int x, y;\n            scanf(\"%d%d\",&x,&y);\n            printf(\"%d\\n\",mat[nw+x][nh+y]);\n        }\n    }\n}\n\n"
  },
  {
    "language": "C",
    "code": "// AOJ 1625 Origami, or the art of folding paper\n// 2019.3.25 bal4u\n\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n\n//// 入力処理\n#if 1\n#define gc() getchar_unlocked()\n#else\n#define gc() getchar()\n#endif\nint in()  // 非負整数の入力\n{\n\tint n = 0, c = gc();\n\tdo n = 10 * n + (c & 0xf), c = gc(); while (c >= '0');\n\treturn n;\n}\n\nint H, W;\nint map[2][70][70];\n\nint main()\n{\n\tint i, t, p, r, c, id;\n\n\twhile (W = in()) {\n\t\tH = in(), t = in(), p = in();\n\t\tmemset(map, 0, sizeof(map));\n\t\tfor (r = 0; r < H; r++) for (c = 0; c < W; c++) map[0][r][c] = 1;\n\t\tfor (id = 0, i = 0; i < t; i++, id = !id) {\n\t\t\tint d = in(), e = in();\n\t\t\tif (d == 1) {\t// 横方向に折る\n\t\t\t\tfor (r = 0; r < H; r++) for (c = e; c < 2 * e; c++)\n\t\t\t\t\tmap[id][r][c] += map[id][r][2 * e - c - 1];\n\t\t\t\tif (W - e > e) W -= e; else W = e;\n\t\t\t\tmemset(map[!id], 0, sizeof(map[0]));\n\t\t\t\tfor (r = 0; r < H; r++) for (c = 0; c < W; c++)\n\t\t\t\t\tmap[!id][r][c] = map[id][r][c + e];\n\t\t\t}\n\t\t\telse {        // 縦に（上下に）折る\n\t\t\t\tfor (r = e; r < 2 * e; r++) for (c = 0; c < W; c++)\n\t\t\t\t\tmap[id][r][c] += map[id][2 * e - r - 1][c];\n\t\t\t\tif (H - e > e) H -= e; else H = e;\n\t\t\t\tmemset(map[!id], 0, sizeof(map[0]));\n\t\t\t\tfor (r = 0; r < H; r++) for (c = 0; c < W; c++)\n\t\t\t\t\tmap[!id][r][c] = map[id][r + e][c];\n\t\t\t}\n\t\t}\n\t\tfor (i = 0; i < p; i++) {\n\t\t\tc = in(), r = in();\n\t\t\tprintf(\"%d\\n\", map[id][r][c]);\n\t\t}\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n\n#define MAX 500 //配列の大きさは500*500で十分です。\n\nint main(void){\n\twhile(1){\n\t\t//問題ではn, m, t, pとして与えられますが、\n\t\t//nはw、mはhとして変数を用意します。\n\t\tint w, h, t, p; \n\t\tscanf(\" %d %d %d %d\", &w, &h, &t, &p);\n\t\tif(!w && !h && !t && !p) break;\n\n\t\t//2次元配列は行列のように、i行j列(kami[i][j])として考えます。\n\t\t//そのため、座標(x, y)は kami[y][x] となります。\n\t\tint kami[MAX][MAX] = {0};\n\t\tfor(int i=0; i<h; i++){\n\t\t\tfor(int j=0; j<w; j++){\n\t\t\t\tkami[i][j] = 1;//折り紙が存在する部分を1で初期化\n\t\t\t}\n\t\t}\n\n\t\tint origin_x = 0, origin_y =0; //折り紙左上の角の座標を原点として記憶(kami[origin_y][origin_x])\n\t\tfor(int k=0; k<t; k++){\n\t\t\tint d, c;\n\t\t\tscanf(\" %d %d\", &d, &c);\n\n\t\t\tif(d == 1){\n\t\t\t\t//もし d が 1 なら，左端から c だけ右側を通る垂直の折り線の左側を右側に折り重ねる．\n\t\t\t\tint dist = 1; //distは折られる前の座標と、折る先の座標の差の絶対値。\n\t\t\t\tfor(int j=origin_x+c; j<origin_x+(2*c); j++){\t//折られる先のx座標\n\t\t\t\t\tfor(int i=origin_y; i<MAX; i++){\t//垂直方向に折るループ\n\t\t\t\t\t\tkami[i][j] += kami[i][j-dist];\n\t\t\t\t\t}\n\t\t\t\t\tdist += 2;\n\t\t\t\t}\n\t\t\t\torigin_x += c;\n\t\t\t} else{\n\t\t\t\t//このプログラムの場合は、上下を入れ替えています。\n\t\t\t\t//\t→もし d が 2 なら，上端から c だけ下側を通る水平の折り線の上側を下側に折り重ねる。\n\t\t\t\tint dist = 1; //distは折られる前の座標と、折る先の座標の差の絶対値。\n\t\t\t\tfor(int i=origin_y+c; i<origin_y+(2*c); i++){\t//折られる先のy座標\n\t\t\t\t\tfor(int j=origin_x; j<MAX; j++){\t//水平方向に折るループ\n\t\t\t\t\t\tkami[i][j] += kami[i-dist][j];\n\t\t\t\t\t}\n\t\t\t\t\tdist += 2;\n\t\t\t\t}\n\t\t\t\torigin_y += c;\n\t\t\t}\n\t\t}\n\n\t\tfor(int k=0; k<p; k++){\n\t\t\tint x, y;\n\t\t\tscanf(\" %d %d\", &x, &y);\n\t\t\tprintf(\"%d\\n\", kami[origin_y+y][origin_x+x]);\n\t\t}\n\t}\n\n\treturn 0;\n}\n"
  },
  {
    "language": "Kotlin",
    "code": "fun main(args: Array<String>) {\n    while (true) {\n        val nmtp = readLine()!!.split(' ').map{ it.toInt() }\n        if (nmtp.filter { it != 0 }.isEmpty()) break\n\n        var a = Array(nmtp[1]) { Array(nmtp[0]) { 1 } }\n\n        (0 until nmtp[2]).forEach {\n            val dc = readLine()!!.split(' ').map{ it.toInt() }\n\n            var na = Array(nmtp[1]) { Array(nmtp[0]) { 0 } }\n\n            if (dc[0] == 1) {\n                (0 until dc[1]).forEach { j ->\n                    (0 until nmtp[1]).forEach { k ->\n                        na[k][j] = a[k][dc[1] - j - 1]\n                    }\n                }\n                (0 until (nmtp[0] - dc[1])).forEach { j ->\n                    (0 until nmtp[1]).forEach { k ->\n                        na[k][j] += a[k][dc[1] + j]\n                    }\n                }\n            } else {\n                (0 until dc[1]).forEach { j ->\n                    (0 until nmtp[0]).forEach { k ->\n                        na[j][k] = a[dc[1] - j - 1][k]\n                    }\n                }\n                (0 until (nmtp[1] - dc[1])).forEach { j ->\n                    (0 until nmtp[0]).forEach { k ->\n                        na[j][k] += a[dc[1] + j][k]\n                    }\n                }\n\n            }\n\n            a = na\n        }\n\n        (0 until nmtp[3]).forEach {\n            val xy = readLine()!!.split(' ').map{ it.toInt() }\n\n            println(a[xy[1]][xy[0]])\n        }\n\n    }\n}\n\n"
  },
  {
    "language": "Kotlin",
    "code": "sealed class ImmutableList<out T>{\n    data class Cons<T>(val head:T, val tail: ImmutableList<T>): ImmutableList<T>()\n    object Nil: ImmutableList<Nothing>()\n}\nclass UnionFindTree{\n    private var mParent: UnionFindTree? = null\n    private var mSize = 1\n    val size: Int\n        get() = parent().mSize\n    private fun parent(): UnionFindTree {\n        mParent = mParent?.parent()\n        return mParent ?: this\n    }\n    private fun isSameUnion(that:UnionFindTree): Boolean{\n        return parent() == that.parent()\n    }\n    fun union(that:UnionFindTree): Unit {\n        if (!isSameUnion(that)){\n            that.parent().mSize += this.parent().mSize\n            parent().mParent = that\n        }\n    }\n}\nclass Paper(val width:Int, val height:Int){\n    private val mArray = Array(height){Array(width){ UnionFindTree()}}\n    private var mTop = 0\n    private var mBottom= height - 1\n    private var mLeft = 0\n    private var mRight = width - 1\n    private var mIsVerticalFlipped = false\n    private var mIsHorizontalFlipped = false\n    fun foldHorizontal(cutPos: Int): Unit {\n        val line = if (mIsVerticalFlipped) mBottom - cutPos else mTop + cutPos - 1\n        val size = if (line - mTop + 1 >= mBottom - line) mBottom - line else line - mTop + 1\n        for (dy in 0 until size){\n            for (x in mLeft .. mRight) {\n                mArray[line - dy][x].union(mArray[line + dy + 1][x])\n            }\n        }\n        if (line - mTop + 1 >= mBottom - line){\n            if (!mIsVerticalFlipped) mIsVerticalFlipped = true\n            mBottom = line\n        }else {\n            if (mIsVerticalFlipped) mIsVerticalFlipped = false\n            mTop = line + 1\n        }\n    }\n    fun foldVertical(cutPos: Int): Unit {\n        val line = if (mIsHorizontalFlipped)  mRight - cutPos else mLeft + cutPos - 1\n        val size = if (line - mLeft + 1 >= mRight - line) mRight - line else line - mLeft + 1\n        for (dx in 0 until size){\n            for (y in mTop .. mBottom){\n                mArray[y][line - dx].union(mArray[y][line + dx + 1])\n            }\n        }\n        if (line - mLeft + 1 >= mRight - line){\n            if (!mIsHorizontalFlipped) mIsHorizontalFlipped = true\n            mRight = line\n        }else{\n            if (mIsHorizontalFlipped) mIsHorizontalFlipped = false\n            mLeft = line + 1\n        }\n    }\n    fun holeCount(x: Int, y: Int): Int {\n        val xPos = if (mIsHorizontalFlipped) mRight - x else mLeft + x\n        val yPos = if (mIsVerticalFlipped) mBottom - y else mTop + y\n        return mArray[yPos][xPos].size\n    }\n}\nfun main(args:Array<String>){\n    while (true){\n        val (n, m, t, p) = readLine()!!.trim().split(' ').map(String::toInt)\n        if (n == 0 && m == 0 && t == 0 && p == 0) return\n        val paper = Paper(n, m)\n        repeat(t){\n            val (d, c) = readLine()!!.trim().split(' ').map(String::toInt)\n            when(d){\n                1 -> paper.foldVertical(c)\n                else -> paper.foldHorizontal(c)\n            }\n        }\n        repeat(p){\n            val (x, y) = readLine()!!.trim().split(' ').map(String::toInt)\n            println(paper.holeCount(x, y))\n        }\n    }\n}\n"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Scanner;\n\npublic class Main {\n\tpublic static void main(String args[]) {\n\t\tScanner scan = new Scanner(System.in);\n\n\t\twhile (true) {\n\t\t\tint n = scan.nextInt();\n\t\t\tint m = scan.nextInt();\n\t\t\tint t = scan.nextInt();\n\t\t\tint p = scan.nextInt();\n\n\t\t\tif (n == 0 && m == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tArrayList<ArrayList<Integer>> paper = new ArrayList<ArrayList<Integer>>();\n\t\t\tint hole = 0;\n\n\t\t\tfor (int i = 0; i < m; i++) {\n\t\t\t\tArrayList<Integer> array = new ArrayList<Integer>();\n\t\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\t\tarray.add(1);\n\t\t\t\t}\n\t\t\t\tpaper.add(array);\n\t\t\t}\n\n\t\t\tfor (int pap = paper.size() - 1; pap >= 0; pap--) {\n\t\t\t\tSystem.out.println(paper.get(pap));\n\t\t\t}\n\t\t\tSystem.out.println(\"\");\n\n\t\t\tfor (int i = 0; i < t; i++) {\n\t\t\t\tint d = scan.nextInt();\n\t\t\t\tint c = scan.nextInt();\n\t\t\t\tswitch (d) {\n\t\t\t\tcase 1:\n\t\t\t\t\tfor (int j = 0; j < paper.size(); j++) {\n\t\t\t\t\t\tfor (int k = 0; k < c; k++) {\n\t\t\t\t\t\t\tif (c >= paper.get(j).size()) {\n\t\t\t\t\t\t\t\tpaper.get(j).add(paper.get(j).get(c - k - 1));\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpaper.get(j).set(c, paper.get(j).get(c) + paper.get(j).get(c - k - 1));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpaper.get(j).remove(c - k - 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tfor (int j = 0; j < c; j++) {\n\t\t\t\t\t\tif (c >= paper.size()) {\n\t\t\t\t\t\t\tpaper.add(paper.get(c - j - 1));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfor (int k = 0; k < paper.get(j).size(); k++) {\n\t\t\t\t\t\t\t\tpaper.get(c).set(k, paper.get(c).get(k) + paper.get(c - j - 1).get(k));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpaper.remove(c - j - 1);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t//for (int pap = paper.size() - 1; pap >= 0; pap--) {\n\t\t\t\t//\tSystem.out.println(paper.get(pap));\n\t\t\t\t//}\n\t\t\t\t//System.out.println(\"\");\n\t\t\t}\n\n\t\t\tfor (int i = 0; i < p; i++) {\n\t\t\t\tint x = scan.nextInt();\n\t\t\t\tint y = scan.nextInt();\n\t\t\t\thole = paper.get(y).get(x);\n\t\t\t\tSystem.out.println(hole);\n\t\t\t}\n\t\t\t//System.out.println(\"next\");\n\t\t}\n\t\tscan.close();\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.HashSet;\nimport java.util.PriorityQueue;\nimport java.util.Scanner;\nimport java.util.Set;\n\n\npublic class Main {\n\tScanner sc = new Scanner(System.in);\n\tvoid a() {\n\t\twhile(true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n == 0) return;\n\t\t\tint[] a = new int[n];\n\t\t\tdouble sum = 0.0;\n\t\t\tfor(int i = 0; i < n; i++) {\n\t\t\t\ta[i] = sc.nextInt();\n\t\t\t\tsum += a[i];\n\t\t\t}\n\t\t\tsum /= (double)(n);\n\t\t\tint cnt = 0;\n\t\t\tfor(int i = 0; i < n; i++) {\n\t\t\t\tif(a[i] <= sum) {\n\t\t\t\t\tcnt++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(cnt);\n\t\t}\n\n\t}\n\n\tvoid b() {\n\t\twhile(true) {\n\t\t\tint n = sc.nextInt();\n\t\t\tint m = sc.nextInt();\n\t\t\tint t = sc.nextInt();\n\t\t\tint p = sc.nextInt();\n\t\t\tif(n == 0 && m == 0 && t == 0 && p == 0) return;\n\t\t\tfinal int LEN = 1000;\n\t\t\tint[][] pe = new int[LEN][LEN];\n\t\t\tfor(int i = 0; i < LEN; i++) {\n\t\t\t\tArrays.fill(pe[i], 0);\n\t\t\t}\n\t\t\tfor(int i = 0; i < m; i++) {\n\t\t\t\tfor(int j = 0; j < n; j++) {\n\t\t\t\t\tpe[i][j] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\t/*for(int i = 0; i < m * 2; i++) {\n\t\t\t\tSystem.out.println(Arrays.toString(pe[i]));\n\t\t\t}*/\n\t\t\tint x = 0;\n\t\t\tint y = 0;\n\t\t\tfor(int k = 0; k < t; k++) {\n\t\t\t\tint d = sc.nextInt();\n\t\t\t\tint c = sc.nextInt();\n\t\t\t\t//System.out.println(d);\n\t\t\t\tif(d == 1) {\t\n\t\t\t\t\tfor(int i = x; i < c + x; i++) {\n\t\t\t\t\t\tfor(int j = 0; j < LEN; j++) {\n\t\t\t\t\t\t\tint num = pe[j][i]; \n\t\t\t\t\t\t\tpe[j][i] = 0;\n\t\t\t\t\t\t\t//System.out.println(i + (c - i) * 2 + \" \" + j);\n\t\t\t\t\t\t\tpe[j][i + (c - i + x) * 2 - 1] += num;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tx += c;\n\t\t\t\t\t//System.out.println(x);\n\t\t\t\t}\n\t\t\t\tif(d == 2) {\n\t\t\t\t\tfor(int i = y; i < c + y; i++) {\n\t\t\t\t\t\tfor(int j = 0; j < LEN; j++) {\n\t\t\t\t\t\t\tint num = pe[i][j]; \n\t\t\t\t\t\t\tpe[i][j] = 0;\n\t\t\t\t\t\t\tpe[i + (c - i + y) * 2 - 1][j] += num;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ty += c;\n\t\t\t\t}\n\t\t\t}\n\t\t\t/*\n\t\t\tfor(int i = 0; i < m * 2; i++) {\n\t\t\t\tSystem.out.println(Arrays.toString(pe[i]));\n\t\t\t}\n\t\t\t */\n\n\t\t\tfor(int i = 0; i < p; i++) {\n\t\t\t\tint X = sc.nextInt();\n\t\t\t\tint Y = sc.nextInt();\n\t\t\t\tint ans = pe[y + Y][x + X];\n\t\t\t\t//System.out.println(x + X + \" \" + (y + Y) + \" \" + x + \" \"  + y);\n\t\t\t\tSystem.out.println(ans);\n\t\t\t}\n\t\t}\n\n\t}\n\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().b();\n\t}\n\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.io.PrintWriter;\nimport java.util.Scanner;\n\npublic class Main {\n\n    private static long ans = 0, low = 0;\n\n    public static void main(String[] args) {\n        Scanner in = new Scanner(System.in);\n        PrintWriter out = new PrintWriter(System.out);\n\n        int n = in.nextInt(), m = in.nextInt(), t = in.nextInt(), p = in.nextInt();\n        while (n > 0) {\n            int[][] board = new int[2000][2000];\n            int xmin = 1000, xmax = 1000 + n;\n            int ymin = 1000, ymax = 1000 + m;\n            for (int i = ymin; i < ymax; i++) {\n                for (int j = xmin; j < xmax; j++) {\n                    board[i][j] = 1;\n                }\n            }\n\n            for (int i = 0; i < t; i++) {\n                int d = in.nextInt(), c = in.nextInt();\n                if (d == 1) {\n                    int fold = xmax - c;\n                    for (int j = ymin; j < ymax; j++) {\n                        for (int k = fold; k < xmax; k++) {\n                            board[j][2 * fold - k - 1] += board[j][k];\n                            board[j][k] = 0;\n                            xmin = Math.min(xmin, 2 * fold - k - 1);\n                        }\n                    }\n                    xmax = fold;\n                } else {\n                    int fold = ymax - c;\n                    for (int j = xmin; j < xmax; j++) {\n                        for (int k = fold; k <ymax ; k++) {\n                            board[2 * fold - k - 1][j] += board[k][j];\n                            board[k][j] = 0;\n                            ymin = Math.min(ymin, 2 * fold - k - 1);\n                        }\n                    }\n                    ymax = fold;\n                }\n            }\n\n            for (int i = 0; i < p; i++) {\n                int x = in.nextInt(), y = in.nextInt();\n                out.println(board[ymax - y - 1][xmax - x - 1]);\n            }\n\n            n = in.nextInt();\n            m = in.nextInt();\n            t = in.nextInt();\n            p = in.nextInt();\n        }\n        out.flush();\n    }\n\n}\n\n"
  },
  {
    "language": "Java",
    "code": "\n\nimport java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) {\n\t\tint n, m, t, p, d, c, x, y;\n\t\tScanner s = new Scanner(System.in);\n\n\t\twhile (true) {\n\t\t\tn = s.nextInt();\n\t\t\tm = s.nextInt();\n\t\t\tt = s.nextInt();\n\t\t\tp = s.nextInt();\n\t\t\tint[][] a = new int[m][n];\n\t\t\tint[][] b = new int[m][n];\n\t\t\tfor (int i = 0; i < m; i++) {\n\t\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\t\ta[i][j] = 1;\n\t\t\t\t\tb[i][j] = 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (n == 0 && m == 0 && t == 0 && p == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t//\n\t\t\tfor (int i = 0; i < t; i++) {\n\t\t\t\td = s.nextInt();\n\t\t\t\tc = s.nextInt();\n\n\t\t\t\tfor (int j = 0; j < m; j++) {\n\t\t\t\t\tfor (int k = 0; k < n; k++) {\n\t\t\t\t\t\tb[j][k] = a[j][k];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (d == 1) {\n\t\t\t\t\tif (c * 2 <= n) {\n\t\t\t\t\t\t//\n\t\t\t\t\t\tfor (int j = 0; j < m; j++) {\n\t\t\t\t\t\t\tint w = 0;\n\t\t\t\t\t\t\tfor (int k = 0; k < c; k++) {\n\t\t\t\t\t\t\t\ta[j][k] = b[j][c + w] + b[j][c - 1 - w];\n\t\t\t\t\t\t\t\tw++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (int k = c; k < n - c; k++) {\n\t\t\t\t\t\t\t\ta[j][k] = b[j][c + w];\n\t\t\t\t\t\t\t\tw++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tn -= c;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//\n\t\t\t\t\t\tfor (int j = 0; j < m; j++) {\n\t\t\t\t\t\t\tint w = 0;\n\t\t\t\t\t\t\tfor (int k = 0; k < n - c; k++) {\n\t\t\t\t\t\t\t\ta[j][k] = b[j][c + w] + b[j][c - 1 - w];\n\t\t\t\t\t\t\t\tw++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\tfor (int k = n - c; k < c; k++) {\n\t\t\t\t\t\t\t\ta[j][k] = b[j][c - 1 - w];\n\t\t\t\t\t\t\t\tw++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tn = c;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (d == 2) {\n\t\t\t\t\tif (c * 2 <= m) {\n\t\t\t\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\t\t\t\tint w = 0;\n\t\t\t\t\t\t\tfor (int k = 0; k < c; k++) {\n\t\t\t\t\t\t\t\ta[k][j] = b[c + w][j] + b[c - 1 - w][j];\n\t\t\t\t\t\t\t\tw++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (int k = c; k < m - c; k++) {\n\t\t\t\t\t\t\t\ta[k][j] = b[c + w][j];\n\t\t\t\t\t\t\t\tw++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tm -= c;\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\t\t\t\tint w = 0;\n\t\t\t\t\t\t\tfor (int k = 0; k < m - c; k++) {\n\t\t\t\t\t\t\t\ta[k][j] = b[c + w][j] + b[c - 1 - w][j];\n\t\t\t\t\t\t\t\tw++;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tfor (int k = m - c; k < c; k++) {\n\t\t\t\t\t\t\t\ta[k][j] = b[c - 1 - w][j];\n\t\t\t\t\t\t\t\tw++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tm = c;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int j = 0; j < p; j++) {\n\t\t\t\tx = s.nextInt();\n\t\t\t\ty = s.nextInt();\n\t\t\t\tSystem.out.println(a[y][x]);\n\t\t\t}\n\t\t}\n\t\ts.close();\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Scanner;\n\npublic class Main {\n\tpublic static void main(String args[]) {\n\t\tScanner scan = new Scanner(System.in);\n\n\t\twhile (true) {\n\t\t\tint n = scan.nextInt();\n\t\t\tint m = scan.nextInt();\n\t\t\tint t = scan.nextInt();\n\t\t\tint p = scan.nextInt();\n\n\t\t\tif (n == 0 && m == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tArrayList<ArrayList<Integer>> paper = new ArrayList<ArrayList<Integer>>();\n\t\t\tint hole = 0;\n\n\t\t\tfor (int i = 0; i < m; i++) {\n\t\t\t\tArrayList<Integer> array = new ArrayList<Integer>();\n\t\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\t\tarray.add(1);\n\t\t\t\t}\n\t\t\t\tpaper.add(array);\n\t\t\t}\n\n\t\t\t/*\n\t\t\t * for (int pap = paper.size() - 1; pap >= 0; pap--) {\n\t\t\t * System.out.println(paper.get(pap)); } System.out.println(\"\");\n\t\t\t */\n\n\t\t\tfor (int i = 0; i < t; i++) {\n\t\t\t\tint d = scan.nextInt();\n\t\t\t\tint c = scan.nextInt();\n\t\t\t\tswitch (d) {\n\t\t\t\tcase 1:\n\t\t\t\t\tfor (int j = 0; j < paper.size(); j++) {\n\t\t\t\t\t\tfor (int k = 0; k < c; k++) {\n\t\t\t\t\t\t\tif (c >= paper.get(j).size()) {\n\t\t\t\t\t\t\t\tpaper.get(j).add(paper.get(j).get(c - k - 1));\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpaper.get(j).set(c, paper.get(j).get(c) + paper.get(j).get(c - k - 1));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpaper.get(j).remove(c - k - 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tfor (int j = 0; j < c; j++) {\n\t\t\t\t\t\tif (c + j >= paper.size()) {\n\t\t\t\t\t\t\tpaper.add(paper.get(c - j - 1));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfor (int k = 0; k < paper.get(j).size(); k++) {\n\t\t\t\t\t\t\t\tpaper.get(c).set(k, paper.get(c).get(k) + paper.get(c - j - 1).get(k));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpaper.remove(c - j - 1);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t/*\n\t\t\t\t * for (int pap = paper.size() - 1; pap >= 0; pap--) {\n\t\t\t\t * System.out.println(paper.get(pap)); } System.out.println(\"\");\n\t\t\t\t */\n\t\t\t}\n\n\t\t\tfor (int i = 0; i < p; i++) {\n\t\t\t\tint x = scan.nextInt();\n\t\t\t\tint y = scan.nextInt();\n\t\t\t\thole = paper.get(y).get(x);\n\t\t\t\tSystem.out.println(hole);\n\t\t\t}\n\t\t\t// System.out.println(\"next\");\n\t\t}\n\t\tscan.close();\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.*;\npublic class Main {\n\n\tpublic static void main(String[] args) {\n\t\tScanner in=new Scanner(System.in);\n\n\t\twhile(true) {\n\t\t\tint W=in.nextInt(),H=in.nextInt(),n=in.nextInt(),m=in.nextInt();\n\t\t\tif(m==0)break;\n\t\t\tList<List<Integer>> kami=new ArrayList<>();\n\n\t\t\tfor(int i=0;i<H;i++) {\n\t\t\t\tList<Integer> ls=new ArrayList<>();\n\t\t\t\tfor(int j=0;j<W;j++) {\n\t\t\t\t\tls.add(1);\n\t\t\t\t}\n\t\t\t\tkami.add(ls);\n\t\t\t}\n\n\t\t\tfor(int i=0;i<n;i++) {\n\t\t\t\tint d=in.nextInt(),c=in.nextInt();\n\n\t\t\t\tif(d==1) {\n\t\t\t\t\tif(c*2>kami.get(0).size()) {\n//\t\t\t\t\t\tSystem.out.println(\"escape Overflow X\");\n\t\t\t\t\t\tc=kami.get(0).size()-c;\n\t\t\t\t\t\tfor(int p=0;p<kami.size();p++) {\n\t\t\t\t\t\t\tCollections.reverse(kami.get(p));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\n\t\t\t\t\tfor(int p=0;p<kami.size();p++) {\n\t\t\t\t\t\tfor(int q=0;q<c;q++) {\n\t\t\t\t\t\t\tint a=kami.get(p).get(c+q),b=kami.get(p).get(c-1-q);\n\t\t\t\t\t\t\tkami.get(p).set(c+q, a+b);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfor(int q=0;q<c;q++)kami.get(p).remove(0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif(c*2>kami.size()) {\n//\t\t\t\t\t\tSystem.out.println(\"escape Overflow Y\");\n\t\t\t\t\t\tc=kami.size()-c;\n\t\t\t\t\t\tCollections.reverse(kami);\n\t\t\t\t\t}\n\n\t\t\t\t\tfor(int p=0;p<c;p++) {\n\t\t\t\t\t\tfor(int q=0;q<kami.get(0).size();q++) {\n\t\t\t\t\t\t\tint a=kami.get(kami.size()-1-c-p).get(q),\n\t\t\t\t\t\t\t\t\tb=kami.get(kami.size()-c+p).get(q);\n\t\t\t\t\t\t\tkami.get(kami.size()-1-c-p).set(q, a+b);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfor(int p=0;p<c;p++)kami.remove(kami.size()-1);\n\t\t\t\t}\n\t\t\t\t/*System.out.println();\n\t\t\t\tfor(int k=0;k<kami.size();k++) {\n\t\t\t\t\tfor(int l=0;l<kami.get(k).size();l++) {\n\t\t\t\t\t\tSystem.out.print(kami.get(k).get(l)+\" \");\n\t\t\t\t\t}\n\t\t\t\t\tSystem.out.println();\n\t\t\t\t}*/\n\t\t\t}\n\n\t\t\tfor(int i=0;i<m;i++) {\n\t\t\t\tint x=in.nextInt(),y=in.nextInt();\n\t\t\t\tSystem.out.println(kami.get(kami.size()-1-y).get(x));\n\t\t\t}\n\t\t\t/*System.out.println();\n\t\t\tfor(int i=0;i<kami.size();i++) {\n\t\t\t\tfor(int j=0;j<kami.get(i).size();j++) {\n\t\t\t\t\tSystem.out.print(kami.get(i).get(j)+\" \");\n\t\t\t\t}\n\t\t\t\tSystem.out.println();\n\t\t\t}*/\n\t\t}\n\t\t/*System.out.println();\n\t\tfor(int i=0;i<kami.size();i++) {\n\t\t\tfor(int j=0;j<kami.get(i).size();j++) {\n\t\t\t\tSystem.out.print(kami.get(i).get(j)+\" \");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}*/\n\t}\n\n}\n\n"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) {\n\t\tMain m = new Main();\n\t\tm.run();\n\t}\n\n\tScanner sc = new Scanner(System.in);\n\n\tvoid run() {\n\t\tfor(;;){\n\t\t\tint n = sc.nextInt();\n\t\t\tint m = sc.nextInt();\n\t\t\tint t = sc.nextInt();\n\t\t\tint p = sc.nextInt();\n\t\t\t\n\t\t\tif((n|m|t|p) == 0){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tint d[] = new int[t];\n\t\t\tint c[] = new int[t];\n\t\t\tfor(int i =0 ; i < t; i++){\n\t\t\t\td[i] = sc.nextInt();\n\t\t\t\tc[i] = sc.nextInt();\n\t\t\t}\n\t\t\t\n\t\t\tint x[] = new int[p];\n\t\t\tint y[] = new int[p];\n\t\t\tfor(int i = 0; i < p; i++){\n\t\t\t\tx[i] = sc.nextInt();\n\t\t\t\ty[i] = sc.nextInt();\n\t\t\t}\n\t\t\t\n\t\t\tint left = 0;\n\t\t\tint buttom = 0;\n\t\t\t\n\t\t\tint[] depth1 = new int[n*100];\n\t\t\tint[] depth2 = new int[m*100];\n\t\t\tfor(int i = 0; i< n;i++){\n\t\t\t\tdepth1[i] = 1;\n\t\t\t}\n\t\t\tfor(int i = 0; i< m;i++){\n\t\t\t\tdepth2[i] = 1;\n\t\t\t}\n\t\t\t\n\t\t\tfor(int i = 0 ; i < t; i++){\n\t\t\t\tif(d[i] == 1){\n\t\t\t\t\tleft += c[i];\n//\t\t\t\t\tSystem.out.println(\"-----\"+c[i]+\" \"+d[i]);\n\t\t\t\t\tfor(int j = 0 ; j < c[i];j++){\n//\t\t\t\t\t\tSystem.out.println((left-j-1)+\" \"+(left+j));\n\t\t\t\t\t\tdepth1[left+j] += depth1[left - j - 1];\n\t\t\t\t\t\tdepth1[left - j - 1] = 0;\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tbuttom += c[i];\n\t\t\t\t\tfor(int j = 0 ; j < c[i];j++){\n\t\t\t\t\t\tdepth2[buttom+j] += depth2[buttom - j - 1];\n\t\t\t\t\t\tdepth2[buttom - j - 1] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n//\t\t\tSystem.out.println(Arrays.toString(depth1));\n//\t\t\tSystem.out.println(Arrays.toString(depth2));\n\t\t\tfor(int i = 0 ; i < p ;i++){\n\t\t\t\tint xx = x[i]+left;\n\t\t\t\tint yy = y[i]+buttom;\n\t\t\t\t\n\t\t\t\tSystem.out.println(depth1[xx] * depth2[yy]);\n\t\t\t}\n\t\t}\n\t\t\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n    Scanner sc = new Scanner(System.in);\n\n    public static void main(String[] arg){\n        Main m = new Main();\n        m.run();\n    }\n\n    void run(){\n\n        for(;;){\n            int n =sc.nextInt();\n            int m =sc.nextInt();\n            int t =sc.nextInt();\n            int p =sc.nextInt();\n\n            if((n | m | t | p) ==0){\n                break;\n            }\n\n            int map[][] = new int[n][m];\n\n            for(int i =0; i < n;i++){\n                Arrays.fill(map[i],1);\n            }\n\n            for(int i = 0; i < t; i++){\n                int next[][] = new int[n][m];\n\n                int d = sc.nextInt();\n                int c = sc.nextInt();\n\n                for(int j = 0; j < n; j++){\n                    for(int k = 0 ;k<m ; k++){\n\n                        int jj = j ;\n                        int kk = k;\n                        if(d == 1){\n                            jj = jj -c;\n                            if(jj < 0){\n                                jj = -jj-1 ;\n                            }\n                        }\n                        if(d == 2){\n                            kk = kk - c;\n                            if(kk < 0){\n                                kk = - kk -1;\n                            }\n                        }\n\n                        next[jj][kk] += map[j][k];\n                    }\n                }\n\n//                debug(next);\n\n                map = next;\n            }\n\n            for(int i = 0;i < p;i++){\n                int x = sc.nextInt();\n                int y = sc.nextInt();\n\n                System.out.println(map[x][y]);\n            }\n        }\n    }\n\n    void debug(int[][] a){\n        System.out.println();\n        for(int i =0 ;i < a.length ; i++){\n            for(int j = 0 ;j < a[i].length; j++){\n                System.out.print(\"\\t\"+a[i][j]);\n            }\n            System.out.println();\n        }\n    }\n}\n\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\npublic class Main{\n\n\tpublic static void main(String[] args) {\n\n\t\tScanner sc = new Scanner(System.in);\n\n\t\tint N = sc.nextInt();//よこ\n\n\t\tint M = sc.nextInt();//たて\n\n\t\tint T = sc.nextInt();//折返し回数\n\n\t\tint P = sc.nextInt();//穴\n\n\t\twhile(true) {\n\n\t\t\tif(N==0&&M==0&&P==0&&T==0) break;\n\n\t\t\t//折り紙の配列a[よこ][たて]\n\t\t\tint[][] a = new int[N*T*2][M*T*2];\n\n\t\t\t//初期化\n\t\t\t//折り紙部分は1,その他0\n\t\t\tfor(int i=0;i<N*T*2;i++) {\n\n\t\t\t\tfor(int j=0;j<M*T*2;j++) {\n\n\t\t\t\t\tif(i<N && j<M) a[i][j] = 1;\n\n\t\t\t\t\telse a[i][j] = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tint[][] t = new int[T][2];\n\n\t\t\tfor(int i=0;i<T;i++) {\n\n\t\t\t\tfor(int j=0;j<2;j++) {\n\n\t\t\t\t\tt[i][j] = sc.nextInt();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tint[][] p = new int[P][2];\n\n\t\t\tfor(int i=0;i<P;i++) {\n\n\t\t\t\tfor(int j=0;j<2;j++) {\n\n\t\t\t\t\tp[i][j] = sc.nextInt();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//↑ここまでで格納、初期化終了\n\n\t\t\t//(0,0)を左上にして考える\n\t\t\tint top = 0;\t//折り紙の一番上\n\n\t\t\tint left = 0;//折り紙の一番左\n\n\t\t\tint count = 0;\n\n\t\t\t//折る\n\t\t\twhile(count<T) {\n\n\t\t\t\tint c = t[count][1];\n\n\t\t\t\tif(t[count][0] == 1) {\t//左から\n\n\t\t\t\t\t//まず上からt[count][1]分だけ0にする\n\t\t\t\t\t//次にtop+t[count][1]からt[count][1]分だけ++\n\t\t\t\t\t//top更新\n\n\n\t\t\t\t\tfor(int j=0;j<M*T*2;j++) {\n\n\t\t\t\t\t\tint xx = 0;\n\n\t\t\t\t\t\tfor(int i=left+c;i<left+c+c;i++) {\n\n\t\t\t\t\t\t\ta[left+c+c-xx-1][j] += a[left+xx][j];\n\n\t\t\t\t\t\t\txx++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfor(int i=left;i<left+c;i++) {\n\n\t\t\t\t\t\tfor(int j=0;j<M*T*2;j++) {\n\n\t\t\t\t\t\t\ta[i][j] = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\n\t\t\t\t\tleft += c;\n\n\t\t\t\t}else if(t[count][0] == 2) {\t//上から(下から）\n\n\t\t\t\t\tfor(int i=0;i<N*T*2;i++) {\n\n\t\t\t\t\t\tint xx = 0;\n\n\t\t\t\t\t\tfor(int j=top;j<top+c;j++) {\n\n\t\t\t\t\t\t\ta[i][top+c+c-xx-1] += a[i][top+xx];\n\n\t\t\t\t\t\t\txx++;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor(int i=0;i<N*T*2;i++) {\n\n\t\t\t\t\t\tfor(int j=top;j<top+c;j++) {\n\n\t\t\t\t\t\t\ta[i][j] = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\ttop += c;\n\n\t\t\t\t}\n\n\t\t\t\tcount++;\n\t\t\t}\n\n\t\t\t//穴をあける\n\t\t\tcount = 0;\n\n\t\t\tint ans = 0;\n\n\t\t\twhile(count<P) {\n\n\t\t\t\tint x = p[count][0];\n\n\t\t\t\tint y = p[count][1];\n\n\t\t\t\tans = a[left+x][top+y];\n\n\t\t\t\tSystem.out.println(ans);\n\n\t\t\t\tcount++;\n\t\t\t}\n\n\t\t\t//System.out.println(\"ANS\"+ans+\" N\"+N);\n\n\t\t\tN = sc.nextInt();\n\n\t\t\tM =sc.nextInt();\n\n\t\t\tT = sc.nextInt();\n\n\t\t\tP = sc.nextInt();\n\t\t}\n\t}\n\n}\n\n"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.Scanner;\n\npublic class Main {\n\tpublic static int l = 5;\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint n, m, t, p;\n\t\tint dir,col;\n\t\tint[][] times;\n\t\tl=32;\n\t\twhile (true) {\n\t\t\tn = sc.nextInt();\n\t\t\tif (n == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tm = sc.nextInt();\n\t\t\tt = sc.nextInt();\n\t\t\tp = sc.nextInt();\n\t\t\t\n\t\t\t// times initialize\n\t\t\ttimes = new int[l][l];\n\t\t\tfor(int i = 0; i < n; i++) {\n\t\t\t\tfor(int j = 0; j < m; j++) {\n\t\t\t\t\ttimes[i][j] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t//turn\n\t\t\tfor(int i = 0; i < t; i++) {\n\t\t\t\tdir = sc.nextInt();\n\t\t\t\tcol = sc.nextInt();\n\t\t\t\ttimes = turn(times,dir,col);\n\t\t\t}\n\t\t\t\n\t\t\t//system out\n\t\t\tfor(int i=0;i<p;i++) {\n\t\t\t\tSystem.out.println(times[sc.nextInt()][sc.nextInt()]);\t\t\n\t\t\t}\n\t\t}\n\t\tsc.close();\n\t}\n\n\tpublic static int[][] turn(int[][] times, int dir, int col) {\n\t\tint[][] temp = new int[l][l];\n\t\tif(dir == 1) {\n\t\t\tint jmax = 0;\n\t\t\tfor(int j = 0; j < l; j++) {\n\t\t\t\tif(times[0][j] > 0) {\n\t\t\t\t\tjmax++;\n\t\t\t\t}else {break;}\n\t\t\t}\n\t\t\tfor(int i=0; i<l-col;i++) {\n\t\t\t\tfor(int j=0; j<jmax; j++) {\n\t\t\t\t\ttemp[i][j] = times[i+col][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=0;i<col;i++) {\n\t\t\t\tfor(int j=0; j<jmax; j++) {\n\t\t\t\t\ttemp[i][j] += times[col-1-i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}else {\n\t\t\tint imax = 0;\n\t\t\tfor(int i = 0; i < l; i++) {\n\t\t\t\tif(times[i][0] > 0) {\n\t\t\t\t\timax++;\n\t\t\t\t}else {break;}\n\t\t\t}\n\t\t\tfor(int j=0;j<l-col;j++) {\n\t\t\t\tfor(int i=0;i<imax;i++) {\n\t\t\t\t\ttemp[i][j] = times[i][j+col];\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int j=0;j<col;j++) {\n\t\t\t\tfor(int i=0;i<imax;i++) {\n\t\t\t\t\ttemp[i][j] += times[i][col-1-j];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\t\treturn temp;\n\t}\n\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main{\n\tstatic int h,w;\n\tpublic static void main(String[] args) {\n\t\ttry(Scanner sc = new Scanner(System.in)) {\n\t\t\twhile(sc.hasNext()) {\n\t\t\t\tint n= sc.nextInt();\n\t\t\t\tint m = sc.nextInt();\n\t\t\t\tint t = sc.nextInt();\n\t\t\t\tint p = sc.nextInt();\n\t\t\t\tif(n+m+t+p==0)break;\n\t\t\t\th = m;\n\t\t\t\tw = n;\n\t\t\t\tint[][] paper = new int[m+1][n+1];\n\t\t\t\tfor(int i=0;i<m;i++)\n\t\t\t\t\tfor(int k =0;k<n;k++)\n\t\t\t\t\t\tpaper[i][k] = 1;\n\n\t\t\t\twhile(t--!=0) {\n\t\t\t\t\tint d = sc.nextInt();\n\t\t\t\t\tint c = sc.nextInt();\n\t\t\t\t\tif(d==2) {\n\t\t\t\t\t\tint k=h-1+h-1-c-c+1;\n\t\t\t\t\t\tif(h>=2*c) {\n\t\t\t\t\t\t\tfor(int i=h-c-1;i>=h-c-c;i--) {\n\t\t\t\t\t\t\t\tfor(int j=0;j<w;j++) {\n\t\t\t\t\t\t\t\t\t//  System.out.println(i+\" \"+j);\n\t\t\t\t\t\t\t\t\tpaper[i][j] += paper[k-i][j];\n\t\t\t\t\t\t\t\t\t//System.out.println(\"paper[\"+i+\"][\"+j+\"]=\"+paper[i][j]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\th-=c;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tfor(int i=h-c-1; i>=0; i--) {\n\t\t\t\t\t\t\t\tfor(int j=0; j<w; j++) {\n\t\t\t\t\t\t\t\t\tpaper[k-i][j]+=paper[i][j];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tint[][] copy=new int [h][w];\n\t\t\t\t\t\t\tfor(int i=h-c; i<h; i++) {\n\t\t\t\t\t\t\t\tfor(int j=0; j<w; j++) {\n\t\t\t\t\t\t\t\t\tcopy[i][j]=paper[i][j];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor(int i=0; i<c; i++) {\n\t\t\t\t\t\t\t\tfor(int j=0; j<w; j++) {\n\t\t\t\t\t\t\t\t\tpaper[i][j]=copy[h-i-1][j];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\th=c;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//System.out.println(\"h=\"+h);\n\t\t\t\t\t}\n\t\t\t\t\telse if(d==1) {\n\t\t\t\t\t\tint l=w-1+w-1-c-c+1;\n\t\t\t\t\t\tif(w>=2*c) {\n\t\t\t\t\t\t\tfor(int i=0;i<h;i++) {\n\t\t\t\t\t\t\t\tfor(int j=w-c-1; j>=w-c-c; j--) {\n\t\t\t\t\t\t\t\t\tpaper[i][j] += paper[i][l-j];\n\t\t\t\t\t\t\t\t\t//System.out.println(\"paper[\"+i+\"][\"+j+\"]=\"+paper[i][j]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tw-=c;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tfor(int i=0; i<h; i++) {\n\t\t\t\t\t\t\t\tfor(int j=w-c-1; j>=0; j--) {\n\t\t\t\t\t\t\t\t\tpaper[i][l-j]+=paper[i][j];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tint[][] copy=new int [h][w];\n\t\t\t\t\t\t\tfor(int i=0; i<h; i++) {\n\t\t\t\t\t\t\t\tfor(int j=w-c; j<w; j++) {\n\t\t\t\t\t\t\t\t\tcopy[i][j]=paper[i][j];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor(int i=0; i<h; i++) {\n\t\t\t\t\t\t\t\tfor(int j=0; j<c; j++) {\n\t\t\t\t\t\t\t\t\tpaper[i][j]=copy[i][w-j-1];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tw=c;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//System.out.println(\"w=\"+w);\n\t\t\t\t\t}\n\t\t\t\t}\n//\t\t\t\tfor(int i=0; i<h; i++) {\n//\t\t\t\t\tfor(int j=0; j<w; j++) {\n//\t\t\t\t\t\tSystem.out.println(\"paper[\"+i+\"][\"+j+\"]=\"+paper[i][j]);\n//\t\t\t\t\t}\n//\t\t\t\t}\n\n\t\t\t\twhile(p--!=0) {\n\t\t\t\t\tint x = sc.nextInt();\n\t\t\t\t\tint y = sc.nextInt();\n\t\t\t\t\t//System.out.println(h+\" \"+w);\n\t\t\t\t\tSystem.out.println(paper[h-1-y][w-1-x]);\n\t\t\t\t}\n\t\t\t}\n\n\n\n\n\t\t}\n\t}\n}\n"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\n    private static Scanner sc = new Scanner(System.in);\n\n    public static void main(String[] args) {\n        long start = System.nanoTime();\n        while (true) {\n            int n = sc.nextInt();\n            int m = sc.nextInt();\n            int t = sc.nextInt();\n            int p = sc.nextInt();\n            if (n == 0 && m == 0 && t == 0 && p == 0)\n                break;\n\n            int[][] paper = initializeArray(n, m);\n\n            for (int i=0; i < t; i++) {\n                int d = sc.nextInt();\n                int c = sc.nextInt();\n                int[][] newPaper;\n                if (d == 1) {\n                    int newWidth = paper.length > 2 * c ? paper.length - c : c;\n                    newPaper = new int[newWidth][paper[0].length];\n\n                    for (int w=c; w < paper.length; w++) {\n                        for (int h=0; h < paper[0].length; h++) {\n                            newPaper[w - c][h] = paper[w][h];\n                        }\n                    }\n\n                    for (int w=0; w < c; w++) {\n                        for (int h=0; h < paper[0].length; h++) {\n                            newPaper[c - w - 1][h] += paper[w][h];\n                        }\n                    }\n                } else {\n                    int newHeight = paper[0].length > 2 * c ? paper[0].length - c : c;\n                    newPaper = new int[paper.length][newHeight];\n\n                    for (int w=0; w < paper.length; w++) {\n                        for (int h=c; h < paper[0].length; h++) {\n                            newPaper[w][h - c] = paper[w][h];\n                        }\n                    }\n\n                    for (int w=0; w < paper.length; w++) {\n                        for (int h=0; h < c; h++) {\n                            newPaper[w][c - h - 1] += paper[w][h];\n                        }\n                    }\n                }\n\n                paper = newPaper;\n                // System.out.println(Arrays.deepToString(paper));\n            }\n\n            for (int i=0; i < p; i++) {\n                int x = sc.nextInt();\n                int y = sc.nextInt();\n\n                System.out.println(paper[x][y]);\n            }\n        }\n\n        long time = System.nanoTime() - start;\n        // System.out.printf(\"Took %s ms.\\n\", time/1_000_000d);\n    }\n\n    private static int[][] initializeArray(int n, int m) {\n        int[][] ret = new int[n][m];\n        for (int i=0; i < n; i++) {\n            for (int j=0; j < m; j++)\n                ret[i][j] = 1;\n        }\n        return ret;\n    }\n\n\n}\n"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Scanner;\n\npublic class Main {\n\tpublic static void main(String args[]) {\n\t\tScanner scan = new Scanner(System.in);\n\n\t\twhile (true) {\n\t\t\tint n = scan.nextInt();\n\t\t\tint m = scan.nextInt();\n\t\t\tint t = scan.nextInt();\n\t\t\tint p = scan.nextInt();\n\n\t\t\tif (n == 0 && m == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tArrayList<ArrayList<Integer>> paper = new ArrayList<ArrayList<Integer>>();\n\t\t\tint hole = 0;\n\n\t\t\tfor (int i = 0; i < m; i++) {\n\t\t\t\tArrayList<Integer> array = new ArrayList<Integer>();\n\t\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\t\tarray.add(1);\n\t\t\t\t}\n\t\t\t\tpaper.add(array);\n\t\t\t}\n\n\t\t\t//for (int pap = paper.size() - 1; pap >= 0; pap--) {\n\t\t\t//\tSystem.out.println(paper.get(pap));\n\t\t\t//}\n\t\t\t//System.out.println(\"\");\n\n\t\t\tfor (int i = 0; i < t; i++) {\n\t\t\t\tint d = scan.nextInt();\n\t\t\t\tint c = scan.nextInt();\n\t\t\t\tswitch (d) {\n\t\t\t\tcase 1:\n\t\t\t\t\tfor (int j = 0; j < paper.size(); j++) {\n\t\t\t\t\t\tfor (int k = 0; k < c; k++) {\n\t\t\t\t\t\t\tif (c >= paper.get(j).size()) {\n\t\t\t\t\t\t\t\tpaper.get(j).add(paper.get(j).get(c - k - 1));\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpaper.get(j).set(c, paper.get(j).get(c) + paper.get(j).get(c - k - 1));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpaper.get(j).remove(c - k - 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tfor (int j = 0; j < c; j++) {\n\t\t\t\t\t\tif (c >= paper.size()) {\n\t\t\t\t\t\t\tpaper.add(paper.get(c - j - 1));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfor (int k = 0; k < paper.get(j).size(); k++) {\n\t\t\t\t\t\t\t\tpaper.get(c).set(k, paper.get(c).get(k) + paper.get(c - j - 1).get(k));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpaper.remove(c - j - 1);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t//for (int pap = paper.size() - 1; pap >= 0; pap--) {\n\t\t\t\t//\tSystem.out.println(paper.get(pap));\n\t\t\t\t//}\n\t\t\t\t//System.out.println(\"\");\n\t\t\t}\n\n\t\t\tfor (int i = 0; i < p; i++) {\n\t\t\t\tint x = scan.nextInt();\n\t\t\t\tint y = scan.nextInt();\n\t\t\t\thole = paper.get(y).get(x);\n\t\t\t\tSystem.out.println(hole);\n\t\t\t}\n\t\t\t//System.out.println(\"next\");\n\t\t}\n\t\tscan.close();\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.Scanner;\n\npublic class Main \n{\n\tstatic int[][] grid;\n\tstatic int x0, y0, n, m, maxx, maxy;\n\tstatic boolean debug = false;\n\t\n\tstatic void printout()\n\t{\n\t\tSystem.out.println(\"PRINTOUT: \" + maxx + \" \" + maxy);\n\t\tfor(int y = maxy-1; y >= y0; y--)\n\t\t{\n\t\t\tfor(int x = x0; x < maxx; x++)\n\t\t\t{\n\t\t\t\tSystem.out.print(grid[x][y]);\n\t\t\t}\n\t\t\tSystem.out.print(\"\\n\");\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) \n\t{\n\t\tScanner sc = new Scanner(System.in);\n\t\t\n\t\twhile(true)\n\t\t{\n\t\t\tn = sc.nextInt();\n\t\t\tif(n == 0)break;\n\t\t\tm = sc.nextInt();\n\t\t\tint foldings = sc.nextInt();\n\t\t\tint punchings = sc.nextInt();\n\t\t\tint r = 0;\n\t\t\t\n\t\t\tgrid = new int[n*20][m*20];\n\t\t\tx0 = 0;\n\t\t\ty0 = 0;\n\t\t\tmaxx = n;\n\t\t\tmaxy = m;\n\t\t\t\n\t\t\tfor(int x = 0; x < n; x++)\n\t\t\t{\n\t\t\t\tfor(int y = 0; y < m; y++)\n\t\t\t\t{\n\t\t\t\t\tgrid[x][y] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfor(int i = 0; i < foldings; i++)\n\t\t\t{\n\t\t\t\tif(debug)System.out.println(\"Fold \" + i);\n\t\t\t\tint foldtype = sc.nextInt();\n\t\t\t\tint foldpos = sc.nextInt();\n\t\t\t\t\n\t\t\t\tif(foldtype == 1) //vertical\n\t\t\t\t{\n\t\t\t\t\tint foldx = foldpos + x0;\n\t\t\t\t\tint width = foldx - x0;\n\t\t\t\t\t//width -> panjang yang termasuk\n\t\t\t\t\t//x0, y0 masih termasuk\n\t\t\t\t\t//x0 ~ foldx -> foldx ~ foldx + width\n\t\t\t\t\t\n\t\t\t\t\tfor(int x = x0; x < foldx; x++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint dist = foldx - x - 1;\n\t\t\t\t\t\tint x2 = foldx + dist;\n\t\t\t\t\t\tmaxx = Math.max(maxx, x2+1);\n\t\t\t\t\t\tfor(int y = y0; y < maxy; y++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgrid[x2][y] += grid[x][y];\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t//System.out.println(x + \" \" + y + \" -> \" + x2 + \" \" + y );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tx0 = foldx;\n\t\t\t\t}\n\t\t\t\telse if(foldtype == 2) //horixontal\n\t\t\t\t{\n\t\t\t\t\tint foldy = foldpos + y0;\n\t\t\t\t\tint height = foldy - y0;\n\t\t\t\t\t//width -> panjang yang termasuk\n\t\t\t\t\t//x0, y0 masih termasuk\n\t\t\t\t\t//x0 ~ foldx -> foldx ~ foldx + width\n\t\t\t\t\t\n\t\t\t\t\tfor(int y = y0; y < foldy; y++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint dist = foldy - y - 1;\n\t\t\t\t\t\tint y2 = foldy + dist;\n\t\t\t\t\t\tmaxy = Math.max(maxy, y2+1);\n\t\t\t\t\t\tfor(int x = x0; x < maxx; x++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgrid[x][y2] += grid[x][y];\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t//System.out.println(x + \" \" + y + \" -> \" + x + \" \" + y2 );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\ty0 = foldy;\n\t\t\t\t}\n\t\t\t\tif(debug)printout();\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif(debug)System.out.println(\"Punch:\");\n\t\t\tfor(int i = 0; i < punchings; i++)\n\t\t\t{\n\t\t\t\tint x = sc.nextInt();\n\t\t\t\tint y = sc.nextInt();\n\t\t\t\tSystem.out.println(grid[x+x0][y+y0]);\n\t\t\t}\n\t\t}\n\t}\n\n}\n\n"
  },
  {
    "language": "JavaScript",
    "code": "class Matrix {\n    constructor(w, h, init) {\n        this.d = new Array(w);\n        for (let i = 0; i < w; ++i) {\n            this.d[i] = new Array(h).fill(init);\n        }\n    }\n\n    get width() {\n        return this.d.length;\n    }\n\n    get height() {\n        if (this.d.length === 0) {\n            return 0;\n        }\n        return this.d[0].length;\n    }\n\n    submatrix(x1, x2, y1, y2) {\n        const rvalue = new Matrix(x2 - x1, 0, 0);\n        for (let i = 0; i < rvalue.width; ++i) {\n            rvalue.d[i] = this.d[x1 + i].slice(y1, y2);\n        }\n        return rvalue;\n    }\n\n    flip_h() {\n        for (let i = 0, j = this.width - 1; i < j; ++i, --j) {\n            [this.d[i], this.d[j]] = [this.d[j], this.d[i]];\n        }\n        return this;\n    }\n\n    flip_v() {\n        for (let i = 0, j = this.height - 1; i < j; ++i, --j) {\n            for (let k = 0; k < this.width; ++k) {\n                [this.d[k][i], this.d[k][j]] = [this.d[k][j], this.d[k][i]];\n            }\n        }\n        return this;\n    }\n\n    add(m) {\n        const rvalue = new Matrix(Math.max(this.width, m.width), Math.max(this.height, m.height), 0);\n        for (let i = 0; i < rvalue.width; ++i) {\n            for (let j = 0; j < rvalue.height; ++j) {\n                if (i < this.width && j < this.height) {\n                    rvalue.d[i][j] += this.d[i][j];\n                }\n                if (i < m.width && j < m.height) {\n                    rvalue.d[i][j] += m.d[i][j];\n                }\n            }\n        }\n        return rvalue;\n    }\n}\n\nnew Promise(function(resolve, reject) {\n    let cin = \"\";\n    process.stdin\n        .on(\"data\", chunk => { cin += chunk; })\n        .on(\"end\", () => { resolve([cin, process.stdout]) });\n}).then(function([cin, cout]) {\n    const sc = cin.split(/[ \\n]/).map(elt => parseInt(elt))[Symbol.iterator]();\n    for (;;) {\n        let n = sc.next().value;\n        let m = sc.next().value;\n        const t = sc.next().value;\n        const p = sc.next().value;\n        if (n === 0 && m === 0 && t === 0 && p === 0) break;\n        let a = new Matrix(n, m, 1);\n        for (let i = 0; i < t; ++i) {\n            const d = sc.next().value;\n            const c = sc.next().value;\n            if (d === 1) {\n                a = a.submatrix(0, c, 0, a.height).flip_h().add(a.submatrix(c, a.width, 0, a.height));\n            } else {\n                a = a.submatrix(0, a.width, 0, c).flip_v().add(a.submatrix(0, a.width, c, a.height));\n            }\n        }\n        for (let i = 0; i < p; ++i) {\n            const x = sc.next().value;\n            const y = sc.next().value;\n            cout.write(`${a.d[x][y]}\\n`);\n        }\n    }\n});\n\n"
  },
  {
    "language": "Ruby",
    "code": "while 1\n    n, m, t, p = gets.split.map(&:to_i)\n    a = (1..m).map{(1..n).map {1}}\n    break if n == 0\n    t.times do\n        d, c = gets.split.map(&:to_i)\n        if d == 1\n            n = [c, n - c].max\n            a.map! do |row|\n                left = row[0..c-1].reverse\n                right = row[c..-1]\n                (0..n-1).map {|i| (left[i] || 0) + (right[i] || 0)}\n            end\n        else\n            m = [c, m - c].max\n            lower = a[0..c-1].reverse\n            upper = a[c..-1]\n            a = (0..m-1).map {|i|\n                (upper[i] || Array.new(n, 0)).zip(lower[i] || Array.new(n, 0)).map {|r| r.inject(:+)}\n            }\n        end\n    end\n    p.times do\n        x, y = gets.split.map(&:to_i)\n        p a[y][x]\n    end\nend\n\n"
  },
  {
    "language": "Ruby",
    "code": "while true\n    n, m, t, p = gets.chomp.split.map(&:to_i)\n    break if [n, m, t, p] == [0, 0, 0, 0]\n\n    map = Array.new(m){Array.new(n, 1)}\n    t.times{\n        map2 = []\n        map.each{|m| map2 << m.dup}\n\n        d, i = gets.chomp.split.map(&:to_i)\n        case d\n        when 1\n            map = Array.new(m){Array.new([i, n - i].max, 0)}\n            x2 = 0\n            i.upto(n-1){|x|\n                0.upto(m-1){|y| map[y][x2] += map2[y][x]}\n                x2 += 1\n            }\n            x2 = 0\n            (i-1).downto(0){|x|\n                0.upto(m-1){|y| map[y][x2] += map2[y][x]}\n                x2 += 1\n            }\n            n = [i, n - i].max\n        when 2\n            map = Array.new([m-i, i].max){Array.new(n, 0)}\n            y2 = [m-i, i].max - 1\n            (m-i-1).downto(0){|y|\n                0.upto(n-1){|x| map[y2][x] += map2[y][x]}\n                y2 -= 1\n            }\n            y2 = [m-i, i].max - 1\n            (m-i).upto(m-1){|y|\n                0.upto(n-1){|x| map[y2][x] += map2[y][x]}\n                y2 -= 1\n            }\n            m = [m-i, i].max\n        end\n    }\n\n    p.times{\n        x, y = gets.chomp.split.map(&:to_i)\n        puts map[m-y-1][x]\n    }\nend\n\n"
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,copy,functools\nimport time,random,resource\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 10**9+7\nmod2 = 998244353\ndd = [(-1,0),(0,1),(1,0),(0,-1)]\nddn = [(-1,0),(-1,1),(0,1),(1,1),(1,0),(1,-1),(0,-1),(-1,-1)]\n\ndef LI(): return list(map(int, sys.stdin.readline().split()))\ndef LLI(): return [list(map(int, l.split())) for l in sys.stdin.readlines()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\ndef pe(s): return print(str(s), file=sys.stderr)\ndef JA(a, sep): return sep.join(map(str, a))\ndef JAA(a, s, t): return s.join(t.join(map(str, b)) for b in a)\n\nclass UnionFind:\n    def __init__(self, size, m):\n        self.m = m\n        self.table = [-1 for _ in range(size)]\n\n    def find(self, x):\n        if self.table[x] < 0:\n            return x\n        else:\n            self.table[x] = self.find(self.table[x])\n            return self.table[x]\n\n    def union(self, x, y):\n        s1 = self.find(x)\n        s2 = self.find(y)\n        if s1 != s2:\n            if s1 >= self.m:\n                self.table[s1] = s2\n            elif s2 >= self.m:\n                self.table[s2] = s1\n            elif self.table[s1] <= self.table[s2]:\n                self.table[s1] += self.table[s2]\n                self.table[s2] = s1\n            else:\n                self.table[s2] += self.table[s1]\n                self.table[s1] = s2\n            return True\n        return False\n\n    def subsetall(self):\n        a = []\n        for i in range(len(self.table)):\n            if self.table[i] < 0:\n                a.append((i, -self.table[i]))\n        return a\n\ndef main():\n    rr = []\n\n    def f():\n        n,m,t,p = LI()\n        if n == 0:\n            return\n\n        dc = [LI() for _ in range(t)]\n        xy = [LI() for _ in range(p)]\n\n        ux = UnionFind(n*n, n)\n        uy = UnionFind(m*m, m)\n        xs = ys = 0\n        for d,c in dc:\n            if d == 1:\n                for i in range(c):\n                    ux.union(xs+i, xs+c*2-1-i)\n                xs += c\n            else:\n                for i in range(c):\n                    uy.union(ys+i, ys+c*2-1-i)\n                ys += c\n\n        for x,y in xy:\n            xc = -ux.table[ux.find(xs+x)]\n            yc = -uy.table[uy.find(ys+y)]\n            rr.append(xc*yc)\n\n        return True\n\n    while f():\n        pass\n\n    return JA(rr, \"\\n\")\n\n\nprint(main())\n\n\n\n"
  },
  {
    "language": "Python",
    "code": "#!/usr/bin/python3\n# coding: utf-8\n\nMAX_V = 70\n\n# デバッグ用の関数\ndef show(origami):\n    for i in range(MAX_V):\n        for j in range(MAX_V):\n            print(origami[i][j], end = \" \")\n        print()\n    print(\"--------------------------------------\")\n\n# 右に c だけ折り返す処理\ndef fold_a(origami, c):\n    t = c\n    for i in range(c):\n        for j in range(MAX_V):\n            origami[j][t+i] += origami[j][t-i-1]\n            origami[j][t-i-1] = 0\n\n    copy = [x[:] for x in origami]\n\n    for i in range(MAX_V):\n        for j in range(MAX_V):\n            if j-c < 0 or MAX_V-1 < j-c:\n                continue\n            origami[i][j-c] = copy[i][j]\n\n\n# 上に c だけ折り返す処理\ndef fold_b(origami, c):\n    t = MAX_V - c -1\n    for i in range(MAX_V):\n        for j in range(c):\n            origami[t-j][i] += origami[t+j+1][i]\n            origami[t+j+1][i] = 0\n\n    copy = [x[:] for x in origami]\n\n    for i in range(MAX_V):\n        for j in range(MAX_V):\n            if i+c < 0 or MAX_V-1 < i+c:\n                continue\n            origami[i+c][j] = copy[i][j]\n\n\n\ndef main():\n    while True:\n        n, m, t, p = map(int, input().split())\n\n        origami = [[0 for i in range(MAX_V)] for _ in range(MAX_V)]\n\n        for i in range(n):\n            for j in range(m):\n                origami[-1-j][i] = 1\n\n        if n == 0 and m == 0 and t == 0 and p == 0:\n            break\n\n        for _ in range(t):\n            d, c = map(int, input().split())\n\n            if d == 1:\n                fold_a(origami, c)\n            if d == 2:\n                fold_b(origami, c)\n\n        for _ in range(p):\n            x, y = map(int, input().split())\n            print(origami[MAX_V-y-1][x])\n\n    return 0\n\nmain()\n"
  },
  {
    "language": "Python",
    "code": "a = list(map(int,input().split()))\n\nwhile sum(a) != 0:\n\taa = [[1 for i in range(a[0])] for j in range(a[1])]\n\tfor i in range(a[2]):\n\t\tk = list(map(int,input().split()))\n\t\tif k[0] == 1:\n\t\t\tif a[0] //2 >= k[1]:\n\t\t\t\tfor m in range(a[1]):\n\t\t\t\t\tfor n in range(k[1]):\n\t\t\t\t\t\taa[m][2*k[1] - n - 1] += aa[m][n]\n\t\t\t\t\taa[m] = aa[m][k[1]:]\n\t\t\t\ta[0] -= k[1]\n\t\t\telse:\n\t\t\t\tfor m in range(a[1]):\n\t\t\t\t\tfor n in range(a[0] - k[1]):\n\t\t\t\t\t\taa[m][a[0]-(2*(a[0]-k[1])-n-1)-1] += aa[m][a[0]-n-1]\n\t\t\t\t\taa[m].reverse()\n\t\t\t\t\taa[m] = aa[m][a[0]-k[1]:]\n\t\t\t\ta[0]-=(a[0]-k[1])\n\t\telif k[0] == 2:\n\t\t\tif a[1] // 2 >= k[1]:\n\t\t\t\tfor n in range(a[0]):\n\t\t\t\t\tfor m in range(k[1]):\n\t\t\t\t\t\taa[2*k[1]-m-1][n] += aa[m][n]\n\t\t\t\ta[1] -= k[1]\n\t\t\t\taa = aa[k[1]:]\n\t\t\telse:\n\t\t\t\tfor n in range(a[0]):\n\t\t\t\t\tfor m in range(a[1]-k[1]):\n\t\t\t\t\t\taa[a[1]-(2*(a[1]-k[1])-m-1)-1][n] += aa[a[1]-m-1][n]\n\t\t\t\taa.reverse()\n\t\t\t\taa = aa[a[1]-k[1]:]\n\t\t\t\ta[1] -= (a[1] - k[1])\n\n\tfor i in range(a[3]):\n\t\tp = list(map(int,input().split()))\n\t\tprint(aa[p[1]][p[0]])\n\ta = list(map(int,input().split()))\n"
  },
  {
    "language": "Python",
    "code": "# coding: utf-8\n\nmax_v = 450\n\n# デバッグ用の関数, 折り紙の状態を表示する\ndef show(origami):\n    print \"-----------\"\n    for i in origami:\n        for j in i:\n            print j,\n        print\n    print \"-----------\"\n\n5\n# 縦におる処理\ndef fold_a(origami, c, katan):\n    t = max_v-1-katan-c\n\n    for i in range(max_v):\n        for j in range(c):\n            origami[t-j][i] += origami[t+1+j][i]\n            origami[t+1+j][i] = 0\n\n    # show(origami)\n\n\n# 横におる処理\ndef fold_b(origami, c, satan):\n    t = satan+c\n\n    for i in range(max_v):\n        for j in range(c):\n            origami[i][t+j] += origami[i][t-1-j]\n            origami[i][t-1-j] = 0\n\n    # show(origami)\n\nwhile True:\n    # n: 折り紙の幅, m: 折り紙の高さ\n    # t: おる操作の回数 p: 穴を開ける操作の回数\n    n, m, t, p = map(int, raw_input().split())\n\n    # 終了条件\n    if n == 0 and m == 0 and t == 0 and p == 0:\n        break\n\n    # 折り紙の初期条件, 大きめなリストを作る\n    origami = [[0] * max_v for _ in range(max_v)]\n\n    for i in range(n):\n        for j in range(m):\n            origami[-1-j][i] = 1\n\n    # 下端, 左端\n    katan, satan = 0, 0\n\n    # t回折り紙をおる\n    for i in range(t):\n        d, c = map(int, raw_input().split())\n        # dが1なら横に折る\n        if d == 1:\n            fold_b(origami, c, satan)\n            satan += c\n        # dが2なら縦に折る\n        if d == 2:\n            fold_a(origami, c, katan)\n            katan += c\n\n    # p回穴を開ける\n    for i in range(p):\n        x, y = map(int, raw_input().split())\n\n        print origami[max_v-1-katan-y][satan+x]\n\n"
  },
  {
    "language": "Python",
    "code": "ans = []\nwhile 1:\n    N, M, T, P = map(int, input().split())\n    if N == 0:\n        break\n    A = [[1]*N for i in range(M)]\n    for i in range(T):\n        d, c = map(int, input().split())\n        if d == 1:\n            B = [[0]*max(c, N-c) for i in range(M)]\n            for x in range(N-c):\n                for y in range(M):\n                    B[y][x] = A[y][c+x]\n            for x in range(c):\n                for y in range(M):\n                    B[y][x] += A[y][c-1-x]\n            N = max(c, N-c)\n        else:\n            B = [[0]*N for i in range(max(c, M-c))]\n            for x in range(N):\n                for y in range(M-c):\n                    B[y][x] = A[c+y][x]\n            for x in range(N):\n                for y in range(c):\n                    B[y][x] += A[c-1-y][x]\n            M = max(c, M-c)\n        A = B\n    cnt = 0\n    for i in range(P):\n        x, y = map(int, input().split())\n        ans.append(B[y][x])\nprint(*ans, sep='\\n')\n\n"
  },
  {
    "language": "Python",
    "code": "def main(n, m, t, p):\n    dpn = [1] * n\n    dpm = [1] * m\n    ldpn = n\n    ldpm = m\n    for _ in range(t):\n        d, c = map(int, input().split())\n        if d == 1:\n            if ldpn // 2 < c:\n                for i in range(ldpn - c):\n                    dpn[c - i - 1] += dpn[c + i]\n                dpn = dpn[c - 1::-1]\n                ldpn = c\n            else:\n                for i in range(c):\n                    dpn[c + i] += dpn[c - 1 - i]\n                dpn = dpn[c:]\n                ldpn -= c\n        else:\n            if ldpm // 2 < c:\n                for i in range(ldpm - c):\n                    dpm[c - i - 1] += dpm[c + i]\n                dpm = dpm[c - 1::-1]\n                ldpm = c\n            else:\n                for i in range(c):\n                    dpm[c + i] += dpm[c - 1 - i]\n                dpm = dpm[c:]\n                ldpm -= c\n    ans = []\n    for _ in range(p):\n        x, y = map(int, input().split())\n        ans.append(str(dpn[x] * dpm[y]))\n    print(\"\\n\".join(ans))\n\n\nwhile 1:\n    n, m, t, p = map(int, input().split())\n    if n == m == t == p == 0:\n        break\n    main(n, m, t, p)\n"
  },
  {
    "language": "Python",
    "code": "#!/usr/bin/python\nimport sys\n\ndef f(a,n):\n\ta=[list(e) for e in a]\n\tfor j in range(len(a)):\n\t\tfor i in range(n):\n\t\t\tif n+i>=len(a[j]):\n\t\t\t\ta[j].append(a[j][n-1-i])\n\t\t\telse:\n\t\t\t\ta[j][n+i]+=a[j][n-1-i]\n\t\ta[j]=a[j][n:]\n\treturn a\ndef g(a,n):\n\treturn list(zip(*f(list(zip(*a)),n)))\n\nwhile True:\n\tn,m,t,p=map(int,sys.stdin.readline().split())\n\ta=[[1]*n for _ in range(m)]\n\tif n==0: break\n\tfor _ in range(t):\n\t\td,c=map(int,sys.stdin.readline().split())\n\t\ta=(f if d==1 else g)(a,c)\n\tfor _ in range(p):\n\t\tx,y=map(int,sys.stdin.readline().split())\n\t\tprint(a[y][x])\n\n"
  },
  {
    "language": "Python",
    "code": "#!/usr/bin/python3\n# coding: utf-8\n\nMAX_V = 100\n\n# デバッグ用の関数\ndef show(origami):\n    for i in range(MAX_V):\n        for j in range(MAX_V):\n            print(origami[i][j], end = \" \")\n        print()\n    print(\"--------------------------------------\")\n\n# 右に c だけ折り返す処理\ndef fold_a(origami, c):\n    t = c\n    for i in range(c):\n        for j in range(MAX_V):\n            origami[j][t+i] += origami[j][t-i-1]\n            origami[j][t-i-1] = 0\n\n    copy = [x[:] for x in origami]\n\n    for i in range(MAX_V):\n        for j in range(MAX_V):\n            if j-c < 0 or MAX_V-1 < j-c:\n                continue\n            origami[i][j-c] = copy[i][j]\n\n\n# 上に c だけ折り返す処理\ndef fold_b(origami, c):\n    t = MAX_V - c -1\n    for i in range(MAX_V):\n        for j in range(c):\n            origami[t-j][i] += origami[t+j+1][i]\n            origami[t+j+1][i] = 0\n\n    copy = [x[:] for x in origami]\n\n    for i in range(MAX_V):\n        for j in range(MAX_V):\n            if i+c < 0 or MAX_V-1 < i+c:\n                continue\n            origami[i+c][j] = copy[i][j]\n\n\n\ndef main():\n    while True:\n        n, m, t, p = map(int, input().split())\n\n        origami = [[0 for i in range(MAX_V)] for _ in range(MAX_V)]\n\n        for i in range(n):\n            for j in range(m):\n                origami[-1-j][i] = 1\n\n        if n == 0 and m == 0 and t == 0 and p == 0:\n            break\n\n        for _ in range(t):\n            d, c = map(int, input().split())\n\n            if d == 1:\n                fold_a(origami, c)\n            if d == 2:\n                fold_b(origami, c)\n\n        for _ in range(p):\n            x, y = map(int, input().split())\n            print(origami[MAX_V-y-1][x])\n\n    return 0\n\nmain()\n"
  },
  {
    "language": "Python",
    "code": "from operator import add\n\n\ndef fold_right(v, length):\n    global white_right\n    for i in range(white_right, len(v[0])):\n        if not any(list(zip(*v))[i]):\n            white_right += 1\n            continue\n        for j in range(length - 1, -1, -1):\n            for yoko in range(len(v)):\n                v[yoko][i + j + length] += v[yoko][i + (length - 1 - j)]\n                v[yoko][i + (length - 1 - j)] = 0\n        return v\n\n\ndef fold_up(v, length):\n    global white_up\n    for i in range(white_up, -1, -1):\n        if not any(v[i]):\n            white_up -= 1\n            continue\n        for j in range(length - 1, -1, -1):\n            # print(\n            #     \"i: {} j: {} length: {} i-j: {} i-j-length: {}\".format(\n            #         i, j, length, i - (length - 1 - j), i - j - length\n            #     )\n            # )\n            v[i - j - length] = list(\n                map(add, v[i - j - length], v[i - (length - 1 - j)])\n            )\n            v[i - (length - 1 - j)] = [0] * len(v[i - j])\n        return v\n\n\ndef cut_cut_cut(v):\n    global white_right\n    global white_up\n    for i in range(len(v) - 1, -1, -1):\n        if not any(v[i]):\n            continue\n        white_up = i\n        break\n    for i in range(len(v[0])):\n        if not any(list(zip(*v))[i]):\n            continue\n        white_right = i\n        break\n\n\nwhile True:\n    n, m, t, p = map(int, input().split())\n    if n == 0 and m == 0 and t == 0 and p == 0:\n        break\n    origami = [[0] * 500 for _ in range(500)]\n    for i in range(m):\n        for j in range(n):\n            origami[len(origami) - 1 - i][j] = 1\n    white_right = 0\n    white_up = len(origami) - 1\n    # print(*origami, sep=\"\\n\")\n    for i in range(t):\n        d, c = map(int, input().split())\n        if d == 1:\n            origami = fold_right(origami, c)\n        else:\n            origami = fold_up(origami, c)\n        # print(d, c)\n        # print(*origami, sep=\"\\n\")\n\n    cut_cut_cut(origami)\n    for i in range(p):\n        x, y = map(int, input().split())\n        print(origami[white_up - y][white_right + x])\n"
  },
  {
    "language": "Python",
    "code": "def main():\n    import sys\n    input = sys.stdin.buffer.readline\n    N,M,T,P = (int(i) for i in input().split())\n    answer = []\n    while not(N == M == T == P == 0):\n        DC = [[int(i) for i in input().split()] for _ in range(T)]\n        XY = [[int(i) for i in input().split()] for _ in range(P)]\n        rec = [[0]*(32**2+1) for _ in range(32**2+1)]\n        for y in range(M):\n            for x in range(N):\n                rec[y][x] += 1\n        ori_x,ori_y = 0,0\n        for d,c in DC:\n            if d == 1:\n                ori_x += c\n                for y in range(ori_y,32**2+1):\n                    for x in range(ori_x,ori_x+c):\n                        # print(M,y,ori_x*2-x-1, ori_x,x)\n                        rec[y][x] += rec[y][ori_x*2-x-1]\n            else:\n                ori_y += c\n                for y in range(ori_y,ori_y+c):\n                    for x in range(ori_x,32**2+1):\n                        rec[y][x] += rec[ori_y*2-y-1][x]\n        for px,py in XY:\n            answer.append(rec[ori_y+py][ori_x+px])\n\n        N,M,T,P = (int(i) for i in input().split())\n    for a in answer:\n        print(a)\nif __name__ == \"__main__\":\n    main()\n\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "Python",
    "code": "def unite(l1, l2):\n  len1 = len(l1)\n  len2 = len(l2)\n  if len1 < len2:\n    ret = l2[:]\n    for i in range(len1):\n      ret[i] += l1[i]\n    return ret\n  else:\n    ret = l1[:]\n    for i in range(len2):\n      ret[i] += l2[i]\n    return ret\n\nwhile True:\n  n, m, t, p = map(int, input().split())\n  if n == 0:\n    break\n  mp = [[1] * n for _ in range(m)]\n  for _ in range(t):\n    d, c = map(int, input().split())\n    if d == 1:\n      new_mp = []\n      for h in range(m):\n        left = mp[h][:c][::-1]\n        right = mp[h][c:]\n        new_mp.append(unite(left, right))\n      n = len(new_mp[0])\n    else:\n      lenu = max(c, m - c)\n      new_mp = [[] for _ in range(lenu)]\n      for x in range(n):\n        under = [mp[y][x] for y in range(c)][::-1]\n        top = [mp[y][x] for y in range(c, m)]\n        u = unite(top, under)\n        for i in range(lenu):\n          new_mp[i].append(u[i])\n      m = len(new_mp)\n    mp = new_mp\n  \n  for _ in range(p):\n    x, y = map(int, input().split())\n    print(mp[y][x])\n"
  },
  {
    "language": "Python",
    "code": "from operator import add\n\n\ndef fold_right(v, length):\n    for i in range(len(v[0])):\n        if not any(list(zip(*v))[i]):\n            continue\n        for j in range(length):\n            for yoko in range(len(v)):\n                v[yoko][i + j + length] += v[yoko][i + j]\n                v[yoko][i + j] = 0\n        return v\n\n\ndef fold_up(v, length):\n    for i in range(len(v) - 1, -1, -1):\n        if not any(v[i]):\n            continue\n        for j in range(length):\n            v[i - j - length] = list(map(add, v[i - j - length], v[i - j]))\n            v[i - j] = [0] * len(v[i - j])\n        return v\n\n\ndef cut_cut_cut(v, x, y):\n    for i in range(len(v) - 1, -1, -1):\n        if not any(v[i]):\n            continue\n        y = i - y\n        break\n    for i in range(len(v[0])):\n        if not any(list(zip(*v))[i]):\n            continue\n        x = i + x\n        break\n    return v[y][x]\n\n\nwhile True:\n    n, m, t, p = map(int, input().split())\n    if n == 0 and m == 0 and t == 0 and p == 0:\n        break\n    origami = [[0] * 63 for _ in range(63)]\n    for i in range(m):\n        for j in range(n):\n            origami[len(origami) - 1 - i][j] = 1\n    for i in range(t):\n        d, c = map(int, input().split())\n        if d == 1:\n            origami = fold_right(origami, c)\n        else:\n            origami = fold_up(origami, c)\n\n    # print(*origami, sep=\"\\n\")\n    # print()\n    for i in range(p):\n        x, y = map(int, input().split())\n        print(cut_cut_cut(origami, x, y))\n\n\n"
  },
  {
    "language": "Python",
    "code": "import sys\n\n\nfrom inspect import currentframe\n\ndef pri(*args):\n    names = {id(v):k for k,v in currentframe().f_back.f_locals.items()}\n    # print(', '.join(names.get(id(arg),'???')+' = '+repr(arg) for arg in args))\n\n\ndef solve(n, m, t, p, d, c, x, y):\n\n    a = [[1 for _ in range(m)] for _ in range(n)]\n    pri(a)\n    for i in range(t):\n        if d[i] == 1:\n            m = max(m - c[i], c[i])\n            a_new = [[0 for _ in range(m)] for _ in range(n)]\n            pri(a_new)\n            for n_i in range(len(a)):\n                for m_i in range(len(a[0])):\n\n                    if m_i >= c[i]:\n                        a_new[n_i][m_i - c[i]] += a[n_i][m_i]\n                    else:\n                        a_new[n_i][c[i] - m_i - 1] += a[n_i][m_i]\n\n            pri(a_new)\n            a = a_new\n        else:\n            n = max(n - c[i], c[i])\n            a_new = [[0 for _ in range(m)] for _ in range(n)]\n            pri(a_new)\n            for n_i in range(len(a)):\n                for m_i in range(len(a[0])):\n\n                    if n_i >= c[i]:\n                        a_new[n_i - c[i]][m_i] += a[n_i][m_i]\n                    else:\n                        a_new[c[i] - n_i - 1][m_i] += a[n_i][m_i]\n\n            pri(a_new)\n            a = a_new\n\n    for j in range(p):\n        print(a[y[j]][x[j]])\n\n\n    return\n\n\nif __name__ == '__main__':\n    while True:\n        n_imput, m_imput, t_imput, p_imput = map(int, input().split())\n        if p_imput == m_imput == n_imput == t_imput == 0:\n            break\n        d_imput = [0 for _ in range(t_imput)]\n        c_imput = [0 for _ in range(t_imput)]\n        x_imput = [0 for _ in range(p_imput)]\n        y_imput = [0 for _ in range(p_imput)]\n\n        for i in range(t_imput):\n            d_imput[i], c_imput[i] = map(int, input().split())\n        for i in range(p_imput):\n            x_imput[i], y_imput[i] = map(int, input().split())\n\n\n        solve(m_imput, n_imput, t_imput, p_imput, d_imput, c_imput, x_imput, y_imput)\n\n\n"
  },
  {
    "language": "Python",
    "code": "import sys\ndef input(): return sys.stdin.readline().strip()\ndef INT(): return int(input())\ndef LIST(): return list(map(int, input().split()))\ndef MAP(): return map(int, input().split())\n\ndef remove_left(M, c):\n\tfor i in range(len(M)):\n\t\tM[i] = M[i][c:]\n\treturn M\n\ndef remove_bottom(M, c):\n\tM = M[:len(M)-c]\n\treturn M\n\ndef reverse_tate(M):\n\tfor i in range(len(M)//2):\n\t\tfor j in range(len(M[0])):\n\t\t\tM[i][j], M[-1-i][j] = M[-1-i][j], M[i][j]\n\n\treturn M\ndef reverse_yoko(M):\n\tfor i in range(len(M)):\n\t\tM[i] = M[i][::-1]\n\treturn M\n\n\ndef turn_left(M, c):\n\tif c > len(M[0])/2:\n\t\tM = reverse_yoko(M)\n\t\tc = len(M[0]) - c\n\tfor i in range(len(M)):\n\t\tfor j in range(c):\n\t\t\tM[i][c+j] += M[i][c-1-j]\n\tM = remove_left(M, c)\n\treturn M\n\ndef turn_bottom(M, c):\n\tif c > len(M)/2:\n\t\tM = reverse_tate(M)\n\t\tc = len(M) - c\n\tfor i in range(len(M[0])):\n\t\tfor j in range(c):\n\t\t\tM[len(M)-c-1-j][i] += M[len(M)-c+j][i]\n\tM = remove_bottom(M, c)\n\treturn M\n\nans = []\nwhile 1:\n\tn, m, t, p = MAP()\n\tif (n, m, t, p) == (0, 0, 0, 0):\n\t\tbreak\n\n\tdc = [LIST() for _ in range(t)]\n\txy = [LIST() for _ in range(p)]\n\n\tM = [[1]*n for _ in range(m)]\n\tfor d, c in dc:\n\t\tif d == 1:  # 左->右\n\t\t\tM = turn_left(M, c)\n\t\telse:  # 下->上\n\t\t\tM = turn_bottom(M, c)\n\n\tfor x, y in xy:\n\t\tans.append(M[-1-y][0+x])\n\nfor i in ans:\n\tprint(i)\n\t\n"
  },
  {
    "language": "Python",
    "code": "#!/usr/bin/python\nimport sys\n\ndef f(a,n):\n\ta=[list(e) for e in a]\n\tfor j in range(len(a)):\n\t\tfor i in range(n):\n\t\t\tif n+i>=len(a[j]):\n\t\t\t\ta[j].append(a[j][n-1-i])\n\t\t\telse:\n\t\t\t\ta[j][n+i]+=a[j][n-1-i]\n\t\ta[j]=a[j][n:]\n\treturn a\ndef g(a,n):\n\treturn list(zip(*f(list(zip(*a)),n)))\n\nwhile True:\n\tn,m,t,p=map(int,sys.stdin.readline().split())\n\ta=[[1]*n for _ in range(m)]\n\tif n==0: break\n\tfor _ in range(t):\n\t\td,c=map(int,sys.stdin.readline().split())\n\t\ta=(f if d==1 else g)(a,c)\n\tfor _ in range(p):\n\t\tx,y=map(int,sys.stdin.readline().split())\n\t\tprint(a[y][x])\n\n"
  },
  {
    "language": "Python",
    "code": "import sys\ninput = sys.stdin.readline\n\ndef main():\n    while True:\n        n,m,t,p = map(int,input().split())\n        if [n,m,t,p] == [0,0,0,0]:\n            exit()\n        dp = [[0]*(m*m+1) for i in range(n*n+1)]\n        \n        \n        sx = 0\n        sy = 0\n        ex = n\n        ey = m\n\n        \n        for i in range(n):\n            for j in range(m):\n                dp[sx+i][sy+j] = 1\n        \n        for i in range(t):\n            d,c = map(int,input().split())\n            if d == 1:\n                for k in range(c):\n                    for j in range(sy,ey):\n                        dp[sx+c+k][j] += dp[sx+c-k-1][j]\n                sx += c\n                ex = max(ex,sx+c)\n            else:\n                for k in range(c):\n                    for j in range(sx,ex):\n                        dp[j][sy+c+k] += dp[j][sy+c-k-1]\n                sy += c\n                ey = max(ey,sy+c)\n        res = 0\n        for i in range(p):\n            x,y = map(int,input().split())\n            res = dp[sx+x][sy+y]\n            print(res)\n            \n            \nmain()\n"
  },
  {
    "language": "Python",
    "code": "while True:\n\tdata = [int(x) for x in input().split()]\n\tif data == [0, 0, 0, 0]:\n\t\tbreak\n\tmatrix = [[1 for x in range(data[0])] for y in range(data[1])]\n\t#print('Matrix :', len(matrix), len(matrix[0]))\n\tn = data[2] + data[3]\n\tcommand = list()\n\twhile n > 0:\n\t\tcommand.append([int(x) for x in input().split()])\n\t\tn -= 1\n\tflipping = [command[x] for x in range(data[2])]\n\tholing = [command[x] for x in range(data[2], len(command))]\n\tfor c, b in flipping:\n\t\tmatrixtemp = list()\n\t\tif c == 1:\n\t\t\t#print('\\tFlipping l-r\\t:', b, ' Blocks')\n\t\t\tmatrixtemp = [[matrix[y][x] for x in range(b)] for y in range(len(matrix))]\n\t\t\tfor n in range(len(matrixtemp)):\n\t\t\t\tmatrixtemp[n] = matrixtemp[n][::-1]\n\t\t\tfor n in range(len(matrix)):\n\t\t\t\tmatrix[n] = matrix[n][b:]\n\t\t\tif len(matrixtemp[0]) > len(matrix[0]):\n\t\t\t\tfor y in range(len(matrix)):\n\t\t\t\t\tfor x in range(len(matrix[n])):\n\t\t\t\t\t\tmatrixtemp[y][x] += matrix[y][x]\n\t\t\t\tmatrix = matrixtemp\n\t\t\telse:\n\t\t\t\tfor y in range(len(matrix)):\n\t\t\t\t\tfor x in range(b):\n\t\t\t\t\t\tmatrix[y][x] += matrixtemp[y][x]\n\t\telse:\n\t\t\t#print('\\tFlipping d-u\\t:', b, ' Blocks')\n\t\t\tmatrixtemp = matrix[-b:]\n\t\t\tmatrixtemp = matrixtemp[::-1]\n\t\t\tmatrix = matrix[:-b]\n\t\t\tif len(matrixtemp) > len(matrix):\n\t\t\t\tfor y in range(-len(matrix), 0, 1):\n\t\t\t\t\tfor x in range(len(matrixtemp[0])):\n\t\t\t\t\t\tmatrixtemp[y][x] += matrix[y][x]\n\t\t\t\tmatrix = matrixtemp\n\t\t\telse:\n\t\t\t\tfor y in range(-b, 0, 1):\n\t\t\t\t\tfor x in range(len(matrixtemp[0])):\n\t\t\t\t\t\tmatrix[y][x] += matrixtemp[y][x]\n\t\t#print('\\t',matrix)\n\tfor x, y in holing:\n\t\tprint(matrix[len(matrix) - y - 1][x])\n"
  },
  {
    "language": "Python",
    "code": "from collections import defaultdict,deque\nimport sys,heapq,bisect,math,itertools,string,queue,datetime\nsys.setrecursionlimit(10**8)\nINF = float('inf')\nmod = 10**9+7\neps = 10**-7\ndef inpl(): return list(map(int, input().split()))\ndef inpl_str(): return list(input().split())\n\n\ndef rev_w(MAP,H,W):\n    nextMAP = [[] for y in range(H)]\n    for y in range(H):\n        nextMAP[y] = MAP[y][::-1]\n    return nextMAP\n\ndef rev_h(MAP,H,W):\n    nextMAP = [[0]*W for y in range(H)]\n    for y in range(H):\n        for x in range(W):\n            nextMAP[y][x] = MAP[H-y-1][x]\n    return nextMAP\n\nwhile True:\n    W,H,t,p = inpl()\n    if W == 0:\n        break\n    else:\n        MAP = [[1]*W for y in range(H)]\n        for _ in range(t):\n            d,c = inpl()\n            if d == 1:\n                if W//2 >= c:\n                    hanten = False\n                else:\n                    hanten = True\n\n                if hanten:\n                    MAP = rev_w(MAP,H,W)\n                    c = W - c\n\n                nextW = W - c\n                nextH = H\n                nextMAP = [[1]*nextW for y in range(H)]\n                for y in range(H):\n                    for x in range(c):\n                        nextMAP[y][x] = MAP[y][x+c] + MAP[y][(c-1)-x]\n                    for x in range(c,nextW):\n                        nextMAP[y][x] = MAP[y][x+c]\n\n            elif d == 2:\n                if H//2 >= c:\n                    hanten = False\n                else:\n                    hanten = True\n\n                if hanten:\n                    MAP = rev_h(MAP,H,W)\n                    c = H - c\n\n                nextW = W\n                nextH = H - c\n                nextMAP = [[1]*W for y in range(nextH)]\n                for x in range(W):\n                    for y in range(c):\n                        nextMAP[y][x] = MAP[y+c][x] + MAP[(c-1)-y][x]\n                    for y in range(c,nextH):\n                        nextMAP[y][x] = MAP[y+c][x]\n\n            MAP = nextMAP\n            H,W = nextH,nextW\n\n        for _ in range(p):\n            x,y = inpl()\n            print(MAP[y][x])\n\n"
  },
  {
    "language": "Python",
    "code": "# python template for atcoder1\nimport sys\nsys.setrecursionlimit(10**9)\ninput = sys.stdin.readline\n\n\ndef solve():\n    grid_wid, grid_hei, t, p = map(int, input().split())\n    if grid_wid == 0:\n        exit()\n    grid = [[1]*grid_wid for _ in range(grid_hei)]\n\n    fold = [list(map(int, input().split())) for _ in range(t)]\n    pin = [list(map(int, input().split())) for _ in range(p)]\n\n    # 区間の左端と右端[L,R)\n    L = 0\n    R = grid_wid\n    # 区間の下端と上端[B,H)\n    B = 0\n    H = grid_hei\n\n    for ope, axis in fold:\n        if ope == 1:\n            # 横におる\n            current_width = R-L\n            if axis > current_width/2:  # kaiten\n                alter_axis = current_width-axis\n                for i in range(alter_axis):\n                    for j in range(grid_hei):\n                        grid[j][axis-i-1+L] += grid[j][axis+i+L]\n                        grid[j][axis+i+L] = 0\n\n                # 回転させる\n                for j in range(grid_hei):\n                    grid[j] = list(reversed(grid[j]))\n                # 区間の更新\n                L, R = grid_wid-R+alter_axis, grid_wid-L\n\n            else:\n                for i in range(axis):\n                    for j in range(grid_hei):\n                        grid[j][axis+i+L] += grid[j][axis-i-1+L]\n                        grid[j][axis-i-1+L] = 0\n                L += axis\n\n        if ope == 2:\n            # 縦におる\n            current_hei = H-B\n            if axis > current_hei/2:  # kaiten\n                alter_axis = current_hei-axis\n                for i in range(alter_axis):\n                    for j in range(grid_wid):\n                        grid[axis-i-1+B][j] += grid[axis+B+i][j]\n                        grid[axis+i+B][j] = 0\n\n                # 回転させる\n                grid = list(reversed(grid))\n                # 区間の更新\n                B, H = grid_hei-H+alter_axis, grid_hei-B\n            else:\n                for i in range(axis):\n                    for j in range(grid_wid):\n                        grid[axis+i+B][j] += grid[axis-i-1+B][j]\n                        grid[axis-i-1+B][j] = 0\n                B += axis\n    for px, py in pin:\n        ans = grid[B+py][L+px]\n        print(ans)\n\n\nwhile True:\n    solve()\n\n"
  },
  {
    "language": "Python",
    "code": "#!/usr/bin/python3\n\nimport array\nfrom fractions import Fraction\nimport functools\nimport itertools\nimport math\nimport os\nimport sys\n\n\ndef main():\n    while True:\n        N, M, T, P = read_ints()\n        if (N, M, T, P) == (0, 0, 0, 0):\n            break\n        F = [read_ints() for _ in range(T)]\n        H = [read_ints() for _ in range(P)]\n        print(*solve(N, M, T, P, F, H), sep='\\n')\n\n\ndef solve(N, M, T, P, F, H):\n    w = N\n    h = M\n    paper = [[1] * w for _ in range(h)]\n\n    for d, c in F:\n        if d == 1:\n            w1 = max(c, w - c)\n            npaper = [[0] * w1 for _ in range(h)]\n            for y in range(h):\n                for dx in range(c):\n                    npaper[y][c - 1 - dx] += paper[y][dx]\n                for dx in range(c, w):\n                    npaper[y][dx - c] += paper[y][dx]\n            w = w1\n            paper = npaper\n            continue\n\n        h1 = max(c, h - c)\n        npaper = [[0] * w for _ in range(h1)]\n        for x in range(w):\n            for dy in range(c):\n                npaper[c - 1 - dy][x] += paper[dy][x]\n            for dy in range(c, h):\n                npaper[dy - c][x] += paper[dy][x]\n        h = h1\n        paper = npaper\n\n    return [paper[y][x] for x, y in H]\n\n\n###############################################################################\n# AUXILIARY FUNCTIONS\n\nDEBUG = 'DEBUG' in os.environ\n\n\ndef inp():\n    return sys.stdin.readline().rstrip()\n\n\ndef read_int():\n    return int(inp())\n\n\ndef read_ints():\n    return [int(e) for e in inp().split()]\n\n\ndef dprint(*value, sep=' ', end='\\n'):\n    if DEBUG:\n        print(*value, sep=sep, end=end)\n\n\nif __name__ == '__main__':\n    main()\n\n"
  },
  {
    "language": "Python",
    "code": "def patam1(field, c):\n    length = len(field[0]) // 2\n    for row in field:\n        for i, v in zip(range(c, min(c * 2, len(row))), row[:c]):\n            row[i] += v\n        for i in reversed(range(c * 2 - len(row))):\n            row.append(row[i])\n        del row[:c]\n\ndef patam2(field, c):\n    length = len(field) // 2\n    for i, row in zip(range(c, min(c * 2, len(field))), field[:c]):\n        for target, cell in enumerate(row):\n            field[i][target] += cell\n    for i in reversed(range(c * 2 - len(field))):\n        field.append(field[i])\n    del field[:c]\n\ndef solve():\n    n, m, t, p = map(int, input().split())\n    if n == m == t == p == 0:\n        return True\n    field = [[1 for x in range(n)] for y in range(m)]\n    for i in range(t):\n        d, c = map(int, input().split())\n        globals()[\"patam\" + str(d)](field, c)\n    for i in range(p):\n        x, y = map(int, input().split())\n        print(field[y][x])\n\n\nwhile not solve(): pass\n\n\n"
  },
  {
    "language": "Python",
    "code": "while True:\n  n, m, t, p = list(map(int, input().split()))\n  if n==0:\n    break\n  gx, gy = 500, 500\n\n  paper = [[0 for i in range(1000)] for i in range(1000)]\n  for i in range(n):\n    for j in range(m):\n      paper[500+i][500+j] = 1\n  for _ in range(t):\n    d, c = list(map(int, input().split()))\n    if d==1:\n      gx = gx+c\n      for i in range(c):\n        for j in range(1000):\n          paper[gx+i][j] += paper[gx-i-1][j]\n          paper[gx-i-1][j] = 0\n    if d==2:\n      gy = gy+c\n      for i in range(1000):\n        for j in range(c):\n          paper[i][gy+j] += paper[i][gy-j-1]\n          paper[i][gy-j-1] = 0\n\n  for i in range(p):\n    x, y = list(map(int, input().split()))\n    print(paper[gx+x][gy+y])\n"
  },
  {
    "language": "Python",
    "code": "import copy\n\ndef main():\n    while True:\n        n,m,t,p = map(int,input().split())\n        if not n and not m and not t and not p:\n            return\n\n        dlist,clist = [],[]\n        \n        for _ in range(t):\n            d,c = map(int,input().split())\n            dlist.append(d)\n            clist.append(c)\n\n        coorlist = [tuple(map(int,input().split())) for _ in range(p)]\n\n        oldm = [[1 for _ in range(m)] for _ in range(n)]\n\n        for d,c in zip(dlist,clist):\n            if d == 1: # →\n                if 2*c <= n:\n                    newm = [[0 for _ in range(m)] for _ in range(n-c)]\n                    for i in range(c):\n                        for j in range(m):\n                            newm[i][j] = oldm[c+i][j] + oldm[c-1-i][j]\n                    for i in range(c,n-c):\n                        for j in range(m):\n                            newm[i][j] = oldm[c+i][j]\n                    n = n-c\n                else:\n                    newm = [[0 for _ in range(m)] for _ in range(c)]\n                    for i in range(n-c):\n                        for j in range(m):\n                            newm[i][j] = oldm[c+i][j] + oldm[c-1-i][j]\n                    for i in range(n-c,c):\n                        for j in range(m):\n                            newm[i][j] = oldm[c-1-i][j]\n                    n = c\n            else: # ↑\n                if 2*c <= m:\n                    newm = [[0 for _ in range(m-c)] for _ in range(n)]\n                    for i in range(n):\n                        for j in range(c):\n                            newm[i][j] = oldm[i][c+j] + oldm[i][c-1-j]\n                    for i in range(n):\n                        for j in range(c,m-c):\n                            newm[i][j] = oldm[i][c+j]\n                    m = m-c\n                else:\n                    newm = [[0 for _ in range(c)] for _ in range(n)]\n                    for i in range(n):\n                        for j in range(m-c):\n                            newm[i][j] = oldm[i][c+j] + oldm[i][c-1-j]\n                    for i in range(n):\n                        for j in range(m-c,c):\n                            newm[i][j] = oldm[i][c-1-j]\n                    m = c\n            oldm = newm\n\n        ans = 0\n        for c in coorlist:\n            print(oldm[c[0]][c[1]])\n\ndef visualize(mmap):\n    print(\"------------------\")\n    for j in range(len(mmap[0])):\n        print('|', end=\"\")\n        for i in range(len(mmap)):\n            print(mmap[i][len(mmap[0])-1-j], '|', end=\"\")\n        print()\n    print(\"------------------\")\n\n\nif __name__ == '__main__':\n    main()\n\n"
  },
  {
    "language": "Python",
    "code": "# origami\nimport sys\ninput = sys.stdin.readline\n\ndef f(a, n):\n    a = [list(e) for e in a]\n    for j in range(len(a)):\n        for i in range(n):\n            if n + i >= len(a[j]):\n                a[j].append(a[j][n-1-i])\n            else:\n                a[j][n+i] += a[j][n-1-i]\n        a[j] = a[j][n:]\n    return a\n\n\ndef g(a, n):\n    return list(zip(*f(list(zip(*a)),n)))\n\n\nwhile True:\n    n, m, t, p = map(int, input().split())\n    a = [[1]*n for _ in range(m)]\n    if n == 0: break\n    for _ in range(t):\n        d, c = map(int, input().split())\n        a = (f if d == 1 else g)(a, c)\n    for _ in range(p):\n        x, y= map(int, input().split())\n        print(a[y][x])\n\n"
  },
  {
    "language": "Python",
    "code": "from collections import defaultdict,deque\nimport sys,heapq,bisect,math,itertools,string,queue,datetime\nsys.setrecursionlimit(10**8)\nINF = float('inf')\nmod = 10**9+7\neps = 10**-7\ndef inpl(): return list(map(int, input().split()))\ndef inpl_str(): return list(input().split())\n\n\ndef rev_w(MAP,H,W):\n    nextMAP = [[] for y in range(H)]\n    for y in range(H):\n        nextMAP[y] = MAP[y][::-1]\n    return nextMAP\n\ndef rev_h(MAP,H,W):\n    nextMAP = [[] for y in range(H)]\n    for y in range(H):\n        for x in range(W):\n            nextMAP[y][x] = MAP[H-y-1][x]\n    return nextMAP\n\nwhile True:\n    W,H,t,p = inpl()\n    if W == 0:\n        break\n    else:\n        MAP = [[1]*W for y in range(H)]\n        for _ in range(t):\n            d,c = inpl()\n            if d == 1:\n                if W//2 >= c:\n                    hanten = False\n                else:\n                    hanten = True\n\n                if hanten:\n                    MAP = rev_w(MAP,H,W)\n                    c = W - c\n\n                nextW = W - c\n                nextH = H\n                nextMAP = [[1]*nextW for y in range(H)]\n                for y in range(H):\n                    for x in range(c):\n                        nextMAP[y][x] = MAP[y][x+c] + MAP[y][(c-1)-x]\n                    for x in range(c,nextW):\n                        nextMAP[y][x] = MAP[y][x+c]\n\n                if hanten:\n                    nextMAP = rev_w(nextMAP,H,nextW)\n            elif d == 2:\n                if H//2 >= c:\n                    hanten = False\n                else:\n                    hanten = True\n\n                if hanten:\n                    MAP = rev_h(MAP,H,W)\n                    c = H - c\n\n                nextW = W\n                nextH = H - c\n                nextMAP = [[1]*W for y in range(nextH)]\n                for x in range(W):\n                    for y in range(c):\n                        nextMAP[y][x] = MAP[y+c][x] + MAP[(c-1)-y][x]\n                    for y in range(c,nextH):\n                        nextMAP[y][x] = MAP[y+c][x]\n\n                if hanten:\n                    nextMAP = rev_h(nextMAP,H,nextW)\n\n            MAP = nextMAP[:]\n            H,W = nextH,nextW\n            #for m in nextMAP:\n            #    print(m)\n\n        for _ in range(p):\n            x,y = inpl()\n            print(MAP[y][x])\n\n"
  },
  {
    "language": "Python",
    "code": "while(True):\n    n,m,t,p=map(int,input().split())\n    if (n,m,t,p)==(0,0,0,0):\n        break\n    d=[0 for  i in range(t)]\n    c=[0 for  i in range(t)]\n    x=[0 for  i in range(p)]\n    y=[0 for  i in range(p)]\n    nnow,mnow=n,m\n    for i in range(t):\n        d[i],c[i]=map(int,input().split())\n    for i in range(p):\n        x[i],y[i]=map(int,input().split())\n    paper=[[1 for j in range(n)] for i in range(m)]\n    for k in range(t):\n        if d[k]==1:\n            nnext=max(c[k],nnow-c[k])\n            nextpaper=[[0 for j in range(nnext)] for i in range(mnow)]\n            if c[k]<=nnow-c[k]:\n                for i in range(mnow):\n                    for j in range(nnow-c[k]):\n                        nextpaper[i][j]+=paper[i][j+c[k]]\n                    for j in range(c[k]):\n                        nextpaper[i][j]+=paper[i][c[k]-j-1]\n            else:\n                for i in range(mnow):\n                    for j in range(c[k]):\n                        nextpaper[i][-j-1]+=paper[i][j]\n                    for j in range(nnow-c[k]):\n                        nextpaper[i][j]+=paper[i][j+c[k]]\n            nnow=nnext        \n        else:\n            mnext=max(c[k],mnow-c[k])\n            nextpaper=[[0 for j in range(nnow)] for i in range(mnext)]\n            if c[k]<=mnow-c[k]:\n                for j in range(nnow):\n                    for i in range(mnow-c[k]):\n                        nextpaper[i][j]+=paper[i][j]\n                    for i in range(c[k]):\n                        nextpaper[-i-1][j]+=paper[i+mnow-c[k]][j]\n            else:\n                for j in range(nnow):\n                    for i in range(mnow-c[k]):\n                        nextpaper[-i-1][j]+=paper[mnow-c[k]-1-i][j]\n                    for i in range(c[k]):\n                        nextpaper[i][j]+=paper[-i-1][j]\n            mnow=mnext\n        paper=[[nextpaper[i][j] for j in range(nnow)] for i in range(mnow)]\n    ans=0\n    for i in range(p):\n        print(paper[-y[i]-1][x[i]])\n\n"
  },
  {
    "language": "Python",
    "code": "class Paper:\n    def __init__(self, n, m):\n        self.n = n\n        self.m = m\n        self.table = [[1] * n for _ in range(m)]\n\n    def __str__(self):\n        return str(self.table)\n\n    def thickness(self, x, y):\n        return self.table[y][x]\n\n    def fold(self, d, c):\n        if d == 1:\n            return self.foldl(c)\n        else:\n            return self.foldb(c)\n\n    def foldl(self, c):\n        nn = max(c, self.n - c)\n        tbl = [[0] * nn for _ in range(self.m)]\n        for y in range(self.m):\n            for x in range(c):\n                tbl[y][x] += self.table[y][c - x - 1]\n            for x in range(self.n - c):\n                tbl[y][x] += self.table[y][c + x]\n        self.n = nn\n        self.table = tbl\n\n    def foldb(self, c):\n        mm = max(c, self.m - c)\n        tbl = [[0] * self.n for _ in range(mm)]\n        for x in range(self.n):\n            for y in range(c):\n                tbl[y][x] += self.table[c - y - 1][x]\n            for y in range(self.m - c):\n                tbl[y][x] += self.table[c + y][x]\n        self.m = mm\n        self.table = tbl\n\nwhile True:\n    n, m, t, p = map(int, input().split())\n    if n == m == t == p == 0:\n        break\n\n    paper = Paper(n, m)\n    for i in range(t):\n        d, c = map(int, input().split())\n        paper.fold(d, c)\n    for i in range(p):\n        x, y = map(int, input().split())\n        print(paper.thickness(x, y))\n"
  },
  {
    "language": "Rust",
    "code": "/*------------------------------------------------------------------*/\n/*------------------------- begin template -------------------------*/\n/*------------------------------------------------------------------*/\n\n// ref: tanakh <https://qiita.com/tanakh/items/0ba42c7ca36cd29d0ac8>\n// diff: using Parser\nmacro_rules! input {\n    (source = $s:expr, $($r:tt)*) => {\n        let mut parser = Parser::from_str($s);\n        input_inner!{parser, $($r)*}\n    };\n    (parser = $parser:ident, $($r:tt)*) => {\n        input_inner!{$parser, $($r)*}\n    };\n    (new_stdin_parser = $parser:ident, $($r:tt)*) => {\n        let stdin = std::io::stdin();\n        let reader = std::io::BufReader::new(stdin.lock());\n        let mut $parser = Parser::new(reader);\n        input_inner!{$parser, $($r)*}\n    };\n    ($($r:tt)*) => {\n        input!{new_stdin_parser = parser, $($r)*}\n    };\n}\n\nmacro_rules! input_inner {\n    ($parser:ident) => {};\n    ($parser:ident, ) => {};\n    ($parser:ident, $var:ident : $t:tt $($r:tt)*) => {\n        let $var = read_value!($parser, $t);\n        input_inner!{$parser $($r)*}\n    };\n}\n\nmacro_rules! read_value {\n    ($parser:ident, ( $($t:tt),* )) => {\n        ( $(read_value!($parser, $t)),* )\n    };\n    ($parser:ident, [ $t:tt ; $len:expr ]) => {\n        (0..$len).map(|_| read_value!($parser, $t)).collect::<Vec<_>>()\n    };\n    ($parser:ident, chars) => {\n        read_value!($parser, String).chars().collect::<Vec<char>>()\n    };\n    ($parser:ident, char_) => {\n        read_value!($parser, String).chars().collect::<Vec<char>>()[0]\n    };\n    ($parser:ident, usize1) => {\n        read_value!($parser, usize) - 1\n    };\n    ($parser:ident, i64_) => {\n        $parser.fast_i64()\n    };\n    ($parser:ident, usize_) => {\n        $parser.fast_i64() as usize\n    };\n    ($parser:ident, usize1_) => {\n        ($parser.fast_i64() - 1) as usize\n    };\n    ($parser:ident, $t:ty) => {\n        $parser.next::<$t>().expect(\"Parse error\")\n    };\n}\n\nuse std::io;\nuse std::io::BufRead;\nuse std::str;\n\n// ref: tatsuya6502 <https://qiita.com/tatsuya6502/items/cd448486f7ef7b5b8c7e>\n// ref: wariuni <https://qiita.com/tatsuya6502/items/cd448486f7ef7b5b8c7e#comment-7040a5ae96305e884eb9>\n// diff: using std::io::BufRead::fill_buf()\npub struct Parser<R> {\n    pub reader: R,\n    buf: Vec<u8>,\n    pos: usize,\n}\n\nimpl Parser<io::Empty> {\n    pub fn from_str(s: &str) -> Parser<io::Empty> {\n        Parser {\n            reader: io::empty(),\n            buf: s.as_bytes().to_vec(),\n            pos: 0,\n        }\n    }\n}\n\nimpl<R: BufRead> Parser<R> {\n    pub fn new(reader: R) -> Parser<R> {\n        Parser {\n            reader: reader,\n            buf: vec![],\n            pos: 0,\n        }\n    }\n    pub fn update_buf(&mut self) {\n        self.buf.clear();\n        self.pos = 0;\n        loop {\n            let (len, complete) = {\n                let buf2 = self.reader.fill_buf().unwrap();\n                self.buf.extend_from_slice(buf2);\n                let len = buf2.len();\n                (len, buf2[len - 1] <= 0x20)\n            };\n            self.reader.consume(len);\n            if complete {\n                break;\n            }\n        }\n    }\n    pub fn next<T: str::FromStr>(&mut self) -> Result<T, T::Err> {\n        loop {\n            let mut begin = self.pos;\n            while begin < self.buf.len() && (self.buf[begin] <= 0x20) {\n                begin += 1;\n            }\n            let mut end = begin;\n            while end < self.buf.len() && (self.buf[end] > 0x20) {\n                end += 1;\n            }\n            if begin != self.buf.len() {\n                self.pos = end;\n                return unsafe { str::from_utf8_unchecked(&self.buf[begin..end]) }.parse::<T>();\n            } else {\n                self.update_buf();\n            }\n        }\n    }\n    pub fn fast_i64(&mut self) -> i64 {\n        loop {\n            let mut begin = self.pos;\n            while begin < self.buf.len() && (self.buf[begin] <= 0x20) {\n                begin += 1;\n            }\n            if begin == self.buf.len() {\n                self.update_buf();\n                continue;\n            }\n            let mut res = 0;\n            let (is_positive, mut end) = match self.buf[begin] {\n                b'+' => (true, begin + 1),\n                b'-' => (false, begin + 1),\n                _ => (true, begin),\n            };\n            while end < self.buf.len() && (self.buf[end] > 0x20) {\n                res = res * 10 + (self.buf[end] as i64 - '0' as i64);\n                end += 1;\n            }\n            if begin != self.buf.len() {\n                self.pos = end;\n                return if is_positive { res } else { -res };\n            } else {\n                self.update_buf();\n            }\n        }\n    }\n}\n\n#[allow(unused_imports)]\nuse std::cmp::*;\n\nfn main() {\n    input! {\n        new_stdin_parser = parser,\n    }\n    let res = solve(&mut parser);\n    print!(\"{}\", res);\n}\n\n/*------------------------------------------------------------------*/\n/*-------------------------- end template --------------------------*/\n/*------------------------------------------------------------------*/\n\nuse std::fmt::Write;\nfn solve<R: BufRead>(parser: &mut Parser<R>) -> String {\n    let mut buf = String::new();\n    input! {\n        parser = parser,\n    }\n    loop {\n        input! {\n            parser = parser,\n            n: usize,\n            m: usize,\n            t: usize,\n            p: usize,\n            xs: [(usize,usize); t],\n            ys: [(usize,usize); p],\n        }\n        if n == 0 && m == 0 && t == 0 && p == 0 {\n            break;\n        }\n        let mut res = vec![0; p];\n        for y in 0..m {\n            for x in 0..n {\n                let mut x = x;\n                let mut y = y;\n                for &(d, c) in &xs {\n                    if d == 1 {\n                        if x < c {\n                            x = c - x - 1;\n                        } else if x >= c {\n                            x = x - c;\n                        }\n                    } else if d == 2 {\n                        if y < c {\n                            y = c - y - 1;\n                        } else if y >= c {\n                            y = y - c;\n                        }\n                    }\n                }\n                for (i, &(x2, y2)) in ys.iter().enumerate() {\n                    if x == x2 && y == y2 {\n                        res[i] += 1;\n                    }\n                }\n            }\n        }\n        for i in 0..p {\n            writeln!(buf, \"{}\", res[i]);\n        }\n    }\n    buf\n}\n\n"
  }
]