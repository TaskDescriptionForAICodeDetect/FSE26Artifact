[
  {
    "language": "C++",
    "code": "#include <set>\n#include <iostream>\n#include <cstring>\n#include <cstdio>\n#define REP(i,n) for(int i=0; i<(int)(n); i++)\n\nint getInt(){\n  int ret = 0,c;\n  c = getchar();\n  while(!isdigit(c)) c = getchar();\n  while(isdigit(c)){\n    ret *= 10;\n    ret += c - '0';\n    c = getchar();\n  }\n  return ret;\n}\n\n#define MAX (100)\n\nusing namespace std;\n\nint T;\nint t[30];\nint n;\nint m[100];\nint memo[100][30];\n\nint solve(int dd, int tt){\n  if(dd == 100) return 0;\n  if(memo[dd][tt] != -1) return memo[dd][tt];\n\n  int ret = 100;\n  if(m[dd] >= t[tt]){\n    ret = min(ret, solve(dd + 1, (tt + 1) % T));\n  }\n  ret = min(ret, 1 + solve(dd + 1, 1 % T));\n  return memo[dd][tt] = ret;\n}\n\n\nint main(){\n  while(T = getInt()){\n    REP(i,100) m[i] = MAX;\n    REP(i,T) t[i] = getInt();\n    n = getInt();\n    memset(memo, -1, sizeof(memo));\n    REP(i,n){\n      int D = getInt();\n      int M = getInt();\n\n      m[D - 1] = min(m[D - 1], M);\n    }\n    int ans = solve(0, 0);\n    printf(\"%d\\n\", ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <utility>\nusing namespace std;\n\nint T, N;\nint t[35], ivs[110];\nint dp[110][110];\n\nconst int D = 100;\nconst int INF = 1 << 30;\n\nvoid chmin(int &a, int b) {\n    a = min(a, b);\n}\n\nint main() {\n    while(cin >> T, T) {\n        for(int i=0; i<T; i++) cin >> t[i];\n\n        cin >> N;\n        fill(ivs, ivs + D + 1, 24);\n        for(int i=0; i<N; i++) {\n            int day; cin >> day;\n            int tim; cin >> tim;\n            chmin(ivs[day], tim);\n        }\n\n        for(int i=0; i<=D; i++) {\n            for(int j=0; j<=D; j++) {\n                dp[i][j] = INF;\n            }\n        }\n\n        dp[0][0] = 0;\n        for(int i=1; i<=D; i++) {\n            // not use\n            for(int j=0; j<i; j++) {\n                int dist = i-j - (j == 0);\n                int wake = t[dist % T];\n                if(wake > ivs[i]) continue;\n                chmin(dp[i][j], dp[i-1][j]);\n            }\n\n            // use\n            chmin(dp[i][i], *min_element(dp[i-1], dp[i-1] + D + 1) + 1);\n        }\n\n        /*\n        for(int i=0; i<=N; i++) {\n            for(int j=0; j<=N; j++) {\n                printf(\"dp[%d][%d] = \", i, j);\n                if(dp[i][j] == INF) printf(\"INF\\n\");\n                else printf(\"%d\\n\", dp[i][j]);\n            }\n        }\n        */\n\n        cout << *min_element(dp[D], dp[D] + D + 1) << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\n#define MAX_N 100\n\nint t[MAX_N];\nint cycle[MAX_N];\nint dp[MAX_N][MAX_N];\nint T,N,a,b;\n\nint main(){\n\twhile(true){\n\t\tfor(int i=0;i<MAX_N;i++){\n\t\t\tt[i]=24;\n\t\t\tcycle[i]=0;\n\t\t\tfor(int j=0;j<MAX_N;j++){\n\t\t\t\tdp[i][j]=999999999;\n\t\t\t}\n\t\t}\n\t\tcin>>T;\n\t\tif(T==0){break;}\n\t\tfor(int i=1;i<=T;i++){cin>>cycle[i];}\n\t\tcin>>N;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tcin>>a>>b;\n\t\t\tt[a]=min(t[a],b);\n\t\t}\n\t\tdp[0][0]=0;\n\t\tfor(int i=0;i<MAX_N-1;i++){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tif(dp[i][j]<999999999){\n\t\t\t\t\tif(t[i+1]>=cycle[j+1]){\n\t\t\t\t\t\tdp[i+1][(j+1)%T]=min(dp[i+1][(j+1)%T],dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1]=min(dp[i+1][1],dp[i][j]+1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint minx=999999999;\n\t\tfor(int i=0;i<T;i++){\n\t\t\tminx=min(dp[MAX_N-1][i],minx);\n\t\t}\n\t\tcout<<minx<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <fstream>\n#include <iomanip>\n#include <iostream>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <valarray>\n#include <vector>\n\n#define EPS 1e-9\n#define INF 1070000000LL\n#define MOD 1000000007LL\n#define fir first\n#define foreach(it,X) for(__typeof((X).begin()) it=(X).begin();it!=(X).end();it++)\n#define ite iterator\n#define mp make_pair\n#define rep(i,n) rep2(i,0,n)\n#define rep2(i,m,n) for(int i=m;i<(n);i++)\n#define pb push_back\n#define sec second\n#define sz(x) ((int)(x).size())\n\nusing namespace std;\n\nstruct timer{\n\ttime_t start;\n\ttimer(){start=clock();}\n\t~timer(){cerr<<1.*(clock()-start)/CLOCKS_PER_SEC<<\" secs\"<<endl;}\n};\n\ntypedef istringstream iss;\ntypedef long long ll;\ntypedef pair<int,int> pi;\ntypedef stringstream sst;\ntypedef vector<int> vi;\n\nint T,t[33],d=100,h[111];\nint dp[111][33];\n\nint f(int cur,int cycle){\n\tint& res=dp[cur][cycle];\n\tif(res!=-1)return res;\n\tif(cur==d)return res=0;\n\tif(h[cur]<t[cycle])return res=INF;\n\treturn res=min(f(cur+1,(cycle+1)%T),1+f(cur+1,0));\n}\n\nint main(){\n\tcin.tie(0);\n\tios_base::sync_with_stdio(0);\n\t\n\tcin>>T;\n\trep(i,T)cin>>t[i];\n\trep(i,d)h[i]=INF;\n\tint N;\n\tcin>>N;\n\trep(i,N){\n\t\tint D,M;\n\t\tcin>>D>>M;\n\t\tD--;\n\t\th[D]=min(h[D],M);\n\t}\n\tmemset(dp,-1,sizeof(dp));\n\tcout<<f(0,0)<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nstatic const int INF = (1<<28);\n\nint T, t[30], N, D[100], M[100], dp[101][30];\n\nmain(){\n  while(cin >> T && T){\n    for(int i=0;i<T;i++) cin >> t[i];\n    cin >> N;\n    for(int i=0;i<N;i++) cin >> D[i] >> M[D[i]-1];\n    fill(dp[0], dp[101], INF);\n    dp[0][0] = 0;\n    for(int i=0;i<N;i++){\n      for(int j=0;j<T;j++){\n        if(t[j] <= M[i]) dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T], dp[i][j]);\n        dp[i+1][1] = min(dp[i+1][1], dp[i][j]+1);\n      }\n    }\n    int ans = INF;\n    for(int i=0;i<T;i++) ans = min(ans, dp[N][i]);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\nint table[30][100];\n#define INF 10000\nint solve(vector<int> &cyc,vector<int>& day){\n  rep(i,day.size())rep(j,cyc.size())table[j][i]=INF;\n  table[0][0]=0;\n  REP(i,1,day.size()){\n    table[0][i]=min(table[0][i-1]+1,table[cyc.size()-1][i-1]);\n    REP(j,1,cyc.size()){\n      table[0][i]=min(table[0][i],table[j][i-1]+1);//take caffein\n      if (day[i]>=cyc[j]){\n\ttable[j][i]=table[j-1][i-1];\n      }\n\n    }\n  }\n\n  /*\n  rep(i,cyc.size()){\n    rep(j,day.size())cout <<table[i][j]<<\" \";\n    cout << endl;\n  }\n  */\n\n  int ret=INF;\n  rep(i,cyc.size())ret=min(ret,table[i][day.size()-1]);\n  return ret;\n}\n\nmain(){\n  int n,m;\n  while(cin>>n && n){\n    vector<int> cyc,day(100,24);\n    rep(i,n){\n      int t;cin>>t;cyc.push_back(t);\n    }\n    \n    cin>>m;\n    rep(i,m){\n      int d,time;cin>>d>>time;\n      day[d-1]=min(day[d-1],time);\n    }\n    cout << solve(cyc,day)<<endl;\n  }\n  return false;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\n#define REP(i,n) for(ll i=0;i<n;++i)\n#define RREP(i,n) for(ll i=n-1;i>=0;--i)\n#define FOR(i,m,n) for(ll i=m;i<n;++i)\n#define RFOR(i,m,n) for(ll i=n-1;i>=m;--i)\n#define ALL(v) (v).begin(),(v).end()\n#define PB(a) push_back(a)\n#define UNIQUE(v) v.erase(unique(ALL(v)),v.end());\n#define DUMP(v) REP(aa, (v).size()) { cout << v[aa]; if (aa != v.size() - 1)cout << \" \"; else cout << endl; }\n#define INF 1000000001ll\n#define MOD 1000000007ll\n#define EPS 1e-9\n\nconst int dx[8] = { 1,1,0,-1,-1,-1,0,1 };\nconst int dy[8] = { 0,1,1,1,0,-1,-1,-1 };\n\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector<vi> vvi;\ntypedef vector<vl> vvl;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nll max(ll a, int b) { return max(a, ll(b)); }\nll max(int a, ll b) { return max(ll(a), b); }\nll min(ll a, int b) { return min(a, ll(b)); }\nll min(int a, ll b) { return min(ll(a), b); }\n///(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)///\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tint t;\n\twhile (cin >> t, t) {\n\t\tvi v(t);\n\t\tREP(i, t)cin >> v[i];\n\t\tint n; cin >> n;\n\t\tvi d(100,INF);\n\t\tREP(i, n) {\n\t\t\tint a, b;\n\t\t\tcin >> a >> b;\n\t\t\td[a - 1] = b;\n\t\t}\n\t\tint p = 100, cnt = 0;\n\t\twhile (p != 1) {\n\t\t\tREP(i, p) {\n\t\t\t\tint flag = 1;\n\t\t\t\tFOR(j, i, p) {\n\t\t\t\t\tif (v[(j-i)%t] > d[j])flag = 0;\n\t\t\t\t}\n\t\t\t\tif (flag) {\n\t\t\t\t\tp = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcnt++;\n\t\t}\n\t\tcout << cnt << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define rep1(i,n) for(int i=1;i<=(int)(n);i++)\n#define all(c) c.begin(),c.end()\n#define pb push_back\n#define fs first\n#define sc second\n#define show(x) cout << #x << \" = \" << x << endl\n#define chmin(x,y) x=min(x,y)\n#define chmax(x,y) x=max(x,y)\nusing namespace std;\nint T,t[30],N,m[101];\nint dp[101][30];\nint main(){\n\twhile(true){\n\t\tcin>>T;\n\t\tif(T==0) break;\n\t\trep(i,T) cin>>t[i];\n\t\tcin>>N;\n\t\trep(i,101) m[i]=25;\n\t\trep(i,N){\n\t\t\tint x,y;\n\t\t\tcin>>x>>y;\n\t\t\tchmin(m[x-1],y);\n\t\t}\n\t\trep(i,101) rep(j,T) dp[i][j]=1e9;\n\t\tdp[0][0]=0;\n\t\trep(i,100) rep(j,T){\n\t\t\tif(t[(j+1)%T]<=m[i+1]) chmin(dp[i+1][(j+1)%T],dp[i][j]);\n\t\t\tchmin(dp[i+1][0],dp[i][j]+1);\n\t\t}\n\t\tint ans=1e9;\n\t\trep(j,T) chmin(ans,dp[100][j]);\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n  int tm,n;\n  while(cin >> tm,tm){\n    int i,j,k;\n    int t[tm];\n    for(i=0;i<tm;i++) cin >> t[i];\n    cin >> n;\n    int d[n],m[n];\n    for(i=0;i<n;i++){\n      cin >> d[i] >> m[i];\n    }\n    int inf = 1<<20;\n    int dp[150][50];\n    fill(dp[0],dp[50],inf);\n    dp[0][0]=0;\n    for(i=0;i<n;i++){\n      for(j=0;j<50;j++){\n\tif(dp[i][j]==inf) continue;\n\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\tif(t[(j+d[i+1]-d[i])%tm]<=m[i]){\n\t  dp[i+1][(j+d[i+1]-d[i])%tm]=\n\t    min(dp[i+1][(j+d[i+1]-d[i])%tm],dp[i][j]);\n\t}\n      }\n    }\n    int o=inf;\n    for(i=0;i<tm;i++) o=min(o,dp[n][i]);\n    cout << o << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\nconst int INF = 1000000000;\n\nint main(){\n\tios_base::sync_with_stdio(false);\n\twhile(true){\n\t\tint T;\n\t\tcin >> T;\n\t\tif(T == 0){ break; }\n\t\tvector<int> t(T);\n\t\tfor(int i = 0; i < T; ++i){ cin >> t[i]; }\n\t\tint N;\n\t\tcin >> N;\n\t\tconst int M = 100;\n\t\tvector<int> req(M, 24);\n\t\tfor(int i = 0; i < N; ++i){\n\t\t\tint d, m;\n\t\t\tcin >> d >> m;\n\t\t\t--d;\n\t\t\treq[d] = min(req[d], m);\n\t\t}\n\t\tvector< vector<int> > dp(M, vector<int>(T, INF));\n\t\tdp[0][0] = 0;\n\t\tfor(int i = 0; i + 1 < M; ++i){\n\t\t\tfor(int j = 0; j < T; ++j){\n\t\t\t\tif(dp[i][j] >= INF){ continue; }\n\t\t\t\tdp[i + 1][0] = min(dp[i + 1][0], dp[i][j] + 1);\n\t\t\t\tconst int next = (j + 1) % T;\n\t\t\t\tif(t[next] > req[i + 1]){ continue; }\n\t\t\t\tdp[i + 1][next] = min(dp[i + 1][next], dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tint answer = INF;\n\t\tfor(int i = 0; i < T; ++i){\n\t\t\tanswer = min(answer, dp[M - 1][i]);\n\t\t}\n\t\tcout << answer << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nint main()\n{\n\tint T,N;\n\twhile(scanf(\"%d\", &T), T)\n\t{\n\t\tint cycle[30];\n\t\t\n\t\tfor(int i=0; i<T; i++)\n\t\t\tscanf(\"%d\", &cycle[i]);\n\t\n\t\tint day[101], maxd=0;\n\t\tfor(int i=0; i<101; i++)\n\t\t\tday[i]=999;\n\t\t\n\t\tscanf(\"%d\", &N);\n\t\t\n\t\tfor(int i=0; i<N; i++)\n\t\t{\n\t\t\tint d,m;\n\t\t\tscanf(\"%d%d\", &d,&m);\n\t\t\tday[d]=min(day[d], m);\n\t\t\tmaxd=max(d, maxd);\n\t\t}\n\t\t\n\t\tint ps[30];\n\t\t\n\t\tfor(int i=0; i<T; i++) ps[i]=99;\n\t\tps[0]=0;\n\t\t\n\t\tfor(int i=0; i<maxd; i++)\n\t\t{\n\t\t\tint t[30];\n\t\t\tfor(int j=0; j<T; j++) t[j]=99;\n\t\t\t\n\t\t\tfor(int j=0; j<T; j++)\n\t\t\t{\n\t\t\t\tif(j>i) continue;\n\t\t\t\tif(j!=T-1) t[0]=min(t[0], ps[j]+1);\n\t\t\t\t\n\t\t\t\tif(cycle[j]>day[i]) continue;\n\t\t\t\t\t\n\t\t\t\tt[(j+1)%T]=min(ps[j], t[(j+1)%T]);\n\t\t\t}\n\t\t\t\n\t\t\tfor(int j=0; j<T; j++) \n\t\t\t\tps[j]=t[j];\n\t\t}\n\t\t\n\t\tint ans=99;\n\t\tfor(int i=0; i<T; i++)\n\t\t\tans=min(ans, ps[i]);\n\t\t\t\n\t\tprintf(\"%d\\n\", ans);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n  int tm,n;\n  while(cin >> tm,tm){\n    int i,j,k;\n    int t[tm];\n    for(i=0;i<tm;i++) cin >> t[i];\n    cin >> n;\n    int m[150]={};\n    fill(m,m+150,24);\n    for(i=1;i<=n;i++){\n      cin >> k;\n      cin >> m[k];\n    }\n    int inf = 1<<20;\n    int dp[150][50];\n    fill(dp[0],dp[149],inf);\n    dp[1][0]=0;\n    for(i=1;i<=100;i++){\n      for(j=0;j<tm;j++){\n\tif(dp[i][j]==inf) continue;\n\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t//cout <<i<<\":\"<<j<<\":\"<< t[(j+1)%tm]<<\":\"<<m[i]<<endl;\n\tif(t[(j+1)%tm]<=m[i+1]){\n\t  dp[i+1][(j+1)%tm]=min(dp[i+1][(j+1)%tm],dp[i][j]);\n\t}\n\t\n      }\n    }\n    int o=inf;\n    /*\n    for(j=1;j<=n+10;j++){\n      cout << j << \":\";\n      for(i=0;i<tm;i++) cout << dp[j][i] << (i==tm-1?\"\\n\":\" \");\n    }\n    */\n    for(i=0;i<tm;i++) o=min(o,dp[101][i]);\n    cout << o << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nstatic const int INF = (1<<20);\n\nint T, t[30], N, D, M, dp[101][30], m[101];\n\nmain(){\n  while(cin >> T && T){\n    for(int i=0;i<T;i++) cin >> t[i];\n    cin >> N;\n    fill(m, m+101, INF);\n    for(int i=0;i<N;i++){\n      cin >> D >> M;\n      m[D-1] = min(m[D-1], M);\n    }\n    fill(dp[0], dp[101], INF);\n    dp[0][0] = 0;\n    for(int i=0;i<100;i++){\n      for(int j=0;j<T;j++){\n        if(t[j] <= m[i]){\n          dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T], dp[i][j]);\n          dp[i+1][0] = min(dp[i+1][0], dp[i][j]+1);\n        }\n      }\n    }\n    int ans = INF;\n    for(int i=0;i<T;i++) ans = min(ans, dp[100][i]);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nstruct UnionFind {\n\tvector<int> v;\n\tUnionFind(int n) : v(n) { for (int i = 0; i < n; i++) v[i] = i; }\n\tint  find(int x) { return v[x] == x ? x : v[x] = find(v[x]); }\n\tvoid unite(int x, int y) { v[find(x)] = find(y); }\n};\n\nint main() {\n\tint T;\n\twhile (cin >> T, T) {\n\t\tvi t(T);\n\t\tREP(i, T) {\n\t\t\tcin >> t[i];\n\t\t}\n\t\tint n;\n\t\tcin >> n;\n\t\tmap<int, int> inv;\n\t\tREP(i, n) {\n\t\t\tint a, b;\n\t\t\tcin >> a >> b;\n\t\t\tif(!EXIST(inv,a))\n\t\t\t\tinv[a] =b;\n\t\t\telse\n\t\t\t\tinv[a] = min(inv[a],b);\n\t\t}\n\t\tvvi dp(101, vi(T, 10000));\n\t\tdp[1][0] = 0;\n\t\tFOR(i, 2, 101) {\n\t\t\tREP(j, T) {\n\t\t\t\tif (j == 0) {\n\t\t\t\t\tREP(k, T)\n\t\t\t\t\t\tdp[i][j] = min(dp[i][j], dp[i - 1][k] + 1);\n\t\t\t\t}\n\n\t\t\t\tif (inv.find(i) == inv.end()) {\n\t\t\t\t\tif (i >= j)\n\t\t\t\t\t\tdp[i][j] = min(dp[i][j], dp[i - 1][(j + T - 1) % T]);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (i >= j&&t[j] <= inv[i])\n\t\t\t\t\t\tdp[i][j] = min(dp[i][j], dp[i - 1][(j + T - 1) % T]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans = 100000;\n\t\tREP(i, T)\n\t\t\tans = min(ans, dp[100][i]);\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nint main(){\n  int T;\n  while(cin >> T, T){\n    vector<int> t(T);\n    for(int i = 0; i < T; ++i){\n      cin >> t[i];\n    }\n    int N;\n    cin >> N;\n    int d, m;\n    vector< pair<int,int> > V;\n    for(int i = 0; i < N; ++i){\n      cin >> d >> m;\n      --d;\n      V.emplace_back(d,m);\n    }\n    sort(V.begin(), V.end());\n    int ans = -1, e = N;\n    while(e > 0){\n      for(int k = 0; k <= V[e-1].first; ++k){\n        int tmp = -1;\n        bool f = false;\n        for(int i = 0; i < e; ++i){\n          if(V[i].first < k) continue;\n          if(tmp == -1 && V[i].first >= k){\n            tmp = i;\n            f = true;\n          }\n          if(V[i].second < t[(V[i].first-k)%T]){\n            f = false;\n            break;\n          }\n        }\n        if(f){\n          e = tmp;\n          ++ans;\n        }\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <utility>\nusing namespace std;\n\nint T, N;\nint t[35];\npair<int, int> ivs[110];\nint dp[110][110];\nint INF = 1 << 30;\n\nvoid chmin(int &a, int b) {\n    a = min(a, b);\n}\n\nint main() {\n    while(cin >> T, T) {\n        for(int i=0; i<T; i++) cin >> t[i];\n        cin >> N;\n\n        ivs[0] = make_pair(1, 24);\n        for(int i=0; i<N; i++) cin >> ivs[i+1].first >> ivs[i+1].second;\n        sort(ivs + 1, ivs + N + 1);\n\n        for(int i=0; i<=N; i++) {\n            for(int j=0; j<=N; j++) {\n                dp[i][j] = INF;\n            }\n        }\n\n        dp[0][0] = 0;\n        for(int i=1; i<=N; i++) {\n            // not use\n            for(int j=0; j<i; j++) {\n                int dist = ivs[i].first - ivs[j].first;\n                int wake = t[dist % T];\n                if(wake > ivs[i-1].second) continue;\n                chmin(dp[i][j], dp[i-1][j]);\n            }\n\n            // use\n            chmin(dp[i][i], *min_element(dp[i-1], dp[i-1] + N + 1) + 1);\n        }\n\n        /*\n        for(int i=0; i<=N; i++) {\n            for(int j=0; j<=N; j++) {\n                printf(\"dp[%d][%d] = \", i, j);\n                if(dp[i][j] == INF) printf(\"INF\\n\");\n                else printf(\"%d\\n\", dp[i][j]);\n            }\n        }\n        */\n\n        cout << *min_element(dp[N], dp[N] + N + 1) << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<cassert>\nusing namespace std;\n \nint main()\n{\n  int T,N;\n  while(cin >> T,T)\n    {\n      vector<int> t(T+1);\n      for(int i=0;i<T;i++)\n\tcin >> t[i];\n      cin >> N;\n \n      vector<int> D(101);\n      for(int i=0;i<101;i++)\n\tD[i] = (1<<29);\n \n      int mexday = 0;\n      for(int i=0;i<N;i++)\n\t{\n\t  int d,m;\n\t  cin >> d >> m;\n\t  D[d] = min(D[d],m);\n\t  mexday = max(mexday,d);\n\t}\n    \n      int dayMin[mexday+1];\n      int dp[T][mexday+1];\n      for(int i=0;i<T;i++)\n\tfor(int j=0;j<=mexday;j++)\n\t  dp[i][j] = dayMin[j] = (1<<29);\n \n      dp[0][1] = 0;\n      dayMin[1] = dp[0][1];\n \n      for(int i=2;i<=mexday;i++)\n\t{\n\t  for(int j=0;j<min(i+1,T);j++)\n\t    {\n\t      if(!j)\n\t\t{\n\t\t  dp[j][i] = min(dp[j][i],dayMin[i-1]+1); \n\t\t  dp[j][i] = min(dp[j][i],dp[T-1][i-1]+(D[i]>=t[j]?0:1));\n\t\t  dayMin[i] = min(dp[j][i],dayMin[i]);\n\t\t  continue;\n\t\t}\n\t      if(dp[j-1][i-1] == (1<<29))\n\t\tcontinue;\n\t    \n\t      if(D[i]>=t[j])\n\t\tdp[j][i] = min(dp[j][i],dp[j-1][i-1]);\n\t      else\n\t\tdp[0][i] = min(dp[0][i],dp[j][i]+1);\n\t      dayMin[i] = min(dp[j][i],dayMin[i]);      \n\t    }\n\t}\n     \n      int ans = (1<<29);\n      for(int i=0;i<T;i++)\n\tans = min(ans,dp[i][mexday]);\n      assert(ans != (1<<29));\n      cout << ans << endl;\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <sstream>\n#include <map>\n#include <set>\n\n#define REP(i,k,n) for(int i=k;i<n;i++)\n#define rep(i,n) for(int i=0;i<n;i++)\n#define INF 1<<30\n#define pb push_back\n#define mp make_pair\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nint main() {\n\tint t;\n\twhile(cin >> t && t) {\n\n\t\tvector<int> v(t);\n\t\trep(i, t) cin >> v[i];\n\n\t\tint n;\n\t\tcin >> n;\n\n\t\tvector<int> d(n), m(n);\n\t\tint dm[105], day = 0;\n\t\trep(i, 105) dm[i] = INF;\n\n\t\trep(i, n) {\n\t\t\tcin >> d[i] >> m[i];\n\t\t\tdm[d[i]-1] = min(dm[d[i]-1], m[i]);\n\t\t\tday = max(day, d[i]);\n\t\t}\n\n\t\tint dp[105][35];\n\t\trep(i, 105) rep(j, 35) dp[i][j] = INF;\n\n\t\tdp[0][0] = 0;\n\n\t\tREP(i, 1, day) {\n\t\t\trep(j, t) {\n\t\t\t\tif(j == 0) {\n\t\t\t\t\trep(k, t) {\n\t\t\t\t\t\tdp[i][j] = min(dp[i][j], dp[i-1][k] + 1);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i][j] = min(dp[i][j], dp[i-1][t-1]);\n\t\t\t\t} else {\n\t\t\t\t\tif(v[j] <= dm[i]) {\n\t\t\t\t\t\tdp[i][j] = min(dp[i][j], dp[i-1][j-1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// cout << \" ------ i: \" << i << \" \" << dm[i] << endl;\n\t\t\t// rep(j, t) cout << v[j] << \" \";\n\t\t\t// cout << endl;\n\t\t\t// rep(j, day) {\n\t\t\t// \trep(k, t) {\n\t\t\t// \t\tif(dp[j][k] == INF) cout << \"X \";\n\t\t\t// \t\telse cout << dp[j][k] << \" \";\n\t\t\t// \t}\n\t\t\t// \tcout << endl;\n\t\t\t// }\n\t\t}\n\n\t\tint ans = INF;\n\t\trep(i, t) {\n\t\t\tans = min(ans, dp[day-1][i]);\n\t\t}\n\n\t\t// rep(i, day+1) {\n\t\t// \trep(j, t) {\n\t\t// \t\tif(dp[i][j] == INF) cout << \"X \";\n\t\t// \t\telse cout << dp[i][j] << \" \";\n\t\t// \t}\n\t\t// \tcout << endl;\n\t\t// }\n\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef vector<int> vec;\ntypedef vector<vec> mat;\n\nconst int INF = 1 << 28;\n\nint N, T;\n\nvoid solve() {\n    vec t(T);\n    for (auto& i : t) cin >> i;\n    cin >> N;\n    vec d(N), h(N);\n    for (int i = 0; i < N; i++) {\n        cin >> d[i] >> h[i];\n        d[i]--;\n    }\n\n    vec times(101, INF);\n    for (int i = 0; i < N; i++) {\n        times[d[i]] = min(times[d[i]], h[i]);\n    }\n\n    mat dp(101, vec(T, INF));\n    dp[0][0] = 0;\n    for (int i = 0; i < 100; i++) {\n        for (int j = 0; j < T; j++) {\n            if (dp[i][j] == INF) continue;\n            int next = (j + 1) % T;\n            // use\n            dp[i+1][0] = min(dp[i+1][0], dp[i][j] + 1);\n            // do not using\n            if (t[next] <= times[i+1]) {\n                dp[i+1][next] = min(dp[i+1][next], dp[i][j]);\n            }\n        }\n    }\n\n    int ans = INF;\n    for (int i = 0; i < T; i++) {\n        ans = min(ans, dp[100][i]);\n    }\n\n    cout << ans << endl;\n}\n\nint main() {\n    while (cin >> T, T) solve();\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#define INF 1e9\nusing namespace std;\n\n\nint main() {\n  while(1){\n    int T,cir[31],n;\n    cin >> T;\n    if(!T)break;\n    for(int i=0;i<T;i++) cin>>cir[i];\n    cin>>n;\n    int d,h,job[102]={},dp[102][102]={};\n    for(int i=0;i<102;i++)for(int j=0;j<102;j++)dp[i][j]=job[i]=INF;\n    for(int i=0;i<n;i++)cin>>d>>h,job[d]=min(job[d],h);\n\n    dp[0][0]=0;\n    for(int i=0;i<=100;i++)\n      for(int j=0;j<T;j++){\n\tdp[i+1][1]=min(dp[i+1][1],dp[i][j]+1);\n\tif(cir[j]<=job[i+1])dp[i+1][(j+1)%T]=min(dp[i+1][(j+1)%T],dp[i][j]);\n      }\n\n    int ans=INF;\n    for(int i=0;i<n;i++)ans=min(ans,dp[101][i]);\n    cout <<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\nusing lint = long long;\nusing ldouble = long double;\n\nconst int INF = 1 << 30;\n\nbool solve() {\n    int T;\n    cin >> T;\n    if (T == 0) return false;\n\n    vector<int> P(T);\n    for (auto& p : P) cin >> p;\n\n    int N;\n    cin >> N;\n    vector<int> M(100, 24);\n    for (int i = 0; i < N; ++i) {\n        int D;\n        cin >> D;\n        cin >> M[--D];\n    }\n\n    vector<int> dp(N, INF);\n    dp[0] = 0;\n    // dp[t] = t番目の周期にいるときのカフェインの最小値\n\n    for (int d = 0; d < 100; ++d) {\n        for (int t = 0; t < T; ++t) {\n            if (P[t] > M[d]) dp[t] = INF;\n        }\n\n        rotate(dp.begin(), --dp.end(), dp.end());\n        dp[0] = min(dp[0], *min_element(dp.begin(), dp.end()) + 1);\n    }\n\n    cout << *min_element(dp.begin(), dp.end()) << endl;\n    return true;\n}\n\nint main() {\n    while (solve()) {}\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#define INF (1e9)\n#define T_MAX 30\n#define D 100\nusing namespace std;\n\nint main(){\n  int T,t[T_MAX],N,d[D],id,im,dp[D][T_MAX],dmax,ans;\n  while(1){\n    cin>>T;\n    if(!T) break;\n    for(int i=0;i<T;i++) cin>>t[i];\n    for(int i=0;i<D;i++) d[i]=INF;\n    cin>>N;\n    dmax=0;\n    while(N--){\n      cin>>id>>im;\n      d[id-1]=min(d[id-1],im);\n      dmax=max(dmax,id-1);\n    }\n    for(int i=0;i<=dmax;i++)\n      for(int j=0;j<T;j++) dp[i][j]=INF;\n    dp[0][0]=0;\n    for(int i=0;i<dmax;i++){\n      for(int j=0;j<T;j++){\n\tif(dp[i][j]==INF) continue;\n\tif(t[0]<=d[i+1]){\n\t  dp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t  if(j==T-1) dp[i+1][0]=min(dp[i+1][0],dp[i][j]);\n\t}\n\tif(j!=T-1&&t[j+1]<=d[i+1]) dp[i+1][j+1]=min(dp[i+1][j+1],dp[i][j]);\n      }\n    }\n    ans=INF;\n    for(int i=0;i<T;i++) ans=min(ans,dp[dmax][i]);\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n    while(true){\n        int T;\n        cin>>T;\n        if(T==0) break;\n        vector<int> t(T);\n        for(int i=0;i<T;i++) cin>>t[i];\n        int n;\n        cin>>n;\n        vector<int> d(n),m(n);\n        for(int i=0;i<n;i++) cin>>d[i]>>m[i];\n\n        vector<int> wake(101,23);\n        for(int i=0;i<n;i++) wake[d[i]]=min(wake[d[i]],m[i]);\n        vector<vector<int>> dp(102,vector<int>(T,1000));\n        dp[0][0]=0;\n        for(int i=0;i<=100;i++){\n            for(int j=0;j<T;j++){\n                if(t[j]<=wake[i]) dp[i+1][(j+1)%T]=min(dp[i+1][(j+1)%T],dp[i][j]);\n                dp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n            }\n        }\n        cout<<*min_element(dp[101].begin(),dp[101].end())<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef long double ld;\nconst ld eps=1e-8;\nint main() {\n\tint t; \n\twhile (cin >> t, t) {\n\t\tint Cyc[30];\n\t\trep(i, t) {\n\t\t\tcin >> Cyc[i];\n\t\t}\n\t\tint cyc[120];\n\t\trep(i, 120) {\n\t\t\tcyc[i] = Cyc[i%t];\n\t\t}\n\t\tint n; cin >> n;\n\t\tint view[100];\n\t\tfill(view, view + 100, 24);\n\t\trep(i, n) {\n\t\t\tint d, m; cin >> d >> m; d--;\n\t\t\tview[d] = min(view[d], m);\n\t\t}\n\t\tint dp[101][101];\n\t\trep(i, 101) {\n\t\t\trep(j, 101) {\n\t\t\t\tdp[i][j] = (int)MOD;\n\t\t\t}\n\t\t}\n\t\tdp[0][0] = 0;\n\t\tRep(i, 1, 100) {\n\t\t\trep(j, i) {\n\t\t\t\tif (dp[j][i - 1] == (int)MOD)continue;\n\t\t\t\tint dif = i - j;\n\t\t\t\tif (cyc[dif] <= view[i]) {\n\t\t\t\t\tdp[j][i] = min(dp[j][i], dp[j][i - 1]);\n\t\t\t\t}\n\t\t\t\tdp[i][i] = min(dp[i][i], dp[j][i - 1] + 1);\n\t\t\t}\n\t\t}\n\t\tint mi = (int)MOD;\n\t\trep(i, 100) {\n\t\t\tmi = min(mi, dp[i][99]);\n\t\t}\n\t\tcout << mi << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P> PP;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nint main(){\n  int cycle_length,interview_num;\n  int cycle[100];\n  map<int,vector<int> > interview;\n\n  while(~scanf(\"%d\",&cycle_length)){\n    if(cycle_length == 0) break;\n    for(int i=0;i<cycle_length;i++){\n      scanf(\"%d\",cycle+i);\n    }\n    scanf(\"%d\",&interview_num);\n  \n    int last_day = 0;\n    for(int i=0;i<interview_num;i++){\n      int day,start_hour;\n      scanf(\"%d %d\",&day,&start_hour);\n      interview[day].push_back(start_hour);\n      last_day = max(day,last_day);\n    }\n\n    //dp[day][cycle_idx] = min_cost\n    int dp[101][100];\n    memset(dp,0x3f,sizeof(dp));\n\n    //init\n    dp[1][0] = 0;\n    for(int i=0;i<cycle_length;i++){\n      dp[0][i] = 0;\n    }\n\n    for(int day=1;day<=last_day;day++){\n      for(int cycle_idx=0;cycle_idx < cycle_length; cycle_idx++){\n\tfor(int hour_idx=0;hour_idx<interview[day].size();hour_idx++){\n\t  int start_hour = interview[day][hour_idx];\n\t  if(cycle[(cycle_idx+1)%cycle_length] <= start_hour){\n\t    dp[day][(cycle_idx+1)%cycle_length]\n\t      = min(dp[day-1][cycle_idx],dp[day][(cycle_idx+1)%cycle_length]);\n\t  }\n\t  dp[day][0] = min(dp[day-1][cycle_idx]+1,dp[day][0]);\n\t}\n      }\n    }\n  \n    int min_v = INF;\n    for(int i=0;i<cycle_length;i++){\n      min_v = min(dp[last_day][i],min_v);\n    }\n    printf(\"%d\\n\",min_v);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\n#define\trep(i,n)\tfor(int i=0;i<n;i++)\n\nusing namespace std;\n\nconst int INF=1<<29;\n\nint main(){\n\tfor(int T;scanf(\"%d\",&T),T;){\n\t\tint t[30];\n\t\trep(i,T)\tscanf(\"%d\",t+i);\n\t\tint n;\tscanf(\"%d\",&n);\n\t\tint sche[100];\n\t\trep(i,n)\tsche[i]=INF;\n\t\t{\n\t\t\tint d,m;\n\t\t\trep(i,n){\n\t\t\t\tscanf(\"%d%d\",&d,&m);\n\t\t\t\tsche[d-1]=m;\n\t\t\t}\n\t\t}\n\n\t\tint dp[100][30];\n\t\trep(j,T)\tdp[0][j]=(j==0?0:INF);\n\t\tfor(int i=1;i<n;i++){\n\t\t\tdp[i][0]=dp[i-1][T-1];\n\t\t\trep(j,T-1)\tdp[i][0]=min(dp[i][0],dp[i-1][j]+1);\n\t\t\tfor(int j=1;j<T;j++){\n\t\t\t\tif(sche[i]<t[j])\tdp[i][j]=INF;\n\t\t\t\telse\t\t\t\tdp[i][j]=dp[i-1][j-1];\n\t\t\t}\n\t\t}\n\n\t\tint ans=INF;\n\t\trep(j,T)\tans=min(ans,dp[n-1][j]);\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)(n); ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cerr<<*i<<\" \"; cerr<<endl; }\ninline bool valid(int x, int y, int W, int H){ return (x >= 0 && y >= 0 && x < W && y < H); }\n\ntypedef long long ll;\nconst int INF = 100000000;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\nint dx[8] = {1, 0, -1, 0, 1, -1, -1, 1};\nint dy[8] = {0, 1, 0, -1, 1, 1, -1, -1};\n\nint main(){\n  int T;\n  while(cin>>T && T){\n    int t[30];\n    REP(i, T) cin>>t[i];\n    int start[100] = {};\n    fill(start, start + 100, 24);\n    int N;\n    cin>>N;\n    REP(i, N){\n      int D, M;\n      cin>>D>>M;\n      start[D - 1] = min(start[D - 1], M);\n    }\n    int dp[101][30] = {};\n    REP(i, 101)REP(j, 30) dp[i][j] = INF;\n    dp[0][T - 1] = 0;\n    REP(i, 100){\n      REP(from, T){\n        int to = (from + 1) % T;\n        if(t[to] <= start[i]){\n          dp[i + 1][to] = min(dp[i + 1][to], dp[i][from]);\n        }\n        dp[i + 1][0] = min(dp[i + 1][0], dp[i][from] + 1);\n      }\n    }\n    int ans = INF;\n    REP(i, T) ans = min(ans, dp[100][i]);\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint INF = 1000;\nint main(){\n  while (1){\n    int T;\n    cin >> T;\n    if (T == 0){\n      break;\n    }\n    vector<int> t(T);\n    for (int i = 0; i < T; i++){\n      cin >> t[i];\n    }\n    int N;\n    cin >> N;\n    vector<int> t2(101, 24);\n    for (int i = 0; i < N; i++){\n      int D, M;\n      cin >> D >> M;\n      t2[D - 1] = min(t2[D - 1], M);\n    }\n    vector<int> dp(101, INF);\n    dp[0] = 0;\n    for (int i = 1; i < 101; i++){\n      if (t2[i] >= t[i % T]){\n        dp[i] = 0;\n      } else {\n        dp[i] = 0;\n        break;\n      }\n    }\n    for (int i = 1; i < 101; i++){\n      for (int j = 0; j < i; j++){\n        bool ok = true;\n        for (int k = j; k < i; k++){\n          if (t2[k] < t[(k - j) % T]){\n            ok = false;\n          }\n        }\n        if (ok){\n          dp[i] = min(dp[i], dp[j] + 1);\n        }\n      }\n    }\n    cout << dp[100] << endl;\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <string>\n#include <sstream>\n#include <stack>\n#include <algorithm>\n#include <cmath>\n#include <queue>\n#include <map>\n#include <set>\n#include <cstdlib>\n#include <bitset>\n#include <tuple>\n#include <assert.h>\n#include <deque>\n#include <bitset>\n#include <iomanip>\n#include <limits>\n#include <chrono>\n#include <random>\n#include <array>\n#include <unordered_map>\n#include <functional>\n#include <complex>\n#include <numeric>\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\n\nconstexpr long long MAX = 5100000;\nconstexpr long long INF = 1LL << 60;\nconstexpr int inf = 1 << 28;\nconstexpr long long mod = 1000000007LL;\n//constexpr long long mod = 998244353LL;\n\nusing namespace std;\ntypedef unsigned long long ull;\ntypedef long long ll;\n\nvoid solve() {\n\tll T; scanf(\"%lld\", &T); if (T == 0) exit(0);\n\tvector<ll> t(T); for (int i = 0; i < T; i++) scanf(\"%lld\", &t[i]);\n\tll N; scanf(\"%lld\", &N);\n\tvector<ll> work(101, 24);\n\tfor (int i = 0; i < N; i++) {\n\t\tll d, m; scanf(\"%lld %lld\", &d, &m);\n\t\tchmin(work[d], m);\n\t}\n\tvector<vector<ll>> dp(101, vector<ll>(T, INF));\n\tdp[0][0] = 0;\n\tfor (int i = 1; i <= 100; i++) {\n\t\tfor (int j = 0; j < T; j++) {\n\t\t\tif (work[i] >= t[j]) chmin(dp[i][(j + 1) % T], dp[i - 1][j]);\n\t\t\tchmin(dp[i][1 % T], dp[i - 1][j] + 1);\n\t\t}\n\t}\n\tcout << *min_element(dp[100].begin(), dp[100].end()) << \"\\n\";\n}\n\nint main()\n{\n\t/*\n\tcin.tie(nullptr);\n\tios::sync_with_stdio(false);\n\t*/\n\n\tint kkt = 89;\n\twhile (kkt) {\n\t\tsolve();\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<queue>\n\nusing namespace std;\n\ntypedef pair<int,int> P;\nconst int MAX = 101;\nconst int H = 31;\nconst int INF = (1<<25);\n\nstruct State{\n  int t,day,pos;\n  State(){}\n  State(int t, int day, int pos):t(t),day(day),pos(pos){}\n  bool operator < (const State& s) const {return t > s.t;}\n};\n\nint T[H][MAX];\nvector<int> Habit,V[MAX];\nint N;\n\nvoid init(){\n  Habit.clear();\n  for(int i = 0; i < MAX; i++) V[i].clear();\n  fill(T[0],T[0]+H*MAX,INF);\n}\n\nvoid input(){\n  Habit.resize(N);\n  for(int i = 0; i < N; i++)\n    cin >> Habit[i];\n\n  int m;\n  cin >> m;\n  for(int i = 0; i < m; i++){\n    int a,b;\n    cin >> a >> b;\n    V[a].push_back(b);\n  }\n \n  for(int i = 0; i < MAX; i++) sort(V[i].begin(),V[i].end());\n\n}\n\nvoid solve(){\n  priority_queue<State> Q;\n  Q.push(State(0,0,-1));\n  T[0][0] = 0;\n\n  while(!Q.empty()){\n    State now = Q.top();\n    Q.pop();\n    if(T[now.pos][now.day] < now.t) continue;\n    if(now.day >= MAX-1) break;\n\n    //use caffeine\n    State nex = now;\n    nex.day++;\n    nex.pos = 0;\n    nex.t++;\n    if(V[nex.day].size() == 0){\n      if(T[nex.pos][nex.day] > nex.t){\n\tT[nex.pos][nex.day] = nex.t;\n\tQ.push(nex);\n      }\n    }else if(V[nex.day][0] >= Habit[nex.pos] && T[nex.pos][nex.day] > nex.t){\n      T[nex.pos][nex.day] = nex.t;\n      Q.push(nex);\n    }\n\n    //do not use caffeine\n    nex = now;\n    nex.day++;\n    nex.pos = (nex.pos+1)%Habit.size();\n    if(V[nex.day].size() == 0){\n      if(T[nex.pos][nex.day] > nex.t){\n\tT[nex.pos][nex.day] = nex.t;\n\tQ.push(nex);\n      }\n    }else if(V[nex.day][0] >= Habit[nex.pos] && T[nex.pos][nex.day] > nex.t){\n      T[nex.pos][nex.day] = nex.t;\n      Q.push(nex);\n    }\n  }\n\n  int ans = INF;\n\n  for(int i = 0; i < H; i++)\n    ans = min(ans,T[i][MAX-1]);\n\n  cout << ans << endl;\n}\n\n\nint main(){\n  while(cin >> N && N){\n    init();\n    input();\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\nusing lint = long long;\nusing ldouble = long double;\n\nconst int INF = 1 << 30;\n\nbool solve() {\n    int T;\n    cin >> T;\n    if (T == 0) return false;\n\n    vector<int> P(T);\n    for (auto& p : P) cin >> p;\n\n    int N;\n    cin >> N;\n    vector<int> M(100, 24);\n    for (int i = 0; i < N; ++i) {\n        int D;\n        cin >> D;\n        --D;\n\n        int m;\n        cin >> m;\n        M[D] = min(M[D], m);\n    }\n\n    vector<int> dp(T, INF);\n    dp[0] = 0;\n    // dp[t] = t番目の周期にいるときのカフェインの最小値\n\n    for (int d = 0; d < 100; ++d) {\n        for (int t = 0; t < T; ++t) {\n            if (P[t] > M[d]) dp[t] = INF;\n        }\n\n        rotate(dp.begin(), dp.end() - 1, dp.end());\n        dp[0] = min(dp[0], *min_element(dp.begin(), dp.end()) + 1);\n    }\n\n    cout << *min_element(dp.begin(), dp.end()) << endl;\n    return true;\n}\n\nint main() {\n    while (solve()) {}\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 29;\n\nint t[33];\nint d[110];\n\nint dp[110][33];\n\nint main(void){\n\tint T,N;\n\twhile(cin >> T){\n\t\tif(T==0)\n\t\t\tbreak;\n\t\trep(i,T) cin >> t[i];\n\t\trep(i,110) d[i]=24;\n\t\trep(i,110)rep(j,33) dp[i][j]=inf;\n\t\tcin >> N;\n\t\trep(i,N){\n\t\t\tint D,M;\n\t\t\tcin >> D >> M;\n\t\t\tD--;\n\t\t\td[D]=min(d[D],M);\n\t\t}\n\t\tdp[0][0]=0;\n\t\trep(i,100){\n\t\t\tfor(int j=1;j<T;++j){\n\t\t\t\tif(t[j]<=d[i])\n\t\t\t\t\tdp[i+1][(j+1)%T]=min(dp[i+1][(j+1)%T],dp[i][j]);\n\t\t\t\tdp[i][0]=min(dp[i][0],dp[i][j]+1);\n\t\t\t}\n\t\t\tdp[i+1][1]=min(dp[i+1][1],dp[i][0]);\n\t\t}\n\t\tint ans=inf;\n\t\trep(i,T) ans=min(ans,dp[100][i]);\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\n#define int long long\nusing namespace std;\ntypedef pair<int, int> P;\nconst int INF = 1e9;\n\nint T, N;\nvector<int> t;\nvector<P> d;\n\nint memo[110];\n\nint solve(int idx){\n    if(memo[idx] != -1) return memo[idx];\n    if(idx == N) return 0;\n    int res = INF;\n    int startDay = d[idx].first;\n    rep(i, idx, N){\n        int tmp = solve(idx + 1);\n        res = min(res, tmp);\n        int nowDay = d[i].first;\n        int wake = t[(nowDay - startDay) % T];\n        if(wake > d[i].second) break;\n    }\n    return memo[idx] = res + 1;\n}\n\nsigned main(){\n    while(cin >> T, T){\n        t.clear(); d.clear();\n        t.resize(T);\n        rep(i, 0, T) cin >> t[i];\n        cin >> N;\n        d.resize(N);\n        memset(memo, -1, sizeof(memo));\n        rep(i, 0, N){\n            cin >> d[i].first >> d[i].second;\n        }\n        sort(d.begin(), d.end());\n        int ans = solve(0);\n        cout << ans - 1 << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\n#define int long long\nusing namespace std;\ntypedef pair<int, int> P;\nconst int INF = 1e9;\n\nint T, N;\nvector<int> t;\nint wktm[110];\nint ed;\n\nint memo[110];\n\nint solve(int idx){\n    if(memo[idx] != -1) return memo[idx];\n    if(idx > ed) return 0;\n    int res = INF;\n    int startDay = idx;\n    rep(i, idx, ed + 1){\n        int nowDay = i;\n        int wake = t[(nowDay - startDay) % T];\n        // cout << idx << \" \" << i << ' ' << nowDay << \" \" << wake << endl;\n        if(wake > wktm[i]) break;\n        int wktmp = solve(i + 1);\n        res = min(res, wktmp);\n    }\n    // cout << idx << ' ' << res + 1 << endl;\n    return memo[idx] = res + 1;\n}\n\nsigned main(){\n    while(cin >> T, T){\n        t.clear();\n        t.resize(T);\n        rep(i, 0, T) cin >> t[i];\n        cin >> N;\n        memset(memo, -1, sizeof(memo));\n        rep(i, 0, 110) wktm[i] = INF;\n        rep(i, 0, N){\n            int a, b;\n            cin >> a >> b;\n            a--;\n            wktm[a] = min(wktm[a], b);\n        }\n        rep(i, 0, 110){\n            if(wktm[i] == INF) continue;\n            ed = i;\n            // cout << \" \" << i << \" \" << wktm[i] << endl;\n        }\n        int ans = solve(0);\n        cout << ans - 1 << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <cfloat>\n#include <stack>\n#include <queue>\n#include <vector>\ntypedef long long int ll;\n#define BIG_NUM 2000000000\n#define MOD 1000000007\n#define EPS 0.000001\nusing namespace std;\n\nint T,minimum,sleep[30],N,last_day,last_time,dp[101][30],pre_day,sche[101];\n\nint main(){\n\n\tint tmp_day,tmp_time;\n\n\twhile(true){\n\t\tscanf(\"%d\",&T);\n\t\tif(T == 0)break;\n\n\t\tfor(int i = 0; i < T; i++)scanf(\"%d\",&sleep[i]);\n\n\t\tscanf(\"%d\",&N);\n\n\t\tfor(int i = 0; i <= 100; i++)sche[i] = 0;\n\n\t\tfor(int i = 1; i <= N; i++){\n\t\t\tscanf(\"%d %d\",&tmp_day,&tmp_time);\n\t\t\tif(sche[tmp_day] != 0){\n\t\t\t\tsche[tmp_day] = min(sche[tmp_day],tmp_time);\n\t\t\t}else{\n\t\t\t\tsche[tmp_day] = tmp_time;\n\t\t\t}\n\t\t}\n\n\t\tfor(int i = 0; i <= 100; i++){\n\t\t\tfor(int k = 0; k < T; k++)dp[i][k] = BIG_NUM;\n\t\t}\n\n\t\tdp[1][0] = 0;\n\n\t\tfor(int day = 2; day <= 100; day++){\n\t\t\tfor(int cicle = 0; cicle < T; cicle++){\n\t\t\t\tif(dp[day-1][cicle] == BIG_NUM)continue;\n\n\t\t\t\tif(sche[day] >= sleep[(cicle+1)%T] || sche[day] == 0){\n\t\t\t\t\tdp[day][(cicle+1)%T] = min(dp[day][(cicle+1)%T],dp[day-1][cicle]);\n\t\t\t\t\tdp[day][0] = min(dp[day][0],dp[day-1][cicle]+1);\n\t\t\t\t}else{\n\t\t\t\t\tdp[day][0] = min(dp[day][0],dp[day-1][cicle]+1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tminimum = 200;\n\t\tfor(int i = 0; i < T; i++){\n\t\t\tminimum = min(minimum,dp[100][i]);\n\t\t}\n\n\t\tprintf(\"%d\\n\",minimum);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint T;\nint t[102];\nint N;\nint D[102],M[102];\nint max_d;\n\nmap<int,int> jobs;\nint dp[102][102];\n\n// a??\\??????b?????????????????????\nint dfs(int a,int b) {\n    if(a==max_d) return 0;\n    if(dp[a][b]!=-1) return dp[a][b];\n\n    int ret=INF;\n    ret=min(ret,dfs(a+1,0)+1);\n    if(t[b]<=jobs[a]) ret=min(ret,dfs(a+1,(b+1)%T));\n\n    return dp[a][b]=ret;\n}\n\nvoid solve() {\n    jobs.clear();\n    max_d=0;\n    rep(i,N) {\n        max_d=max(max_d,D[i]);\n        if(jobs.find(D[i])==jobs.end()) {\n            jobs[D[i]]=INF;\n        }\n        jobs[D[i]]=min(jobs[D[i]],M[i]);\n    }\n    memset(dp,-1,sizeof(dp));\n    cout<<dfs(0,0)<<endl;\n}\n\nint main() {\n    while(cin>>T) {\n        if(!T) break;\n        rep(i,T) cin>>t[i];\n        cin>>N;\n        rep(i,N) cin>>D[i]>>M[i];\n        solve();\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define SZ(x) (int)(x.size())\n#define REP(i, n) for(int i=0;i<(n);++i)\n#define FOR(i, a, b) for(int i=(a);i<(b);++i)\n#define RREP(i, n) for(int i=(int)(n)-1;i>=0;--i)\n#define RFOR(i, a, b) for(int i=(int)(b)-1;i>=(a);--i)\n#define ALL(a) a.begin(),a.end()\n#define DUMP(x) cerr<<#x<<\" = \"<<(x)<<endl\n#define DEBUG(x) cerr<<#x<<\" = \"<<(x)<<\" (L\"<<__LINE__<<\")\"<< endl;\nusing ll = long long;\nusing vi = vector<int>;\nusing vvi = vector<vi>;\nusing vll = vector<ll>;\nusing vvll = vector<vll>;\nusing P = pair<int, int>;\nconst double eps = 1e-8;\nconst ll MOD = 1000000007;\nconst int INF = INT_MAX / 2;\nconst ll LINF = LLONG_MAX / 2;\ntemplate <typename T1, typename T2>\nbool chmax(T1 &a, const T2 &b) {\n    if (a < b) { a = b; return true; }\n    return false;\n}\ntemplate <typename T1, typename T2>\nbool chmin(T1 &a, const T2 &b) {\n    if (a > b) { a = b; return true; }\n    return false;\n}\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const pair<T1, T2> &p) {\n    os << p.first << \":\" << p.second;\n    return os;\n}\ntemplate<typename T1, typename T2>\nostream &operator<<(ostream &os, const map<T1, T2> &mp) {\n    os << \"{\";\n    int a = 0;\n    for (auto &tp : mp) {\n        if (a) os << \", \"; a = 1;\n        os << tp;\n    }\n    return os << \"}\";\n}\ntemplate<typename T>\nostream &operator<<(ostream &os, const vector<T> &v) {\n    os << \"[\";\n    REP(i, SZ(v)) {\n        if (i) os << \", \";\n        os << v[i];\n    }\n    return os << \"]\";\n}\n\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(10);\n\n    for (;;) {\n        int T; cin >> T;\n        if (T == 0) break;\n        vi t(T);\n        REP(i, T) cin >> t[i];\n        int N; cin >> N;\n        vi d(N), m(N);\n        REP(i, N) {\n            cin >> d[i] >> m[i];\n        }\n        const int MAX = *max_element(ALL(d));\n        vi plan(MAX, 24);\n        REP(i, N) {\n            chmin(plan[d[i]-1], m[i]);\n        }\n\n        vvi dp(MAX+1, vi(T, INF));\n        dp[0][0] = 0;\n        REP(i, MAX) {\n            REP(j, T) {\n                if (dp[i][j] == INF) continue;\n                if (t[j] > plan[i]) continue;\n                chmin(dp[i+1][0], dp[i][j] + 1);\n                chmin(dp[i+1][(j+1) % T], dp[i][j]);\n            }\n        }\n        cout << *min_element(ALL(dp[MAX])) << endl;\n\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int INF = 1<<28;\nconst int MAXD = 111;\nconst int MAXT = 31;\nint T;\nint t[MAXT], F[MAXD];\nint dp[MAXD][MAXT];\n\nint main() {\n  for(; cin >> T && T; ) {\n    for(int i = 0; i < T; ++i) {\n      cin >> t[i];\n    }\n    int N; cin >> N;\n    fill(F, F+MAXD, INF);\n    for(int i = 0; i < N; ++i) {\n      int D; cin >> D;\n      cin >> F[D];\n    }\n    fill(dp[0], dp[MAXD], INF);\n    dp[1][0] = 0;\n    for(int i = 1; i+1 < MAXD; ++i) {\n      for(int j = 0; j < T; ++j) {\n        dp[i+1][1%T] = min(dp[i+1][1%T], dp[i][j] + 1);\n        if(t[j] <= F[i]) {\n          dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T], dp[i][j]);\n        }\n      }\n    }\n    cout << *min_element(dp[MAXD-1], dp[MAXD]) << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MOD DEKAI\n#define DEKAI (int)(1e9+7)\n#define rep(i,n) lps(i,0,n)\n#define lp(i,n) lps(i,0,n)\n#define lps(i,j,n) for(int i = j; i < n; i++)\nint x[101];\nint n;\nint a[50];\nint Mday;\n\nint check(int day){\n  int j=0;\n  lps(i,day,Mday+1){\n    //cout<<a[j]<<\" \"<<x[i]<<endl;\n    if(a[j]>x[i]) return i;\n    j++;\n    if(j==n) j=0;\n  }\n  return -1;\n}\n\n\nint main(){\n  while(1){\n    cin>>n;\n    if(n==0) break;\n    lp(i,n) cin>>a[i];\n    int q;\n    cin>>q;\n    lp(i,101) x[i]=-1;\n    int hoge=-1;\n    lp(i,q){\n      int d,m;\n      cin>>d>>m;\n      x[d]=m;\n      Mday=max(Mday,d);\n      hoge=max(hoge,m);\n    }\n    lp(i,n){\n      if(a[n-i-1]>hoge){\n\tn--;\n      }\n      else break;\n    }\n    int lastday=1;\n    int ans=0;\n    while(1){\n      int outday=check(lastday);\n      //cout<<\"    \"<<outday<<endl;\n      if(outday==-1) break;\n      ans++;\n      int memo=0;int count=0;\n      lp(i,n-1){\n\tif(count==10) break;\n\tcount++;\n\tint memo2=check(outday-i);\n\tif(memo2==-1){\n\t  memo=-1;\n\t  break;\n\t}\n\tif(memo<memo2) {\n\t  lastday=outday-i;\n\t  memo=memo2;\n\t}\n      }\n      if(memo==-1) break;\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define mp make_pair\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef pair<int,pii> pip;\ntypedef vector<pip>vip;\nconst double PI=acos(-1);\nconst double EPS=1e-8;\nconst int inf=1e8;\nint main(){\n\tint n;\n\twhile(cin>>n,n){\n\t\tvi t(n);\n\t\trep(i,n)cin>>t[i];\n\t\tint m;\n\t\tcin>>m;\n\t\tvi in(110);\n\t\twhile(m--){\n\t\t\tint a,b;\n\t\t\tcin>>a>>b;a--;\n\t\t\tin[a]=max(in[a],b);\n\t\t}\n\t\tvvi dp(110,vi(n,inf));\n\t\tdp[0][0]=0;\n\t\trep(i,109)for(int j=n-1;j>=0;j--){\n\t\t\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t\t\tif(in[i+1]==0||t[(j+1)%n]<=in[i+1])\n\t\t\t\tdp[i+1][(j+1)%n]=min(dp[i+1][(j+1)%n],dp[i][j]);\n\t\t}\n\t\tint mi=inf;\n\t\trep(i,n)mi=min(mi,dp[109][i]);\n\t\tcout<<mi<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\nusing namespace std;\n\nint T;\nint n;\nint ti[101];\nint d[101];\nint dp[101][31];\nint finD;\n\nconst int INF=1000000000;\nint dfs(int pos,int tm){\n\tif(pos==finD+1)return 0;\n\tif(dp[pos][tm]!=-1)return dp[pos][tm];\n\tint res=INF;\n\t// JtFCðùÞ\n\tres=min(res,dfs(pos+1,1%T)+1);\n\t// ÔÉ¤êÍAùÜÈ¢Æ¢¤Iðà è\n\tif(d[pos]==-1||d[pos]>=ti[tm])res=min(res,dfs(pos+1,(tm+1)%T));\n\treturn dp[pos][tm]=res;\n}\n\nint main(){\n\twhile(cin>>T&&T){\n\t\tfor(int i=0;i<T;i++)cin>>ti[i];\n\t\tcin>>n;\n\t\tmemset(dp,-1,sizeof(dp));\n\t\tmemset(d,-1,sizeof(d));\n\t\tfinD=0;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tint da,m;\n\t\t\tcin>>da>>m;\n\t\t\tfinD=max(finD,da);\n\t\t\tif(d[da]==-1)d[da]=m;\n\t\t\telse d[da]=min(d[da],m);\n\t\t}\n\t\tfor(int i=0;i<31;i++)dp[finD+1][i]=0;\n\t\tfor(int i=finD;i>=0;i--){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tdp[i][j]=INF;\n\t\t\t\tdp[i][j]=min(dp[i][j],dp[i+1][1%T]+1);\n\t\t\t\tif(d[i]==-1||d[i]>=ti[j])dp[i][j]=min(dp[i][j],dp[i+1][(j+1)%T]);\n\t\t\t}\n\t\t}\n\t\tint res=dp[1][0];\n\t\tcout<<res<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cassert>\n#include <cmath>\n#include <cstdio>\n#include <iomanip>\n#include <iostream>\n#include <queue>\n#include <stack>\n#include <utility>\n#include <vector>\nusing namespace std;\n\ntypedef pair<int, int> P;\n\nconst int INF = 1 << 30;\n\nint main(){\n    int T;\n    int t[30];\n    int N;\n    int itv[101], dp[101][31];\n    while(true){\n        scanf(\"%d\", &T);\n        if(T == 0) break;\n        for(int i = 0; i < T; i++){\n            scanf(\"%d\", t + i);\n        }\n        scanf(\"%d\", &N);\n        fill(itv, itv + 101, INF);\n        for(int i = 0; i < N; i++){\n            int a, b;\n            scanf(\"%d%d\", &a, &b);\n            --a;\n            itv[a] = min(itv[a], b);\n        }\n        for(int i = 0; i <= 100; i++){\n            fill(dp[i], dp[i] + 30, INF);\n        }\n        dp[0][0] = 0;\n        for(int i = 0; i < 100; i++){\n            for(int j = 0; j < T; j++){\n                dp[i+1][1] = min(dp[i+1][1], dp[i][j] + 1);\n                if(itv[i] >= t[j]){\n                    dp[i+1][(j + 1) % T] = min(dp[i+1][(j + 1) % T],\n                                               dp[i][j]);\n                }\n            }\n        }\n        int ans = INF;\n        for(int i = 0; i < T; i++){\n            ans = min(ans, dp[100][i]);\n        }\n        printf(\"%d\\n\", ans);\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\nusing lint = long long;\nusing ldouble = long double;\n\nconst int INF = 1 << 30;\n\nbool solve() {\n    int T;\n    cin >> T;\n    if (T == 0) return false;\n\n    vector<int> P(T);\n    for (auto& p : P) cin >> p;\n\n    int N;\n    cin >> N;\n    vector<int> M(100, 24);\n    for (int i = 0; i < N; ++i) {\n        int D;\n        cin >> D;\n        cin >> M[--D];\n    }\n\n    vector<int> dp(T, INF);\n    dp[0] = 0;\n    // dp[t] = t番目の周期にいるときのカフェインの最小値\n\n    for (int d = 0; d < 100; ++d) {\n        for (int t = 0; t < T; ++t) {\n            if (P[t] > M[d]) dp[t] = INF;\n        }\n\n        rotate(dp.begin(), dp.end() - 1, dp.end());\n        dp[0] = min(dp[0], *min_element(dp.begin(), dp.end()) + 1);\n    }\n\n    cout << *min_element(dp.begin(), dp.end()) << endl;\n    return true;\n}\n\nint main() {\n    while (solve()) {}\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<n;i++)\n#define INF 100000000\nusing namespace std;\n\nint T,N;\nint t[30],ti[101];\nint dp[101][30];\n\nint main(){\n\twhile(cin>>T,T){\n\t\trep(i,T)cin>>t[i];\n\t\trep(i,101)ti[i]=INF;\n\t\trep(i,101)rep(j,30)dp[i][j]=INF;\n\t\tdp[1][1]=1;\n\t\tcin>>N;\n\t\trep(i,N){\n\t\t\tint d,m;\n\t\t\tcin>>d>>m;\n\t\t\tti[d]=min(ti[d],m);\n\t\t}\n\t\tint ans=INF;\n\t\tfor(int i=2;i<=100;i++){\n\t\t\tif(ti[i]==INF){\n\t\t\t\trep(j,T)dp[i][(j+1)%T]=dp[i-1][j];\n\t\t\t\trep(j,T)dp[i][0]=min(dp[i][0],dp[i-1][j]+1);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\trep(j,T){\n\t\t\t\tdp[i][0]=min(dp[i][0],dp[i-1][j]+1);\n\t\t\t\tif(ti[i]>=t[(j+1)%T]){\n\t\t\t\t\tdp[i][(j+1)%T]=min(dp[i][(j+1)%T],dp[i-1][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\trep(i,T)ans=min(ans,dp[100][i]);\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <climits>\n#include <cassert>\nusing namespace std;\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\ntypedef long long ll;\n\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define FOR(i,a,b) for(int i=(a); i<(b); ++i)\n#define REP(i,n) FOR(i,0,n)\n\nconst int INF = INT_MAX/10;\n\nbool ok(int M, int t) {\n    return (t<=M);\n}\n\nint main() {\n\tint T;\n    while(cin >> T, T) {\n        vi ti(T);\n        REP(i, T) {\n            cin >> ti[i];\n\t    }\n\n        int N;\n        cin >> N;\n        vvi data(N, vi(2));\n        REP(i, N) {\n            cin >> data[i][0] >> data[i][1];\n\t    }\n        sort(ALL(data));\n        int dmax = data[N-1][0];\n    \n        vvi dp(dmax+1, vi(T+1, INF));\n        dp[1][1] = 0;\n\n        int dpos = 0;\n        if(data[0][0] == 1) {\n            dpos++;\n\t    }\n\n        FOR(dd, 2, dmax+1) {\n            FOR(tt, 1, T) {\n                dp[dd][1] = min(dp[dd][1], dp[dd-1][tt]+1);\n\t\t    }\n            dp[dd][1] = min(dp[dd][1], dp[dd-1][T]);\n\n            FOR(tt, 2, T+1) {\n                if(data[dpos][0] == dd) {\n                    if(ok(data[dpos][1], ti[tt-1])) {\n                        dp[dd][tt] = dp[dd-1][tt-1];\n\t\t\t\t    } else {\n                        dp[dd][tt] = INF;\n\t\t\t\t    }\n                } else {\n                    dp[dd][tt] = dp[dd-1][tt-1];\n\t\t\t    }\n\t\t    }\n\n            if(data[dpos][0] == dd) {\n                dpos++;\n\t\t\t}\n\n            if(dpos == N) {\n                break;\n\t\t    }\n\t    }\n\n        int ans = INF;\n        REP(t, T+1) {\n            ans = min(ans, dp[dmax][t]);\n\t    }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <map>\n#include <algorithm>\nusing namespace std;\nint T,N;\nint t[31];\ntypedef pair<int,int> P;\nP p[101];\n\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d\",&T);\n\t\tif(T==0)break;\n\t\tfor(int i=0;i<T;i++){\n\t\t\tscanf(\"%d\",&t[i]);\n\t\t}\n\t\tscanf(\"%d\",&N);\n\t\tfor(int i=0;i<N;i++){\n\t\t\tscanf(\"%d %d\",&p[i].first,&p[i].second);\n\t\t}\n\t\tsort(p,p+N);\n\t\tint cnt=0,prev=-1,cafe=0,turn=0;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(i>0 && p[i].first==p[i-1].first && p[i].second==p[i-1].second)continue;\n\t\t\tif(i==0){\n\t\t\t\tint k=(p[i].first-1)*24+p[i].second;\n\t\t\t\twhile(k>=24)k-=-24,turn=(turn+1)%T;\n\t\t\t\tif(k<t[turn]){\n\t\t\t\t\tcnt++;\n\t\t\t\t\tturn=0;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tint k=p[i].second;\n\t\t\t\tturn=(turn+(p[i].first-p[i-1].first))%T;\n\t\t\t\t//printf(\"%d %d\\n\",k,t[turn]);\n\t\t\t\tif(k<t[turn]){\n\t\t\t\t\tcnt++;\n\t\t\t\t\tturn=0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",cnt);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\nint n, m, t[33], a[103], e1, e2, dp[103][33];\nint main() {\n\twhile (cin >> n, n) {\n\t\tfill(a, a + 100, 24);\n\t\tfor (int i = 0; i < n; i++) cin >> t[i];\n\t\tcin >> m;\n\t\tfor (int i = 0; i < m; i++) cin >> e1 >> e2, e1--, a[e1] = min(a[e1], e2);\n\t\tfill(dp[1] + 1, dp[1] + n, 99999999);\n\t\tfor (int i = 2; i <= 100; i++) {\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tdp[i][j] = 999999999;\n\t\t\t\tif (j == 0) dp[i][j] = dp[i - 1][j] + 1;\n\t\t\t\tif (a[i - 1] >= t[j]) dp[i][j] = min(dp[i][j], dp[i - 1][(j + n - 1) % n]);\n\t\t\t}\n\t\t}\n\t\tint ret = *min_element(dp[100], dp[100] + n);\n\t\tcout << ret << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)(n); ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cerr<<*i<<\" \"; cerr<<endl; }\ninline bool valid(int x, int y, int W, int H){ return (x >= 0 && y >= 0 && x < W && y < H); }\n\ntypedef long long ll;\nconst int INF = 100000000;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\nint dx[8] = {1, 0, -1, 0, 1, -1, -1, 1};\nint dy[8] = {0, 1, 0, -1, 1, 1, -1, -1};\n\nint main(){\n  int T;\n  while(cin>>T && T){\n    vector<int> t(T);\n    REP(i, T) cin>>t[i];\n    int start[100] = {};\n    fill(start, start + 100, 24);\n    int N;\n    cin>>N;\n    REP(i, N){\n      int D, M;\n      cin>>D>>M;\n      start[D - 1] = M;\n    }\n    int dp[101][30] = {};\n    REP(i, 101)REP(j, 30) dp[i][j] = INF;\n    dp[0][T - 1] = 0;\n    REP(i, 100){\n      REP(from, T){\n        int to = (from + 1) % T;\n        if(t[to] <= start[i]){\n          dp[i + 1][to] = min(dp[i + 1][to], dp[i][from]);\n        }\n        dp[i + 1][0] = min(dp[i + 1][0], dp[i][from] + 1);\n      }\n    }\n    int ans = INF;\n    REP(i, T) ans = min(ans, dp[100][i]);\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i, n) for (int i = 0; i < int(n); ++i)\n#define all(c) (c).begin(), (c).end()\n\ntemplate <class T, class U>\ninline bool chmin(T& t, const U& f) { return t > f ? t = f, true : false; }\n\nconst int DMAX = 110, INF = 1 << 12;\n\nint solve(int T, const vector<int>& t, const vector<int>& interview) {\n    vector<int> dp(T, INF); dp[0] = 0;\n    for (const int& M : interview) {\n        vector<int> nxt(T, INF);\n        rep(i, T) {\n            if (i == T - 1) chmin(nxt[0], dp[i]);\n            else {\n                if (M >= t[i + 1]) chmin(nxt[i + 1], dp[i]);\n                chmin(nxt[0], dp[i] + 1);\n            }\n        }\n        dp.swap(nxt);\n    }\n    return *min_element(all(dp));\n}\n\nint main() {\n    for (int T; cin >> T, T;) {\n        vector<int> t(T);\n        for (int& e : t) cin >> e;\n        int N; cin >> N;\n        vector<int> interview(DMAX, INF);\n        while (N--) {\n            int D, M; cin >> D >> M;\n            chmin(interview[D], M);\n        }\n        cout << solve(T, t, interview) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(){\n    while(true){\n        int T;\n        cin>>T;\n        if(T==0) break;\n        vector<int> t(T);\n        for(int i=0;i<T;i++) cin>>t[i];\n        int n;\n        cin>>n;\n        vector<int> d(n),m(n);\n        for(int i=0;i<n;i++) cin>>d[i]>>m[i];\n\n        vector<int> wake(101,23);\n        for(int i=0;i<n;i++) wake[d[i]-1]=min(wake[d[i]-1],m[i]);\n        vector<vector<int>> dp(102,vector<int>(T,1000));\n        dp[0][0]=0;\n        for(int i=0;i<=100;i++){\n            for(int j=0;j<T;j++){\n                if(t[j]<=wake[i]) dp[i+1][(j+1)%T]=min(dp[i+1][(j+1)%T],dp[i][j]);\n                dp[i+1][1%T]=min(dp[i+1][1%T],dp[i][j]+1);\n            }\n        }\n        cout<<*min_element(dp[101].begin(),dp[101].end())<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//include\n//------------------------------------------\n#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <deque>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <queue>\n\nusing namespace std;\n\n//typedef\n//------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef long long LL;\n\n//container util\n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define EACH(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n\n//repetition\n//------------------------------------------\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\n//constant\n//--------------------------------------------\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\nconst int INF = 1e9;\n\nint main(){\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n\n  int T;\n  while(cin >> T, T){\n\tVI ts(T);\n\tREP(i,T) cin >> ts[i];\n\tint N; cin >> N;\n\tvector<PII> dm(N);\n\tREP(i,N) cin >> dm[i].first >> dm[i].second;\n\tSORT(dm);\n\n\tVVI dp(N, VI(T, INF));\n\tfor(int t=0;t<T;++t)\n\t  if(ts[t] <= dm[N-1].second)\n\t\tdp[N-1][t] = 0;\n\tfor(int i=N-2;i>=0;--i){\n\t  int dur = dm[i+1].first - dm[i].first;\n\t  for(int t=0;t<T;++t){\n\t\tif(ts[t] > dm[i].second) continue;\n\t\tdp[i][t] = min(dp[i+1][(t+dur)%T], 1+dp[i+1][0]);\n\t  }\n\t}\n\tcout << dp[0][0] << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\n#define\trep(i,n)\tfor(int i=0;i<n;i++)\n\nusing namespace std;\n\nconst int INF=1<<29;\n\nint main(){\n\tfor(int T;scanf(\"%d\",&T),T;){\n\t\tint t[30];\n\t\trep(i,T)\tscanf(\"%d\",t+i);\n\t\tint n;\tscanf(\"%d\",&n);\n\t\tint sche[100];\n\t\trep(i,100)\tsche[i]=INF;\n\t\t{\n\t\t\tint d,m;\n\t\t\trep(i,n){\n\t\t\t\tscanf(\"%d%d\",&d,&m);\n\t\t\t\tsche[d-1]=min(sche[d-1],m);\n\t\t\t}\n\t\t}\n\n\t\tint dp[100][30];\n\t\trep(j,T)\tdp[0][j]=(j==0?0:INF);\n\t\tfor(int i=1;i<100;i++){\n\t\t\tdp[i][0]=dp[i-1][T-1];\n\t\t\trep(j,T-1)\tdp[i][0]=min(dp[i][0],dp[i-1][j]+1);\n\t\t\tfor(int j=1;j<T;j++){\n\t\t\t\tif(sche[i]<t[j])\tdp[i][j]=INF;\n\t\t\t\telse\t\t\t\tdp[i][j]=dp[i-1][j-1];\n\t\t\t}\n\t\t}\n\n\t\tint ans=INF;\n\t\trep(j,T)\tans=min(ans,dp[99][j]);\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nint b[100];\nint d[110];\nint dp[110][31];\nint main(){\n\tint a;\n\twhile(scanf(\"%d\",&a),a){\n\t\tfor(int i=0;i<a;i++)scanf(\"%d\",b+i);\n\t\tint c;scanf(\"%d\",&c);\n\t\tfor(int i=0;i<110;i++)d[i]=-1;\n\t\tfor(int i=0;i<c;i++){\n\t\t\tint p,q;scanf(\"%d%d\",&p,&q);\n\t\t\tp--;\n\t\t\tif(!~d[p]||d[p]>q)d[p]=q;\n\t\t}\n\t\tfor(int i=0;i<110;i++)for(int j=0;j<31;j++)dp[i][j]=999999999;\n\t\tdp[0][0]=0;\n\t\tfor(int i=0;i<100;i++){\n\t\t\tfor(int j=0;j<a;j++){\n\t\t//\t\tprintf(\"%d %d: %d\\n\",i,j,dp[i][j]);\n\t\t\t\tif(!~d[i]||b[j]<=d[i])dp[i+1][(j+1)%a]=min(dp[i+1][(j+1)%a],dp[i][j]);\n\t\t\t\tdp[i+1][1%a]=min(dp[i+1][1%a],dp[i][j]+1);\n\t\t\t}\n\t\t}\n\t\tint ret=999999999;\n\t\tfor(int i=0;i<a;i++)ret=min(ret,dp[100][i]);\n\t\tprintf(\"%d\\n\",ret);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nstatic const int INF = (1<<28);\n\nint T, t[30], N, M[100], dp[101][30], a, b;\n\nmain(){\n  while(cin >> T && T){\n    for(int i=0;i<T;i++) cin >> t[i];\n    cin >> N;\n    fill(M, M+N, INF);\n    for(int i=0;i<N;i++){\n      cin >> a >> b;\n      M[a-1] = min(M[a-1], b);\n    }\n    fill(dp[0], dp[101], INF);\n    dp[0][0] = 0;\n    for(int i=0;i<N;i++){\n      for(int j=0;j<T;j++){\n        if(t[j] <= M[i]) dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T], dp[i][j]);\n        dp[i+1][1] = min(dp[i+1][1], dp[i][j]+1);\n      }\n    }\n    int ans = INF;\n    for(int i=0;i<T;i++) ans = min(ans, dp[N][i]);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <map>\n#include <set>\n#include <list>\n#include <cmath>\n#include <queue>\n#include <stack>\n#include <cstdio>\n#include <string>\n#include <vector>\n#include <complex>\n#include <cstdlib>\n#include <cstring>\n#include <numeric>\n#include <sstream>\n#include <algorithm>\n#include <functional>\n#include <limits.h>\n#include <bitset>\n\n#include <tuple>\n#include <unordered_map>\n\n#define mp       make_pair\n#define mt       make_tuple\n#define pb       push_back\n#define rep(i,n) for(int i=0;i<(n);i++)\n\nusing namespace std;\n\ntypedef    long long          ll;\ntypedef    unsigned long long ull;\ntypedef    pair<int,int>      pii;\n\nconst int INF=1<<29;\nconst double EPS=1e-9;\n\nconst int dx[]={1,0,-1,0},dy[]={0,-1,0,1};\nint T;\nint N;\nvector<int> t;\nmap<int, int> work;\nint dp[33][110];\nint memo(int day, int cycle){\n\tif (day == N + 1)return 0;\n\tif (dp[day][cycle] >= 0){\n\t\treturn dp[day][cycle];\n\t}\n\tint res = INF;\n\tif (t[cycle % T] <= work[day]){\n\t\tres = min(res, memo(day + 1, cycle + 1));\n\t}\n\tres = min(res, memo(day + 1, 0) + 1);\n\n\treturn\tdp[day][cycle] = res;\n}\nint main(){\n\twhile (cin >> T, T){\n\t\tmemset(dp, -1, sizeof(dp));\n\t\tt.clear();\n\t\tt.resize(T);\n\t\twork.clear();\n\t\tfor (int i = 0; i < T; i++) {\n\t\t\tcin >> t[i];\n\t\t}\n\t\tcin >> N;\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tint D,M;\n\t\t\tcin >> D >> M;\n\t\t\tD--;\n\t\t\twork[D] = M;\n\t\t}\n\t\tcout << memo(0, 0) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include \"bits/stdc++.h\"\nusing namespace std;\n\n//#define int int64_t\n\n#define CHOOSE(a) CHOOSE2 a\n#define CHOOSE2(a0,a1,a2,a3,x,...) x\n#define REP1(i, s, cond, cal) for (signed i = signed(s); i cond; i cal)\n#define REP2(i, s, n) REP1(i, s, < signed(n), ++)\n#define REP3(i, n) REP2(i, 0, n)\n#define rep(...) CHOOSE((__VA_ARGS__,REP1,REP2,REP3))(__VA_ARGS__)\n#define rrep(i, s) rep(i, s, >= 0, --)\n\n#define all(c) begin(c), end(c)\n#define maxup(ans, x) (ans = (ans < x ? x : ans))\n#define minup(ans, x) (ans = (ans > x ? x : ans))\n\n#define breakif(cond) if(cond) break; else\n\nusing VV = vector<vector<int>>;\nusing V = vector<int>;\nusing P = pair<int, int>;\nusing IP = pair<int, P>;\n\ntemplate<typename T>\ninline void input(vector<T>& v) { for (auto& x : v) cin >> x; }\n\nsigned main() {\n\tint t;\n\twhile (cin >> t && t) {\n\t\tV ts(t);\n\t\trep(i, t) {\n\t\t\tint x; cin >> x;\n\t\t\tts[i] = x;\n\t\t}\n\t\tint n; cin >> n;\n\t\tV ms(101, 1 << 29);\n\t\trep(i, n) {\n\t\t\tint d, m;\n\t\t\tcin >> d >> m;\n\t\t\tms[d - 1] = m;\n\t\t}\n\t\tVV dp(101, V(t, 1 << 29)); //dp[day][t_i]\n\n\t\tdp[0][0] = 0;\n\t\trep(i, 0, 100) rep(j, t) {\n\t\t\tminup(dp[i + 1][1], dp[i][j] + 1);\n\t\t\tif(ts[j] <= ms[i]) minup(dp[i + 1][(j + 1) % t], dp[i][j]);\n\t\t}\n\t\tint ans = *min_element(all(dp[100]));\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nint main(){\n  int T;\n  while(cin >> T, T){\n    vector<int> t(T);\n    for(int i = 0; i < T; ++i){\n      cin >> t[i];\n    }\n    int N;\n    cin >> N;\n    int d, m;\n    vector< pair<int,int> > V;\n    for(int i = 0; i < N; ++i){\n      cin >> d >> m;\n      --d;\n      V.emplace_back(d,m);\n    }\n    sort(V.begin(), V.end());\n    int ans = 0, e = N;\n    while(e > 0){\n      for(int k = 0; k <= V[e-1].first; ++k){\n        int tmp = -1;\n        bool f = false;\n        for(int i = 0; i < e; ++i){\n          if(V[i].first < k) continue;\n          if(tmp == -1){\n            tmp = i;\n            f = true;\n          }\n          if(V[i].second < t[(V[i].first-k)%T]){\n            f = false;\n            break;\n          }\n        }\n        if(f){\n          e = tmp;\n          if(e) ++ans;\n          break;\n        }\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nint main()\n{\n\tint T,N;\n\twhile(scanf(\"%d\", &T), T)\n\t{\n\t\tint cycle[30];\n\t\t\n\t\tfor(int i=0; i<T; i++)\n\t\t\tscanf(\"%d\", &cycle[i]);\n\t\n\t\tint day[101], maxd=0;\n\t\tfor(int i=0; i<101; i++)\n\t\t\tday[i]=999;\n\t\t\n\t\tscanf(\"%d\", &N);\n\t\t\n\t\tfor(int i=0; i<N; i++)\n\t\t{\n\t\t\tint d,m;\n\t\t\tscanf(\"%d%d\", &d,&m);\n\t\t\tday[d]=min(day[d], m);\n\t\t\tmaxd=max(d, maxd);\n\t\t}\n\t\t\n\t\tint ps[30];\n\t\t\n\t\tfor(int i=0; i<T; i++) ps[i]=99;\n\t\tps[0]=0;\n\t\t\n\t\tfor(int i=0; i<maxd; i++)\n\t\t{\n\t\t\tint t[30];\n\t\t\tfor(int j=0; j<T; j++) t[j]=99;\n\t\t\t\n\t\t\tfor(int j=0; j<T; j++)\n\t\t\t{\n\t\t\t\tif(j>i) continue;\n\t\t\t\tif(j!=T-1) t[0]=min(t[0], ps[j]+1);\n\t\t\t\t\n\t\t\t\tif(cycle[j]>day[i]) continue;\n\t\t\t\t\t\n\t\t\t\tt[(j+1)%T]=min(min(t[0], ps[j]), t[(j+1)%T]);\n\t\t\t}\n\t\t\t\n\t\t\tfor(int j=0; j<T; j++) \n\t\t\t\tps[j]=t[j];\n\t\t}\n\t\t\n\t\tint ans=99;\n\t\tfor(int i=0; i<T; i++)\n\t\t\tans=min(ans, ps[i]);\n\t\t\t\n\t\tprintf(\"%d\\n\", ans);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\nint n, m, t[33], a[103], e1, e2, dp[103][33];\nint main() {\n\twhile (cin >> n, n) {\n\t\tfill(a, a + 100, 24);\n\t\tfor (int i = 0; i < n; i++) cin >> t[i];\n\t\tcin >> m;\n\t\tfor (int i = 0; i < m; i++) cin >> e1 >> e2, e1--, a[e1] = min(a[e1], e2);\n\t\tfill(dp[1] + 1, dp[1] + n, 99999999);\n\t\tfor (int i = 2; i <= 100; i++) {\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tdp[i][j] = 999999999;\n\t\t\t\tif (j == 0) dp[i][j] = *min_element(dp[i - 1], dp[i - 1] + n) + 1;\n\t\t\t\tif (a[i - 1] >= t[j]) dp[i][j] = min(dp[i][j], dp[i - 1][(j + n - 1) % n]);\n\t\t\t}\n\t\t}\n\t\tint ret = *min_element(dp[100], dp[100] + n);\n\t\tcout << ret << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n\nusing namespace std;\n\nstruct before_main{before_main(){cin.tie(0); ios::sync_with_stdio(false);}} before_main;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntemplate<class T, class U, class Compare>\nvoid pair_sort(vector<T>& a, vector<U>& b, Compare comp) {\n  vector<pair<T, U>> v;\n  rep(i, a.size()) v.emplace_back(a[i], b[i]);\n  sort(v.begin(), v.end(), comp);\n  rep(i, a.size()) tie(a[i], b[i]) = v[i];\n}\ntemplate<class T, class U>\nvoid pair_sort(vector<T>& a, vector<U>& b) {\n  pair_sort(a, b, std::less<pair<T, U>>());\n}\n\ntypedef long long ll;\nint const inf = 1<<29;\n\nint T, N;\nvector<int> t;\nvector<int> M;\n\nint solve() {\n\n  static int dp[2][303]; rep(i, 2) rep(j, 303) dp[i][j] = inf;\n  dp[0][0] = 0;\n\n  rep(i, N) {\n    rep(j, 303) dp[(i+1)&1][j] = inf;\n    rep(j, T) {\n      if(t[j] <= M[i] || M[i] == 0) {\n        minimize(dp[(i+1)&1][(j+1)%T], dp[i&1][j]);\n      }\n      else {\n        minimize(dp[(i+1)&1][1%T], dp[i&1][j] + 1);\n      }\n    }\n  }\n\n  return *min_element(dp[N&1], dp[N&1] + 303);\n}\n\nint main() {\n\n  for(; cin >> T && T;) {\n    t.clear();\n    t.resize(T);\n    rep(i, T) cin >> t[i];\n    cin >> N;\n    M.clear();\n    M.resize(N, inf);\n    rep(i, N) {\n      int d, m; cin >> d >> m; d --;\n      minimize(M[d], m);\n    }\n    cout << solve() << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <iostream>\n#include <math.h>\n#include <assert.h>\n#include <vector>\n\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\nstatic const double EPS = 1e-9;\nstatic const double PI = acos(-1.0);\n\n#define REP(i, n) for (int i = 0; i < (int)(n); i++)\n#define FOR(i, s, n) for (int i = (s); i < (int)(n); i++)\n#define FOREQ(i, s, n) for (int i = (s); i <= (int)(n); i++)\n#define FORIT(it, c) for (__typeof((c).begin())it = (c).begin(); it != (c).end(); it++)\n#define MEMSET(v, h) memset((v), h, sizeof(v))\n\nint T, N;\nint dp[40][110];\nint wake[40];\nint interview[110];\n\nint main() {\n  while (scanf(\"%d\", &T), T) {\n    MEMSET(interview, 0x0f);\n    REP(i, T) { scanf(\"%d\", &wake[i]); }\n    scanf(\"%d\", &N);\n    REP(i, N) {\n      int d, m;\n      scanf(\"%d %d\", &d, &m);\n      d--;\n      interview[d] = min(interview[d], m);\n    }\n    MEMSET(dp, 0x0f);\n    dp[0][0] = 0;\n    REP(day, 100) {\n      REP(t, T) {\n        if (wake[t] > interview[day]) { continue; }\n        dp[(t + 1) % T][day + 1] = min(dp[(t + 1) % T][day + 1], dp[t][day]);\n        dp[0][day + 1] = min(dp[0][day + 1], dp[t][day] + 1);\n      }\n    }\n    int ans = 1000;\n    REP(t, T) { ans = min(ans, dp[t][100]); }\n      printf(\"%d\\n\", ans);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define all(x) (x).begin(),(x).end()\nconst int mod=1000000007,MAX=107,INF=1<<30;\n\nint dp[MAX][MAX];\n\nint main(){\n    \n    std::ifstream in(\"text.txt\");\n    std::cin.rdbuf(in.rdbuf());\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    \n    while(1){\n        int N;cin>>N;\n        if(N==0) break;\n        vector<int> T(N);\n        for(int i=0;i<N;i++) cin>>T[i];\n        int M;cin>>M;\n        vector<int> A(103,100);\n        for(int i=0;i<M;i++){\n            int a,b;cin>>a>>b;\n            A[a]=min(A[a],b);\n        }\n        \n        for(int i=0;i<MAX;i++) for(int j=0;j<MAX;j++) dp[i][j]=INF;\n        \n        dp[0][N-1]=0;\n        \n        for(int i=0;i<102;i++){\n            for(int j=0;j<N;j++){\n                int to=(j+1)%N;\n                if(T[to]<=A[i+1]) dp[i+1][to]=min(dp[i+1][to],dp[i][j]);\n                \n                dp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n            }\n            \n        }\n        \n        int ans=INF;\n        \n        for(int j=0;j<N;j++) ans=min(ans,dp[102][j]);\n        \n        cout<<ans<<endl;\n    }\n    \n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "//include\n//------------------------------------------\n#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <deque>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <queue>\n\nusing namespace std;\n\n//typedef\n//------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef long long LL;\n\n//container util\n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define EACH(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n\n//repetition\n//------------------------------------------\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\n//constant\n//--------------------------------------------\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\nconst int INF = 1e8;\n\nint dfs(int idx, int t, VVI& dp){\n}\n\nint main(){\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n\n  int T;\n  while(cin >> T, T){\n\tVI ts(T);\n\tREP(i,T) cin >> ts[i];\n\tint N; cin >> N;\n\tVI ms(100, 24);\n\tREP(i,N){\n\t  int d, m; cin >> d >> m;\n\t  ms[d-1] = min(ms[d-1], m);\n\t}\n\n\tVVI dp(100, VI(T, INF));\n\tdp[0][0] = 0;\n\tfor(int i=0;i<100-1;++i){\n\t  for(int t=0;t<T;++t){\n\t\tint nt = (t + 1) % T;\n\t\tif(ts[nt] <= ms[i+1])\n\t\t  dp[i+1][nt] = min(dp[i+1][nt], dp[i][t]);\n\t\tdp[i+1][0] = min(dp[i+1][0], 1+dp[i][t]);\n\t  }\n\t}\n\tint ans = INF;\n\tREP(t,T)\n\t  ans = min(ans, dp[100-1][t]);\n\tcout << ans << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <sstream>\n#include <cstdio>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <complex>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include <climits>\n#include <queue>\n#include <set>\n#include <map>\n#include <valarray>\n#include <bitset>\n#include <stack>\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\ntypedef long long ll;\ntypedef pair<int,int> pii;\nconst int INF = 1<<29;\nconst double PI = acos(-1);\nconst double EPS = 1e-8;\n\n// dp[i][j] = i日目で周期がjのときの最低回数（無理ならINF）\nint dp[101][31];\n\nint main() {\n  int T;\n  while(cin>>T,T) {\n    int t[T];\n    REP(i,T)cin>>t[i];\n    int N;cin>>N;\n    int D[N], M[N];\n    int A[101];\n    REP(i,101) A[i]=23;\n    REP(i,N) {\n      cin >> D[i] >> M[i];\n      A[D[i]] = min(A[D[i]], M[i]);\n    }\n    REP(i,101)REP(j,T+1)dp[i][j]=INF;\n    dp[0][0] = 0;\n    REP(i,100) {\n      REP(j,T) {\n        //cout << i << \" \" << j << \" \" << t[j] << \" \" << A[i] << \" \" << dp[i][j] << endl;\n        if (t[j]<=A[i+1]) {       // ok\n          dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T], dp[i][j]);\n        }\n        dp[i+1][1] = min(dp[i+1][1], dp[i][j]+1);\n      }\n    }\n    int ans = INF;\n    REP(i,T) ans = min(ans, dp[100][i]);\n    assert(ans!=INF);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\n#define REP(i,n) for(ll i=0;i<n;++i)\n#define RREP(i,n) for(ll i=n-1;i>=0;--i)\n#define FOR(i,m,n) for(ll i=m;i<n;++i)\n#define RFOR(i,m,n) for(ll i=n-1;i>=m;--i)\n#define ALL(v) (v).begin(),(v).end()\n#define PB(a) push_back(a)\n#define UNIQUE(v) v.erase(unique(ALL(v)),v.end());\n#define DUMP(v) REP(aa, (v).size()) { cout << v[aa]; if (aa != v.size() - 1)cout << \" \"; else cout << endl; }\n#define INF 1000000001ll\n#define MOD 1000000007ll\n#define EPS 1e-9\n\nconst int dx[8] = { 1,1,0,-1,-1,-1,0,1 };\nconst int dy[8] = { 0,1,1,1,0,-1,-1,-1 };\n\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector<vi> vvi;\ntypedef vector<vl> vvl;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nll max(ll a, int b) { return max(a, ll(b)); }\nll max(int a, ll b) { return max(ll(a), b); }\nll min(ll a, int b) { return min(a, ll(b)); }\nll min(int a, ll b) { return min(ll(a), b); }\n///(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)///\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tint t;\n\twhile (cin >> t, t) {\n\t\tvi v(t);\n\t\tREP(i, t)cin >> v[i];\n\t\tint n; cin >> n;\n\t\tvi d(100,INF);\n\t\tREP(i, n) {\n\t\t\tint a, b;\n\t\t\tcin >> a >> b;\n\t\t\tif(d[a-1]==INF)d[a - 1] = b;\n\t\t\telse d[a - 1] = min(b, d[a - 1]);\n\t\t}\n\t\tint p = 100, cnt = 0;\n\t\twhile (p != 0) {\n\t\t\tREP(i, p) {\n\t\t\t\tint flag = 1;\n\t\t\t\tFOR(j, i, p) {\n\t\t\t\t\tif (v[(j-i)%t] > d[j])flag = 0;\n\t\t\t\t}\n\t\t\t\tif (flag) {\n\t\t\t\t\tp = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcnt++;\n\t\t}\n\t\tcout << cnt-1 << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\ntypedef pair<int,int>pint;\ntypedef vector<int>vint;\ntypedef vector<pint>vpint;\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define se second\n#define all(v) (v).begin(),(v).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define reps(i,f,n) for(int i=(f);i<(n);i++)\n#define each(it,v) for(__typeof((v).begin()) it=(v).begin();it!=(v).end();it++)\ntemplate<class T,class U>void chmin(T &t,U f){if(t>f)t=f;}\ntemplate<class T,class U>void chmax(T &t,U f){if(t<f)t=f;}\n\nint T;\nint t[30];\nint m[100];\n\nint dp[111][30];\n\nvoid solve(){\n    rep(i,T)cin>>t[i];\n\n\n    fill_n(m,100,1001001);\n    int N;cin>>N;\n    while(N--){\n        int D,M;\n        cin>>D>>M;\n        D--;\n        chmin(m[D],M);\n    }\n\n\n    fill_n(*dp,111*30,1<<25);\n    dp[0][0]=0;\n    rep(i,100){\n        rep(j,T){\n            if(t[j]<=m[i]){\n                chmin(dp[i+1][(j+1)%T],dp[i][j]);\n            }\n            chmin(dp[i+1][1%T],dp[i][j]+1);\n        }\n    }\n    int ans=1<<25;\n    rep(i,T)chmin(ans,dp[100][i]);\n    cout<<ans<<endl;\n}\n\nsigned main(){\n    while(cin>>T,T)solve();\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define  _CRT_SECURE_NO_WARNINGS\n#pragma comment (linker, \"/STACK:526000000\")\n\n#include \"bits/stdc++.h\"\n\nusing namespace std;\ntypedef string::const_iterator State;\n#define eps 1e-11L\n#define MAX_MOD 1000000007LL\n#define GYAKU 500000004LL\n\n#define MOD 998244353LL\n#define seg_size 262144*2LL\n#define pb push_back\n#define mp make_pair\ntypedef long long ll;\n#define REP(a,b) for(long long (a) = 0;(a) < (b);++(a))\n#define ALL(x) (x).begin(),(x).end()\n\nunsigned long xor128() {\n\tstatic unsigned long x = 123456789, y = 362436069, z = 521288629, w = time(NULL);\n\tunsigned long t = (x ^ (x << 11));\n\tx = y; y = z; z = w;\n\treturn (w = (w ^ (w >> 19)) ^ (t ^ (t >> 8)));\n}\n\nvoid init() {\n\tiostream::sync_with_stdio(false);\n\tcout << fixed << setprecision(20);\n}\n#define int ll\n\nvoid solve(){\n\twhile (true) {\n\t\tint t;\n\t\tcin >> t;\n\t\tif (t == 0) return;\n\t\tvector<int> inputs;\n\t\tREP(i, t) {\n\t\t\tint a;\n\t\t\tcin >> a;\n\t\t\tinputs.push_back(a);\n\t\t}\n\t\tint dp[101][50] = {};\n\t\tint cost[101] = {};\n\t\tREP(i, 101) {\n\t\t\tREP(q, 50) {\n\t\t\t\tdp[i][q] = 1e9;\n\t\t\t}\n\t\t\tcost[i] = 100;\n\t\t}\n\t\tint n;\n\t\tcin >> n;\n\t\tREP(i, n) {\n\t\t\tint a, b;\n\t\t\tcin >> a >> b;\n\t\t\ta--;\n\t\t\tcost[a] = min(cost[a], b);\n\t\t}\n\t\tdp[0][0] = 0;\n\t\tfor (int i = 0; i < 100; ++i) {\n\t\t\tfor (int q = 0; q < t; ++q) {\n\t\t\t\tdp[i + 1][1] = min(dp[i + 1][1], dp[i][q] + 1);\n\t\t\t\tif (inputs[q] <= cost[i]) {\n\t\t\t\t\tdp[i + 1][(q + 1) % inputs.size()] = min(dp[i + 1][(q + 1) % inputs.size()], dp[i][q]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans = 1e9;\n\t\tfor (int q = 0; q < 50; ++q) {\n\t\t\tans = min(ans, dp[100][q]);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n\n#undef int\nint main() {\n\tinit();\n\tsolve();\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#include<cctype>\n#include<math.h>\n#include<string>\n#include<string.h>\n#include<stack>\n#include<queue>\n#include<vector>\n#include<utility>\n#include<set>\n#include<map>\n#include<stdlib.h>\n#include<iomanip>\n\nusing namespace std;\n\n#define ll long long\n#define ld long double\n#define EPS 0.0000000001\n#define INF 1e9\n#define MOD 1000000007\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define loop(i,a,n) for(i=a;i<(n);i++)\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\n\nint gcd(int a, int b){\n    if(b==0) return a;\n    return gcd(b,a%b);\n}\nint lcm(int a, int b){\n    return a*b/gcd(a,b);\n}\n\n\nint main(void) {\n    int t;\n    while(cin >> t, t){\n        vi in(t);\n        rep(i,t) cin >> in[i];\n        int n;\n        cin >> n;\n        vi d(105,INF);\n        rep(i,n){\n            int a,b;\n            cin >> a >> b;\n            a--;\n            d[a] = min(d[a],b);\n        }\n        int dp[105][40];\n        rep(i,105)rep(j,40)dp[i][j] = INF;\n        dp[0][0] = 0;\n        rep(i,100)rep(j,t)if(dp[i][j] < INF){\n            //i日目に周期のj日目だったときの最小のカフェインの数\n            if(in[(j+1)%t] <= d[i+1]){\n                dp[i+1][(j+1)%t] = min(dp[i+1][j+1], dp[i][j]);\n            }\n            dp[i+1][0] = min(dp[i+1][0], dp[i][j]+1);\n        }\n        int ans = INF;\n        rep(i,t)ans = min(ans, dp[100][i]);\n        cout << ans << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P> PP;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nint main(){\n  int cycle_length,interview_num;\n  int cycle[100];\n  map<int,vector<int> > interview;\n\n  while(~scanf(\"%d\",&cycle_length)){\n    if(cycle_length == 0) break;\n    for(int i=0;i<cycle_length;i++){\n      scanf(\"%d\",cycle+i);\n    }\n    scanf(\"%d\",&interview_num);\n  \n    int last_day = 0;\n    for(int i=0;i<interview_num;i++){\n      int day,start_hour;\n      scanf(\"%d %d\",&day,&start_hour);\n      interview[day].push_back(start_hour);\n      last_day = max(day,last_day);\n    }\n\n    //dp[day][cycle_idx] = min_cost\n    int dp[101][100];\n    memset(dp,0x3f,sizeof(dp));\n\n    //init\n    dp[1][0] = 0;\n    for(int i=0;i<cycle_length;i++){\n      dp[0][i] = 0;\n    }\n\n    for(int day=1;day<=last_day;day++){\n      for(int cycle_idx=0;cycle_idx < cycle_length; cycle_idx++){\n\tint min_start_hour = 0;\n\tfor(int hour_idx=0;hour_idx<interview[day].size();hour_idx++){\n\t  int start_hour = interview[day][hour_idx];\n\t  min_start_hour = min(min_start_hour,start_hour);\n\t}\n\tif(cycle[(cycle_idx+1)%cycle_length] <= min_start_hour){\n\t  dp[day][(cycle_idx+1)%cycle_length]\n\t    = min(dp[day-1][cycle_idx],dp[day][(cycle_idx+1)%cycle_length]);\n\t}\n\tdp[day][0] = min(dp[day-1][cycle_idx]+1,dp[day][0]);\n      }\n    }\n  \n    int min_v = INF;\n    for(int i=0;i<cycle_length;i++){\n      min_v = min(dp[last_day][i],min_v);\n    }\n    printf(\"%d\\n\",min_v);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <map>\n#include <algorithm>\n#define INF 100000\nusing namespace std;\nint T,N;\nint t[101];\ntypedef pair<int,int> P;\nP p[201];\nint dp[201][31];\n\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d\",&T);\n\t\tif(T==0)break;\n\t\tfor(int i=0;i<T;i++){\n\t\t\tscanf(\"%d\",&t[i]);\n\t\t}\n\t\tscanf(\"%d\",&N);\n\t\tfor(int i=0;i<N;i++){\n\t\t\tscanf(\"%d %d\",&p[i].first,&p[i].second);\n\t\t}\n\t\tsort(p,p+N);\n\t\tfor(int i=0;i<=N;i++){\n\t\t\tfor(int j=0;j<=T;j++){\n\t\t\t\tdp[i][j]=INF;\n\t\t\t}\n\t\t}\n\t\tdp[0][0]=0;\n\t\tint res=INF;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tif(dp[i][j]!=INF){\n\t\t\t\t\tint next=j+p[i].first;\n\t\t\t\t\tif(i>0)next-=p[i-1].first;\n\t\t\t\t\telse next-=1;\n\t\t\t\t\tnext%=T;\n\t\t\t\t\tif(p[i].second>=t[next]){\n\t\t\t\t\t\tdp[i+1][next]=min(dp[i+1][next],dp[i][j]);\n\t\t\t\t\t\tif(i+1==N)res=min(res,dp[i+1][next]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t\t\t\t\tif(i+1==N)res=min(res,dp[i+1][0]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",res);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\nusing namespace std;\n\nint main()\n{\n  int T,N;\n  while(cin >> T,T)\n    {\n      vector<int> t(T+1);\n      for(int i=0;i<T;i++)\n\tcin >> t[i];\n      cin >> N;\n      vector<vector<int> > D(101);\n      int mexday = 0;\n      for(int i=0;i<N;i++)\n\t{\n\t  int d,m;\n\t  cin >> d >> m;\n\t  D[d].push_back(m);\n\t  mexday = max(mexday,d);\n\t}\n\n      int used = 0;\n      int index = 0;\n      for(int i=1;i<=mexday;i++)\n\t{\n\t  bool out = false;\n\t  int st = t[index%T];\n\t  \n\t  for(int j=0;j<D[i].size();j++)\n\t    {\n\t\t  \n\t      if(!(st <= D[i][j] && D[i][j]+1 <= 24))\n\t\t{\n\n\t\t  used++;\n\t\t  out = true;\n\t\t  break;\n\t\t}\n\t    }\n\t  if(out)\n\t    index = 0;\n\t  index++;\n\t  \n\t \n\t}\n      cout << used << endl;\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <map>\n#include <algorithm>\n#define INF 100000\nusing namespace std;\nint T,N;\nint t[31];\ntypedef pair<int,int> P;\nP p[101];\nint dp[101][31];\n\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d\",&T);\n\t\tif(T==0)break;\n\t\tfor(int i=0;i<T;i++){\n\t\t\tscanf(\"%d\",&t[i]);\n\t\t}\n\t\tscanf(\"%d\",&N);\n\t\tfor(int i=0;i<N;i++){\n\t\t\tscanf(\"%d %d\",&p[i].first,&p[i].second);\n\t\t}\n\t\tsort(p,p+N);\n\t\t\n\t\tfor(int i=0;i<=N;i++){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tdp[i][j]=INF;\n\t\t\t}\n\t\t}\n\t\tdp[0][0]=0;\n\t\tint res=INF;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tif(dp[i][j]!=INF){\n\t\t\t\t\tint next=j+p[i].first;\n\t\t\t\t\tif(i>0)next-=p[i-1].first;\n\t\t\t\t\telse next-=1;\n\t\t\t\t\tnext%=T;\n\t\t\t\t\tif(p[i].second>=t[next]){\n\t\t\t\t\t\tdp[i+1][next]=min(dp[i+1][next],dp[i][j]);\n\t\t\t\t\t\tif(i+1==N)res=min(res,dp[i+1][next]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t\t\t\t\tif(i+1==N)res=min(res,dp[i+1][0]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",res);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n  int tm,n;\n  while(cin >> tm,tm){\n    int i,j,k;\n    int t[tm];\n    for(i=0;i<tm;i++) cin >> t[i];\n    cin >> n;\n    int m[150]={};\n    fill(m,m+150,24);\n    for(i=1;i<=n;i++){\n      cin >> k;\n      cin >> m[k];\n    }\n    int inf = 1<<20;\n    int dp[150][50];\n    fill(dp[0],dp[149],inf);\n    dp[1][0]=0;\n    for(i=1;i<150;i++){\n      for(j=0;j<50;j++){\n\tif(dp[i][j]==inf) continue;\n\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t//cout <<i<<\":\"<<j<<\":\"<< t[(j+1)%tm]<<\":\"<<m[i]<<endl;\n\tif(t[(j+1)%tm]<=m[i+1]){\n\t  dp[i+1][(j+1)%tm]=min(dp[i+1][(j+1)%tm],dp[i][j]);\n\t}\n      }\n    }\n    int o=inf;\n    /*\n    for(j=1;j<=n+10;j++){\n      cout << j << \":\";\n      for(i=0;i<tm;i++) cout << dp[j][i] << (i==tm-1?\"\\n\":\" \");\n    }\n    */\n    for(i=0;i<50;i++) o=min(o,dp[101][i]);\n    cout << o << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nstruct node{\n\tint d,m;\n}data[1001];\nint T,t[101],n,f[101];\nbool cmp(node s1,node s2){\n\tif(s1.d==s2.d) return s1.m<s2.m;\n\treturn s1.d<s2.d;\n}\nint main(){\n\twhile(true){\n\t\tscanf(\"%d\",&T);\n\t\tif(T==0) return 0;\n\t\tfor(int i=1;i<=T;i++) scanf(\"%d\",&t[i]);\n\t\tscanf(\"%d\",&n);\n\t\tfor(int i=1;i<=n;i++)\n\t\t scanf(\"%d%d\",&data[i].d,&data[i].m);\n\t\tsort(data+1,data+1+n,cmp);\n\t\tfor(int i=1;i<=n;i++) f[i]=1e9;\n\t\tf[0]=-1;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tfor(int j=0;j<=i-1;j++){\n\t\t\t bool pd=1;\n\t\t\t for(int k=j+1;k<=i;k++){\n\t\t\t   int x=(data[k].d-data[j+1].d)%T+1;\n\t\t\t   if(t[x]>data[k].m) pd=false;\n\t\t\t  }\n\t\t\t if(pd) f[i]=min(f[j]+1,f[i]);\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",f[n]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef long double ld;\nconst ld eps=1e-8;\nint main() {\n\tint t; \n\twhile (cin >> t, t) {\n\t\tint Cyc[30];\n\t\trep(i, t) {\n\t\t\tcin >> Cyc[i];\n\t\t}\n\t\tint cyc[120];\n\t\trep(i, 4*t) {\n\t\t\tcyc[i] = Cyc[i%t];\n\t\t}\n\t\tint n; cin >> n;\n\t\tint view[100];\n\t\tfill(view, view + 100, 24);\n\t\trep(i, n) {\n\t\t\tint d, m; cin >> d >> m; d--;\n\t\t\tview[d] = min(view[d], m);\n\t\t}\n\t\tint dp[101][101];\n\t\trep(i, 101) {\n\t\t\trep(j, 101) {\n\t\t\t\tdp[i][j] = (int)MOD;\n\t\t\t}\n\t\t}\n\t\tdp[0][0] = 0;\n\t\tRep(i, 1, 100) {\n\t\t\trep(j, i) {\n\t\t\t\tif (dp[j][i - 1] == (int)MOD)continue;\n\t\t\t\tint dif = i - j;\n\t\t\t\tif (cyc[dif] <= view[i]) {\n\t\t\t\t\tdp[j][i] = min(dp[j][i], dp[j][i - 1]);\n\t\t\t\t}\n\t\t\t\tdp[i][i] = min(dp[i][i], dp[j][i - 1] + 1);\n\t\t\t}\n\t\t}\n\t\tint mi = (int)MOD;\n\t\trep(i, 100) {\n\t\t\tmi = min(mi, dp[i][99]);\n\t\t}\n\t\tcout << mi << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define MAX_T 30\n#define MAX_N 100\n#define INF 1e9\ntypedef pair<int,int> pii;\n\nint T,N,t[MAX_T];\nint dp[MAX_T][MAX_N];\nvector<pii> vec;\n\nint solve(int tim,int day,int idx){\n  if(idx == N) return 0;\n  if(dp[tim][day] != INF){\n    return dp[tim][day];\n  }\n  int res = INF;\n  pii p = vec[idx];\n  if(day == p.first){\n    if(t[tim] <= p.second){\n      res = min(res,solve(tim+1,day+1,idx+1));\n    }else{\n      res = min(res,solve(0,day,idx)+1);\n    }\n  }else{\n    res = min(res,solve(tim+1,day+1,idx));\n    res = min(res,solve(0,day+1,idx)+1);\n  }\n  return dp[tim][day] = res;\n}\n\nint main(){\n  while(cin >> T, T){\n    vec.clear();\n    for(int i = 0 ; i < T ; i++){\n      cin >> t[i];\n    }\n    int D,M;\n    cin >> N;\n    for(int i = 0 ; i < N ; i++){\n      cin >> D >> M; D--;\n      vec.push_back(pii(D,M));\n    }\n    fill(dp[0],dp[0]+MAX_T*MAX_N,INF);\n    sort(vec.begin(),vec.end());\n    cout << solve(0,0,0) << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// Header {{{\n// includes {{{\n#include <algorithm>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <iostream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <sys/time.h>\n#include <unistd.h>\n#include <vector>\n// }}}\nusing namespace std;\n// consts {{{\nstatic const int INF = 1e9;\nstatic const double PI = acos(-1.0);\nstatic const double EPS = 1e-10;\n// }}}\n// typedefs {{{\ntypedef long long int LL;\ntypedef unsigned long long int ULL;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\ntypedef vector<ULL> VULL;\ntypedef vector<VULL> VVULL;\ntypedef vector<double> VD;\ntypedef vector<VD> VVD;\ntypedef vector<bool> VB;\ntypedef vector<VB> VVB;\ntypedef vector<char> VC;\ntypedef vector<VC> VVC;\ntypedef vector<string> VS;\ntypedef vector<VS> VVS;\ntypedef pair<int, int> PII;\ntypedef complex<int> P;\n#define PQ(type) priority_queue<type>\n// priority queue reverse\n#define PQR(type) priority_queue< type, vector<type>, greater<type> >\n// }}}\n// macros & inline functions {{{\n// syntax sugars {{{\n#define FOR(i, b, e) for (typeof(e) i = (b); i < (e); ++i)\n#define FORI(i, b, e) for (typeof(e) i = (b); i <= (e); ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define REPI(i, n) FORI(i, 0, n)\n#define OPOVER(_op, _type) inline bool operator _op (const _type &t) const\n#define ASSIGN_MAX(var, val) ((var) = max((var), (val)))\n#define ASSIGN_MIN(var, val) ((var) = min((var), (val)))\n// }}}\n// conversion {{{\ninline int toInt(string s) { int v; istringstream sin(s); sin>>v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout<<x; return sout.str(); }\n// }}}\n// array and STL {{{\n#define ARRSIZE(a) ( sizeof(a) / sizeof(a[0]) )\n#define ZERO(a, v) ( assert(v == 0 || v == -1), memset(a, v, sizeof(a)) )\n#define F first\n#define S second\n#define MP(a, b) make_pair(a, b)\n#define SIZE(a) ((LL)a.size())\n#define PB(e) push_back(e)\n#define SORT(v) sort((v).begin(), (v).end())\n#define RSORT(v) sort((v).rbegin(), (v).rend())\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EACH(c, it) for(typeof((c).begin()) it=(c).begin(); it!=(c).end(); ++it)\n#define REACH(c, it) for(typeof((c).rbegin()) it=(c).rbegin(); it!=(c).rend(); ++it)\n#define EXIST(s, e) ((s).find(e) != (s).end())\n// }}}\n// bit manipulation {{{\n// singed integers are not for bitwise operations, specifically arithmetic shifts ('>>', and maybe not good for '<<' too)\n#define IS_UNSIGNED(n) (!numeric_limits<typeof(n)>::is_signed)\n#define BIT(n) (assert(IS_UNSIGNED(n)), assert(n < 64), (1ULL << (n)))\n#define BITOF(n, m) (assert(IS_UNSIGNED(n)), assert(m < 64), ((ULL)(n) >> (m) & 1))\ninline int BITS_COUNT(ULL b) { int c = 0; while(b != 0) { c += (b & 1); b >>= 1; } return c; }\ninline int MSB(ULL b) { int c = 0; while(b != 0) { ++c; b >>= 1; } return c-1; }\ninline int MAKE_MASK(ULL upper, ULL lower) { assert(lower < 64 && upper < 64 && lower <= upper); return (BIT(upper) - 1) ^ (BIT(lower) - 1); }\n// }}}\n// for readable code {{{\n#define EVEN(n) (n % 2 == 0)\n#define ODD(n) (!EVEN(n))\n// }}}\n// debug {{{\n#define arrsz(a) ( sizeof(a) / sizeof(a[0]) )\n#define dprt(fmt, ...) if (opt_debug) { fprintf(stderr, fmt, ##__VA_ARGS__); }\n#define darr(a) if (opt_debug) { copy( (a), (a) + arrsz(a), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define darr_range(a, f, t) if (opt_debug) { copy( (a) + (f), (a) + (t), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define dvec(v) if (opt_debug) { copy( ALL(v), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define darr2(a) if (opt_debug) { FOR(__i, 0, (arrsz(a))){ darr( (a)[__i] ); } }\n#define WAIT() if (opt_debug) { string _wait_; cerr << \"(hit return to continue)\" << endl; getline(cin, _wait_); }\n#define dump(x) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #x << \" = \" << (x) << endl; }\n// dump vector elements in [s, e)\n#define dumpv(v, s, e) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #v << \" = \"; FOR(__i, s, e) { cerr << v[__i] << \"\\t\"; } cerr << endl; }\n#define dumpl(x) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #x << endl << (x) << endl; }\n#define dumpf() if (opt_debug) { cerr << __PRETTY_FUNCTION__ << endl; }\n#define where() if (opt_debug) { cerr << __FILE__ << \": \" << __PRETTY_FUNCTION__ << \" [L: \" << __LINE__ << \"]\" << endl; }\n#define show_bits(b, s) if(opt_debug) { REP(i, s) { cerr << BITOF(b, s-1-i); if(i%4 == 3) cerr << ' '; } cerr << endl; }\n\n// ostreams {{{\n// complex\ntemplate<typename T> ostream& operator<<(ostream& s, const complex<T>& d) {return s << \"(\" << d.real() << \", \" << d.imag() << \")\";}\n\n// pair\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& s, const pair<T1, T2>& d) {return s << \"(\" << d.first << \", \" << d.second << \")\";}\n\n// vector\ntemplate<typename T> ostream& operator<<(ostream& s, const vector<T>& d) {\n\tint len = d.size();\n\tREP (i, len) {\n\t\ts << d[i]; if (i < len - 1) s << \"\\t\";\n\t}\n\treturn s;\n}\n\n// 2 dimentional vector\ntemplate<typename T> ostream& operator<<(ostream& s, const vector< vector<T> >& d) {\n\tint len = d.size();\n\tREP (i, len) {\n\t\ts << d[i] << endl;\n\t}\n\treturn s;\n}\n\n// map\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& s, const map<T1, T2>& m) {\n\ts << \"{\" << endl;\n\tfor (typeof(m.begin()) itr = m.begin(); itr != m.end(); ++itr) {\n\t\ts << \"\\t\" << (*itr).first << \" : \" << (*itr).second << endl;\n\t}\n\ts << \"}\" << endl;\n\treturn s;\n}\n// }}}\n// }}}\n// }}}\n// time {{{\ninline double now(){ struct timeval tv; gettimeofday(&tv, NULL); return (static_cast<double>(tv.tv_sec) + static_cast<double>(tv.tv_usec) * 1e-6); }\n// }}}\n// string manipulation {{{\ninline VS split(string s, char delimiter) { VS v; string t; REP(i, s.length()) { if(s[i] == delimiter) v.PB(t), t = \"\"; else t += s[i]; } v.PB(t); return v; }\ninline string join(VS s, string j) { string t; REP(i, s.size()) { t += s[i] + j; } return t; }\n// }}}\n// geometry {{{\n#define Y real()\n#define X imag()\n// }}}\n// 2 dimentional array {{{\nenum { UP, RIGHT, DOWN, LEFT, UP_RIGHT, DOWN_RIGHT, DOWN_LEFT, UP_LEFT };\nP dydx4[4] = { P(-1, 0), P(0, 1), P(1, 0), P(0, -1) };\nP dydx8[8] = { P(-1, 0), P(0, 1), P(1, 0), P(0, -1), P(-1, 1), P(1, 1), P(1, -1), P(-1, -1) };\nbool in_field(int H, int W, P p) {\n\treturn (0 <= p.Y && p.Y < H) && (0 <= p.X && p.X < W);\n}\n// }}}\n// input and output {{{\ninline void input(string filename) {\n\tfreopen(filename.c_str(), \"r\", stdin);\n}\ninline void output(string filename) {\n\tfreopen(filename.c_str(), \"w\", stdout);\n}\n// }}}\n// }}}\n\n// Header under development {{{\n\nint LCM(int a, int b) {\n\t// FIXME\n\treturn a * b;\n}\n\n// Fraction class {{{\n// ref: http://martin-thoma.com/fractions-in-cpp/\nclass Fraction {\n\tpublic:\n\t\tULL numerator;\n\t\tULL denominator;\n\t\tFraction(ULL _numerator, ULL _denominator) {\n\t\t\tassert(_denominator > 0);\n\t\t\tnumerator = _numerator;\n\t\t\tdenominator = _denominator;\n\t\t};\n\n\t\tFraction operator*(const ULL rhs) {\n\t\t\treturn Fraction(this->numerator * rhs, this->denominator);\n\t\t};\n\n\t\tFraction operator*(const Fraction& rhs) {\n\t\t\treturn Fraction(this->numerator * rhs.numerator, this->denominator * rhs.denominator);\n\t\t}\n\n\t\tFraction operator+(const Fraction& rhs) {\n\t\t\tULL lcm = LCM(this->denominator, rhs.denominator);\n\t\t\tULL numer_lhs = this->numerator * (this->denominator / lcm);\n\t\t\tULL numer_rhs = rhs.numerator * (rhs.numerator / lcm);\n\t\t\treturn Fraction(numer_lhs + numer_rhs, lcm);\n\t\t}\n\n\t\tFraction& operator+=(const Fraction& rhs) {\n\t\t\tFraction result = (*this) + rhs;\n\t\t\tthis->numerator = result.numerator;\n\t\t\tthis->denominator = result.denominator;\n\t\t\treturn *this;\n\t\t}\n};\n\nstd::ostream& operator<<(std::ostream &s, const Fraction &a) {\n\tif (a.denominator == 1) {\n\t\ts << a.numerator;\n\t} else {\n\t\ts << a.numerator << \"/\" << a.denominator;\n\t}\n\treturn s;\n}\n\n// }}}\n\n// }}}\n\nbool opt_debug = false;\n\nint main(int argc, char** argv) {\n\tstd::ios_base::sync_with_stdio(false);\n\t// set options {{{\n\tint __c;\n\twhile ( (__c = getopt(argc, argv, \"d\")) != -1 ) {\n\t\tswitch (__c) {\n\t\t\tcase 'd':\n\t\t\t\topt_debug = true;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tabort();\n\t\t}\n\t}\n\t// }}}\n\n\t// opt_debug = true;\n\t// input(\"./inputs/0.txt\");\n\t// output(\"./outputs/0.txt\");\n\n\tint MAX_D = 100;\n\tint T;\n\twhile (cin >> T, T) {\n\t\tVI cycle(T);\n\t\tREP (i, T) {\n\t\t\tcin >> cycle[i];\n\t\t}\n\t\tint N; cin >> N;\n\t\tVI wakeup_time(MAX_D, INF);\n\t\tREP (i, N) {\n\t\t\tint D, M; cin >> D >> M;\n\t\t\twakeup_time[D-1] = min(wakeup_time[D-1], M);\n\t\t}\n\n\t\tVVI dp(MAX_D, VI(T, INF));\n\t\tdp[0][0] = 0;\n\t\tFOR (d, 1, MAX_D) {\n\t\t\t// caffainate\n\t\t\tREP (t, T) {\n\t\t\t\tdp[d][0] = min(dp[d][0], dp[d-1][t] + 1);\n\t\t\t}\n\t\t\t// non caffaine\n\t\t\tREP (t, T) {\n\t\t\t\tif (cycle[t] <= wakeup_time[d]) {\n\t\t\t\t\tdp[d][t] = min(dp[d][t], dp[d-1][(t - 1 + T) % T]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tint ans = INF;\n\t\tREP (t, T) {\n\t\t\tans = min(ans, dp[MAX_D-1][t]);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}\n\n// vim: foldmethod=marker"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint T;\nint t[102];\nint N;\nint D[102],M[102];\nint max_d;\n\nmap<int,int> jobs;\nint dp[102][102];\n\n// a??\\??????b?????????????????????\nint dfs(int a,int b) {\n    //printf(\"%d %d\\n\",a,b);\n    if(a==max_d+1) return 0;\n    if(dp[a][b]!=-1) return dp[a][b];\n\n    int ret=INF;\n    if(t[b]<=jobs[a+1]) ret=min(ret,dfs(a+1,(b+1)%T));\n    ret=min(ret,dfs(a+1,0)+1);\n\n    return dp[a][b]=ret;\n}\n\nvoid solve() {\n    jobs.clear();\n    max_d=0;\n    rep(i,N) {\n        max_d=max(max_d,D[i]);\n        if(jobs.find(D[i])==jobs.end()) {\n            jobs[D[i]]=INF;\n        }\n        jobs[D[i]]=min(jobs[D[i]],M[i]);\n    }\n    memset(dp,-1,sizeof(dp));\n    cout<<dfs(1,0)<<endl;\n}\n\nint main() {\n    while(cin>>T) {\n        if(!T) break;\n        rep(i,T) cin>>t[i];\n        cin>>N;\n        rep(i,N) cin>>D[i]>>M[i];\n        solve();\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#define rep(i,n) for(int i=0;i<n;i++)\nusing namespace std;\n\nint T,N,t[50],d[110],a,b;\nint dp[110][50];\n\nint main(){\n  while(cin >> T,T){\n    rep(i,T)cin >> t[i];\n    cin >> N;\n    rep(i,100)d[i] = 24;\n    rep(i,N){\n      cin >> a >> b; a--;\n      d[a] = min(d[a],b);\n    }\n\n    rep(i,101)rep(j,T)dp[i][j] = 1000000;\n    dp[0][0] = 0;\n\n    rep(i,100){\n      rep(j,T){\n\tif(t[j]<=d[i]){\n\t  int nxt = (j+1)%T;\n\t  dp[i+1][nxt] = min(dp[i+1][nxt],dp[i][j]);\n\t}\n\tdp[i+1][1] = min(dp[i+1][1],dp[i][j]+1);\n      }\n    }\n\n    int ans = 1000000;\n    rep(i,T)ans = min(ans,dp[100][i]);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "// tsukasa_diary's programing contest code template\n#include <bits/stdc++.h>\nusing namespace std;\n// define\n#define for_(i,a,b) for(int i=a;i<b;++i)\n#define for_rev(i,a,b) for(int i=a;i>=b;--i)\n#define allof(a) a.begin(),a.end()\n#define minit(a,b) memset(a,b,sizeof(a))\n#define size_of(a) (int)a.size()\n// typedef\ntypedef long long lint;\ntypedef double Double;\ntypedef pair<int, int> pii;\n//\ntypedef vector< int > Array;\ntypedef vector< Array > Matrix;\ntypedef vector< Double > DArray;\ntypedef vector< DArray > DMatrix;\ntypedef vector< string > SArray;\ntypedef vector< pii > PArray;\n// popcount\ninline int POPCNT(int _x) { return __builtin_popcount(_x); }\ninline int POPCNT(lint _x) { return __builtin_popcountll(_x); }\n// inf\nconst int iINF = 1L << 30;\nconst lint lINF = 1LL << 60;\n// eps\nDouble EPS = 1e-9;\n// in range\ninline bool in_range(int _v, int _mx, int _mi) { return _mi <= _v && _v < _mx; }\ninline bool in_range(Double _v, Double _mi, Double _mx) { return -EPS < _v - _mi && _v - _mx < EPS; }\ninline bool in_range(int _x, int _y, int _W, int _H) { return 0 <= _x && _x < _W && 0 <= _y && _y < _H; }\n// neighbor clockwise\nconst int DX[4] = {0,1,0,-1}, DY[4] = {-1,0,1,0};\nconst int DX_[8] = {0,1,1,1,0,-1,-1,-1}, DY_[8] = {-1,-1,0,1,1,1,0,-1};\n\nint T, t[33];\nint N, D[110], M[110];\n\nint dp[110][33];\n\nvoid solve() {\n\tvector< int > day(110, 23);\n\tfor_(i,0,N)\tday[ D[i] - 1 ] = min(day[ D[i] - 1 ], M[i]);\n\t\n\tfor_(i,0,110) fill(dp[i], dp[i] + 33, iINF);\n\tdp[0][0] = 0;\n\t\n\tfor_(i,0,100) {\n\t\tfor_(j,0,T) {\n\t\t\tif (dp[i][j] == iINF) continue;\n\t\t\t\n\t\t\tdp[i + 1][1 % T] = min(dp[i + 1][1 % T], dp[i][j] + 1);\n\t\t\t\n\t\t\tif (t[j] <= day[i]) {\n\t\t\t\tint next_j = (j + 1) % T;\n\t\t\t\tdp[i + 1][next_j] = min(dp[i + 1][next_j], dp[i][j]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tint ans = iINF;\n\tfor_(i,0,30) ans = min(ans, dp[100][i]);\n\t\n\tcout << ans << endl;\n}\n\nint main() {\n\twhile (cin >> T, T) {\n\t\tfor_(i,0,T) cin >> t[i];\n\t\tcin >> N;\n\t\tfor_(i,0,N) cin >> D[i] >> M[i];\n\t\tsolve();\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n\n#define\trep(i,n)\tfor(int i=0;i<n;i++)\n\nusing namespace std;\n\nconst int INF=1<<29;\n\nint main(){\n\tfor(int T;scanf(\"%d\",&T),T;){\n\t\tint t[30];\n\t\trep(i,T)\tscanf(\"%d\",t+i);\n\t\tint n;\tscanf(\"%d\",&n);\n\t\tint sche[100];\n\t\trep(i,100)\tsche[i]=INF;\n\t\t{\n\t\t\tint d,m;\n\t\t\trep(i,n){\n\t\t\t\tscanf(\"%d%d\",&d,&m);\n\t\t\t\tsche[d-1]=m;\n\t\t\t}\n\t\t}\n\n\t\tint dp[100][30];\n\t\trep(j,T)\tdp[0][j]=(j==0?0:INF);\n\t\tfor(int i=1;i<100;i++){\n\t\t\tdp[i][0]=dp[i-1][T-1];\n\t\t\trep(j,T-1)\tdp[i][0]=min(dp[i][0],dp[i-1][j]+1);\n\t\t\tfor(int j=1;j<T;j++){\n\t\t\t\tif(sche[i]<t[j])\tdp[i][j]=INF;\n\t\t\t\telse\t\t\t\tdp[i][j]=dp[i-1][j-1];\n\t\t\t}\n\t\t}\n\n\t\tint ans=INF;\n\t\trep(j,T)\tans=min(ans,dp[99][j]);\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\n#define int long long\nusing namespace std;\ntypedef pair<int, int> P;\nconst int INF = 1e9;\n\nint T, N;\nvector<int> t;\nint wktm[110], dp[110], nxt[110];\nint ed;\n\nsigned main(){\n    while(cin >> T, T){\n        t.clear();\n        t.resize(T);\n        rep(i, 0, T) cin >> t[i];\n        cin >> N;\n\n\n        rep(i, 0, 110) wktm[i] = INF;\n        ed = 0;\n        rep(i, 0, N){\n            int a, b;\n            cin >> a >> b;\n            wktm[a] = min(wktm[a], b);\n            ed = max(ed, a);\n        }\n        rep(i, 0, 110) dp[i] = INF;\n        dp[0] = 0;\n        rep(i, 0, ed + 1){\n            rep(j, 0, 110) nxt[j] = dp[j];\n            rep(j, i, ed + 1){\n                int wake = t[(j - i) % T];\n                if(wake > wktm[j]) break;\n                nxt[j] = min(nxt[j], dp[i - 1] + 1);\n            }\n            swap(dp, nxt);\n        }\n        // rep(i, 0, ed + 2){\n        //     cout << dp[i] << \" \";\n        // }\n        // cout << endl;\n        cout << dp[ed] - 1 << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int INF = 1 << 28;\n\nint T, t[30];\nint f[100];\nint dp[100][30];\n\nint calc(int d, int c)\n{\n\tif (d == 100) return 0;\n\tif (~dp[d][c]) return dp[d][c];\n\tint vl = f[d] < t[c] ? INF : calc(d + 1, (c + 1) % T);\n\tint vr = f[d] < t[0] ? INF : 1 + calc(d + 1, 1 % T);\n\treturn dp[d][c] = min(vl, vr);\n}\n\nint main()\n{\n\twhile (cin >> T, T){\n\t\tfill_n(f, 100, 9999);\n\t\tmemset(dp, -1, sizeof(dp));\n\t\tfor (int i = 0; i < T; i++){\n\t\t\tcin >> t[i];\n\t\t}\n\t\tint n;\n\t\tcin >> n;\n\t\tfor (int i = 0; i < n; i++){\n\t\t\tint d, m;\n\t\t\tcin >> d >> m;\n\t\t\tf[d - 1] = min(f[d - 1], m);\n\t\t}\n\t\tcout << calc(0, 0) << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <algorithm>\n#include <cstdio>\n#include <functional>\n#include <iostream>\n#include <cfloat>\n#include <climits>\n#include <cstring>\n#include <cmath>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <time.h>\n#include <vector>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> i_i;\ntypedef pair<ll, int> ll_i;\ntypedef pair<double, int> d_i;\ntypedef pair<ll, ll> ll_ll;\ntypedef pair<double, double> d_d;\nstruct edge { int u, v; double w; };\n\nll MOD = 1000000007;\nll _MOD = 1000000009;\ndouble EPS = 1e-10;\n\nint main() {\n\tfor (;;) {\n\t\tint T; cin >> T;\n\t\tif (T == 0) break;\n\t\tvector<int> t(T);\n\t\tfor (int j = 0; j < T; j++)\n\t\t\tcin >> t[j];\n\t\tint N; cin >> N;\n\t\tvector<int> a(100, 24);\n\t\twhile (N--) {\n\t\t\tint D, M; cin >> D >> M;\n\t\t\ta[D - 1] = min(a[D - 1], M);\n\t\t}\n\t\tvector<int> dp(T, INT_MAX);\n\t\tdp[0] = 0;\n\t\tfor (int d = 0; d < 100; d++) {\n\t\t\tfor (int j = 0; j < T; j++)\n\t\t\t\tif (t[j] > a[d])\n\t\t\t\t\tdp[j] = INT_MAX;\n\t\t\tvector<int> _dp(T);\n\t\t\tfor (int j = 0; j < T; j++)\n\t\t\t\t_dp[(j + 1) % T] = dp[j];\n\t\t\tint mini = INT_MAX;\n\t\t\tfor (int j = 0; j < T; j++)\n\t\t\t\tmini = min(mini, dp[j]);\n\t\t\t_dp[0] = min(_dp[0], mini + 1);\n\t\t\tdp = _dp;\n\t\t}\n\t\tint mini = INT_MAX;\n\t\tfor (int j = 0; j < T; j++)\n\t\t\tmini = min(mini, dp[j]);\n\t\tcout << mini << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nconst int INF = 100000007;\n\nint main(){\n\n    while(1){\n        int T; cin >> T;\n        if(T == 0) break;\n        vector<int> t(T);\n        for(int i = 0; i < T; i++) cin >> t[i];\n        vector<vector<int> > dp(101, vector<int> (T, INF));\n        dp[0][0] = 0;\n        vector<int> day(100, 23);\n        int n; cin >> n;\n        for(int i = 0; i < n; i++){\n            int d, m; cin >> d >> m;\n            d--;\n            day[d] = min(day[d], m);\n        }\n\n        for(int i = 0; i < 100; i++){\n            for(int j = 0; j < T; j++){\n                //take\n                dp[i + 1][1 % T] = min(dp[i + 1][1 % T], dp[i][j] + 1);\n                //not\n                if(day[i] >= t[j]){\n                    dp[i + 1][(j + 1) % T] = min(dp[i + 1][(j + 1) % T], dp[i][j]);\n                }\n            }\n        }\n\n        int ans = INF;\n        for(int j = 0; j < T; j++) ans = min(ans, dp[100][j]);\n        cout << ans << endl;\n\n        /*for(int i = 0; i <= 5; i++){\n            for(int j = 0; j < T; j++){\n                cout << dp[i][j] << \" \";\n\n            }\n            cout << endl;\n        }*/\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n  int tm,n;\n  while(cin >> tm,tm){\n    int i,j,k;\n    int t[tm];\n    for(i=0;i<tm;i++) cin >> t[i];\n    cin >> n;\n    int d[n+1],m[n+1];\n    for(i=1;i<=n;i++){\n      cin >> d[i] >> m[i];\n    }\n    d[0]=0;m[0]=0;\n    int inf = 1<<20;\n    int dp[150][50];\n    fill(dp[0],dp[50],inf);\n    dp[0][0]=0;\n\n    \n    if(t[(d[1]-1)%tm]<=m[1]) dp[1][0]=0;\n    else dp[1][0]=1;\n    \n    for(i=1;i<n;i++){\n      for(j=0;j<tm;j++){\n\tif(dp[i][j]==inf) continue;\n\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t//cout << i<<\":\"<<j<<\":\"<<(j+d[i+1]-d[i])<<\":\"<<t[(j+d[i+1]-d[i])%tm]<<\":\"<<m[i+1]<<endl;\n\t\n\tif(t[(j+d[i+1]-d[i])%tm]<=m[i+1]){\n\t  dp[i+1][(j+d[i+1]-d[i])%tm]=\n\t    min(dp[i+1][(j+d[i+1]-d[i])%tm],dp[i][j]);\n\t}\n\t\n      }\n    }\n    int o=inf;\n    /*\n    for(j=0;j<=n;j++){\n      cout << j << \":\";\n      for(i=0;i<tm;i++) cout << dp[j][i] << (i==tm-1?\"\\n\":\" \");\n    }\n    */\n    for(i=0;i<tm;i++) o=min(o,dp[n][i]);\n    cout << o << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nint main(){\n  int T;\n  while(cin >> T, T){\n    vector<int> t(T);\n    for(int i = 0; i < T; ++i){\n      cin >> t[i];\n    }\n    int N;\n    cin >> N;\n    int d, m;\n    vector< pair<int,int> > V;\n    for(int i = 0; i < N; ++i){\n      cin >> d >> m;\n      V.emplace_back(d,m);\n    }\n    sort(V.begin(), V.end());\n    int ans = 0, k = V[0].first%T;\n    if(V[0].second < t[k]){\n      ++ans;\n      k = 0;\n    }\n    for(int i = 1; i < N; ++i){\n      k += V[i].first%T;\n      k %= T;\n      if(V[i].second < t[k]){\n        ++ans;\n        k = 0;\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P> PP;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nint main(){\n  int cycle_length,interview_num;\n  int cycle[100];\n  map<int,vector<int> > interview;\n\n  while(~scanf(\"%d\",&cycle_length)){\n    if(cycle_length == 0) break;\n    for(int i=0;i<cycle_length;i++){\n      scanf(\"%d\",cycle+i);\n    }\n    scanf(\"%d\",&interview_num);\n  \n    int last_day = 0;\n    for(int i=0;i<interview_num;i++){\n      int day,start_hour;\n      scanf(\"%d %d\",&day,&start_hour);\n      interview[day].push_back(start_hour);\n      last_day = max(day,last_day);\n    }\n\n    int dp[101][100];\n    memset(dp,0x3f,sizeof(dp));\n\n    dp[1][0] = 0; //dp[day][cycle_idx] = min_cost\n    for(int day=1;day<=last_day;day++){\n      for(int cycle_idx=0;cycle_idx < cycle_length; cycle_idx++){\n\tfor(int hour_idx=0;hour_idx<interview[day].size();hour_idx++){\n\t  int start_hour = interview[day][hour_idx];\n\t  if(cycle[(cycle_idx+1)%cycle_length] <= start_hour){\n\t    dp[day+1][(cycle_idx+1)%cycle_length]\n\t      = min(dp[day][cycle_idx],dp[day+1][(cycle_idx+1)%cycle_length]);\n\t  }\n\t  dp[day+1][0] = min(dp[day][cycle_idx]+1,dp[day+1][0]);\n\t}\n      }\n    }\n  \n    int min_v = INF;\n    for(int i=0;i<cycle_length;i++){\n      min_v = min(dp[last_day][i],min_v);\n    }\n    printf(\"%d\\n\",min_v);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P> PP;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nint main(){\n  int cycle_length,interview_num;\n  while(~scanf(\"%d\",&cycle_length)){\n    if(cycle_length == 0) break;\n\n    int cycle[100];\n    map<int,vector<int> > interview;\n    \n    for(int i=0;i<cycle_length;i++){\n      scanf(\"%d\",cycle+i);\n    }\n    scanf(\"%d\",&interview_num);\n  \n    int last_day = 0;\n    for(int i=0;i<interview_num;i++){\n      int day,start_hour;\n      scanf(\"%d %d\",&day,&start_hour);\n      interview[day].push_back(start_hour);\n      last_day = max(day,last_day);\n    }\n\n    //dp[day][cycle_idx] = min_cost\n    int dp[101][100];\n    memset(dp,0x3f,sizeof(dp));\n\n    //init\n    dp[1][0] = 0;\n\n    for(int day=1;day<=last_day;day++){\n      for(int cycle_idx=0;cycle_idx < cycle_length; cycle_idx++){\n\tint min_start_hour = INF;\n\tfor(int hour_idx=0;hour_idx<interview[day].size();hour_idx++){\n\t  int start_hour = interview[day][hour_idx];\n\t  min_start_hour = min(min_start_hour,start_hour);\n\t}\n\tif(cycle[(cycle_idx+1)%cycle_length] <= min_start_hour){\n\t  dp[day][(cycle_idx+1)%cycle_length]\n\t    = min(dp[day-1][cycle_idx],dp[day][(cycle_idx+1)%cycle_length]);\n\t}\n\tdp[day][0] = min(dp[day-1][cycle_idx]+1,dp[day][0]);\n      }\n    }\n  \n    int min_v = INF;\n    for(int i=0;i<cycle_length;i++){\n      min_v = min(dp[last_day][i],min_v);\n    }\n    printf(\"%d\\n\",min_v);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <map>\n#include <algorithm>\n#define INF 100000\nusing namespace std;\nint T,N;\nint t[31];\ntypedef pair<int,int> P;\nP p[101];\nint dp[101][31];\n\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d\",&T);\n\t\tif(T==0)break;\n\t\tfor(int i=0;i<T;i++){\n\t\t\tscanf(\"%d\",&t[i]);\n\t\t}\n\t\tscanf(\"%d\",&N);\n\t\tfor(int i=0;i<N;i++){\n\t\t\tscanf(\"%d %d\",&p[i].first,&p[i].second);\n\t\t}\n\t\tsort(p,p+N);\n\t\tint cnt=0,prev=-1,cafe=0,turn=0;\n\t\tfor(int i=0;i<=N;i++){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tdp[i][j]=INF;\n\t\t\t}\n\t\t}\n\t\tdp[0][0]=0;\n\t\tint res=INF;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tif(dp[i][j]!=INF){\n\t\t\t\t\tint next=j+p[i].first;\n\t\t\t\t\tif(i>0)next-=p[i-1].first;\n\t\t\t\t\telse next-=1;\n\t\t\t\t\tnext%=T;\n\t\t\t\t\tif(p[i].second<t[next]){\n\t\t\t\t\t\tdp[i+1][next]=min(dp[i+1][next],dp[i][j]);\n\t\t\t\t\t\tif(i+1==N)res=min(res,dp[i+1][next]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t\t\t\t\tif(i+1==N)res=min(res,dp[i+1][0]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",res);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long   // <-----!!!!!!!!!!!!!!!!!!!\n\n#define rep(i,n) for (int i=0;i<(n);i++)\n#define rep2(i,a,b) for (int i=(a);i<(b);i++)\n#define rrep(i,n) for (int i=(n)-1;i>=0;i--)\n#define rrep2(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n\ntypedef long long ll;\ntypedef pair<int, int> Pii;\ntypedef tuple<int, int, int> TUPLE;\ntypedef vector<int> V;\ntypedef vector<V> VV;\ntypedef vector<VV> VVV;\ntypedef vector<vector<int>> Graph;\nconst int inf = 1e9;\nconst int mod = 1e9 + 7;\n\nconst int MAX_T = 30;\nconst int MAX_DAY = 100;\n\nint T, N;\nint t[MAX_T];\nint m[MAX_DAY]; // the first meeting time of the day\nint memo[MAX_DAY][MAX_T];\nint dfs(int day, int step) {\n    if (day == MAX_DAY) return 0;\n    if (memo[day][step] != -1) return memo[day][step];\n    if (m[day] < t[step]) return inf;\n\n    return memo[day][step] = min(dfs(day + 1, (step + 1) % T), dfs(day + 1, 0) + 1);\n}\n\nsigned main() {\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(0);\n\n    while (cin >> T, T) {\n        rep(i, T) cin >> t[i];\n        cin >> N;\n        fill(m, m + MAX_DAY, inf);\n        rep(i, N) {\n            int D, M;\n            cin >> D >> M;\n            D--;\n            m[D] = min(m[D], M);\n        }\n        rep(i, MAX_DAY) fill(memo[i], memo[i] + MAX_T, -1);\n        cout << dfs(0, 0) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <functional>\n#include <numeric>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <utility>\n#include <sstream>\n#include <complex>\n#include <fstream>\n#include <bitset>\n#include <time.h>\n#include <tuple>\n#include <iomanip>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<ll, ll> P;\ntypedef vector<ll> V;\ntypedef complex<double> Point;\n\n#define PI acos(-1.0)\n#define EPS 1e-10\nconst ll INF = 1e12;\nconst ll MOD = 1e9 + 7;\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define rep(i,N) for(int i=0;i<(N);i++)\n#define ALL(s) (s).begin(),(s).end()\n#define EQ(a,b) (abs((a)-(b))<EPS)\n#define EQV(a,b) ( EQ((a).real(), (b).real()) && EQ((a).imag(), (b).imag()) )\n#define fi first\n#define se second\n#define N_SIZE (1LL << 20)\n#define NIL -1\n\nll sq(ll num) { return num*num; }\nll mod_pow(ll x, ll n) {\n\tif (n == 0)return 1;\n\tif (n == 1)return x%MOD;\n\tll res = sq(mod_pow(x, n / 2));\n\tres %= MOD;\n\tif (n % 2 == 1) {\n\t\tres *= x;\n\t\tres %= MOD;\n\t}\n\treturn res;\n}\nll mod_add(ll a, ll b) { return (a + b) % MOD; }\nll mod_sub(ll a, ll b) { return (a - b + MOD) % MOD; }\nll mod_mul(ll a, ll b) { return a*b % MOD; }\n\nll T;\nll t[100];\nll n;\n\nint main() {\n\twhile (cin >> T&&T) {\n\t\trep(i, T)cin >> t[i];\n\t\tcin >> n;\n\t\tll start[110];\n\t\trep(i, 110)start[i] = INF;\n\t\trep(i, n) {\n\t\t\tll d, m;\n\t\t\tcin >> d >> m;\n\t\t\tstart[d] = min(m, start[d]);\n\t\t}\n\t\tll ans = 0;\n\t\tll now = 0;\n\t\tFOR(i, 1, 110) {\n\t\t\tif (start[i] < t[now % T]) {\n\t\t\t\tans++;\n\t\t\t\tnow = 0;\n\t\t\t}\n\t\t\tnow++;\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n\nusing namespace std;\n\nint main(){\n\tint T, t[30];\n\tint N, M[100];\n\twhile(cin >> T, T){\n\t\tfor(int i=0;i<100;i++) M[i] = 24;\n\t\tfor(int i=0;i<T;i++) cin >> t[i];\n\t\tcin >> N;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tint D, m; cin >> D >> m;\n\t\t\tM[D-1] = min(M[D-1],m);\n\t\t}\n\t\tint dp[100][100];\n\t\tfor(int i=0;i<100;i++){\n\t\t\tfor(int j=0;j<100;j++) dp[i][j] = 99999999;\n\t\t}\n\t\tdp[0][0] = 0;\n\t\tfor(int i=0;i<99;i++){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tif(t[(j+1)%T]<=M[i+1]) dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T], dp[i][j]);\n\t\t\t\tdp[i+1][0] = min(dp[i+1][0], dp[i][j]+1);\n\t\t\t}\n\t\t}\n\t\tint ans = 99999999;\n\t\tfor(int i=0;i<T;i++) ans = min(dp[99][i], ans);\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\n\nint T, N;\nint t[35], D[110], M[110];\nint dp[110][110];\nint INF = 1 << 30;\n\nvoid chmin(int &a, int b) {\n    a = min(a, b);\n}\n\nint main() {\n    while(cin >> T, T) {\n        for(int i=0; i<T; i++) cin >> t[i];\n        cin >> N;\n        for(int i=0; i<N; i++) cin >> D[i] >> M[i];\n\n        for(int i=0; i<=N; i++) {\n            for(int j=0; j<=N; j++) {\n                dp[i][j] = INF;\n            }\n        }\n\n        dp[0][0] = 0;\n        for(int i=1; i<=N; i++) {\n            // not use\n            for(int j=0; j<i; j++) {\n                int dist = i-j - (j == 0);\n                int wake = t[dist % T];\n                if(wake > M[i-1]) continue;\n                chmin(dp[i][j], dp[i-1][j]);\n            }\n\n            // use\n            if(t[0] <= M[i-1]) chmin(dp[i][i], *min_element(dp[i-1], dp[i-1] + N + 1) + 1);\n        }\n\n        /*\n        for(int i=0; i<=N; i++) {\n            for(int j=0; j<=N; j++) {\n                printf(\"dp[%d][%d] = \", i, j);\n                if(dp[i][j] == INF) printf(\"INF\\n\");\n                else printf(\"%d\\n\", dp[i][j]);\n            }\n        }\n        */\n\n        cout << *min_element(dp[N], dp[N] + N + 1) << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <numeric>\n#include <vector>\n#include <cassert>\n#include <string>\n#include <memory.h>\n#include <queue>\n#include <cstdio>\n#include <cstdlib>\n#include <set>\n#include <map>\n#include <cctype>\n#include <iomanip>\n#include <sstream>\n#include <cctype>\n#include <fstream>\n#include <cmath>\nusing namespace std;\n\n#define REP2(i, m, n) for(int i = (int)(m); i < (int)(n); i++)\n#define REP(i, n) REP2(i, 0, n)\n#define ALL(c) (c).begin(), (c).end()\n#define ITER(c) __typeof((c).begin())\n#define PB(e) push_back(e)\n#define FOREACH(i, c) for(ITER(c) i = (c).begin(); i != (c).end(); ++i)\n#define MP(a, b) make_pair(a, b)\n#define PARITY(n) ((n) & 1)\n\ntypedef long long ll;\ntypedef pair<ll, ll> P;\nconst int INF = 1000 * 1000 * 1000 + 7;\nconst double EPS = 1e-10;\n\nconst int MAXT = 30;\nconst int MAXN = 100;\nconst int MAXD = 110;\nint t[MAXT];\nint d[MAXN];\nint m[MAXN];\n\nint dp[MAXD][MAXT];\n\nint main(){\n  int T, N;\n  cin >> T;\n  REP(i, T) cin >> t[i];\n  cin >> N;\n  REP(i, N){\n    cin >> d[i] >> m[i];\n    d[i]--;\n  }\n  \n  REP(i, N)REP(j, N - 1){\n    if(d[j] > d[j+1] || (d[j] == d[j+1] && m[j] > m[j+1])){\n      swap(d[j], d[j+1]);\n      swap(m[j], m[j+1]);\n    }\n  }\n  \n  \n  fill(&dp[0][0], &dp[0][0] + MAXD * MAXT, INF);\n\n  dp[0][0] = 0;\n  REP(i, MAXD-1){\n    REP(j, T){\n\n      if(dp[i][j] == INF) continue;\n      bool use = false;\n      REP(k, N) if(d[k] == i && t[j] > m[k]) use = true;\n      \n      dp[i+1][1] = min(dp[i+1][1], dp[i][j] + 1);\n      \n      if(!use) {\n        dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T], dp[i][j]);\n      }\n    }\n  }\n  int res = INF;\n  REP(i, T) res = min(res, dp[MAXD-1][i]);\n  \n  cout << res << endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <numeric>\n#include <bitset>\n#include <cmath>\n\nstatic const int MOD = 1000000007;\nusing ll = long long;\nusing u32 = uint32_t;\nusing namespace std;\n\ntemplate<class T> constexpr T INF = ::numeric_limits<T>::max()/32*15+208;\n\ntemplate <class T, class U>\nvector<T> make_v(U size, const T& init){ return vector<T>(static_cast<size_t>(size), init); }\n\ntemplate<class... Ts, class U>\nauto make_v(U size, Ts... rest) { return vector<decltype(make_v(rest...))>(static_cast<size_t>(size), make_v(rest...)); }\n\ntemplate<class T> void chmin(T &a, const T &b){ a = (a < b ? a : b); }\ntemplate<class T> void chmax(T &a, const T &b){ a = (a > b ? a : b); }\n\nint main() {\n    int t;\n    while(cin >> t, t){\n        vector<int> v(t);\n        for (auto &&i : v) scanf(\"%d\", &i);\n        int n;\n        cin >> n;\n        int M = 101;\n        vector<int> u(M, 24);\n        for (int i = 0; i < n; ++i) {\n            int d, m;\n            cin >> d >> m;\n            u[d-1] = min(u[d-1], m);\n        }\n        auto dp = make_v(M, t, INF<int>);\n        dp[0][0] = 0;\n        for (int i = 1; i < M; ++i) {\n            for (int j = 0; j < t; ++j) {\n                if(v[(j+1)%t] <= u[i]) chmin(dp[i][(j+1)%t], dp[i-1][j]);\n                chmin(dp[i][0], dp[i-1][j]+1);\n            }\n        }\n        cout << *min_element(dp.back().begin(),dp.back().end()) << \"\\n\";\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <cassert>\nusing namespace std;\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n) FOR(i,0,n)\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\n\nconst int MAX=INT_MAX/10;\nint main(){\n\tint T;\n\twhile(cin>>T,T){\n\t\tvi t(T);\n\t\tREP(i,T){\n\t\t\tcin>>t[i];\n\t\t}\n\t\tint n;\n\t\tcin>>n;\n\t\tvi d(n),m(n);\n\t\tREP(i,n){\n\t\t\tcin>>d[i]>>m[i];\n\t\t}\n\t\tvvi dp(101,vi(31,MAX));\n\t\tdp[1][0]=0;\n\t\tFOR(i,1,100){\n\t\t\tint hour=MAX;\n\t\t\tREP(j,n){\n\t\t\t\tif(d[j]==i+1&&hour>m[j]){\n\t\t\t\t\thour=m[j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tREP(j,T){\n\t\t\t\tif(hour<MAX&&hour<t[(j+1)%T]){\n\t\t\t\t\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t\t\t\t}else{\n\t\t\t\t\tREP(k,2){\n\t\t\t\t\t\tif(k){\n\t\t\t\t\t\t\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tdp[i+1][(j+1)%T]=min(dp[i+1][(j+1)%T],dp[i][j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans=MAX;\n\t\tREP(i,T){\n\t\t\tans=min(ans,dp[100][i]);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n \nint main(int argc, char *argv[]){\n  int T;\n  while(cin >> T, T){\n    int t[T];\n    for (int i = 0; i < T; i++) {\n      cin >> t[i];\n    }\n    int n;\n    cin >> n;\n    int d[n], m[n];\n    for (int i = 0; i < n; i++) {\n      cin >> d[i] >> m[i];\n    }\n    int dp[T][n + 1];//cycle, day\n    for (int i = 0; i < T; i++) {\n      for (int j = 0; j <= n; j++) {\n        dp[i][j] = 1e9;\n      }\n    }\n \n    dp[0][0] = 0;\n    for (int i = 0; i < T; i++) {\n      int day = 0;\n      for (int j = 0; j < n; j++) {\n        if(d[day] != j + 1){\n          dp[(i + 1) % T][j + 1] =\n            min(dp[(i + 1) % T][j + 1], dp[i][j]);\n          dp[0][j + 1] = min(dp[0][j + 1], dp[i][j] + 1);\n        }else{\n          if(m[day] >= t[i] && m[day] >= t[0]){\n            dp[(i + 1) % T][j + 1] =\n              min(dp[(i + 1) % T][j + 1], dp[i][j]);\n            dp[0][j + 1] = min(dp[0][j + 1], dp[i][j] + 1);\n          }else if(m[day] >= t[i] && m[day] < t[0]){\n            dp[(i + 1) % T][j + 1] =\n              min(dp[(i + 1) % T][j + 1], dp[i][j]);\n          }else if(m[day] < t[i] && m[day] >= t[0]){\n            dp[0][j + 1] = min(dp[0][j + 1], dp[i][j] + 1);\n          }\n          day++;\n        }\n      }\n    }\n    int ans = 1e9;\n    // for (int i = 0; i < T; i++) {\n    //   for (int j = 0; j <= n; j++) {\n    //     std::cout << dp[i][j] << \" \";\n    //   }\n    //   std::cout << std::endl;\n    // }\n    for (int i = 0; i < T; i++) {\n      ans = min(ans, dp[i][n]);\n    }\n    std::cout << ans << std::endl;\n  }\n  return 0;\n  \n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint main()\n{\n  const int inf = 1 << 25;\n  int T;\n  while(cin >> T, T) {\n    int t[33];\n    for(int i = 0; i < T; i++) cin >> t[i];\n    int N; cin >> N;\n    int W[101];\n    int last = -1;\n    fill(W, W + 101, inf);\n    for(int i = 0; i < N; i++) {\n      int D, M; cin >> D >> M; D--;\n      W[D] = min(W[D], M);\n      last = max(last, D+1);\n    }\n    int dp[101][33];\n    fill(dp[0], dp[101], inf);\n    dp[0][0] = 0;\n    for(int i = 0; i < last; i++) {\n      for(int j = 0; j < T; j++) {\n\tif(t[j] <= W[i]) dp[i + 1][(j+1)%T] = min(dp[i + 1][(j+1)%T], dp[i][j]);\n\tdp[i + 1][1] = min(dp[i + 1][1], dp[i][j] + 1);\n      }\n    }    \n    cout << *min_element(dp[last], dp[last] + T) << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"iostream\"\n#include \"climits\"\n#include \"list\"\n#include \"queue\"\n#include \"stack\"\n#include \"set\"\n#include \"functional\"\n#include \"algorithm\"\n#include \"string\"\n#include \"map\"\n#include \"unordered_map\"\n#include \"unordered_set\"\n#include \"iomanip\"\n#include \"cmath\"\n#include \"random\"\n#include \"bitset\"\n#include \"cstdio\"\n#include \"numeric\"\n#include \"cassert\"\n#include \"ctime\"\n\nusing namespace std;\n\nconstexpr long long int MOD = 1000000007;\n//constexpr int MOD = 1000000007;\n//constexpr int MOD = 998244353;\n//constexpr long long int MOD = 998244353;\nconstexpr double EPS = 1e-12;\n\n//int N, M, K, T, H, W, L, R;\nlong long int N, M, K, T, H, W, L, R;\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\n\twhile (cin >> T, T) {\n\t\tvector<int>v(T);\n\t\tfor (auto &i:v)cin >> i;\n\t\tcin >> N;\n\t\tvector<int>w(101, 24);\n\t\twhile (N--) {\n\t\t\tcin >> L >> R;\n\t\t\tw[L] = min(w[L],(int)R);\n\t\t}\n\t\tvector<vector<int>>dp(101, vector<int>(T, MOD));\n\t\tdp[0][0] = 0;\n\t\tfor (int i = 0; i < 100; i++) {\n\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\tdp[i + 1][1] = min(dp[i + 1][1], dp[i][j] + 1);\n\t\t\t\tif (w[i + 1] >= v[j]) {\n\t\t\t\t\tdp[i + 1][(j + 1) % T] = min(dp[i + 1][(j + 1) % T], dp[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << *min_element(dp.back().begin(), dp.back().end()) << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\ntypedef long double ld;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-10;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\nvi t, m;\nint T, N, dp[111][33];\n\nint solve(int i, int j) \n{\n\tj %= T;\n\tif (i == 110) return 0;\n\tif (dp[i][j] >= 0) return dp[i][j];\n\tint res;\n\tif (t[j] > m[i]) res = solve(i + 1, 1) + 1;\n\telse res = min(solve(i + 1, 1) + 1, solve(i + 1, j + 1));\n\treturn dp[i][j] = res;\n}\n\nint main()\n{\n\twhile (cin >> T, T)\n\t{\n\t\tt.clear(), m.clear();\n\t\tMS(dp, -1);\n\t\tREP(i, T)\n\t\t{\n\t\t\tint a; cin >> a;\n\t\t\ta--;\n\t\t\tt.push_back(a);\n\t\t}\n\t\tcin >> N;\n\t\tm.resize(111, INF);\n\t\tREP(i, N) \n\t\t{\n\t\t\tint a, b; cin >> a >> b;\n\t\t\ta--; b--;\n\t\t\tchmin(m[a], b);\n\t\t}\n\t\tcout << solve(0, 0) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": " \n#include <iostream>\n#include <vector>\n#include <math.h>\n#include <iomanip>\n#include <map>\n \nusing namespace std;\nconst int INF = 1<<30;\n \nint solve();\n \nint main(void) {\n \n\twhile(solve()){}\n \n\treturn 0;\n}\n \n \nint solve() {\n \n\t/*\n\t\tdp[?????????????????§??????????£?????????\\][?????¨?????\\] = ????????§??????????£????????????°???????°????\n\t*/\n\ttypedef std::vector<int> vi;\n\ttypedef vector<vi> vvi;\n\ttypedef pair<int,int>pii;\n \n\tint N, T;\n\tcin >> T;\n\tif( T == 0 ) { return 0; }\n \n\tvi t(T);\n\tmap<int,int> mp;\n \n\tfor( int i = 0; i < T; i++ ) {\n\t\tcin >> t[i];\n\t}\n\tcin >> N;\n\tfor( int i = 0; i < N; i++ ) {\n\t\tint d, m;\n\t\tcin >> d >> m;\n\t\tmp[d] = m;\n\t}\n \n\tvvi dp(100+1,vi(100+1,INF));\n\t\tdp[0][1] = 0;\t//?????????\n \n\t/*\n\t\t?£????????£??????????????????????????????????\n\t*/\n\tfor( int i = 1; i +1< dp[0].size(); i++ ) {\n\t\t//i??\\????????????\n\t\tfor( int j = 0; j < dp.size(); j++ ) {\n\t\t\t//?£????\n\t\t\tif( dp[j][i] == INF ) { continue; }\n\t\t\tdp[i][i+1] = min( dp[i][i+1],dp[j][i] + 1);\n\t\t\t//?£??????????\n\t\t\tif( mp.find(i+1) != mp.end() ) {\n\t\t\t\tif( mp[i+1] > t[((i+1-j)+T)%T] && mp[i+1] <= t[0] ) {\n\t\t\t\t\tdp[j][i+1] = min( dp[j][i+1], dp[j][i] );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdp[j][i+1] = min(dp[j][i+1],dp[j][i]);\n\t\t\t}\n\t\t}\n\t}\n \n\tint ans = INF;\n\tfor( int i = 0; i < dp.size(); i++ )\n\t\tans = min( dp[i][100] , ans);\n \n\tcout << ans << endl;\n \n\treturn 1;\n \n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n  int tm,n;\n  while(cin >> tm,tm){\n    int i,j,k;\n    int t[tm];\n    for(i=0;i<tm;i++) cin >> t[i];\n    cin >> n;\n    int m[150]={};\n    fill(m,m+150,24);\n    for(i=1;i<=n;i++){\n      cin >> k;\n      cin >> m[k];\n    }\n    int inf = 1<<20;\n    int dp[150][50];\n    fill(dp[0],dp[149],inf);\n    dp[1][0]=0;\n    for(i=1;i<150;i++){\n      for(j=0;j<50;j++){\n\tif(dp[i][j]==inf) continue;\n\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t//cout <<i<<\":\"<<j<<\":\"<< t[(j+1)%tm]<<\":\"<<m[i]<<endl;\n\tif(t[(j+1)%tm]<=m[i+1]){\n\t  dp[i+1][(j+1)%tm]=min(dp[i+1][(j+1)%tm],dp[i][j]);\n\t}\n      }\n    }\n    int o=inf;\n    /*\n    for(j=1;j<=n+10;j++){\n      cout << j << \":\";\n      for(i=0;i<tm;i++) cout << dp[j][i] << (i==tm-1?\"\\n\":\" \");\n    }\n    */\n    for(i=0;i<tm;i++) o=min(o,dp[101][i]);\n    cout << o << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nint main()\n{\n\tint T,N;\n\twhile(scanf(\"%d\", &T), T)\n\t{\n\t\tint cycle[30];\n\t\t\n\t\tfor(int i=0; i<T; i++)\n\t\t\tscanf(\"%d\", &cycle[i]);\n\t\n\t\tint day[101], maxd=0;\n\t\tfor(int i=0; i<101; i++)\n\t\t\tday[i]=999;\n\t\t\n\t\tscanf(\"%d\", &N);\n\t\t\n\t\tfor(int i=0; i<N; i++)\n\t\t{\n\t\t\tint d,m;\n\t\t\tscanf(\"%d%d\", &d,&m);\n\t\t\tday[d]=min(day[d], m);\n\t\t\tmaxd=max(d, maxd);\n\t\t}\n\t\t\n\t\tint ps[30];\n\t\t\n\t\tfor(int i=0; i<T; i++) ps[i]=999;\n\t\tps[0]=0;\n\t\t\n\t\tfor(int i=1; i<=maxd; i++)\n\t\t{\n\t\t\tint t[30];\n\t\t\tfor(int j=0; j<T; j++) t[j]=999;\n\t\t\t\n\t\t\tfor(int j=0; j<T; j++)\n\t\t\t{\n\t\t\t\tif(j+1>i) continue;\n\t\t\t\tif(cycle[j]>day[i]) continue;\n\t\t\t\n\t\t\t\tt[(j+1)%T]=ps[j];\n\t\t\t}\n\t\t\t\n\t\t\tfor(int j=0; j<T; j++)\n\t\t\t\tt[1%T]=min(t[1%T], ps[j]+1);\n\t\t\t\n\t\t\tfor(int j=0; j<T; j++) \n\t\t\t\tps[j]=t[j];\n\t\t}\n\t\t\n\t\tint ans=999;\n\t\tfor(int i=0; i<T; i++)\n\t\t\tans=min(ans, ps[i]);\n\t\t\t\n\t\tprintf(\"%d\\n\", ans);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <map>\n#include <algorithm>\n\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n\nusing namespace std;\n\nint main() {\n  while(1){\n    int t;\n    cin>>t;\n    if(!t)break;\n    vector<int> c(t);\n    REP(i,t)cin>>c[i];\n    int n;\n    cin>>n;\n    vector<int> d(n),m(n);\n    REP(i,n)cin>>d[i]>>m[i];\n    vector<int> itv(100,100);\n    REP(i,n){\n      --d[i];\n      itv[d[i]]=min(itv[d[i]], m[i]);\n    }\n    vector<vector<int>> dp(102,vector<int>(t,10000));\n    dp[0][t-1] = 0;\n    REP(i,100){\n      REP(j,t) {\n        dp[i+1][0] = min(dp[i+1][0], dp[i][j] + 1);\n      }\n      REP(j,t) {\n        if (itv[i] >= c[j])\n          dp[i+1][j] = min(dp[i+1][j], dp[i][(j+t-1)%t]);\n      }\n    }\n    cout<<*min_element(begin(dp[100]),end(dp[100]))<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<queue>\n\nusing namespace std;\n\ntypedef pair<int,int> P;\nconst int MAX = 101;\nconst int H = 31;\nconst int INF = (1<<25);\n\nstruct State{\n  int t,day,pos;\n  State(){}\n  State(int t, int day, int pos):t(t),day(day),pos(pos){}\n  bool operator < (const State& s) const {return t > s.t;}\n};\n\nint T[H][MAX];\nvector<int> Habit,V[MAX];\nint N;\n\nvoid init(){\n  Habit.clear();\n  for(int i = 0; i < MAX; i++) V[i].clear();\n  fill(T[0],T[0]+H*MAX,INF);\n}\n\nvoid input(){\n  Habit.resize(N);\n  for(int i = 0; i < N; i++)\n    cin >> Habit[i];\n\n  int m;\n  cin >> m;\n  for(int i = 0; i < m; i++){\n    int a,b;\n    cin >> a >> b;\n    V[a].push_back(b);\n  }\n \n  //  for(int i = 0; i < MAX; i++) sort(V[i].begin(),V[i].end());\n\n}\n\nvoid solve(){\n  priority_queue<State> Q;\n  Q.push(State(0,0,-1));\n  T[0][0] = 0;\n\n  while(!Q.empty()){\n    State now = Q.top();\n    Q.pop();\n    if(T[now.pos][now.day] < now.t) continue;\n    if(now.day >= MAX-1) break;\n\n    //use caffeine\n    State nex = now;\n    nex.day++;\n    nex.pos = 0;\n    nex.t++;\n    if(V[nex.day].size() == 0){\n      if(T[nex.pos][nex.day] > nex.t){\n\tT[nex.pos][nex.day] = nex.t;\n\tQ.push(nex);\n      }\n    }else if(V[nex.day][0] >= Habit[nex.pos] && T[nex.pos][nex.day] > nex.t){\n      T[nex.pos][nex.day] = nex.t;\n      Q.push(nex);\n    }\n\n    //do not use caffeine\n    nex = now;\n    nex.day++;\n    nex.pos = (nex.pos+1)%Habit.size();\n    if(V[nex.day].size() == 0){\n      if(T[nex.pos][nex.day] > nex.t){\n\tT[nex.pos][nex.day] = nex.t;\n\tQ.push(nex);\n      }\n    }else if(V[nex.day][0] >= Habit[nex.pos] && T[nex.pos][nex.day] > nex.t){\n      T[nex.pos][nex.day] = nex.t;\n      Q.push(nex);\n    }\n  }\n\n  int ans = INF;\n\n  for(int i = 0; i < H; i++)\n    ans = min(ans,T[i][MAX-1]);\n\n  cout << ans << endl;\n}\n\n\nint main(){\n  while(cin >> N && N){\n    init();\n    input();\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nconst int inf = 1e9;\n\nint main(){\n\twhile(1){\n\t\tint t;\n\t\tcin >> t;\n\t\tif(t==0) break;\n\t\t\n\t\tvector<int> dur(t);\n\t\tfor(int i=0; i<t; i++){\n\t\t\tcin >> dur[i];\n\t\t}\n\t\tint n;\n\t\tcin >> n;\n\t\tvector<int> sch(101, 24);\n\t\tint last=0;\n\t\tfor(int i=0; i<n; i++){\n\t\t\tint d,m;\n\t\t\tcin >> d >> m;\n\t\t\tsch[d] = min(sch[d], m);\n\t\t\tlast = max(last, d);\n\t\t}\n\t\t\n\t\tvector<vector<int> > dp(last+1, vector<int>(t, inf));\n\t\tdp[1][0] = 0;\n\t\tfor(int i=1; i<last; i++){\n\t\t\tfor(int j=0; j<t; j++){\n\t\t\t\tif(dp[i][j]==inf) continue;\n\t\t\t\tif(sch[i+1] >= dur[(j+1)%t]){\n\t\t\t\t\tdp[i+1][(j+1)%t] = min(dp[i][j], dp[i+1][(j+1)%t]);\n\t\t\t\t}\n\t\t\t\tdp[i+1][0] = min(dp[i+1][0], dp[i][j]+1);\n\t\t\t}\n\t\t}\n\t\t\n\t\tint ans=inf;\n\t\tfor(int i=0; i<t; i++){\n\t\t\tans = min(ans, dp[last][i]);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define rep1(i,n) for(int i=1;i<=(int)(n);i++)\n#define all(c) c.begin(),c.end()\n#define pb push_back\n#define fs first\n#define sc second\n#define show(x) cout << #x << \" = \" << x << endl\n#define chmin(x,y) x=min(x,y)\n#define chmax(x,y) x=max(x,y)\nusing namespace std;\nint T,t[30],N,d[101],m[101];\nint dp[101][30];\nmap<int,int> mp;\nint main(){\n\twhile(true){\n\t\tcin>>T;\n\t\tif(T==0) break;\n\t\trep(i,T) cin>>t[i];\n\t\tcin>>N;\n\t\tmp.clear();\n\t\trep(i,N){\n\t\t\tint x,y;\n\t\t\tcin>>x>>y;\n\t\t\tif(!mp.count(x-1)||mp[x-1]>y) mp[x-1]=y;\n\t\t}\n\t\tN=0;\n\t\tfor(auto p:mp){\n\t\t\td[N]=p.fs,m[N]=p.sc;\n\t\t\tN++;\n\t\t}\n\t\trep(i,N+1) rep(j,T) dp[i][j]=1e9;\n\t\tdp[0][0]=0;\n\t\trep(i,N) rep(j,T){\n\t\t\tint c=j+d[i];\n\t\t\tif(i>0) c-=d[i-1];\n\t\t\tc%=T;\n\t\t\tif(t[c]<=m[i]) chmin(dp[i+1][c],dp[i][j]);\n\t\t\tchmin(dp[i+1][0],dp[i][j]+1);\n\t\t}\n\t\tint ans=1e9;\n\t\trep(j,T) chmin(ans,dp[N][j]);\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<iomanip>\n#include<cmath>\n#include<vector>\n#include<algorithm>\n\nusing namespace std;\n\n#define int long long\n#define endl \"\\n\"\n\nconstexpr long long INF = (long long)1e18;\nconstexpr long long MOD = 1'000'000'007; \n\nstring yn(bool f){return f?\"Yes\":\"No\";}\nstring YN(bool f){return f?\"YES\":\"NO\";}\n\n\n\nsigned main(){\n\t// cin.tie(nullptr);\n\t// ios::sync_with_stdio(false);\n\t// cout<<fixed<<setprecision(10);\n\t\n\tconst int MAX = 102;\n\t\t\n\twhile(true){\n\t\tint T, N, maximum = 0;\n\t\tvector<int> sc(MAX, 30);\n\t\tvector<int> cycle, dp;\n\t\t\n\t\tcin>>T;\n\t\t\n\t\tif(!T) break;\n\t\t\n\t\tcycle.resize(T);\n\t\tdp.resize(MAX, INF);\n\t\t\n\t\tfor(int i = 0; i < T; i++){\n\t\t\tcin>>cycle[i];\n\t\t}\n\t\t\n\t\tcin>>N;\n\t\t\n\t\tfor(int i = 0; i < N; i++){\n\t\t\tint D, M;\n\t\t\t\n\t\t\tcin>>D>>M;\n\t\t\t\n\t\t\tmaximum = max(maximum, D+1);\n\t\t\t\n\t\t\tsc[D] = min(sc[D], M);\n\t\t}\n\t\t\n\t\t\n\t\tdp[1] = -1;\n\t\t\n\t\tfor(int i = 1; i <= maximum; i++){\n\t\t\t\n\t\t\tfor(int j = i+1; j <= maximum; j++){\n\t\t\t\tif(cycle[(j - i)%T] > sc[j]) {\n\t\t\t\t\t\n\t\t\t\t\tdp[j] = min(dp[j], dp[i] + 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tdp[j] = min(dp[j], dp[i] + 1);\n\t\t\t}\n\t\t\t// cout<<\"i = \"<<i<<\" dp \"<<dp[i]<<endl;\n\t\t}\n\t\t\n\t\tcout<<dp[maximum]<<endl;\n\t}\n\t\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <climits>\n#include <cfloat>\nusing namespace std;\n\nconst int INF = INT_MAX / 2;\n\nint main()\n{\n    for(;;){\n        int cycle;\n        cin >> cycle;\n        if(cycle == 0)\n            return 0;\n\n        vector<int> t(cycle);\n        for(int i=0; i<cycle; ++i)\n            cin >> t[i];\n\n        int n;\n        cin >> n;\n        vector<int> interview(101, 24);\n        for(int i=0; i<n; ++i){\n            int d, m;\n            cin >> d >> m;\n            interview[d] = min(interview[d], m);\n        }\n\n        vector<vector<int> > dp(101, vector<int>(cycle, INF));\n        dp[0][cycle-1] = 0;\n        for(int d=1; d<=100; ++d){\n            for(int prev=0; prev<cycle; ++prev){\n                int curr = (prev + 1) % cycle;\n                if(t[curr] <= interview[d])\n                    dp[d][curr] = min(dp[d][curr], dp[d-1][prev]);\n                else\n                    dp[d][0] = min(dp[d][0], dp[d-1][prev] + 1);\n            }\n        }\n\n        cout << *min_element(dp[100].begin(), dp[100].end()) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define ALL(v) (v).begin(), (v).end()\n#define LENGTHOF(x) (sizeof(x) / sizeof(*(x)))\n#define AFILL(a, b) fill((int*)a, (int*)(a + LENGTHOF(a)), b)\n#define SQ(x) ((x)*(x))\n#define Mod(x, mod) (((x)+(mod)%(mod))\n#define MP make_pair\n#define PB push_back\n#define Fi first\n#define Se second\n#define INF (1<<29)\n#define EPS 1e-10\n#define MOD 1000000007\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nint T, N;\nint t[32];\nint M[128];\nint dp[32][128];\n\nint dfs(int n, int d){\n  if(d==100) return 0;\n  int &res = dp[n][d];\n  if(res >= 0) return res;\n  res = INF;\n  if(t[n] <= M[d]) res = min(res, dfs((n+1)%T, d+1));\n  res = min(res, dfs(1, d+1)+1);\n  return res;\n}\n\nint main(){\n  while(scanf(\"%d\", &T) && T){\n    memset(dp, -1, sizeof(dp));\n    fill(M, M+100, 23);\n    rep(i,T) scanf(\"%d\", t+i);\n    scanf(\"%d\",&N);\n    rep(i,N){\n      int t,m;\n      scanf(\"%d%d\", &t,&m); t--;\n      M[t] = m;\n    }\n\n    printf(\"%d\\n\", dfs(0, 0));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nstatic const int INF = (1<<29);\n\nint T, t[30], N, D, M, dp[101][30], m[100];\n\nmain(){\n  while(cin >> T && T){\n    for(int i=0;i<T;i++) cin >> t[i];\n    cin >> N;\n    fill(m, m+N, INF);\n    for(int i=0;i<N;i++){\n      cin >> D >> M;\n      m[D-1] = min(m[D-1], M);\n    }\n    fill(dp[0], dp[N+1], INF);\n    dp[0][0] = 0;\n    for(int i=0;i<N;i++){\n      for(int j=0;j<T;j++){\n        if(t[j] <= m[i]){\n          dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T], dp[i][j]);\n          dp[i+1][0] = min(dp[i+1][0], dp[i][j]+1);\n        }\n      }\n    }\n    int ans = INF;\n    for(int i=0;i<T;i++) ans = min(ans, dp[N][i]);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <algorithm>\n#include <cstdio>\n#include <functional>\n#include <iostream>\n#include <cfloat>\n#include <climits>\n#include <cstring>\n#include <cmath>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <time.h>\n#include <vector>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> i_i;\ntypedef pair<ll, int> ll_i;\ntypedef pair<double, int> d_i;\ntypedef pair<ll, ll> ll_ll;\ntypedef pair<double, double> d_d;\nstruct edge { int u, v; double w; };\n\nll MOD = 1000000007;\nll _MOD = 1000000009;\ndouble EPS = 1e-10;\n\nint main() {\n\tfor (;;) {\n\t\tint T; cin >> T;\n\t\tif (T == 0) break;\n\t\tvector<int> t(T);\n\t\tfor (int j = 0; j < T; j++)\n\t\t\tcin >> t[j];\n\t\tvector<int> dp(T, INT_MAX);\n\t\tdp[0] = 0;\n\t\tint preD = 1;\n\t\tint N; cin >> N;\n\t\twhile (N--) {\n\t\t\tint D, M; cin >> D >> M;\n\t\t\tvector<int> _dp(T, INT_MAX);\n\t\t\tint mini = INT_MAX;\n\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\tint _j = (j + D - preD) % T;\n\t\t\t\t_dp[_j] = dp[j];\n\t\t\t\tmini = min(mini, dp[j]);\n\t\t\t}\n\t\t\t_dp[0] = min(_dp[0], mini + 1);\n\t\t\tfor (int j = 0; j < T; j++)\n\t\t\t\tif (t[j] > M)\n\t\t\t\t\t_dp[j] = INT_MAX;\n\t\t\tdp = _dp;\n\t\t\tpreD = D;\n\t\t}\n\t\tint mini = INT_MAX;\n\t\tfor (int j = 0; j < T; j++)\n\t\t\tmini = min(mini, dp[j]);\n\t\tcout << mini << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#define inf 1<<28\nusing namespace std;\n\nint main()\n{\n\n  while(1){\n    int T,t[101],n,a,b;\n    int d[101];\n    for(int i=0;i<101;i++)d[i]=inf;\n    cin>>T;\n    if(T==0)break;\n    for(int i=0;i<T;i++)cin>>t[i];\n    cin>>n;\n    for(int i=0;i<n;i++){\n      cin>>a>>b;\n      a--;\n      d[a]=min(d[a],b);\n    }\n\n    int dp[101][31];\n    for(int i=0;i<101;i++)for(int j=0;j<31;j++)dp[i][j]=inf;\n    dp[0][0]=0;\n    for(int k=0;k<100;k++){\n      for(int i=0;i<T;i++){\n        if(t[(i+1)%T]<=d[k+1])dp[k+1][(i+1)%T]=min(dp[k+1][(i+1)%T],dp[k][i]);\n        dp[k+1][0]=min(dp[k+1][0],dp[k][i]+1);\n      }\n    }\n    int ans=inf;\n    for(int i=0;i<T;i++)ans=min(ans,dp[100][i]);\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef long double ld;\nconst ld eps=1e-8;\nint main() {\n\tint t; \n\twhile (cin >> t, t) {\n\t\tint Cyc[30];\n\t\trep(i, t) {\n\t\t\tcin >> Cyc[i];\n\t\t}\n\t\tint cyc[120];\n\t\trep(i, 4*t) {\n\t\t\tcyc[i] = Cyc[i%t];\n\t\t}\n\t\tint n; cin >> n;\n\t\tint view[100];\n\t\tfill(view, view + 100, 24);\n\t\trep(i, n) {\n\t\t\tint d, m; cin >> d >> m; d--;\n\t\t\tview[d] = m;\n\t\t}\n\t\tint dp[101][101];\n\t\trep(i, 101) {\n\t\t\trep(j, 101) {\n\t\t\t\tdp[i][j] = (int)MOD;\n\t\t\t}\n\t\t}\n\t\tdp[0][0] = 0;\n\t\tRep(i, 1, 101) {\n\t\t\trep(j, i) {\n\t\t\t\tif (dp[j][i - 1] == (int)MOD)continue;\n\t\t\t\tint dif = i - j;\n\t\t\t\tif (cyc[dif] <= view[i]) {\n\t\t\t\t\tdp[j][i] = min(dp[j][i], dp[j][i - 1]);\n\t\t\t\t}\n\t\t\t\tdp[i][i] = min(dp[i][i], dp[j][i - 1] + 1);\n\t\t\t}\n\t\t}\n\t\tint mi = (int)MOD;\n\t\trep(i, 101) {\n\t\t\tmi = min(mi, dp[i][100]);\n\t\t}\n\t\tcout << mi << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MAX 105\n#define INF (1<<26)\nint T,N;\nint t[MAX],M[MAX];\nint mem[MAX][MAX];\n\nint solve(int x,int y){\n  if(mem[x][y]!=-1)return mem[x][y];\n  if(x==100)return 0;\n  int res=solve(x+1,1)+1;\n  if(t[y]<=M[x])res=min(res,solve(x+1,(y+1)%T));\n  return mem[x][y]=res;\n}\n\nvoid init(){\n  for(int i=0;i<MAX;i++){\n    M[i]=INF;\n    for(int j=0;j<MAX;j++){\n      mem[i][j]=-1;\n    }\n  }\n}\nint main(){\n  while(1){\n    cin>>T;\n    if(T==0)break;\n    init();\n    for(int i=0;i<T;i++)cin>>t[i];\n    cin>>N;\n    for(int i=0;i<N;i++){\n      int a;\n      cin>>a;\n      cin>>M[a-1];\n    }\n    cout<<solve(0,0)<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\nusing namespace std;\n\nint T;\nint n;\nint ti[101];\nint d[101];\nint dp[101][31];\nint finD;\n\nconst int INF=1000000000;\nint main(){\n\twhile(cin>>T&&T){\n\t\tfor(int i=0;i<T;i++)cin>>ti[i];\n\t\tcin>>n;\n\t\tmemset(dp,-1,sizeof(dp));\n\t\tmemset(d,-1,sizeof(d));\n\t\tfinD=0;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tint da,m;\n\t\t\tcin>>da>>m;\n\t\t\tfinD=max(finD,da);\n\t\t\tif(d[da]==-1)d[da]=m;\n\t\t\telse d[da]=min(d[da],m);\n\t\t}\n\t\tfor(int i=0;i<31;i++)dp[finD+1][i]=0;\n\t\tfor(int i=finD;i>=0;i--){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tdp[i][j]=INF;\n\t\t\t\tdp[i][j]=min(dp[i][j],dp[i+1][1%T]+1);\n\t\t\t\tif(d[i]==-1||d[i]>=ti[j])dp[i][j]=min(dp[i][j],dp[i+1][(j+1)%T]);\n\t\t\t}\n\t\t}\n\t\tint res=dp[1][0];\n\t\tcout<<res<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long   // <-----!!!!!!!!!!!!!!!!!!!\n\n#define rep(i,n) for (int i=0;i<(n);i++)\n#define rep2(i,a,b) for (int i=(a);i<(b);i++)\n#define rrep(i,n) for (int i=(n)-1;i>=0;i--)\n#define rrep2(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n\ntypedef long long ll;\ntypedef pair<int, int> Pii;\ntypedef tuple<int, int, int> TUPLE;\ntypedef vector<int> V;\ntypedef vector<V> VV;\ntypedef vector<VV> VVV;\ntypedef vector<vector<int>> Graph;\nconst int inf = 1e9;\nconst int mod = 1e9 + 7;\n\nint T, N;\nint t[30];\nint m[100]; // the first meeting time of the day\nint memo[100][30];\nint dfs(int day, int step) {\n    if (day == N) return 0;\n    if (memo[day][step] != -1) return memo[day][step];\n    if (m[day] < t[step]) return inf;\n\n    return min(dfs(day + 1, (step + 1) % T), dfs(day + 1, 0) + 1);\n}\n\nsigned main() {\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(0);\n\n    while (cin >> T, T) {\n        rep(i, T) cin >> t[i];\n        cin >> N;\n        fill(m, m + 100, inf);\n        rep(i, N) {\n            int D, M;\n            cin >> D >> M;\n            D--;\n            m[D] = min(m[D], M);\n        }\n        rep(i, 100) fill(memo[i], memo[i] + 30, -1);\n        cout << dfs(0, 0) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint dp[31][105],cycle[31];\nint interview[105];\n\nint main() {\n    int t,n,d,m;\n    while(cin>>t, t) {\n        for(int i=0; i<t; ++i) cin>>cycle[i];\n        cin>>n;\n        for(int i=0; i<105; ++i) interview[i] = 24;\n        for(int i=0; i<n; ++i) {\n            cin>>d>>m;\n            interview[d] = min(interview[d], m);\n        }\n        for(int i=0; i<31; ++i) for(int j=0; j<105; ++j) dp[i][j] = 1<<29;\n        dp[0][0] = 0;\n\n        //cout<<\"end init\"<<endl;\n\n        for(int i=0; i<104; ++i) {\n            for(int j=0; j<t; ++j) {\n                dp[0][i+1] = min(dp[0][i+1], dp[j][i]+1);\n                if(interview[i] >= cycle[j]) {\n                    if(j+1 == t) dp[0][i+1] = min(dp[0][i+1], dp[j][i]);\n                    else dp[j+1][i+1] = min(dp[j+1][i+1], dp[j][i]);\n                }\n            }\n            // cout<<i<<endl;\n            // for(int j=0; j<t; ++j) cout<<dp[j][i]<<\" \";\n            // cout<<endl;\n        }\n\n        int ans = 1<<29;\n        for(int j=0; j<t; ++j) ans = min(ans, dp[j][104]);\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\n#define int long long\nusing namespace std;\ntypedef pair<int, int> P;\nconst int INF = 1e9;\n\nint T, N;\nvector<int> t;\nint tm[110];\nint ed;\n\nint memo[110];\n\nint solve(int idx){\n    if(memo[idx] != -1) return memo[idx];\n    if(idx > ed) return 0;\n    int res = INF;\n    int startDay = idx;\n    rep(i, idx, ed + 1){\n        int nowDay = i;\n        int wake = t[(nowDay - startDay) % T];\n        // cout << idx << \" \" << i << ' ' << nowDay << \" \" << wake << endl;\n        if(wake > tm[i]) break;\n        int tmp = solve(i + 1);\n        res = min(res, tmp);\n    }\n    // cout << idx << ' ' << res + 1 << endl;\n    return memo[idx] = res + 1;\n}\n\nsigned main(){\n    while(cin >> T, T){\n        t.clear();\n        t.resize(T);\n        rep(i, 0, T) cin >> t[i];\n        cin >> N;\n        memset(memo, -1, sizeof(memo));\n        rep(i, 0, 110) tm[i] = INF;\n        rep(i, 0, N){\n            int a, b;\n            cin >> a >> b;\n            a--;\n            tm[a] = min(tm[a], b);\n        }\n        rep(i, 0, 110){\n            if(tm[i] == INF) continue;\n            ed = i;\n            // cout << \" \" << i << \" \" << tm[i] << endl;\n        }\n        int ans = solve(0);\n        cout << ans - 1 << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <algorithm>\n#include <cstdio>\n#include <functional>\n#include <iostream>\n#include <cfloat>\n#include <climits>\n#include <cstring>\n#include <cmath>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <time.h>\n#include <vector>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> i_i;\ntypedef pair<ll, int> ll_i;\ntypedef pair<double, int> d_i;\ntypedef pair<ll, ll> ll_ll;\ntypedef pair<double, double> d_d;\nstruct edge { int u, v; double w; };\n\nll MOD = 1000000007;\nll _MOD = 1000000009;\ndouble EPS = 1e-10;\n\nint main() {\n\tfor (;;) {\n\t\tint T; cin >> T;\n\t\tif (T == 0) break;\n\t\tvector<int> t(T);\n\t\tfor (int j = 0; j < T; j++)\n\t\t\tcin >> t[j];\n\t\tint N; cin >> N;\n\t\tvector<i_i> DM(N);\n\t\tfor (int i = 0; i < N; i++)\n\t\t\tcin >> DM[i].first >> DM[i].second;\n\t\tsort(DM.begin(), DM.end());\n\t\tvector<int> D(N), M(N);\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tD[i] = DM[i].first;\n\t\t\tM[i] = DM[i].second;\n\t\t}\n\t\tvector<int> dp(T, INT_MAX);\n\t\tdp[0] = 0;\n\t\tint preD = 1;\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tvector<int> _dp(T, INT_MAX);\n\t\t\tint mini = INT_MAX;\n\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\tint _j = (j + D[i] - preD) % T;\n\t\t\t\t_dp[_j] = dp[j];\n\t\t\t\tmini = min(mini, dp[j]);\n\t\t\t}\n\t\t\t_dp[0] = min(_dp[0], mini + 1);\n\t\t\tfor (int j = 0; j < T; j++)\n\t\t\t\tif (t[j] > M[i])\n\t\t\t\t\t_dp[j] = INT_MAX;\n\t\t\tdp = _dp;\n\t\t\tpreD = D[i];\n\t\t}\n\t\tint mini = INT_MAX;\n\t\tfor (int j = 0; j < T; j++)\n\t\t\tmini = min(mini, dp[j]);\n\t\tcout << mini << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef pair<int,int> pii;\n#define all(c) (c).begin(), (c).end()\n#define loop(i,a,b) for(ll i=a; i<ll(b); i++)\n#define rep(i,b) loop(i,0,b)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define lb lower_bound\n#define ub upper_bound\n#ifdef DEBUG\n#define dump(...) (cerr<<#__VA_ARGS__<<\" = \"<<(DUMP(),__VA_ARGS__).str()<<\" [\"<<__LINE__<<\"]\"<<endl)\nstruct DUMP:ostringstream{template<class T>DUMP &operator,(const T&t){if(this->tellp())*this<<\", \";*this<<t;return *this;}};\n#else\n#define dump(...)\n#endif\ntemplate<class T> ostream& operator<<(ostream& os, vector<T> const& v){\n    rep(i,v.size()) os << v[i] << (i+1==v.size()?\"\":\" \");\n    return os;\n}\n\nint T, t[30];\nint N;\nint M[101];\n\nint dp[101];\n\n// x日目以降の最小\nint rec(int x){\n    if(x > 100) return 0;\n    int & res = dp[x];\n    if(res != -1) return res;\n    int ans = 1<<29;\n    bool ok = true;\n    for(int i=1; x+i<=100; i++){\n        ans = min(1+rec(x+i) , ans);\n        if(M[x+i] < t[i%T]){\n            ans = min(1+rec(x+i) , ans);\n            ok = false;\n            break;\n        }\n    }\n    if(ok) ans = 0;\n    return res = ans;\n}\n\nint main(){\n#ifdef LOCAL\n    freopen(\"in\",\"r\",stdin);\n#endif\n    while(cin>>T && T){\n        memset(dp,-1,sizeof(dp));\n        rep(i,101) M[i] = 24;\n        rep(i,T) cin >> t[i];\n        cin >> N;\n        rep(i,N){\n            int x; cin >> x;\n            cin >> M[x];\n        }\n        cout << rec(1) << endl;\n        dump(vi(dp,dp+20));\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\nusing namespace std;\n\nint main(){\n    int m;\n    while(cin >> m, m){\n        vector<int> t(m);\n        for(int i = 0; i < m; i++)  cin >> t[i];\n        vector<int> d(100, 24);\n        int n;\n        cin >> n;\n        for(int i = 0; i < n; i++){\n            int a, b;\n            cin >> a >> b;\n            d[a-1] = min(d[a-1], b);\n        }\n        vector<vector<int>> dp(100, vector<int>(m, 1<<30));\n        dp[0][0] = 0;\n        for(int i = 0; i+1 < 100; i++){\n            for(int j = 0; j < m; j++){\n                if(dp[i][j] == 1<<30)   continue;\n                dp[i+1][0] = min(dp[i+1][0], dp[i][j]+1);\n                if(t[(j+1)%m] <= d[i+1])   dp[i+1][(j+1)%m] = min(dp[i+1][(j+1)%m], dp[i][j]);\n            }\n        }\n        int ans = 1<<30;\n        for(int j = 0; j < m; j++)  ans = min(ans, dp[99][j]);\n        cout << ans << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iostream>\n#include <iterator>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\nusing namespace std;\n\n#define lengthof(array) (sizeof(array) / sizeof(*array))\n#define dump(a) (cerr << (#a) << \" = \" << (a) << endl)\n#define FOR(it,c) for(__typeof((c).begin())it=(c).begin(); it!=(c).end();++it)\n#define RFOR(it,c) for(__typeof((c).rbegin())it=(c).rbegin(); it!=(c).rend();++it)\n\ntemplate<class T> inline void chmax(T& a, const T& b) { if(b > a) a = b; }\ntemplate<class T> inline void chmin(T& a, const T& b) { if(b < a) a = b; }\n\ntemplate<typename T, typename U> ostream& operator<<(ostream& os, const pair<T, U>& p) {\n\tos << '(' << p.first << \", \" << p.second << ')';\n\treturn os;\n}\n\ntemplate<typename T> ostream& operator<<(ostream& os, const vector<T>& v) {\n\tcopy(v.begin(), v.end(), ostream_iterator<T>(os, \" \"));\n\treturn os;\n}\n\n#define D first\n#define M second\n\nint n, c;\nint t[30], d[101], m[101];\nint memo[101][30];\npair<int, int> inter[101];\n\nint dfs(int idx = 0, int cycle = inter[0].D - 1) {\n\tif(idx == n)\n\t\treturn 0;\n\n\tif(memo[idx][cycle] != -1)\n\t\treturn memo[idx][cycle];\n\n\tint res = dfs(idx + 1, (inter[idx + 1].D - inter[idx].D) % c) + 1;\n\tif(t[cycle] <= inter[idx].M)\n\t\tchmin(res, dfs(idx + 1, (cycle + inter[idx + 1].D - inter[idx].D) % c));\n\n\treturn memo[idx][cycle] = res;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\twhile(cin >> c, c) {\n\t\tfor(int i = 0; i < c; ++i)\n\t\t\tcin >> t[i];\n\n\t\tcin >> n;\n\t\tfor(int i = 0; i < n; ++i)\n\t\t\tcin >> inter[i].D >> inter[i].M;\n\n\t\tsort(inter, inter + n);\n\t\tmemset(memo, -1, sizeof(memo));\n\t\tcout << dfs() << endl;\n\t}\n\n\treturn EXIT_SUCCESS;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i, n) for(int i = 0; i < (n); i++)\n#define repp(i, l, r) for(int i = (l); i < (r); i++)\n#define per(i, n) for(int i = ((n)-1); i >= 0; i--)\n#define perr(i, l, r) for(int i = ((r)-1); i >= (l); i--)\n#define all(x) (x).begin(),(x).end()\n#define MOD 1000000007\n#define IINF 1000000000\n#define LINF 1000000000000000000\n#define SP <<\" \"<<\n#define CYES cout<<\"Yes\"<<endl\n#define CNO cout<<\"No\"<<endl\n#define CFS cin.tie(0);ios::sync_with_stdio(false)\n\ntypedef long long LL;\ntypedef long double LD;\n\nint main(){\n  while(1){\n    int t;\n    cin >> t;\n    if(t==0) return 0;\n    vector<int> s(t);\n    rep(i,t) cin >> s[i];\n    int n;\n    cin >> n;\n    vector<pair<int,int>> dm(n);\n    rep(i,n){\n      cin >> dm[i].first >> dm[i].second;\n      dm[i].first--;\n    }\n    sort(all(dm));\n    // rep(i,n){\n    //   cout << dm[i].first SP dm[i].second << endl;\n    // }\n    vector<int> c(100,IINF);\n    c[0]=0;\n    int now=0;\n    rep(i,100){\n      int co=IINF;\n      rep(j,i) co=min(co,c[j]);\n      c[i]=min(c[i],co+1);\n      while(dm[now].first==i){\n        rep(j,100){\n          if(s[(dm[now].first-j)%t]>dm[now].second) c[j]=IINF;\n        }\n        now++;\n        if(now>=n) break;\n      }\n      // rep(j,i+1) cout << c[j] << \" \";\n      // cout << endl;\n    }\n    int ans=IINF;\n    rep(i,100){\n      ans=min(ans,c[i]);\n      // cout << c[i] << \" \";\n    }\n    // cout << endl;\n    cout << ans << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include\"bits/stdc++.h\"\n\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\nusing pii = pair<int, int>;\nusing pll = pair<ll, ll>;\n\n#define FOR(k,m,n) for(ll (k)=(m);(k)<(n);(k)++)\n#define REP(i,n) FOR((i),0,(n))\n#define WAITING(str) int str;std::cin>>str;\n#define DEBUGING(str) cout<< #str << \" \" str<<endl\n\nconstexpr int INF = (1 << 30);\nconstexpr ll INFL = (1ll << 60);\nconstexpr ll MOD = 1000000007;// 10^9+7\nconstexpr int H = 24;\n\n\nint main()\n{\n\twhile (true) {\n\t\tint T, N;\n\t\tcin >> T;\n\t\tif (!T)break;\n\t\tvector<int> t(T);\n\t\tREP(i, T)cin >> t[i];\n\t\tcin >> N;\n\t\tvector<pair<int, int>> dm(N);\n\t\tREP(i, N) {\n\t\t\tint d, m;\n\t\t\tcin >> d >> m;\n\t\t\tdm[i] = { d - 1,m };\n\t\t}\n\t\tsort(dm.begin(), dm.end());\n\n\t\tint day = 0;\n\t\tfor (auto p : dm)day = max(day, p.first);\n\t\tvector<vector<int>> dp(day + 1, vector<int>(T, INF));\n\t\tdp[0][0] = 0;\n\t\tFOR(i, 1, day + 1) {\n\t\t\tFOR(j, 1, T)dp[i][j] = dp[i - 1][j - 1];\n\t\t\tdp[i][0] = *min_element(dp[i - 1].begin(), dp[i - 1].end()) + 1;\n\t\t\tdp[i][0] = min(dp[i][0], dp[i - 1].back());\n\t\t\tfor (auto p : dm)if (p.first == i) {\n\t\t\t\tREP(j, T)if (t[j] > p.second)dp[i][j] = INF;\n\t\t\t}\n\t\t}\n\t\tcout << *min_element(dp.back().begin(), dp.back().end()) << endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#define INF 1e8\n#define MAX_N 110\nusing namespace std;\nint t[MAX_N];\nint start[MAX_N];\nint dp[MAX_N][MAX_N];\nint max_day, T, N;\nint solve(int i, int j)\n{\n    if(i == max_day + 1) return 0;\n    if(dp[i][j] != -1) return dp[i][j];\n    int ret = INF;\n    for(int k = 0; k < T; k++)\n    {\n        if(t[j] > start[i])\n        {\n            //カフェインを取る\n            ret = min(ret, solve(i + 1, 1) + 1);\n        }\n        else  ret = min(ret, solve(i + 1, (j + 1) % T));\n    }\n    cout << i << \" \" << j << \" \" << ret << endl;\n    return dp[i][j] = ret;\n}\nint main()\n{\n    while(cin >> T, T)\n    {\n        for(int i = 0; i < T; i++) cin >> t[i];\n        memset(dp, -1, sizeof(dp));\n        cin >> N;\n        int d, m;\n        for(int i = 0; i < MAX_N; i++) start[i] = INF;\n        for(int i = 0; i < N; i++)\n        {\n            cin >> d >> m;\n            d--;\n            start[d] = min(start[d], m);\n            max_day = max(d, max_day);\n        }\n        int ans = solve(0, 0);\n        cout << ans << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(int argc, char *argv[]){\n  int t;\n  while(cin >> t, t){\n    int time[t];\n    for (int i = 0; i < t; i++) {\n      cin >> time[i];\n    }\n    int n, max_day = 0;\n    cin >> n;\n    int plan[100];\n    for (int i = 0; i < 100; i++) {\n      plan[i] = 24;\n    }\n    for (int i = 0; i < n; i++) {\n      int d, m;\n      cin >> d >> m;\n      d--;\n      plan[d] = m;\n      max_day = max(max_day, d);\n    }\n    int dp[t][max_day + 1];\n    for (int i = 0; i < max_day; i++) {\n      for (int j = 0; j < t; j++) {\n        dp[j][i] = 1e9;\n      }\n    }\n    dp[0][0] = 0;\n    for (int i = 0; i < max_day; i++) {\n      for (int j = 0; j < t; j++) {\n        if(time[i] <= plan[i]){\n          dp[(j + 1) % t][i + 1] = min(dp[(j + 1) % t][i + 1],\n                                       dp[j][i]);\n        }\n        dp[0][i + 1] = min(dp[0][i + 1], dp[j][i] + 1);\n      }\n    }\n    int ans = 1e9;\n    for (int i = 0; i < t; i++) {\n      ans = min(ans, dp[i][max_day]);\n    }\n    std::cout << ans << std::endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "// Header {{{\n// includes {{{\n#include <algorithm>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <iostream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <sys/time.h>\n#include <unistd.h>\n#include <vector>\n// }}}\nusing namespace std;\n// consts {{{\nstatic const int INF = 1e9;\nstatic const double PI = acos(-1.0);\nstatic const double EPS = 1e-10;\n// }}}\n// typedefs {{{\ntypedef long long int LL;\ntypedef unsigned long long int ULL;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\ntypedef vector<ULL> VULL;\ntypedef vector<VULL> VVULL;\ntypedef vector<double> VD;\ntypedef vector<VD> VVD;\ntypedef vector<bool> VB;\ntypedef vector<VB> VVB;\ntypedef vector<char> VC;\ntypedef vector<VC> VVC;\ntypedef vector<string> VS;\ntypedef vector<VS> VVS;\ntypedef pair<int, int> PII;\ntypedef complex<int> P;\n#define PQ(type) priority_queue<type>\n// priority queue reverse\n#define PQR(type) priority_queue< type, vector<type>, greater<type> >\n// }}}\n// macros & inline functions {{{\n// syntax sugars {{{\n#define FOR(i, b, e) for (typeof(e) i = (b); i < (e); ++i)\n#define FORI(i, b, e) for (typeof(e) i = (b); i <= (e); ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define REPI(i, n) FORI(i, 0, n)\n#define OPOVER(_op, _type) inline bool operator _op (const _type &t) const\n#define ASSIGN_MAX(var, val) ((var) = max((var), (val)))\n#define ASSIGN_MIN(var, val) ((var) = min((var), (val)))\n// }}}\n// conversion {{{\ninline int toInt(string s) { int v; istringstream sin(s); sin>>v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout<<x; return sout.str(); }\n// }}}\n// array and STL {{{\n#define ARRSIZE(a) ( sizeof(a) / sizeof(a[0]) )\n#define ZERO(a, v) ( assert(v == 0 || v == -1), memset(a, v, sizeof(a)) )\n#define F first\n#define S second\n#define MP(a, b) make_pair(a, b)\n#define SIZE(a) ((LL)a.size())\n#define PB(e) push_back(e)\n#define SORT(v) sort((v).begin(), (v).end())\n#define RSORT(v) sort((v).rbegin(), (v).rend())\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EACH(c, it) for(typeof((c).begin()) it=(c).begin(); it!=(c).end(); ++it)\n#define REACH(c, it) for(typeof((c).rbegin()) it=(c).rbegin(); it!=(c).rend(); ++it)\n#define EXIST(s, e) ((s).find(e) != (s).end())\n// }}}\n// bit manipulation {{{\n// singed integers are not for bitwise operations, specifically arithmetic shifts ('>>', and maybe not good for '<<' too)\n#define IS_UNSIGNED(n) (!numeric_limits<typeof(n)>::is_signed)\n#define BIT(n) (assert(IS_UNSIGNED(n)), assert(n < 64), (1ULL << (n)))\n#define BITOF(n, m) (assert(IS_UNSIGNED(n)), assert(m < 64), ((ULL)(n) >> (m) & 1))\ninline int BITS_COUNT(ULL b) { int c = 0; while(b != 0) { c += (b & 1); b >>= 1; } return c; }\ninline int MSB(ULL b) { int c = 0; while(b != 0) { ++c; b >>= 1; } return c-1; }\ninline int MAKE_MASK(ULL upper, ULL lower) { assert(lower < 64 && upper < 64 && lower <= upper); return (BIT(upper) - 1) ^ (BIT(lower) - 1); }\n// }}}\n// for readable code {{{\n#define EVEN(n) (n % 2 == 0)\n#define ODD(n) (!EVEN(n))\n// }}}\n// debug {{{\n#define arrsz(a) ( sizeof(a) / sizeof(a[0]) )\n#define dprt(fmt, ...) if (opt_debug) { fprintf(stderr, fmt, ##__VA_ARGS__); }\n#define darr(a) if (opt_debug) { copy( (a), (a) + arrsz(a), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define darr_range(a, f, t) if (opt_debug) { copy( (a) + (f), (a) + (t), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define dvec(v) if (opt_debug) { copy( ALL(v), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define darr2(a) if (opt_debug) { FOR(__i, 0, (arrsz(a))){ darr( (a)[__i] ); } }\n#define WAIT() if (opt_debug) { string _wait_; cerr << \"(hit return to continue)\" << endl; getline(cin, _wait_); }\n#define dump(x) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #x << \" = \" << (x) << endl; }\n// dump vector elements in [s, e)\n#define dumpv(v, s, e) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #v << \" = \"; FOR(__i, s, e) { cerr << v[__i] << \"\\t\"; } cerr << endl; }\n#define dumpl(x) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #x << endl << (x) << endl; }\n#define dumpf() if (opt_debug) { cerr << __PRETTY_FUNCTION__ << endl; }\n#define where() if (opt_debug) { cerr << __FILE__ << \": \" << __PRETTY_FUNCTION__ << \" [L: \" << __LINE__ << \"]\" << endl; }\n#define show_bits(b, s) if(opt_debug) { REP(i, s) { cerr << BITOF(b, s-1-i); if(i%4 == 3) cerr << ' '; } cerr << endl; }\n\n// ostreams {{{\n// complex\ntemplate<typename T> ostream& operator<<(ostream& s, const complex<T>& d) {return s << \"(\" << d.real() << \", \" << d.imag() << \")\";}\n\n// pair\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& s, const pair<T1, T2>& d) {return s << \"(\" << d.first << \", \" << d.second << \")\";}\n\n// vector\ntemplate<typename T> ostream& operator<<(ostream& s, const vector<T>& d) {\n\tint len = d.size();\n\tREP (i, len) {\n\t\ts << d[i]; if (i < len - 1) s << \"\\t\";\n\t}\n\treturn s;\n}\n\n// 2 dimentional vector\ntemplate<typename T> ostream& operator<<(ostream& s, const vector< vector<T> >& d) {\n\tint len = d.size();\n\tREP (i, len) {\n\t\ts << d[i] << endl;\n\t}\n\treturn s;\n}\n\n// map\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& s, const map<T1, T2>& m) {\n\ts << \"{\" << endl;\n\tfor (typeof(m.begin()) itr = m.begin(); itr != m.end(); ++itr) {\n\t\ts << \"\\t\" << (*itr).first << \" : \" << (*itr).second << endl;\n\t}\n\ts << \"}\" << endl;\n\treturn s;\n}\n// }}}\n// }}}\n// }}}\n// time {{{\ninline double now(){ struct timeval tv; gettimeofday(&tv, NULL); return (static_cast<double>(tv.tv_sec) + static_cast<double>(tv.tv_usec) * 1e-6); }\n// }}}\n// string manipulation {{{\ninline VS split(string s, char delimiter) { VS v; string t; REP(i, s.length()) { if(s[i] == delimiter) v.PB(t), t = \"\"; else t += s[i]; } v.PB(t); return v; }\ninline string join(VS s, string j) { string t; REP(i, s.size()) { t += s[i] + j; } return t; }\n// }}}\n// geometry {{{\n#define Y real()\n#define X imag()\n// }}}\n// 2 dimentional array {{{\nenum { UP, RIGHT, DOWN, LEFT, UP_RIGHT, DOWN_RIGHT, DOWN_LEFT, UP_LEFT };\nP dydx4[4] = { P(-1, 0), P(0, 1), P(1, 0), P(0, -1) };\nP dydx8[8] = { P(-1, 0), P(0, 1), P(1, 0), P(0, -1), P(-1, 1), P(1, 1), P(1, -1), P(-1, -1) };\nbool in_field(int H, int W, P p) {\n\treturn (0 <= p.Y && p.Y < H) && (0 <= p.X && p.X < W);\n}\n// }}}\n// input and output {{{\ninline void input(string filename) {\n\tfreopen(filename.c_str(), \"r\", stdin);\n}\ninline void output(string filename) {\n\tfreopen(filename.c_str(), \"w\", stdout);\n}\n// }}}\n// }}}\n\n// Header under development {{{\n\nint LCM(int a, int b) {\n\t// FIXME\n\treturn a * b;\n}\n\n// Fraction class {{{\n// ref: http://martin-thoma.com/fractions-in-cpp/\nclass Fraction {\n\tpublic:\n\t\tULL numerator;\n\t\tULL denominator;\n\t\tFraction(ULL _numerator, ULL _denominator) {\n\t\t\tassert(_denominator > 0);\n\t\t\tnumerator = _numerator;\n\t\t\tdenominator = _denominator;\n\t\t};\n\n\t\tFraction operator*(const ULL rhs) {\n\t\t\treturn Fraction(this->numerator * rhs, this->denominator);\n\t\t};\n\n\t\tFraction operator*(const Fraction& rhs) {\n\t\t\treturn Fraction(this->numerator * rhs.numerator, this->denominator * rhs.denominator);\n\t\t}\n\n\t\tFraction operator+(const Fraction& rhs) {\n\t\t\tULL lcm = LCM(this->denominator, rhs.denominator);\n\t\t\tULL numer_lhs = this->numerator * (this->denominator / lcm);\n\t\t\tULL numer_rhs = rhs.numerator * (rhs.numerator / lcm);\n\t\t\treturn Fraction(numer_lhs + numer_rhs, lcm);\n\t\t}\n\n\t\tFraction& operator+=(const Fraction& rhs) {\n\t\t\tFraction result = (*this) + rhs;\n\t\t\tthis->numerator = result.numerator;\n\t\t\tthis->denominator = result.denominator;\n\t\t\treturn *this;\n\t\t}\n};\n\nstd::ostream& operator<<(std::ostream &s, const Fraction &a) {\n\tif (a.denominator == 1) {\n\t\ts << a.numerator;\n\t} else {\n\t\ts << a.numerator << \"/\" << a.denominator;\n\t}\n\treturn s;\n}\n\n// }}}\n\n// }}}\n\nbool opt_debug = false;\n\nint main(int argc, char** argv) {\n\tstd::ios_base::sync_with_stdio(false);\n\t// set options {{{\n\tint __c;\n\twhile ( (__c = getopt(argc, argv, \"d\")) != -1 ) {\n\t\tswitch (__c) {\n\t\t\tcase 'd':\n\t\t\t\topt_debug = true;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tabort();\n\t\t}\n\t}\n\t// }}}\n\n\t// opt_debug = true;\n\t// input(\"./inputs/0.txt\");\n\t// output(\"./outputs/0.txt\");\n\n\tint T;\n\twhile (cin >> T, T) {\n\t\tVI cycle(T);\n\t\tREP (i, T) {\n\t\t\tcin >> cycle[i];\n\t\t}\n\t\tint N; cin >> N;\n\t\tVI wakeup_time(N, INF);\n\t\tREP (i, N) {\n\t\t\tint D, M; cin >> D >> M;\n\t\t\twakeup_time[D-1] = min(wakeup_time[D-1], M);\n\t\t}\n\n\t\tVVI dp(N, VI(T, INF));\n\t\tdp[0][0] = 0;\n\t\tFOR (d, 1, N) {\n\t\t\t// caffainate\n\t\t\tREP (t, T) {\n\t\t\t\tdp[d][0] = min(dp[d][0], dp[d-1][t] + 1);\n\t\t\t}\n\t\t\t// non caffaine\n\t\t\tREP (t, T) {\n\t\t\t\tif (cycle[t] <= wakeup_time[d]) {\n\t\t\t\t\tdp[d][t] = min(dp[d][t], dp[d-1][(t - 1 + T) % T]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tint ans = INF;\n\t\tREP (t, T) {\n\t\t\tans = min(ans, dp[N-1][t]);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}\n\n// vim: foldmethod=marker"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <climits>\n#include <cassert>\nusing namespace std;\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\ntypedef long long ll;\n\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define FOR(i,a,b) for(int i=(a); i<(b); ++i)\n#define REP(i,n) FOR(i,0,n)\n\nconst int INF = INT_MAX/10;\n\nbool ok(int M, int t) {\n    return (t<=M);\n}\n\nint main() {\n\tint T;\n    while(cin >> T, T) {\n        vi ti(T);\n        REP(i, T) {\n            cin >> ti[i];\n\t    }\n\n        int N;\n        cin >> N;\n        vvi data(N, vi(2));\n        REP(i, N) {\n            cin >> data[i][0] >> data[i][1];\n\t    }\n        sort(ALL(data));\n        int tmpN = N;\n        FOR(i,1,N) {\n            if(data[i][0] == data[i-1][0]) {\n                data[i-1][1] = min(data[i-1][1], data[i][1]);\n                data.erase(data.begin()+i);\n                i--;\n                N--;\n\t\t\t}\n\t\t}\n\n        int dmax = data[N-1][0];\n    \n        vvi dp(dmax+1, vi(T+1, INF));\n        dp[1][1] = 0;\n\n        int dpos = 0;\n        if(data[0][0] == 1) {\n            dpos++;\n\t    }\n\n        FOR(dd, 2, dmax+1) {\n            FOR(tt, 1, T) {\n                dp[dd][1] = min(dp[dd][1], dp[dd-1][tt]+1);\n\t\t    }\n            dp[dd][1] = min(dp[dd][1], dp[dd-1][T]);\n\n            FOR(tt, 2, T+1) {\n                if(data[dpos][0] == dd) {\n                    if(ok(data[dpos][1], ti[tt-1])) {\n                        dp[dd][tt] = dp[dd-1][tt-1];\n\t\t\t\t    } else {\n                        dp[dd][tt] = INF;\n\t\t\t\t    }\n                } else {\n                    dp[dd][tt] = dp[dd-1][tt-1];\n\t\t\t    }\n\t\t    }\n\n            if(data[dpos][0] == dd) {\n                dpos++;\n\t\t\t}\n\n            if(dpos == N) {\n                break;\n\t\t    }\n\t    }\n\n        int ans = INF;\n        REP(t, T+1) {\n            ans = min(ans, dp[dmax][t]);\n\t    }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "////////////////////////////////////////\n///  tu3 pro-con template            ///\n////////////////////////////////////////\n#include <cassert>\n#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <iostream>\n#include <sstream>\n#include <algorithm>\n#include <numeric>\n#include <functional>\n#include <vector>\n#include <queue>\n#include <string>\n#include <complex>\n#include <stack>\n#include <set>\n#include <map>\n#include <list>\n#include <unordered_map>\n#include <unordered_set>\n#include <bitset>\n#include <regex>\nusing namespace std;\n\n//// MACRO ////\n#define countof(a) (sizeof(a)/sizeof(a[0]))\n\n#define REP(i,n) for (int i = 0; i < (n); i++)\n#define RREP(i,n) for (int i = (n)-1; i >= 0; i--)\n#define FOR(i,s,n) for (int i = (s); i < (n); i++)\n#define RFOR(i,s,n) for (int i = (n)-1; i >= (s); i--)\n#define pos(c,i) c.being() + (i)\n#define allof(c) c.begin(), c.end()\n#define aallof(a) a, countof(a)\n#define partof(c,i,n) c.begin() + (i), c.begin() + (i) + (n)\n#define apartof(a,i,n) a + (i), a + (i) + (n)\n#define long long long\n\n#define EPS 1e-9\n#define INF (1L << 30)\n#define LINF (1LL << 60)\n\n#define PREDICATE(t,a,exp) [&](const t & a) -> bool { return exp; }\n#define COMPARISON_T(t) bool(*)(const t &, const t &)\n#define COMPARISON(t,a,b,exp) [&](const t & a, const t & b) -> bool { return exp; }\n#define CONVERTER(TSrc,t,TDest,exp) [&](const TSrc &t)->TDest { return exp; }\n\ninline int sign(double x) { return (abs(x) < EPS ? 0 : x > 0 ? 1 : -1); }\ninline bool inRange(int val, int min, int max) { return val >= min && val < max; }\ninline bool inRange(double val, double min, double max) { return val - min > -EPS && val - max < EPS; }\n\n#ifdef ccout\n#define cout ccout\n#define endl cendl\n#endif\n\n//// i/o helper ////\n\nstruct _Reader { template <class T> _Reader operator ,(T &rhs) { cin >> rhs; return *this; } };\nstruct _Writer { bool f; _Writer() : f(false) { } template <class T> _Writer operator ,(const T &rhs) { cout << (f ? \" \" : \"\") << rhs; f = true; return *this; } };\n#define READ(t,...) t __VA_ARGS__; _Reader(), __VA_ARGS__\n#define WRITE(...) _Writer(), __VA_ARGS__; cout << endl\n\ntemplate <class T> struct vevector : public vector<vector<T>> { vevector(int n = 0, int m = 0, const T &initial = T()) : vector<vector<T>>(n, vector<T>(m, initial)) { } };\ntemplate <class T> struct vevevector : public vector<vevector<T>> { vevevector(int n = 0, int m = 0, int l = 0, const T &initial = T()) : vector<vevector<T>>(n, vevector<T>(m, l, initial)) { } };\ntemplate <class T> struct vevevevector : public vector<vevevector<T>> { vevevevector(int n = 0, int m = 0, int l = 0, int k = 0, const T &initial = T()) : vector<vevevector<T>>(n, vevevector<T>(m, l, k, initial)) { } };\ntemplate <class T> T read() { T t; cin >> t; return t; }\ntemplate <class T> vector<T> read(int n) { vector<T> v; REP(i, n) { v.push_back(read<T>()); } return v; }\ntemplate <class T> vevector<T> read(int n, int m) { vevector<T> v; REP(i, n) v.push_back(read<T>(m)); return v; }\ntemplate <class T> vevector<T> readjag() { return read<T>(read<int>()); }\ntemplate <class T> vevector<T> readjag(int n) { vevector<T> v; REP(i, n) v.push_back(readjag<T>()); return v; }\n\ntemplate <class T1, class T2> inline istream & operator >> (istream & in, pair<T1, T2> &p) { in >> p.first >> p.second; return in; }\ntemplate <class T1, class T2> inline ostream & operator << (ostream &out, pair<T1, T2> &p) { out << p.first << p.second; return out; }\ntemplate <class T> inline ostream & operator << (ostream &out, vector<T> &v)\n{\n\tostringstream ss;\n\tfor (auto x : v) ss << x << ' ';\n\tauto s = ss.str();\n\tout << s.substr(0, s.length() - 1) << endl;\n\treturn out;\n}\n\n//// start up ////\nvoid solve();\ninline void readfrom(string filename) { freopen(filename.c_str(), \"r\", stdin); }\ninline void writeto(string filename) { freopen(filename.c_str(), \"w\", stdout); }\nint main()\n{\n\tsolve();\n\treturn 0;\n}\n\n////////////////////\n/// template end ///\n////////////////////\n\nvoid solve()\n{\n\tint testcases = INF;\n\tREP(testcase, testcases)\n\t{\n\t\tREAD(int, T);\n\t\tif (!T) break;\n\t\tauto tlp = read<int>(T);\n\t\tREAD(int, N);\n\t\t\n\t\tvector<int> d(101, 24);\n\t\tfor (auto i : read<pair<int, int>>(N))\n\t\t\td[i.first - 1] = min(d[i.first - 1], i.second);\n\t\n\t\tdeque< tuple<int, int, int> > q; // day,cycle,cost\n\t\tq.emplace_back(0, 0, 0);\n\t\tint result = -1;\n\t\tvevector<bool> visited(N + 1, T);\n\t\twhile (!q.empty())\n\t\t{\n\t\t\tint i, c, x;\n\t\t\ttie(i, c, x) = q.front();\n\t\t\tq.pop_front();\n\t\t\tif (i == N) { result = x; break; }\n\t\t\tif (visited[i][c]) continue;\n\t\t\tvisited[i][c] = true;\n\t\t\tif (d[i] < tlp[c]) continue;\n\t\t\tif (!visited[i + 1][(c + 1) % N]) { q.emplace_front(i + 1, (c + 1) % N, x); }\n\t\t\tif (!visited[i + 1][0]) q.emplace_back(i + 1, 0, x + 1);\n\t\t}\n\t\tWRITE(result);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nint main()\n{\n\tint T,N;\n\twhile(scanf(\"%d\", &T), T)\n\t{\n\t\tint cycle[30];\n\t\t\n\t\tfor(int i=0; i<T; i++)\n\t\t\tscanf(\"%d\", &cycle[i]);\n\t\n\t\tint day[101], maxd=0;\n\t\tfor(int i=0; i<101; i++)\n\t\t\tday[i]=999;\n\t\t\n\t\tscanf(\"%d\", &N);\n\t\t\n\t\tfor(int i=0; i<N; i++)\n\t\t{\n\t\t\tint d,m;\n\t\t\tscanf(\"%d%d\", &d,&m);\n\t\t\tday[d]=min(day[d], m);\n\t\t\tmaxd=max(d, maxd);\n\t\t}\n\t\t\n\t\tint ps[30];\n\t\t\n\t\tfor(int i=0; i<T; i++) ps[i]=99;\n\t\tps[0]=0;\n\t\t\n\t\tfor(int i=1; i<=maxd; i++)\n\t\t{\n\t\t\tint t[30];\n\t\t\tfor(int j=0; j<T; j++) t[j]=99;\n\t\t\t\n\t\t\tfor(int j=0; j<T; j++)\n\t\t\t{\n\t\t\t\tif(j+1>i) continue;\n\t\t\t\tif(j!=T-1) t[0]=min(t[0], ps[j]+1);\n\t\t\t\t\n\t\t\t\tif(cycle[j]>day[i]) continue;\n\t\t\t\t\t\n\t\t\t\tt[(j+1)%T]=min(min(t[0], ps[j]), t[(j+1)%T]);\n\t\t\t}\n\t\t\t\n\t\t\tfor(int j=0; j<T; j++) \n\t\t\t\tps[j]=t[j];\n\t\t}\n\t\t\n\t\tint ans=99;\n\t\tfor(int i=0; i<T; i++)\n\t\t\tans=min(ans, ps[i]);\n\t\t\t\n\t\tprintf(\"%d\\n\", ans);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n\nusing namespace std;\n\nstruct before_main{before_main(){cin.tie(0); ios::sync_with_stdio(false);}} before_main;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntemplate<class T, class U, class Compare>\nvoid pair_sort(vector<T>& a, vector<U>& b, Compare comp) {\n  vector<pair<T, U>> v;\n  rep(i, a.size()) v.emplace_back(a[i], b[i]);\n  sort(v.begin(), v.end(), comp);\n  rep(i, a.size()) tie(a[i], b[i]) = v[i];\n}\ntemplate<class T, class U>\nvoid pair_sort(vector<T>& a, vector<U>& b) {\n  pair_sort(a, b, std::less<pair<T, U>>());\n}\n\ntypedef long long ll;\nint const inf = 1e9;\n\nint T, N;\nint t[33];\nint M[111];\nint dp[111][33];\n\nint solve() {\n\n  rep(i, 111) rep(j, 33) dp[i][j] = inf;\n\n  dp[0][T-1] = 0;\n  REP(i, 1, 101) {\n    rep(j, T) {\n      if(t[(j+1)%T] <= M[i]) {\n        minimize(dp[i][(j+1)%T], dp[i-1][j]);\n        minimize(dp[i][T-1], dp[i-1][j] + 1);\n      }\n    }\n  }\n\n  return *min_element(dp[100], dp[100] + T);\n}\n\nint main() {\n\n  for(; cin >> T && T;) {\n    rep(i, T) cin >> t[i];\n    cin >> N;\n    rep(i, 111) M[i] = inf;\n    rep(i, N) {\n      int d, m; cin >> d >> m;\n      minimize(M[d], m);\n    }\n    cout << solve() << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define ALL(v) (v).begin(), (v).end()\n#define LENGTHOF(x) (sizeof(x) / sizeof(*(x)))\n#define AFILL(a, b) fill((int*)a, (int*)(a + LENGTHOF(a)), b)\n#define SQ(x) ((x)*(x))\n#define Mod(x, mod) (((x)+(mod)%(mod))\n#define MP make_pair\n#define PB push_back\n#define Fi first\n#define Se second\n#define INF (1<<29)\n#define EPS 1e-10\n#define MOD 1000000007\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nint T, N;\nint t[32];\nint M[128];\nint dp[32][128];\n\nint dfs(int n, int d){\n  if(d==100) return 0;\n  int &res = dp[n][d];\n  if(res >= 0) return res;\n  //  if(d<=N) cout << n << \" \" << d << endl;\n  res = INF;\n  if(t[n] <= M[d]) res = min(res, dfs((n+1)%T, d+1));\n  res = min(res, dfs(1, d+1)+1);\n  return res;\n}\n\nint main(){\n  while(scanf(\"%d\", &T) && T){\n    memset(dp, -1, sizeof(dp));\n    fill(M, M+100, 24);\n    rep(i,T) scanf(\"%d\", t+i);\n    scanf(\"%d\",&N);\n    rep(i,N){\n      int t,m;\n      scanf(\"%d%d\", &t,&m); t--;\n      M[t] = min(M[t],m);\n    }\n\n    printf(\"%d\\n\", dfs(0, 0));\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nstruct UnionFind {\n\tvector<int> v;\n\tUnionFind(int n) : v(n) { for (int i = 0; i < n; i++) v[i] = i; }\n\tint  find(int x) { return v[x] == x ? x : v[x] = find(v[x]); }\n\tvoid unite(int x, int y) { v[find(x)] = find(y); }\n};\n\nint main() {\n\tint T;\n\twhile (cin >> T, T) {\n\t\tvi t(T);\n\t\tREP(i, T) {\n\t\t\tcin >> t[i];\n\t\t}\n\t\tint n;\n\t\tcin >> n;\n\t\tmap<int, int> inv;\n\t\tREP(i, n) {\n\t\t\tint a, b;\n\t\t\tcin >> a >> b;\n\t\t\tinv[a] = b;\n\t\t}\n\t\tvvi dp(101, vi(T, 10000));\n\t\tdp[1][0] = 0;\n\t\tFOR(i, 2, 101) {\n\t\t\tREP(j, T) {\n\t\t\t\tif (j == 0) {\n\t\t\t\t\tREP(k, T)\n\t\t\t\t\t\tdp[i][j] = min(dp[i][j], dp[i - 1][k] + 1);\n\t\t\t\t}\n\n\t\t\t\tif (inv.find(i) == inv.end()) {\n\t\t\t\t\tif (i >= j)\n\t\t\t\t\t\tdp[i][j] = min(dp[i][j], dp[i - 1][(j + T - 1) % T]);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (i >= j&&t[j] <= inv[i])\n\t\t\t\t\t\tdp[i][j] = min(dp[i][j], dp[i - 1][(j + T - 1) % T]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans = 100000;\n\t\tREP(i, T)\n\t\t\tans = min(ans, dp[100][i]);\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<ll, ll> P;\ntypedef vector<ll> V;\ntypedef complex<double> Point;\n \n#define PI acos(-1.0)\n#define EPS 1e-10\nconst ll INF = 1e16;\nconst ll MOD = 1e9 + 7;\n \n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define rep(i,N) for(int i=0;i<(N);i++)\n#define ALL(s) (s).begin(),(s).end()\n#define EQ(a,b) (abs((a)-(b))<EPS)\n#define EQV(a,b) ( EQ((a).real(), (b).real()) && EQ((a).imag(), (b).imag()) )\n#define fi first\n#define se second\n#define N_SIZE (1LL << 20)\n#define NIL -1\n \nint T,n;\nll dp[101][31];\n\nint main(){\n\twhile(cin >> T && T){\n\t\trep(i,101)rep(j,31)dp[i][j] = INF;\n\t\tdp[0][0] = 0;\n\t\tvector<ll> t(T);\n\t\trep(i,T)cin >> t[i];\n\t\tcin >> n;\n\t\tvector<ll> v(101,23);\n\t\trep(i,n){\n\t\t\tll d,M;\n\t\t\tcin >> d >> M;\n\t\t\td--;\n\t\t\tv[d] = min(M,v[d]);\n\t\t}\n\t\trep(i,100){\n\t\t\trep(j,T){\n\t\t\t\tif(t[j] <= v[i])dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T],dp[i][j]);\n\t\t\t\tdp[i+1][1%T] = min(dp[i+1][1%T],dp[i][j] + 1);\n\t\t\t}\n\t\t}\n\t\tll ans = INF;\n\t\t// rep(i,md+1){\n\t\t// \trep(j,T)cout << dp[i][j] << \" \";\n\t\t// \tcout << endl;\n\t\t// }\n\t\trep(i,T)ans = min(ans,dp[100][i]);\n\t\tcout << ans << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#define inf 1<<28\nusing namespace std;\n\nint main()\n{\n\n  while(1){\n    int T,t[101],n,a,b;\n    int d[101];\n    for(int i=0;i<101;i++)d[i]=inf;\n    cin>>T;\n    if(T==0)break;\n    for(int i=0;i<T;i++)cin>>t[i];\n    cin>>n;\n    for(int i=0;i<n;i++){\n      cin>>a>>b;\n      a--;\n      d[a]=min(d[a],b);\n    }\n\n    int dp[101][31];\n    for(int i=0;i<101;i++)for(int j=0;j<31;j++)dp[i][j]=inf;\n    dp[0][0]=0;\n    for(int k=0;k<100;k++){\n      for(int i=0;i<T;i++){\n        if(t[(i+1)%T]<d[k+1])dp[k+1][(i+1)&T]=min(dp[k+1][(i+1)%T],dp[k][i]);\n        dp[k+1][0]=min(dp[k+1][0],dp[k][i]+1);\n      }\n    }\n    int ans=inf;\n    for(int i=0;i<T;i++)ans=min(ans,dp[100][i]);\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#pragma warning(disable:4996)\nusing namespace std;\n\nconst int My_Inf=2147483647;\nconst long long int My_LInf=9223372036854775807;\n\nint main() {\n\tint T; cin >> T;\n\tvector<int>sleeps;\n\tfor (int i = 0; i < T; ++i) {\n\t\tint t; cin >> t;\n\t\tsleeps.push_back(t);\n\t}\n\tint N; cin >> N;\n\tvector<int>needtimes(N,25);\n\tfor (int i = 0; i < N; ++i) {\n\t\tint d, m; cin >> d >> m;\n\t\td--;\n\t\tneedtimes[d] = min(needtimes[d], m);\n\t}\n\n\tvector<vector<int>>dp(N + 1, vector<int>(T,999));\n\tdp[0][0] = 0;\n\tfor (int i = 0; i < N; ++i) {\n\t\tfor (int j = 0; j < T; ++j) {\n\t\t\tif (needtimes[i] >= sleeps[j]) {\n\t\t\t\tdp[i + 1][(j + 1) % T] = min(dp[i][j], dp[i + 1][(j + 1) % T]);\n\n\t\t\t}\n\t\t\tdp[i + 1][1%T] = min(dp[i + 1][1 % T], dp[i][j] + 1);\n\t\t}\n\t}\n\tint ans = 99999999;\n\tfor (int i = 0; i < T; ++i) {\n\t\tans = min(dp[N][i], ans);\n\t}\n\tcout << ans << endl;\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<n;i++)\nusing namespace std;\n\nint T,N;\nint t[30],ti[101];\n\nint main(){\n\twhile(cin>>T,T){\n\t\trep(i,T)cin>>t[i];\n\t\trep(i,101)ti[i]=100;\n\t\tcin>>N;\n\t\trep(i,N){\n\t\t\tint d,m;\n\t\t\tcin>>d>>m;d--;\n\t\t\tti[d]=min(ti[d],m);\n\t\t}\n\t\tint pos=0;\n\t\tint ans=0;\n\t\tfor(int i=0;i<100;i++){\n\t\t\tif(ti[i]==100){\n\t\t\t\tpos++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(ti[i]<t[pos%T]){\n\t\t\t\tans++;\n\t\t\t\tpos=1;\n\t\t\t} else{\n\t\t\t\tpos++;\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n  int tm,n;\n  while(cin >> tm,tm){\n    int i,j,k;\n    int t[tm];\n    for(i=0;i<tm;i++) cin >> t[i];\n    cin >> n;\n    int d[n+1],m[n+1];\n    for(i=1;i<=n;i++){\n      cin >> d[i] >> m[i];\n    }\n    d[0]=0;m[0]=0;\n    int inf = 1<<20;\n    int dp[150][50];\n    fill(dp[0],dp[50],inf);\n    dp[0][0]=0;\n    for(i=0;i<n;i++){\n      for(j=0;j<50;j++){\n\tif(dp[i][j]==inf) continue;\n\tif(d[i+1]==1) dp[i+1][0]=0;\n\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t//cout << i<<\":\"<<j<<\":\"<<(j+d[i+1]-d[i])<<\":\"<<t[(j+d[i+1]-d[i])%tm]<<\":\"<<m[i+1]<<endl;\n\t\n\tif(t[(j+d[i+1]-d[i])%tm]<=m[i+1]){\n\t  dp[i+1][(j+d[i+1]-d[i])%tm]=\n\t    min(dp[i+1][(j+d[i+1]-d[i])%tm],dp[i][j]);\n\t}\n\t\n      }\n    }\n    int o=inf;\n    /*\n    for(j=0;j<=n;j++){\n      cout << j << \":\";\n      for(i=0;i<tm;i++) cout << dp[j][i] << (i==tm-1?\"\\n\":\" \");\n    }\n    */\n    for(i=0;i<tm;i++) o=min(o,dp[n][i]);\n    cout << o << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <numeric>\n#include <vector>\n#include <cassert>\n#include <string>\n#include <memory.h>\n#include <queue>\n#include <cstdio>\n#include <cstdlib>\n#include <set>\n#include <map>\n#include <cctype>\n#include <iomanip>\n#include <sstream>\n#include <cctype>\n#include <fstream>\n#include <cmath>\nusing namespace std;\n\n#define REP2(i, m, n) for(int i = (int)(m); i < (int)(n); i++)\n#define REP(i, n) REP2(i, 0, n)\n#define ALL(c) (c).begin(), (c).end()\n#define ITER(c) __typeof((c).begin())\n#define PB(e) push_back(e)\n#define FOREACH(i, c) for(ITER(c) i = (c).begin(); i != (c).end(); ++i)\n#define MP(a, b) make_pair(a, b)\n#define PARITY(n) ((n) & 1)\n\ntypedef long long ll;\ntypedef pair<ll, ll> P;\nconst int INF = 1000 * 1000 * 1000 + 7;\nconst double EPS = 1e-10;\n\nconst int MAXT = 30;\nconst int MAXN = 100;\nconst int MAXD = 110;\nint t[MAXT];\nint d[MAXN];\nint m[MAXN];\n\nint dp[MAXD][MAXT];\n\nint main(){\n  int T, N;\n  while(cin >> T && T){\n    REP(i, T) cin >> t[i];\n    cin >> N;\n    REP(i, N){\n      cin >> d[i] >> m[i];\n      d[i]--;\n    }\n  \n    REP(i, N)REP(j, N - 1){\n      if(d[j] > d[j+1] || (d[j] == d[j+1] && m[j] > m[j+1])){\n        swap(d[j], d[j+1]);\n        swap(m[j], m[j+1]);\n      }\n    }\n  \n  \n    fill(&dp[0][0], &dp[0][0] + MAXD * MAXT, INF);\n\n    dp[0][0] = 0;\n    REP(i, MAXD-1){\n      REP(j, T){\n\n        if(dp[i][j] == INF) continue;\n        bool use = false;\n        REP(k, N) if(d[k] == i && t[j] > m[k]) use = true;\n      \n        dp[i+1][1] = min(dp[i+1][1], dp[i][j] + 1);\n      \n        if(!use) {\n          dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T], dp[i][j]);\n        }\n      }\n    }\n    int res = INF;\n    REP(i, T) res = min(res, dp[MAXD-1][i]);\n  \n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nint main(){\n  int T;\n  while(cin >> T, T){\n    vector<int> t(T);\n    for(int i = 0; i < T; ++i){\n      cin >> t[i];\n    }\n    int N;\n    cin >> N;\n    int d, m;\n    vector< pair<int,int> > V;\n    for(int i = 0; i < N; ++i){\n      cin >> d >> m;\n      --d;\n      V.emplace_back(d,m);\n    }\n    sort(V.begin(), V.end());\n    int ans = 0, e = N;\n    while(e > 0){\n      for(int k = 0; k <= V[N-1].first; ++k){\n        int tmp = -1;\n        bool f = false;\n        for(int i = 0; i < e; ++i){\n          if(V[i].first < k) continue;\n          if(tmp == -1){\n            tmp = i;\n            f = true;\n          }\n          if(V[i].second < t[(V[i].first-k)%T]){\n            f = false;\n            break;\n          }\n        }\n        if(f){\n          e = tmp;\n          if(e) ++ans;\n          break;\n        }\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(int argc, char *argv[]){\n  int t;\n  while(cin >> t, t){\n    int time[t];\n    for (int i = 0; i < t; i++) {\n      cin >> time[i];\n    }\n    int n, max_day = 0;\n    cin >> n;\n    int plan[100];\n    for (int i = 0; i < 100; i++) {\n      plan[i] = 24;\n    }\n    for (int i = 0; i < n; i++) {\n      int d, m;\n      cin >> d >> m;\n      d--;\n      plan[d] = min(plan[d], m);\n      max_day = max(max_day, d);\n    }\n    max_day++;\n    int dp[t][max_day + 1];\n    for (int i = 0; i <= max_day; i++) {\n      for (int j = 0; j < t; j++) {\n        dp[j][i] = 1e9;\n      }\n    }\n    dp[0][0] = 0;\n    for (int i = 0; i < max_day; i++) {\n      for (int j = 0; j < t; j++) {\n        if(time[j] <= plan[i]){\n          dp[(j + 1) % t][i + 1] = min(dp[(j + 1) % t][i + 1],\n                                       dp[j][i]);\n        }\n        dp[1][i + 1] = min(dp[1][i + 1], dp[j][i] + 1);\n      }\n    }\n    int ans = 1e9;\n    for (int i = 0; i < t; i++) {\n      ans = min(ans, dp[i][max_day]);\n    }\n    std::cout << ans << std::endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main()\n{\n\tint T, N;\n\twhile (cin >> T, T) {\n\t\tvector<int> t(T);\n\t\tfor (int i = 0; i < T; i++) {\n\t\t\tcin >> t[i];\n\t\t}\n\t\tvector<int> m(100, 24);\n\t\tcin >> N;\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tint D, M;\n\t\t\tcin >> D >> M; D--;\n\t\t\tm[D] = M;\n\t\t}\n\t\tvector<int> dp(100, 100);\n\t\tdp[0] = 1;\n\t\tfor (int i = 1; i < 100; i++) {\n\t\t\tfor (int j = 0; j <= i; j++) {\n\t\t\t\tbool ok = true;\n\t\t\t\tfor (int k = j; k <= i; k++) {\n\t\t\t\t\tif (m[k] < t[(k - j) % T]) {\n\t\t\t\t\t\tok = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (ok) {\n\t\t\t\t\tdp[i] = min(dp[i], (j == 0 ? 0 : dp[j - 1]) + 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (int i = 0; i < 100; i++) {\n\t\t\tcout << dp[i] - 1 << \" \\n\"[i + 1 == 100];\n\t\t}\n\t\tcout << dp[99] - 1 << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <complex>\n#include <algorithm>\n#include <set>\n#include <map>\n#include <queue>\n#include <string>\n#include <cstring>\n#include <stack>\n#include <cmath>\n#include <iomanip>\n#include <sstream>\n#include <cassert>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef ll li;\ntypedef pair<int,int> PI;\n#define EPS (1e-10L)\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define REP(i, n) rep (i, n)\n#define F first\n#define S second\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define SZ(a) (int)((a).size())\n#define ALL(a) a.begin(),a.end()\n#define CLR(a) memset((a),0,sizeof(a))\n#define FOR(it,a) for(__typeof(a.begin())it=a.begin();it!=a.end();++it)\ntemplate<typename T,typename U> ostream& operator<< (ostream& out, pair<T,U>& val){return out << \"(\" << val.F << \", \" << val.S << \")\";}\ntemplate<class T> ostream& operator<< (ostream& out, vector<T>& val){out << \"{\";rep(i,SZ(val)) out << (i?\", \":\"\") << val[i];return out << \"}\";}\nvoid pkuassert(bool t){t=1/t;};\nint dx[]={0,1,0,-1,1,1,-1,-1};\nint dy[]={1,0,-1,0,-1,1,1,-1};\n\nint T;\nint t[1000];\nbool vis[120][40];\n\nint day[120];\n\nvoid solve(){\n  CLR(vis);\n  rep(i, T) cin >> t[i];\n  priority_queue<pair<int,PI> > q;\n  int N;\n  cin >> N;\n  rep(i, 100) day[i] = 23;\n  rep(i, N){\n    int d,m;\n    cin >> d >> m;\n    day[d-1] = m;\n  }\n  \n  q.push(mp(0,mp(0,0)));\n  while(!q.empty()){\n    int cc=-q.top().F;\n    int cd=q.top().S.F;\n    int cs=q.top().S.S;\n    q.pop();\n    if(cd==100) {\n      cout << cc << endl;\n      return;\n    }\n    if(vis[cd][cs]) continue;\n    vis[cd][cs] = true;\n    q.push(mp(-cc-1,mp(cd,0)));\n    if(t[cs]<=day[cd]) q.push(mp(-cc,mp(cd+1,(cs+1)%T)));\n  }\n}\n\nint main(int argc, char *argv[])\n{\n  while(cin >> T && T) solve();\n}"
  },
  {
    "language": "C++",
    "code": "// Header {{{\n// includes {{{\n#include <algorithm>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <iostream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <sys/time.h>\n#include <unistd.h>\n#include <vector>\n// }}}\nusing namespace std;\n// consts {{{\nstatic const int INF = 1e9;\nstatic const double PI = acos(-1.0);\nstatic const double EPS = 1e-10;\n// }}}\n// typedefs {{{\ntypedef long long int LL;\ntypedef unsigned long long int ULL;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\ntypedef vector<ULL> VULL;\ntypedef vector<VULL> VVULL;\ntypedef vector<double> VD;\ntypedef vector<VD> VVD;\ntypedef vector<bool> VB;\ntypedef vector<VB> VVB;\ntypedef vector<char> VC;\ntypedef vector<VC> VVC;\ntypedef vector<string> VS;\ntypedef vector<VS> VVS;\ntypedef pair<int, int> PII;\ntypedef complex<int> P;\n#define PQ(type) priority_queue<type>\n// priority queue reverse\n#define PQR(type) priority_queue< type, vector<type>, greater<type> >\n// }}}\n// macros & inline functions {{{\n// syntax sugars {{{\n#define FOR(i, b, e) for (typeof(e) i = (b); i < (e); ++i)\n#define FORI(i, b, e) for (typeof(e) i = (b); i <= (e); ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define REPI(i, n) FORI(i, 0, n)\n#define OPOVER(_op, _type) inline bool operator _op (const _type &t) const\n#define ASSIGN_MAX(var, val) ((var) = max((var), (val)))\n#define ASSIGN_MIN(var, val) ((var) = min((var), (val)))\n// }}}\n// conversion {{{\ninline int toInt(string s) { int v; istringstream sin(s); sin>>v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout<<x; return sout.str(); }\n// }}}\n// array and STL {{{\n#define ARRSIZE(a) ( sizeof(a) / sizeof(a[0]) )\n#define ZERO(a, v) ( assert(v == 0 || v == -1), memset(a, v, sizeof(a)) )\n#define F first\n#define S second\n#define MP(a, b) make_pair(a, b)\n#define SIZE(a) ((LL)a.size())\n#define PB(e) push_back(e)\n#define SORT(v) sort((v).begin(), (v).end())\n#define RSORT(v) sort((v).rbegin(), (v).rend())\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EACH(c, it) for(typeof((c).begin()) it=(c).begin(); it!=(c).end(); ++it)\n#define REACH(c, it) for(typeof((c).rbegin()) it=(c).rbegin(); it!=(c).rend(); ++it)\n#define EXIST(s, e) ((s).find(e) != (s).end())\n// }}}\n// bit manipulation {{{\n// singed integers are not for bitwise operations, specifically arithmetic shifts ('>>', and maybe not good for '<<' too)\n#define IS_UNSIGNED(n) (!numeric_limits<typeof(n)>::is_signed)\n#define BIT(n) (assert(IS_UNSIGNED(n)), assert(n < 64), (1ULL << (n)))\n#define BITOF(n, m) (assert(IS_UNSIGNED(n)), assert(m < 64), ((ULL)(n) >> (m) & 1))\ninline int BITS_COUNT(ULL b) { int c = 0; while(b != 0) { c += (b & 1); b >>= 1; } return c; }\ninline int MSB(ULL b) { int c = 0; while(b != 0) { ++c; b >>= 1; } return c-1; }\ninline int MAKE_MASK(ULL upper, ULL lower) { assert(lower < 64 && upper < 64 && lower <= upper); return (BIT(upper) - 1) ^ (BIT(lower) - 1); }\n// }}}\n// for readable code {{{\n#define EVEN(n) (n % 2 == 0)\n#define ODD(n) (!EVEN(n))\n// }}}\n// debug {{{\n#define arrsz(a) ( sizeof(a) / sizeof(a[0]) )\n#define dprt(fmt, ...) if (opt_debug) { fprintf(stderr, fmt, ##__VA_ARGS__); }\n#define darr(a) if (opt_debug) { copy( (a), (a) + arrsz(a), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define darr_range(a, f, t) if (opt_debug) { copy( (a) + (f), (a) + (t), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define dvec(v) if (opt_debug) { copy( ALL(v), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define darr2(a) if (opt_debug) { FOR(__i, 0, (arrsz(a))){ darr( (a)[__i] ); } }\n#define WAIT() if (opt_debug) { string _wait_; cerr << \"(hit return to continue)\" << endl; getline(cin, _wait_); }\n#define dump(x) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #x << \" = \" << (x) << endl; }\n// dump vector elements in [s, e)\n#define dumpv(v, s, e) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #v << \" = \"; FOR(__i, s, e) { cerr << v[__i] << \"\\t\"; } cerr << endl; }\n#define dumpl(x) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #x << endl << (x) << endl; }\n#define dumpf() if (opt_debug) { cerr << __PRETTY_FUNCTION__ << endl; }\n#define where() if (opt_debug) { cerr << __FILE__ << \": \" << __PRETTY_FUNCTION__ << \" [L: \" << __LINE__ << \"]\" << endl; }\n#define show_bits(b, s) if(opt_debug) { REP(i, s) { cerr << BITOF(b, s-1-i); if(i%4 == 3) cerr << ' '; } cerr << endl; }\n\n// ostreams {{{\n// complex\ntemplate<typename T> ostream& operator<<(ostream& s, const complex<T>& d) {return s << \"(\" << d.real() << \", \" << d.imag() << \")\";}\n\n// pair\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& s, const pair<T1, T2>& d) {return s << \"(\" << d.first << \", \" << d.second << \")\";}\n\n// vector\ntemplate<typename T> ostream& operator<<(ostream& s, const vector<T>& d) {\n\tint len = d.size();\n\tREP (i, len) {\n\t\ts << d[i]; if (i < len - 1) s << \"\\t\";\n\t}\n\treturn s;\n}\n\n// 2 dimentional vector\ntemplate<typename T> ostream& operator<<(ostream& s, const vector< vector<T> >& d) {\n\tint len = d.size();\n\tREP (i, len) {\n\t\ts << d[i] << endl;\n\t}\n\treturn s;\n}\n\n// map\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& s, const map<T1, T2>& m) {\n\ts << \"{\" << endl;\n\tfor (typeof(m.begin()) itr = m.begin(); itr != m.end(); ++itr) {\n\t\ts << \"\\t\" << (*itr).first << \" : \" << (*itr).second << endl;\n\t}\n\ts << \"}\" << endl;\n\treturn s;\n}\n// }}}\n// }}}\n// }}}\n// time {{{\ninline double now(){ struct timeval tv; gettimeofday(&tv, NULL); return (static_cast<double>(tv.tv_sec) + static_cast<double>(tv.tv_usec) * 1e-6); }\n// }}}\n// string manipulation {{{\ninline VS split(string s, char delimiter) { VS v; string t; REP(i, s.length()) { if(s[i] == delimiter) v.PB(t), t = \"\"; else t += s[i]; } v.PB(t); return v; }\ninline string join(VS s, string j) { string t; REP(i, s.size()) { t += s[i] + j; } return t; }\n// }}}\n// geometry {{{\n#define Y real()\n#define X imag()\n// }}}\n// 2 dimentional array {{{\nenum { UP, RIGHT, DOWN, LEFT, UP_RIGHT, DOWN_RIGHT, DOWN_LEFT, UP_LEFT };\nP dydx4[4] = { P(-1, 0), P(0, 1), P(1, 0), P(0, -1) };\nP dydx8[8] = { P(-1, 0), P(0, 1), P(1, 0), P(0, -1), P(-1, 1), P(1, 1), P(1, -1), P(-1, -1) };\nbool in_field(int H, int W, P p) {\n\treturn (0 <= p.Y && p.Y < H) && (0 <= p.X && p.X < W);\n}\n// }}}\n// input and output {{{\ninline void input(string filename) {\n\tfreopen(filename.c_str(), \"r\", stdin);\n}\ninline void output(string filename) {\n\tfreopen(filename.c_str(), \"w\", stdout);\n}\n// }}}\n// }}}\n\n// Header under development {{{\n\nint LCM(int a, int b) {\n\t// FIXME\n\treturn a * b;\n}\n\n// Fraction class {{{\n// ref: http://martin-thoma.com/fractions-in-cpp/\nclass Fraction {\n\tpublic:\n\t\tULL numerator;\n\t\tULL denominator;\n\t\tFraction(ULL _numerator, ULL _denominator) {\n\t\t\tassert(_denominator > 0);\n\t\t\tnumerator = _numerator;\n\t\t\tdenominator = _denominator;\n\t\t};\n\n\t\tFraction operator*(const ULL rhs) {\n\t\t\treturn Fraction(this->numerator * rhs, this->denominator);\n\t\t};\n\n\t\tFraction operator*(const Fraction& rhs) {\n\t\t\treturn Fraction(this->numerator * rhs.numerator, this->denominator * rhs.denominator);\n\t\t}\n\n\t\tFraction operator+(const Fraction& rhs) {\n\t\t\tULL lcm = LCM(this->denominator, rhs.denominator);\n\t\t\tULL numer_lhs = this->numerator * (this->denominator / lcm);\n\t\t\tULL numer_rhs = rhs.numerator * (rhs.numerator / lcm);\n\t\t\treturn Fraction(numer_lhs + numer_rhs, lcm);\n\t\t}\n\n\t\tFraction& operator+=(const Fraction& rhs) {\n\t\t\tFraction result = (*this) + rhs;\n\t\t\tthis->numerator = result.numerator;\n\t\t\tthis->denominator = result.denominator;\n\t\t\treturn *this;\n\t\t}\n};\n\nstd::ostream& operator<<(std::ostream &s, const Fraction &a) {\n\tif (a.denominator == 1) {\n\t\ts << a.numerator;\n\t} else {\n\t\ts << a.numerator << \"/\" << a.denominator;\n\t}\n\treturn s;\n}\n\n// }}}\n\n// }}}\n\nbool opt_debug = false;\n\nint main(int argc, char** argv) {\n\tstd::ios_base::sync_with_stdio(false);\n\t// set options {{{\n\tint __c;\n\twhile ( (__c = getopt(argc, argv, \"d\")) != -1 ) {\n\t\tswitch (__c) {\n\t\t\tcase 'd':\n\t\t\t\topt_debug = true;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tabort();\n\t\t}\n\t}\n\t// }}}\n\n\t// opt_debug = true;\n\t// input(\"./inputs/0.txt\");\n\t// output(\"./outputs/0.txt\");\n\n\tint T;\n\twhile (cin >> T, T) {\n\t\tVI cycle(T);\n\t\tREP (i, T) {\n\t\t\tcin >> cycle[i];\n\t\t}\n\t\tint N; cin >> N;\n\t\tvector<PII> interviews;\n\t\tint max_d = 0;\n\t\tREP (i, N) {\n\t\t\tint D, M; cin >> D >> M;\n\t\t\tinterviews.PB(MP(D, M));\n\t\t\tmax_d = max(max_d, D);\n\t\t}\n\t\tVI wakeup_time(max_d, INF);\n\t\tREP (i, N) {\n\t\t\tPII& _i = interviews[i];\n\t\t\twakeup_time[_i.F] = min(wakeup_time[_i.F], _i.S);\n\t\t}\n\n\t\tVVI dp(max_d, VI(T, INF));\n\t\tdp[0][0] = 0;\n\t\tFOR (d, 1, max_d) {\n\t\t\tREP (t, T) {\n\t\t\t\tdp[d][0] = min(dp[d][0], dp[d-1][t] + 1);\n\t\t\t}\n\t\t\tFOR (t, 1, T) {\n\t\t\t\tif (cycle[t] <= wakeup_time[d]) {\n\t\t\t\t\tdp[d][t] = dp[d-1][t-1];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tint ans = INF;\n\t\tREP (t, T) {\n\t\t\tans = min(ans, dp[max_d-1][t]);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}\n\n// vim: foldmethod=marker"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#pragma GCC target(\"avx2\")\n#pragma GCC optimize(\"O3\")\n#pragma GCC optimize(\"unroll-loops\")\nusing namespace std;\n\n#define REP(i, n) for (int i = 0; i < (n); i++)\n#define int long long\n#define FOR(i, m, n) for (int i = (m); i < (n); i++)\n#define all(x) x.begin(), x.end()\nusing pii = pair<int, int>;\nusing ll = long long;\nconst int INF = 1e9;\n\nint dp[101][50];\nbool solve() {\n    int T;\n    cin >> T;\n    if (T == 0) return false;\n    vector<int> t(T);\n    REP(i, T) cin >> t[i];\n    int N;\n    cin >> N;\n    vector<pii> v(N);\n    REP(i, N) { cin >> v[i].first >> v[i].second; }\n    sort(all(v));\n    REP(i, N + 1) REP(j, T + 1) dp[i][j] = INF;\n    REP(k, v[0].first) dp[0][k%T] = 1;\n    dp[0][(v[0].first - 1)%T] = 0;\n    REP(i, N) {\n        REP(j, T) {\n            if (t[j] > v[i].second) continue;\n            //飲む\n            if (i < N - 1) {\n                int dif = v[i + 1].first - v[i].first;\n                if (dif == 0) dp[i + 1][j] = min(dp[i + 1][j], dp[i][j]);\n                REP(k, dif) { dp[i + 1][k] = min(dp[i + 1][k], dp[i][j] + 1); }\n            }\n            //飲まない\n            if (i < N - 1 && t[j] <= v[i].second) {\n                dp[i + 1][(j + v[i + 1].first - v[i].first) % T] =\n                    min(dp[i + 1][(j + v[i + 1].first - v[i].first) % T], dp[i][j]);\n            }\n        }\n    }\n    int ans = 1e9;\n    REP(j, T) {\n        if (t[j] <= v[N - 1].second) {\n            ans = min(ans, dp[N - 1][j]);\n        }\n    }\n    cout << ans << endl;\n    return true;\n}\n\nsigned main() {\n    while (solve())\n        ;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <utility>\n#include <algorithm>\nusing namespace std;\n\nint main(){\n  int T;\n  while(cin >> T, T){\n    vector<int> t(T);\n    for(int i = 0; i < T; ++i){\n      cin >> t[i];\n    }\n    int N;\n    cin >> N;\n    int d, m;\n    vector< pair<int,int> > V;\n    for(int i = 0; i < N; ++i){\n      cin >> d >> m;\n      --d;\n      V.emplace_back(d,m);\n    }\n    sort(V.begin(), V.end());\n    int ans = 0, e = N;\n    while(e > 0){\n      for(int k = 0; k <= V[e-1].first; ++k){\n        int tmp = -1;\n        bool f = false;\n        for(int i = 0; i < e; ++i){\n          if(V[i].first < k) continue;\n          if(tmp == -1){\n            tmp = i;\n            f = true;\n          }\n          if(V[i].second < t[(V[i].first-k)%T]){\n            f = false;\n            break;\n          }\n        }\n        if(f){\n          e = tmp;\n          if(e != 0) ++ans;\n          break;\n        }\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P> PP;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nint main(){\n  int cycle_length,interview_num;\n  int cycle[100];\n  map<int,vector<int> > interview;\n\n  while(~scanf(\"%d\",&cycle_length)){\n    if(cycle_length == 0) break;\n    for(int i=0;i<cycle_length;i++){\n      scanf(\"%d\",cycle+i);\n    }\n    scanf(\"%d\",&interview_num);\n  \n    int last_day = 0;\n    for(int i=0;i<interview_num;i++){\n      int day,start_hour;\n      scanf(\"%d %d\",&day,&start_hour);\n      interview[day].push_back(start_hour);\n      last_day = max(day,last_day);\n    }\n\n    int dp[100][100];\n    memset(dp,0x3f,sizeof(dp));\n\n    dp[1][0] = 0; //dp[day][cycle_idx] = min_cost\n    for(int day=1;day<=last_day;day++){\n      for(int cycle_idx=0;cycle_idx < cycle_length; cycle_idx++){\n\tfor(int hour_idx=0;hour_idx<interview[day].size();hour_idx++){\n\t  int start_hour = interview[day][hour_idx];\n\t  if(cycle[(cycle_idx+1)%cycle_length] <= start_hour){\n\t    dp[day+1][(cycle_idx+1)%cycle_length]\n\t      = min(dp[day][cycle_idx],dp[day+1][(cycle_idx+1)%cycle_length]);\n\t  }\n\t  dp[day+1][0] = min(dp[day][cycle_idx]+1,dp[day+1][0]);\n\t}\n      }\n    }\n  \n    int min_v = INF;\n    for(int i=0;i<cycle_length;i++){\n      min_v = min(dp[last_day][i],min_v);\n    }\n    printf(\"%d\\n\",min_v);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <complex>\n#include <algorithm>\n#include <set>\n#include <map>\n#include <queue>\n#include <string>\n#include <cstring>\n#include <stack>\n#include <cmath>\n#include <iomanip>\n#include <sstream>\n#include <cassert>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef ll li;\ntypedef pair<int,int> PI;\n#define EPS (1e-10L)\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define REP(i, n) rep (i, n)\n#define F first\n#define S second\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define SZ(a) (int)((a).size())\n#define ALL(a) a.begin(),a.end()\n#define CLR(a) memset((a),0,sizeof(a))\n#define FOR(it,a) for(__typeof(a.begin())it=a.begin();it!=a.end();++it)\ntemplate<typename T,typename U> ostream& operator<< (ostream& out, pair<T,U>& val){return out << \"(\" << val.F << \", \" << val.S << \")\";}\ntemplate<class T> ostream& operator<< (ostream& out, vector<T>& val){out << \"{\";rep(i,SZ(val)) out << (i?\", \":\"\") << val[i];return out << \"}\";}\nvoid pkuassert(bool t){t=1/t;};\nint dx[]={0,1,0,-1,1,1,-1,-1};\nint dy[]={1,0,-1,0,-1,1,1,-1};\n\nint T;\nint t[1000];\nbool vis[120][40];\n\nint day[120];\n\nvoid solve(){\n  CLR(vis);\n  rep(i, T) cin >> t[i];\n  priority_queue<pair<int,PI> > q;\n  int N;\n  cin >> N;\n  rep(i, 100) day[i] = 23;\n  rep(i, N){\n    int d,m;\n    cin >> d >> m;\n    day[d-1] = min(day[d-1],m);\n  }\n  \n  q.push(mp(0,mp(0,0)));\n  while(!q.empty()){\n    int cc=-q.top().F;\n    int cd=q.top().S.F;\n    int cs=q.top().S.S;\n    q.pop();\n    if(cd==100) {\n      cout << cc << endl;\n      return;\n    }\n    if(vis[cd][cs]) continue;\n    vis[cd][cs] = true;\n    q.push(mp(-cc-1,mp(cd,0)));\n    if(t[cs]<=day[cd]) q.push(mp(-cc,mp(cd+1,(cs+1)%T)));\n  }\n}\n\nint main(int argc, char *argv[])\n{\n  while(cin >> T && T) solve();\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n  int tm,n;\n  while(cin >> tm,tm){\n    int i,j,k;\n    int t[tm];\n    for(i=0;i<tm;i++) cin >> t[i];\n    cin >> n;\n    int m[150]={};\n    fill(m,m+150,24);\n    for(i=1;i<=n;i++){\n      cin >> k;\n      cin >> j;\n      m[k]=min(m[k],j);\n    }\n    int inf = 1<<20;\n    int dp[150][50];\n    fill(dp[0],dp[149],inf);\n    dp[1][0]=0;\n    for(i=1;i<=100;i++){\n      for(j=0;j<50;j++){\n\tif(dp[i][j]==inf) continue;\n\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t//cout <<i<<\":\"<<j<<\":\"<< t[(j+1)%tm]<<\":\"<<m[i]<<endl;\n\tif(t[(j+1)%tm]<=m[i+1]){\n\t  dp[i+1][(j+1)%tm]=min(dp[i+1][(j+1)%tm],dp[i][j]);\n\t}\n      }\n    }\n    int o=inf;\n    /*\n    for(j=1;j<=n+10;j++){\n      cout << j << \":\";\n      for(i=0;i<tm;i++) cout << dp[j][i] << (i==tm-1?\"\\n\":\" \");\n    }\n    */\n    for(i=0;i<50;i++) o=min(o,dp[101][i]);\n    cout << o << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MOD DEKAI\n#define DEKAI (int)(1e9+7)\n#define rep(i,n) lps(i,0,n)\n#define lp(i,n) lps(i,0,n)\n#define lps(i,j,n) for(int i = j; i < n; i++)\nint x[101];\nint n;\nint a[50];\nint Mday;\n\nint check(int day){\n  int j=0;\n  lps(i,day,Mday+1){\n    //cout<<a[j]<<\" \"<<x[i]<<endl;\n    if(a[j]>x[i]) return i;\n    j++;\n    if(j==n) j=0;\n  }\n  return -1;\n}\n\n\nint main(){\n  while(1){\n    cin>>n;\n    if(n==0) break;\n    lp(i,n) cin>>a[i];\n    int q;\n    cin>>q;\n    lp(i,101) x[i]=-1;\n    lp(i,q){\n      int d,m;\n      cin>>d>>m;\n      x[d]=m;\n      Mday=max(Mday,d);\n    }\n    int lastday=1;\n    int ans=0;\n    while(1){\n      int outday=check(lastday);\n      //cout<<\"    \"<<outday<<endl;\n      if(outday==-1) break;\n      ans++;\n      int memo=0;\n      lp(i,n-1){\n\tint memo2=check(outday-i);\n\tif(memo<memo2||memo2==-1) {\n\t  lastday=outday-i;\n\t  memo=memo2;\n\t}\n      }\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\nconst int INF = 1000000000;\n\nint main(){\n\tios_base::sync_with_stdio(false);\n\twhile(true){\n\t\tint T;\n\t\tcin >> T;\n\t\tif(T == 0){ break; }\n\t\tvector<int> t(T);\n\t\tfor(int i = 0; i < T; ++i){ cin >> t[i]; }\n\t\tint N;\n\t\tcin >> N;\n\t\tvector<int> req(N, 24);\n\t\tfor(int i = 0; i < N; ++i){\n\t\t\tint d, m;\n\t\t\tcin >> d >> m;\n\t\t\t--d;\n\t\t\treq[d] = min(req[d], m);\n\t\t}\n\t\tvector< vector<int> > dp(N, vector<int>(T, INF));\n\t\tdp[0][0] = 0;\n\t\tfor(int i = 0; i + 1 < N; ++i){\n\t\t\tfor(int j = 0; j < T; ++j){\n\t\t\t\tif(dp[i][j] >= INF){ continue; }\n\t\t\t\tdp[i + 1][0] = min(dp[i + 1][0], dp[i][j] + 1);\n\t\t\t\tconst int next = (j + 1) % T;\n\t\t\t\tif(t[next] > req[i + 1]){ continue; }\n\t\t\t\tdp[i + 1][next] = min(dp[i + 1][next], dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tint answer = INF;\n\t\tfor(int i = 0; i < T; ++i){\n\t\t\tanswer = min(answer, dp[N - 1][i]);\n\t\t}\n\t\tcout << answer << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <sstream>\n#include <map>\n#include <set>\n\n#define REP(i,k,n) for(int i=k;i<n;i++)\n#define rep(i,n) for(int i=0;i<n;i++)\n#define INF 1<<30\n#define pb push_back\n#define mp make_pair\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nint main() {\n\tint t;\n\twhile(cin >> t && t) {\n\n\t\tvector<int> v(t);\n\t\trep(i, t) cin >> v[i];\n\n\t\tint n;\n\t\tcin >> n;\n\n\t\tvector<int> d(n), m(n);\n\t\tint dm[105], day = 0;\n\t\trep(i, 105) dm[i] = INF;\n\n\t\trep(i, n) {\n\t\t\tcin >> d[i] >> m[i];\n\t\t\tdm[d[i]-1] = min(dm[d[i]-1], m[i]);\n\t\t\tday = max(day, d[i]);\n\t\t}\n\n\t\tint dp[105][35];\n\t\trep(i, 105) rep(j, 35) dp[i][j] = INF;\n\n\t\tdp[0][0] = 0;\n\n\t\tREP(i, 1, day) {\n\t\t\tif(dm[i] == INF) {\n\t\t\t\trep(j, t) {\n\t\t\t\t\tdp[i][j] = dp[i-1][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\trep(j, t) {\n\t\t\t\tif(j == 0) {\n\t\t\t\t\trep(k, t) {\n\t\t\t\t\t\tdp[i][j] = min(dp[i][j], dp[i-1][k] + 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif(v[j] <= dm[i]) {\n\t\t\t\t\t\tdp[i][j] = min(dp[i][j], dp[i-1][j-1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// cout << \" ------ i: \" << i << endl;\n\t\t\t// rep(j, 4) {\n\t\t\t// \trep(k, 4) cout << dp[j][k] << \" \";\n\t\t\t// \tcout << endl;\n\t\t\t// }\n\t\t}\n\n\t\tint ans = INF;\n\t\trep(i, t) {\n\t\t\tans = min(ans, dp[day-1][i]);\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n\nusing namespace std;\n\nstruct before_main{before_main(){cin.tie(0); ios::sync_with_stdio(false);}} before_main;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntemplate<class T, class U, class Compare>\nvoid pair_sort(vector<T>& a, vector<U>& b, Compare comp) {\n  vector<pair<T, U>> v;\n  rep(i, a.size()) v.emplace_back(a[i], b[i]);\n  sort(v.begin(), v.end(), comp);\n  rep(i, a.size()) tie(a[i], b[i]) = v[i];\n}\ntemplate<class T, class U>\nvoid pair_sort(vector<T>& a, vector<U>& b) {\n  pair_sort(a, b, std::less<pair<T, U>>());\n}\n\ntypedef long long ll;\nint const inf = 1<<29;\n\nint T, N;\nvector<int> t;\nvector<int> M;\n\nint solve() {\n\n  static int dp[2][33]; rep(i, 2) rep(j, 33) dp[i][j] = inf;\n\n  dp[0][0] = 0;\n\n  rep(i, N) {\n    rep(j, 33) dp[(i+1)&1][j] = inf;\n    rep(j, T) {\n      if(t[j] <= M[i]) {\n        minimize(dp[(i+1)&1][(j+1)%T], dp[i&1][j]);\n      }\n      minimize(dp[(i+1)&1][1%T], dp[i&1][j] + 1);\n    }\n  }\n\n  return *min_element(dp[N&1], dp[N&1] + 33);\n}\n\nint main() {\n\n  for(; cin >> T && T;) {\n    t.clear();\n    t.resize(T);\n    rep(i, T) cin >> t[i];\n    cin >> N;\n    M.clear();\n    M.resize(N, inf);\n    rep(i, N) {\n      int d, m; cin >> d >> m; d --;\n      minimize(M[d], m);\n    }\n    cout << solve() << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdlib>\n#include <iostream>\n#include <vector>\nusing namespace std;\n\ntemplate<class T> inline void chmin(T& a, const T& b) { if(b < a) a = b; }\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tfor(int c; cin >> c, c;) {\n\t\tvector<int> t(c);\n\t\tfor(int i = 0; i < c; ++i)\n\t\t\tcin >> t[i];\n\n\t\tint n;\n\t\tcin >> n;\n\n\t\tvector<int> get_up(100, 24);\n\t\tfor(int i = 0; i < n; ++i) {\n\t\t\tint d, m;\n\t\t\tcin >> d >> m;\n\t\t\tchmin(get_up[d - 1], m);\n\t\t}\n\n\t\tvector<int> dp(c, 101);\n\t\tdp[0] = 0;\n\t\tfor(int i = 0; i < 100; ++i) {\n\t\t\tvector<int> tmp(c, 101);\n\t\t\tfor(int j = 0; j < c; ++j) {\n\t\t\t\tchmin(tmp[1], dp[j] + 1);\n\t\t\t\tif(t[j] <= get_up[i])\n\t\t\t\t\tchmin(tmp[(j + 1) % c], dp[j]);\n\t\t\t}\n\n\t\t\tdp.swap(tmp);\n\t\t}\n\n\t\tcout << *min_element(dp.begin(), dp.end()) << endl;\n\t}\n\n\treturn EXIT_SUCCESS;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <map>\n#include <queue>\n#include <algorithm>\n#include <cmath>\n#include <string>\nusing namespace std;\n\nint bfs(int k, string s, string g){\n\tmap<string, int> d;\n\td[s] = 0;\n\tqueue<string> q;\n\tq.push(s);\n\t\n\tint res = 0;\n\twhile( !q.empty() ){\n\t\tstring now = q.front(); q.pop();\n\t\tint cost = d[now];\n\t\tif( now == g ) return cost;\n\t\t\n\t\tint pos = 0, diff;\n\t\tfor(int i = 0; i < k; i++){\n\t\t\tif( now[i] != g[i] ){\n\t\t\t\tpos = i;\n\t\t\t\tdiff = (g[i] - '0') - (now[i] - '0');\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfor(int i = pos; i < k; i++){\n\t\t\tstring next = now;\n\t\t\t\n\t\t\tfor(int j = pos; j <= i; j++){\n\t\t\t\tnext[j] += diff;\n\t\t\t\twhile( '9' < next[j] ) next[j] -= 10;\n\t\t\t\twhile( next[j] < '0' ) next[j] += 10;\n\t\t\t}\n\t\t\tif( !d.count(next) ){\n\t\t\t\td[next] = cost + 1;\n\t\t\t\tq.push(next);\n\t\t\t}\n\t\t}\n\t}\n\treturn -1;\n}\n\nint main(){\n\tint k;\n\twhile( cin >> k , k ){\n\t\tstring s, g;\n\t\tcin >> s >> g;\n\t\t\n\t\tcout << bfs(k, s, g) << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <map>\n#include <algorithm>\n\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n\nusing namespace std;\n\nint main() {\n  while(1){\n    int t;\n    cin>>t;\n    if(!t)break;\n    vector<int> c(t);\n    REP(i,t)cin>>c[i];\n    int n;\n    cin>>n;\n    vector<int> d(n),m(n);\n    REP(i,n)cin>>d[i]>>m[i];\n    vector<int> itv(100,100);\n    REP(i,n){\n      --d[i];\n      itv[d[i]]=min(itv[d[i]], m[i]);\n    }\n    vector<vector<int>> dp(102,vector<int>(t,10000));\n    dp[0][0] = 0;\n    REP(i,100){\n      REP(j,t){\n        if(itv[i] < c[j]) {\n          dp[i+1][1] = min(dp[i+1][1], dp[i][j] + 1);\n        } else {\n          dp[i+1][(j+1)%t] = dp[i][j];\n        }\n      }\n    }\n    cout<<*min_element(begin(dp[100]),end(dp[100]))<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#define INF 1e9\nusing namespace std;\n\nint main() {\n  while(1){\n    int T,cir[31];\n    cin >> T;\n    if(!T)break;\n    for(int i=0;i<T;i++) cin>>cir[i];\n \n    int n,d,h,job[102],dp[102][102];\n    for(int i=0;i<102;i++)\n      for(int j=0;j<102;j++)dp[i][j]=job[i]=INF;\n\n    cin>>n;\n    for(int i=0;i<n;i++)cin>>d>>h, job[d]=min(job[d],h);\n    dp[0][0]=0;\n    for(int i=0;i<=100;i++)\n      for(int j=0;j<T;j++){\n\tdp[i+1][1]=min(dp[i+1][1],dp[i][j]+1);\n\tif(cir[j]<=job[i+1])dp[i+1][(j+1)%T]=min(dp[i+1][(j+1)%T],dp[i][j]);\n      }\n    \n    int ans=INF;\n    for(int i=0;i<T;i++)ans=min(ans,dp[101][i]);\n    cout <<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main()\n{\n\tint T, N;\n\twhile (cin >> T, T) {\n\t\tvector<int> t(T);\n\t\tfor (int i = 0; i < T; i++) {\n\t\t\tcin >> t[i];\n\t\t}\n\t\tvector<int> mini(100, 23);\n\t\tcin >> N;\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tint D, M;\n\t\t\tcin >> D >> M; D--;\n\t\t\tmini[D] = M;\n\t\t}\n\t\tvector<int> dp(100, 100);\n\t\tdp[0] = 0;\n\t\tfor (int i = 1; i < 100; i++) {\n\t\t\tfor (int j = 0; j <= i; j++) {\n\t\t\t\tbool ok = true;\n\t\t\t\tfor (int k = j; k <= i; k++) {\n\t\t\t\t\tif (t[(k - j) % T] > mini[k]) {\n\t\t\t\t\t\tok = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (ok) {\n\t\t\t\t\tdp[i] = min(dp[i], dp[max(j - 1, 0)] + 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << dp[99] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main()\n{\n\tint T, N;\n\twhile (cin >> T, T) {\n\t\tvector<int> t(T);\n\t\tfor (int i = 0; i < T; i++) {\n\t\t\tcin >> t[i];\n\t\t}\n\t\tvector<int> m(100, 24);\n\t\tcin >> N;\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tint D, M;\n\t\t\tcin >> D >> M; D--;\n\t\t\tm[D] = M;\n\t\t}\n\t\tvector<vector<int>> dp(100, vector<int>(2, 100));\n\t\tdp[0][1] = 0;\n\t\tfor (int i = 1; i < 100; i++) {\n\t\t\tdp[i][1] = min(dp[i - 1][0], dp[i - 1][1]) + 1;\n\t\t\tfor (int j = 0; j < i; j++) {\n\t\t\t\tbool ok = true;\n\t\t\t\tfor (int k = j; k <= i; k++) {\n\t\t\t\t\tif (m[k] < t[(k - j) % T]) {\n\t\t\t\t\t\tok = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (ok) {\n\t\t\t\t\tdp[i][0] = min(dp[i][0], min(dp[j][0] + 1, dp[j][1]));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << min(dp[99][0], dp[99][1]) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <sstream>\n#include <map>\n#include <set>\n\n#define REP(i,k,n) for(int i=k;i<n;i++)\n#define rep(i,n) for(int i=0;i<n;i++)\n#define INF 1<<30\n#define pb push_back\n#define mp make_pair\n\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\n\nint main() {\n\tint t;\n\twhile(cin >> t && t) {\n\n\t\tvector<int> v(t);\n\t\trep(i, t) cin >> v[i];\n\n\t\tint n;\n\t\tcin >> n;\n\n\t\tvector<int> d(n), m(n);\n\t\tint dm[105], day = 0;\n\t\trep(i, 105) dm[i] = INF;\n\n\t\trep(i, n) {\n\t\t\tcin >> d[i] >> m[i];\n\t\t\tdm[d[i]-1] = min(dm[d[i]-1], m[i]);\n\t\t\tday = max(day, d[i]);\n\t\t}\n\n\t\tint dp[105][35];\n\t\trep(i, 105) rep(j, 35) dp[i][j] = INF;\n\n\t\tdp[0][0] = 0;\n\n\t\tREP(i, 1, day) {\n\t\t\trep(j, t) {\n\t\t\t\tif(j == 0) {\n\t\t\t\t\trep(k, t) {\n\t\t\t\t\t\tdp[i][j] = min(dp[i][j], dp[i-1][k] + 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif(v[j] <= dm[i]) {\n\t\t\t\t\t\tdp[i][j] = min(dp[i][j], dp[i-1][j-1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// cout << \" ------ i: \" << i << endl;\n\t\t\t// rep(j, 4) {\n\t\t\t// \trep(k, 4) cout << dp[j][k] << \" \";\n\t\t\t// \tcout << endl;\n\t\t\t// }\n\t\t}\n\n\t\tint ans = INF;\n\t\trep(i, t) {\n\t\t\tans = min(ans, dp[day-1][i]);\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nint b[100];\nint d[110];\nint dp[110][31];\nint main(){\n\tint a;\n\twhile(scanf(\"%d\",&a),a){\n\t\tfor(int i=0;i<a;i++)scanf(\"%d\",b+i);\n\t\tint c;scanf(\"%d\",&c);\n\t\tfor(int i=0;i<110;i++)d[i]=-1;\n\t\tfor(int i=0;i<c;i++){\n\t\t\tint p,q;scanf(\"%d%d\",&p,&q);\n\t\t\tp--;\n\t\t\tif(!~dp[p]||dp[p]>q)d[p]=q;\n\t\t}\n\t\tfor(int i=0;i<110;i++)for(int j=0;j<31;j++)dp[i][j]=999999999;\n\t\tdp[0][0]=0;\n\t\tfor(int i=0;i<100;i++){\n\t\t\tfor(int j=0;j<a;j++){\n\t\t//\t\tprintf(\"%d %d: %d\\n\",i,j,dp[i][j]);\n\t\t\t\tif(!~d[i]||b[j]<=d[i])dp[i+1][(j+1)%a]=min(dp[i+1][(j+1)%a],dp[i][j]);\n\t\t\t\tdp[i+1][1%a]=min(dp[i+1][1%a],dp[i][j]+1);\n\t\t\t}\n\t\t}\n\t\tint ret=999999999;\n\t\tfor(int i=0;i<a;i++)ret=min(ret,dp[100][i]);\n\t\tprintf(\"%d\\n\",ret);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int INF = 1e8;\n\nint main()\n{\n\tint T;\n\twhile (cin >> T, T) {\n\t\tvector<int> t(T);\n\t\tfor (int i = 0; i < T; i++) {\n\t\t\tcin >> t[i];\n\t\t}\n\t\tvector<int> H(100, 24);\n\t\tint N;\n\t\tcin >> N;\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tint D, M;\n\t\t\tcin >> D >> M; D--;\n\t\t\tH[D] = min(H[D], M);\n\t\t}\n\t\tvector<vector<int>> dp(100, vector<int>(T, INF));\n\t\tdp[0][0] = 0;\n\t\tfor (int i = 1; i < 100; i++) {\n\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\tif (dp[i - 1][j] != INF) {\n\t\t\t\t\tdp[i][0] = min(dp[i][0], dp[i - 1][j] + 1);\n\t\t\t\t\tif (t[(j + 1) % T] <= H[i]) {\n\t\t\t\t\t\tdp[i][(j + 1) % T] = min(dp[i][(j + 1) % T], dp[i - 1][j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint res = INF;\n\t\tfor (int i = 0; i < T; i++) {\n\t\t\tres = min(res, dp[99][i]);\n\t\t}\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\n\nint T, N;\nint t[35], D[110], M[110];\nint dp[110][110];\nint INF = 1 << 30;\n\nvoid chmin(int &a, int b) {\n    a = min(a, b);\n}\n\nint main() {\n    cin >> T;\n    for(int i=0; i<T; i++) cin >> t[i];\n    cin >> N;\n    for(int i=0; i<N; i++) cin >> D[i] >> M[i];\n\n    for(int i=0; i<=N; i++) {\n        for(int j=0; j<=N; j++) {\n            dp[i][j] = INF;\n        }\n    }\n\n    dp[0][0] = 0;\n    for(int i=1; i<=N; i++) {\n        // not use\n        for(int j=0; j<i; j++) {\n            int dist = i-j - (j == 0);\n            int wake = t[dist % T];\n            if(wake > M[i-1]) continue;\n            chmin(dp[i][j], dp[i-1][j]);\n        }\n\n        // use\n        if(t[0] <= M[i-1]) chmin(dp[i][i], *min_element(dp[i-1], dp[i-1] + N + 1) + 1);\n    }\n\n    /*\n    for(int i=0; i<=N; i++) {\n        for(int j=0; j<=N; j++) {\n            printf(\"dp[%d][%d] = \", i, j);\n            if(dp[i][j] == INF) printf(\"INF\\n\");\n            else printf(\"%d\\n\", dp[i][j]);\n        }\n    }\n    */\n\n    cout << *min_element(dp[N], dp[N] + N + 1) << endl;\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <map>\n#include <algorithm>\n#define INF 100000\nusing namespace std;\nint T,N;\nint t[31];\ntypedef pair<int,int> P;\nP p[101];\nint dp[101][31];\n\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d\",&T);\n\t\tif(T==0)break;\n\t\tfor(int i=0;i<T;i++){\n\t\t\tscanf(\"%d\",&t[i]);\n\t\t}\n\t\tscanf(\"%d\",&N);\n\t\tfor(int i=0;i<N;i++){\n\t\t\tscanf(\"%d %d\",&p[i].first,&p[i].second);\n\t\t}\n\t\tsort(p,p+N);\n\n\t\tfor(int i=0;i<=N;i++){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tdp[i][j]=INF;\n\t\t\t}\n\t\t}\n\t\tdp[0][0]=0;\n\t\tint res=INF;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tif(dp[i][j]!=INF){\n\t\t\t\t\tint next=j+p[i].first;\n\t\t\t\t\tif(i>0)next-=p[i-1].first;\n\t\t\t\t\telse next-=1;\n\t\t\t\t\tnext%=T;\n\t\t\t\t\tif(next<0)while(1);\n\t\t\t\t\tif(p[i].second>=t[next]){\n\t\t\t\t\t\tdp[i+1][next]=min(dp[i+1][next],dp[i][j]);\n\t\t\t\t\t\tif(i+1==N)res=min(res,dp[i+1][next]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t\t\t\t\tif(i+1==N)res=min(res,dp[i+1][0]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",res);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <map>\n#include <algorithm>\nusing namespace std;\nint T,N;\nint t[31];\ntypedef pair<int,int> P;\nP p[101];\n\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d\",&T);\n\t\tif(T==0)break;\n\t\tfor(int i=0;i<T;i++){\n\t\t\tscanf(\"%d\",&t[i]);\n\t\t}\n\t\tscanf(\"%d\",&N);\n\t\tfor(int i=0;i<N;i++){\n\t\t\tscanf(\"%d %d\",&p[i].first,&p[i].second);\n\t\t}\n\t\tsort(p,p+N);\n\t\tint cnt=0,prev=-1,turn=0;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(t[p[i].first-1]==p[i].second)continue;\n\t\t\telse{\n\t\t\t\tif(i>0 && p[i].first==p[i-1].first && p[i].second==p[i-1].second)continue;\n\t\t\t\tif(prev==-1){\n\t\t\t\t\tprev=i;\n\t\t\t\t\tcnt++;\n\t\t\t\t}else{\n\t\t\t\t\tint k=(p[i].first-p[prev].first)*24+p[i].second-p[prev].second;\n\t\t\t\t\twhile(k>=24)k--,turn=(turn+1)%T;\n\t\t\t\t\tif(k>=t[turn]+1 || k==0){\n\t\t\t\t\t}else{\n\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\tprev=i;\n\t\t\t\t\t\tturn=0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",cnt);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n\nusing namespace std;\n\nstruct before_main{before_main(){cin.tie(0); ios::sync_with_stdio(false);}} before_main;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntemplate<class T, class U, class Compare>\nvoid pair_sort(vector<T>& a, vector<U>& b, Compare comp) {\n  vector<pair<T, U>> v;\n  rep(i, a.size()) v.emplace_back(a[i], b[i]);\n  sort(v.begin(), v.end(), comp);\n  rep(i, a.size()) tie(a[i], b[i]) = v[i];\n}\ntemplate<class T, class U>\nvoid pair_sort(vector<T>& a, vector<U>& b) {\n  pair_sort(a, b, std::less<pair<T, U>>());\n}\n\ntypedef long long ll;\nint const inf = 1<<29;\n\nint T, N;\nvector<int> t;\nvector<int> M;\n\nint solve() {\n\n  static int dp[2][33]; rep(i, 2) rep(j, 33) dp[i][j] = inf;\n  dp[0][0] = 0;\n\n  rep(i, N) {\n    rep(j, 33) dp[(i+1)&1][j] = inf;\n    rep(j, T) {\n      if(t[j] <= M[i] || M[i] == 0) {\n        minimize(dp[(i+1)&1][(j+1)%T], dp[i&1][j]);\n      }\n      else {\n        minimize(dp[(i+1)&1][1%T], dp[i&1][j] + 1);\n      }\n    }\n  }\n\n  return *min_element(dp[N&1], dp[N&1] + 33);\n}\n\nint main() {\n\n  for(; cin >> T && T;) {\n    t.clear();\n    t.resize(T);\n    rep(i, T) cin >> t[i];\n    cin >> N;\n    M.clear();\n    M.resize(N, inf);\n    rep(i, N) {\n      int d, m; cin >> d >> m; d --;\n      minimize(M[d], m);\n    }\n    cout << solve() << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n  int tm,n;\n  while(cin >> tm,tm){\n    int i,j,k;\n    int t[tm];\n    for(i=0;i<tm;i++) cin >> t[i];\n    cin >> n;\n    int m[150]={};\n    fill(m,m+150,24);\n    for(i=1;i<=n;i++){\n      cin >> k;\n      cin >> m[k];\n    }\n    int inf = 1<<20;\n    int dp[150][50];\n    fill(dp[0],dp[149],inf);\n    dp[1][0]=0;\n    for(i=1;i<=110;i++){\n      for(j=0;j<tm;j++){\n\tif(dp[i][j]==inf) continue;\n\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t//cout <<i<<\":\"<<j<<\":\"<< t[(j+1)%tm]<<\":\"<<m[i]<<endl;\n\tif(t[(j+1)%tm]<=m[i+1]){\n\t  dp[i+1][(j+1)%tm]=min(dp[i+1][(j+1)%tm],dp[i][j]);\n\t}\n      }\n    }\n    int o=inf;\n    /*\n    for(j=1;j<=n+10;j++){\n      cout << j << \":\";\n      for(i=0;i<tm;i++) cout << dp[j][i] << (i==tm-1?\"\\n\":\" \");\n    }\n    */\n    for(i=0;i<tm;i++) o=min(o,dp[101][i]);\n    cout << o << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,a,b) for(int i=a;i<b;i++)\n#define INF INT_MAX/2\ntypedef long long int ll;\ntypedef vector<ll> vi;\ntypedef vector<vi> vvi;\n\nint main()\n{\n\twhile (1)\n\t{\n\t\tint T; cin >> T;\n\t\tif (T == 0) return 0;\n\n\t\tint t[30];\n\t\trep(i, 0, T) cin >> t[i];\n\n\t\tint N; cin >> N;\n\n\t\tmap<int, int> DM;\n\t\trep(i, 0, N)\n\t\t{\n\t\t\tint D, M;\n\t\t\tcin >> D >> M;\n\t\t\tDM[D] = M;\n\t\t}\n\n\t\tvvi dp(105, vi(T, INF));\n\t\tdp[1][0] = 0;\n\n\t\trep(d, 1, 101) rep(j, 0, T)\n\t\t{\n\t\t\tif (dp[d][j] == INF) continue;\n\n\t\t\tdp[d + 1][1] = min(dp[d + 1][1], dp[d][j] + 1);\n\t\t\t\n\t\t\tif (DM.find(d) == DM.end())\n\t\t\t{\n\t\t\t\tdp[d + 1][(j + 1) % T] = min(dp[d + 1][(j + 1) % T], dp[d][j]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (t[j] <= DM[d])\n\t\t\t\t{\n\t\t\t\t\tdp[d + 1][(j + 1) % T] = min(dp[d + 1][(j + 1) % T], dp[d][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tll ans = INF;\n\t\trep(j, 0, T) ans = min(ans, dp[101][j]);\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "////////////////////////////////////////\n///  tu3 pro-con template            ///\n////////////////////////////////////////\n#include <cassert>\n#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <iostream>\n#include <sstream>\n#include <algorithm>\n#include <numeric>\n#include <functional>\n#include <vector>\n#include <queue>\n#include <string>\n#include <complex>\n#include <stack>\n#include <set>\n#include <map>\n#include <list>\n#include <unordered_map>\n#include <unordered_set>\n#include <bitset>\n#include <regex>\nusing namespace std;\n\n//// MACRO ////\n#define countof(a) (sizeof(a)/sizeof(a[0]))\n\n#define REP(i,n) for (int i = 0; i < (n); i++)\n#define RREP(i,n) for (int i = (n)-1; i >= 0; i--)\n#define FOR(i,s,n) for (int i = (s); i < (n); i++)\n#define RFOR(i,s,n) for (int i = (n)-1; i >= (s); i--)\n#define pos(c,i) c.being() + (i)\n#define allof(c) c.begin(), c.end()\n#define aallof(a) a, countof(a)\n#define partof(c,i,n) c.begin() + (i), c.begin() + (i) + (n)\n#define apartof(a,i,n) a + (i), a + (i) + (n)\n#define long long long\n\n#define EPS 1e-9\n#define INF (1L << 30)\n#define LINF (1LL << 60)\n\n#define PREDICATE(t,a,exp) [&](const t & a) -> bool { return exp; }\n#define COMPARISON_T(t) bool(*)(const t &, const t &)\n#define COMPARISON(t,a,b,exp) [&](const t & a, const t & b) -> bool { return exp; }\n#define CONVERTER(TSrc,t,TDest,exp) [&](const TSrc &t)->TDest { return exp; }\n\ninline int sign(double x) { return (abs(x) < EPS ? 0 : x > 0 ? 1 : -1); }\ninline bool inRange(int val, int min, int max) { return val >= min && val < max; }\ninline bool inRange(double val, double min, double max) { return val - min > -EPS && val - max < EPS; }\n\n#ifdef ccout\n#define cout ccout\n#define endl cendl\n#endif\n\n//// i/o helper ////\n\nstruct _Reader { template <class T> _Reader operator ,(T &rhs) { cin >> rhs; return *this; } };\nstruct _Writer { bool f; _Writer() : f(false) { } template <class T> _Writer operator ,(const T &rhs) { cout << (f ? \" \" : \"\") << rhs; f = true; return *this; } };\n#define READ(t,...) t __VA_ARGS__; _Reader(), __VA_ARGS__\n#define WRITE(...) _Writer(), __VA_ARGS__; cout << endl\n\ntemplate <class T> struct vevector : public vector<vector<T>> { vevector(int n = 0, int m = 0, const T &initial = T()) : vector<vector<T>>(n, vector<T>(m, initial)) { } };\ntemplate <class T> struct vevevector : public vector<vevector<T>> { vevevector(int n = 0, int m = 0, int l = 0, const T &initial = T()) : vector<vevector<T>>(n, vevector<T>(m, l, initial)) { } };\ntemplate <class T> struct vevevevector : public vector<vevevector<T>> { vevevevector(int n = 0, int m = 0, int l = 0, int k = 0, const T &initial = T()) : vector<vevevector<T>>(n, vevevector<T>(m, l, k, initial)) { } };\ntemplate <class T> T read() { T t; cin >> t; return t; }\ntemplate <class T> vector<T> read(int n) { vector<T> v; REP(i, n) { v.push_back(read<T>()); } return v; }\ntemplate <class T> vevector<T> read(int n, int m) { vevector<T> v; REP(i, n) v.push_back(read<T>(m)); return v; }\ntemplate <class T> vevector<T> readjag() { return read<T>(read<int>()); }\ntemplate <class T> vevector<T> readjag(int n) { vevector<T> v; REP(i, n) v.push_back(readjag<T>()); return v; }\n\ntemplate <class T1, class T2> inline istream & operator >> (istream & in, pair<T1, T2> &p) { in >> p.first >> p.second; return in; }\ntemplate <class T1, class T2> inline ostream & operator << (ostream &out, pair<T1, T2> &p) { out << p.first << p.second; return out; }\ntemplate <class T> inline ostream & operator << (ostream &out, vector<T> &v)\n{\n\tostringstream ss;\n\tfor (auto x : v) ss << x << ' ';\n\tauto s = ss.str();\n\tout << s.substr(0, s.length() - 1) << endl;\n\treturn out;\n}\n\n//// start up ////\nvoid solve();\ninline void readfrom(string filename) { freopen(filename.c_str(), \"r\", stdin); }\ninline void writeto(string filename) { freopen(filename.c_str(), \"w\", stdout); }\nint main()\n{\n\tsolve();\n\treturn 0;\n}\n\n////////////////////\n/// template end ///\n////////////////////\n\nvoid solve()\n{\n\tint testcases = INF;\n\tREP(testcase, testcases)\n\t{\n\t\tREAD(int, T);\n\t\tif (!T) break;\n\t\tauto tlp = read<int>(T);\n\t\tREAD(int, N);\n\t\t\n\t\tvector<int> d(100, 24);\n\t\tfor (auto i : read<pair<int, int>>(N))\n\t\t\td[i.first - 1] = min(d[i.first - 1], i.second);\n\t\n\t\tdeque< tuple<int, int, int> > q; // day,cycle,cost\n\t\tq.emplace_back(0, 0, 0);\n\t\tint result = -1;\n\t\tvevector<bool> visited(101, T);\n\t\twhile (!q.empty())\n\t\t{\n\t\t\tint i, c, x;\n\t\t\ttie(i, c, x) = q.front();\n\t\t\tq.pop_front();\n\t\t\t//WRITE(\"debug\", i, c, x);\n\t\t\tif (i == 100) { result = x; break; }\n\t\t\tif (visited[i][c]) continue;\n\t\t\tvisited[i][c] = true;\n\t\t\tif (d[i] < tlp[c]) continue;\n\t\t\tif (!visited[i + 1][(c + 1) % T]) { q.emplace_front(i + 1, (c + 1) % T, x); }\n\t\t\tif (!visited[i + 1][0]) q.emplace_back(i + 1, 0, x + 1);\n\t\t}\n\t\tWRITE(result);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <map>\n#include <algorithm>\n#define INF 100000\nusing namespace std;\nint T,N;\nint t[101];\ntypedef pair<int,int> P;\nP p[201];\nint dp[201][31];\nint d[101];\n\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d\",&T);\n\t\tif(T==0)break;\n\t\tfor(int i=0;i<T;i++){\n\t\t\tscanf(\"%d\",&t[i]);\n\t\t}\n\t\tfor(int i=0;i<=100;i++)d[i]=23;\n\t\tscanf(\"%d\",&N);\n\t\tfor(int i=0;i<N;i++){\n\t\t\tscanf(\"%d %d\",&p[i].first,&p[i].second);\n\t\t\tp[i].first--;\n\t\t\td[p[i].first]=min(d[p[i].first],p[i].second);\n\t\t}\n\t\tfor(int i=0;i<=100;i++){\n\t\t\tfor(int j=0;j<=T;j++){\n\t\t\t\tdp[i][j]=INF;\n\t\t\t}\n\t\t}\n\t\tdp[0][0]=0;\n\t\tint res=INF;\n\t\tfor(int i=0;i<100;i++){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tif(dp[i][j]!=INF){\n\t\t\t\t\tif(d[i]>=t[j]){\n\t\t\t\t\t\tdp[i+1][(j+1)%T]=min(dp[i+1][(j+1)%T],dp[i][j]);\n\t\t\t\t\t\tif(i+1==100)res=min(res,dp[i+1][(j+1)%T]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1]=min(dp[i+1][1],dp[i][j]+1);\n\t\t\t\t\tif(i+1==100)res=min(res,dp[i+1][1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",res);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\nusing lint = long long;\nusing ldouble = long double;\n\nconst int INF = 1 << 30;\n\nbool solve() {\n    int T;\n    cin >> T;\n    if (T == 0) return false;\n\n    vector<int> P(T);\n    for (auto& p : P) cin >> p;\n\n    int N;\n    cin >> N;\n    vector<int> M(100, 24);\n    for (int i = 0; i < N; ++i) {\n        int D;\n        cin >> D;\n        cin >> M[--D];\n    }\n\n    vector<int> dp(N, INF);\n    dp[0] = 0;\n    // dp[t] = t番目の周期にいるときのカフェインの最小値\n\n    for (int d = 0; d < 100; ++d) {\n        for (int t = 0; t < T; ++t) {\n            if (P[t] > M[d]) dp[t] = INF;\n        }\n\n        rotate(dp.begin(), dp.end() - 1, dp.end());\n        dp[0] = min(dp[0], *min_element(dp.begin(), dp.end()) + 1);\n    }\n\n    cout << *min_element(dp.begin(), dp.end()) << endl;\n    return true;\n}\n\nint main() {\n    while (solve()) {}\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define For(i, a, b) for(int (i)=(int)(a); (i)<(int)(b); ++(i))\n#define rFor(i, a, b) for(int (i)=(int)(a)-1; (i)>=(int)(b); --(i))\n#define rep(i, n) For((i), 0, (n))\n#define rrep(i, n) rFor((i), (n), 0)\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long lint;\ntypedef unsigned long long ulint;\ntypedef pair<int, int> pii;\ntemplate<class T> bool chmax(T &a, const T &b){if(a<b){a=b; return true;} return false;}\ntemplate<class T> bool chmin(T &a, const T &b){if(a>b){a=b; return true;} return false;}\ntemplate<class T> T div_floor(T a, T b){\n    if(b < 0) a *= -1, b *= -1;\n    return a>=0 ? a/b : (a+1)/b-1;\n}\ntemplate<class T> T div_ceil(T a, T b){\n    if(b < 0) a *= -1, b *= -1;\n    return a>0 ? (a-1)/b+1 : a/b;\n}\n\nconstexpr lint mod = 1e9+7;\nconstexpr lint INF = mod * mod;\nconstexpr int MAX = 200010;\n\nint main(){\n    int T, t[35], n, M[110];\n    while(scanf(\"%d\", &T) && T){\n        rep(i, T) scanf(\"%d\", &t[i]);\n        scanf(\"%d\", &n);\n        fill(M, M+110, mod);\n        rep(i, n){\n            int d, m;\n            scanf(\"%d%d\", &d, &m);\n            chmin(M[d-1], m);\n        }\n\n        int dp[111][T];\n        rep(i, 111)rep(j, T) dp[i][j] = mod;\n        dp[0][0] = 0;\n        rep(i, 110)rep(j, T)if(dp[i][j] < mod && t[j] <= M[i]){\n            chmin(dp[i+1][(j+1)%T], dp[i][j]);\n            chmin(dp[i+1][0], dp[i][j] + 1);\n        }\n        int ans = mod;\n        rep(j, T) chmin(ans, dp[110][j]);\n        printf(\"%d\\n\", ans);\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,a,b) for(int i=a;i<b;i++)\n#define INF INT_MAX/2\ntypedef long long int ll;\ntypedef vector<ll> vi;\ntypedef vector<vi> vvi;\n\nint main()\n{\n\twhile (1)\n\t{\n\t\tint T; cin >> T;\n\t\tif (T == 0) return 0;\n\n\t\tint t[30];\n\t\trep(i, 0, T) cin >> t[i];\n\n\t\tint N; cin >> N;\n\n\t\tmap<int, int> DM;\n\t\trep(i, 0, N)\n\t\t{\n\t\t\tint D, M;\n\t\t\tcin >> D >> M;\n\t\t\tif(DM.find(D) == DM.end())\n\t\t\t\tDM[D] = M;\n\t\t\telse\n\t\t\t\tDM[D] = min(DM[D], M);\n\t\t}\n\n\t\tvvi dp(105, vi(T, INF));\n\t\tdp[1][0] = 0;\n\n\t\trep(d, 1, 101) rep(j, 0, T)\n\t\t{\n\t\t\tif (dp[d][j] == INF) continue;\n\n\t\t\tdp[d + 1][1] = min(dp[d + 1][1], dp[d][j] + 1);\n\t\t\t\n\t\t\tif (DM.find(d) == DM.end())\n\t\t\t{\n\t\t\t\tdp[d + 1][(j + 1) % T] = min(dp[d + 1][(j + 1) % T], dp[d][j]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (t[j] <= DM[d])\n\t\t\t\t{\n\t\t\t\t\tdp[d + 1][(j + 1) % T] = min(dp[d + 1][(j + 1) % T], dp[d][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tll ans = INF;\n\t\trep(j, 0, T) ans = min(ans, dp[101][j]);\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\n\nconst int INF = 1e+8;\n\nint main(){\n\tint T, N;\n\twhile( cin >> T, T ){\n\t\tint t[31], day[101], maxd = 0;\n\t\tfill(day, day + 101, INF);\n\t\t\n\t\tfor(int i = 0; i < T; i++) cin >> t[i];\n\t\tcin >> N;\n\t\tfor(int i = 0; i < N; i++){\n\t\t\tint D, M;\n\t\t\tcin >> D >> M;\n\t\t\tday[D-1] = min(day[D-1], M);\n\t\t\tmaxd = max(maxd, D);\n\t\t}\n\t\t\n\t\t// dp[k][t] := k日目で周期がt番目のときの最小コスト\n\t\tint dp[101][31];\n\t\tfor(int i = 0; i < 101; i++) fill(dp[i], dp[i] + 31, INF);\n\t\tdp[0][0] = 0;\n\t\t\n\t\tfor(int i = 0; i < maxd; i++){\n\t\t\tfor(int j = 0; j < T; j++){\n\t\t\t\tif( t[j] <= day[i] ){\n\t\t\t\t\tdp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T], dp[i][j]);\n\t\t\t\t}\n\t\t\t\t// 周期をリセットする\n\t\t\t\tdp[i+1][1] = min(dp[i+1][1], dp[i][j] + 1);\n\t\t\t}\n\t\t}\n\t\tint ans = INF;\n\t\tfor(int i = 0; i < T; i++){\n\t\t\tans = min(ans, dp[maxd][i]);\n\t\t}\n\t\tcout << ans << endl;\n\t} \n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \n#define MAX_T 30\n#define MAX_N 100\n#define INF 1e9\n \nint N,T,dp[MAX_N+1][MAX_T];\nint arr[MAX_N],t[MAX_T],d;\n \nint solve(int idx,int pos){\n    if(idx == d+1) return 0;\n    if(dp[idx][pos] != -1){\n\treturn dp[idx][pos];\n    }\n    int res = INF;\n    for(int i = 0 ; i < T ; i++){\n\tif(t[pos] <= arr[idx]){\n\t    res = min(res,solve(idx+1,(pos+1)%T));\n\t}\n\tres = min(res,solve(idx+1,1)+1);\n    }\n    return dp[idx][pos] = res;\n}\n \nint main(){\n    while(cin >> T, T){\n\tfor(int i = 0 ; i < MAX_N ; i++){\n\t    arr[i] = INF;\n\t}\n\tfor(int i = 0 ; i < T ; i++){\n\t    cin >> t[i];\n\t}\n\tint D,M;\n\td = 0;\n\tcin >> N;\n\tfor(int i = 0 ; i < N ; i++){\n\t    cin >> D >> M; D--;\n\t    d = max(d,D);\n\t    arr[D] = min(arr[D],M);\n\t}\n\tmemset(dp,-1,sizeof(dp));  \n\tcout << solve(0,0) << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int INF = 1001001001;\n\nint main()\n{\n\tint T;\n\n\twhile (scanf(\"%d\", &T) && T){\n\t\tint t[30];\n\t\tfor (int i = 0; i < T; i++) scanf(\"%d\", t + i);\n\n\t\tint N;\n\t\tint L[128];\n\n\t\tfill(L, L + 128, INF);\n\t\tscanf(\"%d\", &N);\n\t\tfor (int i = 0; i < N; i++){\n\t\t\tint x, y;\n\t\t\tscanf(\"%d %d\", &x, &y);\n\t\t\tL[x] = min(L[x], y);\n\t\t}\n\n\t\tint dp[128][30];\n\t\tfor (int i = 0; i < 128; i++) fill(dp[i], dp[i] + T, INF);\n\n\t\tdp[0][T - 1] = 0;\n\t\tfor (int i = 1; i <= 100; i++){\n\t\t\tfor (int j = 0; j < T; j++){\n\t\t\t\tif (t[(j + 1) % T] <= L[i]){\n\t\t\t\t\tdp[i][(j + 1) % T] = min(dp[i][(j + 1) % T], dp[i - 1][j]);\n\t\t\t\t\tdp[i][T - 1] = min(dp[i][T - 1], dp[i - 1][j] + 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%d\\n\", *min_element(dp[100], dp[100] + T));\n\t}\n\n\treturn (0);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cmath>\nusing namespace std;\n\nint main() {\n    int T;\n    while(cin >> T, T) {\n        vector<int> t(T);\n        int N = 0;\n        for(int i=0; i<T; ++i) {\n            cin >> t[i];\n        }\n        cin >> N;\n        vector<vector<int>> dp(101, vector<int>(101, 1e9));\n        dp[1][1] = 0;\n        vector<int> M(101, 1e9);\n        for(int i=0; i<N; ++i) {\n            int d, m;\n            cin >> d >> m;\n            M[d] = min(m, M[d]);\n        }\n        for(int i=2; i<101; ++i) {\n            for(int j=1; j<i; ++j) {\n                if(M[i] >= t[(i-j) % T]) {\n                    dp[i][j] = dp[i-1][j];\n                }\n            }\n            for(int j=1; j<101; ++j) {\n                dp[i][i] = min(dp[i][i], dp[i-1][j]+1);\n            }\n        }\n        int res = 1e9;\n        for(int i=1; i<101; ++i) {\n            res = min(res, dp[100][i]);\n        }\n        cout << res << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <sstream>\n#include <cstdio>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <complex>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include <climits>\n#include <queue>\n#include <set>\n#include <map>\n#include <valarray>\n#include <bitset>\n#include <stack>\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\ntypedef long long ll;\ntypedef pair<int,int> pii;\nconst int INF = 1<<29;\nconst double PI = acos(-1);\nconst double EPS = 1e-8;\n\n// dp[i][j] = i日目で周期がjのときの最低回数（無理ならINF）\nint dp[101][31];\n\nint main() {\n  int T;\n  while(cin>>T,T) {\n    int t[T];\n    REP(i,T)cin>>t[i];\n    int N;cin>>N;\n    int D[N], M[N];\n    int A[101];\n    REP(i,101) A[i]=23;\n    REP(i,N) {\n      cin >> D[i] >> M[i];\n      A[D[i]] = M[i];\n    }\n    REP(i,101)REP(j,T+1)dp[i][j]=INF;\n    dp[0][0] = 0;\n    REP(i,100) {\n      REP(j,T) {\n        //cout << i << \" \" << j << \" \" << t[j] << \" \" << A[i] << \" \" << dp[i][j] << endl;\n        if (t[j]<=A[i+1]) {       // ok\n          dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T], dp[i][j]);\n        }\n        dp[i+1][1] = min(dp[i+1][1], dp[i][j]+1);\n      }\n    }\n    int ans = INF;\n    REP(i,T) ans = min(ans, dp[100][i]);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> P;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\nconst double PI = 3.14159265358979323846;\nconst double EPS = 1e-12;\nconst int INF = numeric_limits<int>::max() / 2;\nconst int NEG_INF = numeric_limits<int>::min() / 2;\nconst int MOD = 1e9 + 7;\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tint T;\n\twhile (true) {\n\t\tcin >> T;\n\t\tif (T == 0) break;\n\t\tvector<int> t(30);\n\t\tfor (int i = 0; i < T; i++) cin >> t[i];\n\t\tint n; cin >> n;\n\t\tvector<int> m(110, 23);\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tint di, mi; cin >> di >> mi;\n\t\t\tm[di] = mi;\n\t\t}\n\t\tVVI dp(110, vector<int>(T, INF));\n\t\tdp[1][0] = 0;\n\t\tfor (int i = 2; i <= 100; i++) {\n\t\t\tdp[i][0] = dp[i - 1][0] + 1;\n\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\tif (m[i] >= t[j]) dp[i][j] = min(dp[i][j], dp[i - 1][(j + T - 1) % T]);\n\t\t\t}\n\t\t}\n\t\tint res = INF;\n\t\tfor (int i = 0; i < T; i++) res = min(res, dp[100][i]);\n\t\tcout << res << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<n;i++)\n#define INF 100000000\nusing namespace std;\n\nint T,N;\nint t[30],ti[101];\nint dp[101][30];\n\nint main(){\n\twhile(cin>>T,T){\n\t\trep(i,T)cin>>t[i];\n\t\trep(i,101)ti[i]=INF;\n\t\trep(i,101)rep(j,30)dp[i][j]=INF;\n\t\tdp[1][0]=0;\n\t\tcin>>N;\n\t\trep(i,N){\n\t\t\tint d,m;\n\t\t\tcin>>d>>m;\n\t\t\tti[d]=min(ti[d],m);\n\t\t}\n\t\tint ans=INF;\n\t\tfor(int i=2;i<=100;i++){\n\t\t\tif(ti[i]==INF){\n\t\t\t\trep(j,T)dp[i][(j+1)%T]=dp[i-1][j];\n\t\t\t\trep(j,T)dp[i][0]=min(dp[i][0],dp[i-1][j]+1);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\trep(j,T){\n\t\t\t\tdp[i][0]=min(dp[i][0],dp[i-1][j]+1);\n\t\t\t\tif(ti[i]>=t[(j+1)%T]){\n\t\t\t\t\tdp[i][(j+1)%T]=min(dp[i][(j+1)%T],dp[i-1][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\trep(i,T)ans=min(ans,dp[100][i]);\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nconst int INF = 1e9;\nconst ll LINF = 1e18;\ninline ll gcd(ll a, ll b) { return b ? gcd(b, a%b) : a; }\ninline ll lcm(ll a, ll b) { return a / gcd(a, b)*b; }\ntemplate<class S,class T> ostream& operator << (ostream& out,const pair<S,T>& o){ out << \"(\" << o.first << \",\" << o.second << \")\"; return out; }\ntemplate<class T> ostream& operator << (ostream& out,const vector<T>& V){ for(int i = 0; i < V.size(); i++){ out << V[i]; if(i!=V.size()-1) out << \" \";} return out; }\ntemplate<class T> ostream& operator << (ostream& out,const vector<vector<T> >& Mat){ for(int i = 0; i < Mat.size(); i++) { if(i != 0) out << endl; out << Mat[i];} return out; }\ntemplate<class S,class T> ostream& operator << (ostream& out,const map<S,T>& mp){ out << \"{ \"; for(auto it = mp.begin(); it != mp.end(); it++){ out << it->first << \":\" << it->second; if(mp.size()-1 != distance(mp.begin(),it)) out << \", \"; } out << \" }\"; return out; }\ntemplate<typename T>vector<T> make_v(size_t a){return vector<T>(a);}\ntemplate<typename T,typename... Ts>auto make_v(size_t a,Ts... ts){return vector<decltype(make_v<T>(ts...))>(a,make_v<T>(ts...));}\ntemplate<typename T,typename V> typename enable_if<is_class<T>::value==0>::type fill_v(T &t,const V &v){t=v;}\ntemplate<typename T,typename V> typename enable_if<is_class<T>::value!=0>::type fill_v(T &t,const V &v){for(auto &e:t) fill_v(e,v);}\n/*\n <url:http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=2166>\n 問題文============================================================\n =================================================================\n 解説=============================================================\n ================================================================\n */\n\nll T;\nvector<ll> t(50);\nll N;\nvector<ll> M(115);\nll dp[115][50];\n\ntemplate<class Type>\nType solve(Type res = Type()){\n    while(cin >> T,T){\n        for(int i = 0; i < T;i++) cin >> t[i];\n        cin >> N;\n        fill(M.begin(),M.end(),INF);\n        for(int i = 0; i < N;i++){\n            ll D,m; cin >> D >> m;\n            M[D-1] = min(M[D-1],m);\n        }\n        \n        // dp[i日目][j番目の睡眠時間] := 最小カフェイン数\n        fill(*dp,*dp+110*50,INF);\n        dp[0][0] = 0;\n        for(int i = 0; i < 110;i++){\n            for(int j = 0; j < T;j++){\n                if(dp[i][j] == INF) continue;\n                if(t[j] <= M[i]){\n                    dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T],dp[i][j]);\n                    dp[i+1][0] = min(dp[i+1][0],dp[i][j]+1);\n                }\n            }\n        }\n        cout << *min_element(dp[100], dp[100]+50) << endl;\n    }\n    return res;\n}\nint main(void) {\n    cin.tie(0); ios_base::sync_with_stdio(false);\n    solve(0);\n    // cout << fixed << setprecision(15) << solve<ll>() << endl;\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#define INF 1e9\nusing namespace std;\n\n\nint main() {\n  while(1){\n    int T,cir[31],n;\n    cin >> T;\n    if(!T)break;\n    for(int i=0;i<T;i++) cin>>cir[i];\n    cin>>n;\n    int d,h,job[102]={},dp[102][102]={};\n    for(int i=0;i<102;i++)for(int j=0;j<102;j++)dp[i][j]=job[i]=INF;\n    for(int i=0;i<n;i++)cin>>d>>h,job[d]=min(job[d],h);\n\n    dp[0][0]=0;\n    for(int i=0;i<=100;i++)\n      for(int j=0;j<T;j++){\n\tdp[i+1][1]=min(dp[i+1][1],dp[i][j]+1);\n\tif(cir[j]<=job[i+1])dp[i+1][(j+1)%T]=min(dp[i+1][(j+1)%T],dp[i][j]);\n      }\n\n    int ans=INF;\n    for(int i=0;i<T;i++)ans=min(ans,dp[101][i]);\n    cout <<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr, __VA_ARGS__)\n// #define LOG(...)\n#define FOR(i, a, b) for(int i = (int)(a); i < (int)(b); ++i)\n#define REP(i, n) for(int i = 0; i < (int)(n); ++i)\n#define RREP(i, n) for(int i = (int)(n - 1); i >= 0; --i)\n#define RFOR(i, a, b) for(int i = (int)(b - 1); i >= (int)(a); --i)\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EXIST(s, e) ((s).find(e) != (s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n#define SQ(n) (n) * (n)\n#define BIT(x, i) (((x) >> (i)) & 1)\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<char> vc;\ntypedef vector<pii> vpi;\ntypedef vector<pll> vpl;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vc> vvc;\ntypedef vector<vll> vvll;\n\nconst int HINF = 30;\nconst int DINF = 200;\n\nint interview[100];\n\nint main() {\n  int T, N;\n  while(cin >> T, T) {\n    int maxinterview = 0;\n    fill_n((int *)interview, 100, HINF);\n\n    vi cycle(T);\n    REP(i, T){\n      cin >> cycle[i];\n      cycle[i]--;\n    }\n\n    cin >> N;\n    REP(i, N) {\n      int d, m;\n      cin >> d >> m;\n      d--; m--;\n      interview[d] = min(interview[d], m);\n      maxinterview = max(maxinterview, d);\n    }\n    maxinterview++;\n\n    vvi dp(maxinterview + 1, vi(T, DINF));\n    dp[0][T - 1] = 0;\n\n    // LOG(\"\\n[%d]\\n\", 0);\n    // REP(i, T) {\n    //   LOG(\"%d \", dp[0][i]);\n    // }\n    // LOG(\"\\n\");\n\n    REP(d, maxinterview) {\n      REP(i, T) {\n        if (dp[d][i] == DINF) continue;\n        int sc;\n        // yes caffeine\n        sc = 0;\n        dp[d + 1][0] = min(dp[d + 1][0], dp[d][i] + 1);\n        // no caffeine\n        sc = (i + 1) % T;\n        if (interview[d] >= cycle[sc]) {\n          dp[d + 1][sc] = min(dp[d + 1][sc], dp[d][i]);\n        } else {\n          // LOG(\"nesugosi\\n\");\n        }\n      }\n\n      // LOG(\"\\n[%d]\\n\", d + 1);\n      // REP(i, T) {\n      //   LOG(\"%d \", dp[d + 1][i]);\n      // }\n      // LOG(\"\\n\");\n    }\n    cout << *min_element(ALL(dp[maxinterview])) << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\nint t[30];\npair<int,int> d[101];\nint kisyou[101];\nint dp[101][30];//i日目でサイクルt[j]になるには何個必要か\nint main()\n{\n\tint m,n;\n\tint ans=0;\n\twhile(1)\n\t{\n\t\tcin>>m;\n\t\tif(m==0)\n\t\t\tbreak;\n\t\tfor(int i=0;i<m;i++)\n\t\t\tcin>>t[i];\n\t\tt[0]=1;\n\t\tcin>>n;\n\t\td[0]=make_pair(1,1);\n\t\tfor(int i=1;i<n+1;i++)\n\t\t{\n\t\t\tint x,y;\n\t\t\tcin>>x>>y;\n\t\t\td[i]=make_pair(x,y);\n\t\t}\n\t\tsort(d,d+n);\n\t\tint now=0;\n\t\tfill(kisyou,kisyou+101,23);\n\t\tfor(int i=1;i<n+1;i++)\n\t\t\tkisyou[d[i].first]=min(kisyou[d[i].first],d[i].second);\n\t\tfill(dp[0],dp[101],1e8-1);\n\t\tdp[1][0]=0;\n\t\tfor(int i=2;i<101;i++)\n\t\t{\n\t\t\tfor(int j=0;j<m;j++)\n\t\t\t\tdp[i][0]=min(dp[i-1][j]+1,dp[i][0]);\n\t\t\t//m日さかのぼる\n\t\t\t//dp[i][j]が可能か調べる（j==mのときj=0）\n\t\t\tfor(int j=1;j<m+1;j++)\n\t\t\t{\n\t\t\t\tif(i-j==0)\n\t\t\t\t\tbreak;\n\t\t\t\tbool f=true;\n\t\t\t\tfor(int k=0;k<m;k++)\n\t\t\t\t{\n\t\t\t\t\tif(j==k)\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tif(dp[i-j+k][k]==1e8-1)\n\t\t\t\t\t{\n\t\t\t\t\t\tf=false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(f && t[j%m]<=kisyou[i])\n\t\t\t\t\tdp[i][j%m]=dp[i-j][0];\n\t\t\t}\n\t\t\t//cerr<<dp[i][0]<<endl;\n\t\t}\n\t\tans=1e8-1;\n\t\tfor(int i=0;i<m;i++)\n\t\t\tans=min(ans,dp[100][i]);\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef pair<int,int> pii;\n#define all(c) (c).begin(), (c).end()\n#define loop(i,a,b) for(ll i=a; i<ll(b); i++)\n#define rep(i,b) loop(i,0,b)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define lb lower_bound\n#define ub upper_bound\n#ifdef DEBUG\n#define dump(...) (cerr<<#__VA_ARGS__<<\" = \"<<(DUMP(),__VA_ARGS__).str()<<\" [\"<<__LINE__<<\"]\"<<endl)\nstruct DUMP:ostringstream{template<class T>DUMP &operator,(const T&t){if(this->tellp())*this<<\", \";*this<<t;return *this;}};\n#else\n#define dump(...)\n#endif\ntemplate<class T> ostream& operator<<(ostream& os, vector<T> const& v){\n    rep(i,v.size()) os << v[i] << (i+1==v.size()?\"\":\" \");\n    return os;\n}\n\nint T, t[40];\nint N;\nint M[200];\nint last, dp[200];\n\nint rec(int x){\n    if(x >= last) return 0;\n    int & res = dp[x];\n    if(res != -1) return res;\n    res = 1<<29;\n    bool ok = true;\n    for(int i=x; i<=last; i++){\n        if(M[i] < t[(i-x)%T]) ok = false;\n    }\n    if(ok) res = 0;\n    for(int i=x+1; i<=last; i++){\n        res = min(1+rec(i) , res);\n        if(M[i] < t[(i-x)%T]) break;\n    }\n    return res;\n}\n\nint main(){\n    while(cin>>T && T){\n        memset(dp,-1,sizeof(dp));\n        rep(i,200) M[i] = 24;\n        rep(i,T) cin >> t[i];\n        cin >> N;\n        rep(i,N){\n            int x,y;\n            cin >> x >> y;\n            M[x] = min(M[x],y);\n            last = max(last, x);\n        }\n        cout << rec(1) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n\nusing namespace std;\n\nint main()\n{\n\tfor(int T;cin>>T,T;){\n\t\tvector<int> t(T);\n\t\tfor(int i=0;i<T;i++) cin>>t[i];\n\t\tvector<vector<int>> ok(100,vector<int>(T,1));\n\t\tint N; cin>>N;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tint D,M; cin>>D>>M;\n\t\t\tfor(int j=0;j<T;j++)\n\t\t\t\tok[D-1][j]&=M>=t[j];\n\t\t}\n\t\t\n\t\tconst int INFTY=1<<29;\n\t\tvector<vector<int>> dp(100,vector<int>(T,INFTY));\n\t\tdp[0][0]=0;\n\t\tfor(int i=0;i<99;i++){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t\t\t\tif(ok[i+1][(j+1)%T])\n\t\t\t\t\tdp[i+1][(j+1)%T]=min(dp[i+1][(j+1)%T],dp[i][j]);\n\t\t\t}\n\t\t}\n\t\t\n\t\tcout<<*min_element(begin(dp[99]),end(dp[99]))<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#define INF 1e8\n#define MAX_N 110\nusing namespace std;\nint t[MAX_N];\nint start[MAX_N];\nint dp[MAX_N][MAX_N];\nint max_day, T, N;\nint solve(int i, int j)\n{\n    if(i == max_day + 1) return 0;\n    if(dp[i][j] != -1) return dp[i][j];\n    int ret = INF;\n    for(int k = 0; k < T; k++)\n    {\n        if(t[j] <= start[i])\n        {\n\t\t\tret = min(ret, solve(i + 1, (j + 1) % T));\n\t\t}\n\t\tret = min(ret, solve(i + 1, 1) + 1);\n\t}\n\treturn dp[i][j] = ret;\n}\nint main()\n{\n\twhile(cin >> T, T)\n\t{\n\t\tfor(int i = 0; i < T; i++) cin >> t[i];\n\t\tmemset(dp, -1, sizeof(dp));\n\t\tcin >> N;\n\t\tint d, m;\n\t\tfor(int i = 0; i < MAX_N; i++) start[i] = INF;\n\t\tfor(int i = 0; i < N; i++)\n\t\t{\n\t\t\tcin >> d >> m;\n\t\t\td--;\n\t\t\tstart[d] = min(start[d], m);\n\t\t\tmax_day = max(d, max_day);\n\t\t}\n\t\tint ans = solve(0, 0);\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <climits>\n#include <cassert>\nusing namespace std;\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\ntypedef long long ll;\n\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define FOR(i,a,b) for(int i=(a); i<(b); ++i)\n#define REP(i,n) FOR(i,0,n)\n\nconst int INF = INT_MAX/10;\n\nbool ok(int M, int t) {\n    return (t<=M);\n}\n\nint main() {\n\tint T;\n    while(cin >> T, T) {\n    vi ti(T);\n    REP(i, T) {\n        cin >> ti[i];\n\t}\n\n    int N;\n    cin >> N;\n    vvi data(N, vi(2));\n    REP(i, N) {\n        cin >> data[i][0] >> data[i][1];\n\t}\n    sort(ALL(data));\n    int dmax = data[N-1][0];\n    \n    vvi dp(dmax+1, vi(T+1, INF));\n    dp[1][1] = 0;\n\n    int dpos = 0;\n    if(data[0][0] == 1) {\n        dpos++;\n\t}\n\n    FOR(dd, 2, dmax+1) {\n        FOR(tt, 1, T) {\n            dp[dd][1] = min(dp[dd][1], dp[dd-1][tt]+1);\n\t\t}\n        dp[dd][1] = min(dp[dd][1], dp[dd-1][T]);\n\n        FOR(tt, 2, T+1) {\n            if(data[dpos][0] == dd) {\n                if(ok(data[dpos][1], ti[tt-1])) {\n                    dp[dd][tt] = dp[dd-1][tt-1];\n\t\t\t\t} else {\n                    dp[dd][tt] = INF;\n\t\t\t\t}\n                dpos++;\n\t\t\t} else {\n                dp[dd][tt] = dp[dd-1][tt-1];\n\t\t\t}\n\t\t}\n\n        if(dpos == N) {\n            break;\n\t\t}\n\t}\n\n    int ans = INF;\n    REP(t, T+1) {\n        ans = min(ans, dp[dmax][t]);\n\t}\n    cout << ans << endl;\n\n}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <map>\n#include <algorithm>\nusing namespace std;\nint T,N;\nint t[31];\ntypedef pair<int,int> P;\nP p[101];\n\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d\",&T);\n\t\tif(T==0)break;\n\t\tfor(int i=0;i<T;i++){\n\t\t\tscanf(\"%d\",&t[i]);\n\t\t}\n\t\tscanf(\"%d\",&N);\n\t\tfor(int i=0;i<N;i++){\n\t\t\tscanf(\"%d %d\",&p[i].first,&p[i].second);\n\t\t}\n\t\tsort(p,p+N);\n\t\tint cnt=0,prev=-1,cafe=0,turn=0;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tif(i>0 && p[i].first==p[i-1].first && p[i].second==p[i-1].second)continue;\n\t\t\tif(i==0){\n\t\t\t\tint k=(p[i].first-1)*24+p[i].second;\n\t\t\t\twhile(k>=24)k-=24,turn=(turn+1)%T;\n\t\t\t\tif(k<t[turn]){\n\t\t\t\t\tcnt++;\n\t\t\t\t\tturn=0;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tint k=p[i].second;\n\t\t\t\tturn=(turn+(p[i].first-p[i-1].first))%T;\n\t\t\t\t//printf(\"%d %d\\n\",k,t[turn]);\n\t\t\t\tif(k<t[turn]){\n\t\t\t\t\tcnt++;\n\t\t\t\t\tturn=0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",cnt);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\nconst int INF = numeric_limits<int>::max() / 2;\n\nint main()\n{\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tint T;\n\twhile (true)\n\t{\n\t\tcin >> T;\n\t\tif (T == 0)\n\t\t\tbreak;\n\t\tvector<int> t(30);\n\t\tfor (int i = 0; i < T; i++)\n\t\t\tcin >> t[i];\n\t\tint n;\n\t\tcin >> n;\n\t\tvector<int> m(110, 24);\n\t\tfor (int i = 0; i < n; i++)\n\t\t{\n\t\t\tint di, mi;\n\t\t\tcin >> di >> mi;\n\t\t\tm[di] = min(m[di], mi);\n\t\t}\n\t\tVVI dp(110, vector<int>(T, INF));\n\t\tdp[1][0] = 0;\n\t\tfor (int i = 2; i <= 100; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < T; j++)\n\t\t\t{\n\t\t\t\tdp[i][0] = min(dp[i][0], dp[i - 1][j] + 1);\n\t\t\t\tif (m[i] >= t[j])\n\t\t\t\t\tdp[i][j] = min(dp[i][j], dp[i - 1][(j + T - 1) % T]);\n\t\t\t}\n\t\t}\n\t\tint res = INF;\n\t\tfor (int i = 0; i < T; i++)\n\t\t\tres = min(res, dp[100][i]);\n\t\tcout << res << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i, n) for (int i = 0; i < int(n); ++i)\n#define all(c) (c).begin(), (c).end()\n\ntemplate <class T, class U>\ninline bool chmin(T& t, const U& f) { return t > f ? t = f, true : false; }\n\nconst int DMAX = 110, INF = 1 << 12;\n\nint solve(int T, const vector<int>& t, const vector<int>& interview) {\n    vector<int> dp(T, INF); dp[0] = 0;\n    for (const int& M : interview) {\n        vector<int> nxt(T, INF);\n        rep(i, T) {\n            if (i == T - 1) chmin(nxt[0], dp[i]);\n            else {\n                if (M > t[i + 1]) chmin(nxt[i + 1], dp[i]);\n                chmin(nxt[0], dp[i] + 1);\n            }\n        }\n        dp.swap(nxt);\n    }\n    return *min_element(all(dp));\n}\n\nint main() {\n    int T; cin >> T;\n    vector<int> t(T);\n    for (int& e : t) cin >> e;\n    int N; cin >> N;\n    vector<int> interview(DMAX, INF);\n    while (N--) {\n        int D, M; cin >> D >> M;\n        chmin(interview[D], M);\n    }\n    cout << solve(T, t, interview) << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <functional>\n#include <numeric>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <utility>\n#include <sstream>\n#include <complex>\n#include <fstream>\n#include <bitset>\n#include <time.h>\n#include <tuple>\n#include <iomanip>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<ll, ll> P;\ntypedef vector<ll> V;\ntypedef complex<double> Point;\n\n#define PI acos(-1.0)\n#define EPS 1e-10\nconst ll INF = 1e12;\nconst ll MOD = 1e9 + 7;\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define rep(i,N) for(int i=0;i<(N);i++)\n#define ALL(s) (s).begin(),(s).end()\n#define EQ(a,b) (abs((a)-(b))<EPS)\n#define EQV(a,b) ( EQ((a).real(), (b).real()) && EQ((a).imag(), (b).imag()) )\n#define fi first\n#define se second\n#define N_SIZE (1LL << 20)\n#define NIL -1\n\nll sq(ll num) { return num*num; }\nll mod_pow(ll x, ll n) {\n\tif (n == 0)return 1;\n\tif (n == 1)return x%MOD;\n\tll res = sq(mod_pow(x, n / 2));\n\tres %= MOD;\n\tif (n % 2 == 1) {\n\t\tres *= x;\n\t\tres %= MOD;\n\t}\n\treturn res;\n}\nll mod_add(ll a, ll b) { return (a + b) % MOD; }\nll mod_sub(ll a, ll b) { return (a - b + MOD) % MOD; }\nll mod_mul(ll a, ll b) { return a*b % MOD; }\n\nll T;\nll t[100];\nll n;\n\nint main() {\n\twhile (cin >> T&&T) {\n\t\trep(i, T)cin >> t[i];\n\t\tcin >> n;\n\t\tll start[110];\n\t\trep(i, 110)start[i] = INF;\n\t\trep(i, n) {\n\t\t\tll d, m;\n\t\t\tcin >> d >> m;\n\t\t\tstart[d] = min(m, start[d]);\n\t\t}\n\t\tll ans = 0;\n\t\tll now = 0;\n\t\tFOR(i, 1, 110) {\n\t\t\tif (start[i] < t[now % T]) {\n\t\t\t\tans++;\n\t\t\t\tnow = 0;\n\t\t\t}\n\t\t\tnow++;\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cctype>\n#include <complex>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iomanip>\n#include <iostream>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 29;\n\nint main(void){\n    for(int T, res; cin >> T, T;){\n        vi t(T);\n        rep(i, T) cin >> t[i];\n\n        int n; cin >> n;\n        vi m(n, 23);\n        rep(i, n){\n            int D, M; cin >> D >> M;\n            D--;\n            m[D] = min(m[D], M);\n        }\n\n        vvi dp(n, vi(T, inf));\n        dp[0][0] = 0;\n        range(i, 1, n){\n            rep(j, T){\n                if(dp[i - 1][j] == inf) continue;\n\n                dp[i][0] = min(dp[i][0], dp[i - 1][j] + 1);\n\n                int nextT = (j + 1) % T;\n                if(0 <= m[i] - t[nextT]){\n                    dp[i][nextT] = min(dp[i][nextT], dp[i - 1][j]);\n                }\n            }\n        }\n\n        cout << *min_element(all(dp[n - 1])) << endl;\n    }\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef pair<int, int> pii;\n\nint main(int argc, char *argv[]){\n  int T;\n  while(cin >> T, T){\n    int t[T];\n    for (int i = 0; i < T; i++) {\n      cin >> t[i];\n    }\n    int n;\n    cin >> n;\n    vector<pii> d(n);\n    for (int i = 0; i < n; i++) {\n      cin >> d[i].first >> d[i].second;\n    }\n    const int m = 100;\n    int dp[T][m];//cycle, day\n    for (int i = 0; i < T; i++) {\n      for (int j = 0; j < m; j++) {\n        dp[i][j] = 1e9;\n      }\n    }\n \n    dp[0][0] = 0;\n    for (int i = 0; i < T; i++) {\n      int day = 0;\n      for (int j = 0; j < n; j++) {\n        if(d[day].first != j + 1){\n          dp[(i + 1) % T][j + 1] =\n            min(dp[(i + 1) % T][j + 1], dp[i][j]);\n          dp[0][j + 1] = min(dp[0][j + 1], dp[i][j] + 1);\n        }else{\n          if(d[day].second >= t[i] && d[day].second >= t[0]){\n            dp[(i + 1) % T][j + 1] =\n              min(dp[(i + 1) % T][j + 1], dp[i][j]);\n            dp[0][j + 1] = min(dp[0][j + 1], dp[i][j] + 1);\n          }else if(d[day].second >= t[i] && d[day].second < t[0]){\n            dp[(i + 1) % T][j + 1] =\n              min(dp[(i + 1) % T][j + 1], dp[i][j]);\n          }else if(d[day].second < t[i] && d[day].second >= t[0]){\n            dp[0][j + 1] = min(dp[0][j + 1], dp[i][j] + 1);\n          }\n          day++;\n        }\n      }\n    }\n    int ans = 1e9;\n    // for (int i = 0; i < T; i++) {\n    //   for (int j = 0; j <= m; j++) {\n    //     std::cout << dp[i][j] << \" \";\n    //   }\n    //   std::cout << std::endl;\n    // }\n    for (int i = 0; i < T; i++) {\n      ans = min(ans, dp[i][n]);\n    }\n    std::cout << ans << std::endl;\n  }\n  return 0;\n  \n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#pragma warning(disable:4996)\nusing namespace std;\n\nconst int My_Inf=2147483647;\nconst long long int My_LInf=9223372036854775807;\n\nint main() {\n\twhile (1) {\n\t\tint T; cin >> T; if (!T)break;\n\t\tvector<int>sleeps;\n\t\tfor (int i = 0; i < T; ++i) {\n\t\t\tint t; cin >> t;\n\t\t\tsleeps.push_back(t);\n\t\t}\n\t\tint N; cin >> N;\n\t\tvector<int>needtimes(N, 25);\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tint d, m; cin >> d >> m;\n\t\t\td--;\n\t\t\tneedtimes[d] = min(needtimes[d], m);\n\t\t}\n\n\t\tvector<vector<int>>dp(N + 1, vector<int>(T, 999));\n\t\tdp[0][0] = 0;\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tfor (int j = 0; j < T; ++j) {\n\t\t\t\tif (needtimes[i] >= sleeps[j]) {\n\t\t\t\t\tdp[i + 1][(j + 1) % T] = min(dp[i][j], dp[i + 1][(j + 1) % T]);\n\n\t\t\t\t}\n\t\t\t\tdp[i + 1][1 % T] = min(dp[i + 1][1 % T], dp[i][j] + 1);\n\t\t\t}\n\t\t}\n\t\tint ans = 99999999;\n\t\tfor (int i = 0; i < T; ++i) {\n\t\t\tans = min(dp[N][i], ans);\n\t\t}\n\t\tcout << ans << endl;\n\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int INF = 1 << 30;\nint main()\n{\n  int T, t[30], N, interview[101];\n    \n  while(cin >> T, T) {\n    memset(interview, 0, sizeof(interview));\n    \n    for(int i = 0; i < T; i++) {\n      cin >> t[i];\n      t[i] = (1 << t[i]) - 1;\n    }\n    cin >> N;\n    for(int i = 0; i < N; i++) {\n      int D, M;\n      cin >> D >> M;\n      interview[D] |= 1 << M;\n    }\n\n    int dp[31];\n    fill_n(dp, T, INF);\n    dp[T - 2] = 0;\n    for(int i = 0; i < 101; i++) {\n      int reset = dp[T - 1];\n      for(int j = T - 2; j >= 0; j--) {\n        dp[j + 1] = t[j + 1] & interview[i] ? INF : dp[j];\n        reset = min(reset, dp[j] + 1); \n      }\n      dp[0] = reset;\n    }\n    cout << *min_element(dp, dp + T) << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nint main(void) {\n    int t;\n    while (cin>>t && t) {\n        vector<int> s(t);\n        for (int i = 0; i < t; i++) cin >> s[i];\n        int n;\n        cin >> n;\n        vector<int> d(101, 24);\n        for (int i = 0; i < n; i++) {\n            int a, b;\n            cin >> a >> b;\n            a--;\n            d[a] = min(d[a], b);\n        }\n        \n        vector<vector<int> > dp(101, vector<int>(t, 101));\n        dp[0][0] = 0;\n        for (int i = 0; i < 100; i++) {\n            for (int j = 0; j < t; j++) {\n                if (s[j] <= d[i]) dp[i+1][(j+1)%t] = min(dp[i+1][(j+1)%t], dp[i][j]);\n                dp[i+1][1] = min(dp[i+1][1], dp[i][j]+1);\n            }\n        }\n        cout << *min_element(dp[100].begin(), dp[100].end()) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define each(itr,v) for(auto itr:v)\n#define pb(s) push_back(s)\n#define mp(a,b) make_pair(a,b)\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define maxch(x,y) x=max(x,y)\n#define minch(x,y) x=min(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt(x) bitset<32>(x).count()\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> P;\ntypedef pair<P, int> PPI;\ntypedef pair<ll, ll> PL;\ntypedef pair<P, ll> PPL;\n\n#define INF INT_MAX/3\n\n#define MAX_N 1000\n\nint t,ts[33];\nint n;\nint plan[111];\n\nint dp[111][33];\n\nint main(){\n\tcin.sync_with_stdio(false);\n\twhile(1){\n\t\tcin>>t;\n\t\tif(t==0)break;\n\t\trep(i,t)cin>>ts[i];\n\t\tcin>>n;\n\t\trep(i,111)plan[i]=INF;\n\t\trep(i,n){\n\t\t\tint d,m;\n\t\t\tcin>>d>>m;\n\t\t\td--;\n\t\t\tplan[d]=min(plan[d],m);\n\t\t}\n\t\trep(i,111)rep(j,33)dp[i][j]=INF;\n\t\tdp[0][0]=0;\n\t\trep(i,101)rep(j,t){\n\t\t\tif(dp[i][j]==INF)continue;\n\t\t\tif(plan[i]>=ts[j]){\n\t\t\t\tminch(dp[i+1][(j+1)%t],dp[i][j]);\n\t\t\t}\n\t\t\tminch(dp[i+1][1],dp[i][j]+1);\n\t\t}\n\t\tint res=INF;\n\t\trep(i,33)minch(res,dp[101][i]);\n\t\tcout<<res<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int INF = 1 << 30;\nint main()\n{\n  int T, t[30], N, interview[101] = {};\n    \n  while(cin >> T, T) {\n   \n    for(int i = 0; i < T; i++) {\n      cin >> t[i];\n      t[i] = (1 << t[i]) - 1;\n    }\n    cin >> N;\n    for(int i = 0; i < N; i++) {\n      int D, M;\n      cin >> D >> M;\n      interview[D] |= 1 << M;\n    }\n\n    int dp[31];\n    fill_n(dp, T, INF);\n    dp[T - 2] = 0;\n    for(int i = 0; i < 101; i++) {\n      int reset = dp[T - 1];\n      for(int j = T - 2; j >= 0; j--) {\n        dp[j + 1] = t[j + 1] & interview[i] ? INF : dp[j];\n        reset = min(reset, dp[j] + 1); \n      }\n      dp[0] = reset;\n    }\n    cout << *min_element(dp, dp + T) << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#pragma warning(disable:4996)\nusing namespace std;\n\nconst int My_Inf=2147483647;\nconst long long int My_LInf=9223372036854775807;\n\nint main() {\n\twhile (1) {\n\t\tint T; cin >> T; if (!T)break;\n\t\tvector<int>sleeps;\n\t\tfor (int i = 0; i < T; ++i) {\n\t\t\tint t; cin >> t;\n\t\t\tsleeps.push_back(t);\n\t\t}\n\t\tint N; cin >> N;\n\t\tvector<int>needtimes(100, 25);\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tint d, m; cin >> d >> m;\n\t\t\td--;\n\t\t\tneedtimes[d] = min(needtimes[d], m);\n\t\t}\n\n\t\tvector<vector<int>>dp(100 + 1, vector<int>(T, 999));\n\t\tdp[0][0] = 0;\n\t\tfor (int i = 0; i < 100; ++i) {\n\t\t\tfor (int j = 0; j < T; ++j) {\n\t\t\t\tif (needtimes[i] >= sleeps[j]) {\n\t\t\t\t\tdp[i + 1][(j + 1) % T] = min(dp[i][j], dp[i + 1][(j + 1) % T]);\n\n\t\t\t\t}\n\t\t\t\tdp[i + 1][1 % T] = min(dp[i + 1][1 % T], dp[i][j] + 1);\n\t\t\t}\n\t\t}\n\t\tint ans = 99999999;\n\t\tfor (int i = 0; i < T; ++i) {\n\t\t\tans = min(dp[100][i], ans);\n\t\t}\n\t\tcout << ans << endl;\n\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nstatic const int INF = (1<<28);\n\nint T, t[30], N, D, M, dp[101][30], m[100];\n\nmain(){\n  while(cin >> T && T){\n    for(int i=0;i<T;i++) cin >> t[i];\n    cin >> N;\n    fill(m, m+N, INF);\n    for(int i=0;i<N;i++){\n      cin >> D >> M;\n      m[D-1] = min(m[D-1], M);\n    }\n    fill(dp[0], dp[N+1], INF);\n    dp[0][0] = 0;\n    for(int i=0;i<N;i++){\n      for(int j=0;j<T;j++){\n        if(t[j] <= m[i]){\n          dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T], dp[i][j]);\n          dp[i+1][0] = min(dp[i+1][0], dp[i][j]+1);\n        }\n      }\n    }\n    int ans = INF;\n    for(int i=0;i<T;i++) ans = min(ans, dp[N][i]);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint T;\nint t[102];\nint N;\nint D[102],M[102];\nint max_d;\n\nmap<int,int> jobs;\nint dp[102][102];\n\n// a??\\??????b?????????????????????\nint dfs(int a,int b) {\n    //printf(\"%d %d\\n\",a,b);\n    if(a==max_d+1) return 0;\n    if(dp[a][b]!=-1) return dp[a][b];\n\n    int ret=INF;\n    if(t[(b+1)%T]<=jobs[a+1]) ret=min(ret,dfs(a+1,(b+1)%T));\n    ret=min(ret,dfs(a+1,0)+1);\n\n    return dp[a][b]=ret;\n}\n\nvoid solve() {\n    jobs.clear();\n    max_d=0;\n    rep(i,N) {\n        max_d=max(max_d,D[i]);\n    }\n    rep(i,max_d+1) jobs[i]=INF;\n    rep(i,N) {\n        jobs[D[i]]=min(jobs[D[i]],M[i]);\n    }\n    memset(dp,-1,sizeof(dp));\n    cout<<dfs(1,0)<<endl;\n}\n\nint main() {\n    while(cin>>T) {\n        if(!T) break;\n        rep(i,T) cin>>t[i];\n        cin>>N;\n        rep(i,N) cin>>D[i]>>M[i];\n        solve();\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MOD DEKAI\n#define DEKAI (int)(1e9+7)\n#define rep(i,n) lps(i,0,n)\n#define lp(i,n) lps(i,0,n)\n#define lps(i,j,n) for(int i = j; i < n; i++)\nint x[101];\nint n;\nint a[50];\nint Mday;\n\nint check(int day){\n  int j=0;\n  lps(i,day,Mday+1){\n    //cout<<a[j]<<\" \"<<x[i]<<endl;\n    if(a[j]>x[i]) return i;\n    j++;\n    if(j==n) j=0;\n  }\n  return -1;\n}\n\n\nint main(){\n  while(1){\n    cin>>n;\n    if(n==0) break;\n    lp(i,n) cin>>a[i];\n    int q;\n    cin>>q;\n    lp(i,101) x[i]=-1;\n    lp(i,q){\n      int d,m;\n      cin>>d>>m;\n      x[d]=m;\n      Mday=max(Mday,d);\n    }\n    int lastday=1;\n    int ans=0;\n    while(1){\n      int outday=check(lastday);\n      //cout<<\"    \"<<outday<<endl;\n      if(outday==-1) break;\n      ans++;\n      int memo=0;\n      lp(i,n-1){\n\tif(memo>=outday-i+n) break;\n\tint memo2=check(outday-i);\n\tif(memo2==-1){\n\t  memo=-1;\n\t  break;\n\t}\n\tif(memo<memo2) {\n\t  lastday=outday-i;\n\t  memo=memo2;\n\t}\n      }\n      if(memo==-1) break;\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nint main(void) {\n    int t;\n    while (cin>>t && t) {\n        vector<int> s(t);\n        for (int i = 0; i < t; i++) cin >> s[i];\n        int n;\n        cin >> n;\n        vector<int> d(101, 24);\n        for (int i = 0; i < n; i++) {\n            int a, b;\n            cin >> a >> b;\n            a--;\n            d[a] = min(d[a], b);\n        }\n        \n        vector<vector<int> > dp(101, vector<int>(t, 101));\n        dp[0][0] = 0;\n        for (int i = 0; i < 100; i++) {\n            for (int j = 0; j < t; j++) {\n                if (s[j] <= d[i]) {\n                    dp[i+1][(j+1)%t] = min(dp[i+1][(j+1)%t], dp[i][j]);\n                    dp[i+1][1] = min(dp[i+1][1], dp[i][j]+1);\n                }\n                else dp[i+1][1] = min(dp[i+1][1], dp[i][j]+1);\n            }\n        }\n        cout << *min_element(dp[100].begin(), dp[100].end()) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include \"bits/stdc++.h\"\nusing namespace std;\n\n//#define int int64_t\n\n#define CHOOSE(a) CHOOSE2 a\n#define CHOOSE2(a0,a1,a2,a3,x,...) x\n#define REP1(i, s, cond, cal) for (signed i = signed(s); i cond; i cal)\n#define REP2(i, s, n) REP1(i, s, < signed(n), ++)\n#define REP3(i, n) REP2(i, 0, n)\n#define rep(...) CHOOSE((__VA_ARGS__,REP1,REP2,REP3))(__VA_ARGS__)\n#define rrep(i, s) rep(i, s, >= 0, --)\n\n#define all(c) begin(c), end(c)\n#define maxup(ans, x) (ans = (ans < x ? x : ans))\n#define minup(ans, x) (ans = (ans > x ? x : ans))\n\n#define breakif(cond) if(cond) break; else\n\nusing VV = vector<vector<int>>;\nusing V = vector<int>;\nusing P = pair<int, int>;\nusing IP = pair<int, P>;\n\ntemplate<typename T>\ninline void input(vector<T>& v) { for (auto& x : v) cin >> x; }\n\nsigned main() {\n\tint t;\n\twhile (cin >> t && t) {\n\t\tV ts(t);\n\t\trep(i, t) {\n\t\t\tint x; cin >> x;\n\t\t\tts[i] = x;\n\t\t}\n\t\tint n; cin >> n;\n\t\tV ms(101, 1 << 29);\n\t\trep(i, n) {\n\t\t\tint d, m;\n\t\t\tcin >> d >> m;\n\t\t\tms[d - 1] = m;\n\t\t}\n\t\tVV dp(101, V(t, 1 << 29)); //dp[day][t_i]\n\n\t\tdp[0][0] = 0;\n\t\trep(i, 0, 100) rep(j, t) {\n\t\t\tif(ts[j] <= ms[i]) minup(dp[i + 1][(j + 1) % t], dp[i][j]);\n\t\t\telse minup(dp[i + 1][1], dp[i][j] + 1);\n\t\t}\n\t\tint ans = *min_element(all(dp[100]));\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)(n); ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cerr<<*i<<\" \"; cerr<<endl; }\ninline bool valid(int x, int y, int W, int H){ return (x >= 0 && y >= 0 && x < W && y < H); }\n\ntypedef long long ll;\nconst int INF = 100000000;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\nint dx[8] = {1, 0, -1, 0, 1, -1, -1, 1};\nint dy[8] = {0, 1, 0, -1, 1, 1, -1, -1};\n\nint main(){\n  int T;\n  while(cin>>T && T){\n    int t[30];\n    REP(i, T) cin>>t[i];\n    int start[100] = {};\n    fill(start, start + 100, 24);\n    int N;\n    cin>>N;\n    REP(i, N){\n      int D, M;\n      cin>>D>>M;\n      start[D - 1] = M;\n    }\n    int dp[101][30] = {};\n    REP(i, 101)REP(j, 30) dp[i][j] = INF;\n    dp[0][T - 1] = 0;\n    REP(i, 100){\n      REP(from, T){\n        int to = (from + 1) % T;\n        if(t[to] <= start[i]){\n          dp[i + 1][to] = min(dp[i + 1][to], dp[i][from]);\n        }\n        dp[i + 1][0] = min(dp[i + 1][0], dp[i][from] + 1);\n      }\n    }\n    int ans = INF;\n    REP(i, T) ans = min(ans, dp[100][i]);\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#define rep(i,n) for(int i=0;i<n;i++)\nusing namespace std;\n\nint T,N,t[50],d[110],a,b;\nint dp[110][50];\n\nint main(){\n  while(cin >> T,T){\n    rep(i,T)cin >> t[i];\n    cin >> N;\n    rep(i,100)d[i] = 24;\n    rep(i,N){\n      cin >> a >> b;\n      d[a] = min(d[a],b);\n    }\n\n    rep(i,101)rep(j,T)dp[i][j] = 1000000;\n    dp[0][0] = 0;\n\n    rep(i,100){\n      rep(j,T){\n\tif(t[j]<=d[i]){\n\t  int nxt = (j+1)%T;\n\t  dp[i+1][nxt] = min(dp[i+1][nxt],dp[i][j]);\n\t}\n\tdp[i+1][0] = min(dp[i+1][0],dp[i][j]+1);\n      }\n    }\n\n    int ans = 1000000;\n    rep(i,T)ans = min(ans,dp[100][i]);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define MAX_T 30\n#define MAX_N 100\n#define INF 1e9\n\nint N,T,dp[MAX_N+1][MAX_T];\nint arr[MAX_N],t[MAX_T],d;\n\nint solve(int idx,int pos){\n  if(idx == d+1) return 0;\n  if(dp[idx][pos] != -1){\n    return dp[idx][pos];\n  }\n  int res = INF;\n  for(int i = 0 ; i < T ; i++){\n    if(t[pos] <= arr[idx]){\n      res = min(res,solve(idx+1,(pos+1)%T));\n    }\n    res = min(res,solve(idx+1,1)+1);\n  }\n  return dp[idx][pos] = res;\n}\n\nint main(){\n  while(cin >> T, T){\n    for(int i = 0 ; i < MAX_N ; i++){\n      arr[i] = INF;\n    }\n    for(int i = 0 ; i < T ; i++){\n      cin >> t[i];\n    }\n    int D,M;\n    d = 0;\n    cin >> N;\n    for(int i = 0 ; i < N ; i++){\n      cin >> D >> M; D--;\n      d = max(d,D);\n      arr[D] = min(arr[D],M);\n    }\n    memset(dp,-1,sizeof(dp));  \n    cout << solve(0,0) << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\nint n,t,T[30],dp[101][30],a[101];\nmain()\n{\n\twhile(cin>>t,t)\n\t{\n\t\tfor(int i=0;i<t;i++)cin>>T[i];\n\t\tfor(int i=0;i<=100;i++)\n\t\t{\n\t\t\ta[i]=23;\n\t\t\tfor(int j=0;j<t;j++)dp[i][j]=1e9;\n\t\t}\n\t\tcin>>n;\n\t\tfor(;n--;)\n\t\t{\n\t\t\tint d,m;cin>>d>>m;\n\t\t\ta[d-1]=min(a[d-1],m);\n\t\t}\n\t\tdp[0][0]=0;\n\t\tfor(int i=0;i<100;i++)\n\t\t{\n\t\t\tfor(int j=0;j<t;j++)\n\t\t\t{\n\t\t\t\tif(a[i+1]>=T[(j+1)%t])dp[i+1][(j+1)%t]=min(dp[i+1][(j+1)%t],dp[i][j]);\n\t\t\t\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t\t\t}\n\t\t}\n\t\tint ans=1e9;\n\t\tfor(int i=0;i<t;i++)ans=min(ans,dp[100][i]);\n\t\tcout<<ans<<endl;\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef long double ld;\nconst ld eps=1e-8;\nint main() {\n\tint t; \n\twhile (cin >> t, t) {\n\t\tint Cyc[30];\n\t\trep(i, t) {\n\t\t\tcin >> Cyc[i];\n\t\t}\n\t\tint cyc[120];\n\t\trep(i, 4*t) {\n\t\t\tcyc[i] = Cyc[i%t];\n\t\t}\n\t\tint n; cin >> n;\n\t\tint view[100];\n\t\tfill(view, view + 100, 24);\n\t\trep(i, n) {\n\t\t\tint d, m; cin >> d >> m; d--;\n\t\t\tview[d] = m;\n\t\t}\n\t\tint dp[101][101];\n\t\trep(i, 101) {\n\t\t\trep(j, 101) {\n\t\t\t\tdp[i][j] = (int)MOD;\n\t\t\t}\n\t\t}\n\t\tdp[0][0] = 0;\n\t\tRep(i, 1, 100) {\n\t\t\trep(j, i) {\n\t\t\t\tif (dp[j][i - 1] == (int)MOD)continue;\n\t\t\t\tint dif = i - j;\n\t\t\t\tif (cyc[dif] <= view[i]) {\n\t\t\t\t\tdp[j][i] = min(dp[j][i], dp[j][i - 1]);\n\t\t\t\t}\n\t\t\t\tdp[i][i] = min(dp[i][i], dp[j][i - 1] + 1);\n\t\t\t}\n\t\t}\n\t\tint mi = (int)MOD;\n\t\trep(i, 100) {\n\t\t\tmi = min(mi, dp[i][99]);\n\t\t}\n\t\tcout << mi << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\nusing namespace std;\n\n#define MAX_N 1000\n\nint t[MAX_N];\nint cycle[MAX_N];\nint dp[MAX_N][MAX_N];\nint T,N,a,b;\n\nint main(){\n\twhile(true){\n\t\tfor(int i=0;i<MAX_N;i++){\n\t\t\tt[i]=24;\n\t\t\tcycle[i]=0;\n\t\t\tfor(int j=0;j<MAX_N;j++){\n\t\t\t\tdp[i][j]=999999999;\n\t\t\t}\n\t\t}\n\t\tcin>>T;\n\t\tif(T==0){break;}\n\t\tfor(int i=1;i<=T;i++){cin>>cycle[i];}\n\t\tcin>>N;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tcin>>a>>b;\n\t\t\tt[a]=min(t[a],b);\n\t\t}\n\t\tdp[0][0]=0;\n\t\tfor(int i=0;i<MAX_N-1;i++){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tif(dp[i][j]<999999999){\n\t\t\t\t\tif(t[i+1]>=cycle[j+1]){\n\t\t\t\t\t\tdp[i+1][(j+1)%T]=min(dp[i+1][(j+1)%T],dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1]=min(dp[i+1][1],dp[i][j]+1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint minx=999999999;\n\t\tfor(int i=0;i<T;i++){\n\t\t\tminx=min(dp[MAX_N-1][i],minx);\n\t\t}\n\t\tcout<<minx<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nint main(){\n  int T;\n  while(cin >> T, T){\n    vector<int> t(T);\n    for(int i = 0; i < T; ++i){\n      cin >> t[i];\n    }\n    int N;\n    cin >> N;\n    int d, m;\n    vector< pair<int,int> > V;\n    for(int i = 0; i < N; ++i){\n      cin >> d >> m;\n      V.emplace_back(d,m);\n    }\n    sort(V.begin(), V.end());\n    int ans = 0, k = (V[0].first-1)%T;\n    if(V[0].second < t[k]){\n      ++ans;\n      k = 0;\n    }\n    for(int i = 1; i < N; ++i){\n      k += (V[i].first-V[i-1].first)%T;\n      k %= T;\n      if(V[i].second < t[k]){\n        ++ans;\n        k = 0;\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iostream>\n#include <iterator>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\nusing namespace std;\n\n#define lengthof(array) (sizeof(array) / sizeof(*array))\n#define dump(a) (cerr << (#a) << \" = \" << (a) << endl)\n#define FOR(it,c) for(__typeof((c).begin())it=(c).begin(); it!=(c).end();++it)\n#define RFOR(it,c) for(__typeof((c).rbegin())it=(c).rbegin(); it!=(c).rend();++it)\n\ntemplate<class T> inline void chmax(T& a, const T& b) { if(b > a) a = b; }\ntemplate<class T> inline void chmin(T& a, const T& b) { if(b < a) a = b; }\n\ntemplate<typename T, typename U> ostream& operator<<(ostream& os, const pair<T, U>& p) {\n\tos << '(' << p.first << \", \" << p.second << ')';\n\treturn os;\n}\n\ntemplate<typename T> ostream& operator<<(ostream& os, const vector<T>& v) {\n\tcopy(v.begin(), v.end(), ostream_iterator<T>(os, \" \"));\n\treturn os;\n}\n\nint n, c;\nint t[30], d[101], m[101];\nint memo[101][30];\n\nint dfs(int idx = 0, int cycle = d[0] - 1) {\n\tif(idx == n)\n\t\treturn 0;\n\n\tif(memo[idx][cycle] != -1)\n\t\treturn memo[idx][cycle];\n\n\tassert(d[idx + 1] > d[idx]);\n\tint res = dfs(idx + 1, (d[idx + 1] - d[idx]) % c) + 1;\n\tif(t[cycle] <= m[idx])\n\t\tchmin(res, dfs(idx + 1, (cycle + d[idx + 1] - d[idx]) % c));\n\n\treturn memo[idx][cycle] = res;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\twhile(cin >> c, c) {\n\t\tfor(int i = 0; i < c; ++i)\n\t\t\tcin >> t[i];\n\n\t\tcin >> n;\n\t\tfor(int i = 0; i < n; ++i)\n\t\t\tcin >> d[i] >> m[i];\n\n\t\tmemset(memo, -1, sizeof(memo));\n\t\tcout << dfs() << endl;\n\t}\n\n\treturn EXIT_SUCCESS;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i, n) for (int i = 0; i < int(n); ++i)\n#define all(c) (c).begin(), (c).end()\n\ntemplate <class T, class U>\ninline bool chmin(T& t, const U& f) { return t > f ? t = f, true : false; }\n\nconst int DMAX = 110, INF = 1 << 12;\n\nint solve(int T, const vector<int>& t, const vector<int>& interview) {\n    vector<int> dp(T, INF); dp[0] = 0;\n    for (const int& M : interview) {\n        vector<int> nxt(T, INF);\n        rep(i, T) {\n            if (M >= t[i]) chmin(nxt[(i + 1) % T], dp[i]);\n            chmin(nxt[1], dp[i] + 1);\n        }\n        dp.swap(nxt);\n    }\n    return *min_element(all(dp));\n}\n\nint main() {\n    for (int T; cin >> T, T;) {\n        vector<int> t(T);\n        for (int& e : t) cin >> e;\n        int N; cin >> N;\n        vector<int> interview(DMAX, INF);\n        while (N--) {\n            int D, M; cin >> D >> M;\n            chmin(interview[D - 1], M);\n        }\n        cout << solve(T, t, interview) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iostream>\n#include <iterator>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\nusing namespace std;\n\n#define lengthof(array) (sizeof(array) / sizeof(*array))\n#define dump(a) (cerr << (#a) << \" = \" << (a) << endl)\n#define FOR(it,c) for(__typeof((c).begin())it=(c).begin(); it!=(c).end();++it)\n#define RFOR(it,c) for(__typeof((c).rbegin())it=(c).rbegin(); it!=(c).rend();++it)\n\ntemplate<class T> inline void chmax(T& a, const T& b) { if(b > a) a = b; }\ntemplate<class T> inline void chmin(T& a, const T& b) { if(b < a) a = b; }\n\ntemplate<typename T, typename U> ostream& operator<<(ostream& os, const pair<T, U>& p) {\n\tos << '(' << p.first << \", \" << p.second << ')';\n\treturn os;\n}\n\ntemplate<typename T> ostream& operator<<(ostream& os, const vector<T>& v) {\n\tcopy(v.begin(), v.end(), ostream_iterator<T>(os, \" \"));\n\treturn os;\n}\n\nint n, c;\nint t[30], d[101], m[101];\nint memo[101][30];\n\nint dfs(int idx = 0, int cycle = d[0] - 1) {\n\tif(idx == n)\n\t\treturn 0;\n\n\tif(memo[idx][cycle] != -1)\n\t\treturn memo[idx][cycle];\n\n\tint res = dfs(idx + 1, (d[idx + 1] - d[idx]) % c) + 1;\n\tif(t[cycle] <= m[idx])\n\t\tchmin(res, dfs(idx + 1, (cycle + d[idx + 1] - d[idx]) % c));\n\n\treturn memo[idx][cycle] = res;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\twhile(cin >> c, c) {\n\t\tfor(int i = 0; i < c; ++i)\n\t\t\tcin >> t[i];\n\n\t\tcin >> n;\n\t\tfor(int i = 0; i < n; ++i)\n\t\t\tcin >> d[i] >> m[i];\n\n\t\tmemset(memo, -1, sizeof(memo));\n\t\tcout << dfs() << endl;\n\t}\n\n\treturn EXIT_SUCCESS;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nstruct node{\n\tint d,m;\n}data[1001];\nint T,t[101],n,f[101];\nbool cmp(node s1,node s2){\n\tif(s1.d==s2.d) return s1.m<s2.m;\n\treturn s1.d<s2.d;\n}\nint main(){\n\twhile(true){\n\t\tscanf(\"%d\",&T);\n\t\tif(T==0) return 0;\n\t\tfor(int i=1;i<=T;i++) scanf(\"%d\",&t[i]);\n\t\tscanf(\"%d\",&n);\n\t\tfor(int i=1;i<=n;i++)\n\t\t scanf(\"%d%d\",&data[i].d,&data[i].m);\n\t\tsort(data+1,data+1+n,cmp);\n\t\tfor(int i=1;i<=n;i++) f[i]=1e9;\n\t\tf[0]=-1;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tfor(int j=0;j<=i-1;j++){\n\t\t\t bool pd=1;\n\t\t\t for(int k=j+1;k<=i;k++){\n\t\t\t   int x=(data[k].d-data[j+1].d)%T+1;\n\t\t\t   if(t[x]>data[k].m) pd=false;\n\t\t\t  }\n\t\t\t if(pd) f[i]=min(f[j]+1,f[i]);\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",f[n]);\n\t}\n\treturn 0;\n}\n&#171; Back"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\nusing namespace std;\n\nint T;\nint n;\nint ti[101];\nint d[101];\nint dp[101][31];\nint finD;\n\nconst int INF=1000000000;\nint dfs(int pos,int tm){\n\tif(pos==finD+1)return 0;\n\tif(dp[pos][tm]!=-1)return dp[pos][tm];\n\tint res=INF;\n\t// JtFCðùÞ\n\tres=min(res,dfs(pos+1,1%T)+1);\n\t// ÔÉ¤êÍAùÜÈ¢Æ¢¤Iðà è\n\tif(d[pos]==-1||d[pos]>=ti[tm])res=min(res,dfs(pos+1,(tm+1)%T));\n\treturn dp[pos][tm]=res;\n}\n\nint main(){\n\n\twhile(cin>>T&&T){\n\t\tfor(int i=0;i<T;i++)cin>>ti[i];\n\t\tcin>>n;\n\t\tmemset(dp,-1,sizeof(dp));\n\t\tmemset(d,-1,sizeof(d));\n\t\tfinD=0;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tint da,m;\n\t\t\tcin>>da>>m;\n\t\t\tfinD=max(finD,da);\n\t\t\tif(d[da]==-1)d[da]=m;\n\t\t\telse d[da]=min(d[da],m);\n\t\t}\n\t\tint res=dfs(1,0);\n\t\tcout<<res<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n\ntypedef long long ll;\n\n\nint main(){\n  ll t,n;\n  while(cin>>t && t){\n  vector<ll> a(t);\n  for(int i=0;i<t;i++){cin>>a[i];}\n  cin>>n;\n  vector<ll> inter(112,23);\n  for(int i=0;i<n;i++){\n    ll d,t;\n    cin>>d>>t;\n    d--;\n    inter[d]=min(inter[d],t);\n  }\n  ll INF=100000000;\n  vector<ll> dp(112,INF);\n  dp[0]=-1;\n  for(int i=0;i<110;i++){\n    for(int j=0;i+j<110;j++){\n      if(inter[i+j]>=a[j%t]){dp[i+j+1]=min(dp[i+j+1],dp[i]+1);}\n      else{break;}\n    }\n  }\n  cout<<dp[105]<<endl;\n  }\n\n\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<queue>\n#include<complex>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cassert>\n\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define mp make_pair\n#define pb push_back\n#define each(i,c) for(__typeof((c).begin()) i=(c).begin();i!=(c).end();i++)\n#define dbg(x) cerr<<__LINE__<<\": \"<<#x<<\" = \"<<(x)<<endl\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef pair<int,int> pi;\nconst int inf = (int)1e9;\nconst double INF = 1e12, EPS = 1e-9;\n\nint m, n, t[40], s[110];\nint dp[110][40];\n\nint main(){\n\twhile(cin >> m, m){\n\t\trep(i, m) cin >> t[i];\n\t\tcin >> n;\n\t\trep(i, 110) rep(j, m) dp[i][j] = inf;\n\t\trep(i, 110) s[i] = 24;\n\t\trep(i, n){\n\t\t\tint a, b;\n\t\t\tcin >> a >> b;\n\t\t\ts[a - 1] = b;\n\t\t}\n\t\tdp[0][0] = 0;\n\t\trep(i, 105) rep(j, m) if(dp[i][j] < inf){\n\t\t\tif(t[(j + 1) % m] <= s[i + 1])\n\t\t\tdp[i + 1][(j + 1) % m] = min(dp[i + 1][(j + 1) % m], dp[i][j]);\n\t\t\t\n\t\t\tdp[i + 1][0] = min(dp[i + 1][0], dp[i][j] + 1);\n\t\t}\n\t\tint ans = inf;\n\t\trep(i, m) ans = min(ans, dp[105][i]);\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n//00:15\n\nint T,N;\nint cycle[31];\nint day[301];\nint dp[301][31];\nint dfs(int x,int t){\n\tif( x == 300 ) return 0;\n\tif( dp[x][t] != -1 ) return dp[x][t];\n\tint ans = dfs(x+1,1%T) + 1;\n\tif( cycle[t] <= day[x] ){\n\t\tans = min(ans,dfs(x+1,(t+1)%T));\n\t}\n\treturn dp[x][t] = ans;\n}\n\nint main(){\n\twhile( cin >> T && T ){\n\t\tmemset(dp,-1,sizeof(dp));\n\t\tfor(int i = 0 ; i < 301 ; i++) \n\t\t\tday[i] = 1e9;\n\t\tfor(int i = 0 ; i < T ; i++){\n\t\t\tcin >> cycle[i];\n\t\t}\n\t\tcin >> N;\n\t\tfor(int i = 0 ; i < N ; i++){\n\t\t\tint d,m;\n\t\t\tcin >> d >> m;\n\t\t\td--;\n\t\t\tday[d] = min(day[d],m);\n\t\t}\n\t\tcout << dfs(0,0) << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MAX 105\n#define INF (1<<26)\nint T,N;\nint t[MAX],M[MAX];\nint mem[MAX][MAX];\n\nint solve(int x,int y){\n  if(mem[x][y]!=-1)return mem[x][y];\n  if(x==N)return 0;\n  int res=solve(x+1,1)+1;\n  if(t[y]<=M[x])res=min(res,solve(x+1,(y+1)%T));\n  return mem[x][y]=res;\n}\n\nvoid init(){\n  for(int i=0;i<MAX;i++){\n    M[i]=INF;\n    for(int j=0;j<MAX;j++){\n      mem[i][j]=-1;\n    }\n  }\n}\nint main(){\n  while(1){\n    cin>>T;\n    if(T==0)break;\n    init();\n    for(int i=0;i<T;i++)cin>>t[i];\n    cin>>N;\n    for(int i=0;i<N;i++){\n      int a;\n      cin>>a;\n      cin>>M[a-1];\n    }\n    cout<<solve(0,0)<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#define INF 1e9\nusing namespace std;\n\n\nint main() {\n  while(1){\n    int T,cir[31],n;\n    cin >> T;\n    if(!T)break;\n    for(int i=0;i<T;i++) cin>>cir[i];\n    cin>>n;\n    int d,h,job[102]={},dp[102][102]={};\n    for(int i=0;i<102;i++)for(int j=0;j<102;j++)dp[i][j]=job[i]=INF;\n    for(int i=0;i<n;i++)cin>>d>>h,job[d]=h;\n\n    dp[0][0]=0;\n    for(int i=0;i<=100;i++)\n      for(int j=0;j<T;j++){\n\tdp[i+1][1]=min(dp[i+1][1],dp[i][j]+1);\n\tif(cir[j]<=job[i+1])dp[i+1][(j+1)%T]=min(dp[i+1][(j+1)%T],dp[i][j]);\n      }\n\n    int ans=INF;\n    for(int i=0;i<n;i++)ans=min(ans,dp[101][i]);\n    cout <<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define GET_MACRO(_1,_2,_3,_4,_5,_6,_7,_8,NAME,...) NAME\n#define pr(...) cerr<< GET_MACRO(__VA_ARGS__,pr8,pr7,pr6,pr5,pr4,pr3,pr2,pr1)(__VA_ARGS__) <<endl\n#define pr1(a) (#a)<<\"=\"<<(a)<<\" \"\n#define pr2(a,b) pr1(a)<<pr1(b)\n#define pr3(a,b,c) pr1(a)<<pr2(b,c)\n#define pr4(a,b,c,d) pr1(a)<<pr3(b,c,d)\n#define pr5(a,b,c,d,e) pr1(a)<<pr4(b,c,d,e)\n#define pr6(a,b,c,d,e,f) pr1(a)<<pr5(b,c,d,e,f)\n#define pr7(a,b,c,d,e,f,g) pr1(a)<<pr6(b,c,d,e,f,g)\n#define pr8(a,b,c,d,e,f,g,h) pr1(a)<<pr7(b,c,d,e,f,g,h)\n#define prArr(a) {cerr<<(#a)<<\"={\";int i=0;for(auto t:(a))cerr<<(i++?\", \":\"\")<<t;cerr<<\"}\"<<endl;}\nusing namespace std;\nusing Int = long long;\nusing _int = int;\nusing ll = long long;\nusing Double = long double;\nconst Int INF = (1LL<<60)+1e9; // ~ 1.15 * 1e18\nconst Int mod = (1e9)+7;\nconst Double EPS = 1e-8;\nconst Double PI = 6.0 * asin((Double)0.5);\nusing P = pair<Int,Int>;\ntemplate<class T> T Max(T &a,T b){return a=max(a,b);}\ntemplate<class T> T Min(T &a,T b){return a=min(a,b);}\ntemplate<class T1, class T2> ostream& operator<<(ostream& o,pair<T1,T2> p){return o<<\"(\"<<p.first<<\",\"<<p.second<<\")\";}\ntemplate<class T1, class T2, class T3> ostream& operator<<(ostream& o,tuple<T1,T2,T3> t){\n  return o<<\"(\"<<get<0>(t)<<\",\"<<get<1>(t)<<\",\"<<get<2>(t)<<\")\";}\ntemplate<class T1, class T2> istream& operator>>(istream& i,pair<T1,T2> &p){return i>>p.first>>p.second;}\ntemplate<class T> ostream& operator<<(ostream& o,vector<T> a){Int i=0;for(T t:a)o<<(i++?\" \":\"\")<<t;return o;}\ntemplate<class T> istream& operator>>(istream& i,vector<T> &a){for(T &t:a)i>>t;return i;}\n//INSERT ABOVE HERE\n\n\nsigned main(){\n  srand((unsigned)time(NULL));\n  cin.tie(0);\n  ios_base::sync_with_stdio(0);\n  cout << fixed << setprecision(12);\n\n  while(1){\n    Int n;\n    cin>>n;\n    if(n == 0) break;\n    vector<Int> cycle(n);\n    cin>>cycle;\n\n    Int m;\n    cin>>m;\n\n    vector<Int> task(110, INF);\n    for(Int i=0;i<m;i++){\n      Int d, m;\n      cin>>d>>m; d--;\n      Min(task[d], m);\n    }\n\n    vector<vector<Int> > dp(111, vector<Int>(n, INF));\n    dp[0][0] = 0;\n    for(Int i=0;i<110;i++) //day\n      for(Int j=0;j<n;j++){ // cycle\n        if(dp[i][j] == INF) continue;\n        if(cycle[j] > task[i]) continue;\n        Min(dp[i+1][(j+1)%n], dp[i][j]);\n        Min(dp[i+1][0], dp[i][j] + 1);\n      }\n    Int ans = INF;\n    for(Int i=0;i<n;i++) Min(ans, dp[110][i]);\n    cout<<ans<<endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n  int tm,n;\n  while(cin >> tm,tm){\n    int i,j,k;\n    int t[tm];\n    for(i=0;i<tm;i++) cin >> t[i];\n    cin >> n;\n    int d[n+1],m[n+1];\n    for(i=1;i<=n;i++){\n      cin >> d[i] >> m[i];\n    }\n    d[0]=0;m[0]=0;\n    int inf = 1<<20;\n    int dp[150][50];\n    fill(dp[0],dp[50],inf);\n    dp[0][0]=0;\n    for(i=0;i<n;i++){\n      for(j=0;j<tm;j++){\n\tif(dp[i][j]==inf) continue;\n\tif(d[i+1]==1) dp[i+1][0]=0;\n\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t//cout << i<<\":\"<<j<<\":\"<<(j+d[i+1]-d[i])<<\":\"<<t[(j+d[i+1]-d[i])%tm]<<\":\"<<m[i+1]<<endl;\n\t\n\tif(t[(j+d[i+1]-d[i])%tm]<=m[i+1]){\n\t  dp[i+1][(j+d[i+1]-d[i])%tm]=\n\t    min(dp[i+1][(j+d[i+1]-d[i])%tm],dp[i][j]);\n\t}\n\t\n      }\n    }\n    int o=inf;\n    /*\n    for(j=0;j<=n;j++){\n      cout << j << \":\";\n      for(i=0;i<tm;i++) cout << dp[j][i] << (i==tm-1?\"\\n\":\" \");\n    }\n    */\n    for(i=0;i<tm;i++) o=min(o,dp[n][i]);\n    cout << o << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <map>\n#include <algorithm>\n#define INF 100000\nusing namespace std;\nint T,N;\nint t[31];\ntypedef pair<int,int> P;\nP p[101];\nint dp[101][31];\n\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d\",&T);\n\t\tif(T==0)break;\n\t\tfor(int i=0;i<T;i++){\n\t\t\tscanf(\"%d\",&t[i]);\n\t\t}\n\t\tscanf(\"%d\",&N);\n\t\tfor(int i=0;i<N;i++){\n\t\t\tscanf(\"%d %d\",&p[i].first,&p[i].second);\n\t\t}\n\t\tsort(p,p+N);\n\t\tint cnt=0,prev=-1,cafe=0,turn=0;\n\t\tfor(int i=0;i<=N;i++){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tdp[i][j]=INF;\n\t\t\t}\n\t\t}\n\t\tdp[0][0]=0;\n\t\tint res=INF;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tif(dp[i][j]!=INF){\n\t\t\t\t\tint next=j+p[i].first;\n\t\t\t\t\tif(i>0)next-=p[i-1].first;\n\t\t\t\t\telse next-=1;\n\t\t\t\t\tnext%=T;\n\t\t\t\t\tif(p[i].second>=t[next]){\n\t\t\t\t\t\tdp[i+1][next]=min(dp[i+1][next],dp[i][j]);\n\t\t\t\t\t\tif(i+1==N)res=min(res,dp[i+1][next]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t\t\t\t\tif(i+1==N)res=min(res,dp[i+1][0]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",res);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <climits>\n#include <cfloat>\nusing namespace std;\n\nconst int INF = INT_MAX / 2;\n\nint main()\n{\n    for(;;){\n        int cycle;\n        cin >> cycle;\n        if(cycle == 0)\n            return 0;\n\n        vector<int> t(cycle);\n        for(int i=0; i<cycle; ++i)\n            cin >> t[i];\n\n        int n;\n        cin >> n;\n        vector<int> interview(101, 24);\n        for(int i=0; i<n; ++i){\n            int d, m;\n            cin >> d >> m;\n            interview[d] = m;\n        }\n\n        vector<vector<int> > dp(101, vector<int>(cycle, INF));\n        dp[0][cycle-1] = 0;\n        for(int d=1; d<=100; ++d){\n            for(int prev=0; prev<cycle; ++prev){\n                int curr = (prev + 1) % cycle;\n                if(t[curr] <= interview[d])\n                    dp[d][curr] = min(dp[d][curr], dp[d-1][prev]);\n                else\n                    dp[d][0] = min(dp[d][0], dp[d-1][prev] + 1);\n            }\n        }\n\n        cout << *min_element(dp[100].begin(), dp[100].end()) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n//00:15\n\nint T,N;\nint cycle[31];\nint day[301];\nint dp[301][31];\nint dfs(int x,int t){\n\tif( x == 300 ) return 0;\n\tif( dp[x][t] != -1 ) return dp[x][t];\n\tint ans = dfs(x+1,1) + 1;\n\tif( cycle[t] <= day[x] ){\n\t\tans = min(ans,dfs(x+1,(t+1)%T));\n\t}\n\treturn dp[x][t] = ans;\n}\n\nint main(){\n\twhile( cin >> T && T ){\n\t\tmemset(dp,-1,sizeof(dp));\n\t\tfor(int i = 0 ; i < 301 ; i++) \n\t\t\tday[i] = 1e9;\n\t\tfor(int i = 0 ; i < T ; i++){\n\t\t\tcin >> cycle[i];\n\t\t}\n\t\tcin >> N;\n\t\tfor(int i = 0 ; i < N ; i++){\n\t\t\tint d,m;\n\t\t\td--;\n\t\t\tcin >> d >> m;\n\t\t\tday[i] = min(day[i],m);\n\t\t}\n\t\tcout << dfs(0,0) << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\n#define int long long\nusing namespace std;\ntypedef pair<int, int> P;\nconst int INF = 1e9;\n\nint T, N;\nvector<int> t;\nint wktm[110];\nint ed;\n\nint memo[110];\n\nint solve(int idx){\n    if(memo[idx] != -1) return memo[idx];\n    if(idx > ed) return 0;\n    int res = INF;\n    int startDay = idx;\n    rep(i, idx, ed + 1){\n        int nowDay = i;\n        int wake = t[(nowDay - startDay) % T];\n        // cout << idx << \" \" << i << ' ' << nowDay << \" \" << wake << endl;\n        if(wake > wktm[i]) break;\n        int wktmp = solve(i + 1);\n        res = min(res, wktmp);\n    }\n    // cout << idx << ' ' << res + 1 << endl;\n    return memo[idx] = res + 1;\n}\n\nsigned main(){\n    while(cin >> T, T){\n        t.clear();\n        t.resize(T);\n        rep(i, 0, T) cin >> t[i];\n        cin >> N;\n        memset(memo, -1, sizeof(memo));\n        rep(i, 0, 110) wktm[i] = INF;\n        rep(i, 0, N){\n            int a, b;\n            cin >> a >> b;\n            a--;\n            wktm[a] = min(wktm[a], b);\n        }\n        rep(i, 0, 110){\n            if(wktm[i] == INF) continue;\n            ed = i;\n            // cout << \" \" << i << \" \" << wktm[i] << endl;\n        }\n        int ans = solve(0);\n        cout << ans - 1 << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define INF 1e8\n#define s second\n#define f first\nusing namespace std;\nint main(){\n  int t,n;\n  while(cin>>t,t){\n    int cy[t];\n    r(i,t)cin>>cy[i];\n    cin>>n;\n    int d[n];\n    r(i,n)cin>>d[i]>>d[i];\n    pair<int,int>dp[n][24];\n    r(i,n)r(j,24)dp[i][j].f=dp[i][j].s=INF;\n    dp[0][cy[0]].f=dp[0][cy[0]].s=0;\n    r(i,n-1)r(j,24)if(dp[i][j].f!=INF){\n      int c=cy[(dp[i][j].s+1)%t];\n      if(c<=d[i]){if(dp[i+1][c].f>dp[i][j].f){\n          dp[i+1][c]=dp[i][j];\n          dp[i+1][c].s++;\n      }}\n      if(dp[i+1][cy[0]].f>dp[i][j].f+1){\n        dp[i+1][cy[0]].f=dp[i][j].f+1;\n        dp[i+1][cy[0]].s=0;\n      }\n    }\n    int ans=INF;\n    r(i,24)ans=min(ans,dp[n-1][i].f);\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#pragma warning(disable:4996)\nusing namespace std;\n\nconst int My_Inf=2147483647;\nconst long long int My_LInf=9223372036854775807;\n\nint main() {\n\twhile (1) {\n\t\tint T; cin >> T; if (!T)break;\n\t\tvector<int>sleeps;\n\t\tfor (int i = 0; i < T; ++i) {\n\t\t\tint t; cin >> t;\n\t\t\tsleeps.push_back(t);\n\t\t}\n\t\tint N; cin >> N;\n\t\tvector<int>needtimes(100, 25);\n\t\tfor (int i = 0; i < N; ++i) {\n\t\t\tint d, m; cin >> d >> m;\n\t\t\td--;\n\t\t\tneedtimes[d] = min(needtimes[d], m);\n\t\t}\n\n\t\tvector<vector<int>>dp(100 + 1, vector<int>(T, 999));\n\t\tdp[0][0] = 0;\n\t\tfor (int i = 0; i < 100; ++i) {\n\t\t\tfor (int j = 0; j < T; ++j) {\n\t\t\t\tif (needtimes[i] >= sleeps[j]) {\n\t\t\t\t\tdp[i + 1][(j + 1) % T] = min(dp[i][j], dp[i + 1][(j + 1) % T]);\n\n\t\t\t\t}\n\t\t\t\tdp[i + 1][1 % T] = min(dp[i + 1][1 % T], dp[i][j] + 1);\n\t\t\t}\n\t\t}\n\t\tint ans = 99999999;\n\t\tfor (int i = 0; i < T; ++i) {\n\t\t\tans = min(dp[101][i], ans);\n\t\t}\n\t\tcout << ans << endl;\n\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(a) a.begin(), a.end()\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10 fixed<<setprecision(10)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\ntypedef long double ld;\nconst int MOD = 1000000007;\nconst int INF = MOD + 1;\nconst ld EPS = 1e-10;\ntemplate<class T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate<class T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\n/*--------------------template--------------------*/\nvi t, m;\nint T, N, dp[111][33];\n\nint solve(int i, int j) \n{\n\tj %= T;\n\tif (i == N) return 0;\n\tif (dp[i][j] >= 0) return dp[i][j];\n\tint res;\n\tif (t[j] > m[i]) res = solve(i + 1, 1) + 1;\n\telse res = min(solve(i + 1, 1) + 1, solve(i + 1, j + 1));\n\treturn dp[i][j] = res;\n}\n\nint main()\n{\n\twhile (cin >> T, T)\n\t{\n\t\tt.clear(), m.clear();\n\t\tMS(dp, -1);\n\t\tREP(i, T)\n\t\t{\n\t\t\tint a; cin >> a;\n\t\t\ta--;\n\t\t\tt.push_back(a);\n\t\t}\n\t\tcin >> N;\n\t\tm.resize(111, INF);\n\t\tREP(i, N) \n\t\t{\n\t\t\tint a, b; cin >> a >> b;\n\t\t\ta--; b--;\n\t\t\tchmin(m[a], b);\n\t\t}\n\t\tcout << solve(0, 0) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define rep1(i,n) for(int i=1;i<=(int)(n);i++)\n#define all(c) c.begin(),c.end()\n#define pb push_back\n#define fs first\n#define sc second\n#define show(x) cout << #x << \" = \" << x << endl\n#define chmin(x,y) x=min(x,y)\n#define chmax(x,y) x=max(x,y)\nusing namespace std;\nint T,t[30],N,d[100],m[100];\nint dp[101][30];\nint main(){\n\twhile(true){\n\t\tcin>>T;\n\t\tif(T==0) break;\n\t\trep(i,T) cin>>t[i];\n\t\tcin>>N;\n\t\trep1(i,N) cin>>d[i]>>m[i];\n\t\trep1(i,N) d[i]--;\n\t\trep(i,N+1) rep(j,T) dp[i][j]=1e9;\n\t\tdp[0][0]=0;\n\t\trep(i,N) rep(j,T){\n\t\t\tif(t[(j+d[i+1]-d[i])%T]<=m[i+1]) chmin(dp[i+1][(j+d[i+1]-d[i])%T],dp[i][j]);\n\t\t\tchmin(dp[i+1][0],dp[i][j]+1);\n\t\t}\n\t\tint ans=1e9;\n\t\trep(j,T) chmin(ans,dp[N][j]);\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<map>\n#include<algorithm>\nusing namespace std;\n\nint T,N;\nint t[30];\nint dp[101][30];\nint mask[101];\n\nconst int INF = 1e8;\n\nint maxDay;\n\nvoid init(){\n  for(int i = 0 ; i < 101 ; i++){\n    mask[i] = 0;\n    for(int j = 0 ; j < 30 ; j++){\n      dp[i][j] = INF;\n    }\n  }\n  maxDay = 0;\n}\n\nvoid input(){\n  for(int i = 0 ; i < T ; i++){\n    cin >> t[i];\n  }\n  cin >> N;\n  for(int i = 0 ; i < N ; i++){\n    int d,m;\n    cin >> d >> m;\n    maxDay = max(maxDay,d);\n    d--;\n    mask[d] |= (1 << m);\n  }\n}\n\nvoid solve(){\n  init();\n  input();\n\n  dp[0][0] = 0;\n\n  for(int i = 0 ; i < maxDay ; i++){\n    for(int j = 0 ; j < T ; j++){\n      if(dp[i][j] == INF)continue;\n      int bit = ((1 << t[j])-1);\n      if(bit & mask[i])continue;\n      dp[i+1][0] = min(dp[i+1][0],dp[i][j] + 1);\n      dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T],dp[i][j]);\n    }\n  }\n  int res = INF;\n  for(int i = 0 ; i < T ; i++){\n    res = min(res,dp[maxDay][i]);\n  }\n  cout << res << endl;\n}\n\nint main(){\n  while(cin >> T,T){\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<queue>\n#include<complex>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cassert>\n\n#define rep(i,n) for(int i=0;i<(int)n;i++)\n#define all(c) (c).begin(),(c).end()\n#define mp make_pair\n#define pb push_back\n#define each(i,c) for(__typeof((c).begin()) i=(c).begin();i!=(c).end();i++)\n#define dbg(x) cerr<<__LINE__<<\": \"<<#x<<\" = \"<<(x)<<endl\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef pair<int,int> pi;\nconst int inf = (int)1e9;\nconst double INF = 1e12, EPS = 1e-9;\n\nint m, n, t[40], s[110];\nint dp[110][40];\n\nint main(){\n\twhile(cin >> m, m){\n\t\trep(i, m) cin >> t[i];\n\t\tcin >> n;\n\t\trep(i, 110) rep(j, m) dp[i][j] = inf;\n\t\trep(i, 110) s[i] = 24;\n\t\trep(i, n){\n\t\t\tint a, b;\n\t\t\tcin >> a >> b;\n\t\t\ts[a - 1] = min(s[a - 1], b);\n\t\t}\n\t\tdp[0][0] = 0;\n\t\trep(i, 105) rep(j, m) if(dp[i][j] < inf){\n\t\t\tif(t[(j + 1) % m] <= s[i + 1])\n\t\t\tdp[i + 1][(j + 1) % m] = min(dp[i + 1][(j + 1) % m], dp[i][j]);\n\t\t\t\n\t\t\tdp[i + 1][0] = min(dp[i + 1][0], dp[i][j] + 1);\n\t\t}\n\t\tint ans = inf;\n\t\trep(i, m) ans = min(ans, dp[105][i]);\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define mp make_pair\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef pair<int,pii> pip;\ntypedef vector<pip>vip;\nconst double PI=acos(-1);\nconst double EPS=1e-8;\nconst int inf=1e8;\nint main(){\n\tint n;\n\twhile(cin>>n,n){\n\t\tvi t(n);\n\t\trep(i,n)cin>>t[i];\n\t\tint m;\n\t\tcin>>m;\n\t\tvi in(110);\n\t\twhile(m--){\n\t\t\tint a,b;\n\t\t\tcin>>a>>b;a--;\n\t\t\tin[a]=max(in[a],b);\n\t\t}\n\t\tvvi dp(110,vi(n,inf));\n\t\tdp[0][0]=0;\n\t\trep(i,109)for(int j=n-1;j>=0;j--)if(dp[i][j]!=inf){\n\t\t\tdp[i][0]=min(dp[i][0],dp[i][j]+1);\n\t\t\tif(in[i]==0||t[j]<=in[i])\n\t\t\t\tdp[i+1][(j+1)%n]=min(dp[i+1][(j+1)%n],dp[i][j]);\n\t\t}\n\t\tint mi=inf;\n\t\trep(i,n)mi=min(mi,dp[109][i]);\n\t\tcout<<mi<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing PII = pair<ll, ll>;\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\ntemplate<typename T> void chmin(T &a, const T &b) { a = min(a, b); }\ntemplate<typename T> void chmax(T &a, const T &b) { a = max(a, b); }\nstruct FastIO {FastIO() { cin.tie(0); ios::sync_with_stdio(0); }}fastiofastio;\n#ifdef DEBUG_ \n#include \"../program_contest_library/memo/dump.hpp\"\n#else\n#define dump(...)\n#endif\nconst ll INF = 1LL<<60;\n\nvoid solve() {\n    ll m;\n    cin >> m;\n    if(!m) exit(0);\n    vector<ll> t(m);\n    REP(i, m) cin >> t[i];\n    ll n;\n    cin >> n;\n    vector<ll> a(n), b(n);\n    REP(i, n) cin >> a[i] >> b[i], a[i]--;\n\n    vector<ll> x(100, 24);\n    REP(i, n) chmin(x[a[i]], b[i]);\n    dump(t);\n    dump(x);\n\n    vector<vector<ll>> dp(101, vector<ll>(m, INF));\n    dp[0][0] = 0;\n    REP(i, 100) REP(j, m) {\n        if(t[j] <= x[i]) chmin(dp[i+1][(j+1)%m], dp[i][j]);\n        chmin(dp[i+1][1%m], dp[i][j]+1);\n    }\n\n    ll ret = INF;\n    REP(i, m) chmin(ret, dp[100][i]);\n    cout << ret << endl;\n}\n\nint main(void) {\n    while(1) solve();\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef long double ld;\nconst ld eps=1e-8;\nint main() {\n\tint t; \n\twhile (cin >> t, t) {\n\t\tint Cyc[30];\n\t\trep(i, t) {\n\t\t\tcin >> Cyc[i];\n\t\t}\n\t\tint cyc[120];\n\t\trep(i, 4*t) {\n\t\t\tcyc[i] = Cyc[i%t];\n\t\t}\n\t\tint n; cin >> n;\n\t\tint view[100];\n\t\tfill(view, view + 100, 24);\n\t\trep(i, n) {\n\t\t\tint d, m; cin >> d >> m; d--;\n\t\t\tview[d] = m;\n\t\t}\n\t\t//最終リセット地点がfirst日目でいまsecond日目\n\t\tint dp[101][101];\n\t\trep(i, 101) {\n\t\t\trep(j, 101) {\n\t\t\t\tdp[i][j] = (int)MOD;\n\t\t\t}\n\t\t}\n\t\tdp[0][0] = 0;\n\t\tRep(i, 1, 101) {\n\t\t\trep(j, i) {\n\t\t\t\tif (dp[j][i - 1] == (int)MOD)continue;\n\t\t\t\tint dif = i - j;\n\t\t\t\tif (cyc[dif] <= view[i]) {\n\t\t\t\t\tdp[j][i] = min(dp[j][i], dp[j][i - 1]);\n\t\t\t\t}\n\t\t\t\tdp[i][i] = min(dp[i][i], dp[j][i - 1] + 1);\n\t\t\t}\n\t\t}\n\t\tint mi = (int)MOD;\n\t\trep(i, 101) {\n\t\t\tmi = min(mi, dp[i][100]);\n\t\t}\n\t\tcout << mi << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <sstream>\n#include <cstring>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n#include <numeric>\n#include <cctype>\n#include <cassert>\n\n// BEGIN CUT HERE\n#ifdef _MSC_VER\n#include <agents.h>\n#endif\n// END CUT HERE \n\n#define FOR(i, a, b) for(int i = (a); i < (int)(b); ++i)\n#define rep(i, n) FOR(i, 0, n)\n#define ALL(v) v.begin(), v.end()\n#define REV(v) v.rbegin(), v.rend()\n#define MEMSET(v, s) memset(v, s, sizeof(v))\n#define MP make_pair\n#define MT make_tuple\n#define X first\n#define Y second\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> P;\n\nconst int N = 110;\nconst int INF = 1e9;\nint G[N][N];\n\nint main(){\n\tint n;\n\twhile (cin >> n, n){\n\t\tvector<int> v(n);\n\t\trep(i, n) cin >> v[i];\n\t\trep(i, N) v.push_back(v[i]);\n\t\trep(i, N) rep(j, N) if (i < j) G[i][j] = INF;\n\t\tint t;\n\t\tcin >> t;\n\t\tvector<int> m(N, 23);\n\t\trep(i, t){\n\t\t\tint d, x;\n\t\t\tcin >> d >> x;\n\t\t\tm[d - 1] = min(m[d - 1], x);\n\t\t}\n\t\trep(i, N){\n\t\t\tint x = i, j = 0;\n\t\t\twhile (x < N && v[j++] <= m[x++]);\n\t\t\tG[i][x-1] = 1;\n\t\t}\n\t\trep(i, N) rep(j, N) rep(k, N) G[j][k] = min(G[j][k], G[j][i] + G[i][k]);\n\t\tcout << G[0][N - 1] - 1 << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <map>\n#include <queue>\n#include <cstdio>\n#include <ctime>\n#include <assert.h>\n#include <chrono>\n#include <random>\n#include <numeric>\n#include <set>\n#include <deque>\n#include <stack>\n#include <bitset>\nusing namespace std;\ntypedef long long int ll;\ntypedef unsigned long long ull;\n\nmt19937_64 rng(chrono::steady_clock::now().time_since_epoch().count());\nll myRand(ll B) {\n\treturn (ull)rng() % B;\n}\n\nint main(){\n    cin.tie(nullptr);\n    ios::sync_with_stdio(false);\n    int m;\n    while(cin >> m,m){\n        vector<int> t(m);\n        for(int i=0;i<m;i++){\n            cin >> t[i];\n        }\n        int n; cin >> n;\n        vector<int> a(n),b(n);\n        for(int i=0;i<n;i++){\n            cin >> a[i] >> b[i];\n            a[i]--;\n        }\n        int res=1e9;\n        vector<int> x(100,24);\n        for(int i=0;i<n;i++){\n            x[a[i]]=min(x[a[i]],b[i]);\n        }\n        vector<vector<int>> dp(101,vector<int>(m,1e9));\n        dp[0][0]=0;\n        for(int i=0;i<100;i++){\n            for(int j=0;j<m;j++){\n                if(t[j]<=x[i]){\n                    dp[i+1][(j+1)%m]=min(dp[i+1][(j+1)%m],dp[i][j]);\n                }\n                dp[i+1][1%m]=min(dp[i+1][1%m],dp[i][j]+1);\n            }\n        }\n        for(int i=0;i<m;i++){\n            res=min(res,dp[100][i]);\n        }\n        printf(\"%d\\n\",res);\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nint dp[31][105],cycle[31];\nint interview[105];\n\nint main() {\n    int t,n,d,m;\n    while(cin>>t, t) {\n        for(int i=0; i<t; ++i) cin>>cycle[i];\n        cin>>n;\n        for(int i=0; i<105; ++i) interview[i] = 24;\n        for(int i=0; i<n; ++i) {\n            cin>>d>>m;\n            interview[d] = min(interview[d], m);\n        }\n        for(int i=0; i<31; ++i) for(int j=0; j<105; ++j) dp[i][j] = 1<<29;\n        dp[0][1] = 0;\n\n        //cout<<\"end init\"<<endl;\n\n        for(int i=1; i<104; ++i) {\n            for(int j=0; j<t; ++j) {\n                dp[0][i+1] = min(dp[0][i+1], dp[j][i]+1);\n                if(j+1 == t) dp[0][i+1] = min(dp[0][i+1], dp[j][i]);\n                if(j+1 < t && interview[i+1] >= cycle[j+1]) {\n                    dp[j+1][i+1] = min(dp[j+1][i+1], dp[j][i]);\n                }\n            }\n            // cout<<i<<endl;\n            // for(int j=0; j<t; ++j) cout<<dp[j][i]<<\" \";\n            // cout<<endl;\n        }\n\n        int ans = 1<<29;\n        for(int j=0; j<t; ++j) ans = min(ans, dp[j][104]);\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n\nusing namespace std;\n\nstruct before_main{before_main(){cin.tie(0); ios::sync_with_stdio(false);}} before_main;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntemplate<class T, class U, class Compare>\nvoid pair_sort(vector<T>& a, vector<U>& b, Compare comp) {\n  vector<pair<T, U>> v;\n  rep(i, a.size()) v.emplace_back(a[i], b[i]);\n  sort(v.begin(), v.end(), comp);\n  rep(i, a.size()) tie(a[i], b[i]) = v[i];\n}\ntemplate<class T, class U>\nvoid pair_sort(vector<T>& a, vector<U>& b) {\n  pair_sort(a, b, std::less<pair<T, U>>());\n}\n\ntypedef long long ll;\nint const inf = 1<<29;\n\nint T, N;\nvector<int> t;\nvector<int> M;\n\nint solve() {\n\n  static int dp[2][33]; rep(i, 2) rep(j, 33) dp[i][j] = inf;\n  dp[0][0] = 0;\n\n  rep(i, N) {\n    rep(j, 33) dp[(i+1)&1][j] = inf;\n    rep(j, T) {\n      if(t[j] <= M[i] || M[i] == 0) {\n        minimize(dp[(i+1)&1][(j+1)%T], dp[i&1][j]);\n      }\n      else {\n        minimize(dp[(i+1)&1][0], dp[i&1][j] + 1);\n      }\n    }\n  }\n\n  return *min_element(dp[N&1], dp[N&1] + 33);\n}\n\nint main() {\n\n  for(; cin >> T && T;) {\n    t.clear();\n    t.resize(T);\n    rep(i, T) cin >> t[i];\n    cin >> N;\n    M.clear();\n    M.resize(N, inf);\n    rep(i, N) {\n      int d, m; cin >> d >> m; d --;\n      minimize(M[d], m);\n    }\n    cout << solve() + 1 << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include \"bits/stdc++.h\"\nusing namespace std;\n\n//#define int int64_t\n\n#define CHOOSE(a) CHOOSE2 a\n#define CHOOSE2(a0,a1,a2,a3,x,...) x\n#define REP1(i, s, cond, cal) for (signed i = signed(s); i cond; i cal)\n#define REP2(i, s, n) REP1(i, s, < signed(n), ++)\n#define REP3(i, n) REP2(i, 0, n)\n#define rep(...) CHOOSE((__VA_ARGS__,REP1,REP2,REP3))(__VA_ARGS__)\n#define rrep(i, s) rep(i, s, >= 0, --)\n\n#define all(c) begin(c), end(c)\n#define maxup(ans, x) (ans = (ans < x ? x : ans))\n#define minup(ans, x) (ans = (ans > x ? x : ans))\n\n#define breakif(cond) if(cond) break; else\n\nusing VV = vector<vector<int>>;\nusing V = vector<int>;\nusing P = pair<int, int>;\nusing IP = pair<int, P>;\n\ntemplate<typename T>\ninline void input(vector<T>& v) { for (auto& x : v) cin >> x; }\n\nsigned main() {\n\tint t;\n\twhile (cin >> t && t) {\n\t\tV ts(t);\n\t\trep(i, t) {\n\t\t\tint x; cin >> x;\n\t\t\tts[i] = x;\n\t\t}\n\t\tint n; cin >> n;\n\t\tV ms(101, 1 << 29);\n\t\trep(i, n) {\n\t\t\tint d, m;\n\t\t\tcin >> d >> m;\n\t\t\tms[d - 1] = m;\n\t\t}\n\t\tVV dp(101, V(t, 1 << 29)); //dp[day][t_i]\n\n\t\tdp[0][0] = 0;\n\t\trep(i, 0, 100) rep(j, t) {\n\t\t\tminup(dp[i + 1][0], dp[i][j] + 1);\n\t\t\tif(ts[j] <= ms[i]) minup(dp[i + 1][(j + 1) % t], dp[i][j]);\n\t\t}\n\t\tint ans = *min_element(all(dp[100]));\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n\nusing namespace std;\n\nint main()\n{\n\tfor(int T;cin>>T,T;){\n\t\tvector<int> t(T);\n\t\tfor(int i=0;i<T;i++) cin>>t[i];\n\t\tvector<vector<int>> ok(100,vector<int>(T,1));\n\t\tint N; cin>>N;\n\t\tfor(int i=0;i<N;i++){\n\t\t\tint D,M; cin>>D>>M;\n\t\t\tfor(int j=0;j<T;j++)\n\t\t\t\tok[D-1][j]&=M>=t[j];\n\t\t}\n\t\t\n\t\tconst int INFTY=1<<29;\n\t\tvector<vector<int>> dp(100,vector<int>(T,INFTY));\n\t\tdp[0][0]=0;\n\t\tfor(int i=0;i<99;i++){\n\t\t\tfor(int j=0;j<T;j++){\n\t\t\t\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t\t\t\tif(ok[i+1][(j+1)%T])\n\t\t\t\t\tdp[i+1][(j+1)%T]=min(dp[i+1][(j+1)%T],dp[i][j]);\n\t\t\t}\n\t\t}\n\t\t\n\t\tcout<<*min_element(begin(dp[99]),end(dp[99]))<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef pair<int,int> pii;\n#define all(c) (c).begin(), (c).end()\n#define loop(i,a,b) for(ll i=a; i<ll(b); i++)\n#define rep(i,b) loop(i,0,b)\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define mt make_tuple\n#define lb lower_bound\n#define ub upper_bound\n#ifdef DEBUG\n#define dump(...) (cerr<<#__VA_ARGS__<<\" = \"<<(DUMP(),__VA_ARGS__).str()<<\" [\"<<__LINE__<<\"]\"<<endl)\nstruct DUMP:ostringstream{template<class T>DUMP &operator,(const T&t){if(this->tellp())*this<<\", \";*this<<t;return *this;}};\n#else\n#define dump(...)\n#endif\ntemplate<class T> ostream& operator<<(ostream& os, vector<T> const& v){\n    rep(i,v.size()) os << v[i] << (i+1==v.size()?\"\":\" \");\n    return os;\n}\n\nint T, t[40];\nint N;\nint M[200];\nint last, dp[200];\n\n// x日目以降の最小\nint rec(int x){\n    if(x >= last) return 0;\n    int & res = dp[x];\n    if(res != -1) return res;\n    int ans = 1<<29;\n    bool ok = true;\n    for(int i=x; i<=last; i++){\n        if(M[i] < t[(i-x)%T]){\n            ok = false;\n            break;\n        }\n    }\n    if(ok) return 0;\n    for(int i=x+1; i<=last; i++){\n        ans = min(1+rec(i) , ans);\n        if(M[i] < t[(i-x)%T]) break;\n    }\n    return res = ans;\n}\n\nint main(){\n#ifdef LOCAL\n    freopen(\"in\",\"r\",stdin);\n#endif\n    while(cin>>T && T){\n        memset(dp,-1,sizeof(dp));\n        rep(i,200) M[i] = 24;\n        rep(i,T) cin >> t[i];\n        cin >> N;\n        rep(i,N){\n            int x,y;\n            cin >> x >> y;\n            M[x] = min(M[x],y);\n            last = max(last, x);\n        }\n        cout << rec(1) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nconst int inf = 1e9;\n\nint main(){\n\twhile(1){\n\t\tint t;\n\t\tcin >> t;\n\t\tif(t==0) break;\n\t\t\n\t\tvector<int> dur(t);\n\t\tfor(int i=0; i<t; i++){\n\t\t\tcin >> dur[i];\n\t\t}\n\t\tint n;\n\t\tcin >> n;\n\t\tvector<int> sch(101, 24);\n\t\tint last;\n\t\tfor(int i=0; i<n; i++){\n\t\t\tint d,m;\n\t\t\tcin >> d >> m;\n\t\t\tsch[d] = min(sch[d], m);\n\t\t\tif(i==n-1) last=d;\n\t\t}\n\t\t\n\t\tvector<vector<int> > dp(last+1, vector<int>(t, inf));\n\t\tdp[1][0] = 0;\n\t\tfor(int i=1; i<last; i++){\n\t\t\tfor(int j=0; j<t; j++){\n\t\t\t\tif(dp[i][j]==inf) continue;\n\t\t\t\tif(sch[i+1] > dur[(j+1)%t]){\n\t\t\t\t\tdp[i+1][(j+1)%t] = min(dp[i][j], dp[i+1][(j+1)%t]);\n\t\t\t\t}else{\n\t\t\t\t\tdp[i+1][0] = min(dp[i+1][0], dp[i][j]+1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tint ans=inf;\n\t\tfor(int i=0; i<t; i++){\n\t\t\tans = min(ans, dp[last][i]);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//03\n#include<iostream>\n#include<algorithm>\n\nusing namespace std;\n\nint nt;\nint t[30];\nint m[101];\n\nint gd(int d){\n  for(int i=0;i+d<=100;i++){\n    if(t[i%nt]>m[d+i])return d+i;\n  }\n  return 999;\n}\n\nint main(){\n  while(cin>>nt,nt){\n    for(int i=0;i<nt;i++){\n      cin>>t[i];\n    }\n    fill(m,m+101,24);\n    int n;\n    cin>>n;\n    while(n--){\n      int d,mm;\n      cin>>d>>mm;\n      m[d]=min(m[d],mm);\n    }\n    int cd=1;\n    int nc=0;\n    for(;;){\n      int dl=gd(cd);\n      if(dl==999)break;\n      int ml=0,x;\n      for(int i=1;i+cd<=dl;i++){\n\tint id=gd(i+cd);\n\tif(id>ml){\n\t  ml=id;\n\t  x=i+cd;\n\t}\n      }\n      cd=x;\n      nc++;\n    }\n    cout<<nc<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint T;\nint t[102];\nint N;\nint D[102],M[102];\nint max_d;\n\nmap<int,int> jobs;\nint dp[102][102];\n\n// a??\\??????b?????????????????????\nint dfs(int a,int b) {\n    //printf(\"%d %d\\n\",a,b);\n    if(a==max_d+1) return 0;\n    if(dp[a][b]!=-1) return dp[a][b];\n\n    int ret=INF;\n    if(t[(b+1)%T]<=jobs[a+1]) ret=min(ret,dfs(a+1,(b+1)%T));\n    ret=min(ret,dfs(a+1,0)+1);\n\n    return dp[a][b]=ret;\n}\n\nvoid solve() {\n    jobs.clear();\n    max_d=0;\n    rep(i,N) {\n        max_d=max(max_d,D[i]);\n    }\n    rep(i,max_d+1) jobs[i]=INF;\n    rep(i,N) {\n        jobs[D[i]]=min(jobs[D[i]],M[i]);\n    }\n    memset(dp,-1,sizeof(dp));\n    cout<<dfs(1,0)-1<<endl;\n}\n\nint main() {\n    while(cin>>T) {\n        if(!T) break;\n        rep(i,T) cin>>t[i];\n        cin>>N;\n        rep(i,N) cin>>D[i]>>M[i];\n        solve();\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\n#include<complex>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define per(i,n) for(int i=n-1;i>=0;i--)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\n#define Rep1(i,sta,n) for(int i=sta;i<=n;i++)\ntypedef long double ld;\nconst ld eps=1e-8;\nint main() {\n\tint t; \n\twhile (cin >> t, t) {\n\t\tint Cyc[30];\n\t\trep(i, t) {\n\t\t\tcin >> Cyc[i];\n\t\t}\n\t\tint cyc[120];\n\t\trep(i, 4*t) {\n\t\t\tcyc[i] = Cyc[i%t];\n\t\t}\n\t\tint n; cin >> n;\n\t\tint view[100];\n\t\tfill(view, view + 100, 24);\n\t\trep(i, n) {\n\t\t\tint d, m; cin >> d >> m; d--;\n\t\t\tview[d] = m;\n\t\t}\n\t\tint dp[101][101];\n\t\trep(i, 101) {\n\t\t\trep(j, 101) {\n\t\t\t\tdp[i][j] = (int)MOD;\n\t\t\t}\n\t\t}\n\t\tdp[0][0] = 0;\n\t\tRep(i, 1, 100) {\n\t\t\trep(j, i) {\n\t\t\t\tif (dp[j][i - 1] == (int)MOD)continue;\n\t\t\t\tint dif = i - j;\n\t\t\t\tif (cyc[dif] <= view[i]) {\n\t\t\t\t\tdp[j][i] = min(dp[j][i], dp[j][i - 1]);\n\t\t\t\t}\n\t\t\t\tdp[i][i] = min(dp[i][i], dp[j][i - 1] + 1);\n\t\t\t}\n\t\t}\n\t\tint mi = (int)MOD;\n\t\trep(i, 100) {\n\t\t\tmi = min(mi, dp[i][99]);\n\t\t}\n\t\tcout << mi << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <sstream>\n#include <tuple>\n#include <queue>\n#include <set>\n#include <cstdio>\n#include <climits>\n#include <cmath>\n#include <array>\n#include <functional>\n#include <list>\n#include <iomanip>\n#include <set>\nconst int MOD=1000000007;\nconst int INF=1000000000;\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\nconst double eps=1e-9;\nconst int inf=1e9;\ntypedef pair<int,int> P;\ntypedef pair<int,pair<int,int> >PP;\n#define fi first\n#define se second\n#define mp make_pair\n#define pb push_back\nint T,t[35],N,M[105];\nint dp[105][35];\nint mxday;\nint solve(int day,int cycle)\n{\n  if(day==mxday+1) return 0;\n  if(dp[day][cycle]!=-1) return dp[day][cycle];\n  int res=inf;\n  for(int i=0;i<T;i++)\n    {\n      if(t[cycle]<=M[day])\n\t{\n\t  res=min(res,solve(day+1,(cycle+1)%T));\n\t}\n      res=min(res,solve(day+1,1)+1);\n    }\n  return dp[day][cycle]=res;\n}\n\nint main(int argc,char const* argv[])\n{\n  while(cin >> T && T)\n    {\n      for(int i=0;i<105;i++)\n\t{\n\t  M[i]=inf;\n\t}\n      memset(dp,-1,sizeof(dp));\n      for(int i=0;i<T;i++)\n\t{\n\t  cin >> t[i];\n\t}\n      cin >> N;\n      mxday=0;\n      for(int i=0;i<N;i++)\n\t{\n\t  int day,time;\n\t  cin >> day >> time;\n\t  day--;\n\t  mxday=max(day,mxday);\n\t  M[day]=min(M[day],time);\n\t}\n      cout << solve(0,0) << endl;\n    }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define rep(i, n) for (int i = 0; i < int(n); ++i)\n\nint main() {\n  while (true) {\n    int t;\n    cin >> t;\n    if (t == 0) break;\n    int k[t];\n    rep (i, t) cin >> k[i];\n    int n;\n    cin >> n;\n    pair<int, int> d[n + 1];\n    d[0] = make_pair(0, 0);\n    rep (i, n) cin >> d[i + 1].first >> d[i + 1].second;\n    sort(d, d + n + 1);\n    int dp[n + 1][t];\n    rep (i, n + 1) rep (j, t) dp[i][j] = 1e9;\n    dp[0][0] = 0;\n    rep (i, n) rep (j, t) {\n      int kk = j + d[i + 1].first - d[i].first;\n      kk %= t;\n      if (k[kk] <= d[i].second) dp[i + 1][kk] = min(dp[i + 1][kk], dp[i][j]);\n      dp[i + 1][0] = min(dp[i + 1][0], dp[i][j] + 1);\n    }\n    int res = 1e9;\n    rep (i, t) res = min(res, dp[n - 1][i]);\n    cout << res << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#define INF 1e8\n#define MAX_N 110\nusing namespace std;\nint t[MAX_N];\nint start[MAX_N];\nint dp[MAX_N][MAX_N];\nint max_day, T, N;\nint solve(int i, int j)\n{\n    if(i == max_day + 1) return 0;\n    if(dp[i][j] != -1) return dp[i][j];\n    int ret = INF;\n    for(int k = 0; k < T; k++)\n    {\n        if(t[j] <= start[i])\n        {\n            ret = min(ret, solve(i + 1, (j + 1) % T));\n        }\n        ret = min(ret, solve(i + 1, 1) + 1);\n    }\n    return dp[i][j] = ret;\n}\nint main()\n{\n    while(cin >> T, T)\n    {\n        for(int i = 0; i < T; i++) cin >> t[i];\n        memset(dp, -1, sizeof(dp));\n        cin >> N;\n        int d, m;\n        for(int i = 0; i < MAX_N; i++) start[i] = INF;\n        for(int i = 0; i < N; i++)\n        {\n            cin >> d >> m;\n            d--;\n            start[d] = min(start[d], m);\n            max_day = max(d, max_day);\n        }\n        int ans = solve(0, 0);\n        cout << ans << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nint main()\n{\n\tint T,N;\n\twhile(scanf(\"%d\", &T), T)\n\t{\n\t\tint cycle[30];\n\t\t\n\t\tfor(int i=0; i<T; i++)\n\t\t\tscanf(\"%d\", &cycle[i]);\n\t\n\t\tint day[101], maxd=0;\n\t\tfor(int i=0; i<101; i++)\n\t\t\tday[i]=999;\n\t\t\n\t\tscanf(\"%d\", &N);\n\t\t\n\t\tfor(int i=0; i<N; i++)\n\t\t{\n\t\t\tint d,m;\n\t\t\tscanf(\"%d%d\", &d,&m);\n\t\t\tday[d]=min(day[d], m);\n\t\t\tmaxd=max(d, maxd);\n\t\t}\n\t\t\n\t\tint ps[30];\n\t\t\n\t\tfor(int i=0; i<T; i++) ps[i]=99;\n\t\tps[0]=0;\n\t\t\n\t\tfor(int i=1; i<=maxd; i++)\n\t\t{\n\t\t\tint t[30];\n\t\t\tfor(int j=0; j<T; j++) t[j]=99;\n\t\t\t\n\t\t\tfor(int j=0; j<T; j++)\n\t\t\t{\n\t\t\t\tif(j+1>i) continue;\n\t\t\t\tif(j!=T-1) t[0]=min(t[0], ps[j]+1);\n\t\t\t\t\n\t\t\t\tif(cycle[j]>day[i]) continue;\n\t\t\t\t\t\n\t\t\t\tt[(j+1)%T]=min(ps[j], t[(j+1)%T]);\n\t\t\t}\n\t\t\t\n\t\t\tfor(int j=0; j<T; j++) \n\t\t\t\tps[j]=t[j];\n\t\t}\n\t\t\n\t\tint ans=99;\n\t\tfor(int i=0; i<T; i++)\n\t\t\tans=min(ans, ps[i]);\n\t\t\t\n\t\tprintf(\"%d\\n\", ans);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <map>\n#include <set>\n#include <list>\n#include <cmath>\n#include <queue>\n#include <stack>\n#include <cstdio>\n#include <string>\n#include <vector>\n#include <complex>\n#include <cstdlib>\n#include <cstring>\n#include <numeric>\n#include <sstream>\n#include <algorithm>\n#include <functional>\n#include <limits.h>\n#include <bitset>\n\n#include <tuple>\n#include <unordered_map>\n\n#define mp       make_pair\n#define mt       make_tuple\n#define pb       push_back\n#define rep(i,n) for(int i=0;i<(n);i++)\n\nusing namespace std;\n\ntypedef    long long          ll;\ntypedef    unsigned long long ull;\ntypedef    pair<int,int>      pii;\n\nconst int INF=1<<29;\nconst double EPS=1e-9;\n\nconst int dx[]={1,0,-1,0},dy[]={0,-1,0,1};\nint T;\nint N;\nvector<int> wake;\nvector<int> ap;\nint dp[110][33];\nint d;\nint memo(int day, int cycle){\n\tif (day == d + 1)return dp[day][cycle] = 0;\n\tif (dp[day][cycle] >= 0)return dp[day][cycle];\n\tint res = INF;\n\tif (wake[cycle] > ap[day]){\n\t\treturn dp[day][cycle] = INF;\n\t}\n\tres = min(res, memo(day + 1, 0) + 1);\n\tres = min(res, memo(day + 1, (cycle + 1) % T));\n\n\t// cout << day << \" \" << cycle << \" \" << res << endl;\n\treturn dp[day][cycle] = res;\n}\nint main(){\n\twhile (cin >> T, T){\n\t\tmemset(dp, -1, sizeof(dp));\n\t\twake.clear();\n\t\twake.resize(T);\n\t\tfor (int i = 0; i < T; i++) {\n\t\t\tcin >> wake[i];\n\t\t}\n\t\tcin >> N;\n\t\tap.clear();\n\t\tap.resize(110, INF);\n\t\td = 0;\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tint D,M;\n\t\t\tcin >> D >> M;\n\t\t\tD--;\n\t\t\td = max(d, D);\n\t\t\tap[D] = min(ap[D], M);\n\t\t}\n\t\tcout << memo(0, 0) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long;\nusing pii = pair<int, int>;\n\nconst int INF = 1 << 30;\nint T, N;\nint t[30], D[110], M[110];\nint getup[110];\nint dp[110][30];\n\nint main() {\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n  cout << fixed << setprecision(10);\n  \n  while (cin >> T, T) {\n    fill(getup, getup + 110, 24);\n    for (int i = 0; i < T; i++) {\n      cin >> t[i];\n    }\n    cin >> N;\n    for (int i = 0; i < N; i++) {\n      cin >> D[i] >> M[i];\n      getup[D[i]] = min(getup[D[i]], M[i]);\n    }\n\n    int D_max = *max_element(D, D + N);\n    fill((int *)dp[0], (int *)(dp[0] + 30), INF);\n    dp[0][T - 1] = 0;\n    for (int i = 0; i < D_max; i++) {\n      for (int j = 0; j < T; j++) {\n        dp[i + 1][j] = INF;\n        if (t[j] > getup[i + 1]) continue;\n        if (j == 0) {\n          for (int k = 0; k < T; k++) {\n            if (dp[i][k] == INF) continue;\n            if (k == (j + T - 1) % T) dp[i + 1][j] = min(dp[i + 1][j], dp[i][k]);\n            else dp[i + 1][j] = min(dp[i + 1][j], dp[i][k] + 1);\n          }\n        } else {\n          dp[i + 1][j] = dp[i][(j + T - 1) % T];\n        }\n      }\n    }\n\n    int ans = INF;\n    for (int i = 0; i < T; i++) {\n      ans = min(ans, dp[D_max][i]);\n    }\n    cout << ans << endl;\n  }\n\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 0x3f3f3f3f\n\n#include <iostream>\n#include <cstdio>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n  \nusing namespace std;\n  \ntypedef long long ll;\ntypedef pair <int,int> P;\ntypedef pair <int,P> PP;\n  \nstatic const double EPS = 1e-8;\n  \nstatic const int tx[] = {0,1,0,-1};\nstatic const int ty[] = {-1,0,1,0};\n\nint main(){\n  int cycle_length,interview_num;\n  int cycle[100];\n  map<int,vector<int> > interview;\n\n  while(~scanf(\"%d\",&cycle_length)){\n    if(cycle_length == 0) break;\n    for(int i=0;i<cycle_length;i++){\n      scanf(\"%d\",cycle+i);\n    }\n    scanf(\"%d\",&interview_num);\n  \n    int last_day = 0;\n    for(int i=0;i<interview_num;i++){\n      int day,start_hour;\n      scanf(\"%d %d\",&day,&start_hour);\n      interview[day].push_back(start_hour);\n      last_day = max(day,last_day);\n    }\n\n    //dp[day][cycle_idx] = min_cost\n    int dp[101][100];\n    memset(dp,0x3f,sizeof(dp));\n\n    //init\n    dp[1][0] = 0;\n\n    for(int day=1;day<=last_day;day++){\n      for(int cycle_idx=0;cycle_idx < cycle_length; cycle_idx++){\n\tint min_start_hour = INF;\n\tfor(int hour_idx=0;hour_idx<interview[day].size();hour_idx++){\n\t  int start_hour = interview[day][hour_idx];\n\t  min_start_hour = min(min_start_hour,start_hour);\n\t}\n\tif(cycle[(cycle_idx+1)%cycle_length] <= min_start_hour){\n\t  dp[day][(cycle_idx+1)%cycle_length]\n\t    = min(dp[day-1][cycle_idx],dp[day][(cycle_idx+1)%cycle_length]);\n\t}\n\tdp[day][0] = min(dp[day-1][cycle_idx]+1,dp[day][0]);\n      }\n    }\n  \n    int min_v = INF;\n    for(int i=0;i<cycle_length;i++){\n      min_v = min(dp[last_day][i],min_v);\n    }\n    printf(\"%d\\n\",min_v);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "////////////////////////////////////////\n///  tu3 pro-con template            ///\n////////////////////////////////////////\n#include <cassert>\n#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <iostream>\n#include <sstream>\n#include <algorithm>\n#include <numeric>\n#include <functional>\n#include <vector>\n#include <queue>\n#include <string>\n#include <complex>\n#include <stack>\n#include <set>\n#include <map>\n#include <list>\n#include <unordered_map>\n#include <unordered_set>\n#include <bitset>\n#include <regex>\nusing namespace std;\n\n//// MACRO ////\n#define countof(a) (sizeof(a)/sizeof(a[0]))\n\n#define REP(i,n) for (int i = 0; i < (n); i++)\n#define RREP(i,n) for (int i = (n)-1; i >= 0; i--)\n#define FOR(i,s,n) for (int i = (s); i < (n); i++)\n#define RFOR(i,s,n) for (int i = (n)-1; i >= (s); i--)\n#define pos(c,i) c.being() + (i)\n#define allof(c) c.begin(), c.end()\n#define aallof(a) a, countof(a)\n#define partof(c,i,n) c.begin() + (i), c.begin() + (i) + (n)\n#define apartof(a,i,n) a + (i), a + (i) + (n)\n#define long long long\n\n#define EPS 1e-9\n#define INF (1L << 30)\n#define LINF (1LL << 60)\n\n#define PREDICATE(t,a,exp) [&](const t & a) -> bool { return exp; }\n#define COMPARISON_T(t) bool(*)(const t &, const t &)\n#define COMPARISON(t,a,b,exp) [&](const t & a, const t & b) -> bool { return exp; }\n#define CONVERTER(TSrc,t,TDest,exp) [&](const TSrc &t)->TDest { return exp; }\n\ninline int sign(double x) { return (abs(x) < EPS ? 0 : x > 0 ? 1 : -1); }\ninline bool inRange(int val, int min, int max) { return val >= min && val < max; }\ninline bool inRange(double val, double min, double max) { return val - min > -EPS && val - max < EPS; }\n\n#ifdef ccout\n#define cout ccout\n#define endl cendl\n#endif\n\n//// i/o helper ////\n\nstruct _Reader { template <class T> _Reader operator ,(T &rhs) { cin >> rhs; return *this; } };\nstruct _Writer { bool f; _Writer() : f(false) { } template <class T> _Writer operator ,(const T &rhs) { cout << (f ? \" \" : \"\") << rhs; f = true; return *this; } };\n#define READ(t,...) t __VA_ARGS__; _Reader(), __VA_ARGS__\n#define WRITE(...) _Writer(), __VA_ARGS__; cout << endl\n\ntemplate <class T> struct vevector : public vector<vector<T>> { vevector(int n = 0, int m = 0, const T &initial = T()) : vector<vector<T>>(n, vector<T>(m, initial)) { } };\ntemplate <class T> struct vevevector : public vector<vevector<T>> { vevevector(int n = 0, int m = 0, int l = 0, const T &initial = T()) : vector<vevector<T>>(n, vevector<T>(m, l, initial)) { } };\ntemplate <class T> struct vevevevector : public vector<vevevector<T>> { vevevevector(int n = 0, int m = 0, int l = 0, int k = 0, const T &initial = T()) : vector<vevevector<T>>(n, vevevector<T>(m, l, k, initial)) { } };\ntemplate <class T> T read() { T t; cin >> t; return t; }\ntemplate <class T> vector<T> read(int n) { vector<T> v; REP(i, n) { v.push_back(read<T>()); } return v; }\ntemplate <class T> vevector<T> read(int n, int m) { vevector<T> v; REP(i, n) v.push_back(read<T>(m)); return v; }\ntemplate <class T> vevector<T> readjag() { return read<T>(read<int>()); }\ntemplate <class T> vevector<T> readjag(int n) { vevector<T> v; REP(i, n) v.push_back(readjag<T>()); return v; }\n\ntemplate <class T1, class T2> inline istream & operator >> (istream & in, pair<T1, T2> &p) { in >> p.first >> p.second; return in; }\ntemplate <class T1, class T2> inline ostream & operator << (ostream &out, pair<T1, T2> &p) { out << p.first << p.second; return out; }\ntemplate <class T> inline ostream & operator << (ostream &out, vector<T> &v)\n{\n\tostringstream ss;\n\tfor (auto x : v) ss << x << ' ';\n\tauto s = ss.str();\n\tout << s.substr(0, s.length() - 1) << endl;\n\treturn out;\n}\n\n//// start up ////\nvoid solve();\ninline void readfrom(string filename) { freopen(filename.c_str(), \"r\", stdin); }\ninline void writeto(string filename) { freopen(filename.c_str(), \"w\", stdout); }\nint main()\n{\n\treadfrom(\"E:/My Documents/Downloads/day3/Sleeping/input.txt\");\n\twriteto(\"E:/My Documents/Downloads/day3/Sleeping/out.txt\");\n\tsolve();\n\treturn 0;\n}\n\n////////////////////\n/// template end ///\n////////////////////\n\nvoid solve()\n{\n\tint testcases = INF;\n\tREP(testcase, testcases)\n\t{\n\t\tREAD(int, T);\n\t\tif (!T) break;\n\t\tauto tlp = read<int>(T);\n\t\tREAD(int, N);\n\t\t\n\t\tvector<int> d(100, 24);\n\t\tfor (auto i : read<pair<int, int>>(N))\n\t\t\td[i.first - 1] = min(d[i.first - 1], i.second);\n\t\n\t\tdeque< tuple<int, int, int> > q; // day,cycle,cost\n\t\tq.emplace_back(0, 0, 0);\n\t\tint result = -1;\n\t\tvevector<bool> visited(101, T);\n\t\twhile (!q.empty())\n\t\t{\n\t\t\tint i, c, x;\n\t\t\ttie(i, c, x) = q.front();\n\t\t\tq.pop_front();\n\t\t\t//WRITE(\"debug\", i, c, x);\n\t\t\tif (i == 100) { result = x; break; }\n\t\t\tif (visited[i][c]) continue;\n\t\t\tvisited[i][c] = true;\n\t\t\tif (d[i] < tlp[c]) continue;\n\t\t\tif (!visited[i + 1][(c + 1) % T]) { q.emplace_front(i + 1, (c + 1) % T, x); }\n\t\t\tif (!visited[i + 1][0]) q.emplace_back(i + 1, 0, x + 1);\n\t\t}\n\t\tWRITE(result);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\n#define rep(i,n) for(int (i)=0;(i)<(int)(n);++(i))\n#define each(itr,c) for(__typeof(c.begin()) itr=c.begin(); itr!=c.end(); ++itr)\n#define all(x) (x).begin(),(x).end()\n#define pb push_back\n#define fi first\n#define se second\n\nconst int INF=12345678;\n\nint T,n;\nint t[30];\nint interview[101];\n\nint dp[102][30];\nint dfs(int day, int cycle)\n{\n    if(dp[day][cycle]>=0) return dp[day][cycle];\n    if(day==101) return 0;\n\n    // failed\n    if(interview[day]<t[cycle]) return INF;\n\n    int ret=INF;\n\n    // take\n    ret=min(ret,dfs(day+1,(cycle+1)%T));\n    // don't take\n    ret=min(ret,dfs(day+1,0)+1);\n\n    return dp[day][cycle]=ret;\n}\n\nint main()\n{\n    while(cin >>T,T)\n    {\n        fill(interview,interview+101,INF);\n        memset(dp,-1,sizeof(dp));\n\n        rep(i,T) scanf(\" %d\", &t[i]);\n        scanf(\" %d\", &n);\n        rep(i,n)\n        {\n            int d,m;\n            scanf(\" %d %d\", &d, &m);\n            interview[d]=min(interview[d],m);\n        }\n\n        printf(\"%d\\n\", dfs(1,0));\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint T;\nint t[102];\nint N;\nint D[102],M[102];\nint max_d;\n\nmap<int,int> jobs;\nint dp[102][102];\n\n// a??\\??????b?????????????????????\nint dfs(int a,int b) {\n    //printf(\"%d %d\\n\",a,b);\n    if(a==max_d+1) return 0;\n    if(dp[a][b]!=-1) return dp[a][b];\n\n    int ret=INF;\n    if(t[b]<=jobs[a+1]) ret=min(ret,dfs(a+1,(b+1)%T));\n    ret=min(ret,dfs(a+1,0)+1);\n\n    return dp[a][b]=ret;\n}\n\nvoid solve() {\n    jobs.clear();\n    max_d=0;\n    rep(i,N) {\n        max_d=max(max_d,D[i]);\n        if(jobs.find(D[i])==jobs.end()) {\n            jobs[D[i]]=INF;\n        }\n        jobs[D[i]]=min(jobs[D[i]],M[i]);\n    }\n    memset(dp,-1,sizeof(dp));\n    cout<<dfs(1,0)<<endl;\n}\n\nint main() {\n    while(cin>>T) {\n        if(!T) break;\n        rep(i,T) cin>>t[i];\n        cin>>N;\n        rep(i,N) cin>>D[i]>>M[i];\n        solve();\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n//00:15\n\nint T,N;\nint cycle[31];\nint day[301];\nint dp[301][31];\nint dfs(int x,int t){\n\tif( x == 300 ) return 0;\n\tif( dp[x][t] != -1 ) return dp[x][t];\n\tint ans = 1e9;\n\tif( t != 0 ) ans = min(ans,dfs(x,0)+1);\n\tif( cycle[t] <= day[x] ){\n\t\tans = min(ans,dfs(x+1,(t+1)%T));\n\t}\n\treturn dp[x][t] = ans;\n}\n\nint main(){\n\twhile( cin >> T && T ){\n\t\tmemset(dp,-1,sizeof(dp));\n\t\tfor(int i = 0 ; i < 301 ; i++) \n\t\t\tday[i] = 1e9;\n\t\tfor(int i = 0 ; i < T ; i++){\n\t\t\tcin >> cycle[i];\n\t\t}\n\t\tcin >> N;\n\t\tfor(int i = 0 ; i < N ; i++){\n\t\t\tint d,m;\n\t\t\td--;\n\t\t\tcin >> d >> m;\n\t\t\tday[d] = min(day[d],m);\n\t\t}\n\t\tcout << dfs(0,0) << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define mp make_pair\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef pair<int,pii> pip;\ntypedef vector<pip>vip;\nconst double PI=acos(-1);\nconst double EPS=1e-8;\nconst int inf=1e8;\nint main(){\n\tint n;\n\twhile(cin>>n,n){\n\t\tvi t(n);\n\t\trep(i,n)cin>>t[i];\n\t\tint m;\n\t\tcin>>m;\n\t\tvi in(110,inf);\n\t\twhile(m--){\n\t\t\tint a,b;\n\t\t\tcin>>a>>b;a--;\n\t\t\tin[a]=min(in[a],b);\n\t\t}\n\t\tvvi dp(110,vi(n,inf));\n\t\tdp[0][0]=0;\n\t\trep(i,109)rep(j,n){\n\t\t\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t\t\tif(in[i+1]==inf||t[(j+1)%n]<=in[i+1])\n\t\t\t\tdp[i+1][(j+1)%n]=min(dp[i+1][(j+1)%n],dp[i][j]);\n\t\t}\n\t\tint mi=inf;\n\t\trep(i,n)mi=min(mi,dp[109][i]);\n\t\tcout<<mi<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <iostream>\n#include <vector>\n#include <math.h>\n#include <iomanip>\n#include <map>\n\nusing namespace std;\nconst int INF = 1<<30;\n\nint solve();\n\nint main(void) {\n\t\n\twhile(solve()){}\n\n\treturn 0;\n}\n\n\nint solve() {\n\n\t\n\ttypedef std::vector<int> vi;\n\ttypedef vector<vi> vvi;\n\ttypedef pair<int,int>pii;\n\n\tint N, T;\n\tcin >> T;\n\tif( T == 0 ) { return 0; }\n\n\tvi t(T,INF);\n\tmap<int,int> mp;\n\t\n\tfor( int i = 0; i < T; i++ ) {\n\t\tcin >> t[i];\n\t}\n\tcin >> N;\n\tfor( int i = 0; i < N; i++ ) {\n\t\tint d, m;\n\t\tcin >> d >> m;\n\t\tif( mp.find(d) != mp.end() ) {\n\t\t\tmp[d] = min(mp[d],m);\n\t\t} else {\n\t\t\tmp[d] = m;\n\t\t}\n\t}\n\n\tvvi dp(100+2,vi(T,INF));\n\t\tdp[1][0] = 0;\t//?????????\n\n\n\t/*\n\t\tdp[?????¨?????\\][?????????????????´???] := ????°??????°\n\t*/\n\n\tfor( int i = 1; i+1 < dp.size(); i++ ) {\n\t\tfor( int j = 0; j < dp[i].size(); j++ ) {\n\t\t\t//????????????????????§??´?????????\n\t\t\tif( dp[i][j] == INF ) { continue; }\n\t\t\tif( mp.find(i) != mp.end() && mp[i] < t[j] ) { continue; }\n\t\t\t//?£????\n\t\t\tdp[i+1][0] = min(dp[i+1][0],dp[i][j]+1);\n\t\t\t//?£??????????\n\t\t\tdp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T],dp[i][j]);\n\t\t}\n\t}\n\tint ans = INF;\n\tfor(int i = 0; i<dp[0].size(); i++ ) {\n\t\tans = min(ans,dp[dp.size()-1][i]);\n\t}\n\tcout << ans << endl;\n\n\treturn 1;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nint main(){\n  int T;\n  while(cin >> T, T){\n    vector<int> t(T);\n    for(int i = 0; i < T; ++i){\n      cin >> t[i];\n    }\n    int N;\n    cin >> N;\n    int d, m;\n    vector< pair<int,int> > V;\n    for(int i = 0; i < N; ++i){\n      cin >> d >> m;\n      --d;\n      V.emplace_back(d,m);\n    }\n    sort(V.begin(), V.end());\n    int ans = -1, e = N;\n    while(e > 0){\n      for(int k = 0; k <= V[N-1].first; ++k){\n        int tmp = -1;\n        bool f = false;\n        for(int i = 0; i < e; ++i){\n          if(V[i].first < k) continue;\n          if(tmp == -1 && V[i].first >= k){\n            tmp = i;\n            f = true;\n          }\n          if(V[i].second < t[(V[i].first-k)%T]){\n            f = false;\n            break;\n          }\n        }\n        if(f){\n          e = tmp;\n          ++ans;\n          break;\n        }\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i, n) for (int i = 0; i < int(n); ++i)\n#define all(c) (c).begin(), (c).end()\n\ntemplate <class T, class U>\ninline bool chmin(T& t, const U& f) { return t > f ? t = f, true : false; }\n\nconst int DMAX = 110, INF = 1 << 12;\n\nint solve(int T, const vector<int>& t, const vector<int>& interview) {\n    vector<int> dp(T, INF); dp[0] = 0;\n    for (const int& M : interview) {\n        vector<int> nxt(T, INF);\n        rep(i, T) {\n            if (i == T - 1) chmin(nxt[0], dp[i]);\n            else {\n                if (M >= t[i]) chmin(nxt[i + 1], dp[i]);\n                chmin(nxt[0], dp[i] + 1);\n            }\n        }\n        dp.swap(nxt);\n    }\n    return *min_element(all(dp));\n}\n\nint main() {\n    int T; cin >> T;\n    vector<int> t(T);\n    for (int& e : t) cin >> e;\n    int N; cin >> N;\n    vector<int> interview(DMAX, INF);\n    while (N--) {\n        int D, M; cin >> D >> M;\n        chmin(interview[D], M);\n    }\n    cout << solve(T, t, interview) << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<cassert>\nusing namespace std;\n\nint main()\n{\n  int T,N;\n  while(cin >> T,T)\n    {\n      vector<int> t(T+1);\n      for(int i=0;i<T;i++)\n\tcin >> t[i];\n      cin >> N;\n\n      vector<int> D(101);\n      for(int i=0;i<101;i++)\n\tD[i] = (1<<29);\n\n      int mexday = 0;\n      for(int i=0;i<N;i++)\n\t{\n\t  int d,m;\n\t  cin >> d >> m;\n\t  D[d] = min(D[d],m);\n\t  mexday = max(mexday,d);\n\t}\n      //cout << \"mexday = \" << mexday << endl;\n      int dayMin[mexday+1];\n      int dp[T][mexday+1];\n      for(int i=0;i<T;i++)\n\tfor(int j=0;j<=mexday;j++)\n\t  dp[i][j] = dayMin[j] = (1<<29);\n\n      dp[0][1] = 0;\n      dayMin[1] = dp[0][1];\n\n      for(int i=2;i<=mexday;i++)\n\t{\n\t  for(int j=0;j<min(i+1,T);j++)\n\t    {\n\t      if(!j)\n\t\t{\n\t\t  dp[j][i] = min(dp[j][i],dayMin[i-1]+1); \n\t\t  dp[j][i] = min(dp[j][i],dp[T-1][i-1]+(D[i]>=t[j]?0:1));\n\t\t  dayMin[i] = min(dp[j][i],dayMin[i]);\n\t\t  continue;\n\t\t}\n\t      if(dp[j-1][i-1] == (1<<29))\n\t\tcontinue;\n\t      //dp[j][i] = min(dp[j][i],dp[j-1][i-1]+(D[i]>=t[j]?0:1));\n\t      if(D[i]>=t[j])\n\t\tdp[j][i] = min(dp[j][i],dp[j-1][i-1]);\n\t      else\n\t\tdp[0][i] = min(dp[0][i],dp[j][i]+1);\n\t      dayMin[i] = min(dp[j][i],dayMin[i]);\t    \n\t    }\n\t}\n      /*\n      cout << \"dayMin = \" << endl;\n      for(int i=1;i<=mexday;i++)\n\tcout << dayMin[i] << \" \";\n      cout << endl << endl;\n\n\t  for(int j=0;j<T;j++)      \n\t    {\n\t      for(int i=1;i<=mexday;i++)\n\t\tcout << dp[j][i] << \" \";\n\t      cout << endl;\n\t}\n      */\n      int ans = (1<<29);\n      for(int i=0;i<T;i++)\n\tans = min(ans,dp[i][mexday]);\n      assert(ans != (1<<29));\n      cout << ans << endl;\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include \"bits/stdc++.h\"\nusing namespace std;\n\n//#define int int64_t\n\n#define CHOOSE(a) CHOOSE2 a\n#define CHOOSE2(a0,a1,a2,a3,x,...) x\n#define REP1(i, s, cond, cal) for (signed i = signed(s); i cond; i cal)\n#define REP2(i, s, n) REP1(i, s, < signed(n), ++)\n#define REP3(i, n) REP2(i, 0, n)\n#define rep(...) CHOOSE((__VA_ARGS__,REP1,REP2,REP3))(__VA_ARGS__)\n#define rrep(i, s) rep(i, s, >= 0, --)\n\n#define all(c) begin(c), end(c)\n#define maxup(ans, x) (ans = (ans < x ? x : ans))\n#define minup(ans, x) (ans = (ans > x ? x : ans))\n\n#define breakif(cond) if(cond) break; else\n\nusing VV = vector<vector<int>>;\nusing V = vector<int>;\nusing P = pair<int, int>;\nusing IP = pair<int, P>;\n\ntemplate<typename T>\ninline void input(vector<T>& v) { for (auto& x : v) cin >> x; }\n\nsigned main() {\n\tint t;\n\twhile (cin >> t && t) {\n\t\tV ts(t);\n\t\trep(i, t) {\n\t\t\tint x; cin >> x;\n\t\t\tts[i] = x;\n\t\t}\n\t\tint n; cin >> n;\n\t\tV ms(101, 1 << 29);\n\t\trep(i, n) {\n\t\t\tint d, m;\n\t\t\tcin >> d >> m;\n\t\t\tminup(ms[d - 1], m);\n\t\t}\n\t\tVV dp(101, V(t, 1 << 29)); //dp[day][t_i]\n\n\t\tdp[0][0] = 0;\n\t\trep(i, 0, 100) rep(j, t) {\n\t\t\tminup(dp[i + 1][1], dp[i][j] + 1);\n\t\t\tif (ts[j] <= ms[i]) minup(dp[i + 1][(j + 1) % t], dp[i][j]);\n\t\t}\n\t\tint ans = *min_element(all(dp[100]));\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nstatic const int INF = (1<<28);\n\nint T, t[30], N, D, M, dp[101][30], m[100];\n\nmain(){\n  while(cin >> T && T){\n    for(int i=0;i<T;i++) cin >> t[i];\n    cin >> N;\n    fill(m, m+N, INF);\n    for(int i=0;i<N;i++){\n      cin >> D >> M;\n      m[D-1] = min(m[D-1], M);\n    }\n    fill(dp[0], dp[101], INF);\n    dp[0][0] = 0;\n    for(int i=0;i<N;i++){\n      for(int j=0;j<T;j++){\n        if(t[j] <= m[i]) dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T], dp[i][j]);\n        dp[i+1][1] = min(dp[i+1][1], dp[i][j]+1);\n      }\n    }\n    int ans = INF;\n    for(int i=0;i<T;i++) ans = min(ans, dp[N][i]);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nint b[100];\nint d[110];\nint dp[110][31];\nint main(){\n\tint a;\n\twhile(scanf(\"%d\",&a),a){\n\t\tfor(int i=0;i<a;i++)scanf(\"%d\",b+i);\n\t\tint c;scanf(\"%d\",&c);\n\t\tfor(int i=0;i<110;i++)d[i]=-1;\n\t\tfor(int i=0;i<c;i++){\n\t\t\tint p,q;scanf(\"%d%d\",&p,&q);\n\t\t\tp--;d[p]=q;\n\t\t}\n\t\tfor(int i=0;i<110;i++)for(int j=0;j<31;j++)dp[i][j]=999999999;\n\t\tdp[0][0]=0;\n\t\tfor(int i=0;i<100;i++){\n\t\t\tfor(int j=0;j<a;j++){\n\t\t\t//\tprintf(\"%d %d: %d\\n\",i,j,dp[i][j]);\n\t\t\t\tif(!~d[i]||b[j]<=d[i])dp[i+1][(j+1)%a]=min(dp[i+1][(j+1)%a],dp[i][j]);\n\t\t\t\tdp[i+1][1%a]=min(dp[i+1][1%a],dp[i][j]+1);\n\t\t\t}\n\t\t}\n\t\tint ret=999999999;\n\t\tfor(int i=0;i<a;i++)ret=min(ret,dp[100][i]);\n\t\tprintf(\"%d\\n\",ret);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nint main(){\n  int T;\n  while(cin >> T, T){\n    vector<int> t(T);\n    for(int i = 0; i < T; ++i){\n      cin >> t[i];\n    }\n    int N;\n    cin >> N;\n    int d, m;\n    vector< pair<int,int> > V;\n    for(int i = 0; i < N; ++i){\n      cin >> d >> m;\n      --d;\n      V.emplace_back(d,m);\n    }\n    sort(V.begin(), V.end());\n    int ans = 0, e = N;\n    while(e > 0){\n      for(int k = 0; k <= V[N-1].first; ++k){\n        int tmp = -1;\n        bool f = false;\n        for(int i = 0; i < e; ++i){\n          if(V[i].first < k) continue;\n          if(tmp == -1 && V[i].first >= k){\n            tmp = i;\n            f = true;\n          }\n          if(V[i].second < t[(V[i].first-k)%T]){\n            f = false;\n            break;\n          }\n        }\n        if(f){\n          e = tmp;\n          if(e) ++ans;\n          break;\n        }\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define each(itr,v) for(auto itr:v)\n#define pb(s) push_back(s)\n#define mp(a,b) make_pair(a,b)\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define maxch(x,y) x=max(x,y)\n#define minch(x,y) x=min(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt(x) bitset<32>(x).count()\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> P;\ntypedef pair<P, int> PPI;\ntypedef pair<ll, ll> PL;\ntypedef pair<P, ll> PPL;\n\n#define INF INT_MAX/3\n\n#define MAX_N 1000\n\nstruct state{\n\tint cyc,day,cost;\n};\nbool operator<(const state& a,const state& b){return a.cost>b.cost;}\n\nint t,ts[33];\nint n;\nint plan[111];\n\nint d[111][33];\n\nint main(){\n\tcin.sync_with_stdio(false);\n\twhile(1){\n\t\tcin>>t;\n\t\tif(t==0)break;\n\t\trep(i,t)cin>>ts[i];\n\t\tcin>>n;\n\t\tmemset(plan,-1,sizeof(plan));\n\t\trep(i,n){\n\t\t\tint d,m;\n\t\t\tcin>>d>>m;\n\t\t\td--;\n\t\t\tplan[d]=m;\n\t\t}\n\t\trep(i,111)rep(j,33)d[i][j]=INF;\n\t\tpriority_queue<state> que;\n\t\tque.push((state){0,0,0});\n\t\td[0][0]=0;\n\t\twhile(que.size()){\n\t\t\tstate a=que.top(); que.pop();\n\t\t\tif(a.day==n)break;\n\t\t\tint nd=a.day+1,nc=(a.cyc+1)%t;\n\t\t\tif((plan[a.day]==-1||plan[a.day]>=ts[a.cyc])&&d[nd][nc]>d[a.day][a.cyc]){\n\t\t\t\td[nd][nc]=d[a.day][a.cyc];\n\t\t\t\tque.push((state){nc,nd,d[nd][nc]});\n\t\t\t}\n\t\t\tif(d[nd][1]>d[a.day][a.cyc]+1){\n\t\t\t\td[nd][1]=d[a.day][a.cyc]+1;\n\t\t\t\tque.push((state){1,nd,d[nd][nc]});\n\t\t\t}\n\t\t}\n\t\tint res=INF;\n\t\trep(i,33)minch(res,d[n][i]);\n\t\tcout<<res<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int INF = 1e8;\n\nint main()\n{\n\tint T;\n\twhile (cin >> T, T) {\n\t\tvector<int> t(T);\n\t\tfor (int i = 0; i < T; i++) {\n\t\t\tcin >> t[i];\n\t\t}\n\t\tvector<int> H(100, 24);\n\t\tint N;\n\t\tcin >> N;\n\t\tfor (int i = 0; i < N; i++) {\n\t\t\tint D, M;\n\t\t\tcin >> D >> M; D--;\n\t\t\tH[D] = M;\n\t\t}\n\t\tvector<vector<int>> dp(100, vector<int>(T, INF));\n\t\tdp[0][0] = 0;\n\t\tfor (int i = 1; i < 100; i++) {\n\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\tif (dp[i - 1][j] != INF) {\n\t\t\t\t\tdp[i][0] = min(dp[i][0], dp[i - 1][j] + 1);\n\t\t\t\t\tif (t[(j + 1) % T] <= H[i]) {\n\t\t\t\t\t\tdp[i][(j + 1) % T] = min(dp[i][(j + 1) % T], dp[i - 1][j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint res = INF;\n\t\tfor (int i = 0; i < T; i++) {\n\t\t\tres = min(res, dp[99][i]);\n\t\t}\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n  int tm,n;\n  while(cin >> tm,tm){\n    int i,j,k;\n    int t[tm];\n    for(i=0;i<tm;i++) cin >> t[i];\n    cin >> n;\n    int m[150]={};\n    fill(m,m+150,24);\n    for(i=1;i<=n;i++){\n      cin >> k;\n      cin >> m[k];\n    }\n    int inf = 1<<20;\n    int dp[150][50];\n    fill(dp[0],dp[149],inf);\n    dp[1][0]=0;\n    for(i=1;i<=100;i++){\n      for(j=0;j<50;j++){\n\tif(dp[i][j]==inf) continue;\n\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t//cout <<i<<\":\"<<j<<\":\"<< t[(j+1)%tm]<<\":\"<<m[i]<<endl;\n\tif(t[(j+1)%tm]<=m[i+1]){\n\t  dp[i+1][(j+1)%tm]=min(dp[i+1][(j+1)%tm],dp[i][j]);\n\t}\n      }\n    }\n    int o=inf;\n    /*\n    for(j=1;j<=n+10;j++){\n      cout << j << \":\";\n      for(i=0;i<tm;i++) cout << dp[j][i] << (i==tm-1?\"\\n\":\" \");\n    }\n    */\n    for(i=0;i<50;i++) o=min(o,dp[101][i]);\n    cout << o << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\nusing namespace std;\n#define REP(i,b,n) for(int i=b;i<n;i++)\n#define rep(i,n)   REP(i,0,n)\nint table[30][100];\n#define INF 10000\nint solve(vector<int> &cyc,vector<int>& day){\n  rep(i,day.size())rep(j,cyc.size())table[j][i]=INF;\n  table[0][0]=0;\n  REP(i,1,day.size()){\n    table[0][i]=min(table[0][i-1]+1,table[cyc.size()-1][i-1]);\n    REP(j,1,cyc.size()){\n      table[0][i]=min(table[0][i],table[j][i-1]+1);//take caffein\n      if (day[i]>=cyc[j]){\n\ttable[j][i]=table[j-1][i-1];\n      }\n\n    }\n  }\n\n  int ret=INF;\n  rep(i,cyc.size())ret=min(ret,table[i][day.size()-1]);\n  return ret;\n}\n\nmain(){\n  int n,m;\n  while(cin>>n && n){\n    vector<int> cyc,day(100,24);\n    rep(i,n){\n      int t;cin>>t;cyc.push_back(t);\n    }\n    \n    cin>>m;\n    rep(i,m){\n      int d,time;cin>>d>>time;\n      day[d-1]=min(day[d-1],time);\n    }\n    cout << solve(cyc,day)<<endl;\n  }\n  return false;\n}"
  },
  {
    "language": "C++",
    "code": "// Header {{{\n// includes {{{\n#include <algorithm>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <iostream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <sys/time.h>\n#include <unistd.h>\n#include <vector>\n// }}}\nusing namespace std;\n// consts {{{\nstatic const int INF = 1e9;\nstatic const double PI = acos(-1.0);\nstatic const double EPS = 1e-10;\n// }}}\n// typedefs {{{\ntypedef long long int LL;\ntypedef unsigned long long int ULL;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\ntypedef vector<ULL> VULL;\ntypedef vector<VULL> VVULL;\ntypedef vector<double> VD;\ntypedef vector<VD> VVD;\ntypedef vector<bool> VB;\ntypedef vector<VB> VVB;\ntypedef vector<char> VC;\ntypedef vector<VC> VVC;\ntypedef vector<string> VS;\ntypedef vector<VS> VVS;\ntypedef pair<int, int> PII;\ntypedef complex<int> P;\n#define PQ(type) priority_queue<type>\n// priority queue reverse\n#define PQR(type) priority_queue< type, vector<type>, greater<type> >\n// }}}\n// macros & inline functions {{{\n// syntax sugars {{{\n#define FOR(i, b, e) for (typeof(e) i = (b); i < (e); ++i)\n#define FORI(i, b, e) for (typeof(e) i = (b); i <= (e); ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define REPI(i, n) FORI(i, 0, n)\n#define OPOVER(_op, _type) inline bool operator _op (const _type &t) const\n#define ASSIGN_MAX(var, val) ((var) = max((var), (val)))\n#define ASSIGN_MIN(var, val) ((var) = min((var), (val)))\n// }}}\n// conversion {{{\ninline int toInt(string s) { int v; istringstream sin(s); sin>>v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout<<x; return sout.str(); }\n// }}}\n// array and STL {{{\n#define ARRSIZE(a) ( sizeof(a) / sizeof(a[0]) )\n#define ZERO(a, v) ( assert(v == 0 || v == -1), memset(a, v, sizeof(a)) )\n#define F first\n#define S second\n#define MP(a, b) make_pair(a, b)\n#define SIZE(a) ((LL)a.size())\n#define PB(e) push_back(e)\n#define SORT(v) sort((v).begin(), (v).end())\n#define RSORT(v) sort((v).rbegin(), (v).rend())\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EACH(c, it) for(typeof((c).begin()) it=(c).begin(); it!=(c).end(); ++it)\n#define REACH(c, it) for(typeof((c).rbegin()) it=(c).rbegin(); it!=(c).rend(); ++it)\n#define EXIST(s, e) ((s).find(e) != (s).end())\n// }}}\n// bit manipulation {{{\n// singed integers are not for bitwise operations, specifically arithmetic shifts ('>>', and maybe not good for '<<' too)\n#define IS_UNSIGNED(n) (!numeric_limits<typeof(n)>::is_signed)\n#define BIT(n) (assert(IS_UNSIGNED(n)), assert(n < 64), (1ULL << (n)))\n#define BITOF(n, m) (assert(IS_UNSIGNED(n)), assert(m < 64), ((ULL)(n) >> (m) & 1))\ninline int BITS_COUNT(ULL b) { int c = 0; while(b != 0) { c += (b & 1); b >>= 1; } return c; }\ninline int MSB(ULL b) { int c = 0; while(b != 0) { ++c; b >>= 1; } return c-1; }\ninline int MAKE_MASK(ULL upper, ULL lower) { assert(lower < 64 && upper < 64 && lower <= upper); return (BIT(upper) - 1) ^ (BIT(lower) - 1); }\n// }}}\n// for readable code {{{\n#define EVEN(n) (n % 2 == 0)\n#define ODD(n) (!EVEN(n))\n// }}}\n// debug {{{\n#define arrsz(a) ( sizeof(a) / sizeof(a[0]) )\n#define dprt(fmt, ...) if (opt_debug) { fprintf(stderr, fmt, ##__VA_ARGS__); }\n#define darr(a) if (opt_debug) { copy( (a), (a) + arrsz(a), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define darr_range(a, f, t) if (opt_debug) { copy( (a) + (f), (a) + (t), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define dvec(v) if (opt_debug) { copy( ALL(v), ostream_iterator<int>(cerr, \" \") ); cerr << endl; }\n#define darr2(a) if (opt_debug) { FOR(__i, 0, (arrsz(a))){ darr( (a)[__i] ); } }\n#define WAIT() if (opt_debug) { string _wait_; cerr << \"(hit return to continue)\" << endl; getline(cin, _wait_); }\n#define dump(x) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #x << \" = \" << (x) << endl; }\n// dump vector elements in [s, e)\n#define dumpv(v, s, e) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #v << \" = \"; FOR(__i, s, e) { cerr << v[__i] << \"\\t\"; } cerr << endl; }\n#define dumpl(x) if (opt_debug) { cerr << \" [L\" << __LINE__ << \"] \" << #x << endl << (x) << endl; }\n#define dumpf() if (opt_debug) { cerr << __PRETTY_FUNCTION__ << endl; }\n#define where() if (opt_debug) { cerr << __FILE__ << \": \" << __PRETTY_FUNCTION__ << \" [L: \" << __LINE__ << \"]\" << endl; }\n#define show_bits(b, s) if(opt_debug) { REP(i, s) { cerr << BITOF(b, s-1-i); if(i%4 == 3) cerr << ' '; } cerr << endl; }\n\n// ostreams {{{\n// complex\ntemplate<typename T> ostream& operator<<(ostream& s, const complex<T>& d) {return s << \"(\" << d.real() << \", \" << d.imag() << \")\";}\n\n// pair\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& s, const pair<T1, T2>& d) {return s << \"(\" << d.first << \", \" << d.second << \")\";}\n\n// vector\ntemplate<typename T> ostream& operator<<(ostream& s, const vector<T>& d) {\n\tint len = d.size();\n\tREP (i, len) {\n\t\ts << d[i]; if (i < len - 1) s << \"\\t\";\n\t}\n\treturn s;\n}\n\n// 2 dimentional vector\ntemplate<typename T> ostream& operator<<(ostream& s, const vector< vector<T> >& d) {\n\tint len = d.size();\n\tREP (i, len) {\n\t\ts << d[i] << endl;\n\t}\n\treturn s;\n}\n\n// map\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& s, const map<T1, T2>& m) {\n\ts << \"{\" << endl;\n\tfor (typeof(m.begin()) itr = m.begin(); itr != m.end(); ++itr) {\n\t\ts << \"\\t\" << (*itr).first << \" : \" << (*itr).second << endl;\n\t}\n\ts << \"}\" << endl;\n\treturn s;\n}\n// }}}\n// }}}\n// }}}\n// time {{{\ninline double now(){ struct timeval tv; gettimeofday(&tv, NULL); return (static_cast<double>(tv.tv_sec) + static_cast<double>(tv.tv_usec) * 1e-6); }\n// }}}\n// string manipulation {{{\ninline VS split(string s, char delimiter) { VS v; string t; REP(i, s.length()) { if(s[i] == delimiter) v.PB(t), t = \"\"; else t += s[i]; } v.PB(t); return v; }\ninline string join(VS s, string j) { string t; REP(i, s.size()) { t += s[i] + j; } return t; }\n// }}}\n// geometry {{{\n#define Y real()\n#define X imag()\n// }}}\n// 2 dimentional array {{{\nenum { UP, RIGHT, DOWN, LEFT, UP_RIGHT, DOWN_RIGHT, DOWN_LEFT, UP_LEFT };\nP dydx4[4] = { P(-1, 0), P(0, 1), P(1, 0), P(0, -1) };\nP dydx8[8] = { P(-1, 0), P(0, 1), P(1, 0), P(0, -1), P(-1, 1), P(1, 1), P(1, -1), P(-1, -1) };\nbool in_field(int H, int W, P p) {\n\treturn (0 <= p.Y && p.Y < H) && (0 <= p.X && p.X < W);\n}\n// }}}\n// input and output {{{\ninline void input(string filename) {\n\tfreopen(filename.c_str(), \"r\", stdin);\n}\ninline void output(string filename) {\n\tfreopen(filename.c_str(), \"w\", stdout);\n}\n// }}}\n// }}}\n\n// Header under development {{{\n\nint LCM(int a, int b) {\n\t// FIXME\n\treturn a * b;\n}\n\n// Fraction class {{{\n// ref: http://martin-thoma.com/fractions-in-cpp/\nclass Fraction {\n\tpublic:\n\t\tULL numerator;\n\t\tULL denominator;\n\t\tFraction(ULL _numerator, ULL _denominator) {\n\t\t\tassert(_denominator > 0);\n\t\t\tnumerator = _numerator;\n\t\t\tdenominator = _denominator;\n\t\t};\n\n\t\tFraction operator*(const ULL rhs) {\n\t\t\treturn Fraction(this->numerator * rhs, this->denominator);\n\t\t};\n\n\t\tFraction operator*(const Fraction& rhs) {\n\t\t\treturn Fraction(this->numerator * rhs.numerator, this->denominator * rhs.denominator);\n\t\t}\n\n\t\tFraction operator+(const Fraction& rhs) {\n\t\t\tULL lcm = LCM(this->denominator, rhs.denominator);\n\t\t\tULL numer_lhs = this->numerator * (this->denominator / lcm);\n\t\t\tULL numer_rhs = rhs.numerator * (rhs.numerator / lcm);\n\t\t\treturn Fraction(numer_lhs + numer_rhs, lcm);\n\t\t}\n\n\t\tFraction& operator+=(const Fraction& rhs) {\n\t\t\tFraction result = (*this) + rhs;\n\t\t\tthis->numerator = result.numerator;\n\t\t\tthis->denominator = result.denominator;\n\t\t\treturn *this;\n\t\t}\n};\n\nstd::ostream& operator<<(std::ostream &s, const Fraction &a) {\n\tif (a.denominator == 1) {\n\t\ts << a.numerator;\n\t} else {\n\t\ts << a.numerator << \"/\" << a.denominator;\n\t}\n\treturn s;\n}\n\n// }}}\n\n// }}}\n\nbool opt_debug = false;\n\nint main(int argc, char** argv) {\n\tstd::ios_base::sync_with_stdio(false);\n\t// set options {{{\n\tint __c;\n\twhile ( (__c = getopt(argc, argv, \"d\")) != -1 ) {\n\t\tswitch (__c) {\n\t\t\tcase 'd':\n\t\t\t\topt_debug = true;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tabort();\n\t\t}\n\t}\n\t// }}}\n\n\t// opt_debug = true;\n\t// input(\"./inputs/0.txt\");\n\t// output(\"./outputs/0.txt\");\n\n\tint T;\n\twhile (cin >> T, T) {\n\t\tVI cycle(T);\n\t\tREP (i, T) {\n\t\t\tcin >> cycle[i];\n\t\t}\n\t\tint N; cin >> N;\n\t\tvector<PII> interviews;\n\t\tint max_d = 0;\n\t\tREP (i, N) {\n\t\t\tint D, M; cin >> D >> M;\n\t\t\tinterviews.PB(MP(D, M));\n\t\t\tmax_d = max(max_d, D);\n\t\t}\n\t\tVI wakeup_time(max_d, INF);\n\t\tREP (i, N) {\n\t\t\tPII& _i = interviews[i];\n\t\t\twakeup_time[_i.F-1] = min(wakeup_time[_i.F-1], _i.S);\n\t\t}\n\n\t\tVVI dp(max_d, VI(T, INF));\n\t\tdp[0][0] = 0;\n\t\tFOR (d, 1, max_d) {\n\t\t\tREP (t, T) {\n\t\t\t\tdp[d][0] = min(dp[d][0], dp[d-1][t] + 1);\n\t\t\t}\n\t\t\tFOR (t, 1, T) {\n\t\t\t\tif (cycle[t] <= wakeup_time[d]) {\n\t\t\t\t\tdp[d][t] = dp[d-1][t-1];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tint ans = INF;\n\t\tREP (t, T) {\n\t\t\tans = min(ans, dp[max_d-1][t]);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}\n\n// vim: foldmethod=marker"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\ntypedef pair<int,int> pii;\n\nint main() {\n    int t;\n    while (cin>>t && t) {\n        vector<int> s(t);\n        for (int i = 0; i < t; i++) cin >> s[i];\n        int n;\n        cin >> n;\n        vector<int> d(101, 24);\n        for (int i = 0; i < n; i++) {\n            int a, b;\n            cin >> a >> b;\n            a--;\n            d[a] = min(d[a], b);\n        }\n        if (t == 1) {\n            cout << 0 << endl;\n            return 0;\n        }\n        \n        vector<vector<int> > dp(t, vector<int>(101, 1010));\n        dp[0][0] = 0;\n        for (int i = 0; i < 100; i++) {\n            for (int j = 0; j < t; j++) {\n                int a = dp[j][i];\n                int wake = s[j%t];\n                int fail = 0;\n                if (d[i] < wake) fail++;\n                if (fail == 0) dp[(j+1)%t][i+1] = min(dp[(j+1)%t][i+1], a);\n                else dp[1][i+1] = min(dp[1][i+1], a+1);\n            }\n        }\n        int ans = 1010;\n        for (int i = 0; i < t; i++) if (dp[i][100] < ans) ans = dp[i][100];\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\n#define REP(i,n) for(ll i=0;i<n;++i)\n#define RREP(i,n) for(ll i=n-1;i>=0;--i)\n#define FOR(i,m,n) for(ll i=m;i<n;++i)\n#define RFOR(i,m,n) for(ll i=n-1;i>=m;--i)\n#define ALL(v) (v).begin(),(v).end()\n#define PB(a) push_back(a)\n#define UNIQUE(v) v.erase(unique(ALL(v)),v.end());\n#define DUMP(v) REP(aa, (v).size()) { cout << v[aa]; if (aa != v.size() - 1)cout << \" \"; else cout << endl; }\n#define INF 1000000001ll\n#define MOD 1000000007ll\n#define EPS 1e-9\n\nconst int dx[8] = { 1,1,0,-1,-1,-1,0,1 };\nconst int dy[8] = { 0,1,1,1,0,-1,-1,-1 };\n\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector<vi> vvi;\ntypedef vector<vl> vvl;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nll max(ll a, int b) { return max(a, ll(b)); }\nll max(int a, ll b) { return max(ll(a), b); }\nll min(ll a, int b) { return min(a, ll(b)); }\nll min(int a, ll b) { return min(ll(a), b); }\n///(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)///\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tint t;\n\twhile (cin >> t, t) {\n\t\tvi v(t);\n\t\tREP(i, t)cin >> v[i];\n\t\tint n; cin >> n;\n\t\tvi d(100,INF);\n\t\tREP(i, n) {\n\t\t\tint a, b;\n\t\t\tcin >> a >> b;\n\t\t\td[a - 1] = b;\n\t\t}\n\t\tint p = 100, cnt = 0;\n\t\twhile (p != 0) {\n\t\t\tREP(i, p) {\n\t\t\t\tint flag = 1;\n\t\t\t\tFOR(j, i, p) {\n\t\t\t\t\tif (v[(j-i)%t] > d[j])flag = 0;\n\t\t\t\t}\n\t\t\t\tif (flag) {\n\t\t\t\t\tp = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcnt++;\n\t\t}\n\t\tcout << cnt-1 << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\nusing namespace std;\n \n#define REP(i,n) for(int i=0; i<n; ++i)\n#define FOR(i,a,b) for(int i=a; i<=b; ++i)\n#define FORR(i,a,b) for (int i=a; i>=b; --i)\n#define pi M_PI\n#define EPS 1e-10\n \ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef vector<VI> VVI;\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> PL;\n\nconst int INF = 1e9;\n\nint main() {\n    int m, n;\n    while (cin >> m && m){\n        VI t(m), h(101,24);\n        REP(i,m) cin >> t[i];\n        cin >> n;\n        REP(i,n){\n            int d, m;\n            cin >> d >> m;\n            d--;\n            h[d] = min(h[d],m);\n        }\n        VVI dp(101,VI(m,INF));\n        dp[0][0] = 0;\n        REP(i,100) REP(j,m){\n            dp[i+1][0] = min(dp[i+1][0], dp[i][j] + 1);\n            if (t[(j+1)%m] <= h[i+1])\n                dp[i+1][(j+1)%m] = min(dp[i+1][(j+1)%m], dp[i][j]);\n        }\n        int ans = INF;\n        REP(j,m) ans = min(ans, dp[100][j]);\n        cout << ans << endl;\n\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define rep1(i,n) for(int i=1;i<=(int)(n);i++)\n#define all(c) c.begin(),c.end()\n#define pb push_back\n#define fs first\n#define sc second\n#define show(x) cout << #x << \" = \" << x << endl\n#define chmin(x,y) x=min(x,y)\n#define chmax(x,y) x=max(x,y)\nusing namespace std;\nint T,t[30],N,d[101],m[101];\nint dp[101][30];\nmap<int,int> mp;\nint main(){\n\twhile(true){\n\t\tcin>>T;\n\t\tif(T==0) break;\n\t\trep(i,T) cin>>t[i];\n\t\tcin>>N;\n\t\tmp.clear();\n\t\trep(i,N){\n\t\t\tint x,y;\n\t\t\tcin>>x>>y;\n\t\t\tif(!mp.count(x-1)||mp[x-1]>y) mp[x-1]=y;\n\t\t}\n\t\tN=0;\n\t\tfor(auto p:mp){\n\t\t\td[N]=p.fs,m[N]=p.sc;\n\t\t\tN++;\n\t\t}\n\t\trep(i,N+1) rep(j,T) dp[i][j]=1e9;\n\t\tdp[0][0]=0;\n\t\trep(i,N) rep(j,T){\n\t\t\tint c=j+d[i];\n\t\t\tif(i>0) c-=d[i-1];\n\t\t\tc%=T;\n\t\t\tif(t[c]<=m[i]) chmin(dp[i+1][c],dp[i][j]);\n\t\t\tchmin(dp[i+1][0],dp[i][j]+1);\n\t\t}\n\t\tint ans=1e9;\n\t\trep(j,T) chmin(ans,dp[N][j]);\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <sstream>\n#include <fstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <climits>\n#include <cfloat>\nusing namespace std;\n\nconst int INF = INT_MAX / 2;\n\nint main()\n{\n    for(;;){\n        int cycle;\n        cin >> cycle;\n        if(cycle == 0)\n            return 0;\n\n        vector<int> t(cycle);\n        for(int i=0; i<cycle; ++i)\n            cin >> t[i];\n\n        int n;\n        cin >> n;\n        vector<int> interview(101, 24);\n        for(int i=0; i<n; ++i){\n            int d, m;\n            cin >> d >> m;\n            interview[d] = min(interview[d], m);\n        }\n\n        vector<vector<int> > dp(101, vector<int>(cycle, INF));\n        dp[0][cycle-1] = 0;\n        for(int d=1; d<=100; ++d){\n            for(int prev=0; prev<cycle; ++prev){\n                int curr = (prev + 1) % cycle;\n                if(t[curr] <= interview[d])\n                    dp[d][curr] = min(dp[d][curr], dp[d-1][prev]);\n                dp[d][0] = min(dp[d][0], dp[d-1][prev] + 1);\n            }\n        }\n\n        cout << *min_element(dp[100].begin(), dp[100].end()) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint T;\nint t[102];\nint N;\nint D[102],M[102];\nint max_d;\n\nmap<int,int> jobs;\nint dp[102][102];\n\n// a??\\??????b?????????????????????\nint dfs(int a,int b) {\n    //printf(\"%d %d\\n\",a,b);\n    if(a==max_d+1) return 0;\n    if(dp[a][b]!=-1) return dp[a][b];\n\n    int ret=INF;\n    if(t[b]<=jobs[a+1]) ret=min(ret,dfs(a+1,(b+1)%T));\n    ret=min(ret,dfs(a+1,0)+1);\n\n    return dp[a][b]=ret;\n}\n\nvoid solve() {\n    jobs.clear();\n    max_d=0;\n    rep(i,N) {\n        max_d=max(max_d,D[i]);\n    }\n    rep(i,max_d+1) jobs[i]=INF;\n    rep(i,N) {\n        jobs[D[i]]=min(jobs[D[i]],M[i]);\n    }\n    memset(dp,-1,sizeof(dp));\n    cout<<dfs(1,0)<<endl;\n}\n\nint main() {\n    while(cin>>T) {\n        if(!T) break;\n        rep(i,T) cin>>t[i];\n        cin>>N;\n        rep(i,N) cin>>D[i]>>M[i];\n        solve();\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\nint n, m, t[33], a[103], e1, e2, dp[103][33];\nint main() {\n\twhile (cin >> n, n) {\n\t\tfill(a, a + 100, 24);\n\t\tfor (int i = 0; i < n; i++) cin >> t[i];\n\t\tcin >> m;\n\t\tfor (int i = 0; i < m; i++) cin >> e1 >> e2, e1--, a[e1] = min(a[e1], e2);\n\t\tfor (int i = 1; i <= 100; i++) {\n\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\tdp[i][j] = 999999999;\n\t\t\t\tif (j == 0) dp[i][j] = dp[i - 1][j] + 1;\n\t\t\t\tif (a[i - 1] >= t[j]) dp[i][j] = min(dp[i][j], dp[i - 1][(j + n - 1) % n]);\n\t\t\t}\n\t\t}\n\t\tint ret = *min_element(dp[100], dp[100] + n);\n\t\tcout << ret << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//03\n#include<iostream>\n#include<algorithm>\n\nusing namespace std;\n\nint nt;\nint t[30];\nint m[101];\n\nint gd(int d){\n  for(int i=0;i+d<=100;i++){\n    if(t[i%30]>m[d+i])return d+i;\n  }\n  return 999;\n}\n\nint main(){\n  while(cin>>nt,nt){\n    for(int i=0;i<nt;i++){\n      cin>>t[i];\n    }\n    fill(m,m+101,24);\n    int n;\n    cin>>n;\n    while(n--){\n      int d,mm;\n      cin>>d>>mm;\n      m[d]=min(m[d],mm);\n    }\n    int cd=1;\n    int nc=0;\n    for(;;){\n      int dl=gd(cd);\n      if(dl==999)break;\n      int ml=0,x;\n      for(int i=1;i+cd<=dl;i++){\n\tint id=gd(i+cd);\n\tif(id>ml){\n\t  ml=id;\n\t  x=i+cd;\n\t}\n      }\n      cd=x;\n      nc++;\n    }\n    cout<<nc<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint main(int argc, char *argv[]){\n  int T;\n  cin >> T;\n  int t[T];\n  for (int i = 0; i < T; i++) {\n    cin >> t[i];\n  }\n  int n;\n  cin >> n;\n  int d[n], m[n];\n  for (int i = 0; i < n; i++) {\n    cin >> d[i] >> m[i];\n  }\n  int dp[T][n + 1];//cycle, day\n  for (int i = 0; i < T; i++) {\n    for (int j = 0; j <= n; j++) {\n      dp[i][j] = 1e9;\n    }\n  }\n\n  dp[0][0] = 0;\n  for (int i = 0; i < T; i++) {\n    int day = 0;\n    for (int j = 0; j < n; j++) {\n      if(d[day] != j + 1){\n        dp[(i + 1) % T][j + 1] =\n          min(dp[(i + 1) % T][j + 1], dp[i][j]);\n        dp[0][j + 1] = min(dp[0][j + 1], dp[i][j] + 1);\n      }else{\n        if(m[day] >= t[i] && m[day] >= t[0]){\n          dp[(i + 1) % T][j + 1] =\n            min(dp[(i + 1) % T][j + 1], dp[i][j]);\n          dp[0][j + 1] = min(dp[0][j + 1], dp[i][j] + 1);\n        }else if(m[day] >= t[i] && m[day] < t[0]){\n          dp[(i + 1) % T][j + 1] =\n            min(dp[(i + 1) % T][j + 1], dp[i][j]);\n        }else if(m[day] < t[i] && m[day] >= t[0]){\n          dp[0][j + 1] = min(dp[0][j + 1], dp[i][j] + 1);\n        }\n        day++;\n      }\n    }\n  }\n  int ans = 1e9;\n  // for (int i = 0; i < T; i++) {\n  //   for (int j = 0; j <= n; j++) {\n  //     std::cout << dp[i][j] << \" \";\n  //   }\n  //   std::cout << std::endl;\n  // }\n  for (int i = 0; i < T; i++) {\n    ans = min(ans, dp[i][n]);\n  }\n  std::cout << ans << std::endl;\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\nusing namespace std;\n \n#define REP(i,n) for(int i=0; i<n; ++i)\n#define FOR(i,a,b) for(int i=a; i<=b; ++i)\n#define FORR(i,a,b) for (int i=a; i>=b; --i)\n#define pi M_PI\n#define EPS 1e-10\n \ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef vector<VI> VVI;\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> PL;\n\nconst int INF = 1e9;\n\nint main() {\n    int m, n;\n    while (cin >> m && m){\n        VI t(m), h(101,24);\n        REP(i,m) cin >> t[i];\n        cin >> n;\n        REP(i,n){\n            int d, m;\n            cin >> d >> m;\n            d--;\n            h[d] = m;\n        }\n        VVI dp(101,VI(m,INF));\n        dp[0][0] = 0;\n        REP(i,100) REP(j,m){\n            dp[i+1][0] = min(dp[i+1][0], dp[i][j] + 1);\n            if (t[(j+1)%m] <= h[i+1])\n                dp[i+1][(j+1)%m] = min(dp[i+1][(j+1)%m], dp[i][j]);\n        }\n        int ans = INF;\n        REP(j,m) ans = min(ans, dp[100][j]);\n        cout << ans << endl;\n\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nint main(){\n  int T;\n  while(cin >> T, T){\n    vector<int> t(T);\n    for(int i = 0; i < T; ++i){\n      cin >> t[i];\n    }\n    int N;\n    cin >> N;\n    int d, m;\n    vector< pair<int,int> > V;\n    for(int i = 0; i < N; ++i){\n      cin >> d >> m;\n      --d;\n      V.emplace_back(d,m);\n    }\n    sort(V.begin(), V.end());\n    int ans = -1, e = N;\n    while(e > 0){\n      for(int k = 0; k <= V[N-1].first; ++k){\n        int tmp = -1;\n        bool f = false;\n        for(int i = 0; i < e; ++i){\n          if(V[i].first < k) continue;\n          if(tmp == -1 && V[i].first >= k){\n            tmp = i;\n            f = true;\n          }\n          if(V[i].second < t[(V[i].first-k)%T]){\n            f = false;\n            break;\n          }\n        }\n        if(f){\n          e = tmp;\n          ++ans;\n        }\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define INF 1e8\n#define s second\n#define f first\nusing namespace std;\nint main(){\n  int t,n;\n  while(cin>>t,t){\n    int cy[t];\n    r(i,t)cin>>cy[i];\n    cin>>n;\n    int d[101];\n    r(i,101)d[i]=INF;\n    r(i,n){\n      int p1,p2;\n      cin>>p1>>p2;\n      d[p1]=min(d[p1],p2);\n    }\n    int dp[101][30];\n    r(i,30)r(j,101)dp[j][i]=INF;\n    dp[1][0]=0;\n    for(int i=2;i<101;i++){\n      dp[i][0]=dp[i-1][t-1];\n      r(j,t-1)dp[i][0]=min(dp[i][0],dp[i-1][j]+1);\n      for(int j=1;j<t;j++)\n        if(d[i]<cy[j])dp[i][j]=INF;\n        else dp[i][j]=dp[i-1][j-1];\n    }\n    int ans=INF;\n    r(i,30)ans=min(ans,dp[100][i]);\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <vector>\n#include <complex>\n#include <queue>\n#include <deque>\n#include <set>\n#include <map>\n#include <unordered_set>\n#include <unordered_map>\n#include <iomanip>\n#include <assert.h>\n#include <array>\n#include <cstdio>\n#include <cstring>\n#include <random>\n#include <functional>\n#include <numeric>\n#include <bitset>\n\nusing namespace std;\n\nstruct before_main{before_main(){cin.tie(0); ios::sync_with_stdio(false);}} before_main;\n\n#define REP(i,a,b) for(int i=a;i<(int)b;i++)\n#define rep(i,n) REP(i,0,n)\n#define all(c) (c).begin(), (c).end()\n#define zero(a) memset(a, 0, sizeof a)\n#define minus(a) memset(a, -1, sizeof a)\ntemplate<class T1, class T2> inline bool minimize(T1 &a, T2 b) { return b < a && (a = b, 1); }\ntemplate<class T1, class T2> inline bool maximize(T1 &a, T2 b) { return a < b && (a = b, 1); }\n\ntemplate<class T, class U, class Compare>\nvoid pair_sort(vector<T>& a, vector<U>& b, Compare comp) {\n  vector<pair<T, U>> v;\n  rep(i, a.size()) v.emplace_back(a[i], b[i]);\n  sort(v.begin(), v.end(), comp);\n  rep(i, a.size()) tie(a[i], b[i]) = v[i];\n}\ntemplate<class T, class U>\nvoid pair_sort(vector<T>& a, vector<U>& b) {\n  pair_sort(a, b, std::less<pair<T, U>>());\n}\n\ntypedef long long ll;\nint const inf = 1<<29;\n\nint T, N;\nvector<int> t;\nvector<int> M;\n\nint solve() {\n\n  static int dp[2][33]; rep(i, 2) rep(j, 33) dp[i][j] = inf;\n\n  dp[0][0] = 0;\n  \n  rep(i, N) {\n    rep(j, 33) dp[(i+1)&1][j] = inf;\n    rep(j, T) {\n      if(t[j] <= M[i]) {\n        minimize(dp[(i+1)&1][(j+1)%T], dp[i&1][j]);\n      }\n      minimize(dp[(i+1)&1][1%T], dp[i&1][j] + 1);\n    }\n  }\n\n  return *min_element(dp[N&1], dp[N&1] + 33);\n}\n\nint main() {\n\n  for(; cin >> T && T;) {\n    t.clear();\n    t.resize(T);\n    rep(i, T) cin >> t[i];\n    cin >> N;\n    M.clear();\n    M.resize(N, inf);\n    rep(i, N) {\n      int d, m; cin >> d >> m; d --;\n      minimize(M[d], m);\n    }\n    cout << solve() << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef vector<int> vec;\ntypedef vector<vec> mat;\n\nconst int INF = 1 << 28;\n\nint N, T;\n\nvoid solve() {\n    vec t(T);\n    for (auto& i : t) cin >> i;\n    cin >> N;\n    vec d(N), h(N);\n    for (int i = 0; i < N; i++) {\n        cin >> d[i] >> h[i];\n        d[i]--;\n    }\n\n    vec times(101, INF);\n    for (int i = 0; i < N; i++) {\n        times[d[i]] = min(times[d[i]], h[i]);\n    }\n\n    mat dp(101, vec(T, INF));\n    dp[0][0] = 0;\n    for (int i = 0; i < 100; i++) {\n        for (int j = 0; j < T; j++) {\n            if (dp[i][j] == INF) continue;\n            int next = (j + 1) % T;\n            // use\n            dp[i+1][0] = min(dp[i+1][0], dp[i][j] + 1);\n            // do not using\n            if (t[next] <= times[i]) {\n                dp[i+1][next] = min(dp[i+1][next], dp[i][j]);\n            }\n        }\n    }\n\n    int ans = INF;\n    for (int i = 0; i < T; i++) {\n        ans = min(ans, dp[T][i]);\n    }\n\n    cout << ans << endl;\n}\n\nint main() {\n    while (cin >> T, T) solve();\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<map>\n#include<algorithm>\nusing namespace std;\n\nint T,N;\nint t[30];\nint dp[101][30];\nint mask[101];\n\nconst int INF = 1e8;\n\nvoid init(){\n  for(int i = 0 ; i < 101 ; i++)mask[i] = 0;\n}\n\nvoid input(){\n  for(int i = 0 ; i < T ; i++){\n    cin >> t[i];\n  }\n  cin >> N;\n  for(int i = 0 ; i < N ; i++){\n    int d,m;\n    cin >> d >> m;\n    d--;\n    mask[d] |= (1 << m);\n  }\n}\n\nvoid solve(){\n  init();\n  input();\n  for(int i = 0 ; i < 101 ; i++){\n    for(int j = 0 ; j < 30 ; j++){\n      dp[i][j] = INF;\n    }\n  }\n\n  dp[0][0] = 0;\n\n  for(int i = 0 ; i < N ; i++){\n    for(int j = 0 ; j < T ; j++){\n      if(dp[i][j] == INF)continue;\n      int bit = ((1 << t[j])-1);\n      if(bit & mask[i])continue;\n      dp[i+1][0] = min(dp[i+1][0],dp[i][j] + 1);\n      dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T],dp[i][j]);\n    }\n  }\n  int res = INF;\n  for(int i = 0 ; i < T ; i++){\n    res = min(res,dp[N][i]);\n  }\n  cout << res << endl;\n}\n\nint main(){\n  while(cin >> T,T){\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define rep(i, n) for (int i = 0; i < int(n); ++i)\n\nint main() {\n  while (true) {\n    int t;\n    cin >> t;\n    if (t == 0) break;\n    int k[t];\n    rep (i, t) cin >> k[i];\n    int n;\n    cin >> n;\n    pair<int, int> d[n + 1];\n    d[0] = make_pair(0, 0);\n    rep (i, n) cin >> d[i + 1].first >> d[i + 1].second;\n    sort(d, d + n + 1);\n    int dp[n + 1][t];\n    rep (i, n + 1) rep (j, t) dp[i][j] = 1e9;\n    dp[0][0] = 0;\n    rep (i, n) rep (j, t) {\n      int kk = j + d[i + 1].first - d[i].first;\n      kk %= t;\n      if (k[kk] <= d[i].second) dp[i + 1][kk] = min(dp[i + 1][kk], dp[i][j]);\n      dp[i + 1][0] = min(dp[i + 1][0], dp[i][j] + 1);\n    }\n    int res = 1e9;\n    rep (i, t) res = min(res, dp[n][i]);\n    cout << res << endl;\n    break;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n\nusing namespace std;\n\n#define FOR(i,k,n) for(int i=(k); i<(int)(n); ++i)\n#define REP(i,n) FOR(i,0,n)\n#define FORIT(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n\ntemplate<class T> void debug(T begin, T end){ for(T i = begin; i != end; ++i) cerr<<*i<<\" \"; cerr<<endl; }\ninline bool valid(int x, int y, int W, int H){ return (x >= 0 && y >= 0 && x < W && y < H); }\n\ntypedef long long ll;\nconst int INF = 100000000;\nconst double EPS = 1e-8;\nconst int MOD = 1000000007;\nint dx[8] = {1, 0, -1, 0, 1, -1, -1, 1};\nint dy[8] = {0, 1, 0, -1, 1, 1, -1, -1};\n\nint main(){\n  int T;\n  while(cin>>T && T){\n    vector<int> t(T);\n    REP(i, T) cin>>t[i];\n    int N;\n    cin>>N;\n    int start[100] = {};\n    REP(i, 100) start[i] = 24;\n    REP(i, N) {\n      int D, M;\n      cin>>D>>M;\n      start[D-1] = min(start[D-1], M);\n    }\n    int dp[101][30] = {};\n    REP(i, 101) fill(dp[i], dp[i] + 30, INF);\n    dp[0][T - 1] = 0;\n    REP(i, 100){\n      REP(j, T)if(dp[i][j] < INF){\n        int k = (j + 1) % T;\n        dp[i + 1][0] = min(dp[i + 1][0], dp[i][j] + 1);\n        if(t[k] <= start[i]) dp[i + 1][k] = min(dp[i + 1][k], dp[i][j]);\n      }\n    }\n    int ans = INF;\n    REP(i, T) ans = min(ans, dp[100][i]);\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\nconst int INF = numeric_limits<int>::max() / 2;\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tint T;\n\twhile (true) {\n\t\tcin >> T;\n\t\tif (T == 0) break;\n\t\tvector<int> t(30);\n\t\tfor (int i = 0; i < T; i++) cin >> t[i];\n\t\tint n; cin >> n;\n\t\tvector<int> m(110, 24);\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tint di, mi; cin >> di >> mi;\n\t\t\tm[di] = min(m[di],mi);\n\t\t}\n\t\tVVI dp(110, vector<int>(T, INF));\n\t\tdp[1][0] = 0;\n\t\tfor (int i = 2; i <= 100; i++) {\n\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\tdp[i][0] = min(dp[i][0], dp[i - 1][j] + 1);\n\t\t\t\tif (m[i] >= t[j]) dp[i][j] = min(dp[i][j], dp[i - 1][(j + T - 1) % T]);\n\t\t\t}\n\t\t}\n\t\tint res = INF;\n\t\tfor (int i = 0; i < T; i++) res = min(res, dp[100][i]);\n\t\tcout << res << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define syosu(x) fixed<<setprecision(x)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned int uint;\ntypedef unsigned long long ull;\ntypedef pair<int,int> P;\ntypedef pair<double,double> pdd;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<string> vs;\ntypedef vector<P> vp;\ntypedef vector<vp> vvp;\ntypedef vector<pll> vpll;\ntypedef pair<int,P> pip;\ntypedef vector<pip> vip;\nconst int inf=1<<29;\nconst ll INF=1ll<<60;\nconst double pi=acos(-1);\nconst double eps=1e-9;\nconst ll mod=1e9+7;\nconst int dx[4]={-1,0,1,0},dy[4]={0,-1,0,1};\n\nclass Graph{\n\tprivate:\n\tint n;\n\tvvp g;\n\tpublic:\n\tvi DIJ(int s){\n\t\tpriority_queue<P> q;\n\t\tvi d(n,inf);\n\t\td[s]=0;\n\t\tq.push({0,s});\n\t\twhile(!q.empty()){\n\t\t\tP p=q.top();\n\t\t\tq.pop();\n\t\t\tint v=p.second;\n\t\t\tif(d[v]<-p.first) continue;\n\t\t\tfor(auto i:g[v]){\n\t\t\t\tint u=i.first,D=d[v]+i.second;\n\t\t\t\tif(d[u]>D){\n\t\t\t\t\td[u]=D;\n\t\t\t\t\tq.push({-D,u});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn d;\n\t}\n\tGraph(int v){\n\t\tn=v;\n\t\tg=vvp(v);\n\t}\n\tvoid add_edge(int s,int t,int c){\n\t\tg[s].push_back({t,c});\n\t\tg[t].push_back({s,c});\n\t}\n};\n\nint n;\n\nint main(){\n\tios::sync_with_stdio(0);\n\tcin.tie(0);\n\twhile(1){\n\t\tint n,m;\n\t\tcin>>n;\n\t\tif(n==0) break;\n\t\tvi a(n);\n\t\tfor(auto &i:a) cin>>i;\n\t\tcin>>m;\n\t\tconst int M=101;\n\t\tvi b(M,inf);\n\t\tfor(int i=0;i<m;i++){\n\t\t\tint x,y;\n\t\t\tcin>>x>>y;\n\t\t\tb[x-1]=min(b[x-1],y);\n\t\t}\n\t\tvi dp(n,inf);\n\t\tdp[n-1]=0;\n\t\tfor(int i=0;i<M;i++){\n\t\t\tvi DP(n,inf);\n\t\t\tfor(int j=0;j<n;j++) if(dp[j]<inf){\n\t\t\t\tint I=(j+1)%n;\n\t\t\t\tif(a[I]<=b[i]) DP[I]=min(DP[I],dp[j]);\n\t\t\t\tDP[0]=min(DP[0],dp[j]+1);\n\t\t\t}\n\t\t\tdp=DP;\n//\t\t\tfor(auto j:dp) cout<<j<<' ';cout<<endl;\n\t\t}\n\t\tint res=inf;\n\t\tfor(auto i:dp) res=min(res,i);\n\t\tcout<<res<<endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <fstream>\n#include <iomanip>\n#include <iostream>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <valarray>\n#include <vector>\n\n#define EPS 1e-9\n#define INF 1070000000LL\n#define MOD 1000000007LL\n#define fir first\n#define foreach(it,X) for(__typeof((X).begin()) it=(X).begin();it!=(X).end();it++)\n#define ite iterator\n#define mp make_pair\n#define rep(i,n) rep2(i,0,n)\n#define rep2(i,m,n) for(int i=m;i<(n);i++)\n#define pb push_back\n#define sec second\n#define sz(x) ((int)(x).size())\n\nusing namespace std;\n\nstruct timer{\n\ttime_t start;\n\ttimer(){start=clock();}\n\t~timer(){cerr<<1.*(clock()-start)/CLOCKS_PER_SEC<<\" secs\"<<endl;}\n};\n\ntypedef istringstream iss;\ntypedef long long ll;\ntypedef pair<int,int> pi;\ntypedef stringstream sst;\ntypedef vector<int> vi;\n\nint T,t[33],d=100,h[111];\nint dp[111][33];\n\nint f(int cur,int cycle){\n\tint& res=dp[cur][cycle];\n\tif(res!=-1)return res;\n\tif(cur==d)return res=0;\n\tif(h[cur]<t[cycle])return res=INF;\n\treturn res=min(f(cur+1,(cycle+1)%T),1+f(cur+1,0));\n}\n\nint main(){\n\tcin.tie(0);\n\tios_base::sync_with_stdio(0);\n\t\n\twhile(cin>>T && T){\n\t\trep(i,T)cin>>t[i];\n\t\trep(i,d)h[i]=INF;\n\t\tint N;\n\t\tcin>>N;\n\t\trep(i,N){\n\t\t\tint D,M;\n\t\t\tcin>>D>>M;\n\t\t\tD--;\n\t\t\th[D]=min(h[D],M);\n\t\t}\n\t\tmemset(dp,-1,sizeof(dp));\n\t\tcout<<f(0,0)<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <utility>\n#include <algorithm>\nusing namespace std;\n\nint main(){\n  int T;\n  while(cin >> T, T){\n    vector<int> t(T);\n    for(int i = 0; i < T; ++i){\n      cin >> t[i];\n    }\n    int N;\n    cin >> N;\n    int d, m;\n    vector< pair<int,int> > V;\n    for(int i = 0; i < N; ++i){\n      cin >> d >> m;\n      --d;\n      V.emplace_back(d,m);\n    }\n    sort(V.begin(), V.end());\n    int ans = 0, e = N;\n    while(e > 0){\n      for(int k = 0; k <= V[e-1].first; ++k){\n        int tmp = -1;\n        bool f = false;\n        for(int i = 0; i < e; ++i){\n          if(V[i].first < k) continue;\n          if(tmp == -1){\n            tmp = i;\n            f = true;\n          }\n          if(V[i].second < t[(V[i].first-k)%T]){\n            f = false;\n            break;\n          }\n        }\n        if(f){\n          e = tmp;\n          if(k != 0) ++ans;\n          break;\n        }\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MAX 105\n#define INF (1<<26)\nint T,N;\nint t[MAX],M[MAX];\nint mem[MAX][MAX];\n\nint solve(int x,int y){\n  if(mem[x][y]!=-1)return mem[x][y];\n  if(x==100)return 0;\n  int res=solve(x+1,1)+1;\n  if(t[y]<=M[x])res=min(res,solve(x+1,(y+1)%T));\n  return mem[x][y]=res;\n}\n\nvoid init(){\n  for(int i=0;i<MAX;i++){\n    M[i]=INF;\n    for(int j=0;j<MAX;j++){\n      mem[i][j]=-1;\n    }\n  }\n}\nint main(){\n  while(1){\n    cin>>T;\n    if(T==0)break;\n    init();\n    for(int i=0;i<T;i++)cin>>t[i];\n    cin>>N;\n    for(int i=0;i<N;i++){\n      int a,b;\n      cin>>a>>b;\n      M[a-1]=min(M[a-1],b);\n    }\n    cout<<solve(0,0)<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<algorithm>\nusing namespace std;\nint b[100];\nint d[110];\nint dp[110][31];\nint main(){\n\tint a;\n\twhile(scanf(\"%d\",&a),a){\n\t\tfor(int i=0;i<a;i++)scanf(\"%d\",b+i);\n\t\tint c;scanf(\"%d\",&c);\n\t\tfor(int i=0;i<110;i++)d[i]=-1;\n\t\tfor(int i=0;i<c;i++){\n\t\t\tint p,q;scanf(\"%d%d\",&p,&q);\n\t\t\tp--;d[p]=q;\n\t\t}\n\t\tfor(int i=0;i<110;i++)for(int j=0;j<31;j++)dp[i][j]=999999999;\n\t\tdp[0][0]=0;\n\t\tfor(int i=0;i<100;i++){\n\t\t\tfor(int j=0;j<a;j++){\n\t\t\t//\tprintf(\"%d %d: %d\\n\",i,j,dp[i][j]);\n\t\t\t\tif(!~d[i]||b[j]<=d[i])dp[i+1][(j+1)%a]=min(dp[i+1][(j+1)%a],dp[i][j]);\n\t\t\t\tdp[i+1][1]=min(dp[i+1][1],dp[i][j]+1);\n\t\t\t}\n\t\t}\n\t\tint ret=999999999;\n\t\tfor(int i=0;i<a;i++)ret=min(ret,dp[100][i]);\n\t\tprintf(\"%d\\n\",ret);\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n//00:15\n\nint T,N;\nint cycle[31];\nint day[301];\nint dp[301][31];\nint dfs(int x,int t){\n\tif( x == 300 ) return 0;\n\tif( dp[x][t] != -1 ) return dp[x][t];\n\tint ans = dfs(x+1,1%T) + 1;\n\tif( cycle[t] <= day[x] ){\n\t\tans = min(ans,dfs(x+1,(t+1)%T));\n\t}\n\treturn dp[x][t] = ans;\n}\n\nint main(){\n\twhile( cin >> T && T ){\n\t\tmemset(dp,-1,sizeof(dp));\n\t\tfor(int i = 0 ; i < 301 ; i++) \n\t\t\tday[i] = 1e9;\n\t\tfor(int i = 0 ; i < T ; i++){\n\t\t\tcin >> cycle[i];\n\t\t}\n\t\tcin >> N;\n\t\tfor(int i = 0 ; i < N ; i++){\n\t\t\tint d,m;\n\t\t\td--;\n\t\t\tcin >> d >> m;\n\t\t\tday[i] = min(day[i],m);\n\t\t}\n\t\tcout << dfs(0,0) << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\n#define int long long\nusing namespace std;\ntypedef pair<int, int> P;\nconst int INF = 1e9;\n\nint T, N;\nvector<int> t;\nint tm[110];\nint ed;\n\nint memo[110];\n\nint solve(int idx){\n    if(memo[idx] != -1) return memo[idx];\n    if(idx > ed) return 0;\n    int res = INF;\n    int startDay = idx;\n    rep(i, idx, ed + 1){\n        int nowDay = i;\n        int wake = t[(nowDay - startDay) % T];\n        // cout << idx << \" \" << i << ' ' << nowDay << \" \" << wake << endl;\n        if(wake > tm[i]) break;\n        int tmp = solve(i + 1);\n        res = min(res, tmp);\n    }\n    // cout << idx << ' ' << res + 1 << endl;\n    return memo[idx] = res + 1;\n}\n\nsigned main(){\n    while(cin >> T, T){\n        t.clear();\n        t.resize(T);\n        rep(i, 0, T) cin >> t[i];\n        cin >> N;\n        memset(memo, -1, sizeof(memo));\n        rep(i, 0, 110) tm[i] = INF;\n        rep(i, 0, N){\n            int a, b;\n            cin >> a >> b;\n            a--;\n            tm[a] = min(tm[a], b);\n        }\n        rep(i, 0, 110){\n            if(tm[i] == INF) continue;\n            ed = i;\n            // cout << \" \" << i << \" \" << tm[i] << endl;\n        }\n        int ans = solve(0);\n        cout << ans - 1 << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\nusing namespace std;\n\nint T;\nint n;\nint ti[101];\nint d[101];\nint dp[101][31];\nint finD;\n\nconst int INF=1000000000;\nint dfs(int pos,int tm){\n\tif(pos==finD+1)return 0;\n\tif(dp[pos][tm]!=-1)return dp[pos][tm];\n\tint res=INF;\n\t// JtFCðùÞ\n\tres=min(res,dfs(pos+1,1%T)+1);\n\t// ÔÉ¤êÍAùÜÈ¢Æ¢¤Iðà è\n\tif(d[pos]==-1||d[pos]>=ti[tm])res=min(res,dfs(pos+1,(tm+1)%T));\n\treturn dp[pos][tm]=res;\n}\n\nint main(){\n\n\twhile(cin>>T&&T){\n\t\tfor(int i=0;i<T;i++)cin>>ti[i];\n\t\tcin>>n;\n\t\tmemset(dp,-1,sizeof(dp));\n\t\tmemset(d,-1,sizeof(d));\n\t\tfinD=0;\n\t\tfor(int i=0;i<n;i++){\n\t\t\tint da,m;\n\t\t\tcin>>da>>m;\n\t\t\tfinD=max(finD,da);\n\t\t\td[da]=m;\n\t\t}\n\t\tint res=dfs(1,0);\n\t\tcout<<res<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i, n) for (int i = 0; i < int(n); ++i)\n#define all(c) (c).begin(), (c).end()\n\ntemplate <class T, class U>\ninline bool chmin(T& t, const U& f) { return t > f ? t = f, true : false; }\n\nconst int DMAX = 110, INF = 1 << 12;\n\nint solve(int T, const vector<int>& t, const vector<int>& interview) {\n    vector<int> dp(T, INF); dp[0] = 0;\n    for (const int& M : interview) {\n        vector<int> nxt(T, INF);\n        rep(i, T) {\n            if (i == T - 1) chmin(nxt[0], dp[i]);\n            else {\n                if (M >= t[i + 1]) chmin(nxt[i + 1], dp[i]);\n                chmin(nxt[0], dp[i] + 1);\n            }\n        }\n        dp.swap(nxt);\n    }\n    return *min_element(all(dp));\n}\n\nint main() {\n    int T; cin >> T;\n    vector<int> t(T);\n    for (int& e : t) cin >> e;\n    int N; cin >> N;\n    vector<int> interview(DMAX, INF);\n    while (N--) {\n        int D, M; cin >> D >> M;\n        chmin(interview[D], M);\n    }\n    cout << solve(T, t, interview) << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i, n) for (int i = 0; i < int(n); ++i)\n#define all(c) (c).begin(), (c).end()\n\ntemplate <class T, class U>\ninline bool chmin(T& t, const U& f) { return t > f ? t = f, true : false; }\n\nconst int DMAX = 110, INF = 1 << 12;\n\nint solve(int T, const vector<int>& t, const vector<int>& interview) {\n    vector<int> dp(T, INF); dp[0] = 0;\n    rep(i, DMAX) {\n        vector<int> nxt(T, INF);\n        rep(j, T) {\n            if (j == T - 1) chmin(nxt[0], dp[j]);\n            else if (interview[i] <= t[j]) chmin(nxt[0], dp[j] + 1);\n            else {\n                chmin(nxt[j + 1], dp[j]);\n                chmin(nxt[0], dp[j] + 1);\n            }\n        }\n        dp.swap(nxt);\n    }\n    return *min_element(all(dp));\n}\n\nint main() {\n    int T; cin >> T;\n    vector<int> t(T);\n    for (int& e : t) cin >> e;\n    int N; cin >> N;\n    vector<int> interview(DMAX, INF);\n    while (N--) {\n        int D, M; cin >> D >> M;\n        chmin(interview[D], M);\n    }\n    cout << solve(T, t, interview) << endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nconst int INF = 1<<28;\nconst int MAXD = 111;\nconst int MAXT = 31;\nint T;\nint t[MAXT], F[MAXD];\nint dp[MAXD][MAXT];\n\nint main() {\n  for(; cin >> T && T; ) {\n    for(int i = 0; i < T; ++i) {\n      cin >> t[i];\n    }\n    int N; cin >> N;\n    fill(F, F+MAXD, INF);\n    for(int i = 0; i < N; ++i) {\n      int D, M; cin >> D >> M;\n      F[D] = min(F[D], M);\n    }\n    fill(dp[0], dp[MAXD], INF);\n    dp[1][0] = 0;\n    for(int i = 1; i+1 < MAXD; ++i) {\n      for(int j = 0; j < T; ++j) {\n        dp[i+1][1%T] = min(dp[i+1][1%T], dp[i][j] + 1);\n        if(t[j] <= F[i]) {\n          dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T], dp[i][j]);\n        }\n      }\n    }\n    cout << *min_element(dp[MAXD-1], dp[MAXD]) << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nstruct node{\n\tint d,m;\n}data[1001];\nint T,t[101],n,f[101];\nbool cmp(node s1,node s2){\n\tif(s1.d==s2.d) return s1.m<s2.m;\n\treturn s1.d<s2.d;\n}\nint main(){\n\twhile(true){\n\t\tscanf(\"%d\",&T);\n\t\tif(T==0) return 0;\n\t\tfor(int i=1;i<=T;i++) scanf(\"%d\",&t[i]);\n\t\tscanf(\"%d\",&n);\n\t\tfor(int i=1;i<=n;i++)\n\t\t scanf(\"%d%d\",&data[i].d,&data[i].m);\n\t\tsort(data+1,data+1+n,cmp);\n\t\tfor(int i=1;i<=n;i++) f[i]=1e9;\n\t\tf[0]=-1;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tfor(int j=0;j<=i-1;j++){\n\t\t\t bool pd=1;\n\t\t\t for(int k=j+1;k<=i;k++){\n\t\t\t   int x=(data[k].d-data[j+1].d)%T+1;\n\t\t\t   if(t[x]>data[k].m) pd=false;\n\t\t\t  }\n\t\t\t if(pd) f[i]=min(f[j]+1,f[i]);\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",f[n]);\n\t}\n\treturn 0;\n}\n&#171; Back"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nint main(){\n  int tm,n;\n  while(cin >> tm,tm){\n    int i,j,k;\n    int t[tm];\n    for(i=0;i<tm;i++) cin >> t[i];\n    cin >> n;\n    int m[150]={};\n    fill(m,m+150,24);\n    for(i=1;i<=n;i++){\n      cin >> k;\n      cin >> m[k];\n    }\n    int inf = 1<<20;\n    int dp[150][50];\n    fill(dp[0],dp[149],inf);\n    dp[1][0]=0;\n    for(i=1;i<100;i++){\n      for(j=0;j<50;j++){\n\tif(dp[i][j]==inf) continue;\n\tdp[i+1][0]=min(dp[i+1][0],dp[i][j]+1);\n\t//cout <<i<<\":\"<<j<<\":\"<< t[(j+1)%tm]<<\":\"<<m[i]<<endl;\n\tif(t[(j+1)%tm]<=m[i+1]){\n\t  dp[i+1][(j+1)%tm]=min(dp[i+1][(j+1)%tm],dp[i][j]);\n\t}\n      }\n    }\n    int o=inf;\n    /*\n    for(j=1;j<=n+10;j++){\n      cout << j << \":\";\n      for(i=0;i<tm;i++) cout << dp[j][i] << (i==tm-1?\"\\n\":\" \");\n    }\n    */\n    for(i=0;i<50;i++) o=min(o,dp[101][i]);\n    cout << o << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nstatic const int INF = (1<<28);\n\nint T, t[30], N, D, M, dp[101][30], m[100];\n\nmain(){\n  while(cin >> T && T){\n    for(int i=0;i<T;i++) cin >> t[i];\n    cin >> N;\n    fill(m, m+N, INF);\n    for(int i=0;i<N;i++){\n      cin >> D >> M;\n      m[D-1] = min(m[D-1], M);\n    }\n    fill(dp[0], dp[101], INF);\n    dp[0][0] = 0;\n    for(int i=0;i<N;i++){\n      for(int j=0;j<T;j++){\n        if(t[j] <= m[i]) dp[i+1][(j+1)%T] = min(dp[i+1][(j+1)%T], dp[i][j]);\n        else dp[i+1][1] = min(dp[i+1][1], dp[i][j]+1);\n      }\n    }\n    int ans = INF;\n    for(int i=0;i<T;i++) ans = min(ans, dp[N][i]);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\n#define REP(i,n) for(ll i=0;i<n;++i)\n#define RREP(i,n) for(ll i=n-1;i>=0;--i)\n#define FOR(i,m,n) for(ll i=m;i<n;++i)\n#define RFOR(i,m,n) for(ll i=n-1;i>=m;--i)\n#define ALL(v) (v).begin(),(v).end()\n#define PB(a) push_back(a)\n#define UNIQUE(v) v.erase(unique(ALL(v)),v.end());\n#define DUMP(v) REP(aa, (v).size()) { cout << v[aa]; if (aa != v.size() - 1)cout << \" \"; else cout << endl; }\n#define INF 1000000001ll\n#define MOD 1000000007ll\n#define EPS 1e-9\n\nconst int dx[8] = { 1,1,0,-1,-1,-1,0,1 };\nconst int dy[8] = { 0,1,1,1,0,-1,-1,-1 };\n\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector<vi> vvi;\ntypedef vector<vl> vvl;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nll max(ll a, int b) { return max(a, ll(b)); }\nll max(int a, ll b) { return max(ll(a), b); }\nll min(ll a, int b) { return min(a, ll(b)); }\nll min(int a, ll b) { return min(ll(a), b); }\n///(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)///\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tint t;\n\twhile (cin >> t, t) {\n\t\tvi v(t);\n\t\tREP(i, t)cin >> v[i];\n\t\tint n; cin >> n;\n\t\tvi d(100,INF);\n\t\tREP(i, n) {\n\t\t\tint a, b;\n\t\t\tcin >> a >> b;\n\t\t\td[a - 1] = b;\n\t\t}\n\t\tint p = 100, cnt = 0;\n\t\twhile (p != 0) {\n\t\t\tREP(i, p) {\n\t\t\t\tint flag = 1;\n\t\t\t\tFOR(j, i, p) {\n\t\t\t\t\tif (v[(j-i)%t] > d[j])flag = 0;\n\t\t\t\t}\n\t\t\t\tif (flag) {\n\t\t\t\t\tp = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcnt++;\n\t\t}\n\t\tcout << cnt << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cctype>\n#include <complex>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iomanip>\n#include <iostream>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 29;\n\nconst int N = 101;\n\nint main(void){\n    for(int T, res; cin >> T, T;){\n        vi t(T);\n        rep(i, T) cin >> t[i];\n\n        int n; cin >> n;\n        vi m(N, 23);\n        rep(i, n){\n            int D, M; cin >> D >> M;\n            D--;\n            m[D] = min(m[D], M);\n        }\n\n        vvi dp(N, vi(T, inf));\n        dp[0][0] = 0;\n        range(i, 1, N){\n            rep(j, T){\n                if(dp[i - 1][j] == inf) continue;\n\n                dp[i][0] = min(dp[i][0], dp[i - 1][j] + 1);\n\n                int nextT = (j + 1) % T;\n                if(0 <= m[i] - t[nextT]){\n                    dp[i][nextT] = min(dp[i][nextT], dp[i - 1][j]);\n                }\n            }\n        }\n\n        cout << *min_element(all(dp[N - 1])) << endl;\n    }\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nint t;\nvector<int> s;\nvector<int> d(101);\n\nint dfs(int l) {\n    int r = 100;\n    for (int i = l; i < 100; i++) {\n        if (d[i] < s[(i-l)%t]) {\n            r = i;\n            break;\n        }\n    }\n    if (r == 100) return 0;\n    vector<int> ret;\n    for (int i = l+1; i < r+1; i++) {\n        bool f = true;\n        for (int j = i; j < r+1; j++) if (d[j] < s[(j-i)%t]) {\n            f = false;\n            break;\n        }\n        if (!f) continue;\n        ret.push_back(1 + dfs(i));\n    }\n    return *min_element(ret.begin(), ret.end());\n}\n\nint main() {\n    while (cin>>t && t) {\n        for (int i = 0; i < 101; i++) d[i] = 24;\n        s = vector<int>(t);\n        for (int i = 0; i < t; i++) cin >> s[i];\n        int n;\n        cin >> n;\n        for (int i = 0; i < n; i++) {\n            int a, b;\n            cin >> a >> b;\n            a--;\n            d[a] = min(d[a], b);\n        }\n        \n        cout << dfs(0) << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#define _CRT_SECURE_NO_WARNINGS\n#include \"bits/stdc++.h\"\nusing namespace std;\n\n//#define int int64_t\n\n#define CHOOSE(a) CHOOSE2 a\n#define CHOOSE2(a0,a1,a2,a3,x,...) x\n#define REP1(i, s, cond, cal) for (signed i = signed(s); i cond; i cal)\n#define REP2(i, s, n) REP1(i, s, < signed(n), ++)\n#define REP3(i, n) REP2(i, 0, n)\n#define rep(...) CHOOSE((__VA_ARGS__,REP1,REP2,REP3))(__VA_ARGS__)\n#define rrep(i, s) rep(i, s, >= 0, --)\n\n#define all(c) begin(c), end(c)\n#define maxup(ans, x) (ans = (ans < x ? x : ans))\n#define minup(ans, x) (ans = (ans > x ? x : ans))\n\n#define breakif(cond) if(cond) break; else\n\nusing VV = vector<vector<int>>;\nusing V = vector<int>;\nusing P = pair<int, int>;\nusing IP = pair<int, P>;\n\ntemplate<typename T>\ninline void input(vector<T>& v) { for (auto& x : v) cin >> x; }\n\nsigned main() {\n\tint t;\n\twhile (cin >> t && t) {\n\t\tV ts(t);\n\t\trep(i, t) {\n\t\t\tint x; cin >> x;\n\t\t\tts[i] = x;\n\t\t}\n\t\tint n; cin >> n;\n\t\tV ms(101, 1 << 29);\n\t\trep(i, n) {\n\t\t\tint d, m;\n\t\t\tcin >> d >> m;\n\t\t\tms[d - 1] = m;\n\t\t}\n\t\tVV dp(101, V(t, 1 << 29)); //dp[day][t_i]\n\n\t\tdp[0][0] = 0;\n\t\trep(i, 0, 100) rep(j, t) {\n\t\t\tminup(dp[i + 1][1 % t], dp[i][j] + 1);\n\t\t\tif(ts[j] <= ms[i]) minup(dp[i + 1][(j + 1) % t], dp[i][j]);\n\t\t}\n\t\tint ans = *min_element(all(dp[100]));\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n\nint T;\nint t_cycle[30];\nint limit_times[100];\n\nint memo[30][100];\n\nint search(int cycle,int day) {\n\tint ret,challenger;\n\tif(day>=100)return 0;\n\tif(memo[cycle][day]>0)return memo[cycle][day]-1;\n\t/* take anhydrous caffeine */\n\tret=search(1%T,day+1)+1;\n\t/* don't take anhydrous caffeine */\n\tif(t_cycle[cycle]<=limit_times[day]) {\n\t\tchallenger=search((cycle+1)%T,day+1);\n\t\tif(challenger<ret)ret=challenger;\n\t}\n\tmemo[cycle][day]=ret+1;\n\treturn ret;\n}\n\nint main(void) {\n\twhile(scanf(\"%d\",&T)==1 && T>0) {\n\t\tint N,i;\n\t\tmemset(memo,0,sizeof(memo));\n\t\tfor(i=0;i<T;i++) {\n\t\t\tif(scanf(\"%d\",&t_cycle[i])!=1)return 1;\n\t\t}\n\t\tif(scanf(\"%d\",&N)!=1)return 1;\n\t\tfor(i=0;i<100;i++)limit_times[i]=24;\n\t\tfor(i=0;i<N;i++) {\n\t\t\tint D,M;\n\t\t\tif(scanf(\"%d%d\",&D,&M)!=2)return 1;\n\t\t\tif(M<limit_times[D-1])limit_times[D-1]=M;\n\t\t}\n\t\tprintf(\"%d\\n\",search(0,0));\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#include<string.h>\n#define min(a,b) (a<b?a:b)\n#define max(a,b) (a>b?a:b)\nint T,t[30],N,I[100],d,m,i,j,C[100],s,D,mc;\nint main()\n{\n\tfor(;scanf(\"%d\",&T),T;)\n\t{\n\t\tmemset(I,-1,sizeof(I));\n\t\tmemset(C,0,sizeof(C));\n\t\tfor(i=0;i<T;i++)\n\t\t\tscanf(\"%d\",&t[i]);\n\t\tfor(scanf(\"%d\",&N),i=D=0;i<N;i++)\n\t\t{\n\t\t\tscanf(\"%d%d\",&d,&m);\n\t\t\tD=max(D,d-1);\n\t\t\tI[d-1]=I[d-1]==-1?m:min(I[d-1],m);\n\t\t}\n\t\tfor(i=D;i>=0;i--)\n\t\t\tfor(C[i]=1,j=i,s=0,mc=99;i<D;j++,s++)\n\t\t\t{\n\t\t\t\tif(i!=j)mc=min(mc,C[j]);\n\t\t\t\tif(t[s%T]>I[j])\n\t\t\t\t{\n\t\t\t\t\tC[i]+=mc;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\tprintf(\"%d\\n\",C[0]-1);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#include<string.h>\n#define min(a,b) (a<b?a:b)\n#define max(a,b) (a>b?a:b)\nint T,t[35],N,I[105],d,m,i,j,C[105],s,D,mc;\nint main()\n{\n\tfor(;scanf(\"%d\",&T),T;)\n\t{\n\t\tmemset(C,0,sizeof(C));\n\t\tfor(i=0;i<100;i++)I[i]=24;\n\t\tfor(i=0;i<T;i++)scanf(\"%d\",&t[i]);\n\t\tfor(scanf(\"%d\",&N),i=D=0;i<N;i++)\n\t\t{\n\t\t\tscanf(\"%d%d\",&d,&m);\n\t\t\tD=max(D,d-1);\n\t\t\tI[d-1]=min(I[d-1],m);\n\t\t}\n\t\tfor(i=D;i>=0;i--)\n\t\t\tfor(C[i]=1,j=i,s=0,mc=99;i<D;j++,s++)\n\t\t\t{\n\t\t\t\tif(i!=j)mc=min(mc,C[j]);\n\t\t\t\tif(t[s%T]>I[j])\n\t\t\t\t{\n\t\t\t\t\tC[i]+=mc;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\tprintf(\"%d\\n\",C[0]-1);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "// AOJ 2166: Erratic Sleep Habits\n// 2018.1.4 bal4u@uu\n\n#include <stdio.h>\n#include <string.h>\n\nint T;\nint t[31];\nchar tbl[101];\nint dp[101][101];\n\n//#define getchar_unlocked()  getchar()\nint in()\n{\n\tint n = 0;\n\tint c = getchar_unlocked();\n\tdo n = (n<<3)+(n<<1) + (c & 0xf), c = getchar_unlocked();\n\twhile (c >= '0');\n\treturn n;\n}\n\nint calc(int d, int c)\n{\n\tint i, k, c2, ans;\n\n\tif (d > 100) return 0;\n\tif (dp[d][c] >= 0) return dp[d][c];\n\ti = d+1;\n\tans = 1+calc(i, 0), c2 = c;\n\twhile (1) {\n\t\tif (i > 100) { ans = 0; break; }\n\t\tif (++c2 == T) c2 = 0;\n\t\tif (tbl[i] < t[c2]) break;\n\t\tk = 1+calc(++i, 0);\n\t\tif (k < ans) ans = k;\n\t}\n\treturn dp[d][c] = ans;\n}\n\nint main()\n{\n\tint N, d, m, i;\n\n\twhile (T = in()) {\n\t\tfor (i = 0; i < T; i++) t[i] = in();\n\t\tN = in();\n\t\tmemset(tbl, 24, sizeof(tbl));\n\t\tfor (i = 0; i < N; i++) {\n\t\t\td = in(), m = in();\n\t\t\tif (m < tbl[d]) tbl[d] = m;\n\t\t}\n\n\t\tmemset(dp, -1, sizeof(dp));\n\t\tprintf(\"%d\\n\", calc(1, 0));\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\n\tint MAX = 1001;\n\tint INF = 1000000000;\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tint T = in.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\t\n\t\t\tint[] t = in.nextIntArray(T);\n\t\t\tint N = in.nextInt();\n\t\t\tint[] D = new int[N];\n\t\t\tint[] M = new int[N];\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tD[i] = in.nextInt();\n\t\t\t\tM[i] = in.nextInt();\n\t\t\t}\n\t\t\t\n\t\t\tint[][] dp = new int[MAX+1][T];\n\t\t\tfor (int i = 0; i <= MAX; i++) Arrays.fill(dp[i], INF);\n\t\t\tdp[0][0] = 0;\n\t\t\t\n\t\t\tint cur = 0;\n\t\t\tfor (int i = 0; i < MAX && cur < N; i++) {\n\t\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\t\tint next = (j + 1) % T;\n\t\t\t\t\tif (i == D[cur] && t[j] <= M[cur]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t} else if (i != D[cur]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1%T] = Math.min(dp[i][j] + 1, dp[i+1][1%T]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tif (i == D[cur]) cur++;\n\t\t\t}\n\t\t\t\n\t\t\tcur--;\n\t\t\tint res = INF;\n\t\t\tfor (int i = 0; i < T; i++) \n\t\t\t\tres = Math.min(res, dp[D[cur]][i]);\n\t\t\tSystem.out.println(res);\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n */\npublic class Main {\n    public static void main(String[] args) {\n        InputStream inputStream = System.in;\n        OutputStream outputStream = System.out;\n        Scanner in = new Scanner(inputStream);\n        PrintWriter out = new PrintWriter(outputStream);\n        ErraticSleepHabits solver = new ErraticSleepHabits();\n        try {\n            int testNumber = 1;\n            while (true)\n                solver.solve(testNumber++, in, out);\n        } catch (UnknownError e) {\n            out.close();\n        }\n    }\n\n    static class ErraticSleepHabits {\n        public void solve(int testNumber, Scanner in, PrintWriter out) {\n            final int INF = (int) 1e9;\n            int T = in.nextInt();\n            if (T == 0) {\n                throw new UnknownError();\n            }\n            int[] t = new int[T]; // cycle\n            for (int i = 0; i < T; i++) {\n                t[i] = in.nextInt();\n            }\n            int N = in.nextInt();\n            int[] d = new int[101];\n            Arrays.fill(d, INF);\n            for (int i = 0; i < N; i++) {\n                int day = in.nextInt() - 1;\n                d[day] = Math.min(d[day], in.nextInt());\n            }\n            final int MAX_DAY = 100;\n            int[][] dp = new int[MAX_DAY][T];\n            for (int i = 0; i < MAX_DAY; i++) {\n                Arrays.fill(dp[i], INF);\n            }\n            dp[0][0] = 0;\n            for (int i = 0; i < MAX_DAY - 1; i++) {\n                for (int j = 0; j < T; j++) {\n                    if (dp[i][j] < INF) {\n                        int nxtCycle = (j + 1) % T;\n                        if (t[nxtCycle] <= d[i + 1]) {\n                            // サイクルリセットしない\n                            dp[i + 1][nxtCycle] = Math.min(dp[i + 1][nxtCycle], dp[i][j]);\n                        }\n                        if (t[0] <= d[i + 1]) {\n                            // サイクルリセットする\n                            dp[i + 1][0] = Math.min(dp[i + 1][0], dp[i][j] + 1);\n                        }\n                    }\n                }\n            }\n            int ans = 100;\n            for (int i = 0; i < T; i++) {\n                ans = Math.min(ans, dp[MAX_DAY - 1][i]);\n            }\n            out.println(ans);\n        }\n\n    }\n}\n\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.Scanner;\n\n//Erratic Sleep Habits\npublic class Main{\n\n\tint T, n, INF = 1<<29;\n\tint[] a, d;\n\tint[][] dp;\n\t\n\tint get(int k, int c){\n\t\tif(k==101)return 0;\n\t\tif(dp[k][c]!=-1)return dp[k][c];\n\t\tint res = get(k+1, 0)+1;\n\t\tint f = k+1, nc = (c+1)%T;\n\t\tfor(;f<=100;f++, nc=(nc+1)%T){\n\t\t\tif(d[f]<a[nc])break;\n\t\t\tres = Math.min(res, get(f+1, 0)+1);\n\t\t}\n\t\tif(100<f)res = 0;\n\t\treturn dp[k][c] = res;\n\t}\n\t\n\tvoid run(){\n\t\tScanner sc = new Scanner(System.in);\n\t\tfor(;;){\n\t\t\tT = sc.nextInt();\n\t\t\tif(T==0)break;\n\t\t\ta = new int[T];\n\t\t\tfor(int i=0;i<T;i++)a[i]=sc.nextInt();\n\t\t\tn = sc.nextInt();\n\t\t\td = new int[101];\n\t\t\tArrays.fill(d, INF);\n\t\t\tfor(int i=0;i<n;i++){\n\t\t\t\tint x = sc.nextInt();\n\t\t\t\td[x] = Math.min(d[x], sc.nextInt());\n\t\t\t}\n\t\t\tdp = new int[101][T];\n\t\t\tfor(int[]p:dp)Arrays.fill(p, -1);\n\t\t\tSystem.out.println(get(1, 0));\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main{\n\t\n\tprivate void doit(){\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n == 0) break;\n\t\t\tint [] cy = new int[n];\n\t\t\tfor(int i = 0; i < n; i++){\n\t\t\t\tcy[i] = sc.nextInt();\n\t\t\t}\n\t\t\tint m = sc.nextInt();\n\t\t\tint [] sche = new int[101];\n\t\t\tArrays.fill(sche, 23);\n\t\t\tfor(int i = 0; i < m; i++){\n\t\t\t\tint day = sc.nextInt();\n\t\t\t\tsche[day] = sc.nextInt();\n\t\t\t}\n\t\t\t\n\t\t\tint [][] dp = new int[101][n];\n\t\t\tint INF = 1 << 24;\n\t\t\tfor(int i = 0; i < 101; i++){\n\t\t\t\tArrays.fill(dp[i], INF);\n\t\t\t}\n\t\t\tdp[1][0] = 0;\n\t\t\tfor(int i = 1; i < 100; i++){\n\t\t\t\tfor(int j = 0; j < n; j++){\n\t\t\t\t\tif(dp[i][j] == INF) continue;\n\t\t\t\t\tif(cy[(j + 1) % n] <= sche[i + 1]){\n\t\t\t\t\t\tdp[i + 1][(j + 1) % n] = Math.min(dp[i][j], dp[i + 1][(j + 1) % n]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i + 1][0] = Math.min(dp[i + 1][0], dp[i][j] + 1);\n\t\t\t\t}\n\t\t\t}\n\t\t\tint min = INF;\n\t\t\tfor(int i = 0; i < n; i++){\n\t\t\t\tmin = Math.min(min, dp[100][i]);\n\t\t\t}\n\t\t\tSystem.out.println(min);\n\t\t}\n\t}\n\n\tprivate void debug(Object... o) {\n\t\tSystem.out.println(\"debug = \" + Arrays.deepToString(o));\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().doit();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tstatic Scanner sc = new Scanner(System.in);\n\n\tpublic static void main(String[] arg) {\n\t\twhile (true) {\n\t\t\tint T = sc.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\tint[] t = new int[T];\n\t\t\tfor (int i = 0; i < T; ++i) {\n\t\t\t\tt[i] = sc.nextInt();\n\t\t\t}\n\t\t\tfinal int INF = 1 << 30;\n\t\t\tint N = sc.nextInt();\n\t\t\tint[] time = new int[101];\n\t\t\tArrays.fill(time, INF);\n\t\t\tfor (int i = 0; i < N; ++i) {\n\t\t\t\tint d = sc.nextInt();\n\t\t\t\tint m = sc.nextInt();\n\t\t\t\ttime[d] = Math.min(time[d], m);\n\t\t\t}\n\t\t\tint[][] dp = new int[101][T];\n\t\t\tfor (int[] a : dp) {\n\t\t\t\tArrays.fill(a, INF);\n\t\t\t}\n\t\t\tdp[0][T - 1] = 0;\n\t\t\tfor (int i = 1; i <= 100; ++i) {\n\t\t\t\tint m = time[i];\n\t\t\t\tfor (int j = 0; j < T; ++j) {\n\t\t\t\t\tif (t[(j + 1) % T] <= m) dp[i][(j + 1) % T] = Math.min(dp[i][(j + 1) % T], dp[i - 1][j]);\n\t\t\t\t\tdp[i][0] = Math.min(dp[i][0], dp[i - 1][j] + 1);\n\t\t\t\t}\n\t\t\t}\n\t\t\tint ans = INF;\n\t\t\tfor (int i = 0; i < T; ++i) {\n\t\t\t\tans = Math.min(ans, dp[100][i]);\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n */\npublic class Main {\n    public static void main(String[] args) {\n        InputStream inputStream = System.in;\n        OutputStream outputStream = System.out;\n        Scanner in = new Scanner(inputStream);\n        PrintWriter out = new PrintWriter(outputStream);\n        ErraticSleepHabits solver = new ErraticSleepHabits();\n        try {\n            int testNumber = 1;\n            while (true)\n                solver.solve(testNumber++, in, out);\n        } catch (UnknownError e) {\n            out.close();\n        }\n    }\n\n    static class ErraticSleepHabits {\n        public void solve(int testNumber, Scanner in, PrintWriter out) {\n            final int INF = (int) 1e9;\n            int T = in.nextInt();\n            if (T == 0) {\n                throw new UnknownError();\n            }\n            int[] t = new int[T]; // cycle\n            for (int i = 0; i < T; i++) {\n                t[i] = in.nextInt();\n            }\n            int N = in.nextInt();\n            int[] d = new int[101];\n            Arrays.fill(d, INF);\n            for (int i = 0; i < N; i++) {\n                int day = in.nextInt();\n                d[day] = Math.min(d[day], in.nextInt());\n            }\n            final int MAX_DAY = 100;\n            int[][] dp = new int[MAX_DAY][T];\n            for (int i = 0; i < MAX_DAY; i++) {\n                Arrays.fill(dp[i], INF);\n            }\n            dp[0][0] = 0;\n            for (int i = 0; i < MAX_DAY - 1; i++) {\n                for (int j = 0; j < T; j++) {\n                    if (dp[i][j] < INF) {\n                        int nxtCycle = (j + 1) % T;\n                        if (t[nxtCycle] <= d[i]) {\n                            // サイクルリセットしない\n                            dp[i + 1][nxtCycle] = Math.min(dp[i + 1][nxtCycle], dp[i][j]);\n                        }\n                        if (t[0] <= d[i]) {\n                            // サイクルリセットする\n                            dp[i + 1][0] = Math.min(dp[i + 1][0], dp[i][j] + 1);\n                        }\n                    }\n                }\n            }\n            int ans = 100;\n            for (int i = 0; i < T; i++) {\n                ans = Math.min(ans, dp[MAX_DAY - 1][i]);\n            }\n            out.println(ans);\n        }\n\n    }\n}\n\n\n"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\n\tint MAX = 1001;\n\tint INF = 1000000000;\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tint T = in.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\t\n\t\t\tint[] t = in.nextIntArray(T);\n\t\t\tint N = in.nextInt();\n\t\t\tint[] D = new int[N];\n\t\t\tint[] M = new int[N];\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tD[i] = in.nextInt();\n\t\t\t\tM[i] = in.nextInt();\n\t\t\t}\n\t\t\t\n\t\t\tint[][] dp = new int[MAX+1][T];\n\t\t\tfor (int i = 0; i <= MAX; i++) Arrays.fill(dp[i], INF);\n\t\t\tdp[0][0] = 0;\n\t\t\t\n\t\t\tint cur = 0;\n\t\t\tfor (int i = 0; i < MAX && cur < N; i++) {\n\t\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\t\tint next = (j + 1) % T;\n\t\t\t\t\tif (i == D[cur] && ((t[j] + 20) % 24 < M[cur] || t[j] <= 4)) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t} else if (i != D[cur]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1] = Math.min(dp[i][j] + 1, dp[i+1][1]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tif (i == D[cur]) cur++;\n\t\t\t}\n\t\t\t\n\t\t\tcur--;\n\t\t\tint res = INF;\n\t\t\tfor (int i = 0; i < T; i++) \n\t\t\t\tres = Math.min(res, dp[D[cur]][i]);\n\t\t\tSystem.out.println(res);\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\nimport javax.swing.undo.StateEdit;\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\n\tclass State implements Comparable<State> {\n\t\tint d, m;\n\n\t\tState(int d, int m) {\n\t\t\tthis.d = d;\n\t\t\tthis.m = m;\n\t\t}\n\n\t\tpublic int compareTo(State s) {\n\t\t\treturn d - s.d;\n\t\t}\n\t}\n\t\n\tint MAX = 1001;\n\tint INF = 1000000000;\n\t\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tint T = in.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\t\n\t\t\tint[] t = in.nextIntArray(T);\n\t\t\tint N = in.nextInt();\n\t\t\tState[] st = new State[N];\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tst[i] = new State(in.nextInt(), in.nextInt());\n\t\t\t}\n\t\t\tArrays.sort(st);\n\t\t\t\n\t\t\tint[] time = new int[MAX+1];\n\t\t\tArrays.fill(time, -1);\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\ttime[st[i].d] = Math.max(time[st[i].d], st[i].m);\n\t\t\t}\n\t\t\t\n\t\t\tint[][] dp = new int[MAX+1][T];\n\t\t\tfor (int i = 0; i <= MAX; i++) Arrays.fill(dp[i], INF);\n\t\t\tdp[0][0] = 0;\n\t\t\t\n\t\t\tfor (int i = 0; i < MAX; i++) {\n\t\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\t\tint next = (j + 1) % T;\n\t\t\t\t\t//(t[j] + 20) % 24 < M[cur] || t[j] <= 4)) \n\t\t\t\t\tif (time[i+1] == -1 || (t[j] + 20) % 24 < time[j] || t[j] <= 4) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1] = Math.min(dp[i][j] + 1, dp[i+1][1]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint res = INF;\n\t\t\tfor (int i = 0; i < T; i++) \n\t\t\t\tres = Math.min(res, dp[MAX][i]);\n\t\t\tSystem.out.println(res);\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\t\n\tint MAX = 1001;\n\tint INF = 1000000000;\n\t\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tint T = in.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\t\n\t\t\tint[] t = in.nextIntArray(T);\n\t\t\tint N = in.nextInt();\n\t\t\t\n\t\t\tint[] time = new int[MAX+1];\n\t\t\tArrays.fill(time, -1);\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tint d = in.nextInt(), m = in.nextInt();\n\t\t\t\ttime[d] = Math.max(time[d], m);\n\t\t\t}\n\t\t\t\n\t\t\tint[][] dp = new int[MAX+1][T];\n\t\t\tfor (int i = 0; i <= MAX; i++) Arrays.fill(dp[i], INF);\n\t\t\tdp[0][0] = 0;\n\t\t\t\n\t\t\tfor (int i = 0; i < MAX; i++) {\n\t\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\t\tint next = (j + 1) % T;\n\t\t\t\t\t//(t[j] + 20) % 24 < M[cur] || t[j] <= 4)) \n\t\t\t\t\tif (time[i+1] == -1 || t[j] <= 4 || (t[j] + 20) % 24 <= time[j]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1] = Math.min(dp[i][j] + 1, dp[i+1][1]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint res = INF;\n\t\t\tfor (int i = 0; i < T; i++) \n\t\t\t\tres = Math.min(res, dp[MAX][i]);\n\t\t\tSystem.out.println(res);\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\t\n\tint MAX = 1001;\n\tint INF = 1000000000;\n\t\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tint T = in.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\tif (T == 1) {\n\t\t\t\tSystem.out.println(0);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tint[] t = in.nextIntArray(T);\n\t\t\tint N = in.nextInt();\n\t\t\t\n\t\t\tint[] time = new int[MAX+1];\n\t\t\tArrays.fill(time, -1);\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tint d = in.nextInt(), m = in.nextInt();\n\t\t\t\ttime[d] = Math.max(time[d], m);\n\t\t\t}\n\t\t\t\n\t\t\tint[][] dp = new int[MAX+1][T];\n\t\t\tfor (int i = 0; i <= MAX; i++) Arrays.fill(dp[i], INF);\n\t\t\tdp[0][0] = 0;\n\t\t\t\n\t\t\tfor (int i = 0; i < MAX; i++) {\n\t\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\t\tint next = (j + 1) % T;\n\t\t\t\t\tif (time[i+1] == -1 || t[j] <= time[i+1]) {//t[j] <= 4 || (t[j] + 20) % 24 <= time[i+1]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1] = Math.min(dp[i][j] + 1, dp[i+1][1]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint res = INF;\n\t\t\tfor (int i = 0; i < T; i++) \n\t\t\t\tres = Math.min(res, dp[MAX][i]);\n\t\t\tSystem.out.println(res);\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nclass Main{\n\n    void solve(){\n        Scanner sc = new Scanner(System.in);\n\n        int INF = Integer.MAX_VALUE;\n\n        while(true){\n            int T = sc.nextInt();\n            if(T==0) break;\n            int[] t = new int[T];\n            for(int i=0; i<T; i++) t[i] = sc.nextInt();\n\n            int n = sc.nextInt();\n            int[] time = new int[103];\n            Arrays.fill(time, INF);\n\n            int max = 0;\n            for(int i=0; i<n; i++){\n                int d = sc.nextInt()-1, m = sc.nextInt();\n                max = Math.max(max, d);\n                time[d] = Math.min(time[d], m);\n            }\n\n            int[][] dp = new int[max+2][T];\n            for(int i=0; i<=max; i++) Arrays.fill(dp[i], INF);\n            dp[0][0] = 0;\n\n            for(int i=0; i<max; i++){\n                for(int j=0; j<T; j++){\n                    if(dp[i][j]==INF) continue;\n                    if(time[i+1]>=t[(j+1)%t.length]) dp[i+1][(j+1)%t.length] = dp[i][j];\n                    dp[i+1][0] = Math.min(dp[i+1][0], dp[i][j] + 1);\n                }\n            }\n\n            int min = Integer.MAX_VALUE;\n            for(int i=0; i<T; i++) min = Math.min(min, dp[max][i]);\n            System.out.println(min);\n        }\n    }\n\n    public static void main(String[] args){\n        new Main().solve();\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nimport java.lang.*;\n\nimport java.math.*;\n\n\n\npublic class Main {\n\n\tScanner sc = new Scanner(System.in);\n\n\n\n\tclass dm implements Comparable<dm> {\n\n\t\tint d;\n\n\t\tint m;\n\n\n\n\t\tdm(int d, int m) {\n\n\t\t\tthis.d = d;\n\n\t\t\tthis.m = m;\n\n\t\t}\n\n\n\n\t\tpublic int compareTo(dm tar) {\n\n\t\t\tif (d == tar.d)\n\n\t\t\t\treturn m - tar.m;\n\n\t\t\treturn d - tar.d;\n\n\t\t}\n\n\t}\n\n\n\n\tvoid run() {\n\n\t\tfor (;;) {\n\n\t\t\tint t = sc.nextInt();\n\n\t\t\tint r[] = new int[t];\n\n\n\n\t\t\tif (t == 0) {\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tfor (int i = 0; i < t; i++) {\n\n\t\t\t\tr[i] = sc.nextInt();\n\n\t\t\t}\n\n\n\n\t\t\tint n = sc.nextInt();\n\n\t\t\tdm[] data = new dm[n];\n\n\t\t\tfor (int i = 0; i < n; i++) {\n\n\t\t\t\tdata[i] = new dm(sc.nextInt(), sc.nextInt());\n\n\t\t\t}\n\n\n\n\t\t\tArrays.sort(data);\n\n\n\n\t\t\tint[][] dp = new int[n + 1][t];\n\n\t\t\tfor(int i = 0; i < n+1 ; i++){\n\n\t\t\tArrays.fill(dp[i], Integer.MAX_VALUE >> 4);\n\n\t\t\t}\n\n\t\t\tdp[0][0] = 0;\n\n\n\n\t\t\tint dd[] = new int[n];\n\n\t\t\tdd[0] = 0;\n\n\t\t\tfor (int i = 1; i < n; i++) {\n\n\t\t\t\tdd[i] = data[i].d - data[i - 1].d;\n\n\t\t\t}\n\n\n\n\t\t\tfor (int i = 0; i < n; i++) {\n\n\t//\t\t\tSystem.out.println(Arrays.toString(dp[i+1]));\n\n\t\t\t\tfor (int z = 0; z < t; z++) {\n\n\t\t\t\t\tdp[i + 1][0] = Math.min(dp[i][z] + 1, dp[i + 1][0]);\n\n\t\t\t\t}\n\n\t\t\t\tfor (int z = 0; z < dd[i] && z < t; z++) {\n\n\t\t\t\t\tif (data[i].m >= r[z]) {\n\n\t\t\t\t\t\tdp[i + 1][z] = Math.min(dp[i + 1][z], dp[i + 1][0]);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t//\t\t\tSystem.out.println(Arrays.toString(dp[i+1]));\n\n\n\n\t\t\t\tfor (int z = 0; z < t; z++) {\n\n\t\t\t\t\tint trr = z + dd[i];\n\n\t\t\t\t\ttrr %= t;\n\n\t\t\t\t\tif (data[i].m >= r[trr]) {\n\n\t\t\t\t\t\tdp[i + 1][trr] = Math.min(dp[i + 1][trr], dp[i][z]);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor(int i =0 ; i < n+1;i++){\n\n//\t\t\t\tSystem.out.println(Arrays.toString(dp[i]));\n\n\t\t\t}\n\n\t\t\tint ans = 10000;\n\n\t\t\tfor (int i = 0; i < t; i++) {\n\n\t\t\t\tans = Math.min(ans, dp[n][i]);\n\n\t\t\t}\n\n\t\t\tSystem.out.println(ans);\n\n\t\t}\n\n\n\n\t}\n\n\n\n\tpublic static void main(String[] args) {\n\n\t\tMain m = new Main();\n\n\t\tm.run();\n\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\n\tint MAX = 1001;\n\tint INF = 1000000000;\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tint T = in.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\t\n\t\t\tint[] t = in.nextIntArray(T);\n\t\t\tint N = in.nextInt();\n\t\t\tint[] D = new int[N];\n\t\t\tint[] M = new int[N];\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tD[i] = in.nextInt();\n\t\t\t\tM[i] = in.nextInt();\n\t\t\t}\n\t\t\t\n\t\t\tint[][] dp = new int[MAX+1][T];\n\t\t\tfor (int i = 0; i <= MAX; i++) Arrays.fill(dp[i], INF);\n\t\t\tdp[0][0] = 0;\n\t\t\t\n\t\t\tint cur = 0;\n\t\t\tfor (int i = 0; i < MAX && cur < N; i++) {\n\t\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\t\tint next = (j + 1) % T;\n\t\t\t\t\tif (i == D[cur] && t[j] < M[cur]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t} else if (i != D[cur]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1] = Math.min(dp[i][j] + 1, dp[i+1][1]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tif (i == D[cur]) cur++;\n\t\t\t}\n\t\t\t\n\t\t\tcur--;\n\t\t\tint res = INF;\n\t\t\tfor (int i = 0; i < T; i++) \n\t\t\t\tres = Math.min(res, dp[D[cur]][i]);\n\t\t\tSystem.out.println(res);\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint C = sc.nextInt();\n\t\t\tif (C == 0) {\n\t\t\t\tsc.close();\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tint[] cycle = new int[C];\n\t\t\tfor (int i = 0; i < C; i++) {\n\t\t\t\tcycle[i] = sc.nextInt();\n\t\t\t}\n\n\t\t\tint N = sc.nextInt();\n\t\t\tint[] meeting = new int[100];\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tint day = sc.nextInt();\n\t\t\t\tmeeting[day - 1] = sc.nextInt();\n\t\t\t}\n\n\t\t\t// dp[i日目に][サイクルjがきてる]ときのカフェイン最小回数\n\t\t\tint[][] dp = new int[100][C];\n\t\t\tfor (int i = 0; i < dp.length; i++) {\n\t\t\t\tArrays.fill(dp[i], 100);\n\t\t\t}\n\t\t\tdp[0][0] = 0;\n\n\t\t\tfor (int i = 0; i < dp.length - 1; i++) {\n\t\t\t\tfor (int j = 0; j < dp[i].length; j++) {\n\t\t\t\t\t// 間に合う時\n\t\t\t\t\tif (cycle[(j + 1) % C] <= meeting[i + 1] || meeting[i + 1] == 0) {\n\t\t\t\t\t\tdp[i + 1][(j + 1) % C] = Math.min(dp[i][j], dp[i + 1][(j + 1) % C]);\n\t\t\t\t\t}\n\t\t\t\t\t// カフェインを摂取する時\n\t\t\t\t\tdp[i + 1][0] = Math.min(dp[i][j] + 1, dp[i + 1][0]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tint caffeine = Integer.MAX_VALUE;\n\t\t\tfor (int i = 0; i < dp[99].length; i++) {\n\t\t\t\tcaffeine = Math.min(caffeine, dp[99][i]);\n\t\t\t}\n\t\t\tSystem.out.println(caffeine);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tstatic int[] cycle, dm;\n\tstatic int enday;\n\tstatic int[][][] memo;\n\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n == 0) break;\n\n\t\t\tcycle = new int[n];\n\t\t\tfor(int i=0;i<n;i++) cycle[i] = sc.nextInt();\n\n\t\t\tint m = sc.nextInt();\n\t\t\tdm = new int[104];\n\t\t\tenday = Integer.MIN_VALUE;\n\t\t\tfor(int i=0;i<m;i++) {\n\t\t\t\tint D = sc.nextInt(), M = sc.nextInt();\n\t\t\t\tif(dm[D-1] != 0) dm[D-1] = Math.min(dm[D-1], M);\n\t\t\t\telse dm[D-1] = M;\n\t\t\t\tenday = Math.max(enday, D);\n\t\t\t}\n\n\t\t\tmemo = new int[enday][cycle.length][100];\n\t\t\tfor(int i=0;i<enday;i++){\n\t\t\t\tfor(int j=0;j<cycle.length;j++){\n\t\t\t\t\tArrays.fill(memo[i][j], Integer.MAX_VALUE);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tSystem.out.println(solve(0,0,0));\n\t\t}\n\t}\n\n\tprivate static int solve(int day,int ci,int count){\n\t\tif(day == enday) return count;\n\t\tif(memo[day][ci][count] != Integer.MAX_VALUE) return memo[day][ci][count];\n\n\t\tint res = Integer.MAX_VALUE;\n\n\t\tif(dm[day] == 0 || cycle[ci] <= dm[day])\n\t\t\tres = Math.min(res, solve(day+1,(ci+1)%cycle.length,count));\n\n\t\tres = Math.min(res, solve(day+1,1%cycle.length,count+1));\n\t\t\n\t\treturn memo[day][ci][count] = res;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nimport java.lang.*;\n\nimport java.math.*;\n\n\n\npublic class Main {\n\n\tScanner sc = new Scanner(System.in);\n\n\n\n\tclass dm implements Comparable<dm> {\n\n\t\tint d;\n\n\t\tint m;\n\n\n\n\t\tdm(int d, int m) {\n\n\t\t\tthis.d = d;\n\n\t\t\tthis.m = m;\n\n\t\t}\n\n\n\n\t\tpublic int compareTo(dm tar) {\n\n\t\t\tif (d == tar.d)\n\n\t\t\t\treturn m - tar.m;\n\n\t\t\treturn d - tar.d;\n\n\t\t}\n\n\t}\n\n\n\n\tvoid run() {\n\n\t\tfor (;;) {\n\n\t\t\tint t = sc.nextInt();\n\n\t\t\tint r[] = new int[t];\n\n\n\n\t\t\tif (t == 0) {\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tfor (int i = 0; i < t; i++) {\n\n\t\t\t\tr[i] = sc.nextInt();\n\n\t\t\t}\n\n\n\n\t\t\tint n = sc.nextInt();\n\n\t\t\tdm[] data = new dm[n];\n\n\t\t\tfor (int i = 0; i < n; i++) {\n\n\t\t\t\tdata[i] = new dm(sc.nextInt(), sc.nextInt());\n\n\t\t\t}\n\n\n\n\t\t\tArrays.sort(data);\n\n\n\n\t\t\tint[][] dp = new int[n + 1][t];\n\n\t\t\tfor(int i = 0; i < n+1 ; i++){\n\n\t\t\tArrays.fill(dp[i], Integer.MAX_VALUE >> 4);\n\n\t\t\t}\n\n\t\t\tdp[0][0] = 0;\n\n\n\n\t\t\tint dd[] = new int[n];\n\n\t\t\tdd[0] = data[0].d-1;\n\n\t\t\tfor (int i = 1; i < n; i++) {\n\n\t\t\t\tdd[i] = data[i].d - data[i - 1].d;\n\n\t\t\t}\n\n\n\n\t\t\tfor (int i = 0; i < n; i++) {\n\n\t\t\t\tfor (int z = 0; z < t; z++) {\n\n\t\t\t\t\tint trr = z + dd[i];\n\n\t\t\t\t\ttrr %= t;\n\n\t\t\t\t\tif (data[i].m >= r[trr]) {\n\n\t\t\t\t\t\tdp[i + 1][trr] = Math.min(dp[i + 1][trr], dp[i][z]);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t\n\n\t//\t\t\tSystem.out.println(Arrays.toString(dp[i+1]));\n\n\t\t\t\tfor (int z = 0; z < t; z++) {\n\n\t\t\t\t\tdp[i + 1][0] = Math.min(dp[i][z] + 1, dp[i + 1][0]);\n\n\t\t\t\t}\n\n\t\t\t\tfor (int z = 0; z < dd[i] && z < t; z++) {\n\n\t\t\t\t\tif (data[i].m >= r[z]) {\n\n\t\t\t\t\t\tdp[i + 1][z] = Math.min(dp[i + 1][z], dp[i + 1][0]);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t//\t\t\tSystem.out.println(Arrays.toString(dp[i+1]));\n\n\n\n\t\t\t}\n\n\t\t//\tSystem.out.println(Arrays.toString(dp[0]));\n\n\t\t\tfor(int i =1 ; i < n+1;i++){\n\n\t\t//\t\tSystem.out.println(data[i-1].d+\" \"+data[i-1].m+\" \" +Arrays.toString(dp[i]));\n\n\t\t\t}\n\n\t\t\tint ans = 10000;\n\n\t\t\tfor (int i = 0; i < t; i++) {\n\n\t\t\t\tans = Math.min(ans, dp[n][i]);\n\n\t\t\t}\n\n\t\t\tSystem.out.println(ans);\n\n\t\t}\n\n\n\n\t}\n\n\n\n\tpublic static void main(String[] args) {\n\n\t\tMain m = new Main();\n\n\t\tm.run();\n\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\n\tint MAX = 1001;\n\tint INF = 1000000000;\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tint T = in.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\t\n\t\t\tint[] t = in.nextIntArray(T);\n\t\t\tint N = in.nextInt();\n\t\t\tint[] D = new int[N];\n\t\t\tint[] M = new int[N];\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tD[i] = in.nextInt();\n\t\t\t\tM[i] = in.nextInt();\n\t\t\t}\n\t\t\t\n\t\t\tint[][] dp = new int[MAX+1][T];\n\t\t\tfor (int i = 0; i <= MAX; i++) Arrays.fill(dp[i], INF);\n\t\t\tdp[0][0] = 0;\n\t\t\t\n\t\t\tint cur = 0;\n\t\t\tfor (int i = 0; i < MAX && cur < N; i++) {\n\t\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\t\tint next = (j + 1) % T;\n\t\t\t\t\tif (i == D[cur] && t[j] <= M[cur]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t} else if (i != D[cur]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1] = Math.min(dp[i][j] + 1, dp[i+1][1]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tif (i == D[cur]) cur++;\n\t\t\t}\n\t\t\t\n\t\t\tcur--;\n\t\t\tint res = INF;\n\t\t\tfor (int i = 0; i < T; i++) \n\t\t\t\tres = Math.min(res, dp[D[cur]][i]);\n\t\t\tSystem.out.println(res);\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nclass Main{\n\n    void solve(){\n        Scanner sc = new Scanner(System.in);\n\n        int INF = Integer.MAX_VALUE;\n\n        while(true){\n            int T = sc.nextInt();\n            if(T==0) break;\n            int[] t = new int[T];\n            for(int i=0; i<T; i++) t[i] = sc.nextInt();\n\n            int n = sc.nextInt();\n            int[] time = new int[101];\n            Arrays.fill(time, INF);\n            int max = 0;\n            for(int i=0; i<n; i++){\n                int d = sc.nextInt()-1, m = sc.nextInt();\n                max = Math.max(max, d);\n                time[d] = m;\n            }\n\n            int[][] dp = new int[max+1][T];\n            for(int i=0; i<=max; i++) Arrays.fill(dp[i], INF);\n            dp[0][0] = 0;\n\n            for(int i=1; i<=max; i++){\n                for(int j=0; j<T; j++){\n                    if(j-1<0 || dp[i-1][j-1]==INF) continue;\n                    if(time[i]>=t[j]){\n                        dp[i][j] = dp[i-1][j-1];\n                    }\n                    dp[i][0] = Math.min(dp[i][0], dp[i-1][j-1] + 1);\n                }\n            }\n\n            //for(int i=0; i<=max; i++) System.out.println(Arrays.toString(dp[i]));\n\n            int min = Integer.MAX_VALUE;\n            for(int i=0; i<T; i++){\n                min = Math.min(min, dp[max][i]);\n            }\n            System.out.println(min);\n        }\n    }\n\n    public static void main(String[] args){\n        new Main().solve();\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nclass Main{\n\n    void solve(){\n        Scanner sc = new Scanner(System.in);\n\n        int INF = Integer.MAX_VALUE;\n\n        while(true){\n            int T = sc.nextInt();\n            if(T==0) break;\n            int[] t = new int[T];\n            for(int i=0; i<T; i++) t[i] = sc.nextInt();\n\n            int n = sc.nextInt();\n            int[] time = new int[105];\n            Arrays.fill(time, INF);\n\n            int max = 0;\n            for(int i=0; i<n; i++){\n                int d = sc.nextInt()-1, m = sc.nextInt();\n                max = Math.max(max, d);\n                time[d] = m;\n            }\n\n            int[][] dp = new int[max+2][T];\n            for(int i=0; i<=max; i++) Arrays.fill(dp[i], INF);\n            dp[0][0] = 0;\n\n            for(int i=0; i<max; i++){\n                for(int j=0; j<T; j++){\n                    if(dp[i][j]==INF) continue;\n                    if(time[i+1]>=t[(j+1)%t.length]){\n                        dp[i+1][(j+1)%t.length] = dp[i][j];\n                    }\n                    dp[i+1][0] = Math.min(dp[i+1][0], dp[i][j] + 1);\n                    //dp[i+1][0] = Math.min(dp[i+1][0], dp[i][j] + 1);\n                }\n                //if(dp[i-1][t.length-1]!=INF) dp[i][0] = Math.min(dp[i][0], dp[i-1][t.length-1]);\n            }\n\n            //for(int i=0; i<=max; i++) System.out.println(Arrays.toString(dp[i]));\n\n            int min = Integer.MAX_VALUE;\n            for(int i=0; i<T; i++){\n                min = Math.min(min, dp[max][i]);\n            }\n            System.out.println(min);\n        }\n    }\n\n    public static void main(String[] args){\n        new Main().solve();\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.*;\nimport java.util.Calendar.Builder;\n\nimport javax.jws.soap.SOAPBinding.Use;\n\n\n\npublic class Main {\n\tstatic int INF = 2 << 27;\n\tpublic static void main(String[] args) {\t\n\t\t//FastScanner sc = new FastScanner();\n\t\tScanner sc = new Scanner(System.in);\n\t\tPrintWriter out = new PrintWriter(System.out);\n\t\twhile(true) {\n\t\t\tint T = sc.nextInt();\n\t\t\tif(T == 0) break;\n\t\t\tint[] t = new int[T];\n\t\t\tfor(int i = 0; i < T; i++) {\n\t\t\t\tt[i] = sc.nextInt();\n\t\t\t}\n\t\t\tint N = sc.nextInt();\n\t\t\tint[] DM = new int[100];\n\t\t\tfor(int i = 0; i < DM.length; i++) {\n\t\t\t\tDM[i] = INF;\n\t\t\t}\n\t\t\tfor(int i = 0; i < N; i++) {\n\t\t\t\tint D = sc.nextInt()-1;\n\t\t\t\tDM[D] = Math.min(DM[D], sc.nextInt());\n\t\t\t}\n\t\t\tint[][] dp = new int[101][T];\n\t\t\tfor(int i = 0; i < dp.length; i++) {\n\t\t\t\tArrays.fill(dp[i], INF);\n\t\t\t}\n\t\t\tdp[0][0] = 0;\n\t\t\tfor(int i = 0; i < DM.length; i++) {\n\t\t\t\tfor(int j = 0; j < T; j++) {\n\t\t\t\t\tif(dp[i][j] == INF) continue;\n\t\t\t\t\tif(t[j] <= DM[i]) {\n\t\t\t\t\t\tdp[i+1][(j + 1) % T] = Math.min(dp[i + 1][(j + 1) % T], dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i + 1][1] = Math.min(dp[i+1][1], dp[i][j]+1);\n\t\t\t\t}\n\t\t\t}\n\t\t\tint min = INF;\n\t\t\tfor(int i = 0; i < T; i++) {\n\t\t\t\tmin = Math.min(min, dp[100][i]);\n\t\t\t}\n\t\t\tSystem.out.println(min);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nclass Main{\n\n    void solve(){\n        Scanner sc = new Scanner(System.in);\n\n        int INF = Integer.MAX_VALUE;\n\n        while(true){\n            int T = sc.nextInt();\n            if(T==0) break;\n            int[] t = new int[T];\n            for(int i=0; i<T; i++) t[i] = sc.nextInt();\n\n            int n = sc.nextInt();\n            int[] time = new int[105];\n            Arrays.fill(time, INF);\n\n            int max = 0;\n            for(int i=0; i<n; i++){\n                int d = sc.nextInt()-1, m = sc.nextInt();\n                max = Math.max(max, d);\n                time[d] = m;\n            }\n\n            int[][] dp = new int[max+2][T];\n            for(int i=0; i<=max; i++) Arrays.fill(dp[i], INF);\n            dp[0][0] = 0;\n\n            for(int i=1; i<=max; i++){\n                for(int j=1; j<T; j++){\n                    if(j-1<0 || dp[i-1][j-1]==INF) continue;\n                    if(time[i]>=t[j]){\n                        dp[i][j] = dp[i-1][j-1];\n                    }\n                    dp[i][0] = Math.min(dp[i][0], dp[i-1][j-1] + 1);\n                    //dp[i+1][0] = Math.min(dp[i+1][0], dp[i][j] + 1);\n                }\n                if(dp[i-1][t.length-1]!=INF) dp[i][0] = Math.min(dp[i][0], dp[i-1][t.length-1]);\n            }\n\n            //for(int i=0; i<=max; i++) System.out.println(Arrays.toString(dp[i]));\n\n            int min = Integer.MAX_VALUE;\n            for(int i=0; i<T; i++){\n                min = Math.min(min, dp[max][i]);\n            }\n            System.out.println(min);\n        }\n    }\n\n    public static void main(String[] args){\n        new Main().solve();\n    }\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\t\n\tint MAX = 1001;\n\tint INF = 1000000000;\n\t\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tint T = in.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\tif (T == 1) {\n\t\t\t\tSystem.out.println(0);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tint[] t = in.nextIntArray(T);\n\t\t\tint N = in.nextInt();\n\t\t\t\n\t\t\tint[] time = new int[MAX+1];\n\t\t\tArrays.fill(time, -1);\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tint d = in.nextInt(), m = in.nextInt();\n\t\t\t\ttime[d] = Math.max(time[d], m);\n\t\t\t}\n\t\t\t\n\t\t\tint[][] dp = new int[MAX+1][T];\n\t\t\tfor (int i = 0; i <= MAX; i++) Arrays.fill(dp[i], INF);\n\t\t\tdp[1][1] = 0;\n\t\t\t\n\t\t\tfor (int i = 1; i < MAX; i++) {\n\t\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\t\tint next = (j + 1) % T;\n\t\t\t\t\tif (time[i+1] == -1 || t[j] <= time[i+1]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1] = Math.min(dp[i][j] + 1, dp[i+1][1]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint res = INF;\n\t\t\tfor (int i = 0; i < T; i++) \n\t\t\t\tres = Math.min(res, dp[MAX][i]);\n\t\t\tSystem.out.println(res);\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\t\n\tint MAX = 1001;\n\tint INF = 1000000000;\n\t\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tint T = in.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\tint[] t = in.nextIntArray(T);\n\t\t\tint N = in.nextInt();\n\t\t\t\n\t\t\tint[] time = new int[MAX+1];\n\t\t\tArrays.fill(time, INF);\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tint d = in.nextInt(), m = in.nextInt();\n\t\t\t\ttime[d] = Math.min(time[d], m);\n\t\t\t}\n\t\t\t\n\t\t\tint[][] dp = new int[MAX+1][T];\n\t\t\tfor (int i = 0; i <= MAX; i++) Arrays.fill(dp[i], INF);\n\t\t\tdp[0][0] = 0;\n\t\t\t\n\t\t\tfor (int i = 0; i < MAX; i++) {\n\t\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\t\tint next = (j + 1) % T;\n\t\t\t\t\tif (t[j] <= time[i+1]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1] = Math.min(dp[i][j] + 1, dp[i+1][1]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint res = INF;\n\t\t\tfor (int i = 0; i < T; i++) \n\t\t\t\tres = Math.min(res, dp[MAX][i]);\n\t\t\tSystem.out.println(res);\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n */\npublic class Main {\n    public static void main(String[] args) {\n        InputStream inputStream = System.in;\n        OutputStream outputStream = System.out;\n        Scanner in = new Scanner(inputStream);\n        PrintWriter out = new PrintWriter(outputStream);\n        ErraticSleepHabits solver = new ErraticSleepHabits();\n        try {\n            int testNumber = 1;\n            while (true)\n                solver.solve(testNumber++, in, out);\n        } catch (UnknownError e) {\n            out.close();\n        }\n    }\n\n    static class ErraticSleepHabits {\n        public void solve(int testNumber, Scanner in, PrintWriter out) {\n            final int INF = (int) 1e9;\n            int T = in.nextInt();\n            if (T == 0) {\n                throw new UnknownError();\n            }\n            int[] t = new int[T]; // cycle\n            for (int i = 0; i < T; i++) {\n                t[i] = in.nextInt();\n            }\n            int N = in.nextInt();\n            int[] d = new int[101];\n            Arrays.fill(d, INF);\n            for (int i = 0; i < N; i++) {\n                int day = in.nextInt();\n                d[day] = Math.min(d[day], in.nextInt());\n            }\n            final int MAX_DAY = 100;\n            int[][] dp = new int[MAX_DAY][T];\n            for (int i = 0; i < MAX_DAY; i++) {\n                Arrays.fill(dp[i], INF);\n            }\n            dp[0][0] = 0;\n            for (int i = 0; i < MAX_DAY - 1; i++) {\n                for (int j = 0; j < T; j++) {\n                    if (dp[i][j] < INF) {\n                        int nxtCycle = (j + 1) % T;\n                        if (t[nxtCycle] <= d[i]) {\n                            // サイクルリセットしない\n                            dp[i + 1][nxtCycle] = Math.min(dp[i + 1][nxtCycle], dp[i][j]);\n                        }\n                        if (t[0] <= d[i]) {\n                            // サイクルリセットする\n                            dp[i + 1][0] = Math.min(dp[i + 1][0], dp[i][j] + 1);\n                        }\n                    }\n                }\n            }\n            int ans = INF;\n            for (int i = 0; i < T; i++) {\n                ans = Math.min(ans, dp[MAX_DAY - 1][i]);\n            }\n            out.println(ans);\n        }\n\n    }\n}\n\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nclass Main{\n\n    void solve(){\n        Scanner sc = new Scanner(System.in);\n\n        int INF = Integer.MAX_VALUE;\n\n        while(true){\n            int T = sc.nextInt();\n            if(T==0) break;\n            int[] t = new int[T];\n            for(int i=0; i<T; i++) t[i] = sc.nextInt();\n\n            int n = sc.nextInt();\n            int[] time = new int[101];\n            int max = 0;\n            for(int i=0; i<n; i++){\n                int d = sc.nextInt(), m = sc.nextInt();\n                max = Math.max(max, d);\n                time[d] = m;\n            }\n\n            int[][] dp = new int[max+1][T];\n            for(int i=1; i<=max; i++) Arrays.fill(dp[i], INF);\n            dp[1][0] = 0;\n\n            for(int i=1; i<=max; i++){\n                for(int j=0; j<T; j++){\n                    if(j-1<0 || dp[i-1][j-1]==INF) continue;\n                    if(time[i]>=t[j]){\n                        dp[i][j] = dp[i-1][j-1];\n                    }\n                    dp[i][0] = Math.min(dp[i][0], dp[i-1][j-1] + 1);\n                }\n            }\n\n            //for(int i=0; i<=max; i++) System.out.println(Arrays.toString(dp[i]));\n\n            int min = Integer.MAX_VALUE;\n            for(int i=0; i<T; i++){\n                min = Math.min(min, dp[max][i]);\n            }\n            System.out.println(min);\n        }\n    }\n\n    public static void main(String[] args){\n        new Main().solve();\n    }\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\t\n\tint MAX = 1001;\n\tint INF = 1000000000;\n\t\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tint T = in.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\t\n\t\t\tint[] t = in.nextIntArray(T);\n\t\t\tint N = in.nextInt();\n\t\t\t\n\t\t\tint[] time = new int[MAX+1];\n\t\t\tArrays.fill(time, -1);\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tint d = in.nextInt(), m = in.nextInt();\n\t\t\t\ttime[d] = Math.max(time[d], m);\n\t\t\t}\n\t\t\t\n\t\t\tint[][] dp = new int[MAX+1][T];\n\t\t\tfor (int i = 0; i <= MAX; i++) Arrays.fill(dp[i], INF);\n\t\t\tdp[0][0] = 0;\n\t\t\t\n\t\t\tfor (int i = 0; i < MAX; i++) {\n\t\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\t\tint next = (j + 1) % T;\n\t\t\t\t\t//(t[j] + 20) % 24 < M[cur] || t[j] <= 4)) \n\t\t\t\t\tif (time[i+1] == -1 || t[j] <= 4 || (t[j] + 20) % 24 <= time[i+1]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1] = Math.min(dp[i][j] + 1, dp[i+1][1]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint res = INF;\n\t\t\tfor (int i = 0; i < T; i++) \n\t\t\t\tres = Math.min(res, dp[MAX][i]);\n\t\t\tSystem.out.println(res);\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\t\n\tint MAX = 1001;\n\tint INF = 1000000000;\n\t\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tint T = in.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\t\n\t\t\tint[] t = in.nextIntArray(T);\n\t\t\tint N = in.nextInt();\n\t\t\t\n\t\t\tint[] time = new int[MAX+1];\n\t\t\tArrays.fill(time, -1);\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tint d = in.nextInt(), m = in.nextInt();\n\t\t\t\ttime[d] = Math.max(time[d], m);\n\t\t\t}\n\t\t\t\n\t\t\tint[][] dp = new int[MAX+1][T];\n\t\t\tfor (int i = 0; i <= MAX; i++) Arrays.fill(dp[i], INF);\n\t\t\tdp[0][0] = 0;\n\t\t\t\n\t\t\tfor (int i = 0; i < MAX; i++) {\n\t\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\t\tint next = (j + 1) % T;\n\t\t\t\t\tif (time[i+1] == -1 || t[j] <= time[i+1]) {//t[j] <= 4 || (t[j] + 20) % 24 <= time[i+1]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1] = Math.min(dp[i][j] + 1, dp[i+1][1]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint res = INF;\n\t\t\tfor (int i = 0; i < T; i++) \n\t\t\t\tres = Math.min(res, dp[MAX][i]);\n\t\t\tSystem.out.println(res);\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tstatic Scanner sc = new Scanner(System.in);\n\n\tpublic static void main(String[] arg) {\n\t\twhile (true) {\n\t\t\tint T = sc.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\tint[] t = new int[T];\n\t\t\tfor (int i = 0; i < T; ++i) {\n\t\t\t\tt[i] = sc.nextInt();\n\t\t\t}\n\t\t\tint N = sc.nextInt();\n\t\t\tEvent[] ev = new Event[N];\n\t\t\tfor (int i = 0; i < N; ++i) {\n\t\t\t\tint d = sc.nextInt();\n\t\t\t\tint m = sc.nextInt();\n\t\t\t\tev[i] = new Event(d, m);\n\t\t\t}\n\t\t\tArrays.sort(ev);\n\t\t\tfinal int INF = 1 << 30;\n\t\t\tint[][] dp = new int[101][T];\n\t\t\tfor (int[] a : dp) {\n\t\t\t\tArrays.fill(a, INF);\n\t\t\t}\n\t\t\tdp[0][T - 1] = 0;\n\t\t\tint ep = 0;\n\t\t\tfor (int i = 1; i <= 100; ++i) {\n\t\t\t\tif (ep < N && ev[ep].d == i) {\n\t\t\t\t\tint m = ev[ep].m;\n\t\t\t\t\tfor (int j = 0; j < T; ++j) {\n\t\t\t\t\t\tif (t[(j + 1) % T] <= m) dp[i][(j + 1) % T] = Math.min(dp[i][(j + 1) % T], dp[i - 1][j]);\n\t\t\t\t\t\tdp[i][0] = Math.min(dp[i][0], dp[i - 1][j] + 1);\n\t\t\t\t\t}\n\t\t\t\t\t++ep;\n\t\t\t\t} else {\n\t\t\t\t\tfor (int j = 0; j < T; ++j) {\n\t\t\t\t\t\tdp[i][(j + 1) % T] = Math.min(dp[i][(j + 1) % T], dp[i - 1][j]);\n\t\t\t\t\t\tdp[i][0] = Math.min(dp[i][0], dp[i - 1][j] + 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tint ans = INF;\n\t\t\tfor (int i = 0; i < T; ++i) {\n\t\t\t\tans = Math.min(ans, dp[100][i]);\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\n\tstatic class Event implements Comparable<Event> {\n\t\tint d, m;\n\n\t\tpublic Event(int d, int m) {\n\t\t\tthis.d = d;\n\t\t\tthis.m = m;\n\t\t}\n\n\t\tpublic int compareTo(Event o) {\n\t\t\treturn this.d - o.d;\n\t\t}\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nimport java.lang.*;\n\nimport java.math.*;\n\n\n\npublic class Main {\n\n\tScanner sc = new Scanner(System.in);\n\n\n\n\tclass dm implements Comparable<dm> {\n\n\t\tint d;\n\n\t\tint m;\n\n\n\n\t\tdm(int d, int m) {\n\n\t\t\tthis.d = d;\n\n\t\t\tthis.m = m;\n\n\t\t}\n\n\n\n\t\tpublic int compareTo(dm tar) {\n\n\t\t\tif (d == tar.d)\n\n\t\t\t\treturn m - tar.m;\n\n\t\t\treturn d - tar.d;\n\n\t\t}\n\n\t}\n\n\n\n\tvoid run() {\n\n\t\tfor (;;) {\n\n\t\t\tint t = sc.nextInt();\n\n\t\t\tint r[] = new int[t];\n\n\n\n\t\t\tif (t == 0) {\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tfor (int i = 0; i < t; i++) {\n\n\t\t\t\tr[i] = sc.nextInt();\n\n\t\t\t}\n\n\n\n\t\t\tint n = sc.nextInt();\n\n\t\t\tint d[] = new int[n];\n\n\t\t\tint m[] = new int[n];\n\n\t\t\tdm[] data = new dm[n];\n\n\t\t\tfor (int i = 0; i < n; i++) {\n\n\t\t\t\tdata[i] = new dm(sc.nextInt(), sc.nextInt());\n\n\t\t\t}\n\n\n\n\t\t\tArrays.sort(data);\n\n\n\n\t\t\tint[][] dp = new int[n + 1][t];\n\n\t\t\tfor(int i = 0; i < n+1 ; i++){\n\n\t\t\tArrays.fill(dp[i], Integer.MAX_VALUE >> 4);\n\n\t\t\t}\n\n\t\t\tdp[0][0] = 0;\n\n\n\n\t\t\tint dd[] = new int[n];\n\n\t\t\tdd[0] = 0;\n\n\t\t\tfor (int i = 1; i < n; i++) {\n\n\t\t\t\tdd[i] = data[i].d - data[i - 1].d;\n\n\t\t\t}\n\n\n\n\t\t\tfor (int i = 0; i < n; i++) {\n\n\t//\t\t\tSystem.out.println(Arrays.toString(dp[i+1]));\n\n\t\t\t\tfor (int z = 0; z < t; z++) {\n\n\t\t\t\t\tdp[i + 1][0] = Math.min(dp[i][z] + 1, dp[i + 1][0]);\n\n\t\t\t\t}\n\n\t\t\t\tfor (int z = 0; z < dd[i]; z++) {\n\n\t\t\t\t\tif (data[i].m >= r[z]) {\n\n\t\t\t\t\t\tdp[i + 1][z] = Math.min(dp[i + 1][z], dp[i + 1][0]);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t//\t\t\tSystem.out.println(Arrays.toString(dp[i+1]));\n\n\n\n\t\t\t\tfor (int z = 0; z < t; z++) {\n\n\t\t\t\t\tint trr = z + dd[i];\n\n\t\t\t\t\ttrr %= t;\n\n\t\t\t\t\tif (data[i].m >= r[trr]) {\n\n\t\t\t\t\t\tdp[i + 1][trr] = Math.min(dp[i + 1][trr], dp[i][z]);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor(int i =0 ; i < n+1;i++){\n\n//\t\t\t\tSystem.out.println(Arrays.toString(dp[i]));\n\n\t\t\t}\n\n\t\t\tint ans = 10000;\n\n\t\t\tfor (int i = 0; i < t; i++) {\n\n\t\t\t\tans = Math.min(ans, dp[n][i]);\n\n\t\t\t}\n\n\t\t\tSystem.out.println(ans);\n\n\t\t}\n\n\n\n\t}\n\n\n\n\tpublic static void main(String[] args) {\n\n\t\tMain m = new Main();\n\n\t\tm.run();\n\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint C = sc.nextInt();\n\t\t\tif (C == 0) {\n\t\t\t\tsc.close();\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tint[] cycle = new int[C];\n\t\t\tfor (int i = 0; i < C; i++) {\n\t\t\t\tcycle[i] = sc.nextInt();\n\t\t\t}\n\n\t\t\tint N = sc.nextInt();\n\t\t\tint[] meeting = new int[100];\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tint day = sc.nextInt();\n\t\t\t\tint meet = sc.nextInt();\n\t\t\t\tif (meeting[day - 1] != 0) {\n\t\t\t\t\tmeeting[day - 1] = Math.min(meet, meeting[day - 1]);\n\t\t\t\t} else {\n\t\t\t\t\tmeeting[day - 1] = meet;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// dp[i日目に][サイクルjがきてる]ときのカフェイン最小回数\n\t\t\tint[][] dp = new int[100][C];\n\t\t\tfor (int i = 0; i < dp.length; i++) {\n\t\t\t\tArrays.fill(dp[i], 100);\n\t\t\t}\n\t\t\tdp[0][0] = 0;\n\n\t\t\tfor (int i = 0; i < dp.length - 1; i++) {\n\t\t\t\tfor (int j = 0; j < C; j++) {\n\t\t\t\t\t// 間に合う時\n\t\t\t\t\tif (cycle[(j + 1) % C] <= meeting[i + 1] || meeting[i + 1] == 0) {\n\t\t\t\t\t\tdp[i + 1][(j + 1) % C] = Math.min(dp[i][j], dp[i + 1][(j + 1) % C]);\n\t\t\t\t\t}\n\t\t\t\t\t// カフェインを摂取する時\n\t\t\t\t\tdp[i + 1][0] = Math.min(dp[i][j] + 1, dp[i + 1][0]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tint caffeine = Integer.MAX_VALUE;\n\t\t\tfor (int i = 0; i < dp[99].length; i++) {\n\t\t\t\tcaffeine = Math.min(caffeine, dp[99][i]);\n\t\t\t}\n\t\t\tSystem.out.println(caffeine);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport static java.lang.System.*;\nimport static java.lang.Math.*;\n\npublic class Main {\n\n\tScanner sc = new Scanner(in);\n\t\n\tvoid run() {\n\t\tint[] t = new int[30];\n\t\tint[] time = new int[101];\n\t\tint[] c = new int[101];\n\t\tint[][] cost = new int[101][101];\n\t\tint[] dis = new int[101];\n\t\tboolean[] used = new boolean[101];\n\t\tint INF = Integer.MAX_VALUE/2;\n\t\twhile (true) {\n\t\t\tint T = sc.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\tfor (int i = 0; i < T; i++)\n\t\t\t\tt[i] = sc.nextInt();\n\t\t\tint N = sc.nextInt();\n\t\t\tArrays.fill(time, INF);\n\t\t\tint max = -1;\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tint d = sc.nextInt(), m = sc.nextInt();\n\t\t\t\ttime[d] = m;\n\t\t\t\tmax = max(max, d);\n\t\t\t}\n\t\t\t\n\t\t\tI:for (int i = 1; i <= max; i++) {\n\t\t\t\tfor (int j = i; j < i+T && j <= max; j++) {\n\t\t\t\t\tif (time[j] < t[j-i]) {\n\t\t\t\t\t\tc[i] = j-1;\n\t\t\t\t\t\tcontinue I;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tc[i] = (max <= i+T-1) ? max : i+T-1;\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\tfor (int i = 0; i < 101; i++)\n\t\t\t\tArrays.fill(cost[i], INF);\n\t\t\t\n\t\t\tfor (int i = 1; i < max; i++) {\n\t\t\t\tfor (int j = i+1; j <= c[i]; j++) {\n\t\t\t\t\tcost[i][j] = 1;\n\t\t\t\t}\n\t\t\t\tif (c[i]-i == T-1 && c[i] != max) {\n\t\t\t\t\tcost[i][c[i]+1] = 0;\n\t\t\t\t} else {\n\t\t\t\t\tcost[i][c[i]+1] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tArrays.fill(dis, INF);\n\t\t\tArrays.fill(used, false);\n\t\t\tdis[1] = 0;\n\t\t\twhile (true) {\n\t\t\t\tint v = -1;\n\t\t\t\tfor (int i = 1; i <= max; i++) {\n\t\t\t\t\tif (!used[i] && (v == -1 || dis[i] < dis[v])) v = i;\n\t\t\t\t}\n\t\t\t\tif (v == -1) break;\n\t\t\t\tused[v] = true;\n\t\t\t\tfor (int i = 1; i <= max; i++) {\n\t\t\t\t\tdis[i] = min(dis[i], dis[v]+cost[v][i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tint res = INF;\n\t\t\tfor (int i = 1; i <= max; i++) {\n\t\t\t\tif (c[i] == max)\n\t\t\t\t\tres = min(res, dis[i]);\n\t\t\t}\n\t\t\tout.println(res);\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nimport java.lang.*;\n\nimport java.math.*;\n\n\n\npublic class Main {\n\n\tScanner sc = new Scanner(System.in);\n\n\n\n\tclass dm implements Comparable<dm> {\n\n\t\tint d;\n\n\t\tint m;\n\n\n\n\t\tdm(int d, int m) {\n\n\t\t\tthis.d = d;\n\n\t\t\tthis.m = m;\n\n\t\t}\n\n\n\n\t\tpublic int compareTo(dm tar) {\n\n\t\t\tif (d == tar.d)\n\n\t\t\t\treturn m - tar.m;\n\n\t\t\treturn d - tar.d;\n\n\t\t}\n\n\t}\n\n\n\n\tvoid run() {\n\n\t\tfor (;;) {\n\n\t\t\tint t = sc.nextInt();\n\n\t\t\tint r[] = new int[t];\n\n\n\n\t\t\tif (t == 0) {\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tfor (int i = 0; i < t; i++) {\n\n\t\t\t\tr[i] = sc.nextInt();\n\n\t\t\t}\n\n\n\n\t\t\tint n = sc.nextInt();\n\n\t\t\tdm[] data = new dm[n];\n\n\t\t\tfor (int i = 0; i < n; i++) {\n\n\t\t\t\tdata[i] = new dm(sc.nextInt(), sc.nextInt());\n\n\t\t\t}\n\n\n\n\t\t\tArrays.sort(data);\n\n\n\n\t\t\tint[][] dp = new int[n + 1][t];\n\n\t\t\tfor(int i = 0; i < n+1 ; i++){\n\n\t\t\tArrays.fill(dp[i], Integer.MAX_VALUE >> 4);\n\n\t\t\t}\n\n\t\t\tdp[0][0] = 0;\n\n\n\n\t\t\tint dd[] = new int[n];\n\n\t\t\tdd[0] = 0;\n\n\t\t\tfor (int i = 1; i < n; i++) {\n\n\t\t\t\tdd[i] = data[i].d - data[i - 1].d;\n\n\t\t\t}\n\n\n\n\t\t\tfor (int i = 0; i < n; i++) {\n\n\t//\t\t\tSystem.out.println(Arrays.toString(dp[i+1]));\n\n\t\t\t\tfor (int z = 0; z < t; z++) {\n\n\t\t\t\t\tdp[i + 1][0] = Math.min(dp[i][z] + 1, dp[i + 1][0]);\n\n\t\t\t\t}\n\n\t\t\t\tfor (int z = 0; z <= dd[i] && z < t; z++) {\n\n\t\t\t\t\tif (data[i].m >= r[z]) {\n\n\t\t\t\t\t\tdp[i + 1][z] = Math.min(dp[i + 1][z], dp[i + 1][0]);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t//\t\t\tSystem.out.println(Arrays.toString(dp[i+1]));\n\n\n\n\t\t\t\tfor (int z = 0; z < t; z++) {\n\n\t\t\t\t\tint trr = z + dd[i];\n\n\t\t\t\t\ttrr %= t;\n\n\t\t\t\t\tif (data[i].m >= r[trr]) {\n\n\t\t\t\t\t\tdp[i + 1][trr] = Math.min(dp[i + 1][trr], dp[i][z]);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor(int i =0 ; i < n+1;i++){\n\n//\t\t\t\tSystem.out.println(Arrays.toString(dp[i]));\n\n\t\t\t}\n\n\t\t\tint ans = 10000;\n\n\t\t\tfor (int i = 0; i < t; i++) {\n\n\t\t\t\tans = Math.min(ans, dp[n][i]);\n\n\t\t\t}\n\n\t\t\tSystem.out.println(ans);\n\n\t\t}\n\n\n\n\t}\n\n\n\n\tpublic static void main(String[] args) {\n\n\t\tMain m = new Main();\n\n\t\tm.run();\n\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\n\tclass State implements Comparable<State> {\n\t\tint d, m;\n\n\t\tState(int d, int m) {\n\t\t\tthis.d = d;\n\t\t\tthis.m = m;\n\t\t}\n\n\t\tpublic int compareTo(State s) {\n\t\t\treturn d - s.d;\n\t\t}\n\t}\n\t\n\tint MAX = 1001;\n\tint INF = 1000000000;\n\t\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tint T = in.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\t\n\t\t\tint[] t = in.nextIntArray(T);\n\t\t\tint N = in.nextInt();\n\t\t\tState[] st = new State[N];\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tst[i] = new State(in.nextInt(), in.nextInt());\n\t\t\t}\n\t\t\tArrays.sort(st);\n\t\t\t\n\t\t\tint[] time = new int[MAX+1];\n\t\t\tArrays.fill(time, -1);\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\ttime[st[i].d] = Math.max(time[st[i].d], st[i].m);\n\t\t\t}\n\t\t\t\n\t\t\tint[][] dp = new int[MAX+1][T];\n\t\t\tfor (int i = 0; i <= MAX; i++) Arrays.fill(dp[i], INF);\n\t\t\tdp[0][0] = 0;\n\t\t\t\n\t\t\tfor (int i = 0; i < MAX; i++) {\n\t\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\t\tint next = (j + 1) % T;\n\t\t\t\t\t//(t[j] + 20) % 24 < M[cur] || t[j] <= 4)) \n\t\t\t\t\tif (time[i+1] == -1 || t[j] < time[j]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1] = Math.min(dp[i][j] + 1, dp[i+1][1]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint res = INF;\n\t\t\tfor (int i = 0; i < T; i++) \n\t\t\t\tres = Math.min(res, dp[MAX][i]);\n\t\t\tSystem.out.println(res);\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tScanner sc = new Scanner(System.in);\n\tpublic void run() {\n\t\twhile(sc.hasNext()){\n\t\t\tint t = sc.nextInt();\n\t\t\tif(t == 0 )break;\n\t\t\telse calc(t);\n\t\t\t\n\t\t}\n\t}\n\tpublic void calc(int t){\n\t\tint[] cycle = new int[t];\n\t\tfor(int i = 0; i < t; i++){\n\t\t\tcycle[i] = sc.nextInt();\n\t\t}\n\t\tint n = sc.nextInt();\n\t\tint[] inteview = new int[101];\n\t\tArrays.fill(inteview, Integer.MAX_VALUE);\n\t\tfor(int i = 0; i < n;i++){\n\t\t\tint d = sc.nextInt();\n\t\t\tint m = sc.nextInt();\n\t\t\tinteview[d] = m;\n\t\t}\n\t\t\n\t\tint[][] memo = new int[101][t];\n\t\tfor(int i = 0; i < 101; i++){\n\t\t\tfor(int j = 0; j < t; j++){\n\t\t\t\tmemo[i][j] = Integer.MAX_VALUE;\n\t\t\t}\n\t\t}\n\t\tmemo[1][0] = 0;\n\t\tfor(int i = 1; i < t; i++){\n\t\t\tmemo[1][i] = -1;\n\t\t}\n\t\tfor(int d = 2; d < 101; d++){\n\t\t\tif(inteview[d] >= cycle[0] && memo[d-1][t-1] != -1){\n\t\t\t\tmemo[d][0] = memo[d-1][t-1];\n\t\t\t}\n\t\t\tfor(int c = 1; c < t; c++){\n\t\t\t\tif(memo[d-1][c-1] == -1){\n\t\t\t\t\tmemo[d][c] = -1;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tif(inteview[d] >= cycle[c])\n\t\t\t\t\t\tmemo[d][c] = memo[d-1][c-1];\n\t\t\t\t\telse memo[d][c] = -1;\n\t\t\t\t\tif(memo[d][0] > memo[d-1][c-1] + 1){\n\t\t\t\t\t\tmemo[d][0] = memo[d-1][c-1] + 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans = Integer.MAX_VALUE;\n\t\tfor(int i = 0; i < t; i++){\n\t\t\tif(memo[100][i] < ans) ans = memo[100][i];\n\t\t}\n\t\tSystem.out.println(ans);\n\t}\n\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\t\n\tint MAX = 1001;\n\tint INF = 1000000000;\n\t\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tint T = in.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\tif (T == 1) {\n\t\t\t\tSystem.out.println(0);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tint[] t = in.nextIntArray(T);\n\t\t\tint N = in.nextInt();\n\t\t\t\n\t\t\tint[] time = new int[MAX+1];\n\t\t\tArrays.fill(time, INF);\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tint d = in.nextInt(), m = in.nextInt();\n\t\t\t\ttime[d] = Math.min(time[d], m);\n\t\t\t}\n\t\t\t\n\t\t\tint[][] dp = new int[MAX+1][T];\n\t\t\tfor (int i = 0; i <= MAX; i++) Arrays.fill(dp[i], INF);\n\t\t\tdp[1][1] = 0;\n\t\t\t\n\t\t\tfor (int i = 1; i < MAX; i++) {\n\t\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\t\tint next = (j + 1) % T;\n\t\t\t\t\tif (t[j] <= time[i+1]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1] = Math.min(dp[i][j] + 1, dp[i+1][1]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint res = INF;\n\t\t\tfor (int i = 0; i < T; i++) \n\t\t\t\tres = Math.min(res, dp[MAX][i]);\n\t\t\tSystem.out.println(res);\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport static java.lang.System.*;\nimport static java.lang.Math.*;\n\npublic class Main {\n\n\tScanner sc = new Scanner(in); \n\t\n\tvoid run() {\n\t\tint[] t = new int[30];\n\t\tint[] time = new int[101];\n\t\tint[] c = new int[101];\n\t\tint[][] cost = new int[101][101];\n\t\tint[] dis = new int[101];\n\t\tboolean[] used = new boolean[101];\n\t\tint INF = Integer.MAX_VALUE/2;\n\t\twhile (true) {\n\t\t\tint T = sc.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\tfor (int i = 0; i < T; i++)\n\t\t\t\tt[i] = sc.nextInt();\n\t\t\tint N = sc.nextInt();\n\t\t\tArrays.fill(time, INF);\n\t\t\tint max = -1;\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tint d = sc.nextInt(), m = sc.nextInt();\n\t\t\t\ttime[d] = min(time[d],m);\n\t\t\t\tmax = max(max, d);\n\t\t\t}\n\t\t\t\n\t\t\tI:for (int i = 1; i <= max; i++) {\n\t\t\t\tfor (int j = i; j < i+T && j <= max; j++) {\n\t\t\t\t\tif (time[j] < t[j-i]) {\n\t\t\t\t\t\tc[i] = j-1;\n\t\t\t\t\t\tcontinue I;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tc[i] = (max <= i+T-1) ? max : i+T-1;\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\tfor (int i = 0; i < 101; i++)\n\t\t\t\tArrays.fill(cost[i], INF);\n\t\t\t\n\t\t\tfor (int i = 1; i < max; i++) {\n\t\t\t\tfor (int j = i+1; j <= c[i]; j++) {\n\t\t\t\t\tcost[i][j] = 1;\n\t\t\t\t}\n\t\t\t\tif (c[i] != max) {\n\t\t\t\t\tif (c[i]-i == T-1) {\n\t\t\t\t\t\tcost[i][c[i]+1] = 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcost[i][c[i]+1] = 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tArrays.fill(dis, INF);\n\t\t\tArrays.fill(used, false);\n\t\t\tdis[1] = 0;\n\t\t\twhile (true) {\n\t\t\t\tint v = -1;\n\t\t\t\tfor (int i = 1; i <= max; i++) {\n\t\t\t\t\tif (!used[i] && (v == -1 || dis[i] < dis[v])) v = i;\n\t\t\t\t}\n\t\t\t\tif (v == -1) break;\n\t\t\t\tused[v] = true;\n\t\t\t\tfor (int i = 1; i <= max; i++) {\n\t\t\t\t\tdis[i] = min(dis[i], dis[v]+cost[v][i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tint res = INF;\n\t\t\tfor (int i = 1; i <= max; i++) {\n\t\t\t\tif (c[i] == max)\n\t\t\t\t\tres = min(res, dis[i]);\n\t\t\t}\n\t\t\tout.println(res);\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.OutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\n/**\n * Built using CHelper plug-in\n * Actual solution is at the top\n */\npublic class Main {\n    public static void main(String[] args) {\n        InputStream inputStream = System.in;\n        OutputStream outputStream = System.out;\n        Scanner in = new Scanner(inputStream);\n        PrintWriter out = new PrintWriter(outputStream);\n        ErraticSleepHabits solver = new ErraticSleepHabits();\n        try {\n            int testNumber = 1;\n            while (true)\n                solver.solve(testNumber++, in, out);\n        } catch (UnknownError e) {\n            out.close();\n        }\n    }\n\n    static class ErraticSleepHabits {\n        public void solve(int testNumber, Scanner in, PrintWriter out) {\n            final int INF = (int) 1e9;\n            int T = in.nextInt();\n            if (T == 0) {\n                throw new UnknownError();\n            }\n            int[] t = new int[T]; // cycle\n            for (int i = 0; i < T; i++) {\n                t[i] = in.nextInt();\n            }\n            int N = in.nextInt();\n            int[] d = new int[101];\n            Arrays.fill(d, INF);\n            for (int i = 0; i < N; i++) {\n                int day = in.nextInt();\n                d[day] = Math.min(d[day], in.nextInt());\n            }\n            final int MAX_DAY = 101;\n            int[][] dp = new int[MAX_DAY][T];\n            for (int i = 0; i < MAX_DAY; i++) {\n                Arrays.fill(dp[i], INF);\n            }\n            dp[0][0] = 0;\n            for (int i = 0; i < MAX_DAY - 1; i++) {\n                for (int j = 0; j < T; j++) {\n                    if (dp[i][j] < INF) {\n                        int nxtCycle = (j + 1) % T;\n                        if (t[nxtCycle] <= d[i]) {\n                            // サイクルリセットしない\n                            dp[i + 1][nxtCycle] = Math.min(dp[i + 1][nxtCycle], dp[i][j]);\n                        }\n                        if (t[0] <= d[i]) {\n                            // サイクルリセットする\n                            dp[i + 1][0] = Math.min(dp[i + 1][0], dp[i][j] + 1);\n                        }\n                    }\n                }\n            }\n            int ans = INF;\n            for (int i = 0; i < T; i++) {\n                ans = Math.min(ans, dp[MAX_DAY - 1][i]);\n            }\n            out.println(ans);\n        }\n\n    }\n}\n\n\n"
  },
  {
    "language": "Java",
    "code": "\nimport java.io.*;\nimport java.util.*;\n\npublic class Main {\n\tFastScanner in = new FastScanner(System.in);\n\tPrintWriter out = new PrintWriter(System.out);\n\n\tint MAX = 1001;\n\tint INF = 1000000000;\n\tpublic void run() {\n\t\twhile (true) {\n\t\t\tint T = in.nextInt();\n\t\t\tif (T == 0) break;\n\t\t\t\n\t\t\tint[] t = in.nextIntArray(T);\n\t\t\tint N = in.nextInt();\n\t\t\tint[] D = new int[N];\n\t\t\tint[] M = new int[N];\n\t\t\tfor (int i = 0; i < N; i++) {\n\t\t\t\tD[i] = in.nextInt();\n\t\t\t\tM[i] = in.nextInt();\n\t\t\t}\n\t\t\t\n\t\t\tint[][] dp = new int[MAX+1][T];\n\t\t\tfor (int i = 0; i <= MAX; i++) Arrays.fill(dp[i], INF);\n\t\t\tdp[0][0] = 0;\n\t\t\t\n\t\t\tint cur = 0;\n\t\t\tfor (int i = 0; i <= MAX && cur < N; i++) {\n\t\t\t\tfor (int j = 0; j < T; j++) {\n\t\t\t\t\tint next = (j + 1) % T;\n\t\t\t\t\tif (i == D[cur] && t[j] <= M[cur]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t} else if (i != D[cur]) {\n\t\t\t\t\t\tdp[i+1][next] = Math.min(dp[i+1][next], dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i+1][1] = Math.min(dp[i][j] + 1, dp[i+1][1]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tif (i == D[cur]) cur++;\n\t\t\t}\n\t\t\t\n\t\t\tcur--;\n\t\t\tint res = INF;\n\t\t\tfor (int i = 0; i < T; i++) \n\t\t\t\tres = Math.min(res, dp[D[cur]][i]);\n\t\t\tSystem.out.println(res);\n\t\t}\n\t\tout.close();\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\n\t\tSystem.out.println(\"----------------------------\");\n\t\tSystem.out.println();\n\t}\n\n\tpublic void debug(Object... obj) {\n\t\tSystem.out.println(Arrays.deepToString(obj));\n\t}\n\n\tclass FastScanner {\n\t\tprivate InputStream stream;\n\t\tprivate byte[] buf = new byte[1024];\n\t\tprivate int curChar;\n\t\tprivate int numChars;\n\n\t\tpublic FastScanner(InputStream stream) {\n\t\t\tthis.stream = stream;\n\t\t\t//stream = new FileInputStream(new File(\"dec.in\"));\n\n\t\t}\n\n\t\tint read() {\n\t\t\tif (numChars == -1)\n\t\t\t\tthrow new InputMismatchException();\n\t\t\tif (curChar >= numChars) {\n\t\t\t\tcurChar = 0;\n\t\t\t\ttry {\n\t\t\t\t\tnumChars = stream.read(buf);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (numChars <= 0)\n\t\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn buf[curChar++];\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nclass Main{\n\n    void solve(){\n        Scanner sc = new Scanner(System.in);\n\n        int INF = Integer.MAX_VALUE;\n\n        while(true){\n            int T = sc.nextInt();\n            if(T==0) break;\n            int[] t = new int[T];\n            for(int i=0; i<T; i++) t[i] = sc.nextInt();\n\n            int n = sc.nextInt();\n            int[] time = new int[105];\n            Arrays.fill(time, INF);\n\n            int max = 0;\n            for(int i=0; i<n; i++){\n                int d = sc.nextInt()-1, m = sc.nextInt();\n                max = Math.max(max, d);\n                time[d] = Math.min(time[d], m);\n            }\n\n            int[][] dp = new int[max+2][T];\n            for(int i=0; i<=max; i++) Arrays.fill(dp[i], INF);\n            dp[0][0] = 0;\n\n            for(int i=0; i<max; i++){\n                for(int j=0; j<T; j++){\n                    if(dp[i][j]==INF) continue;\n                    if(time[i+1]>=t[(j+1)%t.length]){\n                        dp[i+1][(j+1)%t.length] = dp[i][j];\n                    }\n                    dp[i+1][0] = Math.min(dp[i+1][0], dp[i][j] + 1);\n                    //dp[i+1][0] = Math.min(dp[i+1][0], dp[i][j] + 1);\n                }\n                //if(dp[i-1][t.length-1]!=INF) dp[i][0] = Math.min(dp[i][0], dp[i-1][t.length-1]);\n            }\n\n            //for(int i=0; i<=max; i++) System.out.println(Arrays.toString(dp[i]));\n\n            int min = Integer.MAX_VALUE;\n            for(int i=0; i<T; i++){\n                min = Math.min(min, dp[max][i]);\n            }\n            System.out.println(min);\n        }\n    }\n\n    public static void main(String[] args){\n        new Main().solve();\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main{\n\t\n\tprivate void doit(){\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tint n = sc.nextInt();\n\t\t\tif(n == 0) break;\n\t\t\tint [] cy = new int[n];\n\t\t\tfor(int i = 0; i < n; i++){\n\t\t\t\tcy[i] = sc.nextInt();\n\t\t\t}\n\t\t\tint m = sc.nextInt();\n\t\t\tint [] sche = new int[101];\n\t\t\tArrays.fill(sche, 23);\n\t\t\tfor(int i = 0; i < m; i++){\n\t\t\t\tint day = sc.nextInt();\n\t\t\t\tsche[day] = Math.min(sche[day], sc.nextInt());\n\t\t\t}\n\t\t\t\n\t\t\tint [][] dp = new int[101][n];\n\t\t\tint INF = 1 << 24;\n\t\t\tfor(int i = 0; i < 101; i++){\n\t\t\t\tArrays.fill(dp[i], INF);\n\t\t\t}\n\t\t\tdp[1][0] = 0;\n\t\t\tfor(int i = 1; i < 100; i++){\n\t\t\t\tfor(int j = 0; j < n; j++){\n\t\t\t\t\tif(dp[i][j] == INF) continue;\n\t\t\t\t\tif(cy[(j + 1) % n] <= sche[i + 1]){\n\t\t\t\t\t\tdp[i + 1][(j + 1) % n] = Math.min(dp[i][j], dp[i + 1][(j + 1) % n]);\n\t\t\t\t\t}\n\t\t\t\t\tdp[i + 1][0] = Math.min(dp[i + 1][0], dp[i][j] + 1);\n\t\t\t\t}\n\t\t\t}\n\t\t\tint min = INF;\n\t\t\tfor(int i = 0; i < n; i++){\n\t\t\t\tmin = Math.min(min, dp[100][i]);\n\t\t\t}\n\t\t\tSystem.out.println(min);\n\t\t}\n\t}\n\n\tprivate void debug(Object... o) {\n\t\tSystem.out.println(\"debug = \" + Arrays.deepToString(o));\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().doit();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nimport java.lang.*;\n\nimport java.math.*;\n\n\n\npublic class Main {\n\n\tScanner sc = new Scanner(System.in);\n\n\n\n\tclass dm implements Comparable<dm> {\n\n\t\tint d;\n\n\t\tint m;\n\n\n\n\t\tdm(int d, int m) {\n\n\t\t\tthis.d = d;\n\n\t\t\tthis.m = m;\n\n\t\t}\n\n\n\n\t\tpublic int compareTo(dm tar) {\n\n\t\t\tif (d == tar.d)\n\n\t\t\t\treturn m - tar.m;\n\n\t\t\treturn d - tar.d;\n\n\t\t}\n\n\t}\n\n\n\n\tvoid run() {\n\n\t\tfor (;;) {\n\n\t\t\tint t = sc.nextInt();\n\n\t\t\tint r[] = new int[t];\n\n\n\n\t\t\tif (t == 0) {\n\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tfor (int i = 0; i < t; i++) {\n\n\t\t\t\tr[i] = sc.nextInt();\n\n\t\t\t}\n\n\n\n\t\t\tint n = sc.nextInt();\n\n\t\t\tint d[] = new int[n];\n\n\t\t\tint m[] = new int[n];\n\n\t\t\tdm[] data = new dm[n];\n\n\t\t\tfor (int i = 0; i < n; i++) {\n\n\t\t\t\tdata[i] = new dm(sc.nextInt(), sc.nextInt());\n\n\t\t\t}\n\n\n\n\t\t\tArrays.sort(data);\n\n\n\n\t\t\tint[][] dp = new int[n + 1][t];\n\n\t\t\tfor(int i = 0; i < n+1 ; i++){\n\n\t\t\tArrays.fill(dp[i], Integer.MAX_VALUE >> 4);\n\n\t\t\t}\n\n\t\t\tdp[0][0] = 0;\n\n\n\n\t\t\tint dd[] = new int[n];\n\n\t\t\tdd[0] = 0;\n\n\t\t\tfor (int i = 1; i < n; i++) {\n\n\t\t\t\tdd[i] = data[i].d - data[i - 1].d;\n\n\t\t\t}\n\n\n\n\t\t\tfor (int i = 0; i < n; i++) {\n\n\t//\t\t\tSystem.out.println(Arrays.toString(dp[i+1]));\n\n\t\t\t\tfor (int z = 0; z < t; z++) {\n\n\t\t\t\t\tdp[i + 1][0] = Math.min(dp[i][z] + 1, dp[i + 1][0]);\n\n\t\t\t\t}\n\n\t\t\t\tfor (int z = 0; z < dd[i]; z++) {\n\n\t\t\t\t\tif (data[i].m >= r[z]) {\n\n\t\t\t\t\t\tdp[i + 1][z] = Math.min(dp[i + 1][z], dp[i + 1][0]);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t//\t\t\tSystem.out.println(Arrays.toString(dp[i+1]));\n\n\n\n\t\t\t\tfor (int z = 0; z < t; z++) {\n\n\t\t\t\t\tint trr = z + dd[i];\n\n\t\t\t\t\ttrr %= t;\n\n\t\t\t\t\tif (data[i].m >= r[trr]) {\n\n\t\t\t\t\t\tdp[i + 1][trr] = Math.min(dp[i + 1][trr], dp[i][z]);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor(int i =0 ; i < n+1;i++){\n\n//\t\t\t\tSystem.out.println(Arrays.toString(dp[i]));\n\n\t\t\t}\n\n\t\t\tint ans = 10000;\n\n\t\t\tfor (int i = 0; i < t; i++) {\n\n\t\t\t\tans = Math.min(ans, dp[n][i]);\n\n\t\t\t}\n\n\t\t\tSystem.out.println(ans);\n\n\t\t}\n\n\n\n\t}\n\n\n\n\tpublic static void main(String[] args) {\n\n\t\tMain m = new Main();\n\n\t\tm.run();\n\n\t}\n\n}"
  },
  {
    "language": "JavaScript",
    "code": "var n;\nvar t = [];\nvar m;\nvar s = [];\nvar dp = [];\n\nfunction main(){\n\twhile(n = scan()){\n\t\trep(n, function(i){\n\t\t\tt[i] = scan();\n\t\t});\n\n\t\tm = scan();\n\t\trep(100, function(i){\n\t\t\ts[i] = Infinity;\n\t\t});\n\t\trep(m, function(i){\n\t\t\tvar d = scan() - 1;\n\t\t\ts[d] = scan();\n\t\t});\n\n\t\trep(100, function(i){\n\t\t\tdp[i] = [];\n\t\t});\n\t\tdp[0][0] = 0;\n\t\trep(1, n, function(i){\n\t\t\tdp[0][i] = Infinity;\n\t\t});\n\t\trep(1, 100, function(i){\n\t\t\trep(n, function(j){\n\t\t\t\tif(s[i] < t[j]){\n\t\t\t\t\tdp[i][j] = Infinity;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tdp[i][j] = dp[i - 1][(j + n - 1) % n];\n\t\t\t\t}\n\t\t\t});\n\t\t\tdp[i][0] = Math.min(Math.min.apply(null, dp[i - 1]) + 1, dp[i][0]);\n\t\t});\n\n\t\tprint(Math.min.apply(null, dp[99]));\n\t}\n}\n\nfunction rep(a, b, c){\n\tif(c === undefined){\n\t\tc = b;\n\t\tb = a;\n\t\ta = 0;\n\t}\n\tfor(var i = a; i < b; ++i){\n\t\tif(c(i) === false){\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nvar input = '';\n\nfunction scan(){\n\treturn +input.pop();\n}\nfunction scan_string(){\n\treturn input.pop();\n} \nfunction print(val){\n\tconsole.log(val);\n}\n \nprocess.stdin.resume();\nprocess.stdin.setEncoding('utf8');\nprocess.stdin.on('data', function(chunk){\n\tinput += chunk;\n});\nprocess.stdin.on('end', function(){\n\tinput = input.trim().split(/\\s+/).reverse();\n\tmain();\n});"
  },
  {
    "language": "JavaScript",
    "code": "var n;\nvar t = [];\nvar m;\nvar s = [];\nvar dp = [];\n\nfunction main(){\n\twhile(n = scan()){\n\t\trep(n, function(i){\n\t\t\tt[i] = scan();\n\t\t});\n\n\t\tm = scan();\n\t\trep(100, function(i){\n\t\t\ts[i] = Infinity;\n\t\t});\n\t\trep(m, function(i){\n\t\t\tvar d = scan() - 1;\n\t\t\ts[d] = Math.min(scan(), s[d]);\n\t\t});\n\n\t\trep(100, function(i){\n\t\t\tdp[i] = [];\n\t\t});\n\t\tdp[0][0] = 0;\n\t\trep(1, n, function(i){\n\t\t\tdp[0][i] = Infinity;\n\t\t});\n\t\trep(1, 100, function(i){\n\t\t\trep(n, function(j){\n\t\t\t\tif(s[i] < t[j]){\n\t\t\t\t\tdp[i][j] = Infinity;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tdp[i][j] = dp[i - 1][(j + n - 1) % n];\n\t\t\t\t}\n\t\t\t});\n\t\t\tdp[i][0] = Math.min(Math.min.apply(null, dp[i - 1]) + 1, dp[i][0]);\n\t\t});\n\n\t\tprint(Math.min.apply(null, dp[99]));\n\t}\n}\n\nfunction rep(a, b, c){\n\tif(c === undefined){\n\t\tc = b;\n\t\tb = a;\n\t\ta = 0;\n\t}\n\tfor(var i = a; i < b; ++i){\n\t\tif(c(i) === false){\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nvar input = '';\n\nfunction scan(){\n\treturn +input.pop();\n}\nfunction scan_string(){\n\treturn input.pop();\n} \nfunction print(val){\n\tconsole.log(val);\n}\n \nprocess.stdin.resume();\nprocess.stdin.setEncoding('utf8');\nprocess.stdin.on('data', function(chunk){\n\tinput += chunk;\n});\nprocess.stdin.on('end', function(){\n\tinput = input.trim().split(/\\s+/).reverse();\n\tmain();\n});"
  },
  {
    "language": "Ruby",
    "code": "def solve(dp,u,t,d,i,tl)\n    return dp[d][i] if dp[d][i] != -1\n    return dp[d][i] = 0 if d == 100\n    return dp[d][i] = Float::INFINITY if u[d] < t[i]\n    return dp[d][i] = [solve(dp, u, t, d+1, (i+1)%tl, tl), 1 + solve(dp, u, t, d+1, 0, tl)].min\nend\nloop do\n    tl = gets.to_i\n    break if tl == 0\n    t = gets.split.map(&:to_i)\n    n = gets.to_i\n    u = Array.new(100, Float::INFINITY)\n    n.times do\n        int = gets.split.map(&:to_i)\n        u[int[0] - 1] = int[1] if int[1] < u[int[0] - 1]\n    end\n    dp = Array.new(101).map{Array.new(33,-1)}\n    puts solve(dp,u,t,0,0,tl)\nend"
  },
  {
    "language": "Ruby",
    "code": "loop do\n    t = gets.to_i\n    break if t == 0\n    cycle = gets.split.map(&:to_i)\n\n    schedule = Hash.new(Float::INFINITY)\n    n = gets.to_i\n    n.times do\n        d, t = gets.split.map(&:to_i)\n        schedule[d] = t if t < schedule[d]\n    end\n\n    table = [nil] * cycle.size\n    table[-1] = 0\n    (1..schedule.keys.max).each do |d|\n        m = table.compact.min + 1\n        table.unshift(table.pop)\n        (1..cycle.size-1).each do |i|\n            table[i] = nil if cycle[i] > schedule[d]\n        end\n        table[0] = m if !table[0] || m < table[0]\n    end\n\n    p table.compact.min\nend"
  },
  {
    "language": "Ruby",
    "code": "loop do\n    t = gets.to_i\n    break if t == 0\n    cycle = gets.split.map(&:to_i)\n\n    table = [nil] * cycle.size\n    table[0] = 0\n    n = gets.to_i\n    d0 = 1\n    interviews = (1..n).map { gets.split.map(&:to_i) }.sort\n    interviews.each do |d, t|\n        new_table = [nil] * cycle.size\n        table.each.with_index do |m, i|\n            j = (i + d - d0) % cycle.size\n            new_table[j] = m if m && cycle[j] <= t\n        end\n        m = table.compact.min + 1\n        new_table[0] = m if !new_table[0] || m < new_table[0]\n        d0 = d\n        p table = new_table\n    end\n\n    puts table.compact.min\nend"
  },
  {
    "language": "Ruby",
    "code": "loop do\n    t = gets.to_i\n    break if t == 0\n    cycle = gets.split.map(&:to_i)\n\n    table = [nil] * cycle.size\n    table[0] = 0\n    n = gets.to_i\n    d0 = 1\n    (1..n).each do\n        d, t = gets.split.map(&:to_i)\n        new_table = [nil] * cycle.size\n        table.each.with_index do |m, i|\n            j = (i + d - d0) % cycle.size\n            new_table[j] = m if m && cycle[j] <= t\n        end\n        m = table.compact.min + 1\n        new_table[0] = m if !new_table[0] || m < new_table[0]\n        d0 = d\n        table = new_table\n    end\n\n    puts table.compact.min\nend"
  },
  {
    "language": "D",
    "code": "import std.stdio;\nimport std.c.stdio;\nimport std.range;\nimport std.array;\nimport std.functional;\nimport std.algorithm;\nimport std.conv;\nimport std.container;\nimport std.math;\nimport std.numeric;\nimport std.string;\nimport std.c.string;\nimport std.regex;\nimport std.typecons;\n \nvoid main() {\n    const X = 101;\n    const INF = int.max / 4;\n\n    int[] T;\n    int[] P;\n    bool input() {\n        int t; scanf(\"%d\\n\", &t);\n        if (t == 0) return false;\n        T = readln.chomp.split(\" \").map!(to!int).array;\n        int N; scanf(\"%d\\n\", &N);\n        P = new int[X];\n        P[] = INF;\n        foreach (i; 0 .. N) {\n            int D, M; scanf(\"%d %d\\n\", &D, &M);\n            P[D] = min(P[D], M);\n        }\n        return true;\n    }\n\n    void solve() {\n        auto dp = new int[][](X, T.length);\n        foreach (i; 0 .. X) dp[i][] = INF;\n        dp[1][0] = 0;\n        foreach (i; 2 .. X) {\n            dp[i][0] = min(dp[i][0], dp[i - 1][T.length - 1]);\n            dp[i][0] = min(dp[i][0], dp[i - 1].reduce!min + 1);\n            foreach (j; 1 .. T.length) {\n                if (P[i] < T[j]) continue;\n                dp[i][j] = min(dp[i][j], dp[i - 1][j - 1]);\n            }\n        }\n        /*\n        foreach (i; 1 .. X) {\n            writeln(dp[i].map!((a) => a == INF ? -1 : a));\n        }\n        */\n        writeln(dp[X - 1].reduce!min);\n    }\n\n    while (input) solve;\n}"
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,random,time,copy,functools\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 10**9+7\ndd = [(0,-1),(1,0),(0,1),(-1,0)]\nddn = [(0,-1),(1,-1),(1,0),(1,1),(0,1),(-1,-1),(-1,0),(-1,1)]\n\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\n\n\ndef main():\n    rr = []\n\n    while True:\n        T = I()\n        if T == 0:\n            break\n        t = LI()\n        n = I()\n        a = sorted([LI() for _ in range(n)])\n        c = collections.defaultdict(lambda: inf)\n        c[-1] = 0\n        cd = 0\n        for d,m in a:\n            nt = d - cd\n            nd = collections.defaultdict(lambda: inf)\n            for k,v in c.items():\n                if t[(k+nt) % T] <= m:\n                    if nd[(k+nt) % T] > v:\n                        nd[(k+nt) % T] = v\n                if nd[0] > v+1:\n                    nd[0] = v+1\n            c = nd\n            cd = d\n        rr.append(min(c.values()))\n\n\n    return '\\n'.join(map(str,rr))\n\n\nprint(main())\n\n\n"
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,random,time,copy,functools\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 10**9+7\ndd = [(0,-1),(1,0),(0,1),(-1,0)]\nddn = [(0,-1),(1,-1),(1,0),(1,1),(0,1),(-1,-1),(-1,0),(-1,1)]\n\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\n\n\ndef main():\n    rr = []\n\n    while True:\n        T = I()\n        if T == 0:\n            break\n        t = LI()\n        n = I()\n        a = sorted([LI() for _ in range(n)])\n        ad = collections.defaultdict(lambda: inf)\n        for d,m in a:\n            if ad[d] > m:\n                ad[d] = m\n        c = collections.defaultdict(lambda: inf)\n        c[-1] = 0\n        cd = 0\n        for d in range(1,max(ad.keys()) + 1):\n            m = ad[d]\n            nt = 1\n            nd = collections.defaultdict(lambda: inf)\n            for k,v in c.items():\n                if t[(k+nt) % T] <= m:\n                    if nd[(k+nt) % T] > v:\n                        nd[(k+nt) % T] = v\n                if nd[0] > v+1:\n                    nd[0] = v+1\n            c = nd\n            cd = d\n        rr.append(min(c.values()))\n\n\n    return '\\n'.join(map(str,rr))\n\n\nprint(main())\n\n\n"
  },
  {
    "language": "Python",
    "code": "INF = 10**10\ndef rec(cur, cycle):\n    if   dp[cur][cycle] > -1: pass\n    elif cur == 100: dp[cur][cycle] = 0\n    elif until[cur] < t[cycle]: dp[cur][cycle] = INF\n    else: dp[cur][cycle] = min(rec(cur+1, (cycle+1)%T), 1+rec(cur+1, 0))\n    return dp[cur][cycle]\n    \nwhile 1:\n    T = int(raw_input())\n    if T == 0: break\n    t = map(int,raw_input().split())\n    N = int(raw_input())\n    until = [INF]*100\n    for loop in xrange(N):\n        D,M = map(int,raw_input().split())\n        until[D-1] = M\n    \n    dp = [[-1]*33 for i in xrange(101)]\n    print rec(0,0)"
  },
  {
    "language": "Python",
    "code": "INF = 10**10\ndef rec(cur, cycle):\n    if   dp[cur][cycle] > -1: pass\n    elif cur == 100: dp[cur][cycle] = 0\n    elif until[cur] < t[cycle]: dp[cur][cycle] = INF\n    else: dp[cur][cycle] = min(rec(cur+1, (cycle+1)%T), 1+rec(cur+1, 0))\n    return dp[cur][cycle]\n    \nwhile 1:\n    T = int(raw_input())\n    if T == 0: break\n    t = map(int,raw_input().split())\n    N = int(raw_input())\n    until = [INF]*100\n    for loop in xrange(N):\n        D,M = map(int,raw_input().split())\n        until[D-1] = min(until[D-1], M)\n    \n    dp = [[-1]*33 for i in xrange(101)]\n    print rec(0,0)"
  }
]