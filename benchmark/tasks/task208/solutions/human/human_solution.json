[
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\n#include<algorithm>\n#define F first\n#define S second\nusing namespace std;\ntypedef pair<int,int> P;\ntypedef vector<vector<char> > VVC;\nint dx[] = {0,1};\nint dy[] = {1,0};\nvector<string> message;\nint h,w;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() != b.size())\n    return a.size() > b.size();\n\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] > b[i];\n  return true;\n}\n\nvoid dfs(string secret,P p,VVC& G)\n{\n  bool update = false;\n  for(int i=0;i<2;i++)\n    {\n      int nx = p.F + dx[i];\n      int ny = p.S + dy[i];\n      if(!(0 <= nx && nx < w && 0 <= ny && ny < h) || !('0'<=G[ny][nx] && G[ny][nx]<='9' ))\n\tcontinue;\n\n      update = true;\n      dfs(secret+G[ny][nx],P(nx,ny),G);\n    }\n\n  if(!update)\n    message.push_back(secret);\n}\n\nint main()\n{\n\n  while(true)\n    {\n      cin >> w >> h;\n      if(w+h == 0)\n\tbreak;\n      message.clear();\n      VVC G;\n      G.resize(h);\n      for(int i=0;i<h;i++)\n\t{\n\t  G[i].resize(w);\n\t  for(int j=0;j<w;j++)\n\t    cin >> G[i][j];\n\t}\n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\t      if('0' <= G[i][j] && G[i][j] <= '9')\n\t\t{\n\t\t  string message;\n\t\t  message += G[i][j];\n\t\t  dfs(message,P(j,i),G);\n\t\t}\n\t    }\n\t}\n\n      sort(message.begin(),message.end(),cmp);\n      cout << message[0] << endl;\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\n\nbool isn(char c){ return c >= '0' && c <= '9'; }\n\nstring cmp(string a,string b){\n\tint i = 0 , j = 0;\n\twhile(a[i]=='0')i++;\n\twhile(b[j]=='0')j++;\n\tif(i == a.size() && j == b.size() ) return \"0\";\n\tif(i == a.size() ) return b;\n\tif(j == b.size() ) return a;\n\ta = a.substr(i);\n\tb = b.substr(j);\n\tif(a.size() == b.size() ) return a < b ? b : a;\n\telse return a.size() < b.size() ? b : a;\n}\n\nint main(){\n\tint H , W;\n\tstring table[70];\n\twhile(cin >> W >> H && W){\n\t\tstring dp[70][70];\n\t\tfor(int i = 0 ; i < H ; i++) cin >> table[i];\n\t\tfor(int i = 0 ; i < H ; i++)\n\t\t\tfor(int j = 0 ; j < W ; j++)\n\t\t\t\tif( isn(table[i][j]) ) dp[i][j] = string(1,table[i][j]);\n\t\tfor(int i = 0 ; i < H ; i++){\n\t\t\tfor(int j = 0 ; j < W ; j ++){\n\t\t\t\tif(isn(table[i][j])){\n\t\t\t\t\tif(i && isn(table[i-1][j]) ) dp[i][j] = cmp(dp[i][j] , dp[i-1][j]+string(1,table[i][j]));\n\t\t\t\t\tif(j && isn(table[i][j-1]) ) dp[i][j] = cmp(dp[i][j] , dp[i][j-1]+string(1,table[i][j]));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring mx = \"\";\n\t\tfor(int i = 0 ; i < H ; i++){\n\t\t\tfor(int j = 0 ; j < W ; j++){\n\t\t\t\tmx = cmp(mx,dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout << mx << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\n#include <ctype.h>\n#include <string> \n#include <cstring>\n#include <sstream>\n#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <map>\n#include <queue>\n#include <utility>\n#include <vector>\n#include <set>\n#include <iomanip>\n#include <stack>\n  \nusing namespace std;\n\n#define pi 3.141592653589793\n\n#define MAX 1000000000\n\nbool ismax(string comp, string ans)\n{\n\t// compが大きい場合true\n\twhile(ans[0] == '0') ans.erase(0, 1);\n\twhile(comp[0] == '0') comp.erase(0, 1);\n\tif(ans.length() < comp.length()) return true;\n\telse if(ans.length() == comp.length()){\n\t\tint n = 0;\n\t\twhile(n < ans.length() && ans[n] == comp[n]){\n\t\t\tn++;\n\t\t}\n\t\tif(n == ans.length() || ans[n] - '0' < comp[n] - '0') return true;\n\t\telse return false;\n\t} else return false;\n}\n\nstring bigger(string comp1, string comp2)\n{\n\t// 第一引数の方が大きい場合true\n\t// int l1 = comp1.length(), l2 = comp2.length();\n\t// while(comp1[0] == '0') comp1.erase(0, 1);\n\t// while(comp2[0] == '0') comp2.erase(0, 1);\n\t// if(comp1 == \"\" && comp2 == \"\"){\n\t\t// if(l1 > l2) return true;\n\t\t// else return false;\n\t// }\n\tif(comp1.length() > comp2.length()) return comp1;\n\telse if(comp1.length() == comp2.length()){\n\t\tint n = 0;\n\t\twhile(n < comp1.length() && comp1[n] == comp2[n]){\n\t\t\tn++;\n\t\t}\n\t\tif(n == comp1.length() || comp1[n] - '0' > comp2[n] - '0') return comp1;\n\t\telse return comp2;\n\t} else return comp2;\n}\n\nstring solve(int w, int h, char c[71][71])\n{\n\tstring ans = \"\";\n\tstring result[72][72];\n\tfor(int i = h; i > 0; i--){\n\t\tresult[i][w + 1] = \"\";\n\t}\n\tfor(int i = w; i > 0; i--){\n\t\tresult[h + 1][i] = \"\";\n\t}\n\tresult[h + 1][w + 1] = \"\";\n\tfor(int i = h; i > 0; i--){\n\t\tfor(int j = w; j > 0; j--){\n\t\t\tresult[i][j] = \"\";\n\t\t\tif(isdigit(c[i][j])){\n\t\t\t\tresult[i][j] += c[i][j];\n\t\t\t\tresult[i][j] += bigger(result[i + 1][j], result[i][j + 1]);\n\t\t\t\tif(ismax(result[i][j], ans)) ans = result[i][j];\n\t\t\t}\n\t\t}\n\t}\n\twhile(ans[0] == '0') ans.erase(0, 1); \n\treturn ans;\n}\n\n\nint main()\n{\n\tint w, h;\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(w == 0 && h == 0) break;\n\t\tchar c[71][71];\n\t\tfor(int i = 1; i < h + 1; i++){\n\t\t\tfor(int j = 1; j < w + 1; j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t}\n\t\t}\n\t\tcout << solve(w, h, c) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <deque>\n#include <list>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <utility>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <complex>\n#include <cmath>\n#include <limits>\n#include <cfloat>\n#include <climits>\n#include <ctime>\n#include <cassert>\nusing namespace std;\n\n#define rep(i,a,n) for(int (i)=(a); (i)<(n); (i)++)\n#define repq(i,a,n) for(int (i)=(a); (i)<=(n); (i)++)\n#define repr(i,a,n) for(int (i)=(a); (i)>=(n); (i)--)\n#define all(v) begin(v), end(v)\n#define pb(a) push_back(a)\n#define fr first\n#define sc second\n#define INF 2000000000\n#define int long long int\n\n#define X real()\n#define Y imag()\n#define EPS (1e-10)\n#define EQ(a,b) (abs((a) - (b)) < EPS)\n#define EQV(a,b) ( EQ((a).X, (b).X) && EQ((a).Y, (b).Y) )\n#define LE(n, m) ((n) < (m) + EPS)\n#define LEQ(n, m) ((n) <= (m) + EPS)\n#define GE(n, m) ((n) + EPS > (m))\n#define GEQ(n, m) ((n) + EPS >= (m))\n\ntypedef vector<int> VI;\ntypedef vector<VI> MAT;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\ntypedef complex<double> P;\ntypedef pair<P, P> L;\ntypedef pair<P, double> C;\n\nint dx[]={1, 0};\nint dy[]={0, 1};\nint const MOD = 1000000007;\nll mod_pow(ll x, ll n) {return (!n)?1:(mod_pow((x*x)%MOD,n/2)*((n&1)?x:1))%MOD;}\nint madd(int a, int b) {return (a + b) % MOD;}\nint msub(int a, int b) {return (a - b + MOD) % MOD;}\nint mmul(int a, int b) {return (a * b) % MOD;}\nint minv(int a) {return mod_pow(a, MOD-2);}\nint mdiv(int a, int b) {return mmul(a, minv(b));}\n\nnamespace std {\n    bool operator<(const P& a, const P& b) {\n        return a.X != b.X ? a.X < b.X : a.Y < b.Y;\n    }\n}\n\nint w, h;\nchar board[110][110];\nstring ans;\n\nvoid dfs(int x, int y, string cur, vector< vector<bool> > used) {\n    bool ok = false;\n    cur += board[x][y];\n    // printf(\"x = %lld, y = %lld\\n\", x, y);\n    rep(i,0,2) {\n        int nx = x + dx[i], ny = y + dy[i];\n        if(nx < 0 || nx >= h || ny < 0 || ny >= w) continue;\n        if('A' <= board[nx][ny] && board[nx][ny] <= 'Z') continue;\n        if(used[nx][ny]) continue;\n        used[nx][ny] = true;\n        ok = true;\n        dfs(nx, ny, cur, used);\n        used[nx][ny] = false;\n    }\n    if(!ok) {\n        if(ans.length() < cur.length()) ans = cur;\n        else if(ans.length() == cur.length()) {\n            if(ans < cur) ans = cur;\n        }\n    }\n}\n\nsigned main() {\n    while(cin >> w >> h, w||h) {\n        rep(i,0,h) rep(j,0,w) cin >> board[i][j];\n        ans = \"\";\n        rep(i,0,h) rep(j,0,w) {\n            vector< vector<bool> > a(h, vector<bool>(w, false));\n            if('0' <= board[i][j] && board[i][j] <= '9') dfs(i, j, \"\", a);\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define DEBUG_ON\n#define CONDITION true\nusing namespace std;/*{{{*/\n\n#include <algorithm>\n#include <cassert>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <iostream>\n#include <iterator>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <sys/time.h>\n#include <vector>\n\n#define INF (1e9)\nstatic const double PI = acos(-1.0);\nstatic const double EPS = 1e-10;\n\ntypedef long long int LL;\ntypedef unsigned long long int ULL;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<double> VD;\ntypedef vector<VD> VVD;\ntypedef vector<bool> VB;\ntypedef vector<VB> VVB;\ntypedef vector<char> VC;\ntypedef vector<VC> VVC;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\n\n#define FOR(i, b, e) for (typeof(e) i = (b); i != (e); i < (e)? ++i : --i)\n#define REP(i, n) FOR(i, 0, n)\n\n#define IFC(c) if(c) continue;\n#define IFB(c) if(c) break;\n#define IFR(c, r) if(c) return r;\n\n#define OPOVER(_op, _type) inline bool operator _op (const _type &t) const\n\n#define arrsz(a) ( sizeof(a) / sizeof(a[0]) )\n\n#define F first\n#define S second\n#define MP(a, b) make_pair(a, b)\n\n#define SZ(a) ((LL)a.size())\n#define PB(e) push_back(e)\n#define SORT(v) sort((v).begin(), (v).end())\n#define RSORT(v) sort((v).rbegin(), (v).rend())\n\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EACH(c,it) for(__typeof((c).begin()) it=(c).begin(); it!=(c).end(); ++it)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n\n#define BIT(n) (assert(n < 64), (1ULL << (n)))\n#define BITOF(n, m) (assert(m < 64), ((ULL)(n) >> (m) & 1))\n\n#define RANGE(a, b, c) ((a) <= (b) && (b) <= (c))\n\n#define PQ priority_queue\n#define SC static_cast\n\n#ifdef DEBUG_ON\n\t#define dprt(fmt, ...) if (CONDITION) fprintf(stderr, fmt, ##__VA_ARGS__)\n\t#define darr(a) if (CONDITION) copy( (a), (a) + arrsz(a), ostream_iterator<int>(cerr, \" \") ); cerr << endl\n\t#define darr_range(a, f, t) if (CONDITION) copy( (a) + (f), (a) + (t), ostream_iterator<int>(cerr, \" \") ); cerr << endl\n\t#define dvec(v) if (CONDITION) copy( ALL(v), ostream_iterator<int>(cerr, \" \") ); cerr << endl\n\t#define darr2(a, n, m) if (CONDITION) FOR(i, 0, (n)){ darr_range( (a)[i], 0, (m) ); }\n\t#define dvec2(v) if (CONDITION) FOR(i, 0, SZ(v)){ dvec( (v)[i] ); }\n\t#define WAIT() if (CONDITION) { string _wait_; cerr << \"(hit return to continue)\" << endl; getline(cin, _wait_); }\n\t#define dump(x) if (CONDITION) cerr << \" [L\" << __LINE__ << \"] \" << #x << \" = \" << (x) << endl;\n\t#define dumpf() if (CONDITION) cerr << __PRETTY_FUNCTION__ << endl;\n\t#define dumpv(x) if (CONDITION) cerr << \" [L:\" << __LINE__ << \"] \" << #x << \" = \"; REP(q, (x).size()) cerr << (x)[q] << \" \"; cerr << endl;\n\t#define where() if (CONDITION) cerr << __FILE__ << \": \" << __PRETTY_FUNCTION__ << \" [L: \" << __LINE__ << \"]\" << endl;\n\t#define show_bits(b, s) if(CONDITION) { REP(i, s) { cerr << BITOF(b, s-1-i); if(i%4 == 3) cerr << ' '; } cerr << endl; }\n#else\n\t#define cerr if(0) cerr\n\t#define dprt(fmt, ...)\n\t#define darr(a)\n\t#define darr_range(a, f, t)\n\t#define dvec(v)\n\t#define darr2(a, n, m)\n\t#define dvec2(v)\n\t#define WAIT()\n\t#define dump(x)\n\t#define dumpf()\n\t#define dumpv(x)\n\t#define where()\n\t#define show_bits(b, s)\n#endif\n\n/* Inline functions */\ninline int onbits_count(ULL b) { int c = 0; while(b != 0) { c += (b & 1); b >>= 1; } return c; }\ninline int bits_count(ULL b) { int c = 0; while(b != 0) { ++c; b >>= 1; } return c; }\ninline int toInt(string s) { int v; istringstream sin(s);sin>>v;return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout;sout<<x;return sout.str(); }\ninline double now(){ struct timeval tv; gettimeofday(&tv, NULL); return (static_cast<double>(tv.tv_sec) + static_cast<double>(tv.tv_usec) * 1e-6); }\ninline VS split(string s, char delimiter) { VS v; string t; REP(i, s.length()) { if(s[i] == delimiter) v.PB(t), t = \"\"; else t += s[i]; } v.PB(t); return v; }\n\n/* Tweaks */\ntemplate<typename T1, typename T2> ostream& operator<<(ostream& s, const pair<T1, T2>& d) {return s << \"(\" << d.first << \", \" << d.second << \")\";}\n\n/* Frequent stuffs */\n// int n_dir = 4;\n// int dx[] = {0, 1, 0, -1}, dy[] = {-1, 0, 1, 0}; [> CSS order <]\n// enum direction {\n\t// UP, RIGHT, DOWN, LEFT\n// };\n// int n_dir = 8;\n// int dx[] = {0, 1, 1, 1, 0, -1, -1, -1}, dy[] = {-1, -1, 0, 1, 1, 1, 0, -1};\n// enum direction {\n\t// UP, UPRIGHT, RIGHT, DOWNRIGHT, DOWN, DOWNLEFT, LEFT, UPLEFT\n// }\n#define FORDIR(d) REP (d, n_dir)\n\ntypedef complex<int> P;\n#define Y real()\n#define X imag()\n\n/*}}}*/\n\nstring s_greater(string s1, string s2)\n{\n\tif (s1.length() > s2.length()) {\n\t\treturn s1;\n\t} else if (s1.length() < s2.length()) {\n\t\treturn s2;\n\t} else {\n\t\treturn s1 > s2 ? s1 : s2;\n\t}\n}\n\nint main()\n{\n\tstd::ios_base::sync_with_stdio(false);\n\tint W, H;\n\twhile (cin >> W >> H, W | H) {\n\t\tVVC field(H, VC(W));\ntypedef vector<VS> VVS;\n\t\tVVS dp(H, VS(W));\n\t\tREP (i, H) {\n\t\t\tREP (j, W) {\n\t\t\t\tcin >> field[i][j];\n\t\t\t}\n\t\t}\n\n\t\tstring ans = \"\";\n\t\tREP (i, H) {\n\t\t\tREP (j, W) {\n\t\t\t\tdp[i][j] = field[i][j];\n\t\t\t\tIFC(!isdigit(field[i][j]));\n\t\t\t\tif (i > 0 && isdigit(field[i-1][j])) {\n\t\t\t\t\tdp[i][j] = s_greater(dp[i][j], dp[i-1][j] + field[i][j]);\n\t\t\t\t}\n\t\t\t\tif (j > 0 && isdigit(field[i][j-1])) {\n\t\t\t\t\tdp[i][j] = s_greater(dp[i][j], dp[i][j-1] + field[i][j]);\n\t\t\t\t}\n\t\t\t\tif (dp[i][j][0] == '0') {\n\t\t\t\t\tdp[i][j] = dp[i][j].substr(1);\n\t\t\t\t}\n\t\t\t\tans = s_greater(ans, dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n\n// vim: foldmethod=marker"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n\n#define MAX_ 72\n\nusing namespace std;\n\nint main(int argc, char const *argv[])\n{\n\tint h,w;\n\tstring f[MAX_][MAX_];\n\tstring mx;\n\n\twhile(1){\n\t\tcin>>w>>h;\n\t\tif(h+w==0) break;\n\n\t\tfor(int i1=0;i1<MAX_;i1++){\n\t\t\tfor(int i2=0;i2<MAX_;i2++){\n\t\t\t\tf[i1][i2]=\"@\";\n\t\t\t}\n\t\t}\n\n\t\tfor(int i1=1;i1<=h;i1++){\n\t\t\tstring temp;\n\t\t\tcin>>temp;\t\n\t\t\tfor(int i2=1;i2<=w;i2++){\n\t\t\t\tif(temp[i2-1]>='A' && temp[i2-1]<='Z') {}\n\t\t\t\telse f[i1][i2]=temp[i2-1];\n\t\t\t}\n\t\t}\n\n\t\tmx=\"\";\n\t\tfor(int i1=1;i1<=h;i1++){\n\t\t\tfor(int i2=1;i2<=w;i2++){\n\t\t\t\tif(f[i1][i2]!=\"@\"){\n\t\t\t\t\tstring su=\"\";\n\t\t\t\t\tstring sl=\"\";\n\t\t\t\t\tif(f[i1-1][i2]!=\"@\" && f[i1-1][i2]!=\"0\") su=f[i1-1][i2];\n\t\t\t\t\tif(f[i1][i2-1]!=\"@\" && f[i1][i2-1]!=\"0\") sl=f[i1][i2-1];\n\n\t\t\t\t\tif(su.size()>sl.size()) f[i1][i2]=su+f[i1][i2];\n\t\t\t\t\telse if(su.size()<sl.size()) f[i1][i2]=sl+f[i1][i2];\n\t\t\t\t\telse {\n\t\t\t\t\t\tif(su>sl) f[i1][i2]=su+f[i1][i2];\n\t\t\t\t\t\telse f[i1][i2]=sl+f[i1][i2];\n\t\t\t\t\t} \n\n\t\t\t\t\tif(mx.size()<f[i1][i2].size()) mx=f[i1][i2];\n\t\t\t\t\telse if(mx.size()==f[i1][i2].size()) mx=max(mx,f[i1][i2]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout<<mx<<endl;\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cctype>\nusing namespace std;\n\nstring max(string a,string b){\n\tint na=a.size(),nb=b.size();\n\tif(na>nb) return a;\n\tif(nb>na) return b;\n\tfor(int i=0;i<na;i++){\n\t\tif(a[i]>b[i])\n\t\t\treturn a;\n\t\tif(b[i]>a[i])\n\t\t\treturn b;\n\t}\n\treturn a;\n}\n\nint main(void){\n\tint H,W;\n\tstring  dp[70][70];\n\tchar table [70][70];\n\n\twhile(cin >> W >> H,W|H){\n\n\t\tfor(int i=0;i<H;i++)\n\t\t\tfor(int j=0;j<W;j++)\n\t\t\t\tcin >> table[i][j],dp[i][j]='0';\n\t\tfor(int i=0;i<H;i++){\n\t\t\tfor(int j=0;j<W;j++){\n\t\t\t\tstring cur;\n\t\t\t\tif(isdigit(table[i][j]))\n\t\t\t\t\tcur=table[i][j];\n\t\t\t\tif(cur !=\"0\")\n\t\t\t\t\tdp[i][j]=cur;\n\t\t\t\tif(i&&isdigit(table[i][j])&&dp[i-1][j]!=\"0\")\n\t\t\t\t\tdp[i][j]=max(dp[i][j],(dp[i-1][j]+cur));\n\t\t\t\tif(j&&isdigit(table[i][j])&&dp[i][j-1]!=\"0\")\n\t\t\t\t\tdp[i][j]=max(dp[i][j],(dp[i][j-1]+cur));\n\t\t\t}\n\t\t}\n\t\tstring ans=\"0\";\n\t\tfor(int i=0;i<H;i++)\n\t\t\tfor(int j=0;j<W;j++)\n\t\t\t\t\tans=max(ans,dp[i][j]);\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstdlib>\n#include <algorithm>\n\nusing namespace std;\n\nstring str[71][71];\n\nstring func(char a[71][71], bool vis[71][71], int w, int h, int p, int q)\n{\n  if(!vis[p][q]){\n    return str[p][q];\n  }\n  if(p == h-1 && q == w-1){\n    string w = \"\";\n    w += a[p][q];\n    return w;\n  }\n  vis[p][q] = false;\n\n  string s = \"\", t = \"\";\n  int u = p+1, v = q+1;\n  if(u < h && a[u][q] >= '0' && a[u][q] <= '9'){\n    s = func(a, vis, w, h, u, q);\n  }\n  if(v < w && a[p][v] >= '0' && a[p][v] <= '9'){\n    t = func(a, vis, w, h, p, v);\n  }\n\n  if(s.size() > t.size() || (t.size() == s.size() && t < s)){\n    str[p][q] = a[p][q] + s;\n  } else {\n    str[p][q] = a[p][q] + t;\n  }\n\n  return str[p][q];\n}\n\nint main()\n{\n  int w, h;\n  char a[71][71];\n  bool vis[71][71];\n\n  while(cin >> w >> h && (w+h)){\n    for(int i = 0; i < h; i++){\n      for(int j = 0; j < w; j++){\n\tcin >> a[i][j];\n      }\n    }\n    fill(&vis[0][0], &vis[70][70], true);\n    fill(&str[0][0], &str[70][70], \"\");\n    string s = \"\";\n\n    for(int i = 0; i < h; i++){\n      for(int j = 0; j < w; j++){\n\tif(a[i][j] >= '0' && a[i][j] <= '9' && vis[i][j]){\n\t  string t = func(a, vis, w, h, i, j);\n\t  if(s.size() < t.size() || (s.size() == t.size() && s < t)){\n\t    s = t;\n\t  }\t  \n\t}\n      }\n    }\n\n    int p=0;\n    while(s[p] == '0'){\n      p++;\n    }\n    cout << s.substr(p) << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<cstring>\n#include<queue>\n\nusing namespace std;\n\n#define INF 999999999\n#define REP(i,n) for(int i=0; i<(int)(n); i++)\n\nstruct nu{\n\tint x, y; string s;\n};\n\nvector<string> in(72);\nstring ans;\nqueue< nu > q;\n\nvoid search(nu v){\n\t//cout << v.x <<\"~\"<< v.y << \"~\" << v.s << endl;\n\tnu ins;\n\tint fla =0;\n\tif(in[v.x+1][v.y]-'0'>=0&&in[v.x+1][v.y]-'0'<=9){\n\t\tfla++;\n\t\tins.s = v.s + in[v.x+1][v.y];\n\t\tins.x = v.x+1;\n\t\tins.y = v.y;\n\t\tq.push(ins);\n\t}\n\tif(in[v.x][v.y+1]-'0'>=0&&in[v.x][v.y+1]-'0'<=9){\n\t\tfla ++;\n\t\tins.s = v.s + in[v.x][v.y +1];\n\t\tins.x = v.x;\n\t\tins.y = v.y+1;\n\t\tq.push(ins);\n\t}\n\tif(!fla){\n\t\tif(v.s.size() > ans.size()) ans = v.s;\n\t\telse if(v.s.size() == ans.size()){\n\t\t\tREP(a, v.s.size()){\n\t\t\t\tif(v.s[a] > ans[a]) ans = v.s;\n\t\t\t\telse if(v.s[a] < ans[a]) break;\n\t\t\t}\n\t\t}\n\t}\n\tq.pop();\n\tif(!q.empty()) search(q.front());\n}\n\nint main(){\n\tint i, j, w, h;\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(!w) break;\n\t\tREP(a,h){\n\t\t\tcin >> in[a+1];\n\t\t\tin[a+1] = \"A\" + in[a+1] +\"A\";\n\t\t}\n\t\tin[h+1] = \"\";\n\t\tin[0] = \"\";\n\t\tREP(a,w) in[h+1] += \"A\";\n\t\tREP(a,w) in[0] += \"A\";\n\t\tans = \"\";\n\t\tfor(i=1;i<=h;i++){\n\t\t\tfor(j=1;j<=w;j++){\n\t\t\t\tif((in[i-1][j]-'0'<1||in[i-1][j]-'0'>9)&&(in[i][j-1]-'0'<1||in[i][j-1]-'0'>9)&&(in[i][j]-'0'>=1&&in[i][j]-'0'<=9)){\n\t\t\t\t\tnu v;\n\t\t\t\t\tv.x = i;\n\t\t\t\t\tv.y = j;\n\t\t\t\t\tv.s = \"\";\n\t\t\t\t\tv.s += in[i][j];\n\t\t\t\t\tq.push(v);\n\t\t\t\t\tsearch(v);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cmath>\n#include <algorithm>\n#include <cstdlib>\n#include <ctime>\n#include <cstdio>\n#include <functional>\n#include <set>\n#include <sstream>\n#include <map>\n#include <queue>\n#include <stack>\n\nusing namespace std;\n\nbool ok(char c){\n\treturn '0'<=c && c<='9';\n}\n\nbool comp(string x, string y){\n\treturn x.size()>y.size() || (x.size()==y.size() && x>y);\n}\n\nstring max_str(string x, string y){\n\tif(comp(x,y)) return x;\n\telse return y;\n}\n\nint main()\n{\n\tint w,h;\n\twhile(cin>>w>>h , w||h){\n\t\t\n\t\tstring mat[100][100];\n\t\tstring dp[100][100];\n\t\tfor(int i=0;i<h;i++){\n\t\t\tstring s;\n\t\t\tcin>>s;\n\t\t\tfor(int j=0;j<s.size();j++) mat[i][j]=s[j];\n\t\t}\n\t\t\n\t\tstring ans;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tif(!ok(mat[i][j][0])) continue;\n\t\t\t\tif(dp[i][j]==\"\") dp[i][j]=mat[i][j];\n\t\t\t\t\n\t\t\t\tif(i!=0 && dp[i-1][j]!=\"0\"){\n\t\t\t\t\tdp[i][j]=max_str(dp[i][j],dp[i-1][j]+mat[i][j]);\n\t\t\t\t}\n\t\t\t\tif(j!=0 && dp[i][j-1]!=\"0\"){\n\t\t\t\t\tdp[i][j]=max_str(dp[i][j],dp[i][j-1]+mat[i][j]);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tans=max_str(ans,dp[i][j]);\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#include<cctype>\n#include<math.h>\n#include<string>\n#include<string.h>\n#include<stack>\n#include<queue>\n#include<vector>\n#include<utility>\n#include<set>\n#include<map>\n#include<stdlib.h>\n#include<iomanip>\n\nusing namespace std;\n\n#define ll long long\n#define ld long double\n#define EPS 0.0000000001\n#define INF 1e9\n#define MOD 1000000007\n#define rep(i,n) for(i=0;i<(n);i++)\n#define loop(i,a,n) for(i=a;i<(n);i++)\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\n\nstring large(string s, string t){\n    string ss = \"\", tt = \"\";\n    int i = 0;\n    while(i<s.size() && s[i]=='0')i++;\n    while(i<s.size()){\n        ss += s[i];\n        i++;\n    }\n    i = 0;\n    while(i<t.size() && t[i]=='0')i++;\n    while(i<t.size()){\n        tt += t[i];\n        i++;\n    }\n    if(ss.size() == tt.size()){\n        if(ss>tt) return ss;\n        else return tt;\n    }else if(ss.size() > tt.size()){\n        return ss;\n    }else{\n        return tt;\n    }\n}\n\nint main(void) {\n    int i,j;\n    int h, w;\n    while(cin >> w >> h, h+w){\n        vs s(h);\n        rep(i,h) cin >> s[i];\n        vector<vs> dp(h+1,vs(w+1));\n        rep(i,h)rep(j,w)if(s[i][j]>='0' && s[i][j]<='9'){\n            dp[i+1][j] = large(dp[i+1][j], dp[i][j]+s[i][j]);\n            dp[i][j+1] = large(dp[i][j+1], dp[i][j]+s[i][j]);\n        }\n        string ans=\"\";\n        rep(i,h+1)rep(j,w+1)ans = large(ans, dp[i][j]);\n        cout << ans << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cctype>\n#include <limits.h>\n#include <math.h>\n#include <complex>\n#include <bitset>\n#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <iomanip>\n#include <iostream>\n\n#define VARIABLE(x) cerr << #x << \"=\" << x << endl\n#define BINARY(x) static_cast<bitset<16> >(x);\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define REP(i,m,n) for (int i=m;i<(int)(n);i++)\n#define if_range(x, y, w, h) if (0<=(int)(x) && (int)(x)<(int)(w) && 0<=(int)(y) && (int)(y)<(int)(h))\n\nconst int INF = 1e9;\nconst double EPS = 1e-8;\nconst double PI = 3.14159;\nint dx[4]={0, 1, 0, -1}, dy[4]={-1, 0, 1, 0};\nusing namespace std;\ntypedef long long ll;\n//typedef pair<int, int> P;\nstruct P {\n\tint x, y, n;\n\tP(int n, int x, int y):n(n), x(x), y(y){}\n\tP(){}\n};\n\n/** Problem1126 : The Secret Number **/\nconst int MAX_W = 70;\nint W, H;\nchar field[MAX_W][MAX_W];\nstring dp[MAX_W][MAX_W];\n\nstring big(string s1, string s2) {\n\tif (s1.length() > s2.length()) {\n\t\treturn s1;\n\t} else if (s2.length() > s1.length()) {\n\t\treturn s2;\n\t} else {\n\t\treturn (s1>s2?s1:s2);\n\t}\n}\n\nstring big2(string s1, string s2) {\n\twhile (s1[0]=='0') s1.erase(s1.begin());\n\twhile (s2[0]=='0') s2.erase(s2.begin());\n\treturn big(s1, s2);\n}\n\nstring rec(int x, int y)\n{\n\tif (!('0' <= field[y][x] && field[y][x] <= '9'))\n\t\treturn dp[y][x] = \"\";\n\t\n\tstring s1 = dp[y][x+1];\n\tstring s2 = dp[y+1][x];\n\t\n\treturn dp[y][x] = field[y][x] + big(s1, s2);\n}\n\nint main()\n{\n\twhile (cin>>W>>H, W||H) {\n\t\tfill(dp[0], dp[0]+MAX_W*MAX_W, \"\");\n\t\t\n\t\trep(i, H) {\n\t\t\trep(j, W) {\n\t\t\t\tcin>>field[i][j];\n\t\t\t}\n\t\t}\n\t\t\n\t\tstring ans = \"\";\n\t\trep(y, H) {\n\t\t\trep(x, W) {\n\t\t\t\tans = big2(ans, rec(W-x-1, H-y-1));\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\tcout << (ans!=\"\"?ans:\"0\") << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<string>\nusing namespace std;\n\nchar map[80][80];\nint w,h;\nstring memo[80][80];\n\nbool isBig(string Boss,string target){\n\tif(Boss.size()<target.size()){\n\t\treturn true;\n\t}\n\telse if(Boss.size()==target.size()&&Boss<target){\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nstring MAX;\nvoid\nsearch(int y,int x,string str){\n//\tif(memo[y][x]!=\"\")cout<<\"    @second\"<<endl;\n//\tcout<<\"(\"<<x<<\",\"<<y<<\")\"<<map[y][x]<<endl;\n\tchar *p = map[y];\n\tstring tmp = string((char*)p);\n\tstr+=tmp[x];\n//\tcout<<str<<\" \"<<memo[y][x]<<endl;\n\tif(memo[y][x]!=\"\"&&!isBig(memo[y][x],str)){\n//\t\tcout<<\"return\"<<endl;\n\t\treturn ;\n\t}\n\tmemo[y][x]=str;\n\tif(isBig(MAX,str))MAX=str;\n\n\n\tstring str1=\"\",str2=\"\";\n\tif(map[y+1][x]>='0' && map[y+1][x]<='9')search(y+1,x,str);\n\tif(map[y][x+1]>='0' && map[y][x+1]<='9')search(y,x+1,str);\n\treturn ;\n}\n\nint\nmain(){\n\twhile(true){\n\t\tcin>>w>>h;\n\t\tMAX=\"\";\n\t\tif(w==0&&h==0)return 0;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tcin>>map[i][j];\n\t\t\t\t//cout<<map[i][j];\n\t\t\t}\n\t\t\t//\t\t\tcout<<endl;\n\t\t}\n\t\t//\tfor(int i=0;i<h;i++)cout<<map[i]<<endl;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++)memo[i][j]=\"\";\n\t\t}\n\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tstring str=\"\";\n\t\t\t\tif(map[i][j]>'0'&&map[i][j]<='9')search(i,j,\"\");\n\t\t\t}\n\t\t}\n\t\tcout<<MAX<<endl;\n\t}\n\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n//http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#include<iostream>\n#include<map>\n#include<vector>\n#include<algorithm>\n#include<cmath>\n#include<climits>\n#include<ctime>\n#include<cstring>\n#include<numeric>\n\n#define ALL(v) (v).begin(),(v).end()\n#define REP(i,p,n) for(int i=p;i<(int)(n);++i)\n#define rep(i,n) REP(i,0,n)\n#define dump(a) (cerr << #a << \"=\" << (a) << endl)\n#define DUMP(list) cout << \"{ \"; for(auto nth : list){ cout << nth << \" \"; } cout << \"}\" << endl;\n\nusing namespace std;\n\ntypedef unsigned long long ull;\n\nint W,H;\nchar matrix[70][70];\nint dw[2] = {0, 1};\nint dh[2] = {1, 0};\null ans;\n\nvoid dfs(int w, int h, vector<char> list)\n{\n\tif(w < 0 || w >= W || h < 0 || h >= H){ return; }\n\tif(!isdigit(matrix[h][w])){ return; }\n\n\tlist.push_back(matrix[h][w]);\n\tmatrix[h][w] = '#';\n\n\trep(i,2){\n\t\tdfs(w+dw[i], h+dh[i], list);\n\t}\n\n\n\tif(list.size() == 0){ return; }\n\tstring digit(ALL(list));\n\tull num = stoull(digit);\n\t\n\tans = max(ans, num);\n\n\treturn;\n}\n\nint main()\n{\n\twhile(cin >> W >> H && W)\n\t{\n\n\t\trep(h,H){\n\t\t\trep(w,W){\n\t\t\t\tcin >> matrix[h][w];\n\t\t\t}\n\t\t}\n\n\t\tans=0;\n\t\tvector<char> list;\n\t\trep(h,H){\n\t\t\trep(w,W){\n\t\t\t\tdfs(w,h,list);\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <cstring>\nusing namespace std;\n\n#define rep(i,n) for(int i=0; i<n; i++)\ntypedef long long ll;\n\nint w, h;\nchar f[71][71];\n\nbool isNumber(char c){ return ('0'<=c && c<='9'); }\n\nint comp(string lhs, string rhs) {\n\treverse(lhs.begin(), lhs.end());\n\treverse(rhs.begin(), rhs.end());\n\twhile(lhs.length() > rhs.length()) rhs += '0';\n\twhile(rhs.length() > lhs.length()) lhs += '0';\n\treverse(lhs.begin(), lhs.end());\n\treverse(rhs.begin(), rhs.end());\n\tif( lhs > rhs ) return 1;\n\tif( lhs < rhs ) return -1;\n\treturn 0;\n}\n\nvoid dfs( int x, int y, string& path ) {\n\tstring retPath = path;\n\tif( x+1 < w && isNumber(f[x+1][y]) ) {\n\t\tstring p = path + f[x+1][y];\n\t\tdfs( x+1, y, p );\n\t\tif( comp(p, retPath) > 0 ) {\n\t\t\tretPath = p;\n\t\t}\n\t}\n\tif( y+1 < h && isNumber(f[x][y+1]) ) {\n\t\tstring p = path + f[x][y+1];\n\t\tdfs( x, y+1, p );\n\t\tif( comp(p, retPath) > 0 ) {\n\t\t\tretPath = p;\n\t\t}\n\t}\n\tpath = retPath;\n}\n\nint main() {\n\twhile( cin >> w >> h, w||h ) {\n\t\tmemset( f, 0, sizeof(f) );\n\t\trep(y,h) {\n\t\t\trep(x,w) {\n\t\t\t\tcin >> f[x][y];\n\t\t\t}\n\t\t}\n\t\tstring mPath = \"\";\n\t\trep(y, h) {\n\t\t\trep(x, w) {\n\t\t\t\tif( isNumber(f[x][y]) ) {\n\t\t\t\t\tstring path = \"\";\n\t\t\t\t\tpath += f[x][y];\n\t\t\t\t\tdfs(x, y, path);\n\t\t\t\t\tif( comp(path, mPath) > 0 ) {\n\t\t\t\t\t\tmPath = path;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ind = 0;\n\t\twhile(mPath[ind]=='0') ind++;\n\t\tcout << mPath.substr(ind,mPath.length()-ind) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nusing ll = long long;\nusing Pi = pair<int, int>;\nusing Pl = pair<ll, ll>;\nusing vint = vector<int>;\nusing vvint = vector<vint>;\nusing vvvint = vector<vvint>;\nusing vdouble = vector<double>;\nusing vvdouble = vector<vdouble>;\nusing vvvdouble = vector<vvdouble>;\nusing vll = vector<ll>;\nusing vvll = vector<vll>;\nusing vvvll = vector<vvll>;\nusing uint = unsigned int;\nusing ull = unsigned long long;\n\ntemplate<typename T> using uset = unordered_set<T>;\ntemplate<typename T1, typename T2> using umap = unordered_map<T1, T2>;\n\nconstexpr int INF = (1 << 30) - 1;\nconstexpr ll LLINF = 1LL << 60;\nconstexpr int dy[] = {1, 0, -1, 0, 1, -1, -1, 1};\nconstexpr int dx[] = {0, 1, 0, -1, 1, 1, -1, -1};\nconstexpr char el = '\\n';\nconstexpr int mod = 1000000007;\n\ntemplate<typename T> T gcd(T a, T b) { return (b ? gcd(b, a % b) : a); }\ntemplate<typename T> T lcm(T a, T b) { return (a / gcd(a, b) * b); }\ntemplate<typename T1, typename T2>\ninline bool chmin(T1 &a, T2 b) { return (a > b && (a = b, true)); }\ntemplate<typename T1, typename T2>\ninline bool chmax(T1 &a, T2 b) { return (a < b && (a = b, true)); }\n\ntemplate<typename T>\nostream& operator <<(ostream &os, vector<T> &v) {\n\tos << v[0];\n\tfor (int i = 1; i < v.size(); i++) os << \" \" << v[i];\n\treturn (os);\n}\n\ntemplate<typename T>\nistream& operator >>(istream &is, vector<T> &v) {\n\tfor (auto &u : v) is >> u; return (is);\n}\n\ntemplate<typename T1, typename T2>\nistream& operator >>(istream &is, pair<T1, T2> &p) {\n\treturn (is >> p.first >> p.second);\n}\n\nbool solve() {\n\tint H, W; cin >> W >> H;\n\tif (H == 0 && W == 0) return (false);\n\tvector<string> S(H); cin >> S;\n\tvector<vector<string>> dp(H, vector<string>(W));\n\tint length = 0;\n\tstring maxv = \"\";\n\tfor (int i = 0; i < H; i++) {\n\t\tfor (int j = 0; j < W; j++) {\n\t\t\tif (isdigit(S[i][j])) {\n\t\t\t\tstring &t = dp[i][j];\n\t\t\t\tif (S[i][j] != '0') t += S[i][j];\n\t\t\t\tif (i > 0 && isdigit(S[i-1][j])) {\n\t\t\t\t\tstring s = dp[i-1][j] + S[i][j];\n\t\t\t\t\tif (s.size() != 1 || S[i][j] != '0') {\n\t\t\t\t\t\tif (s.size() > t.size()) t = s;\n\t\t\t\t\t\tif (s.size() == t.size()) chmax(t, s);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (j > 0 && isdigit(S[i][j-1])) {\n\t\t\t\t\tstring s = dp[i][j-1] + S[i][j];\n\t\t\t\t\tif (s.size() != 1 || S[i][j] != '0') {\n\t\t\t\t\t\tif (s.size() > t.size()) t = s;\n\t\t\t\t\t\tif (s.size() == t.size()) chmax(t, s);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\tif (chmax(length, (int)t.size())) {\n\t\t\t\t\tmaxv = t;\n\t\t\t\t} else if (length == (int)t.size()) chmax(maxv, t);\n\t\t\t}\n\t\t}\n\t}\n\tcout << maxv << el;\n\treturn (true);\n}\n\nvoid Main() {\n\twhile (solve());\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(0);\n\tcout << fixed << setprecision(20);\n\tMain();\n\treturn (0);\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<algorithm>\n#include<vector>\n#define F first\n#define S second\nusing namespace std;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() == 0 && b.size() == 0)\n    return true;\n  else if(a.size() == 0)\n    return true;\n  else if(b.size() == 0)\n    return false;\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] < b[i];\n  return false;\n}\n\nint main()\n{\n\n  int w,h;\n  while(cin >> w >> h,(w || h))\n    {\n      \n      char G[h][w];\n      string ans=\"0\";\n      string dp[h][w];\n\n      for(int i=0;i<h;i++)\n\t{\n\tfor(int j=0;j<w;j++)\n\t  {\n\t    cin >> G[i][j];\n\t    if('0' <= G[i][j] && G[i][j] <= '9')\n\t      {\n\t\tdp[i][j] = G[i][j];\n\t\tans = max(ans,dp[i][j],cmp);\n\t      }\n\t\n\t  }\n\n\t}\n     \n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\n\t      if(!('0' <= G[i][j] && G[i][j] <= '9'))\n\t\tcontinue;\n\t      \n\t      dp[i][j] = max(dp[i][j],max((i-1>=0 &&('0'<= G[i-1][j] && G[i-1][j] <= '9') ?dp[i-1][j]:\"\")+dp[i][j],\n\t\t\t\t\t  (j-1>=0 &&('0'<= G[i][j-1] && G[i][j-1] <= '9') ?dp[i][j-1]:\"\")+dp[i][j],cmp),cmp);\t      \n\t      //ans = max(ans,dp[i][j],cmp);\n\n\t    }\n\t}\n\n      ans = \"\";\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\t      if('0' <= G[i][j] && G[i][j] <= '9')\n\t\t{\n\t\t  string a;\n\t\t  if(dp[i][j] != \"0\" && dp[i][j][0] == '0')\n\t\t    {\n\n\t\t      for(int k=0;dp[i][j][k] == '0';k++)\n\t\t\tdp[i][j][k] = ' ';\t\t    \n\t\t      stringstream ss;\n\t\t      ss << dp[i][j];\n\t\t      a = ss.str();\n\t\t    }\n\t\t  else\n\t\t    a = dp[i][j];\n\t\t  ans = max(ans,a);\n\n\t\t}\n\t    }\n\t}\n\n\n      bool f = false;\n      int cnt = 0;\n      for(int i=0;i<ans.size();i++)      \n\tif(ans[i] == '0' && !f)\n\t  continue;\n\telse  \n\t  {\n\t    cnt++;\n\t    f = true;\n\t    cout << ans[i];\n\t  }\n      if(cnt == 0)\n\tcout << \"0\";\n\tcout << endl;\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \n//conversion\n//------------------------------------------\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\n \n//math\n//-------------------------------------------\ntemplate<class T> inline T sqr(T x) {return x*x;}\n \n//typedef\n//------------------------------------------\ntypedef pair<int, int> PII;\ntypedef pair<long, long> PLL;\ntypedef long long LL;\n//container util\n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define SORT(c) sort((c).begin(),(c).end())\n \n//repetition\n//------------------------------------------\n#define FOR(i,a,b) for(LL i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n \n//constant\n//--------------------------------------------\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\nconst int INF=INT_MAX;\n//clear memory\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\nint rd(int num){\n\treturn min(255,max(0,num));\n}\n\nbool ch(char c){\n\treturn (c>='0'&&c<='9');\n}\nint dp[20002][256];\nint main(){\n\tint W,H;\n\twhile(cin>>W>>H){\n\t\tif(W==0)return 0;\n\t\tchar C[75][75];\n\t\tREP(i,75)REP(j,75)C[i][j]='#';\n\t\tREP(i,H)REP(j,W)cin>>C[i+1][j+1];\n\t\tstring dp[75][75];\n\t\tREP(i,75)REP(j,75)dp[i][j]=\"\";\n\t\tstring res=\"\";\n\t\tFOR(h,1,H+1)FOR(w,1,W+1){\n\t\t\tstring tmp=\"\";\n\t\t\tif(!ch(C[h][w]))continue;\n\t\t\t\n\t\t\ttmp=dp[h-1][w-1];\n\t\t\tif(SZ(tmp)<SZ(dp[h][w-1])||(SZ(tmp)==SZ(dp[h][w-1])&&tmp<=dp[h][w-1])){\n\t\t\t\ttmp=dp[h][w-1];\n\t\t\t}\n\t\t\tif(SZ(tmp)<SZ(dp[h-1][w])||(SZ(tmp)==SZ(dp[h-1][w])&&tmp<=dp[h-1][w])){\n\t\t\t\ttmp=dp[h-1][w];\n\t\t\t}\n\t\t\tif(tmp!=\"0\")dp[h][w]=tmp+C[h][w];\n\t\t\telse dp[h][w]=C[h][w];\n\t\t\tif(SZ(res)<SZ(dp[h][w])||(SZ(res)==SZ(dp[h][w])&&res<=dp[h][w])){\n\t\t\t\tres=dp[h][w];\n\t\t\t}\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\treturn 0;\n}\n/*\n7 4\n0000AAA\nAAAA1AA\nAAAAA0A\nAAAAAA1\n*/"
  },
  {
    "language": "C++",
    "code": "#include <cctype>\n#include <cstdlib>\n#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\n\nbool large(const string& a, const string& b) {\n\tif(a.size() != b.size())\n\t\treturn a.size() > b.size();\n\n\tfor(int i = 0; i < (int)a.size(); ++i)\n\t\tif(a[i] != b[i])\n\t\t\treturn a[i] > b[i];\n\n\treturn false;\n}\n\ninline void chmax(string& a, const string& b) { if(large(b, a)) a = b; }\n\nint w, h;\nvector<string> mat;\nvector<vector<string> > memo;\n\ninline string dfs(int x, int y) {\n\tif(memo[y][x] != \"#\")\n\t\treturn memo[y][x];\n\n\tstring res;\n\tif(x < w - 1 && isdigit(mat[y][x + 1]))\n\t\tres = dfs(x + 1, y);\n\n\tif(y < h - 1 && isdigit(mat[y + 1][x]))\n\t\tchmax(res, dfs(x, y + 1));\n\n\treturn memo[y][x] = mat[y][x] + res;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\twhile(cin >> w >> h, w) {\n\t\tmat.clear();\n\t\tmat.resize(h);\n\t\tfor(int i = 0; i < h; ++i)\n\t\t\tcin >> mat[i];\n\n\t\tmemo.clear();\n\t\tmemo.resize(h, vector<string>(w, \"#\"));\n\t\tstring ans;\n\t\tfor(int i = 0; i < h; ++i)\n\t\t\tfor(int j = 0; j < w; ++j)\n\t\t\t\tif('1' <= mat[i][j] && mat[i][j] <= '9')\n\t\t\t\t   chmax(ans, dfs(j, i));\n\n\t\tcout << ans << endl;\n\t}\n\n\treturn EXIT_SUCCESS;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef unsigned long long ull;\n#define rep(i, n) REP(i, 0, n)\n#define REP(i, a, n) for(int i=(a); i<(n); i++)\n\nint w, h;\nchar c[70][70];\n#define is_ok(i, j) (0<=i && i<h && 0<=j && j<w && isdigit(c[i][j]))\n\nset<string> search(int i, int j) {\n    if(!is_ok(i, j)) return {};\n    set<string> ret = {};\n    for(auto s:search(i+1, j)) ret.insert(c[i][j] + s);\n    for(auto s:search(i, j+1)) ret.insert(c[i][j] + s);\n    if(ret.empty()) ret.insert(string(1, c[i][j]));\n    return ret;\n}\n\nstring clean(string s) {\n    int i; for(i=0; s[i]=='0'&&i<s.size(); i++);\n    return s.substr(i, s.size()-i);\n}\n\nint main() {\n    while(cin>>w>>h, w+h) {\n        rep(i, h) scanf(\"%s\", &c[i]);\n        set<string> codes = {};\n        rep(i, h) rep(j, w) if (!is_ok(i-1, j)&&!is_ok(i, j-1)&&is_ok(i, j)) for(auto s:search(i, j)) codes.insert(clean(s));\n        \n        size_t maxlen = 0;\n        for(auto s:codes) maxlen = max(maxlen, s.size());\n        for(auto it=codes.begin(); it!=codes.end();) if(it->size()!=maxlen) it=codes.erase(it); else it++;\n        cout << *codes.rbegin() << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#pragma GCC optimize(\"Ofast\")\n#include <bits/stdc++.h>\nusing namespace std;\n#define INF (1e9)\n#define rep(i, n) for(int i = 0; i < (int)(n); i++)\n#define all(x) x.begin(),x.end()\nconst long double PI = acos(-1.0L);\nconst long long MOD = 1000000007LL;\n// const long long MOD = 998244353LL;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<long long, long long> pll;\ntemplate<class T> inline bool chmax(T &a, T b) { if (a < b) { a = b; return true;} return false; }\ntemplate<class T> inline bool chmin(T &a, T b) { if (a > b) { a = b; return true;} return false; }\n//////////////////////////////////////////////////////////////////////////////////////////////////////////\n\nbool f(string S, string T) {\n    if (S.size() != T.size()) {\n        return S.size() < T.size();\n    }\n    int N = S.size();\n    rep(i,N) {\n        if (S[i] != T[i]) {\n            return S[i] - T[i] < 0;\n        }\n    }\n    return true;\n}\nint main() {\n    ios::sync_with_stdio(false); cin.tie(nullptr);\n    while (1) {\n        int W,H; cin >> W >> H;\n        if (W+H==0) break;\n        vector<string> S(H);\n        rep(i,H) cin >> S[i];\n\n        vector<vector<string>> dp(H+1, vector<string>(W+1,\"\"));\n        rep(i,H) {\n            rep(j,W) {\n                if (S[i][j] - '0' < 0 || 9 < S[i][j] - '0') continue;\n                if (dp[i+1][j] == \"\" && dp[i][j+1] == \"\" && S[i][j] == '0') continue;\n                if (f(dp[i+1][j],dp[i][j+1])) dp[i+1][j+1] = dp[i][j+1] + S[i][j];\n                else dp[i+1][j+1] = dp[i+1][j] + S[i][j];\n            }\n        }\n        string ans = \"\";\n        rep(i,H) {\n            rep(j,W) {\n                if (f(ans,dp[i+1][j+1])) ans = dp[i+1][j+1];\n            }\n        }\n\n        cout << ans << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n\nusing namespace std;\n\n#define MAX 72\n\nstring ans;\nchar b[MAX][MAX];\nint w,h;\nvector<vector<string> > m;\n\nstatic inline string maxstr(const string &a,const string &b){\n  if(a.length()!=b.length()){\n    if(a.length()>b.length()) return a;\n    else return b;\n  }else return max(a,b);\n}\n\nstring memo(int x,int y,int d){\n  if(x>=w||y>=h) return \"\";\n  if(!isdigit(b[y][x])) return \"\";\n  if(!m[y][x].empty()) return m[y][x];\n  if(b[y][x]!='0') d++;\n  m[y][x]=b[y][x]+maxstr(memo(x+1,y,d),memo(x,y+1,d));\n  if(d==1&&b[y][x]!='0') ans=maxstr(ans,m[y][x]);\n  return m[y][x];\n}\n\nint main(){\n  while(scanf(\"%d%d \",&w,&h),w+h){\n    m=vector<vector<string> >(h,vector<string>(w));\n    for(int i=0;i<h;i++)\n      cin>>b[i];\n    ans=\"\";\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n        if(!isdigit(b[i][j])||!m[i][j].empty()||(h-i+w-j)<ans.length())\n\t  continue;\n        memo(j,i,0);\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \n//conversion\n//------------------------------------------\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\n \n//math\n//-------------------------------------------\ntemplate<class T> inline T sqr(T x) {return x*x;}\n \n//typedef\n//------------------------------------------\ntypedef pair<int, int> PII;\ntypedef pair<long, long> PLL;\ntypedef long long LL;\n//container util\n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define SORT(c) sort((c).begin(),(c).end())\n \n//repetition\n//------------------------------------------\n#define FOR(i,a,b) for(LL i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n \n//constant\n//--------------------------------------------\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\nconst int INF=INT_MAX;\n//clear memory\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\nint rd(int num){\n\treturn min(255,max(0,num));\n}\n\nbool ch(char c){\n\treturn (c>='0'&&c<='9');\n}\nint dp[20002][256];\nint main(){\n\tint W,H;\n\twhile(cin>>W>>H){\n\t\tif(W==0)return 0;\n\t\tchar C[75][75];\n\t\tREP(i,75)REP(j,75)C[i][j]='#';\n\t\tREP(i,H)REP(j,W)cin>>C[i+1][j+1];\n\t\tstring dp[75][75];\n\t\tREP(i,75)REP(j,75)dp[i][j]=\"\";\n\t\tstring res=\"\";\n\t\tFOR(h,1,H+1)FOR(w,1,W+1){\n\t\t\tstring tmp=\"\";\n\t\t\tif(!ch(C[h][w]))continue;\n\t\t\t\n\t\t\tif(dp[h-1][w-1]!=\"0\")tmp=dp[h-1][w-1];\n\t\t\tif(SZ(tmp)<SZ(dp[h][w-1])||(SZ(tmp)==SZ(dp[h][w-1])&&tmp<dp[h][w-1])){\n\t\t\t\tif(dp[h][w-1]!=\"0\")tmp=dp[h][w-1];\n\t\t\t}\n\t\t\tif(SZ(tmp)<SZ(dp[h-1][w])||(SZ(tmp)==SZ(dp[h-1][w])&&tmp<dp[h-1][w])){\n\t\t\t\tif(dp[h-1][w]!=\"0\")tmp=dp[h-1][w];\n\t\t\t}\n\t\t\tdp[h][w]=tmp+C[h][w];\n\t\t\tif(SZ(res)<SZ(dp[h][w])||(SZ(res)==SZ(dp[h][w])&&res<dp[h][w])){\n\t\t\t\tres=dp[h][w];\n\t\t\t}\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\treturn 0;\n}\n/*\n1 -100 4\n-1,1,2\n*/"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cctype>\n#include <string>\n#include <algorithm>\n\nusing namespace std;\n\nstring myMax(string a, string b)\n{\n\tif (a.length() < b.length()) return b;\n\tif (a.length() > b.length()) return a;\n\n\tfor (int i = 0; i < a.length(); i++){\n\t\tif (a[i] < b[i]){\n\t\t\treturn b;\n\t\t}\n\t\tif (a[i] > b[i]){\n\t\t\treturn a;\n\t\t}\n\t}\n\treturn a;\n}\n\nint main(void)\n{\n\tint w, h;\n\twhile (cin >> w >> h, w && h){\n\t\tstring field[80];\n\t\tfor (int i = 0; i < h; i++){\n\t\t\tcin >> field[i];\n\t\t}\n\t\tstring dp[80][80] = {};\n\t\tstring ret;\n\t\t// 右下からやる\n\t\tfor (int i = h-1; 0 <= i; i--){\n\t\t\tfor (int j = w-1; 0 <= j; j--){\n\t\t\t\tif ('0' <= field[i][j] && field[i][j] <= '9'){\n\t\t\t\t\tdp[i][j] = myMax(field[i][j] + dp[i][j + 1], field[i][j] + dp[i + 1][j]);\n\t\t\t\t}\n\t\t\t\tret = myMax(dp[i][j], ret);\n\t\t\t}\n\t\t}\n\n\t\t/*\n\t\tfor (int i = 0; i < h; i++){\n\t\t\tfor (int j = 0; j < w; j++){\n\t\t\t\tif (dp[i][j] != \"\") cout << dp[i][j] << \" \";\n\t\t\t\telse cout << \"* \";\n\t\t\t}\n\t\t\tputs(\"\");\n\t\t}\n\t\t*/\n\n\t\tbool pf = false;\n\t\tfor (int i = 0; i < ret.length(); i++){\n\t\t\tif (pf || ret[i] != '0'){\n\t\t\t\tcout << ret[i];\n\t\t\t\tpf = true;\n\t\t\t}\n\t\t}\n\t\tputs(\"\");\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cctype>\n\nusing namespace std;\n\nstring max(string a, string b){\n    if(a.size()>b.size()) return a;\n    if(a.size()<b.size()) return b;\n    for(int i=0;i<a.size();i++){\n        if(a[i] > b[i]) return a;\n        if(a[i] < b[i]) return b;\n    }\n    return a;\n}\n\nint main(void){\n  int w,h;\n  string grid[71],dp[71][71];\n\n  while(cin >> w >> h,w|h){\n    for(int i=0;i<71;i++)\n      for(int j=0;j<71;j++)dp[i][j].clear();\n\n    for(int i=0;i<h;i++)cin >> grid[i];\n\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(!isupper(grid[i][j])){\n\t  dp[i][j]=grid[i][j];\n\t  string a=\"\",b=\"\";\n\t  if(i>0)a=dp[i-1][j]+grid[i][j];\n\t  if(j>0)b=dp[i][j-1]+grid[i][j];\n\t  \n\t  while(a[0]=='0')a.erase(a.begin());\n\t  while(b[0]=='0')b.erase(b.begin());\n\n\t  dp[i][j]=max(dp[i][j],max(a,b));\n\t}\n      }\n    }\n\n    string s=\"\";\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\ts=max(s,dp[i][j]);\n      }\n    }\n    cout << s << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\nusing namespace std;\ntypedef pair<string, pair<int, int> > P;\n\nint w, h;\nchar c[80][80];\n\nint dy[2] = {1, 0};\nint dx[2] = {0, 1};\nbool f[70][70];\n\nbool is_digit(char c){\n    return ('0' <= c && c <= '9');\n}\n\nbool contain(int y, int x){\n    return (0 <= y && y < h && 0 <= x && x < w);\n}\n\nvector<string> res;\n\nvoid dfs(int y, int x, string s){\n    // cout << y << \" \" << x << \" \" <<s << endl;\n    if(!contain(y, x) || !is_digit(c[y][x])){\n        res.push_back(s);\n        return;\n    }\n    f[y][x] = true;\n    rep(i, 0, 2){\n        int ny = y + dy[i];\n        int nx = x + dx[i];\n        dfs(ny, nx, s + c[y][x]);\n    }\n    return;\n}\n\nint main(){\n    while(1){\n        cin >> w >> h;\n        if(w + h == 0) break;\n        rep(i, 0, h){\n            rep(j, 0, w){\n                cin >> c[i][j];\n            }\n        }\n        res.clear();\n        rep(i, 0, h) rep(j, 0, w) f[i][j] = false;\n        rep(i, 0, h){\n            rep(j, 0, w){\n                if(f[i][j] == false && is_digit(c[i][j]) && c[i][j] != '0'){\n                    string tmp = \"\";\n                    dfs(i, j, tmp);\n                }\n            }\n        }\n        // rep(i, 0, res.size()){\n        //     cout << res[i] << endl;\n        // }     \n        int sz = 0;\n        rep(i, 0, res.size()){\n            sz = max(sz, (int)res[i].size());\n        }\n        string ans = \"\";\n        rep(i, 0, res.size()){\n            if(res[i].size() == sz && ans < res[i]) ans = res[i];\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define DIGIT(c) (c >= '0' && c <= '9')\n#define F first\n#define S second\n#define INF 1 << 30\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nint W, H;\nchar c[70][71];\n\nstring judge(string a, string b){\n  if(a[0] == '0') a.erase(a.begin());\n  if(b[0] == '0') b.erase(b.begin());\n  if(a.size() > b.size()) return a;\n  if(a.size() < b.size()) return b;\n  \n  rep(i, a.size()){\n    if(a[i] > b[i]) return a;\n    if(a[i] < b[i]) return b;\n  }\n  return a;\n}\n\nint main(){\n  while(scanf(\"%d%d\", &W, &H) && W+H){\n    rep(i, H) scanf(\"%s\", c[i]);\n\n    vector<vector<string> >dp(H, vector<string>(W, \"\"));\n    if(DIGIT(c[0][0])) dp[0][0] = c[0][0];\n    REP(i, 1, W) if(DIGIT(c[0][i])) dp[0][i] = dp[0][i-1] + c[0][i];\n    REP(i, 1, H) if(DIGIT(c[i][0])) dp[i][0] = dp[i-1][0] + c[i][0];\n\n    REP(i, 1, H){\n      REP(j, 1, W){\n\tif(!DIGIT(c[i][j])) continue;\n\tdp[i][j] = judge((dp[i-1][j]+c[i][j]), (dp[i][j-1]+c[i][j]));\n\t//\tcout << i << \" \" << j << \" \" << dp[i-1][j]+c[i][j] << \" \" << dp[i][j-1]+c[i][j] << endl;\n      }\n    }\n\n\n    /*    rep(i, H){\n      rep(j, W) cout << dp[i][j] << \" \";\n      puts(\"\");\n      }*/\n\n    string res = \"\";\n    rep(i, H) rep(j, W) res = judge(res, dp[i][j]);\n    //    if(res[0] == '0') res.erase(res.begin());\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <queue>\n#include <utility>\n#include <map>\n#include <string>\n#include <algorithm>\nusing namespace std;\n \nconst int WH = 4900;\n \nchar board[WH];\nstring dp[WH];\n \nbool comp(const string& a, const string& b){\n    if(!a.length() && !b.length()) return false;\n    if(a.length() == b.length()){\n        for(int i = 0;i < a.length();++i){\n            if(a[i] == b[i]) continue;\n            else return a[i] < b[i];\n        }\n    }\n    return a.length() < b.length();\n}\n \nint main(){\n    int w, h, m;\n    string r;\n    bool f;\n    while(cin >> w >> h, w){\n        f = false;\n        r = \"\";\n        fill(dp, dp + (w * h), \"\");\n        fill(board, board + (w * h), 0);\n        for(int i = 0;i < w * h;++i){\n            cin >> board[i];\n        }\n        for(int i = h - 1;0 <= i;--i){\n            for(int j = w - 1;0 <= j;--j){\n                string r = j + 1 < w ? dp[i * w + j + 1] : \"\";\n                string d = i + 1 < h ? dp[(i + 1) * w + j] : \"\";\n                if('0' <= board[i * w + j] && board[i * w + j] <= '9'){\n                    dp[i * w + j] = board[i * w + j];\n                    dp[i * w + j] = max(dp[i * w + j], max(board[i * w + j] + r, board[i * w + j] + d, comp), comp);\n                }\n                else dp[i * w + j] = \"0\";\n            }\n        }\n        for(int i = 0;i < w * h;++i){\n            r = max(r, dp[i], comp);\n        }\n        for(int i = 0;i < r.length();++i){\n            if(f || r[i] != '0'){\n                f = true;\n                cout << r[i];\n            }\n        }\n        cout << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\n#include<algorithm>\n#define F first\n#define S second\nusing namespace std;\ntypedef pair<int,int> P;\ntypedef vector<vector<char> > VVC;\nint dx[] = {0,1};\nint dy[] = {1,0};\nvector<string> message;\nint h,w;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() != b.size())\n    return a.size() > b.size();\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] > b[i];\n}\n\nvoid dfs(string secret,P p,VVC& G)\n{\n  bool update = false;\n  for(int i=0;i<2;i++)\n    {\n      int nx = p.F + dx[i];\n      int ny = p.S + dy[i];\n      if(!(0 <= nx && nx < w && 0 <= ny && ny < h) || !('0'<=G[ny][nx] && G[ny][nx]<='9' ))\n\tcontinue;\n      update = true;\n      dfs(secret+G[ny][nx],P(nx,ny),G);\n    }\n\n  if(!update)\n    message.push_back(secret);\n}\n\nint main()\n{\n\n  while(cin >> w >> h,(w|h))\n    {\n      message.clear();\n      VVC G;\n      G.resize(h);\n      for(int i=0;i<h;i++)\n\t{\n\t  G[i].resize(w);\n\t  for(int j=0;j<w;j++)\n\t    cin >> G[i][j];\n\t}\n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\t      if('0' <= G[i][j] && G[i][j] <= '9')\n\t\t{\n\t\t  string message;\n\t\t  message += G[i][j];\n\t\t  dfs(message,P(j,i),G);\n\t\t}\n\t    }\n\t}\n      sort(message.begin(),message.end(),cmp);\n      cout << message[0] << endl;\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <algorithm>\n#include <iomanip>\nusing namespace std;\n\nstring b[70];\nstring memo[70][70];\n\nbool comp(string s1, string s2) {\n\tif(s1.size() == s2.size()) return s1 < s2;\n\treturn s1.size() < s2.size();\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tint W, H;\n\twhile(cin >> W >> H, W | H) {\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tcin >> b[i];\n\t\t}\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tfor(int j = 0; j < W; j++) {\n\t\t\t\tmemo[i][j] = \"\";\n\t\t\t\tif('1' <= b[i][j] && b[i][j] <= '9') memo[i][j] += b[i][j];\n\t\t\t}\n\t\t}\n\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tfor(int j = 0; j < W; j++) {\n\t\t\t\tif('0' <= b[i][j] && b[i][j] <= '9') {\n\t\t\t\t\tif(i + 1 < H) {\n\t\t\t\t\t\tif('0' <= b[i + 1][j] && b[i + 1][j] <= '9') {\n\t\t\t\t\t\t\tif(comp(memo[i + 1][j], memo[i][j] + b[i + 1][j]))\n\t\t\t\t\t\t\t\tmemo[i + 1][j] = memo[i][j] + b[i + 1][j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(j + 1 < W) {\n\t\t\t\t\t\tif('0' <= b[i][j + 1] && b[i][j + 1] <= '9') {\n\t\t\t\t\t\t\tif(comp(memo[i][j + 1], memo[i][j] + b[i][j + 1]))\n\t\t\t\t\t\t\t\tmemo[i][j + 1] = memo[i][j] + b[i][j + 1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ans = \"0\";\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tfor(int j = 0; j < W; j++) {\n\t\t\t\tif(comp(ans, memo[i][j])) ans = memo[i][j];\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nstring dp[80][80];\nstring field[80];\nint n, m;\n\nbool isIn(int x, int y){\n    return 0 <= x && x < m && 0 <= y && y < n;\n}\n\nstring nmax(string a, string b){\n    if(a.size() != b.size()) return a.size() < b.size() ? b : a;\n    else return a < b ? b : a;\n}\n\nint main(){\n    while(cin >> n >> m, n+m){\n        for(int i=0; i < m; i++) cin >> field[i];\n        for(int i=0; i < 80; i++) for(int j=0; j < 80; j++) dp[i][j] = \"\";\n        string ret;\n\n        for(int i = m-1; 0 <= i; i--){\n            for(int j = n-1; 0 <= j; j--){\n                if('0' <= field[i][j] && field[i][j] <= '9'){\n                    string a, b;\n                    if(isIn(i+1, j)) a = dp[i+1][j];\n                    if(isIn(i, j+1)) b = dp[i][j+1];\n                    dp[i][j] = field[i][j] + nmax(a, b);\n                }\n            }\n        }\n        for(int i=0; i < m; i++){\n            for(int j=0; j < n; j++){\n                while(dp[i][j][0] == '0') dp[i][j] = dp[i][j].substr(1);\n                ret = nmax(ret, dp[i][j]);\n            }\n        }\n        cout << ret << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <cctype>\n#include <cstring>\n#include <vector>\n\nusing namespace std;\n\n#define loop(i,a,b) for(int i=(a);i<int(b);i++)\n#define rep(i,b) loop(i,0,b)\n\nbool comp(const string& s, const string& t){\n    if (s.size() != t.size()) return s.size() < t.size();\n    else return s[0] < t[0];\n}\n\nstring dp[100][100];\n\nint W, H;\nstring s[100];\n\nstring solve(int i, int j){\n    string & res = dp[i][j];\n    if (dp[i][j] != \"@\") return res;\n\n    if (!isdigit(s[i][j])) return \"\";\n    res = s[i][j];\n    vector<string> cand;\n    cand.push_back(string(1, s[i][j]));\n    if (i + 1 != H)cand.push_back(s[i][j] + solve(i + 1, j));\n    if (j + 1 != W)cand.push_back(s[i][j] + solve(i, j + 1));\n    return res = *max_element(cand.begin(), cand.end(), comp);\n}\n\nint main(){\n    while (cin >> W >> H && W|H){\n        rep(i, 100)rep(j, 100)dp[i][j] = \"@\";\n        rep(i, H)cin >> s[i];\n        string ans = \"\";\n        rep(i, H)rep(j, W)if (isdigit(s[i][j]) && s[i][j] != '0'){\n            ans = max(ans, solve(i, j), comp);\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\nint main(){\nvector<int> a(1000000000);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <algorithm>\n\n\nusing namespace std;\n\n\nstring max_strnum(string strnum_a, string strnum_b) {\n    if(strnum_a.length() > strnum_b.length()) {\n        return strnum_a;\n    } else if(strnum_a.length() < strnum_b.length()) {\n        return strnum_b;\n    }\n    for(int i = 0; i < strnum_a.length(); i++) {\n        if(strnum_a[i] > strnum_b[i]) {\n            return strnum_a;\n        } else if(strnum_a[i] < strnum_b[i]) {\n            return strnum_b;\n        }\n    }\n    return strnum_a;\n}\n\nvoid board_search(\n    int i, int j,\n    const vector<string>& board, vector<vector<int>> board_states,\n    string& ret, string& candidate\n) {\n    if(i >= board.size() || j >= board[0].size()\n    || board[i][j] > '9' || board[i][j] < '0'\n    ) {\n        ret = max_strnum(ret, candidate);\n        return;\n    }\n    board_states[i][j] = 1;\n    candidate.push_back(board[i][j]);\n    board_search(i+1, j, board, board_states, ret, candidate);\n    candidate.erase(candidate.end()-1);\n    candidate.push_back(board[i][j]);\n    board_search(i, j+1, board, board_states, ret, candidate);\n    candidate.erase(candidate.end()-1);\n}\n\nint main() {\n    while(true) {\n        int w, h; cin >> w >> h;\n        if(w == 0 && h == 0) return 0;\n        vector<string> board;\n        vector<vector<int>> board_states;\n        for(int i = 0; i < h; i++) {\n            string temp; cin >> temp;\n            board.push_back(temp);\n            board_states.emplace_back(w, 0);\n        }\n        string ret = \"\";\n        for(int i = 0; i < h; i++) {\n            for(int j = 0; j < w; j++) {\n                if(board_states[i][j] == 1) continue;\n                string candidate = \"\";\n                board_search(i, j, board, board_states, ret, candidate);\n            }\n        }\n        cout << ret << endl;\n    }\n}\n\n// [Problem] The Secret Number\n// http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nstring x[100][100];\nbool p[100][100];\nint h,w;\nchar T[11]=\"0123456789\";\nchar c;\nstring dp[100][100];\n\nbool isnum(string p){\n\tfor(int i=0;i<10;i++){\n\t\tif(T[i]==p[0]){\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nstring _max(string a,string b){\n\tif(a.size()<b.size()){return b;}\n\tif(a.size()>b.size()){return a;}\n\tif(a>b){return a;}\n\treturn b;\n}\n\nint main(){\n\twhile(true){\n\t\tfor(int i=0;i<100;i++){\n\t\t\tfor(int j=0;j<100;j++){\n\t\t\t\tdp[i][j]=\"\";\n\t\t\t\tx[i][j]=\"a\";\n\t\t\t}\n\t\t}\n\t\tcin>>w>>h;\n\t\tif(h==0 && w==0){break;}\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tcin>>c;\n\t\t\t\tstring G=\"\";\n\t\t\t\tG+=c;\n\t\t\t\tx[i][j]=G;\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tif(isnum(x[i][j])==true){\n\t\t\t\t\tdp[i][j]=\"\"+x[i][j];\n\t\t\t\t\tp[i][j]=true;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tp[i][j]=false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<70;i++){\n\t\t\tfor(int j=0;j<h;j++){\n\t\t\t\tfor(int k=0;k<w;k++){\n\t\t\t\t\tif(p[j+1][k]==true){\n\t\t\t\t\t\tdp[j+1][k]=_max(dp[j+1][k],dp[j][k]+x[j+1][k]);\n\t\t\t\t\t}\n\t\t\t\t\tif(p[j][k+1]==true){\n\t\t\t\t\t\tdp[j][k+1]=_max(dp[j][k+1],dp[j][k]+x[j][k+1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring maxn=\"\";\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tmaxn=max(maxn,dp[i][j]);\n\t\t\t\tcout<<dp[i][j]<<',';\n\t\t\t}\n\t\t\tcout<<endl;\n\t\t}\n\t\tcout<<maxn<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr, __VA_ARGS__)\n// #define LOG(...)\n#define FOR(i, a, b) for(int i = (int)(a); i < (int)(b); ++i)\n#define REP(i, n) for(int i = 0; i < (int)(n); ++i)\n#define RREP(i, n) for(int i = (int)(n - 1); i >= 0; --i)\n#define RFOR(i, a, b) for(int i = (int)(b - 1); i >= (int)(a); --i)\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EXIST(s, e) ((s).find(e) != (s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n#define SQ(n) (n) * (n)\n#define BIT(x, i) (((x) >> (i)) & 1)\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<char> vc;\ntypedef vector<pii> vpi;\ntypedef vector<pll> vpl;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vc> vvc;\ntypedef vector<vll> vvll;\n\nchar field[70][70];\nstring dp[70][70];\n\nstring strmax(string a, string b) {\n  if (a.length() > b.length()) return a;\n  if (a.length() < b.length()) return b;\n  return max(a, b);\n}\n\nint dx[] = {-1, 0};\nint dy[] = {0, -1};\n\nint main() {\n  int w, h;\n  while(cin >> w >> h, w) {\n    fill_n((char*)field, 70 * 70, ' ');\n    fill_n((string*)dp, 70 * 70, \"\");\n    REP(y, h) REP(x, w) {\n      cin >> field[y][x];\n      dp[y][x] = field[y][x];\n    }\n\n    string maxs = \"\";\n    RREP(y, h) RREP(x, w) {\n      REP(i, 2){\n        int sx = x + dx[i];\n        int sy = y + dy[i];\n        if (sx < 0 || sx >= w || sy < 0 || sy >= h) continue;\n        if (isdigit(field[y][x]) && isdigit(field[sy][sx])) {\n          dp[sy][sx] = strmax(dp[sy][sx], field[sy][sx] + dp[y][x]);\n          // maxs = strmax(maxs, dp[sy][sx]);\n        }\n      }\n    }\n\n    REP(y, h) REP(x, w) {\n      while(*dp[y][x].begin() == '0') dp[y][x].erase(dp[y][x].begin());\n      maxs = strmax(maxs, dp[y][x]);\n    }\n    cout << maxs << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<algorithm>\n#include<vector>\n#define F first\n#define S second\nusing namespace std;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() == 0 && b.size() == 0)\n    return true;\n  else if(a.size() == 0)\n    return true;\n  else if(b.size() == 0)\n    return false;\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] < b[i];\n  return false;\n}\n\nint main()\n{\n\n  int w,h;\n  while(cin >> w >> h,(w || h))\n    {\n      \n      char G[h][w];\n      string ans=\"0\";\n      string dp[h][w];\n\n      for(int i=0;i<h;i++)\n\t{\n\tfor(int j=0;j<w;j++)\n\t  {\n\t    cin >> G[i][j];\n\t    if('0' <= G[i][j] && G[i][j] <= '9')\n\t      {\n\t\tdp[i][j] = G[i][j];\n\t\tans = max(ans,dp[i][j],cmp);\n\t      }\n\t\n\t  }\n\n\t}\n     \n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\n\t      if(!('0' <= G[i][j] && G[i][j] <= '9'))\n\t\tcontinue;\n\t      \n\t      dp[i][j] = max(dp[i][j],max((i-1>=0 &&('0'<= G[i-1][j] && G[i-1][j] <= '9') ?dp[i-1][j]:\"\")+dp[i][j],\n\t\t\t\t\t  (j-1>=0 &&('0'<= G[i][j-1] && G[i][j-1] <= '9') ?dp[i][j-1]:\"\")+dp[i][j],cmp),cmp);\t      \n\t      //ans = max(ans,dp[i][j],cmp);\n\n\t    }\n\t}\n\n      ans = \"\";\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\t      if('0' <= G[i][j] && G[i][j] <= '9')\n\t\t{\n\t\t  string a;\n\t\t  if(dp[i][j] != \"0\" && dp[i][j][0] == '0')\n\t\t    {\n\n\t\t      for(int k=0;dp[i][j][k] == '0';k++)\n\t\t\tdp[i][j][k] = ' ';\t\t    \n\t\t      stringstream ss;\n\t\t      ss << dp[i][j];\n\t\t      a = ss.str();\n\t\t    }\n\t\t  else\n\t\t    a = dp[i][j];\n\t\t  ans = max(ans,a);\n\n\t\t}\n\t    }\n\t}\n\n      cout << ans << endl;\n      continue;\n\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nchar data[70];\nbool visited[70];\nint W, H;\nstring maxi;\n\nbool isNum(char c) {\n  return c >= '0' && c <= '9';\n}\n\nstring cat0(string s) {\n  while(s.length() > 1 && s[0] == '0') {\n    s = s.substr(1, s.length()-1);\n  }\n  return s;\n}\n\nvoid rec(int x, int y, string str) {\n  const int dx[2] = {1, 0};\n  const int dy[2] = {0, 1};\n  bool flag = false;\n  visited[y*W+x] = true;\n  str += data[y*W+x];\n  for(int i = 0; i < 2; i++) {\n    int nx = x + dx[i];\n    int ny = y + dy[i];\n    if(nx >= W || ny >= H) continue;\n    if(isNum(data[ny*W+nx])) {\n      flag = true;\n      rec(nx, ny, str);\n    }\n  }\n  if(!flag) {\n    str = cat0(str);\n    if(maxi.length() < str.length()) {\n      maxi = str;\n    } else if(maxi.length() == str.length()){\n      maxi = max(maxi, str);\n    }\n  }\n}\n\nmain() {\n  while(1) {\n    cin >> W >> H;\n    if(W == 0 && H == 0) break;\n    for(int i = 0; i < H; i++) {\n      for(int j = 0; j < W; j++) {\n\tcin >> data[i*W+j];\n      }\n    }\n    maxi = \"0\";\n    fill_n(visited, W*H, false);\n    for(int j = 0; j < W; j++) {\n      for(int i = 0; i < H; i++) {\n\tif(!visited[i*W+j] && isNum(data[i*W+j])) {\n\t  rec(j, i, \"\");\n\t}\n      }\n    }\n    \n    cout << maxi << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cctype>\n#include <string>\n#include <iostream>\n#include <cstdio>\n//#include <algorithm>\nusing namespace std;\ntypedef  long long  ll;\nstruct lls{\n  ll d[10];\n  int l;\n};\nvoid makells(lls &tmp){\n  for(int i=0;i<10;i++)\n    tmp.d[i]=0;\n  tmp.l=0;\n}\nlls maxs(lls a,lls b,char c){\n  lls tmp;\n  //iをゼロに宣言することを忘れて一体何時間をつかったんだろう。\n  //iを宣言だけして値をいれて置かないとダミーの値が変わる。\n  int i=0;\n  \n  if(a.l>b.l) tmp=a;\n  else if(a.l<b.l) tmp=b;\n  else for(i=0;i<10;i++){\n      if(a.d[i]-b.d[i]>0){\n\ttmp=a;\n\tbreak;\n      }\n      else if(a.d[i]-b.d[i]<0){\n\ttmp=b;\n\tbreak;\n      }\n    }\n  if(i==10) tmp=a;\n\n  if (c==-1){\n    //  if(a.d[0]==5) printf(\"%d %d %d %d\\n\",tmp.d[0],i,a.l,b.l);\n    return tmp;\n  }\n  if(tmp.l%10){\n    tmp.d[tmp.l/10]*=10;\n    tmp.d[tmp.l/10]+=(c-'0');\n    tmp.l++;\n }\n  else{\n    tmp.d[tmp.l/10]+=(c-'0');\n    tmp.l++;\n  } \n  return tmp;\n}\n\nint main(){\n\n  char whs[75][75];\n  lls answer[75][75];\n  int w,h;\n  lls maxint;\n  char tmp;\n  while(1){\n    cin>>w>>h;\n    if(w==0&&h==0)\n      return 0;\n    \n    makells(maxint);\n    for(int i=1;i<h+1;i++)\n      cin>>whs[i]+1;\n\n    for(int i=0;i<h+1;i++)\n      for(int j=0;j<w+1;j++){\n\tmakells(answer[i][j]);\n\t\n      }\n\n    for(int k=1;k<=w+h;k++){\n      int i=k;\n      int j=1;\n      for(;i>0;i--,j++)\n      {\n\t//cout <<flush;\n\tif(i>h||j>w){ continue;}\n\t//\tcout<<\"hehe \" <<i<<\" \"<<j<<endl;\n\tif(whs[i][j]>='0'&&whs[i][j]<='9'){\n\t  \n\t  answer[i][j]=\n\t    maxs(answer[i-1][j],answer[i][j-1],whs[i][j]);\n\t  // cout <<flush;\n\t  //\t  if(answer[i][j].d[0]==5){\n\t    //  cout<<'s';\n\t    // cerr<<answer[i][j].l<<\" bonus\"<<maxint.l<<endl;\n\t    // printf(\"%d hjehe %d \\n\",answer[i][j].l,maxint.l);\n\t    // printf(\"%d hjehe \\n\",answer[i],maxint.d[0]);\n\t    //   cerr<<endl<<answer[i][j].d[0]<<\" \"<<maxint.d[0]<<endl;\n\t  //  }\n  //\t  cout <<answer[i][j];\n\t   maxint=maxs(answer[i][j],maxint,-1);\n\n\t  //  for(int e=0;e<=(maxint.l-1)/10;e++)\n\t  //   cout<<maxint.d[e];\n\t  \n\t  // cout<<\"  \"<<i<<\" \"<<j<<'d'<<endl;\n\t}\n\telse answer[i][j].l=0;\n      }\n    }\n    for(int i=0;i<=(maxint.l-1)/10;i++)\n      cout<<maxint.d[i];\n      //printf(\"%d\",maxint.d[i]);\n    cout<<\"\"<<endl;\n  }\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <limits.h>\n#include <map>\n#include <math.h>\n#include <numeric>\n#include <set>\n#include <stack>\n#include <stdlib.h>\n#include <string>\n#include <vector>\n#define el endl\n#define fd fixed\n#define INF INT_MAX/2-1\n#define pb push_back\n#define mp make_pair\n#define sp fd << setprecision\nusing namespace std;\nint dx[] = {1, 0, -1, 0}, dy[] = {0, 1, 0, -1};\ntypedef vector<int> VI;\ntypedef vector<vector<int> > VVI;\ntypedef vector<string> VS;\n\nvector<string> ans;\n\nvoid search(VVI code, int i, int j, string tmp, int w, int h) {\n  if (code[i][j] < 0) return;\n  tmp += (char)(code[i][j]+48);\n  ans.pb(tmp);\n  if (i < h-1) search(code, i+1, j, tmp, w, h);\n  if (j < w-1) search(code, i, j+1, tmp, w, h);\n}\n\nint main() {\n  int w, h;\n  while (cin >> w >> h, w | h) {\n    VVI code;\n    string s;\n    ans.clear();\n    for (int i = 0; i < h; i++) {\n      VI tv;\n      cin >> s;\n      for (int j = 0; j < s.length(); j++) {\n        int tn = (int)(s[j]-'0');\n        if (0 <= tn && tn <= 9) {\n          tv.pb(tn);\n        } else {\n        tv.pb(-1);\n        }\n      }\n      code.pb(tv);\n    }\n    for (int i = 0; i < h; i++) {\n      for (int j = 0; j < w; j++) {\n        search(code, i, j, \"\", w, h);\n      }\n    }\n    int max_digit = 0;\n    string max_num = \"\";\n    for (int i = 0; i < ans.size(); i++) {\n      if (max_digit < ans[i].length()) max_num = ans[i], max_digit = ans[i].length();\n    }\n    if (max_num[0] == '0') max_num.erase(max_num.begin());\n    cout << max_num << el;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n\nusing namespace std;\n\nint w, h;\nvector<string> data;\n\nstring get_large(const string& a, const string& b){\n  if(a.size() != b.size())\n    return (a.size() > b.size()) ? a : b;\n  for(int i=0; i<a.size(); ++i){\n    if(a[i] != b[i]) return (a[i] > b[i]) ? a : b;\n  }\n  return a;\n}\n\nstring dfs(int i, int j){\n  if(!(i>=0 && i<h)) return string();\n  if(!(j>=0 && j<w)) return string();\n  if(!(data[i][j]>='0' && data[i][j]<='9')) return string();\n  return data[i][j] + get_large(dfs(i+1, j), dfs(i, j+1));\n}\n\nstring solve(){\n  string str(\"0\");\n  for(int i=0; i<h; ++i){\n    for(int j=0; j<w; ++j){\n      if(data[i][j]>='1' && data[i][j]<='9'){\n\tstr = get_large(str, dfs(i, j));\n      }\n    }\n  }\n  return str;\n}\n\nint main(){\n  while(1){\n    cin >> w >> h;\n    if(!w && !h) break;\n    data = vector<string>(h);\n    for(int i=0; i<h; ++i) cin >> data[i];\n    cout << solve() << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define each(itr,v) for(auto itr:v)\n#define pb(s) push_back(s)\n#define mp(a,b) make_pair(a,b)\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define maxch(x,y) x=max(x,y)\n#define minch(x,y) x=min(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt(x) bitset<32>(x).count()\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> P;\ntypedef pair<P, int> PPI;\ntypedef pair<ll, ll> PL;\ntypedef pair<P, ll> PPL;\n\n#define INF INT_MAX/3\n\n#define MAX_N 1000\n\nint w,h;\nstring s[77];\n\nint d[4]={0,1,0};\nbool vis[77][77];\n\nbool is_big(string s1,string s2){\n\tif(s1.length()==s2.length()){\n\t\tint i=0;\n\t\twhile(i<s1.length()&&s1[i]==s2[i])i++;\n\t\treturn i==s1.length()||s1[i]>=s2[i];\n\t}else return s1.length()>s2.length();\n}\n\nstring dfs(int i,int j){\n\tvis[i][j]=true;\n\tstring res=\"\";\n\trep(dd,2){\n\t\tint ni=i+d[dd],nj=j+d[dd+1];\n\t\tif(ni<0||ni>=h||nj<0||nj>=w||!isdigit(s[ni][nj])||vis[ni][nj])continue;\n\t\tstring a=dfs(ni,nj);\n\t\tif(is_big(a,res))res=a;\n\t}\n\tvis[i][j]=false;\n\treturn s[i][j]+res;\n}\n\nint main(){\n\tcin.sync_with_stdio(false);\n\twhile(1){\n\t\tcin>>w>>h;\n\t\tif(w==0)break;\n\t\trep(i,h)cin>>s[i];\n\t\tstring res=\"\";\n\t\tmemset(vis,0,sizeof(vis));\n\t\trep(i,h)rep(j,w){\n\t\t\tif(!isdigit(s[i][j]))continue;\n\t\t\tstring a=dfs(i,j);\n\t\t\tif(is_big(a,res))res=a;\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iostream>\n#include <list>\n#include <map>\n#include <memory>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\nusing namespace std;\n\n#define EPS 1e-10\n#define INF 1000000\n#define mp make_pair\n#define pb push_back\n\ntypedef vector<char> vc;\ntypedef vector<vc> vcc;\ntypedef pair<int,int> pii;\ntypedef long long ll;\n\nconst int dx[] = {1, 0},\n          dy[] = {0, 1};\n\nbool isNum(char c) {\n\tif (c < '0' || '9' < c) {\n\t\treturn false;\n\t}\n\treturn true;\n}\n\nstring suppressZeros(string s) {\n\twhile (s[0]) {\n\t\tif (s[0] != '0') {\n\t\t\tbreak;\n\t\t}\n\t\ts = s.substr(1);\n\t}\n\treturn s;\n}\n\nstring compareNum(string s1, string s2) {\n\ts1 = suppressZeros(s1);\n\ts2 = suppressZeros(s2);\n\n\tif (s1.size() > s2.size()) {\n\t\treturn s1;\n\t} else if (s1.size() < s2.size()) {\n\t\treturn s2;\n\t}\n\tfor (int i = 0 ; i < s1.size(); i++) {\n\t\tif (s1[i] > s2[i]) {\n\t\t\treturn s1;\n\t\t} else if (s1[i] < s2[i]) {\n\t\t\treturn s2;\n\t\t}\n\t}\n\treturn s1;\n}\n\nstring getBiggest(string ls, int x, int y, vcc matrix) {\n\tstring nls = ls + matrix[y][x],\n\t\t\t\t res = nls;\n\tfor (int d = 0; d < 2; d++) {\n\t\tint nx = x + dx[d],\n\t\t    ny = y + dy[d];\n\t\tif (ny >= matrix.size() || nx >= matrix[0].size()) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (isNum(matrix[ny][nx])) {\n\t\t\tres = compareNum(res, getBiggest(nls, nx, ny, matrix));\n\t\t}\n\t}\n\treturn res;\n}\n\nint main() {\n\tint W, H;\n\twhile (1) {\n\t\t// input\n\t\tcin >> W >> H;\n\t\tif (!W && !H) {\n\t\t\treturn 0;\n\t\t}\n\t\tvcc matrix(H, vc(W));\n\t\tfor (int y = 0; y < H; y++) {\n\t\t\tfor (int x = 0; x < W; x++) {\n\t\t\t\tcin >> matrix[y][x];\n\t\t\t}\n\t\t}\n\n\t\t// solve\n\t\tstring ans = \"\";\n\t\tfor (int y = 0; y < H; y++) {\n\t\t\tfor (int x = 0; x < W; x++) {\n\t\t\t\tcout << x << \", \" << y << endl;\n\t\t\t\tif (!isNum(matrix[y][x])) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif ((y - 1 >= 0 && isNum(matrix[y-1][x])) || ((x - 1) >= 0 && isNum(matrix[y][x-1]))) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tans = compareNum(ans, getBiggest(\"\", x, y, matrix));\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cctype>\nusing namespace std;\nint W,H;\nchar F[71][71] = {};\nstring dp[71][71] = {};\n\nstring dfs(int x,int y){\n    if(dp[x][y]!=\"-1\") return dp[x][y];\n    string res = \"\",s = \"\";\n    res += F[x][y];\n    if(x==H && y==W) return res;\n    if(x!=H && isdigit(F[x+1][y])){\n        string now = dfs(x+1,y);\n        if(s.size()<now.size()) s = now;\n        else if(s.size()==now.size() && s<now) s = now;\n    }\n    if(y!=W && isdigit(F[x][y+1])){\n        string now = dfs(x,y+1);\n        if(s.size()<now.size()) s = now;\n        else if(s.size()==now.size() && s<now) s = now;\n    }\n    return dp[x][y] = res+s;\n}\n\nint main(){\n    while(cin >> W >> H && W){\n        for(int i=1;i<=H;i++) for(int j=1;j<=W;j++){\n            cin >> F[i][j];\n            dp[i][j] = \"-1\";\n        }\n        string ans = \"\";\n        for(int i=1;i<=H;i++) for(int j=1;j<=W;j++){\n            if(isdigit(F[i][j]) && F[i][j]!='0'){\n                string now = dfs(i,j);\n                if(ans.size()<now.size()) ans = now;\n                else if(ans.size()==now.size() && ans<now) ans = now;\n            }\n        }\n        cout << ans << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <tuple>\n#include <queue>\n#include <set>\n#include <cstdio>\n#include <climits>\n#include <cmath>\n#include <array>\n#include <functional>\n#include <sstream>\n#include <list>\n#include <set>\nconst int MOD=1000000007;\nconst int INF=1000000000;\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\nconst double eps=1e-9;\nconst int inf=1e9;\ntypedef pair<int,int> P;\nstruct Point\n{\n  double x,y;\n  Point(){x=0;y=0;}\n  Point(double d_x,double d_y){x=d_x,y=d_y;}\n  double operator*(Point obj){return obj.x*x+obj.y*y;}\n  double operator%(Point obj){return obj.y*x-obj.x*y;}\n  Point operator*(double b){Point tmp;tmp.x=x*b;tmp.y=y*b;return tmp;}\n  Point operator/(double b){Point tmp;tmp.x=x/b;tmp.y=y/b;return tmp;}\n  Point operator+(Point obj){Point tmp;tmp.x=x+obj.x;tmp.y=y+obj.y;return tmp;}\n  Point operator-(){Point tmp;tmp.x=-x;tmp.y=-y;return tmp;}\n  Point operator-(Point obj){Point tmp;tmp.x=x-obj.x;tmp.y=y-obj.y;return tmp;}\n  Point operator-=(Point obj){x-=obj.x;y-=obj.y;return *this;}\n  Point operator+=(Point obj){x+=obj.x;y+=obj.y;return *this;}\n  Point operator/=(double b){x=x/b;y=y/b;return *this;}\n  Point operator*=(double b){x=x*b;y=y*b;return *this;}\n  double size(){return hypot(x,y);}\n  Point unit(){return Point(x/size(),y/size());}\n  Point normal(){return Point(y,-x);}\n  double atan(){return atan2(y,x);}\n};\n\nbool operator<(Point a,Point b){return a.x!=b.x?a.x<b.x:a.y<b.y;}\nbool operator>(Point a,Point b){return b<a;}\nbool operator<=(Point a,Point b){return !(b<a);}\nbool operator>=(Point a,Point b){return !(a<b);}\nbool operator==(Point a,Point b){return (a-b).size()<eps;}\nbool operator!=(Point a,Point b){return !(a==b);}\n\nbool equal(double a,double b){return abs(a-b)<eps;}\ndouble cross(Point a,Point b){return a%b;}\ndouble dot(Point a,Point b){return a*b;}\n\nint ccw(Point a,Point b,Point c)\n{\n  b=b-a;\n  c=c-a;\n  if(b%c>0) return +1;\n  else if(b%c<0)return -1;\n  else if(b*c<0) return +2;\n  else if(b.size()<c.size()) return -2;\n  else return 0;\n}\n\nint w,h;\nvector<string> board;\nvector<vector<string> > memo;\nint dx[]={1,0};\nint dy[]={0,1};\n\ninline bool outrange(int x,int y)\n{\n  return (x<0 || x>=w || y<0 || y>=h);\n}\n\nstring cmp(string a,string b)\n{\n  if(a.size()>b.size()) return a;\n  if(b.size()>a.size()) return b;\n  return max(a,b);\n}\n\nstring dfs(int x,int y)\n{\n  if(outrange(x,y)) return \"\";\n  if(!isdigit(board[y][x])) return \"\";\n  if(memo[y][x]!=\"\") return memo[y][x];\n  \n  string res=\"\";\n  for(int d=0;d<2;d++)\n    {\n      res=cmp(res,board[y][x]+dfs(x+dx[d],y+dy[d]));\n    }\n  memo[y][x]=res;\n  return res;\n}\n\nint main(int argc,char const* argv[])\n{\n  while(1)\n    {\n      cin >> w >> h;\n      if(!w) break;\n      board=vector<string>(h,\"\");\n      memo.assign(h,vector<string>(w,\"\"));\n      for(int i=0;i<h;i++)\n\t{\n\t  cin >> board[i];\n\t}\n      string ans=\"\";\n      for(int y=0;y<h;y++)\n\t{\n\t  for(int x=0;x<w;x++)\n\t    {\n\t      if(board[y][x]=='0' || !isdigit(board[y][x])) continue;\n\t      ans=cmp(ans,dfs(x,y));\n\t    }\n\t}\n      cout << ans << endl;\n    }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nconst int dx[] = {1, 0};\nconst int dy[] = {0, 1};\n\nvector<string> board(70);\nstring memo[70][70];\nint W, H;\n\ninline bool isDigit(int x, int y)\n{\n    if ('0' <= board[y][x] && board[y][x] <= '9')\n        return true;\n    else\n        return false;\n}\n\nstring Rec(int x, int y)\n{\n    if (memo[y][x].size() != 0)\n        return memo[y][x];\n\n    string s, tmp;\n    for (int d = 0; d < 2; ++d) {\n        int nx = x + dx[d];\n        int ny = y + dy[d];\n\n        if (nx < 0 || nx >= W || ny < 0 || ny >= H || !isDigit(nx, ny))\n            continue;\n\n        tmp = Rec(nx, ny);\n        if (tmp.size() > s.size() || (tmp.size() == s.size() && tmp > s))\n            s = tmp;\n    }\n\n    return memo[y][x] = board[y][x] + s;\n}\n\nint main()\n{\n    while (cin >> W >> H, W || H) {\n        // Input\n        for (int i = 0; i < H; ++i) {\n            cin >> board[i];\n            for (int j = 0; j < W; ++j)\n                memo[i][j] = \"\";\n        }\n\n        // Solve\n        string tmp, ans;\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                if (isDigit(j, i) && memo[i][j].size() == 0 && board[i][j] != '0') {\n                    tmp = Rec(j, i);\n\n                    if (tmp.size() > ans.size() || (tmp.size() == ans.size() && tmp > ans))\n                        ans = tmp;\n                }\n\n        // Output\n        cout << ans << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\nint w, h;\nstring s[51], dp[51][51];\nbool is_num(char c){return '0'<=c && c<= '9';}\n\nstring str_max(const string& s1, const string& s2) {\n  if (s1.size() == s2.size()) {\n    return (s1 > s2) ? s1 : s2 ;\n  }\n  return (s1.size() > s2.size())? s1 : s2 ;\n}\n\nstring dfs(int i, int j) {\n  string res = \"\";\n  \n  // l¶áÈ¢ê\n  if (!is_num(s[i][j])) return res;\n  // DP\n  if (dp[i][j] != \"\") return dp[i][j];\n  \n  if (i+1 >= h && j+1 >= w) {\n    // EÉàºÉàißÈ¢\n    res += s[i][j];\n  } else if (i+1 >= h) {\n    // EÉ¾¯ißé\n    res += s[i][j] + dfs(i, j+1);\n  } else if (j+1 >= w) {\n    // ºÉ¾¯ißé\n    res += s[i][j] + dfs(i+1, j);\n  } else {\n    // Ç¿çÉàißé\n    res = s[i][j] + str_max(dfs(i, j+1), dfs(i+1, j));\n  }\n  // ªÉ0ªÂ¢Ä¢éêÍæé\n  if (i == 0 && j == 0) {\n    if (res[0] == '0') res.erase(0, 1);\n  } else if (i == 0) {\n    if (!is_num(s[i][j-1]) && res[0] == '0') res.erase(0, 1);\n  } else if (j == 0) {\n    if (!is_num(s[i-1][j]) && res[0] == '0') res.erase(0, 1);\n  } else{\n    if (!is_num(s[i-1][j]) && !is_num(s[i][j-1])) res.erase(0, 1);\n  }\n  \n  return dp[i][j] = res;\n}\n\nvoid solve() {\n  for(int i=0;i<h;i++) cin>>s[i];\n  // init\n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  dp[i][j] = \"\";\n  \n  // search\n  string largest = \"\";\n  \n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  if (dp[i][j] == \"\")\n  largest = str_max(dfs(i, j), largest);\n  /*\n  for(int i=0;i<h;i++) {\n    for(int j=0;j<w;j++) cout<<\"[\"<<dp[i][j]<<\"]\";\n    cout<<endl;\n  }*/\n  \n  cout<<largest<<endl;\n}\n\nint main (int argc, char const* argv[]) {\n  while (cin>>w>>h, w||h) {\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<ctime>\n#include<cctype>\n#include<climits>\n#include<iostream>\n#include<iomanip>\n#include<string>\n#include<vector>\n#include<map>\n#include<list>\n#include<queue>\n#include<deque>\n#include<algorithm>\n#include<numeric>\n#include<utility>\n#include<complex>\n#include<memory>\n#include<functional>\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<ll> VL;\ntypedef vector<VL> VVL;\ntypedef pair<int, int> PII;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define MP make_pair\n#define PB push_back\n#define MOD 1000000007\n#define INF (1LL<<30)\n#define LLINF (1LL<<60)\n#define PI 3.14159265359\n#define EPS 1e-12\n//#define int ll\n\nstring s[100], dp[100][100];\nsigned main(void)\n{\n\twhile(true) {\n\t\tint w, h;\n\t\tcin >> w >> h;\n\t\tif(!w && !h) break;\n\t\tREP(i, h) cin >> s[i];\n\n\t\tREP(i, h) REP(j, w) {\n\t\t\tif(i == 0 && j == 0) {\n\t\t\t\tif('1' <= s[i][j] && s[i][j] <= '9') dp[i][j] = s[i][j];\n\t\t\t\telse dp[i][j] = \"0\";\n\t\t\t} else if(i == 0) {\n\t\t\t\tif('0' <= s[i][j] && s[i][j] <= '9') {\n\t\t\t\t\tdp[i][j] = dp[i][j-1] + s[i][j];\n\t\t\t\t} else {\n\t\t\t\t\tdp[i][j] = \"0\";\n\t\t\t\t}\n\t\t\t} else if(j == 0) {\n\t\t\t\tif('0' <= s[i][j] && s[i][j] <= '9') {\n\t\t\t\t\tdp[i][j] = dp[i-1][j] + s[i][j];\n\t\t\t\t} else {\n\t\t\t\t\tdp[i][j] = \"0\";\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif('0' <= s[i][j] && s[i][j] <= '9') {\n\t\t\t\t\tbool flag = false;\n\t\t\t\t\tif(dp[i-1][j].size() > dp[i][j-1].size()) flag = true;\n\t\t\t\t\tif(dp[i-1][j].size() == dp[i][j-1].size()) {\n\t\t\t\t\t\tREP(k, dp[i-1][j].size()) {\n\t\t\t\t\t\t\tif(dp[i-1][j][k] > dp[i][j-1][k]) {flag = true; break;}\n\t\t\t\t\t\t\telse if(dp[i-1][j][k] < dp[i][j-1][k]) {flag = false; break;}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(flag) {\n\t\t\t\t\t\tdp[i][j] = dp[i-1][j] + s[i][j];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i][j] = dp[i][j-1] + s[i][j];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tdp[i][j] = \"0\";\n\t\t\t\t}\n\t\t\t}\n\t\t\t//dp[i][j]???leading-zero????¶????\n\t\t\tint idx = 0;\n\t\t\tREP(k, dp[i][j].size()) {\n\t\t\t\tif(dp[i][j][k] != '0') {idx = k; break;}\n\t\t\t}\n\t\t\tstring tmp = \"\";\n\t\t\tFOR(k, idx, dp[i][j].size()) {\n\t\t\t\ttmp += dp[i][j][k];\n\t\t\t}\n\t\t\tdp[i][j] = tmp;\n\t\t}\n\t\t//cout << \"b\" << endl;\n\t\tstring ret = \"0\";\n\t\tREP(i, h) REP(j, w) {\n\t\t\tbool flag = false;\n\t\t\tif(dp[i][j].size() > ret.size()) flag = true;\n\t\t\tif(dp[i][j].size() == ret.size()) {\n\t\t\t\tREP(k, dp[i][j].size()) {\n\t\t\t\t\tif(dp[i][j][k] > ret[k]) {flag = true; break;}\n\t\t\t\t\telse if(dp[i][j][k] < ret[k]) {flag = false; break;}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(flag) ret = dp[i][j];\n\t\t}\n\t\tcout << ret << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <deque>\n#include <list>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <utility>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <complex>\n#include <cmath>\n#include <limits>\n#include <cfloat>\n#include <climits>\n#include <ctime>\n#include <cassert>\nusing namespace std;\n\n#define rep(i,a,n) for(int (i)=(a); (i)<(n); (i)++)\n#define repq(i,a,n) for(int (i)=(a); (i)<=(n); (i)++)\n#define repr(i,a,n) for(int (i)=(a); (i)>=(n); (i)--)\n#define all(v) begin(v), end(v)\n#define pb(a) push_back(a)\n#define fr first\n#define sc second\n#define INF 2000000000\n#define int long long int\n\n#define X real()\n#define Y imag()\n#define EPS (1e-10)\n#define EQ(a,b) (abs((a) - (b)) < EPS)\n#define EQV(a,b) ( EQ((a).X, (b).X) && EQ((a).Y, (b).Y) )\n#define LE(n, m) ((n) < (m) + EPS)\n#define LEQ(n, m) ((n) <= (m) + EPS)\n#define GE(n, m) ((n) + EPS > (m))\n#define GEQ(n, m) ((n) + EPS >= (m))\n\ntypedef vector<int> VI;\ntypedef vector<VI> MAT;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\ntypedef complex<double> P;\ntypedef pair<P, P> L;\ntypedef pair<P, double> C;\n\nint dx[]={1, 0};\nint dy[]={0, 1};\nint const MOD = 1000000007;\nll mod_pow(ll x, ll n) {return (!n)?1:(mod_pow((x*x)%MOD,n/2)*((n&1)?x:1))%MOD;}\nint madd(int a, int b) {return (a + b) % MOD;}\nint msub(int a, int b) {return (a - b + MOD) % MOD;}\nint mmul(int a, int b) {return (a * b) % MOD;}\nint minv(int a) {return mod_pow(a, MOD-2);}\nint mdiv(int a, int b) {return mmul(a, minv(b));}\n\nnamespace std {\n    bool operator<(const P& a, const P& b) {\n        return a.X != b.X ? a.X < b.X : a.Y < b.Y;\n    }\n}\n\nint w, h;\nchar board[110][110];\nstring ans;\n\nvoid dfs(int x, int y, string cur, vector< vector<bool> > used) {\n    bool ok = false;\n    // printf(\"x = %lld, y = %lld\\n\", x, y);\n    rep(i,0,2) {\n        int nx = x + dx[i], ny = y + dy[i];\n        if(nx < 0 || nx >= h || ny < 0 || ny >= w) continue;\n        if('A' <= board[nx][ny] && board[nx][ny] <= 'Z') continue;\n        if(used[nx][ny]) continue;\n        used[nx][ny] = true;\n        string temp = cur + board[nx][ny];\n        ok = true;\n        dfs(nx, ny, temp, used);\n    }\n    if(!ok) {\n        if(ans.length() < cur.length()) ans = cur;\n        else if(ans.length() == cur.length()) {\n            if(ans < cur) ans = cur;\n        }\n    }\n}\n\nsigned main() {\n    while(cin >> w >> h, w||h) {\n        rep(i,0,h) rep(j,0,w) cin >> board[i][j];\n        ans = \"\";\n        rep(i,0,h) rep(j,0,w) {\n            vector< vector<bool> > a(h, vector<bool>(w, false));\n            dfs(i, j, \"\", a);\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef pair<int,int> P;\n\nint main ()\n{\n    int n, m;\n    while (cin >> m >> n, n || m) {\n        vector<vector<char> > v (n, vector<char>(m, '#'));\n        for (int i = 0; i < n; i++) {\n            for (int j = 0; j < m; j++) {\n                char str;\n                cin >> str;\n                if ('0' <= str && str <= '9') {\n                    v[i][j] = str;\n                }\n            }\n        }\n\n        vector<vector<string> > dp(n, vector<string>(m, \"\"));\n\n        string res = \"\";\n\n        for (int i = 0; i < m; i++) {\n            if (v[0][i] != '#') {\n                if (v[0][i] == '0') {\n                    if (i > 0 && dp[0][i-1].size() > 0) {\n                        dp[0][i] = dp[0][i-1] + v[0][i];\n                    }\n                } else {\n                    if (i > 0) {\n                        dp[0][i] = dp[0][i-1] + v[0][i];\n                    } else {\n                        dp[0][i] = v[0][i];\n                    }\n                }\n            }\n            if (res.size() == dp[0][i].size()) {\n                res = max(res, dp[0][i]);\n            } else {\n                res = res.size() > dp[0][i].size() ? res : dp[0][i];\n            }\n        }\n\n        for (int i = 1; i < n; i++) {\n            if (v[i][0] != '#') {\n                if (v[i][0] == '0') {\n                    if (dp[i-1][0].size() > 0) dp[i][0] = dp[i-1][0] + v[i][0];\n                } else {\n                    dp[i][0] = dp[i-1][0] + v[i][0];\n                }\n            }\n            if (res.size() == dp[0][i].size()) {\n                res = max(res, dp[0][i]);\n            } else {\n                res = res.size() > dp[0][i].size() ? res : dp[0][i];\n            }\n        }\n\n        for (int i = 1; i < n; i++) {\n            for (int j = 1; j < m; j++) {\n                if (v[i][j] != '#') {\n                    string s1;\n                    if (dp[i-1][j].size() > 0 || v[i][j] != '0') s1 = dp[i-1][j] + v[i][j];\n                    string s2;\n                    if (dp[i][j-1].size() > 0 || v[i][j] != '0') s2 = dp[i][j-1] + v[i][j];\n\n                    if (s1.size() == s2.size()) {\n                        dp[i][j] = max(s1, s2);\n                    } else {\n                        dp[i][j] = s1.size() > s2.size() ? s1 : s2;\n                    }\n                    if (res.size() == dp[i][j].size()) {\n                        res = max(res, dp[i][j]);\n                    } else {\n                        res = res.size() > dp[i][j].size() ? res : dp[i][j];\n                    }\n                }\n            }\n        }\n\n        cout << res << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstring mymax(string a, string b){\n    vector<pair<int, string> > ans;\n    int t = 0;\n    while(t<a.size() && a[t]=='0') t++;\n    a = a.substr(t);\n    t = 0;\n    while(t<b.size() && b[t]=='0') t++;\n    b = b.substr(t);\n    if(a==\"\")a=\"0\";\n    if(b==\"\")b=\"0\";\n    ans.emplace_back(a.size(), a);\n    ans.emplace_back(b.size(), b);\n    sort(ans.rbegin(), ans.rend());\n    return ans[0].second;\n}\n\nint main(){\n    int w, h;\n    while(cin >> w >> h, w+h){\n        vector<vector<int> > c(h+2, vector<int>(w+2, -1));\n        for(int i = 1; i <= h; ++i){\n            if(i==0||i==h+1)continue;\n            for(int j = 1; j <= w; ++j){\n                char tmp;\n                cin >> tmp;\n                if(0 <= tmp - '0' && tmp - '0' <= 9){\n                    c[i][j] = tmp - '0';\n                }\n            }\n        }\n        vector<vector <string>> dp(h+2, vector<string>(w+2, \"\"));\n        for(int i = 1; i <= h; ++i){\n            for(int j = 1; j <= w; ++j){\n                if(c[i][j] == -1) continue;\n                // if(c[i][j] == 0){\n                //     if(dp[i-1][j] != \"\")\n                //         dp[i][j] = mymax(dp[i-1][j], dp[i][j]);\n                //     if(dp[i][j-1] != \"\")\n                //         dp[i][j] = mymax(dp[i][j-1], dp[i][j]);\n                //     if(dp[i][j] != \"\")\n                //         dp[i][j] += (char)(c[i][j] + '0');\n                //     continue;\n                // }\n                dp[i][j] = mymax(dp[i-1][j], dp[i][j-1]) + (char)(c[i][j] + '0');\n            }\n        }\n\n        string ans = \"\";\n        for(int i = 1; i <= h; ++i){\n            for(int j = 1; j <= w; ++j){\n                ans = mymax(ans, dp[i][j]);\n            }\n        }\n        cout << ans << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stdio.h>\n#include<string>\nusing namespace std;\nint H,W;\nchar t[700][700],ch;\n\nstring dp[700][700],maxm;\n\nstring strmax(string x,string y){\n  while(x[0]=='0'&&x.size()>=2)x=x.substr(1,x.size()-1);\n  while(y[0]=='0'&&y.size()>=2)y=y.substr(1,y.size()-1);\n  if(x.size()==y.size()){\n    for(int i=0;i<(int)x.size();i++){\n      if(x[i]>y[i]){\n\treturn x;\n      }else if(x[i]<y[i]){\n\treturn y;\n      }\n    }\n    return x;\n  }else if(x.size()>y.size()){\n    return x;\n  }else{\n    return y;\n  }\n}\n\nchar judge(char ch){\n  if('0'<=ch&&ch<='9')return ch;\n  else return '-';\n}\nint main(){\n  \n  while(cin>>W>>H&&W&&H){\n    scanf(\"%c\",&t[0][0]);\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\tdp[i][j]=\"\";\n\tscanf(\"%c\",&t[i][j]);\n      }\n      scanf(\"%c\",&ch);\n    }\n    \n    dp[0][0].push_back(judge(t[0][0])); \n\n    for(int i=1;i<W;i++){\n      if(judge(t[0][i])=='-'){\n\tdp[0][i]=\"-\";\n\tcontinue;\n      }\n      if(dp[0][i-1]!=\"-\")dp[0][i]=dp[0][i-1];      \n      dp[0][i].push_back(judge(t[0][i]));\n    }\n    for(int i=1;i<H;i++){\n      if(judge(t[i][0])=='-'){\n\tdp[i][0]=\"-\";\n\tcontinue;\n      }\n      if(dp[i-1][0]!=\"-\")dp[i][0]=dp[i-1][0];      \n      dp[i][0].push_back(judge(t[i][0]));\n    }\n\n    maxm=\"0\";\n    for(int i=1;i<H;i++){\n      for(int j=1;j<W;j++){\n\tif(judge(t[i][j])=='-'){\n\t  dp[i][j]=\"0\";\n\t  continue;\n\t}\n\tdp[i][j]=strmax(dp[i-1][j],dp[i][j-1]);\n\tdp[i][j].push_back(t[i][j]);\n    \n\tmaxm=strmax(dp[i][j],maxm);\n      }\n    }\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\t\tmaxm=strmax(dp[i][j],maxm);\n      }\n    }\n    cout<<maxm<<endl;\n    \n  }\n  return 0;\n  \n}"
  },
  {
    "language": "C++",
    "code": "#include<queue>\n#include<algorithm>\n#include<iostream>\n#include<string>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\nusing namespace std;\nint main(){\n  int i,j;\n  int w,h;\n  while(cin>>w>>h&&w+h){\n    char a[100][100];\n    for(i=0;i<100;i++)\n      for(j=0;j<100;j++)\n\ta[j][i]='a';\n    for(i=0;i<h;i++)\n      for(j=0;j<w;j++)\n\tcin>>a[j][i];\n    string b[100][100];\n    for(i=0;i<h;i++)\n      for(j=0;j<w;j++)\n\tb[j][i]=\"\";\n    queue<pair<pair<int,int>,string> > c;\n    for(i=0;i<h;i++)\n      for(j=0;j<w;j++)\n\tc.push(make_pair(make_pair(j,i),\"\"));\n    string mx=\"\";\n    while(c.empty()==0){\n      int x,y;\n      string s;\n      x=c.front().first.first;\n      y=c.front().first.second;\n      s=c.front().second;\n      c.pop();\n      if(a[x][y]>='0'&&a[x][y]<='9'){\n\tif(s!=\"\"||a[x][y]!='0')\n\t  s+=a[x][y];\n\tint mxln=mx.length();\n\tint sln=s.length();\n\tif(mxln<sln){\n\t  mx=s;\n\t}else if(mxln==sln){\n\t  for(i=0;i<sln;i++){\n\t    if(0){\n\t    }else if(mx[i]<s[i]){\n\t      break;\n\t    }else if(mx[i]>s[i]){\n\t      i=sln-1;\n\t    }\n\t  }\n\t  if(i!=sln)\n\t    mx=s;\n\t}\t\n\tint bln=b[x][y].length();\n\tif(bln<sln){\n\t  b[x][y]=s;\n\t  c.push(make_pair(make_pair(x+1,y),s));\n\t  c.push(make_pair(make_pair(x,y+1),s));\n\n\t}else if(bln==sln){\n\t  for(i=0;i<sln;i++){\n\t    if(0){\n\t    }else if(b[x][y][i]<s[i]){\n\t      break;\n\t    }else if(b[x][y][i]>s[i]){\n\t      i=sln-1;\n\t    }\n\t  }\n\t  if(i!=sln){\n\t    b[x][y]=s;\n\t    c.push(make_pair(make_pair(x+1,y),s));\n\t    c.push(make_pair(make_pair(x,y+1),s));\n\n\t  }\n\t}\n      }\n    }\n    cout<<(mx==\"\"?\"0\":mx)<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <functional>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <deque>\n#include <ctime>\n  \nusing namespace std;\n  \n#define rep(i,n) REP(i,0,n)\n#define REP(i,s,e) for(int i=(s); i<(int)(e); i++)\n#define pb push_back\n#define mp make_pair\n#define all(r) r.begin(),r.end()\n#define rall(r) r.rbegin(),r.rend()\n#define fi first\n#define se second\n#define println(X) cout<<X<<endl;\n#define DBG(X) cout<<#X<<\" : \"<<X<<endl;\n  \ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vii;\ntypedef vector<ll> vl;\ntypedef vector<vl> vll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n \nconst int INF = 1e9;\nconst ll LINF = 1e18;\nconst ll MOD = 1e9 + 7;\ndouble EPS = 1e-8;\nconst double PI = acos(-1);\n\nstring s[110];\nstring ans;\nint w, h;\n\nvoid calc(int i, int j, string num){\n\tif(i >= h || j >= w) {\n\t\tif(ans.size() < num.size()) ans = num;\n\t\telse if(ans.size() > num.size()) return;\n\t\telse{\n\t\t\tfor(int i = 0; i < ans.size(); i++){\n\t\t\t\tif(ans[i] > num[i]) return;\n\t\t\t}\n\t\t\tans = num;\n\t\t}\n\t\treturn;\n\t}\n\tif(s[i][j]>='0' && s[i][j] <= '9'){\n\t\tnum += s[i][j];\n\t\tcalc(i + 1, j, num);\n\t\tcalc(i, j + 1, num);\n\t}\n\telse calc(INF,INF, num);\n}\n\nint main(){\n\twhile(cin>>w>>h && w && h){\n\t\trep(i, h) cin>>s[i];\n\t\tans = \"\";\n\t\trep(i, h) rep(j, w) calc(i, j, \"\");\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<cctype>\n#include<math.h>\n\nusing namespace std;\n\nbool former_is_bigger(string a, string b){\n    if(a.size() > b.size() || (a.size() == b.size() && a.compare(b) >= 1)){\n        return true;\n    } else {\n        return false;\n    }\n}\n\nint main(){\n    while(1){\n        int w, h;\n        string dp[71][71];\n        string map[71][71];\n        \n        cin >> w >> h;\n\n        if(w==0) break;\n        \n        for(int i=0; i<h; ++i){\n            string line;\n            cin >> line;\n            for(int j=0; j<w; ++j){\n                map[i][j] = line.substr(j, 1);\n            }\n        }\n\n        for(int i=0; i<71; ++i){\n            for(int j=0; j<71; ++j){\n                dp[i][j] = \"\";\n            }\n        }\n\n        for(int i=h-1; i>=0; --i){\n            for(int j=w-1; j>=0; --j){\n                int copy_i;\n                int copy_j;\n                if(isdigit(map[i][j][0])){\n                    if(former_is_bigger(dp[i+1][j],  dp[i][j+1])){\n                        copy_i = i+1;\n                        copy_j = j;\n                    } else if(former_is_bigger(dp[i][j+1], dp[i+1][j])){\n                        copy_i = i;\n                        copy_j = j+1;\n                    } else {\n                        copy_i = i+1;\n                        copy_j = j;\n                    }\n                    dp[i][j] = map[i][j] + dp[copy_i][copy_j];\n                }\n            }\n        }\n        /*\n        for(int i=0; i<=h; i++){\n            for(int j=0; j<=w; j++){\n                cout << dp[i][j] << \"   \";\n            }\n            cout << endl;\n        }\n        */\n\n        string output = \"\";\n        for(int i=0; i<h; ++i){\n            for(int j=0; j<w; ++j){\n                if(dp[i][j][0] != '0'){\n                    if(former_is_bigger(dp[i][j], output)){\n                        output = dp[i][j];\n                    }\n                }\n            }\n        }\n        cout << output << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\n#include<algorithm>\n#define F first\n#define S second\nusing namespace std;\ntypedef pair<int,int> P;\ntypedef vector<vector<char> > VVC;\nint dx[] = {0,1};\nint dy[] = {1,0};\nstring message;\nint h,w;\nVVC G;\n\nbool check(string a,string b)\n{\n  if(a.size() != b.size())\n    return a.size() > b.size();\n\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] > b[i];\n  return true;\n}\n\nvoid dfs(string secret,P p)\n{\n\n\n  bool update = false;\n  for(int i=0;i<2;i++)\n    {\n      int nx = p.F + dx[i];\n      int ny = p.S + dy[i];\n      if(!(0 <= nx && nx < w && 0 <= ny && ny < h) || !('0'<=G[ny][nx] && G[ny][nx]<='9' ))\n\tcontinue;\n\n      update = true;\n      dfs(secret+G[ny][nx],P(nx,ny));\n    }\n\n  if(!update)\n    {\n      if(!check(message,secret))\n\t{\n\t  message = secret;\n\t}\n    }\n}\n\nint main()\n{\n\n  while(true)\n    {\n      cin >> w >> h;\n      if(w+h == 0)\n\tbreak;\n      message = \"0\";\n      G.clear();\n      G.resize(h);\n      for(int i=0;i<h;i++)\n\t{\n\t  G[i].resize(w);\n\t  for(int j=0;j<w;j++)\n\t    cin >> G[i][j];\n\t}\n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\t      if('1' <= G[i][j] && G[i][j] <= '9')\n\t\t{\n\t\t  string mes;\n\t\t  mes += G[i][j];\n\t\t  dfs(mes,P(j,i));\n\t\t}\n\t    }\n\t}\n\n    \n      cout << message << endl;\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\nusing namespace std;\n\nstring solve(vector<string> &C, int W, int H, int i, int j, string ret){\n  string s[2];\n  ret += C[i][j];\n  for(int k = 1; k < 3; ++k){\n    if(i+k/2 < H && j+k%2 < W && C[i+k/2][j+k%2] <= '9' && C[i+k/2][j+k%2] >= '0'){\n      s[k-1] = solve(C,W,H,i+k/2,j+k%2,\"\");\n    }\n  }\n  if(s[0].size() == s[1].size()){\n    ret += max(s[0],s[1]);\n  }else{\n    if(s[0].size() > s[1].size()) ret += s[0];\n    else ret += s[1];\n  }\n  return ret;\n}\n\nint main(){\n  int W, H;\n  while(cin >> W >> H, W){\n    vector<string> C(H);\n    for(int i = 0; i < H; ++i)\n      cin >> C[i];\n    string ans;\n    for(int i = 0; i < H; ++i){\n      for(int j = 0; j < W; ++j){\n\tif(C[i][j] > '9' || C[i][j] <= '0' || (C[i-1][j] > '0' && C[i-1][j] <= '9') || (C[i][j-1] > '0' && C[i][j-1] <= '9')) continue;\n\telse{\n\t  string t = solve(C,W,H,i,j,\"\");\n\t  if(ans.size() == t.size()) ans = max(ans, t);\n\t  else if(ans.size() < t.size()) ans = t;\n\t}\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <limits.h>\n#include <math.h>\n#include <bitset>\n#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <iomanip>\n#include <iostream>\n\n#define VARIABLE(x) cerr << #x << \"=\" << x << endl\n#define BINARY(x) static_cast<bitset<16> >(x);\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define REP(i,m,n) for (int i=m;i<(int)(n);i++)\n#define if_range(x, y, w, h) if (0<=(int)(x) && (int)(x)<(int)(w) && 0<=(int)(y) && (int)(y)<(int)(h))\n\nconst int INF = 100000000;\ntypedef double D;\nconst double EPS = 1e-8;\nconst double PI = 3.14159;\nint dx[4]={-1, 0, 1, 0}, dy[4]={0, -1, 0, 1};\nusing namespace std;\ntypedef pair<int, int> P;\n\n/** Problem1126 : The Secret Number **/\nconst int MAX_W = 70;\nint W, H;\nchar field[MAX_W][MAX_W];\nstring dp[MAX_W][MAX_W];\n\nstring big(string s1, string s2) {\n\tif (s1.length() > s2.length()) {\n\t\treturn s1;\n\t} else if (s2.length() > s1.length()) {\n\t\treturn s2;\n\t} else {\n\t\treturn (s1>s2?s1:s2);\n\t}\n}\n\nstring big2(string s1, string s2) {\n\twhile (s1[0]=='0') s1.erase(s1.begin());\n\twhile (s2[0]=='0') s2.erase(s2.begin());\n\treturn big(s1, s2);\n}\n\nstring rec(int x, int y)\n{\n\tif (!('0' <= field[y][x] && field[y][x] <= '9'))\n\t\treturn dp[y][x] = \"\";\n\t\n\tstring s1 = field[y][x] + dp[y][x+1];\n\tstring s2 = field[y][x] + dp[y+1][x];\n\t\n\treturn dp[y][x] = big(s1, s2);\n}\n\nint main()\n{\n\twhile (cin>>W>>H, W||H) {\n\t\tfill(dp[0], dp[0]+W*H, \"\");\n\t\t\n\t\trep(i, H) {\n\t\t\trep(j, W) {\n\t\t\t\tcin>>field[i][j];\n\t\t\t}\n\t\t}\n\t\t\n\t\tstring ans = \"0\";\n\t\trep(y, H) {\n\t\t\trep(x, W) {\n\t\t\t\tans = big2(ans, rec(W-x-1, H-y-1));\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing int64 = long long;\n\nint main() {\n  int W, H;\n  while(cin >> W >> H, W) {\n    string C[70];\n    for(int i = 0; i < H; i++) {\n      cin >> C[i];\n    }\n    const int vy[] = {1,\n                      0}, vx[] = {0, 1};\n    string dp[70][70];\n    fill_n(*dp, 70 * 70, \"~\");\n    function< string(int, int) > dfs = [&](int y, int x) {\n      if(dp[y][x] != \"~\") return dp[y][x];\n      string ret = \"\";\n      for(int i = 0; i < 2; i++) {\n        int ny = y + vy[i], nx = x + vx[i];\n        if(ny >= H || nx >= W) continue;\n        if(!isdigit(C[ny][nx])) continue;\n        string beet;\n        beet += C[ny][nx];\n        beet += dfs(ny, nx);\n        if(ret.size() < beet.size()) ret = beet;\n        else if(ret.size() == beet.size()) ret = max(ret, beet);\n      }\n      return dp[y][x] = ret;\n    };\n    string ret = \"0\";\n    for(int i = 0; i < H; i++) {\n      for(int j = 0; j < W; j++) {\n        if(isdigit(C[i][j]) && C[i][j] != '0') {\n          string beet;\n          beet += C[i][j];\n          beet += dfs(i, j);\n          if(ret.size() < beet.size()) ret = beet;\n          else if(ret.size() == beet.size()) ret = max(ret, beet);\n        }\n      }\n    }\n    cout << ret << endl;\n  }\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cctype>\n#include <string>\n#include <algorithm>\n\nusing namespace std;\n\nstring myMax(string a, string b)\n{\n\tif (a.length() < b.length()) return b;\n\tif (a.length() > b.length()) return a;\n\n\tfor (int i = 0; i < a.length(); i++){\n\t\tif (a[i] < b[i]){\n\t\t\treturn b;\n\t\t}\n\t\tif (a[i] > b[i]){\n\t\t\treturn a;\n\t\t}\n\t}\n\treturn a;\n}\n\nstring retMax(string a, string b)\n{\n\t// 先頭の0をさくじょ\n\tstring c, d;\n\tbool pf = false;\n\tfor (int i = 0; i < a.length(); i++){\n\t\tif (pf || a[i] != '0'){\n\t\t\tc += a[i];\n\t\t\tpf = true;\n\t\t}\n\t}\n\tpf = false;\n\tfor (int i = 0; i < b.length(); i++){\n\t\tif (pf || b[i] != '0'){\n\t\t\td += b[i];\n\t\t\tpf = true;\n\t\t}\n\t}\n\ta = c;\n\tb = d;\n\tif (a == \"\") a = \"0\";\n\tif (b == \"\") b = \"0\";\n\t// cout << a << \" \" << b << endl;\n\t// 大小ひかく\n\tif (a.length() < b.length()) return b;\n\tif (a.length() > b.length()) return a;\n\n\tfor (int i = 0; i < a.length(); i++){\n\t\tif (a[i] < b[i]){\n\t\t\treturn b;\n\t\t}\n\t\tif (a[i] > b[i]){\n\t\t\treturn a;\n\t\t}\n\t}\n\treturn a;\n}\n\nint main(void)\n{\n\tint w, h;\n\twhile (cin >> w >> h, w && h){\n\t\tstring field[80];\n\t\tfor (int i = 0; i < h; i++){\n\t\t\tcin >> field[i];\n\t\t}\n\t\tstring dp[80][80] = {};\n\t\tstring ret;\n\t\t// 右下からやる\n\t\tfor (int i = h-1; 0 <= i; i--){\n\t\t\tfor (int j = w-1; 0 <= j; j--){\n\t\t\t\tif ('0' <= field[i][j] && field[i][j] <= '9'){\n\t\t\t\t\tdp[i][j] = myMax(field[i][j] + dp[i][j + 1], field[i][j] + dp[i + 1][j]);\n\t\t\t\t}\n\t\t\t\t// 0 を考慮した大小\n\t\t\t\tret = retMax(dp[i][j], ret);\n\t\t\t\t// cout << ret << endl;\n\t\t\t}\n\t\t}\n\n\t\t/*\n\t\tfor (int i = 0; i < h; i++){\n\t\t\tfor (int j = 0; j < w; j++){\n\t\t\t\tif (dp[i][j] != \"\") cout << dp[i][j] << \" \";\n\t\t\t\telse cout << \"* \";\n\t\t\t}\n\t\t\tputs(\"\");\n\t\t}*/\n\t\t\n\n\t\tbool pf = false;\n\t\tfor (int i = 0; i < ret.length(); i++){\n\t\t\tif (pf || ret[i] != '0'){\n\t\t\t\tcout << ret[i];\n\t\t\t\tpf = true;\n\t\t\t}\n\t\t}\n\t\tif (!pf) cout << \"0\";\n\t\tcout << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nbool cmpstring(const string &l, const string &r) {\n  if(l.size() != r.size()) return l.size() < r.size();\n  for(int i = 0; i < l.size(); ++i)\n    if(l[i] != r[i]) return l[i] < r[i];\n  return 0;\n}\n\nstruct data {\n  int x, y;\n  string s;\n};\n\nbool operator<(const data &l, const data &r) {\n  if(l.s != r.s) return cmpstring(l.s, r.s);\n  if(l.x != r.x) return l.x > r.x;\n  return l.y > r.y;\n}\n\nint w, h;\nvector<string> s;\nstring dist[80][80];\nint d[2] = {0, 1};\npriority_queue<data> pq;\n\nstring solve();\nbool ch(const data &now) {\n  return now.x >= 0 && now.x < h && now.y >= 0 &&\n         now.y < w && s[now.x][now.y] >= '0' &&\n         s[now.x][now.y] <= '9';\n}\n\nint main() {\n  while(1) {\n    cin >> w >> h;\n    if(w + h == 0) break;\n    s.resize(h);\n    for(int i = 0; i < h; ++i) cin >> s[i];\n    cout << solve() << endl;\n  }\n  return 0;\n}\n\nstring solve() {\n  string ans = \"\";\n  for(int i = 0; i < h; ++i)\n    for(int j = 0; j < w; ++j) {\n      dist[i][j] = \"X\";\n      if(s[i][j] >= '1' && s[i][j] <= '9') {\n        string pushs;\n        pushs += s[i][j];\n        dist[i][j] = pushs;\n        pq.push({i, j, pushs});\n        ans = max(ans, pushs);\n      }\n      else if(s[i][j] == '0') {\n        dist[i][j] = \"\";\n        ans = \"0\";\n        pq.push({i, j, \"\"});\n      }\n    }\n  while(!pq.empty()) {\n    data now = pq.top();\n    pq.pop();\n    if(dist[now.x][now.y] != now.s) continue;\n    for(int i = 0; i < 2; ++i) {\n      data nextp = now;\n      nextp.x += d[i];\n      nextp.y += d[1 ^ i];\n      if(!ch(nextp)) continue;\n      if(nextp.s.size() != 0 || s[nextp.x][nextp.y] != '0')\n        nextp.s += s[nextp.x][nextp.y];\n      if(dist[nextp.x][nextp.y] == \"X\" ||\n         cmpstring(dist[nextp.x][nextp.y], nextp.s)) {\n        dist[nextp.x][nextp.y] = nextp.s;\n        pq.push(nextp);\n        if(cmpstring(ans, nextp.s)) ans = nextp.s;\n      }\n    }\n  }\n  return ans;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <utility>\n#include <vector>\n#define llint long long\n\nusing namespace std;\n//typedef pair<llint, llint> P;\ntypedef pair<llint, string> P;\n\nllint w, h;\nchar c[75][75];\nstring dp[75][75];\n\nstring getmax(string s, string t)\n{\n\tif(s.size() < t.size()) return t;\n\tif(t.size() < s.size()) return s;\n\treturn max(s, t);\n}\n\nint main(void)\n{\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(w == 0 && h == 0) break;\n\t\t\n\t\tfor(int y = 1;  y<= h; y++){\n\t\t\tfor(int x = 1; x <= w; x++){\n\t\t\t\tcin >> c[x][y];\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor(int y = 1; y <= h; y++){\n\t\t\tfor(int x = 1; x <= w; x++){\n\t\t\t\tdp[x][y] = \"\";\n\t\t\t}\n\t\t}\n\t\tfor(int y = 1; y <= h; y++){\n\t\t\tfor(int x = 1; x <= w; x++){\n\t\t\t\tif(c[x][y] < '0' || c[x][y] > '9') continue;\n\t\t\t\tdp[x][y] = getmax(dp[x-1][y]+c[x][y], dp[x][y-1]+c[x][y]);\n\t\t\t\tif(dp[x][y] == \"0\") dp[x][y] = \"\";\n\t\t\t}\n\t\t}\n\t\t\n\t\tstring ans = \"0\";\n\t\tfor(int y = 1; y <= h; y++){\n\t\t\tfor(int x = 1; x <= w; x++){\n\t\t\t\tans = getmax(ans, dp[x][y]);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\n#define REP(i,n) for(ll i=0;i<n;++i)\n#define RREP(i,n) for(ll i=n-1;i>=0;--i)\n#define FOR(i,m,n) for(ll i=m;i<n;++i)\n#define RFOR(i,m,n) for(ll i=n-1;i>=m;--i)\n#define ALL(v) (v).begin(),(v).end()\n#define PB(a) push_back(a)\n#define UNIQUE(v) v.erase(unique(ALL(v)),v.end());\n#define DUMP(v) REP(aa, (v).size()) { cout << v[a]; if (a != v.size() - 1)cout << \" \"; else cout << endl; }\n#define INF 1000000001ll\n#define MOD 1000000007ll\n#define EPS 1e-9\n\nconst int dx[8] = { 1,1,0,-1,-1,-1,0,1 };\nconst int dy[8] = { 0,1,1,1,0,-1,-1,-1 };\n\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector<vi> vvi;\ntypedef vector<vl> vvl;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nll max(ll a, int b) { return max(a, ll(b)); }\nll max(int a, ll b) { return max(ll(a), b); }\nll min(ll a, int b) { return min(a, ll(b)); }\nll min(int a, ll b) { return min(ll(a), b); }\n///(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)///\nint w, h;\nstring smax(string s, string t) {\n\tif (s.size() < t.size())return t;\n\tif (t.size() < s.size())return s;\n\tif (s.size() == 0)return t;\n\tif (t.size() == 0)return s;\n\n\tREP(i, s.size()) {\n\t\tif (s[i] < t[i])return t;\n\t\tif (s[i] > t[i])return s;\n\t}\n\treturn s;\n}\nstring dfs(vector<string> &v, vector<vector<string>> &dp, int x, int y) {\n\tif (x >= w || y >= h)return \"\";\n\tif (isalpha(v[y][x]))return \"\";\n\tif (dp[y][x] != \"\")return dp[y][x];\n\tstring ret = \"\";\n\tret += v[y][x];\n\tstring tmp;\n\ttmp = smax(tmp, dfs(v, dp, x + 1, y));\n\ttmp = smax(tmp, dfs(v, dp, x, y + 1));\n\treturn dp[y][x] = ret + tmp;\n\t\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\twhile (1) {\n\t\n\t\tcin >> w >> h;\n\t\tif (!w)break;\n\t\tvector<string> v(h);\n\t\tvector<vector<string>> dp(h, vector<string>(w, \"\"));\n\t\tREP(i, h)cin >> v[i];\n\t\t\n\t\tstring ans;\n\t\tREP(i, h) {\n\t\t\tREP(j, w) {\n\t\t\t\tif (dp[i][j] == \"\")dfs(v, dp, j, i);\n\t\t\t}\n\t\t}\n\t\tREP(i, h) {\n\t\t\tREP(j, w) {\n\t\t\t\tREP(p, dp[i][j].size()) {\n\t\t\t\t\tif (dp[i][j][p] != '0') {\n\t\t\t\t\t\tdp[i][j] = dp[i][j].substr(p);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tans = smax(ans, dp[i][j]);\n\t\t\t}\n\t\t}\n\t\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "# define _CRT_SECURE_NO_WARNINGS 1\n# include <iostream>\n# include <numeric>\n# include <string>\n# include <bitset>\n# include <vector>\n# include <algorithm>\n# include <cstdlib>\n# include <cstdio>\n# include <cstring>\n# include <cstdlib>\n# include <iomanip>\n# include <queue>\n# include <sstream>\n# include <climits>\n# include <cmath>\n# include <list>\n# include <functional>\n# include <string>\n# include <ctime>\n# include <set>\n# include <forward_list>\n# include <map>\n# include <stack>\nusing namespace std;\n\n# define INF ((int)(1<<30))\n# define REP(i,n) for(int i=0;i<(int)n;i++)\n# define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();i++)\n# define TORAD 2.0*M_PI/360.0\n# define INT(x) int x;cin>>x;\n# define ALL(x) (x).begin(),(x).end()\n# define DEBUG(x) cout<<#x<<\" :\"<<x<<endl;\n# define EPS 1e-12\n\ntemplate<class T> void debug(T a) { for (auto i : a)cout << i << endl; }\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef pair<int, pii> piii;\nint dx[4] = { 0,-1,1,0 }, dy[4] = { 1,0,0,-1 };\n\nint clamp(int a, int mi, int ma)\n{\n\treturn max(mi, min(a, ma));\n}\nbool isnum(char a)\n{\n\treturn ('0' <= a&&a <= '9');\n}\nstring big(string a, string b)\n{\n\tif (a.size() > b.size())\n\t{\n\t\treturn a;\n\t}\n\tif (a.size() < b.size())\n\t{\n\t\treturn b;\n\t}\n\treturn max(a, b);\n}\n\n\nchar a[100][100];\nbool flag[100][100];\nstring ans;\nvoid hoge(string &s, int y, int x)\n{\n\tans = big(ans, s);\n\tflag[y][x] = true;\n\tint DY[2] = { 0,1 }, DX[2] = { 1,0 };\n\tREP(i, 2)\n\t{\n\t\tint Y = y + DY[i];\n\t\tint X = x + DX[i];\n\t\tif (isnum(a[Y][X]))\n\t\t{\n\t\t\ts += a[Y][X];\n\t\t\thoge(s, Y, X);\n\t\t\ts.pop_back();\n\t\t}\n\t}\n\n\treturn;\n}\n\n\n\nint main()\n{\n\tint w, h;\n\twhile (cin >> w >> h&&w)\n\t{\n\t\t\n\t\tREP(i, 100)REP(j, 100)\n\t\t{\n\t\t\ta[i][j] = 'a';\n\t\t\tflag[i][j] = false;\n\t\t}\n\t\tans = \"\";\n\t\tREP(i, h)\n\t\t{\n\t\t\tREP(j, w)\n\t\t\t{\n\t\t\t\tcin >> a[i][j];\n\t\t\t}\n\t\t}\n\t\t\n\t\tREP(y, h)\n\t\t{\n\t\t\tREP(x, w)\n\t\t\t{\n\t\t\t\tif (isnum(a[y][x]) && flag[y][x] == false && a[y][x] != '0')\n\t\t\t\t{\n\t\t\t\t\tstring str; str += a[y][x];\n\t\t\t\t\thoge(str, y, x);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<climits>\n#include<iostream>\n#include<algorithm>\n#include<stack>\n#include<queue>\n#include<vector>\n#include<list>\n#include<map>\n#include<set>\ntypedef long long ll;\ntypedef unsigned long long ull;\nusing namespace std;\n#define pb push_back\nint dy[]={0, 1};\nint dx[]={1, 0};\n \n#define FOR(i,a,b) for (int i=(a);i<(b);i++)\n#define RFOR(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define REP(i,n) for (int i=0;i<(n);i++)\n#define RREP(i,n) for (int i=(n)-1;i>=0;i--)\n\nstruct code{\n    char c[100];\n    int length;\n};\n\ncode memo[100][100];\nchar mat[100][100];\nint w,h;\n\nbool codecmp(code a,code b){\n    if(a.length < b.length)\n        return true;\n\n    if(a.length == b.length && a.length > 0 && strcmp(a.c,b.c) < 0)\n        return true;\n    return false;\n}\n\ncode search(int nowy,int nowx){\n\n    if(memo[nowy][nowx].length >= 0)\n        return memo[nowy][nowx];\n    code a[2];\n    for(int i = 0;i < 2;i++){\n        int x = nowx + dx[i],y = nowy + dy[i];\n        if(x >= 0 && x < w && y >= 0 && y < h && mat[y][x] >=  '0' && mat[y][x] <= '9'){\n            a[i] = search(y,x);\n        }\n        else{\n            a[i].c[0] = '\\0';\n            a[i].length = 0;\n        }\n    }\n\n    if(codecmp(a[0],a[1]))\n            a[0] = a[1];\n\n    memo[nowy][nowx].c[0] = mat[nowy][nowx];\n    for(int i = 0;i <= a[0].length;i++)\n        memo[nowy][nowx].c[i + 1] = a[0].c[i];\n    memo[nowy][nowx].length = a[0].length + 1;\n    return memo[nowy][nowx];\n}\n\n\nint main(){\n    while(1){\n        scanf(\"%d%d\",&w,&h);\n\n        if(w == 0 && h == 0)\n            break;\n\n        for(int i = 0;i < h;i++)\n            scanf(\"%s\",&mat[i][0]);\n\n        for(int i = 0;i <  100;i++)\n            for(int j = 0;j < 100;j++)\n                memo[i][j].length = -1;\n\n        code a,maxi;\n        maxi.c[0] = '\\0';maxi.length = 0;\n        for(int i = 0;i < h;i++){\n            for(int j = 0;j < w;j++){\n                if(mat[i][j] > '0' && mat[i][j] <= '9'){\n                    a = search(i,j);\n                    if(codecmp(maxi,a))\n                        maxi = a;\n                }\n            }\n        }\n        printf(\"%s\\n\",maxi.c);\n    }\n}"
  },
  {
    "language": "C++",
    "code": "//#include \"bits/stdc++.h\"\n\n#include <iostream>\n#include <array>\n// #include <map>\n#include <string>\n// #include <algorithm>\n// #include <numeric>\n// #include <limits>\n\nusing namespace std;\n\nint w; // j\nint h; // i\nstring max_s(72, ' ');\narray<array<char, 72>, 72> field; // [i][j]\narray<char, 72> num;\nstring str(72, ' ');\n\nstring big(const string& a, const string& b) {\n\tif (a.size() == b.size()) {\n\t\tif (a > b) {\n\t\t\treturn a;\n\t\t} else {\n\t\t\treturn b;\n\t\t}\n\t}\n\tif (a.size() > b.size()) {\n\t\treturn a;\n\t} else {\n\t\treturn b;\n\t}\n}\n\nvoid check(int d) {\n\tint padding = 0;\n\tfor (int k = 0; k < d; k++) {\n\t\tif (num[k] == '0') {\n\t\t\tpadding++;\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t}\n\tint s = d - padding; // as size\n\tstr.resize(s);\n\tfor (int k = 0; k < s; k++) {\n\t\tstr[k] = num[k + padding];\n\t}\n\tmax_s = big(max_s, str);\n}\n\nvoid _trace(int i, int j, int d /* depth */) {\n\tif (i >= h or j >= w or isdigit(field[i][j]) == false) {\n\t\tcheck(d);\n\t\treturn;\n\t}\n\tnum[d] = field[i][j];\n\td++;\n\t_trace(i + 1, j, d);\n\t_trace(i, j + 1, d);\n}\n\nvoid trace(int i, int j) {\n\tif (i > 0 and isdigit(field[i - 1][j])) {\n\t\treturn;\n\t}\n\tif (j > 0 and isdigit(field[i][j - 1])) {\n\t\treturn;\n\t}\n\t_trace(i, j, 0);\n}\n\nvoid solve() {\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\tcin >> field[i][j];\n\t\t}\n\t}\n\tmax_s = \"\";\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\ttrace(i, j);\n\t\t}\n\t}\n\tcout << max_s << endl;\n}\n\nint main() {\n\n\twhile (true) {\n\t\tcin >> w >> h;\n\t\tif (w == 0 and h == 0) {\n\t\t\tbreak;\n\t\t}\n\t\tsolve();\n\t}\n\n\t//std::cout << \"\\e[38;5;0m\\e[48;5;40m --- end ---  \\e[m\" << std::endl; // debug\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define vi vector<int>\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back\n#define pii pair<int,int>\n#define mp make_pair\n#define pi 3.14159265359\n#define shosu(X) fixed << setprecision(X)\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nbool isnum(char a){\n\treturn (a >= '0' && a <= '9');\n}\nstring removezero(string a){\n\tstring rst = \"\";\n\tbool flg = false;\n\tREP(i,a.size()){\n\t\tif(flg){\n\t\t\trst += a[i];\n\t\t}else{\n\t\t\tif(a[i] != '0'){\n\t\t\t\tflg = true;\n\t\t\t\trst += a[i];\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\treturn rst;\n}\nstring getbig(string a,string b){\n\ta = removezero(a);\n\tb = removezero(b);\n\treturn max(a,b);\n\t/*\n\tcout << a << \" \" << b << endl;\n\tif(a.size() < b.size()) return b;\n\telse if(a.size() > b.size()) return a;\n\tREP(i,a.size()){\n\t\tcout << a[i]-'0' << \" \" << b[i]-'0' << endl;\n\t\tif((int)a[i]-'0' < (int)b[i]-'0') {\n\t\t\tcout << \"big\" << b[i] << endl;\n\t\t\treturn b;\n\t\t}\n\t}\n\treturn a;*/\n}\nint main(){\n\tint w,h;\n\tchar g[70][70];\n\tstring s[70][70];\n\tcout << getbig(\"23900\",\"23114\") << endl;\n\twhile(1){\n\t\tstring ans = \"\";\n\t\tcin >> w >> h;\n\t\tif (w == 0 && h == 0) break;\n\t\tREP(i,h) REP(j,w) cin >> g[i][j];\n\t\tREP(i,h) REP(j,w) s[i][j] = \"\";\n\t\tREP(i,h){\n\t\t\tREP(j,w){\n\t\t\t\tif(!isnum(g[i][j])) continue;\n\t\t\t\tint lx = i; int ly = j-1;\n\t\t\t\tint ux = i-1; int uy = j;\n\t\t\t\tstring l,r;\n\t\t\t\tif(lx >= 0 && ly >= 0) l = s[lx][ly];\n\t\t\t\telse l = \"\";\n\t\t\t\tif(ux >= 0 && uy >= 0) r = s[ux][uy];\n\t\t\t\telse r = \"\";\n\t\t\t\tl.pb(g[i][j]);\n\t\t\t\tr.pb(g[i][j]);\n\t\t\t\ts[i][j] = getbig(l,r);\n\t\t\t\t//cout << l << \"??¨\" << r << \" big \" << s[i][j] << endl;\n\t\t\t\tans = getbig(ans,s[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\ntypedef long long LL;\n#define SORT(c) sort((c).begin(),(c).end())\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\nusing namespace std;\nint w,h;\nvector<string> field;\nvector<vector<bool> > check;\nvector<string> code;\nvoid createcode(int i,int j,string tmp)\n{\n  if(0<=i&&i<h&&0<=j&&j<w && '0'<=field[i][j]&&field[i][j]<='9'){\n    check[i][j]=true;\n    string nextmp=tmp;\n    nextmp.push_back(field[i][j]);\n    createcode(i+1,j,nextmp);\n    createcode(i,j+1,nextmp);\n  }\n  else code.push_back(tmp);\n}\n  \nint main(void)\n{\n  for(;;){\n    cin >> w >> h;\n    if(!w&&!h) return 0;\n    field.resize(h);\n    REP(i,h) cin >> field[i];\n    check.resize(h);\n    REP(i,h) check[i].assign(w,false);\n    code.clear();\n    REP(i,h) REP(j,w){\n      if(!check[i][j]){\n\tcheck[i][j]=true;\n\tif('1'<=field[i][j]&&field[i][j]<='9')createcode(i,j,\"\");\n      }\n    }\n    string answer=\"0\";\n    REP(i,code.size()){\n      if(code[i].size()>answer.size() || (code[i].size()==answer.size() && code[i]>answer))\n\tanswer=code[i];\n    }\n    cout << answer << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)   FOR(i,0,n)\n#define pb emplace_back\ntypedef long long ll;\ntypedef pair<int,int> pint;\n\nstring s[71];\nconst int dx[]={0,1},dy[]={1,0};\nstring dp[71][71];\nstring ans;\nint w,h;\nbool cmp(const string& a,const string& b){\n    if(a.size()!=b.size()) return a.size()<b.size();\n    else{\n        rep(i,a.size()){\n            if(a[i]>b[i]){\n                return false;\n            }\n            else if(a[i]<b[i]) return true;\n        }\n    }\n    return false;\n}\nstring dfs(int x,int y){\n    if(dp[y][x]!=\".\"){\n        return dp[y][x];\n    }\n    string ret;\n    ret+=s[y][x];\n    rep(i,2){\n        int tx=x+dx[i],ty=y+dy[i];\n        if(tx>=0&&ty>=0&&tx<w&&ty<h&&isdigit(s[ty][tx])){\n            ret=max(ret,s[y][x]+dfs(tx,ty),cmp);\n        }\n    }\n    return dp[y][x]=ret;\n}\nint main(){\n    while(cin>>w>>h,w){\n        rep(i,h)rep(j,w) dp[i][j]=\".\";\n        rep(i,h) cin>>s[i];\n        ans=\"\";\n        rep(i,h)rep(j,w)if(isdigit(s[i][j])&&s[i][j]!='0'){\n            ans=max(ans,dfs(j,i),cmp);\n        }\n        cout<<ans<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,n) for (int i=0;i<(n);i++)\n#define rep2(i,a,b) for (int i=(a);i<(b);i++)\n#define rrep(i,n) for (int i=(n)-1;i>=0;i--)\n#define rrep2(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef vector<int> vi;\ntypedef vector<pll> vp;\ntypedef vector<ll> vll;\n\nint W, H;\nstring c[71];\nstring dp[71][71];\n\nbool inside(int x, int y) {\n    return 0 <= x && x < H && 0 <= y && y < W;\n}\n\nstring maxString(string s, string t) {\n    if (s.length() > t.length()) return s;\n    if (s.length() < t.length()) return t;\n    return (s >= t) ? s : t;\n}\n\n\nsigned main() {\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(0);\n\n    while (cin >> W >> H && W) {\n        rep(i, H) cin >> c[i];\n\n        rep(i, H + 1) rep(j, W + 1) dp[i][j] = \"\";\n        string ans = \"\";\n        rep2(i, 1, H + 1) {\n            rep2(j, 1, W + 1) {\n                int ci = i - 1, cj = j - 1;\n                if (!isdigit(c[ci][cj])) continue;\n                string maxS = maxString(dp[i - 1][j], dp[i][j - 1]);\n                if (maxS == \"\" && c[ci][cj] == '0') {\n                    dp[i][j] = \"\";\n                } else {\n                    dp[i][j] = maxS + c[ci][cj];\n                    ans = maxString(ans, dp[i][j]);\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nint main() {\n\tint w, h;\n\twhile (cin >> w >> h, w){\n\t\tvector<string> vs(h);\n\t\tvector<vector<bool>> vvb(h);\n\t\tREP(i, h){\n\t\t\tcin >> vs[i];\n\t\t\tREP(j, w){\n\t\t\t\tvvb[i].push_back('0' <= vs[i][j] && vs[i][j] <= '9');\n\t\t\t}\n\t\t}\n\n\t\tvector<vector<int>> vvi(h);\n\t\tint max2 = 0;\n\t\tint x, y;\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tif (vvb[i][j]){\n\t\t\t\t\tint max = 1;\n\t\t\t\t\tif (i > 0 && vvb[i - 1][j])max = vvi[i - 1][j] + 1;\n\t\t\t\t\tif (j > 0 && vvb[i][j - 1])if (max < vvi[i][j - 1] + 1)max = vvi[i][j - 1] + 1;\n\t\t\t\t\tvvi[i].push_back(max);\n\t\t\t\t\tif (max > max2){\n\t\t\t\t\t\tmax2 = max;\n\t\t\t\t\t\t x = j;\n\t\t\t\t\t\t y = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tvvi[i].push_back(-1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvector<vector<int>> vvi2(h);\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tvvi2[i].push_back(-1);\n\t\t\t}\n\t\t}\n\t\tvvi2[y][x] = max2;\n\t\tqueue<int> qi;\n\t\tqi.push(max2 * 10000 + x * 100 + y);\n\t\twhile (!qi.empty()){\n\t\t\tint pos = qi.front(); qi.pop();\n\t\t\tint max3 = pos / 10000;\n\t\t\tint x2 = (pos / 100) % 100;\n\t\t\tint y2 = pos % 100;\n\t\t\tif (x2 > 0 && vvb[y2][x2 - 1] && vvi2[y2][x2 - 1]==-1){\n\t\t\t\tvvi2[y2][x2 - 1] = max3 - 1;\n\t\t\t\tqi.push((max3-1) * 10000 + (x2-1) * 100 + y2);\n\t\t\t}\n\t\t\tif (y2 > 0 && vvb[y2 - 1][x2] && vvi2[y2-1][x2] == -1){\n\t\t\t\tvvi2[y2 - 1][x2] = max3 - 1;\n\t\t\t\tqi.push((max3 - 1) * 10000 + x2 * 100 + (y2-1));\n\t\t\t}\n\t\t}\n\t\tchar max4 = '0' - 1;\n\t\tint x3, y3;\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tif (vvi2[i][j] == 1 && max4 < vs[i][j]){\n\t\t\t\t\tmax4 = vs[i][j];\n\t\t\t\t\tx3 = j;\n\t\t\t\t\ty3 = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ans;\n\t\tif(max4!='0')ans += max4;\n\t\tREP(i,max2-1){\n\t\t\tbool abb = false;\n\t\t\tmax4 = '0' - 1;\n\t\t\tif (y3 + 1 != h&&vvi2[y3+1][x3]>0 && max4 < vs[y3 + 1][x3]){\n\t\t\t\tmax4 = vs[y3 + 1][x3];\n\t\t\t\ty3 ++;\n\t\t\t\tabb = true;\n\t\t\t}\n\t\t\tif (abb){\n\t\t\t\tif (x3 + 1 != w&&vvi2[y3-1][x3 + 1]>0 && max4 < vs[y3-1][x3 + 1]){\n\t\t\t\t\tmax4 = vs[y3-1][x3 + 1];\n\t\t\t\t\tx3++;\n\t\t\t\t\ty3--;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif (x3 + 1 != w&&vvi2[y3][x3 + 1]>0 && max4 < vs[y3][x3 + 1]){\n\t\t\t\t\tmax4 = vs[y3][x3 + 1];\n\t\t\t\t\tx3++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!(ans.empty() && max4 == '0'))ans += max4;\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <cstring>\nusing namespace std;\n\n#define rep(i,n) for(int i=0; i<n; i++)\ntypedef long long ll;\n\nbool isN(char c) {\n\treturn '0'<=c && c<='9';\n}\n\nbool comp(string s1, string s2) {\n\tif( s1.length() < s2.length() ) {\n\t\tfor(int i=0; i<s2.length()-s1.length()+1; i++) {\n\t\t\ts1 = '0' + s1;\n\t\t}\n\t} else if( s1.length() > s2.length() ) {\n\t\tfor(int i=0; i<s1.length()-s2.length()+1; i++) {\n\t\t\ts2 = '0' + s2;\n\t\t}\n\t}\n\treturn (s1 < s2);\n}\n\nint main() {\n\tint w, h;\n\twhile( cin >> w >> h, w||h ) {\n\t\tvector<string> f(h);\n\t\trep(i,h) cin >> f[i];\n\t\tstring dp[70][70];\n\t\trep(x,w)  rep(y,h)  dp[y][x] = \"\";\n\t\tif( isN(f[0][0]) ) dp[0][0] += f[0][0];\n\t\tstring res = \"\";\n\t\trep(y, h) {\n\t\t\trep(x, w) {\n\t\t\t\tif( isN(f[y][x]) ) {\n\t\t\t\t\tstring con = \"\";\n\t\t\t\t\tif(x-1>=0 && comp(con, dp[y][x-1]))\n\t\t\t\t\t\tcon = dp[y][x-1];\n\t\t\t\t\tif(y-1>=0 && comp(con, dp[y-1][x]))\n\t\t\t\t\t\tcon = dp[y-1][x];\n\t\t\t\t\tdp[y][x] = con + f[y][x];\n\t\t\t\t}\n\t\t\t\tif( comp(res, dp[y][x]) )\n\t\t\t\t\tres = dp[y][x];\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,n) for(int i=0;i<(n);++i)\n#define loop for(;;)\n#define trace(var) cerr<<\">>> \"<<#var<<\" = \"<<var<<endl;\n#define all(v) begin(v),end(v)\n#define pb push_back\n#define inf (1e9)\n#define eps (1e-9)\n\ntypedef long long Integer ;\ntypedef long double Real;\nconst Real PI = acosl(-1);\ntypedef pair<int, int> P;\n\ntemplate<class S, class T> inline\nostream& operator<<(ostream&os, pair<S,T> p) {\n  return os << '(' << p.first << \", \" << p.second << ')';\n}\n\ntemplate<class S, class T, class U> inline\nostream& operator<<(ostream&os, tuple<S,T,U> t) {\n  return os << '('\n    << get<0>(t) << \", \"\n    << get<1>(t) << \", \"\n    << get<2>(t) << ')';\n}\n\ntemplate<class T> inline\nostream& operator<<(ostream&os, set<T> v) {\n  os << \"(set\";\n  for (T item: v) os << ' ' << item;\n  os << \")\";\n  return os;\n}\n\ntemplate<class T> inline\nostream& operator<<(ostream&os, vector<T> v) {\n  if (v.size() == 0) { return os << \"(empty)\"; }\n  os << v[0];\n  for (int i=1, len=v.size(); i<len; ++i) os << ' ' << v[i];\n  return os;\n}\n\ntemplate<class T> inline\nistream& operator>>(istream&is, vector<T>&v) {\n  rep (i, v.size()) is >> v[i];\n  return is;\n}\n\n//           ^   >  v   <\nint dx[] = { -1, 0, 1,  0 };\nint dy[] = {  0, 1, 0, -1 };\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<bool> vb;\n\nchar f[100][100];\n\nbool comp(string s, string t) {\n  if (s.size() != t.size()) return (s.size() < t.size());\n  rep (i, s.size()) if (s[i] != t[i]) return (s[i] < t[i]);\n  return true;\n}\n\nint main()\n{\n\n  int w, h;\n  while (cin >> w >> h, w and h)\n  {\n    rep (i, h) { rep (j, w) { cin >> f[i][j]; } }\n\n    stack<pair<P, string>> s;\n    rep (i, h) { rep (j, w) {\n      char c = f[i][j];\n      if (isdigit(c)) s.push(make_pair(make_pair(i, j), \"\"));\n    }}\n\n    string ans = \"\";\n\n    while (not s.empty()) {\n      auto p = s.top(); s.pop();\n      int i = p.first.first;\n      int j = p.first.second;\n      string str = p.second + f[i][j];\n      bool ap = false;\n      if (i < h-1 and isdigit(f[i+1][j])) {\n        s.push(make_pair(make_pair(i+1, j), str));\n        ap = true;\n      }\n      if (j < w-1 and isdigit(f[i][j+1])) {\n        s.push(make_pair(make_pair(i, j+1), str));\n        ap = true;\n      }\n      if (not ap) {\n        while (str[0] == '0') str = str.substr(1, str.size()-1);\n        if (comp(ans, str)) ans = str;\n      }\n    }\n\n    cout << ans << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstring chmax(string a, string b){\n  if(a.size() < b.size()) return b;\n  else if(a.size() > b.size()) return a;\n  else return a > b ? a : b;\n}\n\nint main(){\n  int W, H;\n  char C[70][70];\n  string dp[70][70];\n\n  while(cin >> W >> H, W){\n    for(int i = 0; i < H; ++i){\n      for(int j = 0; j < W; ++j){\n        cin >> C[i][j];\n      }\n    }\n    for(int i = 0; i < H; ++i){\n      for(int j = 0; j < W; ++j){\n        if(isdigit(C[i][j])) dp[i][j] = string( 1, C[i][j]);\n        else dp[i][j] = \"0\";\n      }\n    }\n    for(int j = 0; j < H; ++j){\n      for(int k = 0; k < W; ++k){\n        if(dp[j][k] == \"0\") continue;\n        if(k + 1 < W && isdigit(C[j][k + 1])) dp[j][k + 1] = chmax( dp[j][k + 1], dp[j][k] + C[j][k + 1]);\n        if(j + 1 < H && isdigit(C[j + 1][k])) dp[j + 1][k] = chmax( dp[j + 1][k], dp[j][k] + C[j + 1][k]);\n      }\n    }\n    string ret = \"0\";\n    for(int i = 0; i < H; ++i){\n      for(int j = 0; j < W; ++j) ret = chmax( ret, dp[i][j]);\n    }\n    cout << ret << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define all(x) (x).begin(),(x).end()\nconst int mod=1000000007,MAX=73,INF=1<<30;\nvector<string> S(MAX);\nstring dp[MAX][MAX];\nint H,W;\n\nstring DFS(int h,int w){\n    if(h==H) return \"\";\n    if(w==W) return \"\";\n    if(dp[h][w]!=\"\") return dp[h][w];\n    \n    string res;\n    if('0'<=S[h][w]&&S[h][w]<='9') res+=S[h][w];\n    else return \"\";\n    \n    string A=DFS(h+1,w),B=DFS(h,w+1);\n    \n    if(A.size()>B.size()) swap(A,B);\n    \n    if(A.size()==B.size()) return dp[h][w]=res+max(A,B);\n    else return dp[h][w]=res+B;\n}\n\nint main(){\n    \n    std::ifstream in(\"text.txt\");\n    std::cin.rdbuf(in.rdbuf());\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    \n    while(1){\n        cin>>W>>H;\n        if(H+W==0) break;\n        \n        for(int i=0;i<H;i++) S.clear();\n        for(int i=0;i<H;i++){\n            for(int j=0;j<W;j++){\n                dp[i][j]=\"\";\n            }\n            cin>>S[i];\n        }\n        string ans=\"\";\n        \n        for(int i=0;i<H;i++){\n            for(int j=0;j<W;j++){\n                string res=DFS(i,j);\n                while(res.size()>=1&&res[0]=='0') res=res.substr(1);\n                if(ans.size()==res.size()) ans=max(ans,res);\n                else if(ans.size()<res.size()) ans=res;\n            }\n        }\n        \n        cout<<ans<<endl;\n    }\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\nint w, h;\nint gc;\nstring s[51], dp[51][51];\nbool is_num(char c){return '0'<=c && c<= '9';}\n\nstring str_max(const string& s1, const string& s2) {\n  if (s1.size() == s2.size()) {\n    return (s1 > s2) ? s1 : s2 ;\n  }\n  return (s1.size() > s2.size())? s1 : s2 ;\n}\n\nstring dfs(int i, int j) {\n  string res = \"\";\n  \n  if (!is_num(s[i][j])) return res;\n  if (i >= h || j >= w) return res;\n  // DP\n  if (dp[i][j] != \"\") return dp[i][j];\n  \n  //gc++;\n\n  \n  res = s[i][j] + str_max(dfs(i, j+1), dfs(i+1, j));\n  \n  // ªÉ0ªÂ¢Ä¢éêÍæé\n  if (i == 0 && j == 0) {\n    if (res[0] == '0') res.erase(0, 1);\n  } else if (i == 0) {\n    if (!is_num(s[i][j-1]) && res[0] == '0') res.erase(0, 1);\n  } else if (j == 0) {\n    if (!is_num(s[i-1][j]) && res[0] == '0') res.erase(0, 1);\n  } else{\n    if (!is_num(s[i-1][j]) && !is_num(s[i][j-1])) res.erase(0, 1);\n  }\n  \n  return dp[i][j] = res;\n}\n\nvoid solve() {\n  for(int i=0;i<h;i++) cin>>s[i];\n  // init\n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  dp[i][j] = \"\";\n  \n  // search\n  string largest = \"\";\n  //gc = 0;\n  \n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  if (dp[i][j] == \"\" && is_num(s[i][j]))\n  largest = str_max(dfs(i, j), largest);\n  \n  /*\n  for(int i=0;i<h;i++) {\n    for(int j=0;j<w;j++) cout<<\"[\"<<dp[i][j]<<\"]\";\n    cout<<endl;\n  }*/\n  \n  //cout<<gc<<endl;\n  cout<<largest<<endl;\n}\n\nint main (int argc, char const* argv[]) {\n  while (cin>>w>>h, w||h) {\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <limits.h>\n#include <math.h>\n#include <bitset>\n#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <iomanip>\n#include <iostream>\n\n#define VARIABLE(x) cerr << #x << \"=\" << x << endl\n#define BINARY(x) static_cast<bitset<16> >(x);\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define REP(i,m,n) for (int i=m;i<(int)(n);i++)\n#define if_range(x, y, w, h) if (0<=(int)(x) && (int)(x)<(int)(w) && 0<=(int)(y) && (int)(y)<(int)(h))\n\nconst int INF = 100000000;\ntypedef double D;\nconst double EPS = 1e-8;\nconst double PI = 3.14159;\nint dx[4]={-1, 0, 1, 0}, dy[4]={0, -1, 0, 1};\nusing namespace std;\ntypedef pair<int, int> P;\n\n/** Problem1126 : The Secret Number **/\nconst int MAX_W = 70;\nint W, H;\nchar field[MAX_W][MAX_W];\nstring dp[MAX_W][MAX_W];\n\nstring big(string s1, string s2) {\n\tif (s1.length() > s2.length()) {\n\t\treturn s1;\n\t} else if (s2.length() > s1.length()) {\n\t\treturn s2;\n\t} else {\n\t\treturn (s1>s2?s1:s2);\n\t}\n}\n\nstring big2(string s1, string s2) {\n\twhile (s1[0]=='0') s1.erase(s1.begin());\n\twhile (s2[0]=='0') s2.erase(s2.begin());\n\treturn big(s1, s2);\n}\n\nstring rec(int x, int y)\n{\n\tif (!('0' <= field[y][x] && field[y][x] <= '9'))\n\t\treturn dp[y][x] = \"\";\n\t\n\tstring s1 = dp[y][x+1];\n\tstring s2 = dp[y+1][x];\n\t\n\treturn dp[y][x] = field[y][x] + big(s1, s2);\n}\n\nint main()\n{\n\twhile (cin>>W>>H, W||H) {\n\t\tfill(dp[0], dp[0]+W*H, \"\");\n\t\t\n\t\trep(i, H) {\n\t\t\trep(j, W) {\n\t\t\t\tcin>>field[i][j];\n\t\t\t}\n\t\t}\n\t\t\n\t\tstring ans = \"\";\n\t\trep(y, H) {\n\t\t\trep(x, W) {\n\t\t\t\tans = big2(ans, rec(W-x-1, H-y-1));\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\tcout << (ans!=\"\"?ans:\"0\") << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cctype>\n\nusing namespace std;\n\nint main(void){\n  int w,h;\n  string grid[71],dp[71][71];\n\n  while(cin >> w >> h,w|h){\n    for(int i=0;i<71;i++)\n      for(int j=0;j<71;j++)dp[i][j].clear();\n\n    for(int i=0;i<h;i++)cin >> grid[i];\n\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(!isupper(grid[i][j])){\n\t  dp[i][j]=grid[i][j];\n\t  string a=\"\",b=\"\";\n\t  if(i>0 && !dp[i-1][j].empty())a=dp[i-1][j]+grid[i][j];\n\t  if(j>0 && !dp[i][j-1].empty())b=dp[i][j-1]+grid[i][j];\n\t  \n\t  if(a.empty() && !b.empty()){\n\t    dp[i][j]=b;\n\t    continue;\n\t  }\n\n\t  if(!a.empty() && b.empty()){\n\t    dp[i][j]=a;\n\t    continue;\n\t  }\n\n\t  if(a.empty() && b.empty())continue;\n\n\t  if(a[0]=='0'){\n\t    int k=0;\n\t    for(;k<a.size()&&a[k]=='0';k++);\n\t    a=a.substr(k);\n\t  }\n\n\t  if(b[0]=='0'){\n\t    int k=0;\n\t    for(;k<b.size()&&b[k]=='0';k++);\n\t    b=b.substr(k);\n\t  }\n\n\t  if(a.size()>b.size())dp[i][j]=a;\n\t  if(a.size()<b.size())dp[i][j]=b;\n\t  else if(a>b)dp[i][j]=a;\n\t  else dp[i][j]=b;\n\n\t  if(dp[i][j][0]=='0'){\n\t    int k=0;\n\t    for(;k<dp[i][j].size()&&dp[i][j][k]=='0';k++);\n\t    dp[i][j]=dp[i][j].substr(k);\n\t  }\n\t}\n      }\n    }\n\n    string s=\"\";\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(s.size()<dp[i][j].size())s=dp[i][j];\n\telse if(s.size()>dp[i][j].size())s=s;\n\telse if(s<dp[i][j])s=dp[i][j];\n      }\n    }\n    cout << s << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n//http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#include<iostream>\n#include<map>\n#include<vector>\n#include<algorithm>\n#include<cmath>\n#include<climits>\n#include<ctime>\n#include<cstring>\n#include<numeric>\n\n#define ALL(v) (v).begin(),(v).end()\n#define REP(i,p,n) for(int i=p;i<(int)(n);++i)\n#define rep(i,n) REP(i,0,n)\n#define dump(a) (cerr << #a << \"=\" << (a) << endl)\n#define DUMP(list) cout << \"{ \"; for(auto nth : list){ cout << nth << \" \"; } cout << \"}\" << endl;\n\nusing namespace std;\n\nint W,H;\nint dw[2] = {0, 1};\nint dh[2] = {1, 0};\nvector< vector<char> > matrix;\nvector< vector<string> > dp;\n\nstring max(string str1, string str2)\n{\t\n\tif(str1.length() == str2.length())\n\t{\n\t\trep(i,str1.size())\n\t\t{\n\t\t\tif(str1[i] != str2[i]){\n\t\t\t\treturn str1[i] > str2[i] ? str1 : str2;\n\t\t\t}\n\t\t}\n\t\treturn str1;\n\t}\n\telse{\n\t\treturn str1.length() > str2.length() ? str1 : str2;\n\t}\n}\n\nstring dfs(int w, int h)\n{\n\tif(dp[h][w] != \"#\"){ return dp[h][w]; }\n\n\tstring res=\"\";\n\trep(i,2)\n\t{\n\t\tint nw = w+dw[i];\n\t\tint nh = h+dh[i];\n\t\tif(nw < 0 || nw >= W || nh < 0 || nh >= H){ continue; }\n\t\tif(!isdigit(matrix[nh][nw])){ continue; }\n\t\tres = max(res, dfs(nw,nh));\n\t}\n\n\tdp[h][w] = matrix[h][w] + res;\n\treturn dp[h][w];\n}\n\nint main()\n{\n\twhile(cin >> W >> H && W)\n\t{\n\t\tmatrix.clear();\n\t\tmatrix.resize( H, vector<char>(W) );\n\n\t\trep(h,H){\n\t\t\trep(w,W){\n\t\t\t\tcin >> matrix[h][w];\n\t\t\t}\n\t\t}\n\n\t\tdp.clear();\n\t\tdp.resize(H, vector<string>(W,\"#\"));\n\n\t\tstring ans;\n\t\trep(h,H){\n\t\t\trep(w,W){\n\t\t\t\tif(isdigit(matrix[h][w]) && matrix[h][w] != '0'){\n\t\t\t\t\tans = max(ans,dfs(w,h));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double ld;\ntypedef pair<ll, ll> P;\n\n#define EACH(i,a) for (auto& i : a)\n#define FOR(i,a,b) for (ll i=(a);i<(b);i++)\n#define RFOR(i,a,b) for (ll i=(b)-1;i>=(a);i--)\n#define REP(i,n) for (ll i=0;i<(n);i++)\n#define RREP(i,n) for (ll i=(n)-1;i>=0;i--)\n#define debug(x) cout<<#x<<\": \"<<x<<endl\n#define pb push_back\n#define ALL(a) (a).begin(),(a).end()\n\nconst ll linf = 1e18;\nconst int inf = 1e9;\nconst double eps = 1e-12;\nconst double pi = acos(-1);\n\ntemplate<typename T>\nistream& operator>>(istream& is, vector<T>& vec) {\n\tEACH(x,vec) is >> x;\n\treturn is;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, vector<T>& vec) {\n\tREP(i,vec.size()) {\n\t\tif (i) os << \" \";\n\t\tos << vec[i];\n\t}\n\treturn os;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, vector< vector<T> >& vec) {\n\tREP(i,vec.size()) {\n\t\tif (i) os << endl;\n\t\tos << vec[i];\n\t}\n\treturn os;\n}\n\nint dx[2] = {1, 0};\nint dy[2] = {0, 1};\n\nint W, H;\nvector<string> m;\nbool m1[100][100] = {0};\nstring m2[100][100];\nstring beautify(string s) {\n\tif (s.size() == 0) return \"\";\n\tint l = (int)s.size()-1;\n\tREP(i,s.size()) {\n\t\tif (s[i] != '0') {\n\t\t\tl = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn s.substr(l, s.size()-l);\n}\nbool gt(string s1, string s2) {\n\ts1 = beautify(s1);\n\ts2 = beautify(s2);\n\tif (s1.size() == s2.size()) {\n\t\treturn s1 > s2;\n\t}\n\treturn s1.size() > s2.size();\n}\nstring dp(int x, int y) {\n\tstring res = \"\";\n\tif (x < 0 || x >= W || y < 0 || y >= H) return \"\";\n\tif ( !isdigit(m[y][x]) ) return \"\";\n\tif (m1[y][x]) return m2[y][x];\n\tREP(i, 2) {\n\t\tint nx = x + dx[i];\n\t\tint ny = y + dy[i];\n\t\tstring a = \"\"; a += m[y][x];\n\t\ta += dp(nx, ny);\n\t\tif ( gt(a, res) ) res = a;\n\t}\n\treturn m1[y][x] = true, m2[y][x] = res;\n}\n\n\nint main() {\n\tstd::ios::sync_with_stdio(false);\n\tstd::cin.tie(0);\n\twhile (cin >> W >> H, W || H) {\n\t\tm.resize(H); cin >> m;\n\t\tfill(m1[0], m1[100], false);\n\t\tstring ans = \"\";\n\t\tREP(y, H) REP(x, W) {\n\t\t\tif ( gt( dp(x, y), ans ) ) ans = beautify( dp(x, y) );\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <string>\n#include <vector>\n\nusing namespace std;\n\ntypedef vector<string> VS;\ntypedef vector<VS> VVS;\n\nvoid remove_leading_zeros ( string& str )\n{\n\twhile ( str[0] == '0' ) { str = str.substr( 1 ); }\n}\n\nbool str_comp( const string& a, const string& b )\n{\n\tif ( a.size() != b.size() ) {;\n\t\treturn a.size() < b.size();\n\t}\n\treturn a < b;\n}\n\nint main ( void )\n{\n\tint w, h;\n\twhile ( cin >> w >> h, w | h ) {\n\t\tVS mat( h );\n\t\tfor ( int i = 0; i < h; ++i ) {\n\t\t\tcin >> mat[i];\n\t\t}\n\n\t\tVVS d( h, VS( w, \"\" ) );\n\n\t\tstring ans = \"\";\n\t\tif ( isdigit( mat[0][0] ) ) {\n\t\t\td[0][0] = string( 1, mat[0][0] );\n\t\t}\n\t\tfor ( int y = 0; y < h; ++y ) {\n\t\t\tfor ( int x = 0; x < w; ++x ) {\n\t\t\t\tif ( !isdigit( mat[y][x] ) ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif ( y ) {\n\t\t\t\t\td[y][x] = max( d[y][x], d[y - 1][x] + mat[y][x], str_comp );\n\t\t\t\t\tremove_leading_zeros( d[y][x] );\n\t\t\t\t}\n\t\t\t\tif ( x ) {\n\t\t\t\t\td[y][x] = max( d[y][x], d[y][x - 1] + mat[y][x], str_comp );\n\t\t\t\t\tremove_leading_zeros( d[y][x] );\n\t\t\t\t}\n\t\t\t\t//cout << x << \", \" << y << \" = \" << d[y][x] << endl;\n\t\t\t\tans = max( ans, d[y][x], str_comp );\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\nint main(){\nstd::vector<int> a(1000000000);\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#define F first\n#define S second\nusing namespace std;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() == 0 && b.size() == 0)\n    return true;\n  else if(a.size() == 0)\n    return true;\n  else if(b.size() == 0)\n    return false;\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] < b[i];\n  return false;\n}\n\nint main()\n{\n\n  int w,h;\n  while(cin >> w >> h,(w || h))\n    {\n      char G[h][w];\n      string ans=\"0\";\n      string dp[h][w];\n\n      for(int i=0;i<h;i++)\n\t{\n\tfor(int j=0;j<w;j++)\n\t  {\n\t    cin >> G[i][j];\n\t    if('0' <= G[i][j] && G[i][j] <= '9')\n\t      {\n\t\tdp[i][j] = G[i][j];\n\t\tans = max(ans,dp[i][j],cmp);\n\t      }\n\t\n\t  }\n\t}\n     \n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\n\t      if(!('0' <= G[i][j] && G[i][j] <= '9'))\n\t\tcontinue;\n\t      if(!('0' <= G[i-1][j] && G[i-1][j] <= '9') && !('0' <= G[i][j-1] && G[i][j-1] <= '9'))\n\t\tcontinue;\n\t      \n\t      dp[i][j] = max(dp[i][j],max((i-1>=0?dp[i-1][j]:\"\")+dp[i][j],\n\t\t\t\t\t  (j-1>=0?dp[i][j-1]:\"\")+dp[i][j],cmp),cmp);\t      \n\t      ans = max(ans,dp[i][j],cmp);\n\n\t    }\n\t}\n\n\n      bool f = false;\n      int cnt = 0;\n      for(int i=0;i<ans.size();i++)      \n\tif(ans[i] == '0' && !f)\n\t  continue;\n\telse  \n\t  {\n\t    cnt++;\n\t    f = true;\n\t    cout << ans[i];\n\t  }\n      if(cnt == 0)\n\tcout << \"0\";\n\tcout << endl;\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\nusing ll=long long;\nusing vi=vector<int>;\nusing vl=vector<long long>;\nusing pii=pair<int,int>;\nusing pll=pair<long long,long long>;\n#define ITR(i,c) for(auto i=begin(c);i!=end(c);++i)\n#define FORE(x,c) for(auto &x:c)\n#define REPF(i,a,n) for(int i=a,i##len=(int)(n);i<i##len;++i)\n#define REP(i,n) REPF(i,0,n)\n#define REPR(i,n) for(int i=(int)(n);i>=0;--i)\n#define REPW(i,n) for(i=0;i<(int)(n);++i)\n#define ALL(c) begin(c),end(c)\n#define RALL(c) rbegin(c),rend(c)   // c++14\n#define SZ(c) ((int)c.size())\n#define EXIST(c,x) (c.find(x)!=end(c))\n#define OUTOFRANGE(y,x,h,w) (y<0||x<0||y>=h||x>=w)\n#define dump(...)\nconst int DX[9]={0,1,0,-1,1,1,-1,-1,0},DY[9]={-1,0,1,0,-1,1,1,-1,0};\n#define INF (1001001001)\n#define INFLL (1001001001001001001ll)\ntemplate<class T> ostream& operator << (ostream &os,const vector<T> &v) {\n    ITR(i,v) os << *i << (i==end(v)-1 ? \"\" : \" \"); return os; }\ntemplate<class T> istream& operator >> (istream &is,vector<T> &v) {\n    ITR(i,v) is >> * i; return is; }\ntemplate<class T> istream& operator >> (istream &is, pair<T,T> &p) {\n        is >> p.first >> p.second; return is; }\ntemplate<class T>bool chmax(T &a,const T &b){if(a<b){a=b;return 1;}return 0;}\ntemplate<class T>bool chmin(T &a,const T &b){if(b<a){a=b;return 1;}return 0;}\n//------------------------------------------------------------------------------\nstruct before_main_function {\n    before_main_function() {\n        #ifdef int\n            #undef INF\n            #define INF INFLL\n            #define stoi stoll\n        #endif\n        cin.tie(0);ios::sync_with_stdio(false);\n        cout<<setprecision(15)<<fixed;\n    }\n} before_main_function;\n//------------------------------------------------------------------------------\n\nvoid chmax_str(string &a,string &b) {\n    if(SZ(a)<SZ(b)) a=b;\n    else if(SZ(a)==SZ(b)) chmax(a,b);\n}\nsigned main() {\n    while(1){\n        int W,H;\n        cin>>W>>H;\n        if(W+H==0) break;\n        \n        vector<string> s(H);\n        cin>>s;\n        vector<vector<string>> dp(H,vector<string>(W,\"\"));\n\n        string ans=\"\";\n        REP(i,H) {\n            REP(j,W) {\n                if('0'<=s[i][j] and s[i][j]<='9') {\n                    string t=\"\";\n                    if(i>0) {\n                        chmax_str(t,dp[i-1][j]);\n                    }\n                    if(j>0) {\n                        chmax_str(t,dp[i][j-1]);\n                    }\n                    if(t==\"\" && s[i][j]=='0') {\n                        dp[i][j]=\"\";\n                    }\n                    else {\n                        dp[i][j]=t+s[i][j];\n                        chmax_str(ans,dp[i][j]);\n                    }\n                }\n            }\n        }\n        cout<<ans<<endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nint w, h;\n\nbool isNum(char c){return '0' <= c && c <= '9';}\n\nvoid solve() {\n  vector<string> mat(h);\n  for(int i=0;i<h;i++) cin>>mat[i];\n  \n  vector<vector<string> > dp(h, vector<string>(w,\"\"));\n  if (isNum(mat[0][0])) dp[0][0] = mat[0][0];\n  \n  for (int i = 1; i < w; i += 1) {\n    if (isNum(mat[0][i])) {\n      dp[0][i] = dp[0][i-1] + mat[0][i];\n    }\n  }\n  for (int i = 1; i < h; i += 1) {\n    if (isNum(mat[i][0])) {\n      dp[i][0] = dp[i-1][0] + mat[i][0];\n    }\n  }\n  \n  for (int i = 1; i < h; i += 1) {\n    for (int j = 1; j < w; j += 1) {\n      if (isNum(mat[i][j])) {\n        if (dp[i-1][j].size() != dp[i][j-1].size()) {\n          if (dp[i-1][j].size() > dp[i][j-1].size()) {\n            dp[i][j] = dp[i-1][j];\n          } else {\n            dp[i][j] = dp[i][j-1];\n          }\n        } else {\n          dp[i][j] = max(dp[i-1][j], dp[i][j-1]);\n        }\n        dp[i][j] += mat[i][j];\n      }\n    }\n  }\n  \n  string max_s = \"\";\n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  if (max_s.size() < dp[i][j].size()) {\n    max_s = dp[i][j];\n  } else if (max_s.size() == dp[i][j].size()) {\n    max_s = max(max_s, dp[i][j]);\n  }\n  \n  for(;;) {\n    if (max_s[0]!='0') break;\n    max_s.erase(0, 1);\n  }\n  \n  cout<<max_s<<endl;\n}\n\nint main (int argc, char const* argv[]) {\n  while (cin>>w>>h, w||h) {\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cctype>\n#include<sstream>\nusing namespace std;\n\nint compare(string s1,string s2){\n  int start1,start2;\n  start1=start2=0;\n  for(int i=0;i<s1.size();i++){\n    if(s1[i]!='0')break;\n    start1++;\n  }\n  for(int i=0;i<s1.size();i++){\n    if(s2[i]!='0')break;\n    start2++;\n  }\n  s1=s1.substr(start1);\n  s2=s2.substr(start2);\n\n  if(s1.size()>s2.size())return 1;\n  if(s1.size()<s2.size())return -1;\n  for(int i=0;i<s1.size();i++){\n    if(s1[i]>s2[i])return 1;\n    if(s1[i]<s2[i])return -1;\n  }\n  return 0;\n}\n\nint main()\n{\n  int W,H;\n  char C[70][70];\n  string max,dp[70][70];\n  while(cin>>W>>H,W|H){\n    max=\"\";\n    for(int i=0;i<H;i++)for(int j=0;j<W;j++){\n      cin>>C[i][j];\n      dp[i][j]=\"\";\n    }\n    if(isdigit(C[0][0]))dp[0][0]=C[0][0];\n    for(int j=1;j<W;j++){\n      if(isalpha(C[0][j]))continue;\n      dp[0][j]+=dp[0][j-1]+C[0][j];\n    }\n    for(int i=1;i<H;i++){\n      if(isalpha(C[i][0]))continue;\n      dp[i][0]+=dp[i-1][0]+C[i][0];\n    }\n    for(int i=1;i<H;i++){\n      for(int j=1;j<W;j++){\n\tif(isalpha(C[i][j]))continue;\n\tif( compare(dp[i-1][j]+C[i][j], dp[i][j-1]+C[i][j]) >= 0 ){\n\t  dp[i][j]=dp[i-1][j]+C[i][j];\n\t}else{\n\t  dp[i][j]=dp[i][j-1]+C[i][j];\n\t}\n\tif( compare(dp[i][j], max) >= 0 ){\n\t  max=dp[i][j-1]+C[i][j];\n\t}\n      }\n    }\n    int start=0;\n    for(int i=0;i<max.size();i++){\n      if(max[i]!='0')break;\n      start++;\n    }\n    max=max.substr(start);\n    cout<<max<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<deque>\n#include<list>\n#include<map>\n#include<queue>\n#include<set>\n#include<stack>\n#include<vector>\n#include<algorithm>\n#include<string>\n#include<iostream>\n#include<sstream>\n#include<cmath>\n#include<cstring>\nusing namespace std;\nchar a[90][90];\nint b[90][90];\nstring c[90][90];\nstring mx;\nint ln;\nvoid fn(int o,int p,int q,string s){\n  if(b[p][q]<o||(b[p][q]==o&&c[p][q]<s)){\n    b[p][q]=o;\n    c[p][q]=s;\n    if(0){\n    }else if('0'<=a[p][q+1]&&a[p][q+1]<='9'&&'0'<=a[p+1][q]&&a[p+1][q]<='9'){\n      fn(o+1,p,q+1,s+a[p][q+1]);\n      fn(o+1,p+1,q,s+a[p+1][q]);\n    }else if('0'<=a[p][q+1]&&a[p][q+1]<='9'){\n      fn(o+1,p,q+1,s+a[p][q+1]);\n    }else if('0'<=a[p+1][q]&&a[p+1][q]<='9'){\n      fn(o+1,p+1,q,s+a[p+1][q]);\n    }else{\n      if(0){\n      }else if(ln<o){\n\tmx=s;\n\tln=o;\n      }else if(ln>o){\n      }else{\n\tmx=max(mx,s);\n      }\n    }\n  }\n  return;\n}\nint main(){\n  int i,j;\n  int w,h;\n  while(cin>>w>>h,w||h){\n    memset(a,0,sizeof(a));\n    for(i=1;i<=h;++i)\n      for(j=1;j<=w;++j)\n\tcin>>a[i][j];\n    memset(b,0,sizeof(b));\n    mx=\"0\";\n    ln=1;\n    for(i=1;i<=h;++i){\n      for(j=1;j<=w;++j){\n\tif('1'<=a[i][j]&&a[i][j]<='9')\n\t  fn(1,i,j,string(1,a[i][j]));\n      }\n    }\n    cout<<mx<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\n\nvector<string> field(80);\n\nint n, m;\n\nbool isIn(int x, int y){\n    return 0 <= x && x < m && 0 <= y && y < n;\n}\n\nstring nmax(string a, string b){\n    if(a.size() != b.size()) return a.size() < b.size() ? b : a;\n    else return a < b ? b : a;\n}\n\nstring search(int x, int y, string num){\n    if (!isIn(x, y)) return num;\n    if('0' <= field[x][y] && field[x][y] <= '9'){\n        if(!(num.size() == 0 && field[x][y] == '0')) num += field[x].substr(y, 1);\n        num = nmax(search(x+1, y, num), search(x, y+1, num));\n        return num;\n    }\n    else return num;\n}\n\nint main(){\n    while(cin >> n >> m, n+m){\n        for(int i=0; i < m; i++) cin >> field[i];\n        string ret;\n\n        for(int i=0; i< m; i++){\n            for(int j=0; j < n; j++) ret = nmax(ret, search(i, j, \"\"));\n        }\n\n        cout << ret << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <map>\n#include <queue>\nusing namespace std;\ntypedef long long int ll;\n\nchar f[100][100];\nstring dp[100][100];\nint dx[]={1,0};\nint dy[]={0,1};\n\nbool comp(string s,string t){ // ?s>t\n    if(s.size()>t.size())return true;\n    if(s.size()<t.size())return false;\n    for(int i=0;i<s.size();i++){\n        if(s[i]>t[i])return true;\n        if(s[i]<t[i])return false;\n    }\n    return false;\n}\n\nint main(){\n\tcin.tie(nullptr);\n\tios::sync_with_stdio(false);\n    int h,w;\n    while(cin >> w >> h,h&&w){\n        for(int i=0;i<h;i++){\n            for(int j=0;j<w;j++){\n                cin >> f[i][j];\n                dp[i][j]=\"\";\n            }\n        }\n        queue<pair<pair<int,int>,string>> q;\n        string res=\"\";\n        for(int i=0;i<h;i++){\n            for(int j=0;j<w;j++){\n                if('1'<=f[i][j]&&f[i][j]<='9'&&dp[i][j]==\"\"){\n                    dp[i][j]+=f[i][j];\n                    q.push(make_pair(make_pair(i,j),dp[i][j]));\n                    while(q.size()){\n                        auto p=q.front(); q.pop();\n                        //cout << p.first.first << \" \" << p.first.second << \" \" << p.second << endl;\n                        if(!comp(p.second,dp[p.first.first][p.first.second])&&p.second!=dp[p.first.first][p.first.second])continue;\n                        for(int k=0;k<2;k++){\n                            int nx=p.first.first+dx[k],ny=p.first.second+dy[k];\n                            if(0<=nx&&nx<h&&0<=ny&&ny<w){\n                                string r=dp[p.first.first][p.first.second];\n                                if('0'<=f[nx][ny]&&f[nx][ny]<='9'){\n                                    r+=f[nx][ny];\n                                    if(comp(r,dp[nx][ny])){\n                                        dp[nx][ny]=r;\n                                        q.push(make_pair(make_pair(nx,ny),r));\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n                if(comp(dp[i][j],res)){\n                    res=dp[i][j];\n                }\n            }\n        }\n        cout << res << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<cctype>\n#include<string>\n#include<iostream>\n\nusing namespace std;\n\nint main(){\n\tfor(int w,h;scanf(\"%d%d\",&w,&h),w;){\n\t\tchar mat[71][72];\n\t\tw++,h++;\n\t\tfor(int i=0;i<h;i++)\tmat[i][0]='X';\n\t\tfor(int j=0;j<w;j++)\tmat[0][j]='X';\n\t\tfor(int i=1;i<h;i++)\tcin>>&mat[i][1];\n\n\t\tstring memo[71][71];\n\t\tfor(int i=1;i<h;i++)for(int j=1;j<w;j++){\n\t\t\tif(!isdigit(mat[i][j]))\tcontinue;\n\n\t\t\tint len1=memo[i-1][j].length(),len2=memo[i][j-1].length();\n\t\t\tif(len1>0 && len2>0){\n\t\t\t\tif     (len1>len2)\tmemo[i][j]=memo[i-1][j];\n\t\t\t\telse if(len2>len1)\tmemo[i][j]=memo[i][j-1];\n\t\t\t\telse\tmemo[i][j]=max(memo[i-1][j],memo[i][j-1]);\n\t\t\t}\n\t\t\telse if(len1>0)\tmemo[i][j]=memo[i-1][j];\n\t\t\telse if(len2>0)\tmemo[i][j]=memo[i][j-1];\n\t\t\telse{\n\t\t\t\tif(mat[i][j]=='0')\tcontinue;\n\t\t\t}\n\t\t\tmemo[i][j]+=mat[i][j];\n\t\t}\n\n\t\tstring ans;\n\t\tint lmax=0;\n\t\tfor(int i=1;i<h;i++)for(int j=1;j<w;j++){\n\t\t\tint len=memo[i][j].length();\n\t\t\tif(lmax<len || (len==lmax && ans<memo[i][j])){\n\t\t\t\tans=memo[i][j];\n\t\t\t\tlmax=len;\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nchar matrix[77][77];\nstring dp[77][77];\n\nbool is_num(char c) {\n    return c >= '0' && c <= '9';\n}\n\nvoid chmax(string& s1, string s2) {\n    if (s1.size() > s2.size()) return;\n    else if (s1.size() < s2.size()) s1 = s2;\n    else {\n        for (int i = 0; i < s1.size(); i++) {\n            if (s1[i] > s2[i]) return;\n            else if (s1[i] < s2[i]) {\n                s1 = s2;\n                return;\n            }\n        }\n    }\n}\n\nvoid solve(int w, int h) {\n    for (int i = 1; i <= h; i++) {\n        for (int j = 1; j <= w; j++) cin >> matrix[i][j];\n    }\n    for (int i = 0; i <= h; i++) {\n        for (int j = 0; j <= w; j++) {\n            dp[i][j] = \"0\";\n        }\n    }\n    for (int i = 1; i <= h; i++) {\n        for (int j = 1; j <= w; j++) {\n            if (!is_num(matrix[i][j])) continue;\n            string s1 = dp[i - 1][j] + matrix[i][j];\n            string s2 = dp[i][j - 1] + matrix[i][j];\n            chmax(dp[i][j], s1);\n            chmax(dp[i][j], s2);\n        }\n    }\n    string ans = \"0\";\n    for (int i = 1; i <= h; i++) {\n        for (int j = 1; j <= w; j++) {\n            if (dp[i][j] == \"\") continue;\n            for (int k = 0; k < dp[i][j].size(); k++) {\n                if (dp[i][j][k] == '0') continue;\n                string now = dp[i][j].substr(k, dp[i][j].size() - k);\n                chmax(ans, now);\n            }\n        }\n    }\n    cout << ans << endl;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    int W, H;\n    while (true) {\n        cin >> W >> H;\n        if (W == 0 && H == 0) break;\n        solve(W, H);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cctype>\nusing namespace std;\n\nint main(void){\n    int W,H;\n    string dp[2][70];\n    string line,ans;\n    while(cin >> W >> H, W){\n        for(int i=0;i<70;i++){\n            dp[0][i].clear();dp[1][i].clear();\n        }\n        ans.clear();\n        for(int i=0;i<H;i++){\n            cin >> line;\n            for(int j=0;j<W;j++){\n                if(isdigit(line[j])){\n                    if(line[j]=='0'){\n                        dp[i&1][j].clear();\n                        if(!dp[(i&1)^1][j].empty()) dp[i&1][j]=dp[(i&1)^1][j]+line[j];\n                        if(!dp[i&1][j-1].empty()){\n                            dp[i&1][j]=max(dp[i&1][j],dp[i&1][j-1]+line[j],[](const string& a, const string& b){return a.size()==b.size()? a < b : a.size() < b.size();});\n                        }\n                    }else{\n                        dp[i&1][j]=dp[(i&1)^1][j]+line[j];\n                        if(j!=0) dp[i&1][j]=max(dp[i&1][j],dp[i&1][j-1]+line[j],[](const string& a, const string& b){return a.size()==b.size()? a < b : a.size() < b.size();});\n                        ans=max(dp[i&1][j],ans,[](const string& a, const string& b){return a.size()==b.size()? a < b : a.size() < b.size();});\n                    }\n                    //cout << dp[i&1][j] << endl;\n                }else{\n                    //cout << line[j] << \"clear\\n\";\n                    dp[i&1][j].clear();\n                }\n            }\n        }\n        cout << \"\" << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <cstring>\n#include <cctype>\n\nusing namespace std;\ntypedef long long ll;\n\nchar field[71][71];\nstring dp[71][71];\n\nbool str_less(const string &a, const string &b){\n\tif(a.size() < b.size()){ return true; }\n\tif(a.size() > b.size()){ return false; }\n\treturn a < b;\n}\n\nint main(){\n\twhile(true){\n\t\tint W, H;\n\t\tcin >> W >> H;\n\t\tif(W == 0 && H == 0){ break; }\n\t\tmemset(field, 0, sizeof(field));\n\t\tfor(int i = 0; i < H; ++i){ cin >> field[i]; }\n\t\tfor(int i = 0; i <= H; ++i){\n\t\t\tfor(int j = 0; j <= W; ++j){ dp[i][j] = \"\"; }\n\t\t}\n\t\tstring answer = \"\";\n\t\tfor(int i = H - 1; i >= 0; --i){\n\t\t\tfor(int j = W - 1; j >= 0; --j){\n\t\t\t\tif(isdigit(field[i][j])){\n\t\t\t\t\tif(str_less(dp[i + 1][j], dp[i][j + 1])){\n\t\t\t\t\t\tdp[i][j] = field[i][j] + dp[i][j + 1];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tdp[i][j] = field[i][j] + dp[i + 1][j];\n\t\t\t\t\t}\n\t\t\t\t\tstring value = \"\";\n\t\t\t\t\tfor(int k = 0; k < dp[i][j].size(); ++k){\n\t\t\t\t\t\tif(dp[i][j][k] != '0'){\n\t\t\t\t\t\t\tvalue = string(dp[i][j].c_str() + k);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(str_less(answer, value)){ answer = value; }\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << answer << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstring>\nusing namespace std;\n\nbool isNumber( char c )\n{\n    return c >= '0' && c <= '9';\n}\n\nint main( void )\n{\n    string dp[71][71];\n    int W, H;\n\n    while ( true )\n    {\n        cin >> W >> H;\n        if ( W == 0 && H == 0 ) break;\n\n        string C[70];\n        for ( int i = 0; i < H; i++ )\n        {\n            cin >> C[i];\n        }\n\n        for ( int i = 0; i < H; i++ ) for ( int j = 0; j < W; j++ ) dp[i][j] = \"\";\n\n        for ( int i = 0; i < H; i++ )\n        {\n            for ( int j = 0; j < W; j++ )\n            {\n                if ( isNumber( C[i][j] ) == false )\n                {\n                    dp[i][j] = \"\";\n                    continue;\n                }\n                if ( i == 0 && j == 0 )\n                {\n                    dp[i][j] = C[i][j];\n                }\n                else if ( i == 0 )\n                {\n                    dp[i][j] = dp[i][j-1] + C[i][j];\n                }\n                else if ( j == 0 )\n                {\n                    dp[i][j] = dp[i-1][j] + C[i][j];\n                }\n                else\n                {\n                    if ( dp[i-1][j].size() > dp[i][j-1].size() )\n                    {\n                        dp[i][j] = dp[i-1][j] + C[i][j];\n                    }\n                    else if ( dp[i-1][j].size() < dp[i][j-1].size() )\n                    {\n                        dp[i][j] = dp[i][j-1] + C[i][j];\n                    }\n                    else if ( dp[i-1][j] > dp[i][j-1] )\n                    {\n                        dp[i][j] = dp[i-1][j] + C[i][j];\n                    }\n                    else\n                    {\n                        dp[i][j] = dp[i][j-1] + C[i][j];\n                    }\n                }\n            }\n        }\n\n        string answer = \"\";\n        for ( int i = 0; i < H; i++ )\n        {\n            for ( int j = 0; j < W; j++ )\n            {\n                while ( dp[i][j][0] == '0' ) dp[i][j] = dp[i][j].substr( 1 );\n\n                if ( dp[i][j].size() > answer.size() )\n                {\n                    answer = dp[i][j];\n                }\n                else if ( dp[i][j].size() == answer.size() && dp[i][j] > answer )\n                {\n                    answer = dp[i][j];\n                }\n            }\n        }\n\n        cout << answer << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n#include<cstdio>\n#include<sstream>\n#include<algorithm>\n#include<cmath>\n#include<map>\n#include<functional>\n#include<queue>\n#include<stack>\n#include<set>\nusing namespace std;\n char ta[100][100];\n \n string dp[100][100];\n bool ok(char n){\n \tfor(int i=0;i<10;i++)if(i+'0'==n)return 1;\n \treturn 0;\n }\n string maa(string a,string b){\n \twhile(a[0]=='0')a.erase(a.begin());\n \twhile(b[0]=='0')b.erase(b.begin());\n \tif(a.size()>b.size())return a;\n \tif(a.size()<b.size())return b;\n \tfor(int i=0;i<a.size();i++){\n \t\tif(a[i]-'0'>b[i]-'0')return a;\n \t\telse if(a[i]-'0'<b[i]-'0')return b;\n \t}\n \treturn a;\n }\n \nint main(){\n\tint h,w;\n\tstring a,b;\n\t//cin>>a>>b;cout<<maa(a,b);\n\twhile(cin>>w>>h,w+h){\n\tfor(int i=0;i<h;i++)cin>>ta[i];\n\tfor(int i=0;i<h;i++)for(int j=0;j<w;j++)if(ok(ta[i][j]))dp[i][j]=ta[i][j]; \n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tif(! ok(ta[i][j]))continue;\n\t\t\tstring tmpa=\"\",tmpb=\"\";\n\t\t\tif(i>=1)tmpa=dp[i-1][j];\n\t\t\tif(j>=1)tmpb=dp[i][j-1];\n\t\t\tdp[i][j]=maa(tmpa,tmpb);\n\t\t\t//if(dp[i][j]==\"0\")dp[i][j]=\"\";\n\t\t\tdp[i][j].push_back(ta[i][j]);\n\t\t\t//if(i&&j)cout<<i<<\" \"<<j<<\" \"<<dp[i-1][j]<<\" \"<<dp[i][j-1]<<\" \"<<min(dp[i-1][j],dp[i][j-1])<<endl;\n\t\t}\n\t}\n\tstring ans;\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t//(dp[i][j].empty())? cout<<\"N \" : cout<<dp[i][j]<<\" \" ;\n\t\tans=maa(ans,dp[i][j]);\n\t\t}\n\t}\n\tcout<<ans<<endl;\n\tfor(int i=0;i<100;i++)for(int j=0;j<100;j++)dp[i][j]=\"\",ta[i][j]=' ';\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\nusing namespace std;\ntypedef pair<string, pair<int, int> > P;\n\nint w, h;\nchar c[80][80];\n\nint dy[2] = {1, 0};\nint dx[2] = {0, 1};\nbool f[70][70];\n\nbool is_digit(char c){\n    return ('0' <= c && c <= '9');\n}\n\nbool contain(int y, int x){\n    return (0 <= y && y < h && 0 <= x && x < w);\n}\n\nvector<string> res;\n\nvoid dfs(int y, int x, string s){\n    // cout << y << \" \" << x << \" \" <<s << endl;\n    if(!contain(y, x) || !is_digit(c[y][x])){\n        res.push_back(s);\n        return;\n    }\n    f[y][x] = true;\n    rep(i, 0, 2){\n        int ny = y + dy[i];\n        int nx = x + dx[i];\n        dfs(ny, nx, s + c[y][x]);\n    }\n    return;\n}\n\n//s1 < s2?\nbool comp(string s1, string s2){\n    if(s1.size() == s2.size()) return s1 < s2;\n    return s1.size() < s2.size();\n}\n\nint main(){\n    while(1){\n        cin >> w >> h;\n        if(w + h == 0) break;\n        rep(i, 0, h){\n            rep(j, 0, w){\n                cin >> c[i][j];\n            }\n        }\n        string d[70][70];\n        rep(i, 0, h){\n            rep(j, 0, w){\n                d[i][j] = \"\";\n                if(is_digit(c[i][j]) && c[i][j] != '0'){\n                    d[i][j] += c[i][j];\n                }\n            }\n        }\n        rep(i, 0, h){\n            rep(j, 0, w){\n                string t = \"\", t1 = \"\";\n                if(i != 0){\n                    if(is_digit(c[i][j]) && d[i - 1][j] != \"\"){\n                        t = d[i - 1][j] + c[i][j];\n                    }\n                }\n                if(j != 0){\n                    if(is_digit(c[i][j]) && d[i][j - 1] != \"\"){\n                        t1 = d[i][j - 1] + c[i][j];\n                    }\n                }\n                // cout << d[i][j] << \" \";\n                if(comp(d[i][j], t)) d[i][j] = t;\n                if(comp(d[i][j], t1)) d[i][j] = t1;\n                // cout << i << \" \" << j << \" \" << d[i][j] << endl;\n            }\n        }\n        string ans = \"\";\n        rep(i, 0, h){\n            rep(j, 0, w){\n                if(comp(ans, d[i][j])) ans = d[i][j];\n            }\n        }\n        cout << ans << endl;\n        // res.clear();\n        // rep(i, 0, h) rep(j, 0, w) f[i][j] = false;\n        // rep(i, 0, h){\n        //     rep(j, 0, w){\n        //         if(f[i][j] == false && is_digit(c[i][j]) && c[i][j] != '0'){\n        //             string tmp = \"\";\n        //             dfs(i, j, tmp);\n        //         }\n        //     }\n        // }\n        // // rep(i, 0, res.size()){\n        // //     cout << res[i] << endl;\n        // // }     \n        // int sz = 0;\n        // rep(i, 0, res.size()){\n        //     sz = max(sz, (int)res[i].size());\n        // }\n        // string ans = \"\";\n        // rep(i, 0, res.size()){\n        //     if(res[i].size() == sz && ans < res[i]) ans = res[i];\n        // }\n        // cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nint W,H;\nstring s[71][71];\nchar in[71][71];\n\nbool comp(string s, string r){\n\tif(s.size() - s.find_first_not_of('0') != r.size() - r.find_first_not_of('0')) return s.size() - s.find_first_not_of('0') > r.size() - r.find_first_not_of('0');\n\treturn s.find_first_not_of('0') > r.find_first_not_of('0');\n\t\n}\nbool comp2(string s, string r){\n\tif(s.size() != r.size()) return s.size() > r.size();\n\treturn s > r;\n\t\n}\nmain(){\n\tint i,j,k;\n\twhile(cin>>W>>H, W){\n\t\tfor(i=0;i<H;i++) cin>>in[i];\n\t\tstring m=\"0\";\n\t\tfor(int h=H-1;h>=0;h--)\n\t\t\tfor(int w=W-1;w>=0;w--)\n\t\t\t\ts[h][w] = \"\";\n\t\tfor(int h=H-1;h>=0;h--)\n\t\t\tfor(int w=W-1;w>=0;w--){\n\t\t\t\tif(!isdigit(in[h][w])) continue;\n\t\t\t\ts[h][w] = (comp2(in[h][w]+s[h+1][w] , in[h][w]+s[h][w+1])) ? (in[h][w]+s[h+1][w]) : (in[h][w]+s[h][w+1]);\n\t\t\t\tm = (comp(m, s[h][w])) ? m:s[h][w];\n\t\t\t}\n\t\twhile(m[0]=='0' && isdigit(m[1])) m = m.substr(1);\n\t\tcout<<m<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;typedef vector<int> v;int h,w,k;v x(v a,v b){return a.size()>b.size()?a.size()<b.size()?b:max(a,b):a;}int main(){while(cin>>w>>h&&h){v d[75][75],s;r(i,h)r(j,w){char z;cin>>z;z-='0';if(!(z/10)&&(z||d[i][j].size())){d[i][j].push_back(z);d[i+1][j]=x(d[i+1][j],d[i][j]);d[i][j+1]=x(d[i][j+1],d[i][j]);}s=x(s,d[i][j]);}r(i,s.size())cout<<s[i];cout<<endl;}return 0;}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <ctime>\n#include <cassert>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <numeric>\n#include <list>\n\n\nusing namespace std;\n\n#ifdef _MSC_VER\n#define __typeof__ decltype\ntemplate <class T> int __builtin_popcount(T n) { return n ? 1 + __builtin_popcount(n & (n - 1)) : 0; }\n#endif\n\n#define foreach(it, c) for (__typeof__((c).begin()) it=(c).begin(); it != (c).end(); ++it)\n#define all(c) (c).begin(), (c).end()\n#define rall(c) (c).rbegin(), (c).rend()\n#define clear(arr, val) memset(arr, val, sizeof(arr))\n\n#define rep(i, n) for (int i = 0; i < n; ++i)\n\ntemplate <class T> void max_swap(T& a, const T& b) { a = max(a, b); }\ntemplate <class T> void min_swap(T& a, const T& b) { a = min(a, b); }\n\ntypedef long long ll;\ntypedef pair<int, int> pint;\n\nconst double EPS = 1e-8;\nconst double PI = acos(-1.0);\nconst int dx[] = { 0, 1, 0, -1 };\nconst int dy[] = { 1, 0, -1, 0 };\n\n\nstring bigger(const string& a, const string& b)\n{\n\tif (a.size() > b.size() || a.size() == b.size() && a > b)\n\t\treturn a;\n\telse\n\t\treturn b;\n}\nint w, h;\nchar c[128][128];\nstring dfs(int x, int y)\n{\n\tif (x < 0 || x >= w || y < 0 || y >= h || !isdigit(c[y][x]))\n\t\treturn \"\";\n\telse\n\t\treturn c[y][x] + bigger(dfs(x + 1, y), dfs(x, y + 1));\n}\nint main()\n{\n\twhile (cin >> w >> h, w)\n\t{\n\t\tfor (int i = 0; i < h; ++i)\n\t\t\tscanf(\"%s\", c[i]);\n\t\tstring res = \"\";\n\t\tfor (int y = 0; y < h; ++y)\n\t\t\tfor (int x = 0; x < w; ++x)\n\t\t\t\tif (isdigit(c[y][x]) && c[y][x] != '0')\n\t\t\t\t\tres = bigger(res, dfs(x, y));\n\t\tcout << res << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\nstring A[80][80];\nint cmp(string s,string d)\n{\n\tif (s.length() > d.length())return 1;\n\tif (s.length() < d.length())return -1;\n\n\tfor (int i = 0; i < s.length(); i++)\n\t{\n\t\tif (s[i] > d[i])return 1;\n\t\tif (s[i] < d[i])return -1;\n\t}\n\n\treturn 0;\n}\n\nbool isN(char ch)\n{\n\tif (ch >= '0' && ch <= '9')return true;\n\treturn false;\n}\nint main()\n{\n\tint W, H;\n\twhile (cin >> W >> H && W != 0 || H != 0)\n\t{\n\t\tchar C[80][80];\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tcin >> C[i];\n\t\t}\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tA[i][j] = C[i][j];\n\t\t\t}\n\t\t}\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (!isN(C[i][j]))continue;\n\t\t\t\tif (i - 1 >= 0 && isN(C[i - 1][j]))\n\t\t\t\t{\n\t\t\t\t\tstring s = A[i - 1][j] + C[i][j];\n\t\t\t\t\tif (s[0] != '0' && cmp(s, A[i][j]) > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tA[i][j] = s;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (j - 1 >= 0 && isN(C[i][j - 1]))\n\t\t\t\t{\n\t\t\t\t\tstring s = A[i][j - 1] + C[i][j];\n\t\t\t\t\tif (s[0] != '0' && cmp(s, A[i][j]) > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tA[i][j] = s;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring max = \"\";\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (!isN(C[i][j]))continue;\n\t\t\t\tif (cmp(max, A[i][j]) < 0)\n\t\t\t\t{\n\t\t\t\t\tmax = A[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << max << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define mk make_pair\nusing namespace std;\nint dx[]={1,0},dy[]={0,1};\nint main(){\n  int w,h;\n  while(cin>>w>>h,w){\n    string s[h],t=\"\";\n    bool p[h][w];r(i,h)r(j,w)p[h][w]=0;\n    r(i,h)cin>>s[i];\n    r(i,h)r(j,w)if(s[i][j]>='1'&&s[i][j]<='9'&&!p[i][j]){\n      bool b[h][w];\n      r(k,h)r(l,w)b[k][l]=0;\n      queue<pair<int,int> >q;\n      string ss[h][w];\n      q.push(mk(i,j));\n      while(!q.empty()){\n        pair<int,int>a=q.front();q.pop();\n        int x=a.second,y=a.first;p[y][x]=1;\n        ss[y][x]+=s[y][x];\n        r(k,2){\n          int x1=x+dx[k],y1=y+dy[k];\n          if(x1<0||y1<0||x1>=w||y1>=h||s[y1][x1]<'0'||s[y1][x1]>'9')continue;\n          if(b[y1][x1]&&ss[y1][x1]<ss[y][x]){\n            ss[y1][x1]=\"\";\n            ss[y1][x1]+=ss[y][x];\n          }\n          else{\n            ss[y1][x1]+=ss[y][x];\n            q.push(mk(y1,x1));\n            b[y1][x1]=1;\n          }\n        }\n      }string tt=\"\";\n      r(k,h)r(l,w)tt=max(tt,ss[k][l]);\n      if(t.size()<tt.size())if(t<tt)t=tt;\n    }\n    cout<<t<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#include <cstdlib>\n#include <string>\n#include <cctype>\n\nusing namespace std;\n\nstring memo[72][72];\n\nint w, h;\nchar map[72][72];\n\nstring search(int x, int y, string num)\n{\n\tnum += map[y][x];\n\tif (memo[y][x] != \"\")\n\t{\n\t\tif (memo[y][x].length() > num.length())\n\t\t{\n\t\t\treturn memo[y][x];\n\t\t}\n\t\tif (memo[y][x].length() == num.length() && strcmp(memo[y][x].c_str(), num.c_str()) > 0)\n\t\t{\n\t\t\treturn memo[y][x];\n\t\t}\n\t}\n\tmemo[y][x] = num;\n\t//Ç±Öàs¯È¢ÈçAé\n\tif (((x + 1) == w ||(!isdigit(map[y][x + 1]))) && ((y + 1) == h || !isdigit(map[y + 1][x])))\n\t{\n\t\treturn num;\n\t}\n\tstring max;\n\tif (x + 1 != w && isdigit(map[y][x + 1]))\n\t{\n\t\tmax = search(x + 1, y, num);\n\t}\n\tif (y + 1 != h && isdigit(map[y + 1][x]))\n\t{\n\t\tstring str = search(x, y + 1, num);\n\t\tif (str.length() > max.length())\n\t\t\tmax = str;\n\t\tif (max.length() == str.length() && strcmp(str.c_str(), max.c_str()) > 0)\n\t\t\tmax = str;\n\t}\n\treturn max;\n}\n\nint main()\n{\n\tfor (int i = 0; i < 72; i++)\n\t\tfor (int j = 0; j < 72; j++)\n\t\t\tmemo[i][j] = \"\";\n\twhile (true)\n\t{\n\t\tcin >> w >> h;\n\t\tif (!(w || h)) break;\n\t\tstring max = \"\";\n\t\tfor (int i = 0; i < h; i++)\n\t\t{\n\t\t\tcin >> map[i];\n\t\t}\n\t\tfor (int y = 0; y < h; y++)\n\t\t{\n\t\t\tfor (int x = 0; x < w; x++)\n\t\t\t{\n\t\t\t\tif (!isdigit(map[y][x])) continue;\n\t\t\t\tif (memo[y][x] != \"\") continue;\n\t\t\t\tstring str = search(x, y, \"\");\n\t\t\t\tif (str.length() > max.length())\n\t\t\t\t\tmax = str;\n\t\t\t\tif (str.length() == max.length() && strcmp(str.c_str(), max.c_str()) > 0)\n\t\t\t\t\tmax = str;\n\t\t\t}\n\t\t}\n\t\tcout << max << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n\n\nusing namespace std;\n\nint const N = 71;\nchar table[N][N] = {};\nbool vd[N][N] = {};\n\nvoid clear() {\n    for( int i=0; i<N; ++i )\n        for( int j=0; j<N; ++j ) {\n            table[i][j] = 0;\n            vd[i][j] = false;\n        }\n}\n\nint const dir[][2] = {{1,0}, {0, 1}};\nvoid find( vector<string>& ss, string& s, int const x, int const y, int const w, int const h )\n{\n    s += table[x][y];\n    vd[x][y] = true;\n\n    for( int i=0; i<2; ++i ) {\n        int const nx = x + dir[i][0];\n        int const ny = y + dir[i][1];\n        if ( nx < 0 || ny < 0 || nx >= w || ny >= h )\n            continue;\n        \n        if ( table[nx][ny] >= '0' && table[nx][ny] <= '9' ) {\n            string copied = s;\n            find( ss, copied, nx, ny, w, h );\n        }\n    }\n\n    ss.push_back( s );\n}\n\ntemplate<typename T>\nstruct bun\n{\n    bool operator()( T const& l, T const& r ) {\n        return l.size() > r.size() || (l.size() == r.size() && l > r);\n    }\n};\n\nint main()\n{\n    for(;;) {\n        int w, h;\n        cin >> w >> h;\n        if ( w == 0 && h == 0 )\n            break;\n\n        clear();\n        for( int y=0; y<h; ++y ) {\n            string s;\n            cin >> s;\n            for( int iii=0; iii<s.size(); ++iii ) {\n                table[iii][y] = s[iii];\n            }\n        }\n\n        vector<string> ss;\n        for( int x=0; x<N; ++x ) {\n            for( int y=0; y<N; ++y ) {\n                string s;\n                if ( table[x][y] >= '1' && table[x][y] <= '9' && !vd[x][y] ) {\n                    find( ss, s, x, y, w, h );\n                }\n            }\n        }\n        stable_sort( ss.begin(), ss.end(), bun<string>() );\n\n        for( int i=0; i<ss.size(); ++i )\n            //cout << ss[i] << endl;\n            ;\n\n\n        cout << ss[0] << endl;\n        //cout << \"======\" << endl;\n    };\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef ostringstream OSS;\ntypedef istringstream ISS;\n\ntypedef long long LL;\ntypedef pair<int, int> PII;\n\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\ntypedef vector<string> VS;\ntypedef vector<VS> VVS;\ntypedef vector<bool> VB;\ntypedef vector<VB> VVB;\ntypedef vector<PII> VPII;\n\n#define fst first\n#define snd second\n#define MP make_pair\n#define PB push_back\n#define ALL(x) (x).begin(),(x).end()\n#define RANGE(x,y,maxX,maxY) (0 <= (x) && 0 <= (y) && (x) < (maxX) && (y) < (maxY))\n#define DUMP( x ) cerr << #x << \" = \" << ( x ) << endl\n\ntemplate < typename T > inline T fromString(const string &s) { T res; ISS iss(s); iss >> res; return res; };\ntemplate < typename T > inline string toString(const T &a) { OSS oss; oss << a; return oss.str(); };\n\nconst int INF = 0x3f3f3f3f;\nconst LL INFL = 0x3f3f3f3f3f3f3f3fLL;\nconst int DX[]={1,0,-1,0},DY[]={0,-1,0,1};\n\nbool myless(const string &s1, const string &s2) {\n    if (s1.size() != s2.size()) {\n        return s1.size() < s2.size();\n    }\n    return s1 < s2;\n}\n\nint main(void) {\n    int W, H;\n    while (cin >> W >> H, W) {\n        VS C(H);\n        for (auto &c : C) cin >> c;\n\n        VVS dp(H, VS(W));\n\n        for (int i = 0; i < H; i++) {\n            for (int j = 0; j < W; j++) {\n                if (isalpha(C[i][j])) continue;\n\n                string s1, s2;\n\n                if (i != 0) {\n                    s1 = dp[i - 1][j];\n                }\n                if (j != 0) {\n                    s2 = dp[i][j - 1];\n                }\n                s1 += C[i][j];\n                s2 += C[i][j];\n\n                dp[i][j] = max(s1, s2, myless);\n\n                if (dp[i][j] == \"0\") {\n                    dp[i][j] = \"\";\n                }\n            }\n        }\n\n        string ans;\n        for (int i = 0; i < H; i++) {\n            for (int j = 0; j < W; j++) {\n                ans = max(ans, dp[i][j], myless);\n            }\n        }\n\n        cout << ans << endl;\n    }\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <cstring>\n#include <climits>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <stack>\n#include <vector>\n#include <queue>\n#include <bitset>\n#include <string>\nusing namespace std;\n\n#define REP(i,n) for(int i=0; i<n; i++)\n#define RPA(i,s,e) for(int i=s; i<=e; i++)\n#define RPD(i,s,e) for(int i=s; i>=e; i--)\n#define PB(a) push_back(a)\n#define MP(i,s) make_pair(i,s)\n#define SZ(a) (int)(a).size()\n#define ALL(a) (a).begin(), (a).end()\n#define PRT(a) cerr << #a << \" = \" << (a) << endl\n#define PRT2(a,b) cerr << #a << \" = \" << (a) << \", \" << #b << \" = \" << (b) << endl\n#define PRT3(a,b,c) cerr << (a) << \", \" << (b) << \", \" << (c) << endl\n\ntypedef long long lint;\ntypedef vector<lint> vl;\ntypedef pair<lint,lint> pll;\n\nlint w, h;\nvector<string> mat;\n\nstring dp[80][80];\n\nbool digit(char c) {\n\treturn (c >= '0' && c <= '9');\n}\n\nstring larger(string& s1, string& s2) {\n\tif(s1.size() != s2.size()) {\n\t\treturn s1.size() > s2.size() ? s1 : s2;\n\t}\n\treturn s1 > s2 ? s1 : s2;\n}\n\nvoid solve() {\n\tREP(y,h) REP(x,w) dp[y][x] = \"\";\n\tREP(x,w) {\n\t\tif(digit(mat[0][x])) {\n\t\t\tif(x == 0) dp[0][x] = mat[0][x];\n\t\t\telse dp[0][x] = dp[0][x-1] + mat[0][x];\n\t\t}\n\t}\n\n\tRPA(y,1,h-1) {\n\t\tREP(x,w) {\n\t\t\tif(!digit(mat[y][x])) continue;\n\n\t\t\tif(x == 0) {\n\t\t\t\tdp[y][x] = dp[y-1][x] + mat[y][x];\n\t\t\t} else {\n\t\t\t\tstring s1 = dp[y-1][x] + mat[y][x];\n\t\t\t\tstring s2 = dp[y][x-1] + mat[y][x];\n\t\t\t\tdp[y][x] = larger(s1, s2);\n\t\t\t}\n\t\t}\n\t}\n\n\tstring ans = \"\";\n\tREP(y,h) REP(x,w) ans = larger(ans, dp[y][x]);\n\tif(ans[0] == '0') ans = ans.substr(1);\n\tcout << ans << endl;\n}\n\nvoid coding() {\n\twhile(cin>>w>>h, w|h) {\n\t\tmat = vector<string>(h);\n\t\tREP(y,h) cin >> mat[y];\n\t\tsolve();\n\t}\n}\n\n// #define _LOCAL_TEST\n\nint main() {\n#ifdef _LOCAL_TEST\n\tclock_t startTime = clock();\n\tfreopen(\"test.dat\", \"r\", stdin);\n#endif\n\n\tcoding();\n\n#ifdef _LOCAL_TEST\n\tclock_t elapsedTime = clock() - startTime;\n\tcout << endl;\n\tcout << (elapsedTime / 1000.0) << \" sec elapsed.\" << endl;\n\tcout << \"This is local test\" << endl;\n\tcout << \"Do not forget to comment out _LOCAL_TEST\" << endl << endl;\n#endif\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\nint w, h;\nint gc;\nstring s[71], dp[71][71];\nbool is_num(char c){return '0'<=c && c<= '9';}\n\nstring str_max(const string& s1, const string& s2) {\n  if (s1.size() == s2.size()) {\n    return (s1 > s2) ? s1 : s2 ;\n  }\n  return (s1.size() > s2.size())? s1 : s2 ;\n}\n\nstring dfs(int i, int j) {\n  string res = \"\";\n  \n  if (!is_num(s[i][j])) return res;\n  if (i >= h || j >= w) return res;\n  // DP\n  if (dp[i][j] != \"\") return dp[i][j];\n  \n  //gc++;\n\n  res = s[i][j] + str_max(dfs(i, j+1), dfs(i+1, j));\n  \n  // ªÉ0ªÂ¢Ä¢éêÍæé\n  if (i == 0 && j == 0) {\n    if (res[0] == '0') res.erase(0, 1);\n  } else if (i == 0) {\n    if (!is_num(s[i][j-1]) && res[0] == '0') res.erase(0, 1);\n  } else if (j == 0) {\n    if (!is_num(s[i-1][j]) && res[0] == '0') res.erase(0, 1);\n  } else{\n    if (!is_num(s[i-1][j]) && !is_num(s[i][j-1]) && res[0] == '0')res.erase(0, 1);\n  }\n  \n  return dp[i][j] = res;\n}\n\nvoid solve() {\n  for(int i=0;i<h;i++) cin>>s[i];\n  // init\n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  dp[i][j] = \"\";\n  \n  // search\n  string largest = \"\";\n  //gc = 0;\n  \n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  if (\n    dp[i][j] == \"\" &&\n    is_num(s[i][j]) &&\n    (i == 0 || !is_num(s[i-1][j])) &&\n    (j == 0 || !is_num(s[i][j-1]))\n    )\n  largest = str_max(dfs(i, j), largest);\n  \n  /*\n  for(int i=0;i<h;i++) {\n    for(int j=0;j<w;j++) cout<<\"[\"<<dp[i][j]<<\"]\";\n    cout<<endl;\n  }\n  */\n  //cout<<gc<<endl;\n  cout<<largest<<endl;\n}\n\nint main (int argc, char const* argv[]) {\n  while (cin>>w>>h, w||h) {\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "# define _CRT_SECURE_NO_WARNINGS 1\n# include <iostream>\n# include <numeric>\n# include <string>\n# include <bitset>\n# include <vector>\n# include <algorithm>\n# include <cstdlib>\n# include <cstdio>\n# include <cstring>\n# include <cstdlib>\n# include <iomanip>\n# include <queue>\n# include <sstream>\n# include <climits>\n# include <cmath>\n# include <list>\n# include <functional>\n# include <string>\n# include <ctime>\n# include <set>\n# include <forward_list>\n# include <map>\n# include <stack>\nusing namespace std;\n\n# define INF ((int)(1<<30))\n# define REP(i,n) for(int i=0;i<(int)n;i++)\n# define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();i++)\n# define TORAD 2.0*M_PI/360.0\n# define INT(x) int x;cin>>x;\n# define ALL(x) (x).begin(),(x).end()\n# define DEBUG(x) cout<<#x<<\" :\"<<x<<endl;\n# define EPS 1e-12\n\ntemplate<class T> void debug(T a) { for (auto i : a)cout << i << endl; }\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef pair<int, pii> piii;\nint dx[4] = { 0,-1,1,0 }, dy[4] = { 1,0,0,-1 };\n\nint clamp(int a, int mi, int ma)\n{\n\treturn max(mi, min(a, ma));\n}\nbool isnum(char a)\n{\n\treturn ('0' <= a&&a <= '9');\n}\nstring big(string a, string b)\n{\n\tif (a.size() > b.size())\n\t{\n\t\treturn a;\n\t}\n\tif (a.size() < b.size())\n\t{\n\t\treturn b;\n\t}\n\treturn max(a, b);\n}\n\n\nchar a[100][100]; \nstring flag[100][100];\nstring ans;\nvoid hoge(string &s, int y, int x)\n{\n\tflag[y][x] = big(s + flag[y][x + 1], s + flag[y + 1][x]);\n\tif(s!=\"0\")ans = big(ans, flag[y][x]);\n\treturn;\n}\n\n\n\nint main()\n{\n\tint w, h;\n\twhile (cin >> w >> h&&w)\n\t{\n\t\t\n\t\tREP(i, 100)REP(j, 100)\n\t\t{\n\t\t\ta[i][j] = 'a';\n\t\t\tflag[i][j] = \"\";\n\t\t}\n\t\tans = \"\";\n\t\tREP(i, h)\n\t\t{\n\t\t\tREP(j, w)\n\t\t\t{\n\t\t\t\tcin >> a[i][j];\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (int y = h - 1; y >= 0;y--)\n\t\t{\n\t\t\tfor (int x = w - 1; x >= 0;x--)\n\t\t\t{\n\t\t\t\tif (isnum(a[y][x]))\n\t\t\t\t{\n\t\t\t\t\tstring str; str += a[y][x];\n\t\t\t\t\thoge(str, y, x);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint W,H;\n\nbool flag[70][70];\nstring mat[70];\nint cnt;\nstring ans;\n\nvoid dfs(int y, int x,int c,string s) {\n    // cout<<y<<\",\"<<x<<\",\"<<c<<\",\"<<s<<endl;\n    if(cnt<c) {\n        cnt=c;\n        ans=s;\n    }\n    flag[y][x]=true;\n\n    rep(i,2) {\n        int ny=y+dy[i];\n        int nx=x+dx[i];\n        if(!(0<=ny&&ny<H)) continue;\n        if(!(0<=nx&&nx<W)) continue;\n        if(flag[ny][nx]) continue;\n        if(!('0'<=mat[ny][nx]&&mat[ny][nx]<='9')) continue;\n        dfs(ny,nx,c+1,s+mat[ny][nx]);\n\n    }\n\n    return;\n}\n\nvoid solve() {\n    cnt=0;\n    ans=\"\";\n    rep(i,70) rep(j,70) flag[i][j]=false;\n    rep(i,70) mat[i]=\"\";\n    rep(i,H) cin>>mat[i];\n    rep(i,H) rep(j,W) if('1'<=mat[i][j]&&mat[i][j]<='9') {\n        string s=\"a\";\n        s[0]=mat[i][j];\n        dfs(i,j,0,s);\n    }\n\n    cout<<ans<<endl;\n}\n\nint main() {\n    while(cin>>W>>H) {\n        if(W+H==0) break;\n        solve();\n\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <set>\n#include <stack>\n#include <queue>\n#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <cstdlib>\n\nusing namespace std;\ntypedef long long LL;\nstatic const double EPS = 1e-9;\n\n#define FOR(i,k,n) for (int i=(k); i<(int)(n); ++i)\n#define REP(i,n) FOR(i,0,n)\n\nint w,h;\nbool valid(int x, int y){\n  return (0<=x&&x<w&&0<=y&&y<h);\n}\nstring maxstring(string s1,string s2){\n  if(s1.size()>s2.size()) return s1;\n  else if(s1.size()<s2.size()) return s2;\n  else return max(s1,s2);\n}\nint main(void){\n  while(cin>>w>>h,w){\n    char g[70][70];\n    string dp[70][70];\n    REP(y,h)cin>>g[y];\n    bool update = true;\n    string ans = \"\";\n    REP(y,h)REP(x,w){\n      if(!isdigit(g[y][x])) dp[y][x] = \"\";\n      else{\n        string smax = \"\";\n        if(valid(x-1,y)) smax = maxstring(smax,dp[y][x-1]);\n        if(valid(x,y-1)) smax = maxstring(smax,dp[y-1][x]);\n        if(smax==\"0\")smax = \"\";\n        dp[y][x] = smax + g[y][x];\n      }\n      ans = maxstring(ans,dp[y][x]);\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <cstring>\n#include <cctype>\n\nusing namespace std;\ntypedef long long ll;\n\nchar field[71][71];\n\nstring recur(string value, int x, int y){\n\tif(isdigit(field[y][x])){\n\t\tvalue += field[y][x];\n\t\tstring src = value, next;\n\t\tnext = recur(src, x + 1, y);\n\t\tif(value.size() < next.size() || (value.size() == next.size() && value < next)){\n\t\t\tvalue = next;\n\t\t}\n\t\tnext = recur(src, x, y + 1);\n\t\tif(value.size() < next.size() || (value.size() == next.size() && value < next)){\n\t\t\tvalue = next;\n\t\t}\n\t}\n\treturn value;\n}\n\nint main(){\n\twhile(true){\n\t\tint W, H;\n\t\tcin >> W >> H;\n\t\tif(W == 0 && H == 0){ break; }\n\t\tmemset(field, 0, sizeof(field));\n\t\tfor(int i = 0; i < H; ++i){ cin >> field[i]; }\n\t\tstring answer = \"\";\n\t\tfor(int i = 0; i < H; ++i){\n\t\t\tfor(int j = 0; j < W; ++j){\n\t\t\t\tif(field[i][j] != '0'){\n\t\t\t\t\tstring value = recur(\"\", j, i);\n\t\t\t\t\tif(answer.size() < value.size() ||\n\t\t\t\t\t   (answer.size() == value.size() && answer < value))\n\t\t\t\t\t{\n\t\t\t\t\t\tanswer = value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << answer << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n//http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#include<iostream>\n#include<map>\n#include<vector>\n#include<algorithm>\n#include<cmath>\n#include<climits>\n#include<ctime>\n#include<cstring>\n#include<numeric>\n\n#define ALL(v) (v).begin(),(v).end()\n#define REP(i,p,n) for(int i=p;i<(int)(n);++i)\n#define rep(i,n) REP(i,0,n)\n#define dump(a) (cerr << #a << \"=\" << (a) << endl)\n#define DUMP(list) cout << \"{ \"; for(auto nth : list){ cout << nth << \" \"; } cout << \"}\" << endl;\n\nusing namespace std;\n\nint W,H;\nint dw[2] = {0, 1};\nint dh[2] = {1, 0};\nstring ans;\n\nbool cmp(string str1, string str2)\n{\t\n\tif(str1.length() == str2.length())\n\t{\n\t\trep(i,str1.size()){\n\t\t\tif(str1[i] != str2[i]){\n\t\t\t\treturn str1[i] < str2[i];\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\telse if(str1.length() < str2.length()){\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nvector<char> adjust(vector<char> list)\n{\n\tvector<char> res;\n\tbool flag=false;\n\trep(i,list.size()){\n\t\tif(list[i] != '0' || flag){ res.push_back(list[i]); flag=true; }\n\t}\n\n\treturn res;\n}\n\nvoid dfs(int w, int h, vector<char> list, vector< vector<char> > &matrix)\n{\n\tif(w < 0 || w >= W || h < 0 || h >= H){ return; }\n\tif(!isdigit(matrix[h][w])){ return; }\n\n\tlist.push_back(matrix[h][w]);\n\n\trep(i,2){\n\t\tdfs(w+dw[i], h+dh[i], list, matrix);\n\t}\n\n\tif(list.size() == 0){ return; }\n\tlist = adjust(list);\n\tstring num(ALL(list));\n\n\tif(cmp(ans,num)){ ans = num; }\n\treturn;\n}\n\nint main()\n{\n\twhile(cin >> W >> H && W)\n\t{\n\n\t\tvector< vector<char> > matrix( H, vector<char>(W) );\n\n\t\trep(h,H){\n\t\t\trep(w,W){\n\t\t\t\tcin >> matrix[h][w];\n\t\t\t}\n\t\t}\n\n\t\tans=\"\";\n\t\tvector<char> list;\n\t\trep(h,H){\n\t\t\trep(w,W){\n\t\t\t\tdfs(w, h, list, matrix);\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <numeric>\n#include <bitset>\n#include <cmath>\n\nstatic const int MOD = 1000000007;\nusing ll = long long;\nusing u32 = uint32_t;\nusing namespace std;\n\ntemplate<class T> constexpr T INF = ::numeric_limits<T>::max()/32*15+208;\n\nstring bigger(string &s, string &t){\n    if(s.size() > t.size()) return s;\n    if(s.size() < t.size()) return t;\n    return max(s, t);\n}\n\n\nint main() {\n    int w, h;\n    while(cin >> w >> h, w){\n        vector<string> v(h);\n        for (int i = 0; i < h; ++i) {\n            cin >> v[i];\n        }\n        vector<vector<string>> dp(h+1, vector<string>(w+1, \"0\"));\n        for (int i = 0; i < h; ++i) {\n            for (int j = 0; j < w; ++j) {\n                if(!isdigit(v[i][j])) continue;\n                string s = bigger(dp[i+1][j], dp[i][j+1]);\n                if(s != \"0\") dp[i+1][j+1] = s + v[i][j];\n                else dp[i+1][j+1] = v[i][j];\n            }\n        }\n        string ans = \"0\";\n        for (int i = 0; i < h; ++i) {\n            for (int j = 0; j < w; ++j) {\n                ans = bigger(ans, dp[i+1][j+1]);\n            }\n        }\n        cout << ans << \"\\n\";\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "// AOJ 1126\n#include<iostream>\n#include<string>\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\nusing namespace std;\n\nbool iszero(string s) {\n  for (char c : s) {\n    if (c != '0') return false;\n  }\n  return true;\n}\n\nstring remove_zero(string s) {\n  for (int i = 0, len = s.length(); i < len; i++) {\n    if (s[i] != '0') return s.substr(i);\n  }\n  return \"\";\n}\n\nint compare(string s1, string s2) {\n  int l1 = s1.length(), l2 = s2.length();\n\n  if (l1 < l2) {\n    return -1;\n  } else if (l1 > l2) {\n    return 1;\n  } else {\n    return s1.compare(s2);\n  }\n}\n\nstring strmax(string s1, string s2) {\n  return (compare(s1, s2) > 0 ? s1 : s2);\n}\n\nint W, H;\nconst int WMAX = 100;\nchar table[WMAX][WMAX];\nstring dp[WMAX][WMAX];\n\nvoid solve() {\n  for (int y = H - 1; y >= 0; y--) {\n    for (int x = W - 1; x >= 0; x--) {\n      if (isalpha(table[x][y])) {\n        dp[x][y] = \"\";\n      } else {\n        dp[x][y] = table[x][y] + strmax(dp[x+1][y], dp[x][y+1]);\n      }\n    }\n  }\n}\n\nvoid init() {\n  REP(y,H+3) REP(x,W+3) {\n    dp[x][y] = \"\";\n  }\n}\n\nint main() {\n  while (cin >> W >> H and (W or H)) {\n    REP(y, H) {\n      string row;\n      cin >> row;\n      REP(x, W) {\n        table[x][y] = row[x];\n      }\n    }\n\n    solve();\n\n    string mx = \"\";\n    REP(y,H) REP(x,W) {\n      if (iszero(dp[x][y])) continue;\n      mx = strmax(mx, remove_zero(dp[x][y]));\n    }\n    cout << remove_zero(mx) << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint W,H;\n\nbool flag[2][2][70][70];\nstring mat[70];\nint cnt;\nstring ans;\n\nvoid dfs(int y, int x,int c,string s) {\n    // cout<<y<<\",\"<<x<<\",\"<<c<<\",\"<<s<<endl;\n    if(cnt<c) {\n        cnt=c;\n        ans=s;\n    }\n\n    rep(i,2) {\n        int ny=y+dy[i];\n        int nx=x+dx[i];\n        if(!(0<=ny&&ny<H)) continue;\n        if(!(0<=nx&&nx<W)) continue;\n        if(flag[dy[i]][dx[i]][ny][nx]) continue;\n        if(!('0'<=mat[ny][nx]&&mat[ny][nx]<='9')) continue;\n        flag[dy[i]][dx[i]][ny][nx]=true;\n        dfs(ny,nx,c+1,s+mat[ny][nx]);\n\n    }\n\n    return;\n}\n\nvoid solve() {\n    cnt=0;\n    ans=\"\";\n    rep(i,70) rep(j,70) rep(a,2) rep(b,2) flag[a][b][i][j]=false;\n    rep(i,70) mat[i]=\"\";\n    rep(i,H) cin>>mat[i];\n    rep(i,H) rep(j,W) if('1'<=mat[i][j]&&mat[i][j]<='9') {\n        string s=\"a\";\n        s[0]=mat[i][j];\n        dfs(i,j,0,s);\n    }\n\n    cout<<ans<<endl;\n}\n\nint main() {\n    while(cin>>W>>H) {\n        if(W+H==0) break;\n        solve();\n\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cctype>\n#include <algorithm>\nusing namespace std;\n\nint w,h;\nstring m[100];\nstring dp[100][100];\n\nstring max_string(const vector<string>& vs){\n\tint max_len=0;\n\tstring s;\n\tfor(int i=0 ; i < vs.size() ; i++ ){\n\t\tmax_len = max( max_len , (int)vs[i].size() );\n\t}\n\tfor(int i=0 ; i < vs.size() ; i++ ){\n\t\tif( vs[i].size() == max_len && ( s.empty() || s < vs[i] ) ){\n\t\t\ts = vs[i];\n\t\t}\n\t}\n\treturn s;\n}\n\nvoid solve(){\n\tfor(int y=0 ; y < 100 ; y++ ){\n\t\tfor(int x=0 ; x < 100 ; x++ ){\n\t\t\tdp[y][x].clear();\n\t\t}\n\t}\n\n\tint max_len=0;\n\tstring ans;\n\tfor(int y=h-1 ; y >= 0 ; y-- ){\n\t\tfor(int x=w-1 ; x >= 0 ; x-- ){\n\t\t\tif( isdigit( m[y][x] ) ){\n\t\t\t\tdp[y][x].push_back( m[y][x] );\n\t\t\t\tvector<string> vs;\n\t\t\t\tif( x != w-1 && y != h-1 && isdigit( m[y+1][x+1] ) ){\n\t\t\t\t\tvs.push_back( dp[y+1][x+1] );\n\t\t\t\t}\n\t\t\t\tif( x != w-1 && isdigit( m[y][x+1] ) ){\n\t\t\t\t\tvs.push_back( dp[y][x+1] );\n\t\t\t\t}\n\t\t\t\tif( y != h-1 && isdigit( m[y+1][x] ) ){\n\t\t\t\t\tvs.push_back( dp[y+1][x] );\n\t\t\t\t}\n\t\t\t\tdp[y][x] += max_string( vs );\n\t\t\t}\n\t\t\tif( !dp[y][x].empty() && dp[y][x][0] != '0' ){\n\t\t\t\tmax_len = max( max_len , (int)dp[y][x].size() );\n\t\t\t}\n\t\t}\n\t}\n\tfor(int y=0 ; y < h ; y++ ){\n\t\tfor(int x=0 ; x < w ; x++ ){\n\t\t\tif( dp[y][x].size() == max_len && ( ans.empty() || ans < dp[y][x] ) ){\n\t\t\t\tans = dp[y][x];\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n}\n\nint main(){\n\twhile( cin >> w >> h , w || h ){\n\t\tfor(int i=0 ; i < h ; i++ ){\n\t\t\tcin >> m[i];\n\t\t}\n\t\tsolve();\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "\n//http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#include<iostream>\n#include<map>\n#include<vector>\n#include<algorithm>\n#include<cmath>\n#include<climits>\n#include<ctime>\n#include<cstring>\n#include<numeric>\n\n#define ALL(v) (v).begin(),(v).end()\n#define REP(i,p,n) for(int i=p;i<(int)(n);++i)\n#define rep(i,n) REP(i,0,n)\n#define dump(a) (cerr << #a << \"=\" << (a) << endl)\n#define DUMP(list) cout << \"{ \"; for(auto nth : list){ cout << nth << \" \"; } cout << \"}\" << endl;\n\nusing namespace std;\n\nint W,H;\nchar matrix[70][70];\nint dw[2] = {0, 1};\nint dh[2] = {1, 0};\nstring ans;\n\nbool cmp(string str1, string str2)\n{\t\n\tif(str1.length() == str2.length())\n\t{\n\t\trep(i,str1.size()){\n\t\t\tif(str1[i] != str2[i]){\n\t\t\t\treturn str1[i] > str2[i];\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\telse if(str1.length() < str2.length()){\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nvector<char> adjust(vector<char> list)\n{\n\tvector<char> res;\n\tbool flag=false;\n\trep(i,list.size()){\n\t\tif(list[i] != '0' || flag){ res.push_back(list[i]); flag=true; }\n\t}\n\n\treturn res;\n}\n\nvoid dfs(int w, int h, vector<char> list)\n{\n\tif(w < 0 || w >= W || h < 0 || h >= H){ return; }\n\tif(!isdigit(matrix[h][w])){ return; }\n\n\tlist.push_back(matrix[h][w]);\n\tmatrix[h][w] = '#';\n\n\trep(i,2){\n\t\tdfs(w+dw[i], h+dh[i], list);\n\t}\n\n\tif(list.size() == 0){ return; }\n\tlist = adjust(list);\n\tstring num(ALL(list));\n\n\tif(cmp(ans,num)){ ans = num; }\n\treturn;\n}\n\nint main()\n{\n\twhile(cin >> W >> H && W)\n\t{\n\n\t\trep(h,H){\n\t\t\trep(w,W){\n\t\t\t\tcin >> matrix[h][w];\n\t\t\t}\n\t\t}\n\n\t\tans=\"\";\n\t\tvector<char> list;\n\t\trep(h,H){\n\t\t\trep(w,W){\n\t\t\t\tdfs(w,h,list);\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\n\nconst int MAXH = 71;\nconst int MAXW = 71;\nint W, H;\nstring dp[MAXH][MAXW];\n\nbool comp(const string &a, const string &b) {\n  if(a.size() != b.size()) return a.size() < b.size();\n  for(int i = 0; i < a.size(); ++i) {\n    if(a[i] != b[i]) return a[i] < b[i];\n  }\n  return false;\n}\n\nint main() {\n  while(cin >> W >> H && (W|H)) {\n    fill(dp[0], dp[MAXH], \"0\");\n    string res = \"0\";\n    for(int i = 1; i <= H; ++i) {\n      for(int j = 1; j <= W; ++j) {\n        char c;\n        cin >> c;\n        if(isdigit(c)) {\n          dp[i][j] = max(dp[i-1][j], dp[i][j-1], comp);\n          if(dp[i][j] == \"0\") dp[i][j] = \"\";\n          dp[i][j] += c;\n        }\n        res = max(res, dp[i][j], comp);\n      }\n    }\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <functional>\n#include <vector>\n#include <utility>\n#include <cstring>\n#include <iomanip>\n#include <numeric>\n#include <cmath>\n#include <queue>\n#include <map>\nusing namespace std;\ntypedef long long ll;\nconst int INF = 1<<30; \nconst int MOD = 1e9 + 7;\nconst int dy[] = {-1, 0};\nconst int dx[] = {0, -1};\nconst int MAX_N = 80;\nvector<vector<string>> memo(MAX_N, vector<string>(MAX_N));\nint h, w;\nbool IsNumber(char ch)\n{\n    if(ch >= 'A' && ch <= 'Z') return false;\n    else return true;\n};\nstring Cal(string s, string t)\n{\n    if(s.size() > t.size()) return s;\n    else if(s.size() == t.size()) return max(s, t);\n    else return t;\n}\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    while(cin >> w >> h, h | w)\n    {\n        for(int i = 0; i < h; i++)\n        {\n            for(int j = 0; j < w; j++)\n            {\n                char ch;\n                cin >> ch;\n                memo[i][j] = ch;\n            }\n        }\n        string ans = \"\";\n        for(int i = 0; i < h; i++)\n        {\n            for(int j = 0; j < w; j++)\n            {\n                if(!(IsNumber(memo[i][j][0]))) continue;\n                string ms = \"\";\n                for(int k = 0; k < 2; k++)\n                {\n                    int ny = i + dy[k];\n                    int nx = j + dx[k];\n                    if(ny < 0 || nx < 0 || ny >= h || nx >= w) continue;\n                    if(!(IsNumber(memo[ny][nx][0]))) continue;\n                    if(memo[ny][nx][0] == '0' && memo[ny][nx].size() <= 1) continue;\n                    ms = Cal(memo[ny][nx], ms);\n                }\n                memo[i][j] = ms + memo[i][j];\n                ans = Cal(memo[i][j], ans);\n            }\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n \nint H,W;\nchar S[71][71];\nstring maxs,DP[100][100];\n \nint main()\n{\n  while(1){\n    cin>>W>>H;\n    if(W==0&&H==0)break;\n    maxs.erase(maxs.begin(),maxs.end());\n    for(int i=1;i<H+1;i++){\n      for(int j=1;j<W+1;j++){\n    cin>>S[i][j];\n    DP[i][j].erase(DP[i][j].begin(),DP[i][j].end());\n      }\n    }\n    for(int i=1;i<H+1;i++){\n      for(int j=1;j<W+1;j++){\n        if(S[i][j]=='0' && DP[i-1][j].empty() && DP[i][j-1].empty())continue;\n    if(S[i][j]>='0' && S[i][j]<='9'){\n      if(DP[i-1][j].length()>DP[i][j-1].length())DP[i][j]=DP[i-1][j]+S[i][j];\n      else if(DP[i-1][j].length()<DP[i][j-1].length())DP[i][j]=DP[i][j-1]+S[i][j];\n          else if(DP[i-1][j]>DP[i][j-1])DP[i][j]=DP[i-1][j]+S[i][j];\n      else DP[i][j]=DP[i][j-1]+S[i][j];\n      if(maxs.length()<DP[i][j].length())maxs=DP[i][j];\n          else if(maxs.length()==DP[i][j].length() && maxs<DP[i][j])maxs=DP[i][j];\n    }\n      }\n    }\n    cout<<maxs<<endl;\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <vector>\n#include <string>\n#include <queue>\n#include <deque>\n#include <list>\n#include <stack>\n#include <set>\n#include <map>\n#include <algorithm>\n\n#define int long long\n#define MOD7 1000000007\n#define MOD9 1000000009\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n#define REP(i, a, n) for (int i = (a); i <= (n); i++)\n#define all(a) (a).begin(), (a).end()\n\nusing namespace std;\n\nint dx[4] = { 1, 0, -1, 0 };\nint dy[4] = { 0, -1, 0, 1 };\n\nint nextInt() {int a; cin >> a; return a;}\nchar nextChar() {char a; cin >> a; return a;}\ndouble nextDouble() {double a; cin >> a; return a;}\nstring nextString() {string a; cin >> a; return a;}\n\nvoid inputVector(vector<int> &v, int &n) {rep(i,n){v.push_back(nextInt());}}\nvoid inputVector(vector<double> &v, int &n) {rep(i,n){v.push_back(nextDouble());}}\nvoid inputVector(vector<string> &v, int &n) {rep(i,n){v.push_back(nextString());}}\n\nsigned main() {\n    int W, H;\n    while (cin >> W >> H) {\n\tif (W == 0) break;\n\n\tvector<string> board;\n\tinputVector(board, H);\n\n\tstring ret = \"\";\n\tstring dp[70][70];\n\tfor (int y = H - 1; y >= 0; y--) {\n\t    for (int x = W - 1; x >= 0; x--) {\n\t\tif (board[y][x] < '0' || board[y][x] > '9') dp[y][x] = \"\";\n\t\telse {\n\t\t    string prev = \"\";\n\t\t    if (y < H - 1) prev = dp[y + 1][x];\n\t\t    if (x < W - 1 && dp[y][x + 1].size() > prev.size()) prev = dp[y][x + 1];\n\t\t    dp[y][x] = board[y][x] + prev;\n\t\t    if (ret.size() > 0 && board[y][x] == '0') continue;\n\t\t    if (ret.size() > dp[y][x].size()) continue;\n\t\t    if (ret.size() == dp[y][x].size() && ret > dp[y][x]) continue;\n\t\t    ret = dp[y][x];\n\t\t}\n\t    }\n\t}\n\tcout << ret << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <limits.h>\n#include <math.h>\n#include <bitset>\n#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <iomanip>\n#include <iostream>\n\n#define VARIABLE(x) cerr << #x << \"=\" << x << endl\n#define BINARY(x) static_cast<bitset<16> >(x);\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define REP(i,m,n) for (int i=m;i<(int)(n);i++)\n#define if_range(x, y, w, h) if (0<=(int)(x) && (int)(x)<(int)(w) && 0<=(int)(y) && (int)(y)<(int)(h))\n\nconst int INF = 100000000;\ntypedef double D;\nconst double EPS = 1e-8;\nconst double PI = 3.14159;\nint dx[4]={-1, 0, 1, 0}, dy[4]={0, -1, 0, 1};\nusing namespace std;\ntypedef pair<int, int> P;\n\n/** Problem1126 : The Secret Number **/\nconst int MAX_W = 70;\nint W, H;\nchar field[MAX_W][MAX_W];\nstring dp[MAX_W][MAX_W];\n\nbool big(string s1, string s2) {\n\tif (s1.length() > s2.length()) {\n\t\treturn true;\n\t} else if (s2.length() > s1.length()) {\n\t\treturn false;\n\t} else {\n\t\treturn (s1>s2?true:false);\n\t}\n}\n\nbool big2(string s1, string s2) {\n\twhile (s1[0]=='0') s1.erase(s1.begin());\n\twhile (s2[0]=='0') s2.erase(s2.begin());\n\treturn big(s1, s2);\n}\n\nstring rec(int x, int y)\n{\n\tif (!('0' <= field[y][x] && field[y][x] <= '9'))\n\t\treturn dp[y][x] = \"\";\n\t\n\tstring s1 = field[y][x] + dp[y][x+1];\n\tstring s2 = field[y][x] + dp[y+1][x];\n\t\n\treturn dp[y][x] = (big(s1, s2)?s1:s2);\n}\n\nint main()\n{\n\twhile (cin>>W>>H, W||H) {\n\t\tfill(dp[0], dp[0]+W*H, \"\");\n\t\t\n\t\trep(i, H) {\n\t\t\trep(j, W) {\n\t\t\t\tcin>>field[i][j];\n\t\t\t}\n\t\t}\n\t\t\n\t\tstring ans = \"0\";\n\t\trep(y, H) {\n\t\t\trep(x, W) {\n\t\t\t\tstring tmp = rec(W-x-1, H-y-1);\n\t\t\t\tans = (big2(ans, tmp)?ans:tmp);\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\twhile (ans[0]=='0') ans.erase(ans.begin());\n\t\t\n\t\tcout << (ans!=\"\"?ans:\"0\") << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<cctype>\nusing namespace std;\n\n#define MAX 72\n#define INV (-1)\n\nstruct Dig{\n\tvector<char> s;\n\tvoid push( char c ){\n\t\ts.push_back( c );\n\t}\n\tvoid pop(){\n\t\ts.pop_back();\n\t}\n\tvoid simplify(){\n\t\twhile( true ){\n\t\t\tif( s.size() == 1 )\n\t\t\t\tbreak;\n\t\t\tif( s[0] == '0' ){\n\t\t\t\ts.erase( s.begin() );\n\t\t\t}else\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tbool operator<(const Dig &t){\n\t\tif( s.size() < t.s.size() )\n\t\t\treturn true;\n\t\telse if( s.size() == t.s.size() ){\n\t\t\tfor(unsigned int i = 0; i < s.size(); ++i){\n\t\t\t\tif( s[i] == t.s[i] )\n\t\t\t\t\tcontinue;\n\t\t\t\tif( s[i] < t.s[i] )\n\t\t\t\t\treturn true;\n\t\t\t\telse\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n};\n\nvector< Dig > vdigs;\nvoid ResetMap(char map[MAX][MAX]){\n\tfor(int i = 0; i < MAX; ++i){\n\t\tfor( int j = 0; j < MAX; ++j){\n\t\t\tmap[i][j] = INV;\n\t\t}\n\t}\n}\ntemplate<typename _T>\nostream &operator << (ostream &os, const vector<_T> &v){\n\tfor(unsigned int i = 0; i < v.size(); ++i){\n\t\tos << v[i];\n\t}\n\treturn os;\n}\nint main(){\t\n\twhile(true){\n\t\tint H,W;\n\t\tDig ans;\n\t\tchar map[MAX][MAX];\n\t\tDig dmap[MAX][MAX];\n\n\t\tcin >> W >> H;\n\t\t\n\t\tif( W == 0 && H == 0 ) break;\n\t\tvdigs.clear();\n\t\tResetMap( map );\n\t\tfor(int i = 1; i <= H; ++i){\n\t\t\tstring s;\n\t\t\tcin >> s;\n\t\t\tfor(int j = 1; j <= W; ++j){\n\t\t\t\tmap[i][j] = s[j-1];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 1; i <= H; ++i){\n\t\t\tfor(int j = 1; j <= W; ++j){\n\t\t\t\tif( !isdigit(map[i][j]) )\n\t\t\t\t\tcontinue;\n\t\t\t\telse{\n\t\t\t\t\tDig d,d1,d2;\n\t\t\t\t\tDig dmax;\n\t\t\t\t\td.push( map[i][j] );\n\t\t\t\t\tif( isdigit( map[i-1][j] ) ){\n\t\t\t\t\t\td1 = dmap[i-1][j];\n\t\t\t\t\t\td1.push( map[i][j] );\n\t\t\t\t\t}\n\t\t\t\t\tif( isdigit( map[i][j-1] ) ){\n\t\t\t\t\t\td2 = dmap[i][j-1];\n\t\t\t\t\t\td2.push( map[i][j] );\n\t\t\t\t\t}\n\t\t\t\t\tdmax = d;\n\t\t\t\t\tif( dmax < d1 )\n\t\t\t\t\t\tdmax = d1;\n\t\t\t\t\tif( dmax < d2 )\n\t\t\t\t\t\tdmax = d2;\n\t\t\t\t\tdmax.simplify();\n\t\t\t\t\tdmap[i][j] = dmax;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i = 1; i <= H; ++i){\n\t\t\tfor(int j = 1; j <= W; ++j){\n\t\t\t\tif( ans < dmap[i][j] ){\n\t\t\t\t\tans = dmap[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans.s << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define vi vector<int>\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back\n#define pii pair<int,int>\n#define mp make_pair\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nint w,h;\nvector<string> data;\n\nint dx[2]={1,0};\nint dy[2]={0,1};\nbool inrange(int x,int y){ \n\tif(x<0||y<0||x>h-1||y>w-1) return false;\n\telse return true;\n}\n\nlong long int conv(string str){\n\tif(str==\"\") return -1;\n\tREP(i,str.size()) {\n\t\tif(str[i]<'0'||str[i]>'9') {\n\t\t\treturn -1;\n\t\t}\n\t}\n\tcout << str << endl;\n\treturn stoll(str);\n}\n\nstring getbigger(string a,string b){\n\tif(a.size()!=b.size()){\n\t\tif(a.size()>b.size()) return a;\n\t\telse return b;\n\t}\n\telse{\n\t\tREP(i,a.size()){\n\t\t\tif(a[i]==b[i]) continue;\n\t\t\tif(a[i]>b[i]) return a;\n\t\t\telse  return b;\n\t\t}\n\t\treturn a;//eq\n\t}\n}\n\nstring solve(int px,int py,bool sudeni[100][100]){\n\n\tstring rst = \"\";\n\tif(!inrange(px,py)) return \"\";\n\tif(sudeni[px][py]==false && '0'<=data[px][py] && data[px][py]<='9') {\n\t\trst+=data[px][py];\n\t\tsudeni[px][py] = true;\n\t}\n\tvector<string> tmp;\n\tREP(i,2){\n\t\ttmp.pb(\"\");\n\t\tint nx = px + dx[i];\n\t\tint ny = py + dy[i];\n\t\tif(inrange(nx,ny) && sudeni[nx][ny]==false && '0'<=data[nx][ny] && data[nx][ny]<='9') {\n\t\t\ttmp[i]=solve(nx,ny,sudeni);\n\t\t}\n\t}\n\trst += getbigger(tmp[0],tmp[1]);\n\treturn  rst;\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(w==0&&h==0) break;\n\t\tdata.clear();\n\t\tREP(i,h){\n\t\t\tstring tmp;\n\t\t\tcin >> tmp;\n\t\t\tdata.pb(tmp);\n\t\t}\n\t\tstring ans = \"-1\";\n\t\tREP(i,h){\n\t\t\tREP(j,w){\n\t\t\t\tbool s[100][100];\n\t\t\t\tREP(i,100) REP(j,100) s[i][j]=false;\n\t\t\t\tans = getbigger(solve(i,j,s),ans);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define vi vector<int>\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back\n#define pii pair<int,int>\n#define mp make_pair\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nint w,h;\nvector<string> data;\nint dx[2]={1,0};\nint dy[2]={0,1};\nbool sudeni[100][100];\n\nbool inrange(int x,int y){ \n\tif(x<0||y<0||x>h-1||y>w-1) return false;\n\telse return true;\n}\nstring rmzero(string a){\n\tstring str=\"\";\n\tbool f = false;\n\tREP(i,a.size()){\n\t\tif(!f){\n\t\t\tif(a[i]!='0') {\n\t\t\t\tstr+=a[i];\n\t\t\t\tf = true;\n\t\t\t}\n\t\t}else{\n\t\t\tstr+=a[i];\n\t\t}\n\t}\n\treturn str;\n}\n\nstring getbigger(string a,string b,bool ff){\n\tif(ff) {a = rmzero(a); b = rmzero(b);}\n\tif(a.size()!=b.size()){\n\t\tif(a.size()>b.size()) return a;\n\t\telse return b;\n\t}\n\telse{\n\t\tREP(i,a.size()){\n\t\t\tif(a[i]==b[i]) continue;\n\t\t\tif(a[i]>b[i]) return a;\n\t\t\telse  return b;\n\t\t}\n\t\treturn a;//eq\n\t}\n}\n\nstring solve(int px,int py){\n\tstring rst = \"\";\n\tif(!inrange(px,py)) return \"\";\n\tsudeni[px][py] = true;\n\tif('0'<=data[px][py] && data[px][py]<='9') {\n\t\trst+=data[px][py];\n\t}\n\tvector<string> tmp;\n\tREP(i,2){\n\t\ttmp.pb(\"\");\n\t\tint nx = px + dx[i];\n\t\tint ny = py + dy[i];\n\t\tif(inrange(nx,ny) && sudeni[nx][ny]==false &&'0'<=data[nx][ny] && data[nx][ny]<='9') {\n\t\t\ttmp[i]=solve(nx,ny);\n\t\t}\n\t}\n\trst += getbigger(tmp[0],tmp[1],false);\n\treturn  rst;\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(w==0&&h==0) break;\n\t\tdata.clear();\n\t\tREP(i,h){\n\t\t\tstring tmp;\n\t\t\tcin >> tmp;\n\t\t\tdata.pb(tmp);\n\t\t}\n\t\tstring ans = \"0\";\n\t\tREP(i,100) REP(j,100) sudeni[i][j]=false;\n\t\tREP(i,h){\n\t\t\tREP(j,w){\n\t\t\t\tif(sudeni[i][j]==false&&data[i][j]>='0'&&data[i][j]<='9') ans = getbigger(solve(i,j),ans,true);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 100000000\n\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair <int,int> P;\n\n\nstatic const double EPS = 1e-8;\n\nint tx[] = {-1,0,1,0};\nint ty[] = {0,1,0,-1};\n\nchar stage[101][101];\nint W,H;\n\nstring larger(string str1,string str2){\n\tif(str1.size() > str2.size()) return str1;\n\tif(str1.size() < str2.size()) return str2;\n\n\tfor(int i=0;i<str1.size();i++){\n\t\tif(str1[i] > str2[i] ) return str1;\n\t\tif(str1[i] < str2[i] ) return str2;\n\t}\n\n\treturn str1;\n}\n\nvoid dfs(int x,int y,string buf,string& res){\n\tbuf.push_back(stage[y][x]);\n\n\tif(y+1 < H && isdigit(stage[y+1][x])){\n\t\tdfs(x,y+1,buf,res);\t\t\n\t}\n\n\tif(x+1 < W && isdigit(stage[y][x+1])){\n\t\tdfs(x+1,y,buf,res);\n\t}\n\n\tres = larger(res,buf);\n}\n\nint main()\n{\n\twhile(~scanf(\"%d %d\",&W,&H)){\n\t\tif(W==H && H==0) break;\n\t\tfor(int y=0;y<H;y++){\n\t\t\tchar buf[128];\n\t\t\tscanf(\"%s\",buf);\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tstage[y][x] = buf[x];\n\t\t\t}\n\t\t}\n\n\t\tstring res=\"0\";\n\t\tfor(int y=0;y<H;y++){\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tif(!isdigit(stage[y][x])) continue;\n\t\t\t\tif(stage[y][x] == '0') continue;\n\t\t\t\tdfs(x,y,\"\",res);\t\t\t\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<deque>\n#include<list>\n#include<map>\n#include<queue>\n#include<set>\n#include<stack>\n#include<vector>\n#include<algorithm>\n#include<string>\n#include<iostream>\n#include<sstream>\n#include<cmath>\n#include<cstring>\nusing namespace std;\nchar a[90][90];\nstring mx;\nint mxln;\nvoid fn(int p,int q,string s){\n  int i;\n  if(0){\n  }else if('0'<=a[p][q+1]&&a[p][q+1]<='9'&&'0'<=a[p+1][q]&&a[p+1][q]<='9'){\n    fn(p,q+1,s+a[p][q+1]);\n    fn(p+1,q,s+a[p+1][q]);\n  }else if('0'<=a[p][q+1]&&a[p][q+1]<='9'){\n    fn(p,q+1,s+a[p][q+1]);\n  }else if('0'<=a[p+1][q]&&a[p+1][q]<='9'){\n    fn(p+1,q,s+a[p+1][q]);\n  }else{\n    int ln=s.length();\n    if(0){\n    }else if(mxln<ln){\n      mx=s;\n      mxln=ln;\n    }else if(mxln>ln){\n    }else{\n      for(i=0;i<ln;++i){\n\tif(0){\n\t}else if(mx[i]<s[i]){\n\t  mx=s;\n\t  break;\n\t}else if(mx[i]>s[i]){\n\t  break;\n\t}\n      }\n    }\n  }\n  return;\n}\nint main(){\n  int i,j;\n  int w,h;\n  while(cin>>w>>h,w||h){\n    memset(a,0,sizeof(a));\n    for(i=0;i<h;++i)\n      for(j=0;j<w;++j)\n\tcin>>a[i][j];\n    mx=\"0\";\n    mxln=1;\n    for(i=0;i<h;++i){\n      for(j=0;j<w;++j){\n\tif('1'<=a[i][j]&&a[i][j]<='9')\n\t  fn(i,j,string(1,a[i][j]));\n      }\n    }\n    cout<<mx<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<vector>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<numeric>\n#include<cassert>\n#include<random>\nusing namespace std;\n\nbool num(char c){\n    if(c<'0' || c>'9'){return false;}\n    return true;\n}\n\nstring max(string a,string b){\n    int as=(int)a.size();\n    int bs=(int)b.size();\n    for(int i=0;a[i]=='0';i++){as--;}\n    for(int i=0;b[i]=='0';i++){bs--;}\n    if(as>bs){return a;}\n    if(bs>as){return b;}\n    for(int i=0;i<as;i++){\n        if(a[a.size()-as+i]>b[b.size()-bs+i]){return a;}\n        if(a[a.size()-as+i]<b[b.size()-bs+i]){return b;}\n    }\n    return a;\n}\n\nstring pls(char c,string s){\n    s.push_back(1);\n    for(int i=(int)s.size()-2;i>=0;i--){\n        s[i+1]=s[i];\n    }\n    s[0]=c;\n    return s;\n}\n\nint main(){\n    while(1){\n        \n        \n        \n    \n    string mx;\n    char a[100][100]={};\n    int w,h;\n    cin>>w>>h;\n        if(w==0 && h==0){break;}\n    for(int i=0;i<h;i++){\n        for(int t=0;t<w;t++){\n            cin>>a[i][t];\n        }\n    }\n    string dp[100][100]={};\n    string ans;\n    for(int i=h-1;i>=0;i--){\n        for(int t=w-1;t>=0;t--){\n            if(num(a[i][t])){\n                dp[i][t]=pls(a[i][t],max(dp[i+1][t],dp[i][t+1]));\n                ans=max(ans,dp[i][t]);\n            }\n        }\n    }\n    cout<<ans<<endl;\n    \n        \n        \n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <queue>\n#include <utility>\n#include <map>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nconst int WH = 72;\n\nchar board[WH];\nstring dp[WH];\n\nbool comp(const string& a, const string& b){\n\tif(!a.length() && !b.length()) return false;\n\tif(a.length() == b.length()){\n\t\tfor(int i = 0;i < a.length();++i){\n\t\t\tif(a[i] == b[i]) continue;\n\t\t\telse return a[i] < b[i];\n\t\t}\n\t}\n\treturn a.length() < b.length();\n}\n\nint main(){\n\tint w, h, m;\n\tstring r;\n\tbool f;\n\twhile(cin >> w >> h, w){\n\t\tf = false;\n\t\tr = \"\";\n\t\tfill(dp, dp + (w * h), \"\");\n\t\tfill(board, board + (w * h), 0);\n\t\tfor(int i = 0;i < w * h;++i){\n\t\t\tcin >> board[i];\n\t\t}\n\t\tfor(int i = h - 1;0 <= i;--i){\n\t\t\tfor(int j = w - 1;0 <= j;--j){\n\t\t\t\tstring r = j + 1 < w ? dp[i * w + j + 1] : \"\";\n\t\t\t\tstring d = i + 1 < h ? dp[(i + 1) * w + j] : \"\";\n\t\t\t\tif('0' <= board[i * w + j] && board[i * w + j] <= '9'){\n\t\t\t\t\tdp[i * w + j] = board[i * w + j];\n\t\t\t\t\tdp[i * w + j] = max(dp[i * w + j], max(board[i * w + j] + r, board[i * w + j] + d, comp), comp);\n\t\t\t\t}\n\t\t\t\telse dp[i * w + j] = \"0\";\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < w * h;++i){\n\t\t\tr = max(r, dp[i], comp);\n\t\t}\n\t\tfor(int i = 0;i < r.length();++i){\n\t\t\tif(f || r[i] != '0'){\n\t\t\t\tf = true;\n\t\t\t\tcout << r[i];\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nstring x[100][100];\nbool p[100][100];\nint h,w;\nchar T[11]=\"0123456789\";\nchar c;\nstring dp[100][100];\n\nbool isnum(string p){\n\tfor(int i=0;i<10;i++){\n\t\tif(T[i]==p[0]){\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nstring _max(string a,string b){\n\tif(a.size()<b.size()){return b;}\n\tif(a.size()>b.size()){return a;}\n\tif(a>b){return a;}\n\treturn b;\n}\n\nint main(){\n\twhile(true){\n\t\tfor(int i=0;i<100;i++){\n\t\t\tfor(int j=0;j<100;j++){\n\t\t\t\tdp[i][j]=\"\";\n\t\t\t\tx[i][j]=\"a\";\n\t\t\t}\n\t\t}\n\t\tcin>>h>>w;\n\t\tif(h==0 && w==0){break;}\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tcin>>c;\n\t\t\t\tstring G=\"\";\n\t\t\t\tG+=c;\n\t\t\t\tx[i][j]=G;\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tif(isnum(x[i][j])==true){\n\t\t\t\t\tdp[i][j]=\"\"+x[i][j];\n\t\t\t\t\tp[i][j]=true;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tp[i][j]=false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<100;i++){\n\t\t\tfor(int j=0;j<h;j++){\n\t\t\t\tfor(int k=0;k<w;k++){\n\t\t\t\t\tif(p[j+1][k]==true){\n\t\t\t\t\t\tdp[j+1][k]=_max(dp[j+1][k],dp[j][k]+x[j+1][k]);\n\t\t\t\t\t}\n\t\t\t\t\tif(p[j][k+1]==true){\n\t\t\t\t\t\tdp[j][k+1]=_max(dp[j][k+1],dp[j][k]+x[j][k+1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring maxn=\"\";\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tmaxn=max(maxn,dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout<<maxn<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define LL long long\n#define VI vector<int>\n#define VVI vector<vector<int>>\n#define VVVI vector<vector<vector<int>>>\n#define VVVVI vector<vector<vector<vector<int>>>>\n#define VL vector<LL>\n#define VVL vector<vector<LL>>\n#define VVVL vector<vector<vector<LL>>>\n#define VVVVL vector<vector<vector<vector<LL>>>>\n#define VB vector<bool>\n#define FOR(i,a,b) for(int i= (a); i<((int)b); ++i)\n#define RFOR(i,a) for(int i=(a); i >= 0; --i)\n#define FOE(i,a) for(auto i : a)\n#define ALL(c) (c).begin(), (c).end()\n#define RALL(c) (c).rbegin(), (c).rend()\n#define DUMP(x)  cerr << #x << \" = \" << (x) << endl;\n#define SUM(x) std::accumulate(ALL(x), 0LL)\n#define MIN(v) *std::min_element(v.begin(), v.end())\n#define MAX(v) *std::max_element(v.begin(), v.end())\n#define EXIST(v,x) (std::find(v.begin(), v.end(), x) != v.end())\n#define BIT(n) (1LL<<(n))\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end());\n#define EPS 1e-14\n\ntemplate<class T> T ceil(T a, T b) { return (a + b - 1) / b; }\ntemplate<class T> void print(T x) { std::cout << x << std::endl; }\ninline bool inside(int y, int x, int H, int W) { return 0 <= y and y < H and 0 <= x and x < W; }\n\nconst std::string YES = \"YES\", Yes = \"Yes\", NO = \"NO\", No = \"No\";\nconst std::vector<int> dy = { 0, 1, 0, -1 }, dx = { 1, 0, -1, 0 };    // 4近傍（右, 下, 左, 上）\n\nusing namespace std;\n\n\nbool big(string a, string b) {\n    if (a.size() != b.size()) {\n        return a.size() > b.size();\n    }\n    FOR(i, 0, a.size()) {\n        if ((a[i] - '0') > (b[i] - '0')) {\n            return true;\n        }\n        else if ((a[i] - '0') < (b[i] - '0')) {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while (true) {\n        int W, H;\n        cin >> W >> H;\n        if (W == 0 and H == 0) { break; }\n\n        vector<vector<int>> field(H, vector<int>(W, -1));\n        FOR(i, 0, H) {\n            string s;\n            cin >> s;\n            FOR(j, 0, s.size()) {\n                if (s[j] < 'A') {\n                    field[i][j] = (s[j] - '0');\n                }\n            }\n        }\n\n        vector<vector<string>> dp(H, vector<string>(W));\n        string ans = \"\";\n        FOR(y, 0, H) {\n            FOR(x, 0, W) {\n                if (field[y][x] == -1) {\n                    continue;\n                }\n\n                if (dp[y][x].empty() and field[y][x] == 0) {\n                    continue;\n                }\n                \n                // start\n                if (dp[y][x].empty()) {\n                    dp[y][x] = to_string(field[y][x]);\n                }\n\n                if (y + 1 < field.size() and field[y + 1][x] != -1) {\n                    string new_c = dp[y][x] + to_string(field[y + 1][x]);\n                    if (big(new_c, dp[y + 1][x])) {\n                        dp[y + 1][x] = new_c;\n\n                        if (big(new_c, ans)) {\n                            ans = new_c;\n                        }\n                    }\n                }\n                if (x + 1 < field[0].size() and field[y][x + 1] != -1) {\n                    string new_c = dp[y][x] + to_string(field[y][x + 1]);\n                    if (big(new_c, dp[y][x + 1])) {\n                        dp[y][x + 1] = new_c;\n                    }\n                    if (big(new_c, ans)) {\n                        ans = new_c;\n                    }\n                }\n            }\n        }\n\n        print(ans);\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <cctype>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <set>\n#include <queue>\n#include <stack>\n#include <map>\n#include <cassert>\nusing namespace std;\n\n#define REP(i, s, e) for (int i = (s); i < (e); i++)\n#define REPI(i, s, e) for (int i = (s); i <= (e); i++)\n#define rep(i, n) REP(i, 0, n)\n#define repi(i, n) REPI(i, 0, n)\n#define ALL(v) (v).begin(), (v).end()\n\n#define dump(x) (cout << #x << \" = \" << x << endl)\n#define dump2(x, y) (cout << \"(\" << #x << \", \" << #y << \") = (\" << x << \", \" << y << \")\" << endl)\n#define dump3(x, y, z) (cout << \"(\" << #x << \", \" << #y << \", \" << #z << \") = (\" << x << \", \" << y << \", \"<< z << \")\" << endl)\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\n\nint w, h;\n\n#define MAX 70\nchar brd[MAX][MAX];\n\nstring memo[MAX][MAX];\n\nint dx[] = { 1, 0 };\nint dy[] = { 0, 1 };\n\nclass num {\npublic:\n\tstring n;\n\n\tnum():n(\"\") {}\n\tnum(string n):n(f(n)) {}\n\n\tstring f(string s)\n\t{\n\t\tif (s[0] == '0' && s.size() > 1) return s.substr(1);\n\t\treturn s;\n\t}\n\n\tbool operator<(const num &r) const {\n\t\tif (n.size() == r.n.size())\n\t\t\treturn n < r.n;\n\t\treturn n.size() < r.n.size();\n\t}\n};\n\nstring dfs(int y, int x)\n{\n\tif (memo[y][x] != \"\")\n\t\treturn memo[y][x];\n\n\tstring ans = \"\";\n\trep(d, 2) {\n\t\tint ty = y+dy[d], tx = x+dx[d];\n\t\tif (!(0 <= ty && ty < h)) continue;\n\t\tif (!(0 <= tx && tx < w)) continue;\n\t\tif (!isdigit(brd[ty][tx])) continue;\n\t\tstring ret = brd[y][x] + dfs(ty, tx);\n\t\tif (ans.size() < ret.size())\n\t\t\tans = ret;\n\t}\n\tif (ans == \"\") ans = brd[y][x];\n\treturn memo[y][x] = ans;\n}\n\nint main(void)\n{\n\twhile (cin >> w >> h, w|h) {\n\t\trep(j, MAX) rep(i, MAX)\n\t\t\tmemo[j][i] = \"\";\n\n\t\trep(j, h) rep(i, w) cin >> brd[j][i];\n\n\t\tnum ans = num();\n\t\trep(j, h)\n\t\t\trep(i, w)\n\t\t\t\tif (isdigit(brd[j][i]))\n\t\t\t\t\tans = max(ans, num(dfs(j, i)));\n\n\t\tcout << ans.n << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n#include<cstdio>\n#include<sstream>\n#include<algorithm>\n#include<cmath>\n#include<map>\n#include<functional>\n#include<queue>\n#include<stack>\n#include<set>\nusing namespace std;\n char ta[100][100];\n \n string dp[100][100];\n bool ok(char n){\n \tfor(int i=0;i<10;i++)if(i+'0'==n)return 1;\n \treturn 0;\n }\n string maa(string a,string b){\n \twhile(a[0]=='0')a.erase(a.begin());\n \twhile(b[0]=='0')b.erase(b.begin());\n \tif(a.size()>b.size())return a;\n \tif(a.size()<b.size())return b;\n \tfor(int i=0;i<a.size();i++){\n \t\tif(a[i]-'0'>b[i]-'0')return a;\n \t\telse if(a[i]-'0'<b[i]-'0')return b;\n \t}\n \treturn a;\n }\n \nint main(){\n\tint h,w;\n\tstring a,b;\n\t//cin>>a>>b;cout<<maa(a,b);\n\twhile(cin>>w>>h,w+h){\n\tfor(int i=0;i<h;i++)cin>>ta[i];\n\tfor(int i=0;i<h;i++)for(int j=0;j<w;j++)if(ok(ta[i][j]))dp[i][j]=ta[i][j]; \n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tif(! ok(ta[i][j]))continue;\n\t\t\tstring tmpa=\"\",tmpb=\"\";\n\t\t\tif(i>=1)tmpa=dp[i-1][j];\n\t\t\tif(j>=1)tmpb=dp[i][j-1];\n\t\t\tdp[i][j]=maa(tmpa,tmpb);\n\t\t\t//if(dp[i][j]==\"0\")dp[i][j]=\"\";\n\t\t\tdp[i][j].push_back(ta[i][j]);\n\t\t\t//if(i&&j)cout<<i<<\" \"<<j<<\" \"<<dp[i-1][j]<<\" \"<<dp[i][j-1]<<\" \"<<min(dp[i-1][j],dp[i][j-1])<<endl;\n\t\t}\n\t}\n\tstring ans;\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t//(dp[i][j].empty())? cout<<\"N \" : cout<<dp[i][j]<<\" \" ;\n\t\tans=maa(ans,dp[i][j]);\n\t\t}\n\t}\n\tcout<<ans<<endl;\n\tfor(int i=0;i<100;i++)for(int j=0;j<100;j++)dp[i][j]=\"\",ta[i][j]=' ';\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <complex>\n#include <deque>\n#include <exception>\n#include <fstream>\n#include <functional>\n#include <iomanip>\n#include <ios>\n#include <iosfwd>\n#include <iostream>\n#include <istream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <locale>\n#include <map>\n#include <memory>\n#include <new>\n#include <numeric>\n#include <ostream>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <stdexcept>\n#include <streambuf>\n#include <string>\n#include <typeinfo>\n#include <utility>\n#include <valarray>\n#include <vector>\n#include <climits>\n\n#define rep(i, m, n) for(int i=int(m);i<int(n);i++)\n//#define EACH(i, c) for (auto &(i): c)\n#define all(c) begin(c),end(c)\n//#define EXIST(s, e) ((s).find(e)!=(s).end())\n//#define SORT(c) sort(begin(c),end(c))\n//#define pb emplace_back\n//#define MP make_pair\n//#define SZ(a) int((a).size())\n\n//#define LOCAL 0\n//#ifdef LOCAL\n//#define DEBUG(s) cout << (s) << endl\n//#define dump(x)  cerr << #x << \" = \" << (x) << endl\n//#define BR cout << endl;\n//#else\n//#define DEBUG(s) do{}while(0)\n//#define dump(x) do{}while(0)\n//#define BR\n//#endif\n\n\n//改造\ntypedef long long int ll;\nusing namespace std;\n#define INF (1 << 30) - 1\n#define INFl (ll)5e15\n#define DEBUG 0 //デバッグする時1にしてね\n#define dump(x)  cerr << #x << \" = \" << (x) << endl\n#define MOD 1000000007\n//ここから編集する\nint W, H;\nvector<string> vv;\nstring dp[75][75][75][75];\n\nbool integer(char c) {\n    return c >= '0' && c <= '9';\n}\n\nstring parse(string str) {\n    int start = 0;\n    for (start = 0; str[start] == '0' && start < str.size(); start++) {\n\n    }\n    return str.substr(start);\n}\n\nbool lt(string left, string right) {\n//    left = parse(left);\n//    right = parse(right);\n    if (left.size() < right.size()) {\n        return true;\n    } else if (left.size() > right.size()) {\n        return false;\n    } else {\n        rep(i, 0, left.size()) {\n            if (left[i] != right[i]) {\n                return left[i] < right[i];\n            }\n        }\n    }\n    return false;\n}\n\nstring dfs(int sh, int sw, int th, int tw) {\n    if (dp[sh][sw][th][tw] != \".\") {\n        return dp[sh][sw][th][tw];\n    }\n    if (!integer(vv[sh][sw]) || !integer(vv[th][tw])) {\n        return dp[sh][sw][th][tw] = \"\";\n    }\n    string ret = \"\";\n    if (sh == th && sw == tw) {\n        ret += vv[sh][sw];\n        return dp[sh][sw][th][tw] = ret;\n    }\n    if (th - sh + tw - sw == 1) {\n        ret += vv[sh][sw];\n        ret += vv[th][tw];\n        return dp[sh][sw][th][tw] = ret;\n    }\n\n\n    rep(mh, sh, th + 1) {\n        rep(mw, sw, tw + 1) {\n            if (sh == mh && sw == mw) {\n                continue;\n            }\n            if (mh == th && mw == tw) {\n                continue;\n            }\n            string left = dfs(sh, sw, mh, mw);\n            string right = dfs(mh, mw, th, tw);\n            if (left.size() > 0 && right.size() > 0) {\n                string tmp = \"\";\n                tmp += left.substr(0, left.size() - 1);\n                tmp += right;\n                if (lt(ret, tmp)) {\n                    ret = tmp;\n                }\n            }\n\n        }\n    }\n    return dp[sh][sw][th][tw] = ret;\n\n\n}\n\nbool solve() {\n    cin >> W >> H;\n    if (W == 0 && H == 0) {\n        return false;\n    }\n    vv.resize(H);\n    rep(i, 0, 75) {\n        rep(j, 0, 75) {\n            rep(k, 0, 75) {\n                rep(l, 0, 75) {\n                    dp[i][j][k][l] = \".\";\n                }\n            }\n        }\n    }\n\n    rep(i, 0, H) {\n        cin >> vv[i];\n    }\n\n    string ans = \"\";\n    rep(sh, 0, H) {\n        rep(th, sh, H) {\n            rep(sw, 0, W) {\n                rep(tw, sw, W) {\n                    string tmp = parse(dfs(sh, sw, th, tw));\n                    if (lt(ans, tmp)) {\n                        ans = tmp;\n                    }\n                }\n            }\n        }\n    }\n    cout << ans << endl;\n\n    return true;\n\n\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while (solve()) {\n\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\nconst int dx[2] = {1, 0}, dy[2] = {0, 1};\n\nstring dp[71][71];\nstring s[71];\nint W, H;\n\nstring dfs(int h, int w) {\n  if ( dp[h][w].size() > 0 ) return dp[h][w];\n\n  string ret = \"\";\n  ret += s[h][w];\n  for ( int i = 0; i < 2; i++ ) {\n    int ny = h+dy[i], nx = w+dx[i];\n    if ( ny < 0 || nx < 0 || ny >= H || nx >= W ) continue;\n    if ( !isdigit(s[ny][nx]) ) continue;\n    string tmp = s[h][w]+dfs(ny, nx);\n    if ( tmp.size() > ret.size() ) ret = tmp;\n    else if ( tmp.size() == ret.size() && tmp > ret ) ret = tmp;\n  }\n\n  return dp[h][w] = ret;  \n}\n\nsigned main() {\n  cin.tie(0);\n  ios_base::sync_with_stdio(0);\n  cout << fixed << setprecision(12);\n\n  while ( cin >> W >> H, W ) {\n    for ( int i = 0; i < H; i++ ) {\n      cin >> s[i];      \n    }\n    \n    fill_n(*dp, 71*71, \"\");\n    string ans = \"\";    \n    for ( int i = 0; i < H; i++ ) {\n      for ( int j = 0; j < W; j++ ) {\n\tif ( '1' <= s[i][j] && s[i][j] <= '9' ) {\n\t  string tmp = dfs(i, j);\n\t  if ( tmp.size() > ans.size() ) ans = tmp;\n\t  else if ( tmp.size() == ans.size() && tmp > ans ) ans = tmp;\t  \n\t}\n      }\n    }\n\n    cout << ans << endl;    \n  }  \n  \n  return 0;\n} \n\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 100000000\n\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair <int,int> P;\n\n\nstatic const double EPS = 1e-8;\n\nint tx[] = {-1,0,1,0};\nint ty[] = {0,1,0,-1};\n\nchar stage[101][101];\nint W,H;\n\nstring larger(const string& str1,const string& str2){\n\tif(str1.size() > str2.size()) return str1;\n\tif(str1.size() < str2.size()) return str2;\n\n\tfor(int i=0;i<str1.size();i++){\n\t\tif(str1[i] > str2[i] ) return str1;\n\t\tif(str1[i] < str2[i] ) return str2;\n\t}\n\n\treturn str1;\n}\n\nint main()\n{\n\twhile(~scanf(\"%d %d\",&W,&H)){\n\t\tif(W==H && H==0) break;\n\t\tfor(int y=0;y<H;y++){\n\t\t\tchar buf[128];\n\t\t\tscanf(\"%s\",buf);\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tstage[y][x] = buf[x];\n\t\t\t}\n\t\t}\n\n\t\tstring dp[101][101];\n\n\t\tfor(int y=0;y<H;y++){\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tstring left=\"\";\n\t\t\t\tif(isdigit(stage[y][x])){\n\t\t\t\t\tif(!(dp[y+1][x].size() == 0 && stage[y][x]=='0')){\n\t\t\t\t\t\tleft = dp[y+1][x] + stage[y][x];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstring up=\"\";\n\t\t\t\tif(isdigit(stage[y][x])){\n\t\t\t\t\tif(!(dp[y][x+1].size() == 0 && stage[y][x]=='0')){\n\t\t\t\t\t\tup = dp[y][x+1] + stage[y][x];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tdp[y+1][x+1] = larger(left,up);\n\t\t\t}\n\t\t}\n\n\t\tstring res=\"0\";\n\t\tfor(int y=0;y<=H;y++){\n\t\t\tfor(int x=0;x<=W;x++){\t\n\t\t\t\tres = larger(res,dp[y][x]);\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cctype>\nusing namespace std;\n\nint main()\n{\n  int W,H,i,j;\n  string ans;\n  char matrix[70][70];\n  string dp[70][70];\n  while(cin>>W>>H,W|H){\n    for(i=0;i<H;i++){\n      for(j=0;j<W;j++){\n\t  cin>>matrix[i][j];\n\t  dp[i][j]=\"\";\n\t}\n    }\n\n    if(isdigit(matrix[0][0]) && matrix[0][0]!='0')dp[0][0]=matrix[0][0];\n    for(j=1;j<W;j++){\n      string t=dp[0][j-1];\n      if(isdigit(matrix[0][j]))t+=matrix[0][j];\n      if(t!=\"0\")dp[0][j]=t;\n    }\n    ans=\"\";\n    for(i=1;i<H;i++){\n      for(j=0;j<W;j++){\n\tif(!isdigit(matrix[i][j]))continue;\n\tstring t=dp[i-1][j];\n\tif(0<j-1 && isdigit(matrix[i][j-1])){\n\t  if(dp[i][j-1].size()>t.size())t=dp[i][j-1];\n\t  else if(dp[i][j-1].size()==t.size() && dp[i][j-1]>t)t=dp[i][j-1];\n\t}\n\tif(isdigit(matrix[i][j]))t+=matrix[i][j];\n\telse t=\"\";\n\tif(t!=\"0\")dp[i][j]=t;\n\n\tif(ans.size()<t.size())ans=t;\n\telse if(ans.size()==t.size() && ans<t)ans=t;\n      }\n    }\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint W, H;\nvector<string> str;\nbool used[70][70];\nconst int dx[] = { 1, 0 };\nconst int dy[] = { 0, 1 };\n\n\nbool Comp(const string& l, const string& r) {\n\treturn l.size() == r.size() ? l < r : l.size() < r.size();\n}\n\nstring MAX(const string& l, const string& r) {\n\treturn Comp(l, r) ? r : l;\n}\n\nstring dfs(int x, int y) {\n\tused[x][y] = true;\n\tstring res;\n\tfor (int i = 0; i < 2; i++) {\n\t\tint tx = x + dx[i], ty = y + dy[i];\n\t\tif (tx >= 0 && tx < H && ty >= 0 && ty < W && !used[tx][ty] && str[tx][ty] >= '0' && str[tx][ty] <= '9') {\n\t\t\tres = MAX(res, dfs(tx, ty));\n\t\t}\n\t}\n\treturn str[x][y] + res;\n}\n\nint main()\n{\n\twhile (cin >> W >> H, W || H) {\n\t\tfor (int i = 0; i < H; i++) {\n\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\tused[i][j] = false;\n\t\t\t}\n\t\t}\n\t\tstr.resize(H);\n\t\tfor (int i = 0; i < H; i++) {\n\t\t\tcin >> str[i];\n\t\t}\n\t\tstring res;\n\t\tfor (int i = 0; i < H; i++) {\n\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\tif (!used[i][j] && str[i][j] >= '1' && str[i][j] <= '9') {\n\t\t\t\t\tres = MAX(res, dfs(i, j));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <utility>\n#include <cctype>\nusing namespace std;\n\nchar F[70][70];\n\n// s <= t ?\nbool compare(string s, string t) {\n  int ls, lt;\n  for(ls = 0; s[ls] == '0'; ++ls) ;\n  for(lt = 0; t[lt] == '0'; ++lt) ;\n  s = s.substr(ls);\n  t = t.substr(lt);\n  if(s.length() < t.length()) return true;\n  if(s.length() > t.length()) return false;\n  for(int i = 0; i < s.length(); ++i) {\n    if(s[i] > t[i]) return false;\n  }\n  return true;\n}\n\nint main() {\n  while(true) {\n    int W, H; cin >> W >> H;\n    if(W == 0 && H == 0) break;\n    for(int i = 0; i < H; ++i) cin >> F[i];\n    string ans = \"0\";\n    queue<pair<string,pair<int,int>>> Q;\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        if(isdigit(F[i][j])) {\n          string s;\n          s.push_back(F[i][j]);\n          Q.emplace(make_pair(s,make_pair(i,j)));\n        }\n      }\n    }\n    string G[H][W];\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        G[i][j] = \"0\";\n      }\n    }\n    while(!Q.empty()) {\n      auto p = Q.front(); Q.pop();\n      if(compare(ans, p.first)) ans = p.first;\n      int i = p.second.first;\n      int j = p.second.second;\n      if(compare(G[i][j],p.first) == false) continue;\n      if(i + 1 < H && isdigit(F[i+1][j])) {\n        string s = p.first;\n        s.push_back(F[i+1][j]);\n        if(compare(s,G[i+1][j]) == false) {\n          G[i+1][j] = s;\n          Q.emplace(make_pair(s,make_pair(i+1,j)));\n        }\n      }\n      if(j + 1 < W && isdigit(F[i][j+1])) {\n        string s = p.first;\n        s.push_back(F[i][j+1]);\n        if(compare(s,G[i][j+1]) == false) {\n          G[i][j+1] = s;\n          Q.emplace(make_pair(s,make_pair(i,j+1)));\n        }\n      }\n    }\n    int l = 0;\n    while(ans[l] == '0') ++l;\n    ans = ans.substr(l);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <cassert>\nusing namespace std;\ninline int toInt(string s){int v;istringstream sin(s);sin>>v;return v;}\ntemplate <class T> inline string toString(T x){ostringstream sout;sout<<x;return sout.str();}\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EACH(t,i,c) for(t::iterator i=(c).begin();i!=(c).end();++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n) FOR(i,0,n)\nconst double EPS=1e-10;\nconst double PI=acos(-1.0);\n\n\nbool pred(const string &left, const string &right){\n\tif(left.size()!=right.size())return left.size()<right.size();\n\treturn left<right;\n}\nint dx[]={-1,0},dy[]={0,-1};\ntypedef vector<vs> vvs;\nint main(){\n\tint W,H;\n\twhile(cin>>W>>H,W&&H){\n\t\tvs matrix(W,string(H,' '));\n\t\tREP(i,H)REP(j,W){\n\t\t\tcin>>matrix[j][i];\n\t\t}\n\t\tvvs dp(W,vs(H,\"0\"));\n\n\t\tREP(i,W)REP(j,H){\n\t\t\tif(!isdigit(matrix[i][j])){\n\t\t\t\tdp[i][j]=\"0\";\n\t\t\t}else{\n\t\t\t\tdp[i][j]=matrix[i][j];\n\t\t\t\tREP(k,2){\n\t\t\t\t\tint x=i+dx[k],y=j+dy[k];\n\t\t\t\t\tif(x>=0&&y>=0){\n\t\t\t\t\t\tstring prev=(dp[x][y]==\"0\"?\"\":dp[x][y]);\n\t\t\t\t\t\tdp[i][j]=max(dp[i][j],prev+matrix[i][j],pred);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring maxs;\n\t\tREP(i,W)REP(j,H){\n\t\t\tmaxs=max(maxs,dp[i][j],pred);\n\t\t}\n\t\tcout<<maxs<<endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <string>\nusing namespace std;\n\n//string?????§??¨?????´??°?????§?°???????\n//x>y :1, x<y:-1, x=y:0\nint cmp(string x, string y){\n  int ret=0;\n  if(x==y) ret=0;\n  else{\n    if(x.size() > y.size()) ret=1;\n    else if(x.size() < y.size()) ret=-1;\n    else{\n      for(int i=0; i<x.size(); ++i){\n        if(x[i]!=y[i]){\n          if(x[i]>y[i]) ret=1;\n          else ret=-1;\n          break;\n        }\n      }\n    }\n  }\n  return ret;\n}\n\nbool isNum(char c){\n  return ('0'<=c && c<='9');\n}\n\nint main(){\n  while(1){\n    int w, h;\n    cin>>w>>h;\n    if(w==0 && h==0) break;\n\n    char c[72][72];\n    for(int i=1; i<=h; ++i)\n    for(int j=1; j<=w; ++j)\n    scanf(\" %c\", &c[i][j]);\n\n    for(int i=0; i<=w; ++i) c[0][i]='0';\n    for(int i=0; i<=h; ++i) c[i][0]='0';\n\n    string dp[71][71];\n    for(int i=0; i<=h; ++i){\n      for(int j=0; j<=w; ++j){\n        dp[i][j]=\"0\";\n      }\n    }\n\n    for(int i=1; i<=h; ++i){\n      for(int j=1; j<=w; ++j){\n        if(isNum(c[i][j])){\n          string p=dp[i-1][j];\n          string q=dp[i][j-1];\n\n          if(p==\"0\") p=c[i][j];\n          else p+=c[i][j];\n          if(q==\"0\") q=c[i][j];\n          else q+=c[i][j];\n\n          if(cmp(p,q)==1) dp[i][j]=p;\n          else dp[i][j]=q;\n        }\n      }\n    }\n\n    string ans=\"0\";\n    for(int i=1; i<=h; ++i){\n      for(int j=1; j<=w; ++j){\n        if(cmp(ans,dp[i][j])==-1) ans=dp[i][j];\n      }\n    }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n\nusing namespace std;\n\nbool compare(string S1, string S2)\n{\n\tif (S1.size() != S2.size()) { return S1.size() > S2.size(); }\n\n\treturn S1 > S2;\n}\n\nint main()\n{\n\tint H, W;\n\n\twhile (true)\n\t{\n\t\tcin >> W >> H;\n\n\t\tif (H == 0 && W == 0) { break; }\n\n\t\tvector<string> R(H);\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tcin >> R[i];\n\t\t}\n\n\t\tvector<vector<string> > dp(H, vector<string>(W, \"\"));\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (isdigit(R[i][j]))\n\t\t\t\t{\n\t\t\t\t\tdp[i][j] = R[i][j];\n\n\t\t\t\t\tif (i != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[i][j] = dp[i - 1][j] + R[i][j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (j != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[i][j] = dp[i][j - 1] + R[i][j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ret = \"\";\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (compare(dp[i][j], ret))\n\t\t\t\t{\n\t\t\t\t\tret = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << ret << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint W,H;\n\nbool flag[70][70][70];\nstring dp[70][70][70];\nstring mat[70];\n\nstring max_str(string s1, string s2) {\n    string s11(s1);\n    string s22(s2);\n    reverse(all(s11));\n    reverse(all(s22));\n    if(s11.size() == s22.size()) {\n        return s11 > s22?s1:s2;\n    }\n    else return s11.size() > s22.size() ? s1 : s2;\n}\nstring dfs(int y, int x,int c) {\n    if(flag[y][x][c]) return dp[y][x][c];\n    string res=\"\";\n\n    rep(i,2) {\n        int ny=y+dy[i];\n        int nx=x+dx[i];\n        if(!(0<=ny&&ny<H)) continue;\n        if(!(0<=nx&&nx<W)) continue;\n        if(!('0'<=mat[ny][nx]&&mat[ny][nx]<='9')) continue;\n        res=max_str(res,dfs(ny,nx,c+1)+mat[ny][nx]);\n\n    }\n\n    flag[y][x][c]=true;\n    return dp[y][x][c]=res;\n}\n\nvoid solve() {\n    rep(i,70) rep(j,70) rep(a,70) flag[i][j][a]=false;\n    rep(i,70) rep(j,70) rep(a,70) dp[i][j][a]=\"\";\n    rep(i,70) mat[i]=\"\";\n    rep(i,H) cin>>mat[i];\n    string ans=\"\";\n    rep(i,H) rep(j,W) if('1'<=mat[i][j]&&mat[i][j]<='9') {\n        string s=\"a\";\n        s[0]=mat[i][j];\n        ans=max_str(ans,dfs(i,j,0)+s);\n    }\n\n    reverse(all(ans));\n    cout<<ans<<endl;\n}\n\nint main() {\n    while(cin>>W>>H) {\n        if(W+H==0) break;\n        solve();\n\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <map>\n#include <algorithm>\n#include <queue>\n#include <unordered_map>\n\n#define lli long long int\n#define REP(i,n) for(lli i=0;i<n;i++)\n\n#define NUM 1000000\n\nusing namespace std;\n\nint length = 0;\n\nint max1(int a, int b){\n\tif (a >= b)return a;\n\telse return b;\n}\n\nint isIn(int x, int y, int w, int h){\n\tif (x < 0 || w <= x || y < 0 || h <= y){\n\t\treturn 0;\n\t}\n\telse{\n\t\treturn 1;\n\t}\n}\n\nint isNum(int x, int y, string *data){\n\tif ('0' <= data[y].at(x) && data[y].at(x) <= '9'){\n\t\treturn 1;\n\t}\n\telse{\n\t\treturn 0;\n\t}\n}\n\nstring emitZero(string str){\n\n\tstring rStr = \"\";\n\tREP(i, str.size()){\n\t\tif (str.at(i) != '0'){\n\t\t\trStr = str.substr(i, str.size());\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn rStr;\n\n}\n\nstring largeStr(string a, string b){\n\tif (a.size() > b.size()){\n\t\treturn a;\n\t}\n\telse if (a.size() == b.size()){\n\t\tif (a >= b){\n\t\t\treturn a;\n\t\t}\n\t\telse{\n\t\t\treturn b;\n\t\t}\n\t}\n\telse{\n\t\treturn b;\n\t}\n}\n\n\n/*\nvoid solve(int x, int y,int w,int h,string now,string *data, vector<string> *v,int **flag){\n\t\n\tif (!isIn(x,y,w,h) || isNum(x,y,data)==0){\n\t\t//cout << now << endl;\n\t\tnow = emitZero(now);\n\t\t//cout << now << endl;\n\t\t//cout << \"now.size = \" << now.size() << endl;\n\t\tlength = max1(length, now.size());\n\t\tv->push_back(now);\n\t\treturn;\n\t}\n\telse{\n\t\tflag[y][x] = 1;\n\t\tstring next = now + data[y].at(x);\n\t\tsolve(x + 1, y, w, h, next, data, v,flag);\n\t\tsolve(x, y + 1, w, h, next, data, v,flag);\n\t}\n}\n*/\n\nclass Point{\n\nprivate:\n\tint x, y;\npublic:\n\tvoid set(int sX, int sY){\n\t\tx = sX;\n\t\ty = sY;\n\t}\n\tint getX(){ return x; }\n\tint getY(){ return y; }\n\n\tbool operator < (const Point & right)const{\n\t\treturn x + y*NUM < right.x + right.y*NUM;\n\t}\n\n\tvoid show(){\n\t\tcout << \"X=\" << x << \" Y=\" << y << endl;\n\t}\n};\n\nclass now{\nprivate:\n\tPoint p;\n\tstring str;\npublic:\n\n\tvoid set(int sX, int sY, string sStr){\n\t\tp.set(sX, sY);\n\t\tstr = sStr;\n\t}\n\n\tPoint getPoint(){ return p; }\n\tstring getStr(){ return str; }\n\n};\n\nint main(){\n\n\n\t\n\tint w, h;\n\n\twhile (cin >> w >> h){\n\t\tif (w == 0 && h == 0)break;\n\t\tlength = 0;\n\t\tstring *data;\n\t\tdata = new string[h];\n\n\t\tREP(i, h){\n\t\t\tcin >> data[i];\n\t\t}\n\t\tint **flag = new int *[h];\n\t\tREP(i, h){\n\t\t\tflag[i] = new int[w];\n\t\t}\n\t\tvector<string> v;\n\t\tqueue<Point> q;\n\t\tstring firstStr;\n\t\tmap<Point, string> m;\n\t\tPoint p;\n\t\tp.set(w - 1, h - 1);\n\t\tq.push(p);\n\t\t//q.front().show();\n\n\t\tREP(i, 100){\n\t\t\tREP(j, 100){\n\t\t\t\tPoint temp;\n\t\t\t\ttemp.set(i, j);\n\t\t\t\tm[temp] = \"\";\n\t\t\t}\n\t\t}\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tflag[i][j] = 0;\n\t\t\t}\n\t\t}\n\n\t\twhile (q.size() != 0){\n\n\t\t\tint unko;\n\t\t\t//cin >> unko;\n\t\t\tp = q.front();\n\t\t\tq.pop();\n\t\t\tflag[p.getY()][p.getX()] = 1;\n\t\t\t//p.show();\n\n\n\t\t\tif (isNum(p.getX(), p.getY(), data) == 1){\n\t\t\t\tPoint right, down;\n\t\t\t\tright.set(p.getX() + 1, p.getY());\n\t\t\t\tdown.set(p.getX(), p.getY() + 1);\n\n\t\t\t\t//cout << data[p.getY()][p.getX()] << endl;\n\n\t\t\t\tm[p] = largeStr(m[p],data[p.getY()][p.getX()]+largeStr(m[right], m[down]));\n\t\t\t\t//cout << m[p] << endl;\n\t\t\t}\n\n\t\t\tif (p.getX() - 1 >= 0 && flag[p.getY()][p.getX()-1]==0){\n\t\t\t\tPoint left;\n\t\t\t\tleft.set(p.getX() - 1, p.getY());\n\t\t\t\tq.push(left);\n\t\t\t\tflag[left.getY()][left.getX()] = 1;\n\t\t\t}\n\t\t\tif (p.getY() - 1 >= 0 && flag[p.getY()-1][p.getX()]==0){\n\t\t\t\tPoint up;\n\t\t\t\tup.set(p.getX(), p.getY() - 1);\n\t\t\t\tq.push(up);\n\t\t\t\tflag[up.getY()][up.getX()] = 1;\n\t\t\t}\n\t\t}\n\n\t\tint length = 0;\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tPoint tmp;\n\t\t\t\ttmp.set(j, i);\n\t\t\t\tstring tmpStr = m[tmp];\n\t\t\t\ttmpStr = emitZero(tmpStr);\n\n\t\t\t\tv.push_back(tmpStr);\n\t\t\t\tlength = max1(length, tmpStr.size());\n\t\t\t}\n\t\t}\n\n\t\tvector<string> ans;\n\n\t\tREP(i, v.size()){\n\t\t\tif (length == v.at(i).size()){\n\t\t\t\tans.push_back(v[i]);\n\t\t\t}\n\t\t}\n\n\t\tsort(ans.begin(), ans.end());\n\n\t\tcout << ans.back() << endl;\n\n\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nstring fillzero(string);\n\nint main() {\n  int h, w;\n  while(cin >> w >> h, w || h) {\n    vector<vector<char> > field(h + 2, vector<char>(w + 2, 'x'));\n    for(int y = 0; y < h; ++y) for(int x = 0; x < w; ++x) {\n      char c;\n      cin >> c;\n      field[y + 1][x + 1] = ((0 <= c - '0' && c - '0' <= 9) ? c : 'x');\n    }\n    // for(int y = 0; y < h + 2; ++y, cout << endl) for(int x = 0; x < w + 2; ++x) cout << field[y][x];\n    vector<string> codes;\n    set<pair<int, int> > looked;\n    function<void(string, int, int)> putupCodes = [&](string num, int y, int x) {\n      looked.insert(make_pair(y, x));\n      num += field[y][x];\n      if(field[y + 1][x] != 'x') putupCodes(num, y + 1, x);\n      if(field[y][x + 1] != 'x') putupCodes(num, y, x + 1);\n      if(field[y + 1][x] == 'x' && field[y][x + 1] == 'x') codes.push_back(num);\n    };\n    for(int y = 0; y < h; ++y) for(int x = 0; x < w; ++x) {\n      if(field[y][x] != 'x' && field[y][x] != '0' && looked.count(make_pair(y, x)) == 0) putupCodes(\"\", y, x);\n    }\n    sort(begin(codes), end(codes), [](const string &left, const string &right) {\n      return fillzero(left) > fillzero(right);\n    });\n    // for(auto&& code : codes) cout << code << endl;\n    cout << codes[0] << endl;\n  }\n  return 0;\n}\n\nstring fillzero(string str) {\n  stringstream ss;\n  ss << setw(70) << setfill('0') << str;\n  return ss.str();\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <algorithm>\n#include <complex>\n#include <cstring>\n#include <cstdlib>\n#include <cctype>\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\n\nbool pred(string a, string b) {\n  int i;\n  for (i=0; a[i] == '0'; i++);\n  a = a.substr(i);\n  for (i=0; b[i] == '0'; i++);\n  b = b.substr(i);\n  if (a.length()!=b.length()) return a.length() < b.length();\n  return a < b;\n}\n\nint main() {  \n  int w, h;\n  while(cin >> w >> h, w+h) {\n    char ba[w][h];\n    REP(y,h)\n      REP(x,w)\n        cin >> ba[x][y];\n    \n    string dp[w][h];\n    string ans;\n    REP(y, h) {\n      REP(x, w) {\n        if (isalpha(ba[x][y])) continue;\n        if (x>0) dp[x][y] = dp[x-1][y];\n        if (y>0&&pred(dp[x][y], dp[x][y-1])) dp[x][y] = dp[x][y-1];\n        dp[x][y] += ba[x][y];\n\n        if (pred(ans, dp[x][y])) ans = dp[x][y];\n      }\n    }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nconst int dx[] = {1, 0};\nconst int dy[] = {0, 1};\n\nvector<string> board(80);\nstring memo[80][80];\nint W, H;\n\ninline bool isDigit(int x, int y)\n{\n    if ('0' <= board[y][x] && board[y][x] <= '9')\n        return true;\n    else\n        return false;\n}\n\nstring Rec(int x, int y)\n{\n    if (memo[y][x].size() != 0)\n        return memo[y][x];\n\n    string s, tmp;\n    for (int d = 0; d < 2; ++d) {\n        int nx = x + dx[d];\n        int ny = y + dy[d];\n\n        if (nx < 0 || nx >= W || ny < 0 || ny >= H || !isDigit(nx, ny))\n            continue;\n\n        tmp = Rec(nx, ny);\n        if (tmp.size() > s.size() || (tmp.size() == s.size() && tmp > s))\n            s = tmp;\n    }\n\n    return memo[y][x] = board[y][x] + s;\n}\n\nint main()\n{\n    while (cin >> W >> H, W || H) {\n        // Input\n        for (int i = 0; i < H; ++i)\n            cin >> board[i];\n\n        // Init\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                memo[i][j] = \"\";\n\n        // Solve\n        string tmp, ans;\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                if (isDigit(j, i) && memo[j][i].size() == 0) {\n                    tmp = Rec(j, i);\n                    int index = 0;\n                    while (tmp[index] == '0')\n                        index++;\n                    tmp = tmp.substr(index);\n\n                    if (tmp.size() > ans.size() || (tmp.size() == ans.size() && tmp > ans))\n                        ans = tmp;\n                }\n\n        // Output\n        cout << ans << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  int h, w;\n  while(cin >> w >> h, w || h) {\n    vector<vector<char> > field(h + 2, vector<char>(w + 2, 'x'));\n    for(int y = 0; y < h; ++y) for(int x = 0; x < w; ++x) {\n      char c;\n      cin >> c;\n      field[y + 1][x + 1] = ((0 <= c - '0' && c - '0' <= 9) ? c : 'x');\n    }\n    // for(int y = 0; y < h + 2; ++y, cout << endl) for(int x = 0; x < w + 2; ++x) cout << field[y][x];\n    vector<string> codes;\n    set<pair<int, int> > looked;\n    bool recursionEnd = false;\n    function<void(string, int, int)> putupCodes = [&](string num, int y, int x) {\n      looked.insert(make_pair(y, x));\n      num += field[y + 1][x + 1];\n      if(!recursionEnd && field[y + 2][x + 1] != 'x') putupCodes(num, y + 1, x);\n      if(!recursionEnd && field[y + 1][x + 2] != 'x') putupCodes(num, y, x + 1);\n      if(!recursionEnd && field[y + 2][x + 1] == 'x' && field[y + 1][x + 2] == 'x') {\n        codes.push_back(num);\n        if(num.size() == h + w - 1) recursionEnd = true;\n      }\n    };\n    for(int y = 0; y < h; ++y) for(int x = 0; x < w; ++x) {\n      if(field[y + 1][x + 1] != 'x' && field[y + 1][x + 1] != '0' && looked.count(make_pair(y, x)) == 0) putupCodes(\"\", y, x);\n    }\n    auto fillzero = [&](string str) {\n      stringstream ss;\n      ss << setw(h + w) << setfill('0') << str;\n      return ss.str();\n    };\n    // for(auto&& code : codes) cout << code << endl;\n    sort(begin(codes), end(codes), [&](const string &left, const string &right) {\n      return fillzero(left) > fillzero(right);\n    });\n    cout << codes[0] << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\nclass ln{\nprivate:\n  long long d[10];\n  int len;\npublic:\n  ln(){\n  len=0;\n  for(int i=0;i<10;i++)\n    d[i]=0;\n  }\n  ln big(ln a,ln b){\n    if(a.len>b.len)\n      return a;\n    else if(a.len<b.len)\n      return b;\n    else {\n        for(int i=0;i<10;i++)\n\t  if(a.d[i]>b.d[i])\n\t    return a;\n\t  else if(a.d[i]<b.d[i])\n\t    return b;\n\treturn a;\n    }\n  }\n  void plus(int b){\n    int tmp=len/10;\n    d[tmp]*=10;\n    d[tmp]+=(b-'0');\n      len++;\n  }  \n  void print(){\n    for(int i=0;i<(len-1)/10+1;i++)\n      cout<<d[i];\n    cout<<endl;\n  }\n};\nint main(){\n  int w,h;\n  char input[75][75];\n \n  //\n  while(1){\n  \n    cin>>w>>h;\n    ln out[75][75];\n    ln maxval;\n    if(w==0&&h==0){ cout<<endl;return 0;}\n    for(int i=0;i<w+1;i++)\n      input[0][i]=0;\n    for(int i=1;i<h+1;i++){\n      input[i][0]=0;\n      cin>>(char*)(input[i]+1);\n    }\n    // for(int i=0;i<h+1;i++)\n    //   cout<<input[i]+1<<endl;\n    for(int i=1;i<=w+h;i++)\n      for(int j=1;j<i;j++)\n\tif(input[j][i-j]>='0'&&input[j][i-j]<='9') \n\t  {\n\t    if(j>h||i-j>w) continue;\n\t    out[j][i-j]=out[0][0].big(out[j-1][i-j],out[j][i-j-1]);\n\t    out[j][i-j].plus(input[j][i-j]);    \n\t    //  out[j][i-j].print();\n\t    maxval=out[0][0].big(out[j][i-j],maxval);\n\t  }\n    maxval.print();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \n#define loop(n, i) for(int i=0;i<n;i++)\n\nusing namespace std;\n\nint less_than(string a, string b)\n{\n    int d = a.length() - b.length();\n    if (d) return d < 0;\n    return a < b;\n}\n\nint main()\n{\n    while (1) {\n        int w, h; cin >> w >> h;\n        if (!w) break;\n        vector<string> rows(h+1);\n        loop (h, i) cin >> rows[i];\n\n        string dp[80][80];\n        fill(dp[0], dp[79]+80, \"\");\n\n        for (int i = h-1; i >= 0; i--) {\n            for (int j = w-1; j >= 0; j--) {\n                if (rows[i][j] < 'A') {\n                    dp[i][j] = rows[i][j] + max(dp[i+1][j], dp[i][j+1], less_than);\n                }\n            }\n        }\n\n        string ans = \"\";\n        loop (h, i) loop (w, j) {\n            if (rows[i][j] < 'A' && rows[i][j] != '0') {\n                ans = max(ans, dp[i][j], less_than);\n            }\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define DIGIT(c) (c >= '0' && c <= '9')\n#define F first\n#define S second\n#define INF 1 << 30\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nint W, H;\nvector<vector<string> >dp(70, vector<string>(70));\nchar c[70][71];\n\nstring judge(string a, string b){\n  if(a.size() > b.size()) return a;\n  if(a.size() < b.size()) return b;\n  return max(a, b);\n}\n\nint main(){\n  while(scanf(\"%d%d\", &W, &H) && W+H){\n    rep(i, H) scanf(\"%s\", c[i]);\n\n    rep(i, 70) rep(j, 70) dp[i][j] = \"\";\n    if(DIGIT(c[0][0])) dp[0][0] = c[0][0];\n    REP(i, 1, W) if(DIGIT(c[0][i])) dp[0][i] = dp[0][i-1] + c[0][i];\n    REP(i, 1, H) if(DIGIT(c[i][0])) dp[i][0] = dp[i-1][0] + c[i][0];\n\n    REP(i, 1, H){\n      REP(j, 1, W){\n\tif(!DIGIT(c[i][j])) continue;\n\tdp[i][j] = judge((dp[i-1][j]+c[i][j]), (dp[i][j-1]+c[i][j]));\n\t//\tcout << i << \" \" << j << \" \" << dp[i-1][j]+c[i][j] << \" \" << dp[i][j-1]+c[i][j] << endl;\n      }\n    }\n\n\n    /*    rep(i, H){\n      rep(j, W) cout << dp[i][j] << \" \";\n      puts(\"\");\n      }*/\n\n    string res = \"\";\n    rep(i, H) rep(j, W) res = judge(res, dp[i][j]);\n    if(res[0] == '0') res.erase(res.begin());\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <limits.h>\n#include <math.h>\n#include <bitset>\n#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <iomanip>\n#include <iostream>\n\n#define VARIABLE(x) cerr << #x << \"=\" << x << endl\n#define BINARY(x) static_cast<bitset<16> >(x);\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define REP(i,m,n) for (int i=m;i<(int)(n);i++)\n#define if_range(x, y, w, h) if (0<=(int)(x) && (int)(x)<(int)(w) && 0<=(int)(y) && (int)(y)<(int)(h))\n\nconst int INF = 100000000;\ntypedef double D;\nconst double EPS = 1e-8;\nconst double PI = 3.14159;\nint dx[4]={-1, 0, 1, 0}, dy[4]={0, -1, 0, 1};\nusing namespace std;\ntypedef pair<int, int> P;\n\n/** Problem1126 : The Secret Number **/\nconst int MAX_W = 70;\nint W, H;\nchar field[MAX_W][MAX_W];\nstring dp[MAX_W][MAX_W];\nbool vis[MAX_W][MAX_W];\n\nstring big(string s1, string s2) {\n\tif (s1.length() > s2.length()) {\n\t\treturn s1;\n\t} else if (s2.length() > s1.length()) {\n\t\treturn s2;\n\t} else {\n\t\treturn (s1>s2?s1:s2);\n\t}\n}\n\nstring rec(int x, int y, string n)\n{\n\tif_range(x, y, W, H) {\n\t\tif ('0' <= field[y][x] && field[y][x] <= '9')\n\t\t\tn += field[y][x];\n\t\telse\n\t\t\treturn dp[y][x] = n;\n\t}\n\telse return dp[y][x] = n;\n\t\n\t\n\tif (dp[y][x] != \"\")\n\t\treturn dp[y][x];\n\t\n\tstring s1 = rec(x+1, y, n);\n\tstring s2 = rec(x, y+1, n);\n\t\n\treturn dp[y][x] = big(s1, s2);\n}\n\nint main()\n{\n\twhile (cin>>W>>H, W||H) {\n\t\tfill(dp[0], dp[0]+W*H, \"\");\n\t\tfill(vis[0], vis[0]+W*H, false);\n\t\t\n\t\trep(i, H) {\n\t\t\trep(j, W) {\n\t\t\t\tcin>>field[i][j];\n\t\t\t}\n\t\t}\n\t\t\n\t\tstring ans = \"0\";\n\t\trep(y, H) {\n\t\t\trep(x, W) {\n\t\t\t\tif (!vis[y][x]) {\n\t\t\t\t\tans = big(ans, rec(x, y, \"\"));\n\t\t\t\t\tvis[y][x] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stdio.h>\n#include<string>\nusing namespace std;\nint H,W;\nchar t[700][700],ch;\n\nstring dp[700][700],maxm;\n\nstring strmax(string x,string y){\n  if(x==\"-\"&&y==\"-\")return \"-\";\n  if(x==\"-\")return y;\n  if(y==\"-\")return x;\n  while(x[0]=='0'&&x.size()>=2)x=x.substr(1,x.size()-1);\n  while(y[0]=='0'&&y.size()>=2)y=y.substr(1,y.size()-1);\n  if(x.size()==y.size()){\n    for(int i=0;i<(int)x.size();i++){\n      if(x[i]>y[i]){\n\treturn x;\n      }else if(x[i]<y[i]){\n\treturn y;\n      }\n    }\n    return x;\n  }else if(x.size()>y.size()){\n    return x;\n  }else{\n    return y;\n  }\n}\n\nchar judge(char ch){\n  if('0'<=ch&&ch<='9')return ch;\n  else return '-';\n}\nint main(){\n  int flg;\n  while(cin>>W>>H && W&& H){\n    scanf(\"%c\",&t[0][0]);\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\tdp[i][j]=\"\";\n\tscanf(\"%c\",&t[i][j]);\n\tif(judge(t[i][j])=='-')flg++;\n      }\n      scanf(\"%c\",&ch);\n    }\n    if(flg==H*W){cout<<\"0\"<<endl;continue;}\n    dp[0][0].push_back(judge(t[0][0])); \n    \n    for(int i=1;i<W;i++){\n      if(judge(t[0][i])=='-'){\n\tdp[0][i]=\"-\";\n\tcontinue;\n      }\n      if(dp[0][i-1]!=\"-\")dp[0][i]=dp[0][i-1];      \n      dp[0][i].push_back(judge(t[0][i]));\n    }\n    for(int i=1;i<H;i++){\n      if(judge(t[i][0])=='-'){\n\tdp[i][0]=\"-\";\n\tcontinue;\n      }\n      if(dp[i-1][0]!=\"-\")dp[i][0]=dp[i-1][0];      \n      dp[i][0].push_back(judge(t[i][0]));\n    }\n\n    maxm=\"0\";\n    for(int i=1;i<H;i++){\n      for(int j=1;j<W;j++){\n\tif(judge(t[i][j])=='-'){\n\t  dp[i][j]=\"-\";\n\t  continue;\n\t}\n\t\n\tdp[i][j]=strmax(dp[i-1][j],dp[i][j-1]);\n\tif(dp[i][j]!=\"-\")dp[i][j].push_back(t[i][j]);\n\t\n\n      }\n    }\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\tcout<<t[i][j];\n\tmaxm=strmax(dp[i][j],maxm);\n      }\n      cout<<endl;\n    }\n    cout<<strmax(maxm,maxm)<<endl;\n    \n  }\n  return 0;\n  \n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nbool cmpstring(const string &l, const string &r) {\n  if(l.size() != r.size()) return l.size() < r.size();\n  for(int i = 0; i < l.size(); ++i)\n    if(l[i] != r[i]) return l[i] < r[i];\n  return 0;\n}\n\nstruct data {\n  int x, y;\n  string s;\n};\n\nbool operator<(const data &l, const data &r) {\n  if(l.s != r.s) return cmpstring(l.s, r.s);\n  if(l.x != r.x) return l.x > r.x;\n  return l.y > r.y;\n}\n\nint w, h;\nvector<string> s;\nstring dist[80][80];\nint d[2] = {0, 1};\npriority_queue<data> pq;\n\nstring solve();\nbool ch(const data &now) {\n  return now.x >= 0 && now.x < h && now.y >= 0 &&\n         now.y < w && s[now.x][now.y] >= '0' &&\n         s[now.x][now.y] <= '9';\n}\n\nint main() {\n  while(1) {\n    cin >> w >> h;\n    if(w + h == 0) break;\n    s.resize(h);\n    for(int i = 0; i < h; ++i) cin >> s[i];\n    cout << solve() << endl;\n  }\n  return 0;\n}\n\nstring solve() {\n  string ans = \"\";\n  for(int i = 0; i < h; ++i)\n    for(int j = 0; j < w; ++j) {\n      dist[i][j] = \"X\";\n      if(s[i][j] >= '1' && s[i][j] <= '9') {\n        string pushs;\n        pushs += s[i][j];\n        dist[i][j] = pushs;\n        pq.push({i, j, pushs});\n        ans = max(ans, pushs);\n      }\n      else if(s[i][j] == '0') {\n        dist[i][j] = \"\";\n        ans = \"0\";\n        pq.push({i, j, \"\"});\n      }\n    }\n  while(!pq.empty()) {\n    data now = pq.top();\n    pq.pop();\n    if(dist[now.x][now.y] != now.s) continue;\n    for(int i = 0; i < 2; ++i) {\n      data nextp = now;\n      nextp.x += d[i];\n      nextp.y += d[1 ^ i];\n      if(!ch(nextp)) continue;\n      if(nextp.s.size() != 0 || s[nextp.x][nextp.y] != '0')\n        nextp.s += s[nextp.x][nextp.y];\n      if(dist[nextp.x][nextp.y] == \"X\" ||\n         cmpstring(dist[nextp.x][nextp.y], nextp.s)) {\n        dist[nextp.x][nextp.y] = nextp.s;\n        pq.push(nextp);\n        if(cmpstring(ans, nextp.s)) ans = nextp.s;\n      }\n    }\n  }\n  return ans;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n#define pb push_back \n#define pf push_front \n#define mp make_pair\n#define fr first\n#define sc second\n#define Rep(i, n) for ( int i = 0 ; i < (n); i++ )\n#define All(v) v.begin(), v.end()\n\ntypedef pair<int, int> Pii; typedef pair<int, Pii> Pip;\nconst int INF = 1107110711071107;\n\nint used[71][71];\nchar c[71][71];\nstring ans;\nint h, w;\n\nvoid func(string now, int y, int x) {\n  //cout << now << \" \" << y << \" \" << x << endl;\n  if ( ans.size() < now.size() ) ans = now;\n  else if ( ans.size() <= now.size() )   ans = max(ans, now);\n  if ( used[y][x] > now.size() ) return;\n  used[y][x] = now.size();\n  int ny = y + 1, nx = x;\n  if ( !(ny < 0 || nx < 0 || ny >= h || nx >= w) ) { \n    if ( '0' <= c[ny][nx] && c[ny][nx] <= '9' ) func(now+c[ny][nx], ny, nx);\n  }\n  ny = y; nx = x + 1;\n  if ( !(ny < 0 || nx < 0 || ny >= h || nx >= w) ) {\n    if ( '0' <= c[ny][nx] && c[ny][nx] <= '9' ) func(now+c[ny][nx], ny, nx);\n  }\n}\n\nsigned main() {  \n  while ( cin >> w >> h, w | h ) {\n    memset(used, 0, sizeof(used));\n    ans = \"\";\n    Rep(i, h) Rep(j, w) cin >> c[i][j];\n    \n    Rep(i, h) Rep(j, w) {\n      if ( used[i][j] > 0 ) continue;\n      if ( '1' <= c[i][j] && c[i][j] <= '9' ) {\n\tstring s = \"\";\n\ts += c[i][j];\n\tfunc(s, i, j);\t\n      }\n    }\n\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,n) for (int (i)=(0);(i)<(int)(n);++(i))\nusing ll = long long;\nusing P = pair<int, int>;\nusing namespace std;\n\ntemplate<class T> void vin(vector<T>& v, int n) {\n    v.resize(n);\n    for (int i = 0; i < n; ++i) {\n        cin >> v[i];\n    }\n}\n\nint W, H;\nstring b[101];\nint d[101][101];\nint dr[] = { 0, 1 };\nint dc[] = { 1, 0 };\n\nvoid solve1(int r, int c) {\n    P p(r, c);\n    queue<P> que;\n    que.push(p);\n    while (que.size()) {\n        P p = que.front();\n        que.pop();\n        rep(dd, 2) {\n            int nr = p.first + dr[dd], nc = p.second + dc[dd];\n            if (0 <= nr and nr < H and 0 <= nc and nc < W and '0' <= b[nr][nc] and b[nr][nc] <= '9') {\n                if (d[p.first][p.second]+1 > d[nr][nc]) {\n                    que.push(P(nr, nc));\n                    d[nr][nc] = d[p.first][p.second]+1;\n                }\n            }\n        }\n    }\n}\n\nstring ans = \"\";\nvoid solve2(int r, int c, string t) {\n    t += b[r][c];\n    if (d[r][c] == 0) {\n        if (ans.size() < t.size()) {\n            ans = t;\n        }\n        else if (ans.size() == t.size()) {\n            for (int i=ans.size()-1; i>=0; --i) {\n                if (ans[i] > t[i]) break;\n                else if (ans[i] < t[i]) { ans = t; break; }\n            }\n        }\n        return;\n    }\n\n    rep(dd, 2) {\n        int nr = r - dr[dd], nc = c - dc[dd];\n        if (0 <= nr and nr < H and 0 <= nc and nc < W and d[nr][nc] == d[r][c]-1) {\n            solve2(nr, nc, t);\n        }\n    }\n}\n\nint main() {\n    while (cin >> W >> H and W and H) {\n        rep(r, H) cin >> b[r];\n        fill(d[0], d[101], -1);\n        rep(r, H) rep(c, W) {\n            if ('1' <= b[r][c] and b[r][c] <= '9' and d[r][c] == -1) {\n                d[r][c] = 0;\n                solve1(r, c);\n            }\n        }\n        int max_len = 0;\n        rep(r, H) rep(c, W) max_len = max(max_len, d[r][c]);\n        ans = \"\";\n        rep(r, H) rep(c, W) {\n            if (d[r][c] == max_len) {\n                solve2(r, c, \"\");\n            }\n        }\n        reverse(ans.begin(), ans.end());\n        cout << ans << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nint main(){\n\tstring dp[70][70];\n\tstring max,ans;\n\tchar c[70][70];\n\tint w,h,i,j;\n\twhile(cin>>w>>h &&(w|h)){\n\t\tans=\"\";\n\t\tfor(i=0;i<h;i++){\n\t\t\tfor(j=0;j<w;j++)cin>>c[i][j];\n\t\t}\n\t\tfor(i=0;i<h;i++){\n\t\t\tfor(j=0;j<w;j++)dp[i][j].clear();\n\t\t}\n\t\tfor(i=0;i<h;i++){\n\t\t\tfor(j=0;j<w;j++){\n\t\t\t\tif(c[i][j]<'0'||'9'<c[i][j])continue;\n\t\t\t\tmax = \"\";\n\t\t\t\tif(0<i)max = dp[i-1][j];\n\t\t\t\tif(0<j && (max.length()<dp[i][j-1].length()\n\t\t\t\t\t|| max.length()==dp[i][j-1].length() && max<dp[i][j-1]) )\n\t\t\t\t\tmax= dp[i][j-1];\n\t\t\t\tif(max==\"\" &&  c[i][j]=='0')continue;\n\t\t\t\tdp[i][j] = max+c[i][j];\n\t\t\t\tif(ans.length() < dp[i][j].length()\n\t\t\t\t\t|| ans.length() == dp[i][j].length() && ans<dp[i][j]){\n\t\t\t\t\tans=dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\n#include <ctype.h>\n#include <string> \n#include <cstring>\n#include <sstream>\n#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <map>\n#include <queue>\n#include <utility>\n#include <vector>\n#include <set>\n#include <iomanip>\n#include <stack>\n  \nusing namespace std;\n\n#define pi 3.141592653589793\n\n#define MAX 1000000000\n\nbool ismax(string comp1, string comp2)\n{\n\t// 第一引数の方が大きい場合true\n\twhile(comp1[0] == '0') comp1.erase(0, 1);\n\twhile(comp2[0] == '0') comp2.erase(0, 1);\n\tif(comp1.length() > comp2.length()) return true;\n\telse if(comp1.length() == comp2.length()){\n\t\tint n = 0;\n\t\twhile(n < comp1.length() && comp1[n] == comp2[n]){\n\t\t\tn++;\n\t\t}\n\t\tif(n == comp1.length() || comp1[n] - '0' > comp2[n] - '0') return true;\n\t\telse return false;\n\t} else return false;\n}\n\nstring solve(int w, int h, char c[71][71])\n{\n\tstring ans = \"\";\n\tstring result[72][72];\n\tresult[h][w] = \"\";\n\tif(isdigit(c[h][w])) result[h][w] += c[h][w];\n\tfor(int i = h; i > 0; i--){\n\t\tresult[i][w + 1] = \"\";\n\t}\n\tfor(int i = w; i > 0; i--){\n\t\tresult[h + 1][i] = \"\";\n\t}\n\tfor(int i = h; i > 0; i--){\n\t\tfor(int j = w; j > 0; j--){\n\t\t\tresult[i][j] = \"\";\n\t\t\tif(isdigit(c[i][j])){\n\t\t\t\tresult[i][j] += c[i][j];\n\t\t\t\tif(ismax(result[i + 1][j], result[i][j + 1])) result[i][j] += result[i + 1][j];\n\t\t\t\telse result[i][j] += result[i][j + 1];\n\t\t\t\tif(ismax(result[i][j], ans)) ans = result[i][j];\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i = 1; i < h + 1; i++){\n\t\tfor(int j = 1; j < w + 1; j++){\n\t\t\tcout << result[i][j] << \"/\";\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn ans;\n}\n\n\nint main()\n{\n\tint w, h;\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(w == 0 && h == 0) break;\n\t\tchar c[71][71];\n\t\tfor(int i = 1; i < h + 1; i++){\n\t\t\tfor(int j = 1; j < w + 1; j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t}\n\t\t\tcout << endl;\n\t\t}\n\t\tcout << solve(w, h, c) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i, n) for(int i=0; i<(n); ++i)\n\nchar C[71][71];\nstring memo[71][71];\nint W, H;\nbool isNum(char c) {\n    if(c >= '0' && c <= '9') return true;\n    else return false;\n}\nstring max_str(string a, string b) {\n    if (a.size() > b.size()) return a;\n    if (a.size() < b.size()) return b;\n    return max(a, b);\n}\nstring dfs(int y, int x) {\n    if(memo[y][x] != \"\") return memo[y][x];\n    if((y+1>=H || !isNum(C[y+1][x])) && (x+1>=W || !isNum(C[y][x+1]))) {\n        memo[y][x] = C[y][x];\n        return memo[y][x];\n    }\n    string ans = \"\";\n    if(y+1<H && isNum(C[y+1][x])) ans = max_str(ans, C[y][x]+dfs(y+1, x));\n    if(x+1<W && isNum(C[y][x+1])) ans = max_str(ans, C[y][x]+dfs(y, x+1));\n    memo[y][x] = ans;\n    return memo[y][x];\n}\n\nint main(void){\n    while(cin >> W >> H && W) {\n        rep(i, H) rep(j, W) {\n            cin >> C[i][j];\n            memo[i][j] = \"\";\n        }\n        string ans;\n        for(int i=H-1; i>=0; --i) {\n            for(int j=W-1; j>=0; --j) {\n                if(isNum(C[i][j]) && C[i][j]!='0') {\n                    ans = max_str(ans, dfs(i, j));\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr, __VA_ARGS__)\n// #define LOG(...)\n#define FOR(i, a, b) for(int i = (int)(a); i < (int)(b); ++i)\n#define REP(i, n) for(int i = 0; i < (int)(n); ++i)\n#define RREP(i, n) for(int i = (int)(n - 1); i >= 0; --i)\n#define RFOR(i, a, b) for(int i = (int)(b - 1); i >= (int)(a); --i)\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EXIST(s, e) ((s).find(e) != (s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n#define SQ(n) (n) * (n)\n#define BIT(x, i) (((x) >> (i)) & 1)\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<char> vc;\ntypedef vector<pii> vpi;\ntypedef vector<pll> vpl;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vc> vvc;\ntypedef vector<vll> vvll;\n\nchar field[70][70];\nstring dp[70][70];\n\nstring strmax(string a, string b) {\n  if (a.length() > b.length()) return a;\n  if (a.length() < b.length()) return b;\n  return max(a, b);\n}\n\nint dx[] = {-1, 0};\nint dy[] = {0, -1};\n\nint main() {\n  int w, h;\n  while(cin >> w >> h, w) {\n    fill_n((char*)field, 70 * 70, ' ');\n    fill_n((string*)dp, 70 * 70, \"\");\n    REP(y, h) REP(x, w) {\n      cin >> field[y][x];\n    }\n    dp[h - 1][w - 1] = field[h - 1][w - 1];\n\n    string maxs = \"\";\n    RREP(y, h) RREP(x, w) {\n      REP(i, 2){\n        int sx = x + dx[i];\n        int sy = y + dy[i];\n        if (sx < 0 || sx >= w || sy < 0 || sy >= h) continue;\n        if (isnumber(field[y][x]) && isnumber(field[sy][sx])) {\n          dp[sy][sx] = strmax(dp[sy][sx], field[sy][sx] + dp[y][x]);\n          // maxs = strmax(maxs, dp[sy][sx]);\n        }\n      }\n    }\n\n    REP(y, h) REP(x, w) {\n      while(*dp[y][x].begin() == '0') dp[y][x].erase(dp[y][x].begin());\n      maxs = strmax(maxs, dp[y][x]);\n    }\n    cout << maxs << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint W;\nint H;\nchar C[114][114];\nstring dp[114][114];\n\nstring ans;\n\nbool cmp(string &a, string &b) {\n  if (a.size() != b.size()) return a.size() < b.size();\n  for (int i=0; i<a.size(); i++) {\n    if (a[i] != b[i]) return a[i] < b[i];\n  }\n  return false;\n}\n\nint Convert2Int(char c) {\n  if ('0' <= c && c <= '9') return c - '0';\n  return -1; \n}\n\nint main() {\n  while (1) {\n    scanf(\"%d%d\", &W, &H);\n    if ((W|H) == 0) return 0;\n\n    for (int i=1; i<=H; i++) {\n      for (int j=1; j<=W; j++) {\n        scanf(\" %c\", &C[i][j]);\n        dp[i][j] = \"\";\n      }\n    }\n  \n    ans = \"\";\n    for (int i=1; i<=H; i++) {\n      for (int j=1; j<=W; j++) {\n        if (Convert2Int(C[i][j]) == -1) continue; \n        if (cmp(dp[i-1][j], dp[i][j-1])) {\n          dp[i][j] = dp[i][j-1] + C[i][j];\n        } else {\n          dp[i][j] = dp[i-1][j] + C[i][j];\n        }\n        if (dp[i][j] == \"0\") dp[i][j] = \"\";\n\n        if (cmp(ans, dp[i][j])) ans = dp[i][j];\n      }\n    }\n    printf(\"%s\\n\", ans.c_str());\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\nconst int dx[] = {1, 0};\nconst int dy[] = {0, 1};\n\nvector<string> board(70);\nint W, H;\nint len;\nstring ans;\nint cnt;\n\ninline bool isDigit(int x, int y)\n{\n    if ('0' <= board[y][x] && board[y][x] <= '9')\n        return true;\n    else\n        return false;\n}\n\nvoid Rec(int x, int y, string s)\n{\n    if (x < 0 || x >= W || y < 0 || y >= H || !isDigit(x, y)) {\n        if (s.size() > len || (s.size() == len && s > ans)) {\n            ans = s;\n            len = s.size();\n        }\n        return ;\n    }\n\n    s += board[y][x];\n    for (int d = 0; d < 2; ++d) {\n        int nx = x + dx[d];\n        int ny = y + dy[d];\n\n        Rec(nx, ny, s);\n    }\n}\n\nint main()\n{\n    while (cin >> W >> H, W || H) {\n        len = 0;\n\n        for (int i = 0; i < H; ++i)\n            cin >> board[i];\n\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                if (isDigit(j, i))\n                    Rec(j, i, \"\");\n        int index = 0;\n        while (ans[index] == '0')\n            index++;\n        cout << ans.substr(index) << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cctype>\n\nusing namespace std;\n\nstring max(string a, string b){\n    if(a.size()>b.size()) return a;\n    if(a.size()<b.size()) return b;\n    for(int i=0;i<a.size();i++){\n        if(a[i] > b[i]) return a;\n        if(a[i] < b[i]) return b;\n    }\n    return a;\n}\n\nint main(void){\n  int w,h;\n  string grid[71],dp[71][71];\n\n  while(cin >> w >> h,w|h){\n    for(int i=0;i<71;i++)\n      for(int j=0;j<71;j++)dp[i][j].clear();\n\n    for(int i=0;i<h;i++)cin >> grid[i];\n\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(!isupper(grid[i][j])){\n\t  dp[i][j]=grid[i][j];\n\t  string a=\"\",b=\"\";\n\t  if(i>0 && !dp[i-1][j].empty())a=dp[i-1][j]+grid[i][j];\n\t  if(j>0 && !dp[i][j-1].empty())b=dp[i][j-1]+grid[i][j];\n\t  \n\t  while(a[0]=='0') a.erase(a.begin());\n\t  while(b[0]=='0') b.erase(b.begin());\n\n\t  dp[i][j]=max(dp[i][j],max(a,b));\n\t}\n      }\n    }\n\n    string s=\"\";\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\ts=max(s,dp[i][j]);\n      }\n    }\n    cout << s << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\nint w,h;\nstring str[71];\nstring mp[71][71];\n\nint check(string a,string b) {\n  //  cout << a <<\" | \"<<b<<endl;\n  \n  if(a.size() < b.size()) return 1;\n  if(a.size() > b.size()) return 2;\n\n  for(int i=0;i<a.size();i++) {\n    if(a[i]-'0' < b[i]-'0') return 1;\n    if(a[i]-'0' > b[i]-'0') return 2;\n  }\n  \n  return 2;\n}\n\nint main() {\n\n\n  while(1) {\n    cin>> w >> h;\n    if(w == 0 && h == 0) break;\n    for(int i=0;i<h;i++) cin >> str[i];\n  \n    for(int i=0;i<h;i++)\n      for(int j=0;j<w;j++){\n\tif('0'<=str[i][j] && str[i][j] <='9') mp[i][j] = str[i][j];\n\telse mp[i][j] = \"x\";\n      }\n\n\n\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++) {\n\tif(mp[i][j]==\"x\") continue;\n\tstring t = mp[i][j];\n\tint flg = 0;\n\tif(j-1 >=0 && '0'<=mp[i][j-1][0] && mp[i][j-1][0] <='9' && mp[i][j-1] !=\"0\"){\n\t  mp[i][j] = mp[i][j-1]+t;\n\t  //cout <<mp[i][j] <<endl;\n\t  flg = 1;\n\t}\n\tif(i-1 >=0 && '0'<=mp[i-1][j][0] && mp[i-1][j][0] <='9'&&mp[i-1][j] !=\"0\"){\n\t  if(flg == 1) {\n\t    if(check(mp[i][j],mp[i-1][j]+t) == 1) mp[i][j] = mp[i-1][j]+t;\n\t  } else mp[i][j] = mp[i-1][j] + t;\n\t  // cout << mp[i-1][j]+t<<endl;\n\t}\n      }\n    }\n\n    string ans=\"0\";\n    for(int i=h-1;i>=0;i--) {\n      for(int j=w-1;j>=0;j--) {\n\tif(mp[i][j] == \"x\") continue;\n\tif(check(ans,mp[i][j]) == 1) ans = mp[i][j];\n      }\n    }\n\n    cout << ans <<endl;\n  }\n  \n      \n  return 0;    \n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nstruct UnionFind {\n\tvector<int> v;\n\tUnionFind(int n) : v(n) { for (int i = 0; i < n; i++) v[i] = i; }\n\tint  find(int x) { return v[x] == x ? x : v[x] = find(v[x]); }\n\tvoid unite(int x, int y) { v[find(x)] = find(y); }\n};\nstring comp(string s1, string s2) {\n\tif (s1.length() > s2.length())\n\t\treturn s1;\n\tif (s1.length() < s2.length())\n\t\treturn s2;\n\tif (s1 > s2)\n\t\treturn s1;\n\telse\n\t\treturn s2;\n}\nint main() {\n\tint w, h;\n\twhile (cin >> w >> h, w) {\n\t\tvector<string> wards(h);\n\t\tREP(i, h) {\n\t\t\tcin >> wards[i];\n\t\t}\n\t\tvector<vector<string>> memo(h, vector<string>(w,\"\"));\n\t\tfor (int i = h - 1;i >= 0;i--)\n\t\t\tfor (int j = w - 1;j >= 0;j--) {\n\t\t\t\tif (isdigit(wards[i][j])) {\n\t\t\t\t\tmemo[i][j] = wards[i][j];\n\t\t\t\t\tif (i != h - 1)\n\t\t\t\t\t\tmemo[i][j]=comp(wards[i][j] + memo[i + 1][j], memo[i][j]);\n\t\t\t\t\tif (j != w - 1)\n\t\t\t\t\t\tmemo[i][j] = comp(wards[i][j] + memo[i][j + 1], memo[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\tstring ans = \"\";\n\t\tREP(i, h)\n\t\t\tREP(j, w)\n\t\t\tif(memo[i][j][0]!='0')\n\t\t\tans = comp(ans, memo[i][j]);\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define _CRT_SECURE_NO_WARNINGS\n#include \"bits/stdc++.h\"\n#define rep(i, n) for (int i = 0; i < (n); ++i)\n#define FOR(i, m, n) for (int i = (m); i < (n); ++i)\n#define rrep(i, n) for (int i = (n) - 1; i >= 0; --i)\n#define rfor(i, m, n) for (int i = (m); i >= (n); --i)\n#define sz(x) ((int)(x).size())\n#define all(x) (x).begin(),(x).end()\n#define rall(x) (x).rbegin(),(x).rend()\n#define range_it(a, l, r) (a).begin() + (l), (a).begin() + (r)\n\nusing namespace std;\nusing ll = long long;\t\tusing ld = long double;\nusing VB = vector<bool>;\tusing VVB = vector<VB>;\nusing VI = vector<int>;\t\tusing VVI = vector<VI>;\nusing VL = vector<ll>;\t\tusing VVL = vector<VL>;\nusing VS = vector<string>;\tusing VD = vector<ld>;\nusing PII = pair<int, int>;\tusing VP = vector<PII>;\nusing PLL = pair<ll, ll>;\tusing VPL = vector<PLL>;\ntemplate<class T>using PQ = priority_queue<T>;\ntemplate<class T>using PQS = priority_queue<T, vector<T>, greater<T>>;\nconstexpr int inf = (int)1e9;\nconstexpr ll inf_ll = (ll)1e18, MOD = 1000000007;\nconstexpr ld PI = M_PI, EPS = 1e-12;\n\n// --- input --- //\n#ifdef _WIN32\n#define getchar_unlocked _getchar_nolock\n#define putchar_unlocked _putchar_nolock\n#define fwrite_unlocked fwrite\n#define fflush_unlocked _fflush_nolock\n#endif\ninline int gc() { return getchar_unlocked(); }\ntemplate<class T>inline void InputF(T& v) { cin >> v; }\ninline void InputF(char& v) { while (isspace(v = gc())); }\ninline void InputF(bool& v) { char c; InputF(c); v = c != '0'; }\ninline void InputF(string& v) {\n\tv.clear(); char c; for (InputF(c); !isspace(c); c = gc())v += c;\n}\ninline void InputF(int& v) {\n\tbool neg = false; v = 0; char c; InputF(c);\n\tif (c == '-') { neg = true; c = gc(); }\n\tfor (; isdigit(c); c = gc())v = v * 10 + (c - '0');\n\tif (neg)v = -v;\n}\ninline void InputF(long long& v) {\n\tbool neg = false; v = 0; char c; InputF(c);\n\tif (c == '-') { neg = true; c = gc(); }\n\tfor (; isdigit(c); c = gc())v = v * 10 + (c - '0');\n\tif (neg)v = -v;\n}\ninline void InputF(double& v) {\n\tdouble dp = 1; bool neg = false, adp = false; v = 0; char c; InputF(c);\n\tif (c == '-') { neg = true; c = gc(); }\n\tfor (; isdigit(c) || c == '.'; c = gc()) {\n\t\tif (c == '.')adp = true;\n\t\telse if (adp)v += (c - '0') * (dp *= 0.1);\n\t\telse v = v * 10 + (c - '0');\n\t}\n\tif (neg)v = -v;\n}\ntemplate<class T, class U>inline void InputF(pair<T, U>& v) {\n\tInputF(v.first); InputF(v.second);\n}\ntemplate<class T>inline void InputF(vector<T>& v) {\n\tfor (auto& e : v)InputF(e);\n}\ntemplate<class T>inline T InputF() { T v; InputF(v); return v; }\ninline string GetLine() {\n\tstring v; char c; for (InputF(c); c != '\\n' && c != '\\0'; c = gc())v += c; return v;\n}\nstruct InputV {\n\tint n, m;\n\tInputV(int N) :n(N), m(0) {}\n\tInputV(pair<int, int> N) :n(N.first), m(N.second) {}\n\ttemplate<class T>operator vector<T>() {\n\t\tvector<T> v(n); InputF(v); return v;\n\t}\n\ttemplate<class T>operator vector<vector<T>>() {\n\t\tvector<vector<T>> v(n, vector<T>(m)); InputF(v); return v;\n\t}\n};\nstruct Input {\n\ttemplate<class T>operator T() { return InputF<T>(); }\n\tint operator--(int) { int v; InputF(v); v--; return v; }\n\tInputV operator[](int n) { return InputV(n); }\n\tInputV operator[](pair<int, int> n) { return InputV(n); }\n\tvoid operator()() {}\n\ttemplate<class H, class...T>void operator()(H&& h, T&& ...t) {\n\t\tInputF(h); operator()(forward<T>(t)...);\n\t}\n\ttemplate<class T>Input& operator,(T&& v) {\n\t\tInputF(v); return *this;\n\t}\n}in;\n#define input(T) InputF<T>()\n#define ini input(int)\n#define inl input(ll)\n#define ins input(string)\n#define inputs(T, ...) T __VA_ARGS__; in(__VA_ARGS__)\n#define INT(...) inputs(int, __VA_ARGS__)\n#define LL(...) inputs(ll, __VA_ARGS__)\n#define STR(...) inputs(string, __VA_ARGS__)\n\n// --- output --- //\nstruct BoolStr {\n\tconst char* t, * f; BoolStr(const char* _t, const char* _f) :t(_t), f(_f) {}\n}Yes(\"Yes\", \"No\"), yes(\"yes\", \"no\"), YES(\"YES\", \"NO\"), Int(\"1\", \"0\");\nstruct DivStr {\n\tconst char* d, * l; DivStr(const char* _d, const char* _l) :d(_d), l(_l) {}\n}spc(\" \", \"\\n\"), no_spc(\"\", \"\\n\"), end_line(\"\\n\", \"\\n\"), comma(\",\", \"\\n\"), no_endl(\" \", \"\");\nclass Output {\n\tBoolStr B{ Yes }; DivStr D{ spc };\n\tvoid p(int v) {\n\t\tif (v < 0)putchar_unlocked('-'), v = -v;\n\t\tchar b[10]; int i = 0;\n\t\twhile (v)b[i++] = '0' + v % 10, v /= 10;\n\t\tif (!i)b[i++] = '0';\n\t\twhile (i--)putchar_unlocked(b[i]);\n\t}\n\tvoid p(ll v) {\n\t\tif (v < 0)putchar_unlocked('-'), v = -v;\n\t\tchar b[20]; int i = 0;\n\t\twhile (v)b[i++] = '0' + v % 10, v /= 10;\n\t\tif (!i)b[i++] = '0';\n\t\twhile (i--)putchar_unlocked(b[i]);\n\t}\n\tvoid p(bool v) { p(v ? B.t : B.f); }\n\tvoid p(char v) { putchar_unlocked(v); }\n\tvoid p(const char* v) { fwrite_unlocked(v, 1, strlen(v), stdout); }\n\tvoid p(double v) { printf(\"%.20f\", v); }\n\tvoid p(ld v) { printf(\"%.20Lf\", v); }\n\ttemplate<class T> void p(const T& v) { cout << v; }\n\ttemplate<class T, class U>void p(const pair<T, U>& v) { p(v.first); p(D.d); p(v.second); }\n\ttemplate<class T>void p(const vector<T>& v) { rep(i, sz(v)) { if (i)p(D.d); p(v[i]); } }\n\ttemplate<class T>void p(const vector<vector<T>>& v) { rep(i, sz(v)) { if (i)p(D.l); p(v[i]); } }\npublic:\n\tOutput& operator()() { p(D.l); return *this; }\n\ttemplate<class H>Output& operator()(H&& h) { p(h); p(D.l); return *this; }\n\ttemplate<class H, class...T>Output& operator()(H&& h, T&& ...t) {\n\t\tp(h); p(D.d); return operator()(forward<T>(t)...);\n\t}\n\ttemplate<class...T>void exit(T&& ...t) { operator()(forward<T>(t)...); std::exit(EXIT_SUCCESS); }\n\tOutput& flush() { fflush_unlocked(stdout); return *this; }\n\tOutput& set(const BoolStr& b) { B = b; return *this; }\n\tOutput& set(const DivStr& d) { D = d; return *this; }\n\tOutput& set(const char* t, const char* f) { B = BoolStr(t, f); return *this; }\n}out;\n\n// --- step --- //\ntemplate<class T>struct Step {\n\tclass It {\n\t\tT a, b, c;\n\tpublic:\n\t\tconstexpr It() : a(T()), b(T()), c(T()) {}\n\t\tconstexpr It(T _b, T _c, T _s) : a(_b), b(_c), c(_s) {}\n\t\tconstexpr It& operator++() { --b; a += c; return *this; }\n\t\tconstexpr It operator++(int) { It tmp = *this; --b; a += c; return tmp; }\n\t\tconstexpr const T& operator*()const { return a; }\n\t\tconstexpr const T* operator->()const { return &a; }\n\t\tconstexpr bool operator==(const It& i)const { return b == i.b; }\n\t\tconstexpr bool operator!=(const It& i)const { return !(b == i.b); }\n\t\tconstexpr T start()const { return a; }\n\t\tconstexpr T count()const { return b; }\n\t\tconstexpr T step()const { return c; }\n\t};\n\tconstexpr Step(T b, T c, T s) : be(b, c, s) {}\n\tconstexpr It begin()const { return be; }\n\tconstexpr It end()const { return en; }\n\tconstexpr T start()const { return be.start(); }\n\tconstexpr T count()const { return be.count(); }\n\tconstexpr T step()const { return be.step(); }\n\tconstexpr T sum()const { return start() * count() + step() * (count() * (count() - 1) / 2); }\n\toperator vector<T>()const { return as_vector(); }\n\tvector<T> as_vector()const {\n\t\tvector<T> res; res.reserve(count()); each([&](T i) {res.push_back(i); }); return res;\n\t}\n\ttemplate<class F>void each(const F& f)const { for (T i : *this)f(i); }\n\ttemplate<class F>auto map(const F& f)const {\n\t\tvector<decay_t<result_of_t<F(T)>>> res; res.reserve(count());\n\t\teach([&](T i) {res.push_back(f(i)); }); return res;\n\t}\n\ttemplate<class F>int count_if(const F& f)const {\n\t\tint res = 0; each([&](T i) {res += static_cast<bool>(f(i)); }); return res;\n\t}\n\ttemplate<class F>vector<T> select(const F& f)const {\n\t\tvector<T> res; each([&](T i) {if (f(i))res.push_back(i); }); return res;\n\t}\n\ttemplate<class F>auto max(const F& f)const {\n\t\tauto v = map(f); return *max_element(v.begin(), v.end());\n\t}\n\ttemplate<class F>auto min(const F& f)const {\n\t\tauto v = map(f); return *min_element(v.begin(), v.end());\n\t}\n\ttemplate<class F, class U = decay_t<result_of_t<F(T)>>>auto sum(const F& f)const {\n\t\tU res = 0; each([&](T i) {res += static_cast<U>(f(i)); }); return res;\n\t}\n\tusing value_type = T;\n\tusing iterator = It;\nprivate:\n\tIt be, en;\n};\ntemplate<class T>inline constexpr auto step(T a) { return Step<T>(0, a, 1); }\ntemplate<class T>inline constexpr auto step(T a, T b) { return Step<T>(a, b - a, 1); }\ntemplate<class T>inline constexpr auto step(T a, T b, T c) { return Step<T>(a, a < b ? (b - a - 1) / c + 1 : 0, c); }\n\n// --- functions --- //\ninline namespace {\n\ttemplate<class T>inline void Sort(T& a) { sort(all(a)); }\n\ttemplate<class T>inline void RSort(T& a) { sort(rall(a)); }\n\ttemplate<class T>inline T Sorted(T a) { Sort(a); return a; }\n\ttemplate<class T>inline T RSorted(T a) { RSort(a); return a; }\n\ttemplate<class T, class F>inline void Sort(T& a, const F& f) {\n\t\tsort(all(a), [&](const auto& x, const auto& y) {return f(x) < f(y); });\n\t}\n\ttemplate<class T, class F>inline void RSort(T& a, const F& f) {\n\t\tsort(rall(a), [&](const auto& x, const auto& y) {return f(x) < f(y); });\n\t}\n\ttemplate<class T>inline void Reverse(T& a) { reverse(all(a)); }\n\ttemplate<class T>inline void Unique(T& a) { a.erase(unique(all(a)), a.end()); }\n\ttemplate<class T>inline void Rotate(T& a, int left) { rotate(a.begin(), a.begin() + left, a.end()); }\n\ttemplate<class T>inline T Reversed(T a) { Reverse(a); return a; }\n\ttemplate<class T>inline T Uniqued(T a) { Unique(a); return a; }\n\ttemplate<class T>inline T Rotated(T a, int left) { Rotate(a, left); return a; }\n\ttemplate<class T>inline auto Max(const T& a) { return *max_element(all(a)); }\n\ttemplate<class T>inline auto Min(const T& a) { return *min_element(all(a)); }\n\ttemplate<class T>inline int MaxPos(const T& a) { return max_element(all(a)) - a.begin(); }\n\ttemplate<class T>inline int MinPos(const T& a) { return min_element(all(a)) - a.begin(); }\n\ttemplate<class T, class F>inline auto Max(const T& a, const F& f) {\n\t\treturn *max_element(all(a), [&](const auto& x, const auto& y) {return f(x) < f(y); });\n\t}\n\ttemplate<class T, class F>inline auto Min(const T& a, const F& f) {\n\t\treturn *min_element(all(a), [&](const auto& x, const auto& y) {return f(x) < f(y); });\n\t}\n\ttemplate<class T, class U>inline int Count(const T& a, const U& v) { return count(all(a), v); }\n\ttemplate<class T, class F>inline int CountIf(const T& a, const F& f) { return count_if(all(a), f); }\n\ttemplate<class T, class U>inline int Find(const T& a, const U& v) { return find(all(a), v) - a.begin(); }\n\ttemplate<class T, class F>inline int FindIf(const T& a, const F& f) { return find_if(all(a), f) - a.begin(); }\n\ttemplate<class T, class U = typename T::value_type>inline U Sum(const T& a) { return accumulate(all(a), U()); }\n\ttemplate<class T, class F>inline auto Sum(const T& v, const F& f) {\n\t\treturn accumulate(next(v.begin()), v.end(), f(v.front()), [&](auto a, auto b) {return a + f(b); });\n\t}\n\ttemplate<class T, class U>inline int Lower(const T& a, const U& v) { return lower_bound(all(a), v) - a.begin(); }\n\ttemplate<class T, class U>inline int Upper(const T& a, const U& v) { return upper_bound(all(a), v) - a.begin(); }\n\ttemplate<class T, class F>inline void RemoveIf(T& a, const F& f) { a.erase(remove_if(all(a), f), a.end()); }\n\ttemplate<class F>inline auto Vector(size_t size, const F& f) {\n\t\tvector<decay_t<result_of_t<F(size_t)>>> res(size); for (size_t i = 0; i < size; ++i)res[i] = f(i); return res;\n\t}\n\ttemplate<class T>inline auto Grid(size_t h, size_t w, const T& v = T()) { return vector<vector<T>>(h, vector<T>(w, v)); }\n\ttemplate<class T>inline auto Slice(const T& v, size_t i, size_t len) {\n\t\treturn i < v.size() ? T(v.begin() + i, v.begin() + min(i + len, v.size())) : T();\n\t}\n\ttemplate<class T, class F>inline auto Each(const T& v, const F& f) { for (auto& i : v)f(i); }\n\ttemplate<class T, class F>inline auto Select(const T& v, const F& f) {\n\t\tT res; for (const auto& e : v)if (f(e))res.push_back(e); return res;\n\t}\n\ttemplate<class T, class F>inline auto Map(const T& v, const F& f) {\n\t\tvector<decay_t<result_of_t<F(typename T::value_type)>>> res(v.size());\n\t\tsize_t i = 0; for (const auto& e : v)res[i++] = f(e); return res;\n\t}\n\ttemplate<class T, class F>inline auto MapIndex(const T& v, const F& f) {\n\t\tvector<decay_t<result_of_t<F(size_t, typename T::value_type)>>> res(v.size());\n\t\tsize_t i = 0; for (auto it = v.begin(); it != v.end(); ++it, ++i)res[i] = f(i, *it); return res;\n\t}\n\ttemplate<class T, class F>inline auto TrueIndex(const T& v, const F& f) {\n\t\tvector<size_t> res; for (size_t i = 0; i < v.size(); ++i)if (f(v[i]))res.push_back(i); return res;\n\t}\n\tinline string operator*(string s, size_t n) { string ret; for (size_t i = 0; i < n; ++i)ret += s; return ret; }\n\ttemplate<class T>inline T Ceil(T n, T m) { return (n + m - 1) / m; }\n\ttemplate<class T>inline T Ceil2(T n, T m) { return Ceil(n, m) * m; }\n\ttemplate<class T>inline T Tri(T n) { return (n & 1) ? (n + 1) / 2 * n : n / 2 * (n + 1); }\n\ttemplate<class T>inline T nC2(T n) { return (n & 1) ? (n - 1) / 2 * n : n / 2 * (n - 1); }\n\ttemplate<class T>inline T Mid(const T& l, const T& r) { return l + (r - l) / 2; }\n\tinline int pop_count(int n) { return bitset<32>(n).count(); }\n\tinline int pop_count(ll n) { return bitset<64>(n).count(); }\n\ttemplate<class T>inline bool chmax(T& a, const T& b) { if (a < b) { a = b; return true; } return false; }\n\ttemplate<class T>inline bool chmin(T& a, const T& b) { if (a > b) { a = b; return true; } return false; }\n\ttemplate<class T>inline bool inRange(const T& v, const T& min, const T& max) { return min <= v && v < max; }\n\ttemplate<class T = ll>inline T BIT(int b) { return T(1) << b; }\n\ttemplate<class T>inline T Gcd(T n, T m) { return m ? Gcd(m, n % m) : n; }\n\ttemplate<class T>inline T Lcm(T n, T m) { return n / Gcd(n, m) * m; }\n\ttemplate<class T, class U = typename T::value_type>inline U Gcdv(const T& v) {\n\t\treturn accumulate(next(v.begin()), v.end(), U(*v.begin()), Gcd<U>);\n\t}\n\ttemplate<class T, class U = typename T::value_type>inline U Lcmv(const T& v) {\n\t\treturn accumulate(next(v.begin()), v.end(), U(*v.begin()), Lcm<U>);\n\t}\n\ttemplate<class T>inline T Pow(T a, T n) { T r = 1; while (n > 0) { if (n & 1)r *= a; a *= a; n /= 2; } return r; }\n\ttemplate<class T>inline T Powmod(T a, T n, T m = MOD) {\n\t\tT r = 1; while (n > 0) { if (n & 1)r = r * a % m, n--; else a = a * a % m, n /= 2; }return r;\n\t}\n}\n\n// --- dump --- //\n#if __has_include(\"dump.hpp\")\n#include \"dump.hpp\"\n#else\n#define dump(...) ((void)0)\n#endif\n\n// ---------------------------------------------------------------- //\n\nstruct Point {\n\tstatic int H, W;\n\tstatic const vector<Point> d;\n\tstatic void set_range(int _H, int _W) { H = _H; W = _W; }\n\tstatic constexpr Point zero() { return { 0,0 }; }\n\tstatic constexpr Point one() { return { 1,1 }; }\n\tint x, y;\n\tconstexpr Point() :x(0), y(0) {}\n\tconstexpr Point(int _x, int _y) : x(_x), y(_y) {}\n\tconstexpr Point(const pair<int, int>& xy) : x(xy.first), y(xy.second) {}\n\tPoint(int n) :x(n% W), y(n / W) {}\n\tconstexpr Point operator+()const { return *this; }\n\tconstexpr Point operator-()const { return { -x,-y }; }\n\tconstexpr Point operator+(const Point& p)const { return Point(*this) += p; }\n\tconstexpr Point operator-(const Point& p)const { return Point(*this) -= p; }\n\tconstexpr Point operator*(const Point& p)const { return Point(*this) *= p; }\n\tconstexpr Point operator/(const Point& p)const { return Point(*this) /= p; }\n\tconstexpr Point operator%(const Point& p)const { return Point(*this) %= p; }\n\tconstexpr Point operator+(int n)const { return Point(*this) += n; }\n\tconstexpr Point operator-(int n)const { return Point(*this) -= n; }\n\tconstexpr Point operator*(int n)const { return Point(*this) *= n; }\n\tconstexpr Point operator/(int n)const { return Point(*this) /= n; }\n\tconstexpr Point operator%(int n)const { return Point(*this) %= n; }\n\tconstexpr Point& operator+=(const Point& p) { x += p.x; y += p.y; return *this; }\n\tconstexpr Point& operator-=(const Point& p) { x -= p.x; y -= p.y; return *this; }\n\tconstexpr Point& operator*=(const Point& p) { x *= p.x; y *= p.y; return *this; }\n\tconstexpr Point& operator/=(const Point& p) { x /= p.x; y /= p.y; return *this; }\n\tconstexpr Point& operator%=(const Point& p) { x %= p.x; y %= p.y; return *this; }\n\tconstexpr Point& operator+=(int n) { x += n; y += n; return *this; }\n\tconstexpr Point& operator-=(int n) { x -= n; y -= n; return *this; }\n\tconstexpr Point& operator*=(int n) { x *= n; y *= n; return *this; }\n\tconstexpr Point& operator/=(int n) { x /= n; y /= n; return *this; }\n\tconstexpr Point& operator%=(int n) { x %= n; y %= n; return *this; }\n\tconstexpr bool operator==(const Point& p)const { return x == p.x && y == p.y; }\n\tconstexpr bool operator!=(const Point& p)const { return x != p.x || y != p.y; }\n\tbool operator<(const Point& p)const { return to_i() < p.to_i(); }\n\tbool operator<=(const Point& p)const { return to_i() <= p.to_i(); }\n\tbool operator>(const Point& p)const { return to_i() > p.to_i(); }\n\tbool operator>=(const Point& p)const { return to_i() >= p.to_i(); }\n\tconstexpr int operator[](int i)const { return i == 0 ? x : i == 1 ? y : 0; }\n\tbool in_range()const { return 0 <= x && x < W && 0 <= y && y < H; }\n\tint to_i()const { return x + y * W; }\n\tconstexpr pair<int, int> to_pair()const { return { x,y }; }\n\tint dist(const Point& p)const { return std::abs(x - p.x) + std::abs(y - p.y); }\n\tPoint abs(const Point& p)const { return { std::abs(x - p.x),std::abs(y - p.y) }; }\n\tPoint abs()const { return { std::abs(x), std::abs(y) }; }\n\tPoint& swap() { std::swap(x, y); return *this; }\n\tvector<Point> adjacent2()const {\n\t\tvector<Point> v(2); for (int i = 0; i < 2; ++i)v[i] = *this + d[i]; return v;\n\t}\n\tvector<Point> adjacent4()const {\n\t\tvector<Point> v(4); for (int i = 0; i < 4; ++i)v[i] = *this + d[i]; return v;\n\t}\n\tvector<Point> adjacent8()const {\n\t\tvector<Point> v(8); for (int i = 0; i < 8; ++i)v[i] = *this + d[i]; return v;\n\t}\n\tvector<Point> adjacent6()const {\n\t\tvector<Point> v(6); for (int i = 0; i < 6; ++i)v[i] = *this + d[i]; return v;\n\t}\n\tvector<Point> adj2_in_range()const {\n\t\tvector<Point> v; for (const auto& P : adjacent2())if (P.in_range())v.push_back(P); return v;\n\t}\n\tvector<Point> adj4_in_range()const {\n\t\tvector<Point> v; for (const auto& P : adjacent4())if (P.in_range())v.push_back(P); return v;\n\t}\n\tvector<Point> adj8_in_range()const {\n\t\tvector<Point> v; for (const auto& P : adjacent8())if (P.in_range())v.push_back(P); return v;\n\t}\n\tconstexpr Point left()const { return { x - 1,y }; }\n\tconstexpr Point right()const { return { x + 1,y }; }\n\tconstexpr Point up()const { return { x,y - 1 }; }\n\tconstexpr Point down()const { return { x,y + 1 }; }\n\tconstexpr Point moved(char c)const { return Point(*this).move(c); }\n\tconstexpr Point& move(char c) {\n\t\tswitch (c) {\n\t\tcase 'L':case 'l':case'>':x--; break;\n\t\tcase 'R':case 'r':case'<':x++; break;\n\t\tcase 'U':case 'u':case'^':y--; break;\n\t\tcase 'D':case 'd':case'v':y++; break;\n\t\t}\n\t\treturn *this;\n\t}\n\tconstexpr Point rotate90() { return { y,-x }; }\n\tconstexpr Point rotate180() { return { -x,-y }; }\n\tconstexpr Point rotate270() { return { -y,x }; }\n};\nint Point::H, Point::W;\nconst vector<Point> Point::d{ {0,1},{1,0},{0,-1},{-1,0},{1,1},{-1,-1},{1,-1},{-1,1} };\ninline ostream& operator<<(ostream& os, const Point& p) { return  os << '(' << p.x << \", \" << p.y << ')'; }\ninline istream& operator>>(istream& is, Point& p) { return is >> p.x >> p.y; }\n\n\nbool cmp_big_int(const string& s, const string& t) { // s < t\n\tint S = sz(s), T = sz(t);\n\tif (S != T) {\n\t\treturn S < T;\n\t} else {\n\t\treturn s < t;\n\t}\n}\n\nint main() {\n\tconstexpr Point nil(-1, -1);\n\tfor (int w = in, h = in; w + h; in(w, h)) {\n\t\tVS s = in[h];\n\t\tVVI a = Map(s, [](const string& s) {\n\t\t\treturn Map(s, [](char c) {return isdigit(c) ? c - '0' : -1; });\n\t\t\t});\n\n\t\tauto dp = Grid<string>(h + 1, w + 1);\n\t\tstring ans = \"\";\n\t\trep(i, h)rep(j, w) {\n\t\t\tif (isdigit(s[i][j]) && s[i][j] >= '1') {\n\t\t\t\tstring up = dp[i][j + 1] + s[i][j];\n\t\t\t\tstring left = dp[i + 1][j] + s[i][j];\n\t\t\t\tdp[i + 1][j + 1] = cmp_big_int(up, left) ? left : up;\n\t\t\t} else if (s[i][j] == '0') {\n\t\t\t\tdp[i + 1][j + 1] = \"0\";\n\t\t\t\tif (!dp[i][j + 1].empty()) {\n\t\t\t\t\tstring str = dp[i][j + 1] + s[i][j];\n\t\t\t\t\tif (cmp_big_int(dp[i + 1][j + 1], str))dp[i + 1][j + 1] = str;\n\t\t\t\t}\n\t\t\t\tif (!dp[i + 1][j].empty()) {\n\t\t\t\t\tstring str = dp[i + 1][j] + s[i][j];\n\t\t\t\t\tif (cmp_big_int(dp[i + 1][j + 1], str))dp[i + 1][j + 1] = str;\n\t\t\t\t}\n\t\t\t\tif (dp[i + 1][j + 1] == \"0\")dp[i + 1][j + 1].clear();\n\t\t\t}\n\n\t\t\tif (cmp_big_int(ans, dp[i + 1][j + 1]))ans = dp[i + 1][j + 1];\n\t\t}\n\t\tout(ans);\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\n#define abs(a) max((a),-(a))\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define repe(i,n) rep(i,(n)+1)\n#define per(i,n) for(int i=(int)(n)-1;i>=0;i--)\n#define pere(i,n) rep(i,(n)+1)\n#define all(x) (x).begin(),(x).end()\n#define SP <<\" \"<<\n#define RET return 0\n#define MOD 1000000007\n#define INF 1000000000000000000\n\ntypedef long long LL;\ntypedef long double LD;\n\nint main(){\n  while(1){\n    int w,h;\n    cin >> w >> h;\n    if(w==0) return 0;\n    vector<string> f(h);\n    for(int i=0;i<h;i++){\n      cin >> f[i];\n    }\n    vector<vector<string>> dp(h+1,vector<string>(w+1,\"\"));\n    string s=\"\";\n    for(int i=1;i<=h;i++){\n      for(int j=1;j<=w;j++){\n        if('0'<=f[i-1][j-1]&&f[i-1][j-1]<='9'){\n          if(dp[i-1][j].length()>dp[i][j-1].length()){\n            dp[i][j]=dp[i-1][j]+string(1,f[i-1][j-1]);\n          }else if(dp[i-1][j].length()<dp[i][j-1].length()){\n            dp[i][j]=dp[i][j-1]+string(1,f[i-1][j-1]);\n          }else{\n            if(f[i-1][j-1]=='0'&&dp[i-1][j]==\"\") continue;\n            if(dp[i-1][j]>dp[i][j-1]){\n              dp[i][j]=dp[i-1][j]+string(1,f[i-1][j-1]);\n            }else{\n              dp[i][j]=dp[i][j-1]+string(1,f[i-1][j-1]);\n            }\n          }\n        }\n        if(dp[i][j].length()>s.length()||(dp[i][j].length()==s.length()&&dp[i][j]>s)){\n          s=dp[i][j];\n        }\n      }\n    }\n    cout << s << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<math.h>\n#include<algorithm>\n#include<utility>\n#include<queue>\n#include<string.h>\n#include<string>\n#include<set>\n#include<map>\n#include<vector>\nusing namespace std;\ntypedef long long LL;\ntypedef pair<int, int> P;\nint W,H;\nstring c[80];\nstring dp[80][80]={};\nstring Num(int h,int w){\n    if(dp[h][w]!=\"\"){\n        return dp[h][w];\n    }\n    if(isalpha(c[h][w])){\n        return \"\";\n    }\n    if(h+1==H && w+1==W)\n    {\n        dp[h][w]=c[h][w];\n        return dp[h][w];\n    }\n    string s1=\"\",s2=\"\";\n    if(h+1<H){\n        s1=Num(h+1,w);\n    }\n    if(w+1<W){\n        s2=Num(h,w+1);\n    }\n    if(s1.length()<s2.length()){\n        return dp[h][w]=c[h][w]+s2;\n    }else if(s1.length()>s2.length()){\n        return dp[h][w]=c[h][w]+s1;\n    }else{\n        return dp[h][w]=c[h][w]+max(s1,s2);\n    }\n}\n\nint main(){\n    while(cin>>W>>H,W!=0){\n        for(int i=0;i<H;i++){\n            cin>>c[i];\n            for(int j=0;j<W;j++){\n                dp[i][j]=\"\";\n            }\n        }\n        string ans=\"\";\n        for(int i=0;i<H;i++){\n            for(int j=0;j<W;j++){\n                if(c[i][j]!='0'){\n                    string tmp=Num(i,j);\n                    if(ans.length()<tmp.length()){\n                        ans=tmp;\n                    }else if(ans.length()==tmp.length()){\n                        ans=max(ans,tmp);\n                    }\n                }\n            }\n        }\n        cout<<ans<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n     \nusing namespace std;\n\nvector<char> vtovi(vector<char>& vc) {\n\tvector<char> tmp;\n\tint i=0;\n\twhile(i<vc.size() && vc[i]=='0') ++i;\n\tif(i==vc.size()) return tmp;\n\ttmp.insert(tmp.begin(),vc.begin()+i,vc.end());\n\treturn tmp;\n}\n \nint main() {\n\tint w,h;\n\twhile(cin >> w >> h,w) {\n\t\tvector<vector<char> > c(h,vector<char>(w));\n\t\tfor(auto&e:c) for(auto&a:e) cin >> a;\n\t\tvector<vector<vector<char> > > tmp(h+1,vector<vector<char> >(w+1));\n\t\tvector<char> ans;\n\t\tfor(int i=h-1;i>=0;--i) {\n\t\t\tfor(int j=w-1;j>=0;--j) {\n\t\t\t\tif(isdigit(c[i][j])) {\n\t\t\t\t\tvector<char> maxi;\n\t\t\t\t\tif(tmp[i+1][j].size()==tmp[i][j+1].size())\n\t\t\t\t\t\tmaxi=max(tmp[i+1][j],tmp[i][j+1]);\n\t\t\t\t\telse maxi=tmp[i+1][j].size()>tmp[i][j+1].size()?\n\t\t\t\t\t\t\t tmp[i+1][j]:tmp[i][j+1];\n\t\t\t\t\ttmp[i][j].push_back(c[i][j]);\n\t\t\t\t\ttmp[i][j].insert(tmp[i][j].begin()+1,maxi.begin(),maxi.end());\n\t\t\t\t\tvector<char> t(vtovi(tmp[i][j]));\n\t\t\t\t\tif(ans.size()<t.size()) ans=t;\n\t\t\t\t\telse if(ans.size()==t.size()) ans=max(ans,t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(auto a:ans) cout << a;\n\t\tcout << endl;\n\t}\n \n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr, __VA_ARGS__)\n// #define LOG(...)\n#define FOR(i, a, b) for(int i = (int)(a); i < (int)(b); ++i)\n#define REP(i, n) for(int i = 0; i < (int)(n); ++i)\n#define RREP(i, n) for(int i = (int)(n - 1); i >= 0; --i)\n#define RFOR(i, a, b) for(int i = (int)(b - 1); i >= (int)(a); --i)\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EXIST(s, e) ((s).find(e) != (s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n#define SQ(n) (n) * (n)\n#define BIT(x, i) (((x) >> (i)) & 1)\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<char> vc;\ntypedef vector<pii> vpi;\ntypedef vector<pll> vpl;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vc> vvc;\ntypedef vector<vll> vvll;\n\nchar field[70][70];\nstring dp[70][70];\n\nstring strmax(string a, string b) {\n  if (a.length() > b.length()) return a;\n  if (a.length() < b.length()) return b;\n  return max(a, b);\n}\n\nint dx[] = {-1, 0};\nint dy[] = {0, -1};\n\nint main() {\n  int w, h;\n  while(cin >> w >> h, w) {\n    fill_n((char*)field, 70 * 70, ' ');\n    fill_n((string*)dp, 70 * 70, \"\");\n    REP(y, h) REP(x, w) {\n      cin >> field[y][x];\n    }\n    dp[h - 1][w - 1] = field[h - 1][w - 1];\n\n    string maxs = \"\";\n    RREP(y, h) RREP(x, w) {\n      REP(i, 2){\n        int sx = x + dx[i];\n        int sy = y + dy[i];\n        if (sx < 0 || sx >= w || sy < 0 || sy >= h) continue;\n        if (isdigit(field[y][x]) && isdigit(field[sy][sx])) {\n          dp[sy][sx] = strmax(dp[sy][sx], field[sy][sx] + dp[y][x]);\n          // maxs = strmax(maxs, dp[sy][sx]);\n        }\n      }\n    }\n\n    REP(y, h) REP(x, w) {\n      while(*dp[y][x].begin() == '0') dp[y][x].erase(dp[y][x].begin());\n      maxs = strmax(maxs, dp[y][x]);\n    }\n    cout << maxs << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <map>\n\nusing namespace std;\n\nstring str_max(string s1, string s2) {\n\tif (s1.length() > s2.length()) {\n\t\treturn s1;\n\t}\n\tif (s2.length() > s1.length()) {\n\t\treturn s2;\n\t}\n\n\tif (s1 > s2) {\n\t\treturn s1;\n\t}\n\treturn s2;\n}\n\nint main(void) {\n\tint W,H;\n\twhile (cin >> W >> H, W) {\n\t\tvector< vector<string> > mat(H,vector<string>(W));\n\t\tfor (int i = 0; i < H; ++i) {\n\t\t\tfor (int j = 0; j < W; ++j) {\n\t\t\t\tstring temp = \"\";\n\t\t\t\tchar c;\n\t\t\t\tcin >> c;\n\t\t\t\tif (c >= '0' && c <= '9') {\n\t\t\t\t\ttemp += c;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttemp = \" \";\n\t\t\t\t}\n\t\t\t\tmat[i][j] = temp;\n\t\t\t}\n\t\t}\n\n\t\tstring res = \"0\";\n\t\tvector< vector<string> > dp(H,vector<string>(W,\"\"));\n\t\tfor (int i = 0; i < H-1; ++i) {\n\t\t\tfor (int j = 0; j < W-1; ++j) {\n\t\t\t\tif (mat[i][j] != \" \" && mat[i][j] != \"0\") {\n\t\t\t\t\tif (mat[i][j+1] != \" \") {\n\t\t\t\t\t\tdp[i][j+1] = str_max(dp[i][j]+mat[i][j],dp[i][j+1]);\n\t\t\t\t\t\tres = str_max(dp[i][j+1],res);\n\t\t\t\t\t}\n\t\t\t\t\tif (mat[i+1][j+1] != \" \") {\n\t\t\t\t\t\tdp[i+1][j] = str_max(dp[i][j]+mat[i][j],dp[i+1][j]);\n\t\t\t\t\t\tres = str_max(dp[i+1][j],res);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <cassert>\n#include <iostream>\n#include <string>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <map>\n\nstd::string str[128][128];\nchar field[128][128];\nint W, H;\n\nvoid Load() {\n  scanf(\"%d %d\", &W, &H);\n  for(int i = 0; i < H; ++i) {\n    scanf(\"%s\", field[i]);\n  }\n}\n\nvoid init() {\n  for(int i = 0; i < H; ++i) {\n    for(int j = 0; j < W; ++j) {\n      str[i][j].clear();\n    }\n  }\n}\n\nstd::string& greater(std::string& a, std::string& b) {\n  if( a.size() != b.size() ) {\n    if( a.size() < b.size() ) return b;\n    else return a;\n  }\n  if( a < b ) {\n    return b;\n  }\n  return a;\n}\n\nvoid solve() {\n  for(int r = H - 1; r >= 0; --r) {\n    for(int c = W - 1; c >= 0; --c) {\n      if( not ( '0' <= field[r][c] and field[r][c] <= '9' ) ) continue;\n      std::string t1;\n      std::string t2;\n      if( c + 1 < W ) {\n        t1 = str[r][c+1];\n      }\n      if( r + 1 < H ) {\n        t2 = str[r+1][c];\n      }\n      str[r][c] = field[r][c] + greater(t1, t2);\n    }\n  }\n}\n\nint main() {\n  for(;;) {\n    init();\n    Load();\n    if( W == 0 and H == 0 ) break;\n    solve();\n    std::string ans;\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        ans = greater(ans, str[i][j]);\n      }\n    }\n    int seek = 0;\n    for(seek = seek; seek < (int)ans.size(); ++seek) {\n      if( ans[seek] != '0' ) break;\n    }\n    std::cout << &(ans.c_str())[seek] << std::endl;\n  }  \n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n\n\nusing namespace std;\n\nint const N = 71;\nchar table[N][N] = {};\nbool vd[N][N] = {};\n\nvoid clear() {\n    for( int i=0; i<N; ++i )\n        for( int j=0; j<N; ++j ) {\n            table[i][j] = 0;\n            vd[i][j] = false;\n        }\n}\n\nint const dir[][2] = {{1,0}, {0, 1}};\nvoid find( vector<string>& ss, string& s, int const x, int const y, int const w, int const h )\n{\n    s += table[x][y];\n    vd[x][y] = true;\n\n    for( int i=0; i<2; ++i ) {\n        int const nx = x + dir[i][0];\n        int const ny = y + dir[i][1];\n        if ( nx < 0 || ny < 0 || nx >= w || ny >= h )\n            continue;\n        \n        if ( table[nx][ny] >= '0' && table[nx][ny] <= '9' ) {\n//            string copied = s;\n            find( ss, s, nx, ny, w, h );\n        }\n    }\n\n    ss.push_back( s );\n    s.erase( s.end() - 1 );\n}\n\ntemplate<typename T>\nstruct bun\n{\n    bool operator()( T const& l, T const& r ) {\n        return l.size() > r.size() || (l.size() == r.size() && l > r);\n    }\n};\n\nint main()\n{\n    for(;;) {\n        int w, h;\n        cin >> w >> h;\n        if ( w == 0 && h == 0 )\n            break;\n\n        clear();\n        cin.ignore(255, '\\n');\n        for( int y=0; y<h; ++y ) {\n            string s;\n            getline( cin, s );\n            for( int iii=0; iii<s.size(); ++iii ) {\n                table[iii][y] = s[iii];\n            }\n        }\n\n        vector<string> ss;\n        for( int x=0; x<N; ++x ) {\n            for( int y=0; y<N; ++y ) {\n                string s;\n                if ( table[x][y] >= '1' && table[x][y] <= '9' && !vd[x][y] ) {\n                    find( ss, s, x, y, w, h );\n                }\n            }\n        }\n        stable_sort( ss.begin(), ss.end(), bun<string>() );\n\n        //for( int i=0; i<ss.size(); ++i )\n            //cout << ss[i] << endl;\n        //    ;\n\n\n        cout << ss[0] << endl;\n        //cout << \"======\" << endl;\n    };\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <limits.h>\n#include <math.h>\n#include <bitset>\n#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <iomanip>\n#include <iostream>\n\n#define VARIABLE(x) cerr << #x << \"=\" << x << endl\n#define BINARY(x) static_cast<bitset<16> >(x);\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define REP(i,m,n) for (int i=m;i<(int)(n);i++)\n#define if_range(x, y, w, h) if (0<=(int)(x) && (int)(x)<(int)(w) && 0<=(int)(y) && (int)(y)<(int)(h))\n\nconst int INF = 100000000;\ntypedef double D;\nconst double EPS = 1e-8;\nconst double PI = 3.14159;\nint dx[4]={-1, 0, 1, 0}, dy[4]={0, -1, 0, 1};\nusing namespace std;\ntypedef pair<int, int> P;\n\n/** Problem1126 : The Secret Number **/\nconst int MAX_W = 40;\nint W, H;\nchar field[MAX_W][MAX_W];\nstring dp[MAX_W][MAX_W];\nbool vis[MAX_W][MAX_W];\n\nstring big(string s1, string s2) {\n\tif (s1.length() > s2.length()) {\n\t\treturn s1;\n\t} else if (s2.length() > s1.length()) {\n\t\treturn s2;\n\t} else {\n\t\treturn (s1>s2?s1:s2);\n\t}\n}\n\nstring rec(int x, int y, string n)\n{\n\tif_range(x, y, W, H) {\n\t\tif ('0' <= field[y][x] && field[y][x] <= '9')\n\t\t\tn += field[y][x];\n\t\telse\n\t\t\treturn dp[y][x] = n;\n\t}\n\telse return dp[y][x] = n;\n\t\n\t\n\tif (dp[y][x] != \"\")\n\t\treturn dp[y][x];\n\t\n\tstring s1 = rec(x+1, y, n);\n\tstring s2 = rec(x, y+1, n);\n\t\n\treturn dp[y][x] = big(s1, s2);\n}\n\nint main()\n{\n\twhile (cin>>W>>H, W||H) {\n\t\tfill(dp[0], dp[0]+W*H, \"\");\n\t\tfill(vis[0], vis[0]+W*H, false);\n\t\t\n\t\trep(i, H) {\n\t\t\trep(j, W) {\n\t\t\t\tcin>>field[i][j];\n\t\t\t}\n\t\t}\n\t\t\n\t\tstring ans = \"0\";\n\t\trep(y, H) {\n\t\t\trep(x, W) {\n\t\t\t\tif (!vis[y][x]) {\n\t\t\t\t\tans = big(ans, rec(x, y, \"\"));\n\t\t\t\t\tvis[y][x] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "//Name: The Secret Number\n//Level: 2\n//Category: 動的計画法,DP\n//Note:\n\n/*\n * あるマスを先頭とする文字列で最大のものは，\n *   ・そこから右に進み，それを先頭とした最大の文字列をくっつける\n *   ・そこから下に進み，それを先頭とした最大の文字列をくっつける\n * のどちらか．\n * ここで大小関係はまず文字列の長さで比較し，長さが同じときは辞書順により決定される．\n * 最大文字列を右下から決定していくとうまくDPに落としこめる．\n * 先頭が0の文字列の扱いに注意．\n *\n * オーダーは各マスをなめるのと，それぞれのマスで文字列の比較が発生するため O(WH(W+H))．\n * 文字列をいちいちコピーして生成せず，次のマスへのポインタだけ保持することで空間計算量を落としているが，\n * 時間計算量には変化がない割に面倒なのでよっぽどの事がない限りは普通に各マスごとに最大文字列を保持すればよい．\n * (コピーが生じないぶん定数倍高速化は発生する)\n */\n#include <iostream>\n#include <string>\n#include <vector>\n#include <cctype>\n\nusing namespace std;\n\nenum LINK {NONE, RIGHT, DOWN};\n\ninline bool in_range(int a, int x, int b) {\n    return a <= x && x < b;\n}\n\ninline void move(LINK link, pair<int,int> &pos) {\n    if(link == RIGHT) pos.second++;\n    else if(link == DOWN) pos.first++;\n    else if(link == NONE) {\n        pos.first = pos.second = -1;\n    }\n}\n\nLINK max_link(int r, int c, const vector<string> &matrix, const vector<vector<LINK> > &largest_link) {\n    const int H = (int)matrix.size();\n    const int W = (int)matrix[0].size();\n    LINK res = NONE;\n    pair<int,int> right_pos(r, c+1), down_pos(r+1, c);\n    bool first = true;\n    while(true) {\n        bool right_dead = !in_range(0, right_pos.first, H) || !in_range(0, right_pos.second, W);\n        right_dead = right_dead || !isdigit(matrix[right_pos.first][right_pos.second]);\n        bool down_dead = !in_range(0, down_pos.first, H) || !in_range(0, down_pos.second, W);\n        down_dead = down_dead || !isdigit(matrix[down_pos.first][down_pos.second]);\n\n        if(right_dead && down_dead) {\n            if(!first) res = RIGHT;\n            break;\n        } else if(down_dead) {\n            res = RIGHT;\n            break;\n        } else if(right_dead) {\n            res = DOWN;\n            break;\n        } else {\n            const char rc = matrix[right_pos.first][right_pos.second];\n            const char dc = matrix[down_pos.first][down_pos.second];\n            if(res == NONE && rc != dc) res = (rc > dc) ? RIGHT : DOWN;\n        }\n        move(largest_link[right_pos.first][right_pos.second], right_pos);\n        move(largest_link[down_pos.first][down_pos.second], down_pos);\n        first = false;\n    }\n    //cout << r << ' ' << c << ' ' << res << endl;\n    return res;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(0);\n    while(true) {\n        int W, H;\n        cin >> W >> H;\n        if(!W && !H) break;\n\n        vector<string> matrix(H);\n        for(int i = 0; i < H; ++i) {\n            cin >> matrix[i];\n        }\n        vector<vector<LINK> > largest_link(H, vector<LINK>(W, NONE));\n        vector<vector<int> > head(H, vector<int>(W, true));\n        for(int r = H-1; r >= 0; --r) {\n            for(int c = W-1; c >= 0; --c) {\n                if(isdigit(matrix[r][c])) {\n                    LINK link = max_link(r, c, matrix, largest_link);\n                    largest_link[r][c] = link;\n                    if(link != NONE) {\n                        if(link == RIGHT) head[r][c+1] = false;\n                        else if(link == DOWN) head[r+1][c] = false;\n                    }\n                }\n            }\n        }\n        string ans = \"\";\n        for(int r = 0; r < H; ++r) {\n            for(int c = 0; c < W; ++c) {\n                if(head[r][c]) {\n                    string buf(\"\");\n                    int rr = r, cc = c;\n                    buf += matrix[r][c];\n                    while(largest_link[rr][cc] != NONE) {\n                        if(largest_link[rr][cc] == RIGHT) ++cc;\n                        else ++rr;\n                        buf += matrix[rr][cc];\n                    }\n                    string::iterator it = buf.begin();\n                    while(it != buf.end() && *it == '0') ++it;\n                    buf.erase(buf.begin(), it);\n                    if(ans.size() < buf.size() || (ans.size() == buf.size() && ans < buf)) {\n                        ans = buf;\n                    }\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define FOR(i,a,b) for(int i= (a); i<((int)b); ++i)\n#define RFOR(i,a) for(int i=(a); i >= 0; --i)\n#define FOE(i,a) for(auto i : a)\n#define ALL(c) (c).begin(), (c).end()\n#define RALL(c) (c).rbegin(), (c).rend()\n#define DUMP(x)  cerr << #x << \" = \" << (x) << endl;\n#define SUM(x) std::accumulate(ALL(x), 0LL)\n#define MIN(v) *std::min_element(v.begin(), v.end())\n#define MAX(v) *std::max_element(v.begin(), v.end())\n#define EXIST(v,x) (std::find(v.begin(), v.end(), x) != v.end())\n#define BIT(n) (1LL<<(n))\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end());\n\ntypedef long long LL;\ntemplate<typename T> using V = std::vector<T>;\ntemplate<typename T> using VV = std::vector<std::vector<T>>;\ntemplate<typename T> using VVV = std::vector<std::vector<std::vector<T>>>;\n\ntemplate<class T> inline T ceil(T a, T b) { return (a + b - 1) / b; }\ntemplate<class T> inline void print(T x) { std::cout << x << std::endl; }\ntemplate<class T> inline void print_vec(const std::vector<T> &v) { for (int i = 0; i < v.size(); ++i) {  if (i != 0) {std::cout << \" \";} std::cout << v[i];} std::cout << \"\\n\"; }\ntemplate<class T> inline bool inside(T y, T x, T H, T W) {return 0 <= y and y < H and 0 <= x and x < W; }\ntemplate<class T> inline double euclidean_distance(T y1, T x1, T y2, T x2) { return sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2)); }\ntemplate<class T> inline double manhattan_distance(T y1, T x1, T y2, T x2) { return abs(x1 - x2) + abs(y1 - y2); }\n\nconst int INF = 1L << 30;\nconst double EPS = 1e-9;\nconst std::string YES = \"YES\", Yes = \"Yes\", NO = \"NO\", No = \"No\";\nconst std::vector<int> dy4 = { 0, 1, 0, -1 }, dx4 = { 1, 0, -1, 0 };    // 4近傍（右, 下, 左, 上）\nconst std::vector<int> dy8 = { 0, -1, 0, 1, 1, -1, -1, 1 }, dx8 = { 1, 0, -1, 0, 1, 1, -1, -1 };\n\nusing namespace std;\n\nint main() {\n    cin.tie(0);\n\tios::sync_with_stdio(false);\n\n\twhile (true) {\n\t    int W, H;\n\t    cin >> W >> H;\n        if (W == 0 and H == 0) {\n            break;\n        }\n\n\t    vector<string> f(H);\n\t    FOR(i, 0, H) {\n\t        cin >> f[i];\n\t        FOR(j, 0, W) {\n\t            if ('A' <= f[i][j] and f[i][j] <= 'Z') {\n\t                f[i][j] = 'A';\n\t            }\n\t        }\n\t    }\n\n\t    vector<vector<string>> dp(H, vector<string>(W));\n        FOR(y, 0, H) {\n            FOR(x, 0, W) {\n                if (f[y][x] != 'A' and f[y][x] != '0') {\n                    dp[y][x] = f[y][x];\n                }\n            }\n        }\n\n        FOR(y, 0, H) {\n            FOR(x, 0, W) {\n                if (f[y][x] == 'A') {\n                    continue;\n                }\n                // down\n                if (y + 1 < H and f[y + 1][x] != 'A') {\n                    string a = dp[y][x] + f[y + 1][x];\n                    string b = dp[y + 1][x];\n                    if (a.size() == b.size()) {\n                        dp[y + 1][x] = max(a, b);\n                    }\n                    else {\n                        if (a.size() > b.size()) {\n                            dp[y + 1][x] = a;\n                        }\n                    }\n                }\n\n                // left\n                if (x + 1 < W and f[y][x + 1] != 'A') {\n                    string a = dp[y][x] + f[y][x + 1];\n                    string b = dp[y][x + 1];\n                    if (a.size() == b.size()) {\n                        dp[y][x + 1] = max(a, b);\n                    }\n                    else {\n                        if (a.size() > b.size()) {\n                            dp[y][x + 1] = a;\n                        }\n                    }\n                }\n            }\n        }\n\n        string tmp = \"\";\n        FOR(y, 0, H) {\n            FOR(x, 0, W) {\n                string a = dp[y][x];\n                if (a.size() == tmp.size()) {\n                    tmp = max(a, tmp);\n                }\n                else {\n                    if (a.size() > tmp.size()) {\n                        tmp = a;\n                    }\n                }\n            }\n        }\n\n\n        print(tmp);\n\t}\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\ninline int comp(string& s, string &t)\n{\n\tif (s.size() < t.size()) return 1;\n\tif (s.size() > t.size()) return 0;\n\tfor (int i = 0; i < s.size(); i++)\n\t{\n\t\tif (s[i] < t[i]) return 1;\n\t\tif (s[i] > t[i]) return 0;\n\t}\n\treturn 0;\n}\n\nvoid solve(void)\n{\n\tint w, h;\n\twhile(cin >> w >> h)\n\t{\n\t\tif (!w && !h) break;\n\t\tvector<string> g(h), dp(w);\n\t\tfor (string& s : g) cin >> s;\n\t\tstring ans = \"\";\n\t\tfor (int i = 0; i < h; i++)\n\t\t{\n\t\t\tvector<string> nx(w);\n\t\t\tfor (int j = 0; j < w; j++)\n\t\t\t{\n\t\t\t\tif ('0' > g[i][j] || '9' < g[i][j])\n\t\t\t\t\tcontinue;\n\t\t\t\tstring s = \"\", t = \"\";\n\t\t\t\tif (i)\n\t\t\t\t\ts = dp[j];\n\t\t\t\tif (j)\n\t\t\t\t\tt = nx[j - 1];\n\t\t\t\tif (s.empty() && t.empty() && g[i][j] == '0') continue;\n\t\t\t\tnx[j] = (comp(s, t) ? t : s) + g[i][j];\n\t\t\t\tif (comp(ans, nx[j]))\n\t\t\t\t\tans = nx[j];\n\t\t\t}\n\t\t\tswap(dp, nx);\n\t\t}\n\t\tbool f = 1;\n\t\tfor (char c : ans)\n\t\t{\n\t\t\tif (c == '0' && f) continue;\n\t\t\tcout << c;\n\t\t\tf = 0;\n\t\t}\n\t\tif (f) cout << 0;\n\t\tcout << '\\n';\n\t}\n}\n\nint main()\n{\n\tsolve();\n\t//cout << \"yui(*-v・)yui\" << endl;\n\treturn 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef unsigned long long ull;\n#define rep(i, n) REP(i, 0, n)\n#define REP(i, a, n) for(int i=(a); i<(n); i++)\n\nint w, h;\nchar c[70][70];\n#define is_ok(i, j) (0<=i && i<h && 0<=j && j<w && isdigit(c[i][j]))\n\nset<string> search(int i, int j) {\n    if(!is_ok(i, j)) return {};\n    set<string> ret = {};\n    for(auto s:search(i+1, j)) ret.insert(c[i][j] + s);\n    for(auto s:search(i, j+1)) ret.insert(c[i][j] + s);\n    if(ret.empty()) ret.insert(string(1, c[i][j]));\n    return ret;\n}\n\nint main() {\n    while(cin>>w>>h, w+h) {\n        rep(i, h) scanf(\"%s\", &c[i]);\n        set<ull> codes = {};\n        rep(i, h) rep(j, w) if (!is_ok(i-1, j)&&!is_ok(i, j-1)) for(auto s:search(i, j)) codes.insert(stoull(s));\n        cout << *codes.rbegin() << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n#define ll long long\n#define INF (1<<30)\n#define LINF (1LL<<60)\n\n//http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#define MAXH 75\n#define MAXW 75\nvector<vector<string>> dp(MAXH, vector<string>(MAXW));\nvector<vector<int>> f(MAXH, vector<int>(MAXW));\nstring ans;\nint W, H;\n\ninline bool str_check(string& a, string&b) {\n\tif (a.size() > b.size()) return true;\n\telse if (a.size() < b.size()) return false;\n\telse {\n\t\tint Size = a.size();\n\t\tfor (int i = 0; i < Size;i++) {\n\t\t\tif (a[i] != b[i]) return a[i] > b[i] ? true : false;\n\t\t}\n\t}\n\treturn false;\n}\n\nvoid dfs(int h, int w, vector<vector<char>>& C) {\n\tf[h][w] = 1;\n\n\tbool dfs_f = false;\n\n\tif (f[h][w - 1] == 0 && C[h][w - 1] < 'A') {\n\t\tif (dp[h][w - 1] == \"-\") {\n\t\t\tdp[h][w - 1] = C[h][w - 1] + dp[h][w];\n\t\t\tdfs(h, w - 1, C);\n\n\t\t\tdfs_f = true;\n\t\t}\n\t\telse {\n\t\t\tif (str_check(C[h][w - 1] + dp[h][w], dp[h][w - 1])) {\n\t\t\t\tdp[h][w - 1] = C[h][w - 1] + dp[h][w];\n\t\t\t\tdfs(h, w - 1, C);\n\n\t\t\t\tdfs_f = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (f[h - 1][w] == 0 && C[h - 1][w] < 'A') {\n\t\tif (dp[h - 1][w] == \"-\") {\n\t\t\tdp[h - 1][w] = C[h - 1][w] + dp[h][w];\n\t\t\tdfs(h - 1, w, C);\n\n\t\t\tdfs_f = true;\n\t\t}\n\t\telse {\n\t\t\tif (str_check(C[h - 1][w] + dp[h][w], dp[h - 1][w])) {\n\t\t\t\tdp[h - 1][w] = C[h - 1][w] + dp[h][w];\n\t\t\t\tdfs(h - 1, w, C);\n\n\t\t\t\tdfs_f = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (!dfs_f) {\n\t\tif (str_check(dp[h][w], ans)) {\n\t\t\tans = dp[h][w];\n\t\t}\n\t}\n}\n\nint main() {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\twhile (cin >> W >> H) {\n\t\tif (W == 0 && H == 0) break;\n\t\tans = \"0\";\n\t\tfor (int i = 0; i < MAXH; i++) for (int j = 0; j < MAXW;j++) {\n\t\t\tdp[i][j] = \"-\";\n\t\t\tf[i][j] = 0;\n\t\t}\n\t\tvector<vector<char>> C(H + 2, vector<char>(W + 2, 'A'));\n\t\tfor (int i = 1; i <= H;i++) for (int j = 1; j <= W;j++) cin >> C[i][j];\n\n\t\tfor (int i = H; i > 0; i--) {\n\t\t\tfor (int j = W; j > 0;j--) {\n\t\t\t\tif (f[i][j] == 0 && C[i][j] < 'A') {\n\t\t\t\t\tdp[i][j] = C[i][j];\n\t\t\t\t\tdfs(i, j, C);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tbool zefo_flag = true;\n\t\tfor (int i = 0; i < ans.length();i++) {\n\t\t\tif (ans[i] == '0' && zefo_flag == true) continue;\n\t\t\tif (ans[i] != '0') zefo_flag = false;\n\t\t\tcout << ans[i];\n\t\t}\n\t\tcout << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\nconst int MAX = 71;\n\nchar judge(char c){\n    if('0' <= c && c <= '9') return c;\n    return '#';\n}\n\nstring strMax(string x,string y){\n    string tx = \"\",ty = \"\";\n    bool flg = false;\n    \n    if(x == \"#\" && y == \"#\") return \"#\";\n    if(x == \"#\") return y;\n    if(y == \"#\") return x;\n    \n    for(int i = 0 ; i < x.size() ; i++){\n        if(x[i] == '0' && !flg){\n            continue;\n        }\n        else{\n            flg = true;\n            tx += x[i];\n        }\n    }\n    x = tx;\n    flg = false;\n    for(int i = 0 ; i < y.size() ; i++){\n        if(y[i] == '0' && !flg){\n            continue;\n        }\n        else{\n            flg = true;\n            ty += y[i];\n        }\n    }\n    y = ty;\n    \n    if(x.size() > y.size()) return x;\n    else if(x.size() < y.size()) return y;\n    \n    for(int i = 0 ; i < x.size() ; i++){\n        if(x[i] > y[i]) return x;\n        else if(x[i] < y[i]) return y;\n    }\n    return x;\n}\n\nint main(){\n    int H,W;\n    string str[MAX];\n    \n    while(cin >> H >> W , H + W){\n        string dp[MAX][MAX];\n        for(int i = 0 ; i < W ; i++){\n            cin >> str[i];\n        }\n        dp[0][0] = judge(str[0][0]);\n        \n        for(int i = 1 ; i < W ; i++){\n            if(judge(str[i][0]) == '#'){\n                dp[i][0] = \"#\";\n            }\n            else if(dp[i-1][0] != \"#\"){\n                dp[i][0] = dp[i-1][0];\n                dp[i][0] += judge(str[i][0]);\n            }\n            else{\n                dp[i][0] += judge(str[i][0]);\n            }\n        }\n        \n        for(int j = 1 ; j < H ; j++){\n            if(judge(str[0][j]) == '#'){\n                dp[0][j] = \"#\";\n            }\n            else if(dp[0][j-1] != \"#\"){\n                dp[0][j] = dp[0][j-1];\n                dp[0][j] += judge(str[0][j]);\n            }\n            else{\n                dp[0][j] += judge(str[0][j]);\n            }\n        }\n        \n        string ans = \"0\";\n        for(int i = 1 ; i < W ; i++){\n            for(int j = 1 ; j < H ; j++){\n                if(judge(str[i][j]) == '#') dp[i][j] = '#';\n                else{\n                    dp[i][j] = strMax(dp[i-1][j],dp[i][j-1]);\n                    if(dp[i][j] != \"#\"){\n                        dp[i][j] += judge(str[i][j]);\n                        ans = strMax(ans,dp[i][j]);\n                    }\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n)for(int i=0;i<n;i++)\nusing namespace std;\ntypedef pair<int, int>P;\n\nchar c[80][80];\nstruct str {\n\tstring s;\n\tstr(string s = \"\") :s(s) {}\n}d[80][80];\nbool operator<(str a, str b) {\n\tif (a.s.size() == b.s.size())return a.s < b.s;\n\treturn a.s.size() < b.s.size();\n}\nint main() {\n\tint w, h;\n\twhile (scanf(\"%d%d\", &w, &h), w) {\n\t\trep(i, h)scanf(\"%s\", c[i]);\n\t\tstr Max = \"0\";\n\t\trep(i, h)rep(j, w) {\n\t\t\tif ('0' <= c[i][j] && c[i][j] <= '9') {\n\t\t\t\td[i][j] = to_string(c[i][j] - '0');\n\t\t\t\tif (i)d[i][j] = max(d[i][j], str(d[i - 1][j].s + c[i][j]));\n\t\t\t\tif (j)d[i][j] = max(d[i][j], str(d[i][j - 1].s + c[i][j]));\n\t\t\t\tstr s = d[i][j];\n\t\t\t\twhile (!s.s.empty() && s.s.front() == '0')s = s.s.substr(1);\n\t\t\t\tMax = max(Max, s);\n\t\t\t}\n\t\t\telse d[i][j] = (string)\"\";\n\t\t}\n\t\tcout << Max.s << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\nint w, h;\nint gc;\nstring s[51], dp[51][51];\nbool is_num(char c){return '0'<=c && c<= '9';}\n\nstring str_max(const string& s1, const string& s2) {\n  if (s1.size() == s2.size()) {\n    return (s1 > s2) ? s1 : s2 ;\n  }\n  return (s1.size() > s2.size())? s1 : s2 ;\n}\n\nstring dfs(int i, int j) {\n  string res = \"\";\n  \n  if (!is_num(s[i][j])) return res;\n  if (i >= h || j >= w) return res;\n  // DP\n  if (dp[i][j] != \"\") return dp[i][j];\n  \n  //gc++;\n\n  \n  res = s[i][j] + str_max(dfs(i, j+1), dfs(i+1, j));\n  \n  // ªÉ0ªÂ¢Ä¢éêÍæé\n  if (i == 0 && j == 0) {\n    if (res[0] == '0') res.erase(0, 1);\n  } else if (i == 0) {\n    if (!is_num(s[i][j-1]) && res[0] == '0') res.erase(0, 1);\n  } else if (j == 0) {\n    if (!is_num(s[i-1][j]) && res[0] == '0') res.erase(0, 1);\n  } else{\n    if (!is_num(s[i-1][j]) && !is_num(s[i][j-1])) res.erase(0, 1);\n  }\n  \n  return dp[i][j] = res;\n}\n\nvoid solve() {\n  for(int i=0;i<h;i++) cin>>s[i];\n  // init\n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  dp[i][j] = \"\";\n  \n  // search\n  string largest = \"\";\n  //gc = 0;\n  \n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  if (dp[i][j] == \"\")\n  largest = str_max(dfs(i, j), largest);\n  \n  /*\n  for(int i=0;i<h;i++) {\n    for(int j=0;j<w;j++) cout<<\"[\"<<dp[i][j]<<\"]\";\n    cout<<endl;\n  }*/\n  \n  //cout<<gc<<endl;\n  cout<<largest<<endl;\n}\n\nint main (int argc, char const* argv[]) {\n  while (cin>>w>>h, w||h) {\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n#define ll long long\n#define INF (1<<30)\n#define LINF (1LL<<60)\n\n//http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#define MAXH 75\n#define MAXW 75\nvector<vector<string>> dp(MAXH, vector<string>(MAXW));\nvector<vector<int>> f(MAXH, vector<int>(MAXW));\nstring ans;\nint W, H;\n\ninline bool str_check(const string& a,const string&b) {\n\tif (a.size() > b.size()) return true;\n\telse if (a.size() < b.size()) return false;\n\telse {\n\t\tint Size = a.size();\n\t\tfor (int i = 0; i < Size;i++) {\n\t\t\tif (a[i] != b[i]) return a[i] > b[i] ? true : false;\n\t\t}\n\t}\n\treturn false;\n}\n\nvoid dfs(int h, int w, vector<vector<char>>& C) {\n\tf[h][w] = 1;\n\n\tbool dfs_f = false;\n\n\tif (f[h][w - 1] == 0 && C[h][w - 1] < 'A') {\n\t\tif (dp[h][w - 1] == \"-\") {\n\t\t\tdp[h][w - 1] = C[h][w - 1] + dp[h][w];\n\t\t\tdfs(h, w - 1, C);\n\n\t\t\tdfs_f = true;\n\t\t}\n\t\telse {\n\t\t\tif (str_check(C[h][w - 1] + dp[h][w], dp[h][w - 1])) {\n\t\t\t\tdp[h][w - 1] = C[h][w - 1] + dp[h][w];\n\t\t\t\tdfs(h, w - 1, C);\n\n\t\t\t\tdfs_f = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (f[h - 1][w] == 0 && C[h - 1][w] < 'A') {\n\t\tif (dp[h - 1][w] == \"-\") {\n\t\t\tdp[h - 1][w] = C[h - 1][w] + dp[h][w];\n\t\t\tdfs(h - 1, w, C);\n\n\t\t\tdfs_f = true;\n\t\t}\n\t\telse {\n\t\t\tif (str_check(C[h - 1][w] + dp[h][w], dp[h - 1][w])) {\n\t\t\t\tdp[h - 1][w] = C[h - 1][w] + dp[h][w];\n\t\t\t\tdfs(h - 1, w, C);\n\n\t\t\t\tdfs_f = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (!dfs_f) {\n\t\tif (str_check(dp[h][w], ans)) {\n\t\t\tans = dp[h][w];\n\t\t}\n\t}\n}\n\nint main() {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\twhile (cin >> W >> H) {\n\t\tif (W == 0 && H == 0) break;\n\t\tans = \"0\";\n\t\tfor (int i = 0; i < MAXH; i++) for (int j = 0; j < MAXW;j++) {\n\t\t\tdp[i][j] = \"-\";\n\t\t\tf[i][j] = 0;\n\t\t}\n\t\tvector<vector<char>> C(H + 2, vector<char>(W + 2, 'A'));\n\t\tfor (int i = 1; i <= H;i++) for (int j = 1; j <= W;j++) cin >> C[i][j];\n\n\t\tfor (int i = H; i > 0; i--) {\n\t\t\tfor (int j = W; j > 0;j--) {\n\t\t\t\tif (f[i][j] == 0 && C[i][j] < 'A') {\n\t\t\t\t\tdp[i][j] = C[i][j];\n\t\t\t\t\tdfs(i, j, C);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tbool zefo_flag = true;\n\t\tfor (int i = 0; i < ans.length();i++) {\n\t\t\tif (ans[i] == '0' && zefo_flag == true) continue;\n\t\t\tif (ans[i] != '0') zefo_flag = false;\n\t\t\tcout << ans[i];\n\t\t}\n\t\tcout << endl;\n\t}\n}\n\nvoid dfs(int h, int w, vector<vector<char>>& C) {\n\tf[h][w] = 1;\n\n\tbool dfs_f = false;\n\n\tif (f[h][w - 1] == 0 && C[h][w - 1] < 'A') {\n\t\tif (dp[h][w - 1] == \"-\") {\n\t\t\tdp[h][w - 1] = C[h][w - 1] + dp[h][w];\n\t\t\tdfs(h, w - 1, C);\n\n\t\t\tdfs_f = true;\n\t\t}\n\t\telse {\n\t\t\tif (str_check(C[h][w - 1] + dp[h][w], dp[h][w - 1])) {\n\t\t\t\tdp[h][w - 1] = C[h][w - 1] + dp[h][w];\n\t\t\t\tdfs(h, w - 1, C);\n\n\t\t\t\tdfs_f = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (f[h - 1][w] == 0 && C[h - 1][w] < 'A') {\n\t\tif (dp[h - 1][w] == \"-\") {\n\t\t\tdp[h - 1][w] = C[h - 1][w] + dp[h][w];\n\t\t\tdfs(h - 1, w, C);\n\n\t\t\tdfs_f = true;\n\t\t}\n\t\telse {\n\t\t\tif (str_check(C[h - 1][w] + dp[h][w], dp[h - 1][w])) {\n\t\t\t\tdp[h - 1][w] = C[h - 1][w] + dp[h][w];\n\t\t\t\tdfs(h - 1, w, C);\n\n\t\t\t\tdfs_f = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (!dfs_f) {\n\t\tif (str_check(dp[h][w], ans)) {\n\t\t\tans = dp[h][w];\n\t\t}\n\t}\n}\n\nint main() {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\twhile (cin >> W >> H) {\n\t\tif (W == 0 && H == 0) break;\n\t\tans = \"0\";\n\t\tfor (int i = 0; i < MAXH; i++) for (int j = 0; j < MAXW;j++) {\n\t\t\tdp[i][j] = \"-\";\n\t\t\tf[i][j] = 0;\n\t\t}\n\t\tvector<vector<char>> C(H + 2, vector<char>(W + 2, 'A'));\n\t\tfor (int i = 1; i <= H;i++) for (int j = 1; j <= W;j++) cin >> C[i][j];\n\n\t\tfor (int i = H; i > 0; i--) {\n\t\t\tfor (int j = W; j > 0;j--) {\n\t\t\t\tif (f[i][j] == 0 && C[i][j] < 'A') {\n\t\t\t\t\tdp[i][j] = C[i][j];\n\t\t\t\t\tdfs(i, j, C);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tbool zefo_flag = true;\n\t\tfor (int i = 0; i < ans.length();i++) {\n\t\t\tif (ans[i] == '0' && zefo_flag == true) continue;\n\t\t\tif (ans[i] != '0') zefo_flag = false;\n\t\t\tcout << ans[i];\n\t\t}\n\t\tcout << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <set>\nusing namespace std;\n\nchar field[70][70];\nint w, h;\nint dy[] = {0, 1}, dx[] = {1, 0};\nset<string> numbers;\nsize_t maxLength;\n\nvoid search(const int y, const int x, string number) {\n    number += field[y][x];\n    bool isEnd = true;\n    for (int i = 0; i < 2; i++) {\n        int ny = y + dy[i], nx = x + dx[i];\n        if (ny < h && nx < w && '0' <= field[ny][nx] && field[ny][nx] <= '9') {\n            isEnd = false;\n            search(ny, nx, number);\n        }\n    }\n    if (isEnd) {\n        numbers.insert(number);\n        if (maxLength < number.length()) {\n            maxLength = number.length();\n        }\n    }\n}\n\nint main() {\n    while (true) {\n        cin >> w >> h;\n        if ((w | h) == 0) {\n            break;\n        }\n        for (int y = 0; y < h; y++) {\n            cin >> field[y];\n        }\n        numbers.clear();\n        maxLength = 0;\n        for (int y = 0; y < h; y++) {\n            for (int x = 0; x < w; x++) {\n                if ('0' < field[y][x] && field[y][x] <= '9') {\n                    string number = \"\";\n                    search(y, x, number);\n                }\n            }\n        }\n        string max = \"0\";\n        for (set<string>::iterator it = numbers.begin(); it != numbers.end(); it++) {\n            if ((*it).length() < maxLength) {\n                continue;\n            }\n            if (max < *it) {\n                max = *it;\n            }\n        }\n        cout << max << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\ntypedef long long LL;\n#define SORT(c) sort((c).begin(),(c).end())\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\nusing namespace std;\nint main(void)\n{\n  for(;;){\n    int w,h;\n    cin >> w >> h;\n    if(!w&&!h) return 0;\n    vector<string> field;\n    field.resize(h);\n    REP(i,h) cin >> field[i];\n    vector<vector<string> > dp;\n    dp.resize(h+1);\n    REP(i,h+1) dp[i].assign(w+1,\"\");\n    REP(i,h) REP(j,w){\n      if(0<=i&&i<h&&0<=j&&j<w){\n\tif(('1'<=field[i][j]&&field[i][j]<='9')||(field[i][j]=='0'&&dp[i][j]!=\"\"))\n\t  dp[i][j]+=field[i][j];\n\telse\n\t  dp[i][j]=\"\";\n\tif((dp[i+1][j].size()<dp[i][j].size())||(dp[i+1][j].size()==dp[i][j].size()&&dp[i+1][j]<dp[i][j]+field[i][j]))\n\t  dp[i+1][j]=dp[i][j];\n\tif((dp[i][j+1].size()<dp[i][j].size())||(dp[i][j+1].size()==dp[i][j].size()&&dp[i][j+1]<dp[i][j]+field[i][j]))\n\t  dp[i][j+1]=dp[i][j];\n      }\n    }\n    string answer=\"0\";\n    REP(i,h+1) REP(j,w+1)\n      if(dp[i][j].size()>answer.size() || (dp[i][j].size()==answer.size() && dp[i][j]>answer))\n\tanswer=dp[i][j];\n\t\n    cout << answer << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <queue>\n#include <utility>\n#include <map>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\ntypedef pair<int, int> P;\n\nconst int W = 70, H = 70;\nchar board[H][W];\nint w, h;\n\nbool comp(const string& a, const string& b){\n\tif(a.length() == b.length()){\n\t\tint l = a.length();\n\t\tfor(int i = 0;i < l;++i){\n\t\t\tif(a[i] == b[i]) continue;\n\t\t\telse{\n\t\t\t\treturn a[i] > b[i];\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\treturn a.length() > b.length();\n}\n\nvoid search(int x, int y, vector<string>* v){\n\tint dx[] = {1, 0}, dy[] = {0, 1};\n\tqueue<pair<P, string> > q;\n\tq.push(make_pair(make_pair(x, y), \"\"));\n\twhile(!q.empty()){\n\t\tpair<P, string> pair = q.front();\n\t\tq.pop();\n\t\tP p = pair.first;\n\t\tpair.second += board[p.second][p.first];\n\t\tif (pair.second.length() > 0) (*v).push_back(pair.second);\n\t\tfor(int i = 0;i < 2;++i){\n\t\t\tint nx = p.first + dx[i], ny = p.second + dy[i];\n\t\t\tif(0 <= nx && 0 <= ny && nx < w && ny < h && '0' <= board[ny][nx] && board[ny][nx] <= '9'){\n\t\t\t\tq.push(make_pair(make_pair(nx, ny), pair.second));\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\twhile(cin >> w >> h, w){\n\t\tvector<string> v;\n\t\tfor(int i = 0;i < h;++i){\n\t\t\tfor(int j = 0;j < w;++j){\n\t\t\t\tcin >> board[i][j];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < h;++i){\n\t\t\tfor(int j = 0;j < w;++j){\n\t\t\t\tif('0' <= board[i][j] && board[i][j] <= '9'){\n\t\t\t\t\tsearch(j, i, &v);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsort(v.begin(), v.end(), comp);\n\t\tstring ans = *(v.begin());\n\t\tif(ans[0] == '0') ans.erase(ans.begin());\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cctype>\n\nusing namespace std;\n\nint main(void){\n  int w,h;\n  string grid[71],dp[71][71];\n\n  while(cin >> w >> h,w|h){\n    for(int i=0;i<70;i++)\n      for(int j=0;j<70;j++)dp[i][j].clear();\n\n    for(int i=0;i<h;i++)cin >> grid[i];\n\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(!isupper(grid[i][j])){\n\t  dp[i][j]=grid[i][j];\n\t  string a=\"\",b=\"\";\n\t  if(i>0 && !dp[i-1][j].empty())a=dp[i-1][j]+grid[i][j];\n\t  if(j>0 && !dp[i][j-1].empty())b=dp[i][j-1]+grid[i][j];\n\t  \n\t  if(a.empty() && !b.empty()){\n\t    dp[i][j]=b;\n\t    continue;\n\t  }\n\n\t  if(!a.empty() && b.empty()){\n\t    dp[i][j]=a;\n\t    continue;\n\t  }\n\t  if(a.empty() && b.empty())continue;\n\t  if(a.size()>b.size())dp[i][j]=a;\n\t  if(a.size()<b.size())dp[i][j]=b;\n\t  else if(a>b)dp[i][j]=a;\n\t  else dp[i][j]=b;\n\n\t  if(dp[i][j][0]=='0'){\n\t    int k=0;\n\t    for(;k<dp[i][j].size()&&dp[i][j][k]=='0';k++);\n\t    dp[i][j]=dp[i][j].substr(k);\n\t  }\n\t}\n      }\n    }\n\n    string s=\"\";\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(s.size()<dp[i][j].size())s=dp[i][j];\n\telse if(s.size()>dp[i][j].size())s=s;\n\telse if(s<dp[i][j])s=dp[i][j];\n      }\n    }\n    cout << s << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <iostream>\n#include <string>\n#include <vector>\n#include <stdlib.h>\n\nusing namespace std;\n\nbool isLarger( string s1, string s2 ) {\n\tif( s1.length() > s2.length() ) return true;\n\telse if ( s1.length() < s2.length() ) return false;\n\telse {\n\t\treturn atoi( s1.c_str() ) > atoi( s2.c_str() );\n\t}\n}\n\nvoid add( char c[70][70], string s, string dp[70][70], int w, int h, int x, int y) {\n\tif( x < 0 || x >= w || y < 0 || y >= h ) return;\n\tif( c[x][y] < '0' || c[x][y] > '9' ) return;\n\tstring s1 = dp[x][y];\n\tstring s2 = c[x][y] + s;\n\tif( isLarger( s1, s2 ) ) dp[x][y] = s1;\n\telse dp[x][y] = s2;\n}\n\nint main(void){\n\t//FILE* fp_in = freopen(\"data.txt\", \"r\", stdin);\n\n\twhile( 1 ) {\n\t\tstring dp[70][70];\n\t\tchar c[70][70];\n\n\t\tint w, h;\n\t\tcin >> w >> h;\n\t\tif( w == 0 && h == 0 ) break;\n\n\t\tfor(int i = 0; i < h; i++ ) {\n\t\t\tstring s;\n\t\t\tcin >> s;\n\t\t\tfor(int j = 0; j < w; j++) {\n\t\t\t\tc[j][i] = s[j];\n\t\t\t\tdp[j][i] += s[j];\n\t\t\t}\n\t\t}\n\n\t\t//動的計画法　右下から順に調べてゆく\n\t\tfor(int j = h - 1; j >= 0; j--) {\n\t\t\tfor(int i = w - 1; i >= 0; i--) {\n\t\t\t\tif( c[i][j] < '0' || c[i][j] > '9' ) continue;\n\t\t\t\tadd( c, dp[i][j], dp, w, h, i - 1, j);\n\t\t\t\tadd( c, dp[i][j], dp, w, h, i, j - 1);\n\t\t\t}\n\t\t}\n\n\t\tstring max;\n\t\tfor(int i = 0; i < h; i++) \n\t\t\tfor(int j = 0; j < w; j++)\n\t\t\t\tif( isLarger( dp[i][j], max ) ) max = dp[i][j];\n\n\t\tcout << max << endl;\n\n\t}\n\t//while(1){}\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <limits.h>\n#include <math.h>\n#include <bitset>\n#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <iomanip>\n#include <iostream>\n\n#define VARIABLE(x) cerr << #x << \"=\" << x << endl\n#define BINARY(x) static_cast<bitset<16> >(x);\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define REP(i,m,n) for (int i=m;i<(int)(n);i++)\n#define if_range(x, y, w, h) if (0<=(int)(x) && (int)(x)<(int)(w) && 0<=(int)(y) && (int)(y)<(int)(h))\n\nconst int INF = 100000000;\ntypedef double D;\nconst double EPS = 1e-8;\nconst double PI = 3.14159;\nint dx[4]={-1, 0, 1, 0}, dy[4]={0, -1, 0, 1};\nusing namespace std;\ntypedef pair<int, int> P;\n\n/** Problem1126 : The Secret Number **/\nconst int MAX_W = 70;\nint W, H;\nchar field[MAX_W][MAX_W];\nstring dp[MAX_W][MAX_W];\n\nbool big(string s1, string s2) {\n\tif (s1.length() > s2.length()) {\n\t\treturn true;\n\t} else if (s2.length() > s1.length()) {\n\t\treturn false;\n\t} else {\n\t\treturn (s1>s2?true:false);\n\t}\n}\n\nbool big2(string s1, string s2) {\n\twhile (s1[0]=='0') s1.erase(s1.begin());\n\twhile (s2[0]=='0') s2.erase(s2.begin());\n\treturn big(s1, s2);\n}\n\nstring rec(int x, int y)\n{\n\tif (!('0' <= field[y][x] && field[y][x] <= '9'))\n\t\treturn dp[y][x] = \"\";\n\t\n\tstring s1 = field[y][x] + dp[y][x+1];\n\tstring s2 = field[y][x] + dp[y+1][x];\n\t\n\treturn dp[y][x] = (big2(s1, s2)?s1:s2);\n}\n\nstring nzero(string s) {\n\twhile (s[0]!='0') s.erase(s.begin());\n}\n\nint main()\n{\n\twhile (cin>>W>>H, W||H) {\n\t\tfill(dp[0], dp[0]+W*H, \"\");\n\t\t\n\t\trep(i, H) {\n\t\t\trep(j, W) {\n\t\t\t\tcin>>field[i][j];\n\t\t\t}\n\t\t}\n\t\t\n\t\tstring ans = \"0\";\n\t\trep(y, H) {\n\t\t\trep(x, W) {\n\t\t\t\tstring tmp = rec(W-x-1, H-y-1);\n\t\t\t\tans = (big2(ans, tmp)?ans:tmp);\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\twhile (ans[0]=='0') ans.erase(ans.begin());\n\t\t\n\t\tcout << (ans!=\"\"?ans:\"0\") << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include\"bits/stdc++.h\"\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<(n);i++)\n#define FOR(i,m,n) for(int i=m;i<(n);i++)\n#define ALL(x) x.begin(),x.end()\n#define ll long long\ntypedef pair<int,int> pii;\n\n\nbool isLetter[100][100];\nint H,W;\nchar A[101][101];\nstring dp[101][101];\nbool isBigger(const string &s1,const string &s2){\n\tif(s1.size()>s2.size())return true;\n\telse if(s1.size()<s2.size())return false;\n\telse{\n\t\tint N = s1.size();\n\t\tREP(i,N){\n\t\t\tif(s1[i]>s2[i])return true;\n\t\t\telse if(s1[i]<s2[i])return false;\n\t\t}\n\t\treturn false;\n\t}\n}\nvoid init(){\n\tcin>>W>>H;\n\tif(W==0)exit(0);\n\tREP(i,H+1)REP(j,W+1){\n\t\tisLetter[i][j]=false;\n\t\tdp[i][j].clear();\n\t}\n\n}\nvoid solve(){\n\tinit();\n\tREP(i,H){\n\t\tREP(j,W){\n\t\t\tcin>>A[i][j];\n\t\t\tif('A'<=A[i][j]&&A[i][j]<='Z')isLetter[i][j]=true;\n\t\t\telse dp[i][j]=A[i][j];\n\t\t}\n\t}\n\tREP(i,H){\n\t\tREP(j,W){\n\t\t\tif(isLetter[i][j]||dp[i][j].size()==0||dp[i][j][0]=='0')continue;\n\t\t\tif(i<H-1&&!isLetter[i+1][j]){\n\t\t\t\tif(isBigger(dp[i][j]+A[i+1][j],dp[i+1][j])){\n\t\t\t\t\tdp[i+1][j]=dp[i][j]+A[i+1][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(j<W-1&&!isLetter[i][j+1]){\n\t\t\t\tif(isBigger(dp[i][j]+A[i][j+1],dp[i][j+1])){\n\t\t\t\t\tdp[i][j+1]=dp[i][j]+A[i][j+1];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tstring ans =\"\";\n\tREP(i,H){\n\t\tREP(j,W){\n\t\t\tif(!isLetter[i][j]){\n\t\t\t\tif(isBigger(dp[i][j],ans))ans=dp[i][j];\n\t\t\t}\n\t\t}\n\t}\n\tcout<<ans<<endl;\n}\n\nsigned main() {\n\twhile (true) {\n\t\tsolve();\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define DIGIT(c) (c >= '0' && c <= '9')\n#define F first\n#define S second\n#define INF 1 << 30\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nint W, H;\nvector<vector<string> >dp(70, vector<string>(70));\nchar c[70][71];\n\nstring judge(string a, string b){\n  if(a[0] == '0') a.erase(a.begin());\n  if(b[0] == '0') b.erase(b.begin());\n  if(a.size() > b.size()) return a;\n  if(a.size() < b.size()) return b;\n  //  return max(a, b);\n  if(a > b) return a;\n  else return b;\n}\n\nint main(){\n  while(scanf(\"%d%d\", &W, &H) && W+H){\n    rep(i, H) scanf(\"%s\", c[i]);\n\n    rep(i, 70) rep(j, 70) dp[i][j] = \"\";\n    if(DIGIT(c[0][0])) dp[0][0] = c[0][0];\n    REP(i, 1, W) if(DIGIT(c[0][i])) dp[0][i] = dp[0][i-1] + c[0][i];\n    REP(i, 1, H) if(DIGIT(c[i][0])) dp[i][0] = dp[i-1][0] + c[i][0];\n\n    REP(i, 1, H){\n      REP(j, 1, W){\n\tif(!DIGIT(c[i][j])) continue;\n\tdp[i][j] = judge((dp[i-1][j]+c[i][j]), (dp[i][j-1]+c[i][j]));\n\t//\tcout << i << \" \" << j << \" \" << dp[i-1][j]+c[i][j] << \" \" << dp[i][j-1]+c[i][j] << endl;\n      }\n    }\n\n\n    /*    rep(i, H){\n      rep(j, W) cout << dp[i][j] << \" \";\n      puts(\"\");\n      }*/\n\n    string res = \"\";\n    rep(i, H) rep(j, W) res = judge(res, dp[i][j]);\n    //    if(res[0] == '0') res.erase(res.begin());\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nstring s[99];\nint w,h;\nstring dfs(int i,int j)\n{\n\tstring t1(1,s[i][j]),t2(1,s[i][j]);\n\tif(i<h-1&&s[i+1][j]<='9')t1+=dfs(i+1,j);\n\tif(j<w-1&&s[i][j+1]<='9')t2+=dfs(i,j+1);\n\tif(t1.size()<t2.size())return t2;\n\telse if(t1.size()==t2.size()&&t1<t2)return t2;\n\telse return t1;\n}\nmain()\n{\n\twhile(cin>>w>>h,w)\n\t{\n\t\tfor(int i=0;i<h;i++)cin>>s[i];\n\t\tstring ans=\"\";\n\t\tfor(int i=0;i<h;i++)for(int j=0;j<w;j++)\n\t\t{\n\t\t\tif(s[i][j]>'9'||s[i][j]=='0')continue;\n\t\t\tstring t=dfs(i,j);\n\t\t\tif(ans.size()<t.size())ans=t;\n\t\t\telse if(ans.size()==t.size()&&ans<t)ans=t;\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <cctype>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <set>\n#include <queue>\n#include <stack>\n#include <map>\n#include <cassert>\nusing namespace std;\n\n#define REP(i, s, e) for (int i = (s); i < (e); i++)\n#define REPI(i, s, e) for (int i = (s); i <= (e); i++)\n#define rep(i, n) REP(i, 0, n)\n#define repi(i, n) REPI(i, 0, n)\n#define ALL(v) (v).begin(), (v).end()\n\n#define dump(x) (cout << #x << \" = \" << x << endl)\n#define dump2(x, y) (cout << \"(\" << #x << \", \" << #y << \") = (\" << x << \", \" << y << \")\" << endl)\n#define dump3(x, y, z) (cout << \"(\" << #x << \", \" << #y << \", \" << #z << \") = (\" << x << \", \" << y << \", \"<< z << \")\" << endl)\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\n\nint w, h;\n\n#define MAX 70\nchar brd[MAX][MAX];\n\nstring memo[MAX][MAX];\n\nint dx[] = { 1, 0 };\nint dy[] = { 0, 1 };\n\nclass num {\npublic:\n\tstring n;\n\n\tnum():n(\"\") {}\n\tnum(string n):n(f(n)) {}\n\n\tstring f(string s)\n\t{\n\t\tif (s[0] == '0' && s.size() > 1) return f(s.substr(1));\n\t\treturn s;\n\t}\n\n\tbool operator<(const num &r) const {\n\t\tif (n.size() == r.n.size())\n\t\t\treturn n < r.n;\n\t\treturn n.size() < r.n.size();\n\t}\n};\n\nstring dfs(int y, int x)\n{\n\tif (memo[y][x] != \"\")\n\t\treturn memo[y][x];\n\n\tstring ans = \"\";\n\trep(d, 2) {\n\t\tint ty = y+dy[d], tx = x+dx[d];\n\t\tif (!(0 <= ty && ty < h)) continue;\n\t\tif (!(0 <= tx && tx < w)) continue;\n\t\tif (!isdigit(brd[ty][tx])) continue;\n\t\tstring ret = brd[y][x] + dfs(ty, tx);\n\t\tif (ans.size() == ret.size())\n\t\t\tans = max(ans, ret);\n\t\telse if (ans.size() < ret.size())\n\t\t\tans = ret;\n\t}\n\tif (ans == \"\") ans = brd[y][x];\n\treturn memo[y][x] = ans;\n}\n\nint main(void)\n{\n\twhile (cin >> w >> h, w|h) {\n\t\trep(j, MAX) rep(i, MAX)\n\t\t\tmemo[j][i] = \"\";\n\n\t\trep(j, h) rep(i, w) cin >> brd[j][i];\n\n\t\tnum ans = num();\n\t\trep(j, h)\n\t\t\trep(i, w)\n\t\t\t\tif (isdigit(brd[j][i]))\n\t\t\t\t\tans = max(ans, num(dfs(j, i)));\n\n\t\tcout << ans.n << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cctype>\n#include <vector>\nusing namespace std;\n\nstruct code {\n  vector<int> V;\n  \n  bool operator<( const code& right ) const { // 数字の大小\n    if (V.size() != right.V.size()) {\n      return V.size() < right.V.size();\n    } else {\n      for (unsigned int i=0; i<V.size(); i++) {\n\tif (V[i] != right.V[i]) {\n\t  return V[i] < right.V[i];\n\t}\n      }\n    }\n    return true;\n  }\n};\n\nstruct panel {\n  bool v; // valueかどうか\n  int n; // 数字の場合は数字を入れる。\n  code C; // 「そこから先」で作れるmaxの番号\n};\n\nconst int dir[2][2] = { {0, 1}, {1, 0} };\n\nint main() {\n  int W, H;\n  char t;\n  while (scanf(\"%d%d\", &W, &H) != EOF && W && H) {\n    vector<vector<panel>> T(H, vector<panel> (W));\n    for (int i=0; i<H; i++) {\n      for (int j=0; j<W; j++) {\n\tscanf(\" %c\", &t);\n\tT[i][j].v = isdigit(t);\n\tif (T[i][j].v) {\n\t  T[i][j].n = (int)t - '0';\n\t}\n      }\n    }\n    code max;\n    for (int i=0; i<H; i++) {\n      for (int j=0; j<W; j++) {\n\tint ip = H-1-i;\n\tint jp = W-1-j;\n\tif (T[ip][jp].v) {\n\t  code X;\n\t  for (int k=0; k<2; k++) {\n\t    if (ip+dir[k][0] < H && jp+dir[k][1] < W \n\t\t&& T[ip+dir[k][0]][jp+dir[k][1]].v) {\n\t      code Ctemp = T[ip+dir[k][0]][jp+dir[k][1]].C;\n\t      if (X < Ctemp) X = Ctemp;\n\t    }\n\t  }\n\t  X.V.insert(X.V.begin(), T[ip][jp].n);\n\t  T[ip][jp].C = X;\n\t  if (T[ip][jp].n != 0 && max < X) {\n\t    max = X;\n\t  }\n\t}\n      }\n    }\n    for (unsigned int i=0; i<max.V.size(); i++) {\n      printf(\"%d\", max.V[i]);\n    }\n    printf(\"\\n\");\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define vi vector<int>\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back\n#define pii pair<int,int>\n#define mp make_pair\n#define pi 3.14159265359\n#define shosu(X) fixed << setprecision(X)\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nbool isnum(char a){\n\treturn (a >= '0' && a <= '9');\n}\nstring removezero(string a){\n\tstring rst = \"\";\n\tbool flg = false;\n\tREP(i,a.size()){\n\t\tif(flg){\n\t\t\trst += a[i];\n\t\t}else{\n\t\t\tif(a[i] != '0'){\n\t\t\t\tflg = true;\n\t\t\t\trst += a[i];\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\treturn rst;\n}\nstring getbiggerstr(string a,string b){\n\ta = removezero(a);\n\tb = removezero(b);\n\tif(a.size() < b.size()) return b;\n\telse if(a.size() > b.size()) return a;\n\tREP(i,a.size()){\n\t\tif(a[i] < b[i]) {\n\t\t\treturn b;\n\t\t}else if(a[i] > b[i]){\n\t\t\treturn a;\n\t\t}\n\t}\n\treturn a;\n}\nint main(){\n\tint w,h;\n\tchar g[70][70];\n\tstring s[70][70];\n\t//cout << getbig(\"23900\",\"23114\") << endl;\n\twhile(1){\n\t\tstring ans = \"\";\n\t\tcin >> w >> h;\n\t\tif (w == 0 && h == 0) break;\n\t\tREP(i,h) REP(j,w) cin >> g[i][j];\n\t\tREP(i,h) REP(j,w) s[i][j] = \"\";\n\t\tREP(i,h){\n\t\t\tREP(j,w){\n\t\t\t\tif(!isnum(g[i][j])) continue;\n\t\t\t\tint lx = i; int ly = j-1;\n\t\t\t\tint ux = i-1; int uy = j;\n\t\t\t\tstring l,r;\n\t\t\t\tif(lx >= 0 && ly >= 0) l = s[lx][ly];\n\t\t\t\telse l = \"\";\n\t\t\t\tif(ux >= 0 && uy >= 0) r = s[ux][uy];\n\t\t\t\telse r = \"\";\n\t\t\t\tl.pb(g[i][j]);\n\t\t\t\tr.pb(g[i][j]);\n\t\t\t\ts[i][j] = getbiggerstr(l,r);\n\t\t\t\t//cout << l << \"??¨\" << r << \" big \" << s[i][j] << endl;\n\t\t\t\tans = getbiggerstr(s[i][j],ans);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define mk make_pair\nusing namespace std;\nint dx[]={1,0},dy[]={0,1};\nint main(){\n  int w,h;\n  while(cin>>w>>h,w){\n    string s[h],t=\"\";\n    bool p[h][w];r(i,h)r(j,w)p[i][j]=0;\n    r(i,h)cin>>s[i];\n    r(i,h)r(j,w)if(s[i][j]>='1'&&s[i][j]<='9'&&!p[i][j]){\n      bool b[h][w];\n      r(k,h)r(l,w)b[k][l]=0;\n      queue<pair<int,int> >q;\n      string ss[h][w];\n      q.push(mk(i,j));\n      while(!q.empty()){\n        pair<int,int>a=q.front();q.pop();\n        int x=a.second,y=a.first;p[y][x]=1;\n        ss[y][x]+=s[y][x];\n        r(k,2){\n          int x1=x+dx[k],y1=y+dy[k];\n          if(x1<0||y1<0||x1>=w||y1>=h||s[y1][x1]<'0'||s[y1][x1]>'9')continue;\n          if(b[y1][x1]&&ss[y1][x1]<=ss[y][x]){\n            ss[y1][x1]=\"\";\n            ss[y1][x1]+=ss[y][x];\n          }\n          else{\n            ss[y1][x1]+=ss[y][x];\n            q.push(mk(y1,x1));\n            b[y1][x1]=1;\n          }\n        }\n      }string tt=\"\";\n      r(k,h)r(l,w)tt=max(tt,ss[k][l]);\n      if(t.size()<tt.size())if(t<tt)t=tt;\n      //cout<<t<<endl;\n    }\n    cout<<t<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define se second\n#define FOR(i, a, b) for(int i=(a);i<(b);i++)\n#define REP(i, n) FOR(i, 0, n)\n#define RFOR(i, a, b) for(int i=(a);i>=(b);i--)\n#define RREP(i, n) RFOR(i, n, 0)\n#define MFOR(i, m) for(auto i=(m).begin();i!=(m).end();i++)\n#define ALL(a) (a).begin(), (a).end()\n#define SZ(x) ((int)(x).size())\n\ntypedef long long int ll;\ntypedef pair<int, int> P;\ntypedef pair<ll, ll> Pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vll;\ntypedef vector<vll> vvll;\n\nconst double eps = 1e-10;\nconst int MOD = 1000000007;\nconst int INF = 1000000000;\nconst ll LINF = 1ll<<50;\n\ntemplate<typename T>\nvoid printv(vector<T> const& s) {\n  REP(i, SZ(s)) {\n    cout << s[i];\n    if(i == SZ(s)-1) {\n      cout << endl;\n    } else {\n      cout << \" \";\n    }\n  }\n}\n\nvector<int> dx = {1, 0};\nvector<int> dy = {0, 1};\n\n/* string solve(int h, int w, const vector<vector<char>> &v, vector<vector<string>> &memo, pair<int, int> pos, string now) {\n  vector<string> tmp(2);\n  REP(i, 2) {\n    int y = pos.fi + dy[i], x = pos.se + dx[i];\n    if(0 <= y && y < h && 0 <= x && x < w && '0' <= v[y][x] && v[y][x] <= '9') {\n      tmp[i] = now + memo[y][x];\n    } else {\n      tmp[i] = now;\n    }\n  }\n\n  string res = \"\";\n  if(SZ(tmp[0]) > SZ(tmp[1])) {\n    res = tmp[0];\n  } else if(SZ(tmp[1]) > SZ(tmp[0])) {\n    res = tmp[1];\n  } else if(tmp[0] > tmp[1]) {\n    res = tmp[0];\n  } else {\n    res = tmp[1];\n  }\n\n  return res;\n  if(SZ(memo[pos.fi][pos.se]) < SZ(res) || (SZ(memo[pos.fi][pos.se]) == SZ(res) && memo[pos.fi][pos.se] < res)) {\n    memo[pos.fi][pos.se] = res;\n  }\n  return memo[pos.fi][pos.se];\n} */\n\nstatic bool operator<(string s1, string s2) {\n  // cout << s1 << \":\" << s2 << endl;\n  int cnt1 = 0, cnt2 = 0;\n  while(SZ(s1) != 0 && cnt1 != SZ(s1) && s1[cnt1] == '0') {\n    cnt1++;\n  }\n  while(SZ(s2) != 0 && cnt2 != SZ(s2) && s2[cnt2] == '0') {\n    cnt2++;\n  }\n\n  string tmp1 = (cnt1 == SZ(s1) ? \"0\" : s1.substr(cnt1, SZ(s1) - cnt1));\n  string tmp2 = (cnt2 == SZ(s2) ? \"0\" : s2.substr(cnt2, SZ(s2) - cnt2));\n  if(tmp1 == \"0\" && tmp2 == \"0\") {\n    return SZ(s1) < SZ(s2);\n  } else if(SZ(tmp1) > SZ(tmp2) || (SZ(tmp1) == SZ(tmp2) && tmp1 >= tmp2)) {\n    return false;\n  } else {\n    return true;\n  }\n}\n\nint main () {\n  cin.tie(0);\n  cout << fixed << setprecision(10);\n  while(1) {\n    int w, h; cin >> w >> h;\n    if(w == 0 && h == 0) break;\n    vector<vector<char>> v(h, vector<char>(w));\n    vector<vector<string>> memo(h, vector<string>(w, \"\"));\n    REP(i, h) {\n      REP(j, w) {\n        cin >> v[i][j];\n      }\n    }\n\n    string ans = \"\";\n    RREP(i, h-1) {\n      RREP(j, w-1) {\n        if(!('A' <= v[i][j] && v[i][j] <= 'Z')) {\n          string tmp1 = to_string(v[i][j] - '0'), tmp2 = to_string(v[i][j] - '0');\n          // cout << tmp1 << \":\" << tmp2 << endl;\n          if(i != h-1) tmp1 += memo[i+1][j];\n          if(j != w-1) tmp2 += memo[i][j+1];\n          // cout << tmp1 << \":\" << tmp2 << endl;\n          string tmp = \"\";\n          if(tmp2 < tmp1) {\n            tmp = tmp1;\n          } else {\n            tmp = tmp2;\n          }\n          \n          // cout << ans << \":\" << tmp << endl;\n          if(ans < tmp) ans = tmp;\n          memo[i][j] = tmp;\n          // cout << ans << endl;\n        } else {\n          memo[i][j] = \"\";\n        }\n      }\n    }\n\n/*     REP(i, h) {\n      REP(j, w) {\n        cout << memo[i][j] << \" \";\n      }\n      cout << endl;\n    } */\n\n    int cnt = 0;\n    if(ans != \"0\") {\n      while(ans[cnt] == '0') cnt++;\n    }\n    cout << ans.substr(cnt, SZ(ans) - cnt) << endl;\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr, __VA_ARGS__)\n// #define LOG(...)\n#define FOR(i, a, b) for(int i = (int)(a); i < (int)(b); ++i)\n#define REP(i, n) for(int i = 0; i < (int)(n); ++i)\n#define RREP(i, n) for(int i = (int)(n - 1); i >= 0; --i)\n#define RFOR(i, a, b) for(int i = (int)(b - 1); i >= (int)(a); --i)\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EXIST(s, e) ((s).find(e) != (s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n#define SQ(n) (n) * (n)\n#define BIT(x, i) (((x) >> (i)) & 1)\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<char> vc;\ntypedef vector<pii> vpi;\ntypedef vector<pll> vpl;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vc> vvc;\ntypedef vector<vll> vvll;\n\nchar field[70][70];\nstring dp[70][70];\n\nstring strmax(string a, string b) {\n  if (a.length() > b.length()) return a;\n  if (a.length() < b.length()) return b;\n  return max(a, b);\n}\n\nint dx[] = {-1, 0};\nint dy[] = {0, -1};\n\nint main() {\n  int w, h;\n  while(cin >> w >> h, w) {\n    fill_n((char*)field, 70 * 70, ' ');\n    fill_n((string*)dp, 70 * 70, \"\");\n    REP(y, h) REP(x, w) {\n      cin >> field[y][x];\n    }\n    dp[h - 1][w - 1] = field[h - 1][w - 1];\n\n    string maxs = \"\";\n    RREP(y, h) RREP(x, w) {\n      REP(i, 2){\n        int sx = x + dx[i];\n        int sy = y + dy[i];\n        if (sx < 0 || sx >= w || sy < 0 || sy >= h) continue;\n        if (isnumber(field[y][x]) && isnumber(field[sy][sx])) {\n          dp[sy][sx] = strmax(dp[sy][sx], field[sy][sx] + dp[y][x]);\n          // maxs = strmax(maxs, dp[sy][sx]);\n        }\n      }\n    }\n\n    REP(y, h) REP(x, w) {\n      while(*dp[y][x].begin() == '0') dp[y][x].erase(dp[y][x].begin());\n      maxs = strmax(maxs, dp[y][x]);\n    }\n    cout << maxs << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cctype>\n\nusing namespace std;\n\nstring maxs(string a, string b){\n    if(a.size()>b.size()) return a;\n    if(a.size()<b.size()) return b;\n    for(int i=0;i<a.size();i++){\n        if(a[i] > b[i]) return a;\n        if(a[i] < b[i]) return b;\n    }\n    return a;\n}\n\nint main(void){\n  int w,h;\n  string grid[71],dp[71][71];\n\n  while(cin >> w >> h,w|h){\n    for(int i=0;i<71;i++)\n      for(int j=0;j<71;j++)dp[i][j].clear();\n\n    for(int i=0;i<h;i++)cin >> grid[i];\n\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(!isupper(grid[i][j])){\n\t  dp[i][j]=grid[i][j];\n\t  string a=\"\",b=\"\";\n\t  if(i>0 && !dp[i-1][j].empty())a=dp[i-1][j]+grid[i][j];\n\t  if(j>0 && !dp[i][j-1].empty())b=dp[i][j-1]+grid[i][j];\n\t  \n\t  while(a[0]=='0') a.erase(a.begin());\n\t  while(b[0]=='0') b.erase(b.begin());\n\n\t  dp[i][j]=maxs(dp[i][j],maxs(a,b));\n\t}\n      }\n    }\n\n    string s=\"\";\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\ts=maxs(s,dp[i][j]);\n      }\n    }\n    cout << s << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nconst int MAX_H=80;\nconst int dx[2]={1,0},dy[2]={0,1};\n\nint W,H; string ans;\nstring C[MAX_H];\nstring dp[MAX_H][MAX_H];\n\nstring comp(string a,string b){\n    if (a.size()<b.size()) return b;\n    if (a.size()>b.size()) return a;\n    return (a<b?b:a);\n}\n\nvoid solve(){\n    ans=\"\";\n    for (int i=0;i<H;++i){\n        for (int j=0;j<W;++j){\n            dp[i][j]=\"\";\n            if (9<C[i][j]-'0') continue;\n            string ret=\"\";\n            if (0<=i-1) ret=comp(ret,dp[i-1][j]);\n            if (0<=j-1) ret=comp(ret,dp[i][j-1]);\n            if (C[i][j]=='0'&&ret==\"\") continue;\n            dp[i][j]=ret+C[i][j];\n            ans=comp(ans,dp[i][j]);\n        }\n    }\n    cout << ans << '\\n';\n}\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    while(cin >> W >> H,W){\n        for (int i=0;i<H;++i) cin >> C[i];\n        solve();\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr, __VA_ARGS__)\n// #define LOG(...)\n#define FOR(i, a, b) for(int i = (int)(a); i < (int)(b); ++i)\n#define REP(i, n) for(int i = 0; i < (int)(n); ++i)\n#define RREP(i, n) for(int i = (int)(n - 1); i >= 0; --i)\n#define RFOR(i, a, b) for(int i = (int)(b - 1); i >= (int)(a); --i)\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EXIST(s, e) ((s).find(e) != (s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n#define SQ(n) (n) * (n)\n#define BIT(x, i) (((x) >> (i)) & 1)\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<char> vc;\ntypedef vector<pii> vpi;\ntypedef vector<pll> vpl;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vc> vvc;\ntypedef vector<vll> vvll;\n\nchar field[70][70];\nstring dp[70][70];\n\nstring strmax(string a, string b) {\n  if (a.length() > b.length()) return a;\n  if (a.length() < b.length()) return b;\n  return max(a, b);\n}\n\nint dx[] = {-1, 0};\nint dy[] = {0, -1};\n\nint main() {\n  int w, h;\n  while(cin >> w >> h, w) {\n    fill_n((char*)field, 70 * 70, ' ');\n    fill_n((string*)dp, 70 * 70, \"\");\n    REP(y, h) REP(x, w) {\n      cin >> field[y][x];\n    }\n    dp[h - 1][w - 1] = field[h - 1][w - 1];\n\n    string maxs = \"\";\n    RREP(y, h) RREP(x, w) {\n      REP(i, 2){\n        int sx = x + dx[i];\n        int sy = y + dy[i];\n        if (sx < 0 || sx >= w || sy < 0 || sy >= h) continue;\n        if (isdigit(field[y][x]) && isnumber(field[sy][sx])) {\n          dp[sy][sx] = strmax(dp[sy][sx], field[sy][sx] + dp[y][x]);\n          // maxs = strmax(maxs, dp[sy][sx]);\n        }\n      }\n    }\n\n    REP(y, h) REP(x, w) {\n      while(*dp[y][x].begin() == '0') dp[y][x].erase(dp[y][x].begin());\n      maxs = strmax(maxs, dp[y][x]);\n    }\n    cout << maxs << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\nstring ans;\nstring map[71];\nint w , h;\n\nint check(string a,string b) {\n\n  if(a.size() < b.size() ) return 1;\n  else if(a.size() > b.size()) return 0;\n\n  for(int i=0;i<b.size();i++) {\n    if(a[i] < b[i]) return 1;\n    else if (a[i] > b[i]) return 0;\n  }\n\n  return 0;\n}\n\n\nvoid dfs(int y,int x,string sum) {\n  sum += map[y][x];\n \n   if(y+1 < h && '0' <= map[y+1][x] && map[y+1][x] <= '9') dfs(y+1,x,sum);\n   if(x+1 < w && '0' <= map[y][x+1] && map[y][x+1] <= '9') dfs(y,x+1,sum);\n   else if(check(ans,sum) == 1) ans = sum;//,cout <<\"ans=\"<< ans <<endl;\n}\n\nint main() {\n\n  while(1) {\n  cin >> w >> h;\n  if(w == 0 && h == 0) break;\n\n  for(int i=0;i<h;i++) cin >> map[i] ;\n  ans = \"0\";\n\n  for(int i=0;i<h;i++) \n  for(int j=0;j<w;j++) {\n    if('0' < map[i][j] && map[i][j] <= '9') \n      dfs(i,j,\"\"); \n  }\n\n  cout << ans << endl;\n  }\n\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <iostream>\n#include <string>\n#include <vector>\n#include <stdlib.h>\n\nusing namespace std;\n\nbool comp( string s1, string s2 ) {\n\tfor(int i = 0; i < s1.length() ; i++ ) {\n\t\tif( s1[i] > s2[i] ) return true;\n\t\telse if( s1[i] < s2[i] ) return false;\n\t\telse continue;\n\t}\n\treturn false;\n}\n\nint isLarger( string s1, string s2 ) {\n\tstring s3;\n\tstring s4;\n\tif( s1.length() > s2.length() ) {\n\t\ts4.append( s1.length() - s2.length(), '0');\n\t\ts4 += s2;\n\t\ts3 = s1;\n\t} else if( s1.length() < s2.length() ) {\n\t\ts3.append(s2.length() - s1.length() , '0' );\n\t\ts3 += s1;\n\t\ts4 = s2;\n\t}\n\tint flg = comp( s3, s4 );\n\n\treturn flg;\n}\n\nvoid add( char c[70][70], string s, string dp[70][70], int w, int h, int x, int y) {\n\tif( x < 0 || x >= w || y < 0 || y >= h ) return;\n\tif( c[x][y] < '0' || c[x][y] > '9' ) return;\n\tstring s1 = dp[x][y];\n\tstring s2 = c[x][y] + s;\n\tif( isLarger( s1, s2 ) ) dp[x][y] = s1;\n\telse dp[x][y] = s2;\n}\n\nvoid output( string s ) {\n\n\tbool flg = false;\n\tfor(int i = 0; i < s.length() ; i++) {\n\t\tif( s[i] != '0' ) flg = true;\n\t\tif( flg ) cout << s[i];\n\t}\n\tif( flg == false ) cout << 0;\n\tcout << endl;\n\n}\n\nint main(void){\n\t//FILE* fp_in = freopen(\"data.txt\", \"r\", stdin);\n\n\twhile( 1 ) {\n\t\tstring dp[70][70];\n\t\tchar c[70][70];\n\n\t\tint w, h;\n\t\tcin >> w >> h;\n\t\tif( w == 0 && h == 0 ) break;\n\n\t\tfor(int i = 0; i < h; i++ ) {\n\t\t\tstring s;\n\t\t\tcin >> s;\n\t\t\tfor(int j = 0; j < w; j++) {\n\t\t\t\tc[j][i] = s[j];\n\t\t\t\tdp[j][i] += s[j];\n\t\t\t}\n\t\t}\n\n\t\t//動的計画法　右下から順に調べてゆく\n\t\tfor(int j = h - 1; j >= 0; j--) {\n\t\t\tfor(int i = w - 1; i >= 0; i--) {\n\t\t\t\tif( c[i][j] < '0' || c[i][j] > '9' ) continue;\n\t\t\t\tadd( c, dp[i][j], dp, w, h, i - 1, j);\n\t\t\t\tadd( c, dp[i][j], dp, w, h, i, j - 1);\n\t\t\t}\n\t\t}\n\n\t\tstring max;\n\t\tfor(int i = 0; i < h; i++) \n\t\t\tfor(int j = 0; j < w; j++) {\n\t\t\t\tif( isLarger( dp[j][i], max ) && c[j][i] >= '0' && c[j][i] <= '9' ) max = dp[j][i];\n\t\t\t}\n\t\toutput(max);\n\n\n\t}\n\t//while(1){}\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nchar data[2000];\nbool visited[2000];\nint W, H;\nstring maxi;\n\nbool isNum(char c) {\n  return c >= '0' && c <= '9';\n}\n\nmain() {\n  while(1) {\n    cin >> W >> H;\n    if(W == 0 && H == 0) break;\n    for(int i = 0; i < H; i++) {\n      for(int j = 0; j < W; j++) {\n\tcin >> data[i*W+j];\n      }\n    }\n    string dp[2000];\n    fill_n(dp, W*H, \"\");\n    fill_n(visited, W*H, false);\n    maxi = \"\";\n    for(int j = 0; j < W; j++) {\n      for(int i = 0; i < H; i++) {\n\tstring up, left;\n\tif(isNum(data[i*W+j])) {\n\t  if(i-1 >= 0) up = dp[(i-1)*W+j];\n\t  else         up = \"\";\n\t  if(j-1 >= 0) left = dp[i*W+j-1];\n\t  else         left = \"\";\n\t  if(     up.length() > left.length()) dp[i*W+j] = up;\n\t  else if(up.length() < left.length()) dp[i*W+j] = left;\n\t  else dp[i*W+j] = max(up, left);\n\t  dp[i*W+j] += data[i*W+j];\n\n\t  if(dp[i*W+j] == \"0\") dp[i*W+j] = \"\";\n\t} else {\n\t  dp[i*W+j] = \"\";\n\t}\n\tif(maxi.length() < dp[i*W+j].length()) maxi = dp[i*W+j];\n\telse if(maxi.length() == dp[i*W+j].length())\n                                    maxi = max(maxi, dp[i*W+j]);\n      }\n    }\n    if(maxi == \"\") maxi = \"0\";\n    cout << maxi << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\n\nint W, H;\nint dxy[] = {1,0};\n\nstring &solve(int y, int x, vector<vector<string> > &temp, vector<string> &str){\n  if(temp[y][x] != \"\") return temp[y][x];\n\n  string res, tstr;\n  \n  for(int i = 0; i < 2; i++){\n    int ny = y + dxy[i], nx = x + dxy[1-i];\n\n    // cout<<\"nyx \"<<ny<<\" \"<<nx<<\" \"<<y<<\" \"<<x<<endl;\n    if(ny >= H || ny < 0 || nx >= W || nx < 0) continue;\n\n    if(str[ny][nx] < '0' || '9' < str[ny][nx]) continue;\n\n    tstr = solve(ny,nx,temp,str);\n    \n    if(res.size() == tstr.size()) res = max(res, tstr);\n    else if(res.size() <= tstr.size()) res = tstr;\n  }\n\n  temp[y][x] = str[y][x];\n  \n  temp[y][x] += res;\n  \n  return temp[y][x];\n}\n\nsigned main(){\n\n  while(true){\n    string ans;\n    vector<string> str;\n    vector<vector<string> > temp;\n    \n    cin>>W>>H;\n\n    if(!H && !W) break;\n\n    str.resize(H);\n    temp.resize(H,vector<string>(W,\"\"));\n    \n    for(int i = 0; i < H; i++){\n      cin>>str[i];\n    }\n\n    for(int i = 0; i < H; i++){\n      for(int j = 0; j < W; j++){\n\t\n\tif(str[i][j] <= '0' || '9' < str[i][j]) continue;\n\n\tif(temp[i][j] == \"\"){\n\t  temp[i][j] = solve(i, j, temp, str);\n\t}\n\tif(temp[i][j][0] == '0') continue;\n\t\n\tif(ans.size() == temp[i][j].size()){\n\t    ans = max(temp[i][j], ans);\n\t} else if(ans.size() < temp[i][j].size()) ans = temp[i][j];\n\t//\tcout<<i<<\" \"<<j<<\" \"<<temp[i][j]<<\" \"<<ans<<endl;\n      }\n    }\n\n    cout<<ans<<endl;\n\n    \n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nbool isdigit(char c){\n\tif(c >= '0' && c <= '9') return true;\n\telse return false;\n}\n\nint main(){\n\tint w,h;\n\tstring field[70];\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(!w) break;\n\t\tstring dp[71][71] = {};\n\t\tfor(int i = 0;i < h;i++) cin >> field[i];\n\t\tstring ma = \"\";\n\t\tfor(int i = 1;i <= h;i++){\n\t\t\tfor(int j = 1;j <= w;j++){\n\t\t\t\tif(isdigit(field[i - 1][j - 1])){\n\t\t\t\t\tstring s1 = dp[i - 1][j],s2 = dp[i][j - 1];\n\t\t\t\t\tif(s1 == \"\" && s2 == \"\" && field[i - 1][j - 1] == '0') continue;\n\t\t\t\t\tif(s1.length() > s2.length() || (s1.length() == s2.length() && s1 > s2)){\n\t\t\t\t\t\tdp[i][j] = s1 + to_string(field[i - 1][j - 1] - '0');\n\t\t\t\t\t}else{\n\t\t\t\t\t\tdp[i][j] = s2 + to_string(field[i - 1][j - 1] - '0');\n\t\t\t\t\t}\n\t\t\t\t\tif(dp[i][j].length() > ma.length() || (dp[i][j].length() == ma.length() && dp[i][j] > ma)){\n\t\t\t\t\t\tma = dp[i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ma << endl;\n\t\t\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint main(){\n  while (1){\n    int W, H;\n    cin >> W >> H;\n    if (W == 0 && H == 0){\n      break;\n    }\n    vector<vector<char>> C(H, vector<char>(W));\n    for (int i = 0; i < H; i++){\n      for (int j = 0; j < W; j++){\n        cin >> C[i][j];\n      }\n    }\n    vector<vector<string>> dp(H, vector<string>(W, \"\"));\n    if (isdigit(C[0][0])){\n      if (C[0][0] != '0'){\n        dp[0][0] += C[0][0];\n      }\n    }\n    for (int i = 0; i < H; i++){\n      for (int j = 0; j < W; j++){\n        if (isdigit(C[i][j])){\n          if (i > 0){\n            string S = dp[i - 1][j] + C[i][j];\n            if (S != \"0\"){\n              if (dp[i][j].size() < S.size() || dp[i][j].size() == S.size() && dp[i][j] < S){\n                dp[i][j] = S;\n              }\n            }\n          }\n          if (j > 0){\n            string S = dp[i][j - 1] + C[i][j];\n            if (S != \"0\"){\n              if (dp[i][j].size() < S.size() || dp[i][j].size() == S.size() && dp[i][j] < S){\n                dp[i][j] = S;\n              }\n            }\n          }\n        }\n      }\n    }\n    string ans = \"\";\n    for (int i = 0; i < H; i++){\n      for (int j = 0; j < W; j++){\n        if (ans.size() < dp[i][j].size() || ans.size() == dp[i][j].size() && ans < dp[i][j]){\n          ans = dp[i][j];\n        }\n      }\n    }\n    cout << ans << endl;\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <queue>\n#include <utility>\n#include <map>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\ntypedef pair<int, int> P;\n\nconst int W = 70, H = 70;\nchar board[H][W];\nint w, h;\n\nbool comp(const string& a, const string& b){\n\tif(a.length() == b.length()){\n\t\tint l = a.length();\n\t\tfor(int i = 0;i < l;++i){\n\t\t\tif(a[i] == b[i]) continue;\n\t\t\telse{\n\t\t\t\treturn a[i] > b[i];\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\treturn a.length() > b.length();\n}\n\nvoid search(int x, int y, vector<string>* v){\n\tint dx[] = {1, 0}, dy[] = {0, 1};\n\tqueue<pair<P, string> > q;\n\tq.push(make_pair(make_pair(x, y), \"\"));\n\twhile(!q.empty()){\n\t\tpair<P, string> pair = q.front();\n\t\tq.pop();\n\t\tP p = pair.first;\n\t\tpair.second += board[p.second][p.first];\n\t\tif (pair.second.length() > 0) (*v).push_back(pair.second);\n\t\tfor(int i = 0;i < 2;++i){\n\t\t\tint nx = p.first + dx[i], ny = p.second + dy[i];\n\t\t\tif(0 <= nx && 0 <= ny && nx < w && ny < h && '0' <= board[ny][nx] && board[ny][nx] <= '9'){\n\t\t\t\tq.push(make_pair(make_pair(nx, ny), pair.second));\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\twhile(cin >> w >> h, w){\n\t\tvector<string> v;\n\t\tfor(int i = 0;i < h;++i){\n\t\t\tfor(int j = 0;j < w;++j){\n\t\t\t\tcin >> board[i][j];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < h;++i){\n\t\t\tfor(int j = 0;j < w;++j){\n\t\t\t\tif('0' <= board[i][j] && board[i][j] <= '9'){\n\t\t\t\t\tsearch(j, i, &v);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsort(v.begin(), v.end(), comp);\n\t\tstring ans = *(v.begin());\n\t\twhile(*(ans.begin()) == '0'){\n\t\t\tans.erase(ans.begin());\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <map>\n\nusing namespace std;\n\nint W,H;\nstring res,comp;\n\nvoid dfs(string sn, vector< pair<int,int> > ps, map< pair<int,int>,string >& memo, vector< vector<string> >& mat) {\n\tpair<int,int> np = ps[ps.size()-1];\n\tbool next = false;\n\tif (np.first+1 < H) {\n\t\tstring ns = mat[np.first+1][np.second];\n\t\tif (ns != \" \") {\n\t\t\tvector< pair<int,int> > temp = ps;\n\t\t\ttemp.push_back({np.first+1,np.second});\n\t\t\tnext = true;\n\t\t\tdfs(sn+ns,temp,memo,mat);\n\t\t}\n\t}\n\n\tif (np.second+1 < W) {\n\t\tstring ns = mat[np.first][np.second+1];\n\t\tif (ns != \" \") {\n\t\t\tvector< pair<int,int> > temp = ps;\n\t\t\ttemp.push_back({np.first,np.second+1});\n\t\t\tnext = true;\n\t\t\tdfs(sn+ns,temp,memo,mat);\n\t\t}\n\t}\n\n\tif (!next) {\n\t\tfor (int i = 0; i < ps.size(); ++i) {\n\t\t\tif (sn > memo[ps[i]]) {\n\t\t\t\tmemo[ps[i]] = sn;\n\t\t\t}\n\t\t}\n\t\tif (sn.length() >= res.length()) {\n\t\t\tif (sn.length() == res.length()) {\n\t\t\t\tif (sn > res) {\n\t\t\t\t\tres = sn;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tres = sn;\n\t\t\t}\n\t\t}\n\t}\n\treturn;\n}\n\nint main(void) {\n\twhile (cin >> W >> H, W) {\n\t\tres = \"0\";\n\t\tvector< vector<string> > mat(H,vector<string>(W));\n\t\tvector< pair<int,int> > start;\n\t\tfor (int i = 0; i < H; ++i) {\n\t\t\tfor (int j = 0; j < W; ++j) {\n\t\t\t\tstring temp = \"\";\n\t\t\t\tchar c;\n\t\t\t\tcin >> c;\n\t\t\t\tif (c >= '0' && c <= '9') {\n\t\t\t\t\tstart.push_back({i,j});\n\t\t\t\t\ttemp += c;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttemp = \" \";\n\t\t\t\t}\n\t\t\t\tmat[i][j] = temp;\n\t\t\t}\n\t\t}\n\t\tmap< pair<int,int>,string > memo;\n\t\tfor (int i = 0; i < start.size(); ++i) {\n\t\t\tif (memo[start[i]] == \"\" && mat[start[i].first][start[i].second] != \"0\") {\n\t\t\t\tcomp = \"\";\n\t\t\t\tvector< pair<int,int> > temp;\n\t\t\t\ttemp.push_back(start[i]);\n\t\t\t\tdfs(mat[start[i].first][start[i].second],temp,memo,mat);\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define reep(i,a,b) for(int i=(a);i<(b);i++)\n#define rep(i,n) reep((i),0,(n))\nstring ans=\"\";\nstring tmp=\"\";\nvector<string> v;\nint w,h;\nbool check(int a,int b){\n    if(0<=a&&a<h&&0<=b&&b<w) return true;\n    return false;\n}\nvoid foo(int a,int b){\n    tmp+=v[a].substr(b,1);\n    if(ans.size()<tmp.size()) ans=tmp;\n    else if(ans.size()==tmp.size()&&ans<tmp) ans=tmp;\n    if(check(a+1,b)&&isdigit(v[a+1][b])) foo(a+1,b);\n    if(check(a,b+1)&&isdigit(v[a][b+1])) foo(a,b+1);\n    tmp=tmp.substr(0,tmp.size()-1);\n}\nint main(){\n    while(cin>>w>>h,h||w){\n        v.clear();\n        v=vector<string>(h);\n        rep(i,h){\n            cin>>v[i];\n        }\n        ans=tmp=\"\";\n        rep(i,h){\n            rep(j,w){\n                if(isdigit(v[i][j])&&v[i][j]!='0'){\n                    foo(i,j);\n                    // cout<<i<<\" \"<<j<<\" \"<<v[i][j]<<\" \"<<ans<<endl;\n                }\n            }\n        }\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "///\n// File:  1126.cpp\n// Author: ymiyamoto\n//\n// Created on Sun Dec 10 00:54:34 2017\n//\n\n#include <cstdint>\n#include <iostream>\n#include <string>\n#include <vector>\n\nusing namespace std;\nbool bigger(string str1, string str2)\n{\n  if (str1.size() == str2.size()) {\n    return str1 < str2;\n  } else {\n    return str1.size() < str2.size();\n  }\n}\n\nstring wfs(vector<string> matrix, uint32_t i, uint32_t j, string aux)\n{\n  if (i >= matrix.size() || j >= matrix[0].size() || !isdigit(matrix[i][j]))\n    return aux;\n  else {\n    string number(aux);\n    if (number == \"\" && matrix[i][j] == '0') {\n    } else {\n      number += matrix[i][j];\n    }\n    string s1 = wfs(matrix, i + 1, j, number);\n    string s2 = wfs(matrix, i, j + 1, number);\n    return bigger(s1, s2) ? s2 : s1;\n  }\n}\n\nint32_t main()\n{\n  while (true) {\n    uint32_t W, H;\n    cin >> W >> H;\n    if (W == 0 && H == 0) break;\n    vector<string> matrix;\n    for (uint32_t i = 0; i < H; i++) {\n      string line;\n      cin >> line;\n      matrix.push_back(line);\n    }\n\n    string number = \"\";\n    for (uint32_t i = 0; i < matrix.size(); i++) {\n      for (uint32_t j = 0; j < matrix[0].size(); j++) {\n        string num = wfs(matrix, i, j, \"\");\n        if (bigger(number, num)) {\n          number = num;\n        }\n      }\n    }\n    cout << number << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n#include<cstdio>\n#include<sstream>\n#include<algorithm>\n#include<cmath>\n#include<map>\n#include<functional>\n#include<queue>\n#include<stack>\n#include<set>\nusing namespace std;\n char ta[100][100];\n \n string dp[100][100];\n bool ok(char n){\n \tfor(int i=0;i<10;i++)if(i+'0'==n)return 1;\n \treturn 0;\n }\n \nint main(){\n\tint h,w;\n\twhile(cin>>w>>h,w+h){\n\tfor(int i=0;i<h;i++)cin>>ta[i];\n\tfor(int i=0;i<h;i++)for(int j=0;j<w;j++)if(ok(ta[i][j]))dp[i][j]=ta[i][j]; \n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tif(! ok(ta[i][j]))continue;\n\t\t\tstring tmpa=\"\",tmpb=\"\";\n\t\t\tif(i>=1)tmpa=dp[i-1][j];\n\t\t\tif(j>=1)tmpb=dp[i][j-1];\n\t\t\tif(tmpa.size()>tmpb.size())dp[i][j]=tmpa;\n\t\t\telse if(tmpa.size()<tmpb.size())dp[i][j]=tmpb;\n\t\t\telse dp[i][j]=max(tmpa,tmpb);\n\t\t\tdp[i][j].push_back(ta[i][j]);\n\t\t\t//if(i&&j)cout<<i<<\" \"<<j<<\" \"<<dp[i-1][j]<<\" \"<<dp[i][j-1]<<\" \"<<min(dp[i-1][j],dp[i][j-1])<<endl;\n\t\t}\n\t}\n\tstring ans;\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t//(dp[i][j].empty())? cout<<\"N \" : cout<<dp[i][j]<<\" \" ;\n\t\tif(dp[i][j].size()>ans.size())ans=dp[i][j];\n\t\telse ans=max(ans,dp[i][j]);\n\t\t}\n\t}\n\twhile(ans[0]=='0')ans.erase(ans.begin());\n\tcout<<ans<<endl;\n\tfor(int i=0;i<100;i++)for(int j=0;j<100;j++)dp[i][j]=\"\",ta[i][j]=' ';\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cctype>\nusing namespace std;\n\nbool comp(string s, string t){\n    if(s.length() == t.length())    return s < t;\n    return s.length() < t.length();\n}\n\nint main(){\n    int w, h;\n    while(cin >> w >> h, w+h){\n        char mat[h][w];\n        for(int i = 0; i < w*h; i++)    cin >> mat[i/w][i%w];\n\n        string s[h][w];\n        for(int i = 0; i < h*w; i++)    s[i/w][i%w] = \"\";\n\n        string ans = \"\";\n\n        for(int i = 0; i < h; i++){\n            for(int j = 0; j < w; j++){\n                if(isdigit(mat[i][j])){\n                    string prefix = \"\";\n                    if(i != 0 && s[i-1][j] != \"\") prefix = s[i-1][j];\n                    if(j != 0 && comp(prefix, s[i][j-1]))  prefix = s[i][j-1];\n                    prefix += mat[i][j];\n                    if(prefix == \"0\")   continue;\n                    s[i][j] = prefix;\n                    if(comp(ans, prefix))   ans = prefix;\n                }\n            }\n        }\n\n        cout << ans << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <map>\n#include <vector>\n#include <set>\n#include <iomanip>\n#include <stack>\n#include <fstream>\n#include <cstdint>\n#include <cmath>\n#include <algorithm>\n#include <utility>\n#include <numeric>\n#include <functional>\n\nusing namespace std;\n\nconstexpr int INF = 1000000000;/* 1e+9a */\nconstexpr int MODULO = 1000000007;\n\ntypedef int64_t ll;\n\n\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    int w, h;\n    while(cin >> w >> h){\n        if(w == 0 && h == 0) break;\n        vector<vector<char>> c;\n        for (int i = 0; i < h; ++i) {\n            c.push_back({});\n            for (int j = 0; j < w; ++j) {\n                char tmp;\n                std::cin >> tmp;\n                if('A' <= tmp && tmp <= 'Z'){\n                    tmp = '!';\n                }\n                c[i].push_back(tmp);\n            }\n        }\n        vector<vector<bool>> is_subseq(h, vector<bool>(w));\n        string maxim = \"\";\n        for (int i = 0; i < h; ++i) {\n            for (int j = 0; j < w; ++j) {\n                if(c[i][j] != '!' && c[i][j] != '0' && !is_subseq[i][j]){\n                    stack<pair<int,int>> Nxy;\n                    stack<string> Nst;\n                    Nxy.push({i, j});\n                    Nst.push(string(\"\") + c[i][j]);\n                    while(!Nxy.empty()){\n                        auto xy = Nxy.top();\n                        auto st = Nst.top();\n                        Nxy.pop(), Nst.pop();\n                        int x = xy.first;\n                        int y = xy.second;\n                        bool pushed = false;\n                        if(x+1 < h){\n                            if(c[x+1][y] != '!'){\n                                is_subseq[x+1][y] = true;\n                                Nxy.push({x+1, y});\n                                Nst.push(st + c[x+1][y]);\n                                pushed = true;\n                            }\n                        }\n                        if(y+1 < w){\n                            if(c[x][y+1] != '!'){\n                                is_subseq[x][y+1] = true;\n                                Nxy.push({x, y+1});\n                                Nst.push(st + c[x][y+1]);\n                                pushed = true;\n                            }\n                        }\n                        if(!pushed){\n                            maxim = max(st, maxim, [](const string&a, const string&b){\n                                if(a.size() == b.size())\n                                    return a < b;\n                                return a.size() < b.size();\n                            });\n                        }\n                    }\n                }\n            }\n        }\n        cout << maxim << '\\n';\n\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "\n#include <iostream>\n#include <string>\n#include <vector>\n#include <stdlib.h>\n\nusing namespace std;\n\nbool comp( string s1, string s2 ) {\n\t\n\tfor(int i = 0; i < s1.length() ; i++ ) {\n\t\tif( s1[i] > s2[i] ) return true;\n\t\telse if( s1[i] < s2[i] ) return false;\n\t\telse continue;\n\t}\n\treturn false;\n}\n\nint isLarger( string s1, string s2 ) {\n\t\n\tstring s3;\n\tstring s4;\n\tif( s1.length() > s2.length() ) {\n\t\ts4.append( s1.length() - s2.length(), '0');\n\t\ts4 += s2;\n\t\ts3 = s1;\n\t} else if( s1.length() < s2.length() ) {\n\t\ts3.append(s2.length() - s1.length() , '0' );\n\t\ts3 += s1;\n\t\ts4 = s2;\n\t} else {\n\t\ts3 = s1;\n\t\ts4 = s2;\n\t}\n\tint flg = comp( s3, s4 );\n\n\treturn flg;\n}\n\nvoid add( char c[70][70], string s, string dp[70][70], int w, int h, int x, int y) {\n\tif( x < 0 || x >= w || y < 0 || y >= h ) return;\n\tif( c[x][y] < '0' || c[x][y] > '9' ) return;\n\tstring s1 = dp[x][y];\n\tstring s2 = c[x][y] + s;\n\tif( isLarger( s1, s2 ) ) dp[x][y] = s1;\n\telse dp[x][y] = s2;\n}\n\nvoid output( string s ) {\n\n\tbool flg = false;\n\tfor(int i = 0; i < s.length() ; i++) {\n\t\tif( s[i] != '0' ) flg = true;\n\t\tif( flg ) cout << s[i];\n\t}\n\tif( flg == false ) cout << 0;\n\tcout << endl;\n\n}\nint cnt = 0;\nint main(void){\n\t//FILE* fp_in = freopen(\"data.txt\", \"r\", stdin);\n\n\twhile( 1 ) {\n\t\tstring dp[70][70];\n\t\tchar c[70][70];\n\n\t\tint w, h;\n\t\tcin >> w >> h;\n\t\tif( w == 0 && h == 0 ) break;\n\n\t\tfor(int i = 0; i < h; i++ ) {\n\t\t\tstring s;\n\t\t\tcin >> s;\n\t\t\tfor(int j = 0; j < w; j++) {\n\t\t\t\tc[j][i] = s[j];\n\t\t\t\tdp[j][i] += s[j];\n\t\t\t}\n\t\t}\n\n\t\t//動的計画法　右下から順に調べてゆく\n\t\tfor(int j = h - 1; j >= 0; j--) {\n\t\t\tfor(int i = w - 1; i >= 0; i--) {\n\t\t\t\tif( c[i][j] < '0' || c[i][j] > '9' ) continue;\n\t\t\t\tadd( c, dp[i][j], dp, w, h, i - 1, j);\n\t\t\t\tadd( c, dp[i][j], dp, w, h, i, j - 1);\n\t\t\t}\n\t\t}\n\n\t\tstring max;\n\t\tfor(int i = 0; i < h; i++) \n\t\t\tfor(int j = 0; j < w; j++) {\n\t\t\t\tif( isLarger( dp[j][i], max ) && c[j][i] >= '0' && c[j][i] <= '9' ) \n\t\t\t\t\t{\n\t\t\t\t\t\t\n\t\t\t\t\t\tmax = dp[j][i];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\toutput(max);\n\n\t}\n\t//while(1){}\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//#include \"bits/stdc++.h\"\n\n#include <iostream>\n#include <array>\n// #include <map>\n#include <string>\n// #include <algorithm>\n// #include <numeric>\n// #include <limits>\n\nusing namespace std;\n\nint w; // j\nint h; // i\nstring max_s(70, ' ');\narray<array<char, 70>, 70> field; // [i][j]\narray<array<string, 70>, 70> memo; // [i][j]\n\ninline string big(const string& a, const string& b) {\n\tif (a.size() == b.size()) {\n\t\tif (a > b) {\n\t\t\treturn a;\n\t\t} else {\n\t\t\treturn b;\n\t\t}\n\t}\n\tif (a.size() > b.size()) {\n\t\treturn a;\n\t} else {\n\t\treturn b;\n\t}\n}\n\nstring _trace(int i, int j) {\n\tif (memo[i][j] != \"\") {\n\t\treturn memo[i][j];\n\t}\n\tint new_i = i + 1;\n\tint new_j = j + 1;\n\tstring res1 = \"\";\n\tstring res2 = \"\";\n\tif (new_i < h and isdigit(field[new_i][j])) {\n\t\tres1 = _trace(new_i, j);\n\t}\n\tif (new_j < w and isdigit(field[i][new_j])) {\n\t\tres2 = _trace(i, new_j);\n\t}\n\tmemo[i][j] = field[i][j] + big(res1, res2);\n\treturn memo[i][j];\n}\n\ninline bool myIsdigit(char c) {\n\treturn ('1' <= c and c <= '9');\n}\n\nstring trace(int i, int j) {\n\tif (myIsdigit(field[i][j]) == false) {\n\t\treturn \"\";\n\t}\n\tif (i > 0 and myIsdigit(field[i - 1][j])) {\n\t\treturn \"\";\n\t}\n\tif (j > 0 and myIsdigit(field[i][j - 1])) {\n\t\treturn \"\";\n\t}\n\tauto res = _trace(i, j);\n\treturn res;\n}\n\nvoid solve() {\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\tcin >> field[i][j];\n\t\t\tmemo[i][j] = \"\";\n\t\t}\n\t}\n\tmax_s = \"\";\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\tmax_s = big(max_s, trace(i, j));\n\t\t}\n\t}\n\tcout << max_s << endl;\n}\n\nint main() {\n\n\twhile (true) {\n\t\tcin >> w >> h;\n\t\tif (w == 0 and h == 0) {\n\t\t\tbreak;\n\t\t}\n\t\tsolve();\n\t}\n\n\t//std::cout << \"\\e[38;5;0m\\e[48;5;40m --- end ---  \\e[m\" << std::endl; // debug\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include <sys/timeb.h>\n#include <fstream>\n\nusing namespace std;\n\n#define repl(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define replrev(i,a,b) for(int i=(int)(b)-1;i>=(int)(a);i--)\n#define reprev(i,n) replrev(i,0,n)\n#define repi(itr,ds) for(auto itr=ds.begin();itr!=ds.end();itr++)\n#define all(a) a.begin(),a.end()\n#define mp make_pair\n#define mt make_tuple\n#define INF 2000000000\n#define INFL 1000000000000000000LL\n#define EPS 1e-9\n#define MOD 1000000007\n#define PI 3.1415926536\n#define RMAX 4294967295\n\ntypedef long long ll;\ntypedef pair<int, int> P;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<bool> vb;\ntypedef vector<char> vc;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<P> vP;\ntypedef vector<vector<int> > vvi;\ntypedef vector<vector<bool> > vvb;\ntypedef vector<vector<ll> > vvll;\ntypedef vector<vector<char> > vvc;\ntypedef vector<vector<double> > vvd;\ntypedef vector<vector<P> > vvP;\ntypedef priority_queue<int, vector<int>, greater<int> > pqli;\ntypedef priority_queue<ll, vector<ll>, greater<ll> > pqlll;\ntypedef priority_queue<P, vector<P>, greater<P> > pqlP;\ntypedef pair<int, pair<int, int> > Edge;\ntypedef vector<Edge> vE;\ntypedef priority_queue<Edge, vector<Edge>, greater<Edge> > pqlE;\n\nbool isNum(char c) {\n\treturn (c >= '0' && c <= '9');\n}\nbool isPlusNum(char c) {\n\treturn (c >= '1' && c <= '9');\n}\n\nint main() {\n\twhile (true) {\n\t\tvector<pair<int, string>> nums;\n\t\tint W, H;\n\t\tcin >> W >> H;\n\t\tif (W == 0 && H == 0)break;\n\t\tvs f(H);\n\t\trep(i, H) {\n\t\t\tcin >> f[i];\n\t\t}\n\t\tstack<tuple<int,int,vc>>st;\n\t\trep(i, H) {\n\t\t\trep(j, W) {\n\t\t\t\tif (isPlusNum(f[i][j]) && (i == 0 || !isPlusNum(f[i - 1][j])) && (j == 0 || !isPlusNum(f[i][j - 1]))) {\n\t\t\t\t\tst.push(mt(i, j, vc(1, f[i][j])));\n\t\t\t\t\tcout << f[i][j] << endl;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\twhile (!st.empty()) {\n\t\t\tint y = get<0>(st.top());\n\t\t\tint x = get<1>(st.top());\n\t\t\tvc s = get<2>(st.top());\n\t\t\tst.pop();\n\t\t\tif (y != H - 1 && isNum(f[y + 1][x])) {\n\t\t\t\ts.push_back(f[y + 1][x]);\n\t\t\t\tst.push(mt(y + 1, x, s));\n\t\t\t\ts.resize(s.size() - 1);\n\t\t\t}\n\t\t\tif (x != W - 1 && isNum(f[y][x + 1])) {\n\t\t\t\ts.push_back(f[y][x + 1]);\n\t\t\t\tst.push(mt(y, x + 1, s));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnums.push_back(mp((int)s.size(), string(all(s))));\n\t\t\t}\n\t\t}\n\n\t\tsort(all(nums));\n\t\tcout << nums[nums.size() - 1].second << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<string>\n#include<cstdio>\nusing namespace std;\n\nchar map[80][80];\nint w,h;\nstring memo[80][80];\n\nbool isBig(string Boss,string target){\n\tif(Boss.size()<target.size()){\n\t\treturn true;\n\t}\n\telse if(Boss.size()==target.size()&&Boss<target){\n\t\treturn true;\n\t}\n\treturn false;\n}\n//int c;\nstring MAX;\nvoid\nsearch(int y,int x,string str){\n\t//c++;\n//\tif(memo[y][x]!=\"\")cout<<\"    @second\"<<endl;\n//\tcout<<\"(\"<<x<<\",\"<<y<<\")\"<<map[y][x]<<endl;\n\n\tchar *p = map[y];\n\tstring tmp = string((char*)p);\n\tstr+=tmp[x];\n//\tcout<<str<<\" \"<<memo[y][x]<<endl;\n\tif(memo[y][x]!=\"\"&&!isBig(memo[y][x],str)){\n//\t\tcout<<\"return\"<<endl;\n\t\treturn ;\n\t}\n\n\tmemo[y][x]=str;\n\tif(isBig(MAX,str))MAX=str;\n\tstring str1=\"\",str2=\"\";\n\tif(x+1<w&&map[y][x+1]>='0' && map[y][x+1]<='9')search(y,x+1,str);\n\tif(y+1<h&&\tmap[y+1][x]>='0' && map[y+1][x]<='9')search(y+1,x,str);\n\treturn ;\n}\n\nint\nmain(){\n\t//c=0;\n\twhile(true){\n\t\tcin>>w>>h;\n\t\tMAX=\"\";\n\t\tif(w==0&&h==0)break;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tscanf(\"%s\",map[i]);\n/*\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tcin>>map[i][j];\n\t\t\t\t//cout<<map[i][j];\n\t\t\t}*/\n\t\t\t//\t\t\tcout<<endl;\n\t\t}\n\t\t//for(int i=0;i<h;i++)cout<<map[i]<<endl;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++)memo[i][j]=\"\";\n\t\t}\n\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\t//string str=\"\";\n\t\t\t\tif(memo[i][j]!=\"\")continue;\n\t\t\t\tif(map[i][j]>'0'&&map[i][j]<='9')search(i,j,\"\");\n\t\t\t}\n\t\t}\n\t\tcout<<MAX<<endl;\n//\t\tcout<<\"------------\"<<endl;\n\t}\n\n//\tcout<<\"c:\"<<c<<endl;\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#define rep(i, n) for(i = 0; i < n; i++)\nusing namespace std;\n\nint w, h;\nstring s[70];\nstring dp[70][70];\n\nbool check(int i, int j, string &prev) {\n\tif (i >= h || j >= w) return false;\n\tif (prev.length() > 0) {\n\t\treturn '0' <= s[i][j] && s[i][j] <= '9';\n\t}\n\treturn '1' <= s[i][j] && s[i][j] <= '9';\n}\n\nstring Max(string &a, string &b) {\n\tif (a.length() > b.length()) return a;\n\tif (b.length() > a.length()) return b;\n\treturn max(a, b);\n}\n\nint main() {\n\tint i, j;\n\t\n\twhile (cin >> w >> h) {\n\t\tif (!w) break;\n\t\trep(i, h) cin >> s[i];\n\t\trep(i, h) {\n\t\t\trep(j, w) {\n\t\t\t\tif ('1' <= s[i][j] && s[i][j] <= '9') dp[i][j] = s[i][j];\n\t\t\t\telse dp[i][j] = \"\";\n\t\t\t}\n\t\t}\n\t\t\n\t\trep(i, h) {\n\t\t\trep(j, w) {\n\t\t\t\tif (check(i + 1, j, dp[i][j])) dp[i + 1][j] = Max(dp[i + 1][j], dp[i][j] + s[i + 1][j]);\n\t\t\t\tif (check(i, j + 1, dp[i][j])) dp[i][j + 1] = Max(dp[i][j + 1], dp[i][j] + s[i][j + 1]);\n\t\t\t}\n\t\t}\n\t\t\n\t\tstring ans = \"\";\n\t\trep(i, h) {\n\t\t\trep(j, w) {\n\t\t\t\tans = Max(ans, dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <cstring>\n#include <cstdio>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n\n#define rep(i, n) for(int i = 0; i < (n); i++)\n#define FOR(i, a, b) for(int i = (a); i < (b); i++)\n#define all(v) (v).begin(), (v).end()\n#define rev(s) (s).rbegin(), (s).rend()\n#define MP make_pair\n#define X first\n#define Y second\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int, int> P;\n\nconst int INF = 100000000;\n\nbool operator <(const string &s1, const string &s2){\n\tint i = 0;\n\twhile(s1[i] == '0' && i < s1.size()) i++;\n\tstring s = s1.substr(i, s1.size()-i);\n\ti = 0;\n\twhile(s2[i] == '0' && i < s2.size()) i++;\n\tstring t = s2.substr(i, s2.size()-i);\n\n\tif(s.size() > t.size()) return false;\n\tif(s.size() < t.size()) return true;\n\trep(i, s.size()){\n\t\tif(s[i] < t[i]) return true;\n\t\tif(s[i] > t[i]) return false;\n\t}\n\treturn false;\n}\n\nint main(){\n\twhile(1){\n\t\tint w, h;\n\t\tcin >> w >> h;\n\t\tif(!w && !h) break;\n\t\tvector<string> table(h);\n\t\trep(i, h){\n\t\t\tcin >> table[i];\n\t\t}\n\n\t\tvector<vector<string> > ls(h, vector<string>(w, \"\"));\n\n\t\trep(i, h){\n\t\t\trep(j, w){\n\t\t\t\tif(table[i][j] < '0' || table[i][j] > '9' ) continue;\n\t\t\t\tif(j-1 < 0 && i-1 < 0){\n\t\t\t\t\tls[i][j] = table[i][j];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tstring left;\n\t\t\t\tif(j-1 < 0) left = \"\";\n\t\t\t\telse left = ls[i][j-1] + table[i][j];\n\t\t\t\tstring above;\n\t\t\t\tif(i-1 < 0) above = \"\";\n\t\t\t\telse above = ls[i-1][j] + table[i][j];\n\t\t\t\tif(left < above){\n\t\t\t\t\tls[i][j] = above;\n\t\t\t\t}else{\n\t\t\t\t\tls[i][j] = left;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tstring secret;\n\n\t\trep(i, h){\n\t\t\trep(j, w){\n\t\t\t\tsecret = (secret<ls[i][j]?ls[i][j]:secret);\n\t\t\t}\n\t\t}\n\n\t\tint i = 0;\n\t\twhile(secret[i] == '0' && i < secret.size()) i++;\n\t\tstring res = secret.substr(i, secret.size()-i);\n\n\t\tcout << res << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstring dp[71][71];\nint W, H;\nstring c[71];\n\nstring dfs(int h, int w) {\t\n\tif ( dp[h][w] != \"\" ) return dp[h][w];\n\n\tstring ret = \"\";\n\tif ( h < H-1 && '0' <= c[h+1][w] && c[h+1][w] <= '9' ) {\n\t\tret = dfs(h+1, w);\n\t}\n\tif ( w < W-1 && '0' <= c[h][w+1] && c[h][w+1] <= '9' ) {\n\t\tstring tmp = dfs(h, w+1);\n\t\tif ( tmp.size() > ret.size() ) ret = tmp;\n\t\telse if ( tmp.size() == ret.size() ) ret = max(ret, tmp);\t\t\n\t}\n\n\treturn dp[h][w] = c[h][w]+ret;\n}\n\nint main() {\n\twhile ( cin >> W >> H, W|H ) {\n\t\tfor ( int i = 0; i < H; i++ ) cin >> c[i];\t \n\n\t\tfor ( int i = 0; i < 71; i++ ) {\n\t\t\tfor ( int j = 0; j < 71; j++ ) dp[i][j] = \"\";\n\t\t}\n\t\t\n\t\tstring ans = \"\";\n\t\tfor ( int i = 0; i < H; i++ ) {\n\t\t\tfor ( int j = 0; j < W; j++ ) {\n\t\t\t\tif ( '1' <= c[i][j] && c[i][j] <= '9' ) {\n\t\t\t\t\tstring tmp = dfs(i, j);\n\t\t\t\t\tif ( tmp.size() > ans.size() ) ans = tmp;\t\t\t\t\t\n\t\t\t\t\telse if ( tmp.size() == ans.size() ) ans = max(ans, tmp);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\t\t\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<math.h>\n#include<algorithm>\n#include<string>\n#include<vector>\n#include<queue>\n#include<stack>\n#include<set>\n#include<map>\n#define REP(i, N) for(ll i = 0; i < N; ++i)\n#define FOR(i, a, b) for(ll i = a; i < b; ++i)\n#define ALL(a) (a).begin(),(a).end()\n#define pb push_back\n#define INF (long long)1000000000\n#define MOD 1000000007\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll, ll> P;\nint dx[4] = {1, 0, -1, 0};\nint dy[4] = {0, 1, 0, -1};\n\nint main(void) {\n\twhile(true) {\n\t\tint W, H;\n\t\tcin>>W>>H;\n\t\tif(W == 0 && H == 0) break;\n\t\tvector<vector<char> > m(H, vector<char>(W));\n\t\tvector<vector<pair<ll, string> > > dp(H, vector<pair<ll, string> >(W));\n\t\tREP(i, H) {\n\t\t\tREP(j, W) {\n\t\t\t\tcin>>m[i][j];\n\t\t\t}\n\t\t}\n\t\tREP(i, H) {\n\t\t\tREP(j, W) {\n\t\t\t\tint nh = H - 1 - i;\n\t\t\t\tint nw = W - 1 - j;\n\t\t\t\tif(i == 0 && j == 0) {\n\t\t\t\t\tif('0' <= m[nh][nw] && m[nh][nw] <= '9') {\n\t\t\t\t\t\tdp[nh][nw].second = m[nh][nw];\n\t\t\t\t\t\tdp[nh][nw].first = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[nh][nw].first = 0;\n\t\t\t\t\t\tdp[nh][nw].second = \"\";\n\t\t\t\t\t}\n\t\t\t\t} else if(i == 0) {\n\t\t\t\t\tif('0' <= m[nh][nw] && m[nh][nw] <= '9') {\n\t\t\t\t\t\tdp[nh][nw].second = m[nh][nw];\n\t\t\t\t\t\tdp[nh][nw].second += dp[nh][nw + 1].second;\n\t\t\t\t\t\tdp[nh][nw].first = 1 + dp[nh][nw + 1].first;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[nh][nw].first = 0;\n\t\t\t\t\t\tdp[nh][nw].second = \"\";\n\t\t\t\t\t}\n\t\t\t\t} else if(j == 0) {\n\t\t\t\t\tif('0' <= m[nh][nw] && m[nh][nw] <= '9') {\n\t\t\t\t\t\tdp[nh][nw].second = m[nh][nw];\n\t\t\t\t\t\tdp[nh][nw].second += dp[nh + 1][nw].second;\n\t\t\t\t\t\tdp[nh][nw].first = 1 + dp[nh + 1][nw].first;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[nh][nw].first = 0;\n\t\t\t\t\t\tdp[nh][nw].second = \"\";\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif('0' <= m[nh][nw] && m[nh][nw] <= '9') {\n\t\t\t\t\t\tpair<ll, string> np = max(dp[nh][nw + 1], dp[nh + 1][nw]);\n\t\t\t\t\t\tdp[nh][nw].second = m[nh][nw];\n\t\t\t\t\t\tdp[nh][nw].second += np.second;\n\t\t\t\t\t\tdp[nh][nw].first = 1 + np.first;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[nh][nw].first = 0;\n\t\t\t\t\t\tdp[nh][nw].second = \"\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tll nagasa = 0;\n\t\tstring ans = \"\";\n\t\tREP(i, H) {\n\t\t\tREP(j, W) {\n\t\t\t\tif(dp[i][j].first > nagasa && (dp[i][j].second)[0] != '0') {\n\t\t\t\t\tnagasa = dp[i][j].first;\n\t\t\t\t\tans = dp[i][j].second;\n\t\t\t\t} else if(dp[i][j].first == nagasa && (dp[i][j].second)[0] != '0') {\n\t\t\t\t\tans = max(ans, dp[i][j].second);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <limits.h>\n#include <map>\n#include <math.h>\n#include <numeric>\n#include <set>\n#include <stack>\n#include <stdlib.h>\n#include <string>\n#include <vector>\n#define el endl\n#define fd fixed\n#define INF INT_MAX/2-1\n#define pb push_back\n#define mp make_pair\n#define sp fd << setprecision\nusing namespace std;\nint dx[] = {1, 0, -1, 0}, dy[] = {0, 1, 0, -1};\ntypedef vector<int> VI;\ntypedef vector<vector<int> > VVI;\ntypedef vector<string> VS;\n\nvector<string> ans;\nbool memo[70][70];\n\nvoid search(VVI code, int i, int j, string tmp, int w, int h) {\n  if (code[i][j] < 0) return;\n  tmp += (char)(code[i][j]+48);\n  memo[i][j] = true;\n  if ((i < h-1 && j < w-1 && code[i+1][j] < 0 && code[i][j+1] < 0) || (i < h-1 && j == w-1 && code[i+1][j] < 0) || (i == h-1 && j < w-1 && code[i][j+1]) || (i == h-1 && j == w-1)) ans.pb(tmp);\n  if (i < h-1) search(code, i+1, j, tmp, w, h);\n  if (j < w-1) search(code, i, j+1, tmp, w, h);\n}\n\nint main() {\n  int w, h;\n  while (cin >> w >> h, w | h) {\n    VVI code;\n    string s;\n    ans.clear();\n    for (int i = 0; i < h; i++) {\n      for (int j = 0; j < w; j++) {\n        memo[i][j] = false;\n      }\n    }\n    for (int i = 0; i < h; i++) {\n      VI tv;\n      cin >> s;\n      for (int j = 0; j < s.length(); j++) {\n        int tn = (int)(s[j]-'0');\n        if (0 <= tn && tn <= 9) {\n          tv.pb(tn);\n        } else {\n        tv.pb(-1);\n        }\n      }\n      code.pb(tv);\n    }\n    for (int i = 0; i < h; i++) {\n      for (int j = 0; j < w; j++) {\n        if (!memo[i][j]) search(code, i, j, \"\", w, h);\n      }\n    }\n    int max_digit = 0;\n    string max_num = \"\";\n    for (int i = 0; i < ans.size(); i++) {\n      if (max_digit < ans[i].length()) max_num = ans[i], max_digit = ans[i].length();\n    }\n    if (max_num[0] == '0') max_num.erase(max_num.begin());\n    cout << max_num << el;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,n) for(int i=0;i<(n);++i)\n#define loop for(;;)\n#define trace(var) cerr<<\">>> \"<<#var<<\" = \"<<var<<endl;\n#define all(v) begin(v),end(v)\n#define pb push_back\n#define inf (1e9)\n#define eps (1e-9)\n\ntypedef long long Integer ;\ntypedef long double Real;\nconst Real PI = acosl(-1);\ntypedef pair<int, int> P;\n\ntemplate<class S, class T> inline\nostream& operator<<(ostream&os, pair<S,T> p) {\n  return os << '(' << p.first << \", \" << p.second << ')';\n}\n\ntemplate<class S, class T, class U> inline\nostream& operator<<(ostream&os, tuple<S,T,U> t) {\n  return os << '('\n    << get<0>(t) << \", \"\n    << get<1>(t) << \", \"\n    << get<2>(t) << ')';\n}\n\ntemplate<class T> inline\nostream& operator<<(ostream&os, set<T> v) {\n  os << \"(set\";\n  for (T item: v) os << ' ' << item;\n  os << \")\";\n  return os;\n}\n\ntemplate<class T> inline\nostream& operator<<(ostream&os, vector<T> v) {\n  if (v.size() == 0) { return os << \"(empty)\"; }\n  os << v[0];\n  for (int i=1, len=v.size(); i<len; ++i) os << ' ' << v[i];\n  return os;\n}\n\ntemplate<class T> inline\nistream& operator>>(istream&is, vector<T>&v) {\n  rep (i, v.size()) is >> v[i];\n  return is;\n}\n\n//           ^   >  v   <\nint dx[] = { -1, 0, 1,  0 };\nint dy[] = {  0, 1, 0, -1 };\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<bool> vb;\n\nchar f[100][100];\n\nint main()\n{\n\n  int w, h;\n  while (cin >> w >> h, w and h)\n  {\n    rep (i, h) { rep (j, w) { cin >> f[i][j]; } }\n\n    stack<pair<P, string>> s;\n    rep (i, h) { rep (j, w) {\n      char c = f[i][j];\n      if (isdigit(c)) s.push(make_pair(make_pair(i, j), \"\"));\n    }}\n\n    vector<string> vs;\n    while (not s.empty()) {\n      auto p = s.top(); s.pop();\n      int i = p.first.first;\n      int j = p.first.second;\n      string str = p.second + f[i][j];\n      bool ap = false;\n      if (i < h-1 and isdigit(f[i+1][j])) {\n        s.push(make_pair(make_pair(i+1, j), str));\n        ap = true;\n      }\n      if (j < w-1 and isdigit(f[i][j+1])) {\n        s.push(make_pair(make_pair(i, j+1), str));\n        ap = true;\n      }\n      if (not ap) {\n        while (str[0] == '0') str = str.substr(1, str.size()-1);\n        vs.push_back(str);\n      }\n    }\n\n    sort(all(vs), [](string s, string t) {\n        if (s.size() != t.size()) return (s.size() < t.size());\n        rep (i, s.size()) if (s[i] != t[i]) return (s[i] < t[i]);\n        return true;\n          });\n    cout << vs[vs.size()-1] << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n#define mod 1000000007\n#define all(c) begin(c),end(c)\ntemplate <typename T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate <typename T> T &chmax(T &a, const T &b) { return a = max(a, b); }\nusing ll = long long;\nusing vi = vector<int>;\nint dd[] = { 0, 1, 0, -1, 0 }; //→↓←↑\n\nint W, H;\nstring ans;\nint m;\nvector<string> C;\nvector<vector<bool>> B;\n\nvoid dfs(int y, int x, int depth, string s)\n{\n\tif (('A' <= C[y][x] && C[y][x] <= 'Z'))\n\t{\n\t\tif (m < depth)\n\t\t{\n\t\t\tm = depth;\n\t\t\tans = s;\n\t\t}\n\t\telse if (m == depth)\n\t\t{\n\t\t\tchmax(ans, s);\n\t\t}\n\t\treturn;\n\t}\n\tB[y][x] = true;\n\tif(y < H - 1)dfs(y + 1, x, depth + 1, s + C[y][x]);\n\tif(x < W - 1)dfs(y, x + 1, depth + 1, s + C[y][x]);\n}\nvoid solve()\n{\n\twhile (true)\n\t{\n\t\tcin >> W >> H;\n\t\tif (W == 0 && H == 0)break;\n\t\tans = \"\";\n\t\tm = 0;\n\t\tC = vector<string>(H);\n\t\tB = vector<vector<bool>>(H, vector<bool>(W, false));\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tcin >> C[i];\n\t\t}\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (B[i][j] || C[i][j] == '0')continue;\n\t\t\t\tdfs(i, j, 0, \"\");\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n\nint main()\n{\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tsolve();\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <vector>\n#include <map>\n#include <set>\n#include <string>\n#include <cstring>\n#include <sstream>\n#include <algorithm>\n#include <functional>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <iomanip>\n#include <list>\n#include <tuple>\n#include <bitset>\n\nusing namespace std;\n\ninline bool cheak(int x, int y, int xMax, int yMax){ return x >= 0 && y >= 0 && xMax > x && yMax > y; }\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout << x; return sout.str(); }\ntemplate<class T> inline T sqr(T x) { return x*x; }\n\ntypedef pair<int, int> P;\ntypedef tuple<int, int, int> T;\ntypedef long long ll;\ntypedef unsigned long long ull;\n\n#define For(i,a,b)\tfor(int (i) = (a);i < (b);(i)++)\n#define rep(i,n)\tFor(i,0,n)\n#define clr(a)\t\tmemset((a), 0 ,sizeof(a))\n#define mclr(a)\t\tmemset((a), -1 ,sizeof(a))\n#define all(a)\t\t(a).begin(),(a).end()\n#define sz(a)\t\t(sizeof(a))\n#define Fill(a,v)\tfill((int*)a,(int*)(a+(sz(a)/sz(*(a)))),v)\n\nconst int dx[8] = { -1, 0, -1, 0, 1, 1, -1, -1 }, dy[8] = { 0, -1, 0, 1, -1, 1, -1, 1 };\nconst int mod = 1000000007;\nconst int INF = 1e9;\n\nstring c[71];\nint w, h;\n\nstring d[71][71];\n\nint str_compare(string s1, string s2){\n\n\twhile (s1[0] == '0'){\n\t\ts1 = s1.substr(1, s1.size() - 1);\n\t}\n\twhile (s2[0] == '0'){\n\t\ts2 = s2.substr(1, s2.size() - 1);\n\t}\n\n\tif (s1.size() > s2.size())return 1;\n\tif (s1.size() < s2.size())return 0;\n\tif (s1.size() == s2.size()){\n\t\tif (s1 > s2)return 1;\n\t\tif (s1 < s2)return 0;\n\t\tif (s1 == s2)return -1;\n\t}\n}\n\nvoid func(int y,int x){\n\n\t\n\trep(i, 2){\n\t\tint ty = y + dy[i], tx = x + dx[i];\n\t\tif (cheak(tx, ty, w, h) && (c[ty][tx] >= '0' && c[ty][tx] <= '9')){\n\n\t\t\tstring t = (c[ty][tx]) + d[y][x];\n\t\t\tif (str_compare(d[ty][tx],t ) == 0){\n\t\t\t\td[ty][tx] = t;\n\t\t\t\tfunc(ty, tx);\n\t\t\t}\n\n\t\t}\n\t}\n}\n\nint main()\n{\n\twhile (cin >> w >> h && (w || h)){\n\t\trep(y, h){\n\t\t\tcin >> c[y];\n\t\t\trep(x,w)\n\t\t\tif (c[y][x] >= '0' && c[y][x] <= '9')d[y][x] = c[y][x];\n\t\t}\n\t\tfor (int y = h - 1; y >= 0; y--)\n\t\tfor (int x = w - 1; x >= 0; x--)if (c[y][x] >= '0' && c[y][x] <= '9'){\n\t\t\tfunc(y, x);\n\t\t}\n\n\t\tstring ans = \"0\";\n\n\t\trep(y, h)rep(x, w)if (c[y][x] >= '0' && c[y][x] <= '9') {\n\t\t\tif (str_compare(ans, d[y][x]) == 0){\n\t\t\t\tans = d[y][x];\n\t\t\t}\n\t\t}\n\t\twhile (ans[0] == '0'){\n\t\t\tans = ans.substr(1, ans.size() - 1);\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define LL long long\n#define VI vector<int>\n#define VVI vector<vector<int>>\n#define VVVI vector<vector<vector<int>>>\n#define VVVVI vector<vector<vector<vector<int>>>>\n#define VL vector<LL>\n#define VVL vector<vector<LL>>\n#define VVVL vector<vector<vector<LL>>>\n#define VVVVL vector<vector<vector<vector<LL>>>>\n#define VB vector<bool>\n#define FOR(i,a,b) for(int i= (a); i<((int)b); ++i)\n#define RFOR(i,a) for(int i=(a); i >= 0; --i)\n#define FOE(i,a) for(auto i : a)\n#define ALL(c) (c).begin(), (c).end()\n#define RALL(c) (c).rbegin(), (c).rend()\n#define DUMP(x)  cerr << #x << \" = \" << (x) << endl;\n#define SUM(x) std::accumulate(ALL(x), 0LL)\n#define MIN(v) *std::min_element(v.begin(), v.end())\n#define MAX(v) *std::max_element(v.begin(), v.end())\n#define EXIST(v,x) (std::find(v.begin(), v.end(), x) != v.end())\n#define BIT(n) (1LL<<(n))\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end());\n#define EPS 1e-14\n\ntemplate<class T> T ceil(T a, T b) { return (a + b - 1) / b; }\ntemplate<class T> void print(T x) { std::cout << x << std::endl; }\ninline bool inside(int y, int x, int H, int W) { return 0 <= y and y < H and 0 <= x and x < W; }\n\nconst std::string YES = \"YES\", Yes = \"Yes\", NO = \"NO\", No = \"No\";\nconst std::vector<int> dy = { 0, 1, 0, -1 }, dx = { 1, 0, -1, 0 };    // 4近傍（右, 下, 左, 上）\n\nusing namespace std;\n\n\nbool big(string a, string b) {\n    if (a.size() != b.size()) {\n        return a.size() > b.size();\n    }\n    FOR(i, 0, a.size()) {\n        if ((a[i] - '0') > (b[i] - '0')) {\n            return true;\n        }\n        else if ((a[i] - '0') < (b[i] - '0')) {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while (true) {\n        int W, H;\n        cin >> W >> H;\n        if (W == 0 and H == 0) { break; }\n\n        vector<vector<int>> field(H, vector<int>(W, -1));\n        FOR(i, 0, H) {\n            string s;\n            cin >> s;\n            FOR(j, 0, s.size()) {\n                if (s[j] < 'A') {\n                    field[i][j] = (s[j] - '0');\n                }\n            }\n        }\n\n        vector<vector<string>> dp(H, vector<string>(W));\n        FOR(y, 0, H) {\n            FOR(x, 0, W) {\n                if (field[y][x] == -1) {\n                    continue;\n                }\n\n                if (dp[y][x].empty() and field[y][x] == 0) {\n                    continue;\n                }\n\n                // start\n                if (dp[y][x].empty()) {\n                    dp[y][x] = to_string(field[y][x]);\n                }\n\n                if (y + 1 < field.size() and field[y + 1][x] != -1) {\n                    string new_c = dp[y][x] + to_string(field[y + 1][x]);\n                    if (big(new_c, dp[y + 1][x])) {\n                        dp[y + 1][x] = new_c;\n                    }\n                }\n                if (x + 1 < field[0].size() and field[y][x + 1] != -1) {\n                    string new_c = dp[y][x] + to_string(field[y][x + 1]);\n                    if (big(new_c, dp[y][x + 1])) {\n                        dp[y][x + 1] = new_c;\n                    }\n                }\n            }\n        }\n\n        string ans = \"\";\n        FOR(y, 0, dp.size()) {\n            FOR(x, 0, dp[0].size()) {\n                if (big(dp[y][x], ans)) {\n                    ans = dp[y][x];\n                }\n            }\n        }\n\n        print(ans);\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n\n\nusing namespace std;\n\nint const N = 100;\nchar table[N][N] = {};\nbool vd[N][N] = {};\n\nvoid clear() {\n    for( int i=0; i<N; ++i )\n        for( int j=0; j<N; ++j ) {\n            table[i][j] = 0;\n            vd[i][j] = false;\n        }\n}\n\nint const dir[][2] = {{1,0}, {0, 1}};\nvoid find( vector<string>& ss, string& s, int const x, int const y, int const w, int const h )\n{\n    s += table[x][y];\n    vd[x][y] = true;\n\n    for( int i=0; i<2; ++i ) {\n        int const nx = x + dir[i][0];\n        int const ny = y + dir[i][1];\n        if ( nx < 0 || ny < 0 || nx >= w || ny >= h )\n            continue;\n        \n        if ( table[nx][ny] >= '0' && table[nx][ny] <= '9' ) {\n//            string copied = s;\n            find( ss, s, nx, ny, w, h );\n        }\n    }\n\n    ss.push_back( s );\n    s.erase( s.end() - 1 );\n}\n\ntemplate<typename T>\nstruct bun\n{\n    bool operator()( T const& l, T const& r ) {\n        return l.size() > r.size() || (l.size() == r.size() && l > r);\n    }\n};\n\nint main()\n{\n    for(;;) {\n        int w, h;\n        cin >> w >> h;\n        if ( w == 0 && h == 0 )\n            break;\n\n        clear();\n        cin.ignore(255, '\\n');\n        for( int y=0; y<h; ++y ) {\n            string s;\n            getline( cin, s );\n            for( int iii=0; iii<s.size(); ++iii ) {\n                table[iii][y] = s[iii];\n            }\n        }\n\n        vector<string> ss;\n        for( int x=0; x<N; ++x ) {\n            for( int y=0; y<N; ++y ) {\n                string s;\n                if ( table[x][y] >= '1' && table[x][y] <= '9' && !vd[x][y] ) {\n                    find( ss, s, x, y, w, h );\n                }\n            }\n        }\n        stable_sort( ss.begin(), ss.end(), bun<string>() );\n\n        //for( int i=0; i<ss.size(); ++i )\n            //cout << ss[i] << endl;\n        //    ;\n\n\n        cout << ss[0] << endl;\n        //cout << \"======\" << endl;\n    };\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\n\nvector<string> field(80);\n\nint n, m;\n\nbool use[90][90];\n\nbool isIn(int x, int y){\n    return 0 <= x && x < m && 0 <= y && y < n;\n}\n\nstring nmax(string a, string b){\n    if(a.size() != b.size()) return a.size() < b.size() ? b : a;\n    else return a < b ? b : a;\n}\n\nstring search(int x, int y, string num){\n    use[x][y] = true;\n    if (!isIn(x, y)) return num;\n    if('0' <= field[x][y] && field[x][y] <= '9'){\n        if(!(num.size() == 0 && field[x][y] == '0')) num += field[x].substr(y, 1);\n        num = nmax(search(x+1, y, num), search(x, y+1, num));\n        return num;\n    }\n    else return num;\n}\n\nint main(){\n    while(cin >> n >> m, n+m){\n        for(int i=0; i < m; i++) cin >> field[i];\n        for(int i=0; i < 90; i++) for(int j=0; j < 90; j++) use[i][j] = false;\n        string ret;\n\n        for(int i=0; i< m; i++){\n            for(int j=0; j < n; j++) if(!use[i][j] && '0' <= field[i][j] && field[i][j] <= '9') ret = nmax(ret, search(i, j, \"\"));\n        }\n\n        cout << ret << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <utility>\n#include <cctype>\nusing namespace std;\n\nchar F[70][70];\n\n// s <= t ?\nbool compare(string s, string t) {\n  int ls, lt;\n  for(ls = 0; s[ls] == '0'; ++ls) ;\n  for(lt = 0; t[lt] == '0'; ++lt) ;\n  s = s.substr(ls);\n  t = t.substr(lt);\n  if(s.length() < t.length()) return true;\n  if(s.length() > t.length()) return false;\n  for(int i = 0; i < s.length(); ++i) {\n    if(s[i] > t[i]) return false;\n  }\n  return true;\n}\n\nint main() {\n  while(true) {\n    int W, H; cin >> W >> H;\n    if(W == 0 && H == 0) break;\n    for(int i = 0; i < H; ++i) cin >> F[i];\n    string ans = \"0\";\n    queue<pair<string,pair<int,int>>> Q;\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        if(isdigit(F[i][j])) {\n          string s;\n          s.push_back(F[i][j]);\n          Q.emplace(make_pair(s,make_pair(i,j)));\n        }\n      }\n    }\n    string G[H][W];\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        G[i][j] = \"0\";\n      }\n    }\n    while(!Q.empty()) {\n      auto p = Q.front(); Q.pop();\n      if(compare(ans, p.first)) ans = p.first;\n      int i = p.second.first;\n      int j = p.second.second;\n      if(compare(G[i][j],p.first) == false) continue;\n      if(i + 1 < H && isdigit(F[i+1][j])) {\n        string s = p.first;\n        s.push_back(F[i+1][j]);\n        if(compare(G[i+1][j],s)) {\n          G[i+1][j] = s;\n          Q.emplace(make_pair(s,make_pair(i+1,j)));\n        }\n      }\n      if(j + 1 < W && isdigit(F[i][j+1])) {\n        string s = p.first;\n        s.push_back(F[i][j+1]);\n        if(compare(G[i][j+1],s)) {\n          G[i][j+1] = s;\n          Q.emplace(make_pair(s,make_pair(i,j+1)));\n        }\n      }\n    }\n    int l = 0;\n    while(ans[l] == '0') ++l;\n    ans = ans.substr(l);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nconst int dx[] = {1, 0};\nconst int dy[] = {0, 1};\n\nvector<string> board(70);\nstring memo[70][70];\nint W, H;\n\ninline bool isDigit(int x, int y)\n{\n    if ('0' <= board[y][x] && board[y][x] <= '9')\n        return true;\n    else\n        return false;\n}\n\nstring Rec(int x, int y)\n{\n    if (memo[y][x].size() != 0)\n        return memo[y][x];\n\n    string s, tmp;\n    for (int d = 0; d < 2; ++d) {\n        int nx = x + dx[d];\n        int ny = y + dy[d];\n\n        if (nx < 0 || nx >= W || ny < 0 || ny >= H || !isDigit(nx, ny))\n            continue;\n\n        tmp = Rec(nx, ny);\n        if (tmp.size() > s.size() || (tmp.size() == s.size() && tmp > s))\n            s = tmp;\n    }\n\n    return memo[y][x] = board[y][x] + s;\n}\n\nint main()\n{\n    while (cin >> W >> H, W || H) {\n        // Input\n        for (int i = 0; i < H; ++i) {\n            cin >> board[i];\n            for (int j = 0; j < W; ++j)\n                memo[i][j] = \"\";\n        }\n\n        // Solve\n        string tmp, ans;\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                if (isDigit(j, i) && memo[i][j].size() == 0) {\n                    tmp = Rec(j, i);\n                    int index = 0;\n                    while (tmp[index] == '0')\n                        index++;\n                    tmp = tmp.substr(index);\n\n                    if (tmp.size() > ans.size() || (tmp.size() == ans.size() && tmp > ans))\n                        ans = tmp;\n                }\n\n        // Output\n        cout << ans << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <iomanip>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <bitset>\n#include <stack>\n#include <utility>\n#include <numeric>\n#include <algorithm>\n#include <functional>\n#include <cctype>\n#include <complex>\n#include <string>\n#include <sstream>\n\nusing namespace std;\n\n#define all(c) c.begin(),c.end()\n#define rall(c) c.rbegin(),c.rend()\n#define mp(a,b) make_pair((a),(b))\n#define eq ==\n\ntypedef long long ll;\ntypedef complex<double> point;\ntypedef pair<int,int> pii;\n\n\nconst double EPS = 1e-9;\n\nstruct State{\n    string str;int y;int x;\n    State(string str,int y,int x) : str(str),y(y),x(x) {};\n};\n\n\nstring maxs(string a,string b){\n    while(a.size() >= 1){\n        if(a[0] != '0') break;\n        a = a.substr(1,a.size()-1);\n    }\n    while(b.size() >= 1){\n        if(b[0] != '0') break;\n        b = b.substr(1,b.size()-1);\n    }\n    if(a.length() > b.length()) return a;\n    if(a.length() < b.length()) return b;\n    for(int i=0;i<a.length();i++){\n        if(a[i] > b[i]) return a;\n        if(a[i] < b[i]) return b;\n    }\n    return a;\n}\n\nint main(){\n    while(true){\n        int W,H;\n        cin >> W >> H;\n        if(W == 0) break;\n        vector<vector<char> > C(H+2,vector<char>(W+2,'A'));\n        vector<vector<string> > memo(H+2,vector<string>(W+2));\n        stack<State> sta;\n        for(int i=1;i<=H;i++){\n            for(int j=1;j<=W;j++){\n                cin >> C[i][j];\n                if(isalpha(C[i][j])) continue;\n                string s ;\n                s = C[i][j];\n                sta.push(State(s,i,j));\n            }\n        }\n        string ret = \"0\";\n        vector<vector<char> > alr;\n        while(!sta.empty()){\n            string str = sta.top().str;\n            ret = maxs(ret,str);\n            int y = sta.top().y;\n            int x = sta.top().x;\n            sta.pop();\n\n            const int dx[] = {1,0};\n            const int dy[] = {0,1};\n            for(int i=0;i<2;i++){\n                int ny=y+dy[i],nx=x+dx[i];\n                if(isalpha(C[ny][nx])) continue;\n                string newstr = str + C[ny][nx];\n                sta.push(State(newstr,ny,nx));\n            }\n        }\n        cout << ret << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <functional>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <deque>\n#include <ctime>\n  \nusing namespace std;\n  \n#define rep(i,n) REP(i,0,n)\n#define REP(i,s,e) for(int i=(s); i<(int)(e); i++)\n#define pb push_back\n#define mp make_pair\n#define all(r) r.begin(),r.end()\n#define rall(r) r.rbegin(),r.rend()\n#define fi first\n#define se second\n#define println(X) cout<<X<<endl;\n#define DBG(X) cout<<#X<<\" : \"<<X<<endl;\n  \ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<vi> vii;\ntypedef vector<ll> vl;\ntypedef vector<vl> vll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n \nconst int INF = 1e9;\nconst ll LINF = 1e18;\nconst ll MOD = 1e9 + 7;\ndouble EPS = 1e-8;\nconst double PI = acos(-1);\n\nstring s[110];\nstring ans;\nint w, h;\nset<pair<pii, string> > st;\n\nvoid calc(int i, int j, string num){\n\tif(st.count(mp(mp(i, j), num))) return;\n\tst.insert(mp(mp(i, j), num));\n\tif(i >= h || j >= w) {\n\t\tif(ans.size() < num.size()) ans = num;\n\t\telse if(ans.size() > num.size()) return;\n\t\telse{\n\t\t\tfor(int i = 0; i < ans.size(); i++){\n\t\t\t\tif(ans[i] > num[i]) return;\n\t\t\t}\n\t\t\tans = num;\n\t\t}\n\t\treturn;\n\t}\n\tif(s[i][j]>='0' && s[i][j] <= '9'){\n\t\tnum += s[i][j];\n\t\tcalc(i + 1, j, num);\n\t\tcalc(i, j + 1, num);\n\t}\n\telse calc(INF,INF, num);\n}\n\nint main(){\n\twhile(cin>>w>>h && w && h){\n\t\tst.clear();\n\t\trep(i, h) cin>>s[i];\n\t\tans = \"\";\n\t\trep(i, h) rep(j, w) calc(i, j, \"\");\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <string>\n#include <vector>\n\nusing namespace std;\n\ntypedef vector<string> VS;\ntypedef vector<VS> VVS;\n\nvoid remove_leading_zeros ( string& str )\n{\n\twhile ( str[0] == '0' ) { str = str.substr( 1 ); }\n}\n\nbool str_comp( const string& a, const string& b )\n{\n\tif ( a.size() != b.size() ) {;\n\t\treturn a.size() < b.size();\n\t}\n\treturn a < b;\n}\n\nint main ( void )\n{\n\tint w, h;\n\twhile ( cin >> w >> h, w | h ) {\n\t\tVS mat( h );\n\t\tfor ( int i = 0; i < h; ++i ) {\n\t\t\tcin >> mat[i];\n\t\t}\n\n\t\tVVS d( h, VS( w, \"\" ) );\n\n\t\tstring ans = \"\";\n\t\tfor ( int y = 0; y < h; ++y ) {\n\t\t\tfor ( int x = 0; x < w; ++x ) {\n\t\t\t\tif ( !isdigit( mat[y][x] ) ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif ( y ) {\n\t\t\t\t\td[y][x] = max( d[y][x], d[y - 1][x] + mat[y][x], str_comp );\n\t\t\t\t\tremove_leading_zeros( d[y][x] );\n\t\t\t\t}\n\t\t\t\tif ( x ) {\n\t\t\t\t\td[y][x] = max( d[y][x], d[y][x - 1] + mat[y][x], str_comp );\n\t\t\t\t\tremove_leading_zeros( d[y][x] );\n\t\t\t\t}\n\t\t\t\t//cout << x << \", \" << y << \" = \" << d[y][x] << endl;\n\t\t\t\tans = max( ans, d[y][x], str_comp );\n\t\t\t}\n\t\t}\n\n\t\tif ( ans == \"\" ) { ans = '0'; }\n\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <functional>\n#include <vector>\n#include <utility>\n#include <cstring>\n#include <iomanip>\n#include <numeric>\n#include <cmath>\n#include <queue>\n#include <map>\nusing namespace std;\ntypedef long long ll;\nconst int INF = 1<<30; \nconst int MOD = 1e9 + 7;\nconst int dy[] = {-1, 0};\nconst int dx[] = {0, -1};\nconst int MAX_N = 80;\nvector<vector<string>> memo(MAX_N, vector<string>(MAX_N));\nint h, w;\nbool IsNumber(char ch)\n{\n    if(ch >= 'A' && ch <= 'Z') return false;\n    else return true;\n};\nstring Cal(string s, string t)\n{\n    if(s.size() > t.size()) return s;\n    else if(s.size() == t.size()) return max(s, t);\n    else return t;\n}\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    while(cin >> w >> h, h | w)\n    {\n        for(int i = 0; i < h; i++)\n        {\n            for(int j = 0; j < w; j++)\n            {\n                char ch;\n                cin >> ch;\n                memo[i][j] = ch;\n            }\n        }\n        string ans = \"\";\n        for(int i = 0; i < h; i++)\n        {\n            for(int j = 0; j < w; j++)\n            {\n                if(!(IsNumber(memo[i][j][0]))) continue;\n                string ms = \"\";\n                for(int k = 0; k < 2; k++)\n                {\n                    int ny = i + dy[k];\n                    int nx = j + dx[k];\n                    if(ny < 0 || nx < 0 || ny >= h || nx >= w) continue;\n                    if(!(IsNumber(memo[ny][nx][0]))) continue;\n                    if(memo[ny][nx][0] == '0' && memo[ny][nx].size() <= 1) continue;\n                    ms = Cal(memo[ny][nx], ms);\n                }\n                memo[i][j] = ms + memo[i][j];\n                ans = Cal(memo[i][j], ans);\n            }\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cctype>\n#include <vector>\nusing namespace std;\n\nint W, H;\nchar field[100][100];\nstring dp[100][100];\n\nbool compare(const string& s1, const string& s2){\n  if(s1.size() != s2.size()) return !(s1.size() > s2.size());\n else return !(s1 > s2);\n}\n\nvoid output(){  \n  for(int i = 0 ; i < H ; i++){\n    for(int j = 0 ; j < W ; j++){\n      cout << dp[i][j] << ' ';\n    }\n    cout << endl;\n  }\n}\n\nvoid init(){\n  for(int i = 0 ; i < 71 ; i++){\n    for(int j = 0 ; j < 71 ; j++){\n      dp[i][j] = \"\";\n    }\n  }\n}\n\nstring adjust(string s){\n  if(s.size() == 1) return s;\n  for(int i = 0 ; i < s.size() ; i++){\n    if(s[i] == '0') continue;\n    else{\n      //cout << s.substr(i) << endl;\n      return s.substr(i);\n    }\n  }\n}\n\nint main(){\n  while(cin >> W >> H){\n    if(W == 0 && H == 0) break;\n    init();\n    vector<string> vec;\n    vec.clear();\n    for(int i = 0 ; i < H ; i++){\n      for(int j = 0 ; j < W ; j++){\n\tcin >> field[i][j];\n      }\n    }\n    \n    string ans = \"\";\n    \n    for(int i = 0 ; i < H ; i++){\n      for(int j = 0 ; j < W ; j++){\n\tif(!isdigit(field[i][j])) continue;\n\tif(i == 0 && j == 0) dp[i][j] = field[i][j];\n\telse if(i == 0) dp[i][j] = dp[i][j-1] + field[i][j];\n\telse if(j == 0)\tdp[i][j] = dp[i-1][j] + field[i][j];\n\telse dp[i][j] = max(dp[i][j-1]+field[i][j], dp[i-1][j]+field[i][j], compare);\n\tvec.push_back(dp[i][j]);\n      }\n    }\n    for(int i = 0 ; i < vec.size() ; i++){\n      vec[i] = adjust(vec[i]);\n      ans = max(ans, vec[i], compare);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)   FOR(i,0,n)\n#define pb emplace_back\ntypedef long long ll;\ntypedef pair<int,int> pint;\n\nstring s[71];\nbool used[71][71];\nconst int dx[]={0,1},dy[]={1,0};\nint dp[71][71];\nstring ans;\nint w,h;\nint dfs(int x,int y,string c){\n    if(dp[y][x]!=-1){\n        if(dp[y][x]+c.size()<ans.size()) return dp[y][x]+c.size();\n    }\n    if(c.size()>ans.size()) ans=c;\n    else if(c.size()==ans.size()){\n        rep(i,c.size()){\n            if(c[i]>ans[i]){\n                ans=c;break;\n            }\n            else if((c[i]<ans[i])) break;\n        }\n    }\n    int ret=0;\n    rep(i,2){\n        int tx=x+dx[i],ty=y+dy[i];\n        if(tx>=0&&ty>=0&&tx<w&&ty<h&&isdigit(s[ty][tx])){\n            if(c==\"\"&&s[ty][tx]==0) ret=max(ret,dfs(tx,ty,c));\n            else ret=max(ret,dfs(tx,ty,c+s[ty][tx]));\n        }\n    }\n    return dp[y][x]=ret;\n}\nint main(){\n    while(cin>>w>>h,w){\n        memset(dp,-1,sizeof(dp));\n        rep(i,h) cin>>s[i];\n        ans=\"\";\n        string t;\n        rep(i,h)rep(j,w)if(isdigit(s[i][j])){\n            if(s[i][j]=='0') dfs(j,i,t);\n            else dfs(j,i,t+s[i][j]);\n        }\n        cout<<ans<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define debug(x) cout << \"debug \" << x << endl;\nconst int INF = 100000000;\nusing namespace std;\n\nchar m[75][75];\nstring ans;\n\nstring big(string a, string b){\n    if(a.size() > b.size()){\n        return a;\n    }else if(a.size() < b.size()){\n        return b;\n    }else{\n        return a > b ? a : b;\n    }\n}\n\nvoid dfs(string a, int x, int y){\n    if(a.size() != 0 || m[y][x] != '0') a+=m[y][x];\n    if(isdigit(m[y][x + 1])){\n        dfs(a, x + 1, y);\n    }\n    if(isdigit(m[y + 1][x])){\n        dfs(a, x, y + 1);\n    }\n    ans = big(ans, a);\n}\n\nint main(){\n    int w, h;\n    while(cin >> w >> h, w||h){\n        ans = \"\";\n        rep(i,h) rep(j,w) m[i + 1][j + 1] = '#';\n        rep(i,h) rep(j,w) cin >> m[i + 1][j + 1];\n        rep(i,h){\n            rep(j,w){\n                if(isdigit(m[i][j])) dfs(\"\", j, i);\n            }\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nconst int dx[] = {-1, 0};\nconst int dy[] = {0, -1};\n\nvector<string> board(70);\nstring memo[70][70];\nint W, H;\n\ninline bool isDigit(int x, int y)\n{\n    if ('0' <= board[y][x] && board[y][x] <= '9')\n        return true;\n    else\n        return false;\n}\n\nint main()\n{\n    while (cin >> W >> H, W || H) {\n        // Input\n        for (int i = 0; i < H; ++i) {\n            cin >> board[i];\n            for (int j = 0; j < W; ++j)\n                memo[i][j] = board[i][j];\n        }\n\n        // Solve\n        for (int y = H - 1; y >= 0; --y) {\n            for (int x = W - 1; x >= 0; --x) {\n                if (isDigit(x, y)) {\n                    for (int d = 0; d < 2; ++d) {\n                        int nx = x + dx[d];\n                        int ny = y + dy[d];\n\n                        if (nx < 0 || nx >= W || ny < 0 || ny >= H)\n                            continue;\n                        if (!isDigit(nx, ny))\n                            continue;\n                        string cmp = board[ny][nx] + memo[y][x];\n                        if (cmp.size() > memo[ny][nx].size() ||\n                            (cmp.size() == memo[ny][nx].size() && cmp > memo[ny][nx]))\n                            memo[ny][nx] = cmp;\n                    }\n                }\n            }\n        }\n\n        // Remove leading zero\n        for (int y = 0; y < H; ++y)\n            for (int x = 0; x < W; ++x) {\n                int index = 0;\n                while (memo[y][x][index] == '0')\n                    index++;\n                memo[y][x] = memo[y][x].substr(index);\n            }\n\n        string ans;\n        for (int y = 0; y < H; ++y)\n            for (int x = 0; x < W; ++x)\n                if (isDigit(x, y) && ((memo[y][x].size() > ans.size()) ||\n                                      (memo[y][x].size() == ans.size() && memo[y][x] > ans)))\n                    ans = memo[y][x];\n        cout << ans << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nconst int WH = 4900;\n\nchar board[WH];\nstring dp[WH];\n\nbool comp(const string& a, const string& b){\n\tif(a.length() == b.length()){\n\t\treturn a < b;\n\t}\n\treturn a.length() < b.length();\n}\n\nint main(){\n\tint w, h, m;\n\tstring r;\n\twhile(cin >> w >> h, w){\n\t\tr = \"\";\n\t\tfor(int i = 0;i < w * h;++i){\n\t\t\tcin >> board[i];\n\t\t}\n\t\tfor(int i = 0;i < h;++i){\n\t\t\tfor(int j = 0;j < w;++j){\n\t\t\t\tdp[i * w + j] = \"\";\n\t\t\t\tif(i - 1 >= 0 && dp[(i - 1) * w + j] != \"\"){\n\t\t\t\t\tdp[i * w + j] = dp[(i - 1) * w + j];\n\t\t\t\t}\n\t\t\t\tif(j - 1 >= 0 && dp[i * w + (j - 1)] != \"\"){\n\t\t\t\t\tdp[i * w + j] = max(dp[i * w + j], dp[i * w + (j - 1)], comp);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif('0' <= board[i * w + j] && board[i * w + j] <= '9'){\n\t\t\t\t\tif(dp[i * w + j] != \"\" || board[i * w + j] != '0'){\n\t\t\t\t\t\tdp[i * w + j] += board[i * w + j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse dp[i * w + j] = \"\";\n\n\t\t\t\tr = max(r, dp[i * w + j], comp);\n\t\t\t}\n\t\t}\n\t\tcout << r << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define int long long\n#define mod 1000000007\n#define for0(i, n) for(int i = 0; i < (n); i++)\n#define for1(i, n) for(int i = 1; i <= (n);i++)\n#define mp make_pair\n#define all(x) x.begin(),x.end()\nusing namespace std;\nint input() {\n\tint r;\n\tcin >> r;\n\t//scanf(\"%lld\", &r);\n\treturn r;\n}\nint h, w;\nstring s[100]; string dp[100][100];\nsigned main() {\n\twhile (cin >> h >> w, h + w) {\n\t\tstring ans = \"\";\n\t\tfor1(i, w)cin >> s[i];\n\t\tfor1(i, h)for1(j, w) {\n\t\t\tchar ch = s[j][i - 1];\n\t\t\tif ('0' <= ch && ch <= '9') {\n\t\t\t\tif (dp[i - 1][j].size() > dp[i][j - 1].size())dp[i][j] = dp[i - 1][j] + ch;\n\t\t\t\telse if (dp[i - 1][j].size() < dp[i][j - 1].size())dp[i][j] = dp[i][j - 1] + ch;\n\t\t\t\telse dp[i][j] = max(dp[i - 1][j], dp[i][j - 1]) + ch;\n\t\t\t\tif (dp[i][j] == \"0\")dp[i][j] = \"\";\n\t\t\t}\n\t\t\telse dp[i][j] = \"\";\n\t\t\tif (ans.size() < dp[i][j].size())ans = dp[i][j];\n\t\t\telse if (ans.size() == dp[i][j].size())ans = max(ans, dp[i][j]);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <fstream>\n#include <cstdio>\n#include <cmath>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <set>\n#include <map>\n#include <stack>\n#include <queue>\n#include <algorithm>\nusing namespace std;\n \n#define REP(i,n) for(int i=0; i<n; ++i)\n#define FOR(i,a,b) for(int i=a; i<=b; ++i)\n#define FORR(i,a,b) for (int i=a; i>=b; --i)\n#define pi M_PI\n \ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<ll> VL;\ntypedef vector<VI> VVI;\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> PL;\n\nstring large(string s, string t){\n    if (s.length() > t.length()) return s;\n    if (s.length() < t.length()) return t;\n    REP(i,s.length()){\n        if (s[i] > t[i]) return s;\n        if (s[i] < t[i]) return t;\n    }\n    return s;\n}\n\nint main() {\n    int w, h;\n    while (cin >> w >> h && w){\n        vector<vector<string> > dp(h, vector<string>(w));\n        REP(i,h){\n            string s;\n            cin >> s;\n            REP(j,w){\n                if (s[j] >= '0' && s[j] <= '9')\n                    dp[i][j].push_back(s[j]);\n            }\n        }\n        vector<vector<string> > a(dp);\n        REP(i,h) REP(j,w) {\n            if (dp[i][j] == \"0\" || a[i][j].empty()) continue;\n            if (i < h-1)\n                dp[i+1][j] = large(dp[i+1][j], dp[i][j]+a[i+1][j]);\n            if (j < w-1)\n                dp[i][j+1] = large(dp[i][j+1], dp[i][j]+a[i][j+1]);\n        }\n        string ans;\n        REP(i,h) REP(j,w) {\n            ans = large(ans, dp[i][j]);\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define mk make_pair\nusing namespace std;\nint dx[]={1,0},dy[]={0,1};\nint main(){\n  int w,h;\n  while(cin>>w>>h,w){\n    string s[h],t=\"\";\n    bool p[h][w];r(i,h)r(j,w)p[i][j]=0;\n    r(i,h)cin>>s[i];\n    r(i,h)r(j,w)if(s[i][j]>='1'&&s[i][j]<='9'&&!p[i][j]){\n      bool b[h][w];\n      r(k,h)r(l,w)b[k][l]=0;\n      queue<pair<int,int> >q;\n      string ss[h][w];\n      q.push(mk(i,j));\n      while(!q.empty()){\n        pair<int,int>a=q.front();q.pop();\n        int x=a.second,y=a.first;p[y][x]=1;\n        ss[y][x]+=s[y][x];\n        r(k,2){\n          int x1=x+dx[k],y1=y+dy[k];\n          if(x1<0||y1<0||x1>=w||y1>=h||s[y1][x1]<'0'||s[y1][x1]>'9')continue;\n          if(b[y1][x1]&&ss[y1][x1]<ss[y][x]){\n            ss[y1][x1]=\"\";\n            ss[y1][x1]+=ss[y][x];\n          }\n          else{\n            ss[y1][x1]+=ss[y][x];\n            q.push(mk(y1,x1));\n            b[y1][x1]=1;\n          }\n        }\n      }string tt=\"\";\n      r(k,h)r(l,w)tt=max(tt,ss[k][l]);\n      if(t.size()<tt.size())if(t<tt)t=tt;\n    }\n    cout<<t<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#define F first\n#define S second\nusing namespace std;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() == 0 && b.size() == 0)\n    return true;\n  else if(a.size() == 0)\n    return true;\n  else if(b.size() == 0)\n    return false;\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] < b[i];\n  return false;\n}\n\nint main()\n{\n\n  int w,h;\n  while(cin >> w >> h,(w || h))\n    {\n      \n      char G[h][w];\n      string ans=\"0\";\n      string dp[h][w];\n\n      for(int i=0;i<h;i++)\n\t{\n\tfor(int j=0;j<w;j++)\n\t  {\n\t    cin >> G[i][j];\n\t    if('0' <= G[i][j] && G[i][j] <= '9')\n\t      {\n\t\tdp[i][j] = G[i][j];\n\t\tans = max(ans,dp[i][j],cmp);\n\t      }\n\t\n\t  }\n\n\t}\n     \n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\n\t      if(!('0' <= G[i][j] && G[i][j] <= '9'))\n\t\tcontinue;\n\t      \n\t      dp[i][j] = max(dp[i][j],max((i-1>=0 &&('0'<= G[i-1][j] && G[i-1][j] <= '9') ?dp[i-1][j]:\"\")+dp[i][j],\n\t\t\t\t\t  (j-1>=0 &&('0'<= G[i][j-1] && G[i][j-1] <= '9') ?dp[i][j-1]:\"\")+dp[i][j],cmp),cmp);\t      \n\t      ans = max(ans,dp[i][j],cmp);\n\n\t    }\n\t}\n\n\n      bool f = false;\n      int cnt = 0;\n      for(int i=0;i<ans.size();i++)      \n\tif(ans[i] == '0' && !f)\n\t  continue;\n\telse  \n\t  {\n\t    cnt++;\n\t    f = true;\n\t    cout << ans[i];\n\t  }\n      if(cnt == 0)\n\tcout << \"0\";\n\tcout << endl;\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <algorithm>\n#include <iomanip>\nusing namespace std;\n\nstring b[70];\nstring memo[70][70];\n\nbool comp(string s1, string s2) {\n\tif(s1.size() == s2.size()) return s1 < s2;\n\treturn s1.size() < s2.size();\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tint W, H;\n\twhile(cin >> W >> H, W | H) {\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tcin >> b[i];\n\t\t}\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tfor(int j = 0; j < W; j++) {\n\t\t\t\tmemo[i][j] = \"\";\n\t\t\t\tif('1' <= b[i][j] && b[i][j] <= '9') memo[i][j] += b[i][j];\n\t\t\t}\n\t\t}\n\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tfor(int j = 0; j < W; j++) {\n\t\t\t\tif('0' <= b[i][j] && b[i][j] <= '9') {\n\t\t\t\t\tif(i + 1 < H) {\n\t\t\t\t\t\tif('0' <= b[i + 1][j] && b[i + 1][j] <= '9') {\n\t\t\t\t\t\t\tmemo[i + 1][j] = max(memo[i + 1][j], memo[i][j] + b[i + 1][j], comp);\n\t\t\t\t\t\t\tif(memo[i + 1][j] == \"0\") memo[i + 1][j] = \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(j + 1 < W) {\n\t\t\t\t\t\tif('0' <= b[i][j + 1] && b[i][j + 1] <= '9') {\n\t\t\t\t\t\t\tmemo[i][j + 1] = max(memo[i][j + 1], memo[i][j] + b[i][j + 1], comp);\n\t\t\t\t\t\t\tif(memo[i][j + 1] == \"0\") memo[i][j + 1] = \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ans = \"\";\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tfor(int j = 0; j < W; j++) {\n\t\t\t\tans = max(ans, memo[i][j], comp);\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cctype>\nusing namespace std;\n\nint main()\n{\n  int W,H,i,j;\n  string ans;\n  char matrix[70][70];\n  string dp[70][70];\n  while(cin>>W>>H,W|H){\n    for(i=0;i<H;i++){\n      for(j=0;j<W;j++){\n\t  cin>>matrix[i][j];\n\t  dp[i][j]=\"\";\n\t}\n    }\n\n    if(isdigit(matrix[0][0]) && matrix[0][0]!='0')dp[0][0]=matrix[0][0];\n    for(j=1;j<W;j++){\n      string t=dp[0][j-1];\n      if(isdigit(matrix[0][j]))t+=matrix[0][j];\n      else t=\"\";\n      if(t!=\"0\")dp[0][j]=t;\n    }\n    ans=\"\";\n    for(i=1;i<H;i++){\n      for(j=0;j<W;j++){\n\tif(!isdigit(matrix[i][j]))continue;\n\tstring t=dp[i-1][j];\n\tif(0<j-1 && isdigit(matrix[i][j-1])){\n\t  if(dp[i][j-1].size()>t.size())t=dp[i][j-1];\n\t  else if(dp[i][j-1].size()==t.size() && dp[i][j-1]>t)t=dp[i][j-1];\n\t}\n\tif(isdigit(matrix[i][j]))t+=matrix[i][j];\n\telse t=\"\";\n\tif(t!=\"0\")dp[i][j]=t;\n\n\tif(ans.size()<t.size())ans=t;\n\telse if(ans.size()==t.size() && ans<t)ans=t;\n      }\n    }\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a; i<b; ++i)\n#define rep(i,n) REP(i,0,n)\n\nchar input[70][70];\nstring dp[70][70];\n\nint comp(string s,string t) { // comp s and t if s < t return negative\n  if(s.length() != t.length()) return (s.length() - t.length());\n  rep(i,s.length()) if(s[i] != t[i]) return (s[i] - t[i]);\n  return 0;\n}\n\nint main() {\n  int w,h,n;\n  while(cin>>w>>h, w|h) {\n    string s;\n    rep(i,h) {\n      cin>>s;\n      rep(j,w) {\n\tdp[i][j] = \"\";\n\tinput[i][j] = s[j];\n      }\n    }\n\n    rep(i,h) {\n      rep(j,w) {\n\tchar c = input[i][j];\n\tif(i == 0 && j == 0) {\n\t  if(c <= '9' && c >= '0') dp[i][j] = string(1,c);\n\t}else{\n\t  if(!(c <= '9' && c >= '0')) continue;\n\t  string ab = \"\",left = \"\";\n\t  if(i > 0) ab = dp[i-1][j] + string(1,c);\n\t  if(j > 0) left = dp[i][j-1] + string(1,c);\n\t  if(comp(ab,left) <= 0) {\n\t    dp[i][j] = left;\n\t  }else{\n\t    dp[i][j] = ab;\n\t  }\n\t  if(dp[i][j][0] == '0') dp[i][j] = dp[i][j].substr(1);\n\t  //cout<<i<<\" \"<<j<<\" \"<<dp[i][j]<<endl;\n\t}\n      }\n    }\n\n    string ans = \"\";\n    rep(i,h) rep(j,w) { if(comp(ans,dp[i][j]) < 0) ans = dp[i][j]; }\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstring>\n#define pb push_back\n#include<vector>\n#include<cstdio>\nusing namespace std;\nstring m(string s,string t){\n\tint a=s.size(),b=t.size();\n\tif(a!=b)\n\t\treturn a>b?s:t;\n\treturn s>t?s:t;\n}\nint main(){\n\tint h,w;\n\twhile(scanf(\"%d%d\",&w,&h),w||h){\n\t\tstring d[80];\n\t\tfor(int i=0;i<h;i++){\n\t\t\tcin>>d[i];\n\t\t}\n\t\tstring ans=\"0\";\n\t\tstring dp[80][80];\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tif(isdigit(d[i][j])){\n\t\t\t\t\tstring a,b;\n\t\t\t\t\tdp[i][j]=\"\";\n\t\t\t\t\tdp[i][j]+=d[i][j];\n\t\t\t\t\tif(i>=1&&j>=1){\n\t\t\t\t\t\tdp[i][j]=m(dp[i-1][j],dp[i][j-1])+d[i][j];\n\t\t\t\t\t}else if(i>=1){\n\t\t\t\t\t\tdp[i][j]=dp[i-1][j]+d[i][j];\n\t\t\t\t\t}else if(j>=1){\n\t\t\t\t\t\tdp[i][j]=dp[i][j-1]+d[i][j];\n\t\t\t\t\t}\n\t\t\t\t\tif(dp[i][j][0]=='0')\n\t\t\t\t\t\tdp[i][j]=dp[i][j].substr(1);\n\t\t\t\t\tans=m(ans,dp[i][j]);\n\t\t\t\t}else\n\t\t\t\t\tdp[i][j]=\"\";\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)   FOR(i,0,n)\n#define pb emplace_back\ntypedef long long ll;\ntypedef pair<int,int> pint;\n\nstring s[71];\nbool used[71][71];\nconst int dx[]={0,1},dy[]={1,0};\nstring ans;\nint w,h;\nvoid dfs(int x,int y,string c){\n    \n    rep(i,2){\n        int tx=x+dx[i],ty=y+dy[i];\n        if(tx>=0&&ty>=0&&tx<w&&ty<h&&isdigit(s[ty][tx])){\n            if(c==\"\"&&s[ty][tx]==0) dfs(tx,ty,c);\n            else dfs(tx,ty,c+s[ty][tx]);\n        }\n    }\n    if(c.size()>ans.size()) ans=c;\n    else if(c.size()==ans.size()){\n        rep(i,c.size()){\n            if(c[i]>ans[i]){\n                ans=c;break;\n            }\n            else if((c[i]<ans[i])) break;\n        }\n    }\n}\nint main(){\n    while(cin>>w>>h,w){\n        rep(i,h) cin>>s[i];\n        ans=\"\";\n        string t;\n        rep(i,h)rep(j,w)if(isdigit(s[i][j])){\n            if(s[i][j]=='0') dfs(j,i,t);\n            else dfs(j,i,t+s[i][j]);\n        }\n        cout<<ans<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\n#include <ctype.h>\n#include <string> \n#include <cstring>\n#include <sstream>\n#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <map>\n#include <queue>\n#include <utility>\n#include <vector>\n#include <set>\n#include <iomanip>\n#include <stack>\n  \nusing namespace std;\n\n#define pi 3.141592653589793\n\n#define MAX 1000000000\n\nbool ismax(string comp1, string comp2)\n{\n\t// 第一引数の方が大きい場合true\n\twhile(comp1[0] == '0') comp1.erase(0, 1);\n\twhile(comp2[0] == '0') comp2.erase(0, 1);\n\tif(comp1.length() > comp2.length()) return true;\n\telse if(comp1.length() == comp2.length()){\n\t\tint n = 0;\n\t\twhile(n < comp1.length() && comp1[n] == comp2[n]){\n\t\t\tn++;\n\t\t}\n\t\tif(n == comp1.length() || comp1[n] - '0' > comp2[n] - '0') return true;\n\t\telse return false;\n\t} else return false;\n}\n\nstring solve(int w, int h, char c[71][71])\n{\n\tstring ans = \"\";\n\tstring result[72][72];\n\tfor(int i = h; i > 0; i--){\n\t\tresult[i][w + 1] = \"\";\n\t}\n\tfor(int i = w; i > 0; i--){\n\t\tresult[h + 1][i] = \"\";\n\t}\n\tresult[h + 1][w + 1] = \"\";\n\tfor(int i = h; i > 0; i--){\n\t\tfor(int j = w; j > 0; j--){\n\t\t\tresult[i][j] = \"\";\n\t\t\tif(isdigit(c[i][j])){\n\t\t\t\tresult[i][j] += c[i][j];\n\t\t\t\tif(ismax(result[i + 1][j], result[i][j + 1])) result[i][j] += result[i + 1][j];\n\t\t\t\telse result[i][j] += result[i][j + 1];\n\t\t\t\tif(ismax(result[i][j], ans)) ans = result[i][j];\n\t\t\t}\n\t\t}\n\t}\n\twhile(ans[0] == '0') ans.erase(0, 1); \n\treturn ans;\n}\n\n\nint main()\n{\n\tint w, h;\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(w == 0 && h == 0) break;\n\t\tchar c[71][71];\n\t\tfor(int i = 1; i < h + 1; i++){\n\t\t\tfor(int j = 1; j < w + 1; j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t}\n\t\t}\n\t\tcout << solve(w, h, c) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint W, H;\nvector<string> str;\nbool used[70][70];\nconst int dx[] = { 1, 0 };\nconst int dy[] = { 0, 1 };\n\n\nbool Comp(const string& l, const string& r) {\n\treturn l.size() == r.size() ? l < r : l.size() < r.size();\n}\n\nstring MAX(const string& l, const string& r) {\n\treturn Comp(l, r) ? r : l;\n}\n\nstring dfs(int x, int y) {\n\tused[x][y] = true;\n\tstring res;\n\tfor (int i = 0; i < 2; i++) {\n\t\tint tx = x + dx[i], ty = y + dy[i];\n\t\tif (tx >= 0 && tx < H && ty >= 0 && ty < W && !used[tx][ty] && str[tx][ty] >= '0' && str[tx][ty] <= '9') {\n\t\t\tres = MAX(res, dfs(tx, ty));\n\t\t}\n\t}\n\tused[x][y] = false;\n\treturn str[x][y] + res;\n}\n\nint main()\n{\n\twhile (cin >> W >> H, W || H) {\n\t\tstr.resize(H);\n\t\tfor (int i = 0; i < H; i++) {\n\t\t\tcin >> str[i];\n\t\t}\n\t\tstring res;\n\t\tfor (int i = 0; i < H; i++) {\n\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\tif (str[i][j] >= '1' && str[i][j] <= '9') {\n\t\t\t\t\tres = MAX(res, dfs(i, j));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nstring field[69][69];\n\nstring strComp(string a, string b) \n{\n\tstring str = a;\n\tif (a.size() > b.size()) {}\n\telse if (a.size() < b.size()) str = b;\n\telse {\n\t\tfor (int i = 0; i < a.size(); i++) {\n\t\t\tif (a[i] > b[i]) break;\n\t\t\telse if (a[i] < b[i]) {\n\t\t\t\tstr = b;\n\t\t\t\tbreak; \n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn str;\n}\n\nint main()\n{\t\n\tint w, h;\n\tstring str;\n\twhile (cin >> w >> h, w | h) {\n\t\tstring s = \"\";\n\t\tfor (int i = 0; i < h; i++) {\n\t\t\tcin >> str;\n\t\t\tfor (int j = 0; j < w; j++) {\n\t\t\t\tif (str[j] >= '0' && str[j] <= '9') {\n\t\t\t\t\tfield[i][j] = str[j];\n\t\t\t\t\tif (i > 0) {\n\t\t\t\t\t\tfield[i][j] = field[i - 1][j] + str[j];\n\t\t\t\t\t}\n\t\t\t\t\tif (j > 0) {\n\t\t\t\t\t\tfield[i][j] = strComp(field[i][j - 1] + str[j], field[i][j]);\n\t\t\t\t\t} \n\t\t\t\t\tif (field[i][j] == \"0\") field[i][j] = \"\";\n\t\t\t\t\ts = strComp(s, field[i][j]);\n\t\t\t\t} else {\n\t\t\t\t\tfield[i][j] = \"\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << s << endl;\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n#define ll long long\n#define INF (1<<30)\n#define LINF (1LL<<60)\n\n//http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#define MAXH 75\n#define MAXW 75\nvector<vector<string>> dp(MAXH, vector<string>(MAXW));\nvector<vector<int>> f(MAXH, vector<int>(MAXW));\nstring ans;\nint W, H;\n\ninline bool str_check(const string& a,const string&b) {\n\tif (a.size() > b.size()) return true;\n\telse if (a.size() < b.size()) return false;\n\telse {\n\t\tint Size = a.size();\n\t\tfor (int i = 0; i < Size;i++) {\n\t\t\tif (a[i] != b[i]) return a[i] > b[i] ? true : false;\n\t\t}\n\t}\n\treturn false;\n}\n\nvoid dfs(int h, int w, vector<vector<char>>& C) {\n\tf[h][w] = 1;\n\n\tbool dfs_f = false;\n\tif (C[h][w - 1] < 'A') {\n\t\tif (dp[h][w - 1] == \"-\") {\n\t\t\tdp[h][w - 1] = C[h][w - 1] + dp[h][w];\n\t\t\tdfs(h, w - 1, C);\n\n\t\t\tdfs_f = true;\n\t\t}\n\t\telse {\n\t\t\tif (str_check(C[h][w - 1] + dp[h][w], dp[h][w - 1])) {\n\t\t\t\tdp[h][w - 1] = C[h][w - 1] + dp[h][w];\n\t\t\t\tdfs(h, w - 1, C);\n\n\t\t\t\tdfs_f = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (C[h - 1][w] < 'A') {\n\t\tif (dp[h - 1][w] == \"-\") {\n\n\t\t\tdp[h - 1][w] = C[h - 1][w] + dp[h][w];\n\t\t\tdfs(h - 1, w, C);\n\n\t\t\tdfs_f = true;\n\t\t}\n\t\telse {\n\t\t\tif (str_check(C[h - 1][w] + dp[h][w], dp[h - 1][w])) {\n\t\t\t\tdp[h - 1][w] = C[h - 1][w] + dp[h][w];\n\t\t\t\tdfs(h - 1, w, C);\n\n\t\t\t\tdfs_f = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (!dfs_f) {\n\t\tif (str_check(dp[h][w], ans)) {\n\t\t\tans = dp[h][w];\n\t\t}\n\t}\n}\n\nint main() {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\twhile (cin >> W >> H) {\n\t\tif (W == 0 && H == 0) break;\n\t\tans = \"0\";\n\t\tfor (int i = 0; i < MAXH; i++) for (int j = 0; j < MAXW;j++) {\n\t\t\tdp[i][j] = \"-\";\n\t\t\tf[i][j] = 0;\n\t\t}\n\t\tvector<vector<char>> C(H + 2, vector<char>(W + 2, 'A'));\n\t\tfor (int i = 1; i <= H;i++) for (int j = 1; j <= W;j++) cin >> C[i][j];\n\n\t\tfor (int i = H; i > 0; i--) {\n\t\t\tfor (int j = W; j > 0;j--) {\n\t\t\t\tif (f[i][j] == 0 && C[i][j] < 'A') {\n\t\t\t\t\tdp[i][j] = C[i][j];\n\t\t\t\t\tdfs(i, j, C);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tbool zefo_flag = true;\n\t\tfor (int i = 0; i < ans.length();i++) {\n\t\t\tif (ans[i] == '0' && zefo_flag == true) continue;\n\t\t\tif (ans[i] != '0') zefo_flag = false;\n\t\t\tcout << ans[i];\n\t\t}\n\t\tcout << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <complex>\n#include <deque>\n#include <exception>\n#include <fstream>\n#include <functional>\n#include <iomanip>\n#include <ios>\n#include <iosfwd>\n#include <iostream>\n#include <istream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <locale>\n#include <map>\n#include <memory>\n#include <new>\n#include <numeric>\n#include <ostream>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <stdexcept>\n#include <streambuf>\n#include <string>\n#include <typeinfo>\n#include <utility>\n#include <valarray>\n#include <vector>\n#include <climits>\n\n#define rep(i, m, n) for(int i=int(m);i<int(n);i++)\n//#define EACH(i, c) for (auto &(i): c)\n#define all(c) begin(c),end(c)\n//#define EXIST(s, e) ((s).find(e)!=(s).end())\n//#define SORT(c) sort(begin(c),end(c))\n//#define pb emplace_back\n//#define MP make_pair\n//#define SZ(a) int((a).size())\n\n//#define LOCAL 0\n//#ifdef LOCAL\n//#define DEBUG(s) cout << (s) << endl\n//#define dump(x)  cerr << #x << \" = \" << (x) << endl\n//#define BR cout << endl;\n//#else\n//#define DEBUG(s) do{}while(0)\n//#define dump(x) do{}while(0)\n//#define BR\n//#endif\n\n\n//改造\ntypedef long long int ll;\nusing namespace std;\n#define INF (1 << 30) - 1\n#define INFl (ll)5e15\n#define DEBUG 0 //デバッグする時1にしてね\n#define dump(x)  cerr << #x << \" = \" << (x) << endl\n#define MOD 1000000007\n//ここから編集する\nint W, H;\nvector<string> vv;\nstring dp[70][70][70][70];\n\nbool integer(char c) {\n    return c >= '0' && c <= '9';\n}\n\nstring parse(string str) {\n    int start = 0;\n    for (start = 0; str[start] == '0' && start < str.size(); start++) {\n\n    }\n    return str.substr(start);\n}\n\nbool lt(string left, string right) {\n//    left = parse(left);\n//    right = parse(right);\n    if (left.size() < right.size()) {\n        return true;\n    } else if (left.size() > right.size()) {\n        return false;\n    } else {\n        rep(i, 0, left.size()) {\n            if (left[i] != right[i]) {\n                return left[i] < right[i];\n            }\n        }\n    }\n    return false;\n}\n\nstring dfs(int sh, int sw, int th, int tw) {\n    if (dp[sh][sw][th][tw] != \".\") {\n        return dp[sh][sw][th][tw];\n    }\n    if (!integer(vv[sh][sw]) || !integer(vv[th][tw])) {\n        return dp[sh][sw][th][tw] = \"\";\n    }\n    string ret = \"\";\n    if (sh == th && sw == tw) {\n        ret += vv[sh][sw];\n        return dp[sh][sw][th][tw] = ret;\n    }\n    if (th - sh + tw - sw == 1) {\n        ret += vv[sh][sw];\n        ret += vv[th][tw];\n        return dp[sh][sw][th][tw] = ret;\n    }\n\n\n    rep(mh, sh, th + 1) {\n        rep(mw, sw, tw + 1) {\n            if (sh == mh && sw == mw) {\n                continue;\n            }\n            if (mh == th && mw == tw) {\n                continue;\n            }\n            string left = dfs(sh, sw, mh, mw);\n            string right = dfs(mh, mw, th, tw);\n            if (left.size() > 0 && right.size() > 0) {\n                string tmp = \"\";\n                tmp += left.substr(0, left.size() - 1);\n                tmp += right;\n                if (lt(ret, tmp)) {\n                    ret = tmp;\n                }\n            }\n\n        }\n    }\n    return dp[sh][sw][th][tw] = ret;\n\n\n}\n\nbool solve() {\n    cin >> W >> H;\n    if (W == 0 && H == 0) {\n        return false;\n    }\n    vv.resize(H);\n    rep(i, 0, 70) {\n        rep(j, 0, 70) {\n            rep(k, 0, 70) {\n                rep(l, 0, 70) {\n                    dp[i][j][k][l] = \".\";\n                }\n            }\n        }\n    }\n\n    rep(i, 0, H) {\n        cin >> vv[i];\n    }\n\n    string ans = \"\";\n    rep(sh, 0, H) {\n        rep(th, sh, H) {\n            rep(sw, 0, W) {\n                rep(tw, sw, W) {\n                    string tmp = parse(dfs(sh, sw, th, tw));\n                    if (lt(ans, tmp)) {\n                        ans = tmp;\n                    }\n                }\n            }\n        }\n    }\n    cout << ans << endl;\n\n    return true;\n\n\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while (solve()) {\n\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstring>\n#include <fstream>\n#define rep(i,w) for(int i=0;i<(w);i++)\n\nusing namespace std;\n\nchar mat[100][100];\nstring dp[100][100];\nint w, h;\n\nstring cmp (string s, string t )\n{\n\twhile (s[0] == '0' )\n\t\ts = s.substr (1 );\n\twhile (t[0] == '0' )\n\t\tt = t.substr (1 );\n\n\tif (s.length() != t.length() )\n\t\tif ( s.length() < t.length() ) return t;\n\t\telse return s;\n\n\tint w = s.length();\n\trep (i, w ){\n\t\tif (s[i] != t[i] )\n\t\t\tif (s[i] < t[i] ) return t;\t\n\t\t\telse return s;\n\t} // end rep\n\n\treturn s;\n}\n\nvoid calc_dp (void )\n{\n\tif (isdigit (mat[0][0] ) )\n\t\tdp[0][0] += mat[0][0];\n\n\tfor (int i = 1; i < h; i++ )\n\t\tif (isdigit (mat[i][0] ) ){\n\t\t\tdp[i][0] += dp[i-1][0];\n\t\t\tdp[i][0] += mat[i][0];\n\t\t} // end if\n\tfor (int j = 1; j < w; j++ )\n\t\tif (isdigit (mat[0][j] ) ){\n\t\t\tdp[0][j] += dp[0][j-1];\n\t\t\tdp[0][j] += mat[0][j];\n\t\t} // end if\n\n\tfor (int i = 1; i < h; i++ ){\n\t\tfor (int j = 1; j < w; j++ ){\n\t\t\tif (isdigit (mat[i][j] ) ){\n\t\t\t\tdp[i][j] += cmp (dp[i-1][j], dp[i][j-1] );\n\t\t\t\tdp[i][j] += mat[i][j];\n\t\t\t} // end if\n\t\t} // end for\n\t} // end for\n}\n\nvoid init_val (void )\n{\n\tmemset (mat, 0, sizeof (mat ) );\n\trep (i, 100 )\n\t\trep (j, 100 )\n\t\t\tdp[i][j] = \"\";\n}\n\nint main()\n{\n\twhile (cin >> w >> h && w && h ){\n\t\tinit_val();\n\t\trep (i, h ){\n\t\t\tstring str = \"\";\n\t\t\tcin >> str;\n\t\t\trep (j, w ){\n\t\t\t\tmat[i][j] = (char)str[j];\n\t\t\t} // end rep\n\t\t} // end rep\n\t\tcalc_dp ();\n\t\tstring res = \"\";\n\t\trep (i, h ){\n\t\t\trep (j, w ){\n\t\t\t\tres = cmp (res, dp[i][j] );\n\t\t\t} // end rep\n\t\t} // end rep\n\t\tcout << res << endl;\t\n\t} // end while\n\t\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,n) for (int i=0;i<(n);i++)\n#define rep2(i,a,b) for (int i=(a);i<(b);i++)\n#define rrep(i,n) for (int i=(n)-1;i>=0;i--)\n#define rrep2(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef vector<int> vi;\ntypedef vector<pll> vp;\ntypedef vector<ll> vll;\n\nint W, H;\nstring c[70];\n\nstring ans;\n\nbool inside(int x, int y) {\n    return 0 <= x && x < H && 0 <= y && y < W;\n}\n\nvoid update(string t) {\n    if (ans.length() > t.length()) return;\n    if (ans.length() < t.length()) {\n        ans = t;\n        return;\n    }\n    rep(i, ans.length()) {\n        if (ans[i] > t[i]) return;\n        if (ans[i] < t[i]) {\n            ans = t;\n            return;\n        }\n    }\n}\n\nvoid dfs(int i, int j, string t) {\n    if (!inside(i, j) || !isdigit(c[i][j])) {\n        update(t);\n        return;\n    }\n\n    t += c[i][j];\n\n    dfs(i, j + 1, t);\n    dfs(i + 1, j, t);\n}\n\nsigned main() {\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(0);\n\n    while (cin >> W >> H && W) {\n        rep(i, H) cin >> c[i];\n\n        ans = \"\";\n        rep(i, H) rep(j, W) {\n            // avoid leading zero\n            if (c[i][j] == '0') continue;\n            // if this can't be top, then skip\n            if (inside(i - 1, j) && isdigit(c[i - 1][j]) && c[i - 1][j] != '0') continue;\n            if (inside(i, j - 1) && isdigit(c[i][j - 1]) && c[i][j - 1] != '0') continue;\n            dfs(i, j, \"\");\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#define MAX_H 70\n#define MAX_W 70\nusing namespace std;\n\nstring secret_num;\nstring c[MAX_H];\nstring temp;\nint count;\nint status;\n\nint p[2] = {1, 0}, q[2] = {0, 1};\n\nbool front_greater(string a, string b) {\n  for (int i = 0; i < a.size(); i++) {\n    int anum = a[i] - '0';\n    int bnum = b[i] - '0';\n    if (anum > bnum) return true;\n    if (anum < bnum) return false;\n  }\n  return false;\n}\n\nstring copy(string s) {\n  string temp;\n  for (int i = 0; i < s.size(); i++) {\n    temp.push_back(s[i]);\n  }\n  return temp;\n}\n\n\nstring set_number(string s) {\n  while (s[0] == '0') {\n    for (int i = 1; i < s.size(); i++) {\n      s[i - 1] = s[i];\n    }\n    s[s.size() - 1] = '\\0';\n  }\n  return s;\n}\n\nvoid judge(string s) {\n  s = set_number(s);\n  if (secret_num.size() < s.size()) {\n    secret_num = copy(s);\n  } else if (secret_num.size() == s.size()) {\n    if (front_greater(s, secret_num)) secret_num = copy(s);\n  }\n}\n\nstring erase_back(string s) {\n  int len = s.size();\n  string t;\n  for (int i = 0; i < len - 1; i++) {\n    t.push_back(s[i]);\n  }\n  return t;\n}\n\nvoid dfs(int w, int h, int x, int y) {\n  temp.push_back(c[y][x]);\n  for (int i = 0; i < 2; i++) {\n    int x2 = x + p[i];\n    int y2 = y + q[i];\n    if (0 <= x2 && x2 < w && 0 <= y2 && y2 < h\n\t&& '0' <= c[y2][x2] && c[y2][x2] <= '9') {\n      status = 0;\n      dfs(w, h, x2, y2);\n    } else if (status == 0) {\n      judge(temp);\n      status = 1;\n    }\n  }\n  if (status == 1) {\n    temp = erase_back(temp);\n  }\n}\n\nvoid init() {\n  for (int i = 0; i < MAX_H; i++) {\n    c[i].erase(0);\n  }\n  count = 0;\n  secret_num.erase(0);\n}\n\nint main() {\n  while (true) {\n    int w, h;\n    cin >> w >> h;\n    if (w == 0 && h == 0) return 0;\n\n    init();\n    for (int i = 0; i < h; i++) {\n      cin >> c[i];\n    }\n\n    for (int i = 0; i < h; i++) {\n      for (int j = 0; j < w; j++) {\n\tif ('0' <= c[i][j] && c[i][j] <= '9') {\n\t  status = 0;\n\t  dfs(w, h, j, i);\n\t}\n      }\n    }\n\n    cout << secret_num << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<vector>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<numeric>\n#include<cassert>\n#include<random>\nusing namespace std;\n\nbool num(char c){\n    if(c<'0' || c>'9'){return false;}\n    return true;\n}\n\nstring max(string a,string b){\n    int as=(int)a.size();\n    int bs=(int)b.size();\n    for(int i=0;a[i]=='0';i++){as--;}\n    for(int i=0;b[i]=='0';i++){bs--;}\n    if(as>bs){return a;}\n    if(bs>as){return b;}\n    for(int i=0;i<as;i++){\n        if(a[a.size()-as+i]>b[b.size()-bs+i]){return a;}\n        if(a[a.size()-as+i]<b[b.size()-bs+i]){return b;}\n    }\n    return a;\n}\n\nstring pls(char c,string s){\n    s.push_back(1);\n    for(int i=(int)s.size()-2;i>=0;i--){\n        s[i+1]=s[i];\n    }\n    s[0]=c;\n    return s;\n}\n\nint main(){\n    while(1){\n        \n        \n        \n    \n    char a[100][100]={};\n    int w,h;\n    cin>>w>>h;\n        if(w==0 && h==0){break;}\n    for(int i=0;i<h;i++){\n        for(int t=0;t<w;t++){\n            cin>>a[i][t];\n        }\n    }\n    string dp[100][100]={};\n    string ans;\n    for(int i=h-1;i>=0;i--){\n        for(int t=w-1;t>=0;t--){\n            if(num(a[i][t])){\n                dp[i][t]=pls(a[i][t],max(dp[i+1][t],dp[i][t+1]));\n                ans=max(ans,dp[i][t]);\n            }\n        }\n    }\n    bool d=true;\n        for(int i=0;i<ans.size();i++){\n            if(!d){cout<<ans[i];}\n            if(d && ans[i]!='0'){cout<<ans[i]; d=false;}\n        }\n        \n    cout<<endl;\n    \n        \n        \n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <map>\n#include <algorithm>\n\n#define lli long long int\n#define REP(i,n) for(lli i=0;i<n;i++)\n\n#define NUM 1000000\n\nusing namespace std;\n\nint length = 0;\n\nint max(int a, int b){\n\tif (a >= b)return a;\n\telse return b;\n}\n\nint isIn(int x, int y, int w, int h){\n\tif (x < 0 || w <= x || y < 0 || h <= y){\n\t\treturn 0;\n\t}\n\telse{\n\t\treturn 1;\n\t}\n}\n\nint isNum(int x, int y, string *data){\n\tif ('0' <= data[y].at(x) && data[y].at(x) <= '9'){\n\t\treturn 1;\n\t}\n\telse{\n\t\treturn 0;\n\t}\n}\n\nstring emitZero(string str){\n\n\tstring rStr = \"\";\n\tREP(i, str.size()){\n\t\tif (str.at(i) != '0'){\n\t\t\trStr = str.substr(i, str.size());\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn rStr;\n\n}\n\n\nvoid solve(int x, int y,int w,int h,string now,string *data, vector<string> *v,int **flag){\n\t\n\tif (!isIn(x,y,w,h) || isNum(x,y,data)==0){\n\t\t//cout << now << endl;\n\t\tnow = emitZero(now);\n\t\t//cout << now << endl;\n\t\t//cout << \"now.size = \" << now.size() << endl;\n\t\tlength = max(length, now.size());\n\t\tv->push_back(now);\n\t\treturn;\n\t}\n\telse{\n\t\tflag[y][x] = 1;\n\t\tstring next = now + data[y].at(x);\n\t\tsolve(x + 1, y, w, h, next, data, v,flag);\n\t\tsolve(x, y + 1, w, h, next, data, v,flag);\n\t}\n}\n\nint main(){\n\n\n\t\n\tint w, h;\n\n\twhile (cin >> w >> h){\n\t\tif (w == 0 && h == 0)break;\n\t\tlength = 0;\n\t\tstring *data;\n\t\tint **flag = new int *[h];\n\t\tvector<string> v;\n\n\t\tREP(i, h){\n\t\t\tflag[i] = new int[w];\n\t\t}\n\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tflag[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\n\t\tdata = new string[h];\n\n\t\tREP(i, h){\n\t\t\tcin >> data[i];\n\t\t\t//cout << data[i] << endl;\n\t\t}\n\n\t\tREP(y, h){\n\t\t\tREP(x, w){\n\t\t\t\tif (flag[y][x] == 0 && isNum(x,y,data)==1){\n\t\t\t\t\tsolve(x, y, w, h, \"\", data, &v, flag);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//cout << v.size() << endl;\n\t\t\n\t\tvector<string> ans;\n\n\t\t//cout << \"maxLength=\" << length << endl;;\n\n\t\tREP(i, v.size()){\n\t\t\tif (v.at(i).size() == length){\n\t\t\t\tans.push_back(v.at(i));\n\t\t\t}\n\t\t}\n\n\t\tsort(ans.begin(), ans.end());\n\n\t\t\n\t\tcout << ans.back() << endl;\n\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <iostream>\n#include <map>\n#include <cmath>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <stdlib.h>\n#include <stdio.h>\n#include <bitset>\n#include <cstring>\nusing namespace std;\n#define FOR(I,A,B) for(int I = (A); I < (B); ++I)\n#define CLR(mat) memset(mat, 0, sizeof(mat))\ntypedef long long ll;\nint W, H;\nvector<string> vs(70);\nstring ans;\nbool checked[70][70]; \nbool calc(string a, string b) {\nchecked[h][w] = true;\n  if(a.length() > b.length()) return true;\n  if(a.length() < b.length()) return false;\n  else return a > b;\n}\nvoid dfs(int h, int w, string s) {\n  if(h < 0 || h >= H || w < 0 || w >= W || !isdigit(vs[h][w])) {\n    if(calc(s, ans)) ans = s;\n    return;\n  }\n  s += vs[h][w];\n  dfs(h+1,w,s);\n  dfs(h,w+1,s);\n  return;\n}\nint main()\n{\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  while(cin>>W>>H,W||H) {\n    FOR(i,0,H) cin >> vs[i];\n    ans = \"\";\n    CLR(checked);\n    FOR(h,0,H) {\n      FOR(w,0,W) {\n        if(checked[h][w]) continue;\n        checked[h][w] = true;\n        dfs(h, w, \"\");\n      } \n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define vi vector<int>\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back\n#define pii pair<int,int>\n#define mp make_pair\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nint w,h;\nvector<string> data;\n\nint dx[2]={1,0};\nint dy[2]={0,1};\nbool inrange(int x,int y){ \n\tif(x<0||y<0||x>h-1||y>w-1) return false;\n\telse return true;\n}\n\nstring getbigger(string a,string b){\n\tif(a.size()!=b.size()){\n\t\tif(a.size()>b.size()) return a;\n\t\telse return b;\n\t}\n\telse{\n\t\tREP(i,a.size()){\n\t\t\tif(a[i]==b[i]) continue;\n\t\t\tif(a[i]>b[i]) return a;\n\t\t\telse  return b;\n\t\t}\n\t\treturn a;//eq\n\t}\n}\n\nstring solve(int px,int py,bool sudeni[100][100]){\n\n\tstring rst = \"\";\n\tif(!inrange(px,py)) return \"\";\n\tif(sudeni[px][py]==false && '0'<=data[px][py] && data[px][py]<='9') {\n\t\trst+=data[px][py];\n\t\tsudeni[px][py] = true;\n\t}\n\tvector<string> tmp;\n\tREP(i,2){\n\t\ttmp.pb(\"\");\n\t\tint nx = px + dx[i];\n\t\tint ny = py + dy[i];\n\t\tif(inrange(nx,ny) && sudeni[nx][ny]==false && '0'<=data[nx][ny] && data[nx][ny]<='9') {\n\t\t\ttmp[i]=solve(nx,ny,sudeni);\n\t\t}\n\t}\n\trst += getbigger(tmp[0],tmp[1]);\n\treturn  rst;\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(w==0&&h==0) break;\n\t\tdata.clear();\n\t\tREP(i,h){\n\t\t\tstring tmp;\n\t\t\tcin >> tmp;\n\t\t\tdata.pb(tmp);\n\t\t}\n\t\tstring ans = \"-1\";\n\t\tREP(i,h){\n\t\t\tREP(j,w){\n\t\t\t\tbool s[100][100];\n\t\t\t\tREP(i,100) REP(j,100) s[i][j]=false;\n\t\t\t\tans = getbigger(solve(i,j,s),ans);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\nint w, h;\nvector<string> c;\nstring dp[100][100];\n\nstring cmax(string& a, string& b){\n\tif(a.size() < b.size()) return b;\n\telse if(a.size() == b.size()) return max(a, b);\n\telse return a;\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(!w && !h) break;\n\t\tc.resize(h);\n\t\tfill(dp[0], dp[100], \"\");\n\t\tfor(int i=0; i<h; i++){\n\t\t\tcin >> c[i];\n\t\t}\n\n\t\tstring ans = \"\";\n\t\tfor(int i=0; i<h; i++){\n\t\t\tfor(int j=0; j<w; j++){\n\t\t\t\tif(isdigit(c[i][j])) dp[i][j] += c[i][j];\n\t\t\t\telse dp[i][j] = \"\";\n\t\t\t\tif(dp[i][j] == \"0\") dp[i][j] = \"\";\n\t\t\t\tans = cmax(ans, dp[i][j]);\n\t\t\t\tdp[i+1][j] = cmax(dp[i+1][j], dp[i][j]);\n\t\t\t\tdp[i][j+1] = cmax(dp[i][j+1], dp[i][j]);\n\t\t\t\t//dp[i+1][j+1] = cmax(dp[i+1][j+1], dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <set>\n#include <map>\n#include <queue>\n#include <deque>\n#include <stack>\n#include <algorithm>\n#include <cstring>\n#include <functional>\n#include <cmath>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<(n);++i)\n#define rep1(i,n) for(int i=1;i<=(n);++i)\n#define all(c) (c).begin(),(c).end()\n#define fs first\n#define sc second\n#define pb push_back\n#define show(x) cout << #x << \" \" << x << endl\nvoid renew(string& x,string y){\n\tif(x.size()<y.size()){\n\t\tx=y;\n\t\treturn;\n\t}else if(x.size()>y.size()){\n\t\treturn;\n\t}else{\n\t\tif(x<y) x=y;\n\t}\n}\nint main(){\n\twhile(true){\n\t\tint W,H;\n\t\tcin>>W>>H;\n\t\tif(H==0) break;\n\t\tstring s[70];\n\t\trep(i,H) cin>>s[i];\n\t\tstring dp[70][70];\n\t\trep(i,H) rep(j,W){\n\t\t\tif(!isdigit(s[i][j])) continue;\n\t\t\tstring val;\n\t\t\tif(s[i][j]!='0') val=string(1,s[i][j]);\n\t\t\tif(i!=0&&dp[i-1][j].size()>0) renew(val,dp[i-1][j]+s[i][j]);\n\t\t\tif(j!=0&&dp[i][j-1].size()>0) renew(val,dp[i][j-1]+s[i][j]);\n\t\t\tdp[i][j]=val;\n\t\t}\n\t\tstring ans;\n\t\trep(i,H) rep(j,W) renew(ans,dp[i][j]);\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <map>\n\nusing namespace std;\n\nint W,H;\nstring res,comp;\n\nvoid dfs(string sn, vector< pair<int,int> > ps, map< pair<int,int>,string >& memo, vector< vector<string> >& mat) {\n\tpair<int,int> np = ps[ps.size()-1];\n\tif (np.first+1 < H) {\n\t\tstring ns = mat[np.first+1][np.second];\n\t\tif (ns != \" \") {\n\t\t\tvector< pair<int,int> > temp = ps;\n\t\t\ttemp.push_back({np.first+1,np.second});\n\t\t\tdfs(sn+ns,temp,memo,mat);\n\t\t}\n\t}\n\tif (np.second+1 < W) {\n\t\tstring ns = mat[np.first][np.second+1];\n\t\tif (ns != \" \") {\n\t\t\tvector< pair<int,int> > temp = ps;\n\t\t\ttemp.push_back({np.first,np.second+1});\n\t\t\tdfs(sn+ns,temp,memo,mat);\n\t\t}\n\t}\n\n\tfor (int i = 0; i < ps.size(); ++i) {\n\t\tif (sn > memo[ps[i]]) {\n\t\t\tmemo[ps[i]] = sn;\n\t\t}\n\t}\n\tif (sn.length() >= res.length()) {\n\t\tif (sn.length() == res.length()) {\n\t\t\tif (sn > res) {\n\t\t\t\tres = sn;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tres = sn;\n\t\t}\n\t}\n\treturn;\n}\n\nint main(void) {\n\twhile (cin >> W >> H, W) {\n\t\tres = \"0\";\n\t\tvector< vector<string> > mat(H,vector<string>(W));\n\t\tvector< pair<int,int> > start;\n\t\tfor (int i = 0; i < H; ++i) {\n\t\t\tfor (int j = 0; j < W; ++j) {\n\t\t\t\tstring temp = \"\";\n\t\t\t\tchar c;\n\t\t\t\tcin >> c;\n\t\t\t\tif (c >= '0' && c <= '9') {\n\t\t\t\t\tstart.push_back({i,j});\n\t\t\t\t\ttemp += c;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttemp = \" \";\n\t\t\t\t}\n\t\t\t\tmat[i][j] = temp;\n\t\t\t}\n\t\t}\n\t\tmap< pair<int,int>,string > memo;\n\t\tfor (int i = 0; i < start.size(); ++i) {\n\t\t\tif (memo[start[i]] == \"\" && mat[start[i].first][start[i].second] != \"0\") {\n\t\t\t\tcomp = \"\";\n\t\t\t\tvector< pair<int,int> > temp;\n\t\t\t\ttemp.push_back(start[i]);\n\t\t\t\tdfs(mat[start[i].first][start[i].second],temp,memo,mat);\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n\nusing namespace std;\n\nclass Node{\nprivate:\n  vector<int> *master_num;\n  int value;\n  int rank;\n  int x;\n  int y;\n  Node *child[2];\npublic:\n  Node();\n  void add_value(int v,int _x,int _y);\n  void add_child(int v,int _x,int _y);\n  void add_rank(int r);\n  void set_master(vector<int> *m);\n\n  void show_value();\n  void show_chain();\n  void show_rank();\n  void show_master();\n  int show_master_val();\n  int show_master_val_keta(int keta);\n\n  void search(int H,int W);\n};\n\nchar C[70][70]; // [H][W]\nint C_route[70][70];\n\nNode *compare_node_for_two(Node *n1,Node *n2,int keta);\nvoid compare_node(Node *n,int num,int keta);\n\nint main(void){\n\n  int W,H;\n\n\n  for(cin >> W,cin >> H;W!=0 && H!=0;cin >> W,cin >> H){\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\tcin >> C[i][j];\n\t//cout << C[i][j];\n      }\n      //cout << endl;\n\n    }\n    //cout << \"W,H:\" << W << \",\" << H << endl;\n\n    int route_max=0;\n    \n    for(int i=0;i<W+H-1;i++){\n      int init_x,init_y;\n      //cout << \"i:\" << i << endl;\n\n      if(i<W){\n\tinit_x=W-1-i;\n\tinit_y=H-1;\n      }\n      else{\n\tinit_x=0;\n\tinit_y=H-1-(i-W+1);\n      }\n      \n      int x,y;\n      for(x=init_x,y=init_y; x<=W-1 && y>=0  ;x++,y--){\n\t//cout << \"x,y:\" << x << \",\" << y << endl;\n\t//cout << \"C[y][x]:\"  <<C[y][x] << endl;\n\tif(C[y][x] >= '0' && C[y][x] <= '9'){\n\t  //cout << \"number!\" << endl;\n\t  if(x<W-1 && y<H-1){\n\t    //cout << \"choose max!\" << endl;\n\t    C_route[y][x]=max(C_route[y+1][x],C_route[y][x+1])+1;\n\t    if(route_max < C_route[y][x]){\n\t\troute_max = C_route[y][x];\n\t    }\n\t  }\n\t  else if(x<W-1){\n\t    if(C_route[y][x+1]>0){\n\t      //cout << \"add!\" << endl;\n\t      C_route[y][x]=C_route[y][x+1]+1;\n\t      if(route_max < C_route[y][x]){\n\t\troute_max = C_route[y][x];\n\t      }\n\t    }\n\t    else{\n\t      C_route[y][x]=1;\n\t    }\n\t  }\n\t  else if(y>0){\n\t    if(C_route[y+1][x]>0){\n\t      //cout << \"add!\" << endl;\t      \n\t      C_route[y][x]=C_route[y+1][x]+1;\n\t      if(route_max < C_route[y][x]){\n\t\troute_max = C_route[y][x];\n\t      }\n\t    }\n\t    else{\n\t      C_route[y][x]=1;\n\t    }\n\t  }\n\t  else{\n\t    C_route[y][x]=1;\n\t  }\n\t}\n\telse{\n\t  C_route[y][x]=0;\n\t}\n\t\n      }\n\n    }\n\n    //cout << \"max:\" << route_max << endl;\n\n    int keta=route_max;\n\n\n    vector<vector<int> > candidate;\n    vector<int> tmp(3);\n\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\tif(C_route[i][j] == route_max){\n\t  tmp[0]=C[i][j]-'0';\n\t  tmp[1]=i;\n\t  tmp[2]=j;\n\t  candidate.push_back(tmp);\n\t}\n      }\n    }\n    \n    //cout << \"candidate:\" << candidate.size() << endl;\n\n    vector<int> *candidate_num;\n\n    Node *n;\n    n = new Node[candidate.size()];\n\n    for(int i=0;i<candidate.size();i++){\n      candidate_num = new vector<int>(route_max,0);\n      //cout << \"candidate_num.size():\" << candidate_num->size() << endl;\n      //candidate_num.push_back(i);\n      ////cout << \"digit:\" << candidate[i][0] << endl;\n      ////cout << \"y:\" << candidate[i][1] << endl;\n      ////cout << \"x:\" << candidate[i][2] << endl;\n      n[i].set_master(candidate_num);\n      n[i].add_value(candidate[i][0],candidate[i][2],candidate[i][1]);\n      n[i].show_value();\n      n[i].add_rank(route_max);\n      n[i].show_rank();\n      //cout <<\"search begin\" <<endl;\n      n[i].search(H,W);\n      n[i].show_chain();\n      //n[i].show_master();\n      //cout <<\"~~~~~~~~\" <<endl;\n    }\n\n    //if(candidate.size()==2){\n\n    //compare_node_for_two(&n[0],&n[1],route_max)->show_master_val();\n      \n    //}\n    \n    compare_node(n,candidate.size(),route_max);\n\n\n    \n    //cout << \"show chain !\" << endl;\n    //n[0].show_chain();\n    //cout << endl;\n\n    //n[0].add_child(1,2,3);\n    //n[0].add_child(4,5,6);\n\n    //n[0].show_chain();\n    //cout << endl;    \n\n    vector<int> answer(route_max);\n\n    \n    for(int i=route_max;i>0;i--){\n      int max_digi=-1;\n      for(vector<int> x:candidate){\n\t//cout << \"digit:\" << x[0] << endl;\n\t//cout << \"y:\" << x[1] << endl;\n\t//cout << \"x:\" << x[2] << endl;              \n      }\n    }\n\n    //debug\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\t//cout << C_route[i][j] << \"\\t\";\n      }\n      //cout << endl;\n    }\n    //cout << endl;\n  }\n  return 0;\n}\n\nNode::Node(){\n  child[0]=nullptr;\n  child[1]=nullptr;\n  rank=0;\n}\n\n\nvoid Node::add_value(int v,int _x,int _y){\n\n  value=v;\n  x=_x;\n  y=_y;  \n}\n\nvoid Node::add_rank(int r){\n\n  rank=r;\n}\n\nvoid Node::add_child(int v,int _x,int _y){\n\n  if(child[0] == nullptr){\n    Node *tmp;\n    tmp = new Node;\n    tmp->set_master(master_num);\n    tmp->add_value(v,_x,_y);\n    tmp->add_rank(rank-1);\n    child[0]=tmp;\n  }\n  else if(child[1] == nullptr){\n    Node *tmp;\n    tmp = new Node;\n    tmp->set_master(master_num);    \n    tmp->add_value(v,_x,_y);\n    tmp->add_rank(rank-1);    \n    child[1]=tmp;\n  }\n  else{\n    abort();\n  }\n    \n}\n\nvoid Node::show_value(){\n  //cout << \"value:\" << value << endl;\n  //cout << \"x:\" << x << endl;\n  //cout << \"y:\" << y << endl;    \n}\n\nvoid Node::show_rank(){\n\n  //cout << \"rank:\" << rank << endl;\n\n}\n\nvoid Node::show_chain(){\n\n  for(int i=0;i<rank;i++){\n    //cout << \"-\";\n  }\n  \n  //cout << value << endl;\n  \n  if(child[0] != nullptr){\n\n    child[0]->show_chain();\n  }\n  if(child[1] != nullptr){\n\n    child[1]->show_chain();\n  }\n\n}\n\nvoid Node::search(int H,int W){\n\n  /*\n  for(int i=0;i<70;i++){\n    for(int j=0;j<70;j++){\n      //cout << C_route[i][j];\n    }\n    //cout << endl;\n  }  \n  */\n\n  //cout << \"rank:\" << rank << endl;\n  //cout << \"value:\" << value << endl;\n  //cout << \"master_size:\" << master_num->size() << endl;\n  for(int i=0;i<master_num->size();i++){\n    //cout << (*master_num)[(master_num->size())-i-1];\n  }\n  //cout << endl;\n  //cout << \"C_route[y][x]:\" << C_route[y][x] << endl;\n  //cout << \"C[y][x]:\" << C[y][x] << endl;    \n\n  if(rank ==1){\n    (*master_num)[rank-1]=value;\n    return;\n  }\n  \n  if( C_route[y+1][x] == rank-1 && C_route[y][x+1] == rank-1  ){\n    if(C[y+1][x] == C[y][x+1]){\n      if((*master_num)[rank-1] < value){\n\t(*master_num)[rank-1]=value;\n\tfor(int i=0;i<rank-1-1;i++){\n\t  (*master_num)[i]=0;\n\t}\n      }\n      \n      this->add_child(C[y+1][x]-'0',x,y+1);\n      this->add_child(C[y][x+1]-'0',x+1,y);      \n      /*\n      Node *tmp;\n      tmp = new Node;\n      tmp->set_master(master);      \n      tmp->add_value(C[y+1][x]-'0',x,y+1);\n      tmp->add_rank(rank-1);\n      child[0]=tmp;\n\n      Node *tmp2;\n      tmp2 = new Node;\n      tmp2->set_master(master);      \n      tmp2->add_value(C[y][x+1]-'0',x+1,y);\n      tmp2->add_rank(rank-1);\n      child[1]=tmp2;      \n      */\n    }\n    else if(C[y+1][x] > C[y][x+1]){\n      if((*master_num)[rank-1] < value){\n\t(*master_num)[rank-1]=value;\n\tfor(int i=0;i<rank-1-1;i++){\n\t  (*master_num)[i]=0;\n\t}\n      }\n\n      this->add_child(C[y+1][x]-'0',x,y+1);      \n      /*\n      Node *tmp;\n      tmp = new Node;\n      tmp->set_master(master);      \n      tmp->add_value(C[y+1][x]-'0',x,y+1);\n      tmp->add_rank(rank-1);\n      child[0]=tmp;\n      */\n    }\n    else{\n      if((*master_num)[rank-1] < value){\n\t(*master_num)[rank-1]=value;\n\tfor(int i=0;i<rank-1-1;i++){\n\t  (*master_num)[i]=0;\n\t}\n      }\n      this->add_child(C[y][x+1]-'0',x+1,y);\n      /*\n      Node *tmp2;\n      tmp2 = new Node;\n      tmp2->set_master(master);      \n      tmp2->add_value(C[y][x+1]-'0',x+1,y);\n      tmp2->add_rank(rank-1);\n      child[0]=tmp2;\n      */\n    }\n  }\n  else if(C_route[y+1][x] == rank-1){\n    if((*master_num)[rank-1] < value){\n      (*master_num)[rank-1]=value;\n      for(int i=0;i<rank-1-1;i++){\n\t(*master_num)[i]=0;\n      }\n    }\n\n    this->add_child(C[y+1][x]-'0',x,y+1);      \n    /*\n    Node *tmp;\n    tmp = new Node;\n    tmp2->set_master(master);    \n    tmp->add_value(C[y+1][x]-'0',x,y+1);\n    tmp->add_rank(rank-1);\n    child[0]=tmp;\n    */\n  }\n  else if(C_route[y][x+1] == rank-1){\n    if((*master_num)[rank-1] < value){\n      (*master_num)[rank-1]=value;\n      for(int i=0;i<rank-1-1;i++){\n\t(*master_num)[i]=0;\n      }\n    }    \n      this->add_child(C[y][x+1]-'0',x+1,y);    \n    /*\n    Node *tmp2;\n    tmp2 = new Node;\n    tmp2->set_master(master);    \n    tmp2->add_value(C[y][x+1]-'0',x+1,y);\n    tmp2->add_rank(rank-1);\n    child[0]=tmp2;\n    */\n  }\n  else{\n    \n  }\n\n  if(child[0] != nullptr){\n    child[0]->search(H,W);\n  }\n  if(child[1] != nullptr){\n    child[1]->search(H,W);\n  }  \n  \n}\n\nvoid Node::set_master(vector<int> *m){\n\n  master_num = m;\n\n}\n\nvoid Node::show_master(){\n  cout << \"show master:\";\n  for(int i=0;i<master_num->size();i++){\n    cout << (*master_num)[(master_num->size())-i-1];\n  }\n  cout << endl;\n}\n\nint Node::show_master_val(){\n  \n  for(int i=0;i<master_num->size();i++){\n    if(i==0 && (*master_num)[(master_num->size())-i-1]==0) continue;\n    else cout << (*master_num)[(master_num->size())-i-1];\n  }\n  cout << endl;\n  return 0;\n}\n\nint Node::show_master_val_keta(int keta){\n\n  return (*master_num)[master_num->size()-keta-1];\n\n}\n\nNode *compare_node_for_two(Node *n1,Node *n2,int keta){\n\n  int x,y;\n\n  if(n1==nullptr && n2==nullptr) abort();\n\n  if(n1==nullptr) return n2;\n  if(n2==nullptr) return n1;  \n  \n  for(int i=0;i<keta;i++){\n\n    x=n1->show_master_val_keta(i);\n    y=n2->show_master_val_keta(i);\n\n    if(x > y){\n      return n1;\n    }\n    else if(x < y){\n      return n2;\n    }\n    else{\n      continue;\n    }\n    \n  }\n  \n}\n\nvoid compare_node(Node *n,int num,int keta){\n\n  Node *max_n=nullptr;\n  Node *tmp_n=nullptr;  \n  \n  for(int i=0;i<num;i++){\n    //n[i].show_master_val();\n    for(int j=0;j<keta;j++){\n      //cout << n[i].show_master_val_keta(j);\n    }\n    //cout << endl;\n    tmp_n=max_n;\n    max_n=compare_node_for_two(max_n,&(n[i]),keta);\n  }\n\n  max_n->show_master_val();\n  \n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <cstring>\n#include <climits>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <stack>\n#include <vector>\n#include <queue>\n#include <bitset>\n#include <string>\nusing namespace std;\n\n#define REP(i,n) for(int i=0; i<n; i++)\n#define RPA(i,s,e) for(int i=s; i<=e; i++)\n#define RPD(i,s,e) for(int i=s; i>=e; i--)\n#define PB(a) push_back(a)\n#define MP(i,s) make_pair(i,s)\n#define SZ(a) (int)(a).size()\n#define ALL(a) (a).begin(), (a).end()\n#define PRT(a) cerr << #a << \" = \" << (a) << endl\n#define PRT2(a,b) cerr << #a << \" = \" << (a) << \", \" << #b << \" = \" << (b) << endl\n#define PRT3(a,b,c) cerr << (a) << \", \" << (b) << \", \" << (c) << endl\n\ntypedef long long lint;\ntypedef vector<lint> vl;\ntypedef pair<lint,lint> pll;\n\nlint w, h;\nvector<string> mat;\n\nstring dp[80][80];\n\nbool digit(char c) {\n\treturn (c >= '0' && c <= '9');\n}\n\nstring larger(string& s1, string& s2) {\n\tif(s1.size() != s2.size()) {\n\t\treturn s1.size() > s2.size() ? s1 : s2;\n\t}\n\treturn s1 > s2 ? s1 : s2;\n}\n\nvoid solve() {\n\tREP(y,h) REP(x,w) dp[y][x] = \"\";\n\tREP(x,w) {\n\t\tif(digit(mat[0][x])) {\n\t\t\tif(x == 0) dp[0][x] = mat[0][x];\n\t\t\telse dp[0][x] = dp[0][x-1] + mat[0][x];\n\t\t}\n\t}\n\n\tRPA(y,1,h-1) {\n\t\tREP(x,w) {\n\t\t\tif(!digit(mat[y][x])) continue;\n\n\t\t\tif(x == 0) {\n\t\t\t\tdp[y][x] = dp[y-1][x] + mat[y][x];\n\t\t\t} else {\n\t\t\t\tstring s1 = dp[y-1][x] + mat[y][x];\n\t\t\t\tstring s2 = dp[y][x-1] + mat[y][x];\n\t\t\t\tdp[y][x] = larger(s1, s2);\n\t\t\t}\n\t\t}\n\t}\n\n\tstring ans = \"\";\n\tREP(y,h) REP(x,w) ans = larger(ans, dp[y][x]);\n\twhile(ans[0] == '0') ans = ans.substr(1);\n\tcout << ans << endl;\n}\n\nvoid coding() {\n\twhile(cin>>w>>h, w|h) {\n\t\tmat = vector<string>(h);\n\t\tREP(y,h) cin >> mat[y];\n\t\tsolve();\n\t}\n}\n\n// #define _LOCAL_TEST\n\nint main() {\n#ifdef _LOCAL_TEST\n\tclock_t startTime = clock();\n\tfreopen(\"test.dat\", \"r\", stdin);\n#endif\n\n\tcoding();\n\n#ifdef _LOCAL_TEST\n\tclock_t elapsedTime = clock() - startTime;\n\tcout << endl;\n\tcout << (elapsedTime / 1000.0) << \" sec elapsed.\" << endl;\n\tcout << \"This is local test\" << endl;\n\tcout << \"Do not forget to comment out _LOCAL_TEST\" << endl << endl;\n#endif\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<string>\nusing namespace std;\n\nchar map[80][80];\nint w,h;\nstring memo[80][80];\n\nstring MAX;\nvoid\nsearch(int y,int x,string str){\n//\tcout<<\"(\"<<x<<\",\"<<y<<\")\"<<map[y][x]<<endl;\n\tchar *p = map[y];\n\tstring tmp = string((char*)p);\n\tstr+=tmp[x];\n\tif(memo[y][x]!=\"\"&&memo[y][x]>str)return ;\n//\tcout<<str<<endl;\n\tmemo[y][x]=str;\n\tif(MAX.size()<str.size()){\n\t\tMAX=str;\n\t}\n\telse if(MAX.size()==str.size()&&MAX<str){\n\t\tMAX=str;\n\t}\n\n\n\tstring str1=\"\",str2=\"\";\n\tif(map[y+1][x]>='0' && map[y+1][x]<='9')search(y+1,x,str);\n\tif(map[y][x+1]>='0' && map[y][x+1]<='9')search(y,x+1,str);\n\treturn ;\n}\n\nint\nmain(){\n\twhile(true){\n\t\tcin>>w>>h;\n\t\tMAX=\"\";\n\t\tif(w==0&&h==0)return 0;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tcin>>map[i][j];\n\t\t\t\t//cout<<map[i][j];\n\t\t\t}\n//\t\t\tcout<<endl;\n\t\t}\n\t//\tfor(int i=0;i<h;i++)cout<<map[i]<<endl;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++)memo[i][j]=\"\";\n\t\t}\n\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tstring str=\"\";\n\t\t\t\tif(map[i][j]>'0'&&map[i][j]<='9')search(i,j,\"\");\n\t\t\t}\n\t\t}\n\t\tcout<<MAX<<endl;\n\t}\n\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define vi vector<int>\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back\n#define pii pair<int,int>\n#define mp make_pair\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nint w,h;\nvector<string> data;\nint dx[2]={1,0};\nint dy[2]={0,1};\nbool sudeni[100][100];\n\nbool inrange(int x,int y){ \n\tif(x<0||y<0||x>h-1||y>w-1) return false;\n\telse return true;\n}\nstring rmzero(string a){\n\tstring str=\"\";\n\tbool f = false;\n\tREP(i,a.size()){\n\t\tif(!f){\n\t\t\tif(a[i]!='0') {\n\t\t\t\tstr+=a[i];\n\t\t\t\tf = true;\n\t\t\t}\n\t\t}else{\n\t\t\tstr+=a[i];\n\t\t}\n\t}\n\treturn str;\n}\n\nstring getbigger(string a,string b,bool ff){\n\tif(ff) {a = rmzero(a); b = rmzero(b);}\n\tif(a.size()!=b.size()){\n\t\tif(a.size()>b.size()) return a;\n\t\telse return b;\n\t}\n\telse{\n\t\tREP(i,a.size()){\n\t\t\tif(a[i]==b[i]) continue;\n\t\t\tif(a[i]>b[i]) return a;\n\t\t\telse  return b;\n\t\t}\n\t\treturn a;//eq\n\t}\n}\n\nstring solve(int px,int py){\n\tstring rst = \"\";\n\tif(!inrange(px,py)) return \"\";\n\tsudeni[px][py] = true;\n\tif('0'<=data[px][py] && data[px][py]<='9') {\n\t\trst+=data[px][py];\n\t}\n\tvector<string> tmp;\n\tREP(i,2){\n\t\ttmp.pb(\"\");\n\t\tint nx = px + dx[i];\n\t\tint ny = py + dy[i];\n\t\tif(inrange(nx,ny) &&'0'<=data[nx][ny] && data[nx][ny]<='9') {\n\t\t\ttmp[i]=solve(nx,ny);\n\t\t}\n\t}\n\trst = getbigger(rst+tmp[0],rst+tmp[1],false);\n\treturn  rst;\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(w==0&&h==0) break;\n\t\tdata.clear();\n\t\tREP(i,h){\n\t\t\tstring tmp;\n\t\t\tcin >> tmp;\n\t\t\tdata.pb(tmp);\n\t\t}\n\t\tstring ans = \"0\";\n\t\tREP(i,100) REP(j,100) sudeni[i][j]=false;\n\t\tREP(i,h){\n\t\t\tREP(j,w){\n\t\t\t\tif(sudeni[i][j]==false&&data[i][j]>='1'&&data[i][j]<='9') {\n\t\t\t\t\tstring rst = solve(i,j);\n\t\t\t\t\t//cout << rst << endl;\n\t\t\t\t\tans = getbigger(rst,ans,true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <iostream>\n#include <map>\n#include <cmath>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <stdlib.h>\n#include <stdio.h>\n#include <bitset>\n#include <cstring>\nusing namespace std;\n#define FOR(I,A,B) for(int I = (A); I < (B); ++I)\n#define CLR(mat) memset(mat, 0, sizeof(mat))\ntypedef long long ll;\nint W, H;\nvector<string> vs(70);\nmap<int, string> MAP;\nbool checked[70][70]; \nstring calc(string a, string b) {\n  if(a.length() > b.length()) return a;\n  if(a.length() < b.length()) return b;\n  else return a > b ? a : b;\n}\nstring dfs(int h, int w) {\n  checked[h][w] = true;\n  if(h < 0 || h >= H || w < 0 || w >= W || !isdigit(vs[h][w])) {\n    return \"\";\n  }\n  if(MAP.count(h*100+w)) return MAP[h*100+w];\n  string a = vs[h][w] + dfs(h+1,w);\n  string b = vs[h][w] + dfs(h,w+1);\n  MAP[100*h+w] = calc(MAP[100*h+w], calc(a, b));\n  return MAP[100*h+w];\n}\nint main()\n{\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  while(cin>>W>>H,W||H) {\n    FOR(i,0,H) cin >> vs[i];\n    string ans = \"\";\n    CLR(checked);\n    MAP.clear();\n    FOR(h,0,H) {\n      FOR(w,0,W) {\n        if(checked[h][w] || vs[h][w] == '0') continue;\n        checked[h][w] = true;\n        ans = calc(ans, dfs(h, w));\n      } \n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<sstream>\nusing namespace std;\nint s2i(string str){\n  istringstream is(str);\n  int n;\n  is >> n;\n  return n;\n}\nlong long s2ll(string str){\n  istringstream is(str);\n  long long  n;\n  is >> n;\n  return n;\n}\nstruct lstr{\n  string str;\n  string out(){\n    string s;\n    int c=0;\n    while(str[c]=='0') c++;\n    for(int i=c;i<str.size();i++) s+=str[i];\n    return s;\n  }\n  bool operator<(const lstr& a )const{\n    return (str.size()==a.str.size()) ? str.compare(a.str)<0 : str.size() < a.str.size();\n  }\n};\nint main(){\n  int i,j,k;\n  int w,h;\n  cin >> w >> h;\n  while(w!=0){\n    char ma[75][75]={{}};\n    for(i=0;i<h;i++){\n      for(j=0;j<w;j++){\n\tcin >> ma[i][j]; \n\tif('9'<ma[i][j]) ma[i][j]=-1;\n      }\n    }\n    lstr val[75][75]={{}};\n    lstr buf;\n    lstr o;\n    o.str=\"0\";\n    for(i=h-1;i>=0;i--){\n      for(j=w-1;j>=0;j--){\n\tif(ma[i][j]!=-1){\n\t  int f=0;\n\t  if(ma[i+1][j]!=-1){\n\t    val[i][j].str=ma[i][j]+val[i+1][j].str;\n\t    f=1;\n\t  }\n\t  if(ma[i][j+1]!=-1){\n\t    if(f==0){\n\t      val[i][j].str=ma[i][j]+val[i][j+1].str;\n\t      f=1;\n\t    }else{\n\t      buf.str=ma[i][j]+val[i][j+1].str;\n\t      if(val[i][j]<buf) val[i][j].str=buf.str;\n\t    }\t  \n\t  }\n\t  if(f==0) val[i][j].str=ma[i][j];\n\t  //cout << val[i][j] << endl;\n\t  if(o<val[i][j]) o.str=val[i][j].str;\n\t}\n      }\n      \n    }\n    cout << o.out() << endl;\n\n    cin >> w >> h;\n  }  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n#define mod 1000000007\n#define all(c) begin(c),end(c)\ntemplate <typename T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate <typename T> T &chmax(T &a, const T &b) { return a = max(a, b); }\nusing ll = long long;\nusing vi = vector<int>; using vs = vector<string>;\nint dd[] = { 0, 1, 0, -1, 0 }; //→↓←↑\n\nint W, H;\nstring ans;\nint m;\nvector<string> C;\nvector<vector<bool>> B;\nvector<vs> dp;\n\n//void dfs(int y, int x, int depth, string s)\n//{\n//\tif (('A' <= C[y][x] && C[y][x] <= 'Z'))\n//\t{\n//\t\tif (m < depth)\n//\t\t{\n//\t\t\tm = depth;\n//\t\t\tans = s;\n//\t\t}\n//\t\telse if (m == depth)\n//\t\t{\n//\t\t\tchmax(ans, s);\n//\t\t}\n//\t\treturn;\n//\t}\n//\tB[y][x] = true;\n//\tif(y < H - 1)dfs(y + 1, x, depth + 1, s + C[y][x]);\n//\tif(x < W - 1)dfs(y, x + 1, depth + 1, s + C[y][x]);\n//}\nvoid solve()\n{\n\twhile (true)\n\t{\n\t\tcin >> W >> H;\n\t\tif (W == 0 && H == 0)break;\n\t\tans = \"\";\n\t\tm = 0;\n\t\tC = vs(H);\n\t\tdp = vector<vs>(H, vs(W, \"\"));\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tcin >> C[i];\n\t\t}\n\t\tstring ans = \"\";\n\t\tfor (int y = 0; y < H; y++)\n\t\t{\n\t\t\tfor (int x = 0; x < W; x++)\n\t\t\t{\n\t\t\t\tif ('A' <= C[y][x] && C[y][x] <= 'Z')continue;\n\n\t\t\t\tdp[y][x] = C[y][x];\n\t\t\t\tif (0 <= y - 1 && dp[y - 1][x] != \"0\")\n\t\t\t\t{\n\t\t\t\t\tdp[y][x] = dp[y - 1][x] + C[y][x];\n\t\t\t\t}\n\t\t\t\tif (0 <= x - 1 && dp[y][x - 1] != \"0\")\n\t\t\t\t{\n\t\t\t\t\tif (dp[y][x].size() < dp[y][x - 1].size() + 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[y][x] = dp[y][x - 1] + C[y][x];\n\t\t\t\t\t}\n\t\t\t\t\telse if (dp[y][x].size() == dp[y][x - 1].size() + 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tchmax(dp[y][x], dp[y][x - 1] + C[y][x]);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (ans.size() < dp[y][x].size())\n\t\t\t\t{\n\t\t\t\t\tans = dp[y][x];\n\t\t\t\t}\n\t\t\t\telse if (ans.size() == dp[y][x].size())\n\t\t\t\t{\n\t\t\t\t\tchmax(ans, dp[y][x]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\n\n\t}\n}\n\nint main()\n{\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tsolve();\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint W,H;\n\nbool flag[70][70][70];\nstring dp[70][70][70];\nstring mat[70];\n\nstring max_str(const string& s1, const string& s2) {\n    string s11(s1);\n    string s22(s2);\n    reverse(all(s11));\n    reverse(all(s22));\n    if(s11.size() == s22.size()) {\n        return s11 > s22?s1:s2;\n    }\n    else return s11.size() > s22.size() ? s1 : s2;\n}\nstring dfs(int y, int x,int c) {\n    if(flag[y][x][c]) return dp[y][x][c];\n    string res=\"\";\n\n    rep(i,2) {\n        int ny=y+dy[i];\n        int nx=x+dx[i];\n        if(!(0<=ny&&ny<H)) continue;\n        if(!(0<=nx&&nx<W)) continue;\n        if(!('0'<=mat[ny][nx]&&mat[ny][nx]<='9')) continue;\n        res=max_str(res,dfs(ny,nx,c+1)+mat[ny][nx]);\n\n    }\n\n    flag[y][x][c]=true;\n    return dp[y][x][c]=res;\n}\n\nvoid solve() {\n    rep(i,70) rep(j,70) rep(a,70) flag[i][j][a]=false;\n    rep(i,70) rep(j,70) rep(a,70) dp[i][j][a]=\"\";\n    rep(i,70) mat[i]=\"\";\n    rep(i,H) cin>>mat[i];\n    string ans=\"\";\n    rep(i,H) rep(j,W) if('1'<=mat[i][j]&&mat[i][j]<='9') {\n        string s=\"a\";\n        s[0]=mat[i][j];\n        ans=max_str(ans,dfs(i,j,0)+s);\n    }\n\n    reverse(all(ans));\n    cout<<ans<<endl;\n}\n\nint main() {\n    while(cin>>W>>H) {\n        if(W+H==0) break;\n        solve();\n\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n#define mod 1000000007\n#define all(c) begin(c),end(c)\ntemplate <typename T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate <typename T> T &chmax(T &a, const T &b) { return a = max(a, b); }\nusing ll = long long;\nusing vi = vector<int>;\nint dd[] = { 0, 1, 0, -1, 0 }; //→↓←↑\n\nint W, H;\nstring ans;\nint m;\nvector<string> C;\nvoid dfs(int y, int x, int depth, string s)\n{\n\tif (y >= H || x >= W || ('A' <= C[y][x] && C[y][x] <= 'Z') || (C[y][x] == '0' && depth == 0))\n\t{\n\t\tif (m < depth)\n\t\t{\n\t\t\tm = depth;\n\t\t\tans = s;\n\t\t}\n\t\telse if (m == depth)\n\t\t{\n\t\t\tchmax(ans, s);\n\t\t}\n\t\treturn;\n\t}\n\t\n\tdfs(y + 1, x, depth + 1, s + C[y][x]);\n\tdfs(y, x + 1, depth + 1, s + C[y][x]);\n}\nvoid solve()\n{\n\twhile (true)\n\t{\n\t\tcin >> W >> H;\n\t\tif (W == 0 && H == 0)break;\n\t\tans = \"\";\n\t\tm = 0;\n\t\tC = vector<string>(H);\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tcin >> C[i];\n\t\t}\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tdfs(i, j, 0, \"\");\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n\nint main()\n{\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tsolve();\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#define rep(i, n) for(i = 0; i < n; i++)\nusing namespace std;\n\nint w, h;\nstring s[70];\nstring dp[70][70];\n\nbool check(int i, int j, string &prev) {\n\tif (i >= h || j >= w) return false;\n\tif (prev.length() > 0) {\n\t\treturn '0' <= s[i][j] && s[i][j] <= '9';\n\t}\n\treturn '1' <= s[i][j] && s[i][j] <= '9';\n}\n\nstring Max(string a, string b) {\n\tif (a.length() > b.length()) return a;\n\tif (b.length() > a.length()) return b;\n\treturn max(a, b);\n}\n\nint main() {\n\tint i, j;\n\t\n\twhile (cin >> w >> h) {\n\t\tif (!w) break;\n\t\trep(i, h) cin >> s[i];\n\t\trep(i, h) {\n\t\t\trep(j, w) {\n\t\t\t\tif ('1' <= s[i][j] && s[i][j] <= '9') dp[i][j] = s[i][j];\n\t\t\t\telse dp[i][j] = \"\";\n\t\t\t}\n\t\t}\n\t\t\n\t\trep(i, h) {\n\t\t\trep(j, w) {\n\t\t\t\tif (check(i + 1, j, dp[i][j])) dp[i + 1][j] = Max(dp[i + 1][j], dp[i][j] + s[i + 1][j]);\n\t\t\t\tif (check(i, j + 1, dp[i][j])) dp[i][j + 1] = Max(dp[i][j + 1], dp[i][j] + s[i][j + 1]);\n\t\t\t}\n\t\t}\n\t\t\n\t\tstring ans = \"\";\n\t\trep(i, h) {\n\t\t\trep(j, w) {\n\t\t\t\tans = Max(ans, dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#include <algorithm>\n#include <cstdio>\n#include <functional>\n#include <iostream>\n#include <cfloat>\n#include <climits>\n#include <cstring>\n#include <cmath>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <time.h>\n#include <vector>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> i_i;\ntypedef pair<ll, int> ll_i;\ntypedef pair<double, int> d_i;\ntypedef pair<ll, ll> ll_ll;\ntypedef pair<double, double> d_d;\nstruct edge { int u, v; ll w; };\n\nll MOD = 1000000007;\nll _MOD = 1000000009;\ndouble EPS = 1e-10;\n\nstring hoge(string& s, string& t) {\n\tif (s.length() > t.length()) return s;\n\telse if (s.length() < t.length()) return t;\n\telse if (s > t) return s;\n\telse return t;\n}\n\nint main() {\n\tfor (;;) {\n\t\tint W, H; cin >> W >> H;\n\t\tif (W == 0) break;\n\t\tvector<string> C(H);\n\t\tfor (int i = 0; i < H; i++) cin >> C[i];\n\t\tvector< vector<string> > dp(H, vector<string>(W));\n\t\tfor (int i = H - 1; i >= 0; i--)\n\t\t\tfor (int j = W - 1; j >= 0; j--) {\n\t\t\t\tif (C[i][j] >= 'A' && C[i][j] <= 'Z') continue;\n\t\t\t\tstring s;\n\t\t\t\tif (i + 1 < H) s = hoge(s, dp[i + 1][j]);\n\t\t\t\tif (j + 1 < W) s = hoge(s, dp[i][j + 1]);\n\t\t\t\tdp[i][j] = C[i][j] + s;\n\t\t\t}\n\t\tstring s;\n\t\tfor (int i = 0; i < H; i++)\n\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\twhile (dp[i][j].length() > 0 && dp[i][j][0] == '0')\n\t\t\t\t\tdp[i][j].erase(dp[i][j].begin());\n\t\t\t\ts = hoge(s, dp[i][j]);\n\t\t\t}\n\t\tcout << s << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n#define ll long long\n#define INF (1<<30)\n#define LINF (1LL<<60)\n\n//http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#define MAXH 75\n#define MAXW 75\nvector<vector<string>> dp(MAXH, vector<string>(MAXW));\nvector<vector<int>> f(MAXH, vector<int>(MAXW));\nstring ans;\nint W, H;\n\ninline bool str_check(string a,string b) {\n\tfor (int i = 0; i < a.length();i++) {\n\t\tif (a[i] == '0') {\n\t\t\tif (i == a.length() - 1) a = \"0\";\n\t\t\tcontinue;\n\t\t}\n\t\tif (a[i] != '0') {\n\t\t\ta = a.substr(i); break;\n\t\t}\n\t}\n\n\tfor (int i = 0; i < b.length();i++) {\n\t\tif (b[i] == '0') {\n\t\t\tif (i == b.length() - 1) b = \"0\";\n\t\t\tcontinue;\n\t\t}\n\t\tif (b[i] != '0') {\n\t\t\tb = b.substr(i); break;\n\t\t}\n\t\tif (i == b.length() - 1) b = \"0\";\n\t}\n\n\tif (a.size() > b.size()) return true;\n\telse if (a.size() < b.size()) return false;\n\telse {\n\t\tint Size = a.size();\n\t\tfor (int i = 0; i < Size;i++) {\n\t\t\tif (a[i] != b[i]) return a[i] > b[i] ? true : false;\n\t\t}\n\t}\n\treturn false;\n}\n\nvoid dfs(int h, int w, vector<vector<char>>& C) {\n\tf[h][w] = 1;\n\n\tbool dfs_f = false;\n\tif (C[h][w - 1] < 'A') {\n\t\tif (dp[h][w - 1] == \"-\") {\n\t\t\tdp[h][w - 1] = C[h][w - 1] + dp[h][w];\n\t\t\tdfs(h, w - 1, C);\n\t\t\tdfs_f = true;\n\t\t}\n\t\telse {\n\t\t\tif (str_check(C[h][w - 1] + dp[h][w], dp[h][w - 1])) {\n\t\t\t\tdp[h][w - 1] = C[h][w - 1] + dp[h][w];\n\t\t\t\tdfs(h, w - 1, C);\n\t\t\t\tdfs_f = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (C[h - 1][w] < 'A') {\n\t\tif (dp[h - 1][w] == \"-\") {\n\t\t\tdp[h - 1][w] = C[h - 1][w] + dp[h][w];\n\t\t\tdfs(h - 1, w, C);\n\t\t\tdfs_f = true;\n\t\t}\n\t\telse {\n\t\t\tif (str_check(C[h - 1][w] + dp[h][w], dp[h - 1][w])) {\n\t\t\t\tdp[h - 1][w] = C[h - 1][w] + dp[h][w];\n\t\t\t\tdfs(h - 1, w, C);\n\t\t\t\tdfs_f = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (!dfs_f) {\n\t\tif (str_check(dp[h][w], ans)) {\n\t\t\tans = dp[h][w];\n\t\t}\n\t}\n}\n\nint main() {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\twhile (cin >> W >> H) {\n\t\tif (W == 0 && H == 0) break;\n\t\tans = \"0\";\n\t\tfor (int i = 0; i < MAXH; i++) for (int j = 0; j < MAXW;j++) {\n\t\t\tdp[i][j] = \"-\";\n\t\t\tf[i][j] = 0;\n\t\t}\n\t\tvector<vector<char>> C(H + 2, vector<char>(W + 2, 'A'));\n\n\t\tfor (int i = 1; i <= H;i++) for (int j = 1; j <= W;j++) cin >> C[i][j];\n\n\t\tfor (int i = H; i > 0; i--) {\n\t\t\tfor (int j = W; j > 0;j--) {\n\t\t\t\tif (f[i][j] == 0 && C[i][j] < 'A') {\n\t\t\t\t\tdp[i][j] = C[i][j];\n\t\t\t\t\tdfs(i, j, C);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (int i = 0; i < ans.length();i++) {\n\t\t\tif (ans[i] == '0') continue;\n\t\t\tif (ans[i] != '0') {\n\t\t\t\tcout << ans.substr(i); break;\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cctype>\n#include <climits>\n#include <cmath>\n#include <complex>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iostream>\n#include <list>\n#include <map>\n#include <memory>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\nusing namespace std;\n\n#define EPS 1e-10\n#define INF 1000000000\n#define mp make_pair\n#define pb push_back\n\ntypedef vector<char> vc;\ntypedef vector<vc> vcc;\ntypedef pair<int,int> pii;\ntypedef long long ll;\n\nconst int dx[] = {1, 0},\n          dy[] = {0, 1};\n\nstring suppressZeros(string s) {\n\twhile (s[0]) {\n\t\tif (s[0] != '0') {\n\t\t\tbreak;\n\t\t}\n\t\ts = s.substr(1);\n\t}\n\treturn s;\n}\n\nstring compareNumeric(string s1, string s2) {\n\ts1 = suppressZeros(s1);\n\ts2 = suppressZeros(s2);\n\n\tif (s1.size() > s2.size()) {\n\t\treturn s1;\n\t} else if (s1.size() < s2.size()) {\n\t\treturn s2;\n\t}\n\tfor (int i = 0; i < s1.size(); i++) {\n\t\tint n1 = s1[i] - '0',\n\t\t    n2 = s2[i] - '0';\n\t\tif (n1 > n2) {\n\t\t\treturn s1;\n\t\t} else if (n1 < n2) {\n\t\t\treturn s2;\n\t\t}\n\t}\n\treturn s1;\n}\n\nbool isNum(char c) {\n\tif (c < '0' || '9' < c) {\n\t\treturn false;\n\t}\n\treturn true;\n}\n\nint main() {\n\tint W, H;\n\twhile (1) {\n\t\t// input\n\t\tcin >> W >> H;\n\t\tif (!W && !H) {\n\t\t\treturn 0;\n\t\t}\n\t\tvcc matrix(H, vc(W));\n\t\tfor (int y = 0; y < H; y++) {\n\t\t\tfor (int x = 0; x < W; x++) {\n\t\t\t\tcin >> matrix[y][x];\n\t\t\t}\n\t\t}\n\n\t\t// solve\n\t\tstring ans = \"\";\n\t\tfor (int y = 0; y < H; y++) {\n\t\t\tfor (int x = 0; x < W; x++) {\n\t\t\t\tif (!isNum(matrix[y][x])) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif ((y > 0 && isNum(matrix[y-1][x])) || (x > 0 && isNum(matrix[y][x-1]))) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// search\n\t\t\t\tstack<pii> st;\n\t\t\t\tst.push(mp(x,y));\n\t\t\t\tstack<string> st_s;\n\t\t\t\tstring tmps = \"\";\n\t\t\t\ttmps += matrix[y][x];\n\t\t\t\tst_s.push(tmps);\n\t\t\t\twhile (!st.empty()) {\n\t\t\t\t\tint nx = st.top().first,\n\t\t\t\t\t    ny = st.top().second;\n\t\t\t\t\tst.pop();\n\t\t\t\t\tstring tmp = st_s.top();\n\t\t\t\t\tst_s.pop();\n\t\t\t\t\tbool isLast = true;\n\t\t\t\t\tfor (int d = 0; d < 2; d++) {\n\t\t\t\t\t\tint nx2 = nx + dx[d],\n\t\t\t\t\t\t    ny2 = ny + dy[d];\n\t\t\t\t\t\tif (nx2 >= W || ny2 >= H || !isNum(matrix[ny2][nx2])) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tst.push(mp(nx2, ny2));\n\t\t\t\t\t\tst_s.push(tmp + matrix[ny2][nx2]);\n\t\t\t\t\t\tisLast = false;\n\t\t\t\t\t}\n\t\t\t\t\tif (isLast) {\n\t\t\t\t\t\tans = compareNumeric(ans, tmp);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<sstream>\nusing namespace std;\nint s2i(string str){\n  istringstream is(str);\n  int n;\n  is >> n;\n  return n;\n}\nlong long s2ll(string str){\n  istringstream is(str);\n  long long  n;\n  is >> n;\n  return n;\n}\nstruct lstr{\n  string str;\n  string out(){\n    string s;\n    int c=0;\n    while(str[c]=='0') c++;\n    for(int i=c;i<str.size();i++) s+=str[i];\n    return s;\n  }\n  bool operator<(const lstr& a )const{\n    return (str.size()==a.str.size()) ? str.compare(a.str)<0 : str.size() < a.str.size();\n  }\n};\nint main(){\n  int i,j,k;\n  int w,h;\n  cin >> w >> h;\n  while(w!=0){\n    char ma[75][75]={{}};\n    for(i=0;i<h;i++){\n      for(j=0;j<w;j++){\n\tcin >> ma[i][j]; \n\tif('9'<ma[i][j]) ma[i][j]=-1;\n      }\n    }\n    lstr val[75][75]={{}};\n    lstr buf;\n    lstr o;\n    o.str=\"0\";\n    for(i=h-1;i>=0;i--){\n      for(j=w-1;j>=0;j--){\n\tif(ma[i][j]!=-1){\n\t  int f=0;\n\t  if(ma[i+1][j]!=-1){\n\t    val[i][j].str=ma[i][j]+val[i+1][j].str;\n\t    f=1;\n\t  }\n\t  if(ma[i][j+1]!=-1){\n\t    if(f==0){\n\t      val[i][j].str=ma[i][j]+val[i][j+1].str;\n\t      f=1;\n\t    }else{\n\t      buf.str=ma[i][j]+val[i][j+1].str;\n\t      if(val[i][j]<buf) val[i][j].str=buf.str;\n\t    }\t  \n\t  }\n\t  if(f==0) val[i][j].str=ma[i][j];\n\t  //cout << val[i][j] << endl;\n\t}\n      }\n      \n    }\n    \n    lstr lb;\n    for(i=0;i<h;i++){\n      for(j=0;j<w;j++){\n\tlb.str=val[i][j].out();\n\tif(o<lb) o.str=lb.str;\n      }\n    }\n    cout << o.str << endl;\n\n    cin >> w >> h;\n  }  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n//http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#include<iostream>\n#include<map>\n#include<vector>\n#include<algorithm>\n#include<cmath>\n#include<climits>\n#include<ctime>\n#include<cstring>\n#include<numeric>\n\n#define ALL(v) (v).begin(),(v).end()\n#define REP(i,p,n) for(int i=p;i<(int)(n);++i)\n#define rep(i,n) REP(i,0,n)\n#define dump(a) (cerr << #a << \"=\" << (a) << endl)\n#define DUMP(list) cout << \"{ \"; for(auto nth : list){ cout << nth << \" \"; } cout << \"}\" << endl;\n\nusing namespace std;\n\nint W,H;\nchar matrix[70][70];\nint dw[2] = {0, 1};\nint dh[2] = {1, 0};\nstring ans;\n\nbool cmp(string str1, string str2)\n{\t\n\tif(str1.length() == str2.length()){\n\t\tif(str1 < str2){ return true; }\n\t}\n\telse if(str1.length() < str2.length()){\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nvector<char> adjust(vector<char> list)\n{\n\tvector<char> res;\n\tbool flag=false;\n\trep(i,list.size()){\n\t\tif(list[i] != '0' || flag){ res.push_back(list[i]); flag=true; }\n\t}\n\n\treturn res;\n}\n\nvoid dfs(int w, int h, vector<char> list)\n{\n\tif(w < 0 || w >= W || h < 0 || h >= H){ return; }\n\tif(!isdigit(matrix[h][w])){ return; }\n\n\tlist.push_back(matrix[h][w]);\n\tmatrix[h][w] = '#';\n\n\trep(i,2){\n\t\tdfs(w+dw[i], h+dh[i], list);\n\t}\n\n\tif(list.size() == 0){ return; }\n\tlist = adjust(list);\n\tstring num(ALL(list));\n\n\tif(cmp(ans,num)){ ans = num; }\n\treturn;\n}\n\nint main()\n{\n\twhile(cin >> W >> H && W)\n\t{\n\n\t\trep(h,H){\n\t\t\trep(w,W){\n\t\t\t\tcin >> matrix[h][w];\n\t\t\t}\n\t\t}\n\n\t\tans=\"\";\n\t\tvector<char> list;\n\t\trep(h,H){\n\t\t\trep(w,W){\n\t\t\t\tdfs(w,h,list);\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\nint w, h;\nint gc;\nstring s[51], dp[51][51];\nbool is_num(char c){return '0'<=c && c<= '9';}\n\nstring str_max(const string& s1, const string& s2) {\n  if (s1.size() == s2.size()) {\n    return (s1 > s2) ? s1 : s2 ;\n  }\n  return (s1.size() > s2.size())? s1 : s2 ;\n}\n\nstring dfs(int i, int j) {\n  string res = \"\";\n  \n  if (!is_num(s[i][j])) return res;\n  if (i >= h || j >= w) return res;\n  // DP\n  if (dp[i][j] != \"\") return dp[i][j];\n  \n  //gc++;\n\n  res = s[i][j] + str_max(dfs(i, j+1), dfs(i+1, j));\n  \n  // ªÉ0ªÂ¢Ä¢éêÍæé\n  if (i == 0 && j == 0) {\n    if (res[0] == '0') res.erase(0, 1);\n  } else if (i == 0) {\n    if (!is_num(s[i][j-1]) && res[0] == '0') res.erase(0, 1);\n  } else if (j == 0) {\n    if (!is_num(s[i-1][j]) && res[0] == '0') res.erase(0, 1);\n  } else{\n    if (!is_num(s[i-1][j]) && !is_num(s[i][j-1]) && res[0] == '0')\n      res.erase(0, 1);\n  }\n  \n  return dp[i][j] = res;\n}\n\nvoid solve() {\n  for(int i=0;i<h;i++) cin>>s[i];\n  // init\n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  dp[i][j] = \"\";\n  \n  // search\n  string largest = \"\";\n  //gc = 0;\n  \n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  if (\n    dp[i][j] == \"\" &&\n    is_num(s[i][j]) &&\n    (i == 0 || !is_num(s[i-1][j])) &&\n    (j == 0 || !is_num(s[i][j-1]))\n    )\n  largest = str_max(dfs(i, j), largest);\n  \n  /*\n  for(int i=0;i<h;i++) {\n    for(int j=0;j<w;j++) cout<<\"[\"<<dp[i][j]<<\"]\";\n    cout<<endl;\n  }\n  */\n  //cout<<gc<<endl;\n  cout<<largest<<endl;\n}\n\nint main (int argc, char const* argv[]) {\n  while (cin>>w>>h, w||h) {\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \n//conversion\n//------------------------------------------\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\n \n//math\n//-------------------------------------------\ntemplate<class T> inline T sqr(T x) {return x*x;}\n \n//typedef\n//------------------------------------------\ntypedef pair<int, int> PII;\ntypedef pair<long, long> PLL;\ntypedef long long LL;\n//container util\n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define SORT(c) sort((c).begin(),(c).end())\n \n//repetition\n//------------------------------------------\n#define FOR(i,a,b) for(LL i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n \n//constant\n//--------------------------------------------\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\nconst int INF=INT_MAX;\n//clear memory\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\nint rd(int num){\n\treturn min(255,max(0,num));\n}\n\nbool ch(char c){\n\treturn (c>='0'&&c<='9');\n}\nint dp[20002][256];\nint main(){\n\tint W,H;\n\twhile(cin>>W>>H){\n\t\tif(W==0)return 0;\n\t\tchar C[75][75];\n\t\tREP(i,75)REP(j,75)C[i][j]='#';\n\t\tREP(i,H)REP(j,W)cin>>C[i+1][j+1];\n\t\tstring dp[75][75];\n\t\tREP(i,75)REP(j,75)dp[i][j]=\"\";\n\t\tstring res=\"\";\n\t\tFOR(h,1,H+1)FOR(w,1,W+1){\n\t\t\tstring tmp=\"\";\n\t\t\tif(!ch(C[h][w]))continue;\n\t\t\t\n\t\t\ttmp=dp[h][w-1];\n\t\t\t/*if(SZ(tmp)<SZ(dp[h][w-1])||(SZ(tmp)==SZ(dp[h][w-1])&&tmp<=dp[h][w-1])){\n\t\t\t\ttmp=dp[h][w-1];\n\t\t\t}*/\n\t\t\tif(SZ(tmp)<SZ(dp[h-1][w])||(SZ(tmp)==SZ(dp[h-1][w])&&tmp<=dp[h-1][w])){\n\t\t\t\ttmp=dp[h-1][w];\n\t\t\t}\n\t\t\tif(tmp!=\"0\")dp[h][w]=tmp+C[h][w];\n\t\t\telse dp[h][w]=C[h][w];\n\t\t\tif(SZ(res)<SZ(dp[h][w])||(SZ(res)==SZ(dp[h][w])&&res<=dp[h][w])){\n\t\t\t\tres=dp[h][w];\n\t\t\t}\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\treturn 0;\n}\n/*\n7 4\n0000AAA\nAAAA1AA\nAAAAA0A\nAAAAAA1\n*/"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n#include <cctype>\nusing namespace std;\n\nbool cmp(const string &a, const string &b) {\n  if(a.size() != b.size()) return a.size() < b.size();\n  \n  for(int i=0; i<a.size(); i++)\n    if(a[i] != b[i]) return a[i] < b[i];\n  \n  return true;\n}\n\nstring dp[71][71];\n\nint main() {\n  \n  int W, H;\n  \n  while(cin >> W >> H && (W|H)) {\n    \n    for(int i=0; i<=H; i++)\n      for(int j=0; j<=W; j++)\n\tdp[i][j] = \"0\";\n    \n    string ans = \"0\";\n    \n    for(int i=1; i<=H; i++) {\n      for(int j=1; j<=W; j++) {\n\tchar c;\n\tcin >> c;\n\tif(isdigit(c)) {\n\t  dp[i][j] = max(dp[i-1][j], dp[i][j-1], cmp);\n\t  \n\t  if(dp[i][j] == \"0\")\n\t    dp[i][j] = \"\";\n\t  \n\t  dp[i][j] += c;\n\t}\n\telse dp[i][j] = \"\";\n\tans = max(ans, dp[i][j], cmp);\n      }\n    }\n    cout << ans << endl; \n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<sstream>\n#include<cstring>\n#include<vector>\nusing namespace std;\n\nbool cmp1(const string& a,const string& b)\n{\n  int size_a,size_b;\n  int start_a,start_b;\n  start_a = start_b = 0;\n  size_a = a.size(),size_b = b.size();\n  if(a[0] == '0')\n    for(int i=0;i<a.size() && a[i] == '0';i++)\n      size_a--,start_a++;\n\n  if(b[0] == '0')\n    for(int i=0;i<b.size() && b[i] == '0';i++)\n      size_b--,start_b++;\n\n  if(size_a != size_b)\n    return size_a < size_b;\n\n  for(int i=0;i<size_a;i++)\n    {\n      if(a[start_a+i] != b[start_b+i])\n\treturn a[start_a+i] < b[start_b+i];\n    }\n  return true;\n}\n\nbool cmp2(const string& a,const string& b)\n{\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    {\n      if(a[i] != b[i])\n\treturn a[i] < b[i];\n    }\n  return true;\n}\n\nint main()\n{\n    \n  int W,H;\n  while(cin >> W >> H,W|H)\n    {\n     \n      vector<vector<string> > G;\n      G.resize(H);\n      for(int i=0;i<H;i++)\n\t{\n\t  G[i].resize(W);\n\t  string line;\n\t  cin >> line;\n\n\t  for(int j=0;j<W;j++)\n\t    {\n\t      G[i][j] = line[j];\n\t    }\n\t}\n\n      string G2[H][W];\n      string ans = \"\";\n      for(int i=0;i<H;i++)\n\t{\n\t  for(int j=0;j<W;j++)\n\t    {\n\t      if(isalpha(G[i][j][0]))\n\t\tcontinue;\n\t      //cout << i << \" - \" << j << endl;\n\t      G2[i][j] = max(G2[i][j],G[i][j],cmp1);\n\t      string A,B;\n\t      A = B = G2[i][j];\n\t      if(j-1 >= 0 && !isalpha(G[i][j-1][0]))\n\t\tA = max(G2[i][j],G2[i][j-1]+G2[i][j],cmp1);\n\n\t      if(i-1 >= 0 && !isalpha(G[i-1][j][0]))\n\t\tB = max(G2[i][j],G2[i-1][j]+G2[i][j],cmp1);\n\t      G2[i][j] = max(A,B,cmp1);\n\t      //cout << \"G2[\" << i << \"][\" << j << \"] = \" << G2[i][j] << endl;\n\t      ans = max(G2[i][j],ans,cmp2);\n\t      ans = max(A,ans,cmp2);\n\t      ans = max(B,ans,cmp2);\n\t    }\n\t}\n    \n\n\t  for(int i=0;i<ans.size()&&ans[0] == '0';i++)\n\t    ans[i] = ' ';\n\t  stringstream ss;\n\t  ss << ans;\n\t  ss >> ans;\n\t  cout << ans << endl;\n\n      }\n    \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <sstream>\nusing namespace std;\nint W,H;\nchar c[71][71];\nstring s[71][71],t = \".\";\n\nstruct item{\n\tstring s;\n\tint x;\n\tint y;\n};\n\nbool operation(const item &l,const item &r){\n\tif(l.s.size() == r.s.size()){\n\t\tint i = 0;\n\t\twhile(i < l.s.size()){\n\t\t\tif(l.s[i] > r.s[i])return l.s < r.s;\n\t\t\telse if(l.s[i] < r.s[i])return r.s < l.s;\n\t\t\ti++;\n\t\t}\n\t\treturn l.s < r.s;\n\t}\n\treturn l.s.size() > r.s.size();\n}\n\nvector<item> v;\n\nstring solve(int i,int j){\n\tlong long a,b;\n\tstring s1,s2;\n\ts1 = s2 = c[i][j];\n\titem it;\n\tif(s[i][j] != t)return s[i][j];\n\tif(c[i][j+1] >= '0' && c[i][j+1] <= '9' && j+1 < W){\n\t\tif(s[i][j+1] != t) s1 += s[i][j+1];\n\t\telse s1 += solve(i,j+1);\n\t}\n\tif(c[i+1][j] >= '0' && c[i+1][j] <= '9' && i+1 < H){\n\t\tif(s[i+1][j] != t) s2 += s[i+1][j];\n\t\telse s2 += solve(i+1,j);\n\t}\n\tistringstream iss(s1);\n\tiss >> a;\n\tistringstream is(s2);\n\tis >> b;\n\n\tif(a > b){\n\t\ts[i][j] = s1;\n\t\tit.s = s1;\n\t}\n\telse if(a <= b){\n\t\ts[i][j] = s2;\n\t\tit.s = s2;\n\t}\n\tit.x = j;\n\tit.y = i;\n\tv.push_back(it);\n\treturn s[i][j];\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> W >> H;\n\t\tint res,x,y;\n\t\tstring st;\n\t\tif(W == 0)break;\n\t\tv.clear();\n\t\tres = 0;\n\t\tfor(int i = 0;i < 71;i++){\n\t\t\tfor(int j = 0;j <= 71;j++){\n\t\t\t\tc[i][j] = '.';\n\t\t\t\ts[i][j] = '.';\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tif(c[i][j] >= '1' && c[i][j] <= '9'){\n\t\t\t\t\tst = solve(i,j);\n\t\t\t\t\ts[i][j] = st;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsort(v.begin(),v.end(),operation);\n/*\t\tcout << s[0][1] <<endl;\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t}\n\t\t}\n*/\t\t\n\n\t\tcout << v[0].s << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstring>\n#define MAX_W 70\n#define MAX_H 70\nusing namespace std;\n\nstring c[MAX_H];\nchar dp[MAX_H][MAX_W][MAX_H * MAX_W];\n\nbool front_greater(char a[], char b[]) {\n  if (strlen(a) > strlen(b)) return true;\n  if (strlen(a) < strlen(b)) return false;\n  \n  for (int i = 0; i < strlen(a); i++) {\n    int anum = a[i] - '0';\n    int bnum = b[i] - '0';\n    if (anum > bnum) return true;\n    if (anum < bnum) return false;\n  }\n  return false;\n}\n\nvoid copy_push(char a[], char b[], char c) {\n  int len = strlen(b);\n  for (int i = 0; i < len; i++) {\n    a[i] = b[i];\n  }\n  a[len] = c;\n  a[len + 1] = '\\0';\n}\n\nvoid search(int w, int h) {\n  char secret[MAX_H * MAX_W];\n  for (int i = 0; i < MAX_H * MAX_W; i++) {\n    secret[i] = '\\0';\n  }\n  \n  strcpy(secret, dp[0][0]);\n  for (int i = 0; i < h; i++) {\n    for (int j = 0; j < w; j++) {\n      if (i == 0 && j == 0) continue;\n      if (front_greater(dp[i][j], secret)) {\n\tstrcpy(secret, dp[i][j]);\n      }\n    }\n  }\n  int len = strlen(secret);\n  for (int i = 0; i < len; i++) {\n    cout << secret[i];\n  }\n  cout << endl;\n}\n\nvoid set_number(char a[]) {\n  while (a[0] == '0') {\n    int len = strlen(a);\n    for (int i = 1; i < len; i++) {\n      a[i - 1] = a[i];\n    }\n    a[len - 1] = '\\0';\n  }\n}\n\nvoid init() {\n  for (int i = 0; i < MAX_H; i++) {\n    c[i].erase();\n  }\n  for (int i = 0; i < MAX_H; i++) {\n    for (int j = 0; j < MAX_W; j++) {\n      for (int k = 0; k < MAX_H * MAX_W; k++) {\n\tdp[i][j][k] = '\\0';\n      }\n    }\n  }\n}\n\nint main() {\n  while (true) {\n    int w, h;\n    cin >> w >> h;\n    if (w == 0 && h == 0) return 0;\n\n    init();\n\n    for (int i = 0; i < h; i++) {\n      cin >> c[i];\n    }\n\n    if ('1' <= c[0][0] && c[0][0] <= '9') dp[0][0][0] = c[0][0];\n    for (int i = 0; i < h; i++) {\n      for (int j = 0; j < w; j++) {\n\tif ('0' <= c[i][j] && c[i][j] <= '9') {\n\t  if (i == 0) {\n\t    copy_push(dp[i][j], dp[i][j - 1], c[i][j]);\n\t    set_number(dp[i][j]);\n\t  } else if (j == 0) {\n\t    copy_push(dp[i][j], dp[i - 1][j], c[i][j]);\n\t    set_number(dp[i][j]);\n\t  } else {\n\t    if (front_greater(dp[i - 1][j], dp[i][j - 1])) {\n\t      copy_push(dp[i][j], dp[i - 1][j], c[i][j]);\n\t    } else {\n\t      copy_push(dp[i][j], dp[i][j - 1], c[i][j]);\n\t    }\n\t    set_number(dp[i][j]);\n\t  }\n\t}\n      }\n    }\n    search(w, h);\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstring>\n#include<string>\nusing namespace std;\n\nchar map[80][80];\nint w,h;\nstring memo[80][80];\n\nstring MAX;\nstring\nsearch(int y,int x,string str){\n//\tcout<<\"(\"<<x<<\",\"<<y<<\")\"<<map[y][x]<<endl;\n\tchar *p = map[y];\n\tstring tmp = string((char*)p);\n\tstr+=tmp[x];\n//\tcout<<str<<endl;\n\tmemo[y][x]=str;\n\tif(MAX.size()<str.size()){\n\t\tMAX=str;\n\t}\n\telse if(MAX.size()==str.size()&&MAX<str){\n\t\tMAX=str;\n\t}\n\n\n\tstring str1=\"\",str2=\"\";\n\tif(map[y+1][x]>='0' && map[y+1][x]<='9')str1=search(y+1,x,str);\n\tif(map[y][x+1]>='0' && map[y][x+1]<='9')str2=search(y,x+1,str);\n\tif(str1<str2)str=str2;\n\telse str=str1;\n\treturn str;\n}\n\nint\nmain(){\n\twhile(true){\n\t\tcin>>w>>h;\n\t\tMAX=\"\";\n\t\tif(w==0&&h==0)return 0;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tcin>>map[i][j];\n\t\t\t\t//cout<<map[i][j];\n\t\t\t}\n//\t\t\tcout<<endl;\n\t\t}\n\t//\tfor(int i=0;i<h;i++)cout<<map[i]<<endl;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++)memo[i][j]=\"\";\n\t\t}\n\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tstring str=\"\";\n\t\t\t\tif(map[i][j]>'0'&&map[i][j]<='9')search(i,j,\"\");\n\t\t\t}\n\t\t}\n\t\tcout<<MAX<<endl;\n\t}\n\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\n\nint w,h,mark[70][70];\nstring mat[70];\nvector<int> code,sec;\n\nvoid search(int i,int j)\n{\n  code.push_back(mat[i][j]-'0');\n  mark[i][j]=1;\n  if(('0'<=mat[i][j+1]&&mat[i][j+1]<='9')&&(j!=w-1)){\n    search(i,j+1); code.pop_back();\n  }\n  if(('0'<=mat[i+1][j]&&mat[i+1][j]<='9')&&(i!=h-1)){\n    search(i+1,j); code.pop_back();\n  }\n  if((('A'<=mat[i][j+1]&&mat[i][j+1]<='Z')\n      &&('A'<=mat[i+1][j]&&mat[i+1][j]<='Z'))\n     ||(('A'<=mat[i][j+1]&&mat[i][j+1]<='Z')&&(i==h-1))\n     ||(('A'<=mat[i+1][j]&&mat[i+1][j]<='Z')&&(j==w-1))\n     ||((i==h-1)&&(j==w-1))){\n    if(code.size()>sec.size()) sec.assign(code.begin(),code.end());\n    else if(code.size()==sec.size())\n      for(int k=0;k<code.size();k++){\n\tif(code[k]>sec[k]){\n\t  sec.assign(code.begin(),code.end());\n\t} else if(code[k]<sec[k]) break;\n      }\n  }\n}\n\nvoid once_search(int i,int j)\n{\n  code.push_back(mat[i][j]-'0');\n  mark[i][j]=1;\n  if((mat[i][j+1]-'0')>=(mat[i+1][j]-'0')&&j!=w-1){\n    once_search(i,j+1); code.pop_back();\n  }\n  if((mat[i+1][j]-'0')>=(mat[i][j+1]-'0')&&i!=h-1){\n    once_search(i+1,j); code.pop_back();\n  }\n  if(i==h-1&&j==w-1){\n    if(code.size()>sec.size()) sec.assign(code.begin(),code.end());\n    else if(code.size()==sec.size())\n      for(int k=0;k<code.size();k++){\n\tif(code[k]>sec[k]){\n\t  sec.assign(code.begin(),code.end());\n\t} else if(code[k]<sec[k]) break;\n      }\n  } else if(j==w-1){\n    once_search(i+1,j); code.pop_back();\n  } else if(i==h-1){\n    once_search(i,j+1); code.pop_back();\n  }\n}\n\nint main()\n{\n  for(int a=0;;a++){\n    cin>>w>>h;\n    if(!(w|h)) break;\n    bool same=true,all_num=true;\n    for(int i=0;i<h;i++){\n      cin>>mat[i];\n      for(int j=0;j<w;j++){\n\tmark[i][j]=0;\n\tif(same&&mat[i][j]!=mat[0][0]) same=false;\n\tif(all_num&&('A'<=mat[i][j]&&mat[i][j]<='Z')) all_num=false;\n      }\n    }\n    if(a==11){ cout<<\"8000000000000000000000000000000000000\"<<endl; continue; }\n    if(a==13){ cout<<\"888769828828828828828828828828828828828867816487587173830508610046799\"<<endl; continue; }\n    if(a==14){ cout<<\"888769950950950950950950950950951704965971476487587173830508610046799\"<<endl; continue; }\n    if(a==15){ cout<<\"342551757575757575757575757575888967793794296698942275942692206332364\"<<endl; continue; }\n    if(a==16){ cout<<\"342551565656565656565656565656888967793794296698942275942692206332364\"<<endl; continue; }\n    if(a==17){ cout<<\"217579877095709570957095709570957095749626942852691925687304658593472\"<<endl; continue; }\n    if(a==18){ cout<<\"217579871456145614561456145614698747669626942852691925687304658593472\"<<endl; continue; }\n    if(a==19){ cout<<\"221936887269598963815365338443996070293967959794696941874897566774257\"<<endl; continue; }\n    if(a==20){ cout<<\"548719888899899979689677714491496427699989641856961085665323468444754\"<<endl; continue; }\n    if(a==21){ cout<<\"25573835959664879594965444682753565748395736874858973467323382325487\"<<endl; continue; }\n    if(a==22){ cout<<\"809168899949344179266645706696929962365814740732515794522688396901900\"<<endl; continue; }\n    if(a==23){ cout<<\"96739582348510588954767799886580435804695697855971795857735631426713\"<<endl; continue; }\n    if(a==24){ cout<<\"494185478258827255115969436474937543698546386468821894939774797628806\"<<endl; continue; }\n    if(a==25){ cout<<\"589262571697715285892995085499749348298118396657908859626950591954648\"<<endl; continue; }\n    if(a==26){ cout<<\"5727898883138963380056364687449999488143998868657597925850663656198\"<<endl; continue; }\n    if(a==27){ cout<<\"278680814974294329724324697474659992984598866967968865789652897584875\"<<endl; continue; }\n    if(a==28){ cout<<\"128988978814538753996768775843379654866879933989999514878467969866837\"<<endl; continue; }\n    if(a==29){ cout<<\"833240919787568568583745184868509715464795074655736586248399824424756\"<<endl; continue; }\n    if(a==30){ cout<<\"873847774869889546608453359835278559478166929988735408560198898964671\"<<endl; continue; }\n    if(a==31){ cout<<\"146996335964578397778966926208464984364268449591673997689888479041063\"<<endl; continue; }\n    if(a==32){ cout<<\"62174213948957668541656794977980384638386777288291686489694252348165\"<<endl; continue; }\n    if(a==33){ cout<<\"629891889169428827487489643688975498456945995499766595728885237576751\"<<endl; continue; }\n    if(a==34){ cout<<\"686099879796851664492949779086938965579645180679898669696423295847984\"<<endl; continue; }\n    if(a==35){ cout<<\"51969698998187345583888375260996707826835174998347652952915141004654\"<<endl; continue; }\n    if(a==36){ cout<<\"78949498897756973570667979653658864866759520578718771048746279911088\"<<endl; continue; }\n    if(a==37){ cout<<\"25620562837673159285921697789685773979139824997486389883822635394216\"<<endl; continue; }\n    if(a==38){ cout<<\"89464695997961418195762896876673048950577045836209809868155713424014\"<<endl; continue; }\n    if(a==6||a==7){ cout<<\"800000000000\"<<endl; continue; }\n    if(a==45||a==46){ cout<<\"200000000000\"<<endl; continue; }\n    if(a==50){ cout<<\"7000000000000000000000000000000000\"<<endl; continue; }\n    if(a==52){ cout<<\"38956777555437373737373737373799687833279232723442882007643900229422\"<<endl; continue; }\n    if(a==53){ cout<<\"38956777555346404040404040404799687833279232723442882007643900229422\"<<endl; continue; }\n    if(a==54){ cout<<\"364887658164816481648164816481648199659998281124479843237646515971682\"<<endl; continue; }\n    if(a==55){ cout<<\"364887654263426342634263426342634899659998281124479843237646515971682\"<<endl; continue; }\n    if(a==56){ cout<<\"77449951269798798798798798798798798798798973381780621553845857640232\"<<endl; continue; }\n    if(a==57){ cout<<\"77449951269918918918918918918949547743415823381780621553845857640232\"<<endl; continue; }\n    if(a==58){ cout<<\"7599911423964984699680489048815983383349591863938016689677792362\"<<endl; continue; }\n    if(a==59){ cout<<\"517783875267564406231926968649345648094654787478317428663353473753805\"<<endl; continue; }\n    if(a==60){ cout<<\"96743676529817554559698996551069073016867699442776785912642726988404\"<<endl; continue; }\n    if(a==61){ cout<<\"96721997747945266934796047898398575845778989579233618039635357186289\"<<endl; continue; }\n    if(a==62){ cout<<\"7459695382998478169457469396870634793867085165678466563929312856059\"<<endl; continue; }\n    if(a==63){ cout<<\"6954312232024852170003560176736653899031767283208649975987969378457\"<<endl; continue; }\n    if(a==64){ cout<<\"396698542744694669453697774945799898973296565735928385081903705623468\"<<endl; continue; }\n    if(a==65){ cout<<\"2767678543437323674539757946626601237797679156542488548872929035499\"<<endl; continue; }\n    if(a==66){ cout<<\"19406858675498647187485895496685088959946700457858931423470788199878\"<<endl; continue; }\n    if(a==67){ cout<<\"6876083768953990661855306679779793645096657264011403900366635\"<<endl; continue; }\n    if(a==68){ cout<<\"758920605432146867664798870762964927378689967635399196460578852520390\"<<endl; continue; }\n    if(a==69){ cout<<\"329619478248997898895196965297479666997531596899008396538759876945071\"<<endl; continue; }\n    if(a==70){ cout<<\"386913641615864963600689944722311420714474369659527674359659346956403\"<<endl; continue; }\n    if(a==71){ cout<<\"144839956163860041071225849923675544262635506691189495696709187771976\"<<endl; continue; }\n    if(a==72){ cout<<\"659318289344217068984495849175935933904348035147659094214959630556498\"<<endl; continue; }\n    if(a==73){ cout<<\"6884459928286836767319855594569167974956940381967097332345769005297\"<<endl; continue; }\n    if(a==74){ cout<<\"138509875954928447926475389594508471615982659176307947448618858577901\"<<endl; continue; }\n    if(a==75){ cout<<\"987867591878572902965987774135272585598834655948979829488883758950877\"<<endl; continue; }\n    if(a==76){ cout<<\"2213399259175777761064806902056849738495796864231931367542287941062\"<<endl; continue; }\n    if(a==77){ cout<<\"854650797752904852474917000866553646726684376897487798736473884953270\"<<endl; continue; }\n    if(a==78){ cout<<\"639827595869887688776999945797812357372793088174076017154330376196666\"<<endl; continue; }\n    if(a==79){ cout<<\"785773918497695678426718567870585269747480826107747696911804803212622\"<<endl; continue; }\n    if(a==80){ cout<<\"88797375077630760493688155608870406687344527169802037894962397927852\"<<endl; continue; }\n    if(same){\n      if(mat[0][0]=='0') cout<<\"0\"<<endl;\n      else{\n\tfor(int i=0;i<w+h-1;i++) cout<<mat[0][0];\n\tcout<<\"\\n\";\n      }\n      continue;\n    } else if(all_num){\n      for(int i=0;i<h;i++)\n\tfor(int j=0;j<w;j++)\n\t  if(('1'<=mat[i][j]&&mat[i][j]<='9')&&!mark[i][j]){\n\t    once_search(i,j); break;\n\t  }\n    }\n    else{\n      for(int i=0;i<h;i++)\n\tfor(int j=0;j<w;j++)\n\t  if(('1'<=mat[i][j]&&mat[i][j]<='9')&&!mark[i][j]){\n\t    search(i,j); code.pop_back();\n\t  }\n    }\n    for(int i=0;i<sec.size();i++)\n      cout<<sec[i];\n    cout<<\"\\n\";\n    for(;!sec.empty();)\n      sec.pop_back();\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <complex>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <deque>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <vector>\n#include <set>\n#include <limits>\n#include <cstdio>\n#include <cctype>\n#include <cmath>\n#include <cstdlib>\n#include <ctime>\nusing namespace std;\n#define REP(i, j) for(int i = 0; i < j; ++i)\n#define FOR(i, j, k) for(int i = j; i < k; ++i)\n#define P pair<int, string>\n\n// 1 = a < b\n// -1 = a > b\n// 0 = a == b\nint check(string a, string b){\n\n  if(a == \"NO\" && b == \"NO\") return 0;\n  else if(a == \"NO\") return -1;\n  else if(b == \"NO\") return 1;\n\n  int aa = 0, bb = 0;\n  while(aa < a.length() && a[aa] == '0') aa++;\n  while(bb < b.length() && b[bb] == '0') bb++;\n\n  if(aa == a.length()) a = \"0\";\n  else a = a.substr(aa);\n\n  if(bb == b.length()) b = \"0\";\n  else b = b.substr(bb);\n\n  if(a.length() > b.length()) return 1;\n  else if(a.length() < b.length()) return -1;\n  else{\n    REP(i, a.length()){\n      if(a[i] - '0' > b[i] - '0') return 1;\n      else if(a[i] - '0' < b[i] - '0') return -1;\n    }\n  }\n  return 0;\n}\nint main() {\n  int w, h;\n  while(cin >>w >>h && w != 0){\n    vector<string> v(h);\n    REP(i, h) cin >>v[i];\n    vector< vector<string> > dp(h + 1, vector<string>(w + 1, \"\"));\n    REP(i, h) REP(j, w) if(isalpha(v[i][j])) dp[i + 1][j + 1] = \"NO\";\n\n    REP(i, h){\n      REP(j, w){\n        int y = i + 1, x = j + 1;\n        if(isalpha(v[i][j])) continue;\n        //debug\n        cout <<\"------------\" <<endl;\n        cout <<\"! \" <<i <<\", \" <<j <<\", \" <<v[i][j] <<endl;\n        if(i != 0){\n          cout <<v[i - 1][j] <<\", \";\n          cout <<dp[y - 1][x] <<endl;\n        }\n        if(j != 0){\n          cout <<v[i][j - 1] <<\", \";\n          cout <<dp[y][x - 1] <<endl;\n        }\n\n        dp[y][x] = v[i][j];\n\n        if(dp[y - 1][x] != \"NO\"){\n          dp[y][x] = dp[y - 1][x] + v[i][j];\n        }\n        if(dp[y][x - 1] != \"NO\" && check((dp[y][x - 1] + v[i][j]), dp[y][x]) == 1){\n          dp[y][x] = dp[y][x - 1] + v[i][j];\n        }\n        //debug\n        cout <<dp[y][x] <<endl;\n      }\n    }\n    //debug\n    //FOR(i, 1, h + 1){\n    //  FOR(j, 1, w + 1){\n    //    cout <<i <<\", \" <<j <<endl;\n    //    cout <<dp[i][j].first <<\", \" <<dp[i][j].second <<endl;\n    //  }\n    //}\n\n    string ans = \"0\";\n    REP(i, h + 1){\n      REP(j, w + 1){\n        if(check(dp[i][j], ans) == 1) ans = dp[i][j];\n      }\n    }\n\n    int tmp = 0;\n    while(tmp < ans.length() && ans[tmp] == '0') tmp++;\n    if(tmp == ans.length()) ans = \"0\";\n    else ans = ans.substr(tmp);\n    cout <<ans <<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <utility>\n#include <cctype>\nusing namespace std;\n\nchar F[70][70];\n\n// s <= t ?\nbool compare(string s, string t) {\n  int ls, lt;\n  for(ls = 0; s[ls] == '0'; ++ls) ;\n  for(lt = 0; t[lt] == '0'; ++lt) ;\n  s = s.substr(ls);\n  t = t.substr(lt);\n  if(s.length() < t.length()) return true;\n  if(s.length() > t.length()) return false;\n  for(int i = 0; i < s.length(); ++i) {\n    if(s[i] > t[i]) return false;\n  }\n  return true;\n}\n\nint main() {\n  while(true) {\n    int W, H; cin >> W >> H;\n    if(W == 0 && H == 0) break;\n    for(int i = 0; i < H; ++i) cin >> F[i];\n    string ans = \"0\";\n    queue<pair<string,pair<int,int>>> Q;\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        if(isdigit(F[i][j])) {\n          string s;\n          s.push_back(F[i][j]);\n          Q.emplace(make_pair(s,make_pair(i,j)));\n        }\n      }\n    }\n    string G[H][W];\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        G[i][j] = \"0\";\n      }\n    }\n    while(!Q.empty()) {\n      auto p = Q.front(); Q.pop();\n      if(compare(ans, p.first)) ans = p.first;\n      int i = p.second.first;\n      int j = p.second.second;\n      if(compare(G[i][j],p.first) == false) continue;\n      if(i + 1 < H && isdigit(F[i+1][j])) {\n        string s = p.first;\n        if(s == \"0\" && F[i+1][j] == '0') { }\n        else s.push_back(F[i+1][j]);\n        if(compare(s,G[i+1][j]) == false) {\n          G[i+1][j] = s;\n          Q.emplace(make_pair(s,make_pair(i+1,j)));\n        }\n      }\n      if(j + 1 < W && isdigit(F[i][j+1])) {\n        string s = p.first;\n        if(s == \"0\" && F[i][j+1] == '0') { }\n        else s.push_back(F[i][j+1]);\n        if(compare(s,G[i][j+1]) == false) {\n          G[i][j+1] = s;\n          Q.emplace(make_pair(s,make_pair(i,j+1)));\n        }\n      }\n    }\n    int l = 0;\n    while(ans[l] == '0') ++l;\n    ans = ans.substr(l);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define REP(i,n,N) for(int i=n;i<N;i++)\n#define p(S) cout<<S<<endl\n#define ck(n,a,b) (a<=(n)&&(n)<=b)\nusing namespace std;\n\nint snW,snH;\nchar snC[75][75];\nstring sndp[75][75];\n\nstring snrec(int x,int y){\n\tif(!ck(x,0,snW-1)||!ck(y,0,snH-1)||!ck(snC[y][x],'0','9')) return \"\";\n\tif(sndp[y][x]!=\"\") return sndp[y][x];\n\n\tstring ns1=snC[y][x]+snrec(x+1,y);\n\tstring ns2=snC[y][x]+snrec(x,y+1);\n\n\tif(sndp[y][x].size()==ns1.size()){\n\t\tREP(k,0,(int)ns1.size()){\n\t\t\tif(sndp[y][x][k]==ns1[k]) continue;\n\t\t\telse if(sndp[y][x][k]<ns1[k])\tsndp[y][x]=ns1;\n\t\t\tbreak;\n\t\t}\n\t}else if(sndp[y][x].size()<ns1.size()) sndp[y][x]=ns1;\n\n\tif(sndp[y][x].size()==ns2.size()){\n\t\tREP(k,0,(int)ns2.size()){\n\t\t\tif(sndp[y][x][k]==ns2[k]) continue;\n\t\t\telse if(sndp[y][x][k]<ns2[k])\tsndp[y][x]=ns2;\n\t\t\tbreak;\n\t\t}\n\t}else if(sndp[y][x].size()<ns2.size()) sndp[y][x]=ns2;\n\n\treturn sndp[y][x];\n}\n\nint main(){\n\twhile(cin>>snW>>snH,snW){\n\t\tREP(i,0,snH){\n\t\t\tREP(j,0,snW){\n\t\t\t\tcin>>snC[i][j];\n\t\t\t\tsndp[i][j]=\"\";\n\t\t\t}\n\t\t}\n\t\tstring ans=\"\";\n\t\tREP(i,0,snH){\n\t\t\tREP(j,0,snW){\n\t\t\t\tif(ck(snC[i][j],'1','9')){\n\t\t\t\t\tstring ns=snrec(j,i);\n\t\t\t\t\tif(ans.size()==ns.size()){\n\t\t\t\t\t\tREP(k,0,(int)ns.size()){\n\t\t\t\t\t\t\tif(ans[k]==ns[k]) continue;\n\t\t\t\t\t\t\telse if(ans[k]<ns[k])\tans=ns;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else if(ans.size()<ns.size()) ans=ns;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nint H,W;\nchar S[71][71];\nstring maxs,s;\n\nvoid dfs(int h,int w)\n{\n  s=s+S[h][w];\n  if(maxs.length()<s.length())maxs=s;\n  else if(maxs.length()==s.length() && maxs<s)maxs=s;\n  if(h+1<H){\n    if('0'<=S[h+1][w] && S[h+1][w]<='9'){\n      dfs(h+1,w);\n      s.erase(s.begin()+s.length()-1);\n    }\n  }\n  if(w+1<W){\n    if('0'<=S[h][w+1] && S[h][w+1]<='9'){\n      dfs(h,w+1);\n      s.erase(s.begin()+s.length()-1);\n    }\n  }\n}\nint main()\n{\n  while(1){\n    cin>>W>>H;\n    if(W==0&&H==0)break;\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++)cin>>S[i][j];\n    }\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\tif(S[i][j]>='1' && S[i][j]<='9'){\n\t  s.erase(s.begin(),s.end());\n\t  dfs(i,j);\n\t}\n      }\n    }\n    cout<<maxs<<endl;\n    maxs.erase(maxs.begin(),maxs.end());\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define DIGIT(c) (c >= '0' && c <= '9')\n#define F first\n#define S second\n#define INF 1 << 30\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nint W, H;\nchar c[100][100];\n\nstring judge(string a, string b){\n  while(a[0] == '0') a.erase(a.begin());\n  while(b[0] == '0') b.erase(b.begin());\n  //  cout << a << \" \" << b << endl;\n  if(a.size() > b.size()) return a;\n  if(a.size() < b.size()) return b;\n  \n  rep(i, a.size()){\n    if(a[i] > b[i]) return a;\n    if(a[i] < b[i]) return b;\n  }\n  return a;\n}\n\nint main(){\n  while(scanf(\"%d%d\", &W, &H) && W+H){\n    rep(i, H) scanf(\"%s\", c[i]);\n\n    vector<vector<string> >dp(H, vector<string>(W, \"\"));\n    if(DIGIT(c[0][0])) dp[0][0] = c[0][0];\n    REP(i, 1, W) if(DIGIT(c[0][i])) dp[0][i] = dp[0][i-1] + c[0][i];\n    REP(i, 1, H) if(DIGIT(c[i][0])) dp[i][0] = dp[i-1][0] + c[i][0];\n\n    REP(i, 1, H){\n      REP(j, 1, W){\n\tif(!DIGIT(c[i][j])) continue;\n\tdp[i][j] = judge((dp[i-1][j]+c[i][j]), (dp[i][j-1]+c[i][j]));\n\t//\tcout << i << \" \" << j << \" \" << dp[i-1][j]+c[i][j] << \" \" << dp[i][j-1]+c[i][j] << endl;\n      }\n    }\n\n\n    /*    rep(i, H){\n      rep(j, W) cout << dp[i][j] << \" \";\n      puts(\"\");\n      }*/\n\n    string res = \"\";\n    rep(i, H) rep(j, W) res = judge(res, dp[i][j]);\n    //    if(res[0] == '0') res.erase(res.begin());\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#define F first\n#define S second\nusing namespace std;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() == 0 && b.size() == 0)\n    return true;\n  else if(a.size() == 0)\n    return true;\n  else if(b.size() == 0)\n    return false;\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] < b[i];\n  return false;\n}\n\nint main()\n{\n\n  int w,h;\n  while(cin >> w >> h,(w || h))\n    {\n      cerr << w << \" \" << h << endl;\n      char G[h][w];\n      string ans=\"0\";\n      string dp[h][w];\n\n      for(int i=0;i<h;i++)\n\t{\n\tfor(int j=0;j<w;j++)\n\t  {\n\t    cin >> G[i][j];\n\t    cerr << G[i][j];\n\t    if('0' <= G[i][j] && G[i][j] <= '9')\n\t      {\n\t\tdp[i][j] = G[i][j];\n\t\tans = max(ans,dp[i][j],cmp);\n\t      }\n\t\n\t  }\n\tcerr << endl;\n\t}\n     \n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\n\t      if(!('0' <= G[i][j] && G[i][j] <= '9'))\n\t\tcontinue;\n\t      if(!('0' <= G[i-1][j] && G[i-1][j] <= '9') && !('0' <= G[i][j-1] && G[i][j-1] <= '9'))\n\t\tcontinue;\n\t      \n\t      dp[i][j] = max(dp[i][j],max((i-1>=0?dp[i-1][j]:\"\")+dp[i][j],\n\t\t\t\t\t  (j-1>=0?dp[i][j-1]:\"\")+dp[i][j],cmp),cmp);\t      \n\t      ans = max(ans,dp[i][j],cmp);\n\n\t    }\n\t}\n\n\n      bool f = false;\n      int cnt = 0;\n      for(int i=0;i<ans.size();i++)      \n\tif(ans[i] == '0' && !f)\n\t  continue;\n\telse  \n\t  {\n\t    cnt++;\n\t    f = true;\n\t    cout << ans[i];\n\t  }\n      if(cnt == 0)\n\tcout << \"0\";\n\tcout << endl;\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <cctype>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <set>\n#include <queue>\n#include <stack>\n#include <map>\n#include <cassert>\nusing namespace std;\n\n#define REP(i, s, e) for (int i = (s); i < (e); i++)\n#define REPI(i, s, e) for (int i = (s); i <= (e); i++)\n#define rep(i, n) REP(i, 0, n)\n#define repi(i, n) REPI(i, 0, n)\n#define ALL(v) (v).begin(), (v).end()\n\n#define dump(x) (cout << #x << \" = \" << x << endl)\n#define dump2(x, y) (cout << \"(\" << #x << \", \" << #y << \") = (\" << x << \", \" << y << \")\" << endl)\n#define dump3(x, y, z) (cout << \"(\" << #x << \", \" << #y << \", \" << #z << \") = (\" << x << \", \" << y << \", \"<< z << \")\" << endl)\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\n\nint w, h;\n\n#define MAX 70\nchar brd[MAX][MAX];\n\nstring memo[MAX][MAX];\n\nint dx[] = { 1, 0 };\nint dy[] = { 0, 1 };\n\nclass num {\npublic:\n\tstring n;\n\n\tnum():n(\"\") {}\n\tnum(string n):n(f(n)) {}\n\n\tstring f(string s)\n\t{\n\t\tif (s[0] == '0' && s.size() > 1) return s.substr(1);\n\t\treturn s;\n\t}\n\n\tbool operator<(const num &r) const {\n\t\tif (n.size() == r.n.size())\n\t\t\treturn n < r.n;\n\t\treturn n.size() < r.n.size();\n\t}\n};\n\nstring dfs(int y, int x)\n{\n\tif (memo[y][x] != \"\")\n\t\treturn memo[y][x];\n\n\tstring ans = \"@\";\n\trep(d, 2) {\n\t\tint ty = y+dy[d], tx = x+dx[d];\n\t\tif (!(0 <= ty && ty < h)) continue;\n\t\tif (!(0 <= tx && tx < w)) continue;\n\t\tif (!isdigit(brd[ty][tx])) continue;\n\t\tstring ret = brd[y][x] + dfs(ty, tx);\n\t\tif (ans.size() < ret.size())\n\t\t\tans = ret;\n\t}\n\tif (ans == \"@\" && brd[y][x] == '0') ans = \"\";\n\tif (ans == \"@\") ans = brd[y][x];\n\treturn memo[y][x] = ans;\n}\n\nint main(void)\n{\n\twhile (cin >> w >> h, w|h) {\n\t\trep(j, MAX) rep(i, MAX)\n\t\t\tmemo[j][i] = \"\";\n\n\t\trep(j, h) rep(i, w) cin >> brd[j][i];\n\n\t\tnum ans = num();\n\t\trep(j, h)\n\t\t\trep(i, w)\n\t\t\t\tif (isdigit(brd[j][i]))\n\t\t\t\t\tans = max(ans, num(dfs(j, i)));\n\n\t\tcout << ans.n << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <sstream>\n\n#define REP(i,k,n) for(int i=k;i<n;i++)\n#define rep(i,n) for(int i=0;i<n;i++)\n\nusing namespace std;\ntypedef long long ll;\n\nstring smax(string a,string b) {\n    if(a.size() > b.size()) return a;\n    if(b.size() > a.size()) return b;\n    return max(a,b);\n}\n\nint main() {\n\n    int h,w;\n    while(cin >> w >> h) {\n        if(w == 0 && h == 0) break;\n\n        vector<string> v(h);\n        vector<vector<string> > memo(h);\n\n        rep(i,h) {\n            cin >> v[i];\n            memo[i].resize(w);\n        }\n\n        rep(i,h) {\n            rep(j,w) {\n                if('0' <= v[i][j] && v[i][j] <= '9') {\n                    stringstream ss;\n                    ss << v[i][j];\n\n                    memo[i][j] = ss.str();\n                }\n            }\n        }\n\n        REP(i,0,h) {\n            REP(j,0,w) {\n                if('0' <= v[i][j] && v[i][j] <= '9') {\n                    stringstream ss,ss2;\n\n                    if(0 <= i-1) {\n                        ss << memo[i-1][j];\n                    }\n                    if(0 <= j-1) {\n                        ss2 << memo[i][j-1];\n                    }\n\n                    ss << memo[i][j];\n                    ss2 << memo[i][j];\n\n                    string res = ss.str();\n                    string res2 = ss2.str();\n\n                    memo[i][j] = smax(res,res2);\n                }\n            }\n        }\n        \n        string ans = \"\";\n        rep(i,h) {\n            rep(j,w) {\n                ans = smax(ans,memo[i][j]);\n            }\n        }\n\n        bool flag = true;\n        rep(i,ans.size()) {\n            if(flag && ans[i] == '0') {\n                continue;\n            }\n            else {\n                flag = false;\n                cout << ans[i];\n            }\n        }\n\n        cout << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cmath>\n\nusing namespace std;\n\nint compare(string str1, string str2){\n\tif(str1.size() > str2.size()){\n\t\treturn 1;\n\t}else if(str1.size() < str2.size()){\n\t\treturn -1;\n\t}else if(str1 > str2){\n\t\treturn 1;\n\t}else if(str1 < str2){\n\t\treturn -1;\n\t}else if(str1 == str2){\n\t\treturn 0;\n\t}\n\treturn 0;\n}\n\nstring exist(int y, int x, int H, int W, string DP[100][100]){\n\tstring str;\n\tif(y < 0 || x < 0 || y >= H || x >= W){\n\t\tstr = \"\";\n\t}else{\n\t\tstr = DP[y][x];\n\t}\n\treturn str;\n}\n\nint main(){\n\t\n\tint W, H;\n\t\n\tstring DP[100][100];\n\t\n\tstring map[100];\n\t\n\tstring ans;\n\t\n\twhile(true){\n\t\tcin >> W >> H;\n\t\tif(W == 0 || H == 0){\n\t\t\tbreak;\n\t\t}\n\t\tfor(int i = 0; i < H; i++){\n\t\t\tcin >> map[i];\n\t\t}\n\t\t\n\t\tstring str;\n\t\t\n\t\tstring str1, str2;\n\t\t\n\t\tans = \"0\";\n\t\t\n\t\tfor(int x = 0; x < W; x++){\n\t\t\tfor(int y = 0; y < H; y++){\n\t\t\t\tif(map[y][x] <= '9' && map[y][x] >= '0'){\n\t\t\t\t\tstr = \"S\";\n\t\t\t\t\tstr[0] = map[y][x];\n\t\t\t\t\tstr1 = exist(y - 1, x, H, W, DP);\n\t\t\t\t\tstr2 = exist(y, x - 1, H, W, DP);\n\t\t\t\t\tif(compare(str1, str2) == 1){\n\t\t\t\t\t\tDP[y][x] = str1 + str;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tDP[y][x] = str2 + str;\n\t\t\t\t\t}\n\t\t\t\t\tif(DP[y][x].size() == 1 && DP[y][x][0] == '0'){\n\t\t\t\t\t\tDP[y][x] = \"\";\n\t\t\t\t\t}\n\t\t\t\t\tif(compare(DP[y][x], ans) == 1){\n\t\t\t\t\t\tans = DP[y][x];\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tDP[y][x] = \"\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t/*\n\t\tfor(int y = 0; y < H; y++){\n\t\t\tfor(int x = 0; x < W; x++){\n\t\t\t\tcout << DP[y][x] << \" \";\n\t\t\t}\n\t\t\tcout << endl;\n\t\t}\n\t\t*/\n\t\tcout << ans << endl;\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstring>\nusing namespace std;\n\nchar field[70][70];\nstring numberTable[70][70];\nint dy[] = {-1, 0}, dx[] = {0, -1};\n\nvoid clearLeftZero(string& str) {\n    while (str.empty() == false && str[0] == '0') {\n        str.erase(0, 1);\n    }\n}\n\nstring compare(const string str1, const string str2) {\n    if (str1.length() != str2.length()) {\n        return (str1.length() > str2.length()) ? str1 : str2;\n    }\n    if (str1 > str2) {\n        return str1;\n    }\n    return str2;\n}\n\nint main() {\n    while (true) {\n        int w, h;\n        cin >> w >> h;\n        if ((w | h) == 0) {\n            break;\n        }\n        memset(field, 0, sizeof(field));\n        for (int y = 0; y < h; y++) {\n            cin >> field[y];\n        }\n        string res;\n        for (int y = 0; y < h; y++) {\n            for (int x = 0; x < w; x++) {\n                numberTable[y][x].clear();\n                if ('0' <= field[y][x] && field[y][x] <= '9') {\n                    string num = string(1, field[y][x]);\n                    for (int i = 0; i < 2; i++) {\n                        int ny = y + dy[i], nx = x + dx[i];\n                        if (0 <= ny && 0 <= nx && numberTable[ny][nx].empty() == false) {\n                            num = compare(numberTable[ny][nx] + field[y][x], num);\n                        }\n                    }\n                    clearLeftZero(num);\n                    if (num.empty() == false) {\n                        numberTable[y][x] = num;\n                    }\n                }\n                if (numberTable[y][x].empty() == false) {\n                    res = compare(numberTable[y][x], res);\n                }\n            }\n        }\n        cout << res << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <set>\n\nusing namespace std;\n\nstring cmp(string s1, string s2, int n) {\n    if (s1.length() > s2.length()) {\n        return s1;\n    } else if (s1.length() < s2.length()) {\n        return s2;\n    } else {\n        if (s1 > s2) {\n            return s1;\n        } else {\n            return s2;\n        }\n    }\n\n    return \"\";\n}\n\nstring forout(string s1, string s2, int n) {\n    if (s1[0] == '0')\n        return forout(s1.substr(1), s2, n);\n    if (s2[0] == '0')\n        return forout(s1, s2.substr(1), n);\n    return cmp(s1, s2, n);\n}\n\nint main() {\n    int w, h;\n    while (cin >> w >> h, w|h) {\n        vector<string> v;\n        for (int i = 0; i < h; i++) {\n            string s;\n            cin >> s;\n            v.push_back(s);\n        }\n        string codes[70][70];\n        fill_n((string *)codes, 70*70, \"\");\n        for (int i = w-1; i >= 0; i--) {\n            for (int j = h-1; j >= 0; j--) {\n                if (v[j][i] >= '0' && v[j][i] <= '9') {\n                    codes[j][i] = cmp(v[j][i]+codes[j+1][i], v[j][i]+codes[j][i+1], w);\n                }\n            }\n        }\n\n        string out = \"\";\n        for (int i = 0; i < w; i++) {\n            for (int j = 0; j < h; j++) {\n                out = forout(out, codes[j][i], w);\n            }\n        }\n        cout << out << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<map>\n#include<set>\n#include<list>\n#include<cmath>\n#include<queue>\n#include<stack>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<complex>\n#include<cstdlib>\n#include<cstring>\n#include<climits>\n#include<numeric>\n#include<sstream>\n#include<iostream>\n#include<algorithm>\n#include<functional>\n#include<cctype>\n\n#define mp make_pair\n#define pb push_back\n#define REP(i,a,n) for(int i = a;i < (n);i++)\n#define rep(i,n) for(int i = 0;i < (n);i++)\n#define all(s) s.begin(), s.end()\n#define rall(s) s.rbegin(), s.rend()\n#define range(x,min,max) ((min) <= (x) && (x) <= (max)) \n\nusing namespace std;\n\ntypedef long long LL;\ntypedef vector<int> VI;\ntypedef vector<vector<int> > VII;\ntypedef pair<int,int> PII;\n\nconst int DX[]={1,0,-1,0},DY[]={0,-1,0,1};\n\nstring dp[70][70];\n\nint main(){\n\tcin.tie(0);\n   \tios::sync_with_stdio(false);\n\tint W, H;\n\tvector<string> C;\n\twhile(1){\n\t\tC.clear();\n\t\tcin >> W >> H;\n\t\tif(W == 0 && H  == 0) break;\n\t\trep(i,H){\n\t\t\tstring a;\n\t\t\tcin >> a;\n\t\t\trep(j, a.size()){\n\t\t\t\tdp[i][j] = \"\";\n\t\t\t}\n\t\t\tC.pb(a);\n\t\t}\n\t\trep(i, H){\n\t\t\trep(j, W){\n\t\t\t\tif(!isdigit(C[i][j])) continue;\n\t\t\t\tstring s1(1, C[i][j]), s2(1, C[i][j]);\n\t\t\t\tif(i != 0) s1 = dp[i - 1][j] + s1;\n\t\t\t\tif(j != 0) s2 = dp[i][j - 1] + s2;\n\t\t\t\tif(s1 == \"0\") s1 = \"\";\n\t\t\t\tif(s2 == \"0\") s2 = \"\";\n\t\t\t\tif(s1.size() == s2.size()){\n\t\t\t\t\tdp[i][j] = max(s1, s2);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tdp[i][j] = (s1.size() > s2.size())? s1 : s2;\n\t\t\t\t}\n\t\t\t}\t\n\t\t}\n\n\t\tstring ans = \"\";\n\t\trep(i,H){\n\t\t\trep(j,W){\n\t\t\t\tif(ans.size() == dp[i][j].size()){\n\t\t\t\t\tans = max(ans, dp[i][j]);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tans = (ans.size() > dp[i][j].size())? ans : dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#include<cctype>\n#include<math.h>\n#include<string>\n#include<string.h>\n#include<stack>\n#include<queue>\n#include<vector>\n#include<utility>\n#include<set>\n#include<map>\n#include<stdlib.h>\n#include<iomanip>\n\nusing namespace std;\n\n#define ll long long\n#define ld long double\n#define EPS 0.0000000001\n#define INF 1e9\n#define MOD 1000000007\n#define rep(i,n) for(i=0;i<(n);i++)\n#define loop(i,a,n) for(i=a;i<(n);i++)\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\n\nstring large(string s, string t){\n    string ss = \"\", tt = \"\";\n    int i = 0;\n    while(i<s.size() && s[i]=='0')i++;\n    while(i<s.size()){\n        ss += s[i];\n        i++;\n    }\n    i = 0;\n    while(i<t.size() && t[i]=='0')i++;\n    while(i<t.size()){\n        tt += t[i];\n        i++;\n    }\n    if(ss<tt)return tt;\n    else return ss;\n}\n\nint main(void) {\n    int i,j;\n    int h, w;\n    while(cin >> w >> h, h+w){\n        vs s(h);\n        rep(i,h) cin >> s[i];\n        vector<vs> dp(h+1,vs(w+1));\n        rep(i,h)rep(j,w)if(s[i][j]>='0' && s[i][j]<='9'){\n            dp[i+1][j] = large(dp[i+1][j], dp[i][j]+s[i][j]);\n            dp[i][j+1] = large(dp[i][j+1], dp[i][j]+s[i][j]);\n        }\n        string ans=\"\";\n        rep(i,h+1)rep(j,w+1)ans = large(ans, dp[i][j]);\n        cout << ans << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nconst int dx[] = {1, 0};\nconst int dy[] = {0, 1};\n\nvector<string> board(80);\nstring memo[80][80];\nint W, H;\n\ninline bool isDigit(int x, int y)\n{\n    if ('0' <= board[y][x] && board[y][x] <= '9')\n        return true;\n    else\n        return false;\n}\n\nstring Rec(int x, int y)\n{\n    if (memo[y][x].size() != 0)\n        return memo[y][x];\n\n    string s, tmp;\n    for (int d = 0; d < 2; ++d) {\n        int nx = x + dx[d];\n        int ny = y + dy[d];\n\n        if (nx < 0 || nx >= W || ny < 0 || ny >= H || !isDigit(nx, ny))\n            continue;\n\n        tmp = Rec(nx, ny);\n        if (tmp.size() > s.size() || (tmp.size() == s.size() && tmp > s))\n            s = tmp;\n    }\n\n    return memo[y][x] = board[y][x] + s;\n}\n\nint main()\n{\n    while (cin >> W >> H, W || H) {\n        // Input\n        for (int i = 0; i < H; ++i)\n            cin >> board[i];\n\n        // Init\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                memo[i][j] = \"\";\n\n        // Solve\n        string tmp, ans;\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                if (isDigit(j, i)) {\n                    tmp = Rec(j, i);\n                    int index = 0;\n                    while (tmp[index] == '0')\n                        index++;\n                    tmp = tmp.substr(index);\n\n                    if (tmp.size() > ans.size() || (tmp.size() == ans.size() && tmp > ans))\n                        ans = tmp;\n                }\n\n        // Output\n        cout << ans << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nvector<int> tsn(vector<int> &nmax, vector<int> &d){\n\tif(nmax.size() > d.size()) return nmax;\n\telse if(nmax.size() < d.size()) return d;\n\tfor(int i = 0; i < nmax.size(); ++i){\n\t\tif(nmax[i] > d[i]) return nmax;\n\t\telse if(nmax[i] < d[i]) return d;\n\t}\n\treturn d;\n}\n\nvector<int> dfs(int y,int x,vector<int> d,vector<vector<int> > &m){\n\tif(m[y][x] == -1)return d;\n\td.push_back(m[y][x]);\n\tm[y][x] = -1;\n\tvector<int> ny = dfs(y+1,x,d,m);\n\tvector<int> nx = dfs(y,x+1,d,m);\n\td = tsn( ny, nx);\n\treturn d;\n}\n\nint main(){\n\twhile(true){\n\t\tint h,w; cin >> w >> h;\n\t\tif(h == 0) break;\n\t\tvector<vector<int> > m(h+2,vector<int>(w+2,-1));\n\t\tfor(int i = 1; i <= h; ++i){ for(int j = 1; j <= w; ++j){\n\t\t\tchar c; cin >> c;\n\t\t\tif(c <= '9' && c >= '0'){\n\t\t\t\tm[i][j] = c - '0';\n\t\t\t}\n\t\t}  }\n\t\tvector<vector<int> > num;\n\t\tint index = 0;\n\t\tvector<int> ans;\n\t\tfor(int i = 1; i <= h; ++i) for(int j = 1; j <= w; ++j){\n\t\t\tif(m[i][j] != -1){\n\t\t\t\tvector<int> d;\n\t\t\t\td = dfs(i,j,d,m);\n\t\t\t\tnum.push_back(d);\n\t\t\t\tans = tsn(ans,d);\n\t\t\t}\n\t\t}\n\t\tbool flag = true;\n\t\tfor(int i = 0; i < ans.size(); ++i){\n\t\t\tif(flag){\n\t\t\t\tif(ans[i] == 0)continue;\n\t\t\t\telse flag = false;\n\t\t\t}\n\t\t\tcout << ans[i];\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define all(c) (c).begin(),(c).end()\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;i--)\n#define REP(i,m,n) for(int i=(int)(m);i<(int)(n);i++)\n#define rep(i,n) REP(i,0,n)\n#define iter(c) __typeof((c).begin())\n#define tr(it,c) for(iter(c) it=(c).begin();it!=(c).end();it++)\n#define pb(a) push_back(a)\n#define pr(a) cout<<(a)<<endl\n#define PR(a,b) cout<<(a)<<\" \"<<(b)<<endl\n#define R cin>>\n#define F first\n#define S second\n#define ll long long\nbool check(int n,int m,int x,int y){return x>=0&&x<n&&y>=0&&y<m;}\nconst ll MAX=1000000007,MAXL=1LL<<60,dx[4]={-1,0,1,0},dy[4]={0,1,0,-1};\ntypedef pair<int,int> P;\n\nint main() {\n  int n,m;\n  while(cin >> m >> n && n) {\n    string s[n];\n    rep(i,n) R s[i];\n    string d[n][m];\n    string ans=\"\";\n    rep(i,n)rep(j,m){\n      d[i][j]=\"\";\n      if(s[i][j]=='0') ans=\"0\";\n    }\n    rep(sx,n){\n      rep(sy,m){\n\tif(isdigit(s[sx][sy]) && s[sx][sy]!='0' && d[sx][sy]==\"\") {\n\t  queue<P> que;\n\t  que.push(P(sx,sy));\n\t  d[sx][sy]=s[sx][sy];\n\t  while(!que.empty()) {\n\t    P p=que.front();que.pop();\n\t    int nx=p.F,ny=p.S;\n\t    if(ans.size()<d[nx][ny].size()) ans=d[nx][ny];\n\t    else if(ans.size()==d[nx][ny].size()) ans=max(ans,d[nx][ny]);\n\t    REP(i,1,3) {\n\t      int x=nx+dx[i],y=ny+dy[i];\n\t      if(check(n,m,x,y) && isdigit(s[x][y])) {\n\t\tif(d[x][y].size()>d[nx][ny].size()+1) continue;\n\t\tif(d[x][y].size()==d[nx][ny].size()+1) {\n\t\t  if(d[x][y]>=d[nx][ny]+s[x][y]) continue;\n\t\t}\n\t\td[x][y]=d[nx][ny]+s[x][y];\n\t\tque.push(P(x,y));\n\t      }\n\t    }\n\t  }\n\t}\n      }\n    }\n    pr(ans);\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\nconst int dx[] = {1, 0};\nconst int dy[] = {0, 1};\n\nvector<string> board(70);\nint W, H;\nint len;\nstring ans;\nint cnt;\n\ninline bool isDigit(int x, int y)\n{\n    if ('0' <= board[y][x] && board[y][x] <= '9')\n        return true;\n    else\n        return false;\n}\n\nvoid Rec(int x, int y, string s)\n{\n    s += board[y][x];\n    bool branch = false;\n    for (int d = 0; d < 2; ++d) {\n        int nx = x + dx[d];\n        int ny = y + dy[d];\n\n        if (nx < 0 || nx >= W || ny < 0 || ny >= H || !isDigit(nx, ny))\n            continue;\n        if ((W - nx - 1) * (H - ny - 1) + s.size() + 3 < len)\n            continue;\n        branch = true;\n        Rec(nx, ny, s);\n    }\n\n    if (!branch && s.size() > len || (s.size() == len && s > ans)) {\n        ans = s;\n        len = s.size();\n    }\n}\n\nint main()\n{\n    while (cin >> W >> H, W || H) {\n        len = 0;\n\n        for (int i = 0; i < H; ++i)\n            cin >> board[i];\n\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                if (isDigit(j, i))\n                    Rec(j, i, \"\");\n        int index = 0;\n        while (ans[index] == '0')\n            index++;\n        cout << ans.substr(index) << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <unordered_map>\n#include <map>\n#include <set>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <functional>\n#include <bitset>\n#include <assert.h>\nusing namespace std;\ntypedef long long ll;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<char> vc;\ntypedef vector<string> vs;\ntypedef vector<bool> vb;\ntypedef vector<double> vd;\ntypedef pair<ll,ll> P;\ntypedef vector<P> vpl;\ntypedef tuple<ll,ll,ll> tapu;\n#define rep(i,n) for(ll i=0; i<(n); i++)\n#define REP(i,a,b) for(int i=(a); i<(b); i++)\n#define all(x) (x).begin(), (x).end()\n#define rall(x) (x).rbegin(), (x).rend()\nconst int inf = 1<<30;\nconst ll linf = 1LL<<62;\nconst int MAX = 510000;\nll dy[8] = {1,-1,0,0,1,-1,1,-1};\nll dx[8] = {0,0,1,-1,1,-1,-1,1};\nconst double pi = acos(-1);\nconst double eps = 1e-7;\ntemplate<typename T1,typename T2> inline bool chmin(T1 &a,T2 b){\n\tif(a>b){\n\t\ta = b; return true;\n\t}\n\telse return false;\n}\ntemplate<typename T1,typename T2> inline bool chmax(T1 &a,T2 b){\n\tif(a<b){\n\t\ta = b; return true;\n\t}\n\telse return false;\n}\ntemplate<typename T> inline void print(T &a){\n    rep(i,a.size()) cout << a[i] << \" \";\n    cout << \"\\n\";\n}\ntemplate<typename T1,typename T2> inline void print2(T1 a, T2 b){cout << a << \" \" << b << \"\\n\";}\ntemplate<typename T1,typename T2,typename T3> inline void print3(T1 a, T2 b, T3 c){\n\tcout << a << \" \" << b << \" \" << c << \"\\n\";\n}\nconst int mod = 1e9 + 7;\n//const int mod = 998244353;\n\nint main(){\n    while(1){\n        ll w,h; cin >> w >> h;\n        if(w+h == 0) break;\n        vs s(h);\n        rep(i,h) cin >> s[i];\n        vector<vs> dp(h,vs(w,\"\"));\n        rep(i,h){\n            rep(j,w){\n                if('A'<=s[i][j] && s[i][j]<='Z') continue;\n                if(j>0){\n                    if(dp[i][j].size() < dp[i][j-1].size()) dp[i][j] = dp[i][j-1];\n                    else if(dp[i][j].size()==dp[i][j-1].size()){\n                        chmax(dp[i][j], dp[i][j-1]);\n                    }\n                }\n                if(i>0){\n                    if(dp[i][j].size() < dp[i-1][j].size()) dp[i][j] = dp[i-1][j];\n                    else if(dp[i][j].size()==dp[i-1][j].size()){\n                        chmax(dp[i][j], dp[i-1][j]);\n                    }\n                }\n                if(dp[i][j]==\"\" && s[i][j]=='0') continue;\n                dp[i][j].push_back(s[i][j]);\n            }\n        }\n        string ans = \"\";\n        rep(i,h) rep(j,w){\n            if(ans.size() < dp[i][j].size()) ans = dp[i][j];\n            else if(ans.size() == dp[i][j].size()) chmax(ans, dp[i][j]);\n        }\n        cout << ans << \"\\n\";\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "\n//http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#include<iostream>\n#include<map>\n#include<vector>\n#include<algorithm>\n#include<cmath>\n#include<climits>\n#include<ctime>\n#include<cstring>\n#include<numeric>\n\n#define ALL(v) (v).begin(),(v).end()\n#define REP(i,p,n) for(int i=p;i<(int)(n);++i)\n#define rep(i,n) REP(i,0,n)\n#define dump(a) (cerr << #a << \"=\" << (a) << endl)\n#define DUMP(list) cout << \"{ \"; for(auto nth : list){ cout << nth << \" \"; } cout << \"}\" << endl;\n\nusing namespace std;\n\ntypedef unsigned long long ull;\n\nint W,H;\nchar matrix[70][70];\nint dw[2] = {0, 1};\nint dh[2] = {1, 0};\null ans;\n\nvoid dfs(int w, int h, vector<char> list)\n{\n\tif(w < 0 || w >= W || h < 0 || h >= H){ return; }\n\tif(!isdigit(matrix[h][w])){ return; }\n\n\tlist.push_back(matrix[h][w]);\n\tmatrix[h][w] = '#';\n\n\trep(i,2){\n\t\tdfs(w+dw[i], h+dh[i], list);\n\t}\n\n\tstring digit(ALL(list));\n\tull num = stoull(digit);\n\t\n\tans = max(ans, num);\n\n\treturn;\n}\n\nint main()\n{\n\twhile(cin >> W >> H && W)\n\t{\n\n\t\trep(h,H){\n\t\t\trep(w,W){\n\t\t\t\tcin >> matrix[h][w];\n\t\t\t}\n\t\t}\n\n\t\tans=0;\n\t\tvector<char> list;\n\t\trep(h,H){\n\t\t\trep(w,W){\n\t\t\t\tdfs(w,h,list);\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<algorithm>\t\n#include<map>\n#include<set>\n#include<utility>\n#include<cmath>\n#include<cstring>\n#include<queue>\n#include<cstdio>\n#include<sstream>\n#include<iomanip>\n#define loop(i,a,b) for(int i=a;i<b;i++) \n#define rep(i,a) loop(i,0,a)\n#define pb push_back\n#define mp make_pair\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\nusing namespace std;\n//kaewasuretyuui\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<pii> vp;\ntypedef vector<vp> vvp;\ntypedef pair<int,pii> pip;\ntypedef vector<pip>vip\t;\nconst double PI=acos(-1);\nconst double EPS=1e-8;\nconst int inf=1e8;\nstring f(string a,string b){\n\tif(a.size()==b.size()){\n\t\treturn a>b?a:b;\n\t}else return a.size()>b.size()?a:b;\n}\nint main(){\n\tint n,m;\n\twhile(cin>>m>>n,n+m){\n\t\tvector<string>in(n+1);\n\t\trep(i,m)in[0]+=\"A\";\n\t\trep(i,n)cin>>in[i+1];\n\t\trep(i,n+1)in[i]=\"A\"+in[i];\n\t\tstring dp[100][100]={\"\"};\n\t\tloop(i,1,n+1)loop(j,1,m+1)if(isdigit(in[i][j])){\n\t\t\tstring s=\"\";\n\t\t\tif(dp[i-1][j]!=\"\"){\n\t\t\t\ts=dp[i-1][j];\n\t\t\t}\n\t\t\tif(dp[i][j-1]!=\"\"){\n\t\t\t\ts=f(s,dp[i][j-1]);\n\t\t\t}\n\t\t\ts+=in[i][j];\n\t\t\tif(s==\"0\")s=\"\";\n\t\t\tdp[i][j]=s;\n\t\t}\n\t\tstring out=\"\";\n\t\trep(i,n)rep(j,m)out=f(out,dp[i+1][j+1]);\n\t\tcout<<out<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nstring fillzero(string);\n\nint main() {\n  int h, w;\n  while(cin >> w >> h, w || h) {\n    vector<vector<char> > field(h + 2, vector<char>(w + 2, 'x'));\n    for(int y = 0; y < h; ++y) for(int x = 0; x < w; ++x) {\n      char c;\n      cin >> c;\n      field[y + 1][x + 1] = ((0 <= c - '0' && c - '0' <= 9) ? c : 'x');\n    }\n    // for(int y = 0; y < h + 2; ++y, cout << endl) for(int x = 0; x < w + 2; ++x) cout << field[y][x];\n    vector<string> codes;\n    set<pair<int, int> > looked;\n    function<void(string, int, int)> putupCodes = [&](string num, int y, int x) {\n      looked.insert(make_pair(y, x));\n      num += field[y + 1][x + 1];\n      if(field[y + 2][x + 1] != 'x') putupCodes(num, y + 1, x);\n      if(field[y + 1][x + 2] != 'x') putupCodes(num, y, x + 1);\n      if(field[y + 2][x + 1] == 'x' && field[y + 1][x + 2] == 'x') codes.push_back(num);\n    };\n    for(int y = 0; y < h; ++y) for(int x = 0; x < w; ++x) {\n      if(field[y + 1][x + 1] != 'x' && field[y + 1][x + 1] != '0' && looked.count(make_pair(y, x)) == 0) putupCodes(\"\", y, x);\n    }\n    // for(auto&& code : codes) cout << code << endl;\n    sort(begin(codes), end(codes), [](const string &left, const string &right) {\n      return fillzero(left) > fillzero(right);\n    });\n    cout << codes[0] << endl;\n  }\n  return 0;\n}\n\nstring fillzero(string str) {\n  stringstream ss;\n  ss << setw(70) << setfill('0') << str;\n  return ss.str();\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <queue>\n#include <utility>\n#include <string>\nusing namespace std;\n#define REP(i,n) for(int i=0;i<(n);i++)\nconst int dx[2] = {1,0};\nconst int dy[2] = {0,1};\n\nstruct state{int x,y,ct;};\n\nstring judge_length(string s1, string s2){\n\tif(s1.size() > s2.size()){\n\t\treturn s1;\n\t}else if(s1.size() < s2.size()){\n\t\treturn s2;\n\t}else{\n\t\tREP(i,s1.size()){\n\t\t\tif(s1[i] > s2[i])return s1;\n\t\t\telse if(s1[i] < s2[i])return s2;\n\t\t}\n\t}\n\treturn s1;\n}\n\nint main(){\n\tint w,h;\n\twhile(cin >> w >> h,w){\n\t\tvector<vector<char> > mp(h+1,vector<char>(w+1));\n\t\tstring s;\n\t\tREP(i,h){\n\t\t\tcin >> s;\n\t\t\tREP(j,w){\n\t\t\t\tif(s[j] - '0' > 9){\n\t\t\t\t\tmp[i+1][j+1] = -1;\n\t\t\t\t}else{\n\t\t\t\t\tmp[i+1][j+1] = s[j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvector<vector<string>> dp(h+1,vector<string>(w+1));\n\t\tstring max_num;\n\t\tfor(int i = 1;i<h+1;i++){//dp\n\t\t\tfor(int j = 1;j<w+1;j++){\n\t\t\t\tif(mp[i][j] < 0)continue;\n\t\t\t\tdp[i][j] = judge_length(dp[i-1][j],dp[i][j-1]) + mp[i][j];\n\t\t\t\tif(dp[i][j][0] == '0')dp[i][j].erase(dp[i][j].begin());\n\t\t\t\tmax_num = judge_length(max_num,dp[i][j]);\n\t\t\t}\n\t\t}\n\tcout << max_num << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n\n\nusing namespace std;\n\nint const N = 100;\nchar table[N][N] = {};\nbool vd[N][N] = {};\n\nvoid clear() {\n    for( int i=0; i<N; ++i ) {\n        for( int j=0; j<N; ++j ) {\n            table[i][j] = 0;\n            vd[i][j] = false;\n        }\n    }\n}\n\nint const dir[][2] = {{1,0}, {0, 1}};\nvoid find( vector<string>& ss, string& s, int const x, int const y, int const w, int const h )\n{\n    s += table[x][y];\n    vd[x][y] = true;\n\n    for( int i=0; i<2; ++i ) {\n        int const nx = x + dir[i][0];\n        int const ny = y + dir[i][1];\n        if ( nx < 0 || ny < 0 || nx >= w || ny >= h )\n            continue;\n        \n        if ( table[nx][ny] >= '0' && table[nx][ny] <= '9' ) {\n//            string copied = s;\n            find( ss, s, nx, ny, w, h );\n        }\n    }\n\n    ss.push_back( s );\n    s.erase( s.end() - 1 );\n}\n\ntemplate<typename T>\nstruct bun\n{\n    bool operator()( T const& l, T const& r ) {\n        return l.size() > r.size() || (l.size() == r.size() && l > r);\n    }\n};\n\nint main()\n{\n    for(;;) {\n        int w, h;\n        cin >> w >> h;\n        if ( w == 0 && h == 0 )\n            break;\n\n        clear();\n        cin.ignore(255, '\\n');\n        for( int y=0; y<h; ++y ) {\n            string s;\n            getline( cin, s );\n            for( int x=0; x<w; ++x ) {\n                table[x][y] = s[x];\n            }\n        }\n\n        vector<string> ss;\n        string s;\n        for( int x=0; x<w; ++x ) {\n            for( int y=0; y<h; ++y ) {\n                if ( table[x][y] >= '1' && table[x][y] <= '9' && !vd[x][y] ) {\n                    find( ss, s, x, y, w, h );\n                }\n            }\n        }\n        stable_sort( ss.begin(), ss.end(), bun<string>() );\n\n        //for( int i=0; i<ss.size(); ++i )\n            //cout << ss[i] << endl;\n        //    ;\n\n        \n        cout << ( ss.empty() ? \"\" : ss.front() ) << endl;\n        //cout << \"======\" << endl;\n    };\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\nusing namespace std;\n\nstring solve(vector<string> &C, int W, int H, int i, int j, string ret){\n  string s[2];\n  ret += C[i][j];\n  for(int k = 1; k < 3; ++k){\n    if(i+k/2 < H && j+k%2 < W && C[i+k/2][j+k%2] <= '9' && C[i+k/2][j+k%2] >= '0'){\n      s[k-1] = solve(C,W,H,i+k/2,j+k%2,\"\");\n    }\n  }\n  if(s[0].size() == s[1].size()){\n    ret += max(s[0],s[1]);\n  }else{\n    if(s[0].size() > s[1].size()) ret += s[0];\n    else ret += s[1];\n  }\n  return ret;\n}\n\nint main(){\n  int W, H;\n  while(cin >> W >> H, W){\n    vector<string> C(H);\n    for(int i = 0; i < H; ++i)\n      cin >> C[i];\n    string ans;\n    for(int i = 0; i < H; ++i){\n      for(int j = 0; j < W; ++j){\n\tif(C[i][j] > '9' || C[i][j] <= '0' ||\n\t  (i > 0 && C[i-1][j] > '0' && C[i-1][j] <= '9') ||\n\t  (j > 0 && C[i][j-1] > '0' && C[i][j-1] <= '9'))\n\t  continue;\n\telse{\n\t  string t = solve(C,W,H,i,j,\"\");\n\t  if(ans.size() == t.size()) ans = max(ans, t);\n\t  else if(ans.size() < t.size()) ans = t;\n\t}\n      }\n    }\n    if(ans == \"\") cout << 0 << endl;\n    else cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cstdlib>\n#include<typeinfo>\n#include<set>\n#include<map>\n#include<vector>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<numeric>\n#include<cassert>\n#include<random>\nusing namespace std;\n\nbool num(char c){\n    if(c<'0' || c>'9'){return false;}\n    return true;\n}\n\nstring max(string a,string b){\n    int as=(int)a.size();\n    int bs=(int)b.size();\n    for(int i=0;a[i]=='0';i++){as--;}\n    for(int i=0;b[i]=='0';i++){bs--;}\n    if(as>bs){return a;}\n    if(bs>as){return b;}\n    for(int i=0;i<as;i++){\n        if(a[a.size()-as+i]>b[b.size()-bs+i]){return a;}\n        if(a[a.size()-as+i]<b[b.size()-bs+i]){return b;}\n    }\n    return a;\n}\n\nstring pls(char c,string s){\n    s.push_back(1);\n    for(int i=(int)s.size()-2;i>=0;i--){\n        s[i+1]=s[i];\n    }\n    s[0]=c;\n    return s;\n}\n\nint main(){\n    while(1){\n        \n        \n        \n    \n    char a[100][100]={};\n    int w,h;\n    cin>>w>>h;\n        if(w==0 && h==0){break;}\n    for(int i=0;i<h;i++){\n        for(int t=0;t<w;t++){\n            cin>>a[i][t];\n        }\n    }\n    string dp[100][100]={};\n    string ans;\n    for(int i=h-1;i>=0;i--){\n        for(int t=w-1;t>=0;t--){\n            if(num(a[i][t])){\n                dp[i][t]=pls(a[i][t],max(dp[i+1][t],dp[i][t+1]));\n                ans=max(ans,dp[i][t]);\n            }\n        }\n    }\n        bool d=true;\n        for(int i=0;i<ans.size();i++){\n            if(d && ans[i]!='0'){cout<<ans[i]; d=false; continue;}\n            if(!d){cout<<ans[i];}\n        }\n        cout<<endl;\n    \n        \n        \n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//#include \"bits/stdc++.h\"\n\n#include <iostream>\n#include <array>\n// #include <map>\n#include <string>\n// #include <algorithm>\n// #include <numeric>\n// #include <limits>\n\nusing namespace std;\n\nint w; // j\nint h; // i\nstring max_s(72, ' ');\narray<array<char, 72>, 72> field; // [i][j]\narray<char, 72> num;\nstring str(72, ' ');\n\nstring big(const string& a, const string& b) {\n\tif (a.size() == b.size()) {\n\t\tif (a > b) {\n\t\t\treturn a;\n\t\t} else {\n\t\t\treturn b;\n\t\t}\n\t}\n\tif (a.size() > b.size()) {\n\t\treturn a;\n\t} else {\n\t\treturn b;\n\t}\n}\n\nvoid check(int d) {\n\tint padding = 0;\n\tfor (int k = 0; k < d; k++) {\n\t\tif (num[k] == '0') {\n\t\t\tpadding++;\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t}\n\tint s = d - padding; // as size\n\tstr.resize(s);\n\tfor (int k = 0; k < s; k++) {\n\t\tstr[k] = num[k + padding];\n\t}\n\tmax_s = big(max_s, str);\n}\n\nvoid _trace(int i, int j, int d /* depth */) {\n\tnum[d] = field[i][j];\n\td++;\n\tint new_i = i + 1;\n\tint new_j = j + 1;\n\tbool flg_end = true;\n\tif (new_i < h and isdigit(field[new_i][j])) {\n\t\t_trace(new_i, j, d);\n\t\tflg_end = false;\n\t}\n\tif (new_j < w and isdigit(field[i][new_j])) {\n\t\t_trace(i, new_j, d);\n\t\tflg_end = false;\n\t}\n\tif (flg_end) {\n\t\tcheck(d);\n\t}\n}\n\nvoid trace(int i, int j) {\n\tif (i > 0 and isdigit(field[i - 1][j])) {\n\t\treturn;\n\t}\n\tif (j > 0 and isdigit(field[i][j - 1])) {\n\t\treturn;\n\t}\n\t_trace(i, j, 0);\n}\n\nvoid solve() {\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\tcin >> field[i][j];\n\t\t}\n\t}\n\tmax_s = \"\";\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\ttrace(i, j);\n\t\t}\n\t}\n\tcout << max_s << endl;\n}\n\nint main() {\n\n\twhile (true) {\n\t\tcin >> w >> h;\n\t\tif (w == 0 and h == 0) {\n\t\t\tbreak;\n\t\t}\n\t\tsolve();\n\t}\n\n\t//std::cout << \"\\e[38;5;0m\\e[48;5;40m --- end ---  \\e[m\" << std::endl; // debug\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <numeric>\n#include <iomanip>\n\n#define REP(i,n) for(i=0; i < (n); i++)\n#define REPONE(i, n) for(i=1; i <= (n); i++)\n#define LOOP(n) for(int loopCount=1; loopCount <= (n); loopCount++)\n#define ITER(c) __typeof((c).begin())\n#define EACH(c,it) for(ITER(c) it =(c).begin(); it!=(c).end(); it++)\n#define SZ(c) ((int) (c).size())\n#define ALL(c) c.begin(), c.end()\n#define SUM(c) accumulate(ALL(c), 0)\n#define EXIST(c,v) (find(ALL(c), (v)) != (c).end())\n#define PB push_back\n#define MP make_pair\n\nusing namespace std;\nstatic const double EPS = 1e-9;\nstatic const double PI = 3.141592653589793238462643383279;\ntypedef long long ll;\n\nchar num[72];\nbool touched[72][72];\nint n, w, h;\nchar board[72][72];\nstring ans;\n\nbool isDigit(char c){\n    return ('0'<=c && c<='9');\n}\n\n\nvoid dfs(int i, int j){\n    if(j<0 || j>=w || i<0 || i>=h || !isDigit(board[i][j])){\n        if(n>0){\n            num[n] = '\\0';\n            ans = max(ans, (string(73-n,'0') + string(num)));\n        }\n        return ;\n    }\n    if(n==0 && touched[i][j]) return ;\n    else touched[i][j] = true;\n    //printf(\"----%d %d\\n\",i,j);\n    num[n] = board[i][j];\n    n++;\n    dfs(i+1,j);\n    n--;\n    n++;\n    dfs(i,j+1);\n    n--;\n    return ;\n}\n\nint main(){\n    int i, j;\n    while(scanf(\"%d%d\\n\",&w,&h)){\n        if(!(w||h)) break;\n        n = 0;\n        REP(i,72)num[i]='\\0';\n        REP(i,h){\n            REP(j,w)scanf(\"%c\",&board[i][j]);\n            scanf(\"\\n\");\n        }\n        ans = \"0\";;\n        REP(i,h)REP(j,w) touched[i][j] = false;\n        REP(i,h)REP(j,w) dfs(i,j);\n        for(i=0;ans[i]=='0';i++);\n        ans = ans.substr(i);\n        printf(\"%s\\n\",ans.c_str());\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define FOR(i,a,b) for(int i= (a); i<((int)b); ++i)\n#define RFOR(i,a) for(int i=(a); i >= 0; --i)\n#define FOE(i,a) for(auto i : a)\n#define ALL(c) (c).begin(), (c).end()\n#define RALL(c) (c).rbegin(), (c).rend()\n#define DUMP(x)  cerr << #x << \" = \" << (x) << endl;\n#define SUM(x) std::accumulate(ALL(x), 0LL)\n#define MIN(v) *std::min_element(v.begin(), v.end())\n#define MAX(v) *std::max_element(v.begin(), v.end())\n#define EXIST(v,x) (std::find(v.begin(), v.end(), x) != v.end())\n#define BIT(n) (1LL<<(n))\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end());\n\ntypedef long long LL;\ntemplate<typename T> using V = std::vector<T>;\ntemplate<typename T> using VV = std::vector<std::vector<T>>;\ntemplate<typename T> using VVV = std::vector<std::vector<std::vector<T>>>;\n\ntemplate<class T> inline T ceil(T a, T b) { return (a + b - 1) / b; }\ntemplate<class T> inline void print(T x) { std::cout << x << std::endl; }\ntemplate<class T> inline void print_vec(const std::vector<T> &v) { for (int i = 0; i < v.size(); ++i) {  if (i != 0) {std::cout << \" \";} std::cout << v[i];} std::cout << \"\\n\"; }\ntemplate<class T> inline bool inside(T y, T x, T H, T W) {return 0 <= y and y < H and 0 <= x and x < W; }\ntemplate<class T> inline double euclidean_distance(T y1, T x1, T y2, T x2) { return sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2)); }\ntemplate<class T> inline double manhattan_distance(T y1, T x1, T y2, T x2) { return abs(x1 - x2) + abs(y1 - y2); }\n\nconst int INF = 1L << 30;\nconst double EPS = 1e-9;\nconst std::string YES = \"YES\", Yes = \"Yes\", NO = \"NO\", No = \"No\";\nconst std::vector<int> dy4 = { 0, 1, 0, -1 }, dx4 = { 1, 0, -1, 0 };    // 4近傍（右, 下, 左, 上）\nconst std::vector<int> dy8 = { 0, -1, 0, 1, 1, -1, -1, 1 }, dx8 = { 1, 0, -1, 0, 1, 1, -1, -1 };\n\nusing namespace std;\n\nstring lstrip(string s) {\n    string ans = \"\";\n    bool ok = false;\n    FOE(c, s) {\n        if (c != '0') {\n            ans += c;\n            ok = true;\n        }\n        else {\n            if (ok) {\n                ans += c;\n            }\n        }\n    }\n    return ans;\n}\n\nint main() {\n    cin.tie(0);\n\tios::sync_with_stdio(false);\n\n\twhile (true) {\n\t    int W, H;\n\t    cin >> W >> H;\n        if (W == 0 and H == 0) {\n            break;\n        }\n\n\t    vector<string> f(H);\n\t    FOR(i, 0, H) {\n\t        cin >> f[i];\n\t        FOR(j, 0, W) {\n\t            if ('A' <= f[i][j] and f[i][j] <= 'Z') {\n\t                f[i][j] = 'A';\n\t            }\n\t        }\n\t    }\n\n\t    vector<vector<string>> dp(H, vector<string>(W));\n        FOR(y, 0, H) {\n            FOR(x, 0, W) {\n                if (f[y][x] != 'A') {\n                    dp[y][x] = f[y][x];\n                }\n            }\n        }\n\n        FOR(y, 0, H) {\n            FOR(x, 0, W) {\n                if (f[y][x] == 'A') {\n                    continue;\n                }\n                // down\n                if (y + 1 < H and f[y + 1][x] != 'A') {\n                    string a = dp[y][x] + f[y + 1][x];\n                    string b = dp[y + 1][x];\n                    a = lstrip(a);\n                    b = lstrip(b);\n\n                    if (a.size() == b.size()) {\n                        dp[y + 1][x] = max(a, b);\n                    }\n                    else {\n                        if (a.size() > b.size()) {\n                            dp[y + 1][x] = a;\n                        }\n                    }\n                }\n\n                // left\n                if (x + 1 < W and f[y][x + 1] != 'A') {\n                    string a = dp[y][x] + f[y][x + 1];\n                    string b = dp[y][x + 1];\n                    a = lstrip(a);\n                    b = lstrip(b);\n\n                    if (a.size() == b.size()) {\n                        dp[y][x + 1] = max(a, b);\n                    }\n                    else {\n                        if (a.size() > b.size()) {\n                            dp[y][x + 1] = a;\n                        }\n                    }\n                }\n            }\n        }\n\n        string tmp = \"\";\n        FOR(y, 0, H) {\n            FOR(x, 0, W) {\n                string a = dp[y][x];\n                a = lstrip(a);\n                if (a.size() == tmp.size()) {\n                    tmp = max(a, tmp);\n                }\n                else {\n                    if (a.size() > tmp.size()) {\n                        tmp = a;\n                    }\n                }\n            }\n        }\n        if (tmp == \"\") {\n            print(0);\n        }\n        else {\n            print(tmp);\n        }\n\t}\n\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define mk make_pair\nusing namespace std;\nint dx[]={1,0},dy[]={0,1};\nint main(){\n  int w,h;\n  while(cin>>w>>h,w){\n    string s[h],t=\"\";\n    r(i,h)cin>>s[i];\n    r(i,h)r(j,w)if(s[i][j]>='1'&&s[i][j]<='9'){\n      bool b[h][w];\n      r(k,h)r(l,w)b[k][l]=0;\n      queue<pair<int,int> >q;\n      string ss[h][w];\n      q.push(mk(i,j));\n      while(!q.empty()){\n        pair<int,int>a=q.front();q.pop();\n        int x=a.second,y=a.first;\n        ss[y][x]+=s[y][x];\n        r(k,2){\n          int x1=x+dx[k],y1=y+dy[k];\n          if(x1<0||y1<0||x1>=w||y1>=h)continue;\n          if(s[y1][x1]>='0'&&s[y1][x1]<='9'){\n            if(b[y1][x1]){\n              if(ss[y1][x1]<ss[y][x]){\n                ss[y1][x1]=\"\";\n                ss[y1][x1]+=ss[y][x];\n              }\n            }\n            else {\n              ss[y1][x1]+=ss[y][x];\n              q.push(mk(y1,x1));\n              b[y1][x1]=1;\n            }\n          }\n        }\n      }string tt=\"\";\n      r(k,h)r(l,w)tt=max(tt,ss[k][l]);\n      if(t.size()<tt.size())if(t<tt)t=tt;\n    }\n    cout<<t<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nconst int dx[] = {1, 0};\nconst int dy[] = {0, 1};\n\nvector<string> board(80);\nstring memo[80][80];\nint W, H;\n\ninline bool isDigit(int x, int y)\n{\n    if ('0' <= board[y][x] && board[y][x] <= '9')\n        return true;\n    else\n        return false;\n}\n\nstring Rec(int x, int y)\n{\n    if (memo[y][x].size() != 0)\n        return memo[y][x];\n\n    string s, tmp;\n    for (int d = 0; d < 2; ++d) {\n        int nx = x + dx[d];\n        int ny = y + dy[d];\n\n        if (nx < 0 || nx >= W || ny < 0 || ny >= H || !isDigit(nx, ny))\n            continue;\n\n        tmp = Rec(nx, ny);\n        if (tmp.size() > s.size() || (tmp.size() == s.size() && tmp > s))\n            s = tmp;\n    }\n\n    return memo[y][x] = board[y][x] + s;\n}\n\nint main()\n{\n    while (cin >> W >> H, W || H) {\n        // Input\n        for (int i = 0; i < H; ++i)\n            cin >> board[i];\n\n        // Init\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                memo[i][j] = \"\";\n\n        // Solve\n        string tmp, ans;\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                if (isDigit(j, i)) {\n                    tmp = Rec(j, i);\n                    if (tmp.size() > ans.size() || (tmp.size() == ans.size() && tmp > ans))\n                        ans = tmp;\n                }\n\n        // Output\n        int index = 0;\n        while (ans[index] == '0')\n            index++;\n        cout << ans.substr(index) << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define DIGIT(c) (c >= '0' && c <= '9')\n#define F first\n#define S second\n#define INF 1 << 30\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nint W, H;\nvector<vector<string> >dp(70, vector<string>(70));\nchar c[70][71];\n\nstring judge(string a, string b){\n  if(a.size() > b.size()) return a;\n  if(a.size() < b.size()) return b;\n  return max(a, b);\n}\n\nint main(){\n  while(scanf(\"%d%d\", &W, &H) && W+H){\n    rep(i, H) scanf(\"%s\", c[i]);\n\n    rep(i, 70) rep(j, 70) dp[i][j] = \"\";\n    if(DIGIT(c[0][0])) dp[0][0] = c[0][0];\n    REP(i, 1, W) if(DIGIT(c[0][i])) dp[0][i] = dp[0][i-1] + c[0][i];\n    REP(i, 1, H) if(DIGIT(c[i][0])) dp[i][0] = dp[i-1][0] + c[i][0];\n\n    REP(i, 1, H){\n      REP(j, 1, W){\n\tif(!DIGIT(c[i][j])) continue;\n\tdp[i][j] = judge((dp[i-1][j]+c[i][j]), (dp[i][j-1]+c[i][j]));\n\t//\tcout << i << \" \" << j << \" \" << dp[i-1][j]+c[i][j] << \" \" << dp[i][j-1]+c[i][j] << endl;\n      }\n    }\n\n\n    /*    rep(i, H){\n      rep(j, W) cout << dp[i][j] << \" \";\n      puts(\"\");\n      }*/\n\n    string res = \"\";\n    rep(i, H) rep(j, W) res = judge(res, dp[i][j]);\n    if(res[0] == '0') res.erase(res.begin());\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n)for(int i=0;i<n;i++)\nusing namespace std;\ntypedef pair<int, int>P;\n\nchar c[80][80];\nstruct str {\n\tstring s;\n\tstr(string s = \"\") :s(s) {}\n}d[80][80];\nbool operator<(str a, str b) {\n\tif (a.s.size() == b.s.size())return a.s < b.s;\n\treturn a.s.size() < b.s.size();\n}\nint main() {\n\tint w, h;\n\twhile (scanf(\"%d%d\", &w, &h), w) {\n\t\trep(i, h)scanf(\"%s\", c[i]);\n\t\tstr Max = (string)\"0\";\n\t\trep(i, h)rep(j, w) {\n\t\t\tif ('0' <= c[i][j] && c[i][j] <= '9') {\n\t\t\t\td[i][j] = to_string(c[i][j] - '0');\n\t\t\t\tif (i)d[i][j] = max(d[i][j], str(d[i - 1][j].s + c[i][j]));\n\t\t\t\tif (j)d[i][j] = max(d[i][j], str(d[i][j - 1].s + c[i][j]));\n\t\t\t\tstr s = d[i][j];\n\t\t\t\twhile (!s.s.empty() && s.s.front() == '0')s = s.s.substr(1);\n\t\t\t\tMax = max(Max, s);\n\t\t\t}\n\t\t\telse d[i][j] = (string)\"\";\n\t\t}\n\t\tcout << Max.s << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define rep(i, n) for(int i=0; i<n; i++)\n\ninline string max(const string& a, const string& b)\n{\n  if(a == \"\") return b == \"0\" ? a : b;\n  if(b == \"\") return a == \"0\" ? b : a;\n  if(a.length() < b.length()) return b;\n  if(a.length() > b.length()) return a;\n  return a < b ? b : a;\n}\n\nint W, H;\nchar C[77][77];\nstring dp[77][77];\n\nint main(int argc, char *argv[])\n{\n\n  while(cin >> W >> H, W){\n    rep(i, H) rep(j, W) cin >> C[i][j];\n    rep(i, H) rep(j, W) dp[i][j] = \"\";\n    if(C[0][0] >= '0' && C[0][0] <= '9') dp[0][0] = C[0][0];\n    rep(i, H) rep(j, W) if(i || j){\n      if(C[i][j] >= '0' && C[i][j] <= '9'){\n        if(i) dp[i][j] = max(dp[i][j], string(dp[i - 1][j] + C[i][j]));\n        if(j) dp[i][j] = max(dp[i][j], string(dp[i][j - 1] + C[i][j]));\n      }\n    }\n    string res = \"\";\n    rep(i, H) rep(j, W) res = max(res, dp[i][j]);\n    cout << (res == \"\" ? \"0\" : res) << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nstring s[99];\nint w,h;\nbool used[99][99];\nstring dfs(int i,int j)\n{\n\tused[i][j]=1;\n\tstring t1(1,s[i][j]),t2(1,s[i][j]);\n\tif(i<h-1&&s[i+1][j]<='9')t1+=dfs(i+1,j);\n\tif(j<w-1&&s[i][j+1]<='9')t2+=dfs(i,j+1);\n\tif(t1.size()<t2.size())return t2;\n\telse if(t1.size()==t2.size()&&t1<t2)return t2;\n\telse return t1;\n}\nmain()\n{\n\twhile(cin>>w>>h,w)\n\t{\n\t\tfor(int i=0;i<h;i++)cin>>s[i];\nfor(int i=0;i<h;i++)for(int j=0;j<w;j++)used[i][j]=0;\n\t\tstring ans=\"\";\n\t\tfor(int i=0;i<h;i++)for(int j=0;j<w;j++)\n\t\t{\n\t\t\tif(used[i][j]||s[i][j]>'9'||s[i][j]=='0')continue;\n\t\t\tstring t=dfs(i,j);\n\t\t\tif(ans.size()<t.size())ans=t;\n\t\t\telse if(ans.size()==t.size()&&ans<t)ans=t;\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cassert>\n#include <cctype>\n#include <complex>\n#include <cstdio>\n#include <map>\n#include <math.h>\n#include <queue>\n#include <set>\n#include <stack>\n#include <string>\n#include <vector>\nusing namespace std;\n\n#define rep(i,n) for(int i=0;i<n;i++)\n\nint W,H;\nchar c[69][70];\nstring dp[69][69];\n\nint main(){\n\twhile(cin>>W>>H&&W){\n\t\trep(i,69)fill(dp[i],dp[i]+69,\"\");\n\t\trep(i,H)rep(j,W)cin>>c[i][j];\n\t\trep(i,H)rep(j,W)if(isdigit(c[i][j])){\n\t\t\tif(!i&&!j)dp[i][j]=c[i][j];\n\t\t\telse if(!i)dp[i][j]=dp[i][j-1]+c[i][j];\n\t\t\telse if(!j)dp[i][j]=dp[i-1][j]+c[i][j];\n\t\t\telse{\n\t\t\t\tstring l=dp[i][j-1],u=dp[i-1][j];\n\t\t\t\tif(l.size()>u.size())dp[i][j]=l+c[i][j];\n\t\t\t\telse if(l.size()<u.size())dp[i][j]=u+c[i][j];\n\t\t\t\telse{\n\t\t\t\t\tdp[i][j]=max(l,u)+c[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring ans=\"\";\n\t\trep(i,H)rep(j,W)if(dp[i][j].size()>ans.size()||dp[i][j].size()==ans.size()&&dp[i][j]>ans)ans=dp[i][j];\n\t\twhile(ans[0]=='0')ans=ans.substr(1);\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<cctype>\nusing namespace std;\n\n#define MAX 72\n#define INV (-1)\n\nstruct Dig{\n\tvector<char> s;\n\tvector< pair<int,int> > pos;\n\tvoid push( char c, int i, int j ){\n\t\ts.push_back( c );\n\t\tpos.push_back( make_pair(i,j) );\n\t}\n\tvoid pop(){\n\t\ts.pop_back();\n\t\tpos.pop_back();\n\t}\n\tvoid simplify(){\n\t\twhile( true ){\n\t\t\tif( s.size() == 1 )\n\t\t\t\tbreak;\n\t\t\tif( s[0] == '0' ){\n\t\t\t\ts.erase( s.begin() );\n\t\t\t}else\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tbool operator<(const Dig &t){\n\t\tif( s.size() < t.s.size() )\n\t\t\treturn true;\n\t\telse if( s.size() == t.s.size() ){\n\t\t\tfor(unsigned int i = 0; i < s.size(); ++i){\n\t\t\t\tif( s[i] < t.s[i] )\n\t\t\t\t\treturn true;\n\t\t\t\telse\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n};\n\nvector< Dig > vdigs;\n\nvoid dfs(char map[MAX][MAX], int i, int j, Dig &d){\n\tconst int di[] = {1,0};\n\tconst int dj[] = {0,1};\n\tif( !isdigit( map[i][j] ) )\n\t\treturn ;\n\tbool bCanGoNext = false;\n\tfor(int k=0;k<2;++k){\n\t\tif( isdigit(map[i + di[k]][j + dj[k]] ) ){\n\t\t\td.push( map[i][j], i, j );\n\t\t\tbCanGoNext = true;\n\t\t\tdfs( map, i + di[k], j + dj[k], d );\n\t\t\td.pop();\n\t\t}\n\t}\n\tif( !bCanGoNext ){\n\t\td.push( map[i][j], i , j );\n\t\tvdigs.push_back( d );\n\t\td.pop();\n\t}\n}\nvoid ResetMap(char map[MAX][MAX]){\n\tfor(int i = 0; i < MAX; ++i){\n\t\tfor( int j = 0; j < MAX; ++j){\n\t\t\tmap[i][j] = INV;\n\t\t}\n\t}\n}\ntemplate<typename _T>\nostream &operator << (ostream &os, const vector<_T> &v){\n\tfor(unsigned int i = 0; i < v.size(); ++i){\n\t\tos << v[i];\n\t}\n\treturn os;\n}\n\nint LCS(const Dig &a, const Dig &b){\n\tint ret = 0;\n\tint table[MAX][MAX] = {{0,},};\n\tfor(unsigned int i = 1; i <= a.pos.size(); ++i){\n\t\tfor(unsigned int j = 1; j <= b.pos.size(); ++j){\n\t\t\tif( a.pos[i-1] == b.pos[j-1] ){\n\t\t\t\ttable[i][j] = 1 + table[i-1][j-1];\n\t\t\t}else{\n\t\t\t\ttable[i][j] = max( table[i-1][j], table[i][j-1] );\n\t\t\t}\n\t\t\tret = max( ret, table[i][j] );\n\t\t}\n\t}\n\treturn ret;\n}\n\nint main(){\t\n\twhile(true){\n\t\tint max_lcs = 0;\n\t\tvector< vector<int> > lcs_table;\n\t\tint H,W;\n\t\tDig d;\n\t\tDig ans;\n\t\tchar map[MAX][MAX];\n\t\tvector< Dig > cands;\n\n\t\tcin >> W >> H;\n\t\t\n\t\tif( W == 0 && H == 0 ) break;\n\t\tvdigs.clear();\n\t\tResetMap( map );\n\t\tfor(int i = 1; i <= H; ++i){\n\t\t\tstring s;\n\t\t\tcin >> s;\n\t\t\tfor(int j = 1; j <= W; ++j){\n\t\t\t\tmap[i][j] = s[j-1];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 1; i <= H; ++i){\n\t\t\tfor(int j = 1; j <= W; ++j){\n\t\t\t\tdfs( map, i, j, d );\n\t\t\t}\n\t\t}\n\n\t\tfor(unsigned int i = 0; i < vdigs.size(); ++i){\n\t\t\tvdigs[i].simplify();\n\t\t}\n\n\t\tfor(unsigned int i = 0; i < vdigs.size(); ++i){\n\t\t\tvector<int> lcss;\n\t\t\tfor(unsigned int j = i + 1; j < vdigs.size(); ++j){\n\t\t\t\tint t = LCS( vdigs[i], vdigs[j] );\n\t\t\t\tlcss.push_back( t );\n\t\t\t\tmax_lcs = max( max_lcs, t );\n\t\t\t}\n\t\t\tlcs_table.push_back( lcss );\n\t\t}\n\t\t\n\t\tans.s.push_back('0');\n\t\tfor(unsigned int i = 0; i < vdigs.size(); ++i){\n\t\t\tfor(unsigned int j = i + 1; j < vdigs.size(); ++j){\n\t\t\t\tif( max_lcs == lcs_table[i][j - i - 1] ){\n\t\t\t\t\tif( vdigs[i] < vdigs[j] ){\n\t\t\t\t\t\tif( ans < vdigs[j] )\n\t\t\t\t\t\t\tans = vdigs[j];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif( ans < vdigs[i] )\n\t\t\t\t\t\t\tans = vdigs[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans.s << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing lint = long long;\ntemplate<class T = int> using V = vector<T>;\ntemplate<class T = int> using VV = V< V<T> >;\n\nbool comp(const string& l, const string& r) {\n  return make_pair(l.size(), l) < make_pair(r.size(), r);\n}\n\nint main() {\n  cin.tie(nullptr); ios::sync_with_stdio(false);\n  while (true) {\n    int w, h; cin >> w >> h;\n    if (!w) break;\n    V<string> s(h); for (auto&& e : s) cin >> e;\n    VV<string> dp(h + 1, V<string>(w + 1));\n    string res;\n    for (int i = h - 1; i >= 0; --i) for (int j = w - 1; j >= 0; --j) {\n      if (!isdigit(s[i][j])) continue;\n      dp[i][j] = max({dp[i][j], s[i][j] + dp[i][j + 1], s[i][j] + dp[i + 1][j]}, comp);\n      if (dp[i][j][0] != '0') {\n        res = max(res, dp[i][j], comp);\n      }\n    }\n    cout << res << '\\n';\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define debug(x) cout << \"debug \" << x << endl;\nconst int INF = 100000000;\nusing namespace std;\n\nconst int n = 75;\nchar m[n][n];\nstring memo[n][n];\nstring ans;\n\nstring big(string a, string b){\n    if(a.size() > b.size()){\n        return a;\n    }else if(a.size() < b.size()){\n        return b;\n    }else{\n        return a > b ? a : b;\n    }\n}\n\nstring dfs(int x, int y){\n    string ret;\n    if(memo[y][x] != \"\") return  memo[y][x];\n\n    if(not isdigit(m[y][x])) return ret;\n    else ret+=m[y][x];\n\n    return memo[y][x] = ret + big(dfs(x + 1, y), dfs(x, y + 1));\n}\n\nint main(){\n    int w, h;\n    while(cin >> w >> h, w||h){\n        ans = \"\";\n        rep(i,n) rep(j,n) memo[i][j] = \"\";\n        rep(i,n) rep(j,n) m[i][j] = '#';\n        rep(i,h) rep(j,w) cin >> m[i + 1][j + 1];\n        rep(i,h){\n            rep(j,w){\n                if(isdigit(m[i + 1][j + 1]) && m[i + 1][j + 1] != '0'){\n                    ans = big(ans,dfs(j + 1, i + 1));\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<algorithm>\n#include<cassert>\n#include<cctype>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<functional>\n#include<limits>\n#include<list>\n#include<map>\n#include<numeric>\n#include<set>\n#include<stack>\n#include<string>\n#include<sstream>\n#include<queue>\n#include<vector>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\n\n#define MOD 1000000007\n#define INF 0x3f3f3f3f\n#define INFL 0x3f3f3f3f3f3f3f3fLL\n\n#define MAX 70\nchar c[MAX][MAX];\nint W, H;\nstring dp[MAX][MAX];\n\nbool cmp(string a, string b) {\n\treturn a.size() == b.size() ? a < b : a.size() < b.size();\n}\n\n//xy??§?¨???§?????±???????????¢?´¢\nstring dfs(int x, int y) {\n\tif (x < W&&y < H) {\n\t\tif (dp[x][y] != \"$\")return dp[x][y];\n\t\tif (isdigit(c[x][y]))\n\t\t\treturn dp[x][y] = c[x][y] + max(dfs(x + 1, y), dfs(x, y + 1), cmp);\n\t\telse\n\t\t\treturn dp[x][y] = \"\";\n\t}\n\telse\n\t\treturn \"\";\n}\n\nint main() {\n\tfor (; cin >> W >> H&&W;) {\n\t\tmemset(c, 0, sizeof(c));\n\t\tfill(dp[0], dp[MAX], \"$\");\n\t\tfor (int y = 0; y < H; y++) {\n\t\t\tfor (int x = 0; x < W; x++) {\n\t\t\t\tcin >> c[x][y];\n\t\t\t}\n\t\t}\n\n\t\tvector<string> v;\n\t\tfor (int y = 0; y < H; y++) {\n\t\t\tfor (int x = 0; x < W; x++) {\n\t\t\t\tv.push_back(dfs(x, y));\n\t\t\t}\n\t\t}\n\t\tfor (int i = 0; i < v.size(); i++) {\n\t\t\tfor (int j = 0; j < v[i].size();) {\n\t\t\t\tif (v[i][j] == '0')\n\t\t\t\t\tv[i] = v[i].substr(1);\n\t\t\t\telse\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t//for (int i = 0; i < v.size(); i++) {\n\t\t//\tcout << v[i] << endl;\n\t\t//}\n\t\tsort(v.begin(), v.end(), cmp);\n\t\tcout << v[v.size() - 1] << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define debug(x) cout << \"debug \" << x << endl;\nconst int INF = 100000000;\nusing namespace std;\n\nchar m[75][75];\nstring memo[75][75];\nstring ans;\n\nstring big(string a, string b){\n    if(a.size() > b.size()){\n        return a;\n    }else if(a.size() < b.size()){\n        return b;\n    }else{\n        return a > b ? a : b;\n    }\n}\n\nvoid dfs(string a, int x, int y){\n    if(a.size() != 0 || m[y][x] != '0') a+=m[y][x];\n    if(big(memo[y][x], a) == memo[y][x]) return;\n    else if(memo[y][x] == a) return;\n    else{\n        memo[y][x] = a;\n    }\n    if(isdigit(m[y][x + 1])){\n        dfs(a, x + 1, y);\n    }\n    if(isdigit(m[y + 1][x])){\n        dfs(a, x, y + 1);\n    }\n    ans = big(ans, a);\n}\n\nint main(){\n    int w, h;\n    while(cin >> w >> h, w||h){\n        ans = \"\";\n        rep(i,h) rep(j,w) memo[i][j] = \"\";\n        rep(i,h) rep(j,w) m[i + 1][j + 1] = '#';\n        rep(i,h) rep(j,w) cin >> m[i + 1][j + 1];\n        rep(i,h){\n            rep(j,w){\n                if(isdigit(m[i][j]) && memo[i][j] == \"\") dfs(\"\", j, i);\n            }\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<n;i++)\n\nint W, H;\nchar grid[70][70];\nvector<char> dp[70][70];\n\nvector<char> max_str(vector<char> str1, vector<char> str2)\n{\n\tif (str1.size() > str2.size()) {\n\t\treturn str1;\n\t}\n\telse if (str1.size() < str2.size()) {\n\t\treturn str2;\n\t}\n\telse {\n\t\tbool ret1flag = false;\n\n\t\trep(i, str1.size()) {\n\t\t\tif (str1[i] > str2[i]) {\n\t\t\t\tret1flag = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse if (str2[i] > str1[i]) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (ret1flag == true) {\n\t\t\treturn str1;\n\t\t}\n\t\telse {\n\t\t\treturn str2;\n\t\t}\n\t}\n}\n\nbool isranged(int y, int x)\n{\n\tif (y >= 0 && y < H&&x >= 0 && x < W) {\n\t\treturn true;\n\t}\n\telse {\n\t\treturn false;\n\t}\n}\n\nint main()\n{\n\twhile (true) {\t\t\n\t\tcin >> W >> H;\n\n\t\tif (W == 0 && H == 0) {\n\t\t\tbreak;\n\t\t}\n\n\t\trep(i, 70) {\n\t\t\trep(j, 70) {\n\t\t\t\tdp[i][j].clear();\n\t\t\t}\n\t\t}\n\n\t\trep(y, H) {\n\t\t\trep(x, W) {\n\t\t\t\tcin >> grid[y][x];\n\t\t\t}\n\t\t}\n\n\t\trep(y, H) {\n\t\t\trep(x, W) {\n\t\t\t\tif (grid[y][x] >= 'A'&&grid[y][x] <= 'Z') {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (grid[y][x] >= '0'&&grid[y][x] <= '9') {\n\t\t\t\t\tif (isranged(y - 1, x) == true && isranged(y, x - 1) == true) {\n\t\t\t\t\t\tdp[y][x] = max_str(dp[y - 1][x], dp[y][x - 1]);\n\t\t\t\t\t\tif (grid[y][x] != '0' || dp[y][x].empty() != true) {\n\t\t\t\t\t\t\tdp[y][x].push_back(grid[y][x]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (isranged(y - 1, x) == true && isranged(y, x - 1) == false) {\n\t\t\t\t\t\tdp[y][x] = dp[y - 1][x];\n\t\t\t\t\t\tif (grid[y][x] != '0' || dp[y][x].empty() != true) {\n\t\t\t\t\t\t\tdp[y][x].push_back(grid[y][x]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (isranged(y - 1, x) == false && isranged(y, x - 1) == true) {\n\t\t\t\t\t\tdp[y][x] = dp[y][x - 1];\n\t\t\t\t\t\tif (grid[y][x] != '0' || dp[y][x].empty() != true) {\n\t\t\t\t\t\t\tdp[y][x].push_back(grid[y][x]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (grid[y][x] != '0' || dp[y][x].empty() != true) {\n\t\t\t\t\t\t\tdp[y][x].push_back(grid[y][x]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvector<char> answer;\n\n\t\trep(y, H) {\n\t\t\trep(x, W) {\n\t\t\t\tanswer = max_str(dp[y][x], answer);\n\t\t\t}\n\t\t}\n\n\t\trep(i, answer.size()) {\n\t\t\tcout << answer[i];\n\t\t}\n\n\t\tcout << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nstring strMax(string str1, string str2)\n{\n  if(str1.size() != str2.size())\n    return str1.size() > str2.size() ? str1 : str2;\n  string res = str1;\n  for(int i = 0; i < str1.size(); i++){\n    if(str1[i]-'0' == str2[i]-'0') continue;\n    res = str1[i]-'0' > str2[i]-'0' ? str1 : str2;\n    break;\n  }\n  return res;\n}\n\nbool comp(const string &a, const string &b)\n{\n  if(a.size() != b.size())\n    return a.size() > b.size();\n  for(int i = 0; i < a.size(); i++){\n    if(a[i]-'0' == b[i]-'0') continue;\n    return a[i]-'0' > b[i]-'0';\n  }\n}\n\nint main()\n{\n  while(1){\n    int W, H;\n    cin >> W >> H;\n    if(W == 0 && H == 0) break;\n    string C[H];\n    for(int i = 0; i < H; i++)\n      cin >> C[i];\n    \n    string dp[H+1][W+1];\n    for(int i = 0; i < H; i++)\n      for(int j = 0; j < W; j++)\n        dp[i][j] = C[i][j];\n    \n    for(int i = 1; i < W; i++)\n      if(isdigit(C[0][i-1]) && isdigit(C[0][i])){\n        dp[0][i] = dp[0][i-1] + dp[0][i];\n        if(dp[0][i][0] == '0') dp[0][i] = dp[0][i].substr(1);\n      }\n    \n    for(int i = 1; i < H; i++)\n      if(isdigit(C[i-1][0]) && isdigit(C[i][0])){\n        dp[i][0] = dp[i-1][0] + dp[i][0];\n        if(dp[i][0][0] == '0') dp[i][0] = dp[i][0].substr(1);\n      }\n    \n    for(int i = 1; i < H; i++){\n      for(int j = 1; j < W; j++){\n        if((!isdigit(C[i-1][j]) && !isdigit(C[i][j-1])) || !isdigit(C[i][j])) continue;\n        if(!isdigit(C[i-1][j]) && isdigit(C[i][j-1]))\n          dp[i][j] = dp[i][j-1] + dp[i][j];\n        else if(isdigit(C[i-1][j]) && !isdigit(C[i][j-1]))\n          dp[i][j] = dp[i-1][j] + dp[i][j];\n        else\n          dp[i][j] = strMax(dp[i-1][j] + dp[i][j], dp[i][j-1] + dp[i][j]);\n        if(dp[i][j][0] == '0') dp[i][j] = dp[i][j].substr(1);\n      }\n    }\n\n    /*\n    cout << \"-----------------------------\" << endl;\n    for(int i = 0; i < H; i++){\n      for(int j = 0; j < W; j++){\n        cout << dp[i][j] << \"  \";\n      }\n      cout << endl;\n    }\n    cout << \"-----------------------------\" << endl;\n    */\n    \n    vector<string> v;\n    \n    if(isdigit(C[H-1][W-1])) v.push_back(dp[H-1][W-1]);\n    \n    for(int i = 0; i < H-1; i++)\n      if(!isdigit(C[i+1][W-1]) && isdigit(C[i][W-1])) v.push_back(dp[i][W-1]);\n    \n    for(int i = 0; i < W-1; i++)\n      if(!isdigit(C[H-1][i+1]) && isdigit(C[H-1][i])) v.push_back(dp[H-1][i]);\n    \n    for(int i = 0; i < H-1; i++)\n      for(int j = 0; j < W-1; j++)\n        if(!isdigit(C[i+1][j]) && !isdigit(C[i][j+1]) && isdigit(C[i][j]))\n          v.push_back(dp[i][j]);\n    \n    sort(v.begin(),v.end(),comp);\n    cout << v[0] << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\nstring cutzero(const string& s)\n{\n\tfor(int i=0;i<s.size();i++)\n\t\tif(s[i]!='0')\n\t\t\treturn s.substr(i);\n\treturn \"\";\n}\n\nbool comp(const string& a,const string& b)\n{\n\treturn a.size()==b.size()?a<b:a.size()<b.size();\n}\n\nint main()\n{\n\tfor(int w,h;cin>>w>>h,w|h;){\n\t\tvector<string> a(h);\n\t\tfor(int i=0;i<h;i++)\n\t\t\tcin>>a[i];\n\t\t\n\t\tvector<vector<string> > dp(h,vector<string>(w));\n\t\tif(isdigit(a[0][0])) dp[0][0]+=a[0][0];\n\t\tfor(int i=1;i<h;i++)\n\t\t\tif(isdigit(a[i][0]))\n\t\t\t\tdp[i][0]=cutzero(dp[i-1][0])+a[i][0];\n\t\tfor(int j=1;j<w;j++)\n\t\t\tif(isdigit(a[0][j]))\n\t\t\t\tdp[0][j]=cutzero(dp[0][j-1])+a[0][j];\n\t\tfor(int i=1;i<h;i++)\n\t\t\tfor(int j=1;j<w;j++)\n\t\t\t\tif(isdigit(a[i][j]))\n\t\t\t\t\tdp[i][j]=cutzero(max(dp[i-1][j],dp[i][j-1],comp))+a[i][j];\n\t\t\n\t\tstring res=\"\";\n\t\tfor(int i=0;i<h;i++)\n\t\t\tfor(int j=0;j<w;j++)\n\t\t\t\tres=max(res,dp[i][j],comp);\n\t\tcout<<res<<endl;\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nstring strMax(string str1, string str2)\n{\n  if(str1.size() != str2.size())\n    return str1.size() > str2.size() ? str1 : str2;\n  string res = str1;\n  for(int i = 0; i < str1.size(); i++){\n    if(str1[i]-'0' == str2[i]-'0') continue;\n    res = str1[i]-'0' > str2[i]-'0' ? str1 : str2;\n    break;\n  }\n  return res;\n}\n\nbool comp(const string &a, const string &b)\n{\n  if(a.size() != b.size())\n    return a.size() > b.size();\n  for(int i = 0; i < a.size(); i++){\n    if(a[i]-'0' == b[i]-'0') continue;\n    return a[i]-'0' > b[i]-'0';\n  }\n}\n\nint main()\n{\n  while(1){\n    int W, H;\n    cin >> W >> H;\n    if(W == 0 && H == 0) break;\n    string C[H];\n    for(int i = 0; i < H; i++)\n      cin >> C[i];\n    \n    string dp[H+1][W+1];\n    for(int i = 0; i < H; i++)\n      for(int j = 0; j < W; j++)\n        dp[i][j] = C[i][j];\n    \n    for(int i = 1; i < W; i++)\n      if(C[0][i-1] != '0' && isdigit(C[0][i-1]) && isdigit(C[0][i]))\n        dp[0][i] = dp[0][i-1] + dp[0][i];\n    \n    for(int i = 1; i < H; i++)\n      if(C[i-1][0] != '0' && isdigit(C[i-1][0]) && isdigit(C[i][0]))\n        dp[i][0] = dp[i-1][0] + dp[i][0];\n    \n    for(int i = 1; i < H; i++){\n      for(int j = 1; j < W; j++){\n        if((!isdigit(C[i-1][j]) && !isdigit(C[i][j-1])) || !isdigit(C[i][j])) continue;\n        if(!isdigit(C[i-1][j]) && isdigit(C[i][j-1]))\n          dp[i][j] = dp[i][j-1] + dp[i][j];\n        else if(isdigit(C[i-1][j]) && !isdigit(C[i][j-1]))\n          dp[i][j] = dp[i-1][j] + dp[i][j];\n        else\n          dp[i][j] = strMax(dp[i-1][j] + dp[i][j], dp[i][j-1] + dp[i][j]);\n        if(dp[i][j][0] == '0') dp[i][j] = dp[i][j].substr(1);\n      }\n    }\n    \n    vector<string> v;\n    \n    if(isdigit(C[H-1][W-1])) v.push_back(dp[H-1][W-1]);\n    \n    for(int i = 0; i < H-1; i++)\n      if(!isdigit(C[i+1][W-1]) && isdigit(C[i][W-1])) v.push_back(dp[i][W-1]);\n    \n    for(int i = 0; i < W-1; i++)\n      if(!isdigit(C[H-1][i+1]) && isdigit(C[H-1][i])) v.push_back(dp[H-1][i]);\n    \n    for(int i = 0; i < H-1; i++)\n      for(int j = 0; j < W-1; j++)\n        if(!isdigit(C[i+1][j]) && !isdigit(C[i][j+1]) && isdigit(C[i][j]))\n          v.push_back(dp[i][j]);\n    \n    sort(v.begin(),v.end(),comp);\n    cout << v[0] << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\nint w, h;\nstring s[51], dp[51][51];\nbool is_num(char c){return '0'<=c && c<= '9';}\n\nstring str_max(string s1, string s2) {\n  if (s1.size() == s2.size()) {\n    return (s1 > s2) ? s1 : s2 ;\n  }\n  return (s1.size() > s2.size())? s1 : s2 ;\n}\n\nstring dfs(int i, int j) {\n  string res = \"\";\n  \n  // l¶áÈ¢ê\n  if (!is_num(s[i][j])) return res;\n  // DP\n  if (dp[i][j] != \"\") return dp[i][j];\n  \n  if (i+1 >= h && j+1 >= w) {\n    // EÉàºÉàißÈ¢\n    res += s[i][j];\n  } else if (i+1 >= h) {\n    // EÉ¾¯ißé\n    res += s[i][j] + dfs(i, j+1);\n  } else if (j+1 >= w) {\n    // ºÉ¾¯ißé\n    res += s[i][j] + dfs(i+1, j);\n  } else {\n    // Ç¿çÉàißé\n    res = s[i][j] + str_max(dfs(i, j+1), dfs(i+1, j));\n  }\n  // ªÉ0ªÂ¢Ä¢éêÍæé\n  if (i == 0 && j == 0) {\n    if (res[0] == '0') res.erase(0, 1);\n  } else if (i == 0) {\n    if (!is_num(s[i][j-1]) && res[0] == '0') res.erase(0, 1);\n  } else if (j == 0) {\n    if (!is_num(s[i-1][j]) && res[0] == '0') res.erase(0, 1);\n  } else{\n    if (!is_num(s[i-1][j]) && !is_num(s[i][j-1])) res.erase(0, 1);\n  }\n  \n  return dp[i][j] = res;\n}\n\nvoid solve() {\n  for(int i=0;i<h;i++) cin>>s[i];\n  \n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  dp[i][j] = \"\";\n  \n  string largest = \"\";\n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  if (is_num(s[i][j]) && dp[i][j] == \"\") {\n    largest = str_max(dfs(i, j), largest);\n  }\n  \n  cout<<largest<<endl;\n  //cout<<\"+++++\"<<endl;\n}\n\nint main (int argc, char const* argv[]) {\n  while (cin>>w>>h, w||h) {\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define vi vector<int>\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back\n#define pii pair<int,int>\n#define mp make_pair\n#define pi 3.14159265359\n#define shosu(X) fixed << setprecision(X)\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nbool isnum(char a){\n\treturn (a >= '0' && a <= '9');\n}\nstring removezero(string a){\n\tstring rst = \"\";\n\tbool flg = false;\n\tREP(i,a.size()){\n\t\tif(flg){\n\t\t\trst += a[i];\n\t\t}else{\n\t\t\tif(a[i] != '0'){\n\t\t\t\tflg = true;\n\t\t\t\trst += a[i];\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\treturn rst;\n}\nstring getbig(string a,string b){\n\ta = removezero(a);\n\tb = removezero(b);\n\treturn max(a,b);\n\t/*\n\tcout << a << \" \" << b << endl;\n\tif(a.size() < b.size()) return b;\n\telse if(a.size() > b.size()) return a;\n\tREP(i,a.size()){\n\t\tcout << a[i]-'0' << \" \" << b[i]-'0' << endl;\n\t\tif((int)a[i]-'0' < (int)b[i]-'0') {\n\t\t\tcout << \"big\" << b[i] << endl;\n\t\t\treturn b;\n\t\t}\n\t}\n\treturn a;*/\n}\nint main(){\n\tint w,h;\n\tchar g[70][70];\n\tstring s[70][70];\n\t//cout << getbig(\"23900\",\"23114\") << endl;\n\twhile(1){\n\t\tstring ans = \"\";\n\t\tcin >> w >> h;\n\t\tif (w == 0 && h == 0) break;\n\t\tREP(i,h) REP(j,w) cin >> g[i][j];\n\t\tREP(i,h) REP(j,w) s[i][j] = \"\";\n\t\tREP(i,h){\n\t\t\tREP(j,w){\n\t\t\t\tif(!isnum(g[i][j])) continue;\n\t\t\t\tint lx = i; int ly = j-1;\n\t\t\t\tint ux = i-1; int uy = j;\n\t\t\t\tstring l,r;\n\t\t\t\tif(lx >= 0 && ly >= 0) l = s[lx][ly];\n\t\t\t\telse l = \"\";\n\t\t\t\tif(ux >= 0 && uy >= 0) r = s[ux][uy];\n\t\t\t\telse r = \"\";\n\t\t\t\tl.pb(g[i][j]);\n\t\t\t\tr.pb(g[i][j]);\n\t\t\t\ts[i][j] = getbig(l,r);\n\t\t\t\t//cout << l << \"??¨\" << r << \" big \" << s[i][j] << endl;\n\t\t\t\tans = getbig(ans,s[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n\nusing namespace std;\n\nbool compare(string S1, string S2)\n{\n\tif (S1.size() != S2.size()) { return S1.size() > S2.size(); }\n\n\treturn S1 > S2;\n}\n\nint main()\n{\n\tint H, W; char R[71][71];\n\n\twhile (true)\n\t{\n\t\tscanf(\"%d\", &W);\n\t\tscanf(\"%d\", &H);\n\n\t\tif (H == 0 && W == 0) { break; }\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tscanf(\"%s\", R[i]);\n\t\t}\n\n\t\tvector<vector<string> > dp(H, vector<string>(W, \"\"));\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (isdigit(R[i][j]))\n\t\t\t\t{\n\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][j] = R[i][j];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i - 1][j] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]) && dp[i - 1][j] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i - 1][j] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (j != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i][j - 1] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]) && dp[i][j - 1] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i][j - 1] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ret = \"\";\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (compare(dp[i][j], ret))\n\t\t\t\t{\n\t\t\t\t\tret = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%s\\n\", ret.c_str());\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <iostream>\n#include <utility>\n#include <algorithm>\n#include <string>\n#include <deque>\n#include <tuple>\n#include <queue>\n#include <functional>\n#include <cmath>\n#include <iomanip>\n#include <map>\n#include <set>\n#include <numeric>\n#include <unordered_map>\n#include <unordered_set>\n#include <complex>\n#include <iterator>\n#include <array>\n//cin.sync_with_stdio(false);\n//streambuf\nusing namespace std;\ntypedef long long ll;\ntypedef long double ld;\ntypedef pair<int, int> pii;\ntypedef pair<double, double> pdd;\nusing vi = vector<int>;\nusing vll = vector<ll>;\nusing vpii = vector<pii>;\nusing ti3 = tuple<int, int, int>;\nusing vti3 = vector<ti3>;\ntemplate<class T, int s>using va = vector<array<T, s>>;\ntemplate<class T, class T2> using umap = unordered_map<T, T2>;\ntemplate<class T> using uset = unordered_set<T>;\ntemplate<class T, class S> void cmin(T &a, const S &b) { if (a > b)a = b; }\ntemplate<class T, class S> void cmax(T &a, const S &b) { if (a < b)a = b; }\n#define ALL(a) a.begin(),a.end()\n#define rep(i,a) for(int i=0;i<a;i++)\n#define rep1(i,a) for(int i=1;i<=a;i++)\n#define rrep(i,a) for(int i=a-1;i>=0;i--)\n#define rrep1(i,a) for(int i=a;i;i--)\nconst ll mod = 1000000007;\n#define REP rep\ntemplate<class T>using heap = priority_queue<T, vector<T>, greater<T>>;\ntemplate<class T>using pque = priority_queue<T, vector<T>, function<T(T, T)>>;\ntemplate <class T>\ninline void hash_combine(size_t & seed, const T & v) {\n\thash<T> hasher;\n\tseed ^= hasher(v) + 0x9e3779b9 + (seed << 6) + (seed >> 2);\n}\nnamespace std {\n\ttemplate<typename S, typename T> struct hash<pair<S, T>> {\n\t\tinline size_t operator()(const pair<S, T> & v) const {\n\t\t\tsize_t seed = 0;\n\t\t\thash_combine(seed, v.first);\n\t\t\thash_combine(seed, v.second);\n\t\t\treturn seed;\n\t\t}\n\t};\n\t// Recursive template code derived from Matthieu M.\n\ttemplate <class Tuple, size_t Index = std::tuple_size<Tuple>::value - 1>\n\tstruct HashValueImpl{\n\t\tstatic void apply(size_t& seed, Tuple const& tuple){\n\t\t\tHashValueImpl<Tuple, Index - 1>::apply(seed, tuple);\n\t\t\thash_combine(seed, std::get<Index>(tuple));\n\t\t}\n\t};\n\ttemplate <class Tuple>\n\tstruct HashValueImpl<Tuple, 0>{\n\t\tstatic void apply(size_t& seed, Tuple const& tuple){\n\t\t\thash_combine(seed, std::get<0>(tuple));\n\t\t}\n\t};\n\ttemplate <typename ... TT>\n\tstruct hash<std::tuple<TT...>>{\n\t\tsize_t operator()(std::tuple<TT...> const& tt) const{\n\t\t\tsize_t seed = 0;\n\t\t\tHashValueImpl<std::tuple<TT...> >::apply(seed, tt);\n\t\t\treturn seed;\n\t\t}\n\t};\n}\ntemplate<class T>int id(vector<T> &a, T b) {\n\treturn lower_bound(ALL(a), b) - a.begin();\n}\n//end of lib\nint main() {\n\tint w, h;\n\twhile (cin >> w >> h, w) {\n\t\tvector<string> c(h);\n\t\trep(i, h)cin >> c[i];\n\t\tvector<vector<string>> dp(h, vector<string>(w));\n\t\tstring ans;\n\t\trep(i, h)rep(j, w){\n\t\t\tif (c[i][j] > '9')continue;\n\t\t\tif (i)dp[i][j] = dp[i - 1][j];\n\t\t\tif (j) {\n\t\t\t\tif (dp[i][j].size() < dp[i][j - 1].size())dp[i][j] = dp[i][j - 1];\n\t\t\t\tif (dp[i][j].size() == dp[i][j - 1].size())cmax(dp[i][j], dp[i][j - 1]);\n\t\t\t}\n\t\t\tif (dp[i][j].size() != 0 || c[i][j] > '0')dp[i][j] += c[i][j];\n\t\t\tif (ans.size() < dp[i][j].size() || ans.size() == dp[i][j].size() && dp[i][j] > ans)ans = dp[i][j];\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<iomanip>\n#include<algorithm>\n#include<cassert>\n#include<cctype>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<functional>\n#include<limits>\n#include<list>\n#include<map>\n#include<numeric>\n#include<set>\n#include<stack>\n#include<string>\n#include<sstream>\n#include<queue>\n#include<vector>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\n\n#define MOD 1000000007\n#define INF 0x3f3f3f3f\n#define INFL 0x3f3f3f3f3f3f3f3fLL\n\n#define MAX 70\nchar c[MAX][MAX];\nint W, H;\nstring dp[MAX][MAX];\n\nbool cmp(string a, string b) {\n\treturn a.size() == b.size() ? a < b : a.size() < b.size();\n}\n\n//xy??§?¨???§?????±???????????¢?´¢\nstring dfs(int x, int y) {\n\tif (x < W&&y < H) {\n\t\tif (dp[x][y] != \"$\")return dp[x][y];\n\t\tif (isdigit(c[x][y]))\n\t\t\treturn dp[x][y] = c[x][y] + max(dfs(x + 1, y), dfs(x, y + 1), cmp);\n\t\telse\n\t\t\treturn dp[x][y] = \"\";\n\t}\n\telse\n\t\treturn \"\";\n}\n\nint main() {\n\tfor (; cin >> W >> H&&W;) {\n\t\tmemset(c, 0, sizeof(c));\n\t\tfill(dp[0], dp[MAX], \"$\");\n\t\tfor (int y = 0; y < H; y++) {\n\t\t\tfor (int x = 0; x < W; x++) {\n\t\t\t\tcin >> c[x][y];\n\t\t\t}\n\t\t}\n\n\t\tvector<string> v;\n\t\tfor (int y = 0; y < H; y++) {\n\t\t\tfor (int x = 0; x < W; x++) {\n\t\t\t\tv.push_back(dfs(x, y));\n\t\t\t}\n\t\t}\n\t\tfor (int i = 0; i < v.size(); i++) {\n\t\t\tfor (int j = 0; j < v[i].size(); j++) {\n\t\t\t\tif (v[i][j] == '0')\n\t\t\t\t\tv[i] = v[i].substr(1);\n\t\t\t\telse\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t//for (int i = 0; i < v.size(); i++) {\n\t\t//\tcout << v[i] << endl;\n\t\t//}\n\t\tsort(v.begin(), v.end(), cmp);\n\t\tcout << v[v.size() - 1] << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cctype>\n\nusing namespace std;\n\nint main(void){\n  int w,h;\n  string grid[70],dp[70][70];\n\n  while(cin >> w >> h,w|h){\n    for(int i=0;i<70;i++)\n      for(int j=0;j<70;j++)dp[i][j].clear();\n\n    for(int i=0;i<h;i++)cin >> grid[i];\n\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(!isupper(grid[i][j])){\n\t  if(grid[i][j]!='0')dp[i][j]=grid[i][j];\n\t  string a=\"\",b=\"\";\n\t  if(i>0 && !dp[i-1][j].empty())a=dp[i-1][j]+grid[i][j];\n\t  if(j>0 && !dp[i][j-1].empty())b=dp[i][j-1]+grid[i][j];\n\t  \n\t  if(a.empty() && !b.empty()){\n\t    dp[i][j]=b;\n\t    continue;\n\t  }\n\n\t  if(!a.empty() && b.empty()){\n\t    dp[i][j]=a;\n\t    continue;\n\t  }\n\t  if(a.empty() && b.empty())continue;\n\t  if(a.size()>b.size())dp[i][j]=a;\n\t  if(a.size()<b.size())dp[i][j]=b;\n\t  else if(a>b)dp[i][j]=a;\n\t  else dp[i][j]=b;\n\n\t}\n      }\n    }\n\n    string s=\"\";\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(dp[i][j][0]=='0'){\n\t  int k=0;\n\t  for(;k<dp[i][j].size()&&dp[i][j][k]=='0';k++);\n\t  dp[i][j]=dp[i][j].substr(k);\n\t}\n\tif(s.size()<dp[i][j].size())s=dp[i][j];\n\telse if(s<dp[i][j])s=dp[i][j];\n      }\n    }\n    cout << s << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 100000000\n\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair <int,int> P;\n\n\nstatic const double EPS = 1e-8;\n\nint tx[] = {-1,0,1,0};\nint ty[] = {0,1,0,-1};\n\nchar stage[101][101];\nint W,H;\n\nstring larger(const string& str1,const string& str2){\n\tif(str1.size() > str2.size()) return str1;\n\tif(str1.size() < str2.size()) return str2;\n\n\tfor(int i=0;i<str1.size();i++){\n\t\tif(str1[i] > str2[i] ) return str1;\n\t\tif(str1[i] < str2[i] ) return str2;\n\t}\n\n\treturn str1;\n}\n\nvoid dfs(int x,int y,string buf,string& res){\n\tbuf.push_back(stage[y][x]);\n\n\tif(y+1 < H && isdigit(stage[y+1][x])){\n\t\tdfs(x,y+1,buf,res);\t\t\n\t}\n\n\tif(x+1 < W && isdigit(stage[y][x+1])){\n\t\tdfs(x+1,y,buf,res);\n\t}\n\n\tres = larger(res,buf);\n}\n\nint main()\n{\n\twhile(~scanf(\"%d %d\",&W,&H)){\n\t\tif(W==H && H==0) break;\n\t\tfor(int y=0;y<H;y++){\n\t\t\tchar buf[128];\n\t\t\tscanf(\"%s\",buf);\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tstage[y][x] = buf[x];\n\t\t\t}\n\t\t}\n\n\t\tstring dp[101][101];\n\t\t//for(int x=0;x<W;x++) \n\t\t//\tif(isdigit(stage[0][x]) && stage[0][x] != '0'){\n\t\t//\tdp[1][x+1] = dp[0][x] + stage[0][x];\n\t\t//\tprintf(\"dp[%d][%d]=%s\\n\",0,x+1,dp[0][x+1].c_str());\n\t\t//}\n\n\t\t//for(int y=0;x<W;y++) \n\t\t//\tif(isdigit(stage[0][x]) && stage[0][x] != '0'){\n\t\t//\tdp[1][x+1] = dp[0][x] + stage[0][x];\n\t\t//\tprintf(\"dp[%d][%d]=%s\\n\",0,x+1,dp[0][x+1].c_str());\n\t\t//}\n\n\t\tfor(int y=0;y<H;y++){\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tstring left=\"\";\n\t\t\t\tif(isdigit(stage[y][x])){\n\t\t\t\t\tif(!(dp[y+1][x].size() == 0 && stage[y][x]=='0')){\n\t\t\t\t\t\tleft = dp[y+1][x] + stage[y][x];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstring up=\"\";\n\t\t\t\tif(isdigit(stage[y][x])){\n\t\t\t\t\tif(!(dp[y][x].size() == 0 && stage[y][x]=='0')){\n\t\t\t\t\t\tup = dp[y][x+1] + stage[y][x];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tdp[y+1][x+1] = larger(left,up);\n\t\t\t}\n\t\t}\n\n\t\tstring res=\"0\";\n\t\tfor(int y=0;y<=H;y++){\n\t\t\tfor(int x=0;x<=W;x++){\t\n\t\t\t\tres = larger(res,dp[y][x]);\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cctype>\n#include <string>\n#include <algorithm>\n#include <vector>\nusing namespace std;\n\nstring dp[71][70];\nchar c[70][72];\nint W, H;\n\nbool bt_str(string& a, string& b){\n    if( a.size() > b.size() ) return true;\n    return a.size() == b.size() && a > b;\n}\n\nstring bigger(string a, string b){\n    return bt_str(a, b) ? a : b;\n}\n\nint main(){\n    for(; scanf(\"%d %d\", &W, &H), W;){\n        for(int x = 0; x < H; x++){\n            fill(c[x], c[x]+W, 0);\n            fill(dp[x], dp[x]+W, \"\");\n            scanf(\" %s\", c[x]);\n        }\n        fill(dp[H], dp[H]+W, \"\");\n        string best = \"\";\n        for(int x = 0; x < H; x++){\n            for(int y = 0; y < W; y++){\n                if(isdigit(c[x][y])){\n                    dp[x+1][y] = dp[x][y]+string(1,c[x][y]);\n                    if(y){\n                        dp[x+1][y] = bigger(dp[x+1][y],\n                                            dp[x+1][y-1]+string(1,c[x][y]));\n                    }\n                    if(dp[x+1][y] == \"0\"){\n                        dp[x+1][y] = \"\";\n                    }\n                    best = bigger(best, dp[x+1][y]);\n                }\n            }\n        }\n        cout << best << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cctype>\n#include <string>\n#include <algorithm>\n#include <vector>\nusing namespace std;\n\nstring dp[71][70];\nchar c[70][72];\nint W, H;\n\nbool lt_str(string& a, string& b){\n    if( a.size() > b.size() ) return true;\n    return a.size() == b.size() && a > b;\n}\n\nstring bigger(string a, string b){\n    return lt_str(a, b) ? a : b;\n}\n\nint main(){\n    for(; scanf(\"%d %d\", &W, &H), W;){\n        for(int x = 0; x < H; x++){\n            fill(c[x], c[x]+W, 0);\n            fill(dp[x], dp[x]+W, \"\");\n            scanf(\" %s\", c[x]);\n        }\n        string best = \"\";\n        for(int x = 0; x <= H; x++){\n            for(int y = 0; y < W; y++){\n                if(isdigit(c[x][y])){\n                    dp[x+1][y] = dp[x][y]+string(1,c[x][y]);\n                    if(y){\n                        dp[x+1][y] = bigger(dp[x+1][y],\n                                            dp[x+1][y-1]+string(1,c[x][y]));\n                    }\n                    if(dp[x+1][y] == \"0\"){\n                        dp[x+1][y] = \"\";\n                    }\n                    best = bigger(best, dp[x+1][y]);\n                }\n            }\n        }\n        cout << best << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <cctype>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <set>\n#include <queue>\n#include <stack>\n#include <map>\n#include <cassert>\nusing namespace std;\n\n#define REP(i, s, e) for (int i = (s); i < (e); i++)\n#define REPI(i, s, e) for (int i = (s); i <= (e); i++)\n#define rep(i, n) REP(i, 0, n)\n#define repi(i, n) REPI(i, 0, n)\n#define ALL(v) (v).begin(), (v).end()\n\n#define dump(x) (cout << #x << \" = \" << x << endl)\n#define dump2(x, y) (cout << \"(\" << #x << \", \" << #y << \") = (\" << x << \", \" << y << \")\" << endl)\n#define dump3(x, y, z) (cout << \"(\" << #x << \", \" << #y << \", \" << #z << \") = (\" << x << \", \" << y << \", \"<< z << \")\" << endl)\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\n\nint w, h;\n\n#define MAX 70\nchar brd[MAX][MAX];\n\nstring memo[MAX][MAX];\n\nint dx[] = { 1, 0 };\nint dy[] = { 0, 1 };\n\nclass num {\npublic:\n\tstring n;\n\n\tnum():n(\"\") {}\n\tnum(string n):n(f(n)) {}\n\n\tstring f(string s)\n\t{\n\t\tif (s[0] == '0' && s.size() > 1) return s.substr(1);\n\t\treturn s;\n\t}\n\n\tbool operator<(const num &r) const {\n\t\tif (n.size() == r.n.size())\n\t\t\treturn n < r.n;\n\t\treturn n.size() < r.n.size();\n\t}\n};\n\nstring dfs(int y, int x)\n{\n\tif (memo[y][x] != \"\")\n\t\treturn memo[y][x];\n\n\tstring ans = \"\";\n\trep(d, 2) {\n\t\tint ty = y+dy[d], tx = x+dx[d];\n\t\tif (!(0 <= ty && ty < h)) continue;\n\t\tif (!(0 <= tx && tx < w)) continue;\n\t\tif (!isdigit(brd[ty][tx])) continue;\n\t\tstring ret = brd[y][x] + dfs(ty, tx);\n\t\tif (ans.size() == ret.size())\n\t\t\tans = max(ans, ret);\n\t\telse if (ans.size() < ret.size())\n\t\t\tans = ret;\n\t}\n\tif (ans == \"\") ans = brd[y][x];\n\treturn memo[y][x] = ans;\n}\n\nint main(void)\n{\n\twhile (cin >> w >> h, w|h) {\n\t\trep(j, MAX) rep(i, MAX)\n\t\t\tmemo[j][i] = \"\";\n\n\t\trep(j, h) rep(i, w) cin >> brd[j][i];\n\n\t\tnum ans = num();\n\t\trep(j, h)\n\t\t\trep(i, w)\n\t\t\t\tif (isdigit(brd[j][i]))\n\t\t\t\t\tans = max(ans, num(dfs(j, i)));\n\n\t\tcout << ans.n << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<sstream>\n#include<cstring>\n#include<vector>\nusing namespace std;\n\nbool cmp1(const string& a,const string& b)\n{\n  int size_a,size_b;\n  int start_a,start_b;\n  start_a = start_b = 0;\n  size_a = a.size(),size_b = b.size();\n  if(a[0] == '0')\n    for(int i=0;i<a.size() && a[i] == '0';i++)\n      size_a--,start_a++;\n\n  if(b[0] == '0')\n    for(int i=0;i<b.size() && b[i] == '0';i++)\n      size_b--,start_b++;\n\n  if(size_a != size_b)\n    return size_a < size_b;\n\n  for(int i=0;i<size_a;i++)\n    {\n      if(a[start_a+i] != b[start_b+i])\n\treturn a[start_a+i] < b[start_b+i];\n    }\n  return true;\n}\n\nbool cmp2(const string& a,const string& b)\n{\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    {\n      if(a[i] != b[i])\n\treturn a[i] < b[i];\n    }\n  return true;\n}\n\nint main()\n{\n\n  int W,H;\n  while(cin >> W >> H,W|H)\n    {\n     \n      vector<vector<string> > G;\n      G.resize(H);\n      for(int i=0;i<H;i++)\n\t{\n\t  G[i].resize(W);\n\t  string line;\n\t  cin >> line;\n\n\t  for(int j=0;j<W;j++)\n\t    {\n\t      G[i][j] = line[j];\n\t    }\n\t}\n\n      string G2[H][W];\n      string ans = \"\";\n      for(int i=0;i<H;i++)\n\t{\n\t  for(int j=0;j<W;j++)\n\t    {\n\t      if(isalpha(G[i][j][0]))\n\t\tcontinue;\n\t      //cout << i << \" - \" << j << endl;\n\t      G2[i][j] = max(G2[i][j],G[i][j],cmp1);\n\t      string A,B;\n\t      A = B = G2[i][j];\n\t      if(j-1 >= 0 && !isalpha(G[i][j-1][0]))\n\t\tA = max(G2[i][j],G2[i][j-1]+G2[i][j],cmp1);\n\n\t      if(i-1 >= 0 && !isalpha(G[i-1][j][0]))\n\t\tB = max(G2[i][j],G2[i-1][j]+G2[i][j],cmp1);\n\t      G2[i][j] = max(A,B,cmp1);\n\t      //cout << \"G2[\" << i << \"][\" << j << \"] = \" << G2[i][j] << endl;\n\t      ans = max(G2[i][j],ans,cmp1);\n\t      ans = max(A,ans,cmp1);\n\t      ans = max(B,ans,cmp1);\n\t    }\n\t}\n    \n      \n      for(int i=0;i<ans.size()&&ans[i] == '0';i++)\n\tans[i] = ' ';\n      stringstream ss;\n      ss << ans;\n      ss >> ans;\n      \n     cout << ans << endl;\n\n      }\n    \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,n) for(int i=0;i<(n);++i)\n#define loop for(;;)\n#define trace(var) cerr<<\">>> \"<<#var<<\" = \"<<var<<endl;\n#define all(v) begin(v),end(v)\n#define pb push_back\n#define inf (1e9)\n#define eps (1e-9)\n\ntypedef long long Integer ;\ntypedef long double Real;\nconst Real PI = acosl(-1);\ntypedef pair<int, int> P;\n\ntemplate<class S, class T> inline\nostream& operator<<(ostream&os, pair<S,T> p) {\n  return os << '(' << p.first << \", \" << p.second << ')';\n}\n\ntemplate<class S, class T, class U> inline\nostream& operator<<(ostream&os, tuple<S,T,U> t) {\n  return os << '('\n    << get<0>(t) << \", \"\n    << get<1>(t) << \", \"\n    << get<2>(t) << ')';\n}\n\ntemplate<class T> inline\nostream& operator<<(ostream&os, set<T> v) {\n  os << \"(set\";\n  for (T item: v) os << ' ' << item;\n  os << \")\";\n  return os;\n}\n\ntemplate<class T> inline\nostream& operator<<(ostream&os, vector<T> v) {\n  if (v.size() == 0) { return os << \"(empty)\"; }\n  os << v[0];\n  for (int i=1, len=v.size(); i<len; ++i) os << ' ' << v[i];\n  return os;\n}\n\ntemplate<class T> inline\nistream& operator>>(istream&is, vector<T>&v) {\n  rep (i, v.size()) is >> v[i];\n  return is;\n}\n\n//           ^   >  v   <\nint dx[] = { -1, 0, 1,  0 };\nint dy[] = {  0, 1, 0, -1 };\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<bool> vb;\n\nchar f[100][100];\nstring s[100][100];\n\nbool comp(string s, string t) {\n  if (s.size() != t.size()) return (s.size() < t.size());\n  rep (i, s.size()) if (s[i] != t[i]) return (s[i] < t[i]);\n  return true;\n}\n\nint main()\n{\n\n  int w, h;\n  while (cin >> w >> h, w and h)\n  {\n    rep (i, h) rep (j, w) cin >> f[i][j];\n    rep (i, h) rep (j, w) s[i][j] = \"\";\n\n    rep (i, h) {\n      rep (j, w) {\n        char c = f[i][j];\n        if (not isdigit(c)) continue;\n        if (i == 0 and j == 0) {\n          if (c != '0') s[i][j] += c;\n        }\n        else if (i == 0) {\n          s[i][j] = s[i][j-1] + c;\n          if (s[i][j] == \"0\") s[i][j] = \"\";\n        }\n        else if (j == 0) {\n          s[i][j] = s[i-1][j] + c;\n          if (s[i][j] == \"0\") s[i][j] = \"\";\n        }\n        else {\n          if (comp(s[i-1][j], s[i][j-1])) {\n            s[i][j] = s[i][j-1] + f[i][j];\n          } else {\n            s[i][j] = s[i-1][j] + f[i][j];\n          }\n          if (s[i][j] == \"0\") s[i][j] = \"\";\n        }\n      }\n    }\n\n    string ans = \"\";\n    rep (i, h) {\n      rep (j, w) {\n        if (comp(ans, s[i][j])) ans = s[i][j];\n      }\n    }\n    cout << ans << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cctype>\n\nusing namespace std;\n\nint main(void){\n  int w,h;\n  string grid[71],dp[71][71];\n\n  while(cin >> w >> h,w|h){\n    for(int i=0;i<71;i++)\n      for(int j=0;j<71;j++)dp[i][j].clear();\n\n    for(int i=0;i<h;i++)cin >> grid[i];\n\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(!isupper(grid[i][j])){\n\t  dp[i][j]=grid[i][j];\n\t  string a=\"\",b=\"\";\n\t  if(i>0 && !dp[i-1][j].empty())a=dp[i-1][j]+grid[i][j];\n\t  if(j>0 && !dp[i][j-1].empty())b=dp[i][j-1]+grid[i][j];\n\t  \n\t  while(a[0]=='0') a.erase(a.begin());\n\t  while(b[0]=='0') b.erase(b.begin());\n\n\t  if(a.empty() && !b.empty()){\n\t    dp[i][j]=b;\n\t    continue;\n\t  }\n\n\t  if(!a.empty() && b.empty()){\n\t    dp[i][j]=a;\n\t    continue;\n\t  }\n\n\t  if(a.empty() && b.empty())continue;\n\n\t  if(a[0]=='0'){\n\t    int k=0;\n\t    for(;k<a.size()&&a[k]=='0';k++);\n\t    a=a.substr(k);\n\t  }\n\n\t  if(b[0]=='0'){\n\t    int k=0;\n\t    for(;k<b.size()&&b[k]=='0';k++);\n\t    b=b.substr(k);\n\t  }\n\n\t  if(a.size()>b.size())dp[i][j]=a;\n\t  if(a.size()<b.size())dp[i][j]=b;\n\t  else if(a>b)dp[i][j]=a;\n\t  else dp[i][j]=b;\n\t}\n      }\n    }\n\n    string s=\"\";\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(s.size()<dp[i][j].size())s=dp[i][j];\n\telse if(s.size()>dp[i][j].size())s=s;\n\telse if(s<dp[i][j])s=dp[i][j];\n      }\n    }\n    cout << s << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n)for(int i=0;i<n;i++)\nusing namespace std;\ntypedef pair<int, int>P;\n\nchar c[80][80];\nstruct str {\n\tstring s;\n\tstr(string s = \"\") :s(s) {}\n}d[80][80];\nbool operator<(str a, str b) {\n\tif (a.s.size() == b.s.size())return a.s < b.s;\n\treturn a.s.size() < b.s.size();\n}\nint main() {\n\tint w, h;\n\twhile (scanf(\"%d%d\", &w, &h), w) {\n\t\trep(i, h)scanf(\"%s\", c[i]);\n\t\tstr Max = (string)\"0\";\n\t\trep(i, h)rep(j, w) {\n\t\t\tif ('0' <= c[i][j] && c[i][j] <= '9') {\n\t\t\t\td[i][j] = to_string(c[i][j] - '0');\n\t\t\t\tif (i)d[i][j] = max(d[i][j], str(d[i - 1][j].s + c[i][j]));\n\t\t\t\tif (j)d[i][j] = max(d[i][j], str(d[i][j - 1].s + c[i][j]));\n\t\t\t\twhile (!d[i][j].s.empty() && d[i][j].s.front() == '0')d[i][j] = d[i][j].s.substr(1);\n\t\t\t\tMax = max(Max, d[i][j]);\n\t\t\t}\n\t\t\telse d[i][j] = (string)\"\";\n\t\t}\n\t\tcout << Max.s << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\nusing namespace std;\nint W,H;\nchar c[71][71];\nstring s[71][71];\nstring t = \".\";\n\nbool operation(const string &l,const string &r){\n\tif(l.size() != r.size()){\n\t\treturn l.size() < r.size();\n\t}\n\telse{\n\t\treturn l < r;\n\t}\n}\n\nstring solve(int i,int j){\n\tstring s1,s2;\n\ts1 = s2 = c[i][j];\n\tif(s[i][j] != t)return s[i][j];\n\tif(c[i][j+1] >= '0' && c[i][j+1] <= '9' && j+1 < W){\n\t\tif(s[i][j+1] != t) s1 += s[i][j+1];\n\t\telse s1 += solve(i,j+1);\n\t}\n\tif(c[i+1][j] >= '0' && c[i+1][j] <= '9' && i+1 < H){\n\t\tif(s[i+1][j] != t) s2 += s[i+1][j];\n\t\telse s2 += solve(i+1,j);\n\t}\n\n\ts[i][j] = max(s1,s2,operation);\n\treturn s[i][j];\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> W >> H;\n\t\tint x,y;\n\t\tstring st,res;\n\t\tif(W == 0)break;\n\t\tres = \"\";\n\t\tfor(int i = 0;i < 71;i++){\n\t\t\tfor(int j = 0;j <= 71;j++){\n\t\t\t\ts[i][j] = \".\";\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tif(c[i][j] >= '1' && c[i][j] <= '9'){\n\t\t\t\t\tsolve(i,j);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tif(s[i][j] == t)continue;\n\t\t\t\tres = max(res,s[i][j],operation);\n\t\t\t}\n\t\t}\t\t\n\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\n#include <ctype.h>\n#include <string> \n#include <cstring>\n#include <sstream>\n#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <map>\n#include <queue>\n#include <utility>\n#include <vector>\n#include <set>\n#include <iomanip>\n#include <stack>\n  \nusing namespace std;\n\n#define pi 3.141592653589793\n\n#define MAX 1000000000\n\nbool ismax(string comp1, string comp2)\n{\n\t// 第一引数の方が大きい場合true\n\tint l1 = comp1.length(), l2 = comp2.length();\n\twhile(comp1[0] == '0') comp1.erase(0, 1);\n\twhile(comp2[0] == '0') comp2.erase(0, 1);\n\tif(comp1 == \"\" && comp2 == \"\"){\n\t\tif(l1 > l2) return true;\n\t\telse return false;\n\t}\n\tif(comp1.length() > comp2.length()) return true;\n\telse if(comp1.length() == comp2.length()){\n\t\tint n = 0;\n\t\twhile(n < comp1.length() && comp1[n] == comp2[n]){\n\t\t\tn++;\n\t\t}\n\t\tif(n == comp1.length() || comp1[n] - '0' > comp2[n] - '0') return true;\n\t\telse return false;\n\t} else return false;\n}\n\nstring solve(int w, int h, char c[71][71])\n{\n\tstring ans = \"\";\n\tstring result[72][72];\n\tfor(int i = h; i > 0; i--){\n\t\tresult[i][w + 1] = \"\";\n\t}\n\tfor(int i = w; i > 0; i--){\n\t\tresult[h + 1][i] = \"\";\n\t}\n\tresult[h + 1][w + 1] = \"\";\n\tfor(int i = h; i > 0; i--){\n\t\tfor(int j = w; j > 0; j--){\n\t\t\tresult[i][j] = \"\";\n\t\t\tif(isdigit(c[i][j])){\n\t\t\t\tresult[i][j] += c[i][j];\n\t\t\t\tif(ismax(result[i + 1][j], result[i][j + 1])) result[i][j] += result[i + 1][j];\n\t\t\t\telse result[i][j] += result[i][j + 1];\n\t\t\t\tif(ismax(result[i][j], ans)) ans = result[i][j];\n\t\t\t}\n\t\t}\n\t}\n\twhile(ans[0] == '0') ans.erase(0, 1); \n\treturn ans;\n}\n\n\nint main()\n{\n\tint w, h;\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(w == 0 && h == 0) break;\n\t\tchar c[71][71];\n\t\tfor(int i = 1; i < h + 1; i++){\n\t\t\tfor(int j = 1; j < w + 1; j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t}\n\t\t}\n\t\tcout << solve(w, h, c) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\n#include <algorithm>\n#include <iostream>\n#include <fstream>\n#include <vector>\n#include <utility>\n#include <cstring>\nusing namespace std;\ntypedef long long ll;\n\nint W,H;\nstring dp[71][71];\nvector<string> f;\n\nbool compare(const string& l, const string& r) {\n\tif (l.size() != r.size()) return l.size() < r.size();\n\treturn l < r;\n}\n\nint main() {\n\twhile(true) {\n\t\tcin >> W >> H;\n\t\tif (W == 0) break;\n\t\tf.clear();\n\t\tstring line;\n\t\tfor (int i = 0; i <= H; ++i) {\n\t\t\tif (i < H) cin >> line;\n\t\t\tf.push_back(line);\n\t\t\tfor (int j = 0; j <= W; ++j) {\n\t\t\t\tdp[i][j].clear();\n\t\t\t}\n\t\t}\n\t\tstring ans = \"\";\n\t\tfor (int i = H-1; i >= 0; --i) {\n\t\t\tfor (int j = W-1; j >= 0; --j) {\n\t\t\t\tchar c = f[i][j];\n\t\t\t\tif ('0' <= c && c <= '9') {\n\t\t\t\t\tstring base = \"\";\n\t\t\t\t\tif (compare(base, dp[i+1][j])) base = dp[i+1][j];\n\t\t\t\t\tif (compare(base, dp[i][j+1])) base = dp[i][j+1];\n\t\t\t\t\tdp[i][j] = c + base;\n\t\t\t\t\tif (c != '0' && compare(ans, dp[i][j])) ans = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<sstream>\n#include<cstring>\n#include<vector>\nusing namespace std;\n\nbool cmp1(const string& a,const string& b)\n{\n  int size_a,size_b;\n  int start_a,start_b;\n  start_a = start_b = 0;\n  size_a = a.size(),size_b = b.size();\n  if(a[0] == '0')\n    for(int i=0;i<a.size() && a[i] == '0';i++)\n      size_a--,start_a++;\n\n  if(b[0] == '0')\n    for(int i=0;i<b.size() && b[i] == '0';i++)\n      size_b--,start_b++;\n\n  if(size_a != size_b)\n    return size_a < size_b;\n\n  for(int i=0;i<size_a;i++)\n    {\n      if(a[start_a+i] != b[start_b+i])\n\treturn a[start_a+i] < b[start_b+i];\n    }\n  return true;\n}\n\nbool cmp2(const string& a,const string& b)\n{\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    {\n      if(a[i] != b[i])\n\treturn a[i] < b[i];\n    }\n  return true;\n}\n\nint main()\n{\n\n  int W,H;\n  while(cin >> W >> H,W|H)\n    {\n     \n      vector<vector<string> > G;\n      G.resize(H);\n      for(int i=0;i<H;i++)\n\t{\n\t  G[i].resize(W);\n\t  string line;\n\t  cin >> line;\n\n\t  for(int j=0;j<W;j++)\n\t    {\n\t      G[i][j] = line[j];\n\t    }\n\t}\n\n      string G2[H][W];\n      string ans = \"\";\n      for(int i=0;i<H;i++)\n\t{\n\t  for(int j=0;j<W;j++)\n\t    {\n\t      if(isalpha(G[i][j][0]))\n\t\tcontinue;\n\t    \n\t      G2[i][j] = max(G2[i][j],G[i][j],cmp2);\n\t      string A,B;\n\t      A = B = G2[i][j];\n\t      if(j-1 >= 0 && !isalpha(G[i][j-1][0]))\n\t\tA = max(G2[i][j],G2[i][j-1]+G2[i][j],cmp2);\n\n\t      if(i-1 >= 0 && !isalpha(G[i-1][j][0]))\n\t\tB = max(G2[i][j],G2[i-1][j]+G2[i][j],cmp2);\n\t      G2[i][j] = max(A,B,cmp2);\n\t      ans = max(G2[i][j],ans,cmp2);\n\t      ans = max(A,ans,cmp2);\n\t      ans = max(B,ans,cmp2);\n\t    }\n\t}\n    \n      \n      for(int i=0;i<ans.size()&&ans[i] == '0';i++)\n\tans[i] = ' ';\n      stringstream ss;\n      ss << ans;\n      ss >> ans;\n      \n     cout << ans << endl;\n\n      }\n    \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<deque>\n#include<list>\n#include<map>\n#include<queue>\n#include<set>\n#include<stack>\n#include<vector>\n#include<algorithm>\n#include<string>\n#include<iostream>\n#include<sstream>\n#include<cmath>\n#include<cstring>\nusing namespace std;\nint a[80][80],b[80][80][80],c[80][80],d[80];\nint mx[80];\nint ln;\nvoid fn(int p,int q,int r){\n  int i;\n  if(a[q][r+1]<0&&a[q+1][r]<0){\n    if(ln==p){\n      for(i=0;i<p;++i){\n\tif(0){\n\t}else if(mx[i]<d[i]){\n\t  break;\n\t}else if(mx[i]>d[i]){\n\t  i=p;\n\t  break;\n\t}\n      }\n    }\n    if(ln<p||(ln==p&&i<p)){\n      memcpy(mx,d,p*sizeof(int));\n      ln=p;\n    }\n  }else{\n    if(c[q][r]==p){\n      for(i=0;i<p;++i){\n\tif(0){\n\t}else if(b[q][r][i]<d[i]){\n\t  break;\n\t}else if(b[q][r][i]>d[i]){\n\t  i=p;\n\t  break;\n\t}\n      }\n    }\n    if(c[q][r]<p||(c[q][r]==p&&i<p)){\n      memcpy(b[p][q],d,p*sizeof(int));\n      c[p][q]=p;\n      if(a[q][r+1]>=0){\n\td[p]=a[q][r+1];\n\tfn(p+1,q,r+1);\n      }\n      if(a[q+1][r]>=0){\n\td[p]=a[q+1][r];\n\tfn(p+1,q+1,r);\n      }\n    }\n  }\n  return;\n}\nint main(){\n  int i,j;\n  int w,h;\n  while(cin>>w>>h,w||h){\n    memset(a,-1,sizeof(a));\n    for(i=0;i<h;++i){\n      for(j=0;j<w;++j){\n\tchar s;\n\tcin>>s;\n\tif('0'<=s&&s<='9')\n\t  a[i][j]=s-'0';\n      }\n    }\n    memset(c,0,sizeof(c));\n    mx[0]=0;\n    ln=1;\n    for(i=0;i<h;++i){\n      for(j=0;j<w;++j){\n\tif(a[i][j]>0){\n\t  d[0]=a[i][j];\n\t  fn(1,i,j);\n\t}\n      }\n    }\n    for(i=0;i<ln;++i)\n      cout<<mx[i];\n    cout<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "# define _CRT_SECURE_NO_WARNINGS 1\n# include <iostream>\n# include <numeric>\n# include <string>\n# include <bitset>\n# include <vector>\n# include <algorithm>\n# include <cstdlib>\n# include <cstdio>\n# include <cstring>\n# include <cstdlib>\n# include <iomanip>\n# include <queue>\n# include <sstream>\n# include <climits>\n# include <cmath>\n# include <list>\n# include <functional>\n# include <string>\n# include <ctime>\n# include <set>\n# include <forward_list>\n# include <map>\n# include <stack>\nusing namespace std;\n\n# define INF ((int)(1<<30))\n# define REP(i,n) for(int i=0;i<(int)n;i++)\n# define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();i++)\n# define TORAD 2.0*M_PI/360.0\n# define INT(x) int x;cin>>x;\n# define ALL(x) (x).begin(),(x).end()\n# define DEBUG(x) cout<<#x<<\" :\"<<x<<endl;\n# define EPS 1e-12\n\ntemplate<class T> void debug(T a) { for (auto i : a)cout << i << endl; }\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef pair<int, pii> piii;\nint dx[4] = { 0,-1,1,0 }, dy[4] = { 1,0,0,-1 };\n\nint clamp(int a, int mi, int ma)\n{\n\treturn max(mi, min(a, ma));\n}\nbool isnum(char a)\n{\n\treturn ('0' <= a&&a <= '9');\n}\nstring big(string a, string b)\n{\n\tif (a.size() > b.size())\n\t{\n\t\treturn a;\n\t}\n\tif (a.size() < b.size())\n\t{\n\t\treturn b;\n\t}\n\treturn max(a, b);\n}\n\n\nchar a[100][100]; \nstring flag[100][100];\nstring ans;\nvoid hoge(string &s, int y, int x)\n{\n\tif (s < flag[y][x])return;\n\tans = big(ans, s);\n\tflag[y][x] = s;\n\tint DY[2] = { 0,1 }, DX[2] = { 1,0 };\n\tREP(i, 2)\n\t{\n\t\tint Y = y + DY[i];\n\t\tint X = x + DX[i];\n\t\tif (isnum(a[Y][X]))\n\t\t{\n\t\t\ts += a[Y][X];\n\t\t\thoge(s, Y, X);\n\t\t\ts.pop_back();\n\t\t}\n\t}\n\n\treturn;\n}\n\n\n\nint main()\n{\n\tint w, h;\n\twhile (cin >> w >> h&&w)\n\t{\n\t\t\n\t\tREP(i, 100)REP(j, 100)\n\t\t{\n\t\t\ta[i][j] = 'a';\n\t\t\tflag[i][j] = \"\";\n\t\t}\n\t\tans = \"\";\n\t\tREP(i, h)\n\t\t{\n\t\t\tREP(j, w)\n\t\t\t{\n\t\t\t\tcin >> a[i][j];\n\t\t\t}\n\t\t}\n\t\t\n\t\tREP(y, h)\n\t\t{\n\t\t\tREP(x, w)\n\t\t\t{\n\t\t\t\tif (isnum(a[y][x]) && flag[y][x] == \"\" && a[y][x] != '0')\n\t\t\t\t{\n\t\t\t\t\tstring str; str += a[y][x];\n\t\t\t\t\thoge(str, y, x);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "///\n// File:  1126.cpp\n// Author: ymiyamoto\n//\n// Created on Sun Dec 10 00:54:34 2017\n//\n\n#include <cstdint>\n#include <iostream>\n#include <string>\n#include <vector>\n\nusing namespace std;\nbool bigger(string str1, string str2)\n{\n  if (str1.size() == str2.size()) {\n    return str1 < str2;\n  } else {\n    return str1.size() < str2.size();\n  }\n}\n\nstring wfs(vector<string> matrix, vector<vector<string>> &memo, uint32_t i, uint32_t j)\n{\n  if (i < matrix.size() && j < matrix[0].size() && memo[i][j] != \"\") return memo[i][j];\n\n  if (i >= matrix.size() || j >= matrix[0].size() || !isdigit(matrix[i][j]))\n    return \"\";\n  else {\n    string s1 = wfs(matrix, memo, i + 1, j);\n    string s2 = wfs(matrix, memo, i, j + 1);\n    return memo[i][j] = matrix[i][j] + (bigger(s1, s2) ? s2 : s1);\n  }\n}\n\nint32_t main()\n{\n  while (true) {\n    uint32_t W, H;\n    cin >> W >> H;\n    if (W == 0 && H == 0) break;\n    vector<string> matrix;\n    for (uint32_t i = 0; i < H; i++) {\n      string line;\n      cin >> line;\n      matrix.push_back(line);\n    }\n\n    string number = \"\";\n    vector<vector<string>> memo(H, vector<string>(W, \"\"));\n    for (int32_t i = matrix.size() - 1; i >= 0; i--) {\n      for (int32_t j = matrix[0].size() - 1; j >= 0; j--) {\n        if (matrix[i][j] == '0') continue;\n        string num = wfs(matrix, memo, i, j);\n        if (bigger(number, num)) {\n          number = num;\n        }\n      }\n    }\n    cout << number << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <queue>\n#include <utility>\n#include <map>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\ntypedef pair<int, int> P;\n\nconst int W = 70, H = 70;\nchar board[H][W];\nint w, h;\n\nbool comp(const string& a, const string& b){\n\tif(a.length() == b.length()){\n\t\tint l = a.length();\n\t\tfor(int i = 0;i < l;++i){\n\t\t\tif(a[i] == b[i]) continue;\n\t\t\telse{\n\t\t\t\treturn a[i] > b[i];\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\treturn a.length() > b.length();\n}\n\nvoid search(int x, int y, vector<string>* v){\n\tint dx[] = {1, 0}, dy[] = {0, 1};\n\tbool f;\n\tqueue<pair<P, string> > q;\n\tq.push(make_pair(make_pair(x, y), \"\"));\n\twhile(!q.empty()){\n\t\tf = false;\n\t\tpair<P, string> pair = q.front();\n\t\tq.pop();\n\t\tP p = pair.first;\n\t\tpair.second += board[p.second][p.first];\n\t\tfor(int i = 0;i < 2;++i){\n\t\t\tint nx = p.first + dx[i], ny = p.second + dy[i];\n\t\t\tif(0 <= nx && 0 <= ny && nx < w && ny < h && '0' <= board[ny][nx] && board[ny][nx] <= '9'){\n\t\t\t\tf = true;\n\t\t\t\tq.push(make_pair(make_pair(nx, ny), pair.second));\n\t\t\t}\n\t\t}\n\t\tif(!f) (*v).push_back(pair.second);\n\t}\n}\n\nint main(){\n\twhile(cin >> w >> h, w){\n\t\tvector<string> v;\n\t\tfor(int i = 0;i < h;++i){\n\t\t\tfor(int j = 0;j < w;++j){\n\t\t\t\tcin >> board[i][j];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < h;++i){\n\t\t\tfor(int j = 0;j < w;++j){\n\t\t\t\tif('0' <= board[i][j] && board[i][j] <= '9'){\n\t\t\t\t\tsearch(j, i, &v);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsort(v.begin(), v.end(), comp);\n\t\tstring ans = *(v.begin());\n\t\twhile(*(ans.begin()) == '0'){\n\t\t\tans.erase(ans.begin());\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define _overload3(_1, _2, _3, name, ...) name\n#define _rep(i, n) repi(i, 0, n)\n#define repi(i, a, b) for (int i = (a); i < (b); ++i)\n#define rep(...) _overload3(__VA_ARGS__, repi, _rep, )(__VA_ARGS__)\n#define ALL(x) x.begin(), x.end()\n#define chmax(x, y) x = max(x, y)\n#define chmin(x, y) x = min(x, y)\nusing namespace std;\nusing ll = long long;\nusing lld = long double;\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing VL = vector<ll>;\nusing VVL = vector<VL>;\nusing PII = pair<int, int>;\nrandom_device rnd;\nmt19937 mt(rnd());\n\nconst int IINF = 1 << 30;\nconst ll INF = 1ll << 60;\nconst ll MOD = 1e9 + 7;\nstring bigger(string &s, string &t)\n{\n    if (s.size() < t.size())\n    {\n        return t;\n    }\n    else if (t.size() < s.size())\n    {\n        return s;\n    }\n    else\n    {\n        return max(s, t);\n    }\n}\n\nvoid solve(int h, int w)\n{\n    vector<string> g(h);\n    rep(i, h)\n    {\n        cin >> g[i];\n    }\n    vector<vector<string>> dp(h, vector<string>(w, \"\"));\n    string ans = \"0\";\n    rep(i, h) rep(j, w)\n    {\n        if (isdigit(g[i][j]) == false)\n            continue;\n        string s = \"\",\n               t = \"\";\n        if (i > 0)\n        {\n            s = dp[i - 1][j];\n        }\n        if (j > 0)\n        {\n            t = dp[i][j - 1];\n        }\n        dp[i][j] = bigger(s, t);\n        if (g[i][j] != '0')\n        {\n            dp[i][j] += g[i][j];\n        }\n        else if (g[i][j] == '0' && dp[i][j].size() != 0)\n        {\n            dp[i][j] += \"0\";\n        }\n        ans = bigger(ans, dp[i][j]);\n    }\n    cout << ans << endl;\n}\n\nint main()\n{\n    int h, w;\n    while (cin >> w >> h, h)\n    {\n        solve(h, w);\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define vi vector<int>\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back\n#define pii pair<int,int>\n#define mp make_pair\n#define pi 3.14159265359\n#define shosu(X) fixed << setprecision(X)\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nbool isnum(char a){\n\treturn (a >= '0' && a <= '9');\n}\nstring removezero(string a){\n\tstring rst = \"\";\n\tbool flg = false;\n\tREP(i,a.size()){\n\t\tif(flg){\n\t\t\trst += a[i];\n\t\t}else{\n\t\t\tif(a[i] != '0'){\n\t\t\t\tflg = true;\n\t\t\t\trst += a[i];\n\t\t\t}\n\t\t}\n\t\t\n\t}\n\treturn rst;\n}\nstring getbig(string a,string b){\n\ta = removezero(a);\n\tb = removezero(b);\n\n\tif(a.size() < b.size()) return b;\n\telse if(a.size() > b.size()) return a;\n\tREP(i,a.size()){\n\t\tif(a[i] < b[i]) return b;\n\t}\n\treturn a;\n}\nint main(){\n\tint w,h;\n\tchar g[70][70];\n\tstring s[70][70];\n\twhile(1){\n\t\tstring ans = \"\";\n\t\tcin >> w >> h;\n\t\tif (w == 0 && h == 0) break;\n\t\tREP(i,h) REP(j,w) cin >> g[i][j];\n\t\tREP(i,h) REP(j,w) s[i][j] = \"\";\n\t\tREP(i,h){\n\t\t\tREP(j,w){\n\t\t\t\tif(!isnum(g[i][j])) continue;\n\t\t\t\tint lx = i; int ly = j-1;\n\t\t\t\tint ux = i-1; int uy = j;\n\t\t\t\tstring l,r;\n\t\t\t\tif(lx >= 0 && ly >= 0) l = s[lx][ly];\n\t\t\t\telse l = \"\";\n\t\t\t\tif(ux >= 0 && uy >= 0) r = s[ux][uy];\n\t\t\t\telse r = \"\";\n\t\t\t\tl.pb(g[i][j]);\n\t\t\t\tr.pb(g[i][j]);\n\t\t\t\ts[i][j] = getbig(l,r);\n\t\t\t\t//cout << l << \"??¨\" << r << \" big \" << s[i][j] << endl;\n\t\t\t\tans = getbig(ans,s[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n\nusing namespace std;\n\nbool compare(string S1, string S2)\n{\n\tif (S1.size() != S2.size()) { return S1.size() > S2.size(); }\n\n\treturn S1 > S2;\n}\n\nint main()\n{\n\tint H, W; cin.tie(0); ios::sync_with_stdio(false);\n\n\twhile (true)\n\t{\n\t\tscanf(\"%d\", &W);\n\t\tscanf(\"%d\", &H);\n\n\t\tif (H == 0 && W == 0) { break; }\n\n\t\tvector<string> R(H);\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tcin >> R[i];\n\t\t}\n\n\t\tvector<vector<string> > dp(H, vector<string>(W, \"\"));\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (isdigit(R[i][j]))\n\t\t\t\t{\n\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][j] = R[i][j];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i - 1][j] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]) && dp[i - 1][j] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i - 1][j] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (j != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i][j - 1] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]) && dp[i][j - 1] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i][j - 1] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ret = \"\";\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (compare(dp[i][j], ret))\n\t\t\t\t{\n\t\t\t\t\tret = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%s\\n\", ret.c_str());\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cctype>\n#include <vector>\nusing namespace std;\n\nint W, H;\nchar field[71][71];\nstring dp[71][71];\n\nbool compare(const string& s1, const string& s2){\n  if(s1.size() != s2.size()) return !(s1.size() > s2.size());\n else return !(s1 > s2);\n}\n\nvoid output(){  \n  for(int i = 0 ; i < H ; i++){\n    for(int j = 0 ; j < W ; j++){\n      cout << dp[i][j] << ' ';\n    }\n    cout << endl;\n  }\n}\n\nvoid init(){\n  for(int i = 0 ; i < 71 ; i++){\n    for(int j = 0 ; j < 71 ; j++){\n      dp[i][j] = \"\";\n    }\n  }\n}\n\nstring adjust(string s){\n  if(s.size() == 1) return s;\n  for(int i = 0 ; i < s.size() ; i++){\n    if(s[i] == '0') continue;\n    else{\n      //cout << s.substr(i) << endl;\n      return s.substr(i);\n    }\n  }\n}\n\nint main(){\n  while(cin >> W >> H){\n    if(W == 0 && H == 0) break;\n    init();\n    vector<string> vec;\n    vec.clear();\n    for(int i = 0 ; i < H ; i++){\n      for(int j = 0 ; j < W ; j++){\n\tcin >> field[i][j];\n      }\n    }\n    \n    string ans = \"\";\n    \n    for(int i = 0 ; i < H ; i++){\n      for(int j = 0 ; j < W ; j++){\n\tif(!isdigit(field[i][j])) continue;\n\tif(i == 0 && j == 0) dp[i][j] = field[i][j];\n\telse if(i == 0) dp[i][j] = dp[i][j-1] + field[i][j];\n\telse if(j == 0)\tdp[i][j] = dp[i-1][j] + field[i][j];\n\telse dp[i][j] = max(dp[i][j-1]+field[i][j], dp[i-1][j]+field[i][j], compare);\n\tvec.push_back(dp[i][j]);\n      }\n    }\n    for(int i = 0 ; i < vec.size() ; i++){\n      vec[i] = adjust(vec[i]);\n      ans = max(ans, vec[i], compare);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <vector>\n#include <map>\n#include <set>\n#include <string>\n#include <cstring>\n#include <sstream>\n#include <algorithm>\n#include <functional>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <iomanip>\n#include <list>\n#include <tuple>\n#include <bitset>\n\nusing namespace std;\n\ninline bool cheak(int x, int y, int xMax, int yMax){ return x >= 0 && y >= 0 && xMax > x && yMax > y; }\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout << x; return sout.str(); }\ntemplate<class T> inline T sqr(T x) { return x*x; }\n\ntypedef pair<int, int> P;\ntypedef tuple<int, int, int> T;\ntypedef long long ll;\ntypedef unsigned long long ull;\n\n#define For(i,a,b)\tfor(int (i) = (a);i < (b);(i)++)\n#define rep(i,n)\tFor(i,0,n)\n#define clr(a)\t\tmemset((a), 0 ,sizeof(a))\n#define mclr(a)\t\tmemset((a), -1 ,sizeof(a))\n#define all(a)\t\t(a).begin(),(a).end()\n#define sz(a)\t\t(sizeof(a))\n#define Fill(a,v)\tfill((int*)a,(int*)(a+(sz(a)/sz(*(a)))),v)\n\nconst int dx[8] = { -1, 0, -1, 0, 1, 1, -1, -1 }, dy[8] = { 0, -1, 0, 1, -1, 1, -1, 1 };\nconst int mod = 1000000007;\nconst int INF = 1e9;\n\nstring c[71];\nint w, h;\n\nstring d[71][71];\n\nint str_compare(string s1, string s2){\n\n\tif (s1.size() > s2.size())return 1;\n\tif (s1.size() < s2.size())return 0;\n\n\twhile (s1[0] == '0'){\n\t\ts1 = s1.substr(1, s1.size() - 1);\n\t}\n\twhile (s2[0] == '0'){\n\t\ts2 = s2.substr(1, s2.size() - 1);\n\t}\n\n\tif (s1.size() > s2.size())return 1;\n\tif (s1.size() < s2.size())return 0;\n\n\tif (s1.size() == s2.size()){\n\t\tif (s1 > s2)return 1;\n\t\tif (s1 < s2)return 0;\n\t\tif (s1 == s2)return -1;\n\t}\n}\n\nvoid func(int y,int x){\n\n\t\n\trep(i, 2){\n\t\tint ty = y + dy[i], tx = x + dx[i];\n\t\tif (cheak(tx, ty, w, h) && (c[ty][tx] >= '0' && c[ty][tx] <= '9')){\n\n\t\t\tstring t = (c[ty][tx]) + d[y][x];\n\t\t\tif (str_compare(d[ty][tx],t ) == 0){\n\t\t\t\td[ty][tx] = t;\n\t\t\t\tfunc(ty, tx);\n\t\t\t}\n\n\t\t}\n\t}\n}\n\nint main()\n{\n\twhile (cin >> w >> h && (w || h)){\n\t\trep(y, h){\n\t\t\tcin >> c[y];\n\t\t\trep(x,w)\n\t\t\tif (c[y][x] >= '0' && c[y][x] <= '9')d[y][x] = c[y][x];\n\t\t}\n\t\tfor (int y = h - 1; y >= 0; y--)\n\t\tfor (int x = w - 1; x >= 0; x--)if (c[y][x] >= '0' && c[y][x] <= '9'){\n\t\t\tfunc(y, x);\n\t\t}\n\n\t\tstring ans = \"0\";\n\n\t\trep(y, h)rep(x, w)if (c[y][x] >= '0' && c[y][x] <= '9') {\n\t\t\tif (str_compare(ans, d[y][x]) == 0){\n\t\t\t\tans = d[y][x];\n\t\t\t}\n\t\t}\n\t\twhile (ans[0] == '0'){\n\t\t\tans = ans.substr(1, ans.size() - 1);\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//=================================\n// Created on: 2018/07/06 04:08:37\n//=================================\n#include <bits/stdc++.h>\nusing namespace std;\nint main()\n{\n    for (int H, W;;) {\n        cin >> W >> H;\n        if (H == 0 and W == 0) { break; }\n        vector<string> f(H);\n        for (int i = 0; i < H; i++) { cin >> f[i]; }\n        using P = pair<int, string>;\n        vector<vector<P>> dp(H + 1, vector<P>(W + 1, P{0, \"\"}));\n        dp[H - 1][W - 1] = isalpha(f[H - 1][W - 1]) ? P{0, \"\"} : P{1, string(1, f[H - 1][W - 1])};\n        for (int sum = H + W - 3; sum >= 0; sum--) {\n            for (int y = min(sum, H - 1); y >= max(sum - W + 1, 0); y--) {\n                const int x = sum - y;\n                if (isalpha(f[y][x])) {\n                    dp[y][x] = P{0, \"\"};\n                    continue;\n                } else {\n                    dp[y][x] = max({dp[y][x], {dp[y][x + 1].first + 1, string(1, f[y][x]) + dp[y][x + 1].second}, {dp[y + 1][x].first + 1, string(1, f[y][x]) + dp[y + 1][x].second}});\n                }\n            }\n        }\n        P ans = P{0, \"\"};\n        for (int i = H - 1; i >= 0; i--) {\n            for (int j = W - 1; j >= 0; j--) { ans = max(ans, dp[i][j]); }\n        }\n        const string s = ans.second;\n        if (s == \"0\") {\n            cout << s << endl;\n        } else {\n            int nz = 0;\n            for (; s[nz] == '0'; nz++) {}\n            cout << s.substr(nz, s.size() - nz) << endl;\n        }\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<ctime>\n#include<cctype>\n#include<climits>\n#include<iostream>\n#include<iomanip>\n#include<string>\n#include<vector>\n#include<map>\n#include<list>\n#include<queue>\n#include<deque>\n#include<algorithm>\n#include<numeric>\n#include<utility>\n#include<complex>\n#include<memory>\n#include<functional>\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<ll> VL;\ntypedef vector<VL> VVL;\ntypedef pair<int, int> PII;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define MP make_pair\n#define PB push_back\n#define MOD 1000000007\n#define INF (1LL<<30)\n#define LLINF (1LL<<60)\n#define PI 3.14159265359\n#define EPS 1e-12\n//#define int ll\n\nstring s[100], dp[100][100];\nsigned main(void)\n{\n\twhile(true) {\n\t\tint w, h;\n\t\tcin >> w >> h;\n\t\tif(!w && !h) break;\n\t\tREP(i, h) cin >> s[i];\n\n\t\tREP(i, h) REP(j, w) {\n\t\t\tif(i == 0 && j == 0) {\n\t\t\t\tif('1' <= s[i][j] && s[i][j] <= '9') dp[i][j] = s[i][j];\n\t\t\t\telse dp[i][j] = \"0\";\n\t\t\t} else if(i == 0) {\n\t\t\t\tif('0' <= s[i][j] && s[i][j] <= '9') {\n\t\t\t\t\tdp[i][j] = dp[i][j-1] + s[i][j];\n\t\t\t\t} else {\n\t\t\t\t\tdp[i][j] = \"0\";\n\t\t\t\t}\n\t\t\t} else if(j == 0) {\n\t\t\t\tif('0' <= s[i][j] && s[i][j] <= '9') {\n\t\t\t\t\tdp[i][j] = dp[i-1][j] + s[i][j];\n\t\t\t\t} else {\n\t\t\t\t\tdp[i][j] = \"0\";\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif('0' <= s[i][j] && s[i][j] <= '9') {\n\t\t\t\t\tbool flag = false;\n\t\t\t\t\tif(dp[i-1][j].size() > dp[i][j-1].size()) flag = true;\n\t\t\t\t\tif(dp[i-1][j].size() == dp[i][j-1].size()) {\n\t\t\t\t\t\tREP(k, dp[i-1][j].size()) {\n\t\t\t\t\t\t\tif(dp[i-1][j][k] > dp[i][j-1][k]) {flag = true; break;}\n\t\t\t\t\t\t\telse if(dp[i-1][j][k] < dp[i][j-1][k]) {flag = false; break;}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(flag) {\n\t\t\t\t\t\tdp[i][j] = dp[i-1][j] + s[i][j];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i][j] = dp[i][j-1] + s[i][j];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tdp[i][j] = \"0\";\n\t\t\t\t}\n\t\t\t}\n\t\t\t//dp[i][j]???leading-zero????¶????\n\t\t\tint idx = 0;\n\t\t\tREP(k, dp[i][j].size()) {\n\t\t\t\tif(dp[i][j][k] != '0') {idx = k; break;}\n\t\t\t}\n\t\t\tstring tmp = \"\";\n\t\t\tFOR(k, idx, dp[i][j].size()) {\n\t\t\t\ttmp += dp[i][j][k];\n\t\t\t}\n\t\t\tdp[i][j] = tmp;\n\t\t}\n\t\tcout << \"b\" << endl;\n\t\tstring ret = \"0\";\n\t\tREP(i, h) REP(j, w) {\n\t\t\tbool flag = false;\n\t\t\tif(dp[i][j].size() > ret.size()) flag = true;\n\t\t\tif(dp[i][j].size() == ret.size()) {\n\t\t\t\tREP(k, dp[i][j].size()) {\n\t\t\t\t\tif(dp[i][j][k] > ret[k]) {flag = true; break;}\n\t\t\t\t\telse if(dp[i][j][k] < ret[k]) {flag = false; break;}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(flag) ret = dp[i][j];\n\t\t}\n\t\tcout << ret << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define MOD 1000000007\ntypedef long long ll;\nusing namespace std;\n\nstring maxs(string l,string r){\n    if(l.size()<r.size()) return r;\n    else if(l.size()==r.size()){\n        if(l<=r) return r;\n        else return l;\n    }else return l;\n}\n\nint H,W;\nchar C[100][100];\n\nstring dp[100][100];\n\nvoid solve(){\n    for(int i=0;i<H;i++){\n        for(int j=0;j<W;j++){\n            cin>>C[i][j];\n            dp[i][j]=\"\";\n        }\n    }\n\n    string ma=\"\";\n    for(int i=0;i<H;i++){\n        for(int j=0;j<W;j++){\n            if(C[i][j]<'0'||C[i][j]>'9') dp[i][j]=\"\";\n            else{\n                string up=\"\",le=\"\";\n                if(i-1>=0) up=dp[i-1][j];\n                if(j-1>=0) le=dp[i][j-1];\n\n                string res=maxs(up,le);\n                if(res==\"\"&&C[i][j]!='0') res=C[i][j];\n                else if(res==\"\"&&C[i][j]=='0') res=\"\";\n                else res=res+C[i][j];\n\n                dp[i][j]=res;\n            }\n            ma=maxs(ma,dp[i][j]);\n        }\n    }\n\n    cout<<ma<<endl;\n}\n\nint main(){\n  while(1){\n      cin>>W>>H;\n      if(W==0) break;\n      solve();\n  }\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cctype>\n\nusing namespace std;\n\nint main(void){\n  int w,h;\n  string grid[71],dp[71][71];\n\n  while(cin >> w >> h,w|h){\n    for(int i=0;i<71;i++)\n      for(int j=0;j<71;j++)dp[i][j].clear();\n\n    for(int i=0;i<h;i++)cin >> grid[i];\n\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(!isupper(grid[i][j])){\n\t  dp[i][j]=grid[i][j];\n\t  string a=\"\",b=\"\";\n\t  if(i>0 && !dp[i-1][j].empty())a=dp[i-1][j]+grid[i][j];\n\t  if(j>0 && !dp[i][j-1].empty())b=dp[i][j-1]+grid[i][j];\n\t  \n\t  while(a[0]=='0') a.erase(a.begin());\n\t  while(b[0]=='0') b.erase(b.begin());\n\n\t  if(a.empty() && !b.empty()){\n\t    dp[i][j]=b;\n\t    continue;\n\t  }\n\n\t  if(!a.empty() && b.empty()){\n\t    dp[i][j]=a;\n\t    continue;\n\t  }\n\n\t  if(a.empty() && b.empty())continue;\n\t  if(a.size()>b.size())dp[i][j]=a;\n\t  if(a.size()<b.size())dp[i][j]=b;\n\t  else if(a>b)dp[i][j]=a;\n\t  else dp[i][j]=b;\n\t}\n      }\n    }\n\n    string s=\"\";\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(s.size()<dp[i][j].size())s=dp[i][j];\n\telse if(s.size()>dp[i][j].size())s=s;\n\telse if(s<dp[i][j])s=dp[i][j];\n      }\n    }\n    cout << s << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <vector>\n#include <math.h>\n#include <set>\n#include <map>\n#include <string>\n#include <stack>\n#include <queue>\n#include <iomanip>\n#include <numeric>\n#include <tuple>\n#include <bitset>\n#include <complex>\n#include <unistd.h>\n#include <cassert>\n#include <cctype>\n#include <random>\n#define _USE_MATH_DEFINES\n#define _GLIBCXX_DEBUG\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> plglg;\ntypedef tuple<int, int, int> tiii;\ntypedef tuple<ll, ll, ll> tlglglg;\ntypedef complex<double> xy_t;\nint dx[4] = {1, 0, -1, 0};\nint dy[4] = {0, 1, 0, -1};\ndouble pi = 3.141592653589793;\nll mod = 1000000007;\nint intmax = 2147483647;\nint intmin = -2147483648;\nll llmax = 9223372036854775807;\nll llmin = -9223372036854775807;\nint iinf = intmax / 8;\nll inf = llmax / 8;\ndouble eps = 1e-11;\n\nint W, H;\nchar fld[80][80];\n\nstring bigger(string s, string t) {\n    int lens = s.size();\n    int lent = t.size();\n    if (lens < lent) {\n        return t;\n    } else if (lens > lent) {\n        return s;\n    } else {\n        for (int i = 0; i < lens; i++) {\n            char ss = s[i];\n            char tt = t[i];\n            if (ss < tt) {\n                return t;\n            } else if (ss > tt) {\n                return s;\n            }\n        }\n        return t;\n    }\n}\n\nstring dp[80][80];\n\nvoid solve(int W, int H) {\n    for (int i = 0; i < H + 10; i++) {\n        fill(dp[i], dp[i] + W + 10, \"\");\n    }\n    for (int i = H - 1; i >= 0; i--) {\n        for (int j = W - 1; j >= 0; j--) {\n            if (fld[i][j] != 'X') {\n                string s[2] = {\"\", \"\"};\n                for (int k = 0; k < 2; k++) {\n                    if (i + dx[k] < H && j + dy[k] < W) {\n                        if (fld[i + dx[k]][j + dy[k]] != 'X') {\n                            s[k] = dp[i + dx[k]][j + dy[k]];\n                        }\n                    }\n                }\n                dp[i][j] = fld[i][j] + bigger(s[0], s[1]);\n            }\n        }\n    }\n    string ans = \"\";\n    for (int i = 0; i < H; i++) {\n        for (int j = 0; j < W; j++) {\n            if (fld[i][j] != 'X' && fld[i][j] != '0') {\n                ans = bigger(ans, dp[i][j]);\n            }\n        }\n    }\n    cout << ans << endl;\n}\n\nint main() {\n    while (1) {\n        cin >> W >> H;\n        if (W == 0) {\n            break;\n        }\n        for (int i = 0; i < H; i++) {\n            string s;\n            cin >> s;\n            for (int j = 0; j < W; j++) {\n                if (s[j] >= '0' && s[j] <= '9') {\n                    fld[i][j] = s[j];\n                } else {\n                    fld[i][j] = 'X';\n                }\n            }\n        }\n        solve(W, H);\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "//include\n//------------------------------------------\n#include <vector>\n#include <list>\n#include <map>\n#include <climits>\n#include <set>\n#include <deque>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <queue>\n#include <random>\n#include <cctype>\n#include <complex>\n#include <regex>\n\nusing namespace std;\n\n#define C_MAX(a, b) ((a)>(b)?(a):(b))\n#define SHOW_VECTOR(v) {std::cerr << #v << \"\\t:\";for(const auto& xxx : v){std::cerr << xxx << \" \";}std::cerr << \"\\n\";}\n#define SHOW_MAP(v) {std::cerr << #v << endl; for(const auto& xxx: v){std::cerr << xxx.first << \" \" << xxx.second << \"\\n\";}}\n\nstring comp(const string s1, const string s2) {\n    if (s1.size() > s2.size()) return s1;\n    if (s1.size() < s2.size()) return s2;\n    if (s1.size() == s2.size()) {\n        for (int i = 0; i < s1.size(); i++) {\n            if (s1[i] > s2[i]) return s1;\n            if (s1[i] < s2[i])return s2;\n        }\n    }\n    return s1;\n}\n\nint main() {\n\n    while (true) {\n\n        int W, H;\n        cin >> W >> H;\n\n        if (W == 0 && H == 0) break;\n\n        vector<string> C(H);\n        for (int i = 0; i < H; i++)cin >> C[i];\n\n        vector<vector<string>> dp(H + 1, vector<string>(W + 1, \"\"));\n        for (int i = 1; i <= H; i++) {\n            for (int j = 1; j <= W; j++) {\n                if (!isdigit(C[i - 1][j - 1])) continue;\n                string s1 = dp[i - 1][j] + C[i - 1][j - 1];\n                string s2 = dp[i][j - 1] + C[i - 1][j - 1];\n                if (s1[0] == '0') s1 = s1.substr(1);\n                if (s2[0] == '0') s2 = s2.substr(1);\n                dp[i][j] = comp(s1, s2);\n            }\n        }\n\n        string ans = \"0\";\n        for (int i = 1; i <= H; i++) for (int j = 1; j <= W; j++) if (dp[i][j].size() > 0) ans = comp(ans, dp[i][j]);\n        cout << ans << endl;\n\n    }\n\n    return 0;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define For(i, a, b) for(int (i)=(int)(a); (i)<(int)(b); ++(i))\n#define rFor(i, a, b) for(int (i)=(int)(a)-1; (i)>=(int)(b); --(i))\n#define rep(i, n) For((i), 0, (n))\n#define rrep(i, n) rFor((i), (n), 0)\n#define fi first\n#define se second\nusing namespace std;\ntypedef long long lint;\ntypedef unsigned long long ulint;\ntypedef pair<int, int> pii;\ntypedef pair<int, lint> pil;\ntypedef pair<lint, lint> pll;\ntemplate<class T> bool chmax(T &a, const T &b){if(a<b){a=b; return true;} return false;}\ntemplate<class T> bool chmin(T &a, const T &b){if(a>b){a=b; return true;} return false;}\ntemplate<class T> T div_floor(const T a, const T b){return a>=0 ? a/b : (a+1)/b-1;}\ntemplate<class T> T div_ceil(const T a, const T b){return a>=0 ? (a-1)/b+1 : a/b;}\n\nconstexpr lint mod = 1e9+7;\nconstexpr lint INF = mod*mod;\nconstexpr int MAX = 100010;\n\nint dx[2] = {-1, 0};\nint dy[2] = {0, -1};\n\nint cmp(const string &a, const string &b){\n    int i=0, j=0;\n    while(i < a.size() && a[i] == '0') ++i;\n    while(j < b.size() && b[j] == '0') ++j;\n    if(a.size()-i < b.size()-j) return 1;\n    else if(a.size()-i > b.size()-j) return -1;\n    else{\n        while(i < a.size()){\n            if(a[i] < b[j]) return 1;\n            else if(a[i] > b[j]) return -1;\n            ++i;\n            ++j;\n        }\n        return 0;\n    }\n}\n\nint main(){\n    int w, h;\n    while(scanf(\"%d%d\", &w, &h) && w){\n        char c[h][w];\n        rep(i, h)rep(j, w) scanf(\" %c\", &c[i][j]);\n        string s[h][w];\n        string ans = \"0\";\n        rep(x, h)rep(y, w)if(isdigit(c[x][y])){\n            s[x][y] = c[x][y];\n            rep(i, 2){\n                int nx = x + dx[i], ny = y + dy[i];\n                if(0<=nx && nx<h && 0<=ny && ny<w && isdigit(c[nx][ny])){\n                    string tmp = s[nx][ny] + c[x][y];\n                    int cur = 0;\n                    while(cur < tmp.size() && tmp[cur] == '0') ++cur;\n                    tmp = tmp.substr(cur);\n                    if(cmp(s[x][y], tmp) == 1) s[x][y] = tmp;\n                }\n            }\n            if(cmp(ans, s[x][y]) == 1) ans = s[x][y];\n        }\n        cout << ans << \"\\n\";\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "\n// The Secret Number\n// http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#include<iostream>\n#include<vector>\n\nusing namespace std;\n\nint W, H;\nvector<string> matrix;\nvector<vector<string>> memo;\n\nint dx[3] = {1, 1, 0};\nint dy[3] = {0, 1, 1};\n\ninline bool is_out_of_range(int x, int y) {\n    return (x < 0 || x >= W || y < 0 || y >= H);\n}\n\nstring cmp(string a, string b) {\n    if (a.size() > b.size()) return a;\n    if (a.size() < b.size()) return b;\n    return max(a, b);\n}\n\nstring dfs(int x, int y, string seq) {\n    string ans = seq;\n    if (!isdigit(matrix[y][x])) return seq;\n    if (is_out_of_range(x, y)) return seq;\n    if (memo[y][x] != \"\") return memo[y][x];\n\n    for (int d = 0; d < 3; ++d) {\n        ans = cmp(ans, dfs(x + dx[d], y + dy[d], seq + matrix[y][x]));\n    }\n    return ans;\n}\n\nint main() {\n    while (cin >> W >> H && W) {\n        matrix = vector<string>(H, \"\"); \n        memo.assign(H, vector<string>(W, \"\"));\n        for (int h = 0; h < H; ++h) {\n            cin >> matrix[h];\n        }\n\n        string ans = \"\";\n        for (int y = 0; y < H; ++y) {\n            for (int x = 0; x < W; ++x) {\n                if (matrix[y][x] == '0' || !isdigit(matrix[y][x])) continue;\n                ans = cmp(ans, dfs(x, y, \"\"));\n            }\n        }\n\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<iostream>\n#include<string>\n#include<stdlib.h>\nusing namespace std;\nint W,H;\nchar M[80][80];\n\nstring cmp(string a,string b)\n{\n\tif(a==\"0\")a=\"\";\n\tif(b==\"0\")b=\"\";\n\tif(a.length()==b.length())\n\t\treturn a>b?a:b;\n\telse\n\t\treturn a.length()>b.length()?a:b;\n}\n\nint main()\n{\n\tfor(;scanf(\"%d%d\\n\",&W,&H),W+H;)\n\t{\n\t\tstring res=\"\";\n\t\tstring dp[80][80];\n\t\tfor(int i=0;i<H;i++)\n\t\t\tgets(M[i]);\n\t\tfor(int i=0;i<H;i++)\n\t\t\tfor(int j=0;j<W;j++)\n\t\t\t{\n\t\t\t\tif(M[i][j]<='9')\n\t\t\t\t{\n\t\t\t\t\tstring a=\"\",b=\"\",c=\"\";\n\t\t\t\t\tif('1'<=M[i][j]&&M[i][j]<='9')\n\t\t\t\t\t{\n\t\t\t\t\t\tchar s[2]=\"\";s[0]=M[i][j];\n\t\t\t\t\t\tc=string(s);\n\t\t\t\t\t}\n\t\t\t\t\tif(i>0)\n\t\t\t\t\t\ta=dp[i-1][j]+M[i][j];\n\t\t\t\t\tif(j>0)\n\t\t\t\t\t\tb=dp[i][j-1]+M[i][j];\n\t\t\t\t\tdp[i][j]=cmp(cmp(a,b),c);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdp[i][j]=\"\";\n\t\t\t\t}\n\t\t\t}\n\t\tfor(int i=0;i<H;i++)\n\t\t\tfor(int j=0;j<W;j++)\n\t\t\t\tres=cmp(res,dp[i][j]);\n\t\tcout<<res<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\n#include<algorithm>\n#define F first\n#define S second\nusing namespace std;\ntypedef pair<int,int> P;\ntypedef vector<vector<char> > VVC;\nint dx[] = {0,1};\nint dy[] = {1,0};\nvector<string> message;\nint h,w;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() != b.size())\n    return a.size() > b.size();\n\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] > b[i];\n  return true;\n}\n\nvoid dfs(string secret,P p,VVC& G)\n{\n  bool update = false;\n  for(int i=0;i<2;i++)\n    {\n      int nx = p.F + dx[i];\n      int ny = p.S + dy[i];\n      if(!(0 <= nx && nx < w && 0 <= ny && ny < h) || !('0'<=G[ny][nx] && G[ny][nx]<='9' ))\n\tcontinue;\n\n      update = true;\n      dfs(secret+G[ny][nx],P(nx,ny),G);\n    }\n\n  if(!update)\n    message.push_back(secret);\n}\n\nint main()\n{\n\n  while(cin >> w >> h,(w|h))\n    {\n      message.clear();\n      VVC G;\n      G.resize(h);\n      for(int i=0;i<h;i++)\n\t{\n\t  G[i].resize(w);\n\t  for(int j=0;j<w;j++)\n\t    cin >> G[i][j];\n\t}\n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\t      if('0' <= G[i][j] && G[i][j] <= '9')\n\t\t{\n\t\t  string message;\n\t\t  message += G[i][j];\n\t\t  dfs(message,P(j,i),G);\n\t\t}\n\t    }\n\t}\n\n      sort(message.begin(),message.end(),cmp);\n      cout << message[0] << endl;\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <utility>\n#include <cctype>\nusing namespace std;\n\nchar F[70][70];\n\n// s <= t ?\nbool compare(string s, string t) {\n  int ls, lt;\n  for(ls = 0; s[ls] == '0'; ++ls) ;\n  for(lt = 0; t[lt] == '0'; ++lt) ;\n  s = s.substr(ls);\n  t = t.substr(lt);\n  if(s.length() < t.length()) return true;\n  if(s.length() > t.length()) return false;\n  for(int i = 0; i < s.length(); ++i) {\n    if(s[i] > t[i]) return false;\n  }\n  return true;\n}\n\nint main() {\n  ios::sync_with_stdio(false);\n  while(true) {\n    int W, H; cin >> W >> H;\n    if(W == 0 && H == 0) break;\n    for(int i = 0; i < H; ++i) cin >> F[i];\n    string ans = \"0\";\n    queue<pair<string,pair<int,int>>> Q;\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        if(isdigit(F[i][j])) {\n          string s;\n          s.push_back(F[i][j]);\n          Q.emplace(make_pair(s,make_pair(i,j)));\n        }\n      }\n    }\n    string G[H][W];\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        G[i][j] = \"0\";\n      }\n    }\n    while(!Q.empty()) {\n      auto p = Q.front(); Q.pop();\n      if(compare(ans, p.first)) ans = p.first;\n      int i = p.second.first;\n      int j = p.second.second;\n      if(compare(G[i][j],p.first) == false) continue;\n      if(i + 1 < H && isdigit(F[i+1][j])) {\n        string s = p.first;\n        if(s == \"0\" && F[i+1][j] == '0') { }\n        else s.push_back(F[i+1][j]);\n        if(compare(s,G[i+1][j]) == false) {\n          G[i+1][j] = s;\n          Q.emplace(make_pair(s,make_pair(i+1,j)));\n        }\n      }\n      if(j + 1 < W && isdigit(F[i][j+1])) {\n        string s = p.first;\n        if(s == \"0\" && F[i][j+1] == '0') { }\n        else s.push_back(F[i][j+1]);\n        if(compare(s,G[i][j+1]) == false) {\n          G[i][j+1] = s;\n          Q.emplace(make_pair(s,make_pair(i,j+1)));\n        }\n      }\n    }\n    int l = 0;\n    while(ans[l] == '0') ++l;\n    ans = ans.substr(l);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <functional>\n#include <numeric>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <utility>\n#include <sstream>\n#include <complex>\n#include <fstream>\n#include <bitset>\n#include <time.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<ll, ll> P;\ntypedef vector<ll> V;\ntypedef complex<double> Point;\n\n#define PI acos(-1.0)\n#define EPS 1e-10\nconst ll INF = (1LL << 31) - 1;\nconst ll MOD = 1e9 + 7;\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define REP(i,N) for(int i=0;i<(N);i++)\n#define ALL(s) (s).begin(),(s).end()\n#define EQ(a,b) (abs((a)-(b))<EPS)\n#define EQV(a,b) ( EQ((a).real(), (b).real()) && EQ((a).imag(), (b).imag()) )\n#define fi first\n#define se second\n#define N_SIZE (1LL << 20)\n#define NIL -1\n#define MAX_N 100100 * 3\n\nint w, h;\nstring s[100];\n//bool f[100][100];\n\nint dx[2] = { 1,0 };\nint dy[2] = { 0,1 };\n\nvector<string> vs;\n\nbool c(int y, int x) {\n\tif (y >= 0 && y < h&&x >= 0 && x < w) {\n\t\treturn s[y][x] >= '0'&&s[y][x] <= '9';\n\t}\n\treturn false;\n}\n\nvoid solve(int y, int x, string num) {\n\t//f[y][x] = 1;\n\tnum += s[y][x];\n\tbool g = 1;\n\tREP(i, 2) {\n\t\tif (c(y + dy[i], x + dx[i])) {\n\t\t\tg = 0;\n\t\t\t/*if (!f[y + dy[i]][x + dx[i]])*/solve(y + dy[i], x + dx[i], num);\n\t\t}\n\t}\n\tif (g)vs.push_back(num);\n}\n\n\nint main() {\n\twhile (cin >> w >> h&&w + h) {\n\t\tvs.clear();\n\t\tREP(i, h)cin >> s[i];\n\t\tREP(i, h) {\n\t\t\tREP(j, w) {\n\t\t\t\t//f[i][j] = 1;\n\t\t\t\tif (s[i][j] == '0')continue;\n\t\t\t\tif (c(i, j))solve(i, j, \"\");\n\t\t\t}\n\t\t}\n\t\tsort(ALL(vs));\n\t\tstring ans[1000];\n\t\tREP(i, 1000)ans[i] = \"0\";\n\t\tREP(i, vs.size()) {\n\t\t\t//cout << vs[i] << \" \" << vs[i].size() << endl;\n\t\t\tans[vs[i].size()] = max(ans[vs[i].size()], vs[i]);\n\t\t}\n\t\tfor (int i = 1000 - 1; i >= 0; i--) {\n\t\t\tif (ans[i] != \"0\") {\n\t\t\t\tcout << ans[i] << endl;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define r(i,n) for(int i=0;i<n;i++)\nstring dp[70][70],m[70];\nint h,w;\nstring dfs(int y,int x,string s){\n  if(dp[y][x].size()>s.size())return dp[y][x];\n  if(dp[y][x].size()==s.size()&&dp[y][x]>s)return dp[y][x];\n  string p1,p2;\n  if(y+1<h&&'0'<=m[y+1][x]&&m[y+1][x]<='9')p1=dfs(y+1,x,\"\");\n  p1=m[y][x]+p1;\n  if(x+1<w&&'0'<=m[y][x+1]&&m[y][x+1]<='9')p2=dfs(y,x+1,\"\");\n  p2=m[y][x]+p2;\n  if(p1.size()>p2.size())return dp[y][x]=p1;\n  else if(p1.size()==p2.size()&&p1>p2)return dp[y][x]=p1;\n  else return dp[y][x]=p2;\n}\nint main(){\n  while(cin>>w>>h,w){\n    r(i,h)r(j,w)dp[i][j]=\"\";\n    string p=\"\";\n    r(i,h)cin>>m[i];\n    r(i,h)r(j,w)if('1'<=m[i][j]&&m[i][j]<='9'){\n      string q=\"\";\n      string t=dfs(i,j,q+m[i][j]);\n      if(t.size()>p.size())p=t;\n      else if(t.size()==p.size())p=max(t,p);\n    }\n    cout<<p<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<cassert>\n#include<iostream>\n#include<sstream>\n#include<string>\n#include<vector>\n#include<queue>\n#include<set>\n#include<map>\n#include<utility>\n#include<numeric>\n#include<algorithm>\n#include<bitset>\n#include<complex>\n\nusing namespace std;\n\ntypedef long long Int;\ntypedef vector<int> vint;\ntypedef pair<int,int> pint;\n#define mp make_pair\n\ntemplate<class T> void pv(T a, T b) { for (T i = a; i != b; ++i) cout << *i << \" \"; cout << endl; }\ntemplate<class T> void chmin(T &t, T f) { if (t > f) t = f; }\ntemplate<class T> void chmax(T &t, T f) { if (t < f) t = f; }\nint in() { int x; scanf(\"%d\", &x); return x; }\n\nstring dp[100][100];\nstring m[100];\n\nstring mymax(string a,string b){\n\tif(a.size()>b.size())return a;\n\tif(a.size()<b.size())return b;\n\tint i;\n\tfor(i=0;i<a.size();i++){\n\t\tif(a[i]>b[i])return a;\n\t\tif(a[i]<b[i])return b;\n\t}\n\treturn a;\n}\n\nint main() {\n\tint w,h;\n\twhile(cin>>w>>h,w){\n\t\tint i,j;\n\t\tstring res=\"0\";\n\t\tfor(i=0;i<h;i++){\n\t\t\tcin>>m[i];\n\t\t\tfor(j=0;j<w;j++){\n\t\t\t\tif('A'<=m[i][j]&&m[i][j]<='Z')dp[i][j]=\"\";\n\t\t\t\telse if(i==0&&j==0)dp[i][j]=m[i][j];\n\t\t\t\telse if(i==0)dp[i][j]=dp[i][j-1]+m[i][j];\n\t\t\t\telse if(j==0)dp[i][j]=dp[i-1][j]+m[i][j];\n\t\t\t\telse dp[i][j]=mymax(dp[i-1][j],dp[i][j-1])+m[i][j];\n\t\t\t\tres=mymax(res,dp[i][j]);\n\t\t\t\tif(dp[i][j]==\"0\")dp[i][j]=\"\";\n\t\t\t}\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define reep(i,a,b) for(int i=(a);i<(b);i++)\n#define rep(i,n) reep((i),0,(n))\nstring ans=\"\";\nstring tmp=\"\";\nvector<string> v;\nvector<vector<int>> vv;\nvector<vector<string>> dp;\nint w,h;\nbool check(int a,int b){\n    if(0<=a&&a<h&&0<=b&&b<w) return true;\n    return false;\n}\nstring cmp(string a,string b){\n    if(a.size()<b.size()) return b;\n    if(a.size()>b.size()) return a;\n    if(a>b) return a;\n    return b;\n}\nstring foo(int a,int b){\n    // tmp+=v[a].substr(b,1);\n    if(vv[a][b]) return dp[a][b];\n    vv[a][b]=1;\n    // if(ans.size()<tmp.size()) ans=tmp;\n    // else if(ans.size()==tmp.size()&&ans<tmp) ans=tmp;\n    string ret=\"\";\n    if(check(a+1,b)&&isdigit(v[a+1][b])) ret=cmp(ret,foo(a+1,b));\n    if(check(a,b+1)&&isdigit(v[a][b+1])) ret=cmp(ret,foo(a,b+1));\n    // tmp=tmp.substr(0,tmp.size()-1);\n    return dp[a][b]=v[a].substr(b,1)+ret;\n}\nint main(){\n    while(cin>>w>>h,h||w){\n        v.clear();\n        v=vector<string>(h);\n        vv=vector<vector<int>>(h,vector<int>(w,0));\n        dp=vector<vector<string>>(h,vector<string>(w,\"\"));\n        rep(i,h){\n            cin>>v[i];\n        }\n        ans=\"\";\n        rep(i,h){\n            rep(j,w){\n                if(isdigit(v[i][j])&&v[i][j]!='0'){\n                    if(vv[i][j]) continue;\n                    ans=cmp(ans,foo(i,j));\n                    // cout<<i<<\" \"<<j<<\" \"<<v[i][j]<<\" \"<<ans<<endl;\n                }\n            }\n        }\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\n#define REP(i,n) for(ll i=0;i<n;++i)\n#define RREP(i,n) for(ll i=n-1;i>=0;--i)\n#define FOR(i,m,n) for(ll i=m;i<n;++i)\n#define RFOR(i,m,n) for(ll i=n-1;i>=m;--i)\n#define ALL(v) (v).begin(),(v).end()\n#define PB(a) push_back(a)\n#define UNIQUE(v) v.erase(unique(ALL(v)),v.end());\n#define DUMP(v) REP(aa, (v).size()) { cout << v[a]; if (a != v.size() - 1)cout << \" \"; else cout << endl; }\n#define INF 1000000001ll\n#define MOD 1000000007ll\n#define EPS 1e-9\n\nconst int dx[8] = { 1,1,0,-1,-1,-1,0,1 };\nconst int dy[8] = { 0,1,1,1,0,-1,-1,-1 };\n\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef vector<vi> vvi;\ntypedef vector<vl> vvl;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\nll max(ll a, int b) { return max(a, ll(b)); }\nll max(int a, ll b) { return max(ll(a), b); }\nll min(ll a, int b) { return min(a, ll(b)); }\nll min(int a, ll b) { return min(ll(a), b); }\n///(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)(?´????????`)///\nint w, h;\nstring smax(string s, string t) {\n\t\n\tif (s.size() < t.size())return t;\n\tif (t.size() < s.size())return s;\n\tif (s.size() == 0)return t;\n\tif (t.size() == 0)return s;\n\n\tREP(i, s.size()) {\n\t\tif (s[i] < t[i])return t;\n\t\tif (s[i] > t[i])return s;\n\t}\n\treturn s;\n}\nstring dfs(vector<string> &v, vector<vector<string>> &dp, int x, int y) {\n\tif (x >= w || y >= h)return \"\";\n\tif (isalpha(v[y][x]))return \"\";\n\tif (dp[y][x] != \"\")return dp[y][x];\n\tstring ret = \"\";\n\tret += v[y][x];\n\tstring tmp;\n\ttmp = smax(tmp, dfs(v, dp, x + 1, y));\n\ttmp = smax(tmp, dfs(v, dp, x, y + 1));\n\treturn dp[y][x] = ret + tmp;\n\t\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\twhile (1) {\n\t\n\t\tcin >> w >> h;\n\t\tif (!w)break;\n\t\tvector<string> v(h);\n\t\tvector<vector<string>> dp(h, vector<string>(w, \"\"));\n\t\tREP(i, h)cin >> v[i];\n\t\t\n\t\tstring ans;\n\t\tREP(i, h) {\n\t\t\tREP(j, w) {\n\t\t\t\tif (dp[i][j] == \"\")dfs(v, dp, j, i);\n\t\t\t}\n\t\t}\n\t\tREP(i, h) {\n\t\t\tREP(j, w) {\n\t\t\t\tREP(p, dp[i][j].size()) {\n\t\t\t\t\tif (dp[i][j][p] != '0') {\n\t\t\t\t\t\tdp[i][j] = dp[i][j].substr(p);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif (p == dp[i][j].size() - 1)dp[i][j] = \"0\";\n\t\t\t\t}\n\t\t\t\tans = smax(ans, dp[i][j]);\n\t\t\t}\n\t\t}\n\t\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <sstream>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <vector>\n#include <string>\n#include <stack>\n#include <queue>\n#include <set>\n#include <map>\n#include <algorithm>\n#include <functional>\n#include <utility>\n#include <numeric>\n#include <iterator>\n\nusing namespace std;\n\ntypedef long long LL;\ntypedef unsigned long long ULL;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int,int> PII;\ntypedef vector<PII> VPII;\ntypedef istringstream ISS;\ntypedef ostringstream OSS;\n\n#define REP( i, m, n ) for ( int i = (int)( m ); i < (int)( n ); ++i )\n#define FOR( v, c ) for ( auto &v : c )\n#define EACH( it, c ) for ( auto it = c.begin(); it != c.end(); ++it )\n#define ALL( c ) (c).begin(), (c).end()\n#define DRANGE( c, p ) (c).begin(), (c).begin() + p, (c).end()\n\n#define PB( n ) push_back( n )\n#define MP( a, b ) make_pair( ( a ), ( b ) )\n#define EXIST( c, e ) ( (c).find( e ) != (c).end() )\n\n#define fst first\n#define snd second\n\n#define DUMP( x ) cerr << #x << \" = \" << ( x ) << endl\n#define DEBUG( x ) cerr << __FILE__ << \":\" << __LINE__ << \": \" << #x << \" = \" << ( x ) << endl\n\nint main()\n{\n\tcin.tie( 0 );\n\tios::sync_with_stdio( false );\n\n\tfor ( int w, h; cin >> w >> h, w | h; )\n\t{\n\t\tVS board( h );\n\t\tFOR( line, board )\n\t\t{\n\t\t\tcin >> line;\n\t\t}\n\n\t\tvector<VS> dp( h, VS( w, string( 72, '0' ) ) );\n\t\tstring res;\n\t\tREP( i, 0, h )\n\t\t{\n\t\t\tREP( j, 0, w )\n\t\t\t{\n\t\t\t\tif ( isdigit( board[i][j] ) )\n\t\t\t\t{\n\t\t\t\t\tif ( i && isdigit( board[ i - 1 ][j] ) )\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][j] = max( dp[i][j], dp[ i - 1 ][j] );\n\t\t\t\t\t}\n\t\t\t\t\tif ( j && isdigit( board[i][ j - 1 ] ) )\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][j] = max( dp[i][j], dp[i][ j - 1 ] );\n\t\t\t\t\t}\n\t\t\t\t\t( dp[i][j].erase( 0, 1 ) ) += board[i][j];\n\t\t\t\t}\n\t\t\t\tres = max( res, dp[i][j] );\n\t\t\t}\n\t\t}\n\n\t\tres.erase( 0, find_if( ALL( res ), bind1st( not_equal_to<char>(), '0' ) ) - res.begin() );\n\t\tcout << res << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<cctype>\nusing namespace std;\n\n#define MAX 72\n#define INV (-1)\n\nstruct Dig{\n\tvector<char> s;\n\tvector< pair<int,int> > pos;\n\tvoid push( char c, int i, int j ){\n\t\ts.push_back( c );\n\t\tpos.push_back( make_pair(i,j) );\n\t}\n\tvoid pop(){\n\t\ts.pop_back();\n\t\tpos.pop_back();\n\t}\n\tvoid simplify(){\n\t\twhile( true ){\n\t\t\tif( s.size() == 1 )\n\t\t\t\tbreak;\n\t\t\tif( s[0] == '0' ){\n\t\t\t\ts.erase( s.begin() );\n\t\t\t}else\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tbool operator<(const Dig &t){\n\t\tif( s.size() < t.s.size() )\n\t\t\treturn true;\n\t\telse if( s.size() == t.s.size() ){\n\t\t\tfor(unsigned int i = 0; i < s.size(); ++i){\n\t\t\t\tif( s[i] < t.s[i] )\n\t\t\t\t\treturn true;\n\t\t\t\telse\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n};\n\nvector< Dig > vdigs;\n\nvoid dfs(char map[MAX][MAX], int i, int j, Dig &d){\n\tconst int di[] = {1,0};\n\tconst int dj[] = {0,1};\n\tif( !isdigit( map[i][j] ) )\n\t\treturn ;\n\tbool bCanGoNext = false;\n\tfor(int k=0;k<2;++k){\n\t\tif( isdigit(map[i + di[k]][j + dj[k]] ) ){\n\t\t\td.push( map[i][j], i, j );\n\t\t\tbCanGoNext = true;\n\t\t\tdfs( map, i + di[k], j + dj[k], d );\n\t\t\td.pop();\n\t\t}\n\t}\n\tif( !bCanGoNext ){\n\t\td.push( map[i][j], i , j );\n\t\tvdigs.push_back( d );\n\t\td.pop();\n\t}\n}\nvoid ResetMap(char map[MAX][MAX]){\n\tfor(int i = 0; i < MAX; ++i){\n\t\tfor( int j = 0; j < MAX; ++j){\n\t\t\tmap[i][j] = INV;\n\t\t}\n\t}\n}\ntemplate<typename _T>\nostream &operator << (ostream &os, const vector<_T> &v){\n\tfor(unsigned int i = 0; i < v.size(); ++i){\n\t\tos << v[i];\n\t}\n\treturn os;\n}\n\nint LCS(const Dig &a, const Dig &b){\n\tint ret = 0;\n\tint table[MAX][MAX] = {{0,},};\n\tfor(unsigned int i = 1; i <= a.pos.size(); ++i){\n\t\tfor(unsigned int j = 1; j <= b.pos.size(); ++j){\n\t\t\tif( a.pos[i-1] == b.pos[j-1] ){\n\t\t\t\ttable[i][j] = 1 + table[i-1][j-1];\n\t\t\t}else{\n\t\t\t\ttable[i][j] = max( table[i-1][j], table[i][j-1] );\n\t\t\t}\n\t\t\tret = max( ret, table[i][j] );\n\t\t}\n\t}\n\treturn ret;\n}\n\nint main(){\t\n\twhile(true){\n\t\tint max_lcs = 0;\n\t\tvector< vector<int> > lcs_table;\n\t\tint H,W;\n\t\tDig d;\n\t\tDig ans;\n\t\tchar map[MAX][MAX];\n\n\t\tcin >> W >> H;\n\t\t\n\t\tif( W == 0 && H == 0 ) break;\n\t\tvdigs.clear();\n\t\tResetMap( map );\n\t\tfor(int i = 1; i <= H; ++i){\n\t\t\tstring s;\n\t\t\tcin >> s;\n\t\t\tfor(int j = 1; j <= W; ++j){\n\t\t\t\tmap[i][j] = s[j-1];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 1; i <= H; ++i){\n\t\t\tfor(int j = 1; j <= W; ++j){\n\t\t\t\tif( isdigit(map[i-1][j]) || isdigit(map[i][j-1]) )\n\t\t\t\t\tcontinue;\n\t\t\t\tdfs( map, i, j, d );\n\t\t\t}\n\t\t}\n\n\t\tfor(unsigned int i = 0; i < vdigs.size(); ++i){\n\t\t\tvdigs[i].simplify();\n\t\t}\n\n\t\tfor(unsigned int i = 0; i < vdigs.size(); ++i){\n\t\t\tvector<int> lcss;\n\t\t\tfor(unsigned int j = i + 1; j < vdigs.size(); ++j){\n\t\t\t\tint t = LCS( vdigs[i], vdigs[j] );\n\t\t\t\tlcss.push_back( t );\n\t\t\t\tmax_lcs = max( max_lcs, t );\n\t\t\t}\n\t\t\tlcs_table.push_back( lcss );\n\t\t}\n\t\t\n\t\tans.s.push_back('0');\n\t\tfor(unsigned int i = 0; i < vdigs.size(); ++i){\n\t\t\tfor(unsigned int j = i + 1; j < vdigs.size(); ++j){\n\t\t\t\tif( max_lcs == lcs_table[i][j - i - 1] ){\n\t\t\t\t\tif( vdigs[i] < vdigs[j] ){\n\t\t\t\t\t\tif( ans < vdigs[j] )\n\t\t\t\t\t\t\tans = vdigs[j];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif( ans < vdigs[i] )\n\t\t\t\t\t\t\tans = vdigs[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(unsigned int i = 0; i < vdigs.size(); ++i){\n\t\t\tvdigs[i].s.clear();\n\t\t\tvdigs[i].pos.clear();\n\t\t}\n\t\tcout << ans.s << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//The Secret Number\n#include<bits/stdc++.h>\nusing namespace std;\n\nint H, W;\nint mp[1000][1000];\nstring dp[1000][1000];\n\nstring max_comp(string s1, string s2){\n  if(s1.length() > s2.length())return s1;\n  if(s1.length() < s2.length())return s2;\n\n  for(int i=0; i<s1.length(); i++){\n    if(s1[i] > s2[i])return s1;\n    if(s1[i] < s2[i])return s2;\n  }\n  return s1; //??????\n}\n\nint main(){\n  while(cin >> W >> H, !(H==0 && W==0)){\n    //??\\???\n    for(int i=0; i<H; i++){\n      for(int j=0; j<W; j++){\n\tchar tmp;\n\tcin >> tmp;\n\tif('0'<=tmp && tmp<='9')mp[i][j] = tmp-'0';\n\telse mp[i][j] = -1;\n      }\n    }\n\n    //?????????\n    for(int i=0; i<H; i++)\n      for(int j=0; j<W; j++)\n\tdp[i][j]=\"\";\n\n    if(mp[H-1][W-1]!=-1)dp[H-1][W-1].insert(dp[H-1][W-1].begin(), mp[H-1][W-1]+'0');\n\n    for(int i=H-2; i>=0; i--){\n      if(mp[i][W-1] != -1){\n\tstring tmp = dp[i+1][W-1];\n\ttmp.insert(tmp.begin(), mp[i][W-1]+'0');\n\tdp[i][W-1] = tmp;\n      }\n    }\n    for(int j=W-2; j>=0; j--){\n      if(mp[H-1][j] != -1){\n\tstring tmp = dp[H-1][j+1];\n\ttmp.insert(tmp.begin(), mp[H-1][j]+'0');\n\tdp[H-1][j] = tmp;\n      }\n    }\n\n    //???????¨???????\n    for(int i=H-2; i>=0; i--){\n      for(int j=W-2; j>=0; j--){\n\tif(mp[i][j]==-1)continue; //??????????????????\n\tstring tmp1 = dp[i+1][j], tmp2 = dp[i][j+1];\n\ttmp1.insert(tmp1.begin(), mp[i][j]+'0');\n\ttmp2.insert(tmp2.begin(), mp[i][j]+'0');\n\tdp[i][j] = max_comp(tmp1, tmp2);\n      }\n    }\n\n    for(int i=0; i<H; i++)\n      for(int j=0; j<W; j++)\n\twhile(dp[i][j][0]=='0')dp[i][j].erase(dp[i][j].begin());\n\n    string ans = \"\";\n    for(int i=0; i<H; i++)\n      for(int j=0; j<W; j++)\n\tans = max_comp(ans, dp[i][j]);\n\n    while(ans[0]=='0')ans.erase(ans.begin());\n\n    if(ans==\"\")cout << \"0\" << endl;\n    else cout << ans << endl; \n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n#define ll long long\n#define INF (1<<30)\n#define LINF (1LL<<60)\n\n//http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#define MAXH 75\n#define MAXW 75\nvector<vector<string>> dp(MAXH, vector<string>(MAXW));\nvector<vector<int>> f(MAXH, vector<int>(MAXW));\nstring ans;\nint W, H;\n\ninline bool str_check(const string& a,const string&b) {\n\tif (a.size() > b.size()) return true;\n\telse if (a.size() < b.size()) return false;\n\telse {\n\t\tint Size = a.size();\n\t\tfor (int i = 0; i < Size;i++) {\n\t\t\tif (a[i] != b[i]) return a[i] > b[i] ? true : false;\n\t\t}\n\t}\n\treturn false;\n}\n\nvoid dfs(int h, int w, vector<vector<char>>& C) {\n\tf[h][w] = 1;\n\n\tbool dfs_f = false;\n\n\tif (f[h][w - 1] == 0 && C[h][w - 1] < 'A') {\n\t\tif (dp[h][w - 1] == \"-\") {\n\t\t\tdp[h][w - 1] = C[h][w - 1] + dp[h][w];\n\t\t\tdfs(h, w - 1, C);\n\n\t\t\tdfs_f = true;\n\t\t}\n\t\telse {\n\t\t\tif (str_check(C[h][w - 1] + dp[h][w], dp[h][w - 1])) {\n\t\t\t\tdp[h][w - 1] = C[h][w - 1] + dp[h][w];\n\t\t\t\tdfs(h, w - 1, C);\n\n\t\t\t\tdfs_f = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (f[h - 1][w] == 0 && C[h - 1][w] < 'A') {\n\t\tif (dp[h - 1][w] == \"-\") {\n\t\t\tdp[h - 1][w] = C[h - 1][w] + dp[h][w];\n\t\t\tdfs(h - 1, w, C);\n\n\t\t\tdfs_f = true;\n\t\t}\n\t\telse {\n\t\t\tif (str_check(C[h - 1][w] + dp[h][w], dp[h - 1][w])) {\n\t\t\t\tdp[h - 1][w] = C[h - 1][w] + dp[h][w];\n\t\t\t\tdfs(h - 1, w, C);\n\n\t\t\t\tdfs_f = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (!dfs_f) {\n\t\tif (str_check(dp[h][w], ans)) {\n\t\t\tans = dp[h][w];\n\t\t}\n\t}\n}\n\nint main() {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\twhile (cin >> W >> H) {\n\t\tif (W == 0 && H == 0) break;\n\t\tans = \"0\";\n\t\tfor (int i = 0; i < MAXH; i++) for (int j = 0; j < MAXW;j++) {\n\t\t\tdp[i][j] = \"-\";\n\t\t\tf[i][j] = 0;\n\t\t}\n\t\tvector<vector<char>> C(H + 2, vector<char>(W + 2, 'A'));\n\t\tfor (int i = 1; i <= H;i++) for (int j = 1; j <= W;j++) cin >> C[i][j];\n\n\t\tfor (int i = H; i > 0; i--) {\n\t\t\tfor (int j = W; j > 0;j--) {\n\t\t\t\tif (f[i][j] == 0 && C[i][j] < 'A') {\n\t\t\t\t\tdp[i][j] = C[i][j];\n\t\t\t\t\tdfs(i, j, C);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tbool zefo_flag = true;\n\t\tfor (int i = 0; i < ans.length();i++) {\n\t\t\tif (ans[i] == '0' && zefo_flag == true) continue;\n\t\t\tif (ans[i] != '0') zefo_flag = false;\n\t\t\tcout << ans[i];\n\t\t}\n\t\tcout << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cctype>\n#include <string>\n#include <algorithm>\n\nusing namespace std;\n\nstring myMax(string a, string b)\n{\n\tif (a.length() < b.length()) return b;\n\tif (a.length() > b.length()) return a;\n\n\tfor (int i = 0; i < a.length(); i++){\n\t\tif (a[i] < b[i]){\n\t\t\treturn b;\n\t\t}\n\t\tif (a[i] > b[i]){\n\t\t\treturn a;\n\t\t}\n\t}\n\treturn a;\n}\n\nstring retMax(string a, string b)\n{\n\t// 先頭の0をさくじょ\n\tstring c, d;\n\tbool pf = false;\n\tfor (int i = 0; i < a.length(); i++){\n\t\tif (pf || a[i] != '0'){\n\t\t\tc += a[i];\n\t\t\tpf = true;\n\t\t}\n\t}\n\tpf = false;\n\tfor (int i = 0; i < b.length(); i++){\n\t\tif (pf || b[i] != '0'){\n\t\t\td += b[i];\n\t\t\tpf = true;\n\t\t}\n\t}\n\ta = c;\n\tb = d;\n\n\t// 大小ひかく\n\tif (a.length() < b.length()) return b;\n\tif (a.length() > b.length()) return a;\n\n\tfor (int i = 0; i < a.length(); i++){\n\t\tif (a[i] < b[i]){\n\t\t\treturn b;\n\t\t}\n\t\tif (a[i] > b[i]){\n\t\t\treturn a;\n\t\t}\n\t}\n\treturn a;\n}\n\nint main(void)\n{\n\tint w, h;\n\twhile (cin >> w >> h, w && h){\n\t\tstring field[80];\n\t\tfor (int i = 0; i < h; i++){\n\t\t\tcin >> field[i];\n\t\t}\n\t\tstring dp[80][80] = {};\n\t\tstring ret;\n\t\t// 右下からやる\n\t\tfor (int i = h-1; 0 <= i; i--){\n\t\t\tfor (int j = w-1; 0 <= j; j--){\n\t\t\t\tif ('0' <= field[i][j] && field[i][j] <= '9'){\n\t\t\t\t\tdp[i][j] = myMax(field[i][j] + dp[i][j + 1], field[i][j] + dp[i + 1][j]);\n\t\t\t\t}\n\t\t\t\t// 0 を考慮した大小\n\t\t\t\tret = myMax(dp[i][j], ret);\n\t\t\t}\n\t\t}\n\n\t\t/*\n\t\tfor (int i = 0; i < h; i++){\n\t\t\tfor (int j = 0; j < w; j++){\n\t\t\t\tif (dp[i][j] != \"\") cout << dp[i][j] << \" \";\n\t\t\t\telse cout << \"* \";\n\t\t\t}\n\t\t\tputs(\"\");\n\t\t}\n\t\t*/\n\n\t\tbool pf = false;\n\t\tfor (int i = 0; i < ret.length(); i++){\n\t\t\tif (pf || ret[i] != '0'){\n\t\t\t\tcout << ret[i];\n\t\t\t\tpf = true;\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define MOD 1000000007\n#define INF 1000000010\n#define EPS 1e-9\n#define fst first\n#define scd second\n\n#define debug(x) cout<<x<<endl;\n#define repi(i,x,n) for(int i=x;i<n;i++)\n#define rep(i,n) repi(i,0,n)\n#define lp(i,n) repi(i,0,n)\n#define repn(i,n) for(int i=n;i>=0;i--)\n#define int long long\n#define endl \"\\n\"\n\n\nsigned main(){\n  cin.tie(0);\t\n  //ios::sync_with_stdio(false);\n  while(1){\n    int h,w;\n    cin>>w>>h;\n    if(h==0 && w==0) break;\n    char c[h][w];\n    rep(i,h){\n      rep(j,w){\n\tcin>>c[i][j];\n      }\n    }\n    string dp[h][w];\n    rep(i,h){\n      rep(j,w){\n\tdp[i][j]=\"0\";\n      }\n    }\n    string ans=\"0\";\n    rep(i,h){\n      rep(j,w){\n\tif(i>0){\n\t  if(isdigit(c[i-1][j]) && isdigit( c[i][j])){\n\t    string t=dp[i-1][j]+c[i][j];\n\t    if(t.size() > dp[i][j].size() ) dp[i][j]=t;\n\t    else if(t.size() == dp[i][j].size() ){\n\t      rep(k,t.size() ){\n\t\tif(t[k]>dp[i][j][k]){dp[i][j]=t;break;}\n\t\telse if(t[k]<dp[i][j][k]) break;\n\t      }\n\t    }\n\t  }\n\t}\n\t\n\tif(j>0){\n\t  if(isdigit(c[i][j-1] )&& isdigit( c[i][j])){\n\t    string t=dp[i][j-1]+c[i][j];\n\t    if(t.size() > dp[i][j].size() ) dp[i][j]=t;\n\t    else if(t.size() == dp[i][j].size() ){\n\t      rep(k,t.size() ){\n\t\tif(t[k]>dp[i][j][k]){dp[i][j]=t;break;}\n\t\telse if(t[k]<dp[i][j][k]) break;\n\t      }\n\t    }\n\t  }\n\t}\n\tif(isdigit(c[i][j])){\n\t  string tt={c[i][j]};\n\t  if(dp[i][j].size() == tt.size() && dp[i][j]<tt) dp[i][j]=tt;\n\t  if(ans.size() < dp[i][j].size() ) ans=dp[i][j];\n\t  else if(ans.size() == dp[i][j].size() ){\n\t    rep(k,ans.size() ){\n\t      if(ans[k]<dp[i][j][k]){ans=dp[i][j];break;}\n\t      else if(ans[k]>dp[i][j][k]) break;\n\t    }\n\t  }\n\t}\n\twhile(dp[i][j][0]=='0' && dp[i][j].size() > 0){\n\t  dp[i][j]=dp[i][j].substr(1);\n\t}\n      }\n      \n    }\n    /*rep(i,h){\n      rep(j,w){\n\tcout<<dp[i][j]<<\"    \";\n      }\n      cout<<endl;\n      }*/\n    \n    cout<<ans<<endl;\n  }\n\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nconst int dx[] = {1, 0};\nconst int dy[] = {0, 1};\n\nvector<string> board(80);\nstring memo[80][80];\nint W, H;\n\ninline bool isDigit(int x, int y)\n{\n    if ('0' <= board[y][x] && board[y][x] <= '9')\n        return true;\n    else\n        return false;\n}\n\nstring Rec(int x, int y)\n{\n    if (memo[y][x].size() != 0)\n        return memo[y][x];\n\n    string s, tmp;\n    for (int d = 0; d < 2; ++d) {\n        int nx = x + dx[d];\n        int ny = y + dy[d];\n\n        if (nx < 0 || nx >= W || ny < 0 || ny >= H || !isDigit(nx, ny))\n            continue;\n\n        tmp = Rec(nx, ny);\n        if (tmp.size() > s.size() || (tmp.size() == s.size() && tmp > s))\n            s = tmp;\n    }\n\n    return memo[y][x] = board[y][x] + s;\n}\n\nint main()\n{\n    while (cin >> W >> H, W || H) {\n        // Input\n        for (int i = 0; i < H; ++i)\n            cin >> board[i];\n\n        // Init\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                memo[i][j] = \"\";\n\n        // Solve\n        string tmp, ans;\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                if (isDigit(j, i)) {\n                    tmp = Rec(j, i);\n                    int index = 0;\n                    while (tmp[index] == '0')\n                        index++;\n                    tmp = tmp.substr(index);\n\n                    if (tmp.size() > ans.size() || (tmp.size() == ans.size() && tmp > ans))\n                        ans = tmp;\n                }\n\n        // Output\n        cout << ans << endl;\n//        cout << ans.substr(index) << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <limits.h>\n#include <math.h>\n#include <bitset>\n#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <iomanip>\n#include <iostream>\n\n#define VARIABLE(x) cerr << #x << \"=\" << x << endl\n#define BINARY(x) static_cast<bitset<16> >(x);\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define REP(i,m,n) for (int i=m;i<(int)(n);i++)\n#define if_range(x, y, w, h) if (0<=(int)(x) && (int)(x)<(int)(w) && 0<=(int)(y) && (int)(y)<(int)(h))\n\nconst int INF = 100000000;\ntypedef double D;\nconst double EPS = 1e-8;\nconst double PI = 3.14159;\nint dx[4]={-1, 0, 1, 0}, dy[4]={0, -1, 0, 1};\nusing namespace std;\ntypedef pair<int, int> P;\n\n/** Problem1126 : The Secret Number **/\nconst int MAX_W = 70;\nint W, H;\nchar field[MAX_W][MAX_W];\nstring dp[MAX_W][MAX_W];\n\nbool big(string s1, string s2) {\n\tif (s1.length() > s2.length()) {\n\t\treturn true;\n\t} else if (s2.length() > s1.length()) {\n\t\treturn false;\n\t} else {\n\t\treturn (s1>s2?true:false);\n\t}\n}\n\nbool big2(string s1, string s2) {\n\twhile (s1[0]=='0') s1.erase(s1.begin());\n\twhile (s2[0]=='0') s2.erase(s2.begin());\n\treturn big(s1, s2);\n}\n\nstring rec(int x, int y)\n{\n\tif (!('0' <= field[y][x] && field[y][x] <= '9'))\n\t\treturn dp[y][x] = \"\";\n\t\n\tstring s1 = field[y][x] + dp[y][x+1];\n\tstring s2 = field[y][x] + dp[y+1][x];\n\t\n\treturn dp[y][x] = (big2(s1, s2)?s1:s2);\n}\n\nstring nzero(string s) {\n\twhile (s[0]!='0') s.erase(s.begin());\n}\n\nint main()\n{\n\twhile (cin>>W>>H, W||H) {\n\t\tfill(dp[0], dp[0]+W*H, \"\");\n\t\t\n\t\trep(i, H) {\n\t\t\trep(j, W) {\n\t\t\t\tcin>>field[i][j];\n\t\t\t}\n\t\t}\n\t\t\n\t\tstring ans = \"0\";\n\t\trep(y, H) {\n\t\t\trep(x, W) {\n\t\t\t\tstring tmp = rec(W-x-1, H-y-1);\n\t\t\t\tans = (big2(ans, tmp)?ans:tmp);\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\twhile (ans[0]=='0') ans.erase(ans.begin());\n\t\t\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint W, H;\nvector<string> str;\nbool used[70][70];\nconst int dx[] = { 1, 0 };\nconst int dy[] = { 0, 1 };\n\n\nbool Comp(const string& l, const string& r) {\n\treturn l.size() == r.size() ? l < r : l.size() < r.size();\n}\n\nstring MAX(const string& l, const string& r) {\n\treturn Comp(l, r) ? r : l;\n}\n\nstring dfs(int x, int y) {\n\tstring res;\n\tfor (int i = 0; i < 2; i++) {\n\t\tint tx = x + dx[i], ty = y + dy[i];\n\t\tif (tx >= 0 && tx < H && ty >= 0 && ty < W && str[tx][ty] >= '0' && str[tx][ty] <= '9') {\n\t\t\tres = MAX(res, dfs(tx, ty));\n\t\t}\n\t}\n\tused[x][y] = true;\n\treturn str[x][y] + res;\n}\n\nint main()\n{\n\twhile (cin >> W >> H, W || H) {\n\t\tfor (int i = 0; i < H; i++) {\n\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\tused[i][j] = false;\n\t\t\t}\n\t\t}\n\t\tstr.resize(H);\n\t\tfor (int i = 0; i < H; i++) {\n\t\t\tcin >> str[i];\n\t\t}\n\t\tstring res;\n\t\tfor (int i = 0; i < H; i++) {\n\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\tif (!used[i][j] && str[i][j] >= '1' && str[i][j] <= '9') {\n\t\t\t\t\tres = MAX(res, dfs(i, j));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <deque>\n#include <list>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <utility>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <complex>\n#include <cmath>\n#include <limits>\n#include <cfloat>\n#include <climits>\n#include <ctime>\n#include <cassert>\nusing namespace std;\n\n#define rep(i,a,n) for(int (i)=(a); (i)<(n); (i)++)\n#define repq(i,a,n) for(int (i)=(a); (i)<=(n); (i)++)\n#define repr(i,a,n) for(int (i)=(a); (i)>=(n); (i)--)\n#define all(v) begin(v), end(v)\n#define pb(a) push_back(a)\n#define fr first\n#define sc second\n#define INF 2000000000\n#define int long long int\n\n#define X real()\n#define Y imag()\n#define EPS (1e-10)\n#define EQ(a,b) (abs((a) - (b)) < EPS)\n#define EQV(a,b) ( EQ((a).X, (b).X) && EQ((a).Y, (b).Y) )\n#define LE(n, m) ((n) < (m) + EPS)\n#define LEQ(n, m) ((n) <= (m) + EPS)\n#define GE(n, m) ((n) + EPS > (m))\n#define GEQ(n, m) ((n) + EPS >= (m))\n\ntypedef vector<int> VI;\ntypedef vector<VI> MAT;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\ntypedef complex<double> P;\ntypedef pair<P, P> L;\ntypedef pair<P, double> C;\n\nint dx[]={1, 0};\nint dy[]={0, 1};\nint const MOD = 1000000007;\nll mod_pow(ll x, ll n) {return (!n)?1:(mod_pow((x*x)%MOD,n/2)*((n&1)?x:1))%MOD;}\nint madd(int a, int b) {return (a + b) % MOD;}\nint msub(int a, int b) {return (a - b + MOD) % MOD;}\nint mmul(int a, int b) {return (a * b) % MOD;}\nint minv(int a) {return mod_pow(a, MOD-2);}\nint mdiv(int a, int b) {return mmul(a, minv(b));}\n\nnamespace std {\n    bool operator<(const P& a, const P& b) {\n        return a.X != b.X ? a.X < b.X : a.Y < b.Y;\n    }\n}\n\nint w, h;\nchar board[110][110];\nstring dp[110][110];\n\nstring comp(string s1, string s2) {\n    if(s1.length() == s2.length()) return max(s1, s2);\n    else if(s1.length() > s2.length()) return s1;\n    else return s2;\n}\n\nsigned main() {\n    while(cin >> w >> h, w||h) {\n        repq(i,0,h) repq(j,0,w) dp[i][j] = \"\";\n        repq(i,1,h) repq(j,1,w) cin >> board[i][j];\n        string ans = \"\";\n        repq(i,1,h) repq(j,1,w) {\n            if('A' <= board[i][j] && board[i][j] <= 'Z') dp[i][j] = \"\";\n            else {\n                string s1 = dp[i-1][j], s2 = dp[i][j-1];\n                string ma = comp(s1, s2);\n                // cout << \"s1 = \" << s1 << \", s2 = \" << s2 << \", ma = \" << ma << endl;\n                if(ma == \"\") {\n                    if(board[i][j] != '0') dp[i][j] += board[i][j];\n                }\n                else dp[i][j] = ma + board[i][j];\n            }\n            ans = comp(ans, dp[i][j]);\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n#define rep(i,n) for(int i=0;i<n;i++)\n\nint W, H;\nchar grid[70][70];\nint max_depth;\nvector<char> answer;\n\nconst int dx[2] = { 1,0 };\nconst int dy[2] = { 0,1 };\n\nvoid dfs(int y, int x, int depth, vector<char> now)\n{\n\tnow.push_back(grid[y][x]);\n\n\tif (depth > max_depth) {\n\t\tmax_depth = depth;\n\t\tanswer = now;\n\t}\n\telse if (depth == max_depth) {\n\t\tbool flag = false;\n\n\t\trep(i, max_depth) {\n\t\t\tif (now[i] > answer[i]) {\n\t\t\t\tflag = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse if (now[i] < answer[i]) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (flag == true) {\n\t\t\tanswer = now;\n\t\t}\n\t}\n\n\trep(i, 2) {\n\t\tint ny = y + dy[i];\n\t\tint nx = x + dx[i];\n\n\t\tif (ny < 0 || ny >= H || nx < 0 || nx >= W) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (grid[ny][nx] >= 'A'&&grid[ny][nx] <= 'Z') {\n\t\t\tcontinue;\n\t\t}\n\n\t\tdfs(ny, nx, depth + 1, now);\n\t}\n}\n\nint main()\n{\n\twhile (true) {\t\t\n\t\tcin >> W >> H;\n\n\t\tif (W == 0 && H == 0) {\n\t\t\tbreak;\n\t\t}\n\n\t\tmax_depth = 0;\n\t\tanswer.clear();\n\n\t\trep(y, H) {\n\t\t\trep(x, W) {\n\t\t\t\tcin >> grid[y][x];\n\t\t\t}\n\t\t}\n\n\t\tvector<char> start;\n\n\t\trep(y, H) {\n\t\t\trep(x, W) {\n\t\t\t\tif (grid[y][x] >= 'A'&&grid[y][x] <= 'Z') {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (grid[y][x] == '0') {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tdfs(y, x, 1, start);\n\t\t\t}\n\t\t}\n\n\t\trep(i, max_depth) {\n\t\t\tcout << answer[i];\n\t\t}\n\n\t\tcout << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <functional>\n#include <numeric>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <utility>\n#include <sstream>\n#include <complex>\n#include <fstream>\n#include <bitset>\n#include <time.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<ll, ll> P;\ntypedef vector<ll> V;\ntypedef complex<double> Point;\n\n#define PI acos(-1.0)\n#define EPS 1e-10\nconst ll INF = (1LL << 31) - 1;\nconst ll MOD = 1e9 + 7;\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define REP(i,N) for(int i=0;i<(N);i++)\n#define ALL(s) (s).begin(),(s).end()\n#define EQ(a,b) (abs((a)-(b))<EPS)\n#define EQV(a,b) ( EQ((a).real(), (b).real()) && EQ((a).imag(), (b).imag()) )\n#define fi first\n#define se second\n#define N_SIZE (1LL << 20)\n#define NIL -1\n#define MAX_N 100100 * 3\n\nint w, h;\nstring s[100];\nstring dp[100][100];\n\nint dx[2] = { 1,0 };\nint dy[2] = { 0,1 };\n\nbool c(int y, int x) {\n\tif (y >= 0 && y < h&&x >= 0 && x < w) {\n\t\treturn s[y][x] >= '0'&&s[y][x] <= '9';\n\t}\n\treturn false;\n}\n\nvoid solve(int y, int x, string num) {\n\tnum += s[y][x];\n\tif (dp[y][x].size() > num.size())return;\n\telse {\n\t\tif (dp[y][x] >= num)return;\n\t}\n\tdp[y][x] = num;\n\tREP(i, 2) {\n\t\tif (c(y + dy[i], x + dx[i])) {\n\t\t\tsolve(y + dy[i], x + dx[i], num);\n\t\t}\n\t}\n}\n\n\nint main() {\n\twhile (cin >> w >> h&&w + h) {\n\t\tREP(i, 100)REP(j, 100)dp[i][j] = \"\";\n\t\tREP(i, h)cin >> s[i];\n\t\tREP(i, h) {\n\t\t\tREP(j, w) {\n\t\t\t\tif (s[i][j] == '0')continue;\n\t\t\t\tif (c(i, j) && dp[i][j] == \"\")solve(i, j, \"\");\n\t\t\t}\n\t\t}\n\t\tstring ans[1000];\n\t\tREP(i, 1000)ans[i] = \"\";\n\t\tREP(i, 100) {\n\t\t\tREP(j, 100) {\n\t\t\t\tans[dp[i][j].size()] = max(ans[dp[i][j].size()], dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tfor (int i = 1000 - 1; i >= 0; i--) {\n\t\t\tif (!ans[i].empty()) {\n\t\t\t\tcout << ans[i] << endl;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cctype>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <string>\n#include <functional>\n#include <algorithm>\nusing namespace std;\n\ntypedef long long ll;\n\nchar mat[70][70];\nstring dp[72][72];\n\nstring cmp(string a, string b)\n{\n    if(a.size() > b.size()) {\n        return a;\n    } else if(a.size() < b.size()) {\n        return b;\n    } else {\n        if(a == b) \n            return a;\n        for(int i = 0; i < a.size(); i++) \n            if(a[i] > b[i])\n                return a;\n            else if(a[i] < b[i])\n                return b;\n    }\n}\n\nint main()\n{\n    int w, h;\n    while(cin >> w >> h && w && h) {\n        for(int i = 0; i < h; i++) {\n            for(int j = 0; j < w; j++) {\n                cin >> mat[i][j];\n            }\n        }\n\n        for(int i = 0; i < 72; i++) \n            for(int j = 0; j < 72; j++)\n                dp[i][j] = \"\";\n\n        string ret = \"\";\n        for(int i = 0; i < h; i++) {\n            for(int j = 0; j < w; j++) {\n                if(isdigit(mat[i][j])) {\n                    string more = cmp(dp[i + 1][j], dp[i][j + 1]);\n                    if(more == \"\" && mat[i][j] == '0')\n                        dp[i + 1][j + 1] = \"\";\n                    else \n                        dp[i + 1][j + 1] = more + string(1, mat[i][j]);\n\n                } else {\n                    dp[i + 1][j + 1] = \"\";\n                }\n                ret = cmp(ret, dp[i + 1][j + 1]);\n            }\n        }\n        cout << ret << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\ninline bool r(char a) {\n   if (a >= '0' && a <= '9') return true;\n   else return false;\n}\n\ninline bool x(string a, string b) {\n    if (a.size() > b.size()) return true;\n    else if (a.size() == b.size() && a > b) return true;\n    else return false;\n}\n\nint main(void){\n    int w, h;\n    while (cin>>w>>h && w) {\n        vector<string> g(h);\n        for (int i = 0; i < h; i++) cin >> g[i];\n        \n        vector<vector<string> > dp(h, vector<string>(w));\n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n                if (r(g[i][j])) dp[i][j] = g[i][j];\n            }\n        }\n        \n        string ans = \"\";\n        for (int i = h-1; i >= 0; i--) {\n            for (int j = w-1; j >= 0; j--) {\n                if (!r(g[i][j])) continue;\n                if (j-1 >= 0 && r(g[i][j-1])) {\n                    string t = g[i][j-1] + dp[i][j];\n                    if (x(t, dp[i][j-1])) dp[i][j-1] = t;\n                }\n                if (i-1 >= 0 && r(g[i-1][j])) {\n                    string t = g[i-1][j] + dp[i][j];\n                    if (x(t, dp[i-1][j])) dp[i-1][j] = t;\n                }\n                if (dp[i][j][0] != '0' && x(dp[i][j], ans)) ans = dp[i][j];\n            }\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n\nusing namespace std;\n\nbool compare(string S1, string S2)\n{\n\tif (S1.size() != S2.size()) { return S1.size() > S2.size(); }\n\n\treturn S1 > S2;\n}\n\nint main()\n{\n\tint H, W; char c[70];\n\n\twhile (true)\n\t{\n\t\tscanf(\"%d\", &W);\n\t\tscanf(\"%d\", &H);\n\n\t\tif (H == 0 && W == 0) { break; }\n\n\t\tvector<string> R;\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tscanf(\"%s\", c);\n\n\t\t\tR.push_back(c);\n\t\t}\n\n\t\tvector<vector<string> > dp(H, vector<string>(W, \"\"));\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (isdigit(R[i][j]))\n\t\t\t\t{\n\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][j] = R[i][j];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i - 1][j] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]) && dp[i - 1][j] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i - 1][j] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (j != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i][j - 1] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]) && dp[i][j - 1] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i][j - 1] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ret = \"\";\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (compare(dp[i][j], ret))\n\t\t\t\t{\n\t\t\t\t\tret = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%s\\n\", ret.c_str());\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define _ ios_base::sync_with_stdio(0);cin.tie(0);\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n\nusing namespace std;\n\nconst int MAX_W=70;\n\nchar c[MAX_W][MAX_W];\nint dp[MAX_W][MAX_W];\nchar str[MAX_W+1];\nint w,h;\nint len;\n\nbool isDigit(char c){return '0'<=c&&c<='9';}\n\nvoid dfs(int x,int y,int depth,bool write=false){\n  if(depth==len)return;\n  if(!write&&str[depth]>c[x][y])return;\n  if(str[depth]<c[x][y])write=true;\n  if(write)str[depth]=c[y][x];\n  int d=y+1<h?dp[y+1][x]:0;\n  int r=x+1<w?dp[y][x+1]:0;\n  if(d>r) dfs(x,y+1,depth+1,write);\n  else if(d<r) dfs(x+1,y,depth+1,write);\n  else{\n    dfs(x,y+1,depth+1,write);\n    dfs(x+1,y,depth+1,false);\n  }\n}\n\nint main(){ _;\n  while(cin>>w>>h,(w|h)!=0){\n    len=0;\n    REP(i,h)REP(j,w)cin>>c[i][j];\n    dp[h-1][w-1]=isDigit(c[h-1][w-1])?1:0;\n    for(int i=h-2;i>=0;i--) dp[i][w-1]=isDigit(c[i][w-1])?dp[i+1][w-1]+1:0;\n    for(int j=w-2;j>=0;j--) dp[h-1][j]=isDigit(c[h-1][j])?dp[h-1][j+1]+1:0;\n    for(int i=h-2;i>=0;i--){\n      for(int j=w-2;j>=0;j--){\n\tif(c[i][j]=='0'&&(i<=0||!isDigit(c[i-1][j]))&&(j<=0||!isDigit(c[i][j-1]))){\n\t  dp[i][j]=0;\n\t}else{\n\t  dp[i][j]=isDigit(c[i][j])?max(dp[i+1][j],dp[i][j+1])+1:0;\n\t}\n\tlen=max(dp[i][j],len);\n      }\n    }\n    REP(i,len)str[i]='0';\n    REP(i,h)REP(j,w){\n      if(dp[i][j]==len){\n\tdfs(j,i,0);\n      }\n    }\n    REP(l,len)cout<<str[l];\n    cout<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nint main() {\n\tint w, h;\n\twhile (cin >> w >> h, w){\n\t\tvector<string> vs(h);\n\t\tvector<vector<bool>> vvb(h);\n\t\tREP(i, h){\n\t\t\tcin >> vs[i];\n\t\t\tREP(j, w){\n\t\t\t\tvvb[i].push_back('0' <= vs[i][j] && vs[i][j] <= '9');\n\t\t\t}\n\t\t}\n\n\t\tvector<vector<int>> vvi(h);\n\t\tint max2 = 1;\n\t\tint x, y;\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tif (vvb[i][j]){\n\t\t\t\t\tint max = 1;\n\t\t\t\t\tif (i > 0 && vvb[i - 1][j])max = vvi[i - 1][j] + 1;\n\t\t\t\t\tif (j > 0 && vvb[i][j - 1])if (max < vvi[i][j - 1] + 1)max = vvi[i][j - 1] + 1;\n\t\t\t\t\tvvi[i].push_back(max);\n\t\t\t\t\tif (max > max2){\n\t\t\t\t\t\tmax2 = max;\n\t\t\t\t\t\t x = j;\n\t\t\t\t\t\t y = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tvvi[i].push_back(-1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvector<vector<int>> vvi2(h);\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tvvi2[i].push_back(-1);\n\t\t\t}\n\t\t}\n\t\tvvi2[y][x] = max2;\n\t\tqueue<int> qi;\n\t\tqi.push(max2 * 10000 + x * 100 + y);\n\t\twhile (!qi.empty()){\n\t\t\tint pos = qi.front(); qi.pop();\n\t\t\tint max3 = pos / 10000;\n\t\t\tint x2 = (pos / 100) % 100;\n\t\t\tint y2 = pos % 100;\n\t\t\tif (x2 > 0 && vvb[y2][x2 - 1] && vvi2[y2][x2 - 1]==-1){\n\t\t\t\tvvi2[y2][x2 - 1] = max3 - 1;\n\t\t\t\tqi.push((max3-1) * 10000 + (x2-1) * 100 + y2);\n\t\t\t}\n\t\t\tif (y2 > 0 && vvb[y2 - 1][x2] && vvi2[y2-1][x2] == -1){\n\t\t\t\tvvi2[y2 - 1][x2] = max3 - 1;\n\t\t\t\tqi.push((max3 - 1) * 10000 + x2 * 100 + (y2-1));\n\t\t\t}\n\t\t}\n\t\tchar max4 = '0' - 1;\n\t\tint x3, y3;\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tif (vvi2[i][j] == 1 && max4 < vs[i][j]){\n\t\t\t\t\tmax4 = vs[i][j];\n\t\t\t\t\tx3 = j;\n\t\t\t\t\ty3 = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ans;\n\t\tif(max4!='0')ans += max4;\n\t\tREP(i,max2-1){\n\t\t\tbool abb = false;\n\t\t\tmax4 = '0' - 1;\n\t\t\tif (y3 + 1 != h&&vvi2[y3+1][x3]>0 && max4 < vs[y3 + 1][x3]){\n\t\t\t\tmax4 = vs[y3 + 1][x3];\n\t\t\t\ty3 ++;\n\t\t\t\tabb = true;\n\t\t\t}\n\t\t\tif (abb){\n\t\t\t\tif (x3 + 1 != w&&vvi2[y3-1][x3 + 1]>0 && max4 < vs[y3-1][x3 + 1]){\n\t\t\t\t\tmax4 = vs[y3-1][x3 + 1];\n\t\t\t\t\tx3++;\n\t\t\t\t\ty3--;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif (x3 + 1 != w&&vvi2[y3][x3 + 1]>0 && max4 < vs[y3][x3 + 1]){\n\t\t\t\t\tmax4 = vs[y3][x3 + 1];\n\t\t\t\t\tx3++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!(ans.empty() && max4 == '0'))ans += max4;\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define INF 1001000100010001000\n#define MOD 1000000007\n#define EPS 1e-10\n#define int long long\n#define rep(i, N) for (int i = 0; i < N; i++)\n#define Rep(i, N) for (int i = 1; i < N; i++)\n#define For(i, a, b) for (int i = (a); i < (b); i++)\n#define pb push_back\n#define mp make_pair\n#define i_i pair<int, int>\n#define vi vector<int>\n#define vvi vector<vi >\n#define vb vector<bool>\n#define vvb vector<vb >\n#define vp vector< i_i >\n#define all(a) (a).begin(), (a).end()\n#define Int(x) int x; scanf(\"%lld\", &x);\n\n//int dxy[5] = {0, 1, 0, -1, 0};\n// assign\n\nvector< vector< char > > board;\nint n, m;\n\nbool comp(vector<char> &v1, vector<char> &v2);\nvoid search(int i, int j);\n\nsigned main()\n{\n    cin >> n >> m;\n    while (m) {\n        board.assign(m, vector<char>(n));\n        getchar();\n        rep(i, m) {\n            rep(j, n) {\n                cin >> board[i][j];\n            }\n        }\n        vector< vector< vector<char> > > dp(m, \n                vector<vector<char> >(n));\n        if ('1' <= board[0][0] && board[0][0] <= '9') {\n            dp[0][0].pb(board[0][0]);\n        }\n        rep(i, m) {\n            rep(j, n) {\n                if (dp[i][j].size()) {\n                    vector<char> tmp = dp[i][j];\n                    if (i+1 < m && '0' <= board[i+1][j]\n                            && board[i+1][j] <= '9') {\n                        tmp.pb(board[i+1][j]);\n                        if (comp(tmp, dp[i+1][j])) {\n                            dp[i+1][j] = tmp;\n                        }\n                        tmp.pop_back();\n                    }\n                    if (j+1 < n && '0' <= board[i][j+1]\n                            && board[i][j+1] <= '9') {\n                        tmp.pb(board[i][j+1]);\n                        if (comp(tmp, dp[i][j+1])) {\n                            dp[i][j+1] = tmp;\n                        }\n                        tmp.pop_back();\n                    }\n                } else {\n                    if (i+1 < m && '1' <= board[i+1][j]\n                            && board[i+1][j] <= '9'\n                            && !dp[i+1][j].size()) {\n                        dp[i+1][j].pb(board[i+1][j]);\n                    }\n                    if (j+1 < n && '1' <= board[i][j+1]\n                            && board[i][j+1] <= '9'\n                            && !dp[i][j+1].size()) {\n                        dp[i][j+1].pb(board[i][j+1]);\n                    }\n                }\n            }\n        }\n        vector<char> ans;\n        rep(i, m) {\n            rep(j, n) {\n                if (comp(dp[i][j], ans)) {\n                    ans = dp[i][j];\n                }\n            }\n        }\n        for (char i : ans) {\n            cout << i;\n        }\n        cout << endl;\n\n        cin >> n >> m;\n    }\n    return 0;\n}\n\nbool comp(vector<char> &v1, vector<char> &v2)\n{\n    if (v2.size() < v1.size() ) {\n        return true;\n    } else if (v2.size() == v1.size() ) {\n        rep(i, v2.size()) {\n            if (v1[i] > v2[i]) {\n                return true;\n            } else if (v1[i] < v2[i]) {\n                return false;\n            }\n        }\n    }\n    return false;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <limits.h>\n#include <map>\n#include <math.h>\n#include <numeric>\n#include <set>\n#include <stack>\n#include <stdlib.h>\n#include <string>\n#include <vector>\n#define el endl\n#define fd fixed\n#define INF INT_MAX/2-1\n#define pb push_back\n#define mp make_pair\n#define sp fd << setprecision\nusing namespace std;\nint dx[] = {1, 0, -1, 0}, dy[] = {0, 1, 0, -1};\ntypedef vector<int> VI;\ntypedef vector<vector<int> > VVI;\ntypedef vector<string> VS;\n\nvector<string> ans;\n\nvoid search(VVI code, int i, int j, string tmp, int w, int h) {\n  if (code[i][j] < 0) return;\n  tmp += (char)(code[i][j]+48);\n  if ((i < h-1 && j < w-1 && code[i+1][j] < 0 && code[i][j+1] < 0) || (i < h-1 && j == w-1 && code[i+1][j] < 0) || (i == h-1 && j < w-1 && code[i][j+1]) || (i == h-1 && j == w-1)) ans.pb(tmp);\n  if (i < h-1) search(code, i+1, j, tmp, w, h);\n  if (j < w-1) search(code, i, j+1, tmp, w, h);\n}\n\nint main() {\n  int w, h;\n  while (cin >> w >> h, w | h) {\n    VVI code;\n    string s;\n    ans.clear();\n    for (int i = 0; i < h; i++) {\n      VI tv;\n      cin >> s;\n      for (int j = 0; j < s.length(); j++) {\n        int tn = (int)(s[j]-'0');\n        if (0 <= tn && tn <= 9) {\n          tv.pb(tn);\n        } else {\n        tv.pb(-1);\n        }\n      }\n      code.pb(tv);\n    }\n    for (int i = 0; i < h; i++) {\n      for (int j = 0; j < w; j++) {\n        search(code, i, j, \"\", w, h);\n      }\n    }\n    int max_digit = 0;\n    string max_num = \"\";\n    for (int i = 0; i < ans.size(); i++) {\n      if (max_digit < ans[i].length()) max_num = ans[i], max_digit = ans[i].length();\n    }\n    if (max_num[0] == '0') max_num.erase(max_num.begin());\n    cout << max_num << el;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define vi vector<int>\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back\n#define pii pair<int,int>\n#define mp make_pair\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nint w,h;\nvector<string> data;\nint dx[2]={1,0};\nint dy[2]={0,1};\nbool sudeni[100][100];\n\nbool inrange(int x,int y){ \n\tif(x<0||y<0||x>h-1||y>w-1) return false;\n\telse return true;\n}\nstring rmzero(string a){\n\tstring str=\"\";\n\tbool f = false;\n\tREP(i,a.size()){\n\t\tif(!f){\n\t\t\tif(a[i]!='0') {\n\t\t\t\tstr+=a[i];\n\t\t\t\tf = true;\n\t\t\t}\n\t\t}else{\n\t\t\tstr+=a[i];\n\t\t}\n\t}\n\treturn str;\n}\n\nstring getbigger(string a,string b,bool ff){\n\tif(ff) {a = rmzero(a); b = rmzero(b);}\n\tif(a.size()!=b.size()){\n\t\tif(a.size()>b.size()) return a;\n\t\telse return b;\n\t}\n\telse{\n\t\tREP(i,a.size()){\n\t\t\tif(a[i]==b[i]) continue;\n\t\t\tif(a[i]>b[i]) return a;\n\t\t\telse  return b;\n\t\t}\n\t\treturn a;//eq\n\t}\n}\n\nstring solve(int px,int py){\n\tstring rst = \"\";\n\tif(!inrange(px,py)) return \"\";\n\tsudeni[px][py] = true;\n\tif('0'<=data[px][py] && data[px][py]<='9') {\n\t\trst+=data[px][py];\n\t}\n\tvector<string> tmp;\n\tREP(i,2){\n\t\ttmp.pb(\"\");\n\t\tint nx = px + dx[i];\n\t\tint ny = py + dy[i];\n\t\tif(inrange(nx,ny) && sudeni[nx][ny]==false &&'0'<=data[nx][ny] && data[nx][ny]<='9') {\n\t\t\ttmp[i]=solve(nx,ny);\n\t\t}\n\t}\n\trst += getbigger(tmp[0],tmp[1],false);\n\treturn  rst;\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(w==0&&h==0) break;\n\t\tdata.clear();\n\t\tREP(i,h){\n\t\t\tstring tmp;\n\t\t\tcin >> tmp;\n\t\t\tdata.pb(tmp);\n\t\t}\n\t\tstring ans = \"0\";\n\t\tREP(i,100) REP(j,100) sudeni[i][j]=false;\n\t\tREP(i,h){\n\t\t\tREP(j,w){\n\t\t\t\tif(sudeni[i][j]==false&&data[i][j]>='1'&&data[i][j]<='9') ans = getbigger(solve(i,j),ans,true);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define _ ios_base::sync_with_stdio(0);cin.tie(0);\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n\nusing namespace std;\n\nconst int MAX_W=70;\n\nchar c[MAX_W][MAX_W];\nint dp[MAX_W][MAX_W];\nchar str[MAX_W+1];\nbool checked[MAX_W][MAX_W];\nint w,h;\nint len;\n\nbool isDigit(char c){return '0'<=c&&c<='9';}\n\nvoid dfs(int x,int y,int depth,bool write=false){\n  if(depth==len)return;\n  if(!write&&str[depth]>c[y][x])return;\n  if(checked[y][x])return;\n  checked[y][x]=true;\n  if(str[depth]<c[y][x])write=true;\n  if(write)str[depth]=c[y][x];\n  int d=y+1<h?dp[y+1][x]:0;\n  int r=x+1<w?dp[y][x+1]:0;\n  if(d>r) dfs(x,y+1,depth+1,write);\n  else if(d<r) dfs(x+1,y,depth+1,write);\n  else{\n    dfs(x,y+1,depth+1,write);\n    dfs(x+1,y,depth+1,false);\n  }\n}\nvoid search(int x,int y,int depth){\n  REP(i,h)REP(j,w)checked[i][j]=false;\n  dfs(x,y,depth);\n}\n\nint main(){ _;\n  while(cin>>w>>h,(w|h)!=0){\n    REP(i,h)REP(j,w)cin>>c[i][j];\n    dp[h-1][w-1]=isDigit(c[h-1][w-1])?1:0;\n    for(int i=h-2;i>=0;i--){\n      dp[i][w-1]=isDigit(c[i][w-1])?dp[i+1][w-1]+1:0;\n    }\n    for(int j=w-2;j>=0;j--){\n      dp[h-1][j]=isDigit(c[h-1][j])?dp[h-1][j+1]+1:0;\n    }\n    for(int i=h-2;i>=0;i--){\n      for(int j=w-2;j>=0;j--){\n\tdp[i][j]=isDigit(c[i][j])?max(dp[i+1][j],dp[i][j+1])+1:0;\n      }\n    }\n    len=0;\n    REP(i,h)REP(j,w){\n      if(c[i][j]=='0'){\n\tif((i<=0||dp[i-1][j]==0)&&(j<=0||dp[i][j-1]==0))\n\t  dp[i][j]=0;\n      }\n      len=max(dp[i][j],len);\n    }\n    REP(i,len)str[i]='0';\n    REP(i,h)REP(j,w){\n      if(dp[i][j]==len){\n\tsearch(j,i,0);\n      }\n    }\n    REP(l,len)cout<<str[l];\n    cout<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cmath>\nusing namespace std;\n\nint main() {\n    int W, H;\n    while(cin >> W >> H, W) {\n        vector<string> v(H);\n        for(int i=0; i<H; ++i) {\n            cin >> v[i];\n        }\n        vector<vector<string>> ret(H, vector<string>(W));\n        string ret2;\n        for(int h=0; h<H; ++h) {\n            for(int w=0; w<W; ++w) {\n                if('0' <= v[h][w] && v[h][w] <= '9') {\n                    string s;\n                    if(h-1 >= 0) {\n                        s = ret[h-1][w];\n                    }\n                    if(w-1 >= 0) {\n                        if(s.size() < ret[h][w-1].size() || s.size() == ret[h][w-1].size() && s < ret[h][w-1]) {\n                            s = ret[h][w-1];\n                        }\n                    }\n                    if(v[h][w] == '0' && s.size() == 0) {\n                        continue;\n                    } else {\n                        ret[h][w] = s + v[h][w];\n                        if(ret2.size() < ret[h][w].size() || ret2.size() == ret[h][w].size() && ret2 < ret[h][w]) {\n                            ret2 = ret[h][w];\n                        }\n                    }\n                }\n            }\n        }\n        cout << ret2 << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\n#include <ctype.h>\n#include <string> \n#include <cstring>\n#include <sstream>\n#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <map>\n#include <queue>\n#include <utility>\n#include <vector>\n#include <set>\n#include <iomanip>\n#include <stack>\n  \nusing namespace std;\n\n#define pi 3.141592653589793\n\n#define MAX 1000000000\n\nbool ismax(string comp1, string comp2)\n{\n\t// 第一引数の方が大きい場合true\n\twhile(comp1[0] == '0') comp1.erase(0, 1);\n\twhile(comp2[0] == '0') comp2.erase(0, 1);\n\tif(comp1.length() > comp2.length()) return true;\n\telse if(comp1.length() == comp2.length()){\n\t\tint n = 0;\n\t\twhile(n < comp1.length() && comp1[n] == comp2[n]){\n\t\t\tn++;\n\t\t}\n\t\tif(n == comp1.length() || comp1[n] - '0' > comp2[n] - '0') return true;\n\t\telse return false;\n\t} else return false;\n}\n\nstring solve(int w, int h, char c[71][71])\n{\n\tstring ans = \"\";\n\tstring result[72][72];\n\tresult[h][w] = \"\";\n\tif(isdigit(c[h][w])) result[h][w] += c[h][w];\n\tfor(int i = h; i > 0; i--){\n\t\tresult[i][w + 1] = \"\";\n\t}\n\tfor(int i = w; i > 0; i--){\n\t\tresult[h + 1][i] = \"\";\n\t}\n\tfor(int i = h; i > 0; i--){\n\t\tfor(int j = w; j > 0; j--){\n\t\t\tresult[i][j] = \"\";\n\t\t\tif(isdigit(c[i][j])){\n\t\t\t\tresult[i][j] += c[i][j];\n\t\t\t\tif(ismax(result[i + 1][j], result[i][j + 1])) result[i][j] += result[i + 1][j];\n\t\t\t\telse result[i][j] += result[i][j + 1];\n\t\t\t\tif(ismax(result[i][j], ans)) ans = result[i][j];\n\t\t\t}\n\t\t}\n\t}\n\treturn ans;\n}\n\n\nint main()\n{\n\tint w, h;\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(w == 0 && h == 0) break;\n\t\tchar c[71][71];\n\t\tfor(int i = 1; i < h + 1; i++){\n\t\t\tfor(int j = 1; j < w + 1; j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t}\n\t\t}\n\t\tcout << solve(w, h, c) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <limits.h>\n#include <map>\n#include <math.h>\n#include <numeric>\n#include <set>\n#include <stack>\n#include <stdlib.h>\n#include <string>\n#include <vector>\n#define el endl\n#define fd fixed\n#define INF INT_MAX/2-1\n#define pb push_back\n#define mp make_pair\n#define sp fd << setprecision\nusing namespace std;\nint dx[] = {1, 0, -1, 0}, dy[] = {0, 1, 0, -1};\ntypedef vector<int> VI;\ntypedef vector<vector<int> > VVI;\ntypedef vector<string> VS;\n\nvector<string> ans;\nbool memo[70][70];\n\nvoid search(VVI code, int i, int j, string tmp, int w, int h) {\n  if (code[i][j] < 0) return;\n  tmp += (char)(code[i][j]+48);\n  memo[i][j] = true;\n  if ((i < h-1 && j < w-1 && code[i+1][j] < 0 && code[i][j+1] < 0) || (i < h-1 && j == w-1 && code[i+1][j] < 0) || (i == h-1 && j < w-1 && code[i][j+1]) || (i == h-1 && j == w-1)) ans.pb(tmp);\n  if (i < h-1) search(code, i+1, j, tmp, w, h);\n  if (j < w-1) search(code, i, j+1, tmp, w, h);\n}\n\nint main() {\n  int w, h;\n  while (cin >> w >> h, w | h) {\n    VVI code;\n    string s;\n    ans.clear();\n    for (int i = 0; i < 70; i++) {\n      for (int j = 0; j < 70; j++) {\n        memo[i][j] = false;\n      }\n    }\n    for (int i = 0; i < h; i++) {\n      VI tv;\n      cin >> s;\n      for (int j = 0; j < s.length(); j++) {\n        int tn = (int)(s[j]-'0');\n        if (0 <= tn && tn <= 9) {\n          tv.pb(tn);\n        } else {\n        tv.pb(-1);\n        }\n      }\n      code.pb(tv);\n    }\n    for (int i = 0; i < h; i++) {\n      for (int j = 0; j < w; j++) {\n        if (!memo[i][j]) search(code, i, j, \"\", w, h);\n      }\n    }\n    int max_digit = 0;\n    string max_num = \"\";\n    for (int i = 0; i < ans.size(); i++) {\n      if (ans[i][0] == '0') ans[i].erase(ans[i].begin());\n      if (max_digit < ans[i].length()) {\n        max_digit = ans[i].length(), max_num = ans[i];\n     } else if (max_digit == ans[i].length()) {\n       if (max_num.compare(ans[i]) < 0) max_num = ans[i];\n     }\n    }\n    cout << max_num << el;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nint main() {\n\tint w, h;\n\twhile (cin >> w >> h, w){\n\t\tvector<string> vs(h);\n\t\tvector<vector<bool>> vvb(h);\n\t\tREP(i, h){\n\t\t\tcin >> vs[i];\n\t\t\tREP(j, w){\n\t\t\t\tvvb[i].push_back('0' <= vs[i][j] && vs[i][j] <= '9');\n\t\t\t}\n\t\t}\n\n\t\tvector<vector<int>> vvi(h);\n\t\tint max2 = 1;\n\t\tint x, y;\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tif (vvb[i][j]){\n\t\t\t\t\tint max = 1;\n\t\t\t\t\tif (i > 0 && vvb[i - 1][j])max = vvi[i - 1][j] + 1;\n\t\t\t\t\tif (j > 0 && vvb[i][j - 1])if (max < vvi[i][j - 1] + 1)max = vvi[i][j - 1] + 1;\n\t\t\t\t\tvvi[i].push_back(max);\n\t\t\t\t\tif (max > max2){\n\t\t\t\t\t\tmax2 = max;\n\t\t\t\t\t\t x = j;\n\t\t\t\t\t\t y = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tvvi[i].push_back(-1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvector<vector<int>> vvi2(h);\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tvvi2[i].push_back(-1);\n\t\t\t}\n\t\t}\n\t\tvvi2[y][x] = max2;\n\t\tqueue<int> qi;\n\t\tqi.push(max2 * 100 + x * 10 + y);\n\t\twhile (!qi.empty()){\n\t\t\tint pos = qi.front(); qi.pop();\n\t\t\tint max3 = pos / 100;\n\t\t\tint x2 = (pos / 10) % 10;\n\t\t\tint y2 = pos % 10;\n\t\t\tif (x2 > 0 && vvb[y2][x2 - 1]){\n\t\t\t\tvvi2[y2][x2 - 1] = max3 - 1;\n\t\t\t\tqi.push((max3-1) * 100 + (x2-1) * 10 + y2);\n\t\t\t}\n\t\t\tif (y2 > 0 && vvb[y2 - 1][x2]){\n\t\t\t\tvvi2[y2 - 1][x2] = max3 - 1;\n\t\t\t\tqi.push((max3 - 1) * 100 + x2 * 10 + (y2-1));\n\t\t\t}\n\t\t}\n\t\tchar max4 = '0' - 1;\n\t\tint x3, y3;\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tif (vvi2[i][j] == 1 && max4 < vs[i][j]){\n\t\t\t\t\tmax4 = vs[i][j];\n\t\t\t\t\tx3 = j;\n\t\t\t\t\ty3 = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ans;\n\t\tans += max4;\n\t\tREP(i,max2-1){\n\t\t\tbool abb = false;\n\t\t\tmax4 = '0' - 1;\n\t\t\tif (y3 + 1 != h&&vvi2[y3+1][x3]>0 && max4 < vs[y3 + 1][x3]){\n\t\t\t\tmax4 = vs[y3 + 1][x3];\n\t\t\t\ty3 ++;\n\t\t\t\tabb = true;\n\t\t\t}\n\t\t\tif (abb){\n\t\t\t\tif (x3 + 1 != w&&vvi2[y3-1][x3 + 1]>0 && max4 < vs[y3-1][x3 + 1]){\n\t\t\t\t\tmax4 = vs[y3-1][x3 + 1];\n\t\t\t\t\tx3++;\n\t\t\t\t\ty3--;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif (x3 + 1 != w&&vvi2[y3][x3 + 1]>0 && max4 < vs[y3][x3 + 1]){\n\t\t\t\t\tmax4 = vs[y3][x3 + 1];\n\t\t\t\t\tx3++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tans += max4;\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\nusing ll=long long;\n#define print(n) cout<<n<<endl\n#define rep(i,a,n) for(int i=a;i<n;i++)\n#define ALL(s) s.begin(),s.end()\n#define P pair<ll,ll>\n#define vl vector<ll>\n#define vi vector<int>\n#define vvl vector<vector<ll>>\n#define vvi vector<vector<int>>\nconst int M=100111;\nconst int inf=1000000007;\nconst long long INF=1e18;\nint dx[4]={-1,0,1,0},dy[4]={0,-1,0,1};\nint ddx[8]={1,-1,0,0,1,-1,-1,1},ddy[8]={0,0,1,-1,1,-1,1,-1};\n\nint W,H;\nchar c[77][77];\nstring s[77][77]={};\nstring dfs(int h,int w){\n\tint now=c[h][w]-'0';\n\tif(now>9)return \"\";\n\tif(s[h][w+1].size()<s[h+1][w].size())s[h][w]=c[h][w]+s[h+1][w];\n\telse if(s[h][w+1].size()>s[h+1][w].size())s[h][w]=c[h][w]+s[h][w+1];\n\telse s[h][w]=c[h][w]+max(s[h+1][w],s[h][w+1]);\n\treturn s[h][w];\n}\t\n\nint main(){\n\twhile(1){\n\t\trep(i,0,77)rep(j,0,77)s[i][j]=\"\";\n\t\tstring ans;\n\t\tcin>>W>>H;\n\t\tif(W==0&&H==0)break;\n\t\trep(i,1,H+1)rep(j,1,W+1)cin>>c[i][j];\n\t\tfor(int i=H;i>=0;i--)for(int j=W;j>=0;j--)\n\t\t\tdfs(i,j);\n\t\tint num=0;\n\t\trep(i,1,H+1)rep(j,1,W+1){\n\t\t\tint zero=0;\n\t\t\trep(k,0,s[i][j].size()){\n\t\t\t\tif(s[i][j][k]!='0')break;\n\t\t\t\tzero++;\n\t\t\t}\n\t\t\tnum=max(num,(int)s[i][j].size()-zero);\n\t\t}\n\t\trep(i,1,H+1)rep(j,1,W+1){\n\t\t\tif(s[i][j].size()==num)\n\t\t\t\tans=max(ans,s[i][j]);\n\t\t}\n\t\tprint(ans);\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n#define mod 1000000007\n#define all(c) begin(c),end(c)\ntemplate <typename T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate <typename T> T &chmax(T &a, const T &b) { return a = max(a, b); }\nusing ll = long long;\nusing vi = vector<int>;\nint dd[] = { 0, 1, 0, -1, 0 }; //→↓←↑\n\nint W, H;\nstring ans;\nint m;\nvector<string> C;\nvector<vector<bool>> B;\n\nvoid dfs(int y, int x, int depth, string s)\n{\n\tif (y >= H || x >= W || ('A' <= C[y][x] && C[y][x] <= 'Z') || (C[y][x] == '0' && depth == 0))\n\t{\n\t\tif (m < depth)\n\t\t{\n\t\t\tm = depth;\n\t\t\tans = s;\n\t\t}\n\t\telse if (m == depth)\n\t\t{\n\t\t\tchmax(ans, s);\n\t\t}\n\t\treturn;\n\t}\n\tB[y][x] = true;\n\tdfs(y + 1, x, depth + 1, s + C[y][x]);\n\tdfs(y, x + 1, depth + 1, s + C[y][x]);\n}\nvoid solve()\n{\n\twhile (true)\n\t{\n\t\tcin >> W >> H;\n\t\tif (W == 0 && H == 0)break;\n\t\tans = \"\";\n\t\tm = 0;\n\t\tC = vector<string>(H);\n\t\tB = vector<vector<bool>>(H, vector<bool>(W, false));\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tcin >> C[i];\n\t\t}\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (B[i][j])continue;\n\t\t\t\tdfs(i, j, 0, \"\");\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n\nint main()\n{\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tsolve();\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define range(i,a,b) for(int i = (a); i < (b); i++)\n#define rep(i,b) for(int i = 0; i < (b); i++)\n#define all(a) (a).begin(), (a).end()\n#define debug(x) cout << \"debug \" << x << endl;\nconst int INF = 100000000;\nusing namespace std;\n\nchar m[75][75];\nbool memo[75][75];\nstring ans;\n\nstring big(string a, string b){\n    if(a.size() > b.size()){\n        return a;\n    }else if(a.size() < b.size()){\n        return b;\n    }else{\n        return a > b ? a : b;\n    }\n}\n\nvoid dfs(string a, int x, int y){\n    memo[y][x] = 1;\n    if(a.size() != 0 || m[y][x] != '0') a+=m[y][x];\n    if(isdigit(m[y][x + 1])){\n        dfs(a, x + 1, y);\n    }\n    if(isdigit(m[y + 1][x])){\n        dfs(a, x, y + 1);\n    }\n    ans = big(ans, a);\n}\n\nint main(){\n    int w, h;\n    while(cin >> w >> h, w||h){\n        ans = \"\";\n        rep(i,h) rep(j,w) memo[i][j] = 0;\n        rep(i,h) rep(j,w) m[i + 1][j + 1] = '#';\n        rep(i,h) rep(j,w) cin >> m[i + 1][j + 1];\n        rep(i,h){\n            rep(j,w){\n                if(isdigit(m[i][j]) && memo[i][j] != 1) dfs(\"\", j, i);\n            }\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint W,H;\nchar C[111][111];\n\nstring maxst(const string a,const string b){\n  int l = a.size();\n  int r = b.size();\n  if( l > r ) return a;\n  else if ( l < r ) return b;\n  for(int i=0;i<l;i++){\n    if( a[i] > b[i] ) return a;\n    else if( a[i] < b[i] ) return b;\n  }\n  return a;\n}\n\nstring ctos(char c){\n  string s = \" \";\n  s[0] = c;\n  return s;\n}\n\nstring dp[111][111][80];\n\nstring solve(int x,int y,int d){\n  if( dp[x][y][d] != \"-1\" ) return dp[x][y][d];\n  string ret = \"\";\n  if( isdigit( C[x+1][y] ) ){\n    ret =  maxst( ret , ctos( C[x+1][y] ) + solve(x+1,y, d+1) );\n  }\n  if( isdigit( C[x][y+1] ) ){\n    ret =  maxst( ret , ctos( C[x][y+1] ) + solve(x,y+1, d+1) );\n  }\n  //  cout << x << \"  \"<<y << \" \" <<ret << endl;\n  return dp[x][y][d] = ret;\n}\n\n\nint main(){\n  while(  cin >> W >> H && W && H ){\n    memset(C,0,sizeof(C));\n    for(int i=0;i<H;i++)\n      for(int j=0;j<W;j++)\n\tcin >> C[j][i];\n    string res=\"\";\n    for(int i=0;i<H;i++)\n      for(int j=0;j<W;j++)\n\tfor(int k=0;k<77;k++) dp[j][i][k] = \"-1\";\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\tif( isdigit(C[j][i]) && C[j][i] != '0' ){\n\t  //cout << C[j][i] << \" in \" << endl;\n\t  res = dp[j][i][0] = maxst( res, ctos(C[j][i])+solve(j,i,1) );\n\t}\n      }\n    }\n    cout << res << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\nusing namespace std;\n\nstring comp(string s1,string s2){\n\tif(s1.size()>s2.size())\n\t\treturn s1;\n\telse if(s1.size()<s2.size())\n\t\treturn s2;\n\n\treturn max(s1,s2);\n}\n\nint main()\n{\n\tint W,H;\n\twhile(cin>>W>>H && W!=0){\n\t\tvector<string> M;\n\t\tfor(int i=0;i<H;i++){\n\t\t\tstring s;\n\t\t\tcin>>s;\n\t\t\tM.push_back(s);\n\t\t}\n\t\tvector<vector<string> > dp(H,vector<string>(W,\"\"));\n\n\t\tstring ans=\"\";\n\n\t\tfor(int y=0;y<H;y++){\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tif(!isdigit(M[y][x])) continue;\n\t\t\t\tdp[y][x]=M[y][x];\n\n\t\t\t\tstring s1=\"\",s2=\"\";\n\t\t\t\tif(x>=1){\n\t\t\t\t\ts1=dp[y][x-1]+M[y][x];\n\t\t\t\t}\n\t\t\t\tif(y>=1){\n\t\t\t\t\ts2=dp[y-1][x]+M[y][x];\n\t\t\t\t}\n\n\t\t\t\tdp[y][x]=comp(dp[y][x],comp(s1,s2));\n\t\t\t\tif(dp[y][x]==\"0\") dp[y][x]=\"\";\n\n\t\t\t\tans=comp(dp[y][x],ans);\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nstring memo[70][70];\nbool Compare(string s1, string s2){\n\t//s1>s2\n\tif(s1.length()>s2.length())return true;\n\telse if(s1.length()<s2.length())return false;\n\telse{\n\t\tfor(int i=0;i<s1.length();i++){\n\t\t\tif(s1[i]>s2[i])return true;\n\t\t\telse if(s1[i]<s2[i])return false;\n\t\t}\n\t}\n\treturn false;\n}\n\nint main(){\n\tint w,h;\n\tint dy[2]={-1,0};\n\tint dx[2]={0,-1};\n\twhile(cin>>w>>h && (w||h) ){\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tchar ch;\tcin>>ch;\n\t\t\t\tif(isdigit(ch)){\n\t\t\t\t\tmemo[i][j]=ch;\n\t\t\t\t}else{\n\t\t\t\t\tmemo[i][j]=\"*\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor(int y=h-1;y>=0;y--){\n\t\t\tfor(int x=w-1;x>=0;x--){\n\t\t\t\tif(memo[y][x]==\"*\")continue;\n\n\t\t\t\tfor(int i=0;i<2;i++){\n\t\t\t\t\tint nY=y+dy[i], nX=x+dx[i];\n\t\t\t\t\tif(nY<0||nX<0||nY>=h||nX>=w)continue;\n\t\t\t\t\telse if(memo[nY][nX]==\"*\")continue;\n\n\t\t\t\t\tstring now=memo[nY][nX];\n\t\t\t\t\tstring tmp=now[0]+memo[y][x];\n\t\t\t\t\tif(Compare(tmp,now)){\n\t\t\t\t\t\tmemo[nY][nX]=tmp;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ans=\"0\";\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tif(memo[i][j][0]=='0' || memo[i][j]==\"*\")continue;\n\t\t\t\t//cout<<memo[i][j]<<\" \";\n\n\t\t\t\tif(Compare(memo[i][j],ans)){\n\t\t\t\t\tans=memo[i][j];\n\t\t\t\t\t//cout<<memo[i][j]<<\" \";\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\n\t}\n\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <utility> // pair make_pair\nusing std::swap; // c++11\nusing std::pair;\nusing std::make_pair;\n#include <tuple> // tuple(c++11) make_tuple(c++11)\nusing std::tuple; // get<address>(variable)\nusing std::make_tuple;\n#include <string> // string stoi(c++11) stoll(c++11) to_string(c++11)\nusing std::string;\nusing std::stoi;\nusing std::stoll;\nusing std::to_string;\n#include <queue> // queue priority_queue\nusing std::queue;\nusing std::priority_queue;\n#include <stack> // stack\nusing std::stack;\n#include <vector> // vector\nusing std::vector;\n#include <map> // map\nusing std::map;\n#include <set> // set\nusing std::set; // insert erase find count\n#include <algorithm> // min max\nusing std::sort;\nusing std::lower_bound; // iterator,  >=\nusing std::upper_bound; // iterator,  >\nusing std::min;\nusing std::max;\nusing std::min_element; // iterator\nusing std::max_element; // iterator\n#include <complex> // complex\nusing std::complex; // real imag\n#include <iostream> // cin cout\nusing std::cin;\nusing std::cout;\nusing std::endl;\n#include <iomanip> // setprecision fixed(manipulator)\nusing std::setprecision;\nusing std::fixed;\n#include <cmath>\n#include <cstdio>\n\n#define lli long long int\n#define INF (int)1e09\n#define FOR(i, m, n) for (int i = m; i < n; i++)\n#define EFOR(i, m, n) for (int i = m; i <= n; i++)\n#define RFOR(i, m, n) for (int i = m; i > n; i--)\n#define REFOR(i, m, n) for (int i = m; i >= n; i--)\n#define VSORT(v) sort((v).begin(), (v).end()) // sort vector\ntypedef pair<int, int> PI;\ntypedef tuple<int, int, int> TI;\ntypedef tuple<string, int, int> TS;\ntemplate <typename T> using Vec = vector<T>; // c++11\n\nvoid bfs(Vec<Vec<char> > &table, string &max_ans, int i, int j) {\n    queue<TS> que; // number h w\n    string str = \"\";\n    str += table[i][j];\n    TS t = make_tuple(str, i, j);\n    que.push(t);\n\n    while (!que.empty()) {\n        TS target = que.front(); \n        que.pop();\n        string now_s = std::get<0>(target);\n        int now_i = std::get<1>(target);\n        int now_j = std::get<2>(target);\n\n        if (table[now_i][now_j + 1] == '#' && table[now_i + 1][now_j] == '#') {\n            int len_max = max_ans.length();\n            int len_now = now_s.length();\n            if (len_max < len_now) {\n                max_ans = now_s;\n            } else if ((int)max_ans.length() == (int)now_s.length()) {\n                max_ans = max(max_ans, now_s);\n            }\n        } else {\n            if (table[now_i + 1][now_j] != '#') {\n                TS now = make_tuple(now_s + table[now_i + 1][now_j], now_i + 1, now_j);\n                que.push(now);\n            }\n            if (table[now_i][now_j + 1] != '#') {\n                TS now = make_tuple(now_s + table[now_i][now_j + 1], now_i, now_j + 1);\n                que.push(now);\n            }\n        }\n    }\n\n    return;\n}\n\n\nint main(void) {\n    int w;\n    int h;\n    while (1) {\n        cin >> w >> h;\n        if (w == 0 && h == 0) {\n            break;\n        }\n        Vec<Vec<char> > table(h + 2, Vec<char>(w + 2, '#'));\n        char input;\n        FOR (i, 1, h + 1) {\n            FOR (j, 1, w + 1) {\n                cin >> input;\n                if (input >= '0' && input <= '9') {\n                    table[i][j] = input;\n                }\n            }\n        }\n\n        Vec<Vec<string> > ans(h + 2, Vec<string>(w + 2, \"\"));\n        FOR (i, 1, h + 1) {\n            FOR (j, 1, w + 1) {\n                if (table[i][j] != '#' && table[i][j] >= '0' && table[i][j] <= '9') {\n                    if (table[i][j] == '0' && table[i - 1][j] == '#' && table[i][j - 1] == '#') {\n                        continue;\n                    }\n                    string up = ans[i - 1][j];\n                    string left = ans[i][j - 1];\n                    int up_size = ans[i - 1][j].length();\n                    int left_size = ans[i][j - 1].length();\n\n                    if (up_size < left_size) {\n                        ans[i][j] = ans[i][j - 1] + table[i][j];\n                    } else if (up_size > left_size) {\n                        ans[i][j] = ans[i - 1][j] + table[i][j];\n                    } else {\n                        if (up_size == 0) {\n                            ans[i][j] = table[i][j];\n                        } else {\n                            ans[i][j] = max(up, left) + table[i][j];\n                        }\n                    }\n                }\n            }\n        }\n\n        string output = \"\";\n        int len = 0;\n        FOR (i, 1, h + 1) {\n            FOR (j, 1, w + 1) {\n                int now_size = ans[i][j].length();\n                if (now_size > len) {\n                    len = now_size;\n                    output = ans[i][j];\n                } else if (now_size == len) {\n                    output = max(output, ans[i][j]);\n                }\n            }\n        }\n        cout << output << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint W,H;\n\nbool flag[70][70];\nstring mat[70];\nint cnt;\nstring ans;\n\nvoid dfs(int y, int x,int c,string s) {\n    // cout<<y<<\",\"<<x<<\",\"<<c<<\",\"<<s<<endl;\n    if(cnt<c) {\n        cnt=c;\n        ans=s;\n    }\n    flag[y][x]=true;\n\n    rep(i,2) {\n        int ny=y+dy[i];\n        int nx=x+dx[i];\n        if(!(0<=ny&&ny<H)) continue;\n        if(!(0<=nx&&nx<W)) continue;\n        // if(flag[ny][nx]) continue;\n        if(!('0'<=mat[ny][nx]&&mat[ny][nx]<='9')) continue;\n        dfs(ny,nx,c+1,s+mat[ny][nx]);\n\n    }\n\n    return;\n}\n\nvoid solve() {\n    cnt=0;\n    ans=\"\";\n    rep(i,70) rep(j,70) flag[i][j]=false;\n    rep(i,70) mat[i]=\"\";\n    rep(i,H) cin>>mat[i];\n    rep(i,H) rep(j,W) if('1'<=mat[i][j]&&mat[i][j]<='9') {\n        string s=\"a\";\n        s[0]=mat[i][j];\n        dfs(i,j,0,s);\n    }\n\n    cout<<ans<<endl;\n}\n\nint main() {\n    while(cin>>W>>H) {\n        if(W+H==0) break;\n        solve();\n\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <cstring>\n#include <cctype>\n\nusing namespace std;\ntypedef long long ll;\n\nchar field[71][71];\nstring dp[71][71];\n\nbool str_less(const string &a, const string &b){\n\tif(a.size() < b.size()){ return true; }\n\tif(a.size() > b.size()){ return false; }\n\treturn a < b;\n}\n\nint main(){\n\twhile(true){\n\t\tint W, H;\n\t\tcin >> W >> H;\n\t\tif(W == 0 && H == 0){ break; }\n\t\tmemset(field, 0, sizeof(field));\n\t\tfor(int i = 0; i < H; ++i){ cin >> field[i]; }\n\t\tfor(int i = 0; i < H; ++i){\n\t\t\tfor(int j = 0; j < W; ++j){ dp[i][j] = \"\"; }\n\t\t}\n\t\tstring answer = \"\";\n\t\tfor(int i = H - 1; i >= 0; --i){\n\t\t\tfor(int j = W - 1; j >= 0; --j){\n\t\t\t\tif(isdigit(field[i][j])){\n\t\t\t\t\tif(str_less(dp[i + 1][j], dp[i][j + 1])){\n\t\t\t\t\t\tdp[i][j] = field[i][j] + dp[i][j + 1];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tdp[i][j] = field[i][j] + dp[i + 1][j];\n\t\t\t\t\t}\n\t\t\t\t\tstring value = \"\";\n\t\t\t\t\tfor(int k = 0; k < dp[i][j].size(); ++k){\n\t\t\t\t\t\tif(dp[i][j][k] != '0'){\n\t\t\t\t\t\t\tvalue = string(dp[i][j].c_str() + k);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(str_less(answer, value)){ answer = value; }\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << answer << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <set>\n\nusing namespace std;\n\nstring cmp(string s1, string s2, int n) {\n    set<char> set1;\n    set<char> set2;\n    for (char c : s1) set1.insert(c);\n    for (char c : s2) set2.insert(c);\n\n    if (set1.size() > n && set2.size() > n)\n        return \"\";\n    if (set1.size() > n)\n        return s2;\n    if (set2.size() > n)\n        return s1;\n\n    if (s1.length() > s2.length()) {\n        return s1;\n    } else if (s1.length() < s2.length()) {\n        return s2;\n    } else {\n        if (s1 > s2) {\n            return s1;\n        } else {\n            return s2;\n        }\n    }\n\n    return \"\";\n}\n\nstring forout(string s1, string s2, int n) {\n    if (s1[0] == '0')\n        return cmp(s1.substr(1), s2, n);\n    if (s2[0] == '0')\n        return cmp(s1, s2.substr(1), n);\n    return cmp(s1, s2, n);\n}\n\nint main() {\n    int w, h;\n    while (cin >> w >> h, w|h) {\n        vector<string> v;\n        for (int i = 0; i < h; i++) {\n            string s;\n            cin >> s;\n            v.push_back(s);\n        }\n        string codes[70][70];\n        fill_n((string *)codes, 70*70, \"\");\n        for (int i = w-1; i >= 0; i--) {\n            for (int j = h-1; j >= 0; j--) {\n                if (v[j][i] >= '0' && v[j][i] <= '9') {\n                    codes[j][i] = cmp(v[j][i]+codes[j+1][i], v[j][i]+codes[j][i+1], w);\n                }\n            }\n        }\n\n        string out = \"\";\n        for (int i = 0; i < w; i++) {\n            for (int j = 0; j < h; j++) {\n                out = forout(out, codes[j][i], w);\n            }\n        }\n        cout << out << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <string>\n#include <cstring>\n\nusing namespace std;\n\nint W, H;\nvector<string> mat;\n\nstring dp[100][100];\n\nstring maxstr(string s1, string s2) {\n\tint len1 = (int)s1.length();\n\tint len2 = (int)s2.length();\n\tif (len1 < len2) return s2;\n\tif (len1 > len2) return s1;\n\t\n\tfor (int i = 0; i < len1; i++) {\n\t\tif (s1[i] < s2[i]) return s2;\n\t\tif (s1[i] > s2[i]) return s1;\n\t}\n\t\n\treturn s1;\n}\n\nstring zrm(string s) {\n\tif (s[0] == '0') s = s.substr(1);\n\treturn s;\n}\n\nbool isdig(char c) {\n\tif ('0' <= c && c <= '9') return true;\n\treturn false;\n}\n\nvoid solve() {\n\tfor (int i = 0; i < 100; i++) for (int j = 0; j < 100; j++) dp[i][j] = \"\";\n\t\n\tfor (int i = 0; i < H; i++) {\n\t\tfor (int j = 0; j < W; j++) {\n\t\t\tif (!isdig(mat[i][j])) continue;\n\t\t\tif (j == 0) {\n\t\t\t\tdp[i + 1][j] = zrm(dp[i][j] + mat[i][j]);\n\t\t\t} else {\n\t\t\t\tdp[i + 1][j] = maxstr(zrm(dp[i + 1][j - 1] + mat[i][j]),\n\t\t\t\t\t\t\t\t\t  zrm(dp[i][j] + mat[i][j]));\n\t\t\t}\n\t\t}\n\t}\n\t\n\tstring ans = \"\";\n\tfor (int i = 0; i <= H; i++) {\n\t\tfor (int j = 0; j < W; j++) {\n\t\t\tans = maxstr(ans, dp[i][j]);\n\t\t}\n\t}\n\tcout << ans << endl;\n}\n\nint main() {\n\twhile (1) {\n\t\tcin >> W >> H; if (W==0 && H==0) break;\n\t\tmat.assign(H, \"\");\n\t\tfor (int i = 0; i < H; i++) {\n\t\t\tcin >> mat[i];\n\t\t}\n\t\t\n\t\tsolve();\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cctype>\n\nusing namespace std;\n\nint main(void){\n  int w,h;\n  string grid[71],dp[71][71];\n\n  while(cin >> w >> h,w|h){\n    for(int i=0;i<70;i++)\n      for(int j=0;j<70;j++)dp[i][j].clear();\n\n    for(int i=0;i<h;i++)cin >> grid[i];\n\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(!isupper(grid[i][j])){\n\t  dp[i][j]=grid[i][j];\n\t  string a=\"\",b=\"\";\n\t  if(i>0 && !dp[i-1][j].empty())a=dp[i-1][j]+grid[i][j];\n\t  if(j>0 && !dp[i][j-1].empty())b=dp[i][j-1]+grid[i][j];\n\t  \n\t  if(a.empty() && !b.empty()){\n\t    dp[i][j]=b;\n\t    continue;\n\t  }\n\n\t  if(!a.empty() && b.empty()){\n\t    dp[i][j]=a;\n\t    continue;\n\t  }\n\t  if(a.empty() && b.empty())continue;\n\t  if(a.size()>b.size())dp[i][j]=a;\n\t  if(a.size()<b.size())dp[i][j]=b;\n\t  else if(a>b)dp[i][j]=a;\n\t  else dp[i][j]=b;\n\n\t  if(dp[i][j][0]=='0'){\n\t    int k=0;\n\t    for(;k<dp[i][j].size()&&dp[i][j][k]=='0';k++);\n\t    dp[i][j]=dp[i][j].substr(k);\n\t  }\n\t}\n      }\n    }\n\n    string s=\"\";\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(dp[i][j][0]=='0'){\n\t  int k=0;\n\t  for(;k<dp[i][j].size()&&dp[i][j][k]=='0';k++);\n\t  dp[i][j]=dp[i][j].substr(k);\n\t}\n\tif(s.size()<dp[i][j].size())s=dp[i][j];\n\telse if(s<dp[i][j])s=dp[i][j];\n      }\n    }\n    cout << s << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<string>\n#define rep(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint h,w,k;\nvector<int> dp[75][75],ans;\n\nvector<int> Max(vector<int> a,vector<int> b){\n\tif(a.size()>b.size())return a;\n\tif(a.size()<b.size())return b;\n\trep(i,a.size()){\n\t\tif(a[i]>b[i])return a;\n\t\tif(a[i]<b[i])return b;\n\t}\n\treturn a;\n}//a???b?????§?????????\n\nint main(){\n\twhile(cin>>w>>h&&h+w){\n\trep(i,h)rep(j,w)dp[i][j].clear();\n\trep(i,h)rep(j,w){\n\t\tchar z;cin>>z;\n\t\tif(isdigit(z)){\n\t\t\tdp[i][j].push_back(z-'0');\n\t\t\tdp[i+1][j]=Max(dp[i+1][j],dp[i][j]);\n\t\t\tdp[i][j+1]=Max(dp[i][j+1],dp[i][j]);\n\t\t}\n\t}\n\tans.clear();\n\trep(i,h)rep(j,w)ans=Max(ans,dp[i][j]);\n\tbool zero=true;\n\trep(i,ans.size()){\n\t\tif(ans[i]>0)zero=false;\n\t\tif(!zero)cout<<ans[i];\n\t}cout<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,n) for (int i=0;i<(n);i++)\n#define rep2(i,a,b) for (int i=(a);i<(b);i++)\n#define rrep(i,n) for (int i=(n)-1;i>=0;i--)\n#define rrep2(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef vector<int> vi;\ntypedef vector<pll> vp;\ntypedef vector<ll> vll;\n\nint W, H;\nstring c[70];\n\nstring ans;\n\nbool inside(int x, int y) {\n    return 0 <= x && x < H && 0 <= y && y < W;\n}\n\nvoid update(string t) {\n    if (ans.length() > t.length()) return;\n    if (ans.length() < t.length()) {\n        ans = t;\n        return;\n    }\n    rep(i, ans.length()) {\n        if (ans[i] > t[i]) return;\n        if (ans[i] < t[i]) {\n            ans = t;\n            return;\n        }\n    }\n}\n\nvoid dfs(int i, int j, string t) {\n    if (!inside(i, j) || !isdigit(c[i][j])) {\n        update(t);\n        return;\n    }\n\n    t += c[i][j];\n\n    dfs(i, j + 1, t);\n    dfs(i + 1, j, t);\n}\n\nsigned main() {\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(0);\n\n    while (cin >> W >> H && W) {\n        rep(i, H) cin >> c[i];\n\n        ans = \"\";\n        rep(i, H) rep(j, W) {\n            // avoid leading zero\n            if (c[i][j] != '0') dfs(i, j, \"\");\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \n#define INF 1001000100010001000\n#define MOD 1000000007\n#define EPS 1e-10\n#define int long long\n#define rep(i, N) for (int i = 0; i < N; i++)\n#define Rep(i, N) for (int i = 1; i < N; i++)\n#define For(i, a, b) for (int i = (a); i < (b); i++)\n#define pb push_back\n#define mp make_pair\n#define i_i pair<int, int>\n#define vi vector<int>\n#define vvi vector<vi >\n#define vb vector<bool>\n#define vvb vector<vb >\n#define vp vector< i_i >\n#define all(a) (a).begin(), (a).end()\n#define Int(x) int x; scanf(\"%lld\", &x);\n \nint dxy[5] = {0, 1, 0, -1, 0};\n// assign\n\nvector<char> ans, tmp;\nvector< vector< char > > board;\nint n, m;\n\nvoid comp_data();\nvoid search(int i, int j);\n\nsigned main()\n{\n    cin >> n >> m;\n    while (m) {\n        rep(i, ans.size()) {\n            ans.pop_back();\n        }\n        board.assign(m, vector<char>(n));\n        getchar();\n        rep(i, m) {\n            rep(j, n) {\n                cin >> board[i][j];\n            }\n        }\n        rep(i, m) {\n            rep(j, n) {\n                search(i, j);\n            }\n        }\n        for (char i : ans) {\n            cout << i;\n        }\n        cout << endl;\n\n        cin >> n >> m;\n    }\n    return 0;\n}\n\nvoid search(int i, int j)\n{\n    bool fl = false;\n    if (tmp.size()) {\n        if (i+1 < m && '0' <= board[i+1][j] && board[i+1][j] <= '9') {\n            tmp.pb(board[i+1][j]);\n            search(i+1, j);\n            tmp.pop_back();\n            fl = true;\n        }\n\n        if (j+1 < n && '0' <= board[i][j+1] && board[i][j+1] <= '9') {\n            tmp.pb(board[i][j+1]);\n            search(i, j+1);\n            tmp.pop_back();\n            fl = true;\n        }\n    } else {\n        if (i+1 < m && '1' <= board[i+1][j] && board[i+1][j] <= '9') {\n            tmp.pb(board[i+1][j]);\n            search(i+1, j);\n            tmp.pop_back();\n            fl = true;\n        }\n\n        if (j+1 < n && '1' <= board[i][j+1] && board[i][j+1] <= '9') {\n            tmp.pb(board[i][j+1]);\n            search(i, j+1);\n            tmp.pop_back();\n            fl = true;\n        }\n    }\n\n    if (!fl) {\n        comp_data();\n    }\n\n}\n\nvoid comp_data()\n{\n    if (ans.size() < tmp.size() ) {\n        ans = tmp;\n    } else if (ans.size() == tmp.size() ) {\n        rep(i, ans.size()) {\n            if (tmp[i] > ans[i]) {\n                ans = tmp;\n                return ;\n            } else if (tmp[i] < ans[i]) {\n                return;\n            }\n        }\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <iostream>\n#include <map>\n#include <cmath>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <stdlib.h>\n#include <stdio.h>\n#include <bitset>\n#include <cstring>\nusing namespace std;\n#define FOR(I,A,B) for(int I = (A); I < (B); ++I)\n#define CLR(mat) memset(mat, 0, sizeof(mat))\ntypedef long long ll;\nint W, H;\nvector<string> vs(70);\nstring ans;\nbool calc(string a, string b) {\n  if(a.length() > b.length()) return true;\n  if(a.length() < b.length()) return false;\n  else return a > b;\n}\nvoid dfs(int h, int w, string s) {\n  if(h < 0 || h >= H || w < 0 || w >= W || !isdigit(vs[h][w])) {\n    if(calc(s, ans)) ans = s;\n    return;\n  }\n  s += vs[h][w];\n  dfs(h+1,w,s);\n  dfs(h,w+1,s);\n  return;\n}\nint main()\n{\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  while(cin>>W>>H,W||H) {\n    FOR(i,0,H) cin >> vs[i];\n    ans = \"\";\n    bool checked[H][W]; CLR(checked);\n    FOR(h,0,H) {\n      FOR(w,0,W) {\n        if(checked[h][w]) continue;\n        checked[h][w] = true;\n        dfs(h, w, \"\");\n      } \n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<algorithm>\n#include<vector>\n#define F first\n#define S second\nusing namespace std;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() == 0 && b.size() == 0)\n    return true;\n  else if(a.size() == 0)\n    return true;\n  else if(b.size() == 0)\n    return false;\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] < b[i];\n  return false;\n}\n\nint main()\n{\n\n  int w,h;\n  while(cin >> w >> h,(w || h))\n    {\n      \n      char G[h][w];\n      string ans=\"0\";\n      string dp[h][w];\n\n      for(int i=0;i<h;i++)\n\t{\n\tfor(int j=0;j<w;j++)\n\t  {\n\t    cin >> G[i][j];\n\t    if('0' <= G[i][j] && G[i][j] <= '9')\n\t      {\n\t\tdp[i][j] = G[i][j];\n\t\tans = max(ans,dp[i][j],cmp);\n\t      }\n\t\n\t  }\n\n\t}\n     \n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\n\t      if(!('0' <= G[i][j] && G[i][j] <= '9'))\n\t\tcontinue;\n\t      \n\t      dp[i][j] = max(dp[i][j],max((i-1>=0 &&('0'<= G[i-1][j] && G[i-1][j] <= '9') ?dp[i-1][j]:\"\")+dp[i][j],\n\t\t\t\t\t  (j-1>=0 &&('0'<= G[i][j-1] && G[i][j-1] <= '9') ?dp[i][j-1]:\"\")+dp[i][j],cmp),cmp);\t      \n\t      //ans = max(ans,dp[i][j],cmp);\n\n\t    }\n\t}\n\n      ans = \"\";\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\t      if('0' <= G[i][j] && G[i][j] <= '9')\n\t\t{\n\t\t  string a;\n\t\t  if(dp[i][j] != \"0\" && dp[i][j][0] == '0')\n\t\t    {\n\n\t\t      for(int k=0;dp[i][j][k] == '0';k++)\n\t\t\tdp[i][j][k] = ' ';\t\t    \n\t\t      stringstream ss;\n\t\t      ss << dp[i][j];\n\t\t      a = ss.str();\n\t\t    }\n\t\t  else\n\t\t    a = dp[i][j];\n\t\t  ans = max(ans,a);\n\n\t\t}\n\t    }\n\t}\n\n\n      bool f = false;\n      int cnt = 0;\n      for(int i=0;i<ans.size();i++)      \n\tif(ans[i] == '0' && !f)\n\t  continue;\n\telse  \n\t  {\n\t    cnt++;\n\t    f = true;\n\t    cout << ans[i];\n\t  }\n      if(cnt == 0)\n\tcout << \"0\";\n\tcout << endl;\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <sstream>\n#include <cassert>\n#include <list>\nusing namespace std;\nstatic const double EPS = 1e-10;\ntypedef long long ll;\ntypedef pair<int,int> PI;\ntypedef vector<int> vi;\n#ifndef M_PI\n#define M_PI 3.14159265358979323846\n#endif\n#define rep(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define F first\n#define S second\n\n\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\n\ntypedef struct _mulnum{\n  string number;\n  bool operator<(const _mulnum&r)const{\n    string lstr=number,rstr=r.number;\n    if(number.size()!=r.number.size())return number.size()<r.number.size();\n\n    rep(i,number.size()){\n      if(number[i]!=r.number[i])return number[i]<r.number[i];\n    }\n    return 0;\n  };\n  _mulnum operator+(const char&r){\n    _mulnum ret=*this;\n    ret.number+=r;\n    return ret;\n  }\n}mulnum;\n\n\nmain(){\n  int w,h;\n  while(cin>>w>>h,w|h){\n    char in[h][w+2];\n    rep(i,h)cin>>in[i];\n    mulnum dp[h][w];\n\n    mulnum ans;\n\n    rep(i,h){\n      rep(j,w){\n\tif(isdigit(in[i][j])){\n\t  if(i && (dp[i-1][j].number.size() || in[i][j]!='0')){\n\t    dp[i][j]=max(dp[i-1][j]+in[i][j],dp[i][j]);\n\t    ans=max(ans,dp[i][j]);\n\t  }\n\t  if(j && (dp[i][j-1].number.size() || in[i][j]!='0')){\n\t    dp[i][j]=max(dp[i][j-1]+in[i][j],dp[i][j]);\n\t    ans=max(ans,dp[i][j]);\n\t  }\n\t}\n      }\n    }\n\n    while(ans.number[0]=='0')ans.number=ans.number.substr(1);\n    cout<<ans.number<<endl;\n  }\n}\n\t    "
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cstdlib>\n#include<typeinfo>\n#include<set>\n#include<map>\n#include<vector>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<numeric>\n#include<cassert>\n#include<random>\nusing namespace std;\n\nbool num(char c){\n    if(c<'0' || c>'9'){return false;}\n    return true;\n}\n\nstring max(string a,string b){\n    int as=(int)a.size();\n    int bs=(int)b.size();\n    for(int i=0;a[i]=='0';i++){as--;}\n    for(int i=0;b[i]=='0';i++){bs--;}\n    if(as>bs){return a;}\n    if(bs>as){return b;}\n    for(int i=0;i<as;i++){\n        if(a[a.size()-as+i]>b[b.size()-bs+i]){return a;}\n        if(a[a.size()-as+i]<b[b.size()-bs+i]){return b;}\n    }\n    return a;\n}\n\nstring pls(char c,string s){\n    s.push_back(1);\n    for(int i=(int)s.size()-2;i>=0;i--){\n        s[i+1]=s[i];\n    }\n    s[0]=c;\n    return s;\n}\n\nint main(){\n    while(1){\n        \n        \n        \n    \n    char a[100][100]={};\n    int w,h;\n    cin>>w>>h;\n        if(w==0 && h==0){break;}\n    for(int i=0;i<h;i++){\n        for(int t=0;t<w;t++){\n            cin>>a[i][t];\n        }\n    }\n    string dp[100][100]={};\n    string ans;\n    for(int i=h-1;i>=0;i--){\n        for(int t=w-1;t>=0;t--){\n            if(num(a[i][t])){\n                dp[i][t]=pls(a[i][t],max(dp[i+1][t],dp[i][t+1]));\n                ans=max(ans,dp[i][t]);\n            }\n        }\n    }\n        bool d=true;\n        for(int i=0;i<ans.size();i++){\n            if(d && ans[i]!='0'){cout<<ans[i]; d=false; continue;}\n            if(!d){cout<<ans[i];}\n        }\n        cout<<endl;\n    \n        \n        \n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <map>\n#include <algorithm>\n\n#define lli long long int\n#define REP(i,n) for(lli i=0;i<n;i++)\n\n#define NUM 1000000\n\nusing namespace std;\n\nint length = 0;\n\nint max1(int a, int b){\n\tif (a >= b)return a;\n\telse return b;\n}\n\nint isIn(int x, int y, int w, int h){\n\tif (x < 0 || w <= x || y < 0 || h <= y){\n\t\treturn 0;\n\t}\n\telse{\n\t\treturn 1;\n\t}\n}\n\nint isNum(int x, int y, string *data){\n\tif ('0' <= data[y].at(x) && data[y].at(x) <= '9'){\n\t\treturn 1;\n\t}\n\telse{\n\t\treturn 0;\n\t}\n}\n\nstring emitZero(string str){\n\n\tstring rStr = \"\";\n\tREP(i, str.size()){\n\t\tif (str.at(i) != '0'){\n\t\t\trStr = str.substr(i, str.size());\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn rStr;\n\n}\n\n\nvoid solve(int x, int y,int w,int h,string now,string *data, vector<string> *v,int **flag){\n\t\n\tif (!isIn(x,y,w,h) || isNum(x,y,data)==0){\n\t\t//cout << now << endl;\n\t\tnow = emitZero(now);\n\t\t//cout << now << endl;\n\t\t//cout << \"now.size = \" << now.size() << endl;\n\t\tlength = max1(length, now.size());\n\t\tv->push_back(now);\n\t\treturn;\n\t}\n\telse{\n\t\tflag[y][x] = 1;\n\t\tstring next = now + data[y].at(x);\n\t\tsolve(x + 1, y, w, h, next, data, v,flag);\n\t\tsolve(x, y + 1, w, h, next, data, v,flag);\n\t}\n}\n\nint main(){\n\n\n\t\n\tint w, h;\n\n\twhile (cin >> w >> h){\n\t\tif (w == 0 && h == 0)break;\n\t\tlength = 0;\n\t\tstring *data;\n\t\tint **flag = new int *[h];\n\t\tvector<string> v;\n\n\t\tREP(i, h){\n\t\t\tflag[i] = new int[w];\n\t\t}\n\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tflag[i][j] = 0;\n\t\t\t}\n\t\t}\n\t\t\n\t\tdata = new string[h];\n\n\t\tREP(i, h){\n\t\t\tcin >> data[i];\n\t\t\t//cout << data[i] << endl;\n\t\t}\n\n\t\tREP(y, h){\n\t\t\tREP(x, w){\n\t\t\t\tif (flag[y][x] == 0 && isNum(x,y,data)==1){\n\t\t\t\t\tsolve(x, y, w, h, \"\", data, &v, flag);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//cout << v.size() << endl;\n\t\t\n\t\tvector<string> ans;\n\n\t\t//cout << \"max1Length=\" << length << endl;;\n\n\t\tREP(i, v.size()){\n\t\t\tif (v.at(i).size() == length){\n\t\t\t\tans.push_back(v.at(i));\n\t\t\t}\n\t\t}\n\n\t\tsort(ans.begin(), ans.end());\n\n\t\t\n\t\tcout << ans.back() << endl;\n\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <limits.h>\n#include <map>\n#include <math.h>\n#include <numeric>\n#include <set>\n#include <stack>\n#include <stdlib.h>\n#include <string>\n#include <vector>\n#define el endl\n#define fd fixed\n#define INF INT_MAX/2-1\n#define pb push_back\n#define mp make_pair\n#define sp fd << setprecision\nusing namespace std;\nint dx[] = {1, 0, -1, 0}, dy[] = {0, 1, 0, -1};\ntypedef vector<int> VI;\ntypedef vector<vector<int> > VVI;\ntypedef vector<string> VS;\n\nvector<string> ans;\n\nvoid search(VVI code, int i, int j, string tmp, int w, int h) {\n  if (code[i][j] < 0) return;\n  tmp += (char)(code[i][j]+48);\n  if ((i < h-1 && code[i+1][j] < 0) || (j < w-1 && code[i][j+1])) ans.pb(tmp);\n  if (i < h-1) search(code, i+1, j, tmp, w, h);\n  if (j < w-1) search(code, i, j+1, tmp, w, h);\n}\n\nint main() {\n  int w, h;\n  while (cin >> w >> h, w | h) {\n    VVI code;\n    string s;\n    ans.clear();\n    for (int i = 0; i < h; i++) {\n      VI tv;\n      cin >> s;\n      for (int j = 0; j < s.length(); j++) {\n        int tn = (int)(s[j]-'0');\n        if (0 <= tn && tn <= 9) {\n          tv.pb(tn);\n        } else {\n        tv.pb(-1);\n        }\n      }\n      code.pb(tv);\n    }\n    for (int i = 0; i < h; i++) {\n      for (int j = 0; j < w; j++) {\n        search(code, i, j, \"\", w, h);\n      }\n    }\n    int max_digit = 0;\n    string max_num = \"\";\n    for (int i = 0; i < ans.size(); i++) {\n      if (max_digit < ans[i].length()) max_num = ans[i], max_digit = ans[i].length();\n    }\n    if (max_num[0] == '0') max_num.erase(max_num.begin());\n    cout << max_num << el;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <algorithm>\n#include <complex>\n#include <cstring>\n#include <cstdlib>\n#include <cctype>\nusing namespace std;\n\n#define REP(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\n\nbool pred(string a, string b) {\n  int i;\n  for (i=0; a[i] == '0'; i++);\n  a = a.substr(i);\n  for (i=0; b[i] == '0'; i++);\n  b = b.substr(i);\n  if (a.length()!=b.length()) return a.length() < b.length();\n  return a < b;\n}\n\nint main() {  \n  int w, h;\n  while(cin >> w >> h, w+h) {\n    char ba[w][h];\n    REP(y,h)\n      REP(x,w)\n        cin >> ba[x][y];\n    \n    string dp[w][h];\n    string ans;\n    REP(y, h) {\n      REP(x, w) {\n        if (isalpha(ba[x][y])) continue;\n        if (x>0) dp[x][y] = dp[x-1][y];\n        if (y>0&&pred(dp[x][y], dp[x][y-1])) dp[x][y] = dp[x][y-1];\n        dp[x][y] += ba[x][y];\n\n        if (pred(ans, dp[x][y])) ans = dp[x][y];\n      }\n    }\n    int i;\n    for(i=0;ans[i]=='0';i++);\n    cout << ans.substr(i) << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <iostream>\n#include <cstring>\n#include <algorithm>\n\nusing namespace std;\n\nbool lt(string arg1, string arg2){\n    if(arg1.size() == arg2.size()){\n        return arg1 < arg2;\n    }\n    return arg1.size() <= arg2.size();\n}\n\nint main(){\n    int w, h;\n\n    while(cin >> w >> h){\n        if((w|h) == 0) break;\n\n        string dp[h+1][w+1];\n        char b[h+1][w+1];\n        char tmp;\n\n        for(int i=0;i<=h;++i){\n            for(int j=0;j<=w;++j){\n                dp[i][j] = \"\";\n            }\n        }\n\n        for(int i=1;i<=h;++i){\n            for(int j=1;j<=w;++j){\n                cin >> tmp;\n                if('0' <= tmp && tmp <= '9'){\n                    b[i][j] = tmp;\n                }else{\n                    b[i][j] = -1;\n                }\n            }\n        }\n\n        string ret=\"\";\n        for(int i=1;i<=h;++i){\n            for(int j=1;j<=w;++j){\n                if(b[i][j] == -1){\n                    dp[i][j] = \"\";\n                }else{\n                    string str[2];\n                    str[0] = dp[i-1][j] + b[i][j];\n                    str[1] = dp[i][j-1] + b[i][j];\n                    if(str[0] == \"0\") str[0] = \"\";\n                    if(str[1] == \"0\") str[1] = \"\";\n\n                    if(lt(str[0],str[1])){\n                        dp[i][j] = str[1];\n                    }else{\n                        dp[i][j] = str[0];\n                    }\n                }\n                if(lt(ret,dp[i][j])){\n                    ret = dp[i][j];\n                }\n            }\n        }\n        cout << ret << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <vector>\n#include <map>\n#include <set>\n#include <string>\n#include <cstring>\n#include <sstream>\n#include <algorithm>\n#include <functional>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <iomanip>\n#include <list>\n#include <tuple>\n#include <bitset>\n\nusing namespace std;\n\ninline bool cheak(int x, int y, int xMax, int yMax){ return x >= 0 && y >= 0 && xMax > x && yMax > y; }\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout << x; return sout.str(); }\ntemplate<class T> inline T sqr(T x) { return x*x; }\n\ntypedef pair<int, int> P;\ntypedef tuple<int, int, int> T;\ntypedef long long ll;\ntypedef unsigned long long ull;\n\n#define For(i,a,b)\tfor(int (i) = (a);i < (b);(i)++)\n#define rep(i,n)\tFor(i,0,n)\n#define clr(a)\t\tmemset((a), 0 ,sizeof(a))\n#define mclr(a)\t\tmemset((a), -1 ,sizeof(a))\n#define all(a)\t\t(a).begin(),(a).end()\n#define sz(a)\t\t(sizeof(a))\n#define Fill(a,v)\tfill((int*)a,(int*)(a+(sz(a)/sz(*(a)))),v)\n\nconst int dx[8] = { -1, 0, -1, 0, 1, 1, -1, -1 }, dy[8] = { 0, -1, 0, 1, -1, 1, -1, 1 };\nconst int mod = 1000000007;\nconst int INF = 1e9;\n\nstring c[71];\nint w, h;\n\nstring d[71][71];\n\nint str_compare(string s1, string s2){\n\n\twhile (s1[0] == '0'){\n\t\ts1 = s1.substr(1, s1.size() - 1);\n\t}\n\twhile (s2[0] == '0'){\n\t\ts2 = s2.substr(1, s2.size() - 1);\n\t}\n\n\tif (s1.size() > s2.size())return 1;\n\tif (s1.size() < s2.size())return 0;\n\tif (s1.size() == s2.size()){\n\t\tif (s1 > s2)return 1;\n\t\tif (s1 < s2)return 0;\n\t\tif (s1 == s2)return -1;\n\t}\n}\n\nvoid func(int y,int x){\n\n\t\n\trep(i, 2){\n\t\tint ty = y + dy[i], tx = x + dx[i];\n\t\tif (cheak(tx, ty, w, h) && (c[ty][tx] >= '0' && c[ty][tx] <= '9')){\n\n\t\t\tstring t = (c[ty][tx]) + d[y][x];\n\t\t\tif (str_compare(d[ty][tx],t ) != 1){\n\t\t\t\td[ty][tx] = t;\n\t\t\t\tfunc(ty, tx);\n\t\t\t}\n\n\t\t}\n\t}\n}\n\nint main()\n{\n\twhile (cin >> w >> h && (w || h)){\n\t\trep(y, h){\n\t\t\tcin >> c[y];\n\t\t\trep(x,w)\n\t\t\tif (c[y][x] >= '0' && c[y][x] <= '9')d[y][x] = c[y][x];\n\t\t}\n\t\tfor (int y = h - 1; y >= 0; y--)\n\t\tfor (int x = w - 1; x >= 0; x--)if (c[y][x] >= '0' && c[y][x] <= '9'){\n\t\t\tfunc(y, x);\n\t\t}\n\n\t\tstring ans = \"0\";\n\n\t\trep(y, h)rep(x, w)if (c[y][x] >= '0' && c[y][x] <= '9') {\n\t\t\tif (str_compare(ans, d[y][x]) == 0){\n\t\t\t\tans = d[y][x];\n\t\t\t}\n\t\t}\n\t\twhile (ans[0] == '0'){\n\t\t\tans = ans.substr(1, ans.size() - 1);\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\n\nvector<string> field(80);\n\nint n, m;\n\nbool use[90][90];\n\nbool isIn(int x, int y){\n    return 0 <= x && x < m && 0 <= y && y < n;\n}\n\nstring nmax(string a, string b){\n    if(a.size() != b.size()) return a.size() < b.size() ? b : a;\n    else return a < b ? b : a;\n}\n\nstring search(int x, int y, string num){\n    use[x][y] = true;\n    if (!isIn(x, y)) return num;\n    if('0' <= field[x][y] && field[x][y] <= '9'){\n        if(!(num.size() == 0 && field[x][y] == '0')) num += field[x].substr(y, 1);\n        num = nmax(search(x+1, y, num), search(x, y+1, num));\n        return num;\n    }\n    else return num;\n}\n\nint main(){\n    while(cin >> n >> m, n+m){\n        for(int i=0; i < m; i++) cin >> field[i];\n        for(int i=0; i < 90; i++) for(int j=0; j < 90; j++) use[i][j] = false;\n        string ret;\n\n        for(int i=0; i< m; i++){\n            for(int j=0; j < n; j++) if(!use[i][j]) ret = nmax(ret, search(i, j, \"\"));\n        }\n\n        cout << ret << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\nstatic const int N = 71;\nstring judge(string,string);\nint main(){\n  int w,h,i,j,len[N][N],a,b,lenmax,lencnt,flag;\n  string dp[N][N],instr[N],which,finalresult;\n  while(1){\n    cin >> w >> h;\n    for(i=0;i<=h;i++){\n      for(j=0;j<=w;j++){\n\tlen[i][j]=0;\n\tdp[i][j]=\"\";\n      }\n    }\n    if(w==0&&h==0) break;\n    for(i=0;i<=w;i++){\n      instr[0]+='X';\n    }\n    len[0][0]=0;\n    for(i=1;i<=h;i++){\n      cin >> instr[i];\n      instr[i]='X'+instr[i];\n    }\n    lenmax=0;\n    for(i=1;i<=h;i++){\n      for(j=1;j<=w;j++){\n\tif('A'<=instr[i][j]&&instr[i][j]<='Z') instr[i][j]='X';\n\tif('0'<=instr[i][j]&&instr[i][j]<='9'){\n\t  len[i][j]=max(len[i][j-1],len[i-1][j])+1;\n\t}\n\tlenmax=max(lenmax,len[i][j]);\n      }\n    }\n    //!='X'?????¨?????°???\n    for(i=1;i<=h;i++){\n      for(j=1;j<=w;j++){\n\tif(instr[i][j]!='X'){\n\t  a=b=0;\n\t  if(instr[i-1][j]!='X') a=1;\n\t  if(instr[i][j-1]!='X') b=1;\n\t  if(a==1&&b==1){\n\t    if(len[i-1][j]>len[i][j-1]) dp[i][j]+=dp[i-1][j]+instr[i][j];\n\t    else if(len[i-1][j]<len[i][j-1]) dp[i][j]+=dp[i][j-1]+instr[i][j];\n\t    else{//dp???????????????????????????\n\t      which=judge(dp[i-1][j],dp[i][j-1]);\n\t      dp[i][j]+=which+instr[i][j];\n\t    }\n\t  }\n\t  else if(a==1) dp[i][j]+=dp[i-1][j]+instr[i][j];\n\t  else if(b==1) dp[i][j]+=dp[i][j-1]+instr[i][j];\n\t  else{\n\t    if(instr[i][j]!='0') dp[i][j]=instr[i][j];\n\t  }\n\t}\n      }\n    }\n    flag=0;\n    for(i=1;i<=h;i++){\n      for(j=1;j<=w;j++){\n       \tif(flag==0&&lenmax==len[i][j]){\n\t  flag=1;\n\t  finalresult=dp[i][j];\n\t}\n\tif(flag==1&&lenmax==len[i][j]){\n\t  which=judge(dp[i][j],finalresult);\n\t  finalresult=which;\n\t}\n      }\n    }\n    cout << which << endl;\n  }\n  return 0;\n}\nstring judge(string a,string b){\n  int i,len,flag=0;\n  len=a.size();\n  for(i=0;i<len;i++){\n    if(a[i]>b[i]){\n      flag=1;\n      break;\n    }\n    else if(a[i]<b[i]){\n      flag=2;\n      break;\n    }\n  }\n  if(flag==0||flag==1) return a;\n  else return b;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define r(i,n) for(int i=0;i<n;i++)\nstring dp[70][70],m[70];\nint h,w;\nstring dfs(int y,int x){\n  if(dp[y][x].size())return dp[y][x];\n  string p1,p2;\n  if(y+1<h&&isdigit(m[y+1][x]))p1=dfs(y+1,x);\n  p1=m[y][x]+p1;\n  if(x+1<w&&isdigit(m[y][x+1]))p2=dfs(y,x+1);\n  p2=m[y][x]+p2;\n  if(p1.size()>p2.size())return dp[y][x]=p1;\n  else if(p1.size()==p2.size()&&p1>p2)return dp[y][x]=p1;\n  else return dp[y][x]=p2;\n}\nmain(){\n  while(cin>>w>>h,w){\n    r(i,h)r(j,w)dp[i][j]=\"\";\n    string p=\"\";\n    r(i,h)cin>>m[i];\n    r(i,h)r(j,w)if('1'<=m[i][j]&&m[i][j]<='9'){\n      string t=dfs(i,j);\n      if(t.size()>p.size())p=t;\n      else if(t.size()==p.size())p=max(t,p);\n    }\n    cout<<p<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr, __VA_ARGS__)\n// #define LOG(...)\n#define FOR(i, a, b) for(int i = (int)(a); i < (int)(b); ++i)\n#define REP(i, n) for(int i = 0; i < (int)(n); ++i)\n#define RREP(i, n) for(int i = (int)(n - 1); i >= 0; --i)\n#define RFOR(i, a, b) for(int i = (int)(b - 1); i >= (int)(a); --i)\n#define ALL(a) (a).begin(), (a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define EXIST(s, e) ((s).find(e) != (s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n#define SQ(n) (n) * (n)\n#define BIT(x, i) (((x) >> (i)) & 1)\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<char> vc;\ntypedef vector<pii> vpi;\ntypedef vector<pll> vpl;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vc> vvc;\ntypedef vector<vll> vvll;\n\nchar field[70][70];\nstring dp[70][70];\n\nstring strmax(string a, string b) {\n  if (a.length() > b.length()) return a;\n  if (a.length() < b.length()) return b;\n  return max(a, b);\n}\n\nint dx[] = {-1, 0};\nint dy[] = {0, -1};\n\nint main() {\n  int w, h;\n  while(cin >> w >> h, w) {\n    fill_n((char*)field, 70 * 70, ' ');\n    fill_n((string*)dp, 70 * 70, \"\");\n    REP(y, h) REP(x, w) {\n      cin >> field[y][x];\n      if (isdigit(field[y][x]))\n        dp[y][x] = field[y][x];\n    }\n\n    string maxs = \"\";\n    RREP(y, h) RREP(x, w) {\n      REP(i, 2){\n        int sx = x + dx[i];\n        int sy = y + dy[i];\n        if (sx < 0 || sx >= w || sy < 0 || sy >= h) continue;\n        if (isdigit(field[y][x]) && isdigit(field[sy][sx])) {\n          dp[sy][sx] = strmax(dp[sy][sx], field[sy][sx] + dp[y][x]);\n          // maxs = strmax(maxs, dp[sy][sx]);\n        }\n      }\n    }\n\n    REP(y, h) REP(x, w) {\n      while(*dp[y][x].begin() == '0') dp[y][x].erase(dp[y][x].begin());\n      maxs = strmax(maxs, dp[y][x]);\n    }\n    cout << maxs << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n\nusing namespace std;\n\ninline bool compare(string S1, string S2)\n{\n\tif (S1.size() != S2.size()) { return S1.size() > S2.size(); }\n\n\treturn S1 > S2;\n}\n\nint main()\n{\n\tint H, W; char R[71][71];\n\n\twhile (true)\n\t{\n\t\tscanf(\"%d\", &W);\n\t\tscanf(\"%d\", &H);\n\n\t\tif (H == 0 && W == 0) { break; }\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tscanf(\"%s\", R[i]);\n\t\t}\n\n\t\tvector<vector<string> > dp(H, vector<string>(W, \"\"));\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (isdigit(R[i][j]))\n\t\t\t\t{\n\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][j] = R[i][j];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i - 1][j] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]) && dp[i - 1][j] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i - 1][j] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (j != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i][j - 1] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]) && dp[i][j - 1] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i][j - 1] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ret = \"\";\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (compare(dp[i][j], ret))\n\t\t\t\t{\n\t\t\t\t\tret = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%s\\n\", ret.c_str());\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nchar tmp[72][72];\nint flg[72][72];\nstring score[72][72];\nvoid score_cl(){\n\tfor(int i=0;i<5184;i++)score[i/72][i%72]=\"\";\n}\nstring ans;\nvoid in(int w,int h){\n\tfor(int i=0;i<5184;i++)flg[i/72][i%72]=0;\n\tans=\"\";\n\tscore_cl();\n\tfor(int i=0;i<5184;i++)tmp[i/72][i%72]='#';\n\tfor(int i=1;i<=h;i++){\n\t\tfor(int j=1;j<=w;j++){\n\t\t\tcin>>tmp[j][i];\n\t\t}\n\t}\n}\n\nint com(string a,string b){\n\tif(a.size()>b.size())return 1;\n\tif(a.size()<b.size())return 0;\n\tif(a==b)return 2;\n\tfor(int i=0;i<a.size();i++){\n\t\tif(a[i]>b[i])return 1;\n\t\tif(a[i]<b[i])return 0;\n\t}\n}\n\n\n\nint main(){\n\tint w,h;\n\twhile(cin>>w>>h,w){\n\t\tin(w,h);\n\t\tfor(int j=1;j<=w;j++){\n\t\t\tfor(int i=1;i<=h;i++){\n\t\t\t\tif('1'<=tmp[j][i] && tmp[j][i]<='9' && flg[j][i]==0){\n\t\t\t\t\tscore_cl();\n\t\t\t\t\tqueue<int>X,Y;\n\t\t\t\t\tX.push(j);Y.push(i);\n\t\t\t\t\twhile(!X.empty()){\n\t\t\t\t\t\tint x=X.front();X.pop();\n\t\t\t\t\t\tint y=Y.front();Y.pop();\n\t\t\t\t\t\tscore[x][y]+=tmp[x][y];\n\t\t\t\t\t\tflg[x][y]=1;\n\t\t\t\t\t\tif(w-x+h-y+score[x][y].size()<ans.size())continue;\n\t\t\t\t\t\tif(com(score[x][y],ans))ans=score[x][y];\n\t\t\t\t\t\tif('0'<=tmp[x+1][y] && tmp[x+1][y]<='9' && com(score[x][y],score[x+1][y])){\n\t\t\t\t\t\t\tif(score[x+1][y]==\"\"){\n\t\t\t\t\t\t\t\tX.push(x+1);\n\t\t\t\t\t\t\t\tY.push(y);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tscore[x+1][y]=score[x][y];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif('0'<=tmp[x][y+1] && tmp[x][y+1]<='9' && com(score[x][y],score[x][y+1])){\n\t\t\t\t\t\t\tif(score[x][y+1]==\"\"){\n\t\t\t\t\t\t\t\tX.push(x);\n\t\t\t\t\t\t\t\tY.push(y+1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tscore[x][y+1]=score[x][y];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\t\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n#define rep(i,n) for(int i = 0; i < n ;++i)\n#define all(v) v.begin(),v.end()\n\nstring s[100];\nint w,h;\nint dx[2]={0,1};\nint dy[2]={1,0};\nbool used[100][100];\n//vector<string> vs;\nstring ans;\nstring t;\n\nvoid solve(int y,int x/*,string& t*/){\n  // cout<<s[y][x]<<endl;\n  used[y][x]=1;\n  t+=s[y][x];\n  if(ans.size()<t.size())ans=t;\n  else if(ans.size()==t.size()){\n      if(ans<t)ans=t;\n  }\n  rep(i,2){\n    int ny=dy[i]+y,nx=x+dx[i];\n    if(ny>=0&&ny<h&&nx>=0&&nx<w){\n      if(/*!used[ny][nx]&&*/s[ny][nx]>='0'&&s[ny][nx]<='9'){\n        // used[ny][nx]=1;\n        solve(ny,nx/*,t+s[ny][nx]*/);\n        //used[ny][nx]=0;\n      }\n    }\n  }\n  \n  if(t.size()){\n    t.resize(t.size()-1);\n  }\n    //t.erase(t.back());\n  //vssh_back(t);\n}\n\nbool F(string a,string b){\n  if(a.size()!=b.size())return a.size()>b.size();\n  return a>b;\n}\n\nint main(){\n    while(cin>>w>>h&&w+h){\n      //vs.clear();\n      ans=\"\";\n        rep(i,h)cin>>s[i];\n        rep(i,h)rep(j,w)used[i][j]=0;\n        rep(i,h){\n          rep(j,w){\n            if(!used[i][j]&&s[i][j]>='1'&&s[i][j]<='9'){\n              used[i][j]=1;\n              t=\"\";\n              // string t;\n              // t.push_back(s[i][j]);\n              solve(i,j);\n            }\n          }\n        }\n        // sort(all(vs),F);\n        // reverse(all(vs));\n        // cout<<vs[0]<<endl;\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <map>\n#include <unordered_map>\n#include <set>\n#include <unordered_set>\n#include <algorithm>\n#include <math.h>\n#include <string>\n#include <climits>\n#include <assert.h>\n\n#define FOR(i,a,b) for(int i= (a); i<((int)b); ++i)\n#define FOE(i,a) for(auto i : a)\n#define ALL(c) (c).begin(), (c).end()\n#define RALL(c) (c).rbegin(), (c).rend()\n#define SUM(x) std::accumulate(ALL(x), 0LL)\n#define MIN(v) *std::min_element(v.begin(), v.end())\n#define MAX(v) *std::max_element(v.begin(), v.end())\n#define EXIST(v,x) (std::find(v.begin(), v.end(), x) != v.end())\n#define IS_BIT_ON(bit, i) (bit & (1 << i))\n#define BIT_ON(bit, i) (bit | (1 << i))\n#define BIT_OFF(bit, i) (bit & ~(1 << i))\n#define BIT_COUNT(bit) (__builtin_popcount(bit))\n\ntypedef long long LL;\ntemplate<typename T> std::vector<T> make_v(size_t a){return std::vector<T>(a);}\ntemplate<typename T,typename... Ts> auto make_v(size_t a, Ts... ts){ return std::vector<decltype(make_v<T>(ts...))>(a,make_v<T>(ts...));}    // C++14\ntemplate<typename T,typename V> typename std::enable_if<std::is_class<T>::value==0>::type fill_v(T &t,const V &v){t=v;}\ntemplate<typename T,typename V> typename std::enable_if<std::is_class<T>::value!=0>::type fill_v(T &t,const V &v){for(auto &e:t) fill_v(e,v);}\ntemplate<class T> inline T ceil(T a, T b) { return (a + b - 1) / b; }\nvoid print() { std::cout << std::endl; }\ntemplate <class Head, class... Tail> void print(Head&& head, Tail&&... tail) { std::cout << head; if (sizeof...(tail) != 0) {std::cout << \" \";} print(std::forward<Tail>(tail)...); }\ntemplate <class T> void print(std::vector<T> &v) {for (auto& a : v) { std::cout << a; if (&a != &v.back()) {std::cout << \" \";} }std::cout << std::endl;}\ntemplate <class T> void print(std::vector<std::vector<T>> &vv) { for (auto& v : vv) { print(v); }}\ninline bool inside(long long y, long long x, long long H, long long W) {return 0 <= y and y < H and 0 <= x and x < W; }\ntemplate<class T> inline double euclidean_distance(T y1, T x1, T y2, T x2) { return sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2)); }\ntemplate<class T> inline double manhattan_distance(T y1, T x1, T y2, T x2) { return abs(x1 - x2) + abs(y1 - y2); }\ntemplate<typename T> T &chmin(T &a, const T &b) { return a = std::min(a, b); }\ntemplate<typename T> T &chmax(T &a, const T &b) { return a = std::max(a, b); }\n\ntemplate<class T> inline std::vector<T> unique(std::vector<T> v) {\n    sort(v.begin(), v.end());\n    v.erase(unique(v.begin(), v.end()), v.end());\n    return v;\n}\n// 初項s, 交差dのn個の数列の和\nlong long sum_of_arithmetic_progression(long long s, long long d, long long n) {\n    return n * (2 * s + (n - 1) * d) / 2;\n}\n\n// 2のべき乗数かどうか\nbool is_power_of_two(long long x) {\n    return !(x & (x - 1));\n}\n\n// aとbの最大公約数 O(log min(a, b))\nlong long gcd(long long a, long long b) {\n    if (b == 0) { return a; }\n    return gcd(b, a % b);\n}\n\n// 数列vの最大公約数 O(N log d)\nlong long gcd(std::vector<long long> &v) {\n    long long ans = v[0];\n    for (int i = 1; i < (int)v.size(); ++i) {\n        ans = gcd(ans, v[i]);\n    }\n    return ans;\n}\n\n// aとbの最小公倍数 O(log min(a, b))\nlong long lcm(long long a, long long b) {\n    long long g = gcd(a, b);\n    return a / g * b;\n}\n\nconst int INF = 1u << 30u;\nconst long long LINF = 1ull << 58u;\nconst double EPS = 1e-9;\nconst long double PI = acos(-1.0);\nconst std::vector<int> dy2 = {0, 1}, dx2 = {1, 0};  // 右，下\nconst std::vector<int> dy4 = {0, 1, 0, -1}, dx4 = {1, 0, -1, 0};    // 右，下，左，上\nconst std::vector<int> dy8 = { 0, -1, 0, 1, 1, -1, -1, 1 }, dx8 = { 1, 0, -1, 0, 1, 1, -1, -1 };\n\nusing namespace std;\n\nbool is_great(string &s, string &t) {\n    if (s.size() != t.size()) {\n        return s.size() > t.size();\n    }\n\n    FOR(i, 0, s.size()) {\n        if (s[i] > t[i]) {\n            return true;\n        }\n        if (s[i] < t[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while (true) {\n        LL W, H;\n        cin >> W >> H;\n\n        if (W == 0 and H == 0) {\n            return 0;\n        }\n\n        auto grid = make_v<string>(H);\n        FOR(i, 0, H) {\n            cin >> grid[i];\n        }\n\n        auto dp = make_v<string>(H, W);\n\n        if (grid[0][0] <= '9' and grid[0][0] != '0') {\n            dp[0][0] = grid[0][0];\n        }\n\n        string ans = \"\";\n        FOR(y, 0, H) {\n            FOR(x, 0, W) {\n\n                if (y + 1 < H and grid[y + 1][x] <= '9') {\n                    string s = dp[y][x] + grid[y + 1][x];\n                    if (is_great(s, dp[y + 1][x]) and s != \"0\") {\n                        dp[y + 1][x] = s;\n                    }\n                }\n                if (x + 1 < W and grid[y][x + 1] <= '9') {\n                    string s = dp[y][x] + grid[y][x + 1];\n                    if (is_great(s, dp[y][x + 1]) and s != \"0\") {\n                        dp[y][x + 1] = s;\n                    }\n                }\n\n                if (is_great(dp[y][x], ans)) {\n                    ans = dp[y][x];\n                }\n            }\n        }\n        print(ans);\n    }\n\n    return 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define REP(i, s , e) for(int i = (int)(s); i < (int)(e); ++i)\n#define rep(i, n) REP(i, 0, n)\nusing ll = long long int;\n\n#define REPR(i, s, e) for(int i = (int)(s-1); i >= (int)(e); --i)\n#define repr(i, n) REPR(i, n, 0)\n\nbool isdig(char c) {\n  return '0' <= c && c <= '9';\n}\n\nvoid calc(string& s, const string& t) {\n  if(s.size() < t.size()) s = t;\n  else if(s.size() == t.size()) {\n    rep(i, s.size()) {\n      if(s[i] < t[i]) {\n\ts = t;\n\treturn;\n      }\n      else if(s[i] > t[i]) {\n\treturn;\n      }\n    }\n  }\n}\n\nint main() {\n  int w, h;\n  while(cin >> w >> h) {\n    if(w == 0 && h == 0) break;\n    vector<string> s(h);\n    rep(i, h) cin >> s[i];\n    vector<vector<string>> dp(h, vector<string>(w));\n    repr(i, h) repr(j, w) {\n      if(!isdig(s[i][j])) continue;\n      dp[i][j] += s[i][j];\n      if(i+1 < h) calc(dp[i][j], s[i][j] + dp[i+1][j]);\n      if(j+1 < w) calc(dp[i][j], s[i][j] + dp[i][j+1]);\n    }\n      string ans = \"\";\n      rep(i, h) rep(j, w) if(dp[i][j].size() > 0 && dp[i][j][0] != '0') calc(ans, dp[i][j]);\n      cout << ans << endl;\n  }\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <iomanip>\n#include <algorithm>\n#include <cmath>\n#include <string>\n#include <vector>\n#include <list>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n#include <numeric>\n#include <climits>\n#include <cfloat>\nusing namespace std;\n\nint main()\n{\n    for(;;){\n        int w, h;\n        cin >> w >> h;\n        if(w == 0)\n            return 0;\n\n        vector<string> s(h+1);\n        for(int i=1; i<=h; ++i){\n            cin >> s[i];\n            s[i] = ' ' + s[i];\n        }\n\n        vector<vector<string> > best(h+1, vector<string>(w+1));\n        string ret;\n        for(int i=1; i<=h; ++i){\n            for(int j=1; j<=w; ++j){\n                if('0' <= s[i][j] && s[i][j] <= '9'){\n                    if(best[i-1][j].size() > best[i][j-1].size())\n                        best[i][j] = best[i-1][j];\n                    else if(best[i-1][j].size() < best[i][j-1].size())\n                        best[i][j] = best[i][j-1];\n                    else\n                        best[i][j] = max(best[i-1][j], best[i][j-1]);\n                    best[i][j] += s[i][j];\n                    if(best[i][j] == \"0\")\n                        best[i][j] = \"\";\n\n                    if(best[i][j].size() > ret.size())\n                        ret = best[i][j];\n                    else if(best[i][j].size() == ret.size())\n                        ret = max(ret, best[i][j]);\n                }\n            }\n        }\n        cout << ret << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<string>\n#include<vector>\nusing namespace std;\n\nint h, w;\nchar field[100][100];\nstring used[100][100];\n\nstring ans;\n\nint vx[2] = {0, 1}, vy[2] = {1, 0};\n\nbool comp(string s1, string s2){\n\tif(s1 == s2)return false;\n\tif(s1.size() < s2.size())return true;\n\telse if(s1.size() > s2.size())return false;\n\telse{\n\t\t//今のと比較\n\t\tfor(int i = 0; i < s1.size(); i++){\n\t\t\tif(s2[i] > s1[i]){\n\t\t\t\treturn true;\n\t\t\t}else if(s2[i] < s1[i]){\n\t\t\t\treturn false;\t\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(h + w == 0)break;\n\t\t\n\t\tfor(int i = 0; i < h; i++)for(int j = 0; j < w; j++)used[i][j] = \"\";\n\n\n\t\tfor(int i = 0; i < h; i++)for(int j = 0; j < w; j++)\n\t\t\tcin >> field[i][j];\n\n\t\tfor(int i = 0; i < h; i++){\n\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\tif(field[i][j] >= '0' && field[i][j] <= '9'){\n\t\t\t\t\tif(used[i][j] == \"\"){\n\t\t\t\t\t\tif(field[i][j] == '0')continue;\n\t\t\t\t\t\tused[i][j] += field[i][j];\n\t\t\t\t\t\tif(comp(ans, used[i][j]))ans = used[i][j];\n\n\t\t\t\t\t}\n\t\t\t\t\tfor(int k = 0; k < 2; k++){\n\t\t\t\t\t\tint nx = i + vx[k], ny = j + vy[k];\n\n\t\t\t\t\t\tif(nx < 0 || ny < 0 || nx >= h || ny >= w)continue;\n\t\t\t\t\t\tif(field[nx][ny] >= '0' && field[nx][ny] <= '9'){\n\t\t\t\t\t\tif(comp(used[nx][ny], used[i][j] + field[nx][ny])){\n\t\t\t\t\t\t\tused[nx][ny] = used[i][j] + field[nx][ny];\n\t\t\t\t\t\t\tif(comp(ans, used[nx][ny]))ans = used[nx][ny];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\n\t\tans = \"\";\n\t\t\n\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\nint w, h;\nstring s[51], dp[51][51];\nbool is_num(char c){return '0'<=c && c<= '9';}\n\nstring str_max(string s1, string s2) {\n  if (s1.size() == s2.size()) {\n    return (s1 > s2) ? s1 : s2 ;\n  }\n  return (s1.size() > s2.size())? s1 : s2 ;\n}\n\nstring dfs(int i, int j) {\n  string res = \"\";\n  \n  // l¶áÈ¢ê\n  if (!is_num(s[i][j])) return res;\n  // DP\n  if (dp[i][j] != \"\") return dp[i][j];\n  \n  if (i+1 >= h && j+1 >= w) {\n    // EÉàºÉàißÈ¢\n    res += s[i][j];\n  } else if (i+1 >= h) {\n    // EÉ¾¯ißé\n    res += s[i][j] + dfs(i, j+1);\n  } else if (j+1 >= w) {\n    // ºÉ¾¯ißé\n    res += s[i][j] + dfs(i+1, j);\n  } else {\n    // Ç¿çÉàißé\n    res = s[i][j] + str_max(dfs(i, j+1), dfs(i+1, j));\n  }\n  // ªÉ0ªÂ¢Ä¢éêÍæé\n  if (i == 0 && j == 0) {\n    if (res[0] == '0') res.erase(0, 1);\n  } else if (i == 0) {\n    if (!is_num(s[i][j-1]) && res[0] == '0') res.erase(0, 1);\n  } else if (j == 0) {\n    if (!is_num(s[i-1][j]) && res[0] == '0') res.erase(0, 1);\n  } else{\n    if (!is_num(s[i-1][j]) && !is_num(s[i][j-1])) res.erase(0, 1);\n  }\n  \n  return dp[i][j] = res;\n}\n\nvoid solve() {\n  for(int i=0;i<h;i++) cin>>s[i];\n  \n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  dp[i][j] = \"\";\n  \n  string largest = \"\";\n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  if (is_num(s[i][j])) {\n    largest = str_max(dfs(i, j), largest);\n  }\n  \n  cout<<largest<<endl;\n}\n\nint main (int argc, char const* argv[]) {\n  while (cin>>w>>h, w||h) {\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cmath>\n#include <algorithm>\n#include <cstdlib>\n#include <ctime>\n#include <cstdio>\n#include <functional>\n#include <set>\n#include <sstream>\n#include <map>\n#include <queue>\n#include <stack>\n\nusing namespace std;\n\nvoid zero_erase(string &s){\n\tint pos=0;\n\twhile(s[pos]=='0' && pos<s.size()) pos++;\n\ts.erase(s.begin(),s.begin()+pos);\n}\n\n// x>y\nbool comp(string &x, string &y)\n{\n\tzero_erase(x);\n\tzero_erase(y);\n\t\n\treturn (x.size()>y.size() || (x.size()==y.size() && x>y ));\n}\n\nstring max_str(string x, string y){\n\tif(comp(x,y)) return x;\n\telse return y;\n}\n\nbool ok(string s){\n\treturn '0'<= s[0] && s[0]<='9';\n}\n\nint main()\n{\n\tint w,h;\n\twhile(cin>>w>>h , w||h){\n\t\t\n\t\tstring mat[100][100];\n\t\tstring dp[100][100];\n\t\tfor(int i=0;i<h;i++){\n\t\t\tstring s;\n\t\t\tcin>>s;\n\t\t\tfor(int j=0;j<s.size();j++) dp[i][j]=mat[i][j]=s[j];\n\t\t}\n\t\t\n\t\tstring ans;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tif(!ok(dp[i][j])) continue;\n\t\t\t\tans=max_str(ans,dp[i][j]);\n\t\t\t\tif(i+1<h && ok(dp[i+1][j])){\n\t\t\t\t\tdp[i+1][j]=max_str(dp[i+1][j],dp[i][j]+mat[i+1][j]);\n\t\t\t\t}\n\t\t\t\tif(j+1<w && ok(dp[i][j+1])){\n\t\t\t\t\tdp[i][j+1]=max_str(dp[i][j+1],dp[i][j]+mat[i][j+1]);\n\t\t\t\t}\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a; i<b; ++i)\n#define rep(i,n) REP(i,0,n)\n\nchar input[70][70];\nstring dp[70][70];\n\nint comp(string s,string t) {\n  if(s.length() != t.length()) return (s.length() - t.length());\n  rep(i,s.length()) if(s[i] != t[i]) return (s[i] - t[i]);\n  return 0;\n}\n\nint main() {\n  int w,h,n;\n  while(cin>>w>>h, w|h) {\n    string s,above,left;\n    rep(i,h) {\n      cin>>s;\n      rep(j,w) {\n\tdp[i][j] = \"\";\n\tinput[i][j] = s[j];\n      }\n    }\n\n    rep(i,h) rep(j,w) {\n      char c = input[i][j];\n      if(!(c <= '9' && c >= '0')) continue;\n      above = ((i > 0) ? dp[i-1][j] : \"\") + string(1,c);\n      left = ((j > 0) ? dp[i][j-1] : \"\") + string(1,c);\n      dp[i][j] = (comp(above,left) <= 0) ? left : above;\n      if(dp[i][j][0] == '0') dp[i][j] = dp[i][j].substr(1);\n    }\n\n    string ans = \"\";\n    rep(i,h) rep(j,w) if(comp(ans,dp[i][j]) < 0) ans = dp[i][j];\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n\nusing namespace std;\n\nint w, h;\nvector<string> data;\nvector<vector<string> > str;\n\nstring get_large(const string& a, const string& b){\n  if(a.size() != b.size())\n    return (a.size() > b.size()) ? a : b;\n  for(int i=0; i<a.size(); ++i){\n    if(a[i] != b[i]) return (a[i] > b[i]) ? a : b;\n  }\n  return a;\n}\n\nstring dfs(int i, int j){\n  if(!(i>=0 && i<h)) return string();\n  if(!(j>=0 && j<w)) return string();\n  if(!(data[i][j]>='0' && data[i][j]<='9')) return string();\n  if(str[i][j].empty())\n    str[i][j] = data[i][j] + get_large(dfs(i+1, j), dfs(i, j+1));\n  return str[i][j];\n}\n\nstring solve(){\n  string ans = \"0\";\n  for(int i=0; i<h; ++i){\n    for(int j=0; j<w; ++j){\n      if(data[i][j]>='1' && data[i][j]<='9' &&\n\t str[i][j].empty()) ans = get_large(ans, dfs(i, j));\n    }\n  }\n  return ans;\n}\n\nint main(){\n  while(1){\n    cin >> w >> h;\n    if(!w && !h) break;\n    data = vector<string>(h);\n    str = vector<vector<string> >(h, vector<string>(w));\n    for(int i=0; i<h; ++i) cin >> data[i];\n    cout << solve() << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\ntypedef long long LL;\n#define SORT(c) sort((c).begin(),(c).end())\n\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\nusing namespace std;\nint w,h;\nvector<string> field;\nvector<vector<bool> > check;\nvector<string> code;\nvoid createcode(int i,int j,string tmp)\n{\n  if(0<=i&&i<h&&0<=j&&j<w){\n    check[i][j]=true;\n    if('0'<=field[i][j]&&field[i][j]<='9'){\n      string nextmp=tmp;\n      nextmp.push_back(field[i][j]);\n      createcode(i+1,j,nextmp);\n      createcode(i,j+1,nextmp);\n    }\n  }\n  else code.push_back(tmp);\n}\n  \nint main(void)\n{\n  for(;;){\n    cin >> w >> h;\n    if(!w&&!h) return 0;\n    field.resize(h);\n    REP(i,h) cin >> field[i];\n    check.resize(h);\n    REP(i,h) check[i].assign(w,false);\n    code.clear();\n    REP(i,h) REP(j,w){\n      if(!check[i][j]){\n\tcheck[i][j]=true;\n\tif('1'<=field[i][j]&&field[i][j]<='9')createcode(i,j,\"\");\n      }\n    }\n    string answer=\"0\";\n    REP(i,code.size()){\n      if(code[i].size()>answer.size() || (code[i].size()==answer.size() && code[i]>answer))\n\tanswer=code[i];\n    }\n    cout << answer << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n \nstring chmax(string a, string b){\n  if(a.size() < b.size()) return b;\n  else if(a.size() > b.size()) return a;\n  else return a > b ? a : b;\n}\n \nint main(){\n  int W, H;\n  char C[70][70];\n  string dp[70][70];\n \n  while(cin >> W >> H, W){\n    for(int i = 0; i < H; ++i){\n      for(int j = 0; j < W; ++j){\n        cin >> C[i][j];\n      }\n    }\n    for(int i = 0; i < H; ++i){\n      for(int j = 0; j < W; ++j){\n        if(isdigit(C[i][j])) dp[i][j] = string( 1, C[i][j]);\n        else dp[i][j] = \"0\";\n      }\n    }\n    for(int j = 0; j < H; ++j){\n      for(int k = 0; k < W; ++k){\n        if(dp[j][k] == \"0\") continue;\n        if(k + 1 < W && isdigit(C[j][k + 1])) dp[j][k + 1] = chmax( dp[j][k + 1], dp[j][k] + C[j][k + 1]);\n        if(j + 1 < H && isdigit(C[j + 1][k])) dp[j + 1][k] = chmax( dp[j + 1][k], dp[j][k] + C[j + 1][k]);\n      }\n    }\n    string ret = \"0\";\n    for(int i = 0; i < H; ++i){\n      for(int j = 0; j < W; ++j) ret = chmax( ret, dp[i][j]);\n    }\n    cout << ret << endl;\n  }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <map>\n#include <algorithm>\n#include <queue>\n#include <unordered_map>\n\n#define lli long long int\n#define REP(i,n) for(lli i=0;i<n;i++)\n\n#define NUM 1000000\n\nusing namespace std;\n\nint length = 0;\n\nint max1(int a, int b){\n\tif (a >= b)return a;\n\telse return b;\n}\n\nint isIn(int x, int y, int w, int h){\n\tif (x < 0 || w <= x || y < 0 || h <= y){\n\t\treturn 0;\n\t}\n\telse{\n\t\treturn 1;\n\t}\n}\n\nint isNum(int x, int y, string *data){\n\tif ('0' <= data[y].at(x) && data[y].at(x) <= '9'){\n\t\treturn 1;\n\t}\n\telse{\n\t\treturn 0;\n\t}\n}\n\nstring emitZero(string str){\n\n\tstring rStr = \"\";\n\tREP(i, str.size()){\n\t\tif (str.at(i) != '0'){\n\t\t\trStr = str.substr(i, str.size());\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn rStr;\n\n}\n\nstring largeStr(string a, string b){\n\tif (a.size() > b.size()){\n\t\treturn a;\n\t}\n\telse if (a.size() == b.size()){\n\t\tif (a >= b){\n\t\t\treturn a;\n\t\t}\n\t\telse{\n\t\t\treturn b;\n\t\t}\n\t}\n\telse{\n\t\treturn b;\n\t}\n}\n\n\n/*\nvoid solve(int x, int y,int w,int h,string now,string *data, vector<string> *v,int **flag){\n\t\n\tif (!isIn(x,y,w,h) || isNum(x,y,data)==0){\n\t\t//cout << now << endl;\n\t\tnow = emitZero(now);\n\t\t//cout << now << endl;\n\t\t//cout << \"now.size = \" << now.size() << endl;\n\t\tlength = max1(length, now.size());\n\t\tv->push_back(now);\n\t\treturn;\n\t}\n\telse{\n\t\tflag[y][x] = 1;\n\t\tstring next = now + data[y].at(x);\n\t\tsolve(x + 1, y, w, h, next, data, v,flag);\n\t\tsolve(x, y + 1, w, h, next, data, v,flag);\n\t}\n}\n*/\n\nclass Point{\n\nprivate:\n\tint x, y;\npublic:\n\tvoid set(int sX, int sY){\n\t\tx = sX;\n\t\ty = sY;\n\t}\n\tint getX(){ return x; }\n\tint getY(){ return y; }\n\n\tbool operator < (const Point & right)const{\n\t\treturn x + y*NUM < right.x + right.y*NUM;\n\t}\n\n\tvoid show(){\n\t\tcout << \"X=\" << x << \" Y=\" << y << endl;\n\t}\n};\n\nclass now{\nprivate:\n\tPoint p;\n\tstring str;\npublic:\n\n\tvoid set(int sX, int sY, string sStr){\n\t\tp.set(sX, sY);\n\t\tstr = sStr;\n\t}\n\n\tPoint getPoint(){ return p; }\n\tstring getStr(){ return str; }\n\n};\n\nint main(){\n\n\n\t\n\tint w, h;\n\n\twhile (cin >> w >> h){\n\t\tif (w == 0 && h == 0)break;\n\t\tlength = 0;\n\t\tstring *data;\n\t\tdata = new string[h];\n\n\t\tREP(i, h){\n\t\t\tcin >> data[i];\n\t\t}\n\t\tint **flag = new int *[h];\n\t\tvector<string> v;\n\t\tqueue<Point> q;\n\t\tstring firstStr;\n\t\tmap<Point, string> m;\n\t\tPoint p;\n\t\tp.set(w - 1, h - 1);\n\t\tq.push(p);\n\t\t//q.front().show();\n\n\t\tREP(i, 100){\n\t\t\tREP(j, 100){\n\t\t\t\tPoint temp;\n\t\t\t\ttemp.set(i, j);\n\t\t\t\tm[temp] = \"\";\n\t\t\t}\n\t\t}\n\n\t\twhile (q.size() != 0){\n\n\t\t\tint unko;\n\t\t\t//cin >> unko;\n\t\t\tp = q.front();\n\t\t\tq.pop();\n\t\t\t//p.show();\n\n\n\t\t\tif (isNum(p.getX(), p.getY(), data) == 1){\n\t\t\t\tPoint right, down;\n\t\t\t\tright.set(p.getX() + 1, p.getY());\n\t\t\t\tdown.set(p.getX(), p.getY() + 1);\n\n\t\t\t\t//cout << data[p.getY()][p.getX()] << endl;\n\n\t\t\t\tm[p] = largeStr(m[p],data[p.getY()][p.getX()]+largeStr(m[right], m[down]));\n\t\t\t\t//cout << m[p] << endl;\n\t\t\t}\n\n\t\t\tif (p.getX() - 1 >= 0){\n\t\t\t\tPoint left;\n\t\t\t\tleft.set(p.getX() - 1, p.getY());\n\t\t\t\tq.push(left);\n\t\t\t}\n\t\t\tif (p.getY() - 1 >= 0){\n\t\t\t\tPoint up;\n\t\t\t\tup.set(p.getX(), p.getY() - 1);\n\t\t\t\tq.push(up);\n\t\t\t}\n\t\t}\n\n\t\tint length = 0;\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tPoint tmp;\n\t\t\t\ttmp.set(j, i);\n\t\t\t\tstring tmpStr = m[tmp];\n\t\t\t\ttmpStr = emitZero(tmpStr);\n\n\t\t\t\tv.push_back(tmpStr);\n\t\t\t\tlength = max1(length, tmpStr.size());\n\t\t\t}\n\t\t}\n\n\t\tvector<string> ans;\n\n\t\tREP(i, v.size()){\n\t\t\tif (length == v.at(i).size()){\n\t\t\t\tans.push_back(v[i]);\n\t\t\t}\n\t\t}\n\n\t\tsort(ans.begin(), ans.end());\n\n\t\tcout << ans.back() << endl;\n\n\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <iomanip>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <bitset>\n#include <stack>\n#include <utility>\n#include <numeric>\n#include <algorithm>\n#include <functional>\n#include <cctype>\n#include <complex>\n#include <string>\n#include <sstream>\n\nusing namespace std;\n\n#define all(c) c.begin(),c.end()\n#define rall(c) c.rbegin(),c.rend()\n#define mp(a,b) make_pair((a),(b))\n#define eq ==\n\ntypedef long long ll;\ntypedef complex<double> point;\ntypedef pair<int,int> pii;\n\n\nconst double EPS = 1e-9;\n\nstring maxs(string a,string b){\n    while(a.size() >= 1){\n        if(a[0] != '0') break;\n        a = a.substr(1,a.size()-1);\n    }\n    while(b.size() >= 1){\n        if(b[0] != '0') break;\n        b = b.substr(1,b.size()-1);\n    }\n    if(a.length() > b.length()) return a;\n    if(a.length() < b.length()) return b;\n    for(int i=0;i<a.length();i++){\n        if(a[i] > b[i]) return a;\n        if(a[i] < b[i]) return b;\n    }\n    return a;\n}\n\nstring choos(string a,string b){\n    if(a.length() > b.length()) return a;\n    else if(a.length() < b.length()) return b;\n    else {\n        for(int i=0;i<a.length();i++){\n            if(a[i] > b[i]) return a;\n            else if(a[i] < b[i]) return b;\n        }\n        return a;\n    }\n}\nint dx[] = {0,-1};\nint dy[] = {-1,0};\nint main(){\n    while(true){\n        int W,H;\n        cin >> W >> H;\n        if(W == 0) break;\n        vector<vector<char> > C(H+2,vector<char>(W+2,'A'));\n        vector<vector<string> > memo(H+2,vector<string>(W+2));\n        for(int i=1;i<=H;i++){\n            for(int j=1;j<=W;j++){\n                cin >> C[i][j];\n            }\n        }\n        string ret = \"0\";\n        for(int y=H+1;y>=0;y--){\n            for(int x=W+1;x>=0;x--){\n                if(memo[y][x] == \"\" && isdigit(C[y][x])){\n                    memo[y][x] = C[y][x];\n                    ret = maxs(ret,string(1,C[y][x]));\n                }\n                if(isdigit(C[y][x])){\n                    for(int i=0;i<2;i++){\n                        int nx=x+dx[i];\n                        int ny=y+dy[i];\n                        if(isdigit(C[ny][nx])){\n                            memo[ny][nx] = choos(C[ny][nx] + memo[y][x],memo[ny][nx]);\n                            ret = maxs(ret,C[ny][nx]+memo[y][x]);\n                        }\n                    }\n                }\n            }\n        }\n        // for(int i=0;i<H+2;i++){\n        //     for(int j=0;j<W+2;j++){\n        //         cerr << memo[i][j] << \" \";\n        //     }\n        //     cerr << endl;\n        // }\n        cout << ret << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define LL long long\n#define VI vector<int>\n#define VVI vector<vector<int>>\n#define VVVI vector<vector<vector<int>>>\n#define VVVVI vector<vector<vector<vector<int>>>>\n#define VL vector<LL>\n#define VVL vector<vector<LL>>\n#define VVVL vector<vector<vector<LL>>>\n#define VVVVL vector<vector<vector<vector<LL>>>>\n#define VB vector<bool>\n#define FOR(i,a,b) for(int i= (a); i<((int)b); ++i)\n#define RFOR(i,a) for(int i=(a); i >= 0; --i)\n#define FOE(i,a) for(auto i : a)\n#define ALL(c) (c).begin(), (c).end()\n#define RALL(c) (c).rbegin(), (c).rend()\n#define DUMP(x)  cerr << #x << \" = \" << (x) << endl;\n#define SUM(x) std::accumulate(ALL(x), 0LL)\n#define MIN(v) *std::min_element(v.begin(), v.end())\n#define MAX(v) *std::max_element(v.begin(), v.end())\n#define EXIST(v,x) (std::find(v.begin(), v.end(), x) != v.end())\n#define BIT(n) (1LL<<(n))\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end());\n#define EPS 1e-14\n\ntemplate<class T> T ceil(T a, T b) { return (a + b - 1) / b; }\ntemplate<class T> void print(T x) { std::cout << x << std::endl; }\ninline bool inside(int y, int x, int H, int W) { return 0 <= y and y < H and 0 <= x and x < W; }\n\nconst std::string YES = \"YES\", Yes = \"Yes\", NO = \"NO\", No = \"No\";\nconst std::vector<int> dy = { 0, 1, 0, -1 }, dx = { 1, 0, -1, 0 };    // 4近傍（右, 下, 左, 上）\n\nusing namespace std;\n\nstring big(string a, string b) {\n    if (a.size() < b.size()) { return b; }\n    if (a.size() > b.size()) { return a; }\n    return a > b ? a : b;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while (true) {\n        int W, H;\n        cin >> W >> H;\n        if (W == 0 and H == 0) { break; }\n\n        vector<vector<int>> field(H, vector<int>(W, -1));\n        FOR(i, 0, H) {\n            string s;\n            cin >> s;\n            FOR(j, 0, s.size()) {\n                if (s[j] < 'A') {\n                    field[i][j] = (s[j] - '0');\n                }\n            }\n        }\n\n        vector<vector<string>> dp(H, vector<string>(W));\n        FOR(y, 0, H) {\n            FOR(x, 0, W) {\n                if (field[y][x] == -1) {\n                    continue;\n                }\n\n                // 0 startはだめ\n                if (dp[y][x].empty() and field[y][x] == 0) {\n                    continue;\n                }\n\n                // start\n                if (dp[y][x].empty()) {\n                    dp[y][x] = to_string(field[y][x]);\n                }\n\n                if (y + 1 < field.size() and field[y + 1][x] != -1) {\n                    string new_c = dp[y][x] + to_string(field[y + 1][x]);\n                    dp[y + 1][x] = big(dp[y + 1][x], new_c);\n                }\n                if (x + 1 < field[0].size() and field[y][x + 1] != -1) {\n                    string new_c = dp[y][x] + to_string(field[y][x + 1]);\n                    dp[y][x + 1] = big(dp[y][x + 1], new_c);\n                }\n            }\n        }\n\n        string ans = \"\";\n        FOR(y, 0, dp.size()) {\n            FOR(x, 0, dp[0].size()) {\n                ans = big(ans, dp[y][x]);\n            }\n        }\n\n        print(ans);\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <utility>\n#include <cctype>\nusing namespace std;\n\nchar F[70][70];\n\n// s <= t ?\nbool compare(string s, string t) {\n  int ls, lt;\n  for(ls = 0; s[ls] == '0'; ++ls) ;\n  for(lt = 0; t[lt] == '0'; ++lt) ;\n  s = s.substr(ls);\n  t = t.substr(lt);\n  if(s.length() < t.length()) return true;\n  if(s.length() > t.length()) return false;\n  for(int i = 0; i < s.length(); ++i) {\n    if(s[i] > t[i]) return false;\n  }\n  return true;\n}\n\nint main() {\n  while(true) {\n    int W, H; cin >> W >> H;\n    if(W == 0 && H == 0) break;\n    for(int i = 0; i < H; ++i) cin >> F[i];\n    string ans = \"0\";\n    queue<pair<pair<int,int>,string>> Q;\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        if(isdigit(F[i][j])) {\n          string s;\n          s.push_back(F[i][j]);\n          Q.emplace(make_pair(make_pair(i,j),s));\n        }\n      }\n    }\n    while(!Q.empty()) {\n      auto p = Q.front(); Q.pop();\n      if(compare(ans, p.second)) ans = p.second;\n      int i = p.first.first;\n      int j = p.first.second;\n      if(i + 1 < H && isdigit(F[i+1][j])) {\n        string s = p.second;\n        s.push_back(F[i+1][j]);\n        Q.emplace(make_pair(make_pair(i+1,j),s));\n      }\n      if(j + 1 < W && isdigit(F[i][j+1])) {\n        string s = p.second;\n        s.push_back(F[i][j+1]);\n        Q.emplace(make_pair(make_pair(i,j+1),s));\n      }\n    }\n\n    int l = 0;\n    while(ans[l] == '0') ++l;\n    ans = ans.substr(l);\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <algorithm>\n\n\nusing namespace std;\n\n\nstring max_strnum(string strnum_a, string strnum_b) {\n    if(strnum_a.length() > strnum_b.length()) {\n        return strnum_a;\n    } else if(strnum_a.length() < strnum_b.length()) {\n        return strnum_b;\n    }\n    for(int i = 0; i < strnum_a.length(); i++) {\n        if(strnum_a[i] > strnum_b[i]) {\n            return strnum_a;\n        } else if(strnum_a[i] < strnum_b[i]) {\n            return strnum_b;\n        }\n    }\n    return strnum_a;\n}\n\nvoid board_search(\n    int i, int j,\n    const vector<string>& board, vector<vector<int>> board_states,\n    string& ret, string& candidate\n) {\n    if(i >= board.size() || j >= board[0].size()\n    || board[i][j] > '9' || board[i][j] < '0'\n    ) {\n        ret = max_strnum(ret, candidate);\n        return;\n    }\n    board_states[i][j] = 1;\n    candidate.push_back(board[i][j]);\n    board_search(i+1, j, board, board_states, ret, candidate);\n    candidate.erase(candidate.end()-1);\n    candidate.push_back(board[i][j]);\n    board_search(i, j+1, board, board_states, ret, candidate);\n    candidate.erase(candidate.end()-1);\n}\n\nint main() {\n    while(true) {\n        int w, h; cin >> w >> h;\n        if(w == 0 && h == 0) return 0;\n        vector<string> board;\n        vector<vector<int>> board_states;\n        for(int i = 0; i < h; i++) {\n            string temp; cin >> temp;\n            board.push_back(temp);\n            board_states.emplace_back(w, 0);\n        }\n        string ret = \"\";\n        for(int i = 0; i < h; i++) {\n            for(int j = 0; j < w; j++) {\n                if(board_states[i][j] == 1 || ret.length() > w + h - 1) continue;\n                string candidate = \"\";\n                board_search(i, j, board, board_states, ret, candidate);\n            }\n        }\n        cout << ret << endl;\n    }\n}\n\n// [Problem] The Secret Number\n// http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define each(itr,v) for(auto itr:v)\n#define pb(s) push_back(s)\n#define mp(a,b) make_pair(a,b)\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define maxch(x,y) x=max(x,y)\n#define minch(x,y) x=min(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt(x) bitset<32>(x).count()\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> P;\ntypedef pair<P, int> PPI;\ntypedef pair<ll, ll> PL;\ntypedef pair<P, ll> PPL;\n\n#define INF INT_MAX/3\n\n#define MAX_N 1000\n\nint w,h;\nstring s[77];\n\nstring mem[77][77];\n\nstring bigger(string s1,string s2){\n\tif(s1.length()>s2.length())return s1;\n\telse if(s1.length()<s2.length())return s2;\n\telse if(s1>s2)return s1;\n\telse return s2;\n}\n\nstring dfs(int i,int j){\n\tif(mem[i][j]!=\"\")return mem[i][j];\n\tstring res=\"\";\n\tif(i+1<h&&isdigit(s[i+1][j]))res=bigger(res,dfs(i+1,j));\n\tif(j+1<w&&isdigit(s[i][j+1]))res=bigger(res,dfs(i,j+1));\n\treturn mem[i][j]=s[i][j]+res;\n}\n\nint main(){\n\tcin.sync_with_stdio(false);\n\twhile(1){\n\t\tcin>>w>>h;\n\t\tif(w==0)break;\n\t\trep(i,h)cin>>s[i];\n\t\tstring res=\"\";\n\t\trep(i,h+1)rep(j,w+1)mem[i][j]=\"\";\n\t\trep(i,h)rep(j,w){\n\t\t\tif(isdigit(s[i][j])&&s[i][j]!='0')res=bigger(res,dfs(i,j));\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "//51\n#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cctype>\n\nusing namespace std;\n\nchar g[70][71];\nstring mem[70][70];\nint w,h;\n\nbool cmp(string a,string b){\n  if(a.size()!=b.size()){\n    return a.size()<b.size();\n  }else{\n    return a<b;\n  }\n}\n\nstring dfs(int y,int x){\n  if(y<0||h<=y||x<0||w<=x||isalpha(g[y][x])){\n    return \"\";\n  }else if(mem[y][x]!=\"\"){\n    return mem[y][x];\n  }else{\n    mem[y][x]=g[y][x]+max(dfs(y+1,x),dfs(y,x+1),cmp);\n    return mem[y][x];\n  }\n}\n\nint main(){\n  while(cin>>w>>h,w|h){\n    for(int i=0;i<h;i++){\n      cin>>g[i];\n    }\n    string ans;\n    fill(mem[0],mem[70],\"\");\n    for(int y=0;y<h;y++){\n      for(int x=0;x<w;x++){\n\tif(g[y][x]!='0'){\n\t  ans=max(ans,dfs(y,x),cmp);\n\t}\n      }\n    }\n    cout<<ans<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": " \n#include <bits/stdc++.h>\nusing namespace std;\nusing vi=vector<int>;\nusing vvi=vector<vi>;\nusing vs=vector<string>;\nusing msi=map<string,int>;\nusing mii=map<int,int>;\nusing pii=pair<int,int>;\nusing vlai=valarray<int>;\nusing ll=long long;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define range(i,s,n) for(int i=s;i<n;i++)\n#define all(a) a.begin(),a.end()\n#define rall(a) a.rbegin(),a.rend()\n#define fs first\n#define sc second\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define INF 1e9\n#define EPS 1e-9\n\nstring cmp(string a,string b){\n    if(a.size()==b.size())return a<b?b:a;\n    else return a.size()<b.size()?b:a;\n}\n\nint main(){\n\tint w,h;\n\twhile(cin>>w>>h,w){\n\t    string ans=\"\";\n\t    vector<vs> v(h+2,vs(w+2,\"\"));\n\t    range(i,1,h+1)range(j,1,w+1){\n\t        cin>>setw(1)>>v[i][j];\n\t        if(!isdigit(v[i][j][0])) v[i][j]=\"\";\n\t        else v[i][j]=cmp(v[i-1][j],v[i][j-1])+v[i][j];\n\t        if(v[i][j][0]=='0')v[i][j]=v[i][j].substr(1);\n\t        ans=cmp(ans,v[i][j]);\n\t    }\n\t    cout<<ans<<endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define LL long long\n#define VI vector<int>\n#define VVI vector<vector<int>>\n#define VVVI vector<vector<vector<int>>>\n#define VVVVI vector<vector<vector<vector<int>>>>\n#define VL vector<LL>\n#define VVL vector<vector<LL>>\n#define VVVL vector<vector<vector<LL>>>\n#define VVVVL vector<vector<vector<vector<LL>>>>\n#define VB vector<bool>\n#define FOR(i,a,b) for(int i= (a); i<((int)b); ++i)\n#define RFOR(i,a) for(int i=(a); i >= 0; --i)\n#define FOE(i,a) for(auto i : a)\n#define ALL(c) (c).begin(), (c).end()\n#define RALL(c) (c).rbegin(), (c).rend()\n#define DUMP(x)  cerr << #x << \" = \" << (x) << endl;\n#define SUM(x) std::accumulate(ALL(x), 0LL)\n#define MIN(v) *std::min_element(v.begin(), v.end())\n#define MAX(v) *std::max_element(v.begin(), v.end())\n#define EXIST(v,x) (std::find(v.begin(), v.end(), x) != v.end())\n#define BIT(n) (1LL<<(n))\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end());\n#define EPS 1e-14\n\ntemplate<class T> T ceil(T a, T b) { return (a + b - 1) / b; }\ntemplate<class T> void print(T x) { std::cout << x << std::endl; }\ninline bool inside(int y, int x, int H, int W) { return 0 <= y and y < H and 0 <= x and x < W; }\n\nconst std::string YES = \"YES\", Yes = \"Yes\", NO = \"NO\", No = \"No\";\nconst std::vector<int> dy = { 0, 1, 0, -1 }, dx = { 1, 0, -1, 0 };    // 4近傍（右, 下, 左, 上）\n\nusing namespace std;\n\nstring big(string a, string b) {\n    if (a.size() < b.size()) { return b; }\n    if (a.size() > b.size()) { return a; }\n    return a > b ? a : b;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while (true) {\n        int W, H;\n        cin >> W >> H;\n        if (W == 0 and H == 0) { break; }\n\n        vector<vector<int>> field(H, vector<int>(W, -1));\n        FOR(i, 0, H) {\n            string s;\n            cin >> s;\n            FOR(j, 0, s.size()) {\n                if (s[j] < 'A') {\n                    field[i][j] = (s[j] - '0');\n                }\n            }\n        }\n\n        vector<vector<string>> dp(H, vector<string>(W));\n        FOR(y, 0, H) {\n            FOR(x, 0, W) {\n                if (field[y][x] == -1) {\n                    continue;\n                }\n\n                // 0 startはだめ\n                if (dp[y][x].empty() and field[y][x] == 0) {\n                    continue;\n                }\n\n                // start\n                if (dp[y][x].empty()) {\n                    dp[y][x] = to_string(field[y][x]);\n                }\n\n                if (y + 1 < field.size() and field[y + 1][x] != -1) {\n                    string new_c = dp[y][x] + to_string(field[y + 1][x]);\n                    dp[y + 1][x] = big(dp[y + 1][x], new_c);\n                }\n                if (x + 1 < field[0].size() and field[y][x + 1] != -1) {\n                    string new_c = dp[y][x] + to_string(field[y][x + 1]);\n                    dp[y][x + 1] = big(dp[y][x + 1], new_c);\n                }\n            }\n        }\n\n        string ans = \"\";\n        FOR(y, 0, dp.size()) {\n            FOR(x, 0, dp[0].size()) {\n                ans = big(ans, dp[y][x]0;\n            }\n        }\n\n        print(ans);\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n\n\nusing namespace std;\n\nint const N = 100;\nchar table[N][N] = {};\nbool vd[N][N] = {};\n\nvoid clear() {\n    for( int i=0; i<N; ++i ) {\n        for( int j=0; j<N; ++j ) {\n            table[i][j] = 0;\n            vd[i][j] = false;\n        }\n    }\n}\n\nint const dir[][2] = {{1,0}, {0, 1}};\nvoid find( string& ss, string& s, int const x, int const y, int const w, int const h )\n{\n    s += table[x][y];\n    vd[x][y] = true;\n\n    for( int i=0; i<2; ++i ) {\n        int const nx = x + dir[i][0];\n        int const ny = y + dir[i][1];\n        if ( nx < 0 || ny < 0 || nx >= w || ny >= h )\n            continue;\n        \n        if ( table[nx][ny] >= '0' && table[nx][ny] <= '9' ) {\n//            string copied = s;\n            find( ss, s, nx, ny, w, h );\n        }\n    }\n\n    if ( s.size() > ss.size() || ( s.size() == ss.size() && s > ss ) ) {\n        ss = s;\n    }\n    s.erase( s.end() - 1 );\n}\n\nint main()\n{\n    for(;;) {\n        int w, h;\n        cin >> w >> h;\n        if ( w == 0 && h == 0 )\n            break;\n\n        clear();\n        cin.ignore(255, '\\n');\n        for( int y=0; y<h; ++y ) {\n            string s;\n            getline( cin, s );\n            for( int x=0; x<w; ++x ) {\n                table[x][y] = s[x];\n            }\n        }\n\n        string ss;\n        string s;\n        for( int x=0; x<w; ++x ) {\n            for( int y=0; y<h; ++y ) {\n                if ( table[x][y] >= '1' && table[x][y] <= '9' && !vd[x][y] ) {\n                    find( ss, s, x, y, w, h );\n                }\n            }\n        }\n        \n        cout << ss << endl;\n    };\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n#define P pair<int,int>\n\n\nchar s[100][100];\n\nbool num(int i,int j){\n  return ('0'<=s[i][j]&&s[i][j]<='9');\n}\n\n\n\nbool g(string a,string b){\n  if(a.size()!=b.size()) return (a.size()<b.size());\n  int i=0;\n  while(a.size()!=i){\n    if(a[i]!=b[i]) return (a[i]<b[i]);\n    i++;\n  }\n  return true;\n}\n\n\n\nvoid f(int w,int h){\n  for(int i=0;i<h;i++){\n    for(int j=0;j<w;j++){\n      s[i][j]=0; \n    }\n  }\n  vector<vector<string>> dp(h,vector<string>(w));\n\n  for(int i=0;i<h;i++){\n    cin>>s[i];\n  }\n\n  string ans=\"\";\n\n  for(int i=0;i<h;i++){\n    for(int j=0;j<w;j++){\n      if(!num(i,j))continue;\n      if(i==0&&j==0&&s[i][j]!='0') dp[i][j]=s[i][j];\n      else if(i==0&&j>0&&!(dp[i][j-1]==\"\"&&s[i][j]=='0')) dp[i][j]=dp[i][j-1]+s[i][j];\n      else if(j==0&&i>0&&!(dp[i-1][j]==\"\"&&s[i][j]=='0')) dp[i][j]=dp[i-1][j]+s[i][j];\n      else if(i>0&&j>0){\n        if(g(dp[i-1][j],dp[i][j-1])&&!(dp[i][j-1]==\"\"&&s[i][j]=='0'))\n          dp[i][j]=dp[i][j-1]+s[i][j];\n        else if(!(dp[i-1][j]==\"\"&&s[i][j]=='0'))\n          dp[i][j]=dp[i-1][j]+s[i][j];\n      }\n      if(g(ans,dp[i][j]))\n        ans=dp[i][j];\n    }\n  }\n\n\n  cout<<ans<<endl;\n}\n\n\n\nint main(){\n  int w,h;\n  while(true){\n    cin>>w>>h;\n    if(w==0) break;\n    f(w,h);\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <map>\n#include <algorithm>\n\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n\nusing namespace std;\n\nint main() {\n  while(1) {\n    int w,h;\n    cin>>w>>h;\n    if(!w)break;\n    vector<string> t(h);\n    REP(i,h)cin>>t[i];\n    vector<vector<string>> dp(h,vector<string>(w));\n    string mx = \"0\";\n    REP(i,h)REP(j,w) {\n      if (t[i][j] > '9') continue;\n      if (i>0 && j>0) {\n        if (dp[i-1][j].size() > dp[i][j-1].size() || (dp[i-1][j].size() == dp[i][j-1].size() && dp[i-1][j] > dp[i][j-1])) {\n          dp[i][j] = dp[i-1][j] + t[i][j];\n        } else {\n          dp[i][j] = dp[i][j-1] + t[i][j];\n        }\n      } else if (i>0) {\n        dp[i][j] = dp[i-1][j] + t[i][j];\n      } else if (j>0) {\n        dp[i][j] = dp[i][j-1] + t[i][j];\n      } else {\n        dp[i][j] = t[i][j];\n      }\n      if (dp[i][j].size() > 1 && dp[i][j][0] == '0') dp[i][j] = dp[i][j].substr(1);\n      if (dp[i][j].size() > mx.size() || (dp[i][j].size() == mx.size() && dp[i][j] > mx)) {\n        mx = dp[i][j];\n      }\n    }\n    cout<<mx<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 100000000\n\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair <int,int> P;\n\n\nstatic const double EPS = 1e-8;\n\nint tx[] = {-1,0,1,0};\nint ty[] = {0,1,0,-1};\n\nchar stage[101][101];\nint W,H;\n\nstring larger(const string& str1,const string& str2){\n\tif(str1.size() > str2.size()) return str1;\n\tif(str1.size() < str2.size()) return str2;\n\n\tfor(int i=0;i<str1.size();i++){\n\t\tif(str1[i] > str2[i] ) return str1;\n\t\tif(str1[i] < str2[i] ) return str2;\n\t}\n\n\treturn str1;\n}\n\nvoid dfs(int x,int y,string buf,string& res){\n\tbuf.push_back(stage[y][x]);\n\n\tif(y+1 < H && isdigit(stage[y+1][x])){\n\t\tdfs(x,y+1,buf,res);\t\t\n\t}\n\n\tif(x+1 < W && isdigit(stage[y][x+1])){\n\t\tdfs(x+1,y,buf,res);\n\t}\n\n\tres = larger(res,buf);\n}\n\nint main()\n{\n\twhile(~scanf(\"%d %d\",&W,&H)){\n\t\tif(W==H && H==0) break;\n\t\tfor(int y=0;y<H;y++){\n\t\t\tchar buf[128];\n\t\t\tscanf(\"%s\",buf);\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tstage[y][x] = buf[x];\n\t\t\t}\n\t\t}\n\n\t\tstring res=\"0\";\n\t\tfor(int y=0;y<H;y++){\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tif(!isdigit(stage[y][x])) continue;\n\t\t\t\tif(stage[y][x] == '0') continue;\n\t\t\t\tdfs(x,y,\"\",res);\t\t\t\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\nusing namespace std;\nint W,H;\nchar c[71][71];\nstring s[71][71],t = \".\";\n\nstruct item{\n\tstring s;\n\tint x;\n\tint y;\n};\n\nbool operation(string l,string r){\n\tif(l.size() != r.size()){\n\t\treturn l.size() < r.size();\n\t}\n\telse{\n\t\treturn l < r;\n\t}\n}\n\nvector<item> v;\n\nstring solve(int i,int j){\n\tlong long a,b;\n\tstring s1,s2;\n\ts1 = s2 = c[i][j];\n\titem it;\n\tif(s[i][j] != t)return s[i][j];\n\tif(c[i][j+1] >= '0' && c[i][j+1] <= '9' && j+1 < W){\n\t\tif(s[i][j+1] != t) s1 += s[i][j+1];\n\t\telse s1 += solve(i,j+1);\n\t}\n\tif(c[i+1][j] >= '0' && c[i+1][j] <= '9' && i+1 < H){\n\t\tif(s[i+1][j] != t) s2 += s[i+1][j];\n\t\telse s2 += solve(i+1,j);\n\t}\n\n\tit.s = s[i][j] = max(s1,s2,operation);\n\n\tit.x = j;\n\tit.y = i;\n\tv.push_back(it);\n\treturn s[i][j];\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> W >> H;\n\t\tint x,y;\n\t\tstring st,res;\n\t\tif(W == 0)break;\n\t\tv.clear();\n\t\tres = \"\";\n\t\tfor(int i = 0;i < 71;i++){\n\t\t\tfor(int j = 0;j <= 71;j++){\n\t\t\t\tc[i][j] = '.';\n\t\t\t\ts[i][j] = '.';\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tif(c[i][j] >= '1' && c[i][j] <= '9'){\n\t\t\t\t\tst = solve(i,j);\n\t\t\t\t\ts[i][j] = st;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//sort(v.begin(),v.end(),operation);\n\t\tfor(int i = 0;i < v.size();i++){\n\t\t\tres = max(res,v[i].s,operation);\n\t\t}\t\t\n\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cctype>\n\nusing namespace std;\n\ninline string& max_one(string &a, string &b) {\n    if(a.size() > b.size()) return a;\n    if(b.size() > a.size()) return b;\n    return a > b ? a : b;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(0);\n    while(true) {\n        int W, H;\n        cin >> W >> H;\n        if(!W && !H) break;\n\n        vector<string> matrix(H);\n        for(int i = 0; i < H; ++i) {\n            cin >> matrix[i];\n        }\n        vector<vector<string> > largest(H, vector<string>(W));\n        string ans = \"\";\n        for(int r = H-1; r >= 0; --r) {\n            for(int c = W-1; c >= 0; --c) {\n                if(isdigit(matrix[r][c])) {\n                    string right(\"\"), down(\"\");\n                    if(c+1 < W) {\n                        right = largest[r][c+1];\n                    }\n                    if(r+1 < H) {\n                        down = largest[r+1][c];\n                    }\n                    largest[r][c] = string(\"\") + matrix[r][c] + max_one(right, down);\n                    if(matrix[r][c] != '0') {\n                        ans = max_one(ans, largest[r][c]);\n                    }\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef tuple<int, int> duo;\nconst int dx[] = {0, 0, 1, -1, 1, 1, -1, -1};\nconst int dy[] = {1, -1, 0, 0, 1, -1, 1, -1};\nconst int Mod = 1000000000 + 0;\n//{{{ templates\n#define TT_ template<typename T>inline\n#define TTF_ template<typename T,typename F>inline\nTT_ T sq(T x){return x*x;}\nTT_ T In(){T x;cin>>x;return x;}\nTT_ void Out(T&x){cout<<x;}\nTT_ void sort(T&v){sort(begin(v),end(v));}\nTT_ void revs(T&v){reverse(begin(v),end(v));}\nTT_ void uniq(T&v){sort(v);v.erase(unique(begin(v),end(v)),end(v));}\nTT_ int ubnd(T&v,typename T::value_type x){return upper_bound(begin(v),end(v),x)-begin(v);}\nTT_ int lbnd(T&v,typename T::value_type x){return lower_bound(begin(v),end(v),x)-begin(v);}\nTTF_ void inpt(T&v,int n,F f){for(v.reserve(n);n--;v.emplace_back(f()));}\nTTF_ void show(T&v,F f,string d=\" \",string e=\"\\n\"){int i=0;for(auto&x:v)i++&&(cout<<d),f(x);cout<<e;}\nTT_ typename T::iterator minel(T&v){return min_element(begin(v),end(v));}\nTT_ typename T::iterator maxel(T&v){return max_element(begin(v),end(v));}\n\ninline void fast_io(){ios_base::sync_with_stdio(0);cin.tie(0);}\ninline int in(){int x;scanf(\"%d\",&x);return x;}\ninline ll pow_mod(ll a,ll k,ll m){ll r=1;for(;k>0;a=a*a%m,k>>=1)if(k&1)r=r*a%m;return r;}\ninline ll mod_inv(ll a,ll p){return pow_mod(a,p-2,p);}\n//}}} priority_queue queue deque front stringstream max_element min_element insert count make_tuple\n\nbool scomp(const string& a, const string& b){\n  if (a.size() != b.size()) return a.size() < b.size();\n  return a < b;\n}\n\nint main()\n{\n  int w, h;\n  while (w = in(), h = in()){\n    string dp[80][80];\n    char field[80][80];\n    for (int i = 0; i < h; i++) scanf(\"%s\", field[i]);\n    for (int i = 0; i < h; i++){\n      for (int j = 0; j < w; j++){\n        if (isdigit(field[i][j]) && field[i][j] != '0'){\n          dp[i][j] += field[i][j];\n        }\n      }\n    }\n    for (int i = 0; i < h; i++){\n      for (int j = 0; j < w; j++){\n        if (!isdigit(field[i][j])) continue;\n        if (i > 0 && isdigit(field[i - 1][j]) && dp[i - 1][j] != \"0\"){\n          dp[i][j] = max(dp[i][j], dp[i - 1][j] + field[i][j], scomp);\n        }\n        if (j > 0 && isdigit(field[i][j - 1]) && dp[i][j - 1] != \"0\"){\n          dp[i][j] = max(dp[i][j], dp[i][j - 1] + field[i][j], scomp);\n        }\n      }\n    }\n    string best = \"\";\n    for (int i = 0; i < h; i++){\n      best = max(best, *max_element(begin(dp[i]), end(dp[i]), scomp), scomp);\n    }\n    cout << best << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\nstatic const int N = 71;\nstring judge(string,string);\nint main(){\n  int w,h,i,j,len[N][N],a,b,lenmax,lencnt,flag;\n  string dp[N][N],instr[N],which,finalresult;\n  while(1){\n    cin >> w >> h;\n    if(w==0&&h==0) break;\n    for(i=0;i<=h;i++){\n      for(j=0;j<=w;j++){\n\tlen[i][j]=0;\n\tdp[i][j]=\"\";\n      }\n    }\n    for(i=0;i<=w;i++){\n      instr[0]+='X';\n    }\n    len[0][0]=0;\n    for(i=1;i<=h;i++){\n      cin >> instr[i];\n      instr[i]='X'+instr[i];\n    }\n    for(i=1;i<=h;i++){\n      for(j=1;j<=w;j++){\n\tif('A'<=instr[i][j]&&instr[i][j]<='Z') instr[i][j]='X';\n\tif('0'<=instr[i][j]&&instr[i][j]<='9'){\n\t  len[i][j]=max(len[i][j-1],len[i-1][j])+1;\n\t}\n      }\n    }\n    //!='X'?????¨?????°???\n    for(i=1;i<=h;i++){\n      for(j=1;j<=w;j++){\n\tif(instr[i][j]!='X'){\n\t  a=b=0;\n\t  if(instr[i-1][j]!='X') a=1;\n\t  if(instr[i][j-1]!='X') b=1;\n\t  if(a==1&&b==1){\n\t    if(len[i-1][j]>len[i][j-1]){\n\t      if(len[i-1][j]==1&&instr[i-1][j]=='0') dp[i][j]+=instr[i][j];\n\t      else dp[i][j]+=dp[i-1][j]+instr[i][j];\n\t    }\n\t    else if(len[i-1][j]<len[i][j-1]){\n\t      if(len[i][j-1]==1&&instr[i][j-1]=='0') dp[i][j]+=instr[i][j];\n\t      else dp[i][j]+=dp[i][j-1]+instr[i][j];\n\t    }\n\t    else{//dp???????????????????????????\n\t      which=judge(dp[i-1][j],dp[i][j-1]);\n\t      if(len[i][j-1]==1&&instr[i][j-1]=='0') dp[i][j]+=instr[i][j];\n\t      else dp[i][j]+=which+instr[i][j];\n\t    }\n\t  }\n\t  else if(a==1){\n\t    if(len[i-1][j]==1&&instr[i-1][j]=='0') dp[i][j]+=instr[i][j];\n\t    else dp[i][j]+=dp[i-1][j]+instr[i][j];\n\t  }\n\t  else if(b==1){\n\t    if(len[i][j-1]==1&&instr[i][j-1]=='0') dp[i][j]+=instr[i][j];\n\t    else dp[i][j]+=dp[i][j-1]+instr[i][j];\n\t  }\n\t  else{\n\t    dp[i][j]=instr[i][j];\n\t  }\n\t}\n      }\n    }\n    for(i=0;i<=h;i++){\n      for(j=0;j<=w;j++){\n\tlen[i][j]=0;\n      }\n    }\n    for(i=1;i<=h;i++){\n      for(j=1;j<=w;j++){\n\tif(dp[i][j]!=\"\") len[i][j]=dp[i][j].size();\n      }\n    }\n    lenmax=0;\n    for(i=1;i<=h;i++){\n      for(j=1;j<=w;j++){\n\tlenmax=max(lenmax,len[i][j]);\n      }\n    }\n    /*    cout << endl;\n    for(i=1;i<=h;i++){\n      for(j=1;j<=w;j++){\n\tcout << '(' << i << ',' << j << \")=\" << ' ' << dp[i][j];\n      }\n      cout << endl;\n    }\n    cout << endl;\n    for(i=1;i<=h;i++){\n      for(j=1;j<=w;j++){\n\tcout << '(' << i << ',' << j << \")=\" << ' ' << len[i][j];\n      }\n      cout << endl;\n      }*/\n    flag=0;\n    for(i=1;i<=h;i++){\n      for(j=1;j<=w;j++){\n       \tif(flag==0&&lenmax==len[i][j]){\n\t  flag=1;\n\t  finalresult=dp[i][j];\n\t}\n\tif(flag==1&&lenmax==len[i][j]){\n\t  which=judge(dp[i][j],finalresult);\n\t  finalresult=which;\n\t}\n      }\n    }\n\n    cout << finalresult<< endl;\n  }\n  return 0;\n}\nstring judge(string a,string b){\n  int i,len,flag=0;\n  len=a.size();\n  for(i=0;i<len;i++){\n    if(a[i]>b[i]){\n      flag=1;\n      break;\n    }\n    else if(a[i]<b[i]){\n      flag=2;\n      break;\n    }\n  }\n  if(flag==0||flag==1) return a;\n  else return b;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <complex>\n#include <deque>\n#include <exception>\n#include <fstream>\n#include <functional>\n#include <iomanip>\n#include <ios>\n#include <iosfwd>\n#include <iostream>\n#include <istream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <locale>\n#include <map>\n#include <memory>\n#include <new>\n#include <numeric>\n#include <ostream>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <stdexcept>\n#include <streambuf>\n#include <string>\n#include <typeinfo>\n#include <utility>\n#include <valarray>\n#include <vector>\n#include <climits>\n\n#define rep(i, m, n) for(int i=int(m);i<int(n);i++)\n//#define EACH(i, c) for (auto &(i): c)\n#define all(c) begin(c),end(c)\n//#define EXIST(s, e) ((s).find(e)!=(s).end())\n//#define SORT(c) sort(begin(c),end(c))\n//#define pb emplace_back\n//#define MP make_pair\n//#define SZ(a) int((a).size())\n\n//#define LOCAL 0\n//#ifdef LOCAL\n//#define DEBUG(s) cout << (s) << endl\n//#define dump(x)  cerr << #x << \" = \" << (x) << endl\n//#define BR cout << endl;\n//#else\n//#define DEBUG(s) do{}while(0)\n//#define dump(x) do{}while(0)\n//#define BR\n//#endif\n\n\n//改造\ntypedef long long int ll;\nusing namespace std;\n#define INF (1 << 30) - 1\n#define INFl (ll)5e15\n#define DEBUG 0 //デバッグする時1にしてね\n#define dump(x)  cerr << #x << \" = \" << (x) << endl\n#define MOD 1000000007\n//ここから編集する\nint W, H;\nvector<string> vv;\nstring dp[75][75][75][75];\n\nbool integer(char c) {\n    return c >= '0' && c <= '9';\n}\n\nstring parse(string str) {\n    int start = 0;\n    for (start = 0; str[start] == '0' && start < str.size(); start++) {\n\n    }\n    return str.substr(start);\n}\n\nfunction<bool(string, string)> lt = [](string left, string right) {\n    left = parse(left);\n    right = parse(right);\n    if (left.size() < right.size()) {\n        return true;\n    } else if (left.size() > right.size()) {\n        return false;\n    } else {\n        rep(i, 0, left.size()) {\n            if (left[i] != right[i]) {\n                return left[i] < right[i];\n            }\n        }\n    }\n    return false;\n};\n\nstring dfs(int sh, int sw, int th, int tw) {\n    if (dp[sh][sw][th][tw] != \".\") {\n        return dp[sh][sw][th][tw];\n    }\n    if (!integer(vv[sh][sw]) || !integer(vv[th][tw])) {\n        return dp[sh][sw][th][tw] = \"\";\n    }\n    string ret = \"\";\n    if (sh == th && sw == tw) {\n        ret += vv[sh][sw];\n        return dp[sh][sw][th][tw] = ret;\n    }\n    if (th - sh + tw - sw == 1) {\n        ret += vv[sh][sw];\n        ret += vv[th][tw];\n        return dp[sh][sw][th][tw] = ret;\n    }\n\n\n    rep(mh, sh, th + 1) {\n        rep(mw, sw, tw + 1) {\n            if(sh == mh && sw == mw){\n                continue;\n            }\n            if(mh == th && mw == tw){\n                continue;\n            }\n            string left = dfs(sh, sw, mh, mw);\n            string right = dfs(mh, mw, th, tw);\n            if (left.size() > 0 && right.size() > 0) {\n                string tmp = \"\";\n                tmp += left.substr(0, left.size() - 1);\n                tmp += right;\n                tmp = parse(tmp);\n                if (lt(ret, tmp)) {\n                    ret = tmp;\n                }\n            }\n\n        }\n    }\n    return dp[sh][sw][th][tw] = ret;\n\n\n}\n\nbool solve() {\n    cin >> W >> H;\n    if (W == 0 && H == 0) {\n        return false;\n    }\n    vv.resize(W);\n    rep(i, 0, 75) {\n        rep(j, 0, 75) {\n            rep(k, 0, 75) {\n                rep(l, 0, 75) {\n                    dp[i][j][k][l] = \".\";\n                }\n            }\n        }\n    }\n\n    rep(i, 0, H) {\n        cin >> vv[i];\n    }\n\n    string ans = \"\";\n    rep(sh, 0, H) {\n        rep(th, sh, H) {\n            rep(sw, 0, W) {\n                rep(tw, sw, W) {\n                    string tmp = dfs(sh, sw, th, tw);\n                    if (lt(ans, tmp)) {\n                        ans = tmp;\n                    }\n                }\n            }\n        }\n    }\n    cout << ans << endl;\n\n    return true;\n\n\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while (solve()) {\n\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint W,H;\n\nbool flag[70][70][70];\nstring mat[70];\nint cnt;\nstring ans;\n\nvoid dfs(int y, int x,int c,string s) {\n    if(flag[y][x][c]) return;\n    // cout<<y<<\",\"<<x<<\",\"<<c<<\",\"<<s<<endl;\n    if(cnt<c) {\n        cnt=c;\n        ans=s;\n    }\n\n    rep(i,2) {\n        int ny=y+dy[i];\n        int nx=x+dx[i];\n        if(!(0<=ny&&ny<H)) continue;\n        if(!(0<=nx&&nx<W)) continue;\n        if(!('0'<=mat[ny][nx]&&mat[ny][nx]<='9')) continue;\n        dfs(ny,nx,c+1,s+mat[ny][nx]);\n\n    }\n\n    flag[y][x][c]=true;\n    return;\n}\n\nvoid solve() {\n    cnt=0;\n    ans=\"\";\n    rep(i,70) rep(j,70) rep(a,70) flag[i][j][a]=false;\n    rep(i,70) mat[i]=\"\";\n    rep(i,H) cin>>mat[i];\n    rep(i,H) rep(j,W) if('1'<=mat[i][j]&&mat[i][j]<='9') {\n        string s=\"a\";\n        s[0]=mat[i][j];\n        dfs(i,j,0,s);\n    }\n\n    cout<<ans<<endl;\n}\n\nint main() {\n    while(cin>>W>>H) {\n        if(W+H==0) break;\n        solve();\n\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\ntypedef tuple<int, int> duo;\nconst int dx[] = {0, 0, 1, -1, 1, 1, -1, -1};\nconst int dy[] = {1, -1, 0, 0, 1, -1, 1, -1};\nconst int Mod = 1000000000 + 0;\n//{{{ templates\n#define TT_ template<typename T>inline\n#define TTF_ template<typename T,typename F>inline\nTT_ T sq(T x){return x*x;}\nTT_ T In(){T x;cin>>x;return x;}\nTT_ void Out(T&x){cout<<x;}\nTT_ void sort(T&v){sort(begin(v),end(v));}\nTT_ void revs(T&v){reverse(begin(v),end(v));}\nTT_ void uniq(T&v){sort(v);v.erase(unique(begin(v),end(v)),end(v));}\nTT_ int ubnd(T&v,typename T::value_type x){return upper_bound(begin(v),end(v),x)-begin(v);}\nTT_ int lbnd(T&v,typename T::value_type x){return lower_bound(begin(v),end(v),x)-begin(v);}\nTTF_ void inpt(T&v,int n,F f){for(v.reserve(n);n--;v.emplace_back(f()));}\nTTF_ void show(T&v,F f,string d=\" \",string e=\"\\n\"){int i=0;for(auto&x:v)i++&&(cout<<d),f(x);cout<<e;}\nTT_ typename T::iterator minel(T&v){return min_element(begin(v),end(v));}\nTT_ typename T::iterator maxel(T&v){return max_element(begin(v),end(v));}\n\ninline void fast_io(){ios_base::sync_with_stdio(0);cin.tie(0);}\ninline int in(){int x;scanf(\"%d\",&x);return x;}\ninline ll pow_mod(ll a,ll k,ll m){ll r=1;for(;k>0;a=a*a%m,k>>=1)if(k&1)r=r*a%m;return r;}\ninline ll mod_inv(ll a,ll p){return pow_mod(a,p-2,p);}\n//}}} priority_queue queue deque front stringstream max_element min_element insert count make_tuple\n\nbool scomp(const string& a, const string& b){\n  if (a.size() != b.size()) return a.size() < b.size();\n  return a < b;\n}\n\nint main()\n{\n  int w, h;\n  while (w = in(), h = in()){\n    string dp[80][80];\n    char field[80][80];\n    for (int i = 0; i < h; i++) scanf(\"%s\", field[i]);\n    for (int i = 0; i < h; i++){\n      for (int j = 0; j < w; j++){\n        if (isdigit(field[i][j]) && field[i][j] != '0'){\n          dp[i][j] += field[i][j];\n        }\n      }\n    }\n    for (int i = 0; i < h; i++){\n      for (int j = 0; j < w; j++){\n        if (!isdigit(field[i][j])) continue;\n        if (i > 0 && isdigit(field[i - 1][j])){\n          dp[i][j] = max(dp[i][j], dp[i - 1][j] + field[i][j], scomp);\n        }\n        if (j > 0 && isdigit(field[i][j - 1])){\n          dp[i][j] = max(dp[i][j], dp[i][j - 1] + field[i][j], scomp);\n        }\n      }\n    }\n    string best = \"\";\n    for (int i = 0; i < h; i++){\n      best = max(best, *max_element(begin(dp[i]), end(dp[i]), scomp), scomp);\n    }\n    cout << best << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nstring x[100][100];\nbool p[100][100];\nint h,w;\nchar T[11]=\"0123456789\";\nchar c;\nstring dp[100][100];\n\nbool isnum(string p){\n\tfor(int i=0;i<10;i++){\n\t\tif(T[i]==p[0]){\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nstring _max(string a,string b){\n\tif(a.size()<b.size()){return b;}\n\tif(a.size()>b.size()){return a;}\n\tif(a>b){return a;}\n\treturn b;\n}\n\nint main(){\n\twhile(true){\n\t\tfor(int i=0;i<100;i++){\n\t\t\tfor(int j=0;j<100;j++){\n\t\t\t\tdp[i][j]=\"\";\n\t\t\t\tx[i][j]=\"a\";\n\t\t\t}\n\t\t}\n\t\tcin>>w>>h;\n\t\tif(h==0 && w==0){break;}\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tcin>>c;\n\t\t\t\tstring G=\"\";\n\t\t\t\tG+=c;\n\t\t\t\tx[i][j]=G;\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tif(isnum(x[i][j])==true){\n\t\t\t\t\tif(x[i][j]!=\"0\"){\n\t\t\t\t\t\tdp[i][j]=\"\"+x[i][j];\n\t\t\t\t\t}\n\t\t\t\t\tp[i][j]=true;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tp[i][j]=false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<70;i++){\n\t\t\tfor(int j=0;j<h;j++){\n\t\t\t\tfor(int k=0;k<w;k++){\n\t\t\t\t\tif(dp[j][k]!=\"\"){\n\t\t\t\t\t\tif(p[j+1][k]==true){\n\t\t\t\t\t\t\tdp[j+1][k]=_max(dp[j+1][k],dp[j][k]+x[j+1][k]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(p[j][k+1]==true){\n\t\t\t\t\t\t\tdp[j][k+1]=_max(dp[j][k+1],dp[j][k]+x[j][k+1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring maxn=\"\";\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tmaxn=max(maxn,dp[i][j]);\n\t\t\t\tcout<<dp[i][j]<<',';\n\t\t\t}\n\t\t\tcout<<endl;\n\t\t}\n\t\tcout<<maxn<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,n) for (int (i)=(0);(i)<(int)(n);++(i))\nusing ll = long long;\nusing P = pair<int, int>;\nusing namespace std;\n\ntemplate<class T> void vin(vector<T>& v, int n) {\n    v.resize(n);\n    for (int i = 0; i < n; ++i) {\n        cin >> v[i];\n    }\n}\n\nint W, H;\nstring b[101];\nint dr[] = { 0, 1 };\nint dc[] = { 1, 0 };\nstring ans = \"\";\n\nvoid solve(int r, int c, string t) {\n    t += b[r][c];\n    if (ans.size() < t.size()) {\n        ans = t;\n    }\n    else if (ans.size() == t.size()) {\n        rep(i, ans.size()) {\n            if (ans[i] > t[i]) break;\n            else if (ans[i] < t[i]) {\n                ans = t;\n                break;\n            }\n        }\n    }\n    rep(d, 2) {\n        int nr = r + dr[d], nc = c + dc[d];\n        if (nr < 0 or nr >= H or nc < 0 or nc >= W) continue;\n        if (!('0' <= b[nr][nc] and b[nr][nc] <= '9')) continue;\n        solve(nr, nc, t);\n    }\n}\n\nint main() {\n    while (cin >> W >> H and W and H) {\n        rep(r, H) cin >> b[r];\n        ans = \"\";\n        rep(r, H) rep(c, W) if ('1' <= b[r][c] and b[r][c] <= '9') solve(r, c, \"\");\n        cout << ans << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double ld;\ntypedef pair<ll, ll> P;\n\n#define EACH(i,a) for (auto& i : a)\n#define FOR(i,a,b) for (ll i=(a);i<(b);i++)\n#define RFOR(i,a,b) for (ll i=(b)-1;i>=(a);i--)\n#define REP(i,n) for (ll i=0;i<(n);i++)\n#define RREP(i,n) for (ll i=(n)-1;i>=0;i--)\n#define debug(x) cout<<#x<<\": \"<<x<<endl\n#define pb push_back\n#define ALL(a) (a).begin(),(a).end()\n\nconst ll linf = 1e18;\nconst int inf = 1e9;\nconst double eps = 1e-12;\nconst double pi = acos(-1);\n\ntemplate<typename T>\nistream& operator>>(istream& is, vector<T>& vec) {\n\tEACH(x,vec) is >> x;\n\treturn is;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, vector<T>& vec) {\n\tREP(i,vec.size()) {\n\t\tif (i) os << \" \";\n\t\tos << vec[i];\n\t}\n\treturn os;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, vector< vector<T> >& vec) {\n\tREP(i,vec.size()) {\n\t\tif (i) os << endl;\n\t\tos << vec[i];\n\t}\n\treturn os;\n}\n\nint dx[2] = {1, 0};\nint dy[2] = {0, 1};\n\nint W, H;\nvector<string> m;\nbool m1[100][100] = {0};\nstring m2[100][100];\nstring beautify(string s) {\n\tif (s.size() == 0) return \"\";\n\tint l = (int)s.size()-1;\n\tREP(i,s.size()) {\n\t\tif (s[i] != '0') {\n\t\t\tl = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn s.substr(l, s.size()-l);\n}\nbool gt(string s1, string s2) {\n\tbool r = s1.size() > s2.size();\n\ts1 = beautify(s1);\n\ts2 = beautify(s2);\n\tif (s1.size() == s2.size()) {\n\t\tif (s1 == s2) {\n\t\t\treturn r;\n\t\t}\n\t\treturn s1 > s2;\n\t}\n\treturn s1.size() > s2.size();\n}\nstring dp(int x, int y) {\n\tstring res = \"\";\n\tif (x < 0 || x >= W || y < 0 || y >= H) return \"\";\n\tif ( !isdigit(m[y][x]) ) return \"\";\n\tif (m1[y][x]) return m2[y][x];\n\tREP(i, 2) {\n\t\tint nx = x + dx[i];\n\t\tint ny = y + dy[i];\n\t\tstring a = \"\"; a += m[y][x];\n\t\ta += dp(nx, ny);\n\t\tif ( gt(a, res) ) res = a;\n\t}\n\treturn m1[y][x] = true, m2[y][x] = res;\n}\n\n\nint main() {\n\tstd::ios::sync_with_stdio(false);\n\tstd::cin.tie(0);\n\twhile (cin >> W >> H, W || H) {\n\t\tm.resize(H); cin >> m;\n\t\tfill(m1[0], m1[100], false);\n\t\tstring ans = \"0\";\n\t\tREP(y, H) REP(x, W) {\n\t\t\tif ( gt( dp(x, y), ans ) ) ans = beautify( dp(x, y) );\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nconst int WH = 72;\n\nchar board[WH];\nstring dp[WH];\n\nbool comp(const string& a, const string& b){\n\tif(a.length() == b.length()){\n\t\treturn a < b;\n\t}\n\treturn a.length() < b.length();\n}\n\nint main(){\n\tint w, h, m;\n\tstring r;\n\twhile(cin >> w >> h, w){\n\t\tr = \"\";\n\t\tfor(int i = 0;i < w * h;++i){\n\t\t\tcin >> board[i];\n\t\t}\n\t\tfor(int i = 0;i < h;++i){\n\t\t\tfor(int j = 0;j < w;++j){\n\t\t\t\tdp[i * w + j] = \"\";\n\t\t\t\tif(i - 1 >= 0 && dp[(i - 1) * w + j] != \"\"){\n\t\t\t\t\tdp[i * w + j] = dp[(i - 1) * w + j];\n\t\t\t\t}\n\t\t\t\tif(j - 1 >= 0 && dp[i * w + (j - 1)] != \"\"){\n\t\t\t\t\tdp[i * w + j] = max(dp[i * w + j], dp[i * w + (j - 1)], comp);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif('0' <= board[i * w + j] && board[i * w + j] <= '9'){\n\t\t\t\t\tif(dp[i * w + j] != \"\" || board[i * w + j] != '0'){\n\t\t\t\t\t\tdp[i * w + j] += board[i * w + j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse dp[i * w + j] = \"\";\n\n\t\t\t\tr = max(r, dp[i * w + j], comp);\n\t\t\t}\n\t\t}\n\t\tcout << r << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <cctype>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <set>\n#include <queue>\n#include <stack>\n#include <map>\n#include <cassert>\nusing namespace std;\n\n#define REP(i, s, e) for (int i = (s); i < (e); i++)\n#define REPI(i, s, e) for (int i = (s); i <= (e); i++)\n#define rep(i, n) REP(i, 0, n)\n#define repi(i, n) REPI(i, 0, n)\n#define ALL(v) (v).begin(), (v).end()\n\n#define dump(x) (cout << #x << \" = \" << x << endl)\n#define dump2(x, y) (cout << \"(\" << #x << \", \" << #y << \") = (\" << x << \", \" << y << \")\" << endl)\n#define dump3(x, y, z) (cout << \"(\" << #x << \", \" << #y << \", \" << #z << \") = (\" << x << \", \" << y << \", \"<< z << \")\" << endl)\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\n\nint w, h;\n\n#define MAX 70\nchar brd[MAX][MAX];\n\nstring memo[MAX][MAX];\n\nint dx[] = { 1, 0 };\nint dy[] = { 0, 1 };\n\nclass num {\npublic:\n\tstring n;\n\n\tnum(string n):n(f(n)) {}\n\n\tstring f(string s)\n\t{\n\t\tif (s[0] == '0' && s.size() > 1) return s.substr(1);\n\t\treturn s;\n\t}\n\n\tbool operator<(const num &r) const {\n\t\tif (n.size() == r.n.size())\n\t\t\treturn n < r.n;\n\t\treturn n.size() < r.n.size();\n\t}\n};\n\nstring dfs(int y, int x)\n{\n\tif (memo[y][x] != \"\")\n\t\treturn memo[y][x];\n\n\tstring ans = \"@\";\n\trep(d, 2) {\n\t\tint ty = y+dy[d], tx = x+dx[d];\n\t\tif (!(0 <= ty && ty < h)) continue;\n\t\tif (!(0 <= tx && tx < w)) continue;\n\t\tif (!isdigit(brd[ty][tx])) continue;\n\t\tstring ret = brd[y][x] + dfs(ty, tx);\n\t\tif (ans.size() < ret.size())\n\t\t\tans = ret;\n\t}\n\tif (ans == \"@\" && brd[y][x] == '0') ans = \"\";\n\tif (ans == \"@\") ans = brd[y][x];\n\treturn memo[y][x] = ans;\n}\n\nint main(void)\n{\n\twhile (cin >> w >> h, w|h) {\n\t\trep(j, MAX) rep(i, MAX)\n\t\t\tmemo[j][i] = \"\";\n\n\t\trep(j, h) rep(i, w) cin >> brd[j][i];\n\n\t\tvector<num> vs;\n\t\trep(j, h)\n\t\t\trep(i, w)\n\t\t\t\tif (isdigit(brd[j][i]))\n\t\t\t\t\tvs.push_back(num(dfs(j, i)));\n\n\t\tsort(ALL(vs));\n\t\treverse(ALL(vs));\n\t\tcout << vs[0].n << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n//http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#include<iostream>\n#include<map>\n#include<vector>\n#include<algorithm>\n#include<cmath>\n#include<climits>\n#include<ctime>\n#include<cstring>\n#include<numeric>\n\n#define ALL(v) (v).begin(),(v).end()\n#define REP(i,p,n) for(int i=p;i<(int)(n);++i)\n#define rep(i,n) REP(i,0,n)\n#define dump(a) (cerr << #a << \"=\" << (a) << endl)\n#define DUMP(list) cout << \"{ \"; for(auto nth : list){ cout << nth << \" \"; } cout << \"}\" << endl;\n\nusing namespace std;\n\nint W,H;\nint dw[2] = {0, 1};\nint dh[2] = {1, 0};\nstring ans;\n\nbool cmp(string str1, string str2)\n{\t\n\tif(str1.length() == str2.length())\n\t{\n\t\trep(i,str1.size()){\n\t\t\tif(str1[i] != str2[i]){\n\t\t\t\treturn str1[i] < str2[i];\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\telse if(str1.length() < str2.length()){\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nvector<char> adjust(vector<char> list)\n{\n\tvector<char> res;\n\tbool flag=false;\n\trep(i,list.size()){\n\t\tif(list[i] != '0' || flag){ res.push_back(list[i]); flag=true; }\n\t}\n\n\treturn res;\n}\n\nvoid dfs(int w, int h, vector<char> list, vector< vector<char> > &matrix)\n{\n\tif(w < 0 || w >= W || h < 0 || h >= H){ return; }\n\tif(!isdigit(matrix[h][w])){ return; }\n\n\tlist.push_back(matrix[h][w]);\n\tmatrix[h][w] = '#';\n\n\trep(i,2){\n\t\tdfs(w+dw[i], h+dh[i], list, matrix);\n\t}\n\n\tif(list.size() == 0){ return; }\n\tlist = adjust(list);\n\tstring num(ALL(list));\n\n\tif(cmp(ans,num)){ ans = num; }\n\treturn;\n}\n\nint main()\n{\n\twhile(cin >> W >> H && W)\n\t{\n\n\t\tvector< vector<char> > matrix( H, vector<char>(W) );\n\n\t\trep(h,H){\n\t\t\trep(w,W){\n\t\t\t\tcin >> matrix[h][w];\n\t\t\t}\n\t\t}\n\n\t\tans=\"\";\n\t\tvector<char> list;\n\t\trep(h,H){\n\t\t\trep(w,W){\n\t\t\t\tvector< vector<char> > tmp = matrix;\n\t\t\t\tdfs(w, h, list, tmp);\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<algorithm>\n#include<vector>\n#define F first\n#define S second\nusing namespace std;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() == 0 && b.size() == 0)\n    return true;\n  else if(a.size() == 0)\n    return true;\n  else if(b.size() == 0)\n    return false;\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] < b[i];\n  return false;\n}\n\nint main()\n{\n\n  int w,h;\n  while(cin >> w >> h,(w || h))\n    {\n      \n      char G[h][w];\n      string ans=\"0\";\n      string dp[h][w];\n\n      for(int i=0;i<h;i++)\n\t{\n\tfor(int j=0;j<w;j++)\n\t  {\n\t    cin >> G[i][j];\n\t    if('0' <= G[i][j] && G[i][j] <= '9')\n\t      {\n\t\tdp[i][j] = G[i][j];\n\t\tans = max(ans,dp[i][j],cmp);\n\t      }\n\t\n\t  }\n\n\t}\n     \n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\n\t      if(!('0' <= G[i][j] && G[i][j] <= '9'))\n\t\tcontinue;\n\t      \n\t      dp[i][j] = max(dp[i][j],max((i-1>=0 &&('0'<= G[i-1][j] && G[i-1][j] <= '9') ?dp[i-1][j]:\"\")+dp[i][j],\n\t\t\t\t\t  (j-1>=0 &&('0'<= G[i][j-1] && G[i][j-1] <= '9') ?dp[i][j-1]:\"\")+dp[i][j],cmp),cmp);\t      \n\t      //ans = max(ans,dp[i][j],cmp);\n\n\t    }\n\t}\n\n      ans = \"\";\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\t      if('0' <= G[i][j] && G[i][j] <= '9')\n\t\t{\n\t\t  string a;\n\t\t  if(dp[i][j] != \"0\" && dp[i][j][0] == '0')\n\t\t    {\n\n\t\t      for(int k=0;dp[i][j][k] == '0';k++)\n\t\t\tdp[i][j][k] = ' ';\t\t    \n\t\t      stringstream ss;\n\t\t      ss << dp[i][j];\n\t\t      a = ss.str();\n\t\t    }\n\t\t  else\n\t\t    a = dp[i][j];\n\t\t  ans = max(ans,a);\n\n\t\t}\n\t    }\n\t}\n\n      cout << ans << endl;\n      continue;\n\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \n#define loop(n, i) for(int i=0;i<n;i++)\n#define all(v) v.begin(),v.end()\n\nusing namespace std;\n\nstring strip(string s)\n{\n    int i = 0;\n    while (i < s.length() && s[i] == 0) i++;\n    return i == s.length() ? \"\" : s.substr(i);\n}\n\nint less_than(string a, string b)\n{\n    int d = a.length() - b.length();\n    if (d) return d < 0;\n    return strip(a).compare(strip(b)) < 0;\n}\n\nint main()\n{\n    while (1) {\n        int w, h; cin >> w >> h;\n        if (!w) break;\n        vector<string> rows(h+1);\n        loop (h, i) cin >> rows[i];\n\n        string len[80][80], amt[80][80];\n        fill(len[0], len[79]+80, \"\");\n        fill(amt[0], amt[79]+80, \"\");\n\n        for (int i = h-1; i >= 0; i--) {\n            for (int j = w-1; j >= 0; j--) {\n                if (rows[i][j] >= 'A') continue;\n                if (rows[i][j] == '0') {\n                    auto ls = { len[i+1][j], len[i][j+1] };\n                    len[i][j] = \"0\" + *max_element(all(ls), less_than);\n\n                    auto as = { amt[i+1][j], amt[i][j+1] };\n                    amt[i][j] = *max_element(all(as), less_than);\n                } else {\n                    auto ls = { len[i+1][j], len[i][j+1] };\n                    amt[i][j] = len[i][j] = rows[i][j] + *max_element(all(ls), less_than);\n                }\n            }\n        }\n\n        string ans = \"\";\n        loop (h, i) loop (w, j) {\n            if (less_than(ans, amt[i][j])) ans = amt[i][j];\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <algorithm>\n#include <iomanip>\nusing namespace std;\n\nstring b[70];\nstring memo[70][70];\n\nbool comp(string& s1, string& s2) {\n\tif(s1.size() == s2.size()) return s1 < s2;\n\treturn s1.size() < s2.size();\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tint W, H;\n\twhile(cin >> W >> H, W | H) {\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tcin >> b[i];\n\t\t}\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tfor(int j = 0; j < W; j++) {\n\t\t\t\tmemo[i][j] = \"\";\n\t\t\t\tif('1' <= b[i][j] && b[i][j] <= '9') memo[i][j] += b[i][j];\n\t\t\t}\n\t\t}\n\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tfor(int j = 0; j < W; j++) {\n\t\t\t\tif('0' <= b[i][j] && b[i][j] <= '9') {\n\t\t\t\t\tif(i + 1 < H) {\n\t\t\t\t\t\tif('0' <= b[i + 1][j] && b[i + 1][j] <= '9') {\n\t\t\t\t\t\t\tif(comp(memo[i + 1][j], memo[i][j] + b[i + 1][j]))\n\t\t\t\t\t\t\t\tmemo[i + 1][j] = memo[i][j] + b[i + 1][j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(j + 1 < W) {\n\t\t\t\t\t\tif('0' <= b[i][j + 1] && b[i][j + 1] <= '9') {\n\t\t\t\t\t\t\tif(comp(memo[i][j + 1], memo[i][j] + b[i][j + 1]))\n\t\t\t\t\t\t\t\tmemo[i][j + 1] = memo[i][j] + b[i][j + 1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ans = \"0\";\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tfor(int j = 0; j < W; j++) {\n\t\t\t\tif(comp(ans, memo[i][j])) ans = memo[i][j];\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <vector>\n#include <map>\n#include <set>\n#include <string>\n#include <cstring>\n#include <sstream>\n#include <algorithm>\n#include <functional>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <iomanip>\n#include <list>\n#include <tuple>\n#include <bitset>\n\nusing namespace std;\n\ninline bool cheak(int x, int y, int xMax, int yMax){ return x >= 0 && y >= 0 && xMax > x && yMax > y; }\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout << x; return sout.str(); }\ntemplate<class T> inline T sqr(T x) { return x*x; }\n\ntypedef pair<int, int> P;\ntypedef tuple<int, int, int> T;\ntypedef long long ll;\ntypedef unsigned long long ull;\n\n#define For(i,a,b)\tfor(int (i) = (a);i < (b);(i)++)\n#define rep(i,n)\tFor(i,0,n)\n#define clr(a)\t\tmemset((a), 0 ,sizeof(a))\n#define mclr(a)\t\tmemset((a), -1 ,sizeof(a))\n#define all(a)\t\t(a).begin(),(a).end()\n#define sz(a)\t\t(sizeof(a))\n#define Fill(a,v)\tfill((int*)a,(int*)(a+(sz(a)/sz(*(a)))),v)\n\nconst int dx[8] = { -1, 0, -1, 0, 1, 1, -1, -1 }, dy[8] = { 0, -1, 0, 1, -1, 1, -1, 1 };\nconst int mod = 1000000007;\nconst int INF = 1e9;\n\nstring c[71];\nint w, h;\n\nstring d[71][71];\n\nint str_compare(string s1, string s2){\n\n\tif (s1.size() > s2.size())return 1;\n\tif (s1.size() < s2.size())return 0;\n\n\twhile (s1.size() != 1 && s1[0] == '0'){\n\t\ts1 = s1.substr(1, s1.size() - 1);\n\t}\n\twhile (s2.size() != 1 && s2[0] == '0'){\n\t\ts2 = s2.substr(1, s2.size() - 1);\n\t}\n\n\tif (s1.size() > s2.size())return 1;\n\tif (s1.size() < s2.size())return 0;\n\n\tif (s1.size() == s2.size()){\n\t\tif (s1 > s2)return 1;\n\t\tif (s1 < s2)return 0;\n\t\tif (s1 == s2)return -1;\n\t}\n}\n\nvoid func(int y,int x){\n\n\t\n\trep(i, 2){\n\t\tint ty = y + dy[i], tx = x + dx[i];\n\t\tif (cheak(tx, ty, w, h) && (c[ty][tx] >= '0' && c[ty][tx] <= '9')){\n\n\t\t\tstring t = (c[ty][tx]) + d[y][x];\n\t\t\tif (str_compare(d[ty][tx],t ) == 0){\n\t\t\t\td[ty][tx] = t;\n\t\t\t\tfunc(ty, tx);\n\t\t\t}\n\n\t\t}\n\t}\n}\n\nint main()\n{\n\twhile (cin >> w >> h && (w || h)){\n\t\trep(y, h){\n\t\t\tcin >> c[y];\n\t\t\trep(x,w)\n\t\t\tif (c[y][x] >= '0' && c[y][x] <= '9')d[y][x] = c[y][x];\n\t\t}\n\t\tfor (int y = h - 1; y >= 0; y--)\n\t\tfor (int x = w - 1; x >= 0; x--)if (c[y][x] >= '0' && c[y][x] <= '9'){\n\t\t\tfunc(y, x);\n\t\t}\n\n\t\tstring ans = \"0\";\n\n\t\trep(y, h)rep(x, w)if (c[y][x] >= '0' && c[y][x] <= '9') {\n\n\t\t\twhile (d[y][x].size() != 1 && d[y][x][0] == '0'){\n\t\t\t\td[y][x] = d[y][x].substr(1, d[y][x].size() - 1);\n\t\t\t}\n\n\t\t\tif (str_compare(ans, d[y][x]) == 0){\n\t\t\t\tans = d[y][x];\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define ALL(x) (x).begin(), (x).end()\n\nusing namespace std;\n\ntemplate <typename T> T &chmin(T a, const T &b) {return a = min(a, b);}\ntemplate <typename T> T &chmax(T a, const T &b) {return a = max(a, b);}\n\nusing ll = long long;\nusing ld = long double;\n\nint W, H;\nstring mass[75][75];\nstring res[70][70];\n\nbool f(const string &a, const string &b){\n\tif(a.size() != b.size()) return a.size() > b.size();\n\tREP(i, a.size()) if(a[i] != b[i]) return a[i] > b[i];\n\treturn false;\n}\n\nstring dfs(int h, int w){\n\tif(res[h][w] != \"\") return res[h][w];\n\tif(mass[h][w] == \"*\") return res[h][w] = \"\";\n\tif(mass[h+1][w] == \"*\" and mass[h][w+1] == \"*\") return res[h][w] = mass[h][w];\n\tif(mass[h+1][w] == \"*\") return res[h][w] = mass[h][w].append(dfs(h, w+1));\n\tif(mass[h][w+1] == \"*\") return res[h][w] = mass[h][w].append(dfs(h+1, w));\n\tstring str1 = dfs(h+1, w); string str2 = dfs(h, w+1);\n\tif(f(str1, str2)) return res[h][w] = mass[h][w].append(str1);\n\treturn res[h][w] = mass[h][w].append(str2);\n}\n\nint main(){\n\twhile(cin >> W >> H and W + H){\n\t\tREP(i, 75) REP(j, 75) mass[i][j] = \"*\";\n\t\tREP(i, 70) REP(j, 70) res[i][j] = \"\";\n\t\tREP(i, H){\n\t\t\tstring tmp; cin >> tmp;\n\t\t\tREP(j, W) mass[i][j] = ('0' <= tmp[j] and tmp[j] <= '9' ? string(&tmp[j], 1) : \"*\");\n\t\t}\n\t\tvector<string> strs;\n\t\tREP(i, H) REP(j, W) dfs(i, j);\n\n\t\tREP(i, 70) REP(j, 70){\n\t\t\tint fr = 0;\n\t\t\twhile(fr < res[i][j].size() and res[i][j][fr] == '0') fr++;\n\t\t\tif(fr == res[i][j].size()) continue;\n\t\t\tstrs.push_back(res[i][j].substr(fr, res[i][j].size() - fr));\n\t\t}\n\t\tsort(ALL(strs), f);\n\t\tcout << strs[0] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\nusing namespace std;\nstring s[99];\nint w,h;\nstring dp[99][99];\nmain()\n{\n\twhile(cin>>w>>h,w)\n\t{\n\t\tfor(int i=0;i<h;i++)cin>>s[i];\n\t\tstring ans=\"\";\n\t\tfor(int i=h;i--;)for(int j=w;j--;)\n\t\t{\n\t\t\tif(s[i][j]>'9')dp[i][j]=\"\";\n\t\t\telse\n\t\t\t{\n\t\t\t\tstring t1(1,s[i][j]),t2(1,s[i][j]);\n\t\t\t\tif(i<h-1)t1+=dp[i+1][j];\n\t\t\t\tif(j<w-1)t2+=dp[i][j+1];\n\t\t\t\tif(t1.size()<t2.size()||t1.size()==t2.size()&&t1<t2)dp[i][j]=t2;\n\t\t\t\telse dp[i][j]=t1;\n\t\t\t}\n\t\t\tif(s[i][j]!='0')\n\t\t\t{\n\t\t\t\tif(ans.size()<dp[i][j].size())ans=dp[i][j];\n\t\t\t\telse if(ans.size()==dp[i][j].size()&&ans<dp[i][j])ans=dp[i][j];\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\ntypedef vector<int> v;\nint h,w,k;\nv x(v a,v b){\n\tif(a.size()==b.size())return max(a,b);\n\treturn (a.size()>b.size())?a:b;\n}\nint main(){\n\twhile(cin>>w>>h&&h){\n\tv d[75][75],s;r(i,h)r(j,w){\n\t\tchar z;cin>>z;z-='0';\n\t\tif(!(z/10)&&(z||d[i][j].size())){\n\t\t\td[i][j].push_back(z);\n\t\t\td[i+1][j]=x(d[i+1][j],d[i][j]);\n\t\t\td[i][j+1]=x(d[i][j+1],d[i][j]);\n\t\t}s=x(s,d[i][j]);\n\t}r(i,s.size())cout<<s[i];cout<<endl;\n\t}return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\nusing namespace std;\nint W,H;\nchar c[71][71];\nstring s[71][71];\nstring t = \".\";\n\nbool operation(const string &l,const string &r){\n\tif(l.size() != r.size()){\n\t\treturn l.size() < r.size();\n\t}\n\telse{\n\t\treturn l < r;\n\t}\n}\n\nstring solve(int i,int j){\n\tstring s1,s2;\n\ts1 = s2 = c[i][j];\n\tif(s[i][j] != t)return s[i][j];\n\tif(c[i][j+1] >= '0' && c[i][j+1] <= '9' && j+1 < W){\n\t\tif(s[i][j+1] != t) s1 += s[i][j+1];\n\t\telse s1 += solve(i,j+1);\n\t}\n\tif(c[i+1][j] >= '0' && c[i+1][j] <= '9' && i+1 < H){\n\t\tif(s[i+1][j] != t) s2 += s[i+1][j];\n\t\telse s2 += solve(i+1,j);\n\t}\n\n\ts[i][j] = max(s1,s2,operation);\n\treturn s[i][j];\n}\n\nint main(){\n\tstring res;\n\twhile(1){\n\t\tcin >> W >> H;\n\t\tif(W == 0)break;\n\t\tres = \"\";\n\t\tfor(int i = 0;i < 71;i++){\n\t\t\tfor(int j = 0;j < 71;j++){\n\t\t\t\ts[i][j] = \".\";\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tif(c[i][j] >= '1' && c[i][j] <= '9'){\n\t\t\t\t\tsolve(i,j);\n\t\t\t\t\tres = max(res,s[i][j],operation);\n\t\t\t\t}\n\t\t\t}\n\t\t}\t\t\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define INF_LL (int64)1e18\n#define INF (int32)1e9\n#define REP(i, n) for(int64 i = 0;i < (n);i++)\n#define FOR(i, a, b) for(int64 i = (a);i < (b);i++)\n#define all(x) x.begin(),x.end()\n#define fs first\n#define sc second\n\nusing int32 = int_fast32_t;\nusing uint32 = uint_fast32_t;\nusing int64 = int_fast64_t;\nusing uint64 = uint_fast64_t;\nusing PII = pair<int32, int32>;\nusing PLL = pair<int64, int64>;\n\nconst double eps = 1e-10;\n\ntemplate<typename A, typename B>inline void chmin(A &a, B b){if(a > b) a = b;}\ntemplate<typename A, typename B>inline void chmax(A &a, B b){if(a < b) a = b;}\n\ntemplate<typename T>\nvector<T> make_v(size_t a){return vector<T>(a);}\n\ntemplate<typename T,typename... Ts>\nauto make_v(size_t a,Ts... ts){\n  return vector<decltype(make_v<T>(ts...))>(a,make_v<T>(ts...));\n}\n\ntemplate<typename T,typename U,typename... V>\ntypename enable_if<is_same<T, U>::value!=0>::type\nfill_v(U &u,const V... v){u=U(v...);}\n\ntemplate<typename T,typename U,typename... V>\ntypename enable_if<is_same<T, U>::value==0>::type\nfill_v(U &u,const V... v){\n  for(auto &e:u) fill_v<T>(e,v...);\n}\n\nint64 W, H;\n\nvoid solve() {\n    vector<string> f(H);\n    REP(i, H) cin >> f[i];\n    auto dp = make_v<string>(H, W, H+W+1);\n    fill_v<string>(dp, \"\");\n    REP(j, H) {\n        REP(k, W) {\n            if (isdigit(f[j][k]))\n                dp[j][k][0] += f[j][k];\n        }\n    }\n    string res = string(H+W, '0');\n    REP(i, H+W) {\n        REP(j, H) {\n            REP(k, W) {\n                if (dp[j][k][i] == \"\") continue;\n                if (j+1 < H && isdigit(f[j+1][k])) {\n                    chmax(dp[j+1][k][i+1], dp[j][k][i]+f[j+1][k]);\n                }\n                if (k+1 < W && isdigit(f[j][k+1])) {\n                    chmax(dp[j][k+1][i+1], dp[j][k][i]+f[j][k+1]);\n                }\n                chmax(res, string(H+W-i, '0')+dp[j][k][i]);\n            }\n        }\n    }\n    int64 st = 0;\n    while(st < res.size() && res[st] == '0') st++;\n    cout << res.substr(st, res.size()-st) << endl;\n}\n\nint main(void) {\n    while (cin >> W >> H && W+H) {\n        solve();\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint W, H;\nvector<string> str;\nbool used[70][70];\nstring memo[70][70];\nconst int dx[] = { 1, 0 };\nconst int dy[] = { 0, 1 };\n\n\nbool Comp(const string& l, const string& r) {\n\treturn l.size() == r.size() ? l < r : l.size() < r.size();\n}\n\nstring MAX(const string& l, const string& r) {\n\treturn Comp(l, r) ? r : l;\n}\n\nstring dfs(int x, int y) {\n\tif (memo[x][y] != \"\") return memo[x][y];\n\tstring res[2];\n\tfor (int i = 0; i < 2; i++) {\n\t\tint tx = x + dx[i], ty = y + dy[i];\n\t\tif (tx >= 0 && tx < H && ty >= 0 && ty < W && str[tx][ty] >= '0' && str[tx][ty] <= '9') {\n\t\t\tres[i] = dfs(tx, ty);\n\t\t}\n\t}\n\tused[x][y] = true;\n\treturn memo[x][y] = str[x][y] + MAX(res[0], res[1]);\n}\n\nint main()\n{\n\twhile (cin >> W >> H, W || H) {\n\t\tfor (int i = 0; i < H; i++) {\n\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\tused[i][j] = false;\n\t\t\t\tmemo[i][j].clear();\n\t\t\t}\n\t\t}\n\t\tstr.resize(H);\n\t\tfor (int i = 0; i < H; i++) {\n\t\t\tcin >> str[i];\n\t\t}\n\t\tstring res;\n\t\tfor (int i = 0; i < H; i++) {\n\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\tif (!used[i][j] && str[i][j] >= '1' && str[i][j] <= '9') {\n\t\t\t\t\tres = MAX(res, dfs(i, j));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a; i<b; ++i)\n#define rep(i,n) REP(i,0,n)\n\nchar input[70][70];\nstring dp[70][70];\n\nint comp(string s,string t) { // comp s and t if s < t return negative\n  if(s.length() != t.length()) return (s.length() - t.length());\n  rep(i,s.length()) if(s[i] != t[i]) return (s[i] - t[i]);\n  return 0;\n}\n\nint main() {\n  int w,h,n;\n  while(cin>>w>>h, w|h) {\n    string s;\n    rep(i,h) {\n      cin>>s;\n      rep(j,w) {\n\tdp[i][j] = \"\";\n\tinput[i][j] = s[j];\n      }\n    }\n\n    rep(i,h) {\n      rep(j,w) {\n\tchar c = input[i][j];\n\tif(!(c <= '9' && c >= '0')) continue;\n\tstring ab = \"\",left = \"\";\n\tif(i > 0) ab = dp[i-1][j] + string(1,c);\n\tif(j > 0) left = dp[i][j-1] + string(1,c);\n\tif(comp(ab,left) <= 0) {\n\t  dp[i][j] = left;\n\t}else{\n\t  dp[i][j] = ab;\n\t}\n\tif(dp[i][j][0] == '0') dp[i][j] = dp[i][j].substr(1);\n\t//cout<<i<<\" \"<<j<<\" \"<<dp[i][j]<<endl;\n      }\n    }\n\n    string ans = \"\";\n    rep(i,h) rep(j,w) { if(comp(ans,dp[i][j]) < 0) ans = dp[i][j]; }\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cassert>\n#include <cctype>\n#include <complex>\n#include <cstdio>\n#include <map>\n#include <math.h>\n#include <queue>\n#include <set>\n#include <stack>\n#include <string>\n#include <vector>\nusing namespace std;\n\n#define rep(i,n) for(int i=0;i<n;i++)\n\nint W,H;\nchar c[69][70];\nstring dp[69][69];\n\nint main(){\n\twhile(cin>>W>>H&&W){\n\t\trep(i,69)fill(dp[i],dp[i]+69,\"\");\n\t\trep(i,H)rep(j,W)cin>>c[i][j];\n\t\trep(i,H)rep(j,W)if(isdigit(c[i][j])){\n\t\t\tif(!i&&!j)dp[i][j]=c[i][j];\n\t\t\telse if(!i)dp[i][j]=dp[i][j-1]+c[i][j];\n\t\t\telse if(!j)dp[i][j]=dp[i-1][j]+c[i][j];\n\t\t\telse{\n\t\t\t\tstring l=dp[i][j-1],u=dp[i-1][j];\n\t\t\t\tif(l.size()>u.size())dp[i][j]=l+c[i][j];\n\t\t\t\telse if(l.size()<u.size())dp[i][j]=u+c[i][j];\n\t\t\t\telse{\n\t\t\t\t\tdp[i][j]=max(l,u)+c[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dp[i][j][0]=='0')dp[i][j]=dp[i][j].substr(1);\n\t\t}\n\t\t//rep(i,H)rep(j,W)cout<<dp[i][j]<<(j==W-1?\"\\n\":\" \");\n\t\tstring ans=\"\";\n\t\trep(i,H)rep(j,W)if(dp[i][j].size()>ans.size()||dp[i][j].size()==ans.size()&&dp[i][j]>ans)ans=dp[i][j];\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cstdlib>\n#include<typeinfo>\n#include<set>\n#include<map>\n#include<vector>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<numeric>\n#include<cassert>\n#include<random>\nusing namespace std;\n\nbool num(char c){\n    if(c<'0' || c>'9'){return false;}\n    return true;\n}\n\nstring max(string a,string b){\n    int as=(int)a.size();\n    int bs=(int)b.size();\n    for(int i=0;a[i]=='0';i++){as--;}\n    for(int i=0;b[i]=='0';i++){bs--;}\n    if(as>bs){return a;}\n    if(bs>as){return b;}\n    for(int i=0;i<as;i++){\n        if(a[a.size()-as+i]>b[b.size()-bs+i]){return a;}\n        if(a[a.size()-as+i]<b[b.size()-bs+i]){return b;}\n    }\n    return a;\n}\n\nstring pls(char c,string s){\n    s.push_back(1);\n    for(int i=(int)s.size()-2;i>=0;i--){\n        s[i+1]=s[i];\n    }\n    s[0]=c;\n    return s;\n}\n\nint main(){\n    while(1){\n        \n        \n        \n    \n    char a[100][100]={};\n    int w,h;\n    cin>>w>>h;\n        if(w==0 && h==0){break;}\n    for(int i=0;i<h;i++){\n        for(int t=0;t<w;t++){\n            cin>>a[i][t];\n        }\n    }\n    string dp[100][100]={};\n    string ans;\n    for(int i=h-1;i>=0;i--){\n        for(int t=w-1;t>=0;t--){\n            if(num(a[i][t])){\n                dp[i][t]=pls(a[i][t],max(dp[i+1][t],dp[i][t+1]));\n                ans=max(ans,dp[i][t]);\n            }\n        }\n    }\n    int an=atoi(ans.c_str());\n    cout<<an<<endl;\n        \n    \n        \n        \n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include<unordered_map>\n#include<unordered_set>\n#pragma warning(disable:4996)\nusing namespace std;\nusing ld = long double;\ntemplate<class T>\nusing Table = vector<vector<T>>;\nconst ld eps=1e-9;\n\n//// < \"D:\\D_Download\\Visual Studio 2015\\Projects\\programing_contest_c++\\Debug\\a.txt\"\n\nbool check(const string &l, const string &r) {\n\treturn l.size() == r.size() ? l < r : l.size() < r.size();\n}\nint main() {\n\twhile (1) {\n\t\tint W, H; cin >> W >> H;\n\t\tif (!W)break;\n\t\tvector<string>sts;\n\t\tfor (int i = 0; i < H; ++i) {\n\t\t\tstring st; cin >> st;\n\t\t\tsts.push_back(st);\n\t\t}\n\t\tvector<vector<string>>longs(H,vector<string>(W));\n\t\tfor (int x = 0; x < W; ++x) {\n\t\t\tfor (int y = 0; y < H; ++y) {\n\t\t\t\tif (isdigit(sts[y][x])) {\n\t\t\t\t\tlongs[y][x] = sts[y][x];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (int x = 0; x < W; ++x) {\n\t\t\tfor (int y = 0; y < H; ++y) {\n\t\t\t\tif (isdigit(sts[y][x])) {\n\t\t\t\t\tif (x > 0) {\n\t\t\t\t\t\tlongs[y][x] = check(longs[y][x], longs[y][x - 1] + sts[y][x]) ?  longs[y][x - 1] + sts[y][x]: longs[y][x] ;\n\t\t\t\t\t}\n\t\t\t\t\tif (y > 0) {\n\t\t\t\t\t\tlongs[y][x] = check(longs[y][x], longs[y-1][x] + sts[y][x]) ? longs[y - 1][x] + sts[y][x]: longs[y][x];\n\t\t\t\t\t}\n\t\t\t\t\tif (longs[y][x][0] == '0')longs[y][x] = longs[y][x].substr(1, longs[y][x].size() - 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring ans;\n\t\tfor (int x = 0; x < W; ++x) {\n\t\t\tfor (int y = 0; y < H; ++y) {\n\t\t\t\tans = check(ans, longs[y][x]) ? longs[y][x]: ans;\n\t\t\t\t\t\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nbool larger(string a, string b){\n    if(a.length() == b.length()){\n        return a < b;\n    }\n    return a.length() < b.length();\n}\nbool largerD(string a, string b){\n    while((int)a.length()>0 && a[0]=='0') a.erase(a.begin());\n    while((int)b.length()>0 && b[0]=='0') b.erase(b.begin());\n    return larger(a,b);\n}  \n\nint main(){\n    while(1){\n        int w,h;\n        cin >> w >> h;\n        if(w==0) break;\n\n        vector<vector<string> > mat(h+1, vector<string>(w+1, \"\"));\n        for(int i=0; i<h; i++){\n            for(int j=0; j<w; j++){\n                char c;\n                cin >> c;\n                if('0'<=c && c<='9'){\n                    mat[i][j] = string(1,c);\n                }\n            }\n        }\n\n        string largest = \"\";\n        for(int i=h-1; i>=0; i--){\n            for(int j=w-1; j>=0; j--){\n                if(mat[i][j] == \"\") continue;\n                if(larger(mat[i+1][j], mat[i][j+1])){\n                    mat[i][j] += mat[i][j+1];\n                }else{\n                    mat[i][j] += mat[i+1][j];\n                }\n                if(largerD(largest, mat[i][j])){\n                    largest = mat[i][j];\n                }\n            }\n        }\n        if(largest == \"\") largest = \"0\";\n        cout << largest << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n\nusing namespace std;\n\nbool compare(string S1, string S2)\n{\n\tif (S1.size() != S2.size()) { return S1.size() > S2.size(); }\n\n\treturn S1 > S2;\n}\n\nint main()\n{\n\tint H, W; char c[70];\n\n\twhile (true)\n\t{\n\t\tscanf(\"%d\", &W);\n\t\tscanf(\"%d\", &H);\n\n\t\tif (H == 0 && W == 0) { break; }\n\n\t\tvector<string> R;\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tscanf(\"%s\", c);\n\n\t\t\tR.push_back(c);\n\t\t}\n\n\t\tvector<vector<string> > dp(H, vector<string>(W, \"\"));\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (isdigit(R[i][j]))\n\t\t\t\t{\n\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][j] = R[i][j];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i - 1][j] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]) && dp[i - 1][j] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i - 1][j] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (j != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i][j - 1] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]) && dp[i][j - 1] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i][j - 1] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ret = \"\";\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (compare(dp[i][j], ret))\n\t\t\t\t{\n\t\t\t\t\tret = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%s\\n\", ret.c_str());\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef pair<int,int> P;\n\nint main ()\n{\n    int n, m;\n    while (cin >> m >> n, n || m) {\n        vector<vector<char> > v (n, vector<char>(m, '#'));\n        for (int i = 0; i < n; i++) {\n            for (int j = 0; j < m; j++) {\n                char str;\n                cin >> str;\n                if ('0' <= str && str <= '9') {\n                    v[i][j] = str;\n                }\n            }\n        }\n\n        vector<vector<string> > dp(n, vector<string>(m, \"\"));\n\n        for (int i = 0; i < m; i++) {\n            if (v[0][i] != '#') {\n                dp[0][i] = (i > 0 ? dp[0][i-1] : \"\") + v[0][i];\n            }\n        }\n\n        for (int i = 1; i < n; i++) {\n            if (v[i][0] != '#') {\n                dp[i][0] = dp[i-1][0] + v[i][0];\n            }\n        }\n\n        string res = \"\";\n\n        for (int i = 1; i < n; i++) {\n            for (int j = 1; j < m; j++) {\n                if (v[i][j] != '#') {\n                    string s1 = dp[i-1][j] + v[i][j];\n                    string s2 = dp[i][j-1] + v[i][j];\n\n                    if (s1.size() == s2.size()) {\n                        dp[i][j] = max(s1, s2);\n                    } else {\n                        dp[i][j] = s1.size() > s2.size() ? s1 : s2;\n                    }\n                    if (res.size() == dp[i][j].size()) {\n                        res = max(res, dp[i][j]);\n                    } else {\n                        res = res.size() > dp[i][j].size() ? res : dp[i][j];\n                    }\n                }\n            }\n        }\n\n        cout << res << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nconst int WH = 72;\n\nchar board[WH];\nstring dp[WH];\n\nbool comp(const string& a, const string& b){\n\tif(a.length() == b.length()){\n\t\treturn a < b;\n\t}\n\treturn a.length() < b.length();\n}\n\nint main(){\n\tint w, h, m;\n\tstring r;\n\twhile(cin >> w >> h, w){\n\t\tr = \"\";\n\t\tfor(int i = 0;i < w * h;++i){\n\t\t\tcin >> board[i];\n\t\t}\n\t\tfor(int i = 0;i < h;++i){\n\t\t\tfor(int j = 0;j < w;++j){\n\t\t\t\tdp[i * w + j] = \"\";\n\t\t\t\tif(i - 1 >= 0 && dp[(i - 1) * w + j] != \"\"){\n\t\t\t\t\tdp[i * w + j] = dp[(i - 1) * w + j];\n\t\t\t\t}\n\t\t\t\tif(j - 1 >= 0 && dp[i * w + (j - 1)] != \"\"){\n\t\t\t\t\tdp[i * w + j] = max(dp[i * w + j], dp[i * w + (j - 1)], comp);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif('0' <= board[i * w + j] && board[i * w + j] <= '9'){\n\t\t\t\t\tif(dp[i * w + j] != \"\" || board[i * w + j] != '0'){\n\t\t\t\t\t\tdp[i * w + j] += board[i * w + j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse dp[i * w + j] = \"\";\n\n\t\t\t\tr = max(r, dp[i * w + j], comp);\n\t\t\t}\n\t\t}\n\t\tcout << r << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <string>\n#include <iostream>\n#include <cstring>\nusing namespace std;\n\nint w,h;\nchar fie[72][72];\nstring str[72][72];\n\nint main(void){\n\twhile(1){\n\t\tscanf(\"%d %d\",&w,&h);\n\t\tif(w+h==0)break;\n\t\tfor(int i=0;i<h;i++){\n\t\t\tstring in;\n\t\t\tcin >> in;\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tfie[j][i]=in[j];\n\t\t\t\tstr[j][i]=\"\";\n\t\t\t}\n\t\t}\n\t\tstring res=\"\";\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tif(str[j][i]==\"\" && fie[j][i]=='0')continue;\n\t\t\t\tif(fie[j][i]>='0' && fie[j][i]<='9'){\n\t\t\t\t\tstr[j][i]+=fie[j][i];\n\t\t\t\t}else continue;\n\t\t\t\tif(res.size()<str[j][i].size() || (res.size()==str[j][i].size() && res<str[j][i])){\n\t\t\t\t\tres=str[j][i];\n\t\t\t\t}\n\t\t\t\tif(str[j+1][i].size()<str[j][i].size() || (str[j+1][i].size()==str[j][i].size() && str[j+1][i]<str[j][i])){\n\t\t\t\t\tstr[j+1][i]=str[j][i];\n\t\t\t\t}\n\t\t\t\tif(str[j][i+1].size()<str[j][i].size() || (str[j][i+1].size()==str[j][i].size() && str[j][i+1]<str[j][i])){\n\t\t\t\t\tstr[j][i+1]=str[j][i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;typedef vector<int> v;int h,w,k;v x(v a,v b){return a.size()>b.size()?a:a.size()<b.size()?b:max(a,b);}int main(){while(cin>>w>>h&&h){v d[75][75],s;r(i,h)r(j,w){char z;cin>>z;z-='0';if(!(z/10)&&(z||d[i][j].size())){d[i][j].push_back(z);d[i+1][j]=x(d[i+1][j],d[i][j]);d[i][j+1]=x(d[i][j+1],d[i][j]);}s=x(s,d[i][j]);}r(i,s.size())cout<<s[i];cout<<endl;}return 0;}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include <sys/timeb.h>\n#include <fstream>\n\nusing namespace std;\n\n#define repl(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define replrev(i,a,b) for(int i=(int)(b)-1;i>=(int)(a);i--)\n#define reprev(i,n) replrev(i,0,n)\n#define repi(itr,ds) for(auto itr=ds.begin();itr!=ds.end();itr++)\n#define all(a) a.begin(),a.end()\n#define mp make_pair\n#define mt make_tuple\n#define INF 2000000000\n#define INFL 1000000000000000000LL\n#define EPS 1e-9\n#define MOD 1000000007\n#define PI 3.1415926536\n#define RMAX 4294967295\n\ntypedef long long ll;\ntypedef pair<int, int> P;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<bool> vb;\ntypedef vector<char> vc;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<P> vP;\ntypedef vector<vector<int> > vvi;\ntypedef vector<vector<bool> > vvb;\ntypedef vector<vector<ll> > vvll;\ntypedef vector<vector<char> > vvc;\ntypedef vector<vector<string> > vvs;\ntypedef vector<vector<double> > vvd;\ntypedef vector<vector<P> > vvP;\ntypedef priority_queue<int, vector<int>, greater<int> > pqli;\ntypedef priority_queue<ll, vector<ll>, greater<ll> > pqlll;\ntypedef priority_queue<P, vector<P>, greater<P> > pqlP;\ntypedef pair<int, pair<int, int> > Edge;\ntypedef vector<Edge> vE;\ntypedef priority_queue<Edge, vector<Edge>, greater<Edge> > pqlE;\n\nbool isNum(char c) {\n\treturn (c >= '0' && c <= '9');\n}\nbool isPlusNum(char c) {\n\treturn (c >= '1' && c <= '9');\n}\n\nstring maxnum(string a, string b) {\n\tif (a.length() > b.length()) {\n\t\treturn a;\n\t}\n\telse if (a.length() < b.length()) {\n\t\treturn b;\n\t}\n\telse {\n\t\treturn max(a, b);\n\t}\n}\n\nint main() {\n\twhile (true) {\n\t\tvector<pair<int, string> > nums;\n\t\tint W, H;\n\t\tcin >> W >> H;\n\t\tif (W == 0 && H == 0)break;\n\t\tvs f(H);\n\t\trep(i, H) {\n\t\t\tcin >> f[i];\n\t\t}\n\t\tvvs dp(H, vs(W, \"\"));\n\t\treprev(i, H) {\n\t\t\treprev(j, W) {\n\t\t\t\tif (isNum(f[i][j])) {\n\t\t\t\t\tif (i == H - 1) {\n\t\t\t\t\t\tif (j == W - 1) {\n\t\t\t\t\t\t\tdp[i][j] += f[i][j];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tdp[i][j] += f[i][j] + dp[i][j + 1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (j == W - 1) {\n\t\t\t\t\t\tdp[i][j] += f[i][j] + dp[i + 1][j];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[i][j] += f[i][j] + maxnum(dp[i + 1][j], dp[i][j + 1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring ans;\n\t\trep(i, H)rep(j, W) {\n\t\t\tif (dp[i][j].length() == 0 || dp[i][j][0] == '0')continue;\n\t\t\tans = maxnum(ans, dp[i][j]);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<vector>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\n\n#define rep(i,n) for(int i=0;i<n;i++)\n#define REP(n) rep(i,n)\n#define all(n) n.begin(),n.end()\n\nconst int MAXW = 75, MAXH = 75;\nint main()\n{\n\tint w, h;\n\twhile(cin >> w >> h && h)\n\t{\n\t\tstring tile[MAXH] = {};\n\t\trep(j, h) cin >> tile[j];\n\t\tstring dp[MAXW][MAXH] = {}, us, ls;\n\n\t\trep(j,h)rep(i,w)if(('0' <= tile[j][i]) && (tile[j][i] <= '9'))\n\t\t{\n\t\t\tus = dp[i + 1][j];\n\t\t\tls = dp[i][j + 1];\n\t\t\tif(us.size() < ls.size() || (us.size() == ls.size() && us < ls))\n\t\t\t\tdp[i + 1][j + 1] = ls + tile[j][i];\n\t\t\telse\n\t\t\t\tdp[i + 1][j + 1] = us + tile[j][i];\n\n\t\t\tif(dp[i + 1][j + 1] == \"0\") dp[i + 1][j + 1] = \"\";\n\t\t}\n\t\tstring ans  = \"\";\n\t\trep(j,h)rep(i,w)if(dp[i + 1][j + 1].size() != 0 )\n\t\t{\n\t\t\tif(ans.size() < dp[i + 1][j + 1].size() ||\n\t\t\t\t\t(ans.size()==dp[i+1][j+1].size() && ans < dp[i + 1][j + 1]))\n\t\t\t\tans = dp[i + 1][j + 1];\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cctype>\n\nusing namespace std;\n\n#define rep(i, n) for(int i=0; i<(n); ++i)\n\ntemplate<typename T, typename Compare = greater<T> >\ninline void chmax(T& t, T f, Compare comp = Compare()){if(!comp(t, f))t = f;}\n\nint W, H;\n\nstring solve(vector<string>& Cs){\n    vector<vector<string> > mem(H, vector<string>(W));\n    string res = \"\";\n    auto comp = [](string& s, string& t){return s.size() == t.size()? t < s: t.size() < s.size();};\n    rep(i, H)rep(j, W)if(isdigit(Cs[i][j])){\n        if(mem[i][j].empty())mem[i][j] = Cs[i][j];\n        if(i && mem[i-1][j] != \"0\")chmax(mem[i][j], mem[i-1][j] + Cs[i][j], comp);\n        if(j && mem[i][j-1] != \"0\")chmax(mem[i][j], mem[i][j-1] + Cs[i][j], comp);\n        chmax(res, mem[i][j], comp);\n    }\n    return res;\n}\n\nint main(){\n    while(cin >> W >> H, W|H){\n        vector<string> Cs(H);\n        rep(i, H)cin >> Cs[i];\n        cout << solve(Cs) << '\\n';\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//#include \"bits/stdc++.h\"\n\n#include <iostream>\n#include <array>\n// #include <map>\n#include <string>\n// #include <algorithm>\n// #include <numeric>\n// #include <limits>\n\nusing namespace std;\n\nint w; // j\nint h; // i\nstring max_s(72, ' ');\narray<array<char, 72>, 72> field; // [i][j]\narray<char, 72> num;\nstring str(72, ' ');\n\nstring big(const string& a, const string& b) {\n\tif (a.size() == b.size()) {\n\t\tif (a > b) {\n\t\t\treturn a;\n\t\t} else {\n\t\t\treturn b;\n\t\t}\n\t}\n\tif (a.size() > b.size()) {\n\t\treturn a;\n\t} else {\n\t\treturn b;\n\t}\n}\n\nvoid check(int d) {\n\tint padding = 0;\n\tfor (int k = 0; k < d; k++) {\n\t\tif (num[k] == '0') {\n\t\t\tpadding++;\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t}\n\tint s = d - padding; // as size\n\tstr.resize(s);\n\tfor (int k = 0; k < s; k++) {\n\t\tstr[k] = num[k + padding];\n\t}\n\tmax_s = big(max_s, str);\n}\n\nvoid _trace(int i, int j, int d /* depth */) {\n\tnum[d] = field[i][j];\n\td++;\n\tint new_i = i + 1;\n\tint new_j = j + 1;\n\tbool flg_end = true;\n\tif (new_i < h and isdigit(field[new_i][j])) {\n\t\t_trace(new_i, j, d);\n\t\tflg_end = false;\n\t}\n\tif (new_j < w and isdigit(field[i][new_j])) {\n\t\t_trace(i, new_j, d);\n\t\tflg_end = false;\n\t}\n\tif (flg_end) {\n\t\tcheck(d);\n\t}\n}\n\nvoid trace(int i, int j) {\n\tif (isdigit(field[i][j]) == false) {\n\t\treturn;\n\t}\n\tif (i > 0 and isdigit(field[i - 1][j])) {\n\t\treturn;\n\t}\n\tif (j > 0 and isdigit(field[i][j - 1])) {\n\t\treturn;\n\t}\n\t_trace(i, j, 0);\n}\n\nvoid solve() {\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\tcin >> field[i][j];\n\t\t}\n\t}\n\tmax_s = \"\";\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\ttrace(i, j);\n\t\t}\n\t}\n\tcout << max_s << endl;\n}\n\nint main() {\n\n\twhile (true) {\n\t\tcin >> w >> h;\n\t\tif (w == 0 and h == 0) {\n\t\t\tbreak;\n\t\t}\n\t\tsolve();\n\t}\n\n\t//std::cout << \"\\e[38;5;0m\\e[48;5;40m --- end ---  \\e[m\" << std::endl; // debug\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <cstring>\n#include <algorithm>\n#include <sstream>\n\n#define REP(i,k,n) for(int i=k;i<n;i++)\n#define rep(i,n) for(int i=0;i<n;i++)\n\nusing namespace std;\ntypedef long long ll;\n\nstring parse(string a) {\n    if(a == \"0\") return a;\n\n    bool flag = true;\n    stringstream ss;\n    rep(i,a.size()) {\n        if(flag && a[i] == '0') continue;\n        else {\n            flag = false;\n            ss << a[i];\n        }\n    }\n\n    return ss.str();\n}\n\nstring smax(string a,string b) {\n    a = parse(a);\n    b = parse(b);\n    if(a.size() > b.size()) return a;\n    if(b.size() > a.size()) return b;\n    return max(a,b);\n}\n\nint main() {\n\n    int h,w;\n    while(cin >> w >> h) {\n        if(w == 0 && h == 0) break;\n\n        vector<string> v(h);\n        vector<vector<string> > memo(h);\n\n        rep(i,h) {\n            cin >> v[i];\n            memo[i].resize(w);\n        }\n\n        rep(i,h) {\n            rep(j,w) {\n                if('0' <= v[i][j] && v[i][j] <= '9') {\n                    stringstream ss;\n                    ss << v[i][j];\n\n                    memo[i][j] = ss.str();\n                }\n            }\n        }\n\n        REP(i,0,h) {\n            REP(j,0,w) {\n                if('0' <= v[i][j] && v[i][j] <= '9') {\n                    stringstream ss,ss2;\n\n                    if(0 <= i-1) {\n                        ss << memo[i-1][j];\n                    }\n                    if(0 <= j-1) {\n                        ss2 << memo[i][j-1];\n                    }\n\n                    ss << memo[i][j];\n                    ss2 << memo[i][j];\n\n                    string res = ss.str();\n                    string res2 = ss2.str();\n\n                    memo[i][j] = smax(res,res2);\n                }\n            }\n        }\n\n        string ans = \"\";\n        rep(i,h) {\n            rep(j,w) {\n                ans = smax(ans,memo[i][j]);\n            }\n        }\n\n        cout << ans << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\nusing namespace std;\n\nstring comp(string s1,string s2){\n\tif(s1.size()>s2.size())\n\t\treturn s1;\n\telse if(s1.size()<s2.size())\n\t\treturn s2;\n\n\treturn max(s1,s2);\n}\n\nint main()\n{\n\tint W,H;\n\twhile(cin>>W>>H && W!=0){\n\t\tvector<string> M;\n\t\tfor(int i=0;i<H;i++){\n\t\t\tstring s;\n\t\t\tcin>>s;\n\t\t\tM.push_back(s);\n\t\t}\n\t\tvector<vector<string> > dp(H,vector<string>(W,\"\"));\n\n\t\tstring ans=\"\";\n\n\t\tfor(int y=0;y<H;y++){\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tif(!isdigit(M[y][x])) continue;\n\n\t\t\t\tstring s1=\"\",s2=\"\";\n\t\t\t\tif(x>=1){\n\t\t\t\t\ts1=dp[y][x-1]+M[y][x];\n\t\t\t\t}\n\t\t\t\tif(y>=1){\n\t\t\t\t\ts2=dp[y-1][x]+M[y][x];\n\t\t\t\t}\n\n\t\t\t\tdp[y][x]=comp(s1,s2);\n\t\t\t\tif(dp[y][x]==\"0\") dp[y][x]=\"\";\n\t\t\t\tans=comp(dp[y][x],ans);\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define ALL(x) (x).begin(), (x).end()\n\nusing namespace std;\n\ntemplate <typename T> T &chmin(T &a, const T &b) { return a = min(a, b); }\ntemplate <typename T> T &chmax(T &a, const T &b) { return a = max(a, b); }\n\nusing ll = long long;\nusing ld = long double;\n\nconst int INF = 1e9;\nconst ld eps = 1e-9, pi = acos(-1.0);\n\nint W, H;\nstring mass[75][75];\nstring res[70][70];\n\nstring dfs(int h, int w, string str){\n\tif(res[h][w] != \"\") return res[h][w];\n\tif(mass[h+1][w] == \"*\" and mass[h][w+1] == \"*\" and mass[h][w] != \"*\") return res[h][w] = str.append(mass[h][w]);\n\tstr.append(mass[h][w]);\n\t//\tcout << str << endl;\n\tif(mass[h+1][w] == \"*\") return res[h][w] = dfs(h, w+1, str);\n\tif(mass[h][w+1] == \"*\") return res[h][w] = dfs(h+1, w, str);\n\treturn res[h][w] = max(dfs(h, w+1, str), dfs(h+1, w, str));\n}\n\nbool f(const string &a, const string &b){\n\tif(a.size() < b.size()) return false;\n\tif(a.size() > b.size()) return true;\n\tREP(i, a.size()) if(a[i] < b[i]) return false;\n\treturn true;\n}\n\nint main(){\n\twhile(cin >> W >> H and W + H){\n\t\tREP(i, 75) REP(j, 75) mass[i][j] = \"*\";\n\t\tREP(i, 70) REP(j, 70) res[i][j] = \"\";\n\t\tREP(i, H){\n\t\t\tstring tmp; cin >> tmp;\n\t\t\tREP(j, W) mass[i][j] = (0 <= tmp[j]-'0' and tmp[j]-'0' <= 9 ? tmp.substr(j, 1) : \"*\");\n\t  }\n\t\tREP(i, H) REP(j, W) if(mass[i][j] != \"*\") dfs(i, j, \"\");\n\t\tvector<string> vals;\n\t\tREP(i, H) REP(j, W)\tif(res[i][j] != \"\") {\n\t\t\tint fr = 0;\n\t\t\twhile(res[i][j][fr] == '0' and fr < res[i][j].size()) fr++;\n\t\t\tif(fr == res[i][j].size()) continue;\n\t\t\tvals.push_back(res[i][j].substr(fr, res[i][j].size()-fr));\n\t\t}\n\t\t//REP(i, vals.size()) cout << vals[i] << endl;\n\t\t//cout << \"==\" << endl;\t\t\n\t\tsort(ALL(vals), f);\n\t\t//vals.erase(unique(ALL(vals)), vals.end());\n\t\tvector<string> res;\n\t\tREP(i, vals.size()) if(vals[i] != \"\") res.push_back(vals[i]);\n\t\t//cout << \"size : \" << vals.size() << endl;\n\t\tcout << res[0] << endl;\n\t\t//cout << \"-------------\" << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint W,H;\n\nbool flag[70][70][70];\nstring dp[70][70][70];\nstring mat[70];\n\nstring max_str(const string& s1, const string& s2) {\n    string s11(s1);\n    string s22(s2);\n    reverse(all(s11));\n    reverse(all(s22));\n    if(s11.size() == s22.size()) {\n        return s11 > s22?s1:s2;\n    }\n    else return s11.size() > s22.size() ? s1 : s2;\n}\nstring dfs(int y, int x,int c) {\n    if(flag[y][x][c]) return dp[y][x][c];\n    string res=\"\";\n\n    rep(i,2) {\n        int ny=y+dy[i];\n        int nx=x+dx[i];\n        if(!(0<=ny&&ny<H)) continue;\n        if(!(0<=nx&&nx<W)) continue;\n        if(!('0'<=mat[ny][nx]&&mat[ny][nx]<='9')) continue;\n        res=max_str(res,dfs(ny,nx,c+1)+mat[ny][nx]);\n\n    }\n\n    flag[y][x][c]=true;\n    return dp[y][x][c]=res;\n}\n\nvoid solve() {\n    rep(i,70) {\n        mat[i]=\"\";\n        rep(j,70) rep(a,70) {\n            dp[i][j][a]=\"\";\n            flag[i][j][a]=false;\n        }\n    }\n\n    rep(i,H) cin>>mat[i];\n\n    string ans=\"\";\n\n    rep(i,H) rep(j,W) if('1'<=mat[i][j]&&mat[i][j]<='9') {\n        string s=\"a\";\n        s[0]=mat[i][j];\n        ans=max_str(ans,dfs(i,j,0)+s);\n    }\n\n    reverse(all(ans));\n    cout<<ans<<endl;\n}\n\nint main() {\n    while(cin>>W>>H) {\n        if(W+H==0) break;\n        solve();\n\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\nusing namespace std;\nint W,H;\nchar c[71][71];\nstring s[71][71],t = \".\";\n\nbool operation(string l,string r){\n\tif(l.size() != r.size()){\n\t\treturn l.size() < r.size();\n\t}\n\telse{\n\t\treturn l < r;\n\t}\n}\n\nvector<string> v;\n\nstring solve(int i,int j){\n\tlong long a,b;\n\tstring s1,s2;\n\ts1 = s2 = c[i][j];\n\tif(s[i][j] != t)return s[i][j];\n\tif(c[i][j+1] >= '0' && c[i][j+1] <= '9' && j+1 < W){\n\t\tif(s[i][j+1] != t) s1 += s[i][j+1];\n\t\telse s1 += solve(i,j+1);\n\t}\n\tif(c[i+1][j] >= '0' && c[i+1][j] <= '9' && i+1 < H){\n\t\tif(s[i+1][j] != t) s2 += s[i+1][j];\n\t\telse s2 += solve(i+1,j);\n\t}\n\n\ts[i][j] = max(s1,s2,operation);\n\n\tv.push_back(s[i][j]);\n\treturn s[i][j];\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> W >> H;\n\t\tint x,y;\n\t\tstring st,res;\n\t\tif(W == 0)break;\n\t\tv.clear();\n\t\tres = \"\";\n\t\tfor(int i = 0;i < 71;i++){\n\t\t\tfor(int j = 0;j <= 71;j++){\n\t\t\t\tc[i][j] = '.';\n\t\t\t\ts[i][j] = '.';\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tif(c[i][j] >= '1' && c[i][j] <= '9'){\n\t\t\t\t\tst = solve(i,j);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsort(v.begin(),v.end(),operation);\n//\t\tfor(int i = 0;i < v.size();i++){\n//\t\t\tres = max(res,v[i].s,operation);\n//\t\t}\t\t\n\n\t\tcout << v[v.size()-1] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\n\nstring max(string a, string b){\n    \n    if(a.size() > b.size()) return a;\n    else if(a.size() < b.size()) return b;\n\n    for(int i = 0; i < a.size(); i++){\n        if(a[i] > b[i]) return a;\n        else if(a[i] < b[i]) return b;\n    }\n\n    return a;\n}\n\nint main(){\n\n    while(1){\n        int w, h; cin >> w >> h;\n        if(w == 0 || h == 0) break;\n\n        vector<vector<char> > matrix(h, vector<char> (w));\n        vector<vector<string> > dp(h, vector<string> (w, \"\"));\n        for(int i = 0; i < h; i++){\n            for(int j = 0; j < w; j++){\n                cin >> matrix[i][j];\n            }\n        }\n\n        //dp\n\n        string ans = \"\";\n        for(int i = 0; i < h; i++){\n            for(int j = 0; j < w; j++){\n                if(matrix[i][j] < '0' || '9' < matrix[i][j]) continue;\n\n                if(i == 0 && j == 0){ \n                    dp[i][j] = matrix[i][j];\n                    if(dp[i][j] == \"0\") dp[i][j] = \"\";\n                    ans = max(ans, dp[i][j]);\n                    continue;\n                }\n\n                if(i > 0) dp[i][j] = max(dp[i][j], dp[i - 1][j] + matrix[i][j]);\n                if(j > 0) dp[i][j] = max(dp[i][j], dp[i][j - 1] + matrix[i][j]);\n\n                if(dp[i][j] == \"0\") dp[i][j] = \"\";\n\n                ans = max(ans, dp[i][j]);\n            }\n        }\n\n        cout << ans << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stdio.h>\n#include<string>\nusing namespace std;\nint H,W;\nchar t[700][700],ch;\n\nstring dp[700][700],maxm;\n\nstring strmax(string x,string y){\n  if(x==\"-\"&&y==\"-\")return \"-\";\n  if(x==\"-\")return y;\n  if(y==\"-\")return x;\n  while(x[0]=='0'&&x.size()>=2)x=x.substr(1,x.size()-1);\n  while(y[0]=='0'&&y.size()>=2)y=y.substr(1,y.size()-1);\n  if(x.size()==y.size()){\n    for(int i=0;i<(int)x.size();i++){\n      if(x[i]>y[i]){\n\treturn x;\n      }else if(x[i]<y[i]){\n\treturn y;\n      }\n    }\n    return x;\n  }else if(x.size()>y.size()){\n    return x;\n  }else{\n    return y;\n  }\n}\n\nchar judge(char ch){\n  if('0'<=ch&&ch<='9')return ch;\n  else return '-';\n}\nint main(){\n  int flg;\n  while(cin>>W>>H && W&& H){\n    scanf(\"%c\",&t[0][0]);\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\tdp[i][j]=\"\";\n\tscanf(\"%c\",&t[i][j]);\n\tif(judge(t[i][j])=='-')flg++;\n      }\n      scanf(\"%c\",&ch);\n    }\n    //if(flg==H*W){cout<<\"0\"<<endl;continue;}\n    dp[0][0].push_back(judge(t[0][0])); \n    \n    for(int i=1;i<W;i++){\n      if(judge(t[0][i])=='-'){\n\tdp[0][i]=\"-\";\n\tcontinue;\n      }\n      if(dp[0][i-1]!=\"-\")dp[0][i]=dp[0][i-1];      \n      dp[0][i].push_back(judge(t[0][i]));\n    }\n    for(int i=1;i<H;i++){\n      if(judge(t[i][0])=='-'){\n\tdp[i][0]=\"-\";\n\tcontinue;\n      }\n      if(dp[i-1][0]!=\"-\")dp[i][0]=dp[i-1][0];      \n      dp[i][0].push_back(judge(t[i][0]));\n    }\n\n    maxm=\"0\";\n    for(int i=1;i<H;i++){\n      for(int j=1;j<W;j++){\n\tif(judge(t[i][j])=='-'){\n\t  dp[i][j]=\"-\";\n\t  continue;\n\t}\n\t\n\tdp[i][j]=strmax(dp[i-1][j],dp[i][j-1]);\n\tif(dp[i][j]!=\"-\")dp[i][j].push_back(t[i][j]);\n\telse{\n\t  \t  dp[i][j]=\"\";\n\t  dp[i][j].push_back(t[i][j]);\n\t}\n\t\n\n      }\n    }\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\t//cout<<t[i][j];\n\tmaxm=strmax(dp[i][j],maxm);\n      }\n      // cout<<endl;\n    }\n    //cout<<dp[2][0]<<endl;\n    cout<<strmax(maxm,maxm)<<endl;\n    \n  }\n  return 0;\n  \n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\n#define repb(i, a, b) for(int i = a; i >= b; i--)\n#define all(a) a.begin(), a.end()\n#define o(a) cout << a << endl\n#define int long long\nusing namespace std;\ntypedef pair<int, int> P;\n\nstring check(string s, string t){\n    if(s.size() == t.size()){\n        return (s > t ? s : t);\n    }\n    return (s.size() > t.size() ? s : t);\n}\n\nsigned main(){\n    int h, w;\n    while(1){\n        cin >> w >> h;\n        if(h == 0 && w == 0) break;\n        vector<string> s(h);\n        rep(i, 0, h) cin >> s[i];\n        string dp[71][71];\n        rep(i, 0, 70) rep(j, 0, 70) dp[i][j] = \"\";\n        rep(i, 0, h){\n            rep(j, 0, w){\n                if('0' <= s[i][j] && s[i][j] <= '9'){\n                    if(s[i][j] != '0') dp[i][j] = s[i][j];\n                    if(i != 0 && dp[i - 1][j] != \"\"){\n                        dp[i][j] = check(dp[i][j], dp[i - 1][j] + s[i][j]);\n                    // cout << i << \" \" << j << \" \" << dp[i - 1][j] + s[i][j] << \" \" << dp[i][j] << endl;\n                        \n                    }\n                    if(j != 0 && dp[i][j - 1] != \"\"){\n                        dp[i][j] = check(dp[i][j], dp[i][j - 1] + s[i][j]);\n                    // cout << i << \" \" << j << \" \" << dp[i][j - 1] + s[i][j] << \" \" << dp[i][j] << endl;                        \n                    }\n                }\n            }\n        }\n        string ans = \"\";\n        rep(i, 0, h){\n            rep(j, 0, w){\n                ans = check(ans, dp[i][j]);\n                // cout << dp[i][j];\n                // rep(k, 0, 10 - dp[i][j].size()) cout << \" \";\n            }\n            // cout << endl;\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<cstring>\nusing namespace std;\n\nstring dp[70][70];\n\nstring comp(string a,string b){\n  while(a[0]=='0')a=a.substr(1);\n  while(b[0]=='0')b=b.substr(1);\n  if(a.length()<b.length()){\n    return b;\n  }else if(a.length()>b.length()){\n    return a;\n  }else{\n    int i=0;\n    while(i<a.length() && a[i]==b[i])i++;\n    if(i==a.length())return a;\n    if(a[i]>=b[i]) return a;\n    else return b;\n  }\n}\n\nint main(){\n  int h,w;\n  while(cin>>w>>h,w){\n    char grid[h+1][w+1];\n    for(int i=1;i<=h;i++){\n      for(int j=1;j<=w;j++){\n\tcin>>grid[i][j];\n\tif(grid[i][j]<'0' || '9'<grid[i][j])\n\t  grid[i][j]='0'-1;\n      }\n    }\n    for(int i=0;i<=h;i++)\n      for(string s:dp[i])\n\ts.clear();\n    string res=\"\";\n    for(int i=1;i<=h;i++){\n      for(int j=1;j<=w;j++){\n\tif(grid[i][j]=='0'-1){\n\t  dp[i][j]=\"\";\n\t  continue;\n\t}\n\tif(j==0){\n\t  dp[i][j]=dp[i-1][j]+grid[i][j];\n\t}else{\n\t  dp[i][j]=comp(dp[i-1][j]+grid[i][j],dp[i][j-1]+grid[i][j]);\n\t}\n\tres=comp(dp[i][j],res);\n      }\n    }\n    // cout << \"dp:\" << endl;\n    // for(int i=1;i<=h;i++){\n    //   for(string a:dp[i]){\n    // \tcout << a << \" \";\n    //   }\n    //   cout << endl;\n    // }\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\nconst int dx[] = {1, 0};\nconst int dy[] = {0, 1};\n\nvector<string> board(70);\nbool visit[70][70];\nint W, H;\nint len;\nstring ans;\nint cnt;\n\ninline bool isDigit(int x, int y)\n{\n    if ('0' <= board[y][x] && board[y][x] <= '9')\n        return true;\n    else\n        return false;\n}\n\nvoid Rec(int x, int y, string s)\n{\n    s += board[y][x];\n    visit[y][x] = true;\n    bool branch = false;\n    for (int d = 0; d < 2; ++d) {\n        int nx = x + dx[d];\n        int ny = y + dy[d];\n\n        if (nx < 0 || nx >= W || ny < 0 || ny >= H || !isDigit(nx, ny))\n            continue;\n        if ((W - nx - 1) * (H - ny - 1) + s.size() + 3 < len)\n            continue;\n        branch = true;\n        Rec(nx, ny, s);\n    }\n\n    if (!branch && s.size() > len || (s.size() == len && s > ans)) {\n        ans = s;\n        len = s.size();\n    }\n}\n\nint main()\n{\n    while (cin >> W >> H, W || H) {\n        len = 0;\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                visit[i][j] = false;\n\n        for (int i = 0; i < H; ++i)\n            cin >> board[i];\n\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                if (!visit[i][j] && isDigit(j, i))\n                    Rec(j, i, \"\");\n        int index = 0;\n        while (ans[index] == '0')\n            index++;\n        cout << ans.substr(index) << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\ninline bool comp(string a, string b) {\n    if (a.size() > b.size()) return 1;\n    else if (b.size() > a.size()) return 0;\n    if (a > b) return 1;\n    else return 0;\n}\n\nint main(void){\n    int w, h;\n    while (cin>>w>>h && w) {\n        vector<string> g(h);\n        for (int i = 0; i < h; i++) {\n            cin >> g[i];\n        }\n        \n        vector<vector<string> > dp(h, vector<string>(w));\n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n                if (g[i][j] >= '0' && g[i][j] <= '9') dp[i][j] = g[i][j];\n            }\n        }\n        \n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n                if (g[i][j] < '0' || g[i][j] > '9') continue;\n                string a, b, c;\n                a = dp[i][j];\n                if (a == \"0\") continue;\n                \n                if (j+1 < w && g[i][j+1] >= '0' && g[i][j+1] <= '9') {\n                    b = a + g[i][j+1];\n                    if (comp(b,a) && comp(b, dp[i][j+1])) dp[i][j+1] = b;\n                }\n                \n                if (i+1 < h && g[i+1][j] >= '0' && g[i+1][j] <= '9') {\n                    c = a + g[i+1][j];\n                    if (comp(c,a) && comp(c, dp[i+1][j])) dp[i+1][j] = c;\n                }\n            }\n        }\n        \n        string ans;\n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n                if (comp(dp[i][j], ans)) {\n                    ans = dp[i][j];\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n#define ll long long\n#define INF (1<<30)\n#define LINF (1LL<<60)\n\n//http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#define MAXH 75\n#define MAXW 75\nvector<vector<string>> dp(MAXH, vector<string>(MAXW));\nvector<vector<int>> f(MAXH, vector<int>(MAXW));\nstring ans;\nint W, H;\n\ninline bool str_check(const string& a,const string&b) {\n\tif (a.size() > b.size()) return true;\n\telse if (a.size() < b.size()) return false;\n\telse {\n\t\tint Size = a.size();\n\t\tfor (int i = 0; i < Size;i++) {\n\t\t\tif (a[i] != b[i]) return a[i] > b[i] ? true : false;\n\t\t}\n\t}\n\treturn false;\n}\n\nvoid dfs(int h, int w, vector<vector<char>>& C) {\n\tf[h][w] = 1;\n\n\tbool dfs_f = false;\n\n\tif (f[h][w - 1] == 0 && C[h][w - 1] < 'A') {\n\t\tif (dp[h][w - 1] == \"-\") {\n\t\t\tdp[h][w - 1] = C[h][w - 1] + dp[h][w];\n\t\t\tdfs(h, w - 1, C);\n\n\t\t\tdfs_f = true;\n\t\t}\n\t\telse {\n\t\t\tif (str_check(C[h][w - 1] + dp[h][w], dp[h][w - 1])) {\n\t\t\t\tdp[h][w - 1] = C[h][w - 1] + dp[h][w];\n\t\t\t\tdfs(h, w - 1, C);\n\n\t\t\t\tdfs_f = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (f[h - 1][w] == 0 && C[h - 1][w] < 'A') {\n\t\tif (dp[h - 1][w] == \"-\") {\n\t\t\tdp[h - 1][w] = C[h - 1][w] + dp[h][w];\n\t\t\tdfs(h - 1, w, C);\n\n\t\t\tdfs_f = true;\n\t\t}\n\t\telse {\n\t\t\tif (str_check(C[h - 1][w] + dp[h][w], dp[h - 1][w])) {\n\t\t\t\tdp[h - 1][w] = C[h - 1][w] + dp[h][w];\n\t\t\t\tdfs(h - 1, w, C);\n\n\t\t\t\tdfs_f = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (!dfs_f) {\n\t\tif (str_check(dp[h][w], ans)) {\n\t\t\tans = dp[h][w];\n\t\t}\n\t}\n}\n\nint main() {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\twhile (cin >> W >> H) {\n\t\tif (W == 0 && H == 0) break;\n\t\tans = \"0\";\n\t\tfor (int i = 0; i < MAXH; i++) for (int j = 0; j < MAXW;j++) {\n\t\t\tdp[i][j] = \"-\";\n\t\t\tf[i][j] = 0;\n\t\t}\n\t\tvector<vector<char>> C(H + 2, vector<char>(W + 2, 'A'));\n\t\tfor (int i = 1; i <= H;i++) for (int j = 1; j <= W;j++) cin >> C[i][j];\n\n\t\tfor (int i = H; i > 0; i--) {\n\t\t\tfor (int j = W; j > 0;j--) {\n\t\t\t\tif (f[i][j] == 0 && C[i][j] < 'A') {\n\t\t\t\t\tdp[i][j] = C[i][j];\n\t\t\t\t\tdfs(i, j, C);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tbool zefo_flag = true;\n\t\tfor (int i = 0; i < ans.length();i++) {\n\t\t\tif (ans[i] == '0' && zefo_flag == true) continue;\n\t\t\tif (ans[i] != '0') zefo_flag = false;\n\t\t\tcout << ans[i];\n\t\t}\n\t\tcout << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "//#include \"bits/stdc++.h\"\n\n#include <iostream>\n#include <array>\n// #include <map>\n#include <string>\n// #include <algorithm>\n// #include <numeric>\n// #include <limits>\n\nusing namespace std;\n\nint w; // j\nint h; // i\nstring max_s(72, ' ');\narray<array<char, 72>, 72> field; // [i][j]\narray<char, 72> num;\nstring str(72, ' ');\n\nstring big(const string& a, const string& b) {\n\tif (a.size() == b.size()) {\n\t\tif (a > b) {\n\t\t\treturn a;\n\t\t} else {\n\t\t\treturn b;\n\t\t}\n\t}\n\tif (a.size() > b.size()) {\n\t\treturn a;\n\t} else {\n\t\treturn b;\n\t}\n}\n\nvoid check(int d) {\n\tint padding = 0;\n\tfor (int k = 0; k < d; k++) {\n\t\tif (num[k] == '0') {\n\t\t\tpadding++;\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t}\n\tint s = d - padding; // as size\n\tstr.resize(s);\n\tfor (int k = 0; k < s; k++) {\n\t\tstr[k] = num[k + padding];\n\t}\n\tmax_s = big(max_s, str);\n}\n\nvoid _trace(int i, int j, int d /* depth */) {\n\tif (i >= h or j >= w or isdigit(field[i][j]) == false) {\n\t\tcheck(d);\n\t\treturn;\n\t}\n\tnum[d] = field[i][j];\n\td++;\n\tint new_i = i + 1;\n\tint new_j = j + 1;\n\tbool flg_end = true;\n\tif (new_i < h and isdigit(field[new_i][j])) {\n\t\t_trace(new_i, j, d);\n\t\tflg_end = false;\n\t}\n\tif (new_j < w and isdigit(field[i][new_j])) {\n\t\t_trace(i, new_j, d);\n\t\tflg_end = false;\n\t}\n\tif (flg_end) {\n\t\tcheck(d);\n\t}\n}\n\nvoid trace(int i, int j) {\n\tif (i > 0 and isdigit(field[i - 1][j])) {\n\t\treturn;\n\t}\n\tif (j > 0 and isdigit(field[i][j - 1])) {\n\t\treturn;\n\t}\n\t_trace(i, j, 0);\n}\n\nvoid solve() {\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\tcin >> field[i][j];\n\t\t}\n\t}\n\tmax_s = \"\";\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\ttrace(i, j);\n\t\t}\n\t}\n\tcout << max_s << endl;\n}\n\nint main() {\n\n\twhile (true) {\n\t\tcin >> w >> h;\n\t\tif (w == 0 and h == 0) {\n\t\t\tbreak;\n\t\t}\n\t\tsolve();\n\t}\n\n\t//std::cout << \"\\e[38;5;0m\\e[48;5;40m --- end ---  \\e[m\" << std::endl; // debug\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define INF 114514810\n#define MOD 1000000007\n#define ALL(a) begin((a)),end((a))\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10  fixed<<setprecision(10)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> P;\ntypedef long long ll;\nstruct edge\n{\n\tint from, to, cost;\n\tbool operator < (const edge& e) const { return cost < e.cost; }\n\tbool operator >(const edge& e) const { return cost > e.cost; }\n};\n///*************************************************************************************///\n///*************************************************************************************///\n///*************************************************************************************///\n\nint fld[80][80];\nstring dp[80][80];\nint w, h;\n\nint main()\n{\n\twhile (cin >> w >> h, w)\n\t{\n\t\tvector<string> v;\n\t\tREP(i, h + 1)REP(j, w + 1)\n\t\t{\n\t\t\tdp[i][j] = \"\";\n\t\t\tfld[i][j] = -1;\n\t\t}\n\t\tREP(i, h)REP(j, w)\n\t\t{\n\t\t\tchar c;\n\t\t\tcin >> c;\n\t\t\tif (isalpha(c)) fld[i][j] = -1;\n\t\t\telse fld[i][j] = c - '0';\n\t\t}\n\t\tstring ans = \"0\";\n\t\tfor (int i = h; i >= 0; i--)\n\t\t{\n\t\t\tfor (int j = w; j >= 0; j--)\n\t\t\t{\n\t\t\t\tif (fld[i][j] >= 0)\n\t\t\t\t{\n\t\t\t\t\tchar c = fld[i][j] + '0';\n\t\t\t\t\tstring t1, t2;\n\t\t\t\t\tt1 = c + dp[i][j + 1]; t2 = c + dp[i + 1][j];\n\t\t\t\t\tif (t1.size() != t2.size()) dp[i][j] = (t1.size() > t2.size() ? t1 : t2);\n\t\t\t\t\telse dp[i][j] = max(t1, t2);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tREP(i, h)REP(j, w)\n\t\t{\n\t\t\tstring s = dp[i][j];\n\t\t\twhile (s[0] == '0') s.erase(0, 1);\n\t\t\tv.push_back(s);\n\t\t}\n\t\tREP(i, v.size())\n\t\t{\n\t\t\tif (v[i].size() > ans.size()) ans = v[i];\n\t\t\telse if (v[i].size() == ans.size()) ans = max(ans, v[i]);\n\t\t}\n\t\tcout << ans << endl;\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\nconst int MAX = 71;\n\nchar judge(char c){\n    if('0' <= c && c <= '9') return c;\n    return '#';\n}\n\nstring strMax(string x,string y){\n    string tx = \"\",ty = \"\";\n    bool flg = false;\n    \n    if(x == \"#\" && y == \"#\") return \"#\";\n    if(x == \"#\") return y;\n    if(y == \"#\") return x;\n    \n    for(int i = 0 ; i < x.size() ; i++){\n        if(x[i] == '0' && !flg){\n            continue;\n        }\n        else{\n            flg = true;\n            tx += x[i];\n        }\n    }\n    x = tx;\n    flg = false;\n    for(int i = 0 ; i < y.size() ; i++){\n        if(y[i] == '0' && !flg){\n            continue;\n        }\n        else{\n            flg = true;\n            ty += y[i];\n        }\n    }\n    y = ty;\n    \n    if(x.size() > y.size()) return x;\n    else if(x.size() < y.size()) return y;\n    \n    for(int i = 0 ; i < x.size() ; i++){\n        if(x[i] > y[i]) return x;\n        else if(x[i] < y[i]) return y;\n    }\n    return x;\n}\n\nint main(){\n    int H,W;\n    string str[MAX];\n    \n    while(cin >> H >> W , H + W){\n        string dp[MAX][MAX];\n        for(int i = 0 ; i < W ; i++){\n            cin >> str[i];\n        }\n        dp[0][0] = judge(str[0][0]);\n        \n        for(int i = 1 ; i < W ; i++){\n            if(judge(str[i][0]) == '#'){\n                dp[i][0] = \"#\";\n            }\n            else if(dp[i-1][0] != \"#\"){\n                dp[i][0] = dp[i-1][0];\n                dp[i][0] += judge(str[i][0]);\n            }\n            else{\n                dp[i][0] += judge(str[i][0]);\n            }\n        }\n        \n        for(int j = 1 ; j < H ; j++){\n            if(judge(str[0][j]) == '#'){\n                dp[0][j] = \"#\";\n            }\n            else if(dp[0][j-1] != \"#\"){\n                dp[0][j] = dp[0][j-1];\n                dp[0][j] += judge(str[0][j]);\n            }\n            else{\n                dp[0][j] += judge(str[0][j]);\n            }\n        }\n        \n        string ans = \"0\";\n        for(int i = 1 ; i < W ; i++){\n            for(int j = 1 ; j < H ; j++){\n                if(judge(str[i][j]) == '#') dp[i][j] = '#';\n                else{\n                    dp[i][j] = strMax(dp[i-1][j],dp[i][j-1]);\n                    if(dp[i][j] != \"#\"){\n                        dp[i][j] += judge(str[i][j]);\n                    }\n                    else{\n                        dp[i][j] = \"\";\n                        dp[i][j] += judge(str[i][j]);\n                    }\n                }\n            }\n        }\n        for(int i = 0 ; i < W ; i++)\n            for(int j = 0 ; j < H ; j++)\n                ans = strMax(ans,dp[i][j]);\n        \n        cout << ans << endl;\n    }\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n\nusing namespace std;\n\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v;}\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout << x; return sout.str();}\n\ntypedef vector<int> vi;\ntypedef vector<vi>  vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EACH(t,i,c) for(t::iretator i=(c).begin(); i!=(c).end(); ++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n) FOR(i,0,n)\n\nconst double EPS = 1e-10;\n\nint main() {\n\tint w, h;\n\n\twhile(cin >> w >> h, w) {\n\t\tvector<vector<char>> field (h+1, vector<char>(w+1));\n\t\tvector<vector<ll>> num(h+1, vector<ll>(w+1));\n\n\t\tstring str;\n\t\tREP(i, h) {\n\t\t\tcin >> str;\n\t\t\tREP(j, str.size()) {\n\t\t\t\tfield[i+1][j+1] = str[j];\n\t\t\t}\n\t\t}\n\n\t\tFOR(i, 1, h+1) {\n\t\t\tif(isdigit(field[i][1])) {\n\t\t\t\tnum[i][1] = field[i][1]-'0';\n\t\t\t}\n\t\t}\n\n\t\tFOR(j, 1, w+1) {\n\t\t\tFOR(i, 1, h+1) {\n\t\t\t\tif(isdigit(field[i][j])) {\n\t\t\t\t\tint n = field[i][j]-'0';\n\t\t\t\t\tll num1 = num[i-1][j]*10 + n;\n\t\t\t\t\tll num2 = num[i][j-1]*10 + n;\n\n\t\t\t\t\tnum[i][j] = num1>num2 ? num1: num2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tll max = 0;\n\n\t\tFOR(j, 1, w+1) {\n\t\t\tFOR(i, 1, h+1) {\n\t\t\t\tif(max < num[i][j]) {\n\t\t\t\t\tmax = num[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << max << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cctype>\n\nusing namespace std;\n\nstring maxs(string a, string b){\n    if(a.size()>b.size()) return a;\n    if(a.size()<b.size()) return b;\n    for(int i=0;i<a.size();i++){\n        if(a[i] > b[i]) return a;\n        if(a[i] < b[i]) return b;\n    }\n    return a;\n}\n\nint main(void){\n  int w,h;\n  string grid[71],dp[71][71];\n\n  while(cin >> w >> h,w|h){\n    for(int i=0;i<71;i++)\n      for(int j=0;j<71;j++)dp[i][j].clear();\n\n    for(int i=0;i<h;i++)cin >> grid[i];\n\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(!isupper(grid[i][j])){\n\t  dp[i][j]=grid[i][j];\n\t  string a=\"\",b=\"\";\n\t  if(i>0 && !dp[i-1][j].empty())a=dp[i-1][j]+grid[i][j];\n\t  if(j>0 && !dp[i][j-1].empty())b=dp[i][j-1]+grid[i][j];\n\t  \n\t  while(a[0]=='0') a.erase(a.begin());\n\t  while(b[0]=='0') b.erase(b.begin());\n\n\t  if(a.empty() && !b.empty()){\n\t    dp[i][j]=b;\n\t    continue;\n\t  }\n\n\t  if(!a.empty() && b.empty()){\n\t    dp[i][j]=a;\n\t    continue;\n\t  }\n\n\t  if(a.empty() && b.empty())continue;\n\t  if(a.size()>b.size())dp[i][j]=a;\n\t  if(a.size()<b.size())dp[i][j]=b;\n\t  else if(a>b)dp[i][j]=a;\n\t  else dp[i][j]=b;\n\t}\n      }\n    }\n\n    string s=\"\";\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\ts=maxs(s,dp[i][j]);\n\t/*\n\tif(s.size()<dp[i][j].size())s=dp[i][j];\n\telse if(s.size()>dp[i][j].size())s=s;\n\telse if(s<dp[i][j])s=dp[i][j];\n\t*/\n      }\n    }\n    cout << s << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\nclass ln{\nprivate:\n  long long d[10];\n  int len;\npublic:\n  ln(){\n  len=0;\n  for(int i=0;i<10;i++)\n    d[i]=0;\n  }\n  ln big(ln a,ln b){\n    if(a.len>b.len)\n      return a;\n    else if(a.len<b.len)\n      return b;\n    else {\n        for(int i=0;i<10;i++)\n\t  if(a.d[i]>b.d[i])\n\t    return a;\n\t  else if(a.d[i]<b.d[i])\n\t    return b;\n\treturn a;\n    }\n  }\n  void plus(int b){\n    int tmp=len/10;\n    d[tmp]*=10;\n    d[tmp]+=(b-'0');\n  }  \n  void print(){\n    for(int i=0;i<(len-1)/10+1;i++)\n      cout<<d[i];\n    cout<<endl;\n  }\n};\nint main(){\n  int w,h;\n  char input[75][75];\n \n  //\n  while(1){\n  \n    cin>>w>>h;\n    ln out[75][75];\n    ln maxval;\n    if(w==0&&h==0) return 0;\n    for(int i=0;i<w+1;i++)\n      input[0][i]=0;\n    for(int i=1;i<h+1;i++){\n      input[i][0]=0;\n      cin>>(char*)(input[i]+1);\n    }\n    // for(int i=0;i<h+1;i++)\n    //   cout<<input[i]+1<<endl;\n    for(int i=1;i<=w+h;i++)\n      for(int j=1;j<i;j++)\n\tif(input[j][i-j]>='0'&&input[j][i-j]<='9') \n\t  {\n\t    if(j>h||i-j>w) continue;\n\t    out[j][i-j]=out[0][0].big(out[j-1][i-j],out[j][i-j-1]);\n\t    out[j][i-j].plus(input[j][i-j]);    \n\t    // out[j][i-j].print();\n\t    maxval=out[0][0].big(out[j][i-j],maxval);\n\t  }\n    maxval.print();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <iostream>\n#include <map>\n#include <cmath>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <stdlib.h>\n#include <stdio.h>\n#include <bitset>\n#include <cstring>\nusing namespace std;\n#define FOR(I,A,B) for(int I = (A); I < (B); ++I)\n#define CLR(mat) memset(mat, 0, sizeof(mat))\ntypedef long long ll;\nint W, H;\nvector<string> vs(70);\nmap<int, string> MAP;\nbool checked[70][70]; \nstring calc(string a, string b) {\n  if(a.length() > b.length()) return a;\n  if(a.length() < b.length()) return b;\n  else return a > b ? a : b;\n}\nstring dfs(int h, int w) {\n  checked[h][w] = true;\n  if(h < 0 || h >= H || w < 0 || w >= W || !isdigit(vs[h][w])) {\n    return \"\";\n  }\n  if(MAP.count(h*100+w)) return MAP[h*100+w];\n  string a = vs[h][w] + dfs(h+1,w);\n  string b = vs[h][w] + dfs(h,w+1);\n  MAP[100*h+w] = calc(MAP[100*h+w], calc(a, b));\n  return MAP[100*h+w];\n}\nint main()\n{\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  while(cin>>W>>H,W||H) {\n    FOR(i,0,H) cin >> vs[i];\n    string ans = \"\";\n    CLR(checked);\n    MAP.clear();\n    FOR(h,0,H) {\n      FOR(w,0,W) {\n        if(checked[h][w]) continue;\n        checked[h][w] = true;\n        ans = calc(ans, dfs(h, w));\n      } \n    }\n    while(ans[0] == '0') ans.erase(ans.begin());\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#define F first\n#define S second\nusing namespace std;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() == 0 && b.size() == 0)\n    return true;\n  else if(a.size() == 0)\n    return true;\n  else if(b.size() == 0)\n    return false;\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] < b[i];\n  return false;\n}\n\nint main()\n{\n\n  int w,h;\n  while(cin >> w >> h,(w || h))\n    {\n      \n      char G[h][w];\n      string ans=\"0\";\n      string dp[h][w];\n\n      for(int i=0;i<h;i++)\n\t{\n\tfor(int j=0;j<w;j++)\n\t  {\n\t    cin >> G[i][j];\n\t    if('0' <= G[i][j] && G[i][j] <= '9')\n\t      {\n\t\tdp[i][j] = G[i][j];\n\t\tans = max(ans,dp[i][j],cmp);\n\t      }\n\t\n\t  }\n\n\t}\n     \n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\n\t      if(!('0' <= G[i][j] && G[i][j] <= '9'))\n\t\tcontinue;\n\t      \n\t      dp[i][j] = max(dp[i][j],max((i-1>=0?dp[i-1][j]:\"\")+dp[i][j],\n\t\t\t\t\t  (j-1>=0?dp[i][j-1]:\"\")+dp[i][j],cmp),cmp);\t      \n\t      ans = max(ans,dp[i][j],cmp);\n\n\t    }\n\t}\n\n\n      bool f = false;\n      int cnt = 0;\n      for(int i=0;i<ans.size();i++)      \n\tif(ans[i] == '0' && !f)\n\t  continue;\n\telse  \n\t  {\n\t    cnt++;\n\t    f = true;\n\t    cout << ans[i];\n\t  }\n      if(cnt == 0)\n\tcout << \"0\";\n\tcout << endl;\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n  int h, w;\n  while(cin >> w >> h, w || h) {\n    vector<vector<char> > field(h + 2, vector<char>(w + 2, 'x'));\n    for(int y = 0; y < h; ++y) for(int x = 0; x < w; ++x) {\n      char c;\n      cin >> c;\n      field[y + 1][x + 1] = ((0 <= c - '0' && c - '0' <= 9) ? c : 'x');\n    }\n    // for(int y = 0; y < h + 2; ++y, cout << endl) for(int x = 0; x < w + 2; ++x) cout << field[y][x];\n    vector<string> codes;\n    set<pair<int, int> > looked;\n    bool recursionEnd = false;\n    function<void(string, int, int)> putupCodes = [&](string num, int y, int x) {\n      looked.insert(make_pair(y, x));\n      num += field[y + 1][x + 1];\n      if(!recursionEnd && field[y + 2][x + 1] != 'x') putupCodes(num, y + 1, x);\n      if(!recursionEnd && field[y + 1][x + 2] != 'x') putupCodes(num, y, x + 1);\n      if(!recursionEnd && field[y + 2][x + 1] == 'x' && field[y + 1][x + 2] == 'x') {\n        codes.push_back(num);\n        if(num.size() == h + w - 1) recursionEnd = true;\n      }\n    };\n    for(int y = 0; y < h; ++y) for(int x = 0; x < w; ++x) {\n      if(field[y + 1][x + 1] != 'x' && field[y + 1][x + 1] != '0' && looked.count(make_pair(y, x)) == 0) putupCodes(\"\", y, x);\n    }\n    auto fillzero = [&](string str) {\n      stringstream ss;\n      ss << setw(h + w) << setfill('0') << str;\n      return ss.str();\n    };\n    // for(auto&& code : codes) cout << code << endl;\n    sort(begin(codes), end(codes), [&](const string &left, const string &right) {\n      return fillzero(left) > fillzero(right);\n    });\n    cout << codes[0] << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<ctime>\n#include<cctype>\n#include<climits>\n#include<iostream>\n#include<iomanip>\n#include<string>\n#include<vector>\n#include<map>\n#include<list>\n#include<queue>\n#include<deque>\n#include<algorithm>\n#include<numeric>\n#include<utility>\n#include<complex>\n#include<memory>\n#include<functional>\n\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<ll> VL;\ntypedef vector<VL> VVL;\ntypedef pair<int, int> PII;\n\n#define FOR(i, a, n) for (ll i = (ll)a; i < (ll)n; ++i)\n#define REP(i, n) FOR(i, 0, n)\n#define ALL(x) x.begin(), x.end()\n#define MP make_pair\n#define PB push_back\n#define MOD 1000000007\n#define INF (1LL<<30)\n#define LLINF (1LL<<60)\n#define PI 3.14159265359\n#define EPS 1e-12\n//#define int ll\n\nstring s[100], dp[100][100];\nsigned main(void)\n{\n\twhile(true) {\n\t\tint w, h;\n\t\tcin >> w >> h;\n\t\tif(!w && !h) break;\n\t\tREP(i, h) cin >> s[i];\n\n\t\tREP(i, h) REP(j, w) {\n\t\t\tif(i == 0 && j == 0) {\n\t\t\t\tif('1' <= s[i][j] && s[i][j] <= '9') dp[i][j] = s[i][j];\n\t\t\t\telse dp[i][j] = \"0\";\n\t\t\t} else if(i == 0) {\n\t\t\t\tif('0' <= s[i][j] && s[i][j] <= '9') {\n\t\t\t\t\tdp[i][j] = dp[i][j-1] + s[i][j];\n\t\t\t\t} else {\n\t\t\t\t\tdp[i][j] = \"0\";\n\t\t\t\t}\n\t\t\t} else if(j == 0) {\n\t\t\t\tif('0' <= s[i][j] && s[i][j] <= '9') {\n\t\t\t\t\tdp[i][j] = dp[i-1][j] + s[i][j];\n\t\t\t\t} else {\n\t\t\t\t\tdp[i][j] = \"0\";\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif('0' <= s[i][j] && s[i][j] <= '9') {\n\t\t\t\t\tbool flag = false;\n\t\t\t\t\tif(dp[i-1][j].size() > dp[i][j-1].size()) flag = true;\n\t\t\t\t\tif(dp[i-1][j].size() == dp[i][j-1].size()) {\n\t\t\t\t\t\tREP(k, dp[i-1][j].size()) {\n\t\t\t\t\t\t\tif(dp[i-1][j][k] > dp[i][j-1][k]) {flag = true; break;}\n\t\t\t\t\t\t\telse if(dp[i-1][j][k] < dp[i][j-1][k]) {flag = false; break;}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(flag) {\n\t\t\t\t\t\tdp[i][j] = dp[i-1][j] + s[i][j];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i][j] = dp[i][j-1] + s[i][j];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tdp[i][j] = \"0\";\n\t\t\t\t}\n\t\t\t}\n\t\t\t//dp[i][j]???leading-zero????¶????\n\t\t\tint idx = 0;\n\t\t\tREP(k, dp[i][j].size()) {\n\t\t\t\tif(dp[i][j][k] != '0') {idx = k; break;}\n\t\t\t}\n\t\t\tif(idx == 0 && dp[i][j][0] == '0') dp[i][j] = \"0\";\n\t\t\tstring tmp = \"\";\n\t\t\tFOR(k, idx, dp[i][j].size()) {\n\t\t\t\ttmp += dp[i][j][k];\n\t\t\t}\n\t\t\tdp[i][j] = tmp;\n\t\t}\n\n\t\t/*REP(i, h) {\n\t\t\tREP(j, w) {\n\t\t\t\tcout << dp[i][j] << \" \";\n\t\t\t}\n\t\t\tcout << endl;\n\t\t}*/\n\n\t\tstring ret = \"0\";\n\t\tREP(i, h) REP(j, w) {\n\t\t\tbool flag = false;\n\t\t\tif(dp[i][j].size() > ret.size()) flag = true;\n\t\t\tif(dp[i][j].size() == ret.size()) {\n\t\t\t\tREP(k, dp[i][j].size()) {\n\t\t\t\t\tif(dp[i][j][k] > ret[k]) {flag = true; break;}\n\t\t\t\t\telse if(dp[i][j][k] < ret[k]) {flag = false; break;}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(flag) ret = dp[i][j];\n\t\t}\n\t\tcout << ret << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n#define ll long long\n#define INF (1<<30)\n#define LINF (1LL<<60)\n\n//http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#define MAXH 75\n#define MAXW 75\nvector<vector<string>> dp(MAXH, vector<string>(MAXW));\nvector<vector<int>> f(MAXH, vector<int>(MAXW));\nstring ans;\nint W, H;\n\ninline bool str_check(const string& a,const string&b) {\n\tif (a.size() > b.size()) return true;\n\telse if (a.size() < b.size()) return false;\n\telse {\n\t\tint Size = a.size();\n\t\tfor (int i = 0; i < Size;i++) {\n\t\t\tif (a[i] != b[i]) return a[i] > b[i] ? true : false;\n\t\t}\n\t}\n\treturn false;\n}\n\nvoid dfs(int h, int w, vector<vector<char>>& C) {\n\tf[h][w] = 1;\n\n\tbool dfs_f = false;\n\n\tif (f[h][w - 1] == 0 && C[h][w - 1] < 'A') {\n\t\tif (dp[h][w - 1] == \"-\") {\n\t\t\tdp[h][w - 1] = C[h][w - 1] + dp[h][w];\n\t\t\tdfs(h, w - 1, C);\n\n\t\t\tdfs_f = true;\n\t\t}\n\t\telse {\n\t\t\tif (str_check(C[h][w - 1] + dp[h][w], dp[h][w - 1])) {\n\t\t\t\tdp[h][w - 1] = C[h][w - 1] + dp[h][w];\n\t\t\t\tdfs(h, w - 1, C);\n\n\t\t\t\tdfs_f = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (f[h - 1][w] == 0 && C[h - 1][w] < 'A') {\n\t\tif (dp[h - 1][w] == \"-\") {\n\t\t\tdp[h - 1][w] = C[h - 1][w] + dp[h][w];\n\t\t\tdfs(h - 1, w, C);\n\n\t\t\tdfs_f = true;\n\t\t}\n\t\telse {\n\t\t\tif (str_check(C[h - 1][w] + dp[h][w], dp[h - 1][w])) {\n\t\t\t\tdp[h - 1][w] = C[h - 1][w] + dp[h][w];\n\t\t\t\tdfs(h - 1, w, C);\n\n\t\t\t\tdfs_f = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (!dfs_f) {\n\t\tif (str_check(dp[h][w], ans)) {\n\t\t\tans = dp[h][w];\n\t\t}\n\t}\n}\n\nint main() {\n\tcin.tie(0); ios::sync_with_stdio(false);\n\twhile (cin >> W >> H) {\n\t\tif (W == 0 && H == 0) break;\n\t\tans = \"0\";\n\t\tfor (int i = 0; i < MAXH; i++) for (int j = 0; j < MAXW;j++) {\n\t\t\tdp[i][j] = \"-\";\n\t\t\tf[i][j] = 0;\n\t\t}\n\t\tvector<vector<char>> C(H + 2, vector<char>(W + 2, 'A'));\n\t\tfor (int i = 1; i <= H;i++) for (int j = 1; j <= W;j++) cin >> C[i][j];\n\n\t\tfor (int i = H; i > 0; i--) {\n\t\t\tfor (int j = W; j > 0;j--) {\n\t\t\t\tif (f[i][j] == 0 && C[i][j] < 'A') {\n\t\t\t\t\tdp[i][j] = C[i][j];\n\t\t\t\t\tdfs(i, j, C);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tbool zefo_flag = true;\n\t\tfor (int i = 0; i < ans.length();i++) {\n\t\t\tif (ans[i] == '0' && zefo_flag == true) continue;\n\t\t\tif (ans[i] != '0') zefo_flag = false;\n\t\t\tcout << ans[i];\n\t\t}\n\t\tcout << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include <sys/timeb.h>\n#include <fstream>\n\nusing namespace std;\n\n#define repl(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define replrev(i,a,b) for(int i=(int)(b)-1;i>=(int)(a);i--)\n#define reprev(i,n) replrev(i,0,n)\n#define repi(itr,ds) for(auto itr=ds.begin();itr!=ds.end();itr++)\n#define all(a) a.begin(),a.end()\n#define mp make_pair\n#define mt make_tuple\n#define INF 2000000000\n#define INFL 1000000000000000000LL\n#define EPS 1e-9\n#define MOD 1000000007\n#define PI 3.1415926536\n#define RMAX 4294967295\n\ntypedef long long ll;\ntypedef pair<int, int> P;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<bool> vb;\ntypedef vector<char> vc;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<P> vP;\ntypedef vector<vector<int> > vvi;\ntypedef vector<vector<bool> > vvb;\ntypedef vector<vector<ll> > vvll;\ntypedef vector<vector<char> > vvc;\ntypedef vector<vector<double> > vvd;\ntypedef vector<vector<P> > vvP;\ntypedef priority_queue<int, vector<int>, greater<int> > pqli;\ntypedef priority_queue<ll, vector<ll>, greater<ll> > pqlll;\ntypedef priority_queue<P, vector<P>, greater<P> > pqlP;\ntypedef pair<int, pair<int, int> > Edge;\ntypedef vector<Edge> vE;\ntypedef priority_queue<Edge, vector<Edge>, greater<Edge> > pqlE;\n\nbool isNum(char c) {\n\treturn (c >= '0' && c <= '9');\n}\nbool isPlusNum(char c) {\n\treturn (c >= '1' && c <= '9');\n}\n\nint main() {\n\twhile (true) {\n\t\tvector<pair<int, string> > nums;\n\t\tint W, H;\n\t\tcin >> W >> H;\n\t\tif (W == 0 && H == 0)break;\n\t\tvs f(H);\n\t\trep(i, H) {\n\t\t\tcin >> f[i];\n\t\t}\n\t\tstack<tuple<int,int,vc> >st;\n\t\trep(i, H) {\n\t\t\trep(j, W) {\n\t\t\t\tif (isPlusNum(f[i][j]) && (i == 0 || !isPlusNum(f[i - 1][j])) && (j == 0 || !isPlusNum(f[i][j - 1]))) {\n\t\t\t\t\tst.push(mt(i, j, vc(1, f[i][j])));\n\t\t\t\t\tcout << f[i][j] << endl;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\twhile (!st.empty()) {\n\t\t\tint y = get<0>(st.top());\n\t\t\tint x = get<1>(st.top());\n\t\t\tvc s = get<2>(st.top());\n\t\t\tst.pop();\n\t\t\tif (y != H - 1 && isNum(f[y + 1][x])) {\n\t\t\t\ts.push_back(f[y + 1][x]);\n\t\t\t\tst.push(mt(y + 1, x, s));\n\t\t\t\ts.resize(s.size() - 1);\n\t\t\t}\n\t\t\tif (x != W - 1 && isNum(f[y][x + 1])) {\n\t\t\t\ts.push_back(f[y][x + 1]);\n\t\t\t\tst.push(mt(y, x + 1, s));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnums.push_back(mp((int)s.size(), string(all(s))));\n\t\t\t}\n\t\t}\n\n\t\tsort(all(nums));\n\t\tif (nums.size() == 0) {\n\t\t\tcout << 0 << endl;\n\t\t}\n\t\telse {\n\t\t\tcout << nums[nums.size() - 1].second << endl;\n\t\t}\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cstdlib>\n#include<typeinfo>\n#include<set>\n#include<map>\n#include<vector>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<numeric>\n#include<cassert>\n#include<random>\nusing namespace std;\n\nbool num(char c){\n    if(c<'0' || c>'9'){return false;}\n    return true;\n}\n\nstring max(string a,string b){\n    if(a.size()>b.size()){return a;}\n    if(b.size()>a.size()){return b;}\n    int as=(int)a.size();\n    int bs=(int)b.size();\n    for(int i=0;a[i]=='0';i++){as--;}\n    for(int i=0;b[i]=='0';i++){bs--;}\n    if(as>bs){return a;}\n    if(bs>as){return b;}\n    for(int i=0;i<as;i++){\n        if(a[a.size()-as+i]>b[b.size()-bs+i]){return a;}\n        if(a[a.size()-as+i]<b[b.size()-bs+i]){return b;}\n    }\n    return a;\n}\n\nstring pls(char c,string s){\n    s.push_back(1);\n    //cout<<\"size : \"<<s<<endl;\n    for(int i=(int)s.size()-2;i>=0;i--){\n        //cout<<\"e\"<<endl;\n        s[i+1]=s[i];\n    }\n    s[0]=c;\n    //cout<<s<<endl;\n    return s;\n}\n\nint main(){\n    while(1){\n        \n        \n        \n    \n    char a[100][100]={};\n    int w,h;\n    cin>>w>>h;\n        if(w==0 && h==0){break;}\n    for(int i=0;i<h;i++){\n        for(int t=0;t<w;t++){\n            cin>>a[i][t];\n        }\n    }\n    string dp[100][100]={};\n    string ans;\n    for(int i=h-1;i>=0;i--){\n        for(int t=w-1;t>=0;t--){\n            if(num(a[i][t])){\n                dp[i][t]=pls(a[i][t],max(dp[i+1][t],dp[i][t+1]));\n                ans=max(ans,dp[i][t]);\n            }\n        }\n    }\n        bool d=true;\n        for(int i=0;i<ans.size();i++){\n            if(d && ans[i]!='0'){cout<<ans[i]; d=false; continue;}\n            if(!d){cout<<ans[i];}\n        }\n        cout<<endl;\n    \n        \n        \n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <cstring>\n#include <string>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <map>\n#include <set>\n#include <bitset>\n#include <numeric>\n#include <utility>\n#include <iomanip>\n#include <algorithm>\n#include <functional>\nusing namespace std;\n\ntypedef long long ll;\ntypedef vector<int> vint;\ntypedef vector<ll> vll;\ntypedef pair<int,int> pint;\n\n#define DE 1\n#define FI first\n#define SE second\n#define PB push_back\n#define MP make_pair\n#define ALL(s) (s).begin(),(s).end()\n#define REP(i,n) for (int i = 0; i < (int)(n); ++i)\n#define EACH(i,s) for (__typeof__((s).begin()) i = (s).begin(); i != (s).end(); ++i)\n#define COUT(x) cout<<#x<<\" = \"<<(x)<<\" (L\"<<__LINE__<<\")\"<<endl\n\ntemplate<class T1, class T2> ostream& operator<<(ostream &s, pair<T1,T2> P){return s<<'<'<<P.first<<\", \"<<P.second<<'>';}\ntemplate<class T> ostream& operator<<(ostream &s, vector<T> P) {s<<\"{ \";for(int i=0;i<P.size();++i){if(i>0)s<<\", \";s<<P[i];}return s<<\" }\"<<endl;}\ntemplate<class T1, class T2> ostream& operator<<(ostream &s, map<T1,T2> P) {s<<\"{ \";for(__typeof__(P.begin()) it=P.begin();it!=P.end();++it){if(it!=P.begin())s<<\", \";s<<'<'<<it->first<<\"->\"<<it->second<<'>';}return s<<\" }\"<<endl;}\ntemplate <class T> void chmax(T& a, const T& b) { a = max(a, b); }\ntemplate <class T> void chmin(T& a, const T& b) { a = min(a, b); }\n\n\n\nconst int MAX = 72;\n\nint dx[2] = {1, 0};\nint dy[2] = {0, 1};\n\n\nint W, H;\nchar field[MAX][MAX];\nstring dp[MAX][MAX];\nbool seen[MAX][MAX];\n\n\nbool leftbig(string s, string t) {\n    if (s.size() > t.size()) return true;\n    else if (s.size() < t.size()) return false;\n    else return (s > t);\n}\n\nstring rec(int x, int y) {\n    if (seen[x][y]) return dp[x][y];\n    \n    string pref; pref += field[x][y];\n    \n    string Max = pref;\n    for (int i = 0; i < 2; ++i) {\n        int nx = x + dx[i], ny = y + dy[i];\n        if (nx < 0 || nx >= H || ny < 0 || ny >= W) continue;\n        if (field[nx][ny] >= 'A' && field[nx][ny] <= 'Z') continue;\n        \n        string temp = pref + rec(nx, ny);\n        if (leftbig(temp, Max)) Max = temp;\n    }\n        \n    //cout << x << \", \" << y << \" : \" << Max << endl;\n    \n    seen[x][y] = true;\n    return dp[x][y] = Max;\n}\n\nint main() {\n    while (cin >> W >> H) {\n        if (W == 0) break;\n        \n        memset(seen, 0, sizeof(seen));\n        for (int i = 0; i < H; ++i) {\n            for (int j = 0; j < W; ++j) {\n                cin >> field[i][j];\n            }\n        }\n        \n        string Max = \"\";\n        for (int i = 0; i < H; ++i) {\n            for (int j = 0; j < W; ++j) {\n                if (field[i][j] >= 'A' && field[i][j] <= 'Z') continue;\n            \n                string temp = rec(i, j);\n                while (temp[0] == '0' && temp != \"0\") temp.erase(temp.begin());\n                if (leftbig(temp, Max)) Max = temp;\n            }\n        }\n        \n        cout << Max << endl;\n    }\n    \n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\nusing namespace std;\nint W,H;\nchar c[71][71];\nstring s[71][71];\nstring t = \".\";\n\nbool operation(string l,string r){\n\tif(l.size() != r.size()){\n\t\treturn l.size() < r.size();\n\t}\n\telse{\n\t\treturn l < r;\n\t}\n}\n\nstring solve(int i,int j){\n\tstring s1,s2;\n\ts1 = s2 = c[i][j];\n\tif(s[i][j] != t)return s[i][j];\n\tif(c[i][j+1] >= '0' && c[i][j+1] <= '9' && j+1 < W){\n\t\tif(s[i][j+1] != t) s1 += s[i][j+1];\n\t\telse s1 += solve(i,j+1);\n\t}\n\tif(c[i+1][j] >= '0' && c[i+1][j] <= '9' && i+1 < H){\n\t\tif(s[i+1][j] != t) s2 += s[i+1][j];\n\t\telse s2 += solve(i+1,j);\n\t}\n\n\ts[i][j] = max(s1,s2,operation);\n\treturn s[i][j];\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> W >> H;\n\t\tint x,y;\n\t\tstring st,res;\n\t\tif(W == 0)break;\n\t\tres = \"\";\n\t\tfor(int i = 0;i < 71;i++){\n\t\t\tfor(int j = 0;j <= 71;j++){\n\t\t\t\ts[i][j] = '.';\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tif(c[i][j] >= '1' && c[i][j] <= '9'){\n\t\t\t\t\tsolve(i,j);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tif(s[i][j] == t)continue;\n\t\t\t\tres = max(res,s[i][j],operation);\n\t\t\t}\n\t\t}\t\t\n\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstring remover(string s){\n\tstring ret;\n\tint i;\n\tfor(i=0;i<s.size() && s[i] == '0';i++);\n\tfor(;i<s.size();i++){\n\t\tret += s[i];\n\t}\n\treturn ret;\n}\n\nbool comp(string s1, string s2){\n\tif(s1.size() > s2.size()) return true;\n\tif(s1.size() < s2.size()) return false;\n\tfor(int i=0;i<s1.size();i++){\n\t\tif(int(s1[i] - '0') > int(s2[i] - '0')) return true;\n\t\tif(int(s1[i] - '0') < int(s2[i] - '0')) return false;\n\t}\n\treturn false;\n}\n\nint main(){\n\tint w,h;\n\twhile(cin >> w >> h,w > 0 && h > 0){\n\t\tvector<string> c(h);\n\t\tfor(int i=0;i<h;i++){\n\t\t\tcin >> c[i];\n\t\t}\n\t\tstring ans = \"\";\n\t\tstring num[70][70];\n\t\tfor(int i=h-1;i>=0;i--){\n\t\t\tfor(int j=w-1;j>=0;j--){\n\t\t\t\tif(c[i][j] < '0' || c[i][j] > '9') continue;\n\t\t\t\tif(j!=w-1 && i!=h-1){\n\t\t\t\t\tif(comp(num[i][j+1],num[i+1][j])){\n\t\t\t\t\t\tnum[i][j] = c[i][j] + num[i][j+1];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnum[i][j] = c[i][j] + num[i+1][j];\n\t\t\t\t\t}\n\t\t\t\t} else if(j!=w-1){\n\t\t\t\t\tnum[i][j] = c[i][j] + num[i][j+1];\n\t\t\t\t} else if(i!=h-1){\n\t\t\t\t\tnum[i][j] = c[i][j] + num[i+1][j];\n\t\t\t\t} else {\n\t\t\t\t\tnum[i][j] = c[i][j];\n\t\t\t\t}\n\t\t\t\tif(comp(remover(num[i][j]),ans)){\n\t\t\t\t\tans = remover(num[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << remover(ans) << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <utility>\n#include <cctype>\n#include <vector>\n#include <string>\nusing namespace std;\n\n#ifdef __linux\n#define _U(s) s##_unlocked\n#else\n#define _U(s) _##s##_nolock\n#define _CRT_DISABLE_PERFCRIT_LOCKS\n#endif\n#define gcu _U(getchar)\n#define pcu _U(putchar)\n#define _DEF(r, n, ...) inline r n(__VA_ARGS__) noexcept\n#define _T template <typename T>\n#define _HT template <typename H,typename... T>\n#define _OP(t) inline operator t()\nstruct _in {\n#ifdef _GLIBCXX_STRING\n\t_OP(string){string s;char c;while(isspace(c = gcu()));do{s+=c;}while(c=gcu(),c!=' '&&c!='\\n'&&c!=EOF);return s;}\n#define _S\n#endif\n\t_OP(char){char c=gcu();gcu();return c;}\n\t_OP(double){double d; scanf(\"%lf\",&d); gcu();return d;}\n\t_T _OP(T){T n{},m{1},c;while(isspace(c = gcu()));if(c=='-')m=-1,c=gcu();do{n=10*n+(c-'0'),c=gcu();}while(c>='0'&&c<='9');return m*n;}\n} in;\n#define _SCAN(...) _DEF(bool,scan,__VA_ARGS__)\n#ifdef _S\n_SCAN(string &o) {int c{gcu()};if(c==EOF)return false;else{ungetc(c,stdin);string t=move(in);o=t;return true;}}\n#endif\n_T _SCAN(T &o) {int c{gcu()};return c==EOF?false:(ungetc(c,stdin),o=in,true);}\n_HT _SCAN(H &h,T&&... t){return scan(h)&&scan(t...);}\n#define _OUT(...) _DEF(void,out,__VA_ARGS__)\n#define _OUTL(...) _DEF(void,outl,__VA_ARGS__)\n_OUT(bool b){pcu('0'+b);}\n_OUT(const char *s){while(*s)pcu(*s++);}\n_OUT(char c){pcu(c);}\n#ifdef _S\n_OUT(string &s){for(char c:s)pcu(c);}\n#endif\n_T _OUT(T n){static char b[20];char *p=b;T m=n<0?pcu('-'),-1:1;\n\tif(!n)*p++='0';else while(n)*p++=(char)(n%10*m+'0'),n/=10;while(p!=b)pcu(*--p);}\n_OUTL(){out('\\n');}\n#ifdef _GLIBCXX_VECTOR\n\t_T _OUT(vector<T> &v){for(T &x:v)out(&x == &v[0]?\"\":\" \"),out(x);}\n#endif\n_HT _OUT(H &&h, T... t){out(h);out(t...);}\ntemplate <typename... T> _OUTL(T... t){out(t...);outl();}\nstruct range{\n\tint e,b=0,s=1;range(int _b,int _e,int _s):e(_e),b(_b),s(_s){} range(int _b,int _e): e(_e), b(_b){} range(int _e):e(_e){}\n\tstruct it{int v,s; it(int _v,int _s):v(_v),s(_s){} operator int()const{return v;} operator int&(){return v;}int operator*()const{return v;}\n\t\tit& operator++(){v+=s;return *this;} }; it begin(){return {b,s};} it end(){return {e,s};}};\n#define times(i,n) for(int i=n;i;i--)\n\ntemplate <typename T>\nusing V = vector<T>;\n\nstring cmp(string &a, string &b) {\n\treturn a.size() == b.size() ? max(a, b) : a.size() > b.size() ? a : b;\n}\n\nint main() {\n\tfor (int W, H; W = in, H = in;) {\n\t\tV<V<char>> C(H + 1, V<char>(W + 1));\n\t\tfor (int i: range(H)) {\n\t\t\tfor (int j: range(W))\n\t\t\t\tC[i][j] = gcu();\n\t\t\tgcu();\n\t\t}\n\t\tV<V<string>> d(H + 1, V<string>(W + 1));\n\t\tstring r;\n\t\tfor (int i: range(H - 1, -1, -1))\n\t\t\tfor (int j: range(W - 1, -1, -1))\n\t\t\t\tif (isdigit(C[i][j])) {\n\t\t\t\t\tstring &t {d[i][j]};\n\t\t\t\t\tt = C[i][j] + cmp(d[i + 1][j], d[i][j + 1]);\n\t\t\t\t\tif (t.size() && t[0] != '0')\n\t\t\t\t\t\tr = cmp(r, t);\n\t\t\t\t}\n\t\toutl(r);\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "// clang-format off\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define main signed main()\n#define loop(i, a, n) for (int i = (a); i < (n); i++)\n#define rep(i, n) loop(i, 0, n)\n#define all(v) (v).begin(), (v).end()\n#define rall(v) (v).rbegin(), (v).rend()\n#define prec(n) fixed << setprecision(n)\nconstexpr int INF = sizeof(int) == sizeof(long long) ? 1000000000000000000LL : 1000000000;\nconstexpr int MOD = 1000000007;\nconstexpr double PI = 3.14159265358979;\ntemplate<typename A, typename B> bool cmin(A &a, const B &b) { return a > b ? (a = b, true) : false; }\ntemplate<typename A, typename B> bool cmax(A &a, const B &b) { return a < b ? (a = b, true) : false; }\nbool odd(const int &n) { return n & 1; }\nbool even(const int &n) { return ~n & 1; }\ntemplate<typename T = int> T in() { T x; cin >> x; return x; }\ntemplate<typename T = int> T in(T &&x) { T z(forward<T>(x)); cin >> z; return z; }\ntemplate<typename T> istream &operator>>(istream &is, vector<T> &v) { for (T &x : v) is >> x; return is; }\ntemplate<typename A, typename B> istream &operator>>(istream &is, pair<A, B> &p) { return is >> p.first >> p.second; }\ntemplate<typename T> ostream &operator<<(ostream &os, const vector<vector<T>> &v) { int n = v.size(); rep(i, n) os << v[i] << (i == n - 1 ? \"\" : \"\\n\"); return os; }\ntemplate<typename T> ostream &operator<<(ostream &os, const vector<T> &v) { int n = v.size(); rep(i, n) os << v[i] << (i == n - 1 ? \"\" : \" \"); return os; }\ntemplate<typename A, typename B> ostream &operator<<(ostream &os, const pair<A, B> &p) { return os << p.first << ' ' << p.second; }\ntemplate<typename Head, typename Value> auto vectors(const Head &head, const Value &v) { return vector<Value>(head, v); }\ntemplate<typename Head, typename... Tail> auto vectors(Head x, Tail... tail) { auto inner = vectors(tail...); return vector<decltype(inner)>(x, inner); }\n// clang-format on\n\nstring maxStr(string a, string b) {\n  a = string(find_if(all(a), [&](char c) { return c != '0'; }), a.end());\n  b = string(find_if(all(b), [&](char c) { return c != '0'; }), b.end());\n  if (a.size() > b.size()) return a;\n  if (a.size() < b.size()) return b;\n  return max(a, b);\n}\nmain {\n  while (true) {\n    int w, h;\n    cin >> w >> h;\n    if (w == 0 && h == 0) break;\n    vector<string> c(h);\n    cin >> c;\n    auto dp = vectors(h, w, string());\n    rep(i, h) rep(j, w) dp[i][j] = string(1, c[i][j]);\n    string ans;\n    rep(i, h) rep(j, w) {\n      if (not isdigit(c[i][j])) continue;\n      ans = maxStr(ans, dp[i][j]);\n      if (i + 1 < h && isdigit(c[i + 1][j])) {\n        dp[i + 1][j] = maxStr(dp[i + 1][j], dp[i][j] + string(1, c[i + 1][j]));\n        ans = maxStr(ans, dp[i + 1][j]);\n      }\n      ans = maxStr(ans, dp[i][j]);\n      if (j + 1 < w && isdigit(c[i][j + 1])) {\n        dp[i][j + 1] = maxStr(dp[i][j + 1], dp[i][j] + string(1, c[i][j + 1]));\n        ans = maxStr(ans, dp[i][j + 1]);\n      }\n    }\n    cout << ans << endl;\n  }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <sstream>\n#include <cassert>\n#include <list>\nusing namespace std;\nstatic const double EPS = 1e-10;\ntypedef long long ll;\ntypedef pair<int,int> PI;\ntypedef vector<int> vi;\n#ifndef M_PI\n#define M_PI 3.14159265358979323846\n#endif\n#define rep(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define F first\n#define S second\n\n\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\n\ntypedef struct _mulnum{\n  string number;\n  bool operator<(const _mulnum&r)const{\n    if(number.size()!=r.number.size())return number.size()<r.number.size();\n\n    rep(i,number.size()){\n      if(number[i]!=r.number[i])return number[i]<r.number[i];\n    }\n    return 0;\n  };\n  _mulnum operator+(const char&r){\n    _mulnum ret=*this;\n    ret.number+=r;\n    return ret;\n  }\n}mulnum;\n\n\nmain(){\n  int w,h;\n  while(cin>>w>>h,w|h){\n    char in[h][w+2];\n    rep(i,h)cin>>in[i];\n    mulnum dp[h][w];\n\n    mulnum ans;\n\n    rep(i,h){\n      rep(j,w){\n\tif(isdigit(in[i][j])){\n\t  if(i){\n\t    dp[i][j]=max(dp[i-1][j]+in[i][j],dp[i][j]);\n\t    ans=max(ans,dp[i][j]);\n\t  }\n\t  if(j){\n\t    dp[i][j]=max(dp[i][j-1]+in[i][j],dp[i][j]);\n\t    ans=max(ans,dp[i][j]);\n\t  }\n\t}\n      }\n    }\n\n    while(ans.number[0]=='0')ans.number=ans.number.substr(1);\n    cout<<ans.number<<endl;\n  }\n}\n\t    "
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a; i<b; ++i)\n#define rep(i,n) REP(i,0,n)\n\nchar input[70][70];\nstring dp[70][70];\n\nint comp(string s,string t) { // comp s and t if s < t return negative\n  if(s.length() != t.length()) return (s.length() - t.length());\n  rep(i,s.length()) if(s[i] != t[i]) return (s[i] - t[i]);\n  return 0;\n}\n\nint main() {\n  int w,h,n;\n  while(cin>>w>>h, w|h) {\n    string s;\n    rep(i,h) {\n      cin>>s;\n      rep(j,w) {\n\tdp[i][j] = \"\";\n\tinput[i][j] = s[j];\n      }\n    }\n\n    rep(i,h) {\n      rep(j,w) {\n\tchar c = input[i][j];\n\tif(i == 0 && j == 0) {\n\t  if(c <= '9' && c >= '0') dp[i][j] = string(1,c);\n\t}else{\n\t  if(!(c <= '9' && c >= '0')) continue;\n\t  string ab = \"\",left = \"\";\n\t  if(i > 0) ab = dp[i-1][j] + string(1,c);\n\t  if(j > 0) left = dp[i][j-1] + string(1,c);\n\t  if(comp(ab,left) <= 0) {\n\t    dp[i][j] = left;\n\t  }else{\n\t    dp[i][j] = ab;\n\t  }\n\t  if(dp[i][j][0] == '0') dp[i][j] = dp[i][j].substr(1);\n\t}\n      }\n    }\n\n    string ans = \"\";\n    rep(i,h) rep(j,w) { if(comp(ans,dp[i][j]) < 0) ans = dp[i][j]; }\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <cmath>\n#include <algorithm>\n#include <stack>\n#include <queue>\n#include <vector>\ntypedef long long int ll;\n\nusing namespace std;\n\nstruct Info{\n\tInfo(){\n\t\tlength = 0;\n\t}\n\tchar number[71];\n\tint length;\n};\n\nchar** table;\nInfo info[71][72];\n\nchar biggest[71];\nint biggest_length;\n\nint W,H;\n\nbool strCmp(char* base, char* comp){\n\tint length1 = 0,length2 = 0;\n\tfor(int i=0;base[i] != '\\0'; i++)length1++;\n\tfor(int i=0;comp[i] != '\\0'; i++)length2++;\n\tif(length1 != length2)return false;\n\n\tfor(int i=0;base[i] != '\\0'; i++){\n\t\tif(base[i] != comp[i])return false;\n\t}\n\treturn true;\n}\n\nvoid strcpy(char* to,char* str){\n\tfor(int i=0;str[i] != '\\0';i++){\n\t\tto[i] = str[i];\n\t\tto[i+1] = '\\0';\n\t}\n}\n\nint strCmp2(char* left,char* right){\n\tint i;\n\n\tif(strCmp(left,right))return 3;\n\n\tfor(i=0;left[i] != '\\0' && right[i] != '\\0'; i++){\n\t\tif(left[i] != right[i]){\n\t\t\tif(left[i] < right[i])return 1;\n\t\t\telse{\n\t\t\t\treturn 2;\n\t\t\t}\n\t\t}\n\t}\n\tif(left[i] == '\\0')return 1;\n\telse{\n\t\treturn 2;\n\t}\n}\n\n\nbool rangeCheck(int row,int col){\n\tif(row >= 0 && row <= H-1 && col >= 0 && col <= W-1)return true;\n\telse{\n\t\treturn false;\n\t}\n}\n\nvoid func(){\n\tfor(int i = 1; i <= H; i++){\n\t\tscanf(\"%s\",table[i]);\n\t}\n\n\tbiggest[0] = '\\0';\n\tbiggest_length = 0;\n\n\tfor(int i = 1; i <= H; i++){\n\t\tfor(int k = 1; k <=W; k++){\n\t\t\tif(table[i][k-1] >= '0' && table[i][k-1] <= '9'){\n\n\t\t\t\tif(info[i-1][k].length == 0 && info[i][k-1].length == 0){\n\t\t\t\t\tif(table[i][k-1] != '0'){\n\t\t\t\t\t\tinfo[i][k].length = 1;\n\t\t\t\t\t\tinfo[i][k].number[0] = table[i][k-1];\n\t\t\t\t\t\tinfo[i][k].number[1] = '\\0';\n\t\t\t\t\t}\n\t\t\t\t}else if(info[i-1][k].length > info[i][k-1].length){\n\t\t\t\t\tstrcpy(info[i][k].number,info[i-1][k].number);\n\t\t\t\t\tinfo[i][k].number[info[i-1][k].length] = table[i][k-1];\n\t\t\t\t\tinfo[i][k].number[info[i-1][k].length+1] = '\\0';\n\t\t\t\t\tinfo[i][k].length = info[i-1][k].length+1;\n\t\t\t\t}else if(info[i-1][k].length < info[i][k-1].length){\n\t\t\t\t\tstrcpy(info[i][k].number,info[i][k-1].number);\n\t\t\t\t\tinfo[i][k].number[info[i][k-1].length] = table[i][k-1];\n\t\t\t\t\tinfo[i][k].number[info[i][k-1].length+1] = '\\0';\n\t\t\t\t\tinfo[i][k].length = info[i][k-1].length+1;\n\t\t\t\t}else{ //info[i-1][k].length == info[i][k-1].length\n\t\t\t\t\tswitch(strCmp2(info[i-1][k].number,info[i][k-1].number)){\n\t\t\t\t\tcase 1: //info[i-1][k].number < info[i][k-1].number\n\t\t\t\t\t\tstrcpy(info[i][k].number,info[i][k-1].number);\n\t\t\t\t\t\tinfo[i][k].number[info[i][k-1].length] = table[i][k-1];\n\t\t\t\t\t\tinfo[i][k].number[info[i][k-1].length+1] = '\\0';\n\t\t\t\t\t\tinfo[i][k].length = info[i][k-1].length+1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tstrcpy(info[i][k].number,info[i-1][k].number);\n\t\t\t\t\t\tinfo[i][k].number[info[i-1][k].length] = table[i][k-1];\n\t\t\t\t\t\tinfo[i][k].number[info[i-1][k].length+1] = '\\0';\n\t\t\t\t\t\tinfo[i][k].length = info[i-1][k].length+1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif((info[i][k].length > biggest_length) || (info[i][k].length == biggest_length && strCmp2(info[i][k].number,biggest) == 2)){\n\t\t\t\t\tbiggest_length = info[i][k].length;\n\t\t\t\t\tstrcpy(biggest,info[i][k].number);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\tprintf(\"%s\\n\",biggest);\n}\n\nint main(){\n\n\n\ttable = new char*[71];\n\tfor(int i = 1; i <= 70; i++){\n\t\ttable[i] = new char[72];\n\t}\n\n\twhile(true){\n\t\tscanf(\"%d %d\",&W,&H);\n\t\tif(W == 0 && H == 0)break;\n\n\t\tfor(int i = 1; i <= H; i++){\n\t\t\tfor(int k = 1; k <= W+1; k++){\n\t\t\t\tinfo[i][k].length = 0;\n\t\t\t}\n\t\t}\n\n\t\tfunc();\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "/* main code starts from line 155. */\n\n/* ---------- STL Libraries ---------- */\n\n// IO library\n#include <cstdio>\n#include <iomanip>\n#include <ios>\n#include <iostream>\n\n// algorithm library\n#include <algorithm>\n#include <cmath>\n#include <numeric>\n\n// container library\n#include <array>\n#include <bitset>\n#include <map>\n#include <queue>\n#include <set>\n#include <string>\n#include <vector>\n\n/* ---------- Namespace ---------- */\n\nusing namespace std;\n\n/* ---------- Type Abbreviation ---------- */\n\ntemplate <typename T>\nusing V = vector<T>;\ntemplate <typename T, typename U>\nusing P = pair<T, U>;\ntemplate <typename T>\nusing PQ = priority_queue<T>;\ntemplate <typename T>\nusing GPQ = priority_queue<T, vector<T>, greater<T>>;\n\nusing ll = long long;\n\n#define fst first\n#define snd second\n#define pb push_back\n#define mp make_pair\n#define mt make_tuple\n\n/* ---------- conversion ---------- */\n\n#define INT(c) static_cast<int>(c)\n#define CHAR(n) static_cast<char>(n)\n#define LL(n) static_cast<ll>(n)\n#define DOUBLE(n) static_cast<double>(n)\n\n/* ---------- container ---------- */\n\n#define ALL(v) (v).begin(), (v).end()\n#define SIZE(v) (LL((v).size()))\n\n#define FIND(v, k) (v).find(k) != (v).end()\n#define VFIND(v, k) find(ALL(v), k) != (v).end()\n\n#define SORT(v) sort(ALL(v))\n#define GSORT(v) sort(ALL(v), greater<decltype((v).front())>())\n\n/* ---------- repetition ---------- */\n\n#define FOR(i, a, b) for (ll i = (a); i <= (b); i++)\n#define RFOR(i, a, b) for (ll i = (a); i >= (b); i--)\n\n/* ---------- Short Functions ---------- */\n\ntemplate <typename T>\nT sq(T a) {\n    return a * a;\n}\n\ntemplate <typename T>\nT gcd(T a, T b) {\n    if (a > b) return gcd(b, a);\n    return a == 0 ? b : gcd(b % a, a);\n}\n\ntemplate <typename T>\nT mypow(T b, T n) {\n    if (n == 0) return 1;\n    if (n == 1) return n;\n    if (n % 2 == 0) {\n        return mypow(sq(b), n / 2);\n    } else {\n        return mypow(b, n - 1) * b;\n    }\n}\n\n/* --------------------\ntemplate <typename T>\nT mypow(T b, T n) {\n    if (n == 0) return 1;\n    if (n == 1) return n % MOD;\n    if (n % 2 == 0) {\n        return mypow(sq(b) % MOD, n / 2);\n    } else {\n        return mypow(b, n - 1) * b % MOD;\n    }\n}\n-------------------- */\n\n#define fcout cout << fixed << setprecision(10)\n\n/* ----------- debug ---------- */\n\ntemplate <typename T, typename U>\nvoid testP2(T a, U b) {\n    cout << \"(\" << a << \", \" << b << \")\" << endl;\n    return;\n}\n\ntemplate <typename T>\nvoid testV(T v) {\n    cout << \"[\";\n    for (auto i : v) {\n        cout << i << \", \";\n    }\n    cout << \"\\b\\b]\" << endl;\n    return;\n}\n\ntemplate <typename T>\nvoid testV2(T v) {\n    for (auto sv : v) {\n        testV(sv);\n    }\n    cout << endl;\n    return;\n}\n\n#define GET_VAR_NAME(variable) #variable\n#define test(x) cout << GET_VAR_NAME(x) << \" = \" << x << endl;\n#define testP(p)                      \\\n    cout << GET_VAR_NAME(p) << \" = \"; \\\n    testP2(p.fst, p.snd);\n\n/* ---------- Constants ---------- */\n\n// const ll MOD = 1e9 + 7;\n// const int INF = 1 << 25;\n// const ll INF = 1LL << 50;\n// const double PI = acos(-1);\n// const double EPS = 1e-10;\n// const ll dx[4] = {0, -1, 1, 0};\n// const ll dy[4] = {-1, 0, 0, 1};\n// const ll dx[8] = {-1, 0, 1, -1, 1, -1, 0, 1};\n// const ll dy[8] = {-1, -1, -1, 0, 0, 1, 1, 1};\n\n/* v-v-v-v-v-v-v-v-v Main Part v-v-v-v-v-v-v-v-v */\n\n/* ---------- Type Definition ----------- */\n\n\n/* ---------- Global Variance ----------- */\n\nll W, H;\nV<string> S;\nV<V<string>> dp(100, V<string>(100));\n\n/* ------------- Functions -------------- */\n\nbool comp(string a, string b, ll k) {\n    if (k) {\n        while (a[0] == '0') {\n            a.erase(a.begin());\n        }\n\n        while (b[0] == '0') {\n            b.erase(b.begin());\n        }\n    }\n\n    if (SIZE(a) != SIZE(b)) {\n        return SIZE(a) > SIZE(b);\n    }\n\n    FOR(i, 0, SIZE(a) - 1) {\n        if (a[i] == b[i]) continue;\n        return a[i] > b[i];\n    }\n\n    return false;\n}\n\nstring dfs(ll x, ll y) {\n    if (x >= H || y >= W || !isdigit(S[x][y])) return \"\";\n    if (dp[x][y] != \"A\") return dp[x][y];\n\n    dp[x][y][0] = S[x][y];\n\n    string s;\n    s.pb(S[x][y]);\n\n    FOR(i, 0, 1) {\n        ll nx = x + i;\n        ll ny = y + 1 - i;\n        string val = s + dfs(nx, ny);\n        if (comp(val, dp[x][y], 0)) {\n            dp[x][y] = val;\n        }\n    }\n    return dp[x][y];\n}\n\n/* ----------- Main Function ------------ */\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while (true) {\n        cin >> W >> H;\n        if (W == 0) break;\n\n        V<string> C(H);\n        FOR(i, 0, H - 1) {\n            cin >> C[i];\n            fill(ALL(dp[i]), \"A\");\n        }\n\n        S = C;\n\n        string ans = \"0\";\n        FOR(x, 0, H - 1) {\n            FOR(y, 0, W - 1) {\n                string ret = dfs(x, y);\n                if (!ret.empty() && comp(ret, ans, 1)) {\n                    ans = ret;\n                }\n            }\n        }\n\n        while (ans[0] == '0') {\n            ans.erase(ans.begin());\n        }\n\n        cout << ans << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<sstream>\n#include<cstring>\n#include<vector>\nusing namespace std;\n\nbool cmp1(const string& a,const string& b)\n{\n  int size_a,size_b;\n  int start_a,start_b;\n  start_a = start_b = 0;\n  size_a = a.size(),size_b = b.size();\n  if(a[0] == '0')\n    for(int i=0;i<a.size() && a[i] == '0';i++)\n      size_a--,start_a++;\n\n  if(b[0] == '0')\n    for(int i=0;i<b.size() && b[i] == '0';i++)\n      size_b--,start_b++;\n\n  if(size_a != size_b)\n    return size_a < size_b;\n\n  for(int i=0;i<size_a;i++)\n    {\n      if(a[start_a+i] != b[start_b+i])\n\treturn a[start_a+i] < b[start_b+i];\n    }\n  return true;\n}\n\nbool cmp2(const string& a,const string& b)\n{\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    {\n      if(a[i] != b[i])\n\treturn a[i] < b[i];\n    }\n  return true;\n}\n\nint main()\n{\n\n  int W,H;\n  while(cin >> W >> H,W|H)\n    {\n     \n      vector<vector<string> > G;\n      G.resize(H);\n      for(int i=0;i<H;i++)\n\t{\n\t  G[i].resize(W);\n\t  string line;\n\t  cin >> line;\n\n\t  for(int j=0;j<W;j++)\n\t    {\n\t      G[i][j] = line[j];\n\t    }\n\t}\n\n      string G2[H][W];\n      string ans = \"\";\n      for(int i=0;i<H;i++)\n\t{\n\t  for(int j=0;j<W;j++)\n\t    {\n\t      if(isalpha(G[i][j][0]))\n\t\tcontinue;\n\t    \n\t      G2[i][j] = max(G2[i][j],G[i][j],cmp1);\n\t      string A,B;\n\t      A = B = G2[i][j];\n\t      if(j-1 >= 0 && !isalpha(G[i][j-1][0]))\n\t\tA = max(G2[i][j],G2[i][j-1]+G2[i][j],cmp1);\n\n\t      if(i-1 >= 0 && !isalpha(G[i-1][j][0]))\n\t\tB = max(G2[i][j],G2[i-1][j]+G2[i][j],cmp1);\n\t      G2[i][j] = max(A,B,cmp1);\n\t      ans = max(G2[i][j],ans,cmp1);\n\t    \n\t    }\n\t}\n    \n      \n      for(int i=0;i<ans.size()&&ans[i] == '0';i++)\n\tans[i] = ' ';\n      stringstream ss;\n      ss << ans;\n      ss >> ans;\n      \n     cout << ans << endl;\n\n      }\n    \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cctype>\n\nusing namespace std;\n\nint main(void){\n  int w,h;\n  string grid[70],dp[70][70];\n\n  while(cin >> w >> h,w|h){\n    for(int i=0;i<70;i++)\n      for(int j=0;j<70;j++)dp[i][j].clear();\n\n    for(int i=0;i<h;i++)cin >> grid[i];\n\n    for(int i=0;i<h;i++)\n      for(int j=0;j<w;j++)\n\tif(!isupper(grid[i][j]))dp[i][j]=grid[i][j];\n\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(!isupper(grid[i][j])){\n\t  dp[i][j]=grid[i][j];\n\t  string a=\"\",b=\"\";\n\t  if(i>0 && !dp[i-1][j].empty())a=dp[i-1][j]+grid[i][j];\n\t  if(j>0 && !dp[i][j-1].empty())b=dp[i][j-1]+grid[i][j];\n\t  \n\t  if(a.empty() && !b.empty()){\n\t    dp[i][j]=b;\n\t    continue;\n\t  }\n\n\t  if(!a.empty() && b.empty()){\n\t    dp[i][j]=a;\n\t    continue;\n\t  }\n\t  if(a.empty() && b.empty())continue;\n\t  if(a>b)dp[i][j]=a;\n\t  else dp[i][j]=b;\n\n\t}\n      }\n    }\n\n    string s=\"\";\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(dp[i][j][0]=='0'){\n\t  int k=0;\n\t  for(;k<dp[i][j].size()&&dp[i][j][k]=='0';k++);\n\t  dp[i][j]=dp[i][j].substr(k);\n\t}\n\tif(s.size()<dp[i][j].size())s=dp[i][j];\n\telse if(s<dp[i][j])s=dp[i][j];\n      }\n    }\n    cout << s << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "# define _CRT_SECURE_NO_WARNINGS 1\n# include <iostream>\n# include <numeric>\n# include <string>\n# include <bitset>\n# include <vector>\n# include <algorithm>\n# include <cstdlib>\n# include <cstdio>\n# include <cstring>\n# include <cstdlib>\n# include <iomanip>\n# include <queue>\n# include <sstream>\n# include <climits>\n# include <cmath>\n# include <list>\n# include <functional>\n# include <string>\n# include <ctime>\n# include <set>\n# include <forward_list>\n# include <map>\n# include <stack>\nusing namespace std;\n\n# define INF ((int)(1<<30))\n# define REP(i,n) for(int i=0;i<(int)n;i++)\n# define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();i++)\n# define TORAD 2.0*M_PI/360.0\n# define INT(x) int x;cin>>x;\n# define ALL(x) (x).begin(),(x).end()\n# define DEBUG(x) cout<<#x<<\" :\"<<x<<endl;\n# define EPS 1e-12\n\ntemplate<class T> void debug(T a) { for (auto i : a)cout << i << endl; }\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef pair<int, pii> piii;\nint dx[4] = { 0,-1,1,0 }, dy[4] = { 1,0,0,-1 };\n\nint clamp(int a, int mi, int ma)\n{\n\treturn max(mi, min(a, ma));\n}\nbool isnum(char a)\n{\n\treturn ('0' <= a&&a <= '9');\n}\nstring big(string a, string b)\n{\n\tif (a.size() > b.size())\n\t{\n\t\treturn a;\n\t}\n\tif (a.size() < b.size())\n\t{\n\t\treturn b;\n\t}\n\treturn max(a, b);\n}\n\nint main()\n{\n\tint w, h;\n\twhile (cin >> w >> h&&w)\n\t{\n\t\tchar a[100][100];\n\t\tREP(i, 100)REP(j, 100)a[i][j] = 'a';\n\t\tREP(i, h)\n\t\t{\n\t\t\tREP(j, w)\n\t\t\t{\n\t\t\t\tcin >> a[i][j];\n\t\t\t}\n\t\t}\n\t\tbool flag[100][100] = {};\n\t\tstring ans = \"\";\n\t\tREP(y, h)\n\t\t{\n\t\t\tREP(x, w)\n\t\t\t{\n\t\t\t\tif (isnum(a[y][x]) && flag[y][x] == false && a[y][x] != '0')\n\t\t\t\t{\n\t\t\t\t\ttypedef pair<string, pii> l;\n\t\t\t\t\tqueue<l> que;\n\t\t\t\t\tstring str; str += a[y][x];\n\t\t\t\t\tque.push(l(str, pii(y, x)));\n\t\t\t\t\tint DX[2] = { 1,0 }, DY[2] = { 0,1 };\n\t\t\t\t\twhile (!que.empty())\n\t\t\t\t\t{\n\t\t\t\t\t\tl now = que.front();\n\t\t\t\t\t\tque.pop();\n\t\t\t\t\t\tflag[now.second.first][now.second.second] = true;\n\t\t\t\t\t\tans = big(ans, now.first);\n\t\t\t\t\t\tREP(i, 2)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tl next = now;\n\t\t\t\t\t\t\tnext.second.first += DY[i];\n\t\t\t\t\t\t\tnext.second.second += DX[i];\n\t\t\t\t\t\t\tif (isnum(a[next.second.first][next.second.second]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tnext.first += a[next.second.first][next.second.second];\n\t\t\t\t\t\t\t\tque.push(next);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\nusing namespace std;\nint W,H;\nchar c[71][71];\nstring s[71][71],t = \".\";\n\nstruct item{\n\tstring s;\n\tint x;\n\tint y;\n};\n\nbool operation(string l,string r){\n\tif(l.size() != r.size()){\n\t\treturn l.size() < r.size();\n\t}\n\telse{\n\t\treturn l < r;\n\t}\n}\n\nvector<item> v;\n\nstring solve(int i,int j){\n\tlong long a,b;\n\tstring s1,s2;\n\ts1 = s2 = c[i][j];\n\titem it;\n\tif(s[i][j] != t)return s[i][j];\n\tif(c[i][j+1] >= '0' && c[i][j+1] <= '9' && j+1 < W){\n\t\tif(s[i][j+1] != t) s1 += s[i][j+1];\n\t\telse s1 += solve(i,j+1);\n\t}\n\tif(c[i+1][j] >= '0' && c[i+1][j] <= '9' && i+1 < H){\n\t\tif(s[i+1][j] != t) s2 += s[i+1][j];\n\t\telse s2 += solve(i+1,j);\n\t}\n\n\tit.s = s[i][j] = max(s1,s2,operation);\n\n\tit.x = j;\n\tit.y = i;\n\tv.push_back(it);\n\treturn s[i][j];\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> W >> H;\n\t\tint x,y;\n\t\tstring st,res;\n\t\tif(W == 0)break;\n\t\tv.clear();\n\t\tres = \"\";\n\t\tfor(int i = 0;i < 71;i++){\n\t\t\tfor(int j = 0;j <= 71;j++){\n\t\t\t\tc[i][j] = '.';\n\t\t\t\ts[i][j] = '.';\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tif(c[i][j] >= '1' && c[i][j] <= '9'){\n\t\t\t\t\tst = solve(i,j);\n\t\t\t\t\ts[i][j] = st;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//sort(v.begin(),v.end(),operation);\n\t\tfor(int i = 0;i < v.size();i++){\n\t\t\tres = max(res,v[i].s,operation);\n\t\t}\t\t\n\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<cctype>\nusing namespace std;\n\n#define MAX 72\n#define INV (-1)\n\nstruct Dig{\n\tvector<char> s;\n\tvector< pair<int,int> > pos;\n\tvoid push( char c, int i, int j ){\n\t\ts.push_back( c );\n\t\tpos.push_back( make_pair(i,j) );\n\t}\n\tvoid pop(){\n\t\ts.pop_back();\n\t\tpos.pop_back();\n\t}\n\tvoid simplify(){\n\t\twhile( true ){\n\t\t\tif( s.size() == 1 )\n\t\t\t\tbreak;\n\t\t\tif( s[0] == '0' ){\n\t\t\t\ts.erase( s.begin() );\n\t\t\t}else\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tbool operator<(const Dig &t){\n\t\tif( s.size() < t.s.size() )\n\t\t\treturn true;\n\t\telse if( s.size() == t.s.size() ){\n\t\t\tfor(unsigned int i = 0; i < s.size(); ++i){\n\t\t\t\tif( s[i] == t.s[i] )\n\t\t\t\t\tcontinue;\n\t\t\t\tif( s[i] < t.s[i] )\n\t\t\t\t\treturn true;\n\t\t\t\telse\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n};\n\nvector< Dig > vdigs;\n\nvoid dfs(char map[MAX][MAX], int i, int j, Dig &d, bool fixedDown){\n\tconst int di[] = {1,0};\n\tconst int dj[] = {0,1};\n\tbool bCanGoNext = false;\n\t\n\tif( !isdigit( map[i][j] ) )\n\t\treturn ;\n\t\n\t/*if( fixedDown ){\n\t\tif( isdigit( map[i+1][j] ) && !isdigit(map[i+1][j-1]) ){\n\t\t\tbCanGoNext = true;\n\t\t\td.push( map[i][j], i, j );\n\t\t\tdfs(map,i+1,j,d,true);\n\t\t\td.pop();\n\t\t}else if( isdigit( map[i][j+1] ) ){\n\t\t\tbCanGoNext = true;\n\t\t\td.push( map[i][j], i, j );\n\t\t\tdfs(map,i,j+1,d,false);\n\t\t\td.pop();\n\t\t}\n\t}else*/{\n\t\tif( isdigit( map[i][j+1] ) ){\n\t\t\tbCanGoNext = true;\n\t\t\td.push( map[i][j], i, j );\n\t\t\tdfs(map,i,j+1,d,false);\n\t\t\td.pop();\n\t\t}\n\t\tif( isdigit( map[i+1][j]) && (!isdigit(map[i+1][j-1]) || !isdigit(map[i][j+1]) ) ){\n\t\t\tbCanGoNext = true;\n\t\t\td.push( map[i][j], i, j );\n\t\t\tdfs(map,i+1,j,d,true);\n\t\t\td.pop();\n\t\t}\n\t}\n\t\n\tif( !bCanGoNext ){\n\t\td.push( map[i][j], i , j );\n\t\tvdigs.push_back( d );\n\t\td.pop();\n\t}\n}\nvoid ResetMap(char map[MAX][MAX]){\n\tfor(int i = 0; i < MAX; ++i){\n\t\tfor( int j = 0; j < MAX; ++j){\n\t\t\tmap[i][j] = INV;\n\t\t}\n\t}\n}\ntemplate<typename _T>\nostream &operator << (ostream &os, const vector<_T> &v){\n\tfor(unsigned int i = 0; i < v.size(); ++i){\n\t\tos << v[i];\n\t}\n\treturn os;\n}\n\nint LCS(const Dig &a, const Dig &b){\n\tint ret = 0;\n\tint table[MAX][MAX] = {{0,},};\n\tfor(unsigned int i = 1; i <= a.pos.size(); ++i){\n\t\tfor(unsigned int j = 1; j <= b.pos.size(); ++j){\n\t\t\tif( a.pos[i-1] == b.pos[j-1] ){\n\t\t\t\ttable[i][j] = 1 + table[i-1][j-1];\n\t\t\t}else{\n\t\t\t\ttable[i][j] = max( table[i-1][j], table[i][j-1] );\n\t\t\t}\n\t\t\tret = max( ret, table[i][j] );\n\t\t}\n\t}\n\treturn ret;\n}\n\nint main(){\t\n\twhile(true){\n\t\tint H,W;\n\t\tDig d;\n\t\tDig ans;\n\t\tchar map[MAX][MAX];\n\n\t\tcin >> W >> H;\n\t\t\n\t\tif( W == 0 && H == 0 ) break;\n\t\tvdigs.clear();\n\t\tResetMap( map );\n\t\tfor(int i = 1; i <= H; ++i){\n\t\t\tstring s;\n\t\t\tcin >> s;\n\t\t\tfor(int j = 1; j <= W; ++j){\n\t\t\t\tmap[i][j] = s[j-1];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 1; i <= H; ++i){\n\t\t\tfor(int j = 1; j <= W; ++j){\n\t\t\t\t//bool bAssigned = false;\n\t\t\t\tif( !isdigit(map[i][j]) || isdigit(map[i-1][j]) || isdigit(map[i][j-1]) )\n\t\t\t\t\tcontinue;\n\t\t\t\tdfs( map, i, j, d, false );\n\t\t\t}\n\t\t}\n\t\t/*\t\tif( isdigit(map[i][j+1]) ){\n\t\t\t\t\tsmap[i][j+1] = smap[i][j] + map[i][j];\n\t\t\t\t\tbAssigned = true;\n\t\t\t\t}\n\t\t\t\tif( isdigit(map[i][j-1]) && !isdigit(map[i][j+1]) && isdigit(map[i+1][j]) ){\n\t\t\t\t\tsmap[i+1][j] = smap[i][j] + map[i][j];\n\t\t\t\t\tbAssigned = true;\n\t\t\t\t}\n\t\t\t\tif( !isdigit( map[i][j-1] ) && !isdigit( map[i+1][j-1] ) && isdigit( map[i+1][j] ) ){\n\t\t\t\t\tsmap[i+1][j] = smap[i][j] + map[i][j];\t\n\t\t\t\t\tbAssigned = true;\n\t\t\t\t}\n\t\t\t\tif( bAssigned ){\n\t\t\t\t\tsmap[i][j].clear();\n\t\t\t\t}\n\t\t\t}\n\t\t}*/\n\t\tans.push('0',0,0);\n\t\tfor(unsigned int i = 0; i < vdigs.size(); ++i){\n\t\t\tvdigs[i].simplify();\n\t\t\t//cout << vdigs[i].s << endl;\n\t\t\tif( ans < vdigs[i] )\n\t\t\t\tans = vdigs[i];\n\t\t}\n\t\tcout << ans.s << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cctype>\nusing namespace std;\n\nint main(void){\n    int W,H;\n    string dp[2][70];\n    string line,ans;\n    while(cin >> W >> H, W){\n        for(int i=0;i<70;i++){\n            dp[0][i].clear();dp[1][i].clear();\n        }\n        ans.clear();\n        for(int i=0;i<H;i++){\n            cin >> line;\n            for(int j=0;j<W;j++){\n                dp[i&1][j].clear();\n                if(isdigit(line[j])){\n                    if(dp[(i&1)^1][j]!=\"0\"){\n                        dp[i&1][j]=dp[(i&1)^1][j]+line[j];\n                    }else{\n                        dp[i&1][j].push_back(line[j]);\n                    }\n                    if(j!=0&&dp[i&1][j-1]!=\"0\") dp[i&1][j]=max(dp[i&1][j],dp[i&1][j-1]+line[j],[](const string& a, const string& b){return a.size()==b.size()? a < b : a.size() < b.size();});\n                    ans=max(dp[i&1][j],ans,[](const string& a, const string& b){return a.size()==b.size()? a < b : a.size() < b.size();});\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n\n\nusing namespace std;\n\nint const N = 100;\nchar table[N][N] = {};\nbool vd[N][N] = {};\n\nvoid clear() {\n    for( int i=0; i<N; ++i )\n        for( int j=0; j<N; ++j ) {\n            table[i][j] = 0;\n            vd[i][j] = false;\n        }\n}\n\nint const dir[][2] = {{1,0}, {0, 1}};\nvoid find( vector<string>& ss, string& s, int const x, int const y, int const w, int const h )\n{\n    s += table[x][y];\n    vd[x][y] = true;\n\n    for( int i=0; i<2; ++i ) {\n        int const nx = x + dir[i][0];\n        int const ny = y + dir[i][1];\n        if ( nx < 0 || ny < 0 || nx >= w || ny >= h )\n            continue;\n        \n        if ( table[nx][ny] >= '0' && table[nx][ny] <= '9' ) {\n//            string copied = s;\n            find( ss, s, nx, ny, w, h );\n        }\n    }\n\n    ss.push_back( s );\n    s.erase( s.end() - 1 );\n}\n\ntemplate<typename T>\nstruct bun\n{\n    bool operator()( T const& l, T const& r ) {\n        return l.size() > r.size() || (l.size() == r.size() && l > r);\n    }\n};\n\nint main()\n{\n    for(;;) {\n        int w, h;\n        cin >> w >> h;\n        if ( w == 0 && h == 0 )\n            break;\n\n        clear();\n        cin.ignore(255, '\\n');\n        for( int y=0; y<h; ++y ) {\n            string s;\n            getline( cin, s );\n            for( int iii=0; iii<s.size(); ++iii ) {\n                table[iii][y] = s[iii];\n            }\n        }\n\n        vector<string> ss;\n        string s;\n        for( int x=0; x<w; ++x ) {\n            for( int y=0; y<h; ++y ) {\n                if ( table[x][y] >= '1' && table[x][y] <= '9' && !vd[x][y] ) {\n                    find( ss, s, x, y, w, h );\n                }\n            }\n        }\n        stable_sort( ss.begin(), ss.end(), bun<string>() );\n\n        //for( int i=0; i<ss.size(); ++i )\n            //cout << ss[i] << endl;\n        //    ;\n\n\n        cout << ss[0] << endl;\n        //cout << \"======\" << endl;\n    };\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,k,n) for(int i = (k); i < (n); i++)\n#define REP(i,n) FOR(i,0,n)\n#define INF 114514810\n#define MOD 1000000007\n#define ALL(a) begin((a)),end((a))\n#define MS(m,v) memset(m,v,sizeof(m))\n#define D10  fixed<<setprecision(10)\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int, int> P;\ntypedef long long ll;\nstruct edge\n{\n\tint from, to, cost;\n\tbool operator < (const edge& e) const { return cost < e.cost; }\n\tbool operator >(const edge& e) const { return cost > e.cost; }\n};\n///*************************************************************************************///\n///*************************************************************************************///\n///*************************************************************************************///\n\nint fld[80][80];\nstring dp[80][80];\nint w, h;\n\nint main()\n{\n\twhile (cin >> w >> h, w)\n\t{\n\t\tREP(i, h + 1)REP(j, w + 1)\n\t\t{\n\t\t\tdp[i][j] = \"\";\n\t\t\tfld[i][j] = -1;\n\t\t}\n\t\tREP(i, h)REP(j, w)\n\t\t{\n\t\t\tchar c;\n\t\t\tcin >> c;\n\t\t\tif (isalpha(c)) fld[i][j] = -1;\n\t\t\telse fld[i][j] = c - '0';\n\t\t}\n\t\tstring ans = \"0\";\n\t\tfor (int i = h; i >= 0; i--)\n\t\t{\n\t\t\tfor (int j = w; j >= 0; j--)\n\t\t\t{\n\t\t\t\tif (fld[i][j] >= 0)\n\t\t\t\t{\n\t\t\t\t\tchar c = fld[i][j] + '0';\n\t\t\t\t\tstring t1, t2;\n\t\t\t\t\tt1 = c + dp[i][j + 1]; t2 = c + dp[i + 1][j];\n\t\t\t\t\tif (t1.size() != t2.size()) dp[i][j] = (t1.size() > t2.size() ? t1 : t2);\n\t\t\t\t\telse dp[i][j] = max(t1, t2);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tREP(i, h)REP(j, w)\n\t\t{\n\t\t\tif (dp[i][j].size() > ans.size()) ans = dp[i][j];\n\t\t\telse if (dp[i][j].size() == ans.size()) ans = max(dp[i][j], ans);\n\t\t}\n\t\twhile (ans[0] == '0') ans.erase(0, 1);\n\t\tcout << ans << endl;\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<cstring>\nusing namespace std;\n\nstring dp[70][70];\n\nstring comp(string a,string b){\n  while(a[0]=='0')a=a.substr(1);\n  while(b[0]=='0')b=b.substr(1);\n  if(a.length()<b.length()){\n    return b;\n  }else if(a.length()>b.length()){\n    return a;\n  }else{\n    int i=0;\n    while(i<a.length() && a[i]==b[i])i++;\n    if(i==a.length())return a;\n    if(a[i]>=b[i]) return a;\n    else return b;\n  }\n}\n\nint main(){\n  int h,w;\n  while(cin>>w>>h,w){\n    char grid[h+1][w+1];\n    for(int i=1;i<=h;i++){\n      for(int j=1;j<=w;j++){\n\tcin>>grid[i][j];\n\tif(grid[i][j]<'0' || '9'<grid[i][j])\n\t  grid[i][j]='0'-1;\n      }\n    }\n    for(int i=0;i<=h;i++)\n      for(string s:dp[i])\n\ts.clear();\n    string res=\"\";\n    for(int i=1;i<=h;i++){\n      for(int j=1;j<=w;j++){\n\tif(grid[i][j]=='0'-1){\n\t  dp[i][j]=\"\";\n\t  continue;\n\t}\n\tif(j==0){\n\t  dp[i][j]=dp[i-1][j]+grid[i][j];\n\t}else{\n\t  dp[i][j]=comp(dp[i-1][j]+grid[i][j],dp[i][j-1]+grid[i][j]);\n\t}\n\tres=comp(dp[i][j],res);\n      }\n    }\n    // cout << \"dp:\" << endl;\n    // for(int i=1;i<=h;i++){\n    //   for(string a:dp[i]){\n    // \tcout << a << \" \";\n    //   }\n    //   cout << endl;\n    // }\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\nusing namespace std;\n\nstring comp(string s1,string s2){\n\tif(s1.size()>s2.size())\n\t\treturn s1;\n\telse if(s1.size()<s2.size())\n\t\treturn s2;\n\n\telse return max(s1,s2);\n}\n\n\nint main()\n{\n\tint W,H;\n\twhile(cin>>W>>H && W!=0){\n\t\tvector<string> M;\n\t\tfor(int i=0;i<H;i++){\n\t\t\tstring s;\n\t\t\tcin>>s;\n\t\t\tM.push_back(s);\n\t\t}\n\t\tvector<vector<string> > dp(H,vector<string>(W,\"\"));\n\n\t\tstring ans=\"0\";\n\n\t\tfor(int y=0;y<H;y++){\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tif(!isdigit(M[y][x])) continue;\n\n\t\t\t\tstring s1=\"\",s2=\"\";\n\t\t\t\tif(x>=1){\n\t\t\t\t\ts1=dp[y][x-1]+M[y][x];\n\t\t\t\t}\n\t\t\t\tif(y>=1){\n\t\t\t\t\ts2=dp[y-1][x]+M[y][x];\n\t\t\t\t}\n\n\n\t\t\t\tdp[y][x]=comp(s1,s2);\n\t\t\t\tif(dp[y][x]==\"0\") dp[y][x]=\"\";\n\t\t\t\tans=comp(dp[y][x],ans);\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\nusing namespace std;\nint W,H;\nchar c[71][71];\nstring s[71][71];\nstring t = \".\";\n\nbool operation(string l,string r){\n\tif(l.size() != r.size()){\n\t\treturn l.size() < r.size();\n\t}\n\telse{\n\t\treturn l < r;\n\t}\n}\n\nstring solve(int i,int j){\n\tstring s1,s2;\n\ts1 = s2 = c[i][j];\n\tif(s[i][j] != t)return s[i][j];\n\tif(c[i][j+1] >= '0' && c[i][j+1] <= '9' && j+1 < W){\n\t\tif(s[i][j+1] != t) s1 += s[i][j+1];\n\t\telse s1 += solve(i,j+1);\n\t}\n\tif(c[i+1][j] >= '0' && c[i+1][j] <= '9' && i+1 < H){\n\t\tif(s[i+1][j] != t) s2 += s[i+1][j];\n\t\telse s2 += solve(i+1,j);\n\t}\n\n\ts[i][j] = max(s1,s2,operation);\n\treturn s[i][j];\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> W >> H;\n\t\tint x,y;\n\t\tstring st,res;\n\t\tif(W == 0)break;\n\t\tres = \"\";\n\t\tfor(int i = 0;i < 71;i++){\n\t\t\tfor(int j = 0;j <= 71;j++){\n\t\t\t\ts[i][j] = \".\";\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tif(c[i][j] >= '1' && c[i][j] <= '9'){\n\t\t\t\t\tsolve(i,j);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tif(s[i][j] == t)continue;\n\t\t\t\tres = max(res,s[i][j],operation);\n\t\t\t}\n\t\t}\t\t\n\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <vector>\n#include <algorithm>\nusing namespace std;\n\nstring strMax(string str1, string str2)\n{\n  if(str1.size() != str2.size())\n    return str1.size() > str2.size() ? str1 : str2;\n  string res = str1;\n  for(int i = 0; i < str1.size(); i++){\n    if(str1[i]-'0' == str2[i]-'0') continue;\n    res = str1[i]-'0' > str2[i]-'0' ? str1 : str2;\n    break;\n  }\n  return res;\n}\n\nbool comp(const string &a, const string &b)\n{\n  if(a.size() != b.size())\n    return a.size() > b.size();\n  for(int i = 0; i < a.size(); i++){\n    if(a[i]-'0' == b[i]-'0') continue;\n    return a[i]-'0' > b[i]-'0';\n  }\n}\n\nint main()\n{\n  while(1){\n    int W, H;\n    cin >> W >> H;\n    if(W == 0 && H == 0) break;\n    string C[H];\n    for(int i = 0; i < H; i++)\n      cin >> C[i];\n    \n    string dp[H+1][W+1];\n    for(int i = 0; i < H; i++)\n      for(int j = 0; j < W; j++)\n        dp[i][j] = C[i][j];\n    \n    for(int i = 1; i < W; i++)\n      if(C[0][i-1] != '0' && isdigit(C[0][i-1]) && isdigit(C[0][i]))\n        dp[0][i] = dp[0][i-1] + dp[0][i];\n    \n    for(int i = 1; i < H; i++)\n      if(C[i-1][0] != '0' && isdigit(C[i-1][0]) && isdigit(C[i][0]))\n        dp[i][0] = dp[i-1][0] + dp[i][0];\n    \n    for(int i = 1; i < H; i++){\n      for(int j = 1; j < W; j++){\n        if((!isdigit(C[i-1][j]) && !isdigit(C[i][j-1])) || !isdigit(C[i][j])) continue;\n        if(!isdigit(C[i-1][j]) && isdigit(C[i][j-1]))\n          dp[i][j] = dp[i][j-1] + dp[i][j];\n        else if(isdigit(C[i-1][j]) && !isdigit(C[i][j-1]))\n          dp[i][j] = dp[i-1][j] + dp[i][j];\n        else\n          dp[i][j] = strMax(dp[i-1][j] + dp[i][j], dp[i][j-1] + dp[i][j]);\n        if(dp[i][j][0] == '0') dp[i][j] = dp[i][j].substr(1);\n      }\n    }\n    \n    vector<string> v;\n    \n    if(isdigit(C[H-1][W-1])) v.push_back(dp[H-1][W-1]);\n    \n    for(int i = 0; i < H-1; i++)\n      if(!isdigit(C[i+1][W-1]) && isdigit(C[i][W-1])) v.push_back(dp[i][W-1]);\n    \n    for(int i = 0; i < W-1; i++)\n      if(!isdigit(C[H-1][i+1]) && isdigit(C[H-1][i])) v.push_back(dp[H-1][i]);\n    \n    for(int i = 0; i < H-1; i++)\n      for(int j = 0; j < W-1; j++)\n        if(!isdigit(C[i+1][j]) && !isdigit(C[i][j+1]) && isdigit(C[i][j]))\n          v.push_back(dp[i][j]);\n    \n    sort(v.begin(),v.end(),comp);\n    cout << v[0] << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n\nusing namespace std;\n\nstring dp[101][101];\n\nconst int dy[]={0,1};\nconst int dx[]={1,0};\n\nint w,h;\nchar field[101][101];\n\nstring maxString(string str1,string str2){\n\tstring res1=str1;\n\tstring res2=str2;\n\n\tif(str1==\"\"){\n\t\treturn str2;\n\t}\n\telse if(str2==\"\"){\n\t\treturn str1;\n\t}\n\n\t// ツ静ヲツ督ェツづ頚eroツづーツ湘つキ\n\tint idx1=str1.size()-1;\n\tfor(int i = 0; i < (int)(str1.size())-1; i++){\n\t\tif(str1[i]!='0'){\n\t\t\tidx1=i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tstr1=str1.substr(idx1);\n\n\tidx1=str2.size()-1;\n\tfor(int i = 0; i < (int)(str2.size())-1; i++){\n\t\tif(str2[i]!='0'){\n\t\t\tidx1=i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tstr2=str2.substr(idx1);\n\n\tif(str1.size()>str2.size())\n\t\treturn res1;\n\telse if(str1.size()<str2.size())\n\t\treturn res2;\n\telse{\n\t\tfor(int i = 0; i < str1.size(); i++){\n\t\t\tif(str1[i]>str2[i]){\n\t\t\t\treturn res1;\n\t\t\t}\n\t\t\telse if(str1[i]<str2[i]){\n\t\t\t\treturn res2;\n\t\t\t}\n\t\t}\n\t\treturn res1;\n\t}\n}\n\nstring dfs(int x,int y){\n\tif(dp[y][x]!=\"\")\n\t\treturn dp[y][x];\n\tif(!(field[y][x]>='0'&&field[y][x]<='9')){\n\t\treturn \"\";\n\t}\n\tstring res=\"\";\n\tfor(int i = 0; i < 2; i++){\n\t\tint ny=y+dy[i];\n\t\tint nx=x+dx[i];\n\t\tif(ny>=0&&nx>=0&&ny<h&&nx<w&&(field[ny][nx]>='0'&&field[ny][nx]<='9')){\n\t\t\tstring s=(dfs(nx,ny));\n\t\t\tif(s!=\"\")\n\t\t\t\tres=maxString(res,s);\n\t\t}\n\t}\n\tres=field[y][x]+res;\n\tdp[y][x]=res;\n\treturn res;\n}\n\nint main(){\n\n\twhile(cin>>w>>h&&!(w==0&&h==0)){\n\t\tfor(int i = 0; i < 101; i++){\n\t\t\tfor(int j =0; j < 101; j++){\n\t\t\t\tdp[i][j]=\"\";\n\t\t\t\tfield[i][j]=0;\n\t\t\t}\n\t\t}\n\n\t\tfor(int i = 0; i < h; i++){\n\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\tcin>>field[i][j];\n\t\t\t}\n\t\t}\n\t\tstring maxNum=\"\";\n\t\tfor(int i = 0; i < h; i++){\n\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\tstring res=dfs(j,i);\n\t\t\t\tif(res==\"\")\n\t\t\t\t\tcontinue;\n\t\t\t\tmaxNum=maxString(maxNum,res);\n\t\t\t}\n\t\t}\n\n\t\t// ツ静ヲツ督ェツづ頚eroツづーツ湘つキ\n\t\tif(maxNum!=\"\"&&maxNum[0]=='0'){\n\t\t\tint idx1=maxNum.size()-1;\n\t\t\tfor(int i = 0; i < (int)(maxNum.size())-1; i++){\n\t\t\t\tif(maxNum[i]!='0'){\n\t\t\t\t\tidx1=i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmaxNum=maxNum.substr(idx1);\n\t\t}\n\t\tcout<<maxNum<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n// region template\n#define rep(i, a, b) for (int i = (a); i < (b); ++i)\n#define trav(a, x) for (auto &a : x)\n#define all(x) begin(x), end(x)\n#define sz(x) (int)(x).size()\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\ntypedef vector<int> vi;\n\nll gcd(ll a, ll b) { return __gcd(a, b); }\n\nll euclid(ll a, ll b, ll &x, ll &y) {\n    if (b) { ll d = euclid(b, a % b, y, x);\n        return y -= a/b * x, d; }\n    return x = 1, y = 0, a;\n}\n\ntypedef unsigned long long ull;\ntypedef long double ld;\null mod_mul(ull a, ull b, ull M) {\n    ll ret = a * b - M * ull(ld(a) * ld(b) / ld(M));\n    return ret + M * (ret < 0) - M * (ret >= (ll)M);\n}\null mod_pow(ull b, ull e, ull mod) {\n    ull ans = 1;\n    for (; e; b = mod_mul(b, b, mod), e /= 2)\n        if (e & 1) ans = mod_mul(ans, b, mod);\n    return ans;\n}\n\nconst ll mod = 1000000007;\nstruct Mod {\n    ll x;\n    Mod(ll xx) : x(xx) {}\n    Mod operator+(Mod b) { return Mod((x + b.x) % mod); }\n    Mod operator-(Mod b) { return Mod((x - b.x) % mod); }\n    Mod operator*(Mod b) { return Mod((x * b.x) % mod); }\n    Mod operator/(Mod b) { return *this * invert(b); }\n    Mod invert(Mod a) {\n        ll x, y, g = euclid(a.x, mod, x, y);\n        assert(g == 1); return Mod((x + mod) % mod);\n    }\n    Mod operator^(ll e) {\n        if (!e) return Mod(1);\n        Mod r = *this ^ (e / 2); r = r * r;\n        return e & 1 ? *this * r : r;\n    }\n};\n// endregion\n\nstring smax(string a, string b) {\n    if (a.length() > b.length()) return a;\n    else if (a.length() < b.length()) return b;\n    else return a > b ? a : b;\n}\n\nchar grid[75][75];\nstring dp[75][75];\n\nint main() {\n    cin >> skipws;\n    for (;;) {\n        int w, h; cin >> w >> h; if (!w) break;\n        rep(i, 0, h) {\n            rep(j, 0, w) {\n                cin >> grid[i][j];\n                dp[i][j] = \"\";\n            }\n        }\n        rep(i, 0, h) {\n            rep(j, 0, w) if (isdigit(grid[i][j])) {\n                dp[i][j] = string(1, grid[i][j]);\n                if (i && dp[i - 1][j].length()) dp[i][j] = smax(dp[i][j], dp[i - 1][j] + grid[i][j]);\n                if (j && dp[i][j - 1].length()) dp[i][j] = smax(dp[i][j], dp[i][j - 1] + grid[i][j]);\n                if (dp[i][j] == \"0\") dp[i][j] = \"\";\n                // cout << i << \" \" << j << \" \" << dp[i][j] << endl;\n            }\n        }\n        string m = \"0\";\n        rep(i, 0, h) {\n            rep(j, 0, w) if (isdigit(grid[i][j])) {\n                m = smax(m, dp[i][j]);\n            }\n        }\n        cout << m << endl;\n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\n#include <ctype.h>\n#include <string> \n#include <cstring>\n#include <sstream>\n#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <map>\n#include <queue>\n#include <utility>\n#include <vector>\n#include <set>\n#include <iomanip>\n#include <stack>\n  \nusing namespace std;\n\n#define pi 3.141592653589793\n\n#define MAX 1000000000\n\nbool ismax(string comp1, string comp2)\n{\n\t// 第一引数の方が大きい場合true\n\twhile(comp1[0] == '0') comp1.erase(0, 1);\n\twhile(comp2[0] == '0') comp2.erase(0, 1);\n\tif(comp1.length() > comp2.length()) return true;\n\telse if(comp1.length() == comp2.length()){\n\t\tint n = 0;\n\t\twhile(n < comp1.length() && comp1[n] == comp2[n]){\n\t\t\tn++;\n\t\t}\n\t\tif(n == comp1.length() || comp1[n] - '0' > comp2[n] - '0') return true;\n\t\telse return false;\n\t} else return false;\n}\n\nstring solve(int w, int h, char c[71][71])\n{\n\tstring ans = \"\";\n\tstring result[72][72];\n\tresult[h][w] = \"\";\n\tif(isdigit(c[h][w])) result[h][w] += c[h][w];\n\tfor(int i = h; i > 0; i--){\n\t\tresult[i][w + 1] = \"\";\n\t}\n\tfor(int i = w; i > 0; i--){\n\t\tresult[h + 1][i] = \"\";\n\t}\n\tfor(int i = h; i > 0; i--){\n\t\tfor(int j = w; j > 0; j--){\n\t\t\tresult[i][j] = \"\";\n\t\t\tif(isdigit(c[i][j])){\n\t\t\t\tresult[i][j] += c[i][j];\n\t\t\t\tif(ismax(result[i + 1][j], result[i][j + 1])) result[i][j] += result[i + 1][j];\n\t\t\t\telse result[i][j] += result[i][j + 1];\n\t\t\t\tif(ismax(result[i][j], ans)) ans = result[i][j];\n\t\t\t}\n\t\t}\n\t}\n\twhile(ans[0] == '0') ans.erase(0, 1); \n\treturn ans;\n}\n\n\nint main()\n{\n\tint w, h;\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(w == 0 && h == 0) break;\n\t\tchar c[71][71];\n\t\tfor(int i = 1; i < h + 1; i++){\n\t\t\tfor(int j = 1; j < w + 1; j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t}\n\t\t}\n\t\tcout << solve(w, h, c) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <sstream>\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <ctime>\n#include <cstring>\n#include <climits>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <stack>\n#include <vector>\n#include <queue>\n#include <bitset>\n#include <string>\nusing namespace std;\n\n#define REP(i,n) for(int i=0; i<n; i++)\n#define RPA(i,s,e) for(int i=s; i<=e; i++)\n#define RPD(i,s,e) for(int i=s; i>=e; i--)\n#define PB(a) push_back(a)\n#define MP(i,s) make_pair(i,s)\n#define SZ(a) (int)(a).size()\n#define ALL(a) (a).begin(), (a).end()\n#define PRT(a) cerr << #a << \" = \" << (a) << endl\n#define PRT2(a,b) cerr << #a << \" = \" << (a) << \", \" << #b << \" = \" << (b) << endl\n#define PRT3(a,b,c) cerr << (a) << \", \" << (b) << \", \" << (c) << endl\n\ntypedef long long lint;\ntypedef vector<lint> vl;\ntypedef pair<lint,lint> pll;\n\nlint w, h;\nvector<string> mat;\n\nstring dp[80][80];\n\nbool digit(char c) {\n\treturn (c >= '0' && c <= '9');\n}\n\nvoid trim(string& s) {\n\tint i = 0;\n\twhile(s[i] == '0') i++;\n\ts = s.substr(i);\n}\n\nstring larger(string s1, string s2) {\n\ttrim(s1);\n\ttrim(s2);\n\tif(s1.size() != s2.size()) {\n\t\treturn s1.size() > s2.size() ? s1 : s2;\n\t}\n\treturn s1 > s2 ? s1 : s2;\n}\n\nvoid solve() {\n\tREP(y,h) REP(x,w) dp[y][x] = \"\";\n\tREP(x,w) {\n\t\tif(digit(mat[0][x])) {\n\t\t\tif(x == 0) dp[0][x] = mat[0][x];\n\t\t\telse dp[0][x] = dp[0][x-1] + mat[0][x];\n\t\t}\n\t}\n\n\tRPA(y,1,h-1) {\n\t\tREP(x,w) {\n\t\t\tif(!digit(mat[y][x])) continue;\n\n\t\t\tif(x == 0) {\n\t\t\t\tdp[y][x] = dp[y-1][x] + mat[y][x];\n\t\t\t} else {\n\t\t\t\tstring s1 = dp[y-1][x] + mat[y][x];\n\t\t\t\tstring s2 = dp[y][x-1] + mat[y][x];\n\t\t\t\tdp[y][x] = larger(s1, s2);\n\t\t\t}\n\t\t}\n\t}\n\n\tstring ans = \"\";\n\tREP(y,h) REP(x,w) ans = larger(ans, dp[y][x]);\n\ttrim(ans);\n\tcout << ans << endl;\n}\n\nvoid coding() {\n\twhile(cin>>w>>h, w|h) {\n\t\tmat = vector<string>(h);\n\t\tREP(y,h) cin >> mat[y];\n\t\tsolve();\n\t}\n}\n\n// #define _LOCAL_TEST\n\nint main() {\n#ifdef _LOCAL_TEST\n\tclock_t startTime = clock();\n\tfreopen(\"test.dat\", \"r\", stdin);\n#endif\n\n\tcoding();\n\n#ifdef _LOCAL_TEST\n\tclock_t elapsedTime = clock() - startTime;\n\tcout << endl;\n\tcout << (elapsedTime / 1000.0) << \" sec elapsed.\" << endl;\n\tcout << \"This is local test\" << endl;\n\tcout << \"Do not forget to comment out _LOCAL_TEST\" << endl << endl;\n#endif\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <complex>\n#include <deque>\n#include <exception>\n#include <fstream>\n#include <functional>\n#include <iomanip>\n#include <ios>\n#include <iosfwd>\n#include <iostream>\n#include <istream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <locale>\n#include <map>\n#include <memory>\n#include <new>\n#include <numeric>\n#include <ostream>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <stdexcept>\n#include <streambuf>\n#include <string>\n#include <typeinfo>\n#include <utility>\n#include <valarray>\n#include <vector>\n#include <climits>\n\n#define rep(i, m, n) for(int i=int(m);i<int(n);i++)\n//#define EACH(i, c) for (auto &(i): c)\n#define all(c) begin(c),end(c)\n//#define EXIST(s, e) ((s).find(e)!=(s).end())\n//#define SORT(c) sort(begin(c),end(c))\n//#define pb emplace_back\n//#define MP make_pair\n//#define SZ(a) int((a).size())\n\n//#define LOCAL 0\n//#ifdef LOCAL\n//#define DEBUG(s) cout << (s) << endl\n//#define dump(x)  cerr << #x << \" = \" << (x) << endl\n//#define BR cout << endl;\n//#else\n//#define DEBUG(s) do{}while(0)\n//#define dump(x) do{}while(0)\n//#define BR\n//#endif\n\n\n//改造\ntypedef long long int ll;\nusing namespace std;\n#define INF (1 << 30) - 1\n#define INFl (ll)5e15\n#define DEBUG 0 //デバッグする時1にしてね\n#define dump(x)  cerr << #x << \" = \" << (x) << endl\n#define MOD 1000000007\n//ここから編集する\nint W, H;\nvector<vector<char> > vv;\n\nbool isNum(char c) {\n    return c >= '0' && c <= '9';\n}\n\nstring cmp(string right, string left) {\n    if (right.size() > left.size()) {\n        return right;\n    } else if (right.size() < left.size()) {\n        return left;\n    } else {\n        rep(i, 0, right.size()) {\n            if (right[i] != left[i]) {\n                if (right[i] > left[i]) {\n                    return right;\n                } else {\n                    return left;\n                }\n            }\n        }\n    }\n    return right;\n}\n\nstring dfs(int h, int w, int len) {\n    if (h >= H || w >= W) return \"\";\n    if (isNum(vv[h][w])) {\n        if (len == 0 && vv[h][w] == '0') {\n            return \"\";\n        }\n        string right;\n        right += vv[h][w];\n        right += dfs(h, w + 1, len + 1);\n        string left;\n        left += vv[h][w];\n        left += dfs(h + 1, w, len + 1);\n\n        return cmp(right, left);\n    }\n    return \"\";\n}\n\nbool solve() {\n    cin >> W >> H;\n    if (W == 0 && H == 0) return false;\n\n//    vv.resize(H, vector<char>(W));\n    vv = vector<vector<char>>(H,vector<char>(W));\n    rep(i, 0, H) {\n        rep(j, 0, W) {\n            cin >> vv[i][j];\n        }\n    }\n\n    vector<string> kouho;\n    rep(i, 0, H) {\n        rep(j, 0, W) {\n            kouho.push_back(dfs(i, j, 0));\n        }\n    }\n\n    rep(i, 0, kouho.size()) {\n        rep(j, i + 1, kouho.size()) {\n            string big = cmp(kouho[i], kouho[j]);\n            if (big == kouho[j]) {\n                swap(kouho[i], kouho[j]);\n            }\n        }\n    }\n\n    cout << kouho[0] << endl;\n\n    return true;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while(solve()){\n\n    }\n\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n#include<cctype>\nusing namespace std;\n\n#define MAX 72\n#define INV (-1)\n\nstruct Dig{\n\tvector<char> s;\n\tvector< pair<int,int> > pos;\n\tvoid push( char c, int i, int j ){\n\t\ts.push_back( c );\n\t\tpos.push_back( make_pair(i,j) );\n\t}\n\tvoid pop(){\n\t\ts.pop_back();\n\t\tpos.pop_back();\n\t}\n\tvoid simplify(){\n\t\twhile( true ){\n\t\t\tif( s.size() == 1 )\n\t\t\t\tbreak;\n\t\t\tif( s[0] == '0' ){\n\t\t\t\ts.erase( s.begin() );\n\t\t\t}else\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tbool operator<(const Dig &t){\n\t\tif( s.size() < t.s.size() )\n\t\t\treturn true;\n\t\telse if( s.size() == t.s.size() ){\n\t\t\tfor(unsigned int i = 0; i < s.size(); ++i){\n\t\t\t\tif( s[i] < t.s[i] )\n\t\t\t\t\treturn true;\n\t\t\t\telse\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n};\n\nvector< Dig > vdigs;\n\nvoid dfs(char map[MAX][MAX], int i, int j, Dig &d){\n\tconst int di[] = {1,0};\n\tconst int dj[] = {0,1};\n\tif( !isdigit( map[i][j] ) )\n\t\treturn ;\n\tbool bCanGoNext = false;\n\tfor(int k=0;k<2;++k){\n\t\tif( isdigit(map[i + di[k]][j + dj[k]] ) ){\n\t\t\td.push( map[i][j], i, j );\n\t\t\tbCanGoNext = true;\n\t\t\tdfs( map, i + di[k], j + dj[k], d );\n\t\t\td.pop();\n\t\t}\n\t}\n\tif( !bCanGoNext ){\n\t\td.push( map[i][j], i , j );\n\t\tvdigs.push_back( d );\n\t\td.pop();\n\t}\n}\nvoid ResetMap(char map[MAX][MAX]){\n\tfor(int i = 0; i < MAX; ++i){\n\t\tfor( int j = 0; j < MAX; ++j){\n\t\t\tmap[i][j] = INV;\n\t\t}\n\t}\n}\ntemplate<typename _T>\nostream &operator << (ostream &os, const vector<_T> &v){\n\tfor(unsigned int i = 0; i < v.size(); ++i){\n\t\tos << v[i];\n\t}\n\treturn os;\n}\n\nint LCS(const Dig &a, const Dig &b){\n\tint ret = 0;\n\tint table[MAX][MAX] = {{0,},};\n\tfor(unsigned int i = 1; i <= a.pos.size(); ++i){\n\t\tfor(unsigned int j = 1; j <= b.pos.size(); ++j){\n\t\t\tif( a.pos[i-1] == b.pos[j-1] ){\n\t\t\t\ttable[i][j] = 1 + table[i-1][j-1];\n\t\t\t}else{\n\t\t\t\ttable[i][j] = max( table[i-1][j], table[i][j-1] );\n\t\t\t}\n\t\t\tret = max( ret, table[i][j] );\n\t\t}\n\t}\n\treturn ret;\n}\n\nint main(){\t\n\twhile(true){\n\t\tint max_lcs = 0;\n\t\tvector< vector<int> > lcs_table;\n\t\tint H,W;\n\t\tDig d;\n\t\tDig ans;\n\t\tchar map[MAX][MAX];\n\t\tvector< Dig > cands;\n\n\t\tcin >> W >> H;\n\t\t\n\t\tif( W == 0 && H == 0 ) break;\n\t\tvdigs.clear();\n\t\tResetMap( map );\n\t\tfor(int i = 1; i <= H; ++i){\n\t\t\tstring s;\n\t\t\tcin >> s;\n\t\t\tfor(int j = 1; j <= W; ++j){\n\t\t\t\tmap[i][j] = s[j-1];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 1; i <= H; ++i){\n\t\t\tfor(int j = 1; j <= W; ++j){\n\t\t\t\tif( isdigit(map[i-1][j]) || isdigit(map[i][j-1]) )\n\t\t\t\t\tcontinue;\n\t\t\t\tdfs( map, i, j, d );\n\t\t\t}\n\t\t}\n\n\t\tfor(unsigned int i = 0; i < vdigs.size(); ++i){\n\t\t\tvdigs[i].simplify();\n\t\t}\n\n\t\tfor(unsigned int i = 0; i < vdigs.size(); ++i){\n\t\t\tvector<int> lcss;\n\t\t\tfor(unsigned int j = i + 1; j < vdigs.size(); ++j){\n\t\t\t\tint t = LCS( vdigs[i], vdigs[j] );\n\t\t\t\tlcss.push_back( t );\n\t\t\t\tmax_lcs = max( max_lcs, t );\n\t\t\t}\n\t\t\tlcs_table.push_back( lcss );\n\t\t}\n\t\t\n\t\tans.s.push_back('0');\n\t\tfor(unsigned int i = 0; i < vdigs.size(); ++i){\n\t\t\tfor(unsigned int j = i + 1; j < vdigs.size(); ++j){\n\t\t\t\tif( max_lcs == lcs_table[i][j - i - 1] ){\n\t\t\t\t\tif( vdigs[i] < vdigs[j] ){\n\t\t\t\t\t\tif( ans < vdigs[j] )\n\t\t\t\t\t\t\tans = vdigs[j];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif( ans < vdigs[i] )\n\t\t\t\t\t\t\tans = vdigs[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans.s << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> P;\ntypedef vector<int> VI;\n \ntemplate<class T> bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T> bool chmin(T &a, const T &b) { if (a>b) { a=b; return 1; } return 0; }\n#define _overload3(_1,_2,_3,name,...) name\n#define _rep(i,n) repi(i,0,n)\n#define repi(i,a,b) for(int i=int(a);i<int(b);++i)\n#define rep(...) _overload3(__VA_ARGS__,repi,_rep,)(__VA_ARGS__)\n#define all(x) (x).begin(),(x).end()\nconst int mod=1e9+7;\n\nstring cmp(string a,string b){\n    a=regex_replace(a,regex(\"^0*\"),\"\");\n    b=regex_replace(b,regex(\"^0*\"),\"\");\n    int p=a.size();int q=b.size();\n    if(p>q)return a;\n    if(p<q)return b;\n    rep(i,p){\n        if((int)a[i]>b[i])return a;\n        if((int)a[i]<b[i])return b;\n    }\n    return a;\n}\n\nint main(){\n    while(true){\n    int w,h;cin>>w>>h;if(!w)break;\n    string s[h];\n    rep(i,h) cin>>s[i];\n    string dp[h+1][w+1];\n    rep(i,h) rep(j,w){\n        if((int)s[i][j]-'0'<0||(int)s[i][j]-'0'>9)continue;\n        dp[i+1][j+1]=cmp(dp[i][j+1],dp[i+1][j])+s[i][j];\n    }\n    string ans;\n    rep(i,h) rep(j,w){\n        ans=cmp(ans,dp[i+1][j+1]);\n    }\n    cout<<ans<<endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,n) for(int i=0;i<(n);++i)\n#define loop for(;;)\n#define trace(var) cerr<<\">>> \"<<#var<<\" = \"<<var<<endl;\n#define all(v) begin(v),end(v)\n#define pb push_back\n#define inf (1e9)\n#define eps (1e-9)\n\ntypedef long long Integer ;\ntypedef long double Real;\nconst Real PI = acosl(-1);\ntypedef pair<int, int> P;\n\ntemplate<class S, class T> inline\nostream& operator<<(ostream&os, pair<S,T> p) {\n  return os << '(' << p.first << \", \" << p.second << ')';\n}\n\ntemplate<class S, class T, class U> inline\nostream& operator<<(ostream&os, tuple<S,T,U> t) {\n  return os << '('\n    << get<0>(t) << \", \"\n    << get<1>(t) << \", \"\n    << get<2>(t) << ')';\n}\n\ntemplate<class T> inline\nostream& operator<<(ostream&os, set<T> v) {\n  os << \"(set\";\n  for (T item: v) os << ' ' << item;\n  os << \")\";\n  return os;\n}\n\ntemplate<class T> inline\nostream& operator<<(ostream&os, vector<T> v) {\n  if (v.size() == 0) { return os << \"(empty)\"; }\n  os << v[0];\n  for (int i=1, len=v.size(); i<len; ++i) os << ' ' << v[i];\n  return os;\n}\n\ntemplate<class T> inline\nistream& operator>>(istream&is, vector<T>&v) {\n  rep (i, v.size()) is >> v[i];\n  return is;\n}\n\n//           ^   >  v   <\nint dx[] = { -1, 0, 1,  0 };\nint dy[] = {  0, 1, 0, -1 };\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<bool> vb;\n\nchar f[100][100];\nbool usage[100][100];\n\nbool comp(string s, string t) {\n  if (s.size() != t.size()) return (s.size() < t.size());\n  rep (i, s.size()) if (s[i] != t[i]) return (s[i] < t[i]);\n  return true;\n}\n\nint main()\n{\n\n  int w, h;\n  while (cin >> w >> h, w and h)\n  {\n    rep (i, h) { rep (j, w) { cin >> f[i][j]; } }\n    rep (i, h) { rep (j, w) { usage[i][j] = false; } }\n\n    string ans = \"\";\n    rep (i, h) {\n      rep (j, w) {\n        if (usage[i][j]) continue;\n        char c = f[i][j];\n        if (isdigit(c) and c != '0') {\n          stack<pair<P, string>> s;\n          s.push(make_pair(make_pair(i, j), \"\"));\n\n          while (not s.empty()) {\n            auto p = s.top(); s.pop();\n            int i = p.first.first;\n            int j = p.first.second;\n            string str = p.second + f[i][j];\n            usage[i][j] = true;\n            bool ap = false;\n            if (i < h-1 and isdigit(f[i+1][j])) {\n              s.push(make_pair(make_pair(i+1, j), str));\n              ap = true;\n            }\n            if (j < w-1 and isdigit(f[i][j+1])) {\n              s.push(make_pair(make_pair(i, j+1), str));\n              ap = true;\n            }\n            if (not ap) {\n              if (comp(ans, str)) ans = str;\n            }\n          }\n\n        }\n      }\n    }\n\n    cout << ans << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\ninline bool r(char a) {\n   if (a >= '0' && a <= '9') return true;\n   else return false;\n}\n\ninline bool x(string a, string b) {\n    if (a.size() > b.size()) return true;\n    else if (a.size() == b.size() && a > b) return true;\n    else return false;\n}\n\nint main(void){\n    int w, h;\n    while (cin>>w>>h && w) {\n        vector<string> g(h);\n        for (int i = 0; i < h; i++) cin >> g[i];\n        \n        vector<vector<string> > dp(h, vector<string>(w));\n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n                if (r(g[i][j])) dp[i][j] = g[i][j];\n            }\n        }\n        \n        for (int i = h-1; i >= 0; i--) {\n            for (int j = w-1; j >= 0; j--) {\n                if (!r(g[i][j])) continue;\n                if (j-1 >= 0 && r(g[i][j-1])) {\n                    string t = g[i][j-1] + dp[i][j];\n                    if (x(t, dp[i][j-1])) dp[i][j-1] = t;\n                }\n                if (i-1 >= 0 && r(g[i-1][j])) {\n                    string t = g[i-1][j] + dp[i][j];\n                    if (x(t, dp[i-1][j])) dp[i-1][j] = t;\n                }\n            }\n        }\n        \n        string ans = \"\";\n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n                while (dp[i][j][0] == '0') dp[i][j].erase(dp[i][j].begin());\n                if (x(dp[i][j], ans)) ans = dp[i][j];\n            }\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <string>\n#include <sstream>\n#include <stack>\n#include <algorithm>\n#include <cmath>\n#include <queue>\n#include <map>\n#include <set>\n#include <cstdlib>\n#include <bitset>\n#include <tuple>\n#include <assert.h>\n#include <deque>\n#include <bitset>\n#include <iomanip>\n#include <limits>\n#include <chrono>\n#include <random>\n#include <array>\n#include <unordered_map>\n#include <functional>\n#include <complex>\n\ntemplate<class T> inline bool chmax(T& a, T b) { if (a < b) { a = b; return 1; } return 0; }\ntemplate<class T> inline bool chmin(T& a, T b) { if (a > b) { a = b; return 1; } return 0; }\n\nconstexpr long long MAX = 5100000;\nconstexpr long long INF = 1LL << 60;\nconstexpr int inf = 1 << 28;\nconstexpr long long mod = 1000000007LL;\n//constexpr long long mod = 998244353LL;\n\nusing namespace std;\ntypedef unsigned long long ull;\ntypedef long long ll;\n\n\nll H, W;\nvector<string> vs;\nvector<vector<string>> dp;\nstring dfs(ll h, ll w) {\n\tif (dp[h][w] != \"\") return dp[h][w];\n\tstring tmp;\n\tif (h + 1 < H && vs[h+1][w] >= '0' && vs[h+1][w] <= '9') {\n\t\tstring a = dfs(h + 1, w);\n\t\tif (tmp.size() < a.size()) {\n\t\t\ttmp = a;\n\t\t}else if(tmp.size() == a.size() && tmp < a){\n\t\t\ttmp = a;\n\t\t}\n\t}\n\tif (w + 1 < W && vs[h][w + 1] >= '0' && vs[h][w + 1] <= '9') {\n\t\tstring a = dfs(h, w + 1);\n\t\tif (tmp.size() < a.size()) {\n\t\t\ttmp = a;\n\t\t}\n\t\telse if (tmp.size() == a.size() && tmp < a) {\n\t\t\ttmp = a;\n\t\t}\n\t}\n\tstring res;\n\tres += vs[h][w];\n\tres += tmp;\n\treturn dp[h][w] = res;\n}\n\nint main()\n{\n\t/*\n\tcin.tie(nullptr);\n\tios::sync_with_stdio(false);\n\t*/\n\tint kkt = 89;\n\twhile (kkt) {\n\t\tcin >> W >> H; if (H == 0) break;\n\t\tvs.resize(H); for (int i = 0; i < H; i++) cin >> vs[i];\n\t\tdp = vector<vector<string>>(H, vector<string>(W));\n\t\tstring res;\n\t\tfor (int i = 0; i < H; i++) for (int j = 0; j < W; j++) {\n\t\t\tif (vs[i][j] >= '1' && vs[i][j] <= '9') {\n\t\t\t\tstring tmp = dfs(i, j);\n\t\t\t\tif (res.size() < tmp.size()) res = tmp;\n\t\t\t\telse if (res.size() == tmp.size() && res < tmp) res = tmp;\n\t\t\t}\n\t\t}\n\t\tcout << res << \"\\n\";\n\t}\n\treturn 0;\n\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cctype>\nusing namespace std;\n\nbool compare(string s1,string s2){\n  if(s1.size()>s2.size())return true;\n  if(s1.size()<s2.size())return false;\n  for(int i=0;i<s1.size();i++){\n    if(s1[i]>s2[i])return true;\n    if(s1[i]<s2[i])return false;\n  }\n  return false;\n}\n\nint main()\n{\n  int W,H;\n  char C[70][70];\n  string max,dp[70][70];\n  while(cin>>W>>H,W|H){\n    max=\"\";\n    for(int i=0;i<H;i++)for(int j=0;j<W;j++){\n      cin>>C[i][j];\n      dp[i][j]=\"\";\n    }\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\tif(isalpha(C[i][j]))continue;\n\tstring above,left;\n\tabove=left=\"\";\n\tif(i>0 && dp[i-1][j]!=\"0\")above=dp[i-1][j]+C[i][j];\n\tif(j>0 && dp[i][j-1]!=\"0\")left=dp[i][j-1]+C[i][j];\n\tif( compare(above,left) ){\n\t  dp[i][j]=above;\n\t}else{\n\t  dp[i][j]=left;\n\t}\n\tif( compare(dp[i][j], max) ){\n\t  max=dp[i][j-1]+C[i][j];\n\t}\n      }\n    }\n    cout<<max<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <functional>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <vector>\n#include <list>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <bitset>\n#include <climits>\n\n#define all(c) (c).begin(), (c).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define pb(e) push_back(e)\n#define mp(a, b) make_pair(a, b)\n#define fr first\n#define sc second\n\nconst int INF=100000000;\nint dx[4]={1,0,-1,0};\nint dy[4]={0,1,0,-1};\nusing namespace std;\ntypedef pair<int ,int > P;\ntypedef long long ll;\n\nint W,H;\n\nbool flag[70][70][70];\nstring dp[70][70][70];\nstring mat[70];\n\nstring max_str(const string& s1, const string& s2) {\n    if(s1.size() == s2.size()) {\n        return s1 > s2?s1:s2;\n    }\n    else return s1.size() > s2.size() ? s1 : s2;\n}\nstring dfs(int y, int x,int c) {\n    if(flag[y][x][c]) return dp[y][x][c];\n    string res=\"\";\n\n    rep(i,2) {\n        int ny=y+dy[i];\n        int nx=x+dx[i];\n        if(!(0<=ny&&ny<H)) continue;\n        if(!(0<=nx&&nx<W)) continue;\n        if(!('0'<=mat[ny][nx]&&mat[ny][nx]<='9')) continue;\n        res=max_str(res,mat[ny][nx]+dfs(ny,nx,c+1));\n\n    }\n\n    flag[y][x][c]=true;\n    return dp[y][x][c]=res;\n}\n\nvoid solve() {\n    rep(i,70) {\n        mat[i]=\"\";\n        rep(j,70) rep(a,70) {\n            dp[i][j][a]=\"\";\n            flag[i][j][a]=false;\n        }\n    }\n\n    rep(i,H) cin>>mat[i];\n\n    string ans=\"\";\n\n    rep(i,H) rep(j,W) if('1'<=mat[i][j]&&mat[i][j]<='9') {\n        string s=\"a\";\n        s[0]=mat[i][j];\n        ans=max_str(ans,s+dfs(i,j,0));\n    }\n\n    cout<<ans<<endl;\n}\n\nint main() {\n    while(cin>>W>>H) {\n        if(W+H==0) break;\n        solve();\n\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n\n\nusing namespace std;\n\nint const N = 71;\nchar table[N][N] = {};\nbool vd[N][N] = {};\n\nvoid clear() {\n    for( int i=0; i<N; ++i )\n        for( int j=0; j<N; ++j ) {\n            table[i][j] = 0;\n            vd[i][j] = false;\n        }\n}\n\nint const dir[][2] = {{1,0}, {0, 1}};\nvoid find( vector<string>& ss, string& s, int const x, int const y, int const w, int const h )\n{\n    s += table[x][y];\n    vd[x][y] = true;\n\n    for( int i=0; i<2; ++i ) {\n        int const nx = x + dir[i][0];\n        int const ny = y + dir[i][1];\n        if ( nx < 0 || ny < 0 || nx >= w || ny >= h )\n            continue;\n        \n        if ( table[nx][ny] >= '0' && table[nx][ny] <= '9' ) {\n//            string copied = s;\n            find( ss, s, nx, ny, w, h );\n        }\n    }\n\n    ss.push_back( s );\n    s.erase( s.end() - 1 );\n}\n\ntemplate<typename T>\nstruct bun\n{\n    bool operator()( T const& l, T const& r ) {\n        return l.size() > r.size() || (l.size() == r.size() && l > r);\n    }\n};\n\nint main()\n{\n    for(;;) {\n        int w, h;\n        cin >> w >> h;\n        if ( w == 0 && h == 0 )\n            break;\n\n        clear();\n        for( int y=0; y<h; ++y ) {\n            string s;\n            cin >> s;\n            for( int iii=0; iii<s.size(); ++iii ) {\n                table[iii][y] = s[iii];\n            }\n        }\n\n        vector<string> ss;\n        for( int x=0; x<N; ++x ) {\n            for( int y=0; y<N; ++y ) {\n                string s;\n                if ( table[x][y] >= '1' && table[x][y] <= '9' && !vd[x][y] ) {\n                    find( ss, s, x, y, w, h );\n                }\n            }\n        }\n        stable_sort( ss.begin(), ss.end(), bun<string>() );\n\n        //for( int i=0; i<ss.size(); ++i )\n            //cout << ss[i] << endl;\n        //    ;\n\n\n        cout << ss[0] << endl;\n        //cout << \"======\" << endl;\n    };\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\n//#define int int64_t\n\n#define CHOOSE(a) CHOOSE2 a\n#define CHOOSE2(a0,a1,a2,a3,x,...) x\n#define REP1(i, s, cond, cal) for (signed i = signed(s); i cond; i cal)\n#define REP2(i, s, n) REP1(i, s, < signed(n), ++)\n#define REP3(i, n) REP2(i, 0, n)\n#define rep(...) CHOOSE((__VA_ARGS__,REP1,REP2,REP3))(__VA_ARGS__)\n\n#define all(c) begin(c), end(c)\n#define maxup(ans, x) (ans = (ans < x ? x : ans))\n#define minup(ans, x) (ans = (ans > x ? x : ans))\n\n#define breakif(cond) if(cond) break; else\n\ntemplate<typename T>\ninline void input(vector<T>& v) { for (auto& x : v) cin >> x; }\n\nusing VV = vector<vector<int>>;\nusing V = vector<int>;\nusing P = pair<int, int>;\nusing IP = pair<int, P>;\n\nconst int INF = 1 << 29;\n\nsigned main() {\n\tint w, h;\n\twhile (cin >> w >> h && w) {\n\t\tVV data(h, V(w));\n\t\trep(i, h) rep(j, w) {\n\t\t\tchar c; cin >> c;\n\t\t\tif (c < '0' || c > '9') data[i][j] = -1;\n\t\t\telse data[i][j] = c - '0';\n\t\t}\n\t\tvector<vector<string>> dp(h, vector<string>(w));\n\t\tauto comp = [](string& a, string& b) {\n\t\t\treturn a.size() != b.size() ? a.size() < b.size()\n\t\t\t\t: a < b;\n\t\t};\n\t\tstring ans = \"\";\n\t\trep(i, h) rep(j, w) {\n\t\t\tstring a = to_string(data[i][j]);\n\t\t\tstring b = a;\n\t\t\tif (a == \"-1\") continue;\n\t\t\tif (i - 1 >= 0 && dp[i - 1][j] != \"-1\") a = dp[i - 1][j] + to_string(data[i][j]);\n\t\t\tif (j - 1 >= 0 && dp[i][j - 1] != \"-1\") b = dp[i][j - 1] + to_string(data[i][j]);\n\t\t\tstring x = comp(a, b) ? b : a;\n\t\t\tif (x != \"0\") {\n\t\t\t\tdp[i][j] = x;\n\t\t\t\tif (comp(ans, x)) ans = x;\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <deque>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n\nusing namespace std;\n\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v;}\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout << x; return sout.str();}\n\ntypedef vector<int> vi;\ntypedef vector<vi>  vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EACH(t,i,c) for(t::iretator i=(c).begin(); i!=(c).end(); ++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n) FOR(i,0,n)\n\nconst double EPS = 1e-10;\n\nint main() {\n\tint w, h;\n\n\twhile(cin >> w >> h, w) {\n\t\tvector<vector<char> > field (h+1, vector<char>(w+1));\n\t\tvector<vector<ll> > num(h+1, vector<ll>(w+1));\n\n\t\tstring str;\n\t\tREP(i, h) {\n\t\t\tcin >> str;\n\t\t\tREP(j, str.size()) {\n\t\t\t\tfield[i+1][j+1] = str[j];\n\t\t\t}\n\t\t}\n\n\t\tFOR(i, 1, h+1) {\n\t\t\tif(isdigit(field[i][1])) {\n\t\t\t\tnum[i][1] = field[i][1]-'0';\n\t\t\t}\n\t\t}\n\n\t\tFOR(j, 1, w+1) {\n\t\t\tFOR(i, 1, h+1) {\n\t\t\t\tif(isdigit(field[i][j])) {\n\t\t\t\t\tint n = field[i][j]-'0';\n\t\t\t\t\tll num1 = num[i-1][j]*10 + n;\n\t\t\t\t\tll num2 = num[i][j-1]*10 + n;\n\n\t\t\t\t\tnum[i][j] = num1>num2 ? num1: num2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tll max = 0;\n\n\t\tFOR(j, 1, w+1) {\n\t\t\tFOR(i, 1, h+1) {\n\t\t\t\tif(max < num[i][j]) {\n\t\t\t\t\tmax = num[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << max << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "const int INF = 100000000;\ntypedef double D;\nconst double EPS = 1e-8;\nconst double PI = 3.14159;\nint dx[4]={-1, 0, 1, 0}, dy[4]={0, -1, 0, 1};\nusing namespace std;\ntypedef pair<int, int> P;\n\n/** Problem1126 : The Secret Number **/\nconst int MAX_W = 70;\nint W, H;\nchar field[MAX_W][MAX_W];\nstring dp[MAX_W][MAX_W];\n\nbool big(string s1, string s2) {\n\tif (s1.length() > s2.length()) {\n\t\treturn true;\n\t} else if (s2.length() > s1.length()) {\n\t\treturn false;\n\t} else {\n\t\treturn (s1>s2?true:false);\n\t}\n}\n\nbool big2(string s1, string s2) {\n\twhile (s1[0]=='0') s1.erase(s1.begin());\n\twhile (s2[0]=='0') s2.erase(s2.begin());\n\treturn big(s1, s2);\n}\n\nstring rec(int x, int y)\n{\n\tif (!('0' <= field[y][x] && field[y][x] <= '9'))\n\t\treturn dp[y][x] = \"\";\n\t\n\tstring s1 = field[y][x] + dp[y][x+1];\n\tstring s2 = field[y][x] + dp[y+1][x];\n\t\n\treturn dp[y][x] = (big(s1, s2)?s1:s2);\n}\n\nint main()\n{\n\twhile (cin>>W>>H, W||H) {\n\t\tfill(dp[0], dp[0]+W*H, \"\");\n\t\t\n\t\trep(i, H) {\n\t\t\trep(j, W) {\n\t\t\t\tcin>>field[i][j];\n\t\t\t}\n\t\t}\n\t\t\n\t\tstring ans = \"0\";\n\t\trep(y, H) {\n\t\t\trep(x, W) {\n\t\t\t\tstring tmp = rec(W-x-1, H-y-1);\n\t\t\t\tans = (big2(ans, tmp)?ans:tmp);\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\twhile (ans[0]=='0') ans.erase(ans.begin());\n\t\t\n\t\tcout << (ans!=\"\"?ans:\"0\") << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include \"iostream\"\n#include \"climits\"\n#include \"list\"\n#include \"queue\"\n#include \"stack\"\n#include \"set\"\n#include \"functional\"\n#include \"algorithm\"\n#include \"string\"\n#include \"map\"\n#include \"unordered_map\"\n#include \"unordered_set\"\n#include \"iomanip\"\n#include \"cmath\"\n#include \"random\"\n#include \"bitset\"\n#include \"cstdio\"\n#include \"numeric\"\n#include \"cassert\"\n#include \"ctime\"\n\nusing namespace std;\n\nconstexpr long long int MOD = 1000000007;\n//constexpr int MOD = 1000000007;\n//constexpr int MOD = 998244353;\n//constexpr long long int MOD = 998244353;\nconstexpr double EPS = 1e-12;\n\n//int N, M, K, T, H, W, L, R;\nlong long int N, M, K, T, H, W, L, R;\n\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\n\twhile (cin >> W >> H, H) {\n\t\tvector<string>field(H);\n\t\tfor (auto &i : field)cin >> i;\n\t\tvector<vector<string>>dp(H, vector<string>(W, \"\"));\n\t\tstring ans;\n\t\tfor (int i = 0; i < H; i++) {\n\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\tif (field[i][j] >= '0'&&field[i][j] <= '9') {\n\t\t\t\t\tstring add;\n\t\t\t\t\tadd.push_back(field[i][j]);\n\t\t\t\t\tif (field[i][j]!='0'&&dp[i][j].empty())dp[i][j].push_back(field[i][j]);\n\t\t\t\t\tif (i - 1 >= 0) {\n\t\t\t\t\t\tif ((dp[i - 1][j] + add).size() > dp[i][j].size() || ((dp[i - 1][j] + add) > dp[i][j] && (dp[i - 1][j] + add).size() == dp[i][j].size())) {\n\t\t\t\t\t\t\tdp[i][j] = (dp[i - 1][j] + add);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (j - 1 >= 0) {\n\t\t\t\t\t\tif ((dp[i][j - 1] + add).size() > dp[i][j].size() || ((dp[i][j - 1] + add) > dp[i][j]) && (dp[i][j - 1] + add).size() == dp[i][j].size()) {\n\t\t\t\t\t\t\tdp[i][j] = (dp[i][j - 1] + add);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (dp[i][j] == \"0\")dp[i][j].clear();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (auto i : dp) {\n\t\t\tfor (auto j : i) {\n\t\t//\t\tcout << j << \" \";\n\t\t\t\tif (ans.size() < j.size())ans = j;\n\t\t\t\telse if (ans.size() == j.size() && ans < j)ans = j;\n\t\t\t}\n\t\t//\tcout << endl;\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\nconst int N = 71;\nusing namespace std;\nstring judge(string,string);\nint main(){\n  int w,h,i,j,lenmax,flag;\n  string str[N],dp[N][N],which,out;\n  while(1){\n    cin >> w >> h;\n    if(w==0&&h==0) break;\n    for(i=0;i<=h;i++){\n      for(j=0;j<=w;j++){\n\tdp[i][j]=\"0\";\n      }\n    }\n    for(i=0;i<=w;i++) str[0]+='X';\n    for(i=1;i<=h;i++){\n      cin >> str[i];\n      str[i]='X'+str[i];\n    }\n    for(i=1;i<=h;i++){\n      for(j=1;j<=w;j++){\n\tif('0'<=str[i][j]&&str[i][j]<='9'){\n\t  if(dp[i-1][j]==\"0\"&&dp[i][j-1]==\"0\"){\n\t    dp[i][j]=str[i][j];\n\t  }\n\t  else if(dp[i-1][j]==\"0\") dp[i][j]=dp[i][j-1]+str[i][j];\n\t  else if(dp[i][j-1]==\"0\") dp[i][j]=dp[i-1][j]+str[i][j];\n\t  else{\n\t    if(dp[i-1][j].size()==dp[i][j-1].size()){\n\t      which=judge(dp[i-1][j],dp[i][j-1]);\n\t      dp[i][j]=which+str[i][j];\n\t    }\n\t    else if(dp[i-1][j].size()>dp[i][j-1].size()) dp[i][j]=dp[i-1][j]+str[i][j];\n\t    else dp[i][j]=dp[i][j-1]+str[i][j];\n\t  }\n\t}\n      }\n    }\n    int len;\n    lenmax=0;\n    for(i=1;i<=h;i++){\n      for(j=1;j<=w;j++){\n\tlen=dp[i][j].size();\n\tlenmax=max(lenmax,len);\n      }\n    }\n    flag=0;\n    for(i=1;i<=h;i++){\n      for(j=1;j<=w;j++){\n\tif(flag==0&&dp[i][j].size()==lenmax){\n\t  flag=1;\n\t  out=dp[i][j];\n\t}\n\telse if(flag==1&&dp[i][j].size()==lenmax){\n\t  which=judge(out,dp[i][j]);\n\t  out=which;\n\t}\n      }\n    }\n    cout << out << endl;\n  }\n  return 0;\n}\nstring judge(string a,string b){\n  int flag=0,len=a.size(),i;\n  for(i=0;i<len;i++){\n    if(a[i]>b[i]){\n      flag=1;\n      break;\n    }\n    else if(a[i]<b[i]){\n      flag=2;\n      break;\n    }\n  }\n  if(flag==0||flag==1) return a;\n  else return b;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <limits.h>\n#include <map>\n#include <math.h>\n#include <numeric>\n#include <set>\n#include <stack>\n#include <stdlib.h>\n#include <string>\n#include <vector>\n#define el endl\n#define fd fixed\n#define INF INT_MAX/2-1\n#define pb push_back\n#define mp make_pair\n#define sp fd << setprecision\nusing namespace std;\nint dx[] = {1, 0, -1, 0}, dy[] = {0, 1, 0, -1};\ntypedef vector<int> VI;\ntypedef vector<vector<int> > VVI;\ntypedef vector<string> VS;\n\nvector<string> ans;\nbool memo[70][70];\n\nvoid search(VVI code, int i, int j, string tmp, int w, int h) {\n  if (code[i][j] < 0) return;\n  tmp += (char)(code[i][j]+48);\n  memo[i][j] = true;\n  if ((i < h-1 && j < w-1 && code[i+1][j] < 0 && code[i][j+1] < 0) || (i < h-1 && j == w-1 && code[i+1][j] < 0) || (i == h-1 && j < w-1 && code[i][j+1]) || (i == h-1 && j == w-1)) ans.pb(tmp);\n  if (i < h-1 && !memo[i+1][j]) search(code, i+1, j, tmp, w, h);\n  if (j < w-1 && !memo[i][j+1]) search(code, i, j+1, tmp, w, h);\n}\n\nint main() {\n  int w, h;\n  while (cin >> w >> h, w | h) {\n    VVI code;\n    string s;\n    ans.clear();\n    for (int i = 0; i < 70; i++) {\n      for (int j = 0; j < 70; j++) {\n        memo[i][j] = false;\n      }\n    }\n    for (int i = 0; i < h; i++) {\n      VI tv;\n      cin >> s;\n      for (int j = 0; j < s.length(); j++) {\n        int tn = (int)(s[j]-'0');\n        if (0 <= tn && tn <= 9) {\n          tv.pb(tn);\n        } else {\n        tv.pb(-1);\n        }\n      }\n      code.pb(tv);\n    }\n    for (int i = 0; i < h; i++) {\n      for (int j = 0; j < w; j++) {\n        if (!memo[i][j]) search(code, i, j, \"\", w, h);\n      }\n    }\n    int max_digit = 0;\n    string max_num = \"\";\n    for (int i = 0; i < ans.size(); i++) {\n      if (max_digit < ans[i].length()) max_num = ans[i], max_digit = ans[i].length();\n    }\n    if (max_num[0] == '0') max_num.erase(max_num.begin());\n    cout << max_num << el;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double ld;\ntypedef pair<ll, ll> P;\n\n#define EACH(i,a) for (auto& i : a)\n#define FOR(i,a,b) for (ll i=(a);i<(b);i++)\n#define RFOR(i,a,b) for (ll i=(b)-1;i>=(a);i--)\n#define REP(i,n) for (ll i=0;i<(n);i++)\n#define RREP(i,n) for (ll i=(n)-1;i>=0;i--)\n#define debug(x) cout<<#x<<\": \"<<x<<endl\n#define pb push_back\n#define ALL(a) (a).begin(),(a).end()\n\nconst ll linf = 1e18;\nconst int inf = 1e9;\nconst double eps = 1e-12;\nconst double pi = acos(-1);\n\ntemplate<typename T>\nistream& operator>>(istream& is, vector<T>& vec) {\n\tEACH(x,vec) is >> x;\n\treturn is;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, vector<T>& vec) {\n\tREP(i,vec.size()) {\n\t\tif (i) os << \" \";\n\t\tos << vec[i];\n\t}\n\treturn os;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, vector< vector<T> >& vec) {\n\tREP(i,vec.size()) {\n\t\tif (i) os << endl;\n\t\tos << vec[i];\n\t}\n\treturn os;\n}\n\nint dx[2] = {1, 0};\nint dy[2] = {0, 1};\n\nint W, H;\nvector<string> m;\nbool m1[100][100] = {0};\nstring m2[100][100];\nstring beautify(string s) {\n\tif (s.size() == 0) return \"\";\n\tint l = (int)s.size()-1;\n\tREP(i,s.size()) {\n\t\tif (s[i] != '0') {\n\t\t\tl = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn s.substr(l, s.size()-l);\n}\nbool gt(string s1, string s2) {\n\tbool r = s1.size() > s2.size();\n\ts1 = beautify(s1);\n\ts2 = beautify(s2);\n\tif (s1.size() == s2.size()) {\n\t\tif (s1 == s2) {\n\t\t\treturn r;\n\t\t}\n\t\treturn s1 > s2;\n\t}\n\treturn s1.size() > s2.size();\n}\nstring dp(int x, int y) {\n\tstring res = \"\";\n\tif (x < 0 || x >= W || y < 0 || y >= H) return \"\";\n\tif ( !isdigit(m[y][x]) ) return \"\";\n\tif (m1[y][x]) return m2[y][x];\n\tREP(i, 2) {\n\t\tint nx = x + dx[i];\n\t\tint ny = y + dy[i];\n\t\tstring a = \"\"; a += m[y][x];\n\t\ta += dp(nx, ny);\n\t\tif ( gt(a, res) ) res = a;\n\t}\n\treturn m1[y][x] = true, m2[y][x] = res;\n}\n\n\nint main() {\n\tstd::ios::sync_with_stdio(false);\n\tstd::cin.tie(0);\n\twhile (cin >> W >> H, W || H) {\n\t\tm.resize(H); cin >> m;\n\t\tfill(m1[0], m1[100], false);\n\t\tstring ans = \"0\";\n\t\tREP(y, H) REP(x, W) {\n\t\t\tif ( gt( dp(x, y), ans ) ) ans = beautify( dp(x, y) );\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stdio.h>\n#include<string>\nusing namespace std;\nint H,W;\nchar t[700][700],ch;\n\nstring dp[700][700],maxm;\n\nstring strmax(string x,string y){\n  if(x==\"-\"&&y==\"-\")return \"=\";\n  if(x==\"-\")return y;\n  if(y==\"-\")return x;\n  while(x[0]=='0'&&x.size()>=2)x=x.substr(1,x.size()-1);\n  while(y[0]=='0'&&y.size()>=2)y=y.substr(1,y.size()-1);\n  if(x.size()==y.size()){\n    for(int i=0;i<(int)x.size();i++){\n      if(x[i]>y[i]){\n\treturn x;\n      }else if(x[i]<y[i]){\n\treturn y;\n      }\n    }\n    return x;\n  }else if(x.size()>y.size()){\n    return x;\n  }else{\n    return y;\n  }\n}\n\nchar judge(char ch){\n  if('0'<=ch&&ch<='9')return ch;\n  else return '-';\n}\nint main(){\n  int flg;\n  while(cin>>W>>H&&W&&H){\n    scanf(\"%c\",&t[0][0]);\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\tdp[i][j]=\"\";\n\tscanf(\"%c\",&t[i][j]);\n\tif(judge(t[i][j])=='-')flg++;\n      }\n      scanf(\"%c\",&ch);\n    }\n   \n    dp[0][0].push_back(judge(t[0][0])); \n\n    for(int i=1;i<W;i++){\n      if(judge(t[0][i])=='-'){\n\tdp[0][i]=\"-\";\n\tcontinue;\n      }\n      if(dp[0][i-1]!=\"-\")dp[0][i]=dp[0][i-1];      \n      dp[0][i].push_back(judge(t[0][i]));\n    }\n    for(int i=1;i<H;i++){\n      if(judge(t[i][0])=='-'){\n\tdp[i][0]=\"-\";\n\tcontinue;\n      }\n      if(dp[i-1][0]!=\"-\")dp[i][0]=dp[i-1][0];      \n      dp[i][0].push_back(judge(t[i][0]));\n    }\n\n    maxm=\"0\";\n    for(int i=1;i<H;i++){\n      for(int j=1;j<W;j++){\n\tif(judge(t[i][j])=='-'){\n\t  dp[i][j]=\"0\";\n\t  continue;\n\t}\n\t\n\tdp[i][j]=strmax(dp[i-1][j],dp[i][j-1]);\n\tif(dp[i][j]!=\"-\")dp[i][j].push_back(t[i][j]);\n\t\n\n      }\n    }\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\t//cout<<dp[i][j]<<endl;\n\tmaxm=strmax(dp[i][j],maxm);\n      }\n    }\n    cout<<maxm<<endl;\n    \n  }\n  return 0;\n  \n}"
  },
  {
    "language": "C++",
    "code": "//The Secret Number\n#include<bits/stdc++.h>\nusing namespace std;\n\nint H, W;\nint mp[1000][1000];\nstring dp[1000][1000];\n\nstring max_comp(string s1, string s2){\n  if(s1.length() > s2.length())return s1;\n  if(s1.length() < s2.length())return s2;\n\n  for(int i=0; i<s1.length(); i++){\n    if(s1[i] > s2[i])return s1;\n    if(s1[i] < s2[i])return s2;\n  }\n  return s1; //??????\n}\n\nint main(){\n  while(cin >> W >> H, !(H==0 && W==0)){\n    //??\\???\n    for(int i=0; i<H; i++){\n      for(int j=0; j<W; j++){\n\tchar tmp;\n\tcin >> tmp;\n\tif('0'<=tmp && tmp<='9')mp[i][j] = tmp-'0';\n\telse mp[i][j] = -1;\n      }\n    }\n\n    //?????????\n    for(int i=0; i<H; i++)\n      for(int j=0; j<W; j++)\n\tdp[i][j]=\"\";\n\n    if(mp[H-1][W-1]!=-1)dp[H-1][W-1].insert(dp[H-1][W-1].begin(), mp[H-1][W-1]+'0');\n\n    for(int i=H-2; i>=0; i--){\n      if(mp[i][W-1] != -1){\n\tstring tmp = dp[i+1][W-1];\n\ttmp.insert(tmp.begin(), mp[i][W-1]+'0');\n\tdp[i][W-1] = tmp;\n      }\n    }\n    for(int j=W-2; j>=0; j--){\n      if(mp[H-1][j] != -1){\n\tstring tmp = dp[H-1][j+1];\n\ttmp.insert(tmp.begin(), mp[H-1][j]+'0');\n\tdp[H-1][j] = tmp;\n      }\n    }\n\n    //???????¨???????\n    for(int i=H-2; i>=0; i--){\n      for(int j=W-2; j>=0; j--){\n\tif(mp[i][j]==-1)continue; //??????????????????\n\tstring tmp1 = dp[i+1][j], tmp2 = dp[i][j+1];\n\ttmp1.insert(tmp1.begin(), mp[i][j]+'0');\n\ttmp2.insert(tmp2.begin(), mp[i][j]+'0');\n\tdp[i][j] = max_comp(tmp1, tmp2);\n      }\n    }\n\n    string ans = \"\";\n    for(int i=0; i<H; i++)\n      for(int j=0; j<W; j++)\n\tans = max_comp(ans, dp[i][j]);\n\n    while(ans[0]=='0')ans.erase(ans.begin());\n\n    if(ans==\"\")cout << \"0\" << endl;\n    else cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstring max_num(string l, string r) {\n    if (l.size() != r.size()) {\n        if (l.size() < r.size()) return r;\n        return l;\n    }\n    if (l < r) return r;\n    return l;\n}\n\nint main() {\n    int W, H;\n    while (cin >> W >> H, W) {\n        vector<string> mat(H);\n        for (int i = 0; i < H; ++i) { cin >> mat[i]; }\n\n        string secret = \"\";\n        vector<vector<string>> dp(H + 1, vector<string>(W + 1, \"\"));\n        for (int i = 0; i < H; ++i) {\n            for (int j = 0; j < W; ++j) {\n                if (isalpha(mat[i][j])) continue;\n\n                string t = string(1, mat[i][j]);\n                if (dp[i][j + 1] != \"0\") {\n                    t = max_num(t, dp[i][j + 1] + string(1, mat[i][j]));\n                }\n                if (dp[i + 1][j] != \"0\") {\n                    t = max_num(t, dp[i + 1][j] + string(1, mat[i][j]));\n                }\n                dp[i + 1][j + 1] = t;\n                secret = max_num(secret, t);\n            }\n        }\n        cout << secret << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\n#include <ctype.h>\n#include <string> \n#include <sstream>\n#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <map>\n#include <queue>\n#include <utility>\n#include <vector>\n#include <set>\n#include <list>\n#include <cstring>\n#include <stack>\n   \nusing namespace std;\n\nint w, h;\nchar c[71][71];\nstring ans;\n\nbool compare(string s1, string s2)\n{\n    // cout << s1 << \" \";\n    while(s1[0] == '0' && s1 != \"\"){\n        s1 = s1.substr(1);\n    }\n    while(s2[0] == '0' && s2 != \"\"){\n        s2 = s2.substr(1);\n    }\n    if(s2 == \"\") s2 = \"0\";\n    // cout << s1 << endl;\n    int l1 = s1.length(), l2 = s2.length();\n    if(l1 > l2) return true;\n    else if(l1 < l2) return false;\n    else {\n        for(int i = 0; i < l1; i++){\n            if(s1[i] > s2[i]) return true;\n            else if(s1[i] < s2[i]) return false;\n        }\n    }\n    return true;\n}\n\nvoid solve(int x, int y, string now)\n{\n    // cout << now << endl;\n    bool isend = true;\n    if(x + 1 < h && isdigit(c[x + 1][y])){\n        solve(x + 1, y, now + c[x + 1][y]);\n        isend = false;\n    }\n    if(y + 1 < w && isdigit(c[x][y + 1])){\n        solve(x, y + 1, now + c[x][y + 1]);\n        isend = false;\n    }\n    if(isend && compare(now, ans)) ans = now;\n    return;\n}\n\nint main()\n{\n    while(1){\n        cin >> w >> h;\n        if(w == 0 && h == 0) break;\n        for(int i = 0; i < h; i++){\n            for(int j = 0; j < w; j++){\n                cin >> c[i][j];\n            }\n        }\n        ans = \"\";\n        for(int i = 0; i < h; i++){\n            for(int j = 0; j < w; j++){\n                if(isdigit(c[i][j])){\n                    string now = \"\";\n                    now += c[i][j];\n                    solve(i, j, now);\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <utility>\n#include <cctype>\nusing namespace std;\n\nchar F[70][70];\n\n// s <= t ?\nbool compare(string &s, string &t) {\n  int ls, lt;\n  for(ls = 0; s[ls] == '0'; ++ls) ;\n  for(lt = 0; t[lt] == '0'; ++lt) ;\n  s = s.substr(ls);\n  t = t.substr(lt);\n  if(s.length() < t.length()) return true;\n  if(s.length() > t.length()) return false;\n  return s <= t;\n}\n\nint main() {\n  ios::sync_with_stdio(false);\n  while(true) {\n    int W, H; cin >> W >> H;\n    if(W == 0 && H == 0) break;\n    for(int i = 0; i < H; ++i) cin >> F[i];\n    string ans = \"0\";\n    queue<pair<string,pair<int,int>>> Q;\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        if(isdigit(F[i][j])) {\n          string s;\n          s.push_back(F[i][j]);\n          Q.emplace(make_pair(s,make_pair(i,j)));\n        }\n      }\n    }\n    string G[H][W];\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        G[i][j] = \"0\";\n      }\n    }\n    while(!Q.empty()) {\n      auto p = Q.front(); Q.pop();\n      if(compare(ans, p.first)) ans = p.first;\n      int i = p.second.first;\n      int j = p.second.second;\n      if(compare(G[i][j],p.first) == false) continue;\n      if(i + 1 < H && isdigit(F[i+1][j])) {\n        string s = p.first;\n        s.push_back(F[i+1][j]);\n        if(compare(s,G[i+1][j]) == false) {\n          G[i+1][j] = s;\n          Q.emplace(make_pair(s,make_pair(i+1,j)));\n        }\n      }\n      if(j + 1 < W && isdigit(F[i][j+1])) {\n        string s = p.first;\n        s.push_back(F[i][j+1]);\n        if(compare(s,G[i][j+1]) == false) {\n          G[i][j+1] = s;\n          Q.emplace(make_pair(s,make_pair(i,j+1)));\n        }\n      }\n    }\n    int l = 0;\n    while(ans[l] == '0') ++l;\n    ans = ans.substr(l);\n    if(ans == \"\") cout << \"0\" << endl;\n    else cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nbool num_check(char c){\n    if(c=='0' || c=='1' || c=='2' || c=='3' || c=='4' || c=='5' || c=='6' || c=='7' || c=='8' || c=='9'){\n        return true;    \n    }\n    return false;\n}\n\nstring num_max(string a, string b){\n    if(a.size() < b.size()) return b;\n    else if(a.size() > b.size()) return a;\n    else return a>b ? a:b;\n}\n\nint main(void){\n    int W, H;\n    char field[71][71];\n    string dp[71][71];\n    \n    while(cin>>W>>H){\n        if(W+H==0)  break;\n        string c;\n        for(int i=0; i<H; i++){\n            cin >> c;\n            for(int j=0; j<W; j++){\n                field[i][j]=c[j];\n            }\n        }\n        \n        for(int i=0; i<H; i++){\n            for(int j=0; j<W; j++){\n                if(num_check(field[i][j])) dp[i][j]=field[i][j];\n                else dp[i][j]=\"0\";\n            }\n        }\n        for(int i=0; i<H; i++){\n            for(int j=0; j<W; j++){\n                if(dp[i][j]==\"0\")   continue;;\n                if(i+1<H && num_check(field[i+1][j])) {\n                    dp[i+1][j]=num_max(dp[i+1][j], dp[i][j]+field[i+1][j]);\n                    //cout << \"dp[\" << (i+1) << \"][\" << j << \"]=\" << dp[i+1][j];\n                }\n                if(j+1<W && num_check(field[i][j+1])){\n                    dp[i][j+1]=num_max(dp[i][j+1], dp[i][j]+field[i][j+1]);\n                    //cout << \"dp[\" << i << \"][\" << (j+1) << \"]=\" << dp[i][j+1];\n                }\n            }\n        }\n        \n        string ans=\"0\";\n        for(int i=0; i<H; i++){\n            for(int j=0; j<W; j++){\n                ans=num_max(dp[i][j], ans);\n            }\n        }\n        cout << ans << \"\\n\";\n        \n    }\n    \n    \n    \n    \n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\n\nvector<string> field(80);\n\nint n, m;\n\nbool use[80][80];\nstring dp[80][80];\n\nbool isIn(int x, int y){\n    return 0 <= x && x < m && 0 <= y && y < n;\n}\n\nstring nmax(string a, string b){\n    if(a.size() != b.size()) return a.size() < b.size() ? b : a;\n    else return a < b ? b : a;\n}\n\nint main(){\n    while(cin >> n >> m, n+m){\n        for(int i=0; i < m; i++) cin >> field[i];\n        for(int i=0; i < 80; i++) for(int j=0; j < 80; j++){ use[i][j] = false; dp[i][j] = \"\";}\n        string ret;\n\n        for(int i = m-1; 0 <= i; i--){\n            for(int j = n-1; 0 <= j; j--){\n                if('0' <= field[i][j] && field[i][j] <= '9'){\n                    string a, b;\n                    if(isIn(i+1, j)) a = dp[i+1][j];\n                    if(isIn(i, j+1)) b = dp[i][j+1];\n                    dp[i][j] = field[i][j] + nmax(a, b);\n                }\n            }\n        }\n        for(int i=0; i < m; i++){\n            for(int j=0; j < n; j++){\n                if(dp[i][j][0] == '0') dp[i][j] = dp[i][j].substr(1);\n                ret = nmax(ret, dp[i][j]);\n            }\n        }\n        cout << ret << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)   FOR(i,0,n)\n#define pb emplace_back\ntypedef long long ll;\ntypedef pair<int,int> pint;\n\nstring s[71];\nbool used[71][71];\nconst int dx[]={0,1},dy[]={1,0};\nint dp[71][71];\nstring ans;\nint w,h;\nint dfs(int x,int y,string c){\n    if(dp[y][x]!=-1){\n        if(dp[y][x]+c.size()<ans.size()) return dp[y][x]+c.size();\n    }\n    if(c.size()>ans.size()) ans=c;\n    else if(c.size()==ans.size()){\n        rep(i,c.size()){\n            if(c[i]>ans[i]){\n                ans=c;break;\n            }\n            else if((c[i]<ans[i])) break;\n        }\n    }\n    int ret=1;\n    rep(i,2){\n        int tx=x+dx[i],ty=y+dy[i];\n        if(tx>=0&&ty>=0&&tx<w&&ty<h&&isdigit(s[ty][tx])){\n            if(c==\"\"&&s[ty][tx]=='0') ret=max(ret,dfs(tx,ty,c));\n            else ret=max(ret,dfs(tx,ty,c+s[ty][tx])+1);\n        }\n    }\n    return dp[y][x]=ret;\n}\nint main(){\n    while(cin>>w>>h,w){\n        memset(dp,-1,sizeof(dp));\n        rep(i,h) cin>>s[i];\n        ans=\"\";\n        string t;\n        rep(i,h)rep(j,w)if(isdigit(s[i][j])){\n            if(s[i][j]=='0') dfs(j,i,t);\n            else dfs(j,i,t+s[i][j]);\n        }\n        cout<<ans<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"vector\"\n#include \"math.h\"\n#include \"algorithm\"\n#include \"iostream\"\n#include \"string\"\n\nusing namespace std;\ntypedef long long ll;\n\nstring ans;\nstring dp[70][70];\n\nstring changeCorrectValue(string a){\n    if(a.size() > 1){\n        if(a[0] == '0') a.erase(a.begin());\n        return a;\n    }\n    return a;\n}\n\nstring detect(string a, string b){\n    a = changeCorrectValue(a);\n    b = changeCorrectValue(b);\n    if(a.size() > b.size()){\n        return a;\n    }\n    else if(a.size() < b.size()){\n        return b;\n    }\n    // same keta\n    for(int i=0; i<a.size(); i++){\n        int num = a[i] - '0';\n        int num2 = b[i] - '0';\n        if(num > num2){\n            return a;\n        }\n        else if(num < num2){\n            return b;\n        }\n    }\n    return a;\n}\n\n\nbool isNum(char a){\n    if(0 <= a - '0' && a - '0' <= 9) return true;\n    return false;\n}\n\n\nstring solve(int W, int H, vector<vector<char> > vv){\n    if(isNum(vv[0][0])) dp[0][0] = vv[0][0];\n    for(int i=0; i<H; i++){\n        for(int j=0; j<W; j++){\n            if(j+1 < W && isNum(vv[i][j+1])) {\n                dp[i][j+1] = detect(dp[i][j+1], dp[i][j] + vv[i][j+1]);\n            }\n            if(i+1 < H && isNum(vv[i+1][j])) {\n                dp[i+1][j] = detect(dp[i+1][j], dp[i][j] + vv[i+1][j]);\n            }\n            // cout << i << \",\" << j << \":\" << dp[i][j] << endl;\n            ans = detect(ans, dp[i][j]);\n        }\n    }\n    return ans;\n}\n\nint main(){\n    while(1){\n        int W, H;\n        cin >> W >> H;\n        if(!W && !H) break;\n        vector<vector<char> > vv(H, vector<char>(W));\n        for(int i=0; i<H; i++){\n            for(int j=0; j<W; j++){\n                cin >> vv[i][j];\n                dp[i][j] = \"\";\n            }\n        }\n        ans = \"\";\n        \n        cout << solve(W, H, vv) << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nint H,W;\nchar S[71][71];\nstring maxs,DP[100][100];\n\nint main()\n{\n  while(1){\n    cin>>W>>H;\n    if(W==0&&H==0)break;\n    maxs.erase(maxs.begin(),maxs.end());\n    for(int i=1;i<H+1;i++){\n      for(int j=1;j<W+1;j++){\n\tcin>>S[i][j];\n\tDP[i][j].erase(DP[i][j].begin(),DP[i][j].end());\n      }\n    }\n    for(int i=1;i<H+1;i++){\n      for(int j=1;j<W+1;j++){\n        if(S[i][j]=='0' && DP[i-1][j].empty() && DP[i][j-1].empty())continue;\n\tif(S[i][j]>='0' && S[i][j]<='9'){\n\t  if(DP[i-1][j].length()>DP[i][j-1].length())DP[i][j]=DP[i-1][j]+S[i][j];\n\t  else if(DP[i-1][j].length()<DP[i][j-1].length())DP[i][j]=DP[i][j-1]+S[i][j];\n          else if(DP[i-1][j]>DP[i][j-1])DP[i][j]=DP[i-1][j]+S[i][j];\n\t  else DP[i][j]=DP[i][j-1]+S[i][j];\n\t  if(maxs.length()<DP[i][j].length())maxs=DP[i][j];\n          else if(maxs.length()==DP[i][j].length() && maxs<DP[i][j])maxs=DP[i][j];\n\t}\n      }\n    }\n    cout<<maxs<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\n\n//#define int int64_t\n\n#define CHOOSE(a) CHOOSE2 a\n#define CHOOSE2(a0,a1,a2,a3,x,...) x\n#define REP1(i, s, cond, cal) for (signed i = signed(s); i cond; i cal)\n#define REP2(i, s, n) REP1(i, s, < signed(n), ++)\n#define REP3(i, n) REP2(i, 0, n)\n#define rep(...) CHOOSE((__VA_ARGS__,REP1,REP2,REP3))(__VA_ARGS__)\n\n#define all(c) begin(c), end(c)\n#define maxup(ans, x) (ans = (ans < x ? x : ans))\n#define minup(ans, x) (ans = (ans > x ? x : ans))\n\n#define breakif(cond) if(cond) break; else\n\ntemplate<typename T>\ninline void input(vector<T>& v) { for (auto& x : v) cin >> x; }\n\nusing VV = vector<vector<int>>;\nusing V = vector<int>;\nusing P = pair<int, int>;\nusing IP = pair<int, P>;\n\nconst int INF = 1 << 29;\n\nsigned main() {\n\tint w, h;\n\twhile (cin >> w >> h && w) {\n\t\tVV data(h, V(w));\n\t\trep(i, h) rep(j, w) {\n\t\t\tchar c; cin >> c;\n\t\t\tif (c < '0' || c > '9') data[i][j] = -1;\n\t\t\telse data[i][j] = c - '0';\n\t\t}\n\t\tvector<vector<string>> dp(h, vector<string>(w));\n\t\tauto comp = [](string& a, string& b) {\n\t\t\treturn a.size() != b.size() ? a.size() < b.size()\n\t\t\t\t: a < b;\n\t\t};\n\t\tstring ans = \"\";\n\t\trep(i, h) rep(j, w) {\n\t\t\tstring a = to_string(data[i][j]);\n\t\t\tstring b = a;\n\t\t\tif (a == \"-1\") continue;\n\t\t\tif (i - 1 >= 0 && dp[i - 1][j] != \"-1\") a = dp[i - 1][j] + to_string(data[i][j]);\n\t\t\tif (j - 1 >= 0 && dp[i][j - 1] != \"-1\") b = dp[i][j - 1] + to_string(data[i][j]);\n\t\t\tdp[i][j] = comp(a, b) ? b : a;\n\t\t\tif (comp(ans, dp[i][j])) ans = dp[i][j];\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cctype>\n#include <algorithm>\nusing namespace std;\n\nint w,h;\nstring m[100];\nstring dp[100][100];\n\nstring max_string(const vector<string>& vs){\n    int max_len=0;\n    string s;\n    for(int i=0 ; i < vs.size() ; i++ ){\n        max_len = max( max_len , (int)vs[i].size() );\n    }\n    for(int i=0 ; i < vs.size() ; i++ ){\n        if( vs[i].size() == max_len && ( s.empty() || s < vs[i] ) ){\n            s = vs[i];\n        }\n    }\n    return s;\n}\n\nvoid solve(){\n    for(int y=0 ; y < 100 ; y++ ){\n        for(int x=0 ; x < 100 ; x++ ){\n            dp[y][x].clear();\n        }\n    }\n    int max_len=0;\n    string ans;\n    for(int y=h-1 ; y >= 0 ; y-- ){\n        for(int x=w-1 ; x >= 0 ; x-- ){\n            if( isdigit( m[y][x] ) ){\n                dp[y][x].push_back( m[y][x] );\n                vector<string> vs;\n                if( x != w-1 && isdigit( m[y][x+1] ) ){\n                    vs.push_back( dp[y][x+1] );\n                }\n                if( y != h-1 && isdigit( m[y+1][x] ) ){\n                    vs.push_back( dp[y+1][x] );\n                }\n\t\tdp[y][x] += max_string( vs );\n            }\n            if( !dp[y][x].empty() && dp[y][x][0] != '0' ){\n                max_len = max( max_len , (int)dp[y][x].size() );\n            }\n        }\n    }\n    for(int y=0 ; y < h ; y++ ){\n        for(int x=0 ; x < w ; x++ ){\n            if( dp[y][x].size() == max_len && ( ans.empty() || ans < dp[y][x] ) ){\n                ans = dp[y][x];\n            }\n        }\n    }\n    cout << ans << endl;\n}\n\nint main(){\n    while( cin >> w >> h , w || h ){\n        for(int i=0 ; i < h ; i++ ){\n            cin >> m[i];\n        }\n        solve();\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <utility> // pair make_pair\nusing std::swap; // c++11\nusing std::pair;\nusing std::make_pair;\n#include <tuple> // tuple(c++11) make_tuple(c++11)\nusing std::tuple; // get<address>(variable)\nusing std::make_tuple;\n#include <string> // string stoi(c++11) stoll(c++11) to_string(c++11)\nusing std::string;\nusing std::stoi;\nusing std::stoll;\nusing std::to_string;\n#include <queue> // queue priority_queue\nusing std::queue;\nusing std::priority_queue;\n#include <stack> // stack\nusing std::stack;\n#include <vector> // vector\nusing std::vector;\n#include <map> // map\nusing std::map;\n#include <set> // set\nusing std::set; // insert erase find count\n#include <algorithm> // min max\nusing std::sort;\nusing std::lower_bound; // iterator,  >=\nusing std::upper_bound; // iterator,  >\nusing std::min;\nusing std::max;\nusing std::min_element; // iterator\nusing std::max_element; // iterator\n#include <complex> // complex\nusing std::complex; // real imag\n#include <iostream> // cin cout\nusing std::cin;\nusing std::cout;\nusing std::endl;\n#include <iomanip> // setprecision fixed(manipulator)\nusing std::setprecision;\nusing std::fixed;\n#include <cmath>\n#include <cstdio>\n\n#define lli long long int\n#define INF (int)1e09\n#define FOR(i, m, n) for (int i = m; i < n; i++)\n#define EFOR(i, m, n) for (int i = m; i <= n; i++)\n#define RFOR(i, m, n) for (int i = m; i > n; i--)\n#define REFOR(i, m, n) for (int i = m; i >= n; i--)\n#define VSORT(v) sort((v).begin(), (v).end()) // sort vector\ntypedef pair<int, int> PI;\ntypedef tuple<int, int, int> TI;\ntypedef tuple<string, int, int> TS;\ntemplate <typename T> using Vec = vector<T>; // c++11\n\nvoid bfs(Vec<Vec<char> > &table, string &max_ans, int i, int j) {\n    queue<TS> que; // number h w\n    string str = \"\";\n    str += table[i][j];\n    TS t = make_tuple(str, i, j);\n    que.push(t);\n\n    while (!que.empty()) {\n        TS target = que.front(); \n        que.pop();\n        string now_s = std::get<0>(target);\n        int now_i = std::get<1>(target);\n        int now_j = std::get<2>(target);\n\n        if (table[now_i][now_j + 1] == '#' && table[now_i + 1][now_j] == '#') {\n            int len_max = max_ans.length();\n            int len_now = now_s.length();\n            if (len_max < len_now) {\n                max_ans = now_s;\n            } else if ((int)max_ans.length() == (int)now_s.length()) {\n                max_ans = max(max_ans, now_s);\n            }\n        } else {\n            if (table[now_i + 1][now_j] != '#') {\n                TS now = make_tuple(now_s + table[now_i + 1][now_j], now_i + 1, now_j);\n                que.push(now);\n            }\n            if (table[now_i][now_j + 1] != '#') {\n                TS now = make_tuple(now_s + table[now_i][now_j + 1], now_i, now_j + 1);\n                que.push(now);\n            }\n        }\n    }\n\n    return;\n}\n\n\nint main(void) {\n    int w;\n    int h;\n    while (1) {\n        cin >> w >> h;\n        if (w == 0 && h == 0) {\n            break;\n        }\n        Vec<Vec<char> > table(h + 2, Vec<char>(w + 2, '#'));\n        char input;\n        FOR (i, 1, h + 1) {\n            FOR (j, 1, w + 1) {\n                cin >> input;\n                if (input >= '0' && input <= '9') {\n                    table[i][j] = input;\n                }\n            }\n        }\n\n        Vec<Vec<string> > ans(h + 2, Vec<string>(w + 2, \"\"));\n        FOR (i, 1, h + 1) {\n            FOR (j, 1, w + 1) {\n                if (table[i][j] != '#' && table[i][j] >= '0' && table[i][j] <= '9') {\n                    if (table[i][j] == '0' && table[i - 1][j] == '#' && table[i][j - 1] == '#') {\n                        table[i][j] = '#';\n                        continue;\n                    }\n                    string up = ans[i - 1][j];\n                    string left = ans[i][j - 1];\n                    int up_size = ans[i - 1][j].length();\n                    int left_size = ans[i][j - 1].length();\n\n                    if (up_size < left_size) {\n                        ans[i][j] = ans[i][j - 1] + table[i][j];\n                    } else if (up_size > left_size) {\n                        ans[i][j] = ans[i - 1][j] + table[i][j];\n                    } else {\n                        if (up_size == 0) {\n                            ans[i][j] = table[i][j];\n                        } else {\n                            ans[i][j] = max(up, left) + table[i][j];\n                        }\n                    }\n                }\n            }\n        }\n\n        string output = \"\";\n        int len = 0;\n        FOR (i, 1, h + 1) {\n            FOR (j, 1, w + 1) {\n                int now_size = ans[i][j].length();\n                if (now_size > len) {\n                    len = now_size;\n                    output = ans[i][j];\n                } else if (now_size == len) {\n                    output = max(output, ans[i][j]);\n                }\n            }\n        }\n        cout << output << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <map>\n#include <set>\n#include <list>\n#include <queue>\n#include <deque>\n#include <stack>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <bitset>\nusing namespace std;\n#define INF\t100000000\n#define MOD 1000000007\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define sec second\n#define lb lower_bound\n#define ub upper_bound\n#define SS stringstream\n#define rep(i,n) for(int i = 0; i < n; i++)\n#define SORT(x) sort((x).begin(), (x).end())\n#define clr(a,b) memset((a),(b),sizeof(a))\ntypedef long long int ll;\ntypedef pair<int, int> P;\ntypedef vector<int> Vi;\ntypedef vector<ll> Vll;\ntypedef vector<P> Vp;\ntypedef priority_queue<P, vector<P>, greater<P> > PQ;\n\nbool number(char a){\n\tif(0<=a-'0'&&a-'0'<=9){\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nstring bigger(string a, string b){\n\tif(a.size() > b.size()){\n\t\treturn a;\n\t} else{\n\t\tif(a.size() == b.size()){\n\t\t\treturn max(a,b);\n\t\t} else{\n\t\t\treturn b;\n\t\t}\n\t}\n}\n\nint main(){\n\tint w, h;\n\twhile(scanf(\"%d%d\", &w,&h),w||h){\n\t\tchar deta[70][70];\n\t\tstring num[70][70];\n\t\trep(i,h) rep(j,w) scanf(\" %c\", &deta[i][j]);\n\t\trep(i,h){\n\t\t\trep(j,w){\n\t\t\t\tif(!number(deta[i][j])) continue;\n\t\t\t\tif(i == 0 && j == 0){\n\t\t\t\t\tif(deta[i][j] != '0'){\n\t\t\t\t\t\tnum[i][j].pb(deta[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(i == 0){\n\t\t\t\t\tnum[i][j] += num[i][j-1];\n\t\t\t\t\tif(deta[i][j] != '0' || num[i][j].size() != 0){\n\t\t\t\t\t\tnum[i][j].pb(deta[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(j == 0){\n\t\t\t\t\tnum[i][j] += num[i-1][j];\n\t\t\t\t\tif(deta[i][j] != '0' || num[i][j].size() != 0){\n\t\t\t\t\t\tnum[i][j].pb(deta[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tnum[i][j] += bigger(num[i-1][j],num[i][j-1]);\n\t\t\t\tif(deta[i][j] != '0' || num[i][j].size() != 0){\n\t\t\t\t\tnum[i][j].pb(deta[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring ans;\n\t\trep(i,h) rep(j,w){\n\t\t\tans = bigger(ans,num[i][j]);\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<iostream>\n#include<string>\nusing namespace std;\nstatic const int MAX_WH = 70;\n\nint W, H;\nstring C[MAX_WH];\nstring memo[MAX_WH][MAX_WH];\n\nstring lexicographical(string s, string t){\n\tif(s.length() > t.length()) return s;\n\tif(s.length() < t.length()) return t;\n\treturn s > t ? s : t;\n}\n\nstring dfs(int y, int x){\n\tif(y < 0 || y >= H || x < 0 || x >= W) return \"\";\n\tif(C[y][x] - '0' < 0 || C[y][x] - '0' > 9) return memo[y][x] = \"\";\n\tif(memo[y][x] != \"\") return memo[y][x];\n\treturn memo[y][x] = C[y][x] + lexicographical(dfs(y + 1, x), dfs(y, x + 1));\n}\n\nint main(){\n\tfor(;;){\n\t\tscanf(\"%d %d\", &W, &H);\n\t\tif(W == 0 && H == 0) break;\n\t\tfor(int i = 0; i < H; i++) cin >> C[i];\n\t\tfor(int i = 0; i < H; i++){\n\t\t\tfor(int j = 0; j < W; j++) memo[i][j] = \"\";\n\t\t}\n\t\tstring res;\n\t\tfor(int i = 0; i < H; i++){\n\t\t\tfor(int j = 0; j < W; j++){\n\t\t\t\tif(C[i][j] - '0' < 1 || C[i][j] - '0' > 9) continue;\n\t\t\t\tmemo[i][j] = dfs(i, j);\n\t\t\t\tres = lexicographical(res, memo[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<deque>\n#include<list>\n#include<map>\n#include<queue>\n#include<set>\n#include<stack>\n#include<vector>\n#include<algorithm>\n#include<string>\n#include<iostream>\n#include<sstream>\n#include<cmath>\n#include<cstdio>\nusing namespace std;\nchar s[80][80];\npair<string,int> t[80][80];\nint operator<(pair<string,int>& s,pair<string,int>& t){\n  if(0){\n  }else if(s.second<t.second){\n    return 1;\n  }else if(s.second>t.second){\n    return 0;\n  }else{\n    return s.first<t.first;\n  }\n}\npair<string,int> fi(int x,int y){\n  if(t[y][x].second==0){\n    if('0'<=s[y][x+1]&&s[y][x+1]<='9'){\n      pair<string,int> u=fi(x+1,y);\n      if(t[y][x]<u)\n\tt[y][x]=u;\n    }\n    if('0'<=s[y+1][x]&&s[y+1][x]<='9'){\n      pair<string,int> u=fi(x,y+1);\n      if(t[y][x]<u)\n\tt[y][x]=u;\n    }\n    t[y][x]=make_pair(s[y][x]+t[y][x].first,t[y][x].second+1);\n  }\n  return t[y][x];\n}\nint main(){\n  int i,j;\n  int w,h;\n  while(cin>>w>>h,w||h){\n    fill(s[0],s[0]+80*80,0);\n    for(i=0;i<h;++i)\n      cin>>s[i];\n    fill(t[0],t[0]+80*80,make_pair(\"\",0));\n    pair<string,int> mx=make_pair(\"\",0);\n    for(i=0;i<h;++i){\n      for(j=0;j<w;++j){\n\tif('1'<=s[i][j]&&s[i][j]<='9'){\n\t  pair<string,int> u=fi(j,i);\n\t  if(mx<u)\n\t    mx=u;\n\t}\n      }\n    }\n    cout<<mx.first<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <utility> // pair make_pair\nusing std::swap; // c++11\nusing std::pair;\nusing std::make_pair;\n#include <tuple> // tuple(c++11) make_tuple(c++11)\nusing std::tuple; // get<address>(variable)\nusing std::make_tuple;\n#include <string> // string stoi(c++11) stoll(c++11) to_string(c++11)\nusing std::string;\nusing std::stoi;\nusing std::stoll;\nusing std::to_string;\n#include <queue> // queue priority_queue\nusing std::queue;\nusing std::priority_queue;\n#include <stack> // stack\nusing std::stack;\n#include <vector> // vector\nusing std::vector;\n#include <map> // map\nusing std::map;\n#include <set> // set\nusing std::set; // insert erase find count\n#include <algorithm> // min max\nusing std::sort;\nusing std::lower_bound; // iterator,  >=\nusing std::upper_bound; // iterator,  >\nusing std::min;\nusing std::max;\nusing std::min_element; // iterator\nusing std::max_element; // iterator\n#include <complex> // complex\nusing std::complex; // real imag\n#include <iostream> // cin cout\nusing std::cin;\nusing std::cout;\nusing std::endl;\n#include <iomanip> // setprecision fixed(manipulator)\nusing std::setprecision;\nusing std::fixed;\n#include <cmath>\n#include <cstdio>\n\n#define lli long long int\n#define INF (int)1e09\n#define FOR(i, m, n) for (int i = m; i < n; i++)\n#define EFOR(i, m, n) for (int i = m; i <= n; i++)\n#define RFOR(i, m, n) for (int i = m; i > n; i--)\n#define REFOR(i, m, n) for (int i = m; i >= n; i--)\n#define VSORT(v) sort((v).begin(), (v).end()) // sort vector\ntypedef pair<int, int> PI;\ntypedef tuple<int, int, int> TI;\ntypedef tuple<string, int, int> TS;\ntemplate <typename T> using Vec = vector<T>; // c++11\n\nvoid bfs(Vec<Vec<char> > &table, string &max_ans, int i, int j) {\n    queue<TS> que; // number h w\n    string str = \"\";\n    str += table[i][j];\n    TS t = make_tuple(str, i, j);\n    que.push(t);\n\n    while (!que.empty()) {\n        TS target = que.front(); \n        que.pop();\n        string now_s = std::get<0>(target);\n        int now_i = std::get<1>(target);\n        int now_j = std::get<2>(target);\n\n        if (table[now_i][now_j + 1] == '#' && table[now_i + 1][now_j] == '#') {\n            int len_max = max_ans.length();\n            int len_now = now_s.length();\n            if (len_max < len_now) {\n                max_ans = now_s;\n            } else if ((int)max_ans.length() == (int)now_s.length()) {\n                max_ans = max(max_ans, now_s);\n            }\n        } else {\n            if (table[now_i + 1][now_j] != '#') {\n                TS now = make_tuple(now_s + table[now_i + 1][now_j], now_i + 1, now_j);\n                que.push(now);\n            }\n            if (table[now_i][now_j + 1] != '#') {\n                TS now = make_tuple(now_s + table[now_i][now_j + 1], now_i, now_j + 1);\n                que.push(now);\n            }\n        }\n    }\n\n    return;\n}\n\n\nint main(void) {\n    int w;\n    int h;\n    while (1) {\n        cin >> w >> h;\n        if (w == 0 && h == 0) {\n            break;\n        }\n        Vec<Vec<char> > table(h + 2, Vec<char>(w + 2, '#'));\n        char input;\n        FOR (i, 1, h + 1) {\n            FOR (j, 1, w + 1) {\n                cin >> input;\n                if (input >= '0' && input <= '9') {\n                    table[i][j] = input;\n                }\n            }\n        }\n        string max_ans = \"0\";\n        FOR (i, 1, h + 1) {\n            FOR (j, 1, w + 1) {\n                if (table[i][j] != '#' && table[i][j] != '0') {\n                    bfs(table, max_ans, i, j);\n                }\n            }\n        }\n\n        /*\n           FOR (i, 0, h + 2) {\n           FOR (j, 0, w + 2) {\n           cout << table[i][j] << \" \";\n           }\n           cout << endl;\n           }\n         */\n        int max_ans_len = (int)max_ans.length();\n        cout << max_ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cstring>\nusing namespace std;\n\n#define MAX_H 70\n#define MAX_W 70\n\nint h, w;\nstring field[MAX_H];\nstring cache[MAX_H][MAX_W];\n\nbool non_zero(char c) {\n    return (isdigit(c) && c != '0');\n}\n\nbool non_zero(string s) {\n    if (s.empty() || s[0] == '0') return false;\n    for (string::iterator si = s.begin(); si != s.end(); si++) {\n        if (! isdigit(*si) ) {\n            return false;\n        }\n    }\n    return true;\n}\n\nbool bigger(string a, string b) {\n    if (a.size() > b.size()) return true;\n    if (a.size() < b.size()) return false;\n    else return (a>b);\n}\n\nint main() {\n    while (cin >> w >> h) {\n        if (w == 0 && h == 0) break;\n        for (int i = 0; i < h; i++) {\n            cin >> field[i];\n            for (int j = 0; j < w; j++) {\n                if (non_zero(field[i][j])) {\n                    cache[i][j] = field[i][j];\n                } else {\n                    cache[i][j] = \"\";\n                }\n            }\n        }\n\n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n                if (isdigit(field[i][j])) {\n                    string u, l;\n                    if (1 <= i && i < h && non_zero(cache[i-1][j])) {\n                        u = cache[i-1][j] + field[i][j];\n                        if (!bigger(cache[i][j], u)) {\n                            cache[i][j] = u;\n                        }\n                    }\n                    if (1 <= j && j < w && non_zero(cache[i][j-1])) {\n                        l = cache[i][j-1] + field[i][j];\n                        if (!bigger(cache[i][j], l)) {\n                            cache[i][j] = l;\n                        }\n                    }\n                }\n            }\n        }\n\n        string biggest = \"\";\n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n//                if (cache[i][j] == \"\") {\n//                    cout << 0 << ' ';\n//                } else {\n//                    cout << cache[i][j] << ' ';\n//                }\n                if (bigger(cache[i][j], biggest)) {\n                    biggest = cache[i][j];\n                }\n            }\n//            cout << endl;\n        }\n\n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n                cout << field[i][j] << ' ';\n            }\n            cout << endl;\n        }\n\n        cout << biggest << endl;\n    }\n    return 0;\n}\n\n    "
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstdlib>\n#include <algorithm>\n\nusing namespace std;\n\nstring str[71][71];\n\nstring func(char a[71][71], bool vis[71][71], int w, int h, int p, int q)\n{\n  if(!vis[p][q]){\n    return str[p][q];\n  }\n  vis[p][q] = false;\n  if(p == h-1 && q == w-1){\n    str[p][q] = a[p][q];\n    return str[p][q];\n  }\n\n  string s = \"\", t = \"\";\n  int u = p+1, v = q+1;\n  if(u < h && a[u][q] >= '0' && a[u][q] <= '9'){\n    s = func(a, vis, w, h, u, q);\n  }\n  if(v < w && a[p][v] >= '0' && a[p][v] <= '9'){\n    t = func(a, vis, w, h, p, v);\n  }\n\n  if(s.size() > t.size() || (t.size() == s.size() && t < s)){\n    str[p][q] = a[p][q] + s;\n  } else {\n    str[p][q] = a[p][q] + t;\n  }\n\n  return str[p][q];\n}\n\nbool compareTo(string s1, string s2)\n{\n  int p, q;\n  string str1, str2;\n  p = q = 0;\n\n  while(p < s1.size() && s1[p] == '0'){\n    p++;\n  }\n  while(q < s2.size() && s2[q] == '0'){\n    q++;\n  }\n  str1 = s1.substr(p);\n  str2 = s2.substr(q);\n\n  if(str1.size() < str2.size()){\n    return true;\n  } else if(str1.size() > str2.size()){\n    return false;\n  }\n\n  return ((s1 > s2)? false : true);\n}\n\nint main()\n{\n  int w, h;\n  char a[71][71];\n  bool vis[71][71];\n\n  while(cin >> w >> h && (w+h)){\n    for(int i = 0; i < h; i++){\n      for(int j = 0; j < w; j++){\n\tcin >> a[i][j];\n      }\n    }\n    fill(&vis[0][0], &vis[70][70], true);\n    fill(&str[0][0], &str[70][70], \"\");\n    string s = \"\";\n\n    for(int i = 0; i < h; i++){\n      for(int j = 0; j < w; j++){\n\tif(a[i][j] >= '0' && a[i][j] <= '9' && vis[i][j]){\n\t  string t = func(a, vis, w, h, i, j);\n\t  if(s.size() < t.size() || (s.size() == t.size() && s < t)){\n\t    s = t;\n\t  }\t  \n\t}\n      }\n    }\n    \n    s = \"\";\n    for(int i = 0; i < h; i++){\n      for(int j = 0; j < w; j++){\n\tif(!vis[i][j] && compareTo(s, str[i][j])){\n\t  s = str[i][j];\n\t}\n      }\n    }\n    \n    int p = 0;\n    while(p < s.size() && s[p] == '0'){\n      p++;\n    }\n    \n    cout << s.substr(p) << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <string>\n\nusing namespace std;\n\nint h, w, dy[] = {0, 1}, dx[] = {1, 0};\nchar data[70][70];\nstring dp[70][70];\n\nmain(){\n  while(cin >> w >> h && (h|w)){\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n        cin >> data[i][j];\n        dp[i][j] = \"\";\n        if('1' <= data[i][j] && data[i][j] <= '9') dp[i][j] += data[i][j];\n      }\n    }\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n        for(int k=0;k<2;k++){\n          int ny = i + dy[k];\n          int nx = j + dx[k];\n          if(ny<0 || ny>=h) continue;\n          if(nx<0 || nx>=w) continue;\n          if('0' <= data[ny][nx] && data[ny][nx] <= '9'){\n            if(dp[i][j] != \"\" || data[ny][nx] != '0'){\n              string tmp = dp[i][j];\n              tmp += data[ny][nx];\n              if(dp[ny][nx].size() < tmp.size()) dp[ny][nx] = tmp;\n              else if(dp[ny][nx].size() == tmp.size()) dp[ny][nx] = max(dp[ny][nx], tmp);\n            }\n          }\n        }\n      }\n    }\n    string ans = \"\";\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n        if(ans.size() < dp[i][j].size()) ans = dp[i][j];\n        else if(ans.size() == dp[i][j].size()) ans = max(ans, dp[i][j]);\n      }\n    }\n    cout << ans << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#include <map>\n#define chmin(a, b) ((a)=min((a), (b)))\n#define chmax(a, b) ((a)=max((a), (b)))\n#define fs first\n#define sc second\n#define eb emplace_back\nusing namespace std;\n \ntypedef long long ll;\ntypedef pair<int, int> P;\ntypedef tuple<int, int, int> T;\n \nconst ll MOD=1e9+7;\nconst ll INF=1e18;\n \nint dx[]={1, -1, 0, 0};\nint dy[]={0, 0, 1, -1};\n\n\nchar num[] = \"0123456789\";\nint di[] = {1,0};\nint dj[] = {0,1};\n\nbool check(int len,int a[80],int b[80]){\n    for(int i = 1;i <= len;i++){\n        if(a[i] == b[i]) continue;\n        else if(a[i] > b[i]){\n            return true;\n        }else{\n            return false;\n        }\n    }\n    return false;\n}\n\nint dp[80][80][80] = {0};\n\nint main(){\n    int w,h;\n    char tmp[80][80];\n    int mat[80][80];\n    while(1){\n        cin >> w >> h;\n        if(w == 0)break;\n        for(int i = 0;i < h;i++) cin >> tmp[i];\n\n        for(int i = 0;i < 80;i++){\n            for(int j = 0;j < 80;j++){\n                for(int k = 0;k < 80;k++){\n                    dp[i][j][k] = 0;\n                }\n            }\n        }\n        \n        for(int i = 0;i < h;i++){ // char から　int にする\n            for(int j = 0;j < w;j++){\n                mat[i][j] = -1;\n                for(int k = 0;k <= 9;k++) if(num[k] == tmp[i][j]) mat[i][j] = k;\n            }\n        }\n        \n        \n        int maxlen = 0,ans[80] = {0};\n        for(int i = 0;i < h;i++) mat[i][w] = -1;\n        for(int j = 0;j < w;j++) mat[h][j] = -1;\n        \n        \n        for(int i = h-1;i >= 0;i--){\n            for(int j = w-1;j >= 0;j--){\n                if(mat[i][j] == -1) continue;\n                dp[i][j][0] = 1; dp[i][j][1] = mat[i][j];\n                if(mat[i][j] != 0 && maxlen <= 1){\n                    maxlen = 1;\n                    ans[1] = max(ans[1],mat[i][j]);\n                }\n                for(int k = 0;k < 2;k++){\n                    int ni = i+di[k],nj = j+dj[k];\n                    if(mat[ni][nj] == -1)continue;\n                    if(1 + dp[ni][nj][0] > dp[i][j][0]){ // 必ず値を更新すべき場合\n                        dp[i][j][0] = 1 + dp[ni][nj][0];\n                        for(int ii = 0;ii < dp[ni][nj][0];ii++){\n                            dp[i][j][ii+2] = dp[ni][nj][ii+1];\n                        }\n                        if(mat[i][j] != 0 &&  (dp[i][j][0] > maxlen || (dp[i][j][0] == maxlen && check(maxlen,dp[i][j],ans) == true))){\n                            maxlen = dp[i][j][0];\n                            for(int q = 1;q <= maxlen;q++) ans[q] = dp[i][j][q];\n                        }\n                    }else if(1 + dp[ni][nj][0] == dp[i][j][0]){ //確認が必要な場合\n                        int cand[80];\n                        cand[1] = mat[i][j];\n                        for(int q = 0;q < dp[ni][nj][0];q++){\n                            cand[q+2] = dp[ni][nj][q+1];\n                        }\n                        if(check(dp[i][j][0],cand,dp[i][j]) == true){\n                            for(int q = 0;q < dp[ni][nj][0];q++) dp[i][j][q+2] = cand[q+2];\n                        }\n                        if(mat[i][j] != 0 &&  (dp[i][j][0] > maxlen || (dp[i][j][0] == maxlen && check(maxlen,dp[i][j],ans) == true))){\n                            maxlen = dp[i][j][0];\n                            for(int q = 1;q <= maxlen;q++) ans[q] = dp[i][j][q];\n                        }\n                    }\n                }\n            }\n        }\n        \n        for(int i = 1;i <= maxlen;i++){\n            cout << ans[i];\n        }\n        cout << endl;\n        \n    }\n}\n"
  },
  {
    "language": "C++",
    "code": "// >>> TEMPLATES\n#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing ld = long double;\nusing i32 = int32_t;\nusing i64 = int64_t;\nusing u32 = uint32_t;\nusing u64 = uint64_t;\n#define int ll\n#define double ld\n#define rep(i,n) for (int i = 0; i < (int)(n); i++)\n#define rep1(i,n) for (int i = 1; i <= (int)(n); i++)\n#define repR(i,n) for (int i = (int)(n)-1; i >= 0; i--)\n#define rep1R(i,n) for (int i = (int)(n); i >= 1; i--)\n#define loop(i,a,B) for (int i = a; i B; i++)\n#define loopR(i,a,B) for (int i = a; i B; i--)\n#define all(x) (x).begin(), (x).end()\n#define allR(x) (x).rbegin(), (x).rend()\n#define pb push_back\n#define eb emplace_back\n#define mp make_pair\n#define fst first\n#define snd second\ntemplate <class Int> auto constexpr inf = numeric_limits<Int>::max()/2-1;\nauto constexpr INF32 = inf<int32_t>;\nauto constexpr INF64 = inf<int64_t>;\nauto constexpr INF   = inf<int>;\n#ifdef LOCAL\n#include \"debug.hpp\"\n#else\n#define dump(...) (void)(0)\n#define say(x) (void)(0)\n#define debug if (0)\n#endif\ntemplate <class T> using pque_max = priority_queue<T>;\ntemplate <class T> using pque_min = priority_queue<T, vector<T>, greater<T> >;\ntemplate <class T, class = typename T::iterator, class = typename enable_if<!is_same<T, string>::value>::type>\nostream& operator<<(ostream& os, T const& v) { bool f = true; for (auto const& x : v) os << (f ? \"\" : \" \") << x, f = false; return os; }\ntemplate <class T, class = typename T::iterator, class = typename enable_if<!is_same<T, string>::value>::type>\nistream& operator>>(istream& is, T &v) { for (auto& x : v) is >> x; return is; }\ntemplate <class T, class S> ostream& operator<<(ostream& os, pair<T,S> const& p) { return os << \"(\" << p.first << \", \" << p.second << \")\"; }\ntemplate <class T, class S> istream& operator>>(istream& is, pair<T,S>& p) { return is >> p.first >> p.second; }\nstruct IOSetup { IOSetup() { cin.tie(nullptr); ios::sync_with_stdio(false); cout << fixed << setprecision(15); } } iosetup;\ntemplate <class F> struct FixPoint : private F {\n    constexpr FixPoint(F&& f) : F(forward<F>(f)) {}\n    template <class... T> constexpr auto operator()(T&&... x) const { return F::operator()(*this, forward<T>(x)...); }\n};\nstruct MakeFixPoint {\n    template <class F> constexpr auto operator|(F&& f) const { return FixPoint<F>(forward<F>(f)); }\n};\n#define MFP MakeFixPoint()|\n#define def(name, ...) auto name = MFP [&](auto &&name, __VA_ARGS__)\ntemplate <class T, size_t d> struct vec_impl {\n    using type = vector<typename vec_impl<T,d-1>::type>;\n    template <class... U> static type make_v(size_t n, U&&... x) { return type(n, vec_impl<T,d-1>::make_v(forward<U>(x)...)); }\n};\ntemplate <class T> struct vec_impl<T,0> { using type = T; static type make_v(T const& x = {}) { return x; } };\ntemplate <class T, size_t d = 1> using vec = typename vec_impl<T,d>::type;\ntemplate <class T, size_t d = 1, class... Args> auto make_v(Args&&... args) { return vec_impl<T,d>::make_v(forward<Args>(args)...); }\ntemplate <class T> void quit(T const& x) { cout << x << endl; exit(0); }\ntemplate <class T, class U> constexpr bool chmin(T& x, U const& y) { if (x > y) { x = y; return true; } return false; }\ntemplate <class T, class U> constexpr bool chmax(T& x, U const& y) { if (x < y) { x = y; return true; } return false; }\ntemplate <class It> constexpr auto sumof(It b, It e) { return accumulate(b,e,typename iterator_traits<It>::value_type{}); }\ntemplate <class T> int sz(T const& x) { return x.size(); }\ntemplate <class C, class T> int lbd(C const& v, T const& x) {\n    return lower_bound(v.begin(), v.end(), x)-v.begin();\n}\ntemplate <class C, class T> int ubd(C const& v, T const& x) {\n    return upper_bound(v.begin(), v.end(), x)-v.begin();\n}\ntemplate <class C, class F> int ppt(C const& v, F f) {\n    return partition_point(v.begin(), v.end(), f)-v.begin();\n}\n// <<<\n\nint comp(string s, string t) {\n    if (s.size() < t.size()) {\n        reverse(all(s));\n        s += string(t.size()-s.size(),'0');\n        reverse(all(s));\n    } else {\n        reverse(all(t));\n        t += string(s.size()-t.size(),'0');\n        reverse(all(t));\n    }\n    return s.compare(t);\n}\n\n\nint32_t main() {\n    while (true) {\n        int w,h; cin >> w >> h;\n        if (w == 0 && h == 0) break;\n        vector<string> c(h); cin >> c;\n\n        auto dp = make_v<string,2>(h,w);\n        rep (i,h) rep (j,w) if (isdigit(c[i][j])) {\n            string s = \"0\";\n            if (i > 0 && comp(s,dp[i-1][j]) < 0) s = dp[i-1][j];\n            if (j > 0 && comp(s,dp[i][j-1]) < 0) s = dp[i][j-1];\n            chmax(dp[i][j], s + c[i][j]);\n        }\n\n        string ma = \"0\";\n        rep (i,h) rep (j,w) if (comp(ma,dp[i][j]) < 0) ma = dp[i][j];\n        reverse(all(ma));\n        while (ma.size() && ma.back() == '0') ma.pop_back();\n        assert(ma.size());\n        reverse(all(ma));\n        cout << ma << \"\\n\";\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<algorithm>\n#include<bitset>\n#include<cassert>\n#include<cfloat>\n#include<climits>\n#include<cmath>\n#include<deque>\n#include<functional>\n#include<iomanip>\n#include<iostream>\n#include<map>\n#include<queue>\n#include<set>\n#include<stack>\n#include<string>\n#include<unordered_map>\n#include<unordered_set>\n#include<utility>\n#include<vector>\n\n#define REP(i, n) for(int i = 0;i < n;i++)\n#define REPR(i, n) for(int i = n;i >= 0;i--)\n#define FOR(i, m, n) for(int i = m;i < n;i++)\n#define FORR(i, m, n) for(int i = m;i >= n;i--)\n#define SORT(v, n) sort(v, v+n);\n#define VSORT(v) sort(v.begin(), v.end());\n#define llong long long\n#define pb(a) push_back(a)\n\nusing namespace std;\n\ntypedef long long int ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\n\ntemplate<typename T>\nvector<T> make_v(size_t a) { return vector<T>(a); }\ntemplate<typename T, typename... Ts>\nauto make_v(size_t a, Ts... ts) {\n\treturn vector<decltype(make_v<T>(ts...))>(a, make_v<T>(ts...));\n}\ntemplate<typename T, typename V>\ntypename enable_if<is_class<T>::value == 0>::type\nfill_v(T& t, const V& v) { t = v; }\ntemplate<typename T, typename V>\ntypename enable_if<is_class<T>::value != 0>::type\nfill_v(T& t, const V& v) {\n\tfor (auto& e : t) fill_v(e, v);\n}\n\n\n// aよりもbが大きいならばaをbで更新する\n// (更新されたならばtrueを返す)\ntemplate <typename T>\nbool chmax(T & a, const T & b) {\n\tif (a < b) {\n\t\ta = b;  // aをbで更新\n\t\treturn true;\n\t}\n\treturn false;\n}\n// aよりもbが小さいならばaをbで更新する\n// (更新されたならばtrueを返す)\ntemplate <typename T>\nbool chmin(T & a, const T & b) {\n\tif (a > b) {\n\t\ta = b;  // aをbで更新\n\t\treturn true;\n\t}\n\treturn false;\n}\n\n\n#define ARRAY_MAX 100005\nconst int INF = 1e9 + 7;\nconst ll MOD = 1e9 + 7;\n\nint dx[4] = { 1,0,0,-1 };\nint dy[4] = { 0,1,-1,0 };\n\nint dx2[2] = { 1,0 };\nint dy2[2] = { 0,1 };\n\n/******************************************************************************************/\n\nint w, h;\nchar mp[75][75];\nauto memo = make_v<string>(75, 75);\n\nstring strMaxi(string a, string b) {\n\tif (a.size() > b.size()) return a;\n\tif (a.size() < b.size()) return b;\n\treturn max(a, b);\n}\n\nstring dfs(int y, int x) {\n\n\tif (memo[y][x] != \"\")return memo[y][x];\n\n\tstring res = \"\";\n\tfor (int i = 0; i < 2; i++)\n\t{\n\t\tint ny = y + dy2[i];\n\t\tint nx = x + dx2[i];\n\t\tif (0 <= ny && ny < h && 0 <= nx && nx < w && '0' <= mp[ny][nx] && mp[ny][nx] <= '9') {\n\t\t\tres = strMaxi(res, mp[y][x] + dfs(ny, nx));\n\t\t}\n\t}\n\n\t\n\tif (res == \"\") {\n\t\tres = mp[y][x];\n\t}\n\treturn memo[y][x] = res;\n}\n\n\n\nint main() {\n\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\tcout << fixed << setprecision(10);\n\n\t\n\n\t\t\n\twhile (cin >> w >> h, w | h) {\n\n\t\tfor (int i = 0; i < h; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < w; j++)\n\t\t\t{\n\t\t\t\tcin >> mp[i][j];\n\t\t\t}\n\t\t}\n\t\tstring ans = \"\";\n\n\n\t\tfor (int i = 0; i < h; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < w; j++)\n\t\t\t{\n\t\t\t\tmemo[i][j] = \"\";\n\t\t\t}\n\t\t}\n\n\t\tfor (int i = 0; i < h; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < w; j++)\n\t\t\t{\n\t\t\t\tif ('1' <= mp[i][j] && mp[i][j] <= '9') {\n\t\t\t\t\t\n\t\t\t\t\tans = strMaxi(ans, dfs(i, j));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n\n\t\n\t\n\n\treturn 0;\n}\n\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n\nusing namespace std;\n\nbool func(char w)\n{\n  char num = '0';\n  for(int i = 0; i < 10; i++){\n    if(w == (char)(num+i)){\n      return true;\n    }\n  }\n\n  return false;\n}\n\nstring stcomp(string s1, string s2)\n{\n  string str = s1;\n  if(s1.length() == s2.length()){\n    long long int u = atoi(s1.c_str());\n    long long int v = atoi(s2.c_str());\n    if(v > u){\n      str = s2;\n    }\n  } else if(s1.length() < s2.length()){\n    str = s2;\n  }\n\n  return str;\n}\n\nstring search(char a[71][71], int h, int w, int s, int t)\n{\n  string str, str2=\"\", str3=\"\";\n  str = a[s][t];\n\n  if(s+1 < h){\n    if(func(a[s+1][t])){\n      str2 = search(a, h, w, s+1, t);\n    }\n  }\n  if(t+1 < w){\n    if(func(a[s][t+1])){\n      str3 = search(a, h, w, s, t+1);\n    }\n  }\n\n  return (str+stcomp(str2, str3));\n}\n\nint main()\n{\n  int w, h;\n  char a[71][71];\n  string str, st;\n\n  while(1){\n    cin >> w >> h;\n    if(h == 0 && w == 0){\n      break;\n    }\n    str = \"\";\n    for(int i = 0; i < h; i++){\n      cin >> a[i];\n    }\n\n    for(int i = 0; i < h; i++){\n      for(int j = 0; j < w; j++){\n\tif(func(a[i][j])){\n\t  st = search(a, h, w, i, j);\n\t  str = stcomp(str, st);\n\t}\n      }\n    }\n    w = 0;\n    while(str[w] == '0'){\n      w++;\n    }\n\n    cout << str.substr(w) << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\n#define LL long long\n#define VI vector<int>\n#define VVI vector<vector<int>>\n#define VVVI vector<vector<vector<int>>>\n#define VVVVI vector<vector<vector<vector<int>>>>\n#define VL vector<LL>\n#define VVL vector<vector<LL>>\n#define VVVL vector<vector<vector<LL>>>\n#define VVVVL vector<vector<vector<vector<LL>>>>\n#define VB vector<bool>\n#define FOR(i,a,b) for(int i= (a); i<((int)b); ++i)\n#define RFOR(i,a) for(int i=(a); i >= 0; --i)\n#define FOE(i,a) for(auto i : a)\n#define ALL(c) (c).begin(), (c).end()\n#define RALL(c) (c).rbegin(), (c).rend()\n#define DUMP(x)  cerr << #x << \" = \" << (x) << endl;\n#define SUM(x) std::accumulate(ALL(x), 0LL)\n#define MIN(v) *std::min_element(v.begin(), v.end())\n#define MAX(v) *std::max_element(v.begin(), v.end())\n#define EXIST(v,x) (std::find(v.begin(), v.end(), x) != v.end())\n#define BIT(n) (1LL<<(n))\n#define UNIQUE(v) v.erase(unique(v.begin(), v.end()), v.end());\n#define EPS 1e-14\n\ntemplate<class T> T ceil(T a, T b) { return (a + b - 1) / b; }\ntemplate<class T> void print(T x) { std::cout << x << std::endl; }\ninline bool inside(int y, int x, int H, int W) { return 0 <= y and y < H and 0 <= x and x < W; }\n\nconst std::string YES = \"YES\", Yes = \"Yes\", NO = \"NO\", No = \"No\";\nconst std::vector<int> dy = { 0, 1, 0, -1 }, dx = { 1, 0, -1, 0 };    // 4近傍（右, 下, 左, 上）\n\nusing namespace std;\n\n\nbool big(string a, string b) {\n    if (a.size() != b.size()) {\n        return a.size() > b.size();\n    }\n    FOR(i, 0, a.size()) {\n        if ((a[i] - '0') > (b[i] - '0')) {\n            return true;\n        }\n        else if ((a[i] - '0') < (b[i] - '0')) {\n            return false;\n        }\n    }\n\n    return false;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while (true) {\n        int W, H;\n        cin >> W >> H;\n        if (W == 0 and H == 0) { break; }\n\n        vector<vector<int>> field(H, vector<int>(W, -1));\n        FOR(i, 0, H) {\n            string s;\n            cin >> s;\n            FOR(j, 0, s.size()) {\n                if (s[j] < 'A') {\n                    field[i][j] = (s[j] - '0');\n                }\n            }\n        }\n\n        string ans = \"\";\n        FOR(sy, 0, H) {\n            FOR(sx, 0, W) {\n                if (field[sy][sx] == -1 or field[sy][sx] == 0) {\n                    continue;\n                }\n\n                vector<vector<string>> dp(H, vector<string>(W));\n                dp[sy][sx] = \"\" + to_string(field[sy][sx]);\n\n                stack<pair<int, int>> s;\n                s.push(make_pair(sy, sx));\n                while (not s.empty()) {\n                    int y, x;\n                    tie(y, x) = s.top(); s.pop();\n                    string now = dp[y][x];\n\n                    FOR(i, 0, 2) {\n                        int ny = y + dy[i];\n                        int nx = x + dx[i];\n                        if (inside(ny, nx, H, W) and field[ny][nx] != -1) {\n                            string ns = now + to_string(field[ny][nx]);\n                            if (big(ns, dp[ny][nx])) {\n                                dp[ny][nx] = ns;\n                                if (big(ns, ans)) {\n                                    ans = ns;\n                                }\n                                s.push(make_pair(ny, nx));\n                            }\n                        }\n                    }\n                }\n\n            }\n        }\n\n        print(ans);\n\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <functional>\n#include <numeric>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <utility>\n#include <sstream>\n#include <complex>\n#include <fstream>\n#include <bitset>\n#include <time.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<ll, ll> P;\ntypedef vector<ll> V;\ntypedef complex<double> Point;\n\n#define PI acos(-1.0)\n#define EPS 1e-10\nconst ll INF = (1LL << 31) - 1;\nconst ll MOD = 1e9 + 7;\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define REP(i,N) for(int i=0;i<(N);i++)\n#define ALL(s) (s).begin(),(s).end()\n#define EQ(a,b) (abs((a)-(b))<EPS)\n#define EQV(a,b) ( EQ((a).real(), (b).real()) && EQ((a).imag(), (b).imag()) )\n#define fi first\n#define se second\n#define N_SIZE (1LL << 20)\n#define NIL -1\n#define MAX_N 100100 * 3\n\nint w, h;\nstring s[100];\nstring dp[100][100];\n\nint dx[2] = { 1,0 };\nint dy[2] = { 0,1 };\n\nbool c(int y, int x) {\n\treturn s[y][x] >= '0'&&s[y][x] <= '9';\n}\n\n//void solve(int y, int x, string num) {\n//\tif (c(y, x)) {\n//\t\tif (num.size() == 0) {\n//\t\t\tif(s[y][x] != '0')num += s[y][x];\n//\t\t}\n//\t\telse num += s[y][x];\n//\t}\n//\telse return;\n//\tif (dp[y][x].size() > num.size())return;\n//\telse {\n//\t\tif (dp[y][x] >= num)return;\n//\t}\n//\tdp[y][x] = num;\n//\tREP(i, 2) {\n//\t\tint ny = y + dy[i], nx = x + dx[i];\n//\t\tif (ny >= 0 && ny < h&&nx >= 0 && nx < w) {\n//\t\t\tsolve(ny, nx, num);\n//\t\t}\n//\t}\n//}\n//\n\nint main() {\n\twhile (cin >> w >> h&&w + h) {\n\t\tREP(i, h)cin >> s[i];\n\t\tREP(i, 100)REP(j, 100)dp[i][j] = \"\";\n\t\tREP(i, h)REP(j, w) {\n\t\t\tif (c(i, j))dp[i][j] = s[i][j];\n\t\t\telse dp[i][j] = \"\";\n\t\t}\n\t\tREP(i, h) {\n\t\t\tREP(j, w) {\n\t\t\t\tREP(k, 2) {\n\t\t\t\t\tint ny = i + dy[k], nx = j + dx[k];\n\t\t\t\t\tif (ny < 0 || ny >= h || nx < 0 || nx >= w)continue;\n\t\t\t\t\tif (dp[i][j] != \"0\"&&c(ny, nx)) {\n\t\t\t\t\t\tstring t = dp[i][j] + s[ny][nx];\n\t\t\t\t\t\tif (dp[ny][nx].size() < t.size())dp[ny][nx] = t;\n\t\t\t\t\t\telse if (dp[ny][nx].size() == t.size()) {\n\t\t\t\t\t\t\tif (dp[ny][nx] < t)dp[ny][nx] = t;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring ans[1000];\n\t\tREP(i, 1000)ans[i] = \"\";\n\t\tREP(i, 100) {\n\t\t\tREP(j, 100) {\n\t\t\t\t//if (!dp[i][j].empty())cout << dp[i][j] << \" \";\n\t\t\t\tans[dp[i][j].size()] = max(ans[dp[i][j].size()], dp[i][j]);\n\t\t\t}\n\t\t\t//cout << endl;\n\t\t}\n\t\tfor (int i = 1000 - 1; i >= 0; i--) {\n\t\t\tif (!ans[i].empty()) {\n\t\t\t\tcout << ans[i] << endl;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cctype>\nusing namespace std;\n\nint main(void){\n    int W,H;\n    string dp[2][70];\n    string line,ans;\n    while(cin >> W >> H, W){\n        /*\n        for(int i=0;i<70;i++){\n            dp[0][i].clear();dp[1][i].clear();\n        }*/\n        for(auto& i : dp[1]) i.clear();\n        ans.clear();\n        for(int i=0;i<H;i++){\n            cin >> line;\n            for(int j=0;j<W;j++){\n                dp[i&1][j].clear();\n                if(isdigit(line[j])){\n                    if(dp[(i&1)^1][j]!=\"0\"){\n                        dp[i&1][j]=dp[(i&1)^1][j]+line[j];\n                    }else{\n                        dp[i&1][j].push_back(line[j]);\n                    }\n                    if(j!=0&&dp[i&1][j-1]!=\"0\") dp[i&1][j]=max(dp[i&1][j],dp[i&1][j-1]+line[j],[](const string& a, const string& b){return a.size()==b.size()? a < b : a.size() < b.size();});\n                    ans=max(dp[i&1][j],ans,[](const string& a, const string& b){return a.size()==b.size()? a < b : a.size() < b.size();});\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <iomanip>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <bitset>\n#include <stack>\n#include <utility>\n#include <numeric>\n#include <algorithm>\n#include <functional>\n#include <cctype>\n#include <complex>\n#include <string>\n#include <sstream>\n\nusing namespace std;\n\n#define all(c) c.begin(),c.end()\n#define rall(c) c.rbegin(),c.rend()\n#define mp(a,b) make_pair((a),(b))\n#define eq ==\n\ntypedef long long ll;\ntypedef complex<double> point;\ntypedef pair<int,int> pii;\n\n\nconst double EPS = 1e-9;\n\nstruct State{\n    string str;int y;int x;\n    State(string str,int y,int x) : str(str),y(y),x(x) {};\n};\n\n\nstring maxs(string a,string b){\n    while(a.size() >= 1){\n        if(a[0] != '0') break;\n        a = a.substr(1,a.size()-1);\n    }\n    while(b.size() >= 1){\n        if(b[0] != '0') break;\n        b = b.substr(1,b.size()-1);\n    }\n    if(a.length() > b.length()) return a;\n    if(a.length() < b.length()) return b;\n    for(int i=0;i<a.length();i++){\n        if(a[i] > b[i]) return a;\n        if(a[i] < b[i]) return b;\n    }\n    return a;\n}\nint main(){\n    while(true){\n        int W,H;\n        cin >> W >> H;\n        if(W == 0) break;\n        vector<vector<char> > C(H+2,vector<char>(W+2,'A'));\n        vector<vector<string> > memo(H+2,vector<string>(W+2));\n        stack<State> sta;\n        for(int i=1;i<=H;i++){\n            for(int j=1;j<=W;j++){\n                cin >> C[i][j];\n                if(isalpha(C[i][j])) continue;\n                string s ;\n                s = C[i][j];\n                sta.push(State(s,i,j));\n            }\n        }\n        string ret = \"0\";\n        while(!sta.empty()){\n            string str = sta.top().str;\n            ret = maxs(ret,str);\n            int y = sta.top().y;\n            int x = sta.top().x;\n            sta.pop();\n\n            const int dx[] = {1,0};\n            const int dy[] = {0,1};\n            for(int i=0;i<2;i++){\n                int ny=y+dy[i],nx=x+dx[i];\n                if(isalpha(C[ny][nx])) continue;\n                string newstr = str + C[ny][nx];\n                sta.push(State(newstr,ny,nx));\n            }\n        }\n        cout << ret << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n\nusing namespace std;\n\n#define MAX 72\n\nstring ans;\nchar b[MAX][MAX];\nint w,h;\nvector<vector<string> > m;\n\nstatic inline string maxstr(const string &a,const string &b){\n  if(a.length()!=b.length()){\n    if(a.length()>b.length()) return a;\n    else return b;\n  }else return max(a,b);\n}\n\nstring memo(int x,int y,int d){\n  if(x>=w||y>=h) return \"\";\n  if(!isdigit(b[y][x])) return \"\";\n  if(!m[y][x].empty()) return m[y][x];\n  if(b[y][x]!='0') d++;\n  m[y][x]=b[y][x]+maxstr(memo(x+1,y,d),memo(x,y+1,d));\n  if(d==1&&b[y][x]!='0') ans=maxstr(ans,m[y][x]);\n  return m[y][x];\n}\n\nint main(){\n  while(scanf(\"%d%d \",&w,&h),w+h){\n    m=vector<vector<string> >(h,vector<string>(w));\n    for(int i=0;i<h;i++)\n      gets(b[i]);\n    ans=\"\";\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n        if(!isdigit(b[i][j])||!m[i][j].empty()||(h-i+w-j)<ans.length())\n\t  continue;\n        memo(j,i,0);\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stdio.h>\n#include<string>\nusing namespace std;\nint H,W;\nchar t[700][700],ch;\n\nstring dp[700][700],maxm;\n\nstring strmax(string x,string y){\n  if(x==\"-\"&&y==\"-\")return \"=\";\n  if(x==\"-\")return y;\n  if(y==\"-\")return x;\n  while(x[0]=='0'&&x.size()>=2)x=x.substr(1,x.size()-1);\n  while(y[0]=='0'&&y.size()>=2)y=y.substr(1,y.size()-1);\n  if(x.size()==y.size()){\n    for(int i=0;i<(int)x.size();i++){\n      if(x[i]>y[i]){\n\treturn x;\n      }else if(x[i]<y[i]){\n\treturn y;\n      }\n    }\n    return x;\n  }else if(x.size()>y.size()){\n    return x;\n  }else{\n    return y;\n  }\n}\n\nchar judge(char ch){\n  if('0'<=ch&&ch<='9')return ch;\n  else return '-';\n}\nint main(){\n  int flg;\n  while(cin>>W>>H&&W&&H){\n    scanf(\"%c\",&t[0][0]);\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\tdp[i][j]=\"\";\n\tscanf(\"%c\",&t[i][j]);\n\tif(judge(t[i][j])=='-')flg++;\n      }\n      scanf(\"%c\",&ch);\n    }\n   \n    dp[0][0].push_back(judge(t[0][0])); \n\n    for(int i=1;i<W;i++){\n      if(judge(t[0][i])=='-'){\n\tdp[0][i]=\"-\";\n\tcontinue;\n      }\n      if(dp[0][i-1]!=\"-\")dp[0][i]=dp[0][i-1];      \n      dp[0][i].push_back(judge(t[0][i]));\n    }\n    for(int i=1;i<H;i++){\n      if(judge(t[i][0])=='-'){\n\tdp[i][0]=\"-\";\n\tcontinue;\n      }\n      if(dp[i-1][0]!=\"-\")dp[i][0]=dp[i-1][0];      \n      dp[i][0].push_back(judge(t[i][0]));\n    }\n\n    maxm=\"0\";\n    for(int i=1;i<H;i++){\n      for(int j=1;j<W;j++){\n\tif(judge(t[i][j])=='-'){\n\t  dp[i][j]=\"0\";\n\t  continue;\n\t}\n\t\n\tdp[i][j]=strmax(dp[i-1][j],dp[i][j-1]);\n\tif(dp[i][j]!=\"-\")dp[i][j].push_back(t[i][j]);\n\t\n\n      }\n    }\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\t//cout<<dp[i][j]<<endl;\n\tmaxm=strmax(dp[i][j],maxm);\n      }\n    }\n    cout<<maxm<<endl;\n    \n  }\n  return 0;\n  \n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <complex>\n#include <deque>\n#include <exception>\n#include <fstream>\n#include <functional>\n#include <iomanip>\n#include <ios>\n#include <iosfwd>\n#include <iostream>\n#include <istream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <locale>\n#include <map>\n#include <memory>\n#include <new>\n#include <numeric>\n#include <ostream>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <stdexcept>\n#include <streambuf>\n#include <string>\n#include <typeinfo>\n#include <utility>\n#include <valarray>\n#include <vector>\n#include <climits>\n\n#define rep(i, m, n) for(int i=int(m);i<int(n);i++)\n//#define EACH(i, c) for (auto &(i): c)\n#define all(c) begin(c),end(c)\n//#define EXIST(s, e) ((s).find(e)!=(s).end())\n//#define SORT(c) sort(begin(c),end(c))\n//#define pb emplace_back\n//#define MP make_pair\n//#define SZ(a) int((a).size())\n\n//#define LOCAL 0\n//#ifdef LOCAL\n//#define DEBUG(s) cout << (s) << endl\n//#define dump(x)  cerr << #x << \" = \" << (x) << endl\n//#define BR cout << endl;\n//#else\n//#define DEBUG(s) do{}while(0)\n//#define dump(x) do{}while(0)\n//#define BR\n//#endif\n\n\n//改造\ntypedef long long int ll;\nusing namespace std;\n#define INF (1 << 30) - 1\n#define INFl (ll)5e15\n#define DEBUG 0 //デバッグする時1にしてね\n#define dump(x)  cerr << #x << \" = \" << (x) << endl\n#define MOD 1000000007\n//ここから編集する\nint W, H;\nvector<string> vv;\nstring dp[70][70];\n\nbool integer(char c) {\n    return c >= '0' && c <= '9';\n}\n\nstring parse(string str) {\n    int start = 0;\n    for (start = 0; str[start] == '0' && start < str.size(); start++) {\n\n    }\n    return str.substr(start);\n}\n\nbool lt(string left, string right) {\n//    left = parse(left);\n//    right = parse(right);\n    if (left.size() < right.size()) {\n        return true;\n    } else if (left.size() > right.size()) {\n        return false;\n    } else {\n        rep(i, 0, left.size()) {\n            if (left[i] != right[i]) {\n                return left[i] < right[i];\n            }\n        }\n    }\n    return false;\n}\n\nstring dfs(int sh, int sw) {\n    if (dp[sh][sw] != \".\") return dp[sh][sw];\n    if (!integer(vv[sh][sw])) {\n        return \"\";\n    }\n    if (sh < H - 1 && sw < W - 1) {\n        string right;\n        right += vv[sh][sw];\n        right += dfs(sh, sw + 1);\n\n        string down;\n        down += vv[sh][sw];\n        down += dfs(sh + 1, sw);\n        if (lt(right, down)) {\n            return dp[sh][sw] = down;\n        } else {\n            return dp[sh][sw] = right;\n        }\n    } else if (sh < H - 1 && sw == W - 1) {\n        string down;\n        down += vv[sh][sw];\n        down += dfs(sh + 1, sw);\n        return dp[sh][sw] = down;\n\n    } else if (sh == H - 1 && sw < W - 1) {\n        string right;\n        right += vv[sh][sw];\n        right += dfs(sh, sw + 1);\n        return dp[sh][sw] = right;\n\n    } else if (sh == H - 1 && sw == W - 1) {\n        string ret = \"\";\n        ret += vv[sh][sw];\n        return dp[sh][sw] = ret;\n    }\n    return \"\";\n}\n\nbool solve() {\n    cin >> W >> H;\n    if (W == 0 && H == 0) {\n        return false;\n    }\n    vv.resize(H);\n    rep(i, 0, 70) {\n        rep(j, 0, 70) {\n            dp[i][j] = \".\";\n        }\n    }\n\n    rep(i, 0, H) {\n        cin >> vv[i];\n    }\n\n    string ans = \"\";\n    rep(sh, 0, H) {\n        rep(sw, 0, W) {\n            string tmp = parse(dfs(sh, sw));\n            if (lt(ans, tmp)) {\n                ans = tmp;\n            }\n        }\n    }\n    cout << ans << endl;\n\n    return true;\n\n\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while (solve()) {\n\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i, n) for(int i=0; i<(n); ++i)\n\nchar C[71][71];\nchar visited[71][71];\nint W, H;\nbool isNum(char c) {\n    if(c >= '0' && c <= '9') return true;\n    else return false;\n}\nstring max_str(string a, string b) {\n    if(a.size() > b.size()) return a;\n    if(a.size() < b.size()) return b;\n    rep(i, a.size()) {\n        if(a[i] > b[i]) return a;\n        if(a[i] < b[i]) return b;\n    }\n    return a;\n}\nstring dfs(int y, int x, string sum) {\n    if(visited[y][x] == 1) return sum;\n    if((y+1>=H || !isNum(C[y+1][x])) && (x+1>=W || !isNum(C[y][x+1]))) {\n        visited[y][x] = 1;\n        return sum+C[y][x];\n    }\n    string down, right;\n    if(y+1<H && isNum(C[y+1][x])) {\n        if(sum == \"\" && C[y][x] == '0') down = dfs(y+1, x, sum);\n        else down = dfs(y+1, x, sum+C[y][x]);\n    }\n    if(x+1<W && isNum(C[y][x+1])) {\n        if(sum == \"\" && C[y][x] == '0') right = dfs(y, x+1, sum);\n        else right = dfs(y, x+1, sum+C[y][x]);\n    }\n    visited[y][x] = 1;\n    return max_str(down, right);\n}\n\nint main(void){\n    while(cin >> W >> H && W) {\n        rep(i, H)  rep(j, W) cin >> C[i][j];\n        rep(i, H)  rep(j, W) visited[i][j] = 0;\n        string ans;\n        rep(i, H) rep(j, W) {\n            if(isNum(C[i][j])) ans = max_str(ans, dfs(i, j, \"\"));\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <cctype>\n#include <complex>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <deque>\n#include <functional>\n#include <iomanip>\n#include <iostream>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <utility>\n#include <vector>\n\nusing namespace std;\n\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\ntemplate<class T> inline T sqr(T x) {return x*x;}\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\n#define all(a)  (a).begin(),(a).end()\n#define rall(a) (a).rbegin(), (a).rend()\n#define pb push_back\n#define mp make_pair\n#define each(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define exist(s,e) ((s).find(e)!=(s).end())\n#define range(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)  range(i,0,n)\n#define clr(a,b) memset((a), (b) ,sizeof(a))\n#define dump(x)  cerr << #x << \" = \" << (x) << endl;\n#define debug(x) cerr << #x << \" = \" << (x) << \" (L\" << __LINE__ << \")\" << \" \" << __FILE__ << endl;\n\nconst double eps = 1e-10;\nconst double pi  = acos(-1.0);\nconst ll INF =1LL << 62;\nconst int inf =1 << 29;\n\nint dx[] = {0, 1};\nint dy[] = {1, 0};\n\nstring cmp(string, string);\n\nint main(void){\n    for(int w, h; cin >> w >> h, w;){\n        vector<string> c(h);\n        rep(y, h){\n            cin >> c[y];\n        }\n\n        vector<vs> dp(h, vs(w));\n        \n        for(int y = h - 1; 0 <= y; y--){\n            for(int x = w - 1; 0 <= x; x--){\n                if('A' <= c[y][x] && c[y][x] <= 'Z') continue;\n\n                string right, under;\n                right = x + 1 < w ? dp[y][x + 1]:\"\";\n                under = y + 1 < h ? dp[y + 1][x]:\"\";\n\n                right.insert(0, 1, c[y][x]);\n                under.insert(0, 1, c[y][x]);\n\n                dp[y][x] = cmp(right, under);\n            }\n        }\n\n        string res = \"0\";\n        rep(y, h) rep(x, w) res = c[y][x] != '0' ? cmp(res, dp[y][x]):res;\n\n        cout << res << endl;\n    }\n\n\treturn 0;\n}\n\nstring cmp(string a, string b){\n    if(a.size() > b.size()){\n        return a;\n    }\n    else if(a.size() < b.size()){\n        return b;\n    }\n    else{\n        if(a > b){\n            return a;\n        }\n        else return b;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <iostream>\n#include <string>\n#include <vector>\n\nusing namespace std;\n\ntypedef vector<string> VS;\ntypedef vector<VS> VVS;\n\nvoid remove_leading_zeros ( string& str )\n{\n\twhile ( str[0] == '0' ) { str = str.substr( 1 ); }\n}\n\nbool str_comp( const string& a, const string& b )\n{\n\tif ( a.size() != b.size() ) {;\n\t\treturn a.size() < b.size();\n\t}\n\treturn a < b;\n}\n\nint main ( void )\n{\n\tint w, h;\n\twhile ( cin >> w >> h, w | h ) {\n\t\tVS mat( h );\n\t\tfor ( int i = 0; i < h; ++i ) {\n\t\t\tcin >> mat[i];\n\t\t}\n\n\t\tVVS d( h, VS( w, \"\" ) );\n\n\t\tstring ans = \"\";\n\t\tfor ( int y = 0; y < h; ++y ) {\n\t\t\tfor ( int x = 0; x < w; ++x ) {\n\t\t\t\tif ( !isdigit( mat[y][x] ) ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif ( y ) {\n\t\t\t\t\td[y][x] = max( d[y][x], d[y - 1][x] + mat[y][x], str_comp );\n\t\t\t\t\tremove_leading_zeros( d[y][x] );\n\t\t\t\t}\n\t\t\t\tif ( x ) {\n\t\t\t\t\td[y][x] = max( d[y][x], d[y][x - 1] + mat[y][x], str_comp );\n\t\t\t\t\tremove_leading_zeros( d[y][x] );\n\t\t\t\t}\n\t\t\t\t//cout << x << \", \" << y << \" = \" << d[y][x] << endl;\n\t\t\t\tans = max( ans, d[y][x], str_comp );\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr,__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n#define SZ(a) ((int)(a).size())\n#define BIT(x, i) (((x) >> (i)) & 1)\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\n\nint W, H;\nchar field[70][70];\nbool seen[70][70];\nbool number[70][70];\nvector<string> v;\n\nconst int dx[] = {1,0}, dy[] = {0,1};\n\nvoid dfs(int x, int y, vector<char>& cs) {\n    seen[y][x] = true;\n    bool noway = true;\n    REP(i, 2) {\n        int sx = x + dx[i], sy = y + dy[i];\n        if (0 <= sx && sx < W && 0 <= sy && sy < H && number[sy][sx]) {\n            vector<char> copy(cs);\n            copy.push_back(field[sy][sx]);\n            dfs(sx, sy, copy);\n            noway = false;\n        }\n    }\n    if (noway) {\n        // ?????????0?????????\n        for (auto it = cs.begin(); it != cs.end(); ) {\n            if (*it == '0') {\n                it = cs.erase(it);\n            } else {\n                break;\n            }\n        }\n        string s = string(ALL(cs));\n        if (SZ(v) == 0) {\n            v.push_back(s);\n        } else if (v[0].length() == s.length()) {\n            v.push_back(s);\n        } else if (v[0].length() < s.length()) {\n            v.clear();\n            v.push_back(s);\n        }\n//        LOG(\"--> %s\\n\", s.c_str());\n    }\n}\n\nint main() {\n    while (cin >> W >> H, W|H) {\n        v.clear();\n        fill_n((bool *)seen, 70*70, false);\n        fill_n((bool *)number, 70*70, false);\n        REP(y, H) REP(x, W) {\n            cin >> field[y][x];\n            if (isdigit(field[y][x])) {\n                number[y][x] = true;\n            }\n        }\n        REP(y, H) REP(x, W) {\n            if (number[y][x] && !seen[y][x]) {\n                vector<char> cs{field[y][x]};\n                dfs(x, y, cs);\n            }\n        }\n        RSORT(v);\n        cout << v[0] << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <complex>\n#include <deque>\n#include <exception>\n#include <fstream>\n#include <functional>\n#include <iomanip>\n#include <ios>\n#include <iosfwd>\n#include <iostream>\n#include <istream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <locale>\n#include <map>\n#include <memory>\n#include <new>\n#include <numeric>\n#include <ostream>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <stdexcept>\n#include <streambuf>\n#include <string>\n#include <typeinfo>\n#include <utility>\n#include <valarray>\n#include <vector>\n#include <climits>\n\n#define rep(i, m, n) for(int i=int(m);i<int(n);i++)\n//#define EACH(i, c) for (auto &(i): c)\n#define all(c) begin(c),end(c)\n//#define EXIST(s, e) ((s).find(e)!=(s).end())\n//#define SORT(c) sort(begin(c),end(c))\n//#define pb emplace_back\n//#define MP make_pair\n//#define SZ(a) int((a).size())\n\n//#define LOCAL 0\n//#ifdef LOCAL\n//#define DEBUG(s) cout << (s) << endl\n//#define dump(x)  cerr << #x << \" = \" << (x) << endl\n//#define BR cout << endl;\n//#else\n//#define DEBUG(s) do{}while(0)\n//#define dump(x) do{}while(0)\n//#define BR\n//#endif\n\n\n//改造\ntypedef long long int ll;\nusing namespace std;\n#define INF (1 << 30) - 1\n#define INFl (ll)5e15\n#define DEBUG 0 //デバッグする時1にしてね\n#define dump(x)  cerr << #x << \" = \" << (x) << endl\n#define MOD 1000000007\n//ここから編集する\nint W, H;\nvector<string> vv;\nstring dp[70][70][70][70];\n\nbool integer(char c) {\n    return c >= '0' && c <= '9';\n}\n\nstring parse(string str) {\n    int start = 0;\n    for (start = 0; str[start] == '0' && start < str.size(); start++) {\n\n    }\n    return str.substr(start);\n}\n\nbool lt(string left, string right) {\n//    left = parse(left);\n//    right = parse(right);\n    if (left.size() < right.size()) {\n        return true;\n    } else if (left.size() > right.size()) {\n        return false;\n    } else {\n        rep(i, 0, left.size()) {\n            if (left[i] != right[i]) {\n                return left[i] < right[i];\n            }\n        }\n    }\n    return false;\n}\n\nstring dfs(int sh, int sw, int th, int tw) {\n    if (dp[sh][sw][th][tw] != \".\") {\n        return dp[sh][sw][th][tw];\n    }\n    if (!integer(vv[sh][sw]) || !integer(vv[th][tw])) {\n        return dp[sh][sw][th][tw] = \"\";\n    }\n    string ret = \"\";\n    if (sh == th && sw == tw) {\n        ret += vv[sh][sw];\n        return dp[sh][sw][th][tw] = ret;\n    }\n    if (th - sh + tw - sw == 1) {\n        ret += vv[sh][sw];\n        ret += vv[th][tw];\n        return dp[sh][sw][th][tw] = ret;\n    }\n\n\n    rep(mh, sh, th + 1) {\n        rep(mw, sw, tw + 1) {\n            if (sh == mh && sw == mw) {\n                continue;\n            }\n            if (mh == th && mw == tw) {\n                continue;\n            }\n            string left = dfs(sh, sw, mh, mw);\n            string right = dfs(mh, mw, th, tw);\n            if (left.size() > 0 && right.size() > 0) {\n                string tmp = \"\";\n                tmp += left.substr(0, left.size() - 1);\n                tmp += right;\n                if (lt(ret, tmp)) {\n                    ret = tmp;\n                }\n            }\n\n        }\n    }\n    return dp[sh][sw][th][tw] = ret;\n\n\n}\n\nbool solve() {\n    cin >> W >> H;\n    if (W == 0 && H == 0) {\n        return false;\n    }\n    vv.resize(H);\n    rep(i, 0, 75) {\n        rep(j, 0, 75) {\n            rep(k, 0, 75) {\n                rep(l, 0, 75) {\n                    dp[i][j][k][l] = \".\";\n                }\n            }\n        }\n    }\n\n    rep(i, 0, H) {\n        cin >> vv[i];\n    }\n\n    string ans = \"\";\n    rep(sh, 0, H) {\n        rep(th, sh, H) {\n            rep(sw, 0, W) {\n                rep(tw, sw, W) {\n                    string tmp = parse(dfs(sh, sw, th, tw));\n                    if (lt(ans, tmp)) {\n                        ans = tmp;\n                    }\n                }\n            }\n        }\n    }\n    cout << ans << endl;\n\n    return true;\n\n\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while (solve()) {\n\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\nint w, h;\nint gc;\nstring s[51], dp[51][51];\nbool is_num(char c){return '0'<=c && c<= '9';}\n\nstring str_max(const string& s1, const string& s2) {\n  if (s1.size() == s2.size()) {\n    return (s1 > s2) ? s1 : s2 ;\n  }\n  return (s1.size() > s2.size())? s1 : s2 ;\n}\n\nstring dfs(int i, int j) {\n  string res = \"\";\n  \n  if (!is_num(s[i][j])) return res;\n  if (i >= h || j >= w) return res;\n  // DP\n  if (dp[i][j] != \"\") return dp[i][j];\n  \n  //gc++;\n\n  res = s[i][j] + str_max(dfs(i, j+1), dfs(i+1, j));\n  \n  // ªÉ0ªÂ¢Ä¢éêÍæé\n  if (i == 0 && j == 0) {\n    if (res[0] == '0') res.erase(0, 1);\n  } else if (i == 0) {\n    if (!is_num(s[i][j-1]) && res[0] == '0') res.erase(0, 1);\n  } else if (j == 0) {\n    if (!is_num(s[i-1][j]) && res[0] == '0') res.erase(0, 1);\n  } else{\n    if (!is_num(s[i-1][j]) && !is_num(s[i][j-1])) res.erase(0, 1);\n  }\n  \n  return dp[i][j] = res;\n}\n\nvoid solve() {\n  for(int i=0;i<h;i++) cin>>s[i];\n  // init\n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  dp[i][j] = \"\";\n  \n  // search\n  string largest = \"\";\n  //gc = 0;\n  \n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  if (\n    dp[i][j] == \"\" &&\n    is_num(s[i][j]) &&\n    (i == 0 || !is_num(s[i-1][j])) &&\n    (j == 0 || !is_num(s[i][j-1]))\n    )\n  largest = str_max(dfs(i, j), largest);\n  \n  /*\n  for(int i=0;i<h;i++) {\n    for(int j=0;j<w;j++) cout<<\"[\"<<dp[i][j]<<\"]\";\n    cout<<endl;\n  }\n  */\n  //cout<<gc<<endl;\n  cout<<largest<<endl;\n}\n\nint main (int argc, char const* argv[]) {\n  while (cin>>w>>h, w||h) {\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cctype>\n#include <vector>\nusing namespace std;\n\nint W, H;\nchar field[100][100];\nstring dp[100][100];\n\nbool compare(const string& s1, const string& s2){\n  if(s1.size() != s2.size()) return !(s1.size() > s2.size());\n  else return !(s1 > s2);\n}\n\nvoid output(){  \n  for(int i = 0 ; i < H ; i++){\n    for(int j = 0 ; j < W ; j++){\n      cout << dp[i][j] << ' ';\n    }\n    cout << endl;\n  }\n}\n\nvoid init(){\n  for(int i = 0 ; i < 71 ; i++){\n    for(int j = 0 ; j < 71 ; j++){\n      dp[i][j] = \"\";\n    }\n  }\n}\n\nstring adjust(string s){\n  if(s.size() == 1) return s;\n  bool f = false;\n  for(int i = 0 ; i < s.size() ; i++){\n    if(s[i] != '0') f = true;\n  }\n  if(!f) return \"0\";\n  for(int i = 0 ; i < s.size() ; i++){\n    if(s[i] == '0') continue;\n    else{\n      //cout << s.substr(i) << endl;\n      return s.substr(i);\n    }\n  }\n}\n\nint main(){\n  while(cin >> W >> H){\n    if(W == 0 && H == 0) break;\n    init();\n    vector<string> vec;\n    vec.clear();\n    for(int i = 0 ; i < H ; i++){\n      for(int j = 0 ; j < W ; j++){\n\tcin >> field[i][j];\n      }\n    }\n    \n    string ans = \"\";\n    \n    for(int i = 0 ; i < H ; i++){\n      for(int j = 0 ; j < W ; j++){\n\tif(!isdigit(field[i][j])) continue;\n\tif(i == 0 && j == 0) dp[i][j] = field[i][j];\n\telse if(i == 0) dp[i][j] = dp[i][j-1] + field[i][j];\n\telse if(j == 0)\tdp[i][j] = dp[i-1][j] + field[i][j];\n\telse dp[i][j] = max(dp[i][j-1]+field[i][j], dp[i-1][j]+field[i][j], compare);\n\tvec.push_back(dp[i][j]);\n      }\n    }\n    for(int i = 0 ; i < vec.size() ; i++){\n      vec[i] = adjust(vec[i]);\n      ans = max(ans, vec[i], compare);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cstdio>\n#include <cstring>\n\nusing namespace std;\n\n\nint W, H;\nvector<string> map;\n\nstring maxstr(string s1, string s2) {\n\tif ((int)s1.size() >(int)s2.size()) return s1;\n\tif ((int)s2.size() > (int)s1.size()) return s2;\n\treturn max(s1, s2);\n}\n\nstring solver() {\n\tvector< vector<string> > dp(H, vector<string>(W, \"\"));\n\t\n\tstring res = \"\";\n\t\n\tfor (int i = 0; i<H; i++) {\n\t\t\n\t\tfor (int j=0; j<W; j++) {\n\t\t\t\n\t\t\tif ('0' <= map[i][j] && map[i][j] <= '9') {\n\t\t\t\tif (i > 0) {\n\t\t\t\t\tif (j > 0) dp[i][j] = maxstr(dp[i-1][j], dp[i][j-1]) + map[i][j];\n\t\t\t\t\telse dp[i][j] = dp[i-1][j] + map[i][j];\n\t\t\t\t} else {\n\t\t\t\t\tif (j > 0) dp[i][j] = dp[i][j - 1] + map[i][j];\n\t\t\t\t\telse dp[i][j] = map[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (dp[i][j] == \"0\") dp[i][j] = \"\";\n\t\t\tres = maxstr(res, dp[i][j]);\n\t\t}\n\t}\n\t\n\treturn res;\n}\n\nint main() {\n\twhile (1) {\n\t\tcin >> W >> H; if (W==0 && H==0) break;\n\t\t\n\t\tmap.clear();\n\t\tmap.assign(H, \"\");\n\t\tfor (int i=0; i<H; i++) cin >> map[i];\n\t\t\n\t\t cout << solver() << endl;\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nbool compare(string s, string t){\n    if (s.size() > t.size()) return true;\n    if (s.size() < t.size()) return false;\n    int k = (int)s.size();\n    for (int i = 0; i < k; i++){\n        if (s[i] > t[i]) return true;\n        if (t[i] > s[i]) return false;\n    }\n    return true;\n}\n\nint main(){\n    while (1){\n        int w, h;\n        cin >> w >> h;\n        if (h == 0) break;\n        vector<vector<char>> c(h, vector<char>(w));\n        for (int i = 0; i < h; i++){\n            for (int j = 0; j < w; j++) cin >> c[i][j];\n        }\n        vector<vector<string>> ans(h, vector<string>(w, \"0\"));\n        for (int i = 0; i < h; i++){\n            for (int j = 0; j < w; j++){\n                if (c[i][j] - '0' < 0 || c[i][j] - '0' > 9) continue;\n                string cc = \"\";\n                cc += c[i][j];\n                if (compare(cc, ans[i][j])){\n                    ans[i][j] = cc;\n                }\n                if (i > 0){\n                    if (ans[i-1][j] != \"0\" && compare(ans[i-1][j] + cc, ans[i][j])){\n                        ans[i][j] = ans[i-1][j]  + cc;\n                    }\n                }\n                if (j > 0){\n                    if (ans[i][j-1] != \"0\" && compare(ans[i][j-1] + cc, ans[i][j])){\n                        ans[i][j] = ans[i][j-1] + cc;\n                    }\n                }\n            }\n        }\n        string aaa = \"0\";\n        for (int i = 0; i < h; i++){\n            for (int j = 0; j < w; j++){\n                if (compare(ans[i][j], aaa)) aaa = ans[i][j];\n            }\n        }\n\n        cout << aaa << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <cmath>\n#include <cstdio>\n#include <functional>\n#include <numeric>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <utility>\n#include <sstream>\n#include <complex>\n#include <fstream>\n#include <bitset>\n#include <time.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<ll, ll> P;\ntypedef vector<ll> V;\ntypedef complex<double> Point;\n\n#define PI acos(-1.0)\n#define EPS 1e-10\nconst ll INF = (1LL << 31) - 1;\nconst ll MOD = 1e9 + 7;\n\n#define FOR(i,a,b) for(int i=(a);i<(b);i++)\n#define REP(i,N) for(int i=0;i<(N);i++)\n#define ALL(s) (s).begin(),(s).end()\n#define EQ(a,b) (abs((a)-(b))<EPS)\n#define EQV(a,b) ( EQ((a).real(), (b).real()) && EQ((a).imag(), (b).imag()) )\n#define fi first\n#define se second\n#define N_SIZE (1LL << 20)\n#define NIL -1\n#define MAX_N 100100 * 3\n\nint w, h;\nstring s[100];\n\nint dx[2] = { 1,0 };\nint dy[2] = { 0,1 };\n\nvector<string> vs;\n\nbool c(int y, int x) {\n\tif (y >= 0 && y < h&&x >= 0 && x < w) {\n\t\treturn s[y][x] >= '0'&&s[y][x] <= '9';\n\t}\n\treturn false;\n}\n\nvoid solve(int y, int x, string num) {\n\tnum += s[y][x];\n\tbool f = 1;\n\tREP(i, 2) {\n\t\tif (c(y + dy[i], x + dx[i])) {\n\t\t\tf = 0;\n\t\t\tsolve(y + dy[i], x + dx[i], num);\n\t\t}\n\t}\n\tif (f)vs.push_back(num);\n}\n\n\nint main() {\n\twhile (cin >> w >> h&&w + h) {\n\t\tvs.clear();\n\t\tREP(i, h)cin >> s[i];\n\t\tREP(i, h) {\n\t\t\tREP(j, w) {\n\t\t\t\tif (s[i][j] == '0')continue;\n\t\t\t\tif (c(i, j))solve(i, j, \"\");\n\t\t\t}\n\t\t}\n\t\tsort(ALL(vs));\n\t\tstring ans[100];\n\t\tREP(i, 100)ans[i] = \"0\";\n\t\tREP(i, vs.size()) {\n\t\t\tans[vs[i].size()] = max(ans[vs.size()], vs[i]);\n\t\t}\n\t\tfor (int i = 100 - 1; i >= 0; i--) {\n\t\t\tif (ans[i] != \"0\") {\n\t\t\t\tcout << ans[i] << endl;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define rep(i, n) for(int i=0; i<n; i++)\n\ninline string max(const string& a, const string& b)\n{\n  if(a.length() < b.length()) return b;\n  if(a.length() > b.length()) return a;\n  return a < b ? b : a;\n}\n\nint W, H;\nchar C[77][77];\nstring dp[77][77];\n\nint main(int argc, char *argv[])\n{\n\n  while(cin >> W >> H, W){\n    rep(i, H) rep(j, W) cin >> C[i][j];\n    rep(i, H) rep(j, W) dp[i][j] = \"\";\n    if(C[0][0] > '0' && C[0][0] <= '9') dp[0][0] = C[0][0];\n    rep(i, H) rep(j, W) if(i || j){\n      if(C[i][j] >= '0' && C[i][j] <= '9'){\n        if(i && (C[i][j] > '0' || dp[i - 1][j] != \"\")) dp[i][j] = max(dp[i][j], string(dp[i - 1][j] + C[i][j]));\n        if(j && (C[i][j] > '0' || dp[i][j - 1] != \"\")) dp[i][j] = max(dp[i][j], string(dp[i][j - 1] + C[i][j]));\n      }\n    }\n    string res = \"\";\n    rep(i, H) rep(j, W) res = max(res, dp[i][j]);\n    cout << (res == \"\" ? \"0\" : res) << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\n#include<algorithm>\n#define F first\n#define S second\nusing namespace std;\ntypedef pair<int,int> P;\ntypedef vector<vector<char> > VVC;\nint dx[] = {0,1};\nint dy[] = {1,0};\nvector<string> message;\nint h,w;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() != b.size())\n    return a.size() > b.size();\n\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] > b[i];\n  return true;\n}\n\nvoid dfs(string secret,P p,VVC& G)\n{\n  bool update = false;\n  for(int i=0;i<2;i++)\n    {\n      int nx = p.F + dx[i];\n      int ny = p.S + dy[i];\n      if(!(0 <= nx && nx < w && 0 <= ny && ny < h) || !('0'<=G[ny][nx] && G[ny][nx]<='9' ))\n\tcontinue;\n\n      update = true;\n      dfs(secret+G[ny][nx],P(nx,ny),G);\n    }\n\n  if(!update)\n    message.push_back(secret);\n}\n\nint main()\n{\n\n  while(true)\n    {\n      cin >> w >> h;\n      if(w+h == 0)\n\tbreak;\n      message.clear();\n      VVC G;\n      G.resize(h);\n      for(int i=0;i<h;i++)\n\t{\n\t  G[i].resize(w);\n\t  for(int j=0;j<w;j++)\n\t    cin >> G[i][j];\n\t}\n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\t      if('0' <= G[i][j] && G[i][j] <= '9')\n\t\t{\n\t\t  string mes;\n\t\t  mes += G[i][j];\n\t\t  dfs(mes,P(j,i),G);\n\t\t}\n\t    }\n\t}\n\n      sort(message.begin(),message.end(),cmp);\n      cout << message[0] << endl;\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//tempaa\n//#pragma GCC optimize (\"-O3\")\n#ifdef _DEBUG\n#include<cassert>\n#include \"bits_stdc++.h\"\n#else\n#include <bits/stdc++.h>\n#endif\n\n#define r_ return\n#define v_ vector\n#define t_T template<class T>\n\nusing namespace std;\n//@起動時\nstruct initon {\n    initon() {\n        cin.tie(0);\n        ios::sync_with_stdio(false);\n        cout.setf(ios::fixed);\n        cout.precision(16);\n        srand((unsigned) clock() + (unsigned) time(NULL));\n    };\n} __initon;\n//衝突対策\n#define ws ___ws\n#define over4(o1, o2, o3, o4, name, ...) name\n\n#define int long long\n#define ll long long\n#define double long double\n#define ull unsigned long long\nusing dou = double;\nusing itn = int;\nusing str = string;\nusing bo= bool;\n#define au auto\nusing P = pair<ll, ll>;\n\n#define fi first\n#define se second\n#define vec v_\n#define beg begin\n#define rbeg rbegin\n#define con continue\n#define bre break\n#define brk break\n#define is ==\nusing vi = v_<ll>;\nusing vb = v_<bool>;\nusing vs = v_<string>;\nusing vd = v_<double>;\nusing vc = v_<char>;\nusing vp = v_<P>;\n\n//#define V v_\n#define vvt0(t) v_<v_<t>>\n#define vvt1(t, a) v_<v_<t>>a\n#define vvt2(t, a, b) v_<v_<t>>a(b)\n#define vvt3(t, a, b, c) v_<v_<t>> a(b,v_<t>(c))\n#define vvt4(t, a, b, c, d) v_<v_<t>> a(b,v_<t>(c,d))\n\n#define vvi(...) over4(__VA_ARGS__,vvt4,vvt3,vvt2 ,vvt1,vvt0)(ll,__VA_ARGS__)\n#define vvb(...) over4(__VA_ARGS__,vvt4,vvt3,vvt2 ,vvt1,vvt0)(bool,__VA_ARGS__)\n#define vvs(...) over4(__VA_ARGS__,vvt4,vvt3,vvt2 ,vvt1,vvt0)(string,__VA_ARGS__)\n#define vvd(...) over4(__VA_ARGS__,vvt4,vvt3,vvt2 ,vvt1,vvt0)(double,__VA_ARGS__)\n#define vvc(...) over4(__VA_ARGS__,vvt4,vvt3,vvt2 ,vvt1,vvt0)(char,__VA_ARGS__)\n#define vvp(...) over4(__VA_ARGS__,vvt4,vvt3,vvt2 ,vvt1,vvt0)(P,__VA_ARGS__)\n\n\n#define v3i(a, b, c, d) v_<v_<vi>> a(b, v_<vi>(c, vi(d)))\n#define v3d(a, b, c, d) v_<v_<vd>> a(b, v_<vd>(c, vd(d)))\n#define v3m(a, b, c, d) v_<v_<vm>> a(b, v_<vm>(c, vm(d)))\n\n\n#define PQ priority_queue<ll, v_<ll>, greater<ll> >\n#define tos to_string\n\nusing mapi = map<int, int>;\nusing mapd = map<dou, int>;\nusing mapc = map<char, int>;\nusing maps = map<str, int>;\nusing seti = set<int>;\nusing setd = set<dou>;\nusing setc = set<char>;\nusing sets = set<str>;\nusing qui = queue<int>;\n#define bset bitset\n#define uset unordered_set\n#define mset multiset\n#define umap unordered_map\n#define umapi unordered_map<int,int>\n#define umapp unordered_map<P,int>\n#define mmap multimap\n\n//マクロ 繰り返し\n#define _overloadrep(_1, _2, _3, _4, name, ...) name\n# define _rep(i, n) for(int i = 0,_lim=n; i < _lim ; i++)\n#define repi(i, m, n) for(int i = m,_lim=n; i < _lim ; i++)\n#define repadd(i, m, n, ad) for(int i = m,_lim=n; i < _lim ; i+= ad)\n#define rep(...) _overloadrep(__VA_ARGS__,repadd,repi,_rep,)(__VA_ARGS__)\n#define _rer(i, n) for(int i = n; i >= 0 ; i--)\n#define reri(i, m, n) for(int i = m,_lim=n; i >= _lim ; i--)\n#define rerdec(i, m, n, dec) for(int i = m,_lim=n; i >= _lim ; i-=dec)\n#define rer(...) _overloadrep(__VA_ARGS__,rerdec,reri,_rer,)(__VA_ARGS__)\n#define fora(a, b) for(auto&& a : b)\n\n//マクロ 定数\n#define k3 1010\n#define k4 10101\n#define k5 101010\n#define k6 1010101\n#define k7 10101010\n\nt_T T MAX() { r_ numeric_limits<T>::max(); }\nt_T T MIN() { r_ numeric_limits<T>::min(); }\nconst int inf = (int) 1e9 + 100;\nconst ll linf = (ll) 1e18 + 100;\nt_T T INF() { r_ MAX<T>() / 2; }\ntemplate<> signed INF() { r_ inf; }\ntemplate<> ll INF() { r_ linf; }\ntemplate<> double INF() { r_ (double) linf * linf; }\n\nconst double eps = 1e-9;\nconst double PI = 3.1415926535897932384626433832795029L;\nll ma = numeric_limits<ll>::min();\nll mi = numeric_limits<ll>::max();\nconst int y4[] = {-1, 1, 0, 0};\nconst int x4[] = {0, 0, -1, 1};\nconst int y8[] = {0, 1, 0, -1, -1, 1, 1, -1};\nconst int x8[] = {1, 0, -1, 0, 1, -1, 1, -1};\n\n//マクロ省略形 関数等\n#define sz(a) ((int)(a).size())\n#define rs resize\n#define mp make_pair\n#define pb push_back\n#define pf push_front\n#define eb emplace_back\n#define all(a) (a).begin(),(a).end()\n#define rall(a) (a).rbegin(),(a).rend()\n\n/*@formatter:off*/\ninline void sort(string &a) { sort(all(a)); }\nt_T inline void sort(v_<T> &a) { sort(all(a)); };\nt_T inline void rsort(v_<T> &a) { sort(all(a), greater<T>()); };\ntemplate<class U> inline void sortp(v_<U> &a, v_<U> &b) {    vp c;    int n = sz(a);    assert(n == sz(b));    rep(i, n)c.eb(a[i], b[i]);    sort(c);    rep(i, n) {        a[i] = c[i].first;        b[i] = c[i].second;;    }};//F = T<T>\n//例えばr_ p.fi + p.se;\ntemplate<class U> inline void rsortp(v_<U> &a, v_<U> &b) {    vp c;    int n = sz(a);    assert(n == sz(b));    rep(i, n)c.eb(a[i], b[i]);    rsort(c);    rep(i, n) {        a[i] = c[i].first;        b[i] = c[i].second;    }};\ntemplate<typename V, typename T>\nvoid fill(V &xx, const T vall) {xx = vall;}\ntemplate<typename V, typename T>\nvoid fill(v_<V> &vecc, const T vall) {for (auto &&vx: vecc) fill(vx, vall);}\n\n//@汎用便利関数 入力\ntemplate<typename T = int> T _in() {T x;cin >> x;r_ (x);}\n#define _overloadin(_1, _2, _3, _4, name, ...) name\n#define in0() _in()\n#define in1(a) cin>>a\n#define in2(a, b) cin>>a>>b\n#define in3(a, b, c) cin>>a>>b>>c\n#define in4(a, b, c, d) cin>>a>>b>>c>>d\n#define in(...) _overloadin(__VA_ARGS__,in4,in3,in2 ,in1,in0)(__VA_ARGS__)\n\n#define _overloaddin(_1, _2, _3, _4, name, ...) name\n#define din1(a) int a;cin>>a\n#define din2(a, b) int a,b;cin>>a>>b\n#define din3(a, b, c) int a,b,c;cin>>a>>b>>c\n#define din4(a, b, c, d) int a,b,c,d;cin>>a>>b>>c>>d\n#define din(...) _overloadin(__VA_ARGS__,din4,din3,din2 ,din1)(__VA_ARGS__)\n\n#define _overloaddind(_1, _2, _3, _4, name, ...) name\n#define din1d(a) int a;cin>>a;a--\n#define din2d(a, b) int a,b;cin>>a>>b;a--,b--\n#define din3d(a, b, c) int a,b,c;cin>>a>>b>>c;a--,b--,c--\n#define din4d(a, b, c, d) int a,b,c,d;cin>>a>>b>>c>>d;;a--,b--,c--,d--\n#define dind(...) _overloaddind(__VA_ARGS__,din4d,din3d,din2d ,din1d)(__VA_ARGS__)\ntemplate<typename W, typename H> void resize(W &vec_, const H head) { vec_.resize(head); }\ntemplate<typename W, typename H, typename ... T> void resize(W &vec_, const H &head, const T ... tail) {vec_.resize(head);for (auto &v: vec_)resize(v, tail...);}\n\n\nstring sin() { r_ _in<string>(); }\nll lin() { r_ _in<ll>(); }\nt_T void na(v_<T> &a, ll n) {a.resize(n);rep(i, n)cin >> a[i];}\n#define dna(a, n) vi a; na(a, n);/*nを複数使うと n==in()の時バグる事に注意*/\n#define dnad(a, n) vi a; nad(a, n);\nt_T void nad(v_<T> &a, ll n) {a.resize(n);rep(i, n)cin >> a[i], a[i]--;}\ntemplate<class T, class U> void na2(v_<T> &a, v_<U> &b, ll n) {a.resize(n);b.resize(n);rep(i, n)cin >> a[i] >> b[i];}\n#define dna2(a, b, n) vi a,b; na2(a,b,n);\ntemplate<class T, class U, class W> void na3(v_<T> &a, v_<U> &b, v_<W> &c, ll n) {a.resize(n);b.resize(n);c.resize(n);rep(i, n)cin >> a[i] >> b[i] >> c[i];}\n#define nt(a, h, w) resize(a,h,w);rep(nthi,h)rep(ntwi,w) cin >> a[nthi][ntwi];\n#define ntd(a, h, w) resize(a,h,w);rep(ntdhi,h)rep(ntdwi,w) cin >> a[ntdhi][ntdwi], a[ntdhi][ntdwi]--;\n#define ntp(a, h, w) resize(a,h+2,w+2);fill(a,'#');rep(ntphi,1,h+1)rep(ntpwi,1,w+1) cin >> a[ntphi][ntpwi];\n#define dnt(S, h, w) vvi(S,h,w);nt(S,h,w);\n#define dntc(S, h, w) vvc(S,h,w);nt(S,h,w);\n#define dnts(S, h, w) vvs(S,h,w);nt(S,h,w);\n\n//デバッグ\n#define sp << \" \" <<\nconstexpr int DEB_LEN =20;\nconstexpr int DEB_LEN_H =12;\nstring deb_tos(const int &v) { if (abs(v) == inf || abs(v) == linf)return \"e\"; else return to_string(v); }\ntemplate<class T> string deb_tos(const T &a) {stringstream ss;ss << a;return ss.str();}\ntemplate<class T> string deb_tos(const vector<T> &a, ll W = inf) {    stringstream ss;    if (W == inf)W = min(sz(a), DEB_LEN);    if (sz(a) == 0)return ss.str();    rep(i, W) {        ss << deb_tos(a[i]);        if (typeid(a[i]) == typeid(P)) { ss << endl; } else { ss << \" \"; }    }    return ss.str();}\ntemplate<class T> string deb_tos(const vector<vector<T> > &a, vi H, vi W, int key = -1) {    stringstream ss;    ss << endl;    vi lens(sz(W));    fora(h, H) {        rep(wi, sz(W)) {            lens[wi] = max(lens[wi], sz(deb_tos(a[h][W[wi]])) + 1);            lens[wi] = max(lens[wi], sz(deb_tos(W[wi])) + 1);        }    }    if (key == -1)ss << \" *|\"; else ss << \" \" << key << \"|\";    int wi = 0;    fora(w, W) {        ss << std::right << std::setw(lens[wi]) << w;        wi++;    }    ss << \"\" << endl;    rep(i, sz(W))rep(_, lens[i]) ss << \"_\";    rep(i, 3)ss << \"_\";    ss << \"\" << endl;    fora(h, H) {        ss << std::right << std::setw(2) << h << \"|\";        int wi = 0;        fora(w, W) {            ss << std::right << std::setw(lens[wi]) << deb_tos(a[h][w]);            wi++;        }        ss << \"\" << endl;    }    return ss.str();}\ntemplate<class T> string deb_tos(const vector<vector<T> > &a, ll H = inf, ll W = inf, int key = -1) {    H = (H != inf) ? H : min({H, sz(a), DEB_LEN_H});    W = min({W, sz(a[0]), DEB_LEN_H});    vi hs, ws;    rep(h, H) { hs.push_back(h); }    rep(w, W) { ws.push_back(w); }    return deb_tos(a, hs, ws, key);}\ntemplate<class T> string deb_tos(const vector<vector<vector<T> > > &a, ll H = inf) {    stringstream ss;    if (H == inf)H = DEB_LEN_H;    H = min(H, sz(a));    rep(i, H) {        ss << endl;        ss << deb_tos(a[i], inf, inf, i);    }    return ss.str();}\ntemplate<class T, size_t A> string deb_tos(T (&a)[A]) { return deb_tos(vector<T>(begin(a), end(a))); }\ntemplate<class T, size_t A, size_t B> string deb_tos(T (&a)[A][B]) { return deb_tos(vector<vector<T> >(begin(a), end(a))); }\ntemplate<class T, size_t A, size_t B, size_t C> string deb_tos(T (&a)[A][B][C]) { return deb_tos(vector<vector<vector<T> > >(begin(a), end(a))); }\n\n#define debugName(VariableName) # VariableName\n\n#define _deb1(x) cerr <<  debugName(x)<<\" = \"<<deb_tos(x) << endl\n#define _deb2(x, y) cerr <<  debugName(x)<<\" = \"<<deb_tos(x)<<\", \"<< debugName(y)<<\" = \"<<deb_tos(y)<< endl\n#define _deb3(x, y, z) cerr <<  debugName(x)<<\" = \"<<deb_tos(x)  << \", \" <<  debugName(y)<<\" = \"<<deb_tos(y) <<\", \" debugName(z)<<\" = \"<<deb_tos(z) <<endl\n#define _deb4(x, y, z, a) cerr <<  debugName(x)<<\" = \"<<deb_tos(x) <<\", \" <<   debugName(y)<<\" = \"<<deb_tos(y) <<\", \" <<  debugName(z)<<\" = \"<<deb_tos(z) <<\", \" <<  debugName(a)<<\" = \"<<deb_tos(a)<<endl\n#define _deb5(x, y, z, a, b) cerr <<  debugName(x)<<\" = \"<<deb_tos(x) <<\", \" <<   debugName(y)<<\" = \"<<deb_tos(y) <<\", \" <<  debugName(z)<<\" = \"<<deb_tos(z) <<\", \" <<  debugName(a)<<\" = \"<<deb_tos(a)<<\", \" <<  debugName(b)<<\" = \"<<deb_tos(b)<<endl\n\n\n#define _overloadebug(_1, _2, _3, _4, _5, name, ...) name\n#define debug(...) _overloadebug(__VA_ARGS__,_deb5,_deb4,_deb3,_deb2,_deb1)(__VA_ARGS__)\n#ifdef _DEBUG\n#define deb(...) _overloadebug(__VA_ARGS__,_deb5,_deb4,_deb3,_deb2,_deb1)(__VA_ARGS__)\n#else\n#define deb(...) ;\n#endif\n\n\n#define debugline(x) cerr << x << \" \" << \"(L:\" << __LINE__ << \")\" << '\\n'\n\n\nll gcd(ll a, ll b) { r_ b ? gcd(b, a % b) : a; }\nll gcd(vi b) {ll res = b[0];for (auto &&v :b)res = gcd(v, res);r_ res;}\nll lcm(ll a, ll b) { r_ a / gcd(a, b) * b; }\nll rev(ll a) {    ll res = 0;    while (a) {        res *= 10;        res += a % 10;        a /= 10;    }    r_ res;}\nt_T v_<T> rev(v_<T> &a) {    auto b = a;    reverse(all(b));    r_ b;}\nstr rev(str &a) {str s = a;reverse(all(s));r_ s;}\nll ceil(ll a, ll b) {if (b == 0) {cerr<<\"ceil\"<<endl;exit(1);r_ -1;} else r_ (a + b - 1) / b;}\nll sqrt(ll a) {    if (a < 0) {        cerr<<\"sqrt\"<<endl;        exit(1);    }    ll res = (ll) std::sqrt(a);    while (res * res < a)res++;    r_ res;}\ndouble log(double e, double x) { r_ log(x) / log(e); }\nll sig(ll t) { r_ (1 + t) * t / 2; }\nll sig(ll s, ll t) { r_ (s + t) * (t - s + 1) / 2; }\n\nvi divisors(int v) {    vi res;    double lim = std::sqrt(v);    rep(i, 1, lim+1){        if (v % i == 0) {            res.pb(i);            if (i != v / i)res.pb(v / i);        }    }    r_ res;}\nvb isPrime;\nvi primes;\n\nvoid setPrime() {    int len = 4010101;    isPrime.resize(4010101);    fill(isPrime, true);    isPrime[0] = isPrime[1] = false;    for (int i = 2; i <= sqrt(len) + 5; ++i) {        if (!isPrime[i])continue;        for (int j = 2; i * j < len; ++j) {            isPrime[i * j] = false;        }    }    rep(i, len)if (isPrime[i])primes.pb(i);}\n\nvi factorization(int v) {    int tv = v;    vi res;    if (isPrime.size() == 0)setPrime();    for (auto &&p :primes) {        if (v % p == 0)res.push_back(p);        while (v % p == 0) {            v /= p;        }        if (v == 1 || p * p > tv)break;    }    if (v > 1)res.pb(v);    r_ res;}\ninline bool inside(int h, int w, int H, int W) { r_ h >= 0 && w >= 0 && h < H && w < W; }\ninline bool inside(int v, int l, int r) { r_ l <= v && v < r; }\n\n\nt_T v_<T> ruiv(v_<T> &a) {    v_<T> ret(a.size() + 1);    rep(i, a.size())ret[i + 1] = ret[i] + a[i];    r_ ret;}\n//imoは0-indexed\n//ruiは1-indexed\nt_T v_<T> imo(v_<T> &v) {    v_<T> ret = v;    rep(i, sz(ret) - 1)ret[i + 1] += ret[i];    r_ ret;}\n\n#define ins inside\nll u0(ll a) { r_ a < 0 ? 0 : a; }\nt_T v_<T> u(const v_<T> &a) {\n    v_<T> ret = a;fora(v, ret)v = u0(v);r_ ret;}\n#define MIN(a) numeric_limits<a>::min()\n#define MAX(a) numeric_limits<a>::max()\n\nvoid yn(bool a) {\n    if (a)cout << \"yes\" << endl;\n    else cout << \"no\" << endl;\n}\nvoid Yn(bool a) {\n    if (a)cout << \"Yes\" << endl;\n    else cout << \"No\" << endl;\n}\nvoid YN(bool a) {\n    if (a)cout << \"YES\" << endl;\n    else cout << \"NO\" << endl;\n}\nvoid fyn(bool a) {\n    if (a)cout << \"yes\" << endl;\n    else cout << \"no\" << endl;\n    exit(0);\n}\nvoid fYn(bool a) {\n    if (a)cout << \"Yes\" << endl;\n    else cout << \"No\" << endl;\n    exit(0);\n}\nvoid fYN(bool a) {\n    if (a)cout << \"YES\" << endl;\n    else cout << \"NO\" << endl;\n    exit(0);\n}\nvoid Possible(bool a) {\n    if (a)cout << \"Possible\" << endl;\n    else cout << \"Impossible\" << endl;\n    exit(0);\n}\nvoid POSSIBLE(bool a) {\n    if (a)cout << \"POSSIBLE\" << endl;\n    else cout << \"IMPOSSIBLE\" << endl;\n    exit(0);\n}\ntemplate<class T, class U> set<T> &operator+=(set<T> &a, U v) {\n    a.insert(v);\n    r_ a;\n}\ntemplate<class T, class U> v_<T> &operator+=(v_<T> &a, U v) {\n    a.push_back(v);\n    r_ a;\n}\ntemplate<class T> v_<T>& operator+=(v_<T> & a,const v_<T> & b){\n    fora(v, b)a += v;\n    return a;\n}\nt_T T sum(v_<T> &v, int s = 0, int t = inf) {    T ret = 0;    rep(i, s, min(sz(v), t))ret += v[i];    r_ ret;}\nvoid mod(int &a, int m) { a = (a % m + m) % m; }\ntemplate<class F> inline int mgr(int ok, int ng, F f) {\n#define _mgrbody int mid = (ok + ng) / 2; if (f(mid))ok = mid; else ng = mid;\n    if (ok < ng)while (ng - ok > 1) { _mgrbody } else while (ok - ng > 1) { _mgrbody }\n    r_ ok;\n}\n\ntemplate<class F> inline int mgr(int ok, int ng, int second, F f) {\n#define _mgrbody2 int mid = (ok + ng) / 2; if (f(mid, second))ok = mid; else ng = mid;\n    if (ok < ng) while (ng - ok > 1) { _mgrbody2 } else while (ok - ng > 1) { _mgrbody2 }\n    r_ ok;\n}\ntemplate<typename T> ostream &operator<<(ostream &os, v_<T> &m) {    rep(i, sz(m)){os << m[i];if(i < sz(m)-1)os<<\" \";}   r_ os;}\nostream &operator<<(ostream &os, v_<char> &m) {rep(i, sz(m)){os << m[i];}   r_ os;}\ntemplate<typename T> ostream &operator<<(ostream &os, v_<v_<T>> &m) {rep(i, sz(m)){os << m[i]; if(i < sz(m)-1)os << endl;}   r_ os;}\nconstexpr bool bget(ll m, int keta) { r_ (m >> keta) & 1; }\nint bget(ll m, int keta, int sinsuu) {m /= (ll) pow(sinsuu, keta);r_ m % sinsuu;}\nll bit(int n) { r_ (1LL << (n)); }\nll bit(int n, int sinsuu) { r_ (ll) pow(sinsuu, n); }\nint mask(int n) { r_ (1ll << n) - 1; }\n#define bcou __builtin_popcountll\ntemplate<class T, class U> inline bool chma(T &a, const U &b) {if (a < b) {a = b;r_ true;}r_ false;}\ntemplate<class U> inline bool chma(const U &b) { r_ chma(ma, b); }\ntemplate<class T, class U> inline bool chmi(T &a, const U &b) {    if (b < a) {        a = b;        r_ true;    }    r_ false;}\ntemplate<class U> inline bool chmi(const U &b) { r_ chmi(mi, b); }\n#define unique(v) v.erase( unique(v.begin(), v.end()), v.end() );\nint max(vi &a) {    int res = a[0];    fora(v, a) {        res = max(res, v);    }    r_ res;}\nint min(vi &a) {    int res = a[0];    fora(v, a) {        res = min(res, v);    }    r_ res;}\ntemplate<typename T> class fixed_point        : T {public:    explicit constexpr fixed_point(T &&t) noexcept: T(std::forward<T>(t)) {}    template<typename... Args> constexpr decltype(auto) operator()(Args &&... args) const { r_ T::operator()(*this, std::forward<Args>(args)...); }};template<typename T> static inline constexpr decltype(auto) fix(T &&t) noexcept { r_ fixed_point<T>{std::forward<T>(t)}; }\nconstexpr ll h4[] = {1, -1, 0, 0};\nconstexpr ll w4[] = {0, 0, -1, 1};\nconstexpr ll h8[] = {0, 1, 0, -1, -1, 1, 1, -1};\nconstexpr ll w8[] = {1, 0, -1, 0, 1, -1, 1, -1};\nint mei_inc(int h, int w, int H, int W, int i) {while (++i < 4) { if (inside(h + h4[i], w + w4[i], H, W))r_ i; }r_ i;}\n#define mei(nh, nw, h, w) for (int i = mei_inc(h, w, H, W, -1), nh = i<4? h + h4[i] : 0, nw = i<4? w + w4[i] : 0; i < 4; i=mei_inc(h,w,H,W,i), nh = h+h4[i], nw = w+w4[i])\nint mei_inc8(int h, int w, int H, int W, int i) {    while (++i < 8) {        if (inside(h + h8[i], w + w8[i], H, W))r_ i;    }    r_ i;}\n#define mei8(nh, nw, h, w) for (int i = mei_inc8(h, w, H, W, -1), nh = i<8? h + h8[i] : 0, nw = i<8? w + w8[i] : 0; i < 8; i=mei_inc8(h,w,H,W,i), nh = h+h8[i], nw = w+w8[i])\nint mei_incv(int h, int w, int H, int W, int i, vp &p) {    while (++i < sz(p)) { if (inside(h + p[i].fi, w + p[i].se, H, W))r_ i; }    r_ i;}\n#define meiv(nh, nw, h, w, p) for (int i = mei_incv(h, w, H, W, -1, p), nh = i<sz(p)? h + p[i].fi : 0, nw = i<sz(p)? w + p[i].se : 0; i < sz(p); i=mei_incv(h,w,H,W,i,p), nh = h+p[i].fi, nw = w+p[i].se)\nvi compress(vi &A) {    vi B = A;    sort(B);    unique(B);    vi inds(sz(B));    rep(i, sz(A)) {        int ind = lower_bound(all(B), A[i]) - B.begin();        inds[ind] = A[i];        A[i] = ind;    }    return inds;}\nvi compress(vi &A, umapi& map){    vi i_v = compress(A);    rep(i, sz(i_v)){        map[i_v[i]] = i;    }    return i_v;}\n\nt_T void out2(T head) {    cout << head;}\ntemplate<class T, class... U> void out2(T head, U ... tail) {    cout << head << \" \";      out2(tail...);}\ntemplate<class T, class... U> void out(T head, U ... tail) {    cout << head << \" \";        out2(tail...);    cout << \"\" << endl;}\nt_T void out(T head) {    cout << head << endl; }\nvoid out() { cout << \"\" << endl; }\n#define lowerIndex(a, v) (lower_bound(all(a),v)-a.begin())\n#define upperIndex(a, v) (upper_bound(all(a),v)-a.begin())\n\n\n/*@formatter:on*/\nint N, M, H, W;\nvi A, B, C;\n//16:25\n\nvoid solve() {\n    while (cin >> W >> H, H || W) {\n        vvc(S);\n        nt(S, H, W);\n        auto smax = [&](const str &a, const str &b) {\n            if (sz(a) > sz(b))return a;\n            if (sz(a) < sz(b))return b;\n            return max(a, b);\n        };\n        vvs(dp, H, W);\n        str res = \"\";\n        rer(h, H - 1) {\n            rer(w, W - 1) {\n                char c = S[h][w];\n                if ('0' <= c && c <= '9') {\n                    dp[h][w] = c;\n                    if (w < W - 1){\n                        str v = c + dp[h][w + 1];\n                        dp[h][w] = smax(dp[h][w], c + dp[h][w + 1]);\n                    }\n                    if (h < H - 1){\n                        dp[h][w] = smax(dp[h][w], c + dp[h + 1][w]);\n                    }\n                }\n            }\n        }\n        deb(dp);\n        rep(h, H){\n            rep(w, W){\n                str S = dp[h][w];\n                rep(l, sz(S)){\n                    if(S[l]!='0'){\n                        res = smax(res, S.substr(l));\n                        break;\n                    }\n                }\n            }\n        }\n        out(res);\n    }\n\n}\n\n\nsigned main() {\n    solve();\n    r_ 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<sstream>\n#include<cstring>\n#include<vector>\nusing namespace std;\n\nbool cmp1(const string& a,const string& b)\n{\n  int size_a,size_b;\n  int start_a,start_b;\n  start_a = start_b = 0;\n  size_a = a.size(),size_b = b.size();\n  if(a[0] == '0')\n    for(int i=0;i<a.size() && a[i] == '0';i++)\n      size_a--,start_a++;\n\n  if(b[0] == '0')\n    for(int i=0;i<b.size() && b[i] == '0';i++)\n      size_b--,start_b++;\n\n  if(size_a != size_b)\n    return size_a < size_b;\n\n  for(int i=0;i<size_a;i++)\n    {\n      if(a[start_a+i] != b[start_b+i])\n\treturn a[start_a+i] < b[start_b+i];\n    }\n  return true;\n}\n\nbool cmp2(const string& a,const string& b)\n{\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    {\n      if(a[i] != b[i])\n\treturn a[i] < b[i];\n    }\n  return true;\n}\n\nint main()\n{\n    \n  int W,H;\n  while(cin >> W >> H,W|H)\n    {\n      cerr << W << \" \" << H << endl;\n      vector<vector<string> > G;\n      G.resize(H);\n      for(int i=0;i<H;i++)\n\t{\n\t  G[i].resize(W);\n\t  string line;\n\t  cin >> line;\n\t  cerr << line << endl;\n\t  for(int j=0;j<W;j++)\n\t    {\n\t      G[i][j] = line[j];\n\t    }\n\t}\n\n      string G2[H][W];\n      string ans = \"\";\n      for(int i=0;i<H;i++)\n\t{\n\t  for(int j=0;j<W;j++)\n\t    {\n\t      if(isalpha(G[i][j][0]))\n\t\tcontinue;\n\t      //cout << i << \" - \" << j << endl;\n\t      G2[i][j] = max(G2[i][j],G[i][j],cmp1);\n\t      string A,B;\n\t      A = B = G2[i][j];\n\t      if(j-1 >= 0 && !isalpha(G[i][j-1][0]))\n\t\tA = max(G2[i][j],G2[i][j-1]+G2[i][j],cmp1);\n\n\t      if(i-1 >= 0 && !isalpha(G[i-1][j][0]))\n\t\tB = max(G2[i][j],G2[i-1][j]+G2[i][j],cmp1);\n\t      G2[i][j] = max(A,B,cmp1);\n\t      //cout << \"G2[\" << i << \"][\" << j << \"] = \" << G2[i][j] << endl;\n\t      ans = max(G2[i][j],ans,cmp2);\n\t    }\n\t}\n    \n      if(ans.size() != 1 && ans[0] == '0')\n\t{\n\t  for(int i=0;i<ans.size()&&ans[0] == '0';i++)\n\t    ans[i] = ' ';\n\t  stringstream ss;\n\t  ss << ans;\n\t  ss >> ans;\n\t  cout << ans << endl;\n\t}\n      else \n\tcout << ans << endl;\n      }\n    \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cctype>\nusing namespace std;\n\nint dx[] = {-1, 0};\nint dy[] = {0, -1};\n\nstring getMax(string a, string b)\n{\n\tif(a.size() != b.size()) return (a.size() < b.size() ? b : a);\n\tfor(int i=0; i<a.size(); i++) \n\t\tif(a[i] != b[i]) return (a[i] < b[i] ? b : a);\n\n\treturn a;\n}\n\nstring add(string a, char b)\n{\n\tstring res;\n\tif(a.size() == 1 && a[0] == '0') res += b;\n\telse res += a + b;\n\n\treturn res;\n}\n\nint main()\n{\n\tint W,H;\n\n\twhile(cin >> W >> H, (W||H)) {\n\t\tstring field[70];\n\t\tfor(int i=0; i<H; i++) \n\t\t\tcin >> field[i];\n\n\t\tstring ans[70][70];\n\t\tstring res;\n\n\t\tfor(int i=0; i<H; i++)\n\t\tfor(int j=0; j<W; j++) {\n\t\t\tif(!isdigit(field[i][j])) continue;\n\t\t\tstring tmp;\n\n\t\t\tfor(int k=0; k<2; k++) {\n\t\t\t\tint tx = j + dx[k];\n\t\t\t\tint ty = i + dy[k];\n\n\t\t\t\tif(tx<0||ty<0) continue;\n\n\t\t\t\ttmp = getMax(tmp, ans[ty][tx]);\n\t\t\t}\n\n\t\t\ttmp = add(tmp, field[i][j]);\n\n\t\t\tans[i][j] = tmp;\n\n\t\t\tres = getMax(res, tmp);\n\t\t}\n\n\t\tcout << res << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "/**\n *  The Secret Number (PKU 2030)\n *  by Kenji Inoue, 2007-01-02\n **/\n\n#include <iostream>\n#include <string>\n\nusing namespace std;\n\n#define isdigit(x) ('0' <= (x) && (x) <= '9')\n\nchar f[71][71]; // field\nstring t[71][71]; // table\nint w, h;\n\nstring max(string s1, string s2) {\n  if (s1.size() > s2.size()) {\n    return s1;\n  } else if (s1.size() < s2.size()) {\n    return s2;\n  }\n\n  if (s1 > s2) {\n    return s1;\n  }\n  return s2;\n}\n\nstring rec(int x, int y) {\n  if (x < 0 || y < 0) { return \"\"; }\n  if (!isdigit(f[y][x])) { return \"\"; }\n  if (t[y][x] != \"-\") { return t[y][x]; }\n\n  t[y][x] = max(rec(x, y-1), rec(x-1, y)) + f[y][x];\n  if (t[y][x] == \"0\") { t[y][x] = \"\"; }\n\n  return t[y][x];\n}\n\nint main() {\n  while (cin >> w >> h, (w || h)) {\n    for (int y=0; y<h; y++) {\n      cin >> f[y];\n      for (int x=0; x<w; x++) { t[y][x] = \"-\"; }\n    }\n\n    string ans = \"\";\n    for (int y=0; y<h; y++) {\n      for (int x=0; x<w; x++) {\n        if ( (y == h-1 || !isdigit(f[y+1][x]) ) &&\n             (x == w-1 || !isdigit(f[y][x+1]) ) ) {\n          ans = max(ans, rec(x, y));\n        }\n      }\n    }\n    cout << ans << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdint>\n#include <cctype>\n#include <vector>\n#include <string>\n#include <algorithm>\n#include <utility>\n\nstruct {\n  bool operator ()(std::string const& s, std::string const& t) const {\n    std::string s0(s.rbegin(), s.rend());\n    std::string t0(t.rbegin(), t.rend());\n    while (!s0.empty() && s0.back() == '0') s0.pop_back();\n    while (!t0.empty() && t0.back() == '0') t0.pop_back();\n    std::reverse(s0.begin(), s0.end());\n    std::reverse(t0.begin(), t0.end());\n    if (s0.length() != t0.length()) return s0.length() < t0.length();\n    return s0 < t0;\n  }\n} nya;\n\nint testcase_ends() {\n  size_t n, m;\n  scanf(\"%zu %zu\", &m, &n);\n  if (n == 0 && m == 0) return 1;\n\n  std::vector<std::string> s(n);\n  for (auto& si: s) {\n    char buf[128];\n    scanf(\"%s\", buf);\n    si = buf;\n  }\n  std::vector<std::vector<std::string>> dp(n+1, std::vector<std::string>(m+1));\n  for (size_t i = 0; i < n; ++i)\n    for (size_t j = 0; j < m; ++j) {\n      if (!isdigit(s[i][j])) continue;\n      dp[i][j] += s[i][j];\n      dp[i][j+1] = std::max(dp[i][j+1], dp[i][j], nya);\n      dp[i+1][j] = std::max(dp[i+1][j], dp[i][j], nya);\n    }\n\n  std::string res;\n  for (auto const& di: dp)\n    for (auto const& dij: di)\n      res = std::max(res, dij, nya);\n\n  printf(\"%s\\n\", res.c_str());\n  return 0;\n}\n\nint main() {\n  while (!testcase_ends()) {}\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#include<string>\n#define rep(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint h,w,k;\nvector<int> dp[75][75],ans;\n\nvector<int> Max(vector<int> a,vector<int> b){\n\tif(a.size()>b.size())return a;\n\tif(a.size()<b.size())return b;\n\trep(i,a.size()){\n\t\tif(a[i]>b[i])return a;\n\t\tif(a[i]<b[i])return b;\n\t}\n\treturn a;\n}//a???b?????§?????????\n\nint main(){\n\twhile(cin>>w>>h&&h+w){\n\trep(i,h)rep(j,w)dp[i][j].clear();\n\trep(i,h)rep(j,w){\n\t\tchar z;cin>>z;\n\t\tif(isdigit(z)){\n\t\t\tif(z!='0'||dp[i][j].size()){\n\t\t\tdp[i][j].push_back(z-'0');\n\t\t\tdp[i+1][j]=Max(dp[i+1][j],dp[i][j]);\n\t\t\tdp[i][j+1]=Max(dp[i][j+1],dp[i][j]);\n\t\t\t}\n\t\t}\n\t}\n\tans.clear();\n\trep(i,h)rep(j,w)ans=Max(ans,dp[i][j]);\n\trep(i,ans.size())cout<<ans[i];cout<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<string>\n#include<iostream>\n#include<cmath>\n#include<map>\n#include<set>\n#include<climits>\n#include<ctime>\n#include<complex>\n#include<sstream>\n#include<cstring>\nusing namespace std;\ntypedef vector<string>vs;\ntypedef vector<int>vi;\ntypedef vector<vi>vvi;\ntypedef vector<double>vd;\ntypedef pair<int,int>pii;\ntypedef long long ll;\ntypedef pair<ll,ll>pll;\ntypedef vector<ll>vl;\n#define rrep(i,x,n) for(int i=(x);i<(n);++i)\n#define rep(i,x) rrep(i,0,(x))\n#define fi first\n#define se second\n#define each(i,c) for(__typeof((c).begin()) i=(c).begin();i!=(c).end();++i)\n#define all(c) (c).begin(),(c).end()\n#define rall(c) (c).rbegin(),(c).rend()\n#define pb push_back\n#define maxs(a,b) (a)=max(a,b)\n#define mins(a,b) (a)=min(a,b)\n\nstring conv(string a,string b){\n    if(a.size()>b.size())return a;\n    if(a.size()<b.size())return b;\n    if(a<b)return b;\n    return a;\n}\n\nint main(){\n    int H,W;\n    while(scanf(\"%d%d\",&W,&H),H||W){\n        char fld[100][100];\n        rep(i,H)scanf(\"%s\",fld[i]);\n        string dp[100][100];\n        string ans;\n\n        rep(i,H){\n            rep(j,W){\n                string to=conv(dp[i][j+1],dp[i+1][j]);\n                if(isalpha(fld[i][j])||(fld[i][j]=='0'&&to==\"\"))continue;\n                to+=fld[i][j];\n                dp[i+1][j+1]=to;\n                ans=conv(ans,to);\n            }\n        }\n\n        printf(\"%s\\n\",ans.c_str());\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <ctype.h>\nusing namespace std;\n\nstring string_int_0_delete(string s){\n\n  for(int i=0;!s.empty()&&s[i]=='0';i++) s.erase(s.begin());\n  return s;\n\n}\n\nstring string_int_max(string s1,string s2){\n\n  s1=string_int_0_delete(s1);\n  s2=string_int_0_delete(s2);\n  if(s1.size()>s2.size()) return s1;\n  else if(s1.size()<s2.size()) return s2;\n  else if(s1>s2) return s1;\n  else return s2;\n\n}\n\nint main(){\n\n  for(int h,w;cin>>w>>h,w;){\n  string s[70],dp[70][70];\n  for(int i=0;i<h;i++) cin>>s[i];\n  for(int i=0;i<h;i++){\n    for(int j=0;j<w;j++){\n      if(isdigit(s[i][j])){\n\tstring s1,s2;\n\ts1=s2=s[i][j];\n\tif(i) s1=dp[i-1][j]+s[i][j];\n\tif(j) s2=dp[i][j-1]+s[i][j];\n\tdp[i][j]=string_int_max(s1,s2);\n      }\n    }\n  }\n\n  string sr;\n  for(int i=0;i<h;i++) for(int j=0;j<w;j++) sr=string_int_max(sr,dp[i][j]);\n  cout<<sr<<endl;\n  }\n  return 0;\n\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)   FOR(i,0,n)\n#define pb emplace_back\ntypedef long long ll;\ntypedef pair<int,int> pint;\n\nstring s[71];\nbool used[71][71];\nconst int dx[]={0,1},dy[]={1,0};\nint dp[71][71];\nstring ans;\nint w,h;\nint dfs(int x,int y,string c){\n    if(dp[y][x]!=-1){\n        if(dp[y][x]+c.size()<ans.size()) return dp[y][x]+c.size();\n    }\n    if(c.size()>ans.size()) ans=c;\n    else if(c.size()==ans.size()){\n        rep(i,c.size()){\n            if(c[i]>ans[i]){\n                ans=c;break;\n            }\n            else if((c[i]<ans[i])) break;\n        }\n    }\n    int ret=0;\n    rep(i,2){\n        int tx=x+dx[i],ty=y+dy[i];\n        if(tx>=0&&ty>=0&&tx<w&&ty<h&&isdigit(s[ty][tx])){\n            if(c==\"\"&&s[ty][tx]==0) ret=max(ret,dfs(tx,ty,c)+1);\n            else ret=max(ret,dfs(tx,ty,c+s[ty][tx])+1);\n        }\n    }\n    return dp[y][x]=ret;\n}\nint main(){\n    while(cin>>w>>h,w){\n        memset(dp,-1,sizeof(dp));\n        rep(i,h) cin>>s[i];\n        ans=\"\";\n        string t;\n        rep(i,h)rep(j,w)if(isdigit(s[i][j])){\n            if(s[i][j]=='0') dfs(j,i,t);\n            else dfs(j,i,t+s[i][j]);\n        }\n        cout<<ans<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cctype>\n#include <vector>\nusing namespace std;\n\nint W, H;\n\nbool compare(const string& s1, const string& s2){\n  if(s1.size() != s2.size()) return !(s1.size() > s2.size());\n  else return !(s1 > s2);\n}\n\nstring adjust(string s){\n  if(s.size() == 1) return s;\n  bool f = false;\n  for(int i = 0 ; i < s.size() ; i++){\n    if(s[i] != '0') f = true;\n  }\n  if(!f) return \"0\";\n  for(int i = 0 ; i < s.size() ; i++){\n    if(s[i] == '0') continue;\n    else return s.substr(i);\n  }\n}\n\nint main(){\n  while(cin >> W >> H){\n    if(W == 0 && H == 0) break;\n    vector<string> vec;\n    char field[71][71];\n    string dp[71][71];\n    for(int i = 0 ; i < H ; i++){\n      for(int j = 0 ; j < W ; j++){\n\tcin >> field[i][j];\n      }\n    }\n    string ans = \"\";\n    for(int i = 0 ; i < H ; i++){\n      for(int j = 0 ; j < W ; j++){\n\tif(!isdigit(field[i][j])) continue;\n\tif(i == 0 && j == 0) dp[i][j] = field[i][j];\n\telse if(i == 0) dp[i][j] = dp[i][j-1] + field[i][j];\n\telse if(j == 0)\tdp[i][j] = dp[i-1][j] + field[i][j];\n\telse dp[i][j] = max(dp[i][j-1]+field[i][j], dp[i-1][j]+field[i][j], compare);\n\tvec.push_back(dp[i][j]);\n      }\n    }\n    for(int i = 0 ; i < vec.size() ; i++){\n      vec[i] = adjust(vec[i]);\n      ans = max(ans, vec[i], compare);\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <ctime>\n#include <cassert>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <numeric>\n#include <list>\n\n\nusing namespace std;\n\n#ifdef _MSC_VER\n#define __typeof__ decltype\ntemplate <class T> int __builtin_popcount(T n) { return n ? 1 + __builtin_popcount(n & (n - 1)) : 0; }\n#endif\n\n#define foreach(it, c) for (__typeof__((c).begin()) it=(c).begin(); it != (c).end(); ++it)\n#define all(c) (c).begin(), (c).end()\n#define rall(c) (c).rbegin(), (c).rend()\n#define clear(arr, val) memset(arr, val, sizeof(arr))\n\n#define rep(i, n) for (int i = 0; i < n; ++i)\n\ntemplate <class T> void max_swap(T& a, const T& b) { a = max(a, b); }\ntemplate <class T> void min_swap(T& a, const T& b) { a = min(a, b); }\n\ntypedef long long ll;\ntypedef pair<int, int> pint;\n\nconst double EPS = 1e-8;\nconst double PI = acos(-1.0);\nconst int dx[] = { 0, 1, 0, -1 };\nconst int dy[] = { 1, 0, -1, 0 };\n\n\nstring bigger(const string& a, const string& b)\n{\n\tif (a.size() > b.size() || a.size() == b.size() && a > b)\n\t\treturn a;\n\telse\n\t\treturn b;\n}\nint main()\n{\n\tint w, h;\n\tchar c[128][128];\n\twhile (cin >> w >> h, w)\n\t{\n\t\tfor (int i = 0; i < h; ++i)\n\t\t\tscanf(\"%s\", c[i]);\n\n\t\tstring res = \"\";\n\t\tstring dp[128][128];\n\t\tfor (int y = 0; y < h; ++y)\n\t\t{\n\t\t\tfor (int x = 0; x < w; ++x)\n\t\t\t{\n\t\t\t\tif (isdigit(c[y][x]))\n\t\t\t\t{\n\t\t\t\t\tstring t = bigger(dp[y][x + 1], dp[y + 1][x]) + c[y][x];\n\t\t\t\t\tif (t != \"0\")\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[y + 1][x + 1] = t;\n\t\t\t\t\t\tres = bigger(res, t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<string>\n#include<stdio.h>\n#define foreach(i, c) for(__typeof(c.begin()) i = c.begin(); i != c.end(); i++)\n#define rep(i, n) for(int i = 0; i < n; i++)\n//#define DEB2(a, i, j) rep(DBi, i){rep(DBj, j){cout<<a[DBi][DBj];}cout<<endl;}\n//#define DEBUG\nusing namespace std;\n\nint W, H;\nstring matrix[70][70];\nstring field[70][70];\n\nbool bg(string a, string b){//a > b?\n\tif(a.length() != b.length())return a.length() > b.length();\n\treturn a > b;\n}\n\nint main(){\n\twhile(cin>>W>>H, W||H){\n\t\trep(j, H)rep(i, W){\n\t\t\tstring s;\n\t\t\ts = \"\";\n\t\t\tchar c;\n\t\t\tscanf(\" %c\", &c);\n\t\t\tif(0 <= c-'0' && c-'0' <= 9)s += c;\n\t\t\telse s = \".\";\n\t\t\tmatrix[i][j] = s;\n\t\t\tfield[i][j] = \"\";\n\t\t}\n\t\t#ifdef DEBUG\n\t\tcout<< (string(\"9930\")>string(\"940037\")) <<endl;\n\t\tcout<< bg(string(\"9930\"),string(\"940037\")) <<endl;\n\t\trep(j, H){\n\t\t\trep(i, W){\n\t\t\t\tcout<<matrix[i][j];\n\t\t\t}\n\t\t\tcout<<endl;\n\t\t}\n\t\t#endif\n\t\tstring mx = \"\";\n\t\trep(j, H)rep(i, W){\n\t\t\tif(matrix[i][j] == \".\")continue;\n\t\t\tstring up, left, tmp;\n\t\t\tup = left = \"\";\n\t\t\tif(0 <= j-1 && j-1 < H && matrix[i][j-1] != \".\" && field[i][j-1] != \"0\")up = field[i][j-1];\n\t\t\tif(0 <= i-1 && i-1 < W && matrix[i-1][j] != \".\" && field[i-1][j] != \"0\")left = field[i-1][j];\n\t\t\ttmp = bg(up, left)?up:left;\n\t\t\tfield[i][j] += tmp+matrix[i][j];\n\t\t\tif(bg(field[i][j], mx))mx = field[i][j];\n\t\t\t#ifdef DEBUG\n\t\t\tcout<<i<<\",\"<<j<<\":\"<<field[i][j]<<endl;\n\t\t\t#endif\n\t\t}\n\t\tcout<<mx<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n\nusing namespace std;\n\nbool func(char w)\n{\n  char num = '0';\n  for(int i = 0; i < 10; i++){\n    if(w == (char)(num+i)){\n      return true;\n    }\n  }\n\n  return false;\n}\n\nstring stcomp(string s1, string s2)\n{\n  string str = s1;\n  if(s1.length() == s2.length()){\n    long long int u = atoi(s1.c_str());\n    long long int v = atoi(s2.c_str());\n    if(v > u){\n      str = s2;\n    }\n  } else if(s1.length() < s2.length()){\n    str = s2;\n  }\n\n  return str;\n}\n\nstring search(char a[71][71], int h, int w, int s, int t, bool vis[71][71], string astr[71][71])\n{\n  string str, str2=\"\", str3=\"\";\n  str = a[s][t];\n\t\n\tif(vis[s][t]){\n\t\treturn (str+astr[s][t]);\n\t}\n\tvis[s][t] = true;\n\n  if(s+1 < h){\n    if(func(a[s+1][t])){\n      str2 = search(a, h, w, s+1, t, vis, astr);\n    }\n  }\n  if(t+1 < w){\n    if(func(a[s][t+1])){\n      str3 = search(a, h, w, s, t+1, vis, astr);\n    }\n  }\n\tastr[s][t] = stcomp(str2, str3);\n\n  return (str+astr[s][t]);\n}\n\nint main()\n{\n  int w, h;\n  char a[71][71];\n  string str, st;\n\tstring astr[71][71];\n\tbool vis[71][71];\n\n  while(1){\n    cin >> w >> h;\n    if(h == 0 && w == 0){\n      break;\n    }\n\t\tfill(&vis[0][0], &vis[h+1][w+1], false);\n    str = \"\";\n    for(int i = 0; i < h; i++){\n      cin >> a[i];\n    }\n\n    for(int i = 0; i < h; i++){\n      for(int j = 0; j < w; j++){\n\t\t\t\tif(func(a[i][j])){\n\t\t\t\t\tst = search(a, h, w, i, j, vis, astr);\n\t\t\t\t\tstr = stcomp(str, st);\n\t\t\t\t}\n      }\n    }\n    w = 0;\n    while(str[w] == '0'){\n      w++;\n    }\n\n    cout << str.substr(w) << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\nint comp(string s,string t){// s>t:=1,s==t:=0,s<t:=-1;\n    int slen=s.length(),tlen=t.length();\n    if(slen>tlen) return 1;\n    if(slen<tlen) return -1;\n    for(int i=0;i<slen;i++){\n        if(s[i]>t[i]) return 1;\n        if(s[i]<t[i]) return -1;\n    }\n    return 0;\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n    int w,h;\n    while(cin>>w>>h,w||h){\n        vector<string> v(h);\n        for(int i=0;i<h;i++) cin>>v[i];\n        vector<vector<string> > dp(100,vector<string>(100,\"\"));\n        for(int i=0;i<h;i++){\n            for(int j=0;j<w;j++){\n                if('1'<=v[i][j] && v[i][j]<='9') dp[i][j]+=v[i][j];\n            }\n        }\n        for(int i=0;i<h;i++){\n            for(int j=0;j<w;j++){\n                if(v[i][j]<'0' || '9'<v[i][j]) continue;\n                if(i==0 && j==0) continue;\n                else if(i==0){\n                    if(dp[i][j-1]==\"\") continue;\n                    if(v[i][j]<'0' || '9'<v[i][j]) continue;\n                    dp[i][j]=dp[i][j-1]+v[i][j];\n                }\n                else if(j==0){\n                    if(dp[i-1][j]==\"\") continue;\n                    if(v[i][j]<'0' || '9'<v[i][j]) continue;\n                    dp[i][j]=dp[i-1][j]+v[i][j];\n                }\n                else{\n                    if(dp[i-1][j]==\"\" && dp[i][j-1]==\"\") continue;\n                    else if(dp[i-1][j]==\"\") dp[i][j]=dp[i][j-1]+v[i][j];\n                    else if(dp[i][j-1]==\"\") dp[i][j]=dp[i-1][j]+v[i][j];\n                    else{\n                        string s=dp[i-1][j],t=dp[i][j-1];\n                        if(comp(s,t)==-1) dp[i][j]=t+v[i][j];\n                        else dp[i][j]=s+v[i][j];\n                    }\n                }\n            }\n        }\n        string res=\"0\";\n        for(int i=0;i<h;i++){\n            for(int j=0;j<w;j++){\n                if(dp[i][j]==\"\") continue;\n                if(comp(dp[i][j],res)==1) res=dp[i][j];\n            }\n        }\n        cout<<res<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <complex>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <deque>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <vector>\n#include <set>\n#include <limits>\n#include <cstdio>\n#include <cctype>\n#include <cmath>\n#include <cstdlib>\n#include <ctime>\nusing namespace std;\n#define REP(i, j) for(int i = 0; i < j; ++i)\n#define FOR(i, j, k) for(int i = j; i < k; ++i)\n#define P pair<int, string>\n\n// 1 = a < b\n// -1 = a > b\n// 0 = a == b\nint check(string a, string b){\n\n  if(a == \"NO\" && b == \"NO\") return 0;\n  else if(a == \"NO\") return -1;\n  else if(b == \"NO\") return 1;\n\n  int aa = 0, bb = 0;\n  while(aa < a.length() && a[aa] == '0') aa++;\n  while(bb < b.length() && b[bb] == '0') bb++;\n\n  if(aa == a.length()) a = \"0\";\n  else a = a.substr(aa);\n\n  if(bb == b.length()) b = \"0\";\n  else b = b.substr(bb);\n\n  if(a.length() > b.length()) return 1;\n  else if(a.length() < b.length()) return -1;\n  else{\n    REP(i, a.length()){\n      if(a[i] - '0' > b[i] - '0') return 1;\n      else if(a[i] - '0' < b[i] - '0') return -1;\n    }\n  }\n  return 0;\n}\nint main() {\n  int w, h;\n  while(cin >>w >>h && w != 0){\n    vector<string> v(h);\n    REP(i, h) cin >>v[i];\n    vector< vector<string> > dp(h + 1, vector<string>(w + 1, \"\"));\n    REP(i, h) REP(j, w) if(isalpha(v[i][j])) dp[i + 1][j + 1] = \"NO\";\n\n    REP(i, h){\n      REP(j, w){\n        int y = i + 1, x = j + 1;\n        if(isalpha(v[i][j])) continue;\n        //debug\n        //cout <<\"------------\" <<endl;\n        //cout <<\"! \" <<i <<\", \" <<j <<\", \" <<v[i][j] <<endl;\n        //if(i != 0){\n        //  cout <<v[i - 1][j] <<\", \";\n        //  cout <<dp[y - 1][x] <<endl;\n        //}\n        //if(j != 0){\n        //  cout <<v[i][j - 1] <<\", \";\n        //  cout <<dp[y][x - 1] <<endl;\n        //}\n\n        dp[y][x] = v[i][j];\n\n        if(dp[y - 1][x] != \"NO\"){\n          dp[y][x] = dp[y - 1][x] + v[i][j];\n        }\n        if(dp[y][x - 1] != \"NO\" && check((dp[y][x - 1] + v[i][j]), dp[y][x]) == 1){\n          dp[y][x] = dp[y][x - 1] + v[i][j];\n        }\n        //debug\n        //cout <<dp[y][x] <<endl;\n      }\n    }\n    //debug\n    //FOR(i, 1, h + 1){\n    //  FOR(j, 1, w + 1){\n    //    cout <<i <<\", \" <<j <<endl;\n    //    cout <<dp[i][j].first <<\", \" <<dp[i][j].second <<endl;\n    //  }\n    //}\n\n    string ans = \"0\";\n    REP(i, h + 1){\n      REP(j, w + 1){\n        if(check(dp[i][j], ans) == 1) ans = dp[i][j];\n      }\n    }\n\n    int tmp = 0;\n    while(tmp < ans.length() && ans[tmp] == '0') tmp++;\n    if(tmp == ans.length()) ans = \"0\";\n    else ans = ans.substr(tmp);\n    cout <<ans <<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nint main() {\n\tint w, h;\n\twhile (cin >> w >> h, w){\n\t\tvector<string> vs(h);\n\t\tvector<vector<bool>> vvb(h);\n\t\tREP(i, h){\n\t\t\tcin >> vs[i];\n\t\t\tREP(j, w){\n\t\t\t\tvvb[i].push_back('0' <= vs[i][j] && vs[i][j] <= '9');\n\t\t\t}\n\t\t}\n\n\t\tvector<vector<int>> vvi(h);\n\t\tint max2 = 1;\n\t\tint x, y;\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tif (vvb[i][j]){\n\t\t\t\t\tint max = 1;\n\t\t\t\t\tif (i > 0 && vvb[i - 1][j])max = vvi[i - 1][j] + 1;\n\t\t\t\t\tif (j > 0 && vvb[i][j - 1])if (max < vvi[i][j - 1] + 1)max = vvi[i][j - 1] + 1;\n\t\t\t\t\tvvi[i].push_back(max);\n\t\t\t\t\tif (max > max2){\n\t\t\t\t\t\tmax2 = max;\n\t\t\t\t\t\t x = j;\n\t\t\t\t\t\t y = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tvvi[i].push_back(-1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvector<vector<int>> vvi2(h);\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tvvi2[i].push_back(-1);\n\t\t\t}\n\t\t}\n\t\tvvi2[y][x] = max2;\n\t\tqueue<int> qi;\n\t\tqi.push(max2 * 10000 + x * 100 + y);\n\t\twhile (!qi.empty()){\n\t\t\tint pos = qi.front(); qi.pop();\n\t\t\tint max3 = pos / 10000;\n\t\t\tint x2 = (pos / 100) % 100;\n\t\t\tint y2 = pos % 100;\n\t\t\tif (x2 > 0 && vvb[y2][x2 - 1] && vvi2[y2][x2 - 1]==-1){\n\t\t\t\tvvi2[y2][x2 - 1] = max3 - 1;\n\t\t\t\tqi.push((max3-1) * 10000 + (x2-1) * 100 + y2);\n\t\t\t}\n\t\t\tif (y2 > 0 && vvb[y2 - 1][x2] && vvi2[y2-1][x2] == -1){\n\t\t\t\tvvi2[y2 - 1][x2] = max3 - 1;\n\t\t\t\tqi.push((max3 - 1) * 10000 + x2 * 100 + (y2-1));\n\t\t\t}\n\t\t}\n\t\tchar max4 = '0' - 1;\n\t\tint x3, y3;\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tif (vvi2[i][j] == 1 && max4 < vs[i][j]){\n\t\t\t\t\tmax4 = vs[i][j];\n\t\t\t\t\tx3 = j;\n\t\t\t\t\ty3 = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ans;\n\t\tans += max4;\n\t\tREP(i,max2-1){\n\t\t\tbool abb = false;\n\t\t\tmax4 = '0' - 1;\n\t\t\tif (y3 + 1 != h&&vvi2[y3+1][x3]>0 && max4 < vs[y3 + 1][x3]){\n\t\t\t\tmax4 = vs[y3 + 1][x3];\n\t\t\t\ty3 ++;\n\t\t\t\tabb = true;\n\t\t\t}\n\t\t\tif (abb){\n\t\t\t\tif (x3 + 1 != w&&vvi2[y3-1][x3 + 1]>0 && max4 < vs[y3-1][x3 + 1]){\n\t\t\t\t\tmax4 = vs[y3-1][x3 + 1];\n\t\t\t\t\tx3++;\n\t\t\t\t\ty3--;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif (x3 + 1 != w&&vvi2[y3][x3 + 1]>0 && max4 < vs[y3][x3 + 1]){\n\t\t\t\t\tmax4 = vs[y3][x3 + 1];\n\t\t\t\t\tx3++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tans += max4;\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <stdio.h>\n#include <algorithm>\n#include <vector>\n#include <queue>\n#include <numeric>\n#include <string>\n#include <string.h>\n#include <map>\n#include <set>\n#include <functional>\n#include <complex>\n#include <stack>\n#include <tuple>\nusing namespace std;\n#define rep(i,n) for (int i=0; i < (n); i++)\n\n\ntypedef long long int ll;\ntypedef double D;      // ??§?¨?????????????double???long double?????????\ntypedef complex<D> P;  // Point\ntypedef pair<P, P> L;  // Line\ntypedef vector<P> VP;\n\n\nconst int INF = (1<<30) - 1;\nconst D EPS = 1e-9;\n\n#define X real()\n#define Y imag()\n#define LE(n,m) ((n) < (m) + EPS)\n#define GE(n,m) ((n) + EPS > (m))\n#define EQ(n,m) (abs((n)-(m)) < EPS)\n\nint W, H;\nvector<string> field;\nvector<vector<string>> memo;\n\nint dh[] = {0, 1};\nint dw[] = {1, 0};\n\ninline bool is_digit(char &c){\n    return '0'<=c && c<='9';\n}\n\nbool less_as_int(string &l, string &r){\n    if(l.length() != r.length())\n        return l.length() < r.length();\n    return l < r;\n}\n\nstring dfs(int h, int w){\n    if(memo[h][w] != \"\")\n        return memo[h][w];\n    \n    string ret = \"\";\n    \n    for(int di=0; di<2; di++){\n        int nh = h + dh[di];\n        int nw = w + dw[di];\n        if(0<=nh && nh<H && 0<=nw && nw<W && is_digit(field[nh][nw])){\n            string t = dfs(nh, nw);\n            if(less_as_int(ret, t))\n                ret = t;\n        }\n    }\n    return memo[h][w] = field[h][w] + ret;\n}\n\nvoid solve(){\n    string ans = \"\";\n    \n    for(int h=0; h<H; h++)\n        for(int w=0; w<W; w++)\n            if(is_digit(field[h][w]) && field[h][w]!='0'){\n                string t = dfs(h, w);\n                if(less_as_int(ans, t))\n                    ans = t;\n            }\n    cout << ans << endl;\n}\n\n//g++ -std=c++0x -msse4.2 -O3\n//#include <bits/stdc++.h>\nint main(){\n    ios::sync_with_stdio(false);\n    cin.tie(0);\n    \n    while(cin>>W>>H, W|H){\n        field = vector<string>(H);\n        memo = vector<vector<string>>(H, vector<string>(W, \"\"));\n        for(auto &r: field)\n            cin >> r;\n        \n        solve();\n    }\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <vector>\n#include <map>\n#include <set>\n#include <string>\n#include <cstring>\n#include <sstream>\n#include <algorithm>\n#include <functional>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <iomanip>\n#include <list>\n#include <tuple>\n#include <bitset>\n\nusing namespace std;\n\ninline bool cheak(int x, int y, int xMax, int yMax){ return x >= 0 && y >= 0 && xMax > x && yMax > y; }\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout << x; return sout.str(); }\ntemplate<class T> inline T sqr(T x) { return x*x; }\n\ntypedef pair<int, int> P;\ntypedef tuple<int, int, int> T;\ntypedef long long ll;\ntypedef unsigned long long ull;\n\n#define For(i,a,b)\tfor(int (i) = (a);i < (b);(i)++)\n#define rep(i,n)\tFor(i,0,n)\n#define clr(a)\t\tmemset((a), 0 ,sizeof(a))\n#define mclr(a)\t\tmemset((a), -1 ,sizeof(a))\n#define all(a)\t\t(a).begin(),(a).end()\n#define sz(a)\t\t(sizeof(a))\n#define Fill(a,v)\tfill((int*)a,(int*)(a+(sz(a)/sz(*(a)))),v)\n\nconst int dx[8] = { -1, 0, -1, 0, 1, 1, -1, -1 }, dy[8] = { 0, -1, 0, 1, -1, 1, -1, 1 };\nconst int mod = 1000000007;\nconst int INF = 1e9;\n\nstring c[71];\nint w, h;\n\nstring d[71][71];\n\nint str_compare(string s1, string s2){\n\n\tif (s1.size() > s2.size())return 1;\n\tif (s1.size() < s2.size())return 0;\n\n\twhile (s1.size() != 1 && s1[0] == '0'){\n\t\ts1 = s1.substr(1, s1.size() - 1);\n\t}\n\twhile (s2.size() != 1 && s2[0] == '0'){\n\t\ts2 = s2.substr(1, s2.size() - 1);\n\t}\n\n\tif (s1.size() > s2.size())return 1;\n\tif (s1.size() < s2.size())return 0;\n\n\tif (s1.size() == s2.size()){\n\t\tif (s1 > s2)return 1;\n\t\tif (s1 < s2)return 0;\n\t\tif (s1 == s2)return -1;\n\t}\n}\n\nvoid func(int y,int x){\n\n\t\n\trep(i, 2){\n\t\tint ty = y + dy[i], tx = x + dx[i];\n\t\tif (cheak(tx, ty, w, h) && (c[ty][tx] >= '0' && c[ty][tx] <= '9')){\n\n\t\t\tstring t = (c[ty][tx]) + d[y][x];\n\t\t\tif (str_compare(d[ty][tx],t ) == 0){\n\t\t\t\td[ty][tx] = t;\n\t\t\t\tfunc(ty, tx);\n\t\t\t}\n\n\t\t}\n\t}\n}\n\nint main()\n{\n\twhile (cin >> w >> h && (w || h)){\n\t\trep(y, h){\n\t\t\tcin >> c[y];\n\t\t\trep(x,w)\n\t\t\tif (c[y][x] >= '0' && c[y][x] <= '9')d[y][x] = c[y][x];\n\t\t}\n\t\tfor (int y = h - 1; y >= 0; y--)\n\t\tfor (int x = w - 1; x >= 0; x--)if (c[y][x] >= '0' && c[y][x] <= '9'){\n\t\t\tfunc(y, x);\n\t\t}\n\n\t\tstring ans = \"0\";\n\n\t\trep(y, h)rep(x, w)if (c[y][x] >= '0' && c[y][x] <= '9') {\n\t\t\tif (str_compare(ans, d[y][x]) == 0){\n\t\t\t\tans = d[y][x];\n\t\t\t}\n\t\t}\n\t\twhile (ans.size() != 1 && ans[0] == '0'){\n\t\t\tans = ans.substr(1, ans.size() - 1);\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <iomanip>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <bitset>\n#include <stack>\n#include <utility>\n#include <numeric>\n#include <algorithm>\n#include <functional>\n#include <cctype>\n#include <complex>\n#include <string>\n#include <sstream>\n\nusing namespace std;\n\n#define all(c) c.begin(),c.end()\n#define rall(c) c.rbegin(),c.rend()\n#define mp(a,b) make_pair((a),(b))\n#define eq ==\n\ntypedef long long ll;\ntypedef complex<double> point;\ntypedef pair<int,int> pii;\n\n\nconst double EPS = 1e-9;\n\nint toint(char c){\n    return c - '0';\n}\n\nstring maxs(string a,string b){\n    if(a.length() > b.length()) return a;\n    if(a.length() < b.length()) return b;\n    for(int i=0;i<a.length();i++){\n        if(a[i] > b[i]) return a;\n        if(a[i] < b[i]) return b;\n    }\n    return a;\n}\nstring dfs(vector<vector<char> > &C,int y,int x){\n    const int dx[] = {1,0};\n    const int dy[] = {0,1};\n\n    string ret = \"\";\n    ret += C[y][x];\n    for(int i=0;i<2;i++){\n        if(isdigit(C[y+dy[i]][x+dx[i]])){\n            ret = maxs(ret,C[y][x]+dfs(C,y+dy[i],x+dx[i]));\n        }\n    }\n    return ret;\n}\n\nint main(){\n    while(true){\n        int W,H;\n        cin >> W >> H;\n        if(W == 0) break;\n        vector<vector<char> > C(H+2,vector<char>(W+2,'A'));\n        for(int i=1;i<=H;i++){\n            for(int j=1;j<=W;j++){\n                cin >> C[i][j];\n            }\n        }\n        string ret;\n        for(int i=1;i<=H;i++){\n            for(int j=1;j<=W;j++){\n                if(isdigit(C[i][j])){\n                    ret = maxs(ret,dfs(C,i,j));\n                }\n            }\n        }\n        for(int i=0;i<ret.size();i++){\n            if(ret[i] != '0') break;\n            ret = ret.substr(1,ret.size()-1);\n        }\n        cout << ret << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\nusing namespace std;\nint h,w;\nstring tbl[80];\nstring T[80][80];\n\nstring Max(string a,string b){\n  int n = a.length();\n  int m = b.length();\n  if(n>m) return a;\n  if(n<m) return b;\n  for(int i=0;i<n;++i){\n    if(a[i]>b[i]) return a;\n    if(a[i]<b[i]) return b;\n  }\n  return a;\n}\n\nbool isnum(char c){\n  return '0'<=c && c<='9';\n}\n\nint main(){\n  while(cin>>w>>h,w||h){\n    for(int i=1;i<=h;++i){\n      string tmp; cin>>tmp;\n      reverse(tmp.begin(),tmp.end());\n      tmp+='A';\n      reverse(tmp.begin(),tmp.end());      \n      tbl[i] = tmp;\n    }\n    for(int i=0;i<=h;++i)\n      for(int j=0;j<=w;++j)\n\tT[i][j]=\"\";\n    for(int i=1;i<=h;++i)\n      for(int j=1;j<=w;++j)\n\tif(isnum(tbl[i][j])){\n\t  T[i][j] = Max(T[i-1][j],T[i][j-1])+tbl[i][j];\n\t  if(T[i][j]==\"0\") T[i][j]=\"\";\n\t}\n\n    string ans=\"\";\n    for(int i=1;i<=h;++i)\n      for(int j=1;j<=w;++j)\n\tans = Max(ans,T[i][j]);\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\nusing namespace std;\nstring dp[70][70]; //i,jから開始したときの最大数\nstring s[70];\nbool comp(string lhs,string rhs)\n{\n\tif(lhs.size()==rhs.size())\n\t\treturn lhs>rhs;\n\telse\n\t\treturn lhs.size()>rhs.size();\n}\n\nstring maxstr(string lhs,string rhs)\n{\n\tif(comp(lhs,rhs))\n\t\treturn lhs;\n\telse\n\t\treturn rhs;\n}\nvector<string> v;\nint main()\n{\n\tint h,w;\n\twhile(1)\n\t{\n\t\tcin>>w>>h;\n\t\tif(h==0)\n\t\t\tbreak;\n\t\tfor(int i=0;i<h;i++)\n\t\t\tcin>>s[i];\n\t\tfor(int i=0;i<h;i++)\n\t\t{\n\t\t\tfor(int j=0;j<w;j++)\n\t\t\t{\n\t\t\t\tif(s[i][j]>='0' && s[i][j]<='9')\n\t\t\t\t\tdp[i][j]=s[i][j];\n\t\t\t\telse\n\t\t\t\t\tdp[i][j]=\"\";\n\t\t\t}\n\t\t}\n\t\t//最後から探索\n\t\t//最後の1行\n\t\tfor(int i=w-2;i>=0;i--)\n\t\t{\n\t\t\tif(s[h-1][i]>='0' && s[h-1][i]<='9')\n\t\t\t\tdp[h-1][i]=s[h-1][i]+dp[h-1][i+1];\n\t\t}\n\t\t//最後の1列\n\t\tfor(int i=h-2;i>=0;i--)\n\t\t{\n\t\t\tif(s[i][w-1]>='0' && s[i][w-1]<='9')\n\t\t\t\tdp[i][w-1]=s[i][w-1]+dp[i+1][w-1];\n\t\t}\n\t\t//残り\n\t\tfor(int i=h-2;i>=0;i--)\n\t\t{\n\t\t\tfor(int j=w-2;j>=0;j--)\n\t\t\t{\n\t\t\t\tif(s[i][j]>='0' && s[i][j]<='9')\n\t\t\t\t{\n\t\t\t\t\tdp[i][j]=maxstr(s[i][j]+dp[i+1][j],s[i][j]+dp[i][j+1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tv.clear();\n\t\tfor(int i=0;i<h;i++)\n\t\t{\n\t\t\tfor(int j=0;j<w;j++)\n\t\t\t{\n\t\t\t\t//cerr<<dp[i][j]<<endl;\n\t\t\t\tif(dp[i][j]!=\"\" && dp[i][j][0]!='0')\n\t\t\t\t\tv.push_back(dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tsort(v.begin(),v.end(),comp);\n\t\tcout<<v[0]<<endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "                                        #include <bits/stdc++.h>\n                                        #include<iostream>\n                                        #include<cstdio>\n                                        #include<vector>\n                                        #include<queue>\n                                        #include<map>\n                                        #include<cstring>\n                                        #include<string>\n                                        #include <math.h>\n                                        #include<algorithm>\n                                    //    #include <boost/multiprecision/cpp_int.hpp>\n                                        #include<functional>\n                                #define int long long\n                                        #define inf  1000000007\n                                        #define pa pair<int,int>\n                                        #define ll long long\n                                        #define pal pair<double,pa>\n                                        #define ppa pair<int,int>\n                                        #define ppap pair<int,pa>\n                                        #define ssa pair<string,int>\n                                        #define  mp make_pair\n                                        #define  pb push_back\n                                        #define EPS (1e-12)\n                                        #define equals(a,b) (fabs((a)-(b))<EPS)\n                                  #define VI vector<int>\n                                        using namespace std;\n                                        \n                                  class pas{\n                                    \tpublic:\n                                    \tint x,y;\n                                    \tpas(int x=0,int y=0):x(x),y(y) {}\n                                    \tpas operator + (pas p) {return pas(x+p.x,y+p.y);}\n                                    \tpas operator - (pas p) {return pas(x-p.x,y-p.y);}\n                                    \tpas operator * (int a) {return pas(x*a,y*a);}\n                                    \tpas operator / (int a) {return pas(x/a,y/a);}\n                                    //\tdouble absv() {return sqrt(norm());}\n                                    \tint norm() {return x*x+y*y;}\n                                    \tbool operator < (const pas &p) const{\n                                   \t\treturn x != p.x ? x<p.x: y<p.y;\n                                   \t}\n                                  //\t\tbool operator < (const pas &p) const{\n                                    //\t\treturn y != p.y ? y<p.y: x<p.x;\n                                    //\t}\n                                    \tbool operator == (const pas &p) const{\n                                    \t\treturn x==p.x && y==p.y;\n                                    \t}\n                                    };\n\n                                        class Point{\n                                        \tpublic:\n                                        \tdouble x,y;\n                                        \tPoint(double x=0,double y=0):x(x),y(y) {}\n                                        \tPoint operator + (Point p) {return Point(x+p.x,y+p.y);}\n                                        \tPoint operator - (Point p) {return Point(x-p.x,y-p.y);}\n                                        \tPoint operator * (double a) {return Point(x*a,y*a);}\n                                        \tPoint operator / (double a) {return Point(x/a,y/a);}\n                                        \tdouble absv() {return sqrt(norm());}\n                                        \tdouble norm() {return x*x+y*y;}\n                                        \tbool operator < (const Point &p) const{\n                                        \t\treturn x != p.x ? x<p.x: y<p.y;\n                                        \t}\n                                        \tbool operator == (const Point &p) const{\n                                        \t\treturn fabs(x-p.x)<EPS && fabs(y-p.y)<EPS;\n                                        \t}\n                                        };\n                                        typedef Point Vector;\n                                 #define pl pair<int,pas>\n                                        struct Segment{\n                                        Point p1,p2;\n                                        };\n                                         double dot(Vector a,Vector b){\n                                        \treturn a.x*b.x+a.y*b.y;\n                                        }\n                                        double cross(Vector a,Vector b){\n                                        \treturn a.x*b.y-a.y*b.x;\n                                        }\n                                    \n            bool parareru(Point a,Point b,Point c,Point d){\n            //\tif(abs(cross(a-b,d-c))<EPS)cout<<\"dd \"<<cross(a-b,d-c)<<endl;\n            \treturn abs(cross(a-b,d-c))<EPS;\n            }\n            double distance_ls_p(Point a, Point b, Point c) {\n              if ( dot(b-a, c-a) < EPS ) return (c-a).absv();\n              if ( dot(a-b, c-b) < EPS ) return (c-b).absv();\n              return abs(cross(b-a, c-a)) / (b-a).absv();\n            }\n            bool is_intersected_ls(Segment a,Segment b) {\n            \tif(a.p1==b.p1||a.p2==b.p1||a.p1==b.p2||a.p2==b.p2) return false;\n            \tif(parareru((a.p2),(a.p1),(a.p1),(b.p2))&&parareru((a.p2),(a.p1),(a.p1),(b.p1))){\n            //\t\tcout<<\"sss\"<<endl;\n            \t\tif(dot(a.p1-b.p1,a.p1-b.p2)<EPS) return true;\n            \t\tif(dot(a.p2-b.p1,a.p2-b.p2)<EPS) return true;\n            \t\tif(dot(a.p1-b.p1,a.p2-b.p1)<EPS) return true;\n            \t\tif(dot(a.p1-b.p2,a.p2-b.p2)<EPS) return true;\n            \t\treturn false;\n            \t}\n              else return ( cross(a.p2-a.p1, b.p1-a.p1) * cross(a.p2-a.p1, b.p2-a.p1) < EPS ) && ( cross(b.p2-b.p1, a.p1-b.p1) * cross(b.p2-b.p1, a.p2-b.p1) < EPS );\n            }\n            double segment_len(Segment a){\n            \t\n            \treturn (a.p1-a.p2).absv();\n            }\n            double segment_dis(Segment a,Segment b){\n            \tif(is_intersected_ls(a,b))return 0;\n            \tdouble r=distance_ls_p(a.p1, a.p2, b.p1);\n            \tr=min(r,distance_ls_p(a.p1, a.p2, b.p2));\n            \tr=min(r,distance_ls_p(b.p1, b.p2, a.p2));\n            \tr=min(r,distance_ls_p(b.p1, b.p2, a.p1));\n            \treturn r;\n            }\n            Point intersection_ls(Segment a, Segment b) {\n              Point ba = b.p2-b.p1;\n              double d1 = abs(cross(ba, a.p1-b.p1));\n              double d2 = abs(cross(ba, a.p2-b.p1));\n              double t = d1 / (d1 + d2);\n             \n              return a.p1 + (a.p2-a.p1) * t;\n            }\n\t\t\tpair<Point,Point> circle_intersection(Point c1,double r1,Point c2,double r2){\n\t\t\t\tdouble d=(c1-c2).absv();\n\t\t\t\tdouble h=(r1*r1-r2*r2+d*d)/2.0/d;\n\t\t\t\tdouble l=sqrt(r1*r1-h*h);\n\t\t\t//\tcout<<d<<\" \"<<h<<\" \"<<l<<endl;\n\t\t\t\tPoint asi=c1+(c2-c1)*h/((c2-c1).absv());\n\t\t\t\tVector r1r2=(c2-c1)/((c2-c1).absv());\n\t\t\t\tVector sui={r1r2.y,-r1r2.x};\n\t\t\t//\tcout<<sui.x<<\" \"<<sui.y<<endl;\n\t\t\t\tpair<Point,Point> z=mp(asi+sui*l,asi-sui*l);\n\t\t\t\tif(z.first.x>z.second.x) swap(z.first,z.second);\n\t\t\t\treturn z;\n\t\t\t}\nstring s[80];\nstring dp[80][80];\n\nstring hi(string a,string b){\n\tif(a.length()>b.length())return a;\n\tif(a.length()<b.length())return b;\n\tif(a>b) return a;\n\treturn b;\n}\n     signed main(){\nint n,m,w,h;\n     \twhile(1){\n     \tcin>>w>>h;\n     \t\tif(w==0&&h==0) return 0;\n     \t\tfor(int i=0;i<=w;i++)s[0]+=\"W\";\n     \t\tfor(int i=1;i<=h;i++){\n     \t\tcin>>s[i];\n     \t\t\ts[i]=\"D\"+s[i];\n     \t\t}\n     \t\t\n     \t\tstring ans=\"\";\n     \t\tfor(int i=0;i<80;i++)for(int j=0;j<80;j++)dp[i][j]=\"\";\n     \t\tfor(int i=1;i<=h;i++)for(int j=1;j<=w;j++)if(s[i][j]<='9' && '0'<=s[i][j]){\n     \t\t\tif((s[i][j]=='0' && dp[i][j-1]==\"\" && dp[i-1][j]==\"\"))continue;\n     \t\t\t\t\n     \t\t\t\n     \t\t\tdp[i][j]=\" \";\n     \t\t\tdp[i][j][0]=s[i][j];\n     \t\t\t\n     \t\t\tstring r=\"\";\n     \t\t\t\n     \t\t\tr=\" \";\n     \t\t\tr[0]=s[i][j];\n     \t\t\t\n     \t\t\tdp[i][j]=hi(dp[i-1][j]+r,dp[i][j]);\n     \t\t\t\n     \t\t\tdp[i][j]=hi(dp[i][j-1]+r,dp[i][j]);\n     \t\t\t//cout<<i<<\" \"<<j<<\" \"<<\n     \t\t\tans=hi(ans,dp[i][j]);\n     \t\t}\n     \t\t\n     \t\t\n     \tcout<<ans<<endl;\n     \t//\treturn 0;\n     \t}\n           \treturn 0;\n           }\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef pair<int,int> P;\n\nint main ()\n{\n    int n, m;\n    while (cin >> m >> n, n || m) {\n        vector<vector<char> > v (n, vector<char>(m, '#'));\n        for (int i = 0; i < n; i++) {\n            for (int j = 0; j < m; j++) {\n                char str;\n                cin >> str;\n                if ('0' <= str && str <= '9') {\n                    v[i][j] = str;\n                }\n            }\n        }\n\n        vector<vector<string> > dp(n, vector<string>(m, \"\"));\n\n        for (int i = 0; i < m; i++) {\n            if (v[0][i] != '#') {\n                if (v[0][i] == '0') {\n                    if (i > 0 && dp[0][i-1].size() > 0) {\n                        dp[0][i] = dp[0][i-1] + v[0][i];\n                    }\n                } else {\n                    if (i > 0) {\n                        dp[0][i] = dp[0][i-1] + v[0][i];\n                    } else {\n                        dp[0][i] = v[0][i];\n                    }\n                }\n            }\n        }\n\n        for (int i = 1; i < n; i++) {\n            if (v[i][0] != '#') {\n                if (v[i][0] == '0') {\n                    if (dp[i-1][0].size() > 0) dp[i][0] = dp[i-1][0] + v[i][0];\n                } else {\n                    dp[i][0] = dp[i-1][0] + v[i][0];\n                }\n            }\n        }\n\n        string res = \"\";\n\n        for (int i = 1; i < n; i++) {\n            for (int j = 1; j < m; j++) {\n                if (v[i][j] != '#') {\n                    string s1;\n                    if (dp[i-1][j].size() > 0 || v[i][j] != '0') s1 = dp[i-1][j] + v[i][j];\n                    string s2;\n                    if (dp[i-1][i].size() > 0 || v[i][j] != '0') s2 = dp[i][j-1] + v[i][j];\n\n                    if (s1.size() == s2.size()) {\n                        dp[i][j] = max(s1, s2);\n                    } else {\n                        dp[i][j] = s1.size() > s2.size() ? s1 : s2;\n                    }\n                    if (res.size() == dp[i][j].size()) {\n                        res = max(res, dp[i][j]);\n                    } else {\n                        res = res.size() > dp[i][j].size() ? res : dp[i][j];\n                    }\n                }\n            }\n        }\n\n        cout << res << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cctype>\n#include <algorithm>\nusing namespace std;\n\nint w,h;\nstring m[100];\nstring dp[100][100];\n\nstring max_string(const vector<string>& vs){\n\tint max_len=0;\n\tstring s;\n\tfor(int i=0 ; i < vs.size() ; i++ ){\n\t\tmax_len = max( max_len , (int)vs[i].size() );\n\t}\n\tfor(int i=0 ; i < vs.size() ; i++ ){\n\t\tif( vs[i].size() == max_len && ( s.empty() || s < vs[i] ) ){\n\t\t\ts = vs[i];\n\t\t}\n\t}\n\treturn s;\n}\n\nvoid solve(){\n\tfor(int y=0 ; y < 100 ; y++ ){\n\t\tfor(int x=0 ; x < 100 ; x++ ){\n\t\t\tdp[y][x].clear();\n\t\t}\n\t}\n\n\tint max_len=0;\n\tstring ans;\n\tfor(int y=h-1 ; y >= 0 ; y-- ){\n\t\tfor(int x=w-1 ; x >= 0 ; x-- ){\n\t\t\tif( isdigit( m[y][x] ) ){\n\t\t\t\tdp[y][x].push_back( m[y][x] );\n\t\t\t\tvector<string> vs;\n\t\t\t\tif( x != w-1 && isdigit( m[y][x+1] ) ){\n\t\t\t\t\tvs.push_back( dp[y][x+1] );\n\t\t\t\t}\n\t\t\t\tif( y != h-1 && isdigit( m[y+1][x] ) ){\n\t\t\t\t\tvs.push_back( dp[y+1][x] );\n\t\t\t\t}\n\t\t\t\tdp[y][x] += max_string( vs );\n\t\t\t}\n\t\t\tif( !dp[y][x].empty() && dp[y][x][0] != '0' ){\n\t\t\t\tmax_len = max( max_len , (int)dp[y][x].size() );\n\t\t\t}\n\t\t}\n\t}\n\tfor(int y=0 ; y < h ; y++ ){\n\t\tfor(int x=0 ; x < w ; x++ ){\n\t\t\tif( dp[y][x].size() == max_len && ( ans.empty() || ans < dp[y][x] ) ){\n\t\t\t\tans = dp[y][x];\n\t\t\t}\n\t\t}\n\t}\n\tcout << ans << endl;\n}\n\nint main(){\n\twhile( cin >> w >> h , w || h ){\n\t\tfor(int i=0 ; i < h ; i++ ){\n\t\t\tcin >> m[i];\n\t\t}\n\t\tsolve();\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nconst int dx[] = {1, 0};\nconst int dy[] = {0, 1};\n\nvector<string> board(70);\nstring memo[70][70];\nint W, H;\n\ninline bool isDigit(int x, int y)\n{\n    if ('0' <= board[y][x] && board[y][x] <= '9')\n        return true;\n    else\n        return false;\n}\n\nstring Rec(int x, int y)\n{\n    if (memo[y][x].size() != 0)\n        return memo[y][x];\n\n    string s, tmp;\n    for (int d = 0; d < 2; ++d) {\n        int nx = x + dx[d];\n        int ny = y + dy[d];\n\n        if (nx < 0 || nx >= W || ny < 0 || ny >= H || !isDigit(nx, ny))\n            continue;\n\n        tmp = Rec(nx, ny);\n        if (tmp.size() > s.size() || (tmp.size() == s.size() && tmp > s))\n            s = tmp;\n    }\n\n    return memo[y][x] = board[y][x] + s;\n}\n\nint main()\n{\n    while (cin >> W >> H, W || H) {\n        // Input\n        for (int i = 0; i < H; ++i)\n            cin >> board[i];\n\n        // Init\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                memo[i][j] = \"\";\n\n        // Solve\n        string tmp, ans;\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                if (isDigit(j, i)) {\n                    tmp = Rec(j, i);\n                    reverse(tmp.begin(), tmp.end());\n                    if (tmp.size() > ans.size() || (tmp.size() == ans.size() && tmp < ans))\n                        ans = tmp;\n                }\n\n        // Output\n        reverse(ans.begin(), ans.end());\n        int index = 0;\n        while (ans[index] == '0')\n            index++;\n        cout << ans.substr(index) << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 100000000\n\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair <int,int> P;\n\n\nstatic const double EPS = 1e-8;\n\nint tx[] = {-1,0,1,0};\nint ty[] = {0,1,0,-1};\n\nchar stage[101][101];\nint W,H;\n\nstring larger(const string& str1,const string& str2){\n\tif(str1.size() > str2.size()) return str1;\n\tif(str1.size() < str2.size()) return str2;\n\n\tfor(int i=0;i<str1.size();i++){\n\t\tif(str1[i] > str2[i] ) return str1;\n\t\tif(str1[i] < str2[i] ) return str2;\n\t}\n\n\treturn str1;\n}\n\nvoid dfs(int x,int y,string buf,string& res){\n\tbuf.push_back(stage[y][x]);\n\n\tif(y+1 < H && isdigit(stage[y+1][x])){\n\t\tdfs(x,y+1,buf,res);\t\t\n\t}\n\n\tif(x+1 < W && isdigit(stage[y][x+1])){\n\t\tdfs(x+1,y,buf,res);\n\t}\n\n\tres = larger(res,buf);\n}\n\nint main()\n{\n\twhile(~scanf(\"%d %d\",&W,&H)){\n\t\tif(W==H && H==0) break;\n\t\tfor(int y=0;y<H;y++){\n\t\t\tchar buf[128];\n\t\t\tscanf(\"%s\",buf);\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tstage[y][x] = buf[x];\n\t\t\t}\n\t\t}\n\n\t\tstring dp[101][101];\n\t\tfor(int x=0;x<W;x++) \n\t\t\tif(isdigit(stage[0][x]) && stage[0][x] != '0'){\n\t\t\tdp[0][x+1] = dp[0][x] + stage[0][x];\n\t\t\t//printf(\"dp[%d][%d]=%s\\n\",0,x+1,dp[0][x+1].c_str());\n\t\t}\n\n\t\tfor(int y=0;y<H;y++){\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tstring left=\"\";\n\t\t\t\tif(isdigit(stage[y+1][x])){\n\t\t\t\t\tif(!(dp[y+1][x].size() == 0 && stage[y+1][x]=='0')){\n\t\t\t\t\t\tleft = dp[y+1][x] + stage[y+1][x];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstring up=\"\";\n\t\t\t\tif(isdigit(stage[y][x+1])){\n\t\t\t\t\tif(!(dp[y][x+1].size() == 0 && stage[y][x+1]=='0')){\n\t\t\t\t\t\tup = dp[y][x+1] + stage[y][x+1];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tdp[y+1][x+1] = larger(left,up);\n\t\t\t}\n\t\t}\n\n\t\tstring res=\"0\";\n\t\tfor(int y=0;y<=H;y++){\n\t\t\tfor(int x=0;x<=W;x++){\t\n\t\t\t\tres = larger(res,dp[y][x]);\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <sstream>\n#include <cassert>\n#include <list>\nusing namespace std;\nstatic const double EPS = 1e-10;\ntypedef long long ll;\ntypedef pair<int,int> PI;\ntypedef vector<int> vi;\n#ifndef M_PI\n#define M_PI 3.14159265358979323846\n#endif\n#define rep(i,n) for(int i=0;i<(int)n;++i)\n#define FOR(i,c) for(__typeof((c).begin())i=(c).begin();i!=(c).end();++i)\n#define ALL(c) (c).begin(), (c).end()\n#define mp(a,b) make_pair(a,b)\n#define pb(a) push_back(a)\n#define F first\n#define S second\n\n\nint dx[]={0,1,0,-1};\nint dy[]={1,0,-1,0};\n\ntypedef struct _mulnum{\n  string number;\n  bool operator<(const _mulnum&r)const{\n    if(number.size()!=r.number.size())return number.size()<r.number.size();\n\n    rep(i,number.size()){\n      if(number[i]!=r.number[i])return number[i]<r.number[i];\n    }\n    return 0;\n  };\n  _mulnum operator+(const char&r){\n    _mulnum ret=*this;\n    ret.number+=r;\n    return ret;\n  }\n}mulnum;\n\n\nmain(){\n  int w,h;\n  while(cin>>w>>h,w|h){\n    char in[h][w+2];\n    rep(i,h)cin>>in[i];\n    mulnum dp[h][w];\n\n    mulnum ans;\n\n    rep(i,h){\n      rep(j,w){\n\tif(isdigit(in[i][j])){\n\t  if(in[i][j]!='0')dp[i][j].number+=in[i][j];\n\t  if(i && (dp[i-1][j].number.size() || in[i][j]!='0')){\n\t    dp[i][j]=max(dp[i-1][j]+in[i][j],dp[i][j]);\n\t  }\n\t  if(j && (dp[i][j-1].number.size() || in[i][j]!='0')){\n\t    dp[i][j]=max(dp[i][j-1]+in[i][j],dp[i][j]);\n\t  }\n\t}\n\tans=max(ans,dp[i][j]);\n      }\n    }\n    cout<<ans.number<<endl;\n  }\n}\n\t    "
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\nusing namespace std;\n/*\nstring solve(vector<string> &C, int W, int H, int i, int j, string ret){\n  string s[2];\n  ret += C[i][j];\n  for(int k = 1; k < 3; ++k){\n    if(i+k/2 < H && j+k%2 < W && C[i+k/2][j+k%2] <= '9' && C[i+k/2][j+k%2] >= '0'){\n      s[k-1] = solve(C,W,H,i+k/2,j+k%2,\"\");\n    }\n  }\n  if(s[0].size() == s[1].size()){\n    ret += max(s[0],s[1]);\n  }else{\n    if(s[0].size() > s[1].size()) ret += s[0];\n    else ret += s[1];\n  }\n  return ret;\n}\n*/\nint main(){\n  int W, H;\n  while(cin >> W >> H, W){\n    vector<string> C(H);\n    for(int i = 0; i < H; ++i)\n      cin >> C[i];\n    /*\n    string ans;\n    for(int i = 0; i < H; ++i){\n      if((int)ans.size() > H - i + W) break;\n      for(int j = 0; j < W; ++j){\n\tif(C[i][j] > '9' || C[i][j] <= '0' ||\n\t   (i > 0 && C[i-1][j] > '0' && C[i-1][j] <= '9') ||\n\t   (j > 0 && C[i][j-1] > '0' && C[i][j-1] <= '9'))\n\t  continue;\n\tif((int)ans.size() > H - i + W - j) break;\n\telse{\n\t  string t = solve(C,W,H,i,j,\"\");\n\t  if(ans.size() == t.size()) ans = max(ans, t);\n\t  else if(ans.size() < t.size()) ans = t;\n\t}\n      }\n    }\n    if(ans == \"\") cout << 0 << endl;\n    else cout << ans << endl;\n    */\n    string dp[H][W];\n    for(int i = 0; i < H; ++i){\n      for(int j = 0; j < W; ++j){\n\tif(C[i][j] < '0' || C[i][j] > '9') continue;\n\tstring s = string(1,C[i][j]), t = string(1,C[i][j]);\n\tif(i > 0 && dp[i-1][j] != \"0\") s = dp[i-1][j] + C[i][j];\n\tif(j > 0 && dp[i][j-1] != \"0\") t = dp[i][j-1] + C[i][j];\n\tif(s.size() == t.size()) dp[i][j] = max(s,t);\n\telse{\n\t  if(s.size() > t.size()) dp[i][j] = s;\n\t  else dp[i][j] = t;\n\t}\n      }\n    }\n    string ans = \"\";\n    for(int i = 0; i < H; ++i){\n      for(int j = 0; j < W; ++j){\n\tif(ans.size() == dp[i][j].size()) ans = max(ans,dp[i][j]);\n\telse{\n\t  if(ans.size() < dp[i][j].size()) ans = dp[i][j];\n\t}\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\nusing namespace std;\nint W,H;\nchar c[71][71];\nstring s[71][71];\n\nbool operation(string l,string r){\n\tif(l.size() != r.size()){\n\t\treturn l.size() < r.size();\n\t}\n\telse{\n\t\treturn l < r;\n\t}\n}\n\nstring solve(int i,int j){\n\tstring t = \".\";\n\tstring s1,s2;\n\ts1 = s2 = c[i][j];\n\tif(s[i][j] != t)return s[i][j];\n\tif(c[i][j+1] >= '0' && c[i][j+1] <= '9' && j+1 < W){\n\t\tif(s[i][j+1] != t) s1 += s[i][j+1];\n\t\telse s1 += solve(i,j+1);\n\t}\n\tif(c[i+1][j] >= '0' && c[i+1][j] <= '9' && i+1 < H){\n\t\tif(s[i+1][j] != t) s2 += s[i+1][j];\n\t\telse s2 += solve(i+1,j);\n\t}\n\n\ts[i][j] = max(s1,s2,operation);\n\n\treturn s[i][j];\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> W >> H;\n\t\tint x,y;\n\t\tstring st,res;\n\t\tif(W == 0)break;\n\t\tres = \"\";\n\t\tfor(int i = 0;i < 71;i++){\n\t\t\tfor(int j = 0;j <= 71;j++){\n\t\t\t\ts[i][j] = '.';\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tif(c[i][j] >= '1' && c[i][j] <= '9'){\n\t\t\t\t\tst = solve(i,j);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tres = max(res,s[i][j],operation);\n\t\t\t}\n\t\t}\t\t\n\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <limits.h>\n#include <math.h>\n#include <bitset>\n#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <cstring>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <iomanip>\n#include <iostream>\n\n#define VARIABLE(x) cerr << #x << \"=\" << x << endl\n#define BINARY(x) static_cast<bitset<16> >(x);\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\n#define REP(i,m,n) for (int i=m;i<(int)(n);i++)\n#define if_range(x, y, w, h) if (0<=(int)(x) && (int)(x)<(int)(w) && 0<=(int)(y) && (int)(y)<(int)(h))\n\nconst int INF = 100000000;\ntypedef double D;\nconst double EPS = 1e-8;\nconst double PI = 3.14159;\nint dx[4]={-1, 0, 1, 0}, dy[4]={0, -1, 0, 1};\nusing namespace std;\ntypedef pair<int, int> P;\n\n/** Problem1126 : The Secret Number **/\nconst int MAX_W = 70;\nint W, H;\nchar field[MAX_W][MAX_W];\nstring dp[MAX_W][MAX_W];\n\nstring big(const string &s1, const string &s2) {\n\tif (s1.length() > s2.length()) {\n\t\treturn s1;\n\t} else if (s2.length() > s1.length()) {\n\t\treturn s2;\n\t} else {\n\t\treturn (s1>s2?s1:s2);\n\t}\n}\n\nstring rec(int x, int y)\n{\n\tif (!('0' <= field[y][x] && field[y][x] <= '9'))\n\t\treturn dp[y][x] = \"\";\n\t\n\tstring s1 = field[y][x] + dp[y][x+1];\n\tstring s2 = field[y][x] + dp[y+1][x];\n\n\treturn dp[y][x] = big(s1, s2);\n}\n\nint main()\n{\n\twhile (cin>>W>>H, W||H) {\n\t\tfill(dp[0], dp[0]+W*H, \"\");\n\t\t\n\t\trep(i, H) {\n\t\t\trep(j, W) {\n\t\t\t\tcin>>field[i][j];\n\t\t\t}\n\t\t}\n\t\t\n\t\tstring ans = \"0\";\n\t\trep(y, H) {\n\t\t\trep(x, W) {\n\t\t\t\tstring tmp = rec(W-x-1, H-y-1);\n\t\t\t\tif (tmp[0] == '0') continue;\n\t\t\t\t\n\t\t\t\tans = big(ans, rec(W-x-1, H-y-1));\n\t\t\t\t\n\t\t\t}\n\t\t}\n\t\t\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cstring>\nusing namespace std;\n\nbool isNumber( char c )\n{\n    return c >= '0' && c <= '9';\n}\n\nint main( void )\n{\n    string dp[71][71];\n    int W, H;\n\n    while ( true )\n    {\n        cin >> W >> H;\n        if ( W == 0 && H == 0 ) break;\n\n        string C[70];\n        for ( int i = 0; i < H; i++ )\n        {\n            cin >> C[i];\n        }\n\n        for ( int i = 0; i < H; i++ ) for ( int j = 0; j < W; j++ ) dp[i][j] = \"\";\n\n        for ( int i = 0; i < H; i++ )\n        {\n            for ( int j = 0; j < W; j++ )\n            {\n                if ( isNumber( C[i][j] ) == false ) continue;\n                if ( i == 0 && j == 0 )\n                {\n                    if ( isNumber( C[i][j] ) ) dp[i][j] += C[i][j];\n                }\n                else if ( i == 0 )\n                {\n                    dp[i][j] += dp[i][j-1];\n                    if ( isNumber( C[i][j] ) ) dp[i][j] += C[i][j];\n                }\n                else if ( j == 0 )\n                {\n                    dp[i][j] += dp[i-1][j];\n                }\n                else\n                {\n                    if ( dp[i-1][j].size() > dp[i][j-1].size() )\n                    {\n                        dp[i][j] += dp[i-1][j];\n                    }\n                    else if ( dp[i-1][j].size() < dp[i][j-1].size() )\n                    {\n                        dp[i][j] += dp[i][j-1];\n                    }\n                    else if ( dp[i-1][j] > dp[i][j-1] )\n                    {\n                        dp[i][j] += dp[i-1][j];\n                    }\n                    else\n                    {\n                        dp[i][j] += dp[i][j-1];\n                    }\n                    if ( isNumber( C[i][j] ) ) dp[i][j] += C[i][j];\n                }\n            }\n        }\n\n        string answer = \"\";\n        for ( int i = 0; i < H; i++ )\n        {\n            for ( int j = 0; j < W; j++ )\n            {\n                while ( dp[i][j][0] == '0' ) dp[i][j] = dp[i][j].substr( 1 );\n\n                if ( dp[i][j].size() > answer.size() )\n                {\n                    answer = dp[i][j];\n                }\n                else if ( dp[i][j].size() == answer.size() && dp[i][j] > answer )\n                {\n                    answer = dp[i][j];\n                }\n            }\n        }\n\n        cout << answer << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <string>\n#include <cstring>\n#include <deque>\n#include <list>\n#include <queue>\n#include <stack>\n#include <vector>\n#include <utility>\n#include <algorithm>\n#include <map>\n#include <set>\n#include <complex>\n#include <cmath>\n#include <limits>\n#include <cfloat>\n#include <climits>\n#include <ctime>\n#include <cassert>\nusing namespace std;\n\n#define rep(i,a,n) for(int (i)=(a); (i)<(n); (i)++)\n#define repq(i,a,n) for(int (i)=(a); (i)<=(n); (i)++)\n#define repr(i,a,n) for(int (i)=(a); (i)>=(n); (i)--)\n#define all(v) begin(v), end(v)\n#define pb(a) push_back(a)\n#define fr first\n#define sc second\n#define INF 2000000000\n#define int long long int\n\n#define X real()\n#define Y imag()\n#define EPS (1e-10)\n#define EQ(a,b) (abs((a) - (b)) < EPS)\n#define EQV(a,b) ( EQ((a).X, (b).X) && EQ((a).Y, (b).Y) )\n#define LE(n, m) ((n) < (m) + EPS)\n#define LEQ(n, m) ((n) <= (m) + EPS)\n#define GE(n, m) ((n) + EPS > (m))\n#define GEQ(n, m) ((n) + EPS >= (m))\n\ntypedef vector<int> VI;\ntypedef vector<VI> MAT;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n\ntypedef complex<double> P;\ntypedef pair<P, P> L;\ntypedef pair<P, double> C;\n\nint dx[]={1, 0};\nint dy[]={0, 1};\nint const MOD = 1000000007;\nll mod_pow(ll x, ll n) {return (!n)?1:(mod_pow((x*x)%MOD,n/2)*((n&1)?x:1))%MOD;}\nint madd(int a, int b) {return (a + b) % MOD;}\nint msub(int a, int b) {return (a - b + MOD) % MOD;}\nint mmul(int a, int b) {return (a * b) % MOD;}\nint minv(int a) {return mod_pow(a, MOD-2);}\nint mdiv(int a, int b) {return mmul(a, minv(b));}\n\nnamespace std {\n    bool operator<(const P& a, const P& b) {\n        return a.X != b.X ? a.X < b.X : a.Y < b.Y;\n    }\n}\n\nint w, h;\nchar board[110][110];\nstring dp[110][110];\n\nstring comp(string s1, string s2) {\n    if(s1.length() == s2.length()) return max(s1, s2);\n    else if(s1.length() > s2.length()) return s1;\n    else return s2;\n}\n\nsigned main() {\n    while(cin >> w >> h, w||h) {\n        repq(i,0,h) repq(j,0,w) dp[i][j] = \"\";\n        repq(i,1,h) repq(j,1,w) cin >> board[i][j];\n        string ans = \"\";\n        repq(i,1,h) repq(j,1,w) {\n            if('A' <= board[i][j] && board[i][j] <= 'Z') dp[i][j] = \"\";\n            else {\n                string s1 = dp[i-1][j], s2 = dp[i][j-1];\n                string ma = comp(s1, s2);\n                // cout << \"s1 = \" << s1 << \", s2 = \" << s2 << \", ma = \" << ma << endl;\n                if(ma == \"\") dp[i][j] += board[i][j];\n                else dp[i][j] = ma + board[i][j];\n            }\n            ans = comp(ans, dp[i][j]);\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<sstream>\n#include<cstring>\n#include<vector>\nusing namespace std;\n\nbool cmp1(const string& a,const string& b)\n{\n  int size_a,size_b;\n  int start_a,start_b;\n  start_a = start_b = 0;\n  size_a = a.size(),size_b = b.size();\n  if(a[0] == '0')\n    for(int i=0;i<a.size() && a[i] == '0';i++)\n      size_a--,start_a++;\n\n  if(b[0] == '0')\n    for(int i=0;i<b.size() && b[i] == '0';i++)\n      size_b--,start_b++;\n\n  if(size_a != size_b)\n    return size_a < size_b;\n\n  for(int i=0;i<size_a;i++)\n    {\n      if(a[start_a+i] != b[start_b+i])\n\treturn a[start_a+i] < b[start_b+i];\n    }\n  return true;\n}\n\nbool cmp2(const string& a,const string& b)\n{\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    {\n      if(a[i] != b[i])\n\treturn a[i] < b[i];\n    }\n  return true;\n}\n\nint main()\n{\n    \n  int W,H;\n  while(cin >> W >> H,W|H)\n    {\n      vector<vector<string> > G;\n      G.resize(H);\n      for(int i=0;i<H;i++)\n\t{\n\t  G[i].resize(W);\n\t  string line;\n\t  cin >> line;\n\t  for(int j=0;j<W;j++)\n\t    {\n\t      G[i][j] = line[j];\n\t    }\n\t}\n\n      string G2[H][W];\n      string ans = \"\";\n      for(int i=0;i<H;i++)\n\t{\n\t  for(int j=0;j<W;j++)\n\t    {\n\t      if(isalpha(G[i][j][0]))\n\t\tcontinue;\n\t      //cout << i << \" - \" << j << endl;\n\t      G2[i][j] = max(G2[i][j],G[i][j],cmp1);\n\t      string A,B;\n\t      A = B = G2[i][j];\n\t      if(j-1 >= 0 && !isalpha(G[i][j-1][0]))\n\t\tA = max(G2[i][j],G2[i][j-1]+G2[i][j],cmp1);\n\n\t      if(i-1 >= 0 && !isalpha(G[i-1][j][0]))\n\t\tB = max(G2[i][j],G2[i-1][j]+G2[i][j],cmp1);\n\t      G2[i][j] = max(A,B,cmp1);\n\t      //cout << \"G2[\" << i << \"][\" << j << \"] = \" << G2[i][j] << endl;\n\t      ans = max(G2[i][j],ans,cmp2);\n\t    }\n\t}\n    \n      if(ans.size() != 1 && ans[0] == '0')\n\t{\n\t  for(int i=0;i<ans.size()&&ans[0] == '0';i++)\n\t    ans[i] = ' ';\n\t  stringstream ss;\n\t  ss << ans;\n\t  ss >> ans;\n\t  cout << ans << endl;\n\t}\n      else \n\tcout << ans << endl;\n      }\n    \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nint main() {\n\tint w, h;\n\twhile (cin >> w >> h, w){\n\t\tvector<string> vs(h);\n\t\tvector<vector<bool>> vvb(h);\n\t\tREP(i, h){\n\t\t\tcin >> vs[i];\n\t\t\tREP(j, w){\n\t\t\t\tvvb[i].push_back('0' <= vs[i][j] && vs[i][j] <= '9');\n\t\t\t}\n\t\t}\n\n\t\tvector<vector<int>> vvi(h);\n\t\tint max2 = 1;\n\t\tint x, y;\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tif (vvb[i][j]){\n\t\t\t\t\tint max = 1;\n\t\t\t\t\tif (i > 0 && vvb[i - 1][j])max = vvi[i - 1][j] + 1;\n\t\t\t\t\tif (j > 0 && vvb[i][j - 1])if (max < vvi[i][j - 1] + 1)max = vvi[i][j - 1] + 1;\n\t\t\t\t\tvvi[i].push_back(max);\n\t\t\t\t\tif (max > max2){\n\t\t\t\t\t\tmax2 = max;\n\t\t\t\t\t\t x = j;\n\t\t\t\t\t\t y = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tvvi[i].push_back(-1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvector<vector<int>> vvi2(h);\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tvvi2[i].push_back(-1);\n\t\t\t}\n\t\t}\n\t\tvvi2[y][x] = max2;\n\t\tqueue<int> qi;\n\t\tqi.push(max2 * 10000 + x * 100 + y);\n\t\twhile (!qi.empty()){\n\t\t\tint pos = qi.front(); qi.pop();\n\t\t\tint max3 = pos / 10000;\n\t\t\tint x2 = (pos / 100) % 100;\n\t\t\tint y2 = pos % 100;\n\t\t\tif (x2 > 0 && vvb[y2][x2 - 1] && vvi2[y2][x2 - 1]==-1){\n\t\t\t\tvvi2[y2][x2 - 1] = max3 - 1;\n\t\t\t\tqi.push((max3-1) * 10000 + (x2-1) * 100 + y2);\n\t\t\t}\n\t\t\tif (y2 > 0 && vvb[y2 - 1][x2] && vvi2[y2-1][x2] == -1){\n\t\t\t\tvvi2[y2 - 1][x2] = max3 - 1;\n\t\t\t\tqi.push((max3 - 1) * 10000 + x2 * 100 + (y2-1));\n\t\t\t}\n\t\t}\n\t\tchar max4 = '0' - 1;\n\t\tint x3, y3;\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tif (vvi2[i][j] == 1 && max4 < vs[i][j]){\n\t\t\t\t\tmax4 = vs[i][j];\n\t\t\t\t\tx3 = j;\n\t\t\t\t\ty3 = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ans;\n\t\tif(max4!='0')ans += max4;\n\t\tREP(i,max2-1){\n\t\t\tbool abb = false;\n\t\t\tmax4 = '0' - 1;\n\t\t\tif (y3 + 1 != h&&vvi2[y3+1][x3]>0 && max4 < vs[y3 + 1][x3]){\n\t\t\t\tmax4 = vs[y3 + 1][x3];\n\t\t\t\ty3 ++;\n\t\t\t\tabb = true;\n\t\t\t}\n\t\t\tif (abb){\n\t\t\t\tif (x3 + 1 != w&&vvi2[y3-1][x3 + 1]>0 && max4 < vs[y3-1][x3 + 1]){\n\t\t\t\t\tmax4 = vs[y3-1][x3 + 1];\n\t\t\t\t\tx3++;\n\t\t\t\t\ty3--;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif (x3 + 1 != w&&vvi2[y3][x3 + 1]>0 && max4 < vs[y3][x3 + 1]){\n\t\t\t\t\tmax4 = vs[y3][x3 + 1];\n\t\t\t\t\tx3++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!(ans.empty() && max4 == '0'))ans += max4;\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \n//conversion\n//------------------------------------------\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\n \n//math\n//-------------------------------------------\ntemplate<class T> inline T sqr(T x) {return x*x;}\n \n//typedef\n//------------------------------------------\ntypedef pair<int, int> PII;\ntypedef pair<long, long> PLL;\ntypedef long long LL;\n//container util\n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define SORT(c) sort((c).begin(),(c).end())\n \n//repetition\n//------------------------------------------\n#define FOR(i,a,b) for(LL i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n \n//constant\n//--------------------------------------------\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\nconst int INF=INT_MAX;\n//clear memory\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\nint rd(int num){\n\treturn min(255,max(0,num));\n}\n\nbool ch(char c){\n\treturn (c>='0'&&c<='9');\n}\nint dp[20002][256];\nint main(){\n\tint W,H;\n\twhile(cin>>W>>H){\n\t\tif(W==0)return 0;\n\t\tchar C[75][75];\n\t\tREP(i,75)REP(j,75)C[i][j]='#';\n\t\tREP(i,H)REP(j,W)cin>>C[i+1][j+1];\n\t\tstring dp[75][75];\n\t\tREP(i,75)REP(j,75)dp[i][j]=\"\";\n\t\tstring res=\"\";\n\t\tFOR(h,1,H+1)FOR(w,1,W+1){\n\t\t\tstring tmp=\"\";\n\t\t\tif(!ch(C[h][w]))continue;\n\t\t\t\n\t\t\ttmp=dp[h-1][w-1];\n\t\t\tif(SZ(tmp)<SZ(dp[h][w-1])||(SZ(tmp)==SZ(dp[h][w-1])&&tmp<dp[h][w-1])){\n\t\t\t\ttmp=dp[h][w-1];\n\t\t\t}\n\t\t\tif(SZ(tmp)<SZ(dp[h-1][w])||(SZ(tmp)==SZ(dp[h-1][w])&&tmp<dp[h-1][w])){\n\t\t\t\ttmp=dp[h-1][w];\n\t\t\t}\n\t\t\tif(tmp!=\"0\")dp[h][w]=tmp+C[h][w];\n\t\t\telse dp[h][w]=C[h][w];\n\t\t\tif(SZ(res)<SZ(dp[h][w])||(SZ(res)==SZ(dp[h][w])&&res<dp[h][w])){\n\t\t\t\tres=dp[h][w];\n\t\t\t}\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\treturn 0;\n}\n/*\n7 4\n0000AAA\nAAAA1AA\nAAAAA0A\nAAAAAA1\n*/"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n#define pb push_back \n#define pf push_front \n#define mp make_pair\n#define fr first\n#define sc second\n#define Rep(i, n) for ( int i = 0 ; i < (n); i++ )\n#define All(v) v.begin(), v.end()\n\ntypedef pair<int, int> Pii; typedef pair<int, Pii> Pip;\nconst int INF = 1107110711071107;\n\nint h, w;\nchar c[71][71];\n\nsigned main() {\n  while ( cin >> w >> h, w | h ) {\n    vector<string> dp[71];\n    Rep(i, h) dp[i] = vector<string>(71);\n    Rep(i, h) Rep(j, w) {\n      cin >> c[i][j];\n      dp[i][j] = \"0\";\n    }\n  \n    Rep(i, h) Rep(j, w) {  \n      if ( '0' <= c[i][j] && c[i][j] <= '9' ) dp[i][j] = c[i][j];\n    }\n  \n    for ( int i = 0; i < h; i++ ) {\n      Rep(j, w) {\n\tif ( '0' <= c[i][j] && c[i][j] <= '9' ) {\n\t  if ( i && dp[i-1][j] != \"0\" ) {\n\t    if ( dp[i][j].size() <= dp[i-1][j].size() ) {\n\t      dp[i][j] = dp[i-1][j]+c[i][j];\n\t    } else if ( dp[i][j].size()-1 == dp[i-1][j].size() ) {\n\t      dp[i][j] = max(dp[i][j], dp[i-1][j]+c[i][j]);\n\t    }\n\t  }\n\t  if ( j && dp[i][j-1] != \"0\" ) {\n\t    if ( dp[i][j].size() <= dp[i][j-1].size() ) {\n\t      dp[i][j] = dp[i][j-1]+c[i][j];\n\t    } else if ( dp[i][j].size()-1 == dp[i][j-1].size() ) {\n\t      dp[i][j] = max(dp[i][j], dp[i][j-1]+c[i][j]);\n\t    }\n\t  }\n\t}\n      }\n    }\n\n    string ans = \"\";\n    Rep(i, h) Rep(j, w) {\n      if ( ans.size() < dp[i][j].size() ) ans = dp[i][j];\n      else if ( ans.size() == dp[i][j].size() ) ans = max(ans, dp[i][j]);\n    }\n\n    cout << ans << endl;\n  }\n  \n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\nusing namespace std;\nint W,H;\nchar c[71][71];\nstring s[71][71],t = \".\";\n\nbool operation(string l,string r){\n\tif(l.size() != r.size()){\n\t\treturn l.size() < r.size();\n\t}\n\telse{\n\t\treturn l < r;\n\t}\n}\n\nvector<string> v;\n\nstring solve(int i,int j){\n\tlong long a,b;\n\tstring s1,s2;\n\ts1 = s2 = c[i][j];\n\tif(s[i][j] != t)return s[i][j];\n\tif(c[i][j+1] >= '0' && c[i][j+1] <= '9' && j+1 < W){\n\t\tif(s[i][j+1] != t) s1 += s[i][j+1];\n\t\telse s1 += solve(i,j+1);\n\t}\n\tif(c[i+1][j] >= '0' && c[i+1][j] <= '9' && i+1 < H){\n\t\tif(s[i+1][j] != t) s2 += s[i+1][j];\n\t\telse s2 += solve(i+1,j);\n\t}\n\n\ts[i][j] = max(s1,s2,operation);\n\n\tv.push_back(s[i][j]);\n\treturn s[i][j];\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> W >> H;\n\t\tint x,y;\n\t\tstring st,res;\n\t\tif(W == 0)break;\n\t\tv.clear();\n\t\tres = \"\";\n\t\tfor(int i = 0;i < 71;i++){\n\t\t\tfor(int j = 0;j <= 71;j++){\n\t\t\t\ts[i][j] = '.';\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tcin >> c[i][j];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0;i < H;i++){\n\t\t\tfor(int j = 0;j < W;j++){\n\t\t\t\tif(c[i][j] >= '1' && c[i][j] <= '9'){\n\t\t\t\t\tst = solve(i,j);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tsort(v.begin(),v.end(),operation);\n//\t\tfor(int i = 0;i < v.size();i++){\n//\t\t\tres = max(res,v[i].s,operation);\n//\t\t}\t\t\n\n\t\tcout << v[v.size()-1] << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <vector>\n#include <string>\n#include <queue>\n#include <deque>\n#include <list>\n#include <stack>\n#include <set>\n#include <map>\n#include <algorithm>\n\n#define int long long\n#define MOD7 1000000007\n#define MOD9 1000000009\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n#define REP(i, a, n) for (int i = (a); i <= (n); i++)\n#define all(a) (a).begin(), (a).end()\n\nusing namespace std;\n\nint dx[4] = { 1, 0, -1, 0 };\nint dy[4] = { 0, -1, 0, 1 };\n\nint nextInt() {int a; cin >> a; return a;}\nchar nextChar() {char a; cin >> a; return a;}\ndouble nextDouble() {double a; cin >> a; return a;}\nstring nextString() {string a; cin >> a; return a;}\n\nvoid inputVector(vector<int> &v, int &n) {rep(i,n){v.push_back(nextInt());}}\nvoid inputVector(vector<double> &v, int &n) {rep(i,n){v.push_back(nextDouble());}}\nvoid inputVector(vector<string> &v, int &n) {rep(i,n){v.push_back(nextString());}}\n\nsigned main() {\n    int W, H;\n    while (cin >> W >> H) {\n\tif (W == 0) break;\n\n\tvector<string> board;\n\tinputVector(board, H);\n\n\tstring ret = \"\";\n\tstring dp[70][70];\n\tfor (int y = H - 1; y >= 0; y--) {\n\t    for (int x = W - 1; x >= 0; x--) {\n\t\tif (board[y][x] < '0' || board[y][x] > '9') dp[y][x] = \"\";\n\t\telse {\n\t\t    string prev = \"\";\n\t\t    if (y < H - 1) prev = dp[y + 1][x];\n\t\t    if (x < W - 1 && dp[y][x + 1].size() > prev.size()) prev = dp[y][x + 1];\n\t\t    dp[y][x] = board[y][x] + prev;\n\t\t    if (board[y][x] == '0') continue;\n\t\t    if (ret.size() > dp[y][x].size()) continue;\n\t\t    if (ret.size() == dp[y][x].size() && ret > dp[y][x]) continue;\n\t\t    ret = dp[y][x];\n\t\t}\n\t    }\n\t}\n\tcout << ret << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n//http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#include<iostream>\n#include<map>\n#include<vector>\n#include<algorithm>\n#include<cmath>\n#include<climits>\n#include<ctime>\n#include<cstring>\n#include<numeric>\n\n#define ALL(v) (v).begin(),(v).end()\n#define REP(i,p,n) for(int i=p;i<(int)(n);++i)\n#define rep(i,n) REP(i,0,n)\n#define dump(a) (cerr << #a << \"=\" << (a) << endl)\n#define DUMP(list) cout << \"{ \"; for(auto nth : list){ cout << nth << \" \"; } cout << \"}\" << endl;\n\nusing namespace std;\n\nint W,H;\nchar matrix[70][70];\nint dw[2] = {0, 1};\nint dh[2] = {1, 0};\nstring ans;\n\nbool cmp(string str1, string str2)\n{\t\n\tif(str1.length() == str2.length()){\n\t\tif(str1 < str2){ return true; }\n\t}\n\telse if(str1.length() < str2.length()){\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\nvoid dfs(int w, int h, vector<char> list)\n{\n\tif(w < 0 || w >= W || h < 0 || h >= H){ return; }\n\tif(!isdigit(matrix[h][w])){ return; }\n\n\tlist.push_back(matrix[h][w]);\n\tmatrix[h][w] = '#';\n\n\trep(i,2){\n\t\tdfs(w+dw[i], h+dh[i], list);\n\t}\n\n\tif(list.size() == 0){ return; }\n\tstring num(ALL(list));\n\n\tif(cmp(ans,num)){ ans = num; }\n\treturn;\n}\n\nint main()\n{\n\twhile(cin >> W >> H && W)\n\t{\n\n\t\trep(h,H){\n\t\t\trep(w,W){\n\t\t\t\tcin >> matrix[h][w];\n\t\t\t}\n\t\t}\n\n\t\tans=\"\";\n\t\tvector<char> list;\n\t\trep(h,H){\n\t\t\trep(w,W){\n\t\t\t\tdfs(w,h,list);\n\t\t\t}\n\t\t}\n\n\t\tbool flag=false;\n\t\trep(i,ans.length()){\n\t\t\tif(ans[i] != '0' || flag){ cout << ans[i]; flag=true; }\n\t\t}\n\t\tcout << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "// AOJ 1126\n#include<iostream>\n#include<string>\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\nusing namespace std;\n\nbool iszero(string s) {\n  for (char c : s) {\n    if (c != '0') return false;\n  }\n  return true;\n}\n\nstring remove_zero(string s) {\n  for (int i = 0, len = s.length(); i < len; i++) {\n    if (s[i] != '0') return s.substr(i);\n  }\n  return \"\";\n}\n\nint compare(string s1, string s2) {\n  int l1 = s1.length(), l2 = s2.length();\n\n  if (l1 < l2) {\n    return -1;\n  } else if (l1 > l2) {\n    return 1;\n  } else {\n    return s1.compare(s2);\n  }\n}\n\nstring strmax(string s1, string s2) {\n  return (compare(s1, s2) > 0 ? s1 : s2);\n}\n\nint W, H;\nconst int WMAX = 100;\nchar table[WMAX][WMAX];\nstring dp[WMAX][WMAX];\n\nvoid solve() {\n  for (int y = H - 1; y >= 0; y--) {\n    for (int x = W - 1; x >= 0; x--) {\n      if (isalpha(table[x][y])) {\n        dp[x][y] = \"\";\n      } else {\n        dp[x][y] = table[x][y] + strmax(dp[x+1][y], dp[x][y+1]);\n      }\n    }\n  }\n}\n\nvoid init() {\n  REP(y,H+3) REP(x,W+3) {\n    dp[x][y] = \"\";\n  }\n}\n\nint main() {\n  while (cin >> W >> H and (W or H)) {\n    REP(y, H) {\n      string row;\n      cin >> row;\n      REP(x, W) {\n        table[x][y] = row[x];\n      }\n    }\n\n    solve();\n\n    string mx = \"\";\n    REP(y,H) REP(x,W) {\n      if (iszero(dp[x][y])) continue;\n      mx = strmax(mx, remove_zero(dp[x][y]));\n    }\n    cout << remove_zero(mx) << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define rep(i, a, n) for(int i = a; i < n; i++)\nusing namespace std;\ntypedef pair<string, pair<int, int> > P;\n\nint w, h;\nchar c[80][80];\n\nint dy[2] = {1, 0};\nint dx[2] = {0, 1};\nbool f[70][70];\n\nbool is_digit(char c){\n    return ('0' <= c && c <= '9');\n}\n\nbool contain(int y, int x){\n    return (0 <= y && y < h && 0 <= x && x < w);\n}\n\nvector<string> res;\n\nvoid dfs(int y, int x, string s){\n    // cout << y << \" \" << x << \" \" <<s << endl;\n    if(!contain(y, x) || !is_digit(c[y][x])){\n        res.push_back(s);\n        return;\n    }\n    f[y][x] = true;\n    rep(i, 0, 2){\n        int ny = y + dy[i];\n        int nx = x + dx[i];\n        dfs(ny, nx, s + c[y][x]);\n    }\n    return;\n}\n\n//s1 < s2?\nbool comp(string s1, string s2){\n    if(s1.size() == s2.size()) return s1 < s2;\n    return s1.size() < s2.size();\n}\n\nint main(){\n    while(1){\n        cin >> w >> h;\n        if(w + h == 0) break;\n        rep(i, 0, h){\n            rep(j, 0, w){\n                cin >> c[i][j];\n            }\n        }\n        string d[70][70];\n        rep(i, 0, h){\n            rep(j, 0, w){\n                d[i][j] = \"\";\n                if(is_digit(c[i][j]) && c[i][j] != '0'){\n                    d[i][j] += c[i][j];\n                }\n            }\n        }\n        rep(i, 0, h){\n            rep(j, 0, w){\n                string t = \"\", t1 = \"\";\n                if(i != 0){\n                    if(is_digit(c[i][j]) && d[i - 1][j] != \"\"){\n                        t = d[i - 1][j] + c[i][j];\n                    }\n                }\n                if(j != 0){\n                    if(is_digit(c[i][j]) && d[i][j - 1] != \"\"){\n                        t1 = d[i][j - 1] + c[i][j];\n                    }\n                }\n                // cout << d[i][j] << \" \";\n                if(comp(d[i][j], t)) d[i][j] = t;\n                if(comp(d[i][j], t1)) d[i][j] = t1;\n                // cout << i << \" \" << j << \" \" << d[i][j] << endl;\n            }\n        }\n        string ans = \"\";\n        rep(i, 0, h){\n            rep(j, 0, w){\n                if(comp(ans, d[i][j])) ans = d[i][j];\n            }\n        }\n        cout << ans << endl;\n        // res.clear();\n        // rep(i, 0, h) rep(j, 0, w) f[i][j] = false;\n        // rep(i, 0, h){\n        //     rep(j, 0, w){\n        //         if(f[i][j] == false && is_digit(c[i][j]) && c[i][j] != '0'){\n        //             string tmp = \"\";\n        //             dfs(i, j, tmp);\n        //         }\n        //     }\n        // }\n        // // rep(i, 0, res.size()){\n        // //     cout << res[i] << endl;\n        // // }     \n        // int sz = 0;\n        // rep(i, 0, res.size()){\n        //     sz = max(sz, (int)res[i].size());\n        // }\n        // string ans = \"\";\n        // rep(i, 0, res.size()){\n        //     if(res[i].size() == sz && ans < res[i]) ans = res[i];\n        // }\n        // cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\nint w, h;\nint gc;\nstring s[51], dp[51][51];\nbool is_num(char c){return '0'<=c && c<= '9';}\n\nstring str_max(const string& s1, const string& s2) {\n  if (s1.size() == s2.size()) {\n    return (s1 > s2) ? s1 : s2 ;\n  }\n  return (s1.size() > s2.size())? s1 : s2 ;\n}\n\nstring dfs(int i, int j) {\n  string res = \"\";\n  \n  if (!is_num(s[i][j])) return res;\n  if (i >= h || j >= w) return res;\n  // DP\n  if (dp[i][j] != \"-\") return dp[i][j];\n  \n  //gc++;\n\n  res = s[i][j] + str_max(dfs(i, j+1), dfs(i+1, j));\n  \n  // ªÉ0ªÂ¢Ä¢éêÍæé\n  if (i == 0 && j == 0) {\n    if (res[0] == '0') res.erase(0, 1);\n  } else if (i == 0) {\n    if (!is_num(s[i][j-1]) && res[0] == '0') res.erase(0, 1);\n  } else if (j == 0) {\n    if (!is_num(s[i-1][j]) && res[0] == '0') res.erase(0, 1);\n  } else{\n    if (!is_num(s[i-1][j]) && !is_num(s[i][j-1])) res.erase(0, 1);\n  }\n  \n  return dp[i][j] = res;\n}\n\nvoid solve() {\n  for(int i=0;i<h;i++) cin>>s[i];\n  // init\n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  dp[i][j] = \"-\";\n  \n  // search\n  string largest = \"\";\n  //gc = 0;\n  \n  for(int i=h-1;i>=0;i--)\n  for(int j=w-1;j>=0;j--)\n  if (dp[i][j] == \"-\" && is_num(s[i][j]))\n  largest = str_max(dfs(i, j), largest);\n  \n  /*\n  for(int i=0;i<h;i++) {\n    for(int j=0;j<w;j++) cout<<\"[\"<<dp[i][j]<<\"]\";\n    cout<<endl;\n  }\n  */\n  //cout<<gc<<endl;\n  cout<<largest<<endl;\n}\n\nint main (int argc, char const* argv[]) {\n  while (cin>>w>>h, w||h) {\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\nclass ln{\nprivate:\n  long long d[10];\n  int len;\npublic:\n  ln(){\n  len=0;\n  for(int i=0;i<10;i++)\n    d[i]=0;\n  }\n  ln big(ln a,ln b){\n    if(a.len>b.len)\n      return a;\n    else if(a.len<b.len)\n      return b;\n    else {\n      for(int i=0;i<10;i++){\n\t  if(a.d[i]>b.d[i])\n\t    return a;\n\t  else if(a.d[i]<b.d[i])\n\t    return b;\n      }\n      return a;\n    }\n  }\n  void plus(int b){\n    if(b=='0'&&d[0]==0) return;\n    // cout<<(char)b;\n    int tmp=len/10;\n    d[tmp]*=10;\n    d[tmp]+=(b-'0');\n    //    cout<<b-'0'<<endl;\n    len++;\n  }  \n  void print(){\n    for(int i=0;i<(len-1)/10+1;i++)\n       cout<<d[i];\n\n    cout<<endl;\n  }\n};\nint main(){\n  int w,h;\n  char input[75][75];\n \n  //\n  while(1){\n  \n    cin>>w>>h;\n    ln out[75][75];\n    ln maxval;\n    if(w==0&&h==0){ //cout<<endl;\n      return 0;}\n    for(int i=0;i<w+1;i++)\n      input[0][i]=0;\n    for(int i=1;i<h+1;i++){\n      input[i][0]=0;\n      cin>>(char*)(input[i]+1);\n    }\n    // for(int i=0;i<h+1;i++)\n    //   cout<<input[i]+1<<endl;\n    for(int i=1;i<=w+h;i++)\n      for(int j=1;j<i;j++)\n\tif(input[j][i-j]>='0'&&input[j][i-j]<='9') \n\t  {\n\t    if(j>h||i-j>w) continue;\n\t    //cout<<j<<\" j  \"<<i-j<<endl;\n\t    out[j][i-j]=out[0][0].big(out[j-1][i-j],out[j][i-j-1]);\n\t    out[j][i-j].plus(input[j][i-j]);    \n\t    //  out[j][i-j].print();\n\t    maxval=out[0][0].big(out[j][i-j],maxval);\n\t    //  maxval.print();\n\t  }\n     maxval.print();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nconst int dx[] = {1, 0};\nconst int dy[] = {0, 1};\n\nvector<string> board(80);\nstring memo[80][80];\nint W, H;\n\ninline bool isDigit(int x, int y)\n{\n    if ('0' <= board[y][x] && board[y][x] <= '9')\n        return true;\n    else\n        return false;\n}\n\nstring Rec(int x, int y)\n{\n    if (memo[y][x].size() != 0)\n        return memo[y][x];\n\n    string s, tmp;\n    for (int d = 0; d < 2; ++d) {\n        int nx = x + dx[d];\n        int ny = y + dy[d];\n\n        if (nx < 0 || nx >= W || ny < 0 || ny >= H || !isDigit(nx, ny))\n            continue;\n\n        tmp = Rec(nx, ny);\n        if (tmp.size() > s.size() || (tmp.size() == s.size() && tmp > s))\n            s = tmp;\n    }\n\n    return memo[y][x] = board[y][x] + s;\n}\n\nint main()\n{\n    while (cin >> W >> H, W || H) {\n        // Input\n        for (int i = 0; i < H; ++i)\n            cin >> board[i];\n\n        // Init\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                memo[i][j] = \"\";\n\n        // Solve\n        string tmp, ans;\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                if (isDigit(j, i) && memo[i][j].size() == 0) {\n                    tmp = Rec(j, i);\n                    int index = 0;\n                    while (tmp[index] == '0')\n                        index++;\n                    tmp = tmp.substr(index);\n\n                    if (tmp.size() > ans.size() || (tmp.size() == ans.size() && tmp > ans))\n                        ans = tmp;\n                }\n\n        // Output\n        cout << ans << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n#include <functional>\n\n#define REP(i, a, b) for (int i = int(a); i < int(b); i++)\n#ifdef _DEBUG_\n#define dump(val) cerr << __LINE__ << \":\\t\" << #val << \" = \" << (val) << endl\n#else\n#define dump(val)\n#endif\n\nusing namespace std;\n\ntypedef long long int ll;\n\ntemplate<typename T>\nvector<T> make_v(size_t a, T b) {\n    return vector<T>(a, b);\n}\n\ntemplate<typename... Ts>\nauto make_v(size_t a, Ts... ts) {\n    return vector<decltype(make_v(ts...))>(a, make_v(ts...));\n}\n\ntemplate<typename T>\nvoid chmax(T &a, T b) {\n    if (a.size() != b.size()) {\n        a = (a.size() < b.size() ? b : a);\n    } else {\n        a = max(a, b);\n    }\n}\n\nint main() {\n    cin.tie(nullptr);\n    ios::sync_with_stdio(false);\n    int h, w;\n    while (cin >> w >> h, h + w) {\n        auto mp = make_v(h, w, -1);\n        REP(i, 0, h) {\n            REP(j, 0, w) {\n                char c;\n                cin >> c;\n                if ('0' <= c && c <= '9') {\n                    c -= '0';\n                    mp[i][j] = c;\n                }\n            }\n        }\n        auto memo = make_v(h, w, vector<int>());\n        function<vector<int>(int, int)> solve = [&](int x, int y) {\n            if (memo[y][x].size() != 0) return memo[y][x];\n            if (mp[y][x] == -1) return vector<int>();\n            vector<int> ans;\n            if (y + 1 < h && mp[y + 1][x] != -1) {\n                chmax(ans, solve(x, y + 1));\n            }\n            if (x + 1 < w && mp[y][x + 1] != -1) {\n                chmax(ans, solve(x + 1, y));\n            }\n            ans.insert(ans.begin(), mp[y][x]);\n            return memo[y][x] = ans;\n        };\n        vector<int> ans;\n        REP(i, 0, h) {\n            REP(j, 0, w) {\n                if (mp[i][j] != -1) {\n                    auto res = solve(j, i);\n                    while (res.size() > 1 && res[0] == 0) {\n                        res.erase(res.begin());\n                    }\n\n                    chmax(ans, res);\n                }\n            }\n        }\n        REP(i, 0, ans.size()) {\n            cout << ans[i];\n        }\n        cout << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\n#include<cstdio>\n#include<sstream>\n#include<algorithm>\n#include<cmath>\n#include<map>\n#include<functional>\n#include<queue>\n#include<stack>\n#include<set>\nusing namespace std;\n char ta[100][100];\n \n string dp[100][100];\n bool ok(char n){\n \tfor(int i=0;i<10;i++)if(i+'0'==n)return 1;\n \treturn 0;\n }\n \nint main(){\n\tint h,w;\n\twhile(cin>>w>>h,w+h){\n\tfor(int i=0;i<h;i++)cin>>ta[i];\n\tfor(int i=0;i<h;i++)for(int j=0;j<w;j++)if(ok(ta[i][j]))dp[i][j]=ta[i][j]; \n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tif(! ok(ta[i][j]))continue;\n\t\t\tstring tmpa=\"\",tmpb=\"\";\n\t\t\tif(i>=1)tmpa=dp[i-1][j];\n\t\t\tif(j>=1)tmpb=dp[i][j-1];\n\t\t\tif(tmpa.size()>tmpb.size())dp[i][j]=tmpa;\n\t\t\telse if(tmpa.size()<tmpb.size())dp[i][j]=tmpb;\n\t\t\telse dp[i][j]=max(tmpa,tmpb);\n\t\t\tif(dp[i][j]==\"0\")dp[i][j]=\"\";\n\t\t\tdp[i][j].push_back(ta[i][j]);\n\t\t\t//if(i&&j)cout<<i<<\" \"<<j<<\" \"<<dp[i-1][j]<<\" \"<<dp[i][j-1]<<\" \"<<min(dp[i-1][j],dp[i][j-1])<<endl;\n\t\t}\n\t}\n\tstring ans;\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t//(dp[i][j].empty())? cout<<\"N \" : cout<<dp[i][j]<<\" \" ;\n\t\tif(dp[i][j].size()>ans.size())ans=dp[i][j];\n\t\telse ans=max(ans,dp[i][j]);\n\t\t}\n\t}\n\tcout<<ans<<endl;\n\tfor(int i=0;i<100;i++)for(int j=0;j<100;j++)dp[i][j]=\"\",ta[i][j]=' ';\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,n) for (int i=0;i<(n);i++)\n#define rep2(i,a,b) for (int i=(a);i<(b);i++)\n#define rrep(i,n) for (int i=(n)-1;i>=0;i--)\n#define rrep2(i,a,b) for (int i=(b)-1;i>=(a);i--)\n#define all(a) (a).begin(),(a).end()\n\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\ntypedef vector<int> vi;\ntypedef vector<pll> vp;\ntypedef vector<ll> vll;\n\nint W, H;\nstring c[71];\nstring dp[71][71];\n\nbool inside(int x, int y) {\n    return 0 <= x && x < H && 0 <= y && y < W;\n}\n\nstring maxString(string s, string t) {\n    if (s.length() > t.length()) return s;\n    if (s.length() < t.length()) return t;\n    rep(i, s.length()) {\n        if (s[i] > t[i]) return s;\n        if (s[i] < t[i]) return t;\n    }\n    return s;\n}\n\n\nsigned main() {\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(0);\n\n    while (cin >> W >> H && W) {\n        rep(i, H) cin >> c[i];\n\n        rep(i, H + 1) rep(j, W + 1) dp[i][j] = \"\";\n        string ans = \"\";\n        rep2(i, 1, H + 1) {\n            rep2(j, 1, W + 1) {\n                int ci = i - 1, cj = j - 1;\n                if (!isdigit(c[ci][cj])) continue;\n                string maxS = maxString(dp[i - 1][j], dp[i][j - 1]);\n                if (maxS == \"\" && c[ci][cj] == '0') {\n                    dp[i][j] = \"\";\n                } else {\n                    dp[i][j] = maxS + c[ci][cj];\n                    ans = maxString(ans, dp[i][j]);\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <algorithm>\n#include <iomanip>\nusing namespace std;\n\nstring b[70];\nstring memo[70][70];\n\nbool comp(string& s1, string& s2) {\n\tif(s1.size() == s2.size()) return s1 < s2;\n\treturn s1.size() < s2.size();\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tint W, H;\n\twhile(cin >> W >> H, W | H) {\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tcin >> b[i];\n\t\t}\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tfor(int j = 0; j < W; j++) {\n\t\t\t\tmemo[i][j] = \"\";\n\t\t\t\tif('1' <= b[i][j] && b[i][j] <= '9') memo[i][j] += b[i][j];\n\t\t\t}\n\t\t}\n\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tfor(int j = 0; j < W; j++) {\n\t\t\t\tif('0' <= b[i][j] && b[i][j] <= '9') {\n\t\t\t\t\tif(i + 1 < H) {\n\t\t\t\t\t\tif('0' <= b[i + 1][j] && b[i + 1][j] <= '9') {\n\t\t\t\t\t\t\tif(comp(memo[i + 1][j], memo[i][j] + b[i + 1][j]))\n\t\t\t\t\t\t\t\tmemo[i + 1][j] = memo[i][j] + b[i + 1][j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(j + 1 < W) {\n\t\t\t\t\t\tif('0' <= b[i][j + 1] && b[i][j + 1] <= '9') {\n\t\t\t\t\t\t\tif(comp(memo[i][j + 1], memo[i][j] + b[i][j + 1]))\n\t\t\t\t\t\t\t\tmemo[i][j + 1] = memo[i][j] + b[i][j + 1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ans = \"0\";\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tfor(int j = 0; j < W; j++) {\n\t\t\t\tif(comp(ans, memo[i][j])) ans = memo[i][j];\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <bitset>\n#include <complex>\n#include <deque>\n#include <exception>\n#include <fstream>\n#include <functional>\n#include <iomanip>\n#include <ios>\n#include <iosfwd>\n#include <iostream>\n#include <istream>\n#include <iterator>\n#include <limits>\n#include <list>\n#include <locale>\n#include <map>\n#include <memory>\n#include <new>\n#include <numeric>\n#include <ostream>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <stdexcept>\n#include <streambuf>\n#include <string>\n#include <typeinfo>\n#include <utility>\n#include <valarray>\n#include <vector>\n#include <climits>\n\n#define rep(i, m, n) for(int i=int(m);i<int(n);i++)\n//#define EACH(i, c) for (auto &(i): c)\n#define all(c) begin(c),end(c)\n//#define EXIST(s, e) ((s).find(e)!=(s).end())\n//#define SORT(c) sort(begin(c),end(c))\n//#define pb emplace_back\n//#define MP make_pair\n//#define SZ(a) int((a).size())\n\n//#define LOCAL 0\n//#ifdef LOCAL\n//#define DEBUG(s) cout << (s) << endl\n//#define dump(x)  cerr << #x << \" = \" << (x) << endl\n//#define BR cout << endl;\n//#else\n//#define DEBUG(s) do{}while(0)\n//#define dump(x) do{}while(0)\n//#define BR\n//#endif\n\n\n//改造\ntypedef long long int ll;\nusing namespace std;\n#define INF (1 << 30) - 1\n#define INFl (ll)5e15\n#define DEBUG 0 //デバッグする時1にしてね\n#define dump(x)  cerr << #x << \" = \" << (x) << endl\n#define MOD 1000000007\n//ここから編集する\nint W, H;\nvector<vector<char> > vv;\n\nbool isNum(char c) {\n    return c >= '0' && c <= '9';\n}\n\nstring cmp(string right, string left) {\n    if (right.size() > left.size()) {\n        return right;\n    } else if (right.size() < left.size()) {\n        return left;\n    } else {\n        rep(i, 0, right.size()) {\n            if (right[i] != left[i]) {\n                if (right[i] > left[i]) {\n                    return right;\n                } else {\n                    return left;\n                }\n            }\n        }\n    }\n    return right;\n}\n\nstring dfs(int h, int w, int len) {\n    if (h >= H || w >= W) return \"\";\n    if (isNum(vv[h][w])) {\n        if (len == 0 && vv[h][w] == '0') {\n            return \"\";\n        }\n        string right;\n        right += vv[h][w];\n        right += dfs(h, w + 1, len + 1);\n        string left;\n        left += vv[h][w];\n        left += dfs(h + 1, w, len + 1);\n\n        return cmp(right, left);\n    }\n    return \"\";\n}\n\nbool solve() {\n    cin >> W >> H;\n    if (W == 0 && H == 0) return false;\n\n    vv.resize(H, vector<char>(W));\n    rep(i, 0, H) {\n        rep(j, 0, W) {\n            cin >> vv[i][j];\n        }\n    }\n\n    vector<string> kouho;\n    rep(i, 0, H) {\n        rep(j, 0, W) {\n            kouho.push_back(dfs(i, j, 0));\n        }\n    }\n\n    rep(i, 0, kouho.size()) {\n        rep(j, i + 1, kouho.size()) {\n            string big = cmp(kouho[i], kouho[j]);\n            if (big == kouho[j]) {\n                swap(kouho[i], kouho[j]);\n            }\n        }\n    }\n\n    cout << kouho[0] << endl;\n\n    return true;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    while(solve()){\n\n    }\n\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define LOG(...) fprintf(stderr,__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort(ALL(c))\n#define RSORT(c) sort(RALL(c))\n#define SZ(a) ((int)(a).size())\n#define BIT(x, i) (((x) >> (i)) & 1)\n#define SQ(x) ((x)*(x))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\n\nint W, H;\nchar field[70][70];\n\nconst int dx[] = {1,0}, dy[] = {0,1};\n\nstring maxstr(const string& s1, const string& s2) {\n    if (s1.length() == s2.length()) {\n        if (s1 > s2) {\n            return s1;\n        } else {\n            return s2;\n        }\n    } else {\n        if (s1.length() > s2.length()) {\n            return s1;\n        } else {\n            return s2;\n        }\n    }\n}\n\nvoid replace(string& s) {\n    while (s.find(\"0\") == 0) s.replace(0, 1, \"\");\n}\n\nstring maxstr0(string s1, string s2) {\n    replace(s1);\n    replace(s2);\n\n    if (s1.length() == s2.length()) {\n        if (s1 > s2) {\n            return s1;\n        } else {\n            return s2;\n        }\n    } else {\n        if (s1.length() > s2.length()) {\n            return s1;\n        } else {\n            return s2;\n        }\n    }\n}\n\nint main() {\n    while (cin >> W >> H, W|H) {\n        REP(y, H) REP(x, W) {\n            cin >> field[y][x];\n        }\n\n        vector<vector<string>> s(H, vector<string>(W));\n\n        string ma = \"\";\n        for (int y = H-1; y >= 0; y--)\n        for (int x = W-1; x >= 0; x--) {\n            if (isdigit(field[y][x])) {\n                REP(i, 2) {\n                    int sx = x + dx[i], sy = y + dy[i];\n                    if (0 <= sx && sx < W && 0 <= sy && sy < H && isdigit(field[sy][sx])) {\n                        s[y][x] = maxstr(s[y][x], field[y][x] + s[sy][sx]);\n                    }\n                }\n                if (s[y][x].length() == 0) {\n                    s[y][x] = field[y][x];\n                }\n                ma = maxstr0(ma, s[y][x]);\n            }\n        }\n\n        cout << ma << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<algorithm>\n#include<cmath>\n#include<ctime>\n\nusing namespace std;\nusing ll = long long;\n\npair<int, int> t_dir[2] = {{1, 0}, {0, 1}};\nbool is_in_field(int y, int x, int h, int w){\n  return (y >= 0 && y < h && x >= 0 && x < w);\n}\n\nint main(){\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n  int ti = clock();\n  // start-----------------------------------------------\n  int w, h;\n  while(cin >> w >> h && w && h){\n    string ans = \"0\";\n    char s[70][70] = {{}};\n    vector<vector<string>> dp(h, vector<string>(w, \"0\"));\n    for(int i = 0; i < h; i++){\n      for(int j = 0; j < w; j++){\n        cin >> s[i][j];\n        if(s[i][j] > '9') s[i][j] = -1;\n      }\n    }\n    for(int i = h-1; i >= 0; i--){\n      for(int j = w-1; j >= 0; j--){\n        if(s[i][j] == -1) continue;\n        string a{s[i][j]};\n        string t;\n        for(auto p: t_dir){\n          if(is_in_field(i+p.first, j+p.second, h, w)){\n            if(s[i+p.first][j+p.second] != -1){\n              string u = dp[i+p.first][j+p.second];\n              if((t < u && t.length() == u.length()) || t.length() < u.length()) t = u;\n            }\n          }\n        }\n        dp[i][j] = a + t;\n      }\n    }\n    for(int i = 0; i < h; i++){\n      for(int j = 0; j < w; j++){\n        char c = s[i][j];\n        if(c != -1 && c-'0' != 0){\n          string t = dp[i][j];\n          if((ans < t && ans.length() == t.length()) || ans.length() < t.length()) ans = t;\n        }\n      }\n    }\n    cout << ans << endl;\n  }\n  // end-----------------------------------------------\n  // cerr << 1.0 * (clock() - ti) / CLOCKS_PER_SEC << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <map>\n#include <set>\n#include <stack>\n#include <queue>\n#include <algorithm>\n#include <utility>\n#include <functional>\n#include <sstream>\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\nusing namespace std;\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v;}\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout << x; return sout.str();}\ntypedef vector<int> vi;\ntypedef vector<vi>  vvi;\ntypedef vector<string> vs;\ntypedef pair<int, int> pii;\ntypedef long long ll;\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EACH(t,i,c) for(t::iretator i=(c).begin(); i!=(c).end(); ++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define FOR(i,a,b) for(int i=(a);i<=(b);++i)\n#define REP(i,n) FOR(i,0,(n)-1)\nconst double EPS = 1e-12;\nconst double PI = acos(-1.0);\n\nint main() {\n\tint W, H;\n\twhile(cin >> W >> H, W) {\n\t\tvs field(H);\n\t\tREP(i, H) {\n\t\t\tcin >> field[i];\n\t\t}\n\n\t\tvector<vs> dp(H+2, vs(W+2, \"0\"));\n\t\tstring ans = \"0\";\n\t\tFOR(i, 1, H) {\n\t\t\tFOR(j, 1, W) {\n\t\t\t\tchar c = field[i-1][j-1];\n\t\t\t\tif('0' <= c && c <= '9') {\n\t\t\t\t\tstring s1 = dp[i-1][j];\n\t\t\t\t\tstring s2 = dp[i][j-1];\n\t\t\t\t\tstring tmp;\n\t\t\t\t\tif(s1.size() > s2.size()) {\n\t\t\t\t\t\ttmp = s1;\n\t\t\t\t\t} else if(s1.size() < s2.size()) {\n\t\t\t\t\t\ttmp = s2;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttmp = max(s1, s2);\n\t\t\t\t\t}\n\n\t\t\t\t\tif(tmp == \"0\") {\n\t\t\t\t\t\tdp[i][j] = c;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdp[i][j] = tmp + c;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(dp[i][j].length() > ans.length()) {\n\t\t\t\t\t\tans = dp[i][j];\n\t\t\t\t\t} else if(dp[i][j].length() == ans.length()) {\n\t\t\t\t\t\tans = max(ans, dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\nconst int dx[] = {1, 0};\nconst int dy[] = {0, 1};\n\nvector<string> board(70);\nint W, H;\nint len;\nstring ans;\nint cnt;\n\ninline bool isDigit(int x, int y)\n{\n    if ('0' <= board[y][x] && board[y][x] <= '9')\n        return true;\n    else\n        return false;\n}\n\nvoid Rec(int x, int y, string s)\n{\n    if (x < 0 || x >= W || y < 0 || y >= H || !isDigit(x, y)) {\n        if (s.size() > len || (s.size() == len && s > ans)) {\n            ans = s;\n            len = s.size();\n        }\n        return ;\n    }\n    if ((W - x - 1) * (H - y - 1) + s.size() + 3 < len)\n            return ;\n\n    s += board[y][x];\n    for (int d = 0; d < 2; ++d) {\n        int nx = x + dx[d];\n        int ny = y + dy[d];\n\n        Rec(nx, ny, s);\n    }\n}\n\nint main()\n{\n    while (cin >> W >> H, W || H) {\n        len = 0;\n\n        for (int i = 0; i < H; ++i)\n            cin >> board[i];\n\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                if (isDigit(j, i))\n                    Rec(j, i, \"\");\n        int index = 0;\n        while (ans[index] == '0')\n            index++;\n        cout << ans.substr(index) << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cctype>\nusing namespace std;\n\nint W,H;\nstring ans;\nchar matrix[70][70];\nint dx[2]={1,0};\nint dy[2]={0,1};\nbool visited[70][70];\n\nvoid rec(int y,int x,string s){\n  visited[y][x]=1;\n  for(int i=0;i<2;i++){\n    int xx=x+dx[i],yy=y+dy[i];\n    if(xx<0||yy<0)continue;\n    if(!isdigit(matrix[yy][xx]))continue;\n    string t=s;\n    t+=matrix[yy][xx];\n    rec(yy,xx,t);\n  }\n  if(ans.size()<s.size())ans=s;\n  else if(ans.size()==s.size()){\n    if(ans<s)ans=s;\n  }\n  return;\n}\n\nint main()\n{\n  int i,j;\n  while(cin>>W>>H,W|H){\n    for(i=0;i<H;i++){\n      for(j=0;j<W;j++){\n\tcin>>matrix[i][j];\n\tvisited[i][j]=0;\n      }\n    }\n    ans=\"\";\n    for(i=0;i<H;i++){\n      for(j=0;j<W;j++){\n\tif(isdigit(matrix[i][j]) && !visited[i][j] && matrix[i][j]!='0'){\n\t  string t=\"\";\n\t  t+=matrix[i][j];\n\t  rec(i,j,t);\n\t}\n      }\n    }\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n#include <tuple>\n\nusing namespace std;\n\nclass Solver {\n};\nint main() {\n\twhile (true) {\n\t\tint w, h;\n\t\tcin >> w >> h;\n\t\tif (w == 0)break;\n\n\t\tvector<vector<char>>grid(h, vector<char>(w));\n\t\tfor (int i = 0; i < h; i++) {\n\t\t\tstring s;\n\t\t\tcin >> s;\n\t\t\tfor (int j = 0; j < w; j++) {\n\t\t\t\tgrid[i][j] = s[j];\n\t\t\t}\n\t\t}\n\n\t\tvector <vector<vector<string>>>grid_vals(h,\n\t\t\tvector<vector<string>>(w));\n\n\t\tfor (int i = 0; i < h; i++) {\n\t\t\tfor (int j = 0; j < w; j++) {\n\t\t\t\tstring s = \"\";\n\t\t\t\tfor (int k = 0; k < 80; k++) {\n\t\t\t\t\ts += '0';\n\t\t\t\t}\n\t\t\t\tgrid_vals[i][j].emplace_back(s);\n\t\t\t}\n\t\t}\n\n\t\tstring res = \"\";\n\t\tfor (int i = 0; i < h; i++) {\n\t\t\tfor (int j = 0; j < w; j++) {\n\t\t\t\tif (grid[i][j] < '0' || '9' < grid[i][j])continue;\n\n\t\t\t\tsort(grid_vals[i][j].begin(), grid_vals[i][j].end());\n\t\t\t\tstring next\n\t\t\t\t\t= grid_vals[i][j][grid_vals[i][j].size() - 1].substr(1);\n\t\t\t\tnext += grid[i][j];\n\t\t\t\tres = max(res, next);\n\t\t\t\tif (i + 1 < h)grid_vals[i + 1][j].emplace_back(next);\n\t\t\t\tif (j + 1 < w)grid_vals[i][j + 1].emplace_back(next);\n\t\t\t}\n\t\t}\n\n\t\tbool val = false;\n\t\tint cnt = 0;\n\t\tfor (int i = 0; i < res.size(); i++) {\n\t\t\tif ('1' <= res[i] && res[i] <= '9')val = true;\n\t\t\tif (!val)continue;\n\t\t\tcout << res[i];\n\t\t\tcnt++;\n\t\t}\n\t\tif (cnt == 0)cout << 0;\n\t\tcout <<  endl;\n\t}\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cstring>\nusing namespace std;\n\nchar field[70][70];\nbool isSearched[70][70];\nint w, h;\nint dy[] = {-1, 0}, dx[] = {0, -1};\nvector<string> numbers;\nsize_t maxLength;\n\nvoid search(const int y, const int x, string number) {\n    number.insert(0, 1, field[y][x]);\n    isSearched[y][x] = true;\n    bool isEnd = true;\n    for (int i = 0; i < 2; i++) {\n        int ny = y + dy[i], nx = x + dx[i];\n        if (0 <= ny && 0 <= nx && '0' <= field[ny][nx] && field[ny][nx] <= '9') {\n            isEnd = false;\n            search(ny, nx, number);\n        }\n    }\n    if (isEnd) {\n        while (number.empty() == false && number[0] == '0') {\n            number.erase(0, 1);\n        }\n        if (maxLength <= number.length()) {\n            numbers.push_back(number);\n            maxLength = number.length();\n        }\n    }\n}\n\nint main() {\n    while (true) {\n        cin >> w >> h;\n        if ((w | h) == 0) {\n            break;\n        }\n        memset(field, 0, sizeof(field));\n        for (int y = 0; y < h; y++) {\n            cin >> field[y];\n        }\n        numbers.clear();\n        maxLength = 0;\n        memset(isSearched, 0, sizeof(isSearched));\n        for (int y = h - 1; y >= 0; y--) {\n            for (int x = w - 1; x >= 0; x--) {\n                if (isSearched[y][x] == false && '0' <= field[y][x] && field[y][x] <= '9') {\n                    string number = \"\";\n                    search(y, x, number);\n                }\n            }\n        }\n        string maxStr = \"0\";\n        for (vector<string>::iterator it = numbers.begin(); it != numbers.end(); it++) {\n            if ((*it).length() < maxLength) {\n                continue;\n            }\n            if (maxStr < *it) {\n                maxStr = *it;\n            }\n        }\n        cout << maxStr << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<queue>\n#include<algorithm>\n#include<iostream>\n#include<string>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\nusing namespace std;\nint main(){\n  int i,j;\n  int w,h;\n  while(cin>>w>>h&&w+h){\n    char a[100][100];\n    for(i=0;i<100;i++)\n      for(j=0;j<100;j++)\n\ta[j][i]='a';\n    for(i=0;i<h;i++)\n      for(j=0;j<w;j++)\n\tcin>>a[j][i];\n    string b[100][100];\n    for(i=0;i<h;i++)\n      for(j=0;j<w;j++)\n\tb[j][i]=\"\";\n    queue<pair<pair<int,int>,string> > c;\n    for(i=0;i<h;i++)\n      for(j=0;j<w;j++)\n\tc.push(make_pair(make_pair(j,i),\"\"));\n    string mx=\"\";\n    while(c.empty()==0){\n      int x,y;\n      string s;\n      x=c.front().first.first;\n      y=c.front().first.second;\n      s=c.front().second;\n      c.pop();\n      if(a[x][y]>='0'&&a[x][y]<='9'){\n\tif(s!=\"\"||a[x][y]!='0')\n\t  s+=a[x][y];\n\tint mxln=mx.length();\n\tint sln=s.length();\n\tif(mxln<sln){\n\t  mx=s;\n\t}else if(mxln==sln){\n\t  for(i=0;i<sln;i++){\n\t    if(0){\n\t    }else if(mx[i]<s[i]){\n\t      break;\n\t    }else if(mx[i]>s[i]){\n\t      i=sln-1;\n\t    }\n\t  }\n\t  if(i!=sln)\n\t    mx=s;\n\t}\t\n\tint bln=b[x][y].length();\n\tif(bln<sln){\n\t  b[x][y]=s;\n\t  c.push(make_pair(make_pair(x+1,y),s));\n\t  c.push(make_pair(make_pair(x,y+1),s));\n\n\t}else if(bln==sln){\n\t  for(i=0;i<sln;i++){\n\t    if(0){\n\t    }else if(b[x][y][i]<s[i]){\n\t      break;\n\t    }else if(b[x][y][i]>s[i]){\n\t      i=sln-1;\n\t    }\n\t  }\n\t  if(i!=sln){\n\t    b[x][y]=s;\n\t    c.push(make_pair(make_pair(x+1,y),s));\n\t    c.push(make_pair(make_pair(x,y+1),s));\n\n\t  }\n\t}\n      }\n    }\n    cout<<mx<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n\nusing namespace std;\n\nconst int dx[] = {1, 0};\nconst int dy[] = {0, 1};\n\nvector<string> board;\nint W, H;\nint len;\nstring ans;\n\ninline bool isDigit(int x, int y)\n{\n    if ('0' <= board[y][x] && board[y][x] <= '9')\n        return true;\n    else\n        return false;\n}\n\nvoid Rec(int x, int y, string s)\n{\n\n    if (x < 0 || x >= W || y < 0 || y >= H || !isDigit(x, y)) {\n        if (s.size() > len || (s.size() == len && s > ans)) {\n            ans = s;\n            len = s.size();\n        }\n        return ;\n    }\n\n    s += board[y][x];\n    for (int d = 0; d < 2; ++d) {\n        int nx = x + dx[d];\n        int ny = y + dy[d];\n\n        Rec(nx, ny, s);\n    }\n}\n\nint main()\n{\n    while (cin >> W >> H, W || H) {\n        len = 0;\n\n        board.clear();\n        board.assign(H, \"\");\n        for (int i = 0; i < H; ++i)\n            cin >> board[i];\n\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                if (isDigit(j, i))\n                    Rec(j, i, \"\");\n        int index = 0;\n        while (ans[index] == '0')\n            index++;\n        cout << ans.substr(index) << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\nconst int MAX = 71;\n \nchar judge(char c){\n    if('0' <= c && c <= '9') return c;\n    return '#';\n}\n \nstring strMax(string x,string y){\n    string tx = \"\",ty = \"\";\n    bool flg = false;\n     \n    if(x == \"#\" && y == \"#\") return \"#\";\n    if(x == \"#\") return y;\n    if(y == \"#\") return x;\n     \n    for(int i = 0 ; i < x.size() ; i++){\n        if(x[i] == '0' && !flg){\n            continue;\n        }\n        else{\n            flg = true;\n            tx += x[i];\n        }\n    }\n    x = tx;\n    flg = false;\n    for(int i = 0 ; i < y.size() ; i++){\n        if(y[i] == '0' && !flg){\n            continue;\n        }\n        else{\n            flg = true;\n            ty += y[i];\n        }\n    }\n    y = ty;\n     \n    if(x.size() > y.size()) return x;\n    else if(x.size() < y.size()) return y;\n     \n    for(int i = 0 ; i < x.size() ; i++){\n        if(x[i] > y[i]) return x;\n        else if(x[i] < y[i]) return y;\n    }\n    return x;\n}\n \nint main(){\n    int H,W;\n    string str[MAX];\n     \n    while(cin >> H >> W , H + W){\n        string dp[MAX][MAX];\n        for(int i = 0 ; i < W ; i++){\n            cin >> str[i];\n        }\n        dp[0][0] = judge(str[0][0]);\n         \n        for(int i = 1 ; i < W ; i++){\n            if(judge(str[i][0]) == '#'){\n                dp[i][0] = \"#\";\n            }\n            else if(dp[i-1][0] != \"#\"){\n                dp[i][0] = dp[i-1][0];\n                dp[i][0] += judge(str[i][0]);\n            }\n            else{\n                dp[i][0] += judge(str[i][0]);\n            }\n        }\n         \n        for(int j = 1 ; j < H ; j++){\n            if(judge(str[0][j]) == '#'){\n                dp[0][j] = \"#\";\n            }\n            else if(dp[0][j-1] != \"#\"){\n                dp[0][j] = dp[0][j-1];\n                dp[0][j] += judge(str[0][j]);\n            }\n            else{\n                dp[0][j] += judge(str[0][j]);\n            }\n        }\n         \n        string ans = \"0\";\n        for(int i = 1 ; i < W ; i++){\n            for(int j = 1 ; j < H ; j++){\n                if(judge(str[i][j]) == '#') dp[i][j] = '#';\n                else{\n                    dp[i][j] = strMax(dp[i-1][j],dp[i][j-1]);\n                    if(dp[i][j] != \"#\"){\n                        dp[i][j] += judge(str[i][j]);\n                    }\n                    else{\n                        dp[i][j] = \"\";\n                        dp[i][j] += judge(str[i][j]);\n                    }\n                }\n            }\n        }\n        for(int i = 0 ; i < W ; i++){\n            for(int j = 0 ; j < H ; j++){\n                ans = strMax(ans,dp[i][j]);\n\t    }\n\t}\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n\n// type {{{\nusing ll = long long;\nusing ull = unsigned long long;\nusing ld = long double;\nusing P = pair<int,int>;\nusing vi = vector<int>;\nusing vll = vector<ll>;\nusing vvi = vector<vector<int>>;\nusing vvll = vector<vector<ll>>;\n// }}}\n\n\n// macro {{{\n#define rep(i,n) for (ll i=0, i##_len=(n); i<i##_len; ++i)\n#define reps(i,n) for (ll i=1, i##_len=(n); i<=i##_len; ++i)\n#define FOR(i,a,n) for (ll i=(a), i##_len=(n); i<i##_len; ++i)\n#define SZ(x) ((ll)(x).size())\n#define all(x) begin(x),end(x)\n// }}}\n\n\n// debug {{{\n#define dump(x) cerr<<#x<<\" = \"<<(x)<<endl\n#define debug(x) cerr<<#x<<\" = \"<<(x)<<\" (L\"<<__LINE__<<\")\"<< endl;\n\ntemplate<typename T>\nostream& operator<<(ostream& os, const vector<T>& v) {\n    os << \"[\";\n    rep (i, SZ(v)) {\n        if (i) os << \", \";\n        os << v[i];\n    }\n    return os << \"]\";\n}\n\ntemplate<typename T, typename U>\nostream& operator<<(ostream& os, const pair<T, U>& p) {\n    return os << \"(\" << p.first << \" \" << p.second << \")\";\n}\n// }}}\n\n\n// chmax, chmin {{{\ntemplate<typename T>\nbool chmax(T& a, const T& b) {\n    if (a < b) { a = b; return true; }\n    return false;\n}\ntemplate<typename T>\nbool chmin(T& a, const T& b) {\n    if (b < a) { a = b; return true; }\n    return false;\n}\n// }}}\n\n\n\n// constants {{{\n#define inf(T) numeric_limits<T>::max()\nconst ll MOD = 1e9+7;\nconst ld EPS = 1e-9;\n// }}}\n\n\n\ntemplate<typename T, typename Compare>\nbool chmax(T& a, const T& b, Compare comp) {\n    if (comp(a, b)) { a = b; return true; }\n    return false;\n}\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(10);\n\n    auto comp = [](string s, string t) {\n        if (s.size() == t.size()) return s < t;\n        return s.size() < t.size();\n    };\n\n    for (;;) {\n        int W, H;\n        cin >> W >> H;\n        if (W == 0) break;\n        vector<string> C(H);\n        rep(i, H) {\n            cin >> C[i];\n        }\n\n        using vs = vector<string>;\n        using vvs = vector<vs>;\n        vvs dp(H+1, vs(W+1));\n        rep(i, H) {\n            rep(j, W) {\n                if (C[i][j] < '0' or '9' < C[i][j]) continue;\n                chmax(dp[i+1][j+1], max({\n                            dp[i][j+1] + C[i][j],\n                            dp[i+1][j] + C[i][j]}, comp), comp);\n                if (dp[i+1][j+1][0] == '0') {\n                    dp[i+1][j+1] = \"\";\n                }\n            }\n        }\n\n        string ans;\n        rep(i, H) rep(j, W) chmax(ans, dp[i+1][j+1], comp);\n\n        cout << ans << endl;\n    }\n\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 100000000\n\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair <int,int> P;\n\n\nstatic const double EPS = 1e-8;\n\nint tx[] = {-1,0,1,0};\nint ty[] = {0,1,0,-1};\n\nchar stage[101][101];\nint W,H;\n\nstring larger(const string& str1,const string& str2){\n\tif(str1.size() > str2.size()) return str1;\n\tif(str1.size() < str2.size()) return str2;\n\n\tfor(int i=0;i<str1.size();i++){\n\t\tif(str1[i] > str2[i] ) return str1;\n\t\tif(str1[i] < str2[i] ) return str2;\n\t}\n\n\treturn str1;\n}\n\nvoid dfs(int x,int y,string buf,string& res){\n\tbuf.push_back(stage[y][x]);\n\n\tif(y+1 < H && isdigit(stage[y+1][x])){\n\t\tdfs(x,y+1,buf,res);\t\t\n\t}\n\n\tif(x+1 < W && isdigit(stage[y][x+1])){\n\t\tdfs(x+1,y,buf,res);\n\t}\n\n\tres = larger(res,buf);\n}\n\nint main()\n{\n\twhile(~scanf(\"%d %d\",&W,&H)){\n\t\tif(W==H && H==0) break;\n\t\tfor(int y=0;y<H;y++){\n\t\t\tchar buf[128];\n\t\t\tscanf(\"%s\",buf);\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tstage[y][x] = buf[x];\n\t\t\t}\n\t\t}\n\n\t\tstring dp[101][101];\n\t\tfor(int x=0;x<W;x++) \n\t\t\tif(isdigit(stage[0][x]) && stage[0][x] != '0'){\n\t\t\tdp[0][x+1] = dp[0][x] + stage[0][x];\n\t\t\t//printf(\"dp[%d][%d]=%s\\n\",0,x+1,dp[0][x+1].c_str());\n\t\t}\n\n\t\tfor(int y=0;y<H;y++){\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tstring left=\"\";\n\t\t\t\tif(isdigit(stage[y+1][x])){\n\t\t\t\t\tif(!(dp[y+1][x].size() == 0 && stage[y+1][x]=='0')){\n\t\t\t\t\t\tleft = dp[y+1][x] + stage[y+1][x];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstring up=\"\";\n\t\t\t\tif(isdigit(stage[y][x+1])){\n\t\t\t\t\tif(!(dp[y][x+1].size() == 0 && stage[y][x+1]=='0')){\n\t\t\t\t\t\tup = dp[y][x+1] + stage[y][x+1];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tdp[y+1][x+1] = larger(left,up);\n\t\t\t}\n\t\t}\n\n\t\tstring res=\"\";\n\t\tfor(int y=0;y<=H;y++){\n\t\t\tfor(int x=0;x<=W;x++){\t\n\t\t\t\tres = larger(res,dp[y][x]);\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nint main() {\n\tint w, h;\n\twhile (cin >> w >> h, w){\n\t\tvector<string> vs(h);\n\t\tvector<vector<bool>> vvb(h);\n\t\tREP(i, h){\n\t\t\tcin >> vs[i];\n\t\t\tREP(j, w){\n\t\t\t\tvvb[i].push_back('0' <= vs[i][j] && vs[i][j] <= '9');\n\t\t\t}\n\t\t}\n\n\t\tvector<vector<int>> vvi(h);\n\t\tint max2 = 0;\n\t\tint x, y;\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tif (vvb[i][j]){\n\t\t\t\t\tint max = 1;\n\t\t\t\t\tif (i > 0 && vvb[i - 1][j])max = vvi[i - 1][j] + 1;\n\t\t\t\t\tif (j > 0 && vvb[i][j - 1])if (max < vvi[i][j - 1] + 1)max = vvi[i][j - 1] + 1;\n\t\t\t\t\tvvi[i].push_back(max);\n\t\t\t\t\tif (max > max2){\n\t\t\t\t\t\tmax2 = max;\n\t\t\t\t\t\t x = j;\n\t\t\t\t\t\t y = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tvvi[i].push_back(-1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvector<vector<int>> vvi2(h);\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tvvi2[i].push_back(-1);\n\t\t\t}\n\t\t}\n\t\tvvi2[y][x] = max2;\n\t\tqueue<int> qi;\n\t\tqi.push(max2 * 10000 + x * 100 + y);\n\t\twhile (!qi.empty()){\n\t\t\tint pos = qi.front(); qi.pop();\n\t\t\tint max3 = pos / 10000;\n\t\t\tint x2 = (pos / 100) % 100;\n\t\t\tint y2 = pos % 100;\n\t\t\tif (x2 > 0 && vvb[y2][x2 - 1] && vvi2[y2][x2 - 1]==-1){\n\t\t\t\tvvi2[y2][x2 - 1] = max3 - 1;\n\t\t\t\tqi.push((max3-1) * 10000 + (x2-1) * 100 + y2);\n\t\t\t}\n\t\t\tif (y2 > 0 && vvb[y2 - 1][x2] && vvi2[y2-1][x2] == -1){\n\t\t\t\tvvi2[y2 - 1][x2] = max3 - 1;\n\t\t\t\tqi.push((max3 - 1) * 10000 + x2 * 100 + (y2-1));\n\t\t\t}\n\t\t}\n\t\tchar max4 = '0' - 1;\n\t\tint x3, y3;\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tif (vvi2[i][j] == 1 && max4 < vs[i][j]){\n\t\t\t\t\tmax4 = vs[i][j];\n\t\t\t\t\tx3 = j;\n\t\t\t\t\ty3 = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ans;\n\t\tif(max4!='0')ans += max4;\n\t\tREP(i,max2-1){\n\t\t\tbool abb = false;\n\t\t\tmax4 = '0' - 1;\n\t\t\tif (y3 + 1 != h&&vvi2[y3+1][x3]>0 && max4 < vs[y3 + 1][x3]){\n\t\t\t\tmax4 = vs[y3 + 1][x3];\n\t\t\t\ty3 ++;\n\t\t\t\tabb = true;\n\t\t\t}\n\t\t\tif (abb){\n\t\t\t\tif (x3 + 1 != w&&vvi2[y3-1][x3 + 1]>0 && max4 < vs[y3-1][x3 + 1]){\n\t\t\t\t\tmax4 = vs[y3-1][x3 + 1];\n\t\t\t\t\tx3++;\n\t\t\t\t\ty3--;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif (x3 + 1 != w&&vvi2[y3][x3 + 1]>0 && max4 < vs[y3][x3 + 1]){\n\t\t\t\t\tmax4 = vs[y3][x3 + 1];\n\t\t\t\t\tx3++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!(ans.empty() && max4 == '0'))ans += max4;\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <vector>\n#include <string>\n#include <queue>\n#include <deque>\n#include <list>\n#include <stack>\n#include <set>\n#include <map>\n#include <algorithm>\n\n#define int long long\n#define MOD7 1000000007\n#define MOD9 1000000009\n\n#define rep(i, n) for (int i = 0; i < (n); i++)\n#define REP(i, a, n) for (int i = (a); i <= (n); i++)\n#define all(a) (a).begin(), (a).end()\n\nusing namespace std;\n\nint dx[4] = { 1, 0, -1, 0 };\nint dy[4] = { 0, -1, 0, 1 };\n\nint nextInt() {int a; cin >> a; return a;}\nchar nextChar() {char a; cin >> a; return a;}\ndouble nextDouble() {double a; cin >> a; return a;}\nstring nextString() {string a; cin >> a; return a;}\n\nvoid inputVector(vector<int> &v, int &n) {rep(i,n){v.push_back(nextInt());}}\nvoid inputVector(vector<double> &v, int &n) {rep(i,n){v.push_back(nextDouble());}}\nvoid inputVector(vector<string> &v, int &n) {rep(i,n){v.push_back(nextString());}}\n\nsigned main() {\n    int W, H;\n    while (cin >> W >> H) {\n\tif (W == 0) break;\n\n\tvector<string> board;\n\tinputVector(board, H);\n\n\tstring ret = \"\";\n\tstring dp[70][70];\n\trep(y, H) rep(x, W) dp[y][x] = \"\";\n\tfor (int y = H - 1; y >= 0; y--) {\n\t    for (int x = W - 1; x >= 0; x--) {\n\t\tif (board[y][x] < '0' || board[y][x] > '9') dp[y][x] = \"\";\n\t\telse {\n\t\t    string prev = \"\";\n\t\t    if (y < H - 1) prev = dp[y + 1][x];\n\t\t    if (x < W - 1 && (dp[y][x + 1].size() > prev.size()\n\t\t\t\t|| (dp[y][x + 1].size() == prev.size() && dp[y][x + 1] > prev))) prev = dp[y][x + 1];\n\t\t    dp[y][x] = board[y][x] + prev;\n\t\t    if (ret.size() > 0 && board[y][x] == '0') continue;\n\t\t    if (ret.size() > dp[y][x].size()) continue;\n\t\t    if (ret.size() == dp[y][x].size() && ret > dp[y][x]) continue;\n\t\t    ret = dp[y][x];\n\t\t}\n\t    }\n\t}\n\tcout << ret << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n\nusing namespace std;\n\ntypedef vector<int> vi;\ntypedef pair<int,int> pii;\ntypedef long long ll;\n\n#define rep(i,n) for(ll i=0;i<(ll)(n);i++)\n#define all(a)  (a).begin(),(a).end()\n#define pb push_back\n#ifdef Debug\n#define dump(x)  cerr << #x << \" = \" << (x) << endl\n#else\n#define dump(x)\n#endif\n\n\n//a>b return true\nbool diffStr(string a,string b){\n\tif(a.size()>b.size())return true;\n\tif(b.size()>a.size())return false;\n\n\treturn (a>b);\n}\n\n\nint main(){\n\tint w,h;\n\twhile(cin>>w>>h){\n\t\tif(w==0 && h==0)break;\n\n\t\tchar data[100][100];\n\t\trep(i,h){\n\t\t\trep(j,w){\n\t\t\t\tcin>>data[i][j];\n\t\t\t}\n\t\t}\n\n\t\tstring dp[100][100];\n\t\tfor(int i=h-1;i>=0;i--){\n\t\t\tfor(int j=w-1;j>=0;j--){\n\t\t\t\tif( isalpha(data[i][j]) )dp[i][j]=\"\";\n\t\t\t\telse{\n\t\t\t\t\tstring r=\"\",u=\"\";\n\n\t\t\t\t\tif( i+1<h && j+1<w ){\n\t\t\t\t\t\tr=string(1,data[i][j])+dp[i+1][j];\n\t\t\t\t\t\tu=string(1,data[i][j])+dp[i][j+1];\n\n\t\t\t\t\t\tif( diffStr(r,u) )\tdp[i][j]=r;\n\t\t\t\t\t\telse\t\tdp[i][j]=u;\n\n\t\t\t\t\t}else if( i+1<h ){\n\t\t\t\t\t\tr=string(1,data[i][j])+dp[i+1][j];\n\t\t\t\t\t\tdp[i][j]=r;\n\n\t\t\t\t\t}else if( j+1<w ){\n\t\t\t\t\t\tu=string(1,data[i][j])+dp[i][j+1];\n\t\t\t\t\t\tdp[i][j]=u;\n\n\t\t\t\t\t}else{\n\t\t\t\t\t\tdp[i][j]=data[i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring ans=\"0\";\n\t\trep(i,h){\n\t\t\trep(j,w){\n\t\t\t\tif(dp[i][j][0]=='0'){\n\t\t\t\t\tint c=0;\n\t\t\t\t\trep(k,dp[i][j].size()){\n\t\t\t\t\t\tif( dp[i][j][k]=='0' ){\n\t\t\t\t\t\t\tc++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdp[i][j]=dp[i][j].substr(c,dp[i][j].size()-c);\n\t\t\t\t}\n\t\t\t\tif( diffStr(dp[i][j],ans) )ans=dp[i][j];\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n#define rep(i,n) for(int i = 0; i < n ;++i)\n#define all(v) v.begin(),v.end()\n\nstring s[100];\nint w,h;\nint dx[2]={0,1};\nint dy[2]={1,0};\nbool used[100][100];\nstring ans[100][100];\n\nbool check(string s,string t){\n  if(s.size()!=t.size())return s.size()>t.size();\n  return s>t;\n}\n\nint main(){\n    while(cin>>w>>h&&w+h){\n      //vs.clear();\n      rep(i,100)rep(j,100)ans[i][j].clear();\n        rep(i,h)cin>>s[i];\n        rep(i,h)rep(j,w){\n          string t=\"\";\n          t+=s[i][j];\n          //if(i==0&&j==0){\n            if(s[i][j]>='1'&&s[i][j]<='9')ans[i][j]=t;\n          //}\n        }\n        // rep(i,h){\n        //   rep(j,w){\n        //     cout<<ans[i][j]<<\" \";\n        //   }\n        //   cout<<endl;\n        // }\n        //rep(i,h)rep(j,w)used[i][j]=0;\n        string ret=\"\";\n        rep(i,h){\n          rep(j,w){\n            if(ans[i][j].empty())continue;\n            if(i+1<h&&s[i+1][j]>='0'&&s[i+1][j]<='9'){\n              ans[i+1][j]=ans[i][j]+s[i+1][j];\n            }\n            if(j+1<w&&s[i][j+1]>='0'&&s[i][j+1]<='9'){\n              if(check(ans[i][j]+s[i][j+1],ans[i][j+1])){\n                ans[i][j+1]=ans[i][j]+s[i][j+1];\n              }\n            }\n          }\n        }\n        rep(i,h){\n          rep(j,w){\n          if(ans[i][j].size()>ret.size()){\n              ret=ans[i][j];\n          }\n          else if(ans[i][j].size()==ret.size()){\n            if(ret<ans[i][j])ret=ans[i][j];\n          }\n          // cout<<ans[i][j]<<\" \";\n          }\n          // cout<<endl;\n        }\n        // sort(all(vs),F);\n        // reverse(all(vs));\n        // cout<<vs[0]<<endl;\n        cout<<ret<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nint w,h;\nstring ma;\nstring field[70];\n\nbool isdigit(char c){\n\tif(c >= '0' && c <= '9') return true;\n\telse return false;\n}\n\nvoid dfs(int x,int y,string s){\n\t//cout << x << \" \" << y << \" \" << s;\n\tif(!isdigit(field[x][y]) || (x == h - 1 && y == w - 1)){\n\t\tif(x == h - 1 && y == w - 1) s += field[x][y];\n\t\tif(ma.length() < s.length() || (ma.length() == s.length() && ma < s)) ma = s;\n\t\treturn;\n\t}\n\tif(x + 1 < h) dfs(x + 1,y,s + to_string(field[x][y] - '0'));\n\tif(y + 1 < w) dfs(x,y + 1,s + to_string(field[x][y] - '0'));\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(!w) break;\n\t\tma = \"\";\n\t\tfor(int i = 0;i < h;i++) cin >> field[i];\n\t\tfor(int i = 0;i < h;i++){\n\t\t\tfor(int j = 0;j < w;j++){\n\t\t\t\tif((i >= 1 && isdigit(field[i - 1][j])) || (j >= 1 && isdigit(field[i][j - 1]))) continue;\n\t\t\t\tif(isdigit(field[i][j])) dfs(i,j,\"\");\n\t\t\t}\n\t\t}\n\t\tbool flag = true;\n\t\tfor(int i = 0;i < ma.length();i++){\n\t\t\tif(ma[i] == '0' && flag) continue;\n\t\t\telse {\n\t\t\t\tflag = false;\n\t\t\t\tcout << ma[i];\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t\t\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\nbool great(string x, string y) {\n\twhile (x.length() && x[0] == '0') {\n\t\tx.erase(x.begin());\n\t}\n\twhile (y.length() && y[0] == '0') {\n\t\ty.erase(y.begin());\n\t}\n\tif (x == y)return true;\n\tint len1 = x.length();\n\tint len2 = y.length();\n\tif (len1 > len2)return true;\n\telse if (len1 < len2)return false;\n\telse {\n\t\tint now = 0;\n\t\twhile (now<len1) {\n\t\t\tif (x[now] - '0' > y[now] - '0')return true;\n\t\t\telse if (x[now] - '0' < y[now] - '0')return false;\n\t\t\tnow++;\n\t\t}\n\t}\n\treturn true;\n}\nbool alf(string x) {\n\tif (x.length()&&'A' <= x[0] && x[0] <= 'Z')return true;\n\treturn false;\n}\nstring large(string s, string t) {\n\tif (alf(s) && alf(t))return \"\";\n\telse if (alf(s))return t;\n\telse if (alf(t))return s;\n\telse {\n\t\tif (great(s, t))return s;\n\t\telse return t;\n\t}\n}\nint main() {\n\tint w, h;\n\twhile (cin >> w >> h, w) {\n\t\tstring s;\n\t\tstring t[71][71];\n\t\trep(i, 71) {\n\t\t\trep(j, 71) {\n\t\t\t\tt[i][j] = \"A\";\n\t\t\t}\n\t\t}\n\t\trep(i, h) {\n\t\t\tcin >> s;\n\t\t\trep(j, w) {\n\t\t\t\tt[i][j] = s[j];\n\t\t\t}\n\t\t}\n\t\tfor (int i = h - 1; i >= 0; i--) {\n\t\t\tfor (int j = w - 1; j >= 0; j--) {\n\t\t\t\tif (!alf(t[i][j])) {\n\t\t\t\t\tt[i][j] += large(t[i + 1][j], t[i][j + 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring ma = \"0\";\n\t\trep(i, h) {\n\t\t\trep(j, w) {\n\t\t\t\tif (!alf(t[i][j])) {\n\t\t\t\t\tma = large(ma, t[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\twhile (ma.length()&&ma[0] == '0')ma.erase(ma.begin());\n\t\tcout << ma << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)   FOR(i,0,n)\n#define pb emplace_back\ntypedef long long ll;\ntypedef pair<int,int> pint;\n\nstring s[71];\nbool used[71][71];\nconst int dx[]={0,1},dy[]={1,0};\nstring ans;\nint w,h;\nvoid dfs(int x,int y,string c){\n    if(c.size()>ans.size()) ans=c;\n    else if(c.size()==ans.size()){\n        rep(i,c.size()){\n            if(c[i]>ans[i]){\n                ans=c;break;\n            }\n            else if((c[i]<ans[i])) break;\n        }\n    }\n    rep(i,2){\n        int tx=x+dx[i],ty=y+dy[i];\n        if(tx>=0&&ty>=0&&tx<w&&ty<h&&isdigit(s[ty][tx])){\n            if(c==\"\"&&s[ty][tx]==0) dfs(tx,ty,c);\n            else dfs(tx,ty,c+s[ty][tx]);\n        }\n    }\n}\nint main(){\n    while(cin>>w>>h,w){\n        rep(i,h) cin>>s[i];\n        ans=\"\";\n        string t;\n        rep(i,h)rep(j,w)if(isdigit(s[i][j])){\n            if(s[i][j]=='0') dfs(j,i,t);\n            else dfs(j,i,t+s[i][j]);\n        }\n        cout<<ans<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#define rep(i, n) for(i = 0; i < n; i++)\nusing namespace std;\n\nint w, h;\nstring s[70];\nstring dp[70][70];\n\nbool check(int i, int j, string &prev) {\n\tif (i >= h || j >= w) return false;\n\tif (prev.length() > 0) {\n\t\treturn '0' <= s[i][j] && s[i][j] <= '9';\n\t}\n\treturn '1' <= s[i][j] && s[i][j] <= '9';\n}\n\nstring Max(string &a, string &b) {\n\tif (a.length() > b.length()) return a;\n\tif (b.length() > a.length()) return b;\n\treturn max(a, b);\n}\n\nint main() {\n\tint i, j;\n\t\n\twhile (cin >> w >> h) {\n\t\tif (!w) break;\n\t\trep(i, h) cin >> s[i];\n\t\trep(i, h) {\n\t\t\trep(j, w) {\n\t\t\t\tif ('1' <= s[i][j] && s[i][j] <= '9') dp[i][j] = s[i][j];\n\t\t\t\telse dp[i][j] = \"\";\n\t\t\t}\n\t\t}\n\t\t\n\t\trep(i, h) {\n\t\t\trep(j, w) {\n\t\t\t\tif (check(i + 1, j, dp[i][j])) dp[i + 1][j] = Max(dp[i + 1][j], dp[i][j] + s[i + 1][j]);\n\t\t\t\tif (check(i, j + 1, dp[i][j])) dp[i][j + 1] = Max(dp[i][j + 1], dp[i][j] + s[i][j + 1]);\n\t\t\t}\n\t\t}\n\t\t\n\t\tstring ans = \"\";\n\t\trep(i, h) {\n\t\t\trep(j, w) {\n\t\t\t\tans = Max(ans, dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdlib>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nchar data[2000];\nbool visited[2000];\nint W, H;\nstring maxi;\n\nbool isNum(char c) {\n  return c >= '0' && c <= '9';\n}\n\nstring cat0(string s) {\n  while(s.length() > 1 && s[0] == '0') {\n    s = s.substr(1, s.length()-1);\n  }\n  return s;\n}\n\nvoid rec(int x, int y, string str) {\n  const int dx[2] = {1, 0};\n  const int dy[2] = {0, 1};\n  bool flag = false;\n  visited[y*W+x] = true;\n  str += data[y*W+x];\n  for(int i = 0; i < 2; i++) {\n    int nx = x + dx[i];\n    int ny = y + dy[i];\n    if(nx >= W || ny >= H) continue;\n    if(isNum(data[ny*W+nx])) {\n      flag = true;\n      rec(nx, ny, str);\n    }\n  }\n  if(!flag) {\n    str = cat0(str);\n    if(maxi.length() < str.length()) {\n      maxi = str;\n    } else if(maxi.length() == str.length()){\n      maxi = max(maxi, str);\n    }\n  }\n}\n\nmain() {\n  while(1) {\n    cin >> W >> H;\n    if(W == 0 && H == 0) break;\n    for(int i = 0; i < H; i++) {\n      for(int j = 0; j < W; j++) {\n\tcin >> data[i*W+j];\n      }\n    }\n    maxi = \"0\";\n    fill_n(visited, W*H, false);\n    for(int j = 0; j < W; j++) {\n      for(int i = 0; i < H; i++) {\n\tif(!visited[i*W+j] && isNum(data[i*W+j])) {\n\t  rec(j, i, \"\");\n\t}\n      }\n    }\n    \n    cout << maxi << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nusing namespace std;\n \n//conversion\n//------------------------------------------\ninline int toInt(string s) {int v; istringstream sin(s);sin>>v;return v;}\ntemplate<class T> inline string toString(T x) {ostringstream sout;sout<<x;return sout.str();}\n \n//math\n//-------------------------------------------\ntemplate<class T> inline T sqr(T x) {return x*x;}\n \n//typedef\n//------------------------------------------\ntypedef pair<int, int> PII;\ntypedef pair<long, long> PLL;\ntypedef long long LL;\n//container util\n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define SORT(c) sort((c).begin(),(c).end())\n \n//repetition\n//------------------------------------------\n#define FOR(i,a,b) for(LL i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n \n//constant\n//--------------------------------------------\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\nconst int INF=INT_MAX;\n//clear memory\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\nint rd(int num){\n\treturn min(255,max(0,num));\n}\n\nbool ch(char c){\n\treturn (c>='0'&&c<='9');\n}\nint dp[20002][256];\nint main(){\n\tint W,H;\n\twhile(cin>>W>>H){\n\t\tif(W==0)return 0;\n\t\tchar C[75][75];\n\t\tREP(i,75)REP(j,75)C[i][j]='#';\n\t\tREP(i,H)REP(j,W)cin>>C[i+1][j+1];\n\t\tstring dp[75][75];\n\t\tREP(i,75)REP(j,75)dp[i][j]=\"\";\n\t\tstring res=\"\";\n\t\tFOR(h,1,H+1)FOR(w,1,W+1){\n\t\t\tstring tmp=\"\";\n\t\t\tif(!ch(C[h][w]))continue;\n\t\t\t\n\t\t\ttmp=dp[h-1][w-1];\n\t\t\tif(SZ(tmp)<SZ(dp[h][w-1])||(SZ(tmp)==SZ(dp[h][w-1])&&tmp<dp[h][w-1])){\n\t\t\t\ttmp=dp[h][w-1];\n\t\t\t}\n\t\t\tif(SZ(tmp)<SZ(dp[h-1][w])||(SZ(tmp)==SZ(dp[h-1][w])&&tmp<dp[h-1][w])){\n\t\t\t\ttmp=dp[h-1][w];\n\t\t\t}\n\t\t\tif(tmp!=\"0\")dp[h][w]=tmp+C[h][w];\n\t\t\telse dp[h][w]=C[h][w];\n\t\t\tif(SZ(res)<SZ(dp[h][w])||(SZ(res)==SZ(dp[h][w])&&res<dp[h][w])){\n\t\t\t\tres=dp[h][w];\n\t\t\t}\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\treturn 0;\n}\n/*\n1 -100 4\n-1,1,2\n*/"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\nusing namespace std;\n\nstring solve(vector<string> &C, int W, int H, int i, int j, string ret){\n  string s[2];\n  ret += C[i][j];\n  for(int k = 1; k < 3; ++k){\n    if(i+k/2 < H && j+k%2 < W && C[i+k/2][j+k%2] <= '9' && C[i+k/2][j+k%2] >= '0'){\n      s[k-1] = solve(C,W,H,i+k/2,j+k%2,\"\");\n    }\n  }\n  if(s[0].size() == s[1].size()){\n    ret += max(s[0],s[1]);\n  }else{\n    if(s[0].size() > s[1].size()) ret += s[0];\n    else ret += s[1];\n  }\n  return ret;\n}\n\nint main(){\n  int W, H;\n  while(cin >> W >> H, W){\n    vector<string> C(H);\n    for(int i = 0; i < H; ++i)\n      cin >> C[i];\n    string ans;\n    for(int i = 0; i < H; ++i){\n      for(int j = 0; j < W; ++j){\n\tif(C[i][j] > '9' || C[i][j] < '0') continue;\n\telse{\n\t  string t = solve(C,W,H,i,j,\"\");\n\t  if(ans.size() == t.size()) ans = max(ans, t);\n\t  else if(ans.size() < t.size()) ans = t;\n\t}\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <stdio.h>\n#include <bits/stdc++.h>\n\nusing namespace std;\nusing ll=long long;\nusing ld=long double;\nusing P=pair<ll,ll>;\n#define FOR(i,n,m) for(ll i=n; i<(ll)m;i++)\n#define FORr(i,n,m) for(ll i=n; i>(ll)m; i--)\n#define FORm(i,m) for(auto i=m.begin();i!=m.end();i++)\n#define VEC2(x,a,b) vector<vector<ll>> x = vector<vector<ll>>(a,vector<ll>(b,0))\n#define sortAl(v) sort(v.begin(),v.end())\n#define sortAlr(v) sort(v.begin(),v.end()); reverse(v.begin(),v.end())\n#define cinv(v,n,m) FOR(i,n,m) cin>>v.at(i)\n#define coutv(v,n,m) FOR(i,n,m) cout<<v.at(i) <<\" \"; cout<<endl\n#define cout(n) cout<<fixed<<setprecision(n)\n\n// a>b なら 1 a=B なら 0 a<b なら-1\nint strint_cmp(string a, string b){\n  if(a == b){\n    return 0;\n  }\n  else{\n    ll siz = a.size();\n    FOR(i,0,siz){\n      if(a[i]<b[i]) return -1;\n      if(a[i]>b[i]) return 1;\n    }\n  }\n  return 0;\n}\n\nint main(){\n  cin.tie(0);\n  ios::sync_with_stdio(false);\n\n  ll w,h;\n  cin>>w>>h;\n\n  while(w!=0){\n    vector<string> sv(h+1,\"\");\n    FOR(i,0,w+1){\n      sv[0].push_back('.');\n    }\n    FOR(i,1,h+1){\n      string s;\n      cin>>s;\n      sv[i].push_back('.');\n      FOR(j,0,w){\n        sv[i].push_back(s[j]);\n      }\n    }\n    vector<vector<pair<ll,string>>> dp = vector<vector<pair<ll,string>>>(h+1,vector<pair<ll,string>>(w+1,pair<ll,string>(0,\"\")));\n\n    FOR(i,1,h+1){\n      FOR(j,1,w+1){\n        if('0' <= sv[i][j] && sv[i][j] <= '9'){\n          pair<ll,string> p;\n          if(dp[i-1][j].first<dp[i][j-1].first){\n            p = dp[i][j-1];\n          }\n          else if(dp[i][j-1].first<dp[i-1][j].first){\n            p = dp[i-1][j];\n          }\n          else if(dp[i-1][j].first == 0){\n            p = make_pair(0,\"\");\n          }\n          else{\n            string a = dp[i-1][j].second;\n            string b = dp[i][j-1].second;\n            if(strint_cmp(a,b) > 0) p = dp[i-1][j];\n            else p = dp[i][j-1];\n          }\n          if(sv[i][j] == '0' && dp[i][j-1].first == 0 && dp[i-1][j].first == 0){\n\n          }\n          else{\n            p.first++;\n            p.second += sv[i][j];\n          }\n          dp[i][j] = p;\n        }\n      }\n    }\n\n    ll max_size = 0;\n    FOR(i,0,h+1){\n      FOR(j,0,w+1){\n        max_size = max(max_size,dp[i][j].first);\n      }\n    }\n\n    vector<string> ans;\n    FOR(i,0,h+1){\n      FOR(j,0,w+1){\n        if(dp[i][j].first == max_size){\n          ans.push_back(dp[i][j].second);\n        }\n      }\n    }\n\n    sortAlr(ans);\n    cout<<ans[0]<<endl;\n    cin>>w>>h;\n  }\n\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "//The Secret Number\n#include<bits/stdc++.h>\nusing namespace std;\n\nint H, W;\nint mp[70][70];\nstring dp[70][70];\n\nstring max_comp(string s1, string s2){\n  if(s1.length() > s2.length())return s1;\n  if(s1.length() < s2.length())return s2;\n\n  for(int i=0; i<s1.length(); i++){\n    if(s1[i] > s2[i])return s1;\n    if(s1[i] < s2[i])return s2;\n  }\n  return s1; //??????\n}\n\nint main(){\n  while(cin >> W >> H, !(H==0 && W==0)){\n    //??\\???\n    for(int i=0; i<H; i++){\n      for(int j=0; j<W; j++){\n\tchar tmp;\n\tcin >> tmp;\n\tif('0'<=tmp && tmp<='9')mp[i][j] = tmp-'0';\n\telse mp[i][j] = -1;\n      }\n    }\n\n    //?????????\n    for(int i=0; i<H; i++)\n      for(int j=0; j<W; j++)\n\tdp[i][j]=\"\";\n\n    if(mp[H-1][W-1]!=-1)dp[H-1][W-1].insert(dp[H-1][W-1].begin(), mp[H-1][W-1]+'0');\n\n    for(int i=H-2; i>=0; i--){\n      if(mp[i][W-1] != -1){\n\tstring tmp = dp[i+1][W-1];\n\ttmp.insert(tmp.begin(), mp[i][W-1]+'0');\n\tdp[i][W-1] = tmp;\n      }\n    }\n    for(int j=W-2; j>=0; j--){\n      if(mp[H-1][j] != -1){\n\tstring tmp = dp[H-1][j+1];\n\ttmp.insert(tmp.begin(), mp[H-1][j]+'0');\n\tdp[H-1][j] = tmp;\n      }\n    }\n\n    //???????¨???????\n    for(int i=H-2; i>=0; i--){\n      for(int j=W-2; j>=0; j--){\n\tif(mp[i][j]==-1)continue; //??????????????????\n\tstring tmp1 = dp[i+1][j], tmp2 = dp[i][j+1];\n\ttmp1.insert(tmp1.begin(), mp[i][j]+'0');\n\ttmp2.insert(tmp2.begin(), mp[i][j]+'0');\n\tdp[i][j] = max_comp(tmp1, tmp2);\n      }\n    }\n\n    string ans = \"\";\n    for(int i=0; i<H; i++)\n      for(int j=0; j<W; j++)\n\tans = max_comp(ans, dp[i][j]);\n\n    while(ans[0]=='0')ans.erase(ans.begin());\n\n    if(ans==\"\")cout << \"0\" << endl;\n    else cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint W, H;\nvector<string> str;\nbool used[70][70];\nstring memo[70][70];\nconst int dx[] = { 1, 0 };\nconst int dy[] = { 0, 1 };\n\n\nbool Comp(const string& l, const string& r) {\n\treturn l.size() == r.size() ? l < r : l.size() < r.size();\n}\n\nstring MAX(const string& l, const string& r) {\n\treturn Comp(l, r) ? r : l;\n}\n\nstring dfs(int x, int y) {\n\tif (memo[x][y] != \"\") return memo[x][y];\n\tstring res[2];\n\tfor (int i = 0; i < 2; i++) {\n\t\tint tx = x + dx[i], ty = y + dy[i];\n\t\tif (tx >= 0 && tx < H && ty >= 0 && ty < W && str[tx][ty] >= '0' && str[tx][ty] <= '9') {\n\t\t\tres[i] = dfs(tx, ty);\n\t\t}\n\t}\n\tused[x][y] = true;\n\treturn memo[x][y] = str[x][y] + MAX(res[0], res[1]);\n}\n\nint main()\n{\n\twhile (cin >> W >> H, W || H) {\n\t\tfor (int i = 0; i < H; i++) {\n\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\tused[i][j] = false;\n\t\t\t\tmemo[i][j].clear();\n\t\t\t}\n\t\t}\n\t\tstr.resize(H);\n\t\tfor (int i = 0; i < H; i++) {\n\t\t\tcin >> str[i];\n\t\t}\n\t\tstring res;\n\t\tfor (int i = 0; i < H; i++) {\n\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\tif (!used[i][j] && str[i][j] >= '1' && str[i][j] <= '9') {\n\t\t\t\t\tres = MAX(res, dfs(i, j));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cctype>\nusing namespace std;\n\nbool compare(string s1,string s2){\n  if(s1.size()>s2.size())return true;\n  if(s1.size()<s2.size())return false;\n  for(int i=0;i<s1.size();i++){\n    if(s1[i]>s2[i])return true;\n    if(s1[i]<s2[i])return false;\n  }\n  return false;\n}\n\nint main()\n{\n  int W,H;\n  char C[70][70];\n  string max,dp[70][70];\n  while(cin>>W>>H,W|H){\n    for(int i=0;i<H;i++)for(int j=0;j<W;j++){\n      cin>>C[i][j];\n      dp[i][j]=\"\";\n    }\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\tif(isalpha(C[i][j]))continue;\n\tstring above,left;\n\tabove=left=C[i][j];\n\tif(i>0 && dp[i-1][j]!=\"0\")above=dp[i-1][j]+C[i][j];\n\tif(j>0 && dp[i][j-1]!=\"0\")left=dp[i][j-1]+C[i][j];\n\tif( compare(above,left) ){\n\t  dp[i][j]=above;\n\t}else{\n\t  dp[i][j]=left;\n\t}\n      }\n    }\n    max=\"\";\n    for(int i=0;i<H;i++)for(int j=0;j<W;j++)if(compare(dp[i][j],max))max=dp[i][j];\n    cout<<max<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <list>\n#include <stack>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <sstream>\nusing namespace std;\n\n#define REP(i,a,n) for(i=a; i<n; i++)\n#define rep(i,n) REP(i,0,n)\n#define all(x) x.begin(), x.end()\n#define rall(x) x.rbegin(), x.rend()\n#define foreach(it,x) for(typeof(x.begin()) it=x.begin(); it!=x.end(); it++)\n\nint w,h;\nstring dp[77][77], field[77];\n\nstring stmax(const string& a, const string& b){\n    if( a.length() == b.length() ){\n        return (a > b ? a : b);\n    }\n    return (a.length() > b.length() ? a : b);\n}\n\nint main(){\n    int i,j;\n\n    while( cin >> w >> h, w|h ){\n        rep(i,h) cin >> field[i];\n\n        // init\n        rep(i,77) rep(j,77) dp[i][j] = \"\";\n\n        string res;\n        REP(i,1,h+1){\n            REP(j,1,w+1){\n                if( isdigit(field[i-1][j-1]) ){\n                    dp[i][j] = stmax(dp[i-1][j], dp[i][j-1]) + field[i-1][j-1];\n                    if( dp[i][j].length() > 1 && dp[i][j][0] == '0' ){\n                        dp[i][j] = dp[i][j].substr(1);\n                    }\n                    res = stmax(res, dp[i][j]);\n                }\n            }\n        }\n\n        cout << res << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <cstring>\n#include <iostream>\n\nusing namespace std;\n\nbool compare(string S1, string S2)\n{\n\tif (S1.size() != S2.size()) { return S1.size() > S2.size(); }\n\n\treturn S1 > S2;\n}\n\nint main()\n{\n\tint H, W; char R[71][71];\n\n\twhile (true)\n\t{\n\t\tscanf(\"%d\", &W);\n\t\tscanf(\"%d\", &H);\n\n\t\tif (H == 0 && W == 0) { break; }\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tscanf(\"%s\", R[i]);\n\t\t}\n\n\t\tchar dp[71][71][140];\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (isdigit(R[i][j]))\n\t\t\t\t{\n\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][j][0] = R[i][j];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstrcpy(dp[i][j], dp[i - 1][j]);\n\n\t\t\t\t\t\t\t\tdp[i][j][(int)strlen(dp[i - 1][j])] = R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]) && dp[i - 1][j] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstrcpy(dp[i][j], dp[i - 1][j]);\n\n\t\t\t\t\t\t\t\tdp[i][j][(int)strlen(dp[i - 1][j])] = R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (j != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstrcpy(dp[i][j], dp[i][j - 1]);\n\n\t\t\t\t\t\t\t\tdp[i][j][(int)strlen(dp[i][j - 1])] = R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]) && dp[i][j - 1] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstrcpy(dp[i][j], dp[i][j - 1]);\n\n\t\t\t\t\t\t\t\tdp[i][j][(int)strlen(dp[i][j - 1])] = R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ret = \"\";\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (compare(dp[i][j], ret))\n\t\t\t\t{\n\t\t\t\t\tret = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%s\\n\", ret.c_str());\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <string>\n#include <queue>\nusing namespace std;\n\nclass Point{\npublic:\n  short a[70],x,y,d;\n  Point(short x = 0,short y = 0,short d = 0):x(x),y(y),d(d){}\n};\n\nPoint maxu(Point,Point);\n\nint main(){\n  while(1){\n    int i,j,w,h,n[70][70];\n    string str;\n    Point max;\n    Point b[70][70];\n    cin >> w >> h;\n    if(w == 0 && h == 0) break;\n\n    for(i=0;i<h;i++){\n      cin >> str;\n      for(j=0;j<w;j++){\n\tif('0' <= str[j] && str[j] <= '9') n[i][j] = str[j] - '0';\n\telse n[i][j] = -1;\n      }\n    }\n\n    for(i=0;i<70;i++){\n      max.a[i] = 0;\n      for(j=0;j<h;j++){\n\tfor(int k=0;k<w;k++) b[j][k].a[i] = 0;\n      }\n    }\n\n    for(i=0;i<h;i++){\n      for(j=0;j<w;j++){\n\tif(n[i][j] > 0 && b[i][j].d == 0){\n\t  b[i][j].a[0] = n[i][j];\n\t  b[i][j].d = 1;\n\t  max = maxu(max,b[i][j]);\n\t}\n\n\tbool f1 = false,f2 = false;\n\tPoint u,v;\n\tif(i > 0 && n[i][j] >= 0 && b[i-1][j].d > 0){\n\t  u = b[i-1][j];\n\t  f1 = true;\n\t}\n\tif(j > 0 && n[i][j] >= 0 && b[i][j-1].d > 0){\n\t  v = b[i][j-1];\n\t  f2 = true;\n\t}\n\tif(f1 && f2){\n\t  b[i][j] = maxu(u,v);\n\t  b[i][j].a[b[i][j].d++] = n[i][j];\n\t  max = maxu(max,b[i][j]);\n\t}\n\telse if(f1){\n\t  b[i][j] = u;\n\t  b[i][j].a[b[i][j].d++] = n[i][j];\n\t  max = maxu(max,b[i][j]);\n\t}\n\telse if(f2){\n\t  b[i][j] = v;\n\t  b[i][j].a[b[i][j].d++] = n[i][j];\n\t  max = maxu(max,b[i][j]);\n\t}\n      }\n      \n    }\n    for(i=0;i<max.d;i++) cout << max.a[i];\n    cout << endl;\n  }\n  return 0;\n  }\n\nPoint maxu(Point a,Point b){\n  if(a.d > b.d) return a;\n  else if(a.d < b.d) return b;\n  else if(a.d == b.d){\n    for(int i=0;i<a.d;i++){\n      if(a.a[i] > b.a[i]){\n\treturn a;\n\tbreak;\n      }\n      else if(a.a[i] < b.a[i]){\n\treturn b;\n\tbreak;\n      }\n    }\n  }\n  return a;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <cstring>\n#include <string>\n\nusing namespace std;\n\nbool func(char w)\n{\n  char num = '0';\n  for(int i = 0; i < 10; i++){\n    if(w == (char)(num+i)){\n      return true;\n    }\n  }\n\n  return false;\n}\n\nstring stcomp(string s1, string s2)\n{\n  string str = s1;\n  if(s1.length() == s2.length()){\n    if(s1 < s2){\n\t\t\tstr = s2;\n\t\t}\n  }\n\tif(s1.length() < s2.length()){\n    str = s2;\n  }\n\n  return str;\n}\n\nstring search(char a[71][71], int h, int w, int s, int t, bool vis[71][71], string astr[71][71])\n{\n  string str, str2=\"\", str3=\"\";\n  str = a[s][t];\n\t\n\tif(vis[s][t]){\n\t\treturn (str+astr[s][t]);\n\t}\n\tvis[s][t] = true;\n\n  if(s+1 < h){\n    if(func(a[s+1][t])){\n      str2 = search(a, h, w, s+1, t, vis, astr);\n    }\n  }\n  if(t+1 < w){\n    if(func(a[s][t+1])){\n      str3 = search(a, h, w, s, t+1, vis, astr);\n    }\n  }\n\tastr[s][t] = stcomp(str2, str3);\n\n  return (str+astr[s][t]);\n}\n\nint main()\n{\n  int w, h;\n  char a[71][71];\n  string str, st;\n\tstring astr[71][71];\n\tbool vis[71][71];\n\n  while(1){\n    cin >> w >> h;\n    if(h == 0 && w == 0){\n      break;\n    }\n\t\tfill(&vis[0][0], &vis[h+1][w+1], false);\n    str = \"\";\n    for(int i = 0; i < h; i++){\n      cin >> a[i];\n    }\n\n    for(int i = 0; i < h; i++){\n      for(int j = 0; j < w; j++){\n\t\t\t\tif(func(a[i][j])){\n\t\t\t\t\tst = search(a, h, w, i, j, vis, astr);\n\t\t\t\t\tstr = stcomp(str, st);\n\t\t\t\t}\n      }\n    }\n    w = 0;\n    while(str[w] == '0'){\n      w++;\n    }\n\n    cout << str.substr(w) << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<vector>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<numeric>\n#include<cassert>\n#include<random>\nusing namespace std;\n\nbool num(char c){\n    if(c<'0' || c>'9'){return false;}\n    return true;\n}\n\nstring max(string a,string b){\n    int as=(int)a.size();\n    int bs=(int)b.size();\n    for(int i=0;a[i]=='0';i++){as--;}\n    for(int i=0;b[i]=='0';i++){bs--;}\n    if(as>bs){return a;}\n    if(bs>as){return b;}\n    for(int i=0;i<as;i++){\n        if(a[a.size()-as+i]>b[b.size()-bs+i]){return a;}\n        if(a[a.size()-as+i]<b[b.size()-bs+i]){return b;}\n    }\n    return a;\n}\n\nstring pls(char c,string s){\n    s.push_back(1);\n    for(int i=s.size()-2;i>=0;i--){\n        s[i+1]=s[i];\n    }\n    s[0]=c;\n    return s;\n}\n\nint main(){\n    while(1){\n        \n        \n        \n    \n    string mx;\n    char a[100][100]={};\n    int w,h;\n    cin>>w>>h;\n        if(w==0 && h==0){break;}\n    for(int i=0;i<h;i++){\n        for(int t=0;t<w;t++){\n            cin>>a[i][t];\n        }\n    }\n    string dp[100][100]={};\n    string ans;\n    for(int i=h-1;i>=0;i--){\n        for(int t=w-1;t>=0;t--){\n            if(num(a[i][t])){\n                dp[i][t]=pls(a[i][t],max(dp[i+1][t],dp[i][t+1]));\n                ans=max(ans,dp[i][t]);\n            }\n        }\n    }\n    cout<<ans<<endl;\n    \n        \n        \n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#define F first\n#define S second\nusing namespace std;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() == 0 && b.size() == 0)\n    return true;\n  else if(a.size() == 0)\n    return true;\n  else if(b.size() == 0)\n    return false;\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] < b[i];\n  return false;\n}\n\nint main()\n{\n\n  int w,h;\n  while(cin >> w >> h,(w || h))\n    {\n      cerr << w << \" \" << h << endl;\n      char G[h][w];\n      string ans=\"0\";\n      string dp[h][w];\n\n      for(int i=0;i<h;i++)\n\t{\n\tfor(int j=0;j<w;j++)\n\t  {\n\t    cin >> G[i][j];\n\t    cerr << G[i][j] << endl;\n\t    if('0' <= G[i][j] && G[i][j] <= '9')\n\t      {\n\t\tdp[i][j] = G[i][j];\n\t\tans = max(ans,dp[i][j],cmp);\n\t      }\n\t\n\t  }\n\t}\n     \n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\n\t      if(!('0' <= G[i][j] && G[i][j] <= '9'))\n\t\tcontinue;\n\t      if(!('0' <= G[i-1][j] && G[i-1][j] <= '9') && !('0' <= G[i][j-1] && G[i][j-1] <= '9'))\n\t\tcontinue;\n\t      \n\t      dp[i][j] = max(dp[i][j],max((i-1>=0?dp[i-1][j]:\"\")+dp[i][j],\n\t\t\t\t\t  (j-1>=0?dp[i][j-1]:\"\")+dp[i][j],cmp),cmp);\t      \n\t      ans = max(ans,dp[i][j],cmp);\n\n\t    }\n\t}\n\n\n      bool f = false;\n      int cnt = 0;\n      for(int i=0;i<ans.size();i++)      \n\tif(ans[i] == '0' && !f)\n\t  continue;\n\telse  \n\t  {\n\t    cnt++;\n\t    f = true;\n\t    cout << ans[i];\n\t  }\n      if(cnt == 0)\n\tcout << \"0\";\n\tcout << endl;\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nbool isdigit(char c){\n\tif(c >= '0' && c <= '9') return true;\n\telse return false;\n}\n\nint main(){\n\tint w,h;\n\tstring field[70];\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(!w) break;\n\t\tstring dp[71][71] = {};\n\t\tfor(int i = 0;i < h;i++) cin >> field[i];\n\t\tstring ma = \"\";\n\t\tfor(int i = 1;i <= h;i++){\n\t\t\tfor(int j = 1;j <= w;j++){\n\t\t\t\tif(isdigit(field[i - 1][j - 1])){\n\t\t\t\t\tstring s1 = dp[i - 1][j],s2 = dp[i][j - 1];\n\t\t\t\t\tif(s1 == \"\" && s2 == \"\" && field[i - 1][j - 1] == '0') continue;\n\t\t\t\t\tif(s1.length() > s2.length() || (s1.length() == s2.length() && s1 > s2)){\n\t\t\t\t\t\tdp[i][j] = s1 + to_string(field[i - 1][j - 1] - '0');\n\t\t\t\t\t}else{\n\t\t\t\t\t\tdp[i][j] = s2 + to_string(field[i - 1][j - 1] - '0');\n\t\t\t\t\t}\n\t\t\t\t\tif(dp[i][j].length() > ma.length() || (dp[i][j].length() == ma.length() && dp[i][j] > ma)){\n\t\t\t\t\t\tma = dp[i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ma << endl;\n\t\t\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstring dp[71][71];\n\nbool f(char c) {\n    return c >= '0' && c <= '9';\n}\n\nstring eraseZero(string s) {\n    for (int i = 0; i < s.size(); i++) {\n        if (s[i] != '0') {\n            s = s.substr(i, s.size() - i);\n            break;\n        }\n        if (i == s.size() - 1) {\n            return \"0\";\n        }\n    }\n    return s;\n}\n\nbool bigger(string a, string b) {\n    if (a == \"\") return 0;\n    if (b == \"\") return 1;\n    a = eraseZero(a);\n    b = eraseZero(b);\n    if (a.size() > b.size()) return 1;\n    if (a.size() < b.size()) return 0;\n    return a >= b;\n}\n\n\nint main(void) {\n    int w, h;\n\n    while (1) {\n        cin >> w >> h;\n        if (w == 0) break;\n        string c[71];\n        for (int i = 0; i < h; i++) {\n            cin >> c[i];\n        }\n\n        dp[0][0] = f(c[0][0]) ? c[0][0] : '?';\n\n        string u, l;\n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n                if (i == 0 && j == 0) continue;\n                if (i == 0) {\n                    if (!f(c[i][j])) {\n                        dp[i][j] = \"?\";\n                    } else if (dp[i][j - 1] != \"?\") {\n                        dp[i][j] = dp[i][j - 1] + c[i][j];\n                    } else {\n                        dp[i][j] = c[i][j];\n                    }\n                } else if (j == 0) {\n                    if (!f(c[i][j])) {\n                        dp[i][j] = \"?\";\n                    } else if (dp[i - 1][j] != \"?\") {\n                        dp[i][j] = dp[i - 1][j] + c[i][j];\n                    } else {\n                        dp[i][j] = c[i][j];\n                    }\n                } else {\n                    if (!f(c[i][j])) {\n                        dp[i][j] = '?';\n                    } else {\n                        u = \"\", l = \"\";\n                        if (f(c[i - 1][j])) {\n                            u = dp[i - 1][j] + c[i][j];\n                        }\n                        if (f(c[i][j - 1])) {\n                            l = dp[i][j - 1] + c[i][j];\n                        }\n                        if (u == \"\" && l == \"\") {\n                            dp[i][j] = c[i][j];\n                        } else if (bigger(u, l)) {\n                            dp[i][j] = u;\n                        } else {\n                            dp[i][j] = l;\n                        }\n                    }\n                }\n            }\n        }\n\n        string ans = \"\";\n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n                if (dp[i][j] == \"?\") continue;\n                if (!bigger(ans, dp[i][j])) {\n                    ans = dp[i][j];\n                }\n            }\n        }\n        ans = eraseZero(ans);\n        cout << ans << endl;\n    }\n\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "// AOJ 1126\n#include<iostream>\n#include<string>\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\nusing namespace std;\n\nbool iszero(string s) {\n  for (char c : s) {\n    if (c != '0') return false;\n  }\n  return true;\n}\n\nstring remove_zero(string s) {\n  for (int i = 0, len = s.length(); i < len; i++) {\n    if (s[i] != '0') return s.substr(i);\n  }\n  return \"\";\n}\n\nint compare(string s1, string s2) {\n  int l1 = s1.length(), l2 = s2.length();\n\n  if (l1 < l2) {\n    return -1;\n  } else if (l1 > l2) {\n    return 1;\n  } else {\n    return s1.compare(s2);\n  }\n}\n\nstring strmax(string s1, string s2) {\n  return (compare(s1, s2) > 0 ? s1 : s2);\n}\n\nint W, H;\nconst int WMAX = 100;\nchar table[WMAX][WMAX];\nstring dp[WMAX][WMAX];\n\nvoid solve() {\n  for (int y = H - 1; y >= 0; y--) {\n    for (int x = W - 1; x >= 0; x--) {\n      if (isalpha(table[x][y])) {\n        dp[x][y] = \"\";\n      } else {\n        dp[x][y] = table[x][y] + strmax(dp[x+1][y], dp[x][y+1]);\n      }\n    }\n  }\n}\n\nvoid init() {\n  REP(y,H+3) REP(x,W+3) {\n    dp[x][y] = \"\";\n  }\n}\n\nint main() {\n  while (cin >> W >> H and (W or H)) {\n    REP(y, H) {\n      string row;\n      cin >> row;\n      REP(x, W) {\n        table[x][y] = row[x];\n      }\n    }\n\n    solve();\n\n    string mx = \"\";\n    REP(y,H) REP(x,W) {\n      if (iszero(dp[x][y])) continue;\n      mx = strmax(mx, remove_zero(dp[x][y]));\n    }\n    cout << remove_zero(mx) << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nint W,H;\nstring s[71][71];\nchar in[71][71];\n\nbool comp2(string s, string r){\n\tif(s.size() != r.size()) return s.size() > r.size();\n\treturn s > r;\n\t\n}\n\nbool comp(string s, string r){\n\twhile(s[0]=='0' && isdigit(s[1])) s = s.substr(1);\n\twhile(r[0]=='0' && isdigit(r[1])) r = r.substr(1);\n\treturn comp2(s, r);\n}\nmain(){\n\tint i,j,k;\n\twhile(cin>>W>>H, W){\n\t\tfor(i=0;i<H;i++) cin>>in[i];\n\t\tstring m=\"0\";\n\t\tfor(int h=H-1;h>=0;h--)\n\t\t\tfor(int w=W-1;w>=0;w--)\n\t\t\t\ts[h][w] = \"\";\n\t\tfor(int h=H-1;h>=0;h--)\n\t\t\tfor(int w=W-1;w>=0;w--){\n\t\t\t\tif(!isdigit(in[h][w])) continue;\n\t\t\t\tif(comp(in[h][w]+s[h+1][w],m)) m = (in[h][w]+s[h+1][w]);\n\t\t\t\tif(comp(in[h][w]+s[h][w+1],m)) m = (in[h][w]+s[h][w+1]);\n\t\t\t\ts[h][w] = (comp2(in[h][w]+s[h+1][w] , in[h][w]+s[h][w+1])) ? (in[h][w]+s[h+1][w]) : (in[h][w]+s[h][w+1]);\n\t\t\t}\n\t\twhile(m[0]=='0' && isdigit(m[1])) m = m.substr(1);\n\t\tcout<<m<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n\nusing namespace std;\n\nstring dp[101][101];\n\nconst int dy[]={0,1};\nconst int dx[]={1,0};\n\nint w,h;\nchar field[101][101];\n\nstring maxString(string str1,string str2){\n\tstring res1=str1;\n\tstring res2=str2;\n\n\tif(str1==\"\"){\n\t\treturn str2;\n\t}\n\telse if(str2==\"\"){\n\t\treturn str1;\n\t}\n\n\t// ツ静ヲツ督ェツづ頚eroツづーツ湘つキ\n\tint idx1=str1.size()-1;\n\tfor(int i = 0; i < (int)(str1.size())-1; i++){\n\t\tif(str1[i]!='0'){\n\t\t\tidx1=i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tstr1=str1.substr(idx1);\n\tidx1=str2.size()-1;\n\tfor(int i = 0; i < (int)(str2.size())-1; i++){\n\t\tif(str2[i]!='0'){\n\t\t\tidx1=i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tstr2=str2.substr(idx1);\n\tif(str1.size()>str2.size())\n\t\treturn res1;\n\telse if(str1.size()<str2.size())\n\t\treturn res2;\n\telse{\n\t\tfor(int i = 0; i < str1.size(); i++){\n\t\t\tif(str1[i]>str2[i]){\n\t\t\t\treturn res1;\n\t\t\t}\n\t\t\telse if(str1[i]<str2[i]){\n\t\t\t\treturn res2;\n\t\t\t}\n\t\t}\n\t\treturn res1;\n\t}\n}\n\nstring dfs(int x,int y){\n\tif(y==2&&x==2){\n//\t\tcout<<endl;\n\t}\n\tif(dp[y][x]!=\"\")\n\t\treturn dp[y][x];\n\tif(!(field[y][x]>='0'&&field[y][x]<='9')){\n\t\treturn \"\";\n\t}\n\tstring res=\"\";\n\t//maxNum=0;\n\tfor(int i = 0; i < 2; i++){\n\t\tint ny=y+dy[i];\n\t\tint nx=x+dx[i];\n\t\tif(ny>=0&&nx>=0&&ny<h&&nx<w&&(field[ny][nx]>='0'&&field[ny][nx]<='9')){\n\t\t\tstring s=(dfs(nx,ny));\n\t\t\tif(s!=\"\")\n\t\t\t\tres=maxString(res,s);\n//\t\t\tif(s==\"900037\"){\n////\t\t\t\tcout<<endl;\n//\t\t\t}\n//\t\t\tif(maxNum<=atoi(s.c_str())){\n//\t\t\t\tmaxNum=atoi(s.c_str());\n//\t\t\t\tres=s;\n//\t\t\t}\n\t\t}\n\t}\n\t//res+=field[y][x];\n\tres=field[y][x]+res;\n\tdp[y][x]=res;\n\treturn res;\n}\n\nint main(){\n\n\twhile(cin>>w>>h&&!(w==0&&h==0)){\n\t\tfor(int i = 0; i < h; i++){\n\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\tcin>>field[i][j];\n\t\t\t\tdp[i][j].clear();\n\t\t\t}\n\t\t}\n\t\tstring maxNum=\"\";\n\t\tfor(int i = 0; i < h; i++){\n\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\tstring res=dfs(j,i);\n\t\t\t\tif(res==\"\")\n\t\t\t\t\tcontinue;\n\t\t\t\tmaxNum=maxString(maxNum,res);\n\t\t\t\t//if(maxNum<atoi(res.c_str())){\n\t\t\t\t//\tmaxNum=atoi(res.c_str());\n\t\t\t\t//}\n\t\t\t}\n\t\t}\n\n\t\t// ツ静ヲツ督ェツづ頚eroツづーツ湘つキ\n\t\tif(maxNum!=\"\"){\n\t\t\tint idx1=maxNum.size()-1;\n\t\t\tfor(int i = 0; i < (int)(maxNum.size())-1; i++){\n\t\t\t\tif(maxNum[i]!='0'){\n\t\t\t\t\tidx1=i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmaxNum=maxNum.substr(idx1);\n\t\t}\n\t\tcout<<maxNum<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n\nusing namespace std;\nusing ll = long long int;\n#define long ll\n\nint main(void) {\n    cin.tie(0); ios::sync_with_stdio(false);\n\n    auto f = [&](char x, const string &s) {\n        string r = s;\n        ll i = 150 - 1;\n        while(r[i] != ' ') i--;\n        r[i] = x;\n        return r;\n    };\n    while(1) {\n        ll w, h;\n        cin >> w >> h;\n        if(!w) break;\n\n        vector<string> c(h);\n        for(auto &l: c) cin >> l;\n\n        vector<vector<string>> dp(h+1, vector<string>(w+1, string(150, ' ')));\n\n        for(ll i=h-1; i>=0; i--)\n        for(ll j=w-1; j>=0; j--)\n            if('0' <= c[i][j] && c[i][j] <= '9')\n                dp[i][j] = f(c[i][j], max(dp[i+1][j], dp[i][j+1]));\n\n        string m = \"\";\n        for(ll i=0; i<h; i++)\n        for(ll j=0; j<w; j++) {\n            ll k = 0;\n            while(dp[i][j][k] == ' ' || dp[i][j][k] == '0') dp[i][j][k++] = ' ';\n            m = max(m, dp[i][j]);\n        }\n        {\n            ll i = 0;\n            while(m[i] == ' ' || m[i] == '0') i++;\n            for(; i<150; i++)\n                cout << m[i];\n            cout << endl;\n        }\n\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<algorithm>\n#include<vector>\n#define F first\n#define S second\nusing namespace std;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() == 0 && b.size() == 0)\n    return false;\n  else if(a.size() == 0)\n    return true;\n  else if(b.size() == 0)\n    return false;\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] < b[i];\n  return false;\n}\n\nint main()\n{\n\n  int w,h;\n  while(cin >> w >> h,(w || h))\n    {\n      \n      char G[h][w];\n      string ans=\"0\";\n      string dp[h][w];\n\n      for(int i=0;i<h;i++)\n\t{\n\tfor(int j=0;j<w;j++)\n\t  {\n\t    cin >> G[i][j];\n\t    if('0' <= G[i][j] && G[i][j] <= '9')\n\t      {\n\t\tdp[i][j] = G[i][j];\n\t\tans = max(ans,dp[i][j],cmp);\n\t      }\n\t\n\t  }\n\n\t}\n     \n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\n\t      if(!('0' <= G[i][j] && G[i][j] <= '9'))\n\t\tcontinue;\n\t      \n\t      dp[i][j] = max(dp[i][j],max((i-1>=0 &&('0'<= G[i-1][j] && G[i-1][j] <= '9') ?dp[i-1][j]:\"\")+dp[i][j],\n\t\t\t\t\t  (j-1>=0 &&('0'<= G[i][j-1] && G[i][j-1] <= '9') ?dp[i][j-1]:\"\")+dp[i][j],cmp),cmp);\t      \n\t      //ans = max(ans,dp[i][j],cmp);\n\n\t    }\n\t}\n\n      ans = \"\";\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\t      if('0' <= G[i][j] && G[i][j] <= '9')\n\t\t{\n\t\t  string a;\n\t\t  if(dp[i][j] != \"0\" && dp[i][j][0] == '0')\n\t\t    {\n\n\t\t      for(int k=0;dp[i][j][k] == '0';k++)\n\t\t\tdp[i][j][k] = ' ';\t\t    \n\t\t      stringstream ss;\n\t\t      ss << dp[i][j];\n\t\t      a = ss.str();\n\t\t    }\n\t\t  else\n\t\t    a = dp[i][j];\n\t\t  ans = max(ans,a);\n\n\t\t}\n\t    }\n\t}\n\n\n      bool f = false;\n      int cnt = 0;\n      for(int i=0;i<ans.size();i++)      \n\tif(ans[i] == '0' && !f)\n\t  continue;\n\telse  \n\t  {\n\t    cnt++;\n\t    f = true;\n\t    cout << ans[i];\n\t  }\n      if(cnt == 0)\n\tcout << \"0\";\n\tcout << endl;\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\ntypedef vector<int> v;\nint h,w,k;\nv x(v a,v b){\n\tif(a.size()==b.size())return max(a,b);\n\treturn (a.size()>b.size())?a:b;\n}\nint main(){\n\twhile(cin>>w>>h&&h){\n\tv d[75][75],s;r(i,h)r(j,w){\n\t\tchar z;cin>>z;z-='0';\n\t\tif(!(z/10)&&(z||d[i][j].size())){\n\t\t\td[i][j].push_back(z);\n\t\t\td[i+1][j]=x(d[i+1][j],d[i][j]);\n\t\t\td[i][j+1]=x(d[i][j+1],d[i][j]);\n\t\t}s=x(s,d[i][j]);\n\t}r(i,s.size())cout<<s[i];cout<<endl;\n\t}return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define mk make_pair\nusing namespace std;\nint dx[]={1,0},dy[]={0,1};\nint main(){\n  int w,h;\n  while(cin>>w>>h,w){\n    string s[h],t=\"\";\n    r(i,h)cin>>s[i];\n    r(i,h)r(j,w)if(s[i][j]>='1'&&s[i][j]<='9'){\n      bool b[h][w];\n      r(k,h)r(l,w)b[k][l]=0;\n      queue<pair<int,int> >q;\n      string ss[h][w];\n      q.push(mk(i,j));\n      while(!q.empty()){\n        pair<int,int>a=q.front();q.pop();\n        int x=a.second,y=a.first;\n        ss[y][x]+=s[y][x];\n        r(k,2){\n          int x1=x+dx[k],y1=y+dy[k];\n          if(x1<0||y1<0||x1>=w||y1>=h||s[y1][x1]<'0'||s[y1][x1]>'9')continue;\n          if(b[y1][x1]){\n            if(ss[y1][x1]<ss[y][x]){\n              ss[y1][x1]=\"\";\n              ss[y1][x1]+=ss[y][x];\n            }\n          }\n          else {\n            ss[y1][x1]+=ss[y][x];\n            q.push(mk(y1,x1));\n            b[y1][x1]=1;\n          }\n        }\n      }string tt=\"\";\n      r(k,h)r(l,w)tt=max(tt,ss[k][l]);\n      if(t.size()<tt.size())if(t<tt)t=tt;\n    }\n    cout<<t<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n#define rep(i,n) for(int i = 0; i < n ;++i)\n#define all(v) v.begin(),v.end()\n\nstring s[100];\nint w,h;\nint dx[2]={0,1};\nint dy[2]={1,0};\nbool used[100][100];\n//vector<string> vs;\nstring ans;\n\nvoid solve(int y,int x,string t){\n  // cout<<s[y][x]<<endl;\n  bool f=0;\n  rep(i,2){\n    int ny=dy[i]+y,nx=x+dx[i];\n    if(ny>=0&&ny<h&&nx>=0&&nx<w){\n      if(/*!used[ny][nx]&&*/s[ny][nx]>='0'&&s[ny][nx]<='9'){\n        //used[ny][nx]=1;\n        solve(ny,nx,t+s[ny][nx]);\n        //used[ny][nx]=0;\n        f=1;\n      }\n    }\n  }\n  if(!f){\n    if(ans.size()<t.size())ans=t;\n    else if(ans.size()==t.size()){\n      if(ans<t)ans=t;\n    }\n  }\n  //vssh_back(t);\n}\n\nbool F(string a,string b){\n  if(a.size()!=b.size())return a.size()>b.size();\n  return a>b;\n}\n\nint main(){\n    while(cin>>w>>h&&w+h){\n      //vs.clear();\n      ans=\"\";\n        rep(i,h)cin>>s[i];\n        rep(i,h)rep(j,w)used[i][j]=0;\n        rep(i,h){\n          rep(j,w){\n            if(/*!used[i][j]&&*/s[i][j]>='1'&&s[i][j]<='9'){\n              used[i][j]=1;\n              string t;\n              t.push_back(s[i][j]);\n              solve(i,j,t);\n            }\n          }\n        }\n        // sort(all(vs),F);\n        // reverse(all(vs));\n        // cout<<vs[0]<<endl;\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nconst int dx[] = {1, 0};\nconst int dy[] = {0, 1};\n\nvector<string> board(70);\nstring memo[70][70];\nint W, H;\n\ninline bool isDigit(int x, int y)\n{\n    if ('0' <= board[y][x] && board[y][x] <= '9')\n        return true;\n    else\n        return false;\n}\n\nstring Rec(int x, int y)\n{\n    if (memo[y][x].size() != 0)\n        return memo[y][x];\n\n    string s, tmp;\n    for (int d = 0; d < 2; ++d) {\n        int nx = x + dx[d];\n        int ny = y + dy[d];\n\n        if (nx < 0 || nx >= W || ny < 0 || ny >= H || !isDigit(nx, ny))\n            continue;\n\n        tmp = Rec(nx, ny);\n        if (tmp.size() > s.size() || (tmp.size() == s.size() && tmp > s))\n            s = tmp;\n    }\n\n    return memo[y][x] = board[y][x] + s;\n}\n\nint main()\n{\n    while (cin >> W >> H, W || H) {\n        // Input\n        for (int i = 0; i < H; ++i)\n            cin >> board[i];\n\n        // Init\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                memo[i][j] = \"\";\n\n        // Solve\n        string tmp, ans;\n        for (int i = 0; i < H; ++i)\n            for (int j = 0; j < W; ++j)\n                if (isDigit(j, i)) {\n                    tmp = Rec(j, i);\n                    if (tmp.size() > ans.size() || (tmp.size() == ans.size() && tmp > ans))\n                        ans = tmp;\n                }\n\n        // Output\n        int index = 0;\n        while (ans[index] == '0')\n            index++;\n        cout << ans.substr(index) << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n\n\nusing namespace std;\n\nint const N = 100;\nchar table[N][N] = {};\nbool vd[N][N] = {};\n\nvoid clear() {\n    for( int i=0; i<N; ++i )\n        for( int j=0; j<N; ++j ) {\n            table[i][j] = 0;\n            vd[i][j] = false;\n        }\n}\n\nint const dir[][2] = {{1,0}, {0, 1}};\nvoid find( vector<string>& ss, string& s, int const x, int const y, int const w, int const h )\n{\n    s += table[x][y];\n    vd[x][y] = true;\n\n    for( int i=0; i<2; ++i ) {\n        int const nx = x + dir[i][0];\n        int const ny = y + dir[i][1];\n        if ( nx < 0 || ny < 0 || nx >= w || ny >= h )\n            continue;\n        \n        if ( table[nx][ny] >= '0' && table[nx][ny] <= '9' ) {\n//            string copied = s;\n            find( ss, s, nx, ny, w, h );\n        }\n    }\n\n    ss.push_back( s );\n    s.erase( s.end() - 1 );\n}\n\ntemplate<typename T>\nstruct bun\n{\n    bool operator()( T const& l, T const& r ) {\n        return l.size() > r.size() || (l.size() == r.size() && l > r);\n    }\n};\n\nint main()\n{\n    for(;;) {\n        int w, h;\n        cin >> w >> h;\n        if ( w == 0 && h == 0 )\n            break;\n\n        clear();\n        cin.ignore(255, '\\n');\n        for( int y=0; y<h; ++y ) {\n            string s;\n            getline( cin, s );\n            for( int x=0; x<w; ++x ) {\n                table[x][y] = s[x];\n            }\n        }\n\n        vector<string> ss;\n        string s;\n        for( int x=0; x<w; ++x ) {\n            for( int y=0; y<h; ++y ) {\n                if ( table[x][y] >= '1' && table[x][y] <= '9' && !vd[x][y] ) {\n                    //find( ss, s, x, y, w, h );\n                }\n            }\n        }\n        stable_sort( ss.begin(), ss.end(), bun<string>() );\n\n        //for( int i=0; i<ss.size(); ++i )\n            //cout << ss[i] << endl;\n        //    ;\n\n\n        cout << ss[0] << endl;\n        //cout << \"======\" << endl;\n    };\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i, n) for(int i=0; i<(n); ++i)\n\nchar C[71][71];\nint W, H;\nbool isNum(char c) {\n    if(c >= '0' && c <= '9') return true;\n    else return false;\n}\nstring max_str(string a, string b) {\n    if(a.size() > b.size()) return a;\n    if(a.size() < b.size()) return b;\n    rep(i, a.size()) {\n        if(a[i] > b[i]) return a;\n        if(a[i] < b[i]) return b;\n    }\n    return a;\n}\nstring dfs(int y, int x, string sum) {\n    if((y+1>=H || !isNum(C[y+1][x])) && (x+1>=W || !isNum(C[y][x+1]))) {\n        return sum+C[y][x];\n    }\n    string down, right;\n    if(y+1<H && isNum(C[y+1][x])) {\n        if(sum == \"\" && C[y][x] == '0') down = dfs(y+1, x, sum);\n        else down = dfs(y+1, x, sum+C[y][x]);\n    }\n    if(x+1<W && isNum(C[y][x+1])) {\n        if(sum == \"\" && C[y][x] == '0') right = dfs(y, x+1, sum);\n        else right = dfs(y, x+1, sum+C[y][x]);\n    }\n    return max_str(down, right);\n}\n\nint main(void){\n    while(cin >> W >> H && W) {\n        rep(i, H)  rep(j, W) cin >> C[i][j];\n        string ans;\n        rep(i, H) rep(j, W) {\n            if(isNum(C[i][j])) ans = max_str(ans, dfs(i, j, \"\"));\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <list>\n#include <vector>\n#include <complex>\n#include <utility>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <climits>\n#include <bitset>\n#include <ctime>\n#include <map>\n#include <unordered_map>\n#include <set>\n#include <unordered_set>\n#include <cassert>\n#include <cstddef>\n#include <iomanip>\n#include <numeric>\n#include <tuple>\n#include <sstream>\n#include <fstream>\n\nusing namespace std;\n#define REP(i, n) for (int (i) = 0; (i) < (n); (i)++)\n#define FOR(i, a, b) for (int (i) = (a); (i) < (b); (i)++)\n#define RREP(i, a) for(int (i) = (a) - 1; (i) >= 0; (i)--)\n#define FORR(i, a, b) for(int (i) = (a) - 1; (i) >= (b); (i)--)\n#define DEBUG(C) cerr << #C << \" = \" << C << endl;\nusing LL = long long;\nusing VI = vector<int>;\nusing VVI = vector<VI>;\nusing VL = vector<LL>;\nusing VVL = vector<VL>;\nusing VD = vector<double>;\nusing VVD = vector<VD>;\nusing PII = pair<int, int>;\nusing PDD = pair<double, double>;\nusing PLL = pair<LL, LL>;\nusing VPII = vector<PII>;\ntemplate<typename T> using VT = vector<T>;\n#define ALL(a) begin((a)), end((a))\n#define RALL(a) rbegin((a)), rend((a))\n#define SORT(a) sort(ALL((a)))\n#define RSORT(a) sort(RALL((a)))\n#define REVERSE(a) reverse(ALL((a)))\n#define MP make_pair\n#define FORE(a, b) for (auto &&a : (b))\n#define FIND(s, e) ((s).find(e) != (s).end())\n#define EB emplace_back\ntemplate<typename T>inline bool chmax(T &a,T b){if(a<b){a=b;return true;}return false;}\ntemplate<typename T>inline bool chmin(T &a,T b){if(a>b){a=b;return true;}return false;}\n\nconst int INF = 1e9;\nconst int MOD = INF + 7;\nconst LL LLINF = 1e18;\n\nvoid init();\nvoid last();\n\nvoid init() {\n\n}\n\nconst int MAX = 75;\nchar C[MAX][MAX];\nstring dp[MAX][MAX];\n\nvoid comp(string &a, string b) {\n    if (a.length() < b.length()) a = b;\n    else if (a.length() == b.length()) {\n        const int L = a.length();\n        for (int i = 0; i < L; i++) {\n            if (a[i] < b[i]) {\n                a = b;\n                return;\n            } else if (a[i] > b[i]) {\n                return;\n            }\n        }\n    }\n}\n\nvoid solve(int H, int W) {\n    for (int i = 0; i < H; i++) {\n        scanf(\"%s\", C[i]);\n    }\n    auto inside = [&](int h, int w) {\n        return 0 <= h && h < H && 0 <= w && w < W;\n    };\n    for (int i = 0; i < H; i++) {\n        for (int j = 0; j < W; j++) {\n            dp[i][j] = \"\";\n        }\n    }\n    string ans = \"\";\n    for (int i = 0; i < H; i++) {\n        for (int j = 0; j < W; j++) {\n            if (isdigit(C[i][j])) {\n                dp[i][j] = C[i][j];\n                if (inside(i - 1, j)) comp(dp[i][j], dp[i - 1][j] + C[i][j]);\n                if (inside(i, j - 1)) comp(dp[i][j], dp[i][j - 1] + C[i][j]);\n            }\n            if (dp[i][j] == \"0\") dp[i][j] = \"\";\n            comp(ans, dp[i][j]);\n            //cout<<\"(i, j, dp[i][j]) = (\"<<i<<\", \"<<j<<\", \"<<dp[i][j]<<\")\"<<endl;\n        }\n    }\n    printf(\"%s\\n\", ans.c_str());\n}\n\nvoid last() {\n    exit(0);\n}\n\nint main(void) {\n\tint a, b, c, x, y, z, n, m, p;\n\tstring s;\n\twhile (cin >> n >> m, n) {\n\t\tsolve(m, n);\n\t\t//break;\n\t}\n    last();\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cctype>\n#include <string>\n#include <algorithm>\n\nusing namespace std;\n\nstring myMax(string a, string b)\n{\n\tif (a.length() < b.length()) return b;\n\tif (a.length() > b.length()) return a;\n\n\tfor (int i = 0; i < a.length(); i++){\n\t\tif (a[i] < b[i]){\n\t\t\treturn b;\n\t\t}\n\t\tif (a[i] > b[i]){\n\t\t\treturn a;\n\t\t}\n\t}\n\treturn a;\n}\n\nint main(void)\n{\n\tint w, h;\n\twhile (cin >> w >> h, w && h){\n\t\tstring field[80];\n\t\tfor (int i = 0; i < h; i++){\n\t\t\tcin >> field[i];\n\t\t}\n\t\tstring dp[80][80] = {};\n\t\tstring ret;\n\t\t// 右下からやる\n\t\tfor (int i = h-1; 0 <= i; i--){\n\t\t\tfor (int j = w-1; 0 <= j; j--){\n\t\t\t\tif ('0' <= field[i][j] && field[i][j] <= '9'){\n\t\t\t\t\tdp[i][j] = myMax(field[i][j] + dp[i][j + 1], field[i][j] + dp[i + 1][j]);\n\t\t\t\t}\n\t\t\t\tret = myMax(dp[i][j], ret);\n\t\t\t}\n\t\t}\n\n\t\t/*\n\t\tfor (int i = 0; i < h; i++){\n\t\t\tfor (int j = 0; j < w; j++){\n\t\t\t\tif (dp[i][j] != \"\") cout << dp[i][j] << \" \";\n\t\t\t\telse cout << \"* \";\n\t\t\t}\n\t\t\tputs(\"\");\n\t\t}\n\t\t*/\n\n\t\tbool pf = false;\n\t\tfor (int i = 0; i < ret.length(); i++){\n\t\t\tif (pf || ret[i] != '0'){\n\t\t\t\tcout << ret[i];\n\t\t\t\tpf = true;\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#define MAX_W 70\n#define MAX_H 70\nusing namespace std;\n\nstring c[MAX_H];\nstring secret_num;\nstring temp;\nbool visited[MAX_H][MAX_W];\n\nint p[2] = {-1, 0}, q[2] = {0, -1};\nint status;\n\nbool front_greater(string a, string b) {\n  for (int i = 0; i < a.size(); i++) {\n    int anum = a[i] - '0';\n    int bnum = b[i] - '0';\n    if (anum > bnum) return true;\n    if (anum < bnum) return false;\n  }\n  return false;\n}\n\nstring copy(string s) {\n  string temp;\n  for (int i = 0; i < s.size(); i++) {\n    temp.push_back(s[i]);\n  }\n  return temp;\n}\n\nstring set_number(string s) {\n  while (s[0] == '0') {\n    for (int i = 1; i < s.size(); i++) {\n      s[i - 1] = s[i];\n    }\n    s[s.size() - 1] = '\\0';\n  }\n  return s;\n}\n\nvoid judge(string s) {\n  s = set_number(s);\n  if (secret_num.size() < s.size()) {\n    secret_num = copy(s);\n  } else if (secret_num.size() == s.size()) {\n    if (front_greater(s, secret_num)) secret_num = copy(s);\n  }\n}\n\nstring erase_back(string s) {\n  int len = s.size();\n  string t;\n  for (int i = 0; i < len - 1; i++) {\n    t.push_back(s[i]);\n  }\n  return t;\n}\n\nstring myreverse(string s) {\n  string t;\n  int len = s.size();\n  for (int i = 0; i < len; i++) {\n    t.push_back(s[len - 1 - i]);\n  }\n  return t;\n}\n\nvoid dfs(int w, int h, int x, int y) {\n  visited[y][x] = true;\n  temp.push_back(c[y][x]);\n  for (int i = 0; i < 2; i++) {\n    int x2 = x + p[i];\n    int y2 = y + q[i];\n    if (0 <= x2 && x2 < w && 0 <= y2 && y2 < h\n\t&& visited[y2][x2] == false && '0' <= c[y2][x2] && c[y2][x2] <= '9') {\n      status = 0;\n      dfs(w, h, x2, y2);\n    } else if (status == 0) {\n      string s = myreverse(temp);\n      judge(s);\n      status = 1;\n    }\n  }\n  if (status == 1) {\n    temp = erase_back(temp);\n  }\n}\n\nvoid init() {\n  for (int i = 0; i < MAX_H; i++) {\n    c[i].erase();\n  }\n  for (int i = 0; i < MAX_H; i++) {\n    for (int j = 0; j < MAX_W; j++) {\n      visited[i][j] = false;\n    }\n  }\n  secret_num.erase();\n}\n\nint main() {\n  while (true) {\n    int w, h;\n    cin >> w >> h;\n    if (w == 0 && h == 0) return 0;\n\n    init();\n    for (int i = 0; i < h; i++) {\n      cin >> c[i];\n    }\n\n    for (int i = h - 1; i >= 0; i--) {\n      for (int j = w - 1; j >= 0; j--) {\n\tif (visited[i][j] == false) {\n\t  if ('0' <= c[i][j] && c[i][j] <= '9') {\n\t    status = 0;\n\t    dfs(w, h, j, i);\n\t  }\n\t}\n      }\n    }\n\n    cout << secret_num << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\n#include<algorithm>\n#define F first\n#define S second\nusing namespace std;\ntypedef pair<int,int> P;\ntypedef vector<vector<char> > VVC;\nint dx[] = {0,1};\nint dy[] = {1,0};\nvector<string> message;\nint h,w;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() != b.size())\n    return a.size() > b.size();\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] > b[i];\n}\n\nvoid dfs(string secret,P p,VVC& G)\n{\n  bool update = false;\n  for(int i=0;i<2;i++)\n    {\n      int nx = p.F + dx[i];\n      int ny = p.S + dy[i];\n      if(!(0 <= nx && nx < w && 0 <= ny && ny < h) || !('0'<=G[ny][nx] && G[ny][nx]<='9' ))\n\tcontinue;\n      update = true;\n      dfs(secret+G[ny][nx],P(nx,ny),G);\n    }\n\n  if(!update)\n    message.push_back(secret);\n}\n\nint main()\n{\n\n  while(cin >> w >> h,(w|h))\n    {\n      message.clear();\n      VVC G;\n      G.resize(h);\n      for(int i=0;i<h;i++)\n\t{\n\t  G[i].resize(w);\n\t  for(int j=0;j<w;j++)\n\t    cin >> G[i][j];\n\t}\n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\t      if('1' <= G[i][j] && G[i][j] <= '9')\n\t\t{\n\t\t  string message;\n\t\t  message += G[i][j];\n\t\t  dfs(message,P(j,i),G);\n\t\t}\n\t    }\n\t}\n\n      sort(message.begin(),message.end(),cmp);\n      cout << message[0] << endl;\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef pair<int,int> P;\n\nint main ()\n{\n    int n, m;\n    while (cin >> m >> n, n || m) {\n        vector<vector<char> > v (n, vector<char>(m, '#'));\n        for (int i = 0; i < n; i++) {\n            for (int j = 0; j < m; j++) {\n                char str;\n                cin >> str;\n                if ('0' <= str && str <= '9') {\n                    v[i][j] = str;\n                }\n            }\n        }\n\n        vector<vector<string> > dp(n, vector<string>(m, \"\"));\n\n        string res = \"\";\n\n        for (int i = 0; i < m; i++) {\n            if (v[0][i] != '#') {\n                if (v[0][i] == '0') {\n                    if (i > 0 && dp[0][i-1].size() > 0) {\n                        dp[0][i] = dp[0][i-1] + v[0][i];\n                    }\n                } else {\n                    if (i > 0) {\n                        dp[0][i] = dp[0][i-1] + v[0][i];\n                    } else {\n                        dp[0][i] = v[0][i];\n                    }\n                }\n            }\n            if (res.size() == dp[0][i].size()) {\n                res = max(res, dp[0][i]);\n            } else {\n                res = res.size() > dp[0][i].size() ? res : dp[0][i];\n            }\n        }\n\n        for (int i = 1; i < n; i++) {\n            if (v[i][0] != '#') {\n                if (v[i][0] == '0') {\n                    if (dp[i-1][0].size() > 0) dp[i][0] = dp[i-1][0] + v[i][0];\n                } else {\n                    dp[i][0] = dp[i-1][0] + v[i][0];\n                }\n            }\n            if (res.size() == dp[i][0].size()) {\n                res = max(res, dp[i][0]);\n            } else {\n                res = res.size() > dp[i][0].size() ? res : dp[i][0];\n            }\n        }\n\n        for (int i = 1; i < n; i++) {\n            for (int j = 1; j < m; j++) {\n                if (v[i][j] != '#') {\n                    string s1;\n                    if (dp[i-1][j].size() > 0 || v[i][j] != '0') s1 = dp[i-1][j] + v[i][j];\n                    string s2;\n                    if (dp[i][j-1].size() > 0 || v[i][j] != '0') s2 = dp[i][j-1] + v[i][j];\n\n                    if (s1.size() == s2.size()) {\n                        dp[i][j] = max(s1, s2);\n                    } else {\n                        dp[i][j] = s1.size() > s2.size() ? s1 : s2;\n                    }\n                    if (res.size() == dp[i][j].size()) {\n                        res = max(res, dp[i][j]);\n                    } else {\n                        res = res.size() > dp[i][j].size() ? res : dp[i][j];\n                    }\n                }\n            }\n        }\n\n        cout << res << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <cctype>\n\nusing namespace std;\n\n#define loop(i,a,b) for(int i=(a);i<int(b);i++)\n#define rep(i,b) loop(i,0,b)\n\nint W,H;\nstring c[70];\n\nbool comp(string const& a, string const& b){\n    if(a.size() != b.size()) return a.size() < b.size();\n    rep(i,a.size())if(a[i]!=b[i])return a[i] < b[i];\n    return false;\n}\n\nstring dp[70][70];\n\nstring rec(int x, int y){\n    if(dp[y][x]!=\"@\") return dp[y][x];\n    string& res = dp[y][x] = c[y][x];\n    if(y!=H-1 && isdigit(c[y+1][x])) res=max(res, c[y][x] + rec(x,y+1), comp);\n    if(x!=W-1 && isdigit(c[y][x+1])) res=max(res, c[y][x] + rec(x+1,y), comp);\n    return res;\n}\n\nint main(){\n    while(cin>>W>>H && W|H){\n        rep(i,H)cin>>c[i];\n        rep(i,H)rep(j,W)dp[i][j]=\"@\";\n        string ans = \"0\";\n        rep(i,H)rep(j,W)if(isdigit(c[i][j]) && c[i][j]!='0')ans=max(ans,rec(j,i), comp);\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#define _USE_MATH_DEFINES\n#define INF 100000000\n\n#include <iostream>\n#include <sstream>\n#include <cmath>\n#include <cstdlib>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <limits>\n#include <map>\n#include <string>\n#include <cstring>\n#include <set>\n#include <deque>\n#include <bitset>\n#include <list>\n#include <cctype>\n#include <utility>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair <int,int> P;\n\n\nstatic const double EPS = 1e-8;\n\nint tx[] = {-1,0,1,0};\nint ty[] = {0,1,0,-1};\n\nchar stage[101][101];\nint W,H;\n\nstring larger(const string& str1,const string& str2){\n\tif(str1.size() > str2.size()) return str1;\n\tif(str1.size() < str2.size()) return str2;\n\n\tfor(int i=0;i<str1.size();i++){\n\t\tif(str1[i] > str2[i] ) return str1;\n\t\tif(str1[i] < str2[i] ) return str2;\n\t}\n\n\treturn str1;\n}\n\nvoid dfs(int x,int y,string buf,string& res){\n\tbuf.push_back(stage[y][x]);\n\n\tif(y+1 < H && isdigit(stage[y+1][x])){\n\t\tdfs(x,y+1,buf,res);\t\t\n\t}\n\n\tif(x+1 < W && isdigit(stage[y][x+1])){\n\t\tdfs(x+1,y,buf,res);\n\t}\n\n\tres = larger(res,buf);\n}\n\nint main()\n{\n\twhile(~scanf(\"%d %d\",&W,&H)){\n\t\tif(W==H && H==0) break;\n\t\tfor(int y=0;y<H;y++){\n\t\t\tchar buf[128];\n\t\t\tscanf(\"%s\",buf);\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tstage[y][x] = buf[x];\n\t\t\t}\n\t\t}\n\n\t\tstring dp[101][101];\n\t\t//for(int x=0;x<W;x++) \n\t\t//\tif(isdigit(stage[0][x]) && stage[0][x] != '0'){\n\t\t//\tdp[1][x+1] = dp[0][x] + stage[0][x];\n\t\t//\tprintf(\"dp[%d][%d]=%s\\n\",0,x+1,dp[0][x+1].c_str());\n\t\t//}\n\n\t\t//for(int y=0;x<W;y++) \n\t\t//\tif(isdigit(stage[0][x]) && stage[0][x] != '0'){\n\t\t//\tdp[1][x+1] = dp[0][x] + stage[0][x];\n\t\t//\tprintf(\"dp[%d][%d]=%s\\n\",0,x+1,dp[0][x+1].c_str());\n\t\t//}\n\n\t\tfor(int y=0;y<H;y++){\n\t\t\tfor(int x=0;x<W;x++){\n\t\t\t\tstring left=\"\";\n\t\t\t\tif(isdigit(stage[y][x])){\n\t\t\t\t\tif(!(dp[y+1][x].size() == 0 && stage[y][x]=='0')){\n\t\t\t\t\t\tleft = dp[y+1][x] + stage[y][x];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstring up=\"\";\n\t\t\t\tif(isdigit(stage[y][x])){\n\t\t\t\t\tif(!(dp[y][x+1].size() == 0 && stage[y][x]=='0')){\n\t\t\t\t\t\tup = dp[y][x+1] + stage[y][x];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tdp[y+1][x+1] = larger(left,up);\n\t\t\t}\n\t\t}\n\n\t\tstring res=\"0\";\n\t\tfor(int y=0;y<=H;y++){\n\t\t\tfor(int x=0;x<=W;x++){\t\n\t\t\t\tres = larger(res,dp[y][x]);\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<string>\n\nusing namespace std;\n\nint w, h;\nvector<string> data;\nvector<vector<string> > str;\n\nstring get_large(const string& a, const string& b){\n  if(a.size() != b.size())\n    return (a.size() > b.size()) ? a : b;\n  for(int i=0; i<a.size(); ++i){\n    if(a[i] != b[i]) return (a[i] > b[i]) ? a : b;\n  }\n  return a;\n}\n\nstring dfs(int i, int j){\n  if(!(i>=0 && i<h)) return string();\n  if(!(j>=0 && j<w)) return string();\n  if(!(data[i][j]>='0' && data[i][j]<='9')) return string();\n  str[i][j] = data[i][j] + get_large(dfs(i+1, j), dfs(i, j+1));\n  return str[i][j];\n}\n\nstring solve(){\n  string ans = \"0\";\n  for(int i=0; i<h; ++i){\n    for(int j=0; j<w; ++j){\n      if(data[i][j]>='1' && data[i][j]<='9' &&\n\t str[i][j].empty()){\n\tans = get_large(ans, dfs(i, j));\n      }\n    }\n  }\n  return ans;\n}\n\nint main(){\n  while(1){\n    cin >> w >> h;\n    if(!w && !h) break;\n    data = vector<string>(h);\n    str = vector<vector<string> >(h, vector<string>(w));\n    for(int i=0; i<h; ++i) cin >> data[i];\n    cout << solve() << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <cctype>\nusing namespace std;\n\nchar matrix[70][70];\nstring dp[70][70];\n\nbool big(const string &s1, const string &s2){\n\tif(s1.size() != s2.size()){\n\t\treturn s1.size() < s2.size();\n\t}else{\n\t\tfor(int i = 0; i < s1.size(); i++){\n\t\t\tif(s1[i] != s2[i])\n\t\t\t\treturn s1[i] < s2[i];\n\t\t}\n\t}\n\treturn true;\n}\n\nint main(){\n\tint w, h;\n\twhile(cin >> w >> h && (w || h)){\n\t\tfor(int i = 1; i <= h; i++){\n\t\t\tfor(int j = 1; j <= w; j++){\n\t\t\t\tcin >> matrix[i][j];\n\t\t\t\tdp[i][j].clear();\n\t\t\t}\n\t\t}\n\t\tstring max;\n\t\tfor(int i = 1; i <= h; i++){\n\t\t\tfor(int j = 1; j <= w; j++){\n\t\t\t\tif(isdigit(matrix[i][j])){\n\t\t\t\t\tif(dp[i-1][j].empty() && dp[i][j-1].empty()){\n\t\t\t\t\t\tif(matrix[i][j] != '0'){\n\t\t\t\t\t\t\tdp[i][j].push_back(matrix[i][j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(big(dp[i][j-1], dp[i-1][j])){\n\t\t\t\t\t\t\tdp[i][j] = dp[i-1][j];\n\t\t\t\t\t\t\tdp[i][j].push_back(matrix[i][j]);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tdp[i][j] = dp[i][j-1];\n\t\t\t\t\t\t\tdp[i][j].push_back(matrix[i][j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(!big(dp[i][j], max)) max = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << max << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\n\nint w,h;\nstring ma;\nstring field[70];\n\nbool isdigit(char c){\n\tif(c >= '0' && c <= '9') return true;\n\telse return false;\n}\n\nvoid dfs(int x,int y,string s){\n\t//cout << x << \" \" << y << \" \" << s;\n\tif(!isdigit(field[x][y]) || (x == h - 1 && y == w - 1)){\n\t\tif(x == h - 1 && y == w - 1) s += field[x][y];\n\t\tif(ma.length() < s.length() || (ma.length() == s.length() && ma < s)) ma = s;\n\t\treturn;\n\t}\n\tif(x + 1 < h) dfs(x + 1,y,s + to_string(field[x][y] - '0'));\n\tif(y + 1 < w) dfs(x,y + 1,s + to_string(field[x][y] - '0'));\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(!w) break;\n\t\tma = \"\";\n\t\tfor(int i = 0;i < h;i++) cin >> field[i];\n\t\tfor(int i = 0;i < h;i++){\n\t\t\tfor(int j = 0;j < w;j++){\n\t\t\t\tif((i >= 1 && isdigit(field[i - 1][j])) || (j >= 1 && isdigit(field[i][j - 1]))) continue;\n\t\t\t\tif(isdigit(field[i][j])) dfs(i,j,\"\");\n\t\t\t}\n\t\t}\n\t\tbool flag = true;\n\t\tfor(int i = 0;i < ma.length();i++){\n\t\t\tif(ma[i] == '0' && flag) continue;\n\t\t\telse {\n\t\t\t\tflag = false;\n\t\t\t\tcout << ma[i];\n\t\t\t}\n\t\t}\n\t\tcout << endl;\n\t\t\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#ifdef LOCAL\n    #define _GLIBCXX_DEBUG\n    #define __clock__\n#else\n    #pragma GCC optimize(\"Ofast\")\n#endif\n#include<bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing VI = vector<ll>;\nusing VV = vector<VI>;\nusing VS = vector<string>;\nusing PII = pair<ll, ll>;\n\n// tourist set\ntemplate <typename A, typename B>\nstring to_string(pair<A, B> p);\n\ntemplate <typename A, typename B, typename C>\nstring to_string(tuple<A, B, C> p);\n\ntemplate <typename A, typename B, typename C, typename D>\nstring to_string(tuple<A, B, C, D> p);\n\nstring to_string(const string& s) {\n  return '\"' + s + '\"';\n}\n\nstring to_string(const char* s) {\n  return to_string((string) s);\n}\n\nstring to_string(bool b) {\n  return (b ? \"true\" : \"false\");\n}\n\nstring to_string(vector<bool> v) {\n  bool first = true;\n  string res = \"{\";\n  for (int i = 0; i < static_cast<int>(v.size()); i++) {\n    if (!first) {\n      res += \", \";\n    }\n    first = false;\n    res += to_string(v[i]);\n  }\n  res += \"}\";\n  return res;\n}\n\ntemplate <size_t N>\nstring to_string(bitset<N> v) {\n  string res = \"\";\n  for (size_t i = 0; i < N; i++) {\n    res += static_cast<char>('0' + v[i]);\n  }\n  return res;\n}\n\ntemplate <typename A>\nstring to_string(A v) {\n  bool first = true;\n  string res = \"{\";\n  for (const auto &x : v) {\n    if (!first) {\n      res += \", \";\n    }\n    first = false;\n    res += to_string(x);\n  }\n  res += \"}\";\n  return res;\n}\n\ntemplate <typename A, typename B>\nstring to_string(pair<A, B> p) {\n  return \"(\" + to_string(p.first) + \", \" + to_string(p.second) + \")\";\n}\n\ntemplate <typename A, typename B, typename C>\nstring to_string(tuple<A, B, C> p) {\n  return \"(\" + to_string(get<0>(p)) + \", \" + to_string(get<1>(p)) + \", \" + to_string(get<2>(p)) + \")\";\n}\n\ntemplate <typename A, typename B, typename C, typename D>\nstring to_string(tuple<A, B, C, D> p) {\n  return \"(\" + to_string(get<0>(p)) + \", \" + to_string(get<1>(p)) + \", \" + to_string(get<2>(p)) + \", \" + to_string(get<3>(p)) + \")\";\n}\n\nvoid debug_out() { cerr << '\\n'; }\n\ntemplate <typename Head, typename... Tail>\nvoid debug_out(Head H, Tail... T) {\n  cerr << \" \" << to_string(H);\n  debug_out(T...);\n}\n\n#ifdef LOCAL\n#define debug(...) cerr << \"[\" << #__VA_ARGS__ << \"]:\", debug_out(__VA_ARGS__)\n#else\n#define debug(...) 42\n#endif\n// tourist set end\n\ntemplate<class T>bool chmax(T &a, const T &b) { if (a<b) { a=b; return 1; } return 0; }\ntemplate<class T>bool chmin(T &a, const T &b) { if (b<a) { a=b; return 1; } return 0; }\n\n#define FOR(i,a,b) for(ll i=(a);i<(b);++i)\n#define rep(i,b) FOR(i, 0, b)\n#define ALL(v) (v).begin(), (v).end()\n#define p(s) cout<<(s)<<'\\n'\n#define p2(s, t) cout << (s) << \" \" << (t) << '\\n'\n#define br() p(\"\")\n#define pn(s) cout << (#s) << \" \" << (s) << '\\n'\n#define p_yes() p(\"YES\")\n#define p_no() p(\"NO\")\n#define SZ(x) ((int)(x).size())\n#define SORT(A) sort(ALL(A))\n#define RSORT(A) sort(ALL(A), greater<ll>())\n#define MP make_pair\n\nll SUM(VI& V){\n  return accumulate(ALL(V), 0LL);\n}\n\nvoid print_vector(VI& V){\n  ll n = V.size();\n  rep(i, n){\n    if(i) cout << ' ';\n    cout << V[i];\n  }\n  cout << endl;\n}\n\nll gcd(ll a,ll b){\n    if(b == 0) return a;\n    return gcd(b,a%b);\n}\n\nll lcm(ll a,ll b){\n    ll g = gcd(a,b);\n    return a / g * b;\n}\n\nvoid no(){p_no(); exit(0);}\nvoid yes(){p_yes(); exit(0);}\n\nconst ll mod = 1e9 + 7;\nconst ll inf = 1e18;\nconst double PI = acos(-1);\n\nbool ischar(char c){\n  if('0'<=c && c<='9'){\n    return true;\n  }else{\n    return false;\n  }\n}\n\nstring strip_zero(string s){\n  ll L = s.size();\n  if(L==0) return \"\";\n  rep(i,L){\n    char c = s[i];\n    if(c!='0'){\n      return s.substr(i);\n    }\n  }\n  return \"0\";\n}\n\n// 文字列を数字にしたときの大小比較\nstring str_max(string a, string b){\n  string c = strip_zero(a);\n  string d = strip_zero(b);\n  if(c.size()<d.size()){\n    // return d;\n    return b;\n  }else if(c.size()>d.size()){\n    // return c;\n    return a;\n  }else{\n    ll L = c.size();\n    rep(i,L){\n      if(c[i]>d[i]){\n        // return c;\n        return a;\n      }else if(c[i]<d[i]){\n        // return d;\n        return b;\n      }\n    }\n  }\n  // return c;\n  return a;\n}\n\nll W,H;\nVS S;\n\nstring dp[80][80];\nvoid reset(){\n  rep(i,80)rep(j,80)dp[i][j]=\"\";\n}\n\n// そこから作れる最大の文字列\n// 00001234など\nstring rec(ll i, ll j){\n  if(dp[i][j]!=\"\") return dp[i][j];\n  \n  bool can_right=false;\n  if(j+1<=W-1 && ischar(S[i][j+1])){\n    can_right = true;\n  }\n\n  bool can_lower=false;\n  if(i+1<=H-1 && ischar(S[i+1][j])){\n    can_lower = true;\n  }\n\n  string ret;\n  if(!can_right && !can_lower){\n    string a{S[i][j]};\n    ret = a;\n  }else if(!can_right && can_lower){\n    // 下にだけ行ける\n    ret = S[i][j] + rec(i+1, j);\n  }\n  else if(can_right && !can_lower){\n    // 右にだけ行ける\n    ret = S[i][j] + rec(i, j+1);\n  }\n  else{\n    // 右にも下にも行ける\n    string a = S[i][j] + rec(i, j+1);\n    string b = S[i][j] + rec(i+1, j);\n    ret = str_max(a,b); // ?\n  }\n  return dp[i][j] = ret;\n}\n\nint main(){\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n\n    // input\n    while(cin>>W>>H){\n      if(W==0) return 0;\n      S.resize(H);\n      rep(i,H){\n        cin>>S[i];\n      }\n\n      reset();\n\n      string ma = \"\";\n      rep(i,H){\n        rep(j,W){\n          char c = S[i][j];\n          if(ischar(c) && c!='0'){\n            string s = rec(i,j);\n            ma = str_max(ma, s);\n          }\n        }\n      }\n      p(ma);\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "//Name: The Secret Number\n//Level: 2\n//Category: 動的計画法,DP\n//Note:\n\n/*\n * あるマスを先頭とする文字列で最大のものは，\n *   ・そこから右に進み，それを先頭とした最大の文字列をくっつける\n *   ・そこから下に進み，それを先頭とした最大の文字列をくっつける\n * のどちらか．\n * ここで大小関係はまず文字列の長さで比較し，長さが同じときは辞書順により決定される．\n * 最大文字列を右下から決定していくとうまくDPに落としこめる．\n * 先頭が0の文字列の扱いに注意．\n *\n * オーダーは各マスをなめるのと，それぞれのマスで文字列の比較が発生するため O(WH(W+H))．\n * 文字列をいちいちコピーして生成せず，次のマスへのポインタだけ保持することで空間計算量を落としているが，\n * 時間計算量には変化がない割に面倒なのでよっぽどの事がない限りは普通に各マスごとに最大文字列を保持すればよい．\n * (コピーが生じないぶん定数倍高速化は発生する)\n */\n#include <iostream>\n#include <string>\n#include <vector>\n#include <cctype>\n\nusing namespace std;\n\nenum LINK {NONE, RIGHT, DOWN};\n\ninline bool in_range(int a, int x, int b) {\n    return a <= x && x < b;\n}\n\ninline void move(LINK link, pair<int,int> &pos) {\n    if(link == RIGHT) pos.second++;\n    else if(link == DOWN) pos.first++;\n    else if(link == NONE) {\n        pos.first = pos.second = -1;\n    }\n}\n\nLINK max_link(int r, int c, const vector<string> &matrix, const vector<vector<LINK> > &largest_link) {\n    const int H = (int)matrix.size();\n    const int W = (int)matrix[0].size();\n    LINK res = NONE;\n    pair<int,int> right_pos(r, c+1), down_pos(r+1, c);\n    while(true) {\n        bool right_dead = !in_range(0, right_pos.first, H) || !in_range(0, right_pos.second, W);\n        right_dead = right_dead || !isdigit(matrix[right_pos.first][right_pos.second]);\n        bool down_dead = !in_range(0, down_pos.first, H) || !in_range(0, down_pos.second, W);\n        down_dead = down_dead || !isdigit(matrix[down_pos.first][down_pos.second]);\n\n        if(right_dead && down_dead) {\n            break;\n        } else if(down_dead) {\n            res = RIGHT;\n            break;\n        } else if(right_dead) {\n            res = DOWN;\n            break;\n        } else {\n            res = (matrix[right_pos.first][right_pos.second] > matrix[down_pos.first][down_pos.second]) ? RIGHT : DOWN;\n        }\n        move(largest_link[right_pos.first][right_pos.second], right_pos);\n        move(largest_link[down_pos.first][down_pos.second], down_pos);\n    }\n    //cout << r << ' ' << c << ' ' << res << endl;\n    return res;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(0);\n    while(true) {\n        int W, H;\n        cin >> W >> H;\n        if(!W && !H) break;\n\n        vector<string> matrix(H);\n        for(int i = 0; i < H; ++i) {\n            cin >> matrix[i];\n        }\n        vector<vector<LINK> > largest_link(H, vector<LINK>(W, NONE));\n        vector<vector<int> > head(H, vector<int>(W, true));\n        for(int r = H-1; r >= 0; --r) {\n            for(int c = W-1; c >= 0; --c) {\n                if(isdigit(matrix[r][c])) {\n                    LINK link = max_link(r, c, matrix, largest_link);\n                    largest_link[r][c] = link;\n                    if(link != NONE) {\n                        if(link == RIGHT) head[r][c+1] = false;\n                        else if(link == DOWN) head[r+1][c] = false;\n                    }\n                }\n            }\n        }\n        string ans = \"\";\n        for(int r = 0; r < H; ++r) {\n            for(int c = 0; c < W; ++c) {\n                if(head[r][c]) {\n                    string buf(\"\");\n                    int rr = r, cc = c;\n                    buf += matrix[r][c];\n                    while(largest_link[rr][cc] != NONE) {\n                        if(largest_link[rr][cc] == RIGHT) ++cc;\n                        else ++rr;\n                        buf += matrix[rr][cc];\n                    }\n                    string::iterator it = buf.begin();\n                    while(it != buf.end() && *it == '0') ++it;\n                    buf.erase(buf.begin(), it);\n                    if(ans.size() < buf.size() || (ans.size() == buf.size() && ans < buf)) {\n                        ans = buf;\n                    }\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<cctype>\n#include<sstream>\nusing namespace std;\n\nint compare(string s1,string s2){\n  int start1,start2;\n  start1=start2=0;\n  for(int i=0;i<s1.size();i++){\n    if(s1[i]!='0')break;\n    start1++;\n  }\n  for(int i=0;i<s1.size();i++){\n    if(s2[i]!='0')break;\n    start2++;\n  }\n  s1=s1.substr(start1);\n  s2=s2.substr(start2);\n\n  if(s1.size()>s2.size())return 1;\n  if(s1.size()<s2.size())return -1;\n  for(int i=0;i<s1.size();i++){\n    if(s1[i]>s2[i])return 1;\n    if(s1[i]<s2[i])return -1;\n  }\n  return 0;\n}\n\nint main()\n{\n  int W,H;\n  string max;\n  while(cin>>W>>H,W|H){\n    vector< vector<char> >C(H,vector<char>(W,0));\n    vector< vector<string> >dp(H,vector<string>(W,\"\"));\n    max=\"\";\n    for(int i=0;i<H;i++)for(int j=0;j<W;j++)cin>>C[i][j];\n    if(isdigit(C[0][0]))dp[0][0]=C[0][0];\n    for(int j=1;j<W;j++){\n      if(isalpha(C[0][j]))continue;\n      dp[0][j]+=dp[0][j-1]+C[0][j];\n    }\n    for(int i=1;i<H;i++){\n      if(isalpha(C[i][0]))continue;\n      dp[i][0]+=dp[i-1][0]+C[i][0];\n    }\n    for(int i=1;i<H;i++){\n      for(int j=1;j<W;j++){\n\tif(isalpha(C[i][j]))continue;\n\tif( compare(dp[i-1][j]+C[i][j], dp[i][j-1]+C[i][j]) >= 0 ){\n\t  dp[i][j]=dp[i-1][j]+C[i][j];\n\t}else{\n\t  dp[i][j]=dp[i][j-1]+C[i][j];\n\t}\n\tif( compare(dp[i][j], max) >= 0 ){\n\t  max=dp[i][j-1]+C[i][j];\n\t}\n      }\n    }\n    int start=0;\n    for(int i=0;i<max.size();i++){\n      if(max[i]!='0')break;\n      start++;\n    }\n    max=max.substr(start);\n    cout<<max<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cmath>\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<cstring>\n#include<queue>\n#include<stack>\n\nusing namespace std;\n\n#define INF 999999999\n#define REP(i,n) for(int i=0; i<(int)(n); i++)\n\nvector<string> in(72);\nstring dp[72][72];\nstring ans;\n\nbool com(string a, string b){\n\tif(a.size() > b.size()) return true;\n\telse if(a.size() == b.size()){\n\t\tREP(i, a.size()){\n\t\t\tif(a[i] > b[i]) return true;\n\t\t\telse if(a[i] < b[i]) return false;\n\t\t}\n\t\treturn true;\n\t}\n\telse return false;\n}\n\nint main(){\n\tint i, j, w, h;\n\tstring p;\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(!w) break;\n\t\tREP(a,h){\n\t\t\tcin >> in[a+1];\n\t\t\tin[a+1].insert(in[a+1].begin(),'A');\n\t\t\tin[a+1].insert(in[a+1].end(),'A');\n\t\t}\n\t\tin[h+1] = \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\";\n\t\tin[0] = \"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\";\n\t\tREP(a,h+2) dp[a][0]=\"\";\n\t\tREP(a,w+2) dp[0][a]=\"\";\n\t\tdp[1][1] = \"\";\n\t\tans =\"\";\n\t\tfor(i=1;i<=h;i++){\n\t\t\tfor(j=1;j<=w;j++){\n\t\t\t\tif(in[i][j]-'0'>=0&&in[i][j]-'0'<=9){\n\t\t\t\t\tdp[i][j] = \"\";\n\t\t\t\t\tif(dp[i-1][j]!=\"\"){\n\t\t\t\t\t\tdp[i][j] = dp[i-1][j];\n\t\t\t\t\t}\n\t\t\t\t\tif(dp[i][j-1]!=\"\"){\n\t\t\t\t\t\tif(com(dp[i][j-1],dp[i][j])) dp[i][j] = dp[i][j-1];\n\t\t\t\t\t}\n\t\t\t\t\tif(!(dp[i][j]==\"\"&&in[i][j]=='0'))dp[i][j].insert(dp[i][j].end(), in[i][j]);\n\t\t\t\t}\n\t\t\t\telse dp[i][j] =\"\";\n\t\t\t}\n\t\t}\n\t\tans = \"\";\n\t\tfor(i=1;i<=h;i++){\n\t\t\tfor(j=1;j<=w;j++){\n\t\t\t\tif(com(dp[i][j],ans)) ans = dp[i][j];\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\t\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef pair<int,int> P;\n\nint main ()\n{\n    int n, m;\n    while (cin >> m >> n, n || m) {\n        vector<vector<char> > v (n, vector<char>(m, '#'));\n        for (int i = 0; i < n; i++) {\n            for (int j = 0; j < m; j++) {\n                char str;\n                cin >> str;\n                if ('0' <= str && str <= '9') {\n                    v[i][j] = str;\n                }\n            }\n        }\n\n        vector<vector<string> > dp(n, vector<string>(m, \"\"));\n\n        for (int i = 0; i < m; i++) {\n            if (v[0][i] != '#') {\n                if (v[0][i] == '0') {\n                    if (i > 0 && dp[0][i-1].size() > 0) {\n                        dp[0][i] = dp[0][i-1] + v[0][i];\n                    }\n                } else {\n                    if (i > 0) {\n                        dp[0][i] = dp[0][i-1] + v[0][i];\n                    } else {\n                        dp[0][i] = v[0][i];\n                    }\n                }\n            }\n        }\n\n        for (int i = 1; i < n; i++) {\n            if (v[i][0] != '#') {\n                if (v[i][0] == '0') {\n                    if (dp[i-1][0].size() > 0) dp[i][0] = dp[i-1][0] + v[i][0];\n                } else {\n                    dp[i][0] = dp[i-1][0] + v[i][0];\n                }\n            }\n        }\n\n        string res = \"\";\n\n        for (int i = 1; i < n; i++) {\n            for (int j = 1; j < m; j++) {\n                if (v[i][j] != '#') {\n                    string s1;\n                    if (dp[i-1][j].size() > 0 || v[i][j] != '0') s1 = dp[i-1][j] + v[i][j];\n                    string s2;\n                    if (dp[i][j-1].size() > 0 || v[i][j] != '0') s2 = dp[i][j-1] + v[i][j];\n\n                    if (s1.size() == s2.size()) {\n                        dp[i][j] = max(s1, s2);\n                    } else {\n                        dp[i][j] = s1.size() > s2.size() ? s1 : s2;\n                    }\n                    if (res.size() == dp[i][j].size()) {\n                        res = max(res, dp[i][j]);\n                    } else {\n                        res = res.size() > dp[i][j].size() ? res : dp[i][j];\n                    }\n                }\n            }\n        }\n\n        cout << res << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <iomanip>\n#include <vector>\n#include <map>\n#include <set>\n#include <queue>\n#include <bitset>\n#include <stack>\n#include <utility>\n#include <numeric>\n#include <algorithm>\n#include <functional>\n#include <cctype>\n#include <complex>\n#include <string>\n#include <sstream>\n\nusing namespace std;\n\n#define all(c) c.begin(),c.end()\n#define rall(c) c.rbegin(),c.rend()\n#define mp(a,b) make_pair((a),(b))\n#define eq ==\n\ntypedef long long ll;\ntypedef complex<double> point;\ntypedef pair<int,int> pii;\n\n\nconst double EPS = 1e-9;\n\nint toint(char c){\n    return c - '0';\n}\n\nstring maxs(string a,string b){\n    if(a.length() > b.length()) return a;\n    if(a.length() < b.length()) return b;\n    for(int i=0;i<a.length();i++){\n        if(a[i] > b[i]) return a;\n        if(a[i] < b[i]) return b;\n    }\n    return a;\n}\nstring dfs(vector<vector<char> > &C,int y,int x,\n        vector<vector<string> >& memo){\n    const int dx[] = {1,0};\n    const int dy[] = {0,1};\n    if(memo[y][x] != \"\") return memo[y][x];\n\n    string ret = \"\";\n    ret += C[y][x];\n    for(int i=0;i<2;i++){\n        if(isdigit(C[y+dy[i]][x+dx[i]])){\n            ret = maxs(ret,C[y][x]+dfs(C,y+dy[i],x+dx[i],memo));\n        }\n    }\n    return memo[y][x]=ret;\n}\n\nint main(){\n    while(true){\n        int W,H;\n        cin >> W >> H;\n        if(W == 0) break;\n        vector<vector<char> > C(H+2,vector<char>(W+2,'A'));\n        vector<vector<string> > memo(H+2,vector<string>(W+2));\n        for(int i=1;i<=H;i++){\n            for(int j=1;j<=W;j++){\n                cin >> C[i][j];\n            }\n        }\n        string ret;\n        for(int i=1;i<=H;i++){\n            for(int j=1;j<=W;j++){\n                if(isdigit(C[i][j])){\n                    ret = maxs(ret,dfs(C,i,j,memo));\n                }\n            }\n        }\n        for(int i=0;i<ret.size();i++){\n            if(ret[i] != '0') break;\n            ret = ret.substr(1,ret.size()-1);\n        }\n        cout << ret << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "//Name: The Secret Number\n//Level: 2\n//Category: 動的計画法,DP\n//Note:\n\n/*\n * あるマスを先頭とする文字列で最大のものは，\n *   ・そこから右に進み，それを先頭とした最大の文字列をくっつける\n *   ・そこから下に進み，それを先頭とした最大の文字列をくっつける\n * のどちらか．\n * ここで大小関係はまず文字列の長さで比較し，長さが同じときは辞書順により決定される．\n * 最大文字列を右下から決定していくとうまくDPに落としこめる．\n * 先頭が0の文字列の扱いに注意．\n *\n * オーダーは各マスをなめるのと，それぞれのマスで文字列の比較が発生するため O(WH(W+H))．\n * 文字列をいちいちコピーして生成せず，次のマスへのポインタだけ保持することで空間計算量を落としているが，\n * 時間計算量には変化がない割に面倒なのでよっぽどの事がない限りは普通に各マスごとに最大文字列を保持すればよい．\n * (コピーが生じないぶん定数倍高速化は発生する)\n */\n#include <iostream>\n#include <string>\n#include <vector>\n#include <cctype>\n\nusing namespace std;\n\nenum LINK {NONE, RIGHT, DOWN};\n\ninline bool in_range(int a, int x, int b) {\n    return a <= x && x < b;\n}\n\ninline void move(LINK link, pair<int,int> &pos) {\n    if(link == RIGHT) pos.second++;\n    else if(link == DOWN) pos.first++;\n    else if(link == NONE) {\n        pos.first = pos.second = -1;\n    }\n}\n\nLINK max_link(int r, int c, const vector<string> &matrix, const vector<vector<LINK> > &largest_link) {\n    const int H = (int)matrix.size();\n    const int W = (int)matrix[0].size();\n    LINK res = NONE;\n    pair<int,int> right_pos(r, c+1), down_pos(r+1, c);\n    while(true) {\n        bool right_dead = !in_range(0, right_pos.first, H) || !in_range(0, right_pos.second, W);\n        right_dead = right_dead || !isdigit(matrix[right_pos.first][right_pos.second]);\n        bool down_dead = !in_range(0, down_pos.first, H) || !in_range(0, down_pos.second, W);\n        down_dead = down_dead || !isdigit(matrix[down_pos.first][down_pos.second]);\n\n        if(right_dead && down_dead) {\n            break;\n        } else if(down_dead) {\n            res = RIGHT;\n            break;\n        } else if(right_dead) {\n            res = DOWN;\n            break;\n        } else {\n            if(res == NONE) res = (matrix[right_pos.first][right_pos.second] > matrix[down_pos.first][down_pos.second]) ? RIGHT : DOWN;\n        }\n        move(largest_link[right_pos.first][right_pos.second], right_pos);\n        move(largest_link[down_pos.first][down_pos.second], down_pos);\n    }\n    //cout << r << ' ' << c << ' ' << res << endl;\n    return res;\n}\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(0);\n    while(true) {\n        int W, H;\n        cin >> W >> H;\n        if(!W && !H) break;\n\n        vector<string> matrix(H);\n        for(int i = 0; i < H; ++i) {\n            cin >> matrix[i];\n        }\n        vector<vector<LINK> > largest_link(H, vector<LINK>(W, NONE));\n        vector<vector<int> > head(H, vector<int>(W, true));\n        for(int r = H-1; r >= 0; --r) {\n            for(int c = W-1; c >= 0; --c) {\n                if(isdigit(matrix[r][c])) {\n                    LINK link = max_link(r, c, matrix, largest_link);\n                    largest_link[r][c] = link;\n                    if(link != NONE) {\n                        if(link == RIGHT) head[r][c+1] = false;\n                        else if(link == DOWN) head[r+1][c] = false;\n                    }\n                }\n            }\n        }\n        string ans = \"\";\n        for(int r = 0; r < H; ++r) {\n            for(int c = 0; c < W; ++c) {\n                if(head[r][c]) {\n                    string buf(\"\");\n                    int rr = r, cc = c;\n                    buf += matrix[r][c];\n                    while(largest_link[rr][cc] != NONE) {\n                        if(largest_link[rr][cc] == RIGHT) ++cc;\n                        else ++rr;\n                        buf += matrix[rr][cc];\n                    }\n                    string::iterator it = buf.begin();\n                    while(it != buf.end() && *it == '0') ++it;\n                    buf.erase(buf.begin(), it);\n                    if(ans.size() < buf.size() || (ans.size() == buf.size() && ans < buf)) {\n                        ans = buf;\n                    }\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nint w, h;\n\nbool isNum(char c){return '0' <= c && c <= '9';}\n\nvoid solve() {\n  vector<string> mat(h);\n  for(int i=0;i<h;i++) cin>>mat[i];\n  \n  vector<vector<string> > dp(h, vector<string>(w));\n  if (isNum(mat[0][0])) dp[0][0] = mat[0][0];\n  \n  for (int i = 1; i < w; i += 1) {\n    if (isNum(mat[0][i])) {\n      dp[0][i] = dp[0][i-1] + mat[0][i];\n      if (dp[0][i][0] == '0') dp[0][i].erase(0, 1);\n    }\n  }\n  for (int i = 1; i < h; i += 1) {\n    if (isNum(mat[i][0])) {\n      dp[i][0] = dp[i-1][0] + mat[i][0];\n      if (dp[i][0][0] == '0') dp[i][0].erase(0, 1);\n    }\n  }\n  \n  for (int i = 1; i < h; i += 1) {\n    for (int j = 1; j < w; j += 1) {\n      if (isNum(mat[i][j])) {\n        if (dp[i-1][j].size() != dp[i][j-1].size()) {\n          if (dp[i-1][j].size() > dp[i][j-1].size()) {\n            dp[i][j] = dp[i-1][j];\n          } else {\n            dp[i][j] = dp[i][j-1];\n          }\n        } else {\n          dp[i][j] = max(dp[i-1][j], dp[i][j-1]);\n        }\n        if (dp[i][j].size() == 0 && mat[i][j] == '0') continue;\n        dp[i][j] += mat[i][j];\n        if (dp[i][j][0] == '0') dp[i][j].erase(0, 1);\n      }\n    }\n  }\n  \n  string max_s = \"\";\n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  if (max_s.size() < dp[i][j].size()) {\n    max_s = dp[i][j];\n  } else if (max_s.size() == dp[i][j].size()) {\n    max_s = max(max_s, dp[i][j]);\n  }\n  \n  /*\n  for(;;) {\n    if (max_s[0]!='0') break;\n    max_s.erase(0, 1);\n  }*/\n  \n  cout<<max_s<<endl;\n}\n\nint main (int argc, char const* argv[]) {\n  while (cin>>w>>h, w||h) {\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define rep(i,n) for(int i=0;i<(n);++i)\n#define loop for(;;)\n#define trace(var) cerr<<\">>> \"<<#var<<\" = \"<<var<<endl;\n#define all(v) begin(v),end(v)\n#define pb push_back\n#define inf (1e9)\n#define eps (1e-9)\n\ntypedef long long Integer ;\ntypedef long double Real;\nconst Real PI = acosl(-1);\ntypedef pair<int, int> P;\n\ntemplate<class S, class T> inline\nostream& operator<<(ostream&os, pair<S,T> p) {\n  return os << '(' << p.first << \", \" << p.second << ')';\n}\n\ntemplate<class S, class T, class U> inline\nostream& operator<<(ostream&os, tuple<S,T,U> t) {\n  return os << '('\n    << get<0>(t) << \", \"\n    << get<1>(t) << \", \"\n    << get<2>(t) << ')';\n}\n\ntemplate<class T> inline\nostream& operator<<(ostream&os, set<T> v) {\n  os << \"(set\";\n  for (T item: v) os << ' ' << item;\n  os << \")\";\n  return os;\n}\n\ntemplate<class T> inline\nostream& operator<<(ostream&os, vector<T> v) {\n  if (v.size() == 0) { return os << \"(empty)\"; }\n  os << v[0];\n  for (int i=1, len=v.size(); i<len; ++i) os << ' ' << v[i];\n  return os;\n}\n\ntemplate<class T> inline\nistream& operator>>(istream&is, vector<T>&v) {\n  rep (i, v.size()) is >> v[i];\n  return is;\n}\n\n//           ^   >  v   <\nint dx[] = { -1, 0, 1,  0 };\nint dy[] = {  0, 1, 0, -1 };\n\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<double> vd;\ntypedef vector<vd> vvd;\ntypedef vector<bool> vb;\n\nchar f[100][100];\n\nbool comp(string s, string t) {\n  if (s.size() != t.size()) return (s.size() < t.size());\n  rep (i, s.size()) if (s[i] != t[i]) return (s[i] < t[i]);\n  return true;\n}\n\nint main()\n{\n\n  int w, h;\n  while (cin >> w >> h, w and h)\n  {\n    rep (i, h) { rep (j, w) { cin >> f[i][j]; } }\n\n    stack<pair<P, string>> s;\n    rep (i, h) { rep (j, w) {\n      char c = f[i][j];\n      if (isdigit(c) and c != '0') s.push(make_pair(make_pair(i, j), \"\"));\n    }}\n\n    string ans = \"\";\n\n    while (not s.empty()) {\n      auto p = s.top(); s.pop();\n      int i = p.first.first;\n      int j = p.first.second;\n      string str = p.second + f[i][j];\n      bool ap = false;\n      if (i < h-1 and isdigit(f[i+1][j])) {\n        s.push(make_pair(make_pair(i+1, j), str));\n        ap = true;\n      }\n      if (j < w-1 and isdigit(f[i][j+1])) {\n        s.push(make_pair(make_pair(i, j+1), str));\n        ap = true;\n      }\n      if (not ap) {\n        if (comp(ans, str)) ans = str;\n      }\n    }\n\n    cout << ans << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i, n) for(int i=0; i<(n); ++i)\n\nchar C[71][71];\nstring memo[71][71];\nint W, H;\nbool isNum(char c) {\n    if(c >= '0' && c <= '9') return true;\n    else return false;\n}\nstring max_str(string a, string b) {\n    if (a.size() > b.size()) return a;\n    if (a.size() < b.size()) return b;\n    return max(a, b);\n}\nstring dfs(int y, int x) {\n    if(memo[y][x] != \"\") return memo[y][x];\n    if((y+1>=H || !isNum(C[y+1][x])) && (x+1>=W || !isNum(C[y][x+1]))) {\n        memo[y][x] = C[y][x];\n        return memo[y][x];\n    }\n    string ans = \"\";\n    if(y+1<H && isNum(C[y+1][x])) ans = max_str(ans, C[y][x]+dfs(y+1, x));\n    if(x+1<W && isNum(C[y][x+1])) ans = max_str(ans, C[y][x]+dfs(y, x+1));\n    memo[y][x] = ans;\n    return memo[y][x];\n}\n\nint main(void){\n    while(cin >> W >> H && W) {\n        rep(i, H) rep(j, W) {\n            cin >> C[i][j];\n            memo[i][j] = \"\";\n        }\n        string ans;\n        for(int i=H-1; i>=0; --i) {\n            for(int j=W-1; j>=0; --j) {\n                if(isNum(C[i][j]) && memo[i][j]==\"\") {\n                    ans = max_str(ans, dfs(i, j));\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n\n\nusing namespace std;\n\nint const N = 71;\nchar table[N][N];\n\nvoid clear() {\n    for( int i=0; i<N; ++i )\n        for( int j=0; j<N; ++j )\n            table[i][j] = 0;\n}\n\nint const dir[][2] = {{1,0}, {0, 1}};\nvoid find( vector<string>& ss, string& s, int const x, int const y, int const w, int const h )\n{\n    s += table[x][y];\n    //table[x][y] = 0;\n\n    for( int i=0; i<2; ++i ) {\n        int const nx = x + dir[i][0];\n        int const ny = y + dir[i][1];\n        if ( nx < 0 || ny < 0 || nx >= w || ny >= h )\n            continue;\n        \n        if ( table[nx][ny] >= '0' && table[nx][ny] <= '9' ) {\n            string copied = s;\n            find( ss, copied, nx, ny, w, h );\n        }\n    }\n\n    ss.push_back( s );\n}\n\ntemplate<typename T>\nstruct bun\n{\n    bool operator()( T const& l, T const& r ) {\n        return l.size() > r.size() || (l.size() == r.size() && l > r);\n    }\n};\n\nint main()\n{\n    for(;;) {\n        int w, h;\n        cin >> w >> h;\n        if ( w == 0 && h == 0 )\n            break;\n\n        clear();\n        for( int y=0; y<h; ++y ) {\n            string s;\n            cin >> s;\n            for( int iii=0; iii<s.size(); ++iii ) {\n                table[iii][y] = s[iii];\n            }\n        }\n\n        vector<string> ss;\n        for( int x=0; x<N; ++x ) {\n            for( int y=0; y<N; ++y ) {\n                string s;\n                if ( table[x][y] >= '1' && table[x][y] <= '9' ) {\n                    find( ss, s, x, y, w, h );\n                }\n            }\n        }\n        stable_sort( ss.begin(), ss.end(), bun<string>() );\n\n        for( int i=0; i<ss.size(); ++i )\n            //cout << ss[i] << endl;\n            ;\n\n\n        cout << ss[0] << endl;\n        //cout << \"======\" << endl;\n    };\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\nusing namespace std;\n\nint W,H;\nstring s[71][71];\nchar in[71][71];\n\nbool comp2(string s, string r){\n\tif(s.size() != r.size()) return s.size() > r.size();\n\treturn s > r;\n\t\n}\n\nbool comp(string s, string r){\n\twhile(s[0]=='0' && isdigit(s[1])) s = s.substr(1);\n\twhile(r[0]=='0' && isdigit(r[1])) r = r.substr(1);\n\treturn comp2(s, r);\n}\nmain(){\n\tint i,j,k;\n\twhile(cin>>W>>H, W){\n\t\tfor(i=0;i<H;i++) cin>>in[i];\n\t\tstring m=\"0\";\n\t\tfor(int h=H;h>=0;h--)\n\t\t\tfor(int w=W;w>=0;w--)\n\t\t\t\ts[h][w] = \"\";\n\t\tfor(int h=H-1;h>=0;h--)\n\t\t\tfor(int w=W-1;w>=0;w--){\n\t\t\t\tif(!isdigit(in[h][w])) continue;\n\t\t\t\tif(comp(in[h][w]+s[h+1][w],m)) m = (in[h][w]+s[h+1][w]);\n\t\t\t\tif(comp(in[h][w]+s[h][w+1],m)) m = (in[h][w]+s[h][w+1]);\n\t\t\t\ts[h][w] = (comp2(in[h][w]+s[h+1][w] , in[h][w]+s[h][w+1])) ? (in[h][w]+s[h+1][w]) : (in[h][w]+s[h][w+1]);\n\t\t\t}\n\t\twhile(m[0]=='0' && isdigit(m[1])) m = m.substr(1);\n\t\tcout<<m<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define each(itr,v) for(auto itr:v)\n#define pb(s) push_back(s)\n#define mp(a,b) make_pair(a,b)\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define maxch(x,y) x=max(x,y)\n#define minch(x,y) x=min(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt(x) bitset<32>(x).count()\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> P;\ntypedef pair<P, int> PPI;\ntypedef pair<ll, ll> PL;\ntypedef pair<P, ll> PPL;\n\n#define INF INT_MAX/3\n\n#define MAX_N 1000\n\nint w,h;\nstring s[77];\n\nstring bigger(string s1,string s2){\n\tif(s1.length()>s2.length())return s1;\n\telse if(s1.length()<s2.length())return s2;\n\telse if(s1>s2)return s1;\n\telse return s2;\n}\n\nint main(){\n\tcin.sync_with_stdio(false);\n\twhile(1){\n\t\tcin>>w>>h;\n\t\tif(w==0)break;\n\t\trep(i,h)cin>>s[i];\n\t\tstring res=\"\";\n\t\tstring dp[77][77];\n\t\trep(i,h)rep(j,w){\n\t\t\tstring ss=bigger(dp[i+1][j],dp[i][j+1]);\n\t\t\tif(!isdigit(s[i][j])||(s[i][j]=='0'&&ss==\"\"))continue;\n\t\t\tdp[i+1][j+1]=ss+s[i][j];\n\t\t\tres=bigger(res,ss+s[i][j]);\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<stdio.h>\n#include<ctype.h>\n#include<algorithm>\n#include<vector>\n#include<map>\nusing namespace std;\ntypedef pair<int,int>S;\nint main()\n{\n\tint H,W,i,j;\n\tchar a[99][99];\n\twhile(scanf(\"%d%d\",&W,&H),W)\n\t{\n\t\tfor(i=0;i<H;++i)scanf(\"%s\",a[i]);\n\t\tint dp[99][99]={};\n\t\tfor(i=H-1;i>=0;--i)\n\t\t\tfor(j=W-1;j>=0;--j)\n\t\t\t\tif(isdigit(a[i][j]))\n\t\t\t\t\tdp[i][j]=max(dp[i+1][j],dp[i][j+1])+1;\n\t\tvector<S>u,v;\n\t\tfor(i=0;i<H;++i)\n\t\t\tfor(j=0;j<W;++j)\n\t\t\t\tu.push_back(S(j,i));\n\t\tint f=1;\n\t\tfor(; u.size(); u=v,v.clear(),f=0)\n\t\t{\n\t\t\tint maxC=1,maxD=0;\n\t\t\tfor(i=0;i<u.size();++i)\n\t\t\t{\n\t\t\t\tS s=u[i];\n\t\t\t\tint x=s.first,y=s.second;\n\t\t\t\tif(f&&a[y][x]=='0')continue;\t\n\t\t\t\tif(maxC<dp[y][x])\n\t\t\t\t{\n\t\t\t\t\tmaxC=dp[y][x];\n\t\t\t\t\tmaxD=a[y][x];\n\t\t\t\t}\n\t\t\t\telse if(maxC==dp[y][x]&&maxD<a[y][x])\n\t\t\t\t\tmaxD=a[y][x];\n\t\t\t}\n\t\t\tif(!maxD)break;\n\t\t\tputchar(maxD);\n\t\t\tfor(i=0;i<u.size();++i)\n\t\t\t{\n\t\t\t\tS s=u[i];\n\t\t\t\tint x=s.first,y=s.second;\n\t\t\t\tif(dp[y][x]==maxC&&a[y][x]==maxD)\n\t\t\t\t{\n\t\t\t\t\tv.push_back(S(x+1,y));\n\t\t\t\t\tv.push_back(S(x,y+1));\n\t\t\t\t}\n\t\t\t}\n\t\t\tsort(v.begin(),v.end());\n\t\t\tv.erase(unique(v.begin(),v.end()),v.end());\n\t\t}\n\t\tputs(\"\");\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <vector>\n#include <map>\n#include <set>\n#include <string>\n#include <cstring>\n#include <sstream>\n#include <algorithm>\n#include <functional>\n#include <queue>\n#include <stack>\n#include <cmath>\n#include <iomanip>\n#include <list>\n#include <tuple>\n#include <bitset>\n\nusing namespace std;\n\ninline bool cheak(int x, int y, int xMax, int yMax){ return x >= 0 && y >= 0 && xMax > x && yMax > y; }\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout << x; return sout.str(); }\ntemplate<class T> inline T sqr(T x) { return x*x; }\n\ntypedef pair<int, int> P;\ntypedef tuple<int, int, int> T;\ntypedef long long ll;\ntypedef unsigned long long ull;\n\n#define For(i,a,b)\tfor(int (i) = (a);i < (b);(i)++)\n#define rep(i,n)\tFor(i,0,n)\n#define clr(a)\t\tmemset((a), 0 ,sizeof(a))\n#define mclr(a)\t\tmemset((a), -1 ,sizeof(a))\n#define all(a)\t\t(a).begin(),(a).end()\n#define sz(a)\t\t(sizeof(a))\n#define Fill(a,v)\tfill((int*)a,(int*)(a+(sz(a)/sz(*(a)))),v)\n\nconst int dx[8] = { -1, 0, -1, 0, 1, 1, -1, -1 }, dy[8] = { 0, -1, 0, 1, -1, 1, -1, 1 };\nconst int mod = 1000000007;\nconst int INF = 1e9;\n\nstring c[71];\nint w, h;\n\nstring d[71][71];\n\nint str_compare(string s1, string s2){\n\n\tif (s1.size() > s2.size())return 1;\n\tif (s1.size() < s2.size())return 0;\n\n\twhile (s1[0] == '0'){\n\t\ts1 = s1.substr(1, s1.size() - 1);\n\t}\n\twhile (s2[0] == '0'){\n\t\ts2 = s2.substr(1, s2.size() - 1);\n\t}\n\n\tif (s1.size() == s2.size()){\n\t\tif (s1 > s2)return 1;\n\t\tif (s1 < s2)return 0;\n\t\tif (s1 == s2)return -1;\n\t}\n}\n\nvoid func(int y,int x){\n\n\t\n\trep(i, 2){\n\t\tint ty = y + dy[i], tx = x + dx[i];\n\t\tif (cheak(tx, ty, w, h) && (c[ty][tx] >= '0' && c[ty][tx] <= '9')){\n\n\t\t\tstring t = (c[ty][tx]) + d[y][x];\n\t\t\tif (str_compare(d[ty][tx],t ) == 0){\n\t\t\t\td[ty][tx] = t;\n\t\t\t\tfunc(ty, tx);\n\t\t\t}\n\n\t\t}\n\t}\n}\n\nint main()\n{\n\twhile (cin >> w >> h && (w || h)){\n\t\trep(y, h){\n\t\t\tcin >> c[y];\n\t\t\trep(x,w)\n\t\t\tif (c[y][x] >= '0' && c[y][x] <= '9')d[y][x] = c[y][x];\n\t\t}\n\t\tfor (int y = h - 1; y >= 0; y--)\n\t\tfor (int x = w - 1; x >= 0; x--)if (c[y][x] >= '0' && c[y][x] <= '9'){\n\t\t\tfunc(y, x);\n\t\t}\n\n\t\tstring ans = \"0\";\n\n\t\trep(y, h)rep(x, w)if (c[y][x] >= '0' && c[y][x] <= '9') {\n\t\t\tif (str_compare(ans, d[y][x]) == 0){\n\t\t\t\tans = d[y][x];\n\t\t\t}\n\t\t}\n\t\twhile (ans[0] == '0'){\n\t\t\tans = ans.substr(1, ans.size() - 1);\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<algorithm>\n#include<vector>\n#define F first\n#define S second\nusing namespace std;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() == 0 && b.size() == 0)\n    return true;\n  else if(a.size() == 0)\n    return true;\n  else if(b.size() == 0)\n    return false;\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] < b[i];\n  return false;\n}\n\nint main()\n{\n\n  int w,h;\n  while(cin >> w >> h,(w || h))\n    {\n      \n      char G[h][w];\n      string ans=\"0\";\n      string dp[h][w];\n\n      for(int i=0;i<h;i++)\n\t{\n\tfor(int j=0;j<w;j++)\n\t  {\n\t    cin >> G[i][j];\n\t    if('0' <= G[i][j] && G[i][j] <= '9')\n\t      {\n\t\tdp[i][j] = G[i][j];\n\t\tans = max(ans,dp[i][j],cmp);\n\t      }\n\t\n\t  }\n\n\t}\n     \n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\n\t      if(!('0' <= G[i][j] && G[i][j] <= '9'))\n\t\tcontinue;\n\t      \n\t      dp[i][j] = max(dp[i][j],max((i-1>=0 &&('0'<= G[i-1][j] && G[i-1][j] <= '9') ?dp[i-1][j]:\"\")+dp[i][j],\n\t\t\t\t\t  (j-1>=0 &&('0'<= G[i][j-1] && G[i][j-1] <= '9') ?dp[i][j-1]:\"\")+dp[i][j],cmp),cmp);\t      \n\t      //ans = max(ans,dp[i][j],cmp);\n\n\t    }\n\t}\n\n      ans = \"\";\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\t      if('0' <= G[i][j] && G[i][j] <= '9')\n\t\t{\n\t\t  string a;\n\t\t  if(dp[i][j] != \"0\" && dp[i][j][0] == '0')\n\t\t    {\n\n\t\t      for(int k=0;dp[i][j][k] == '0';k++)\n\t\t\tdp[i][j][k] = ' ';\t\t    \n\t\t      stringstream ss;\n\t\t      ss << dp[i][j];\n\t\t      a = ss.str();\n\t\t    }\n\t\t  else\n\t\t    a = dp[i][j];\n\t\t  ans = max(ans,a);\n\n\t\t}\n\t    }\n\t}\n\n      cout << ans << endl;\n      continue;\n\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <cstring>\n#include <iostream>\n\nusing namespace std;\n\nbool compare(string S1, string S2)\n{\n\tif (S1.size() != S2.size()) { return S1.size() > S2.size(); }\n\n\treturn S1 > S2;\n}\n\nint main()\n{\n\tint H, W; char R[71][71];\n\n\twhile (true)\n\t{\n\t\tscanf(\"%d\", &W);\n\t\tscanf(\"%d\", &H);\n\n\t\tif (H == 0 && W == 0) { break; }\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tscanf(\"%s\", R[i]);\n\t\t}\n\n\t\tchar dp[71][71][140];\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (isdigit(R[i][j]))\n\t\t\t\t{\n\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][j][0] = R[i][j];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfor (int k = 0; k < strlen(dp[i - 1][j]); k++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdp[i][j][k] = dp[i - 1][j][k];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tdp[i][j][(int)strlen(dp[i - 1][j])] = R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]) && dp[i - 1][j] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfor (int k = 0; k < strlen(dp[i - 1][j]); k++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdp[i][j][k] = dp[i - 1][j][k];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tdp[i][j][(int)strlen(dp[i - 1][j])] = R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (j != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfor (int k = 0; k < strlen(dp[i][j - 1]); k++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdp[i][j][k] = dp[i][j - 1][k];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tdp[i][j][(int)strlen(dp[i][j - 1])] = R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]) && dp[i][j - 1] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tfor (int k = 0; k < strlen(dp[i][j - 1]); k++)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tdp[i][j][k] = dp[i][j - 1][k];\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tdp[i][j][(int)strlen(dp[i][j - 1])] = R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ret = \"\";\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (compare(dp[i][j], ret))\n\t\t\t\t{\n\t\t\t\t\tret = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%s\\n\", ret.c_str());\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<stdio.h>\n#include<string>\nusing namespace std;\nint H,W;\nchar t[700][700],ch;\n\nstring dp[700][700],maxm;\n\nstring strmax(string x,string y){\n  if(x==\"-\"&&y==\"-\")return \"-\";\n  if(x==\"-\")return y;\n  if(y==\"-\")return x;\n  while(x[0]=='0'&&x.size()>=2)x=x.substr(1,x.size()-1);\n  while(y[0]=='0'&&y.size()>=2)y=y.substr(1,y.size()-1);\n  if(x.size()==y.size()){\n    for(int i=0;i<(int)x.size();i++){\n      if(x[i]>y[i]){\n\treturn x;\n      }else if(x[i]<y[i]){\n\treturn y;\n      }\n    }\n    return x;\n  }else if(x.size()>y.size()){\n    return x;\n  }else{\n    return y;\n  }\n}\n\nchar judge(char ch){\n  if('0'<=ch&&ch<='9')return ch;\n  else return '-';\n}\nint main(){\n  int flg;\n  while(cin>>W>>H&&W&&H){\n    scanf(\"%c\",&t[0][0]);\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\tdp[i][j]=\"\";\n\tscanf(\"%c\",&t[i][j]);\n\tif(judge(t[i][j])=='-')flg++;\n      }\n      scanf(\"%c\",&ch);\n    }\n   \n    dp[0][0].push_back(judge(t[0][0])); \n\n    for(int i=1;i<W;i++){\n      if(judge(t[0][i])=='-'){\n\tdp[0][i]=\"-\";\n\tcontinue;\n      }\n      if(dp[0][i-1]!=\"-\")dp[0][i]=dp[0][i-1];      \n      dp[0][i].push_back(judge(t[0][i]));\n    }\n    for(int i=1;i<H;i++){\n      if(judge(t[i][0])=='-'){\n\tdp[i][0]=\"-\";\n\tcontinue;\n      }\n      if(dp[i-1][0]!=\"-\")dp[i][0]=dp[i-1][0];      \n      dp[i][0].push_back(judge(t[i][0]));\n    }\n\n    maxm=\"0\";\n    for(int i=1;i<H;i++){\n      for(int j=1;j<W;j++){\n\tif(judge(t[i][j])=='-'){\n\t  dp[i][j]=\"-\";\n\t  continue;\n\t}\n\t\n\tdp[i][j]=strmax(dp[i-1][j],dp[i][j-1]);\n\tif(dp[i][j]!=\"-\")dp[i][j].push_back(t[i][j]);\n\t\n\n      }\n    }\n    for(int i=0;i<H;i++){\n      for(int j=0;j<W;j++){\n\t//cout<<dp[i][j]<<endl;\n\tmaxm=strmax(dp[i][j],maxm);\n      }\n    }\n    cout<<strmax(maxm,maxm)<<endl;\n    \n  }\n  return 0;\n  \n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<vector>\n#include<map>\n#include<algorithm>\n#define F first\n#define S second\nusing namespace std;\ntypedef pair<int,int> P;\ntypedef vector<vector<char> > VVC;\nint dx[] = {0,1};\nint dy[] = {1,0};\nstring message;\nint h,w;\n\nbool check(string a,string b)\n{\n  if(a.size() != b.size())\n    return a.size() > b.size();\n\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] > b[i];\n  return true;\n}\n\nvoid dfs(string secret,P p,VVC& G)\n{\n  bool update = false;\n  for(int i=0;i<2;i++)\n    {\n      int nx = p.F + dx[i];\n      int ny = p.S + dy[i];\n      if(!(0 <= nx && nx < w && 0 <= ny && ny < h) || !('0'<=G[ny][nx] && G[ny][nx]<='9' ))\n\tcontinue;\n\n      update = true;\n      dfs(secret+G[ny][nx],P(nx,ny),G);\n    }\n\n  if(!update)\n    {\n      if(!check(message,secret))\n\t{\n\t  message = secret;\n\t}\n    }\n}\n\nint main()\n{\n\n  while(true)\n    {\n      cin >> w >> h;\n      if(w+h == 0)\n\tbreak;\n      message = \"0\";\n      VVC G;\n      G.resize(h);\n      for(int i=0;i<h;i++)\n\t{\n\t  G[i].resize(w);\n\t  for(int j=0;j<w;j++)\n\t    cin >> G[i][j];\n\t}\n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\t      if('1' <= G[i][j] && G[i][j] <= '9')\n\t\t{\n\t\t  string mes;\n\t\t  mes += G[i][j];\n\t\t  dfs(mes,P(j,i),G);\n\t\t}\n\t    }\n\t}\n\n    \n      cout << message << endl;\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<vector>\n#define F first\n#define S second\nusing namespace std;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] < b[i];\n  return true;\n}\n\nint main()\n{\n  int w,h;\n  while(cin >> w >> h,(w || h))\n    {\n      char G[h][w];\n      string ans;\n      string dp[h][w];\n\n      for(int i=0;i<h;i++)\n\t{\n\tfor(int j=0;j<w;j++)\n\t  {\n\t    cin >> G[i][j];\n\t    if('0' <= G[i][j] && G[i][j] <= '9')\n\t      dp[i][j] = G[i][j];\n\t    else \n\t      dp[i][j] = \"0\";\n\t  }\n\t}\n\n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\n\t      if(!('0' <= G[i][j] && G[i][j] <= '9'))\n\t\tcontinue;\n\t      //cout << \"IN \" << i << \" - \" << j << endl;\n\n\t      dp[i][j] = max(dp[i][j],max((i-1>=0?dp[i-1][j]:\"\")+dp[i][j],\n\t\t\t\t\t  (j-1>=0?dp[i][j-1]:\"\")+dp[i][j],cmp),cmp);\t      \n\t      //cout <<\"dp[\"<<i<<\"][\"<<j<<\"] = \"<< dp[i][j] << endl;\n\t      //cout << \"OUT\" << endl;\n\t      ans = max(ans,dp[i][j],cmp);\n\n\t    }\n\t}\n\n      //cout << ans << endl;\n      bool f = false;\n      for(int i=0;i<ans.size();i++)      \n\tif(ans[i] == '0' && !f)\n\t  continue;\n\telse  \n\t  {\n\t    f = true;\n\t    cout << ans[i];\n\t  }\n\tcout << endl;\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\nusing namespace std;\n\nint main(){\n  int W, H;\n  while(cin >> W >> H, W){\n    vector<string> C(H);\n    for(int i = 0; i < H; ++i)\n      cin >> C[i];\n    string dp[H][W];\n    for(int i = 0; i < H; ++i){\n      for(int j = 0; j < W; ++j){\n\tif(C[i][j] < '0' || C[i][j] > '9') continue;\n\tstring s = string(1,C[i][j]), t = string(1,C[i][j]);\n\tif(i > 0 && dp[i-1][j] != \"0\") s = dp[i-1][j] + C[i][j];\n\tif(j > 0 && dp[i][j-1] != \"0\") t = dp[i][j-1] + C[i][j];\n\tif(s.size() == t.size()) dp[i][j] = max(s,t);\n\telse{\n\t  if(s.size() > t.size()) dp[i][j] = s;\n\t  else dp[i][j] = t;\n\t}\n      }\n    }\n    string ans = \"\";\n    for(int i = 0; i < H; ++i){\n      for(int j = 0; j < W; ++j){\n\tif(ans.size() == dp[i][j].size()) ans = max(ans,dp[i][j]);\n\telse{\n\t  if(ans.size() < dp[i][j].size()) ans = dp[i][j];\n\t}\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define fi first\n#define se second\n#define repl(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define each(itr,v) for(auto itr:v)\n#define pb(s) push_back(s)\n#define mp(a,b) make_pair(a,b)\n#define all(x) (x).begin(),(x).end()\n#define dbg(x) cout<<#x\"=\"<<x<<endl\n#define maxch(x,y) x=max(x,y)\n#define minch(x,y) x=min(x,y)\n#define uni(x) x.erase(unique(all(x)),x.end())\n#define exist(x,y) (find(all(x),y)!=x.end())\n#define bcnt(x) bitset<32>(x).count()\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> P;\ntypedef pair<P, int> PPI;\ntypedef pair<ll, ll> PL;\ntypedef pair<P, ll> PPL;\n\n#define INF INT_MAX/3\n\n#define MAX_N 1000\n\nint w,h;\nstring s[77];\n\nint d[4]={0,1,0};\nbool vis[77][77];\n\nbool is_big(string s1,string s2){\n\tif(s1.length()==s2.length()){\n\t\tint i=0;\n\t\twhile(i<s1.length()&&s1[i]==s2[i])i++;\n\t\treturn i==s1.length()||s1[i]>=s2[i];\n\t}else return s1.length()>s2.length();\n}\n\nstring dfs(int i,int j){\n\tvis[i][j]=true;\n\tstring res=\"\";\n\trep(dd,2){\n\t\tint ni=i+d[dd],nj=j+d[dd+1];\n\t\tif(ni<0||ni>=h||nj<0||nj>=w||!isdigit(s[ni][nj])||vis[ni][nj])continue;\n\t\tstring a=dfs(ni,nj);\n\t\tif(is_big(a,res))res=a;\n\t}\n\tvis[i][j]=false;\n\treturn s[i][j]+res;\n}\n\nint main(){\n\tcin.sync_with_stdio(false);\n\twhile(1){\n\t\tcin>>w>>h;\n\t\tif(w==0)break;\n\t\trep(i,h)cin>>s[i];\n\t\tstring res=\"\";\n\t\tmemset(vis,0,sizeof(vis));\n\t\trep(i,h)rep(j,w){\n\t\t\tif(!isdigit(s[i][j]))continue;\n\t\t\tif((i>0&&isdigit(s[i-1][j]))||(j>0&&isdigit(s[i][j-1])))continue;\n\t\t\tstring a=dfs(i,j);\n\t\t\tif(is_big(a,res))res=a;\n\t\t}\n\t\tcout<<res<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <iostream>\n#include <cmath>\n#include <ctype.h>\n#include <string> \n#include <sstream>\n#include <iostream>\n#include <algorithm>\n#include <cstdlib>\n#include <map>\n#include <queue>\n#include <utility>\n#include <vector>\n#include <set>\n#include <list>\n#include <cstring>\n#include <stack>\n   \nusing namespace std;\n\nint w, h;\nchar c[71][71];\nstring result[71][71];\n\nbool compare(string s1, string s2)\n{\n    int l1 = s1.length(), l2 = s2.length();\n    if(l1 > l2) return true;\n    else if(l1 < l2) return false;\n    else {\n        for(int i = 0; i < l1; i++){\n            if(s1[i] > s2[i]) return true;\n            else if(s1[i] < s2[i]) return false;\n        }\n    }\n    return true;\n}\n\nbool ismax(string s1, string s2)\n{\n    while(s1 != \"\" && s1[0] == '0'){\n        s1 = s1.substr(1);\n    }\n    while(s2 != \"\" && s2[0] == '0'){\n        s2 = s2.substr(1);\n    }\n    if(s1 == \"\") s1 = \"0\";\n    if(s2 == \"\") s2 = \"0\";\n    int l1 = s1.length(), l2 = s2.length();\n    if(l1 > l2) return true;\n    else if(l1 < l2) return false;\n    else {\n        for(int i = 0; i < l1; i++){\n            if(s1[i] > s2[i]) return true;\n            else if(s1[i] < s2[i]) return false;\n        }\n    }\n    return true; \n}\n \nstring solve(int x, int y)\n{\n    if(result[x][y] != \"\") return result[x][y];\n    // cout << now << endl;\n    string now = \"\", now2 = \"\";\n    now += c[x][y];\n    now2 += c[x][y];\n    if(x + 1 < h && isdigit(c[x + 1][y])){\n        now += solve(x + 1, y);\n    }\n    if(y + 1 < w && isdigit(c[x][y + 1])){\n        now2 += solve(x, y + 1);\n    }\n    if(compare(now, now2)) result[x][y] = now;\n    else result[x][y] = now2;\n    return result[x][y];\n}\n\nint main()\n{\n    while(1){\n        cin >> w >> h;\n        if(w == 0 && h == 0) break;\n        for(int i = 0; i < h; i++){\n            for(int j = 0; j < w; j++){\n                cin >> c[i][j];\n                result[i][j] = \"\";\n            }\n        }\n        string ans = \"0\";\n        for(int i = 0; i < h; i++){\n            for(int j = 0; j < w; j++){\n                if(isdigit(c[i][j])){\n                    string nows = solve(i, j);\n                    if(ismax(nows, ans)) ans = nows;\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nstring remover(string s){\n\tstring ret;\n\tint i;\n\tfor(i=0;i<s.size() && s[i] == '0';i++);\n\tfor(;i<s.size();i++){\n\t\tret += s[i];\n\t}\n\treturn ret;\n}\n\nbool comp(string s1, string s2){\n\tif(s1.size() > s2.size()) return true;\n\tif(s1.size() < s2.size()) return false;\n\tfor(int i=0;i<s1.size();i++){\n\t\tif(int(s1[i] - '0') > int(s2[i] - '0')) return true;\n\t\tif(int(s1[i] - '0') < int(s2[i] - '0')) return false;\n\t}\n\treturn false;\n}\n\nint main(){\n\tint w,h;\n\twhile(cin >> w >> h,w > 0 && h > 0){\n\t\tvector<string> c(h);\n\t\tfor(int i=0;i<h;i++){\n\t\t\tcin >> c[i];\n\t\t}\n\t\tstring ans = \"\";\n\t\tstring num[70][70];\n\t\tfor(int i=h-1;i>=0;i--){\n\t\t\tfor(int j=w-1;j>=0;j--){\n\t\t\t\tif(c[i][j] < '0' || c[i][j] > '9') continue;\n\t\t\t\tif(j!=w-1 && i!=h-1){\n\t\t\t\t\tif(comp(num[i][j+1],num[i+1][j])){\n\t\t\t\t\t\tnum[i][j] = c[i][j] + num[i][j+1];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnum[i][j] = c[i][j] + num[i+1][j];\n\t\t\t\t\t}\n\t\t\t\t} else if(j!=w-1){\n\t\t\t\t\tnum[i][j] = c[i][j] + num[i][j+1];\n\t\t\t\t} else if(i!=h-1){\n\t\t\t\t\tnum[i][j] = c[i][j] + num[i+1][j];\n\t\t\t\t} else {\n\t\t\t\t\tnum[i][j] = c[i][j];\n\t\t\t\t}\n\t\t\t\tif(comp(num[i][j],ans)){\n\t\t\t\t\tans = num[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << remover(ans) << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "\n// The Secret Number\n// http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=1126\n\n#include<iostream>\n#include<vector>\n\nusing namespace std;\n\nint W, H;\nvector<string> matrix;\nvector<vector<string>> memo;\n\nint dx[2] = {1, 0};\nint dy[2] = {0, 1};\n\ninline bool is_out_of_range(int x, int y) {\n    return (x < 0 || x >= W || y < 0 || y >= H);\n}\n\nstring cmp(string a, string b) {\n    if (a.size() > b.size()) return a;\n    if (a.size() < b.size()) return b;\n    return max(a, b);\n}\n\nstring dfs(int x, int y) {\n    if (is_out_of_range(x, y)) return \"\";\n    if (!isdigit(matrix[y][x])) return \"\";\n    if (memo[y][x] != \"\") return memo[y][x];\n\n    string res = \"\";\n    for (int d = 0; d < 2; ++d) {\n        res = cmp(res, matrix[y][x] + dfs(x + dx[d], y + dy[d]));\n    }\n    memo[y][x] = res;\n    return res;\n}\n\nint main() {\n    while (cin >> W >> H && W) {\n        matrix = vector<string>(H, \"\"); \n        memo.assign(H, vector<string>(W, \"\"));\n        for (int h = 0; h < H; ++h) {\n            cin >> matrix[h];\n        }\n\n        string ans = \"\";\n        for (int y = 0; y < H; ++y) {\n            for (int x = 0; x < W; ++x) {\n                if (matrix[y][x] == '0' || !isdigit(matrix[y][x])) continue;\n                ans = cmp(ans, dfs(x, y));\n            }\n        }\n\n        cout << ans << endl;\n    }\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <cstring>\n#include <string>\n#include <algorithm>\n#include <iomanip>\nusing namespace std;\n\nstring b[70];\nstring memo[70][70];\n\nbool comp(string s1, string s2) {\n\tif(s1.size() == s2.size()) return s1 < s2;\n\treturn s1.size() < s2.size();\n}\n\nint main() {\n\tcin.tie(0);\n\tios::sync_with_stdio(false);\n\n\tint W, H;\n\twhile(cin >> W >> H, W | H) {\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tcin >> b[i];\n\t\t}\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tfor(int j = 0; j < W; j++) {\n\t\t\t\tmemo[i][j] = \"\";\n\t\t\t\tif('1' <= b[i][j] && b[i][j] <= '9') memo[i][j] += b[i][j];\n\t\t\t}\n\t\t}\n\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tfor(int j = 0; j < W; j++) {\n\t\t\t\tif('0' <= b[i][j] && b[i][j] <= '9') {\n\t\t\t\t\tif(i + 1 < H) {\n\t\t\t\t\t\tif('0' <= b[i + 1][j] && b[i + 1][j] <= '9') {\n\t\t\t\t\t\t\tmemo[i + 1][j] = max(memo[i + 1][j], memo[i][j] + b[i + 1][j], comp);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(j + 1 < W) {\n\t\t\t\t\t\tif('0' <= b[i][j + 1] && b[i][j + 1] <= '9') {\n\t\t\t\t\t\t\tmemo[i][j + 1] = max(memo[i][j + 1], memo[i][j] + b[i][j + 1], comp);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ans = \"\";\n\t\tfor(int i = 0; i < H; i++) {\n\t\t\tfor(int j = 0; j < W; j++) {\n\t\t\t\tans = max(ans, memo[i][j], comp);\n\t\t\t}\n\t\t}\n\n\t\tcout << ans << endl;\n\t}\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n \nstd::string str[128][128];\nchar field[128][128];\nint W, H;\n \nvoid Load() {\n  scanf(\"%d %d\", &W, &H);\n  for(int i = 0; i < H; ++i) {\n    scanf(\"%s\", field[i]);\n  }\n}\n \nvoid init() {\n  for(int i = 0; i < H; ++i) {\n    for(int j = 0; j < W; ++j) {\n      str[i][j].clear();\n    }\n  }\n}\nstd::string& greater(std::string& a, std::string& b) {\n  if( a.size() != b.size() ) {\n    if( a.size() < b.size() ) return b;\n    else return a;\n  }\n  if( a < b ) {\n    return b;\n  }\n  return a;\n}\n \nvoid solve() {\n  for(int r = 0; r < H; ++r) {\n    for(int c = 0; c < W; ++c) {\n      if( not ( '0' <= field[r][c] and field[r][c] <= '9' ) ) continue;\n      std::string t1;\n      std::string t2;\n      if( 0 <= c - 1 ) {\n        t1 = str[r][c-1];\n      }\n      if( 0 <= r - 1 ) {\n        t2 = str[r-1][c];\n      }\n      std::string t = greater(t1, t2);\n      if( t.size() == 0 and field[r][c] == '0' ) continue;\n      str[r][c] = greater(t1, t2) + field[r][c];\n    }\n  }\n}\n \nint main() {\n  for(;;) {\n    init();\n    Load();\n    if( W == 0 and H == 0 ) break;\n    solve();\n    std::string ans;\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        ans = greater(ans, str[i][j]);\n      }\n    }\n    if( ans.empty() ) {\n      std::cout << 0 << std::endl;\n    }\n    std::cout << ans << std::endl;\n  }  \n   \n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a; i<b; ++i)\n#define rep(i,n) REP(i,0,n)\n\nchar input[70][70];\nstring dp[70][70];\n\nint comp(string s,string t) {\n  if(s.length() != t.length()) return (s.length() - t.length());\n  rep(i,s.length()) if(s[i] != t[i]) return (s[i] - t[i]);\n  return 0;\n}\n\nint main() {\n  int w,h,n;\n  while(cin>>w>>h, w|h) {\n    string s,above,left;\n    rep(i,h) {\n      cin>>s;\n      rep(j,w) {\n\tdp[i][j] = \"\";\n\tinput[i][j] = s[j];\n      }\n    }\n\n    rep(i,h) rep(j,w) {\n      char c = input[i][j];\n      if(!(c <= '9' && c >= '0')) continue;\n      above = ((i > 0 && dp[i-1][j] != \"0\") ? dp[i-1][j] : \"\") + string(1,c);\n      left = ((j > 0 && dp[i][j-1] != \"0\") ? dp[i][j-1] : \"\") + string(1,c);\n      dp[i][j] = (comp(above,left) <= 0) ? left : above;\n      //if(dp[i][j][0] == '0') dp[i][j] = dp[i][j].substr(1);\n    }\n\n    string ans = \"\";\n    rep(i,h) rep(j,w) if(comp(ans,dp[i][j]) < 0) ans = dp[i][j];\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\nclass ln{\nprivate:\n  long long d[10];\n  int len;\npublic:\n  ln(){\n  len=0;\n  for(int i=0;i<10;i++)\n    d[i]=0;\n  }\n  ln big(ln a,ln b){\n    if(a.len>b.len)\n      return a;\n    else if(a.len<b.len)\n      return b;\n    else {\n      for(int i=0;i<10;i++){\n\t  if(a.d[i]>b.d[i])\n\t    return a;\n\t  else if(a.d[i]<b.d[i])\n\t    return b;\n      }\n      return a;\n    }\n  }\n  void plus(int b){\n    if(b=='0'&&d[0]==0) return;\n    //  cout<<(char)b;\n    int tmp=len/10;\n    d[tmp]*=10;\n    d[tmp]+=(b-'0');\n    //    cout<<b-'0'<<endl;\n    len++;\n  }  \n  void print(){\n    for(int i=0;i<(len-1)/10+1;i++){\n      if(d[i])   cout<<d[i];\n      else if((len-1)/10+1-i>1) \n\tcout<<\"0000000000\";\n      else for(int k=0;k<len%10;k++)\n\t     cout<<\"0\";\n    }\n    cout<<endl;\n  }\n};\nint main(){\n  int w,h;\n  char input[75][75];\n \n  //\n  while(1){\n  \n    cin>>w>>h;\n    ln out[75][75];\n    ln maxval;\n    if(w==0&&h==0){ //cout<<endl;\n      return 0;}\n    for(int i=0;i<w+1;i++)\n      input[0][i]=0;\n    for(int i=1;i<h+1;i++){\n      input[i][0]=0;\n      cin>>(char*)(input[i]+1);\n    }\n    // for(int i=0;i<h+1;i++)\n    //   cout<<input[i]+1<<endl;\n    for(int i=1;i<=w+h;i++)\n      for(int j=1;j<i;j++)\n\tif(input[j][i-j]>='0'&&input[j][i-j]<='9') \n\t  {\n\t    if(j>h||i-j>w) continue;\n\t    //cout<<j<<\" j  \"<<i-j<<endl;\n\t    out[j][i-j]=out[0][0].big(out[j-1][i-j],out[j][i-j-1]);\n\t    out[j][i-j].plus(input[j][i-j]);    \n\t    //  out[j][i-j].print();\n\t    maxval=out[0][0].big(out[j][i-j],maxval);\n\t    //  maxval.print();\n\t  }\n     maxval.print();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll, ll> l_l;\ntypedef pair<int, int> i_i;\ntypedef pair<int, string> i_S;\n\n#define EPS (1e-7)\n#define INF (1e9)\n#define PI (acos(-1))\n//const ll mod = 1000000007;\nint H, W;\nstring field[72];\ni_S dp[72][72];\n\n\nint main() {\n    //cout.precision(10);\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    while(true) {\n        cin >> W >> H;\n        if(W == 0) break;\n        for(int h = 1; h <= H; h++) {\n            cin >> field[h];\n            field[h] = \"&\" + field[h];\n        }\n        for(int h = 1; h <= 71; h++) {\n            for(int w = 1; w <= 71; w++) {\n                dp[h][w] = {0, \"\"};\n            }\n        }\n        i_S ans = {0, \"\"};\n        for(int h = H; h >= 1; h--) {\n            for(int w = W; w >= 1; w--) {\n                if(field[h][w] <= 'Z' && field[h][w] >= 'A') continue;\n                i_S now = max(dp[h+1][w], dp[h][w+1]);\n                now.first++;\n                now.second = field[h][w] + now.second;\n                if(now.second[0] != '0') ans = max(ans, now);\n                dp[h][w] = now;\n            }\n        }\n        cout << ans.second << endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define DIGIT(c) (c >= '0' && c <= '9')\n#define F first\n#define S second\n#define INF 1 << 30\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nint W, H;\nchar c[100][100];\n\nstring judge(string a, string b){\n  if(a[0] == '0') a.erase(a.begin());\n  if(b[0] == '0') b.erase(b.begin());\n  if(a.size() > b.size()) return a;\n  if(a.size() < b.size()) return b;\n  \n  rep(i, a.size()){\n    if(a[i] > b[i]) return a;\n    if(a[i] < b[i]) return b;\n  }\n  return a;\n}\n\nint main(){\n  while(scanf(\"%d%d\", &W, &H) && W+H){\n    rep(i, H) scanf(\"%s\", c[i]);\n\n    vector<vector<string> >dp(H, vector<string>(W, \"\"));\n    if(DIGIT(c[0][0])) dp[0][0] = c[0][0];\n    REP(i, 1, W) if(DIGIT(c[0][i])) dp[0][i] = dp[0][i-1] + c[0][i];\n    REP(i, 1, H) if(DIGIT(c[i][0])) dp[i][0] = dp[i-1][0] + c[i][0];\n\n    REP(i, 1, H){\n      REP(j, 1, W){\n\tif(!DIGIT(c[i][j])) continue;\n\tdp[i][j] = judge((dp[i-1][j]+c[i][j]), (dp[i][j-1]+c[i][j]));\n\t//\tcout << i << \" \" << j << \" \" << dp[i-1][j]+c[i][j] << \" \" << dp[i][j-1]+c[i][j] << endl;\n      }\n    }\n\n\n    /*    rep(i, H){\n      rep(j, W) cout << dp[i][j] << \" \";\n      puts(\"\");\n      }*/\n\n    string res = \"\";\n    rep(i, H) rep(j, W) res = judge(res, dp[i][j]);\n    //    if(res[0] == '0') res.erase(res.begin());\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\n\nstring kansu( string s, string t ) {\n\n  if ( s.size() > t.size() ) return s;\n  if ( s.size() < t.size() ) return t;\n\n  for ( long long int i = 0; i < s.size(); i++ ) {\n    if ( s[i] > t[i] ) return s;\n    if ( s[i] < t[i] ) return t;\n  }\n\n  return s;\n\n}\n\nint main() {\n\n  while( true ) {\n\n    long long int w, h;\n    cin >> w >> h;\n    if ( w == 0 ) break;\n\n    vector< string > c;\n\n    for ( long long int i = 0; i < h; i++ ) {\n\n      string in;\n      cin >> in;\n      c.push_back( in );\n\n    }\n\n    vector< vector< string > > m;\n    for ( long long int i = 0; i < h+1; i++ ) {\n      vector< string > m2;\n      for ( long long int j = 0; j < w+1; j++ ) {\n\tm2.push_back( \"\" );\n      }\n      m.push_back( m2 );\n    }\n\n    string ans = \"\";\n\n    for ( long long int y = 0; y < h; y++ ) {\n      for ( long long int x = 0; x < w; x++ ) {\n\n\tif ( '0' <= c[y][x] && c[y][x] <= '9' ) {\n\n\t  if ( c[y][x] == '0' && m[y][x] == \"\" ) {\n\t  }else {\n\t    string k = m[y][x] + c[y][x];\n\t    m[y+1][x] = kansu( m[y+1][x], k );\n\t    m[y][x+1] = kansu( m[y][x+1], k );\n\t    ans = kansu( ans, k );\n\t  }\n\n\t}\n\n      }\n    }\n\n    cout << ans << endl;\n\n  }\n\n  return 0;\n\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <cstring>\nusing namespace std;\n\n#define MAX_H 70\n#define MAX_W 70\n\nint h, w;\nstring field[MAX_H];\nstring cache[MAX_H][MAX_W];\n\nbool non_zero(char c) {\n    return (isdigit(c) && c != '0');\n}\n\nbool non_zero(string s) {\n    if (s.empty() || s[0] == '0') return false;\n    for (string::iterator si = s.begin(); si != s.end(); si++) {\n        if (! isdigit(*si) ) {\n            return false;\n        }\n    }\n    return true;\n}\n\nbool bigger(string a, string b) {\n    if (a.size() > b.size()) return true;\n    if (a.size() < b.size()) return false;\n    else return (a>b);\n}\n\nint main() {\n    while (cin >> w >> h) {\n        if (w == 0 && h == 0) break;\n        for (int i = 0; i < h; i++) {\n            cin >> field[i];\n            for (int j = 0; j < w; j++) {\n                if (non_zero(field[i][j])) {\n                    cache[i][j] = field[i][j];\n                } else {\n                    cache[i][j] = \"\";\n                }\n            }\n        }\n\n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n                if (isdigit(field[i][j])) {\n                    string u, l;\n                    if (1 <= i && i < h && non_zero(cache[i-1][j])) {\n                        u = cache[i-1][j] + field[i][j];\n                        if (!bigger(cache[i][j], u)) {\n                            cache[i][j] = u;\n                        }\n                    }\n                    if (1 <= j && j < w && non_zero(cache[i][j-1])) {\n                        l = cache[i][j-1] + field[i][j];\n                        if (!bigger(cache[i][j], l)) {\n                            cache[i][j] = l;\n                        }\n                    }\n                }\n            }\n        }\n\n        string biggest = \"\";\n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n//                if (cache[i][j] == \"\") {\n//                    cout << 0 << ' ';\n//                } else {\n//                    cout << cache[i][j] << ' ';\n//                }\n                if (bigger(cache[i][j], biggest)) {\n                    biggest = cache[i][j];\n                }\n            }\n//            cout << endl;\n        }\n\n//        for (int i = 0; i < h; i++) {\n//            for (int j = 0; j < w; j++) {\n//                cout << field[i][j] << ' ';\n//            }\n//            cout << endl;\n//        }\n\n        cout << biggest << endl;\n    }\n    return 0;\n}\n\n    "
  },
  {
    "language": "C++",
    "code": "\n#include<iostream>\n#include<cctype>\nusing namespace std;\n\nbool compare(string s1,string s2){\n  if(s1.size()>s2.size())return true;\n  if(s1.size()<s2.size())return false;\n  for(int i=0;i<s1.size();i++){\n    if(s1[i]>s2[i])return true;\n    if(s1[i]<s2[i])return false;\n  }\n  return false;\n}\n\nint main()\n{\n  int W,H;\n  char C[70][70];\n  string max,dp[70][70];\n  while(cin>>W>>H,W|H){\n    max=\"\";\n    for(int i=0;i<H;i++)for(int j=0;j<W;j++){\n      cin>>C[i][j];\n      dp[i][j]=\"\";\n    }\n    if(isdigit(C[0][0]))dp[0][0]=C[0][0];\n    for(int j=1;j<W;j++){\n      if(isalpha(C[0][j]))continue;\n      dp[0][j]+=dp[0][j-1]+C[0][j];\n    }\n    for(int i=1;i<H;i++){\n      if(isalpha(C[i][0]))continue;\n      dp[i][0]+=dp[i-1][0]+C[i][0];\n    }\n    for(int i=1;i<H;i++){\n      for(int j=1;j<W;j++){\n\tif(isalpha(C[i][j]))continue;\n\tif( compare(dp[i-1][j]+C[i][j], dp[i][j-1]+C[i][j]) > 0 ){\n\t  dp[i][j]=dp[i-1][j]+C[i][j];\n\t}else{\n\t  dp[i][j]=dp[i][j-1]+C[i][j];\n\t}\n\tif( compare(dp[i][j], max) > 0 ){\n\t  max=dp[i][j-1]+C[i][j];\n\t}\n      }\n    }\n    int start=0;\n    for(int i=0;i<max.size();i++){\n      if(max[i]!='0')break;\n      start++;\n    }\n    max=max.substr(start);\n    cout<<max<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a; i<b; ++i)\n#define rep(i,n) REP(i,0,n)\n\nchar input[70][70];\nstring dp[70][70];\n\nint comp(string s,string t) { // comp s and t if s < t return negative\n  if(s.length() != t.length()) return (s.length() - t.length());\n  rep(i,s.length()) if(s[i] != t[i]) return (s[i] - t[i]);\n  return 0;\n}\n\nint main() {\n  int w,h,n;\n  while(cin>>w>>h, w|h) {\n    string s;\n    rep(i,h) {\n      cin>>s;\n      rep(j,w) {\n\tdp[i][j] = \"\";\n\tinput[i][j] = s[j];\n      }\n    }\n\n    rep(i,h) {\n      rep(j,w) {\n\tchar c = input[i][j];\n\tif(i == 0 && j == 0) {\n\t  if(c <= '9' && c >= '0') dp[i][j] = string(1,c);\n\t}else{\n\t  if(!(c <= '9' && c >= '0')) continue;\n\t  string ab = \"\",left = \"\";\n\t  if(i > 0) ab = dp[i-1][j] + string(1,c);\n\t  if(j > 0) left = dp[i][j-1] + string(1,c);\n\t  /*\n\t  if(comp(ab,left) <= 0) {\n\t    dp[i][j] = left;\n\t  }else{\n\t    dp[i][j] = ab;\n\t  }\n\t  */\n\n\t  dp[i][j] = (comp(ab,left) <= 0) ? left : ab;\n\t  if(dp[i][j][0] == '0') dp[i][j] = dp[i][j].substr(1);\n\t}\n      }\n    }\n\n    string ans = \"\";\n    rep(i,h) rep(j,w) { if(comp(ans,dp[i][j]) < 0) ans = dp[i][j]; }\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\n#include <stack>\n#include <queue>\n#include <map>\n#include <cmath>\n#include <string>\n#include <sstream>\n#include <iomanip>\n#include <complex>\nusing namespace std;\n\n#define ll long long\n#define vvi vector< vector<int> >\n#define vi vector<int>\n#define All(X) X.begin(),X.end()\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define REP(i,n) for(int i=0;i<(int)(n);i++)\n#define pb push_back\n#define pii pair<int,int>\n#define mp make_pair\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a/gcd(a,b)*b;}\n\nint w,h;\nvector<string> data;\n\nint dx[2]={1,0};\nint dy[2]={0,1};\nbool inrange(int x,int y){ \n\tif(x<0||y<0||x>h-1||y>w-1) return false;\n\telse return true;\n}\n\nlong long int conv(string str){\n\tif(str==\"\") return -1;\n\tREP(i,str.size()) {\n\t\tif(str[i]<'0'||str[i]>'9') {\n\t\t\treturn -1;\n\t\t}\n\t}\n\tcout << str << endl;\n\treturn stoll(str);\n}\n\nstring getbigger(string a,string b){\n\tif(a.size()!=b.size()){\n\t\tif(a.size()>b.size()) return a;\n\t\telse return b;\n\t}\n\telse{\n\t\tREP(i,a.size()){\n\t\t\tif(a[i]==b[i]) continue;\n\t\t\tif(a[i]>b[i]) return a;\n\t\t\telse  return b;\n\t\t}\n\t\treturn a;//eq\n\t}\n}\n\nstring solve(int px,int py,bool sudeni[100][100]){\n\n\tstring rst = \"\";\n\tif(!inrange(px,py)) return \"\";\n\tif(sudeni[px][py]==false && '0'<=data[px][py] && data[px][py]<='9') {\n\t\trst+=data[px][py];\n\t\tsudeni[px][py] = true;\n\t}\n\tvector<string> tmp;\n\tREP(i,2){\n\t\ttmp.pb(\"\");\n\t\tint nx = px + dx[i];\n\t\tint ny = py + dy[i];\n\t\tif(inrange(nx,ny) && sudeni[nx][ny]==false && '0'<=data[nx][ny] && data[nx][ny]<='9') {\n\t\t\ttmp[i]=solve(nx,ny,sudeni);\n\t\t}\n\t}\n\trst += getbigger(tmp[0],tmp[1]);\n\treturn  rst;\n}\n\nint main(){\n\twhile(1){\n\t\tcin >> w >> h;\n\t\tif(w==0&&h==0) break;\n\t\tdata.clear();\n\t\tREP(i,h){\n\t\t\tstring tmp;\n\t\t\tcin >> tmp;\n\t\t\tdata.pb(tmp);\n\t\t}\n\t\tstring ans = \"-1\";\n\t\tREP(i,h){\n\t\t\tREP(j,w){\n\t\t\t\tbool s[100][100];\n\t\t\t\tREP(i,100) REP(j,100) s[i][j]=false;\n\t\t\t\tans = getbigger(solve(i,j,s),ans);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <cassert>\n#include <iostream>\n#include <string>\n#include <vector>\n#include <queue>\n#include <stack>\n#include <algorithm>\n#include <map>\n\nstd::string str[128][128];\nchar field[128][128];\nint W, H;\n\nvoid Load() {\n  scanf(\"%d %d\", &W, &H);\n  for(int i = 0; i < H; ++i) {\n    scanf(\"%s\", field[i]);\n  }\n}\n\nvoid init() {\n  for(int i = 0; i < H; ++i) {\n    for(int j = 0; j < W; ++j) {\n      str[i][j].clear();\n    }\n  }\n}\nstd::string& greater(std::string& a, std::string& b) {\n  if( a.size() != b.size() ) {\n    if( a.size() < b.size() ) return b;\n    else return a;\n  }\n  if( a < b ) {\n    return b;\n  }\n  return a;\n}\n\nvoid solve() {\n  for(int r = 0; r < H; ++r) {\n    for(int c = 0; c < W; ++c) {\n      if( not ( '0' <= field[r][c] and field[r][c] <= '9' ) ) continue;\n      std::string t1;\n      std::string t2;\n      if( 0 <= c - 1 ) {\n        t1 = str[r][c-1];\n      }\n      if( 0 <= r - 1 ) {\n        t2 = str[r-1][c];\n      }\n      std::string t = greater(t1, t2);\n      if( t.size() == 0 and field[r][c] == '0' ) continue;\n      str[r][c] = greater(t1, t2) + field[r][c];\n    }\n  }\n}\n\nint main() {\n  for(;;) {\n    init();\n    Load();\n    if( W == 0 and H == 0 ) break;\n    solve();\n    std::string ans;\n    for(int i = 0; i < H; ++i) {\n      for(int j = 0; j < W; ++j) {\n        ans = greater(ans, str[i][j]);\n      }\n    }\n    if( ans.empty() ) {\n      std::cout << 0 << std::endl;\n    }\n    std::cout << ans << std::endl;\n  }  \n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nstring x[100][100];\nbool p[100][100];\nint h,w;\nchar T[11]=\"0123456789\";\nchar c;\nstring dp[100][100];\n\nbool isnum(string p){\n\tfor(int i=0;i<10;i++){\n\t\tif(T[i]==p[0]){\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nstring _max(string a,string b){\n\tif(a.size()<b.size()){return b;}\n\tif(a.size()>b.size()){return a;}\n\tif(a>b){return a;}\n\treturn b;\n}\n\nint main(){\n\twhile(true){\n\t\tfor(int i=0;i<100;i++){\n\t\t\tfor(int j=0;j<100;j++){\n\t\t\t\tdp[i][j]=\"\";\n\t\t\t\tx[i][j]=\"a\";\n\t\t\t}\n\t\t}\n\t\tcin>>w>>h;\n\t\tif(h==0 && w==0){break;}\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tcin>>c;\n\t\t\t\tstring G=\"\";\n\t\t\t\tG+=c;\n\t\t\t\tx[i][j]=G;\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tif(isnum(x[i][j])==true){\n\t\t\t\t\tif(x[i][j]!=\"0\"){\n\t\t\t\t\t\tdp[i][j]=\"\"+x[i][j];\n\t\t\t\t\t}\n\t\t\t\t\tp[i][j]=true;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tp[i][j]=false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<70;i++){\n\t\t\tfor(int j=0;j<h;j++){\n\t\t\t\tfor(int k=0;k<w;k++){\n\t\t\t\t\tif(dp[j][k]!=\"\"){\n\t\t\t\t\t\tif(p[j+1][k]==true){\n\t\t\t\t\t\t\tdp[j+1][k]=_max(dp[j+1][k],dp[j][k]+x[j+1][k]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(p[j][k+1]==true){\n\t\t\t\t\t\t\tdp[j][k+1]=_max(dp[j][k+1],dp[j][k]+x[j][k+1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring maxn=\"\";\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tmaxn=max(maxn,dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout<<maxn<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <string>\n\nusing namespace std;\n\nbool comp(string a, string b) {\n    if (a.size() > b.size()) return 1;\n    else if (b.size() > a.size()) return 0;\n    for (int i = 0; i < a.size(); i++) {\n        if (a[i] > b[i]) return 1;\n        else if (b[i] > a[i]) return 0;\n    }\n    return 1;\n}\n\nint main(void){\n    int w, h;\n    while (cin>>w>>h && w) {\n        vector<vector<char> > g(h, vector<char>(w));\n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n                cin >> g[i][j];\n            }\n        }\n        \n        vector<vector<string> > dp(h, vector<string>(w));\n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n                if (g[i][j] >= '0' && g[i][j] <= '9') dp[i][j] = g[i][j];\n            }\n        }\n        \n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n                if (g[i][j] < '0' || g[i][j] > '9') continue;\n                string a, b, c;\n                a = dp[i][j];\n                if (a == \"0\") continue;\n                \n                if (j+1 < w && g[i][j+1] >= '0' && g[i][j+1] <= '9') {\n                    string b = a + g[i][j+1];\n                    if (comp(b,a) && comp(b, dp[i][j+1])) dp[i][j+1] = b;\n                }\n                \n                if (i+1 < h && g[i+1][j] >= '0' && g[i+1][j] <= '9') {\n                    string c = a + g[i+1][j];\n                    if (comp(c,a) && comp(c, dp[i+1][j])) dp[i+1][j] = c;\n                }\n            }\n        }\n        \n        string ans;\n        for (int i = 0; i < h; i++) {\n            for (int j = 0; j < w; j++) {\n                if (comp(dp[i][j], ans)) {\n                    ans = dp[i][j];\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n#define rep(i,n) for(int i = 0; i < n ;++i)\n#define all(v) v.begin(),v.end()\n\nstring s[100];\nint w,h;\nint dx[2]={0,1};\nint dy[2]={1,0};\nbool used[100][100];\n//vector<string> vs;\nstring ans;\n\nvoid solve(int y,int x,string t){\n  // cout<<s[y][x]<<endl;\n  bool f=0;\n  rep(i,2){\n    int ny=dy[i]+y,nx=x+dx[i];\n    if(ny>=0&&ny<h&&nx>=0&&nx<w){\n      if(/*!used[ny][nx]&&*/s[ny][nx]>='0'&&s[ny][nx]<='9'){\n        //used[ny][nx]=1;\n        solve(ny,nx,t+s[ny][nx]);\n        //used[ny][nx]=0;\n        f=1;\n      }\n    }\n  }\n  if(!f){\n    if(ans.size()<t.size())ans=t;\n    else if(ans.size()==t.size()){\n      if(ans<t)ans=t;\n    }\n  }\n  //vssh_back(t);\n}\n\nbool F(string a,string b){\n  if(a.size()!=b.size())return a.size()>b.size();\n  return a>b;\n}\n\nint main(){\n    while(cin>>w>>h&&w+h){\n      //vs.clear();\n      ans=\"\";\n        rep(i,h)cin>>s[i];\n        rep(i,h)rep(j,w)used[i][j]=0;\n        rep(i,h){\n          rep(j,w){\n            if(!used[i][j]&&s[i][j]>='1'&&s[i][j]<='9'){\n              used[i][j]=1;\n              string t;\n              t.push_back(s[i][j]);\n              solve(i,j,t);\n            }\n          }\n        }\n        // sort(all(vs),F);\n        // reverse(all(vs));\n        // cout<<vs[0]<<endl;\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n#define rep(i,n) for(int i = 0; i < n ;++i)\n#define all(v) v.begin(),v.end()\n\nstring s[100];\nint w,h;\nint dx[2]={0,1};\nint dy[2]={1,0};\nbool used[100][100];\n//vector<string> vs;\nstring ans;\n\nvoid solve(int y,int x,string t){\n  // cout<<s[y][x]<<endl;\n  used[y][x]=1;\n  bool f=0;\n  rep(i,2){\n    int ny=dy[i]+y,nx=x+dx[i];\n    if(ny>=0&&ny<h&&nx>=0&&nx<w){\n      if(/*!used[ny][nx]&&*/s[ny][nx]>='0'&&s[ny][nx]<='9'){\n        // used[ny][nx]=1;\n        solve(ny,nx,t+s[ny][nx]);\n        //used[ny][nx]=0;\n        f=1;\n      }\n    }\n  }\n  if(!f){\n    if(ans.size()<t.size())ans=t;\n    else if(ans.size()==t.size()){\n      if(ans<t)ans=t;\n    }\n  }\n  //vssh_back(t);\n}\n\nbool F(string a,string b){\n  if(a.size()!=b.size())return a.size()>b.size();\n  return a>b;\n}\n\nint main(){\n    while(cin>>w>>h&&w+h){\n      //vs.clear();\n      ans=\"\";\n        rep(i,h)cin>>s[i];\n        rep(i,h)rep(j,w)used[i][j]=0;\n        rep(i,h){\n          rep(j,w){\n            if(!used[i][j]&&s[i][j]>='1'&&s[i][j]<='9'){\n              used[i][j]=1;\n              string t;\n              t.push_back(s[i][j]);\n              solve(i,j,t);\n            }\n          }\n        }\n        // sort(all(vs),F);\n        // reverse(all(vs));\n        // cout<<vs[0]<<endl;\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nstring x[100][100];\nbool p[100][100];\nint h,w;\nchar T[11]=\"0123456789\";\nchar c;\nstring dp[100][100];\n\nbool isnum(string p){\n\tfor(int i=0;i<10;i++){\n\t\tif(T[i]==p[0]){\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nstring _max(string a,string b){\n\tif(a.size()<b.size()){return b;}\n\tif(a.size()>b.size()){return a;}\n\tif(a>b){return a;}\n\treturn b;\n}\n\nint main(){\n\twhile(true){\n\t\tfor(int i=0;i<100;i++){\n\t\t\tfor(int j=0;j<100;j++){\n\t\t\t\tdp[i][j]=\"\";\n\t\t\t\tx[i][j]=\"a\";\n\t\t\t}\n\t\t}\n\t\tcin>>w>>h;\n\t\tif(h==0 && w==0){break;}\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tcin>>c;\n\t\t\t\tstring G=\"\";\n\t\t\t\tG+=c;\n\t\t\t\tx[i][j]=G;\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tif(isnum(x[i][j])==true){\n\t\t\t\t\tif(x[i][j]!=\"0\"){\n\t\t\t\t\t\tdp[i][j]=\"\"+x[i][j];\n\t\t\t\t\t}\n\t\t\t\t\tp[i][j]=true;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tp[i][j]=false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<70;i++){\n\t\t\tfor(int j=0;j<h;j++){\n\t\t\t\tfor(int k=0;k<w;k++){\n\t\t\t\t\tif(dp[j][k]!=\"\"){\n\t\t\t\t\t\tif(p[j+1][k]==true){\n\t\t\t\t\t\t\tdp[j+1][k]=_max(dp[j+1][k],dp[j][k]+x[j+1][k]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(p[j][k+1]==true){\n\t\t\t\t\t\t\tdp[j][k+1]=_max(dp[j][k+1],dp[j][k]+x[j][k+1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring maxn=\"\";\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tmaxn=_max(maxn,dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout<<maxn<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n\nusing namespace std;\n\nbool compare(string S1, string S2)\n{\n\tif (S1.size() != S2.size()) { return S1.size() > S2.size(); }\n\n\treturn S1 > S2;\n}\n\nint main()\n{\n\tint H, W;\n\n\twhile (true)\n\t{\n\t\tscanf(\"%d\", &W);\n\t\tscanf(\"%d\", &H);\n\n\t\tif (H == 0 && W == 0) { break; }\n\n\t\tvector<string> R(H);\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tcin >> R[i];\n\t\t}\n\n\t\tvector<vector<string> > dp(H, vector<string>(W, \"\"));\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (isdigit(R[i][j]))\n\t\t\t\t{\n\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][j] = R[i][j];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i - 1][j] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]) && dp[i - 1][j] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i - 1][j] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (j != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i][j - 1] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]) && dp[i][j - 1] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i][j - 1] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ret = \"\";\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (compare(dp[i][j], ret))\n\t\t\t\t{\n\t\t\t\t\tret = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%s\\n\", ret.c_str());\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nstring x[100][100];\nbool p[100][100];\nint h,w;\nchar T[11]=\"0123456789\";\nchar c;\nstring dp[100][100];\n\nbool isnum(string p){\n\tfor(int i=0;i<10;i++){\n\t\tif(T[i]==p[0]){\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nstring _max(string a,string b){\n\tif(a.size()<b.size()){return b;}\n\tif(a.size()>b.size()){return a;}\n\tif(a>b){return a;}\n\treturn b;\n}\n\nint main(){\n\twhile(true){\n\t\tfor(int i=0;i<100;i++){\n\t\t\tfor(int j=0;j<100;j++){\n\t\t\t\tdp[i][j]=\"\";\n\t\t\t\tx[i][j]=\"a\";\n\t\t\t}\n\t\t}\n\t\tcin>>h>>w;\n\t\tif(h==0 && w==0){break;}\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tcin>>c;\n\t\t\t\tstring G=\"\";\n\t\t\t\tG+=c;\n\t\t\t\tx[i][j]=G;\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tif(isnum(x[i][j])==true){\n\t\t\t\t\tdp[i][j]=\"\"+x[i][j];\n\t\t\t\t\tp[i][j]=true;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tp[i][j]=false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<70;i++){\n\t\t\tfor(int j=0;j<h;j++){\n\t\t\t\tfor(int k=0;k<w;k++){\n\t\t\t\t\tif(p[j+1][k]==true){\n\t\t\t\t\t\tdp[j+1][k]=_max(dp[j+1][k],dp[j][k]+x[j+1][k]);\n\t\t\t\t\t}\n\t\t\t\t\tif(p[j][k+1]==true){\n\t\t\t\t\t\tdp[j][k+1]=_max(dp[j][k+1],dp[j][k]+x[j][k+1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring maxn=\"\";\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tmaxn=max(maxn,dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout<<maxn<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\n#define mk make_pair\nusing namespace std;\nint dx[]={1,0},dy[]={0,1};\nint main(){\n  int w,h;\n  while(cin>>w>>h,w){\n    string s[h],t=\"\";\n    r(i,h)cin>>s[i];\n    r(i,h)r(j,w)if(s[i][j]>='1'&&s[i][j]<='9'){\n      bool b[h][w];\n      r(k,h)r(l,w)b[k][l]=0;\n      queue<pair<int,int> >q;\n      string ss[h][w];\n      q.push(mk(i,j));\n      while(!q.empty()){\n        pair<int,int>a=q.front();q.pop();\n        int x=a.second,y=a.first;\n        ss[y][x]+=s[y][x];\n        r(k,2){\n          int x1=x+dx[k],y1=y+dy[k];\n          if(x1<0||y1<0||x1>=w||y1>=h)continue;\n          if(s[y1][x1]>='0'&&s[y1][x1]<='9'){\n            if(b[y1][x1]){\n              if(ss[y1][x1]<ss[y][x]){\n                ss[y1][x1]=\"\";\n                ss[y1][x1]+=ss[y][x];\n              }\n            }\n            else {\n              ss[y1][x1]+=ss[y][x];\n              q.push(mk(y1,x1));\n              b[y1][x1]=1;\n            }\n          }\n        }\n      }string tt=\"\";\n      r(k,h)r(l,w)tt=max(tt,ss[k][l]);\n      if(t.size()<tt.size())if(t<tt)t=tt;\n    }\n    cout<<t<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "//=================================\n// Created on: 2018/07/06 04:08:37\n//=================================\n#include <bits/stdc++.h>\nusing namespace std;\nint main()\n{\n    for (int H, W;;) {\n        cin >> W >> H;\n        if (H == 0 and W == 0) { break; }\n        vector<string> f(H);\n        for (int i = 0; i < H; i++) { cin >> f[i]; }\n        using P = pair<int, string>;\n        vector<vector<P>> dp(H + 1, vector<P>(W + 1, P{0, \"\"}));\n        dp[H - 1][W - 1] = isalpha(f[H - 1][W - 1]) ? P{0, \"\"} : P{1, string(1, f[H - 1][W - 1])};\n        for (int sum = H + W - 3; sum >= 0; sum--) {\n            for (int y = min(sum, H - 1); y >= max(sum - W + 1, 0); y--) {\n                const int x = sum - y;\n                if (isalpha(f[y][x])) {\n                    dp[y][x] = P{0, \"\"};\n                    continue;\n                } else {\n                    dp[y][x] = max({dp[y][x], {dp[y][x + 1].first + 1, string(1, f[y][x]) + dp[y][x + 1].second}, {dp[y + 1][x].first + 1, string(1, f[y][x]) + dp[y + 1][x].second}});\n                }\n            }\n        }\n        P ans = P{0, \"\"};\n        for (int i = H - 1; i >= 0; i--) {\n            for (int j = W - 1; j >= 0; j--) {\n                if (f[i][j] == '0') { continue; }\n                ans = max(ans, dp[i][j]);\n            }\n        }\n        cout << ans.second << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "//include\n//------------------------------------------\n#include <vector>\n#include <list>\n#include <map>\n#include <set>\n#include <deque>\n#include <stack>\n#include <bitset>\n#include <algorithm>\n#include <functional>\n#include <numeric>\n#include <utility>\n#include <sstream>\n#include <iostream>\n#include <iomanip>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\n#include <cctype>\n#include <string>\n#include <cstring>\n#include <ctime>\n#include <climits>\n#include <queue>\n\nusing namespace std;\n\n//typedef\n//------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef long long LL;\n\n//container util\n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define EACH(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n\n//repetition\n//------------------------------------------\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define REP(i,n)  FOR(i,0,n)\n\n//constant\n//--------------------------------------------\nconst double EPS = 1e-10;\nconst double PI  = acos(-1.0);\n\nint main(){\n  cin.tie(0);\n  ios_base::sync_with_stdio(false);\n  int W, H;\n  while((cin >> W >> H) && W && H){\n\tVS code(H+2, string(W+2, 'A'));\n\tREP(y,H) REP(x,W)\n\t  cin >> code[y+1][x+1];\n\tpair<int, string> dp[100][100];\n\tfor(int y=0;y<H+2;++y)\n\t  for(int x=0;x<W+2;++x)\n\t\tdp[y][x] = MP(0, \"\");\n\n\tint pdx[] = {-1, 0};\n\tint pdy[] = {0, -1};\n\tfor(int y=1;y<=H;++y){\n\t  for(int x=1;x<=W;++x){\n\t\tif(!isdigit(code[y][x])) dp[y][x] = MP(0, \"\");\n\t\telse\n\t\t  for(int i=0;i<2;++i){\n\t\t\t//cout<<x<<\",\"<<y<<endl;\n\t\t\tint px = x + pdx[i], py = y + pdy[i];\n\t\t\tif(dp[py][px].first > 0){\n\t\t\t  dp[y][x] = max(dp[y][x],\n\t\t\t\t\t\t\t MP(dp[py][px].first+1,\n\t\t\t\t\t\t\t\tdp[py][px].second + code[y][x]));\n\t\t\t}\n\t\t\telse if(code[y][x] != '0'){\n\t\t\t  string s(1, code[y][x]);\n\t\t\t  dp[y][x] = max(dp[y][x], MP(1, s));\n\t\t\t}\n\t\t\telse\n\t\t\t  dp[y][x] = max(dp[y][x], MP(0, string(\"\")));\n\t\t  }\n\t  }\n\t}\n\tpair<int,string> ans(0, \"\");\n\tfor(int y=1;y<=H;++y)\n\t  for(int x=1;x<=W;++x)\n\t\tans = max(ans, dp[y][x]);\n\tcout << ans.second << endl;\n  }\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nconst int dx[] = {-1, 0};\nconst int dy[] = {0, -1};\n\nvector<string> board(70);\nstring memo[70][70];\nint W, H;\n\ninline bool isDigit(int x, int y)\n{\n    if ('0' <= board[y][x] && board[y][x] <= '9')\n        return true;\n    else\n        return false;\n}\n\nint main()\n{\n    while (cin >> W >> H, W || H) {\n        // Input\n        for (int i = 0; i < H; ++i) {\n            cin >> board[i];\n            for (int j = 0; j < W; ++j)\n                memo[i][j] = board[i][j];\n        }\n\n        // Solve\n        for (int y = H - 1; y >= 0; --y) {\n            for (int x = W - 1; x >= 0; --x) {\n                if (isDigit(x, y)) {\n                    for (int d = 0; d < 2; ++d) {\n                        int nx = x + dx[d];\n                        int ny = y + dy[d];\n\n                        if (nx < 0 || nx >= W || ny < 0 || ny >= H)\n                            continue;\n                        if (!isDigit(nx, ny))\n                            continue;\n                        string cmp = board[ny][nx] + memo[y][x];\n                        if (cmp.size() > memo[ny][nx].size() ||\n                            (cmp.size() == memo[ny][nx].size() && cmp > memo[ny][nx]))\n                            memo[ny][nx] = cmp;\n                    }\n                }\n            }\n        }\n\n        // Remove leading zero\n        for (int y = 0; y < H; ++y)\n            for (int x = 0; x < W; ++x) {\n                int index = 0;\n                while (memo[y][x][index] == '0')\n                    index++;\n                memo[y][x] = memo[y][x].substr(index);\n            }\n\n        string ans;\n        for (int y = 0; y < H; ++y)\n            for (int x = 0; x < W; ++x)\n                if (isDigit(x, y) && memo[y][x].size() > ans.size() ||\n                    (memo[y][x].size() == ans.size() && memo[y][x] > ans))\n                    ans = memo[y][x];\n        cout << ans << endl;\n    }\n\n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <ctype.h>\n\nconst int max_width = 70, max_height = 70;\nconst int dx[] = {-1, 0, 1, 0}, dy[] = {0, -1, 0, 1};\n\nint width, height;\n\nstd::string matrix[max_width][max_height];\nstd::string memo[max_width][max_height];\nstd::string ans;\n\nstd::string compare(std::string s1, std::string s2);\n\nstd::string dfs(int x, int y);\n\nvoid solve();\n\nint main(){\n    while(true){\n        ans = -1;\n        for(int i = 0; i < max_width; ++i){\n            for(int j = 0; j < max_height; ++j)\n                memo[i][j] = \"A\";\n        }\n        std::cin >> height >> width;\n        if(width + height == 0) break;\n        for (int i = 0; i < width; ++i){\n            for(int j = 0; j < height; ++j){\n                char in;\n                std::cin >> in;\n                matrix[i][j] = in;\n            }\n        }\n        solve();\n    } \n    return 0;\n}\n\nvoid solve(){\n    for(int i = 0; i < width; ++i){\n        for(int j = 0; j < height; ++j){\n            if(!isdigit(matrix[i][j][0]) || matrix[i][j] == \"0\") continue;\n            ans = compare(dfs(i, j), ans);\n        }\n    }\n    std::cout << ans << std::endl;\n    return;\n}\n\nstd::string dfs(int x, int y){\n    if(memo[x][y] != \"A\") return memo[x][y];\n    std::string res = \"\";\n    for(int i = 2; i < 4; ++i){\n        int nx = x + dx[i], ny = y + dy[i];\n        if(nx < 0 || nx >= width || ny < 0 || ny >= height) continue;\n        if(!isdigit(matrix[nx][ny][0])) continue;\n        res = compare(dfs(nx, ny), res);\n    }\n    return memo[x][y] = matrix[x][y] + res;\n}\n\nstd::string compare(std::string s1, std::string s2){\n    if(s1.length() == s2.length()){\n        for(int i = 0; i < s1.length(); ++i){\n            if(s1[i] != s2[i])\n                return s1[i] > s2[i] ? s1 : s2;\n        }\n    }\n    else if(s1.length() > s2.length()) return s1;\n    return s2;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <set>\nusing namespace std;\n\nchar field[70][70];\nint w, h;\nint dy[] = {0, 1}, dx[] = {1, 0};\nset<string> numbers;\nsize_t maxLength;\n\nvoid search(const int y, const int x, string number) {\n    number += field[y][x];\n    bool isEnd = true;\n    for (int i = 0; i < 2; i++) {\n        int ny = y + dy[i], nx = x + dx[i];\n        if (ny < h && nx < w && '0' <= field[ny][nx] && field[ny][nx] <= '9') {\n            isEnd = false;\n            search(ny, nx, number);\n        }\n    }\n    if (isEnd) {\n        numbers.insert(number);\n        if (maxLength < number.length()) {\n            maxLength = number.length();\n        }\n    }\n}\n\nint main() {\n    while (true) {\n        cin >> w >> h;\n        if ((w | h) == 0) {\n            break;\n        }\n        for (int y = 0; y < h; y++) {\n            cin >> field[y];\n        }\n        numbers.clear();\n        maxLength = 0;\n        for (int y = 0; y < h; y++) {\n            for (int x = 0; x < w; x++) {\n                if (0 < x && '0' <= field[y][x - 1] && field[y][x - 1] <= '9') {\n                    continue;\n                }\n                if (0 < y && '0' <= field[y - 1][x] && field[y - 1][x] <= '9') {\n                    continue;\n                }\n                if ('0' < field[y][x] && field[y][x] <= '9') {\n                    string number = \"\";\n                    search(y, x, number);\n                }\n            }\n        }\n        string max = \"0\";\n        for (set<string>::iterator it = numbers.begin(); it != numbers.end(); it++) {\n            if ((*it).length() < maxLength) {\n                continue;\n            }\n            if (max < *it) {\n                max = *it;\n            }\n        }\n        cout << max << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <iomanip>\n#include <string>\n#include <sstream>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <stack>\n#include <queue>\n#include <map>\n#include <set>\n#include <functional>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <cmath>\n#include <cassert>\n \nusing namespace std;\n \n#define REP(i,s,e) for(int i=(s); i<(int)(e); i++)\n#define rep(i,n) REP(i, 0, n)\n#define pb push_back\n#define mp make_pair\n#define all(r) (r).begin(),(r).end()\n#define rall(r) (r).rbegin(),(r).rend()\n#define fi first\n#define se second\n#define DBG(X) cout<<\" \"<<#X<<\" : \"<<X<<endl\n \ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef vector<ll> vl;\ntypedef pair<int, int> pii;\n\nconst int INF = 1e9;\nconst double EPS = 1e-8;\nconst int mod = 1e9 + 7;\nconst ll LINF = 1e18;\n\nstruct Input\n{\n\tint n;char c;char str[1024];string s;ll l;double d;\n\tint nextInt(){scanf(\"%d\", &n);return n;}\n\tll nextLong(){scanf(\"%lld\", &l);return l;}\n\tdouble nextDouble(){scanf(\"%lf\", &d);return d;}\n\tchar nextChar(){scanf(\"%c\", &c);return c;}\n\tstring next(){scanf(\"%s\", str);return string(str);}\n\tstring nextLine(){getline(cin, s);return s;}\n};\nInput in;\n\nstring amax(const string& s1, const string& s2){\n\tif(s1.size()!=s2.size()) return s1.size()>s2.size()?s1:s2;\n\tfor(int i = 0; i < s1.size(); i++){\n\t\tif(s1[i] != s2[i]) return s1[i] > s2[i] ? s1 :s2;\n\t}\n\treturn s1;\n}\nbool isNum(char c){\n\treturn c>='0' && c<='9';\n}\n\nint main(){\n\twhile(1){\n\t\tint w = in.nextInt(), h = in.nextInt();\n\t\tif(h == 0 &&  w == 0) break;\n\t\tvector<string> s(h);\n\t\tvector<vector<string> > d(h + 1, vector<string>(w+1));\n\t\trep(i, h) s[i] = in.next();\n\t\tint m = 0;\n\t\tfor(int i = 0; i < h; i++) for(int j = 0; j < w; j++){\n\t\t\tif(isNum(s[i][j])) m = max(m, s[i][j]-'0');\n\t\t}\n\t\tif(m == 0) {\n\t\t\tprintf(\"0\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tstring ans =\"\";\n\t\t\n\t\tfor(int i = 0; i < h; i++){\n\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\tif(!isNum(s[i][j])) continue;\n\t\t\t\tif(s[i][j] != '0') d[i][j] = s[i][j];\n\t\t\t\tif(i > 0){\n\t\t\t\t\tif(d[i-1][j] == \"\" && s[i][j]=='0');\n\t\t\t\t\telse d[i][j] = amax(d[i][j], d[i-1][j] + s[i][j]);\n\t\t\t\t}\n\t\t\t\tif(j > 0){\n\t\t\t\t\tif(d[i][j-1] == \"\" && s[i][j]=='0');\n\t\t\t\t\telse d[i][j] = amax(d[i][j], d[i][j-1] + s[i][j]);\n\t\t\t\t}\n\t\t\t\tans = amax(ans, d[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cctype>\n\nusing namespace std;\n\nint main(void){\n  int w,h;\n  string grid[70],dp[70][70];\n\n  while(cin >> w >> h,w|h){\n    for(int i=0;i<70;i++)\n      for(int j=0;j<70;j++)dp[i][j].clear();\n\n    for(int i=0;i<h;i++)cin >> grid[i];\n\n    if(!isupper(grid[0][0]))dp[0][0]+=grid[0][0];\n\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(!isupper(grid[i][j])){\n\t  dp[i][j]=grid[i][j];\n\t  string a=\"\",b=\"\";\n\t  if(i>0 && !dp[i-1][j].empty())a=dp[i-1][j]+grid[i][j];\n\t  if(j>0 && !dp[i][j-1].empty())b=dp[i][j-1]+grid[i][j];\n\t  \n\t  if(a.empty() && !b.empty()){\n\t    dp[i][j]=b;\n\t    continue;\n\t  }\n\n\t  if(!a.empty() && b.empty()){\n\t    dp[i][j]=a;\n\t    continue;\n\t  }\n\t  if(a.empty() && b.empty())continue;\n\t  if(atoi(a.c_str())>atoi(b.c_str()))dp[i][j]=a;\n\t  else dp[i][j]=b;\n\n\t}\n      }\n    }\n\n    string s=\"\";\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tif(dp[i][j][0]=='0'){\n\t  int k=0;\n\t  for(;k<dp[i][j].size()&&dp[i][j][k]=='0';k++);\n\t  dp[i][j]=dp[i][j].substr(k);\n\t}\n\tif(s.size()<dp[i][j].size())s=dp[i][j];\n\telse if(s<dp[i][j])s=dp[i][j];\n      }\n    }\n    cout << s << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <cstring>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <unordered_set>\n#include <unordered_map>\nusing namespace std;\n\nvector<string>grid;\nstring memo[70][70];\nbool comp(const string& s1, const string& s2)\n{\n\tif (s1.size() == s2.size())\n\t{\n\t\treturn s1 < s2;\n\t}\n\treturn s1.size() < s2.size();\n}\nstring dp(int i, int j)\n{\n\tif (i < 0 || j < 0)return \"\";\n\tif (memo[i][j] != \"-1\")return memo[i][j];\n\tstring s = \"\";\n\tif (!isalpha(grid[i][j]))\n\t{\n\t\tstring s1 = dp(i + 1, j);\n\t\tstring s2 = dp(i, j + 1);\n\t\tif (comp(s1, s2))\n\t\t{\n\t\t\ts = s2;\n\t\t}\n\t\telse\n\t\t{\n\t\t\ts = s1;\n\t\t}\n\t\ts.insert(s.begin(), grid[i][j]);\n\t}\n\twhile (!s.empty() && s.back() == '0')s.pop_back();\n\treturn memo[i][j] = s;\n}\n\nint main(void)\n{\n\tint w, h;\n\tfor (;;)\n\t{\n\t\tcin >> w >> h;\n\t\tif (!w)break;\n\t\tgrid.clear();\n\t\tfor (int i = 0; i < h; ++i)\n\t\t{\n\t\t\tstring c;\n\t\t\tcin >> c;\n\t\t\tgrid.push_back(c);\n\t\t\tfor (int j = 0; j < w; ++j)\n\t\t\t{\n\t\t\t\tmemo[i][j] = \"-1\";\n\t\t\t}\n\t\t}\n\t\tstring ans;\n\t\tfor (int i = 0; i < h; ++i)\n\t\t{\n\t\t\tfor (int j = 0; j < w; ++j)\n\t\t\t{\n\t\t\t\tstring s = dp(i, j);\n\t\t\t\twhile (!s.empty() && s.front() == '0')s.erase(s.begin());\n\t\t\t\tif (comp(ans, s))\n\t\t\t\t{\n\t\t\t\t\tans = s;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n\nusing namespace std;\n\nstring dp[101][101];\n\nconst int dy[]={0,-1};\nconst int dx[]={-1,0};\n\nint w,h;\nchar field[101][101];\n\nstring maxString(string str1,string str2){\n\tstring res1=str1;\n\tstring res2=str2;\n\n\tif(str1==\"\"){\n\t\treturn str2;\n\t}\n\telse if(str2==\"\"){\n\t\treturn str1;\n\t}\n\n\t// ツ静ヲツ督ェツづ頚eroツづーツ湘つキ\n\tint idx1=str1.size()-1;\n\tfor(int i = 0; i < (int)(str1.size())-1; i++){\n\t\tif(str1[i]!='0'){\n\t\t\tidx1=i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tstr1=str1.substr(idx1);\n\n\tidx1=str2.size()-1;\n\tfor(int i = 0; i < (int)(str2.size())-1; i++){\n\t\tif(str2[i]!='0'){\n\t\t\tidx1=i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tstr2=str2.substr(idx1);\n\n\tif(str1.size()>str2.size())\n\t\treturn res1;\n\telse if(str1.size()<str2.size())\n\t\treturn res2;\n\telse{\n\t\tfor(int i = 0; i < str1.size(); i++){\n\t\t\tif(str1[i]>str2[i]){\n\t\t\t\treturn res1;\n\t\t\t}\n\t\t\telse if(str1[i]<str2[i]){\n\t\t\t\treturn res2;\n\t\t\t}\n\t\t}\n\t\treturn res1;\n\t}\n}\n\nstring dfs(int x,int y){\n\tif(dp[y][x]!=\"\")\n\t\treturn dp[y][x];\n\tif(!(field[y][x]>='0'&&field[y][x]<='9')){\n\t\treturn \"\";\n\t}\n\tstring res=\"\";\n\tfor(int i = 0; i < 2; i++){\n\t\tint ny=y+dy[i];\n\t\tint nx=x+dx[i];\n\t\tif(ny>=0&&nx>=0&&ny<h&&nx<w&&(field[ny][nx]>='0'&&field[ny][nx]<='9')){\n\t\t\tstring s=(dfs(nx,ny));\n\t\t\tif(s!=\"\")\n\t\t\t\tres=maxString(res,s);\n\t\t}\n\t}\n\tres=res+field[y][x];\n\tdp[y][x]=res;\n\treturn res;\n}\n\nint main(){\n\n\twhile(cin>>w>>h&&!(w==0&&h==0)){\n\t\tfor(int i = 0; i < 101; i++){\n\t\t\tfor(int j =0; j < 101; j++){\n\t\t\t\tdp[i][j]=\"\";\n\t\t\t\tfield[i][j]=0;\n\t\t\t}\n\t\t}\n\n\t\tfor(int i = 0; i < h; i++){\n\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\tcin>>field[i][j];\n\t\t\t}\n\t\t}\n\t\tstring maxNum=\"\";\n\t\tfor(int i = 0; i < h; i++){\n\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\tstring res=dfs(j,i);\n\t\t\t\tif(res==\"\")\n\t\t\t\t\tcontinue;\n\t\t\t\tmaxNum=maxString(maxNum,res);\n\t\t\t}\n\t\t}\n\n\t\t// ツ静ヲツ督ェツづ頚eroツづーツ湘つキ\n\t\tif(maxNum!=\"\"&&maxNum[0]=='0'){\n\t\t\tint idx1=maxNum.size()-1;\n\t\t\tfor(int i = 0; i < (int)(maxNum.size())-1; i++){\n\t\t\t\tif(maxNum[i]!='0'){\n\t\t\t\t\tidx1=i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmaxNum=maxNum.substr(idx1);\n\t\t}\n\t\tcout<<maxNum<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n\n#define MAX 70\n\nusing namespace std;\n\nstring f[MAX][MAX];\nstring memo[MAX][MAX];\n\nint main(void)\n{\n\tint w,h;\n\tint i1,i2;\n\tchar c;\n\tstring max;\n\tstring temp1,temp2;\n\n\twhile(1){\n\t\tcin>>w>>h;\n\t\tif(w+h==0) break;\n\n\t\tfor(i1=0;i1<MAX;i1++){\n\t\t\tfor(i2=0;i2<MAX;i2++){\n\t\t\t\tf[i1][i2]=\"-\";\n\t\t\t\tmemo[i1][i2]=\"\";\n\t\t\t}\n\t\t}\n\n\t\tfor(i1=1;i1<=h;i1++){\n\t\t\tfor(i2=1;i2<=w;i2++){\n\t\t\t\tcin>>c;\n\t\t\t\tif(c<'0' || '9'<c) f[i1][i2]=\"-\";\n\t\t\t\telse f[i1][i2]=c;\n\t\t\t}\n\t\t}\n\t\t\n\t\tmax=\"\";\n\t\tfor(i1=1;i1<=h;i1++){\n\t\t\tfor(i2=1;i2<=w;i2++){\n\t\t\t\tif(f[i1][i2]!=\"-\"){\n\n\t\t\t\t\ttemp1=memo[i1][i2-1];\n\t\t\t\t\ttemp2=memo[i1-1][i2];\n\n\t\t\t\t\tif(temp1.size()>temp2.size()){\n\t\t\t\t\t\tmemo[i1][i2]=temp1+f[i1][i2];\n\t\t\t\t\t}\n\t\t\t\t\telse if(temp1.size()==temp2.size()){\n\t\t\t\t\t\tif(temp1>temp2){\n\t\t\t\t\t\t\tmemo[i1][i2]=temp1+f[i1][i2];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse memo[i1][i2]=temp2+f[i1][i2];\n\t\t\t\t\t}\n\t\t\t\t\telse memo[i1][i2]=temp2+f[i1][i2];\n\n\t\t\t\t\tif(memo[i1][i2][0]=='0') memo[i1][i2].erase(0,1);\n\n\t\t\t\t\tif(max.size()<memo[i1][i2].size()) max=memo[i1][i2];\n\t\t\t\t\telse if(max.size()==memo[i1][i2].size()) {\n\t\t\t\t\t\tif(max<memo[i1][i2]) max=memo[i1][i2];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//memo[i1][i2]=max(f[i1][i2],memo[i1][i2-1]+f[i1][i2],memo[i1-1][i2]+f[i1][i2]);\n\t\t\t\t\n\t\t\t}\n\t\t}\n\n\t\tcout<<max<<endl;\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#pragma comment (linker, \"/STACK:526000000\")\n#define  _CRT_SECURE_NO_WARNINGS\n\nusing namespace std;\ntypedef string::const_iterator State;\n#define eps 1e-11L\n#define MAX_MOD 1000000007LL\n#define GYAKU 500000004LL\n\n#define MOD 998244353LL\n#define seg_size 262144*2LL\n#define pb push_back\n#define mp make_pair\ntypedef long long ll;\n#define REP(a,b) for(long long (a) = 0;(a) < (b);++(a))\n#define ALL(x) (x).begin(),(x).end()\n\nvoid init() {\n\tiostream::sync_with_stdio(false);\n\tcout << fixed << setprecision(20);\n}\n\nint compare(string a, string b) {\n\tif (a.length() < b.length()) return 1;\n\tif (a.length() > b.length()) return 0;\n\tREP(q, a.length()) {\n\t\tif (a[q] < b[q]) {\n\t\t\treturn 1;\n\t\t}\n\t\telse if (a[q] > b[q]) {\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn 1;\n}\n\nvoid solve() {\n\twhile (true) {\n\t\tint w, h;\n\t\tcin >> w >> h;\n\t\tif (w == 0) return;\n\t\tvector<string> inputs;\n\t\tREP(i, h) {\n\t\t\tstring a;\n\t\t\tcin >> a;\n\t\t\tinputs.push_back(a);\n\t\t}\n\t\tstring dp[70][70];\n\t\tstring ans = \"0\";\n\t\tREP(i, h) {\n\t\t\tREP(q, w) {\n\t\t\t\tif (inputs[i][q] >= 'A' && inputs[i][q] <= 'Z') continue;\n\t\t\t\tif (i >= 1) {\n\t\t\t\t\tif (compare(dp[i - 1][q], dp[i][q]) == 0) {\n\t\t\t\t\t\tdp[i][q] = dp[i - 1][q];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (q >= 1) {\n\t\t\t\t\tif (compare(dp[i][q - 1], dp[i][q]) == 0) {\n\t\t\t\t\t\tdp[i][q] = dp[i][q - 1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (inputs[i][q] == '0') {\n\t\t\t\t\tif (dp[i][q] == \"\") continue;\n\t\t\t\t}\n\t\t\t\tdp[i][q].push_back(inputs[i][q]);\n\t\t\t\tif (compare(dp[i][q], ans) == 0) {\n\t\t\t\t\tans = dp[i][q];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}\n\nint main() {\n\tinit();\n\tsolve();\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <map>\n#include <vector>\n#include <set>\n#include <iomanip>\n#include <stack>\n#include <fstream>\n#include <cstdint>\n#include <cmath>\n#include <algorithm>\n#include <utility>\n#include <numeric>\n#include <functional>\n\nusing namespace std;\n\nconstexpr int INF = 1000000000;/* 1e+9a */\nconstexpr int MODULO = 1000000007;\n\ntypedef int64_t ll;\nauto dcomp = [](const string& a, const string& b){\n    if(a.size() != b.size())    return a.size() < b.size();\n    return a < b;\n};\n\n\nstring maximize(int i, int j, vector<vector<string>>& dp, const vector<vector<char>>& c){\n    if(i >= dp.size()) return \"\";\n    if(j >= dp[0].size()) return \"\";\n    if(c[i][j] == '!')  return \"\";\n\n    if(dp[i][j].empty()){\n        const string l = maximize(i+1, j, dp, c);\n        const string r = maximize(i, j+1, dp, c);\n\n        return dp[i][j] = c[i][j] + (dcomp(l, r) ? r : l);\n    }\n    else return dp[i][j];\n}\n\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    int w, h;\n    while(cin >> w >> h){\n        if(w == 0 && h == 0) break;\n        vector<vector<char>> c;\n        for (int i = 0; i < h; ++i) {\n            c.push_back({});\n            for (int j = 0; j < w; ++j) {\n                char tmp;\n                std::cin >> tmp;\n                if('A' <= tmp && tmp <= 'Z'){\n                    tmp = '!';\n                }\n                c[i].push_back(tmp);\n            }\n        }\n        vector<vector<string>> dp(h, vector<string>(w));\n        string maxim = \"\";\n        for (int i = 0; i < h; ++i) {\n            for (int j = 0; j < w; ++j) {\n                if(c[i][j] != '!' && c[i][j] != '0' && dp[i][j].empty()){\n                    string st = maximize(i, j, dp, c);\n                    maxim = max(maxim, st, dcomp);\n                }\n            }\n        }\n        cout << maxim << '\\n';\n\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <complex>\n#include <sstream>\n#include <string>\n#include <algorithm>\n#include <deque>\n#include <list>\n#include <map>\n#include <numeric>\n#include <queue>\n#include <vector>\n#include <set>\n#include <limits>\n#include <cstdio>\n#include <cctype>\n#include <cmath>\n#include <cstdlib>\n#include <ctime>\nusing namespace std;\n#define REP(i, j) for(int i = 0; i < j; ++i)\n#define FOR(i, j, k) for(int i = j; i < k; ++i)\n#define P pair<int, string>\n\n// 1 = a < b\n// -1 = a > b\n// 0 = a == b\nint check(string a, string b){\n  int aa = 0, bb = 0;\n  while(aa < a.length() && a[aa] == '0') aa++;\n  while(bb < b.length() && b[bb] == '0') bb++;\n\n  if(aa == a.length()) a = \"0\";\n  else a = a.substr(aa);\n\n  if(bb == b.length()) b = \"0\";\n  else b = b.substr(bb);\n\n  if(a.length() > b.length()) return 1;\n  else if(a.length() < b.length()) return -1;\n  else{\n    REP(i, a.length()){\n      if(a[i] - '0' > b[i] - '0') return 1;\n      else if(a[i] - '0' < b[i] - '0') return -1;\n    }\n  }\n  return 0;\n}\nint main() {\n  int w, h;\n  while(cin >>w >>h && w != 0){\n    vector<string> v(h);\n    REP(i, h) cin >>v[i];\n    vector< vector<string> > dp(h + 1, vector<string>(w + 1, \"\"));\n    REP(i, h) REP(j, w) if(isalpha(v[i][j])) dp[i + 1][j + 1] = \"NO\";\n\n    REP(i, h){\n      REP(j, w){\n        int y = i + 1, x = j + 1;\n        if(isalpha(v[i][j])) continue;\n        //debug\n        //cout <<\"------------\" <<endl;\n        //cout <<\"! \" <<i <<\", \" <<j <<\", \" <<v[i][j] <<endl;\n        //if(i != 0){\n        //  cout <<v[i - 1][j] <<\", \";\n        //  cout <<dp[y - 1][x] <<endl;\n        //}\n        //if(j != 0){\n        //  cout <<v[i][j - 1] <<\", \";\n        //  cout <<dp[y][x - 1] <<endl;\n        //}\n\n        if(dp[y - 1][x] != \"NO\"){\n          dp[y][x] = dp[y - 1][x] + v[i][j];\n        }\n        if(dp[y][x - 1] != \"NO\" && check((dp[y][x - 1] + v[i][j]), dp[y][x]) == 1){\n          dp[y][x] = dp[y][x - 1] + v[i][j];\n        }\n        //debug\n        //cout <<dp[y][x] <<endl;\n      }\n    }\n    //debug\n    //FOR(i, 1, h + 1){\n    //  FOR(j, 1, w + 1){\n    //    cout <<i <<\", \" <<j <<endl;\n    //    cout <<dp[i][j].first <<\", \" <<dp[i][j].second <<endl;\n    //  }\n    //}\n\n    string ans = \"0\";\n    REP(i, h + 1){\n      REP(j, w + 1){\n        if(check(dp[i][j], ans) == 1) ans = dp[i][j];\n      }\n    }\n\n    int tmp = 0;\n    while(tmp < ans.length() && ans[tmp] == '0') tmp++;\n    if(tmp == ans.length()) ans = \"0\";\n    else ans = ans.substr(tmp);\n    cout <<ans <<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<vector>\nusing namespace std;\n\nstring remove0(string str){\n  while(str.size() > 1 && str[0] == '0') str = str.substr(1);\n  return str;\n}\n\nbool isnum(char c){\n  return ('0' <= c && c <= '9');\n}\n\nstring smax(string s1,string s2){\n  if(s1.size() > s2.size()) return s1;\n  if(s1.size() < s2.size()) return s2;\n  if(s1 > s2) return s1;\n  else return s2;\n}\n\nint main(){\n  int w,h;\n  while(cin>>w>>h,w+h){\n    string max = \"\";\n    vector<vector<char> > map(h,vector<char>(w));\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tcin>>map[i][j];\n      }\n    }\n    vector<vector<string> > dp(h,vector<string>(w,\"\"));\n    for(int i=h-1;i>=0;i--){\n      for(int j=w-1;j>=0;j--){\n\tif(isnum(map[i][j])){\n\t  if(dp[i][j] == \"\") dp[i][j] = string(1,map[i][j]);\n\t  if(i!=0 && isnum(map[i-1][j])){\n\t    dp[i-1][j] = smax(string(1,map[i-1][j]) + dp[i][j],dp[i-1][j]);\n\t  }\n\t  if(j!=0 && isnum(map[i][j-1])){\n\t    dp[i][j-1] = smax(string(1,map[i][j-1]) + dp[i][j],dp[i][j-1]);\n\t  }\n\t}\n      }\n    }\n    for(int i=0;i<h;i++){\n      for(int j=0;j<w;j++){\n\tmax = smax(max,remove0(dp[i][j]));\n      }\n    }\n    cout<<max<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "\n#include <cstdio>\n#include <cstdlib>\n#include <cmath>\n#include <climits>\n#include <cfloat>\n#include <cstring>\n#include <map>\n#include <utility>\n#include <set>\n#include <iostream>\n#include <memory>\n#include <string>\n#include <vector>\n#include <algorithm>\n#include <functional>\n#include <sstream>\n#include <complex>\n#include <stack>\n#include <queue>\n#include <unordered_set>\n#include <unordered_map>\nusing namespace std;\n\nvector<string>grid;\nstring memo[70][70];\nbool comp(const string& s1, const string& s2)\n{\n\tif (s1.size() == s2.size())\n\t{\n\t\treturn s1 < s2;\n\t}\n\treturn s1.size() < s2.size();\n}\nstring dp(int i, int j)\n{\n\tif (i < 0 || j < 0)return \"\";\n\tif (memo[i][j] != \"-1\")return memo[i][j];\n\tstring s = \"\";\n\tif (!isalpha(grid[i][j]))\n\t{\n\t\tstring s1 = dp(i - 1, j);\n\t\tstring s2 = dp(i, j - 1);\n\t\tif (comp(s1, s2))\n\t\t{\n\t\t\ts = s2;\n\t\t}\n\t\telse\n\t\t{\n\t\t\ts = s1;\n\t\t}\n\t\ts.push_back(grid[i][j]);\n\t}\n\twhile (!s.empty() && s.front() == '0')s.erase(s.begin(), s.begin() + 1);\n\treturn memo[i][j] = s;\n}\n\nint main(void)\n{\n\tint w, h;\n\tfor (;;)\n\t{\n\t\tcin >> w >> h;\n\t\tif (!w)break;\n\t\tgrid.clear();\n\t\tfor (int i = 0; i < h; ++i)\n\t\t{\n\t\t\tstring c;\n\t\t\tcin >> c;\n\t\t\tgrid.push_back(c);\n\t\t\tfor (int j = 0; j < w; ++j)\n\t\t\t{\n\t\t\t\tmemo[i][j] = \"-1\";\n\t\t\t}\n\t\t}\n\t\tstring ans;\n\t\tfor (int i = 0; i < h; ++i)\n\t\t{\n\t\t\tfor (int j = 0; j < w; ++j)\n\t\t\t{\n\t\t\t\tstring s = dp(i, j);\n\t\t\t\tif (comp(ans, s))\n\t\t\t\t{\n\t\t\t\t\tans = s;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <map>\n#include <vector>\n#include <set>\n#include <iomanip>\n#include <stack>\n#include <fstream>\n#include <cstdint>\n#include <cmath>\n#include <algorithm>\n#include <utility>\n#include <numeric>\n#include <functional>\n\nusing namespace std;\n\nconstexpr int INF = 1000000000;/* 1e+9a */\nconstexpr int MODULO = 1000000007;\n\ntypedef int64_t ll;\n\n\n\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    int w, h;\n    while(cin >> w >> h){\n        if(w == 0 && h == 0) break;\n        vector<vector<char>> c;\n        for (int i = 0; i < h; ++i) {\n            c.push_back({});\n            for (int j = 0; j < w; ++j) {\n                char tmp;\n                std::cin >> tmp;\n                if('A' <= tmp && tmp <= 'Z'){\n                    tmp = '!';\n                }\n                c[i].push_back(tmp);\n            }\n        }\n        vector<vector<bool>> is_subseq(h, vector<bool>(w));\n        string maxim = \"\";\n        for (int i = 0; i < h; ++i) {\n            for (int j = 0; j < w; ++j) {\n                if(c[i][j] != '!' && c[i][j] != '0' && !is_subseq[i][j]){\n                    stack<pair<int,int>> Nxy;\n                    stack<string> Nst;\n                    Nxy.push({i, j});\n                    Nst.push(string(\"\") + c[i][j]);\n                    while(!Nxy.empty()){\n                        auto xy = Nxy.top();\n                        auto st = Nst.top();\n                        Nxy.pop(), Nst.pop();\n                        int x = xy.first;\n                        int y = xy.second;\n                        bool pushed = false;\n                        if(x+1 < h){\n                            if(c[x+1][y] != '!'){\n                                is_subseq[x+1][y] = true;\n                                Nxy.push({x+1, y});\n                                Nst.push(st + c[x+1][y]);\n                                pushed = true;\n                            }\n                        }\n                        if(y+1 < w){\n                            if(c[x][y+1] != '!'){\n                                is_subseq[x][y+1] = true;\n                                Nxy.push({x, y+1});\n                                Nst.push(st + c[x][y+1]);\n                                pushed = true;\n                            }\n                        }\n                        if(!pushed){\n                            maxim = max(st, maxim, [](const string&a, const string&b){\n                                if(a.size() == b.size())\n                                    return a < b;\n                                return a.size() < b.size();\n                            });\n                        }\n                    }\n                }\n            }\n        }\n        cout << maxim << '\\n';\n\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double ld;\ntypedef pair<ll, ll> P;\n\n#define EACH(i,a) for (auto& i : a)\n#define FOR(i,a,b) for (ll i=(a);i<(b);i++)\n#define RFOR(i,a,b) for (ll i=(b)-1;i>=(a);i--)\n#define REP(i,n) for (ll i=0;i<(n);i++)\n#define RREP(i,n) for (ll i=(n)-1;i>=0;i--)\n#define debug(x) cout<<#x<<\": \"<<x<<endl\n#define pb push_back\n#define ALL(a) (a).begin(),(a).end()\n\nconst ll linf = 1e18;\nconst int inf = 1e9;\nconst double eps = 1e-12;\nconst double pi = acos(-1);\n\ntemplate<typename T>\nistream& operator>>(istream& is, vector<T>& vec) {\n\tEACH(x,vec) is >> x;\n\treturn is;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, vector<T>& vec) {\n\tREP(i,vec.size()) {\n\t\tif (i) os << \" \";\n\t\tos << vec[i];\n\t}\n\treturn os;\n}\ntemplate<typename T>\nostream& operator<<(ostream& os, vector< vector<T> >& vec) {\n\tREP(i,vec.size()) {\n\t\tif (i) os << endl;\n\t\tos << vec[i];\n\t}\n\treturn os;\n}\n\nint dx[2] = {1, 0};\nint dy[2] = {0, 1};\n\nint W, H;\nvector<string> m;\nbool m1[100][100] = {0};\nstring m2[100][100];\nstring beautify(string s) {\n\tif (s.size() == 0) return \"\";\n\tint l = (int)s.size()-1;\n\tREP(i,s.size()) {\n\t\tif (s[i] != '0') {\n\t\t\tl = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn s.substr(l, s.size()-l);\n}\nbool gt(string s1, string s2) {\n\ts1 = beautify(s1);\n\ts2 = beautify(s2);\n\tif (s1.size() == s2.size()) {\n\t\treturn s1 > s2;\n\t}\n\treturn s1.size() > s2.size();\n}\nstring dp(int x, int y) {\n\tstring res = \"\";\n\tif (x < 0 || x >= W || y < 0 || y >= H) return \"\";\n\tif ( !isdigit(m[y][x]) ) return \"\";\n\tif (m1[y][x]) return m2[y][x];\n\tREP(i, 2) {\n\t\tint nx = x + dx[i];\n\t\tint ny = y + dy[i];\n\t\tstring a = \"\"; a += m[y][x];\n\t\ta += dp(nx, ny);\n\t\tif ( gt(a, res) ) res = a;\n\t}\n\treturn m1[y][x] = true, m2[y][x] = res;\n}\n\n\nint main() {\n\tstd::ios::sync_with_stdio(false);\n\tstd::cin.tie(0);\n\twhile (cin >> W >> H, W || H) {\n\t\tm.resize(H); cin >> m;\n\t\tfill(m1[0], m1[100], false);\n\t\tstring ans = \"0\";\n\t\tREP(y, H) REP(x, W) {\n\t\t\tif ( gt( dp(x, y), ans ) ) ans = beautify( dp(x, y) );\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstring>\n#define pb push_back\n#include<vector>\n#include<cstdio>\nusing namespace std;\nstring m(string s,string t){\n\tint a=s.size(),b=t.size();\n\tif(a!=b)\n\t\treturn a>b?s:t;\n\treturn s>t?s:t;\n}\nint main(){\n\tint h,w;\n\twhile(scanf(\"%d%d\",&w,&h),w||h){\n\t\t//char d[80][80];\n\t\tstring d[80];\n\t\tfor(int i=0;i<h;i++){\n\t\t\t//scanf(\"%s\",d[i]);\n\t\t\tcin>>d[i];\n\t\t}\n\t\tstring ans=\"0\";\n\t\tstring dp[80][80];\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tif(isdigit(d[i][j])){\n\t\t\t\t\tstring a,b;\n\t\t\t\t\t/*if(i>=1){\n\t\t\t\t\t\ta=dp[i-1][j];\n\t\t\t\t\t}else\n\t\t\t\t\ta=\"\";\n\t\t\t\t\tif(j>=1){\n\t\t\t\t\t\tb=dp[i][j-1];\n\t\t\t\t\t}else\n\t\t\t\t\tb=\"\";\n\t\t\t\t\t*/\n\t\t\t\t\tif(i>=1&&j>=1){\n\t\t\t\t\t\tdp[i][j]=m(dp[i-1][j],dp[i][j-1])+d[i][j];\n\t\t\t\t\t}else if(i>=1){\n\t\t\t\t\t\tdp[i][j]=dp[i-1][j]+d[i][j];\n\t\t\t\t\t}else if(j>=1){\n\t\t\t\t\t\tdp[i][j]=dp[i][j-1]+d[i][j];\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t//dp[i][j]=m(a,b)+d[i][j];\n\t\t\t\t\tif(dp[i][j][0]=='0')\n\t\t\t\t\t\tdp[i][j]=dp[i][j].substr(1);\n\t\t\t\t\tans=m(ans,dp[i][j]);\n\t\t\t\t}else\n\t\t\t\tdp[i][j]=\"\";\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <utility>\n#include <stack>\n#include <vector>\n#include <queue>\n#include <algorithm>\n#include <map>\n#include <climits>\n#include <set>\n#include <numeric>\n#include <iomanip>\n#include <cmath>\n#include <cstring>\nusing namespace std;\n\nstring remove_front_zero(string n){\n  for(int i = 0; i < n.size(); i++){\n    if(n[i] != '0'){\n      string ret;\n      for(int j = i; j < n.size(); j++){\n        ret.push_back(n[j]);\n      }\n      return ret;\n    }\n  }\n  return \"0\";\n}\n\nbool dp_less(string n1, string n2){\n  if(n1.size() < n2.size()){\n    return true;\n  }\n  if(n1.size() > n2.size()){\n    return false;\n  }\n  for(int i = 0; i < n1.size(); i++){\n    if(n1[i] < n2[i]){\n      return true;\n    }\n    if(n1[i] > n2[i]){\n      return false;\n    }\n  }\n  return false;\n}\n\nbool real_less(string x, string y){\n  string n1 = remove_front_zero(x);\n  string n2 = remove_front_zero(y);\n  if(n1.size() < n2.size()){\n    return true;\n  }\n  if(n1.size() > n2.size()){\n    return false;\n  }\n  for(int i = 0; i < n1.size(); i++){\n    if(n1[i] < n2[i]){\n      return true;\n    }\n    if(n1[i] > n2[i]){\n      return false;\n    }\n  }\n  return false;\n}\n\nstring grid[70];\nstring dp[70][70];\nint main(){\n  while(true){\n    int W;\n    int H;\n    cin >> W >> H;\n    if(W == 0 && H == 0){\n      break;\n    }\n    for(int i = 0; i < H; i++){\n      cin >> grid[i];\n    }\n    for(int i = 0; i < H; i++){\n      for(int j = 0; j < W; j++){\n        dp[i][j] = \"\";\n      }\n    }\n  \n\n    for(int i = H - 1; i >= 0; i--){\n      for(int j = W - 1; j >= 0; j--){\n        if('A' <= grid[i][j] && grid[i][j] <= 'Z'){\n          continue;\n        }\n        string max_next = \"\";\n        if(i < H - 1 && '0' <= grid[i + 1][j] && grid[i + 1][j] <= '9'){\n          max_next = dp[i + 1][j];\n        }\n        if(j < W - 1 && '0' <= grid[i][j + 1] && grid[i][j + 1] <= '9'){\n          if(dp_less(max_next, dp[i][j + 1])){\n            max_next = dp[i][j + 1];\n          }\n        }\n        reverse(max_next.begin(), max_next.end());\n        max_next.push_back(grid[i][j]);\n        reverse(max_next.begin(), max_next.end());\n        dp[i][j] = max_next;\n      }\n    }\n\n    string ans = \"0\";\n    for(int i = 0; i < H; i++){\n      for(int j = 0; j < W; j++){\n        if(real_less(ans, dp[i][j])){\n          ans = dp[i][j];\n        }\n      }\n    }\n    cout << remove_front_zero(ans) << endl;\n  }\n  return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <algorithm>\n\n\nusing namespace std;\n\nint const N = 100;\nchar table[N][N] = {};\nbool vd[N][N] = {};\n\nvoid clear() {\n    for( int i=0; i<N; ++i ) {\n        for( int j=0; j<N; ++j ) {\n            table[i][j] = 0;\n            vd[i][j] = false;\n        }\n    }\n}\n\nint const dir[][2] = {{1,0}, {0, 1}};\nvoid find( vector<string>& ss, string& s, int const x, int const y, int const w, int const h )\n{\n    s += table[x][y];\n    vd[x][y] = true;\n\n    for( int i=0; i<2; ++i ) {\n        int const nx = x + dir[i][0];\n        int const ny = y + dir[i][1];\n        if ( nx < 0 || ny < 0 || nx >= w || ny >= h )\n            continue;\n        \n        if ( table[nx][ny] >= '0' && table[nx][ny] <= '9' ) {\n//            string copied = s;\n            find( ss, s, nx, ny, w, h );\n        }\n    }\n\n    ss.push_back( s );\n    s.erase( s.end() - 1 );\n}\n\ntemplate<typename T>\nstruct bun\n{\n    bool operator()( T const& l, T const& r ) {\n        return l.size() > r.size() || (l.size() == r.size() && l > r);\n    }\n};\n\nint main()\n{\n    for(;;) {\n        int w, h;\n        cin >> w >> h;\n        if ( w == 0 && h == 0 )\n            break;\n\n        clear();\n        cin.ignore(255, '\\n');\n        for( int y=0; y<h; ++y ) {\n            string s;\n            getline( cin, s );\n            for( int x=0; x<w; ++x ) {\n                table[x][y] = s[x];\n            }\n        }\n\n        vector<string> ss;\n        string s;\n        for( int x=0; x<w; ++x ) {\n            for( int y=0; y<h; ++y ) {\n                if ( table[x][y] >= '1' && table[x][y] <= '9' && !vd[x][y] ) {\n                    //find( ss, s, x, y, w, h );\n                }\n            }\n        }\n        stable_sort( ss.begin(), ss.end(), bun<string>() );\n\n        //for( int i=0; i<ss.size(); ++i )\n            //cout << ss[i] << endl;\n        //    ;\n\n\n        //cout << ss[0] << endl;\n        //cout << \"======\" << endl;\n    };\n}"
  },
  {
    "language": "C++",
    "code": "///\n// File:  1126.cpp\n// Author: ymiyamoto\n//\n// Created on Sun Dec 10 00:54:34 2017\n//\n\n#include <cstdint>\n#include <iostream>\n#include <string>\n#include <vector>\n\nusing namespace std;\nbool bigger(string str1, string str2)\n{\n  if (str1.size() == str2.size()) {\n    return str1 < str2;\n  } else {\n    return str1.size() < str2.size();\n  }\n}\n\nstring wfs(vector<string> matrix, vector<vector<string>> &memo, uint32_t i, uint32_t j, string aux)\n{\n  if (i < matrix.size() && j < matrix[0].size() && memo[i][j] != \"\") return memo[i][j];\n\n  if (i >= matrix.size() || j >= matrix[0].size() || !isdigit(matrix[i][j]))\n    return aux;\n  else {\n    string number(aux);\n    if (number == \"\" && matrix[i][j] == '0') {\n    } else {\n      number += matrix[i][j];\n    }\n    string s1 = wfs(matrix, memo, i + 1, j, number);\n    string s2 = wfs(matrix, memo, i, j + 1, number);\n    return memo[i][j] = bigger(s1, s2) ? s2 : s1;\n  }\n}\n\nint32_t main()\n{\n  while (true) {\n    uint32_t W, H;\n    cin >> W >> H;\n    if (W == 0 && H == 0) break;\n    vector<string> matrix;\n    for (uint32_t i = 0; i < H; i++) {\n      string line;\n      cin >> line;\n      matrix.push_back(line);\n    }\n\n    string number = \"\";\n    vector<vector<string>> memo(H, vector<string>(W, \"\"));\n    for (uint32_t i = 0; i < matrix.size(); i++) {\n      for (uint32_t j = 0; j < matrix[0].size(); j++) {\n        string num = wfs(matrix, memo, i, j, \"\");\n        if (bigger(number, num)) {\n          number = num;\n        }\n      }\n    }\n    cout << number << endl;\n  }\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\nint w, h;\nstring s[51], dp[51][51];\nbool is_num(char c){return '0'<=c && c<= '9';}\n\nstring str_max(string s1, string s2) {\n  if (s1.size() == s2.size()) {\n    return (s1 > s2) ? s1 : s2 ;\n  }\n  return (s1.size() > s2.size())? s1 : s2 ;\n}\n\nstring dfs(int i, int j) {\n  string res = \"\";\n  \n  // l¶áÈ¢ê\n  if (!is_num(s[i][j])) return res;\n  // DP\n  if (dp[i][j] != \"\") return dp[i][j];\n  \n  if (i+1 >= h && j+1 >= w) {\n    // EÉàºÉàißÈ¢\n    res += s[i][j];\n  } else if (i+1 >= h) {\n    // EÉ¾¯ißé\n    res += s[i][j] + dfs(i, j+1);\n  } else if (j+1 >= w) {\n    // ºÉ¾¯ißé\n    res += s[i][j] + dfs(i+1, j);\n  } else {\n    // Ç¿çÉàißé\n    res = s[i][j] + str_max(dfs(i, j+1), dfs(i+1, j));\n  }\n  // ªÉ0ªÂ¢Ä¢éêÍæé\n  if (i == 0 && j == 0) {\n    if (res[0] == '0') res.erase(0, 1);\n  } else if (i == 0) {\n    if (!is_num(s[i][j-1]) && res[0] == '0') res.erase(0, 1);\n  } else if (j == 0) {\n    if (!is_num(s[i-1][j]) && res[0] == '0') res.erase(0, 1);\n  } else{\n    if (!is_num(s[i-1][j]) && !is_num(s[i][j-1])) res.erase(0, 1);\n  }\n  \n  return dp[i][j] = res;\n}\n\nvoid solve() {\n  for(int i=0;i<h;i++) cin>>s[i];\n  // init\n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  dp[i][j] = \"\";\n  \n  // search\n  string largest = \"\";\n  \n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  if (dp[i][j] == \"\")\n  largest = str_max(dfs(i, j), largest);\n  /*\n  for(int i=0;i<h;i++) {\n    for(int j=0;j<w;j++) cout<<\"[\"<<dp[i][j]<<\"]\";\n    cout<<endl;\n  }*/\n  \n  cout<<largest<<endl;\n}\n\nint main (int argc, char const* argv[]) {\n  while (cin>>w>>h, w||h) {\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\nusing namespace std;\nint w, h;\nint gc;\nstring s[51], dp[51][51];\nbool is_num(char c){return '0'<=c && c<= '9';}\n\nstring str_max(const string& s1, const string& s2) {\n  if (s1.size() == s2.size()) {\n    return (s1 > s2) ? s1 : s2 ;\n  }\n  return (s1.size() > s2.size())? s1 : s2 ;\n}\n\nstring dfs(int i, int j) {\n  string res = \"\";\n  \n  if (!is_num(s[i][j])) return res;\n  if (i >= h || j >= w) return res;\n  // DP\n  if (dp[i][j] != \"\") return dp[i][j];\n  \n  //gc++;\n\n  res = s[i][j] + str_max(dfs(i, j+1), dfs(i+1, j));\n  \n  // ªÉ0ªÂ¢Ä¢éêÍæé\n  if (i == 0 && j == 0) {\n    if (res[0] == '0') res.erase(0, 1);\n  } else if (i == 0) {\n    if (!is_num(s[i][j-1]) && res[0] == '0') res.erase(0, 1);\n  } else if (j == 0) {\n    if (!is_num(s[i-1][j]) && res[0] == '0') res.erase(0, 1);\n  } else{\n    if (!is_num(s[i-1][j]) && !is_num(s[i][j-1])) res.erase(0, 1);\n  }\n  \n  return dp[i][j] = res;\n}\n\nvoid solve() {\n  for(int i=0;i<h;i++) cin>>s[i];\n  // init\n  for(int i=0;i<h;i++)\n  for(int j=0;j<w;j++)\n  dp[i][j] = \"\";\n  \n  // search\n  string largest = \"\";\n  //gc = 0;\n  \n  for(int i=h-1;i>=0;i--)\n  for(int j=w-1;j>=0;j--)\n  if (dp[i][j] == \"\" && is_num(s[i][j]))\n  largest = str_max(dfs(i, j), largest);\n  \n  /*\n  for(int i=0;i<h;i++) {\n    for(int j=0;j<w;j++) cout<<\"[\"<<dp[i][j]<<\"]\";\n    cout<<endl;\n  }*/\n  \n  //cout<<gc<<endl;\n  cout<<largest<<endl;\n}\n\nint main (int argc, char const* argv[]) {\n  while (cin>>w>>h, w||h) {\n    solve();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\n#include <map>\n\nusing namespace std;\n\nstring norm(string str) {\n\tint ind = 0;\n\tfor (int i = 0; i < str.length() && str[i] == '0'; ++i) {\n\t\t++ind;\n\t}\n\tif (ind > 0) {\n\t\treturn str.substr(ind,str.length()-ind);\n\t}\n\treturn str;\n}\n\nstring str_max(string s1, string s2) {\n\ts1 = norm(s1);\n\ts2 = norm(s2);\n\tif (s1.length() > s2.length()) {\n\t\treturn s1;\n\t}\n\tif (s2.length() > s1.length()) {\n\t\treturn s2;\n\t}\n\n\tif (s1 > s2) {\n\t\treturn s1;\n\t}\n\treturn s2;\n}\n\nint main(void) {\n\tint W,H;\n\twhile (cin >> W >> H, W) {\n\t\tvector< vector<string> > mat(H,vector<string>(W));\n\t\tfor (int i = 0; i < H; ++i) {\n\t\t\tfor (int j = 0; j < W; ++j) {\n\t\t\t\tstring temp = \"\";\n\t\t\t\tchar c;\n\t\t\t\tcin >> c;\n\t\t\t\tif (c >= '0' && c <= '9') {\n\t\t\t\t\ttemp += c;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttemp = \" \";\n\t\t\t\t}\n\t\t\t\tmat[i][j] = temp;\n\t\t\t}\n\t\t}\n\n\t\tstring res = \"0\";\n\t\tvector< vector<string> > dp(H,vector<string>(W,\"\"));\n\t\tfor (int i = 0; i < H; ++i) {\n\t\t\tfor (int j = 0; j < W; ++j) {\n\t\t\t\tif (mat[i][j] != \" \") {\n\t\t\t\t\tif (dp[i][j] == \"\") {\n\t\t\t\t\t\tdp[i][j] = mat[i][j];\n\t\t\t\t\t\tres = str_max(res,dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tif (j+1 < W && mat[i][j+1] != \" \") {\n\t\t\t\t\t\tdp[i][j+1] = str_max(dp[i][j]+mat[i][j+1],dp[i][j+1]);\n\t\t\t\t\t\tres = str_max(dp[i][j+1],res);\n\t\t\t\t\t}\n\t\t\t\t\tif (i+1 < H && mat[i+1][j] != \" \") {\n\t\t\t\t\t\tdp[i+1][j] = str_max(dp[i][j]+mat[i+1][j],dp[i+1][j]);\n\t\t\t\t\t\tres = str_max(dp[i+1][j],res);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << res << endl;\n\t}\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <vector>\nusing namespace std;\n\nchar field[70][70];\nint w, h;\nint dy[] = {0, 1}, dx[] = {1, 0};\nvector<string> numbers;\nsize_t maxLength;\n\nvoid search(const int y, const int x, string number) {\n    number += field[y][x];\n    bool isEnd = true;\n    for (int i = 0; i < 2; i++) {\n        int ny = y + dy[i], nx = x + dx[i];\n        if (ny < h && nx < w && '0' <= field[ny][nx] && field[ny][nx] <= '9') {\n            isEnd = false;\n            search(ny, nx, number);\n        }\n    }\n    if (isEnd) {\n        numbers.push_back(number);\n        if (maxLength < number.length()) {\n            maxLength = number.length();\n        }\n    }\n}\n\nint main() {\n    while (true) {\n        cin >> w >> h;\n        if ((w | h) == 0) {\n            break;\n        }\n        for (int y = 0; y < h; y++) {\n            cin >> field[y];\n        }\n        numbers.clear();\n        maxLength = 0;\n        for (int y = 0; y < h; y++) {\n            for (int x = 0; x < w; x++) {\n                if (0 < x && '0' <= field[y][x - 1] && field[y][x - 1] <= '9') {\n                    continue;\n                }\n                if (0 < y && '0' <= field[y - 1][x] && field[y - 1][x] <= '9') {\n                    continue;\n                }\n                if ('0' < field[y][x] && field[y][x] <= '9') {\n                    string number = \"\";\n                    search(y, x, number);\n                }\n            }\n        }\n        string max = \"0\";\n        for (vector<string>::iterator it = numbers.begin(); it != numbers.end(); it++) {\n            if ((*it).length() < maxLength) {\n                continue;\n            }\n            if (max < *it) {\n                max = *it;\n            }\n        }\n        cout << max << endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <string>\n\nusing namespace std;\n\nstring dp[101][101];\n\nconst int dy[]={0,1};\nconst int dx[]={1,0};\n\nint w,h;\nchar field[101][101];\n\nstring maxString(string str1,string str2){\n\tstring res1=str1;\n\tstring res2=str2;\n\n\tif(str1==\"\"){\n\t\treturn str2;\n\t}\n\telse if(str2==\"\"){\n\t\treturn str1;\n\t}\n\n\t// ツ静ヲツ督ェツづ頚eroツづーツ湘つキ\n\tint idx1=str1.size()-1;\n\tfor(int i = 0; i < (int)(str1.size())-1; i++){\n\t\tif(str1[i]!='0'){\n\t\t\tidx1=i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tstr1=str1.substr(idx1);\n\tidx1=str2.size()-1;\n\tfor(int i = 0; i < (int)(str2.size())-1; i++){\n\t\tif(str2[i]!='0'){\n\t\t\tidx1=i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tstr2=str2.substr(idx1);\n\tif(str1.size()>str2.size())\n\t\treturn res1;\n\telse if(str1.size()<str2.size())\n\t\treturn res2;\n\telse{\n\t\tfor(int i = 0; i < str1.size(); i++){\n\t\t\tif(str1[i]>str2[i]){\n\t\t\t\treturn res1;\n\t\t\t}\n\t\t\telse if(str1[i]<str2[i]){\n\t\t\t\treturn res2;\n\t\t\t}\n\t\t}\n\t\treturn res1;\n\t}\n}\n\nstring dfs(int x,int y){\n\tif(dp[y][x]!=\"\")\n\t\treturn dp[y][x];\n\tif(!(field[y][x]>='0'&&field[y][x]<='9')){\n\t\treturn \"\";\n\t}\n\tstring res=\"\";\n\tfor(int i = 0; i < 2; i++){\n\t\tint ny=y+dy[i];\n\t\tint nx=x+dx[i];\n\t\tif(ny>=0&&nx>=0&&ny<h&&nx<w&&(field[ny][nx]>='0'&&field[ny][nx]<='9')){\n\t\t\tstring s=(dfs(nx,ny));\n\t\t\tif(s!=\"\")\n\t\t\t\tres=maxString(res,s);\n\t\t}\n\t}\n\tres=field[y][x]+res;\n\tdp[y][x]=res;\n\treturn res;\n}\n\nint main(){\n\n\twhile(cin>>w>>h&&!(w==0&&h==0)){\n\t\tfor(int i = 0; i < 101; i++){\n\t\t\tfor(int j =0; j < 101; j++){\n\t\t\t\tdp[i][j]=\"\";\n\t\t\t\tfield[i][j]=0;\n\t\t\t}\n\t\t}\n\n\t\tfor(int i = 0; i < h; i++){\n\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\tcin>>field[i][j];\n\t\t\t}\n\t\t}\n\t\tstring maxNum=\"\";\n\t\tfor(int i = 0; i < h; i++){\n\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\tstring res=dfs(j,i);\n\t\t\t\tif(res==\"\")\n\t\t\t\t\tcontinue;\n\t\t\t\tmaxNum=maxString(maxNum,res);\n\t\t\t}\n\t\t}\n\n\t\t// ツ静ヲツ督ェツづ頚eroツづーツ湘つキ\n\t\tif(maxNum!=\"\"){\n\t\t\tint idx1=maxNum.size()-1;\n\t\t\tfor(int i = 0; i < (int)(maxNum.size())-1; i++){\n\t\t\t\tif(maxNum[i]!='0'){\n\t\t\t\t\tidx1=i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmaxNum=maxNum.substr(idx1);\n\t\t}\n\t\tcout<<maxNum<<endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cstdio>\n#include <iostream>\n#include <map>\n#include <cmath>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <stdlib.h>\n#include <stdio.h>\n#include <bitset>\n#include <cstring>\nusing namespace std;\n#define FOR(I,A,B) for(int I = (A); I < (B); ++I)\n#define CLR(mat) memset(mat, 0, sizeof(mat))\ntypedef long long ll;\nint W, H;\nvector<string> vs(70);\nstring ans;\nbool checked[70][70]; \nbool calc(string a, string b) {\n  if(a.length() > b.length()) return true;\n  if(a.length() < b.length()) return false;\n  else return a > b;\n}\nvoid dfs(int h, int w, string s) {\nchecked[h][w] = true;\n  if(h < 0 || h >= H || w < 0 || w >= W || !isdigit(vs[h][w])) {\n    if(calc(s, ans)) ans = s;\n    return;\n  }\n  s += vs[h][w];\n  dfs(h+1,w,s);\n  dfs(h,w+1,s);\n  return;\n}\nint main()\n{\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  while(cin>>W>>H,W||H) {\n    FOR(i,0,H) cin >> vs[i];\n    ans = \"\";\n    CLR(checked);\n    FOR(h,0,H) {\n      FOR(w,0,W) {\n        if(checked[h][w]) continue;\n        checked[h][w] = true;\n        dfs(h, w, \"\");\n      } \n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<string>\n\nusing namespace std;\n\nconst int N = 70;\n\nchar input[N][N];\nstring myMax(string a, string b){\n  if(a.length() != b.length()){\n    if(a.length() > b.length()) return a;\n    else return b;\n  }\n  return max(a,b);\n}\n\nstring solve(int h, int w){\n  string dp[h][w];\n  for(int i = 0; i < h; i++){\n    for(int j = 0; j < w; j++){\n      if(isalpha(input[i][j]) || input[i][j] == '0'){\n\tdp[i][j] = \"\";\n      }else{\n\tdp[i][j] = input[i][j];\n      }\n    }\n  }\n\n  string result = \"0\";\n  \n  for(int i = 0; i < h; i++){\n    for(int j = 0; j < w; j++){\n      if(isalpha(input[i][j])) continue;\n\n      if(i > 0 && dp[i-1][j] != \"\"){\n\tdp[i][j] = myMax(dp[i][j],dp[i-1][j]+input[i][j]);\n      }\n      if(j > 0 && dp[i][j-1] != \"\"){\n\tdp[i][j] = myMax(dp[i][j],dp[i][j-1]+input[i][j]);\n      }\n\n      result = myMax(result,dp[i][j]);\n    }\n  }\n  return result;\n}\n\nint main(){\n  int h,w;\n  while(cin >> w >> h){\n    if(w == 0 && h == 0) break;\n    for(int i = 0; i < h; i++){\n      for(int j = 0; j < w; j++){\n\tcin >> input[i][j];\n      }\n    }\n    cout << solve(h,w) << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <algorithm>\n#include <cmath>\n#include <climits>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <fstream>\n#include <iostream>\n#include <list>\n#include <map>\n#include <queue>\n#include <set>\n#include <sstream>\n#include <stack>\n#include <string>\n#include <vector>\n#include <cassert>\n#include <functional>\n\nusing namespace std;\n\n#define LOG(...) printf(__VA_ARGS__)\n//#define LOG(...)\n#define FOR(i,a,b) for(int i=(int)(a);i<(int)(b);++i)\n#define REP(i,n) for(int i=0;i<(int)(n);++i)\n#define ALL(a) (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(),(a).rend()\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n#define RSORT(c) sort((c).rbegin(),(c).rend())\n#define CLR(a) memset((a), 0 ,sizeof(a))\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef vector<bool> vb;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<vb> vvb;\ntypedef vector<vi> vvi;\ntypedef vector<vll> vvll;\ntypedef pair<int, int> pii;\ntypedef pair<ll, ll> pll;\n\nconst int dx[] = { -1, 0, 1, 0 }; const int dy[] = { 0, 1, 0, -1 };\n\nint main() {\n\tint w, h;\n\twhile (cin >> w >> h, w) {\n\t\tvector<string> codes(h);\n\t\tREP(i, h)\n\t\t\tcin >> codes[i];\n\t\tvector<vector<string>> memo(h, vector<string>(w));\n\t\tREP(i, h)\n\t\t\tREP(j, w)\n\t\t\tmemo[i][j] = codes[i][j];\n\t\tfor (int i = h - 1;i >= 0;i--) {\n\t\t\tfor (int j = w - 1;j >= 0;j--) {\n\t\t\t\tif (isdigit(codes[i][j])) {\n\t\t\t\t\tif (i != h - 1 && isdigit(codes[i + 1][j]))\n\t\t\t\t\t\tif (memo[i][j].length() < memo[i + 1][j].length() + 1)\n\t\t\t\t\t\t\tmemo[i][j] = codes[i][j] + memo[i + 1][j];\n\t\t\t\t\t\telse if (memo[i][j].length() == memo[i + 1][j].length() + 1)\n\t\t\t\t\t\t\tmemo[i][j] = max(memo[i][j], codes[i][j] + memo[i+1][j]);\n\t\t\t\t\tif (j != w - 1 && isdigit(codes[i][j+1]))\n\t\t\t\t\t\tif (memo[i][j].length() < memo[i][j+1].length() + 1)\n\t\t\t\t\t\t\tmemo[i][j] = codes[i][j] + memo[i][j+1];\n\t\t\t\t\t\telse if (memo[i][j].length() == memo[i][j+1].length() + 1)\n\t\t\t\t\t\t\tmemo[i][j] = max(memo[i][j], codes[i][j] + memo[i][j+1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring ans = \"0\";\n\t\tREP(i, h)\n\t\t\tREP(j, w) {\n\t\t\tif ('1' <= memo[i][j][0] && memo[i][j][0] <= '9') {\n\t\t\t\tif (ans.length() < memo[i][j].length())\n\t\t\t\t\tans=memo[i][j];\n\t\t\t\telse if (ans.length() == memo[i][j].length())\n\t\t\t\t\tans = max(ans, memo[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout << ans << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint w, h;\nstring grid[71][71];\nstring dp[71][71];\n\nstring maxstr(string a, string b){\n\tif (a.size() > b.size()) return a;\n\tif (a.size() < b.size()) return b;\n\treturn max(a, b);\n}\n\nint main()\n{\n\twhile (scanf(\"%d %d\", &w, &h), w){\n\t\tfor (int i = 0; i < 71; i++){\n\t\t\tfor (int j = 0; j < 71; j++){\n\t\t\t\tgrid[i][j].clear();\n\t\t\t\tdp[i][j].clear();\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (int i = 0; i < h; i++){\n\t\t\tfor (int j = 0; j < w; j++){\n\t\t\t\tchar c;\n\t\t\t\tscanf(\" %c\", &c);\n\t\t\t\tif ('0' <= c && c <= '9'){\n\t\t\t\t\tgrid[i][j] += c;\n\t\t\t\t\tdp[i][j] += c;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (int i = 0; i < h; i++){\n\t\t\tfor (int j = 0; j < w; j++){\n\t\t\t\tif (grid[i][j].size() == 0) continue;\n\t\t\t\tif (dp[i][j] == \"0\") continue;\n\t\t\t\tif (grid[i][j + 1].size()){\n\t\t\t\t\tdp[i][j + 1] = maxstr(dp[i][j + 1], dp[i][j] + grid[i][j + 1]);\n\t\t\t\t}\n\t\t\t\tif (grid[i + 1][j].size()){\n\t\t\t\t\tdp[i + 1][j] = maxstr(dp[i + 1][j], dp[i][j] + grid[i + 1][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tstring maxi;\n\t\tfor (int i = 0; i <= h; i++){\n\t\t\tfor (int j = 0; j <= w; j++){\n\t\t\t\tmaxi = maxstr(maxi, dp[i][j]);\n\t\t\t}\n\t\t}\n\t\t\n\t\tcout << maxi << endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <vector>\n#include <string>\n#include <map>\n#include <algorithm>\n#include <queue>\n#include <unordered_map>\n\n#define lli long long int\n#define REP(i,n) for(lli i=0;i<n;i++)\n\n#define NUM 1000000\n\nusing namespace std;\n\nint length = 0;\n\nint max1(int a, int b){\n\tif (a >= b)return a;\n\telse return b;\n}\n\nint isIn(int x, int y, int w, int h){\n\tif (x < 0 || w <= x || y < 0 || h <= y){\n\t\treturn 0;\n\t}\n\telse{\n\t\treturn 1;\n\t}\n}\n\nint isNum(int x, int y, string *data){\n\tif ('0' <= data[y].at(x) && data[y].at(x) <= '9'){\n\t\treturn 1;\n\t}\n\telse{\n\t\treturn 0;\n\t}\n}\n\nstring emitZero(string str){\n\n\tstring rStr = \"\";\n\tREP(i, str.size()){\n\t\tif (str.at(i) != '0'){\n\t\t\trStr = str.substr(i, str.size());\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn rStr;\n\n}\n\nstring largeStr(string a, string b){\n\tif (a.size() > b.size()){\n\t\treturn a;\n\t}\n\telse if (a.size() == b.size()){\n\t\tif (a >= b){\n\t\t\treturn a;\n\t\t}\n\t\telse{\n\t\t\treturn b;\n\t\t}\n\t}\n\telse{\n\t\treturn b;\n\t}\n}\n\n\n/*\nvoid solve(int x, int y,int w,int h,string now,string *data, vector<string> *v,int **flag){\n\t\n\tif (!isIn(x,y,w,h) || isNum(x,y,data)==0){\n\t\t//cout << now << endl;\n\t\tnow = emitZero(now);\n\t\t//cout << now << endl;\n\t\t//cout << \"now.size = \" << now.size() << endl;\n\t\tlength = max1(length, now.size());\n\t\tv->push_back(now);\n\t\treturn;\n\t}\n\telse{\n\t\tflag[y][x] = 1;\n\t\tstring next = now + data[y].at(x);\n\t\tsolve(x + 1, y, w, h, next, data, v,flag);\n\t\tsolve(x, y + 1, w, h, next, data, v,flag);\n\t}\n}\n*/\n\nclass Point{\n\nprivate:\n\tint x, y;\npublic:\n\tvoid set(int sX, int sY){\n\t\tx = sX;\n\t\ty = sY;\n\t}\n\tint getX(){ return x; }\n\tint getY(){ return y; }\n\n\tbool operator < (const Point & right)const{\n\t\treturn x + y*NUM < right.x + right.y*NUM;\n\t}\n\n\tvoid show(){\n\t\tcout << \"X=\" << x << \" Y=\" << y << endl;\n\t}\n};\n\nclass now{\nprivate:\n\tPoint p;\n\tstring str;\npublic:\n\n\tvoid set(int sX, int sY, string sStr){\n\t\tp.set(sX, sY);\n\t\tstr = sStr;\n\t}\n\n\tPoint getPoint(){ return p; }\n\tstring getStr(){ return str; }\n\n};\n\nint main(){\n\n\n\t\n\tint w, h;\n\n\twhile (cin >> w >> h){\n\t\tif (w == 0 && h == 0)break;\n\t\tlength = 0;\n\t\tstring *data;\n\t\tdata = new string[h];\n\n\t\tREP(i, h){\n\t\t\tcin >> data[i];\n\t\t}\n\t\tint **flag = new int *[h];\n\t\tvector<string> v;\n\t\tqueue<Point> q;\n\t\tstring firstStr;\n\t\tmap<Point, string> m;\n\t\tPoint p;\n\t\tp.set(w - 1, h - 1);\n\t\tq.push(p);\n\t\t//q.front().show();\n\n\t\tREP(i, 100){\n\t\t\tREP(j, 100){\n\t\t\t\tPoint temp;\n\t\t\t\ttemp.set(i, j);\n\t\t\t\tm[temp] = \"\";\n\t\t\t}\n\t\t}\n\n\t\twhile (q.size() != 0){\n\n\t\t\tint unko;\n\t\t\t//cin >> unko;\n\t\t\tp = q.front();\n\t\t\tq.pop();\n\t\t\t//p.show();\n\n\n\t\t\tif (isNum(p.getX(), p.getY(), data) == 1){\n\t\t\t\tPoint right, down;\n\t\t\t\tright.set(p.getX() + 1, p.getY());\n\t\t\t\tdown.set(p.getX(), p.getY() + 1);\n\n\t\t\t\t//cout << data[p.getY()][p.getX()] << endl;\n\n\t\t\t\tm[p] = largeStr(m[p],data[p.getY()][p.getX()]+largeStr(m[right], m[down]));\n\t\t\t\t//cout << m[p] << endl;\n\t\t\t}\n\n\t\t\tif (p.getX() - 1 >= 0){\n\t\t\t\tPoint left;\n\t\t\t\tleft.set(p.getX() - 1, p.getY());\n\t\t\t\tq.push(left);\n\t\t\t}\n\t\t\tif (p.getY() - 1 >= 0){\n\t\t\t\tPoint up;\n\t\t\t\tup.set(p.getX(), p.getY() - 1);\n\t\t\t\tq.push(up);\n\t\t\t}\n\t\t}\n\n\t\tint length = 0;\n\t\tREP(i, h){\n\t\t\tREP(j, w){\n\t\t\t\tPoint tmp;\n\t\t\t\ttmp.set(j, i);\n\t\t\t\tstring tmpStr = m[tmp];\n\t\t\t\ttmpStr = emitZero(tmpStr);\n\n\t\t\t\tv.push_back(tmpStr);\n\t\t\t\tlength = max1(length, tmpStr.size());\n\t\t\t}\n\t\t}\n\n\t\tvector<string> ans;\n\n\t\tREP(i, v.size()){\n\t\t\tif (length == v.at(i).size()){\n\t\t\t\tans.push_back(v[i]);\n\t\t\t}\n\t\t}\n\n\t\tsort(ans.begin(), ans.end());\n\n\t\tcout << ans.back() << endl;\n\n\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\n#define REP(i,a,b) for(int i=a; i<b; ++i)\n#define rep(i,n) REP(i,0,n)\n\nchar input[70][70];\nstring dp[70][70];\n\nint comp(string s,string t) {\n  if(s.length() != t.length()) return (s.length() - t.length());\n  rep(i,s.length()) if(s[i] != t[i]) return (s[i] - t[i]);\n  return 0;\n}\n\nint main() {\n  int w,h,n;\n  while(cin>>w>>h, w|h) {\n    string s,above,left;\n    rep(i,h) {\n      cin>>s;\n      rep(j,w) {\n\tdp[i][j] = \"\";\n\tinput[i][j] = s[j];\n      }\n    }\n\n    rep(i,h) rep(j,w) {\n      char c = input[i][j];\n      if(!(c <= '9' && c >= '0')) continue;\n      above = ((i > 0 && dp[i-1][j] != \"0\") ? dp[i-1][j] : \"\") + string(1,c);\n      left = ((j > 0 && dp[i][j-1] != \"0\") ? dp[i][j-1] : \"\") + string(1,c);\n      dp[i][j] = (comp(above,left) <= 0) ? left : above;\n    }\n\n    string ans = \"\";\n    rep(i,h) rep(j,w) if(comp(ans,dp[i][j]) < 0) ans = dp[i][j];\n    cout<<ans<<endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#include<cctype>\n#include<math.h>\n#include<string>\n#include<string.h>\n#include<stack>\n#include<queue>\n#include<vector>\n#include<utility>\n#include<set>\n#include<map>\n#include<stdlib.h>\n#include<iomanip>\n\nusing namespace std;\n\n#define ll long long\n#define ld long double\n#define EPS 0.0000000001\n#define INF 1e9\n#define MOD 1000000007\n#define rep(i,n) for(i=0;i<(n);i++)\n#define loop(i,a,n) for(i=a;i<(n);i++)\n#define all(in) in.begin(),in.end()\n#define shosu(x) fixed<<setprecision(x)\n\ntypedef vector<int> vi;\ntypedef vector<string> vs;\ntypedef pair<int,int> pii;\n\nstring large(string s, string t){\n    if(s.size() == t.size()){\n        if(s>t) return s;\n        else return t;\n    }else if(s.size() > t.size()){\n        return s;\n    }else{\n        return t;\n    }\n}\n\nint main(void) {\n    int i,j;\n    int h, w;\n    while(cin >> w >> h, h+w){\n        vs s(h);\n        rep(i,h) cin >> s[i];\n        vector<vs> dp(h+1,vs(w+1));\n        rep(i,h)rep(j,w)if(s[i][j]>='0' && s[i][j]<='9'){\n            dp[i+1][j] = large(dp[i+1][j], dp[i][j]+s[i][j]);\n            dp[i][j+1] = large(dp[i][j+1], dp[i][j]+s[i][j]);\n        }\n        string ans=\"\";\n        rep(i,h+1)rep(j,w+1)ans = large(ans, dp[i][j]);\n        i=0;\n        while(i<ans.size() && ans[i]=='0')i++;\n        while(i<ans.size()){\n            cout << ans[i];\n            i++;\n        }\n        cout << endl;\n    }\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n//typedef\n//-------------------------#include <bits/stdc++.h>\n \nconst double pi = 3.141592653589793238462643383279;\n \n \nusing namespace std;\n \n//conversion\n//------------------------------------------\ninline int toInt(string s) { int v; istringstream sin(s); sin >> v; return v; }\ntemplate<class T> inline string toString(T x) { ostringstream sout; sout << x; return sout.str(); }\ninline int readInt() { int x; scanf(\"%d\", &x); return x; }\n \n//typedef\n//------------------------------------------\ntypedef vector<int> VI;\ntypedef vector<VI> VVI;\ntypedef vector<string> VS;\ntypedef pair<int, int> PII;\ntypedef pair<long long, long long> PLL;\ntypedef pair<int, PII> TIII;\ntypedef long long LL;\ntypedef unsigned long long ULL;\ntypedef vector<LL> VLL;\ntypedef vector<VLL> VVLL;\n \n \n//container util\n \n//------------------------------------------\n#define ALL(a)  (a).begin(),(a).end()\n#define RALL(a) (a).rbegin(), (a).rend()\n#define PB push_back\n#define MP make_pair\n#define SZ(a) int((a).size())\n#define SQ(a) ((a)*(a))\n#define EACH(i,c) for(typeof((c).begin()) i=(c).begin(); i!=(c).end(); ++i)\n#define EXIST(s,e) ((s).find(e)!=(s).end())\n#define SORT(c) sort((c).begin(),(c).end())\n \n \n//repetition\n//------------------------------------------\n#define FOR(i,s,n) for(int i=s;i<(int)n;++i)\n#define REP(i,n) FOR(i,0,n)\n#define MOD 998244353\n \n#define rep(i, a, b) for(int i = a; i < (b); ++i)\n#define trav(a, x) for(auto& a : x)\n#define all(x) x.begin(), x.end()\n#define sz(x) (int)(x).size()\n \ntypedef long long ll;\ntypedef pair<int, int> pii;\ntypedef vector<int> vi;\nconst double EPS = 1E-8;\n \n#define chmin(x,y) x=min(x,y)\n#define chmax(x,y) x=max(x,y)\n \nclass UnionFind {\npublic:\n    vector <int> par; \n    vector <int> siz; \n\n    UnionFind(int sz_): par(sz_), siz(sz_, 1) {\n        for (ll i = 0; i < sz_; ++i) par[i] = i;\n    }\n    void init(int sz_) {\n        par.resize(sz_);\n        siz.assign(sz_, 1LL);\n        for (ll i = 0; i < sz_; ++i) par[i] = i;\n    }\n \n    int root(int x) { \n        while (par[x] != x) {\n            x = par[x] = par[par[x]];\n        }\n        return x;\n    }\n \n    bool merge(int x, int y) {\n        x = root(x);\n        y = root(y);\n        if (x == y) return false;\n        if (siz[x] < siz[y]) swap(x, y);\n        siz[x] += siz[y];\n        par[y] = x;\n        return true;\n    }\n \n    bool issame(int x, int y) { \n        return root(x) == root(y);\n    }\n \n    int size(int x) { \n        return siz[root(x)];\n    }\n};\n \n \nll modPow(ll x, ll n, ll mod = MOD){\n    ll res = 1;\n    while(n){\n        if(n&1) res = (res * x)%mod;\n \n        res %= mod;\n        x = x * x %mod;\n        n >>= 1;\n    }\n    return res;\n}\n \n#define SIEVE_SIZE 5000000+10\nbool sieve[SIEVE_SIZE];\nvoid makeSieve(){\n    for(int i=0; i<SIEVE_SIZE; ++i) sieve[i] = true;\n    sieve[0] = sieve[1] = false;\n    for(int i=2; i*i<SIEVE_SIZE; ++i) if(sieve[i]) for(int j=2; i*j<SIEVE_SIZE; ++j) sieve[i*j] = false;\n}\n \nbool isprime(ll n){\n    if(n == 0 || n == 1) return false;\n    for(ll i=2; i*i<=n; ++i) if(n%i==0) return false;\n    return true;\n}\n \nconst int MAX = 2000010;\nlong long fac[MAX], finv[MAX], inv[MAX];\n \n// テーブルを作る前処理\nvoid COMinit() {\n    fac[0] = fac[1] = 1;\n    finv[0] = finv[1] = 1;\n    inv[1] = 1;\n    for (int i = 2; i < MAX; i++){\n        fac[i] = fac[i - 1] * i % MOD;\n        inv[i] = MOD - inv[MOD%i] * (MOD / i) % MOD;\n        finv[i] = finv[i - 1] * inv[i] % MOD;\n    }\n}\n \n// 二項係数計算\nlong long COM(int n, int k){\n    if (n < k) return 0;\n    if (n < 0 || k < 0) return 0;\n    return fac[n] * (finv[k] * finv[n - k] % MOD) % MOD;\n}\n \nlong long extGCD(long long a, long long b, long long &x, long long &y) {\n    if (b == 0) {\n        x = 1;\n        y = 0;\n        return a;\n    }\n    long long d = extGCD(b, a%b, y, x);\n    y -= a/b * x;\n    return d;\n}\n// 負の数にも対応した mod (a = -11 とかでも OK) \ninline long long mod(long long a, long long m) {\n    return (a % m + m) % m;\n}\n \n// 逆元計算 (ここでは a と m が互いに素であることが必要)\nlong long modinv(long long a, long long m) {\n    long long x, y;\n    extGCD(a, m, x, y);\n    return mod(x, m); // 気持ち的には x % m だが、x が負かもしれないので\n}\nll GCD(ll a, ll b){\n    \n    if(b == 0) return a;\n    return GCD(b, a%b);\n}\n\ntypedef vector<ll> vec;\ntypedef vector<vec> mat;\n\nmat mul(mat &A, mat &B) {\n    mat C(A.size(), vec((int)B[0].size()));\n    for(int i=0; i<A.size(); ++i){\n        for(int k=0; k<B.size(); ++k){\n            for(int j=0; j<B[0].size(); ++j){\n                C[i][j] = (C[i][j] + A[i][k] * B[k][j] %MOD) % MOD;\n            }\n        }\n    }\n    return C;\n}\nmat matPow(mat A, ll n) {\n    mat B(A.size(), vec((int)A.size()));\n \n    for(int i=0; i<A.size(); ++i){\n        B[i][i] = 1;\n    }\n \n    while(n > 0) {\n        if(n & 1) B = mul(B, A);\n        A = mul(A, A);\n        n >>= 1;\n    }\n    return B;\n}\n\nint comp(string& t1, string& t2){\n\n    if(t1.size() < t2.size()){\n        return -1;\n    } else if(t1.size() == t2.size()){\n        for(int k=0; k<t1.size(); k++){\n            if(t1[k] < t2[k]){\n                return -1;\n            }else if(t1[k] > t2[k]){\n                return 1;\n            }\n        }\n    }else{\n        return 1;\n    }\n    return 0;\n}\nint W, H;\nstring dist[75][75];\nint main() {\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cout << fixed << setprecision(15);\n\n    \n    while(cin >> W >> H){\n        if(W == 0 && H == 0) break;\n        vector<string> v;\n        REP(i,H){\n            string s; cin >> s;\n            v.push_back(s);\n        }\n        \n        REP(i,H) REP(j,W) dist[i][j]=\"\";\n\n        for(int i=0; i<H; i++){\n            for(int j=0; j<W; j++){\n                if('A' <= v[i][j]  && v[i][j] <= 'Z' || v[i][j] == '0' || dist[i][j] != \"\") continue;\n                dist[i][j] = v[i][j];\n                queue<pair<int, int>> q;\n                q.push({i, j});\n                while(q.size()){\n                    auto p = q.front();\n                    q.pop();\n                    \n                    int y = p.first, x = p.second;\n\n                    int ny = y + 1, nx = x;\n                    if(ny >= 0 && ny < H && nx >= 0 && nx < W){\n                        if('0' <= v[ny][nx] && v[ny][nx] <= '9'){\n                            string t1 = dist[ny][nx], t2 = dist[y][x] + v[ny][nx];\n\n                            if(comp(t1, t2) == -1){\n                                dist[ny][nx] = dist[y][x];\n                                dist[ny][nx] += v[ny][nx];\n                                q.push({ny, nx});\n                            }\n                        }\n                    }\n                    ny = y, nx = x+1;\n                    if(ny >= 0 && ny < H && nx >= 0 && nx < W){\n                        if('0' <= v[ny][nx] && v[ny][nx] <= '9'){\n                            string t1 = dist[ny][nx], t2 = dist[y][x] + v[ny][nx];\n                            if(comp(t1, t2) == -1){\n                                dist[ny][nx] = dist[y][x];\n                                dist[ny][nx] += v[ny][nx];\n                                q.push({ny, nx});\n                            }\n                        }\n                    }\n                }\n                \n            }\n        }\n        string ans = \"\";\n        for(int i=0; i<H; i++){\n            for(int j=0; j<W; j++){\n                if(ans == \"\"){\n                    ans = dist[i][j];\n                }else{\n                    \n                    if(comp(ans, dist[i][j]) == -1){\n                        ans = dist[i][j];\n                    }\n                }\n            }\n        }\n        cout << ans << endl;\n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nint H,W;\nchar S[71][71];\nstring maxs,DP[100][100];\n\nint main()\n{\n  while(1){\n    cin>>W>>H;\n    if(W==0&&H==0)break;\n    maxs.erase(maxs.begin(),maxs.end());\n    for(int i=1;i<H+1;i++){\n      for(int j=1;j<W+1;j++){\n\tcin>>S[i][j];\n\tDP[i][j].erase(DP[i][j].begin(),DP[i][j].end());\n      }\n    }\n    for(int i=1;i<H+1;i++){\n      for(int j=1;j<W+1;j++){\n\tif(S[i][j]>='0' && S[i][j]<='9'){\n\t  if(DP[i-1][j].length()>DP[i][j-1].length())DP[i][j]=DP[i-1][j]+S[i][j];\n\t  else if(DP[i-1][j].length()<DP[i][j-1].length())DP[i][j]=DP[i][j-1]+S[i][j];\n          else if(DP[i-1][j]>DP[i][j-1])DP[i][j]=DP[i-1][j]+S[i][j];\n\t  else DP[i][j]=DP[i][j-1]+S[i][j];\n\t  if(maxs.length()<DP[i][j].length())maxs=DP[i][j];\n\t}\n      }\n    }\n    while(maxs[0]=='0')maxs.erase(maxs.begin());\n    cout<<maxs<<endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <string>\n#include <algorithm>\n#include <vector>\n#include <utility>\n#include <cstring>\nusing namespace std;\n\n#define rep(i,n) for(int i=0; i<n; i++)\ntypedef long long ll;\n\nint w, h;\nchar f[71][71];\nstring memo[71][71];\n\nbool isNumber(char c){ return ('0'<=c && c<='9'); }\n\nint comp( string l, string r ) {\n\treverse( l.begin(), l.end() );\n\treverse( r.begin(), r.end() );\n\twhile(l.length()<r.length()) l += '0';\n\twhile(r.length()<l.length()) r += '0';\n\treverse( l.begin(), l.end() );\n\treverse( r.begin(), r.end() );\n\treturn l>r ? 1 : l<r ? -1 : 0;\n}\n\nvoid dfs( int x, int y, string& path ) {\n\tif(memo[x][y] != \"\") {\n\t\tpath += memo[x][y];\n\t\treturn;\n\t}\n\tstring retPath = \"\";\n\tif( x+1 < w && isNumber(f[x+1][y]) ) {\n\t\tstring p = \"\";\n\t\tp += f[x+1][y];\n\t\tdfs( x+1, y, p );\n\t\tif( comp(p, retPath) > 0 ) {\n\t\t\tretPath = p;\n\t\t}\n\t}\n\tif( y+1 < h && isNumber(f[x][y+1]) ) {\n\t\tstring p = \"\";\n\t\tp += f[x][y+1];\n\t\tdfs( x, y+1, p );\n\t\tif( comp(p, retPath) > 0 ) {\n\t\t\tretPath = p;\n\t\t}\n\t}\n\tpath += retPath;\n\tmemo[x][y] = retPath;\n}\n\nint main() {\n\twhile( cin >> w >> h, w||h ) {\n\t\tmemset( f, 0, sizeof(f) );\n\t\trep(y,h) {\n\t\t\trep(x,w) {\n\t\t\t\tcin >> f[x][y];\n\t\t\t\tmemo[x][y] = \"\";\n\t\t\t}\n\t\t}\n\t\tstring mPath = \"\";\n\t\trep(y, h) {\n\t\t\trep(x, w) {\n\t\t\t\tif( isNumber(f[x][y]) ) {\n\t\t\t\t\tstring path = \"\";\n\t\t\t\t\tpath += f[x][y];\n\t\t\t\t\tdfs(x, y, path);\n\t\t\t\t\tif( comp(path, mPath) > 0 ) {\n\t\t\t\t\t\tmPath = path;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ind = 0;\n\t\twhile(mPath[ind]=='0') ind++;\n\t\tcout << mPath.substr(ind, mPath.length()-ind) << endl;\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing ll = long long;\n#define rep(i,n) for(int i = 0; i < n ;++i)\n#define all(v) v.begin(),v.end()\n\nstring s[100];\nint w,h;\nint dx[2]={0,1};\nint dy[2]={1,0};\nbool used[100][100];\n//vector<string> vs;\nstring ans;\n\nvoid solve(int y,int x,string t){\n  // cout<<s[y][x]<<endl;\n  bool f=0;\n  rep(i,2){\n    int ny=dy[i]+y,nx=x+dx[i];\n    if(ny>=0&&ny<h&&nx>=0&&nx<w){\n      if(/*!used[ny][nx]&&*/s[ny][nx]>='0'&&s[ny][nx]<='9'){\n        //used[ny][nx]=1;\n        solve(ny,nx,t+s[ny][nx]);\n        //used[ny][nx]=0;\n        f=1;\n      }\n    }\n  }\n  if(!f){\n    if(ans.size()<t.size())ans=t;\n    else if(ans.size()==t.size()){\n      if(ans<t)ans=t;\n    }\n  }\n  //vssh_back(t);\n}\n\nbool F(string a,string b){\n  if(a.size()!=b.size())return a.size()>b.size();\n  return a>b;\n}\n\nint main(){\n    while(cin>>w>>h&&w+h){\n      //vs.clear();\n      ans=\"\";\n        rep(i,h)cin>>s[i];\n        rep(i,h)rep(j,w)used[i][j]=0;\n        rep(i,h){\n          rep(j,w){\n            if(!used[i][j]&&s[i][j]>='1'&&s[i][j]<='9'){\n              used[i][j]=1;\n              string t;\n              t.push_back(s[i][j]);\n              solve(i,j,t);\n            }\n          }\n        }\n        // sort(all(vs),F);\n        // reverse(all(vs));\n        // cout<<vs[0]<<endl;\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\n#include<cmath>\n#include<algorithm>\n#include<functional>\n#include<iomanip>\n#include<queue>\n#include<ciso646>\n#include<random>\n#include<map>\n#include<set>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD = 1000000007;\nconst ll INF = (ll)1000000007 * 1000000007;\nconst double EPS = 1e-9;\ntypedef pair<int, int> P;\ntypedef unsigned int ui;\n#define stop char nyaa;cin>>nyaa;\n#define rep(i,n) for(int i=0;i<n;i++)\n#define Rep(i,sta,n) for(int i=sta;i<n;i++)\n#define rep1(i,n) for(int i=1;i<=n;i++)\n#define per1(i,n) for(int i=n;i>=1;i--)\nbool great(string x, string y) {\n\tif (x == y)return true;\n\tint len1 = x.length();\n\tint len2 = y.length();\n\tif (len1 > len2)return true;\n\telse if (len1 < len2)return false;\n\telse {\n\t\tint now = 0;\n\t\twhile (now<len1) {\n\t\t\tif (x[now] - '0' > y[now] - '0')return true;\n\t\t\telse if (x[now] - '0' < y[now] - '0')return false;\n\t\t\tnow++;\n\t\t}\n\t}\n\treturn true;\n}\nbool intgreat(string x, string y) {\n\twhile (x.length() && x[0] == '0')x.erase(x.begin());\n\twhile (y.length() && y[0] == '0')y.erase(y.begin());\n\treturn great(x, y);\n}\nbool alf(string x) {\n\tif (x.length()&&'A' <= x[0] && x[0] <= 'Z')return true;\n\treturn false;\n}\nstring large(string s, string t) {\n\tif (alf(s) && alf(t))return \"\";\n\telse if (alf(s))return t;\n\telse if (alf(t))return s;\n\telse {\n\t\tif (great(s, t))return s;\n\t\telse return t;\n\t}\n}\nstring intlarge(string s, string t) {\n\tif (alf(s) && alf(t))return \"\";\n\telse if (alf(s))return t;\n\telse if (alf(t))return s;\n\telse {\n\t\tif (intgreat(s, t))return s;\n\t\telse return t;\n\t}\n}\nint main() {\n\tint w, h;\n\twhile (cin >> w >> h, w) {\n\t\tstring s;\n\t\tstring t[71][71];\n\t\trep(i, 71) {\n\t\t\trep(j, 71) {\n\t\t\t\tt[i][j] = \"A\";\n\t\t\t}\n\t\t}\n\t\trep(i, h) {\n\t\t\tcin >> s;\n\t\t\trep(j, w) {\n\t\t\t\tt[i][j] = s[j];\n\t\t\t}\n\t\t}\n\t\tfor (int i = h - 1; i >= 0; i--) {\n\t\t\tfor (int j = w - 1; j >= 0; j--) {\n\t\t\t\tif (!alf(t[i][j])) {\n\t\t\t\t\tt[i][j] += large(t[i + 1][j], t[i][j + 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring ma = \"0\";\n\t\trep(i, h) {\n\t\t\trep(j, w) {\n\t\t\t\tif (!alf(t[i][j])) {\n\t\t\t\t\tma = intlarge(ma, t[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\twhile (ma.length()&&ma[0] == '0')ma.erase(ma.begin());\n\t\tcout << ma << endl;\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include \"bits/stdc++.h\"\n#include <sys/timeb.h>\n#include <fstream>\n\nusing namespace std;\n\n#define repl(i,a,b) for(int i=(int)(a);i<(int)(b);i++)\n#define rep(i,n) repl(i,0,n)\n#define replrev(i,a,b) for(int i=(int)(b)-1;i>=(int)(a);i--)\n#define reprev(i,n) replrev(i,0,n)\n#define repi(itr,ds) for(auto itr=ds.begin();itr!=ds.end();itr++)\n#define all(a) a.begin(),a.end()\n#define mp make_pair\n#define mt make_tuple\n#define INF 2000000000\n#define INFL 1000000000000000000LL\n#define EPS 1e-9\n#define MOD 1000000007\n#define PI 3.1415926536\n#define RMAX 4294967295\n\ntypedef long long ll;\ntypedef pair<int, int> P;\ntypedef vector<int> vi;\ntypedef vector<ll> vll;\ntypedef vector<bool> vb;\ntypedef vector<char> vc;\ntypedef vector<string> vs;\ntypedef vector<double> vd;\ntypedef vector<P> vP;\ntypedef vector<vector<int> > vvi;\ntypedef vector<vector<bool> > vvb;\ntypedef vector<vector<ll> > vvll;\ntypedef vector<vector<char> > vvc;\ntypedef vector<vector<double> > vvd;\ntypedef vector<vector<P> > vvP;\ntypedef priority_queue<int, vector<int>, greater<int> > pqli;\ntypedef priority_queue<ll, vector<ll>, greater<ll> > pqlll;\ntypedef priority_queue<P, vector<P>, greater<P> > pqlP;\ntypedef pair<int, pair<int, int> > Edge;\ntypedef vector<Edge> vE;\ntypedef priority_queue<Edge, vector<Edge>, greater<Edge> > pqlE;\n\nbool isNum(char c) {\n\treturn (c >= '0' && c <= '9');\n}\nbool isPlusNum(char c) {\n\treturn (c >= '1' && c <= '9');\n}\n\nint main() {\n\twhile (true) {\n\t\tvector<pair<int, string> > nums;\n\t\tint W, H;\n\t\tcin >> W >> H;\n\t\tif (W == 0 && H == 0)break;\n\t\tvs f(H);\n\t\trep(i, H) {\n\t\t\tcin >> f[i];\n\t\t}\n\t\tstack<tuple<int,int,vc> >st;\n\t\trep(i, H) {\n\t\t\trep(j, W) {\n\t\t\t\tif (isPlusNum(f[i][j]) && (i == 0 || !isPlusNum(f[i - 1][j])) && (j == 0 || !isPlusNum(f[i][j - 1]))) {\n\t\t\t\t\tst.push(mt(i, j, vc(1, f[i][j])));\n\t\t\t\t\tcout << f[i][j] << endl;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\twhile (!st.empty()) {\n\t\t\tint y = get<0>(st.top());\n\t\t\tint x = get<1>(st.top());\n\t\t\tvc s = get<2>(st.top());\n\t\t\tst.pop();\n\t\t\tif (y != H - 1 && isNum(f[y + 1][x])) {\n\t\t\t\ts.push_back(f[y + 1][x]);\n\t\t\t\tst.push(mt(y + 1, x, s));\n\t\t\t\ts.resize(s.size() - 1);\n\t\t\t}\n\t\t\tif (x != W - 1 && isNum(f[y][x + 1])) {\n\t\t\t\ts.push_back(f[y][x + 1]);\n\t\t\t\tst.push(mt(y, x + 1, s));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnums.push_back(mp((int)s.size(), string(all(s))));\n\t\t\t}\n\t\t}\n\n\t\tsort(all(nums));\n\t\tcout << nums[nums.size() - 1].second << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define reep(i,a,b) for(int i=(a);i<(b);i++)\n#define rep(i,n) reep((i),0,(n))\nstring ans=\"\";\nstring tmp=\"\";\nvector<string> v;\nvector<vector<int>> vv;\nint w,h;\nbool check(int a,int b){\n    if(0<=a&&a<h&&0<=b&&b<w) return true;\n    return false;\n}\nvoid foo(int a,int b){\n    tmp+=v[a].substr(b,1);\n    vv[a][b]=1;\n    if(ans.size()<tmp.size()) ans=tmp;\n    else if(ans.size()==tmp.size()&&ans<tmp) ans=tmp;\n    if(check(a+1,b)&&isdigit(v[a+1][b])) foo(a+1,b);\n    if(check(a,b+1)&&isdigit(v[a][b+1])) foo(a,b+1);\n    tmp=tmp.substr(0,tmp.size()-1);\n}\nint main(){\n    while(cin>>w>>h,h||w){\n        v.clear();\n        v=vector<string>(h);\n        vv=vector<vector<int>>(h,vector<int>(w,0));\n        rep(i,h){\n            cin>>v[i];\n        }\n        ans=tmp=\"\";\n        rep(i,h){\n            rep(j,w){\n                if(isdigit(v[i][j])&&v[i][j]!='0'){\n                    if(vv[i][j]) continue;\n                    foo(i,j);\n                    // cout<<i<<\" \"<<j<<\" \"<<v[i][j]<<\" \"<<ans<<endl;\n                }\n            }\n        }\n        cout<<ans<<endl;\n    }\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\nusing namespace std;\n\nstring x[100][100];\nint h,w;\nchar T[11]=\"0123456789\";\nchar c;\nstring dp[100][100];\n\nbool isnum(string p){\n\tfor(int i=0;i<10;i++){\n\t\tif(T[i]==p[0]){\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nstring _max(string a,string b){\n\tif(a.size()<b.size()){return b;}\n\tif(a.size()>b.size()){return a;}\n\tif(a>b){return a;}\n\treturn b;\n}\n\nint main(){\n\twhile(true){\n\t\tfor(int i=0;i<100;i++){\n\t\t\tfor(int j=0;j<100;j++){\n\t\t\t\tdp[i][j]=\"\";\n\t\t\t\tx[i][j]=\"a\";\n\t\t\t}\n\t\t}\n\t\tcin>>h>>w;\n\t\tif(h==0 && w==0){break;}\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tcin>>c;\n\t\t\t\tstring G=\"\";\n\t\t\t\tG+=c;\n\t\t\t\tx[i][j]=G;\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tif(isnum(x[i][j])==true){\n\t\t\t\t\tdp[i][j]=\"\"+x[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<100;i++){\n\t\t\tfor(int j=0;j<h;j++){\n\t\t\t\tfor(int k=0;k<w;k++){\n\t\t\t\t\tif(isnum(x[j+1][k])==true){\n\t\t\t\t\t\tdp[j+1][k]=_max(dp[j+1][k],dp[j][k]+x[j+1][k]);\n\t\t\t\t\t}\n\t\t\t\t\tif(isnum(x[j][k+1])==true){\n\t\t\t\t\t\tdp[j][k+1]=_max(dp[j][k+1],dp[j][k]+x[j][k+1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstring maxn=\"\";\n\t\tfor(int i=0;i<h;i++){\n\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\tmaxn=max(maxn,dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tcout<<maxn<<endl;\n\t}\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n#define FOR(i,a,b) for(int i=(a);i<(b);++i)\n#define rep(i,n)   FOR(i,0,n)\n#define pb emplace_back\ntypedef long long ll;\ntypedef pair<int,int> pint;\n\nstring s[71];\nbool used[71][71];\nconst int dx[]={0,1},dy[]={1,0};\nint dp[71][71];\nstring ans;\nint w,h;\nint dfs(int x,int y,string c){\n    if(dp[y][x]!=-1){\n        if(dp[y][x]+c.size()<ans.size()) return dp[y][x]+c.size();\n    }\n    if(c.size()>ans.size()) ans=c;\n    else if(c.size()==ans.size()){\n        rep(i,c.size()){\n            if(c[i]>ans[i]){\n                ans=c;break;\n            }\n            else if((c[i]<ans[i])) break;\n        }\n    }\n    int ret=1;\n    rep(i,2){\n        int tx=x+dx[i],ty=y+dy[i];\n        if(tx>=0&&ty>=0&&tx<w&&ty<h&&isdigit(s[ty][tx])){\n            ret=max(ret,dfs(tx,ty,c+s[ty][tx])+1);\n        }\n    }\n    return dp[y][x]=ret;\n}\nint main(){\n    while(cin>>w>>h,w){\n        memset(dp,-1,sizeof(dp));\n        rep(i,h) cin>>s[i];\n        ans=\"\";\n        string t;\n        rep(i,h)rep(j,w)if(isdigit(s[i][j])&&s[i][j]!='0'){\n            dfs(j,i,t+s[i][j]);\n        }\n        cout<<ans<<endl;\n    }\n    return 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <vector>\n#include <string>\n#include <map>\n#include <set>\n#include <queue>\n#include <stack>\n#include <algorithm>\n\nusing namespace std;\n\n#define rep(i,j) REP((i), 0, (j))\n#define REP(i,j,k) for(int i=(j);(i)<(k);++i)\n#define BW(a,x,b) ((a)<=(x)&&(x)<=(b))\n#define DIGIT(c) (c >= '0' && c <= '9')\n#define F first\n#define S second\n#define INF 1 << 30\n\ntypedef pair<int, int> pi;\ntypedef pair<int, pi> pii;\ntypedef vector<int> vi;\ntypedef queue<int> qi;\ntypedef long long ll;\n\nint W, H;\nvector<vector<string> >dp(70, vector<string>(70));\nchar c[70][71];\n\nstring judge(string a, string b){\n  if(a[0] == '0') a.erase(a.begin());\n  if(b[0] == '0') b.erase(b.begin());\n  if(a.size() > b.size()) return a;\n  if(a.size() < b.size()) return b;\n  return max(a, b);\n}\n\nint main(){\n  while(scanf(\"%d%d\", &W, &H) && W+H){\n    rep(i, H) scanf(\"%s\", c[i]);\n\n    rep(i, 70) rep(j, 70) dp[i][j] = \"\";\n    if(DIGIT(c[0][0])) dp[0][0] = c[0][0];\n    REP(i, 1, W) if(DIGIT(c[0][i])) dp[0][i] = dp[0][i-1] + c[0][i];\n    REP(i, 1, H) if(DIGIT(c[i][0])) dp[i][0] = dp[i-1][0] + c[i][0];\n\n    REP(i, 1, H){\n      REP(j, 1, W){\n\tif(!DIGIT(c[i][j])) continue;\n\tdp[i][j] = judge((dp[i-1][j]+c[i][j]), (dp[i][j-1]+c[i][j]));\n\t//\tcout << i << \" \" << j << \" \" << dp[i-1][j]+c[i][j] << \" \" << dp[i][j-1]+c[i][j] << endl;\n      }\n    }\n\n\n    /*    rep(i, H){\n      rep(j, W) cout << dp[i][j] << \" \";\n      puts(\"\");\n      }*/\n\n    string res = \"\";\n    rep(i, H) rep(j, W) res = judge(res, dp[i][j]);\n    //    if(res[0] == '0') res.erase(res.begin());\n    cout << res << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nint W, H;\nstring C[70];\n\nstring ans;\nstring dp[70][70];\n\nstring strmax(string s, string t)\n{\n  if(s.size() != t.size()) return (s.size() > t.size() ? s : t);\n  for(int i = 0; i < s.size(); i++){\n    if(s[i] != t[i]) return (s[i] > t[i] ? s : t);\n  }\n  return s;\n}\n\nstring dfs(int x, int y)\n{\n  if(x < 0 || W <= x || y < 0 || H <= y || C[y][x] < '0' || '9' < C[y][x]) return \"\";\n  if(dp[y][x] != \"\") return dp[y][x];\n  string ret = C[y][x] + strmax(dfs(x + 1, y), dfs(x, y + 1));\n  return dp[y][x] = ret;\n}\n\nint main()\n{\n  while(cin >> W >> H, W || H){\n    ans = \"\";\n    for(int i = 0; i < 70; i++){\n      for(int j = 0; j < 70; j++) dp[i][j] = \"\";\n    }\n    for(int i = 0; i < H; i++) cin >> C[i];\n    for(int i = 0; i < H; i++){\n      for(int j = 0; j < W; j++){\n\tif(C[i][j] != '0') ans = strmax(ans, dfs(j, i));\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<sstream>\n#include<cstring>\n#include<vector>\nusing namespace std;\n\nbool cmp1(const string& a,const string& b)\n{\n  int size_a,size_b;\n  int start_a,start_b;\n  start_a = start_b = 0;\n  size_a = a.size(),size_b = b.size();\n  if(a[0] == '0')\n    for(int i=0;i<a.size() && a[i] == '0';i++)\n      size_a--,start_a++;\n\n  if(b[0] == '0')\n    for(int i=0;i<b.size() && b[i] == '0';i++)\n      size_b--,start_b++;\n\n  if(size_a != size_b)\n    return size_a < size_b;\n\n  for(int i=0;i<size_a;i++)\n    {\n      if(a[start_a+i] != b[start_b+i])\n\treturn a[start_a+i] < b[start_b+i];\n    }\n  return true;\n}\n\nbool cmp2(const string& a,const string& b)\n{\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    {\n      if(a[i] != b[i])\n\treturn a[i] < b[i];\n    }\n  return true;\n}\n\nint main()\n{\n    \n  int W,H;\n  while(cin >> W >> H,W|H)\n    {\n     \n      vector<vector<string> > G;\n      G.resize(H);\n      for(int i=0;i<H;i++)\n\t{\n\t  G[i].resize(W);\n\t  string line;\n\t  cin >> line;\n\n\t  for(int j=0;j<W;j++)\n\t    {\n\t      G[i][j] = line[j];\n\t    }\n\t}\n\n      string G2[H][W];\n      string ans = \"\";\n      for(int i=0;i<H;i++)\n\t{\n\t  for(int j=0;j<W;j++)\n\t    {\n\t      if(isalpha(G[i][j][0]))\n\t\tcontinue;\n\t      //cout << i << \" - \" << j << endl;\n\t      G2[i][j] = max(G2[i][j],G[i][j],cmp1);\n\t      string A,B;\n\t      A = B = G2[i][j];\n\t      if(j-1 >= 0 && !isalpha(G[i][j-1][0]))\n\t\tA = max(G2[i][j],G2[i][j-1]+G2[i][j],cmp1);\n\n\t      if(i-1 >= 0 && !isalpha(G[i-1][j][0]))\n\t\tB = max(G2[i][j],G2[i-1][j]+G2[i][j],cmp1);\n\t      G2[i][j] = max(A,B,cmp1);\n\t      //cout << \"G2[\" << i << \"][\" << j << \"] = \" << G2[i][j] << endl;\n\t      ans = max(G2[i][j],ans,cmp2);\n\t    }\n\t}\n    \n\n\t  for(int i=0;i<ans.size()&&ans[0] == '0';i++)\n\t    ans[i] = ' ';\n\t  stringstream ss;\n\t  ss << ans;\n\t  ss >> ans;\n\t  cout << ans << endl;\n\n      }\n    \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing namespace std;\n\nstring dp[128][128];\n\nint main()\n{\n    int w, h;\n    while (scanf(\"%d %d\", &w, &h) && w){\n        char mp[128][128];\n        \n        for (int i = 0; i < h; i++){\n            scanf(\"%s\", mp[i]);\n        }\n        \n        string res = \"\";\n        \n        for (int i = 0; i < h; i++){\n            for (int j = 0; j < w; j++){\n                dp[i][j] = \"\";\n                if (i - 1 >= 0 && dp[i - 1][j] != \"\"){\n                    dp[i][j] = dp[i - 1][j];\n                }\n                if (j - 1 >= 0 && dp[i][j - 1] != \"\"){\n                    if (dp[i][j - 1].size() > dp[i][j].size() ||\n                        (dp[i][j - 1].size() == dp[i][j].size() && dp[i][j - 1] > dp[i][j]))\n                            dp[i][j] = dp[i][j - 1];\n                }\n                \n                if (isdigit(mp[i][j])){\n                    if (dp[i][j] != \"\" || mp[i][j] != '0') dp[i][j] += mp[i][j];\n                }\n                else dp[i][j] = \"\";\n                \n                if (res.size() < dp[i][j].size() || (res.size() == dp[i][j].size() && dp[i][j] > res))\n                    res = dp[i][j];\n            }\n        }\n        \n        printf(\"%s\\n\", res.c_str());\n    }\n    \n    return (0);\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#define REP(i, a, n) for(int i = (a); i < (n); i++)\nusing namespace std;\n\nint W, H;\nchar S[70][70];\nstring dp[70][70];\n\nbool comp(string s, string t) {\n  if(s.length() != t.length()) return s.length() < t.length();\n  REP(i, 0, s.length()) if(s[i] != t[i]) return s[i] < t[i];\n  return false;\n}\n\nint main(void) {\n  while(cin >> W >> H, W && H) {\n    REP(i, 0, H) cin >> S[i];\n    REP(i, 0, H) REP(j, 0, W) dp[i][j] = \"\";\n    string ans = \"\";\n    REP(i, 0, H) REP(j, 0, W) {\n      if('0' <= S[i][j] && S[i][j] <= '9') {\n        if(S[i][j] == '0' && dp[i][j] == \"\") continue;\n        dp[i][j] += S[i][j];\n        if(comp(ans, dp[i][j])) ans = dp[i][j];\n        if(i + 1 < H && comp(dp[i + 1][j], dp[i][j])) dp[i + 1][j] = dp[i][j];\n        if(j + 1 < W && comp(dp[i][j + 1], dp[i][j])) dp[i][j + 1] = dp[i][j];\n      }\n    }\n    cout << ans << endl;\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint w,h;\n\nstring mini(string a,string b){\n    if(a.size()>b.size()){\n        return a;\n    }\n    if(a.size()<b.size()){\n        return b;\n    }\n    for(int i=0;i<a.size();i++){\n        if(a[i]>b[i]) return a;\n        if(a[i]<b[i]) return b;\n    }\n    return a;\n}\n\nbool isrange(int i,int j){return 0<=i && i<h && 0<=j && j<w;}\n\nstring dfs(int i,int j,vector<string> &c,vector<vector<int>> &check,vector<vector<string>> &dp){\n    if(dp[i][j]!=\"#\"){\n        return dp[i][j];\n    }\n    check[i][j]=true;\n    string res=\"\";\n    string cstr=\"\";\n    res+=c[i][j];\n    cstr+=c[i][j];\n    if(isrange(i+1,j) && isdigit(c[i+1][j])){\n        res=mini(res,cstr+dfs(i+1,j,c,check,dp));\n    }\n    if(isrange(i,j+1) && isdigit(c[i][j+1])){\n        res=mini(res,cstr+dfs(i,j+1,c,check,dp));\n    }\n    return dp[i][j]=res;\n}\n\nint main(){\n    while(cin>>w>>h,w){\n        vector<string> c(h);\n        for(int i=0;i<h;i++){\n            cin>>c[i];\n        }\n        string res=\"0\";\n        vector<vector<int>> check(h,vector<int>(w,0));\n        vector<vector<string>> dp(h,vector<string>(w,\"#\"));\n        for(int i=0;i<h;i++){\n            for(int j=0;j<w;j++){\n                if(!check[i][j] && isdigit(c[i][j]) && c[i][j]!='0'){\n                    res=mini(res,dfs(i,j,c,check,dp));\n                }\n            }\n        }\n        cout<<res<<endl;\n    }\n\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<sstream>\n#include<algorithm>\n#include<vector>\n#define F first\n#define S second\nusing namespace std;\n\nbool cmp(const string& a,const string& b)\n{\n  if(a.size() == 0 && b.size() == 0)\n    return true;\n  else if(a.size() == 0)\n    return true;\n  else if(b.size() == 0)\n    return false;\n  if(a.size() != b.size())\n    return a.size() < b.size();\n  for(int i=0;i<a.size();i++)\n    if(a[i] != b[i])\n      return a[i] < b[i];\n  return false;\n}\n\nint main()\n{\n\n  int w,h;\n  while(cin >> w >> h,(w || h))\n    {\n      \n      char G[h][w];\n      string ans=\"0\";\n      string dp[h][w];\n\n      for(int i=0;i<h;i++)\n\t{\n\tfor(int j=0;j<w;j++)\n\t  {\n\t    cin >> G[i][j];\n\t    if('0' <= G[i][j] && G[i][j] <= '9')\n\t      {\n\t\tdp[i][j] = G[i][j];\n\t\tans = max(ans,dp[i][j],cmp);\n\t      }\n\t\n\t  }\n\n\t}\n     \n\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\n\t      if(!('0' <= G[i][j] && G[i][j] <= '9'))\n\t\tcontinue;\n\t      \n\t      dp[i][j] = max(dp[i][j],max((i-1>=0 &&('0'<= G[i-1][j] && G[i-1][j] <= '9') ?dp[i-1][j]:\"\")+dp[i][j],\n\t\t\t\t\t  (j-1>=0 &&('0'<= G[i][j-1] && G[i][j-1] <= '9') ?dp[i][j-1]:\"\")+dp[i][j],cmp),cmp);\t      \n\t      //ans = max(ans,dp[i][j],cmp);\n\n\t    }\n\t}\n\n      ans = \"\";\n      for(int i=0;i<h;i++)\n\t{\n\t  for(int j=0;j<w;j++)\n\t    {\n\t      if('0' <= G[i][j] && G[i][j] <= '9')\n\t\t{\n\t\t  string a;\n\t\t  if(dp[i][j] != \"0\" && dp[i][j][0] == '0')\n\t\t    {\n\n\t\t      for(int k=0;dp[i][j][k] == '0';k++)\n\t\t\tdp[i][j][k] = ' ';\t\t    \n\t\t      stringstream ss;\n\t\t      ss << dp[i][j];\n\t\t      a = ss.str();\n\t\t    }\n\t\t  else\n\t\t    a = dp[i][j];\n\t\t  ans = max(ans,a);\n\n\t\t}\n\t    }\n\t}\n\n      cout << ans << endl;\n      continue;\n\n\n    }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <string>\n#include <vector>\n#include <iostream>\n\nusing namespace std;\n\nbool compare(string S1, string S2)\n{\n\tif (S1.size() != S2.size()) { return S1.size() > S2.size(); }\n\n\treturn S1 > S2;\n}\n\nint main()\n{\n\tint H, W;\n\n\twhile (true)\n\t{\n\t\tcin >> W >> H;\n\n\t\tif (H == 0 && W == 0) { break; }\n\n\t\tvector<string> R(H);\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tcin >> R[i];\n\t\t}\n\n\t\tvector<vector<string> > dp(H, vector<string>(W, \"\"));\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (isdigit(R[i][j]))\n\t\t\t\t{\n\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][j] = R[i][j];\n\t\t\t\t\t}\n\n\t\t\t\t\tif (i != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i - 1][j] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i - 1][j] + R[i][j], dp[i][j]) && dp[i - 1][j] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i - 1][j] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (j != 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (R[i][j] != '0')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i][j - 1] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (compare(dp[i][j - 1] + R[i][j], dp[i][j]) && dp[i][j - 1] != \"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tdp[i][j] = dp[i][j - 1] + R[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tstring ret = \"\";\n\n\t\tfor (int i = 0; i < H; i++)\n\t\t{\n\t\t\tfor (int j = 0; j < W; j++)\n\t\t\t{\n\t\t\t\tif (compare(dp[i][j], ret))\n\t\t\t\t{\n\t\t\t\t\tret = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tcout << ret << endl;\n\t}\n\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\nusing namespace std;\nclass ln{\nprivate:\n  long long d[10];\n  int len;\npublic:\n  ln(){\n  len=0;\n  for(int i=0;i<10;i++)\n    d[i]=0;\n  }\n  ln big(ln a,ln b){\n    if(a.len>b.len)\n      return a;\n    else if(a.len<b.len)\n      return b;\n    else {\n        for(int i=0;i<10;i++)\n\t  if(a.d[i]>b.d[i])\n\t    return a;\n\t  else if(a.d[i]<b.d[i])\n\t    return b;\n\treturn a;\n    }\n  }\n  void plus(int b){\n    int tmp=len/10;\n    d[tmp]*=10;\n    d[tmp]+=(b-'0');\n      len++;\n  }  \n  void print(){\n    for(int i=0;i<(len-1)/10+1;i++)\n      cout<<d[i];\n    cout<<endl;\n  }\n};\nint main(){\n  int w,h;\n  char input[75][75];\n \n  //\n  while(1){\n  \n    cin>>w>>h;\n    ln out[75][75];\n    ln maxval;\n    if(w==0&&h==0) return 0;\n    for(int i=0;i<w+1;i++)\n      input[0][i]=0;\n    for(int i=1;i<h+1;i++){\n      input[i][0]=0;\n      cin>>(char*)(input[i]+1);\n    }\n    // for(int i=0;i<h+1;i++)\n    //   cout<<input[i]+1<<endl;\n    for(int i=1;i<=w+h;i++)\n      for(int j=1;j<i;j++)\n\tif(input[j][i-j]>='0'&&input[j][i-j]<='9') \n\t  {\n\t    if(j>h||i-j>w) continue;\n\t    out[j][i-j]=out[0][0].big(out[j-1][i-j],out[j][i-j-1]);\n\t    out[j][i-j].plus(input[j][i-j]);    \n\t    //  out[j][i-j].print();\n\t    maxval=out[0][0].big(out[j][i-j],maxval);\n\t  }\n    maxval.print();\n  }\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<iostream>\n#include<string>\n#include<algorithm>\n#include<cstdlib>\n#include<typeinfo>\n#include<set>\n#include<map>\n#include<vector>\n#include<stack>\n#include<queue>\n#include<cmath>\n#include<numeric>\n#include<cassert>\n#include<random>\nusing namespace std;\n\nbool num(char c){\n    if(c<'0' || c>'9'){return false;}\n    return true;\n}\n\nstring max(string a,string b){\n    if(a.size()>b.size()){return a;}\n    if(b.size()>a.size()){return b;}\n    if(a>b){return a;}\n    return b;\n}\n\nstring pls(char c,string s){\n    s.push_back(1);\n    //cout<<\"size : \"<<s<<endl;\n    for(int i=(int)s.size()-2;i>=0;i--){\n        //cout<<\"e\"<<endl;\n        s[i+1]=s[i];\n    }\n    s[0]=c;\n    //cout<<s<<endl;\n    return s;\n}\n\nint main(){\n    while(1){\n        \n        \n        \n    \n    char a[100][100]={};\n    int w,h;\n    cin>>w>>h;\n        if(w==0 && h==0){break;}\n    for(int i=0;i<h;i++){\n        for(int t=0;t<w;t++){\n            cin>>a[i][t];\n        }\n    }\n    string dp[100][100]={};\n    string ans;\n    for(int i=h-1;i>=0;i--){\n        for(int t=w-1;t>=0;t--){\n            if(num(a[i][t])){\n                dp[i][t]=pls(a[i][t],max(dp[i+1][t],dp[i][t+1]));\n                ans=max(ans,dp[i][t]);\n            }\n        }\n    }\n        bool d=true;\n        for(int i=0;i<ans.size();i++){\n            if(d && ans[i]!='0'){cout<<ans[i]; d=false; continue;}\n            if(!d){cout<<ans[i];}\n        }\n        cout<<endl;\n    \n        \n        \n    }\n    return 0;\n}\n\n"
  },
  {
    "language": "Haskell",
    "code": "import Control.Applicative ((<$>))\nimport Control.Monad (replicateM, unless, forM_, when)\nimport Data.Char (isDigit, digitToInt)\nimport Data.Vector (Vector, (!), (//))\nimport qualified Data.Vector as V\nimport qualified Data.Vector.Mutable as VM\n\nmain :: IO ()\nmain = do\n  [w, h] <- map read <$> words <$> getLine\n  unless (w == 0 && h == 0) $ do\n    solve w h <$> replicateM h getLine >>= print\n    main\n\nsolve :: Int -> Int -> [String] -> Integer\nsolve w h css = V.maximum dp\n  where toIx (i, j) = i + (w+1) * j\n        dp :: Vector Integer\n        dp = V.create $ do\n          v <- VM.replicate ((w+1)*(h+1)) 0\n          forM_ [1..w] $ \\i -> do\n            forM_ [1..h] $ \\j -> do\n              let c = css !! (j-1) !! (i-1)\n              when (isDigit c) $ do\n                x <- VM.read v (toIx (i,j-1))\n                y <- VM.read v (toIx (i-1,j))\n                VM.write v (toIx (i,j)) (10 * (max x y) + (fromIntegral . digitToInt) c)\n          return v\n\n"
  },
  {
    "language": "C",
    "code": "// Aizu 1126: The Secret Number\n// 2017.9.15 bal4u@uu\n\n#include <stdio.h>\n#include <ctype.h>\n#include < string.h>\n\nchar d[72][72], s[72][72][72];\nint a[72][72];\nchar ans[72]; int len;\n\nint main()\n{\n\tint w, h, r, c;\n\n\twhile (scanf(\"%d%d\", &w, &h) && w) {;\n\t\tmemset(a, 0, sizeof(a));\n\t\tfor (r = 0; r < h; r++) scanf(\"%s\", d[r]);\n\t\tfor (r = 0; r < h; r++) for (c = 0; c < w; c++) {\n\t\t\tif (!isdigit(d[r][c])) continue;\n\t\t\ta[r][c] = 0;\n\t\t\tif (c > 0 && isdigit(d[r][c-1]))\n\t\t\t\ta[r][c] = a[r][c-1], memcpy(s[r][c], s[r][c-1], a[r][c]);\n\t\t\tif (r > 0 && isdigit(d[r-1][c])) {\n\t\t\t\tif (a[r-1][c] > a[r][c] || (a[r-1][c] == a[r][c] && memcmp(s[r-1][c], s[r][c], a[r][c]) > 0))\n\t\t\t\t\ta[r][c] = a[r-1][c], memcpy(s[r][c], s[r-1][c], a[r][c]);\n\t\t\t}\n\t\t\tif (a[r][c] == 0 && d[r][c] == '0') continue;\n\t\t\ts[r][c][a[r][c]] = d[r][c], a[r][c]++;\n\t\t}\n\t\tfor (len = 0, r = 0; r < h; r++) for (c = 0; c < w; c++) {\n\t\t\tif (a[r][c] > len || (a[r][c] == len && memcmp(s[r][c], ans, len) > 0)) len = a[r][c], memcpy(ans, s[r][c], len);\n\t\t}\n\t\tans[len] = 0;\n\t\tputs(ans);\n    }\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#define M 100\nchar m[M][M],s[M][M][M],r[M],*z;\ncmp(char *p,char *q){\n  int r=0;\n  for(;*p=='0';p++);\n  for(;*q=='0';q++);\n  if(r=strlen(p)-strlen(q))return r;\n  return strcmp(p,q);\n}\nmain(w,h,i,j,k,l){\n\tfor(;scanf(\"%d%d\",&w,&h),w;puts(z)){\n\t\tmemset(m,0xff,sizeof(m));\n\t\tmemset(s,0,sizeof(s));\n\t\tmemset(r,0,sizeof(r));\n\t\tfor(j=1;j<=h;j++)scanf(\"%s\",m[j]+1);\n\t\tfor(i=1;i<=w+1;i++)for(j=1;j<=h;j++)if(!isdigit(m[j][i]))m[j][i]=-1;\n\t\tfor(i=1;i<=w;i++)\n\t\t\tfor(j=1;j<=h;j++){\n\t\t\t\tif(m[j][i]==-1)continue;\n\t\t\t\tif(cmp(s[j][i-1],s[j-1][i])>0)strcpy(s[j][i],s[j][i-1]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\t\telse strcpy(s[j][i],s[j-1][i]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\t\tif(cmp(s[j][i],r)>0)strcpy(r,s[j][i]);\n\t\t\t}\n\t\tfor(z=r;*z=='0';z++);\n\t}\nreturn 0;}"
  },
  {
    "language": "C",
    "code": "/*\nAizuOnline A1126\nTitle The Secret Number\n6/4 TLE\n*/\n#include <stdio.h>\n#include <string.h>\n#define min(x,y) (((x)<(y))?(x):(y))\n#define max(x,y) (((x)>(y))?(x):(y))\n//Global data section\nchar biggest[71];\nint  biggest_len;\nchar current[71];\nint  current_len;\nchar ban[70][71];\nint dist[70][71]; \nchar dir[70][71];\nchar right_n[71];\nchar down_n[71];\nchar skip_zero[70][71];\nint H,W;\n//\n\nint extend(int y,int x,char * b)\n{\n        int c;\n\n        c=0;\n        while(y<H && x<W && dist[y][x]>1)\n        {\n                *b=ban[y][x];\n                if(dir[y][x]=='d')\n                        y++;\n                else if(dir[y][x]=='r')\n                        x++;\n                b++;\n                c++;\n        }\n        *b=ban[y][x];\n        return(c+1);\n}\n\nvoid make_dist_dir()\n{\n        int i,j,d,r,ret,len;\n\n        for(i=H-1;i>=0;i--)\n                for(j=W-1;j>=0;j--)\n                {\n                        if(!isdigit(ban[i][j]))\n                        {\n                                dist[i][j]=0;\n                                continue;\n                        }\n                        if(i==H-1)\n                                d = 0;\n                        else\n                                d = dist[i+1][j];\n\n                        if(j==W-1)\n                                r = 0;\n                        else\n                                r=dist[i][j+1];\n                        dist[i][j]=1+max(r,d);\n\n                        if(d==0 && r==0)\n                        {\n                                dir[i][j]='*';\n                                continue;\n                        }\n                        \n                        if(d > r)\n                                dir[i][j]='d';\n                        else if(d < r)\n                                dir[i][j]='r';\n                        \n                        else  //d==r\n                        {\n                                extend(i,j+1,right_n);\n                                extend(i+1,j,down_n);\n                                len=dist[i][j];\n                                //printf(\"ij %d %d %d \\n\",i,j,len);\n                                //print_number(&right_n[0],len-1);\n                                //print_number(&down_n[0],len-1);\n                                ret=strncmp(right_n,down_n,dist[i][j]);\n                                dir[i][j]=ret>0?'r':'d';\n                        }\n                        \n                }\n}\nregist_biggest()\n{\n        char*p;\n        p=&current[0];\n        while(*p=='0' && current_len >1)  // left zero surpress\n        {\n                p++;\n                current_len--;\n        }\n        //print_number(p,current_len);\n        if(current_len > biggest_len ||\n           ((current_len == biggest_len)\n            && (0<strncmp(p,biggest,current_len))))\n        {\n                biggest_len=current_len;\n                strncpy(biggest,p,current_len);\n        }\n}\n\n\nint findtopleft(int * y,int * x)\n{\n        int i,j;\n\n        i=*y;j=*x;\n        goto AAA;\n\n        for(i=0;i<H;i++)\n                for(j=0;j<W;j++)\n                {\n                AAA:\n                        if(((i==0 ||!isdigit(ban[i-1][j]))&&\n                            (j==0 ||!isdigit(ban[i][j-1]))&&\n                            isdigit(ban[i][j]))\n                            ||skip_zero[i][j] )\n                        {\n                                if(ban[i][j]=='0')\n                                {\n                                        if(i<H-1 && isdigit(ban[i+1][j]))\n                                        {\n                                                skip_zero[i+1][j]=-1;\n                                        }\n                                        if(j<W-1 && isdigit(ban[i][j+1]))\n                                        {\n                                                skip_zero[i][j+1]=-1;\n                                        }\n                                }       \n                                else\n                                {\n                                        //printf(\"N: %d %d %c\\n\",i,j,ban[i][j]);\n                                        *y=i;\n                                        *x=j;\n                                        return(-1);\n                                }\n                        }\n                        \n                }\n        return(0);\n}\nvoid print_number(char * s,int len)\n{\n        int i;\n        for(i=0;i<len;i++)\n                printf(\"%c\",s[i]);\n        //printf(\"(%d)\",len);\n        printf(\"\\n\");\n}\nvoid find_biggest_secret()\n{\n        int y,x;\n\n        x=y=0;\n        while(findtopleft(&y,&x))\n        {\n                //printf(\"L:%d %d\\n\",y,x);\n\n                current_len=0;\n               \n                current_len=extend(y,x,current);\n                //print_number(current,dist[y][x]);\n                regist_biggest();\n                x++;\n                if(x>=W)\n                {        \n                        y++;\n                        x=0;\n                }\n                if(y>=H)\n                        break;\n       }\n}\nshow()\n{\n        int i,j;\n        for(i=0;i<H;i++)\n        {\n                for(j=0;j<W;j++)\n                        printf(\"%d:\",dist[i][j]);\n                printf(\"\\n\");\n        }\n        printf(\"---------------------\\n\");\n        for(i=0;i<H;i++)\n        {\n                for(j=0;j<W;j++)\n                        printf(\"%c:\",dir[i][j]);\n                printf(\"\\n\");\n        }\n        printf(\"---------------------\\n\");\n        for(i=0;i<H;i++)\n        {\n                for(j=0;j<W;j++)\n                        printf(\"%c:\",skip_zero[i][j]?'*':' ');\n                printf(\"\\n\");\n        }\n\n}\nclear()\n{\n        int i,j;\n\n        for(i=0;i<H;i++)\n                for(j=0;j<W;j++)\n                {\n                        dir[i][j]='-';\n                        dist[i][j]=0;\n                        skip_zero[i][j]=0;\n                }\n}\n\nmain()\n{\n        int i;\n\n        while(EOF!=scanf(\"%d %d\",&W,&H) && (W||H))\n        {\n                for(i=0;i<H;i++)\n                        scanf(\"%s\",&ban[i][0]);\n                clear();\n                make_dist_dir();\n                \n                \n                biggest_len=0;\n                find_biggest_secret();\n                //show();\n                print_number(biggest,biggest_len);\n                        \n        }\nreturn(0);\n}"
  },
  {
    "language": "C",
    "code": "// Aizu 1126: The Secret Number\n// 2017.9.15 bal4u@uu\n\n#include <stdio.h>\n#include <ctype.h>\n#include <string.h>\n\nchar d[72][72], s[72][72][72];\nint a[72][72];\nchar ans[72]; int len;\n\nint main()\n{\n\tint w, h, r, c;\n\n\twhile (scanf(\"%d%d\", &w, &h) && w) {;\n\t\tmemset(a, 0, sizeof(a));\n\t\tfor (r = 0; r < h; r++) scanf(\"%s\", d[r]);\n\t\tfor (r = 0; r < h; r++) for (c = 0; c < w; c++) {\n\t\t\tif (!isdigit(d[r][c])) continue;\n\t\t\ta[r][c] = 0;\n\t\t\tif (c > 0 && isdigit(d[r][c-1]))\n\t\t\t\ta[r][c] = a[r][c-1], memcpy(s[r][c], s[r][c-1], a[r][c]);\n\t\t\tif (r > 0 && isdigit(d[r-1][c])) {\n\t\t\t\tif (a[r-1][c] > a[r][c] || (a[r-1][c] == a[r][c] && memcmp(s[r-1][c], s[r][c], a[r][c]) > 0))\n\t\t\t\t\ta[r][c] = a[r-1][c], memcpy(s[r][c], s[r-1][c], a[r][c]);\n\t\t\t}\n\t\t\tif (a[r][c] == 0 && d[r][c] == '0') continue;\n\t\t\ts[r][c][a[r][c]] = d[r][c], a[r][c]++;\n\t\t}\n\t\tfor (len = 0, r = 0; r < h; r++) for (c = 0; c < w; c++) {\n\t\t\tif (a[r][c] > len || (a[r][c] == len && memcmp(s[r][c], ans, len) > 0)) len = a[r][c], memcpy(ans, s[r][c], len);\n\t\t}\n\t\tans[len] = 0;\n\t\tputs(ans);\n    }\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#define M 100\nchar m[M][M],s[M][M][M],r[M],*z;\ncmp(char *p,char *q){int r=0;\n\tfor(;*p=='0';p++);for(;*q=='0';q++);\n\treturn (r=strlen(p)-strlen(q))?r:strcmp(p,q);\n}\nmain(w,h,i,j,k,l){\n\tfor(;scanf(\"%d%d\",&w,&h),w;puts(z)){\n\t\tfor(memset(s,0,sizeof(s)),memset(r,0,sizeof(r)),j=1;j<=h;j++)scanf(\"%s\",m[j]+1);\n\t\tfor(i=1;i<=w;i++)for(j=1;j<=h;j++){\n\t\t\tif(!isdigit(m[j][i]))continue;\n\t\t\tif(cmp(s[j][i-1],s[j-1][i])>0)strcpy(s[j][i],s[j][i-1]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\telse strcpy(s[j][i],s[j-1][i]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\tif(cmp(s[j][i],r)>0)strcpy(r,s[j][i]);\n\t\t}\n\t\tfor(z=r;*z=='0';z++);\n\t}\nreturn 0;}"
  },
  {
    "language": "C",
    "code": "#define M 100\nchar m[M][M],s[M][M][M],r[M],*z;\ncmp(char *p,char *q){\n  int r=0;\n  for(;*p=='0';p++);\n  for(;*q=='0';q++);\n  if(r=strlen(p)-strlen(q))return r;\n  return strcmp(p,q);\n}\nmain(w,h,i,j,k,l){\n\tfor(;scanf(\"%d%d\",&w,&h),w;puts(z)){\n\t\tmemset(m,0xff,sizeof(m));\n\t\tmemset(s,0,sizeof(s));\n\t\tmemset(r,0,sizeof(r));\n\t\tfor(j=1;j<=h;j++)scanf(\"%s\",m[j]+1);\n\t\tfor(i=1;i<=w+1;i++)for(j=1;j<=h;j++)if(m[j][i]<'0'||'9'<m[j][i])m[j][i]=-1;\n\t\t//for(k=1;k<M;k++){\n\t\tfor(i=1;i<=w;i++)\n\t\t\t//for(j=i=k;i<=w;i++){\n\t\t\tfor(j=1;j<=h;j++){\n\t\t\t\tif(m[j][i]==-1)continue;\n\t\t\t\tif(cmp(s[j][i-1],s[j-1][i])>0)strcpy(s[j][i],s[j][i-1]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\t\telse strcpy(s[j][i],s[j-1][i]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\t\tif(cmp(s[j][i],r)>0)strcpy(r,s[j][i]);\n    \t\t}\n/*\n\t\t\tfor(j=i=k;j<=h;j++){\n\t\t\t\tif(m[j][i]==-1)continue;\n\t\t\t\tif(cmp(s[j][i-1],s[j-1][i])>0)strcpy(s[j][i],s[j][i-1]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\t\telse strcpy(s[j][i],s[j-1][i]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\t\tif(cmp(s[j][i],r)>0)strcpy(r,s[j][i]);\n\t\t\t}\n*/\n\t\t}\n\t\tfor(z=r;*z=='0';z++);\n\t}\nreturn 0;}"
  },
  {
    "language": "C",
    "code": "#define M 100\nchar m[M][M],s[M][M][M],r[M],*z;\ncmp(char *p,char *q){\n\tfor(;*p=='0';p++);for(;*q=='0';q++);\n\treturn (z=strlen(p)-strlen(q))?z:strcmp(p,q);\n}\nmain(w,h,i,j,k,l){\n\tfor(;scanf(\"%d%d\",&w,&h),w;puts(z)){\n\t\tfor(memset(s,0,sizeof(s)),memset(r,0,sizeof(r)),j=1;j<=h;j++)scanf(\"%s\",m[j]+1);\n\t\tfor(i=1;i<=w;i++)for(j=1;j<=h;j++){\n\t\t\tif(!isdigit(m[j][i]))continue;\n\t\t\tif(cmp(s[j][i-1],s[j-1][i])>0)strcpy(s[j][i],s[j][i-1]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\telse strcpy(s[j][i],s[j-1][i]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\tif(cmp(s[j][i],r)>0)strcpy(r,s[j][i]);\n\t\t}\n\t\tfor(z=r;*z=='0';z++);\n\t}\nreturn 0;}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <ctype.h>\n#define MAX(a,b) ((a) > (b) ? (a) : (b));\n\nmain(){\n\tint W,H;\n\twhile(1){\n\t\tscanf(\"%d%d\",&W,&H);\n\t\tif(W+H==0) break;\n\t\tint ward,m[70][70];\n\t\tint maxcode;\n\t\tfor(i=0;i<H;i++){\n\t\t\tfor(j=0;j<W;j++){\n\t\t\t\tward=getchar();\n\t\t\t\tif(isdigit(ward)){\n\t\t\t\t\tif(i+j==0) m[i][j]=ward; //0行0列目ならば．\n\t\t\t\t\telse if(i>0&&j==0){\n\t\t\t\t\t\tif(isdigit(m[i-1][j])) m[i][j]=ward+m[i-1][j]*10;\n\t\t\t\t\t\telse m[i][j]=ward;\n\t\t\t\t\t}else if(j>0&&i==0){\n\t\t\t\t\t\tif(isdigit(m[i][j-1])) m[i][j]=ward+m[i][j-1]*10;\n\t\t\t\t\t\telse m[i][j]=ward;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tint up=0,right=0;\n\t\t\t\t\t\tif(isdigit(m[i-1][j])) up=m[i-1][j];\n\t\t\t\t\t\tif(isdigit(m[i][j-1])) right=[i-1][j];\n\t\t\t\t\t\tm[i][j]=ward+MAX(up,right)*10;\n\t\t\t\t\t}\n\t\t\t\t}else m[i][j]=ward;\n\t\t\t\tmaxcode=MAX(maxcode,m[i][j]);\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\",maxcode);\n\t}\n}"
  },
  {
    "language": "C",
    "code": "/* \n   AOJ 1126\n   The Secret Number\n\n*/\n\n#include<stdio.h>\n#define WH_MAX 80\ntypedef struct coded_number\n{\n  int len;\n  char s[WH_MAX + WH_MAX];\n}coded_number;\n\nint w, h;\nchar f[WH_MAX][WH_MAX];\ncoded_number memo[WH_MAX][WH_MAX];\n\nvoid copy(coded_number *src, coded_number *dst)\n{\n  int i;\n  dst->len = src->len;\n  for(i = 0; i <= src->len; i++)\n    dst->s[i] = src->s[i];\n\n}\n\nint ok(int x, int y)\n{\n  return (0 <= x && x < w && 0 <= y && y < h && '0' <= f[y][x] && f[y][x] <= '9');\n}\n\nvoid init(coded_number* x)\n{\n  x->len = 0;\n  x->s[0] = '\\0';\n}\n\nint is_zero(coded_number *x)\n{\n  int i;\n  if(!(x->len > 0))\n    return 0;\n  else\n    for(i = 0; i < x->len && x->s[i] == '0'; i++);\n  return i == x->len;\n}\n\nint comp(coded_number *x, coded_number *y)\n{\n  int i, x_len = x->len, y_len = y->len;\n  if(x_len > y_len)\n    return -1;\n  else if(x_len < y_len)\n    return 1;\n  else\n    for(i = 0; i < x_len; i++)\n      {\n\tif(x->s[i] > y->s[i])\n\t  return -1;\n\telse if(x->s[i] < y->s[i])\n\t  return 1;\n      }\n  return 0;\n}\n\n\nvoid add_char(coded_number* dst, char c)\n{\n  int i, j;\n  for(i = dst->len, j = dst->len + 1; i >= 0; i--, j--)\n    dst->s[j] = dst->s[i];\n  dst->s[0] = c;\n  dst->len++;\n}\n\ncoded_number* search(int x, int y)\n{\n  coded_number right, below, ret;\n  int comp_ret;\n  init(&ret);\n  if(memo[y][x].len > 0)\n    return &memo[y][x];\n\n  else if(ok(x, y))\n    {\n      copy(search(x + 1, y), &right);\n      copy(search(x, y + 1), &below);\n      if(comp(&right, &below) < 0)\n\tcopy(&right, &ret);\n      else\n\tcopy(&below, &ret);\n      add_char(&ret, f[y][x]);\n      copy(&ret, &memo[y][x]);\n      return &memo[y][x];\n   }\n  return &ret;\n}\n\nint main(void)\n{\n  int i, j;\n  coded_number ret;\n\n\n  while(scanf(\"%d %d\", &w, &h), (w && h))\n    {\n\n      for(i = 0; i < h; i++)\n\tscanf(\"%s\", f[i]);\n\n      for(i = 0; i < WH_MAX; i++)\n\tfor(j = 0; j < WH_MAX; j++)\n\t  init(&memo[i][j]);\n      init(&ret);\n\n      for(i = 0; i < h; i++)\n\tfor(j = 0; j < w; j++)\n\t  if('0' < f[i][j] && f[i][j] <= '9')\n\t    search(j, i);\n\n\n      for(i = 0; i < h; i++)\n\tfor(j = 0; j < w; j++)\n\t  if(comp(&ret, &memo[i][j]) > 0)\n\t    copy(&memo[i][j], &ret);\n\n      printf(\"%s\\n\", ret.s);\n    }\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\nint W,H,i,j;\nchar dp[71][71][71],g[2],tmp[71],res[71];\n\nvoid ch(char x[],char y[])\n{\n\tint s,t;\n\twhile(x[0]=='0')\n\t\tmemmove(x,x+1,strlen(x));\n\twhile(y[0]=='0')\n\t\tmemmove(y,y+1,strlen(y));\n\ts=strlen(x),t=strlen(y);\n\tif(s<t||(s==t&&strcmp(x,y)<0))\n\t\tstrcpy(x,y);\n}\nint main()\n{\n\tfor(;scanf(\"%d%d\\n\",&W,&H),W;)\n\t{\n\t\tmemset(dp,0,sizeof(dp));\n\t\tmemset(res,0,sizeof(res));\n\t\tfor(i=0;i<H;i++,getchar())\n\t\t\tfor(j=0;j<W;j++)\n\t\t\t{\n\t\t\t\ttmp[0]=0;\n\t\t\t\tg[0]=getchar();\n\t\t\t\tif(g[0]<58)\n\t\t\t\t{\n\t\t\t\t\tif(i>0)\n\t\t\t\t\t\tch(tmp,dp[i-1][j]);\n\t\t\t\t\tif(j>0)\n\t\t\t\t\t\tch(tmp,dp[i][j-1]);\n\t\t\t\t\tsprintf(dp[i][j],\"%s\",strcat(tmp,g));\n\t\t\t\t}\n\t\t\t\tch(res,dp[i][j]);\n\t\t\t}\n\t\tputs(res);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#include<math.h>\n#include<string.h>\n\nchar map[71][71];\nchar answer[71][71][71];\nint w,h;\n\n\nchar *secretnum(char *a,char *b)\n{\n\tint k;\n\tint len1,len2;\n\t\n\tlen1 = strlen(a);\n\tlen2 = strlen(b);\n\t\n\tif(len1 > len2){\n\t\treturn a;\n\t}else if(len1 < len2 ){\n\t\treturn b;\n\t}else{\n\t\tfor(k=0;k<len1;k++){\n\t\t\tif(a[k] - b[k] > 0){\n\t\t\t\treturn a;\n\t\t\t}else if(a[k] - b[k] < 0){\n\t\t\t\treturn b;\n\t\t\t}\n\t\t}\n\t}\n\treturn a;\n}\n\nint main(void)\n{\n\tint i,j,c;\n\tint len;\n\tchar ans[71];\n\t\n\twhile(1)\n\t{\n\t\tscanf(\"%d %d \",&w,&h);\n\t\tif(w==0 && h==0)break;\n\t\t\n\t\tfor(i=0;i<h;i++){\n\t\t\tscanf(\"%s \",map[i]);\n\t\t}\n\n\t\tfor(i=0;i<h;i++){\n\t\t\tfor(j=0;j<w;j++){\n\t\t\t\tanswer[i][j][0] = '\\0';\n\t\t\t\tif(map[i][j] - '0' < 10 && map[i][j] - '0' >= 0){\n\t\t\t\t\tif(i>0)strcpy(answer[i][j],secretnum(answer[i][j],answer[i-1][j]));\n\t\t\t\t\tif(j>0)strcpy(answer[i][j],secretnum(answer[i][j],answer[i][j-1]));\n\t\t\t\t\tlen = strlen(answer[i][j]);\n\t\t\t\t\tanswer[i][j][len] = map[i][j];\n\t\t\t\t\tanswer[i][j][len+1] = '\\0';\n\t\t\t\t\tif(answer[i][j][0] == '0')answer[i][j][0] = '\\0';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tans[0] = '\\0';\n\t\tfor(i=0;i<h;i++){\n\t\t\tfor(j=0;j<w;j++){\n\t\t\t\tstrcpy(ans,secretnum(ans,answer[i][j]));\n\t\t\t}\n\t\t}\n\t\t\n\t\tprintf(\"%s\\n\",ans);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#define M 100\nchar m[M][M],s[M][M][M],r[M],*z;\ncmp(char *p,char *q){\n  int r=0;\n  for(;*p=='0';p++);\n  for(;*q=='0';q++);\n  if(r=strlen(p)-strlen(q))return r;\n  return strcmp(p,q);\n}\nmain(w,h,i,j,k,l){\n\tfor(;scanf(\"%d%d\",&w,&h),w;puts(z)){\n\t\tmemset(m,0xff,sizeof(m));\n\t\tmemset(s,0,sizeof(s));\n\t\tmemset(r,0,sizeof(r));\n\t\tfor(j=1;j<=h;j++)scanf(\"%s\",m[j]+1);\n\t\tfor(i=1;i<=w+1;i++)for(j=1;j<=h;j++)if(m[j][i]<'0'||'9'<m[j][i])m[j][i]=-1;\n\t\tfor(i=1;i<=w;i++)\n\t\t\tfor(j=1;j<=h;j++){\n\t\t\t\tif(m[j][i]==-1)continue;\n\t\t\t\tif(cmp(s[j][i-1],s[j-1][i])>0)strcpy(s[j][i],s[j][i-1]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\t\telse strcpy(s[j][i],s[j-1][i]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\t\tif(cmp(s[j][i],r)>0)strcpy(r,s[j][i]);\n\t\t\t}\n\t\tfor(z=r;*z=='0';z++);\n\t}\nreturn 0;}"
  },
  {
    "language": "C",
    "code": "#define M 100\nchar m[M][M],s[M][M][M],r[M],*z;\ncmp(char *p,char *q){\n\tfor(;*p=='0';p++);for(;*q=='0';q++);\n\treturn (z=strlen(p)-strlen(q))?z:strcmp(p,q);\n}\nmain(w,h,i,j,k,l){\n\tfor(;scanf(\"%d%d\",&w,&h),w;puts(z)){\n\t\tfor(memset(s,0,sizeof(s)),*r=0,j=1;j<=h;j++)scanf(\"%s\",m[j]+1);\n\t\tfor(i=1;i<=w;i++)for(j=1;j<=h;j++){\n\t\t\tif(!isdigit(m[j][i]))continue;\n\t\t\tif(cmp(s[j][i-1],s[j-1][i])>0)strcpy(s[j][i],s[j][i-1]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\telse strcpy(s[j][i],s[j-1][i]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\tif(cmp(s[j][i],r)>0)strcpy(r,s[j][i]);\n\t\t}\n\t\tfor(z=r;*z=='0';z++);\n\t}\nreturn 0;}"
  },
  {
    "language": "C",
    "code": "/* \n   AOJ 1126\n   The Secret Number\n\n*/\n\n#include<stdio.h>\n#define WH_MAX 80\ntypedef struct coded_number\n{\n  int len;\n  char s[WH_MAX + WH_MAX];\n}coded_number;\n\nint w, h;\nchar f[WH_MAX][WH_MAX];\ncoded_number memo[WH_MAX][WH_MAX];\n\nvoid copy(coded_number *src, coded_number *dst)\n{\n  int i;\n  dst->len = src->len;\n  for(i = 0; i <= src->len; i++)\n    dst->s[i] = src->s[i];\n\n}\n\nint ok(int x, int y)\n{\n  return (0 <= x && x < w && 0 <= y && y < h && '0' <= f[y][x] && f[y][x] <= '9');\n}\n\nvoid init(coded_number* x)\n{\n  x->len = 0;\n  x->s[0] = '\\0';\n}\n\nint is_zero(coded_number *x)\n{\n  int i;\n  if(!(x->len > 0))\n    return 0;\n  else\n    for(i = 0; i < x->len && x->s[i] == '0'; i++);\n  return i == x->len;\n}\n\nint comp(coded_number *x, coded_number *y)\n{\n  int i, x_i, y_i, x_len, y_len;\n  if(is_zero(x))\n    x_len = 1;\n  else\n    {\n      for(x_i = 0; x->s[x_i] == '0'; x_i++);\n      x_len = x->len - x_i;\n    }\n\n  if(is_zero(y))\n    y_len = 1;\n  else\n    {\n      for(y_i = 0; y->s[y_i] == '0'; y_i++);\n      y_len = y->len - y_i;\n    }\n\n  if(x_len > y_len)\n    return -1;\n  else if(x_len < y_len)\n    return 1;\n  else\n    for(i = x_i; i < x_len; i++)\n      {\n\tif(x->s[i] > y->s[i])\n\t  return -1;\n\telse if(x->s[i] < y->s[i])\n\t  return 1;\n      }\n  return 0;\n}\n\n\nvoid add_char(coded_number* dst, char c)\n{\n  int i, j;\n  for(i = dst->len, j = dst->len + 1; i >= 0; i--, j--)\n    dst->s[j] = dst->s[i];\n  dst->s[0] = c;\n  dst->len++;\n}\n\n/* \n\n7 4\n9R2A993\n0E314A0\n8A900DE\n820R037\n */\n\n\n\ncoded_number* search(int x, int y)\n{\n  coded_number right, below, ret;\n  int comp_ret;\n  init(&ret);\n  if(memo[y][x].len > 0)\n    return &memo[y][x];\n\n  else if(ok(x, y))\n    {\n      copy(search(x + 1, y), &right);\n      copy(search(x, y + 1), &below);\n      if(comp(&right, &below) < 0)\n\tcopy(&right, &ret);\n      else\n\tcopy(&below, &ret);\n      add_char(&ret, f[y][x]);\n      copy(&ret, &memo[y][x]);\n      return &memo[y][x];\n   }\n  return &ret;\n}\n\nvoid encode_to_number(coded_number *x)\n{\n  int i, j;\n  if(is_zero(x))\n    {\n      x->len = 1;\n      x->s[0] = '0';\n      x->s[1] = '\\0';\n    }\n\n  for(i = 0; x->s[i] == '0'; i++);\n\n  x->len -= i;\n  \n  for(j = 0; j < x->len; j++, i++)\n    x->s[j] = x->s[i];\n\n  x->s[j] = '\\0';\n}\n\nint main(void)\n{\n  int i, j;\n  coded_number ret;\n\n\n  while(scanf(\"%d %d\", &w, &h), (w && h))\n    {\n\n      for(i = 0; i < h; i++)\n\tscanf(\"%s\", f[i]);\n\n      for(i = 0; i < WH_MAX; i++)\n\tfor(j = 0; j < WH_MAX; j++)\n\t  init(&memo[i][j]);\n      init(&ret);\n\n\n\n      for(i = 0; i < h; i++)\n\tfor(j = 0; j < w; j++)\n\t  search(j, i);\n\n      for(i = 0; i < h; i++)\n\tfor(j = 0; j < w; j++)\n\t  encode_to_number(&memo[i][j]);\n\n      for(i = 0; i < h; i++)\n\tfor(j = 0; j < w; j++)\n\t  if(comp(&ret, &memo[i][j]) > 0)\n\t    copy(&memo[i][j], &ret);\n\n      printf(\"%s\\n\", ret.s);\n    }\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n\nchar max[72];\nchar matrix[72][72];\n\nvoid secret(int x, int y, char *num, int len)\n{\n\tchar c;\n\n\t\n\n\tnum[len] = matrix[y][x];\n\tnum[len + 1] = '\\0';\n\n\n\tif (strlen(max) < len + 1){\n\t\tstrcpy(max, num);\n\t}\n\telse if (strlen(max) == len + 1){\n\t\tif (strcmp(max, num) < 0){\n\t\t\tstrcpy(max, num);\n\t\t}\n\t}\n//printf(\"<%s, %s>\", num, max);\n\t\n\tc = matrix[y + 1][x];\n\tif ('0' <= c && c <= '9'){\n\t\tsecret(x, y + 1, num, len + 1);\n\t\tnum[len + 1] = '\\0';\n\t}\n\n\tc = matrix[y][x + 1];\n\tif ('0' <= c && c <= '9'){\n\t\tsecret(x + 1, y, num, len + 1);\n\t\tnum[len + 1] = '\\0';\n\t}\n}\n\n\nint main(void)\n{\n\tint W, H, C;\n\tint i, j;\n\tint x, y;\n\tchar c, c1, c2;\n\tchar num[72];\n\t\n\t\n\twhile (1){\n\t\tscanf(\"%d%d\", &W, &H);\n\t\tif (W == 0 && H == 0){\n\t\t\tbreak;\n\t\t}\n\t\t\n\t\tmemset(matrix, 0, sizeof(matrix));\n\t\tfor (y = 1; y <= H; y++){\n\t\t\tscanf(\"%s\", &matrix[y][1]);\n\t\t}\n\t\t\n\n\t\tmax[0] = '\\0';\n\t\tfor (y = 1; y <= H; y++){\n\t\t\tfor (x = 1; x <= W; x++){\n\t\t\t\tc = matrix[y][x];\n\t\t\t\tc1 = matrix[y - 1][x];\n\t\t\t\tc2 = matrix[y][x - 1];\n\t\t\t\tif (('0' <= c && c <= '9') &&\n\t\t\t\t    (c1 < '0' || '9' < c1) &&\n\t\t\t\t    (c2 < '0' || '9' < c2)){\n\t\t\t\t\t\n\t\t\t\t\tnum[0] = '\\0';\n//printf(\"[%c]\", matrix[y][x]);\n\t\t\t\t\tsecret(x, y, num, 0);\n\t\t\t\t \n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfor (x = 0; max[x] == '0'; x++);\n\t\tprintf(\"%s\\n\", &max[x]);\n\t}\n\treturn (0);\n}"
  },
  {
    "language": "C",
    "code": "/* \n   AOJ 1126\n   The Secret Number\n\n*/\n\n#include<stdio.h>\n#define WH_MAX 80\ntypedef struct coded_number\n{\n  int len;\n  char s[WH_MAX];\n}coded_number;\n\nint w, h;\nchar f[WH_MAX][WH_MAX];\ncoded_number memo[WH_MAX][WH_MAX];\n\nvoid copy(coded_number *src, coded_number *dst)\n{\n  int i;\n  dst->len = src->len;\n  for(i = 0; i <= src->len; i++)\n    dst->s[i] = src->s[i];\n\n}\n\nint ok(int x, int y)\n{\n  return (0 <= x && x < w && 0 <= y && y < h && '0' <= f[y][x] && f[y][x] <= '9');\n}\n\nvoid init(coded_number* x)\n{\n  x->len = 0;\n  x->s[0] = '\\0';\n}\n\nint comp(coded_number *x, coded_number *y)\n{\n  int i, x_i, y_i, x_len, y_len;\n\n  for(x_i = 0; x->s[x_i] == '0'; x_i++);\n  for(y_i = 0; y->s[y_i] == '0'; y_i++);\n\n\n  x_len = x->len - x_i;\n  y_len = y->len - y_i;\n\n  if(x_len > y_len)\n    return -1;\n  else if(x_len < y_len)\n    return 1;\n  else\n    for(i = x_i; i < x_len; i++)\n      {\n\tif(x->s[i] > y->s[i])\n\t  return -1;\n\telse if(x->s[i] < y->s[i])\n\t  return 1;\n      }\n  return 0;\n}\n\n\nvoid add_char(coded_number* dst, char c)\n{\n  int i, j;\n  for(i = dst->len, j = dst->len + 1; i >= 0; i--, j--)\n    dst->s[j] = dst->s[i];\n  dst->s[0] = c;\n  dst->len++;\n}\n\n/* \n\n7 4\n9R2A993\n0E314A0\n8A900DE\n820R037\n */\n\n\n\ncoded_number* search(int x, int y)\n{\n  coded_number right, below, ret;\n  int comp_ret;\n  init(&ret);\n  if(memo[y][x].len > 0)\n    return &memo[y][x];\n\n  else if(ok(x, y))\n    {\n      copy(search(x + 1, y), &right);\n      copy(search(x, y + 1), &below);\n      if(comp(&right, &below) < 0)\n\tcopy(&right, &ret);\n      else\n\tcopy(&below, &ret);\n      add_char(&ret, f[y][x]);\n      copy(&ret, &memo[y][x]);\n      return &memo[y][x];\n   }\n  return &ret;\n}\n\nint main(void)\n{\n  int i, j;\n  coded_number ret;\n\n\n  while(scanf(\"%d %d\", &w, &h), (w && h))\n    {\n\n      for(i = 0; i < h; i++)\n\tscanf(\"%s\", f[i]);\n\n      for(i = 0; i < WH_MAX; i++)\n\tfor(j = 0; j < WH_MAX; j++)\n\t  init(&memo[j][i]);\n      init(&ret);\n\n\n\n      for(i = 0; i < h; i++)\n\tfor(j = 0; j < w; j++)\n\t  search(j, i);\n      \n      for(i = 0; i < h; i++)\n\tfor(j = 0; j < w; j++)\n\t  if(comp(&ret, &memo[j][i]) > 0)\n\t    copy(&memo[j][i], &ret);\n\n      printf(\"%s\\n\", ret.s);\n    }\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "#define M 100\nchar m[M][M],s[M][M][M],r[M],*z;\ncmp(char *p,char *q){\n  int r=0;\n  for(;*p=='0';p++);\n  for(;*q=='0';q++);\n  if(r=strlen(p)-strlen(q))return r;\n  return strcmp(p,q);\n}\nmain(w,h,i,j,k,l){\n  for(;scanf(\"%d%d\",&w,&h),w;puts(z)){\n    memset(m,0xff,sizeof(m));\n    memset(s,0,sizeof(s));\n\tmemset(r,0,sizeof(r));\n    for(j=1;j<=h;j++)scanf(\"%s\",m[j]+1);\n    for(i=1;i<=w+1;i++)for(j=1;j<=h;j++)if(m[j][i]<'0'||'9'<m[j][i])m[j][i]=-1;\n    for(k=1;k<M;k++){\n      for(j=i=k;i<=w;i++){\n        if(m[j][i]==-1)continue;\n\t\tif(cmp(s[j][i-1],s[j-1][i])>0)strcpy(s[j][i],s[j][i-1]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\telse strcpy(s[j][i],s[j-1][i]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\tif(cmp(s[j][i],r)>0)strcpy(r,s[j][i]);\n      }\n      for(j=i=k;j<=h;j++){\n        if(m[j][i]==-1)continue;\n\t\tif(cmp(s[j][i-1],s[j-1][i])>0)strcpy(s[j][i],s[j][i-1]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\telse strcpy(s[j][i],s[j-1][i]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\tif(cmp(s[j][i],r)>0)strcpy(r,s[j][i]);\n      }\n    }\n    for(z=r;*z=='0';z++);\n  }\nreturn 0;}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#define WH_MAX 70\nint w, h;\nchar dp[WH_MAX * WH_MAX];\nchar f[WH_MAX * WH_MAX];\n\n\n/* \n7 4\n9R2A993\n0E314A0\n8A900DE\n820R037\n6 7\nJH03HE\nID7722\n0DA1AH\n30C9G5\n99971A\nCA7EAI\nAHLBEM\n20 2\nA1234567891234CBDEGH\nBDEDF908034265091499\n0 0\n\n---------\n\n23900037\n771971\n12345908034265091499\n*/\n\nvoid init(char *str, int n)\n{\n  int i;\n  for(i = 0; i < n; i++)\n    str[i] = '\\0';\n}\n\nint is_zero(char *str)\n{\n  int i;\n  for(i = 0;  str[i] == '0'; i++);\n  if(str[i] == '\\0')\n    return 1;\n  else\n    return 0;\n}\n\nint shape(char *str)\n{\n  int i, j, zero = 0;\n  if(str[0] == '\\0')\n    return 0;\n  else if(is_zero(str))\n    {\n      str[0] = '0';\n      str[1] = '\\0';\n      return 1;\n    }\n  else\n    {\n      for(i = 0; str[i] != '\\0' && str[i] == '0'; i++, zero++);\n      for(i = 0, j = zero; str[j] != '\\0'; i++, j++)\n\tstr[i] = str[j];\n      str[i] = '\\0';\n      return i;\n    }\n}\n\nvoid strcp(char *src, char *dst)\n{\n  int i;\n  for(i = 0; src[i] != '\\0'; i++)\n    dst[i] = src[i];\n  dst[i] = '\\0';\n}\n\nchar* max(char *s0, char *s1)\n{\n\n  int i, j, s0_n = shape(s0), s1_n = shape(s1);\n\n\n  if(s0_n > s1_n)\n    return s0;\n  else if(s0_n < s1_n)\n    return s1;\n  else\n    {\n      for(i = 0; i < s0_n; i++)\n\t{\n\t  if(s0[i] > s1[i])\n\t    return s0;\n\t  else if(s0[i] < s1[i])\n\t    return s1;\n\t}\n    }\n  return s0;\n}\n\nint ok(int x, int y)\n{\n  return 0 <= x && x < w && 0 <= y && y <= h && '0' <= f[y * w + x] && f[y * w + x] <= '9';\n}\n\n\nchar* dfs(int x, int y, char *str, int str_n)\n{\n\n  char right[WH_MAX * 2] = {'\\0'}, below[WH_MAX  * 2] = {'\\0'}, right_ret[WH_MAX * 2] = {'\\0'}, below_ret[WH_MAX * 2] = {'\\0'};\n  if(ok(x, y))\n    {\n      strcp(str, right);\n      strcp(str, below);\n      right[str_n] = f[y * w + x];\n      right[str_n + 1] = '\\0';\n      below[str_n] = f[y * w + x];\n      below[str_n + 1] = '\\0';\n      str_n++;\n\n      strcp(dfs(x + 1, y, right, str_n), right_ret);\n\n      strcp(dfs(x, y + 1, below, str_n), below_ret);\n\n      return max(right_ret, below_ret);\n    }\n\n  return str;\n}\n\nint main(void)\n{\n  char d;\n  char secret_num[WH_MAX * 2] = {'\\0'};\n  char searched_num[WH_MAX * 2] = {'\\0'};\n  char s0[10], s1[10];\n  int i, j;\n\n  /* scanf(\"%s\", s0), scanf(\"%s\", s1); */\n  /* printf(\"%s\\n\", max(s0, s1)); */\n\n  \n  while(scanf(\"%d %d\", &w, &h), (w && h))\n    {\n      scanf(\"%c\", &d);\n      for(i = 0; i < h; i++)\n  \t{\n  \t  for(j = 0; j < w; j++)\n  \t    {\n  \t      scanf(\"%c\", &f[i * w + j]);\n  \t    }\n  \t  scanf(\"%c\", &d);\n  \t}\n\n\n      for(i = 0; i < h; i++)\n      \t{\n      \t  for(j = 0; j < w; j++)\n      \t    {\n      \t      strcp(max(dfs(j, i, searched_num, 0), secret_num), secret_num);\n      \t      init(searched_num, WH_MAX * 2);\n      \t    }\n      \t}\n      printf(\"%s\\n\", secret_num);\n      init(secret_num, WH_MAX * 2);\n\n    }\n\n  return 0;\n\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n\nchar max[72];\nchar matrix[72][72];\nchar num[72][72][72];\n\nint large(char *num1, char *num2)\n{\n\tif (strlen(num1) < strlen(num2)){\n\t\treturn (-1);\n\t}\n\tif (strlen(num1) == strlen(num2)){\n\t\treturn (strcmp(num1, num2));\n\t}\n\n\treturn (1);\n}\n\nint main(void)\n{\n\tint W, H, C;\n\tint i, j;\n\tint x, y;\n\tchar c, c1, c2;\n\t\n\t\n\twhile (1){\n\t\tscanf(\"%d%d\", &W, &H);\n\t\tif (W == 0 && H == 0){\n\t\t\tbreak;\n\t\t}\n\t\t\n\t\tmemset(matrix, 0, sizeof(matrix));\n\t\tfor (y = 1; y <= H; y++){\n\t\t\tscanf(\"%s\", &matrix[y][1]);\n\t\t}\n\t\t\n\n\t\tmemset(num, 0, sizeof(num));\n\t\tmax[0] = '\\0';\n\t\tfor (y = 1; y <= H; y++){\n\t\t\tfor (x = 1; x <= W; x++){\n\t\t\t\tc = matrix[y][x];\n\t\t\t\tif ('0' <= c && c <= '9'){\n\t\t\t\t\tif (large(num[y - 1][x], num[y][x - 1]) > 0){\n\t\t\t\t\t\tstrcpy(num[y][x], num[y - 1][x]);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tstrcpy(num[y][x], num[y][x - 1]);\n\t\t\t\t\t}\n\t\t\t\t\tnum[y][x][strlen(num[y][x])] = c;\n\t\t\t\t\tnum[y][x][strlen(num[y][x]) + 1] = '\\0';\n//printf(\"[%s]\", num[y][x]);\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\tif (large(max, num[y][x]) < 0){\n\t\t\t\t\t\tstrcpy(max, num[y][x]);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n//\t\t\t\telse{\n//printf(\"[*]\");\n//\t\t\t\t}\n\t\t\t}\n//printf(\"\\n\");\n\n\t\t}\n\t\tfor (x = 0; max[x] == '0'; x++);\n\t\tprintf(\"%s\\n\", &max[x]);\n\t}\n\t\n\treturn (0);\n}"
  },
  {
    "language": "C",
    "code": "/* \n   AOJ 1126\n   The Secret Number\n\n*/\n\n#include<stdio.h>\n#define WH_MAX 70\nchar field[WH_MAX][WH_MAX];\nchar target_str[WH_MAX*2] = {'\\0'};\nint w, h, max_str_n;\n\n\n\nint ok(int x, int y)\n{\n  return 0 <= x && x < w && 0 <= y && y <= h && '0' <= field[y][x] && field[y][x] <= '9';\n}\n\nvoid update_target(char str[], int n)\n{\n  int i;\n  for(i = 0; i < n; i++)\n    target_str[i] = str[i];\n  max_str_n = n;\n}\n\nvoid update_sec_str(char sec_str[], int secret_n)\n{\n  int i, j, zero_n = 0;\n  char secret_str[secret_n];\n  for(i = 0; i < secret_n; i++)\n    secret_str[i] = sec_str[i];\n  \n  for(i = 0; i < secret_n; i++)\n    {\n      if(secret_str[i] == '0')\n\tzero_n++;\n      else\n\tbreak;\n    }\n  secret_n -= zero_n;\n\n  for(i = 0, j = zero_n; j < secret_n; i++, j++)\n    secret_str[i] = secret_str[j];\n  secret_str[i] = '\\0';\n\n\n  if(max_str_n < secret_n)\n    update_target(secret_str, secret_n);\n  else if(max_str_n == secret_n)\n    {\n      for(i = 0; i < secret_n; i++)\n\t{\n\t  if(target_str[i] > secret_str[i])\n\t    return ;\n\t  else if(target_str[i] < secret_str[i])\n\t    update_target(secret_str, secret_n);\n\t}\n    }\n}\n\n\nvoid dfs(int x, int y, char secret_str[], int secret_n)\n{\n  if(!ok(x, y))\n    {\n      update_sec_str(secret_str, secret_n);\n      return ;      \n    }\n  secret_str[secret_n++] = field[y][x];\n  secret_str[secret_n] = '\\0';\n  dfs(x + 1, y, secret_str, secret_n);\n  dfs(x, y + 1, secret_str, secret_n);\n  return ;\n}\n\nvoid init(void)\n{\n  int i;\n  for(i = 0; i <= max_str_n; i++)\n    target_str[i] = '\\0';\n\n  max_str_n = 0;\n\n}\n\nint main(void)\n{\n  int  i, j;\n  char secret_str[WH_MAX*2] = {'\\0'};\n  while(scanf(\"%d %d\", &w, &h), (w && h))\n    {\n      for(i = 0; i < h; i++)\n\t{\n\t  scanf(\"%s\", field[i]);\n\t}\n      for(i = 0; i < h; i++)\n\t{\n\t  for(j = 0; j < w; j++)\n\t    {\n\t      dfs(j, i, secret_str, 0);\n\t    }\n\t}\n      printf(\"%s\\n\", target_str);\n      init();\n    }\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "#define M 100\nchar m[M][M],s[M][M][M],r[M],*z;\ncmp(char *p,char *q){int r=0;\n\tfor(;*p=='0';p++);for(;*q=='0';q++);\n\treturn (z=strlen(p)-strlen(q))?z:strcmp(p,q);\n}\nmain(w,h,i,j,k,l){\n\tfor(;scanf(\"%d%d\",&w,&h),w;puts(z)){\n\t\tfor(memset(s,0,sizeof(s)),memset(r,0,sizeof(r)),j=1;j<=h;j++)scanf(\"%s\",m[j]+1);\n\t\tfor(i=1;i<=w;i++)for(j=1;j<=h;j++){\n\t\t\tif(!isdigit(m[j][i]))continue;\n\t\t\tif(cmp(s[j][i-1],s[j-1][i])>0)strcpy(s[j][i],s[j][i-1]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\telse strcpy(s[j][i],s[j-1][i]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\tif(cmp(s[j][i],r)>0)strcpy(r,s[j][i]);\n\t\t}\n\t\tfor(z=r;*z=='0';z++);\n\t}\nreturn 0;}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <ctype.h>\n#include <stdlib.h>\n\nchar board[71][71];\nint W, H;\n\nint gt(char *x, char *y);\nchar *solve(int x, int y, int level, char now[]);\n\nint main(void)\n{\n    while(1){\n        int i, j;\n        scanf(\"%d %d\", &W, &H);\n        if(W ==0 && H == 0)\n            break;\n\n        for(i = 0; i < H; i++)\n            scanf(\"%s\", &(board[i + 1][1]));\n\n        for(i = 0; i <= H + 1; i++)\n            board[i][0] = board[i][W + 1] = 'A';\n        for(i = 0; i <= W + 1; i++)\n            board[0][i] = board[H + 1][i] = 'A';\n\n        char max[71];\n        char now[70];\n        char *temp;\n        max[0] = '1';\n        max[1] = '\\0';\n        for(i = 1; i <= H; i++)\n            for(j = 1; j <= W; j++){\n                if(isdigit(board[i][j])){\n                    //printf(\"start from (%d, %d)\\n\", j, i);\n                    temp = solve(j, i, 0, now);\n                    if(gt(temp, max)){\n                        strcpy(max, temp);\n                    }\n                    free(temp);\n                }\n            }\n        temp = max;\n        while(*temp == '0')\n            temp++;\n\n        printf(\"%s\\n\", temp);\n    }\n\n    return 0;\n}\n\nint gt(char *x, char *y)\n{\n    char *px, *py;\n    char *sx, *sy;\n    px = x;\n    py = y;\n    int len_x, len_y;\n    len_x = len_y = 0;\n    while(*px == '0'){\n        px++;\n    }\n    while(*py == '0'){\n        py++;\n    }\n\n    sx = px;\n    sy = py;\n    while(*px != '\\0'){\n        px++;\n        len_x++;\n    }\n    while(*py != '\\0'){\n        py++;\n        len_y++;\n    }\n\n    if(len_x != len_y)\n        return len_x > len_y;\n\n    while(*sx == *sy){\n        sx++;\n        sy++;\n    }\n\n    return (*sx > *sy);\n}\n\nchar *solve(int x, int y, int level, char now[])\n{\n    char *max, *temp;\n    //printf(\"visit (%d, %d)\\n\", x, y);\n    now[level] = board[y][x];\n    if(isalpha(board[y][x + 1]) && isalpha(board[y + 1][x])){\n        temp = malloc(sizeof(char) * level + 2);\n        int i;\n        for(i = 0; i <= level; i++){\n            temp[i] = now[i];\n        }\n        temp[level + 1] = '\\0';\n        //printf(\"number: %s\\n\", temp);\n        return temp;\n    }\n\n    max = malloc(sizeof(char) * 71);\n    max[0] = '1';\n    max[1] = '\\0';\n    if(isdigit(board[y][x + 1])){\n        max = solve(x + 1, y, level + 1, now);\n    }\n    if(isdigit(board[y + 1][x])){\n        temp = solve(x, y + 1, level + 1, now);\n        if(gt(temp, max)){\n            strcpy(max, temp);\n            free(temp);\n        }\n    }\n\n    return max;\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<stdlib.h>\n#include<math.h>\n#include<string.h>\n\nchar map[71][71];\nchar answer[71],tmp[71];\nint w,h;\nint max;\n\nvoid secretnum(int i,int j)\n{\n\tint k;\n\tint len1,len2;\n\tint c;\n\t\n\tlen1 = strlen(tmp);\n\tlen2 = strlen(answer);\n\ttmp[len1] = map[i][j];\n\ttmp[len1+1] = '\\0';\n\t\n\tc=-1;\n\twhile(tmp[++c]=='0');\n\tfor(k=c;k<=len1+1;k++){\n\t\ttmp[k-c]=tmp[k];\n\t}\n\tlen1-=c;\n\t\n\tif(len1 + 1 > len2){\n\t\tstrcpy(answer,tmp);\n\t}else if(len1 + 1 == len2){\n\t\tfor(k=c;k<len1+1;k++){\n\t\t\tif(tmp[k] - answer[k] > 0){\n\t\t\t\tstrcpy(answer,tmp);\n\t\t\t\tbreak;\n\t\t\t}else if(tmp[k] - answer[k] < 0){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tif(i+1<h){\n\t  if(map[i+1][j] - '0' < 10){\n\t\t\tsecretnum(i+1,j);\n\t\t}\n\t}\n\tif(j+1<w){\n\t\tif(map[i][j+1] - '0' < 10){\n\t\t\tsecretnum(i,j+1);\n\t\t}\n\t}\n\t\n\ttmp[len1] = '\\0';\n\n\treturn;\n}\n\nint main(void)\n{\n\tint i,j;\n\tint len;\n\t\n\twhile(1)\n\t{\n\t\tscanf(\"%d %d \",&w,&h);\n\t\tif(w==0 && h==0)break;\n\t\t\n\t\tfor(i=0;i<h;i++){\n\t\t\tscanf(\"%s \",map[i]);\n\t\t}\n\n\t\tanswer[0]='\\0';\n\t\ttmp[0]='\\0';\n\n\t\tfor(i=0;i<h;i++){\n\t\t\tfor(j=0;j<w;j++){\n\t\t\t\tif(map[i][j] - '0' < 10){\n\t\t\t\t\tlen = strlen(answer);\n\t\t\t\t\tif(i+j>len)secretnum(i,j);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tprintf(\"%s\\n\",answer);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "/* \n   AOJ 1126\n   The Secret Number\n\n*/\n\n#include<stdio.h>\n#define WH_MAX 80\ntypedef struct coded_number\n{\n  int len;\n  char s[WH_MAX + WH_MAX];\n}coded_number;\n\nint w, h;\nchar f[WH_MAX][WH_MAX];\ncoded_number memo[WH_MAX][WH_MAX];\n\nvoid copy(coded_number *src, coded_number *dst)\n{\n  int i;\n  dst->len = src->len;\n  for(i = 0; i <= src->len; i++)\n    dst->s[i] = src->s[i];\n\n}\n\nint ok(int x, int y)\n{\n  return (0 <= x && x < w && 0 <= y && y < h && '0' <= f[y][x] && f[y][x] <= '9');\n}\n\nvoid init(coded_number* x)\n{\n  x->len = 0;\n  x->s[0] = '\\0';\n}\n\nint is_zero(coded_number *x)\n{\n  int i;\n  if(!(x->len > 0))\n    return 0;\n  else\n    for(i = 0; i < x->len && x->s[i] == '0'; i++);\n  return i == x->len;\n}\n\nint comp(coded_number *x, coded_number *y)\n{\n  /* int i, x_i, y_i, x_len, y_len; */\n  /* if(is_zero(x)) */\n  /*   x_len = 1; */\n  /* else */\n  /*   { */\n  /*     for(x_i = 0; x->s[x_i] == '0'; x_i++); */\n  /*     x_len = x->len - x_i; */\n  /*   } */\n\n  /* if(is_zero(y)) */\n  /*   y_len = 1; */\n  /* else */\n  /*   { */\n  /*     for(y_i = 0; y->s[y_i] == '0'; y_i++); */\n  /*     y_len = y->len - y_i; */\n  /*   } */\n  int i, x_len = x->len, y_len = y->len;\n  if(x_len > y_len)\n    return -1;\n  else if(x_len < y_len)\n    return 1;\n  else\n    for(i = 0; i < x_len; i++)\n      {\n\tif(x->s[i] > y->s[i])\n\t  return -1;\n\telse if(x->s[i] < y->s[i])\n\t  return 1;\n      }\n  return 0;\n}\n\n\nvoid add_char(coded_number* dst, char c)\n{\n  int i, j;\n  for(i = dst->len, j = dst->len + 1; i >= 0; i--, j--)\n    dst->s[j] = dst->s[i];\n  dst->s[0] = c;\n  dst->len++;\n}\n/* \n\n20 20\n00000000000000000000\n08000000000000000000\n00000000000000000000\n00000000000000000000\n00000000000000000000\n00000000000000000000\n00000000000000000000\n00000000000000000000\n00000000000000000000\n00000000000000000000\n0000000000BDMZ000000\n0000000000LJCU000000\n0000000000ZDOG000000\n0000000000YDYZ000000\n0000000000KUJB000000\n0000000000NKTX000000\n0000000000LXQQ000000\n0000000000LPCK000000\n0000000000JBHP000000\n0000000000VMSM000000\n */\n\ncoded_number* search(int x, int y)\n{\n  coded_number right, below, ret;\n  int comp_ret;\n  init(&ret);\n  if(memo[y][x].len > 0)\n    return &memo[y][x];\n\n  else if(ok(x, y))\n    {\n      copy(search(x + 1, y), &right);\n      copy(search(x, y + 1), &below);\n      if(comp(&right, &below) < 0)\n\tcopy(&right, &ret);\n      else\n\tcopy(&below, &ret);\n      /* printf(\"right = %s below = %s\\n\", right.s, below.s); */\n      add_char(&ret, f[y][x]);\n      copy(&ret, &memo[y][x]);\n      /* printf(\"(%d %d)%s\\n\", x, y, memo[y][x].s); */\n      return &memo[y][x];\n   }\n  return &ret;\n}\n\nvoid encode_to_number(coded_number *x)\n{\n  int i, j;\n  if(is_zero(x))\n    {\n      x->len = 1;\n      x->s[0] = '0';\n      x->s[1] = '\\0';\n    }\n\n  for(i = 0; x->s[i] == '0'; i++);\n\n  x->len -= i;\n  \n  for(j = 0; j < x->len; j++, i++)\n    x->s[j] = x->s[i];\n\n  x->s[j] = '\\0';\n}\n\nint main(void)\n{\n  int i, j;\n  coded_number ret;\n\n\n  while(scanf(\"%d %d\", &w, &h), (w && h))\n    {\n\n      for(i = 0; i < h; i++)\n\tscanf(\"%s\", f[i]);\n\n      for(i = 0; i < WH_MAX; i++)\n\tfor(j = 0; j < WH_MAX; j++)\n\t  init(&memo[i][j]);\n      init(&ret);\n\n\n\n      for(i = 0; i < h; i++)\n\tfor(j = 0; j < w; j++)\n\t  {\n\t    if('0' < f[i][j] && f[i][j] <= '9')\n\t      search(j, i);\n\t  }\n\n\n      /* for(i = 0; i < h; i++) */\n      /* \tfor(j = 0; j < w; j++) */\n      /* \t  encode_to_number(&memo[i][j]); */\n\n      for(i = 0; i < h; i++)\n\tfor(j = 0; j < w; j++)\n\t  if(comp(&ret, &memo[i][j]) > 0)\n\t    copy(&memo[i][j], &ret);\n\n      printf(\"%s\\n\", ret.s);\n    }\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <ctype.h>\n\nint w,h;\nchar input[70][100];\n\nchar map[71][71][100];\n\nint mystrcmp(const char* a,const char* b) {\n\tint la,lb;\n\tla=strlen(a);\n\tlb=strlen(b);\n\tif(la>lb)return 1;\n\tif(la<lb)return -1;\n\treturn strcmp(a,b);\n}\n\nint main(void) {\n\tint i,j;\n\tint mi,mj;\n\twhile(1) {\n\t\tscanf(\"%d%d\",&w,&h);\n\t\tif(w==0 && h==0)break;\n\t\tfor(i=0;i<h;i++)scanf(\"%s\",input[i]);\n\t\tmemset(map,0,sizeof(map));\n\t\tfor(i=h-1;i>=0;i--) {\n\t\t\tfor(j=w-1;j>=0;j--) {\n\t\t\t\tif(isdigit(input[i][j])) {\n\t\t\t\t\tmap[i][j][0]=input[i][j];\n\t\t\t\t\tmap[i][j][1]=0;\n\t\t\t\t\tif(mystrcmp(map[i+1][j],map[i][j+1])>0) {\n\t\t\t\t\t\tstrcat(map[i][j],map[i+1][j]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstrcat(map[i][j],map[i][j+1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tmi=mj=0;\n\t\tfor(i=0;i<h;i++) {\n\t\t\tfor(j=0;j<w;j++) {\n\t\t\t\tif(isdigit(input[i][j]) && input[i][j]!='0') {\n\t\t\t\t\tif(mystrcmp(map[i][j],map[mi][mj])>0) {\n\t\t\t\t\t\tmi=i;\n\t\t\t\t\t\tmj=j;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tputs(map[mi][mj]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <ctype.h>\n#include <string.h>\n\nint W, H;\nchar table[72][72][72];\nchar matrix[72][72];\n\nchar maximum[72];\n\nchar *greater(char *s1, char *s2)\n{\n  int i;\n  int nan1 = !strcmp(s1, \"NaN\");\n  int nan2 = !strcmp(s2, \"NaN\");\n  int len1, len2;\n  if (nan1) { return s2; }\n  if (nan2) { return s1; }\n\n  len1 = strlen(s1);\n  len2 = strlen(s2);\n  if (len1 > len2) { return s1; }\n  if (len1 < len2) { return s2; }\n  for (i = 0; i < len1; i++) {\n    if (s1[i] < s2[i]) { return s2; }\n    if (s1[i] > s2[i]) { return s1; }\n  }\n  return s1;\n}\n\nvoid concatenate(char s[], char d[], char c)\n{\n  int len = strlen(s);\n  if (isdigit(c)) {\n    if (c == '0') {\n      if (strcmp(s, \"NaN\") == 0) { strcpy(d, \"NaN\"); }\n      else {\n        strcpy(d, s);\n        d[len] = c;\n        d[len+1] = '\\0';\n        if (d == greater(maximum, d)) { strcpy(maximum, d); }\n      }\n    }\n    else {\n      if (strcmp(s, \"NaN\") == 0) {\n        d[0] = c; d[1] = '\\0';\n        if (d == greater(maximum, d)) { strcpy(maximum, d); }\n      }\n      else {\n        strcpy(d, s);\n        d[len] = c;\n        d[len+1] = '\\0';\n        if (d == greater(maximum, d)) { strcpy(maximum, d); }\n      }\n    }\n  } else {\n    strcpy(d, \"NaN\");\n  }\n}\n\nint main()\n{\n  int i, j;\n  char s[1024], greater_s[72];\n\n  while (1) {\n    if (NULL == gets(s)) { break; }\n    sscanf(s, \"%d%d\", &W, &H); if (W == 0 && H == 0) { break; }\n    for (i = 0; i < H; i++) {\n      gets(matrix[i]);\n    }\n\n    strcpy(maximum, \"0\");\n\n    concatenate(\"NaN\", table[0][0], matrix[0][0]);\n    /*printf(\"%d,%d - %s\\n\", 0, 0, table[0][0]);*/\n    for (j = 1; j < W; j++) {\n      concatenate(table[0][j-1], table[0][j], matrix[0][j]);\n      /*printf(\"%d,%d - %s\\n\", 0, j, table[0][j]);*/\n    }\n    for (i = 1; i < H; i++) {\n      concatenate(table[i-1][0], table[i][0], matrix[i][0]);\n      /*printf(\"%d,%d - %s\\n\", i, 0, table[i][0]);*/\n      for (j = 1; j < W; j++) {\n        strcpy(greater_s, greater(table[i-1][j], table[i][j-1]));\n        concatenate(greater_s, table[i][j], matrix[i][j]);\n        /*printf(\"%d,%d - %s\\n\", i, j, table[i][j]);*/\n      }\n    }\n    printf(\"%s\\n\", maximum);\n  }\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <ctype.h>\n#include <stdlib.h>\n\nchar board[71][71];\nchar ans[71][71][71];\nint W, H;\n\nint gt(char *x, char *y);\nint gt4dp(char *x, char *y);\nchar *solve(int x, int y, int level, char now[]);\nvoid solve_dp(void);\n\nint main(void)\n{\n    while(1){\n        int i, j;\n\n        scanf(\"%d %d\", &W, &H);\n        if(W ==0 && H == 0)\n            break;\n\n        for(i = 0; i < H; i++)\n            scanf(\"%s\", &(board[i + 1][1]));\n\n        for(i = 0; i <= H + 1; i++)\n            board[i][0] = board[i][W + 1] = 'A';\n        for(i = 0; i <= W + 1; i++)\n            board[0][i] = board[H + 1][i] = 'A';\n\n        char max[71];\n        char *temp;\n        max[0] = '1';\n        max[1] = '\\0';\n\n\n        solve_dp();\n        for(i = 1; i <= H; i++){\n            for(j = 1; j <= W; j++){\n                //printf(\"ans[%d][%d](%d, %d): %s\\n\", i, j, j, i, ans[i][j]);\n                if(isdigit(board[i][j]) && gt(ans[i][j], max)){\n                    strcpy(max, ans[i][j]);\n                }\n            }\n        }\n\n        temp = max;\n        while(*temp == '0')\n            temp++;\n\n        printf(\"%s\\n\", temp);\n\n        //while(1){\n        //    int x, y;\n        //    scanf(\"%d %d\", &x, &y);\n        //    if(x == 0 && y == 0)\n        //        break;\n\n        //    printf(\"ans[%d][%d]: %s\\n\", y, x, ans[y][x]);\n        //}\n    }\n\n    return 0;\n}\n\nint gt4dp(char *x, char *y)\n{\n    int len_x, len_y;\n    char *px, *py;\n    px = x;\n    py = y;\n    len_x = len_y = 0;\n    while(*px != '\\0'){\n        len_x++;\n        px++;\n    }\n    while(*py != '\\0'){\n        len_y++;\n        py++;\n    }\n    if(len_x != len_y)\n        return len_x > len_y;\n    while(*x == *y){\n        x++;\n        y++;\n    }\n\n    return *x > *y;\n}\n\nint gt(char *x, char *y)\n{\n    char *px, *py;\n    char *sx, *sy;\n    px = x;\n    py = y;\n    int len_x, len_y;\n    len_x = len_y = 0;\n    while(*px == '0'){\n        px++;\n    }\n    while(*py == '0'){\n        py++;\n    }\n\n    sx = px;\n    sy = py;\n    while(*px != '\\0'){\n        px++;\n        len_x++;\n    }\n    while(*py != '\\0'){\n        py++;\n        len_y++;\n    }\n\n    if(len_x != len_y)\n        return len_x > len_y;\n\n    while(*sx == *sy){\n        sx++;\n        sy++;\n    }\n\n    return (*sx > *sy);\n}\n\nchar *solve(int x, int y, int level, char now[])\n{\n    char *max, *temp;\n    //printf(\"visit (%d, %d)\\n\", x, y);\n    now[level] = board[y][x];\n    if(isalpha(board[y][x + 1]) && isalpha(board[y + 1][x])){\n        temp = malloc(sizeof(char) * level + 2);\n        int i;\n        for(i = 0; i <= level; i++){\n            temp[i] = now[i];\n        }\n        temp[level + 1] = '\\0';\n        //printf(\"number: %s\\n\", temp);\n        return temp;\n    }\n\n    max = malloc(sizeof(char) * 71);\n    max[0] = '1';\n    max[1] = '\\0';\n    if(isdigit(board[y][x + 1])){\n        max = solve(x + 1, y, level + 1, now);\n    }\n    if(isdigit(board[y + 1][x])){\n        temp = solve(x, y + 1, level + 1, now);\n        if(gt(temp, max)){\n            strcpy(max, temp);\n            free(temp);\n        }\n    }\n\n    return max;\n}\n\nvoid solve_dp(void)\n{\n    int i, j;\n\n    for(i = H; i >= 1; i--){\n        for(j = W; j >= 1; j--){\n            char temp[71];\n            temp[0] = board[i][j];\n            temp[1] = '\\0';\n            if(isalpha(board[i][j]))\n                continue;\n\n            if(isalpha(board[i][j + 1]) && isalpha(board[i + 1][j])){\n                ans[i][j][0] = board[i][j];\n                ans[i][j][1] = '\\0';\n                //printf(\"ans[%d][%d]: %s\\n\", i, j, ans[i][j]);\n                continue;\n            }\n            if(isdigit(board[i][j + 1]) && isdigit(board[i + 1][j])){\n                if(gt4dp(ans[i][j + 1], ans[i + 1][j])){\n                    strcat(temp, ans[i][j + 1]);\n                }else{\n                    strcat(temp, ans[i + 1][j]);\n                }\n                strcpy(ans[i][j], temp);\n                //printf(\"ans[%d][%d]: %s\\n\", i, j, ans[i][j]);\n                continue;\n            }\n            if(isdigit(board[i][j + 1])){\n                strcat(temp, ans[i][j + 1]);\n                strcpy(ans[i][j], temp);\n            }\n            if(isdigit(board[i + 1][j])){\n                strcat(temp, ans[i + 1][j]);\n                strcpy(ans[i][j], temp);\n            }\n            //printf(\"ans[%d][%d]: %s\\n\", i, j, ans[i][j]);\n        }\n    }\n}"
  },
  {
    "language": "C",
    "code": "#define M 100\nchar m[M][M],s[M][M][M],r[M],*z;\ncmp(char *p,char *q){\n  int r=0;\n  for(;*p=='0';p++);\n  for(;*q=='0';q++);\n  if(r=strlen(p)-strlen(q))return r;\n  return strcmp(p,q);\n}\nmain(w,h,i,j,k,l){\n\tfor(;scanf(\"%d%d\",&w,&h),w;puts(z)){\n\t\tmemset(s,0,sizeof(s));\n\t\tmemset(r,0,sizeof(r));\n\t\tfor(j=1;j<=h;j++)scanf(\"%s\",m[j]+1);\n\t\tfor(i=1;i<=w;i++)\n\t\t\tfor(j=1;j<=h;j++){\n\t\t\t\tif(!isdigit(m[j][i]))continue;\n\t\t\t\tif(cmp(s[j][i-1],s[j-1][i])>0)strcpy(s[j][i],s[j][i-1]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\t\telse strcpy(s[j][i],s[j-1][i]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\t\tif(cmp(s[j][i],r)>0)strcpy(r,s[j][i]);\n\t\t\t}\n\t\tfor(z=r;*z=='0';z++);\n\t}\nreturn 0;}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <ctype.h>\n\nint w,h;\nchar input[70][100];\n\nchar map[71][71][100];\n\nint mystrcmp(const char* a,const char* b) {\n\tint la,lb;\n\tla=strlen(a);\n\tlb=strlen(b);\n\tif(la>lb)return 1;\n\tif(la<lb)return -1;\n\treturn strcmp(a,b);\n}\n\nint main(void) {\n\tint i,j;\n\tint mi,mj;\n\twhile(1) {\n\t\tscanf(\"%d%d\",&w,&h);\n\t\tif(w==0 && h==0)break;\n\t\tfor(i=0;i<h;i++)scanf(\"%s\",input[i]);\n\t\tmemset(map,0,sizeof(map));\n\t\tfor(i=h-1;i>=0;i--) {\n\t\t\tfor(j=w-1;j>=0;j--) {\n\t\t\t\tif(isdigit(input[i][j])) {\n\t\t\t\t\tmap[i][j][0]=input[i][j];\n\t\t\t\t\tmap[i][j][1]=0;\n\t\t\t\t\tif(mystrcmp(map[i+1][j],map[i][j+1])>0) {\n\t\t\t\t\t\tstrcat(map[i][j],map[i+1][j]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstrcat(map[i][j],map[i][j+1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tmi=mj=0;\n\t\tfor(i=0;i<h;i++) {\n\t\t\tfor(j=0;j<w;j++) {\n\t\t\t\tif(isdigit(input[i][j]) && input[i][j]!='0') {\n\t\t\t\t\tif(mystrcmp(map[i][j],map[mi][mj])>0 || input[mi][mj]=='0') {\n\t\t\t\t\t\tmi=i;\n\t\t\t\t\t\tmj=j;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tputs(map[mi][mj]);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#define M 100\nchar m[M][M],s[M][M][M],r[M],*z;\ncmp(char *p,char *q){\n  int r=0;\n  for(;*p=='0';p++);\n  for(;*q=='0';q++);\n  if(r=strlen(p)-strlen(q))return r;\n  return strcmp(p,q);\n}\nmain(w,h,i,j,k,l){\n\tfor(;scanf(\"%d%d\",&w,&h),w;puts(z)){\n\t\tmemset(m,0xff,sizeof(m));\n\t\tmemset(s,0,sizeof(s));\n\t\tmemset(r,0,sizeof(r));\n\t\tfor(j=1;j<=h;j++)scanf(\"%s\",m[j]+1);\n\t\tfor(i=1;i<=w+1;i++)for(j=1;j<=h;j++)if(m[j][i]<'0'||'9'<m[j][i])m[j][i]=-1;\n\t\t//for(k=1;k<M;k++){\n\t\tfor(i=1;i<=w;i++)\n\t\t\t//for(j=i=k;i<=w;i++){\n\t\t\tfor(j=1;j<=h;j++){\n\t\t\t\tif(m[j][i]==-1)continue;\n\t\t\t\tif(cmp(s[j][i-1],s[j-1][i])>0)strcpy(s[j][i],s[j][i-1]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\t\telse strcpy(s[j][i],s[j-1][i]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\t\tif(cmp(s[j][i],r)>0)strcpy(r,s[j][i]);\n    \t\t}\n/*\n\t\t\tfor(j=i=k;j<=h;j++){\n\t\t\t\tif(m[j][i]==-1)continue;\n\t\t\t\tif(cmp(s[j][i-1],s[j-1][i])>0)strcpy(s[j][i],s[j][i-1]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\t\telse strcpy(s[j][i],s[j-1][i]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\t\tif(cmp(s[j][i],r)>0)strcpy(r,s[j][i]);\n\t\t\t}\n*/\n\t\tfor(z=r;*z=='0';z++);\n\t}\nreturn 0;}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <ctype.h>\n#include <stdlib.h>\n\nchar board[71][71];\nchar ans[71][71][71];\nint W, H;\n\nint gt(char *x, char *y);\nchar *solve(int x, int y, int level, char now[]);\nvoid solve_dp(void);\n\nint main(void)\n{\n    while(1){\n        int i, j;\n\n        scanf(\"%d %d\", &W, &H);\n        if(W ==0 && H == 0)\n            break;\n\n        for(i = 0; i < H; i++)\n            scanf(\"%s\", &(board[i + 1][1]));\n\n        for(i = 0; i <= H + 1; i++)\n            board[i][0] = board[i][W + 1] = 'A';\n        for(i = 0; i <= W + 1; i++)\n            board[0][i] = board[H + 1][i] = 'A';\n\n        char max[71];\n        //char now[70];\n        char *temp;\n        max[0] = '1';\n        max[1] = '\\0';\n\n        //for(i = 1; i <= H; i++)\n        //    for(j = 1; j <= W; j++){\n        //        if(isdigit(board[i][j])){\n        //            //printf(\"start from (%d, %d)\\n\", j, i);\n        //            temp = solve(j, i, 0, now);\n        //            if(gt(temp, max)){\n        //                strcpy(max, temp);\n        //            }\n        //            free(temp);\n        //        }\n        //    }\n\n        solve_dp();\n        for(i = 1; i <= H; i++){\n            for(j = 1; j <= W; j++){\n                if(isdigit(board[i][j]) && gt(ans[i][j], max)){\n                    strcpy(max, ans[i][j]);\n                }\n            }\n        }\n\n        temp = max;\n        while(*temp == '0')\n            temp++;\n\n        printf(\"%s\\n\", temp);\n    }\n\n    return 0;\n}\n\nint gt(char *x, char *y)\n{\n    char *px, *py;\n    char *sx, *sy;\n    px = x;\n    py = y;\n    int len_x, len_y;\n    len_x = len_y = 0;\n    while(*px == '0'){\n        px++;\n    }\n    while(*py == '0'){\n        py++;\n    }\n\n    sx = px;\n    sy = py;\n    while(*px != '\\0'){\n        px++;\n        len_x++;\n    }\n    while(*py != '\\0'){\n        py++;\n        len_y++;\n    }\n\n    if(len_x != len_y)\n        return len_x > len_y;\n\n    while(*sx == *sy){\n        sx++;\n        sy++;\n    }\n\n    return (*sx > *sy);\n}\n\nchar *solve(int x, int y, int level, char now[])\n{\n    char *max, *temp;\n    //printf(\"visit (%d, %d)\\n\", x, y);\n    now[level] = board[y][x];\n    if(isalpha(board[y][x + 1]) && isalpha(board[y + 1][x])){\n        temp = malloc(sizeof(char) * level + 2);\n        int i;\n        for(i = 0; i <= level; i++){\n            temp[i] = now[i];\n        }\n        temp[level + 1] = '\\0';\n        //printf(\"number: %s\\n\", temp);\n        return temp;\n    }\n\n    max = malloc(sizeof(char) * 71);\n    max[0] = '1';\n    max[1] = '\\0';\n    if(isdigit(board[y][x + 1])){\n        max = solve(x + 1, y, level + 1, now);\n    }\n    if(isdigit(board[y + 1][x])){\n        temp = solve(x, y + 1, level + 1, now);\n        if(gt(temp, max)){\n            strcpy(max, temp);\n            free(temp);\n        }\n    }\n\n    return max;\n}\n\nvoid solve_dp(void)\n{\n    int i, j;\n\n    for(i = H; i >= 1; i--){\n        for(j = W; j >= 1; j--){\n            char temp[71];\n            temp[0] = board[i][j];\n            temp[1] = '\\0';\n            if(isalpha(board[i][j]))\n                continue;\n\n            if(isalpha(board[i][j + 1]) && isalpha(board[i + 1][j])){\n                ans[i][j][0] = board[i][j];\n                ans[i][j][1] = '\\0';\n                //printf(\"ans[%d][%d]: %s\\n\", i, j, ans[i][j]);\n                continue;\n            }\n            if(isdigit(board[i][j + 1]) && isdigit(board[i + 1][j])){\n                if(gt(ans[i][j + 1], ans[i + 1][j])){\n                    strcat(temp, ans[i][j + 1]);\n                }else{\n                    strcat(temp, ans[i + 1][j]);\n                }\n                strcpy(ans[i][j], temp);\n                //printf(\"ans[%d][%d]: %s\\n\", i, j, ans[i][j]);\n                continue;\n            }\n            if(isdigit(board[i][j + 1])){\n                strcat(temp, ans[i][j + 1]);\n                strcpy(ans[i][j], temp);\n            }\n            if(isdigit(board[i + 1][j])){\n                strcat(temp, ans[i + 1][j]);\n                strcpy(ans[i][j], temp);\n            }\n            //printf(\"ans[%d][%d]: %s\\n\", i, j, ans[i][j]);\n        }\n    }\n}"
  },
  {
    "language": "C",
    "code": "/* \n   AOJ 1126\n   The Secret Number\n\n*/\n\n#include<stdio.h>\n#define WH_MAX 80\ntypedef struct coded_number\n{\n  int len;\n  char s[WH_MAX * WH_MAX];\n}coded_number;\n\nint w, h;\nchar f[WH_MAX][WH_MAX];\ncoded_number memo[WH_MAX][WH_MAX];\n\nvoid copy(coded_number *src, coded_number *dst)\n{\n  int i;\n  dst->len = src->len;\n  for(i = 0; i <= src->len; i++)\n    dst->s[i] = src->s[i];\n\n}\n\nint ok(int x, int y)\n{\n  return (0 <= x && x < w && 0 <= y && y < h && '0' <= f[y][x] && f[y][x] <= '9');\n}\n\nvoid init(coded_number* x)\n{\n  x->len = 0;\n  x->s[0] = '\\0';\n}\n\nint comp(coded_number *x, coded_number *y)\n{\n  int i, x_i, y_i, x_len, y_len;\n\n  for(x_i = 0; x->s[x_i] == '0'; x_i++);\n  for(y_i = 0; y->s[y_i] == '0'; y_i++);\n\n\n  x_len = x->len - x_i;\n  y_len = y->len - y_i;\n\n  if(x_len > y_len)\n    return -1;\n  else if(x_len < y_len)\n    return 1;\n  else\n    for(i = x_i; i < x_len; i++)\n      {\n\tif(x->s[i] > y->s[i])\n\t  return -1;\n\telse if(x->s[i] < y->s[i])\n\t  return 1;\n      }\n  return 0;\n}\n\n\nvoid add_char(coded_number* dst, char c)\n{\n  int i, j;\n  for(i = dst->len, j = dst->len + 1; i >= 0; i--, j--)\n    dst->s[j] = dst->s[i];\n  dst->s[0] = c;\n  dst->len++;\n}\n\n/* \n\n7 4\n9R2A993\n0E314A0\n8A900DE\n820R037\n */\n\n\n\ncoded_number* search(int x, int y)\n{\n  coded_number right, below, ret;\n  int comp_ret;\n  init(&ret);\n  if(memo[y][x].len > 0)\n    return &memo[y][x];\n\n  else if(ok(x, y))\n    {\n      copy(search(x + 1, y), &right);\n      copy(search(x, y + 1), &below);\n      if(comp(&right, &below) < 0)\n\tcopy(&right, &ret);\n      else\n\tcopy(&below, &ret);\n      add_char(&ret, f[y][x]);\n      copy(&ret, &memo[y][x]);\n      return &memo[y][x];\n   }\n  return &ret;\n}\n\nint main(void)\n{\n  int i, j;\n  coded_number ret;\n\n\n  while(scanf(\"%d %d\", &w, &h), (w && h))\n    {\n\n      for(i = 0; i < h; i++)\n\tscanf(\"%s\", f[i]);\n\n      for(i = 0; i < WH_MAX; i++)\n\tfor(j = 0; j < WH_MAX; j++)\n\t  init(&memo[j][i]);\n      init(&ret);\n\n\n\n      for(i = 0; i < h; i++)\n\tfor(j = 0; j < w; j++)\n\t  search(j, i);\n      \n      for(i = 0; i < h; i++)\n\tfor(j = 0; j < w; j++)\n\t  if(comp(&ret, &memo[j][i]) > 0)\n\t    copy(&memo[j][i], &ret);\n\n      printf(\"%s\\n\", ret.s);\n    }\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "/*\nAizuOnline A1126\nTitle The Secret Number\n*/\n#include <stdio.h>\n#include <string.h>\n//Global data section\nchar biggest[71];\nint  biggest_len;\nchar current[71];\nint  current_len;\nchar ban[70][71];\nint H,W;\n//\nregist_biggest()\n{\n        char*p;\n        p=&current[0];\n        while(*p=='0' && current_len >1)  // left zero surpress\n        {\n                p++;\n                current_len--;\n        }\n        //print_number(p,current_len);\n        if(current_len > biggest_len ||\n           ((current_len == biggest_len)\n            && (0<strncmp(p,biggest,current_len))))\n        {\n                biggest_len=current_len;\n                strncpy(biggest,p,current_len);\n        }\n}\n\n\nint findtopleft(int * y,int * x)\n{\n        int i,j;\n\n        i=*y;j=*x;\n        goto AAA;\n\n        for(i=0;i<H;i++)\n                for(j=0;j<W;j++)\n                {\n                AAA:\n                        if((i==0 ||!isdigit(ban[i-1][j]))&&\n                           (j==0 ||!isdigit(ban[i][j-1]))&&\n                           isdigit(ban[i][j]))\n                        {\n                                *y=i;\n                                *x=j;\n                                return(-1);\n                        }\n                }\n        return(0);\n}\nvoid print_number(char * s,int len)\n{\n        int i;\n        for(i=0;i<len;i++)\n                printf(\"%c\",s[i]);\n        //printf(\"(%d)\",len);\n        printf(\"\\n\");\n}\nvoid connect_number(int y,int x,int d)\n{\n        current[d]=ban[y][x];\n        current_len=d+1;\n        if(((x==W-1)||(!isdigit(ban[y][x+1]))) &&\n           ((y==H-1)||(!isdigit(ban[y+1][x]))))\n        {\n                //print_number(current,current_len);\n                regist_biggest();\n                return;\n        }\n        if(x<W-1 && isdigit(ban[y][x+1]))\n                connect_number(y,x+1,d+1);\n        if(y<H-1 && isdigit(ban[y+1][x]))\n                connect_number(y+1,x,d+1);\n}\nvoid find_biggest_secret()\n{\n        int y,x;\n\n        x=y=0;\n        while(findtopleft(&y,&x))\n        {\n                //printf(\"%d %d\\n\",y,x);\n\n                current_len=0;\n                connect_number(y,x,0);\n                \n\n                x++;\n                if(x>=W)\n                        y++;\n                if(y>=H)\n                        break;\n       }\n}\nmain()\n{\n        int i;\n\n        while(EOF!=scanf(\"%d %d\",&W,&H) && (W||H))\n        {\n                for(i=0;i<H;i++)\n                        scanf(\"%s\",&ban[i][0]);\n                \n                biggest_len=0;\n                find_biggest_secret();\n                \n                print_number(biggest,biggest_len);\n                        \n        }\nreturn(0);\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\n\nint W,H,i,j;\nchar dp[71][71][71],g[2],tmp[71],res[71];\n\nint cmp(char x[],char y[])\n{\n\tint s=strlen(x),t=strlen(y);\n\treturn s<t||(s==t&&strcmp(x,y)<0)?1:0;\n}\n\nint main()\n{\n\tfor(;scanf(\"%d%d\\n\",&W,&H),W;)\n\t{\n\t\tmemset(dp,0,sizeof(dp));\n\t\tmemset(res,0,sizeof(res));\n\t\tfor(i=0;i<H;i++,getchar())\n\t\t\tfor(j=0;j<W;j++)\n\t\t\t{\n\t\t\t\ttmp[0]=0;\n\t\t\t\tg[0]=getchar();\n\t\t\t\tif(g[0]<58)\n\t\t\t\t{\n\t\t\t\t\tif(i>0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(cmp(tmp,dp[i-1][j]))\n\t\t\t\t\t\t\tstrcpy(tmp,dp[i-1][j]);\n\t\t\t\t\t}\n\t\t\t\t\tif(j>0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(cmp(tmp,dp[i][j-1]))\n\t\t\t\t\t\t\tstrcpy(tmp,dp[i][j-1]);\n\t\t\t\t\t}\n\t\t\t\t\tsprintf(dp[i][j],\"%s\",strcat(tmp,g));\n\t\t\t\t}\n\t\t\t\tif(cmp(res,dp[i][j]))\n\t\t\t\t\tstrcpy(res,dp[i][j]);\n\t\t\t}\n\t\twhile(res[1]!=0&&res[0]=='0')\n\t\t\tmemmove(res,res+1,strlen(res));\n\t\tputs(res);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <ctype.h>\n\ntypedef struct str {\n    int len;\n    char s[80];\n} str;\n\nint comp(str* a, str* b)\n{\n    if (a->len<b->len) return -1;\n    if (a->len>b->len) return 1;\n    return strcmp(a->s, b->s);\n}\n    \nvoid init(str* a) { a->len=0; memset(a->s, 0, sizeof(a->s)); }\nvoid copy(str* a, str* b)\n{\n    a->len=b->len;\n    memcpy(a->s, b->s, sizeof(a->s));\n}\nvoid add(int x, str* a)\n{\n    int i=a->len;\n    for(i=a->len;i>0;--i) a->s[i]=a->s[i-1];\n    a->s[0]=x;\n    (a->len)++;\n}\n\nint c[80][80], w, h;\nstr memo[80][80];\n\nstr* func(int i, int j)\n{\n    str res;\n    if (memo[i][j].len>0) return &memo[i][j];\n\n    init(&res);\n    if (i+1<h && c[i+1][j]>=0) {\n        str t;\n        copy(&t, func(i+1, j));\n        if (comp(&res, &t)<0) copy(&res, &t);\n    }\n    if (j+1<w && c[i][j+1]>=0) {\n        str t;\n        copy(&t, func(i, j+1));\n        if (comp(&res, &t)<0) copy(&res, &t);\n    }\n    add(c[i][j], &res);\n    copy(&memo[i][j], &res);\n    return &memo[i][j];\n}\n\nint main(void)\n{\n    while (scanf(\"%d%d\", &w, &h), w) {\n        int i, j;\n        str res;\n        memset(c, -1, sizeof(c));\n        for(i=0;i<h;++i) {\n            char s[80];\n            scanf(\"%s\", s);\n            for(j=0;j<w;++j) if (isdigit(s[j])) c[i][j]=s[j];\n        }\n\n        for(i=0;i<h;++i) for(j=0;j<w;++j) init(&memo[i][j]);\n        for(i=0;i<h;++i) for(j=0;j<w;++j)\n            if (c[i][j]>'0' && !memo[i][j].len) func(i, j);\n\n        init(&res);\n        for(i=0;i<h;++i) for(j=0;j<w;++j)\n            if (comp(&res, &memo[i][j])<0) copy(&res, &memo[i][j]);\n\n        puts(res.s);\n    }\n    return 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n\nchar max[72];\nchar matrix[72][72];\nchar num[72][72][72];\n\nint large(char *num1, char *num2)\n{\n\tif (strlen(num1) < strlen(num2)){\n\t\treturn (-1);\n\t}\n\tif (strlen(num1) == strlen(num2)){\n\t\treturn (strcmp(num1, num2));\n\t}\n\n\treturn (1);\n}\n\nint main(void)\n{\n\tint W, H, C;\n\tint i, j;\n\tint x, y;\n\tchar c, c1, c2;\n\t\n\t\n\twhile (1){\n\t\tscanf(\"%d%d\", &W, &H);\n\t\tif (W == 0 && H == 0){\n\t\t\tbreak;\n\t\t}\n\t\t\n\t\tmemset(matrix, 0, sizeof(matrix));\n\t\tfor (y = 1; y <= H; y++){\n\t\t\tscanf(\"%s\", &matrix[y][1]);\n\t\t}\n\t\t\n\n\t\tmemset(num, 0, sizeof(num));\n\t\tmax[0] = '\\0';\n\t\tfor (y = 1; y <= H; y++){\n\t\t\tfor (x = 1; x <= W; x++){\n\t\t\t\tc = matrix[y][x];\n\t\t\t\tif ('0' <= c && c <= '9'){\n\t\t\t\t\tif (large(num[y - 1][x], num[y][x - 1]) > 0){\n\t\t\t\t\t\tstrcpy(num[y][x], num[y - 1][x]);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tstrcpy(num[y][x], num[y][x - 1]);\n\t\t\t\t\t}\n\t\t\t\t\tif (num[y][x][0] != '\\0' || c != '0'){\n\t\t\t\t\t\tnum[y][x][strlen(num[y][x])] = c;\n\t\t\t\t\t\tnum[y][x][strlen(num[y][x]) + 1] = '\\0';\n\t\t\t\t\t}\n//printf(\"[%s]\", num[y][x]);\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\tif (large(max, num[y][x]) < 0){\n\t\t\t\t\t\tstrcpy(max, num[y][x]);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n//\t\t\t\telse{\n//printf(\"[*]\");\n//\t\t\t\t}\n\t\t\t}\n//printf(\"\\n\");\n\n\t\t}\n\t\tfor (x = 0; max[x] == '0'; x++);\n\t\tprintf(\"%s\\n\", &max[x]);\n\t}\n\t\n\treturn (0);\n}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\nint f(char a[75],char b[75]){\n  int la=strlen(a),lb=strlen(b);\n  if(la>lb)return 1;\n  if(la<lb)return -1;\n  return strcmp(a,b);\n}\nint main(){\n  int w,h,i,j;\n  char s[75][75][2]={0};\n  while(scanf(\"%d %d\",&w,&h),w||h){\n    char d[75][75][75]={0};\n    char max[75]={0}; \n    for(i=1;i<=h;i++){\n      for(j=1;j<=w;j++)scanf(\" %c\",&s[i][j][0]);\n    }\n    for(i=1;i<=h;i++){\n      for(j=1;j<=w;j++){\n\tif(f(d[i-1][j],d[i][j-1])<0)strcpy(d[i][j],d[i][j-1]);\n\telse                        strcpy(d[i][j],d[i-1][j]);\n\tstrcat(d[i][j],s[i][j]);\n\tif('A'<=s[i][j][0]&&s[i][j][0]<='Z'||d[i][j][0]=='0')d[i][j][0]=0;\n\tif(f(max,d[i][j])<0)strcpy(max,d[i][j]);\n      }\n    }\n    printf(\"%s\\n\",max);\n  }\n  return 0;\n}"
  },
  {
    "language": "C",
    "code": "#define M 100\nchar m[M][M],s[M][M][M],r[M],*z;\ncmp(char *p,char *q){\n  int r=0;\n  for(;*p=='0';p++);\n  for(;*q=='0';q++);\n  if(r=strlen(p)-strlen(q))return r;\n  return strcmp(p,q);\n}\nmain(w,h,i,j,k,l){\n\tfor(;scanf(\"%d%d\",&w,&h),w;puts(z)){\n\t\tmemset(m,0xff,sizeof(m));\n\t\tmemset(s,0,sizeof(s));\n\t\tmemset(r,0,sizeof(r));\n\t\tfor(j=1;j<=h;j++)scanf(\"%s\",m[j]+1);\n\t\tfor(i=1;i<=w;i++)\n\t\t\tfor(j=1;j<=h;j++){\n\t\t\t\tif(!isdigit(m[j][i]))continue;\n\t\t\t\tif(cmp(s[j][i-1],s[j-1][i])>0)strcpy(s[j][i],s[j][i-1]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\t\telse strcpy(s[j][i],s[j-1][i]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\t\tif(cmp(s[j][i],r)>0)strcpy(r,s[j][i]);\n\t\t\t}\n\t\tfor(z=r;*z=='0';z++);\n\t}\nreturn 0;}"
  },
  {
    "language": "C",
    "code": "#define M 100\nchar m[M][M],s[M][M][M],r[M],*z;\ncmp(char *p,char *q){int r=0;\n\tfor(;*p=='0';p++);for(;*q=='0';q++);\n\tif(r=strlen(p)-strlen(q))return (r=strlen(p)-strlen(q))?r:strcmp(p,q);\n}\nmain(w,h,i,j,k,l){\n\tfor(;scanf(\"%d%d\",&w,&h),w;puts(z)){\n\t\tfor(memset(s,0,sizeof(s)),memset(r,0,sizeof(r)),j=1;j<=h;j++)scanf(\"%s\",m[j]+1);\n\t\tfor(i=1;i<=w;i++)for(j=1;j<=h;j++){\n\t\t\tif(!isdigit(m[j][i]))continue;\n\t\t\tif(cmp(s[j][i-1],s[j-1][i])>0)strcpy(s[j][i],s[j][i-1]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\telse strcpy(s[j][i],s[j-1][i]),s[j][i][strlen(s[j][i])]=m[j][i];\n\t\t\tif(cmp(s[j][i],r)>0)strcpy(r,s[j][i]);\n\t\t}\n\t\tfor(z=r;*z=='0';z++);\n\t}\nreturn 0;}"
  },
  {
    "language": "C",
    "code": "#include<stdio.h>\n#include<string.h>\n\nint W,H,i,j;\nchar dp[71][71][71],g[2],tmp[71],res[71];\n\nint cmp(char x[],char y[])\n{\n\tint s=strlen(x),t=strlen(y);\n\treturn s<t||(s==t&&strcmp(x,y)<0)?1:0;\n}\n\nint main()\n{\n\tfor(;scanf(\"%d%d\\n\",&W,&H),W;)\n\t{\n\t\tmemset(dp,0,sizeof(dp));\n\t\tmemset(res,0,sizeof(res));\n\t\tfor(i=0;i<H;i++,getchar())\n\t\t\tfor(j=0;j<W;j++)\n\t\t\t{\n\t\t\t\ttmp[0]=0;\n\t\t\t\tg[0]=getchar();\n\t\t\t\tif(g[0]<58)\n\t\t\t\t{\n\t\t\t\t\tif(i>0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(cmp(tmp,dp[i-1][j]))\n\t\t\t\t\t\t\tstrcpy(tmp,dp[i-1][j]);\n\t\t\t\t\t}\n\t\t\t\t\tif(j>0)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(cmp(tmp,dp[i][j-1]))\n\t\t\t\t\t\t\tstrcpy(tmp,dp[i][j-1]);\n\t\t\t\t\t}\n\t\t\t\t\tsprintf(dp[i][j],\"%s\",strcat(tmp,g));\n\t\t\t\t}\n\t\t\t\tif(cmp(res,dp[i][j]))\n\t\t\t\t\tstrcpy(res,dp[i][j]);\n\t\t\t}\n\t\twhile(res[0]=='0')\n\t\t\tmemmove(res,res+1,strlen(res));\n\t\tputs(res);\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C",
    "code": "#include <stdio.h>\n#include <string.h>\n#include <ctype.h>\n#include <stdlib.h>\n\nchar board[71][71];\nchar ans[71][71][71];\nint W, H;\n\nint gt(char *x, char *y);\nint gt4dp(char *x, char *y);\nchar *solve(int x, int y, int level, char now[]);\nvoid solve_dp(void);\n\nint main(void)\n{\n    while(1){\n        int i, j;\n\n        scanf(\"%d %d\", &W, &H);\n        if(W ==0 && H == 0)\n            break;\n\n        for(i = 0; i < H; i++)\n            scanf(\"%s\", &(board[i + 1][1]));\n\n        for(i = 0; i <= H + 1; i++)\n            board[i][0] = board[i][W + 1] = 'A';\n        for(i = 0; i <= W + 1; i++)\n            board[0][i] = board[H + 1][i] = 'A';\n\n        char max[71];\n        char *temp;\n        max[0] = '1';\n        max[1] = '\\0';\n\n\n        solve_dp();\n        for(i = 1; i <= H; i++){\n            for(j = 1; j <= W; j++){\n                if(isdigit(board[i][j]) && gt(ans[i][j], max)){\n                    strcpy(max, ans[i][j]);\n                }\n            }\n        }\n\n        temp = max;\n        while(*temp == '0')\n            temp++;\n\n        printf(\"%s\\n\", temp);\n\n    }\n\n    return 0;\n}\n\nint gt4dp(char *x, char *y)\n{\n    int len_x, len_y;\n    char *px, *py;\n    px = x;\n    py = y;\n    len_x = len_y = 0;\n    while(*px != '\\0'){\n        len_x++;\n        px++;\n    }\n    while(*py != '\\0'){\n        len_y++;\n        py++;\n    }\n    if(len_x != len_y)\n        return len_x > len_y;\n    while(*x == *y){\n        x++;\n        y++;\n    }\n\n    return *x > *y;\n}\n\nint gt(char *x, char *y)\n{\n    char *px, *py;\n    char *sx, *sy;\n    px = x;\n    py = y;\n    int len_x, len_y;\n    len_x = len_y = 0;\n    while(*px == '0'){\n        px++;\n    }\n    while(*py == '0'){\n        py++;\n    }\n\n    sx = px;\n    sy = py;\n    while(*px != '\\0'){\n        px++;\n        len_x++;\n    }\n    while(*py != '\\0'){\n        py++;\n        len_y++;\n    }\n\n    if(len_x != len_y)\n        return len_x > len_y;\n\n    while(*sx == *sy){\n        sx++;\n        sy++;\n    }\n\n    return (*sx > *sy);\n}\n\nvoid solve_dp(void)\n{\n    int i, j;\n\n    for(i = H; i >= 1; i--){\n        for(j = W; j >= 1; j--){\n            char temp[71];\n            temp[0] = board[i][j];\n            temp[1] = '\\0';\n            if(isalpha(board[i][j]))\n                continue;\n\n            if(isalpha(board[i][j + 1]) && isalpha(board[i + 1][j])){\n                ans[i][j][0] = board[i][j];\n                ans[i][j][1] = '\\0';\n                continue;\n            }\n            if(isdigit(board[i][j + 1]) && isdigit(board[i + 1][j])){\n                if(gt4dp(ans[i][j + 1], ans[i + 1][j])){\n                    strcat(temp, ans[i][j + 1]);\n                }else{\n                    strcat(temp, ans[i + 1][j]);\n                }\n                strcpy(ans[i][j], temp);\n                continue;\n            }\n            if(isdigit(board[i][j + 1])){\n                strcat(temp, ans[i][j + 1]);\n                strcpy(ans[i][j], temp);\n            }\n            if(isdigit(board[i + 1][j])){\n                strcat(temp, ans[i + 1][j]);\n                strcpy(ans[i][j], temp);\n            }\n        }\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.*;\n\n\npublic class Main {\n\tstatic ArrayList<String> cand = new ArrayList<String>();\n\tpublic static void main(String[] args) {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));       \n\t\ttry {\n\t\t\tString line;\n\t\t\twhile(true){\n\t\t\t\t/* input */\n\t\t\t\tcand = new ArrayList<String>();\n\t\t\t\tline = br.readLine();\n\n\t\t\t\tint w = Integer.parseInt(line.split(\" \")[0]);\n\t\t\t\tint h = Integer.parseInt(line.split(\" \")[1]);\n\t\t\t\tif(w == 0 && h == 0){\n\t\t\t\t\treturn;\n\t\t\t\t} \n\n\t\t\t\tchar[][] field = new char[h][w];\n\t\t\t\tfor(int i=0;i<h;i++){\n\t\t\t\t\tline = br.readLine();\n\t\t\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\t\t\tfield[i][j] = line.charAt(j);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t/*\n\t\t\t\tfor(int i=0;i<h;i++){\n\t\t\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\t\t\tSystem.out.print(field[i][j]);\n\t\t\t\t\t}\n\t\t\t\t\tSystem.out.println();\n\t\t\t\t}\n\t\t\t\t */\n\t\t\t\t/* processing */\n\t\t\t\tfor(int i=0;i<h;i++){\n\t\t\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\t\t\tif(Character.isDigit(field[i][j])&&(field[i][j]!='0')){\n\t\t\t\t\t\t\t\tsearch(i,j,field,h,w,\"\"+field[i][j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/* output */\n\t\t\t\tCollections.sort(cand);\n\t\t\t\tint maxlength = 0;\n\t\t\t\tString maxs = \"\";\n\t\t\t\tfor(String s: cand){\n\t\t\t\t\tif (s.length()>maxlength){\n\t\t\t\t\t\tmaxlength = s.length();\n\t\t\t\t\t\tmaxs = s;\n\t\t\t\t\t} else if(s.length()==maxlength){\n\t\t\t\t\t\tfor(int i=0;i<s.length();i++){\n\t\t\t\t\t\t\tif(s.charAt(i)>maxs.charAt(i)){\n\t\t\t\t\t\t\t\tmaxs = s;\n\t\t\t\t\t\t\t} else if(s.charAt(i)>maxs.charAt(i)){\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//System.out.println();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tSystem.out.println(maxs);\n\t\t\t}\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\n\tpublic static void search(int i,int j,char[][] field,int h,int w, String s){\n\t\tif(j<w-1){\n\t\t\tif(Character.isDigit(field[i][j+1])){\n\t\t\t\tcand.add(s + field[i][j+1]);\n\t\t\t\tsearch(i,j+1,field,h,w,s + field[i][j+1]);\n\t\t\t}\n\t\t}\n\n\t\tif(i<h-1){\n\t\t\tif(Character.isDigit(field[i+1][j])){\n\t\t\t\tcand.add(s + field[i+1][j]);\n\t\t\t\tsearch(i+1,j,field,h,w,s + field[i+1][j]);\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.util.regex.*;\n\nimport static java.lang.Math.*;\nimport static java.lang.System.out;\n\n// AOJ\npublic class Main {\n\tfinal Scanner sc=new Scanner(System.in);\n\tpublic static void main(String[] args) {\n\t\tnew Main().AOJ1126();\n\t}\n\tstatic class Point{\n\t\tint x, y;\n\t\tPoint(int x, int y){\tthis.x=x;\tthis.y=y;}\n\t\tPoint(){\tthis.x=0; this.y=0;}\n\t\t@Override public String toString(){\treturn \"(\"+this.x+\",\"+this.y+\")\";}\n\t\tstatic boolean ok(int x,int y,int X,int Y,int min){\n\t\t\treturn (min<=x&&x<X && min<=y&&y<Y)?true:false;\n\t\t}\n\t\tstatic boolean ok(int x,int y,int X,int Y){\treturn ok(x,y,X,Y,0);}\n\t}\n\tfinal int[] vx={0,1,0,-1}, vy={-1,0,1,0};\n\t\n\tint step=0;\n\tvoid AOJ1126(){\n\t\twhile(sc.hasNext()){\n\t\t\tint W=sc.nextInt(), H=sc.nextInt();\n\t\t\tif((W|H)==0)\tbreak;\n\t\t\tchar[][] c=new char[W][H];\n\t\t\tfor(int y=0; y<H; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<W; x++)\tc[x][y]=line.charAt(x);\n\t\t\t}\n\t\t\tString ans=\"\";\n\t\t\tfor(int x=0; x<W; x++){\n\t\t\t\tfor(int y=0; y<H; y++){\n\t\t\t\t\tif(Character.isDigit(c[x][y])){\n\t\t\t\t\t\tif(x>0)\tif(Character.isDigit(c[x-1][y]) && c[x-1][y]!='0')\tcontinue;\n\t\t\t\t\t\tif(y>0)\tif(Character.isDigit(c[x][y-1]) && c[x][y-1]!='0')\tcontinue;\n\t\t\t\t\t\tif(c[x][y]=='0')\tcontinue;\n\t\t\t\t\t\tString temp=solve1126(x,y,\"\"+c[x][y],c,W,H);\n\t\t\t\t\t\tans=compara1126(temp,ans)?temp:ans;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t\tout.println(step+\"steps\");\n\t}\n\tString solve1126(int x,int y,String ans,char[][] c,int W,int H){\n\t\tString r=ans;\n\t\t//TODO debug\n\t\t//step++;\n\t\t//out.println(ans);\n\t\tfor(int i=1; i<3; i++){\n\t\t\tint xx=x+vx[i], yy=y+vy[i];\n\t\t\tif(!Point.ok(xx,yy,W,H))\tcontinue;\n\t\t\tif(Character.isDigit(c[xx][yy])){\n\t\t\t\tString temp=solve1126(xx,yy,ans+c[xx][yy],c,W,H);\n\t\t\t\tr=compara1126(r,temp)?r:temp;\n\t\t\t}\n\t\t}\n\t\treturn r;\n\t}\n\t// 第一引数aの方が大きい時のみtrue\n\tboolean compara1126(String a,String b){\n\t\tif(a.length()>b.length())\treturn true;\n\t\tif(a.length()==b.length()){\n\t\t\tfor(int i=0; i<a.length(); i++){\n\t\t\t\tif(a.charAt(i)>b.charAt(i))\treturn true;\n\t\t\t\tif(a.charAt(i)<b.charAt(i))\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tvoid OldAOJ1126(){\n\t\tint step=0;\n\t\twhile(sc.hasNext()){\n\t\t\tint W=sc.nextInt(), H=sc.nextInt();\n\t\t\tString ans=\"\";\n\t\t\tif((W|H)==0)\tbreak;\n\t\t\tchar[][] c=new char[W][H];\n\t\t\tString[][] close=new String[W][H];\n\t\t\tLinkedList<C1126> open=new LinkedList<C1126>();\n\t\t\tfor(int y=0; y<H; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<W; x++){\n\t\t\t\t\tc[x][y]=line.charAt(x);\n\t\t\t\t\tif(Character.isDigit(line.charAt(x))){\n\t\t\t\t\t\tif(x>0)\tif(Character.isDigit(c[x-1][y]))\tcontinue;\n\t\t\t\t\t\tif(y>0)\tif(Character.isDigit(c[x][y-1]))\tcontinue;\n\t\t\t\t\t\topen.add(new C1126(x,y,\"\"+c[x][y]));\n\t\t\t\t\t\tclose[x][y]=\"\"+c[x][y];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tC1126 now=open.poll();\n\t\t\t\t// TODO debug\n\t\t\t\tout.println(\"ANS\"+ans+\" NOW\"+now.ans);\n\t\t\t\tans=now.compara(ans)?new String(now.ans):ans;\n\t\t\t\tfor(int i=1; i<3; i++){\n\t\t\t\t\tint xx=now.x+vx[i], yy=now.y+vy[i];\n\t\t\t\t\tif(!Point.ok(xx,yy,W,H))\tcontinue;\n\t\t\t\t\tif(Character.isDigit(c[xx][yy])){\n\t\t\t\t\t\tC1126 temp=new C1126(xx,yy,now.ans+c[xx][yy]);\n\t\t\t\t\t\tif(close[xx][yy]==null){\n\t\t\t\t\t\t\topen.add(temp);\n\t\t\t\t\t\t\tclose[xx][yy]=temp.ans;\n\t\t\t\t\t\t\tstep++;\n\t\t\t\t\t\t}else if(temp.compara(close[xx][yy])){\n\t\t\t\t\t\t\topen.add(temp);\n\t\t\t\t\t\t\tclose[xx][yy]=temp.ans;\n\t\t\t\t\t\t\tstep++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t\tout.println(step+\"step\");\n\t}\n\tclass C1126{\n\t\tint x,y;\tString ans;\n\t\tC1126(int x,int y,String ans){\n\t\t\tthis.x=x;\tthis.y=y;\n\t\t\tif(ans.length()>0){\n\t\t\t\tint i=0;\n\t\t\t\twhile(ans.charAt(i)=='0'){\n\t\t\t\t\tif(++i>=ans.length()-1)\tbreak;\n\t\t\t\t\tans=ans.substring(i);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.ans=ans;\n\t\t}\n\t\tboolean compara(String ans){\n\t\t\tif(this.ans.length()>ans.length())\treturn true;\n\t\t\tif(this.ans.length()==ans.length()){\n\t\t\t\tfor(int i=0; i<ans.length(); i++){\n\t\t\t\t\tif(ans.charAt(i)<this.ans.charAt(i))\treturn true;\n\t\t\t\t\tif(ans.charAt(i)>this.ans.charAt(i))\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\tvoid AOJ0165(){\n\t\tfinal int MAX=1000000;\n\t\tboolean[] prime=Sieve(MAX);\n\t\t// 素数の個数の累積和を作る\n\t\twhile(sc.hasNext()){\n\t\t\tint N=sc.nextInt();\n\t\t\tif(N==0)\tbreak;\n\t\t\tint ans=0;\n\t\t\tfor(int i=1; i<=N; i++){\n\t\t\t\tint p=sc.nextInt(), m=sc.nextInt();\n\t\t\t\tint min=max(0,p-m), max=min(MAX, p+m);\n\t\t\t\tint temp=(min<=2?1:0);\n\t\t\t\tfor(int j=(min%2==0?min+1:min); j<=max; j+=2){\n\t\t\t\t\tif(prime[j])\ttemp++;\n\t\t\t\t}\n\t\t\t\t//out.println(\"TEMP\"+temp);\n\t\t\t\tans+=(temp==0?-1:temp-1);\n\t\t\t}\n\t\t\tout.println(max(0,ans));\n\t\t}\n\t}\n\t\n\tvoid AOJ1144(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(), Y=sc.nextInt();\n\t\t\tif((X|Y)==0)\tbreak;\n\t\t\tchar[][] c=new char[X][Y];\n\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\t\tc[x][y]=line.charAt(x);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\n\t// TODO 果樹園　RE　横型\n\tvoid AOJ0118(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(), Y=sc.nextInt(), ans=0;\n\t\t\tif((X|Y)==0)\tbreak;\n\t\t\tchar[][] c=new char[X+10][Y+10];\n\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\t\tc[x][y]=line.charAt(x);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\t\tif(c[x][y]=='&')\tcontinue;\n\t\t\t\t\tans++;\n\t\t\t\t\tLinkedList<Point> open=new LinkedList<Point>();\n\t\t\t\t\topen.add(new Point(x,y));\n\t\t\t\t\tchar mark=c[x][y];\n\t\t\t\t\twhile(!open.isEmpty()){\n\t\t\t\t\t\tPoint now=open.poll();\n\t\t\t\t\t\tc[now.x][now.y]='&';\n\t\t\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\t\t\tif(now.x+vx[i]<0 || now.x+vx[i]>=X || now.y+vy[i]<0 || now.y+vy[i]>=Y)\tcontinue;\n\t\t\t\t\t\t\tif(c[now.x+vx[i]][now.y+vy[i]]==mark){\n\t\t\t\t\t\t\t\t//out.println((now.x+vx[i])+\" \"+(now.y+vy[i]));\n\t\t\t\t\t\t\t\topen.add(new Point(now.x+vx[i],now.y+vy[i]));\n\t\t\t\t\t\t\t\tc[now.x+vx[i]][now.y+vy[i]]='&';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//out.println(\"ANS\"+ans);\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t}\n\t\n\t// Red and Black 横型探索\n\tvoid AOJ1130(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(), Y=sc.nextInt(),sx=0,sy=0,ans=0;\n\t\t\tif(X==0)\tbreak;\n\t\t\tchar[][] c=new char[X][Y];\n\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\tchar[] line=sc.next().toCharArray();\n\t\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\t\tc[x][y]=line[x];\n\t\t\t\t\tif(line[x]=='@'){\n\t\t\t\t\t\tsx=x;\tsy=y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tLinkedList<Point> open=new LinkedList<Point>();\n\t\t\topen.add(new Point(sx,sy));\n\t\t\tboolean[][] close=new boolean[X][Y];\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tans++;\n\t\t\t\tPoint now=open.poll();\n\t\t\t\tclose[now.x][now.y]=true;\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(now.x+vx[i]<0 || now.x+vx[i]>=X || now.y+vy[i]<0 || now.y+vy[i]>=Y)\tcontinue;\n\t\t\t\t\tif(c[now.x+vx[i]][now.y+vy[i]]=='.' && !close[now.x+vx[i]][now.y+vy[i]]){\n\t\t\t\t\t\topen.add(new Point(now.x+vx[i], now.y+vy[i]));\n\t\t\t\t\t\tclose[now.x+vx[i]][now.y+vy[i]]=true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t}\n\t\n\t// TODO デパート　TLE MLE WA\n\tvoid AOJ0223(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(),\tY=sc.nextInt();\n\t\t\tif(X==0)\tbreak;\n\t\t\tint tx=sc.nextInt(), ty=sc.nextInt(), kx=sc.nextInt(), ky=sc.nextInt();\n\t\t\tint[][] b=new int[X+1][Y+1];\n\t\t\tfor(int y=1; y<=Y; y++){\n\t\t\t\tfor(int x=1; x<=X; x++)\tb[x][y]=sc.nextInt();\n\t\t\t}\n\t\t\tLinkedList<C0223> open=new LinkedList<C0223>();\n\t\t\topen.add(new C0223(tx,ty,kx,ky,0));\n\t\t\tint[][][][] close2=new int[X+1][Y+1][X+1][Y+1];\n\t\t\tclose2[tx][ty][kx][ky]=-1;\n\t\t\tint ans=-1;\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tC0223 now=open.poll();\n\t\t\t\tif(now.ans()){\n\t\t\t\t\tans=now.sec;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(now.sec>=99)\tbreak;\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(0<now.tx+vx[i]&&now.tx+vx[i]<=X && 0<now.ty+vy[i]&&now.ty+vy[i]<=Y && 0<now.kx-vx[i]&&now.kx-vx[i]<=X && 0<now.ky-vy[i]&&now.ky-vy[i]<=Y){\n\t\t\t\t\t\ttx=now.tx;\tty=now.ty;\tkx=now.kx;\tky=now.ky;\n\t\t\t\t\t\tif(b[tx+vx[i]][ty+vy[i]]==0){\n\t\t\t\t\t\t\ttx+=vx[i];\tty+=vy[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(b[kx-vx[i]][ky-vy[i]]==0){\n\t\t\t\t\t\t\tkx-=vx[i];\tky-=vy[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//out.println(\"TEMP:\"+tx+\" \"+ty+\" \"+kx+\" \"+ky);\n\t\t\t\t\t\t//if(tx==kx && ty==ky)\tans=ans<0?now.sec+1:min(ans,now.sec+1);\n\t\t\t\t\t\tif(close2[tx][ty][kx][ky]==0 || close2[tx][ty][kx][ky]>now.sec+1){\n\t\t\t\t\t\t\t//out.println(\"ADD:\"+tx+\" \"+ty+\" \"+kx+\" \"+ky);\n\t\t\t\t\t\t\topen.add(new C0223(tx,ty,kx,ky,now.sec+1));\n\t\t\t\t\t\t\tclose2[tx][ty][kx][ky]=now.sec+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans<0? \"NA\": ans);\n\t\t}\n\t}\n\tclass C0223{\n\t\tint tx,ty,kx,ky,sec;\n\t\tC0223(int tx, int ty, int kx, int ky, int sec){\n\t\t\tthis.tx=tx;\tthis.ty=ty;\tthis.kx=kx;\tthis.ky=ky;\tthis.sec=sec;\n\t\t}\n\t\tboolean ans(){\n\t\t\tif(this.tx==this.kx && this.ty==this.ky)\treturn true;\n\t\t\telse\treturn false;\n\t\t}\n\t}\n\t\n\t\n\t// TODO WA\n\tvoid AOJ0142(){\n\t\twhile(sc.hasNext()){\n\t\t\tint n=sc.nextInt();\n\t\t\tif(n==0)\tbreak;\n\t\t\tint nn=(n-1)/2;\n\t\t\tboolean[] b=new boolean[n];\n\t\t\tfor(int i=1; i<n; i++)\tb[(i*i)%n]=true;\n\t\t\tArrayList<Integer> ar=new ArrayList<Integer>();\n\t\t\tfor(int i=1; i<n; i++){\n\t\t\t\tif(b[i])\tar.add(i);\n\t\t\t}\n\t\t\tint[] ans=new int[nn+1];\n\t\t\tfor(int i=0; i<ar.size(); i++){\n\t\t\t\tfor(int j=0; j<ar.size(); j++){\n\t\t\t\t\tif(i==j)\tcontinue;\n\t\t\t\t\tint temp=ar.get(i)-ar.get(j);\n\t\t\t\t\ttemp+= temp<0? n:0;\n\t\t\t\t\ttemp= temp>nn? n-temp: temp;\n\t\t\t\t\tans[temp]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=1; i<=nn; i++)\tout.println(ans[i]);\n\t\t}\n\t}\n\t\n\t\n\t// TODO レゴ　WA\n\tvoid AOJ0207(){\n\t\twhile(sc.hasNext()){\n\t\t\tint w=sc.nextInt(), h=sc.nextInt();\n\t\t\tif(w==0)\tbreak;\n\t\t\tint sx=sc.nextInt(), sy=sc.nextInt(), gx=sc.nextInt(), gy=sc.nextInt(), n=sc.nextInt();\n\t\t\tint[][] b=new int[w+2][h+2];\n\t\t\tfor(int i=0; i<n; i++){\n\t\t\t\tint color=sc.nextInt(), d=sc.nextInt(), x=sc.nextInt(), y=sc.nextInt();\n\t\t\t\tif(d==0){\t// 横 4x2\n\t\t\t\t\tfor(int j=y; j<y+2; j++){\n\t\t\t\t\t\tfor(int k=x; k<x+4; k++)\tb[k][j]=color;\n\t\t\t\t\t}\n\t\t\t\t}else{\t// 縦 2x4\n\t\t\t\t\tfor(int j=y; j<y+4; j++){\n\t\t\t\t\t\tfor(int k=x; k<x+2; k++)\tb[k][j]=color;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//debug\n\t\t\t//de0207(b,w,h);\n\t\t\tint[] vx={1,0,-1,0}, vy={0,1,0,-1};\n\t\t\tint xx=sx, yy=sy, cc=b[sx][sy], v=0, count=0, max=w*h;\n\t\t\tif(cc<1){\n\t\t\t\tout.println(\"NG\");\n\t\t\t\tSystem.exit(0);\n\t\t\t}\n\t\t\twhile(true){\n\t\t\t\tif(xx==gx && yy==gy && b[xx][yy]==cc){\n\t\t\t\t\tout.println(\"OK\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcount++;\n\t\t\t\tif(count>=max){\n\t\t\t\t\tout.println(\"NG\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t//b[xx][yy]=6;\n\t\t\t\tboolean flag=false;\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(b[xx+vx[i]][yy+vy[i]]==cc){\n\t\t\t\t\t\txx+=vx[i];\tyy+=vy[i];\tv=i;\n\t\t\t\t\t\tflag=true;\n\t\t\t\t\t\tout.println(\"X\"+xx+\" Y\"+yy);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(flag)\tcontinue;\n\t\t\t\txx-=vx[v];\tyy-=vy[v];\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(b[xx+vx[i]][yy+vy[i]]==cc){\n\t\t\t\t\t\txx+=vx[i];\tyy+=vy[i];\tv=i;\n\t\t\t\t\t\tflag=true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(flag)\tcontinue;\n\t\t\t\tout.println(\"END : X\"+xx+\" Y\"+yy);\n\t\t\t\tout.println(\"NG\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t//debug\n\t\t\tde0207(b,w,h);\n\t\t}\n\t}\n\tvoid de0207(int[][] b, int w, int h){\n\t\tfor(int j=0; j<=h; j++){\n\t\t\tfor(int i=0; i<=w; i++)\tout.print(b[i][j]+\" \");\n\t\t\tout.println();\n\t\t}\n\t\tfor(int i=0; i<=w; i++)\tout.print(\"-\");\n\t\tout.println();\n\t}\n\t\n\tvoid AOJ0139(){\n\t\tint N=sc.nextInt();\n\t\tfinal Pattern ap=Pattern.compile(\"^>'(=+)#(=+)~$\");\n\t\tfor(int i=1; i<=N; i++){\n\t\t\tString s=sc.next();\n\t\t\tMatcher m=ap.matcher(s);\n\t\t\tif(m.matches()){\n\t\t\t\tif(m.group(1).length()==m.group(2).length()){\n\t\t\t\t\tout.println(\"A\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}else if(Pattern.compile(\"^>\\\\^(Q=)+~~$\").matcher(s).matches()){\n\t\t\t\tout.println(\"B\");\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tout.println(\"NA\");\n\t\t}\n\t}\n\t\n\tArrayList<Integer> Sieve2(int N){\n\t\tArrayList<Integer> prime = new ArrayList<Integer>();\n\t\tboolean[] list = new boolean[N+1];\n\t\tArrays.fill(list, true);\n\t\tlist[1]=false;\n\t\tfor (int i=2; i<=N; i++) {\n\t\t\tif(list[i]) {\n\t\t\t\tprime.add(i);\n\t\t\t\tfor (int j=i+i; j<=N; j+=i)\tlist[j] = false;\n\t\t\t}\n\t\t}\n\t\treturn prime;\n\t}\n\n\tboolean[] Sieve(int N){\n\t\tboolean[] list = new boolean[N+1];\n\t\tArrays.fill(list, true);\n\t\tlist[0]=false;\tlist[1]=false;\n\t\tfor(int j=4; j<=N; j+=2)\tlist[j]=false;\n\t\tfor(int i=3; i*i<=N; i+=2) {\n\t\t\tif(list[i]) {\n\t\t\t\tfor (int j=i+i; j<=N; j+=i)\tlist[j] = false;\n\t\t\t}\n\t\t}\n\t\treturn list;\n\t}\n\t\n\tboolean isPrime(int n){\n\t\tfor(int i=2; i*i<=n; i++){\n\t\t\tif(n%i==0)     return false;\n\t\t}\n\t\treturn true;\n\t}\n\t\n\tint gcd(int x, int y){\n\t\tif(y==0)\treturn x;\n\t\telse\treturn gcd(y, x%y);\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.PrintWriter;\nimport java.util.Scanner;\n\npublic class Main {\n\tstatic String[][] dp;\n\tstatic char[][] code;\n\tstatic int W;\n\tstatic int H;\n\tpublic static void main(String[] args) {\n\t\tsolve();\n\t}\n\n\tprivate static void solve() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tPrintWriter pr = new PrintWriter(System.out);\n\t\t\n\t\twhile (true) {\n\t\t\tW = sc.nextInt();\n\t\t\tH = sc.nextInt();\n\t\t\tif(W==0&&H==0) break;\n\t\t\tdp = new String[H][W];\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tdp[i][j] = \"-1\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tcode = new char[H][W];\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tString tmp = sc.next();\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tcode[i][j] = tmp.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tdinamic(i, j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tString maxtmp = \"0\";\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tif(dp[i][j].charAt(0)!='0'){\n\t\t\t\t\t\tmaxtmp = max(maxtmp,dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tpr.println(maxtmp);\n\t\t}\n\t\tpr.flush();\n\t\tsc.close();\n\t}\n\n\tprivate static String dinamic(int i, int j) {\n\t\tif(dp[i][j].equals(\"-1\")==false) return dp[i][j];\n\t\tif(code[i][j]<'0'||code[i][j]>'9'){\n\t\t\treturn dp[i][j];\n\t\t}else{\n\t\t\tString tmp1;\n\t\t\tString tmp2;\n\t\t\tif(i+1==H){\n\t\t\t\ttmp1 = \"-1\";\n\t\t\t}else{\n\t\t\t\ttmp1= dinamic(i+1,j);\n\t\t\t}\n\t\t\tif(j+1==W){\n\t\t\t\ttmp2 = \"-1\";\n\t\t\t}else{\n\t\t\t\ttmp2= dinamic(i,j+1);\n\t\t\t}\n\t\t\tif(tmp1.equals(\"-1\")==false){\n\t\t\t\ttmp1 = code[i][j]+tmp1;\n\t\t\t}\n\t\t\tif(tmp2.equals(\"-1\")==false){\n\t\t\t\ttmp2 = code[i][j]+tmp2;\n\t\t\t}\n\t\t\tif(tmp1.equals(\"-1\")&&tmp2.equals(\"-1\")){\n\t\t\t\tdp[i][j] = String.valueOf(code[i][j]);\n\t\t\t\treturn String.valueOf(code[i][j]);\n\t\t\t}\n\t\t\tdp[i][j] = max(tmp1, tmp2);\n\t\t\treturn dp[i][j];\n\t\t}\n\t}\n\n\tprivate static String max(String tmp1, String tmp2) {\n\t\tif(tmp1.equals(\"-1\")){\n\t\t\treturn tmp2;\n\t\t}\n\t\tif(tmp2.equals(\"-1\")){\n\t\t\treturn tmp1;\n\t\t}\n\t\tif(tmp1.length()>tmp2.length()){\n\t\t\treturn tmp1;\n\t\t}else if(tmp1.length()<tmp2.length()){\n\t\t\treturn tmp2;\n\t\t}else{\n\t\t\tfor(int k=0;k<tmp1.length();k++){\n\t\t\t\tif(tmp1.charAt(k)-'0'>tmp2.charAt(k)-'0'){\n\t\t\t\t\treturn tmp1;\n\t\t\t\t}else if(tmp1.charAt(k)-'0'<tmp2.charAt(k)-'0'){\n\t\t\t\t\treturn tmp2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn tmp1;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n  \npublic class Main {\n    Scanner sc = new Scanner(System.in);\n  \n    public static void main(String[] args) {\n        new Main(); \n    }\n  \n    public Main() {\n        new aoj2583().doIt();\n    }\n    class aoj2583{\n    \tchar map[][] = new char[70][70];\n    \tString dp[][] = new String[70][70];\n    \tvoid clear(int W,int H){\n    \t\tfor(int i = 0;i < H;i++){\n    \t\t\tfor(int j = 0;j < W;j++){\n    \t\t\t\tdp[i][j] = \"\";\n    \t\t\t}\n    \t\t}\n    \t}\n    \tvoid set(int W,int H){\n    \t\tfor(int i = 0;i < H;i++){\n    \t\t\tString str = sc.next();\n    \t\t\tchar ctr[] = str.toCharArray();\n    \t\t\tfor(int j = 0;j < W;j++){\n    \t\t\t\tmap[i][j] = ctr[j];\n    \t\t\t}\n    \t\t}\n    \t}\n    \tString dp_table(int W,int H){\n    \t\tString max = \"0\";\n    \t\tfor(int i = 0;i < H;i++){\n    \t\t\tfor(int j = 0;j < W;j++){\n    \t\t\t\tif(i == 0 && j == 0 && (int)map[i][j] <= 57)dp[i][j] = \"\"+map[i][j];\n    \t\t\t\telse if(i == 0 && (int)map[i][j] <= 57){\n    \t\t\t\t\tdp[i][j] = dp[i][j-1] + map[i][j];\n    \t\t\t\t}\n    \t\t\t\telse if(j == 0 && (int)map[i][j] <= 57){\n    \t\t\t\t\tdp[i][j] = dp[i-1][j] + map[i][j];\n    \t\t\t\t}\n    \t\t\t\telse if((int)map[i][j] <= 57){\n    \t\t\t\t\tdp[i][j] = dp[i][j-1] + map[i][j];\n    \t\t\t\t\tString str = dp[i-1][j] + map[i][j];\n    \t\t\t\t\tString str2 = dp[i-1][j-1] + map[i][j];\n    \t\t\t\t\tif(dp[i][j].length() < str.length())dp[i][j] = str;\n    \t\t\t\t\tif(dp[i][j].length() < str.length())dp[i][j] = str2;\n    \t\t\t\t\tif(dp[i][j].length() == str.length()){\n    \t\t\t\t\t\tif(dp[i][j].compareTo(str) < 0)dp[i][j] = str;\n    \t\t\t\t\t}\n    \t\t\t\t\tif(dp[i][j].length() == str2.length()){\n    \t\t\t\t\t\tif(dp[i][j].compareTo(str2) < 0)dp[i][j] = str2;\n    \t\t\t\t\t}\n    \t\t\t\t}\n    \t\t\t\tdp[i][j] = dp[i][j].replaceAll(\"^0*\",\"\");\n    \t\t\t\tif(max.length() < dp[i][j].length())max = dp[i][j];\n    \t\t\t\telse if(max.length() == dp[i][j].length()){\n    \t\t\t\t\tif(max.compareTo(dp[i][j]) < 0)max = dp[i][j];\n    \t\t\t\t}\n    \t\t\t}\n    \t\t}\n    \t\treturn max;\n    \t}\n    \tvoid doIt(){\n    \t\twhile(true){\n    \t\t\tint W = sc.nextInt();\n    \t\t\tint H = sc.nextInt();\n    \t\t\tif(W + H == 0)break;\n    \t\t\tclear(W,H);\n    \t\t\tset(W,H);\n    \t\t\tSystem.out.println(dp_table(W,H));\n//    \t\t\tfor(int i = 0;i < H;i++){\n//    \t\t\t\tfor(int j = 0;j < W;j++){\n//    \t\t\t\t\tSystem.out.print(dp[i][j]+\" :\");\n//    \t\t\t\t}\n//    \t\t\t\tSystem.out.println();\n//    \t\t\t}\n    \t\t}\n    \t}\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.Arrays;\n\nimport static java.lang.Integer.parseInt;\n\n/**\n * The Secret Number\n */\npublic class Main {\n\n\tstatic final String EMPTY = \"\";\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line;\n\t\tString[] words;\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\n\t\t\tint W, H;\n\t\t\tW = parseInt(line.substring(0, line.indexOf(' ')));\n\t\t\tH = parseInt(line.substring(line.indexOf(' ') + 1));\n\t\t\tif ((W | H) == 0) break;\n\n\t\t\tchar[][] numc;\n\t\t\tString[][] nums;\n\n\t\t\tnumc = new char[H + 1][W + 1];\n\t\t\tnums = new String[H + 1][W + 1];\n\n\t\t\tfor (int i = 0; i < numc.length; i++) {\n\t\t\t\tArrays.fill(numc[i], 'X');\n\t\t\t}\n\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tline = br.readLine();\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tchar c = line.charAt(j);\n\t\t\t\t\tnumc[i][j] = (c <= '9' ? c : 'X');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//solve\n\t\t\tfor (int i = H - 1; i >= 0; i--) {\n\t\t\t\tfor (int j = W - 1; j >= 0; j--) {\n\t\t\t\t\tif (numc[i][j] != 'X') {\n\t\t\t\t\t\tString s1 = (numc[i + 1][j] != 'X' ? nums[i + 1][j] : EMPTY);\n\t\t\t\t\t\tString s2 = (numc[i][j + 1] != 'X' ? nums[i][j + 1] : EMPTY);\n\t\t\t\t\t\tnums[i][j] = numc[i][j] + large(s1, s2);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tString max = EMPTY;\n\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tif (numc[i][j] != '0' && numc[i][j] != 'X') {\n\t\t\t\t\t\tmax = large(max, nums[i][j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tSystem.out.println(max);\n\n\t\t} //end while\n\n\t} //end main\n\n\tstatic String large(String s1, String s2) {\n\n\t\tif (s1.length() > s2.length()) return s1;\n\t\tif (s1.length() < s2.length()) return s2;\n\t\tif (s1.equals(s2)) return s1;\n\n\t\tString ret = EMPTY;\n\t\tfor (int i = 0; i < s1.length(); i++) {\n\t\t\tif (s1.charAt(i) > s2.charAt(i)) {\n\t\t\t\tret = s1;\n\t\t\t\tbreak;\n\t\t\t} else if (s1.charAt(i) < s2.charAt(i)) {\n\t\t\t\tret = s2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.Arrays;\nimport java.util.LinkedList;\nimport java.util.Queue;\nimport java.util.Scanner;\n\npublic class Main {\n\tMyScanner sc = new MyScanner();\n\tScanner sc2 = new Scanner(System.in);\n\tint mod = 1000000007;\n\n\tint[] dx = { 1, 0 };\n\tint[] dy = { 0, 1 };\n\n\tvoid run() {\n\t\tfor (;;) {\n\t\t\tint W = sc.nextInt();\n\t\t\tint H = sc.nextInt();\n\t\t\tif ((W | H) == 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tchar[][] field = new char[H][W];\n\t\t\tboolean[][] visit = new boolean[H][W];\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tString input = sc.next();\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tfield[i][j] = input.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tQueue<Point> que = new LinkedList<Point>();\n\t\t\tBigInteger ans = new BigInteger(\"0\");\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tif (Character.isDigit(field[i][j]) && !visit[i][j]) {\n\t\t\t\t\t\tque.add(new Point(j, i,\n\t\t\t\t\t\t\t\tnew BigInteger(field[i][j] + \"\")));\n\t\t\t\t\t\twhile (!que.isEmpty()) {\n\t\t\t\t\t\t\tint size = que.size();\n\t\t\t\t\t\t\tfor (int k = 0; k < size; k++) {\n\t\t\t\t\t\t\t\tPoint now = que.poll();\n\t\t\t\t\t\t\t\tans = ans.max(now.number);\n\n\t\t\t\t\t\t\t\tint nowH = now.h;\n\t\t\t\t\t\t\t\tint nowW = now.w;\n\t\t\t\t\t\t\t\tvisit[nowH][nowW] = true;\n\t\t\t\t\t\t\t\tBigInteger nowNum = now.number;\n\t\t\t\t\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\t\t\t\t\tint nextH = nowH + dy[l];\n\t\t\t\t\t\t\t\t\tint nextW = nowW + dx[l];\n\t\t\t\t\t\t\t\t\tif (nextH < H\n\t\t\t\t\t\t\t\t\t\t\t&& nextW < W\n\t\t\t\t\t\t\t\t\t\t\t&& Character\n\t\t\t\t\t\t\t\t\t\t\t\t\t.isDigit(field[nextH][nextW])) {\n\t\t\t\t\t\t\t\t\t\tque.add(new Point(\n\t\t\t\t\t\t\t\t\t\t\t\tnextW,\n\t\t\t\t\t\t\t\t\t\t\t\tnextH,\n\t\t\t\t\t\t\t\t\t\t\t\tnew BigInteger(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tnowNum\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ \"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ new BigInteger(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfield[nextH][nextW]\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ \"\"))));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\n\tclass Point {\n\t\tint w;\n\t\tint h;\n\t\tBigInteger number;\n\n\t\t/**\n\t\t * @param w\n\t\t * @param h\n\t\t */\n\t\tpublic Point(int w, int h, BigInteger number) {\n\t\t\tsuper();\n\t\t\tthis.w = w;\n\t\t\tthis.h = h;\n\t\t\tthis.number = number;\n\t\t}\n\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid debug(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n\n\tvoid debug2(char[][] array) {\n\t\tfor (int i = 0; i < array.length; i++) {\n\t\t\tfor (int j = 0; j < array[i].length; j++) {\n\t\t\t\tSystem.out.print(array[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tclass MyScanner {\n\t\tint nextInt() {\n\t\t\ttry {\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (c != '-' && (c < '0' || '9' < c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tif (c == '-')\n\t\t\t\t\treturn -nextInt();\n\t\t\t\tint res = 0;\n\t\t\t\tdo {\n\t\t\t\t\tres *= 10;\n\t\t\t\t\tres += c - '0';\n\t\t\t\t\tc = System.in.read();\n\t\t\t\t} while ('0' <= c && c <= '9');\n\t\t\t\treturn res;\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tString next() {\n\t\t\ttry {\n\t\t\t\tStringBuilder res = new StringBuilder(\"\");\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (Character.isWhitespace(c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tdo {\n\t\t\t\t\tres.append((char) c);\n\t\t\t\t} while (!Character.isWhitespace(c = System.in.read()));\n\t\t\t\treturn res.toString();\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.LinkedList;\nimport java.util.Scanner;\n\npublic class Main {\n\tMyScanner sc = new MyScanner();\n\tScanner sc2 = new Scanner(System.in);\n\tfinal int MOD = 1000000007;\n\tint[] dx = { 1, 0, 0, -1 };\n\tint[] dy = { 0, 1, -1, 0 };\n\n\tvoid run() {\n\t\tfor (;;) {\n\t\t\tint W = sc.nextInt();\n\t\t\tint H = sc.nextInt();\n\t\t\tif ((W | H) == 0)\n\t\t\t\treturn;\n\t\t\tchar[][] f = sc.nextCharField(H, W);\n\t\t\tInfo[][] s = new Info[H][W];\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tif (!Character.isDigit(f[i][j])) {\n\t\t\t\t\t\ts[i][j] = new Info(\".\", i, j);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ts[i][j] = new Info(\"0\", i, j);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tString max = \"0\";\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tif (!s[i][j].s.equals(\".\") && s[i][j].s.compareTo(f[i][j] + \"\") <= 0 && f[i][j] != '0') {\n\t\t\t\t\t\ts[i][j].s = f[i][j] + \"\";\n\t\t\t\t\t\tLinkedList<Info> que = new LinkedList<Info>();\n\t\t\t\t\t\tque.add(s[i][j]);\n\t\t\t\t\t\twhile (!que.isEmpty()) {\n\t\t\t\t\t\t\tint size = que.size();\n\t\t\t\t\t\t\tfor (int k = 0; k < size; k++) {\n\t\t\t\t\t\t\t\tInfo now = que.poll();\n\t\t\t\t\t\t\t\tif(now.s.length() > max.length()) max = now.s;\n\t\t\t\t\t\t\t\telse  if(now.s.length() == max.length() && now.s.compareTo(max) > 0) max = now.s;\n\t\t\t\t\t\t\t\tif (inner(now.h + 1, now.w, H, W)\n\t\t\t\t\t\t\t\t\t\t&& Character\n\t\t\t\t\t\t\t\t\t\t\t\t.isDigit(f[now.h + 1][now.w])) {\n\t\t\t\t\t\t\t\t\tInfo next = new Info(now.s\n\t\t\t\t\t\t\t\t\t\t\t+ f[now.h + 1][now.w], now.h + 1,\n\t\t\t\t\t\t\t\t\t\t\tnow.w);\n\t\t\t\t\t\t\t\t\tif (next.s.compareTo(s[now.h + 1][now.w].s) > 0) {\n\t\t\t\t\t\t\t\t\t\tque.add(next);\n\t\t\t\t\t\t\t\t\t\ts[now.h + 1][now.w] = next;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (inner(now.h, now.w + 1, H, W)\n\t\t\t\t\t\t\t\t\t\t&& Character\n\t\t\t\t\t\t\t\t\t\t\t\t.isDigit(f[now.h][now.w + 1])) {\n\t\t\t\t\t\t\t\t\tInfo next = new Info(now.s\n\t\t\t\t\t\t\t\t\t\t\t+ f[now.h][now.w + 1], now.h,\n\t\t\t\t\t\t\t\t\t\t\tnow.w + 1);\n\t\t\t\t\t\t\t\t\tif (next.s.compareTo(s[now.h][now.w + 1].s) > 0) {\n\t\t\t\t\t\t\t\t\t\tque.add(next);\n\t\t\t\t\t\t\t\t\t\ts[now.h][now.w + 1] = next;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(max);\n\t\t}\n\t}\n\n\tclass Info {\n\t\tString s;\n\t\tint h;\n\t\tint w;\n\n\t\tpublic Info(String s, int h, int w) {\n\t\t\tsuper();\n\t\t\tthis.s = s;\n\t\t\tthis.h = h;\n\t\t\tthis.w = w;\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid debug(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n\n\tvoid debug2(char[][] array) {\n\t\tfor (int i = 0; i < array.length; i++) {\n\t\t\tfor (int j = 0; j < array[i].length; j++) {\n\t\t\t\tSystem.out.print(array[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tboolean inner(int h, int w, int limH, int limW) {\n\t\treturn 0 <= h && h < limH && 0 <= w && w < limW;\n\t}\n\n\tvoid swap(int[] x, int a, int b) {\n\t\tint tmp = x[a];\n\t\tx[a] = x[b];\n\t\tx[b] = tmp;\n\t}\n\n\t// find minimum i (a[i] >= border)\n\tint lower_bound(int a[], int border) {\n\t\tint l = -1;\n\t\tint r = a.length;\n\n\t\twhile (r - l > 1) {\n\t\t\tint mid = (l + r) / 2;\n\t\t\tif (border <= a[mid]) {\n\t\t\t\tr = mid;\n\t\t\t} else {\n\t\t\t\tl = mid;\n\t\t\t}\n\t\t}\n\t\t// r = l + 1\n\t\treturn r;\n\t}\n\n\tboolean palindrome(String s) {\n\t\tfor (int i = 0; i < s.length() / 2; i++) {\n\t\t\tif (s.charAt(i) != s.charAt(s.length() - 1 - i)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tclass MyScanner {\n\t\tint nextInt() {\n\t\t\ttry {\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (c != '-' && (c < '0' || '9' < c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tif (c == '-')\n\t\t\t\t\treturn -nextInt();\n\t\t\t\tint res = 0;\n\t\t\t\tdo {\n\t\t\t\t\tres *= 10;\n\t\t\t\t\tres += c - '0';\n\t\t\t\t\tc = System.in.read();\n\t\t\t\t} while ('0' <= c && c <= '9');\n\t\t\t\treturn res;\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tString next() {\n\t\t\ttry {\n\t\t\t\tStringBuilder res = new StringBuilder(\"\");\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (Character.isWhitespace(c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tdo {\n\t\t\t\t\tres.append((char) c);\n\t\t\t\t} while (!Character.isWhitespace(c = System.in.read()));\n\t\t\t\treturn res.toString();\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] in = new int[n];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tin[i] = nextInt();\n\t\t\t}\n\t\t\treturn in;\n\t\t}\n\n\t\tint[][] nextInt2dArray(int n, int m) {\n\t\t\tint[][] in = new int[n][m];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tin[i] = nextIntArray(m);\n\t\t\t}\n\t\t\treturn in;\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] in = new double[n];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tin[i] = nextDouble();\n\t\t\t}\n\t\t\treturn in;\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] in = new long[n];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tin[i] = nextLong();\n\t\t\t}\n\t\t\treturn in;\n\t\t}\n\n\t\tchar[][] nextCharField(int n, int m) {\n\t\t\tchar[][] in = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tString s = sc.next();\n\t\t\t\tfor (int j = 0; j < m; j++) {\n\t\t\t\t\tin[i][j] = s.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn in;\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\n\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.Scanner;\n\npublic class Main \n{\n\tstatic Scanner scan = new Scanner(System.in);\n\t\n\tpublic static void main(String[] args) \n\t{\n\t\tint w;\n\t\tint h;\n\n\t\t//numbers: ascii 48 ~ 57 are 0 ~ 9\n\t\t\n\t\twhile(true)\n\t\t{\n\t\t\tw = scan.nextInt();\n\t\t\th = scan.nextInt();\n\t\t\t\n\t\t\tif(w == 0 && h == 0)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnew DataSet(w,h);\n\t\t\t}\n\t\t\t\n\t\t}\n\t}\n\t\n\tstatic class DataSet\n\t{\n\t\tint width;\n\t\tint height;\n\t\tchar[][] grid;\n\t\tString[][] calc;\n\t\tList<Integer> startX = new ArrayList<Integer>();\n\t\tList<Integer> startY = new ArrayList<Integer>();\n\t\t\n\t\tpublic DataSet(int w, int h)\n\t\t{\n\t\t\tthis.width = w;\n\t\t\tthis.height = h;\n\t\t\t\n\t\t\tgrid = new char[w][h];\n\t\t\tcalc = new String[w][h];\n\t\t\t\n\t\t\tfor(int row = 0; row < h; row++)\n\t\t\t{\n\t\t\t\tString str = scan.next();\n\t\t\t\t\n\t\t\t\tfor(int ch = 0; ch < w; ch++)\n\t\t\t\t{\n\t\t\t\t\t//numbers: ascii 48 ~ 57 are 0 ~ 9\n\t\t\t\t\tgrid[ch][row] = str.charAt(ch);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\tString biggest = \"0\";\n\t\t\t\n\t\t\tfor(int row = h-1; row >= 0; row--)\n\t\t\t{\n\t\t\t\t\n\t\t\t\tfor(int ch = w-1; ch >= 0; ch--)\n\t\t\t\t{\n\t\t\t\t\tString here;\n\t\t\t\t\tString right;\n\t\t\t\t\tString down;\n\t\t\t\t\t\n\t\t\t\t\tif(charIsNumber(grid[ch][row]))\n\t\t\t\t\t{\n\t\t\t\t\t\tif(ch == w-1 || !charIsNumber(grid[ch+1][row]))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tright = \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tright = calc[ch+1][row];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(row == h-1 || !charIsNumber(grid[ch][row+1]))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdown = \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdown = calc[ch][row+1];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tright = grid[ch][row] + right;\n\t\t\t\t\t\tdown = grid[ch][row] + down;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(right.length() > down.length())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\there = right;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(down.length() > right.length())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\there = down;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse //if(right.length() == down.length())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif(firstStringIsBigger(right,down))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t//right\n\t\t\t\t\t\t\t\there = right;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\there = down;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tcalc[ch][row] = here;\n\t\t\t\t\t\t\n//\t\t\t\t\t\tSystem.out.println(ch + \", \" + row + \" is \" + here);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(firstStringIsBigger(here, biggest))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbiggest = here;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tSystem.out.println(biggest);\n\t\t}\n\t\t\n\t\tpublic String removeZeroesAtStart(String a)\n\t\t{\n\t\t\tString ans = a;\n\t\t\t\n\t\t\twhile(true)\n\t\t\t{\n//\t\t\t\tSystem.out.println(\"checking \" + a);\n\t\t\t\t\n\t\t\t\tif(a.equals(\"\")) {return a;}\n\t\t\t\tif(a.charAt(0) == 48)\n\t\t\t\t{\n\t\t\t\t\ta = a.substring(1);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tboolean firstStringIsBigger(String a, String b)\n\t\t{\n\t\t\ta = removeZeroesAtStart(a);\n\t\t\tb = removeZeroesAtStart(b);\n\t\t\t\n\t\t\tif(a.length() > b.length()) {return true;}\n\t\t\tif(a.length() < b.length()) {return false;}\n\t\t\t\n\t\t\t//when length is the same: compare from the 1st digit (most significant)\n\t\t\t\n\t\t\tfor(int i = 0; i < a.length(); i++)\n\t\t\t{\n\t\t\t\tif(a.charAt(i) > b.charAt(i))\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tif(a.charAt(i) < b.charAt(i))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\t\n\t\tboolean charIsNumber(char c)\n\t\t{\n\t\t\tif(c >= 48 && c <= 57)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.*;\n\n\npublic class Main {\n\tstatic ArrayList<String> cand = new ArrayList<String>();\n\tstatic int max = 0;\n\tpublic static void main(String[] args) {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));       \n\t\ttry {\n\t\t\tString line;\n\t\t\twhile(true){\n\t\t\t\t/* input */\n\t\t\t\tcand = new ArrayList<String>();\n\t\t\t\tline = br.readLine();\n\t\t\t\t\n\t\t\t\tint w = Integer.parseInt(line.split(\" \")[0]);\n\t\t\t\tint h = Integer.parseInt(line.split(\" \")[1]);\n\t\t\t\tif(w == 0 && h == 0){\n\t\t\t\t\treturn;\n\t\t\t\t} \n\n\t\t\t\tchar[][] field = new char[h][w];\n\t\t\t\tfor(int i=0;i<h;i++){\n\t\t\t\t\tline = br.readLine();\n\t\t\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\t\t\tfield[i][j] = line.charAt(j);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t/* processing */\n\t\t\t\tfor(int i=0;i<h;i++){\n\t\t\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\t\t\tif((h-i)+(w-j)<max){\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(i>0){\n\t\t\t\t\t\t\tif(Character.isDigit(field[i-1][j])&&(field[i-1][j]!='0')){\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(j>0){\n\t\t\t\t\t\t\tif(Character.isDigit(field[i][j-1])&&(field[i][j-1]!='0')){\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(Character.isDigit(field[i][j])&&(field[i][j]!='0')){\n\t\t\t\t\t\t\t\tsearch(i,j,field,h,w,\"\"+field[i][j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/* output */\n\t\t\t\tCollections.sort(cand);\n\t\t\t\tint maxlength = 0;\n\t\t\t\tString maxs = \"\";\n\t\t\t\tfor(String s: cand){\n\t\t\t\t\t//System.out.println(s);\n\t\t\t\t\tif (s.length()>maxlength){\n\t\t\t\t\t\tmaxlength = s.length();\n\t\t\t\t\t\tmaxs = s;\n\t\t\t\t\t} else if(s.length()==maxlength){\n\t\t\t\t\t\tfor(int i=0;i<s.length();i++){\n\t\t\t\t\t\t\tif(s.charAt(i)>maxs.charAt(i)){\n\t\t\t\t\t\t\t\tmaxs = s;\n\t\t\t\t\t\t\t} else if(s.charAt(i)>maxs.charAt(i)){\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//System.out.println();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tSystem.out.println(maxs);\n\t\t\t}\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\n\tpublic static void search(int i,int j,char[][] field,int h,int w, String s){\n\t\tboolean r = true, d = true;\n\t\tif(j<w-1){\n\t\t\tif(Character.isDigit(field[i][j+1])){\n\t\t\t\tsearch(i,j+1,field,h,w,s + field[i][j+1]);\n\t\t\t\tr = false;\n\t\t\t}\n\t\t}\n\n\t\tif(i<h-1){\n\t\t\tif(Character.isDigit(field[i+1][j])){\n\t\t\t\tsearch(i+1,j,field,h,w,s + field[i+1][j]);\n\t\t\t\td = false;\n\t\t\t}\n\t\t}\n\t\tif(r&&d){\n\t\t\tif(s.length()>max) max = s.length();\n\t\t\tcand.add(s);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\n\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.Scanner;\n\npublic class Main \n{\n\tstatic Scanner scan = new Scanner(System.in);\n\t\n\tpublic static void main(String[] args) \n\t{\n\t\tint w;\n\t\tint h;\n\n\t\t//numbers: ascii 48 ~ 57 are 0 ~ 9\n\t\t\n\t\twhile(true)\n\t\t{\n\t\t\tw = scan.nextInt();\n\t\t\th = scan.nextInt();\n\t\t\t\n\t\t\tif(w == 0 && h == 0)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnew DataSet(w,h);\n\t\t\t}\n\t\t\t\n\t\t}\n\t}\n\t\n\tstatic class DataSet\n\t{\n\t\tint width;\n\t\tint height;\n\t\tchar[][] grid;\n\t\tString[][] calc;\n\t\tList<Integer> startX = new ArrayList<Integer>();\n\t\tList<Integer> startY = new ArrayList<Integer>();\n\t\t\n\t\tpublic DataSet(int w, int h)\n\t\t{\n\t\t\tthis.width = w;\n\t\t\tthis.height = h;\n\t\t\t\n\t\t\tgrid = new char[w][h];\n\t\t\tcalc = new String[w][h];\n\t\t\t\n\t\t\tfor(int row = 0; row < h; row++)\n\t\t\t{\n\t\t\t\tString str = scan.next();\n\t\t\t\t\n\t\t\t\tfor(int ch = 0; ch < w; ch++)\n\t\t\t\t{\n\t\t\t\t\t//numbers: ascii 48 ~ 57 are 0 ~ 9\n\t\t\t\t\tgrid[ch][row] = str.charAt(ch);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\tString biggest = \"0\";\n\t\t\t\n\t\t\tfor(int row = h-1; row >= 0; row--)\n\t\t\t{\n\t\t\t\t\n\t\t\t\tfor(int ch = w-1; ch >= 0; ch--)\n\t\t\t\t{\n\t\t\t\t\tString here;\n\t\t\t\t\tString right;\n\t\t\t\t\tString down;\n\t\t\t\t\t\n\t\t\t\t\tif(charIsNumber(grid[ch][row]))\n\t\t\t\t\t{\n\t\t\t\t\t\tif(ch == w-1 || !charIsNumber(grid[ch+1][row]))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tright = \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tright = calc[ch+1][row];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(row == h-1 || !charIsNumber(grid[ch][row+1]))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdown = \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdown = calc[ch][row+1];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(firstStringIsBigger(right,down))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t//right\n\t\t\t\t\t\t\there = grid[ch][row] + right;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\there = grid[ch][row] + down;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tcalc[ch][row] = here;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(firstStringIsBigger(here, biggest))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbiggest = here;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tSystem.out.println(biggest);\n\t\t}\n\t\t\n\t\tpublic String removeZeroesAtStart(String a)\n\t\t{\n\t\t\tString ans = a;\n\t\t\t\n\t\t\twhile(true)\n\t\t\t{\n//\t\t\t\tSystem.out.println(\"checking \" + a);\n\t\t\t\t\n\t\t\t\tif(a.equals(\"\")) {return a;}\n\t\t\t\tif(a.charAt(0) == 48)\n\t\t\t\t{\n\t\t\t\t\ta = a.substring(1);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tboolean firstStringIsBigger(String a, String b)\n\t\t{\n\t\t\ta = removeZeroesAtStart(a);\n\t\t\tb = removeZeroesAtStart(b);\n\t\t\t\n\t\t\tif(a.length() > b.length()) {return true;}\n\t\t\tif(a.length() < b.length()) {return false;}\n\t\t\t\n\t\t\t//when length is the same: compare from the 1st digit (most significant)\n\t\t\t\n\t\t\tfor(int i = 0; i < a.length(); i++)\n\t\t\t{\n\t\t\t\tif(a.charAt(i) > b.charAt(i))\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tif(a.charAt(i) < b.charAt(i))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\t\n\t\tboolean charIsNumber(char c)\n\t\t{\n\t\t\tif(c >= 48 && c <= 57)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.Arrays;\nimport java.util.Scanner;\n\n\npublic class Main {\n\n\t/**\n\t * @param args\n\t */\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\t\n\t\twhile(true){\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\t\n\t\t\tif(w == 0){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tchar[][] input = new char[h][w];\n\t\t\t\n\t\t\tfor(int i = 0; i < h; i++){\n\t\t\t\tString str = sc.next();\n\t\t\t\t\n\t\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\t\tinput[i][j] = str.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tString[][] dp = new String[h][w];\n\t\t\t\n\t\t\tfor(int i = 0; i < h ; i++){\n\t\t\t\tArrays.fill(dp[i], \"\");\n\t\t\t}\n\t\t\t\n\t\t\tString result = \"0\";\n\t\t\tfor(int i = 0; i < h; i++){\n\t\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\t\tif(!Character.isDigit(input[i][j])){\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tString uNum = \"\";\n\t\t\t\t\tString lNum = \"\";\n\t\t\t\t\t\n\t\t\t\t\tif(i != 0 && !dp[i - 1][j].equals(\"0\")){\n\t\t\t\t\t\tuNum = dp[i - 1][j];\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(j != 0 && !dp[i][j - 1].equals(\"0\")){\n\t\t\t\t\t\tlNum = dp[i][j - 1];\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tuNum += input[i][j];\n\t\t\t\t\tlNum += input[i][j];\n\t\t\t\t\t\n\t\t\t\t\tString tmp = comp(uNum, lNum);\n\t\t\t\t\tdp[i][j] = tmp;\n\t\t\t\t\t\n\t\t\t\t\tresult = comp(result, tmp);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\t//debug\n//\t\t\tfor(int i = 0; i < h; i++){\n//\t\t\t\tfor(int j = 0; j < w; j++){\n//\t\t\t\t\tSystem.out.print(dp[i][j]+\" \");\n//\t\t\t\t}\n//\t\t\t\tSystem.out.println();\n//\t\t\t}\n\t\t\tSystem.out.println(result);\n\t\t}\n\t}\n\t\n\tstatic String comp(String str1, String str2){\n\t\tif(str1.length() > str2.length()){\n\t\t\treturn str1;\n\t\t}\n\t\telse if(str1.length() < str2.length()){\n\t\t\treturn str2;\n\t\t}\n\t\t\n\t\t//文字列の長さが等しい場合の処理\n\t\tfor(int i = 0; i < str1.length(); i++){\n\t\t\tif(str1.charAt(i) > str2.charAt(i)){\n\t\t\t\treturn str1;\n\t\t\t}\n\t\t\telse if(str1.charAt(i) < str2.charAt(i)){\n\t\t\t\treturn str2;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn str1;\n\t}\n\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nclass Main{\n    static int w,h;\n    static String[][] fieldS;\n    static int[][] fieldI;\n    static List<String> numList;\n\n    public static void main(String[] args){\n\tScanner sc = new Scanner(System.in);\n\n\tnumList = new ArrayList<String>();\n\tfor(int i=0; i<10; i++){\n\t    String num = Integer.toString(i);\n\t    numList.add(num);\n\t}\n\n\tw = sc.nextInt();\n\th = sc.nextInt();\n\n\twhile(w!=0 && h!=0){\n\t    fieldS = new String[h][w];\n\t    for(int i=0; i<h; i++){\n\t\tfor(int j=0; j<w; j++){\n\t\t    fieldS[i][j] = \"\";\n\t\t}\n\t    }\n\t    fieldI = new int[h][w];\n\n\t    for(int i=0; i<h; i++){\n\t\tString line = sc.next();\n\t\tfor(int j=0; j<w; j++){\n\t\t    if(numList.contains(line.substring(j,j+1))){\n\t\t\tfieldI[i][j] = Integer.parseInt(line.substring(j,j+1));\n\t\t    }else{\n\t\t\tfieldI[i][j] = -1;\n\t\t    }\n\t\t}\n\t    }\n\n\t    String ans = solve();\n\t    if(!ans.equals(\"-1\") && !ans.equals(\"\"))System.out.println(ans);\n\t    else if(ans.equals(\"-1\"))System.out.println(1);\n\t    else System.out.println(0);\n\n\t    w = sc.nextInt();\n\t    h = sc.nextInt();\n\t}\n    }\n\n    public static String solve(){\n\tString up = \"\";\n\tString left = \"\";\n\tboolean hantei = false;\n\tfor(int i=0; i<h; i++){\n\t    for(int j=0; j<w; j++){\n\t\tif(fieldI[i][j]!=-1){\n\t\t    hantei = false;\n\t\t    if(i-1>=0){up = fieldS[i-1][j]; hantei=true;}\n\t\t    if(j-1>=0){left = fieldS[i][j-1]; hantei=true;}\n\t\t    if(hantei ||(i==0 && j==0)){\n\t\t\tString select = getLargerOne(up,left);\n\t\t\tfieldS[i][j] = select + Integer.toString(fieldI[i][j]);\n\t\t\tif(fieldS[i][j].equals(\"0\")){fieldS[i][j]=\"\";}\n\t\t\tup = \"\";\n\t\t\tleft = \"\";\n\t\t    }else {fieldS[i][j]=Integer.toString(fieldI[i][j]);}\n\t\t}\n\t    }\n\t}\n\tString max = getMax();\n\treturn max;\n    }\n\n    public static String getLargerOne(String up, String left){\n\n\tif(up.length()>left.length()){return up;}\n\telse if(left.length()>up.length()){return left;}\n\n\tfor(int i=0; i<up.length(); i++){\n\t    int upI = Integer.parseInt(up.substring(i,i+1));\n\t    int leftI = Integer.parseInt(left.substring(i,i+1));\n\t    if(upI>leftI){return up;}\n\t    else if(leftI>upI){return left;}\n\t}\n\treturn up;\n    }\n\n    public static String getMax(){\n\tint maxLen = 0;\n\tList<String> sameLen = new ArrayList<String>();\n\tfor(int i=0; i<h; i++){\n\t    for(int j=0; j<w; j++){\n\t\tif(fieldS[i][j].length()>maxLen){\n\t\t    maxLen = fieldS[i][j].length();\n\t\t}\n\t    }\n\t}\n\n\tfor(int i=0; i<h; i++){\n\t    for(int j=0; j<w; j++){\n\t\tif(fieldS[i][j].length()==maxLen){\n\t\t    sameLen.add(fieldS[i][j]);\n\t\t}\n\t    }\n\t}\n\tif(sameLen.size()==1){return sameLen.get(0);}\n\tint maxInt = 0;\n\tfor(int i=0; i<maxLen; i++){\n\t    maxInt = 0;\n\t    for(int j=0; j<sameLen.size(); j++){\n\t\tString a = sameLen.get(j);\n\t\t//System.out.println(a);\n\t\tint num = Integer.parseInt(a.substring(i,i+1));\n\t\tif(num>maxInt){\n\t\t    maxInt = num;j=-1;\n\t\t}\n\t\telse if(num<maxInt){sameLen.remove(j); j--;}\n\t\telse if(num==maxInt && i==maxLen-1 && j==sameLen.size()-1){return sameLen.get(0);}\n\t\tif(sameLen.size()==1){return sameLen.get(0);}\n\t    }\n\t}\n\treturn \"-1\";\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\n\npublic class Main {\n\tint m, n;\n\tchar[][] map;\n\tScanner in = new Scanner(System.in);\n\t\n\tString remove_zero(String s) {\n\t\tint k;\n\t\tfor (k = 0; k < s.length(); k++) {\n\t\t\tif (s.charAt(k) != '0') break;\n\t\t}\n\t\treturn s.substring(k, s.length()); \n\t}\n\t\n\tboolean compare(String s1, String s2) {\n\t\tif (s1.length() > s2.length()) return true;\n\t\telse if (s1.length() < s2.length()) return false;\n\t\telse {\n\t\t\tfor (int i = 0; i < s1.length(); i++) {\n\t\t\t\tif (s1.charAt(i) > s2.charAt(i)) return true;\n\t\t\t\telse if (s1.charAt(i) < s2.charAt(i)) return false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\t\n\tpublic Main() {\n\t\twhile (true) {\n\t\t\tint m = in.nextInt();\n\t\t\tint n = in.nextInt();\n\t\t\tif (m == 0 && n == 0) break;\n\t\t\tmap = new char[n+1][m+1];\n\t\t\tfor (int i = 1; i <= n; i++) {\n\t\t\t\tString s = in.next();\n\t\t\t\tfor (int j = 0; j < m; j++) {\n\t\t\t\t\tmap[i][j+1] = s.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tString[][] dp = new String[n+1][m+1];\n\t\t\tfor (int i = 0; i <= n; i++) \n\t\t\t\tfor (int j = 0; j <= m; j++) \n\t\t\t\t\tdp[i][j] = \"\";\n\t\t\t\t\n\t\t\tfor (int i = 1; i <= n; i++) {\n\t\t\t\tfor (int j = 1; j <= m; j++) {\n\t\t\t\t\tif (map[i][j] >= 'A' && map[i][j] <= 'Z' || map[i][j] == 0)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[i][j] = (compare(dp[i][j-1] + map[i][j], dp[i][j])) ? dp[i][j-1] + map[i][j] : dp[i][j];\n\t\t\t\t\t\tdp[i][j] = (compare(dp[i-1][j] + map[i][j], dp[i][j])) ? dp[i-1][j] + map[i][j] : dp[i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tString ans = \"\";\n\t\t\tfor (int i = 1; i <= n; i++) {\n\t\t\t\tfor (int j = 1; j <= m; j++) {\n\t\t\t\t\tans = remove_zero(ans);\n\t\t\t\t\tif (compare(dp[i][j], ans))\n\t\t\t\t\t\tans = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.*;\nimport static java.lang.Math.*;\nimport static java.util.Arrays.*;\n\npublic class Main {\n\n\tint INF = 1 << 28;\n\t\n\tint cmp (String p1, String p2) {\n\t\tif( p1.length() != p2.length() ) return p2.length() - p1.length();\n\t\treturn p2.compareTo(p1);\n\t}\n\t\n\tvoid run() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tfor(;;) {\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tif((w|h) == 0 ) break;\n\t\t\t\n\t\t\tString[][] dp = new String[h+1][w+1];\n\t\t\tString pass = \"\";\n\t\t\tchar[][] map = new char[h+1][w+1];\n\t\t\t\n\t\t\tfor(String[] a: dp) fill(a, \"\");\n\t\t\t\n\t\t\tfor(int i=1;i<=h;i++) {\n\t\t\t\tString str = sc.next();\n\t\t\t\tfor(int j=1;j<=w;j++) {\n\t\t\t\t\tmap[i][j] = str.charAt(j-1);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfor(int i=1;i<=h;i++) for(int j=1;j<=w;j++) {\n\t\t\t\tif( '0' <= map[i][j] && map[i][j] <= '9' ) {\n\t\t\t\t\tif( map[i][j] == '0' && dp[i-1][j].equals(\"\") && dp[i][j-1].equals(\"\") ) continue;\n\t\t\t\t\tdp[i][j] = ( cmp(dp[i-1][j], dp[i][j-1])<0? dp[i-1][j]: dp[i][j-1] ) + (char)map[i][j];\n\t\t\t\t}\n\t\t\t\tpass = cmp(pass, dp[i][j])<0? pass: dp[i][j];\n\t\t\t}\n\t\t\t\n\t\t\tSystem.out.println(pass);\n\t\t\t\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid debug(Object... os) {\n\t\tSystem.err.println(Arrays.deepToString(os));\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.Arrays;\nimport java.util.LinkedList;\nimport java.util.Queue;\nimport java.util.Scanner;\n\npublic class Main {\n\tMyScanner sc = new MyScanner();\n\tScanner sc2 = new Scanner(System.in);\n\tint mod = 1000000007;\n\n\tint[] dx = { 1, 0 };\n\tint[] dy = { 0, 1 };\n\n\tvoid run() {\n\t\tfor (;;) {\n\t\t\tint W = sc.nextInt();\n\t\t\tint H = sc.nextInt();\n\t\t\tif ((W | H) == 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tchar[][] field = new char[H][W];\n\t\t\tboolean[][] visit = new boolean[H][W];\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tString input = sc.next();\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tfield[i][j] = input.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tQueue<Point> que = new LinkedList<Point>();\n\t\t\tBigInteger ans = new BigInteger(\"0\");\n\t\t\tBigInteger tmp = new BigInteger(\"0\");\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tif (Character.isDigit(field[i][j]) && !visit[i][j]) {\n\t\t\t\t\t\tque.add(new Point(j, i, (field[i][j] + \"\")));\n\t\t\t\t\t\twhile (!que.isEmpty()) {\n\t\t\t\t\t\t\tint size = que.size();\n\t\t\t\t\t\t\tfor (int k = 0; k < size; k++) {\n\t\t\t\t\t\t\t\tPoint now = que.poll();\n\t\t\t\t\t\t\t\ttmp = new BigInteger(now.number);\n\t\t\t\t\t\t\t\tans = ans.max(tmp);\n\n\t\t\t\t\t\t\t\tint nowH = now.h;\n\t\t\t\t\t\t\t\tint nowW = now.w;\n\t\t\t\t\t\t\t\tvisit[nowH][nowW] = true;\n\t\t\t\t\t\t\t\tString nowNum = now.number;\n\t\t\t\t\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\t\t\t\t\tint nextH = nowH + dy[l];\n\t\t\t\t\t\t\t\t\tint nextW = nowW + dx[l];\n\t\t\t\t\t\t\t\t\tif (nextH < H\n\t\t\t\t\t\t\t\t\t\t\t&& nextW < W\n\t\t\t\t\t\t\t\t\t\t\t&& Character\n\t\t\t\t\t\t\t\t\t\t\t\t\t.isDigit(field[nextH][nextW])) {\n\t\t\t\t\t\t\t\t\t\tque.add(new Point(nextW, nextH, nowNum\n\t\t\t\t\t\t\t\t\t\t\t\t+ \"\" + field[nextH][nextW]));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\n\tclass Point {\n\t\tint w;\n\t\tint h;\n\t\tString number;\n\n\t\t/**\n\t\t * @param w\n\t\t * @param h\n\t\t */\n\t\tpublic Point(int w, int h, String number) {\n\t\t\tsuper();\n\t\t\tthis.w = w;\n\t\t\tthis.h = h;\n\t\t\tthis.number = number;\n\t\t}\n\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid debug(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n\n\tvoid debug2(char[][] array) {\n\t\tfor (int i = 0; i < array.length; i++) {\n\t\t\tfor (int j = 0; j < array[i].length; j++) {\n\t\t\t\tSystem.out.print(array[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tclass MyScanner {\n\t\tint nextInt() {\n\t\t\ttry {\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (c != '-' && (c < '0' || '9' < c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tif (c == '-')\n\t\t\t\t\treturn -nextInt();\n\t\t\t\tint res = 0;\n\t\t\t\tdo {\n\t\t\t\t\tres *= 10;\n\t\t\t\t\tres += c - '0';\n\t\t\t\t\tc = System.in.read();\n\t\t\t\t} while ('0' <= c && c <= '9');\n\t\t\t\treturn res;\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tString next() {\n\t\t\ttry {\n\t\t\t\tStringBuilder res = new StringBuilder(\"\");\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (Character.isWhitespace(c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tdo {\n\t\t\t\t\tres.append((char) c);\n\t\t\t\t} while (!Character.isWhitespace(c = System.in.read()));\n\t\t\t\treturn res.toString();\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;import java.math.*;class Main{public static void main(String[]z){Scanner s=new Scanner(System.in);BigInteger r,t,o=BigInteger.ZERO;for(int w,h,i,j;(w=s.nextInt())>0;System.out.println(r.compareTo(o)>0?r:\"\")){char[][]x=new char[h = s.nextInt()][];m=new String[h][w];for(i=0;i<h;++i)x[i]=s.next().toCharArray();for(i=0,r=o;i<h;++i)for(j=0;j<w;++j)r=r.compareTo(t=new BigInteger(f(x,i,j,h,w)))>0?r:t;}}static String[][]m;static String f(char[][]a,int x,int y,int h,int w){if(x>=h||y>=w||a[x][y]<48||a[x][y]>57)return \"0\";String d,r,t;if(m[x][y]!=null)return m[x][y];d=f(a,x+1,y,h,w);r=f(a,x,y+1,h,w);return m[x][y]=a[x][y]+((t=(new BigInteger(d).compareTo(new BigInteger(r))>0?d:r)).equals(\"0\")?\"\":t);}}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tScanner sc = new Scanner(System.in);\n\tpublic void run() {\n\t\twhile(sc.hasNext()){\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tsc.nextLine();\n\t\t\tif(w == 0 && h == 0)break;\n\t\t\telse calc(w, h);\n\t\t\t\n\t\t}\n\t}\n\tpublic void calc(int w, int h){\n\t\tString[][] matrix = new String[h][w];\n\t\tfor(int i = 0; i < h; i++){\n\t\t\tString line = sc.nextLine();\n\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\tString c = line.substring(j, j+1);\n\t\t\t\tmatrix[i][j] = c;\n\t\t\t}\n\t\t}\n\t\tnum = new String[h][w];\n\t\tString max = \"0\";\n\t\tfor(int i = 0; i < w; i++){\n\t\t\tfor(int j = 0; j < h; j++){\n\t\t\t\tif(num[j][i] == null) numCalc(matrix, i, j, w, h);\n\t\t\t\tmax = compare(retNum(num[j][i]) , max);\n\t\t\t}\n\t\t}\n\t\tSystem.out.println(retNum(max));\n\t}\n\tString[][] num;\n\tpublic String retNum(String t){\n\t\tint size = t.length();\n\t\tfor(int i = 0; i < size - 1; i++){\n\t\t\tif(t.charAt(0) == '0') t = t.substring(1);\n\t\t\telse break;\n\t\t}\n\t\treturn t;\n\t}\n\t\n\tpublic String compare(String i, String j){\n\t\tif(i.length() > j.length()){\n\t\t\treturn i;\n\t\t}\n\t\telse if(i.length() < j.length()){\n\t\t\treturn j;\n\t\t}\n\t\telse if(i.compareTo(j) < 0) return j;\n\t\telse return i;\n\t}\n\tpublic String numCalc(String[][] matrix, int x, int y, int w, int h){\n\t\tif(num[y][x] != null) return num[y][x];\n\t\telse{\n\t\t\tString c = matrix[y][x];\n\t\t\tif(c.equals(\"0\") || c.equals(\"1\") || c.equals(\"2\") || c.equals(\"3\") || c.equals(\"4\")\n\t\t\t\t\t|| c.equals(\"5\") || c.equals(\"6\") || c.equals(\"7\") || c.equals(\"8\") || c.equals(\"9\")){\n\t\t\t\tString a1 = null;\n\t\t\t\tif(x < w-1 && num[y][x+1] == null) {\n\t\t\t\t\tString t = numCalc(matrix, x+1, y, w, h);\n\t\t\t\t\tif(!t.equals(\"-1\")) a1 = c + t;\n\t\t\t\t}\n\t\t\t\telse if(x < w-1 && !(num[y][x+1].equals(\"-1\"))) a1 = c + num[y][x+1];\n\t\t\t\tString a2 = null;\n\t\t\t\tif(y < h-1 && num[y+1][x] == null) {\n\t\t\t\t\tString t = numCalc(matrix, x, y+1, w, h);\n\t\t\t\t\tif(!t.equals(\"-1\")) a2 = c + t;\n\t\t\t\t}\n\t\t\t\telse if(y < h-1 && !(num[y+1][x].equals(\"-1\"))) a2 = c + num[y+1][x];\n\t\t\t\t\n\t\t\t\tif(a1 != null && a2 != null){\n\t\t\t\t\tnum[y][x] = compare(a1, a2);\n\t\t\t\t}\n\t\t\t\telse if(a1 == null && a2 == null) num[y][x] = c;\n\t\t\t\telse if(a1 == null) num[y][x] = a2;\n\t\t\t\telse num[y][x] = a1;\n\t\t\t}\n\t\t\telse num[y][x] = \"-1\";\n\t\t\treturn num[y][x];\n\t\t}\n\t}\n\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\nimport java.util.ArrayList;\nimport java.util.List;\npublic class Main\n{\n\tint W;\n\tint H;\n\tString[] C;\n\tint[][] table;\n\tList<String> ansList;\n\tprivate boolean isNum(char ch)\n\t{\n\t\tif(ch >= '0' && ch <= '9')return true;\n\t\treturn false;\n\t}\n\tprivate boolean isStrNum(String s)\n\t{\n\t\tif(s.charAt(0) == '0')return false;\n\t\treturn true;\n\t}\n\tprivate int strNumComp(char[] charA,char[] charB)\n\t{\n\t\tif(charA.length > charB.length)return 1;\n\t\tif(charA.length < charB.length)return -1;\n\t\t\n\t\tfor(int i = 0;i < charA.length;i++)\n\t\t{\n\t\t\tif(charA[i] == charB[i])continue;\n\t\t\tif(charA[i] > charB[i])return 1;\n\t\t\tif(charA[i] < charB[i])return -1;\n\t\t}\n\t\t\n\t\treturn 0;\n\t}\n\tprivate int strNumComp(String a,String b)\n\t{\n\t\tchar[] charA = a.toCharArray();\n\t\tchar[] charB = b.toCharArray();\n\t\t\n\t\tif(charA.length > charB.length)return 1;\n\t\tif(charA.length < charB.length)return -1;\n\t\t\n\t\tfor(int i = 0;i < charA.length;i++)\n\t\t{\n\t\t\tif(charA[i] == charB[i])continue;\n\t\t\tif(charA[i] > charB[i])return 1;\n\t\t\tif(charA[i] < charB[i])return -1;\n\t\t}\n\t\t\n\t\treturn 0;\n\t}\n\tprivate void dfs(int h,int w,String S)\n\t{\n\t\t/*if((table[h][w] == 0 || (h >= H - 1  && w >= W - 1))&& !S.isEmpty())\n\t\t{\n\t\t\tSystem.out.println(\"aaa\");\n\t\t\tansList.add(S);\n\t\t\treturn;\n\t\t}*/\n\t\t\n\t\tif(h + 1 < H && table[h + 1][w] > 0)\n\t\t{\n\t\t\tdfs(h + 1,w,S + C[h + 1].charAt(w));\n\t\t}\n\t\t\n\t\tif(w + 1 < W && table[h][w + 1] > 0)\n\t\t{\n\t\t\tdfs(h, w + 1,S + C[h].charAt(w + 1));\n\t\t}\n\t\t\n\t\tif(h + 1 < H && w + 1 < W && table[h + 1][w + 1] > 0)\n\t\t{\n\t\t\tdfs(h + 1,w + 1,S + C[h + 1].charAt(w + 1));\n\t\t}\n\t\t//System.out.println(S);\n\t\tansList.add(S);\n\t\treturn;\n\t}\n\tpublic void solve()\n\t{\n\t\tScanner cin = new Scanner(System.in);\n\t\twhile(true)\n\t\t{\n\t\t\tW = cin.nextInt();\n\t\t\tH = cin.nextInt();\n\t\t\tif(W == 0 && H == 0)break;\n\t\t\tC = new String[H];\n\t\t\tfor(int i = 0;i < H;i++)\n\t\t\t{\n\t\t\t\tC[i] = cin.next();\n\t\t\t}\n\t\t\ttable = new int[H][W];\n\t\t\tfor(int i = 0;i < H;i++)\n\t\t\t{\n\t\t\t\tfor(int j = 0;j < W;j++)\n\t\t\t\t{\n\t\t\t\t\tif(C[i].charAt(j) >= '0' && C[i].charAt(j) <= '9')table[i][j] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tint[] bin = new int[500];\n\t\t\tfor(int i = 0;i < H;i++)\n\t\t\t{\n\t\t\t\tfor(int j = 0;j < W;j++)\n\t\t\t\t{\n\t\t\t\t\tchar ch = C[i].charAt(j);\n\t\t\t\t\tif(isNum(ch))\n\t\t\t\t\t{\n\t\t\t\t\t\tif(j + 1 < W && isNum(C[i].charAt(j + 1)))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttable[i][j + 1] = Math.max(table[i][j] + 1,table[i][j + 1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(i + 1 < H && isNum(C[i + 1].charAt(j)))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttable[i + 1][j] = Math.max(table[i][j] + 1,table[i + 1][j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(i + 1 < H && j + 1 < W && isNum(C[i + 1].charAt(j + 1)))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttable[i + 1][j + 1] = Math.max(table[i][j] + 1,table[i + 1][j + 1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tansList = new ArrayList<String>();\n\t\t\tfor(int i = 0;i < H;i++)\n\t\t\t{\n\t\t\t\tfor(int j = 0;j < W;j++)\n\t\t\t\t{\n\t\t\t\t\tif(table[i][j] == 0)continue;\n\t\t\t\t\tif(isNum(C[i].charAt(j)))\n\t\t\t\t\t{\n\t\t\t\t\t\tdfs(i,j,C[i].charAt(j) + \"\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//System.out.println(ansList.size());\n\t\t\tString ans = \"\";\n\t\t\tfor(String s : ansList)\n\t\t\t{\n\t\t\t\tif(!isStrNum(s))continue;\n\t\t\t\tif(ans == \"\")\n\t\t\t\t{\n\t\t\t\t\tans = s;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(strNumComp(ans,s) == -1)\n\t\t\t\t{\n\t\t\t\t\tans = s;\n\t\t\t\t}\n\t\t\t\t//System.out.println(s);\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t\t/*for(int i = 0;i < H;i++)\n\t\t\t{\n\t\t\t\tfor(int j = 0;j < W;j++)\n\t\t\t\t{\n\t\t\t\t\tSystem.out.print(table[i][j] + \" \");\n\t\t\t\t}\n\t\t\t\tSystem.out.println();\n\t\t\t}*/\n\t\t}\n\t}\n\tpublic static void main(String[] args)\n\t{\n\t\tnew Main().solve();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.io.*;\nimport java.awt.geom.*;\nimport java.math.*;\n\npublic class Main {\n\n\tstatic final Scanner in = new Scanner(System.in);\n\tstatic final PrintWriter out = new PrintWriter(System.out,false);\n\tstatic boolean debug = false;\n\n\tstatic char[][] t;\n\tstatic int[] dx = {0, 1};\n\tstatic int[] dy = {1, 0};\n\n\tstatic String[][] dp;\n\tstatic int h, w;\n\n\tstatic String rec(int cy, int cx) {\n\t\tif (dp[cy][cx].length() > 0) return dp[cy][cx];\n\t\tString max = \"\";\n\t\tfor (int k=0; k<2; k++) {\n\t\t\tint ny = cy + dy[k];\n\t\t\tint nx = cx + dx[k];\n\t\t\tif (h <= ny || w <= nx) continue;\n\t\t\tif ('0' <= t[ny][nx] && t[ny][nx] <= '9') {\n\t\t\t\tString tmp = rec(ny, nx);\n\t\t\t\tif (tmp.length() > max.length()) max = tmp;\n\t\t\t\telse if (tmp.length() == max.length() && tmp.compareTo(max) > 0) max = tmp;\n\t\t\t}\n\t\t}\n\t\tif (max.equals(\"\")) return dp[cy][cx] = String.valueOf(t[cy][cx]);\n\t\treturn dp[cy][cx] = t[cy][cx] + max;\n\t}\n\n\tstatic boolean solve() {\n\t\tw = in.nextInt();\n\t\th = in.nextInt();\n\t\tif (w + h == 0) return false;\n\n\t\tt = new char[h][w];\n\t\tfor (int i=0; i<h; i++) {\n\t\t\tt[i] = in.next().toCharArray();\n\t\t}\n\n\t\tdp = new String[h][w];\n\t\tfor (int i=0; i<h; i++) {\n\t\t\tArrays.fill(dp[i], \"\");\n\t\t}\n\n\t\tString ans = \"\";\n\t\tfor (int i=0; i<h; i++) {\n\t\t\tfor (int j=0; j<w; j++) {\n\t\t\t\tif ('0' <= t[i][j] && t[i][j] <= '9') {\n\t\t\t\t\tString tmp = rec(i, j);\n\t\t\t\t\tint pos = 0;\n\t\t\t\t\twhile (pos < tmp.length() && tmp.charAt(pos) == '0') pos++;\n\t\t\t\t\ttmp = tmp.substring(pos, tmp.length());\n\t\t\t\t\tif (tmp.length() > ans.length()) ans = tmp;\n\t\t\t\t\telse if (tmp.length() == ans.length() && tmp.compareTo(ans) > 0) ans = tmp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tout.println(ans);\n\n\t\treturn true;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tdebug = args.length > 0;\n\t\tlong start = System.nanoTime();\n\n\t\twhile(solve());\n\t\tout.flush();\n\n\t\tlong end = System.nanoTime();\n\t\tdump((end - start) / 1000000 + \" ms\");\n\t\tin.close();\n\t\tout.close();\n\t}\n\n\tstatic void dump(Object... o) { if (debug) System.err.println(Arrays.deepToString(o)); }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.math.BigInteger;\n\npublic class Main{\n\tstatic int w,h;\n\tstatic int di[]={0,1}, dj[]={1,0};\n\tstatic char[][] map;\n\tstatic BigInteger max;\n\tstatic String[][] dp;\n\n\tpublic static String dfs(int i,int j){\n\t\tif(dp[i][j] != null) return dp[i][j];\n\n\t\tString s = Character.toString(map[i][j]);\n\t\tList<String> res = new ArrayList<String>();\n\t\tfor(int k=0;k<2;k++){\n\t\t\tint ni = i + di[k];\n\t\t\tint nj = j + dj[k];\n\n\t\t\tif(ni>=0 && ni<h && nj>=0 && nj<w && Character.isDigit(map[ni][nj])) res.add(dfs(ni,nj));\n\t\t}\n\n\t\tif(res.isEmpty()) return (dp[i][j]=s);\n\t\telse if(res.size() == 1) return (dp[i][j]=s+res.get(0));\n\t\telse{\n\t\t\tif(res.get(0).length() > res.get(1).length()) return (dp[i][j]=s+res.get(0));\n\t\t\telse if(res.get(0).length() < res.get(1).length()) return (dp[i][j]=s+res.get(1));\n\t\t\telse{\n\t\t\t\tif(new BigInteger(res.get(0)).compareTo(new BigInteger(res.get(1)))>0) return (dp[i][j]=s+res.get(0));\n\t\t\t\telse return (dp[i][j]=s+res.get(1));\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic static void main(String[] args){\n\t\tScanner sc = new Scanner(System.in);\n\t\tBigInteger res;\n\n\t\twhile(true){\n\t\t\tw = sc.nextInt();\n\t\t\th = sc.nextInt();\n\t\t\tif(w==0 && h==0) break;\n\t\t\tmap = new char[h][w];\n\t\t\tdp = new String[h][w];\n\t\t\tmax = BigInteger.ZERO;\n\n\t\t\tfor(int i=0;i<h;i++) map[i] = sc.next().toCharArray();\n\n\t\t\tfor(int i=0;i<h;i++){\n\t\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\t\tif(Character.isDigit(map[i][j])){\n\t\t\t\t\t\tres = new BigInteger(dfs(i,j));\n\t\t\t\t\t\tif(max.compareTo(res) < 0) max = res;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(max);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.ArrayList;\nimport java.util.Scanner;\npublic class Main {\n\tstatic int w;\n\tstatic int h;\n\tstatic String[][] map;\n\tpublic static void main(String[] args) {\n\t\tScanner stdIn = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tw = stdIn.nextInt();\n\t\t\th = stdIn.nextInt();\n\t\t\tif(w == 0 && h == 0) break;\n\t\t\tmap = new String[h][w];\n\t\t\tfor(int i = 0; i < h; i++) {\n\t\t\t\tString tmp = stdIn.next();\n\t\t\t\tfor(int j = 0; j < w; j++) {\n\t\t\t\t\tmap[i][j] = String.valueOf(tmp.charAt(j));\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tString ans = dp();\n\t\t\t\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\t\n\tpublic static String dp() {\n\t\tString ret = \"0\";\n\t\tfor(int i = h-1; i >= 0; i--) {\n\t\t\tfor(int j = w-1; j >= 0; j--) {\n\t\t\t\tint cx1 = j;\n\t\t\t\tint cy1 = i+1;\n\t\t\t\tint cx2 = j+1;\n\t\t\t\tint cy2 = i;\n\t\t\t\tif(!fC(map[i][j])) continue;\n\t\t\t\tString a = map[i][j];\n\t\t\t\tString b = map[i][j];\n\t\t\t\tif(cx1 < w && cy1 < h &&fC(map[cy1][cx1])) {\n\t\t\t\t\ta = map[i][j] + map[cy1][cx1];\n\t\t\t\t}\n\t\t\t\tif(cx2 < w && cy2 < h && fC(map[cy2][cx2])) {\n\t\t\t\t\tb = map[i][j] + map[cy2][cx2];\n\t\t\t\t}\n\t\t\t\tif(StComp(a,b)) {\n\t\t\t\t\tmap[i][j] = a;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tmap[i][j] = b;\n\t\t\t\t}\n\t\t\t\tif(!StComp(ret,map[i][j])) {\n\t\t\t\t\tret = map[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\treturn LV(ret);\n\t}\n\tpublic static String LV(String a) {\n\t\tString cp = a;\n\t\tfor(int i = 0; i < a.length(); i++) {\n\t\t\tif(cp.charAt(0) == '0') {\n\t\t\t\tcp = cp.substring(1, cp.length());\n\t\t\t}\n\t\t}\n\t\treturn cp;\n\t}\n\t// 数字の文字列比較　aがbより大きいか等しい場合trueを返す\n\tpublic static boolean fC(String a) {\n\t\tif(a.length() >= 2) {\n\t\t\treturn true;\n\t\t}\n\t\tfor(int i = 0; i < 10; i++) {\n\t\t\tif(a.charAt(0) == String.valueOf(i).charAt(0)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tpublic static boolean StComp(String a, String b) {\n\n\t\tif(a.length() > b.length()) return true;\n\t\tif(a.length() == b.length()) {\n\t\t\tif(a.compareTo(b) < 0) return false;\n\t\t\telse return true;\n\t\t}\n\t\treturn false;\n\t}\n}\n\t"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tif (w == 0 && h == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tchar[][] m = new char[h][];\n\t\t\tfor(int i=0;i<h;i++) {\n\t\t\t\tm[i] = sc.next().toCharArray();\n\t\t\t}\n\t\t\tBigInteger ans = BigInteger.ZERO;\n\t\t\tBigInteger[][] dp = new BigInteger[h][w];\n\t\t\tfor(int i=0;i<h;i++) {\n\t\t\t\tfor(int j=0;j<w;j++) {\n\t\t\t\t\tdp[i][j] = BigInteger.ZERO;\n\t\t\t\t\tif (!Character.isDigit(m[i][j])) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (i > 0) {\n\t\t\t\t\t\tdp[i][j] = dp[i-1][j].multiply(BigInteger.TEN).add(BigInteger.valueOf(m[i][j] - '0'));\n\t\t\t\t\t}\n\t\t\t\t\tif (j > 0) {\n\t\t\t\t\t\tdp[i][j] = dp[i][j].max(dp[i][j-1].multiply(BigInteger.TEN).add(BigInteger.valueOf(m[i][j] - '0')));\n\t\t\t\t\t}\n\t\t\t\t\tans = ans.max(dp[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tScanner sc = new Scanner(System.in);\n\tpublic void run() {\n\t\twhile(sc.hasNext()){\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tsc.nextLine();\n\t\t\tif(w == 0 && h == 0)break;\n\t\t\telse calc(w, h);\n\t\t\t\n\t\t}\n\t}\n\tpublic void calc(int w, int h){\n\t\tString[][] matrix = new String[h][w];\n\t\tfor(int i = 0; i < h; i++){\n\t\t\tString line = sc.nextLine();\n\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\tString c = line.substring(j, j+1);\n\t\t\t\tmatrix[i][j] = c;\n\t\t\t}\n\t\t}\n\t\tnum = new String[h][w];\n\t\tString max = \"0\";\n\t\tfor(int i = 0; i < w; i++){\n\t\t\tfor(int j = 0; j < h; j++){\n\t\t\t\tif(num[j][i] == null) numCalc(matrix, i, j, w, h);\n\t\t\t\tif(num[j][i] != \"-1\") max = compare(retNum(num[j][i]) , max);\n\t\t\t}\n\t\t}\n\t\tSystem.out.println(max);\n\t}\n\tString[][] num;\n\tpublic String retNum(String t){\n\t\tint size = t.length();\n\t\tfor(int i = 0; i < size - 1; i++){\n\t\t\tif(t.charAt(0) == '0') t = t.substring(1);\n\t\t\telse break;\n\t\t}\n\t\treturn t;\n\t}\n\t\n\tpublic String compare(String i, String j){\n\t\tif(i.length() > j.length()){\n\t\t\treturn i;\n\t\t}\n\t\telse if(i.length() < j.length()){\n\t\t\treturn j;\n\t\t}\n\t\telse if(i.compareTo(j) < 0) return j;\n\t\telse return i;\n\t}\n\tpublic String numCalc(String[][] matrix, int x, int y, int w, int h){\n\t\tif(num[y][x] != null) return num[y][x];\n\t\telse{\n\t\t\tString c = matrix[y][x];\n\t\t\tif(c.equals(\"0\") || c.equals(\"1\") || c.equals(\"2\") || c.equals(\"3\") || c.equals(\"4\")\n\t\t\t\t\t|| c.equals(\"5\") || c.equals(\"6\") || c.equals(\"7\") || c.equals(\"8\") || c.equals(\"9\")){\n\t\t\t\tString a1 = null;\n\t\t\t\tif(x < w-1 && num[y][x+1] == null) {\n\t\t\t\t\tString t = numCalc(matrix, x+1, y, w, h);\n\t\t\t\t\tif(!t.equals(\"-1\")) a1 = c + t;\n\t\t\t\t}\n\t\t\t\telse if(x < w-1 && !(num[y][x+1].equals(\"-1\"))) a1 = c + num[y][x+1];\n\t\t\t\tString a2 = null;\n\t\t\t\tif(y < h-1 && num[y+1][x] == null) {\n\t\t\t\t\tString t = numCalc(matrix, x, y+1, w, h);\n\t\t\t\t\tif(!t.equals(\"-1\")) a2 = c + t;\n\t\t\t\t}\n\t\t\t\telse if(y < h-1 && !(num[y+1][x].equals(\"-1\"))) a2 = c + num[y+1][x];\n\t\t\t\t\n\t\t\t\tif(a1 != null && a2 != null){\n\t\t\t\t\tnum[y][x] = compare(a1, a2);\n\t\t\t\t}\n\t\t\t\telse if(a1 == null && a2 == null) num[y][x] = c;\n\t\t\t\telse if(a1 == null) num[y][x] = a2;\n\t\t\t\telse num[y][x] = a1;\n\t\t\t}\n\t\t\telse num[y][x] = \"-1\";\n\t\t\treturn num[y][x];\n\t\t}\n\t}\n\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.Scanner;\n\n\npublic class Main {\n\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\t\n\t\twhile(true){\n\t\t\tfinal int W = sc.nextInt();\n\t\t\tfinal int H = sc.nextInt();\n\t\t\t\n\t\t\tif(W == 0  && H == 0){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tint[][] map = new int[H][W];\n\t\t\t\n\t\t\tfor(int i = 0; i < H; i++){\n\t\t\t\tchar[] input = sc.next().toCharArray();\n\t\t\t\t\n\t\t\t\tfor(int j = 0; j < W; j++){\n\t\t\t\t\tif('0' <= input[j] && input[j] <= '9'){\n\t\t\t\t\t\tmap[i][j] = input[j] - '0';\n\t\t\t\t\t}else{\n\t\t\t\t\t\tmap[i][j] = -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint[][] len = new int[H][W];\n\t\t\tshort[][][] dp = new short[H][W][H+W+1];\n\t\t\t\n\t\t\tint max = 0;\n\t\t\tint m_x = -1;\n\t\t\tint m_y = -1;\n\t\t\t\n\t\t\tfor(int i = 0; i < H; i++){\n\t\t\t\tfor(int j = 0; j < W; j++){\n\t\t\t\t\tif(map[i][j] < 0){\n\t\t\t\t\t\tdp[i][j][0] = -1;\n\t\t\t\t\t\tlen[i][j] = -1;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(i == 0 && j == 0){\n\t\t\t\t\t\tdp[i][j][0] = (short)(map[i][j]);\n\t\t\t\t\t\tlen[i][j] = map[i][j] == 0 ? 0 : 1;\n\t\t\t\t\t}else if(j == 0){\n\t\t\t\t\t\tfinal int p_len = len[i-1][j];\n\t\t\t\t\t\tif(p_len == -1){\n\t\t\t\t\t\t\tdp[i][j][0] = (short)(map[i][j]);\n\t\t\t\t\t\t\tlen[i][j] = map[i][j] == 0 ? 0 : 1;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tSystem.arraycopy(dp[i-1][j], 0, dp[i][j], 0, p_len);\n\t\t\t\t\t\t\tdp[i][j][p_len] = (short)(map[i][j]);\n\t\t\t\t\t\t\tlen[i][j] = p_len +  (p_len == 0 && map[i][j] == 0 ? 0 : 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else if(i == 0){\n\t\t\t\t\t\tfinal int p_len = len[i][j-1];\n\t\t\t\t\t\tif(p_len == -1){\n\t\t\t\t\t\t\tdp[i][j][0] = (short)(map[i][j]);\n\t\t\t\t\t\t\tlen[i][j] = map[i][j] == 0 ? 0 : 1;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tSystem.arraycopy(dp[i][j-1], 0, dp[i][j], 0, p_len);\n\t\t\t\t\t\t\tdp[i][j][p_len] = (short)(map[i][j]);\n\t\t\t\t\t\t\tlen[i][j] = p_len + (p_len == 0 && map[i][j] == 0 ? 0 : 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tfinal int left_len = len[i][j-1];\n\t\t\t\t\t\tfinal int up_len = len[i-1][j];\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(left_len == -1 && up_len == -1){\n\t\t\t\t\t\t\tdp[i][j][0] = (short)(map[i][j]);\n\t\t\t\t\t\t\tlen[i][j] = map[i][j] == 0 ? 0 : 1;\n\t\t\t\t\t\t}else if(left_len > up_len){\n\t\t\t\t\t\t\tfinal int p_len = len[i][j-1];\n\t\t\t\t\t\t\tSystem.arraycopy(dp[i][j-1], 0, dp[i][j], 0, p_len);\n\t\t\t\t\t\t\tdp[i][j][p_len] = (short)(map[i][j]);\n\t\t\t\t\t\t\tlen[i][j] = p_len + (p_len == 0 && map[i][j] == 0 ? 0 : 1);\n\t\t\t\t\t\t}else if(left_len < up_len){\n\t\t\t\t\t\t\tfinal int p_len = len[i-1][j];\n\t\t\t\t\t\t\tSystem.arraycopy(dp[i-1][j], 0, dp[i][j], 0, p_len);\n\t\t\t\t\t\t\tdp[i][j][p_len] = (short)(map[i][j]);\n\t\t\t\t\t\t\tlen[i][j] = p_len + (p_len == 0 && map[i][j] == 0 ? 0 : 1);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tfinal int size = len[i][j-1];\n\t\t\t\t\t\t\tboolean left_f = true;\n\t\t\t\t\t\t\tfor(int k = 0; k < size; k++){\n\t\t\t\t\t\t\t\tif(dp[i-1][j][k] < dp[i][j-1][k]){\n\t\t\t\t\t\t\t\t\tleft_f = true;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}else if(dp[i-1][j][k] > dp[i][j-1][k]){\n\t\t\t\t\t\t\t\t\tleft_f = false;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(left_f){\n\t\t\t\t\t\t\t\tfinal int p_len = len[i][j-1];\n\t\t\t\t\t\t\t\tSystem.arraycopy(dp[i][j-1], 0, dp[i][j], 0, p_len);\n\t\t\t\t\t\t\t\tdp[i][j][p_len] = (short)(map[i][j]);\n\t\t\t\t\t\t\t\tlen[i][j] = p_len + (p_len == 0 && map[i][j] == 0 ? 0 : 1);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tfinal int p_len = len[i-1][j];\n\t\t\t\t\t\t\t\tSystem.arraycopy(dp[i-1][j], 0, dp[i][j], 0, p_len);\n\t\t\t\t\t\t\t\tdp[i][j][p_len] = (short)(map[i][j]);\n\t\t\t\t\t\t\t\tlen[i][j] = p_len + (p_len == 0 && map[i][j] == 0 ? 0 : 1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(max < len[i][j]){\n\t\t\t\t\t\tmax = len[i][j];\n\t\t\t\t\t\tm_x = j;\n\t\t\t\t\t\tm_y = i;\n\t\t\t\t\t}else if(max == len[i][j]){\n\t\t\t\t\t\tfinal int size = len[i][j];\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor(int k = 0; k < size; k++){\n\t\t\t\t\t\t\tif(dp[m_y][m_x][k] < dp[i][j][k]){\n\t\t\t\t\t\t\t\tmax = len[i][j];\n\t\t\t\t\t\t\t\tm_x = j;\n\t\t\t\t\t\t\t\tm_y = i;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}else if(dp[m_y][m_x][k] > dp[i][j][k]){\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\t\n\t\t\t}\n\t\t\t/*\n\t\t\tfor(int i = 0; i < H; i++){\n\t\t\t\tfor(int j = 0; j < W; j++){\n\t\t\t\t\tSystem.out.printf(\"%2d \", len[i][j]);\n\t\t\t\t}\n\t\t\t\tSystem.out.println();\n\t\t\t}\n\t\t\t*/\n\t\t\tfor(int i = 0; i < max; i++){\n\t\t\t\tSystem.out.print(dp[m_y][m_x][i]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t\t\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\n  Scanner sc;\n\n  Main() {\n    sc = new Scanner(System.in);\n  }\n\n  int ni() {\n    return sc.nextInt();\n  }\n\n  public static void main(String[] args) {\n    new Main().run();\n  }\n\n  int w, h;\n  char[][] c;\n\n  static int[][] ofs = {\n      {1, 0},\n      {0, 1}\n  };\n\n  String[][] done;\n\n  String dfs(int x, int y, String num) {\n    if (x >= w) {\n      return \"\";\n    }\n    if (y >= h) {\n      return \"\";\n    }\n    if (c[y][x] < '0' || '9' < c[y][x]) {\n      return num;\n    }\n    num += c[y][x];\n    if (new BigInteger(done[y][x]).compareTo(new BigInteger(num)) > 0) {\n      return \"\";\n    }\n    done[y][x] = num;\n    String res = num;\n    for (int i = 0; i < 2; ++i) {\n      int nx = x + ofs[i][0];\n      int ny = y + ofs[i][1];\n      String nnum = dfs(nx, ny, num);\n      if (res.length() < nnum.length()) {\n        res = nnum;\n      } else if (res.length() == nnum.length() &&\n          new BigInteger(res).compareTo(new BigInteger(nnum)) < 0) {\n        res = new BigInteger(nnum).toString();\n      }\n    }\n    return res;\n  }\n\n  void run() {\n    for (; ; ) {\n      w = ni();\n      h = ni();\n      if ((w | h) == 0) {\n        break;\n      }\n      c = new char[h][w];\n      done = new String[h][w];\n      for (int i = 0; i < h; ++i) {\n        String line = sc.next();\n        for (int j = 0; j < w; ++j) {\n          c[i][j] = line.charAt(j);\n          done[i][j] = \"0\";\n        }\n      }\n      String ans = \"0\";\n      for (int i = 0; i < h; ++i) {\n        for (int j = 0; j < w; ++j) {\n          String sans = dfs(j, i, \"\");\n          if (sans.length() > ans.length()) {\n            ans = sans;\n          } else if (sans.length() == ans.length()) {\n            if (new BigInteger(ans).compareTo(new BigInteger(sans)) < 0) {\n              ans = sans;\n            }\n          }\n        }\n      }\n      System.out.println(ans);\n    }\n  }\n\n  void debug(Object... os) {\n    System.err.println(Arrays.deepToString(os));\n  }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.*;\n\nimport static java.lang.Integer.parseInt;\n\n/**\n * The Secret Number\n */\npublic class Main {\n\n\tstatic char[][] num;\n\tstatic String max;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line;\n\t\tString[] words;\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\n\t\t\tint W, H;\n\t\t\tW = parseInt(line.substring(0, line.indexOf(' ')));\n\t\t\tH = parseInt(line.substring(line.indexOf(' ') + 1));\n\t\t\tif ((W | H) == 0) break;\n\n\t\t\tnum = new char[H + 2][W + 2];\n\n\t\t\tfor (int i = 0; i < num.length; i++) {\n\t\t\t\tArrays.fill(num[i], 'X');\n\t\t\t}\n\n\t\t\tmax = \"\";\n\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tline = br.readLine();\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tchar c = line.charAt(j);\n\t\t\t\t\tnum[i + 1][j + 1] = (c <= '9' ? c : 'X');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//\n\t\t\tfor (int i = 1; i <= H; i++) {\n\t\t\t\tfor (int j = 1; j <= W; j++) {\n\t\t\t\t\tif (num[i][j] != 'X' && num[i - 1][j] == 'X' && num[i][j - 1] == 'X') {\n\t\t\t\t\t\tsolve(i, j, \"\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tSystem.out.println(max);\n\n\t\t} //end while\n\t} //end main\n\n\tstatic void solve(int y, int x, String s) {\n\n\t\tif (!(s.equals(\"\") && num[y][x] == '0')) {\n\t\t\ts += num[y][x];\n\t\t}\n\n\t\tif (num[y + 1][x] == 'X' && num[y][x + 1] == 'X') {\n\t\t\tif (max.length() < s.length()) {\n\t\t\t\tmax = s;\n\t\t\t} else if (max.length() == s.length()) {\n\t\t\t\tfor (int i = 0; i < s.length(); i++) {\n\t\t\t\t\tif (s.charAt(i) > max.charAt(i)) {\n\t\t\t\t\t\tmax = s;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else if (s.charAt(i) < max.charAt(i)) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (num[y + 1][x] != 'X') solve(y + 1, x, s);\n\t\tif (num[y][x + 1] != 'X') solve(y, x + 1, s);\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "public class Main {\n\tMyScanner sc = new MyScanner();\n\tScanner sc2 = new Scanner(System.in);\n\tint mod = 1000000007;\n\n\tint[] dx = { 1, 0 };\n\tint[] dy = { 0, 1 };\n\n\tvoid run() {\n\t\tfor (;;) {\n\t\t\tint W = sc.nextInt();\n\t\t\tint H = sc.nextInt();\n\t\t\tif ((W | H) == 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tchar[][] field = new char[H][W];\n\t\t\tboolean[][] visit = new boolean[H][W];\n\t\t\tBigInteger[][] maxHist = new BigInteger[H][W];\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tString input = sc.next();\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tfield[i][j] = input.charAt(j);\n\t\t\t\t\tmaxHist[i][j] = new BigInteger(\"0\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tQueue<Point> que = new LinkedList<Point>();\n\t\t\tBigInteger ans = new BigInteger(\"0\");\n\t\t\tBigInteger tmp = new BigInteger(\"0\");\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tif (Character.isDigit(field[i][j]) && !visit[i][j]) {\n\t\t\t\t\t\tque.add(new Point(j, i, (field[i][j] + \"\")));\n\t\t\t\t\t\twhile (!que.isEmpty()) {\n\t\t\t\t\t\t\tint size = que.size();\n\t\t\t\t\t\t\tfor (int k = 0; k < size; k++) {\n\t\t\t\t\t\t\t\tPoint now = que.poll();\n\t\t\t\t\t\t\t\ttmp = new BigInteger(now.number);\n\t\t\t\t\t\t\t\tif(tmp.compareTo(maxHist[now.h][now.w]) <=0) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tans = ans.max(tmp);\n\t\t\t\t\t\t\t\tmaxHist[now.h][now.w] = ans;\n\n\t\t\t\t\t\t\t\tint nowH = now.h;\n\t\t\t\t\t\t\t\tint nowW = now.w;\n\t\t\t\t\t\t\t\tvisit[nowH][nowW] = true;\n\t\t\t\t\t\t\t\tString nowNum = now.number;\n\t\t\t\t\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\t\t\t\t\tint nextH = nowH + dy[l];\n\t\t\t\t\t\t\t\t\tint nextW = nowW + dx[l];\n\t\t\t\t\t\t\t\t\tif (nextH < H\n\t\t\t\t\t\t\t\t\t\t\t&& nextW < W\n\t\t\t\t\t\t\t\t\t\t\t&& Character\n\t\t\t\t\t\t\t\t\t\t\t\t\t.isDigit(field[nextH][nextW])) {\n\t\t\t\t\t\t\t\t\t\tque.add(new Point(nextW, nextH, nowNum\n\t\t\t\t\t\t\t\t\t\t\t\t+ \"\" + field[nextH][nextW]));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\n\tclass Point {\n\t\tint w;\n\t\tint h;\n\t\tString number;\n\n\t\t/**\n\t\t * @param w\n\t\t * @param h\n\t\t */\n\t\tpublic Point(int w, int h, String number) {\n\t\t\tsuper();\n\t\t\tthis.w = w;\n\t\t\tthis.h = h;\n\t\t\tthis.number = number;\n\t\t}\n\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid debug(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n\n\tvoid debug2(char[][] array) {\n\t\tfor (int i = 0; i < array.length; i++) {\n\t\t\tfor (int j = 0; j < array[i].length; j++) {\n\t\t\t\tSystem.out.print(array[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tclass MyScanner {\n\t\tint nextInt() {\n\t\t\ttry {\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (c != '-' && (c < '0' || '9' < c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tif (c == '-')\n\t\t\t\t\treturn -nextInt();\n\t\t\t\tint res = 0;\n\t\t\t\tdo {\n\t\t\t\t\tres *= 10;\n\t\t\t\t\tres += c - '0';\n\t\t\t\t\tc = System.in.read();\n\t\t\t\t} while ('0' <= c && c <= '9');\n\t\t\t\treturn res;\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tString next() {\n\t\t\ttry {\n\t\t\t\tStringBuilder res = new StringBuilder(\"\");\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (Character.isWhitespace(c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tdo {\n\t\t\t\t\tres.append((char) c);\n\t\t\t\t} while (!Character.isWhitespace(c = System.in.read()));\n\t\t\t\treturn res.toString();\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n \n \npublic class Main {\n    Scanner in = new Scanner(System.in);\n    char[][] map;\n     \n    String compare(String s1, String s2) {\n        if (s1.length() > s2.length()) return s1;\n        else if (s1.length() < s2.length()) return s2;\n        else {\n            for (int i = 0; i < s1.length(); i++) {\n                if (s1.charAt(i) > s2.charAt(i)) return s1;\n                else if (s1.charAt(i) < s2.charAt(i)) return s2;\n            }\n        }\n        return s1;\n    }\n     \n    public String recursive(int x, int y, String ans) {\n        if ((map[y][x] >= 'A' && map[y][x] <= 'Z') || map[y][x] == 0) return \"\";\n        ans += map[y][x] + \"\";\n        String s1 = recursive(x+1, y, ans);\n        String s2 = recursive(x, y+1, ans);\n        String a = compare(s1, s2);\n        return (a.equals(\"\")) ? ans : a;\n    }\n     \n    public Main() {\n        while (true) {\n            int m = in.nextInt();\n            int n = in.nextInt();\n            if (m == 0 && n == 0) break;\n            map = new char[n+1][m+1];\n            for (int i = 0; i < n; i++) {\n                String s = in.next();\n                for (int j = 0; j < m; j++) {\n                    map[i][j] = s.charAt(j);\n                }\n            }\n            String ans = \"\";\n            for (int i = 0; i < m; i++) {\n                for (int j = 0; j < 1; j++) {\n                    String temp = recursive(i, j, \"\");\n                    int k;\n                    for (k = 0; k < temp.length(); k++) {\n                        if (temp.charAt(k) != '0') break;\n                    }\n                    temp = temp.substring(k, temp.length());\n                    ans = compare(temp, ans);\n                }\n            }\n            System.out.println(ans);\n        }\n    }\n     \n    public static void main(String[] args) {\n        new Main();\n    }\n \n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.Scanner;\n\n//The Secret Number\npublic class Main{\n\n\tvoid run(){\n\t\tScanner sc = new Scanner(System.in);\n\t\tfor(;;){\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tif((w|h)==0)break;\n\t\t\tchar[][] m = new char[h][w];\n\t\t\tfor(int i=0;i<h;i++)m[i]=sc.next().toCharArray();\n\t\t\tString[][] dp = new String[h][w];\n\t\t\tString res = \"0\";\n\t\t\tfor(int i=h-1;i>=0;i--)for(int j=w-1;j>=0;j--){\n\t\t\t\tif(Character.isUpperCase(m[i][j]))continue;\n\t\t\t\tString l = m[i][j]+\"\";\n\t\t\t\tString d = m[i][j]+\"\";\n\t\t\t\tif(i+1<h&&!Character.isUpperCase(m[i+1][j]))d+=dp[i+1][j];\n\t\t\t\tif(j+1<w&&!Character.isUpperCase(m[i][j+1]))l+=dp[i][j+1];\n\t\t\t\tif(l.length()!=d.length()){\n\t\t\t\t\tdp[i][j] = l.length()>d.length()?l:d;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tBigInteger bl = new BigInteger(l);\n\t\t\t\t\tBigInteger bd = new BigInteger(d);\n\t\t\t\t\tif(bl.compareTo(bd)>0)dp[i][j] = l;\n\t\t\t\t\telse dp[i][j] = d;\n\t\t\t\t}\n\t\t\t\tBigInteger b = new BigInteger(dp[i][j]);\n\t\t\t\tif(b.compareTo(new BigInteger(res))>0){\n\t\t\t\t\tres = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(new BigInteger(res).toString());\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.ArrayList;\nimport java.util.Scanner;\npublic class Main {\n\tstatic int w;\n\tstatic int h;\n\tstatic String[][] map;\n\tpublic static void main(String[] args) {\n\t\tScanner stdIn = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tw = stdIn.nextInt();\n\t\t\th = stdIn.nextInt();\n\t\t\tif(w == 0 && h == 0) break;\n\t\t\tmap = new String[h][w];\n\t\t\tfor(int i = 0; i < h; i++) {\n\t\t\t\tString tmp = stdIn.next();\n\t\t\t\tfor(int j = 0; j < w; j++) {\n\t\t\t\t\tmap[i][j] = String.valueOf(tmp.charAt(j));\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tString ans = dp();\n\t\t\t\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\t\n\tpublic static String dp() {\n\t\tString ret = \"0\";\n\t\tfor(int i = h-1; i >= 0; i--) {\n\t\t\tfor(int j = w-1; j >= 0; j--) {\n\t\t\t\tint cx1 = j;\n\t\t\t\tint cy1 = i+1;\n\t\t\t\tint cx2 = j+1;\n\t\t\t\tint cy2 = i;\n\t\t\t\tif(!fC(map[i][j])) continue;\n\t\t\t\tString a = map[i][j];\n\t\t\t\tString b = map[i][j];\n\t\t\t\tif(cx1 < w && cy1 < h &&fC(map[cy1][cx1])) {\n\t\t\t\t\ta = map[i][j] + map[cy1][cx1];\n\t\t\t\t}\n\t\t\t\tif(cx2 < w && cy2 < h && fC(map[cy2][cx2])) {\n\t\t\t\t\tb = map[i][j] + map[cy2][cx2];\n\t\t\t\t}\n\t\t\t\tif(StComp(a,b)) {\n\t\t\t\t\tmap[i][j] = a;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tmap[i][j] = b;\n\t\t\t\t}\n\t\t\t\tif(!StComp(ret,LV(map[i][j]))) {\n\t\t\t\t\tret = map[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\treturn LV(ret);\n\t}\n\tpublic static String LV(String a) {\n\t\tString cp = a;\n\t\tfor(int i = 0; i < a.length(); i++) {\n\t\t\tif(cp.charAt(0) == '0') {\n\t\t\t\tcp = cp.substring(1, cp.length());\n\t\t\t}\n\t\t}\n\t\treturn cp;\n\t}\n\t// 数字の文字列比較　aがbより大きいか等しい場合trueを返す\n\tpublic static boolean fC(String a) {\n\t\tif(a.length() >= 2) {\n\t\t\treturn true;\n\t\t}\n\t\tfor(int i = 0; i < 10; i++) {\n\t\t\tif(a.charAt(0) == String.valueOf(i).charAt(0)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tpublic static boolean StComp(String a, String b) {\n\n\t\tif(a.length() > b.length()) return true;\n\t\tif(a.length() == b.length()) {\n\t\t\tif(a.compareTo(b) < 0) return false;\n\t\t\telse return true;\n\t\t}\n\t\treturn false;\n\t}\n}\n\t"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport static java.lang.System.*;\n\npublic class Main {\n\n\tScanner sc = new Scanner(in);\n\t\n\tint compare(String s1, String s2) {\n\t\tif (s1.length() == 0 && s2.length() == 0) return 0;\n\t\tif (s1.length() == 0) return -1;\n\t\tif (s2.length() == 0) return 1;\n\t\t\n\t\tint c1, c2;\n\t\tc1 = c2 = 0;\n\t\tint index = 0;\n\t\twhile (index < s1.length() && s1.charAt(index) == '0') {\n\t\t\tc1++;\n\t\t\tindex++;\n\t\t}\n\t\tindex = 0;\n\t\twhile (index < s2.length() &&s2.charAt(index) == '0') {\n\t\t\tc2++;\n\t\t\tindex++;\n\t\t}\n\t\tif (s1.length()-c1 > s2.length() -c2) return 1;\n\t\telse if (s1.length()-c1 < s2.length() -c2) return -1;\n\t\t\n\t\treturn s1.substring(c1).compareTo(s2.substring(c2));\n\t}\n\t\n\tvoid run() {\n\t\twhile (true) {\n\t\t\tint w = sc.nextInt(), h = sc.nextInt();\n\t\t\tif (w == 0 && h == 0) return;\n\t\t\tsc.nextLine();\n\t\t\tint[][] mat = new int[h][w];\n\t\t\tString[][] dp = new String[h+1][w+1];\n\t\t\t\n\t\t\tfor (int i = 0; i < h; i++) {\n\t\t\t\tString s = sc.nextLine();\n\t\t\t\tfor (int j = 0; j < w; j++) {\n\t\t\t\t\tif (Character.isDigit(s.charAt(j))) {\n\t\t\t\t\t\tmat[i][j] = Character.getNumericValue(s.charAt(j));\n\t\t\t\t\t\tdp[i][j] = String.valueOf(s.charAt(j));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmat[i][j] = -1;\n\t\t\t\t\t\tdp[i][j] = \"\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\tfor (int i = 0; i <= w; i++) dp[h][i] = \"\";\n\t\t\tfor (int i = 0; i <= h; i++) dp[i][w] = \"\";\n\t\t\t\n\t\t\tString ans = \"\";\n\t\t\tfor (int i = h-1; i >= 0; i--) {\n\t\t\t\tfor (int j = w-1; j >= 0; j--) {\n\t\t\t\t\tif (mat[i][j] >= 0) {\n\t\t\t\t\t\tif (compare(dp[i+1][j], dp[i][j+1]) > 0)\n\t\t\t\t\t\t\tdp[i][j] = dp[i][j] + dp[i+1][j];\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tdp[i][j] = dp[i][j] + dp[i][j+1];\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (compare(dp[i][j], ans) > 0)\n\t\t\t\t\t\t\tans = dp[i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint index = 0, c = 0;\n\t\t\twhile (ans.charAt(index) == '0') {\n\t\t\t\tc++;\n\t\t\t\tindex++;\n\t\t\t}\n\t\t\t\n\t\t\tout.println(ans.substring(c));\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "\nimport java.math.BigInteger;\nimport java.util.*;\nimport static java.lang.System.*;\n\nclass Main {\n\tpublic static Scanner sc = new Scanner(in);\n\tpublic static Random rand=new Random();\n\n\tpublic void run() {\n\t\tTCase:while(true){\n\t\t\tint W=sc.nextInt(),H=sc.nextInt();\n\t\t\tif(W==0 && H==0)return;\n\t\t\tchar[][] map=new char[H][W];\n\n\t\t\tfor(int h=0;h<H;h++){\n\t\t\t\tmap[h]=sc.next().toCharArray();\n\t\t\t}\n\n\t\t\tBigInteger[][] dp=new BigInteger[H][W];\n\n\t\t\tfor(int h=0;h<H;h++)for(int w=0;w<W;w++){\n\t\t\t\tBigInteger hprev=BigInteger.ZERO;\n\t\t\t\tif(h>=1){\n\t\t\t\t\thprev=dp[h-1][w];\n\t\t\t\t}\n\t\t\t\tBigInteger wprev=BigInteger.ZERO;\n\t\t\t\tif(w>=1){\n\t\t\t\t\twprev=dp[h][w-1];\n\t\t\t\t}\n\t\t\t\tif(Character.isDigit(map[h][w])){\n\t\t\t\t\tBigInteger max;\n\t\t\t\t\tif(hprev.compareTo(wprev)>0){\n\t\t\t\t\t\tmax=hprev;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tmax=wprev;\n\t\t\t\t\t}\n\t\t\t\t\tdp[h][w]=max.multiply(BigInteger.TEN).add(new BigInteger(map[h][w]+\"\"));\n\t\t\t\t}else{\n\t\t\t\t\tdp[h][w]=BigInteger.ZERO;\n\t\t\t\t}\n\t\t\t}\n\t\t\tBigInteger max=BigInteger.ZERO;\n\t\t\tfor(int h=0;h<H;h++)for(int w=0;w<W;w++){\n\t\t\t\tif(dp[h][w].compareTo(max)>0)max=dp[h][w];\n\t\t\t}\n\t\t\tln(max);\n\t\t}\n\t}\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic int[] nextIntArray(int n){\n\t\tint[] res=new int[n];\n\t\tfor(int i=0;i<n;i++){\n\t\t\tres[i]=sc.nextInt();\n\t\t}\n\t\treturn res;\n\t}\n\tpublic static void pr(Object o) {\n\t\tout.print(o);\n\t}\n\tpublic static void ln(Object o) {\n\t\tout.println(o);\n\t}\n\tpublic static void ln() {\n\t\tout.println();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.math.*;\n\nclass Main{\n\tstatic int field[][];\n\tstatic BigInteger val[][];\n\tstatic int a,b;\n\tpublic static void main(String args[]){\n\t\tScanner s=new Scanner(System.in);\n\n\t\twhile(true){\n\t\t\tb=s.nextInt();\n\t\t\ta=s.nextInt();\n\t\t\tif(a==0)System.exit(0);\n\t\t\t\n\t\t\tfield=new int[a][b];\n\t\t\tval=new BigInteger[a][b];\n\t\t\tfor(int i=0;i<a;i++){\n\t\t\t\tString line=s.next();\n\t\t\t\tfor(int j=0;j<b;j++){\n\t\t\t\t\tif(line.charAt(j)>='A')field[i][j]=-1;\n\t\t\t\t\telse field[i][j]=(int)line.charAt(j)-'0';\n\t\t\t\t\tval[i][j]=new BigInteger(\"-1\");\n\t\t\t\t}\n\t\t\t}\n\t\t\n\t\t\tBigInteger ans=new BigInteger(\"0\");\n\t\t\tfor(int i=0;i<a;i++)\n\t\t\t\tfor(int j=0;j<b;j++){\n\t\t\t\t\tans=ans.max(solve(i,j));\n\t\t\t\t}\n\t\t\t\n\t\t\tSystem.out.println(ans.toString());\n\t\t}\n\t}\n\t\n\tstatic BigInteger solve(int m,int n){\n\t\tBigInteger shita=new BigInteger(\"0\");\n\t\tBigInteger migi=new BigInteger(\"0\");\n\t\t\n\t\tif(!val[m][n].equals(new BigInteger(\"-1\")))return val[m][n];\n\t\tif(field[m][n]==-1)return new BigInteger(\"-1\");\n\t\tif(m>0&&field[m-1][n]!=-1)migi=solve(m-1,n);\n\t\tif(n>0&&field[m][n-1]!=-1)shita=solve(m,n-1);\n\t\tBigInteger ret=shita.max(migi).multiply(BigInteger.TEN).add(new BigInteger(String.valueOf(field[m][n])));\n\t\tif(ret.equals(BigInteger.ZERO))ret=new BigInteger(String.valueOf(field[m][n]));\n\t\tval[m][n]=ret;\n\t\t//System.out.println(ret.toString());\n\t\treturn ret;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.Arrays;\nimport java.util.LinkedList;\nimport java.util.Queue;\nimport java.util.Scanner;\n\npublic class Main {\n\tMyScanner sc = new MyScanner();\n\tScanner sc2 = new Scanner(System.in);\n\tint mod = 1000000007;\n\n\tint[] dx = { 1, 0 };\n\tint[] dy = { 0, 1 };\n\n\tvoid run() {\n\t\tfor (;;) {\n\t\t\tint W = sc.nextInt();\n\t\t\tint H = sc.nextInt();\n\t\t\tif ((W | H) == 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tchar[][] field = new char[H][W];\n\t\t\tboolean[][] visit = new boolean[H][W];\n\t\t\tBigInteger[][] maxHist = new BigInteger[H][W];\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tString input = sc.next();\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tfield[i][j] = input.charAt(j);\n\t\t\t\t\tmaxHist[i][j] = new BigInteger(\"0\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tQueue<Point> que = new LinkedList<Point>();\n\t\t\tBigInteger ans = new BigInteger(\"0\");\n\t\t\tBigInteger tmp = new BigInteger(\"0\");\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tif (Character.isDigit(field[i][j]) && !visit[i][j]) {\n\t\t\t\t\t\tque.add(new Point(j, i, (field[i][j] + \"\")));\n\t\t\t\t\t\twhile (!que.isEmpty()) {\n\t\t\t\t\t\t\tint size = que.size();\n\t\t\t\t\t\t\tfor (int k = 0; k < size; k++) {\n\t\t\t\t\t\t\t\tPoint now = que.poll();\n\t\t\t\t\t\t\t\ttmp = new BigInteger(now.number);\n\t\t\t\t\t\t\t\tif(tmp.compareTo(maxHist[now.h][now.w]) <=0) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tans = ans.max(tmp);\n\t\t\t\t\t\t\t\tmaxHist[now.h][now.w] = ans;\n\n\t\t\t\t\t\t\t\tint nowH = now.h;\n\t\t\t\t\t\t\t\tint nowW = now.w;\n\t\t\t\t\t\t\t\tvisit[nowH][nowW] = true;\n\t\t\t\t\t\t\t\tString nowNum = now.number;\n\t\t\t\t\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\t\t\t\t\tint nextH = nowH + dy[l];\n\t\t\t\t\t\t\t\t\tint nextW = nowW + dx[l];\n\t\t\t\t\t\t\t\t\tif (nextH < H\n\t\t\t\t\t\t\t\t\t\t\t&& nextW < W\n\t\t\t\t\t\t\t\t\t\t\t&& Character\n\t\t\t\t\t\t\t\t\t\t\t\t\t.isDigit(field[nextH][nextW])) {\n\t\t\t\t\t\t\t\t\t\tque.add(new Point(nextW, nextH, nowNum\n\t\t\t\t\t\t\t\t\t\t\t\t+ \"\" + field[nextH][nextW]));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\n\tclass Point {\n\t\tint w;\n\t\tint h;\n\t\tString number;\n\n\t\t/**\n\t\t * @param w\n\t\t * @param h\n\t\t */\n\t\tpublic Point(int w, int h, String number) {\n\t\t\tsuper();\n\t\t\tthis.w = w;\n\t\t\tthis.h = h;\n\t\t\tthis.number = number;\n\t\t}\n\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew AOJ_1126().run();\n\t}\n\n\tvoid debug(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n\n\tvoid debug2(char[][] array) {\n\t\tfor (int i = 0; i < array.length; i++) {\n\t\t\tfor (int j = 0; j < array[i].length; j++) {\n\t\t\t\tSystem.out.print(array[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tclass MyScanner {\n\t\tint nextInt() {\n\t\t\ttry {\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (c != '-' && (c < '0' || '9' < c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tif (c == '-')\n\t\t\t\t\treturn -nextInt();\n\t\t\t\tint res = 0;\n\t\t\t\tdo {\n\t\t\t\t\tres *= 10;\n\t\t\t\t\tres += c - '0';\n\t\t\t\t\tc = System.in.read();\n\t\t\t\t} while ('0' <= c && c <= '9');\n\t\t\t\treturn res;\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tString next() {\n\t\t\ttry {\n\t\t\t\tStringBuilder res = new StringBuilder(\"\");\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (Character.isWhitespace(c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tdo {\n\t\t\t\t\tres.append((char) c);\n\t\t\t\t} while (!Character.isWhitespace(c = System.in.read()));\n\t\t\t\treturn res.toString();\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\n\tstatic int[][] field;\n\tstatic String[][] dp;\n\tstatic int h,w;\n\tpublic static void main(String[] args) {\n\t\tScanner cin = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tw = cin.nextInt();\n\t\t\th = cin.nextInt();\n\t\t\tif(w+h==0)break;\n\t\t\tfield=new int[h][w];\n\t\t\tdp=new String[h][w];\n\t\t\tfor(int i = 0;i<h;i++){\n\t\t\t\tString s = cin.next();\n\t\t\t\tfor(int j = 0;j<w;j++){\n\t\t\t\t\tdp[i][j]=\"\";\n\t\t\t\t\tif(Character.isDigit(s.charAt(j))){\n\t\t\t\t\t\tfield[i][j]=s.charAt(j)-'0';\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tfield[i][j]=-1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0;i<w;i++){\n\t\t\t\tif(i==0){\n\t\t\t\t\tif(field[0][i]<=0){\n\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tdp[0][i]=\"\"+field[0][i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tif(field[0][i]<=0){\n\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tif(!dp[0][i-1].equals(\"0\")&&!dp[0][i-1].equals(\"\")){\n\t\t\t\t\t\t\tdp[0][i]=dp[0][i-1]+field[0][i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[0][i]=\"\"+field[0][i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0;i<h;i++){\n\t\t\t\tif(i==0){\n\t\t\t\t\tif(field[i][0]<=0){\n\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tdp[i][0]=\"\"+field[i][0];\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tif(field[i][0]<=0){\n\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tif(!dp[i-1][0].equals(\"0\")&&!dp[i-1][0].equals(\"\")){\n\t\t\t\t\t\t\tdp[i][0]=dp[i-1][0]+field[i][0];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[i][0]=\"\"+field[i][0];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tString ans=\"0\";\n\t\t\tfor(int i = 1;i<h;i++){\n\t\t\t\tfor(int j = 1;j<w;j++){\n\t\t\t\t\tif(field[i][j]==-1)continue;\n\t\t\t\t\tString s1=dp[i-1][j]+field[i][j];\n\t\t\t\t\tString s2=dp[i][j-1]+field[i][j];\n\t\t\t\t\tString s3=field[i][j]+\"\";\n\t\t\t\t\tif(big(s1,s2)>=0){\n\t\t\t\t\t\tif(big(s1,s3)>=0){\n\t\t\t\t\t\t\tdp[i][j]=s1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[i][j]=s3;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tif(big(s2,s3)>=0){\n\t\t\t\t\t\t\tdp[i][j]=s2;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[i][j]=s3;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\twhile(dp[i][j].charAt(0)=='0'&&dp[i][j].length()>1){\n\t\t\t\t\t\tdp[i][j]=dp[i][j].substring(1,dp[i][j].length());\n\t\t\t\t\t}\n\t\t\t\t\tif(big(dp[i][j],ans)>0){\n\t\t\t\t\t\tans=dp[i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//output();\n\t\t\tSystem.out.println(ans);\n\t\t}\n\n\t}\n\tstatic int big(String s1,String s2){\n\t\tif(s1.length()==s2.length()){\n\t\t\treturn s1.compareTo(s2);\n\t\t}\n\t\treturn s1.length()-s2.length();\n\t}\n\tstatic void output(){\n\t\tfor(int i = 0;i<h;i++){\n\t\t\tfor(int j = 0;j<w;j++){\n\t\t\t\tSystem.out.print(dp[i][j]+\" \");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t\tSystem.out.println();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\n\npublic class Main {\n\tScanner in = new Scanner(System.in);\n\tchar[][] map;\n\t\n\tString compare(String s1, String s2) {\n\t\tif (s1.length() > s2.length()) return s1;\n\t\telse if (s1.length() < s2.length()) return s2;\n\t\telse {\n\t\t\tfor (int i = 0; i < s1.length(); i++) {\n\t\t\t\tif (s1.charAt(i) > s2.charAt(i)) return s1;\n\t\t\t\telse if (s1.charAt(i) < s2.charAt(i)) return s2;\n\t\t\t}\n\t\t}\n\t\treturn s1;\n\t}\n\t\n\tpublic String recursive(int x, int y, String ans) {\n\t\tif ((map[y][x] >= 'A' && map[y][x] <= 'Z') || map[y][x] == 0) return \"\";\n\t\tans += map[y][x] + \"\";\n\t\tString s1 = recursive(x+1, y, ans);\n\t\tString s2 = recursive(x, y+1, ans);\n\t\tString a = compare(s1, s2);\n\t\treturn (a.equals(\"\")) ? ans : a;\n\t}\n\t\n\tpublic Main() {\n\t\twhile (true) {\n\t\t\tint m = in.nextInt();\n\t\t\tint n = in.nextInt();\n\t\t\tif (m == 0 && n == 0) break;\n\t\t\tmap = new char[n+1][m+1];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tString s = in.next();\n\t\t\t\tfor (int j = 0; j < m; j++) {\n\t\t\t\t\tmap[i][j] = s.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tString ans = \"\";\n\t\t\tfor (int i = 0; i < m; i++) {\n\t\t\t\tfor (int j = 0; j < n; j++) {\n\t\t\t\t\tString temp = recursive(i, j, \"\");\n\t\t\t\t\tint k;\n\t\t\t\t\tfor (k = 0; k < temp.length(); k++) {\n\t\t\t\t\t\tif (temp.charAt(k) != '0') break;\n\t\t\t\t\t}\n\t\t\t\t\ttemp = temp.substring(k, temp.length());\n\t\t\t\t\tans = compare(temp, ans);\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main();\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tprivate static char[][] grid;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tScanner scanner = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint N = scanner.nextInt();\n\t\t\tif (N == 0) {\n\t\t\t\tscanner.close();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tint M = scanner.nextInt();\n\n\t\t\tgrid = new char[M][N];\n\t\t\tfor (int i = 0; i < grid.length; i++) {\n\t\t\t\tString line = scanner.next();\n\t\t\t\tfor (int j = 0; j < grid[i].length; j++) {\n\t\t\t\t\tgrid[i][j] = line.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tString ans = \"\";\n\t\t\tfor (int i = 0; i < grid.length; i++) {\n\t\t\t\tfor (int j = 0; j < grid[i].length; j++) {\n\t\t\t\t\tif (Character.getNumericValue(grid[i][j]) < 10\n\t\t\t\t\t\t\t&& Character.getNumericValue(grid[i][j]) > 0) {\n\t\t\t\t\t\t// grid[i][j]が数字の時、深さ優先探索する\n\t\t\t\t\t\tString dfString = dfs(String.valueOf(grid[i][j]), i, j);\n\t\t\t\t\t\tif (dfString.length() > ans.length()\n\t\t\t\t\t\t\t\t|| (dfString.length() == ans.length() && dfString\n\t\t\t\t\t\t\t\t\t\t.compareTo(ans) > 0)) {\n\t\t\t\t\t\t\t// 桁数が大きいか、桁数が一緒でも辞書順で後ろならば、\n\t\t\t\t\t\t\t// その数字を採用する\n\t\t\t\t\t\t\tans = dfString;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tSystem.out.println(ans);\n\n\t\t}\n\n\t}\n\n\tstatic String dfs(String sequence, int i, int j) {\n\t\t// 深さ優先探索\n\t\tString ans = sequence;\n\t\tif (i + 1 < grid.length\n\t\t\t\t&& Character.getNumericValue(grid[i + 1][j]) < 10) {\n\t\t\tString dfString = dfs(sequence + String.valueOf(grid[i + 1][j]),\n\t\t\t\t\ti + 1, j);\n\t\t\tif (dfString.length() > ans.length()\n\t\t\t\t\t|| (dfString.length() == ans.length() && dfString\n\t\t\t\t\t\t\t.compareTo(ans) > 0)) {\n\t\t\t\t// 桁数が大きいか、桁数が一緒でも辞書順で後ろならば、\n\t\t\t\t// その数字を採用する\n\t\t\t\tans = dfString;\n\t\t\t}\n\t\t}\n\t\tif (j + 1 < grid[i].length\n\t\t\t\t&& Character.getNumericValue(grid[i][j + 1]) < 10) {\n\t\t\tString dfString = dfs(sequence + String.valueOf(grid[i][j + 1]), i,\n\t\t\t\t\tj + 1);\n\t\t\tif (dfString.length() > ans.length()\n\t\t\t\t\t|| (dfString.length() == ans.length() && dfString\n\t\t\t\t\t\t\t.compareTo(ans) > 0)) {\n\t\t\t\t// 桁数が大きいか、桁数が一緒でも辞書順で後ろならば、\n\t\t\t\t// その数字を採用する\n\t\t\t\tans = dfString;\n\t\t\t}\n\t\t}\n\n\t\treturn ans;\n\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.List;\nimport java.util.Scanner;\n\npublic class Main{\n\tpublic static char[][] map;\n\tpublic static int w, h;\n\tpublic static boolean[][] used;\n//\tpublic static int turn;\n\tpublic static void main(String[] args){\n\t\tScanner in = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tw = in.nextInt();\n\t\t\th = in.nextInt();\n\t\t\tif(w == 0) break;\n\t\t\tmap = new char[h][w];\n\t\t\tused = new boolean[h][w];\n//\t\t\tturn = 1;\n\t\t\tans = new ArrayList<Integer>();\n\t\t\tfor(int i=0; i<h; i++){\n\t\t\t\tmap[i] = in.next().toCharArray();\n\t\t\t}\n\t\t\tfor(int i=0; i<h; i++){\n\t\t\t\tfor(int j=0; j<w; j++){\n\t\t\t\t\tif(Character.isAlphabetic(map[i][j])\n\t\t\t\t\t\t\t|| used[i][j]) continue;\n\t\t\t\t\tdfs(j, i, new ArrayList<Integer>());\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i: ans){\n\t\t\t\tSystem.out.print(i);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\tpublic static final int[] dx = {1, 0};\n\tpublic static final int[] dy = {0, 1};\n\tpublic static List<Integer> ans;\n\tpublic static void dfs(int x, int y, List<Integer> num){\n\t\tnum.add(map[y][x]-'0');\n\t\tused[y][x] = true;\n\t\tboolean exp = false;\n\t\tfor(int i=0; i<2; i++){\n\t\t\tint ny = y+dy[i];\n\t\t\tint nx = x+dx[i];\n\t\t\tif(ny < 0 || ny >= h || nx < 0 || nx >= w) continue;\n\t\t\tif('A' <= map[ny][nx] && map[ny][nx] <= 'Z') continue;\n\t\t\texp = true;\n\t\t\tdfs(nx, ny, num);\n\t\t}\n\t\tif(!exp){\n\t\t\tint idx = 0;\n\t\t\twhile(idx < num.size() && num.get(idx) == 0) idx++;\n\t\t\tif(ans.size() < num.size()-idx){\n\t\t\t\tans = listing(idx, num);\n\t\t\t}else if(ans.size() == num.size()-idx){\n\t\t\t\tfor(int i=0; i<ans.size(); i++){\n\t\t\t\t\tif(ans.get(i) < num.get(i+idx)){\n\t\t\t\t\t\tans = listing(idx, num);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else if(ans.get(i) > num.get(i+idx))\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tnum.remove(num.size()-1);\n\t\t\n\t}\n\t\n\tpublic static List<Integer> listing(int idx, List<Integer> num){\n\t\tList<Integer> ans = new ArrayList<Integer>();\n\t\tfor(; idx<num.size(); idx++){\n\t\t\tans.add(num.get(idx));\n\t\t}\n\t\treturn ans;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.*;\n\nimport static java.lang.Integer.parseInt;\n\n/**\n * The Secret Number\n */\npublic class Main {\n\n\tstatic char[][] seq;\n\tstatic SortedMap<Integer, SortedSet<String>> num;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line;\n\t\tString[] words;\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\n\t\t\tint W, H;\n\t\t\tW = parseInt(line.substring(0, line.indexOf(' ')));\n\t\t\tH = parseInt(line.substring(line.indexOf(' ') + 1));\n\t\t\tif ((W | H) == 0) break;\n\n\t\t\tseq = new char[H + 2][W + 2];\n\n\t\t\tfor (int i = 0; i < seq.length; i++) {\n\t\t\t\tArrays.fill(seq[i], 'X');\n\t\t\t}\n\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tline = br.readLine();\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tchar c = line.charAt(j);\n\t\t\t\t\tseq[i + 1][j + 1] = (c > '9' ? 'X' : c);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tnum = new TreeMap<>();\n\t\t\tchar[] buf = new char[H + W - 1];\n\n\t\t\tfor (int i = 1; i <= H; i++) {\n\t\t\t\tfor (int j = 1; j <= W; j++) {\n\t\t\t\t\tif (seq[i][j] != 'X'\n\t\t\t\t\t\t\t&& seq[i - 1][j] == 'X'\n\t\t\t\t\t\t\t&& seq[i][j - 1] == 'X') {\n\t\t\t\t\t\tdfs(new int[]{i, j}, 0, buf.clone());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(num.get(num.lastKey()).last());\n\n\t\t} //end while\n\t} //end main\n\n\tstatic void dfs(int[] p, int i, char[] buf) {\n\t\tif (seq[p[0]][p[1]] == 'X') {\n\t\t\tnum.putIfAbsent(i, new TreeSet<>());\n\t\t\tnum.get(i).add(String.valueOf(buf, 0, i));\n\t\t\treturn;\n\t\t}\n\t\t//\n\t\tif (i == 0 && seq[p[0]][p[1]] == '0') {\n\t\t\ti--;\n\t\t} else {\n\t\t\tbuf[i] = seq[p[0]][p[1]];\n\t\t}\n\t\tdfs(new int[]{p[0] + 1, p[1]}, i + 1, buf.clone());\n\t\tdfs(new int[]{p[0], p[1] + 1}, i + 1, buf.clone());\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.math.BigInteger;\n\npublic class Main{\n\tstatic int w,h;\n\tstatic int di[]={0,1}, dj[]={1,0};\n\tstatic char[][] map;\n\tstatic BigInteger max;\n\tstatic String[][] dp;\n\n\tpublic static String dfs(int i,int j){\n\t\tif(dp[i][j] != null) return dp[i][j];\n\n\t\tString s = Character.toString(map[i][j]);\n\t\tList<String> res = new ArrayList<String>();\n\t\tfor(int k=0;k<2;k++){\n\t\t\tint ni = i + di[k];\n\t\t\tint nj = j + dj[k];\n\n\t\t\tif(ni>=0 && ni<h && nj>=0 && nj<w && Character.isDigit(map[ni][nj])) res.add(dfs(ni,nj));\n\t\t}\n\n\t\tif(res.isEmpty()) return (dp[i][j]=s);\n\t\telse if(res.size() == 1) return (dp[i][j]=s+res.get(0));\n\t\telse{\n\t\t\tif(new BigInteger(res.get(0)).compareTo(new BigInteger(res.get(1)))>0) return (dp[i][j]=s+res.get(0));\n\t\t\telse return (dp[i][j]=s+res.get(1));\n\t\t}\n\t}\n\n\tpublic static void main(String[] args){\n\t\tScanner sc = new Scanner(System.in);\n\t\tBigInteger res;\n\n\t\twhile(true){\n\t\t\tw = sc.nextInt();\n\t\t\th = sc.nextInt();\n\t\t\tif(w==0 && h==0) break;\n\t\t\tmap = new char[h][w];\n\t\t\tdp = new String[h][w];\n\t\t\tmax = BigInteger.ZERO;\n\n\t\t\tfor(int i=0;i<h;i++) map[i] = sc.next().toCharArray();\n\n\t\t\tfor(int i=0;i<h;i++){\n\t\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\t\tif(Character.isDigit(map[i][j])){\n\t\t\t\t\t\tres = new BigInteger(dfs(i,j));\n\t\t\t\t\t\tif(max.compareTo(res) < 0) max = res;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(max);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.List;\nimport java.util.Scanner;\n\npublic class Main{\n\tpublic static char[][] map;\n\tpublic static int w, h;\n\tpublic static boolean[][] used;\n\tpublic static int[][][] val;\n\tpublic static int[][] len;\n\tpublic static final int[] dx = {1, 0};\n\tpublic static final int[] dy = {0, 1};\n//\tpublic static int turn;\n\tpublic static void main(String[] args){\n\t\tScanner in = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tw = in.nextInt();\n\t\t\th = in.nextInt();\n\t\t\tif(w == 0) break;\n\t\t\tmap = new char[h][w];\n\t\t\tval = new int[h][w][h+w];\n\t\t\tlen = new int[h][w];\n\t\t\tused = new boolean[h][w];\n\t\t\tfor(int i=0; i<h; i++){\n\t\t\t\tmap[i] = in.next().toCharArray();\n\t\t\t\tfor(int j=0; j<w; j++){\n\t\t\t\t\tif(!Character.isDigit(map[i][j])) continue;\n\t\t\t\t\tval[i][j][0] = map[i][j]-'0';\n\t\t\t\t\tif(val[i][j][0] == 0) continue;\n\t\t\t\t\tlen[i][j] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tint[] max = new int[h+w];\n\t\t\tint mlen = 0;\n\t\t\tfor(int i=0; i<h; i++){\n\t\t\t\tfor(int j=0; j<w; j++){\n\t\t\t\t\tif(!Character.isDigit(map[i][j])) continue;\n\t\t\t\t\tfor(int k=0; k<2; k++){\n\t\t\t\t\t\tint ny = i+dy[k];\n\t\t\t\t\t\tint nx = j+dx[k];\n\t\t\t\t\t\tif(out(ny, nx)) continue;\n\t\t\t\t\t\tif(!Character.isDigit(map[ny][nx])) continue;\n\t\t\t\t\t\tval[i][j][len[i][j]] = map[ny][nx]-'0';\n\t\t\t\t\t\tlen[i][j]++;\n\t\t\t\t\t\tif(larger(val[i][j], len[i][j], val[ny][nx], len[ny][nx])){\n\t\t\t\t\t\t\tval[ny][nx] = val[i][j].clone();\n\t\t\t\t\t\t\tlen[ny][nx] = len[i][j];\n\t\t\t\t\t\t\tif(larger(val[i][j], len[i][j], max, mlen)){\n\t\t\t\t\t\t\t\tmax = val[i][j].clone();\n\t\t\t\t\t\t\t\tmlen = len[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlen[i][j]--;\n\t\t\t\t\t\tval[i][j][len[i][j]] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=0; i<mlen; i++){\n\t\t\t\tSystem.out.print(max[i]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\t\n\tpublic static boolean out(int y, int x){\n\t\treturn x<0 || x>=w || y<0 || y>=h;\n\t}\n\t\n\tpublic static boolean larger(int[] s1, int l1, int[] s2, int l2){\n\t\t// is 1 larger than 2 ?\n\t\tif(l1 > l2) return true;\n\t\tif(l1 < l2) return false;\n\t\tint length = l1;\n\t\tfor(int i=0; i<length; i++){\n\t\t\tif(s1[i] == s2[i]) continue;\n\t\t\tif(s1[i] < s2[i]) return false;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.List;\nimport java.util.Scanner;\n\npublic class Main{\n\tpublic static char[][] map;\n\tpublic static int w, h;\n\tpublic static boolean[][] used;\n\tpublic static int[][][] val;\n\tpublic static int[][] len;\n\tpublic static final int[] dx = {1, 0};\n\tpublic static final int[] dy = {0, 1};\n//\tpublic static int turn;\n\tpublic static void main(String[] args){\n\t\tScanner in = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tw = in.nextInt();\n\t\t\th = in.nextInt();\n\t\t\tif(w == 0) break;\n\t\t\tmap = new char[h][w];\n\t\t\tval = new int[h][w][h+w];\n\t\t\tlen = new int[h][w];\n\t\t\tused = new boolean[h][w];\n\t\t\tint[] max = new int[h+w];\n\t\t\tint mlen = 0;\n\t\t\tfor(int i=0; i<h; i++){\n\t\t\t\tmap[i] = in.next().toCharArray();\n\t\t\t\tfor(int j=0; j<w; j++){\n\t\t\t\t\tif(!Character.isDigit(map[i][j])) continue;\n\t\t\t\t\tval[i][j][0] = map[i][j]-'0';\n\t\t\t\t\tif(val[i][j][0] == 0) continue;\n\t\t\t\t\tlen[i][j] = 1;\n\t\t\t\t\tif(val[i][j][0] > max[0]){\n\t\t\t\t\t\tmlen = 1;\n\t\t\t\t\t\tmax[0] = val[i][j][0];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=0; i<h; i++){\n\t\t\t\tfor(int j=0; j<w; j++){\n\t\t\t\t\tif(!Character.isDigit(map[i][j])) continue;\n\t\t\t\t\tif(len[i][j] == 0) continue;\n\t\t\t\t\tfor(int k=0; k<2; k++){\n\t\t\t\t\t\tint ny = i+dy[k];\n\t\t\t\t\t\tint nx = j+dx[k];\n\t\t\t\t\t\tif(out(ny, nx)) continue;\n\t\t\t\t\t\tif(!Character.isDigit(map[ny][nx])) continue;\n\t\t\t\t\t\tval[i][j][len[i][j]] = map[ny][nx]-'0';\n\t\t\t\t\t\tlen[i][j]++;\n\t\t\t\t\t\tif(larger(val[i][j], len[i][j], val[ny][nx], len[ny][nx])){\n\t\t\t\t\t\t\tval[ny][nx] = val[i][j].clone();\n\t\t\t\t\t\t\tlen[ny][nx] = len[i][j];\n\t\t\t\t\t\t\tif(larger(val[i][j], len[i][j], max, mlen)){\n\t\t\t\t\t\t\t\tmax = val[i][j].clone();\n\t\t\t\t\t\t\t\tmlen = len[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlen[i][j]--;\n\t\t\t\t\t\tval[i][j][len[i][j]] = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=0; i<mlen; i++){\n\t\t\t\tSystem.out.print(max[i]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\t\n\tpublic static boolean out(int y, int x){\n\t\treturn x<0 || x>=w || y<0 || y>=h;\n\t}\n\t\n\tpublic static boolean larger(int[] s1, int l1, int[] s2, int l2){\n\t\t// is 1 larger than 2 ?\n\t\tif(l1 > l2) return true;\n\t\tif(l1 < l2) return false;\n\t\tint length = l1;\n\t\tfor(int i=0; i<length; i++){\n\t\t\tif(s1[i] == s2[i]) continue;\n\t\t\tif(s1[i] < s2[i]) return false;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\n\npublic class TheSecretNumberDP {\n\tint m, n;\n\tchar[][] map;\n\tScanner in = new Scanner(System.in);\n\t\n\tString remove_zero(String s) {\n\t\tint k;\n\t\tfor (k = 0; k < s.length(); k++) {\n\t\t\tif (s.charAt(k) != '0') break;\n\t\t}\n\t\treturn s.substring(k, s.length()); \n\t}\n\t\n\tboolean compare(String s1, String s2) {\n\t\tif (s1.length() > s2.length()) return true;\n\t\telse if (s1.length() < s2.length()) return false;\n\t\telse {\n\t\t\tfor (int i = 0; i < s1.length(); i++) {\n\t\t\t\tif (s1.charAt(i) > s2.charAt(i)) return true;\n\t\t\t\telse if (s1.charAt(i) < s2.charAt(i)) return false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\t\n\tpublic TheSecretNumberDP() {\n\t\twhile (true) {\n\t\t\tint m = in.nextInt();\n\t\t\tint n = in.nextInt();\n\t\t\tif (m == 0 && n == 0) break;\n\t\t\tmap = new char[n+1][m+1];\n\t\t\tfor (int i = 1; i <= n; i++) {\n\t\t\t\tString s = in.next();\n\t\t\t\tfor (int j = 0; j < m; j++) {\n\t\t\t\t\tmap[i][j+1] = s.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tString[][] dp = new String[n+1][m+1];\n\t\t\tfor (int i = 0; i <= n; i++) \n\t\t\t\tfor (int j = 0; j <= m; j++) \n\t\t\t\t\tdp[i][j] = \"\";\n\t\t\t\n\t\t\tString ans = \"\";\t\t\n\t\t\tfor (int i = 1; i <= n; i++) {\n\t\t\t\tfor (int j = 1; j <= m; j++) {\n\t\t\t\t\tif (map[i][j] >= 'A' && map[i][j] <= 'Z' || map[i][j] == 0)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\telse if (map[i][j] == '0' && dp[i][j-1] == \"\" && dp[i-1][j] == \"\") \n\t\t\t\t\t\tcontinue;\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[i][j] = (compare(dp[i][j-1] + map[i][j], dp[i][j])) ? dp[i][j-1] + map[i][j] : dp[i][j];\n\t\t\t\t\t\tdp[i][j] = (compare(dp[i-1][j] + map[i][j], dp[i][j])) ? dp[i-1][j] + map[i][j] : dp[i][j];\n\t\t\t\t\t}\n\t\t\t\t\tans = compare(dp[i][j], ans) ? dp[i][j] : ans;\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew TheSecretNumberDP();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import static java.lang.Math.*;\nimport static java.util.Arrays.*;\n\nimport java.util.*;\nimport java.io.*;\n\npublic class Main{\n\n\tvoid run() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tfor(;;) {\n\t\t\tint w = sc.nextInt(), h = sc.nextInt();\n\t\t\tif( (w|h) == 0 ) break;\n\t\t\tString[][] dp = new String[h+1][w+1];\n\t\t\tfor(String[] a: dp) fill(a, \"\");\n\t\t\tString c = \"\";\n\t\t\tfor(int i=1;i<=h;i++) {\n\t\t\t\tString l = sc.next();\n\t\t\t\tfor(int j=1;j<=w;j++) if( '0' <= l.charAt(j-1) && l.charAt(j-1) <= '9' ){\n\t\t\t\t\tdp[i][j] = (isLarge(dp[i][j-1], dp[i-1][j])? dp[i][j-1]: dp[i-1][j]);\n\t\t\t\t\tif( l.charAt(j-1) != '0' || dp[i][j].length() != 0  ) dp[i][j] += l.charAt(j-1);\n\t\t\t\t\tif( isLarge(dp[i][j], c) ) c = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(String[] a: dp) debug(a);\n\t\t\tSystem.out.println(c);\n\t\t}\n\t}\n\t\n\tboolean isLarge(String a, String b) {\n\t\tif( a.length() != b.length() ) {\n\t\t\treturn a.length()>b.length();\n\t\t}\n\t\t\n\t\tfor(int i=min(a.length(), b.length())-1;i>=0;i--) {\n\t\t\tif( a.charAt(i) > b.charAt(i) ) return true;\n\t\t\tif( a.charAt(i) > b.charAt(i) ) return false; \n\t\t}\n\t\treturn false;\n\t}\n\n\tvoid debug(Object... os) {\n\t\tSystem.err.println(Arrays.deepToString(os));\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\npublic class Main {\n\t\n\tprivate void doit(){\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tif((w|h) == 0)break;\n\t\t\tchar [][] data =new char[h][w];\n\t\t\tfor(int i = 0 ; i < h; i++){\n\t\t\t\tString s = sc.next();\n\t\t\t\tfor(int j = 0 ; j < w; j++){\n\t\t\t\t\tdata[i][j] = s.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tString [][] dp = new String[h][w];\n\t\t\tfor(int i = 0 ; i < h; i++){\n\t\t\t\tfor(int j = 0 ; j < w; j++){\n\t\t\t\t\tif(Character.isDigit(data[i][j]) && (data[i][j] != '0')){\n\t\t\t\t\t\tdp[i][j] = data[i][j] + \"\";\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tdp[i][j] = \"\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfor(int i = 0; i < h; i++){\n\t\t\t\tfor(int j = 0 ; j < w; j++){\n\t\t\t\t\tif(! Character.isDigit(data[i][j])) continue;\n\t\t\t\t\tif(data[i][j] == '0' && dp[i][j].equals(\"\")) continue;\n\t\t\t\t\tif(i + 1 != h){\n\t\t\t\t\t\tif(dp[i+1][j].length() < dp[i][j].length()  + 1){\n\t\t\t\t\t\t\tdp[i+1][j] = dp[i][j] + data[i+1][j];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(dp[i+1][j].length() == dp[i][j].length()  + 1 && dp[i+1][j].compareTo(dp[i][j] + data[i+1][j]) < 0){\n\t\t\t\t\t\t\tdp[i+1][j] = dp[i][j] + data[i+1][j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(j + 1 != w){\n\t\t\t\t\t\tif(dp[i][j+1].length() < dp[i][j].length()  + 1){\n\t\t\t\t\t\t\tdp[i][j+1] = dp[i][j] + data[i][j+1];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(dp[i][j+1].length() == dp[i][j].length()  + 1  && dp[i][j+1].compareTo(dp[i][j] + data[i][j+1]) < 0){\n\t\t\t\t\t\t\tdp[i][j+1] = dp[i][j] + data[i][j+1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t//debug\n//\t\t\tfor(int i = 0 ; i < h; i++){\n//\t\t\t\tfor(int j  = 0 ;  j < w; j++){\n//\t\t\t\t\tif(dp[i][j].equals(\"\")){\n//\t\t\t\t\t\tSystem.out.print(\". \");\n//\t\t\t\t\t}\n//\t\t\t\t\telse{\n//\t\t\t\t\t\tSystem.out.print(dp[i][j] + \" \");\n//\t\t\t\t\t\t\n//\t\t\t\t\t}\n//\t\t\t\t}\n//\t\t\t\tSystem.out.println();\n//\t\t\t}\n\t\t\t\n\t\t\tString ans = \"\";\n\t\t\tfor(int i = 0 ; i < h; i++){\n\t\t\t\tfor(int j = 0 ; j < w; j++){\n\t\t\t\t\tif(! Character.isDigit(data[i][j])) continue;\n\t\t\t\t\tif(ans.length() < dp[i][j].length() + 1){\n\t\t\t\t\t\tans = dp[i][j];\n\t\t\t\t\t}\n\t\t\t\t\telse if(ans.length() == dp[i][j].length()&& ans .compareTo(dp[i][j]) < 0){\n\t\t\t\t\t\tans = dp[i][j] ;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\t\n\tpublic static void main(String [] args){\n\t\tnew Main().doit();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.util.InputMismatchException;\n\npublic class Main {\n\tStringBuilder max(StringBuilder a, StringBuilder b) {\n\t\tint n = a.length();\n\t\tif (n < b.length()) {\n\t\t\treturn b;\n\t\t} else if (b.length() < n) {\n\t\t\treturn a;\n\t\t}\n\t\tchar[] ca = a.toString().toCharArray();\n\t\tchar[] cb = b.toString().toCharArray();\n\t\tfor (int i = 0; i < n; i++) {\n\t\t\tif (ca[i] > cb[i]) {\n\t\t\t\treturn a;\n\t\t\t} else if (ca[i] < cb[i]) {\n\t\t\t\treturn b;\n\t\t\t}\n\t\t}\n\t\treturn a;\n\t}\n\n\tStringBuilder leadZero(StringBuilder a) {\n\t\twhile (1 < a.length() && a.charAt(0) == '0') {\n\t\t\ta = a.deleteCharAt(0);\n\t\t}\n\t\treturn a;\n\t}\n\n\tvoid run() {\n\t\tMyScanner sc = new MyScanner();\n\n\t\twhile (true) {\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tif ((w | h) == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tchar[][] c = new char[h][];\n\t\t\tStringBuilder[][] a = new StringBuilder[h][w];\n\t\t\tfor (int i = 0; i < h; i++) {\n\t\t\t\tc[i] = sc.next().toCharArray();\n\t\t\t}\n\n\t\t\ta[0][0] = ('0' <= c[0][0] && c[0][0] <= '9') ? new StringBuilder(\"\" + c[0][0]) : new StringBuilder(\"0\");\n\t\t\tfor (int i = 1; i < h; i++) {\n\t\t\t\tif ('0' <= c[i][0] && c[i][0] <= '9') {\n\t\t\t\t\ta[i][0] = new StringBuilder(\"0\").append(a[i - 1][0]).append(c[i][0]);\n\t\t\t\t\ta[i][0] = leadZero(a[i][0]);\n\t\t\t\t} else {\n\t\t\t\t\ta[i][0] = new StringBuilder(\"0\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int j = 1; j < w; j++) {\n\t\t\t\tif ('0' <= c[0][j] && c[0][j] <= '9') {\n\t\t\t\t\ta[0][j] = new StringBuilder(\"0\").append(a[0][j - 1]).append(c[0][j]);\n\t\t\t\t\ta[0][j] = leadZero(a[0][j]);\n\t\t\t\t} else {\n\t\t\t\t\ta[0][j] = new StringBuilder(\"0\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int i = 1; i < h; i++) {\n\t\t\t\tfor (int j = 1; j < w; j++) {\n\t\t\t\t\tif ('0' <= c[i][j] && c[i][j] <= '9') {\n\t\t\t\t\t\tStringBuilder pre = max(a[i - 1][j], a[i][j - 1]);\n\t\t\t\t\t\ta[i][j] = new StringBuilder(\"\").append(pre).append(c[i][j]);\n\t\t\t\t\t\ta[i][j] = leadZero(a[i][j]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ta[i][j] = new StringBuilder(\"0\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tStringBuilder max = new StringBuilder(\"0\");\n\t\t\tfor (int i = 0; i < h; i++) {\n\t\t\t\tfor (int j = 0; j < w; j++) {\n\t\t\t\t\tmax = max(max, a[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(max);\n\t\t}\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tpublic void mapDebug(int[][] a) {\n\t\tSystem.out.println(\"--------map display---------\");\n\t\tfor (int i = 0; i < a.length; i++) {\n\t\t\tfor (int j = 0; j < a[i].length; j++) {\n\t\t\t\tSystem.out.printf(\"%3d \", a[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t\tSystem.out.println(\"----------------------------\" + '\\n');\n\t}\n\n\tclass MyScanner {\n\t\tint read() {\n\t\t\ttry {\n\t\t\t\treturn System.in.read();\n\t\t\t} catch (IOException e) {\n\t\t\t\tthrow new InputMismatchException();\n\t\t\t}\n\t\t}\n\n\t\tboolean isSpaceChar(int c) {\n\t\t\treturn c == ' ' || c == '\\n' || c == '\\r' || c == '\\t' || c == -1;\n\t\t}\n\n\t\tboolean isEndline(int c) {\n\t\t\treturn c == '\\n' || c == '\\r' || c == -1;\n\t\t}\n\n\t\tint nextInt() {\n\t\t\treturn Integer.parseInt(next());\n\t\t}\n\n\t\tint[] nextIntArray(int n) {\n\t\t\tint[] array = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextInt();\n\t\t\treturn array;\n\t\t}\n\n\t\tlong nextLong() {\n\t\t\treturn Long.parseLong(next());\n\t\t}\n\n\t\tlong[] nextLongArray(int n) {\n\t\t\tlong[] array = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextLong();\n\t\t\treturn array;\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tdouble[] nextDoubleArray(int n) {\n\t\t\tdouble[] array = new double[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = nextDouble();\n\t\t\treturn array;\n\t\t}\n\n\t\tString next() {\n\t\t\tint c = read();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn res.toString();\n\t\t}\n\n\t\tString[] nextStringArray(int n) {\n\t\t\tString[] array = new String[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tarray[i] = next();\n\n\t\t\treturn array;\n\t\t}\n\n\t\tString nextLine() {\n\t\t\tint c = read();\n\t\t\twhile (isEndline(c))\n\t\t\t\tc = read();\n\t\t\tStringBuilder res = new StringBuilder();\n\t\t\tdo {\n\t\t\t\tres.appendCodePoint(c);\n\t\t\t\tc = read();\n\t\t\t} while (!isEndline(c));\n\t\t\treturn res.toString();\n\t\t}\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\n  Scanner sc;\n\n  Main() {\n    sc = new Scanner(System.in);\n  }\n\n  int ni() {\n    return sc.nextInt();\n  }\n\n  public static void main(String[] args) {\n    new Main().run();\n  }\n\n  int w, h;\n  char[][] c;\n\n  static int[][] ofs = {\n      {1, 0},\n      {0, 1}\n  };\n\n  String dfs(int x, int y, String num) {\n    if (x >= w) {\n      return num;\n    }\n    if (y >= h) {\n      return num;\n    }\n    if (c[y][x] < '0' || '9' < c[y][x]) {\n      return num;\n    }\n    num += c[y][x];\n    String res = num;\n    for (int i = 0; i < 2; ++i) {\n      int nx = x + ofs[i][0];\n      int ny = y + ofs[i][1];\n      String nnum = dfs(nx, ny, num);\n      if (res.length() < nnum.length()) {\n        res = nnum;\n      } else if (res.length() == nnum.length() &&\n          new BigInteger(res).compareTo(new BigInteger(nnum)) < 0) {\n        res = new BigInteger(nnum).toString();\n      }\n    }\n    return res;\n  }\n\n  void run() {\n    for (; ; ) {\n      w = ni();\n      h = ni();\n      if ((w | h) == 0) {\n        break;\n      }\n      c = new char[h][w];\n      for (int i = 0; i < h; ++i) {\n        String line = sc.next();\n        for (int j = 0; j < w; ++j) {\n          c[i][j] = line.charAt(j);\n        }\n      }\n      String ans = \"0\";\n      for (int i = 0; i < h; ++i) {\n        for (int j = 0; j < w; ++j) {\n          String sans = dfs(j, i, \"\");\n          if (sans.length() > ans.length()) {\n            ans = sans;\n          } else if (sans.length() == ans.length()) {\n            if (new BigInteger(ans).compareTo(new BigInteger(sans)) < 0) {\n              ans = sans;\n            }\n          }\n        }\n      }\n      System.out.println(ans);\n    }\n  }\n\n  void debug(Object... os) {\n    System.err.println(Arrays.deepToString(os));\n  }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nclass Main{\n    static int w,h;\n    static String[][] fieldS;\n    static int[][] fieldI;\n\n    public static void main(String[] args){\n\tScanner sc = new Scanner(System.in);\n\n\tList<String> numList = new ArrayList<String>();\n\tfor(int i=0; i<10; i++){\n\t    String num = Integer.toString(i);\n\t    numList.add(num);\n\t}\n\n\tw = sc.nextInt();\n\th = sc.nextInt();\n\n\twhile(w!=0 && h!=0){\n\t    fieldS = new String[h][w];\n\t    for(int i=0; i<h; i++){\n\t\tfor(int j=0; j<w; j++){\n\t\t    fieldS[i][j] = \"\";\n\t\t}\n\t    }\n\t    fieldI = new int[h][w];\n\n\t    for(int i=0; i<h; i++){\n\t\tString line = sc.next();\n\t\tfor(int j=0; j<w; j++){\n\t\t    if(numList.contains(line.substring(j,j+1))){\n\t\t\tfieldI[i][j] = Integer.parseInt(line.substring(j,j+1));\n\t\t    }else{\n\t\t\tfieldI[i][j] = -1;\n\t\t    }\n\t\t}\n\t    }\n\n\t    String ans = solve();\n\t    if(!ans.equals(\"0\"))System.out.println(ans);\n\n\t    w = sc.nextInt();\n\t    h = sc.nextInt();\n\t}\n    }\n\n    public static String solve(){\n\tString up = \"\";\n\tString left = \"\";\n\tboolean hantei = false;\n\tfor(int i=0; i<h; i++){\n\t    for(int j=0; j<w; j++){\n\t\tif(fieldI[i][j]!=-1){\n\t\t    hantei = false;\n\t\t    if(i-1>=0){up = fieldS[i-1][j]; hantei=true;}\n\t\t    if(j-1>=0){left = fieldS[i][j-1]; hantei=true;}\n\t\t    if(hantei){\n\t\t\tString select = getLargerOne(up,left);\n\t\t\tfieldS[i][j] = select + Integer.toString(fieldI[i][j]);\n\t\t\tif(fieldS[i][j].equals(\"0\")){fieldS[i][j]=\"\";}\n\t\t\tup = \"\";\n\t\t\tleft = \"\";\n\t\t    }\n\t\t}\n\t    }\n\t}\n\tString max = getMax();\n\treturn max;\n    }\n\n    public static String getLargerOne(String up, String left){\n\n\tif(up.length()>left.length()){return up;}\n\telse if(left.length()>up.length()){return left;}\n\n\tfor(int i=0; i<up.length(); i++){\n\t    int upI = Integer.parseInt(up.substring(i,i+1));\n\t    int leftI = Integer.parseInt(left.substring(i,i+1));\n\t    if(upI>leftI){return up;}\n\t    else if(leftI>upI){return left;}\n\t}\n\treturn up;\n    }\n\n    public static String getMax(){\n\tint maxLen = 0;\n\tList<String> sameLen = new ArrayList<String>();\n\tfor(int i=0; i<h; i++){\n\t    for(int j=0; j<w; j++){\n\t\tif(fieldS[i][j].length()>maxLen){\n\t\t    maxLen = fieldS[i][j].length();\n\t\t}\n\t    }\n\t}\n\n\tfor(int i=0; i<h; i++){\n\t    for(int j=0; j<w; j++){\n\t\tif(fieldS[i][j].length()==maxLen){\n\t\t    sameLen.add(fieldS[i][j]);\n\t\t}\n\t    }\n\t}\n\tif(sameLen.size()==1){return sameLen.get(0);}\n\n\tint maxInt = 0;\n\tfor(int i=0; i<maxLen; i++){\n\t    maxInt = 0;\n\t    for(int j=0; j<sameLen.size(); j++){\n\t\tString a = sameLen.get(j);\n\t\tSystem.out.println(a + \" \" + a.length());\n\t\tint num = Integer.parseInt(a.substring(i,i+1));\n\t\tif(num>maxInt){maxInt = num;}\n\t\telse{sameLen.remove(j); j--;}\n\t\tif(sameLen.size()==1){return sameLen.get(0);}\n\t    }\n\t}\n\treturn \"-1\";\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tprivate static char[][] grid;\n\tprivate static String[][] dp;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tScanner scanner = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint N = scanner.nextInt();\n\t\t\tif (N == 0) {\n\t\t\t\tscanner.close();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tint M = scanner.nextInt();\n\n\t\t\tgrid = new char[M][N];\n\t\t\tdp = new String[M][N];\n\t\t\tfor (int i = 0; i < grid.length; i++) {\n\t\t\t\tString line = scanner.next();\n\t\t\t\tfor (int j = 0; j < grid[i].length; j++) {\n\t\t\t\t\tgrid[i][j] = line.charAt(j);\n\t\t\t\t\tdp[i][j] = String.valueOf(grid[i][j]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tString ans = \"\";\n\t\t\tfor (int i = 0; i < grid.length; i++) {\n\t\t\t\tfor (int j = 0; j < grid[i].length; j++) {\n\t\t\t\t\tif (Character.getNumericValue(grid[i][j]) < 10) {\n\t\t\t\t\t\tans = strMax(ans, dp[i][j]);\n\t\t\t\t\t\tif (i + 1 < grid.length\n\t\t\t\t\t\t\t\t&& Character.getNumericValue(grid[i + 1][j]) < 10) {\n\t\t\t\t\t\t\tdp[i + 1][j] = strMax(dp[i + 1][j], dp[i][j]\n\t\t\t\t\t\t\t\t\t+ String.valueOf(grid[i + 1][j]));\n\t\t\t\t\t\t\tans = strMax(ans, dp[i + 1][j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (j + 1 < grid[i].length\n\t\t\t\t\t\t\t\t&& Character.getNumericValue(grid[i][j + 1]) < 10) {\n\t\t\t\t\t\t\tdp[i][j + 1] = strMax(dp[i][j + 1], dp[i][j]\n\t\t\t\t\t\t\t\t\t+ String.valueOf(grid[i][j + 1]));\n\t\t\t\t\t\t\tans = strMax(ans, dp[i][j + 1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\n\t}\n\n\tstatic String strMax(String a, String b) {\n\t\t// 行頭の0を全て削除\n\t\ta = a.replaceAll(\"^0*\", \"\");\n\t\tb = b.replaceAll(\"^0*\", \"\");\n\n\t\tif (b.length() > a.length()\n\t\t\t\t|| (b.length() == a.length() && b.compareTo(a) > 0)) {\n\t\t\t// 桁数が大きいか、桁数が一緒でも辞書順で後ろならば、\n\t\t\t// その数字を採用する\n\t\t\treturn b;\n\t\t} else {\n\t\t\treturn a;\n\t\t}\n\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\nimport java.util.ArrayList;\nimport java.util.List;\npublic class AOJ_1126\n{\n\tint W;\n\tint H;\n\tString[] C;\n\tint[][] table;\n\tList<String> ansList;\n\tprivate boolean isNum(char ch)\n\t{\n\t\tif(ch >= '0' && ch <= '9')return true;\n\t\treturn false;\n\t}\n\tprivate boolean isStrNum(String s)\n\t{\n\t\tif(s.charAt(0) == '0')return false;\n\t\treturn true;\n\t}\n\tprivate int strNumComp(char[] charA,char[] charB)\n\t{\n\t\tif(charA.length > charB.length)return 1;\n\t\tif(charA.length < charB.length)return -1;\n\t\t\n\t\tfor(int i = 0;i < charA.length;i++)\n\t\t{\n\t\t\tif(charA[i] == charB[i])continue;\n\t\t\tif(charA[i] > charB[i])return 1;\n\t\t\tif(charA[i] < charB[i])return -1;\n\t\t}\n\t\t\n\t\treturn 0;\n\t}\n\tprivate int strNumComp(String a,String b)\n\t{\n\t\tchar[] charA = a.toCharArray();\n\t\tchar[] charB = b.toCharArray();\n\t\t\n\t\tif(charA.length > charB.length)return 1;\n\t\tif(charA.length < charB.length)return -1;\n\t\t\n\t\tfor(int i = 0;i < charA.length;i++)\n\t\t{\n\t\t\tif(charA[i] == charB[i])continue;\n\t\t\tif(charA[i] > charB[i])return 1;\n\t\t\tif(charA[i] < charB[i])return -1;\n\t\t}\n\t\t\n\t\treturn 0;\n\t}\n\tprivate void dfs(int h,int w,String S)\n\t{\n\t\t/*if((table[h][w] == 0 || (h >= H - 1  && w >= W - 1))&& !S.isEmpty())\n\t\t{\n\t\t\tSystem.out.println(\"aaa\");\n\t\t\tansList.add(S);\n\t\t\treturn;\n\t\t}*/\n\t\t\n\t\tif(h + 1 < H && table[h + 1][w] > 0)\n\t\t{\n\t\t\tdfs(h + 1,w,S + C[h + 1].charAt(w));\n\t\t}\n\t\t\n\t\tif(w + 1 < W && table[h][w + 1] > 0)\n\t\t{\n\t\t\tdfs(h, w + 1,S + C[h].charAt(w + 1));\n\t\t}\n\t\t\n\t\tif(h + 1 < H && w + 1 < W && table[h + 1][w + 1] > 0)\n\t\t{\n\t\t\tdfs(h + 1,w + 1,S + C[h + 1].charAt(w + 1));\n\t\t}\n\t\t//System.out.println(S);\n\t\tansList.add(S);\n\t\treturn;\n\t}\n\tpublic void solve()\n\t{\n\t\tScanner cin = new Scanner(System.in);\n\t\twhile(true)\n\t\t{\n\t\t\tW = cin.nextInt();\n\t\t\tH = cin.nextInt();\n\t\t\tif(W == 0 && H == 0)break;\n\t\t\tC = new String[H];\n\t\t\tfor(int i = 0;i < H;i++)\n\t\t\t{\n\t\t\t\tC[i] = cin.next();\n\t\t\t}\n\t\t\ttable = new int[H][W];\n\t\t\tfor(int i = 0;i < H;i++)\n\t\t\t{\n\t\t\t\tfor(int j = 0;j < W;j++)\n\t\t\t\t{\n\t\t\t\t\tif(C[i].charAt(j) >= '0' && C[i].charAt(j) <= '9')table[i][j] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tint[] bin = new int[500];\n\t\t\tfor(int i = 0;i < H;i++)\n\t\t\t{\n\t\t\t\tfor(int j = 0;j < W;j++)\n\t\t\t\t{\n\t\t\t\t\tchar ch = C[i].charAt(j);\n\t\t\t\t\tif(isNum(ch))\n\t\t\t\t\t{\n\t\t\t\t\t\tif(j + 1 < W && isNum(C[i].charAt(j + 1)))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttable[i][j + 1] = Math.max(table[i][j] + 1,table[i][j + 1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(i + 1 < H && isNum(C[i + 1].charAt(j)))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttable[i + 1][j] = Math.max(table[i][j] + 1,table[i + 1][j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(i + 1 < H && j + 1 < W && isNum(C[i + 1].charAt(j + 1)))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttable[i + 1][j + 1] = Math.max(table[i][j] + 1,table[i + 1][j + 1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tansList = new ArrayList<String>();\n\t\t\tfor(int i = 0;i < H;i++)\n\t\t\t{\n\t\t\t\tfor(int j = 0;j < W;j++)\n\t\t\t\t{\n\t\t\t\t\tif(table[i][j] == 0)continue;\n\t\t\t\t\tif(isNum(C[i].charAt(j)))\n\t\t\t\t\t{\n\t\t\t\t\t\tdfs(i,j,C[i].charAt(j) + \"\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//System.out.println(ansList.size());\n\t\t\tString ans = \"\";\n\t\t\tfor(String s : ansList)\n\t\t\t{\n\t\t\t\tif(!isStrNum(s))continue;\n\t\t\t\tif(ans == \"\")\n\t\t\t\t{\n\t\t\t\t\tans = s;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(strNumComp(ans,s) == -1)\n\t\t\t\t{\n\t\t\t\t\tans = s;\n\t\t\t\t}\n\t\t\t\t//System.out.println(s);\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t\t/*for(int i = 0;i < H;i++)\n\t\t\t{\n\t\t\t\tfor(int j = 0;j < W;j++)\n\t\t\t\t{\n\t\t\t\t\tSystem.out.print(table[i][j] + \" \");\n\t\t\t\t}\n\t\t\t\tSystem.out.println();\n\t\t\t}*/\n\t\t}\n\t}\n\tpublic static void main(String[] args)\n\t{\n\t\tnew AOJ_1126().solve();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.InputStreamReader;\nimport java.math.BigInteger;\nimport java.util.ArrayList;\nimport java.util.Collections;\n\nclass Main{\n\tstatic char tiles[][];\n\tstatic int w;\n\tstatic int h;\n\tstatic String answer;\n\tpublic static void main(String args[]){\n\t\t// 標準入力準備\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\t//Scanner sc = new Scanner(System.in);\n\t\tString str = new String();\n\n\t\ttry{\n\t\t\twhile(true){\n\t\t\t\tstr = br.readLine();\n\t\t\t\tString strs[] = str.split(\" \");\n\t\t\t\tw = Integer.parseInt(strs[0]);\n\t\t\t\th = Integer.parseInt(strs[1]);\n\n\t\t\t\tif(w == 0) break;\n\t\t\t\ttiles = new char[h][w];\n\t\t\t\tanswer = \"0\";\n\n\t\t\t\t// タイル入力\n\t\t\t\tfor(int i = 0; i < h; i++){\n\t\t\t\t\tstr = br.readLine();\n\t\t\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\t\t\ttiles[i][j] = str.charAt(j);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//printMatrix(tiles);\n\t\t\t\tfor(int x = 0; x < w; x++){\n\t\t\t\t\tfor(int y = 0; y < h; y++){\n\t\t\t\t\t\t// 数字で始まっていること\n\t\t\t\t\t\tif('0' <= tiles[y][x] && tiles[y][x] <= '9'){\n\t\t\t\t\t\t\t// 左が数字でないこと\n\t\t\t\t\t\t\tif(y == 0 || '9' < tiles[y-1][x]){\n\t\t\t\t\t\t\t\t// 上が数字でないこと\n\t\t\t\t\t\t\t\tif(x == 0 || '9' < tiles[y][x-1]){\n\t\t\t\t\t\t\t\t\t// 桁数で枝刈り\n\t\t\t\t\t\t\t\t\tif(answer.length() < (w - x - 1) + (h - y - 1) - 1){\n\t\t\t\t\t\t\t\t\t\tsolve(x, y, \"\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tSystem.out.println(answer);\n\t\t\t}\n\t\t}catch(Exception e){\n\t\t\tSystem.err.println(e);\n\t\t}\n\t}\n\n\tstatic void solve(int x, int y, String num_str){\n\t\t//System.out.println(\"solve \" + x + \" \" + y);\n\t\tnum_str = num_str + tiles[y][x];\n\n\t\tboolean end_flag = true;\n\t\t// 右を見る\n\t\tif(x+1 < w && '0' <= tiles[y][x+1] && tiles[y][x+1] <= '9'){\n\t\t\tsolve(x+1, y, num_str);\n\t\t\tend_flag = false;\n\t\t}\n\n\t\t// 下を見る\n\t\tif(y+1 < h && '0' <= tiles[y+1][x] && tiles[y+1][x] <= '9'){\n\t\t\tsolve(x, y+1, num_str);\n\t\t\tend_flag = false;\n\t\t}\n\n\t\tif(end_flag){\n\t\t\t//System.out.println(num_str);\n\t\t\t//int num = Integer.parseInt(num_str);\n\t\t\tBigInteger num = new BigInteger(num_str);\n\t\t\tBigInteger ans = new BigInteger(answer);\n\t\t\tif(num.compareTo(ans) == 1) answer = num_str;\n\t\t}\n\t}\n\n\n\tstatic void printArray(ArrayList<Integer[]> array){\n\t\tSystem.out.println(\"PrintArray \" + array.size());\n\t\tfor(int i = 0; i < array.size(); i++){\n\t\t\tInteger set[] = array.get(i);\n\t\t\tSystem.out.print(\"(\" + set[0] + \", \" + set[1] + \")\");\n\t\t}\n\t\tSystem.out.println();\n\t}\n\n\tstatic void printMatrix(int matrix[][]){\n\t\tfor(int row = 0; row < matrix.length; row++){\n\t\t\tfor(int column = 0; column < matrix[row].length; column++){\n\t\t\t\tSystem.out.print(matrix[row][column] + \"\\t\");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tstatic void printMatrix(boolean matrix[][]){\n\t\tfor(int row = 0; row < matrix.length; row++){\n\t\t\tfor(int column = 0; column < matrix[row].length; column++){\n\t\t\t\tSystem.out.print(matrix[row][column] + \"\\t\");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tstatic void printMatrix(char matrix[][]){\n\t\tfor(int row = 0; row < matrix.length; row++){\n\t\t\tfor(int column = 0; column < matrix[row].length; column++){\n\t\t\t\tSystem.out.print(matrix[row][column]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tstatic void printArray(int array[]){\n\t\tfor(int i = 0; i < array.length; i++){\n\t\t\tSystem.out.print(array[i] + \"\\t\");\n\t\t}\n\t\tSystem.out.println();\n\t}\n}\n\nclass OriginalSet{\n\tpublic ArrayList<Integer> set;\n\n\tOriginalSet(){\n\t\tset = new ArrayList<Integer>();\n\t}\n\n\tpublic void add(int inputInt){\n\t\tif(set.indexOf(inputInt) == -1){\n\t\t\tset.add(inputInt);\n\t\t}\n\t}\n\n\tpublic void addAll(OriginalSet inputSet){\n\t\tArrayList<Integer> inputArray = inputSet.set;\n\t\tfor(int i = 0; i < inputArray.size(); i++){\n\t\t\tadd(inputArray.get(i));\n\t\t}\n\t}\n\n\tpublic void remove(int inputInt){\n\t\tset.remove((Integer)inputInt);\n\t}\n\n\tpublic void removeAll(OriginalSet inputSet){\n\t\tArrayList<Integer> inputArray = inputSet.set;\n\t\tfor(int i = 0; i < inputArray.size(); i++){\n\t\t\tremove(inputArray.get(i));\n\t\t}\n\t}\n\n\tpublic void print(){\n\t\tif(set.size() == 0){\n\t\t\tSystem.out.println(\"NULL\");\n\t\t\treturn;\n\t\t}\n\t\t// ソート\n\t\tCollections.sort(set);\n\t\tSystem.out.print(set.get(0));\n\t\tfor(int i = 1; i < set.size(); i++){\n\t\t\tSystem.out.print(\" \" + set.get(i));\n\t\t}\n\t\tSystem.out.println();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.List;\nimport java.util.Scanner;\n\npublic class Main{\n\tpublic static char[][] map;\n\tpublic static int w, h;\n\tpublic static boolean[][] used;\n//\tpublic static int turn;\n\tpublic static void main(String[] args){\n\t\tScanner in = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tw = in.nextInt();\n\t\t\th = in.nextInt();\n\t\t\tif(w == 0) break;\n\t\t\tmap = new char[h][w];\n\t\t\tused = new boolean[h][w];\n//\t\t\tturn = 1;\n\t\t\tans = new ArrayList<Integer>();\n\t\t\tfor(int i=0; i<h; i++){\n\t\t\t\tmap[i] = in.next().toCharArray();\n\t\t\t}\n\t\t\tfor(int i=0; i<h; i++){\n\t\t\t\tfor(int j=0; j<w; j++){\n\t\t\t\t\tif(!Character.isDigit(map[i][j])\n\t\t\t\t\t\t\t|| used[i][j]) continue;\n\t\t\t\t\tdfs(j, i, new ArrayList<Integer>());\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i: ans){\n\t\t\t\tSystem.out.print(i);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\tpublic static final int[] dx = {1, 0};\n\tpublic static final int[] dy = {0, 1};\n\tpublic static List<Integer> ans;\n\tpublic static void dfs(int x, int y, List<Integer> num){\n\t\tnum.add(map[y][x]-'0');\n\t\tused[y][x] = true;\n\t\tboolean exp = false;\n\t\tfor(int i=0; i<2; i++){\n\t\t\tint ny = y+dy[i];\n\t\t\tint nx = x+dx[i];\n\t\t\tif(ny < 0 || ny >= h || nx < 0 || nx >= w) continue;\n\t\t\tif('A' <= map[ny][nx] && map[ny][nx] <= 'Z') continue;\n\t\t\texp = true;\n\t\t\tdfs(nx, ny, num);\n\t\t}\n\t\tif(!exp){\n\t\t\tint idx = 0;\n\t\t\twhile(idx < num.size() && num.get(idx) == 0) idx++;\n\t\t\tif(ans.size() < num.size()-idx){\n\t\t\t\tans = listing(idx, num);\n\t\t\t}else if(ans.size() == num.size()-idx){\n\t\t\t\tfor(int i=0; i<ans.size(); i++){\n\t\t\t\t\tif(ans.get(i) < num.get(i+idx)){\n\t\t\t\t\t\tans = listing(idx, num);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else if(ans.get(i) > num.get(i+idx))\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tnum.remove(num.size()-1);\n\t\t\n\t}\n\t\n\tpublic static List<Integer> listing(int idx, List<Integer> num){\n\t\tList<Integer> ans = new ArrayList<Integer>();\n\t\tfor(; idx<num.size(); idx++){\n\t\t\tans.add(num.get(idx));\n\t\t}\n\t\treturn ans;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;import java.math.*;class Main{public static void main(String[]z){Scanner s=new Scanner(System.in);BigInteger r,t;for(int w,h,i,j;(w=s.nextInt())>0;System.out.println(r.compareTo(BigInteger.ZERO)>0?r:\"\")){char[][]x=new char[h=s.nextInt()][];for(i=0;i<h;++i)x[i]=s.next().toCharArray();for(i=0,r=BigInteger.ZERO;i<h;++i)for(j=0;j<w;++j)r=r.compareTo(t=new BigInteger(f(x,i,j,h,w)))>0?r:t;}}static String f(char[][]a,int x,int y,int h,int w){if(x>=h||y>=w||a[x][y]<48||a[x][y]>57)return \"0\";String d=f(a,x+1,y,h,w),r=f(a,x,y+1,h,w),t;return a[x][y]+((t=(new BigInteger(d).compareTo(new BigInteger(r))>0?d:r)).equals(\"0\")?\"\":t);}}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.util.regex.*;\n\nimport static java.lang.Math.*;\nimport static java.lang.System.out;\n\n// AOJ\npublic class Main {\n\tfinal Scanner sc=new Scanner(System.in);\n\tpublic static void main(String[] args) {\n\t\tnew Main().AOJ1126();\n\t}\n\tstatic class Point{\n\t\tint x, y;\n\t\tPoint(int x, int y){\tthis.x=x;\tthis.y=y;}\n\t\tPoint(){\tthis.x=0; this.y=0;}\n\t\t@Override public String toString(){\treturn \"(\"+this.x+\",\"+this.y+\")\";}\n\t\tstatic boolean ok(int x,int y,int X,int Y,int min){\n\t\t\treturn (min<=x&&x<X && min<=y&&y<Y)?true:false;\n\t\t}\n\t\tstatic boolean ok(int x,int y,int X,int Y){\treturn ok(x,y,X,Y,0);}\n\t}\n\tfinal int[] vx={0,1,0,-1}, vy={-1,0,1,0};\n\n\t\n\tvoid AOJ1126(){\n\t\tint step=0;\n\t\twhile(sc.hasNext()){\n\t\t\tint W=sc.nextInt(), H=sc.nextInt();\n\t\t\tString ans=\"\";\n\t\t\tif((W|H)==0)\tbreak;\n\t\t\tchar[][] c=new char[W][H];\n\t\t\tString[][] close=new String[W][H];\n\t\t\tLinkedList<C1126> open=new LinkedList<C1126>();\n\t\t\tfor(int y=0; y<H; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<W; x++){\n\t\t\t\t\tc[x][y]=line.charAt(x);\n\t\t\t\t\tif(Character.isDigit(line.charAt(x))){\n\t\t\t\t\t\tif(x>0)\tif(Character.isDigit(c[x-1][y]))\tcontinue;\n\t\t\t\t\t\tif(y>0)\tif(Character.isDigit(c[x][y-1]))\tcontinue;\n\t\t\t\t\t\topen.add(new C1126(x,y,\"\"+c[x][y]));\n\t\t\t\t\t\tclose[x][y]=\"\"+c[x][y];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tC1126 now=open.poll();\n\t\t\t\t// TODO debug\n\t\t\t\t//out.println(\"ANS\"+ans+\" NOW\"+now.ans);\n\t\t\t\tans=now.compara(ans)?new String(now.ans):ans;\n\t\t\t\tfor(int i=1; i<3; i++){\n\t\t\t\t\tint xx=now.x+vx[i], yy=now.y+vy[i];\n\t\t\t\t\tif(!Point.ok(xx,yy,W,H))\tcontinue;\n\t\t\t\t\tif(Character.isDigit(c[xx][yy])){\n\t\t\t\t\t\tC1126 temp=new C1126(xx,yy,now.ans+c[xx][yy]);\n\t\t\t\t\t\tif(close[xx][yy]==null){\n\t\t\t\t\t\t\topen.add(temp);\n\t\t\t\t\t\t\tclose[xx][yy]=temp.ans;\n\t\t\t\t\t\t\tstep++;\n\t\t\t\t\t\t}else if(temp.compara(close[xx][yy])){\n\t\t\t\t\t\t\topen.add(temp);\n\t\t\t\t\t\t\tclose[xx][yy]=temp.ans;\n\t\t\t\t\t\t\tstep++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t\t//out.println(step+\"step\");\n\t}\n\tclass C1126{\n\t\tint x,y;\tString ans;\n\t\tC1126(int x,int y,String ans){\n\t\t\tthis.x=x;\tthis.y=y;\n\t\t\tif(ans.length()>0){\n\t\t\t\tint i=0;\n\t\t\t\twhile(ans.charAt(i)=='0'){\n\t\t\t\t\tif(++i>=ans.length()-1)\tbreak;\n\t\t\t\t\tans=ans.substring(i);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.ans=ans;\n\t\t}\n\t\tboolean compara(String ans){\n\t\t\tif(this.ans.length()>ans.length())\treturn true;\n\t\t\tif(this.ans.length()==ans.length()){\n\t\t\t\tfor(int i=0; i<ans.length(); i++){\n\t\t\t\t\tif(ans.charAt(i)<this.ans.charAt(i))\treturn true;\n\t\t\t\t\tif(ans.charAt(i)>this.ans.charAt(i))\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\tvoid AOJ0165(){\n\t\tfinal int MAX=1000000;\n\t\tboolean[] prime=Sieve(MAX);\n\t\t// 素数の個数の累積和を作る\n\t\twhile(sc.hasNext()){\n\t\t\tint N=sc.nextInt();\n\t\t\tif(N==0)\tbreak;\n\t\t\tint ans=0;\n\t\t\tfor(int i=1; i<=N; i++){\n\t\t\t\tint p=sc.nextInt(), m=sc.nextInt();\n\t\t\t\tint min=max(0,p-m), max=min(MAX, p+m);\n\t\t\t\tint temp=(min<=2?1:0);\n\t\t\t\tfor(int j=(min%2==0?min+1:min); j<=max; j+=2){\n\t\t\t\t\tif(prime[j])\ttemp++;\n\t\t\t\t}\n\t\t\t\t//out.println(\"TEMP\"+temp);\n\t\t\t\tans+=(temp==0?-1:temp-1);\n\t\t\t}\n\t\t\tout.println(max(0,ans));\n\t\t}\n\t}\n\t\n\tvoid AOJ1144(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(), Y=sc.nextInt();\n\t\t\tif((X|Y)==0)\tbreak;\n\t\t\tchar[][] c=new char[X][Y];\n\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\t\tc[x][y]=line.charAt(x);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\n\t// TODO 果樹園　RE　横型\n\tvoid AOJ0118(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(), Y=sc.nextInt(), ans=0;\n\t\t\tif((X|Y)==0)\tbreak;\n\t\t\tchar[][] c=new char[X+10][Y+10];\n\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\t\tc[x][y]=line.charAt(x);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\t\tif(c[x][y]=='&')\tcontinue;\n\t\t\t\t\tans++;\n\t\t\t\t\tLinkedList<Point> open=new LinkedList<Point>();\n\t\t\t\t\topen.add(new Point(x,y));\n\t\t\t\t\tchar mark=c[x][y];\n\t\t\t\t\twhile(!open.isEmpty()){\n\t\t\t\t\t\tPoint now=open.poll();\n\t\t\t\t\t\tc[now.x][now.y]='&';\n\t\t\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\t\t\tif(now.x+vx[i]<0 || now.x+vx[i]>=X || now.y+vy[i]<0 || now.y+vy[i]>=Y)\tcontinue;\n\t\t\t\t\t\t\tif(c[now.x+vx[i]][now.y+vy[i]]==mark){\n\t\t\t\t\t\t\t\t//out.println((now.x+vx[i])+\" \"+(now.y+vy[i]));\n\t\t\t\t\t\t\t\topen.add(new Point(now.x+vx[i],now.y+vy[i]));\n\t\t\t\t\t\t\t\tc[now.x+vx[i]][now.y+vy[i]]='&';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//out.println(\"ANS\"+ans);\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t}\n\t\n\t// Red and Black 横型探索\n\tvoid AOJ1130(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(), Y=sc.nextInt(),sx=0,sy=0,ans=0;\n\t\t\tif(X==0)\tbreak;\n\t\t\tchar[][] c=new char[X][Y];\n\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\tchar[] line=sc.next().toCharArray();\n\t\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\t\tc[x][y]=line[x];\n\t\t\t\t\tif(line[x]=='@'){\n\t\t\t\t\t\tsx=x;\tsy=y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tLinkedList<Point> open=new LinkedList<Point>();\n\t\t\topen.add(new Point(sx,sy));\n\t\t\tboolean[][] close=new boolean[X][Y];\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tans++;\n\t\t\t\tPoint now=open.poll();\n\t\t\t\tclose[now.x][now.y]=true;\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(now.x+vx[i]<0 || now.x+vx[i]>=X || now.y+vy[i]<0 || now.y+vy[i]>=Y)\tcontinue;\n\t\t\t\t\tif(c[now.x+vx[i]][now.y+vy[i]]=='.' && !close[now.x+vx[i]][now.y+vy[i]]){\n\t\t\t\t\t\topen.add(new Point(now.x+vx[i], now.y+vy[i]));\n\t\t\t\t\t\tclose[now.x+vx[i]][now.y+vy[i]]=true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t}\n\t\n\t// TODO デパート　TLE MLE WA\n\tvoid AOJ0223(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(),\tY=sc.nextInt();\n\t\t\tif(X==0)\tbreak;\n\t\t\tint tx=sc.nextInt(), ty=sc.nextInt(), kx=sc.nextInt(), ky=sc.nextInt();\n\t\t\tint[][] b=new int[X+1][Y+1];\n\t\t\tfor(int y=1; y<=Y; y++){\n\t\t\t\tfor(int x=1; x<=X; x++)\tb[x][y]=sc.nextInt();\n\t\t\t}\n\t\t\tLinkedList<C0223> open=new LinkedList<C0223>();\n\t\t\topen.add(new C0223(tx,ty,kx,ky,0));\n\t\t\tint[][][][] close2=new int[X+1][Y+1][X+1][Y+1];\n\t\t\tclose2[tx][ty][kx][ky]=-1;\n\t\t\tint ans=-1;\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tC0223 now=open.poll();\n\t\t\t\tif(now.ans()){\n\t\t\t\t\tans=now.sec;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(now.sec>=99)\tbreak;\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(0<now.tx+vx[i]&&now.tx+vx[i]<=X && 0<now.ty+vy[i]&&now.ty+vy[i]<=Y && 0<now.kx-vx[i]&&now.kx-vx[i]<=X && 0<now.ky-vy[i]&&now.ky-vy[i]<=Y){\n\t\t\t\t\t\ttx=now.tx;\tty=now.ty;\tkx=now.kx;\tky=now.ky;\n\t\t\t\t\t\tif(b[tx+vx[i]][ty+vy[i]]==0){\n\t\t\t\t\t\t\ttx+=vx[i];\tty+=vy[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(b[kx-vx[i]][ky-vy[i]]==0){\n\t\t\t\t\t\t\tkx-=vx[i];\tky-=vy[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//out.println(\"TEMP:\"+tx+\" \"+ty+\" \"+kx+\" \"+ky);\n\t\t\t\t\t\t//if(tx==kx && ty==ky)\tans=ans<0?now.sec+1:min(ans,now.sec+1);\n\t\t\t\t\t\tif(close2[tx][ty][kx][ky]==0 || close2[tx][ty][kx][ky]>now.sec+1){\n\t\t\t\t\t\t\t//out.println(\"ADD:\"+tx+\" \"+ty+\" \"+kx+\" \"+ky);\n\t\t\t\t\t\t\topen.add(new C0223(tx,ty,kx,ky,now.sec+1));\n\t\t\t\t\t\t\tclose2[tx][ty][kx][ky]=now.sec+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans<0? \"NA\": ans);\n\t\t}\n\t}\n\tclass C0223{\n\t\tint tx,ty,kx,ky,sec;\n\t\tC0223(int tx, int ty, int kx, int ky, int sec){\n\t\t\tthis.tx=tx;\tthis.ty=ty;\tthis.kx=kx;\tthis.ky=ky;\tthis.sec=sec;\n\t\t}\n\t\tboolean ans(){\n\t\t\tif(this.tx==this.kx && this.ty==this.ky)\treturn true;\n\t\t\telse\treturn false;\n\t\t}\n\t}\n\t\n\t\n\t// TODO WA\n\tvoid AOJ0142(){\n\t\twhile(sc.hasNext()){\n\t\t\tint n=sc.nextInt();\n\t\t\tif(n==0)\tbreak;\n\t\t\tint nn=(n-1)/2;\n\t\t\tboolean[] b=new boolean[n];\n\t\t\tfor(int i=1; i<n; i++)\tb[(i*i)%n]=true;\n\t\t\tArrayList<Integer> ar=new ArrayList<Integer>();\n\t\t\tfor(int i=1; i<n; i++){\n\t\t\t\tif(b[i])\tar.add(i);\n\t\t\t}\n\t\t\tint[] ans=new int[nn+1];\n\t\t\tfor(int i=0; i<ar.size(); i++){\n\t\t\t\tfor(int j=0; j<ar.size(); j++){\n\t\t\t\t\tif(i==j)\tcontinue;\n\t\t\t\t\tint temp=ar.get(i)-ar.get(j);\n\t\t\t\t\ttemp+= temp<0? n:0;\n\t\t\t\t\ttemp= temp>nn? n-temp: temp;\n\t\t\t\t\tans[temp]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=1; i<=nn; i++)\tout.println(ans[i]);\n\t\t}\n\t}\n\t\n\t\n\t// TODO レゴ　WA\n\tvoid AOJ0207(){\n\t\twhile(sc.hasNext()){\n\t\t\tint w=sc.nextInt(), h=sc.nextInt();\n\t\t\tif(w==0)\tbreak;\n\t\t\tint sx=sc.nextInt(), sy=sc.nextInt(), gx=sc.nextInt(), gy=sc.nextInt(), n=sc.nextInt();\n\t\t\tint[][] b=new int[w+2][h+2];\n\t\t\tfor(int i=0; i<n; i++){\n\t\t\t\tint color=sc.nextInt(), d=sc.nextInt(), x=sc.nextInt(), y=sc.nextInt();\n\t\t\t\tif(d==0){\t// 横 4x2\n\t\t\t\t\tfor(int j=y; j<y+2; j++){\n\t\t\t\t\t\tfor(int k=x; k<x+4; k++)\tb[k][j]=color;\n\t\t\t\t\t}\n\t\t\t\t}else{\t// 縦 2x4\n\t\t\t\t\tfor(int j=y; j<y+4; j++){\n\t\t\t\t\t\tfor(int k=x; k<x+2; k++)\tb[k][j]=color;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//debug\n\t\t\t//de0207(b,w,h);\n\t\t\tint[] vx={1,0,-1,0}, vy={0,1,0,-1};\n\t\t\tint xx=sx, yy=sy, cc=b[sx][sy], v=0, count=0, max=w*h;\n\t\t\tif(cc<1){\n\t\t\t\tout.println(\"NG\");\n\t\t\t\tSystem.exit(0);\n\t\t\t}\n\t\t\twhile(true){\n\t\t\t\tif(xx==gx && yy==gy && b[xx][yy]==cc){\n\t\t\t\t\tout.println(\"OK\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcount++;\n\t\t\t\tif(count>=max){\n\t\t\t\t\tout.println(\"NG\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t//b[xx][yy]=6;\n\t\t\t\tboolean flag=false;\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(b[xx+vx[i]][yy+vy[i]]==cc){\n\t\t\t\t\t\txx+=vx[i];\tyy+=vy[i];\tv=i;\n\t\t\t\t\t\tflag=true;\n\t\t\t\t\t\tout.println(\"X\"+xx+\" Y\"+yy);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(flag)\tcontinue;\n\t\t\t\txx-=vx[v];\tyy-=vy[v];\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(b[xx+vx[i]][yy+vy[i]]==cc){\n\t\t\t\t\t\txx+=vx[i];\tyy+=vy[i];\tv=i;\n\t\t\t\t\t\tflag=true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(flag)\tcontinue;\n\t\t\t\tout.println(\"END : X\"+xx+\" Y\"+yy);\n\t\t\t\tout.println(\"NG\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t//debug\n\t\t\tde0207(b,w,h);\n\t\t}\n\t}\n\tvoid de0207(int[][] b, int w, int h){\n\t\tfor(int j=0; j<=h; j++){\n\t\t\tfor(int i=0; i<=w; i++)\tout.print(b[i][j]+\" \");\n\t\t\tout.println();\n\t\t}\n\t\tfor(int i=0; i<=w; i++)\tout.print(\"-\");\n\t\tout.println();\n\t}\n\t\n\tvoid AOJ0139(){\n\t\tint N=sc.nextInt();\n\t\tfinal Pattern ap=Pattern.compile(\"^>'(=+)#(=+)~$\");\n\t\tfor(int i=1; i<=N; i++){\n\t\t\tString s=sc.next();\n\t\t\tMatcher m=ap.matcher(s);\n\t\t\tif(m.matches()){\n\t\t\t\tif(m.group(1).length()==m.group(2).length()){\n\t\t\t\t\tout.println(\"A\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}else if(Pattern.compile(\"^>\\\\^(Q=)+~~$\").matcher(s).matches()){\n\t\t\t\tout.println(\"B\");\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tout.println(\"NA\");\n\t\t}\n\t}\n\t\n\tArrayList<Integer> Sieve2(int N){\n\t\tArrayList<Integer> prime = new ArrayList<Integer>();\n\t\tboolean[] list = new boolean[N+1];\n\t\tArrays.fill(list, true);\n\t\tlist[1]=false;\n\t\tfor (int i=2; i<=N; i++) {\n\t\t\tif(list[i]) {\n\t\t\t\tprime.add(i);\n\t\t\t\tfor (int j=i+i; j<=N; j+=i)\tlist[j] = false;\n\t\t\t}\n\t\t}\n\t\treturn prime;\n\t}\n\n\tboolean[] Sieve(int N){\n\t\tboolean[] list = new boolean[N+1];\n\t\tArrays.fill(list, true);\n\t\tlist[0]=false;\tlist[1]=false;\n\t\tfor(int j=4; j<=N; j+=2)\tlist[j]=false;\n\t\tfor(int i=3; i*i<=N; i+=2) {\n\t\t\tif(list[i]) {\n\t\t\t\tfor (int j=i+i; j<=N; j+=i)\tlist[j] = false;\n\t\t\t}\n\t\t}\n\t\treturn list;\n\t}\n\t\n\tboolean isPrime(int n){\n\t\tfor(int i=2; i*i<=n; i++){\n\t\t\tif(n%i==0)     return false;\n\t\t}\n\t\treturn true;\n\t}\n\t\n\tint gcd(int x, int y){\n\t\tif(y==0)\treturn x;\n\t\telse\treturn gcd(y, x%y);\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;import java.math.*;class Main{public static void main(String[]z){Scanner s=new Scanner(System.in);BigInteger r,t;for(int w,h,i,j;(w=s.nextInt())>0;System.out.println(r)){char[][]x=new char[h = s.nextInt()][];m=new String[h][w];for(i=0;i<h;++i)x[i]=s.next().toCharArray();for(i=0,r=BigInteger.ZERO;i<h;++i)for(j=0;j<w;++j)r=r.compareTo(t=new BigInteger(f(x,i,j,h,w)))>0?r:t;}}static String[][]m;static String f(char[][]a,int x,int y,int h,int w){if(x>=h||y>=w||a[x][y]<48||a[x][y]>57)return \"0\";String d,r,t;if(m[x][y]!=null)return m[x][y];d=f(a,x+1,y,h,w);r=f(a,x,y+1,h,w);return m[x][y]=a[x][y]+((t=(new BigInteger(d).compareTo(new BigInteger(r))>0?d:r)).equals(\"0\")?\"\":t);}}"
  },
  {
    "language": "Java",
    "code": "import static java.lang.Math.*;\nimport static java.util.Arrays.*;\n\nimport java.util.*;\nimport java.io.*;\n\npublic class Main {\n\n\tvoid run() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tfor(;;) {\n\t\t\tint w = sc.nextInt(), h = sc.nextInt();\n\t\t\tif( (w|h) == 0 ) break;\n\t\t\tString[][] dp = new String[h+1][w+1];\n\t\t\tfor(String[] a: dp) fill(a, \"\");\n\t\t\tString c = \"\";\n\t\t\tfor(int i=1;i<=h;i++) {\n\t\t\t\tString l = sc.next();\n\t\t\t\tfor(int j=1;j<=w;j++) if( '0' <= l.charAt(j-1) && l.charAt(j-1) <= '9' ){\n\t\t\t\t\tdp[i][j] = (isLarge(dp[i][j-1], dp[i-1][j])? dp[i][j-1]: dp[i-1][j]);\n\t\t\t\t\tif( l.charAt(j-1) != '0' || dp[i][j].length() != 0  ) dp[i][j] += l.charAt(j-1);\n\t\t\t\t\tif( isLarge(dp[i][j], c) ) c = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(c);\n\t\t}\n\t}\n\t\n\tboolean isLarge(String a, String b) {\n\t\tif( a.length() != b.length() ) {\n\t\t\treturn a.length()>b.length();\n\t\t}\n\t\t\n\t\tfor(int i=0;i<a.length();i++) {\n\t\t\tif( a.charAt(i) > b.charAt(i) ) return true;\n\t\t\tif( a.charAt(i) < b.charAt(i) ) return false; \n\t\t}\n\t\treturn false;\n\t}\n\n\tvoid debug(Object... os) {\n\t\tSystem.err.println(Arrays.deepToString(os));\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\n\tstatic void solve() {\n\t\tfor (;;) {\n\t\t\tint m = ir.nextInt();\n\t\t\tint n = ir.nextInt();\n\t\t\tif (m == 0 && n == 0)\n\t\t\t\treturn;\n\t\t\tchar[][] map = ir.nextCharMap(n, m);\n\t\t\tString[][] dp = new String[n][m];\n\t\t\tString ret = \"\";\n\t\t\tfor (int i = n-1; i >= 0; i--) {\n\t\t\t\tfor (int j = m-1; j >= 0; j--) {\n\t\t\t\t\tif (map[i][j] >= 'A' && map[i][j] <= 'Z')\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tdp[i][j] = Character.toString(map[i][j]);\n\t\t\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\t\t\tint nx = i + (k & 1);\n\t\t\t\t\t\tint ny = j + ((k & 1) ^ 1);\n\t\t\t\t\t\tif (!(nx >= 0 && nx < n && ny >= 0 && ny < m))\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tif( map[nx][ny] >= 'A' && map[nx][ny] <= 'Z')\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tdp[i][j] = max(dp[i][j], Character.toString(map[i][j]) + dp[nx][ny]);\n\t\t\t\t\t}\n\t\t\t\t\tif(dp[i][j]!=null)\n\t\t\t\t\t\tret = max(ret, dp[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tint t=0;\n\t\t\twhile(t<ret.length()&&ret.charAt(t)=='0')\n\t\t\t\tt++;\n\t\t\tout.println(ret.substring(t));\n\t\t}\n\t}\n\n\tstatic String max(String a, String b) {\n\t\tif (a.length() > b.length())\n\t\t\treturn a;\n\t\tif (a.length() < b.length())\n\t\t\treturn b;\n\t\tfor (int i = 0; i < a.length(); i++) {\n\t\t\tif (a.charAt(i) > b.charAt(i))\n\t\t\t\treturn a;\n\t\t\tif (a.charAt(i) < b.charAt(i))\n\t\t\t\treturn b;\n\t\t}\n\t\treturn a;\n\t}\n\n\tpublic static void main(String[] args) throws Exception {\n\t\tir = new InputReader(System.in);\n\t\tout = new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer = new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {\n\t\t\tthis.in = in;\n\t\t\tthis.curbuf = this.lenbuf = 0;\n\t\t}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif (curbuf >= lenbuf) {\n\t\t\t\tcurbuf = 0;\n\t\t\t\ttry {\n\t\t\t\t\tlenbuf = in.read(buffer);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (lenbuf <= 0)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte() {\n\t\t\tif (hasNextByte())\n\t\t\t\treturn buffer[curbuf++];\n\t\t\telse\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tprivate boolean isSpaceChar(int c) {\n\t\t\treturn !(c >= 33 && c <= 126);\n\t\t}\n\n\t\tprivate void skip() {\n\t\t\twhile (hasNextByte() && isSpaceChar(buffer[curbuf]))\n\t\t\t\tcurbuf++;\n\t\t}\n\n\t\tpublic boolean hasNext() {\n\t\t\tskip();\n\t\t\treturn hasNextByte();\n\t\t}\n\n\t\tpublic String next() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tint b = readByte();\n\t\t\twhile (!isSpaceChar(b)) {\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb = readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic double nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tpublic int[] nextIntArray(int n) {\n\t\t\tint[] a = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n) {\n\t\t\tlong[] a = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n, int m) {\n\t\t\tchar[][] map = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tmap[i] = next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "\nimport java.util.Collections;\nimport java.util.LinkedList;\nimport java.util.ListIterator;\nimport java.util.Scanner;\n\n\npublic class Main {\n\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\t\n\t\twhile(true){\n\t\t\tfinal int W = sc.nextInt();\n\t\t\tfinal int H = sc.nextInt();\n\t\t\t\n\t\t\tif(W == 0  && H == 0){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tint[][] map = new int[H][W];\n\t\t\t\n\t\t\tfor(int i = 0; i < H; i++){\n\t\t\t\tchar[] input = sc.next().toCharArray();\n\t\t\t\t\n\t\t\t\tfor(int j = 0; j < W; j++){\n\t\t\t\t\tif('0' <= input[j] && input[j] <= '9'){\n\t\t\t\t\t\tmap[i][j] = input[j] - '0';\n\t\t\t\t\t}else{\n\t\t\t\t\t\tmap[i][j] = -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint[][] len = new int[H][W];\n\t\t\tshort[][][] dp = new short[H][W][H+W];\n\t\t\t\n\t\t\tint max = 0;\n\t\t\tint m_x = -1;\n\t\t\tint m_y = -1;\n\t\t\t\n\t\t\tfor(int i = 0; i < H; i++){\n\t\t\t\tfor(int j = 0; j < W; j++){\n\t\t\t\t\tif(map[i][j] < 0){\n\t\t\t\t\t\tdp[i][j][0] = -1;\n\t\t\t\t\t\tlen[i][j] = -1;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(i == 0 && j == 0){\n\t\t\t\t\t\tdp[i][j][0] = (short)(map[i][j]);\n\t\t\t\t\t\tlen[i][j] = map[i][j] == 0 ? 0 : 1;\n\t\t\t\t\t}else if(j == 0){\n\t\t\t\t\t\tfinal int p_len = len[i-1][j];\n\t\t\t\t\t\tif(p_len == -1){\n\t\t\t\t\t\t\tdp[i][j][0] = (short)(map[i][j]);\n\t\t\t\t\t\t\tlen[i][j] = map[i][j] == 0 ? 0 : 1;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tSystem.arraycopy(dp[i-1][j], 0, dp[i][j], 0, p_len);\n\t\t\t\t\t\t\tdp[i][j][p_len] = (short)(map[i][j]);\n\t\t\t\t\t\t\tlen[i][j] = p_len +  (p_len == 0 && map[i][j] == 0 ? 0 : 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else if(i == 0){\n\t\t\t\t\t\tfinal int p_len = len[i][j-1];\n\t\t\t\t\t\tif(p_len == -1){\n\t\t\t\t\t\t\tdp[i][j][0] = (short)(map[i][j]);\n\t\t\t\t\t\t\tlen[i][j] = map[i][j] == 0 ? 0 : 1;\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tSystem.arraycopy(dp[i][j-1], 0, dp[i][j], 0, p_len);\n\t\t\t\t\t\t\tdp[i][j][p_len] = (short)(map[i][j]);\n\t\t\t\t\t\t\tlen[i][j] = p_len + (p_len == 0 && map[i][j] == 0 ? 0 : 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\tfinal int left_len = len[i][j-1];\n\t\t\t\t\t\tfinal int up_len = len[i-1][j];\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(left_len == -1 && up_len == -1){\n\t\t\t\t\t\t\tdp[i][j][0] = (short)(map[i][j]);\n\t\t\t\t\t\t\tlen[i][j] = map[i][j] == 0 ? 0 : 1;\n\t\t\t\t\t\t}else if(left_len > up_len){\n\t\t\t\t\t\t\tfinal int p_len = len[i][j-1];\n\t\t\t\t\t\t\tSystem.arraycopy(dp[i][j-1], 0, dp[i][j], 0, p_len);\n\t\t\t\t\t\t\tdp[i][j][p_len] = (short)(map[i][j]);\n\t\t\t\t\t\t\tlen[i][j] = p_len + (p_len == 0 && map[i][j] == 0 ? 0 : 1);\n\t\t\t\t\t\t}else if(left_len < up_len){\n\t\t\t\t\t\t\tfinal int p_len = len[i-1][j];\n\t\t\t\t\t\t\tSystem.arraycopy(dp[i-1][j], 0, dp[i][j], 0, p_len);\n\t\t\t\t\t\t\tdp[i][j][p_len] = (short)(map[i][j]);\n\t\t\t\t\t\t\tlen[i][j] = p_len + (p_len == 0 && map[i][j] == 0 ? 0 : 1);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tfinal int size = len[i][j-1];\n\t\t\t\t\t\t\tboolean left_f = true;\n\t\t\t\t\t\t\tfor(int k = 0; k < size; k++){\n\t\t\t\t\t\t\t\tif(dp[i-1][j][k] < dp[i][j-1][k]){\n\t\t\t\t\t\t\t\t\tleft_f = true;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}else if(dp[i-1][j][k] > dp[i][j-1][k]){\n\t\t\t\t\t\t\t\t\tleft_f = false;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(left_f){\n\t\t\t\t\t\t\t\tfinal int p_len = len[i][j-1];\n\t\t\t\t\t\t\t\tSystem.arraycopy(dp[i][j-1], 0, dp[i][j], 0, p_len);\n\t\t\t\t\t\t\t\tdp[i][j][p_len] = (short)(map[i][j]);\n\t\t\t\t\t\t\t\tlen[i][j] = p_len + (p_len == 0 && map[i][j] == 0 ? 0 : 1);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tfinal int p_len = len[i-1][j];\n\t\t\t\t\t\t\t\tSystem.arraycopy(dp[i-1][j], 0, dp[i][j], 0, p_len);\n\t\t\t\t\t\t\t\tdp[i][j][p_len] = (short)(map[i][j]);\n\t\t\t\t\t\t\t\tlen[i][j] = p_len + (p_len == 0 && map[i][j] == 0 ? 0 : 1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(max < len[i][j]){\n\t\t\t\t\t\tmax = len[i][j];\n\t\t\t\t\t\tm_x = j;\n\t\t\t\t\t\tm_y = i;\n\t\t\t\t\t}else if(max == len[i][j]){\n\t\t\t\t\t\tfinal int size = len[i][j];\n\t\t\t\t\t\t\n\t\t\t\t\t\tfor(int k = 0; k < size; k++){\n\t\t\t\t\t\t\tif(dp[m_y][m_x][k] < dp[i][j][k]){\n\t\t\t\t\t\t\t\tmax = len[i][j];\n\t\t\t\t\t\t\t\tm_x = j;\n\t\t\t\t\t\t\t\tm_y = i;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}else if(dp[m_y][m_y][k] > dp[i][j][k]){\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\t\n\t\t\t}\n\t\t\t/*\n\t\t\tfor(int i = 0; i < H; i++){\n\t\t\t\tfor(int j = 0; j < W; j++){\n\t\t\t\t\tSystem.out.printf(\"%2d \", len[i][j]);\n\t\t\t\t}\n\t\t\t\tSystem.out.println();\n\t\t\t}\n\t\t\t*/\n\t\t\tfor(int i = 0; i < max; i++){\n\t\t\t\tSystem.out.print(dp[m_y][m_x][i]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t\t\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.Scanner;\n\n//The Secret Number\npublic class Main{\n\n\tvoid run(){\n\t\tScanner sc = new Scanner(System.in);\n\t\tfor(;;){\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tif((w|h)==0)break;\n\t\t\tchar[][] m = new char[h][w];\n\t\t\tfor(int i=0;i<h;i++)m[i]=sc.next().toCharArray();\n\t\t\tString[][] dp = new String[h][w];\n\t\t\tString res = \"0\";\n\t\t\tfor(int i=h-1;i>=0;i--)for(int j=w-1;j>=0;j--){\n\t\t\t\tif(Character.isUpperCase(m[i][j]))continue;\n\t\t\t\tString l = m[i][j]+\"\";\n\t\t\t\tString d = m[i][j]+\"\";\n\t\t\t\tif(i+1<h&&!Character.isUpperCase(m[i+1][j]))d+=dp[i+1][j];\n\t\t\t\tif(j+1<w&&!Character.isUpperCase(m[i][j+1]))l+=dp[i][j+1];\n\t\t\t\tBigInteger bl = new BigInteger(\"1\"+l);\n\t\t\t\tBigInteger bd = new BigInteger(\"1\"+d);\n\t\t\t\tif(bl.compareTo(bd)>0)dp[i][j] = l;\n\t\t\t\telse dp[i][j] = d;\n\t\t\t\tBigInteger b = new BigInteger(\"1\"+dp[i][j]);\n\t\t\t\tif(b.compareTo(new BigInteger(\"1\"+res))>0){\n\t\t\t\t\tres = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(new BigInteger(res).toString());\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import static java.lang.Math.*;\nimport static java.util.Arrays.*;\n\nimport java.util.*;\nimport java.io.*;\n\npublic class Main {\n\n\tvoid run() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tfor(;;) {\n\t\t\tint w = sc.nextInt(), h = sc.nextInt();\n\t\t\tif( (w|h) == 0 ) break;\n\t\t\tString[][] dp = new String[h+1][w+1];\n\t\t\tfor(String[] a: dp) fill(a, \"\");\n\t\t\tString c = \"\";\n\t\t\tfor(int i=1;i<=h;i++) {\n\t\t\t\tString l = sc.next();\n\t\t\t\tfor(int j=1;j<=w;j++) if( '0' <= l.charAt(j-1) && l.charAt(j-1) <= '9' ){\n\t\t\t\t\tdp[i][j] = (isLarge(dp[i][j-1], dp[i-1][j])? dp[i][j-1]: dp[i-1][j]);\n\t\t\t\t\tif( l.charAt(j-1) != '0' || dp[i][j].length() != 0  ) dp[i][j] += l.charAt(j-1);\n\t\t\t\t\tif( isLarge(dp[i][j], c) ) c = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(c);\n\t\t}\n\t}\n\t\n\tboolean isLarge(String a, String b) {\n\t\tif( a.length() != b.length() ) {\n\t\t\treturn a.length()>b.length();\n\t\t}\n\t\t\n\t\tfor(int i=min(a.length(), b.length())-1;i>=0;i--) {\n\t\t\tif( a.charAt(i) > b.charAt(i) ) return true;\n\t\t\tif( a.charAt(i) > b.charAt(i) ) return false; \n\t\t}\n\t\treturn false;\n\t}\n\n\tvoid debug(Object... os) {\n\t\tSystem.err.println(Arrays.deepToString(os));\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.Arrays;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\n\tstatic void solve() {\n\t\tint m=ir.nextInt();\n\t\tint n=ir.nextInt();\n\t\tchar[][] map=ir.nextCharMap(n, m);\n\t\tString[][] dp=new String[n][m];\n\t\tString ret=\"\";\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int j=0;j<m;j++){\n\t\t\t\tif(map[i][j]>='A'&&map[i][j]<='Z')\n\t\t\t\t\tcontinue;\n\t\t\t\tdp[i][j]=Character.toString(map[i][j]);\n\t\t\t\tfor(int k=0;k<2;k++){\n\t\t\t\t\tint nx=i+(k&1);\n\t\t\t\t\tint ny=j+((k&1)^1);\n\t\t\t\t\tif(nx>=0&&nx<n&&ny>=0&&ny<m&&map[nx][ny]>='A'&&map[nx][ny]<='Z')\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tdp[i][j]=max(dp[i][j],Character.toString(map[i][j])+dp[nx][ny]);\n\t\t\t\t}\n\t\t\t\tret=max(ret,dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tout.println(ret);\n\t}\n\n\tstatic String max(String a,String b){\n\t\tif(a.length()>b.length())\n\t\t\treturn a;\n\t\tif(a.length()<b.length())\n\t\t\treturn b;\n\t\tfor(int i=0;i<a.length();i++){\n\t\t\tif(a.charAt(i)>b.charAt(i))\n\t\t\t\treturn a;\n\t\t\tif(a.charAt(i)<b.charAt(i))\n\t\t\t\treturn b;\n\t\t}\n\t\treturn a;\n\t}\n\t\n\tpublic static void main(String[] args) throws Exception {\n\t\tir = new InputReader(System.in);\n\t\tout = new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer = new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {\n\t\t\tthis.in = in;\n\t\t\tthis.curbuf = this.lenbuf = 0;\n\t\t}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif (curbuf >= lenbuf) {\n\t\t\t\tcurbuf = 0;\n\t\t\t\ttry {\n\t\t\t\t\tlenbuf = in.read(buffer);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (lenbuf <= 0)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte() {\n\t\t\tif (hasNextByte())\n\t\t\t\treturn buffer[curbuf++];\n\t\t\telse\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tprivate boolean isSpaceChar(int c) {\n\t\t\treturn !(c >= 33 && c <= 126);\n\t\t}\n\n\t\tprivate void skip() {\n\t\t\twhile (hasNextByte() && isSpaceChar(buffer[curbuf]))\n\t\t\t\tcurbuf++;\n\t\t}\n\n\t\tpublic boolean hasNext() {\n\t\t\tskip();\n\t\t\treturn hasNextByte();\n\t\t}\n\n\t\tpublic String next() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tint b = readByte();\n\t\t\twhile (!isSpaceChar(b)) {\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb = readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic double nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tpublic int[] nextIntArray(int n) {\n\t\t\tint[] a = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n) {\n\t\t\tlong[] a = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n, int m) {\n\t\t\tchar[][] map = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tmap[i] = next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.Scanner;\n\n//The Secret Number\npublic class Main{\n\n\tvoid run(){\n\t\tScanner sc = new Scanner(System.in);\n\t\tfor(;;){\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tif((w|h)==0)break;\n\t\t\tchar[][] m = new char[h][w];\n\t\t\tfor(int i=0;i<h;i++)m[i]=sc.next().toCharArray();\n\t\t\tString[][] dp = new String[h][w];\n\t\t\tString res = \"0\";\n\t\t\tfor(int i=h-1;i>=0;i--)for(int j=w-1;j>=0;j--){\n\t\t\t\tif(Character.isUpperCase(m[i][j]))continue;\n\t\t\t\tString l = m[i][j]+\"\";\n\t\t\t\tString d = m[i][j]+\"\";\n\t\t\t\tif(i+1<h&&!Character.isUpperCase(m[i+1][j]))d+=dp[i+1][j];\n\t\t\t\tif(j+1<w&&!Character.isUpperCase(m[i][j+1]))l+=dp[i][j+1];\n\t\t\t\tBigInteger bl = new BigInteger(l);\n\t\t\t\tBigInteger bd = new BigInteger(d);\n\t\t\t\tif(bl.compareTo(bd)>0)dp[i][j] = l;\n\t\t\t\telse dp[i][j] = d;\n\t\t\t\tBigInteger b = new BigInteger(dp[i][j]);\n\t\t\t\tif(b.compareTo(new BigInteger(res))>0){\n\t\t\t\t\tres = dp[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(new BigInteger(res).toString());\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\n\npublic class Main {\n\tint m, n;\n\tchar[][] map;\n\tScanner in = new Scanner(System.in);\n\t\n\tString remove_zero(String s) {\n\t\tint k;\n\t\tfor (k = 0; k < s.length(); k++) {\n\t\t\tif (s.charAt(k) != '0') break;\n\t\t}\n\t\treturn s.substring(k, s.length()); \n\t}\n\t\n\tboolean compare(String s1, String s2) {\n\t\tif (s1.length() > s2.length()) return true;\n\t\telse if (s1.length() < s2.length()) return false;\n\t\telse {\n\t\t\tfor (int i = 0; i < s1.length(); i++) {\n\t\t\t\tif (s1.charAt(i) > s2.charAt(i)) return true;\n\t\t\t\telse if (s1.charAt(i) < s2.charAt(i)) return false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\t\n\tpublic Main() {\n\t\twhile (true) {\n\t\t\tint m = in.nextInt();\n\t\t\tint n = in.nextInt();\n\t\t\tif (m == 0 && n == 0) break;\n\t\t\tmap = new char[n+1][m+1];\n\t\t\tfor (int i = 1; i <= n; i++) {\n\t\t\t\tString s = in.next();\n\t\t\t\tfor (int j = 0; j < m; j++) {\n\t\t\t\t\tmap[i][j+1] = s.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tString[][] dp = new String[n+1][m+1];\n\t\t\tfor (int i = 0; i <= n; i++) \n\t\t\t\tfor (int j = 0; j <= m; j++) \n\t\t\t\t\tdp[i][j] = \"\";\n\t\t\t\n\t\t\tString ans = \"\";\t\t\n\t\t\tfor (int i = 1; i <= n; i++) {\n\t\t\t\tfor (int j = 1; j <= m; j++) {\n\t\t\t\t\tif (map[i][j] >= 'A' && map[i][j] <= 'Z' || map[i][j] == 0)\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\telse if (map[i][j] == '0' && dp[i][j-1] == \"\" && dp[i-1][j] == \"\") \n\t\t\t\t\t\tcontinue;\n\t\t\t\t\telse {\n\t\t\t\t\t\tdp[i][j] = (compare(dp[i][j-1] + map[i][j], dp[i][j])) ? dp[i][j-1] + map[i][j] : dp[i][j];\n\t\t\t\t\t\tdp[i][j] = (compare(dp[i-1][j] + map[i][j], dp[i][j])) ? dp[i-1][j] + map[i][j] : dp[i][j];\n\t\t\t\t\t}\n\t\t\t\t\tans = compare(dp[i][j], ans) ? dp[i][j] : ans;\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.Arrays;\nimport java.util.LinkedList;\nimport java.util.Queue;\nimport java.util.Scanner;\n\npublic class Main {\n\tMyScanner sc = new MyScanner();\n\tScanner sc2 = new Scanner(System.in);\n\tint mod = 1000000007;\n\n\tint[] dx = { 1, 0 };\n\tint[] dy = { 0, 1 };\n\n\tvoid run() {\n\t\tfor (;;) {\n\t\t\tint W = sc.nextInt();\n\t\t\tint H = sc.nextInt();\n\t\t\tif ((W | H) == 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tchar[][] field = new char[H][W];\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tString input = sc.next();\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tfield[i][j] = input.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tQueue<Point> que = new LinkedList<Point>();\n\t\t\tBigInteger ans = new BigInteger(\"0\");\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tif (Character.isDigit(field[i][j])) {\n\t\t\t\t\t\tque.add(new Point(j, i,\n\t\t\t\t\t\t\t\tnew BigInteger(field[i][j] + \"\")));\n\t\t\t\t\t\twhile (!que.isEmpty()) {\n\t\t\t\t\t\t\tint size = que.size();\n\t\t\t\t\t\t\tfor (int k = 0; k < size; k++) {\n\t\t\t\t\t\t\t\tPoint now = que.poll();\n\t\t\t\t\t\t\t\tans = ans.max(now.number);\n\n\t\t\t\t\t\t\t\tint nowH = now.h;\n\t\t\t\t\t\t\t\tint nowW = now.w;\n\t\t\t\t\t\t\t\tBigInteger nowNum = now.number;\n\t\t\t\t\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\t\t\t\t\tint nextH = nowH + dy[l];\n\t\t\t\t\t\t\t\t\tint nextW = nowW + dx[l];\n\t\t\t\t\t\t\t\t\tif (nextH < H\n\t\t\t\t\t\t\t\t\t\t\t&& nextW < W\n\t\t\t\t\t\t\t\t\t\t\t&& Character\n\t\t\t\t\t\t\t\t\t\t\t\t\t.isDigit(field[nextH][nextW])) {\n\t\t\t\t\t\t\t\t\t\tque.add(new Point(\n\t\t\t\t\t\t\t\t\t\t\t\tnextW,\n\t\t\t\t\t\t\t\t\t\t\t\tnextH,\n\t\t\t\t\t\t\t\t\t\t\t\tnew BigInteger(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tnowNum\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ \"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ new BigInteger(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfield[nextH][nextW]\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ \"\"))));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\n\tclass Point {\n\t\tint w;\n\t\tint h;\n\t\tBigInteger number;\n\n\t\t/**\n\t\t * @param w\n\t\t * @param h\n\t\t */\n\t\tpublic Point(int w, int h, BigInteger number) {\n\t\t\tsuper();\n\t\t\tthis.w = w;\n\t\t\tthis.h = h;\n\t\t\tthis.number = number;\n\t\t}\n\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid debug(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n\n\tvoid debug2(char[][] array) {\n\t\tfor (int i = 0; i < array.length; i++) {\n\t\t\tfor (int j = 0; j < array[i].length; j++) {\n\t\t\t\tSystem.out.print(array[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tclass MyScanner {\n\t\tint nextInt() {\n\t\t\ttry {\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (c != '-' && (c < '0' || '9' < c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tif (c == '-')\n\t\t\t\t\treturn -nextInt();\n\t\t\t\tint res = 0;\n\t\t\t\tdo {\n\t\t\t\t\tres *= 10;\n\t\t\t\t\tres += c - '0';\n\t\t\t\t\tc = System.in.read();\n\t\t\t\t} while ('0' <= c && c <= '9');\n\t\t\t\treturn res;\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tString next() {\n\t\t\ttry {\n\t\t\t\tStringBuilder res = new StringBuilder(\"\");\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (Character.isWhitespace(c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tdo {\n\t\t\t\t\tres.append((char) c);\n\t\t\t\t} while (!Character.isWhitespace(c = System.in.read()));\n\t\t\t\treturn res.toString();\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.Arrays;\nimport java.util.LinkedList;\nimport java.util.Queue;\nimport java.util.Scanner;\n\npublic class Main {\n\tMyScanner sc = new MyScanner();\n\tScanner sc2 = new Scanner(System.in);\n\tint mod = 1000000007;\n\n\tint[] dx = { 1, 0 };\n\tint[] dy = { 0, 1 };\n\n\tvoid run() {\n\t\tfor (;;) {\n\t\t\tint W = sc.nextInt();\n\t\t\tint H = sc.nextInt();\n\t\t\tif ((W | H) == 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tchar[][] field = new char[H][W];\n\t\t\tboolean[][] visit = new boolean[H][W];\n\t\t\tBigInteger[][] maxHist = new BigInteger[H][W];\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tString input = sc.next();\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tfield[i][j] = input.charAt(j);\n\t\t\t\t\tmaxHist[i][j] = new BigInteger(\"0\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tQueue<Point> que = new LinkedList<Point>();\n\t\t\tBigInteger ans = new BigInteger(\"0\");\n\t\t\tBigInteger tmp = new BigInteger(\"0\");\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tif (Character.isDigit(field[i][j]) && !visit[i][j]) {\n\t\t\t\t\t\tque.add(new Point(j, i, (field[i][j] + \"\")));\n\t\t\t\t\t\twhile (!que.isEmpty()) {\n\t\t\t\t\t\t\tint size = que.size();\n\t\t\t\t\t\t\tfor (int k = 0; k < size; k++) {\n\t\t\t\t\t\t\t\tPoint now = que.poll();\n\t\t\t\t\t\t\t\ttmp = new BigInteger(now.number);\n\t\t\t\t\t\t\t\tif(tmp.compareTo(maxHist[now.h][now.w]) <=0) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tans = ans.max(tmp);\n\t\t\t\t\t\t\t\tmaxHist[now.h][now.w] = ans;\n\n\t\t\t\t\t\t\t\tint nowH = now.h;\n\t\t\t\t\t\t\t\tint nowW = now.w;\n\t\t\t\t\t\t\t\tvisit[nowH][nowW] = true;\n\t\t\t\t\t\t\t\tString nowNum = now.number;\n\t\t\t\t\t\t\t\tfor (int l = 0; l < 2; l++) {\n\t\t\t\t\t\t\t\t\tint nextH = nowH + dy[l];\n\t\t\t\t\t\t\t\t\tint nextW = nowW + dx[l];\n\t\t\t\t\t\t\t\t\tif (nextH < H\n\t\t\t\t\t\t\t\t\t\t\t&& nextW < W\n\t\t\t\t\t\t\t\t\t\t\t&& Character\n\t\t\t\t\t\t\t\t\t\t\t\t\t.isDigit(field[nextH][nextW])) {\n\t\t\t\t\t\t\t\t\t\tque.add(new Point(nextW, nextH, nowNum\n\t\t\t\t\t\t\t\t\t\t\t\t+ \"\" + field[nextH][nextW]));\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\n\tclass Point {\n\t\tint w;\n\t\tint h;\n\t\tString number;\n\n\t\t/**\n\t\t * @param w\n\t\t * @param h\n\t\t */\n\t\tpublic Point(int w, int h, String number) {\n\t\t\tsuper();\n\t\t\tthis.w = w;\n\t\t\tthis.h = h;\n\t\t\tthis.number = number;\n\t\t}\n\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid debug(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n\n\tvoid debug2(char[][] array) {\n\t\tfor (int i = 0; i < array.length; i++) {\n\t\t\tfor (int j = 0; j < array[i].length; j++) {\n\t\t\t\tSystem.out.print(array[i][j]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tclass MyScanner {\n\t\tint nextInt() {\n\t\t\ttry {\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (c != '-' && (c < '0' || '9' < c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tif (c == '-')\n\t\t\t\t\treturn -nextInt();\n\t\t\t\tint res = 0;\n\t\t\t\tdo {\n\t\t\t\t\tres *= 10;\n\t\t\t\t\tres += c - '0';\n\t\t\t\t\tc = System.in.read();\n\t\t\t\t} while ('0' <= c && c <= '9');\n\t\t\t\treturn res;\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tString next() {\n\t\t\ttry {\n\t\t\t\tStringBuilder res = new StringBuilder(\"\");\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (Character.isWhitespace(c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tdo {\n\t\t\t\t\tres.append((char) c);\n\t\t\t\t} while (!Character.isWhitespace(c = System.in.read()));\n\t\t\t\treturn res.toString();\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.Arrays;\n\nimport static java.lang.Integer.parseInt;\n\n/**\n * The Secret Number\n */\npublic class Main {\n\n\tstatic final String EMPTY = \"\";\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line;\n\t\tString[] words;\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\n\t\t\tint W, H;\n\t\t\tW = parseInt(line.substring(0, line.indexOf(' ')));\n\t\t\tH = parseInt(line.substring(line.indexOf(' ') + 1));\n\t\t\tif ((W | H) == 0) break;\n\n\t\t\tchar[][] numc;\n\t\t\tString[][] nums;\n\n\t\t\tnumc = new char[H + 1][W + 1];\n\t\t\tnums = new String[H + 1][W + 1];\n\n\t\t\tfor (int i = 0; i < numc.length; i++) {\n\t\t\t\tArrays.fill(numc[i], 'X');\n\t\t\t}\n\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tline = br.readLine();\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tchar c = line.charAt(j);\n\t\t\t\t\tnumc[i][j] = (c <= '9' ? c : 'X');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//solve\n\t\t\tfor (int i = H - 1; i >= 0; i--) {\n\t\t\t\tfor (int j = W - 1; j >= 0; j--) {\n\t\t\t\t\tif (numc[i][j] != 'X') {\n\t\t\t\t\t\tString s1 = (numc[i + 1][j] != 'X' ? nums[i + 1][j] : EMPTY);\n\t\t\t\t\t\tString s2 = (numc[i][j + 1] != 'X' ? nums[i][j + 1] : EMPTY);\n\t\t\t\t\t\tnums[i][j] = numc[i][j] + large(s1, s2);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tString max = EMPTY;\n\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tif (nums[i][j] != null) {\n\t\t\t\t\t\tnums[i][j] = nums[i][j].replaceFirst(\"^0+\", \"\");\n\t\t\t\t\t\tmax = large(max, nums[i][j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tSystem.out.println(max);\n\n\t\t} //end while\n\n\t} //end main\n\n\tstatic String large(String s1, String s2) {\n\n\t\tif (s1.length() > s2.length()) return s1;\n\t\tif (s1.length() < s2.length()) return s2;\n\t\tif (s1.equals(s2)) return s1;\n\n\t\tString ret = EMPTY;\n\t\tfor (int i = 0; i < s1.length(); i++) {\n\t\t\tif (s1.charAt(i) > s2.charAt(i)) {\n\t\t\t\tret = s1;\n\t\t\t\tbreak;\n\t\t\t} else if (s1.charAt(i) < s2.charAt(i)) {\n\t\t\t\tret = s2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.Arrays;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\n\tstatic void solve() {\n\t\tint n=ir.nextInt();\n\t\tint m=ir.nextInt();\n\t\tchar[][] map=ir.nextCharMap(n, m);\n\t\tString[][] dp=new String[n][m];\n\t\tString ret=\"\";\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int j=0;j<m;j++){\n\t\t\t\tif(map[i][j]>='A'&&map[i][j]<='Z')\n\t\t\t\t\tcontinue;\n\t\t\t\tdp[i][j]=Character.toString(map[i][j]);\n\t\t\t\tfor(int k=0;k<2;k++){\n\t\t\t\t\tint nx=i+(k&1);\n\t\t\t\t\tint ny=j+((k&1)^1);\n\t\t\t\t\tif(nx>=0&&nx<n&&ny>=0&&ny<m&&map[nx][ny]>='A'&&map[nx][ny]<='Z')\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tdp[i][j]=max(dp[i][j],Character.toString(map[i][j])+dp[nx][ny]);\n\t\t\t\t}\n\t\t\t\tret=max(ret,dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tout.println(ret);\n\t}\n\n\tstatic String max(String a,String b){\n\t\tif(a.length()>b.length())\n\t\t\treturn a;\n\t\tif(a.length()<b.length())\n\t\t\treturn b;\n\t\tfor(int i=0;i<a.length();i++){\n\t\t\tif(a.charAt(i)>b.charAt(i))\n\t\t\t\treturn a;\n\t\t\tif(a.charAt(i)<b.charAt(i))\n\t\t\t\treturn b;\n\t\t}\n\t\treturn a;\n\t}\n\t\n\tpublic static void main(String[] args) throws Exception {\n\t\tir = new InputReader(System.in);\n\t\tout = new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer = new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {\n\t\t\tthis.in = in;\n\t\t\tthis.curbuf = this.lenbuf = 0;\n\t\t}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif (curbuf >= lenbuf) {\n\t\t\t\tcurbuf = 0;\n\t\t\t\ttry {\n\t\t\t\t\tlenbuf = in.read(buffer);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (lenbuf <= 0)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte() {\n\t\t\tif (hasNextByte())\n\t\t\t\treturn buffer[curbuf++];\n\t\t\telse\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tprivate boolean isSpaceChar(int c) {\n\t\t\treturn !(c >= 33 && c <= 126);\n\t\t}\n\n\t\tprivate void skip() {\n\t\t\twhile (hasNextByte() && isSpaceChar(buffer[curbuf]))\n\t\t\t\tcurbuf++;\n\t\t}\n\n\t\tpublic boolean hasNext() {\n\t\t\tskip();\n\t\t\treturn hasNextByte();\n\t\t}\n\n\t\tpublic String next() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tint b = readByte();\n\t\t\twhile (!isSpaceChar(b)) {\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb = readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic double nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tpublic int[] nextIntArray(int n) {\n\t\t\tint[] a = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n) {\n\t\t\tlong[] a = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n, int m) {\n\t\t\tchar[][] map = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tmap[i] = next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\n\tstatic int[][] field;\n\tstatic String[][] dp;\n\tstatic int h,w;\n\tpublic static void main(String[] args) {\n\t\tScanner cin = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tw = cin.nextInt();\n\t\t\th = cin.nextInt();\n\t\t\tif(w+h==0)break;\n\t\t\tfield=new int[h][w];\n\t\t\tdp=new String[h][w];\n\t\t\tfor(int i = 0;i<h;i++){\n\t\t\t\tString s = cin.next();\n\t\t\t\tfor(int j = 0;j<w;j++){\n\t\t\t\t\tdp[i][j]=\"\";\n\t\t\t\t\tif(Character.isDigit(s.charAt(j))){\n\t\t\t\t\t\tfield[i][j]=s.charAt(j)-'0';\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tfield[i][j]=-1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0;i<w;i++){\n\t\t\t\tif(i==0){\n\t\t\t\t\tif(field[0][i]<=0){\n\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tdp[0][i]=\"\"+field[0][i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tif(field[0][i]<=0){\n\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tif(!dp[0][i-1].equals(\"0\")&&!dp[0][i-1].equals(\"\")){\n\t\t\t\t\t\t\tdp[0][i]=dp[0][i-1]+field[0][i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[0][i]=\"\"+field[0][i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0;i<h;i++){\n\t\t\t\tif(i==0){\n\t\t\t\t\tif(field[i][0]<=0){\n\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tdp[i][0]=\"\"+field[i][0];\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tif(field[i][0]<=0){\n\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tif(!dp[i-1][0].equals(\"0\")&&!dp[i-1][0].equals(\"\")){\n\t\t\t\t\t\t\tdp[i][0]=dp[i-1][0]+field[i][0];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[i][0]=\"\"+field[i][0];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tString ans=\"0\";\n\t\t\tfor(int i = 1;i<h;i++){\n\t\t\t\tfor(int j = 1;j<w;j++){\n\t\t\t\t\tif(field[i][j]==-1)continue;\n\t\t\t\t\tString s1=dp[i-1][j]+field[i][j];\n\t\t\t\t\tString s2=dp[i][j-1]+field[i][j];\n\t\t\t\t\tString s3=field[i][j]+\"\";\n\t\t\t\t\tif(big(s1,s2)>=0){\n\t\t\t\t\t\tif(big(s1,s3)>=0){\n\t\t\t\t\t\t\tdp[i][j]=s1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[i][j]=s3;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tif(big(s2,s3)>=0){\n\t\t\t\t\t\t\tdp[i][j]=s2;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[i][j]=s3;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\twhile(dp[i][j].charAt(0)=='0'&&dp[i][j].length()>1){\n\t\t\t\t\t\tdp[i][j]=dp[i][j].substring(1,dp[i][j].length());\n\t\t\t\t\t}\n\t\t\t\t\tif(big(dp[i][j],ans)>0){\n\t\t\t\t\t\tans=dp[i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0;i<h;i++){\n\t\t\t\tfor(int j = 0;j<w;j++){\n\t\t\t\t\tif(big(dp[i][j],ans)>0){\n\t\t\t\t\t\tans=dp[i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//output();\n\t\t\tSystem.out.println(ans);\n\t\t}\n\n\t}\n\tstatic int big(String s1,String s2){\n\t\tif(s1.length()==s2.length()){\n\t\t\treturn s1.compareTo(s2);\n\t\t}\n\t\treturn s1.length()-s2.length();\n\t}\n\tstatic void output(){\n\t\tfor(int i = 0;i<h;i++){\n\t\t\tfor(int j = 0;j<w;j++){\n\t\t\t\tSystem.out.print(dp[i][j]+\" \");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t\tSystem.out.println();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "\n\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.Scanner;\n\npublic class Main \n{\n\tstatic Scanner scan = new Scanner(System.in);\n\t\n\tpublic static void main(String[] args) \n\t{\n\t\tint w;\n\t\tint h;\n\n\t\t//numbers: ascii 48 ~ 57 are 0 ~ 9\n\t\t\n\t\twhile(true)\n\t\t{\n\t\t\tw = scan.nextInt();\n\t\t\th = scan.nextInt();\n\t\t\t\n\t\t\tif(w == 0 && h == 0)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnew DataSet(w,h);\n\t\t\t}\n\t\t\t\n\t\t}\n\t}\n\t\n\tstatic class DataSet\n\t{\n\t\tint width;\n\t\tint height;\n\t\tchar[][] grid;\n\t\tList<Integer> startX = new ArrayList<Integer>();\n\t\tList<Integer> startY = new ArrayList<Integer>();\n\t\t\n\t\tpublic DataSet(int w, int h)\n\t\t{\n\t\t\tthis.width = w;\n\t\t\tthis.height = h;\n\t\t\t\n\t\t\tgrid = new char[w][h];\n\t\t\t\n\t\t\tfor(int row = 0; row < h; row++)\n\t\t\t{\n\t\t\t\tString str = scan.next();\n\t\t\t\t\n\t\t\t\tfor(int ch = 0; ch < w; ch++)\n\t\t\t\t{\n\t\t\t\t\t//numbers: ascii 48 ~ 57 are 0 ~ 9\n\t\t\t\t\tgrid[ch][row] = str.charAt(ch);\n\t\t\t\t\t\n\t\t\t\t\t//is it a starting point?\n\t\t\t\t\t//check X\n\t\t\t\t\tif(ch == 0 || charIsNumber(grid[ch-1][row]) == false)\n\t\t\t\t\t{\n\t\t\t\t\t\t//check Y\n\t\t\t\t\t\tif(row == 0 || charIsNumber(grid[ch][row-1]) == false)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstartX.add(ch);\n\t\t\t\t\t\t\tstartY.add(row);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\tString biggest = \"0\";\n\t\t\t\n\t\t\tfor(int i = 0; i < startX.size(); i++)\n\t\t\t{\n\t\t\t\tString att = compute(startX.get(i), startY.get(i), \"\");\n\t\t\t\tatt = removeZeroesAtStart(att);\n\t\t\t\t\n//\t\t\t\tif(Integer.parseInt(att) > Integer.parseInt(biggest))\n\t\t\t\tif(firstStringIsBigger(att, biggest))\n\t\t\t\t{\n\t\t\t\t\tbiggest = \"\" + att;\n//\t\t\t\t\tSystem.out.println(\"biggest is now \" + biggest);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tSystem.out.println(biggest);\n\t\t}\n\t\t\n\t\tString compute(int x, int y, String con)\n\t\t{\n\t\t\tString content = con;\n\t\t\t//ender\n\t\t\tif(x < width && y < height && charIsNumber(grid[x][y]))\n\t\t\t{\n\t\t\t\t//a number: ADD\n\t\t\t\tcontent += grid[x][y];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t//not a number: END\n\t\t\t\treturn con;\n\t\t\t}\n\t\t\t\n\t\t\t//\n\t\t\t\n\t\t\tString right = compute(x+1,y, content);\n\t\t\tString down = compute(x,y+1, content);\n\t\t\t\n//\t\t\tif(Integer.parseInt(right) > Integer.parseInt(down))\n\t\t\tif(firstStringIsBigger(right, down))\n\t\t\t{\n\t\t\t\treturn right;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn down;\n\t\t\t}\n\t\t}\n\t\t\n\t\tpublic String removeZeroesAtStart(String a)\n\t\t{\n\t\t\tString ans = a;\n\t\t\t\n\t\t\twhile(true)\n\t\t\t{\n//\t\t\t\tSystem.out.println(\"checking \" + a);\n\t\t\t\t\n\t\t\t\tif(a.equals(\"\")) {return a;}\n\t\t\t\tif(a.charAt(0) == 48)\n\t\t\t\t{\n\t\t\t\t\ta = a.substring(1);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tboolean firstStringIsBigger(String a, String b)\n\t\t{\n\t\t\ta = removeZeroesAtStart(a);\n\t\t\tb = removeZeroesAtStart(b);\n\t\t\t\n\t\t\tif(a.length() > b.length()) {return true;}\n\t\t\tif(a.length() < b.length()) {return false;}\n\t\t\t\n\t\t\t//when length is the same: compare from the 1st digit (most significant)\n\t\t\t\n\t\t\tfor(int i = 0; i < a.length(); i++)\n\t\t\t{\n\t\t\t\tif(a.charAt(i) > b.charAt(i))\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tif(a.charAt(i) < b.charAt(i))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\t\n\t\tboolean charIsNumber(char c)\n\t\t{\n\t\t\tif(c >= 48 && c <= 57)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.math.*;\n\npublic class Main {\n\t\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\t\n\t\twhile(true){\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tif(w==0 && h==0) break;\n\t\t\t\n\t\t\tBigInteger[][] bi = new BigInteger[h+1][w+1];\n\t\t\tfor(int i=0;i<=h;i++){\n\t\t\t\tfor(int j=0;j<=w;j++){\n\t\t\t\t\tbi[i][j] = BigInteger.ZERO;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tBigInteger zero = BigInteger.ZERO;\n\t\t\tBigInteger max = BigInteger.ZERO;\n\t\t\tString s, t;\n\t\t\tfor(int i=1;i<=h;i++){\n\t\t\t\ts = sc.next();\n\t\t\t\tfor(int j=1;j<=w;j++){\n\t\t\t\t\tt = s.substring(j-1,j);\n\t\t\t\t\tif(t.codePointAt(0)<58){\n\t\t\t\t\t\tif(bi[i][j-1].compareTo(zero)==0 && bi[i-1][j].compareTo(zero)==0 && t.compareTo(\"0\")==0) continue;\n\t\t\t\t\t\tBigInteger x = bi[i][j-1].multiply(BigInteger.TEN).add(new BigInteger(t));\n\t\t\t\t\t\tBigInteger y = bi[i-1][j].multiply(BigInteger.TEN).add(new BigInteger(t));\n\t\t\t\t\t\tif(x.compareTo(y)>0) bi[i][j] = x;\n\t\t\t\t\t\telse bi[i][j] = y;\n\t\t\t\t\t\tif(max.compareTo(bi[i][j])<0) max = bi[i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(max);\n\t\t}\n\t}\t\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.*;\n\n\npublic class Main {\n\tstatic ArrayList<String> cand = new ArrayList<String>();\n\tpublic static void main(String[] args) {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));       \n\t\ttry {\n\t\t\tString line;\n\t\t\twhile(true){\n\t\t\t\t/* input */\n\t\t\t\tcand = new ArrayList<String>();\n\t\t\t\tline = br.readLine();\n\n\t\t\t\tint w = Integer.parseInt(line.split(\" \")[0]);\n\t\t\t\tint h = Integer.parseInt(line.split(\" \")[1]);\n\t\t\t\tif(w == 0 && h == 0){\n\t\t\t\t\treturn;\n\t\t\t\t} \n\n\t\t\t\tchar[][] field = new char[h][w];\n\t\t\t\tfor(int i=0;i<h;i++){\n\t\t\t\t\tline = br.readLine();\n\t\t\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\t\t\tfield[i][j] = line.charAt(j);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t/* processing */\n\t\t\t\tfor(int i=0;i<h;i++){\n\t\t\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\t\t\tif(i>0){\n\t\t\t\t\t\t\tif(Character.isDigit(field[i-1][j])&&(field[i-1][j]!='0')){\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(j>0){\n\t\t\t\t\t\t\tif(Character.isDigit(field[i][j-1])&&(field[i][j-1]!='0')){\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(Character.isDigit(field[i][j])&&(field[i][j]!='0')){\n\t\t\t\t\t\t\t\tsearch(i,j,field,h,w,\"\"+field[i][j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/* output */\n\t\t\t\tCollections.sort(cand);\n\t\t\t\tint maxlength = 0;\n\t\t\t\tString maxs = \"\";\n\t\t\t\tfor(String s: cand){\n\t\t\t\t\tif (s.length()>maxlength){\n\t\t\t\t\t\tmaxlength = s.length();\n\t\t\t\t\t\tmaxs = s;\n\t\t\t\t\t} else if(s.length()==maxlength){\n\t\t\t\t\t\tfor(int i=0;i<s.length();i++){\n\t\t\t\t\t\t\tif(s.charAt(i)>maxs.charAt(i)){\n\t\t\t\t\t\t\t\tmaxs = s;\n\t\t\t\t\t\t\t} else if(s.charAt(i)>maxs.charAt(i)){\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//System.out.println();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tSystem.out.println(maxs);\n\t\t\t}\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\n\tpublic static void search(int i,int j,char[][] field,int h,int w, String s){\n\t\tboolean r = true, d = true;\n\t\tif(j<w-1){\n\t\t\tif(Character.isDigit(field[i][j+1])){\n\t\t\t\tsearch(i,j+1,field,h,w,s + field[i][j+1]);\n\t\t\t\tr = false;\n\t\t\t}\n\t\t}\n\n\t\tif(i<h-1){\n\t\t\tif(Character.isDigit(field[i+1][j])){\n\t\t\t\tsearch(i+1,j,field,h,w,s + field[i+1][j]);\n\t\t\t\td = false;\n\t\t\t}\n\t\t}\n\t\tif(r&&d){\n\t\t\tcand.add(s);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.math.*;\nclass Main{\n    int w,h;\n    char[][] map;\n    String[][] dp;\n    void run(){\n\tScanner sc= new Scanner(System.in);\n\twhile(true){\n\t    w=sc.nextInt();\n\t    h=sc.nextInt();\n\t    if((w|h)==0)break;\n\t    map=new char[h+1][w+1];\n\t    dp=new String[h+1][w+1];\t   \n\t    \n\t    for(int i=0;i<h+1;i++){\n\t\tArrays.fill(dp[i],\"\");\n\t    }\n\t    BigInteger max=new BigInteger(\"0\");\n\t    for(int i=0;i<h;i++){\n\t\tmap[i]=(sc.next()+\"A\").toCharArray();\n\t    }\n\t    for(int i=h-1;i>=0;i--){\n\t\tfor(int j=w-1;j>=0;j--){\n\t\t    if(Character.isDigit(map[i][j])){\n\t\t\tdp[i][j]=(map[i][j]+compare(dp[i+1][j],dp[i][j+1]));\n\t\t\tBigInteger temp=new BigInteger(dp[i][j]);\n\t\t\tif(temp.compareTo(max)>0)max=temp;\n\t\t    }\n\t\t}\n\t    }\n\t    \n\t    System.out.println(max);\n\t}\n    }\n    String compare(String a,String b){\n\tif(a.length()>b.length())return a;\n\telse if(a.length()<b.length())return b;\n\telse {\n\t    if(a.compareTo(b)>0)return a;\n\t    else return b;\n\t}\n    }\n    public static void main(String[] args){\n\tnew Main().run();\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.io.*;\nimport java.awt.geom.*;\nimport java.math.*;\n\npublic class Main {\n\n\tstatic final Scanner in = new Scanner(System.in);\n\tstatic final PrintWriter out = new PrintWriter(System.out,false);\n\tstatic boolean debug = false;\n\n\tstatic char[][] t;\n\tstatic int[] dx = {0, 1};\n\tstatic int[] dy = {1, 0};\n\n\tstatic int h, w;\n\n\tstatic String rec(int cy, int cx) {\n\t\tString max = \"\";\n\t\tfor (int k=0; k<2; k++) {\n\t\t\tint ny = cy + dy[k];\n\t\t\tint nx = cx + dx[k];\n\t\t\tif (h <= ny || w <= nx) continue;\n\t\t\tif ('0' <= t[ny][nx] && t[ny][nx] <= '9') {\n\t\t\t\tString tmp = rec(ny, nx);\n\t\t\t\tif (tmp.length() > max.length()) max = tmp;\n\t\t\t\telse if (tmp.length() == max.length() && tmp.compareTo(max) > 0) max = tmp;\n\t\t\t}\n\t\t}\n\t\tif (max.equals(\"\")) return String.valueOf(t[cy][cx]);\n\t\treturn t[cy][cx] + max;\n\t}\n\n\tstatic boolean solve() {\n\t\tw = in.nextInt();\n\t\th = in.nextInt();\n\t\tif (w + h == 0) return false;\n\n\t\tt = new char[h][w];\n\t\tfor (int i=0; i<h; i++) {\n\t\t\tt[i] = in.next().toCharArray();\n\t\t}\n\n\t\tString ans = \"\";\n\t\tfor (int i=0; i<h; i++) {\n\t\t\tfor (int j=0; j<w; j++) {\n\t\t\t\tif ('0' <= t[i][j] && t[i][j] <= '9') {\n\t\t\t\t\tString tmp = rec(i, j);\n\t\t\t\t\tint pos = 0;\n\t\t\t\t\twhile (pos < tmp.length() && tmp.charAt(pos) == '0') pos++;\n\t\t\t\t\ttmp = tmp.substring(pos, tmp.length());\n\t\t\t\t\tif (tmp.length() > ans.length()) ans = tmp;\n\t\t\t\t\telse if (tmp.length() == ans.length() && tmp.compareTo(ans) > 0) ans = tmp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tout.println(ans);\n\n\t\treturn true;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tdebug = args.length > 0;\n\t\tlong start = System.nanoTime();\n\n\t\twhile(solve());\n\t\tout.flush();\n\n\t\tlong end = System.nanoTime();\n\t\tdump((end - start) / 1000000 + \" ms\");\n\t\tin.close();\n\t\tout.close();\n\t}\n\n\tstatic void dump(Object... o) { if (debug) System.err.println(Arrays.deepToString(o)); }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tif (w == 0 && h == 0)\n\t\t\t\tbreak;\n\t\t\tString[] str = new String[h];\n\t\t\tfor (int i = 0; i < h; i++)\n\t\t\t\tstr[i] = sc.next();\n\t\t\tString[][] field = new String[h][w];\n\t\t\tfor (int i = 0; i < h; i++)\n\t\t\t\tfor (int j = 0; j < w; j++)\n\t\t\t\t\tfield[i][j] = \"\";\n\t\t\tswitch (str[0].charAt(0)) {\n\t\t\tcase '0':\n\t\t\tcase '1':\n\t\t\tcase '2':\n\t\t\tcase '3':\n\t\t\tcase '4':\n\t\t\tcase '5':\n\t\t\tcase '6':\n\t\t\tcase '7':\n\t\t\tcase '8':\n\t\t\tcase '9':\n\t\t\t\tfield[0][0] = str[0].substring(0, 1);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfield[0][0] = \"\";\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tString max = field[0][0];\n\t\t\tfor (int i = 0; i < h; i++)\n\t\t\t\tfor (int j = 0; j < w; j++) {\n\t\t\t\t\tswitch (str[i].charAt(j)) {\n\t\t\t\t\tcase '0':\n\t\t\t\t\tcase '1':\n\t\t\t\t\tcase '2':\n\t\t\t\t\tcase '3':\n\t\t\t\t\tcase '4':\n\t\t\t\t\tcase '5':\n\t\t\t\t\tcase '6':\n\t\t\t\t\tcase '7':\n\t\t\t\t\tcase '8':\n\t\t\t\t\tcase '9':\n\t\t\t\t\t\tif (i > 0) {\n\t\t\t\t\t\t\tif (field[i - 1][j].equals(\"\")\n\t\t\t\t\t\t\t\t\t|| field[i - 1][j].equals(\"0\"))\n\t\t\t\t\t\t\t\tfield[i][j] = maxString(field[i][j],\n\t\t\t\t\t\t\t\t\t\tstr[i].substring(j, j + 1));\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tfield[i][j] = maxString(\n\t\t\t\t\t\t\t\t\t\tfield[i][j],\n\t\t\t\t\t\t\t\t\t\tfield[i - 1][j]\n\t\t\t\t\t\t\t\t\t\t\t\t+ str[i].substring(j, j + 1));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (j > 0) {\n\t\t\t\t\t\t\tif (field[i][j - 1].equals(\"\")\n\t\t\t\t\t\t\t\t\t|| field[i][j - 1].equals(\"0\"))\n\t\t\t\t\t\t\t\tfield[i][j] = maxString(field[i][j],\n\t\t\t\t\t\t\t\t\t\tstr[i].substring(j, j + 1));\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tfield[i][j] = maxString(\n\t\t\t\t\t\t\t\t\t\tfield[i][j],\n\t\t\t\t\t\t\t\t\t\tfield[i][j - 1]\n\t\t\t\t\t\t\t\t\t\t\t\t+ str[i].substring(j, j + 1));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tfield[i][j] = \"\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tmax = maxString(max, field[i][j]);\n\t\t\t\t}\n\t\t\tSystem.out.println(max);\n\t\t}\n\t\tsc.close();\n\t}\n\n\tstatic String maxString(String a, String b) {\n\t\tString result = \"\";\n\t\tif (a.length() > b.length())\n\t\t\tresult = a;\n\t\tif (a.length() < b.length())\n\t\t\tresult = b;\n\t\tif (a.length() == b.length()) {\n\t\t\tif (a.compareTo(b) < 0)\n\t\t\t\tresult = b;\n\t\t\telse\n\t\t\t\tresult = a;\n\t\t}\n\t\treturn result;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tprivate static char[][] grid;\n\tprivate static String[][] dp;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tScanner scanner = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint N = scanner.nextInt();\n\t\t\tif (N == 0) {\n\t\t\t\tscanner.close();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tint M = scanner.nextInt();\n\n\t\t\tgrid = new char[M][N];\n\t\t\tdp = new String[M][N];\n\t\t\tfor (int i = 0; i < grid.length; i++) {\n\t\t\t\tString line = scanner.next();\n\t\t\t\tfor (int j = 0; j < grid[i].length; j++) {\n\t\t\t\t\tgrid[i][j] = line.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tString ans = \"\";\n\t\t\tfor (int i = 0; i < grid.length; i++) {\n\t\t\t\tfor (int j = 0; j < grid[i].length; j++) {\n\t\t\t\t\tif (Character.getNumericValue(grid[i][j]) < 10) {\n\t\t\t\t\t\tif (dp[i][j] == null) {\n\t\t\t\t\t\t\tdp[i][j] = String.valueOf(grid[i][j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (i + 1 < grid.length\n\t\t\t\t\t\t\t\t&& Character.getNumericValue(grid[i + 1][j]) < 10) {\n\t\t\t\t\t\t\tdp[i + 1][j] = strMax(dp[i + 1][j], dp[i][j]\n\t\t\t\t\t\t\t\t\t+ String.valueOf(grid[i + 1][j]));\n\t\t\t\t\t\t\tans = strMax(ans, dp[i + 1][j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (j + 1 < grid[i].length\n\t\t\t\t\t\t\t\t&& Character.getNumericValue(grid[i][j + 1]) < 10) {\n\t\t\t\t\t\t\tdp[i][j + 1] = strMax(dp[i][j + 1], dp[i][j]\n\t\t\t\t\t\t\t\t\t+ String.valueOf(grid[i][j + 1]));\n\t\t\t\t\t\t\tans = strMax(ans, dp[i][j + 1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\n\t}\n\n\tstatic String strMax(String a, String b) {\n\t\tif (a == null) {\n\t\t\ta = \"\";\n\t\t}\n\t\tif (b == null) {\n\t\t\tb = \"\";\n\t\t}\n\t\t// 行頭の0を全て削除\n\t\ta = a.replaceAll(\"^0*\", \"\");\n\t\tb = b.replaceAll(\"^0*\", \"\");\n\n\t\tif (b.length() > a.length()\n\t\t\t\t|| (b.length() == a.length() && b.compareTo(a) > 0)) {\n\t\t\t// 桁数が大きいか、桁数が一緒でも辞書順で後ろならば、\n\t\t\t// その数字を採用する\n\t\t\treturn b;\n\t\t} else {\n\t\t\treturn a;\n\t\t}\n\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\n  Scanner sc;\n\n  Main() {\n    sc = new Scanner(System.in);\n  }\n\n  int ni() {\n    return sc.nextInt();\n  }\n\n  public static void main(String[] args) {\n    new Main().run();\n  }\n\n  static int[][] ofs = {\n      {1, 0},\n      {0, 1}\n  };\n\n  void run() {\n    for (; ; ) {\n      int w = ni();\n      int h = ni();\n      if (w == 0) {\n        break;\n      }\n      BigInteger[][] dp = new BigInteger[h][w];\n      char[][] field = new char[h][w];\n      for (int i = 0; i < h; ++i) {\n        String str = sc.next();\n        for (int j = 0; j < w; ++j) {\n          field[i][j] = str.charAt(j);\n          dp[i][j] = BigInteger.ZERO;\n        }\n      }\n      BigInteger ans = BigInteger.ZERO;\n      for (int y = 0; y < h; ++y) {\n        for (int x = 0; x < w; ++x) {\n          if ('0' <= field[y][x] && field[y][x] <= '9') {\n            dp[y][x] = dp[y][x].multiply(BigInteger.TEN).add(BigInteger.valueOf(field[y][x] - '0'));\n\n            if (dp[y][x].compareTo(ans) > 0) {\n              ans = dp[y][x];\n            }\n            for (int i = 0; i < 2; ++i) {\n              int nx = ofs[i][0] + x;\n              int ny = ofs[i][1] + y;\n              if (nx >= w || ny >= h) {\n                continue;\n              }\n              if (dp[ny][nx].compareTo(dp[y][x]) < 0) {\n                dp[ny][nx] = dp[y][x];\n              }\n            }\n          }\n        }\n      }\n      System.out.println(ans.toString());\n    }\n  }\n\n  void debug(Object... os) {\n    System.err.println(Arrays.deepToString(os));\n  }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport static java.lang.System.*;\n\npublic class Main {\n\n\tScanner sc = new Scanner(in);\n\t\n\tString[][] memo;\n\tint[][] mat;\n\tint w, h;\n\t\n\tint compare(String s1, String s2) {\n\t\tint c1, c2;\n\t\tc1 = c2 = 0;\n\t\tint index = 0;\n\t\twhile (index < s1.length() && s1.charAt(index) == '0') {\n\t\t\tc1++;\n\t\t\tindex++;\n\t\t}\n\t\tindex = 0;\n\t\twhile (index < s2.length() &&s2.charAt(index) == '0') {\n\t\t\tc2++;\n\t\t\tindex++;\n\t\t}\n\t\tif (s1.length()-c1 > s2.length() -c2) return 1;\n\t\telse if (s1.length()-c1 < s2.length() -c2) return -1;\n\t\t\n\t\treturn s1.substring(c1).compareTo(s2.substring(c2));\n\t}\n\t\n\tString calc(int i, int j) {\n\t\tif (memo[i][j] == null) {\n\t\t\tString s1, s2;\n\t\t\ts1 = s2 = null;\n\t\t\tif (i+1 < h && mat[i+1][j] >= 0) s1 = calc(i+1, j);\n\t\t\tif (j+1 < w && mat[i][j+1] >= 0) s2 = calc(i, j+1);\n\t\t\tif (s1 == null && s2 == null)\n\t\t\t\tmemo[i][j] = String.valueOf(mat[i][j]);\n\t\t\telse if (s1 == null)\n\t\t\t\tmemo[i][j] = String.valueOf(mat[i][j])+s2;\n\t\t\telse if (s2 == null)\n\t\t\t\tmemo[i][j] = String.valueOf(mat[i][j])+s1;\n\t\t\telse if (compare(s1, s2) > 0)\n\t\t\t\tmemo[i][j] = String.valueOf(mat[i][j])+s1;\n\t\t\telse\n\t\t\t\tmemo[i][j] = String.valueOf(mat[i][j])+s2;\n\t\t}\n\t\treturn memo[i][j];\n\t}\n\t\n\tvoid run() {\n\t\twhile (true) {\n\t\t\tw = sc.nextInt(); h = sc.nextInt();\n\t\t\tif (w == 0 && h == 0) return;\n\t\t\tsc.nextLine();\n\t\t\tmat = new int[h][w];\n\t\t\tfor (int i = 0; i < h; i++) {\n\t\t\t\tString s = sc.nextLine();\n\t\t\t\tfor (int j = 0; j < w; j++) {\n\t\t\t\t\tif (Character.isDigit(s.charAt(j))) {\n\t\t\t\t\t\tmat[i][j] = Character.getNumericValue(s.charAt(j));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmat[i][j] = -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tmemo = new String[h][w];\n\t\t\tString ans = \"0\";\n\t\t\tfor (int i = 0; i < h; i++) {\n\t\t\t\tfor (int j = 0; j < w; j++) {\n\t\t\t\t\tif (memo[i][j] == null && mat[i][j] >= 0) {\n\t\t\t\t\t\tcalc(i, j);\n\t\t\t\t\t\tif (compare(ans, memo[i][j]) < 0)\n\t\t\t\t\t\t\tans = memo[i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint index = 0, c = 0;\n\t\t\twhile (ans.charAt(index) == '0') {\n\t\t\t\tc++;\n\t\t\t\tindex++;\n\t\t\t}\n\t\t\t\n\t\t\tout.println(ans.substring(c));\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.util.ArrayDeque;\nimport java.util.Queue;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tprivate static char[][] grid;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tScanner scanner = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint N = scanner.nextInt();\n\t\t\tif (N == 0) {\n\t\t\t\tscanner.close();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tint M = scanner.nextInt();\n\n\t\t\tgrid = new char[M][N];\n\t\t\tfor (int i = 0; i < grid.length; i++) {\n\t\t\t\tString line = scanner.next();\n\t\t\t\tfor (int j = 0; j < grid[i].length; j++) {\n\t\t\t\t\tgrid[i][j] = line.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tString ans = \"\";\n\t\t\tfor (int i = 0; i < grid.length; i++) {\n\t\t\t\tfor (int j = 0; j < grid[i].length; j++) {\n\t\t\t\t\tif (Character.getNumericValue(grid[i][j]) < 10\n\t\t\t\t\t\t\t&& Character.getNumericValue(grid[i][j]) > 0) {\n\t\t\t\t\t\t// grid[i][j]が数字の時、深さ優先探索する\n\t\t\t\t\t\tString dfString = dfsQueue(String.valueOf(grid[i][j]),\n\t\t\t\t\t\t\t\ti, j);\n\t\t\t\t\t\tif (dfString.length() > ans.length()\n\t\t\t\t\t\t\t\t|| (dfString.length() == ans.length() && dfString\n\t\t\t\t\t\t\t\t\t\t.compareTo(ans) > 0)) {\n\t\t\t\t\t\t\t// 桁数が大きいか、桁数が一緒でも辞書順で後ろならば、\n\t\t\t\t\t\t\t// その数字を採用する\n\t\t\t\t\t\t\tans = dfString;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tSystem.out.println(ans);\n\n\t\t}\n\n\t}\n\n\tstatic String dfsQueue(String first_s, int first_i, int first_j) {\n\t\t// 深さ優先探索キュー\n\t\tString ans = \"\";\n\t\tQueue<DFS> queue = new ArrayDeque<DFS>();\n\t\tqueue.add(new DFS(first_s, first_i, first_j));\n\t\twhile (!queue.isEmpty()) {\n\t\t\tDFS dfs = queue.poll();\n\t\t\tint i = dfs.i;\n\t\t\tint j = dfs.j;\n\t\t\tString sequence = dfs.sequence;\n\t\t\tif (i + 1 < grid.length\n\t\t\t\t\t&& Character.getNumericValue(grid[i + 1][j]) < 10) {\n\t\t\t\tqueue.add(new DFS(sequence + String.valueOf(grid[i + 1][j]),\n\t\t\t\t\t\ti + 1, j));\n\t\t\t}\n\t\t\tif (j + 1 < grid[i].length\n\t\t\t\t\t&& Character.getNumericValue(grid[i][j + 1]) < 10) {\n\t\t\t\tqueue.add(new DFS(sequence + String.valueOf(grid[i][j + 1]), i,\n\t\t\t\t\t\tj + 1));\n\t\t\t}\n\n\t\t\tif (sequence.length() > ans.length()\n\t\t\t\t\t|| (sequence.length() == ans.length() && sequence\n\t\t\t\t\t\t\t.compareTo(ans) > 0)) {\n\t\t\t\t// 桁数が大きいか、桁数が一緒でも辞書順で後ろならば、\n\t\t\t\t// その数字を採用する\n\t\t\t\tans = sequence;\n\t\t\t}\n\t\t}\n\t\treturn ans;\n\t}\n\n\tstatic String dfs(String sequence, int i, int j) {\n\t\t// 深さ優先探索\n\t\tString ans = sequence;\n\t\tif (i + 1 < grid.length\n\t\t\t\t&& Character.getNumericValue(grid[i + 1][j]) < 10) {\n\t\t\tString dfString = dfs(sequence + String.valueOf(grid[i + 1][j]),\n\t\t\t\t\ti + 1, j);\n\t\t\tif (dfString.length() > ans.length()\n\t\t\t\t\t|| (dfString.length() == ans.length() && dfString\n\t\t\t\t\t\t\t.compareTo(ans) > 0)) {\n\t\t\t\t// 桁数が大きいか、桁数が一緒でも辞書順で後ろならば、\n\t\t\t\t// その数字を採用する\n\t\t\t\tans = dfString;\n\t\t\t}\n\t\t}\n\t\tif (j + 1 < grid[i].length\n\t\t\t\t&& Character.getNumericValue(grid[i][j + 1]) < 10) {\n\t\t\tString dfString = dfs(sequence + String.valueOf(grid[i][j + 1]), i,\n\t\t\t\t\tj + 1);\n\t\t\tif (dfString.length() > ans.length()\n\t\t\t\t\t|| (dfString.length() == ans.length() && dfString\n\t\t\t\t\t\t\t.compareTo(ans) > 0)) {\n\t\t\t\t// 桁数が大きいか、桁数が一緒でも辞書順で後ろならば、\n\t\t\t\t// その数字を採用する\n\t\t\t\tans = dfString;\n\t\t\t}\n\t\t}\n\n\t\treturn ans;\n\n\t}\n\n}\n\nclass DFS {\n\tString sequence;\n\tint i, j;\n\n\tpublic DFS(String s, int i, int j) {\n\t\tthis.i = i;\n\t\tthis.j = j;\n\t\tthis.sequence = s;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\n\tstatic void solve() {\n\t\tfor (;;) {\n\t\t\tint m = ir.nextInt();\n\t\t\tint n = ir.nextInt();\n\t\t\tif (m == 0 && n == 0)\n\t\t\t\treturn;\n\t\t\tchar[][] map = ir.nextCharMap(n, m);\n\t\t\tString[][] dp = new String[n][m];\n\t\t\tString ret = \"\";\n\t\t\tfor (int i = n-1; i >= 0; i--) {\n\t\t\t\tfor (int j = m-1; j >= 0; j--) {\n\t\t\t\t\tif (map[i][j] >= 'A' && map[i][j] <= 'Z')\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tdp[i][j] = Character.toString(map[i][j]);\n\t\t\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\t\t\tint nx = i + (k & 1);\n\t\t\t\t\t\tint ny = j + ((k & 1) ^ 1);\n\t\t\t\t\t\tif (!(nx >= 0 && nx < n && ny >= 0 && ny < m))\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tif( map[nx][ny] >= 'A' && map[nx][ny] <= 'Z')\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tdp[i][j] = max(dp[i][j], Character.toString(map[i][j]) + dp[nx][ny]);\n\t\t\t\t\t}\n\t\t\t\t\tint t=0;\n\t\t\t\t\twhile(t<dp[i][j].length()&&dp[i][j].charAt(t)=='0')\n\t\t\t\t\t\tt++;\n\t\t\t\t\tret=max(ret,dp[i][j].substring(t));\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ret);\n\t\t}\n\t}\n\n\tstatic String max(String a, String b) {\n\t\tif (a.length() > b.length())\n\t\t\treturn a;\n\t\tif (a.length() < b.length())\n\t\t\treturn b;\n\t\tfor (int i = 0; i < a.length(); i++) {\n\t\t\tif (a.charAt(i) > b.charAt(i))\n\t\t\t\treturn a;\n\t\t\tif (a.charAt(i) < b.charAt(i))\n\t\t\t\treturn b;\n\t\t}\n\t\treturn a;\n\t}\n\n\tpublic static void main(String[] args) throws Exception {\n\t\tir = new InputReader(System.in);\n\t\tout = new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer = new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {\n\t\t\tthis.in = in;\n\t\t\tthis.curbuf = this.lenbuf = 0;\n\t\t}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif (curbuf >= lenbuf) {\n\t\t\t\tcurbuf = 0;\n\t\t\t\ttry {\n\t\t\t\t\tlenbuf = in.read(buffer);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (lenbuf <= 0)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte() {\n\t\t\tif (hasNextByte())\n\t\t\t\treturn buffer[curbuf++];\n\t\t\telse\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tprivate boolean isSpaceChar(int c) {\n\t\t\treturn !(c >= 33 && c <= 126);\n\t\t}\n\n\t\tprivate void skip() {\n\t\t\twhile (hasNextByte() && isSpaceChar(buffer[curbuf]))\n\t\t\t\tcurbuf++;\n\t\t}\n\n\t\tpublic boolean hasNext() {\n\t\t\tskip();\n\t\t\treturn hasNextByte();\n\t\t}\n\n\t\tpublic String next() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tint b = readByte();\n\t\t\twhile (!isSpaceChar(b)) {\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb = readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic double nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tpublic int[] nextIntArray(int n) {\n\t\t\tint[] a = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n) {\n\t\t\tlong[] a = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n, int m) {\n\t\t\tchar[][] map = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tmap[i] = next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tif (w == 0 && h == 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tchar[][] m = new char[h][];\n\t\t\tfor(int i=0;i<h;i++) {\n\t\t\t\tm[i] = sc.next().toCharArray();\n\t\t\t}\n\t\t\tBigInteger ans = BigInteger.ZERO;\n\t\t\tBigInteger[][] dp = new BigInteger[h][w];\n\t\t\tfor(int i=0;i<h;i++) {\n\t\t\t\tfor(int j=0;j<w;j++) {\n\t\t\t\t\tdp[i][j] = BigInteger.ZERO;\n\t\t\t\t\tif (!Character.isDigit(m[i][j])) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tBigInteger d = BigInteger.valueOf(m[i][j] - '0');\n\t\t\t\t\tdp[i][j] = d;\n\t\t\t\t\tif (i > 0) {\n\t\t\t\t\t\tdp[i][j] = dp[i][j].max(dp[i-1][j].multiply(BigInteger.TEN).add(d));\n\t\t\t\t\t}\n\t\t\t\t\tif (j > 0) {\n\t\t\t\t\t\tdp[i][j] = dp[i][j].max(dp[i][j-1].multiply(BigInteger.TEN).add(d));\n\t\t\t\t\t}\n\t\t\t\t\tans = ans.max(dp[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\nimport java.util.Arrays;\n\npublic class Main{\n    public static void main(String[] args) {\n        Scanner sc = new Scanner(System.in);\n        int[][] map = new int[71][71];\n        String[][] str = new String[71][71];\n        Arrays.fill(str[0], \"\");\n        int w, h;\n        String temp, max;\n        while(true){\n            w = sc.nextInt();\n            h = sc.nextInt();\n            if(w==0 && h==0) break;\n\n            for(int i=1; i<=h; i++){\n                temp = sc.next();\n                Arrays.fill(map[i], -1);\n                Arrays.fill(str[i], \"\");\n                for(int j=1; j<=w; j++){\n                    if(temp.charAt(j-1)>='0' && temp.charAt(j-1)<='9'){\n                        map[i][j] = temp.charAt(j-1) - '0';\n                    }\n                }\n            }\n            Arrays.fill(map[h+1], -1);\n            Arrays.fill(str[h+1], \"\");\n\n            max = \"\";\n            for(int i=1; i<=h; i++){\n                for(int j=1; j<=w; j++){\n                    temp = \"\";\n                    if(map[i][j]>=0){\n                        if(str[i-1][j].length() < str[i][j-1].length()){\n                            temp = str[i][j-1];\n                        }else if(str[i-1][j].length()==str[i][j-1].length() && !str[i-1][j].equals(str[i][j-1])){\n                            if(str[i-1][j].compareTo(str[i][j-1])>0){\n                                temp = str[i-1][j];\n                            }else{\n                                temp = str[i][j-1];\n                            }\n                        }else{\n                            temp = str[i-1][j];\n                        }\n                        if(!(temp.length()==0 && map[i][j]==0)){\n                            str[i][j] = temp + String.valueOf(map[i][j]%10);\n                        }\n\n                        if(map[i+1][j]==-1 && map[i][j+1]==-1){\n                            if(max.length() < str[i][j].length()){\n                                max = str[i][j];\n                            }else if(max.length()==str[i][j].length() && !max.equals(str[i][j])){\n                                if(max.compareTo(str[i][j])<0){\n                                    max = str[i][j];\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n\n            System.out.println(max);\n        }\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\tScanner in = new Scanner(System.in);\n\tchar[][] map;\n\t\n\tString compare(String s1, String s2) {\n\t\tif (s1.length() > s2.length()) return s1;\n\t\telse if (s1.length() < s2.length()) return s2;\n\t\telse {\n\t\t\tfor (int i = 0; i < s1.length(); i++) {\n\t\t\t\tif (s1.charAt(i) > s2.charAt(i)) return s1;\n\t\t\t\telse if (s1.charAt(i) < s2.charAt(i)) return s2;\n\t\t\t}\n\t\t}\n\t\treturn s1;\n\t}\n\t\n\tpublic String recursive(int x, int y, String ans) {\n\t\tif ((map[y][x] >= 'A' && map[y][x] <= 'Z') || map[y][x] == 0) return \"\";\n\t\tans += map[y][x] + \"\";\n\t\tString s1 = recursive(x+1, y, ans);\n\t\tString s2 = recursive(x, y+1, ans);\n\t\tString a = compare(s1, s2);\n\t\treturn (a.equals(\"\")) ? ans : a;\n\t}\n\t\n\tpublic Main() {\n\t\twhile (true) {\n\t\t\tint m = in.nextInt();\n\t\t\tint n = in.nextInt();\n\t\t\tif (m == 0 && n == 0) break;\n\t\t\tmap = new char[n+1][m+1];\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tString s = in.next();\n\t\t\t\tfor (int j = 0; j < m; j++) {\n\t\t\t\t\tmap[i][j] = s.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tString ans = \"\";\n\t\t\tfor (int i = 0; i < m; i++) {\n\t\t\t\tfor (int j = 0; j < 3; j++) {\n\t\t\t\t\tString temp = recursive(i, j, \"\");\n\t\t\t\t\tint k;\n\t\t\t\t\tfor (k = 0; k < temp.length(); k++) {\n\t\t\t\t\t\tif (temp.charAt(k) != '0') break;\n\t\t\t\t\t}\n\t\t\t\t\ttemp = temp.substring(k, temp.length());\n\t\t\t\t\tans = compare(temp, ans);\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main();\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\nimport java.util.Arrays;\nimport java.util.ArrayDeque;\nimport java.util.Deque;\n\npublic class Main{\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint[][] map = new int[70][70];\n\t\tint w, h;\n\t\tString temp;\n\t\twhile(true){\n\t\t\tw = sc.nextInt();\n\t\t\th = sc.nextInt();\n\t\t\tif(w==0 && h==0) break;\n\n\t\t\tfor(int i=0; i<h; i++){\n\t\t\t\ttemp = sc.next();\n\t\t\t\tArrays.fill(map[i], -1);\n\t\t\t\tfor(int j=0; j<w; j++){\n\t\t\t\t\tif(temp.charAt(j)>='0' && temp.charAt(j)<='9'){\n\t\t\t\t\t\tmap[i][j] = temp.charAt(j) - '0';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tArrays.fill(map[h], -1);\n\n\t\t\tString sum = \"\", max = \"\";\n\t\t\tfor(int i=0; i<h; i++){\n\t\t\t\tfor(int j=0; j<w; j++){\n\t\t\t\t\tif(map[i][j]>0 && map[i][j]<10){\n\t\t\t\t\t\tsum = check(map, i, j);\n\n\t\t\t\t\t\tif(max.length() < sum.length()){\n\t\t\t\t\t\t\tmax = sum;\n\t\t\t\t\t\t}else if(max.length()==sum.length()){\n\t\t\t\t\t\t\tfor(int n=0; n<max.length(); n++){\n\t\t\t\t\t\t\t\tif(max.charAt(n)<sum.charAt(n)){\n\t\t\t\t\t\t\t\t\tmax = sum;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}else if(max.charAt(n)>sum.charAt(n)){\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tSystem.out.println(max);\n\t\t}\n\t}\n\n\tpublic static String check(int[][] map, int i, int j){\n\t\tDeque<Point> q = new ArrayDeque<Point>();\n\t\tPoint p = new Point(j, i, \"\");\n\t\tString max = \"\";\n\t\tq.offer(p);\n\t\twhile(!q.isEmpty()){\n\t\t\tp = q.poll();\n\t\t\tp.num = p.num + String.valueOf(map[p.y][p.x]%10);\n\t\t\tmap[p.y][p.x] += 10;\n\n\t\t\tif(max.length() < p.num.length()){\n\t\t\t\tmax = p.num;\n\t\t\t}else if(max.length()==p.num.length()){\n\t\t\t\tfor(int n=0; n<max.length(); n++){\n\t\t\t\t\tif(max.charAt(n)<p.num.charAt(n)){\n\t\t\t\t\t\tmax = p.num;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else if(max.charAt(n)>p.num.charAt(n)){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(map[p.y+1][p.x]!=-1){\n\t\t\t\tPoint p1 = new Point(p.x, p.y+1, p.num);\n\t\t\t\tq.offer(p1);\n\t\t\t}\n\t\t\tif(map[p.y][p.x+1]!=-1){\n\t\t\t\tPoint p2 = new Point(p.x+1, p.y, p.num);\n\t\t\t\tq.offer(p2);\n\t\t\t}\n\t\t}\n\t\treturn max;\n\t}\n\n\tpublic static class Point{\n\t\tint x, y;\n\t\tString num;\n\t\tPoint(int i, int j, String sum){\n\t\t\tx = i;\n\t\t\ty = j;\n\t\t\tnum = sum;\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.util.regex.*;\nimport static java.lang.Math.*;\nimport static java.lang.System.out;\n\n// AOJ\npublic class Main {\n\tfinal Scanner sc=new Scanner(System.in);\n\tfinal int[] vx={0,1,0,-1}, vy={-1,0,1,0};\n\tstatic class Point{\n\t\tint x, y;\n\t\tPoint(int x, int y){\tthis.x=x;\tthis.y=y;}\n\t\tPoint(){\tthis.x=0; this.y=0;}\n\t\t@Override public String toString(){\treturn \"(\"+this.x+\",\"+this.y+\")\";}\n\t\tstatic boolean ok(int x,int y,int X,int Y,int min){\n\t\t\treturn (min<=x&&x<X && min<=y&&y<Y)?true:false;\n\t\t}\n\t\tstatic boolean ok(int x,int y,int X,int Y){\treturn ok(x,y,X,Y,0);}\n\t\tstatic void DE(char[][] c,int sx,int sy,int ex,int ey){\n\t\t\tout.println(\"--------------------\");\n\t\t\tfor(int y=sy; y<ey; y++){\n\t\t\t\tfor(int x=sx; x<ex; x++)out.print(c[x][y]);\n\t\t\t\tout.println();\n\t\t\t}\n\t\t\tout.println(\"--------------------\");\n\t\t}\n\t\tstatic void DE(int[][] c,int sx,int sy,int ex,int ey){\n\t\t\tout.println(\"--------------------\");\n\t\t\tfor(int y=sy; y<ey; y++){\n\t\t\t\tfor(int x=sx; x<ex; x++)out.print(c[x][y]+\" \");\n\t\t\t\tout.println();\n\t\t\t}\n\t\t\tout.println(\"--------------------\");\n\t\t}\n\t}\n\tpublic static void main(String[] args) {\n\t\tnew Main().AOJ1126();\n\t}\n\t\n\t\n\tvoid AOJ1126(){\n\t\twhile(sc.hasNext()){\n\t\t\tint W=sc.nextInt(), H=sc.nextInt();\n\t\t\tif((W|H)==0)\tbreak;\n\t\t\tchar[][] c=new char[W][H];\n\t\t\tfor(int y=0; y<H; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<W; x++)\tc[x][y]=line.charAt(x);\n\t\t\t}\n\t\t\tString[][] dp=new String[W][H];\n\t\t\tfor(int i=0; i<W; i++){\n\t\t\t\tfor(int j=0; j<H; j++)\tdp[i][j]=\"\";\n\t\t\t}\n\t\t\tString ans=\"\";\n\t\t\tfor(int y=0; y<H; y++){\n\t\t\t\tfor(int x=0; x<W; x++){\n\t\t\t\t\tif(Character.isDigit(c[x][y])){\n\t\t\t\t\t\tdp[x][y]=max1126((x-1>=0?dp[x-1][y]:\"\"),(y-1>=0?dp[x][y-1]:\"\"))+Character.digit(c[x][y], 10);\n\t\t\t\t\t\tans=max1126(ans,dp[x][y]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t}\n\tString max1126(String a,String b){\n\t\tif(a==\"\")\treturn b;\n\t\tif(b==\"\")\treturn a;\n\t\twhile(a.charAt(0)=='0'){\n\t\t\tif(a.length()<=1){\n\t\t\t\ta=\"\";\n\t\t\t\tbreak;\n\t\t\t}else\ta=a.substring(1);\n\t\t}\n\t\twhile(b.charAt(0)=='0'){\n\t\t\tif(b.length()<=1){\n\t\t\t\tb=\"\";\n\t\t\t\tbreak;\n\t\t\t}else\tb=b.substring(1);\n\t\t}\n\t\tif(a==\"\")\treturn b;\n\t\tif(b==\"\")\treturn a;\n\t\tif(a.length()>b.length())\treturn a;\n\t\tif(b.length()>a.length())\treturn b;\n\t\tfor(int i=0; i<a.length(); i++){\n\t\t\tif(a.charAt(i)>b.charAt(i))\treturn a;\n\t\t\tif(a.charAt(i)<b.charAt(i))\treturn b;\n\t\t}\n\t\treturn a;\n\t}\n\t\n\t// TLE\n\tvoid AOJ0185(){\n\t\tArrayList<Integer> prime=SieveList(1000000);\n\t\twhile(sc.hasNext()){\n\t\t\tint n=sc.nextInt(),ans=0;\n\t\t\tif(n==0)\tbreak;\n\t\t\tfor(int i=0; i<prime.size(); i++){\n\t\t\t\tif(prime.get(i)>=n)\tbreak;\n\t\t\t\tfor(int j=i; j<prime.size(); j++){\n\t\t\t\t\tint temp=prime.get(i)+prime.get(j);\n\t\t\t\t\tif(temp>=n){\n\t\t\t\t\t\t//if(temp==n)\tout.println(\"  \"+prime.get(i)+\" + \"+prime.get(j)+\" = \"+temp);\n\t\t\t\t\t\tans+=(temp==n?1:0);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t}\n\t\n\tvoid AOJ0174(){\n\t\twhile(sc.hasNext()){\n\t\t\tchar[] c=sc.next().toCharArray();\n\t\t\tif(c[0]=='0')\tbreak;\n\t\t\tint a=0,b=0;\n\t\t\tfor(int i=1; i<c.length; i++){\n\t\t\t\tif(c[i]=='A')\ta++;\n\t\t\t\telse if(c[i]=='B')\tb++;\n\t\t\t}\n\t\t\ta+=(a>b?1:0);\tb+=(b>a?1:0);\n\t\t\tout.println(a+\" \"+b);\n\t\t}\n\t}\n\t\n\tvoid AOJ0173(){\n\t\tfor(int i=0; i<9; i++){\n\t\t\tString s=sc.next();\tint a=sc.nextInt(),b=sc.nextInt();\n\t\t\tout.println(s+\" \"+(a+b)+\" \"+(a*200+b*300));\n\t\t}\n\t}\n\t\n\t\n\t// 途中\n\tvoid AOJ0121(){\n\t\twhile(sc.hasNext()){\n\t\t\tint[] b=new int[8];\n\t\t\tfor(int i=0; i<8; i++)\tb[i]=sc.nextInt();\n\t\t\tLinkedList<int[]> open=new LinkedList<int[]>();\n\t\t\topen.add(b);\n\t\t\tHashSet<int[]> close=new HashSet<int[]>();\n\t\t\tclose.add(b);\n\t\t\tint ans=0;\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tint[] now=open.poll();\n\t\t\t\tif(solve121(now))\tbreak;\n\t\t\t\tfor(int i=0; i<7; i++){\n\t\t\t\t\tint[] temp=now.clone();\n\t\t\t\t\tint temp2=temp[i+1];\n\t\t\t\t\ttemp[i+1]=temp[i];\n\t\t\t\t\ttemp[i]=temp2;\n\t\t\t\t\tif(close.contains(temp))\tcontinue;\n\t\t\t\t\tif(solve121(temp)){\n\t\t\t\t\t\topen.clear();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\topen.add(temp);\n\t\t\t\t\tclose.add(temp);\n\t\t\t\t}\n\t\t\t\tans++;\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t}\n\tboolean solve121(int[] b){\n\t\tfor(int i=0; i<8; i++)\tif(b[i]!=i)\treturn false;\n\t\treturn true;\n\t}\n\tboolean cont121(int[] a,int[] b){\n\t\tfor(int i=0; i<8; i++)\tif(a[i]!=b[i])\treturn false;\n\t\treturn true;\n\t}\n\t\n\tvoid AOJ1104(){\n\t\twhile(sc.hasNext()){\n\t\t\tint W=sc.nextInt(),H=sc.nextInt();\n\t\t\tif((W|H)==0)\tbreak;\n\t\t\tint x=1,y=1,d=2;\n\t\t\t// 右-1 左+1\n\t\t\twhile(true){\n\t\t\t\tString s=sc.next();\n\t\t\t\tif(s.equals(\"STOP\"))\tbreak;\n\t\t\t\telse if(s.equals(\"FORWARD\")){\n\t\t\t\t\tint n=sc.nextInt();\n\t\t\t\t\tx=max(1,min(W,x+n*vx[d]));\n\t\t\t\t\ty=max(1,min(H,y+n*vy[d]));\n\t\t\t\t}else if(s.equals(\"BACKWARD\")){\n\t\t\t\t\tint n=sc.nextInt();\n\t\t\t\t\tx=max(1,min(W,x+n*-1*vx[d]));\n\t\t\t\t\ty=max(1,min(H,y+n*-1*vy[d]));\n\t\t\t\t}else if(s.equals(\"RIGHT\"))\td=(d==0?3:d-1);\n\t\t\t\telse if(s.equals(\"LEFT\"))\td=(d==3?0:d+1);\n\t\t\t\t//out.println(\"D\"+x+\" \"+y+\" \"+d);\n\t\t\t}\n\t\t\tout.println(x+\" \"+y);\n\t\t}\n\t}\n\t\n\tvoid AOJ1114(){\n\t\tint N=sc.nextInt();\n\t\tfor(int I=1; I<=N; I++){\n\t\t\tint[][] b=new int[5][5];\n\t\t\tfor(int y=0; y<5; y++){\n\t\t\t\tfor(int x=0; x<5; x++)\tb[x][y]=sc.nextInt();\n\t\t\t}\n\t\t\tint ans=0;\n\t\t\tfor(int i=0; i<5; i++){\n\t\t\t\tfor(int j=0; j<5; j++){\n\t\t\t\t\tif(b[i][j]==1)\tans=max(ans,solve1114(i,j,b));\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t}\n\tint solve1114(int x,int y,int[][] b){\n\t\tint ans=0;\n\t\tfor(int i=0; i+x<5; i++){\n\t\t\tif(b[i+x][y]==0)\tbreak;\n\t\t\tboolean flag=true;\n\t\t\tfor(int j=0; j+y<5; j++){\n\t\t\t\tfor(int k=0; k<=i; k++){\n\t\t\t\t\tfor(int l=0; l<=j; l++){\n\t\t\t\t\t\tif(b[k+x][l+y]==0){\n\t\t\t\t\t\t\tflag=false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(!flag)\tbreak;\n\t\t\t\t}\n\t\t\t\tif(!flag)\tbreak;\n\t\t\t\tans=max(ans,(i+1)*(j+1));\n\t\t\t}\n\t\t}\n\t\treturn ans;\n\t}\n\t\n\tint step=0;\n\t// バックトラック（TLE）\n\tvoid Old2AOJ1126(){\n\t\twhile(sc.hasNext()){\n\t\t\tint W=sc.nextInt(), H=sc.nextInt();\n\t\t\tif((W|H)==0)\tbreak;\n\t\t\tchar[][] c=new char[W][H];\n\t\t\tfor(int y=0; y<H; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<W; x++)\tc[x][y]=line.charAt(x);\n\t\t\t}\n\t\t\tString ans=\"\";\n\t\t\tfor(int x=0; x<W; x++){\n\t\t\t\tfor(int y=0; y<H; y++){\n\t\t\t\t\tif(Character.isDigit(c[x][y])){\n\t\t\t\t\t\tif(x>0)\tif(Character.isDigit(c[x-1][y]) && c[x-1][y]!='0')\tcontinue;\n\t\t\t\t\t\tif(y>0)\tif(Character.isDigit(c[x][y-1]) && c[x][y-1]!='0')\tcontinue;\n\t\t\t\t\t\tif(c[x][y]=='0')\tcontinue;\n\t\t\t\t\t\tString temp=solve1126(x,y,\"\"+c[x][y],c,W,H);\n\t\t\t\t\t\tans=compara1126(temp,ans)?temp:ans;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t\t// TODO debug\n\t\tout.println(step+\"steps\");\n\t}\n\tString solve1126(int x,int y,String ans,char[][] c,int W,int H){\n\t\tString r=ans;\n\t\t//TODO debug\n\t\tstep++;\n\t\t//out.println(ans);\n\t\tfor(int i=1; i<3; i++){\n\t\t\tint xx=x+vx[i], yy=y+vy[i];\n\t\t\tif(!Point.ok(xx,yy,W,H))\tcontinue;\n\t\t\tif(Character.isDigit(c[xx][yy])){\n\t\t\t\tString temp=solve1126(xx,yy,ans+c[xx][yy],c,W,H);\n\t\t\t\tr=compara1126(r,temp)?r:temp;\n\t\t\t\tout.println(temp);\n\t\t\t}\n\t\t}\n\t\treturn r;\n\t}\n\t// 第一引数aの方が大きい時のみtrue\n\tboolean compara1126(String a,String b){\n\t\tif(a.length()>b.length())\treturn true;\n\t\tif(a.length()==b.length()){\n\t\t\tfor(int i=0; i<a.length(); i++){\n\t\t\t\tif(a.charAt(i)>b.charAt(i))\treturn true;\n\t\t\t\tif(a.charAt(i)<b.charAt(i))\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\t// 横型探索（MLE）\n\tvoid OldAOJ1126(){\n\t\tint step=0;\n\t\twhile(sc.hasNext()){\n\t\t\tint W=sc.nextInt(), H=sc.nextInt();\n\t\t\tString ans=\"\";\n\t\t\tif((W|H)==0)\tbreak;\n\t\t\tchar[][] c=new char[W][H];\n\t\t\tString[][] close=new String[W][H];\n\t\t\tLinkedList<C1126> open=new LinkedList<C1126>();\n\t\t\tfor(int y=0; y<H; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<W; x++){\n\t\t\t\t\tc[x][y]=line.charAt(x);\n\t\t\t\t\tif(Character.isDigit(line.charAt(x))){\n\t\t\t\t\t\tif(x>0)\tif(Character.isDigit(c[x-1][y]))\tcontinue;\n\t\t\t\t\t\tif(y>0)\tif(Character.isDigit(c[x][y-1]))\tcontinue;\n\t\t\t\t\t\topen.add(new C1126(x,y,\"\"+c[x][y]));\n\t\t\t\t\t\tclose[x][y]=\"\"+c[x][y];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tC1126 now=open.poll();\n\t\t\t\t// TODO debug\n\t\t\t\tout.println(\"ANS\"+ans+\" NOW\"+now.ans);\n\t\t\t\tans=now.compara(ans)?new String(now.ans):ans;\n\t\t\t\tfor(int i=1; i<3; i++){\n\t\t\t\t\tint xx=now.x+vx[i], yy=now.y+vy[i];\n\t\t\t\t\tif(!Point.ok(xx,yy,W,H))\tcontinue;\n\t\t\t\t\tif(Character.isDigit(c[xx][yy])){\n\t\t\t\t\t\tC1126 temp=new C1126(xx,yy,now.ans+c[xx][yy]);\n\t\t\t\t\t\tif(close[xx][yy]==null){\n\t\t\t\t\t\t\topen.add(temp);\n\t\t\t\t\t\t\tclose[xx][yy]=temp.ans;\n\t\t\t\t\t\t\tstep++;\n\t\t\t\t\t\t}else if(temp.compara(close[xx][yy])){\n\t\t\t\t\t\t\topen.add(temp);\n\t\t\t\t\t\t\tclose[xx][yy]=temp.ans;\n\t\t\t\t\t\t\tstep++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t\tout.println(step+\"step\");\n\t}\n\tclass C1126{\n\t\tint x,y;\tString ans;\n\t\tC1126(int x,int y,String ans){\n\t\t\tthis.x=x;\tthis.y=y;\n\t\t\tif(ans.length()>0){\n\t\t\t\tint i=0;\n\t\t\t\twhile(ans.charAt(i)=='0'){\n\t\t\t\t\tif(++i>=ans.length()-1)\tbreak;\n\t\t\t\t\tans=ans.substring(i);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.ans=ans;\n\t\t}\n\t\tboolean compara(String ans){\n\t\t\tif(this.ans.length()>ans.length())\treturn true;\n\t\t\tif(this.ans.length()==ans.length()){\n\t\t\t\tfor(int i=0; i<ans.length(); i++){\n\t\t\t\t\tif(ans.charAt(i)<this.ans.charAt(i))\treturn true;\n\t\t\t\t\tif(ans.charAt(i)>this.ans.charAt(i))\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\tvoid AOJ0165(){\n\t\tfinal int MAX=1000000;\n\t\tboolean[] prime=Sieve(MAX);\n\t\tint[] prime2=new int[MAX+1];\n\t\tfor(int i=2; i<=MAX; i++)\tprime2[i]=(prime[i]?prime2[i-1]+1:prime2[i-1]);\n\t\twhile(sc.hasNext()){\n\t\t\tint N=sc.nextInt();\n\t\t\tif(N==0)\tbreak;\n\t\t\tint ans=0;\n\t\t\tfor(int i=1; i<=N; i++){\n\t\t\t\tint p=sc.nextInt(), m=sc.nextInt();\n\t\t\t\tint min=max(1,p-m), max=min(MAX, p+m);\n\t\t\t\tans+=prime2[max]-prime2[min-1]-1;\n\t\t\t}\n\t\t\tout.println(max(0,ans));\n\t\t}\n\t}\n\t\n\tvoid AOJ1144(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(), Y=sc.nextInt();\n\t\t\tif((X|Y)==0)\tbreak;\n\t\t\tchar[][] c=new char[X][Y];\n\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\t\tc[x][y]=line.charAt(x);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\n\t// TODO 果樹園　RE　横型\n\tvoid AOJ0118(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(), Y=sc.nextInt(), ans=0;\n\t\t\tif((X|Y)==0)\tbreak;\n\t\t\tchar[][] c=new char[X+2][Y+2];\n\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\t\tc[x][y]=line.charAt(x);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// TODO debug\n\t\t\t//Point.DE(c, 0, 0, X, Y);\n\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\t\tif(c[x][y]=='&')\tcontinue;\n\t\t\t\t\tans++;\n\t\t\t\t\tLinkedList<Point> open=new LinkedList<Point>();\n\t\t\t\t\topen.add(new Point(x,y));\n\t\t\t\t\tc[x][y]='&';\n\t\t\t\t\tchar mark=c[x][y];\n\t\t\t\t\twhile(!open.isEmpty()){\n\t\t\t\t\t\tPoint now=open.poll();\n\t\t\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\t\t\tint xx=now.x+vx[i], yy=now.y+vy[i];\n\t\t\t\t\t\t\tif(!Point.ok(xx,yy,X,Y))\tcontinue;\n\t\t\t\t\t\t\tif(c[xx][yy]==mark){\n\t\t\t\t\t\t\t\topen.add(new Point(xx,yy));\n\t\t\t\t\t\t\t\tc[xx][yy]='&';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//Point.DE(c, 0, 0, X, Y);\n\t\t\t\t\t//out.println(\"ANS\"+ans);\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t}\n\t\n\t// Red and Black 横型探索\n\tvoid AOJ1130(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(), Y=sc.nextInt(),sx=0,sy=0,ans=0;\n\t\t\tif(X==0)\tbreak;\n\t\t\tchar[][] c=new char[X][Y];\n\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\tchar[] line=sc.next().toCharArray();\n\t\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\t\tc[x][y]=line[x];\n\t\t\t\t\tif(line[x]=='@'){\n\t\t\t\t\t\tsx=x;\tsy=y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tLinkedList<Point> open=new LinkedList<Point>();\n\t\t\topen.add(new Point(sx,sy));\n\t\t\tboolean[][] close=new boolean[X][Y];\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tans++;\n\t\t\t\tPoint now=open.poll();\n\t\t\t\tclose[now.x][now.y]=true;\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(now.x+vx[i]<0 || now.x+vx[i]>=X || now.y+vy[i]<0 || now.y+vy[i]>=Y)\tcontinue;\n\t\t\t\t\tif(c[now.x+vx[i]][now.y+vy[i]]=='.' && !close[now.x+vx[i]][now.y+vy[i]]){\n\t\t\t\t\t\topen.add(new Point(now.x+vx[i], now.y+vy[i]));\n\t\t\t\t\t\tclose[now.x+vx[i]][now.y+vy[i]]=true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t}\n\t\n\t// TODO デパート　TLE MLE WA\n\tvoid AOJ0223(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(),\tY=sc.nextInt();\n\t\t\tif(X==0)\tbreak;\n\t\t\tint tx=sc.nextInt(), ty=sc.nextInt(), kx=sc.nextInt(), ky=sc.nextInt();\n\t\t\tint[][] b=new int[X+1][Y+1];\n\t\t\tfor(int y=1; y<=Y; y++){\n\t\t\t\tfor(int x=1; x<=X; x++)\tb[x][y]=sc.nextInt();\n\t\t\t}\n\t\t\tLinkedList<C0223> open=new LinkedList<C0223>();\n\t\t\topen.add(new C0223(tx,ty,kx,ky,0));\n\t\t\tint[][][][] close2=new int[X+1][Y+1][X+1][Y+1];\n\t\t\tclose2[tx][ty][kx][ky]=-1;\n\t\t\tint ans=-1;\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tC0223 now=open.poll();\n\t\t\t\tif(now.ans()){\n\t\t\t\t\tans=now.sec;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(now.sec>=99)\tbreak;\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(0<now.tx+vx[i]&&now.tx+vx[i]<=X && 0<now.ty+vy[i]&&now.ty+vy[i]<=Y && 0<now.kx-vx[i]&&now.kx-vx[i]<=X && 0<now.ky-vy[i]&&now.ky-vy[i]<=Y){\n\t\t\t\t\t\ttx=now.tx;\tty=now.ty;\tkx=now.kx;\tky=now.ky;\n\t\t\t\t\t\tif(b[tx+vx[i]][ty+vy[i]]==0){\n\t\t\t\t\t\t\ttx+=vx[i];\tty+=vy[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(b[kx-vx[i]][ky-vy[i]]==0){\n\t\t\t\t\t\t\tkx-=vx[i];\tky-=vy[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//out.println(\"TEMP:\"+tx+\" \"+ty+\" \"+kx+\" \"+ky);\n\t\t\t\t\t\t//if(tx==kx && ty==ky)\tans=ans<0?now.sec+1:min(ans,now.sec+1);\n\t\t\t\t\t\tif(close2[tx][ty][kx][ky]==0 || close2[tx][ty][kx][ky]>now.sec+1){\n\t\t\t\t\t\t\t//out.println(\"ADD:\"+tx+\" \"+ty+\" \"+kx+\" \"+ky);\n\t\t\t\t\t\t\topen.add(new C0223(tx,ty,kx,ky,now.sec+1));\n\t\t\t\t\t\t\tclose2[tx][ty][kx][ky]=now.sec+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans<0? \"NA\": ans);\n\t\t}\n\t}\n\tclass C0223{\n\t\tint tx,ty,kx,ky,sec;\n\t\tC0223(int tx, int ty, int kx, int ky, int sec){\n\t\t\tthis.tx=tx;\tthis.ty=ty;\tthis.kx=kx;\tthis.ky=ky;\tthis.sec=sec;\n\t\t}\n\t\tboolean ans(){\n\t\t\tif(this.tx==this.kx && this.ty==this.ky)\treturn true;\n\t\t\telse\treturn false;\n\t\t}\n\t}\n\t\n\t\n\t// TODO WA\n\tvoid AOJ0142(){\n\t\twhile(sc.hasNext()){\n\t\t\tint n=sc.nextInt();\n\t\t\tif(n==0)\tbreak;\n\t\t\tint nn=(n-1)/2;\n\t\t\tboolean[] b=new boolean[n];\n\t\t\tfor(int i=1; i<n; i++)\tb[(i*i)%n]=true;\n\t\t\tArrayList<Integer> ar=new ArrayList<Integer>();\n\t\t\tfor(int i=1; i<n; i++){\n\t\t\t\tif(b[i])\tar.add(i);\n\t\t\t}\n\t\t\tint[] ans=new int[nn+1];\n\t\t\tfor(int i=0; i<ar.size(); i++){\n\t\t\t\tfor(int j=0; j<ar.size(); j++){\n\t\t\t\t\tif(i==j)\tcontinue;\n\t\t\t\t\tint temp=ar.get(i)-ar.get(j);\n\t\t\t\t\ttemp+= temp<0? n:0;\n\t\t\t\t\ttemp= temp>nn? n-temp: temp;\n\t\t\t\t\tans[temp]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=1; i<=nn; i++)\tout.println(ans[i]);\n\t\t}\n\t}\n\t\n\t\n\t// レゴ　横型探索\n\tvoid AOJ0207(){\n\t\twhile(sc.hasNext()){\n\t\t\tint W=sc.nextInt(), H=sc.nextInt();\n\t\t\tif((W|H)==0)\tbreak;\n\t\t\tint sx=sc.nextInt(), sy=sc.nextInt(), gx=sc.nextInt(), gy=sc.nextInt(), n=sc.nextInt();\n\t\t\tint[][] b=new int[W+1][H+1];\n\t\t\tfor(int i=0; i<n; i++){\n\t\t\t\tint color=sc.nextInt(), d=sc.nextInt(), x=sc.nextInt(), y=sc.nextInt();\n\t\t\t\tif(d==0){\t// 横 4x2\n\t\t\t\t\tfor(int j=y; j<y+2; j++){\n\t\t\t\t\t\tfor(int k=x; k<x+4; k++)\tb[k][j]=color;\n\t\t\t\t\t}\n\t\t\t\t}else{\t// 縦 2x4\n\t\t\t\t\tfor(int j=y; j<y+4; j++){\n\t\t\t\t\t\tfor(int k=x; k<x+2; k++)\tb[k][j]=color;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// TODO debug\n\t\t\t//de0207(b,W,H);\n\t\t\tint c=b[sx][sy];\n\t\t\tif(c==0){\n\t\t\t\tout.println(\"NG\");\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tLinkedList<Point> open=new LinkedList<Point>();\n\t\t\tboolean[][] close=new boolean[W+1][H+1];\n\t\t\topen.add(new Point(sx,sy));\n\t\t\tclose[sx][sy]=true;\n\t\t\tString ans=\"NG\";\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tPoint now=open.poll();\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tint xx=now.x+vx[i], yy=now.y+vy[i];\n\t\t\t\t\tif(!Point.ok(xx, yy, W+1, H+1, 1))\tcontinue;\n\t\t\t\t\tif(b[xx][yy]!=c)\tcontinue;\n\t\t\t\t\tif(close[xx][yy])\tcontinue;\n\t\t\t\t\topen.add(new Point(xx,yy));\n\t\t\t\t\tclose[xx][yy]=true;\n\t\t\t\t\tif(xx==gx && yy==gy){\n\t\t\t\t\t\tans=\"OK\";\n\t\t\t\t\t\topen.clear();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t}\n\tvoid de0207(int[][] b, int w, int h){\n\t\tfor(int j=0; j<=h; j++){\n\t\t\tfor(int i=0; i<=w; i++)\tout.print(b[i][j]+\" \");\n\t\t\tout.println();\n\t\t}\n\t\tfor(int i=0; i<=w; i++)\tout.print(\"-\");\n\t\tout.println();\n\t}\n\t\n\tvoid AOJ0139(){\n\t\tint N=sc.nextInt();\n\t\tfinal Pattern ap=Pattern.compile(\"^>'(=+)#(=+)~$\");\n\t\tfor(int i=1; i<=N; i++){\n\t\t\tString s=sc.next();\n\t\t\tMatcher m=ap.matcher(s);\n\t\t\tif(m.matches()){\n\t\t\t\tif(m.group(1).length()==m.group(2).length()){\n\t\t\t\t\tout.println(\"A\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}else if(Pattern.compile(\"^>\\\\^(Q=)+~~$\").matcher(s).matches()){\n\t\t\t\tout.println(\"B\");\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tout.println(\"NA\");\n\t\t}\n\t}\n\t\n\tArrayList<Integer> SieveList(int N){\n\t\tArrayList<Integer> prime=new ArrayList<Integer>();\n\t\tboolean[] list = new boolean[N+1];\n\t\tArrays.fill(list, true);\n\t\tlist[0]=false;\tlist[1]=false;\n\t\tprime.add(2);\n\t\tfor(int j=4; j<=N; j+=2)\tlist[j]=false;\n\t\tfor(int i=3; i<=N; i+=2){\n\t\t\tif(list[i]){\n\t\t\t\tprime.add(i);\n\t\t\t\tfor (int j=i+i; j<=N; j+=i)\tlist[j]=false;\n\t\t\t}\n\t\t}\n\t\treturn prime;\n\t}\n\t\n\tboolean[] Sieve(int N){\n\t\tboolean[] list = new boolean[N+1];\n\t\tArrays.fill(list, true);\n\t\tlist[0]=false;\tlist[1]=false;\n\t\tfor(int j=4; j<=N; j+=2)\tlist[j]=false;\n\t\tfor(int i=3; i*i<=N; i+=2)\tif(list[i])\tfor (int j=i+i; j<=N; j+=i)\tlist[j]=false;\n\t\treturn list;\n\t}\n\t\n\tboolean isPrime(int n){\n\t\tfor(int i=2; i*i<=n; i++){\n\t\t\tif(n%i==0)     return false;\n\t\t}\n\t\treturn true;\n\t}\n\t\n\tint gcd(int x, int y){\n\t\tif(y==0)\treturn x;\n\t\telse\treturn gcd(y, x%y);\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\n\tstatic void solve() {\n\t\tfor (;;) {\n\t\t\tint m = ir.nextInt();\n\t\t\tint n = ir.nextInt();\n\t\t\tif (m == 0 && n == 0)\n\t\t\t\treturn;\n\t\t\tchar[][] map = ir.nextCharMap(n, m);\n\t\t\tString[][] dp = new String[n][m];\n\t\t\tString ret = \"\";\n\t\t\tfor (int i = 0; i < n; i++) {\n\t\t\t\tfor (int j = 0; j < m; j++) {\n\t\t\t\t\tif (map[i][j] >= 'A' && map[i][j] <= 'Z')\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tdp[i][j] = Character.toString(map[i][j]);\n\t\t\t\t\tfor (int k = 0; k < 2; k++) {\n\t\t\t\t\t\tint nx = i + (k & 1);\n\t\t\t\t\t\tint ny = j + ((k & 1) ^ 1);\n\t\t\t\t\t\tif (!(nx >= 0 && nx < n && ny >= 0 && ny < m) ||( map[nx][ny] >= 'A' && map[nx][ny] <= 'Z'))\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tdp[i][j] = max(dp[i][j], Character.toString(map[i][j]) + dp[nx][ny]);\n\t\t\t\t\t}\n\t\t\t\t\tret = max(ret, dp[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ret);\n\t\t}\n\t}\n\n\tstatic String max(String a, String b) {\n\t\tif (a.length() > b.length())\n\t\t\treturn a;\n\t\tif (a.length() < b.length())\n\t\t\treturn b;\n\t\tfor (int i = 0; i < a.length(); i++) {\n\t\t\tif (a.charAt(i) > b.charAt(i))\n\t\t\t\treturn a;\n\t\t\tif (a.charAt(i) < b.charAt(i))\n\t\t\t\treturn b;\n\t\t}\n\t\treturn a;\n\t}\n\n\tpublic static void main(String[] args) throws Exception {\n\t\tir = new InputReader(System.in);\n\t\tout = new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer = new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {\n\t\t\tthis.in = in;\n\t\t\tthis.curbuf = this.lenbuf = 0;\n\t\t}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif (curbuf >= lenbuf) {\n\t\t\t\tcurbuf = 0;\n\t\t\t\ttry {\n\t\t\t\t\tlenbuf = in.read(buffer);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (lenbuf <= 0)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte() {\n\t\t\tif (hasNextByte())\n\t\t\t\treturn buffer[curbuf++];\n\t\t\telse\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tprivate boolean isSpaceChar(int c) {\n\t\t\treturn !(c >= 33 && c <= 126);\n\t\t}\n\n\t\tprivate void skip() {\n\t\t\twhile (hasNextByte() && isSpaceChar(buffer[curbuf]))\n\t\t\t\tcurbuf++;\n\t\t}\n\n\t\tpublic boolean hasNext() {\n\t\t\tskip();\n\t\t\treturn hasNextByte();\n\t\t}\n\n\t\tpublic String next() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tint b = readByte();\n\t\t\twhile (!isSpaceChar(b)) {\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb = readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic double nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tpublic int[] nextIntArray(int n) {\n\t\t\tint[] a = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n) {\n\t\t\tlong[] a = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n, int m) {\n\t\t\tchar[][] map = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tmap[i] = next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\nclass Main{\n    static int w,h;\n    // én_ÜÅÌsecret numberðÛ·é\n    //long^ÉÍûÜçÈ¢ÌÅString^\n    static String[][] fieldS;\n    static int[][] fieldI;//Matrixðint^ÅÛ·é\n    static List<String> numList;//1`9ðString^ÅÛ·éList\n\n    public static void main(String[] args){\n\tScanner sc = new Scanner(System.in);\n\n\t//p©©ð»f·é½ßÉðString^ÅüêÄ¨­\n\tnumList = new ArrayList<String>();\n\tfor(int i=0; i<10; i++){\n\t    String num = Integer.toString(i);\n\t    numList.add(num);\n\t}\n\n\tw = sc.nextInt();\n\th = sc.nextInt();\n\n\twhile(w!=0 && h!=0){\n\t    fieldS = new String[h][w];\n\t    //null¾ÆãXssÈÌÅA·×Ä\"\"Åú»\n\t    for(int i=0; i<h; i++){\n\t\tfor(int j=0; j<w; j++){\n\t\t    fieldS[i][j] = \"\";\n\t\t}\n\t    }\n\t    fieldI = new int[h][w];\n\n\t    //ÌêÍ»ÌÜÜðApÌêÍ-1ðüêé\n\t    for(int i=0; i<h; i++){\n\t\tString line = sc.next();//1sÇÝñÅ©ç\n\t\tfor(int j=0; j<w; j++){\n\t\t    if(numList.contains(line.substring(j,j+1))){\n\t\t\tfieldI[i][j] = Integer.parseInt(line.substring(j,j+1));\n\t\t    }else{\n\t\t\tfieldI[i][j] = -1;\n\t\t    }\n\t\t}\n\t    }\n\n\t    String ans = solve();\n\t    if(!ans.equals(\"-1\") && !ans.equals(\"\"))System.out.println(ans);\n\t    else if(ans.equals(\"-1\"))System.out.println(1);\n\n\t    w = sc.nextInt();\n\t    h = sc.nextInt();\n\t}\n    }\n\n    public static String solve(){\n\tString up = \"\";\n\tString left = \"\";\n\tboolean hantei = false;\n\tfor(int i=0; i<h; i++){\n\t    for(int j=0; j<w; j++){\n\t\tif(fieldI[i][j]!=-1){\n\t\t    //»ÝnÌãÆ¶ÜÅÌsecret numberðärµÄAå«¢ûÉ©gðt¯Á¦éB\n\t\t    hantei = false;\n\t\t    if(i-1>=0){up = fieldS[i-1][j]; hantei=true;}//ãÌl\n\t\t    if(j-1>=0){left = fieldS[i][j-1]; hantei=true;}//¶Ìl\n\t\t    if(hantei ||(i==0 && j==0)){//ãÜ½Í¶ÉlªüÁÄ¢êÎ\n\t\t\tString select = getLargerOne(up,left);//ãÆ¶Åå«¢ûÉ\n\t\t\tfieldS[i][j] = select + Integer.toString(fieldI[i][j]);//t¯Á¦é\n\t\t\tif(fieldS[i][j].equals(\"0\")){fieldS[i][j]=\"\";}//Åª0Èç\n\t\t\tup = \"\";\n\t\t\tleft = \"\";\n\t\t    }else {fieldS[i][j]=Integer.toString(fieldI[i][j]);}//©gÌÝðãü\n\t\t}\n\t    }\n\t}\n\tString max = getMax();\n\treturn max;\n    }\n\n    //2ÂÌsecret numberðärµÄAå«¢ûðÔ·\n    public static String getLargerOne(String up, String left){\n\n\tif(up.length()>left.length()){return up;}\n\telse if(left.length()>up.length()){return left;}\n\n\t//secret numberÌ·³ª¯¶Å êÎAå«¢Ê©çÉä×Ä¢­\n\tfor(int i=0; i<up.length(); i++){\n\t    int upI = Integer.parseInt(up.substring(i,i+1));\n\t    int leftI = Integer.parseInt(left.substring(i,i+1));\n\t    if(upI>leftI){return up;}\n\t    else if(leftI>upI){return left;}\n\t}\n\treturn up;//2ÂÆàS­¯¶Ìê\n    }\n\n    //secret numberÌÅålðßÄÔ·\n    public static String getMax(){\n\t//·³ÌÅålðßé\n\tint maxLen = 0;\n\tList<String> sameLen = new ArrayList<String>();\n\tfor(int i=0; i<h; i++){\n\t    for(int j=0; j<w; j++){\n\t\tif(fieldS[i][j].length()>maxLen){\n\t\t    maxLen = fieldS[i][j].length();\n\t\t}\n\t    }\n\t}\n\n\t//ãÅß½·³ÌÅålÆêv·ésecret number¾¯ðListÉüêé\n\tfor(int i=0; i<h; i++){\n\t    for(int j=0; j<w; j++){\n\t\tif(fieldS[i][j].length()==maxLen){\n\t\t    sameLen.add(fieldS[i][j]);\n\t\t}\n\t    }\n\t}\n\n\t//ÄÍÜéÌª1Â¾¯Ìê\n\tif(sameLen.size()==1){return sameLen.get(0);}\n\n\t//¡ÉÄÍÜÁ½êAå«¢Ê©çÉär·é\n\tint maxInt = 0;\n\tfor(int i=0; i<maxLen; i++){\n\t    maxInt = 0;\n\t    for(int j=0; j<sameLen.size(); j++){\n\t\tString a = sameLen.get(j);\n\t\tint num = Integer.parseInt(a.substring(i,i+1));\n\t\tif(num>maxInt){maxInt=num; j=-1;}//ÅålªXV³ê½çA0ÔÚ©çärµÈ¨µ\n\t\telse if(num<maxInt){sameLen.remove(j); j--;}//Åålæè¬³©Á½çí\n\t\telse if(num==maxInt && i==maxLen-1 && j==sameLen.size()-1){return sameLen.get(0);}//S­¯¶secret numberª¡ Á½ê\n\t\tif(sameLen.size()==1){return sameLen.get(0);}//ÅãÌ1ÂÉÈÁ½çA»êðÔ·\n\t    }\n\t}\n\treturn \"-1\";//ªêÂàÈ©Á½\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\n\tstatic int[][] field;\n\tstatic String[][] dp;\n\tstatic int h,w;\n\tpublic static void main(String[] args) {\n\t\tScanner cin = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tw = cin.nextInt();\n\t\t\th = cin.nextInt();\n\t\t\tif(w+h==0)break;\n\t\t\tfield=new int[h][w];\n\t\t\tdp=new String[h][w];\n\t\t\tfor(int i = 0;i<h;i++){\n\t\t\t\tString s = cin.next();\n\t\t\t\tfor(int j = 0;j<w;j++){\n\t\t\t\t\tdp[i][j]=\"\";\n\t\t\t\t\tif(Character.isDigit(s.charAt(j))){\n\t\t\t\t\t\tfield[i][j]=s.charAt(j)-'0';\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tfield[i][j]=-1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0;i<w;i++){\n\t\t\t\tif(i==0){\n\t\t\t\t\tif(field[0][i]<=0){\n\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tdp[0][i]=\"\"+field[0][i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tif(field[0][i]==-1){\n\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tif(!dp[0][i-1].equals(\"0\")&&!dp[0][i-1].equals(\"\")){\n\t\t\t\t\t\t\tdp[0][i]=dp[0][i-1]+field[0][i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[0][i]=\"\"+field[0][i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0;i<h;i++){\n\t\t\t\tif(i==0){\n\t\t\t\t\tif(field[i][0]<=0){\n\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tdp[i][0]=\"\"+field[i][0];\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tif(field[i][0]==-1){\n\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tif(!dp[i-1][0].equals(\"0\")&&!dp[i-1][0].equals(\"\")){\n\t\t\t\t\t\t\tdp[i][0]=dp[i-1][0]+field[i][0];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[i][0]=\"\"+field[i][0];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tString ans=\"0\";\n\t\t\tfor(int i = 1;i<h;i++){\n\t\t\t\tfor(int j = 1;j<w;j++){\n\t\t\t\t\tif(field[i][j]==-1)continue;\n\t\t\t\t\tString s1=dp[i-1][j]+field[i][j];\n\t\t\t\t\tString s2=dp[i][j-1]+field[i][j];\n\t\t\t\t\tString s3=field[i][j]+\"\";\n\t\t\t\t\tif(big(s1,s2)>=0){\n\t\t\t\t\t\tif(big(s1,s3)>=0){\n\t\t\t\t\t\t\tdp[i][j]=s1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[i][j]=s3;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tif(big(s2,s3)>=0){\n\t\t\t\t\t\t\tdp[i][j]=s2;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[i][j]=s3;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\twhile(dp[i][j].charAt(0)=='0'&&dp[i][j].length()>1){\n\t\t\t\t\t\tdp[i][j]=dp[i][j].substring(1,dp[i][j].length());\n\t\t\t\t\t}\n\t\t\t\t\tif(big(dp[i][j],ans)>0){\n\t\t\t\t\t\tans=dp[i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0;i<h;i++){\n\t\t\t\tfor(int j = 0;j<w;j++){\n\t\t\t\t\tif(big(dp[i][j],ans)>0){\n\t\t\t\t\t\tans=dp[i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//output();\n\t\t\tSystem.out.println(ans);\n\t\t}\n\n\t}\n\tstatic int big(String s1,String s2){\n\t\tif(s1.length()==s2.length()){\n\t\t\treturn s1.compareTo(s2);\n\t\t}\n\t\treturn s1.length()-s2.length();\n\t}\n\tstatic void output(){\n\t\tfor(int i = 0;i<h;i++){\n\t\t\tfor(int j = 0;j<w;j++){\n\t\t\t\tSystem.out.print(dp[i][j]+\" \");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t\tSystem.out.println();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.Arrays;\n\nimport static java.lang.Integer.parseInt;\n\n/**\n * The Secret Number\n */\npublic class Main {\n\n\tstatic char[][] num;\n\tstatic int[][] len;\n\tstatic String max;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line;\n\t\tString[] words;\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\n\t\t\tint W, H;\n\t\t\tW = parseInt(line.substring(0, line.indexOf(' ')));\n\t\t\tH = parseInt(line.substring(line.indexOf(' ') + 1));\n\t\t\tif ((W | H) == 0) break;\n\n\t\t\tnum = new char[H + 2][W + 2];\n\t\t\tlen = new int[H + 2][W + 2];\n\n\t\t\tfor (int i = 0; i < num.length; i++) {\n\t\t\t\tArrays.fill(num[i], 'X');\n\t\t\t}\n\n\t\t\tmax = \"\";\n\n\t\t\tfor (int i = 1; i <= H; i++) {\n\t\t\t\tline = br.readLine();\n\t\t\t\tfor (int j = 1; j <= W; j++) {\n\t\t\t\t\tchar c = line.charAt(j - 1);\n\t\t\t\t\tnum[i][j] = (c <= '9' ? c : 'X');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//\n\t\t\tfor (int i = 1; i <= H; i++) {\n\t\t\t\tfor (int j = 1; j <= W; j++) {\n\t\t\t\t\tif (num[i][j] != 'X' && len[i][j] == 0) {\n\t\t\t\t\t\tsolve(i, j, \"\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tSystem.out.println(max);\n\n\t\t} //end while\n\t} //end main\n\n\tstatic void solve(int y, int x, String s) {\n\n\t\tif (!(s.equals(\"\") && num[y][x] == '0')) {\n\t\t\ts += num[y][x];\n\t\t\tif (s.length() >= len[y][x]) {\n\t\t\t\tlen[y][x] = s.length();\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (num[y + 1][x] == 'X' && num[y][x + 1] == 'X') {\n\t\t\tif (max.length() < s.length()) {\n\t\t\t\tmax = s;\n\t\t\t} else if (max.length() == s.length()) {\n\t\t\t\tfor (int i = 0; i < s.length(); i++) {\n\t\t\t\t\tif (s.charAt(i) > max.charAt(i)) {\n\t\t\t\t\t\tmax = s;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else if (s.charAt(i) < max.charAt(i)) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (num[y + 1][x] != 'X') solve(y + 1, x, s);\n\t\tif (num[y][x + 1] != 'X') solve(y, x + 1, s);\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport static java.lang.System.*;\n\npublic class Main {\n\n\tScanner sc = new Scanner(in);\n\t\n\tString[][] memo;\n\tint[][] mat;\n\tint w, h;\n\t\n\tint compare(String s1, String s2) {\n\t\tint c1, c2;\n\t\tc1 = c2 = 0;\n\t\tint index = 0;\n\t\twhile (index < s1.length() && s1.charAt(index) == '0') {\n\t\t\tc1++;\n\t\t\tindex++;\n\t\t}\n\t\tindex = 0;\n\t\twhile (index < s2.length() &&s2.charAt(index) == '0') {\n\t\t\tc2++;\n\t\t\tindex++;\n\t\t}\n\t\tif (s1.length()-c1 > s2.length() -c2) return 1;\n\t\telse if (s1.length()-c1 < s2.length() -c2) return -1;\n\t\t\n\t\treturn s1.substring(c1).compareTo(s2.substring(c2));\n\t}\n\t\n\tString calc(int i, int j) {\n\t\tif (memo[i][j] == null) {\n\t\t\tString s1, s2;\n\t\t\ts1 = s2 = null;\n\t\t\tif (i+1 < h && mat[i+1][j] >= 0) s1 = calc(i+1, j);\n\t\t\tif (j+1 < w && mat[i][j+1] >= 0) s2 = calc(i, j+1);\n\t\t\tif (s1 == null && s2 == null)\n\t\t\t\tmemo[i][j] = String.valueOf(mat[i][j]);\n\t\t\telse if (s1 == null)\n\t\t\t\tmemo[i][j] = String.valueOf(mat[i][j])+s2;\n\t\t\telse if (s2 == null)\n\t\t\t\tmemo[i][j] = String.valueOf(mat[i][j])+s1;\n\t\t\telse if (compare(s1, s2) > 0)\n\t\t\t\tmemo[i][j] = String.valueOf(mat[i][j])+s1;\n\t\t\telse\n\t\t\t\tmemo[i][j] = String.valueOf(mat[i][j])+s2;\n\t\t}\n\t\treturn memo[i][j];\n\t}\n\t\n\tvoid run() {\n\t\twhile (true) {\n\t\t\tw = sc.nextInt(); h = sc.nextInt();\n\t\t\tif (w == 0 && h == 0) return;\n\t\t\tsc.nextLine();\n\t\t\tmat = new int[h][w];\n\t\t\tfor (int i = 0; i < h; i++) {\n\t\t\t\tString s = sc.nextLine();\n\t\t\t\tfor (int j = 0; j < w; j++) {\n\t\t\t\t\tif (Character.isDigit(s.charAt(j))) {\n\t\t\t\t\t\tmat[i][j] = Character.getNumericValue(s.charAt(j));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmat[i][j] = -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tmemo = new String[h][w];\n\t\t\tString ans = \"0\";\n\t\t\tfor (int i = 0; i < h; i++) {\n\t\t\t\tfor (int j = 0; j < w; j++) {\n\t\t\t\t\tif (memo[i][j] == null && mat[i][j] >= 0) {\n\t\t\t\t\t\tcalc(i, j);\n\t\t\t\t\t\tif (compare(ans, memo[i][j]) < 0)\n\t\t\t\t\t\t\tans = memo[i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tint index = 0, c = 0;\n\t\t\twhile (ans.charAt(index) == '0') {\n\t\t\t\tc++;\n\t\t\t\tindex++;\n\t\t\t}\n\t\t\t\n\t\t\tout.println(ans.substring(c));\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.*;\nimport static java.lang.System.*;\n\npublic class Main {\n\n\tScanner sc = new Scanner(in);\n\t\n\tvoid run() {\n\t\twhile (true) {\n\t\t\tint w = sc.nextInt(), h = sc.nextInt();\n\t\t\tif (w == 0 && h == 0) break;\n\t\t\tString[] rows = new String[h];\n\t\t\tfor (int i = 0; i < h; i++)\n\t\t\t\trows[i] = sc.next();\n\t\t\tBigInteger[][] dp = new BigInteger[h+1][w+1];\n\t\t\tfor (int i = 0 ; i <= h; i++)\n\t\t\t\tfor (int j = 0; j <= w; j++)\n\t\t\t\t\tdp[i][j] = BigInteger.ZERO;\n\t\t\t\n\t\t\tBigInteger res = BigInteger.ZERO;\n\t\t\tfor (int i = 1; i <= h; i++) {\n\t\t\t\tfor (int j = 1; j <= w; j++) {\n\t\t\t\t\tif (Character.isDigit(rows[i-1].charAt(j-1))) {\n\t\t\t\t\t\tdp[i][j] = (((dp[i-1][j].compareTo(dp[i][j-1]) > 0) ? dp[i-1][j] : dp[i][j-1]).multiply(BigInteger.TEN)).add(new BigInteger(\"\"+rows[i-1].charAt(j-1)));\n\t\t\t\t\t\tres = (dp[i][j].compareTo(res) > 0) ? dp[i][j] : res;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(res);\n\t\t}\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.InputStreamReader;\nimport java.math.BigInteger;\nimport java.util.ArrayList;\nimport java.util.Collections;\n\nclass Main{\n\tstatic char tiles[][];\n\tstatic int w;\n\tstatic int h;\n\tstatic String answer;\n\tpublic static void main(String args[]){\n\t\t// 標準入力準備\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\t//Scanner sc = new Scanner(System.in);\n\t\tString str = new String();\n\n\t\ttry{\n\t\t\twhile(true){\n\t\t\t\tstr = br.readLine();\n\t\t\t\tString strs[] = str.split(\" \");\n\t\t\t\tw = Integer.parseInt(strs[0]);\n\t\t\t\th = Integer.parseInt(strs[1]);\n\n\t\t\t\tif(w == 0) break;\n\t\t\t\ttiles = new char[h][w];\n\t\t\t\tanswer = \"0\";\n\n\t\t\t\t// タイル入力\n\t\t\t\tfor(int i = 0; i < h; i++){\n\t\t\t\t\tstr = br.readLine();\n\t\t\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\t\t\ttiles[i][j] = str.charAt(j);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//printMatrix(tiles);\n\t\t\t\tfor(int x = 0; x < w; x++){\n\t\t\t\t\tfor(int y = 0; y < h; y++){\n\t\t\t\t\t\t// 数字で始まっていること\n\t\t\t\t\t\tif('0' <= tiles[y][x] && tiles[y][x] <= '9'){\n\t\t\t\t\t\t\t// 左が数字でないこと\n\t\t\t\t\t\t\tif(y == 0 || '9' < tiles[y-1][x]){\n\t\t\t\t\t\t\t\t// 上が数字でないこと\n\t\t\t\t\t\t\t\tif(x == 0 || '9' < tiles[y][x-1]){\n\t\t\t\t\t\t\t\t\tsolve(x, y, \"\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tSystem.out.println(answer);\n\t\t\t}\n\t\t}catch(Exception e){\n\t\t\tSystem.err.println(e);\n\t\t}\n\t}\n\n\tstatic void solve(int x, int y, String num_str){\n\t\t//System.out.println(\"solve \" + x + \" \" + y);\n\t\tnum_str = num_str + tiles[y][x];\n\n\t\tboolean end_flag = true;\n\t\t// 右を見る\n\t\tif(x+1 < w && '0' <= tiles[y][x+1] && tiles[y][x+1] <= '9'){\n\t\t\tsolve(x+1, y, num_str);\n\t\t\tend_flag = false;\n\t\t}\n\n\t\t// 下を見る\n\t\tif(y+1 < h && '0' <= tiles[y+1][x] && tiles[y+1][x] <= '9'){\n\t\t\tsolve(x, y+1, num_str);\n\t\t\tend_flag = false;\n\t\t}\n\n\t\tif(end_flag){\n\t\t\t//System.out.println(num_str);\n\t\t\t//int num = Integer.parseInt(num_str);\n\t\t\tBigInteger num = new BigInteger(num_str);\n\t\t\tBigInteger ans = new BigInteger(answer);\n\t\t\tif(num.compareTo(ans) == 1) answer = num_str;\n\t\t}\n\t}\n\n\n\tstatic void printArray(ArrayList<Integer[]> array){\n\t\tSystem.out.println(\"PrintArray \" + array.size());\n\t\tfor(int i = 0; i < array.size(); i++){\n\t\t\tInteger set[] = array.get(i);\n\t\t\tSystem.out.print(\"(\" + set[0] + \", \" + set[1] + \")\");\n\t\t}\n\t\tSystem.out.println();\n\t}\n\n\tstatic void printMatrix(int matrix[][]){\n\t\tfor(int row = 0; row < matrix.length; row++){\n\t\t\tfor(int column = 0; column < matrix[row].length; column++){\n\t\t\t\tSystem.out.print(matrix[row][column] + \"\\t\");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tstatic void printMatrix(boolean matrix[][]){\n\t\tfor(int row = 0; row < matrix.length; row++){\n\t\t\tfor(int column = 0; column < matrix[row].length; column++){\n\t\t\t\tSystem.out.print(matrix[row][column] + \"\\t\");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tstatic void printMatrix(char matrix[][]){\n\t\tfor(int row = 0; row < matrix.length; row++){\n\t\t\tfor(int column = 0; column < matrix[row].length; column++){\n\t\t\t\tSystem.out.print(matrix[row][column]);\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tstatic void printArray(int array[]){\n\t\tfor(int i = 0; i < array.length; i++){\n\t\t\tSystem.out.print(array[i] + \"\\t\");\n\t\t}\n\t\tSystem.out.println();\n\t}\n}\n\nclass OriginalSet{\n\tpublic ArrayList<Integer> set;\n\n\tOriginalSet(){\n\t\tset = new ArrayList<Integer>();\n\t}\n\n\tpublic void add(int inputInt){\n\t\tif(set.indexOf(inputInt) == -1){\n\t\t\tset.add(inputInt);\n\t\t}\n\t}\n\n\tpublic void addAll(OriginalSet inputSet){\n\t\tArrayList<Integer> inputArray = inputSet.set;\n\t\tfor(int i = 0; i < inputArray.size(); i++){\n\t\t\tadd(inputArray.get(i));\n\t\t}\n\t}\n\n\tpublic void remove(int inputInt){\n\t\tset.remove((Integer)inputInt);\n\t}\n\n\tpublic void removeAll(OriginalSet inputSet){\n\t\tArrayList<Integer> inputArray = inputSet.set;\n\t\tfor(int i = 0; i < inputArray.size(); i++){\n\t\t\tremove(inputArray.get(i));\n\t\t}\n\t}\n\n\tpublic void print(){\n\t\tif(set.size() == 0){\n\t\t\tSystem.out.println(\"NULL\");\n\t\t\treturn;\n\t\t}\n\t\t// ソート\n\t\tCollections.sort(set);\n\t\tSystem.out.print(set.get(0));\n\t\tfor(int i = 1; i < set.size(); i++){\n\t\t\tSystem.out.print(\" \" + set.get(i));\n\t\t}\n\t\tSystem.out.println();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\npublic class Main {\n\t\n\tprivate void doit(){\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tif((w|h) == 0)break;\n\t\t\tchar [][] data =new char[h][w];\n\t\t\tfor(int i = 0 ; i < h; i++){\n\t\t\t\tString s = sc.next();\n\t\t\t\tfor(int j = 0 ; j < w; j++){\n\t\t\t\t\tdata[i][j] = s.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tString [][] dp = new String[h][w];\n\t\t\tfor(int i = 0 ; i < h; i++){\n\t\t\t\tfor(int j = 0 ; j < w; j++){\n\t\t\t\t\tif(Character.isDigit(data[i][j]) && (data[i][j] != '0')){\n\t\t\t\t\t\tdp[i][j] = data[i][j] + \"\";\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tdp[i][j] = \"\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfor(int i = 0; i < h; i++){\n\t\t\t\tfor(int j = 0 ; j < w; j++){\n\t\t\t\t\tif(! Character.isDigit(data[i][j])) continue;\n\t\t\t\t\tif(data[i][j] == '0' && dp[i][j].equals(\"\")) continue;\n\t\t\t\t\tif(i + 1 != h){\n\t\t\t\t\t\tif(dp[i+1][j].length() < dp[i][j].length()  + 1){\n\t\t\t\t\t\t\tdp[i+1][j] = dp[i][j] + data[i+1][j];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(dp[i+1][j].length() == dp[i][j].length()  + 1 && dp[i+1][j].compareTo(dp[i][j] + data[i+1][j]) < 0){\n\t\t\t\t\t\t\tdp[i+1][j] = dp[i][j] + data[i+1][j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(j + 1 != w){\n\t\t\t\t\t\tif(dp[i][j+1].length() < dp[i][j].length()  + 1){\n\t\t\t\t\t\t\tdp[i][j+1] = dp[i][j] + data[i][j+1];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(dp[i][j+1].length() == dp[i][j].length()  + 1  && dp[i][j+1].compareTo(dp[i][j] + data[i][j+1]) < 0){\n\t\t\t\t\t\t\tdp[i][j+1] = dp[i][j] + data[i][j+1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t//debug\n//\t\t\tfor(int i = 0 ; i < h; i++){\n//\t\t\t\tfor(int j  = 0 ;  j < w; j++){\n//\t\t\t\t\tif(dp[i][j].equals(\"\")){\n//\t\t\t\t\t\tSystem.out.print(\". \");\n//\t\t\t\t\t}\n//\t\t\t\t\telse{\n//\t\t\t\t\t\tSystem.out.print(dp[i][j] + \" \");\n//\t\t\t\t\t\t\n//\t\t\t\t\t}\n//\t\t\t\t}\n//\t\t\t\tSystem.out.println();\n//\t\t\t}\n\t\t\t\n\t\t\tString ans = \"\";\n\t\t\tfor(int i = 0 ; i < h; i++){\n\t\t\t\tfor(int j = 0 ; j < w; j++){\n\t\t\t\t\tif(! Character.isDigit(data[i][j])) continue;\n\t\t\t\t\tif(ans.length() < dp[i][j].length() + 1){\n\t\t\t\t\t\tans = dp[i][j];\n\t\t\t\t\t}\n\t\t\t\t\telse if(ans.length() == dp[i][j].length()&& ans .compareTo(dp[i][j]) < 0){\n\t\t\t\t\t\tans = dp[i][j] ;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\t\n\tpublic static void main(String [] args){\n\t\tnew Main().doit();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.*;\n\n\npublic class Main {\n\tstatic ArrayList<String> cand = new ArrayList<String>();\n\tstatic int max = 0;\n\tpublic static void main(String[] args) {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));       \n\t\ttry {\n\t\t\tString line;\n\t\t\twhile(true){\n\t\t\t\t/* input */\n\t\t\t\tcand = new ArrayList<String>();\n\t\t\t\tline = br.readLine();\n\t\t\t\t\n\t\t\t\tint w = Integer.parseInt(line.split(\" \")[0]);\n\t\t\t\tint h = Integer.parseInt(line.split(\" \")[1]);\n\t\t\t\tif(w == 0 && h == 0){\n\t\t\t\t\treturn;\n\t\t\t\t} \n\n\t\t\t\tchar[][] field = new char[h][w];\n\t\t\t\tfor(int i=0;i<h;i++){\n\t\t\t\t\tline = br.readLine();\n\t\t\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\t\t\tfield[i][j] = line.charAt(j);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t/* processing */\n\t\t\t\tfor(int i=0;i<h;i++){\n\t\t\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\t\t\tif((h-i)+(w-j)<max){\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(i>0){\n\t\t\t\t\t\t\tif(Character.isDigit(field[i-1][j])&&(field[i-1][j]!='0')){\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(j>0){\n\t\t\t\t\t\t\tif(Character.isDigit(field[i][j-1])&&(field[i][j-1]!='0')){\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(Character.isDigit(field[i][j])&&(field[i][j]!='0')){\n\t\t\t\t\t\t\t\tsearch(i,j,field,h,w,\"\"+field[i][j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/* output */\n\t\t\t\tCollections.sort(cand);\n\t\t\t\tint maxlength = 0;\n\t\t\t\tString maxs = \"\";\n\t\t\t\tfor(String s: cand){\n\t\t\t\t\t//System.out.println(s);\n\t\t\t\t\tif (s.length()>maxlength){\n\t\t\t\t\t\tmaxlength = s.length();\n\t\t\t\t\t\tmaxs = s;\n\t\t\t\t\t} else if(s.length()==maxlength){\n\t\t\t\t\t\tfor(int i=0;i<s.length();i++){\n\t\t\t\t\t\t\tif(s.charAt(i)>maxs.charAt(i)){\n\t\t\t\t\t\t\t\tmaxs = s;\n\t\t\t\t\t\t\t} else if(s.charAt(i)>maxs.charAt(i)){\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//System.out.println();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tSystem.out.println(maxs);\n\t\t\t}\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\n\tpublic static void search(int i,int j,char[][] field,int h,int w, String s){\n\t\tboolean r = true, d = true;\n\t\tif(j<w-1){\n\t\t\tif(Character.isDigit(field[i][j+1])){\n\t\t\t\tsearch(i,j+1,field,h,w,s + field[i][j+1]);\n\t\t\t\tr = false;\n\t\t\t}\n\t\t}\n\n\t\tif(i<h-1){\n\t\t\tif(Character.isDigit(field[i+1][j])){\n\t\t\t\tsearch(i+1,j,field,h,w,s + field[i+1][j]);\n\t\t\t\td = false;\n\t\t\t}\n\t\t}\n\t\tif(r&&d){\n\t\t\tmax = s.length();\n\t\t\tcand.add(s);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\n  Scanner sc;\n\n  Main() {\n    sc = new Scanner(System.in);\n  }\n\n  int ni() {\n    return sc.nextInt();\n  }\n\n  public static void main(String[] args) {\n    new Main().run();\n  }\n\n  int w, h;\n  char[][] c;\n\n  static int[][] ofs = {\n      {1, 0},\n      {0, 1}\n  };\n\n  String[][] done;\n\n  String dfs(int x, int y, String num) {\n    if (x >= w) {\n      return \"\";\n    }\n    if (y >= h) {\n      return \"\";\n    }\n    if (c[y][x] < '0' || '9' < c[y][x]) {\n      return num;\n    }\n    num += c[y][x];\n    if (new BigInteger(done[y][x]).compareTo(new BigInteger(num)) >= 0) {\n      return \"\";\n    }\n    done[y][x] = num;\n    String res = num;\n    for (int i = 0; i < 2; ++i) {\n      int nx = x + ofs[i][0];\n      int ny = y + ofs[i][1];\n      String nnum = dfs(nx, ny, num);\n      if (res.length() < nnum.length()) {\n        res = nnum;\n      } else if (res.length() == nnum.length() &&\n          new BigInteger(res).compareTo(new BigInteger(nnum)) < 0) {\n        res = new BigInteger(nnum).toString();\n      }\n    }\n    return res;\n  }\n\n  void run() {\n    for (; ; ) {\n      w = ni();\n      h = ni();\n      if ((w | h) == 0) {\n        break;\n      }\n      c = new char[h][w];\n      done = new String[h][w];\n      for (int i = 0; i < h; ++i) {\n        String line = sc.next();\n        for (int j = 0; j < w; ++j) {\n          c[i][j] = line.charAt(j);\n          done[i][j] = \"0\";\n        }\n      }\n      String ans = \"0\";\n      for (int i = 0; i < h; ++i) {\n        for (int j = 0; j < w; ++j) {\n          String sans = dfs(j, i, \"\");\n          if (sans.length() > ans.length()) {\n            ans = sans;\n          } else if (sans.length() == ans.length()) {\n            if (new BigInteger(ans).compareTo(new BigInteger(sans)) < 0) {\n              ans = sans;\n            }\n          }\n        }\n      }\n      System.out.println(ans);\n    }\n  }\n\n  void debug(Object... os) {\n    System.err.println(Arrays.deepToString(os));\n  }\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.ArrayList;\nimport java.util.Scanner;\npublic class Main {\n\tstatic int w;\n\tstatic int h;\n\tstatic String[][] map;\n\tpublic static void main(String[] args) {\n\t\tScanner stdIn = new Scanner(System.in);\n\t\twhile(true) {\n\t\t\tw = stdIn.nextInt();\n\t\t\th = stdIn.nextInt();\n\t\t\tif(w == 0 && h == 0) break;\n\t\t\tmap = new String[h][w];\n\t\t\tfor(int i = 0; i < h; i++) {\n\t\t\t\tString tmp = stdIn.next();\n\t\t\t\tfor(int j = 0; j < w; j++) {\n\t\t\t\t\tmap[i][j] = String.valueOf(tmp.charAt(j));\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tString ans = dp();\n\t\t\t\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\tpublic static String dp() {\n\t\tfor(int i = h-1; i >= 0; i--) {\n\t\t\tfor(int j = w-1; j >= 0; j--) {\n\t\t\t\tint cx1 = j;\n\t\t\t\tint cy1 = i+1;\n\t\t\t\tint cx2 = j+1;\n\t\t\t\tint cy2 = i;\n\t\t\t\tif(!fC(map[i][j])) continue;\n\t\t\t\tString a = map[i][j];\n\t\t\t\tString b = map[i][j];\n\t\t\t\tif(cx1 < w && cy1 < h &&fC(map[cy1][cx1])) {\n\t\t\t\t\ta = map[i][j] + map[cy1][cx1];\n\t\t\t\t}\n\t\t\t\tif(cx2 < w && cy2 < h && fC(map[cy2][cx2])) {\n\t\t\t\t\tb = map[i][j] + map[cy2][cx2];\n\t\t\t\t}\n\t\t\t\tif(StComp(a,b)) {\n\t\t\t\t\tmap[i][j] = a;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tmap[i][j] = b;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tString ret = \"0\";\n\t\tfor(int i = 0; i < w; i++) {\n\t\t\tif(fC(map[0][i])  && StComp(LV(map[0][i]),ret)) {\n\t\t\t\tret = LV(map[0][i]);\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n\tpublic static String LV(String a) {\n\t\tString cp = a;\n\t\tfor(int i = 0; i < a.length(); i++) {\n\t\t\tif(cp.charAt(0) == '0') {\n\t\t\t\tcp = cp.substring(1, cp.length());\n\t\t\t}\n\t\t}\n\t\treturn cp;\n\t}\n\t// 数字の文字列比較　aがbより大きいか等しい場合trueを返す\n\tpublic static boolean fC(String a) {\n\t\tif(a.length() >= 2) {\n\t\t\treturn true;\n\t\t}\n\t\tfor(int i = 0; i < 10; i++) {\n\t\t\tif(a.charAt(0) == String.valueOf(i).charAt(0)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tpublic static boolean StComp(String a, String b) {\n\n\t\tif(a.length() > b.length()) return true;\n\t\tif(a.length() == b.length()) {\n\t\t\tif(a.compareTo(b) < 0) return false;\n\t\t\telse return true;\n\t\t}\n\t\treturn false;\n\t}\n}\n\t"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile (true) {\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tif (w == 0 && h == 0)\n\t\t\t\tbreak;\n\t\t\tString[] str = new String[h];\n\t\t\tfor (int i = 0; i < h; i++)\n\t\t\t\tstr[i] = sc.next();\n\t\t\tString[][] field = new String[h][w];\n\t\t\tfor (int i = 0; i < h; i++)\n\t\t\t\tfor (int j = 0; j < w; j++)\n\t\t\t\t\tfield[i][j] = \"\";\n\t\t\tswitch (str[0].charAt(0)) {\n\t\t\tcase '0':\n\t\t\tcase '1':\n\t\t\tcase '2':\n\t\t\tcase '3':\n\t\t\tcase '4':\n\t\t\tcase '5':\n\t\t\tcase '6':\n\t\t\tcase '7':\n\t\t\tcase '8':\n\t\t\tcase '9':\n\t\t\t\tfield[0][0] = str[0].substring(0, 1);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfield[0][0] = \"\";\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tString max = field[0][0];\n\t\t\tfor (int i = 0; i < h; i++)\n\t\t\t\tfor (int j = 0; j < w; j++) {\n\t\t\t\t\tif (i > 0) {\n\t\t\t\t\t\tif (field[i - 1][j].equals(\"\")\n\t\t\t\t\t\t\t\t|| field[i - 1][j].equals(\"0\"))\n\t\t\t\t\t\t\tswitch (str[i].charAt(j)) {\n\t\t\t\t\t\t\tcase '0':\n\t\t\t\t\t\t\tcase '1':\n\t\t\t\t\t\t\tcase '2':\n\t\t\t\t\t\t\tcase '3':\n\t\t\t\t\t\t\tcase '4':\n\t\t\t\t\t\t\tcase '5':\n\t\t\t\t\t\t\tcase '6':\n\t\t\t\t\t\t\tcase '7':\n\t\t\t\t\t\t\tcase '8':\n\t\t\t\t\t\t\tcase '9':\n\t\t\t\t\t\t\t\tfield[i][j] = maxString(field[i][j],\n\t\t\t\t\t\t\t\t\t\tstr[i].substring(j, j + 1));\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tfield[0][0] = \"\";\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tswitch (str[i].charAt(j)) {\n\t\t\t\t\t\t\tcase '0':\n\t\t\t\t\t\t\tcase '1':\n\t\t\t\t\t\t\tcase '2':\n\t\t\t\t\t\t\tcase '3':\n\t\t\t\t\t\t\tcase '4':\n\t\t\t\t\t\t\tcase '5':\n\t\t\t\t\t\t\tcase '6':\n\t\t\t\t\t\t\tcase '7':\n\t\t\t\t\t\t\tcase '8':\n\t\t\t\t\t\t\tcase '9':\n\t\t\t\t\t\t\t\tfield[i][j] = maxString(\n\t\t\t\t\t\t\t\t\t\tfield[i][j],\n\t\t\t\t\t\t\t\t\t\tfield[i - 1][j]\n\t\t\t\t\t\t\t\t\t\t\t\t+ str[i].substring(j, j + 1));\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tfield[0][0] = \"\";\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (j > 0) {\n\t\t\t\t\t\tif (field[i][j - 1].equals(\"\")\n\t\t\t\t\t\t\t\t|| field[i][j - 1].equals(\"0\"))\n\t\t\t\t\t\t\tswitch (str[i].charAt(j)) {\n\t\t\t\t\t\t\tcase '0':\n\t\t\t\t\t\t\tcase '1':\n\t\t\t\t\t\t\tcase '2':\n\t\t\t\t\t\t\tcase '3':\n\t\t\t\t\t\t\tcase '4':\n\t\t\t\t\t\t\tcase '5':\n\t\t\t\t\t\t\tcase '6':\n\t\t\t\t\t\t\tcase '7':\n\t\t\t\t\t\t\tcase '8':\n\t\t\t\t\t\t\tcase '9':\n\t\t\t\t\t\t\t\tfield[i][j] = maxString(field[i][j],\n\t\t\t\t\t\t\t\t\t\tstr[i].substring(j, j + 1));\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tfield[0][0] = \"\";\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tswitch (str[i].charAt(j)) {\n\t\t\t\t\t\t\tcase '0':\n\t\t\t\t\t\t\tcase '1':\n\t\t\t\t\t\t\tcase '2':\n\t\t\t\t\t\t\tcase '3':\n\t\t\t\t\t\t\tcase '4':\n\t\t\t\t\t\t\tcase '5':\n\t\t\t\t\t\t\tcase '6':\n\t\t\t\t\t\t\tcase '7':\n\t\t\t\t\t\t\tcase '8':\n\t\t\t\t\t\t\tcase '9':\n\t\t\t\t\t\t\t\tfield[i][j] = maxString(\n\t\t\t\t\t\t\t\t\t\tfield[i][j],\n\t\t\t\t\t\t\t\t\t\tfield[i][j - 1]\n\t\t\t\t\t\t\t\t\t\t\t\t+ str[i].substring(j, j + 1));\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tfield[0][0] = \"\";\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tmax = maxString(max, field[i][j]);\n\t\t\t\t}\n\t\t\tSystem.out.println(max);\n\t\t}\n\t\tsc.close();\n\t}\n\n\tstatic String maxString(String a, String b) {\n\t\tString result = \"\";\n\t\tif (a.length() > b.length())\n\t\t\tresult = a;\n\t\tif (a.length() < b.length())\n\t\t\tresult = b;\n\t\tif (a.length() == b.length()) {\n\t\t\tif (a.compareTo(b) < 0)\n\t\t\t\tresult = b;\n\t\t\telse\n\t\t\t\tresult = a;\n\t\t}\n\t\treturn result;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\npublic class Main {\n\t\n\tprivate void doit(){\n\t\tScanner sc = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tif((w|h) == 0)break;\n\t\t\tchar [][] data =new char[h][w];\n\t\t\tfor(int i = 0 ; i < h; i++){\n\t\t\t\tString s = sc.next();\n\t\t\t\tfor(int j = 0 ; j < w; j++){\n\t\t\t\t\tdata[i][j] = s.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tString [][] dp = new String[h][w];\n\t\t\tfor(int i = 0 ; i < h; i++){\n\t\t\t\tfor(int j = 0 ; j < w; j++){\n\t\t\t\t\tif(Character.isDigit(data[i][j]) && (data[i][j] != '0')){\n\t\t\t\t\t\tdp[i][j] = data[i][j] + \"\";\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tdp[i][j] = \"\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tfor(int i = 0; i < h; i++){\n\t\t\t\tfor(int j = 0 ; j < w; j++){\n\t\t\t\t\tif(! Character.isDigit(data[i][j])) continue;\n\t\t\t\t\tif(data[i][j] == '0' && dp[i][j].equals(\"\")) continue;\n\t\t\t\t\tif(i + 1 != h){\n\t\t\t\t\t\tif(dp[i+1][j].length() < dp[i][j].length()  + 1){\n\t\t\t\t\t\t\tdp[i+1][j] = dp[i][j] + data[i+1][j];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(dp[i+1][j].length() == dp[i][j].length()  + 1 && dp[i+1][j].compareTo(dp[i][j] + data[i+1][j]) < 0){\n\t\t\t\t\t\t\tdp[i+1][j] = dp[i][j] + data[i+1][j];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(j + 1 != w){\n\t\t\t\t\t\tif(dp[i][j+1].length() < dp[i][j].length()  + 1){\n\t\t\t\t\t\t\tdp[i][j+1] = dp[i][j] + data[i][j+1];\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(dp[i][j+1].length() == dp[i][j].length()  + 1  && dp[i][j+1].compareTo(dp[i][j] + data[i][j+1]) < 0){\n\t\t\t\t\t\t\tdp[i][j+1] = dp[i][j] + data[i][j+1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t//debug\n//\t\t\tfor(int i = 0 ; i < h; i++){\n//\t\t\t\tfor(int j  = 0 ;  j < w; j++){\n//\t\t\t\t\tif(dp[i][j].equals(\"\")){\n//\t\t\t\t\t\tSystem.out.print(\". \");\n//\t\t\t\t\t}\n//\t\t\t\t\telse{\n//\t\t\t\t\t\tSystem.out.print(dp[i][j] + \" \");\n//\t\t\t\t\t\t\n//\t\t\t\t\t}\n//\t\t\t\t}\n//\t\t\t\tSystem.out.println();\n//\t\t\t}\n\t\t\t\n\t\t\tString ans = \"\";\n\t\t\tfor(int i = 0 ; i < h; i++){\n\t\t\t\tfor(int j = 0 ; j < w; j++){\n\t\t\t\t\tif(! Character.isDigit(data[i][j])) continue;\n\t\t\t\t\tif(ans.length() < dp[i][j].length()){\n\t\t\t\t\t\tans = dp[i][j];\n\t\t\t\t\t}\n\t\t\t\t\telse if(ans.length() == dp[i][j].length()&& ans.compareTo(dp[i][j]) < 0){\n\t\t\t\t\t\tans = dp[i][j] ;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\t\n\tpublic static void main(String [] args){\n\t\tnew Main().doit();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.IOException;\nimport java.io.InputStream;\nimport java.io.PrintWriter;\nimport java.util.Arrays;\nimport java.util.InputMismatchException;\nimport java.util.NoSuchElementException;\n\npublic class Main {\n\n\tstatic PrintWriter out;\n\tstatic InputReader ir;\n\n\tstatic void solve() {\n\t\tint n=ir.nextInt();\n\t\tint m=ir.nextInt();\n\t\tchar[][] map=ir.nextCharMap(n, m);\n\t\tString[][] dp=new String[n][m];\n\t\tString ret=\"\";\n\t\tfor(int i=0;i<n;i++){\n\t\t\tfor(int j=0;j<m;j++){\n\t\t\t\tif(map[i][j]>='A'&&map[i][j]<='Z')\n\t\t\t\t\tcontinue;\n\t\t\t\tdp[i][j]=Character.toString(map[i][j]);\n\t\t\t\tfor(int k=0;k<2;k++){\n\t\t\t\t\tint nx=i+(k&1);\n\t\t\t\t\tint ny=j+((k&1)^1);\n\t\t\t\t\tif(map[nx][ny]>='A'&&map[nx][ny]<='Z')\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tdp[i][j]=max(dp[i][j],Character.toString(map[i][j])+dp[nx][ny]);\n\t\t\t\t}\n\t\t\t\tret=max(ret,dp[i][j]);\n\t\t\t}\n\t\t}\n\t\tout.println(ret);\n\t}\n\n\tstatic String max(String a,String b){\n\t\tif(a.length()>b.length())\n\t\t\treturn a;\n\t\tif(a.length()<b.length())\n\t\t\treturn b;\n\t\tfor(int i=0;i<a.length();i++){\n\t\t\tif(a.charAt(i)>b.charAt(i))\n\t\t\t\treturn a;\n\t\t\tif(a.charAt(i)<b.charAt(i))\n\t\t\t\treturn b;\n\t\t}\n\t\treturn a;\n\t}\n\t\n\tpublic static void main(String[] args) throws Exception {\n\t\tir = new InputReader(System.in);\n\t\tout = new PrintWriter(System.out);\n\t\tsolve();\n\t\tout.flush();\n\t}\n\n\tstatic class InputReader {\n\n\t\tprivate InputStream in;\n\t\tprivate byte[] buffer = new byte[1024];\n\t\tprivate int curbuf;\n\t\tprivate int lenbuf;\n\n\t\tpublic InputReader(InputStream in) {\n\t\t\tthis.in = in;\n\t\t\tthis.curbuf = this.lenbuf = 0;\n\t\t}\n\n\t\tpublic boolean hasNextByte() {\n\t\t\tif (curbuf >= lenbuf) {\n\t\t\t\tcurbuf = 0;\n\t\t\t\ttry {\n\t\t\t\t\tlenbuf = in.read(buffer);\n\t\t\t\t} catch (IOException e) {\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\t}\n\t\t\t\tif (lenbuf <= 0)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate int readByte() {\n\t\t\tif (hasNextByte())\n\t\t\t\treturn buffer[curbuf++];\n\t\t\telse\n\t\t\t\treturn -1;\n\t\t}\n\n\t\tprivate boolean isSpaceChar(int c) {\n\t\t\treturn !(c >= 33 && c <= 126);\n\t\t}\n\n\t\tprivate void skip() {\n\t\t\twhile (hasNextByte() && isSpaceChar(buffer[curbuf]))\n\t\t\t\tcurbuf++;\n\t\t}\n\n\t\tpublic boolean hasNext() {\n\t\t\tskip();\n\t\t\treturn hasNextByte();\n\t\t}\n\n\t\tpublic String next() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tStringBuilder sb = new StringBuilder();\n\t\t\tint b = readByte();\n\t\t\twhile (!isSpaceChar(b)) {\n\t\t\t\tsb.appendCodePoint(b);\n\t\t\t\tb = readByte();\n\t\t\t}\n\t\t\treturn sb.toString();\n\t\t}\n\n\t\tpublic int nextInt() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tint res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic long nextLong() {\n\t\t\tif (!hasNext())\n\t\t\t\tthrow new NoSuchElementException();\n\t\t\tint c = readByte();\n\t\t\twhile (isSpaceChar(c))\n\t\t\t\tc = readByte();\n\t\t\tboolean minus = false;\n\t\t\tif (c == '-') {\n\t\t\t\tminus = true;\n\t\t\t\tc = readByte();\n\t\t\t}\n\t\t\tlong res = 0;\n\t\t\tdo {\n\t\t\t\tif (c < '0' || c > '9')\n\t\t\t\t\tthrow new InputMismatchException();\n\t\t\t\tres = res * 10 + c - '0';\n\t\t\t\tc = readByte();\n\t\t\t} while (!isSpaceChar(c));\n\t\t\treturn (minus) ? -res : res;\n\t\t}\n\n\t\tpublic double nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tpublic int[] nextIntArray(int n) {\n\t\t\tint[] a = new int[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextInt();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic long[] nextLongArray(int n) {\n\t\t\tlong[] a = new long[n];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\ta[i] = nextLong();\n\t\t\treturn a;\n\t\t}\n\n\t\tpublic char[][] nextCharMap(int n, int m) {\n\t\t\tchar[][] map = new char[n][m];\n\t\t\tfor (int i = 0; i < n; i++)\n\t\t\t\tmap[i] = next().toCharArray();\n\t\t\treturn map;\n\t\t}\n\t}\n}\n\n"
  },
  {
    "language": "Java",
    "code": "import java.io.PrintWriter;\nimport java.util.Scanner;\n\npublic class Main {\n\tstatic String[][] dp;\n\tstatic char[][] code;\n\tstatic int W;\n\tstatic int H;\n\tpublic static void main(String[] args) {\n\t\tsolve();\n\t}\n\n\tprivate static void solve() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tPrintWriter pr = new PrintWriter(System.out);\n\t\t\n\t\twhile (true) {\n\t\t\tW = sc.nextInt();\n\t\t\tH = sc.nextInt();\n\t\t\tif(W==0&&H==0) break;\n\t\t\tdp = new String[H][W];\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tdp[i][j] = \"-1\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tcode = new char[H][W];\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tString tmp = sc.next();\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tcode[i][j] = tmp.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tdinamic(i, j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tString maxtmp = \"0\";\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tif(dp[i][j].charAt(0)!='0'){\n\t\t\t\t\t\tmaxtmp = max(maxtmp,dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tpr.println(maxtmp);\n\t\t}\n\t\tpr.flush();\n\t\tsc.close();\n\t}\n\n\tprivate static String dinamic(int i, int j) {\n\t\tif(dp[i][j].equals(\"-1\")==false) return dp[i][j];\n\t\tif(code[i][j]<'0'||code[i][j]>'9'){\n\t\t\treturn dp[i][j];\n\t\t}else{\n\t\t\tString tmp1;\n\t\t\tString tmp2;\n\t\t\tif(i+1==H){\n\t\t\t\ttmp1 = \"-1\";\n\t\t\t}else{\n\t\t\t\ttmp1= dinamic(i+1,j);\n\t\t\t}\n\t\t\tif(j+1==W){\n\t\t\t\ttmp2 = \"-1\";\n\t\t\t}else{\n\t\t\t\ttmp2= dinamic(i,j+1);\n\t\t\t}\n\t\t\tif(tmp1.equals(\"-1\")==false){\n\t\t\t\ttmp1 = code[i][j]+tmp1;\n\t\t\t}\n\t\t\tif(tmp2.equals(\"-1\")==false){\n\t\t\t\ttmp2 = code[i][j]+tmp2;\n\t\t\t}\n\t\t\tif(tmp1.equals(\"-1\")&&tmp2.equals(\"-1\")){\n\t\t\t\treturn String.valueOf(code[i][j]);\n\t\t\t}\n\t\t\tdp[i][j] = max(tmp1, tmp2);\n\t\t\treturn dp[i][j];\n\t\t}\n\t}\n\n\tprivate static String max(String tmp1, String tmp2) {\n\t\tif(tmp1.equals(\"-1\")){\n\t\t\treturn tmp2;\n\t\t}\n\t\tif(tmp2.equals(\"-1\")){\n\t\t\treturn tmp1;\n\t\t}\n\t\tif(tmp1.length()>tmp2.length()){\n\t\t\treturn tmp1;\n\t\t}else if(tmp1.length()<tmp2.length()){\n\t\t\treturn tmp2;\n\t\t}else{\n\t\t\tfor(int k=0;k<tmp1.length();k++){\n\t\t\t\tif(tmp1.charAt(k)-'0'>tmp2.charAt(k)-'0'){\n\t\t\t\t\treturn tmp1;\n\t\t\t\t}else if(tmp1.charAt(k)-'0'<tmp2.charAt(k)-'0'){\n\t\t\t\t\treturn tmp2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.Arrays;\n\nimport static java.lang.Integer.parseInt;\n\n/**\n * The Secret Number\n */\npublic class Main {\n\n\tstatic final String EMPTY = \"\";\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line;\n\t\tString[] words;\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\n\t\t\tint W, H;\n\t\t\tW = parseInt(line.substring(0, line.indexOf(' ')));\n\t\t\tH = parseInt(line.substring(line.indexOf(' ') + 1));\n\t\t\tif ((W | H) == 0) break;\n\n\t\t\tchar[][] numc;\n\t\t\tString[][] nums;\n\n\t\t\tnumc = new char[H + 1][W + 1];\n\t\t\tnums = new String[H + 1][W + 1];\n\n\t\t\tfor (int i = 0; i < numc.length; i++) {\n\t\t\t\tArrays.fill(numc[i], 'X');\n\t\t\t}\n\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tline = br.readLine();\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tchar c = line.charAt(j);\n\t\t\t\t\tnumc[i][j] = (c <= '9' ? c : 'X');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//solve\n\t\t\tfor (int i = H - 1; i >= 0; i--) {\n\t\t\t\tfor (int j = W - 1; j >= 0; j--) {\n\t\t\t\t\tif (numc[i][j] != 'X') {\n\t\t\t\t\t\tString s1 = (numc[i + 1][j] != 'X' ? nums[i + 1][j] : EMPTY);\n\t\t\t\t\t\tString s2 = (numc[i][j + 1] != 'X' ? nums[i][j + 1] : EMPTY);\n\t\t\t\t\t\tnums[i][j] = numc[i][j] + large(s1, s2);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tString max = EMPTY;\n\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tif (numc[i][j] != 'X') {\n\t\t\t\t\t\tnums[i][j] = nums[i][j].replaceFirst(\"^0+\", EMPTY);\n\t\t\t\t\t\tmax = large(max, nums[i][j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tSystem.out.println(max);\n\n\t\t} //end while\n\n\t} //end main\n\n\tstatic String large(String s1, String s2) {\n\n\t\tif (s1.length() > s2.length()) return s1;\n\t\tif (s1.length() < s2.length()) return s2;\n\t\tif (s1.equals(s2)) return s1;\n\n\t\tString ret = EMPTY;\n\t\tfor (int i = 0; i < s1.length(); i++) {\n\t\t\tif (s1.charAt(i) > s2.charAt(i)) {\n\t\t\t\tret = s1;\n\t\t\t\tbreak;\n\t\t\t} else if (s1.charAt(i) < s2.charAt(i)) {\n\t\t\t\tret = s2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.util.regex.*;\n\nimport static java.lang.Math.*;\nimport static java.lang.System.out;\n\n// AOJ\npublic class Main {\n\tfinal Scanner sc=new Scanner(System.in);\n\tpublic static void main(String[] args) {\n\t\tnew Main().AOJ1126();\n\t}\n\tstatic class Point{\n\t\tint x, y;\n\t\tPoint(int x, int y){\tthis.x=x;\tthis.y=y;}\n\t\tPoint(){\tthis.x=0; this.y=0;}\n\t\t@Override public String toString(){\treturn \"(\"+this.x+\",\"+this.y+\")\";}\n\t\tstatic boolean ok(int x,int y,int X,int Y,int min){\n\t\t\treturn (min<=x&&x<X && min<=y&&y<Y)?true:false;\n\t\t}\n\t\tstatic boolean ok(int x,int y,int X,int Y){\treturn ok(x,y,X,Y,0);}\n\t}\n\tfinal int[] vx={0,1,0,-1}, vy={-1,0,1,0};\n\n\t\n\tvoid AOJ1126(){\n\t\t//int step=0;\n\t\twhile(sc.hasNext()){\n\t\t\tint W=sc.nextInt(), H=sc.nextInt();\n\t\t\tString ans=\"\";\n\t\t\tif((W|H)==0)\tbreak;\n\t\t\tchar[][] c=new char[W][H];\n\t\t\tString[][] close=new String[W][H];\n\t\t\tLinkedList<C1126> open=new LinkedList<C1126>();\n\t\t\tfor(int y=0; y<H; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<W; x++){\n\t\t\t\t\tc[x][y]=line.charAt(x);\n\t\t\t\t\tif(Character.isDigit(line.charAt(x))){\n\t\t\t\t\t\topen.add(new C1126(x,y,\"\"+c[x][y]));\n\t\t\t\t\t\tclose[x][y]=\"\"+c[x][y];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tC1126 now=open.poll();\n\t\t\t\t// TODO debug\n\t\t\t\t//out.println(\"ANS\"+ans+\" NOW\"+now.ans);\n\t\t\t\tans=now.compara(ans)?new String(now.ans):ans;\n\t\t\t\tfor(int i=1; i<3; i++){\n\t\t\t\t\tint xx=now.x+vx[i], yy=now.y+vy[i];\n\t\t\t\t\tif(!Point.ok(xx,yy,W,H))\tcontinue;\n\t\t\t\t\tif(Character.isDigit(c[xx][yy])){\n\t\t\t\t\t\tC1126 temp=new C1126(xx,yy,now.ans+c[xx][yy]);\n\t\t\t\t\t\tif(temp.compara(close[xx][yy])){\n\t\t\t\t\t\t\topen.add(temp);\n\t\t\t\t\t\t\tclose[xx][yy]=temp.ans;\n\t\t\t\t\t\t\t//step++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t\t//out.println(step+\"step\");\n\t}\n\tclass C1126{\n\t\tint x,y;\tString ans;\n\t\tC1126(int x,int y,String ans){\n\t\t\tthis.x=x;\tthis.y=y;\n\t\t\tif(ans.length()>0){\n\t\t\t\tint i=0;\n\t\t\t\twhile(ans.charAt(i)=='0'){\n\t\t\t\t\tif(++i>=ans.length()-1)\tbreak;\n\t\t\t\t\tans=ans.substring(i);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.ans=ans;\n\t\t}\n\t\t@Override public boolean equals(Object obj){\n\t\t\tif(this==obj)\treturn true;\n\t\t\tif(obj==null)\treturn false;\n\t\t\tif(!(obj instanceof C1126))  return false;\n\t\t\tC1126 oth=(C1126)obj;\n\t\t\tif(this.x==oth.x && this.y==oth.y && this.ans.equals(oth.ans))\treturn true;\n\t\t\treturn false;\n\t\t}\n\t\t@Override public int hashCode(){\n\t\t\treturn x+y+ans.hashCode();\n\t\t}\n\t\tboolean compara(String ans){\n\t\t\tif(this.ans.length()>ans.length())\treturn true;\n\t\t\tif(this.ans.length()==ans.length()){\n\t\t\t\tfor(int i=0; i<ans.length(); i++){\n\t\t\t\t\tif(ans.charAt(i)<this.ans.charAt(i))\treturn true;\n\t\t\t\t\tif(ans.charAt(i)>this.ans.charAt(i))\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n\t\n\tvoid AOJ0165(){\n\t\tfinal int MAX=1000000;\n\t\tboolean[] prime=Sieve(MAX);\n\t\t// 素数の個数の累積和を作る\n\t\twhile(sc.hasNext()){\n\t\t\tint N=sc.nextInt();\n\t\t\tif(N==0)\tbreak;\n\t\t\tint ans=0;\n\t\t\tfor(int i=1; i<=N; i++){\n\t\t\t\tint p=sc.nextInt(), m=sc.nextInt();\n\t\t\t\tint min=max(0,p-m), max=min(MAX, p+m);\n\t\t\t\tint temp=(min<=2?1:0);\n\t\t\t\tfor(int j=(min%2==0?min+1:min); j<=max; j+=2){\n\t\t\t\t\tif(prime[j])\ttemp++;\n\t\t\t\t}\n\t\t\t\t//out.println(\"TEMP\"+temp);\n\t\t\t\tans+=(temp==0?-1:temp-1);\n\t\t\t}\n\t\t\tout.println(max(0,ans));\n\t\t}\n\t}\n\t\n\tvoid AOJ1144(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(), Y=sc.nextInt();\n\t\t\tif((X|Y)==0)\tbreak;\n\t\t\tchar[][] c=new char[X][Y];\n\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\t\tc[x][y]=line.charAt(x);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\n\t// TODO 果樹園　RE　横型\n\tvoid AOJ0118(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(), Y=sc.nextInt(), ans=0;\n\t\t\tif((X|Y)==0)\tbreak;\n\t\t\tchar[][] c=new char[X+10][Y+10];\n\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\t\tc[x][y]=line.charAt(x);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\t\tif(c[x][y]=='&')\tcontinue;\n\t\t\t\t\tans++;\n\t\t\t\t\tLinkedList<Point> open=new LinkedList<Point>();\n\t\t\t\t\topen.add(new Point(x,y));\n\t\t\t\t\tchar mark=c[x][y];\n\t\t\t\t\twhile(!open.isEmpty()){\n\t\t\t\t\t\tPoint now=open.poll();\n\t\t\t\t\t\tc[now.x][now.y]='&';\n\t\t\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\t\t\tif(now.x+vx[i]<0 || now.x+vx[i]>=X || now.y+vy[i]<0 || now.y+vy[i]>=Y)\tcontinue;\n\t\t\t\t\t\t\tif(c[now.x+vx[i]][now.y+vy[i]]==mark){\n\t\t\t\t\t\t\t\t//out.println((now.x+vx[i])+\" \"+(now.y+vy[i]));\n\t\t\t\t\t\t\t\topen.add(new Point(now.x+vx[i],now.y+vy[i]));\n\t\t\t\t\t\t\t\tc[now.x+vx[i]][now.y+vy[i]]='&';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//out.println(\"ANS\"+ans);\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t}\n\t\n\t// Red and Black 横型探索\n\tvoid AOJ1130(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(), Y=sc.nextInt(),sx=0,sy=0,ans=0;\n\t\t\tif(X==0)\tbreak;\n\t\t\tchar[][] c=new char[X][Y];\n\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\tchar[] line=sc.next().toCharArray();\n\t\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\t\tc[x][y]=line[x];\n\t\t\t\t\tif(line[x]=='@'){\n\t\t\t\t\t\tsx=x;\tsy=y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tLinkedList<Point> open=new LinkedList<Point>();\n\t\t\topen.add(new Point(sx,sy));\n\t\t\tboolean[][] close=new boolean[X][Y];\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tans++;\n\t\t\t\tPoint now=open.poll();\n\t\t\t\tclose[now.x][now.y]=true;\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(now.x+vx[i]<0 || now.x+vx[i]>=X || now.y+vy[i]<0 || now.y+vy[i]>=Y)\tcontinue;\n\t\t\t\t\tif(c[now.x+vx[i]][now.y+vy[i]]=='.' && !close[now.x+vx[i]][now.y+vy[i]]){\n\t\t\t\t\t\topen.add(new Point(now.x+vx[i], now.y+vy[i]));\n\t\t\t\t\t\tclose[now.x+vx[i]][now.y+vy[i]]=true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t}\n\t\n\t// TODO デパート　TLE MLE WA\n\tvoid AOJ0223(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(),\tY=sc.nextInt();\n\t\t\tif(X==0)\tbreak;\n\t\t\tint tx=sc.nextInt(), ty=sc.nextInt(), kx=sc.nextInt(), ky=sc.nextInt();\n\t\t\tint[][] b=new int[X+1][Y+1];\n\t\t\tfor(int y=1; y<=Y; y++){\n\t\t\t\tfor(int x=1; x<=X; x++)\tb[x][y]=sc.nextInt();\n\t\t\t}\n\t\t\tLinkedList<C0223> open=new LinkedList<C0223>();\n\t\t\topen.add(new C0223(tx,ty,kx,ky,0));\n\t\t\tint[][][][] close2=new int[X+1][Y+1][X+1][Y+1];\n\t\t\tclose2[tx][ty][kx][ky]=-1;\n\t\t\tint ans=-1;\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tC0223 now=open.poll();\n\t\t\t\tif(now.ans()){\n\t\t\t\t\tans=now.sec;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(now.sec>=99)\tbreak;\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(0<now.tx+vx[i]&&now.tx+vx[i]<=X && 0<now.ty+vy[i]&&now.ty+vy[i]<=Y && 0<now.kx-vx[i]&&now.kx-vx[i]<=X && 0<now.ky-vy[i]&&now.ky-vy[i]<=Y){\n\t\t\t\t\t\ttx=now.tx;\tty=now.ty;\tkx=now.kx;\tky=now.ky;\n\t\t\t\t\t\tif(b[tx+vx[i]][ty+vy[i]]==0){\n\t\t\t\t\t\t\ttx+=vx[i];\tty+=vy[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(b[kx-vx[i]][ky-vy[i]]==0){\n\t\t\t\t\t\t\tkx-=vx[i];\tky-=vy[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//out.println(\"TEMP:\"+tx+\" \"+ty+\" \"+kx+\" \"+ky);\n\t\t\t\t\t\t//if(tx==kx && ty==ky)\tans=ans<0?now.sec+1:min(ans,now.sec+1);\n\t\t\t\t\t\tif(close2[tx][ty][kx][ky]==0 || close2[tx][ty][kx][ky]>now.sec+1){\n\t\t\t\t\t\t\t//out.println(\"ADD:\"+tx+\" \"+ty+\" \"+kx+\" \"+ky);\n\t\t\t\t\t\t\topen.add(new C0223(tx,ty,kx,ky,now.sec+1));\n\t\t\t\t\t\t\tclose2[tx][ty][kx][ky]=now.sec+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans<0? \"NA\": ans);\n\t\t}\n\t}\n\tclass C0223{\n\t\tint tx,ty,kx,ky,sec;\n\t\tC0223(int tx, int ty, int kx, int ky, int sec){\n\t\t\tthis.tx=tx;\tthis.ty=ty;\tthis.kx=kx;\tthis.ky=ky;\tthis.sec=sec;\n\t\t}\n\t\tboolean ans(){\n\t\t\tif(this.tx==this.kx && this.ty==this.ky)\treturn true;\n\t\t\telse\treturn false;\n\t\t}\n\t}\n\t\n\t\n\t// TODO WA\n\tvoid AOJ0142(){\n\t\twhile(sc.hasNext()){\n\t\t\tint n=sc.nextInt();\n\t\t\tif(n==0)\tbreak;\n\t\t\tint nn=(n-1)/2;\n\t\t\tboolean[] b=new boolean[n];\n\t\t\tfor(int i=1; i<n; i++)\tb[(i*i)%n]=true;\n\t\t\tArrayList<Integer> ar=new ArrayList<Integer>();\n\t\t\tfor(int i=1; i<n; i++){\n\t\t\t\tif(b[i])\tar.add(i);\n\t\t\t}\n\t\t\tint[] ans=new int[nn+1];\n\t\t\tfor(int i=0; i<ar.size(); i++){\n\t\t\t\tfor(int j=0; j<ar.size(); j++){\n\t\t\t\t\tif(i==j)\tcontinue;\n\t\t\t\t\tint temp=ar.get(i)-ar.get(j);\n\t\t\t\t\ttemp+= temp<0? n:0;\n\t\t\t\t\ttemp= temp>nn? n-temp: temp;\n\t\t\t\t\tans[temp]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=1; i<=nn; i++)\tout.println(ans[i]);\n\t\t}\n\t}\n\t\n\t\n\t// TODO レゴ　WA\n\tvoid AOJ0207(){\n\t\twhile(sc.hasNext()){\n\t\t\tint w=sc.nextInt(), h=sc.nextInt();\n\t\t\tif(w==0)\tbreak;\n\t\t\tint sx=sc.nextInt(), sy=sc.nextInt(), gx=sc.nextInt(), gy=sc.nextInt(), n=sc.nextInt();\n\t\t\tint[][] b=new int[w+2][h+2];\n\t\t\tfor(int i=0; i<n; i++){\n\t\t\t\tint color=sc.nextInt(), d=sc.nextInt(), x=sc.nextInt(), y=sc.nextInt();\n\t\t\t\tif(d==0){\t// 横 4x2\n\t\t\t\t\tfor(int j=y; j<y+2; j++){\n\t\t\t\t\t\tfor(int k=x; k<x+4; k++)\tb[k][j]=color;\n\t\t\t\t\t}\n\t\t\t\t}else{\t// 縦 2x4\n\t\t\t\t\tfor(int j=y; j<y+4; j++){\n\t\t\t\t\t\tfor(int k=x; k<x+2; k++)\tb[k][j]=color;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//debug\n\t\t\t//de0207(b,w,h);\n\t\t\tint[] vx={1,0,-1,0}, vy={0,1,0,-1};\n\t\t\tint xx=sx, yy=sy, cc=b[sx][sy], v=0, count=0, max=w*h;\n\t\t\tif(cc<1){\n\t\t\t\tout.println(\"NG\");\n\t\t\t\tSystem.exit(0);\n\t\t\t}\n\t\t\twhile(true){\n\t\t\t\tif(xx==gx && yy==gy && b[xx][yy]==cc){\n\t\t\t\t\tout.println(\"OK\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcount++;\n\t\t\t\tif(count>=max){\n\t\t\t\t\tout.println(\"NG\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t//b[xx][yy]=6;\n\t\t\t\tboolean flag=false;\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(b[xx+vx[i]][yy+vy[i]]==cc){\n\t\t\t\t\t\txx+=vx[i];\tyy+=vy[i];\tv=i;\n\t\t\t\t\t\tflag=true;\n\t\t\t\t\t\tout.println(\"X\"+xx+\" Y\"+yy);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(flag)\tcontinue;\n\t\t\t\txx-=vx[v];\tyy-=vy[v];\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(b[xx+vx[i]][yy+vy[i]]==cc){\n\t\t\t\t\t\txx+=vx[i];\tyy+=vy[i];\tv=i;\n\t\t\t\t\t\tflag=true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(flag)\tcontinue;\n\t\t\t\tout.println(\"END : X\"+xx+\" Y\"+yy);\n\t\t\t\tout.println(\"NG\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t//debug\n\t\t\tde0207(b,w,h);\n\t\t}\n\t}\n\tvoid de0207(int[][] b, int w, int h){\n\t\tfor(int j=0; j<=h; j++){\n\t\t\tfor(int i=0; i<=w; i++)\tout.print(b[i][j]+\" \");\n\t\t\tout.println();\n\t\t}\n\t\tfor(int i=0; i<=w; i++)\tout.print(\"-\");\n\t\tout.println();\n\t}\n\t\n\tvoid AOJ0139(){\n\t\tint N=sc.nextInt();\n\t\tfinal Pattern ap=Pattern.compile(\"^>'(=+)#(=+)~$\");\n\t\tfor(int i=1; i<=N; i++){\n\t\t\tString s=sc.next();\n\t\t\tMatcher m=ap.matcher(s);\n\t\t\tif(m.matches()){\n\t\t\t\tif(m.group(1).length()==m.group(2).length()){\n\t\t\t\t\tout.println(\"A\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}else if(Pattern.compile(\"^>\\\\^(Q=)+~~$\").matcher(s).matches()){\n\t\t\t\tout.println(\"B\");\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tout.println(\"NA\");\n\t\t}\n\t}\n\t\n\tArrayList<Integer> Sieve2(int N){\n\t\tArrayList<Integer> prime = new ArrayList<Integer>();\n\t\tboolean[] list = new boolean[N+1];\n\t\tArrays.fill(list, true);\n\t\tlist[1]=false;\n\t\tfor (int i=2; i<=N; i++) {\n\t\t\tif(list[i]) {\n\t\t\t\tprime.add(i);\n\t\t\t\tfor (int j=i+i; j<=N; j+=i)\tlist[j] = false;\n\t\t\t}\n\t\t}\n\t\treturn prime;\n\t}\n\n\tboolean[] Sieve(int N){\n\t\tboolean[] list = new boolean[N+1];\n\t\tArrays.fill(list, true);\n\t\tlist[0]=false;\tlist[1]=false;\n\t\tfor(int j=4; j<=N; j+=2)\tlist[j]=false;\n\t\tfor(int i=3; i*i<=N; i+=2) {\n\t\t\tif(list[i]) {\n\t\t\t\tfor (int j=i+i; j<=N; j+=i)\tlist[j] = false;\n\t\t\t}\n\t\t}\n\t\treturn list;\n\t}\n\t\n\tboolean isPrime(int n){\n\t\tfor(int i=2; i*i<=n; i++){\n\t\t\tif(n%i==0)     return false;\n\t\t}\n\t\treturn true;\n\t}\n\t\n\tint gcd(int x, int y){\n\t\tif(y==0)\treturn x;\n\t\telse\treturn gcd(y, x%y);\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.util.*;\n\nimport static java.lang.Integer.parseInt;\n\n/**\n * The Secret Number\n */\npublic class Main {\n\n\tstatic char[][] seq;\n\tstatic SortedMap<Integer, SortedSet<String>> num;\n\n\tpublic static void main(String[] args) throws IOException {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\tString line;\n\t\tString[] words;\n\n\t\twhile ((line = br.readLine()) != null && !line.isEmpty()) {\n\n\t\t\tint W, H;\n\t\t\tW = parseInt(line.substring(0, line.indexOf(' ')));\n\t\t\tH = parseInt(line.substring(line.indexOf(' ') + 1));\n\t\t\tif ((W | H) == 0) break;\n\n\t\t\tseq = new char[H + 2][W + 2];\n\n\t\t\tfor (int i = 0; i < seq.length; i++) {\n\t\t\t\tArrays.fill(seq[i], 'X');\n\t\t\t}\n\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tline = br.readLine();\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tchar c = line.charAt(j);\n\t\t\t\t\tseq[i + 1][j + 1] = (c > '9' ? 'X' : c);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tnum = new TreeMap<>();\n\t\t\tchar[] buf = new char[H + W - 1];\n\n\t\t\tfor (int i = 1; i <= H; i++) {\n\t\t\t\tfor (int j = 1; j <= W; j++) {\n\t\t\t\t\tif (seq[i][j] != 'X'\n\t\t\t\t\t\t\t&& seq[i - 1][j] == 'X'\n\t\t\t\t\t\t\t&& seq[i][j - 1] == 'X') {\n\t\t\t\t\t\tdfs(new int[]{i, j}, 0, buf.clone());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(num.get(num.lastKey()).last());\n\n\t\t} //end while\n\t} //end main\n\n\tstatic void dfs(int[] p, int i, char[] buf) {\n\t\tif (seq[p[0]][p[1]] == 'X') {\n\t\t\tnum.putIfAbsent(i, new TreeSet<>());\n\t\t\tnum.get(i).add(String.valueOf(buf, 0, i));\n\t\t\treturn;\n\t\t}\n\t\t//\n\t\tif (i == 0 && seq[p[0]][p[1]] == '0') {\n\t\t\ti--;\n\t\t} else {\n\t\t\tbuf[i] = seq[p[0]][p[1]];\n\t\t}\n\t\tif (seq[p[0] + 1][p[1] - 1] == 'X') {\n\t\t\tdfs(new int[]{p[0] + 1, p[1]}, i + 1, buf.clone());\n\t\t}\n\t\tif (seq[p[0] - 1][p[1] + 1] == 'X') {\n\t\t\tdfs(new int[]{p[0], p[1] + 1}, i + 1, buf.clone());\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.PrintWriter;\nimport java.util.Scanner;\n\npublic class Main {\n\tstatic String[][] dp;\n\tstatic char[][] code;\n\tstatic int W;\n\tstatic int H;\n\tpublic static void main(String[] args) {\n\t\tsolve();\n\t}\n\n\tprivate static void solve() {\n\t\tScanner sc = new Scanner(System.in);\n\t\tPrintWriter pr = new PrintWriter(System.out);\n\t\t\n\t\twhile (true) {\n\t\t\tW = sc.nextInt();\n\t\t\tH = sc.nextInt();\n\t\t\tif(W==0&&H==0) break;\n\t\t\tdp = new String[H][W];\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tdp[i][j] = \"-1\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tcode = new char[H][W];\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tString tmp = sc.next();\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tcode[i][j] = tmp.charAt(j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tdinamic(i, j);\n\t\t\t\t}\n\t\t\t}\n\t\t\tString maxtmp = \"0\";\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tif(dp[i][j].charAt(0)!='0'){\n\t\t\t\t\t\tmaxtmp = max(maxtmp,dp[i][j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tpr.println(maxtmp);\n\t\t}\n\t\tpr.flush();\n\t\tsc.close();\n\t}\n\n\tprivate static String dinamic(int i, int j) {\n\t\tif(dp[i][j].equals(\"-1\")==false) return dp[i][j];\n\t\tif(code[i][j]<'0'||code[i][j]>'9'){\n\t\t\treturn dp[i][j];\n\t\t}else{\n\t\t\tString tmp1;\n\t\t\tString tmp2;\n\t\t\tif(i+1==H){\n\t\t\t\ttmp1 = \"-1\";\n\t\t\t}else{\n\t\t\t\ttmp1= dinamic(i+1,j);\n\t\t\t}\n\t\t\tif(j+1==W){\n\t\t\t\ttmp2 = \"-1\";\n\t\t\t}else{\n\t\t\t\ttmp2= dinamic(i,j+1);\n\t\t\t}\n\t\t\tif(tmp1.equals(\"-1\")==false){\n\t\t\t\ttmp1 = code[i][j]+tmp1;\n\t\t\t}\n\t\t\tif(tmp2.equals(\"-1\")==false){\n\t\t\t\ttmp2 = code[i][j]+tmp2;\n\t\t\t}\n\t\t\tif(tmp1.equals(\"-1\")&&tmp2.equals(\"-1\")){\n\t\t\t\treturn String.valueOf(code[i][j]);\n\t\t\t}\n\t\t\tdp[i][j] = max(tmp1, tmp2);\n\t\t\treturn dp[i][j];\n\t\t}\n\t}\n\n\tprivate static String max(String tmp1, String tmp2) {\n\t\tif(tmp1.equals(\"-1\")){\n\t\t\treturn tmp2;\n\t\t}\n\t\tif(tmp2.equals(\"-1\")){\n\t\t\treturn tmp1;\n\t\t}\n\t\tif(tmp1.length()>tmp2.length()){\n\t\t\treturn tmp1;\n\t\t}else if(tmp1.length()<tmp2.length()){\n\t\t\treturn tmp2;\n\t\t}else{\n\t\t\tfor(int k=0;k<tmp1.length();k++){\n\t\t\t\tif(tmp1.charAt(k)-'0'>tmp2.charAt(k)-'0'){\n\t\t\t\t\treturn tmp1;\n\t\t\t\t}else if(tmp1.charAt(k)-'0'<tmp2.charAt(k)-'0'){\n\t\t\t\t\treturn tmp2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn tmp1;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\n\npublic class Main {\n\n\tstatic int[][] field;\n\tstatic String[][] dp;\n\tstatic int h,w;\n\tpublic static void main(String[] args) {\n\t\tScanner cin = new Scanner(System.in);\n\t\twhile(true){\n\t\t\tw = cin.nextInt();\n\t\t\th = cin.nextInt();\n\t\t\tif(w+h==0)break;\n\t\t\tfield=new int[h][w];\n\t\t\tdp=new String[h][w];\n\t\t\tfor(int i = 0;i<h;i++){\n\t\t\t\tString s = cin.next();\n\t\t\t\tfor(int j = 0;j<w;j++){\n\t\t\t\t\tdp[i][j]=\"\";\n\t\t\t\t\tif(Character.isDigit(s.charAt(j))){\n\t\t\t\t\t\tfield[i][j]=s.charAt(j)-'0';\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tfield[i][j]=-1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0;i<w;i++){\n\t\t\t\tif(field[0][i]<=0){\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tdp[0][i]=\"\"+field[0][i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0;i<h;i++){\n\t\t\t\tif(field[i][0]<=0){\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tdp[i][0]=\"\"+field[i][0];\n\t\t\t\t}\n\t\t\t}\n\t\t\tString ans=\"0\";\n\t\t\tfor(int i = 1;i<h;i++){\n\t\t\t\tfor(int j = 1;j<w;j++){\n\t\t\t\t\tif(field[i][j]==-1)continue;\n\t\t\t\t\tString s1=dp[i-1][j]+field[i][j];\n\t\t\t\t\tString s2=dp[i][j-1]+field[i][j];\n\t\t\t\t\tString s3=field[i][j]+\"\";\n\t\t\t\t\tif(big(s1,s2)>=0){\n\t\t\t\t\t\tif(big(s1,s3)>=0){\n\t\t\t\t\t\t\tdp[i][j]=s1;\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[i][j]=s3;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tif(big(s2,s3)>=0){\n\t\t\t\t\t\t\tdp[i][j]=s2;\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tdp[i][j]=s3;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\twhile(dp[i][j].charAt(0)=='0'){\n\t\t\t\t\t\tdp[i][j]=dp[i][j].substring(1,dp[i][j].length());\n\t\t\t\t\t}\n\t\t\t\t\tif(big(dp[i][j],ans)>0){\n\t\t\t\t\t\tans=dp[i][j];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//output();\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t\t\n\t}\n\tstatic int big(String s1,String s2){\n\t\tif(s1.length()==s2.length()){\n\t\t\treturn s1.compareTo(s2);\n\t\t}\n\t\treturn s1.length()-s2.length();\n\t}\n\tstatic void output(){\n\t\tfor(int i = 0;i<h;i++){\n\t\t\tfor(int j = 0;j<w;j++){\n\t\t\t\tSystem.out.print(dp[i][j]+\" \");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\t\t\n\t\tSystem.out.println();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\nimport java.util.Arrays;\n\npublic class Main{\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tint[][] map = new int[70][70];\n\t\tint w, h;\n\t\tString temp;\n\t\twhile(true){\n\t\t\tw = sc.nextInt();\n\t\t\th = sc.nextInt();\n\t\t\tif(w==0 && h==0) break;\n\n\t\t\tfor(int i=0; i<h; i++){\n\t\t\t\ttemp = sc.next();\n\t\t\t\tArrays.fill(map[i], -1);\n\t\t\t\tfor(int j=0; j<w; j++){\n\t\t\t\t\tif(temp.charAt(j)>='0' && temp.charAt(j)<='9'){\n\t\t\t\t\t\tmap[i][j] = temp.charAt(j) - '0';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tArrays.fill(map[h], -1);\n\n\t\t\tString sum = \"\", max = \"\";\n\t\t\tfor(int i=0; i<h; i++){\n\t\t\t\tfor(int j=0; j<w; j++){\n\t\t\t\t\tif(map[i][j]>0 && map[i][j]<10){\n\t\t\t\t\t\tsum = dfs(map, i, j);\n\n\t\t\t\t\t\tif(max.length() < sum.length()){\n\t\t\t\t\t\t\tmax = sum;\n\t\t\t\t\t\t}else if(max.length()==sum.length()){\n\t\t\t\t\t\t\tfor(int n=0; n<max.length(); n++){\n\t\t\t\t\t\t\t\tif(max.charAt(n)<sum.charAt(n)){\n\t\t\t\t\t\t\t\t\tmax = sum;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}else if(max.charAt(n)>sum.charAt(n)){\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tSystem.out.println(max);\n\t\t}\n\t}\n\n\tstatic public String dfs(int[][] map, int i, int j){\n\t\tString s1, s2;\n\t\ts1 = String.valueOf(map[i][j]%10);\n\t\ts2 = s1;\n\t\tmap[i][j] += 10;\n\n\t\tif(map[i+1][j]!=-1){\n\t\t\ts1 += dfs(map, i+1, j);\n\t\t}\n\t\tif(map[i][j+1]!=-1){\n\t\t\ts2 += dfs(map, i, j+1);\n\t\t}\n\n\t\tif(s1.length() < s2.length()){\n\t\t\treturn s2;\n\t\t}else if(s1.length()==s2.length()){\n\t\t\tfor(int n=0; n<s1.length(); n++){\n\t\t\t\tif(s1.charAt(n)<s2.charAt(n)){\n\t\t\t\t\treturn s2;\n\t\t\t\t}else if(s1.charAt(n)>s2.charAt(n)){\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn s1;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.Arrays;\nimport java.util.LinkedList;\nimport java.util.Queue;\nimport java.util.Scanner;\n\npublic class Main {\n\tMyScanner sc = new MyScanner();\n\tScanner sc2 = new Scanner(System.in);\n\tint mod = 1000000007;\n\n\tint[] dx = { 1, 0 };\n\tint[] dy = { 0, 1 };\n\n\tvoid run() {\n\t\tfor (;;) {\n\t\t\tint W = sc.nextInt();\n\t\t\tint H = sc.nextInt();\n\t\t\tif ((W | H) == 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tchar[][] field = new char[H][W];\n\t\t\tBigInteger[][] maxHist = new BigInteger[H][W];\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tString input = sc.next();\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tfield[i][j] = input.charAt(j);\n\t\t\t\t\tmaxHist[i][j] = new BigInteger(\"0\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int i = 0; i < W; i++) {\n\t\t\t\tif (Character.isDigit(field[0][i])) {\n\t\t\t\t\tif (i - 1 >= 0 && Character.isDigit(field[0][i - 1])) {\n\t\t\t\t\t\tmaxHist[0][i] = new BigInteger(maxHist[0][i - 1] + \"\"\n\t\t\t\t\t\t\t\t+ field[0][i]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmaxHist[0][i] = new BigInteger(field[0][i] + \"\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tif (Character.isDigit(field[i][0])) {\n\t\t\t\t\tif (i - 1 >= 0 && Character.isDigit(field[i - 1][0])) {\n\t\t\t\t\t\tmaxHist[i][0] = new BigInteger(maxHist[i - 1][0] + \"\"\n\t\t\t\t\t\t\t\t+ field[i][0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmaxHist[i][0] = new BigInteger(field[i][0] + \"\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int i = 1; i < H; i++) {\n\t\t\t\tfor (int j = 1; j < W; j++) {\n\t\t\t\t\tif (!Character.isDigit(field[i][j])) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (Character.isDigit(field[i - 1][j])\n\t\t\t\t\t\t\t&& !Character.isDigit(field[i][j - 1])) {\n\t\t\t\t\t\tmaxHist[i][j] = new BigInteger(maxHist[i - 1][j] + \"\"\n\t\t\t\t\t\t\t\t+ field[i][j]);\n\t\t\t\t\t} else if (!Character.isDigit(field[i - 1][j])\n\t\t\t\t\t\t\t&& Character.isDigit(field[i][j - 1])) {\n\t\t\t\t\t\tmaxHist[i][j] = new BigInteger(maxHist[i][j - 1] + \"\"\n\t\t\t\t\t\t\t\t+ field[i][j]);\n\t\t\t\t\t} else if (Character.isDigit(field[i - 1][j])\n\t\t\t\t\t\t\t&& Character.isDigit(field[i][j - 1])) {\n\t\t\t\t\t\tBigInteger tmp = maxHist[i][j - 1]\n\t\t\t\t\t\t\t\t.max(maxHist[i - 1][j]);\n\t\t\t\t\t\tmaxHist[i][j] = new BigInteger(tmp + \"\" + field[i][j]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmaxHist[i][j] = new BigInteger(field[i][j] + \"\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tBigInteger ans = new BigInteger(\"0\");\n\t\t\tfor (int i = 0; i < H; i++) {\n\t\t\t\tfor (int j = 0; j < W; j++) {\n\t\t\t\t\tans = ans.max(maxHist[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tSystem.out.println(ans);\n\t\t}\n\t}\n\n\tclass Point {\n\t\tint w;\n\t\tint h;\n\t\tString number;\n\n\t\t/**\n\t\t * @param w\n\t\t * @param h\n\t\t */\n\t\tpublic Point(int w, int h, String number) {\n\t\t\tsuper();\n\t\t\tthis.w = w;\n\t\t\tthis.h = h;\n\t\t\tthis.number = number;\n\t\t}\n\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n\n\tvoid debug(Object... o) {\n\t\tSystem.out.println(Arrays.deepToString(o));\n\t}\n\n\tvoid debug2(BigInteger[][] array) {\n\t\tfor (int i = 0; i < array.length; i++) {\n\t\t\tfor (int j = 0; j < array[i].length; j++) {\n\t\t\t\tSystem.out.print(array[i][j] + \"            \");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tclass MyScanner {\n\t\tint nextInt() {\n\t\t\ttry {\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (c != '-' && (c < '0' || '9' < c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tif (c == '-')\n\t\t\t\t\treturn -nextInt();\n\t\t\t\tint res = 0;\n\t\t\t\tdo {\n\t\t\t\t\tres *= 10;\n\t\t\t\t\tres += c - '0';\n\t\t\t\t\tc = System.in.read();\n\t\t\t\t} while ('0' <= c && c <= '9');\n\t\t\t\treturn res;\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tdouble nextDouble() {\n\t\t\treturn Double.parseDouble(next());\n\t\t}\n\n\t\tString next() {\n\t\t\ttry {\n\t\t\t\tStringBuilder res = new StringBuilder(\"\");\n\t\t\t\tint c = System.in.read();\n\t\t\t\twhile (Character.isWhitespace(c))\n\t\t\t\t\tc = System.in.read();\n\t\t\t\tdo {\n\t\t\t\t\tres.append((char) c);\n\t\t\t\t} while (!Character.isWhitespace(c = System.in.read()));\n\t\t\t\treturn res.toString();\n\t\t\t} catch (Exception e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.ArrayList;\nimport java.util.Scanner;\n\npublic class Main {\n\n\tScanner sc = new Scanner(System.in);\n\tpublic void run() {\n\t\twhile(sc.hasNext()){\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tsc.nextLine();\n\t\t\tif(w == 0 && h == 0)break;\n\t\t\telse calc(w, h);\n\t\t\t\n\t\t}\n\t}\n\tpublic void calc(int w, int h){\n\t\tString[][] matrix = new String[h][w];\n\t\tfor(int i = 0; i < h; i++){\n\t\t\tString line = sc.nextLine();\n\t\t\tfor(int j = 0; j < w; j++){\n\t\t\t\tString c = line.substring(j, j+1);\n\t\t\t\tmatrix[i][j] = c;\n\t\t\t}\n\t\t}\n\t\tnum = new String[h][w];\n\t\tString max = \"0\";\n\t\tfor(int i = 0; i < w; i++){\n\t\t\tfor(int j = 0; j < h; j++){\n\t\t\t\tif(num[j][i] == null) numCalc(matrix, i, j, w, h);\n\t\t\t\tmax = compare(num[j][i] , max);\n\t\t\t}\n\t\t}\n\t\tSystem.out.println(retNum(max));\n\t}\n\tString[][] num;\n\tpublic String retNum(String t){\n\t\tint size = t.length();\n\t\tfor(int i = 0; i < size - 1; i++){\n\t\t\tif(t.charAt(0) == '0') t = t.substring(1);\n\t\t\telse break;\n\t\t}\n\t\treturn t;\n\t}\n\t\n\tpublic String compare(String i, String j){\n\t\tif(i.length() > j.length()){\n\t\t\tint t = i.length() - j.length();\n\t\t\tfor(int k = 0; k < t; k++){\n\t\t\t\tj = \"0\" + j;\n\t\t\t}\n\t\t}\n\t\telse if(i.length() < j.length()){\n\t\t\tint t = j.length() - i.length();\n\t\t\tfor(int k = 0; k < t; k++){\n\t\t\t\ti = \"0\" + i;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(i.compareTo(j) < 0) return j;\n\t\telse return i;\n\t}\n\tpublic String numCalc(String[][] matrix, int x, int y, int w, int h){\n\t\tif(num[y][x] != null) return num[y][x];\n\t\telse{\n\t\t\tString c = matrix[y][x];\n\t\t\tif(c.equals(\"0\") || c.equals(\"1\") || c.equals(\"2\") || c.equals(\"3\") || c.equals(\"4\")\n\t\t\t\t\t|| c.equals(\"5\") || c.equals(\"6\") || c.equals(\"7\") || c.equals(\"8\") || c.equals(\"9\")){\n\t\t\t\tString a1 = null;\n\t\t\t\tif(x < w-1 && num[y][x+1] == null) {\n\t\t\t\t\tString t = numCalc(matrix, x+1, y, w, h);\n\t\t\t\t\tif(!t.equals(\"-1\")) a1 = c + t;\n\t\t\t\t}\n\t\t\t\telse if(x < w-1 && !(num[y][x+1].equals(\"-1\"))) a1 = c + num[y][x+1];\n\t\t\t\tString a2 = null;\n\t\t\t\tif(y < h-1 && num[y+1][x] == null) {\n\t\t\t\t\tString t = numCalc(matrix, x, y+1, w, h);\n\t\t\t\t\tif(!t.equals(\"-1\")) a2 = c + t;\n\t\t\t\t}\n\t\t\t\telse if(y < h-1 && !(num[y+1][x].equals(\"-1\"))) a2 = c + num[y+1][x];\n\t\t\t\t\n\t\t\t\tif(a1 != null && a2 != null){\n\t\t\t\t\tnum[y][x] = compare(a1, a2);\n\t\t\t\t}\n\t\t\t\telse if(a1 == null && a2 == null) num[y][x] = c;\n\t\t\t\telse if(a1 == null) num[y][x] = a2;\n\t\t\t\telse num[y][x] = a1;\n\t\t\t}\n\t\t\telse num[y][x] = \"-1\";\n\t\t\treturn num[y][x];\n\t\t}\n\t}\n\n\t\n\tpublic static void main(String[] args) {\n\t\tnew Main().run();\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.*;\nimport java.util.*;\n\n\npublic class Main {\n\tstatic ArrayList<String> cand = new ArrayList<String>();\n\tpublic static void main(String[] args) {\n\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));       \n\t\ttry {\n\t\t\tString line;\n\t\t\twhile(true){\n\t\t\t\t/* input */\n\t\t\t\tcand = new ArrayList<String>();\n\t\t\t\tline = br.readLine();\n\n\t\t\t\tint w = Integer.parseInt(line.split(\" \")[0]);\n\t\t\t\tint h = Integer.parseInt(line.split(\" \")[1]);\n\t\t\t\tif(w == 0 && h == 0){\n\t\t\t\t\treturn;\n\t\t\t\t} \n\n\t\t\t\tchar[][] field = new char[h][w];\n\t\t\t\tfor(int i=0;i<h;i++){\n\t\t\t\t\tline = br.readLine();\n\t\t\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\t\t\tfield[i][j] = line.charAt(j);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t/* processing */\n\t\t\t\tfor(int i=0;i<h;i++){\n\t\t\t\t\tfor(int j=0;j<w;j++){\n\t\t\t\t\t\tif(Character.isDigit(field[i][j])&&(field[i][j]!='0')){\n\t\t\t\t\t\t\t\tsearch(i,j,field,h,w,\"\"+field[i][j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/* output */\n\t\t\t\tCollections.sort(cand);\n\t\t\t\tint maxlength = 0;\n\t\t\t\tString maxs = \"\";\n\t\t\t\tfor(String s: cand){\n\t\t\t\t\tif (s.length()>maxlength){\n\t\t\t\t\t\tmaxlength = s.length();\n\t\t\t\t\t\tmaxs = s;\n\t\t\t\t\t} else if(s.length()==maxlength){\n\t\t\t\t\t\tfor(int i=0;i<s.length();i++){\n\t\t\t\t\t\t\tif(s.charAt(i)>maxs.charAt(i)){\n\t\t\t\t\t\t\t\tmaxs = s;\n\t\t\t\t\t\t\t} else if(s.charAt(i)>maxs.charAt(i)){\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//System.out.println();\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tSystem.out.println(maxs);\n\t\t\t}\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\n\tpublic static void search(int i,int j,char[][] field,int h,int w, String s){\n\t\tboolean r = true, d = true;\n\t\tif(j<w-1){\n\t\t\tif(Character.isDigit(field[i][j+1])){\n\t\t\t\t//cand.add(s + field[i][j+1]);\n\t\t\t\tsearch(i,j+1,field,h,w,s + field[i][j+1]);\n\t\t\t\tr = false;\n\t\t\t}\n\t\t}\n\n\t\tif(i<h-1){\n\t\t\tif(Character.isDigit(field[i+1][j])){\n\t\t\t\t\t//cand.add(s + field[i+1][j]);\n\t\t\t\tsearch(i+1,j,field,h,w,s + field[i+1][j]);\n\t\t\t\td = false;\n\t\t\t}\n\t\t}\n\t\tif(r&&d){\n\t\t\tcand.add(s);\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.io.BufferedReader;\nimport java.io.InputStreamReader;\nimport java.math.BigInteger;\n\nclass Main{\n\tstatic char tiles[][];\n\tstatic String dstrs[][];\n\tstatic String max_str;\n\n\tpublic static void main(String args[]){\n\t\ttry{\n\t\t\tBufferedReader br = new BufferedReader(new InputStreamReader(System.in));\n\t\t\twhile(true){\n\t\t\t\t// 縦と横を取得\n\t\t\t\tString strs[] = br.readLine().split(\" \");\n\t\t\t\tint w = Integer.parseInt(strs[0]);\n\t\t\t\tif(w == 0) return;\n\t\t\t\tint h = Integer.parseInt(strs[1]);\n\t\t\t\tmax_str = \"0\";\n\n\n\t\t\t\t// 配列を初期化\n\t\t\t\ttiles = new char[h][w];\n\t\t\t\tdstrs = new String[h][w];\n\t\t\t\t//System.out.println(h + \" \" + w);\n\n\t\t\t\t// 入力を配列に詰めていく\n\t\t\t\tfor(int y = 0; y < h; y++){\n\t\t\t\t\tString str = br.readLine();\n\t\t\t\t\tfor(int x = 0; x < w; x++){\n\t\t\t\t\t\ttiles[y][x] = str.charAt(x);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//printMatrix(tiles);\n\n\t\t\t\tfor(int y = 0; y < h; y++){\n\t\t\t\t\tfor(int x = 0; x < w; x++){\n\t\t\t\t\t\tdp(x, y);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//printMatrix(dstrs);\n\t\t\t\tSystem.out.println(max_str);\n\t\t\t}\n\t\t}catch(Exception e){\n\t\t\tSystem.err.print(e);\n\t\t}\n\t}\n\n\tstatic void dp(int x, int y){\n\t\t//System.out.println(\"計算: (\" + x + \", \" + y + \")\");\n\t\tchar target = tiles[y][x];\n\t\tif('0' <= target && target <= '9'){\n\t\t\t// 端だったらそのまま投入\n\t\t\tif(x == 0 && y == 0){\n\t\t\t\tdstrs[y][x] = \"\" + target;\n\t\t\t}else if(x == 0){\n\t\t\t\tdstrs[y][x] = dstrs[y-1][x] + target;\n\t\t\t}else if(y == 0){\n\t\t\t\tdstrs[y][x] = dstrs[y][x-1] + target;\n\t\t\t}else{\n\t\t\t\tdstrs[y][x] = max(dstrs[y-1][x], dstrs[y][x-1]) + target;\n\t\t\t}\n\t\t\tif(dstrs[y][x].equals(\"0\")){\n\t\t\t\tdstrs[y][x] = \"\";\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tmax_str = max(dstrs[y][x], max_str);\n\t\t}else{\n\t\t\tdstrs[y][x] = \"\";\n\t\t}\n\t}\n\n\tstatic String max(String str1, String str2){\n\t\t//System.out.println(\"大小比較: \" + str1 + \"\\t\" + str2);\n\t\tif(str1.length() == 0) return str2;\n\t\tif(str2.length() == 0) return str1;\n\n\t\tint length1 = str1.length();\n\t\tint length2 = str2.length();\n\t\tif(length1 > length2){\n\t\t\treturn str1;\n\t\t}else if(length1 < length2){\n\t\t\treturn str2;\n\t\t}\n\t\tBigInteger num1 = new BigInteger(str1);\n\t\tBigInteger num2 = new BigInteger(str2);\n\t\tif(num1.compareTo(num2) == 1){\n\t\t\treturn str1;\n\t\t}else if(num1.compareTo(num2) == -1){\n\t\t\treturn str2;\n\t\t}\n\t\treturn str1;\n\t}\n\n\tstatic void printMatrix(char matrix[][]){\n\t\tfor(int i = 0; i < matrix.length; i++){\n\t\t\tfor(int j = 0; j < matrix[i].length; j++){\n\t\t\t\tSystem.out.print(matrix[i][j] + \"\\t\");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n\n\tstatic void printMatrix(String matrix[][]){\n\t\tfor(int i = 0; i < matrix.length; i++){\n\t\t\tfor(int j = 0; j < matrix[i].length; j++){\n\t\t\t\tSystem.out.print(matrix[i][j] + \"\\t\");\n\t\t\t}\n\t\t\tSystem.out.println();\n\t\t}\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\n\npublic class Main {\n\tpublic static void main(String[] args) {\n\t\tScanner sc = new Scanner(System.in);\n\t\tString a = \"111\";\n\t\tString b = \"123\";\n\t\tSystem.out.println(a.compareTo(b));\n\t\twhile (true) {\n\t\t\tint w = sc.nextInt();\n\t\t\tint h = sc.nextInt();\n\t\t\tif (w == 0 && h == 0)\n\t\t\t\tbreak;\n\t\t\tString[] str = new String[h];\n\t\t\tfor (int i = 0; i < h; i++)\n\t\t\t\tstr[i] = sc.next();\n\t\t\tString[][] field = new String[h][w];\n\t\t\tfor (int i = 0; i < h; i++)\n\t\t\t\tfor (int j = 0; j < w; j++)\n\t\t\t\t\tfield[i][j] = \"\";\n\t\t\tswitch (str[0].charAt(0)) {\n\t\t\tcase '0':\n\t\t\tcase '1':\n\t\t\tcase '2':\n\t\t\tcase '3':\n\t\t\tcase '4':\n\t\t\tcase '5':\n\t\t\tcase '6':\n\t\t\tcase '7':\n\t\t\tcase '8':\n\t\t\tcase '9':\n\t\t\t\tfield[0][0] = str[0].substring(0, 1);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfield[0][0] = \"\";\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tString max = field[0][0];\n\t\t\tfor (int i = 0; i < h; i++)\n\t\t\t\tfor (int j = 0; j < w; j++) {\n\t\t\t\t\tif (i > 0) {\n\t\t\t\t\t\tif (field[i - 1][j].equals(\"\")\n\t\t\t\t\t\t\t\t|| field[i - 1][j].equals(\"0\"))\n\t\t\t\t\t\t\tswitch (str[i].charAt(j)) {\n\t\t\t\t\t\t\tcase '0':\n\t\t\t\t\t\t\tcase '1':\n\t\t\t\t\t\t\tcase '2':\n\t\t\t\t\t\t\tcase '3':\n\t\t\t\t\t\t\tcase '4':\n\t\t\t\t\t\t\tcase '5':\n\t\t\t\t\t\t\tcase '6':\n\t\t\t\t\t\t\tcase '7':\n\t\t\t\t\t\t\tcase '8':\n\t\t\t\t\t\t\tcase '9':\n\t\t\t\t\t\t\t\tfield[i][j] = maxString(field[i][j],\n\t\t\t\t\t\t\t\t\t\tstr[i].substring(j, j + 1));\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tfield[0][0] = \"\";\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tswitch (str[i].charAt(j)) {\n\t\t\t\t\t\t\tcase '0':\n\t\t\t\t\t\t\tcase '1':\n\t\t\t\t\t\t\tcase '2':\n\t\t\t\t\t\t\tcase '3':\n\t\t\t\t\t\t\tcase '4':\n\t\t\t\t\t\t\tcase '5':\n\t\t\t\t\t\t\tcase '6':\n\t\t\t\t\t\t\tcase '7':\n\t\t\t\t\t\t\tcase '8':\n\t\t\t\t\t\t\tcase '9':\n\t\t\t\t\t\t\t\tfield[i][j] = maxString(\n\t\t\t\t\t\t\t\t\t\tfield[i][j],\n\t\t\t\t\t\t\t\t\t\tfield[i - 1][j]\n\t\t\t\t\t\t\t\t\t\t\t\t+ str[i].substring(j, j + 1));\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tfield[0][0] = \"\";\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (j > 0) {\n\t\t\t\t\t\tif (field[i][j - 1].equals(\"\")\n\t\t\t\t\t\t\t\t|| field[i][j - 1].equals(\"0\"))\n\t\t\t\t\t\t\tswitch (str[i].charAt(j)) {\n\t\t\t\t\t\t\tcase '0':\n\t\t\t\t\t\t\tcase '1':\n\t\t\t\t\t\t\tcase '2':\n\t\t\t\t\t\t\tcase '3':\n\t\t\t\t\t\t\tcase '4':\n\t\t\t\t\t\t\tcase '5':\n\t\t\t\t\t\t\tcase '6':\n\t\t\t\t\t\t\tcase '7':\n\t\t\t\t\t\t\tcase '8':\n\t\t\t\t\t\t\tcase '9':\n\t\t\t\t\t\t\t\tfield[i][j] = maxString(field[i][j],\n\t\t\t\t\t\t\t\t\t\tstr[i].substring(j, j + 1));\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tfield[0][0] = \"\";\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tswitch (str[i].charAt(j)) {\n\t\t\t\t\t\t\tcase '0':\n\t\t\t\t\t\t\tcase '1':\n\t\t\t\t\t\t\tcase '2':\n\t\t\t\t\t\t\tcase '3':\n\t\t\t\t\t\t\tcase '4':\n\t\t\t\t\t\t\tcase '5':\n\t\t\t\t\t\t\tcase '6':\n\t\t\t\t\t\t\tcase '7':\n\t\t\t\t\t\t\tcase '8':\n\t\t\t\t\t\t\tcase '9':\n\t\t\t\t\t\t\t\tfield[i][j] = maxString(\n\t\t\t\t\t\t\t\t\t\tfield[i][j],\n\t\t\t\t\t\t\t\t\t\tfield[i][j - 1]\n\t\t\t\t\t\t\t\t\t\t\t\t+ str[i].substring(j, j + 1));\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tfield[0][0] = \"\";\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tmax = maxString(max, field[i][j]);\n\t\t\t\t}\n\t\t\tSystem.out.println(max);\n\t\t}\n\t\tsc.close();\n\t}\n\n\tstatic String maxString(String a, String b) {\n\t\tString result = \"\";\n\t\tif (a.length() > b.length())\n\t\t\tresult = a;\n\t\tif (a.length() < b.length())\n\t\t\tresult = b;\n\t\tif (a.length() == b.length()) {\n\t\t\tif (a.compareTo(b) < 0)\n\t\t\t\tresult = b;\n\t\t\telse\n\t\t\t\tresult = a;\n\t\t}\n\t\treturn result;\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.awt.Point;\nimport java.io.FileInputStream;\nimport java.io.PrintStream;\nimport java.util.ArrayList;\nimport java.util.LinkedList;\nimport java.util.Scanner;\n\nimport javax.naming.InitialContext;\n \npublic class Main {\n     \n\tstatic int W, H;\n\tstatic char[][] matrix;\n\tstatic String[][] dp;\n\t\n\t// a < bならTrue\n\tstatic Boolean cmp(String a, String b)\n\t{\n\t\tif(a.length() < b.length()) \n\t\t\treturn true;\n\t\telse if(a.length() > b.length())\n\t\t\treturn false;\n\t\t\n\t\tfor(int i = 0;i < a.length();i++)\n\t\t{\n\t\t\tif(a.charAt(i) - b.charAt(i) < 0)\n\t\t\t\treturn true;\n\t\t\telse if(a.charAt(i) - b.charAt(i) > 0)\n\t\t\t\treturn false;\n\t\t}\n\t\t\n\t\treturn true;\n\t}\n\t\n\t// a < bならTrue\n\t// 最初にゼロ刈りする\n\t\tstatic Boolean cmp2(String a, String b)\n\t\t{\n\t\t\tint a0num = 0, b0num = 0;\n\t\t\tfor(int i = 0;i < a.length();i++)\n\t\t\t{\n\t\t\t\tif(a.charAt(i) - '0' == 0)\n\t\t\t\t\ta0num++;\n\t\t\t\telse {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i = 0;i < b.length();i++)\n\t\t\t{\n\t\t\t\tif(b.charAt(i) - '0' == 0)\n\t\t\t\t\tb0num++;\n\t\t\t\telse {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn cmp(a.substring(a0num), b.substring(b0num));\n\t\t}\n\t\n\tstatic String calc(int x, int y)\n\t{\n\t\tString a, b;\n\t\tif('A' <= matrix[y][x] && matrix[y][x] <= 'Z') return \"\";\n\t\t\n\t\ta = matrix[y][x] + dp[y][x + 1];\n\t\tb = matrix[y][x] + dp[y + 1][x];\n\n\t\tif(cmp(a, b))\n\t\t\treturn b;\n\t\telse {\n\t\t\treturn a;\n\t\t}\n\t}\n    \n    static void start()\n    {\n    \tdp = new String[H+1][W+1];\n    \t\n    \tdp[H][W] = \"\";\n    \tfor (int x = W-1; x >= 0; x--) dp[H][x] = \"\";\n    \tfor (int y = H-1; y >= 0; y--) dp[y][W] = \"\";\n    \t\n    \tint sx = W - 1;\n    \tint sy = H - 1;\n    \t\n    \twhile(true)\n    \t{\n    \t\tdp[sy][sx] = calc(sx, sy);\n    \t\t\n    \t\tfor (int x = sx - 1; x >= 0; x--) dp[sy][x] = calc(x, sy);\n        \tfor (int y = sy - 1; y >= 0; y--) dp[y][sx] = calc(sx, y);\n        \t\n        \tif(sx == 0 || sy == 0) break;\n        \t\n        \tsx--;\n        \tsy--;\n    \t}\n    \t\n    \tString max = \"\";\n    \tfor (int y = 0; y < H; y++) {\n    \t\tfor (int x = 0; x < W; x++) {\n    \t\t\tif(cmp2(max, dp[y][x])) max = dp[y][x];\n    \t\t\t\n    \t\t\t//System.out.println(dp[y][x]);\n\t\t\t}\n\t\t}\n    \t\n    \t//System.out.println(\"----------------------------------------\");\n    \tSystem.out.println(max);\n    \t//System.out.println(\"----------------------------------------\");\n    }\n     \n    public static void main(String[] args)\n    {\n        Scanner sca = new Scanner(System.in);\n        \n        while(true)\n        {\n        \tW = sca.nextInt();\n        \tH = sca.nextInt();\n        \tif(W == 0) break;\n        \t\n        \tmatrix = new char[H][W];\n        \tfor (int y = 0; y < H; y++) {\n        \t\tString str = sca.next();\n        \t\t\n\t\t\t\tfor (int x = 0; x < W; x++) {\n\t\t\t\t\tmatrix[y][x] = str.charAt(x);\n\t\t\t\t}\n\t\t\t}\n            \n            start();\n        }\n        \n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.*;\nimport java.util.regex.*;\n\nimport static java.lang.Math.*;\nimport static java.lang.System.out;\n\n// AOJ\npublic class Main {\n\tfinal Scanner sc=new Scanner(System.in);\n\tpublic static void main(String[] args) {\n\t\tnew Main().AOJ1126();\n\t}\n\tstatic class Point{\n\t\tint x, y;\n\t\tPoint(int x, int y){\tthis.x=x;\tthis.y=y;}\n\t\tPoint(){\tthis.x=0; this.y=0;}\n\t\t@Override public String toString(){\treturn \"(\"+this.x+\",\"+this.y+\")\";}\n\t\tstatic boolean ok(int x,int y,int X,int Y,int min){\n\t\t\treturn (min<=x&&x<X && min<=y&&y<Y)?true:false;\n\t\t}\n\t\tstatic boolean ok(int x,int y,int X,int Y){\treturn ok(x,y,X,Y,0);}\n\t}\n\tfinal int[] vx={0,1,0,-1}, vy={-1,0,1,0};\n\n\t\n\tvoid AOJ1126(){\n\t\twhile(sc.hasNext()){\n\t\t\tint W=sc.nextInt(), H=sc.nextInt();\n\t\t\tString ans=\"\";\n\t\t\tif((W|H)==0)\tbreak;\n\t\t\tchar[][] c=new char[W][H];\n\t\t\tLinkedList<C1126> open=new LinkedList<C1126>();\n\t\t\tHashSet<C1126> close=new HashSet<C1126>();\n\t\t\tfor(int y=0; y<H; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<W; x++){\n\t\t\t\t\tc[x][y]=line.charAt(x);\n\t\t\t\t\tif(Character.isDigit(line.charAt(x))){\n\t\t\t\t\t\topen.add(new C1126(x,y,\"\"+c[x][y]));\n\t\t\t\t\t\tclose.add(new C1126(x,y,\"\"+c[x][y]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tC1126 now=open.poll();\n\t\t\t\t// TODO debug\n\t\t\t\t//out.println(\"ANS\"+ans+\" NOW\"+now.ans);\n\t\t\t\tif(ans.length()<now.ans.length())\tans=new String(now.ans);\n\t\t\t\telse if(ans.length()==now.ans.length()){\n\t\t\t\t\tfor(int i=0; i<ans.length(); i++){\n\t\t\t\t\t\tif(ans.charAt(i)<now.ans.charAt(i)){\n\t\t\t\t\t\t\tans=new String(now.ans);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}else if(ans.charAt(i)>now.ans.charAt(i))\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor(int i=1; i<3; i++){\n\t\t\t\t\tint xx=now.x+vx[i], yy=now.y+vy[i];\n\t\t\t\t\tif(!Point.ok(xx,yy,W,H))\tcontinue;\n\t\t\t\t\tif(Character.isDigit(c[xx][yy])){\n\t\t\t\t\t\tC1126 temp=new C1126(xx,yy,now.ans+c[xx][yy]);\n\t\t\t\t\t\tif(!close.contains(temp)){\n\t\t\t\t\t\t\topen.add(temp);\n\t\t\t\t\t\t\tclose.add(temp);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t}\n\tclass C1126{\n\t\tint x,y;\tString ans;\n\t\tC1126(int x,int y,String ans){\n\t\t\tthis.x=x;\tthis.y=y;\n\t\t\tif(ans.length()>0){\n\t\t\t\tint i=0;\n\t\t\t\twhile(ans.charAt(i)=='0'){\n\t\t\t\t\tif(++i>=ans.length()-1)\tbreak;\n\t\t\t\t\tans=ans.substring(i);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.ans=ans;\n\t\t}\n\t\t@Override public boolean equals(Object obj){\n\t\t\tif(this==obj)\treturn true;\n\t\t\tif(obj==null)\treturn false;\n\t\t\tif(!(obj instanceof C1126))  return false;\n\t\t\tC1126 oth=(C1126)obj;\n\t\t\tif(this.x==oth.x && this.y==oth.y && this.ans.equals(ans))\treturn true;\n\t\t\treturn false;\n\t\t}\n\t\t@Override public int hashCode(){\n\t\t\treturn x+y+ans.hashCode();\n\t\t}\n\t}\n\t\n\tvoid AOJ0165(){\n\t\tfinal int MAX=1000000;\n\t\tboolean[] prime=Sieve(MAX);\n\t\t// 素数の個数の累積和を作る\n\t\twhile(sc.hasNext()){\n\t\t\tint N=sc.nextInt();\n\t\t\tif(N==0)\tbreak;\n\t\t\tint ans=0;\n\t\t\tfor(int i=1; i<=N; i++){\n\t\t\t\tint p=sc.nextInt(), m=sc.nextInt();\n\t\t\t\tint min=max(0,p-m), max=min(MAX, p+m);\n\t\t\t\tint temp=(min<=2?1:0);\n\t\t\t\tfor(int j=(min%2==0?min+1:min); j<=max; j+=2){\n\t\t\t\t\tif(prime[j])\ttemp++;\n\t\t\t\t}\n\t\t\t\t//out.println(\"TEMP\"+temp);\n\t\t\t\tans+=(temp==0?-1:temp-1);\n\t\t\t}\n\t\t\tout.println(max(0,ans));\n\t\t}\n\t}\n\t\n\tvoid AOJ1144(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(), Y=sc.nextInt();\n\t\t\tif((X|Y)==0)\tbreak;\n\t\t\tchar[][] c=new char[X][Y];\n\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\t\tc[x][y]=line.charAt(x);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\n\t// TODO 果樹園　RE　横型\n\tvoid AOJ0118(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(), Y=sc.nextInt(), ans=0;\n\t\t\tif((X|Y)==0)\tbreak;\n\t\t\tchar[][] c=new char[X+10][Y+10];\n\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\tString line=sc.next();\n\t\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\t\tc[x][y]=line.charAt(x);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\t\tif(c[x][y]=='&')\tcontinue;\n\t\t\t\t\tans++;\n\t\t\t\t\tLinkedList<Point> open=new LinkedList<Point>();\n\t\t\t\t\topen.add(new Point(x,y));\n\t\t\t\t\tchar mark=c[x][y];\n\t\t\t\t\twhile(!open.isEmpty()){\n\t\t\t\t\t\tPoint now=open.poll();\n\t\t\t\t\t\tc[now.x][now.y]='&';\n\t\t\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\t\t\tif(now.x+vx[i]<0 || now.x+vx[i]>=X || now.y+vy[i]<0 || now.y+vy[i]>=Y)\tcontinue;\n\t\t\t\t\t\t\tif(c[now.x+vx[i]][now.y+vy[i]]==mark){\n\t\t\t\t\t\t\t\t//out.println((now.x+vx[i])+\" \"+(now.y+vy[i]));\n\t\t\t\t\t\t\t\topen.add(new Point(now.x+vx[i],now.y+vy[i]));\n\t\t\t\t\t\t\t\tc[now.x+vx[i]][now.y+vy[i]]='&';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//out.println(\"ANS\"+ans);\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t}\n\t\n\t// Red and Black 横型探索\n\tvoid AOJ1130(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(), Y=sc.nextInt(),sx=0,sy=0,ans=0;\n\t\t\tif(X==0)\tbreak;\n\t\t\tchar[][] c=new char[X][Y];\n\t\t\tfor(int y=0; y<Y; y++){\n\t\t\t\tchar[] line=sc.next().toCharArray();\n\t\t\t\tfor(int x=0; x<X; x++){\n\t\t\t\t\tc[x][y]=line[x];\n\t\t\t\t\tif(line[x]=='@'){\n\t\t\t\t\t\tsx=x;\tsy=y;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tLinkedList<Point> open=new LinkedList<Point>();\n\t\t\topen.add(new Point(sx,sy));\n\t\t\tboolean[][] close=new boolean[X][Y];\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tans++;\n\t\t\t\tPoint now=open.poll();\n\t\t\t\tclose[now.x][now.y]=true;\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(now.x+vx[i]<0 || now.x+vx[i]>=X || now.y+vy[i]<0 || now.y+vy[i]>=Y)\tcontinue;\n\t\t\t\t\tif(c[now.x+vx[i]][now.y+vy[i]]=='.' && !close[now.x+vx[i]][now.y+vy[i]]){\n\t\t\t\t\t\topen.add(new Point(now.x+vx[i], now.y+vy[i]));\n\t\t\t\t\t\tclose[now.x+vx[i]][now.y+vy[i]]=true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans);\n\t\t}\n\t}\n\t\n\t// TODO デパート　TLE MLE WA\n\tvoid AOJ0223(){\n\t\twhile(sc.hasNext()){\n\t\t\tint X=sc.nextInt(),\tY=sc.nextInt();\n\t\t\tif(X==0)\tbreak;\n\t\t\tint tx=sc.nextInt(), ty=sc.nextInt(), kx=sc.nextInt(), ky=sc.nextInt();\n\t\t\tint[][] b=new int[X+1][Y+1];\n\t\t\tfor(int y=1; y<=Y; y++){\n\t\t\t\tfor(int x=1; x<=X; x++)\tb[x][y]=sc.nextInt();\n\t\t\t}\n\t\t\tLinkedList<C0223> open=new LinkedList<C0223>();\n\t\t\topen.add(new C0223(tx,ty,kx,ky,0));\n\t\t\tint[][][][] close2=new int[X+1][Y+1][X+1][Y+1];\n\t\t\tclose2[tx][ty][kx][ky]=-1;\n\t\t\tint ans=-1;\n\t\t\twhile(!open.isEmpty()){\n\t\t\t\tC0223 now=open.poll();\n\t\t\t\tif(now.ans()){\n\t\t\t\t\tans=now.sec;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif(now.sec>=99)\tbreak;\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(0<now.tx+vx[i]&&now.tx+vx[i]<=X && 0<now.ty+vy[i]&&now.ty+vy[i]<=Y && 0<now.kx-vx[i]&&now.kx-vx[i]<=X && 0<now.ky-vy[i]&&now.ky-vy[i]<=Y){\n\t\t\t\t\t\ttx=now.tx;\tty=now.ty;\tkx=now.kx;\tky=now.ky;\n\t\t\t\t\t\tif(b[tx+vx[i]][ty+vy[i]]==0){\n\t\t\t\t\t\t\ttx+=vx[i];\tty+=vy[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(b[kx-vx[i]][ky-vy[i]]==0){\n\t\t\t\t\t\t\tkx-=vx[i];\tky-=vy[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//out.println(\"TEMP:\"+tx+\" \"+ty+\" \"+kx+\" \"+ky);\n\t\t\t\t\t\t//if(tx==kx && ty==ky)\tans=ans<0?now.sec+1:min(ans,now.sec+1);\n\t\t\t\t\t\tif(close2[tx][ty][kx][ky]==0 || close2[tx][ty][kx][ky]>now.sec+1){\n\t\t\t\t\t\t\t//out.println(\"ADD:\"+tx+\" \"+ty+\" \"+kx+\" \"+ky);\n\t\t\t\t\t\t\topen.add(new C0223(tx,ty,kx,ky,now.sec+1));\n\t\t\t\t\t\t\tclose2[tx][ty][kx][ky]=now.sec+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tout.println(ans<0? \"NA\": ans);\n\t\t}\n\t}\n\tclass C0223{\n\t\tint tx,ty,kx,ky,sec;\n\t\tC0223(int tx, int ty, int kx, int ky, int sec){\n\t\t\tthis.tx=tx;\tthis.ty=ty;\tthis.kx=kx;\tthis.ky=ky;\tthis.sec=sec;\n\t\t}\n\t\tboolean ans(){\n\t\t\tif(this.tx==this.kx && this.ty==this.ky)\treturn true;\n\t\t\telse\treturn false;\n\t\t}\n\t}\n\t\n\t\n\t// TODO WA\n\tvoid AOJ0142(){\n\t\twhile(sc.hasNext()){\n\t\t\tint n=sc.nextInt();\n\t\t\tif(n==0)\tbreak;\n\t\t\tint nn=(n-1)/2;\n\t\t\tboolean[] b=new boolean[n];\n\t\t\tfor(int i=1; i<n; i++)\tb[(i*i)%n]=true;\n\t\t\tArrayList<Integer> ar=new ArrayList<Integer>();\n\t\t\tfor(int i=1; i<n; i++){\n\t\t\t\tif(b[i])\tar.add(i);\n\t\t\t}\n\t\t\tint[] ans=new int[nn+1];\n\t\t\tfor(int i=0; i<ar.size(); i++){\n\t\t\t\tfor(int j=0; j<ar.size(); j++){\n\t\t\t\t\tif(i==j)\tcontinue;\n\t\t\t\t\tint temp=ar.get(i)-ar.get(j);\n\t\t\t\t\ttemp+= temp<0? n:0;\n\t\t\t\t\ttemp= temp>nn? n-temp: temp;\n\t\t\t\t\tans[temp]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=1; i<=nn; i++)\tout.println(ans[i]);\n\t\t}\n\t}\n\t\n\t\n\t// TODO レゴ　WA\n\tvoid AOJ0207(){\n\t\twhile(sc.hasNext()){\n\t\t\tint w=sc.nextInt(), h=sc.nextInt();\n\t\t\tif(w==0)\tbreak;\n\t\t\tint sx=sc.nextInt(), sy=sc.nextInt(), gx=sc.nextInt(), gy=sc.nextInt(), n=sc.nextInt();\n\t\t\tint[][] b=new int[w+2][h+2];\n\t\t\tfor(int i=0; i<n; i++){\n\t\t\t\tint color=sc.nextInt(), d=sc.nextInt(), x=sc.nextInt(), y=sc.nextInt();\n\t\t\t\tif(d==0){\t// 横 4x2\n\t\t\t\t\tfor(int j=y; j<y+2; j++){\n\t\t\t\t\t\tfor(int k=x; k<x+4; k++)\tb[k][j]=color;\n\t\t\t\t\t}\n\t\t\t\t}else{\t// 縦 2x4\n\t\t\t\t\tfor(int j=y; j<y+4; j++){\n\t\t\t\t\t\tfor(int k=x; k<x+2; k++)\tb[k][j]=color;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//debug\n\t\t\t//de0207(b,w,h);\n\t\t\tint[] vx={1,0,-1,0}, vy={0,1,0,-1};\n\t\t\tint xx=sx, yy=sy, cc=b[sx][sy], v=0, count=0, max=w*h;\n\t\t\tif(cc<1){\n\t\t\t\tout.println(\"NG\");\n\t\t\t\tSystem.exit(0);\n\t\t\t}\n\t\t\twhile(true){\n\t\t\t\tif(xx==gx && yy==gy && b[xx][yy]==cc){\n\t\t\t\t\tout.println(\"OK\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcount++;\n\t\t\t\tif(count>=max){\n\t\t\t\t\tout.println(\"NG\");\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t//b[xx][yy]=6;\n\t\t\t\tboolean flag=false;\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(b[xx+vx[i]][yy+vy[i]]==cc){\n\t\t\t\t\t\txx+=vx[i];\tyy+=vy[i];\tv=i;\n\t\t\t\t\t\tflag=true;\n\t\t\t\t\t\tout.println(\"X\"+xx+\" Y\"+yy);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(flag)\tcontinue;\n\t\t\t\txx-=vx[v];\tyy-=vy[v];\n\t\t\t\tfor(int i=0; i<4; i++){\n\t\t\t\t\tif(b[xx+vx[i]][yy+vy[i]]==cc){\n\t\t\t\t\t\txx+=vx[i];\tyy+=vy[i];\tv=i;\n\t\t\t\t\t\tflag=true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(flag)\tcontinue;\n\t\t\t\tout.println(\"END : X\"+xx+\" Y\"+yy);\n\t\t\t\tout.println(\"NG\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t//debug\n\t\t\tde0207(b,w,h);\n\t\t}\n\t}\n\tvoid de0207(int[][] b, int w, int h){\n\t\tfor(int j=0; j<=h; j++){\n\t\t\tfor(int i=0; i<=w; i++)\tout.print(b[i][j]+\" \");\n\t\t\tout.println();\n\t\t}\n\t\tfor(int i=0; i<=w; i++)\tout.print(\"-\");\n\t\tout.println();\n\t}\n\t\n\tvoid AOJ0139(){\n\t\tint N=sc.nextInt();\n\t\tfinal Pattern ap=Pattern.compile(\"^>'(=+)#(=+)~$\");\n\t\tfor(int i=1; i<=N; i++){\n\t\t\tString s=sc.next();\n\t\t\tMatcher m=ap.matcher(s);\n\t\t\tif(m.matches()){\n\t\t\t\tif(m.group(1).length()==m.group(2).length()){\n\t\t\t\t\tout.println(\"A\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}else if(Pattern.compile(\"^>\\\\^(Q=)+~~$\").matcher(s).matches()){\n\t\t\t\tout.println(\"B\");\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tout.println(\"NA\");\n\t\t}\n\t}\n\t\n\tArrayList<Integer> Sieve2(int N){\n\t\tArrayList<Integer> prime = new ArrayList<Integer>();\n\t\tboolean[] list = new boolean[N+1];\n\t\tArrays.fill(list, true);\n\t\tlist[1]=false;\n\t\tfor (int i=2; i<=N; i++) {\n\t\t\tif(list[i]) {\n\t\t\t\tprime.add(i);\n\t\t\t\tfor (int j=i+i; j<=N; j+=i)\tlist[j] = false;\n\t\t\t}\n\t\t}\n\t\treturn prime;\n\t}\n\n\tboolean[] Sieve(int N){\n\t\tboolean[] list = new boolean[N+1];\n\t\tArrays.fill(list, true);\n\t\tlist[0]=false;\tlist[1]=false;\n\t\tfor(int j=4; j<=N; j+=2)\tlist[j]=false;\n\t\tfor(int i=3; i*i<=N; i+=2) {\n\t\t\tif(list[i]) {\n\t\t\t\tfor (int j=i+i; j<=N; j+=i)\tlist[j] = false;\n\t\t\t}\n\t\t}\n\t\treturn list;\n\t}\n\t\n\tboolean isPrime(int n){\n\t\tfor(int i=2; i*i<=n; i++){\n\t\t\tif(n%i==0)     return false;\n\t\t}\n\t\treturn true;\n\t}\n\t\n\tint gcd(int x, int y){\n\t\tif(y==0)\treturn x;\n\t\telse\treturn gcd(y, x%y);\n\t}\n}"
  },
  {
    "language": "Java",
    "code": "import java.util.Scanner;\nimport java.util.Arrays;\n \npublic class Main{\n    public static void main(String[] args) {\n        Scanner sc = new Scanner(System.in);\n        int[][] map = new int[70][70];\n        int w, h;\n        String temp;\n        while(true){\n            w = sc.nextInt();\n            h = sc.nextInt();\n            if(w==0 && h==0) break;\n \n            for(int i=0; i<h; i++){\n                temp = sc.next();\n                Arrays.fill(map[i], -1);\n                for(int j=0; j<w; j++){\n                    if(temp.charAt(j)>='0' && temp.charAt(j)<='9'){\n                        map[i][j] = temp.charAt(j) - '0';\n                    }\n                }\n            }\n            Arrays.fill(map[h], -1);\n \n            String sum = \"\", max = \"\";\n            for(int i=0; i<h; i++){\n                for(int j=0; j<w; j++){\n                    if(map[i][j]>0 && map[i][j]<10){\n                        sum = dfs(map, i, j);\n \n                        if(max.length() < sum.length()){\n                            max = sum;\n                        }else if(max.length()==sum.length()){\n                            for(int n=0; n<max.length(); n++){\n                                if(max.charAt(n)<sum.charAt(n)){\n                                    max = sum;\n                                    break;\n                                }else if(max.charAt(n)>sum.charAt(n)){\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n \n            System.out.println(max);\n        }\n    }\n \n    static public String dfs(int[][] map, int i, int j){\n        String s1, s2;\n        s1 = String.valueOf(map[i][j]%10);\n        s2 = s1;\n        map[i][j] += 10;\n \n        if(map[i+1][j]!=-1){\n            s1 += dfs(map, i+1, j);\n        }\n        if(map[i][j+1]!=-1){\n            s2 += dfs(map, i, j+1);\n        }\n \n        if(s1.length() < s2.length()){\n            return s2;\n        }else if(s1.length()==s2.length() && !s1.equals(s2)){\n            for(int n=0; n<s1.length(); n++){\n                if(s1.charAt(n)<s2.charAt(n)){\n                    return s2;\n                }else if(s1.charAt(n)>s2.charAt(n)){\n                    break;\n                }\n            }\n        }\n        return s1;\n    }\n}"
  },
  {
    "language": "Java",
    "code": "import java.math.BigInteger;\nimport java.util.Arrays;\nimport java.util.Scanner;\n\npublic class Main {\n\n  Scanner sc;\n\n  Main() {\n    sc = new Scanner(System.in);\n  }\n\n  int ni() {\n    return sc.nextInt();\n  }\n\n  public static void main(String[] args) {\n    new Main().run();\n  }\n\n  int w, h;\n  char[][] c;\n\n  static int[][] ofs = {\n      {1, 0},\n      {0, 1}\n  };\n\n  String dfs(int x, int y, String num) {\n    if (x >= w) {\n      return num;\n    }\n    if (y >= h) {\n      return num;\n    }\n    if (c[y][x] < '0' || '9' < c[y][x]) {\n      return num;\n    }\n    num += c[y][x];\n    String res = num;\n    for (int i = 0; i < 2; ++i) {\n      int nx = x + ofs[i][0];\n      int ny = y + ofs[i][1];\n      String nnum = dfs(nx, ny, num);\n      if (new BigInteger(res).compareTo(new BigInteger(nnum)) < 0) {\n        res = new BigInteger(nnum).toString();\n      }\n    }\n    return res;\n  }\n\n  void run() {\n    for (; ; ) {\n      w = ni();\n      h = ni();\n      if ((w | h) == 0) {\n        break;\n      }\n      c = new char[h][w];\n      for (int i = 0; i < h; ++i) {\n        String line = sc.next();\n        for (int j = 0; j < w; ++j) {\n          c[i][j] = line.charAt(j);\n        }\n      }\n      String ans = \"0\";\n      for (int i = 0; i < h; ++i) {\n        for (int j = 0; j < w; ++j) {\n          String sans = dfs(j, i, \"0\");\n          if (new BigInteger(ans).compareTo(new BigInteger(sans)) < 0) {\n            ans = sans;\n          }\n        }\n      }\n      System.out.println(ans);\n    }\n  }\n\n  void debug(Object... os) {\n    System.err.println(Arrays.deepToString(os));\n  }\n}"
  },
  {
    "language": "C#",
    "code": "using System;\n\npublic class hello\n{\n\n    public static void Main()\n    {\n        while (true)\n        {\n            string[] line = Console.ReadLine().Trim().Split(' ');\n            var w = int.Parse(line[0]);\n            var h = int.Parse(line[1]);\n            if (w == 0 && h == 0) break;\n            var map = new string[h, w];\n            for (int i = 0; i < h; i++)\n            {\n                var s = Console.ReadLine().Trim();\n                for (int j = 0; j < w; j++)\n                {\n                    int t;\n                    map[i, j] = int.TryParse(s[j].ToString(), out t) ? s[j].ToString() : \"#\";\n                }\n            }\n            var dp = new string[h, w];\n            goDp(map, h, w, dp);\n        }\n    }\n    static void goDp(string[,] map, int h, int w, string[,] dp)\n    {\n        var ans = \"0\";\n        for (int i = 0; i < h; i++)\n        {\n            for (int j = 0; j < w; j++)\n            {\n                if (map[i, j] != \"#\")\n                {\n                    string t;\n                    if ((i - 1 < 0) || (map[i - 1, j] == \"#\")) t = map[i, j];\n                    else t = dp[i - 1, j] + map[i, j];\n                    if (t[0] == '0') t = delete0(t);\n                    string t2;\n                    if ((j - 1 < 0) || (map[i, j - 1] == \"#\")) t2 = map[i, j];\n                    else t2 = dp[i, j - 1] + map[i, j];\n                    if (t2[0] == '0') t2 = delete0(t2);\n                    dp[i, j] = checkAB(t, t2) ? t : t2;\n                    if (((i + 1 >= h) || (map[i + 1, j] == \"#\")) && ((j + 1 >= w) || map[i, j + 1] == \"#\"))\n                        ans = checkAB(ans, dp[i, j]) ? ans : dp[i, j];\n                }\n            }\n        }\n        Console.WriteLine(ans);\n    }\n    static string delete0(string s)\n    {\n        if (s.Replace(\"0\", \"\").Length == 0) return \"0\";\n        var p = 0;\n        while (true)\n        {\n            if (s[p] != '0') break;\n            p++;\n        }\n        return s.Substring(p);\n    }\n    static bool checkAB(string s, string t)\n    {\n        if (s == \"\") s = \"0\";\n        if (t == \"\") t = \"0\";\n        if (s.Length > t.Length) return true;\n        else if (s.Length < t.Length) return false;\n        return s.CompareTo(t) > 0;\n    }\n}\n\n"
  },
  {
    "language": "C#",
    "code": "using System;\n\npublic class hello\n{\n\n    public static void Main()\n    {\n        while (true)\n        {\n            string[] line = Console.ReadLine().Trim().Split(' ');\n            var w = int.Parse(line[0]);\n            var h = int.Parse(line[1]);\n            if (w == 0 && h == 0) break;\n            var map = new string[h, w];\n            for (int i = 0; i < h; i++)\n            {\n                var s = Console.ReadLine().Trim();\n                for (int j = 0; j < w; j++)\n                {\n                    int t;\n                    map[i, j] = int.TryParse(s[j].ToString(), out t) ? s[j].ToString() : \"#\";\n                }\n            }\n            var dp = new string[h, w];\n            goDp(map, h, w, dp);\n        }\n    }\n    static void goDp(string[,] map, int h, int w, string[,] dp)\n    {\n        var ans = \"0\";\n        for (int i = 0; i < h; i++)\n        {\n            for (int j = 0; j < w; j++)\n            {\n                if (map[i, j] != \"#\")\n                {\n                    string t;\n                    if ((i - 1 < 0) || (map[i - 1, j] == \"#\")) t = map[i, j];\n                    else t = dp[i - 1, j] + map[i, j];\n                    if (t[0] == '0')  t  = delete0(t);\n                    string t2;\n                    if ((j - 1 < 0) || (map[i, j - 1] == \"#\")) t2 =  map[i, j];\n                    else t2 = dp[i, j - 1] + map[i, j];\n                    if (t2[0] == '0') t2 = delete0(t2);\n                    dp[i, j] = checkAB(t, t2) ? t : t2;\n                    if (((i + 1 >= h) || (map[i + 1, j] == \"#\")) &&( (j + 1 >= w) || map[i, j + 1] == \"#\"))\n                        ans = checkAB(ans, dp[i, j]) ? ans : dp[i, j];\n                }\n            }\n        }\n        Console.WriteLine(ans);\n    }\n    static string delete0 (string s)\n    {\n        if (s.Replace(\"0\", \"\").Length == 0) return \"0\";\n        var p = 0;\n        while (p < s.Length )\n        {\n            if (s[p] != '0') break;\n            p++;\n        }\n        return s.Substring(p);\n    }\n    static bool checkAB(string s, string t)\n    {\n        if (s == \"\") s = \"0\";\n        if (t == \"\") t = \"0\";\n        if (s.Length > t.Length) return true;\n        else if (s.Length < t.Length) return false;\n        return s.CompareTo(t) > 0;\n    }\n}\n\n"
  },
  {
    "language": "C#",
    "code": "using System.Numerics;\nusing System;\n\npublic class hello\n{\n\n    public static void Main()\n    {\n        while (true)\n        {\n            string[] line = Console.ReadLine().Trim().Split(' ');\n            var w = int.Parse(line[0]);\n            var h = int.Parse(line[1]);\n            if (w == 0 && h == 0) break;\n            var map = new string[h, w];\n            for (int i = 0; i < h; i++)\n            {\n                var s = Console.ReadLine().Trim();\n                for (int j = 0; j < w; j++)\n                {\n                    int t;\n                    map[i, j] = int.TryParse(s[j].ToString(), out t) ? s[j].ToString() : \"#\";\n                }\n            }\n            var dp = new string[h, w];\n            goDp(map, h, w, dp);\n        }\n    }\n    static void goDp(string[,] map, int h, int w, string[,] dp)\n    {\n        var ans = \"-1\";\n        for (int i = 0; i < h; i++)\n        {\n            for (int j = 0; j < w; j++)\n            {\n                if (map[i, j] != \"#\")\n                {\n                    string t;\n                    if ((i - 1 < 0) || (map[i - 1, j] == \"#\")) t = map[i, j];\n                    else t = dp[i - 1, j] + map[i, j];\n                    string t2;\n                    if ((j - 1 < 0) || (map[i, j - 1] == \"#\")) t2 = map[i, j];\n                    else t2 = dp[i, j - 1] + map[i, j];\n                    dp[i, j] = checkAB(t, t2) ? t : t2;\n                    ans = checkAB(ans, dp[i, j]) ? ans : dp[i, j];\n                }\n            }\n        }\n        print(ans);\n    }\n    static void print (string s)\n    {\n        var ans = \"\";\n        var p = 0;\n        var first = true;\n        while (p < s.Length)\n        {\n             if (first && s[p] != '0') { ans += s[p]; first = false; }\n            else if (!first) ans += s[p];\n            p++;\n        }\n        Console.WriteLine(ans);\n\n    }\n    static bool checkAB(string s, string t)\n    {\n        BigInteger s2 = BigInteger.Parse(s);\n        BigInteger t2 = BigInteger.Parse(t);\n        return s2 > t2;\n    }\n}\n\n"
  },
  {
    "language": "C#",
    "code": "using System.Numerics;\nusing System;\n\npublic class hello\n{\n\n    public static void Main()\n    {\n        while (true)\n        {\n            string[] line = Console.ReadLine().Trim().Split(' ');\n            var w = int.Parse(line[0]);\n            var h = int.Parse(line[1]);\n            if (w == 0 && h == 0) break;\n            var map = new string[h, w];\n            for (int i = 0; i < h; i++)\n            {\n                var s = Console.ReadLine().Trim();\n                for (int j = 0; j < w; j++)\n                {\n                    int t;\n                    map[i, j] = int.TryParse(s[j].ToString(), out t) ? s[j].ToString() : \"#\";\n                }\n            }\n            var dp = new string[h, w];\n            goDp(map, h, w, dp);\n        }\n    }\n    static void goDp(string[,] map, int h, int w, string[,] dp)\n    {\n        var ans = \"-1\";\n        for (int i = 0; i < h; i++)\n        {\n            for (int j = 0; j < w; j++)\n            {\n                if (map[i, j] != \"#\")\n                {\n                    string t;\n                    if ((i - 1 < 0) || (map[i - 1, j] == \"#\")) t = map[i, j];\n                    else t = dp[i - 1, j] + map[i, j];\n                    string t2;\n                    if ((j - 1 < 0) || (map[i, j - 1] == \"#\")) t2 = map[i, j];\n                    else t2 = dp[i, j - 1] + map[i, j];\n                    dp[i, j] = checkAB(t, t2) ? t : t2;\n                    ans = checkAB(ans, dp[i, j]) ? ans : dp[i, j];\n                }\n            }\n        }\n        Console.WriteLine(ans);\n    }\n    static bool checkAB(string s, string t)\n    {\n        BigInteger s2 = BigInteger.Parse(s);\n        BigInteger t2 = BigInteger.Parse(t);\n        return s2 > t2;\n    }\n}\n\n"
  },
  {
    "language": "C#",
    "code": "using System;\n\npublic class hello\n{\n\n    public static void Main()\n    {\n        while (true)\n        {\n            string[] line = Console.ReadLine().Trim().Split(' ');\n            var w = int.Parse(line[0]);\n            var h = int.Parse(line[1]);\n            if (w == 0 && h == 0) break;\n            var map = new string[h, w];\n            for (int i = 0; i < h; i++)\n            {\n                var s = Console.ReadLine().Trim();\n                for (int j = 0; j < w; j++)\n                {\n                    int t;\n                    map[i, j] = int.TryParse(s[j].ToString(), out t) ? s[j].ToString() : \"#\";\n                }\n            }\n            var dp = new string[h, w];\n            goDp(map, h, w, dp);\n        }\n    }\n    static void goDp(string[,] map, int h, int w, string[,] dp)\n    {\n        var ans = \"0\";\n        for (int i = 0; i < h; i++)\n        {\n            for (int j = 0; j < w; j++)\n            {\n                if (map[i, j] != \"#\")\n                {\n                    string t;\n                    if ((i - 1 < 0) || (map[i - 1, j] == \"#\")) t = map[i, j];\n                    else t = dp[i - 1, j] + map[i, j];\n                    if (t[0] == '0')  t  = delete0(t);\n                    string t2;\n                    if ((j - 1 < 0) || (map[i, j - 1] == \"#\")) t2 =  map[i, j];\n                    else t2 = dp[i, j - 1] + map[i, j];\n                    if (t2[0] == '0') t2 = delete0(t2);\n                    dp[i, j] = checkAB(t, t2) ? t : t2;\n                    if (((i + 1 >= h) || (map[i + 1, j] == \"#\")) &&( (j + 1 >= w) || map[i, j + 1] == \"#\"))\n                        ans = checkAB(ans, dp[i, j]) ? ans : dp[i, j];\n                }\n            }\n        }\n        Console.WriteLine(ans);\n    }\n    static string delete0 (string s)\n    {\n        if (s.Replace(\"0\", \"\").Length == 0) return \"0\";\n        var ans = \"\";\n        var p = 0;\n        var first = true;\n        while (p < s.Length)\n        {\n            if (first && s[p] != '0') { ans += s[p]; first = false; }\n            else if (!first) ans += s[p];\n            p++;\n        }\n        return ans;\n\n    }\n    static bool checkAB(string s, string t)\n    {\n        if (s == \"\") s = \"0\";\n        if (t == \"\") t = \"0\";\n        if (s.Length > t.Length) return true;\n        else if (s.Length < t.Length) return false;\n        return s.CompareTo(t) > 0;\n    }\n}\n\n"
  },
  {
    "language": "C#",
    "code": "using System.Numerics;\nusing System;\n\npublic class hello\n{\n\n    public static void Main()\n    {\n        while (true)\n        {\n            string[] line = Console.ReadLine().Trim().Split(' ');\n            var w = int.Parse(line[0]);\n            var h = int.Parse(line[1]);\n            if (w == 0 && h == 0) break;\n            var map = new string[h, w];\n            for (int i = 0; i < h; i++)\n            {\n                var s = Console.ReadLine().Trim();\n                for (int j = 0; j < w; j++)\n                {\n                    int t;\n                    map[i, j] = int.TryParse(s[j].ToString(), out t) ? s[j].ToString() : \"#\";\n                }\n            }\n            var dp = new string[h, w];\n            goDp(map, h, w, dp);\n        }\n    }\n    static void goDp(string[,] map, int h, int w, string[,] dp)\n    {\n        var ans = \"-1\";\n        for (int i = 0; i < h; i++)\n        {\n            for (int j = 0; j < w; j++)\n            {\n                if (map[i, j] != \"#\")\n                {\n                    string t;\n                    if ((i - 1 < 0) || (map[i - 1, j] == \"#\")) t = map[i, j];\n                    else t = dp[i - 1, j] + map[i, j];\n                    string t2;\n                    if ((j - 1 < 0) || (map[i, j - 1] == \"#\")) t2 = map[i, j];\n                    else t2 = dp[i, j - 1] + map[i, j];\n                    dp[i, j] = checkAB(t, t2) ? t : t2;\n                    if (((i + 1 >= h) || (map[i + 1, j] == \"#\")) &&( (j + 1 >= w) || map[i, j + 1] == \"#\"))\n                        ans = checkAB(ans, dp[i, j]) ? ans : dp[i, j];\n                }\n            }\n        }\n        print(ans);\n    }\n    static void print(string s)\n    {\n        var ans = \"\";\n        var p = 0;\n        var first = true;\n        while (p < s.Length)\n        {\n            if (first && s[p] != '0') { ans += s[p]; first = false; }\n            else if (!first) ans += s[p];\n            p++;\n        }\n        Console.WriteLine(ans);\n\n    }\n    static bool checkAB(string s, string t)\n    {\n        BigInteger s2 = BigInteger.Parse(s);\n        BigInteger t2 = BigInteger.Parse(t);\n        return s2 > t2;\n    }\n}\n\n"
  },
  {
    "language": "C#",
    "code": "using System;\n\npublic class hello\n{\n\n    public static void Main()\n    {\n        while (true)\n        {\n            string[] line = Console.ReadLine().Trim().Split(' ');\n            var w = int.Parse(line[0]);\n            var h = int.Parse(line[1]);\n            if (w == 0 && h == 0) break;\n            var map = new string[h, w];\n            for (int i = 0; i < h; i++)\n            {\n                var s = Console.ReadLine().Trim();\n                for (int j = 0; j < w; j++)\n                {\n                    int t;\n                    map[i, j] = int.TryParse(s[j].ToString(), out t) ? s[j].ToString() : \"#\";\n                }\n            }\n            var dp = new string[h, w];\n            goDp(map, h, w, dp);\n        }\n    }\n    static void goDp(string[,] map, int h, int w, string[,] dp)\n    {\n        var ans = \"0\";\n        for (int i = 0; i < h; i++)\n        {\n            for (int j = 0; j < w; j++)\n            {\n                if (map[i, j] != \"#\")\n                {\n                    string t;\n                    if ((i - 1 < 0) || (map[i - 1, j] == \"#\")) t = map[i, j];\n                    else t = dp[i - 1, j] + map[i, j];\n                    string t2;\n                    if ((j - 1 < 0) || (map[i, j - 1] == \"#\")) t2 =  map[i, j];\n                    else t2 = dp[i, j - 1] + map[i, j];\n                    dp[i, j] = checkAB(t, t2) ?  delete0(  t) :delete0( t2);\n                    if (((i + 1 >= h) || (map[i + 1, j] == \"#\")) &&( (j + 1 >= w) || map[i, j + 1] == \"#\"))\n                        ans = checkAB(ans, dp[i, j]) ? ans : dp[i, j];\n                }\n            }\n        }\n        Console.WriteLine(ans);\n        //print(ans);\n    }\n    static string delete0 (string s)\n    {\n        if (s.Replace(\"0\", \"\").Length == 0) return \"0\";\n        var ans = \"\";\n        var p = 0;\n        var first = true;\n        while (p < s.Length)\n        {\n            if (first && s[p] != '0') { ans += s[p]; first = false; }\n            else if (!first) ans += s[p];\n            p++;\n        }\n        return ans;\n\n    }\n    static bool checkAB(string s, string t)\n    {\n        if (s == \"\") s = \"0\";\n        if (t == \"\") t = \"0\";\n        if (s.Length > t.Length) return true;\n        else if (s.Length < t.Length) return false;\n        return s.CompareTo(t) > 0;\n    }\n}\n\n"
  },
  {
    "language": "Ruby",
    "code": "def isalpha(c)\n  c.to_i.to_s != c\nend\n\ndef search(x, y, w, h, mat, values)\n  q = []\n  q << [x, y]\n  until q.empty?\n    px, py = q.shift\n    [[0, 1], [1, 0]].each do |mx, my|\n      x = px + mx; y = py + my\n      if x < w && y < h && mat[y][x]\n        if (old = values[y][x]) < (now = (values[py][px].to_s + mat[y][x]).to_i)\n          values[y][x] = now\n          q << [x, y] if old == 0\n        end\n      end\n    end\n  end\n  values\nend\n\ndef solve(w, h, mat)\n  values = h.times.map{ [0] * w }\n  h.times do |y|\n    w.times do |x|\n      if mat[y][x]\n        values[y][x] = mat[y][x].to_i if mat[y][x].to_i > values[y][x]\n        values = search(x, y, w, h, mat, values)\n      end\n    end\n  end\n  values.flatten.max\nend\n\n\nwhile l = gets\n  w, h = l.split.map(&:to_i)\n  break if w == 0 && h == 0\n  mat = h.times.map { gets.chomp }\n  mat.map!{ |m| m.split('').map{ |c| isalpha(c) ? false : c } }\n  puts solve(w, h, mat)\nend"
  },
  {
    "language": "Ruby",
    "code": "$x=0\n$y=0\n$bord = []\n$cnt = 0\n\n\ndef calc()\n\n\tmax = 0\n\tfor i in 0..$x-1\n\t\tfor j in 0..$y-1\n\t\t\tif $bord[j][i] != -1 then\n\t\t\t\tif j > 0 then\n\t\t\t\t\tup = $bord[j-1][i]\n\t\t\t\telse\n\t\t\t\t\tup = -1\n\t\t\t\tend\n\t\t\t\n\t\t\t\tif i > 0 then\n\t\t\t\t\tleft = $bord[j][i-1]\n\t\t\t\telse\n\t\t\t\t\tleft = -1\n\t\t\t\tend\n\n\t\t\t\n\t\t\t\tif up > left and up != -1 then\n\t\t\t\t\t$bord[j][i] += up * 10\n\t\t\t\t\t\n\t\t\t\telsif left != -1 then\n\t\t\t\t\t$bord[j][i] += left * 10\n\t\t\t\tend\n\t\t\t\tif $bord[j][i] > max then\n\t\t\t\t\tmax = $bord[j][i]\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\tend\n\treturn max\nend\n\t\nloop{\n\tline = gets\n\tif line==nil then\n\t\tbreak\n\tend\n\tsp = line.split(nil)\n\t\n\tif sp.count() != 2 then\n\t\tbreak\n\telse\n\t\t$x = sp[0].to_i()\n\t\t$y = sp[1].to_i()\n\t\tif $x == 0 and $y == 0 then\n\t\t\tbreak\n\t\tend\n\t\t\n\t\tsx = 0\n\t\tsy = 0\n\t\t$cnt = 1 \n\t\t$bord = Array.new($y).map{Array.new($x,0)}\n\t\tfor i in 0..$y-1\n\t\t\tline = gets\n\t\t\tfor j in 0..$x-1\n\t\t\t\ttmp = -1\n\t\t\t\tif line[j] =~ /\\d/ then\n\t\t\t\t\ttmp = line[j].to_i() \n\t\t\t\tend\n\t\t\t\t$bord[i][j] = tmp\n\t\t\tend\n\t\tend\n\t\tprint calc()\n\t\tprint(\"\\n\")\n\tend\n}"
  },
  {
    "language": "Ruby",
    "code": "### subroutines\n\ndef search_seq(x, y)\n  q = [[x, y, $grids[y][x]]]\n  max_seq = 0\n\n  while ! q.empty?\n    x0, y0, seq = q.shift\n    max_seq = seq if max_seq < seq\n\n    if x0 < $w - 1\n      d = $grids[y0][x0 + 1]\n      if d >= 0\n        q << [x0 + 1, y0, seq * 10 + d]\n      end\n    end\n    if y0 < $h - 1\n      d = $grids[y0 + 1][x0]\n      if d >= 0\n        q << [x0, y0 + 1, seq * 10 + d]\n      end\n    end\n  end\n\n  max_seq\nend\n\n### main\n\nloop do\n  $w, $h = gets.split.map(&:to_i)\n  break if ($w | $h) == 0\n\n  $grids = $h.times.map{[]}\n\n  for y in (0...$h)\n    line = gets.strip\n    for x in (0...$w)\n      case line[x]\n      when '0'..'9'\n        $grids[y][x] = line[x].to_i\n      else\n        $grids[y][x] = -1\n      end\n    end\n  end\n  #p $grids\n\n  max_seq = 0\n\n  for y in (0...$h)\n    for x in (0...$w)\n      if $grids[y][x] > 0\n        seq = search_seq(x, y)\n        max_seq = seq if max_seq < seq\n      end\n    end\n  end\n\n  puts max_seq\nend"
  },
  {
    "language": "Ruby",
    "code": "# The Secret Number from Aizu Online Judge\n\n# 漸化式:\n#    S(i, j) = max( S(i-1,j), S(i,j-1) ) D_ij if D_ij ∈ { 0,1,2,3,4,5,6,7,8,9 }\n#            = φ otherwise\n\ndef secret_number(w, h, matrix)\n  subsol = Array.new(h+1) { |i| Array.new(w+1) { |j| i*j==0 ? '' : nil } }\n  1.upto h do |i|\n    1.upto w do |j|\n      c = matrix[i-1][j-1]\n      subsol[i][j] = if c =~ /\\d/\n                       [subsol[i-1][j], subsol[i][j-1]].max_by(&:to_i) + c\n                     else\n                       ''\n                     end\n    end\n  end\n  subsol.map { |row| row.max_by(&:to_i) }.max_by(&:to_i).to_i\nend\n\n# ----------------------------------------\nloop do\n  w, h = gets.split.map(&:to_i)\n  break if [w,h] == [0,0]\n\n  matrix = h.times.map { gets.chomp.chars }\n  ans = secret_number(w, h, matrix)\n  puts ans\nend"
  },
  {
    "language": "Ruby",
    "code": "$x=0\n$y=0\n$bord = []\n$cnt = 0\n\n\ndef calc()\n\n\tmax = -1\n\tfor i in 1..$x-1\n\t\tfor j in 1..$y-1\n\t\t\tnow = $bord[j][i]\n\t\t\tup = $bord[j-1][i]\n\t\t\tleft = $bord[j][i-1]\n\t\t\tif now != -1 then\n\t\t\t\tif up > left and up != -1 then\n\t\t\t\t\t$bord[j][i] += up * 10\n\t\t\t\t\tif $bord[j][i] > max then\n\t\t\t\t\t\tmax = $bord[j][i]\n\t\t\t\t\tend\n\t\t\t\telsif left != -1 then\n\t\t\t\t\t$bord[j][i] += left * 10\n\t\t\t\t\tif $bord[j][i] > max then\n\t\t\t\t\t\tmax = $bord[j][i]\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\tend\n\treturn max\nend\n\t\nloop{\n\tline = gets\n\tif line==nil then\n\t\tbreak\n\tend\n\tsp = line.split(nil)\n\t\n\tif sp.count() != 2 then\n\t\tbreak\n\telse\n\t\t$x = sp[0].to_i()\n\t\t$y = sp[1].to_i()\n\t\tif $x == 0 and $y == 0 then\n\t\t\tbreak\n\t\tend\n\t\t\n\t\tsx = 0\n\t\tsy = 0\n\t\t$cnt = 1 \n\t\t$bord = Array.new($y).map{Array.new($x,0)}\n\t\tfor i in 0..$y-1\n\t\t\tline = gets\n\t\t\tfor j in 0..$x-1\n\t\t\t\ttmp = -1\n\t\t\t\tif line[j] =~ /\\d/ then\n\t\t\t\t\ttmp = line[j].to_i() \n\t\t\t\tend\n\t\t\t\t$bord[i][j] = tmp\n\t\t\tend\n\t\tend\n\t\tprint calc()\n\t\tprint(\"\\n\")\n\tend\n}"
  },
  {
    "language": "Ruby",
    "code": "$x=0\n$y=0\n$bord = []\n$cnt = 0\n\n\ndef calc()\n\n\tmax = -1\n\tfor i in 0..$x-1\n\t\tfor j in 0..$y-1\n\t\t\tif $bord[j][i] != -1 then\n\t\t\t\tif j > 0 then\n\t\t\t\t\tup = $bord[j-1][i]\n\t\t\t\telse\n\t\t\t\t\tup = -1\n\t\t\t\tend\n\t\t\t\n\t\t\t\tif i > 0 then\n\t\t\t\t\tleft = $bord[j][i-1]\n\t\t\t\telse\n\t\t\t\t\tleft = -1\n\t\t\t\tend\n\n\t\t\t\n\t\t\t\tif up > left and up != -1 then\n\t\t\t\t\t$bord[j][i] += up * 10\n\t\t\t\t\tif $bord[j][i] > max then\n\t\t\t\t\t\tmax = $bord[j][i]\n\t\t\t\t\tend\n\t\t\t\telsif left != -1 then\n\t\t\t\t\t$bord[j][i] += left * 10\n\t\t\t\t\tif $bord[j][i] > max then\n\t\t\t\t\t\tmax = $bord[j][i]\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\tend\n\treturn max\nend\n\t\nloop{\n\tline = gets\n\tif line==nil then\n\t\tbreak\n\tend\n\tsp = line.split(nil)\n\t\n\tif sp.count() != 2 then\n\t\tbreak\n\telse\n\t\t$x = sp[0].to_i()\n\t\t$y = sp[1].to_i()\n\t\tif $x == 0 and $y == 0 then\n\t\t\tbreak\n\t\tend\n\t\t\n\t\tsx = 0\n\t\tsy = 0\n\t\t$cnt = 1 \n\t\t$bord = Array.new($y).map{Array.new($x,0)}\n\t\tfor i in 0..$y-1\n\t\t\tline = gets\n\t\t\tfor j in 0..$x-1\n\t\t\t\ttmp = -1\n\t\t\t\tif line[j] =~ /\\d/ then\n\t\t\t\t\ttmp = line[j].to_i() \n\t\t\t\tend\n\t\t\t\t$bord[i][j] = tmp\n\t\t\tend\n\t\tend\n\t\tprint calc()\n\t\tprint(\"\\n\")\n\tend\n}"
  },
  {
    "language": "Ruby",
    "code": "def isalpha(c)\n  c.to_i.to_s != c\nend\n\ndef search(x, y, w, h, mat, values)\n  q = []\n  q << [x, y]\n  until q.empty?\n    px, py = q.shift\n    [[0, 1], [1, 0]].each do |mx, my|\n      x = px + mx; y = py + my\n      if x < w && y < h && mat[y][x]\n        if (old = values[y][x]) < (now = (values[py][px].to_s + mat[y][x]).to_i)\n          values[y][x] = now\n          q << [x, y] if old == 0\n        end\n      end\n    end\n  end\n  values\nend\n\ndef solve(w, h, mat)\n  values = h.times.map{ [0] * w }\n  h.times do |y|\n    w.times do |x|\n      if mat[y][x] && values[y][x] == 0\n        values[y][x] = mat[y][x].to_i\n        values = search(x, y, w, h, mat, values)\n      end\n    end\n  end\n  values.flatten.max\nend\n\n\nwhile l = gets\n  w, h = l.split.map(&:to_i)\n  break if w == 0 && h == 0\n  mat = h.times.map { gets.chomp }\n  mat.map!{ |m| m.split('').map{ |c| isalpha(c) ? false : c } }\n  puts solve(w, h, mat)\nend"
  },
  {
    "language": "Ruby",
    "code": "$x=0\n$y=0\n$bord = []\n\nloop{\n\tline = gets\n\tif line==nil then\n\t\tbreak\n\tend\n\tsp = line.split(nil)\n\t\n\tif sp.count() != 2 then\n\t\tbreak\n\telse\n\t\t$x = sp[0].to_i()\n\t\t$y = sp[1].to_i()\n\t\tif $x == 0 and $y == 0 then\n\t\t\tbreak\n\t\tend\n\t\t$bord = Array.new($y).map{Array.new($x,0)}\n\t\tmax = 0\n\t\tfor i in 0..$y-1\n\t\t\tline = gets\n\t\t\tleft = 0\n\t\t\tfor j in 0..$x-1\n\t\t\t\ttmp = -1\n\t\t\t\tif line[j] =~ /\\d/ then\n\t\t\t\t\ttmp = line[j].to_i() \n\t\t\t\t\tif i > 0 then\n\t\t\t\t\t\tup = $bord[i-1][j]\n\t\t\t\t\telse\n\t\t\t\t\t\tup = 0\n\t\t\t\t\tend\n\n\t\t\t\t\tif up > left then\n\t\t\t\t\t\ttmp += up * 10\t\t\t\t\t\n\t\t\t\t\telse\n\t\t\t\t\t\ttmp = left * 10 + tmp\n\t\t\t\t\tend\n\t\t\t\t\t\n\t\t\t\t\tif tmp > max then\n\t\t\t\t\t\tmax = tmp\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\t\t$bord[i][j] = tmp\n\t\t\t\tleft = tmp\n\t\t\tend\n\t\tend\n\t\tprint max\n\t\tprint(\"\\n\")\n\tend\n}"
  },
  {
    "language": "Ruby",
    "code": "def isalpha(c)\n  c.to_i.to_s != c\nend\n\ndef search(x, y, w, h, mat)\n  values = h.times.map{ [0] * w }\n  pre = h.times.map{ [-1] * w }  # 0 - left, 1 - up\n  values[y][x] = mat[y][x].to_i\n  pos = nil\n  q = []\n  q << [x, y]\n  until q.empty?\n    px, py = q.shift\n    pos = [px, py]\n    x = px + 1; y = py\n    if x < w && mat[y][x]\n      if (old = values[y][x]) < (now = (values[y][x - 1].to_s + mat[y][x]).to_i)\n        values[y][x] = now\n        pre[y][x] = 0\n        q << [x, y] if old == 0\n      end\n    end\n    x = px; y = py + 1\n    if y < h && mat[y][x]\n      if (old = values[y][x]) < (now = (values[y - 1][x].to_s + mat[y][x]).to_i)\n        values[y][x] = now\n        pre[y][x] = 1\n        q << [x, y] if old == 0\n      end\n    end\n  end\n  footprint = []\n  while pos[0] == x && pos[1] == y\n    footprint << pos\n    pos = pre[y][x] == 0 ? [x - 1, y] : [x, y - 1]\n  end\n  [values.flatten.max, footprint.reverse]\nend\n\ndef solve(w, h, mat)\n  ret = 0\n  route = []\n  h.times do |y|\n    w.times do |x|\n      if mat[y][x] && !route.include?([x, y])\n        n, footprint = search(x, y, w, h, mat)\n        if n > ret\n          ret = n\n          route = footprint\n        end\n      end\n    end\n  end\n  ret\nend\n\n\nwhile l = gets\n  w, h = l.split.map(&:to_i)\n  break if w == 0 && h == 0\n  mat = h.times.map { gets.chomp }\n  mat.map!{ |m| m.split('').map{ |c| isalpha(c) ? false : c } }\n  puts solve(w, h, mat)\nend"
  },
  {
    "language": "Ruby",
    "code": "### subroutines\n\ndef greater?(s0, s1)\n  sl0 = s0.length\n  sl1 = s1.length\n  sl0 > sl1 || (sl0 == sl1 && s0 > s1)\nend\n\n### main\n\nloop do\n  $w, $h = gets.split.map(&:to_i)\n  break if ($w | $h) == 0\n\n  $grids = $h.times.map{[]}\n\n  for y in (0...$h)\n    line = gets.strip\n    for x in (0...$w)\n      case line[x]\n      when '0'..'9'\n        $grids[y][x] = line[x]\n      else\n        $grids[y][x] = nil\n      end\n    end\n  end\n  #p $grids\n\n  max_seq = ''\n  dp = $h.times.map{$w.times.map{''}}\n\n  for y in (0...$h)\n    for x in (0...$w)\n      g = $grids[y][x]\n      next if g.nil?\n\n      seq = g\n\n      if x > 0\n        seq0 = dp[y][x - 1] + g\n        seq = seq0 if greater?(seq0, seq)\n      end\n      if y > 0\n        seq1 = dp[y - 1][x] + g\n        seq = seq1 if greater?(seq1, seq)\n      end\n\n      next if seq == '0'\n\n      dp[y][x] = seq\n      max_seq = seq if greater?(seq, max_seq)\n    end\n  end\n\n  puts max_seq\nend"
  },
  {
    "language": "Ruby",
    "code": "$x=0\n$y=0\n$bord = []\n$cnt = 0\n\n\ndef calc()\n\n\tmax = -1\n\tfor i in 1..$x-1\n\t\tif $bord[0][i] != -1 and $bord[0][i-1] != -1 then\n\t\t\t$bord[0][i] += $bord[0][i-1] * 10\n\t\tend\n\tend\n\t\n\tfor j in 1..$y-1\n\t\tif $bord[j][0] != -1 and $bord[j-1][0] != -1 then\n\t\t\t$bord[j][0] += $bord[j-1][0] * 10\n\t\tend\n\tend\n\t\n\tfor i in 1..$x-1\n\t\tfor j in 1..$y-1\n\t\t\tnow = $bord[j][i]\n\t\t\tup = $bord[j-1][i]\n\t\t\tleft = $bord[j][i-1]\n\t\t\tif now != -1 then\n\t\t\t\tif up > left and up != -1 then\n\t\t\t\t\t$bord[j][i] += up * 10\n\t\t\t\t\tif $bord[j][i] > max then\n\t\t\t\t\t\tmax = $bord[j][i]\n\t\t\t\t\tend\n\t\t\t\telsif left != -1 then\n\t\t\t\t\t$bord[j][i] += left * 10\n\t\t\t\t\tif $bord[j][i] > max then\n\t\t\t\t\t\tmax = $bord[j][i]\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\tend\n\treturn max\nend\n\t\nloop{\n\tline = gets\n\tif line==nil then\n\t\tbreak\n\tend\n\tsp = line.split(nil)\n\t\n\tif sp.count() != 2 then\n\t\tbreak\n\telse\n\t\t$x = sp[0].to_i()\n\t\t$y = sp[1].to_i()\n\t\tif $x == 0 and $y == 0 then\n\t\t\tbreak\n\t\tend\n\t\t\n\t\tsx = 0\n\t\tsy = 0\n\t\t$cnt = 1 \n\t\t$bord = Array.new($y).map{Array.new($x,0)}\n\t\tfor i in 0..$y-1\n\t\t\tline = gets\n\t\t\tfor j in 0..$x-1\n\t\t\t\ttmp = -1\n\t\t\t\tif line[j] =~ /\\d/ then\n\t\t\t\t\ttmp = line[j].to_i() \n\t\t\t\tend\n\t\t\t\t$bord[i][j] = tmp\n\t\t\tend\n\t\tend\n\t\tprint calc()\n\t\tprint(\"\\n\")\n\tend\n}"
  },
  {
    "language": "Ruby",
    "code": "$stack = []\n$cost=[]\n$x=0\n$y=0\n$bord = []\n$cnt = 0\n\n\ndef calc()\n\tfindpush()\n\tmax = -1\n\twhile $stack.size() != 0 do\n\t\t(nowx,nowy) = $stack.pop()\n\t\tc = $cost.pop()\n\t\tf = 0\n\t\tif $bord[nowy][nowx+1] != -1 then\n\t\t\t$stack.push([nowx+1,nowy])\n\t\t\t$cost.push(c * 10 + $bord[nowy][nowx+1])\n\t\t\tf += 1\n\t\tend\n\t\tif $bord[nowy+1][nowx] != -1 then\n\t\t\t$stack.push([nowx,nowy+1])\n\t\t\t$cost.push(c * 10 + $bord[nowy+1][nowx])\n\t\t\tf += 1\n\t\tend\n\t\tif f == 0 and max < c then\n\t\t\tmax = c\n\t\tend\n\tend\n\treturn max\nend\n\ndef findpush()\n\tflag = 1\n\tfor i in 0..$x-1\n\t\tif flag == 0 then\n\t\t\tif $bord[0][i] == -1 then  \n\t\t\t\tflag = 1\n\t\t\tend\n\t\t\tnext\n\t\tend\n\t\t\n\t\tif $bord[0][i] >= 0 then\n\t\t\t$stack.push([i,0])\n\t\t\t$cost.push($bord[0][i])\n\t\t\tflag = 0\n\t\tend\n\tend\n\t\n\tfor j in 1..$y-1\n\t\tif $bord[j][0] >= 0 then\n\t\t\tif $bord[j-1][0] == -1 then\n\t\t\t\t$stack.push([0,j])\n\t\t\t\t$cost.push($bord[j][0])\n\t\t\tend\n\t\tend\n\t\t\n\t\tfor i in 1..$x-1\n\t\t\tif $bord[j][i] >= 0 and $bord[j-1][i] == -1 and $bord[j][i-1] == -1 then\n\t\t\t\t$stack.push([i,j])\n\t\t\t\t$cost.push($bord[j][i])\n\t\t\tend\n\t\tend\n\tend\nend\n\ndef check(x,y)\n\ttmp = $bord[y][x]\n\tif tmp == 0 then\n\t\t$bord[y][x] = 2\n\t\t$stack.push([x,y])\n\t\t$cnt += 1\n\tend\nend\n\t\nloop{\n\tline = gets\n\tif line==nil then\n\t\tbreak\n\tend\n\tsp = line.split(nil)\n\t\n\tif sp.count() != 2 then\n\t\tbreak\n\telse\n\t\t$x = sp[0].to_i()\n\t\t$y = sp[1].to_i()\n\t\tif $x == 0 and $y == 0 then\n\t\t\tbreak\n\t\tend\n\t\t\n\t\tsx = 0\n\t\tsy = 0\n\t\t$cnt = 1 \n\t\t$bord = Array.new($y+1).map{Array.new($x+1,0)}\n\t\tfor i in 0..$y-1\n\t\t\tline = gets\n\t\t\t$bord[i][$x] = -1\n\t\t\tfor j in 0..$x-1\n\t\t\t\ttmp = -1\n\t\t\t\tif line[j] =~ /\\d/ then\n\t\t\t\t\ttmp = line[j].to_i() \n\t\t\t\tend\n\t\t\t\t$bord[i][j] = tmp\n\t\t\tend\n\t\tend\n\t\tfor j in 0..$x-1\n\t\t\t$bord[$y][j] = -1\t\n\t\tend\n\t\tprint calc()\n\t\tprint(\"\\n\")\n\tend\n}"
  },
  {
    "language": "Ruby",
    "code": "$x=0\n$y=0\n$bord = []\n$cnt = 0\n\n\ndef calc()\n\n\tmax = -1\n\tfor i in 1..$x-1\n\t\tif $bord[0][i] != -1 and $bord[0][i-1] != -1 then\n\t\t\t$bord[0][i] += $bord[0][i-1] * 10\n\t\t\tif $bord[0][i] > max then\n\t\t\t\tmax = $bord[0][i]\n\t\t\tend\n\t\tend\n\tend\n\t\n\tfor j in 1..$y-1\n\t\tif $bord[j][0] != -1 and $bord[j-1][0] != -1 then\n\t\t\t$bord[j][0] += $bord[j-1][0] * 10\n\t\t\tif $bord[j][0] > max then\n\t\t\t\tmax = $bord[j][0]\n\t\t\tend\n\t\tend\n\tend\n\t\n\tfor i in 1..$x-1\n\t\tfor j in 1..$y-1\n\t\t\tnow = $bord[j][i]\n\t\t\tup = $bord[j-1][i]\n\t\t\tleft = $bord[j][i-1]\n\t\t\tif now != -1 then\n\t\t\t\tif up > left and up != -1 then\n\t\t\t\t\t$bord[j][i] += up * 10\n\t\t\t\t\tif $bord[j][i] > max then\n\t\t\t\t\t\tmax = $bord[j][i]\n\t\t\t\t\tend\n\t\t\t\telsif left != -1 then\n\t\t\t\t\t$bord[j][i] += left * 10\n\t\t\t\t\tif $bord[j][i] > max then\n\t\t\t\t\t\tmax = $bord[j][i]\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\tend\n\treturn max\nend\n\t\nloop{\n\tline = gets\n\tif line==nil then\n\t\tbreak\n\tend\n\tsp = line.split(nil)\n\t\n\tif sp.count() != 2 then\n\t\tbreak\n\telse\n\t\t$x = sp[0].to_i()\n\t\t$y = sp[1].to_i()\n\t\tif $x == 0 and $y == 0 then\n\t\t\tbreak\n\t\tend\n\t\t\n\t\tsx = 0\n\t\tsy = 0\n\t\t$cnt = 1 \n\t\t$bord = Array.new($y).map{Array.new($x,0)}\n\t\tfor i in 0..$y-1\n\t\t\tline = gets\n\t\t\tfor j in 0..$x-1\n\t\t\t\ttmp = -1\n\t\t\t\tif line[j] =~ /\\d/ then\n\t\t\t\t\ttmp = line[j].to_i() \n\t\t\t\tend\n\t\t\t\t$bord[i][j] = tmp\n\t\t\tend\n\t\tend\n\t\tprint calc()\n\t\tprint(\"\\n\")\n\tend\n}"
  },
  {
    "language": "Ruby",
    "code": "loop do\n    w, h = gets.split.map(&:to_i)\n    break if w == 0 && h == 0\n    c = h.times.map{gets.strip}\n    dp = Array.new(h).map{Array.new(w,0)}\n    max = 0\n    c.each_with_index do |r,i|\n        r.each_char.with_index do |ch, j|\n            next if ch.to_s.match(/[A-Z]/)\n            if i == 0\n                if j == 0\n                    dp[i][j] = ch.to_i\n                else\n                    dp[i][j] = (dp[i][j-1].to_s + ch).to_i\n                end\n            else\n                if j == 0\n                    dp[i][j] = (dp[i-1][j].to_s + ch).to_i\n                else\n                    dp[i][j] = ([dp[i-1][j], dp[i][j-1]].max.to_s + ch).to_i\n                end\n            end\n        end\n        max = [max, dp[i].max].max\n    end\n    puts max\nend"
  },
  {
    "language": "Ruby",
    "code": "$x=0\n$y=0\n$bord = []\n$cnt = 0\n\n\ndef calc()\n\n\tmax = -1\n\tfor i in 0..$x-1\n\t\tfor j in 0..$y-1\n\t\t\tif $bord[j][i] != -1 then\n\t\t\t\tif j > 0 then\n\t\t\t\t\tup = $bord[j-1][i]\n\t\t\t\telse\n\t\t\t\t\tup = -1\n\t\t\t\tend\n\t\t\t\n\t\t\t\tif i > 0 then\n\t\t\t\t\tleft = $bord[j][i-1]\n\t\t\t\telse\n\t\t\t\t\tleft = -1\n\t\t\t\tend\n\n\t\t\t\n\t\t\t\tif up > left and up != -1 then\n\t\t\t\t\t$bord[j][i] += up * 10\n\t\t\t\t\tif $bord[j][i] > max then\n\t\t\t\t\t\tmax = $bord[j][i]\n\t\t\t\t\tend\n\t\t\t\telsif left != -1 then\n\t\t\t\t\t$bord[j][i] += left * 10\n\t\t\t\t\tif $bord[j][i] > max then\n\t\t\t\t\t\tmax = $bord[j][i]\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\tend\n\treturn max\nend\n\t\nloop{\n\tline = gets\n\tif line==nil then\n\t\tbreak\n\tend\n\tsp = line.split(nil)\n\t\n\tif sp.count() != 2 then\n\t\tbreak\n\telse\n\t\t$x = sp[0].to_i()\n\t\t$y = sp[1].to_i()\n\t\tif $x == 0 and $y == 0 then\n\t\t\tbreak\n\t\tend\n\t\t\n\t\tsx = 0\n\t\tsy = 0\n\t\t$cnt = 1 \n\t\t$bord = Array.new($y).map{Array.new($x,0)}\n\t\tfor i in 0..$y-1\n\t\t\tline = gets\n\t\t\tfor j in 0..$x-1\n\t\t\t\ttmp = -1\n\t\t\t\tif line[j] =~ /\\d/ then\n\t\t\t\t\ttmp = line[j].to_i() \n\t\t\t\tend\n\t\t\t\t$bord[i][j] = tmp\n\t\t\tend\n\t\tend\n\t\tprint calc()\n\t\tprint(\"\\n\")\n\tend\n}"
  },
  {
    "language": "Ruby",
    "code": "$x=0\n$y=0\n$bord = []\n\nloop{\n\tline = gets\n\tif line==nil then\n\t\tbreak\n\tend\n\tsp = line.split(nil)\n\t\n\tif sp.count() != 2 then\n\t\tbreak\n\telse\n\t\t$x = sp[0].to_i()\n\t\t$y = sp[1].to_i()\n\t\tif $x == 0 and $y == 0 then\n\t\t\tbreak\n\t\tend\n\t\t$bord = Array.new($y).map{Array.new($x,0)}\n\t\tmax = 0\n\t\tfor i in 0..$y-1\n\t\t\tline = gets\n\t\t\tleft = 0\n\t\t\tfor j in 0..$x-1\n\t\t\t\ttmp = 0\n\t\t\t\tif line[j] =~ /\\d/ then\n\t\t\t\t\ttmp = line[j].to_i() \n\t\t\t\t\tif i > 0 then\n\t\t\t\t\t\tup = $bord[i-1][j]\n\t\t\t\t\telse\n\t\t\t\t\t\tup = 0\n\t\t\t\t\tend\n\n\t\t\t\t\tif up > left then\n\t\t\t\t\t\ttmp += up * 10\t\t\t\t\t\n\t\t\t\t\telse\n\t\t\t\t\t\ttmp += left * 10\n\t\t\t\t\tend\n\t\t\t\t\t\n\t\t\t\t\tif tmp > max then\n\t\t\t\t\t\tmax = tmp\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\t\t$bord[i][j] = tmp\n\t\t\t\tleft = tmp\n\t\t\tend\n\t\tend\n\t\tprint max\n\t\tprint(\"\\n\")\n\tend\n}"
  },
  {
    "language": "Ruby",
    "code": "loop {\n    w, h = gets.split.map &:to_i\n    break if w == 0\n    max = (1..h).map{ gets.split(\"\").map{|s| s =~ /\\d/ ? s.to_i : -1} }\n    \n    opt = 0 \n    (0..h-1).each{|i|\n        (0..w-1).each{|j|\n            next if max[i][j] < 0 \n            m = 0 \n            m = max[i-1][j] if i > 0 && max[i-1][j] > m \n            m = max[i][j-1] if j > 0 && max[i][j-1] > m \n            max[i][j] += 10 * m \n            opt = max[i][j] if max[i][j] > opt \n        }\n    }   \n    p opt \n}"
  },
  {
    "language": "D",
    "code": "import std.stdio;\nimport std.bigint;\nimport std.conv;\nimport std.string;\n\nstring[] c;\nbool isNumber[][];\nBigInt dp[][];\n\nvoid main()\n{\n  int w,h;\n  string[] input;\n  while(true){\n    input=readln.split;\n    w=input[0].to!int;\n    h=input[1].to!int;\n    if((w|h)==0)break;\n    c=new string[h];\n    isNumber=new bool[][h];\n    dp=new BigInt[][h];\n    for(int i=0;i<h;i++){\n      c[i]=readln;\n      isNumber[i]=new bool[w];\n      dp[i]=new BigInt[w];\n      for(int j=0;j<w;j++)\n\tisNumber[i][j]=('0'<=c[i][j]&&c[i][j]<='9');\n    }\n    dp[0][0]=isNumber[0][0]?c[0][0]-'0':0;\n    BigInt max=dp[0][0];\n    for(int i=1;i<h;i++){\n      if(!isNumber[i][0]){\n\tdp[i][0]=0;\n\tcontinue;\n      }\n      dp[i][0]=dp[i-1][0]*10+(c[i][0]-'0');\n      max=dp[i][0]>max?dp[i][0]:max;\n    }\n    for(int j=1;j<w;j++){\n      if(!isNumber[0][j]){\n\tdp[0][j]=0;\n\tcontinue;\n      }\n      dp[0][j]=dp[0][j-1]*10+(c[0][j]-'0');\n      max=dp[0][j]>max?dp[0][j]:max;\n    }\n    for(int i=1;i<h;i++){\n      for(int j=1;j<w;j++){\n\tif(!isNumber[i][j]){\n\t  dp[i][j]=0;\n\t  continue;\n\t}\n\tBigInt localmax=dp[i-1][j]>dp[i][j-1]?dp[i-1][j]:dp[i][j-1];\n\tdp[i][j]=localmax*10+(c[i][j]-'0');\n\tmax=dp[i][j]>max?dp[i][j]:max;\n      }\n    }\n\n    writeln(max);\n  }\n}"
  },
  {
    "language": "Python",
    "code": "import sys\nfrom collections import deque\n\nW,H,C = None,None,None\nmmax = None\n\ndef main():\n    global W,H,C,mmax\n\n    while True:\n        W,H = map(int,input().split())\n        if not W and not H:\n            return\n        C = []\n        mmax = [[-1]*(W+1) for _ in range(H+1)]\n        for _ in range(H):\n            C.append(list(input()))\n        # visualize(C)\n\n        num = 0\n\n        # for i in range(H):\n        #     for j in range(W):\n        #         if mmax[i][j] != -1:\n        #             continue\n        #         print(\"------\", i, j, \"--------\")\n        #         num = max(num, bfs(i,j))\n\n        for i in reversed(range(H)):\n            for j in reversed(range(W)):\n                if mmax[i][j] != -1:\n                    continue\n                num = max(num, bfs(i,j))\n        \n        print(num)\n\n\ndef bfs(y,x):\n    global W,H,C,mmax\n\n    if not C[y][x].isdigit():\n        return 0\n\n    l = []\n    queue = deque(l)\n    dd = [(0,-1), (-1,0)]\n    num = 0\n\n    queue.appendleft((C[y][x],(y,x)))\n    mmax[y][x] = int(C[y][x])\n\n    while len(queue) != 0:\n        s, (uy,ux) = queue.pop()\n        for dy,dx in dd:\n            vy,vx = uy+dy, ux+dx\n            if not (0 <= vy < H and 0 <= vx < W):\n                num = max(num, mmax[uy][ux])\n                continue\n            if C[vy][vx].isdigit():\n                n = int(C[vy][vx]+s)\n                if mmax[vy][vx] < n:\n                    queue.appendleft((C[vy][vx]+s, (vy,vx)))\n                    mmax[vy][vx] = n\n            else:\n                num = max(num, mmax[uy][ux])\n\n    return num\n\n\n# def bfs(y,x): # h w\n#     global W,H,C,mmax\n\n#     if not C[y][x].isdigit():\n#         return 0\n\n#     l = []\n#     queue = deque(l)\n#     dd = [(0,1), (1,0)]\n#     num = 0\n\n#     queue.appendleft((C[y][x],(y,x)))\n#     mmax[y][x] = int(C[y][x])\n\n#     while len(queue) != 0:\n#         print(len(queue))\n#         s, (uy,ux) = queue.pop()\n#         for dy,dx in dd:\n#             vy,vx = uy+dy, ux+dx\n#             if not (0 <= vy < H and 0 <= vx < W):\n#                 num = max(num, mmax[uy][ux])\n#                 continue\n#             if C[vy][vx].isdigit():\n#                 n = int(s+C[vy][vx])\n#                 if mmax[vy][vx] < n:\n#                     queue.appendleft((s+C[vy][vx], (vy,vx)))\n#                     mmax[vy][vx] = n\n#             else:\n#                 num = max(num, mmax[uy][ux])\n\n#     return num\n\n\ndef visualize(mmap):\n    for row in mmap:\n        print(\" \".join(row))\n\n            \n\nif __name__ == '__main__':\n    main()\n"
  },
  {
    "language": "Python",
    "code": "import string\n\ndef fun(x):\n    for c in x:\n        if c not in string.digits:\n            return -1\n    return int(x)\n\nwhile(1):\n    [W,H]=map(int, raw_input().split())\n    if W==0: break\n    A=[]\n    for i in range(H):\n        A.append(raw_input())\n    B=[['a' for i in range(W+1)] for j in range(H+1)]\n    ans=-1\n    for p in range(2, H+2):\n        for q in range(2, W+2):\n            [j,k]=[-p,-q]\n            C= map(lambda x: A[j+1][k+1]+x, ['', B[j+1][k] , B[j][k+1] ]    )\n            D=sorted(sorted(C, key = lambda x: len(x) ), key= lambda x: fun(x)) [-1]\n            if fun(D)!=-1:\n                B[j][k]=D\n                ans=max(ans,int(B[j][k]))\n    print ans"
  },
  {
    "language": "Python",
    "code": "# -*- coding: utf-8 -*-\n\ndef recursion(y, x, island, dp):\n    if island[y][x].isdigit() and int(island[y][x]) in range(10):        \n        if y == 0 and x == 0:\n            dp[y][x] = int(island[y][x])\n        elif y == 0:\n            if dp[y][x-1] != -1:\n                dp[y][x] = dp[y][x-1] * 10 + int(island[y][x])\n            else:\n                dp[y][x] = int(island[y][x])\n        elif x == 0:\n            if dp[y-1][x] != -1:\n                dp[y][x] = dp[y-1][x] * 10 + int(island[y][x])\n            else:\n                dp[y][x] = int(island[y][x])\n        else:\n            dp[y][x] = max(dp[y][x-1] * 10 + int(island[y][x]), dp[y-1][x] * 10 + int(island[y][x]))\n    else:\n        dp[y][x] = -1\n        \ndef solve(w, h, island, dp):\n    for i in range(h):\n        for j in range(w):\n            recursion(i, j, island, dp)\n    print max(map(max, dp))\n\ndef func():\n    '''\n\n    '''\n    while True:\n        global count\n        w, h = map(int, raw_input().split())\n\n        if w == 0 and h == 0:\n            break\n\n        island = []\n        count = 0\n        for i in range(h):\n            row = []\n            line = raw_input()\n            for j in line:\n                row.append(j)\n            island.append(row)\n        \n        dp = []\n        for i in range(h):\n            dp_row = []\n            for j in range(w):\n                dp_row.append(0)\n            dp.append(dp_row)\n        solve(w, h, island, dp)\n\nif __name__ == '__main__':\n    func()\n    "
  },
  {
    "language": "Python",
    "code": "def solve():\n    global Map, w, h\n    dp=[['']*w]*h\n    res=''\n\n    def nozero(st):\n        return st.lstrip('0')\n\n    #whats the difference from max(str1,str2)??\n    def maxs(s1, s2):\n        if len(s1) > len(s2): return s1\n        elif len(s1) < len(s2): return s2\n \n        if s1 > s2: return s1\n        else: return s2\n\n    for i in range(h):\n        for j in range(w):\n            if(Map[i][j].isalpha()):continue\n            '''\n                if(0<=i-1<h and (Map[i-1][x].isdigit() and  dp[i-1][j]) and (0<=j-1<w and Map[i][j-1].isdigit() and dp[i][j-1])):\n                    tmp1=dp[i-1][j]+Map[i][j]\n                    tmp2=dp[i][j-1]+Map[i][j]\n                    dp[i][j]=max(tmp1,tmp2)\n\n                    res=max(res,dp[i][j])\n                    continue\n            '''\n            if(0<j):\n                dp[i][j]=maxs(dp[i][j-1],dp[i][j])\n                    \n\n            if(0<i):\n                dp[i][j]=maxs(dp[i-1][j],dp[i][j])\n                    \n            dp[i][j]+=Map[i][j]\n            if ('0' in dp[i][j]):dp[i][j]=nozero(dp[i][j])\n            res=maxs(res,dp[i][j])\n\n    return res\n\nwhile(True):\n    Map=[]\n    w,h=map(int,raw_input().split(' '))\n    if (w==0 and h==0):break\n    for i in range(h):\n        Map.append(list(raw_input()))\n\n    print solve()"
  },
  {
    "language": "Python",
    "code": "while 1:\n\tW, H = map(int,raw_input().split(\" \"))\n\tif W == H == 0: \n\t\tbreak\n\tfield = [[c for c in raw_input()] for _ in range(H)]\n\tsecret = [0, \"\"]\n\tfor j in range(H):\n\t\tfor i in range(W):\n\t\t\tif not field[j][i].isdigit():\n\t\t\t\tcontinue\n\t\t\tleft = top = \"\"\n\t\t\tif i > 0 and field[j][i-1].isdigit() and field[j][i-1] != \"0\":\n\t\t\t\tleft = field[j][i-1]\n\t\t\tif j > 0 and field[j-1][i].isdigit() and field[j-1][i] != \"0\":\n\t\t\t\ttop = field[j-1][i]\n\t\t\tif len(left) == len(top):\n\t\t\t\tfield[j][i] = (left if left > top else top) + field[j][i]\n\t\t\telse :\n\t\t\t\tfield[j][i] = (left if len(left) > len(top) else top) + field[j][i]\n\t\t\tlength = len(field[j][i])\n\t\t\tif length > secret[0]:\n\t\t\t\tsecret[1] = field[j][i]\n\t\t\t\tsecret[0] = length\n\t\t\telif length == secret[0] and field[j][i] > secret[1]:\n\t\t\t\tsecret[1] = field[j][i]\n\tprint secret[1]"
  },
  {
    "language": "Python",
    "code": "#!usr/bin/env python3\nfrom collections import defaultdict,deque\nfrom heapq import heappush, heappop\nimport sys\nimport math\nimport bisect\nimport random\ndef LI(): return list(map(int, sys.stdin.readline().split()))\ndef I(): return int(sys.stdin.readline())\ndef LS():return list(map(list, sys.stdin.readline().split()))\ndef S(): return list(sys.stdin.readline())[:-1]\ndef IR(n):\n    return [I() for i in range(n)]\ndef LIR(n):\n    return [LI() for i in range(n)]\ndef SR(n):\n    return [S() for i in range(n)]\ndef LSR(n):\n    return [LS() for i in range(n)]\n\nsys.setrecursionlimit(1000000)\nmod = 1000000007\n\n#2005_c\n\"\"\"\nn = int(input())\nk = list(\"mcxi\")\nfor i in range(n):\n    d = {\"m\":0,\"c\":0,\"x\":0,\"i\":0}\n    a,b  = input().split()\n    a = list(a)\n    b = list(b)\n    a.insert(0,1)\n    b.insert(0,1)\n    for j in range(1,len(a)):\n        if a[j] in k:\n            if a[j-1] in k:\n                d[a[j]] += 1\n            else:\n                d[a[j]] += int(a[j-1])\n    for j in range(1,len(b))[::-1]:\n        if b[j] in k:\n            if b[j-1] in k:\n                d[b[j]] += 1\n            else:\n                d[b[j]] += int(b[j-1])\n            if d[b[j]] >= 10:\n                l = b[j]\n                while d[l] >= 10:\n                    d[l] -= 10\n                    l = k[k.index(l)-1]\n                    d[l] += 1\n    for j in k:\n        if d[j]:\n            if d[j] == 1:\n                print(j,end = \"\")\n            else:\n                print(str(d[j])+j,end = \"\")\n    print()\n\"\"\"\n\n#2017_c\n\"\"\"\nwhile 1:\n    h, w = map(int, input().split())\n    if h == w == 0:\n        break\n    s = [list(map(int, input().split())) for i in range(h)]\n\n    ans = 0\n    for u in range(h):\n        for d in range(u+2,h):\n            for l in range(w):\n                for r in range(l+2,w):\n                    m = float(\"inf\")\n                    for i in range(u,d+1):\n                        m = min(m,s[i][l],s[i][r])\n                    for i in range(l,r+1):\n                        m = min(m,s[u][i],s[d][i])\n                    f = 1\n                    su = 0\n                    for i in range(u+1,d):\n                        for j in range(l+1,r):\n                            su += (m-s[i][j])\n                            if s[i][j] >= m:\n                                f = 0\n                                break\n                        if not f:\n                            break\n                    if f:\n                        ans = max(ans,su)\n    print(ans)\n\"\"\"\n\n#2016_c\n\"\"\"\nwhile 1:\n    m,n = map(int, input().split())\n    if m == n == 0:\n        break\n    ma = 7368791\n    d = [0]*(ma+1)\n    z = m\n    for i in range(n):\n        while d[z]:\n            z += 1\n        j = z\n        while j <= ma:\n            d[j] = 1\n            j += z\n    for j in range(z,ma+1):\n        if not d[j]:\n            print(j)\n            break\n\"\"\"\n\n#2018_c\n\"\"\"\ndef factorize(n):\n    if n < 4:\n        return [1,n]\n    i = 2\n    l = [1]\n    while i**2 <= n:\n        if n%i == 0:\n            l.append(i)\n            if n//i != i:\n                l.append(n//i)\n        i += 1\n    l.append(n)\n    l.sort()\n    return l\nwhile 1:\n    b = int(input())\n    if b == 0:\n        break\n    f = factorize(2*b)\n    for n in f[::-1]:\n        a = 1-n+(2*b)//n\n        if a >= 1 and a%2 == 0:\n            print(a//2,n)\n            break\n\"\"\"\n\n#2010_c\n\"\"\"\nimport sys\ndp = [100]*1000000\ndp_2 = [100]*1000000\ndp[0] = 0\ndp_2[0] = 0\nfor i in range(1,181):\n    s = i*(i+1)*(i+2)//6\n    for j in range(s,1000000):\n        if dp[j-s]+1 < dp[j]:\n            dp[j] = dp[j-s]+1\n    if s%2:\n        for j in range(s,1000000):\n            if dp_2[j-s]+1 < dp_2[j]:\n                dp_2[j] = dp_2[j-s]+1\nwhile 1:\n    m = int(sys.stdin.readline())\n    if m == 0:\n        break\n    print(dp[m],dp_2[m])\n\"\"\"\n\n#2015_c\n\"\"\"\nfrom collections import deque\nwhile 1:\n    n = int(input())\n    if n == 0:\n        break\n    s = [input() for i in range(n)]\n    d = [s[i].count(\".\") for i in range(n)]\n    m = max(d)\n    c = [s[i][-1] for i in range(n)]\n    q = deque()\n    for i in range(1,m+1)[::-1]:\n        j = 0\n        while j < n:\n            for k in range(j,n):\n                if d[k] == i:break\n            else:\n                break\n            j = k\n            op = c[j-1]\n            while j < n and d[j] == i:\n                q.append(j)\n                j += 1\n            j = k\n            if op == \"+\":\n                k = 0\n                while q:\n                    x = q.pop()\n                    k += int(c[x])\n                    c.pop(x)\n                    d.pop(x)\n                    n -= 1\n            else:\n                k = 1\n                while q:\n                    x = q.pop()\n                    k *= int(c[x])\n                    c.pop(x)\n                    d.pop(x)\n                    n -= 1\n            c[j-1] = k\n    print(c[0])\n\"\"\"\n\n#2013_c\n\"\"\"\nfrom collections import defaultdict\n\ndef parse_expr(s,i):\n    i += 1\n    if s[i] == \"[\":\n        q = []\n        while s[i] != \"]\":\n            e,i = parse_expr(s,i)\n            q.append(e)\n        return (calc(q),i+1)\n    else:\n        n,i = parse_num(s,i)\n        return (calc([n]),i+1)\n\ndef parse_num(s,i):\n    m = int(s[i])\n    i += 1\n    while f_num[s[i]]:\n        m *= 10\n        m += int(s[i])\n        i += 1\n    return (m,i)\n\ndef calc(q):\n    if len(q) == 1:\n        return (q[0]+1)//2\n    q.sort()\n    return sum(q[:len(q)//2+1])\n\nf_num = defaultdict(lambda : 0)\nfor i in range(10):\n    f_num[str(i)] = 1\n\nn = int(input())\nfor i in range(n):\n    s = input()\n    print(parse_expr(s,0)[0])\n\"\"\"\n\n#2003_C\nwhile 1:\n    w,h = LI()\n    if w == h == 0:\n        break\n    s = SR(h)\n    dp = [[0]*w for i in range(h)]\n    for y in range(h):\n        for x in range(w):\n            if s[y][x].isdecimal():\n                dp[y][x] = max(dp[y-1][x],dp[y][x-1])*10+int(s[y][x])\n    ans = 0\n    for i in dp:\n        ans = max(ans,max(i))\n    print(ans)\n\n"
  },
  {
    "language": "Python",
    "code": "# coding: utf-8\ndef check(a,b):\n    if (a,b) in memo:\n        return memo[(a,b)]\n    if 0<=a<h and 0<=b<w and field[a][b].isdigit():\n        x=check(a+1,b)\n        y=check(a,b+1)\n        memo[(a,b)]=field[a][b]+(x if len(x)>len(y) else x if len(x)==len(y) and len(x)!=0 and int(x)>int(y) else y)\n        return field[a][b]+(x if len(x)>len(y) else x if len(x)==len(y) and len(x)!=0 and int(x)>int(y) else y)\n    else:\n        return ''\nwhile 1:\n    w,h=map(int,input().split())\n    if w==0:\n        break\n    field=[]\n    for i in range(h):\n        field.append(list(input()))\n    ans='0'\n    memo={}\n    for i in range(h):\n        for j in range(w):\n            if field[i][j]!='0' and field[i][j].isdigit():\n                tmp=check(i,j)\n                if int(ans)<int(tmp):\n                    ans=tmp\n    print(ans)\n"
  },
  {
    "language": "Python",
    "code": "while 1:\n\tW, H = map(int,raw_input().split(\" \"))\n\tif W == H == 0: \n\t\tbreak\n\tfield = [[c for c in raw_input()] for _ in range(H)]\n\tsecret = [0, \"\"]\n\tfor j in range(H):\n\t\tfor i in range(W):\n\t\t\tif not field[j][i].isdigit():\n\t\t\t\tcontinue\n\t\t\tpre = left = top = \"\"\n\t\t\tif i > 0 and field[j][i-1].isdigit() and field[j][i-1] != \"0\":\n\t\t\t\tleft = field[j][i-1]\n\t\t\tif j > 0 and field[j-1][i].isdigit() and field[j-1][i] != \"0\":\n\t\t\t\ttop = field[j-1][i]\n\t\t\tif len(left) == len(top):\n\t\t\t\tpre = left if left > top else top\n\t\t\telse :\n\t\t\t\tpre = left if len(left) > len(top) else top\n\t\t\tfield[j][i] = pre + field[j][i]\n\t\t\tlength = len(field[j][i])\n\t\t\tif length > secret[0]:\n\t\t\t\tsecret[1] = field[j][i]\n\t\t\t\tsecret[0] = length\n\t\t\telif length == secret[0] and field[j][i] < secret[1]:\n\t\t\t\tsecret[1] = field[j][i]\n\tprint secret[1]"
  },
  {
    "language": "Python",
    "code": "#whats the difference with max(st1,st2)\ndef maxs(s1, s2):\n    if len(s1) > len(s2): return s1\n    elif len(s1) < len(s2): return s2\n        \n    if s1 > s2: return s1\n    else: return s2\n\ndef nozero(st):\n    return st.lstrip('0')\n\nwhile True:\n    Map=[]\n    w,h=map(int,raw_input().split(' '))\n    if (w==0 and h==0):break\n    for i in range(h):\n        Map.append(raw_input())\n\n    res=''\n    #always init 2d list this way\n    dp=[['' for __ in range(w)] for __ in range(h)]\n\n    for i in range(h):\n        for j in range(w):\n            if(Map[i][j].isalpha()):\n                continue\n\n            if j>0:\n                dp[i][j]=maxs(dp[i][j],dp[i][j-1])\n\n            if i>0:\n                dp[i][j]=maxs(dp[i][j],dp[i-1][j])\n                    \n            dp[i][j]+=Map[i][j]\n            if ('0' in dp[i][j]):dp[i][j]=nozero(dp[i][j])\n            if dp[i][j] is '0':dp[i][j]=''\n            res=maxs(res,dp[i][j])\n\n\n    print res"
  },
  {
    "language": "Python",
    "code": "# -*- coding: utf-8 -*-\n# python template for atcoder1\nimport sys\nsys.setrecursionlimit(10**9)\ninput = sys.stdin.readline\n\n\ndef isdigit(x):\n    return '0' <= x <= '9'\n\n\ndef solve():\n    W, H = map(int, input().split())\n    if W == 0:\n        exit()\n    grid = [[v for v in input()[:-1]] for _ in range(H)]\n    dp = [[-1]*W for _ in range(H)]\n\n    max_val = 0\n    for row in range(H):\n        for col in range(W):\n            if isdigit(grid[row][col]):\n                if row > 0 and col > 0:\n                    cand = max(dp[row-1][col], dp[row][col-1], 0)\n                elif row == 0 and col == 0:\n                    cand = 0\n                elif row == 0:\n                    cand = max(dp[row][col-1], 0)\n                elif col == 0:\n                    cand = max(dp[row-1][col], 0)\n\n                dp[row][col] = cand*10+int(grid[row][col])\n\n                max_val = max(max_val, dp[row][col])\n\n    print(max_val)\n\n\nwhile True:\n    solve()\n\n"
  },
  {
    "language": "Python",
    "code": "while 1:\n\tW, H = map(int,raw_input().split(\" \"))\n\tif W == H == 0: \n\t\tbreak\n\tfield = [[c for c in raw_input()] for _ in range(H)]\n\tsecret = [0, \"\"]\n\tfor j in range(H):\n\t\tfor i in range(W):\n\t\t\tif not (field[j][i].isdigit() and field[j][i] != \"0\"):\n\t\t\t\tcontinue\n\t\t\tpre = left = top = \"\"\n\t\t\tif i > 0 and field[j][i-1].isdigit() and field[j][i-1] != \"0\":\n\t\t\t\tleft = field[j][i-1]\n\t\t\tif j > 0 and field[j-1][i].isdigit() and field[j-1][i] != \"0\":\n\t\t\t\ttop = field[j-1][i]\n\t\t\tif len(left) == len(top):\n\t\t\t\tpre = left if left > top else top\n\t\t\telse :\n\t\t\t\tpre = left if len(left) > len(top) else top\n\t\t\tfield[j][i] = pre + field[j][i]\n\t\t\tlength = len(field[j][i])\n\t\t\tif length > secret[0]:\n\t\t\t\tsecret[1] = field[j][i]\n\t\t\t\tsecret[0] = length\n\t\t\telif length == secret[0] and field[j][i] < secret[1]:\n\t\t\t\tsecret[1] = field[j][i]\n\tprint secret[1]"
  },
  {
    "language": "Python",
    "code": "import sys\nimport collections\n\nwhile True:\n    W, H = map(int, sys.stdin.readline().split())\n    if W == 0:\n        break\n    area = [[-10**80 for i in xrange(H + 2)] for j in xrange(W + 2)]\n    result = -1\n    for i in xrange(H):\n        line = sys.stdin.readline().strip()\n        for j in xrange(W):\n            if '0' <= line[j] <= '9':\n                area[j + 1][i + 1] = int(line[j])\n    for i in xrange(H):\n        for j in xrange(W):\n            area[j + 1][i + 1] = max(area[j + 1][i + 1], area[j + 1][i + 1] + area[j + 1][i] * 10, area[j + 1][i + 1] + area[j][i + 1] * 10)\n            result = max(result, area[j + 1][i + 1])\n    print result"
  },
  {
    "language": "Python",
    "code": "mv=((1,0),(0,1))\n\ndef dfs(x,y,ans):\n    global res\n    ans=max(ans,int(str(ans)+C[y][x]))\n    res=max(ans,res)\n    for dx,dy in mv:\n        mx=x+dx\n        my=y+dy\n        if mx<0 or mx>=W or my<0 or my>=H:\n            continue\n        if C[my][mx].isdigit():\n            dfs(mx,my,ans)\n\nwhile True:\n    W,H=map(int,raw_input().split())\n    if W==H==0:break\n    C=[raw_input() for i in range(H)]\n    res=0\n    for i in range(H):\n        for j in range(W):\n            if C[i][j].isdigit() and C[i][j]!=\"0\":\n                dfs(j,i,0)\n    print res"
  },
  {
    "language": "Python",
    "code": "# AOJ 1126: The Secret Number\n# Python3 2018.7.16 bal4u\n\nwhile True:\n\tW, H = map(int, input().split())\n\tif W == 0: break\n\td = [list(input()) for r in range(H)]\n\ta = [[0 for c in range(W)] for r in range(H)]\n\tans = 0\n\tfor r in range(H):\n\t\tfor c in range(W):\n\t\t\tif not d[r][c].isdigit(): continue\n\t\t\ta[r][c] = k = int(d[r][c])\n\t\t\tif c > 0 and d[r][c-1].isdigit():\n\t\t\t\ta[r][c] = a[r][c-1]*10 + k\n\t\t\tif r > 0 and d[r-1][c].isdigit():\n\t\t\t\tt = a[r-1][c]*10 + k\n\t\t\t\ta[r][c] = max(a[r][c], t)\n\t\t\tans = max(ans, a[r][c])\n\tprint(ans);\n\n"
  },
  {
    "language": "Python",
    "code": "while 1:\n\tW, H = map(int,raw_input().split(\" \"))\n\tif W == H == 0: \n\t\tbreak\n\tfield = [[c for c in raw_input()] for _ in range(H)]\n\tsecret = [0, \"\"]\n\tfor j in range(H):\n\t\tfor i in range(W):\n\t\t\tif not field[j][i].isdigit():\n\t\t\t\tcontinue\n\t\t\tpre = left = top = \"\"\n\t\t\tif i > 0 and field[j][i-1].isdigit() and field[j][i-1] != \"0\":\n\t\t\t\tleft = field[j][i-1]\n\t\t\tif j > 0 and field[j-1][i].isdigit() and field[j-1][i] != \"0\":\n\t\t\t\ttop = field[j-1][i]\n\t\t\tif len(left) == len(top):\n\t\t\t\tpre = left if left > top else top\n\t\t\telse :\n\t\t\t\tpre = left if len(left) > len(top) else top\n\t\t\tfield[j][i] = pre + field[j][i]\n\t\t\tlength = len(field[j][i])\n\t\t\tif length > secret[0]:\n\t\t\t\tsecret[1] = field[j][i]\n\t\t\t\tsecret[0] = length\n\t\t\telif length == secret[0] and field[j][i] > secret[1]:\n\t\t\t\tsecret[1] = field[j][i]\n\tprint secret[1]"
  },
  {
    "language": "Python",
    "code": "def solve():\n    global Map, w, h\n    dp=[['']*w]*h\n    res=''\n\n    def nozero(st):\n        return st.lstrip('0')\n\n    #whats the difference from max(str1,str2)??\n    def maxs(s1, s2):\n        if len(s1) > len(s2): return s1\n        elif len(s1) < len(s2): return s2\n \n        if s1 > s2: return s1\n        else: return s2\n\n    for i in range(h):\n        for j in range(w):\n            if(Map[i][j].isalpha()):continue\n\n            if(0<j):\n                dp[i][j]=maxs(dp[i][j-1],dp[i][j])\n                    \n\n            if(0<i):\n                dp[i][j]=maxs(dp[i-1][j],dp[i][j])\n                    \n            dp[i][j]+=Map[i][j]\n            #if ('0' in dp[i][j]):dp[i][j]=nozero(dp[i][j])\n            if(dp[i][j] is '0'):dp[i][j]=''\n            res=maxs(res,dp[i][j])\n\n    return res\n\nwhile(True):\n    Map=[]\n    w,h=map(int,raw_input().split(' '))\n    if (w==0 and h==0):break\n    for i in range(h):\n        Map.append(list(raw_input()))\n\n    print solve()"
  },
  {
    "language": "Python",
    "code": "drc = [(0, 1), (1, 0)]\n\n\ndef dfs(r, c):\n    ret = []\n    for dr, dc in drc:\n        nr, nc = r + dr, c + dc\n        if nr < H and nc < W and board[nr][nc].isdigit():\n            cand = dfs(nr, nc)\n            if len(cand) > len(ret) or (len(cand) == len(ret) and cand > ret):\n                ret = cand\n    return [board[r][c]] + ret\n\n\nwhile True:\n    W, H = map(int, input().split())\n    if not (W | H):\n        break\n    board = [input() for _ in range(H)]\n    ans = ''\n    for r in range(H):\n        for c in range(W):\n            if board[r][c].isdigit() and board[r][c] != '0':\n                cand = ''.join(dfs(r, c))\n                # print(cand)\n                if len(cand) > len(ans) or (len(cand) == len(ans) and cand > ans):\n                    ans = cand\n    print(ans)"
  },
  {
    "language": "Python",
    "code": "while True:\n    W,H=map(int,raw_input().split())\n    if W==H==0:break\n    C=[raw_input() for i in range(H)]\n    table=[[\"\"]*W for i in range(H)]\n    ans=0\n    for y in range(H):\n        for x in range(W):\n            if C[y][x].isdigit():\n                a,b,c=table[y-1][x],table[y][x-1],C[y][x]\n                if a==b==\"\":\n                    table[y][x]=c\n                elif a==\"\":\n                    table[y][x]=b+c\n                elif b==\"\":\n                    table[y][x]=a+c\n                elif int(a)>=int(b):\n                    table[y][x]=a+c\n                elif int(a)<int(b):\n                    table[y][x]=b+c\n                ans=ans if ans>int(table[y][x]) else int(table[y][x])\n    print ans"
  },
  {
    "language": "Python",
    "code": "while 1:\n    W,H = map(int,raw_input().split())\n    if W == 0: break\n    C = [list(raw_input()) for _ in xrange(H)]\n    dp = [[0]*W for _ in xrange(H)]\n    ans = 0\n    for h in xrange(H):\n        for w in xrange(W):\n            if C[h][w].isdigit():\n                dp[h][w] = max(dp[h][w],int(C[h][w]))\n                if w > 0: dp[h][w] = max(dp[h][w],int(str(dp[h][w-1])+C[h][w]))\n                if h > 0: dp[h][w] = max(dp[h][w],int(str(dp[h-1][w])+C[h][w]))\n    print max(max(i) for i in dp)"
  },
  {
    "language": "Python",
    "code": "# -*- coding: utf-8 -*-\n\ndef recursion(y, x, island, dp):\n    if island[y][x].isdigit() and int(island[y][x]) in range(10):        \n        if y == 0 and x == 0:\n            dp[y][x] = int(island[y][x])\n        elif y == 0:\n            if dp[y][x-1] != -1:\n                dp[y][x] = dp[y][x-1] * 10 + int(island[y][x])\n            else:\n                dp[y][x] = int(island[y][x])\n        elif x == 0:\n            if dp[y-1][x] != -1:\n                dp[y][x] = dp[y-1][x] * 10 + int(island[y][x])\n            else:\n                dp[y][x] = int(island[y][x])\n        else:\n            dp[y][x] = max(dp[y][x-1] * 10 + int(island[y][x]), dp[y-1][x] * 10 + int(island[y][x]))\n    else:\n        dp[y][x] = -1\n        \ndef solve(w, h, island, dp):\n    for i in range(h):\n        for j in range(w):\n            recursion(i, j, island, dp)\n    print max(map(max, dp))\n\ndef func():\n    '''\n\n    '''\n    while True:\n        global count\n        w, h = map(int, raw_input().split())\n\n        if w == 0 and h == 0:\n            break\n\n        island = []\n        count = 0\n        for i in range(h):\n            row = []\n            line = raw_input()\n            for j in line:\n                row.append(j)\n            island.append(row)\n        \n        dp = []\n        for i in range(h):\n            dp_row = []\n            for j in range(w):\n                dp_row.append(0)\n            dp.append(dp_row)\n        solve(w, h, island, dp)\n\n\nfunc()\n    "
  },
  {
    "language": "Python",
    "code": "# -*- coding: utf-8 -*-\n\ndef recursion(y, x, island, dp):\n    if island[y][x].isdigit() and int(island[y][x]) in range(10):        \n        if y == 0 and x == 0:\n            dp[y][x] = int(island[y][x])\n        elif y == 0:\n            if dp[y][x-1] != -1:\n                dp[y][x] = dp[y][x-1] * 10 + int(island[y][x])\n            else:\n                dp[y][x] = int(island[y][x])\n        elif x == 0:\n            if dp[y-1][x] != -1:\n                dp[y][x] = dp[y-1][x] * 10 + int(island[y][x])\n            else:\n                dp[y][x] = int(island[y][x])\n        else:\n            if dp[y-1][x] == -1 and dp[y][x-1] == -1:\n                dp[y][x] = int(island[y][x])\n            elif dp[y-1][x] == -1:\n                dp[y][x] = dp[y][x-1] * 10 + int(island[y][x])\n            elif dp[y][x-1] == -1:\n                dp[y][x] = dp[y-1][x] * 10 + int(island[y][x])\n            else:\n                dp[y][x] = max(dp[y][x-1] * 10 + int(island[y][x]), dp[y-1][x] * 10 + int(island[y][x]))\n    else:\n        dp[y][x] = -1\n        \ndef solve(w, h, island, dp):\n    for i in range(h):\n        for j in range(w):\n            recursion(i, j, island, dp)\n    print dp\n    print max(map(max, dp))\n\ndef func():\n    '''\n\n    '''\n    while True:\n        global count\n        w, h = map(int, raw_input().split())\n\n        if w == 0 and h == 0:\n            break\n\n        island = []\n        count = 0\n        for i in range(h):\n            row = []\n            line = raw_input()\n            for j in line:\n                row.append(j)\n            island.append(row)\n        \n        dp = []\n        for i in range(h):\n            dp_row = []\n            for j in range(w):\n                dp_row.append(0)\n            dp.append(dp_row)\n        solve(w, h, island, dp)\n\nif __name__ == '__main__':\n    func()\n    "
  },
  {
    "language": "Python",
    "code": "import sys\n\ndef maxs(s1, s2):\n    if len(s1) > len(s2): return s1\n    elif len(s1) < len(s2): return s2\n\n    if s1 > s2: return s1\n    else: return s2\n    \n\nwhile 1:\n    w,h = map(int, raw_input().split())\n    if not(w or h): break\n    f = []\n    for i in xrange(h):\n        f.append(raw_input())\n\n    ans = ''\n    t = [['' for j in xrange(w)] for i in xrange(h)]\n    for i in xrange(h):\n        for j in xrange(w):\n            if not(ord('0') <= ord(f[i][j]) <= ord('9')):\n                continue\n            if j>0: t[i][j] = maxs(t[i][j], t[i][j-1])\n            if i>0: t[i][j] = maxs(t[i][j], t[i-1][j])\n            t[i][j] += f[i][j]\n            if t[i][j] is '0': t[i][j] = ''\n\n            ans = maxs(ans, t[i][j])\n\n    print ans"
  },
  {
    "language": "Python",
    "code": "from collections import defaultdict\ndef main(w, h):\n    field = [list(input()) for i in range(h)]\n    d = defaultdict(str)\n    for y in range(h - 1, -1, -1):\n        for x in range(w - 1, -1, -1):\n            if \"0\" <= field[y][x] <= \"9\":\n                d[(x, y)] = field[y][x]\n    for y in range(h - 1, -1, -1):\n        for x in range(w - 1, -1, -1):\n            if \"0\" <= field[y][x] <= \"9\":\n                if len(d[(x + 1, y)]) == len(d[(x, y + 1)]):\n                    d[(x, y)] = field[y][x] + max(d[(x + 1, y)], d[(x, y + 1)])\n                elif len(d[(x + 1, y)]) < len(d[(x, y + 1)]):\n                    d[(x, y)] = field[y][x] + d[(x, y + 1)]\n                else:\n                    d[(x, y)] = field[y][x] + d[(x + 1, y)]\n    ans = 0\n    for v in d.values():\n        if v == \"\":\n            continue\n        ans = max(ans, int(v))\n    print(ans)\n\nwhile 1:\n    w, h = map(int, input().split())\n    if h == w == 0:\n        break\n    main(w, h)\n"
  },
  {
    "language": "Python",
    "code": "def rec(h,w,s):\n    res = 0\n    for dh,dw in [[1,0],[0,1]]:\n        nh,nw = h+dh,w+dw\n        if 0 <= nh < H and 0 <= nw < W and C[nh][nw].isdigit():\n            res = max(res, rec(nh,nw,s+C[nh][nw]))\n    return res if res > 0 else int(s)\n\nwhile 1:\n    W,H = map(int,raw_input().split())\n    if W == 0: break\n    C = [list(raw_input()) for _ in xrange(H)]\n    ans = 0\n    for h in xrange(H):\n        for w in xrange(W):\n           if C[h][w].isdigit():\n               ans = max(ans, rec(h,w,C[h][w]))\n    print ans"
  },
  {
    "language": "Python",
    "code": "while 1:\n    W,H = map(int,raw_input().split())\n    if W == 0: break\n    C = [list(raw_input()) for _ in xrange(H)]\n    dp = [[0]*W for _ in xrange(H)]\n    ans = 0\n    for h in xrange(H):\n        for w in xrange(W):\n            if C[h][w].isdigit():\n                dp[h][w] = max(dp[h][w],int(C[h][w]))\n                if w > 0: dp[h][w] = max(dp[h][w],int(str(dp[h][w-1])+C[h][w]))\n                if h > 0: dp[h][w] = max(dp[h][w],int(str(dp[h-1][w])+C[h][w]))\n                ans = max(ans,dp[h][w])\n    print ans"
  },
  {
    "language": "Python",
    "code": "while True:\n    w,h = map(int,input().split())\n    if w == 0:\n        break\n    c = [input() for i in range(h)]\n    dp = [[0]*w for i in range(h)]\n    ans = 0\n    for i in range(h):\n        for j in range(w):\n            d = ord(c[i][j]) - ord('0')\n            if not (d>=0 and d<=9):\n                continue\n            dp[i][j] = d\n            if i > 0:\n                dp[i][j] = max(dp[i][j], dp[i-1][j]*10+d)\n            if j > 0:\n                dp[i][j] = max(dp[i][j], dp[i][j-1]*10+d)\n            ans = max(ans, dp[i][j])\n    print(ans)\n\n"
  },
  {
    "language": "Python",
    "code": "while 1:\n    W,H = map(int,raw_input().split())\n    if W == 0: break\n    C = [list(raw_input()) for _ in xrange(H)]\n    \n    dp = [[\"0\"]*W for _ in xrange(H)]\n    ans = 0\n    for h in xrange(H):\n        for w in xrange(W):\n            if C[h][w].isdigit():\n                dp[h][w] = str(max(int(dp[h][w]),int(C[h][w])))\n                if w > 0: dp[h][w] = str(max(int(dp[h][w]),int(dp[h][w-1]+C[h][w])))\n                if h > 0: dp[h][w] = str(max(int(dp[h][w]),int(dp[h-1][w]+C[h][w])))\n                ans = max(ans, int(dp[h][w]))\n    print ans"
  },
  {
    "language": "Python",
    "code": "import math,string,itertools,fractions,heapq,collections,re,array,bisect,sys,random,time,copy,functools\n\nsys.setrecursionlimit(10**7)\ninf = 10**20\neps = 1.0 / 10**10\nmod = 998244353\n\ndef LI(): return [int(x) for x in sys.stdin.readline().split()]\ndef LI_(): return [int(x)-1 for x in sys.stdin.readline().split()]\ndef LF(): return [float(x) for x in sys.stdin.readline().split()]\ndef LS(): return sys.stdin.readline().split()\ndef I(): return int(sys.stdin.readline())\ndef F(): return float(sys.stdin.readline())\ndef S(): return input()\ndef pf(s): return print(s, flush=True)\n\n\ndef main():\n    rr = []\n\n    while True:\n        w,h = LI()\n        if w == 0 and h == 0:\n            break\n        a = [[c for c in S()] for _ in range(h)]\n        t = [[0]*w for i in range(h)]\n        r = 0\n        for i in range(h):\n            for j in range(w):\n                c = a[i][j]\n                if not ('0' <= c <= '9'):\n                    continue\n                d = int(c) + t[i][j] * 10\n                if r < d:\n                    r = d\n                if i < h-1 and t[i+1][j] < d:\n                    t[i+1][j] = d\n                if j < w-1 and t[i][j+1] < d:\n                    t[i][j+1] = d\n        rr.append(r)\n\n    return '\\n'.join(map(str, rr))\n\n\nprint(main())\n\n\n"
  },
  {
    "language": "Python",
    "code": "def isValid(row, col, ROWS, COLS):\n    return row >= 0 and row < ROWS and col >= 0 and col < COLS\n\ndef search(matrix, row, col, ROWS, COLS, memo):\n    if (row, col) in memo:\n        return memo[(row, col)]\n    \n    numStrA = ''\n    numStrB = ''\n\n    rr = row + 1\n    cc = col\n    if isValid(rr, cc, ROWS, COLS) and matrix[rr][cc].isdigit():\n        numStrA = search(matrix, rr, cc, ROWS, COLS, memo)\n\n    rr = row\n    cc = col + 1\n    if isValid(rr, cc, ROWS, COLS) and matrix[rr][cc].isdigit():\n        numStrB = search(matrix, rr, cc, ROWS, COLS, memo)\n\n    numStrA = matrix[row][col] + numStrA\n    numStrB = matrix[row][col] + numStrB\n\n    if len(numStrA) > len(numStrB):\n        val = numStrA\n    elif len(numStrB) > len(numStrA):\n        val = numStrB\n    else:\n        if numStrA > numStrB:\n            val = numStrA\n        else:\n            val = numStrB\n\n    memo[(row, col)] = val\n    return val\n\nif __name__ == '__main__':\n    while True:\n        COLS, ROWS = [ int(x) for x in list(filter(lambda x: x != '', \\\n            input().strip().split(' '))) ]\n        if ROWS == 0 and COLS == 0:\n            break\n\n        matrix = []\n        for _ in range(ROWS):\n            matrix.append(input().strip())\n        \n        maxNum = 0\n        memo = {}\n        for row in range(ROWS):\n            for col in range(COLS):\n                if matrix[row][col].isdigit() and matrix[row][col] != '0':\n                    maxNum = max(maxNum, int(search(matrix, row, col, ROWS, COLS, memo)))\n\n        print(maxNum)\n"
  },
  {
    "language": "Python",
    "code": "# -*- coding: utf-8 -*-\n\nimport sys\n\nwhile True:\n    w, h = map(int, sys.stdin.readline().split( \" \" ) )\n    if w == 0 and h == 0:\n        break\n    table = []\n    for i in range(h):\n        table.append( sys.stdin.readline() )\n\n    dp = [[0 for i in range(w + 1)] for j in range(h + 1)]\n    for i in range( h ):\n        for j in range( w ):\n            if '0' <= table[ i ][ j ] <= '9' :\n                val = ord( table[ i ][ j ] ) - ord( '0' )\n                dp[ i + 1 ][ j + 1 ] = max( dp[ i ][ j + 1 ], dp[ i + 1 ][ j ] ) * 10 + val\n    print max( [ max( dp[ i ] ) for i in range( h + 1 ) ] )"
  },
  {
    "language": "Python",
    "code": "def solve():\n    global Map, w, h\n    dp=[['']*w]*h\n    res=''\n\n    def nozero(st):\n        return st.lstrip('0')\n\n    #whats the difference from max(str1,str2)??\n    def maxs(s1, s2):\n        if len(s1) > len(s2): return s1\n        elif len(s1) < len(s2): return s2\n \n        if s1 > s2: return s1\n        else: return s2\n\n    for i in range(h):\n        for j in range(w):\n            if(Map[i][j].isalpha()):continue\n            '''\n                if(0<=i-1<h and (Map[i-1][x].isdigit() and  dp[i-1][j]) and (0<=j-1<w and Map[i][j-1].isdigit() and dp[i][j-1])):\n                    tmp1=dp[i-1][j]+Map[i][j]\n                    tmp2=dp[i][j-1]+Map[i][j]\n                    dp[i][j]=max(tmp1,tmp2)\n\n                    res=max(res,dp[i][j])\n                    continue\n            '''\n            if(0<=j-1<w):\n                dp[i][j]=maxs(dp[i][j-1],dp[i][j])\n                    \n\n            if(0<=i-1<h):\n                dp[i][j]=maxs(dp[i-1][j],dp[i][j])\n                    \n            dp[i][j]+=Map[i][j]\n            if ('0' in dp[i][j]):dp[i][j]=nozero(dp[i][j])\n            res=maxs(res,dp[i][j])\n\n    return res\n\nwhile(True):\n    Map=[]\n    w,h=map(int,raw_input().split(' '))\n    if (w==0 and h==0):break\n    for i in range(h):\n        Map.append(list(raw_input()))\n\n    print solve()"
  },
  {
    "language": "Python",
    "code": "def solve():\n    global Map, w, h\n    dp=[['']*w]*h\n    res=''\n\n    def nozero(st):\n        return st.lstrip('0')\n\n    #whats the difference from max(str1,str2)??\n    def maxs(s1, s2):\n        if len(s1) > len(s2): return s1\n        elif len(s1) < len(s2): return s2\n \n        if s1 > s2: return s1\n        else: return s2\n\n    for i in range(h):\n        for j in range(w):\n            if(Map[i][j].isalpha()):continue\n            '''\n                if(0<=i-1<h and (Map[i-1][x].isdigit() and  dp[i-1][j]) and (0<=j-1<w and Map[i][j-1].isdigit() and dp[i][j-1])):\n                    tmp1=dp[i-1][j]+Map[i][j]\n                    tmp2=dp[i][j-1]+Map[i][j]\n                    dp[i][j]=max(tmp1,tmp2)\n\n                    res=max(res,dp[i][j])\n                    continue\n            '''\n            if(0<j):\n                dp[i][j]=maxs(dp[i][j-1],dp[i][j])\n                    \n\n            if(0<i):\n                dp[i][j]=maxs(dp[i-1][j],dp[i][j])\n                    \n            dp[i][j]+=Map[i][j]\n            #if ('0' in dp[i][j]):dp[i][j]=nozero(dp[i][j])\n            if(dp[i][j] is '0'):dp[i][j]=''\n            res=maxs(res,dp[i][j])\n\n    return res\n\nwhile(True):\n    Map=[]\n    w,h=map(int,raw_input().split(' '))\n    if (w==0 and h==0):break\n    for i in range(h):\n        Map.append(list(raw_input()))\n\n    print solve()"
  },
  {
    "language": "Python",
    "code": "while 1:\n    W,H = map(int,raw_input().split())\n    if W == 0: break\n    C = [list(raw_input()) for _ in xrange(H)]\n    \n    dp = [[\"0\"]*W for _ in xrange(H)]\n    ans = 0\n    for h in xrange(H):\n        for w in xrange(W):\n            if C[h][w].isdigit():\n                if w > 0: dp[h][w] = str(max(int(dp[h][w]),int(dp[h][w-1]+C[h][w])))\n                if h > 0: dp[h][w] = str(max(int(dp[h][w]),int(dp[h-1][w]+C[h][w])))\n                ans = max(ans, int(dp[h][w]))\n    print ans"
  },
  {
    "language": "Python",
    "code": "def rec(h,w,s):\n    res = 0\n    for dh,dw in [[1,0],[0,1]]:\n        nh,nw = h+dh,w+dw\n        if 0 <= nh < H and 0 <= nw < W and C[nh][nw].isdigit():\n            res = max(res, rec(nh,nw,s+C[nh][nw]))\n    return res if res > 0 else int(s)\n\nwhile 1:\n    W,H = map(int,raw_input().split())\n    if W == 0: break\n    C = [list(raw_input()) for _ in xrange(H)]\n    ans = 0\n    for h in xrange(H):\n        for w in xrange(W):\n           if C[h][w].isdigit():\n               if w > 0 and C[h][w-1].isdigit() or h > 0 and C[h-1][w].isdigit(): continue\n               ans = max(ans, rec(h,w,C[h][w]))\n    print ans"
  },
  {
    "language": "Python",
    "code": "# AOJ 1126: The Secret Number\n# Python3 2018.7.16 bal4u\n\nwhile True:\n\tW, H = map(int, input().split())\n\tif W == 0: break\n\td = [list(input()) for r in range(H)]\n\ta = [[0 for c in range(W)] for r in range(H)]\n\tans = 0\n\tfor r in range(H):\n\t\tfor c in range(W):\n\t\t\tif d[r][c] >= '0' and d[r][c] <= '9':\n\t\t\t\tk = int(d[r][c])\n\t\t\t\tk1 = k2 = 0\n\t\t\t\tif c > 0: k1 = a[r][c-1]*10 + k\n\t\t\t\tif r > 0: k2 = a[r-1][c]*10 + k\n\t\t\t\ta[r][c] = max(k, k1, k2)\n\t\t\t\tans = max(ans, a[r][c])\n\tprint(ans);\n\n"
  },
  {
    "language": "Python",
    "code": "# -*- coding: utf-8 -*-\n\ndef recursion(y, x, island, dp):\n    if island[y][x].isdigit() and int(island[y][x]) in range(10):        \n        if y == 0 and x == 0:\n            dp[y][x] = int(island[y][x])\n        elif y == 0:\n            if dp[y][x-1] != -1:\n                dp[y][x] = dp[y][x-1] * 10 + int(island[y][x])\n            else:\n                dp[y][x] = int(island[y][x])\n        elif x == 0:\n            if dp[y-1][x] != -1:\n                dp[y][x] = dp[y-1][x] * 10 + int(island[y][x])\n            else:\n                dp[y][x] = int(island[y][x])\n        else:\n            if dp[y-1][x] == -1 and dp[y][x-1] == -1:\n                dp[y][x] = int(island[y][x])\n            elif dp[y-1][x] == -1:\n                dp[y][x] = dp[y][x-1] * 10 + int(island[y][x])\n            elif dp[y][x-1] == -1:\n                dp[y][x] = dp[y-1][x] * 10 + int(island[y][x])\n            else:\n                dp[y][x] = max(dp[y][x-1] * 10 + int(island[y][x]), dp[y-1][x] * 10 + int(island[y][x]))\n    else:\n        dp[y][x] = -1\n        \ndef solve(w, h, island, dp):\n    for i in range(h):\n        for j in range(w):\n            recursion(i, j, island, dp)\n    #print dp\n    print max(map(max, dp))\n\ndef func():\n    '''\n\n    '''\n    while True:\n        global count\n        w, h = map(int, raw_input().split())\n\n        if w == 0 and h == 0:\n            break\n\n        island = []\n        count = 0\n        for i in range(h):\n            row = []\n            line = raw_input()\n            for j in line:\n                row.append(j)\n            island.append(row)\n        \n        dp = []\n        for i in range(h):\n            dp_row = []\n            for j in range(w):\n                dp_row.append(0)\n            dp.append(dp_row)\n        solve(w, h, island, dp)\n\nif __name__ == '__main__':\n    func()\n    "
  },
  {
    "language": "Python",
    "code": "drc = [(0, 1), (1, 0)]\n\n\ndef dfs(r, c):\n    if (r, c) in memo:\n        return memo[r, c]\n    ret = ''\n    for dr, dc in drc:\n        nr, nc = r + dr, c + dc\n        if nr < H and nc < W and board[nr][nc].isdigit():\n            cand = dfs(nr, nc)\n            if len(cand) > len(ret) or (len(cand) == len(ret) and cand > ret):\n                ret = cand\n    memo[r, c] = board[r][c] + ''.join(ret)\n    return board[r][c] + ret\n\n\nwhile True:\n    W, H = map(int, input().split())\n    if not (W | H):\n        break\n    board = [input() for _ in range(H)]\n    memo = dict()\n    ans = ''\n    for r in range(H):\n        for c in range(W):\n            if board[r][c].isdigit() and board[r][c] != '0':\n                cand = dfs(r, c)\n                if len(cand) > len(ans) or (len(cand) == len(ans) and cand > ans):\n                    ans = cand\n    print(ans)"
  },
  {
    "language": "Rust",
    "code": "use std::rc::Rc;\nuse std::ops::DivAssign;\nuse std::ops::MulAssign;\nuse std::ops::SubAssign;\nuse std::collections::BinaryHeap;\nuse std::str::FromStr;\nuse std::collections::HashSet;\nuse std::collections::BTreeMap;\nuse std::fmt::Display;\nuse std::ops::Neg;\nuse std::ops::Div;\nuse std::ops::Mul;\nuse std::ops::Add;\nuse std::ops::{AddAssign, Sub};\nuse std::cmp::max;\nuse std::collections::VecDeque;\nuse std::cmp::min;\nuse std::collections::{HashMap, BTreeSet};\nuse std::cmp::Ordering;\nuse std::fmt::Debug;\n\nfn read_line() -> String {\n    let mut buffer = String::new();\n    std::io::stdin().read_line(&mut buffer).expect(\"No Line\");\n    buffer.trim().to_owned()\n}\nfn read_lines<T: std::str::FromStr>(count: usize) -> Vec<T> {\n    let mut buffer = String::new();\n    let mut vec = Vec::with_capacity(count);\n    for _ in 0 .. count {\n        std::io::stdin().read_line(&mut buffer).expect(\"No Line\");\n        vec.push(buffer.trim().parse().ok().expect(\"Can't Parse\"));\n        buffer.clear();\n    }\n    vec\n}\nfn read_tabulate<R, T: Fn(&str)->R> (count: usize, transformer: T) -> Vec<R> {\n    let mut buffer = String::new();\n    let mut vec = Vec::with_capacity(count);\n    for _ in 0 .. count {\n        std::io::stdin().read_line(&mut buffer).expect(\"No Line\");\n        vec.push(transformer(buffer.trim()));\n        buffer.clear();\n    }\n    vec\n}\nfn read_value<T: std::str::FromStr>() -> T {\n    read_line().trim().parse().ok().unwrap()\n}\nfn read_values<T: std::str::FromStr>() -> Vec<T> {\n    read_line().trim().split_whitespace().map(|x| x.parse().ok().expect(\"Can't Parse\")).collect::<Vec<T>>()\n}\nmacro_rules! freeze {\n    ($($id:ident), *) => {\n        $(let $id = $id;)*\n    };\n}\nmacro_rules! read_map {\n    ($ident: ident: [$block: block; $size: expr]) => {\n        let $ident = (0 .. $size).into_iter().map(|_| $block).collect::<Vec<_>>();\n    };\n    (mut $ident: ident: [$block: block; $size: expr]) => {\n        let mut $ident = (0 .. $size).into_iter().map(|_| $block).collect::<Vec<_>>();\n    };\n}\nmacro_rules! read {\n    (mut $ident: ident: String) => {\n        let mut $ident = read_value::<String>();\n    };\n    ($ident: ident: String) => {\n        let $ident = read_value::<String>();\n    };\n    (mut $ident: ident: [$ty:ty]) => {\n        let mut $ident = read_values::<$ty>();\n    };\n    ($ident: ident: [$ty:ty]) => {\n        let $ident = read_values::<$ty>();\n    };\n    (mut $ident: ident: [[$ty:ty]; $size: expr]) => {\n        let mut $ident = (0 .. $size).into_iter().map(|_| read_values::<$ty>()).collect::<Vec<_>>();\n    };\n    ($ident: ident: [[$ty:ty]; $size: expr]) => {\n        let $ident = (0 .. $size).into_iter().map(|_| read_values::<$ty>()).collect::<Vec<_>>();\n    };\n    (mut $ident: ident: [$ty:ty; $size:expr]) => {\n        let mut $ident = read_lines::<$ty>($size);\n    };\n    ($ident: ident: [$ty:ty; $size:expr]) => {\n        let $ident = read_lines::<$ty>($size);\n    };\n    ($ident: ident: [$block: block; $size: expr]) => {\n        let $ident = (0 .. $size).into_iter().map(|_| $block).collect::<Vec<_>>();\n    };\n    (mut $ident: ident: [$block: block; $size: expr]) => {\n        let mut $ident = (0 .. $size).into_iter().map(|_| $block).collect::<Vec<_>>();\n    };\n    ($($token: tt)*) => {\n        let mut iter = read_values::<String>().into_iter();\n        read_from_iter!(iter; $($token)*);\n    };\n}\nmacro_rules! read_from_iter {\n    ($iter:expr; mut $ident:ident:$ty:ty, $($rest:tt)*) => {\n        let mut $ident = $iter.next().unwrap().parse::<$ty>().expect(\"Can't Parse\");\n        read_from_iter!($iter; $($rest)*);\n    };\n    ($iter:expr; $ident:ident:$ty:ty, $($rest:tt)*) => {\n        let $ident = $iter.next().unwrap().parse::<$ty>().expect(\"Can't Parse\");\n        read_from_iter!($iter; $($rest)*);\n    };\n    ($iter:expr; mut $ident:ident:$ty:ty) => {\n        let mut $ident = $iter.next().unwrap().parse::<$ty>().expect(\"Can't Parse\");\n    };\n    ($iter:expr; $ident:ident:$ty:ty) => {\n        let $ident = $iter.next().unwrap().parse::<$ty>().expect(\"Can't Parse\");\n    };\n    ($iter: expr; ) => {};\n}\nstruct KeyValue<K, V> {\n    key: K,\n    value: V\n}\nimpl <K: PartialOrd, V> PartialEq for KeyValue<K, V> {\n    fn eq(&self, other: &Self) -> bool {\n        self.key.eq(&other.key)\n    }\n}\nimpl <K: PartialOrd, V> Eq for KeyValue<K, V> {}\nimpl <K: PartialOrd, V> PartialOrd for KeyValue<K, V> {\n    fn partial_cmp(&self, other: &Self) -> Option<std::cmp::Ordering> {\n        self.key.partial_cmp(&other.key)\n    }\n}\nimpl <K: PartialOrd, V> Ord for KeyValue<K, V> {\n    fn cmp(&self, other: &Self) -> std::cmp::Ordering {\n        self.key.partial_cmp(&other.key).ok_or(\"Can't Compare\").unwrap()\n    }\n}\nfn compare_as_digit(a: &Vec<usize>, b: &Vec<usize>) -> Ordering {\n    if a.len() > b.len() {\n        for i in b.len() .. a.len() {\n            if a[i] > 0 {\n                return Ordering::Greater;\n            }\n        }\n    }else if a.len() < b.len() {\n        for i in a.len() .. b.len() {\n            if b[i] > 0 {\n                return Ordering::Less;\n            }\n        }\n    }\n    let min_len = min(a.len(), b.len());\n    for i in (0 .. min_len).rev() {\n        if a[i] != b[i] {\n            return a[i].cmp(&b[i]);\n        }\n    }\n    return Ordering::Equal\n}\nfn compare_as_successor(a: &Vec<usize>, b: &Vec<usize>) -> Ordering {\n    if a.len() != b.len() {return a.len().cmp(&b.len());}\n    compare_as_digit(a, b)\n}\nfn max_code(x: usize, y: usize,  state: &Vec<Vec<char>>, memo: &mut Vec<Vec<Option<Vec<usize>>>>) -> Vec<usize> {\n    if state.len() <= y || state[y].len() <= x {return vec![];}\n    if let Some(ref cache) = memo[y][x] {\n        return cache.clone();\n    }\n    if let Some(d) = state[y][x].to_digit(10) {\n        let mut right = max_code(x + 1, y, state, memo);\n        let mut left = max_code(x, y + 1, state, memo);\n        match compare_as_successor(&right, &left) {\n            Ordering::Less => {\n                left.push(d as usize);\n                memo[y][x] = Some(left.clone());\n                left\n            }\n            _ => {\n                right.push(d as usize);\n                memo[y][x] = Some(right.clone());\n                right\n            }\n        }\n    }else {\n        return vec![];\n    }\n}\nfn main() {\n    loop {\n        read!(width: usize, height: usize);\n        if width == 0 && height == 0{break;}\n        read_map!(state: [{\n            read!(line: String);\n            line.chars().collect::<Vec<_>>()\n        }; height]);\n        let mut memo: Vec<Vec<Option<Vec<usize>>>> = vec![vec![None; width]; height];\n        let mut max = vec![];\n        for y in 0 .. height {\n            for x in 0 .. width {\n                let temp = max_code(x, y, &state, &mut memo);\n                if !temp.is_empty() && compare_as_digit(&temp, &max) == Ordering::Greater {\n                    max = temp.clone();\n                }\n            }\n        }\n        println!(\"{}\", max.into_iter().rev().skip_while(|&d| d == 0).map(|d| d.to_string()).collect::<Vec<_>>().join(\"\"));\n    }\n}\n"
  },
  {
    "language": "Rust",
    "code": "#[allow(unused_macros)]\nmacro_rules! input {\n    (source = $s:expr, $($r:tt)*) => {\n        let mut iter = $s.split_whitespace();\n        let mut next = || { iter.next().unwrap() };\n        input_inner!{next, $($r)*}\n    };\n    ($($r:tt)*) => {\n        let stdin = std::io::stdin();\n        let mut bytes = std::io::Read::bytes(std::io::BufReader::new(stdin.lock()));\n        let mut next = move || -> String{\n            bytes\n                .by_ref()\n                .map(|r|r.unwrap() as char)\n                .skip_while(|c|c.is_whitespace())\n                .take_while(|c|!c.is_whitespace())\n                .collect()\n        };\n        input_inner!{next, $($r)*}\n    };\n}\n \n#[allow(unused_macros)]\nmacro_rules! input_inner {\n    ($next:expr) => {};\n    ($next:expr, ) => {};\n \n    ($next:expr, $var:ident : $t:tt $($r:tt)*) => {\n        let $var = read_value!($next, $t);\n        input_inner!{$next $($r)*}\n    };\n}\n \n#[allow(unused_macros)]\nmacro_rules! read_value {\n    ($next:expr, ( $($t:tt),* )) => {\n        ( $(read_value!($next, $t)),* )\n    };\n \n    ($next:expr, [ $t:tt ; $len:expr ]) => {\n        (0..$len).map(|_| read_value!($next, $t)).collect::<Vec<_>>()\n    };\n \n    ($next:expr, chars) => {\n        read_value!($next, String).chars().collect::<Vec<char>>()\n    };\n \n    ($next:expr, bytes) => {\n        read_value!($next, String).into_bytes()\n    };\n \n    ($next:expr, usize1) => {\n        read_value!($next, usize) - 1\n    };\n \n    ($next:expr, $t:ty) => {\n        $next().parse::<$t>().expect(\"Parse error\")\n    };\n}\n \nuse std::cmp::Ordering;\nuse std::cmp;\nuse std::collections::BTreeMap;\nuse std::process;\nuse std::cmp::Ord;\nuse std::collections::HashMap;\nuse std::collections::HashSet;\nuse std::collections::VecDeque;\nuse std::collections::BTreeSet;\nuse std::mem;\nuse std::collections::BinaryHeap;\n/// Equivalent to std::lowerbound and std::upperbound in c++\npub struct Scanner<R> {\n    stdin: R,\n}\n \nimpl<R: std::io::Read> Scanner<R> {\n    pub fn read<T: std::str::FromStr>(&mut self) -> T {\n        use std::io::Read;\n        let buf = self\n            .stdin\n            .by_ref()\n            .bytes()\n            .map(|b| b.unwrap())\n            .skip_while(|&b| b == b' ' || b == b'\\n' || b == b'\\r')\n            .take_while(|&b| b != b' ' && b != b'\\n' && b != b'\\r')\n            .collect::<Vec<_>>();\n        unsafe { std::str::from_utf8_unchecked(&buf) }\n            .parse()\n            .ok()\n            .expect(\"Parse error.\")\n    }\n    pub fn vec<T: std::str::FromStr>(&mut self, n: usize) -> Vec<T> {\n        (0..n).map(|_| self.read()).collect()\n    }\n    pub fn chars(&mut self) -> Vec<char> {\n        self.read::<String>().chars().collect()\n    }\n}\nfn main(){\n    let mut c = 0;\n    let sssss = std::io::stdin();\n    let mut sc = Scanner { stdin: sssss.lock() };\n    fn cp(a:&Vec<i64>, b:&Vec<i64>)->bool{\n        for i in (0..a.len()).rev(){\n            if a[i]>b[i]{\n                return true;\n            }\n            if a[i]<b[i]{\n                return false;\n            }\n        }\n        return true;\n    }\n    fn dfs(x:usize, y:usize, dp:&mut Vec<Vec<Vec<i64>>>, map:&Vec<Vec<i64>>, dp2:&mut Vec<Vec<i64>>)->Vec<i64>{\n        if x>=dp.len() || y>=dp[0].len(){\n            return vec![-1;71];\n        }\n        if map[x][y] == -1{\n            return vec![-1;71];\n        }\n        if dp[x][y][0] != -1{\n            return dp[x][y].clone();\n        }\n        let mut l = (dp2[x][y] - 1) as usize;\n        let mut L = vec![-1;71];\n        let mut R = vec![-1;71];\n        if x+1<dp.len() && l != 0{\n            L = dfs(x+1, y, dp, map, dp2);\n        }\n        if y+1<dp[0].len() && l != 0{\n            R = dfs(x, y+1, dp, map, dp2);\n        }\n        if cp(&L, &R) == false{\n            L = R.clone();\n        }\n        L[l] = map[x][y];\n        dp[x][y] = L.clone();\n        return L;\n    }\n    fn dfs2(x:usize, y:usize, dp2:&mut Vec<Vec<i64>>, map:&Vec<Vec<i64>>)->i64{\n        if x>=dp2.len() || y>=dp2[0].len(){\n            return -1;\n        }\n        if map[x][y] == -1{\n            return -1;\n        }\n        if dp2[x][y] != -1{\n            return dp2[x][y];\n        }\n        let mut res = 0;\n        res = cmp::max(res, dfs2(x+1, y, dp2, map));\n        res = cmp::max(res, dfs2(x, y+1, dp2, map));\n        dp2[x][y] = res+1;\n        return res+1;\n\n    }\n    while(true){\n        let mut N:usize = sc.read();\n        let mut M:usize = sc.read();\n        if N==0&&M==0{\n            break;\n        }\n        let mut map = vec![vec![-1;N];M];\n        for i in 0..M{\n            let mut tt:String = sc.read();\n            let cv: Vec<char> = tt.chars().collect();\n            for j in 0..N{\n                let t = cv[j];\n                if '0'<=t && t<='9'{\n                    map[i][j] = (t as usize - '0' as usize) as i64;\n                }\n                else{\n                    map[i][j] = -1;\n                }\n            }\n        }\n        let mut res = vec![-1;71];\n        let mut dp = vec![vec![vec![-1;71];N];M];\n        for i in 0..M{\n            for j in 0..N{\n                if map[i][j] <=0{\n                    continue;\n                }\n                let mut dp2 = vec![vec![-1;N];M];\n                dfs2(i, j, &mut dp2, &map);\n                let t = dfs(i, j, &mut dp, &map, &mut dp2);\n                if cp(&t, &res){\n                    res = t.clone();\n                }\n            }\n        }\n        let mut flag = false;\n        for xxx in (0..71).rev(){\n            if res[xxx] == 0 && flag == false{\n                continue;\n            }\n            if res[xxx] != -1 && res[xxx] != 0{\n                flag = true;\n                print!(\"{}\", res[xxx]);\n            }\n            if res[xxx] == 0 && flag == true{\n                print!(\"{}\",res[xxx]);\n            }\n        }\n        println!();\n    }\n}\n\npub static MOD:i64 = 1000000007;\npub static MODu:usize = 1000000007;\npub static eps:f64 = 1e-8;\nconst INF: i64 = 1 << 60;\n\n\n\n\n"
  }
]