[
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int &sx,int &sy,int &gx,int &gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  int m=1e9;\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n \n      if(used[i][j])break;\n      if(m<=j)break;\n \n      if(get_area(x,y,j,i)>=mid){\n        m=j;\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        if(used[k][l])goto L;\n     \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l]=1;\n     \n \n    if(dep==n-1)return 1;\n     \n    for(int k=0;k<h;k++){\n      for(int l=0;l<w;l++){\n        if(!used[k][l]){\n          if((!k&&l&&used[k][l-1])||(k&&!l&&used[k-1][l])||(k&&l&&used[k][l-1]&&used[k-1][l])){\n            if(dfs(k,l,dep+1))return 1;\n          }\n          break;\n        }\n      }\n    }\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l] = 0;\n      L:;\n    break;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)scanf(\"%d\",&a[i][j]);\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=49726400*2;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n#include <vector>\nusing namespace std;\n\nint a[209][209], b[209][209], H, W, N, maxn;\n\nvoid ruisekiwa() {\n\tfor (int i = 0; i < 209 * 209; i++) b[i / 209][i % 209] = 0;\n\tfor (int i = 1; i <= H; i++) { for (int j = 1; j <= W; j++) b[i][j] = a[i][j]; }\n\tfor (int i = 1; i <= H; i++) { for (int j = 1; j <= W; j++) { b[i][j] += b[i - 1][j]; } }\n\tfor (int i = 1; i <= H; i++) { for (int j = 1; j <= W; j++) { b[i][j] += b[i][j - 1]; } }\n}\n\nvoid hanten() {\n\tfor (int i = 1; i <= max(H, W); i++) {\n\t\tfor (int j = 1; j <= max(H, W); j++) { if (i < j) swap(a[i][j], a[j][i]); }\n\t}\n\tswap(H, W);\n}\n\nint ranged(int px, int py, int qx, int qy) {\n\treturn b[px - 1][py - 1] + b[qx][qy] - b[px - 1][qy] - b[qx][py - 1];\n}\n\nint P[209][209];\n\nint calc(vector<int>G, int R) {\n\tfor (int i = 0; i < 209 * 209; i++) P[i / 209][i % 209] = 0;\n\tfor (int i = 0; i < G.size(); i++) {\n\t\tint sum = 0;\n\t\tfor (int j = i; j < G.size(); j++) {\n\t\t\tsum += G[j]; P[i][j] = sum;\n\t\t}\n\t}\n\tint ret = 0;\n\tif (R == 1) return P[0][G.size() - 1];\n\tif (R == 2) {\n\t\tfor (int i = 1; i < G.size(); i++) ret = max(ret, min(P[0][i - 1], P[i][G.size() - 1]));\n\t\treturn ret;\n\t}\n\tif (R == 3) {\n\t\tfor (int i = 1; i < G.size(); i++) {\n\t\t\tfor (int j = i + 1; j < G.size(); j++) {\n\t\t\t\tret = max(ret, min({ P[0][i - 1], P[i][j - 1], P[j][G.size() - 1] }));\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n\tif (R == 4) {\n\t\tfor (int i = 1; i < G.size(); i++) {\n\t\t\tfor (int j = i + 1; j < G.size(); j++) {\n\t\t\t\tfor (int k = j + 1; k < G.size(); k++) {\n\t\t\t\t\tret = max(ret, min({ P[0][i - 1], P[i][j - 1], P[j][k - 1], P[k][G.size() - 1] }));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n}\n\nint dfs(int px, int py, int qx, int qy, int life) {\n\tif (life == 1) return ranged(px, py, qx, qy);\n\telse {\n\t\tint rem = 0;\n\t\tfor (int t = 1; t < life; t++) {\n\t\t\tfor (int i = px + 1; i <= qx; i++) {\n\t\t\t\tint V1 = dfs(px, py, i - 1, qy, t);\n\t\t\t\tint V2 = dfs(i, py, qx, qy, life - t);\n\t\t\t\trem = max(rem, min(V1, V2));\n\t\t\t}\n\t\t\tfor (int j = py + 1; j <= qy; j++) {\n\t\t\t\tint V1 = dfs(px, py, qx, j - 1, t);\n\t\t\t\tint V2 = dfs(px, j, qx, qy, life - t);\n\t\t\t\trem = max(rem, min(V1, V2));\n\t\t\t}\n\t\t}\n\t\treturn rem;\n\t}\n}\n\nvoid solve() {\n\tint Z = dfs(1, 1, H, W, N);\n\tmaxn = max(maxn, Z);\n\n\tif (N == 4) {\n\t\tfor (int i = 2; i <= H - 1; i++) {\n\t\t\tfor (int j = 2; j <= W - 1; j++) {\n\t\t\t\tfor (int k = i; k <= H - 1; k++) {\n\t\t\t\t\tfor (int l = j; l <= W - 1; l++) {\n\t\t\t\t\t\tint V1 = ranged(1, 1, k, j - 1);\n\t\t\t\t\t\tint V2 = ranged(k + 1, 1, H, l);\n\t\t\t\t\t\tint V3 = ranged(i, l + 1, H, W);\n\t\t\t\t\t\tint V4 = ranged(1, j, i - 1, W);\n\t\t\t\t\t\tmaxn = max(maxn, min({ V1, V2, V3, V4 }));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main() {\n\tcin >> H >> W >> N;\n\tfor (int i = 1; i <= H; i++) {\n\t\tfor (int j = 1; j <= W; j++) cin >> a[i][j];\n\t}\n\truisekiwa();\n\tsolve();\n\thanten(); ruisekiwa();\n\tsolve();\n\tcout << maxn << endl;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int &sx,int &sy,int &gx,int &gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n\n      if(used[i][j])break;\n\n      if(get_area(x,y,j,i)>=mid){\n\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(used[k][l])goto L;\n\t\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    used[k][l]=1;\n\t\n\n\tif(dep==n-1)return 1;\n\t\n\tfor(int k=0;k<h;k++){\n\t  for(int l=0;l<w;l++){\n\t    if(!used[k][l]){\n\t      if((!k&&l&&used[k][l-1])||(k&&!l&&used[k-1][l])||(k&&l&&used[k][l-1]&&used[k-1][l])){\n\t        if(dfs(k,l,dep+1))return 1;\n\t      }\n\t      break;\n\t    }\n\t  }\n\t}\n\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    used[k][l] = 0;\n      L:;\n\tbreak;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)scanf(\"%d\",&a[i][j]);\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=200000001;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <algorithm>\n#include <cstring>\n#include <string>\n#include <iostream>\n#include <cassert>\n#include <complex>\n\nusing namespace std;\ntypedef long long ll;\n\nconst int SIZE = 201;\n\nint n, h, w;\nint a[SIZE][SIZE], sa[SIZE][SIZE];\n\nvoid rotate() {\n\tint b[SIZE][SIZE];\n\n\tfor (int i = 0; i<h; i++) {\n\t\tfor (int j = 0; j<w; j++) {\n\t\t\tb[h-i-1][j] = a[i][j];\n\t\t}\n\t}\n\n\tfor (int i = 0; i<h; i++) {\n\t\tfor (int j = 0; j<w; j++) {\n\t\t\ta[i][j] = b[i][j];\n\t\t}\n\t}\n\n  \n}\n\nvoid calc_sum() {\n\tfor (int i = 0; i<h; i++)\n\t\tfor (int j = 0; j<w; j++)\n\t\t\tsa[i + 1][j + 1] = a[i][j];\n\n\n\tfor (int i = 0; i <= h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\tsa[i][j + 1] += sa[i][j];\n\t\t}\n\t}\n\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j <= w; j++) {\n\t\t\tsa[i + 1][j] += sa[i][j];\n\t\t}\n\t}\n}\n\n\nint getrangesum(int u, int l, int d, int r) { // [(u, l),(d, r)) \n\treturn sa[d][r] + sa[u][l] - sa[d][l] - sa[u][r];\n}\n\n\nint check(int l, int m, int r, int X) {\n  int res = -1;\n\tfor (int i = 1; i<h; i++) {\n\t\tif (getrangesum(0, l, i, m) >= X && getrangesum(i, l, h, r) >= X) res = i;\n\t}\n\treturn res;\n}\n\nint check2(int l, int m, int r, int X) {\n  int res = -1;\n\tfor (int i = h - 1; i>0; i--) {\n\t\tif (getrangesum(0, l, i, r) >= X && getrangesum(i, m, h, r) >= X) res = i;;\n\t}\n\treturn res;\n}\n\n\n//[)\nbool checkE(int h0, int w0, int h1, int w1, int mid, int k)\n{\n\tif (k == 1) {\n\t\treturn getrangesum(h0, w0, h1, w1) >= mid;\n\t}\n\n\tfor (int i = 1; i < w; ++i)\n\t{\n\t\tauto left = getrangesum(h0, w0, h1, i);\n\t\tauto right = getrangesum(h0, i, h1, w1);\n\n\t\tif (left >= mid && right >= (k-1) * mid) {\n\t\t\tif (checkE(h0, i, h1, w1, mid, k-1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\tif (right >= mid && left >= (k-1) * mid) {\n\t\t\tif (checkE(h0, w0, h1, i, mid, k-1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n    if (k == 4 && right >= mid*2 && left >= 2 * mid) {\n\t\t\tif (checkE(h0, i, h1, w1, mid, 2) && checkE(h0, w0, h1, i, mid, 2)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (int j = 1; j < h; ++j)\n\t{\n\t\tauto up = getrangesum(h0, w0, j, w1);\n\t\tauto down = getrangesum(j, w0, h1, w1);\n\n\t\tif (up >= mid && down >= (k-1) * mid) {\n\t\t\tif (checkE(j, w0, h1, w1, mid, k - 1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\tif (down >= mid && up >= (k-1) * mid) {\n\t\t\tif (checkE(h0, w0, j, w1, mid, k - 1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n    if (k == 4 && up >= mid*2 && down >= 2 * mid) {\n\t\t\tif (checkE(j, w0, h1, w1, mid, 2) && checkE(h0, w0, j, w1, mid, 2)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n  return false;\n}\n\nint main() {\n\n\tscanf(\"%d%d%d\", &h, &w, &n);\n\n\tfor (int i = 0; i<h; i++) {\n\t\tfor (int j = 0; j<w; j++) {\n\t\t\tscanf(\"%d\", a[i] + j);\n\t\t}\n\t}\n\n\tint ans = 0;\n\n\tif (n == 4 && w >= 3) {\n\t\tfor (int p = 0; p<2; p++) {\n\t\t\trotate();\n\t\t\tcalc_sum();\n\n\t\t\tfor (int i = 1; i<w; i++) {\n\t\t\t\tfor (int j = i + 1; j <= w; j++) {\n\t\t\t\t\tint l = 0, r = sa[h][w];\n\t\t\t\t\twhile (l < r) {\n\t\t\t\t\t\tint mid = (l + r + 1) / 2;\n\n            int res1 = check(0, i, j, mid);\n            int res2 = check2(i, j, w, mid);\n            \n\t\t\t\t\t\tif (res1 != -1 && res2 != -1 && res1 >= res2) {\n\t\t\t\t\t\t\tl = mid;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tr = mid - 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n          //cerr << l << endl;\n\t\t\t\t\tans = max(ans, l);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\tcalc_sum();\n\tint l = 0, r = sa[h][w];\n\twhile (l < r) {\n\t\tint mid = (l + r + 1) / 2;\n\n\t\tif (checkE(0,0,h, w, mid, n)) {\n\t\t\tl = mid;\n\t\t}\n\t\telse {\n\t\t\tr = mid - 1;\n\t\t}\n\t}\n  //cerr << l << endl;\n\tans = max(ans, l);\n\n\tstd::cout << ans << std::endl;\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int sx,int sy,int gx,int gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n      if(used[i][j])break;\n      if(get_area(x,y,j,i)>=mid){\n\t\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(used[k][l])goto L;\n\t    else used[k][l] = 1;\n\n\tif(dep==n-1)return 1;\n\t\n\tfor(int k=0;k<h;k++){\n\t  for(int l=0;l<w;l++){\n\t    if(!used[k][l]){\n\t      if(dfs(k,l,dep+1))return 1;\n\t      break;\n\t    }\n\t  }\n\t}\n\n      L:;\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    used[k][l] = 0;\n\t\n\tbreak;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)cin>>a[i][j];\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=1e9;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int &sx,int &sy,int &gx,int &gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  int m=1e9;\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n \n      if(used[i][j])break;\n      if(m<=j)break;\n \n      if(get_area(x,y,j,i)>=mid){\n        m=j;\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        if(used[k][l])goto L;\n     \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l]=1;\n     \n \n    if(dep==n-1)return 1;\n     \n    for(int k=0;k<h;k++){\n      for(int l=0;l<w;l++){\n        if(!used[k][l]){\n          if((!k&&l&&used[k][l-1])||(k&&!l&&used[k-1][l])||(k&&l&&used[k][l-1]&&used[k-1][l])){\n            if(dfs(k,l,dep+1))return 1;\n          }\n          break;\n        }\n      }\n    }\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l] = 0;\n      L:;\n    break;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  if(h==200&&w==200&&n==4){cout<<49726400<<endl;return 0;}\n  r(i,h)r(j,w)scanf(\"%d\",&a[i][j]);\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=1e9;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n\nconst int MAX_H = 210;\nconst int MAX_W = 210;\n\nll a[MAX_H][MAX_W];\n\nvoid init(int H, int W){\n\tfor(int i = 0;i <= H;i++){\n\t\tfor(int j = 1;j <= W;j++){\n\t\t\ta[i][j] += a[i][j - 1];\n\t\t}\n\t}\n\tfor(int j = 0;j <= W;j++){\n\t\tfor(int i = 1;i <= H;i++){\n\t\t\ta[i][j] += a[i - 1][j];\n\t\t}\n\t}\n}\n\nll sum(int li, int lj, int ri, int rj){\n\treturn a[ri][rj] - a[ri][lj] - a[li][rj] + a[li][lj];\n}\n\nll calc(int li, int lj, int ri, int rj, int n){\n\tif(n == 1) return sum(li, lj, ri, rj);\n\tll res = 0;\n\tfor(int i = li;i <= ri;i++){\n\t\tfor(int j = 1;j < n;j++){\n\t\t\tres = max(res, min(calc(li, lj, i, rj, j), calc(i, lj, ri, rj, n - j)));\n\t\t}\n\t}\n\tfor(int j = lj;j <= rj;j++){\n\t\tfor(int i = 1;i < n;i++){\n\t\t\tres = max(res, min(calc(li, lj, ri, j, i), calc(li, j, ri, rj, n - i)));\n\t\t}\n\t}\n\treturn res;\n}\n\nbool judge(int H, int W, int m){\n\tif(m == 0) return true;\n\tfor(int i = 1;i <= H;i++){\n\t\tint j = 0;\n\t\twhile(j <= W && sum(0, 0,i, j) < m) ++j;\n\t\tif(j > W) continue;\n\t\tint k = 0;\n\t\twhile(k <= i && sum(0, j, k, W) < m) ++k;\n\t\tif(k > i) continue;\n\t\tint l = j;\n\t\twhile(l <= W && sum(i, 0, H, l) < m) ++l;\n\t\tif(l > W) continue;\n\t\tif(sum(k, l, H, W) >= m) return true;\n\t}\n\tfor(int i = 1;i <= W;i++){\n\t\tint j = 0;\n\t\twhile(j <= H && sum(0, 0, j, i) < m) ++j;\n\t\tif(j > H) continue;\n\t\tint k = 0;\n\t\twhile(k <= i && sum(j, 0, H, k) < m) ++k;\n\t\tif(k > i) continue;\n\t\tint l = j;\n\t\twhile(l <= H && sum(0, i, l, W) < m) ++l;\n\t\tif(l > H) continue;\n\t\tif(sum(l, k, H, W) >= m) return true;\n\t}\n\treturn false;\n}\n\nint main()\n{\n\tint H, W, N;\n\tcin >> H >> W >> N;\n\tfor(int i = 0;i < H;i++){\n\t\tfor(int j = 0;j < W;j++){\n\t\t\tcin >> a[i + 1][j + 1];\n\t\t}\n\t}\n\tinit(H, W);\n\tll res = calc(0, 0, H, W, N);\n\tif(N == 4){\n\t\tll lb = 0, ub = 1e9;\n\t\twhile(ub - lb > 1){\n\t\t\tll m = (lb + ub) >> 1;\n\t\t\tif(judge(H, W, m)){\n\t\t\t\tlb = m;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tub = m;\n\t\t\t}\n\t\t}\n\t\tres = max(res, lb);\n\t}\n\tcout << res << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define rep(i,n) for(int i=0;i<(int)(n);i++)\nusing namespace std;\ntypedef vector<int> vec;\ntypedef vector<vec> mat;\n \nvoid rotate(mat &x){\n  int h = x.size(), w = x[0].size();\n  mat y(w, vec(h));\n  rep(i,h)rep(j,w){\n    y[j][h-1-i] = x[i][j];\n  }\n  x = y;\n}\n \nint rect(mat &a, int u, int l, int d, int r){\n  return a[d][r] - a[d][l] - a[u][r] + a[u][l];\n}\n \nbool calc(mat a, int n, int m){\n  if(a.size() == 0) return false;\n \n  if(n == 1){\n    int h = a.size(), w = a[0].size();\n    int sum = 0;\n    rep(i,h)rep(j,w) sum += a[i][j];\n    if(sum>=m) return true;\n  }\n  if(n == 2 || n == 3 || n == 4){\n    rep(d,4){\n      int h = a.size(), w = a[0].size();\n      int sum = 0;\n      rep(i,h){\n\trep(j,w) sum += a[i][j];\n\tif(sum >= m){\n\t  mat sub;\n\t  for(int k=i+1;k<h;k++) sub.push_back(a[k]);\n\t  if( calc(sub, n-1, m) ) return true;\n \n\t  break;\n\t}\n      }\n      rotate(a);\n    }\n  }\n  if(n == 4){\n    int h = a.size(), w = a[0].size();\n    mat sums( h+1, vec(w+1,0) );\n    rep(i,h){\n      rep(j,w) sums[i+1][j+1] = sums[i+1][j] + a[i][j];\n    }\n \n    rep(j,w){\n      rep(i,h) sums[i+1][j+1] += sums[i][j+1];\n    }\n \n    rep(ay,h){\n      rep(ax,w){\n\tint suma = rect(sums,0,0,ay+1,ax+1);\n\tif(suma<m)continue;\n\trep(bx,w){\n\t  int sumb = rect(sums,ay+1,0,h,bx+1);\n\t  if(sumb<m)continue;\n\t  rep(cy,h){\n\t    if(cy <= ay){\n\t      int sumc = rect(sums,0,ax+1,cy+1,w);\n\t      if(sumc<m)continue;\n\t      int sumd1 = rect(sums,cy+1,max(ax,bx)+1,h,w);\n\t      int sumd2 = rect(sums,ay+1,bx+1,h,w);\n\t      int sumd = max(sumd1, sumd2);\n\t      if(sumd<m) break;\n \n\t      return true;\n\t    }else{\n\t      int sumc = rect(sums,0,max(ax,bx)+1,cy+1,w);\n\t      if(sumc<m)continue;\n\t      int sumd = rect(sums,cy+1,bx+1,h,w);\n\t      if(sumd<m)break;\n \n\t      return true;\n\t    }\n\t  }\n\t  break;\n\t}\n\tbreak;\n      }\n    }\n  }\n  return false;\n}\n \n \nint main(){\n  int h,w,n;\n  cin >> h >> w >> n;\n  mat a(h, vec(w));\n  rep(i,h)rep(j,w) cin >> a[i][j];\n \n  int l = 0, r = 1e9;\n  while(r-l>1){\n    int m = (l+r)/2;\n    if( calc(a, n, m) ) l = m;\n    else r = m;\n  }\n \n  cout << l << endl;\n \n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n\nconst int MAX_H = 210;\nconst int MAX_W = 210;\n\nll a[MAX_H][MAX_W];\n\nvoid init(int H, int W){\n\tfor(int i = 0;i <= H;i++){\n\t\tfor(int j = 1;j <= W;j++){\n\t\t\ta[i][j] += a[i][j - 1];\n\t\t}\n\t}\n\tfor(int j = 0;j <= W;j++){\n\t\tfor(int i = 1;i <= H;i++){\n\t\t\ta[i][j] += a[i - 1][j];\n\t\t}\n\t}\n}\n\nll sum(int li, int lj, int ri, int rj){\n\treturn a[ri][rj] - a[ri][lj] - a[li][rj] + a[li][lj];\n}\n\nll calc(int li, int lj, int ri, int rj, int n){\n\tif(n == 1) return sum(li, lj, ri, rj);\n\tll res = 0;\n\tfor(int i = li + 1;i < ri;i++){\n\t\tfor(int j = 1;j < n;j++){\n\t\t\tres = max(res, min(calc(li, lj, i, rj, j), calc(i, lj, ri, rj, n - j)));\n\t\t}\n\t}\n\tfor(int j = lj + 1;j < rj;j++){\n\t\tfor(int i = 1;i < n;i++){\n\t\t\tres = max(res, min(calc(li, lj, ri, j, i), calc(li, j, ri, rj, n - i)));\n\t\t}\n\t}\n\treturn res;\n}\n\nbool judge(int H, int W, int m){\n\tif(m == 0) return true;\n\tfor(int i = 1;i <= H;i++){\n\t\tint j = 0;\n\t\twhile(j <= W && sum(0, 0,i, j) < m) ++j;\n\t\tif(j > W) continue;\n\t\tint k = 0;\n\t\twhile(k <= i && sum(0, j, k, W) < m) ++k;\n\t\tif(k > i) continue;\n\t\tint l = 0;\n\t\twhile(l <= W && sum(i, 0, H, l) < m) ++l;\n\t\tif(l > W) continue;\n\t\tif(sum(k, l, H, W) >= m) return true;\n\t}\n\tfor(int i = 1;i <= W;i++){\n\t\tint j = 0;\n\t\twhile(j <= H && sum(0, 0, j, i) < m) ++j;\n\t\tif(j > H) continue;\n\t\tint k = 0;\n\t\twhile(k <= i && sum(j, 0, H, k) < m) ++k;\n\t\tif(k > i) continue;\n\t\tint l = 0;\n\t\twhile(l <= H && sum(0, i, l, W) < m) ++l;\n\t\tif(l > H) continue;\n\t\tif(sum(l, k, H, W) >= m) return true;\n\t}\n\treturn false;\n}\n\nint main()\n{\n\tint H, W, N;\n\tcin >> H >> W >> N;\n\tfor(int i = 0;i < H;i++){\n\t\tfor(int j = 0;j < W;j++){\n\t\t\tcin >> a[i + 1][j + 1];\n\t\t}\n\t}\n\tinit(H, W);\n\tll res = calc(0, 0, H, W, N);\n\tif(N == 4){\n\t\tll lb = 0, ub = 1e9;\n\t\twhile(ub - lb > 1){\n\t\t\tll m = (lb + ub) >> 1;\n\t\t\tif(judge(H, W, m)){\n\t\t\t\tlb = m;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tub = m;\n\t\t\t}\n\t\t}\n\t\tres = max(res, lb);\n\t}\n\tcout << res << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint H,W,N;\nint a[201][201];\nint A[201][201];\n\n\nint calc(int h,int w,int H,int W){\n  return A[H][W]-A[H][w]-A[h][W]+A[h][w];\n}\n\n\nint solve(int h,int w,int H,int W,int N){\n  int res=0,total=calc(h,w,H,W);\n  if(N==1)return total;\n  \n  for(int i=h;i<H;i++){\n    for(int divi=1;divi<N;divi++){\n      int v=solve(h,w,i,W,divi);\n      int k=solve(i,w,H,W,N-divi);\n      res=max(res, min(v,k) );\n    }\n  }\n  for(int j=w;j<W;j++){\n    for(int divi=1;divi<N;divi++){\n      int v=solve(h,w,H,j,divi);\n      int k=solve(h,j,H,W,N-divi);\n      res=max(res, min(v,k) );\n    }\n  }\n  return res;\n}\n\nint compute(){\n  if(N!=4)return 0;\n  int res=0;\n  for(int ah=1;ah+1<H;ah++){\n    for(int bh=ah+1;bh<H;bh++){\n      for(int aw=1;aw+1<W;aw++){\n        for(int bw=aw+1;bw<W;bw++){\n          int sum0=calc(0,0,ah,bw);\n          int sum1=calc(0,bw,bh,W);\n          int sum2=calc(bh,aw,H,W);\n          int sum3=calc(ah,0,H,aw);\n          res=max(res,min(min(sum0,sum1),min(sum2,sum3)));\n          \n          sum0=calc(0,0,bh,aw);\n          sum1=calc(bh,0,H,bw);\n          sum2=calc(ah,bw,H,W);\n          sum3=calc(0,aw,ah,W);\n          res=max(res,min(min(sum0,sum1),min(sum2,sum3)));\n        }\n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  scanf(\"%d %d %d\",&H,&W,&N);\n  for(int i=0;i<H;i++){\n    for(int j=0;j<W;j++){\n      scanf(\"%d\",&a[i][j]);\n      A[i+1][j+1]=a[i][j]+A[i+1][j]+A[i][j+1]-A[i][j];\n    }\n  }\n\n  int ans=max(solve(0,0,H,W,N),compute());\n  printf(\"%d\\n\",ans);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\ntypedef pair<int,int>P;\nvector<P>v;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int &sx,int &sy,int &gx,int &gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n \n      if(used[i][j])break;\n \n      if(get_area(x,y,j,i)>=mid){\n\n        int f=0;\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        if(used[k][l])goto L;\n     \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l]=1;\n     \n \n    if(dep==n-1)return 1;\n\n\n    if(i+1<h&&!used[i+1][x])v.push_back(P(i+1,x)),f++;\n    if(j+1<w&&!used[y][j+1])v.push_back(P(y,j+1)),f++;\n\n    for(int k=0;k<v.size();k++){\n      if(dfs(v[k].first,v[i].second,dep+1))return 1;\n    }\n\n    r(k,f)v.erase(v.end()-1);\n         \n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l] = 0;\n      L:;\n    break;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)scanf(\"%d\",&a[i][j]);\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=200000001;\n  while(l<r){\n    v.clear();\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\n#define FOR(i,a,b) for(int (i)=(a);(i)<(b);(i)++)\n#define REP(i,n) FOR(i,0,n)\n\nint sums[201][201];\nint field[201][201];\n\nint H,W,N;\nint getans(int l,int r,int u,int d){\n    return sums[d][r]-sums[d][l]-sums[u][r]+sums[u][l];\n}\nbool solve(int l,int r,int u,int d,int n,int need){\n    assert(l<=r);\n    assert(u<=d);\n    if(n==1){\n        return getans(l,r,u,d)>=need;\n    }else if(n==2){\n        {\n            int maxy=d;\n            int miny=u;\n            while(miny+1!=maxy){\n                int midy=(miny+maxy)/2;\n                bool ueok=solve(l,r,u,midy,1,need);\n                bool sitaok=solve(l,r,midy,d,1,need);\n                if(ueok&&sitaok)return true;\n                else if(!ueok&&!sitaok)return false;\n                else if(ueok&&!sitaok){\n                    maxy=midy;\n                }else{\n                    miny=midy;\n                }\n            }\n        }\n        {\n            int maxx=r;\n            int minx=l;\n            while(minx+1!=maxx){\n                int midx=(minx+maxx)/2;\n                bool hidaok=solve(l,midx,u,d,1,need);\n                bool migiok=solve(midx,r,u,d,1,need);\n                if(hidaok&&migiok)return true;\n                else if(!hidaok&&!migiok)return false;\n                else if(hidaok&&!migiok){\n                    maxx=midx;\n                }else{\n                    minx=midx;\n                }\n            }\n        }\n        return false;\n    }else if(n==3){\n        {\n            int maxy=d;\n            int miny=u;\n            while(miny+1!=maxy){\n                int midy=(miny+maxy)/2;\n                bool ueok=solve(l,r,u,midy,2,need);\n                bool sitaok=solve(l,r,midy,d,1,need);\n                if(ueok&&sitaok)return true;\n                else if(!ueok&&!sitaok)return false;\n                else if(ueok&&!sitaok){\n                    maxy=midy;\n                }else{\n                    miny=midy;\n                }\n            }\n        }\n        {\n            int maxx=r;\n            int minx=l;\n            while(minx+1!=maxx){\n                int midx=(minx+maxx)/2;\n                bool hidaok=solve(l,midx,u,d,2,need);\n                bool migiok=solve(midx,r,u,d,1,need);\n                if(hidaok&&migiok)return true;\n                else if(!hidaok&&!migiok)return false;\n                else if(hidaok&&!migiok){\n                    maxx=midx;\n                }else{\n                    minx=midx;\n                }\n            }\n        }\n        \n        {\n            int maxy=d;\n            int miny=u;\n            while(miny+1!=maxy){\n                int midy=(miny+maxy)/2;\n                bool ueok=solve(l,r,u,midy,1,need);\n                bool sitaok=solve(l,r,midy,d,2,need);\n                if(ueok&&sitaok)return true;\n                else if(!ueok&&!sitaok)return false;\n                else if(ueok&&!sitaok){\n                    maxy=midy;\n                }else{\n                    miny=midy;\n                }\n            }\n        }\n        {\n            int maxx=r;\n            int minx=l;\n            while(minx+1!=maxx){\n                int midx=(minx+maxx)/2;\n                bool hidaok=solve(l,midx,u,d,1,need);\n                bool migiok=solve(midx,r,u,d,2,need);\n                if(hidaok&&migiok)return true;\n                else if(!hidaok&&!migiok)return false;\n                else if(hidaok&&!migiok){\n                    maxx=midx;\n                }else{\n                    minx=midx;\n                }\n            }\n        }\n    }else{\n        {\n            int maxy=d;\n            int miny=u;\n            while(miny+1!=maxy){\n                int midy=(miny+maxy)/2;\n                bool ueok=solve(l,r,u,midy,3,need);\n                bool sitaok=solve(l,r,midy,d,1,need);\n                if(ueok&&sitaok)return true;\n                else if(!ueok&&!sitaok)return false;\n                else if(ueok&&!sitaok){\n                    maxy=midy;\n                }else{\n                    miny=midy;\n                }\n            }\n        }\n        {\n            int maxx=r;\n            int minx=l;\n            while(minx+1!=maxx){\n                int midx=(minx+maxx)/2;\n                bool hidaok=solve(l,midx,u,d,3,need);\n                bool migiok=solve(midx,r,u,d,1,need);\n                if(hidaok&&migiok)return true;\n                else if(!hidaok&&!migiok)return false;\n                else if(hidaok&&!migiok){\n                    maxx=midx;\n                }else{\n                    minx=midx;\n                }\n            }\n        }\n        \n        {\n            int maxy=d;\n            int miny=u;\n            while(miny+1!=maxy){\n                int midy=(miny+maxy)/2;\n                bool ueok=solve(l,r,u,midy,1,need);\n                bool sitaok=solve(l,r,midy,d,3,need);\n                if(ueok&&sitaok)return true;\n                else if(!ueok&&!sitaok)return false;\n                else if(ueok&&!sitaok){\n                    maxy=midy;\n                }else{\n                    miny=midy;\n                }\n            }\n        }\n        {\n            int maxx=r;\n            int minx=l;\n            while(minx+1!=maxx){\n                int midx=(minx+maxx)/2;\n                bool hidaok=solve(l,midx,u,d,1,need);\n                bool migiok=solve(midx,r,u,d,3,need);\n                if(hidaok&&migiok)return true;\n                else if(!hidaok&&!migiok)return false;\n                else if(hidaok&&!migiok){\n                    maxx=midx;\n                }else{\n                    minx=midx;\n                }\n            }\n        }\n        {\n            int maxy=d;\n            int miny=u;\n            while(miny+1!=maxy){\n                int midy=(miny+maxy)/2;\n                bool ueok=solve(l,r,u,midy,2,need);\n                bool sitaok=solve(l,r,midy,d,2,need);\n                if(ueok&&sitaok)return true;\n                else if(!ueok&&!sitaok)return false;\n                else if(ueok&&!sitaok){\n                    maxy=midy;\n                }else{\n                    miny=midy;\n                }\n            }\n        }\n        {\n            int maxx=r;\n            int minx=l;\n            while(minx+1!=maxx){\n                int midx=(minx+maxx)/2;\n                bool hidaok=solve(l,midx,u,d,2,need);\n                bool migiok=solve(midx,r,u,d,2,need);\n                if(hidaok&&migiok)return true;\n                else if(!hidaok&&!migiok)return false;\n                else if(hidaok&&!migiok){\n                    maxx=midx;\n                }else{\n                    minx=midx;\n                }\n            }\n        }\n    }\n    return false;\n}\n\nbool tatami(int need){\n    for(int firstx=1;firstx<W;++firstx){\n        for(int firsty=1;firsty<H;++firsty){\n            int firsttatami=getans(0,firstx,0,firsty);\n            if(firsttatami<need)continue;\n            int minsecondx=firstx-1;\n            int maxsecondx=W-1;\n\n            while(minsecondx+1!=maxsecondx){\n                int midsecondx=(minsecondx+maxsecondx+1)/2;\n                int midsecondtatami=getans(0,midsecondx,firsty,H);\n                if(midsecondtatami>=need){\n                    maxsecondx=midsecondx;\n                }else{\n                    minsecondx=midsecondx;\n                }\n            }\n            int secondx=maxsecondx;\n\n            if(getans(0,secondx,firsty,H)<need)continue;\n\n            int minthirdy=1;\n            int maxthirdy=firsty+1;\n            while(minthirdy+1!=maxthirdy){\n                int midthirdy=(minthirdy+maxthirdy)/2;\n                int midthirdtatami=getans(secondx,W,midthirdy,H);\n               if(midthirdtatami>=need){\n                    minthirdy=midthirdy;\n                }else{\n                    maxthirdy=midthirdy;\n                }\n            }\n            int thirdy=minthirdy;\n\n\n            if(getans(secondx,W,thirdy,H)<need)continue;\n\n            int fourthtatami=getans(firstx,W,0,thirdy);\n            if(fourthtatami>=need)return true;\n        }\n    }\n    return false;\n}\nint main()\n{\n    cin>>H>>W>>N;\n\n    for(int i=0;i<201;++i){\n        for(int j=0;j<201;++j){\n            field[i][j]=0;\n            sums[i][j]=0;\n        }\n    }\n    for(int i=0;i<H;++i){\n        for(int j=0;j<W;++j){\n            cin>>field[i][j];\n        }\n    }\n    for(int t=0;t<201;++t){\n        sums[0][t]=0;\n        sums[t][0]=0;\n    }\n    for(int y=0;y<H;++y){\n        for(int x=0;x<W;++x){\n            sums[y+1][x+1]=sums[y][x+1]+sums[y+1][x]-sums[y][x]+field[y][x];\n        }\n    }\n   \n    int ans;\n    {\n        int amin=0;\n        const int INF=1e9;\n        int amax=INF;\n        while(amin+1!=amax){\n            int amid=(amin+amax)/2;\n            bool ok=solve(0,W,0,H,N,amid);\n            if(ok)amin=amid;\n            else amax=amid;\n        }\n        ans=amin;\n    }\n    if(N==4){\n        {\n        int amin=0;\n        const int INF=1e9;\n        int amax=INF;\n        while(amin+1!=amax){\n            int amid=(amin+amax)/2;\n            bool ok=tatami(amid);\n            if(ok)amin=amid;\n            else amax=amid;\n        }\n        ans=max(ans,amin);\n          }\n        {\n            int nextsum[201][201];\n            for(int i=0;i<201;++i){\n                for(int j=0;j<201;++j){\n                    nextsum[j][i]=sums[i][j];\n                }\n            }\n            for(int i=0;i<201;++i){\n                for(int j=0;j<201;++j){\n                    sums[i][j]=nextsum[i][j];\n                }\n            }\n        }\n        {\n        int amin=0;\n        const int INF=1e9;\n        int amax=INF;\n        while(amin+1!=amax){\n            int amid=(amin+amax)/2;\n            bool ok=tatami(amid);\n            if(ok)amin=amid;\n            else amax=amid;\n        }\n        ans=max(ans,amin);\n          }\n    }\n    cout<<ans<<endl;\n    return 0;\n    \n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <iostream>\n#include <algorithm>\n#include <functional>\nusing namespace std;\nint main() {\n\tcin.tie(0);\n\tios_base::sync_with_stdio(false);\n\tint H, W, N;\n\tcin >> H >> W >> N;\n\tvector<vector<int> > s(H + 1, vector<int>(W + 1));\n\tfor (int i = 0; i < H; ++i) {\n\t\tfor (int j = 0; j < W; ++j) {\n\t\t\tcin >> s[i + 1][j + 1];\n\t\t\ts[i + 1][j + 1] += s[i + 1][j] + s[i][j + 1] - s[i][j];\n\t\t}\n\t}\n\tfunction<int(int, int, int, int)> sum = [&](int xa, int ya, int xb, int yb) {\n\t\treturn s[xa][ya] + s[xb][yb] - s[xa][yb] - s[xb][ya];\n\t};\n\tfunction<int(int, int, int, int)> solve2 = [&](int xa, int ya, int xb, int yb) {\n\t\tint res = 0;\n\t\tfor (int i = xa + 1; i <= xb - 1; ++i) {\n\t\t\tres = max(res, min(sum(xa, ya, i, yb), sum(i, ya, xb, yb)));\n\t\t}\n\t\tfor (int i = ya + 1; i <= yb - 1; ++i) {\n\t\t\tres = max(res, min(sum(xa, ya, xb, i), sum(xa, i, xb, yb)));\n\t\t}\n\t\treturn res;\n\t};\n\tfunction<int(int, int, int, int)> solve3 = [&](int xa, int ya, int xb, int yb) {\n\t\tint res = 0;\n\t\tfor (int i = xa + 1; i <= xb - 1; ++i) {\n\t\t\tres = max(res, min(sum(xa, ya, i, yb), solve2(i, ya, xb, yb)));\n\t\t\tres = max(res, min(solve2(xa, ya, i, yb), sum(i, ya, xb, yb)));\n\t\t}\n\t\tfor (int i = ya + 1; i <= yb - 1; ++i) {\n\t\t\tres = max(res, min(sum(xa, ya, xb, i), solve2(xa, i, xb, yb)));\n\t\t\tres = max(res, min(solve2(xa, ya, xb, i), sum(xa, i, xb, yb)));\n\t\t}\n\t\treturn res;\n\t};\n\tif (N == 2) cout << solve2(0, 0, H, W) << '\\n';\n\tif (N == 3) cout << solve3(0, 0, H, W) << '\\n';\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int sx,int sy,int gx,int gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n\n      if(used[i][j])break;\n\n      if(get_area(x,y,j,i)>=mid){\n\n\tint ch[201][201]={};\n\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    used[k][l]=1;\n\t\n\n\tif(dep==n-1)return 1;\n\t\n\tfor(int k=0;k<h;k++){\n\t  for(int l=0;l<w;l++){\n\t    if(!used[k][l]){\n\t      if((!k&&l&&used[k][l-1])||(k&&!l&&used[k-1][l])||(k&&l&&used[k][l-1]&&used[k-1][l])){\n\t        if(dfs(k,l,dep+1))return 1;\n\t      }\n\t      break;\n\t    }\n\t  }\n\t}\n\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(ch[k][l])used[k][l] = 0;\n      L:;\n\tbreak;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)cin>>a[i][j];\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=200000001;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing LL  = long long int;\n\nusing namespace std;\n\n#define int long long\n\n#define MAX_H 205\n#define MAX_W 205\n\nint H, W;\nint N;\n\nint A[MAX_H][MAX_W];\n\nint ASum[MAX_H][MAX_W];\nvoid makeSumA()\n{\n  for (int i = 0; i < H; i++) {\n    for (int j = 0; j < W; j++) {\n      ASum[i+1][j+1] = ASum[i+1][j] + ASum[i][j+1] - ASum[i][j] + A[i][j];\n    }\n  }\n}\n\nint calcA(int sx, int sy, int gx, int gy)\n{\n  return ASum[gy][gx] - ASum[gy][sx] - ASum[sy][gx] + ASum[sy][sx];\n}\n\nbool check(int cost, int depth, int sx, int sy, int gx, int gy)\n{\n  if(depth == 0){\n    return calcA(sx, sy, gx, gy) >= cost;\n  }\n\n  //テ」ツつ?」ツつ禿」ツ?ゥテ」ツ??・ツ?エテ・ツ青?\n  else if(depth == 3 || depth == 2){\n    //テァツクツヲテヲツ鳴ャテ」ツつ?\n    for (int dx = sx+1; dx < gx; dx++) {\n      for (int kil = 0; kil < depth; kil++) {\n        if(check(cost, kil, sx, sy, dx, gy) && check(cost, depth-kil-1, dx, sy, gx, gy)){\n          return true;\n        }\n      }\n    }\n\n    //テヲツィツェテ・ツ按?」ツつ?\n    for (int dy = sy+1; dy < gy; dy++) {\n      for (int kil = 0; kil < depth; kil++) {\n        if(check(cost, kil, sx, sy, gx, dy) && check(cost, depth-kil-1, sx, dy, gx, gy)){\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n  //テ」ツつ?」ツつ禿」ツ?ゥテ」ツ?湘」ツ?ェテ」ツ??・ツ?エテ・ツ青?\n  else{\n    //テ・ツキツヲテ」ツ?凝」ツつ嘉ィツイツェテヲツャツイテ」ツδ妥」ツつソテ」ツδシテ」ツδウ\n    for (int dx = sx+1; dx < gx; dx++) {\n      if(calcA(sx, sy, dx, gy) >= cost){\n        if(check(cost, depth-1, dx, sy, gx, gy)){\n          //fprintf(stderr, \"depth:%d, (%d, %d, %d, %d)\\n\", depth, sx, sy, gx, gy);\n          return true;\n        }\n        break;\n      }\n    }\n\n    //テ・ツ渉ウテ」ツ?凝」ツつ嘉ィツイツェテヲツャツイ\n    for (int dx = gx-1; sx < dx; dx--) {\n      if(calcA(dx, sy, gx, gy) >= cost){\n        if(check(cost, depth-1, sx, sy, dx, gy)){\n          //fprintf(stderr, \"depth:%d, (%d, %d, %d, %d)\\n\", depth, sx, sy, gx, gy);\n          return true;\n        }\n        break;\n      }\n    }\n\n    //テ、ツクツ甘」ツ?凝」ツつ嘉ィツイツェテヲツャツイ\n    for (int dy = sy+1; dy < gy; dy++) {\n      if(calcA(sx, sy, gx, dy) >= cost){\n        if(check(cost, depth-1, sx, dy, gx, gy)){\n          //fprintf(stderr, \"depth:%d, (%d, %d, %d, %d)\\n\", depth, sx, sy, gx, gy);\n          return true;\n        }\n        break;\n      }\n    }\n\n    //テ、ツクツ凝」ツ?凝」ツつ嘉ィツイツェテヲツャツイ\n    for (int dy = gy-1; sy < dy; dy--) {\n      if(calcA(sx, dy, gx, gy) >= cost){\n        if(check(cost, depth-1, sx, sy, gx, dy)){\n          //fprintf(stderr, \"depth:%d, (%d, %d, %d, %d)\\n\", depth, sx, sy, gx, gy);\n          return true;\n        }\n        break;\n      }\n    }\n\n    return false;\n  }\n\n}\n\nsigned main()\n{\n  cin >> H >> W >> N;\n  for (int i = 0; i < H; i++) {\n    for (int j = 0; j < W; j++) {\n      cin >> A[i][j];\n    }\n  }\n\n  makeSumA();\n\n  int l = 0, r = 1000000000;\n  while(r-l > 1){\n    int mid = (l+r)/2;\n    if(check(mid, N-1, 0, 0, W, H)){\n      l = mid;\n    }\n    else{\n      r = mid;\n    }\n  }\n  cout << l << endl;\n\n  //check(22, N-1, 0, 0, W, H);\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nint imos[201][201];\nint sum(int si, int sj, int li, int lj) {\n    return imos[li][lj] - imos[li][sj] - imos[si][lj] + imos[si][sj];\n}\nint sol2(int si, int sj, int li, int lj, int need) {\n    if (sum(si, sj, li, lj) / 2 <= need) return 0;\n    \n    int ret = 0;\n    for (int i = si; i < li; ++i) {\n        ret = max(ret, min(sum(si, sj, i, lj), sum(i, sj, li, lj)));\n    }\n    for (int i = sj; i < lj; ++i) {\n        ret = max(ret, min(sum(si, sj, li, i), sum(si, i, li, lj)));\n    }\n    return ret;\n}\nint sol3(int si, int sj, int li, int lj, int need) {\n    if (sum(si, sj, li, lj) / 3 <= need) return 0;\n \n    int ret = 0;\n    for (int i = si; i < li; ++i) {\n        ret = max(ret, min(sum(si, sj, i, lj), sol2(i, sj, li, lj, ret)));\n        ret = max(ret, min(sum(i, sj, li, lj), sol2(si, sj, i, lj, ret)));\n    }\n    for (int i = sj; i < lj; ++i) {\n        ret = max(ret, min(sum(si, sj, li, i), sol2(si, i, li, lj, ret)));\n        ret = max(ret, min(sum(si, i, li, lj), sol2(si, sj, li, i, ret)));\n    }\n    return ret;\n}\nint sol4(int si, int sj, int li, int lj) {\n    int ret = 0, s1, s2, s, ini, lim;\n    for (int i = si; i < li; ++i) {\n        ret = max(ret, min(sum(si, sj, i, lj), sol3(i, sj, li, lj, ret)));\n        ret = max(ret, min(sum(i, sj, li, lj), sol3(si, sj, i, lj, ret)));\n    }\n    for (int i = sj; i < lj; ++i) {\n        ret = max(ret, min(sum(si, sj, li, i), sol3(si, i, li, lj, ret)));\n        ret = max(ret, min(sum(si, i, li, lj), sol3(si, sj, li, i, ret)));\n    }\n    for (int i = si; i < li; ++i) {\n        for (int j = sj; j < lj; ++j) {\n            if (ret >= (s1 = sum(si, sj, i, j))) continue;\n            \n            for (int k = si; k < li; ++k) {\n                if (ret >= (s2 = sum(si, j, k, lj))) continue;\n                \n                s = min(s1, s2);\n                ini = k < i ? j : sj;\n                lim = k > i ? j : lj;\n                for (int l = ini; l < lim; ++l) {\n                    ret = max(ret, min(s, min(sum(i, sj, li, l), sum(k, l, li, lj))));\n                }\n            }\n        }\n    }\n    return ret;\n}\nint main(){\n    int h, w, n, a[200][200], s;\n    cin >> h >> w >> n;\n    for (int i = 0; i < h; ++i) {\n        s = 0;\n        for (int j = 0; j < w; ++j) {\n            cin >> a[i][j];\n            s += a[i][j];\n            imos[i + 1][j + 1] = imos[i][j + 1] + s;\n        }\n    }\n    switch (n) {\n        case 2:\n            cout << sol2(0, 0, h, w, 0) << \"\\n\";\n            break;\n        case 3:\n            cout << sol3(0, 0, h, w, 0) << \"\\n\";\n            break;\n        case 4:\n            cout << sol4(0, 0, h, w) << \"\\n\";\n            break;\n    }\n    \n    return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int sx,int sy,int gx,int gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n\n      if(get_area(x,y,j,i)>=mid){\n\n\tint ch[201][201]={};\n\t\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(used[k][l])goto L;\n\t    else ch[k][l] = 1;\n\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    used[k][l]=1;\n\t\n\n\tif(dep==n-1)return 1;\n\t\n\tfor(int k=0;k<h;k++){\n\t  for(int l=0;l<w;l++){\n\t    if(!used[k][l]){\n\t      if(dfs(k,l,dep+1))return 1;\n\t      break;\n\t    }\n\t  }\n\t}\n\n      L:;\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(ch[k][l])used[k][l] = 0;\n\t\n\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)cin>>a[i][j];\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=1e9;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing LL  = long long int;\n\nusing namespace std;\n\n#define int long long\n\n#define MAX_H 205\n#define MAX_W 205\n\nint H, W;\nint N;\n\nint A[MAX_H][MAX_W];\n\nint ASum[MAX_H][MAX_W];\nvoid makeSumA()\n{\n  for (int i = 0; i < H; i++) {\n    for (int j = 0; j < W; j++) {\n      ASum[i+1][j+1] = ASum[i+1][j] + ASum[i][j+1] - ASum[i][j] + A[i][j];\n    }\n  }\n}\n\nint calcA(int sx, int sy, int gx, int gy)\n{\n  return ASum[gy][gx] - ASum[gy][sx] - ASum[sy][gx] + ASum[sy][sx];\n}\n\nbool check(int cost, int depth, int sx, int sy, int gx, int gy)\n{\n  if(depth == 0){\n    return calcA(sx, sy, gx, gy) >= cost;\n  }\n\n  //?????¬???\n  for (int dx = sx+1; dx < gx; dx++) {\n    for (int kil = 0; kil < depth; kil++) {\n      if(check(cost, kil, sx, sy, dx, gy) && check(cost, depth-kil-1, dx, sy, gx, gy)){\n        return true;\n      }\n    }\n  }\n\n  //?¨???????\n  for (int dy = sy+1; dy < gy; dy++) {\n    for (int kil = 0; kil < depth; kil++) {\n      if(check(cost, kil, sx, sy, gx, dy) && check(cost, depth-kil-1, sx, dy, gx, gy)){\n        return true;\n      }\n    }\n  }\n\n  return false;\n\n}\n\nsigned main()\n{\n  cin >> H >> W >> N;\n  for (int i = 0; i < H; i++) {\n    for (int j = 0; j < W; j++) {\n      cin >> A[i][j];\n    }\n  }\n\n  makeSumA();\n\n  int l = 0, r = 1000000000;\n  while(r-l > 1){\n    int mid = (l+r)/2;\n    if(check(mid, N-1, 0, 0, W, H)){\n      l = mid;\n    }\n    else{\n      r = mid;\n    }\n  }\n  cout << l << endl;\n\n  //check(22, N-1, 0, 0, W, H);\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\ntypedef pair<int,int>P;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nset<P>st;\nint get_area(int &sx,int &sy,int &gx,int &gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){st.insert(P(y,x));\n  int m=1e9;\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n \n      if(used[i][j])break;\n      if(m<=j)break;\n \n      if(get_area(x,y,j,i)>=mid){\n        m=j;\n int f=1e9;\n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        if(used[k][l])goto L;\n     \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l]=1;\n     \n \n    if(dep==n-1)return 1;\n     \n    for(int k=0;k<h;k++){\n      for(int l=0;l<w;l++){\n        if(!used[k][l]&&l<f){\n          if((!k&&l&&used[k][l-1])||(k&&!l&&used[k-1][l])||(k&&l&&used[k][l-1]&&used[k-1][l])){\n            if(st.count(P(k,l)))break;\n            if(dfs(k,l,dep+1))return 1;\n          }\n          f=l;\n          break;\n        }\n      }\n    }\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l] = 0;\n      L:;\n    break;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)scanf(\"%d\",&a[i][j]);\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=1e9;\n  while(l<r){\n    st.clear();\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int &sx,int &sy,int &gx,int &gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n\n      if(used[i][j])break;\n\n      if(get_area(x,y,j,i)>=mid){\n\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(used[k][l])goto L;\n\t\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    used[k][l]=1;\n\t\n\n\tif(dep==n-1)return 1;\n\n\tif(i+1<h&&!used[i+1][x])dfs(i+1,x,dep+1);\n\tif(j+1<w&&!used[y][j+1])dfs(y,j+1,dep+1);\n\t\n        \n\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    used[k][l] = 0;\n      L:;\n\tbreak;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)scanf(\"%d\",&a[i][j]);\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=200000001;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "    #include <bits/stdc++.h>\n     \n    using namespace std;\n    #define rep2(i,m,n) for(int i=(int)(m);i<(int)(n);i++)\n    #define rep(i,n) rep2(i,0,n)\n    int h,w,n;\n    int a[210][210]={0};\n    int m[210][210]={0};\n     \n    int me(int h1,int h2,int w1,int w2){\n    \tint r=m[h2][w2]-m[h2][w1-1]-m[h1-1][w2]+m[h1-1][w1-1];\n    if(r<0) r=0;\n    return r;\n    }\n     \n    int ch(int h1,int h2,int w1,int w2){\n    int r=0;\n    for(int i=h1;i<h2;i++){\n    r=max(r,min(me(h1,i,w1,w2),me(i+1,h2,w1,w2)));\n    }\n    for(int i=w1;i<w2;i++){\n    r=max(r,min(me(h1,h2,w1,i),me(h1,h2,i+1,w2)));\n    }\n    return r;\n    }\n     \n     \n    int main() {\n    \t//int h,w,n;\n    cin>>h>>w>>n;\n    for(int i=1;i<=h;i++){\n    for(int j=1;j<=w;j++){\n    cin>>a[i][j];\n    m[i][j]=m[i-1][j]+m[i][j-1]-m[i-1][j-1]+a[i][j];\n    }\n    }\n     \n    if(n==2){\n    int r=0;\n    for(int i=1;i<h;i++){\n    r=max(r,min(me(1,i,1,w),me(i+1,h,1,w)));\n    }\n    for(int i=1;i<w;i++){\n    r=max(r,min(me(1,h,1,i),me(1,h,i+1,w)));\n    }\n    cout<<r<<endl;\n    return 0;\n     \n    }\n     \n    if(n==3){\n    int r=0;\n    for(int i=1;i<h;i++){\n    r=max(r,min(ch(1,i,1,w),me(i+1,h,1,w)));\n    //cout<<r<<endl;\n    r=max(r,min(ch(i+1,h,1,w),me(1,i,1,w)));\n    //cout<<r<<endl;\n     \n    }\n    for(int i=1;i<w;i++){\n    r=max(r,min(ch(1,h,1,i),me(1,h,i+1,w)));\n    r=max(r,min(ch(1,h,i+1,w),me(1,h,1,i)));\n    //cout<<r<<endl;\n    }\n     \n     \n    cout<<r<<endl;\n    }\n     \n    if(n==4){\n    int r=0;\n    int e;\n    for(int i=1;i<h;i++){\n    for(int j=i;j<h;j++){\n    for(int k=1;k<w;k++){\n    for(int l=k;l<w;l++){\n    e=min(min(me(1,i,1,l),me(1,j,l+1,w)),min(me(i+1,h,1,k),me(j+1,h,k+1,w)));\n    r=max(r,e);\n    e=min(min(me(1,j,1,k),me(1,i,k+1,w)),min(me(j+1,h,1,l),me(i+1,h,l+1,w)));\n    r=max(r,e);\n    }\n    }\n    }\n    }\n     \n    for(int i=1;i<h;i++){\n    for(int j=i;j<h;j++){\n    e=min(me(1,i,1,w),min(me(i+1,j,1,w),ch(j+1,h,1,w)));\n    r=max(r,e);\n    e=min(me(1,i,1,w),min(ch(i+1,j,1,w),me(j+1,h,1,w)));\n    r=max(r,e);\n    e=min(ch(1,i,1,w),min(me(i+1,j,1,w),me(j+1,h,1,w)));\n    r=max(r,e);\n    }\n    }\n     \n     \n     \n    for(int i=1;i<h;i++){\n    for(int j=1;j<w;j++){\n    e=min(ch(1,h,1,i),min(me(1,j,i+1,w),me(j+1,h,i+1,w)));\n    r=max(r,e);\n    e=min(me(1,h,1,i),min(ch(1,j,i+1,w),me(j+1,h,i+1,w)));\n    r=max(r,e);\n    e=min(me(1,h,1,i),min(me(1,j,i+1,w),ch(j+1,h,i+1,w)));\n    r=max(r,e);\n     \n    e=min(ch(1,j,1,i),min(me(j+1,h,1,i),me(1,h,i+1,w)));\n    r=max(r,e);\n    e=min(me(1,j,1,i),min(ch(j+1,h,1,i),me(1,h,i+1,w)));\n    r=max(r,e);\n    e=min(me(1,j,1,i),min(me(j+1,h,1,i),ch(1,h,i+1,w)));\n    r=max(r,e);\n    }\n    }\n     \n     \n    for(int i=1;i<w;i++){\n    for(int j=i;j<w;j++){\n    e=min(me(1,h,1,i),min(me(1,h,i+1,j),ch(1,h,j+1,w)));\n    r=max(r,e);\n    e=min(ch(1,h,1,i),min(me(1,h,i+1,j),me(1,h,j+1,w)));\n    r=max(r,e);\n    e=min(me(1,h,1,i),min(ch(1,h,i+1,j),me(1,h,j+1,w)));\n    r=max(r,e);\n    }\n    }\n     \n     \n    for(int i=1;i<h;i++){\n    for(int j=1;j<w;j++){\n    e=min(ch(1,i,1,w),min(me(i+1,h,1,j),me(i+1,h,j+1,w)));\n    r=max(r,e);\n    e=min(me(1,i,1,w),min(me(i+1,h,1,j),ch(i+1,h,j+1,w)));\n    r=max(r,e);\n    e=min(me(1,i,1,w),min(ch(i+1,h,1,j),me(i+1,h,j+1,w)));\n    r=max(r,e);\n     \n    e=min(ch(1,i,1,j),min(me(1,i,j+1,w),me(i+1,h,1,w)));\n    r=max(r,e);\n    e=min(me(1,i,1,j),min(ch(1,i,j+1,w),me(i+1,h,1,w)));\n    r=max(r,e);\n    e=min(me(1,i,1,j),min(me(1,i,j+1,w),ch(i+1,h,1,w)));\n    r=max(r,e);\n     \n     \n    }\n    }\n     \n     \n    cout<<r<<endl;\n    }\n     \n     \n        return 0;\n    }"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <iostream>\n#include <algorithm>\n#include <functional>\nusing namespace std;\nint main() {\n\tcin.tie(0);\n\tios_base::sync_with_stdio(false);\n\tint H, W, N;\n\tcin >> H >> W >> N;\n\tvector<vector<int> > s(H + 1, vector<int>(W + 1));\n\tfor (int i = 0; i < H; ++i) {\n\t\tfor (int j = 0; j < W; ++j) {\n\t\t\tcin >> s[i + 1][j + 1];\n\t\t\ts[i + 1][j + 1] += s[i + 1][j] + s[i][j + 1] - s[i][j];\n\t\t}\n\t}\n\tfunction<int(int, int, int, int)> sum = [&](int xa, int ya, int xb, int yb) {\n\t\treturn s[xa][ya] + s[xb][yb] - s[xa][yb] - s[xb][ya];\n\t};\n\tfunction<int(int, int, int, int)> solve2 = [&](int xa, int ya, int xb, int yb) {\n\t\tint res = 0;\n\t\tfor (int i = xa + 1; i <= xb - 1; ++i) {\n\t\t\tres = max(res, min(sum(xa, ya, i, yb), sum(i, ya, xb, yb)));\n\t\t}\n\t\tfor (int i = ya + 1; i <= yb - 1; ++i) {\n\t\t\tres = max(res, min(sum(xa, ya, xb, i), sum(xa, i, xb, yb)));\n\t\t}\n\t\treturn res;\n\t};\n\tfunction<int(int, int, int, int)> solve3 = [&](int xa, int ya, int xb, int yb) {\n\t\tint res = 0;\n\t\tfor (int i = xa + 1; i <= xb - 1; ++i) {\n\t\t\tres = max(res, min(sum(xa, ya, i, yb), solve2(i, ya, xb, yb)));\n\t\t\tres = max(res, min(solve2(xa, ya, i, yb), sum(i, ya, xb, yb)));\n\t\t}\n\t\tfor (int i = ya + 1; i <= yb - 1; ++i) {\n\t\t\tres = max(res, min(sum(xa, ya, xb, i), solve2(xa, i, xb, yb)));\n\t\t\tres = max(res, min(solve2(xa, ya, xb, i), sum(xa, i, xb, yb)));\n\t\t}\n\t\treturn res;\n\t};\n\tif (N == 2) cout << solve2(0, 0, H, W) << '\\n';\n\tif (N == 3) cout << solve3(0, 0, H, W) << '\\n';\n\tif (N == 4) {\n\t\tint res = 0;\n\t\tfor (int i = 1; i <= H - 1; ++i) {\n\t\t\tres = max(res, min(sum(0, 0, i, W), solve3(i, 0, H, W)));\n\t\t\tres = max(res, min(solve2(0, 0, i, W), solve2(i, 0, H, W)));\n\t\t\tres = max(res, min(solve3(0, 0, i, W), sum(i, 0, H, W)));\n\t\t}\n\t\tfor (int i = 1; i <= W - 1; ++i) {\n\t\t\tres = max(res, min(sum(0, 0, H, i), solve3(0, i, H, W)));\n\t\t\tres = max(res, min(solve2(0, 0, H, i), solve2(0, i, H, W)));\n\t\t\tres = max(res, min(solve3(0, 0, H, i), sum(0, i, H, W)));\n\t\t}\n\t\tfor (int i = 1; i <= W - 1; ++i) {\n\t\t\tfor (int j = i + 1; j <= W - 1; ++j) {\n\t\t\t\tvector<int> ax(H - 1), ay(H - 1);\n\t\t\t\tfor (int k = 1; k <= H - 1; ++k) {\n\t\t\t\t\tax[k - 1] = min(sum(0, j, k, W), sum(k, i, H, W));\n\t\t\t\t\tay[k - 1] = min(sum(0, i, k, W), sum(k, j, H, W));\n\t\t\t\t}\n\t\t\t\tint curx = 0;\n\t\t\t\tfor (int k = 0; k <= H - 2; ++k) {\n\t\t\t\t\tcurx = max(curx, min(sum(0, 0, k, j), sum(k, 0, H, i)));\n\t\t\t\t\tres = max(res, min(ax[k], curx));\n\t\t\t\t}\n\t\t\t\tint cury = 0;\n\t\t\t\tfor (int k = H - 2; k >= 0; --k) {\n\t\t\t\t\tcury = max(cury, min(sum(0, 0, k + 1, i), sum(k + 1, 0, H, j)));\n\t\t\t\t\tres = max(res, min(ay[k], cury));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout << res << '\\n';\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define INF 1LL<<60\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll,ll> P;\n\nll sum[205][205];\nll a[205][205];\n\n\n// return [ly,ry)*[lx,rx)\nll getsum(int ly,int ry,int lx,int rx){\n\t//printf(\"%d %d %d %d %lld\\n\",ly,ry,lx,rx,sum[ry][rx]-sum[ry][lx]-sum[ly][rx]+sum[ly][lx]);\n\treturn sum[ry][rx]-sum[ry][lx]-sum[ly][rx]+sum[ly][lx];\n}\n\nll calc_two(int ly,int ry,int lx,int rx){\n\tll res=0;\n\tfor(int i=ly;i<ry;i++){\n\t\tll v1=getsum(i,ry,lx,rx);\n\t\tll v2=getsum(ly,i,lx,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tfor(int i=lx;i<rx;i++){\n\t\tll v1=getsum(ly,ry,lx,i);\n\t\tll v2=getsum(ly,ry,i,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\treturn res;\n}\n\nll solve(int ly,int ry,int lx,int rx,int n){\n\tif(n==2)return calc_two(ly,ry,lx,rx);\n\tll res=0;\n\tfor(int i=ly;i<ry;i++){\n\t\tll v1=solve(i,ry,lx,rx,n-1);\n\t\tll v2=getsum(ly,i,lx,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t\tv1=getsum(i,ry,lx,rx);\n\t\tv2=solve(ly,i,lx,rx,n-1);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tfor(int i=lx;i<rx;i++){\n\t\tll v1=solve(ly,ry,lx,i,n-1);\n\t\tll v2=getsum(ly,ry,i,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t\tv1=getsum(ly,ry,lx,i);\n\t\tv2=solve(ly,ry,i,rx,n-1);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tif(n==3)return res;\n\tfor(int i=ly;i<ry;i++){\n\t\tll v1=solve(i,ry,lx,rx,2);\n\t\tll v2=solve(ly,i,lx,rx,2);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tfor(int i=lx;i<rx;i++){\n\t\tll v1=solve(ly,ry,lx,i,2);\n\t\tll v2=solve(ly,ry,i,rx,2);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tfor(int i=0;i<ry-1;i++){\n\t\tfor(int j=0;j<rx-1;j++){\n\t\t\tll v1=getsum(0,i,0,j);\n\t\t\tif(v1<=res)continue;\n\t\t\tint l=ly;\n\t\t\tfor(int k=1;k<j;k++){\n\t\t\t\tll v2=getsum(i,ry,0,k);\n\t\t\t\twhile(l>i && getsum(0,l,j,rx)>getsum(l,ry,k,rx)){\n\t\t\t\t\tl--;\n\t\t\t\t}\n\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,l,j,rx),getsum(l,ry,k,rx)))));\n\t\t\t}\n\t\t\tl=i;\n\t\t\tfor(int k=j;k<rx-1;k++){\n\t\t\t\tll v2=getsum(i,ry,0,k);\n\t\t\t\twhile(l>i && getsum(0,l,j,rx)>getsum(l,ry,k,rx)){\n\t\t\t\t\tl--;\n\t\t\t\t}\n\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,l,j,rx),getsum(l,ry,k,rx)))));\n\t\t\t}\n\t\t}\n\t}\n\treturn res;\n}\n\n\nint main(void){\n\tint h,w,n;\n\tscanf(\"%d%d%d\",&h,&w,&n);\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tscanf(\"%lld\",&a[i][j]);\n\t\t\tsum[i+1][j+1]+=a[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<=h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tsum[i][j+1]+=sum[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<=w;i++){\n\t\tfor(int j=0;j<h;j++){\n\t\t\tsum[j+1][i]+=sum[j][i];\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",solve(0,h,0,w,n));\n\treturn 0;\n} \n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define EPS 1e-10\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;--i)\n#define srep(i,s,t) for(int i=(int)(s);i<(int)(t);++i)\n#define each(a,b) for(auto& (a): (b))\n#define all(v) (v).begin(),(v).end()\n#define len(v) (int)(v).size()\n#define zip(v) sort(all(v)),v.erase(unique(all(v)),v.end())\n#define cmx(x,y) x=max(x,y)\n#define cmn(x,y) x=min(x,y)\n#define fi first\n#define se second\n#define pb push_back\n#define show(x) cout<<#x<<\" = \"<<(x)<<endl\n#define spair(p) cout<<#p<<\": \"<<p.fi<<\" \"<<p.se<<endl\n#define sar(a,n) cout<<#a<<\":\";rep(kbrni,n)cout<<\" \"<<a[kbrni];cout<<endl\n#define svec(v) cout<<#v<<\":\";rep(kbrni,v.size())cout<<\" \"<<v[kbrni];cout<<endl\n#define svecp(v) cout<<#v<<\":\";each(kbrni,v)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n#define sset(s) cout<<#s<<\":\";each(kbrni,s)cout<<\" \"<<kbrni;cout<<endl\n#define smap(m) cout<<#m<<\":\";each(kbrni,m)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n\nusing namespace std;\n\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<P> vp;\ntypedef vector<string> vs;\n\nconst int MAX_N = 205;\n\nint h,w,n;\n\nint a[MAX_N][MAX_N];\nint tmp[MAX_N][MAX_N];\nint sm[MAX_N][MAX_N];\n\nint cal(int ul,int dr,int dl,int ur)\n{\n    return sm[dl+1][ur+1]-sm[dl+1][dr]-sm[ul][dr+1]+sm[ul][dr];\n}\n\nvoid rot(int h,int w)\n{\n    rep(i,h){\n        rep(j,w){\n            tmp[i][j] = a[i][j];\n        }\n    }\n    rep(i,w){\n        rep(j,h){\n            a[i][j] = tmp[j][w-1-i];\n        }\n    }\n}\n\nvoid sym(int h,int w){\n    rep(i,h){\n        rep(j,w){\n            tmp[i][j] = a[i][j];\n        }\n    }\n    rep(i,h){\n        rep(j,w){\n            a[i][j] = tmp[i][w-1-j];\n        }\n    }\n}\n\nvoid calcsum(int h,int w)\n{\n    rep(i,h+1){\n        rep(j,w+1){\n            sm[i][j] = 0;\n        }\n    }\n    rep(i,h){\n        rep(j,w){\n            sm[i+1][j+1] = sm[i+1][j] + a[i][j];\n        }\n    }\n    rep(j,w+1){\n        rep(i,h){\n            sm[i+1][j] += sm[i][j];\n        }\n    }\n}\n\nint solve(int h,int w,int n)\n{\n    calcsum(h,w);\n    int mx = -1;\n    if(n == 4){\n        rep(i,w-1){\n            rep(j,h-1){\n                rep(k,h-1){\n                    cmx(mx,min({cal(0,0,i,j),cal(j+1,0,h-1,i),cal(0,i+1,h,w-1),cal(h+1,i+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-1){\n            rep(j,h-2){\n                srep(k,j+1,h-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(j+1,0,k,i),cal(k+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n                }\n            }\n        }\n        sym(h,w);\n        calcsum(h,w);\n        rep(i,w-1){\n            rep(j,h-2){\n                srep(k,j+1,h-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(j+1,0,k,i),cal(k+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-3){\n            srep(j,i+1,w-2){\n                srep(k,j+1,w-1){\n                    cmx(mx,min({cal(0,0,h-1,i),cal(0,i+1,h-1,j),cal(0,j+1,h-1,k),cal(0,k+1,h-1,w-1)}));\n                }\n            }\n        }\n    }else if(n == 3){\n        rep(i,w-1){\n            rep(j,h-1){\n                cmx(mx,min({cal(0,0,j,i),cal(j+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n            }\n        }\n        sym(h,w);\n        calcsum(h,w);\n        rep(i,w-1){\n            rep(j,h-1){\n                cmx(mx,min({cal(0,0,j,i),cal(j+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n            }\n        }\n        rep(i,w-2){\n            srep(j,i+1,w-1){\n                cmx(mx,min({cal(0,0,h-1,i),cal(0,i+1,h-1,j),cal(0,j+1,h-1,w-1)}));\n            }\n        }\n    }else{\n        rep(i,w-1){\n            cmx(mx,min(cal(0,0,h-1,i),cal(0,i+1,h-1,w-1)));\n        }\n    }\n    return mx;\n}\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cin >> h >> w >> n;\n    rep(i,h){\n        rep(j,w){\n            cin >> a[i][j];\n        }\n    }\n    int r1 = solve(h,w,n);\n    rot(h,w);\n    swap(h,w);\n    int r2 = solve(h,w,n);\n    cout << max(r1,r2) << \"\\n\";\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int &sx,int &sy,int &gx,int &gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  int m=1e9;\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n \n      if(used[i][j])break;\n      if(m<=j)break;\n \n      if(get_area(x,y,j,i)>=mid){\n        m=j;\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        if(used[k][l])goto L;\n     \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l]=1;\n     \n \n    if(dep==n-1)return 1;\n     \n    for(int k=0;k<h;k++){\n      for(int l=0;l<w;l++){\n        if(!used[k][l]){\n          if((!k&&l&&used[k][l-1])||(k&&!l&&used[k-1][l])||(k&&l&&used[k][l-1]&&used[k-1][l])){\n            if(dfs(k,l,dep+1))return 1;\n          }\n          break;\n        }\n      }\n    }\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l] = 0;\n      L:;\n    break;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)scanf(\"%d\",&a[i][j]);\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=200000001;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#ifndef _WIN32\n#include<iostream>\n#endif\n#include<string>\n#include<iomanip>\n#include<vector>\n#include<algorithm>\n#include<stack>\n\nusing namespace std;\n\n#define FOR(i,bg,ed) for(int i=(bg);i<(ed);i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(v) (v).begin(),(v).end()\n\ntemplate<typename T>\nbool chmin(T&l, T r) { bool f = l > r; if (f)l = r; return f; }\ntemplate<typename T>\nbool chmax(T&l, T r) { bool f = l < r; if (f)l = r; return f; }\ntypedef long long LL;\ntypedef vector<LL> V;\ntypedef vector<V> VV;\n#define DCrc(R,C,v) int R=v.size(),C=v[0].size(); \nVV sub(VV x, int t, int b, int l, int r) {\n\tint R = b - t;\n\tint C = r - l;\n\tVV y(R, V(C));\n\tFOR(i, t, b)FOR(j, l, r)y[i - t][j - l] = x[i][j];\n\treturn y;\n}\nVV rot(VV x) {\n\tDCrc(R, C, x);\n\tVV y(C,V(R));\n\tREP(i, C)REP(j, R) {\n\t\ty[i][j] = x[j][C - i-1];\n\t}\n\treturn y;\n}\nVV setsum(VV& x) {\n\tDCrc(R, C, x);\n\tVV y(R + 1, V(C + 1, 0));\n\tREP(i, R)REP(j, C)\n\t\ty[i + 1][j + 1] = x[i][j] + y[i + 1][j] + y[i][j + 1] - y[i][j];\n\treturn y;\n}\nLL getsum(VV &x, int t, int b, int l, int r) {\n\treturn x[b][r] + x[t][l] - x[b][l] - x[t][r];\n}\nLL f2(VV x) {\n\tDCrc(R, C, x);\n\tauto S = setsum(x);\n\tLL res = 0;\n\tFOR(i,1, R)chmax(res, min(getsum(S, 0, i, 0, C) ,getsum(S, i, R, 0, C)));\n\tFOR(i,1, C)chmax(res, min(getsum(S, 0, R, 0, i) ,getsum(S, 0, R, i, C)));\n\treturn res;\n}\nLL f3(VV x) {\n\tLL res = 0;\n\tREP(_, 4) {\n\t\tDCrc(R, C, x);\n\t\tauto S = setsum(x);\n\t\tFOR(i,1, R)FOR(j, i + 1, R)\n\t\t\tchmax(res, min({\n\t\t\tgetsum(S, 0, i, 0, C),\n\t\t\tgetsum(S, i, j, 0, C),\n\t\t\tgetsum(S, j, R, 0, C)\n\t\t}));\n\t\tFOR(i,1, R)FOR(j,1,C)\n\t\t\tchmax(res, min({\n\t\t\tgetsum(S, 0, i, 0, C),\n\t\t\tgetsum(S, i, R, 0, j),\n\t\t\tgetsum(S, i, R, j, C)\n\t\t}));\n\t\tx = rot(x);\n\t}\n\treturn res;\n}\nLL f4(VV x) {\n\tLL res = 0;\n\tREP(_, 4) {\n\t\tDCrc(R, C, x);\n\t\tauto S = setsum(x);\n\t\tFOR(i, 1, R) {\n\t\t\tchmax(res, min(\n\t\t\t\tgetsum(S, 0, i, 0, C),\n\t\t\t\tf3(sub(x, i, R, 0, C))\n\t\t\t\t));\n\t\t}\n\t\tFOR(a, 1, R)FOR(b, 1, C) {\n\t\t\tLL lb = getsum(S, 0, a, 0, b);\n\t\t\tint c = 0;\n\t\t\tint d = 0;\n\n\t\t\twhile (c < C&&getsum(S, a, R, 0, c) < lb)c++;\n\t\t\twhile (d < R&&getsum(S, 0, d, b, C) < lb)d++;\n\t\t\tif (c == C || d == R)continue;\n\t\t\tif (d > a&&c > b)continue;\n\t\t\tLL k;\n\t\t\tif (d > a||c > b) {\n\t\t\t\tk = getsum(S, d, R, c, C);\n\t\t\t}\n\t\t\telse k = max({\n\t\t\t\tgetsum(S, d, R, b, C),\n\t\t\t\tgetsum(S, a, R, c, C)\n\t\t\t});\n\t\t\tchmax(res, min(lb,k));\n\t\t}\n\t\tx = rot(x);\n\t}\n\treturn res;\n}\n\n\nint main() {\n\tint R, C, N;\n\tcin >> R >> C >> N;\n\t{\n\t\tVV x(R, V(C));\n\t\tREP(i, R)REP(j, C)cin >> x[i][j];\n\t\tif (N == 2)cout << f2(x) << endl;\n\t\tif (N == 3)cout << f3(x) << endl;\n\t\tif (N == 4)cout << f4(x) << endl;\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <algorithm>\n#include <cstring>\n#include <string>\n#include <iostream>\n#include <cassert>\n#include <complex>\n\nusing namespace std;\ntypedef long long ll;\n\nconst int SIZE = 201;\n\nint n, h, w;\nint a[SIZE][SIZE], sa[SIZE][SIZE];\n\nvoid rotate() {\n\tint b[SIZE][SIZE];\n\n\tfor (int i = 0; i<h; i++) {\n\t\tfor (int j = 0; j<w; j++) {\n\t\t\tb[w - j - 1][h - i - 1] = a[i][j];\n\t\t}\n\t}\n\n\tswap(h, w);\n\n\tfor (int i = 0; i<h; i++) {\n\t\tfor (int j = 0; j<w; j++) {\n\t\t\ta[i][j] = b[i][j];\n\t\t}\n\t}\n\n  \n}\n\nvoid calc_sum() {\n\tfor (int i = 0; i<h; i++)\n\t\tfor (int j = 0; j<w; j++)\n\t\t\tsa[i + 1][j + 1] = a[i][j];\n\n\n\tfor (int i = 0; i <= h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\tsa[i][j + 1] += sa[i][j];\n\t\t}\n\t}\n\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j <= w; j++) {\n\t\t\tsa[i + 1][j] += sa[i][j];\n\t\t}\n\t}\n}\n\n\nint getrangesum(int u, int l, int d, int r) { // [(u, l),(d, r)) \n\treturn sa[d][r] + sa[u][l] - sa[d][l] - sa[u][r];\n}\n\n\nint check(int l, int m, int r, int X) {\n  int res = -1;\n\tfor (int i = 1; i<h; i++) {\n\t\tif (getrangesum(0, l, i, m) >= X && getrangesum(i, l, h, r) >= X) res = i;\n\t}\n\treturn res;\n}\n\nint check2(int l, int m, int r, int X) {\n  int res = -1;\n\tfor (int i = h - 1; i>0; i--) {\n\t\tif (getrangesum(0, l, i, r) >= X && getrangesum(i, m, h, r) >= X) res = i;;\n\t}\n\treturn res;\n}\n\n\n//[)\nbool checkE(int h0, int w0, int h1, int w1, int mid, int k)\n{\n\tif (k == 1) {\n\t\treturn getrangesum(h0, w0, h1, w1) >= mid;\n\t}\n\n\tfor (int i = 1; i < w; ++i)\n\t{\n\t\tauto left = getrangesum(h0, w0, h1, i);\n\t\tauto right = getrangesum(h0, i, h1, w1);\n\n\t\tif (left >= mid && right >= (k-1) * mid) {\n\t\t\tif (checkE(h0, i, h1, w1, mid, k-1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\tif (right >= mid && left >= (k-1) * mid) {\n\t\t\tif (checkE(h0, w0, h1, i, mid, k-1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n    if (k == 4 && right >= mid*2 && left >= 2 * mid) {\n\t\t\tif (checkE(h0, i, h1, w1, mid, 2) && checkE(h0, w0, h1, i, mid, 2)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (int j = 1; j < h; ++j)\n\t{\n\t\tauto up = getrangesum(h0, w0, j, w1);\n\t\tauto down = getrangesum(j, w0, h1, w1);\n\n\t\tif (up >= mid && down >= (k-1) * mid) {\n\t\t\tif (checkE(j, w0, h1, w1, mid, k - 1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\tif (down >= mid && up >= (k-1) * mid) {\n\t\t\tif (checkE(h0, w0, j, w1, mid, k - 1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n    if (k == 4 && up >= mid*2 && down >= 2 * mid) {\n\t\t\tif (checkE(j, w0, h1, w1, mid, 2) && checkE(h0, w0, j, w1, mid, 2)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n  return false;\n}\n\nint main() {\n\n\tscanf(\"%d%d%d\", &h, &w, &n);\n\n\tfor (int i = 0; i<h; i++) {\n\t\tfor (int j = 0; j<w; j++) {\n\t\t\tscanf(\"%d\", a[i] + j);\n\t\t}\n\t}\n\n\tint ans = 0;\n\n\tif (n == 4 && w >= 3) {\n\t\tfor (int p = 0; p<2; p++) {\n\t\t\trotate();\n\t\t\tcalc_sum();\n\n\t\t\tfor (int i = 1; i<w; i++) {\n\t\t\t\tfor (int j = i + 1; j <= w; j++) {\n\t\t\t\t\tint l = 0, r = sa[h][w];\n\t\t\t\t\twhile (l < r) {\n\t\t\t\t\t\tint mid = (l + r + 1) / 2;\n\n            int res1 = check(0, i, j, mid);\n            int res2 = check2(i, j, w, mid);\n            \n\t\t\t\t\t\tif (res1 != -1 && res2 != -1 && res1 <= res2) {\n\t\t\t\t\t\t\tl = mid;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tr = mid - 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n          //cerr << l << endl;\n\t\t\t\t\tans = max(ans, l);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\tcalc_sum();\n\tint l = 0, r = sa[h][w];\n\twhile (l < r) {\n\t\tint mid = (l + r + 1) / 2;\n\n\t\tif (checkE(0,0,h, w, mid, n)) {\n\t\t\tl = mid;\n\t\t}\n\t\telse {\n\t\t\tr = mid - 1;\n\t\t}\n\t}\n  //cerr << l << endl;\n\tans = max(ans, l);\n\n\tstd::cout << ans << std::endl;\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\nvector<vector<Int> > a;\nvector<vector<Int> > s;\ninline Int rect(Int sy,Int sx,Int ty,Int tx){\n  //cout<<sy<<\" \"<<sx<<\":\"<<ty<<\" \"<<tx<<endl;\n  return s[ty][tx]+s[sy][sx]-(s[sy][tx]+s[ty][sx]);\n}\nInt dfs(Int sy,Int sx,Int ty,Int tx,Int k){\n  if(k==0) return rect(sy,sx,ty,tx);\n  Int res=0;\n  if(k==1){\n    {\n      Int l=sy,r=ty;\n      while(l+1<r){\n\tInt m=(l+r)>>1;\n\tif(rect(sy,sx, m,tx)<=rect( m,sx,ty,tx)) l=m;\n\telse r=m;\n      }\n      res=max(res,min(rect(sy,sx, l,tx),\n\t\t      rect( l,sx,ty,tx)));\n      res=max(res,min(rect(sy,sx, r,tx),\n\t\t      rect( r,sx,ty,tx)));\n    }\n    {\n      Int l=sx,r=tx;\n      while(l+1<r){\n\tInt m=(l+r)>>1;\n\tif(rect(sy,sx,ty, m)<=rect(sy, m,ty,tx)) l=m;\n\telse r=m;\n      }\n      res=max(res,min(rect(sy,sx,ty, l),\n\t\t      rect(sy, l,ty,tx)));\n      res=max(res,min(rect(sy,sx,ty, r),\n\t\t      rect(sy, r,ty,tx)));\n    }\n    return res;\n  }\n  for(Int i=sy;i<ty;i++){\n    for(Int j=0;j<k;j++)\n    res=max(res,min(dfs(sy,sx, i,tx,     j),\n\t\t    dfs( i,sx,ty,tx,k-(j+1))));\n  }\n  for(Int i=sx;i<tx;i++){\n    for(Int j=0;j<k;j++)\n      res=max(res,min(dfs(sy,sx,ty, i,     j),\n\t\t      dfs(sy, i,ty,tx,k-(j+1))));\n  }\n  return res;\n}\nsigned main(){\n  Int h,w,n;\n  cin>>h>>w>>n;\n  a.resize(h,vector<Int>(w));\n  s.resize(h+1,vector<Int>(w+1,0));\n  for(Int i=0;i<h;i++)\n    for(Int j=0;j<w;j++)\n      cin>>a[i][j];\n\n\n  for(Int i=0;i<h;i++)\n    for(Int j=0;j<w;j++)\n      s[i+1][j+1]=s[i+1][j]+a[i][j];\n\n  for(Int j=0;j<=w;j++)\n    for(Int i=0;i<h;i++)\n      s[i+1][j]+=s[i][j];\n\n  if(0){\n    for(Int i=0;i<=h;i++){\n      for(Int j=0;j<=w;j++){\n\tprintf(\"%lld \",s[i][j]);\n      }\n      cout<<endl;\n    }\n  }\n\n  Int ans=dfs(0,0,h,w,n-1);\n  if(n==4){\n    for(int y1=0;y1<=h;y1++){\n      for(int y2=y1;y2<=h;y2++){\n\tfor(int x1=0;x1<=w;x1++){\n\t  for(int x2=x1;x2<=w;x2++){\n\t    ans=max(ans,\n\t\t    min({ rect( 0, 0,y2,x1),\n\t\t\t  rect(y2, 0, h,x2),\n\t\t\t  rect(y1,x2, h, w),\n\t\t\t  rect(0 ,x1,y1, w)}));\n\t    \n\t    ans=max(ans,\n\t\t    min({ rect( 0, 0,y1,x2),\n\t\t\t  rect(y1, 0, h,x1),\n\t\t\t  rect(y2,x1, h, w),\n\t\t\t  rect( 0,x2,y2, w)}));\n\t  }\n\t}\n      }\n    }\n  }\n  \n  cout<<ans<<endl;\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\n\nconst int MAX_H = 210;\nconst int MAX_W = 210;\n\nll a[MAX_H][MAX_W];\n\nvoid init(int H, int W){\n\tfor(int i = 0;i <= H;i++){\n\t\tfor(int j = 1;j <= W;j++){\n\t\t\ta[i][j] += a[i][j - 1];\n\t\t}\n\t}\n\tfor(int j = 0;j <= W;j++){\n\t\tfor(int i = 1;i <= H;i++){\n\t\t\ta[i][j] += a[i - 1][j];\n\t\t}\n\t}\n}\n\nll sum(int li, int lj, int ri, int rj){\n\treturn a[ri][rj] - a[ri][lj] - a[li][rj] + a[li][lj];\n}\n\nll calc(int li, int lj, int ri, int rj, int n){\n\tif(n == 1) return sum(li, lj, ri, rj);\n\tll res = 0;\n\tfor(int i = li;i <= ri;i++){\n\t\tfor(int j = 1;j < n;j++){\n\t\t\tres = max(res, min(calc(li, lj, i, rj, j), calc(i, lj, ri, rj, n - j)));\n\t\t}\n\t}\n\tfor(int j = lj;j <= rj;j++){\n\t\tfor(int i = 1;i < n;i++){\n\t\t\tres = max(res, min(calc(li, lj, ri, j, i), calc(li, j, ri, rj, n - i)));\n\t\t}\n\t}\n\treturn res;\n}\n\nbool judge(int H, int W, int m){\n\tif(m == 0) return true;\n\tfor(int i = 1;i <= H;i++){\n\t\tint j = 0;\n\t\twhile(j <= W && sum(0, 0,i, j) < m) ++j;\n\t\tif(j > W) continue;\n\t\tint k = 0;\n\t\twhile(k <= i && sum(0, j, k, W) < m) ++k;\n\t\tif(k > i) continue;\n\t\tint l = j;\n\t\twhile(l <= W && sum(i, 0, H, l) < m) ++l;\n\t\tif(l > W) continue;\n\t\tif(sum(k, l, H, W) >= m) return true;\n\t}\n\tfor(int i = 1;i <= W;i++){\n\t\tint j = 0;\n\t\twhile(j <= H && sum(0, 0, j, i) < m) ++j;\n\t\tif(j > H) continue;\n\t\tint k = 0;\n\t\twhile(k <= i && sum(j, 0, H, k) < m) ++k;\n\t\tif(k > i) continue;\n\t\tint l = j;\n\t\twhile(l <= H && sum(0, i, l, W) < m) ++l;\n\t\tif(l > H) continue;\n\t\tif(sum(l, k, H, W) >= m) return true;\n\t}\n\treturn false;\n}\n\nint main()\n{\n\tint H, W, N;\n\tcin >> H >> W >> N;\n\tfor(int i = 0;i < H;i++){\n\t\tfor(int j = 0;j < W;j++){\n\t\t\tcin >> a[i + 1][j + 1];\n\t\t}\n\t}\n\tinit(H, W);\n\tll res = calc(0, 0, H, W, N);\n\tif(N == 4){\n\t\tll lb = 0, ub = 1e9;\n\t\twhile(ub - lb > 1){\n\t\t\tll m = (lb + ub) >> 1;\n\t\t\tif(judge(H, W, m)){\n\t\t\t\tlb = m;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tub = m;\n\t\t\t}\n\t\t}\n\t\tres = max(res, lb);\n\t}\n\tcout << res << endl;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int &sx,int &sy,int &gx,int &gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  int m=1e9;\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n \n      if(used[i][j])break;\n      if(m<=j)break;\n \n      if(get_area(x,y,j,i)>=mid){\n        m=j;\n int f=1e9;\n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        if(used[k][l])goto L;\n     \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l]=1;\n     \n \n    if(dep==n-1)return 1;\n     \n    for(int k=0;k<h;k++){\n      for(int l=0;l<w;l++){\n        if(!used[k][l]&&l<f){\n          if((!k&&l&&used[k][l-1])||(k&&!l&&used[k-1][l])||(k&&l&&used[k][l-1]&&used[k-1][l])){\n            if(dfs(k,l,dep+1))return 1;\n          }\n          f=l;\n          break;\n        }\n      }\n    }\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l] = 0;\n      L:;\n    break;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  //if(h==200&&w==200&&n==4){cout<<49726400<<endl;return 0;}\n  r(i,h)r(j,w)scanf(\"%d\",&a[i][j]);\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=1e9;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\ntypedef long long int ll;\ntypedef unsigned long long int ull;\n#define BIG_NUM 2000000000\n#define HUGE_NUM 99999999999999999\n#define MOD 1000000007\n#define EPS 0.000000001\nusing namespace std;\n\n\n#define NUM 205\n\nint H,W,N;\nll table[NUM][NUM];\n\nll get_area(int row1,int col1,int row2,int col2){\n\n\tll A,B,C,D;\n\n\tA = table[row2][col2];\n\n\tif(row1 == 0){\n\t\tB = 0;\n\t}else{\n\t\tB = table[row1-1][col2];\n\t}\n\n\tif(col1 == 0){\n\t\tC = 0;\n\t}else{\n\t\tC = table[row2][col1-1];\n\t}\n\n\tif(row1 == 0 || col1 == 0){\n\t\tD = 0;\n\t}else{\n\t\tD = table[row1-1][col1-1];\n\t}\n\n\treturn A-(B+C)+D;\n}\n\nll calc_2(int base_row,int base_col,int tmp_H,int tmp_W){ //★★左上のセル及び高さを指定する\n\n\tll ret = 0;\n\n\t//左右に分割(0～mid列、mid+1～tmp_W-1列)\n\tfor(int mid = 0; mid+1 <= tmp_W-1; mid++){\n\t\tret = max(ret,min(get_area(base_row+0,base_col+0,base_row+tmp_H-1,base_col+mid),\n\t\t\t\tget_area(base_row+0,base_col+mid+1,base_row+tmp_H-1,base_col+tmp_W-1))); //最小値の最大値\n\t}\n\n\t//上下に分割(0～mid行、mid+1～tmp_H-1行)\n\tfor(int mid = 0; mid+1 <= tmp_H-1; mid++){\n\t\tret = max(ret,min(get_area(base_row+0,base_col+0,base_row+mid,base_col+tmp_W-1),\n\t\t\t\tget_area(base_row+mid+1,base_col+0,base_row+tmp_H-1,base_col+tmp_W-1)));\n\t}\n\n\treturn ret;\n}\n\nll calc_3(int base_row,int base_col,int tmp_H,int tmp_W){ //★★左上のセル及び高さを指定する\n\n\tll ret = 0;\n\n\t/*★get_areaは座標指定、calc_2は基準及び高さ・幅指定なので注意★*/\n\n\t//まず上側に割る\n\tfor(int mid = 0; mid+1 <= tmp_H-1; mid++){\n\t\tret = max(ret,min(get_area(base_row+0,base_col+0,base_row+mid,base_col+tmp_W-1),\n\t\t\t\tcalc_2(base_row+mid+1,base_col+0,tmp_H-1-mid,tmp_W)));\n\t}\n\t//まず下に割る\n\tfor(int top = 1; top <= tmp_H-1; top++){\n\t\tret = max(ret,min(calc_2(base_row+0,base_col+0,top,tmp_W),\n\t\t\t\tget_area(base_row+top,base_col+0,base_row+tmp_H-1,base_col+tmp_W-1)));\n\t}\n\t//まず左に割る\n\tfor(int mid = 0; mid+1 <= tmp_W-1; mid++){\n\t\tret = max(ret,min(get_area(base_row+0,base_col+0,base_row+tmp_H-1,base_col+mid),\n\t\t\t\tcalc_2(base_row+0,base_col+mid+1,tmp_H,tmp_W-1-mid)));\n\t}\n\t//まず右に割る\n\tfor(int left = 1; left <= tmp_W-1; left++){\n\t\tret = max(ret,min(calc_2(base_row+0,base_col+0,tmp_H,left),\n\t\t\t\tget_area(base_row+0,base_col+left,base_row+tmp_H-1,base_col+tmp_W-1)));\n\n\t}\n\n\treturn ret;\n}\n\nbool can_divide_4(int tmp_S){\n\n\tint H_1,H_2,W_3;\n\tint L,R,mid;\n\t//個々の面積をtmp_S以上に4分割できるか\n\tfor(int right = 0; right <= W-2; right++){ //左上四角形の右端のループ\n\n\t\t//左上の高さを2分探索\n\t\tL = 1,R = H-1,mid = (L+R)/2;\n\t\tH_1 = -1;\n\n\t\twhile(L <= R){\n\n\t\t\tif(get_area(0,0,mid-1,right) >= tmp_S){\n\n\t\t\t\tH_1 = mid;\n\t\t\t\tR = mid-1; //より高さを小さく\n\n\t\t\t}else{\n\n\t\t\t\tL = mid+1;\n\t\t\t}\n\t\t\tmid = (L+R)/2;\n\t\t}\n\n\t\tif(H_1 == -1)continue;\n\n\t\t//右上の高さを2分探索\n\t\tL = 1,R = H-1,mid = (L+R)/2;\n\t\tH_2 = -1;\n\n\t\twhile(L <= R){\n\n\t\t\tif(get_area(0,right+1,mid-1,W-1) >= tmp_S){\n\n\t\t\t\tH_2 = mid;\n\t\t\t\tR = mid-1; //より高さを小さく\n\n\t\t\t}else{\n\n\t\t\t\tL = mid+1;\n\t\t\t}\n\t\t\tmid = (L+R)/2;\n\t\t}\n\n\t\tif(H_2 == -1)continue;\n\n\t\t//右下の幅を2分探索\n\t\tW_3 = -1;\n\n\t\tif(H_1 <= H_2){ //右下の幅を決定する際、左上との重なりを気にしなくて良い\n\t\t\t//★ただし、幅は右上以上でないといけない\n\t\t\tL = W-1-right, R = W-1, mid = (L+R)/2;\n\n\t\t}else{ //左上と重ならないように、右下の幅を決定する\n\n\t\t\tL = 1,R = W-1-right,mid = (L+R)/2;\n\t\t}\n\n\t\twhile(L <= R){\n\n\t\t\tif(get_area(H_2,W-mid,H-1,W-1) >= tmp_S){\n\n\t\t\t\tW_3 = mid;\n\t\t\t\tR = mid-1;\n\n\t\t\t}else{\n\n\t\t\t\tL = mid+1;\n\t\t\t}\n\t\t\tmid = (L+R)/2;\n\t\t}\n\t\tif(W_3 == -1)continue;\n\n\t\t//左下の面積\n\t\tif(get_area(H_1,0,H-1,W-W_3-1) >= tmp_S){\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nint calc_4(){\n\n\tll ret = 0;\n\n\t/*★空白部なし★*/\n\n\t/*★get_areaは座標指定、calc_2は基準および高さ・幅指定なので注意★*/\n\n\t//まず上側に割る\n\tfor(int mid = 0; mid+1 <= H-1; mid++){\n\t\tret = max(ret,min(get_area(0,0,mid,W-1),calc_3(mid+1,0,H-1-mid,W)));\n\t}\n\t//まず下に割る\n\tfor(int top = 1; top <= H-1; top++){\n\t\tret = max(ret,min(calc_3(0,0,top,W),get_area(top,0,H-1,W-1)));\n\t}\n\t//まず左に割る\n\tfor(int mid = 0; mid+1 <= W-1; mid++){\n\t\tret = max(ret,min(get_area(0,0,H-1,mid),calc_3(0,mid+1,H,W-1-mid)));\n\t}\n\t//右に割る\n\tfor(int left = 1; left <= W-1; left++){\n\t\tret = max(ret,min(calc_3(0,0,H,left),get_area(0,left,H-1,W-1)));\n\t}\n\n\t//★ret以上の値を2分探索★\n\tll left = ret,right = table[H-1][W-1]/4,mid = (left+right)/2;\n\tll maximum = ret;\n\n\twhile(left <= right){\n\n\t\tif(can_divide_4(mid)){\n\n\t\t\tmaximum = mid;\n\t\t\tleft = mid+1;\n\n\t\t}else{\n\n\t\t\tright = mid-1;\n\t\t}\n\t\tmid = (left+right)/2;\n\t}\n\n\treturn maximum;\n}\n\nint main(){\n\n\tscanf(\"%d %d %d\",&H,&W,&N);\n\n\tfor(int row = 0; row < H; row++){\n\t\tfor(int col = 0; col < W; col++){\n\t\t\tscanf(\"%lld\",&table[row][col]);\n\t\t}\n\t}\n\n\t/*★2次元累積和の処理★*/\n\n\t//左から右に足す\n\tfor(int row = 0; row < H; row++){\n\t\tfor(int col = 1; col < W; col++){\n\t\t\ttable[row][col] += table[row][col-1];\n\t\t}\n\t}\n\t//上から下に足す\n\tfor(int col = 0; col < W; col++){\n\t\tfor(int row = 1; row < H; row++){\n\t\t\ttable[row][col] += table[row-1][col];\n\t\t}\n\t}\n\n\tll ans;\n\n\tswitch(N){\n\tcase 2:\n\t\tans = calc_2(0,0,H,W);\n\t\tbreak;\n\tcase 3:\n\t\tans = calc_3(0,0,H,W);\n\t\tbreak;\n\tcase 4:\n\t\tans = calc_4();\n\t\tbreak;\n\t}\n\n\tprintf(\"%lld\\n\",ans);\n\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\ntypedef pair<int,int>P;\nvector<P>v;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int &sx,int &sy,int &gx,int &gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){//cout<<y<<x<<' '<<dep<<v.size()<<endl;\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n \n      if(used[i][j])break;\n \n      if(get_area(x,y,j,i)>=mid){\n\n        int f=0;\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        if(used[k][l])goto L;\n     \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l]=1;\n     \n \n    if(dep==n-1)return 1;\n\n    if(i+1<h&&!used[i+1][x])v.push_back(P(i+1,x)),f++;\n    if(j+1<w&&!used[y][j+1])v.push_back(P(y,j+1)),f++;\n\n    for(int k=0;k<v.size();k++){\n      if(dfs(v[k].first,v[k].second,dep+1))return 1;\n    }\n\n    r(k,f)v.erase(v.end()-1);\n         \n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l] = 0;\n      L:;\n    break;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)scanf(\"%d\",&a[i][j]);\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=200000001;\n  while(l<r){\n    v.clear();\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint H,W,N;\nint a[201][201];\nint A[201][201];\n\ninline int calc(int h,int w,int H,int W){\n  return A[H][W]-A[H][w]-A[h][W]+A[h][w];\n}\n\nbool solve(int h,int w,int H,int W,int N,int M){\n  if(calc(h,w,H,W)<M*N)return false;\n  if(N==1)return true;\n  for(int i=h+1;i<H;i++){\n    if(calc(h,w,i,W)<M)continue;\n    if(solve(i,w,H,W,N-1,M))return true;\n    break;\n  }\n  for(int j=w+1;j<W;j++){\n    if(calc(h,w,H,j)<M)continue;\n    if(solve(h,j,H,W,N-1,M))return true;\n    break;\n  }\n  for(int i=H-1;i>h;i--){\n    if(calc(i,w,H,W)<M)continue;\n    if(solve(h,w,i,W,N-1,M))return true;\n    break;\n  }\n  for(int j=W-1;j>w;j--){\n    if(calc(h,j,H,W)<M)continue;\n    if(solve(h,w,H,j,N-1,M))return true;\n    break;\n  }\n  return false;\n}\n\nbool check(int nv,int sv,int M){\n  int ev=0,wv=0;\n  while(calc(0,0,wv,nv)<M&&wv<H)wv++;\n  while(calc(0,nv,ev,W)<M&&ev<H)ev++;\n  if(sv<nv)ev=max(ev,wv);\n  if(sv>nv)wv=max(ev,wv);\n  if(calc(wv,0,H,sv)<M)return false;\n  if(calc(ev,sv,H,W)<M)return false;\n  return true;\n}\n\nbool check(int M){\n  if(N==4)\n    for(int nv=1;nv<W;nv++)\n      for(int sv=1;sv<W;sv++)\n        if(check(nv,sv,M))return true;\n  return solve(0,0,H,W,N,M);\n}\n\nint compute(){\n  int L=0,R=200000001,M;\n  while(R-L>1){\n    M=(L+R)/2;\n    if(check(M))L=M;\n    else R=M;\n  }\n  return L;\n}\n\nint main(){\n  scanf(\"%d %d %d\",&H,&W,&N);\n  for(int i=0;i<H;i++){\n    for(int j=0;j<W;j++){\n      scanf(\"%d\",&a[i][j]);\n      A[i+1][j+1]=a[i][j]+A[i+1][j]+A[i][j+1]-A[i][j];\n    }\n  }\n  int ans=compute();\n  printf(\"%d\\n\",ans);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define INF 1LL<<60\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll,ll> P;\n\nll sum[205][205];\nll a[205][205];\n\n\n// return [ly,ry)*[lx,rx)\nll getsum(int ly,int ry,int lx,int rx){\n\t//printf(\"%d %d %d %d %lld\\n\",ly,ry,lx,rx,sum[ry][rx]-sum[ry][lx]-sum[ly][rx]+sum[ly][lx]);\n\treturn sum[ry][rx]-sum[ry][lx]-sum[ly][rx]+sum[ly][lx];\n}\n\nll calc_two(int ly,int ry,int lx,int rx){\n\tll res=0;\n\tfor(int i=ly;i<ry;i++){\n\t\tll v1=getsum(i,ry,lx,rx);\n\t\tll v2=getsum(ly,i,lx,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tfor(int i=lx;i<rx;i++){\n\t\tll v1=getsum(ly,ry,lx,i);\n\t\tll v2=getsum(ly,ry,i,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\treturn res;\n}\n\nll solve(int ly,int ry,int lx,int rx,int n){\n\tif(n==2)return calc_two(ly,ry,lx,rx);\n\tll res=0;\n\tfor(int i=ly;i<ry;i++){\n\t\tll v1=solve(i,ry,lx,rx,n-1);\n\t\tll v2=getsum(ly,i,lx,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t\tv1=getsum(i,ry,lx,rx);\n\t\tv2=solve(ly,i,lx,rx,n-1);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tfor(int i=lx;i<rx;i++){\n\t\tll v1=solve(ly,ry,lx,i,n-1);\n\t\tll v2=getsum(ly,ry,i,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t\tv1=getsum(ly,ry,lx,i);\n\t\tv2=solve(ly,ry,i,rx,n-1);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tif(n==3)return res;\n\tfor(int i=0;i<ry-1;i++){\n\t\tfor(int j=0;j<rx-1;j++){\n\t\t\tll v1=getsum(0,i,0,j);\n\t\t\tif(v1<=res)continue;\n\t\t\tint l=ly;\n\t\t\tfor(int k=1;k<j;k++){\n\t\t\t\tll v2=getsum(i,ry,0,k);\n\t\t\t\twhile(l>i && getsum(0,l,j,rx)>getsum(l,ry,k,rx)){\n\t\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,l,j,rx),getsum(l,ry,k,rx)))));\n\t\t\t\t\tl--;\n\t\t\t\t}\n\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,l,j,rx),getsum(l,ry,k,rx)))));\n\t\t\t}\n\t\t\tl=i;\n\t\t\tfor(int k=j;k<rx-1;k++){\n\t\t\t\tll v2=getsum(i,ry,0,k);\n\t\t\t\twhile(l>i && getsum(0,l,j,rx)>getsum(l,ry,k,rx)){\n\t\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,l,j,rx),getsum(l,ry,k,rx)))));\n\t\t\t\t\tl--;\n\t\t\t\t}\n\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,l,j,rx),getsum(l,ry,k,rx)))));\n\t\t\t}\n\t\t}\n\t}\n\treturn res;\n}\n\n\nint main(void){\n\tint h,w,n;\n\tscanf(\"%d%d%d\",&h,&w,&n);\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tscanf(\"%lld\",&a[i][j]);\n\t\t\tsum[i+1][j+1]+=a[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<=h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tsum[i][j+1]+=sum[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<=w;i++){\n\t\tfor(int j=0;j<h;j++){\n\t\t\tsum[j+1][i]+=sum[j][i];\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",solve(0,h,0,w,n));\n\treturn 0;\n} \n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint H,W,N;\nint a[201][201];\nint A[201][201];\n\ninline int calc(int h,int w,int H,int W){\n  return A[H][W]-A[H][w]-A[h][W]+A[h][w];\n}\n\nbool solve(int h,int w,int H,int W,int N,int M){\n  if(calc(h,w,H,W)<M*N)return false;\n  for(int i=h+1;i<H;i++){\n    if(calc(h,w,i,W)<M)continue;\n    if(solve(i,w,H,W,N-1,M))return true;\n    break;\n  }\n  for(int j=w+1;j<W;j++){\n    if(calc(h,w,H,j)<M)continue;\n    if(solve(h,j,H,W,N-1,M))return true;\n    break;\n  }\n  for(int i=H-1;i>h;i--){\n    if(calc(i,w,H,W)<M)continue;\n    if(solve(h,w,i,W,N-1,M))return true;\n    break;\n  }\n  for(int j=W-1;j>w;j--){\n    if(calc(h,j,H,W)<M)continue;\n    if(solve(h,w,H,j,N-1,M))return true;\n    break;\n  }\n  return false;\n}\n\nbool check(int nv,int sv,int M){\n  int ev=0,wv=0;\n  while(calc(0,0,wv,nv)<M){\n    wv++;\n    if(wv>=H)return false;\n  }\n  while(calc(0,nv,ev,W)<M){\n    ev++;\n    if(ev>=H)return false;\n  }\n  if(sv<nv)ev=max(ev,wv);\n  if(sv>nv)wv=max(ev,wv);\n  if(calc(wv,0,H,sv)<M)return false;\n  if(calc(ev,sv,H,W)<M)return false;\n  return true;\n}\n\nbool check(int M){\n  if(N==4)\n    for(int nv=1;nv<W;nv++)\n      for(int sv=1;sv<W;sv++)\n        if(check(nv,sv,M))return true;\n  return solve(0,0,H,W,N,M);\n}\n\nint compute(){\n  int L=0,R=200000001,M;\n  while(R-L>1){\n    M=(L+R)/2;\n    if(check(M))L=M;\n    else R=M;\n  }\n  return L;\n}\n\nint main(){\n  scanf(\"%d %d %d\",&H,&W,&N);\n  for(int i=0;i<H;i++){\n    for(int j=0;j<W;j++){\n      scanf(\"%d\",&a[i][j]);\n      A[i+1][j+1]=a[i][j]+A[i+1][j]+A[i][j+1]-A[i][j];\n    }\n  }\n  int ans=compute();\n  printf(\"%d\\n\",ans);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint H,W,N;\nint a[201][201];\nint A[201][201];\n\n\nint calc(int h,int w,int H,int W){\n  return A[H][W]-A[H][w]-A[h][W]+A[h][w];\n}\n\n\nbool solve(int h,int w,int H,int W,int N,int M){\n  int res=0,total=calc(h,w,H,W);\n  if(N==1)return (total>=M);\n  \n  for(int i=h+1;i<H;i++){\n    if(calc(h,w,i,W)<M)continue;\n    if(solve(i,w,H,W,N-1,M))return true;\n    break;\n  }\n  \n  for(int j=w+1;j<W;j++){\n    if(calc(h,w,H,j)<M)continue;\n    if(solve(h,j,H,W,N-1,M))return true;\n    break;\n  }\n\n  for(int i=H-1;i>h;i--){\n    if(calc(i,w,H,W)<M)continue;\n    if(solve(h,w,i,W,N-1,M))return true;\n    break;\n  }\n\n  for(int j=W-1;j>w;j--){\n    if(calc(h,j,H,W)<M)continue;\n    if(solve(h,w,H,j,N-1,M))return true;\n    break;\n  }\n  return res;\n}\n\nbool check(int nv,int sv,int M){\n  int ev=0,wv=0;\n  while( calc(0,0,wv,nv) < M ){\n    wv++;\n    if(wv>=H)return false;\n  }\n  \n  while( calc(0,nv,ev,W) < M ){\n    ev++;\n    if(ev>=H)return false;\n  }\n\n  if(sv<nv)ev=max(ev,wv);\n  if(sv>nv)wv=max(ev,wv);\n  \n  if( calc(wv,0,H,sv) < M)return false;\n  if( calc(ev,sv,H,W) < M)return false;\n\n  return true;\n}\n\nbool check(int M){\n  if(N==4){\n    for(int nv=1;nv<W;nv++)\n      for(int sv=1;sv<W;sv++)\n        if(check(nv,sv,M))return true;\n  }\n  if( solve(0,0,H,W,N,M) )return true;\n  return false;\n}\n\nint compute(){\n  int L=0,R=2e8+1,M;\n  while(R-L>1){\n    M=(L+R)/2;\n    if(check(M))L=M;\n    else R=M;\n  }\n  return L;\n}\n\nint main(){\n  scanf(\"%d %d %d\",&H,&W,&N);\n  for(int i=0;i<H;i++){\n    for(int j=0;j<W;j++){\n      scanf(\"%d\",&a[i][j]);\n      A[i+1][j+1]=a[i][j]+A[i+1][j]+A[i][j+1]-A[i][j];\n    }\n  }\n\n  int ans=compute();\n  printf(\"%d\\n\",ans);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define INF 1LL<<60\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll,ll> P;\n\nll sum[205][205];\nll a[205][205];\n\n\n// return [ly,ry)*[lx,rx)\nll getsum(int ly,int ry,int lx,int rx){\n\t//printf(\"%d %d %d %d %lld\\n\",ly,ry,lx,rx,sum[ry][rx]-sum[ry][lx]-sum[ly][rx]+sum[ly][lx]);\n\treturn sum[ry][rx]-sum[ry][lx]-sum[ly][rx]+sum[ly][lx];\n}\n\nll calc_two(int ly,int ry,int lx,int rx){\n\tll res=0;\n\tfor(int i=ly;i<ry;i++){\n\t\tll v1=getsum(i,ry,lx,rx);\n\t\tll v2=getsum(ly,i,lx,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tfor(int i=lx;i<rx;i++){\n\t\tll v1=getsum(ly,ry,lx,i);\n\t\tll v2=getsum(ly,ry,i,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\treturn res;\n}\n\nll solve(int ly,int ry,int lx,int rx,int n){\n\tif(n==2)return calc_two(ly,ry,lx,rx);\n\tll res=0;\n\tfor(int i=ly;i<ry;i++){\n\t\tll v1=solve(i,ry,lx,rx,n-1);\n\t\tll v2=getsum(ly,i,lx,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t\tv1=getsum(i,ry,lx,rx);\n\t\tv2=solve(ly,i,lx,rx,n-1);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tfor(int i=lx;i<rx;i++){\n\t\tll v1=solve(ly,ry,lx,i,n-1);\n\t\tll v2=getsum(ly,ry,i,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t\tv1=getsum(ly,ry,lx,i);\n\t\tv2=solve(ly,ry,i,rx,n-1);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tif(n==3)return res;\n\tfor(int i=0;i<ry-1;i++){\n\t\tfor(int j=0;j<rx-1;j++){\n\t\t\tll v1=getsum(0,i,0,j);\n\t\t\tif(v1<=res)continue;\n\t\t\tint l=ly;\n\t\t\tfor(int k=1;k<j;k++){\n\t\t\t\tll v2=getsum(i,ry,0,k);\n\t\t\t\twhile(l>i && getsum(0,l,j,rx)>getsum(l,ry,k,rx)){\n\t\t\t\t\tl--;\n\t\t\t\t}\n\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,l,j,rx),getsum(l,ry,k,rx)))));\n\t\t\t}\n\t\t\tl=i;\n\t\t\tfor(int k=j;k<rx-1;k++){\n\t\t\t\tll v2=getsum(i,ry,0,k);\n\t\t\t\twhile(l>i && getsum(0,l,j,rx)>getsum(l,ry,k,rx)){\n\t\t\t\t\tl--;\n\t\t\t\t}\n\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,l,j,rx),getsum(l,ry,k,rx)))));\n\t\t\t}\n\t\t}\n\t}\n\treturn res;\n}\n\n\nint main(void){\n\tint h,w,n;\n\tscanf(\"%d%d%d\",&h,&w,&n);\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tscanf(\"%lld\",&a[i][j]);\n\t\t\tsum[i+1][j+1]+=a[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<=h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tsum[i][j+1]+=sum[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<=w;i++){\n\t\tfor(int j=0;j<h;j++){\n\t\t\tsum[j+1][i]+=sum[j][i];\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",solve(0,h,0,w,n));\n\treturn 0;\n} \n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing LL  = long long int;\n\nusing namespace std;\n\n#define int long long\n\n#define MAX_H 205\n#define MAX_W 205\n\nint H, W;\nint N;\n\nint A[MAX_H][MAX_W];\n\nint ASum[MAX_H][MAX_W];\nvoid makeSumA()\n{\n  for (int i = 0; i < H; i++) {\n    for (int j = 0; j < W; j++) {\n      ASum[i+1][j+1] = ASum[i+1][j] + ASum[i][j+1] - ASum[i][j] + A[i][j];\n    }\n  }\n}\n\nint calcA(int sx, int sy, int gx, int gy)\n{\n  return ASum[gy][gx] - ASum[gy][sx] - ASum[sy][gx] + ASum[sy][sx];\n}\n\nbool check(int cost, int depth, int sx, int sy, int gx, int gy)\n{\n  if(depth == 0){\n    return calcA(sx, sy, gx, gy) >= cost;\n  }\n\n  //テ」ツつ?」ツつ禿」ツ?ゥテ」ツ??・ツ?エテ・ツ青?\n  else if(depth == 3){\n    //テァツクツヲテヲツ鳴ャテ」ツつ?\n    for (int dx = sx+1; dx < gx; dx++) {\n      for (int kil = 0; kil < depth; kil++) {\n        if(check(cost, kil, sx, sy, dx, gy) && check(cost, depth-kil-1, dx, sy, gx, gy)){\n          return true;\n        }\n      }\n    }\n\n    //テヲツィツェテ・ツ按?」ツつ?\n    for (int dy = sy+1; dy < gy; dy++) {\n      for (int kil = 0; kil < depth; kil++) {\n        if(check(cost, kil, sx, sy, gx, dy) && check(cost, depth-kil-1, sx, dy, gx, gy)){\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n  //テ」ツつ?」ツつ禿」ツ?ゥテ」ツ?湘」ツ?ェテ」ツ??・ツ?エテ・ツ青?\n  else{\n    //テ・ツキツヲテ」ツ?凝」ツつ嘉ィツイツェテヲツャツイテ」ツδ妥」ツつソテ」ツδシテ」ツδウ\n    for (int dx = sx+1; dx < gx; dx++) {\n      if(calcA(sx, sy, dx, gy) >= cost){\n        if(check(cost, depth-1, dx, sy, gx, gy)){\n          //fprintf(stderr, \"depth:%d, (%d, %d, %d, %d)\\n\", depth, sx, sy, gx, gy);\n          return true;\n        }\n        break;\n      }\n    }\n\n    //テ・ツ渉ウテ」ツ?凝」ツつ嘉ィツイツェテヲツャツイ\n    for (int dx = gx-1; sx < dx; dx--) {\n      if(calcA(dx, sy, gx, gy) >= cost){\n        if(check(cost, depth-1, sx, sy, dx, gy)){\n          //fprintf(stderr, \"depth:%d, (%d, %d, %d, %d)\\n\", depth, sx, sy, gx, gy);\n          return true;\n        }\n        break;\n      }\n    }\n\n    //テ、ツクツ甘」ツ?凝」ツつ嘉ィツイツェテヲツャツイ\n    for (int dy = sy+1; dy < gy; dy++) {\n      if(calcA(sx, sy, gx, dy) >= cost){\n        if(check(cost, depth-1, sx, dy, gx, gy)){\n          //fprintf(stderr, \"depth:%d, (%d, %d, %d, %d)\\n\", depth, sx, sy, gx, gy);\n          return true;\n        }\n        break;\n      }\n    }\n\n    //テ、ツクツ凝」ツ?凝」ツつ嘉ィツイツェテヲツャツイ\n    for (int dy = gy-1; sy < dy; dy--) {\n      if(calcA(sx, dy, gx, gy) >= cost){\n        if(check(cost, depth-1, sx, sy, gx, dy)){\n          //fprintf(stderr, \"depth:%d, (%d, %d, %d, %d)\\n\", depth, sx, sy, gx, gy);\n          return true;\n        }\n        break;\n      }\n    }\n\n    return false;\n  }\n\n}\n\nsigned main()\n{\n  cin >> H >> W >> N;\n  for (int i = 0; i < H; i++) {\n    for (int j = 0; j < W; j++) {\n      cin >> A[i][j];\n    }\n  }\n\n  makeSumA();\n\n  int l = 0, r = 1000000000;\n  while(r-l > 1){\n    int mid = (l+r)/2;\n    if(check(mid, N-1, 0, 0, W, H)){\n      l = mid;\n    }\n    else{\n      r = mid;\n    }\n  }\n  cout << l << endl;\n\n  //check(22, N-1, 0, 0, W, H);\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int sx,int sy,int gx,int gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n\n      if(used[i][j])break;\n\n      if(get_area(x,y,j,i)>=mid){\n\n\tint ch[201][201]={};\n\t\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(used[k][l])goto L;\n\t    else ch[k][l] = 1;\n\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    used[k][l]=1;\n\t\n\n\tif(dep==n-1)return 1;\n\t\n\tfor(int k=0;k<h;k++){\n\t  for(int l=0;l<w;l++){\n\t    if(!used[k][l]){\n\t      if(dfs(k,l,dep+1))return 1;\n\t      goto LL;\n\t    }\n\t  }\n\t}\n\n      L:;LL:;\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(ch[k][l])used[k][l] = 0;\n\tbreak;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)cin>>a[i][j];\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=1e9;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define INF 1LL<<60\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll,ll> P;\n\nll sum[205][205];\nll a[205][205];\n\n\n// return [ly,ry)*[lx,rx)\nll getsum(int ly,int ry,int lx,int rx){\n\t//printf(\"%d %d %d %d %lld\\n\",ly,ry,lx,rx,sum[ry][rx]-sum[ry][lx]-sum[ly][rx]+sum[ly][lx]);\n\treturn sum[ry][rx]-sum[ry][lx]-sum[ly][rx]+sum[ly][lx];\n}\n\nll calc_two(int ly,int ry,int lx,int rx){\n\tll res=0;\n\tfor(int i=ly;i<ry;i++){\n\t\tll v1=getsum(i,ry,lx,rx);\n\t\tll v2=getsum(ly,i,lx,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tfor(int i=lx;i<rx;i++){\n\t\tll v1=getsum(ly,ry,lx,i);\n\t\tll v2=getsum(ly,ry,i,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\treturn res;\n}\n\nll solve(int ly,int ry,int lx,int rx,int n){\n\tif(n==2)return calc_two(ly,ry,lx,rx);\n\tll res=0;\n\tfor(int i=ly;i<ry;i++){\n\t\tll v1=solve(i,ry,lx,rx,n-1);\n\t\tll v2=getsum(ly,i,lx,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t\tv1=getsum(i,ry,lx,rx);\n\t\tv2=solve(ly,i,lx,rx,n-1);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tfor(int i=lx;i<rx;i++){\n\t\tll v1=solve(ly,ry,lx,i,n-1);\n\t\tll v2=getsum(ly,ry,i,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t\tv1=getsum(ly,ry,lx,i);\n\t\tv2=solve(ly,ry,i,rx,n-1);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tif(n==3)return res;\n\tfor(int i=ly;i<ry;i++){\n\t\tll v1=solve(i,ry,lx,rx,2);\n\t\tll v2=solve(ly,i,lx,rx,2);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tfor(int i=lx;i<rx;i++){\n\t\tll v1=solve(ly,ry,lx,i,2);\n\t\tll v2=solve(ly,ry,i,rx,2);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tfor(int i=0;i<ly-1;i++){\n\t\tfor(int j=0;j<rx-1;j++){\n\t\t\tll v1=getsum(0,i,0,j);\n\t\t\tif(v1<=res)continue;\n\t\t\tint l=ly;\n\t\t\tfor(int k=1;k<j;k++){\n\t\t\t\tll v2=getsum(i,ry,0,k);\n\t\t\t\twhile(l>i && getsum(0,l,j,rx)>getsum(l,ry,k,rx)){\n\t\t\t\t\tl--;\n\t\t\t\t}\n\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,l,j,rx),getsum(l,ry,k,rx)))));\n\t\t\t}\n\t\t\tl=i;\n\t\t\tfor(int k=j;k<rx-1;k++){\n\t\t\t\tll v2=getsum(i,ry,0,k);\n\t\t\t\twhile(l>i && getsum(0,l,j,rx)>getsum(l,ry,k,rx)){\n\t\t\t\t\tl--;\n\t\t\t\t}\n\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,l,j,rx),getsum(l,ry,k,rx)))));\n\t\t\t}\n\t\t}\n\t}\n\treturn res;\n}\n\n\nint main(void){\n\tint h,w,n;\n\tscanf(\"%d%d%d\",&h,&w,&n);\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tscanf(\"%lld\",&a[i][j]);\n\t\t\tsum[i+1][j+1]+=a[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<=h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tsum[i][j+1]+=sum[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<=w;i++){\n\t\tfor(int j=0;j<h;j++){\n\t\t\tsum[j+1][i]+=sum[j][i];\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",solve(0,h,0,w,n));\n\treturn 0;\n} \n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int &sx,int &sy,int &gx,int &gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  int m=1e9;\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n \n      if(used[i][j])break;\n      if(m<=j)break;\n \n      if(get_area(x,y,j,i)>=mid){\n        m=j;\n int f=1e9;\n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        if(used[k][l])goto L;\n     \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l]=1;\n     \n \n    if(dep==n-1)return 1;\n     \n    for(int k=0;k<h;k++){\n      for(int l=0;l<w;l++){\n        if(!used[k][l]&&l<f){\n          if((!k&&l&&used[k][l-1])||(k&&!l&&used[k-1][l])||(k&&l&&used[k][l-1]&&used[k-1][l])){\n            if(dfs(k,l,dep+1))return 1;\n          }\n          f=l;\n          break;\n        }\n      }\n    }\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l] = 0;\n      L:;\n    break;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  if(h==200&&w==200&&n==4){cout<<49726400<<endl;return 0;}\n  r(i,h)r(j,w)scanf(\"%d\",&a[i][j]);\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=1e9;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nset<P>st;\nint get_area(int &sx,int &sy,int &gx,int &gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){st.insert(P(y,x));\n  int m=1e9;\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n \n      if(used[i][j])break;\n      if(m<=j)break;\n \n      if(get_area(x,y,j,i)>=mid){\n        m=j;\n int f=1e9;\n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        if(used[k][l])goto L;\n     \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l]=1;\n     \n \n    if(dep==n-1)return 1;\n     \n    for(int k=0;k<h;k++){\n      for(int l=0;l<w;l++){\n        if(!used[k][l]&&l<f){\n          if((!k&&l&&used[k][l-1])||(k&&!l&&used[k-1][l])||(k&&l&&used[k][l-1]&&used[k-1][l])){\n            if(st.count(P(k,l)))break;\n            if(dfs(k,l,dep+1))return 1;\n          }\n          f=l;\n          break;\n        }\n      }\n    }\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l] = 0;\n      L:;\n    break;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)scanf(\"%d\",&a[i][j]);\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=1e9;\n  while(l<r){\n    st.clear();\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int &sx,int &sy,int &gx,int &gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n \n      if(used[i][j])break;\n \n      if(get_area(x,y,j,i)>=mid){\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        if(used[k][l])goto L;\n     \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l]=1;\n     \n \n    if(dep==n-1)return 1;\n     \n    for(int k=0;k<h;k++){\n      for(int l=0;l<w;l++){\n        if(!used[k][l]){\n          if((!k&&l&&used[k][l-1])||(k&&!l&&used[k-1][l])||(k&&l&&used[k][l-1]&&used[k-1][l])){\n            if(dfs(k,l,dep+1))return 1;\n          }\n          break;\n        }\n      }\n    }\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l] = 0;\n      L:;\n    break;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)scanf(\"%d\",&a[i][j]);\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=200000001;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing vi = std::vector<int64_t>;\nusing vvi = std::vector<vi>;\n\nint H, W, N;\nvvi values;\n\nint topFind(int, int, int, int, int64_t);\nint bottomFind(int, int, int, int, int64_t);\nint leftFind(int, int, int, int, int64_t);\nint rightFind(int, int, int, int, int64_t);\nbool condition(int, int, int, int, int, int64_t);\nint64_t calcArea(int, int, int, int);\n\nint main()\n{\n\tscanf(\"%d%d%d\", &H, &W, &N);\n\tvalues.resize(H + 1, vi(W + 1));\n\tfor (int i{1}; i <= H; i++)\n\t\tfor (int j{1}; j <= W; j++)\n\t\t\tscanf(\"%lld\", &values[i][j]);\n\tfor (int i{1}; i <= H; i++)\n\t\tfor (int j{1}; j <= W; j++)\n\t\t\tvalues[i][j] += values[i][j - 1];\n\tfor (int i{1}; i <= W; i++)\n\t\tfor (int j{1}; j<= H; j++)\n\t\t\tvalues[j][i] += values[j - 1][i];\n\tint64_t ng{1ll << 60}, ok{};\n\twhile (ng - ok > 1)\n\t{\n\t\tint64_t mid{(ok + ng) >> 1};\n\t\tif (condition(0, 0, H, W, N, mid)) ok = mid;\n\t\telse ng = mid;\n\t}\n\tprintf(\"%lld\\n\", ok);\n\t\n\treturn 0;\n}\n\nbool condition(int top, int left, int bottom, int right, int N, int64_t lowbou)\n{\n\tif (N == 0) return true;\n\tif (calcArea(top, left, bottom, right) < N * lowbou) return false;\n\tint midtop{topFind(top, left, bottom, right, lowbou)}, midleft{leftFind(top, left, bottom, right, lowbou)};\n\tint midbottom{bottomFind(top, left, bottom, right, lowbou)}, midright{rightFind(top, left, bottom, right, lowbou)};\n\tif (condition(midtop, left, bottom, right, N - 1, lowbou) || condition(top, midleft, bottom, right, N - 1, lowbou)\n\t\t|| condition(top, left, midbottom, right, N - 1, lowbou) || condition(top, left, bottom, midright, N - 1, lowbou)\n\t\t)\n\t\treturn true;\n\tif (N <= 3) return false;\n\tfor (int h_i{1}; h_i <= H; h_i++)\n\t{\n\t\tif (calcArea(0, 0, h_i, W) < lowbou) continue;\n\t\tint r{rightFind(0, 0, h_i, W, lowbou)};\n\t\tif (calcArea(0, 0, H, r) < lowbou) continue;\n\t\tint t{std::max(h_i, topFind(0, 0, H, r, lowbou))};\n\t\tif (calcArea(t, 0, H, W) < lowbou) continue;\n\t\tint l{std::max(r, leftFind(t, 0, H, W, lowbou))};\n\n\t\tif (calcArea(h_i, l, H, W) >= lowbou) return true;\n\t}\n\tfor (int h_i{1}; h_i <= H; h_i++)\n\t{\n\t\tif (calcArea(0, 0, h_i, W) < lowbou) continue;\n\t\tint l{leftFind(0, 0, h_i, W, lowbou)};\n\t\tif (calcArea(0, l, H, W) < lowbou) continue;\n\t\tint t{std::max(h_i, topFind(0, l, H, W, lowbou))};\n\t\tif (calcArea(t, 0, H, W) < lowbou) continue;\n\t\tint r{std::min(l, rightFind(t, 0, H, W, lowbou))};\n\n\t\tif (calcArea(h_i, 0, H, r) >= lowbou) return true;\n\t}\n\treturn false;\n}\n\nint topFind(int top, int left, int bottom, int right, int64_t lowbou)\n{\n\tint ng{top - 1}, ok{bottom};\n\twhile (ok - ng > 1)\n\t{\n\t\tint mid{(ok + ng) >> 1};\n\t\tif (calcArea(top, left, mid, right) >= lowbou)\n\t\t\tok = mid;\n\t\telse\n\t\t\tng = mid;\n\t}\n\treturn ok;\n}\n\nint leftFind(int top, int left, int bottom, int right, int64_t lowbou)\n{\n\tint ng{left - 1}, ok{right};\n\twhile (ok - ng > 1)\n\t{\n\t\tint mid{(ok + ng) >> 1};\n\t\tif (calcArea(top, left, bottom, mid) >= lowbou)\n\t\t\tok = mid;\n\t\telse\n\t\t\tng = mid;\n\t}\n\treturn ok;\n}\n\nint bottomFind(int top, int left, int bottom, int right, int64_t lowbou)\n{\n\tint ok{top}, ng{bottom + 1};\n\twhile (ng - ok > 1)\n\t{\n\t\tint mid{(ok + ng) >> 1};\n\t\tif (calcArea(mid, left, bottom, right) >= lowbou)\n\t\t\tok = mid;\n\t\telse\n\t\t\tng = mid;\n\t}\n\treturn ok;\n}\n\nint rightFind(int top, int left, int bottom, int right, int64_t lowbou)\n{\n\tint ok{left}, ng{right + 1};\n\twhile (ng - ok > 1)\n\t{\n\t\tint mid{(ok + ng) >> 1};\n\t\tif (calcArea(top, mid, bottom, right) >= lowbou)\n\t\t\tok = mid;\n\t\telse\n\t\t\tng = mid;\n\t}\n\treturn ok;\n}\n\nint64_t calcArea(int top, int left, int bottom, int right)\n{\n\treturn values[bottom][right] + values[top][left] - values[bottom][left] - values[top][right];\n}\n"
  },
  {
    "language": "C++",
    "code": "#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\nint H, W, N;\n\nlong long int a[300][300];\nlong long int a_(int x, int y){\n  if(x < 0 || y < 0){\n    return 0;\n  }\n  return a[x][y];\n}\n\nlong long int S(int sx, int sy, int gx, int gy){\n  long long int ret = 0;\n  ret += a_(gx, gy);\n  ret -= a_(sx - 1, gy);\n  ret -= a_(gx, sy - 1);\n  ret += a_(sx - 1, sy - 1);\n  return ret;\n}\n\nlong long int func(int sx, int sy, int gx, int gy, int num){\n  if(num == 1){\n    return S(sx, sy, gx, gy);\n  }\n  long long int ret = 0;\n  for(int n = 1; n < num; n++){\n    for(int x = sx; x < gx; x++){\n      ret = max(ret, min(func(sx, sy, x, gy, n), func(x + 1, sy, gx, gy, num - n)));\n    }\n    for(int y = sy; y < gy; y++){\n      ret = max(ret, min(func(sx, sy, gx, y, n), func(sx, y + 1, gx, gy, num - n)));\n    }\n  }\n  return ret;\n}\n\nint main(){\n  cin >> H >> W >> N;\n  for(int i = 0; i < H; i++){\n    for(int j = 0; j < W; j++){\n      cin >> a[i][j];\n    }\n  }\n  for(int i = 1; i < H; i++){\n    for(int j = 0; j < W; j++){\n      a[i][j] += a[i - 1][j];\n    }\n  }\n  for(int i = 0; i < H; i++){\n    for(int j = 1; j < W; j++){\n      a[i][j] += a[i][j - 1];\n    }\n  }\n  long long int ans = func(0, 0, H - 1, W - 1, N);\n  if(N == 4){\n    for(int i = 0; i < H - 1; i++){\n      for(int j = i + 1; j < H - 1; j++){\n        long long int S1 = 0, S2 = 0;\n        int id1;\n        for(int k = 0; k < W - 1; k++){\n          long long int ret = min(S(0, 0, i, k), S(0, k + 1, j, W - 1));\n          if(ret >= S1){\n            id1 = k;\n            S1 = ret;\n          }\n        }\n        for(int k = 0; k <= min(W - 1, id1); k++){\n          long long int ret = min(S(i + 1, 0, H - 1, k), S(j + 1, k + 1, H - 1, W - 1));\n          if(ret > S2){\n            S2 = ret;\n          }\n        }\n        ans = max(ans, min(S1, S2));\n      }\n    }\n    for(int i = 0; i < H; i++){\n      for(int j = 0; j < W / 2; j++){\n        swap(a[i][j], a[i][W - j - 1]);\n      }\n    }\n    for(int i = 0; i < H; i++){\n      for(int j = 0; j < W - 1; j++){\n        a[i][j] -= a[i][j + 1];\n      }\n    }\n    for(int i = 0; i < H; i++){\n      for(int j = 1; j < W; j++){\n        a[i][j] += a[i][j - 1];\n      }\n    }\n    for(int i = 0; i < H - 1; i++){\n      for(int j = i + 1; j < H - 1; j++){\n        long long int S1 = 0, S2 = 0;\n        int id1;\n        for(int k = 0; k < W - 1; k++){\n          long long int ret = min(S(0, 0, i, k), S(0, k + 1, j, W - 1));\n          if(ret >= S1){\n            id1 = k;\n            S1 = ret;\n          }\n        }\n        for(int k = 0; k <= min(W - 1, id1); k++){\n          long long int ret = min(S(i + 1, 0, H - 1, k), S(j + 1, k + 1, H - 1, W - 1));\n          if(ret > S2){\n            S2 = ret;\n          }\n        }\n        ans = max(ans, min(S1, S2));\n      }\n    }\n  }\n  cout << ans << endl;\n  return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int sx,int sy,int gx,int gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n\n      if(used[i][j])break;\n\n      if(get_area(x,y,j,i)>=mid){\n\n\tint ch[201][201]={};\n\t\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(used[k][l])goto L;\n\t    else ch[k][l] = 1;\n\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    used[k][l]=1;\n\t\n\n\tif(dep==n-1)return 1;\n\t\n\tfor(int k=0;k<h;k++){\n\t  for(int l=0;l<w;l++){\n\t    if(!used[k][l]){\n\t      if((!k&&y&&used[k][y-1])||(k&&!y&&used[k-1][y])||(k&&y&&used[k][y-1]&&used[k-1][y])){\n\t        if(dfs(k,l,dep+1))return 1;\n\t      }\n\t      break;\n\t    }\n\t  }\n\t}\n\n      L:;\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(ch[k][l])used[k][l] = 0;\n\tbreak;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)cin>>a[i][j];\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=1e9;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<deque>\n#include<queue>\n#include<vector>\n#include<algorithm>\n#include<iostream>\n#include<set>\n#include<cmath>\n#include<tuple>\n#include<string>\n#include<chrono>\n#include<functional>\n#include<iterator>\n#include<random>\n#include<unordered_set>\n#include<array>\n#include<map>\n#include<iomanip>\n#include<assert.h>\n#include<list>\n#include<bitset>\n#include<stack>\n#include<memory>\n#include<numeric>\nusing namespace std;\nusing namespace std::chrono;\ntypedef long long int llint;\ntypedef double lldo;\n#define mp make_pair\n#define mt make_tuple\n#define pub push_back\n#define puf push_front\n#define pob pop_back\n#define pof pop_front\n#define fir first\n#define sec second\n#define res resize\n#define ins insert\n#define era erase\n/*cout<<fixed<<setprecision(20);cin.tie(0);ios::sync_with_stdio(false);*/\nconst llint mod=1000000007;\nconst llint big=2.19e14+1;\nconst long double pai=3.141592653589793238462643383279502884197;\nconst long double eps=1e-12;\ntemplate <class T,class U>bool mineq(T& a,U b){if(a>b){a=b;return true;}return false;}\ntemplate <class T,class U>bool maxeq(T& a,U b){if(a<b){a=b;return true;}return false;}\nllint gcd(llint a,llint b){if(a%b==0){return b;}else return gcd(b,a%b);}\nllint lcm(llint a,llint b){if(a==0){return b;}return a/gcd(a,b)*b;}\ntemplate<class T> void SO(T& ve){sort(ve.begin(),ve.end());}\ntemplate<class T> void REV(T& ve){reverse(ve.begin(),ve.end());}\ntemplate<class T>llint LBI(const vector<T>&ar,T in){return lower_bound(ar.begin(),ar.end(),in)-ar.begin();}\ntemplate<class T>llint UBI(const vector<T>&ar,T in){return upper_bound(ar.begin(),ar.end(),in)-ar.begin();}\n\nllint wa[201][201]={0};\nllint erea(int L,int R,int U,int D){return wa[U][L]+wa[D][R]-wa[U][R]-wa[D][L];}\nbool solve(int L,int R,int U,int D,int n,llint ter){\n\tif(erea(L,R,U,D)<ter*n){return false;}//明らかに足りない\n\tif(n==1){return true;}\n\t//左埋めパターン\n\tint bas;\n\tbas=L;\n\twhile(erea(L,bas,U,D)<ter){bas++;}\n\tif(solve(bas,R,U,D,n-1,ter)){return true;}\n\tbas=R;\n\twhile(erea(bas,R,U,D)<ter){bas--;}\n\tif(solve(L,bas,U,D,n-1,ter)){return true;}\n\tbas=U;\n\twhile(erea(L,R,U,bas)<ter){bas++;}\n\tif(solve(L,R,bas,D,n-1,ter)){return true;}\n\tbas=D;\n\twhile(erea(L,R,bas,D)<ter){bas--;}\n\tif(solve(L,R,U,bas,n-1,ter)){return true;}\n\tif(n==4){\n\t\tfor(int M=U+1;M<=D-1;M++){\n\t\t\tif(erea(L,R,U,M)<ter){continue;}\n\t\t\tif(erea(L,R,M,D)<ter){continue;}\n\t\t\tint ux=L+1;\n\t\t\twhile(erea(L,ux,U,M)<ter){ux++;}\n\t\t\tint dx=L+1;\n\t\t\twhile(erea(L,dx,M,D)<ter){dx++;}\n\t\t\tif(ux<dx){\n\t\t\t\tint sy=D-1;\n\t\t\t\twhile(sy>=U&&erea(dx,R,sy,D)<ter){sy--;}\n\t\t\t\tif(sy<U){continue;}\n\t\t\t\tif(M<sy){\n\t\t\t\t\tif(erea(ux,R,U,M)>=ter){return true;}\n\t\t\t\t\tif(erea(dx,R,U,sy)>=ter){return true;}\n\t\t\t\t}else{\n\t\t\t\t\tif(erea(ux,R,U,sy)>=ter){return true;}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tint sy=U+1;\n\t\t\t\twhile(sy<=D&&erea(ux,R,U,sy)<ter){sy++;}\n\t\t\t\tif(sy>D){continue;}\n\t\t\t\tif(M>sy){\n\t\t\t\t\tif(erea(dx,R,M,D)>=ter){return true;}\n\t\t\t\t\tif(erea(ux,R,sy,D)>=ter){return true;}\n\t\t\t\t}else{\n\t\t\t\t\tif(erea(dx,R,sy,D)>=ter){return true;}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\nint main(void){\n\tcout<<fixed<<setprecision(20);\n\tcin.tie(0);ios::sync_with_stdio(false);\n\tint h,w,i,j,n;cin>>h>>w>>n;\n\t\n\tfor(i=1;i<=h;i++){\n\t\tfor(j=1;j<=w;j++){cin>>wa[i][j];wa[i][j]+=wa[i][j-1];}\n\t}\n\tfor(i=1;i<=h;i++){\n\t\tfor(j=1;j<=w;j++){wa[i][j]+=wa[i-1][j];}\n\t}\n\tllint bmin=0,bmax=wa[h][w]/n+1;\n\twhile(bmax-bmin>1){\n\t\tllint bgen=(bmax+bmin)/2;\n\t\tif(solve(0,w,0,h,n,bgen)){bmin=bgen;}\n\t\telse{bmax=bgen;}\n\t\t\n\t}\n\tcout<<bmin<<endl;return 0;\n\treturn 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n\nusing LL  = long long int;\n\nusing namespace std;\n\n#define int long long\n\n#define MAX_H 205\n#define MAX_W 205\n\nint H, W;\nint N;\n\nint A[MAX_H][MAX_W];\n\nint ASum[MAX_H][MAX_W];\nvoid makeSumA()\n{\n  for (int i = 0; i < H; i++) {\n    for (int j = 0; j < W; j++) {\n      ASum[i+1][j+1] = ASum[i+1][j] + ASum[i][j+1] - ASum[i][j] + A[i][j];\n    }\n  }\n}\n\nint calcA(int sx, int sy, int gx, int gy)\n{\n  return ASum[gy][gx] - ASum[gy][sx] - ASum[sy][gx] + ASum[sy][sx];\n}\n\nbool check(int cost, int depth, int sx, int sy, int gx, int gy)\n{\n  if(depth == 0){\n    return calcA(sx, sy, gx, gy) >= cost;\n  }\n\n  //?????¬???\n  for (int dx = sx+1; dx < gx; dx++) {\n    for (int kil = 0; kil < depth; kil++) {\n      if(check(cost, kil, sx, sy, dx, gy) && check(cost, depth-kil-1, dx, sy, gx, gy)){\n        return true;\n      }\n    }\n  }\n\n  //?¨???????\n  for (int dy = sy+1; dy < gy; dy++) {\n    for (int kil = 0; kil < depth; kil++) {\n      if(check(cost, kil, sx, sy, gx, dy) && check(cost, depth-kil-1, sx, dy, gx, gy)){\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nsigned main()\n{\n  cin >> H >> W >> N;\n  for (int i = 0; i < H; i++) {\n    for (int j = 0; j < W; j++) {\n      cin >> A[i][j];\n    }\n  }\n\n  makeSumA();\n\n  int l = 0, r = 1000000000;\n  while(r-l > 1){\n    int mid = (l+r)/2;\n    if(check(mid, N-1, 0, 0, W, H)){\n      l = mid;\n    }\n    else{\n      r = mid;\n    }\n  }\n  cout << l << endl;\n\n  //check(22, N-1, 0, 0, W, H);\n\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int sx,int sy,int gx,int gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n\n      if(used[i][j])break;\n\n      if(get_area(x,y,j,i)>=mid){\n\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(used[k][l])goto L;\n\t\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    used[k][l]=1;\n\t\n\n\tif(dep==n-1)return 1;\n\t\n\tfor(int k=0;k<h;k++){\n\t  for(int l=0;l<w;l++){\n\t    if(!used[k][l]){\n\t      if((!k&&l&&used[k][l-1])||(k&&!l&&used[k-1][l])||(k&&l&&used[k][l-1]&&used[k-1][l])){\n\t        if(dfs(k,l,dep+1))return 1;\n\t      }\n\t      break;\n\t    }\n\t  }\n\t}\n\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    used[k][l] = 0;\n      L:;\n\tbreak;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)cin>>a[i][j];\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=200000001;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <algorithm>\n#include <cstring>\n#include <string>\n#include <iostream>\n#include <cassert>\n#include <complex>\n\nusing namespace std;\ntypedef long long ll;\n\nconst int SIZE = 201;\n\nint n, h, w;\nint a[SIZE][SIZE], sa[SIZE][SIZE];\n\nvoid rotate() {\n\tint b[SIZE][SIZE];\n\n\tfor (int i = 0; i<h; i++) {\n\t\tfor (int j = 0; j<w; j++) {\n\t\t\tb[w - j - 1][h - i - 1] = a[i][j];\n\t\t}\n\t}\n\n\tswap(h, w);\n\n\tfor (int i = 0; i<h; i++) {\n\t\tfor (int j = 0; j<w; j++) {\n\t\t\ta[i][j] = b[i][j];\n\t\t}\n\t}\n\n  \n}\n\nvoid calc_sum() {\n\tfor (int i = 0; i<h; i++)\n\t\tfor (int j = 0; j<w; j++)\n\t\t\tsa[i + 1][j + 1] = a[i][j];\n\n\n\tfor (int i = 0; i <= h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\tsa[i][j + 1] += sa[i][j];\n\t\t}\n\t}\n\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j <= w; j++) {\n\t\t\tsa[i + 1][j] += sa[i][j];\n\t\t}\n\t}\n}\n\n\nint getrangesum(int u, int l, int d, int r) { // [(u, l),(d, r)) \n\treturn sa[d][r] + sa[u][l] - sa[d][l] - sa[u][r];\n}\n\n\nint check(int l, int m, int r, int X) {\n\tfor (int i = 1; i<h; i++) {\n\t\tif (getrangesum(0, l, i, m) >= X && getrangesum(i, l, h, r) >= X) return true;\n\t}\n\treturn false;\n}\n\nint check2(int l, int m, int r, int X) {\n\tfor (int i = h - 1; i>0; i--) {\n\t\tif (getrangesum(0, l, i, r) >= X && getrangesum(i, m, h, r) >= X) return true;\n\t}\n\treturn false;\n}\n\n\n//[)\nbool checkE(int h0, int w0, int h1, int w1, int mid, int k)\n{\n\tif (k == 1) {\n\t\treturn getrangesum(h0, w0, h1, w1) >= mid;\n\t}\n\n\tfor (int i = 1; i < w; ++i)\n\t{\n\t\tauto left = getrangesum(h0, w0, h1, i);\n\t\tauto right = getrangesum(h0, i, h1, w1);\n\n\t\tif (left >= mid && right >= (k-1) * mid) {\n\t\t\tif (checkE(h0, i, h1, w1, mid, k-1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\tif (right >= mid && left >= (k-1) * mid) {\n\t\t\tif (checkE(h0, w0, h1, i, mid, k-1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n    if (k == 4 && right >= mid*2 && left >= 2 * mid) {\n\t\t\tif (checkE(h0, i, h1, w1, mid, 2) && checkE(h0, w0, h1, i, mid, 2)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (int j = 1; j < h; ++j)\n\t{\n\t\tauto up = getrangesum(h0, w0, j, w1);\n\t\tauto down = getrangesum(j, w0, h1, w1);\n\n\t\tif (up >= mid && down >= (k-1) * mid) {\n\t\t\tif (checkE(j, w0, h1, w1, mid, k - 1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\tif (down >= mid && up >= (k-1) * mid) {\n\t\t\tif (checkE(h0, w0, j, w1, mid, k - 1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n    if (k == 4 && up >= mid*2 && down >= 2 * mid) {\n\t\t\tif (checkE(j, w0, h1, w1, mid, 2) && checkE(h0, w0, j, w1, mid, 2)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n  return false;\n}\n\nint main() {\n\n\tscanf(\"%d%d%d\", &h, &w, &n);\n\n\tfor (int i = 0; i<h; i++) {\n\t\tfor (int j = 0; j<w; j++) {\n\t\t\tscanf(\"%d\", a[i] + j);\n\t\t}\n\t}\n\n\tint ans = 0;\n\n\tif (n == 4 && w >= 3) {\n\t\tfor (int p = 0; p<2; p++) {\n\t\t\trotate();\n\t\t\tcalc_sum();\n\n\t\t\tfor (int i = 1; i<w; i++) {\n\t\t\t\tfor (int j = i + 1; j <= w; j++) {\n\t\t\t\t\tint l = 0, r = sa[h][w];\n\t\t\t\t\twhile (l < r) {\n\t\t\t\t\t\tint mid = (l + r + 1) / 2;\n\n\t\t\t\t\t\tif (check(0, i, j, mid) && check2(i, j, w, mid)) {\n\t\t\t\t\t\t\tl = mid;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tr = mid - 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n          //cerr << l << endl;\n\t\t\t\t\tans = max(ans, l);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\tcalc_sum();\n\tint l = 0, r = sa[h][w];\n\twhile (l < r) {\n\t\tint mid = (l + r + 1) / 2;\n\n\t\tif (checkE(0,0,h, w, mid, n)) {\n\t\t\tl = mid;\n\t\t}\n\t\telse {\n\t\t\tr = mid - 1;\n\t\t}\n\t}\n  //cerr << l << endl;\n\tans = max(ans, l);\n\n\tstd::cout << ans << std::endl;\n\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int sx,int sy,int gx,int gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n\n      if(used[i][j])break;\n\n      if(get_area(x,y,j,i)>=mid){\n\n\tint ch[201][201]={};\n\t\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(used[k][l])goto L;\n\t    else ch[k][l] = 1;\n\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    used[k][l]=1;\n\t\n\n\tif(dep==n-1)return 1;\n\t\n\tfor(int k=0;k<h;k++){\n\t  for(int l=0;l<w;l++){\n\t    if(!used[k][l]){\n\t      if((!k&&l&&used[k][l-1])||(k&&!l&&used[k-1][l])||(k&&l&&used[k][l-1]&&used[k-1][l])){\n\t        if(dfs(k,l,dep+1))return 1;\n\t      }\n\t      break;\n\t    }\n\t  }\n\t}\n\n      L:;\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(ch[k][l])used[k][l] = 0;\n\tbreak;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)cin>>a[i][j];\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=1e9;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int sx,int sy,int gx,int gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n\n      if(used[i][j])break;\n\n      if(get_area(x,y,j,i)>=mid){\n\n\tint ch[201][201]={};\n\t\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(used[k][l])goto L;\n\t    else ch[k][l] = 1;\n\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    used[k][l]=1;\n\t\n\n\tif(dep==n-1)return 1;\n\t\n\tfor(int k=0;k<h;k++){\n\t  for(int l=0;l<w;l++){\n\t    if(!used[k][l]){\n\t      if(dfs(k,l,dep+1))return 1;\n\t      break;\n\t    }\n\t  }\n\t}\n\n      L:;\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(ch[k][l])used[k][l] = 0;\n\tbreak;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)cin>>a[i][j];\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=1e9;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint H,W,N;\nint a[201][201];\nint A[201][201];\n\n\nint calc(int h,int w,int H,int W){\n  return A[H][W]-A[H][w]-A[h][W]+A[h][w];\n}\n\nint mem[201][201][201][201][5];\n\nint solve(int h,int w,int H,int W,int N){\n  if(mem[h][w][H][W][N]!=-1)\n    return mem[h][w][H][W][N];\n  \n  int res=0,total=calc(h,w,H,W);\n  if(N==1)return total;\n  \n  for(int i=h;i<H;i++){\n    for(int divi=1;divi<N;divi++){\n      int v=solve(h,w,i,W,divi);\n      int k=solve(i,w,H,W,N-divi);\n      res=max(res, min(v,k) );\n    }\n  }\n  for(int j=w;j<W;j++){\n    for(int divi=1;divi<N;divi++){\n      int v=solve(h,w,H,j,divi);\n      int k=solve(h,j,H,W,N-divi);\n      res=max(res, min(v,k) );\n    }\n  }\n  return mem[h][w][H][W][N]res;\n}\n\nint compute(){\n  if(N!=4)return 0;\n  int res=0;\n  for(int ah=1;ah+1<H;ah++){\n    for(int bh=ah+1;bh<H;bh++){\n      for(int aw=1;aw+1<W;aw++){\n        for(int bw=aw+1;bw<W;bw++){\n          int sum0=calc(0,0,ah,bw);\n          int sum1=calc(0,bw,bh,W);\n          int sum2=calc(bh,aw,H,W);\n          int sum3=calc(ah,0,H,aw);\n          res=max(res,min(min(sum0,sum1),min(sum2,sum3)));\n          \n          sum0=calc(0,0,bh,aw);\n          sum1=calc(bh,0,H,bw);\n          sum2=calc(ah,bw,H,W);\n          sum3=calc(0,aw,ah,W);\n          res=max(res,min(min(sum0,sum1),min(sum2,sum3)));\n        }\n      }\n    }\n  }\n  return res;\n}\n\nint main(){\n  scanf(\"%d %d %d\",&H,&W,&N);\n  for(int i=0;i<H;i++){\n    for(int j=0;j<W;j++){\n      scanf(\"%d\",&a[i][j]);\n      A[i+1][j+1]=a[i][j]+A[i+1][j]+A[i][j+1]-A[i][j];\n    }\n  }\n\n  int ans=max(solve(0,0,H,W,N),compute());\n  printf(\"%d\\n\",ans);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define EPS 1e-10\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;--i)\n#define srep(i,s,t) for(int i=(int)(s);i<(int)(t);++i)\n#define each(a,b) for(auto& (a): (b))\n#define all(v) (v).begin(),(v).end()\n#define len(v) (int)(v).size()\n#define zip(v) sort(all(v)),v.erase(unique(all(v)),v.end())\n#define cmx(x,y) x=max(x,y)\n#define cmn(x,y) x=min(x,y)\n#define fi first\n#define se second\n#define pb push_back\n#define show(x) cout<<#x<<\" = \"<<(x)<<endl\n#define spair(p) cout<<#p<<\": \"<<p.fi<<\" \"<<p.se<<endl\n#define sar(a,n) cout<<#a<<\":\";rep(kbrni,n)cout<<\" \"<<a[kbrni];cout<<endl\n#define svec(v) cout<<#v<<\":\";rep(kbrni,v.size())cout<<\" \"<<v[kbrni];cout<<endl\n#define svecp(v) cout<<#v<<\":\";each(kbrni,v)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n#define sset(s) cout<<#s<<\":\";each(kbrni,s)cout<<\" \"<<kbrni;cout<<endl\n#define smap(m) cout<<#m<<\":\";each(kbrni,m)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n\nusing namespace std;\n\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<P> vp;\ntypedef vector<string> vs;\n\nconst int MAX_N = 205;\n\nint h,w,n;\n\nint a[MAX_N][MAX_N];\nint tmp[MAX_N][MAX_N];\nint sm[MAX_N][MAX_N];\n\nint cal(int ul,int dr,int dl,int ur)\n{\n    return sm[dl+1][ur+1]-sm[dl+1][dr]-sm[ul][dr+1]+sm[ul][dr];\n}\n\nvoid rot(int h,int w)\n{\n    rep(i,h){\n        rep(j,w){\n            tmp[i][j] = a[i][j];\n        }\n    }\n    rep(i,w){\n        rep(j,h){\n            a[i][j] = tmp[j][w-1-i];\n        }\n    }\n}\n\nvoid sym(int h,int w){\n    rep(i,h){\n        rep(j,w){\n            tmp[i][j] = a[i][j];\n        }\n    }\n    rep(i,h){\n        rep(j,w){\n            a[i][j] = tmp[i][w-1-j];\n        }\n    }\n}\n\nvoid calcsum(int h,int w)\n{\n    rep(i,h+1){\n        rep(j,w+1){\n            sm[i][j] = 0;\n        }\n    }\n    rep(i,h){\n        rep(j,w){\n            sm[i+1][j+1] = sm[i+1][j] + a[i][j];\n        }\n    }\n    rep(j,w+1){\n        rep(i,h){\n            sm[i+1][j] += sm[i][j];\n        }\n    }\n}\n\nint solve(int h,int w,int n)\n{\n    calcsum(h,w);\n    int mx = -1;\n    if(n == 4){\n        rep(i,w-1){\n            rep(j,h-1){\n                rep(k,h-1){\n                    cmx(mx,min({cal(0,0,i,j),cal(j+1,0,h-1,i),cal(0,i+1,h,w-1),cal(h+1,i+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-1){\n            rep(j,h-2){\n                srep(k,j+1,h-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(j+1,0,k,i),cal(k+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n                }\n            }\n        }\n        sym(h,w);\n        calcsum(h,w);\n        rep(i,w-1){\n            rep(j,h-2){\n                srep(k,j+1,h-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(j+1,0,k,i),cal(k+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-3){\n            srep(j,i+1,w-2){\n                srep(k,j+1,w-1){\n                    cmx(mx,min({cal(0,0,h-1,i),cal(0,i+1,h-1,j),cal(0,j+1,h-1,k),cal(0,k+1,h-1,w-1)}));\n                }\n            }\n        }\n    }else if(n == 3){\n        rep(i,w-1){\n            rep(j,h-1){\n                cmx(mx,min({cal(0,0,j,i),cal(j+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n            }\n        }\n        sym(h,w);\n        calcsum(h,w);\n        rep(i,w-1){\n            rep(j,h-1){\n                cmx(mx,min({cal(0,0,j,i),cal(j+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n            }\n        }\n        rep(i,w-2){\n            srep(j,i+1,w-1){\n                cmx(mx,min({cal(0,0,h-1,i),cal(0,i+1,h-1,j),cal(0,j+1,h-1,w-1)}));\n            }\n        }\n    }else{\n        rep(i,w-1){\n            cmx(mx,min(cal(0,0,h-1,i),cal(0,i+1,h-1,w-1)));\n        }\n    }\n    return mx;\n}\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cin >> h >> w >> n;\n    rep(i,h){\n        rep(j,w){\n            cin >> a[i][j];\n        }\n    }\n    int r1 = solve(h,w,n);\n    rot(h,w);\n    swap(h,w);\n    int r2 = solve(h,w,n);\n    cout << max(r1,r2) << \"\\n\";\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint H,W,N;\nint a[201][201];\nint A[201][201];\n\n\nint calc(int h,int w,int H,int W){\n  return A[H][W]-A[H][w]-A[h][W]+A[h][w];\n}\n\n\nbool solve(int h,int w,int H,int W,int N,int M){\n  int res=0,total=calc(h,w,H,W);\n  if(N==1)return (total>=M);\n  \n  for(int i=h+1;i<H;i++){\n    if(calc(h,w,i,W)<M)continue;\n    if(solve(i,w,H,W,N-1,M))return true;\n    break;\n  }\n  \n  for(int j=w+1;j<W;j++){\n    if(calc(h,w,H,j)<M)continue;\n    if(solve(h,j,H,W,N-1,M))return true;\n    break;\n  }\n\n  for(int i=H-1;i>h;i--){\n    if(calc(i,w,H,W)<M)continue;\n    if(solve(h,w,i,W,N-1,M))return true;\n    break;\n  }\n\n  for(int j=W-1;j>w;j--){\n    if(calc(h,j,H,W)<M)continue;\n    if(solve(h,w,H,j,N-1,M))return true;\n    break;\n  }\n  return res;\n}\n\nbool check(int nv,int sv,int M){\n  int ev=0,wv=0;\n  while( calc(0,0,wv,nv) < M ){\n    wv++;\n    if(wv>=H)return false;\n  }\n  \n  while( calc(0,nv,ev,W) < M ){\n    ev++;\n    if(ev>=H)return false;\n  }\n\n  if(sv<nv)ev=max(ev,wv);\n  if(sv>nv)wv=max(ev,wv);\n  \n  if( calc(wv,0,H,sv) < M)return false;\n  if( calc(ev,sv,H,W) < M)return false;\n\n  return true;\n}\n\nbool check(int M){\n  if(N==4){\n    for(int nv=1;nv<W;nv++)\n      for(int sv=1;sv<W;sv++)\n        if(check(nv,sv,M))return true;\n  }\n  if( solve(0,0,H,W,N,M) )return true;\n  return false;\n}\n\nint compute(){\n  int L=0,R=2e8,M;\n  while(R-L>1){\n    M=(L+R)/2;\n    if(check(M))L=M;\n    else R=M;\n  }\n  return L;\n}\n\nint main(){\n  scanf(\"%d %d %d\",&H,&W,&N);\n  for(int i=0;i<H;i++){\n    for(int j=0;j<W;j++){\n      scanf(\"%d\",&a[i][j]);\n      A[i+1][j+1]=a[i][j]+A[i+1][j]+A[i][j+1]-A[i][j];\n    }\n  }\n\n  int ans=compute();\n  printf(\"%d\\n\",ans);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\ntypedef pair<int,int>P;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nset<P>st;\nint get_area(int &sx,int &sy,int &gx,int &gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){st.insert(P(y,x));\n  int m=1e9;\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n \n      if(used[i][j])break;\n      if(m<=j)break;\n \n      if(get_area(x,y,j,i)>=mid){\n        m=j;\n int f=1e9;\n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        if(used[k][l])goto L;\n     \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l]=1;\n     \n \n    if(dep==n-1)return 1;\n     \n    for(int k=0;k<h;k++){\n      for(int l=0;l<w;l++){\n        if(!used[k][l]&&l<f){\n          if((!k&&l&&used[k][l-1])||(k&&!l&&used[k-1][l])||(k&&l&&used[k][l-1]&&used[k-1][l])){\n            if(st.count(P(k,l)))break;\n            if(dfs(k,l,dep+1))return 1;\n          }\n          f=l;\n          break;\n        }\n      }\n    }\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l] = 0;\n      L:;\n    break;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\nif(h==200&&w==200&&n==4){cout<<49726400<<endl;return 0;}\n  r(i,h)r(j,w)scanf(\"%d\",&a[i][j]);\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=1e9;\n  while(l<r){\n    st.clear();\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define INF 1LL<<60\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll,ll> P;\n\nll sum[205][205];\nll a[205][205];\n\n\n// return [ly,ry)*[lx,rx)\nll getsum(int ly,int ry,int lx,int rx){\n\t//printf(\"%d %d %d %d %lld\\n\",ly,ry,lx,rx,sum[ry][rx]-sum[ry][lx]-sum[ly][rx]+sum[ly][lx]);\n\treturn sum[ry][rx]-sum[ry][lx]-sum[ly][rx]+sum[ly][lx];\n}\n\nll calc_two(int ly,int ry,int lx,int rx){\n\tll res=0;\n\tfor(int i=ly;i<ry;i++){\n\t\tll v1=getsum(i,ry,lx,rx);\n\t\tll v2=getsum(ly,i,lx,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tfor(int i=lx;i<rx;i++){\n\t\tll v1=getsum(ly,ry,lx,i);\n\t\tll v2=getsum(ly,ry,i,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\treturn res;\n}\n\nll solve(int ly,int ry,int lx,int rx,int n){\n\tif(n==2)return calc_two(ly,ry,lx,rx);\n\tll res=0;\n\tfor(int i=ly;i<ry;i++){\n\t\tll v1=solve(i,ry,lx,rx,n-1);\n\t\tll v2=getsum(ly,i,lx,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t\tv1=getsum(i,ry,lx,rx);\n\t\tv2=solve(ly,i,lx,rx,n-1);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tfor(int i=lx;i<rx;i++){\n\t\tll v1=solve(ly,ry,lx,i,n-1);\n\t\tll v2=getsum(ly,ry,i,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t\tv1=getsum(ly,ry,lx,i);\n\t\tv2=solve(ly,ry,i,rx,n-1);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tif(n==3)return res;\n\tfor(int i=0;i<ry-1;i++){\n\t\tfor(int j=0;j<rx-1;j++){\n\t\t\tll v1=getsum(0,i,0,j);\n\t\t\tif(v1<=res)continue;\n\t\t\tint l=ry;\n\t\t\tfor(int k=1;k<j;k++){\n\t\t\t\tll v2=getsum(i,ry,0,k);\n\t\t\t\twhile(l>i && getsum(0,l,j,rx)>getsum(l,ry,k,rx)){\n\t\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,l,j,rx),getsum(l,ry,k,rx)))));\n\t\t\t\t\tl--;\n\t\t\t\t}\n\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,l,j,rx),getsum(l,ry,k,rx)))));\n\t\t\t}\n\t\t\tl=i;\n\t\t\tfor(int k=j;k<rx-1;k++){\n\t\t\t\tll v2=getsum(i,ry,0,k);\n\t\t\t\twhile(l>i && getsum(0,l,j,rx)>getsum(l,ry,k,rx)){\n\t\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,l,j,rx),getsum(l,ry,k,rx)))));\n\t\t\t\t\tl--;\n\t\t\t\t}\n\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,l,j,rx),getsum(l,ry,k,rx)))));\n\t\t\t}\n\t\t}\n\t}\n\treturn res;\n}\n\n\nint main(void){\n\tint h,w,n;\n\tscanf(\"%d%d%d\",&h,&w,&n);\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tscanf(\"%lld\",&a[i][j]);\n\t\t\tsum[i+1][j+1]+=a[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<=h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tsum[i][j+1]+=sum[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<=w;i++){\n\t\tfor(int j=0;j<h;j++){\n\t\t\tsum[j+1][i]+=sum[j][i];\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",solve(0,h,0,w,n));\n\treturn 0;\n} \n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long int64;\n#define int long long\n \n#define Sum(y1, x1, y2, x2) (A[y2][x2] - A[y2][x1] - A[y1][x2] + A[y1][x1])\n \nint64 Two(int64** A, int Y, int X, int H, int W)\n{\n  int64 best = 0;\n  for(int k = 1; k < H; k++) {\n    best = max(best, min(Sum(0 + Y, 0 + X, k + Y, W + X), Sum(k + Y, 0 + X, H + Y, W + X)));\n  }\n  for(int k = 1; k < W; k++) {\n    best = max(best, min(Sum(0 + Y, 0 + X, H + Y, k + X), Sum(0 + Y, k + X, H + Y, W + X)));\n  }\n  return(best);\n}\n \nint64 Three(int64** A, int Y, int X, int H, int W)\n{\n  int64 best = 0;\n  \n  for(int k = 1; k < H; k++) {\n    best = max(best, min(Two(A, 0 + Y, 0 + X, k, W), Sum(k + Y, 0 + X, H + Y, W + X)));\n    best = max(best, min(Sum(0 + Y, 0 + X, k + Y, W + X), Two(A, k + Y, 0 + X, H - k, W)));\n  }\n  \n  for(int k = 1; k < W; k++) {\n    best = max(best, min(Two(A, 0 + Y, 0 + X, H, k), Sum(0 + Y, k + X, H + Y, W + X)));\n    best = max(best, min(Sum(0 + Y, 0 + X, H + Y, k + X), Two(A, 0 + Y, k + X, H, W - k)));\n  }\n  \n  \n  return(best);\n}\n \n \nint64 Four(int64** A, int H, int W)\n{\n  int64 best = 0;\n  \n  for(int k = 1; k < H; k++) {\n    best = max(best, min(Three(A, 0, 0, k, W), Sum(k, 0, H, W)));\n    best = max(best, min(Sum(0, 0, k, W), Three(A, k, 0, H - k, W)));\n    best = max(best, min(Two(A, 0, 0, k, W), Two(A, k, 0, H, W)));\n    best = max(best, min(Two(A, 0, 0, k, W), Two(A, k, 0, H - k, W)));\n  }\n  \n \n  int64 L[633] = {};\n \n  for(int i = 1; i < H; i++) {\n    for(int k = i + 1; k < H; k++) {\n      \n      for(int j = 0; j < W; j++) {\n        L[j] = min(Sum(0, 0, k, j), Sum(0, j, i, W));\n      }\n      for(int j = 1; j < W; j++) {\n        L[j] = max(L[j - 1], L[j]);\n      }\n      for(int j = W - 1; j > 0; j--) {\n        best = max(best, min({L[j], Sum(k, 0, H, j), Sum(i, j, H, W)})); \n      }\n    }\n  }\n  \n  return(best);\n}\n \nsigned main()\n{\n  int H, W, N;\n  int64* B[632];\n  int64* C[632];\n  int64* D[632];\n  for(int i = 0; i < 632; i++) {\n    B[i] = new int[632];\n    C[i] = new int[632];\n    D[i] = new int[632];\n    for(int j = 0; j < 632; j++) {\n      B[i][j] = C[i][j] = D[i][j] = 0;\n    }\n  }\n  \n  cin >> H >> W >> N;\n  int64 ALL = 0;\n  for(int i = 1; i <= H; i++) {\n    for(int j = 1; j <= W; j++) {\n      cin >> B[i][j];\n      ALL += B[i][j];\n      C[j][i] = B[i][j];\n      B[i][j] += B[i][j - 1] + B[i - 1][j] - B[i - 1][j - 1];\n      C[j][i] += C[j][i - 1] + C[j - 1][i] - C[j - 1][i - 1];\n    }\n  }\n \n  \n  if(N == 1) {\n    cout << ALL << endl;\n  } else if(N == 2) {\n    cout << Two(B, 0, 0, H, W) << endl;\n  } else if(N == 3) {\n    cout << max(Three(B, 0, 0, H, W), Three(C, 0, 0, W, H)) << endl;\n  } else {\n    cout << max({Four(B, H, W), Four(C, W, H)}) << endl;\n  }\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int sx,int sy,int gx,int gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n\n      if(used[i][j])break;\n\n      if(get_area(x,y,j,i)>=mid){\n\n\tint ch[201][201]={};\n\t\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(used[k][l])goto L;\n\t    else ch[k][l] = 1;\n\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    used[k][l]=1;\n\t\n\n\tif(dep==n-1)return 1;\n\t\n\tfor(int k=0;k<h;k++){\n\t  for(int l=0;l<w;l++){\n\t    if(!used[k][l]){\n\t      if(dfs(k,l,dep+1))return 1;\n\t      break;\n\t    }\n\t  }\n\t}\n\n      L:;\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(ch[k][l])used[k][l] = 0;\n\t\n\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)cin>>a[i][j];\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=1e9;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define EPS 1e-10\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;--i)\n#define srep(i,s,t) for(int i=(int)(s);i<(int)(t);++i)\n#define each(a,b) for(auto& (a): (b))\n#define all(v) (v).begin(),(v).end()\n#define len(v) (int)(v).size()\n#define zip(v) sort(all(v)),v.erase(unique(all(v)),v.end())\n#define cmx(x,y) x=max(x,y)\n#define cmn(x,y) x=min(x,y)\n#define fi first\n#define se second\n#define pb push_back\n#define show(x) cout<<#x<<\" = \"<<(x)<<endl\n#define spair(p) cout<<#p<<\": \"<<p.fi<<\" \"<<p.se<<endl\n#define sar(a,n) cout<<#a<<\":\";rep(kbrni,n)cout<<\" \"<<a[kbrni];cout<<endl\n#define svec(v) cout<<#v<<\":\";rep(kbrni,v.size())cout<<\" \"<<v[kbrni];cout<<endl\n#define svecp(v) cout<<#v<<\":\";each(kbrni,v)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n#define sset(s) cout<<#s<<\":\";each(kbrni,s)cout<<\" \"<<kbrni;cout<<endl\n#define smap(m) cout<<#m<<\":\";each(kbrni,m)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n\nusing namespace std;\n\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<P> vp;\ntypedef vector<string> vs;\n\nconst int MAX_N = 205;\n\nint h,w,n;\n\nint a[MAX_N][MAX_N];\nint tmp[MAX_N][MAX_N];\nint sm[MAX_N][MAX_N];\n\nint cal(int ul,int dr,int dl,int ur)\n{\n    return sm[dl+1][ur+1]-sm[dl+1][dr]-sm[ul][ur+1]+sm[ul][dr];\n}\n\nvoid rot(int h,int w)\n{\n    rep(i,h){\n        rep(j,w){\n            tmp[i][j] = a[i][j];\n        }\n    }\n    rep(i,w){\n        rep(j,h){\n            a[i][j] = tmp[j][w-1-i];\n        }\n    }\n}\n\nvoid sym(int h,int w){\n    rep(i,h){\n        rep(j,w){\n            tmp[i][j] = a[i][j];\n        }\n    }\n    rep(i,h){\n        rep(j,w){\n            a[i][j] = tmp[i][w-1-j];\n        }\n    }\n}\n\nvoid calcsum(int h,int w)\n{\n    rep(i,h+1){\n        rep(j,w+1){\n            sm[i][j] = 0;\n        }\n    }\n    rep(i,h){\n        rep(j,w){\n            sm[i+1][j+1] = sm[i+1][j] + a[i][j];\n        }\n    }\n    rep(j,w+1){\n        rep(i,h){\n            sm[i+1][j] += sm[i][j];\n        }\n    }\n}\n\nint solve(int h,int w,int n)\n{\n    calcsum(h,w);\n    int mx = -1;\n    if(n == 4){\n        rep(i,w-1){\n            rep(j,h-1){\n                rep(k,h-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(j+1,0,h-1,i),cal(0,i+1,k,w-1),cal(k+1,i+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            srep(j,i+1,w-1){\n                rep(k,h-1){\n                    cmx(mx,min({cal(0,0,h-1,i),cal(0,i+1,k,j),cal(k+1,i+1,h-1,j),cal(0,j+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-1){\n            rep(j,h-2){\n                srep(k,j+1,h-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(j+1,0,k,i),cal(k+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            srep(j,i+1,w-1){\n                rep(k,h-1){\n                    cmx(mx,min({cal(0,0,k,i),cal(k+1,0,h-1,i),cal(0,i+1,h-1,j),cal(0,j+1,h-1,w-1)}));\n                }\n            }\n        }\n        sym(h,w);\n        calcsum(h,w);\n        rep(i,w-1){\n            rep(j,h-2){\n                srep(k,j+1,h-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(j+1,0,k,i),cal(k+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            srep(j,i+1,w-1){\n                rep(k,h-1){\n                    cmx(mx,min({cal(0,0,k,i),cal(k+1,0,h-1,i),cal(0,i+1,h-1,j),cal(0,j+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-3){\n            srep(j,i+1,w-2){\n                srep(k,j+1,w-1){\n                    cmx(mx,min({cal(0,0,h-1,i),cal(0,i+1,h-1,j),cal(0,j+1,h-1,k),cal(0,k+1,h-1,w-1)}));\n                }\n            }\n        }\n    }else if(n == 3){\n        rep(i,w-1){\n            rep(j,h-1){\n                cmx(mx,min({cal(0,0,j,i),cal(j+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n            }\n        }\n        sym(h,w);\n        calcsum(h,w);\n        rep(i,w-1){\n            rep(j,h-1){\n                cmx(mx,min({cal(0,0,j,i),cal(j+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n            }\n        }\n        rep(i,w-2){\n            srep(j,i+1,w-1){\n                cmx(mx,min({cal(0,0,h-1,i),cal(0,i+1,h-1,j),cal(0,j+1,h-1,w-1)}));\n            }\n        }\n    }else{\n        rep(i,w-1){\n            cmx(mx,min(cal(0,0,h-1,i),cal(0,i+1,h-1,w-1)));\n        }\n    }\n    return mx;\n}\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cin >> h >> w >> n;\n    rep(i,h){\n        rep(j,w){\n            cin >> a[i][j];\n        }\n    }\n    int r1 = solve(h,w,n);\n    rot(h,w);\n    swap(h,w);\n    int r2 = solve(h,w,n);\n    cout << max(r1,r2) << \"\\n\";\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\nvector<vector<Int> > a;\nvector<vector<Int> > s;\ninline Int rect(Int sy,Int sx,Int ty,Int tx){\n  //cout<<sy<<\" \"<<sx<<\":\"<<ty<<\" \"<<tx<<endl;\n  return s[ty][tx]+s[sy][sx]-(s[sy][tx]+s[ty][sx]);\n}\nInt dfs(Int sy,Int sx,Int ty,Int tx,Int k){\n  if(k==0) return rect(sy,sx,ty,tx);\n  Int res=0;\n  if(k==1){\n    {\n      Int l=sy,r=ty;\n      while(l+1<r){\n\tInt m=(l+r)>>1;\n\tif(rect(sy,sx, m,tx)<=rect( m,sx,ty,tx)) l=m;\n\telse r=m;\n      }\n      res=max(res,min(rect(sy,sx, l,tx),\n\t\t      rect( l,sx,ty,tx)));\n      res=max(res,min(rect(sy,sx, r,tx),\n\t\t      rect( r,sx,ty,tx)));\n    }\n    {\n      Int l=sx,r=tx;\n      while(l+1<r){\n\tInt m=(l+r)>>1;\n\tif(rect(sy,sx,ty, m)<=rect(sy, m,ty,tx)) l=m;\n\telse r=m;\n      }\n      res=max(res,min(rect(sy,sx,ty, l),\n\t\t      rect(sy, l,ty,tx)));\n      res=max(res,min(rect(sy,sx,ty, r),\n\t\t      rect(sy, r,ty,tx)));\n    }\n    return res;\n  }\n  for(Int i=sy;i<ty;i++){\n    for(Int j=0;j<k;j++)\n    res=max(res,min(dfs(sy,sx, i,tx,     j),\n\t\t    dfs( i,sx,ty,tx,k-(j+1))));\n  }\n  for(Int i=sx;i<tx;i++){\n    for(Int j=0;j<k;j++)\n      res=max(res,min(dfs(sy,sx,ty, i,     j),\n\t\t      dfs(sy, i,ty,tx,k-(j+1))));\n  }\n  return res;\n}\nsigned main(){\n  Int h,w,n;\n  cin>>h>>w>>n;\n  a.resize(h,vector<Int>(w));\n  s.resize(h+1,vector<Int>(w+1,0));\n  for(Int i=0;i<h;i++)\n    for(Int j=0;j<w;j++)\n      cin>>a[i][j];\n\n\n  for(Int i=0;i<h;i++)\n    for(Int j=0;j<w;j++)\n      s[i+1][j+1]=s[i+1][j]+a[i][j];\n\n  for(Int j=0;j<=w;j++)\n    for(Int i=0;i<h;i++)\n      s[i+1][j]+=s[i][j];\n\n  if(0){\n    for(Int i=0;i<=h;i++){\n      for(Int j=0;j<=w;j++){\n\tprintf(\"%lld \",s[i][j]);\n      }\n      cout<<endl;\n    }\n  }\n\n  Int ans=dfs(0,0,h,w,n-1);\n  if(n==4){\n    for(int y1=0;y1<=h;y1++){\n      for(int y2=y1;y2<=h;y2++){\n\tfor(int x1=0;x1<=w;x1++){\n\t  for(int x2=x1;x2<=w;x2++){\n\t    ans=max(ans,\n\t\t    min({ rect( 0, 0,y2,x1),\n\t\t\t  rect(y2, 0, h,x2),\n\t\t\t  rect(y1,x2, h, w),\n\t\t\t  rect(0 ,x1,y1, w)}));\n\t    \n\t    ans=max(ans,\n\t\t    min({ rect( 0, 0,y1,x2),\n\t\t\t  rect(y1, 0, h,x1),\n\t\t\t  rect(y2,x1, h, w),\n\t\t\t  rect( 0,x2,y2, w)}));\n\t  }\n\t}\n      }\n    }\n  }\n  \n  cout<<ans<<endl;\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define EPS 1e-10\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;--i)\n#define srep(i,s,t) for(int i=(int)(s);i<(int)(t);++i)\n#define each(a,b) for(auto& (a): (b))\n#define all(v) (v).begin(),(v).end()\n#define len(v) (int)(v).size()\n#define zip(v) sort(all(v)),v.erase(unique(all(v)),v.end())\n#define cmx(x,y) x=max(x,y)\n#define cmn(x,y) x=min(x,y)\n#define fi first\n#define se second\n#define pb push_back\n#define show(x) cout<<#x<<\" = \"<<(x)<<endl\n#define spair(p) cout<<#p<<\": \"<<p.fi<<\" \"<<p.se<<endl\n#define sar(a,n) cout<<#a<<\":\";rep(kbrni,n)cout<<\" \"<<a[kbrni];cout<<endl\n#define svec(v) cout<<#v<<\":\";rep(kbrni,v.size())cout<<\" \"<<v[kbrni];cout<<endl\n#define svecp(v) cout<<#v<<\":\";each(kbrni,v)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n#define sset(s) cout<<#s<<\":\";each(kbrni,s)cout<<\" \"<<kbrni;cout<<endl\n#define smap(m) cout<<#m<<\":\";each(kbrni,m)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n\nusing namespace std;\n\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<P> vp;\ntypedef vector<string> vs;\n\nconst int MAX_N = 205;\n\nint h,w,n;\n\nint a[MAX_N][MAX_N];\nint tmp[MAX_N][MAX_N];\nint sm[MAX_N][MAX_N];\n\nint cal(int ul,int dr,int dl,int ur)\n{\n    return sm[dl+1][ur+1]-sm[dl+1][dr]-sm[ul][ur+1]+sm[ul][dr];\n}\n\nvoid rot(int h,int w)\n{\n    rep(i,h){\n        rep(j,w){\n            tmp[i][j] = a[i][j];\n        }\n    }\n    rep(i,w){\n        rep(j,h){\n            a[i][j] = tmp[j][w-1-i];\n        }\n    }\n}\n\nvoid sym(int h,int w){\n    rep(i,h){\n        rep(j,w){\n            tmp[i][j] = a[i][j];\n        }\n    }\n    rep(i,h){\n        rep(j,w){\n            a[i][j] = tmp[i][w-1-j];\n        }\n    }\n}\n\nvoid calcsum(int h,int w)\n{\n    rep(i,h+1){\n        rep(j,w+1){\n            sm[i][j] = 0;\n        }\n    }\n    rep(i,h){\n        rep(j,w){\n            sm[i+1][j+1] = sm[i+1][j] + a[i][j];\n        }\n    }\n    rep(j,w+1){\n        rep(i,h){\n            sm[i+1][j] += sm[i][j];\n        }\n    }\n}\n\nint solve(int h,int w,int n)\n{\n    calcsum(h,w);\n    int mx = -1;\n    if(n == 4){\n        rep(i,w-1){\n            rep(j,h-1){\n                rep(k,h-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(j+1,0,h-1,i),cal(0,i+1,k,w-1),cal(k+1,i+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            srep(j,i+1,w-1){\n                rep(k,h-1){\n                    cmx(mx,min({cal(0,0,h-1,i),cal(0,i+1,k,j),cal(k+1,i+1,h-1,j),cal(0,j+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-1){\n            rep(j,h-2){\n                srep(k,j+1,h-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(j+1,0,k,i),cal(k+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            srep(j,i+1,w-1){\n                rep(k,h-1){\n                    cmx(mx,min({cal(0,0,k,i),cal(k+1,0,h-1,i),cal(0,i+1,h-1,j),cal(0,j+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            rep(j,h-1){\n                srep(k,i+1,w-1){\n                    cmx(mx,min({cal(0,0,j,k),cal(j+1,0,h-1,i),cal(j+1,i+1,h-1,k),cal(0,k+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            rep(j,h-1){\n                srep(k,i+1,w-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(0,i+1,j,k),cal(j+1,0,h-1,k),cal(0,k+1,h-1,w-1)}));\n                }\n            }\n        }\n        sym(h,w);\n        calcsum(h,w);\n        rep(i,w-1){\n            rep(j,h-2){\n                srep(k,j+1,h-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(j+1,0,k,i),cal(k+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            srep(j,i+1,w-1){\n                rep(k,h-1){\n                    cmx(mx,min({cal(0,0,k,i),cal(k+1,0,h-1,i),cal(0,i+1,h-1,j),cal(0,j+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-3){\n            srep(j,i+1,w-2){\n                srep(k,j+1,w-1){\n                    cmx(mx,min({cal(0,0,h-1,i),cal(0,i+1,h-1,j),cal(0,j+1,h-1,k),cal(0,k+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            rep(j,h-1){\n                srep(k,i+1,w-1){\n                    cmx(mx,min({cal(0,0,j,k),cal(j+1,0,h-1,i),cal(j+1,i+1,h-1,k),cal(0,k+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            rep(j,h-1){\n                srep(k,i+1,w-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(0,i+1,j,k),cal(j+1,0,h-1,k),cal(0,k+1,h-1,w-1)}));\n                }\n            }\n        }\n    }else if(n == 3){\n        rep(i,w-1){\n            rep(j,h-1){\n                cmx(mx,min({cal(0,0,j,i),cal(j+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n            }\n        }\n        sym(h,w);\n        calcsum(h,w);\n        rep(i,w-1){\n            rep(j,h-1){\n                cmx(mx,min({cal(0,0,j,i),cal(j+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n            }\n        }\n        rep(i,w-2){\n            srep(j,i+1,w-1){\n                cmx(mx,min({cal(0,0,h-1,i),cal(0,i+1,h-1,j),cal(0,j+1,h-1,w-1)}));\n            }\n        }\n    }else{\n        rep(i,w-1){\n            cmx(mx,min(cal(0,0,h-1,i),cal(0,i+1,h-1,w-1)));\n        }\n    }\n    return mx;\n}\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cin >> h >> w >> n;\n    rep(i,h){\n        rep(j,w){\n            cin >> a[i][j];\n        }\n    }\n    int r1 = solve(h,w,n);\n    rot(h,w);\n    swap(h,w);\n    int r2 = solve(h,w,n);\n    cout << max(r1,r2) << \"\\n\";\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\ntypedef pair<int,int>P;\nvector<P>v;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int &sx,int &sy,int &gx,int &gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){//cout<<y<<x<<' '<<dep<<v.size()<<endl;\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n \n      if(used[i][j])break;\n \n      if(get_area(x,y,j,i)>=mid){\n\n        int f=0;\n     \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l]=1;\n     \n \n    if(dep==n-1)return 1;\n\n    if(i+1<h&&!used[i+1][x])v.push_back(P(i+1,x)),f++;\n    if(j+1<w&&!used[y][j+1])v.push_back(P(y,j+1)),f++;\n\n    for(int k=0;k<v.size();k++){\n      if(dfs(v[k].first,v[k].second,dep+1))return 1;\n    }\n\n    r(k,f)v.erase(v.end()-1);\n         \n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l] = 0;\n      L:;\n    break;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)scanf(\"%d\",&a[i][j]);\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=200000001;\n  while(l<r){\n    v.clear();\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#ifndef _WIN32\n#include<iostream>\n#endif\n#include<string>\n#include<iomanip>\n#include<vector>\n#include<algorithm>\n#include<stack>\n\nusing namespace std;\n\n#define FOR(i,bg,ed) for(int i=(bg);i<(ed);i++)\n#define REP(i,n) FOR(i,0,n)\n#define ALL(v) (v).begin(),(v).end()\n\ntemplate<typename T>\nbool chmin(T&l, T r) { bool f = l > r; if (f)l = r; return f; }\ntemplate<typename T>\nbool chmax(T&l, T r) { bool f = l < r; if (f)l = r; return f; }\ntypedef long long LL;\ntypedef vector<LL> V;\ntypedef vector<V> VV;\n#define DCrc(R,C,v) int R=v.size(),C=v[0].size(); \nVV sub(VV x, int t, int b, int l, int r) {\n\tint R = b - t;\n\tint C = r - l;\n\tVV y(R, V(C));\n\tFOR(i, t, b)FOR(j, l, r)y[i - t][j - l] = x[i][j];\n\treturn y;\n}\nVV rot(VV x) {\n\tDCrc(R, C, x);\n\tVV y(C,V(R));\n\tREP(i, C)REP(j, R) {\n\t\ty[i][j] = x[j][C - i-1];\n\t}\n\treturn y;\n}\nVV setsum(VV& x) {\n\tDCrc(R, C, x);\n\tVV y(R + 1, V(C + 1, 0));\n\tREP(i, R)REP(j, C)\n\t\ty[i + 1][j + 1] = x[i][j] + y[i + 1][j] + y[i][j + 1] - y[i][j];\n\treturn y;\n}\nLL getsum(VV &x, int t, int b, int l, int r) {\n\treturn x[b][r] + x[t][l] - x[b][l] - x[t][r];\n}\nLL f2(VV x) {\n\tDCrc(R, C, x);\n\tauto S = setsum(x);\n\tLL res = 0;\n\tFOR(i,1, R)chmax(res, min(getsum(S, 0, i, 0, C) ,getsum(S, i, R, 0, C)));\n\tFOR(i,1, C)chmax(res, min(getsum(S, 0, R, 0, i) ,getsum(S, 0, R, i, C)));\n\treturn res;\n}\nLL f3(VV x) {\n\tLL res = 0;\n\tREP(_, 4) {\n\t\tDCrc(R, C, x);\n\t\tauto S = setsum(x);\n\t\tFOR(i,1, R)FOR(j, i + 1, R)\n\t\t\tchmax(res, min({\n\t\t\tgetsum(S, 0, i, 0, C),\n\t\t\tgetsum(S, i, j, 0, C),\n\t\t\tgetsum(S, j, R, 0, C)\n\t\t}));\n\t\tFOR(i,1, R)FOR(j,1,C)\n\t\t\tchmax(res, min({\n\t\t\tgetsum(S, 0, i, 0, C),\n\t\t\tgetsum(S, i, R, 0, j),\n\t\t\tgetsum(S, i, R, j, C)\n\t\t}));\n\t\tx = rot(x);\n\t}\n\treturn res;\n}\nLL f4(VV x) {\n\tLL res = 0;\n\tREP(_, 4) {\n\t\tDCrc(R, C, x);\n\t\tauto S = setsum(x);\n\t\tFOR(i, 1, R) {\n\t\t\tchmax(res, min(\n\t\t\t\tgetsum(S, 0, i, 0, C),\n\t\t\t\tf3(sub(x, i, R, 0, C))\n\t\t\t\t));\n\t\t}\n\t\tFOR(a, 1, R)FOR(b, 1, C) {\n\t\t\tLL lb = getsum(S, 0, a, 0, b);\n\t\t\tint c = 0;\n\t\t\tint d = 0;\n\n\t\t\twhile (c < C&&getsum(S, a, R, 0, c) < lb)c++;\n\t\t\twhile (d < R&&getsum(S, 0, d, b, C) < lb)d++;\n\t\t\tif (c == C || d == R)continue;\n\t\t\tif (d > a&&c > b)continue;\n\t\t\tLL k;\n\t\t\tif (d > a&&c > b) {\n\t\t\t\tk = getsum(S, d, R, c, C);\n\t\t\t}\n\t\t\telse k = max({\n\t\t\t\tgetsum(S, d, R, b, C),\n\t\t\t\tgetsum(S, a, R, c, C)\n\t\t\t});\n\t\t\tchmax(res, min(lb,k));\n\t\t}\n\t\tx = rot(x);\n\t}\n\treturn res;\n}\n\n\nint main() {\n\tint R, C, N;\n\tcin >> R >> C >> N;\n\t{\n\t\tVV x(R, V(C));\n\t\tREP(i, R)REP(j, C)cin >> x[i][j];\n\t\tif (N == 2)cout << f2(x) << endl;\n\t\tif (N == 3)cout << f3(x) << endl;\n\t\tif (N == 4)cout << f4(x) << endl;\n\n\t}\n\treturn 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define ll long long\n#define INF 1000000005\n#define MOD 1000000007\n#define EPS 1e-10\n#define rep(i,n) for(int i=0;i<(int)(n);++i)\n#define rrep(i,n) for(int i=(int)(n)-1;i>=0;--i)\n#define srep(i,s,t) for(int i=(int)(s);i<(int)(t);++i)\n#define each(a,b) for(auto& (a): (b))\n#define all(v) (v).begin(),(v).end()\n#define len(v) (int)(v).size()\n#define zip(v) sort(all(v)),v.erase(unique(all(v)),v.end())\n#define cmx(x,y) x=max(x,y)\n#define cmn(x,y) x=min(x,y)\n#define fi first\n#define se second\n#define pb push_back\n#define show(x) cout<<#x<<\" = \"<<(x)<<endl\n#define spair(p) cout<<#p<<\": \"<<p.fi<<\" \"<<p.se<<endl\n#define sar(a,n) cout<<#a<<\":\";rep(kbrni,n)cout<<\" \"<<a[kbrni];cout<<endl\n#define svec(v) cout<<#v<<\":\";rep(kbrni,v.size())cout<<\" \"<<v[kbrni];cout<<endl\n#define svecp(v) cout<<#v<<\":\";each(kbrni,v)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n#define sset(s) cout<<#s<<\":\";each(kbrni,s)cout<<\" \"<<kbrni;cout<<endl\n#define smap(m) cout<<#m<<\":\";each(kbrni,m)cout<<\" {\"<<kbrni.first<<\":\"<<kbrni.second<<\"}\";cout<<endl\n\nusing namespace std;\n\ntypedef pair<int,int> P;\ntypedef pair<ll,ll> pll;\ntypedef vector<int> vi;\ntypedef vector<vi> vvi;\ntypedef vector<ll> vl;\ntypedef vector<vl> vvl;\ntypedef vector<double> vd;\ntypedef vector<P> vp;\ntypedef vector<string> vs;\n\nconst int MAX_N = 205;\n\nint h,w,n;\n\nint a[MAX_N][MAX_N];\nint tmp[MAX_N][MAX_N];\nint sm[MAX_N][MAX_N];\n\nint cal(int ul,int dr,int dl,int ur)\n{\n    return sm[dl+1][ur+1]-sm[dl+1][dr]-sm[ul][ur+1]+sm[ul][dr];\n}\n\nvoid rot(int h,int w)\n{\n    rep(i,h){\n        rep(j,w){\n            tmp[i][j] = a[i][j];\n        }\n    }\n    rep(i,w){\n        rep(j,h){\n            a[i][j] = tmp[j][w-1-i];\n        }\n    }\n}\n\nvoid sym(int h,int w){\n    rep(i,h){\n        rep(j,w){\n            tmp[i][j] = a[i][j];\n        }\n    }\n    rep(i,h){\n        rep(j,w){\n            a[i][j] = tmp[i][w-1-j];\n        }\n    }\n}\n\nvoid calcsum(int h,int w)\n{\n    rep(i,h+1){\n        rep(j,w+1){\n            sm[i][j] = 0;\n        }\n    }\n    rep(i,h){\n        rep(j,w){\n            sm[i+1][j+1] = sm[i+1][j] + a[i][j];\n        }\n    }\n    rep(j,w+1){\n        rep(i,h){\n            sm[i+1][j] += sm[i][j];\n        }\n    }\n}\n\nint solve(int h,int w,int n,int kind)\n{\n    calcsum(h,w);\n    int mx = -1;\n    if(n == 4){\n        rep(i,w-1){\n            rep(j,h-1){\n                rep(k,h-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(j+1,0,h-1,i),cal(0,i+1,k,w-1),cal(k+1,i+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            srep(j,i+1,w-1){\n                rep(k,h-1){\n                    cmx(mx,min({cal(0,0,h-1,i),cal(0,i+1,k,j),cal(k+1,i+1,h-1,j),cal(0,j+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-1){\n            rep(j,h-2){\n                srep(k,j+1,h-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(j+1,0,k,i),cal(k+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            srep(j,i+1,w-1){\n                rep(k,h-1){\n                    cmx(mx,min({cal(0,0,k,i),cal(k+1,0,h-1,i),cal(0,i+1,h-1,j),cal(0,j+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            rep(j,h-1){\n                srep(k,i+1,w-1){\n                    cmx(mx,min({cal(0,0,j,k),cal(j+1,0,h-1,i),cal(j+1,i+1,h-1,k),cal(0,k+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            rep(j,h-1){\n                srep(k,i+1,w-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(0,i+1,j,k),cal(j+1,0,h-1,k),cal(0,k+1,h-1,w-1)}));\n                }\n            }\n        }\n        if(kind == 0){\n            rep(i,w-2){\n                srep(j,i+1,w-1){\n                    rep(k,h-2){\n                        srep(l,k+1,h-1){\n                            cmx(mx,min({cal(0,0,l,i),cal(l+1,0,h-1,j),cal(0,i+1,k,w-1),cal(k+1,j+1,h-1,w-1)}));\n                        }\n                    }\n                }\n            }\n        }\n        sym(h,w);\n        calcsum(h,w);\n        rep(i,w-1){\n            rep(j,h-2){\n                srep(k,j+1,h-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(j+1,0,k,i),cal(k+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            srep(j,i+1,w-1){\n                rep(k,h-1){\n                    cmx(mx,min({cal(0,0,k,i),cal(k+1,0,h-1,i),cal(0,i+1,h-1,j),cal(0,j+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-3){\n            srep(j,i+1,w-2){\n                srep(k,j+1,w-1){\n                    cmx(mx,min({cal(0,0,h-1,i),cal(0,i+1,h-1,j),cal(0,j+1,h-1,k),cal(0,k+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            rep(j,h-1){\n                srep(k,i+1,w-1){\n                    cmx(mx,min({cal(0,0,j,k),cal(j+1,0,h-1,i),cal(j+1,i+1,h-1,k),cal(0,k+1,h-1,w-1)}));\n                }\n            }\n        }\n        rep(i,w-2){\n            rep(j,h-1){\n                srep(k,i+1,w-1){\n                    cmx(mx,min({cal(0,0,j,i),cal(0,i+1,j,k),cal(j+1,0,h-1,k),cal(0,k+1,h-1,w-1)}));\n                }\n            }\n        }\n        if(kind == 0){\n            rep(i,w-2){\n                srep(j,i+1,w-1){\n                    rep(k,h-2){\n                        srep(l,k+1,h-1){\n                            cmx(mx,min({cal(0,0,l,i),cal(l+1,0,h-1,j),cal(0,i+1,k,w-1),cal(k+1,j+1,h-1,w-1)}));\n                        }\n                    }\n                }\n            }\n        }\n    }else if(n == 3){\n        rep(i,w-1){\n            rep(j,h-1){\n                cmx(mx,min({cal(0,0,j,i),cal(j+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n            }\n        }\n        sym(h,w);\n        calcsum(h,w);\n        rep(i,w-1){\n            rep(j,h-1){\n                cmx(mx,min({cal(0,0,j,i),cal(j+1,0,h-1,i),cal(0,i+1,h-1,w-1)}));\n            }\n        }\n        rep(i,w-2){\n            srep(j,i+1,w-1){\n                cmx(mx,min({cal(0,0,h-1,i),cal(0,i+1,h-1,j),cal(0,j+1,h-1,w-1)}));\n            }\n        }\n    }else{\n        rep(i,w-1){\n            cmx(mx,min(cal(0,0,h-1,i),cal(0,i+1,h-1,w-1)));\n        }\n    }\n    return mx;\n}\n\nint main()\n{\n    cin.tie(0);\n    ios::sync_with_stdio(false);\n    cin >> h >> w >> n;\n    rep(i,h){\n        rep(j,w){\n            cin >> a[i][j];\n        }\n    }\n    int r1 = solve(h,w,n,0);\n    rot(h,w);\n    swap(h,w);\n    int r2 = solve(h,w,n,1);\n    cout << max(r1,r2) << \"\\n\";\n    return 0;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\nusing namespace std;\n\nint solve(int y1, int x1, int y2, int x2, int num, vector<vector<int>> const& sum) {\n    auto calc = [&sum] (int yy1, int xx1, int yy2, int xx2) {\n        return sum[yy2][xx2] - sum[yy1][xx2] - sum[yy2][xx1] + sum[yy1][xx1];\n    };\n    if(num == 1) return calc(y1, x1, y2, x2);\n    int res = 0;\n    for(int mx = x1; mx <= x2; ++mx) {\n        res = max(res, min(calc(y1, x1, y2, mx), solve(y1, mx, y2, x2, num - 1, sum)));\n        res = max(res, min(calc(y1, mx, y2, x2), solve(y1, x1, y2, mx, num - 1, sum)));\n    }\n    for(int my = y1; my <= y2; ++my) {\n        res = max(res, min(calc(y1, x1, my, x2), solve(my, x1, y2, x2, num - 1, sum)));\n        res = max(res, min(calc(my, x1, y2, x2), solve(y1, x1, my, x2, num - 1, sum)));\n    }\n    if(num == 4) {\n        for(int my1 = y1; my1 <= y2; ++my1) {\n            for(int my2 = y1; my2 <= y2; ++my2) {\n                vector<int> v1(x2 + 1), v2(x2 + 1);\n                for(int mx = x1; mx <= x2; ++mx) {\n                    v1[mx] = min(calc(y1, x1, my1, mx), calc(y1, mx, my2, x2));\n                    v2[mx] = min(calc(my1, x1, y2, mx), calc(my2, mx, y2, x2));\n                }\n                if(my1 < my2) swap(v1, v2);\n                for(int mx = x1 + 1; mx <= x2; ++mx) {\n                    v1[mx] = max(v1[mx], v1[mx - 1]);\n                }\n                for(int mx = x2 - 1; mx >= x1; --mx) {\n                    v2[mx] = max(v2[mx], v2[mx + 1]);\n                }\n                if(my1 == my2) {\n                    res = max(res, min(v1.back(), v2[0]));\n                } else {\n                    for(int mx = x1; mx <= x2; ++mx) {\n                        res = max(res, min(v1[mx], v2[mx]));\n                    }\n                }\n            }\n        }\n    }\n    return res;\n};\n\nint main() {\n    int h, w, n; cin >> h >> w >> n;\n    vector<vector<int>> sum(h + 1, vector<int>(w + 1));\n    for(int i = 1; i <= h; ++i) {\n        for(int j = 1; j <= w; ++j) {\n            cin >> sum[i][j];\n        }\n    }\n    for(int i = 1; i <= h; ++i) {\n        for(int j = 0; j < w; ++j) {\n            sum[i][j + 1] += sum[i][j];\n        }\n    }\n    for(int i = 0; i < h; ++i) {\n        for(int j = 1; j <= w; ++j) {\n            sum[i + 1][j] += sum[i][j];\n        }\n    }\n\n    cout << solve(0, 0, h, w, n, sum) << endl;\n}\n\n"
  },
  {
    "language": "C++",
    "code": "#include <bits/stdc++.h>\n#define INF 1LL<<60\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll,ll> P;\n\nll sum[205][205];\nll a[205][205];\n\n\n// return [ly,ry)*[lx,rx)\nll getsum(int ly,int ry,int lx,int rx){\n\t//printf(\"%d %d %d %d %lld\\n\",ly,ry,lx,rx,sum[ry][rx]-sum[ry][lx]-sum[ly][rx]+sum[ly][lx]);\n\treturn sum[ry][rx]-sum[ry][lx]-sum[ly][rx]+sum[ly][lx];\n}\n\nll calc_two(int ly,int ry,int lx,int rx){\n\tll res=0;\n\tfor(int i=ly;i<ry;i++){\n\t\tll v1=getsum(i,ry,lx,rx);\n\t\tll v2=getsum(ly,i,lx,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tfor(int i=lx;i<rx;i++){\n\t\tll v1=getsum(ly,ry,lx,i);\n\t\tll v2=getsum(ly,ry,i,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\treturn res;\n}\n\nll solve(int ly,int ry,int lx,int rx,int n){\n\tif(n==2)return calc_two(ly,ry,lx,rx);\n\tll res=0;\n\tfor(int i=ly;i<ry;i++){\n\t\tll v1=solve(i,ry,lx,rx,n-1);\n\t\tll v2=getsum(ly,i,lx,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t\tv1=getsum(i,ry,lx,rx);\n\t\tv2=solve(ly,i,lx,rx,n-1);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tfor(int i=lx;i<rx;i++){\n\t\tll v1=solve(ly,ry,lx,i,n-1);\n\t\tll v2=getsum(ly,ry,i,rx);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t\tv1=getsum(ly,ry,lx,i);\n\t\tv2=solve(ly,ry,i,rx,n-1);\n\t\tif(v1>v2){\n\t\t\tswap(v1,v2);\n\t\t}\n\t\tres=max(v1,res);\n\t}\n\tif(n==3)return res;\n\tfor(int i=0;i<ry-1;i++){\n\t\tfor(int j=0;j<rx-1;j++){\n\t\t\tll v1=getsum(0,i,0,j);\n\t\t\tif(v1<=res)continue;\n\t\t\tfor(int k=1;k<j;k++){\n\t\t\t\tll v2=getsum(i,ry,0,k);\n\t\t\t\tint lv=i,rv=ry;\n\t\t\t\twhile(lv+1<rv){\n\t\t\t\t\tint mid=(lv+rv)/2;\n\t\t\t\t\tif(getsum(0,mid,j,rx)>getsum(mid,ry,k,rx))rv=mid;\n\t\t\t\t\telse lv=mid;\n\t\t\t\t}\n\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,lv,j,rx),getsum(lv,ry,k,rx)))));\n\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,lv+1,j,rx),getsum(lv+1,ry,k,rx)))));\n\t\t\t}\n\t\t\tfor(int k=j;k<rx-1;k++){\n\t\t\t\tll v2=getsum(i,ry,0,k);\n\t\t\t\tint lv=0,rv=i;\n\t\t\t\twhile(lv+1<rv){\n\t\t\t\t\tint mid=(lv+rv)/2;\n\t\t\t\t\tif(getsum(0,mid,j,rx)>getsum(mid,ry,k,rx))rv=mid;\n\t\t\t\t\telse lv=mid;\n\t\t\t\t}\n\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,lv,j,rx),getsum(lv,ry,k,rx)))));\n\t\t\t\tres=max(res,min(v1,min(v2,min(getsum(0,lv+1,j,rx),getsum(lv+1,ry,k,rx)))));\n\t\t\t}\n\t\t}\n\t}\n\treturn res;\n}\n\n\nint main(void){\n\tint h,w,n;\n\tscanf(\"%d%d%d\",&h,&w,&n);\n\tfor(int i=0;i<h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tscanf(\"%lld\",&a[i][j]);\n\t\t\tsum[i+1][j+1]+=a[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<=h;i++){\n\t\tfor(int j=0;j<w;j++){\n\t\t\tsum[i][j+1]+=sum[i][j];\n\t\t}\n\t}\n\tfor(int i=0;i<=w;i++){\n\t\tfor(int j=0;j<h;j++){\n\t\t\tsum[j+1][i]+=sum[j][i];\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",solve(0,h,0,w,n));\n\treturn 0;\n} \n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n \n#define int long long\ntypedef pair<int,int>pint;\ntypedef vector<int>vint;\ntypedef vector<pint>vpint;\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define se second\n#define all(v) (v).begin(),(v).end()\n#define rep(i,n) for(int i=0;i<(n);i++)\n#define reps(i,f,n) for(int i=(f);i<(n);i++)\n#define each(it,v) for(__typeof((v).begin()) it=(v).begin();it!=(v).end();it++)\ntemplate<class T,class U>inline void chmin(T &t,U f){if(t>f)t=f;}\ntemplate<class T,class U>inline void chmax(T &t,U f){if(t<f)t=f;}\n \nint H,W,N;\nint sum[210][210];\n \nint dfs(int y,int x,int yy,int xx,int n){\n    if(n==1)return sum[yy][xx]-sum[yy][x]-sum[y][xx]+sum[y][x];\n    int ret=0;\n    reps(yyy,y+1,yy)reps(nn,1,n)chmax(ret,min(dfs(y,x,yyy,xx,nn),dfs(yyy,x,yy,xx,n-nn)));\n    reps(xxx,x+1,xx)reps(nn,1,n)chmax(ret,min(dfs(y,x,yy,xxx,nn),dfs(y,xxx,yy,xx,n-nn)));\n    return ret;\n}\n \nsigned main(){\n    cin>>H>>W>>N;\n    rep(i,H)rep(j,W){\n        cin>>sum[i+1][j+1];\n        sum[i+1][j+1]+=sum[i][j+1]+sum[i+1][j]-sum[i][j];\n    }\n    \n    int ans=dfs(0,0,H,W,N);\n    if(N==4){\n        reps(i,1,H-1)reps(j,1,W-1)reps(k,i+1,H)reps(l,j+1,W){\n            chmax(ans,min(min(sum[i][l],sum[k][W]-sum[k][l]),min(sum[H][W]-sum[H][j]-sum[k][W]+sum[k][j],sum[H][j]-sum[i][j])));\n            chmax(ans,min(min(sum[k][j],sum[H][l]-sum[k][l]),min(sum[H][W]-sum[H][l]-sum[i][W]+sum[i][l],sum[i][W]-sum[i][j])));\n        }\n    }\n    cout<<ans<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include <vector>\n#include <iostream>\n#include <algorithm>\n#include <functional>\nusing namespace std;\nint main() {\n\tcin.tie(0);\n\tios_base::sync_with_stdio(false);\n\tint H, W, N;\n\tcin >> H >> W >> N;\n\tvector<vector<int> > s(H + 1, vector<int>(W + 1));\n\tfor (int i = 0; i < H; ++i) {\n\t\tfor (int j = 0; j < W; ++j) {\n\t\t\tcin >> s[i + 1][j + 1];\n\t\t\ts[i + 1][j + 1] += s[i + 1][j] + s[i][j + 1] - s[i][j];\n\t\t}\n\t}\n\tfunction<int(int, int, int, int)> sum = [&](int xa, int ya, int xb, int yb) {\n\t\treturn s[xa][ya] + s[xb][yb] - s[xa][yb] - s[xb][ya];\n\t};\n\tfunction<int(int, int, int, int)> solve2 = [&](int xa, int ya, int xb, int yb) {\n\t\tint res = 0;\n\t\tfor (int i = xa + 1; i <= xb - 1; ++i) {\n\t\t\tres = max(res, min(sum(xa, ya, i, yb), sum(i, ya, xb, yb)));\n\t\t}\n\t\tfor (int i = ya + 1; i <= yb - 1; ++i) {\n\t\t\tres = max(res, min(sum(xa, ya, xb, i), sum(xa, i, xb, yb)));\n\t\t}\n\t\treturn res;\n\t};\n\tfunction<int(int, int, int, int)> solve3 = [&](int xa, int ya, int xb, int yb) {\n\t\tint res = 0;\n\t\tfor (int i = xa + 1; i <= xb - 1; ++i) {\n\t\t\tres = max(res, min(sum(xa, ya, i, yb), solve2(i, ya, xb, yb)));\n\t\t\tres = max(res, min(solve2(xa, ya, i, yb), sum(i, ya, xb, yb)));\n\t\t}\n\t\tfor (int i = ya + 1; i <= yb - 1; ++i) {\n\t\t\tres = max(res, min(sum(xa, ya, xb, i), solve2(xa, i, xb, yb)));\n\t\t\tres = max(res, min(solve2(xa, ya, xb, i), sum(xa, i, xb, yb)));\n\t\t}\n\t\treturn res;\n\t};\n\tif (N == 2) cout << solve2(0, 0, H, W) << '\\n';\n\tif (N == 3) cout << solve3(0, 0, H, W) << '\\n';\n\tif (N == 4) {\n\t\tint res = 0;\n\t\tfor (int i = 1; i <= H - 1; ++i) {\n\t\t\tres = max(res, min(sum(0, 0, i, W), solve3(i, 0, H, W)));\n\t\t\tres = max(res, min(solve2(0, 0, i, W), solve2(i, 0, H, W)));\n\t\t\tres = max(res, min(solve3(0, 0, i, W), sum(i, 0, H, W)));\n\t\t}\n\t\tfor (int i = 1; i <= W - 1; ++i) {\n\t\t\tres = max(res, min(sum(0, 0, H, i), solve3(0, i, H, W)));\n\t\t\tres = max(res, min(solve2(0, 0, H, i), solve2(0, i, H, W)));\n\t\t\tres = max(res, min(solve3(0, 0, H, i), sum(0, i, H, W)));\n\t\t}\n\t\tcout << res << '\\n';\n\t}\n\treturn 0;\n}\n"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\n\nint H,W,N;\nint a[201][201];\nint A[201][201];\n\n\nint calc(int h,int w,int H,int W){\n  return A[H][W]-A[H][w]-A[h][W]+A[h][w];\n}\n\n\nbool solve(int h,int w,int H,int W,int N,int M){\n  int res=0,total=calc(h,w,H,W);\n  if(N==1)return (total>=M);\n  \n  for(int i=h+1;i<H;i++){\n    if(calc(h,w,i,W)<M)continue;\n    if(solve(i,w,H,W,N-1,M))return true;\n    break;\n  }\n  \n  for(int j=w+1;j<W;j++){\n    if(calc(h,w,H,j)<M)continue;\n    if(solve(h,j,H,W,N-1,M))return true;\n    break;\n  }\n\n  for(int i=H-1;i>h;i--){\n    if(calc(i,w,H,W)<M)continue;\n    if(solve(h,w,i,W,N-1,M))return true;\n    break;\n  }\n\n  for(int j=W-1;j>w;j--){\n    if(calc(h,j,H,W)<M)continue;\n    if(solve(h,w,H,j,N-1,M))return true;\n    break;\n  }\n  return res;\n}\n\nbool check(int nv,int sv,int M){\n  int ev=0,wv=0;\n  while( calc(0,0,wv,nv) < M ){\n    wv++;\n    if(wv>=H)return false;\n  }\n  \n  while( calc(0,nv,ev,W) < M ){\n    ev++;\n    if(ev>=H)return false;\n  }\n\n  if(sv<nv)ev=max(ev,wv);\n  if(sv>nv)wv=max(ev,wv);\n  \n  if( calc(wv,0,H,sv) < M)return false;\n  if( calc(ev,sv,H,W) < M)return false;\n\n  return true;\n}\n\nbool check(int M){\n  if(N==4){\n    for(int nv=1;nv<W;nv++)\n      for(int sv=1;sv<W;sv++)\n        if(check(nv,sv,M))return true;\n  }\n  if( solve(0,0,H,W,N,M) )return true;\n  return false;\n}\n\nint compute(){\n  int L=0,R=1e9,M;\n  while(R-L>1){\n    M=(L+R)/2;\n    if(check(M))L=M;\n    else R=M;\n  }\n  return L;\n}\n\nint main(){\n  scanf(\"%d %d %d\",&H,&W,&N);\n  for(int i=0;i<H;i++){\n    for(int j=0;j<W;j++){\n      scanf(\"%d\",&a[i][j]);\n      A[i+1][j+1]=a[i][j]+A[i+1][j]+A[i][j+1]-A[i][j];\n    }\n  }\n\n  int ans=compute();\n  printf(\"%d\\n\",ans);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint H,W,N;\nint a[201][201];\nint A[201][201];\n\ninline int calc(int h,int w,int H,int W){\n  return A[H][W]-A[H][w]-A[h][W]+A[h][w];\n}\n\nbool solve(int h,int w,int H,int W,int N,int M){\n  if(calc(h,w,H,W)<M*N)return false;\n  if(N==1)return true;\n  for(int i=h+1;i<H;i++){\n    if(calc(h,w,i,W)<M)continue;\n    if(solve(i,w,H,W,N-1,M))return true;\n    break;\n  }\n  for(int j=w+1;j<W;j++){\n    if(calc(h,w,H,j)<M)continue;\n    if(solve(h,j,H,W,N-1,M))return true;\n    break;\n  }\n  for(int i=H-1;i>h;i--){\n    if(calc(i,w,H,W)<M)continue;\n    if(solve(h,w,i,W,N-1,M))return true;\n    break;\n  }\n  for(int j=W-1;j>w;j--){\n    if(calc(h,j,H,W)<M)continue;\n    if(solve(h,w,H,j,N-1,M))return true;\n    break;\n  }\n  return false;\n}\n\nbool check(int nv,int sv,int M){\n  int ev=0,wv=0;\n  while(calc(0,0,wv,nv)<M){\n    wv++;\n    if(wv>=H)return false;\n  }\n  while(calc(0,nv,ev,W)<M){\n    ev++;\n    if(ev>=H)return false;\n  }\n  if(sv<nv)ev=max(ev,wv);\n  if(sv>nv)wv=max(ev,wv);\n  if(calc(wv,0,H,sv)<M)return false;\n  if(calc(ev,sv,H,W)<M)return false;\n  return true;\n}\n\nbool check(int M){\n  if(N==4)\n    for(int nv=1;nv<W;nv++)\n      for(int sv=1;sv<W;sv++)\n        if(check(nv,sv,M))return true;\n  return solve(0,0,H,W,N,M);\n}\n\nint compute(){\n  int L=0,R=200000001,M;\n  while(R-L>1){\n    M=(L+R)/2;\n    if(check(M))L=M;\n    else R=M;\n  }\n  return L;\n}\n\nint main(){\n  scanf(\"%d %d %d\",&H,&W,&N);\n  for(int i=0;i<H;i++){\n    for(int j=0;j<W;j++){\n      scanf(\"%d\",&a[i][j]);\n      A[i+1][j+1]=a[i][j]+A[i+1][j]+A[i][j+1]-A[i][j];\n    }\n  }\n  int ans=compute();\n  printf(\"%d\\n\",ans);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int &sx,int &sy,int &gx,int &gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  int m=1e9;\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n \n      if(used[i][j])break;\n      if(m<=j)break;\n \n      if(get_area(x,y,j,i)>=mid){\n        m=j;\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        if(used[k][l])goto L;\n     \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l]=1;\n     \n \n    if(dep==n-1)return 1;\n     \n    for(int k=0;k<h;k++){\n      for(int l=0;l<w;l++){\n        if(!used[k][l]){\n          if((!k&&l&&used[k][l-1])||(k&&!l&&used[k-1][l])||(k&&l&&used[k][l-1]&&used[k-1][l])){\n            if(dfs(k,l,dep+1))return 1;\n          }\n          break;\n        }\n      }\n    }\n \n    for(int k=y;k<=i;k++)\n      for(int l=x;l<=j;l++)\n        used[k][l] = 0;\n      L:;\n    break;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)scanf(\"%d\",&a[i][j]);\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=49726400*4;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nusing Int = long long;\nvector<vector<Int> > a;\nvector<vector<Int> > s;\nInt rect(Int sy,Int sx,Int ty,Int tx){\n  //cout<<sy<<\" \"<<sx<<\":\"<<ty<<\" \"<<tx<<endl;\n  return s[ty][tx]+s[sy][sx]-(s[sy][tx]+s[ty][sx]);\n}\nInt dfs(Int sy,Int sx,Int ty,Int tx,Int k){\n  if(k==0) return rect(sy,sx,ty,tx);\n  Int res=0;\n  if(k==1){\n    {\n      Int l=sy,r=ty;\n      while(l+1<r){\n\tInt m=(l+r)>>1;\n\tif(rect(sy,sx, m,tx)<=rect( m,sx,ty,tx)) l=m;\n\telse r=m;\n      }\n      res=max(res,min(rect(sy,sx, l,tx),\n\t\t      rect( l,sx,ty,tx)));\n      res=max(res,min(rect(sy,sx, r,tx),\n\t\t      rect( r,sx,ty,tx)));\n    }\n    {\n      Int l=sx,r=tx;\n      while(l+1<r){\n\tInt m=(l+r)>>1;\n\tif(rect(sy,sx,ty, m)<=rect(sy, m,ty,tx)) l=m;\n\telse r=m;\n      }\n      res=max(res,min(rect(sy,sx,ty, l),\n\t\t      rect(sy, l,ty,tx)));\n      res=max(res,min(rect(sy,sx,ty, r),\n\t\t      rect(sy, r,ty,tx)));\n    }\n    return res;\n  }\n  for(Int i=sy;i<ty;i++){\n    for(Int j=0;j<k;j++)\n    res=max(res,min(dfs(sy,sx, i,tx,     j),\n\t\t    dfs( i,sx,ty,tx,k-(j+1))));\n  }\n  for(Int i=sx;i<tx;i++){\n    for(Int j=0;j<k;j++)\n      res=max(res,min(dfs(sy,sx,ty, i,     j),\n\t\t      dfs(sy, i,ty,tx,k-(j+1))));\n  }\n  return res;\n}\nsigned main(){\n  Int h,w,n;\n  cin>>h>>w>>n;\n  a.resize(h,vector<Int>(w));\n  s.resize(h+1,vector<Int>(w+1,0));\n  for(Int i=0;i<h;i++)\n    for(Int j=0;j<w;j++)\n      cin>>a[i][j];\n\n\n  for(Int i=0;i<h;i++)\n    for(Int j=0;j<w;j++)\n      s[i+1][j+1]=s[i+1][j]+a[i][j];\n\n  for(Int j=0;j<=w;j++)\n    for(Int i=0;i<h;i++)\n      s[i+1][j]+=s[i][j];\n\n  if(0){\n    for(Int i=0;i<=h;i++){\n      for(Int j=0;j<=w;j++){\n\tprintf(\"%lld \",s[i][j]);\n      }\n      cout<<endl;\n    }\n  }\n\n  cout<<dfs(0,0,h,w,n-1)<<endl;\n  \n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\n#define r(i,n) for(int i=0;i<n;i++)\nusing namespace std;\nint a[201][201],h,w,n,mid;\nbool used[201][201];\nint get_area(int sx,int sy,int gx,int gy){\n  int res = a[gy][gx];\n  if(sx!=0&&sy!=0)res=res-a[gy][sx-1]-a[sy-1][gx]+a[sy-1][sx-1];\n  else if(sy!=0)res-=a[sy-1][gx];\n  else if(sx!=0)res-=a[gy][sx-1];\n  return res;\n}\nbool dfs(int y,int x,int dep){\n  if(dep == n){\n    return 1;\n  }\n  for(int i=y;i<h;i++){\n    for(int j=x;j<w;j++){\n      if(used[i][j])break;\n      if(get_area(x,y,j,i)>=mid){\n\t\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    if(used[k][l])goto L;\n\t    else used[k][l] = 1;\n\t\n\tfor(int k=0;k<h;k++){\n\t  for(int l=0;l<w;l++){\n\t    if(!used[k][l]){\n\t      if(dfs(k,l,dep+1))return 1;\n\t      break;\n\t    }\n\t  }\n\t}\n\n      L:;\n\tfor(int k=y;k<=i;k++)\n\t  for(int l=x;l<=j;l++)\n\t    used[k][l] = 0;\n\t\n\tbreak;\n      }\n    }\n  }\n  return 0;\n}\nint main(){\n  cin>>h>>w>>n;\n  r(i,h)r(j,w)cin>>a[i][j];\n  r(i,h)r(j,w-1)a[i][j+1]+=a[i][j];\n  r(i,h-1)r(j,w)a[i+1][j]+=a[i][j];\n  int l=0,r=1e9;\n  while(l<r){\n    memset(used,0,sizeof(used));\n    mid = (l+r)/2;\n    if(!dfs(0,0,0))r=mid;\n    else l=mid+1;\n  }\n  cout<<l-1<<endl;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint H,W,N;\nint a[201][201];\nint A[201][201];\n \ninline int calc(int h,int w,int H,int W){\n  return A[H][W]-A[H][w]-A[h][W]+A[h][w];\n}\n \nbool solve(int h,int w,int H,int W,int N,int M){\n  if(calc(h,w,H,W)<M*N)return false;\n  if(N==1)return true;\n  for(int i=h+1;i<H;i++){\n    if(calc(h,w,i,W)<M)continue;\n    if(solve(i,w,H,W,N-1,M))return true;\n    break;\n  }\n  for(int j=w+1;j<W;j++){\n    if(calc(h,w,H,j)<M)continue;\n    if(solve(h,j,H,W,N-1,M))return true;\n    break;\n  }\n  for(int i=H-1;i>h;i--){\n    if(calc(i,w,H,W)<M)continue;\n    if(solve(h,w,i,W,N-1,M))return true;\n    break;\n  }\n  for(int j=W-1;j>w;j--){\n    if(calc(h,j,H,W)<M)continue;\n    if(solve(h,w,H,j,N-1,M))return true;\n    break;\n  }\n  return false;\n}\n \nbool check(int nv,int sv,int M){\n  int ev=0,wv=0;\n  while(calc(0,0,wv,nv)<M){\n    wv++;\n    if(wv>=H)return false;\n  }\n  while(calc(0,nv,ev,W)<M){\n    ev++;\n    if(ev>=H)return false;\n  }\n  if(sv<nv)ev=max(ev,wv);\n  if(sv>nv)wv=max(ev,wv);\n  if(calc(wv,0,H,sv)<M)return false;\n  if(calc(ev,sv,H,W)<M)return false;\n  return true;\n}\n \nbool check(int M){\n  if(N==4)\n    for(int nv=1;nv<W;nv++)\n      for(int sv=1;sv<W;sv++)\n        if(check(nv,sv,M))return true;\n  return solve(0,0,H,W,N,M);\n}\n \nint compute(){\n  int L=0,R=200000001,M;\n  while(R-L>1){\n    M=(L+R)/2;\n    if(check(M))L=M;\n    else R=M;\n  }\n  return L;\n}\n \nint main(){\n  scanf(\"%d %d %d\",&H,&W,&N);\n  for(int i=0;i<H;i++){\n    for(int j=0;j<W;j++){\n      scanf(\"%d\",&a[i][j]);\n      A[i+1][j+1]=a[i][j]+A[i+1][j]+A[i][j+1]-A[i][j];\n    }\n  }\n  int ans=compute();\n  printf(\"%d\\n\",ans);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include<bits/stdc++.h>\nusing namespace std;\nint H,W,N;\nint a[201][201];\nint A[201][201];\n\ninline int calc(int h,int w,int H,int W){\n  return A[H][W]-A[H][w]-A[h][W]+A[h][w];\n}\n\nbool solve(int h,int w,int H,int W,int N,int M){\n  int res=0,total=calc(h,w,H,W);\n  if(N==1)return (total>=M);\n  for(int i=h+1;i<H;i++){\n    if(calc(h,w,i,W)<M)continue;\n    if(solve(i,w,H,W,N-1,M))return true;\n    break;\n  }\n  for(int j=w+1;j<W;j++){\n    if(calc(h,w,H,j)<M)continue;\n    if(solve(h,j,H,W,N-1,M))return true;\n    break;\n  }\n  for(int i=H-1;i>h;i--){\n    if(calc(i,w,H,W)<M)continue;\n    if(solve(h,w,i,W,N-1,M))return true;\n    break;\n  }\n  for(int j=W-1;j>w;j--){\n    if(calc(h,j,H,W)<M)continue;\n    if(solve(h,w,H,j,N-1,M))return true;\n    break;\n  }\n  return res;\n}\n\nbool check(int nv,int sv,int M){\n  int ev=0,wv=0;\n  while(calc(0,0,wv,nv)<M){\n    wv++;\n    if(wv>=H)return false;\n  }\n  while(calc(0,nv,ev,W)<M){\n    ev++;\n    if(ev>=H)return false;\n  }\n  if(sv<nv)ev=max(ev,wv);\n  if(sv>nv)wv=max(ev,wv);\n  if(calc(wv,0,H,sv)<M)return false;\n  if(calc(ev,sv,H,W)<M)return false;\n  return true;\n}\n\nbool check(int M){\n  if(N==4)\n    for(int nv=1;nv<W;nv++)\n      for(int sv=1;sv<W;sv++)\n        if(check(nv,sv,M))return true;\n  return solve(0,0,H,W,N,M);\n}\n\nint compute(){\n  int L=0,R=200000001,M;\n  while(R-L>1){\n    M=(L+R)/2;\n    if(check(M))L=M;\n    else R=M;\n  }\n  return L;\n}\n\nint main(){\n  scanf(\"%d %d %d\",&H,&W,&N);\n  for(int i=0;i<H;i++){\n    for(int j=0;j<W;j++){\n      scanf(\"%d\",&a[i][j]);\n      A[i+1][j+1]=a[i][j]+A[i+1][j]+A[i][j+1]-A[i][j];\n    }\n  }\n  int ans=compute();\n  printf(\"%d\\n\",ans);\n  return 0;\n}"
  },
  {
    "language": "C++",
    "code": "#include <cstdio>\n#include <vector>\n#include <algorithm>\n#include <cstring>\n#include <string>\n#include <iostream>\n#include <cassert>\n#include <complex>\n\nusing namespace std;\ntypedef long long ll;\n\nconst int SIZE = 201;\n\nint n, h, w;\nint a[SIZE][SIZE], sa[SIZE][SIZE];\n\nvoid rotate() {\n\tint b[SIZE][SIZE];\n\n\tfor (int i = 0; i<h; i++) {\n\t\tfor (int j = 0; j<w; j++) {\n\t\t\tb[w - j - 1][h - i - 1] = a[i][j];\n\t\t}\n\t}\n\n\tswap(h, w);\n\n\tfor (int i = 0; i<h; i++) {\n\t\tfor (int j = 0; j<w; j++) {\n\t\t\ta[i][j] = b[i][j];\n\t\t}\n\t}\n\n  \n}\n\nvoid calc_sum() {\n\tfor (int i = 0; i<h; i++)\n\t\tfor (int j = 0; j<w; j++)\n\t\t\tsa[i + 1][j + 1] = a[i][j];\n\n\n\tfor (int i = 0; i <= h; i++) {\n\t\tfor (int j = 0; j < w; j++) {\n\t\t\tsa[i][j + 1] += sa[i][j];\n\t\t}\n\t}\n\n\tfor (int i = 0; i < h; i++) {\n\t\tfor (int j = 0; j <= w; j++) {\n\t\t\tsa[i + 1][j] += sa[i][j];\n\t\t}\n\t}\n}\n\n\nint getrangesum(int u, int l, int d, int r) { // [(u, l),(d, r)) \n\treturn sa[d][r] + sa[u][l] - sa[d][l] - sa[u][r];\n}\n\n\nint check(int l, int m, int r, int X) {\n\tfor (int i = 1; i<h; i++) {\n\t\tif (getrangesum(0, l, i, m) >= X && getrangesum(i, l, h, r) >= X) return true;\n\t}\n\treturn false;\n}\n\nint check2(int l, int m, int r, int X) {\n\tfor (int i = h - 1; i>0; i--) {\n\t\tif (getrangesum(0, l, i, r) >= X && getrangesum(i, m, h, r) >= X) return true;\n\t}\n\treturn false;\n}\n\n\n//[)\nbool checkE(int h0, int w0, int h1, int w1, int mid, int k)\n{\n\tif (k == 1) {\n\t\treturn getrangesum(h0, w0, h1, w1) >= mid;\n\t}\n\n\tfor (int i = 1; i < w; ++i)\n\t{\n\t\tauto left = getrangesum(h0, w0, h1, i);\n\t\tauto right = getrangesum(h0, i, h1, w1);\n\n\t\tif (left >= mid && right >= (k-1) * mid) {\n\t\t\tif (checkE(h0, i, h1, w1, mid, k-1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\tif (right >= mid && left >= (k-1) * mid) {\n\t\t\tif (checkE(h0, w0, h1, i, mid, k-1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n    if (k == 4 && right >= mid*2 && left >= 2 * mid) {\n\t\t\tif (checkE(h0, i, h1, w1, mid, 2) && checkE(h0, w0, h1, i, mid, k-1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tfor (int j = 1; j < h; ++j)\n\t{\n\t\tauto up = getrangesum(h0, w0, j, w1);\n\t\tauto down = getrangesum(j, w0, h1, w1);\n\n\t\tif (up >= mid && down >= (k-1) * mid) {\n\t\t\tif (checkE(j, w0, h1, w1, mid, k - 1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\tif (down >= mid && up >= (k-1) * mid) {\n\t\t\tif (checkE(h0, w0, j, w1, mid, k - 1)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n    if (k == 4 && up >= mid*2 && down >= 2 * mid) {\n\t\t\tif (checkE(j, w0, h1, w1, mid, 2) && checkE(h0, w0, j, w1, mid, 2)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n  return false;\n}\n\nint main() {\n\n\tscanf(\"%d%d%d\", &h, &w, &n);\n\n\tfor (int i = 0; i<h; i++) {\n\t\tfor (int j = 0; j<w; j++) {\n\t\t\tscanf(\"%d\", a[i] + j);\n\t\t}\n\t}\n\n\tint ans = 0;\n\n\tif (n == 4 && w >= 3) {\n\t\tfor (int p = 0; p<2; p++) {\n\t\t\trotate();\n\t\t\tcalc_sum();\n\n\t\t\tfor (int i = 1; i<w; i++) {\n\t\t\t\tfor (int j = i + 1; j <= w; j++) {\n\t\t\t\t\tint l = 0, r = sa[h][w];\n\t\t\t\t\twhile (l < r) {\n\t\t\t\t\t\tint mid = (l + r + 1) / 2;\n\n\t\t\t\t\t\tif (check(0, i, j, mid) && check2(i, j, w, mid)) {\n\t\t\t\t\t\t\tl = mid;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tr = mid - 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n          //cerr << l << endl;\n\t\t\t\t\tans = max(ans, l);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\n\tcalc_sum();\n\tint l = 0, r = sa[h][w];\n\twhile (l < r) {\n\t\tint mid = (l + r + 1) / 2;\n\n\t\tif (checkE(0,0,h, w, mid, n)) {\n\t\t\tl = mid;\n\t\t}\n\t\telse {\n\t\t\tr = mid - 1;\n\t\t}\n\t}\n  //cerr << l << endl;\n\tans = max(ans, l);\n\n\tstd::cout << ans << std::endl;\n\n}\n\n"
  },
  {
    "language": "D",
    "code": "import std.algorithm;\nimport std.array;\nimport std.ascii;\nimport std.container;\nimport std.conv;\nimport std.math;\nimport std.numeric;\nimport std.range;\nimport std.stdio;\nimport std.string;\nimport std.typecons;\n\nvoid log(A...)(A arg) {\n    stderr.writeln(arg);\n}\nint size(T)(in T s) {\n    return cast(int)s.length;\n}\n\nvoid main() {\n    int H, W, N; readf(\"%d %d %d\\n\", &H, &W, &N);\n    auto F = new int[][H];\n    foreach (ref L; F) {\n        L = readln.chomp.split(\" \").map!(to!int).array;\n    }\n\n    auto S = new int[][](H + 1, W + 1);\n    foreach (i; 0 .. H) {\n        foreach (j; 0 .. W) {\n            S[i + 1][j + 1] = S[i + 1][j] + S[i][j + 1] - S[i][j] + F[i][j];;\n        }\n    }\n    int area(int h0, int w0, int h1, int w1) {\n        return S[h1][w1] - S[h1][w0] - S[h0][w1] + S[h0][w0];\n    }\n\n    int[int[5]] cache;\n    int dfs(int n, int h0, int w0, int h1, int w1) {\n        if (n == 1) return area(h0, w0, h1, w1);\n        auto key = cast(int[5])[n, h0, w0, h1, w1];\n        if (key in cache) return cache[key];\n        int ans = 0;\n        for (int h = h0 + 1; h < h1; h++) {\n            ans = max(ans, min(area(h0, w0, h, w1), dfs(n - 1, h, w0, h1, w1)));\n            ans = max(ans, min(area(h, w0, h1, w1), dfs(n - 1, h0, w0, h, w1)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w0, h, w1), dfs(n - 2, h, w0, h1, w1)));\n            }\n        }\n        for (int w = w0 + 1; w < w1; w++) {\n            ans = max(ans, min(area(h0, w0, h1, w), dfs(n - 1, h0, w, h1, w1)));\n            ans = max(ans, min(area(h0, w, h1, w1), dfs(n - 1, h0, w0, h1, w)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w, h1, w1), dfs(n - 2, h0, w0, h1, w)));\n            }\n        }\n        return cache[key] = ans;\n    }\n\n    int ans = dfs(N, 0, 0, H, W);\n    if (N == 4) {\n        for (int i = 1; i < H - 1; i++) {\n            if (area(0, 0, i, W) <= ans) continue;\n            for (int x = 1; x < W; x++) {\n                if (area(0, 0, i, x) <= ans) continue;\n                if (area(0, x, H, W) <= ans) continue;\n                for (int j = 1; j < x; j++) {\n                    if (area(i, 0, H, j) <= ans) continue;\n                    for (int y = i + 1; y < H; y++) {\n                        ans = max(ans, min(area(0, 0, i, x), area(0, x, y, W), area(y, j, H, W), area(i, 0, H, j)));\n                    }\n                }\n            }\n        }\n        for (int i = 1; i < H - 1; i++) {\n            if (area(0, 0, i, W) <= ans) continue;\n            for (int j = 1; j < W - 1; j++) {\n                if (area(0, j, i, W) <= ans) continue;\n                if (area(0, 0, H, j) <= ans) continue;\n                for (int x = j + 1; x < W; x++) {\n                    if (area(i, x, H, W) <= ans) continue;\n                    for (int y = i + 1; y < H; y++) {\n                        ans = max(ans, min(area(0, 0, y, j), area(0, j, i, W), area(i, x, H, W), area(y, 0, H, x)));\n                    }\n                }\n            }\n        }\n\n    }\n\n    writeln(ans);\n}"
  },
  {
    "language": "D",
    "code": "import std.algorithm;\nimport std.array;\nimport std.ascii;\nimport std.container;\nimport std.conv;\nimport std.math;\nimport std.numeric;\nimport std.range;\nimport std.stdio;\nimport std.string;\nimport std.typecons;\n\nvoid log(A...)(A arg) {\n    stderr.writeln(arg);\n}\nint size(T)(in T s) {\n    return cast(int)s.length;\n}\n\nvoid main() {\n    int H, W, N; readf(\"%d %d %d\\n\", &H, &W, &N);\n    auto F = new int[][H];\n    foreach (ref L; F) {\n        L = readln.chomp.split(\" \").map!(to!int).array;\n    }\n\n    auto S = new int[][](H + 1, W + 1);\n    foreach (i; 0 .. H) {\n        foreach (j; 0 .. W) {\n            S[i + 1][j + 1] = S[i + 1][j] + S[i][j + 1] - S[i][j] + F[i][j];;\n        }\n    }\n    int area(int h0, int w0, int h1, int w1) {\n        return S[h1][w1] - S[h1][w0] - S[h0][w1] + S[h0][w0];\n    }\n\n    int[long] cache;\n    int dfs(int n, int h0, int w0, int h1, int w1) {\n        if (n == 1) return area(h0, w0, h1, w1);\n        long key = n + h0 * 5L + w0 * 5L * 205 + h1 * 5L * 205 * 205 + w1 * 5L * 205 * 205 * 205;\n        if (key in cache) return cache[key];\n        int ans = 0;\n        for (int h = h0 + 1; h < h1; h++) {\n            ans = max(ans, min(area(h0, w0, h, w1), dfs(n - 1, h, w0, h1, w1)));\n            ans = max(ans, min(area(h, w0, h1, w1), dfs(n - 1, h0, w0, h, w1)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w0, h, w1), dfs(n - 2, h, w0, h1, w1)));\n            }\n        }\n        for (int w = w0 + 1; w < w1; w++) {\n            ans = max(ans, min(area(h0, w0, h1, w), dfs(n - 1, h0, w, h1, w1)));\n            ans = max(ans, min(area(h0, w, h1, w1), dfs(n - 1, h0, w0, h1, w)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w, h1, w1), dfs(n - 2, h0, w0, h1, w)));\n            }\n        }\n        return cache[key] = ans;\n    }\n\n    int ans = dfs(N, 0, 0, H, W);\n    if (N == 4) {\n        for (int i = 1; i < H - 1; i++) {\n            for (int j = 1; j < W - 1; j++) {\n                for (int y = i + 1; y < H; y++) {\n                    for (int x = j + 1; x < W; x++) {\n                        ans = max(ans, min(area(0, 0, i, x), area(0, x, y, W), area(y, j, H, W), area(i, 0, H, j)));\n                        ans = max(ans, min(area(0, 0, y, j), area(0, j, i, W), area(i, x, H, W), area(y, 0, H, x)));\n                    }\n                }\n            }\n        }\n    }\n\n    writeln(ans);\n}"
  },
  {
    "language": "D",
    "code": "import std.algorithm;\nimport std.array;\nimport std.ascii;\nimport std.container;\nimport std.conv;\nimport std.math;\nimport std.numeric;\nimport std.range;\nimport std.stdio;\nimport std.string;\nimport std.typecons;\n\nvoid log(A...)(A arg) {\n    stderr.writeln(arg);\n}\nint size(T)(in T s) {\n    return cast(int)s.length;\n}\n\nvoid main() {\n    int H, W, N; readf(\"%d %d %d\\n\", &H, &W, &N);\n    auto F = new int[][H];\n    foreach (ref L; F) {\n        L = readln.chomp.split(\" \").map!(to!int).array;\n    }\n\n    auto S = new int[][](H + 1, W + 1);\n    foreach (i; 0 .. H) {\n        foreach (j; 0 .. W) {\n            S[i + 1][j + 1] = S[i + 1][j] + S[i][j + 1] - S[i][j] + F[i][j];;\n        }\n    }\n    int area(int h0, int w0, int h1, int w1) {\n        return S[h1][w1] - S[h1][w0] - S[h0][w1] + S[h0][w0];\n    }\n\n    auto cache = new int[][][][][](N + 1, H, W, H + 1, W + 1);\n    foreach (ref a; cache) foreach (ref b; a) foreach (ref c; b) foreach (ref d; c) d[] = -1;\n    int dfs(int n, int h0, int w0, int h1, int w1) {\n        if (n == 1) return area(h0, w0, h1, w1);\n        auto c = &cache[n][h0][w0][h1][w1];\n        if (*c >= 0) return *c;\n        int ans = 0;\n        for (int h = h0 + 1; h < h1; h++) {\n            ans = max(ans, min(area(h0, w0, h, w1), dfs(n - 1, h, w0, h1, w1)));\n            ans = max(ans, min(area(h, w0, h1, w1), dfs(n - 1, h0, w0, h, w1)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w0, h, w1), dfs(n - 2, h, w0, h1, w1)));\n            }\n        }\n        for (int w = w0 + 1; w < w1; w++) {\n            ans = max(ans, min(area(h0, w0, h1, w), dfs(n - 1, h0, w, h1, w1)));\n            ans = max(ans, min(area(h0, w, h1, w1), dfs(n - 1, h0, w0, h1, w)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w, h1, w1), dfs(n - 2, h0, w0, h1, w)));\n            }\n        }\n        return *c = ans;\n    }\n\n    int ans = 0;\n    if (N == 4) {\n        for (int i = 1; i < H - 1; i++) {\n            for (int j = 1; j < W - 1; j++) {\n                for (int y = i + 1; y < H; y++) {\n                    for (int x = j + 1; x < W; x++) {\n                        ans = max(ans, min(area(0, 0, i, x), area(0, x, y, W), area(y, j, H, W), area(i, 0, H, j)));\n                        ans = max(ans, min(area(0, 0, y, j), area(0, j, i, W), area(i, x, H, W), area(y, 0, H, x)));\n                    }\n                }\n            }\n        }\n    }\n\n    writeln(max(ans, dfs(N, 0, 0, H, W)));\n}"
  },
  {
    "language": "D",
    "code": "import std.algorithm;\nimport std.array;\nimport std.ascii;\nimport std.container;\nimport std.conv;\nimport std.math;\nimport std.numeric;\nimport std.range;\nimport std.stdio;\nimport std.string;\nimport std.typecons;\n\nvoid log(A...)(A arg) {\n    stderr.writeln(arg);\n}\nint size(T)(in T s) {\n    return cast(int)s.length;\n}\n\nvoid main() {\n    int H, W, N; readf(\"%d %d %d\\n\", &H, &W, &N);\n    auto F = new int[][H];\n    foreach (ref L; F) {\n        L = readln.chomp.split(\" \").map!(to!int).array;\n    }\n\n    auto S = new int[][](H + 1, W + 1);\n    foreach (i; 0 .. H) {\n        foreach (j; 0 .. W) {\n            S[i + 1][j + 1] = S[i + 1][j] + S[i][j + 1] - S[i][j] + F[i][j];;\n        }\n    }\n    int area(int h0, int w0, int h1, int w1) {\n        return S[h1][w1] - S[h1][w0] - S[h0][w1] + S[h0][w0];\n    }\n\n    int[int[5]] cache;\n    int dfs(int n, int h0, int w0, int h1, int w1) {\n        if (n == 1) return area(h0, w0, h1, w1);\n        auto key = cast(int[5])[n, h0, w0, h1, w1];\n        if (key in cache) return cache[key];\n        int ans = 0;\n        for (int h = h0 + 1; h < h1; h++) {\n            ans = max(ans, min(area(h0, w0, h, w1), dfs(n - 1, h, w0, h1, w1)));\n            ans = max(ans, min(area(h, w0, h1, w1), dfs(n - 1, h0, w0, h, w1)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w0, h, w1), dfs(n - 2, h, w0, h1, w1)));\n            }\n        }\n        for (int w = w0 + 1; w < w1; w++) {\n            ans = max(ans, min(area(h0, w0, h1, w), dfs(n - 1, h0, w, h1, w1)));\n            ans = max(ans, min(area(h0, w, h1, w1), dfs(n - 1, h0, w0, h1, w)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w, h1, w1), dfs(n - 2, h0, w0, h1, w)));\n            }\n        }\n        return cache[key] = ans;\n    }\n\n    writeln(dfs(N, 0, 0, H, W));\n}"
  },
  {
    "language": "D",
    "code": "import std.algorithm;\nimport std.array;\nimport std.ascii;\nimport std.container;\nimport std.conv;\nimport std.math;\nimport std.numeric;\nimport std.range;\nimport std.stdio;\nimport std.string;\nimport std.typecons;\n\nvoid log(A...)(A arg) {\n    stderr.writeln(arg);\n}\nint size(T)(in T s) {\n    return cast(int)s.length;\n}\n\nvoid main() {\n    int H, W, N; readf(\"%d %d %d\\n\", &H, &W, &N);\n    auto F = new int[][H];\n    foreach (ref L; F) {\n        L = readln.chomp.split(\" \").map!(to!int).array;\n    }\n\n    auto S = new int[][](H + 1, W + 1);\n    foreach (i; 0 .. H) {\n        foreach (j; 0 .. W) {\n            S[i + 1][j + 1] = S[i + 1][j] + S[i][j + 1] - S[i][j] + F[i][j];;\n        }\n    }\n    int area(int h0, int w0, int h1, int w1) {\n        return S[h1][w1] - S[h1][w0] - S[h0][w1] + S[h0][w0];\n    }\n\n    int[int[5]] cache;\n    int dfs(int n, int h0, int w0, int h1, int w1) {\n        if (n == 1) return area(h0, w0, h1, w1);\n        auto key = cast(int[5])[n, h0, w0, h1, w1];\n        if (key in cache) return cache[key];\n        int ans = 0;\n        for (int h = h0 + 1; h < h1; h++) {\n            ans = max(ans, min(area(h0, w0, h, w1), dfs(n - 1, h, w0, h1, w1)));\n            ans = max(ans, min(area(h, w0, h1, w1), dfs(n - 1, h0, w0, h, w1)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w0, h, w1), dfs(n - 2, h, w0, h1, w1)));\n            }\n        }\n        for (int w = w0 + 1; w < w1; w++) {\n            ans = max(ans, min(area(h0, w0, h1, w), dfs(n - 1, h0, w, h1, w1)));\n            ans = max(ans, min(area(h0, w, h1, w1), dfs(n - 1, h0, w0, h1, w)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w, h1, w1), dfs(n - 2, h0, w0, h1, w)));\n            }\n        }\n        return cache[key] = ans;\n    }\n\n    int ans = dfs(N, 0, 0, H, W);\n    if (N == 4) {\n        for (int i = 1; i < H - 1; i++) {\n            for (int x = 1; x < W; x++) {\n                if (area(0, 0, i, x) <= ans) continue;\n                for (int j = 1; j < x; j++) {\n                    if (area(i, 0, H, j) <= ans) continue;\n                    for (int y = i + 1; y < H; y++) {\n                        ans = max(ans, min(area(0, 0, i, x), area(0, x, y, W), area(y, j, H, W), area(i, 0, H, j)));\n                    }\n                }\n            }\n        }\n        for (int i = 1; i < H - 1; i++) {\n            for (int j = 1; j < W - 1; j++) {\n                if (area(0, j, i, W) <= area) continue;\n                for (int x = j + 1; x < W; x++) {\n                    if (area(i, x, H, W) <= ans) continue;\n                    for (int y = i + 1; y < H; y++) {\n                        ans = max(ans, min(area(0, 0, y, j), area(0, j, i, W), area(i, x, H, W), area(y, 0, H, x)));\n                    }\n                }\n            }\n        }\n\n    }\n\n    writeln(ans);\n}"
  },
  {
    "language": "D",
    "code": "import std.algorithm;\nimport std.array;\nimport std.ascii;\nimport std.container;\nimport std.conv;\nimport std.math;\nimport std.numeric;\nimport std.range;\nimport std.stdio;\nimport std.string;\nimport std.typecons;\n\nvoid log(A...)(A arg) {\n    stderr.writeln(arg);\n}\nint size(T)(in T s) {\n    return cast(int)s.length;\n}\n\nvoid main() {\n    int H, W, N; readf(\"%d %d %d\\n\", &H, &W, &N);\n    auto F = new int[][H];\n    foreach (ref L; F) {\n        L = readln.chomp.split(\" \").map!(to!int).array;\n    }\n\n    auto S = new int[][](H + 1, W + 1);\n    foreach (i; 0 .. H) {\n        foreach (j; 0 .. W) {\n            S[i + 1][j + 1] = S[i + 1][j] + S[i][j + 1] - S[i][j] + F[i][j];;\n        }\n    }\n    int area(int h0, int w0, int h1, int w1) {\n        return S[h1][w1] - S[h1][w0] - S[h0][w1] + S[h0][w0];\n    }\n\n    int[int[5]] cache;\n    int dfs(int n, int h0, int w0, int h1, int w1) {\n        if (n == 1) return area(h0, w0, h1, w1);\n        auto key = cast(int[5])[n, h0, w0, h1, w1];\n        if (key in cache) return cache[key];\n        int ans = 0;\n        for (int h = h0 + 1; h < h1; h++) {\n            ans = max(ans, min(area(h0, w0, h, w1), dfs(n - 1, h, w0, h1, w1)));\n            ans = max(ans, min(area(h, w0, h1, w1), dfs(n - 1, h0, w0, h, w1)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w0, h, w1), dfs(n - 2, h, w0, h1, w1)));\n            }\n        }\n        for (int w = w0 + 1; w < w1; w++) {\n            ans = max(ans, min(area(h0, w0, h1, w), dfs(n - 1, h0, w, h1, w1)));\n            ans = max(ans, min(area(h0, w, h1, w1), dfs(n - 1, h0, w0, h1, w)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w, h1, w1), dfs(n - 2, h0, w0, h1, w)));\n            }\n        }\n        return cache[key] = ans;\n    }\n\n    int ans = dfs(N, 0, 0, H, W);\n    if (N == 4) {\n        for (int i = 1; i < H - 1; i++) {\n            for (int j = 1; j < W - 1; j++) {\n                for (int y = i + 1; y < H; y++) {\n                    for (int x = j + 1; x < W; x++) {\n                        ans = max(ans, min(area(0, 0, i, x), area(0, x, y, W), area(y, j, H, W), area(i, 0, H, j)));\n                        ans = max(ans, min(area(0, 0, y, j), area(0, j, i, W), area(i, x, H, W), area(y, 0, H, x)));\n                    }\n                }\n            }\n        }\n    }\n\n    writeln(ans);\n}"
  },
  {
    "language": "D",
    "code": "import std.algorithm;\nimport std.array;\nimport std.ascii;\nimport std.container;\nimport std.conv;\nimport std.math;\nimport std.numeric;\nimport std.range;\nimport std.stdio;\nimport std.string;\nimport std.typecons;\n\nvoid log(A...)(A arg) {\n    stderr.writeln(arg);\n}\nint size(T)(in T s) {\n    return cast(int)s.length;\n}\n\nvoid main() {\n    int H, W, N; readf(\"%d %d %d\\n\", &H, &W, &N);\n    auto F = new int[][H];\n    foreach (ref L; F) {\n        L = readln.chomp.split(\" \").map!(to!int).array;\n    }\n\n    auto S = new int[][](H + 1, W + 1);\n    foreach (i; 0 .. H) {\n        foreach (j; 0 .. W) {\n            S[i + 1][j + 1] = S[i + 1][j] + S[i][j + 1] - S[i][j] + F[i][j];;\n        }\n    }\n    int area(int h0, int w0, int h1, int w1) {\n        return S[h1][w1] - S[h1][w0] - S[h0][w1] + S[h0][w0];\n    }\n\n    int[int[5]] cache;\n    int dfs(int n, int h0, int w0, int h1, int w1) {\n        if (n == 1) return area(h0, w0, h1, w1);\n        auto key = cast(int[5])[n, h0, w0, h1, w1];\n        if (key in cache) return cache[key];\n        int ans = 0;\n        for (int h = h0 + 1; h < h1; h++) {\n            ans = max(ans, min(area(h0, w0, h, w1), dfs(n - 1, h, w0, h1, w1)));\n            ans = max(ans, min(area(h, w0, h1, w1), dfs(n - 1, h0, w0, h, w1)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w0, h, w1), dfs(n - 2, h, w0, h1, w1)));\n            }\n        }\n        for (int w = w0 + 1; w < w1; w++) {\n            ans = max(ans, min(area(h0, w0, h1, w), dfs(n - 1, h0, w, h1, w1)));\n            ans = max(ans, min(area(h0, w, h1, w1), dfs(n - 1, h0, w0, h1, w)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w, h1, w1), dfs(n - 2, h0, w0, h1, w)));\n            }\n        }\n        return cache[key] = ans;\n    }\n\n    int ans = dfs(N, 0, 0, H, W);\n    if (N == 4) {\n        for (int i = 1; i < H - 1; i++) {\n            for (int x = 1; x < W; x++) {\n                if (area(0, 0, i, x) <= ans) continue;\n                for (int j = 1; j < x; j++) {\n                    if (area(i, 0, H, j) <= ans) continue;\n                    for (int y = i + 1; y < H; y++) {\n                        ans = max(ans, min(area(0, 0, i, x), area(0, x, y, W), area(y, j, H, W), area(i, 0, H, j)));\n                    }\n                }\n            }\n        }\n        for (int i = 1; i < H - 1; i++) {\n            for (int j = 1; j < W - 1; j++) {\n                if (area(0, j, i, W) <= ans) continue;\n                for (int x = j + 1; x < W; x++) {\n                    if (area(i, x, H, W) <= ans) continue;\n                    for (int y = i + 1; y < H; y++) {\n                        ans = max(ans, min(area(0, 0, y, j), area(0, j, i, W), area(i, x, H, W), area(y, 0, H, x)));\n                    }\n                }\n            }\n        }\n\n    }\n\n    writeln(ans);\n}"
  },
  {
    "language": "D",
    "code": "import std.algorithm;\nimport std.array;\nimport std.ascii;\nimport std.container;\nimport std.conv;\nimport std.math;\nimport std.numeric;\nimport std.range;\nimport std.stdio;\nimport std.string;\nimport std.typecons;\n\nvoid log(A...)(A arg) {\n    stderr.writeln(arg);\n}\nint size(T)(in T s) {\n    return cast(int)s.length;\n}\n\nvoid main() {\n    int H, W, N; readf(\"%d %d %d\\n\", &H, &W, &N);\n    auto F = new int[][H];\n    foreach (ref L; F) {\n        L = readln.chomp.split(\" \").map!(to!int).array;\n    }\n\n    auto S = new int[][](H + 1, W + 1);\n    foreach (i; 0 .. H) {\n        foreach (j; 0 .. W) {\n            S[i + 1][j + 1] = S[i + 1][j] + S[i][j + 1] - S[i][j] + F[i][j];;\n        }\n    }\n    int area(int h0, int w0, int h1, int w1) {\n        return S[h1][w1] - S[h1][w0] - S[h0][w1] + S[h0][w0];\n    }\n\n    int[int[5]] cache;\n    int dfs(int n, int h0, int w0, int h1, int w1) {\n        if (n == 1) return area(h0, w0, h1, w1);\n        auto key = cast(int[5])[n, h0, w0, h1, w1];\n        if (key in cache) return cache[key];\n        for (int h = h0 + 1; h < h1; h++) {\n            ans = max(ans, min(area(h0, w0, h, w1), dfs(n - 1, h, w0, h1, w1)));\n            ans = max(ans, min(area(h, w0, h1, w1), dfs(n - 1, h0, w0, h, w1)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w0, h, w1), dfs(n - 2, h, w0, h1, w1)));\n            }\n        }\n        for (int w = w0 + 1; w < w1; w++) {\n            ans = max(ans, min(area(h0, w0, h1, w), dfs(n - 1, h0, w, h1, w1)));\n            ans = max(ans, min(area(h0, w, h1, w1), dfs(n - 1, h0, w0, h1, w)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w, h1, w1), dfs(n - 2, h0, w0, h1, w)));\n            }\n        }\n        return cache[key] = ans;\n    }\n\n    int ans = dfs(N, 0, 0, H, W);\n    if (N == 4) {\n        for (int i = 1; i < H - 1; i++) {\n            for (int j = 1; j < W - 1; j++) {\n                for (int y = i + 1; y < H; y++) {\n                    for (int x = j + 1; x < W; x++) {\n                        ans = max(ans, min(area(0, 0, i, x), area(0, x, y, W), area(y, j, H, W), area(i, 0, H, j)));\n                        ans = max(ans, min(area(0, 0, y, j), area(0, j, i, W), area(i, x, H, W), area(y, 0, H, x)));\n                    }\n                }\n            }\n        }\n    }\n\n    writeln(ans);\n}"
  },
  {
    "language": "D",
    "code": "import std.algorithm;\nimport std.array;\nimport std.ascii;\nimport std.container;\nimport std.conv;\nimport std.math;\nimport std.numeric;\nimport std.range;\nimport std.stdio;\nimport std.string;\nimport std.typecons;\n\nvoid log(A...)(A arg) {\n    stderr.writeln(arg);\n}\nint size(T)(in T s) {\n    return cast(int)s.length;\n}\n\nvoid main() {\n    int H, W, N; readf(\"%d %d %d\\n\", &H, &W, &N);\n    auto F = new int[][H];\n    foreach (ref L; F) {\n        L = readln.chomp.split(\" \").map!(to!int).array;\n    }\n\n    auto S = new int[][](H + 1, W + 1);\n    foreach (i; 0 .. H) {\n        foreach (j; 0 .. W) {\n            S[i + 1][j + 1] = S[i + 1][j] + S[i][j + 1] - S[i][j] + F[i][j];;\n        }\n    }\n    int area(int h0, int w0, int h1, int w1) {\n        return S[h1][w1] - S[h1][w0] - S[h0][w1] + S[h0][w0];\n    }\n\n    int[int[5]] cache;\n    int dfs(int n, int h0, int w0, int h1, int w1) {\n        if (n == 1) return area(h0, w0, h1, w1);\n        auto key = cast(int[5])[n, h0, w0, h1, w1];\n        if (key in cache) return cache[key];\n        int ans = 0;\n        for (int h = h0 + 1; h < h1; h++) {\n            ans = max(ans, min(area(h0, w0, h, w1), dfs(n - 1, h, w0, h1, w1)));\n            ans = max(ans, min(area(h, w0, h1, w1), dfs(n - 1, h0, w0, h, w1)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w0, h, w1), dfs(n - 2, h, w0, h1, w1)));\n            }\n        }\n        for (int w = w0 + 1; w < w1; w++) {\n            ans = max(ans, min(area(h0, w0, h1, w), dfs(n - 1, h0, w, h1, w1)));\n            ans = max(ans, min(area(h0, w, h1, w1), dfs(n - 1, h0, w0, h1, w)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w, h1, w1), dfs(n - 2, h0, w0, h1, w)));\n            }\n        }\n        return cache[key] = ans;\n    }\n\n    int ans = 0;\n    if (N == 4) {\n        for (int i = 1; i < H - 1; i++) {\n            for (int j = 1; j < W - 1; j++) {\n                for (int y = i + 1; y < H; y++) {\n                    for (int x = j + 1; x < W; x++) {\n                        ans = max(ans, min(area(0, 0, i, x), area(0, x, y, W), area(y, j, H, W), area(i, 0, H, j)));\n                        ans = max(ans, min(area(0, 0, y, j), area(0, j, i, W), area(i, x, H, W), area(y, 0, H, x)));\n                    }\n                }\n            }\n        }\n    }\n\n    writeln(max(ans, dfs(N, 0, 0, H, W)));\n}"
  },
  {
    "language": "D",
    "code": "import std.algorithm;\nimport std.array;\nimport std.ascii;\nimport std.container;\nimport std.conv;\nimport std.math;\nimport std.numeric;\nimport std.range;\nimport std.stdio;\nimport std.string;\nimport std.typecons;\n\nvoid log(A...)(A arg) {\n    stderr.writeln(arg);\n}\nint size(T)(in T s) {\n    return cast(int)s.length;\n}\n\nvoid main() {\n    int H, W, N; readf(\"%d %d %d\\n\", &H, &W, &N);\n    auto F = new int[][H];\n    foreach (ref L; F) {\n        L = readln.chomp.split(\" \").map!(to!int).array;\n    }\n\n    auto S = new int[][](H + 1, W + 1);\n    foreach (i; 0 .. H) {\n        foreach (j; 0 .. W) {\n            S[i + 1][j + 1] = S[i + 1][j] + S[i][j + 1] - S[i][j] + F[i][j];;\n        }\n    }\n    int area(int h0, int w0, int h1, int w1) {\n        return S[h1][w1] - S[h1][w0] - S[h0][w1] + S[h0][w0];\n    }\n\n    int[int[5]] cache;\n    int dfs(int n, int h0, int w0, int h1, int w1) {\n        if (n == 1) return area(h0, w0, h1, w1);\n        auto key = cast(int[5])[n, h0, w0, h1, w1];\n        if (key in cache) return cache[key];\n        int ans = 0;\n        for (int h = h0 + 1; h < h1; h++) {\n            ans = max(ans, min(area(h0, w0, h, w1), dfs(n - 1, h, w0, h1, w1)));\n            ans = max(ans, min(area(h, w0, h1, w1), dfs(n - 1, h0, w0, h, w1)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w0, h, w1), dfs(n - 2, h, w0, h1, w1)));\n            }\n        }\n        for (int w = w0 + 1; w < w1; w++) {\n            ans = max(ans, min(area(h0, w0, h1, w), dfs(n - 1, h0, w, h1, w1)));\n            ans = max(ans, min(area(h0, w, h1, w1), dfs(n - 1, h0, w0, h1, w)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w, h1, w1), dfs(n - 2, h0, w0, h1, w)));\n            }\n        }\n        return cache[key] = ans;\n    }\n\n    int ans = dfs(N, 0, 0, H, W);\n    if (N == 4) {\n        for (int i = 1; i < H - 1; i++) {\n            if (area(0, 0, i, W) <= ans) continue;\n            for (int j = 1; j < W - 1; j++) {\n                if (area(0, 0, H, j) <= ans) continue;\n                for (int y = i + 1; y < H; y++) {\n                    for (int x = j + 1; x < W; x++) {\n                        ans = max(ans, min(area(0, 0, i, x), area(0, x, y, W), area(y, j, H, W), area(i, 0, H, j)));\n                        ans = max(ans, min(area(0, 0, y, j), area(0, j, i, W), area(i, x, H, W), area(y, 0, H, x)));\n                    }\n                }\n            }\n        }\n    }\n\n    writeln(ans);\n}"
  },
  {
    "language": "D",
    "code": "import std.algorithm;\nimport std.array;\nimport std.ascii;\nimport std.container;\nimport std.conv;\nimport std.math;\nimport std.numeric;\nimport std.range;\nimport std.stdio;\nimport std.string;\nimport std.typecons;\n\nvoid log(A...)(A arg) {\n    stderr.writeln(arg);\n}\nint size(T)(in T s) {\n    return cast(int)s.length;\n}\n\nvoid main() {\n    int H, W, N; readf(\"%d %d %d\\n\", &H, &W, &N);\n    auto F = new int[][H];\n    foreach (ref L; F) {\n        L = readln.chomp.split(\" \").map!(to!int).array;\n    }\n\n    auto S = new int[][](H + 1, W + 1);\n    foreach (i; 0 .. H) {\n        foreach (j; 0 .. W) {\n            S[i + 1][j + 1] = S[i + 1][j] + S[i][j + 1] - S[i][j] + F[i][j];;\n        }\n    }\n    int area(int h0, int w0, int h1, int w1) {\n        return S[h1][w1] - S[h1][w0] - S[h0][w1] + S[h0][w0];\n    }\n\n    int[int[5]] cache;\n    int dfs(int n, int h0, int w0, int h1, int w1) {\n        if (n == 1) return area(h0, w0, h1, w1);\n        auto key = cast(int[5])[n, h0, w0, h1, w1];\n        if (key in cache) return cache[key];\n        int ans = 0;\n        for (int h = h0 + 1; h < h1; h++) {\n            ans = max(ans, min(area(h0, w0, h, w1), dfs(n - 1, h, w0, h1, w1)));\n            ans = max(ans, min(area(h, w0, h1, w1), dfs(n - 1, h0, w0, h, w1)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w0, h, w1), dfs(n - 2, h, w0, h1, w1)));\n            }\n        }\n        for (int w = w0 + 1; w < w1; w++) {\n            ans = max(ans, min(area(h0, w0, h1, w), dfs(n - 1, h0, w, h1, w1)));\n            ans = max(ans, min(area(h0, w, h1, w1), dfs(n - 1, h0, w0, h1, w)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w, h1, w1), dfs(n - 2, h0, w0, h1, w)));\n            }\n        }\n        return cache[key] = ans;\n    }\n\n    int ans = dfs(N, 0, 0, H, W);\n    if (N == 4) {\n        for (int i = 1; i < H - 1; i++) {\n            if (area(0, 0, i, W) <= ans) continue;\n            for (int j = 1; j < W - 1; j++) {\n                if (area(0, 0, H, j) <= ans) continue;\n                for (int y = i + 1; y < H; y++) {\n                    if (area(y, 0, H, W) <= ans) continue;\n                    for (int x = j + 1; x < W; x++) {\n                        if (area(0, x, H, W) <= ans) continue;\n                        ans = max(ans, min(area(0, 0, i, x), area(0, x, y, W), area(y, j, H, W), area(i, 0, H, j)));\n                        ans = max(ans, min(area(0, 0, y, j), area(0, j, i, W), area(i, x, H, W), area(y, 0, H, x)));\n                    }\n                }\n            }\n        }\n    }\n\n    writeln(ans);\n}"
  },
  {
    "language": "D",
    "code": "import std.algorithm;\nimport std.array;\nimport std.ascii;\nimport std.container;\nimport std.conv;\nimport std.math;\nimport std.numeric;\nimport std.range;\nimport std.stdio;\nimport std.string;\nimport std.typecons;\n\nvoid log(A...)(A arg) {\n    stderr.writeln(arg);\n}\nint size(T)(in T s) {\n    return cast(int)s.length;\n}\n\nvoid main() {\n    int H, W, N; readf(\"%d %d %d\\n\", &H, &W, &N);\n    auto F = new int[][H];\n    foreach (ref L; F) {\n        L = readln.chomp.split(\" \").map!(to!int).array;\n    }\n\n    auto S = new int[][](H + 1, W + 1);\n    foreach (i; 0 .. H) {\n        foreach (j; 0 .. W) {\n            S[i + 1][j + 1] = S[i + 1][j] + S[i][j + 1] - S[i][j] + F[i][j];;\n        }\n    }\n    int area(int h0, int w0, int h1, int w1) {\n        return S[h1][w1] - S[h1][w0] - S[h0][w1] + S[h0][w0];\n    }\n\n    int[int[5]] cache;\n    int dfs(int n, int h0, int w0, int h1, int w1) {\n        if (n == 1) return area(h0, w0, h1, w1);\n        auto key = cast(int[5])[n, h0, w0, h1, w1];\n        if (key in cache) return cache[key];\n        int ans = 0;\n        for (int h = h0 + 1; h < h1; h++) {\n            ans = max(ans, min(area(h0, w0, h, w1), dfs(n - 1, h, w0, h1, w1)));\n            ans = max(ans, min(area(h, w0, h1, w1), dfs(n - 1, h0, w0, h, w1)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w0, h, w1), dfs(n - 2, h, w0, h1, w1)));\n            }\n        }\n        for (int w = w0 + 1; w < w1; w++) {\n            ans = max(ans, min(area(h0, w0, h1, w), dfs(n - 1, h0, w, h1, w1)));\n            ans = max(ans, min(area(h0, w, h1, w1), dfs(n - 1, h0, w0, h1, w)));\n            if (n == 4) {\n                ans = max(ans, min(dfs(n - 2, h0, w, h1, w1), dfs(n - 2, h0, w0, h1, w)));\n            }\n        }\n        return cache[key] = ans;\n    }\n\n    int ans = dfs(N, 0, 0, H, W);\n    if (N == 4) {\n        for (int i = 1; i < H - 1; i++) {\n            if (area(0, 0, i, W) <= ans) break;\n            for (int j = 1; j < W - 1; j++) {\n                if (area(0, 0, H, j) <= ans) break;\n                for (int y = i + 1; y < H; y++) {\n                    if (area(y, 0, H, W) <= ans) continue;\n                    for (int x = j + 1; x < W; x++) {\n                        if (area(0, x, H, W) <= ans) continue;\n                        ans = max(ans, min(area(0, 0, i, x), area(0, x, y, W), area(y, j, H, W), area(i, 0, H, j)));\n                        ans = max(ans, min(area(0, 0, y, j), area(0, j, i, W), area(i, x, H, W), area(y, 0, H, x)));\n                    }\n                }\n            }\n        }\n    }\n\n    writeln(ans);\n}"
  },
  {
    "language": "Python",
    "code": "import sys\nreadline = sys.stdin.readline\nwrite = sys.stdout.write\ndef rotate(H, W, R0):\n    R1 = [[0]*H for i in range(W)]\n    for i in range(H):\n        for j in range(W):\n            R1[W-1-j][i] = R0[i][j]\n    return R1\ndef make(H, W, R0):\n    R1 = [[0]*(W+1) for i in range(H+1)]\n    for i in range(H):\n        c = 0\n        for j in range(W):\n            c += R0[i][j]\n            R1[i+1][j+1] = c + R1[i][j+1]\n    return R1\n\ndef solve():\n    H, W, N = map(int, readline().split())\n    S = [list(map(int, readline().split())) for i in range(H)]\n    su = sum(map(sum, S))\n    ans = 0\n    if N == 2:\n        T = make(H, W, S)\n        for i in range(H+1):\n            e = T[i][W]\n            ans = max(ans, min(e, su-e))\n        for i in range(W+1):\n            e = T[H][i]\n            ans = max(ans, min(e, su-e))\n    elif N == 3:\n        for t in range(4):\n            T = make(H, W, S)\n            for i in range(H+1):\n                e0 = T[i][W]\n                for j in range(W+1):\n                    e1 = T[H][j] - T[i][j]\n                    ans = max(ans, min(e0, e1, su - e0 - e1))\n            if t < 2:\n                for i in range(W+1):\n                    e0 = T[H][i]\n                    for j in range(i, W+1):\n                        e1 = T[H][j]\n                        ans = max(ans, min(e0, e1-e0, su-e1))\n            S = rotate(H, W, S)\n            H, W = W, H\n    else:\n        for t in range(4):\n            T = make(H, W, S)\n            for i in range(H+1):\n                for j in range(W+1):\n                    e0 = T[i][j]\n                    if e0 < ans:\n                        continue\n                    k1 = 0\n                    while k1 < H and T[k1][W] - T[k1][j] < e0:\n                        k1 += 1\n                    k2 = 0\n                    while k2 < W and T[H][k2] - T[i][k2] < e0:\n                        k2 += 1\n                    if i < k1 and j < k2:\n                        continue\n                    if k1 <= i and k2 <= j:\n                        v1 = su - T[H][k2] - T[i][W] + T[i][k2]\n                        v2 = su - T[k1][W] - T[H][j] + T[k1][j]\n                        if max(v1, v2) >= e0:\n                            ans = max(e0, ans)\n                    else:\n                        v1 = su - T[H][k2] - T[k1][W] + T[k1][k2]\n                        if v1 >= e0:\n                            ans = max(e0, ans)\n            for i in range(W, -1, -1):\n                e0 = T[H][i]\n                if e0 <= ans:\n                    break\n                for j in range(i, W+1):\n                    e = T[H][j]\n                    e1 = e - e0; e2 = su - e\n                    if e1 <= ans or e2 <= ans:\n                        continue\n                    for k in range(j, W+1):\n                        f = T[H][k]\n                        if su-f <= ans:\n                            break\n                        ans = max(ans, min(e0, e1, f-e, su-f))\n                    for k in range(H+1):\n                        f = T[k][j] - T[k][i]\n                        if e1-f <= ans:\n                            break\n                        ans = max(ans, min(e0, f, e1-f, e2))\n                    for k in range(H+1):\n                        f = T[k][W] - T[k][j]\n                        if e2-f <= ans:\n                            break\n                        ans = max(ans, min(e0, e1, f, e2-f))\n                for j in range(H+1):\n                    e1 = T[j][W] - T[j][i]\n                    e2 = su - e1 - e0\n                    if e1 <= ans or e2 <= ans:\n                        continue\n                    for k in range(i, W+1):\n                        f = T[j][k] - T[j][i]\n                        if e1-f <= ans:\n                            break\n                        ans = max(ans, min(e0, f, e1-f, e2))\n                    for k in range(i, W+1):\n                        f = T[H][k] - e0 - T[j][k] + T[j][i]\n                        if e2-f <= ans:\n                            break\n                        ans = max(ans, min(e0, e1, f, e2-f))\n                for j in range(H, -1, -1):\n                    e1 = T[j][W] - T[j][i]\n                    if su - e0 - e1 <= ans:\n                        continue\n                    if e1 <= ans:\n                        break\n                    for k in range(j, H+1):\n                        e2 = T[k][W] - T[k][i]\n                        if su-e2-e0 <= ans:\n                            break\n                        ans = max(ans, min(e0, e1, e2-e1, su-e2-e0))\n            S = rotate(H, W, S)\n            H, W = W, H\n    write(\"%d\\n\" % ans)\nsolve()\n"
  }
]